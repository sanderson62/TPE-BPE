* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34******************************************************************
    35
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page   3
* EL131.cbl
    37 ENVIRONMENT DIVISION.
    38
    39 DATA DIVISION.
    40
    41 WORKING-STORAGE SECTION.
    42 01  DFH-START PIC X(04).
    43
    44 77  FILLER  PIC X(32)  VALUE '********************************'.
    45 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    46 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    47 77  s1                          pic s999 comp-3 value+0.
    48 77  s2                          pic s999 comp-3 value+0.
    49 77  a1                          pic s999 comp-3 value+0.
    50 77  WS-CRIT-PER-RECURRENT       PIC X     VALUE ' '.
    51 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    52 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    53 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    54 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    55 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    56 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    57 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    58     88  ERPDEF-FOUND                 VALUE 'Y'.
    59
    60 01  LCP-TIME-OF-DAY-XX.
    61     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    62     05  FILLER                    PIC 99.
    63 01  LCP-CICS-TIME                 PIC 9(15).
    64*                            COPY ELCSCTM.
    65******************************************************************
    66*                                                                *
    67*                                                                *
    68*                            ELCSCTM                             *
    69*                            VMOD=2.001                          *
    70*                                                                *
    71*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    72*                                                                *
    73******************************************************************
    74 01  SECURITY-MESSAGE.
    75     12  FILLER                          PIC X(30)
    76            VALUE '** LOGIC SECURITY VIOLATION -'.
    77     12  SM-READ                         PIC X(6).
    78     12  FILLER                          PIC X(5)
    79            VALUE ' PGM='.
    80     12  SM-PGM                          PIC X(6).
    81     12  FILLER                          PIC X(5)
    82            VALUE ' OPR='.
    83     12  SM-PROCESSOR-ID                 PIC X(4).
    84     12  FILLER                          PIC X(6)
    85            VALUE ' TERM='.
    86     12  SM-TERMID                       PIC X(4).
    87     12  FILLER                          PIC XX   VALUE SPACE.
    88     12  SM-JUL-DATE                     PIC 9(5).
    89     12  FILLER                          PIC X    VALUE SPACE.
    90     12  SM-TIME                         PIC 99.99.
    91
    92
    93*                            COPY ELCSCRTY.
    94******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page   4
* EL131.cbl
    95*                                                                *
    96*                                                                *
    97*                            ELCSCRTY                            *
    98*                            VMOD=2.001                          *
    99*                                                                *
   100*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   101*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   102*        SAVED IN PI-SECURITY-ADDRESS.                           *
   103*                                                                *
   104******************************************************************
   105 01  SECURITY-CONTROL.
   106     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   107     12  FILLER                       PIC XX    VALUE 'SC'.
   108     12  SC-CREDIT-CODES.
   109         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   110             20  SC-CREDIT-DISPLAY    PIC X.
   111             20  SC-CREDIT-UPDATE     PIC X.
   112     12  SC-CLAIMS-CODES.
   113         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   114             20  SC-CLAIMS-DISPLAY    PIC X.
   115             20  SC-CLAIMS-UPDATE     PIC X.
   116
   117*                            COPY ELCNWA.
   118*****************************************************************
   119*                                                               *
   120*                                                               *
   121*                            ELCNWA.                            *
   122*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   123*                            VMOD=2.003                         *
   124*                                                               *
   125*            M O V E   N A M E   W O R K   A R E A.             *
   126*                                                               *
   127*****************************************************************.
   128
   129 01  WS-NAME-WORK-AREA.
   130     05  WS-INSURED-LAST-NAME        PIC X(15).
   131     05  WS-INSURED-1ST-NAME         PIC X(12).
   132     05  WS-INSURED-MID-INIT         PIC X.
   133
   134     05  WS-NAME-WORK.
   135         10  WS-NW                   PIC X
   136             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   137
   138     05  WS-NAME-WORK2.
   139         10  WS-NW2                  PIC X
   140             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   141                                        NWA-INDEX0.
   142
   143     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   144                                     COMP-3.
   145
   146
   147 01  ws-dcc-error-line.
   148     05  filler occurs 15.
   149         10  ws-error-no        pic x(4).
   150 01  WS-DATE-AREA.
   151     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   152     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page   5
* EL131.cbl
   153     12  SAVE-DATE-CCYYMMDD.
   154         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   155         16  SAVE-DATE-YMD.
   156             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   157             20  FILLER         PIC X(4)    VALUE SPACES.
   158
   159 01  WS-BLANK                   PIC X       VALUE ' '.
   160
   161 01  CSO-WORK-FIELDS.
   162     05  WS-HOLD-CLAIM-STATUS    PIC X.
   163
   164 01  LITERALS-NUMBERS.
   165     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   166     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   167     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   168     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   169     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   170     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   171     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   172
   173     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   174     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   175     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   176     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   177     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   178     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   179     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   180     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   181     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   182
   183     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   184
   185     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   186
   187     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   188     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   189     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   190     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   191     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   192     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   193     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   194     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   195     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   196     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   197     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   198
   199     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   200     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   201     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   202     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   203         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   204     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   205     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   206     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   207     12  WS-CLAIM-SEQU.
   208         16  FILLER              PIC X VALUE '('.
   209         16  WS-CURRENT-SEQU     PIC Z9.
   210         16  FILLER              PIC X(04) VALUE ' OF '.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page   6
* EL131.cbl
   211         16  WS-OF-SEQU          PIC Z9.
   212         16  FILLER              PIC X VALUE ')'.
   213     12  WS-EDIT-BEN-CODE        PIC XX.
   214         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   215                                          '90' THRU '99'.
   216
   217     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   218     12  WS-EDIT-NUMBER          PIC ZZZ9.
   219
   220     12  WS-RESPONSE             PIC S9(8)   COMP.
   221         88  WS-RESP-NORMAL              VALUE +00.
   222         88  WS-RESP-ERROR               VALUE +01.
   223         88  WS-RESP-NOTFND              VALUE +13.
   224         88  WS-RESP-DUPKEY              VALUE +15.
   225         88  WS-RESP-NOTOPEN             VALUE +19.
   226         88  WS-RESP-ENDFILE             VALUE +20.
   227
   228     12  WS-MOS-PAID             PIC 999.
   229     12  WS-ODD-DAYS             PIC 99.
   230     12  WS-REM-MOS              PIC 999.
   231     12  WS-REM-DAYS             PIC 99.
   232     12  WS-TERM-IN-DAYS         PIC 9(4).
   233     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   234
   235     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   236     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   237     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   238     12  WS-RESET-SW             PIC X       VALUE 'N'.
   239     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   240     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   241     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   242
   243 01  DMD-DATE-YYYYMMDD.
   244     12  DMD-DECADE          PIC XX      VALUE SPACES.
   245     12  DMD-YYMMDD.
   246         16  DMD-YY          PIC XX      VALUE SPACES.
   247         16  DMD-MM          PIC XX      VALUE SPACES.
   248         16  DMD-DD          PIC XX      VALUE SPACES.
   249
   250 01  DMD-DATE-MMDDYYYY.
   251     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   252     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   253     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   254     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   255     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   256     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   257
   258 01  WS-MAIL-CODE.
   259     12  FILLER              PIC X.
   260     12  DMD-MAIL-CODE.
   261         16  WS-MAIL-4       PIC X(4).
   262         16  WS-MAIL-5       PIC X.
   263     12  FILLER              PIC X(4).
   264
   265     12  W-NAME-LAST             PIC  X(15).
   266     12  W-NAME-FIRST            PIC  X(15).
   267     12  W-NAME-MIDDLE.
   268         16  FILLER              PIC  X.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page   7
* EL131.cbl
   269         16  W-NAME-MIDDLE-2     PIC  X.
   270         16  FILLER              PIC  X(13).
   271
   272*    COPY ELCDCTB.
   273******************************************************************
   274*                                                                *
   275*                                                                *
   276*                            ELCDCTB.                            *
   277*                            VMOD=2.002                          *
   278*                                                                *
   279*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   280*       COMMUNICATIONS AREA                                      *
   281*                                                                *
   282******************************************************************
   283 01  DCT-COMMUNICATION-AREA.
   284     12  DCT-BILLING-BANK-ID      PIC  X(05).
   285     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   286     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   287     12  DCT-PRODUCT-CODE         PIC  X(02).
   288     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   289     12  DCT-RETURN-CODE          PIC  X(02).
   290     12  DCT-MAIL-CODE            PIC  X(05).
   291     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   292     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page   8
* EL131.cbl
   294 01  ERROR-SWITCHES.
   295     12  ERROR-SWITCH            PIC X.
   296         88  SCREEN-ERROR                    VALUE 'X'.
   297     12  MSTR-KEY-SWITCH         PIC X.
   298         88  MSTR-KEY-CHANGED                VALUE 'X'.
   299     12  CERT-KEY-SWITCH         PIC X.
   300*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   301         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   302*********SET TO Y IF PRIMARY KEY WILL CHANGE
   303         88  CERT-KEY-CHANGED                VALUE 'Y'.
   304     12  MSTR-SWITCH             PIC X.
   305         88  MSTR-UPDATES                    VALUE 'X'.
   306     12  CERT-SWITCH             PIC X.
   307         88  CERT-UPDATES                    VALUE 'X'.
   308     12  UPDATE-SWITCH           PIC X.
   309         88  UPDATES-PRESENT                 VALUE 'X'.
   310     12  TRLR-SWITCH             PIC X.
   311         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   312         88  UPDATE-MADE                     VALUE 'Y'.
   313     12  NINETY-TRLR-SWITCH      PIC X.
   314         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   315     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   316         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   317     12  EARNINGS-CALC-SWITCH    PIC X.
   318         88  TEX-REG                         VALUE '4'.
   319         88  NET-PAY                         VALUE '5'.
   320     12  DLYACTV-SW              PIC X       VALUE 'N'.
   321         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page   9
* EL131.cbl
   323 01  EDIT-WORK-AREA.
   324     12  COUNT-2                 PIC 9.
   325     12  CALL-PGM                PIC X(8).
   326     12  TRANS-ID                PIC X(4).
   327     12  CHECK-PFKEYS            PIC 99.
   328     12  CHECK-MAINT             PIC X.
   329         88  ADD-ALPHA-RECORD                VALUE 'A'.
   330         88  CHANGE-CLAIM                    VALUE 'C'.
   331         88  DELETE-CLAIM                    VALUE 'D'.
   332         88  CHANGE-NAME                     VALUE 'N'.
   333         88  VALID-OPTIONS                   VALUE 'A' 'C'
   334                                                   'D' 'N'.
   335
   336     12  HOLD-BENEFIT            PIC XX.
   337     12  HOLD-FREQ               PIC XX.
   338     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   339     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   340     12  HOLD-PDTHRU             PIC XX.
   341     12  HOLD-ADDON              PIC XX.
   342     12  HOLD-NODAYS             PIC 9(4).
   343     12  HOLD-NOPMTS             PIC 9(3).
   344     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   345     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   346     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   347     12  HOLD-BIRTH              PIC XX.
   348     12  HOLD-END                PIC XX.
   349     12  HOLD-EFF                PIC XX.
   350     12  HOLD-ENTRY              PIC XX.
   351     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   352     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   353     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   354     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   355     12  HOLD-LF-CV-CAN          PIC XX.
   356     12  HOLD-AH-CV-CAN          PIC XX.
   357     12  DIVIDE-QUOT             PIC 9(3).
   358     12  DIVIDE-REM              PIC 9(3).
   359
   360     12  WS-ALPHA-DATE.
   361         16  WS-ALPHA-YEAR.
   362             20  WS-ALPHA-YY-1   PIC 99.
   363             20  WS-ALPHA-YY-2   PIC 99.
   364         16  WS-ALPHA-MM         PIC 99.
   365         16  WS-ALPHA-DD         PIC 99.
   366
   367     12  BUILD-VALID-DATE.
   368         16  BUILD-MONTH         PIC 99.
   369         16  BUILD-DAY           PIC 99.
   370         16  BUILD-YEAR          PIC 99.
   371     12  DEEDIT-MMYY-INPUT.
   372         16  FILLER              PIC X.
   373         16  DEEDIT-MONTH        PIC XX.
   374         16  DEEDIT-YEAR         PIC XX.
   375     12  DEEDIT-BEN              PIC 9(9)V99.
   376     12  DEEDIT-DATE-INPUT.
   377         16  FILLER              PIC XX.
   378         16  DEEDIT-DATE         PIC X(6).
   379     12  WORK-DATE-MDY.
   380         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  10
* EL131.cbl
   381         16  FILLER              PIC X(4).
   382         16  YEAR-WORK           PIC XX.
   383     12  WORK-DATE-MY.
   384         16  WORK-MONTH          PIC XX.
   385         16  WORK-SLASH          PIC X       VALUE '/'.
   386         16  WORK-YEAR           PIC XX.
   387     12  HOLD-DATE.
   388         16  HOLD-MONTH          PIC 99.
   389         16  FILLER              PIC X(4).
   390         16  HOLD-YEAR           PIC 99.
   391     12  SPLIT-INFO-LINE-1.
   392         16  SPLIT-INFO-DESC     PIC X(15).
   393         16  FILLER              PIC X(5)    VALUE ' OLD='.
   394         16  SPLIT-INFO-OLD      PIC X(40).
   395     12  EFF-TERM-MO             PIC 9(4).
   396     12  CURR-MO                 PIC 9(4).
   397     12  WS-BIN-CURRENT-DT       PIC XX.
   398     12  WS-CALC-METHOD          PIC X.
   399     12  WS-INITIALS.
   400         16  WS-INIT-1           PIC X.
   401         16  WS-INIT-2           PIC X.
   402     12  WS-REIN-TABLE.
   403         16  WS-REIN-1           PIC X.
   404         16  WS-REIN-2           PIC X.
   405         16  WS-REIN-3           PIC X.
   406     12  PI-KEY.
   407         16  PI-TERM             PIC X(4).
   408         16  PI-QUAL             PIC X(4).
   409     12  CHECK-KEY               PIC X(20).
   410     12  SAVE-ACCT-KEY           PIC X(20).
   411     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   412     12  WS-SOC-SEC-NUMBER.
   413         16  WS-SOC-SEC-NO       PIC 9(9).
   414         16  WS-SOC-SEC-BLANK    PIC X(2).
   415     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   416         16  WS-SSN-1-3          PIC 9(3).
   417         16  WS-SSN-DASH1        PIC X(1).
   418         16  WS-SSN-4-5          PIC 9(2).
   419         16  WS-SSN-DASH2        PIC X(1).
   420         16  WS-SSN-6-9          PIC 9(4).
   421     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   422
   423 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   424     12  M                   PIC S9(7)V99           VALUE ZEROS.
   425     12  L                   PIC S9(7)V99           VALUE ZEROS.
   426     12  N                   PIC S9(3)              VALUE ZEROS.
   427     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   428     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   429     12  I                   PIC S99V9(5)           VALUE ZEROS.
   430     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   431     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   432     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   433     12  R                   PIC S9(3)              VALUE ZEROS.
   434     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   435     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   436     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   437     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   438     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  11
* EL131.cbl
   439     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   440     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   441     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   442     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   443
   444 01  TERM-CALC-WORK-AREA.
   445     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   446     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   447     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   448     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   449     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   450     12  V-EXPONENTS.
   451        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   452     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   453
   454 01  TIME-IN.
   455     12  UN-HOURS                PIC XX.
   456     12  UN-MINUTES              PIC XX.
   457     12  FILLER                  PIC XX.
   458
   459 01  TIME-OUT.
   460     12  FOR-HOURS               PIC XX.
   461     12  FILLER                  PIC X       VALUE '.'.
   462     12  FOR-MINUTES             PIC XX.
   463
   464 01  ERROR-NUMBERS.
   465     12  ER-0000                 PIC X(4)    VALUE '0000'.
   466     12  ER-0004                 PIC X(4)    VALUE '0004'.
   467     12  ER-0008                 PIC X(4)    VALUE '0008'.
   468     12  ER-0023                 PIC X(4)    VALUE '0023'.
   469     12  ER-0029                 PIC X(4)    VALUE '0029'.
   470     12  ER-0068                 PIC X(4)    VALUE '0068'.
   471     12  ER-0070                 PIC X(4)    VALUE '0070'.
   472     12  ER-0149                 PIC X(4)    VALUE '0149'.
   473     12  ER-0154                 PIC X(4)    VALUE '0154'.
   474     12  ER-0169                 PIC X(4)    VALUE '0169'.
   475     12  ER-0192                 PIC X(4)    VALUE '0192'.
   476     12  ER-0199                 PIC X(4)    VALUE '0199'.
   477     12  ER-0203                 PIC X(4)    VALUE '0203'.
   478     12  ER-0204                 PIC X(4)    VALUE '0204'.
   479     12  ER-0205                 PIC X(4)    VALUE '0205'.
   480     12  ER-0206                 PIC X(4)    VALUE '0206'.
   481     12  ER-0208                 PIC X(4)    VALUE '0208'.
   482     12  ER-0210                 PIC X(4)    VALUE '0210'.
   483     12  ER-0215                 PIC X(4)    VALUE '0215'.
   484     12  ER-0219                 PIC X(4)    VALUE '0219'.
   485     12  ER-0220                 PIC X(4)    VALUE '0220'.
   486     12  ER-0222                 PIC X(4)    VALUE '0222'.
   487     12  ER-0223                 PIC X(4)    VALUE '0223'.
   488     12  ER-0224                 PIC X(4)    VALUE '0224'.
   489     12  ER-0227                 PIC X(4)    VALUE '0227'.
   490     12  ER-0230                 PIC X(4)    VALUE '0230'.
   491     12  ER-0232                 PIC X(4)    VALUE '0232'.
   492     12  ER-0233                 PIC X(4)    VALUE '0233'.
   493     12  ER-0236                 PIC X(4)    VALUE '0236'.
   494     12  ER-0237                 PIC X(4)    VALUE '0237'.
   495     12  ER-0238                 PIC X(4)    VALUE '0238'.
   496     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  12
* EL131.cbl
   497     12  ER-0241                 PIC X(4)    VALUE '0241'.
   498     12  ER-0243                 PIC X(4)    VALUE '0243'.
   499     12  ER-0244                 PIC X(4)    VALUE '0244'.
   500     12  ER-0246                 PIC X(4)    VALUE '0246'.
   501     12  ER-0247                 PIC X(4)    VALUE '0247'.
   502     12  ER-0248                 PIC X(4)    VALUE '0248'.
   503     12  ER-0250                 PIC X(4)    VALUE '0250'.
   504     12  ER-0251                 PIC X(4)    VALUE '0251'.
   505     12  ER-0253                 PIC X(4)    VALUE '0253'.
   506     12  ER-0256                 PIC X(4)    VALUE '0256'.
   507     12  ER-0257                 PIC X(4)    VALUE '0257'.
   508     12  ER-0258                 PIC X(4)    VALUE '0258'.
   509     12  ER-0259                 PIC X(4)    VALUE '0259'.
   510     12  ER-0260                 PIC X(4)    VALUE '0260'.
   511     12  ER-0261                 PIC X(4)    VALUE '0261'.
   512     12  ER-0262                 PIC X(4)    VALUE '0262'.
   513     12  ER-0263                 PIC X(4)    VALUE '0263'.
   514     12  ER-0273                 PIC X(4)    VALUE '0273'.
   515     12  ER-0274                 PIC X(4)    VALUE '0274'.
   516     12  ER-0276                 PIC X(4)    VALUE '0276'.
   517     12  ER-0282                 PIC X(4)    VALUE '0282'.
   518     12  ER-0283                 PIC X(4)    VALUE '0283'.
   519     12  ER-0309                 PIC X(4)    VALUE '0309'.
   520     12  ER-0310                 PIC X(4)    VALUE '0310'.
   521     12  ER-0311                 PIC X(4)    VALUE '0311'.
   522     12  ER-0333                 PIC X(4)    VALUE '0333'.
   523     12  ER-0360                 PIC X(4)    VALUE '0360'.
   524     12  ER-0377                 PIC X(4)    VALUE '0377'.
   525     12  ER-0402                 PIC X(4)    VALUE '0402'.
   526     12  ER-0416                 PIC X(4)    VALUE '0416'.
   527     12  ER-0426                 PIC X(4)    VALUE '0426'.
   528     12  ER-0427                 PIC X(4)    VALUE '0427'.
   529     12  ER-0428                 PIC X(4)    VALUE '0428'.
   530     12  ER-0429                 PIC X(4)    VALUE '0429'.
   531     12  ER-0430                 PIC X(4)    VALUE '0430'.
   532     12  ER-0458                 PIC X(4)    VALUE '0458'.
   533     12  ER-0475                 PIC X(4)    VALUE '0475'.
   534     12  ER-0491                 PIC X(4)    VALUE '0491'.
   535     12  ER-0509                 PIC X(4)    VALUE '0509'.
   536     12  ER-0510                 PIC X(4)    VALUE '0510'.
   537     12  ER-0511                 PIC X(4)    VALUE '0511'.
   538     12  ER-0512                 PIC X(4)    VALUE '0512'.
   539     12  ER-0519                 PIC X(4)    VALUE '0519'.
   540     12  ER-0520                 PIC X(4)    VALUE '0520'.
   541     12  ER-0521                 PIC X(4)    VALUE '0521'.
   542     12  ER-0547                 PIC X(4)    VALUE '0547'.
   543     12  ER-0548                 PIC X(4)    VALUE '0548'.
   544     12  ER-0549                 PIC X(4)    VALUE '0549'.
   545     12  ER-0565                 PIC X(4)    VALUE '0565'.
   546     12  ER-0598                 PIC X(4)    VALUE '0598'.
   547     12  ER-0639                 PIC X(4)    VALUE '0639'.
   548     12  ER-0797                 PIC X(4)    VALUE '0797'.
   549     12  ER-0802                 PIC X(4)    VALUE '0802'.
   550     12  ER-0803                 PIC X(4)    VALUE '0803'.
   551     12  ER-0849                 PIC X(4)    VALUE '0849'.
   552     12  ER-0885                 PIC X(4)    VALUE '0885'.
   553     12  ER-0887                 PIC X(4)    VALUE '0887'.
   554     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  13
* EL131.cbl
   555     12  ER-0921                 PIC X(4)    VALUE '0921'.
   556     12  ER-0938                 PIC X(4)    VALUE '0938'.
   557     12  ER-0946                 PIC X(4)    VALUE '0946'.
   558     12  ER-0947                 PIC X(4)    VALUE '0947'.
   559     12  ER-0948                 PIC X(4)    VALUE '0948'.
   560     12  ER-0949                 PIC X(4)    VALUE '0949'.
   561     12  ER-0950                 PIC X(4)    VALUE '0950'.
   562     12  ER-0951                 PIC X(4)    VALUE '0951'.
   563     12  ER-0954                 PIC X(4)    VALUE '0954'.
   564     12  ER-0974                 PIC X(4)    VALUE '0974'.
   565     12  ER-0975                 PIC X(4)    VALUE '0975'.
   566     12  ER-1651                 PIC X(4)    VALUE '1651'.
   567     12  ER-1652                 PIC X(4)    VALUE '1652'.
   568     12  ER-1653                 PIC X(4)    VALUE '1653'.
   569     12  ER-1654                 PIC X(4)    VALUE '1654'.
   570     12  ER-1655                 PIC X(4)    VALUE '1655'.
   571     12  er-1656                 pic x(4)    value '1656'.
   572     12  ER-1661                 PIC X(4)    VALUE '1661'.
   573     12  ER-1662                 PIC X(4)    VALUE '1662'.
   574     12  ER-1663                 PIC X(4)    VALUE '1663'.
   575     12  ER-1773                 PIC X(4)    VALUE '1773'.
   576     12  ER-2280                 PIC X(4)    VALUE '2280'.
   577     12  ER-2878                 PIC X(4)    VALUE '2878'.
   578     12  ER-7641                 PIC X(4)    VALUE '7641'.
   579     12  ER-7642                 PIC X(4)    VALUE '7642'.
   580     12  ER-7650                 PIC X(4)    VALUE '7650'.
   581     12  ER-7651                 PIC X(4)    VALUE '7651'.
   582     12  ER-7687                 PIC X(4)    VALUE '7687'.
   583     12  ER-7689                 PIC X(4)    VALUE '7689'.
   584     12  ER-7690                 PIC X(4)    VALUE '7690'.
   585     12  ER-7691                 PIC X(4)    VALUE '7691'.
   586     12  ER-8003                 PIC X(4)    VALUE '8003'.
   587     12  ER-8051                 PIC X(4)    VALUE '8051'.
   588     12  ER-8052                 PIC X(4)    VALUE '8052'.
   589     12  ER-8053                 PIC X(4)    VALUE '8053'.
   590     12  ER-8054                 PIC X(4)    VALUE '8054'.
   591     12  ER-8055                 PIC X(4)    VALUE '8055'.
   592     12  ER-8056                 PIC X(4)    VALUE '8056'.
   593     12  ER-8057                 PIC X(4)    VALUE '8057'.
   594     12  ER-8058                 PIC X(4)    VALUE '8058'.
   595     12  ER-8059                 PIC X(4)    VALUE '8059'.
   596     12  ER-8060                 PIC X(4)    VALUE '8060'.
   597     12  ER-8061                 PIC X(4)    VALUE '8061'.
   598     12  ER-8062                 PIC X(4)    VALUE '8062'.
   599     12  ER-8063                 PIC X(4)    VALUE '8063'.
   600     12  ER-8064                 PIC X(4)    VALUE '8064'.
   601     12  ER-8065                 PIC X(4)    VALUE '8065'.
   602     12  ER-8066                 PIC X(4)    VALUE '8066'.
   603     12  ER-8152                 PIC X(4)    VALUE '8152'.
   604     12  ER-8153                 PIC X(4)    VALUE '8153'.
   605     12  ER-8154                 PIC X(4)    VALUE '8154'.
   606     12  ER-8155                 PIC X(4)    VALUE '8155'.
   607 01  ERPDEF-KEY-SAVE             PIC X(18).
   608 01  ERPDEF-KEY.
   609     12  ERPDEF-COMPANY-CD       PIC X.
   610     12  ERPDEF-STATE            PIC XX.
   611     12  ERPDEF-PROD-CD          PIC XXX.
   612     12  F                       PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  14
* EL131.cbl
   613     12  ERPDEF-BEN-TYPE         PIC X.
   614     12  ERPDEF-BEN-CODE         PIC XX.
   615     12  ERPDEF-EXP-DT           PIC XX.
   616 01  MSTR-KEY.
   617     12  COMPANY-CODE            PIC X.
   618     12  CARRIER-CODE            PIC X.
   619     12  CLAIM-NO                PIC X(7).
   620     12  CERT-NO.
   621         16  CERT-NO-PRIME       PIC X(10).
   622         16  CERT-NO-SUFX        PIC X.
   623
   624 01  WS-SAVE-CLAIM-KEY.
   625     12  WS-SAVE-COMPANY-CD      PIC X.
   626     12  WS-SAVE-CARRIER         PIC X.
   627     12  WS-SAVE-CLAIM-NO        PIC X(7).
   628     12  WS-SAVE-CERT-NO.
   629         16  WS-CERT-NO-PRIME    PIC X(10).
   630         16  WS-CERT-NO-SUFX     PIC X.
   631
   632 01  CERT-KEY.
   633     12  CERT-COMPANY-CODE       PIC X.
   634     12  CERT-CARRIER            PIC X.
   635     12  CERT-GROUP              PIC X(6).
   636     12  CERT-STATE              PIC XX.
   637     12  CERT-ACCOUNT            PIC X(10).
   638     12  CERT-DATE               PIC XX.
   639     12  CERT-CERT.
   640         16  CERT-CERT-PRIME     PIC X(10).
   641         16  CERT-CERT-SUFX      PIC X.
   642
   643 01  ELCRTT-KEY.
   644     05  CTRLR-COMP-CD       PIC X.
   645     05  CTRLR-CARRIER       PIC X.
   646     05  CTRLR-GROUPING      PIC X(6).
   647     05  CTRLR-STATE         PIC X(2).
   648     05  CTRLR-ACCOUNT       PIC X(10).
   649     05  CTRLR-EFF-DT        PIC XX.
   650     05  CTRLR-CERT-NO       PIC X(11).
   651     05  CTRLR-REC-TYPE      PIC X.
   652 01  NOTE-KEY.
   653     12  NOTE-COMP-CD            PIC X.
   654     12  NOTE-CERT-KEY.
   655         16  NOTE-CARRIER        PIC X.
   656         16  NOTE-GROUP          PIC X(6).
   657         16  NOTE-STATE          PIC XX.
   658         16  NOTE-ACCOUNT        PIC X(10).
   659         16  NOTE-DATE           PIC XX.
   660         16  NOTE-CERT-NO        PIC X(11).
   661
   662 01  TRLR-KEY.
   663     12  TRLR-MAIN-KEY.
   664         16  TRLR-COMPANY-CD     PIC X.
   665         16  TRLR-CARRIER        PIC X.
   666         16  TRLR-CLAIM-NO       PIC X(07).
   667         16  TRLR-CERT-NO        PIC X(11).
   668     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   669
   670 01  BENEFIT-KEY.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  15
* EL131.cbl
   671     12  BEN-CO-ID               PIC X(3).
   672     12  BEN-REC-TYPE            PIC X.
   673     12  FILLER                  PIC XX.
   674     12  BEN-ACC-CD              PIC XX.
   675     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   676
   677 01  CNTL-KEY.
   678     12  CNTL-CO-ID              PIC X(3).
   679     12  CNTL-REC-TYPE           PIC X.
   680     12  CNTL-PROC-ID            PIC X(4).
   681     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   682         16  CNTL-STATE-NUMBER   PIC XX.
   683         16  FILLER              PIC XX.
   684     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   685         16  FILLER              PIC X(3).
   686         16  CNTL-CARRIER        PIC X.
   687     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   688
   689 01  ACTQ-KEY                    PIC X(20).
   690
   691 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   692
   693 01  CHKQ-KEY.
   694     12  CHKQ-COMPANY-CODE       PIC X.
   695     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   696     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   697
   698 01  ARCH-KEY.
   699     12  ARCH-COMPANY-CODE       PIC X.
   700     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   701     12  ARCH-RECORD-TYPE        PIC X.
   702     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   703
   704 01  ACCT-KEY.
   705     05  ACCT-PARTIAL-KEY.
   706         12  ACCT-COMPANY-CODE   PIC X.
   707         12  ACCT-CARRIER        PIC X.
   708         12  ACCT-GROUP          PIC X(6).
   709         12  ACCT-STATE          PIC XX.
   710         12  ACCT-ACCOUNT        PIC X(10).
   711     05  ACCT-DATE               PIC XX.
   712
   713 01  WS-ELBENE-KEY.
   714     12  WS-ELBENE-COMPANY-CD    PIC X.
   715     12  WS-ELBENE-RECORD-TYPE   PIC X.
   716     12  WS-ELBENE-ID            PIC X(10).
   717
   718 01  ELALPH-KEY.
   719     12  ELALPH-COMPANY-CD       PIC X.
   720     12  ELALPH-SOURCE           PIC X.
   721     12  ELALPH-NAME.
   722         16  ELALPH-LAST-NAME    PIC X(15).
   723         16  ELALPH-FIRST-NAME.
   724             20  ELALPH-FIRST-INIT   PIC X.
   725             20  FILLER              PIC X(11).
   726         16  ELALPH-MIDDLE-INIT  PIC X.
   727     12  ELALPH-DATE             PIC X(08).
   728     12  ELALPH-TIME             PIC S9(04)    COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  16
* EL131.cbl
   729
   730 01  COMP-LENGTHS.
   731     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   732     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   733     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   734     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   735     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   736     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   737     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   738     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   739     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   740     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   741     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   742     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   743     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   744     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  17
* EL131.cbl
   746*                                COPY ELCLNKLT.
   747******************************************************************
   748*                                                                *
   749*                                                                *
   750*                           ELCLNKLT                             *
   751*                            VMOD=2.003                          *
   752*                                                                *
   753*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   754*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   755*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   756*                                                                *
   757*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   758*   COMPLETING THE REQUIRED FIELDS.                              *
   759*                                                                *
   760*   THE CALLING PROGRAM SHOULD CHECK:                            *
   761*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   762*                              9999 INDICATES AN UNKNOWN ABEND   *
   763*                                   WAS DETECTED.                *
   764*                              ALL OTHER VALUES ARE NORMAL ERROR *
   765*                              CODES FOUND IN THE ERROR FILE.    *
   766******************************************************************
   767 01  W-1523-LINKDATA.
   768     12  W-1523-COMMON-PI-DATA.
   769         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   770         16  FILLER              PIC  X(67).
   771         16  W-1523-COMPANY-CD   PIC  X(01).
   772         16  FILLER              PIC  X(10).
   773         16  W-1523-CONTROL-IN-PROGRESS.
   774             20  W-1523-CARRIER  PIC  X(01).
   775             20  W-1523-GROUPING PIC  X(06).
   776             20  W-1523-STATE    PIC  X(02).
   777             20  W-1523-ACCOUNT  PIC  X(10).
   778             20  W-1523-CLAIM-CERT-GRP.
   779                 24  W-1523-CLAIM-NO
   780                                 PIC  X(07).
   781                 24  W-1523-CERT-NO.
   782                     28  W-1523-CERT-PRIME
   783                                 PIC  X(10).
   784                     28  W-1523-CERT-SFX
   785                                 PIC  X(01).
   786                 24  W-1523-CERT-EFF-DT
   787                                 PIC  X(02).
   788         16  FILLER              PIC X(265).
   789
   790     12  W-1523-WORK-AREA.
   791         16  W-1523-FORM-NUMBER  PIC  X(04).
   792         16  W-1523-NUMBER-COPIES
   793                                 PIC  9(01).
   794         16  W-1523-ADDR-TYPE    PIC  X(02).
   795         16  W-1523-FOLLOW-UP-DATE
   796                                 PIC  X(02).
   797         16  W-1523-RESEND-DATE  PIC  X(02).
   798         16  W-1523-ERROR-CODE   PIC  9(04).
   799             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   800             88  W-1523-FATAL-ERROR
   801                                    VALUES  0006 0013 0042
   802                                            0154 0168 0169
   803                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  18
* EL131.cbl
   804                                            0179 0186 0281
   805                                            0332 2055 3697
   806                                            3698 3699 3770
   807                                            3771 3772 7675
   808                                            9106 9808 9883
   809                                            9887.
   810             88  W-1523-STOP-ERRORS
   811                                    VALUES  0013 0042 0154
   812                                            0168 0169 0172
   813                                            0281 0332 2055
   814                                            3698 3699 7675
   815                                            9106 9808 9883
   816                                            9999.
   817         16  W-1523-REASON       PIC  X(70).
   818         16  W-1523-ARCHIVE-NUMBER
   819                                 PIC  9(08).
   820     12  W-1523-POINTER-AREA.
   821         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   822         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   823         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   824         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   825         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  19
* EL131.cbl
   827*                                COPY ELCINTF.
   828******************************************************************
   829*                                                                *
   830*                                                                *
   831*                            ELCINTF.                            *
   832*                            VMOD=2.017                          *
   833*                                                                *
   834*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   835*                                                                *
   836*       LENGTH = 1024                                            *
   837*                                                                *
   838******************************************************************
   839*                   C H A N G E   L O G
   840*
   841* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   842*-----------------------------------------------------------------
   843*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   844* EFFECTIVE    NUMBER
   845*-----------------------------------------------------------------
   846* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   847******************************************************************
   848 01  PROGRAM-INTERFACE-BLOCK.
   849     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   850     12  PI-CALLING-PROGRAM              PIC X(8).
   851     12  PI-SAVED-PROGRAM-1              PIC X(8).
   852     12  PI-SAVED-PROGRAM-2              PIC X(8).
   853     12  PI-SAVED-PROGRAM-3              PIC X(8).
   854     12  PI-SAVED-PROGRAM-4              PIC X(8).
   855     12  PI-SAVED-PROGRAM-5              PIC X(8).
   856     12  PI-SAVED-PROGRAM-6              PIC X(8).
   857     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   858     12  PI-COMPANY-ID                   PIC XXX.
   859     12  PI-COMPANY-CD                   PIC X.
   860
   861     12  PI-COMPANY-PASSWORD             PIC X(8).
   862
   863     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   864
   865     12  PI-CONTROL-IN-PROGRESS.
   866         16  PI-CARRIER                  PIC X.
   867         16  PI-GROUPING                 PIC X(6).
   868         16  PI-STATE                    PIC XX.
   869         16  PI-ACCOUNT                  PIC X(10).
   870         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   871                                         PIC X(10).
   872         16  PI-CLAIM-CERT-GRP.
   873             20  PI-CLAIM-NO             PIC X(7).
   874             20  PI-CERT-NO.
   875                 25  PI-CERT-PRIME       PIC X(10).
   876                 25  PI-CERT-SFX         PIC X.
   877             20  PI-CERT-EFF-DT          PIC XX.
   878         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   879             20  PI-PLAN-CODE            PIC X(2).
   880             20  PI-REVISION-NUMBER      PIC X(3).
   881             20  PI-PLAN-EFF-DT          PIC X(2).
   882             20  PI-PLAN-EXP-DT          PIC X(2).
   883             20  FILLER                  PIC X(11).
   884         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  20
* EL131.cbl
   885             20  PI-OE-REFERENCE-1.
   886                 25  PI-OE-REF-1-PRIME   PIC X(18).
   887                 25  PI-OE-REF-1-SUFF    PIC XX.
   888
   889     12  PI-SESSION-IN-PROGRESS          PIC X.
   890         88  CLAIM-SESSION                   VALUE '1'.
   891         88  CREDIT-SESSION                  VALUE '2'.
   892         88  WARRANTY-SESSION                VALUE '3'.
   893         88  MORTGAGE-SESSION                VALUE '4'.
   894         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   895
   896
   897*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   898
   899     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   900     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   901
   902     12  PI-CREDIT-USER                  PIC X.
   903         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   904         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   905
   906     12  PI-CLAIM-USER                   PIC X.
   907         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   908         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   909
   910     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   911         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   912         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   913         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   914         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   915         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   916
   917     12  PI-PROCESSOR-ID                 PIC X(4).
   918
   919     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   920
   921     12  PI-MEMBER-CAPTION               PIC X(10).
   922
   923     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   924         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   925
   926     12  PI-LIFE-OVERRIDE-L1             PIC X.
   927     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   928     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   929     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   930
   931     12  PI-AH-OVERRIDE-L1               PIC X.
   932     12  PI-AH-OVERRIDE-L2               PIC XX.
   933     12  PI-AH-OVERRIDE-L6               PIC X(6).
   934     12  PI-AH-OVERRIDE-L12              PIC X(12).
   935
   936     12  PI-NEW-SYSTEM                   PIC X(2).
   937
   938     12  PI-PRIMARY-CERT-NO              PIC X(11).
   939     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   940         88  PI-USES-PAID-TO                 VALUE '1'.
   941     12  PI-CRDTCRD-SYSTEM.
   942         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  21
* EL131.cbl
   943             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   944             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   945         16  PI-CC-MONTH-END-DT          PIC XX.
   946     12  PI-PROCESSOR-PRINTER            PIC X(4).
   947
   948     12  PI-OE-REFERENCE-2.
   949         16  PI-OE-REF-2-PRIME           PIC X(10).
   950         16  PI-OE-REF-2-SUFF            PIC X.
   951
   952     12  PI-REM-TRM-CALC-OPTION          PIC X.
   953
   954     12  PI-LANGUAGE-TYPE                PIC X.
   955             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   956             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   957             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   958
   959     12  PI-POLICY-LINKAGE-IND           PIC X.
   960         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   961         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   962                                                   LOW-VALUES.
   963
   964     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   965     12  PI-CLAIM-PW-SESSION             PIC X(1).
   966         88  PI-CLAIM-CREDIT                 VALUE '1'.
   967         88  PI-CLAIM-CONVEN                 VALUE '2'.
   968
   969     12  PI-PROCESSOR-CSR-IND            PIC X.
   970         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   971         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   972
   973     12  FILLER                          PIC X(3).
   974
   975     12  PI-SYSTEM-LEVEL                 PIC X(145).
   976
   977     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   978         PI-SYSTEM-LEVEL.
   979
   980         16  PI-ENTRY-CODES.
   981             20  PI-ENTRY-CD-1           PIC X.
   982             20  PI-ENTRY-CD-2           PIC X.
   983
   984         16  PI-RETURN-CODES.
   985             20  PI-RETURN-CD-1          PIC X.
   986             20  PI-RETURN-CD-2          PIC X.
   987
   988         16  PI-UPDATE-STATUS-SAVE.
   989             20  PI-UPDATE-BY            PIC X(4).
   990             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   991
   992         16  PI-LOWER-CASE-LETTERS       PIC X.
   993             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   994
   995*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   996*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   997*            88  CARRIER-CLM-CNTL            VALUE '2'.
   998
   999         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1000             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  22
* EL131.cbl
  1001             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1002             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1003             88  ACCNT-CNTL                  VALUE '3'.
  1004             88  CARR-ACCNT-CNTL             VALUE '4'.
  1005
  1006         16  PI-PROCESSOR-CAP-LIST.
  1007             20  PI-SYSTEM-CONTROLS.
  1008                24 PI-SYSTEM-DISPLAY     PIC X.
  1009                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1010                24 PI-SYSTEM-MODIFY      PIC X.
  1011                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1012             20  FILLER                  PIC XX.
  1013             20  PI-DISPLAY-CAP          PIC X.
  1014                 88  DISPLAY-CAP             VALUE 'Y'.
  1015             20  PI-MODIFY-CAP           PIC X.
  1016                 88  MODIFY-CAP              VALUE 'Y'.
  1017             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1018                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1019             20  PI-FORCE-CAP            PIC X.
  1020                 88  FORCE-CAP               VALUE 'Y'.
  1021
  1022         16  PI-PROGRAM-CONTROLS.
  1023             20  PI-PGM-PRINT-OPT        PIC X.
  1024             20  PI-PGM-FORMAT-OPT       PIC X.
  1025             20  PI-PGM-PROCESS-OPT      PIC X.
  1026             20  PI-PGM-TOTALS-OPT       PIC X.
  1027
  1028         16  PI-HELP-INTERFACE.
  1029             20  PI-LAST-ERROR-NO        PIC X(4).
  1030             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1031
  1032         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1033             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1034
  1035         16  PI-CR-CONTROL-IN-PROGRESS.
  1036             20  PI-CR-CARRIER           PIC X.
  1037             20  PI-CR-GROUPING          PIC X(6).
  1038             20  PI-CR-STATE             PIC XX.
  1039             20  PI-CR-ACCOUNT           PIC X(10).
  1040             20  PI-CR-FIN-RESP          PIC X(10).
  1041             20  PI-CR-TYPE              PIC X.
  1042
  1043         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1044
  1045         16  PI-CR-MONTH-END-DT          PIC XX.
  1046
  1047         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1048             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1049             88  PI-ZERO-CARRIER             VALUE '1'.
  1050             88  PI-ZERO-GROUPING            VALUE '2'.
  1051             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1052
  1053         16  PI-CARRIER-SECURITY         PIC X.
  1054             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1055
  1056         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1057             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1058             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  23
* EL131.cbl
  1059
  1060         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1061             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1062                                         INDEXED BY PI-ACCESS-NDX
  1063                                         PIC X.
  1064
  1065         16  PI-GA-BILLING-CONTROL       PIC X.
  1066             88  PI-GA-BILLING               VALUE '1'.
  1067
  1068         16  PI-MAIL-PROCESSING          PIC X.
  1069             88  PI-MAIL-YES                 VALUE 'Y'.
  1070
  1071         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1072
  1073         16  PI-AR-SYSTEM.
  1074             20  PI-AR-PROCESSING-CNTL   PIC X.
  1075                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1076             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1077             20  PI-AR-MONTH-END-DT      PIC XX.
  1078
  1079         16  PI-MP-SYSTEM.
  1080             20  PI-MORTGAGE-USER            PIC X.
  1081                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1082                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1083             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1084                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1085                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1086                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1087                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1088                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1089             20  PI-MP-MONTH-END-DT          PIC XX.
  1090             20  PI-MP-REFERENCE-NO.
  1091                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1092                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1093
  1094         16  PI-LABEL-CONTROL            PIC X(01).
  1095             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1096             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1097
  1098         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1099             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1100
  1101         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1102             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1103             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1104
  1105         16  FILLER                      PIC X(14).
  1106
  1107     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1108******************************************************************
  1109     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1110         16  PI-NO-PMTS                    PIC 9(4).
  1111         16  PI-CERT-SWITCH                PIC X.
  1112             88  CREATED-CERT              VALUE '2'.
  1113         16  PI-PREM-TYPE                  PIC X.
  1114         16  PI-SAVE-CERT-NO.
  1115             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1116             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  24
* EL131.cbl
  1117         16  FILLER                        PIC X(46).
  1118         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1119         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1120         16  PI-REC-FOUND-SW               PIC X.
  1121         16  PI-LETTER-SW                  PIC X.
  1122         16  PI-PREV-TRLR-KEY              PIC X(22).
  1123         16  pi-claim-type                 pic x.
  1124         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1125         16  pi-approval-level             pic x.
  1126         16  FILLER                        PIC X(543).
  1127
  1128 01  SAVE-RECORD                 PIC X(450).
  1129
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  25
* EL131.cbl
  1131*                                COPY ELCLOGOF SUPPRESS.
  1132******************************************************************
  1133*                                                                *
  1134*                                                                *
  1135*                            ELCLOGOF.                           *
  1136*                            VMOD=2.001                          *
  1137*                                                                *
  1138*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1139*                                                                *
  1140******************************************************************
  1141 01  CLASIC-LOGOFF.
  1142     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1143     12  LOGOFF-TEXT.
  1144         16  FILLER          PIC X(5)    VALUE SPACES.
  1145         16  LOGOFF-MSG.
  1146             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1147             20  FILLER      PIC X       VALUE SPACES.
  1148             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1149         16  FILLER          PIC X(80)
  1150           VALUE '* YOU ARE NOW LOGGED OFF'.
  1151         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1152         16  FILLER          PIC X       VALUE QUOTE.
  1153         16  LOGOFF-SYS-MSG  PIC X(17)
  1154           VALUE 'S CLAS-IC SYSTEM '.
  1155     12  TEXT-MESSAGES.
  1156         16  UNACCESS-MSG    PIC X(29)
  1157             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1158         16  PGMIDERR-MSG    PIC X(17)
  1159             VALUE 'PROGRAM NOT FOUND'.
  1160
  1161*                                COPY ELCATTR SUPPRESS.
  1162******************************************************************
  1163*                                                                *
  1164*                            ELCATTR.                            *
  1165*                            VMOD=2.001                          *
  1166*                                                                *
  1167*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1168*                                                                *
  1169*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1170*                                                                *
  1171*                   POS 1   P=PROTECTED                          *
  1172*                           U=UNPROTECTED                        *
  1173*                           S=ASKIP                              *
  1174*                   POS 2   A=ALPHA/NUMERIC                      *
  1175*                           N=NUMERIC                            *
  1176*                   POS 3   N=NORMAL                             *
  1177*                           B=BRIGHT                             *
  1178*                           D=DARK                               *
  1179*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1180*                           OF=MODIFIED DATA TAG OFF             *
  1181*                                                                *
  1182*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1183******************************************************************
  1184 01  ATTRIBUTE-LIST.
  1185     12  AL-PABOF            PIC X       VALUE 'Y'.
  1186     12  AL-PABON            PIC X       VALUE 'Z'.
  1187     12  AL-PADOF            PIC X       VALUE '%'.
  1188     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  26
* EL131.cbl
  1189     12  AL-PANOF            PIC X       VALUE '-'.
  1190     12  AL-PANON            PIC X       VALUE '/'.
  1191     12  AL-SABOF            PIC X       VALUE '8'.
  1192     12  AL-SABON            PIC X       VALUE '9'.
  1193     12  AL-SADOF            PIC X       VALUE '@'.
  1194     12  AL-SADON            PIC X       VALUE QUOTE.
  1195     12  AL-SANOF            PIC X       VALUE '0'.
  1196     12  AL-SANON            PIC X       VALUE '1'.
  1197     12  AL-UABOF            PIC X       VALUE 'H'.
  1198     12  AL-UABON            PIC X       VALUE 'I'.
  1199     12  AL-UADOF            PIC X       VALUE '<'.
  1200     12  AL-UADON            PIC X       VALUE '('.
  1201     12  AL-UANOF            PIC X       VALUE ' '.
  1202     12  AL-UANON            PIC X       VALUE 'A'.
  1203     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1204     12  AL-UNBON            PIC X       VALUE 'R'.
  1205     12  AL-UNDOF            PIC X       VALUE '*'.
  1206     12  AL-UNDON            PIC X       VALUE ')'.
  1207     12  AL-UNNOF            PIC X       VALUE '&'.
  1208     12  AL-UNNON            PIC X       VALUE 'J'.
  1209
  1210*                                COPY ELCAID SUPPRESS.
  1211******************************************************************
  1212*                                                                *
  1213*                            ELCAID.                             *
  1214*                            VMOD=2.001                          *
  1215*                                                                *
  1216*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1217*                                                                *
  1218*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1219*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1220******************************************************************
  1221
  1222 01  DFHAID.
  1223   02  DFHNULL   PIC  X  VALUE  ' '.
  1224   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1225   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1226   02  DFHPEN    PIC  X  VALUE  '='.
  1227   02  DFHOPID   PIC  X  VALUE  'W'.
  1228   02  DFHPA1    PIC  X  VALUE  '%'.
  1229   02  DFHPA2    PIC  X  VALUE  '>'.
  1230   02  DFHPA3    PIC  X  VALUE  ','.
  1231   02  DFHPF1    PIC  X  VALUE  '1'.
  1232   02  DFHPF2    PIC  X  VALUE  '2'.
  1233   02  DFHPF3    PIC  X  VALUE  '3'.
  1234   02  DFHPF4    PIC  X  VALUE  '4'.
  1235   02  DFHPF5    PIC  X  VALUE  '5'.
  1236   02  DFHPF6    PIC  X  VALUE  '6'.
  1237   02  DFHPF7    PIC  X  VALUE  '7'.
  1238   02  DFHPF8    PIC  X  VALUE  '8'.
  1239   02  DFHPF9    PIC  X  VALUE  '9'.
  1240   02  DFHPF10   PIC  X  VALUE  ':'.
  1241   02  DFHPF11   PIC  X  VALUE  '#'.
  1242   02  DFHPF12   PIC  X  VALUE  '@'.
  1243   02  DFHPF13   PIC  X  VALUE  'A'.
  1244   02  DFHPF14   PIC  X  VALUE  'B'.
  1245   02  DFHPF15   PIC  X  VALUE  'C'.
  1246   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  27
* EL131.cbl
  1247   02  DFHPF17   PIC  X  VALUE  'E'.
  1248   02  DFHPF18   PIC  X  VALUE  'F'.
  1249   02  DFHPF19   PIC  X  VALUE  'G'.
  1250   02  DFHPF20   PIC  X  VALUE  'H'.
  1251   02  DFHPF21   PIC  X  VALUE  'I'.
  1252*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1253   02  DFHPF22   PIC  X  VALUE  '['.
  1254   02  DFHPF23   PIC  X  VALUE  '.'.
  1255   02  DFHPF24   PIC  X  VALUE  '<'.
  1256   02  DFHMSRE   PIC  X  VALUE  'X'.
  1257   02  DFHSTRF   PIC  X  VALUE  'h'.
  1258   02  DFHTRIG   PIC  X  VALUE  '"'.
  1259 01  FILLER REDEFINES DFHAID.
  1260     12  FILLER                  PIC X(8).
  1261     12  AID-KEYS OCCURS 24 TIMES.
  1262         16  FILLER              PIC X.
  1263
  1264*                                COPY EL131S.
  1265 01  EL131AI.
  1266     05  FILLER            PIC  X(0012).
  1267*    -------------------------------
  1268     05  DATEL PIC S9(0004) COMP.
  1269     05  DATEF PIC  X(0001).
  1270     05  FILLER REDEFINES DATEF.
  1271         10  DATEA PIC  X(0001).
  1272     05  DATEI PIC  X(0008).
  1273*    -------------------------------
  1274     05  TIMEL PIC S9(0004) COMP.
  1275     05  TIMEF PIC  X(0001).
  1276     05  FILLER REDEFINES TIMEF.
  1277         10  TIMEA PIC  X(0001).
  1278     05  TIMEI PIC  X(0005).
  1279*    -------------------------------
  1280     05  SEQUL PIC S9(0004) COMP.
  1281     05  SEQUF PIC  X(0001).
  1282     05  FILLER REDEFINES SEQUF.
  1283         10  SEQUA PIC  X(0001).
  1284     05  SEQUI PIC  X(0010).
  1285*    -------------------------------
  1286     05  COMPL PIC S9(0004) COMP.
  1287     05  COMPF PIC  X(0001).
  1288     05  FILLER REDEFINES COMPF.
  1289         10  COMPA PIC  X(0001).
  1290     05  COMPI PIC  X(0003).
  1291*    -------------------------------
  1292     05  USERIDL PIC S9(0004) COMP.
  1293     05  USERIDF PIC  X(0001).
  1294     05  FILLER REDEFINES USERIDF.
  1295         10  USERIDA PIC  X(0001).
  1296     05  USERIDI PIC  X(0004).
  1297*    -------------------------------
  1298     05  CCNOL PIC S9(0004) COMP.
  1299     05  CCNOF PIC  X(0001).
  1300     05  FILLER REDEFINES CCNOF.
  1301         10  CCNOA PIC  X(0001).
  1302     05  CCNOI PIC  X(0016).
  1303*    -------------------------------
  1304     05  MAINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  28
* EL131.cbl
  1305     05  MAINTF PIC  X(0001).
  1306     05  FILLER REDEFINES MAINTF.
  1307         10  MAINTA PIC  X(0001).
  1308     05  MAINTI PIC  X(0001).
  1309*    -------------------------------
  1310     05  CLAIML PIC S9(0004) COMP.
  1311     05  CLAIMF PIC  X(0001).
  1312     05  FILLER REDEFINES CLAIMF.
  1313         10  CLAIMA PIC  X(0001).
  1314     05  CLAIMI PIC  X(0007).
  1315*    -------------------------------
  1316     05  CARRL PIC S9(0004) COMP.
  1317     05  CARRF PIC  X(0001).
  1318     05  FILLER REDEFINES CARRF.
  1319         10  CARRA PIC  X(0001).
  1320     05  CARRI PIC  X(0001).
  1321*    -------------------------------
  1322     05  CERTL PIC S9(0004) COMP.
  1323     05  CERTF PIC  X(0001).
  1324     05  FILLER REDEFINES CERTF.
  1325         10  CERTA PIC  X(0001).
  1326     05  CERTI PIC  X(0010).
  1327*    -------------------------------
  1328     05  SUFXL PIC S9(0004) COMP.
  1329     05  SUFXF PIC  X(0001).
  1330     05  FILLER REDEFINES SUFXF.
  1331         10  SUFXA PIC  X(0001).
  1332     05  SUFXI PIC  X(0001).
  1333*    -------------------------------
  1334     05  TYPEL PIC S9(0004) COMP.
  1335     05  TYPEF PIC  X(0001).
  1336     05  FILLER REDEFINES TYPEF.
  1337         10  TYPEA PIC  X(0001).
  1338     05  TYPEI PIC  X(0001).
  1339*    -------------------------------
  1340     05  LABEL1L PIC S9(0004) COMP.
  1341     05  LABEL1F PIC  X(0001).
  1342     05  FILLER REDEFINES LABEL1F.
  1343         10  LABEL1A PIC  X(0001).
  1344     05  LABEL1I PIC  X(0011).
  1345*    -------------------------------
  1346     05  PCERTNOL PIC S9(0004) COMP.
  1347     05  PCERTNOF PIC  X(0001).
  1348     05  FILLER REDEFINES PCERTNOF.
  1349         10  PCERTNOA PIC  X(0001).
  1350     05  PCERTNOI PIC  X(0010).
  1351*    -------------------------------
  1352     05  PSUFXL PIC S9(0004) COMP.
  1353     05  PSUFXF PIC  X(0001).
  1354     05  FILLER REDEFINES PSUFXF.
  1355         10  PSUFXA PIC  X(0001).
  1356     05  PSUFXI PIC  X(0001).
  1357*    -------------------------------
  1358     05  STATUSL PIC S9(0004) COMP.
  1359     05  STATUSF PIC  X(0001).
  1360     05  FILLER REDEFINES STATUSF.
  1361         10  STATUSA PIC  X(0001).
  1362     05  STATUSI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  29
* EL131.cbl
  1363*    -------------------------------
  1364     05  INCL PIC S9(0004) COMP.
  1365     05  INCF PIC  X(0001).
  1366     05  FILLER REDEFINES INCF.
  1367         10  INCA PIC  X(0001).
  1368     05  INCI PIC  X(0008).
  1369*    -------------------------------
  1370     05  REPL PIC S9(0004) COMP.
  1371     05  REPF PIC  X(0001).
  1372     05  FILLER REDEFINES REPF.
  1373         10  REPA PIC  X(0001).
  1374     05  REPI PIC  X(0008).
  1375*    -------------------------------
  1376     05  CAUSEL PIC S9(0004) COMP.
  1377     05  CAUSEF PIC  X(0001).
  1378     05  FILLER REDEFINES CAUSEF.
  1379         10  CAUSEA PIC  X(0001).
  1380     05  CAUSEI PIC  X(0006).
  1381*    -------------------------------
  1382     05  ENDL PIC S9(0004) COMP.
  1383     05  ENDF PIC  X(0001).
  1384     05  FILLER REDEFINES ENDF.
  1385         10  ENDA PIC  X(0001).
  1386     05  ENDI PIC  X(0008).
  1387*    -------------------------------
  1388     05  DIAGL PIC S9(0004) COMP.
  1389     05  DIAGF PIC  X(0001).
  1390     05  FILLER REDEFINES DIAGF.
  1391         10  DIAGA PIC  X(0001).
  1392     05  DIAGI PIC  X(0060).
  1393*    -------------------------------
  1394     05  ACCSWL PIC S9(0004) COMP.
  1395     05  ACCSWF PIC  X(0001).
  1396     05  FILLER REDEFINES ACCSWF.
  1397         10  ACCSWA PIC  X(0001).
  1398     05  ACCSWI PIC  X(0001).
  1399*    -------------------------------
  1400     05  BENEL PIC S9(0004) COMP.
  1401     05  BENEF PIC  X(0001).
  1402     05  FILLER REDEFINES BENEF.
  1403         10  BENEA PIC  X(0001).
  1404     05  BENEI PIC  X(0010).
  1405*    -------------------------------
  1406     05  BIRTHL PIC S9(0004) COMP.
  1407     05  BIRTHF PIC  X(0001).
  1408     05  FILLER REDEFINES BIRTHF.
  1409         10  BIRTHA PIC  X(0001).
  1410     05  BIRTHI PIC  X(0008).
  1411*    -------------------------------
  1412     05  SOCIALL PIC S9(0004) COMP.
  1413     05  SOCIALF PIC  X(0001).
  1414     05  FILLER REDEFINES SOCIALF.
  1415         10  SOCIALA PIC  X(0001).
  1416     05  SOCIALI PIC  X(0011).
  1417*    -------------------------------
  1418     05  SEXL PIC S9(0004) COMP.
  1419     05  SEXF PIC  X(0001).
  1420     05  FILLER REDEFINES SEXF.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  30
* EL131.cbl
  1421         10  SEXA PIC  X(0001).
  1422     05  SEXI PIC  X(0001).
  1423*    -------------------------------
  1424     05  MLNAMEL PIC S9(0004) COMP.
  1425     05  MLNAMEF PIC  X(0001).
  1426     05  FILLER REDEFINES MLNAMEF.
  1427         10  MLNAMEA PIC  X(0001).
  1428     05  MLNAMEI PIC  X(0015).
  1429*    -------------------------------
  1430     05  MFNAMEL PIC S9(0004) COMP.
  1431     05  MFNAMEF PIC  X(0001).
  1432     05  FILLER REDEFINES MFNAMEF.
  1433         10  MFNAMEA PIC  X(0001).
  1434     05  MFNAMEI PIC  X(0012).
  1435*    -------------------------------
  1436     05  MMINITL PIC S9(0004) COMP.
  1437     05  MMINITF PIC  X(0001).
  1438     05  FILLER REDEFINES MMINITF.
  1439         10  MMINITA PIC  X(0001).
  1440     05  MMINITI PIC  X(0001).
  1441*    -------------------------------
  1442     05  LOANNOL PIC S9(0004) COMP.
  1443     05  LOANNOF PIC  X(0001).
  1444     05  FILLER REDEFINES LOANNOF.
  1445         10  LOANNOA PIC  X(0001).
  1446     05  LOANNOI PIC  X(0008).
  1447*    -------------------------------
  1448     05  CRTLNMEL PIC S9(0004) COMP.
  1449     05  CRTLNMEF PIC  X(0001).
  1450     05  FILLER REDEFINES CRTLNMEF.
  1451         10  CRTLNMEA PIC  X(0001).
  1452     05  CRTLNMEI PIC  X(0015).
  1453*    -------------------------------
  1454     05  CRTFNMEL PIC S9(0004) COMP.
  1455     05  CRTFNMEF PIC  X(0001).
  1456     05  FILLER REDEFINES CRTFNMEF.
  1457         10  CRTFNMEA PIC  X(0001).
  1458     05  CRTFNMEI PIC  X(0012).
  1459*    -------------------------------
  1460     05  CRTINITL PIC S9(0004) COMP.
  1461     05  CRTINITF PIC  X(0001).
  1462     05  FILLER REDEFINES CRTINITF.
  1463         10  CRTINITA PIC  X(0001).
  1464     05  CRTINITI PIC  X(0001).
  1465*    -------------------------------
  1466     05  LOANBALL PIC S9(0004) COMP.
  1467     05  LOANBALF PIC  X(0001).
  1468     05  FILLER REDEFINES LOANBALF.
  1469         10  LOANBALA PIC  X(0001).
  1470     05  LOANBALI PIC  9(7)V99.
  1471*    -------------------------------
  1472     05  PROCL PIC S9(0004) COMP.
  1473     05  PROCF PIC  X(0001).
  1474     05  FILLER REDEFINES PROCF.
  1475         10  PROCA PIC  X(0001).
  1476     05  PROCI PIC  X(0004).
  1477*    -------------------------------
  1478     05  SUPVL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  31
* EL131.cbl
  1479     05  SUPVF PIC  X(0001).
  1480     05  FILLER REDEFINES SUPVF.
  1481         10  SUPVA PIC  X(0001).
  1482     05  SUPVI PIC  X(0001).
  1483*    -------------------------------
  1484     05  PRICDL PIC S9(0004) COMP.
  1485     05  PRICDF PIC  X(0001).
  1486     05  FILLER REDEFINES PRICDF.
  1487         10  PRICDA PIC  X(0001).
  1488     05  PRICDI PIC  X(0001).
  1489*    -------------------------------
  1490     05  CRITPL PIC S9(0004) COMP.
  1491     05  CRITPF PIC  X(0001).
  1492     05  FILLER REDEFINES CRITPF.
  1493         10  CRITPA PIC  X(0001).
  1494     05  CRITPI PIC  X(0002).
  1495*    -------------------------------
  1496     05  CRITPTL PIC S9(0004) COMP.
  1497     05  CRITPTF PIC  X(0001).
  1498     05  FILLER REDEFINES CRITPTF.
  1499         10  CRITPTA PIC  X(0001).
  1500     05  CRITPTI PIC  X(0001).
  1501*    -------------------------------
  1502     05  RTWMOSL PIC S9(0004) COMP.
  1503     05  RTWMOSF PIC  X(0001).
  1504     05  FILLER REDEFINES RTWMOSF.
  1505         10  RTWMOSA PIC  X(0001).
  1506     05  RTWMOSI PIC  X(0002).
  1507*    -------------------------------
  1508     05  FILETOL PIC S9(0004) COMP.
  1509     05  FILETOF PIC  X(0001).
  1510     05  FILLER REDEFINES FILETOF.
  1511         10  FILETOA PIC  X(0001).
  1512     05  FILETOI PIC  X(0004).
  1513*    -------------------------------
  1514     05  PTHRHDGL PIC S9(0004) COMP.
  1515     05  PTHRHDGF PIC  X(0001).
  1516     05  FILLER REDEFINES PTHRHDGF.
  1517         10  PTHRHDGA PIC  X(0001).
  1518     05  PTHRHDGI PIC  X(0010).
  1519*    -------------------------------
  1520     05  PDTHRUL PIC S9(0004) COMP.
  1521     05  PDTHRUF PIC  X(0001).
  1522     05  FILLER REDEFINES PDTHRUF.
  1523         10  PDTHRUA PIC  X(0001).
  1524     05  PDTHRUI PIC  X(0008).
  1525*    -------------------------------
  1526     05  PDAMTL PIC S9(0004) COMP.
  1527     05  PDAMTF PIC  X(0001).
  1528     05  FILLER REDEFINES PDAMTF.
  1529         10  PDAMTA PIC  X(0001).
  1530     05  PDAMTI PIC  9(7)V99.
  1531*    -------------------------------
  1532     05  NODAYSL PIC S9(0004) COMP.
  1533     05  NODAYSF PIC  X(0001).
  1534     05  FILLER REDEFINES NODAYSF.
  1535         10  NODAYSA PIC  X(0001).
  1536     05  NODAYSI PIC  9(5).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  32
* EL131.cbl
  1537*    -------------------------------
  1538     05  NOPMTSL PIC S9(0004) COMP.
  1539     05  NOPMTSF PIC  X(0001).
  1540     05  FILLER REDEFINES NOPMTSF.
  1541         10  NOPMTSA PIC  X(0001).
  1542     05  NOPMTSI PIC  9(4).
  1543*    -------------------------------
  1544     05  FORMTYPL PIC S9(0004) COMP.
  1545     05  FORMTYPF PIC  X(0001).
  1546     05  FILLER REDEFINES FORMTYPF.
  1547         10  FORMTYPA PIC  X(0001).
  1548     05  FORMTYPI PIC  X(0001).
  1549*    -------------------------------
  1550     05  ESTL PIC S9(0004) COMP.
  1551     05  ESTF PIC  X(0001).
  1552     05  FILLER REDEFINES ESTF.
  1553         10  ESTA PIC  X(0001).
  1554     05  ESTI PIC  X(0008).
  1555*    -------------------------------
  1556     05  AUIDL PIC S9(0004) COMP.
  1557     05  AUIDF PIC  X(0001).
  1558     05  FILLER REDEFINES AUIDF.
  1559         10  AUIDA PIC  X(0001).
  1560     05  AUIDI PIC  X(0004).
  1561*    -------------------------------
  1562     05  OCCL PIC S9(0004) COMP.
  1563     05  OCCF PIC  X(0001).
  1564     05  FILLER REDEFINES OCCF.
  1565         10  OCCA PIC  X(0001).
  1566     05  OCCI PIC  X(0006).
  1567*    -------------------------------
  1568     05  MNTDTL PIC S9(0004) COMP.
  1569     05  MNTDTF PIC  X(0001).
  1570     05  FILLER REDEFINES MNTDTF.
  1571         10  MNTDTA PIC  X(0001).
  1572     05  MNTDTI PIC  X(0008).
  1573*    -------------------------------
  1574     05  MNTTYPEL PIC S9(0004) COMP.
  1575     05  MNTTYPEF PIC  X(0001).
  1576     05  FILLER REDEFINES MNTTYPEF.
  1577         10  MNTTYPEA PIC  X(0001).
  1578     05  MNTTYPEI PIC  X(0006).
  1579*    -------------------------------
  1580     05  CERTCARL PIC S9(0004) COMP.
  1581     05  CERTCARF PIC  X(0001).
  1582     05  FILLER REDEFINES CERTCARF.
  1583         10  CERTCARA PIC  X(0001).
  1584     05  CERTCARI PIC  X(0001).
  1585*    -------------------------------
  1586     05  CERTGRPL PIC S9(0004) COMP.
  1587     05  CERTGRPF PIC  X(0001).
  1588     05  FILLER REDEFINES CERTGRPF.
  1589         10  CERTGRPA PIC  X(0001).
  1590     05  CERTGRPI PIC  X(0006).
  1591*    -------------------------------
  1592     05  CERTSTL PIC S9(0004) COMP.
  1593     05  CERTSTF PIC  X(0001).
  1594     05  FILLER REDEFINES CERTSTF.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  33
* EL131.cbl
  1595         10  CERTSTA PIC  X(0001).
  1596     05  CERTSTI PIC  X(0002).
  1597*    -------------------------------
  1598     05  CERTACTL PIC S9(0004) COMP.
  1599     05  CERTACTF PIC  X(0001).
  1600     05  FILLER REDEFINES CERTACTF.
  1601         10  CERTACTA PIC  X(0001).
  1602     05  CERTACTI PIC  X(0010).
  1603*    -------------------------------
  1604     05  CERTEFFL PIC S9(0004) COMP.
  1605     05  CERTEFFF PIC  X(0001).
  1606     05  FILLER REDEFINES CERTEFFF.
  1607         10  CERTEFFA PIC  X(0001).
  1608     05  CERTEFFI PIC  X(0008).
  1609*    -------------------------------
  1610     05  ISSAGEL PIC S9(0004) COMP.
  1611     05  ISSAGEF PIC  X(0001).
  1612     05  FILLER REDEFINES ISSAGEF.
  1613         10  ISSAGEA PIC  X(0001).
  1614     05  ISSAGEI PIC  X(0002).
  1615*    -------------------------------
  1616     05  APRL PIC S9(0004) COMP.
  1617     05  APRF PIC  X(0001).
  1618     05  FILLER REDEFINES APRF.
  1619         10  APRA PIC  X(0001).
  1620     05  APRI PIC  9(4)V9(4).
  1621*    -------------------------------
  1622     05  PMTFREQL PIC S9(0004) COMP.
  1623     05  PMTFREQF PIC  X(0001).
  1624     05  FILLER REDEFINES PMTFREQF.
  1625         10  PMTFREQA PIC  X(0001).
  1626     05  PMTFREQI PIC  99.
  1627*    -------------------------------
  1628     05  INDGRPL PIC S9(0004) COMP.
  1629     05  INDGRPF PIC  X(0001).
  1630     05  FILLER REDEFINES INDGRPF.
  1631         10  INDGRPA PIC  X(0001).
  1632     05  INDGRPI PIC  X(0001).
  1633*    -------------------------------
  1634     05  PREMTYPL PIC S9(0004) COMP.
  1635     05  PREMTYPF PIC  X(0001).
  1636     05  FILLER REDEFINES PREMTYPF.
  1637         10  PREMTYPA PIC  X(0001).
  1638     05  PREMTYPI PIC  X(0001).
  1639*    -------------------------------
  1640     05  REINCDL PIC S9(0004) COMP.
  1641     05  REINCDF PIC  X(0001).
  1642     05  FILLER REDEFINES REINCDF.
  1643         10  REINCDA PIC  X(0001).
  1644     05  REINCDI PIC  X(0001).
  1645*    -------------------------------
  1646     05  JNTLNMEL PIC S9(0004) COMP.
  1647     05  JNTLNMEF PIC  X(0001).
  1648     05  FILLER REDEFINES JNTLNMEF.
  1649         10  JNTLNMEA PIC  X(0001).
  1650     05  JNTLNMEI PIC  X(0015).
  1651*    -------------------------------
  1652     05  JNTFNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  34
* EL131.cbl
  1653     05  JNTFNMEF PIC  X(0001).
  1654     05  FILLER REDEFINES JNTFNMEF.
  1655         10  JNTFNMEA PIC  X(0001).
  1656     05  JNTFNMEI PIC  X(0012).
  1657*    -------------------------------
  1658     05  JNTINITL PIC S9(0004) COMP.
  1659     05  JNTINITF PIC  X(0001).
  1660     05  FILLER REDEFINES JNTINITF.
  1661         10  JNTINITA PIC  X(0001).
  1662     05  JNTINITI PIC  X(0001).
  1663*    -------------------------------
  1664     05  JNTAGEL PIC S9(0004) COMP.
  1665     05  JNTAGEF PIC  X(0001).
  1666     05  FILLER REDEFINES JNTAGEF.
  1667         10  JNTAGEA PIC  X(0001).
  1668     05  JNTAGEI PIC  X(0002).
  1669*    -------------------------------
  1670     05  ADDONDTL PIC S9(0004) COMP.
  1671     05  ADDONDTF PIC  X(0001).
  1672     05  FILLER REDEFINES ADDONDTF.
  1673         10  ADDONDTA PIC  X(0001).
  1674     05  ADDONDTI PIC  X(0008).
  1675*    -------------------------------
  1676     05  LCVDSCRL PIC S9(0004) COMP.
  1677     05  LCVDSCRF PIC  X(0001).
  1678     05  FILLER REDEFINES LCVDSCRF.
  1679         10  LCVDSCRA PIC  X(0001).
  1680     05  LCVDSCRI PIC  X(0006).
  1681*    -------------------------------
  1682     05  LCVKINDL PIC S9(0004) COMP.
  1683     05  LCVKINDF PIC  X(0001).
  1684     05  FILLER REDEFINES LCVKINDF.
  1685         10  LCVKINDA PIC  X(0001).
  1686     05  LCVKINDI PIC  X(0003).
  1687*    -------------------------------
  1688     05  LCVCDL PIC S9(0004) COMP.
  1689     05  LCVCDF PIC  X(0001).
  1690     05  FILLER REDEFINES LCVCDF.
  1691         10  LCVCDA PIC  X(0001).
  1692     05  LCVCDI PIC  X(0002).
  1693*    -------------------------------
  1694     05  LCVOTRML PIC S9(0004) COMP.
  1695     05  LCVOTRMF PIC  X(0001).
  1696     05  FILLER REDEFINES LCVOTRMF.
  1697         10  LCVOTRMA PIC  X(0001).
  1698     05  LCVOTRMI PIC  999.
  1699*    -------------------------------
  1700     05  LCVRTRML PIC S9(0004) COMP.
  1701     05  LCVRTRMF PIC  X(0001).
  1702     05  FILLER REDEFINES LCVRTRMF.
  1703         10  LCVRTRMA PIC  X(0001).
  1704     05  LCVRTRMI PIC  X(0003).
  1705*    -------------------------------
  1706     05  LCVRATEL PIC S9(0004) COMP.
  1707     05  LCVRATEF PIC  X(0001).
  1708     05  FILLER REDEFINES LCVRATEF.
  1709         10  LCVRATEA PIC  X(0001).
  1710     05  LCVRATEI PIC  9999V99.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  35
* EL131.cbl
  1711*    -------------------------------
  1712     05  LCVBENEL PIC S9(0004) COMP.
  1713     05  LCVBENEF PIC  X(0001).
  1714     05  FILLER REDEFINES LCVBENEF.
  1715         10  LCVBENEA PIC  X(0001).
  1716     05  LCVBENEI PIC  9(9)V99.
  1717*    -------------------------------
  1718     05  LCVFORML PIC S9(0004) COMP.
  1719     05  LCVFORMF PIC  X(0001).
  1720     05  FILLER REDEFINES LCVFORMF.
  1721         10  LCVFORMA PIC  X(0001).
  1722     05  LCVFORMI PIC  X(0012).
  1723*    -------------------------------
  1724     05  LCVCNDTL PIC S9(0004) COMP.
  1725     05  LCVCNDTF PIC  X(0001).
  1726     05  FILLER REDEFINES LCVCNDTF.
  1727         10  LCVCNDTA PIC  X(0001).
  1728     05  LCVCNDTI PIC  X(0008).
  1729*    -------------------------------
  1730     05  LCVEXITL PIC S9(0004) COMP.
  1731     05  LCVEXITF PIC  X(0001).
  1732     05  FILLER REDEFINES LCVEXITF.
  1733         10  LCVEXITA PIC  X(0001).
  1734     05  LCVEXITI PIC  X(0008).
  1735*    -------------------------------
  1736     05  LCVSTATL PIC S9(0004) COMP.
  1737     05  LCVSTATF PIC  X(0001).
  1738     05  FILLER REDEFINES LCVSTATF.
  1739         10  LCVSTATA PIC  X(0001).
  1740     05  LCVSTATI PIC  X(0006).
  1741*    -------------------------------
  1742     05  ACVDSCRL PIC S9(0004) COMP.
  1743     05  ACVDSCRF PIC  X(0001).
  1744     05  FILLER REDEFINES ACVDSCRF.
  1745         10  ACVDSCRA PIC  X(0001).
  1746     05  ACVDSCRI PIC  X(0006).
  1747*    -------------------------------
  1748     05  ACVKINDL PIC S9(0004) COMP.
  1749     05  ACVKINDF PIC  X(0001).
  1750     05  FILLER REDEFINES ACVKINDF.
  1751         10  ACVKINDA PIC  X(0001).
  1752     05  ACVKINDI PIC  X(0003).
  1753*    -------------------------------
  1754     05  ACVCDL PIC S9(0004) COMP.
  1755     05  ACVCDF PIC  X(0001).
  1756     05  FILLER REDEFINES ACVCDF.
  1757         10  ACVCDA PIC  X(0001).
  1758     05  ACVCDI PIC  X(0002).
  1759*    -------------------------------
  1760     05  ACVOTRML PIC S9(0004) COMP.
  1761     05  ACVOTRMF PIC  X(0001).
  1762     05  FILLER REDEFINES ACVOTRMF.
  1763         10  ACVOTRMA PIC  X(0001).
  1764     05  ACVOTRMI PIC  999.
  1765*    -------------------------------
  1766     05  ACVRTRML PIC S9(0004) COMP.
  1767     05  ACVRTRMF PIC  X(0001).
  1768     05  FILLER REDEFINES ACVRTRMF.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  36
* EL131.cbl
  1769         10  ACVRTRMA PIC  X(0001).
  1770     05  ACVRTRMI PIC  X(0003).
  1771*    -------------------------------
  1772     05  ACVRATEL PIC S9(0004) COMP.
  1773     05  ACVRATEF PIC  X(0001).
  1774     05  FILLER REDEFINES ACVRATEF.
  1775         10  ACVRATEA PIC  X(0001).
  1776     05  ACVRATEI PIC  9999V99.
  1777*    -------------------------------
  1778     05  ACVBENEL PIC S9(0004) COMP.
  1779     05  ACVBENEF PIC  X(0001).
  1780     05  FILLER REDEFINES ACVBENEF.
  1781         10  ACVBENEA PIC  X(0001).
  1782     05  ACVBENEI PIC  9(9)V99.
  1783*    -------------------------------
  1784     05  ACVFORML PIC S9(0004) COMP.
  1785     05  ACVFORMF PIC  X(0001).
  1786     05  FILLER REDEFINES ACVFORMF.
  1787         10  ACVFORMA PIC  X(0001).
  1788     05  ACVFORMI PIC  X(0012).
  1789*    -------------------------------
  1790     05  ACVCNDTL PIC S9(0004) COMP.
  1791     05  ACVCNDTF PIC  X(0001).
  1792     05  FILLER REDEFINES ACVCNDTF.
  1793         10  ACVCNDTA PIC  X(0001).
  1794     05  ACVCNDTI PIC  X(0008).
  1795*    -------------------------------
  1796     05  ACVEXITL PIC S9(0004) COMP.
  1797     05  ACVEXITF PIC  X(0001).
  1798     05  FILLER REDEFINES ACVEXITF.
  1799         10  ACVEXITA PIC  X(0001).
  1800     05  ACVEXITI PIC  X(0008).
  1801*    -------------------------------
  1802     05  ACVSTATL PIC S9(0004) COMP.
  1803     05  ACVSTATF PIC  X(0001).
  1804     05  FILLER REDEFINES ACVSTATF.
  1805         10  ACVSTATA PIC  X(0001).
  1806     05  ACVSTATI PIC  X(0006).
  1807*    -------------------------------
  1808     05  LABEL2L PIC S9(0004) COMP.
  1809     05  LABEL2F PIC  X(0001).
  1810     05  FILLER REDEFINES LABEL2F.
  1811         10  LABEL2A PIC  X(0001).
  1812     05  LABEL2I PIC  X(0014).
  1813*    -------------------------------
  1814     05  BCERT1L PIC S9(0004) COMP.
  1815     05  BCERT1F PIC  X(0001).
  1816     05  FILLER REDEFINES BCERT1F.
  1817         10  BCERT1A PIC  X(0001).
  1818     05  BCERT1I PIC  X(0010).
  1819*    -------------------------------
  1820     05  BSUFX1L PIC S9(0004) COMP.
  1821     05  BSUFX1F PIC  X(0001).
  1822     05  FILLER REDEFINES BSUFX1F.
  1823         10  BSUFX1A PIC  X(0001).
  1824     05  BSUFX1I PIC  X(0001).
  1825*    -------------------------------
  1826     05  BCERT2L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  37
* EL131.cbl
  1827     05  BCERT2F PIC  X(0001).
  1828     05  FILLER REDEFINES BCERT2F.
  1829         10  BCERT2A PIC  X(0001).
  1830     05  BCERT2I PIC  X(0010).
  1831*    -------------------------------
  1832     05  BSUFX2L PIC S9(0004) COMP.
  1833     05  BSUFX2F PIC  X(0001).
  1834     05  FILLER REDEFINES BSUFX2F.
  1835         10  BSUFX2A PIC  X(0001).
  1836     05  BSUFX2I PIC  X(0001).
  1837*    -------------------------------
  1838     05  BCERT3L PIC S9(0004) COMP.
  1839     05  BCERT3F PIC  X(0001).
  1840     05  FILLER REDEFINES BCERT3F.
  1841         10  BCERT3A PIC  X(0001).
  1842     05  BCERT3I PIC  X(0010).
  1843*    -------------------------------
  1844     05  BSUFX3L PIC S9(0004) COMP.
  1845     05  BSUFX3F PIC  X(0001).
  1846     05  FILLER REDEFINES BSUFX3F.
  1847         10  BSUFX3A PIC  X(0001).
  1848     05  BSUFX3I PIC  X(0001).
  1849*    -------------------------------
  1850     05  BCERT4L PIC S9(0004) COMP.
  1851     05  BCERT4F PIC  X(0001).
  1852     05  FILLER REDEFINES BCERT4F.
  1853         10  BCERT4A PIC  X(0001).
  1854     05  BCERT4I PIC  X(0010).
  1855*    -------------------------------
  1856     05  BSUFX4L PIC S9(0004) COMP.
  1857     05  BSUFX4F PIC  X(0001).
  1858     05  FILLER REDEFINES BSUFX4F.
  1859         10  BSUFX4A PIC  X(0001).
  1860     05  BSUFX4I PIC  X(0001).
  1861*    -------------------------------
  1862     05  BCERT5L PIC S9(0004) COMP.
  1863     05  BCERT5F PIC  X(0001).
  1864     05  FILLER REDEFINES BCERT5F.
  1865         10  BCERT5A PIC  X(0001).
  1866     05  BCERT5I PIC  X(0010).
  1867*    -------------------------------
  1868     05  BSUFX5L PIC S9(0004) COMP.
  1869     05  BSUFX5F PIC  X(0001).
  1870     05  FILLER REDEFINES BSUFX5F.
  1871         10  BSUFX5A PIC  X(0001).
  1872     05  BSUFX5I PIC  X(0001).
  1873*    -------------------------------
  1874     05  MSG1L PIC S9(0004) COMP.
  1875     05  MSG1F PIC  X(0001).
  1876     05  FILLER REDEFINES MSG1F.
  1877         10  MSG1A PIC  X(0001).
  1878     05  MSG1I PIC  X(0072).
  1879*    -------------------------------
  1880     05  MSG2L PIC S9(0004) COMP.
  1881     05  MSG2F PIC  X(0001).
  1882     05  FILLER REDEFINES MSG2F.
  1883         10  MSG2A PIC  X(0001).
  1884     05  MSG2I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  38
* EL131.cbl
  1885*    -------------------------------
  1886     05  PFKEYL PIC S9(0004) COMP.
  1887     05  PFKEYF PIC  X(0001).
  1888     05  FILLER REDEFINES PFKEYF.
  1889         10  PFKEYA PIC  X(0001).
  1890     05  PFKEYI PIC  99.
  1891*    -------------------------------
  1892     05  PFKEY6L PIC S9(0004) COMP.
  1893     05  PFKEY6F PIC  X(0001).
  1894     05  FILLER REDEFINES PFKEY6F.
  1895         10  PFKEY6A PIC  X(0001).
  1896     05  PFKEY6I PIC  X(0016).
  1897 01  EL131AO REDEFINES EL131AI.
  1898     05  FILLER            PIC  X(0012).
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  DATEO PIC  X(0008).
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  TIMEO PIC  99.99.
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  SEQUO PIC  X(0010).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  COMPO PIC  X(0003).
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  USERIDO PIC  X(0004).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  CCNOO PIC  X(0016).
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  MAINTO PIC  X(0001).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  CLAIMO PIC  X(0007).
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  CARRO PIC  X(0001).
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
  1928     05  CERTO PIC  X(0010).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  SUFXO PIC  X(0001).
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  TYPEO PIC  X(0001).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  LABEL1O PIC  X(0011).
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  PCERTNOO PIC  X(0010).
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  39
* EL131.cbl
  1943     05  PSUFXO PIC  X(0001).
  1944*    -------------------------------
  1945     05  FILLER            PIC  X(0003).
  1946     05  STATUSO PIC  X(0006).
  1947*    -------------------------------
  1948     05  FILLER            PIC  X(0003).
  1949     05  INCO PIC  X(0008).
  1950*    -------------------------------
  1951     05  FILLER            PIC  X(0003).
  1952     05  REPO PIC  X(0008).
  1953*    -------------------------------
  1954     05  FILLER            PIC  X(0003).
  1955     05  CAUSEO PIC  X(0006).
  1956*    -------------------------------
  1957     05  FILLER            PIC  X(0003).
  1958     05  ENDO PIC  X(0008).
  1959*    -------------------------------
  1960     05  FILLER            PIC  X(0003).
  1961     05  DIAGO PIC  X(0060).
  1962*    -------------------------------
  1963     05  FILLER            PIC  X(0003).
  1964     05  ACCSWO PIC  X(0001).
  1965*    -------------------------------
  1966     05  FILLER            PIC  X(0003).
  1967     05  BENEO PIC  X(0010).
  1968*    -------------------------------
  1969     05  FILLER            PIC  X(0003).
  1970     05  BIRTHO PIC  X(0008).
  1971*    -------------------------------
  1972     05  FILLER            PIC  X(0003).
  1973     05  SOCIALO PIC  X(0011).
  1974*    -------------------------------
  1975     05  FILLER            PIC  X(0003).
  1976     05  SEXO PIC  X(0001).
  1977*    -------------------------------
  1978     05  FILLER            PIC  X(0003).
  1979     05  MLNAMEO PIC  X(0015).
  1980*    -------------------------------
  1981     05  FILLER            PIC  X(0003).
  1982     05  MFNAMEO PIC  X(0012).
  1983*    -------------------------------
  1984     05  FILLER            PIC  X(0003).
  1985     05  MMINITO PIC  X(0001).
  1986*    -------------------------------
  1987     05  FILLER            PIC  X(0003).
  1988     05  LOANNOO PIC  X(0008).
  1989*    -------------------------------
  1990     05  FILLER            PIC  X(0003).
  1991     05  CRTLNMEO PIC  X(0015).
  1992*    -------------------------------
  1993     05  FILLER            PIC  X(0003).
  1994     05  CRTFNMEO PIC  X(0012).
  1995*    -------------------------------
  1996     05  FILLER            PIC  X(0003).
  1997     05  CRTINITO PIC  X(0001).
  1998*    -------------------------------
  1999     05  FILLER            PIC  X(0003).
  2000     05  LOANBALO PIC  ZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  40
* EL131.cbl
  2001*    -------------------------------
  2002     05  FILLER            PIC  X(0003).
  2003     05  PROCO PIC  X(0004).
  2004*    -------------------------------
  2005     05  FILLER            PIC  X(0003).
  2006     05  SUPVO PIC  X(0001).
  2007*    -------------------------------
  2008     05  FILLER            PIC  X(0003).
  2009     05  PRICDO PIC  X(0001).
  2010*    -------------------------------
  2011     05  FILLER            PIC  X(0003).
  2012     05  CRITPO PIC  X(0002).
  2013*    -------------------------------
  2014     05  FILLER            PIC  X(0003).
  2015     05  CRITPTO PIC  X(0001).
  2016*    -------------------------------
  2017     05  FILLER            PIC  X(0003).
  2018     05  RTWMOSO PIC  X(0002).
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  FILETOO PIC  X(0004).
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  PTHRHDGO PIC  X(0010).
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  PDTHRUO PIC  X(0008).
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  PDAMTO PIC  Z(06).99.
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  NODAYSO PIC  ZZZ99.
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  NOPMTSO PIC  ZZ99.
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  FORMTYPO PIC  X(0001).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  ESTO PIC  X(0008).
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  AUIDO PIC  X(0004).
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  OCCO PIC  X(0006).
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  MNTDTO PIC  X(0008).
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  MNTTYPEO PIC  X(0006).
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  CERTCARO PIC  X(0001).
  2058*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  41
* EL131.cbl
  2059     05  FILLER            PIC  X(0003).
  2060     05  CERTGRPO PIC  X(0006).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
  2063     05  CERTSTO PIC  X(0002).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  CERTACTO PIC  X(0010).
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
  2069     05  CERTEFFO PIC  X(0008).
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  ISSAGEO PIC  X(0002).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  APRO PIC  9(3).9(4).
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  PMTFREQO PIC  99.
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  INDGRPO PIC  X(0001).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  PREMTYPO PIC  X(0001).
  2085*    -------------------------------
  2086     05  FILLER            PIC  X(0003).
  2087     05  REINCDO PIC  X(0001).
  2088*    -------------------------------
  2089     05  FILLER            PIC  X(0003).
  2090     05  JNTLNMEO PIC  X(0015).
  2091*    -------------------------------
  2092     05  FILLER            PIC  X(0003).
  2093     05  JNTFNMEO PIC  X(0012).
  2094*    -------------------------------
  2095     05  FILLER            PIC  X(0003).
  2096     05  JNTINITO PIC  X(0001).
  2097*    -------------------------------
  2098     05  FILLER            PIC  X(0003).
  2099     05  JNTAGEO PIC  X(0002).
  2100*    -------------------------------
  2101     05  FILLER            PIC  X(0003).
  2102     05  ADDONDTO PIC  X(0008).
  2103*    -------------------------------
  2104     05  FILLER            PIC  X(0003).
  2105     05  LCVDSCRO PIC  X(0006).
  2106*    -------------------------------
  2107     05  FILLER            PIC  X(0003).
  2108     05  LCVKINDO PIC  X(0003).
  2109*    -------------------------------
  2110     05  FILLER            PIC  X(0003).
  2111     05  LCVCDO PIC  X(0002).
  2112*    -------------------------------
  2113     05  FILLER            PIC  X(0003).
  2114     05  LCVOTRMO PIC  999.
  2115*    -------------------------------
  2116     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  42
* EL131.cbl
  2117     05  LCVRTRMO PIC  999.
  2118*    -------------------------------
  2119     05  FILLER            PIC  X(0003).
  2120     05  LCVRATEO PIC  ZZZ.ZZ.
  2121*    -------------------------------
  2122     05  FILLER            PIC  X(0003).
  2123     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2124*    -------------------------------
  2125     05  FILLER            PIC  X(0003).
  2126     05  LCVFORMO PIC  X(0012).
  2127*    -------------------------------
  2128     05  FILLER            PIC  X(0003).
  2129     05  LCVCNDTO PIC  X(0008).
  2130*    -------------------------------
  2131     05  FILLER            PIC  X(0003).
  2132     05  LCVEXITO PIC  X(0008).
  2133*    -------------------------------
  2134     05  FILLER            PIC  X(0003).
  2135     05  LCVSTATO PIC  X(0006).
  2136*    -------------------------------
  2137     05  FILLER            PIC  X(0003).
  2138     05  ACVDSCRO PIC  X(0006).
  2139*    -------------------------------
  2140     05  FILLER            PIC  X(0003).
  2141     05  ACVKINDO PIC  X(0003).
  2142*    -------------------------------
  2143     05  FILLER            PIC  X(0003).
  2144     05  ACVCDO PIC  X(0002).
  2145*    -------------------------------
  2146     05  FILLER            PIC  X(0003).
  2147     05  ACVOTRMO PIC  999.
  2148*    -------------------------------
  2149     05  FILLER            PIC  X(0003).
  2150     05  ACVRTRMO PIC  999.
  2151*    -------------------------------
  2152     05  FILLER            PIC  X(0003).
  2153     05  ACVRATEO PIC  ZZZ.ZZ.
  2154*    -------------------------------
  2155     05  FILLER            PIC  X(0003).
  2156     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2157*    -------------------------------
  2158     05  FILLER            PIC  X(0003).
  2159     05  ACVFORMO PIC  X(0012).
  2160*    -------------------------------
  2161     05  FILLER            PIC  X(0003).
  2162     05  ACVCNDTO PIC  X(0008).
  2163*    -------------------------------
  2164     05  FILLER            PIC  X(0003).
  2165     05  ACVEXITO PIC  X(0008).
  2166*    -------------------------------
  2167     05  FILLER            PIC  X(0003).
  2168     05  ACVSTATO PIC  X(0006).
  2169*    -------------------------------
  2170     05  FILLER            PIC  X(0003).
  2171     05  LABEL2O PIC  X(0014).
  2172*    -------------------------------
  2173     05  FILLER            PIC  X(0003).
  2174     05  BCERT1O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  43
* EL131.cbl
  2175*    -------------------------------
  2176     05  FILLER            PIC  X(0003).
  2177     05  BSUFX1O PIC  X(0001).
  2178*    -------------------------------
  2179     05  FILLER            PIC  X(0003).
  2180     05  BCERT2O PIC  X(0010).
  2181*    -------------------------------
  2182     05  FILLER            PIC  X(0003).
  2183     05  BSUFX2O PIC  X(0001).
  2184*    -------------------------------
  2185     05  FILLER            PIC  X(0003).
  2186     05  BCERT3O PIC  X(0010).
  2187*    -------------------------------
  2188     05  FILLER            PIC  X(0003).
  2189     05  BSUFX3O PIC  X(0001).
  2190*    -------------------------------
  2191     05  FILLER            PIC  X(0003).
  2192     05  BCERT4O PIC  X(0010).
  2193*    -------------------------------
  2194     05  FILLER            PIC  X(0003).
  2195     05  BSUFX4O PIC  X(0001).
  2196*    -------------------------------
  2197     05  FILLER            PIC  X(0003).
  2198     05  BCERT5O PIC  X(0010).
  2199*    -------------------------------
  2200     05  FILLER            PIC  X(0003).
  2201     05  BSUFX5O PIC  X(0001).
  2202*    -------------------------------
  2203     05  FILLER            PIC  X(0003).
  2204     05  MSG1O PIC  X(0072).
  2205*    -------------------------------
  2206     05  FILLER            PIC  X(0003).
  2207     05  MSG2O PIC  X(0072).
  2208*    -------------------------------
  2209     05  FILLER            PIC  X(0003).
  2210     05  PFKEYO PIC  X(0002).
  2211*    -------------------------------
  2212     05  FILLER            PIC  X(0003).
  2213     05  PFKEY6O PIC  X(0016).
  2214*    -------------------------------
  2215
  2216*                                COPY ELCEMIB SUPPRESS.
  2217******************************************************************
  2218*                                                                *
  2219*                                                                *
  2220*                            ELCEMIB.                            *
  2221*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2222*                            VMOD=2.005                          *
  2223*                                                                *
  2224*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2225*                                                                *
  2226******************************************************************
  2227 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2228     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2229     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2230     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2231     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2232     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  44
* EL131.cbl
  2233     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2234     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2235     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2236     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2237         88  EMI-NO-ERRORS                    VALUE '1'.
  2238         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2239         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2240     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2241         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2242     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2243         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2244         88  EMI-AREA1-FULL                   VALUE '2'.
  2245     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2246         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2247         88  EMI-AREA2-FULL                   VALUE '2'.
  2248     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2249         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2250         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2251         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2252         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2253         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2254     12  EMI-ERROR-LINES.
  2255         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2256         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2257         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2258         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2259             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2260                 24  EMI-ERR-NUM         PIC X(4).
  2261                 24  EMI-FILLER          PIC X.
  2262                 24  EMI-SEV             PIC X.
  2263                 24  FILLER              PIC X.
  2264             20  FILLER                  PIC X(02).
  2265     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2266         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2267             20  EMI-ERROR-NUMBER    PIC X(4).
  2268             20  EMI-FILL            PIC X.
  2269             20  EMI-SEVERITY        PIC X.
  2270             20  FILLER              PIC X.
  2271             20  EMI-ERROR-TEXT.
  2272                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2273                 24  FILLER          PIC X(55).
  2274     12  EMI-SEVERITY-SAVE           PIC X.
  2275         88  EMI-NOTE                    VALUE 'N'.
  2276         88  EMI-WARNING                 VALUE 'W'.
  2277         88  EMI-FORCABLE                VALUE 'F'.
  2278         88  EMI-FATAL                   VALUE 'X'.
  2279     12  EMI-MESSAGE-FLAG            PIC X.
  2280         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2281         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2282     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2283     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2284         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2285         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2286         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2287     12  emi-claim-no                pic x(7).
  2288     12  emi-claim-type              pic x(6).
  2289     12  FILLER                      PIC X(124)  VALUE SPACES.
  2290     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  45
* EL131.cbl
  2291     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2292     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2293     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2294
  2295*                                COPY ELCJPFX SUPPRESS.
  2296******************************************************************
  2297*                                                                *
  2298*                                                                *
  2299*                            ELCJPFX.                            *
  2300*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2301*                            VMOD=2.002                          *
  2302*                                                                *
  2303*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2304*                                                                *
  2305*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2306*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2307*        ELCNTL - CONTROL FILE                                   *
  2308*        ELMSTR - CLAIM MASTERS                                  *
  2309*        ELTRLR - ACTIVITY TRAILERS                              *
  2310*        ELCHKQ - CHECK QUE                                      *
  2311******************************************************************
  2312 01  JOURNAL-RECORD.
  2313     12  JP-USER-ID                  PIC X(4).
  2314     12  JP-FILE-ID                  PIC X(8).
  2315     12  JP-PROGRAM-ID               PIC X(8).
  2316     12  JP-RECORD-TYPE              PIC X.
  2317         88 JP-ADD              VALUE 'A'.
  2318         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2319         88 JP-AFTER-CHANGE     VALUE 'C'.
  2320         88 JP-DELETE           VALUE 'D'.
  2321         88 JP-GENERIC-DELETE   VALUE 'G'.
  2322         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2323         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2324     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2325     12  JP-RECORD-AREA
  2326
  2327
  2328                                 PIC X(750).
  2329
  2330*                                COPY ELCCALC.
  2331******************************************************************
  2332*                                                                *
  2333*                           ELCCALC.                            *
  2334*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2335*                            VMOD=2.025                          *
  2336*                                                                *
  2337*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2338*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2339*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2340*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2341*                                                                *
  2342*  PASSED TO ELRTRM                                              *
  2343*  -----------------                                             *
  2344*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2345*  ORIGINAL TERM                                                 *
  2346*  BEGINNING DATE                                                *
  2347*  ENDING DATE                                                   *
  2348*  COMPANY I.D.                                                  *
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  46
* EL131.cbl
  2349*  ACCOUNT MASTER USER FIELD                                     *
  2350*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2351*  FREE LOOK DAYS                                                *
  2352*                                                                *
  2353*  RETURNED FROM ELRTRM                                          *
  2354*  ---------------------                                         *
  2355*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2356*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2357*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2358*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2359*----------------------------------------------------------------*
  2360*  PASSED TO ELRAMT                                              *
  2361*  ----------------                                              *
  2362*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2363*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2364*  ORIGINAL AMOUNT                                               *
  2365*  ALTERNATE BENEFIT (BALLON)                                    *
  2366*  A.P.R. - NET PAY ONLY                                         *
  2367*  METHOD
  2368*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2369*  COMPANY I.D.                                                  *
  2370*  BENEFIT TYPE                                                  *
  2371*                                                                *
  2372*  RETURNED FROM ELRAMT                                          *
  2373*  --------------------                                          *
  2374*  REMAINING AMOUNT 1 - CURRENT                                  *
  2375*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2376*  REMAINING AMOUNT FACTOR
  2377*----------------------------------------------------------------*
  2378*  PASSED TO ELRESV                                              *
  2379*  -----------------                                             *
  2380*  CERTIFICATE EFFECTIVE DATE                                    *
  2381*  VALUATION DATE                                                *
  2382*  PAID THRU DATE                                                *
  2383*  BENEFIT                                                       *
  2384*  INCURRED DATE                                                 *
  2385*  REPORTED DATE                                                 *
  2386*  ISSUE AGE                                                     *
  2387*  TERM                                                          *
  2388*  CDT PERCENT                                                   *
  2389*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2390* *CLAIM TYPE (LIFE, A/H)                                        *
  2391* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2392* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2393*                                                                *
  2394*  RETURNED FROM ELRESV                                          *
  2395*  --------------------                                          *
  2396*  CDT TABLE USED                                                *
  2397*  CDT FACTOR USED                                               *
  2398*  PAY TO CURRENT RESERVE                                        *
  2399*  I.B.N.R. - A/H ONLY                                           *
  2400*  FUTURE (ACCRUED) AH ONLY                                      *
  2401*----------------------------------------------------------------*
  2402*  PASSED TO ELRATE                                              *
  2403*  ----------------                                              *
  2404*  CERT ISSUE DATE                                               *
  2405*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2406*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  47
* EL131.cbl
  2407*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2408*  STATE CODE (CLIENT DEFINED)                                   *
  2409*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2410*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2411*  DEVIATION CODE                                                *
  2412*  ISSUE AGE                                                     *
  2413*  ORIGINAL BENEFIT AMOUNT                                       *
  2414*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2415*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2416*  BENEFIT KIND (LIFE OR A/H)                                    *
  2417*  A.P.R.                                                        *
  2418*  METHOD
  2419*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2420*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2421*  COMPANY I.D. (3 CHARACTER)                                    *
  2422*  BENEFIT CODE                                                  *
  2423*  BENEFIT OVERRIDE CODE                                         *
  2424*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2425*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2426*  JOINT INDICATOR (CSL ONLY)                                    *
  2427*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2428*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2429*                                                                *
  2430*  RETURNED FROM ELRATE                                          *
  2431*  --------------------                                          *
  2432*  CALCULATED PREMIUM                                            *
  2433*  PREMIUM RATE                                                  *
  2434*  MORTALITY CODE                                                *
  2435*  MAX ATTAINED AGE                                              *
  2436*  MAX AGE                                                       *
  2437*  MAX TERM                                                      *
  2438*  MAX MONTHLY BENEFIT                                           *
  2439*  MAX TOTAL BENIFIT                                             *
  2440*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2441*----------------------------------------------------------------*
  2442*  PASSED TO ELRFND                                              *
  2443*  ----------------                                              *
  2444*  CERT ISSUE DATE                                               *
  2445*  REFUND DATE                                                   *
  2446*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2447*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2448*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2449*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2450*  STATE CODE (CLIENT DEFINED)                                   *
  2451*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2452*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2453*  DEVIATION CODE                                                *
  2454*  ISSUE AGE                                                     *
  2455*  ORIGINAL BENEFIT AMOUNT                                       *
  2456*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2457*  PROCESS TYPE (CANCEL)                                         *
  2458*  BENEFIT KIND (LIFE OR A/H)                                    *
  2459*  A.P.R.                                                        *
  2460*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2461*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2462*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2463*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2464*  COMPANY I.D. (3 CHARACTER)                                    *
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  48
* EL131.cbl
  2465*  BENEFIT CODE                                                  *
  2466*  BENEFIT OVERRIDE CODE                                         *
  2467*                                                                *
  2468*  RETURNED FROM ELRFND                                          *
  2469*  --------------------                                          *
  2470*  CALCULATED REFUND                                             *
  2471*----------------------------------------------------------------*
  2472*  PASSED TO ELEARN                                              *
  2473*  ----------------                                              *
  2474*  CERT ISSUE DATE                                               *
  2475*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2476*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2477*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2478*  STATE CODE (CLIENT DEFINED)                                   *
  2479*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2480*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2481*  DEVIATION CODE                                                *
  2482*  ISSUE AGE                                                     *
  2483*  ORIGINAL BENEFIT AMOUNT                                       *
  2484*  BENEFIT KIND (LIFE OR A/H)                                    *
  2485*  A.P.R.                                                        *
  2486*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2487*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2488*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2489*  COMPANY I.D. (3 CHARACTER)                                    *
  2490*  BENEFIT CODE                                                  *
  2491*  BENEFIT OVERRIDE CODE                                         *
  2492*                                                                *
  2493*  RETURNED FROM ELEARN                                          *
  2494*  --------------------                                          *
  2495*  INDICATED  EARNINGS                                           *
  2496*----------------------------------------------------------------*
  2497*                 LENGTH = 450                                   *
  2498*                                                                *
  2499******************************************************************
  2500******************************************************************
  2501*                   C H A N G E   L O G
  2502*
  2503* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2504*-----------------------------------------------------------------
  2505*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2506* EFFECTIVE    NUMBER
  2507*-----------------------------------------------------------------
  2508* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2509* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2510* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2511* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2512* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2513* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2514* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2515* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2516* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2517******************************************************************
  2518
  2519 01  CALCULATION-PASS-AREA.
  2520     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2521                                     COMP.
  2522
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  49
* EL131.cbl
  2523     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2524       88  NO-CP-ERROR                             VALUE ZERO.
  2525       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2526                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2527       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2528       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2529       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2530       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2531       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2532       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2533       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2534       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2535       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2536       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2537       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2538       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2539       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2540       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2541       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2542       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2543       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2544
  2545     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2546       88  NO-CP-ERROR-2                           VALUE ZERO.
  2547***********************  INPUT AREAS ****************************
  2548
  2549     12  CP-CALCULATION-AREA.
  2550         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2551         16  CP-CERT-EFF-DT        PIC XX.
  2552         16  CP-VALUATION-DT       PIC XX.
  2553         16  CP-PAID-THRU-DT       PIC XX.
  2554         16  CP-BENEFIT-TYPE       PIC X.
  2555           88  CP-AH                               VALUE 'A' 'D'
  2556                                                   'I' 'U'.
  2557           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2558           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2559         16  CP-INCURRED-DT        PIC XX.
  2560         16  CP-REPORTED-DT        PIC XX.
  2561         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2562         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2563         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2564                                     COMP-3.
  2565         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2566                                     COMP-3.
  2567         16  CP-CDT-METHOD         PIC X.
  2568           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2569           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2570           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2571         16  CP-CLAIM-TYPE         PIC X.
  2572           88  CP-AH-CLAIM                         VALUE 'A'.
  2573           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2574         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2575                                     COMP-3.
  2576         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2577                                     COMP-3.
  2578         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2579                                     COMP-3.
  2580         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  50
* EL131.cbl
  2581                                     COMP-3.
  2582         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2583                                     COMP-3.
  2584         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2585                                     COMP-3.
  2586         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2587                                     COMP-3.
  2588         16  CP-REM-TERM-METHOD    PIC X.
  2589           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2590           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2591           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2592           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2593           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2594           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2595           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2596         16  CP-EARNING-METHOD     PIC X.
  2597           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2598           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2599           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2600           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2601           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2602           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2603           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2604           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2605           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2606           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2607           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2608           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2609           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2610           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2611         16  CP-PROCESS-TYPE       PIC X.
  2612           88  CP-CLAIM                            VALUE '1'.
  2613           88  CP-CANCEL                           VALUE '2'.
  2614           88  CP-ISSUE                            VALUE '3'.
  2615         16  CP-SPECIAL-CALC-CD    PIC X.
  2616           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2617           88  CP-1-MTH-INTEREST               VALUE ' '.
  2618           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2619           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2620           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2621           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2622           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2623           88  CP-FARM-PLAN                    VALUE 'F'.
  2624           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2625           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2626           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2627           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2628           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2629           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2630           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2631           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2632           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2633           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2634                                                     'W' 'X'.
  2635           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2636           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2637           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2638           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  51
* EL131.cbl
  2639           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2640           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2641           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2642           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2643           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2644           88  CP-CSL-METH-1                   VALUE '5'.
  2645           88  CP-CSL-METH-2                   VALUE '6'.
  2646           88  CP-CSL-METH-3                   VALUE '7'.
  2647           88  CP-CSL-METH-4                   VALUE '8'.
  2648
  2649         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2650                                     COMP-3.
  2651         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2652         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2653         16  CP-STATE              PIC XX          VALUE SPACE.
  2654         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2655         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2656           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2657               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2658         16  CP-R78-OPTION         PIC X.
  2659           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2660           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2661
  2662         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2663         16  CP-IBNR-RESERVE-SW    PIC X.
  2664         16  CP-CLAIM-STATUS       PIC X.
  2665         16  CP-RATE-FILE          PIC X.
  2666         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2667                                     COMP-3.
  2668
  2669         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2670         16  CP-AH-OVERRIDE-CODE   PIC X.
  2671
  2672         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2673                                     COMP-3.
  2674         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2675                                   PIC S9(5)V99 COMP-3.
  2676         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2677                                     COMP-3.
  2678         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2679                                     COMP-3.
  2680         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2681                                     COMP-3.
  2682         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2683                                  PIC S9(7)V99 COMP-3.
  2684
  2685         16  CP-PAID-FROM-DATE     PIC X(02).
  2686         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2687         16  CP-EXT-DAYS-CALC      PIC X.
  2688           88  CP-EXT-NO-CHG                   VALUE ' '.
  2689           88  CP-EXT-CHG-LF                   VALUE '1'.
  2690           88  CP-EXT-CHG-AH                   VALUE '2'.
  2691           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2692         16  CP-DOMICILE-STATE     PIC XX.
  2693         16  CP-CARRIER            PIC X.
  2694         16  CP-REIN-FLAG          PIC X.
  2695         16  CP-REM-TRM-CALC-OPTION PIC X.
  2696           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  52
* EL131.cbl
  2697                      '2' '3' '4' '5'.
  2698           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2699           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2700           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2701           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2702           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2703           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2704           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2705           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2706         16  CP-SIG-SWITCH         PIC X.
  2707         16  CP-RATING-METHOD      PIC X.
  2708           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2709           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2710           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2711           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2712           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2713           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2714           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2715           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2716           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2717         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2718                                     COMP-3.
  2719         16  CP-BEN-CATEGORY       PIC X.
  2720         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2721         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2722                                   PIC S99V9(5) COMP-3.
  2723         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2724         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2725                                   PIC S99V9(5) COMP-3.
  2726         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2727         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2728         16  CP-EXPIRE-DT          PIC XX.
  2729         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2730         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2731         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2732         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2733         16  CP-DDF-SPEC-CALC      PIC X.
  2734             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2735             88  CP-CALC-CLP              VALUE 'C'.
  2736         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2737         16  CP-CANCEL-REASON      PIC X.
  2738         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2739         16  CP-PMT-MODE           PIC X.
  2740         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2741         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2742         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2743         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2744         16  FILLER                PIC X.
  2745
  2746***************    OUTPUT FROM ELRESV   ************************
  2747
  2748         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2749
  2750         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2751                                     COMP-3.
  2752         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2753                                     COMP-3.
  2754         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  53
* EL131.cbl
  2755                                     COMP-3.
  2756         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2757                                     COMP-3.
  2758         16  FILLER                PIC X(09).
  2759***************    OUTPUT FROM ELRTRM   *************************
  2760
  2761         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2762                                     COMP-3.
  2763         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2764                                     COMP-3.
  2765         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2766                                     COMP-3.
  2767         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2768                                     COMP-3.
  2769         16  FILLER                PIC X(12).
  2770
  2771***************    OUTPUT FROM ELRAMT   *************************
  2772
  2773         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2774                                     COMP-3.
  2775         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2776                                     COMP-3.
  2777         16  FILLER                PIC X(12).
  2778
  2779***************    OUTPUT FROM ELRATE   *************************
  2780
  2781         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2782                                     COMP-3.
  2783         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2784                                     COMP-3.
  2785         16  CP-MORTALITY-CODE     PIC X(4).
  2786         16  CP-RATE-EDIT-FLAG     PIC X.
  2787             88  CP-RATES-NEED-APR                  VALUE '1'.
  2788         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2789                                     COMP-3.
  2790         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2791         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2792         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2793                                   PIC S9(7)V99 COMP-3.
  2794         16  FILLER                PIC X(07).
  2795
  2796***************    OUTPUT FROM ELRFND   *************************
  2797
  2798         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2799                                     COMP-3.
  2800         16  CP-REFUND-TYPE-USED   PIC X.
  2801           88  CP-R-AS-R78                         VALUE '1'.
  2802           88  CP-R-AS-PRORATA                     VALUE '2'.
  2803           88  CP-R-AS-CALIF                       VALUE '3'.
  2804           88  CP-R-AS-TEXAS                       VALUE '4'.
  2805           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2806           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2807           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2808           88  CP-R-AS-MEAN                        VALUE '8'.
  2809           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2810           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2811           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2812           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  54
* EL131.cbl
  2813           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2814           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2815         16  FILLER                PIC X(12).
  2816
  2817***************    OUTPUT FROM ELEARN   *************************
  2818
  2819         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2820                                     COMP-3.
  2821         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2822                                     COMP-3.
  2823         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2824                                     COMP-3.
  2825         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2826                                     COMP-3.
  2827         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2828                                     COMP-3.
  2829         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2830                                     COMP-3.
  2831         16  CP-EARNING-TYPE-USED  PIC X.
  2832           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2833           88  CP-E-AS-R78                         VALUE '1'.
  2834           88  CP-E-AS-PRORATA                     VALUE '2'.
  2835           88  CP-E-AS-TEXAS                       VALUE '4'.
  2836           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2837           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2838           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2839           88  CP-E-AS-MEAN                        VALUE '8'.
  2840           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2841         16  FILLER                PIC X(12).
  2842
  2843***************    OUTPUT FROM ELPMNT   *************************
  2844
  2845         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2846                                     COMP-3.
  2847         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2848                                     COMP-3.
  2849         16  FILLER                PIC X(12).
  2850
  2851***************   MISC WORK AREAS    *****************************
  2852         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2853                                     COMP-3.
  2854         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2855                                     COMP-3.
  2856         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2857                                     COMP-3.
  2858         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2859                                     COMP-3.
  2860         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2861                                     COMP-3.
  2862         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2863                                     COMP-3.
  2864         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2865             88  OPEN-RATE-FILE                   VALUE 'O'.
  2866             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2867             88  IO-ERROR                         VALUE 'E'.
  2868
  2869         16  CP-FIRST-PAY-DATE     PIC XX.
  2870
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  55
* EL131.cbl
  2871         16  CP-JOINT-INDICATOR    PIC X.
  2872
  2873         16  CP-RESERVE-REMAINING-TERM
  2874                                   PIC S9(4)V9    VALUE ZERO
  2875                                     COMP-3.
  2876
  2877         16  CP-INSURED-BIRTH-DT   PIC XX.
  2878
  2879         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2880                                     COMP-3.
  2881
  2882         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2883                                     COMP-3.
  2884
  2885         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2886                                     COMP-3.
  2887
  2888         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2889                                     COMP-3.
  2890
  2891         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2892                                     COMP-3.
  2893
  2894         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2895                                     COMP-3.
  2896
  2897         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2898                                     COMP-3.
  2899
  2900         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2901             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2902
  2903         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2904                                     COMP-3.
  2905         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2906                                     COMP-3.
  2907         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2908         16  FILLER                PIC X(15).
  2909******************************************************************
  2910
  2911*                                COPY ELCDATE.
  2912******************************************************************
  2913*                                                                *
  2914*                                                                *
  2915*                            ELCDATE.                            *
  2916*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2917*                            VMOD=2.003
  2918*                                                                *
  2919*                                                                *
  2920*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2921*                 LENGTH = 200                                   *
  2922******************************************************************
  2923
  2924 01  DATE-CONVERSION-DATA.
  2925     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2926     12  DC-OPTION-CODE                PIC X.
  2927         88  BIN-TO-GREG                VALUE ' '.
  2928         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  56
* EL131.cbl
  2929         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2930         88  YMD-GREG-TO-BIN            VALUE '3'.
  2931         88  MDY-GREG-TO-BIN            VALUE '4'.
  2932         88  JULIAN-TO-BIN              VALUE '5'.
  2933         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2934         88  FIND-CENTURY               VALUE '7'.
  2935         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2936         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2937         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2938         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2939         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2940         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2941         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2942         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2943         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2944         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2945         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2946         88  BIN-3-TO-GREG              VALUE 'I'.
  2947         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2948         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2949         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2950         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2951         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2952         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2953         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2954         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2955         88  THREE-CHARACTER-BIN
  2956                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2957         88  GREGORIAN-TO-BIN
  2958                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2959         88  BIN-TO-GREGORIAN
  2960                  VALUES ' ' '1' 'I' '8' 'G'.
  2961         88  JULIAN-TO-BINARY
  2962                  VALUES '5' 'C' 'E' 'F'.
  2963     12  DC-ERROR-CODE                 PIC X.
  2964         88  NO-CONVERSION-ERROR        VALUE ' '.
  2965         88  DATE-CONVERSION-ERROR
  2966                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2967         88  DATE-IS-ZERO               VALUE '1'.
  2968         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2969         88  DATE-IS-INVALID            VALUE '3'.
  2970         88  DATE1-GREATER-DATE2        VALUE '4'.
  2971         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2972         88  DATE-INVALID-OPTION        VALUE '9'.
  2973         88  INVALID-CENTURY            VALUE 'A'.
  2974         88  ONLY-CENTURY               VALUE 'B'.
  2975         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2976         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2977     12  DC-END-OF-MONTH               PIC X.
  2978         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2979     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2980         88  USE-NORMAL-PROCESS         VALUE ' '.
  2981         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2982         88  ADJUST-UP-100-YRS          VALUE '2'.
  2983     12  FILLER                        PIC X.
  2984     12  DC-CONVERSION-DATES.
  2985         16  DC-BIN-DATE-1             PIC XX.
  2986         16  DC-BIN-DATE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  57
* EL131.cbl
  2987         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2988         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2989                       DC-GREG-DATE-1-EDIT.
  2990             20  DC-EDIT1-MONTH        PIC 99.
  2991             20  SLASH1-1              PIC X.
  2992             20  DC-EDIT1-DAY          PIC 99.
  2993             20  SLASH1-2              PIC X.
  2994             20  DC-EDIT1-YEAR         PIC 99.
  2995         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2996         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2997                     DC-GREG-DATE-2-EDIT.
  2998             20  DC-EDIT2-MONTH        PIC 99.
  2999             20  SLASH2-1              PIC X.
  3000             20  DC-EDIT2-DAY          PIC 99.
  3001             20  SLASH2-2              PIC X.
  3002             20  DC-EDIT2-YEAR         PIC 99.
  3003         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3004         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3005                     DC-GREG-DATE-1-YMD.
  3006             20  DC-YMD-YEAR           PIC 99.
  3007             20  DC-YMD-MONTH          PIC 99.
  3008             20  DC-YMD-DAY            PIC 99.
  3009         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3010         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3011                      DC-GREG-DATE-1-MDY.
  3012             20  DC-MDY-MONTH          PIC 99.
  3013             20  DC-MDY-DAY            PIC 99.
  3014             20  DC-MDY-YEAR           PIC 99.
  3015         16  DC-GREG-DATE-1-ALPHA.
  3016             20  DC-ALPHA-MONTH        PIC X(10).
  3017             20  DC-ALPHA-DAY          PIC 99.
  3018             20  FILLER                PIC XX.
  3019             20  DC-ALPHA-CENTURY.
  3020                 24 DC-ALPHA-CEN-N     PIC 99.
  3021             20  DC-ALPHA-YEAR         PIC 99.
  3022         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3023         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3024         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3025         16  DC-JULIAN-DATE            PIC 9(05).
  3026         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3027                                       PIC 9(05).
  3028         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3029             20  DC-JULIAN-YEAR        PIC 99.
  3030             20  DC-JULIAN-DAYS        PIC 999.
  3031         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3032         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3033         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3034     12  DATE-CONVERSION-VARIBLES.
  3035         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3036         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3037             20  FILLER                PIC 9(3).
  3038             20  HOLD-CEN-1-CCYY.
  3039                 24  HOLD-CEN-1-CC     PIC 99.
  3040                 24  HOLD-CEN-1-YY     PIC 99.
  3041             20  HOLD-CEN-1-MO         PIC 99.
  3042             20  HOLD-CEN-1-DA         PIC 99.
  3043         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3044             20  HOLD-CEN-1-R-MO       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  58
* EL131.cbl
  3045             20  HOLD-CEN-1-R-DA       PIC 99.
  3046             20  HOLD-CEN-1-R-CCYY.
  3047                 24  HOLD-CEN-1-R-CC   PIC 99.
  3048                 24  HOLD-CEN-1-R-YY   PIC 99.
  3049             20  FILLER                PIC 9(3).
  3050         16  HOLD-CENTURY-1-X.
  3051             20  FILLER                PIC X(3)  VALUE SPACES.
  3052             20  HOLD-CEN-1-X-CCYY.
  3053                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3054                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3055             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3056             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3057         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3058             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3059             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3060             20  HOLD-CEN-1-R-X-CCYY.
  3061                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3062                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3063             20  FILLER                PIC XXX.
  3064         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3065         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3066         16  DC-JULIAN-DATE-1          PIC 9(07).
  3067         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3068             20  DC-JULIAN-1-CCYY.
  3069                 24  DC-JULIAN-1-CC    PIC 99.
  3070                 24  DC-JULIAN-1-YR    PIC 99.
  3071             20  DC-JULIAN-DA-1        PIC 999.
  3072         16  DC-JULIAN-DATE-2          PIC 9(07).
  3073         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3074             20  DC-JULIAN-2-CCYY.
  3075                 24  DC-JULIAN-2-CC    PIC 99.
  3076                 24  DC-JULIAN-2-YR    PIC 99.
  3077             20  DC-JULIAN-DA-2        PIC 999.
  3078         16  DC-GREG-DATE-A-EDIT.
  3079             20  DC-EDITA-MONTH        PIC 99.
  3080             20  SLASHA-1              PIC X VALUE '/'.
  3081             20  DC-EDITA-DAY          PIC 99.
  3082             20  SLASHA-2              PIC X VALUE '/'.
  3083             20  DC-EDITA-CCYY.
  3084                 24  DC-EDITA-CENT     PIC 99.
  3085                 24  DC-EDITA-YEAR     PIC 99.
  3086         16  DC-GREG-DATE-B-EDIT.
  3087             20  DC-EDITB-MONTH        PIC 99.
  3088             20  SLASHB-1              PIC X VALUE '/'.
  3089             20  DC-EDITB-DAY          PIC 99.
  3090             20  SLASHB-2              PIC X VALUE '/'.
  3091             20  DC-EDITB-CCYY.
  3092                 24  DC-EDITB-CENT     PIC 99.
  3093                 24  DC-EDITB-YEAR     PIC 99.
  3094         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3095         16  DC-GREG-DATE-CYMD-R REDEFINES
  3096                              DC-GREG-DATE-CYMD.
  3097             20  DC-CYMD-CEN           PIC 99.
  3098             20  DC-CYMD-YEAR          PIC 99.
  3099             20  DC-CYMD-MONTH         PIC 99.
  3100             20  DC-CYMD-DAY           PIC 99.
  3101         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3102         16  DC-GREG-DATE-MDCY-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  59
* EL131.cbl
  3103                              DC-GREG-DATE-MDCY.
  3104             20  DC-MDCY-MONTH         PIC 99.
  3105             20  DC-MDCY-DAY           PIC 99.
  3106             20  DC-MDCY-CEN           PIC 99.
  3107             20  DC-MDCY-YEAR          PIC 99.
  3108    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3109        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3110    12  DC-EL310-DATE                  PIC X(21).
  3111    12  FILLER                         PIC X(28).
  3112
  3113*                                COPY ELCDMO.
  3114******************************************************************
  3115*                                                                *
  3116*                                                                *
  3117*                            ELCDMO.                             *
  3118*                            VMOD=2.004                          *
  3119*                                                                *
  3120*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3121*        COMMUNICATION AREA                                      *
  3122*   FILE TYPE = NA                                               *
  3123*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3124*                                                                *
  3125******************************************************************
  3126 01  DMO-COMMUNICATION-AREA.
  3127     12  DM-RECORD-TYPE                  PIC  X(02).
  3128             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3129             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3130             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3131     12  DM-DIST-CODE                    PIC  X(04).
  3132     12  DM-MAIL-CODE                    PIC  X(05).
  3133     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3134     12  DM-INSURED-NAME                 PIC  X(30).
  3135     12  DM-CLAIM-NO                     PIC  X(07).
  3136     12  DM-CLAIM-TYPE                   PIC  X.
  3137
  3138     12  DM-STATUS-DATA-AREA.
  3139         16  DM-CLAIM-STATUS             PIC  X.
  3140             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3141             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3142             88  DM-CLOSED                        VALUE '3'.
  3143             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3144             88  DM-DEFAULT                       VALUE '9'.
  3145         16  DM-STATUS-DATE              PIC  X(08).
  3146******YYYYMMDD
  3147         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3148             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3149             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3150             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3151             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3152             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3153             88  DM-RE-OPENED                     VALUE 'R'.
  3154             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3155             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3156             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3157         16  DM-STAT-CARRIER             PIC X.
  3158
  3159     12  DM-DRAFT-DATA-AREA.
  3160         16  DM-PAYMENT-TYPE             PIC  X.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  60
* EL131.cbl
  3161             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3162         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3163         16  DM-PAYMENT-DATE             PIC  X(08).
  3164******YYYYMMDD
  3165         16  DM-CERT-NO                  PIC  X(11).
  3166         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3167         16  DM-CARRIER                  PIC  X.
  3168
  3169     12  DM-RETURN-CODE                  PIC  XX.
  3170*                                COPY ERCPDEF.
  3171******************************************************************
  3172*                                                                *
  3173*                                                                *
  3174*                            ERCPDEF.                            *
  3175*                                                                *
  3176*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3177*                                                                *
  3178*    FILE TYPE = VSAM,KSDS                                       *
  3179*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3180*                                                                *
  3181*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3182*                                                                *
  3183*    LOG = YES                                                   *
  3184*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3185******************************************************************
  3186 01  PRODUCT-MASTER.
  3187    12  PD-RECORD-ID                 PIC X(02).
  3188        88  VALID-PD-ID                  VALUE 'PD'.
  3189    12  PD-CONTROL-PRIMARY.
  3190        16  PD-COMPANY-CD            PIC X.
  3191        16  PD-STATE                 PIC XX.
  3192        16  PD-PRODUCT-CD            PIC XXX.
  3193        16  PD-FILLER                PIC X(7).
  3194        16  PD-BEN-TYPE              PIC X.
  3195        16  PD-BEN-CODE              PIC XX.
  3196        16  PD-PROD-EXP-DT           PIC XX.
  3197    12  FILLER                       PIC X(50).
  3198    12  PD-PRODUCT-DATA OCCURS 8.
  3199        16  PD-PROD-CODE             PIC X.
  3200            88  PD-PROD-LIFE           VALUE 'L'.
  3201            88  PD-PROD-PROP           VALUE 'P'.
  3202            88  PD-PROD-AH             VALUE 'A'.
  3203            88  PD-PROD-IU             VALUE 'I'.
  3204            88  PD-PROD-GAP            VALUE 'G'.
  3205        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3206        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3207        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3208        16  PD-MAX-TERM              PIC S999        COMP-3.
  3209        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3210        16  FILLER                   PIC X.
  3211        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3212        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3213        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3214        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3215        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3216        16  PD-REC-CRIT-PERIOD       PIC X.
  3217        16  PD-RTW-MOS               PIC 99.
  3218        16  FILLER                   PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  61
* EL131.cbl
  3219    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3220    12  PD-TERM-LIMITS OCCURS 15.
  3221        16  PD-LOW-TERM              PIC S999        COMP-3.
  3222        16  PD-HI-TERM               PIC S999        COMP-3.
  3223*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3224    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3225        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3226        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3227    12  PD-EARN-FACTORS.
  3228        16  FILLER OCCURS 15.
  3229            20  FILLER OCCURS 15.
  3230                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3231    12  PD-PRODUCT-DESC              PIC X(80).
  3232    12  PD-TRUNCATED                 PIC X.
  3233    12  FILLER                       PIC X(59).
  3234    12  PD-MAINT-INFORMATION.
  3235        16  PD-LAST-MAINT-DT         PIC X(02).
  3236        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3237        16  PD-LAST-MAINT-BY         PIC X(04).
  3238*                                COPY ELCCRTT.
  3239******************************************************************
  3240*                                                                *
  3241*                            ELCCRTT.                            *
  3242*                                                                *
  3243*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3244*                                                                *
  3245*   FILE TYPE = VSAM,KSDS                                        *
  3246*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3247*                                                                *
  3248*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3249*                                                                *
  3250*   LOG = YES                                                    *
  3251*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3252******************************************************************
  3253*                   C H A N G E   L O G
  3254*
  3255* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3256*-----------------------------------------------------------------
  3257*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3258* EFFECTIVE    NUMBER
  3259*-----------------------------------------------------------------
  3260* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3261* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3262* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3263* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3264* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3265******************************************************************
  3266
  3267 01  CERTIFICATE-TRAILERS.
  3268     12  CS-RECORD-ID                      PIC XX.
  3269         88  VALID-CS-ID                      VALUE 'CS'.
  3270
  3271     12  CS-CONTROL-PRIMARY.
  3272         16  CS-COMPANY-CD                 PIC X.
  3273         16  CS-CARRIER                    PIC X.
  3274         16  CS-GROUPING                   PIC X(6).
  3275         16  CS-STATE                      PIC XX.
  3276         16  CS-ACCOUNT                    PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  62
* EL131.cbl
  3277         16  CS-CERT-EFF-DT                PIC XX.
  3278         16  CS-CERT-NO.
  3279             20  CS-CERT-PRIME             PIC X(10).
  3280             20  CS-CERT-SFX               PIC X.
  3281         16  CS-TRAILER-TYPE               PIC X.
  3282             88  COMM-TRLR           VALUE 'A'.
  3283             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3284             88  CERT-DATA-TRLR      VALUE 'C'.
  3285
  3286     12  CS-DATA-AREA                      PIC X(516).
  3287
  3288     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3289         16  CS-BANK-COMMISSION-AREA.
  3290             20  CS-BANK-COMMS       OCCURS 10.
  3291                 24  CS-AGT                PIC X(10).
  3292                 24  CS-COM-TYP            PIC X.
  3293                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3294                 24  CS-RECALC-LV-INDIC    PIC X.
  3295                 24  FILLER                PIC X(10).
  3296         16  FILLER                        PIC X(256).
  3297
  3298     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3299****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3300****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  3301         16  CS-MB-CLAIM-DATA OCCURS 2.
  3302             20  FILLER OCCURS 10.
  3303                 24  CS-CLAIM-TYPE         PIC X.
  3304                     88  CS-AH-CLM           VALUE 'A'.
  3305                     88  CS-IU-CLM           VALUE 'I'.
  3306                     88  CS-GP-CLM           VALUE 'G'.
  3307                     88  CS-LF-CLM           VALUE 'L'.
  3308                     88  CS-PR-CLM           VALUE 'P'.
  3309                 24  CS-BANK               PIC S999 COMP-3.
  3310                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  3311                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  3312                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  3313         16  FILLER                        PIC X(216).
  3314     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3315         16  CS-VIN-NUMBER                 PIC X(17).
  3316         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3317         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3318         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3319         16  FILLER                        PIC X(496).
  3320******************************************************************
  3321
  3322****************************************************************
  3323*
  3324* Copyright (c) 2007 by Clerity Solutions, Inc.
  3325* All rights reserved.
  3326*
  3327****************************************************************
  3328 01  DFHEIV.
  3329   02  DFHEIV0               PIC X(35).
  3330   02  DFHEIV1               PIC X(08).
  3331   02  DFHEIV2               PIC X(08).
  3332   02  DFHEIV3               PIC X(08).
  3333   02  DFHEIV4               PIC X(06).
  3334   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  63
* EL131.cbl
  3335   02  DFHEIV6               PIC X(04).
  3336   02  DFHEIV7               PIC X(02).
  3337   02  DFHEIV8               PIC X(02).
  3338   02  DFHEIV9               PIC X(01).
  3339   02  DFHEIV10              PIC S9(7) COMP-3.
  3340   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3341   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3342   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3343   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3344   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3345   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3346   02  DFHEIV17              PIC X(04).
  3347   02  DFHEIV18              PIC X(04).
  3348   02  DFHEIV19              PIC X(04).
  3349   02  DFHEIV20              USAGE IS POINTER.
  3350   02  DFHEIV21              USAGE IS POINTER.
  3351   02  DFHEIV22              USAGE IS POINTER.
  3352   02  DFHEIV23              USAGE IS POINTER.
  3353   02  DFHEIV24              USAGE IS POINTER.
  3354   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3355   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3356   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3357   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3358   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3359   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3360   02  FILLER                PIC X(02).
  3361   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3362   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3363   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3364   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3365   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3366 LINKAGE  SECTION.
  3367*****************************************************************
  3368*                                                               *
  3369* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3370* All rights reserved.                                          *
  3371*                                                               *
  3372*****************************************************************
  3373 01  dfheiblk.
  3374     02  eibtime          pic s9(7) comp-3.
  3375     02  eibdate          pic s9(7) comp-3.
  3376     02  eibtrnid         pic x(4).
  3377     02  eibtaskn         pic s9(7) comp-3.
  3378     02  eibtrmid         pic x(4).
  3379     02  dfheigdi         pic s9(4) comp.
  3380     02  eibcposn         pic s9(4) comp.
  3381     02  eibcalen         pic s9(4) comp.
  3382     02  eibaid           pic x(1).
  3383     02  eibfiller1       pic x(1).
  3384     02  eibfn            pic x(2).
  3385     02  eibfiller2       pic x(2).
  3386     02  eibrcode         pic x(6).
  3387     02  eibfiller3       pic x(2).
  3388     02  eibds            pic x(8).
  3389     02  eibreqid         pic x(8).
  3390     02  eibrsrce         pic x(8).
  3391     02  eibsync          pic x(1).
  3392     02  eibfree          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  64
* EL131.cbl
  3393     02  eibrecv          pic x(1).
  3394     02  eibsend          pic x(1).
  3395     02  eibatt           pic x(1).
  3396     02  eibeoc           pic x(1).
  3397     02  eibfmh           pic x(1).
  3398     02  eibcompl         pic x(1).
  3399     02  eibsig           pic x(1).
  3400     02  eibconf          pic x(1).
  3401     02  eiberr           pic x(1).
  3402     02  eibrldbk         pic x(1).
  3403     02  eiberrcd         pic x(4).
  3404     02  eibsynrb         pic x(1).
  3405     02  eibnodat         pic x(1).
  3406     02  eibfiller5       pic x(2).
  3407     02  eibresp          pic 9(09) comp.
  3408     02  eibresp2         pic 9(09) comp.
  3409     02  dfheigdj         pic s9(4) comp.
  3410     02  dfheigdk         pic s9(4) comp.
  3411 01  DFHCOMMAREA                 PIC X(1024).
  3412
  3413*                                COPY ELCMSTR.
  3414******************************************************************
  3415*                                                                *
  3416*                            ELCMSTR.                            *
  3417*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3418*                            VMOD=2.012                          *
  3419*                                                                *
  3420*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3421*                                                                *
  3422*   FILE TYPE = VSAM,KSDS                                        *
  3423*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3424*                                                                *
  3425*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3426*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3427*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3428*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3429*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3430*                                                 RKP=75,LEN=21  *
  3431*                                                                *
  3432*   **** NOTE ****                                               *
  3433*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3434*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3435*                                                                *
  3436*   LOG = YES                                                    *
  3437*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3438******************************************************************
  3439*                   C H A N G E   L O G
  3440*
  3441* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3442*-----------------------------------------------------------------
  3443*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3444* EFFECTIVE    NUMBER
  3445*-----------------------------------------------------------------
  3446* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3447* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3448* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3449******************************************************************
  3450 01  CLAIM-MASTER.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  65
* EL131.cbl
  3451     12  CL-RECORD-ID                PIC XX.
  3452         88  VALID-CL-ID         VALUE 'CL'.
  3453
  3454     12  CL-CONTROL-PRIMARY.
  3455         16  CL-COMPANY-CD           PIC X.
  3456         16  CL-CARRIER              PIC X.
  3457         16  CL-CLAIM-NO             PIC X(7).
  3458         16  CL-CERT-NO.
  3459             20  CL-CERT-PRIME       PIC X(10).
  3460             20  CL-CERT-SFX         PIC X.
  3461
  3462     12  CL-CONTROL-BY-NAME.
  3463         16  CL-COMPANY-CD-A1        PIC X.
  3464         16  CL-INSURED-LAST-NAME    PIC X(15).
  3465         16  CL-INSURED-NAME.
  3466             20  CL-INSURED-1ST-NAME PIC X(12).
  3467             20  CL-INSURED-MID-INIT PIC X.
  3468
  3469     12  CL-CONTROL-BY-SSN.
  3470         16  CL-COMPANY-CD-A2        PIC X.
  3471         16  CL-SOC-SEC-NO.
  3472             20  CL-SSN-STATE        PIC XX.
  3473             20  CL-SSN-ACCOUNT      PIC X(6).
  3474             20  CL-SSN-LN3          PIC X(3).
  3475
  3476     12  CL-CONTROL-BY-CERT-NO.
  3477         16  CL-COMPANY-CD-A4        PIC X.
  3478         16  CL-CERT-NO-A4.
  3479             20  CL-CERT-A4-PRIME    PIC X(10).
  3480             20  CL-CERT-A4-SFX      PIC X.
  3481
  3482     12  CL-CONTROL-BY-CCN.
  3483         16  CL-COMPANY-CD-A5        PIC X.
  3484         16  CL-CCN-A5.
  3485             20  CL-CCN.
  3486                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3487                 24  CL-CCN-PRIME-A5 PIC X(12).
  3488             20  CL-CCN-FILLER-A5    PIC X(4).
  3489
  3490     12  CL-INSURED-PROFILE-DATA.
  3491         16  CL-INSURED-BIRTH-DT     PIC XX.
  3492         16  CL-INSURED-SEX-CD       PIC X.
  3493             88  INSURED-IS-MALE        VALUE 'M'.
  3494             88  INSURED-IS-FEMALE      VALUE 'F'.
  3495             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3496         16  CL-INSURED-OCC-CD       PIC X(6).
  3497         16  FILLER                  PIC X(5).
  3498
  3499     12  CL-PROCESSING-INFO.
  3500         16  CL-PROCESSOR-ID         PIC X(4).
  3501         16  CL-CLAIM-STATUS         PIC X.
  3502             88  CLAIM-IS-OPEN          VALUE 'O'.
  3503             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3504         16  CL-CLAIM-TYPE           PIC X.
  3505*            88  AH-CLAIM               VALUE 'A'.
  3506*            88  LIFE-CLAIM             VALUE 'L'.
  3507*            88  PROPERTY-CLAIM         VALUE 'P'.
  3508*            88  IUI-CLAIM              VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  66
* EL131.cbl
  3509*            88  GAP-CLAIM              VALUE 'G'.
  3510         16  CL-CLAIM-PREM-TYPE      PIC X.
  3511             88  SINGLE-PREMIUM         VALUE '1'.
  3512             88  O-B-COVERAGE           VALUE '2'.
  3513             88  OPEN-END-COVERAGE      VALUE '3'.
  3514         16  CL-INCURRED-DT          PIC XX.
  3515         16  CL-REPORTED-DT          PIC XX.
  3516         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3517         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3518         16  CL-LAST-PMT-DT          PIC XX.
  3519         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3520         16  CL-PAID-THRU-DT         PIC XX.
  3521         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3522         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3523         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3524         16  CL-PMT-CALC-METHOD      PIC X.
  3525             88  CL-360-DAY-YR          VALUE '1'.
  3526             88  CL-365-DAY-YR          VALUE '2'.
  3527             88  CL-FULL-MONTHS         VALUE '3'.
  3528         16  CL-CAUSE-CD             PIC X(6).
  3529
  3530         16  CL-PRIME-CERT-NO.
  3531             20  CL-PRIME-CERT-PRIME PIC X(10).
  3532             20  CL-PRIME-CERT-SFX   PIC X.
  3533
  3534         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3535             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3536             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3537
  3538         16  CL-MICROFILM-NO         PIC X(10).
  3539         16  CL-PROG-FORM-TYPE       PIC X.
  3540         16  CL-LAST-ADD-ON-DT       PIC XX.
  3541
  3542         16  CL-LAST-REOPEN-DT       PIC XX.
  3543         16  CL-LAST-CLOSE-DT        PIC XX.
  3544         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3545             88  FINAL-PAID             VALUE '1'.
  3546             88  CLAIM-DENIED           VALUE '2'.
  3547             88  AUTO-CLOSE             VALUE '3'.
  3548             88  MANUAL-CLOSE           VALUE '4'.
  3549             88  BENEFITS-CHANGED       VALUE 'C'.
  3550             88  SETUP-ERRORS           VALUE 'E'.
  3551         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3552         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3553         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3554             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3555         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3556         16  FILLER                  PIC X.
  3557
  3558     12  CL-CERTIFICATE-DATA.
  3559         16  CL-CERT-ORIGIN          PIC X.
  3560             88  CERT-WAS-ONLINE        VALUE '1'.
  3561             88  CERT-WAS-CREATED       VALUE '2'.
  3562             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3563         16  CL-CERT-KEY-DATA.
  3564             20  CL-CERT-CARRIER     PIC X.
  3565             20  CL-CERT-GROUPING    PIC X(6).
  3566             20  CL-CERT-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  67
* EL131.cbl
  3567             20  CL-CERT-ACCOUNT.
  3568                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3569                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3570             20  CL-CERT-EFF-DT      PIC XX.
  3571
  3572     12  CL-STATUS-CONTROLS.
  3573         16  CL-PRIORITY-CD          PIC X.
  3574             88  CONFIDENTIAL-DATA      VALUE '8'.
  3575             88  HIGHEST-PRIORITY       VALUE '9'.
  3576         16  CL-SUPV-ATTN-CD         PIC X.
  3577             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3578             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3579         16  CL-PURGED-DT            PIC XX.
  3580         16  CL-RESTORED-DT          PIC XX.
  3581         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3582         16  CL-NEXT-RESEND-DT       PIC XX.
  3583         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3584         16  CL-CRITICAL-PERIOD      PIC 99.
  3585*        16  FILLER                  PIC XX.
  3586         16  CL-LAST-MAINT-DT        PIC XX.
  3587         16  CL-LAST-MAINT-USER      PIC X(4).
  3588         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3589         16  CL-LAST-MAINT-TYPE      PIC X.
  3590             88  CLAIM-SET-UP           VALUE ' '.
  3591             88  PAYMENT-MADE           VALUE '1'.
  3592             88  LETTER-SENT            VALUE '2'.
  3593             88  MASTER-WAS-ALTERED     VALUE '3'.
  3594             88  MASTER-WAS-RESTORED    VALUE '4'.
  3595             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3596             88  FILE-CONVERTED         VALUE '6'.
  3597             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3598             88  ERROR-CORRECTION       VALUE 'E'.
  3599         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3600         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3601         16  CL-BENEFICIARY          PIC X(10).
  3602         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3603         16  CL-DENIAL-TYPE          PIC X.
  3604             88  CL-TYPE-DENIAL          VALUE '1'.
  3605             88  CL-TYPE-RESCISSION      VALUE '2'.
  3606             88  CL-TYPE-REFORMATION     VALUE '3'.
  3607             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3608             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3609         16  CL-CRIT-PER-RECURRENT   PIC X.
  3610         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3611         16  CL-RTW-DT               PIC XX.
  3612
  3613     12  CL-TRAILER-CONTROLS.
  3614         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3615             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3616             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3617             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3618         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3619         16  FILLER                  PIC XX.
  3620         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3621         16  CL-ADDRESS-TRAILER-CNT.
  3622             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3623                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3624             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  68
* EL131.cbl
  3625                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3626             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3627                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3628             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3629                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3630             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3631                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3632             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3633                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3634             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3635                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3636
  3637     12  CL-CV-REFERENCE-NO.
  3638         16  CL-CV-REFNO-PRIME       PIC X(18).
  3639         16  CL-CV-REFNO-SFX         PIC XX.
  3640
  3641     12  CL-FILE-LOCATION            PIC X(4).
  3642
  3643     12  CL-PROCESS-ERRORS.
  3644         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3645             88  NO-FATAL-ERRORS        VALUE ZERO.
  3646         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3647             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3648
  3649     12  CL-PRODUCT-CD               PIC X.
  3650
  3651     12  CL-CURRENT-KEY-DATA.
  3652         16  CL-CURRENT-CARRIER      PIC X.
  3653         16  CL-CURRENT-GROUPING     PIC X(6).
  3654         16  CL-CURRENT-STATE        PIC XX.
  3655         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3656
  3657     12  CL-ASSOCIATES               PIC X.
  3658         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3659         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3660         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3661         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3662
  3663     12  CL-ACTIVITY-CODE            PIC 99.
  3664     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3665     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3666
  3667     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3668     12  CL-LAG-REPORT-CODE          PIC 9.
  3669     12  CL-LOAN-TYPE                PIC XX.
  3670     12  CL-LEGAL-STATE              PIC XX.
  3671
  3672     12  CL-YESNOSW                  PIC X.
  3673     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3674         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3675         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3676         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3677     12  cl-insured-claim            pic x.
  3678         88  cl-claim-on-primary         value 'P'.
  3679         88  cl-claim-on-secondary       value 'S'.
  3680     12  cl-benefit-expiration-dt    PIC XX.
  3681
  3682*                                COPY ELCCERT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  69
* EL131.cbl
  3683******************************************************************
  3684*                                                                *
  3685*                            ELCCERT.                            *
  3686*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3687*                            VMOD=2.013                          *
  3688*                                                                *
  3689*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3690*                                                                *
  3691*   FILE TYPE = VSAM,KSDS                                        *
  3692*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3693*                                                                *
  3694*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3695*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3696*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3697*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3698*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3699*                                                                *
  3700*   LOG = YES                                                    *
  3701*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3702******************************************************************
  3703*                   C H A N G E   L O G
  3704*
  3705* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3706*-----------------------------------------------------------------
  3707*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3708* EFFECTIVE    NUMBER
  3709*-----------------------------------------------------------------
  3710* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3711* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3712* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3713* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3714* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3715* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3716* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3717* 032612  CR2011110200001  PEMA  AHL CHANGES
  3718******************************************************************
  3719
  3720 01  CERTIFICATE-MASTER.
  3721     12  CM-RECORD-ID                      PIC XX.
  3722         88  VALID-CM-ID                      VALUE 'CM'.
  3723
  3724     12  CM-CONTROL-PRIMARY.
  3725         16  CM-COMPANY-CD                 PIC X.
  3726         16  CM-CARRIER                    PIC X.
  3727         16  CM-GROUPING.
  3728             20  CM-GROUPING-PREFIX        PIC X(3).
  3729             20  CM-GROUPING-PRIME         PIC X(3).
  3730         16  CM-STATE                      PIC XX.
  3731         16  CM-ACCOUNT.
  3732             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3733             20  CM-ACCOUNT-PRIME          PIC X(6).
  3734         16  CM-CERT-EFF-DT                PIC XX.
  3735         16  CM-CERT-NO.
  3736             20  CM-CERT-PRIME             PIC X(10).
  3737             20  CM-CERT-SFX               PIC X.
  3738
  3739     12  CM-CONTROL-BY-NAME.
  3740         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  70
* EL131.cbl
  3741         16  CM-INSURED-LAST-NAME          PIC X(15).
  3742         16  CM-INSURED-INITIALS.
  3743             20  CM-INSURED-INITIAL1       PIC X.
  3744             20  CM-INSURED-INITIAL2       PIC X.
  3745
  3746     12  CM-CONTROL-BY-SSN.
  3747         16  CM-COMPANY-CD-A2              PIC X.
  3748         16  CM-SOC-SEC-NO.
  3749             20  CM-SSN-STATE              PIC XX.
  3750             20  CM-SSN-ACCOUNT            PIC X(6).
  3751             20  CM-SSN-LN3.
  3752                 25  CM-INSURED-INITIALS-A2.
  3753                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3754                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3755                 25 CM-PART-LAST-NAME-A2         PIC X.
  3756
  3757     12  CM-CONTROL-BY-CERT-NO.
  3758         16  CM-COMPANY-CD-A4              PIC X.
  3759         16  CM-CERT-NO-A4                 PIC X(11).
  3760
  3761     12  CM-CONTROL-BY-MEMB.
  3762         16  CM-COMPANY-CD-A5              PIC X.
  3763         16  CM-MEMBER-NO.
  3764             20  CM-MEMB-STATE             PIC XX.
  3765             20  CM-MEMB-ACCOUNT           PIC X(6).
  3766             20  CM-MEMB-LN4.
  3767                 25  CM-INSURED-INITIALS-A5.
  3768                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3769                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3770                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3771
  3772     12  CM-INSURED-PROFILE-DATA.
  3773         16  CM-INSURED-FIRST-NAME.
  3774             20  CM-INSURED-1ST-INIT       PIC X.
  3775             20  FILLER                    PIC X(9).
  3776         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3777         16  CM-INSURED-SEX                PIC X.
  3778             88  CM-SEX-MALE                  VALUE 'M'.
  3779             88  CM-SEX-FEMAL                 VALUE 'F'.
  3780         16  CM-INSURED-JOINT-AGE          PIC 99.
  3781         16  CM-JOINT-INSURED-NAME.
  3782             20  CM-JT-LAST-NAME           PIC X(15).
  3783             20  CM-JT-FIRST-NAME.
  3784                 24  CM-JT-1ST-INIT        PIC X.
  3785                 24  FILLER                PIC X(9).
  3786             20  CM-JT-INITIAL             PIC X.
  3787
  3788     12  CM-LIFE-DATA.
  3789         16  CM-LF-BENEFIT-CD              PIC XX.
  3790         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3791         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3792         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3793         16  CM-LF-DEV-CODE                PIC XXX.
  3794         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3795         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3796         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3797         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3798         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  71
* EL131.cbl
  3799         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3800         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3801         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3802         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3803         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3804         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3805         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3806         16  FILLER                        PIC XX.
  3807
  3808     12  CM-AH-DATA.
  3809         16  CM-AH-BENEFIT-CD              PIC XX.
  3810         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3811         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3812         16  CM-AH-DEV-CODE                PIC XXX.
  3813         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3814         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3815         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3816         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3817         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3818         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3819         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3820         16  CM-AH-PAID-THRU-DT            PIC XX.
  3821             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3822         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3823         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3824         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3825         16  FILLER                        PIC X.
  3826
  3827     12  CM-LOAN-INFORMATION.
  3828         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3829         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3830                                           PIC S9(5)V99  COMP-3.
  3831         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3832         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3833         16  CM-PAY-FREQUENCY              PIC S99.
  3834         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3835         16  CM-RATE-CLASS                 PIC XX.
  3836         16  CM-BENEFICIARY                PIC X(25).
  3837         16  CM-POLICY-FORM-NO             PIC X(12).
  3838         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3839         16  CM-LAST-ADD-ON-DT             PIC XX.
  3840         16  CM-DEDUCTIBLE-AMOUNTS.
  3841             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3842             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3843         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3844             20  CM-RESIDENT-STATE         PIC XX.
  3845             20  CM-RATE-CODE              PIC X(4).
  3846             20  FILLER                    PIC XX.
  3847         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3848             20  CM-LOAN-OFFICER           PIC X(5).
  3849             20  FILLER                    PIC XXX.
  3850         16  CM-CSR-CODE                   PIC XXX.
  3851         16  CM-UNDERWRITING-CODE          PIC X.
  3852             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3853         16  CM-POST-CARD-IND              PIC X.
  3854         16  CM-NH-INTERFACE-SW            PIC X.
  3855         16  CM-PREMIUM-TYPE               PIC X.
  3856             88  CM-SING-PRM                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  72
* EL131.cbl
  3857             88  CM-O-B-COVERAGE              VALUE '2'.
  3858             88  CM-OPEN-END                  VALUE '3'.
  3859         16  CM-IND-GRP-TYPE               PIC X.
  3860             88  CM-INDIVIDUAL                VALUE 'I'.
  3861             88  CM-GROUP                     VALUE 'G'.
  3862         16  CM-SKIP-CODE                  PIC X.
  3863             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3864             88  SKIP-JULY                    VALUE '1'.
  3865             88  SKIP-AUGUST                  VALUE '2'.
  3866             88  SKIP-SEPTEMBER               VALUE '3'.
  3867             88  SKIP-JULY-AUG                VALUE '4'.
  3868             88  SKIP-AUG-SEPT                VALUE '5'.
  3869             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  3870             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  3871             88  SKIP-JUNE                    VALUE '8'.
  3872             88  SKIP-JUNE-JULY               VALUE '9'.
  3873             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  3874             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  3875         16  CM-PAYMENT-MODE               PIC X.
  3876             88  PAY-MONTHLY                  VALUE SPACE.
  3877             88  PAY-WEEKLY                   VALUE '1'.
  3878             88  PAY-SEMI-MONTHLY             VALUE '2'.
  3879             88  PAY-BI-WEEKLY                VALUE '3'.
  3880             88  PAY-SEMI-ANUALLY             VALUE '4'.
  3881         16  CM-LOAN-NUMBER                PIC X(8).
  3882         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  3883         16  CM-OLD-LOF                    PIC XXX.
  3884*        16  CM-LOAN-OFFICER               PIC XXX.
  3885         16  CM-REIN-TABLE                 PIC XXX.
  3886         16  CM-SPECIAL-REIN-CODE          PIC X.
  3887         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  3888         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  3889         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  3890
  3891     12  CM-STATUS-DATA.
  3892         16  CM-ENTRY-STATUS               PIC X.
  3893         16  CM-ENTRY-DT                   PIC XX.
  3894
  3895         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  3896         16  CM-LF-CANCEL-DT               PIC XX.
  3897         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  3898
  3899         16  CM-LF-STATUS-AT-DEATH         PIC X.
  3900         16  CM-LF-DEATH-DT                PIC XX.
  3901         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  3902
  3903         16  CM-LF-CURRENT-STATUS          PIC X.
  3904             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3905                                                'M' '4' '5' '9'.
  3906             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  3907             88  CM-LF-POLICY-PENDING         VALUE '2'.
  3908             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  3909             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  3910             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  3911             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3912             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  3913             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3914             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  73
* EL131.cbl
  3915             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  3916             88  CM-LF-DECLINED               VALUE 'D'.
  3917             88  CM-LF-VOIDED                 VALUE 'V'.
  3918
  3919         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  3920         16  CM-AH-CANCEL-DT               PIC XX.
  3921         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  3922
  3923         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  3924         16  CM-AH-SETTLEMENT-DT           PIC XX.
  3925         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  3926
  3927         16  CM-AH-CURRENT-STATUS          PIC X.
  3928             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3929                                                'M' '4' '5' '9'.
  3930             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  3931             88  CM-AH-POLICY-PENDING         VALUE '2'.
  3932             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  3933             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  3934             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  3935             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3936             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  3937             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3938             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  3939             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  3940             88  CM-AH-DECLINED               VALUE 'D'.
  3941             88  CM-AH-VOIDED                 VALUE 'V'.
  3942
  3943         16  CM-CLAIM-INTERFACE-SW         PIC X.
  3944             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  3945             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  3946             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  3947         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  3948
  3949         16  CM-ENTRY-BATCH                PIC X(6).
  3950         16  CM-LF-EXIT-BATCH              PIC X(6).
  3951         16  CM-AH-EXIT-BATCH              PIC X(6).
  3952         16  CM-LAST-MONTH-END             PIC XX.
  3953
  3954     12  CM-NOTE-SW                        PIC X.
  3955         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  3956         88  CERT-NOTES-PRESENT               VALUE '1'.
  3957         88  BILLING-NOTES-PRESENT            VALUE '2'.
  3958         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  3959         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  3960         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  3961         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  3962         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  3963     12  CM-COMP-EXCP-SW                   PIC X.
  3964         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  3965         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  3966     12  CM-INSURED-ADDRESS-SW             PIC X.
  3967         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  3968         88  INSURED-ADDR-PRESENT             VALUE '1'.
  3969
  3970*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  3971     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  3972     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  74
* EL131.cbl
  3973
  3974*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  3975     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  3976     12  FILLER                            PIC X.
  3977*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  3978     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  3979
  3980     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  3981         88  CERT-ADDED-BATCH                 VALUE ' '.
  3982         88  CERT-ADDED-ONLINE                VALUE '1'.
  3983         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  3984         88  CERT-PURGED-OFFLINE              VALUE '3'.
  3985         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  3986     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  3987         88  CERT-AS-LOADED                   VALUE ' '.
  3988         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  3989         88  CERT-CLAIM-ONLINE                VALUE '2'.
  3990         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  3991         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  3992         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  3993         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  3994         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  3995
  3996     12  CM-ACCOUNT-COMM-PCTS.
  3997         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  3998         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3999
  4000     12  CM-USER-FIELD                     PIC X.
  4001     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4002     12  CM-CLP-STATE                      PIC XX.
  4003     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4004     12  CM-USER-RESERVED                  PIC XXX.
  4005     12  FILLER REDEFINES CM-USER-RESERVED.
  4006         16  CM-AH-CLASS-CD                PIC XX.
  4007         16  F                             PIC X.
  4008******************************************************************
  4009
  4010*                                COPY ELCTRLR.
  4011******************************************************************
  4012*                                                                *
  4013*                            ELCTRLR.                            *
  4014*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4015*                            VMOD=2.014                          *
  4016*                                                                *
  4017*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4018*                                                                *
  4019*   FILE TYPE = VSAM,KSDS                                        *
  4020*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4021*                                                                *
  4022*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4023*       ALTERNATE INDEX = NONE                                   *
  4024*                                                                *
  4025*   LOG = YES                                                    *
  4026*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4027******************************************************************
  4028*                   C H A N G E   L O G
  4029*
  4030* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  75
* EL131.cbl
  4031*-----------------------------------------------------------------
  4032*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4033* EFFECTIVE    NUMBER
  4034*-----------------------------------------------------------------
  4035* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4036* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4037* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4038* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4039* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4040* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4041* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4042* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4043* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4044* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4045* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4046* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4047* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4048* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4049* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4050* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4051******************************************************************
  4052 01  ACTIVITY-TRAILERS.
  4053     12  AT-RECORD-ID                    PIC XX.
  4054         88  VALID-AT-ID                       VALUE 'AT'.
  4055
  4056     12  AT-CONTROL-PRIMARY.
  4057         16  AT-COMPANY-CD               PIC X.
  4058         16  AT-CARRIER                  PIC X.
  4059         16  AT-CLAIM-NO                 PIC X(7).
  4060         16  AT-CERT-NO.
  4061             20  AT-CERT-PRIME           PIC X(10).
  4062             20  AT-CERT-SFX             PIC X.
  4063         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4064             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4065             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4066             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4067             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4068             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4069             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4070             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4071             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4072             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4073             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4074             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4075             88  AT-BENEFICIARY-TRL           VALUE +91.
  4076             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4077             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4078             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4079             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4080
  4081     12  AT-TRAILER-TYPE                 PIC X.
  4082         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4083         88  PAYMENT-TR                       VALUE '2'.
  4084         88  AUTO-PAY-TR                      VALUE '3'.
  4085         88  CORRESPONDENCE-TR                VALUE '4'.
  4086         88  ADDRESS-TR                       VALUE '5'.
  4087         88  GENERAL-INFO-TR                  VALUE '6'.
  4088         88  AUTO-PROMPT-TR                   VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  76
* EL131.cbl
  4089         88  DENIAL-TR                        VALUE '8'.
  4090         88  INCURRED-CHG-TR                  VALUE '9'.
  4091         88  FORM-CONTROL-TR                  VALUE 'A'.
  4092
  4093     12  AT-RECORDED-DT                  PIC XX.
  4094     12  AT-RECORDED-BY                  PIC X(4).
  4095     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4096
  4097     12  AT-TRAILER-BODY                 PIC X(165).
  4098
  4099     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4100         16  AT-RESERVE-CONTROLS.
  4101             20  AT-MANUAL-SW            PIC X.
  4102                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4103             20  AT-FUTURE-SW            PIC X.
  4104                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4105             20  AT-PTC-SW               PIC X.
  4106                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4107             20  AT-IBNR-SW              PIC X.
  4108                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4109             20  AT-PTC-LF-SW            PIC X.
  4110                 88  AT-LF-PTC-USED          VALUE '1'.
  4111             20  AT-CDT-ACCESS-METHOD    PIC X.
  4112                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4113                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4114                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4115             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4116         16  AT-LAST-COMPUTED-DT         PIC XX.
  4117         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4118         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4119         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4120         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4121         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4122         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4123         16  AT-EXPENSE-CONTROLS.
  4124             20  AT-EXPENSE-METHOD       PIC X.
  4125                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4126                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4127                 88  PERCENT-OF-PMT           VALUE '3'.
  4128                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4129             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4130             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4131         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4132         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4133
  4134         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4135         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4136
  4137*        16  FILLER                      PIC X(53).
  4138         16  FILLER                      PIC X(47).
  4139
  4140         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4141         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4142
  4143         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4144             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4145             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4146*                    C = CLOSED
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  77
* EL131.cbl
  4147*                    O = OPEN
  4148             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4149*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4150
  4151     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4152         16  AT-PAYMENT-TYPE             PIC X.
  4153             88  PARTIAL-PAYMENT                VALUE '1'.
  4154             88  FINAL-PAYMENT                  VALUE '2'.
  4155             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4156             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4157             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4158             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4159             88  VOIDED-PAYMENT                 VALUE '9'.
  4160             88  TRANSFER                       VALUE 'T'.
  4161             88  LIFE-INTEREST                  VALUE 'I'.
  4162
  4163         16  AT-CLAIM-TYPE               PIC X.
  4164             88  PAID-FOR-AH                    VALUE 'A'.
  4165             88  PAID-FOR-LIFE                  VALUE 'L'.
  4166             88  PAID-FOR-IUI                   VALUE 'I'.
  4167             88  PAID-FOR-GAP                   VALUE 'G'.
  4168         16  AT-CLAIM-PREM-TYPE          PIC X.
  4169             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4170             88  AT-O-B-COVERAGE                VALUE '2'.
  4171             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4172         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4173         16  AT-CHECK-NO                 PIC X(7).
  4174         16  AT-PAID-FROM-DT             PIC XX.
  4175         16  AT-PAID-THRU-DT             PIC XX.
  4176         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4177         16  FILLER                      PIC X.
  4178         16  AT-PAYEES-NAME              PIC X(30).
  4179         16  AT-PAYMENT-ORIGIN           PIC X.
  4180             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4181             88  ONLINE-AUTO-PMT                VALUE '2'.
  4182             88  OFFLINE-PMT                    VALUE '3'.
  4183         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4184         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4185         16  AT-VOID-DATA.
  4186             20  AT-VOID-DT              PIC XX.
  4187*00144       20  AT-VOID-REASON          PIC X(30).
  4188             20  AT-VOID-REASON          PIC X(26).
  4189         16  AT-PMT-APPROVED-BY          PIC X(04).
  4190         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4191         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4192         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4193                                         PIC S99V9(5)  COMP-3.
  4194         16  AT-CREDIT-INTERFACE.
  4195             20  AT-PMT-SELECT-DT        PIC XX.
  4196                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4197             20  AT-PMT-ACCEPT-DT        PIC XX.
  4198                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4199             20  AT-VOID-SELECT-DT       PIC XX.
  4200                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4201             20  AT-VOID-ACCEPT-DT       PIC XX.
  4202                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4203
  4204         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  78
* EL131.cbl
  4205                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4206                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4207         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4208
  4209         16  AT-FORCE-CONTROL            PIC X.
  4210             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4211         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4212         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4213         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4214         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4215         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4216         16  AT-BENEFIT-TYPE             PIC X.
  4217
  4218         16  AT-EXPENSE-TYPE             PIC X.
  4219         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4220
  4221         16  AT-PAYEE-TYPE-CD.
  4222             20  AT-PAYEE-TYPE           PIC X.
  4223                 88  INSURED-PAID           VALUE 'I'.
  4224                 88  BENEFICIARY-PAID       VALUE 'B'.
  4225                 88  ACCOUNT-PAID           VALUE 'A'.
  4226                 88  OTHER-1-PAID           VALUE 'O'.
  4227                 88  OTHER-2-PAID           VALUE 'Q'.
  4228                 88  DOCTOR-PAID            VALUE 'P'.
  4229                 88  EMPLOYER-PAID          VALUE 'E'.
  4230             20  AT-PAYEE-SEQ            PIC X.
  4231
  4232         16  AT-CASH-PAYMENT             PIC X.
  4233         16  AT-GROUPED-PAYMENT          PIC X.
  4234         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4235         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4236         16  AT-APPROVED-LEVEL           PIC X.
  4237         16  AT-VOID-TYPE                PIC X.
  4238             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4239             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4240         16  AT-AIG-UNEMP-IND            PIC X.
  4241             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4242         16  AT-ASSOCIATES               PIC X.
  4243             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4244             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4245
  4246         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4247         16  AT-CV-PMT-CODE              PIC X.
  4248             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4249             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4250             88  FULL-ADD-PAYMENT           VALUE '3'.
  4251             88  HALF-ADD-PAYMENT           VALUE '4'.
  4252             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4253             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4254             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4255             88  ADDL-PAYMENT               VALUE '8'.
  4256
  4257         16  AT-EOB-CODE1                PIC XXX.
  4258         16  AT-EOB-CODE2                PIC XXX.
  4259         16  AT-EOB-CODE3                PIC XXX.
  4260         16  FILLER REDEFINES AT-EOB-CODE3.
  4261             20  AT-PRINT-CLM-FORM       PIC X.
  4262             20  AT-PRINT-SURVEY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  79
* EL131.cbl
  4263             20  FILLER                  PIC X.
  4264         16  AT-EOB-CODE4                PIC XXX.
  4265         16  FILLER REDEFINES AT-EOB-CODE4.
  4266             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4267             20  FILLER                  PIC X.
  4268         16  AT-EOB-CODE5                PIC XXX.
  4269         16  FILLER REDEFINES AT-EOB-CODE5.
  4270             20  AT-PMT-PROOF-DT         PIC XX.
  4271             20  FILLER                  PIC X.
  4272
  4273         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4274             88  AT-PRINT-EOB            VALUE 'Y'.
  4275
  4276         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4277         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4278
  4279     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4280         16  AT-SCHEDULE-START-DT        PIC XX.
  4281         16  AT-SCHEDULE-END-DT          PIC XX.
  4282         16  AT-TERMINATED-DT            PIC XX.
  4283         16  AT-LAST-PMT-TYPE            PIC X.
  4284             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4285             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4286         16  AT-FIRST-PMT-DATA.
  4287             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4288             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4289             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4290         16  AT-REGULAR-PMT-DATA.
  4291             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4292             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4293             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4294         16  AT-AUTO-PAYEE-CD.
  4295             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4296                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4297                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4298                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4299                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4300                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4301             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4302         16  AT-AUTO-PAY-DAY             PIC 99.
  4303         16  AT-AUTO-CASH                PIC X.
  4304             88  AT-CASH                      VALUE 'Y'.
  4305             88  AT-NON-CASH                  VALUE 'N'.
  4306*        16  FILLER                      PIC X(129).
  4307         16  AT-AUTO-END-LETTER          PIC X(4).
  4308         16  FILLER                      PIC X(125).
  4309
  4310         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4311         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4312
  4313     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4314         16  AT-LETTER-SENT-DT           PIC XX.
  4315         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4316         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4317         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4318         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4319         16  AT-LETTER-ORIGIN            PIC X.
  4320             88  ONLINE-CREATION              VALUE '1' '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  80
* EL131.cbl
  4321             88  OFFLINE-CREATION             VALUE '2' '4'.
  4322             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4323             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4324         16  AT-STD-LETTER-FORM          PIC X(4).
  4325         16  AT-REASON-TEXT              PIC X(70).
  4326         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4327         16  AT-ADDRESEE-TYPE            PIC X.
  4328              88  INSURED-ADDRESEE            VALUE 'I'.
  4329              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4330              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4331              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4332              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4333              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4334              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4335         16  AT-ADDRESSEE-NAME           PIC X(30).
  4336         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4337         16  AT-RESEND-PRINT-DATE        PIC XX.
  4338         16  AT-CORR-SOL-UNSOL           PIC X.
  4339         16  AT-LETTER-PURGED-DT         PIC XX.
  4340*
  4341*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4342*
  4343         16  AT-CSO-REDEFINITION.
  4344             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4345             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4346             20  AT-LETTER-TO-BENE       PIC X(1).
  4347             20  AT-STOP-LETTER-DT       PIC X(2).
  4348             20  FILLER                  PIC X(19).
  4349*             20  FILLER                  PIC X(27).
  4350             20  AT-CSO-LETTER-STATUS    PIC X.
  4351                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4352                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4353                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4354             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4355             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4356*
  4357*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4358*
  4359*        16  FILLER                      PIC X(26).
  4360*
  4361*        16  AT-DMD-BSR-CODE             PIC X.
  4362*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4363*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4364*
  4365*        16  AT-DMD-LETTER-STATUS        PIC X.
  4366*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4367*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4368*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4369*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4370*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4371
  4372         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4373         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4374
  4375     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4376         16  AT-ADDRESS-TYPE             PIC X.
  4377             88  INSURED-ADDRESS               VALUE 'I'.
  4378             88  BENEFICIARY-ADDRESS           VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  81
* EL131.cbl
  4379             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4380             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4381             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4382             88  OTHER-ADDRESS-1               VALUE 'O'.
  4383             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4384         16  AT-MAIL-TO-NAME             PIC X(30).
  4385         16  AT-ADDRESS-LINE-1           PIC X(30).
  4386         16  AT-ADDRESS-LINE-2           PIC X(30).
  4387         16  AT-CITY-STATE.
  4388             20  AT-CITY                 PIC X(28).
  4389             20  AT-STATE                PIC XX.
  4390         16  AT-ZIP.
  4391             20  AT-ZIP-CODE.
  4392                 24  AT-ZIP-1ST          PIC X.
  4393                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4394                 24  FILLER              PIC X(4).
  4395             20  AT-ZIP-PLUS4            PIC X(4).
  4396         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4397             20  AT-CAN-POSTAL-1         PIC XXX.
  4398             20  AT-CAN-POSTAL-2         PIC XXX.
  4399             20  FILLER                  PIC XXX.
  4400         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4401*         16  FILLER                      PIC X(23).
  4402         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4403         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4404         16  FILLER                      PIC X(13).
  4405         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4406         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4407
  4408     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4409         16  AT-INFO-LINE-1              PIC X(60).
  4410         16  FILLER REDEFINES AT-INFO-LINE-1.
  4411             20  AT-NOTE-ERROR-NO OCCURS 15
  4412                                         PIC X(4).
  4413         16  AT-INFO-LINE-2              PIC X(60).
  4414         16  AT-INFO-TRAILER-TYPE        PIC X.
  4415             88  AT-ERRORS-NOTE          VALUE 'E'.
  4416             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4417             88  AT-CALL-NOTE            VALUE 'C'.
  4418             88  AT-MAINT-NOTE           VALUE 'M'.
  4419             88  AT-CERT-CHANGE          VALUE 'X'.
  4420             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4421             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4422         16  AT-CALL-TYPE                PIC X.
  4423             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4424             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4425         16  AT-NOTE-CONTINUATION        PIC X.
  4426             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4427         16  AT-EOB-CODES-EXIST          PIC X.
  4428             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4429         16  FILLER                      PIC X(35).
  4430         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4431         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4432
  4433     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4434         16  AT-PROMPT-LINE-1            PIC X(60).
  4435         16  AT-PROMPT-LINE-2            PIC X(60).
  4436         16  AT-PROMPT-START-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  82
* EL131.cbl
  4437         16  AT-PROMPT-END-DT            PIC XX.
  4438         16  FILLER                      PIC X(35).
  4439         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4440         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4441
  4442     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4443         16  AT-DENIAL-INFO-1            PIC X(60).
  4444         16  AT-DENIAL-INFO-2            PIC X(60).
  4445         16  AT-DENIAL-DT                PIC XX.
  4446         16  AT-RETRACTION-DT            PIC XX.
  4447         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4448*         16  FILLER                      PIC X(31).
  4449         16  AT-DENIAL-PROOF-DT          PIC XX.
  4450         16  FILLER                      PIC X(29).
  4451         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4452         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4453
  4454     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4455         16  AT-OLD-INCURRED-DT          PIC XX.
  4456         16  AT-OLD-REPORTED-DT          PIC XX.
  4457         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4458         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4459         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4460         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4461         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4462         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4463         16  FILLER                      PIC X(26).
  4464         16  AT-OLD-DIAG-CODE            PIC X(6).
  4465         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4466         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4467         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4468         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4469         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4470         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4471         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4472         16  FILLER                      PIC X(25).
  4473         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4474
  4475     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4476         16  AT-FORM-SEND-ON-DT          PIC XX.
  4477         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4478         16  AT-FORM-RE-SEND-DT          PIC XX.
  4479         16  AT-FORM-ANSWERED-DT         PIC XX.
  4480         16  AT-FORM-PRINTED-DT          PIC XX.
  4481         16  AT-FORM-REPRINT-DT          PIC XX.
  4482         16  AT-FORM-TYPE                PIC X.
  4483             88  INITIAL-FORM                  VALUE '1'.
  4484             88  PROGRESS-FORM                 VALUE '2'.
  4485         16  AT-INSTRUCT-LN-1            PIC X(28).
  4486         16  AT-INSTRUCT-LN-2            PIC X(28).
  4487         16  AT-INSTRUCT-LN-3            PIC X(28).
  4488         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4489         16  AT-FORM-ADDRESS             PIC X.
  4490             88  FORM-TO-INSURED              VALUE 'I'.
  4491             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4492             88  FORM-TO-OTHER-1              VALUE 'O'.
  4493             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4494         16  AT-RELATED-1.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  83
* EL131.cbl
  4495             20 AT-REL-CARR-1            PIC X.
  4496             20 AT-REL-CLAIM-1           PIC X(7).
  4497             20 AT-REL-CERT-1            PIC X(11).
  4498         16  AT-RELATED-2.
  4499             20 AT-REL-CARR-2            PIC X.
  4500             20 AT-REL-CLAIM-2           PIC X(7).
  4501             20 AT-REL-CERT-2            PIC X(11).
  4502         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4503         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4504         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4505         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4506         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4507         16  AT-STOP-FORM-DT             PIC X(2).
  4508
  4509         16  FILLER                      PIC X(09).
  4510         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4511         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4512******************************************************************
  4513
  4514*                                COPY ELCCNTL.
  4515******************************************************************
  4516*                                                                *
  4517*                                                                *
  4518*                            ELCCNTL.                            *
  4519*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4520*                            VMOD=2.059                          *
  4521*                                                                *
  4522*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4523*                                                                *
  4524*   FILE TYPE = VSAM,KSDS                                        *
  4525*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4526*                                                                *
  4527*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4528*       ALTERNATE INDEX = NONE                                   *
  4529*                                                                *
  4530*   LOG = YES                                                    *
  4531*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4532******************************************************************
  4533*                   C H A N G E   L O G
  4534*
  4535* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4536*-----------------------------------------------------------------
  4537*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4538* EFFECTIVE    NUMBER
  4539*-----------------------------------------------------------------
  4540* 082503                   PEMA  ADD BENEFIT GROUP
  4541* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4542* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4543* 092705    2005050300006  PEMA  ADD SPP LEASES
  4544* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4545* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4546* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4547* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4548* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4549* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4550* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4551* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4552******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  84
* EL131.cbl
  4553*
  4554 01  CONTROL-FILE.
  4555     12  CF-RECORD-ID                       PIC XX.
  4556         88  VALID-CF-ID                        VALUE 'CF'.
  4557
  4558     12  CF-CONTROL-PRIMARY.
  4559         16  CF-COMPANY-ID                  PIC XXX.
  4560         16  CF-RECORD-TYPE                 PIC X.
  4561             88  CF-COMPANY-MASTER              VALUE '1'.
  4562             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4563             88  CF-STATE-MASTER                VALUE '3'.
  4564             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4565             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4566             88  CF-CARRIER-MASTER              VALUE '6'.
  4567             88  CF-MORTALITY-MASTER            VALUE '7'.
  4568             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4569             88  CF-TERMINAL-MASTER             VALUE '9'.
  4570             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4571             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4572             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4573             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4574             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4575             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4576             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4577             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4578             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4579         16  CF-ACCESS-CD-GENL              PIC X(4).
  4580         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4581             20  CF-PROCESSOR               PIC X(4).
  4582         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4583             20  CF-STATE-CODE              PIC XX.
  4584             20  FILLER                     PIC XX.
  4585         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4586             20  FILLER                     PIC XX.
  4587             20  CF-HI-BEN-IN-REC           PIC XX.
  4588         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4589             20  FILLER                     PIC XXX.
  4590             20  CF-CARRIER-CNTL            PIC X.
  4591         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4592             20  FILLER                     PIC XX.
  4593             20  CF-HI-TYPE-IN-REC          PIC 99.
  4594         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4595             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4596                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4597             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4598             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4599         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4600             20  FILLER                     PIC X.
  4601             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4602         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4603             20  FILLER                     PIC XX.
  4604             20  CF-MORTGAGE-PLAN           PIC XX.
  4605         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4606
  4607     12  CF-LAST-MAINT-DT                   PIC XX.
  4608     12  CF-LAST-MAINT-BY                   PIC X(4).
  4609     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4610
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  85
* EL131.cbl
  4611     12  CF-RECORD-BODY                     PIC X(728).
  4612
  4613
  4614****************************************************************
  4615*             COMPANY MASTER RECORD                            *
  4616****************************************************************
  4617
  4618     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4619         16  CF-COMPANY-ADDRESS.
  4620             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4621             20  CF-CL-IN-CARE-OF           PIC X(30).
  4622             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4623             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4624             20  CF-CL-CITY-STATE           PIC X(30).
  4625             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4626             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4627         16  CF-COMPANY-CD                  PIC X.
  4628         16  CF-COMPANY-PASSWORD            PIC X(8).
  4629         16  CF-SECURITY-OPTION             PIC X.
  4630             88  ALL-SECURITY                   VALUE '1'.
  4631             88  COMPANY-VERIFY                 VALUE '2'.
  4632             88  PROCESSOR-VERIFY               VALUE '3'.
  4633             88  NO-SECURITY                    VALUE '4'.
  4634             88  ALL-BUT-TERM                   VALUE '5'.
  4635         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4636             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4637         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4638             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4639         16  CF-INFORCE-LOCATION            PIC X.
  4640             88  CERTS-ARE-ONLINE               VALUE '1'.
  4641             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4642             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4643         16  CF-LOWER-CASE-LETTERS          PIC X.
  4644         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4645             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4646             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4647             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4648             88  CF-ACCNT-CNTL                  VALUE '3'.
  4649             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4650
  4651         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4652         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4653
  4654         16  CF-LGX-CREDIT-USER             PIC X.
  4655             88  CO-IS-NOT-USER                 VALUE 'N'.
  4656             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4657
  4658         16 CF-CREDIT-CALC-CODES.
  4659             20  CF-CR-REM-TERM-CALC PIC X.
  4660               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4661               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4662               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4663               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4664               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4665               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4666               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4667             20  CF-CR-R78-METHOD           PIC X.
  4668               88  USE-TERM-PLUS-ONE            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  86
* EL131.cbl
  4669               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4670
  4671         16  CF-CLAIM-CONTROL-COUNTS.
  4672             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4673                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4674
  4675             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4676                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4677
  4678             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4679                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4680
  4681             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4682                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4683
  4684         16  CF-CURRENT-MONTH-END           PIC XX.
  4685
  4686         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4687             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4688             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4689             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4690             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4691                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4692                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4693             20  CF-CO-PREM-REJECT-SW       PIC X.
  4694                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4695                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4696             20  CF-CO-REF-REJECT-SW        PIC X.
  4697                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4698                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4699
  4700         16  CF-CO-REPORTING-DT             PIC XX.
  4701         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4702         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4703           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4704           88  CF-CO-MONTH-END                  VALUE '1'.
  4705
  4706         16  CF-LGX-CLAIM-USER              PIC X.
  4707             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4708             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4709
  4710         16  CF-CREDIT-EDIT-CONTROLS.
  4711             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4712             20  CF-MIN-AGE                 PIC 99.
  4713             20  CF-DEFAULT-AGE             PIC 99.
  4714             20  CF-MIN-TERM                PIC S999      COMP-3.
  4715             20  CF-MAX-TERM                PIC S999      COMP-3.
  4716             20  CF-DEFAULT-SEX             PIC X.
  4717             20  CF-JOINT-AGE-INPUT         PIC X.
  4718                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4719             20  CF-BIRTH-DATE-INPUT        PIC X.
  4720                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4721             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4722                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4723                 88  CF-ZERO-CARRIER            VALUE '1'.
  4724                 88  CF-ZERO-GROUPING           VALUE '2'.
  4725                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4726             20  CF-EDIT-SW                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  87
* EL131.cbl
  4727                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4728             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4729             20  CF-CR-PR-METHOD            PIC X.
  4730               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4731               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4732             20  FILLER                     PIC X.
  4733
  4734         16  CF-CREDIT-MISC-CONTROLS.
  4735             20  CF-REIN-TABLE-SW           PIC X.
  4736                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4737             20  CF-COMP-TABLE-SW           PIC X.
  4738                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4739             20  CF-EXPERIENCE-RETENTION-AGE
  4740                                            PIC S9        COMP-3.
  4741             20  CF-CONVERSION-DT           PIC XX.
  4742             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4743             20  CF-RUN-FREQUENCY-SW        PIC X.
  4744                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4745                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4746
  4747             20  CF-CR-CHECK-NO-CONTROL.
  4748                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4749                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4750                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4751                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4752                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4753                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4754
  4755                 24  CF-CR-CHECK-COUNT       REDEFINES
  4756                     CF-CR-CHECK-COUNTER      PIC X(4).
  4757
  4758                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4759                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4760
  4761                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4762                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4763                 24  CF-MAIL-PROCESSING       PIC X.
  4764                     88  MAIL-PROCESSING          VALUE 'Y'.
  4765
  4766         16  CF-MISC-SYSTEM-CONTROL.
  4767             20  CF-SYSTEM-C                 PIC X.
  4768                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4769             20  CF-SYSTEM-D                 PIC X.
  4770                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4771             20  CF-SOC-SEC-NO-SW            PIC X.
  4772                 88  SOC-SEC-NO-USED             VALUE '1'.
  4773             20  CF-MEMBER-NO-SW             PIC X.
  4774                 88  MEMBER-NO-USED              VALUE '1'.
  4775             20  CF-TAX-ID-NUMBER            PIC X(11).
  4776             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4777             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4778                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4779                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4780                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4781                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4782             20  CF-SYSTEM-E                 PIC X.
  4783                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4784
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  88
* EL131.cbl
  4785         16  CF-LGX-LIFE-USER               PIC X.
  4786             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4787             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4788
  4789         16  CF-CR-MONTH-END-DT             PIC XX.
  4790
  4791         16  CF-FILE-MAINT-DATES.
  4792             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4793                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4794             20  CF-LAST-BATCH       REDEFINES
  4795                 CF-LAST-BATCH-NO               PIC X(4).
  4796             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4797             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4798             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4799             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4800             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4801             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4802             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4803             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4804             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4805             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4806
  4807         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4808         16  FILLER                         PIC X.
  4809
  4810         16  CF-ALT-MORT-CODE               PIC X(4).
  4811         16  CF-MEMBER-CAPTION              PIC X(10).
  4812
  4813         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4814             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4815             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4816             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4817             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4818             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4819
  4820         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4821
  4822         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4823         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4824         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4825         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4826
  4827         16  CF-AH-OVERRIDE-L1              PIC X.
  4828         16  CF-AH-OVERRIDE-L2              PIC XX.
  4829         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4830         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4831
  4832         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4833         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4834
  4835         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4836         16  CF-AR-LAST-EL860-DT            PIC XX.
  4837         16  CF-MP-MONTH-END-DT             PIC XX.
  4838
  4839         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4840         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4841             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4842
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  89
* EL131.cbl
  4843         16  CF-AR-MONTH-END-DT             PIC XX.
  4844
  4845         16  CF-CRDTCRD-USER                PIC X.
  4846             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4847             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4848
  4849         16  CF-CC-MONTH-END-DT             PIC XX.
  4850
  4851         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4852
  4853         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4854             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4855             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4856             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4857         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4858         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4859         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4860         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4861             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4862             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4863         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4864         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4865         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4866             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4867         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4868
  4869         16  CF-CL-ZIP-CODE.
  4870             20  CF-CL-ZIP-PRIME.
  4871                 24  CF-CL-ZIP-1ST          PIC X.
  4872                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4873                 24  FILLER                 PIC X(4).
  4874             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4875         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4876             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4877             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4878             20  FILLER                     PIC XXX.
  4879
  4880         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4881         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4882         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4883         16  CF-CO-OPTION-START-DATE        PIC XX.
  4884         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4885           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4886                                                      '3' '4'.
  4887           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4888           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4889           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4890           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4891           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4892           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4893
  4894         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4895
  4896         16  CF-PAYMENT-APPROVAL-LEVELS.
  4897             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4898             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4899             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4900             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  90
* EL131.cbl
  4901             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4902             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4903
  4904         16  CF-END-USER-REPORTING-USER     PIC X.
  4905             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4906             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4907
  4908         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4909             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4910             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4911
  4912         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4913
  4914         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4915         16  FILLER                         PIC X.
  4916
  4917         16  CF-CREDIT-ARCHIVE-CNTL.
  4918             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4919             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4920             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4921
  4922         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4923
  4924         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4925             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4926             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4927
  4928         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4929             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4930             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4931
  4932         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4933
  4934         16  CF-CO-ACH-ID-CODE              PIC  X.
  4935             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4936             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4937             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4938         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4939         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4940         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4941         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4942         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4943         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4944         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4945         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4946         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4947                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4948         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4949                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4950
  4951         16  CF-CO-OVER-SHORT.
  4952             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4953             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4954
  4955*         16  FILLER                         PIC X(102).
  4956         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4957             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4958             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  91
* EL131.cbl
  4959
  4960         16  CF-AH-APPROVAL-DAYS.
  4961             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4962             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4963             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4964             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4965
  4966         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4967
  4968         16  FILLER                         PIC X(79).
  4969****************************************************************
  4970*             PROCESSOR/USER RECORD                            *
  4971****************************************************************
  4972
  4973     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4974         16  CF-PROCESSOR-NAME              PIC X(30).
  4975         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4976         16  CF-PROCESSOR-TITLE             PIC X(26).
  4977         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4978                 88  MESSAGE-YES                VALUE 'Y'.
  4979                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4980
  4981*****************************************************
  4982****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4983****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4984****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4985****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4986*****************************************************
  4987
  4988         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4989             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4990             20  CF-APPLICATION-FORCE       PIC X.
  4991             20  CF-INDIVIDUAL-APP.
  4992                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4993                     28  CF-BROWSE-APP      PIC X.
  4994                     28  CF-UPDATE-APP      PIC X.
  4995
  4996         16  CF-CURRENT-TERM-ON             PIC X(4).
  4997         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4998             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4999             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5000             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5001             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5002             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5003             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5004             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5005         16  CF-PROCESSOR-CARRIER           PIC X.
  5006             88  NO-CARRIER-SECURITY            VALUE ' '.
  5007         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5008             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5009         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5010             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5011         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5012             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5013
  5014         16  CF-PROC-SYS-ACCESS-SW.
  5015             20  CF-PROC-CREDIT-CLAIMS-SW.
  5016                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  92
* EL131.cbl
  5017                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5018                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5019                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5020             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5021                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5022                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5023             20  CF-PROC-LIFE-GNRLDGR-SW.
  5024                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5025                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5026                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5027                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5028             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5029                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5030                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5031         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5032             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5033             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5034         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5035
  5036         16  CF-APPROVAL-LEVEL                  PIC X.
  5037             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5038             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5039             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5040             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5041
  5042         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5043
  5044         16  CF-LANGUAGE-TYPE                   PIC X.
  5045             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5046             88  CF-LANG-IS-FR                      VALUE 'F'.
  5047
  5048         16  CF-CSR-IND                         PIC X.
  5049         16  FILLER                             PIC X(239).
  5050
  5051****************************************************************
  5052*             PROCESSOR/REMINDERS RECORD                       *
  5053****************************************************************
  5054
  5055     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5056         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5057             20  CF-START-REMIND-DT         PIC XX.
  5058             20  CF-END-REMIND-DT           PIC XX.
  5059             20  CF-REMINDER-TEXT           PIC X(50).
  5060         16  FILLER                         PIC X(296).
  5061
  5062
  5063****************************************************************
  5064*             STATE MASTER RECORD                              *
  5065****************************************************************
  5066
  5067     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5068         16  CF-STATE-ABBREVIATION          PIC XX.
  5069         16  CF-STATE-NAME                  PIC X(25).
  5070         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5071         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5072             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5073             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5074             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  93
* EL131.cbl
  5075             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5076                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5077                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5078             20  CF-ST-PREM-REJECT-SW       PIC X.
  5079                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5080                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5081             20  CF-ST-REF-REJECT-SW        PIC X.
  5082                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5083                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5084         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5085         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5086         16  CF-ST-REFUND-RULES.
  5087             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5088             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5089             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5090         16  CF-ST-FST-PMT-EXTENSION.
  5091             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5092             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5093                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5094                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5095                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5096                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5097         16  CF-ST-STATE-CALL.
  5098             20  CF-ST-CALL-UNEARNED        PIC X.
  5099             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5100             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5101         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5102             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5103             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5104         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5105         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5106         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5107         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5108         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5109         16  FILLER                         PIC X.
  5110         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5111             20  CF-ST-BENEFIT-CD           PIC XX.
  5112             20  CF-ST-BENEFIT-KIND         PIC X.
  5113                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5114                 88  CF-ST-AH-KIND              VALUE 'A'.
  5115             20  CF-ST-REM-TERM-CALC        PIC X.
  5116                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5117                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5118                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5119                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5120                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5121                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5122                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5123                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5124
  5125             20  CF-ST-REFUND-CALC          PIC X.
  5126                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5127                 88  ST-REFD-BY-R78             VALUE '1'.
  5128                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5129                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5130                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5131                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5132                 88  ST-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  94
* EL131.cbl
  5133                 88  ST-REFD-UTAH               VALUE '7'.
  5134                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5135                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5136                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5137
  5138             20  CF-ST-EARNING-CALC         PIC X.
  5139                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5140                 88  ST-EARN-BY-R78             VALUE '1'.
  5141                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5142                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5143                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5144                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5145                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5146                 88  ST-EARN-MEAN               VALUE '8'.
  5147                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5148
  5149             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5150                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5151                 88  ST-OVRD-BY-R78             VALUE '1'.
  5152                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5153                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5154                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5155                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5156                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5157                 88  ST-OVRD-MEAN               VALUE '8'.
  5158                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5159             20  FILLER                     PIC X.
  5160
  5161         16  CF-ST-COMMISSION-CAPS.
  5162             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5163             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5164             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5165             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5166         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5167                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5168
  5169         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5170
  5171         16  CF-ST-STATUTORY-INTEREST.
  5172             20  CF-ST-STAT-DATE-FROM       PIC X.
  5173                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5174                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5175             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5176             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5177             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5178             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5179             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5180
  5181         16  CF-ST-OVER-SHORT.
  5182             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5183             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5184
  5185         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5186
  5187         16  CF-ST-RT-CALC                  PIC X.
  5188
  5189         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5190         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  95
* EL131.cbl
  5191         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5192         16  CF-ST-RF-LR-CALC               PIC X.
  5193         16  CF-ST-RF-LL-CALC               PIC X.
  5194         16  CF-ST-RF-LN-CALC               PIC X.
  5195         16  CF-ST-RF-AH-CALC               PIC X.
  5196         16  CF-ST-RF-CP-CALC               PIC X.
  5197*        16  FILLER                         PIC X(206).
  5198*CIDMOD         16  FILLER                         PIC X(192).
  5199         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5200             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5201         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5202         16  CF-ST-VFY-2ND-BENE             PIC X.
  5203         16  CF-ST-CAUSAL-STATE             PIC X.
  5204         16  FILLER                         PIC X(185).
  5205
  5206****************************************************************
  5207*             BENEFIT MASTER RECORD                            *
  5208****************************************************************
  5209
  5210     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5211         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5212             20  CF-BENEFIT-CODE            PIC XX.
  5213             20  CF-BENEFIT-NUMERIC  REDEFINES
  5214                 CF-BENEFIT-CODE            PIC XX.
  5215             20  CF-BENEFIT-ALPHA           PIC XXX.
  5216             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5217             20  CF-BENEFIT-COMMENT         PIC X(10).
  5218
  5219             20  CF-LF-COVERAGE-TYPE        PIC X.
  5220                 88  CF-REDUCING                VALUE 'R'.
  5221                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5222
  5223             20  CF-SPECIAL-CALC-CD         PIC X.
  5224                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5225                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5226                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5227                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5228                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5229                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5230                 88  CF-FARM-PLAN               VALUE 'F'.
  5231                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5232                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5233                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5234                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5235                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5236                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5237                 88  CF-PRUDENTIAL              VALUE 'P'.
  5238                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5239                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5240                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5241                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5242                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5243                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5244
  5245             20  CF-JOINT-INDICATOR         PIC X.
  5246                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5247
  5248*            20  FILLER                     PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  96
* EL131.cbl
  5249             20  FILLER                     PIC X(11).
  5250             20  CF-BENEFIT-CATEGORY        PIC X.
  5251             20  CF-LOAN-TYPE               PIC X(8).
  5252
  5253             20  CF-CO-REM-TERM-CALC        PIC X.
  5254                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5255                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5256                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5257                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5258                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5259
  5260             20  CF-CO-EARNINGS-CALC        PIC X.
  5261                 88  CO-EARN-BY-R78             VALUE '1'.
  5262                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5263                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5264                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5265                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5266                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5267                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5268                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5269
  5270             20  CF-CO-REFUND-CALC          PIC X.
  5271                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5272                 88  CO-REFD-BY-R78             VALUE '1'.
  5273                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5274                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5275                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5276                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5277                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5278                 88  CO-REFD-MEAN               VALUE '8'.
  5279                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5280                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5281                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5282
  5283             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5284                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5285                 88  CO-OVRD-BY-R78             VALUE '1'.
  5286                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5287                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5288                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5289                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5290                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5291                 88  CO-OVRD-MEAN               VALUE '8'.
  5292                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5293
  5294             20  CF-CO-BEN-I-G-CD           PIC X.
  5295                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5296                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5297                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5298
  5299         16  FILLER                         PIC X(304).
  5300
  5301
  5302****************************************************************
  5303*             CARRIER MASTER RECORD                            *
  5304****************************************************************
  5305
  5306     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  97
* EL131.cbl
  5307         16  CF-ADDRESS-DATA.
  5308             20  CF-MAIL-TO-NAME            PIC X(30).
  5309             20  CF-IN-CARE-OF              PIC X(30).
  5310             20  CF-ADDRESS-LINE-1          PIC X(30).
  5311             20  CF-ADDRESS-LINE-2          PIC X(30).
  5312             20  CF-CITY-STATE              PIC X(30).
  5313             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5314             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5315
  5316         16  CF-CLAIM-NO-CONTROL.
  5317             20  CF-CLAIM-NO-METHOD         PIC X.
  5318                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5319                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5320                 88  CLAIM-NO-SEQ               VALUE '3'.
  5321                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5322             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5323                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5324                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5325                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5326
  5327         16  CF-CHECK-NO-CONTROL.
  5328             20  CF-CHECK-NO-METHOD         PIC X.
  5329                 88  CHECK-NO-MANUAL            VALUE '1'.
  5330                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5331                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5332                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5333             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5334                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5335
  5336         16  CF-DOMICILE-STATE              PIC XX.
  5337
  5338         16  CF-EXPENSE-CONTROLS.
  5339             20  CF-EXPENSE-METHOD          PIC X.
  5340                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5341                 88  DOLLARS-PER-PMT            VALUE '2'.
  5342                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5343                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5344             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5345             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5346
  5347         16  CF-CORRESPONDENCE-CONTROL.
  5348             20  CF-LETTER-RESEND-OPT       PIC X.
  5349                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5350                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5351             20  FILLER                     PIC X(4).
  5352
  5353         16  CF-RESERVE-CONTROLS.
  5354             20  CF-MANUAL-SW               PIC X.
  5355                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5356             20  CF-FUTURE-SW               PIC X.
  5357                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5358             20  CF-PTC-SW                  PIC X.
  5359                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5360             20  CF-IBNR-SW                 PIC X.
  5361                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5362             20  CF-PTC-LF-SW               PIC X.
  5363                 88  CF-LF-PTC-USED             VALUE '1'.
  5364             20  CF-CDT-ACCESS-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  98
* EL131.cbl
  5365                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5366                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5367                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5368             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5369
  5370         16  CF-CLAIM-CALC-METHOD           PIC X.
  5371             88  360-PLUS-MONTHS                VALUE '1'.
  5372             88  365-PLUS-MONTHS                VALUE '2'.
  5373             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5374             88  360-DAILY                      VALUE '4'.
  5375             88  365-DAILY                      VALUE '5'.
  5376
  5377         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5378         16  FILLER                         PIC X(11).
  5379
  5380         16  CF-LIMIT-AMOUNTS.
  5381             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5382             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5383             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5384             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5385             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5386             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5387             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5388             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5389             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5390             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5391
  5392         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5393         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5394         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5395
  5396         16  CF-ZIP-CODE.
  5397             20  CF-ZIP-PRIME.
  5398                 24  CF-ZIP-1ST             PIC X.
  5399                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5400                 24  FILLER                 PIC X(4).
  5401             20  CF-ZIP-PLUS4               PIC X(4).
  5402         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5403             20  CF-CAN-POSTAL-1            PIC XXX.
  5404             20  CF-CAN-POSTAL-2            PIC XXX.
  5405             20  FILLER                     PIC XXX.
  5406
  5407         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5408         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5409         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5410
  5411         16  CF-RATING-SWITCH               PIC X.
  5412             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5413             88  CF-NO-RATING                   VALUE 'N'.
  5414
  5415         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5416
  5417         16  CF-CARRIER-OVER-SHORT.
  5418             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5419             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5420
  5421         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5422         16  CF-SECPAY-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page  99
* EL131.cbl
  5423             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5424             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5425         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5426         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5427         16  FILLER                         PIC X(444).
  5428*        16  FILLER                         PIC X(452).
  5429
  5430
  5431****************************************************************
  5432*             MORTALITY MASTER RECORD                          *
  5433****************************************************************
  5434
  5435     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5436         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5437                                INDEXED BY CF-MORT-NDX.
  5438             20  CF-MORT-TABLE              PIC X(5).
  5439             20  CF-MORT-TABLE-TYPE         PIC X.
  5440                 88  CF-MORT-JOINT              VALUE 'J'.
  5441                 88  CF-MORT-SINGLE             VALUE 'S'.
  5442                 88  CF-MORT-COMBINED           VALUE 'C'.
  5443                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5444                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5445             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5446             20  CF-MORT-AGE-METHOD         PIC XX.
  5447                 88  CF-AGE-LAST                VALUE 'AL'.
  5448                 88  CF-AGE-NEAR                VALUE 'AN'.
  5449             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5450             20  CF-MORT-ADJUSTMENT-DIRECTION
  5451                                            PIC X.
  5452                 88  CF-MINUS                   VALUE '-'.
  5453                 88  CF-PLUS                    VALUE '+'.
  5454             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5455             20  CF-MORT-JOINT-CODE         PIC X.
  5456                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5457             20  CF-MORT-PC-Q               PIC X.
  5458                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5459             20  CF-MORT-TABLE-CODE         PIC X(4).
  5460             20  CF-MORT-COMMENTS           PIC X(15).
  5461             20  FILLER                     PIC X(14).
  5462
  5463         16  FILLER                         PIC X(251).
  5464
  5465
  5466****************************************************************
  5467*             BUSSINESS TYPE MASTER RECORD                     *
  5468****************************************************************
  5469
  5470     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5471* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5472* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5473* AND RECORD 05 IS TYPES 81-99
  5474         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5475             20  CF-BUSINESS-TITLE          PIC  X(19).
  5476             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5477                                            PIC S9V9(4) COMP-3.
  5478             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5479             20  FILLER                     PIC  X.
  5480         16  FILLER                         PIC  X(248).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 100
* EL131.cbl
  5481
  5482
  5483****************************************************************
  5484*             TERMINAL MASTER RECORD                           *
  5485****************************************************************
  5486
  5487     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5488
  5489         16  CF-COMPANY-TERMINALS.
  5490             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5491                                  PIC X(4).
  5492         16  FILLER               PIC X(248).
  5493
  5494
  5495****************************************************************
  5496*             LIFE EDIT MASTER RECORD                          *
  5497****************************************************************
  5498
  5499     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5500         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5501             20  CF-LIFE-CODE-IN            PIC XX.
  5502             20  CF-LIFE-CODE-OUT           PIC XX.
  5503         16  FILLER                         PIC X(248).
  5504
  5505
  5506****************************************************************
  5507*             AH EDIT MASTER RECORD                            *
  5508****************************************************************
  5509
  5510     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5511         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5512             20  CF-AH-CODE-IN              PIC XXX.
  5513             20  CF-AH-CODE-OUT             PIC XX.
  5514         16  FILLER                         PIC X(248).
  5515
  5516
  5517****************************************************************
  5518*             CREDIBILITY TABLES                               *
  5519****************************************************************
  5520
  5521     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5522         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5523                             INDEXED BY CF-CRDB-NDX.
  5524             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5525             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5526             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5527         16  FILLER                         PIC  X(332).
  5528
  5529
  5530****************************************************************
  5531*             REPORT CUSTOMIZATION RECORD                      *
  5532****************************************************************
  5533
  5534     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5535         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5536             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5537             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5538             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 101
* EL131.cbl
  5539**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5540****       A T-TRANSFER.                                   ****
  5541             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5542
  5543         16  FILLER                         PIC XX.
  5544
  5545         16  CF-CARRIER-CNTL-OPT.
  5546             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5547                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5548                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5549             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5550                                            PIC X.
  5551         16  CF-GROUP-CNTL-OPT.
  5552             20  CF-GROUP-OPT-SEQ           PIC 9.
  5553                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5554                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5555             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5556                                            PIC X(6).
  5557         16  CF-STATE-CNTL-OPT.
  5558             20  CF-STATE-OPT-SEQ           PIC 9.
  5559                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5560                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5561             20  CF-STATE-SELECT OCCURS 3 TIMES
  5562                                            PIC XX.
  5563         16  CF-ACCOUNT-CNTL-OPT.
  5564             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5565                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5566                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5567             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5568                                            PIC X(10).
  5569         16  CF-BUS-TYP-CNTL-OPT.
  5570             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5571                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5572                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5573             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5574                                            PIC XX.
  5575         16  CF-LF-TYP-CNTL-OPT.
  5576             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5577                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5578                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5579             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5580                                            PIC XX.
  5581         16  CF-AH-TYP-CNTL-OPT.
  5582             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5583                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5584                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5585             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5586                                            PIC XX.
  5587         16  CF-REPTCD1-CNTL-OPT.
  5588             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5589                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5590                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5591             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5592                                            PIC X(10).
  5593         16  CF-REPTCD2-CNTL-OPT.
  5594             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5595                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5596                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 102
* EL131.cbl
  5597             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5598                                            PIC X(10).
  5599         16  CF-USER1-CNTL-OPT.
  5600             20  CF-USER1-OPT-SEQ           PIC 9.
  5601                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5602                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5603             20  CF-USER1-SELECT OCCURS 3 TIMES
  5604                                            PIC X(10).
  5605         16  CF-USER2-CNTL-OPT.
  5606             20  CF-USER2-OPT-SEQ           PIC 9.
  5607                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5608                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5609             20  CF-USER2-SELECT OCCURS 3 TIMES
  5610                                            PIC X(10).
  5611         16  CF-USER3-CNTL-OPT.
  5612             20  CF-USER3-OPT-SEQ           PIC 9.
  5613                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5614                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5615             20  CF-USER3-SELECT OCCURS 3 TIMES
  5616                                            PIC X(10).
  5617         16  CF-USER4-CNTL-OPT.
  5618             20  CF-USER4-OPT-SEQ           PIC 9.
  5619                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5620                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5621             20  CF-USER4-SELECT OCCURS 3 TIMES
  5622                                            PIC X(10).
  5623         16  CF-USER5-CNTL-OPT.
  5624             20  CF-USER5-OPT-SEQ           PIC 9.
  5625                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5626                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5627             20  CF-USER5-SELECT OCCURS 3 TIMES
  5628                                            PIC X(10).
  5629         16  CF-REINS-CNTL-OPT.
  5630             20  CF-REINS-OPT-SEQ           PIC 9.
  5631                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5632                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5633             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5634                 24  CF-REINS-PRIME         PIC XXX.
  5635                 24  CF-REINS-SUB           PIC XXX.
  5636
  5637         16  CF-AGENT-CNTL-OPT.
  5638             20  CF-AGENT-OPT-SEQ           PIC 9.
  5639                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5640                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5641             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5642                                            PIC X(10).
  5643
  5644         16  FILLER                         PIC X(43).
  5645
  5646         16  CF-LOSS-RATIO-SELECT.
  5647             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5648             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5649         16  CF-ENTRY-DATE-SELECT.
  5650             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5651             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5652         16  CF-EFFECTIVE-DATE-SELECT.
  5653             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5654             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 103
* EL131.cbl
  5655
  5656         16  CF-EXCEPTION-LIST-IND          PIC X.
  5657             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5658
  5659         16  FILLER                         PIC X(318).
  5660
  5661****************************************************************
  5662*                  EXCEPTION REPORTING RECORD                  *
  5663****************************************************************
  5664
  5665     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5666         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5667             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5668
  5669         16  CF-COMBINED-LIFE-AH-OPT.
  5670             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5671             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5672             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5673             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5674
  5675         16  CF-LIFE-OPT.
  5676             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5677             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5678             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5679             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5680             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5681             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5682             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5683             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5684             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5685             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5686
  5687         16  CF-AH-OPT.
  5688             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5689             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5690             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5691             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5692             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5693             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5694             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5695             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5696             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5697             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5698
  5699         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5700             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5701             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5702             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5703
  5704         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5705
  5706         16  FILLER                         PIC X(673).
  5707
  5708
  5709****************************************************************
  5710*             MORTGAGE SYSTEM PLAN RECORD                      *
  5711****************************************************************
  5712
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 104
* EL131.cbl
  5713     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5714         16  CF-PLAN-TYPE                   PIC X.
  5715             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5716             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5717             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5718         16  CF-PLAN-ABBREV                 PIC XXX.
  5719         16  CF-PLAN-DESCRIPT               PIC X(10).
  5720         16  CF-PLAN-NOTES                  PIC X(20).
  5721         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5722         16  CF-PLAN-UNDERWRITING.
  5723             20  CF-PLAN-TERM-DATA.
  5724                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5725                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5726             20  CF-PLAN-AGE-DATA.
  5727                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5728                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5729                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5730             20  CF-PLAN-BENEFIT-DATA.
  5731                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5732                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5733                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5734                                            PIC S9(7)V99  COMP-3.
  5735         16  CF-PLAN-POLICY-FORMS.
  5736             20  CF-POLICY-FORM             PIC X(12).
  5737             20  CF-MASTER-APPLICATION      PIC X(12).
  5738             20  CF-MASTER-POLICY           PIC X(12).
  5739         16  CF-PLAN-RATING.
  5740             20  CF-RATE-CODE               PIC X(5).
  5741             20  CF-SEX-RATING              PIC X.
  5742                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5743                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5744             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5745             20  CF-SUB-STD-TYPE            PIC X.
  5746                 88  CF-PCT-OF-PREM            VALUE '1'.
  5747                 88  CF-PCT-OF-BENE            VALUE '2'.
  5748         16  CF-PLAN-PREM-TOLERANCES.
  5749             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5750             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5751         16  CF-PLAN-PYMT-TOLERANCES.
  5752             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5753             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5754         16  CF-PLAN-MISC-DATA.
  5755             20  FILLER                     PIC X.
  5756             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5757             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5758         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5759         16  CF-PLAN-IND-GRP                PIC X.
  5760             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5761                                                     '1'.
  5762             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5763                                                     '2'.
  5764         16  CF-MIB-SEARCH-SW               PIC X.
  5765             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5766             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5767             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5768             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5769         16  CF-ALPHA-SEARCH-SW             PIC X.
  5770             88  CF-MIB-ALPHA-ALL              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 105
* EL131.cbl
  5771             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5772             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5773             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5774             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5775             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5776             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5777             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5778             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5779             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5780                                                     'A' 'B' 'C'
  5781                                                     'X' 'Y' 'Z'.
  5782         16  CF-EFF-DT-RULE-SW              PIC X.
  5783             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5784             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5785             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5786             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5787             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5788         16  FILLER                         PIC X(4).
  5789         16  CF-HEALTH-QUESTIONS            PIC X.
  5790             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5791         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5792         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5793         16  CF-PLAN-SNGL-JNT               PIC X.
  5794             88  CF-COMBINED-PLAN              VALUE 'C'.
  5795             88  CF-JNT-PLAN                   VALUE 'J'.
  5796             88  CF-SNGL-PLAN                  VALUE 'S'.
  5797         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5798         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5799         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5800         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5801         16  CF-RERATE-CNTL                 PIC  X.
  5802             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5803             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5804             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5805             88  CF-AUTO-RECALC                 VALUE '4'.
  5806         16  CF-BENEFIT-TYPE                PIC  X.
  5807             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5808             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5809         16  CF-POLICY-FEE                  PIC S999V99
  5810                                                    COMP-3.
  5811         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5812         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5813         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5814         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5815         16  FILLER                         PIC  X(32).
  5816         16  CF-TERMINATION-FORM            PIC  X(04).
  5817         16  FILLER                         PIC  X(08).
  5818         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5819                                                       COMP-3.
  5820         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5821         16  CF-ISSUE-LETTER                PIC  X(4).
  5822         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5823         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5824             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5825             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5826         16  CF-MP-REFUND-CALC              PIC X.
  5827             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5828             88  CF-MP-REFD-BY-R78              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 106
* EL131.cbl
  5829             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5830             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5831             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5832             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5833             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5834             88  CF-MP-REFD-MEAN                VALUE '8'.
  5835         16  CF-ALT-RATE-CODE               PIC  X(5).
  5836
  5837
  5838         16  FILLER                         PIC X(498).
  5839****************************************************************
  5840*             MORTGAGE COMPANY MASTER RECORD                   *
  5841****************************************************************
  5842
  5843     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5844         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5845         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5846             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5847             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5848             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5849             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5850             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5851
  5852         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5853         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5854         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5855         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5856         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5857
  5858         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5859             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5860         16  CF-MP-RECON-USE-IND            PIC X(1).
  5861             88  CF-MP-USE-RECON             VALUE 'Y'.
  5862         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5863             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5864         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5865             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5866             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5867         16  FILLER                         PIC X(1).
  5868         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5869             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5870         16  CF-MORTG-MIB-VERSION           PIC X.
  5871             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5872             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5873             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5874         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5875             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5876                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5877             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5878                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5879             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5880                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5881             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5882                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5883             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5884                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5885             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5886                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 107
* EL131.cbl
  5887         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5888         16  FILLER                         PIC X(7).
  5889         16  CF-MORTG-DESTINATION-SYMBOL.
  5890             20  CF-MORTG-MIB-COMM          PIC X(5).
  5891             20  CF-MORTG-MIB-TERM          PIC X(5).
  5892         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5893             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5894         16  FILLER                         PIC X(03).
  5895         16  CF-MP-CHECK-NO-CONTROL.
  5896             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5897                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5898                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5899                                                ' ' LOW-VALUES.
  5900                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5901                                               VALUE '3'.
  5902         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5903         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5904         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5905             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5906                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5907             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5908                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5909             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5910                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5911             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5912                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5913             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5914                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5915             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5916                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5917         16  CF-MORTG-BILLING-AREA.
  5918             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5919                                            PIC X.
  5920         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5921         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5922         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5923         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5924             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5925             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5926         16  FILLER                         PIC X.
  5927         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5928             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5929             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5930         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5931         16  FILLER                         PIC X(8).
  5932         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5933         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5934         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5935         16  CF-ACH-COMPANY-ID.
  5936             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5937                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5938                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5939                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5940             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5941         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5942             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5943         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5944             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 108
* EL131.cbl
  5945             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5946         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5947         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5948         16  FILLER                         PIC X(536).
  5949
  5950****************************************************************
  5951*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5952****************************************************************
  5953
  5954     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5955         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5956             20  CF-FEMALE-HEIGHT.
  5957                 24  CF-FEMALE-FT           PIC 99.
  5958                 24  CF-FEMALE-IN           PIC 99.
  5959             20  CF-FEMALE-MIN-WT           PIC 999.
  5960             20  CF-FEMALE-MAX-WT           PIC 999.
  5961         16  FILLER                         PIC X(428).
  5962
  5963     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5964         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5965             20  CF-MALE-HEIGHT.
  5966                 24  CF-MALE-FT             PIC 99.
  5967                 24  CF-MALE-IN             PIC 99.
  5968             20  CF-MALE-MIN-WT             PIC 999.
  5969             20  CF-MALE-MAX-WT             PIC 999.
  5970         16  FILLER                         PIC X(428).
  5971******************************************************************
  5972*             AUTOMATIC ACTIVITY RECORD                          *
  5973******************************************************************
  5974     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5975         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5976             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5977             20  CF-SYS-LETTER-ID           PIC X(04).
  5978             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5979             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5980             20  CF-SYS-RESET-SW            PIC X(01).
  5981             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5982             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5983
  5984         16  FILLER                         PIC X(50).
  5985
  5986         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5987             20  CF-USER-ACTIVE-SW          PIC X(01).
  5988             20  CF-USER-LETTER-ID          PIC X(04).
  5989             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5990             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5991             20  CF-USER-RESET-SW           PIC X(01).
  5992             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5993             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5994             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5995
  5996         16  FILLER                         PIC X(246).
  5997
  5998*                                COPY ELCACTQ.
  5999******************************************************************
  6000*                                                                *
  6001*                            ELCACTQ.                            *
  6002*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 109
* EL131.cbl
  6003*                            VMOD=2.004                          *
  6004*                                                                *
  6005*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6006*                                                                *
  6007*   FILE TYPE = VSAM,KSDS                                        *
  6008*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6009*                                                                *
  6010*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6011*       ALTERNATE INDEX = NONE                                   *
  6012*                                                                *
  6013*   LOG = YES                                                    *
  6014*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6015*                                                                *
  6016*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6017******************************************************************
  6018
  6019 01  ACTIVITY-QUE.
  6020     12  AQ-RECORD-ID                PIC XX.
  6021         88  VALID-AQ-ID                VALUE 'AQ'.
  6022
  6023     12  AQ-CONTROL-PRIMARY.
  6024         16  AQ-COMPANY-CD           PIC X.
  6025         16  AQ-CARRIER              PIC X.
  6026         16  AQ-CLAIM-NO             PIC X(7).
  6027         16  AQ-CERT-NO.
  6028             20  AQ-CERT-PRIME       PIC X(10).
  6029             20  AQ-CERT-SFX         PIC X.
  6030
  6031     12  AQ-PENDING-ACTIVITY-FLAGS.
  6032         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6033         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6034             88  PENDING-PAYMENTS       VALUE '1'.
  6035         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6036             88  PENDING-FULL-PRINT     VALUE '1'.
  6037             88  PENDING-PART-PRINT     VALUE '2'.
  6038         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6039             88  PENDING-LETTERS        VALUE '1'.
  6040         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6041             88  PENDING-RESTORE        VALUE 'C'.
  6042             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6043
  6044     12  FILLER                      PIC X(20).
  6045
  6046     12  AQ-RESEND-DATE              PIC XX.
  6047     12  AQ-FOLLOWUP-DATE            PIC XX.
  6048     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6049     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6050     12  AQ-AUTO-LETTER              PIC X(4).
  6051     12  FILLER                      PIC XX.
  6052     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6053*****************************************************************
  6054
  6055*                                COPY ERCACCT.
  6056******************************************************************
  6057*                                                                *
  6058*                                                                *
  6059*                            ERCACCT                             *
  6060*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 110
* EL131.cbl
  6061*                            VMOD=2.031                          *
  6062*                                                                *
  6063*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6064*                                                                *
  6065*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6066*   VSAM ACCOUNT MASTER FILES.                                   *
  6067*                                                                *
  6068*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6069*                                                                *
  6070*   FILE TYPE = VSAM,KSDS                                        *
  6071*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6072*                                                                *
  6073*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6074*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6075*                                                                *
  6076*   LOG = NO                                                     *
  6077*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6078*                                                                *
  6079*                                                                *
  6080******************************************************************
  6081*                   C H A N G E   L O G
  6082*
  6083* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6084*-----------------------------------------------------------------
  6085*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6086* EFFECTIVE    NUMBER
  6087*-----------------------------------------------------------------
  6088* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6089* 092705    2005050300006  PEMA  ADD SPP LEASES
  6090* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6091* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6092* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6093* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6094* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6095******************************************************************
  6096
  6097 01  ACCOUNT-MASTER.
  6098     12  AM-RECORD-ID                      PIC XX.
  6099         88  VALID-AM-ID                      VALUE 'AM'.
  6100
  6101     12  AM-CONTROL-PRIMARY.
  6102         16  AM-COMPANY-CD                 PIC X.
  6103         16  AM-MSTR-CNTRL.
  6104             20  AM-CONTROL-A.
  6105                 24  AM-CARRIER            PIC X.
  6106                 24  AM-GROUPING.
  6107                     28 AM-GROUPING-PREFIX PIC XXX.
  6108                     28 AM-GROUPING-PRIME  PIC XXX.
  6109                 24  AM-STATE              PIC XX.
  6110                 24  AM-ACCOUNT.
  6111                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6112                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6113             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6114                                           PIC X(19).
  6115             20  AM-CNTRL-B.
  6116                 24  AM-EXPIRATION-DT      PIC XX.
  6117                 24  FILLER                PIC X(4).
  6118             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 111
* EL131.cbl
  6119                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6120
  6121     12  AM-CONTROL-BY-VAR-GRP.
  6122         16  AM-COMPANY-CD-A1              PIC X.
  6123         16  AM-VG-CARRIER                 PIC X.
  6124         16  AM-VG-GROUPING                PIC X(6).
  6125         16  AM-VG-STATE                   PIC XX.
  6126         16  AM-VG-ACCOUNT                 PIC X(10).
  6127         16  AM-VG-DATE.
  6128             20  AM-VG-EXPIRATION-DT       PIC XX.
  6129             20  FILLER                    PIC X(4).
  6130         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6131                                           PIC 9(11)      COMP-3.
  6132     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6133         16  FILLER                        PIC X(10).
  6134         16  AM-VG-KEY3.
  6135             20  AM-VG3-ACCOUNT            PIC X(10).
  6136             20  AM-VG3-EXP-DT             PIC XX.
  6137         16  FILLER                        PIC X(4).
  6138     12  AM-MAINT-INFORMATION.
  6139         16  AM-LAST-MAINT-DT              PIC XX.
  6140         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6141         16  AM-LAST-MAINT-USER            PIC X(4).
  6142         16  FILLER                        PIC XX.
  6143
  6144     12  AM-EFFECTIVE-DT                   PIC XX.
  6145     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6146
  6147     12  AM-PREV-DATES  COMP-3.
  6148         16  AM-PREV-EXP-DT                PIC 9(11).
  6149         16  AM-PREV-EFF-DT                PIC 9(11).
  6150
  6151     12  AM-REPORT-CODE-1                  PIC X(10).
  6152     12  AM-REPORT-CODE-2                  PIC X(10).
  6153
  6154     12  AM-CITY-CODE                      PIC X(4).
  6155     12  AM-COUNTY-PARISH                  PIC X(6).
  6156
  6157     12  AM-NAME                           PIC X(30).
  6158     12  AM-PERSON                         PIC X(30).
  6159     12  AM-ADDRS                          PIC X(30).
  6160     12  AM-CITY.
  6161         16  AM-ADDR-CITY                  PIC X(28).
  6162         16  AM-ADDR-STATE                 PIC XX.
  6163     12  AM-ZIP.
  6164         16  AM-ZIP-PRIME.
  6165             20  AM-ZIP-PRI-1ST            PIC X.
  6166                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6167             20  FILLER                    PIC X(4).
  6168         16  AM-ZIP-PLUS4                  PIC X(4).
  6169     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6170         16  AM-CAN-POSTAL-1               PIC XXX.
  6171         16  AM-CAN-POSTAL-2               PIC XXX.
  6172         16  FILLER                        PIC XXX.
  6173     12  AM-TEL-NO.
  6174         16  AM-AREA-CODE                  PIC 999.
  6175         16  AM-TEL-PRE                    PIC 999.
  6176         16  AM-TEL-NBR                    PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 112
* EL131.cbl
  6177     12  AM-TEL-LOC                        PIC X.
  6178         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6179         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6180
  6181     12  AM-COMM-STRUCTURE.
  6182         16  AM-DEFN-1.
  6183             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6184                 24  AM-AGT.
  6185                     28  AM-AGT-PREFIX     PIC X(4).
  6186                     28  AM-AGT-PRIME      PIC X(6).
  6187                 24  AM-COM-TYP            PIC X.
  6188                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6189                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6190                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6191                 24  AM-RECALC-LV-INDIC    PIC X.
  6192                 24  AM-RETRO-LV-INDIC     PIC X.
  6193                 24  AM-GL-CODES           PIC X.
  6194                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6195                 24  FILLER                PIC X(01).
  6196         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6197             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6198                 24  FILLER                PIC X(11).
  6199                 24  AM-L-COMA             PIC XXX.
  6200                 24  AM-J-COMA             PIC XXX.
  6201                 24  AM-A-COMA             PIC XXX.
  6202                 24  FILLER                PIC X(6).
  6203
  6204     12  AM-COMM-CHANGE-STATUS             PIC X.
  6205         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6206
  6207     12  AM-CSR-CODE                       PIC X(4).
  6208
  6209     12  AM-BILLING-STATUS                 PIC X.
  6210         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6211         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6212     12  AM-AUTO-REFUND-SW                 PIC X.
  6213         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6214         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6215     12  AM-GPCD                           PIC 99.
  6216     12  AM-IG                             PIC X.
  6217         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6218         88  AM-HAS-GROUP                     VALUE '2'.
  6219     12  AM-STATUS                         PIC X.
  6220         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6221         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6222         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6223         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6224         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6225         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6226     12  AM-REMIT-TO                       PIC 99.
  6227     12  AM-ID-NO                          PIC X(11).
  6228
  6229     12  AM-CAL-TABLE                      PIC XX.
  6230     12  AM-LF-DEVIATION                   PIC XXX.
  6231     12  AM-AH-DEVIATION                   PIC XXX.
  6232     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6233     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6234     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 113
* EL131.cbl
  6235     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6236     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6237     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6238
  6239     12  AM-USER-FIELDS.
  6240         16  AM-FLD-1                      PIC XX.
  6241         16  AM-FLD-2                      PIC XX.
  6242         16  AM-FLD-3                      PIC XX.
  6243         16  AM-FLD-4                      PIC XX.
  6244         16  AM-FLD-5                      PIC XX.
  6245
  6246     12  AM-1ST-PROD-DATE.
  6247         16  AM-1ST-PROD-YR                PIC XX.
  6248         16  AM-1ST-PROD-MO                PIC XX.
  6249         16  AM-1ST-PROD-DA                PIC XX.
  6250     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6251     12  AM-CERTS-PURGED-DATE.
  6252         16  AM-PUR-YR                     PIC XX.
  6253         16  AM-PUR-MO                     PIC XX.
  6254         16  AM-PUR-DA                     PIC XX.
  6255     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6256     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6257     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6258     12  AM-INACTIVE-DATE.
  6259         16  AM-INA-MO                     PIC 99.
  6260         16  AM-INA-DA                     PIC 99.
  6261         16  AM-INA-YR                     PIC 99.
  6262     12  AM-AR-HI-CERT-DATE                PIC XX.
  6263
  6264     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6265     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6266
  6267     12  AM-OB-PAYMENT-MODE                PIC X.
  6268         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6269         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6270         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6271         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6272
  6273     12  AM-AH-ONLY-INDICATOR              PIC X.
  6274         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6275         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6276
  6277     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6278
  6279     12  AM-OVER-SHORT.
  6280         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6281         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6282
  6283     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6284     12  AM-DCC-CLP-STATE                  PIC XX.
  6285
  6286     12  AM-RECALC-COMM                    PIC X.
  6287     12  AM-RECALC-REIN                    PIC X.
  6288
  6289     12  AM-REI-TABLE                      PIC XXX.
  6290     12  AM-REI-ET-LF                      PIC X.
  6291     12  AM-REI-ET-AH                      PIC X.
  6292     12  AM-REI-PE-LF                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 114
* EL131.cbl
  6293     12  AM-REI-PE-AH                      PIC X.
  6294     12  AM-REI-PRT-ST                     PIC X.
  6295     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6296     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6297     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6298     12  AM-REI-GROUP-A                    PIC X(6).
  6299     12  AM-REI-MORT                       PIC X(4).
  6300     12  AM-REI-PRT-OW                     PIC X.
  6301     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6302     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6303     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6304     12  AM-REI-GROUP-B                    PIC X(6).
  6305
  6306     12  AM-TRUST-TYPE                     PIC X(2).
  6307
  6308     12  AM-EMPLOYER-STMT-USED             PIC X.
  6309     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6310
  6311     12  AM-STD-AH-TYPE                    PIC XX.
  6312     12  AM-EARN-METHODS.
  6313         16  AM-EARN-METHOD-R              PIC X.
  6314             88 AM-REF-RL-R78                 VALUE 'R'.
  6315             88 AM-REF-RL-PR                  VALUE 'P'.
  6316             88 AM-REF-RL-MEAN                VALUE 'M'.
  6317             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6318         16  AM-EARN-METHOD-L              PIC X.
  6319             88 AM-REF-LL-R78                 VALUE 'R'.
  6320             88 AM-REF-LL-PR                  VALUE 'P'.
  6321             88 AM-REF-LL-MEAN                VALUE 'M'.
  6322             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6323         16  AM-EARN-METHOD-A              PIC X.
  6324             88 AM-REF-AH-R78                 VALUE 'R'.
  6325             88 AM-REF-AH-PR                  VALUE 'P'.
  6326             88 AM-REF-AH-MEAN                VALUE 'M'.
  6327             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6328             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6329             88 AM-REF-AH-NET                 VALUE 'N'.
  6330
  6331     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6332     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6333     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6334
  6335     12  AM-RET-Y-N                        PIC X.
  6336     12  AM-RET-P-E                        PIC X.
  6337     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6338     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6339     12  AM-RET-GRP                        PIC X(6).
  6340     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6341         16  AM-POOL-PRIME                 PIC XXX.
  6342         16  AM-POOL-SUB                   PIC XXX.
  6343     12  AM-RETRO-EARNINGS.
  6344         16  AM-RET-EARN-R                 PIC X.
  6345         16  AM-RET-EARN-L                 PIC X.
  6346         16  AM-RET-EARN-A                 PIC X.
  6347     12  AM-RET-ST-TAX-USE                 PIC X.
  6348         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6349         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6350     12  AM-RETRO-BEG-EARNINGS.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 115
* EL131.cbl
  6351         16  AM-RET-BEG-EARN-R             PIC X.
  6352         16  AM-RET-BEG-EARN-L             PIC X.
  6353         16  AM-RET-BEG-EARN-A             PIC X.
  6354     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6355     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6356
  6357     12  AM-USER-SELECT-OPTIONS.
  6358         16  AM-USER-SELECT-1              PIC X(10).
  6359         16  AM-USER-SELECT-2              PIC X(10).
  6360         16  AM-USER-SELECT-3              PIC X(10).
  6361         16  AM-USER-SELECT-4              PIC X(10).
  6362         16  AM-USER-SELECT-5              PIC X(10).
  6363
  6364     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6365
  6366     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6367
  6368     12  AM-RPT045A-SWITCH                 PIC X.
  6369         88  RPT045A-OFF                   VALUE 'N'.
  6370
  6371     12  AM-INSURANCE-LIMITS.
  6372         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6373         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6374
  6375     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6376         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6377
  6378     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6379         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6380         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6381
  6382     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6383
  6384     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6385     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6386     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6387     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6388     12  AM-DCC-UEF-STATE                  PIC XX.
  6389     12  FILLER                            PIC XXX.
  6390     12  AM-REPORT-CODE-3                  PIC X(10).
  6391*    12  FILLER                            PIC X(22).
  6392
  6393     12  AM-RESERVE-DATE.
  6394         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6395         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6396         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6397
  6398     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6399     12  AM-NOTIFICATION-TYPES.
  6400         16  AM-NOTIF-OF-LETTERS           PIC X.
  6401         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6402         16  AM-NOTIF-OF-REPORTS           PIC X.
  6403         16  AM-NOTIF-OF-STATUS            PIC X.
  6404
  6405     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6406         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6407         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6408         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 116
* EL131.cbl
  6409         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6410
  6411     12  AM-BENEFIT-CONTROLS.
  6412         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6413             20  AM-BENEFIT-CODE           PIC XX.
  6414             20  AM-BENEFIT-TYPE           PIC X.
  6415             20  AM-BENEFIT-REVISION       PIC XXX.
  6416             20  AM-BENEFIT-REM-TERM       PIC X.
  6417             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6418             20  FILLER                    PIC XX.
  6419         16  FILLER                        PIC X(80).
  6420
  6421     12  AM-TRANSFER-DATA.
  6422         16  AM-TRANSFERRED-FROM.
  6423             20  AM-TRNFROM-CARRIER        PIC X.
  6424             20  AM-TRNFROM-GROUPING.
  6425                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6426                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6427             20  AM-TRNFROM-STATE          PIC XX.
  6428             20  AM-TRNFROM-ACCOUNT.
  6429                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6430                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6431             20  AM-TRNFROM-DTE            PIC XX.
  6432         16  AM-TRANSFERRED-TO.
  6433             20  AM-TRNTO-CARRIER          PIC X.
  6434             20  AM-TRNTO-GROUPING.
  6435                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6436                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6437             20  AM-TRNTO-STATE            PIC XX.
  6438             20  AM-TRNTO-ACCOUNT.
  6439                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6440                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6441             20  AM-TRNTO-DTE              PIC XX.
  6442         16  FILLER                        PIC X(10).
  6443
  6444     12  AM-SAVED-REMIT-TO                 PIC 99.
  6445
  6446     12  AM-COMM-STRUCTURE-SAVED.
  6447         16  AM-DEFN-1-SAVED.
  6448             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6449                 24  AM-AGT-SV             PIC X(10).
  6450                 24  AM-COM-TYP-SV         PIC X.
  6451                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6452                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6453                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6454                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6455                 24  FILLER                PIC X.
  6456                 24  AM-GL-CODES-SV        PIC X.
  6457                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6458                 24  FILLER                PIC X.
  6459         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6460             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6461                 24  FILLER                PIC X(11).
  6462                 24  AM-L-COMA-SV          PIC XXX.
  6463                 24  AM-J-COMA-SV          PIC XXX.
  6464                 24  AM-A-COMA-SV          PIC XXX.
  6465                 24  FILLER                PIC X(6).
  6466
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 117
* EL131.cbl
  6467     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6468         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6469            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6470            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6471            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6472
  6473     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6474     12  FILLER                            PIC X(120).
  6475
  6476     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6477         16  AM-CONTROL-NAME               PIC X(30).
  6478         16  AM-EXECUTIVE-ONE.
  6479             20  AM-EXEC1-NAME             PIC X(15).
  6480             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6481                                                          COMP-3.
  6482             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6483                                                          COMP-3.
  6484         16  AM-EXECUTIVE-TWO.
  6485             20  AM-EXEC2-NAME             PIC X(15).
  6486             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6487                                                          COMP-3.
  6488             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6489                                                          COMP-3.
  6490
  6491     12  AM-RETRO-ADDITIONAL-DATA.
  6492         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6493         16  AM-RETRO-PREM-P-E             PIC X.
  6494         16  AM-RETRO-CLMS-P-I             PIC X.
  6495         16  AM-RETRO-RET-BRACKET-LF.
  6496             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6497                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6498                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6499             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6500                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6501                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6502             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6503                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6504                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6505         16  AM-RETRO-RET-BRACKET-AH.
  6506             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6507                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6508                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6509                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6510             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6511                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6512                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6513             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6514                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6515                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6516
  6517     12  AM-COMMENTS.
  6518         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6519
  6520     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6521         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6522         16  AM-FLI-BILLING-CODE           PIC X.
  6523         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6524         16  AM-FLI-UNITED-IDENT           PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 118
* EL131.cbl
  6525         16  AM-FLI-INTEREST-LOST-DATA.
  6526             20  AM-FLI-BANK-NO            PIC X(5).
  6527             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6528             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6529             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6530         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6531             20  AM-FLI-AGT                PIC X(9).
  6532             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6533             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6534         16  FILLER                        PIC X(102).
  6535
  6536     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6537         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6538             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6539             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6540             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6541             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6542             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6543         16  FILLER                          PIC X(10).
  6544******************************************************************
  6545
  6546*                                COPY ELCCHKQ.
  6547******************************************************************
  6548*                                                                *
  6549*                                                                *
  6550*                            ELCCHKQ.                            *
  6551*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6552*                            VMOD=2.007                          *
  6553*                                                                *
  6554*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6555*                                                                *
  6556*   FILE TYPE = VSAM,KSDS                                        *
  6557*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6558*                                                                *
  6559*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6560*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6561*                                                                *
  6562*   LOG = YES                                                    *
  6563*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6564******************************************************************
  6565 01  CHECK-QUE.
  6566     12  CQ-RECORD-ID                PIC XX.
  6567         88  VALID-CQ-ID         VALUE 'CQ'.
  6568
  6569     12  CQ-CONTROL-PRIMARY.
  6570         16  CQ-COMPANY-CD           PIC X.
  6571         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6572         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6573
  6574     12  CQ-CONTROL-BY-PAYEE.
  6575         16  CQ-CONTROL-BY-NUMBER.
  6576             20  CQ-COMPANY-CD-A1     PIC X.
  6577             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6578         16  CQ-PAYEE-CARRIER        PIC X.
  6579         16  CQ-PAYEE-GROUPING       PIC X(6).
  6580         16  CQ-PAYEE-STATE          PIC XX.
  6581         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6582         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 119
* EL131.cbl
  6583
  6584     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6585         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6586         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6587         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6588         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6589         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6590         16  FILLER                  PIC X(3).
  6591
  6592     12  CQ-ENTRY-TYPE               PIC X.
  6593             88  CHECK-ON-QUE           VALUE 'Q'.
  6594             88  ALIGNMENT-CHECK        VALUE 'A'.
  6595             88  SPOILED-CHECK          VALUE 'S'.
  6596             88  PAYMENT-ABORTED        VALUE 'X'.
  6597
  6598     12  CQ-CLAIM-MAST-CNTL.
  6599         16  CQ-CARRIER              PIC X.
  6600         16  CQ-CLAIM-NO             PIC X(7).
  6601         16  CQ-CERT-NO.
  6602             20  CQ-CERT-PRIME       PIC X(10).
  6603             20  CQ-CERT-SFX         PIC X.
  6604         16  CQ-CLAIM-TYPE           PIC X.
  6605             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6606             88  CQ-AH-CLAIM            VALUE 'A'.
  6607         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6608             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6609             88  CQ-O-B-COVERAGE        VALUE '2'.
  6610             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6611
  6612     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6613     12  CQ-CHECK-NUMBER             PIC X(7).
  6614     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6615     12  CQ-PAYMENT-TYPE             PIC X.
  6616             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6617             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6618             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6619             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6620             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6621             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6622             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6623             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6624     12  CQ-VOID-INDICATOR           PIC X.
  6625             88  CHECK-IS-STOPPED          VALUE 'S'.
  6626             88  CHECK-IS-VOID             VALUE 'V'.
  6627     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6628     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6629     12  CQ-CHECK-BY-USER            PIC X(4).
  6630     12  CQ-PRE-NUMBERING-SW         PIC X.
  6631       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6632       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6633
  6634     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6635     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6636     12  CQ-LEDGER-FLAG              PIC X(01).
  6637     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6638     12  CQ-LAST-UPDATED-DT          PIC XX.
  6639     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6640     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 120
* EL131.cbl
  6641
  6642     12  FILLER                      PIC X(04).
  6643
  6644******************************************************************
  6645
  6646*                                COPY ELCARCH.
  6647******************************************************************
  6648*                                                                *
  6649*                            ELCARCH.                            *
  6650*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6651*                            VMOD=2.007                          *
  6652*                                                                *
  6653*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6654*                                                                *
  6655*   FILE TYPE = VSAM,KSDS                                        *
  6656*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6657*                                                                *
  6658*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6659*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6660*                                                                *
  6661*   LOG = NO                                                     *
  6662*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6663*                                                                *
  6664*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6665******************************************************************
  6666 01  LETTER-ARCHIVE.
  6667     12  LA-RECORD-ID                PIC XX.
  6668         88  VALID-LA-ID                VALUE 'LA'.
  6669
  6670     12  LA-CONTROL-PRIMARY.
  6671         16  LA-COMPANY-CD           PIC X.
  6672         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6673         16  LA-RECORD-TYPE          PIC X.
  6674             88  LA-HEADER-DATA         VALUE '1'.
  6675             88  LA-ADDRESS-DATA        VALUE '2'.
  6676             88  LA-TEXT-DATA           VALUE '3'.
  6677             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6678         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6679
  6680     12  LA-CONTROL-BY-TYPE.
  6681         16  LA-COMPANY-CD-A1        PIC X.
  6682         16  LA-RECORD-TYPE-A1       PIC X.
  6683         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6684         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6685
  6686     12  LA-TEXT-RECORD.
  6687         16  LA-SKIP-CONTROL         PIC XX.
  6688             88  NO-LINES-SKIPPED       VALUE SPACES.
  6689             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6690         16  LA-TEXT-LINE            PIC X(70).
  6691
  6692     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6693         16  FILLER                  PIC XX.
  6694         16  LA-ADDRESS-LINE         PIC X(30).
  6695         16  FILLER                  PIC X(40).
  6696
  6697     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6698         16  FILLER                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 121
* EL131.cbl
  6699         16  LA-CARRIER              PIC X.
  6700         16  LA-CLAIM-NO             PIC X(7).
  6701         16  LA-CERT-NO.
  6702             20  LA-CERT-PRIME       PIC X(10).
  6703             20  LA-CERT-SFX         PIC X.
  6704         16  LA-NO-OF-COPIES         PIC S9.
  6705         16  LA-RESEND-DATE          PIC XX.
  6706         16  LA-PROCESSOR-CD         PIC X(4).
  6707         16  LA-CREATION-DT          PIC XX.
  6708         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6709         16  LA-RESEND-PRINT-DATE    PIC XX.
  6710         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6711         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6712*
  6713* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6714*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6715*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6716*   I        20  LA-DMD-RES-ST           PIC XX.
  6717*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6718*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6719*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6720*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6721*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6722*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6723*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6724*   I        20  LA-DMD-UND-CODE         PIC XX.
  6725*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6726*   V    16  FILLER                  PIC X(15).
  6727* -----
  6728*
  6729* REINSERTED  CSO  MODS
  6730*
  6731         16  FILLER.
  6732             20  FILLER                  PIC X(29).
  6733             20  LA-CSO-LETTER-STATUS    PIC X.
  6734                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6735                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6736                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6737             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6738             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6739*
  6740
  6741     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6742         16  FILLER                  PIC XX.
  6743         16  LA4-CARRIER             PIC X.
  6744         16  LA4-CLAIM-NO            PIC X(7).
  6745         16  LA4-CERT-NO.
  6746             20  LA4-CERT-PRIME      PIC X(10).
  6747             20  LA4-CERT-SFX        PIC X.
  6748         16  LA4-NO-OF-COPIES        PIC S9.
  6749         16  LA4-RESEND-DATE         PIC XX.
  6750         16  LA4-PROCESSOR-CD        PIC X(4).
  6751         16  LA4-CREATION-DT         PIC XX.
  6752         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6753         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6754         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6755         16  LA4-FORM-TYPE           PIC X.
  6756             88  LA4-INITIAL-FORM    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 122
* EL131.cbl
  6757             88  LA4-PROGRESS-FORM   VALUE '2'.
  6758         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6759         16  LA4-STATE               PIC X(02).
  6760         16  FILLER                  PIC X(31).
  6761******************************************************************
  6762
  6763*                                COPY ELCBENE.
  6764******************************************************************
  6765*                                                                *
  6766*                            ELCBENE.                            *
  6767*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6768*                            VMOD=2.006                          *
  6769*                                                                *
  6770*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6771*                                                                *
  6772*   FILE TYPE = VSAM,KSDS                                        *
  6773*   RECORD SIZE = 500   RECFORM = FIX                            *
  6774*                                                                *
  6775*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6776*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6777*                                                                *
  6778*   LOG = YES                                                    *
  6779*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6780*                                                                *
  6781*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6782******************************************************************
  6783
  6784 01  BENEFICIARY-MASTER.
  6785     12  BE-RECORD-ID                PIC XX.
  6786         88  VALID-BE-ID                VALUE 'BE'.
  6787
  6788     12  BE-CONTROL-PRIMARY.
  6789         16  BE-COMPANY-CD           PIC X.
  6790         16  BE-RECORD-TYPE          PIC X.
  6791             88  BENEFICIARY-RECORD  VALUE 'B'.
  6792             88  ADJUSTOR-RECORD     VALUE 'A'.
  6793         16  BE-BENEFICIARY          PIC X(10).
  6794     12  BE-CONTROL-BY-NAME.
  6795         16  BE-COMPANY-CD-A1        PIC X.
  6796         16  BE-RECORD-TYPE-A1       PIC X.
  6797         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6798         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6799
  6800     12  BE-LAST-MAINT-DT            PIC XX.
  6801     12  BE-LAST-MAINT-BY            PIC X(4).
  6802     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6803
  6804     12  BE-ADDRESS-DATA.
  6805         16  BE-MAIL-TO-NAME         PIC X(30).
  6806         16  BE-ADDRESS-LINE-1       PIC X(30).
  6807         16  BE-ADDRESS-LINE-2       PIC X(30).
  6808         16  BE-ADDRESS-LINE-3       PIC X(30).
  6809         16  BE-CITY-STATE.
  6810             20  BE-CITY             PIC X(28).
  6811             20  BE-STATE            PIC XX.
  6812         16  BE-ZIP-CODE.
  6813             20  BE-ZIP-PRIME.
  6814                 24  BE-ZIP-1ST      PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 123
* EL131.cbl
  6815                     88  BE-CANADIAN-POST-CODE
  6816                                         VALUE 'A' THRU 'Z'.
  6817                 24  FILLER          PIC X(4).
  6818             20  BE-ZIP-PLUS4        PIC X(4).
  6819         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6820             20  BE-CAN-POSTAL-1     PIC XXX.
  6821             20  BE-CAN-POSTAL-2     PIC XXX.
  6822             20  FILLER              PIC XXX.
  6823         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6824         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6825
  6826******************************************************************
  6827*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6828*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6829******************************************************************
  6830     12  BE-CARRIER                  PIC X.
  6831
  6832     12  BE-ADDRESS-DATA2.
  6833         16  BE-MAIL-TO-NAME2        PIC X(30).
  6834         16  BE-ADDRESS-LINE-12      PIC X(30).
  6835         16  BE-ADDRESS-LINE-22      PIC X(30).
  6836         16  BE-ADDRESS-LINE-32      PIC X(30).
  6837         16  BE-CITY-STATE2.
  6838             20  BE-CITY2            PIC X(28).
  6839             20  BE-STATE2           PIC XX.
  6840         16  BE-ZIP-CODE2.
  6841             20  BE-ZIP-PRIME2.
  6842                 24  BE-ZIP-1ST2     PIC X.
  6843                     88  BE-CANADIAN-POST-CODE2
  6844                                         VALUE 'A' THRU 'Z'.
  6845                 24  FILLER          PIC X(4).
  6846             20  BE-ZIP-PLUS42       PIC X(4).
  6847         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6848             20  BE-CAN-POSTAL-12    PIC XXX.
  6849             20  BE-CAN-POSTAL-22    PIC XXX.
  6850             20  FILLER              PIC XXX.
  6851         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6852         16  BE-BILLING-STMT-DATA.
  6853             20  BE-BSR              PIC X.
  6854                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6855                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6856             20  BE-BSR-FROM         PIC X(30).
  6857             20  BE-BSR-DEPT         PIC X(30).
  6858             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6859             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6860             20  BE-OUTPUT-TYPE      PIC X.
  6861                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6862                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6863
  6864     12  FILLER                      PIC X(28).
  6865******************************************************************
  6866
  6867*                                COPY ELCDAR.
  6868******************************************************************
  6869*                                                                *
  6870*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6871*   FILE TYPE = VSAM,KSDS                                        *
  6872*   RECORD SIZE = 25   RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 124
* EL131.cbl
  6873*   BASE CLUSTER = DLYACTV                                       *
  6874*   LOG = YES                                                    *
  6875*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6876*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6877*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6878*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6879*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6880*               BY PROGRAM "LGINFCE".                            *
  6881*                                                                *
  6882******************************************************************
  6883 01  DAILY-ACTIVITY-RECORD.
  6884     05  DA-KEY.
  6885         10  DA-COMP-CD          PIC X.
  6886         10  DA-CARRIER          PIC X.
  6887         10  DA-CLAIM-NO         PIC X(7).
  6888         10  DA-CERT-NO.
  6889             15  DA-CERT-PRIME   PIC X(10).
  6890             15  DA-CERT-SFX     PIC X.
  6891     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6892     05  DA-RECORD-TYPE          PIC X.
  6893     05  FILLER                  PIC X(2).
  6894******************************************************************
  6895
  6896*                                COPY ELCALPH.
  6897******************************************************************
  6898*                                                                *
  6899*                            ELCALPH.                            *
  6900*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6901*                            VMOD=2.003                          *
  6902*                                                                *
  6903*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  6904*                                                                *
  6905*   FILE TYPE = VSAM,KSDS                                        *
  6906*   RECORD SIZE = 128  RECFORM = FIXED                           *
  6907*                                                                *
  6908*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  6909*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  6910*                                                                *
  6911*   LOG = YES                                                    *
  6912*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6913*                                                                *
  6914*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  6915******************************************************************
  6916
  6917 01  ALPHA-INDEX.
  6918     12  AI-RECORD-ID                         PIC XX.
  6919         88  VALID-AI-ID                  VALUE 'AI'.
  6920     12  AI-CONTROL-PRIMARY.
  6921         16  AI-COMPANY-CD                     PIC X.
  6922         16  AI-SOURCE                         PIC X.
  6923             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  6924             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  6925         16  AI-NAME.
  6926             20  AI-LAST-NAME                  PIC X(15).
  6927             20  AI-FIRST-NAME.
  6928                 24  AI-FIRST-INITIAL          PIC X.
  6929                 24  FILLER                    PIC X(11).
  6930             20  AI-MIDDLE-INIT                PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 125
* EL131.cbl
  6931         16  AI-DATE                           PIC X(8).
  6932         16  AI-TIME                           PIC S9(07) COMP-3.
  6933
  6934     12  AI-CONTROL-BY-ADMIN-KEY.
  6935         16  AI-CM-COMPANY-CD                  PIC X.
  6936         16  AI-CM-SOURCE                      PIC X.
  6937         16  AI-CM-CARRIER                     PIC X.
  6938         16  AI-CM-GROUPING.
  6939             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  6940             20  AI-CM-GROUPING-PRIME          PIC X(3).
  6941         16  AI-CM-STATE                       PIC XX.
  6942         16  AI-CM-PRODUCER.
  6943             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  6944             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  6945         16  AI-CM-CERT-EFF-DT                 PIC XX.
  6946         16  AI-CM-CERTIFICATE-NUMBER.
  6947             20  AI-CM-CERT-PRIME              PIC X(10).
  6948             20  AI-CM-CERT-SFX                PIC X.
  6949         16  AI-CM-DATE                        PIC X(8).
  6950         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  6951         16  FILLER                            PIC X(11).
  6952
  6953     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  6954         AI-CONTROL-BY-ADMIN-KEY.
  6955         16  AI-CL-COMPANY-CD                  PIC X.
  6956         16  AI-CL-SOURCE                      PIC X.
  6957         16  AI-CL-CARRIER                     PIC X.
  6958         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  6959         16  AI-CL-CERTIFICATE-NUMBER.
  6960             20  AI-CL-CERT-PRIME              PIC X(10).
  6961             20  AI-CL-CERT-SFX                PIC X.
  6962         16  AI-CL-DATE                        PIC X(8).
  6963         16  AI-CL-INCURRED-DATE               PIC XX.
  6964         16  AI-CL-CLOSE-DATE                  PIC XX.
  6965         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  6966         16  AI-CREDIT-CARD-NUMBER.
  6967             20  AI-CCN.
  6968                 24  AI-CCN-PREFIX             PIC X(4).
  6969                 24  AI-CCN-PRIME              PIC X(12).
  6970             20  AI-CCN-FILLER                 PIC X(4).
  6971
  6972     12  AI-MAINT-INFO.
  6973         16  AI-LAST-MAINT-BY                  PIC X(4).
  6974         16  AI-LAST-MAINT-DT                  PIC XX.
  6975         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6976
  6977     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  6978
  6979     12  FILLER                                PIC X(15).
  6980
  6981
  6982*                                COPY ERCDMDNT.
  6983******************************************************************
  6984*                                                                *
  6985*                            ERCDMDNT                            *
  6986*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6987*                            VMOD=2.005                          *
  6988*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 126
* EL131.cbl
  6989*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  6990*                                                                *
  6991*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  6992*                                                                *
  6993*        FILE TYPE= VSAM,KSDS                                    *
  6994*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6995*                                                                *
  6996*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6997*                                                                *
  6998*        LOG = YES                                               *
  6999*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7000*                                                                *
  7001******************************************************************
  7002
  7003 01  CERTIFICATE-NOTE.
  7004     12  CN-RECORD-ID                     PIC  XX.
  7005         88  VALID-CN-ID                      VALUE 'CN'.
  7006
  7007     12  CN-CONTROL-PRIMARY.
  7008         16  CN-COMPANY-CD                PIC X.
  7009         16  CN-CERT-KEY.
  7010             20  CN-CARRIER               PIC X.
  7011             20  CN-GROUPING.
  7012                 24  CN-GROUPING-PREFIX   PIC XXX.
  7013                 24  CN-GROUPING-PRIME    PIC XXX.
  7014             20  CN-STATE                 PIC XX.
  7015             20  CN-ACCOUNT.
  7016                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7017                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7018             20  CN-CERT-EFF-DT           PIC XX.
  7019             20  CN-CERT-NO.
  7020                 24  CN-CERT-PRIME        PIC X(10).
  7021                 24  CN-CERT-SFX          PIC X.
  7022
  7023     12  CN-BILLING-START-LINE-NO         PIC 99.
  7024     12  CN-BILLING-END-LINE-NO           PIC 99.
  7025
  7026     12  CN-LINES.
  7027         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7028
  7029     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7030         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7031         16  CN-CSI-GENERAL-DATA-AREA.
  7032             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7033
  7034         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7035             CN-CSI-GENERAL-DATA-AREA.
  7036             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7037             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7038             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7039             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7040             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7041             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7042             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7043             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7044             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7045             20  FILLER                       PIC XX.
  7046             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 127
* EL131.cbl
  7047             20  FILLER                       PIC X(38).
  7048
  7049         16  CN-CSI-PRODUCT-DATA-AREA.
  7050             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7051
  7052         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7053             CN-CSI-PRODUCT-DATA-AREA.
  7054             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7055             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7056             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7057             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7058             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7059             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7060             20  FILLER                   PIC XX.
  7061             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7062             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7063             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7064             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7065             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7066             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7067             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7068             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7069             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7070             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7071             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7072             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7073             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7074             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7075             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7076             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7077             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7078             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7079             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7080             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7081             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7082             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7083             20  FILLER                   PIC X(25).
  7084
  7085         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7086             CN-CSI-CREDIT-CARD-DATA.
  7087             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7088             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7089             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7090             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7091             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7092             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7093             20  FILLER                   PIC XX.
  7094             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7095             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7096             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7097             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7098             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7099             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7100             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7101             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7102             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7103             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7104             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 128
* EL131.cbl
  7105             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7106             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7107             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7108             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7109             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7110             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7111             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7112             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7113             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7114             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7115             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7116             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7117             20  FILLER                   PIC X(17).
  7118
  7119         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7120             CN-CSI-FAMILY-LEAVE-DATA.
  7121             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7122             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7123             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7124             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7125             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7126             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7127             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7128             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7129             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7130             20  CN-CSI-SL-INT-ON-PROCEEDS
  7131                                          PIC S9(5)V99  COMP-3.
  7132             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7133             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7134             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7135             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7136             20  CN-CSI-SL-POLICY-BENEFITS
  7137                                          PIC S9(5)V99  COMP-3.
  7138             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7139             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7140             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7141             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7142             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7143             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7144             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7145             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7146             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7147             20  CN-CSI-SL-STATE-NOT      PIC X.
  7148             20  FILLER                   PIC XX.
  7149
  7150         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7151             CN-CSI-SENIOR-LIFE-DATA.
  7152             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7153             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7154             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7155                                          PIC S9(5)V99  COMP-3.
  7156             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7157             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7158             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7159             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7160             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7161             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7162             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 129
* EL131.cbl
  7163             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7164             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7165             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7166             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7167             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7168             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7169             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7170             20  CN-CSI-PP-REPAIR         PIC X.
  7171             20  CN-CSI-PP-REPLACE        PIC X.
  7172             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7173             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7174             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7175             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7176             20  FILLER                   PIC X(5).
  7177
  7178         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7179             CN-CSI-PURCH-PROP-DATA.
  7180             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7181             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7182             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7183             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7184             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7185             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7186             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7187             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7188             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7189             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7190             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7191             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7192             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7193             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7194             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7195             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7196             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7197             20  CN-CSI-EW-REPLACE        PIC X.
  7198             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7199             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7200             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7201             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7202             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7203             20  FILLER                   PIC X(4).
  7204
  7205     12  CN-LAST-MAINT-DT                 PIC XX.
  7206     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7207     12  CN-LAST-MAINT-USER               PIC X(4).
  7208     12  FILLER                           PIC X(6).
  7209
  7210******************************************************************
  7211
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 130
* EL131.cbl
  7213 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7214                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7215                          CONTROL-FILE ACTIVITY-QUE
  7216                          ACCOUNT-MASTER CHECK-QUE
  7217                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7218                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7219                          CERTIFICATE-NOTE.
  7220 0000-DFHEXIT SECTION.
  7221     MOVE '9#                    $   ' TO DFHEIV0.
  7222     MOVE 'EL131' TO DFHEIV1.
  7223     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7224
  7225     IF EIBCALEN = ZERO
  7226         GO TO 8800-UNAUTHORIZED-ACCESS.
  7227
  7228     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7229     MOVE '5'                    TO DC-OPTION-CODE.
  7230     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7231     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7232     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7233     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7234
  7235     IF SAVE-DATE-YY GREATER 70
  7236         MOVE 19                 TO SAVE-DATE-CC
  7237      ELSE
  7238         MOVE 20                 TO SAVE-DATE-CC.
  7239
  7240
  7241* EXEC CICS HANDLE CONDITION
  7242*        PGMIDERR (8820-XCTL-ERROR)
  7243*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7244*        ERROR    (9990-ABEND)
  7245*    END-EXEC.
  7246*    MOVE '"$LI.                 ! " #00007236' TO DFHEIV0
  7247     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7248     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7249     MOVE X'2220233030303037323336' TO DFHEIV0(25:11)
  7250     CALL 'kxdfhei1' USING DFHEIV0
  7251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7252
  7253
  7254     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7255     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7256     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7257
  7258     INITIALIZE    EDIT-WORK-AREA.
  7259     MOVE '/'                    TO WORK-SLASH.
  7260     MOVE SPACES                 TO ERROR-SWITCHES.
  7261
  7262     MOVE TRAN-ID                TO TRANS-ID.
  7263     MOVE EIBTRMID               TO PI-TERM.
  7264     MOVE MAP-ID                 TO PI-QUAL.
  7265
  7266     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7267
  7268     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7269         MOVE LOW-VALUES         TO EL131AO
  7270         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 131
* EL131.cbl
  7271         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7272         MOVE -1                 TO MAINTL
  7273         GO TO 8110-SEND-DATA.
  7274
  7275     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7276         MOVE LOW-VALUES         TO EL131AO
  7277         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7278         MOVE 'X'                TO PI-RETURN-CD-1
  7279         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7280         MOVE -1                 TO MAINTL
  7281         GO TO 8100-SEND-MAP.
  7282
  7283     IF EIBAID = DFHCLEAR
  7284         GO TO 8200-RETURN-PRIOR.
  7285
  7286     IF PI-PROCESSOR-ID = 'LGXX'
  7287         NEXT SENTENCE
  7288     ELSE
  7289
  7290* EXEC CICS READQ TS
  7291*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7292*            INTO    (SECURITY-CONTROL)
  7293*            LENGTH  (SC-COMM-LENGTH)
  7294*            ITEM    (SC-ITEM)
  7295*        END-EXEC
  7296*    MOVE '*$II   L              ''   #00007277' TO DFHEIV0
  7297     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7298     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7299     MOVE X'2020233030303037323737' TO DFHEIV0(25:11)
  7300     CALL 'kxdfhei1' USING DFHEIV0,
  7301           PI-SECURITY-TEMP-STORE-ID,
  7302           SECURITY-CONTROL,
  7303           SC-COMM-LENGTH,
  7304           SC-ITEM,
  7305           DFHEIV99,
  7306           DFHEIV99
  7307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7308         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7309         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7310         IF NOT DISPLAY-CAP
  7311             MOVE 'READ'               TO  SM-READ
  7312             PERFORM 9995-SECURITY-VIOLATION
  7313             MOVE ER-0070              TO  EMI-ERROR
  7314             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7315             GO TO 8100-SEND-MAP.
  7316
  7317
  7318* EXEC CICS RECEIVE
  7319*        MAP    ('EL131A')
  7320*        MAPSET ('EL131S')
  7321*    END-EXEC.
  7322     MOVE 'EL131A' TO DFHEIV1
  7323     MOVE 'EL131S' TO DFHEIV2
  7324*    MOVE '8"T                   ''   #00007292' TO DFHEIV0
  7325     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7326     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7327     MOVE X'2020233030303037323932' TO DFHEIV0(25:11)
  7328     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 132
* EL131.cbl
  7329           DFHEIV1,
  7330           EL131AI,
  7331           DFHEIV99,
  7332           DFHEIV2,
  7333           DFHEIV99,
  7334           DFHEIV99
  7335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7336
  7337
  7338     IF PFKEYL GREATER THAN ZERO
  7339         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7340
  7341     IF SCREEN-ERROR
  7342         MOVE ER-0004 TO EMI-ERROR
  7343         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7344         MOVE -1 TO MAINTL
  7345         GO TO 8110-SEND-DATA.
  7346
  7347     IF EIBAID = DFHPF3
  7348         GO TO 8500-TRLR-MNT.
  7349
  7350     IF EIBAID = DFHPF4
  7351         GO TO 8600-ADDR-MNT.
  7352
  7353     IF EIBAID = DFHPF5
  7354         GO TO 8700-CERT-MNT.
  7355
  7356     IF PI-COMPANY-ID = 'DMD'
  7357       IF EIBAID = DFHPF6
  7358         GO TO 8750-DMD-CLM-FIX.
  7359
  7360     IF EIBAID = DFHPF7
  7361         GO TO 4000-FORCE-ERRORS.
  7362
  7363     IF EIBAID = DFHPF12
  7364         GO TO 8300-GET-HELP.
  7365
  7366     IF EIBAID = DFHPF23
  7367         GO TO 8810-PF23-ENTERED.
  7368
  7369     IF EIBAID = DFHPF24
  7370         GO TO 8400-RETURN-MASTER.
  7371
  7372     IF EIBAID NOT = DFHENTER
  7373         MOVE ER-0029            TO EMI-ERROR
  7374         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7375         MOVE -1                 TO MAINTL
  7376         GO TO 8110-SEND-DATA.
  7377
  7378     IF PI-RETURN-CD-1 =  'X'
  7379         MOVE ER-0311            TO EMI-ERROR
  7380         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7381         MOVE -1                 TO MAINTL
  7382         GO TO 8110-SEND-DATA.
  7383
  7384     IF MAINTI = 'A'
  7385         GO TO 0500-ADD-ALPHA-ONLY.
  7386
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 133
* EL131.cbl
  7387     IF MAINTI = 'N'
  7388         GO TO 0600-CHANGE-NAME.
  7389
  7390     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7391
  7392     IF SCREEN-ERROR
  7393         GO TO 8110-SEND-DATA.
  7394
  7395     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7396         MOVE ER-0276            TO EMI-ERROR
  7397         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7398         MOVE -1                 TO MAINTL
  7399         GO TO 8110-SEND-DATA.
  7400
  7401     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7402
  7403     IF SCREEN-ERROR
  7404         GO TO 8110-SEND-DATA.
  7405
  7406     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7407
  7408     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7409
  7410     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7411         GO TO 8110-SEND-DATA.
  7412
  7413     IF EMI-FATAL-CTR GREATER THAN ZERO
  7414         GO TO 8110-SEND-DATA.
  7415
  7416     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7417
  7418     IF WS-OPEN-CLOSE-SW = 'Y'
  7419         IF PI-LETTER-SW = 'Y'
  7420             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7421             MOVE 'T'            TO  CNTL-REC-TYPE
  7422             MOVE SPACES         TO  CNTL-PROC-ID
  7423             MOVE +0             TO  CNTL-SEQ-NO
  7424
  7425* EXEC CICS READ
  7426*                DATASET   (CNTL-FILE-ID)
  7427*                RIDFLD    (CNTL-KEY)
  7428*                SET       (ADDRESS OF CONTROL-FILE)
  7429*            END-EXEC
  7430*    MOVE '&"S        E          (   #00007383' TO DFHEIV0
  7431     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7432     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7433     MOVE X'2020233030303037333833' TO DFHEIV0(25:11)
  7434     CALL 'kxdfhei1' USING DFHEIV0,
  7435           CNTL-FILE-ID,
  7436           DFHEIV20,
  7437           DFHEIV99,
  7438           CNTL-KEY,
  7439           DFHEIV99,
  7440           DFHEIV99,
  7441           DFHEIV99
  7442     SET ADDRESS OF CONTROL-FILE TO
  7443         DFHEIV20
  7444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 134
* EL131.cbl
  7445             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7446
  7447     MOVE ER-0000                TO EMI-ERROR.
  7448     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7449
  7450     MOVE SPACE                  TO MAINTO.
  7451     MOVE -1                     TO MAINTL.
  7452     GO TO 8100-SEND-MAP.
  7453
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 135
* EL131.cbl
  7455 0100-UPDATE-PI.
  7456     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7457         GO TO 0110-UPDATE-UP.
  7458
  7459     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7460     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7461     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7462     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7463     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7464     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7465     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7466     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7467     GO TO 0120-UPDATE-PI-EXIT.
  7468
  7469 0110-UPDATE-UP.
  7470     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7471     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7472     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7473     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7474     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7475     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7476     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7477     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7478
  7479
  7480* EXEC CICS HANDLE CONDITION
  7481*         QIDERR    (0130-TS-ERROR)
  7482*         ITEMERR   (0130-TS-ERROR)
  7483*    END-EXEC.
  7484*    MOVE '"$N<                  ! # #00007422' TO DFHEIV0
  7485     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7486     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7487     MOVE X'2320233030303037343232' TO DFHEIV0(25:11)
  7488     CALL 'kxdfhei1' USING DFHEIV0
  7489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7490
  7491
  7492
  7493* EXEC CICS READQ TS
  7494*         QUEUE    (PI-KEY)
  7495*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7496*         LENGTH   (PI-COMM-LENGTH)
  7497*    END-EXEC.
  7498*    MOVE '*$I    L              ''   #00007427' TO DFHEIV0
  7499     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7500     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7501     MOVE X'2020233030303037343237' TO DFHEIV0(25:11)
  7502     CALL 'kxdfhei1' USING DFHEIV0,
  7503           PI-KEY,
  7504           PROGRAM-INTERFACE-BLOCK,
  7505           PI-COMM-LENGTH,
  7506           DFHEIV99,
  7507           DFHEIV99,
  7508           DFHEIV99
  7509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7510
  7511
  7512
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 136
* EL131.cbl
  7513* EXEC CICS DELETEQ TS
  7514*         QUEUE    (PI-KEY)
  7515*    END-EXEC.
  7516*    MOVE '*&                    #   #00007433' TO DFHEIV0
  7517     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7518     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7519     MOVE X'2020233030303037343333' TO DFHEIV0(25:11)
  7520     CALL 'kxdfhei1' USING DFHEIV0,
  7521           PI-KEY,
  7522           DFHEIV99
  7523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7524
  7525
  7526 0120-UPDATE-PI-EXIT.
  7527     EXIT.
  7528
  7529 0130-TS-ERROR.
  7530     MOVE LOW-VALUES             TO EL131AO.
  7531     MOVE ER-0192                TO EMI-ERROR.
  7532
  7533     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7534
  7535     GO TO 8100-SEND-MAP.
  7536
  7537 0200-TRANS-PF.
  7538     IF EIBAID NOT = DFHENTER
  7539         MOVE 'X'                TO ERROR-SWITCH
  7540         GO TO 0210-EXIT.
  7541
  7542     IF PFKEYI NOT NUMERIC
  7543         MOVE 'X'                TO ERROR-SWITCH
  7544         GO TO 0210-EXIT.
  7545
  7546     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7547
  7548     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7549         MOVE 'X' TO ERROR-SWITCH
  7550         GO TO 0210-EXIT.
  7551
  7552     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7553
  7554 0210-EXIT.
  7555     EXIT.
  7556
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 137
* EL131.cbl
  7558 0500-ADD-ALPHA-ONLY.
  7559******************************************************************
  7560*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7561*    RECORD.                                                     *
  7562******************************************************************
  7563
  7564     IF MLNAMEL = +0 AND
  7565        MFNAMEL = +0 AND
  7566        MMINITL = +0
  7567         MOVE ER-0797                TO  EMI-ERROR
  7568         MOVE -1                     TO  MAINTL
  7569         MOVE AL-UABON               TO  MAINTA
  7570         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7571         GO TO 8110-SEND-DATA.
  7572
  7573     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7574     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7575     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7576     MOVE PI-CERT-NO                 TO  CERT-NO.
  7577
  7578
  7579* EXEC CICS READ
  7580*        DATASET   (CLMS-FILE-ID)
  7581*        RIDFLD    (MSTR-KEY)
  7582*        SET       (ADDRESS OF CLAIM-MASTER)
  7583*    END-EXEC.
  7584*    MOVE '&"S        E          (   #00007489' TO DFHEIV0
  7585     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7586     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7587     MOVE X'2020233030303037343839' TO DFHEIV0(25:11)
  7588     CALL 'kxdfhei1' USING DFHEIV0,
  7589           CLMS-FILE-ID,
  7590           DFHEIV20,
  7591           DFHEIV99,
  7592           MSTR-KEY,
  7593           DFHEIV99,
  7594           DFHEIV99,
  7595           DFHEIV99
  7596     SET ADDRESS OF CLAIM-MASTER TO
  7597         DFHEIV20
  7598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7599
  7600
  7601
  7602* EXEC CICS GETMAIN
  7603*        SET       (ADDRESS OF ALPHA-INDEX)
  7604*        LENGTH    (ALPH-LENGTH)
  7605*        INITIMG   (GETMAIN-SPACE)
  7606*    END-EXEC.
  7607*    MOVE ',"IL                  $   #00007495' TO DFHEIV0
  7608     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7609     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7610     MOVE X'2020233030303037343935' TO DFHEIV0(25:11)
  7611     CALL 'kxdfhei1' USING DFHEIV0,
  7612           DFHEIV20,
  7613           ALPH-LENGTH,
  7614           GETMAIN-SPACE
  7615     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 138
* EL131.cbl
  7616         DFHEIV20
  7617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7618
  7619
  7620     MOVE 'AI'                       TO  AI-RECORD-ID.
  7621     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7622                                         AI-CL-COMPANY-CD.
  7623     MOVE 'C'                        TO  AI-SOURCE
  7624                                         AI-CL-SOURCE.
  7625
  7626     IF MLNAMEL IS GREATER THAN +0
  7627         MOVE MLNAMEI                TO  AI-LAST-NAME
  7628     ELSE
  7629         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7630
  7631     IF MFNAMEL IS GREATER THAN +0
  7632         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7633     ELSE
  7634         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7635
  7636     IF MMINITL IS GREATER THAN +0
  7637         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7638     ELSE
  7639         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7640
  7641     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7642     MOVE '5'                        TO  DC-OPTION-CODE.
  7643     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7644     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7645     IF BUILD-YEAR IS GREATER THAN 50
  7646         MOVE '19'                   TO  WS-ALPHA-YY-1
  7647         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7648         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7649         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7650     ELSE
  7651         MOVE '20'                   TO  WS-ALPHA-YY-1
  7652         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7653         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7654         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7655
  7656     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7657                                         AI-CL-DATE.
  7658
  7659     MOVE EIBTIME                    TO  AI-TIME
  7660                                         AI-CL-TIME.
  7661
  7662     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7663     MOVE 'C'                        TO  AI-CL-SOURCE.
  7664     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7665     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7666     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7667     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7668     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7669
  7670     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7671     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7672     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7673
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 139
* EL131.cbl
  7674
  7675* EXEC CICS WRITE
  7676*        DATASET   (ALPH-FILE-ID)
  7677*        RIDFLD    (AI-CONTROL-PRIMARY)
  7678*        FROM      (ALPHA-INDEX)
  7679*    END-EXEC.
  7680     MOVE LENGTH OF
  7681      ALPHA-INDEX
  7682       TO DFHEIV11
  7683*    MOVE '&$ L                  ''   #00007555' TO DFHEIV0
  7684     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7685     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7686     MOVE X'2020233030303037353535' TO DFHEIV0(25:11)
  7687     CALL 'kxdfhei1' USING DFHEIV0,
  7688           ALPH-FILE-ID,
  7689           ALPHA-INDEX,
  7690           DFHEIV11,
  7691           AI-CONTROL-PRIMARY,
  7692           DFHEIV99,
  7693           DFHEIV99
  7694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7695
  7696
  7697     MOVE LOW-VALUES                 TO  EL131AO.
  7698     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7699     MOVE ER-0000                    TO  EMI-ERROR.
  7700     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7701     MOVE -1                         TO  MAINTL.
  7702     GO TO 8100-SEND-MAP.
  7703
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 140
* EL131.cbl
  7705 0600-CHANGE-NAME.
  7706******************************************************************
  7707*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7708*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7709******************************************************************
  7710
  7711     IF MLNAMEL = +0 AND
  7712        MFNAMEL = +0 AND
  7713        MMINITL = +0
  7714         MOVE ER-0276                TO  EMI-ERROR
  7715         MOVE -1                     TO  MAINTL
  7716         MOVE AL-UABON               TO  MAINTA
  7717         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7718         GO TO 8110-SEND-DATA.
  7719
  7720     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7721     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7722     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7723     MOVE PI-CERT-NO                 TO  CERT-NO.
  7724
  7725
  7726* EXEC CICS READ
  7727*        DATASET   (CLMS-FILE-ID)
  7728*        RIDFLD    (MSTR-KEY)
  7729*        SET       (ADDRESS OF CLAIM-MASTER)
  7730*    END-EXEC.
  7731*    MOVE '&"S        E          (   #00007589' TO DFHEIV0
  7732     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7733     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7734     MOVE X'2020233030303037353839' TO DFHEIV0(25:11)
  7735     CALL 'kxdfhei1' USING DFHEIV0,
  7736           CLMS-FILE-ID,
  7737           DFHEIV20,
  7738           DFHEIV99,
  7739           MSTR-KEY,
  7740           DFHEIV99,
  7741           DFHEIV99,
  7742           DFHEIV99
  7743     SET ADDRESS OF CLAIM-MASTER TO
  7744         DFHEIV20
  7745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7746
  7747
  7748
  7749* EXEC CICS GETMAIN
  7750*        SET       (ADDRESS OF ALPHA-INDEX)
  7751*        LENGTH    (ALPH-LENGTH)
  7752*        INITIMG   (GETMAIN-SPACE)
  7753*    END-EXEC.
  7754*    MOVE ',"IL                  $   #00007595' TO DFHEIV0
  7755     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7756     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7757     MOVE X'2020233030303037353935' TO DFHEIV0(25:11)
  7758     CALL 'kxdfhei1' USING DFHEIV0,
  7759           DFHEIV20,
  7760           ALPH-LENGTH,
  7761           GETMAIN-SPACE
  7762     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 141
* EL131.cbl
  7763         DFHEIV20
  7764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7765
  7766
  7767     MOVE 'AI'                       TO  AI-RECORD-ID.
  7768     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7769                                         AI-CL-COMPANY-CD.
  7770     MOVE 'C'                        TO  AI-SOURCE
  7771                                         AI-CL-SOURCE.
  7772
  7773     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  7774     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  7775     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  7776
  7777     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7778     MOVE '5'                        TO  DC-OPTION-CODE.
  7779     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7780     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7781     IF BUILD-YEAR IS GREATER THAN 50
  7782         MOVE '19'                   TO  WS-ALPHA-YY-1
  7783         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7784         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7785         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7786     ELSE
  7787         MOVE '20'                   TO  WS-ALPHA-YY-1
  7788         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7789         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7790         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7791
  7792     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7793                                         AI-CL-DATE.
  7794
  7795     MOVE EIBTIME                    TO  AI-TIME
  7796                                         AI-CL-TIME.
  7797
  7798     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7799     MOVE 'C'                        TO  AI-CL-SOURCE.
  7800     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7801     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7802     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7803     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7804     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7805
  7806     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7807     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7808     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7809
  7810     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7811         MOVE 'Y'                TO CL-YESNOSW
  7812     END-IF.
  7813
  7814
  7815* EXEC CICS WRITE
  7816*        DATASET   (ALPH-FILE-ID)
  7817*        RIDFLD    (AI-CONTROL-PRIMARY)
  7818*        FROM      (ALPHA-INDEX)
  7819*    END-EXEC.
  7820     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 142
* EL131.cbl
  7821      ALPHA-INDEX
  7822       TO DFHEIV11
  7823*    MOVE '&$ L                  ''   #00007648' TO DFHEIV0
  7824     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7825     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7826     MOVE X'2020233030303037363438' TO DFHEIV0(25:11)
  7827     CALL 'kxdfhei1' USING DFHEIV0,
  7828           ALPH-FILE-ID,
  7829           ALPHA-INDEX,
  7830           DFHEIV11,
  7831           AI-CONTROL-PRIMARY,
  7832           DFHEIV99,
  7833           DFHEIV99
  7834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7835
  7836
  7837
  7838* EXEC CICS READ
  7839*        DATASET   (CLMS-FILE-ID)
  7840*        RIDFLD    (MSTR-KEY)
  7841*        SET       (ADDRESS OF CLAIM-MASTER)
  7842*        UPDATE
  7843*    END-EXEC.
  7844*    MOVE '&"S        EU         (   #00007654' TO DFHEIV0
  7845     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7846     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7847     MOVE X'2020233030303037363534' TO DFHEIV0(25:11)
  7848     CALL 'kxdfhei1' USING DFHEIV0,
  7849           CLMS-FILE-ID,
  7850           DFHEIV20,
  7851           DFHEIV99,
  7852           MSTR-KEY,
  7853           DFHEIV99,
  7854           DFHEIV99,
  7855           DFHEIV99
  7856     SET ADDRESS OF CLAIM-MASTER TO
  7857         DFHEIV20
  7858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7859
  7860
  7861     if (cl-priority-cd = '8')
  7862        and (pi-processor-id not = 'PEMA'and 'JMS '
  7863             AND 'AMWA' AND 'KMSB')
  7864        MOVE ER-8003             TO EMI-ERROR
  7865        PERFORM 9900-ERROR-FORMAT
  7866                                 THRU 9900-EXIT
  7867        MOVE -1                  TO MAINTL
  7868        GO TO 8110-SEND-DATA
  7869     end-if
  7870
  7871     IF MLNAMEL IS GREATER THAN +0
  7872         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  7873
  7874     IF MFNAMEL IS GREATER THAN +0
  7875         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  7876
  7877     IF MMINITL IS GREATER THAN +0
  7878         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 143
* EL131.cbl
  7879
  7880     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  7881     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  7882     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  7883     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  7884
  7885     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7886         MOVE 'Y'                TO CL-YESNOSW
  7887     END-IF.
  7888
  7889
  7890* EXEC CICS HANDLE CONDITION
  7891*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  7892*    END-EXEC.
  7893*    MOVE '"$$                   ! $ #00007689' TO DFHEIV0
  7894     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  7895     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7896     MOVE X'2420233030303037363839' TO DFHEIV0(25:11)
  7897     CALL 'kxdfhei1' USING DFHEIV0
  7898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7899
  7900
  7901
  7902* EXEC CICS REWRITE
  7903*        DATASET   (CLMS-FILE-ID)
  7904*        FROM      (CLAIM-MASTER)
  7905*    END-EXEC.
  7906     MOVE LENGTH OF
  7907      CLAIM-MASTER
  7908       TO DFHEIV11
  7909*    MOVE '&& L                  %   #00007693' TO DFHEIV0
  7910     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7911     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7912     MOVE X'2020233030303037363933' TO DFHEIV0(25:11)
  7913     CALL 'kxdfhei1' USING DFHEIV0,
  7914           CLMS-FILE-ID,
  7915           CLAIM-MASTER,
  7916           DFHEIV11,
  7917           DFHEIV99
  7918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7919
  7920
  7921 0600-CONTINUE-NAME-UPDATE.
  7922
  7923     MOVE LOW-VALUES                 TO  EL131AO.
  7924     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7925     MOVE ER-0000                    TO  EMI-ERROR.
  7926     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7927     MOVE -1                         TO  MAINTL.
  7928     GO TO 8100-SEND-MAP.
  7929
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 144
* EL131.cbl
  7931 1000-EDIT-SCREEN.
  7932
  7933     MOVE MAINTI                 TO CHECK-MAINT.
  7934
  7935     IF NOT VALID-OPTIONS
  7936         MOVE 'X'                TO ERROR-SWITCH
  7937         MOVE -1                 TO MAINTL
  7938         MOVE AL-UABON           TO MAINTA
  7939         MOVE ER-0023            TO EMI-ERROR
  7940         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7941         GO TO 1010-EXIT.
  7942
  7943     IF NOT MODIFY-CAP
  7944         MOVE 'UPDATE'           TO  SM-READ
  7945         PERFORM 9995-SECURITY-VIOLATION
  7946         MOVE ER-0070               TO  EMI-ERROR
  7947         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7948         GO TO 8100-SEND-MAP.
  7949
  7950     IF DELETE-CLAIM
  7951         MOVE AL-UANON TO MAINTA
  7952         GO TO 1010-EXIT.
  7953
  7954     MOVE AL-UANON               TO MAINTA.
  7955
  7956     IF CCNOI GREATER THAN LOW-VALUES
  7957         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  7958
  7959     IF PI-COMPANY-ID = 'CSL'
  7960        CONTINUE
  7961     ELSE
  7962        IF TYPEL > ZERO
  7963           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  7964              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  7965                    PI-LIFE-OVERRIDE-L1))
  7966                       OR
  7967              ((PI-COMPANY-ID = 'DCC')
  7968              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  7969                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G'))
  7970              MOVE AL-UANON      TO TYPEA
  7971              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  7972           ELSE
  7973              MOVE ER-0199       TO EMI-ERROR
  7974              PERFORM 9900-ERROR-FORMAT
  7975                                 THRU 9900-EXIT
  7976              MOVE AL-UABON      TO TYPEA
  7977              MOVE -1            TO TYPEL
  7978              MOVE 'X'           TO ERROR-SWITCH
  7979           END-IF
  7980        ELSE
  7981           MOVE AL-UANOF         TO TYPEA
  7982        END-IF
  7983     END-IF
  7984     IF STATUSI GREATER THAN LOW-VALUES
  7985         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  7986             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  7987             MOVE AL-UANON       TO STATUSA
  7988             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 145
* EL131.cbl
  7989             MOVE 'Y'            TO DLYACTV-SW
  7990         ELSE
  7991             MOVE ER-0333        TO EMI-ERROR
  7992             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7993             MOVE AL-UABON       TO STATUSA
  7994             MOVE -1             TO STATUSL
  7995             MOVE 'X'            TO ERROR-SWITCH
  7996         END-IF
  7997     ELSE
  7998         MOVE SPACE              TO TRLR-SWITCH
  7999         MOVE 'N'                TO DLYACTV-SW
  8000         MOVE AL-UANOF           TO STATUSA.
  8001
  8002     IF PROCI GREATER THAN LOW-VALUES
  8003         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8004     ELSE
  8005         MOVE AL-UANOF TO PROCA.
  8006
  8007     IF SEXI GREATER THAN LOW-VALUES
  8008         IF SEXI = 'F' OR 'M'
  8009             MOVE AL-UANON       TO SEXA
  8010             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8011           ELSE
  8012             MOVE ER-0219        TO EMI-ERROR
  8013             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8014             MOVE AL-UABON       TO SEXA
  8015             MOVE -1             TO SEXL
  8016             MOVE 'X'            TO ERROR-SWITCH
  8017       ELSE
  8018         MOVE AL-UANOF           TO SEXA.
  8019
  8020     IF BIRTHL = +0
  8021         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8022         MOVE AL-UANOF           TO  BIRTHA
  8023         GO TO 1000-CONTINUE-EDITS.
  8024
  8025     IF BIRTHI = SPACES
  8026         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8027         MOVE 'X'                TO  UPDATE-SWITCH
  8028                                     MSTR-SWITCH
  8029         GO TO 1000-CONTINUE-EDITS.
  8030
  8031     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8032     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8033     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8034     MOVE '4'                    TO  DC-OPTION-CODE.
  8035     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8036     IF DATE-CONVERSION-ERROR
  8037         MOVE ER-0220            TO  EMI-ERROR
  8038         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8039         MOVE AL-UABON           TO  BIRTHA
  8040         MOVE -1                 TO  BIRTHL
  8041         MOVE 'X'                TO  ERROR-SWITCH
  8042         GO TO 1000-CONTINUE-EDITS.
  8043
  8044******************************************************************
  8045**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8046**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 146
* EL131.cbl
  8047**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8048******************************************************************
  8049     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8050         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8051         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8052         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8053         MOVE '4'                TO  DC-OPTION-CODE
  8054         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8055         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8056                                     DC-ELAPSED-DAYS
  8057         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8058         IF DATE-CONVERSION-ERROR
  8059             MOVE ER-0220        TO  EMI-ERROR
  8060             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8061             MOVE AL-UABON       TO  BIRTHA
  8062             MOVE -1             TO  BIRTHL
  8063             MOVE 'X'            TO  ERROR-SWITCH
  8064             GO TO 1000-CONTINUE-EDITS.
  8065
  8066     MOVE AL-UANON               TO  BIRTHA.
  8067     MOVE 'X'                    TO  UPDATE-SWITCH
  8068                                     MSTR-SWITCH.
  8069     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8070     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8071     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8072
  8073 1000-CONTINUE-EDITS.
  8074
  8075     IF SOCIALI GREATER THAN LOW-VALUES
  8076         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8077         IF WS-SOC-SEC-NO NUMERIC AND
  8078           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8079             NEXT SENTENCE
  8080         ELSE
  8081            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8082               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8083               WS-SSN-DASH2 = '-'
  8084                 NEXT SENTENCE
  8085            ELSE
  8086                 MOVE ER-0887        TO  EMI-ERROR
  8087                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8088                 MOVE AL-UABON       TO  SOCIALA
  8089                 MOVE -1             TO  SOCIALL
  8090                 MOVE 'X'            TO  ERROR-SWITCH
  8091            END-IF
  8092        END-IF
  8093     END-IF.
  8094
  8095     IF SOCIALI GREATER THAN LOW-VALUES
  8096         MOVE AL-UANON           TO SOCIALA
  8097         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8098     ELSE
  8099         MOVE AL-UANOF           TO SOCIALA.
  8100
  8101     IF OCCI GREATER THAN LOW-VALUES
  8102         MOVE AL-UANON           TO OCCA
  8103         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8104     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 147
* EL131.cbl
  8105         MOVE AL-UANOF           TO OCCA.
  8106
  8107     IF BENEL NOT GREATER THAN ZERO
  8108            GO TO 1005-CONTINUE-EDITS.
  8109
  8110     IF BENEI = SPACES
  8111        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8112           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8113           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8114           IF AUTO-PAY-TO-BENE = 'Y'
  8115               MOVE ER-1773      TO  EMI-ERROR
  8116               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8117               MOVE 'X'          TO ERROR-SWITCH
  8118               MOVE AL-UABON     TO BENEA
  8119               MOVE -1           TO BENEL
  8120           ELSE
  8121               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8122           END-IF
  8123        ELSE
  8124           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8125        END-IF
  8126        GO TO 1005-CONTINUE-EDITS.
  8127
  8128
  8129* EXEC CICS HANDLE CONDITION
  8130*        NOTFND (1004-BENE-NOT-FOUND)
  8131*    END-EXEC.
  8132*    MOVE '"$I                   ! % #00007905' TO DFHEIV0
  8133     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8134     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8135     MOVE X'2520233030303037393035' TO DFHEIV0(25:11)
  8136     CALL 'kxdfhei1' USING DFHEIV0
  8137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8138
  8139
  8140     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8141     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8142     MOVE BENEI                  TO  WS-ELBENE-ID.
  8143
  8144
  8145* EXEC CICS READ
  8146*        DATASET ('ELBENE')
  8147*        RIDFLD  (WS-ELBENE-KEY)
  8148*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8149*    END-EXEC.
  8150     MOVE 'ELBENE' TO DFHEIV1
  8151*    MOVE '&"S        E          (   #00007913' TO DFHEIV0
  8152     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8153     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8154     MOVE X'2020233030303037393133' TO DFHEIV0(25:11)
  8155     CALL 'kxdfhei1' USING DFHEIV0,
  8156           DFHEIV1,
  8157           DFHEIV20,
  8158           DFHEIV99,
  8159           WS-ELBENE-KEY,
  8160           DFHEIV99,
  8161           DFHEIV99,
  8162           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 148
* EL131.cbl
  8163     SET ADDRESS OF BENEFICIARY-MASTER TO
  8164         DFHEIV20
  8165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8166
  8167
  8168     MOVE AL-UANON               TO  BENEA.
  8169     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8170
  8171     GO TO 1005-CONTINUE-EDITS.
  8172
  8173 1004-BENE-NOT-FOUND.
  8174     MOVE ER-0565                TO  EMI-ERROR.
  8175
  8176     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8177     MOVE 'X'                    TO ERROR-SWITCH.
  8178     MOVE AL-UABON               TO BENEA.
  8179     MOVE -1                     TO BENEL.
  8180
  8181 1005-CONTINUE-EDITS.
  8182
  8183     IF DIAGI GREATER THAN LOW-VALUES
  8184         MOVE AL-UANON           TO DIAGA
  8185         MOVE 'X'                TO UPDATE-SWITCH
  8186                                    NINETY-TRLR-SWITCH
  8187     ELSE
  8188         MOVE AL-UANOF           TO DIAGA.
  8189
  8190     IF CAUSEI GREATER THAN LOW-VALUES
  8191         MOVE AL-UANON           TO CAUSEA
  8192         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8193     ELSE
  8194         MOVE AL-UANOF           TO CAUSEA.
  8195
  8196     IF ENDL GREATER THAN ZERO
  8197         MOVE LOW-VALUES         TO HOLD-END
  8198         IF ENDI = SPACES
  8199             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8200         ELSE
  8201             MOVE ENDI           TO DEEDIT-DATE-INPUT
  8202
  8203* EXEC CICS BIF DEEDIT
  8204*                FIELD    (DEEDIT-DATE-INPUT)
  8205*                LENGTH   (DATE-LENGTH)
  8206*            END-EXEC
  8207*    MOVE '@"L                   #   #00007953' TO DFHEIV0
  8208     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8209     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8210     MOVE X'2020233030303037393533' TO DFHEIV0(25:11)
  8211     CALL 'kxdfhei1' USING DFHEIV0,
  8212           DEEDIT-DATE-INPUT,
  8213           DATE-LENGTH
  8214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8215             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8216             MOVE '4'            TO DC-OPTION-CODE
  8217             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8218             IF NOT DATE-CONVERSION-ERROR
  8219                 MOVE DC-BIN-DATE-1      TO HOLD-END
  8220                 MOVE AL-UANON   TO ENDA
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 149
* EL131.cbl
  8221                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8222                 MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8223             ELSE
  8224                 MOVE ER-0224    TO EMI-ERROR
  8225                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8226                 MOVE AL-UABON   TO ENDA
  8227                 MOVE -1         TO ENDL
  8228                 MOVE 'X'        TO ERROR-SWITCH
  8229       ELSE
  8230           MOVE AL-UANOF         TO ENDA.
  8231
  8232     IF INCL GREATER THAN ZERO
  8233         MOVE LOW-VALUES         TO HOLD-INCUR
  8234         IF INCI = SPACES
  8235             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8236         ELSE
  8237             MOVE INCI           TO DEEDIT-DATE-INPUT
  8238
  8239* EXEC CICS BIF DEEDIT
  8240*                FIELD    (DEEDIT-DATE-INPUT)
  8241*                LENGTH   (DATE-LENGTH)
  8242*            END-EXEC
  8243*    MOVE '@"L                   #   #00007980' TO DFHEIV0
  8244     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8245     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8246     MOVE X'2020233030303037393830' TO DFHEIV0(25:11)
  8247     CALL 'kxdfhei1' USING DFHEIV0,
  8248           DEEDIT-DATE-INPUT,
  8249           DATE-LENGTH
  8250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8251             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8252             MOVE '4'            TO DC-OPTION-CODE
  8253             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8254             IF NOT DATE-CONVERSION-ERROR
  8255                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8256                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8257                 MOVE AL-UANON           TO INCA
  8258                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8259             ELSE
  8260                 MOVE ER-0222    TO EMI-ERROR
  8261                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8262                 MOVE AL-UABON   TO INCA
  8263                 MOVE -1         TO INCL
  8264                 MOVE 'X'        TO ERROR-SWITCH
  8265       ELSE
  8266           IF PI-NO-PMTS = ZEROS
  8267               MOVE AL-UANOF     TO INCA.
  8268
  8269     IF REPL GREATER THAN ZERO
  8270         MOVE LOW-VALUES         TO HOLD-REPORTED
  8271         IF REPI = SPACES
  8272             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8273         ELSE
  8274             MOVE REPI           TO DEEDIT-DATE-INPUT
  8275
  8276* EXEC CICS BIF DEEDIT
  8277*                FIELD    (DEEDIT-DATE-INPUT)
  8278*                LENGTH   (DATE-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 150
* EL131.cbl
  8279*            END-EXEC
  8280*    MOVE '@"L                   #   #00008008' TO DFHEIV0
  8281     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8282     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8283     MOVE X'2020233030303038303038' TO DFHEIV0(25:11)
  8284     CALL 'kxdfhei1' USING DFHEIV0,
  8285           DEEDIT-DATE-INPUT,
  8286           DATE-LENGTH
  8287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8288             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8289             MOVE '4'            TO DC-OPTION-CODE
  8290             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8291             IF NOT DATE-CONVERSION-ERROR
  8292                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8293                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8294                 MOVE AL-UANON   TO REPA
  8295                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8296             ELSE
  8297                 MOVE ER-0223    TO EMI-ERROR
  8298                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8299                 MOVE AL-UABON   TO REPA
  8300                 MOVE -1         TO REPL
  8301                 MOVE 'X'        TO ERROR-SWITCH
  8302       ELSE
  8303         MOVE AL-UANOF TO REPA.
  8304
  8305     IF PDTHRUI GREATER THAN LOW-VALUES
  8306        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8307        IF PDTHRUI = SPACES
  8308           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8309        ELSE
  8310           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8311
  8312* EXEC CICS BIF DEEDIT
  8313*               FIELD    (DEEDIT-DATE-INPUT)
  8314*               LENGTH   (DATE-LENGTH)
  8315*          END-EXEC
  8316*    MOVE '@"L                   #   #00008035' TO DFHEIV0
  8317     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8318     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8319     MOVE X'2020233030303038303335' TO DFHEIV0(25:11)
  8320     CALL 'kxdfhei1' USING DFHEIV0,
  8321           DEEDIT-DATE-INPUT,
  8322           DATE-LENGTH
  8323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8324           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8325           MOVE '4'            TO DC-OPTION-CODE
  8326           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8327           IF NOT DATE-CONVERSION-ERROR
  8328              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8329              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8330              MOVE AL-UANON   TO PDTHRUA
  8331              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8332              IF PI-USES-PAID-TO
  8333                 MOVE '6'            TO DC-OPTION-CODE
  8334                 MOVE -1             TO DC-ELAPSED-DAYS
  8335                 MOVE +0             TO DC-ELAPSED-MONTHS
  8336                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 151
* EL131.cbl
  8337                 IF NO-CONVERSION-ERROR
  8338                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8339                 ELSE
  8340                    NEXT SENTENCE
  8341              ELSE
  8342                 NEXT SENTENCE
  8343           ELSE
  8344              MOVE ER-0475    TO EMI-ERROR
  8345              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8346              MOVE AL-UABON   TO PDTHRUA
  8347              MOVE -1         TO PDTHRUL
  8348              MOVE 'X'        TO ERROR-SWITCH
  8349     ELSE
  8350        IF MODIFY-CAP
  8351           MOVE AL-UANOF        TO PDTHRUA.
  8352
  8353     IF PDAMTL GREATER THAN +0
  8354         MOVE ZEROS              TO HOLD-PDAMT
  8355
  8356* EXEC CICS BIF DEEDIT
  8357*            FIELD    (PDAMTI)
  8358*            LENGTH   (9)
  8359*        END-EXEC
  8360     MOVE 9
  8361       TO DFHEIV11
  8362*    MOVE '@"L                   #   #00008070' TO DFHEIV0
  8363     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8364     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8365     MOVE X'2020233030303038303730' TO DFHEIV0(25:11)
  8366     CALL 'kxdfhei1' USING DFHEIV0,
  8367           PDAMTI,
  8368           DFHEIV11
  8369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8370         IF PDAMTI NUMERIC
  8371             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8372             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8373             MOVE AL-UNNON       TO PDAMTA
  8374         ELSE
  8375             MOVE ER-0547        TO EMI-ERROR
  8376             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8377             MOVE AL-UNBON       TO PDAMTA
  8378             MOVE -1             TO PDAMTL
  8379             MOVE 'X'            TO ERROR-SWITCH
  8380     ELSE
  8381         IF MODIFY-CAP
  8382            MOVE AL-UNNOF        TO PDAMTA.
  8383
  8384     IF NODAYSI GREATER THAN LOW-VALUES
  8385         MOVE ZEROS              TO HOLD-NODAYS
  8386
  8387* EXEC CICS BIF DEEDIT
  8388*            FIELD (NODAYSI)
  8389*            LENGTH (5)
  8390*        END-EXEC
  8391     MOVE 5
  8392       TO DFHEIV11
  8393*    MOVE '@"L                   #   #00008090' TO DFHEIV0
  8394     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 152
* EL131.cbl
  8395     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8396     MOVE X'2020233030303038303930' TO DFHEIV0(25:11)
  8397     CALL 'kxdfhei1' USING DFHEIV0,
  8398           NODAYSI,
  8399           DFHEIV11
  8400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8401         IF NODAYSI NUMERIC
  8402             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8403             MOVE AL-UNNON       TO NODAYSA
  8404             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8405         ELSE
  8406             MOVE ER-0491        TO EMI-ERROR
  8407             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8408             MOVE AL-UNBON       TO NODAYSA
  8409             MOVE -1             TO NODAYSL
  8410             MOVE 'X'            TO ERROR-SWITCH
  8411     ELSE
  8412         IF MODIFY-CAP
  8413            MOVE AL-UNNOF        TO NODAYSA.
  8414
  8415     IF NOPMTSI GREATER THAN LOW-VALUES
  8416         MOVE ZEROS              TO HOLD-NOPMTS
  8417
  8418* EXEC CICS BIF DEEDIT
  8419*            FIELD (NOPMTSI)
  8420*            LENGTH (4)
  8421*        END-EXEC
  8422     MOVE 4
  8423       TO DFHEIV11
  8424*    MOVE '@"L                   #   #00008110' TO DFHEIV0
  8425     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8426     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8427     MOVE X'2020233030303038313130' TO DFHEIV0(25:11)
  8428     CALL 'kxdfhei1' USING DFHEIV0,
  8429           NOPMTSI,
  8430           DFHEIV11
  8431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8432         IF NOPMTSI NUMERIC
  8433             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8434             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8435             MOVE AL-UNNON       TO NOPMTSA
  8436           ELSE
  8437             MOVE ER-0548        TO EMI-ERROR
  8438             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8439             MOVE AL-UNBON       TO NOPMTSA
  8440             MOVE -1             TO NOPMTSL
  8441             MOVE 'X'            TO ERROR-SWITCH
  8442       ELSE
  8443         IF MODIFY-CAP
  8444            MOVE AL-UNNOF        TO NOPMTSA.
  8445
  8446     IF FORMTYPI GREATER THAN LOW-VALUES
  8447         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8448             MOVE AL-UANON       TO FORMTYPA
  8449             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8450           ELSE
  8451             MOVE ER-7650        TO EMI-ERROR
  8452             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 153
* EL131.cbl
  8453             MOVE AL-UABON       TO FORMTYPA
  8454             MOVE -1             TO FORMTYPL
  8455             MOVE 'X'            TO ERROR-SWITCH
  8456       ELSE
  8457         MOVE AL-UANOF           TO FORMTYPA.
  8458
  8459     IF PRICDL GREATER THAN ZERO
  8460         IF (PRICDI = ' ') OR
  8461            (PRICDI GREATER THAN ZERO   AND
  8462             PRICDI NOT GREATER THAN '9')
  8463             MOVE AL-UANON       TO PRICDA
  8464             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8465         ELSE
  8466             MOVE ER-0274        TO EMI-ERROR
  8467             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8468             MOVE AL-UABON       TO PRICDA
  8469             MOVE -1             TO PRICDL
  8470             MOVE 'X'            TO ERROR-SWITCH
  8471     ELSE
  8472         MOVE AL-UANOF TO PRICDA.
  8473
  8474     IF PI-COMPANY-ID = 'DMD'
  8475     IF PRICDL GREATER THAN ZERO
  8476       IF SYSTEM-MODIFY-CAP  OR
  8477          PI-PROCESSOR-ID = 'LGXX'
  8478             NEXT SENTENCE
  8479           ELSE
  8480            IF CL-PRIORITY-CD = '9'  OR
  8481               PRICDI         = '9'
  8482                  MOVE ER-0938        TO EMI-ERROR
  8483                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8484                  MOVE AL-UABON       TO PRICDA
  8485                  MOVE -1             TO PRICDL
  8486                  MOVE 'X'            TO ERROR-SWITCH.
  8487
  8488     IF FILETOL GREATER THAN ZERO
  8489         MOVE AL-UANON           TO FILETOA
  8490         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8491     ELSE
  8492         MOVE AL-UANOF TO FILETOA.
  8493
  8494     IF SUPVL GREATER THAN ZERO
  8495         IF SUPVI = 'Y' OR 'N' OR SPACE
  8496             MOVE AL-UANON       TO SUPVA
  8497             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8498         ELSE
  8499             MOVE ER-0230        TO EMI-ERROR
  8500             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8501             MOVE AL-UABON       TO SUPVA
  8502             MOVE -1             TO SUPVL
  8503             MOVE 'X'            TO ERROR-SWITCH
  8504     ELSE
  8505         MOVE AL-UANOF           TO SUPVA.
  8506
  8507     IF MLNAMEL GREATER THAN ZERO
  8508         IF MLNAMEI GREATER THAN SPACES
  8509            MOVE AL-UANON        TO MLNAMEA
  8510            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 154
* EL131.cbl
  8511                                     MSTR-KEY-SWITCH
  8512         ELSE
  8513            MOVE ER-0236         TO EMI-ERROR
  8514            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8515            MOVE AL-UABON        TO MLNAMEA
  8516            MOVE -1              TO MLNAMEL
  8517            MOVE 'X'             TO ERROR-SWITCH
  8518     ELSE
  8519         MOVE AL-UANOF           TO MLNAMEA.
  8520
  8521     IF MFNAMEI GREATER THAN LOW-VALUES
  8522         MOVE AL-UANON           TO MFNAMEA
  8523         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8524     ELSE
  8525         MOVE AL-UANOF           TO MFNAMEA.
  8526
  8527     IF MMINITI GREATER THAN LOW-VALUES
  8528         MOVE AL-UANON           TO MMINITA
  8529         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8530     ELSE
  8531         MOVE AL-UANOF           TO MMINITA.
  8532
  8533     IF CRTLNMEI GREATER THAN LOW-VALUES
  8534         IF CRTLNMEI NOT = SPACES
  8535            MOVE AL-UANON        TO CRTLNMEA
  8536            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8537                                     CERT-KEY-SWITCH
  8538        ELSE
  8539            MOVE ER-0236         TO EMI-ERROR
  8540            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8541            MOVE AL-UABON        TO CRTLNMEA
  8542            MOVE -1              TO CRTLNMEL
  8543            MOVE 'X'             TO ERROR-SWITCH
  8544     ELSE
  8545         MOVE AL-UANOF           TO CRTLNMEA.
  8546
  8547     IF CRTFNMEI GREATER THAN LOW-VALUES
  8548         MOVE AL-UANON           TO CRTFNMEA
  8549         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8550     ELSE
  8551         MOVE AL-UANOF           TO CRTFNMEA.
  8552
  8553     IF CRTINITI GREATER THAN LOW-VALUES
  8554         MOVE AL-UANON           TO CRTINITA
  8555         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
  8556     ELSE
  8557         MOVE AL-UANOF           TO CRTINITA.
  8558
  8559     IF ISSAGEL GREATER THAN ZERO
  8560         IF ISSAGEI NUMERIC
  8561            MOVE AL-UANON        TO ISSAGEA
  8562            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8563         ELSE
  8564            MOVE ER-0237         TO EMI-ERROR
  8565            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8566            MOVE AL-UABON        TO ISSAGEA
  8567            MOVE -1              TO ISSAGEL
  8568            MOVE 'X'             TO ERROR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 155
* EL131.cbl
  8569     ELSE
  8570         MOVE AL-UANOF           TO ISSAGEA.
  8571
  8572     IF JNTFNMEI GREATER THAN LOW-VALUES
  8573         MOVE AL-UANON           TO JNTFNMEA
  8574         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8575     ELSE
  8576         MOVE AL-UANOF           TO JNTFNMEA.
  8577
  8578     IF JNTLNMEI GREATER THAN LOW-VALUES
  8579         MOVE AL-UANON           TO JNTLNMEA
  8580         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8581     ELSE
  8582         MOVE AL-UANOF           TO JNTLNMEA.
  8583
  8584     IF JNTINITI GREATER THAN LOW-VALUES
  8585         MOVE AL-UANON           TO JNTINITA
  8586         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8587     ELSE
  8588         MOVE AL-UANOF           TO JNTINITA.
  8589
  8590     IF JNTAGEL GREATER THAN ZERO
  8591         IF JNTAGEI NUMERIC
  8592            MOVE AL-UANON        TO JNTAGEA
  8593            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8594         ELSE
  8595            MOVE ER-0238         TO EMI-ERROR
  8596            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8597            MOVE AL-UABON        TO JNTAGEA
  8598            MOVE -1              TO JNTAGEL
  8599            MOVE 'X'             TO ERROR-SWITCH
  8600     ELSE
  8601         MOVE AL-UANOF           TO JNTAGEA.
  8602
  8603     IF ADDONDTI GREATER THAN LOW-VALUES
  8604         MOVE LOW-VALUES         TO HOLD-ADDON
  8605         IF ADDONDTI = SPACES
  8606             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8607         ELSE
  8608             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8609
  8610* EXEC CICS BIF DEEDIT
  8611*                FIELD    (DEEDIT-DATE-INPUT)
  8612*                LENGTH   (DATE-LENGTH)
  8613*            END-EXEC
  8614*    MOVE '@"L                   #   #00008291' TO DFHEIV0
  8615     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8616     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8617     MOVE X'2020233030303038323931' TO DFHEIV0(25:11)
  8618     CALL 'kxdfhei1' USING DFHEIV0,
  8619           DEEDIT-DATE-INPUT,
  8620           DATE-LENGTH
  8621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8622             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8623             MOVE '4'            TO DC-OPTION-CODE
  8624             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8625             IF NOT DATE-CONVERSION-ERROR
  8626                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 156
* EL131.cbl
  8627                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8628                                                  CERT-SWITCH
  8629                 MOVE AL-UANON   TO ADDONDTA
  8630                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8631             ELSE
  8632                 MOVE ER-7651    TO EMI-ERROR
  8633                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8634                 MOVE AL-UABON   TO ADDONDTA
  8635                 MOVE -1         TO ADDONDTL
  8636                 MOVE 'X'        TO ERROR-SWITCH
  8637       ELSE
  8638         MOVE AL-UANOF TO ADDONDTA.
  8639
  8640     IF LCVCDI GREATER THAN LOW-VALUES
  8641         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8642         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8643     ELSE
  8644         MOVE AL-UANOF           TO LCVCDA.
  8645
  8646     IF ACVCDI GREATER THAN LOW-VALUES
  8647         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8648         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8649     ELSE
  8650         MOVE AL-UANOF           TO ACVCDA.
  8651
  8652     IF LCVOTRMI GREATER THAN LOW-VALUES
  8653
  8654* EXEC CICS BIF DEEDIT
  8655*            FIELD (LCVOTRMI)
  8656*            LENGTH(3)
  8657*        END-EXEC
  8658     MOVE 3
  8659       TO DFHEIV11
  8660*    MOVE '@"L                   #   #00008326' TO DFHEIV0
  8661     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8662     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8663     MOVE X'2020233030303038333236' TO DFHEIV0(25:11)
  8664     CALL 'kxdfhei1' USING DFHEIV0,
  8665           LCVOTRMI,
  8666           DFHEIV11
  8667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8668         IF LCVOTRMI IS NUMERIC
  8669             MOVE LCVOTRMI       TO LCVOTRMO
  8670             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8671             MOVE AL-UANON       TO LCVOTRMA
  8672         ELSE
  8673             MOVE ER-0241        TO EMI-ERROR
  8674             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8675             MOVE AL-UNBON       TO LCVOTRMA
  8676             MOVE 'X'            TO ERROR-SWITCH
  8677             MOVE -1             TO LCVOTRML
  8678     ELSE
  8679         MOVE AL-UANOF           TO LCVOTRMA.
  8680
  8681     IF ACVOTRMI GREATER THAN LOW-VALUES
  8682
  8683* EXEC CICS BIF DEEDIT
  8684*            FIELD (ACVOTRMI)
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 157
* EL131.cbl
  8685*            LENGTH(3)
  8686*        END-EXEC
  8687     MOVE 3
  8688       TO DFHEIV11
  8689*    MOVE '@"L                   #   #00008344' TO DFHEIV0
  8690     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8691     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8692     MOVE X'2020233030303038333434' TO DFHEIV0(25:11)
  8693     CALL 'kxdfhei1' USING DFHEIV0,
  8694           ACVOTRMI,
  8695           DFHEIV11
  8696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8697         IF ACVOTRMI IS NUMERIC
  8698             MOVE ACVOTRMI       TO ACVOTRMO
  8699             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8700             MOVE AL-UANON       TO ACVOTRMA
  8701         ELSE
  8702             MOVE ER-0241        TO EMI-ERROR
  8703             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8704             MOVE AL-UNBON       TO ACVOTRMA
  8705             MOVE 'X'            TO ERROR-SWITCH
  8706             MOVE -1             TO ACVOTRML
  8707     ELSE
  8708         MOVE AL-UANOF           TO ACVOTRMA.
  8709
  8710     IF LCVRATEL GREATER THAN +0
  8711
  8712* EXEC CICS BIF DEEDIT
  8713*            FIELD (LCVRATEI)
  8714*            LENGTH(6)
  8715*        END-EXEC
  8716     MOVE 6
  8717       TO DFHEIV11
  8718*    MOVE '@"L                   #   #00008362' TO DFHEIV0
  8719     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8720     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8721     MOVE X'2020233030303038333632' TO DFHEIV0(25:11)
  8722     CALL 'kxdfhei1' USING DFHEIV0,
  8723           LCVRATEI,
  8724           DFHEIV11
  8725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8726         IF LCVRATEI IS NUMERIC
  8727             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  8728             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8729             MOVE AL-UNNON       TO LCVRATEA
  8730         ELSE
  8731             MOVE ER-2280        TO EMI-ERROR
  8732             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8733             MOVE AL-UNBON       TO LCVRATEA
  8734             MOVE 'X'            TO ERROR-SWITCH
  8735             MOVE -1             TO LCVRATEL
  8736     ELSE
  8737         MOVE AL-UNNOF           TO LCVRATEA.
  8738
  8739     IF ACVRATEL GREATER THAN +0
  8740
  8741* EXEC CICS BIF DEEDIT
  8742*            FIELD (ACVRATEI)
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 158
* EL131.cbl
  8743*            LENGTH(6)
  8744*        END-EXEC
  8745     MOVE 6
  8746       TO DFHEIV11
  8747*    MOVE '@"L                   #   #00008380' TO DFHEIV0
  8748     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8749     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8750     MOVE X'2020233030303038333830' TO DFHEIV0(25:11)
  8751     CALL 'kxdfhei1' USING DFHEIV0,
  8752           ACVRATEI,
  8753           DFHEIV11
  8754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8755         IF ACVRATEI IS NUMERIC
  8756             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  8757             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8758             MOVE AL-UNNON       TO ACVRATEA
  8759         ELSE
  8760             MOVE ER-2280        TO EMI-ERROR
  8761             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8762             MOVE AL-UNBON       TO ACVRATEA
  8763             MOVE 'X'            TO ERROR-SWITCH
  8764             MOVE -1             TO ACVRATEL
  8765     ELSE
  8766         MOVE AL-UNNOF           TO ACVRATEA.
  8767
  8768     IF LCVBENEL GREATER THAN ZERO
  8769
  8770* EXEC CICS BIF DEEDIT
  8771*            FIELD (LCVBENEI)
  8772*            LENGTH (11)
  8773*        END-EXEC
  8774     MOVE 11
  8775       TO DFHEIV11
  8776*    MOVE '@"L                   #   #00008398' TO DFHEIV0
  8777     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8778     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8779     MOVE X'2020233030303038333938' TO DFHEIV0(25:11)
  8780     CALL 'kxdfhei1' USING DFHEIV0,
  8781           LCVBENEI,
  8782           DFHEIV11
  8783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8784         IF LCVBENEI IS NUMERIC
  8785            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  8786            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8787            MOVE AL-UNNON        TO LCVBENEA
  8788         ELSE
  8789            MOVE ER-0243         TO EMI-ERROR
  8790            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8791            MOVE AL-UNBON        TO LCVBENEA
  8792            MOVE -1              TO LCVBENEL
  8793            MOVE 'X'             TO ERROR-SWITCH
  8794     ELSE
  8795         MOVE AL-UANOF           TO LCVBENEA.
  8796
  8797     IF ACVBENEL GREATER THAN ZERO
  8798
  8799* EXEC CICS BIF DEEDIT
  8800*            FIELD (ACVBENEI)
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 159
* EL131.cbl
  8801*            LENGTH (11)
  8802*        END-EXEC
  8803     MOVE 11
  8804       TO DFHEIV11
  8805*    MOVE '@"L                   #   #00008416' TO DFHEIV0
  8806     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8807     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8808     MOVE X'2020233030303038343136' TO DFHEIV0(25:11)
  8809     CALL 'kxdfhei1' USING DFHEIV0,
  8810           ACVBENEI,
  8811           DFHEIV11
  8812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8813         IF ACVBENEI IS NUMERIC
  8814            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  8815            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8816            MOVE AL-UNNON        TO ACVBENEA
  8817         ELSE
  8818            MOVE ER-0243         TO EMI-ERROR
  8819            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8820            MOVE AL-UNBON        TO ACVBENEA
  8821            MOVE -1              TO ACVBENEL
  8822            MOVE 'X'             TO ERROR-SWITCH
  8823     ELSE
  8824         MOVE AL-UANOF           TO ACVBENEA.
  8825
  8826     IF LCVFORMI GREATER THAN LOW-VALUES
  8827        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8828        MOVE AL-UANON            TO LCVFORMA
  8829     ELSE
  8830        MOVE AL-UANOF            TO LCVFORMA.
  8831
  8832     IF ACVFORMI GREATER THAN LOW-VALUES
  8833        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8834        MOVE AL-UANON            TO ACVFORMA
  8835     ELSE
  8836        MOVE AL-UANOF            TO ACVFORMA.
  8837
  8838     IF LCVCNDTL GREATER THAN ZERO
  8839         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8840         IF LCVCNDTI = SPACES
  8841             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8842         ELSE
  8843             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  8844             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8845             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8846             MOVE '4'            TO DC-OPTION-CODE
  8847             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8848             IF NOT DATE-CONVERSION-ERROR
  8849                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  8850                 MOVE AL-UANON   TO LCVCNDTA
  8851                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8852                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  8853             ELSE
  8854                 MOVE ER-0246    TO EMI-ERROR
  8855                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8856                 MOVE AL-UABON   TO LCVCNDTA
  8857                 MOVE -1         TO LCVCNDTL
  8858                 MOVE 'X'        TO ERROR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 160
* EL131.cbl
  8859     ELSE
  8860         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8861         MOVE AL-UANOF           TO LCVCNDTA.
  8862
  8863     IF ACVCNDTL GREATER THAN ZERO
  8864         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8865         IF ACVCNDTI = SPACES
  8866             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8867         ELSE
  8868             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  8869             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8870             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8871             MOVE '4'            TO DC-OPTION-CODE
  8872             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8873             IF NOT DATE-CONVERSION-ERROR
  8874                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  8875                 MOVE AL-UANON   TO ACVCNDTA
  8876                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8877                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  8878             ELSE
  8879                 MOVE ER-0246    TO EMI-ERROR
  8880                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8881                 MOVE AL-UABON   TO ACVCNDTA
  8882                 MOVE -1         TO ACVCNDTL
  8883                 MOVE 'X'        TO ERROR-SWITCH
  8884     ELSE
  8885         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8886         MOVE AL-UANOF           TO ACVCNDTA.
  8887
  8888     IF APRL GREATER THAN +0
  8889
  8890* EXEC CICS BIF DEEDIT
  8891*            FIELD    (APRI)
  8892*            LENGTH   (8)
  8893*        END-EXEC
  8894     MOVE 8
  8895       TO DFHEIV11
  8896*    MOVE '@"L                   #   #00008496' TO DFHEIV0
  8897     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8898     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8899     MOVE X'2020233030303038343936' TO DFHEIV0(25:11)
  8900     CALL 'kxdfhei1' USING DFHEIV0,
  8901           APRI,
  8902           DFHEIV11
  8903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8904         IF APRI NUMERIC
  8905            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8906            MOVE APRI            TO HOLD-APR APRO
  8907            MOVE AL-UANON        TO APRA
  8908          ELSE
  8909            MOVE ER-0259         TO EMI-ERROR
  8910            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8911            MOVE AL-UABON        TO APRA
  8912            MOVE -1              TO APRL
  8913            MOVE 'X'             TO ERROR-SWITCH
  8914     ELSE
  8915         MOVE AL-UANOF           TO APRA.
  8916
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 161
* EL131.cbl
  8917     IF PMTFREQL GREATER THAN ZERO
  8918
  8919* EXEC CICS BIF DEEDIT
  8920*            FIELD    (PMTFREQI)
  8921*            LENGTH   (2)
  8922*        END-EXEC
  8923     MOVE 2
  8924       TO DFHEIV11
  8925*    MOVE '@"L                   #   #00008514' TO DFHEIV0
  8926     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8927     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8928     MOVE X'2020233030303038353134' TO DFHEIV0(25:11)
  8929     CALL 'kxdfhei1' USING DFHEIV0,
  8930           PMTFREQI,
  8931           DFHEIV11
  8932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8933         IF PMTFREQI NUMERIC
  8934            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  8935            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8936            MOVE AL-UANON        TO PMTFREQA
  8937          ELSE
  8938            MOVE ER-0427         TO EMI-ERROR
  8939            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8940            MOVE AL-UABON        TO PMTFREQA
  8941            MOVE -1              TO PMTFREQL
  8942            MOVE 'X'             TO ERROR-SWITCH
  8943     ELSE
  8944         MOVE AL-UANOF           TO PMTFREQA.
  8945
  8946     IF INDGRPL GREATER THAN ZERO
  8947         IF INDGRPI = 'I' OR 'G' OR SPACE
  8948             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8949             MOVE AL-UANON       TO INDGRPA
  8950          ELSE
  8951             MOVE ER-0260        TO EMI-ERROR
  8952             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8953             MOVE AL-UABON       TO INDGRPA
  8954             MOVE -1             TO INDGRPL
  8955             MOVE 'X'            TO ERROR-SWITCH
  8956     ELSE
  8957         MOVE AL-UANOF           TO INDGRPA.
  8958
  8959     IF PREMTYPL GREATER THAN ZERO
  8960         IF PREMTYPI = '1' OR '2' OR '3'
  8961            MOVE PREMTYPI        TO PI-PREM-TYPE
  8962            MOVE AL-UNNON        TO PREMTYPA
  8963            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8964          ELSE
  8965            MOVE ER-0227         TO EMI-ERROR
  8966            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8967            MOVE AL-UNBON        TO PREMTYPA
  8968            MOVE -1              TO PREMTYPL
  8969            MOVE 'X'             TO ERROR-SWITCH
  8970     ELSE
  8971         MOVE AL-UANOF           TO PREMTYPA.
  8972
  8973     IF LOANBALL GREATER THAN ZERO
  8974
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 162
* EL131.cbl
  8975* EXEC CICS BIF DEEDIT
  8976*             FIELD    (LOANBALI)
  8977*             LENGTH   (9)
  8978*        END-EXEC
  8979     MOVE 9
  8980       TO DFHEIV11
  8981*    MOVE '@"L                   #   #00008559' TO DFHEIV0
  8982     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8983     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8984     MOVE X'2020233030303038353539' TO DFHEIV0(25:11)
  8985     CALL 'kxdfhei1' USING DFHEIV0,
  8986           LOANBALI,
  8987           DFHEIV11
  8988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8989         IF LOANBALI NUMERIC
  8990             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  8991             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  8992             MOVE AL-UNNON TO LOANBALA
  8993         ELSE
  8994             MOVE ER-0639        TO EMI-ERROR
  8995             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8996             MOVE AL-UNBON       TO LOANBALA
  8997             MOVE -1             TO LOANBALL
  8998             MOVE 'X'            TO ERROR-SWITCH
  8999     ELSE
  9000         MOVE AL-UNNOF           TO LOANBALA.
  9001
  9002     IF LOANNOL GREATER THAN ZERO
  9003        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9004        MOVE AL-UANON            TO LOANNOA
  9005     ELSE
  9006        MOVE AL-UANOF            TO LOANNOA.
  9007
  9008     IF REINCDI GREATER THAN LOW-VALUES
  9009        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9010        MOVE AL-UANON            TO REINCDA
  9011     ELSE
  9012        MOVE AL-UANOF            TO REINCDA.
  9013
  9014     IF CERTI GREATER THAN LOW-VALUES
  9015         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9016     ELSE
  9017         MOVE AL-UANOF           TO CERTA.
  9018
  9019     IF CERTEFFI GREATER THAN LOW-VALUES
  9020         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9021     ELSE
  9022         MOVE AL-UANOF           TO CERTEFFA.
  9023
  9024     IF CERTACTI GREATER THAN LOW-VALUES
  9025         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9026     ELSE
  9027         MOVE AL-UANOF           TO CERTACTA.
  9028
  9029     IF CERTSTI GREATER THAN LOW-VALUES
  9030         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9031     ELSE
  9032         MOVE AL-UANOF           TO CERTSTA.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 163
* EL131.cbl
  9033
  9034     IF CERTCARI GREATER THAN LOW-VALUES
  9035         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9036     ELSE
  9037         MOVE AL-UANOF           TO CERTCARA.
  9038
  9039     IF DLYACTV-RECORD-NEEDED
  9040         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9041                 1150-EXIT
  9042     END-IF.
  9043
  9044     IF CERTEFFI GREATER LOW-VALUES OR
  9045        CERTACTI GREATER LOW-VALUES OR
  9046        CERTSTI  GREATER LOW-VALUES OR
  9047        CERTCARI GREATER LOW-VALUES OR
  9048        CERTGRPI GREATER LOW-VALUES
  9049        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9050
  9051*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9052*      IF PI-PREM-TYPE NOT = '1'  AND
  9053*         PI-NO-PMTS = ZEROS
  9054*          IF LOANBALL GREATER +0 OR
  9055*             ACVBENEL GREATER +0
  9056*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9057
  9058     if accswl > zeros
  9059        if accswi = 'Y' OR 'N'
  9060           MOVE 'X'              TO UPDATE-SWITCH
  9061                                    MSTR-SWITCH
  9062           MOVE AL-UANON         TO accswa
  9063        else
  9064           move er-1656          to emi-error
  9065           PERFORM 9900-ERROR-FORMAT
  9066                                 THRU 9900-EXIT
  9067           move al-uabon         to accswa
  9068           move -1               to accswl
  9069           move 'X'              to error-switch
  9070           move al-uanof         to accswa
  9071        end-if
  9072     end-if
  9073     IF CERTL = ZEROS AND
  9074        SUFXL = ZEROS
  9075          GO TO 1010-EXIT.
  9076
  9077     IF CERTL GREATER THAN ZEROS
  9078         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9079             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9080             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9081             MOVE 'X'            TO ERROR-SWITCH
  9082             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9083
  9084     IF SUFXL GREATER THAN ZEROS
  9085         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9086             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9087             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9088             MOVE 'X'            TO ERROR-SWITCH
  9089             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9090
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 164
* EL131.cbl
  9091 1010-EXIT.
  9092     EXIT.
  9093
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 165
* EL131.cbl
  9095 1120-EDIT-PROC.
  9096     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9097     MOVE '2'                    TO CNTL-REC-TYPE.
  9098     MOVE PROCI                  TO CNTL-PROC-ID.
  9099     MOVE ZERO                   TO CNTL-SEQ-NO.
  9100
  9101
  9102* EXEC CICS HANDLE CONDITION
  9103*         NOTFND    (1120-CNTL-NOTFND)
  9104*    END-EXEC.
  9105*    MOVE '"$I                   ! & #00008675' TO DFHEIV0
  9106     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9108     MOVE X'2620233030303038363735' TO DFHEIV0(25:11)
  9109     CALL 'kxdfhei1' USING DFHEIV0
  9110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9111
  9112
  9113
  9114* EXEC CICS READ
  9115*         SET      (ADDRESS OF CONTROL-FILE)
  9116*         DATASET  (CNTL-FILE-ID)
  9117*         RIDFLD   (CNTL-KEY)
  9118*    END-EXEC.
  9119*    MOVE '&"S        E          (   #00008679' TO DFHEIV0
  9120     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9121     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9122     MOVE X'2020233030303038363739' TO DFHEIV0(25:11)
  9123     CALL 'kxdfhei1' USING DFHEIV0,
  9124           CNTL-FILE-ID,
  9125           DFHEIV20,
  9126           DFHEIV99,
  9127           CNTL-KEY,
  9128           DFHEIV99,
  9129           DFHEIV99,
  9130           DFHEIV99
  9131     SET ADDRESS OF CONTROL-FILE TO
  9132         DFHEIV20
  9133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9134
  9135
  9136     MOVE AL-UANON               TO PROCA.
  9137     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9138     GO TO 1120-EXIT.
  9139
  9140 1120-CNTL-NOTFND.
  9141     MOVE ER-0273                TO EMI-ERROR.
  9142     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9143     MOVE AL-UABON               TO PROCA.
  9144     MOVE -1                     TO PROCL.
  9145     MOVE 'X'                    TO ERROR-SWITCH.
  9146
  9147 1120-EXIT.
  9148     EXIT.
  9149
  9150*************************************************************
  9151*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9152*************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 166
* EL131.cbl
  9153
  9154 1150-OUTPUT-ACTIVITY-RECORD.
  9155
  9156
  9157* EXEC CICS GETMAIN
  9158*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  9159*        LENGTH (25)
  9160*        INITIMG (WS-BLANK)
  9161*    END-EXEC.
  9162     MOVE 25
  9163       TO DFHEIV11
  9164*    MOVE ',"IL                  $   #00008705' TO DFHEIV0
  9165     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9166     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9167     MOVE X'2020233030303038373035' TO DFHEIV0(25:11)
  9168     CALL 'kxdfhei1' USING DFHEIV0,
  9169           DFHEIV20,
  9170           DFHEIV11,
  9171           WS-BLANK
  9172     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  9173         DFHEIV20
  9174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9175
  9176
  9177     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  9178     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  9179     MOVE PI-CARRIER             TO DA-CARRIER.
  9180     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  9181     MOVE PI-CERT-NO             TO DA-CERT-NO.
  9182     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  9183     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  9184
  9185
  9186* EXEC CICS HANDLE CONDITION
  9187*        NOTOPEN (1150-NOTOPEN-ERROR)
  9188*        DUPREC (1150-EXIT)
  9189*    END-EXEC.
  9190*    MOVE '"$J%                  ! '' #00008719' TO DFHEIV0
  9191     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  9192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9193     MOVE X'2720233030303038373139' TO DFHEIV0(25:11)
  9194     CALL 'kxdfhei1' USING DFHEIV0
  9195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9196
  9197     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  9198     MOVE 'DLYACTV'              TO JP-FILE-ID.
  9199     MOVE 'A'                    TO JP-RECORD-TYPE.
  9200     MOVE +48                    TO JOURNAL-LENGTH.
  9201
  9202
  9203* EXEC CICS WRITE
  9204*        DATASET ('DLYACTV')
  9205*        RIDFLD (DA-KEY)
  9206*        FROM (DAILY-ACTIVITY-RECORD)
  9207*        LENGTH (25)
  9208*    END-EXEC.
  9209     MOVE 'DLYACTV' TO DFHEIV1
  9210     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 167
* EL131.cbl
  9211       TO DFHEIV11
  9212*    MOVE '&$ L                  ''   #00008728' TO DFHEIV0
  9213     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9214     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9215     MOVE X'2020233030303038373238' TO DFHEIV0(25:11)
  9216     CALL 'kxdfhei1' USING DFHEIV0,
  9217           DFHEIV1,
  9218           DAILY-ACTIVITY-RECORD,
  9219           DFHEIV11,
  9220           DA-KEY,
  9221           DFHEIV99,
  9222           DFHEIV99
  9223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9224
  9225
  9226     GO TO 1150-EXIT.
  9227
  9228 1150-NOTOPEN-ERROR.
  9229
  9230     MOVE '2955'                 TO EMI-ERROR.
  9231     MOVE -1                     TO MAINTL.
  9232     MOVE AL-UANON               TO MAINTA.
  9233     MOVE 'X'                    TO ERROR-SWITCH.
  9234     PERFORM 9900-ERROR-FORMAT THRU
  9235             9900-EXIT.
  9236
  9237 1150-EXIT.
  9238     EXIT.
  9239
  9240*************************************************************
  9241*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  9242*************************************************************
  9243
  9244 1240-EDIT-LIFE-CODE.
  9245
  9246     IF INVALID-BENEFIT-CODE
  9247         GO TO 1240-SET-ERROR.
  9248
  9249     MOVE SPACES                 TO BENEFIT-KEY.
  9250     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9251     MOVE '4'                    TO BEN-REC-TYPE.
  9252     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9253     MOVE ZERO                   TO BEN-SEQ-NO.
  9254
  9255
  9256* EXEC CICS READ GTEQ
  9257*         DATASET  (CNTL-FILE-ID)
  9258*         RIDFLD   (BENEFIT-KEY)
  9259*         SET      (ADDRESS OF CONTROL-FILE)
  9260*    END-EXEC.
  9261*    MOVE '&"S        G          (   #00008764' TO DFHEIV0
  9262     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9263     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9264     MOVE X'2020233030303038373634' TO DFHEIV0(25:11)
  9265     CALL 'kxdfhei1' USING DFHEIV0,
  9266           CNTL-FILE-ID,
  9267           DFHEIV20,
  9268           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 168
* EL131.cbl
  9269           BENEFIT-KEY,
  9270           DFHEIV99,
  9271           DFHEIV99,
  9272           DFHEIV99
  9273     SET ADDRESS OF CONTROL-FILE TO
  9274         DFHEIV20
  9275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9276
  9277
  9278     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9279        CF-RECORD-TYPE NOT = '4'
  9280         GO TO 1240-SET-ERROR.
  9281
  9282     MOVE ZERO                   TO COUNT-2.
  9283     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9284
  9285     IF SCREEN-ERROR
  9286         GO TO 1240-SET-ERROR.
  9287
  9288 1240-SET-CODE-SWITCHES.
  9289     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9290     MOVE AL-UANON               TO LCVCDA.
  9291     GO TO 1240-EXIT.
  9292
  9293 1240-SET-ERROR.
  9294     MOVE ER-0240                TO EMI-ERROR.
  9295     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9296     MOVE 'X'                    TO ERROR-SWITCH.
  9297     MOVE AL-UABON               TO LCVCDA.
  9298     MOVE -1                     TO LCVCDL.
  9299
  9300 1240-EXIT.
  9301     EXIT.
  9302
  9303 1310-EDIT-AH-CODE.
  9304     IF INVALID-BENEFIT-CODE
  9305         GO TO 1310-SET-ERROR.
  9306
  9307     MOVE SPACES                 TO BENEFIT-KEY.
  9308     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9309     MOVE '5'                    TO BEN-REC-TYPE.
  9310     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9311     MOVE ZERO                   TO BEN-SEQ-NO.
  9312
  9313
  9314* EXEC CICS READ GTEQ
  9315*         DATASET  (CNTL-FILE-ID)
  9316*         RIDFLD   (BENEFIT-KEY)
  9317*         SET      (ADDRESS OF CONTROL-FILE)
  9318*    END-EXEC.
  9319*    MOVE '&"S        G          (   #00008805' TO DFHEIV0
  9320     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9321     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9322     MOVE X'2020233030303038383035' TO DFHEIV0(25:11)
  9323     CALL 'kxdfhei1' USING DFHEIV0,
  9324           CNTL-FILE-ID,
  9325           DFHEIV20,
  9326           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 169
* EL131.cbl
  9327           BENEFIT-KEY,
  9328           DFHEIV99,
  9329           DFHEIV99,
  9330           DFHEIV99
  9331     SET ADDRESS OF CONTROL-FILE TO
  9332         DFHEIV20
  9333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9334
  9335
  9336     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9337        CF-RECORD-TYPE NOT = '5'
  9338         GO TO 1310-SET-ERROR.
  9339
  9340     MOVE ZERO                   TO COUNT-2.
  9341     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9342     IF SCREEN-ERROR
  9343         GO TO 1310-SET-ERROR.
  9344
  9345 1310-SET-CODE-SWITCHES.
  9346     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9347     MOVE AL-UANON               TO ACVCDA.
  9348     GO TO 1310-EXIT.
  9349
  9350 1310-SET-ERROR.
  9351     MOVE ER-0250                TO EMI-ERROR.
  9352     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9353     MOVE AL-UABON               TO ACVCDA.
  9354     MOVE 'X'                    TO ERROR-SWITCH.
  9355     MOVE -1                     TO ACVCDL.
  9356
  9357 1310-EXIT.
  9358     EXIT.
  9359
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 170
* EL131.cbl
  9361 1460-EDIT-CERT-NO.
  9362     MOVE CERTI                  TO WS-CERT-NO-PRIME.
  9363     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
  9364
  9365     IF WS-SAVE-CERT-NO = SPACES
  9366         MOVE ER-0203            TO EMI-ERROR
  9367         GO TO 1460-CERT-NO-ERROR.
  9368
  9369     IF WS-CERT-NO-PRIME = SPACES AND
  9370        WS-CERT-NO-SUFX GREATER THAN SPACE
  9371            MOVE ER-0210         TO EMI-ERROR
  9372            GO TO 1460-CERT-NO-ERROR.
  9373
  9374     MOVE 'X'                    TO UPDATE-SWITCH.
  9375     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9376     MOVE AL-UANON               TO CERTA.
  9377
  9378     IF SUFXL IS GREATER THAN 0
  9379         MOVE AL-UANON           TO SUFXA.
  9380
  9381     GO TO 1460-EXIT.
  9382
  9383 1460-CERT-NO-ERROR.
  9384     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9385     MOVE AL-UABON               TO SUFXA.
  9386     MOVE AL-UABON               TO CERTA.
  9387     MOVE -1                     TO CERTL.
  9388     MOVE 'X'                    TO ERROR-SWITCH.
  9389
  9390 1460-EXIT.
  9391     EXIT.
  9392
  9393 1470-EDIT-EFF.
  9394     IF CERTEFFI = SPACES
  9395         GO TO 1470-DATE-ERROR.
  9396
  9397     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
  9398     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  9399     IF DEEDIT-DATE = ZERO
  9400         GO TO 1470-DATE-ERROR.
  9401
  9402     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
  9403     MOVE '4'                    TO DC-OPTION-CODE.
  9404     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  9405     IF NOT DATE-CONVERSION-ERROR
  9406         MOVE DC-BIN-DATE-1      TO HOLD-EFF
  9407         MOVE AL-UANON           TO CERTEFFA
  9408         MOVE 'X'                TO UPDATE-SWITCH
  9409         MOVE 'Y'                TO CERT-KEY-SWITCH
  9410         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
  9411         GO TO 1470-EXIT.
  9412
  9413 1470-DATE-ERROR.
  9414     MOVE ER-0215                TO EMI-ERROR.
  9415     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9416     MOVE AL-UABON               TO CERTEFFA.
  9417     MOVE -1                     TO CERTEFFL.
  9418     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 171
* EL131.cbl
  9419
  9420 1470-EXIT.
  9421     EXIT.
  9422
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 172
* EL131.cbl
  9424 1480-EDIT-ACCT.
  9425     IF CERTACTI = SPACES
  9426         MOVE ER-0232            TO EMI-ERROR
  9427         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9428         MOVE AL-UABON           TO CERTACTA
  9429         MOVE -1                 TO CERTACTL
  9430         MOVE 'X'                TO ERROR-SWITCH
  9431     ELSE
  9432         MOVE 'X'                TO UPDATE-SWITCH
  9433         MOVE 'Y'                TO CERT-KEY-SWITCH.
  9434
  9435 1480-EXIT.
  9436     EXIT.
  9437
  9438 1490-EDIT-STATE.
  9439     IF CERTSTI = SPACES
  9440         MOVE ER-0233            TO EMI-ERROR
  9441         GO TO 1490-STATE-ERROR.
  9442
  9443     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9444     MOVE '3'                    TO CNTL-REC-TYPE.
  9445     MOVE SPACES                 TO CNTL-STATE-ACCESS.
  9446     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
  9447     MOVE ZERO                   TO CNTL-SEQ-NO.
  9448
  9449
  9450* EXEC CICS HANDLE CONDITION
  9451*         NOTFND (1490-STATE-NOTFND)
  9452*    END-EXEC.
  9453*    MOVE '"$I                   ! ( #00008924' TO DFHEIV0
  9454     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9456     MOVE X'2820233030303038393234' TO DFHEIV0(25:11)
  9457     CALL 'kxdfhei1' USING DFHEIV0
  9458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9459
  9460
  9461
  9462* EXEC CICS READ
  9463*         SET        (ADDRESS OF CONTROL-FILE)
  9464*         DATASET    ('ELCNTL')
  9465*         RIDFLD     (CNTL-KEY)
  9466*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9467*         GENERIC
  9468*    END-EXEC.
  9469     MOVE 'ELCNTL' TO DFHEIV1
  9470*    MOVE '&"S  KG    E          (   #00008928' TO DFHEIV0
  9471     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9472     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9473     MOVE X'2020233030303038393238' TO DFHEIV0(25:11)
  9474     CALL 'kxdfhei1' USING DFHEIV0,
  9475           DFHEIV1,
  9476           DFHEIV20,
  9477           DFHEIV99,
  9478           CNTL-KEY,
  9479           CNTL-GENERIC-LENGTH,
  9480           DFHEIV99,
  9481           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 173
* EL131.cbl
  9482     SET ADDRESS OF CONTROL-FILE TO
  9483         DFHEIV20
  9484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9485
  9486
  9487     MOVE AL-UANON               TO CERTSTA.
  9488     MOVE 'X'                    TO UPDATE-SWITCH.
  9489     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9490     GO TO 1490-EXIT.
  9491
  9492 1490-STATE-NOTFND.
  9493     MOVE ER-0149                TO EMI-ERROR.
  9494
  9495 1490-STATE-ERROR.
  9496     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9497     MOVE AL-UABON               TO CERTSTA.
  9498     MOVE -1                     TO CERTSTL.
  9499     MOVE 'X'                    TO ERROR-SWITCH.
  9500
  9501 1490-EXIT.
  9502     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 174
* EL131.cbl
  9504 1500-EDIT-CARR.
  9505     IF CERTCARI = SPACES
  9506         GO TO 1500-CARR-NOTFND.
  9507
  9508     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9509     MOVE '6'                    TO CNTL-REC-TYPE.
  9510     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
  9511     MOVE CERTCARI               TO CNTL-CARRIER.
  9512     MOVE ZERO                   TO CNTL-SEQ-NO.
  9513
  9514
  9515* EXEC CICS HANDLE CONDITION
  9516*         NOTFND   (1500-CARR-NOTFND)
  9517*    END-EXEC.
  9518*    MOVE '"$I                   ! ) #00008963' TO DFHEIV0
  9519     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9520     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9521     MOVE X'2920233030303038393633' TO DFHEIV0(25:11)
  9522     CALL 'kxdfhei1' USING DFHEIV0
  9523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9524
  9525
  9526
  9527* EXEC CICS READ
  9528*         SET        (ADDRESS OF CONTROL-FILE)
  9529*         DATASET    ('ELCNTL')
  9530*         RIDFLD     (CNTL-KEY)
  9531*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9532*         GENERIC
  9533*    END-EXEC.
  9534     MOVE 'ELCNTL' TO DFHEIV1
  9535*    MOVE '&"S  KG    E          (   #00008967' TO DFHEIV0
  9536     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9537     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9538     MOVE X'2020233030303038393637' TO DFHEIV0(25:11)
  9539     CALL 'kxdfhei1' USING DFHEIV0,
  9540           DFHEIV1,
  9541           DFHEIV20,
  9542           DFHEIV99,
  9543           CNTL-KEY,
  9544           CNTL-GENERIC-LENGTH,
  9545           DFHEIV99,
  9546           DFHEIV99
  9547     SET ADDRESS OF CONTROL-FILE TO
  9548         DFHEIV20
  9549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9550
  9551
  9552     MOVE AL-UANON               TO CERTCARA.
  9553     MOVE 'X'                    TO UPDATE-SWITCH.
  9554     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9555     GO TO 1500-EXIT.
  9556
  9557 1500-CARR-NOTFND.
  9558     MOVE ER-0360                TO EMI-ERROR.
  9559     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9560     MOVE AL-UABON               TO CERTCARA.
  9561     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 175
* EL131.cbl
  9562     MOVE 'X'                    TO ERROR-SWITCH.
  9563
  9564 1500-EXIT.
  9565     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 176
* EL131.cbl
  9567 1510-DEEDIT-DATE.
  9568
  9569* EXEC CICS BIF DEEDIT
  9570*         FIELD    (DEEDIT-DATE-INPUT)
  9571*         LENGTH   (DATE-LENGTH)
  9572*    END-EXEC.
  9573*    MOVE '@"L                   #   #00008991' TO DFHEIV0
  9574     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9575     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9576     MOVE X'2020233030303038393931' TO DFHEIV0(25:11)
  9577     CALL 'kxdfhei1' USING DFHEIV0,
  9578           DEEDIT-DATE-INPUT,
  9579           DATE-LENGTH
  9580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9581
  9582
  9583 1510-EXIT.
  9584     EXIT.
  9585
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 177
* EL131.cbl
  9587 1620-VERIFY-ACCT.
  9588
  9589     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
  9590     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9591     MOVE PI-GROUPING            TO ACCT-GROUP.
  9592     MOVE PI-STATE               TO ACCT-STATE.
  9593     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9594
  9595     IF CERTEFFI GREATER THAN LOW-VALUES
  9596         MOVE HOLD-EFF           TO ACCT-DATE
  9597     ELSE
  9598         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
  9599
  9600     IF CERTACTI GREATER THAN LOW-VALUES
  9601         MOVE CERTACTI           TO  ACCT-ACCOUNT.
  9602     IF CERTSTI GREATER THAN LOW-VALUES
  9603         MOVE CERTSTI            TO  ACCT-STATE.
  9604     IF CERTCARI GREATER THAN LOW-VALUES
  9605         MOVE CERTCARI           TO  ACCT-CARRIER.
  9606     IF CERTGRPI GREATER THAN LOW-VALUES
  9607         MOVE CERTGRPI           TO ACCT-GROUP.
  9608
  9609     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
  9610
  9611
  9612* EXEC CICS HANDLE CONDITION
  9613*         NOTFND  (1620-ACCT-NOTFND)
  9614*    END-EXEC.
  9615*    MOVE '"$I                   ! * #00009024' TO DFHEIV0
  9616     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9617     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9618     MOVE X'2A20233030303039303234' TO DFHEIV0(25:11)
  9619     CALL 'kxdfhei1' USING DFHEIV0
  9620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9621
  9622
  9623
  9624* EXEC CICS STARTBR
  9625*         DATASET   (ACCT-FILE-ID)
  9626*         RIDFLD    (ACCT-KEY)
  9627*    END-EXEC.
  9628     MOVE 0
  9629       TO DFHEIV11
  9630*    MOVE '&,         G          &   #00009028' TO DFHEIV0
  9631     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9632     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9633     MOVE X'2020233030303039303238' TO DFHEIV0(25:11)
  9634     CALL 'kxdfhei1' USING DFHEIV0,
  9635           ACCT-FILE-ID,
  9636           ACCT-KEY,
  9637           DFHEIV99,
  9638           DFHEIV11,
  9639           DFHEIV99
  9640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9641
  9642
  9643 1620-ACCT-LOOP.
  9644
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 178
* EL131.cbl
  9645
  9646* EXEC CICS READNEXT
  9647*         DATASET  (ACCT-FILE-ID)
  9648*         RIDFLD   (ACCT-KEY)
  9649*         SET      (ADDRESS OF ACCOUNT-MASTER)
  9650*    END-EXEC.
  9651     MOVE 0
  9652       TO DFHEIV11
  9653*    MOVE '&.S                   )   #00009035' TO DFHEIV0
  9654     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9655     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9656     MOVE X'2020233030303039303335' TO DFHEIV0(25:11)
  9657     CALL 'kxdfhei1' USING DFHEIV0,
  9658           ACCT-FILE-ID,
  9659           DFHEIV20,
  9660           DFHEIV99,
  9661           ACCT-KEY,
  9662           DFHEIV99,
  9663           DFHEIV11,
  9664           DFHEIV99,
  9665           DFHEIV99
  9666     SET ADDRESS OF ACCOUNT-MASTER TO
  9667         DFHEIV20
  9668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9669
  9670
  9671     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
  9672         GO TO 1620-ACCT-NOTFND.
  9673
  9674     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
  9675        HOLD-EFF     LESS AM-EXPIRATION-DT
  9676         NEXT SENTENCE
  9677     ELSE
  9678         GO TO 1620-ACCT-LOOP.
  9679
  9680     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
  9681         GO TO 1620-ACCT-END-BROWSE.
  9682
  9683     IF LOANBALL GREATER THAN +0
  9684         IF AM-MAX-TOT-BEN NUMERIC  AND
  9685            AM-MAX-TOT-BEN GREATER THAN ZERO
  9686             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
  9687                 MOVE AL-UNBON     TO LOANBALA
  9688                 MOVE -1           TO LOANBALL
  9689                 MOVE 'X'          TO ERROR-SWITCH
  9690                 MOVE ER-7641      TO EMI-ERROR
  9691                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9692
  9693     IF ACVBENEL GREATER THAN +0
  9694         IF AM-MAX-MON-BEN NUMERIC  AND
  9695            AM-MAX-MON-BEN GREATER THAN ZERO
  9696             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
  9697                 MOVE AL-UNBON     TO ACVBENEA
  9698                 MOVE -1           TO ACVBENEL
  9699                 MOVE 'X'          TO ERROR-SWITCH
  9700                 MOVE ER-7642      TO EMI-ERROR
  9701                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9702
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 179
* EL131.cbl
  9703 1620-ACCT-END-BROWSE.
  9704
  9705
  9706* EXEC CICS ENDBR
  9707*         DATASET (ACCT-FILE-ID)
  9708*    END-EXEC.
  9709     MOVE 0
  9710       TO DFHEIV11
  9711*    MOVE '&2                    $   #00009075' TO DFHEIV0
  9712     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9713     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9714     MOVE X'2020233030303039303735' TO DFHEIV0(25:11)
  9715     CALL 'kxdfhei1' USING DFHEIV0,
  9716           ACCT-FILE-ID,
  9717           DFHEIV11,
  9718           DFHEIV99
  9719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9720
  9721
  9722     GO TO 1620-EXIT.
  9723
  9724 1620-ACCT-NOTFND.
  9725
  9726     MOVE -1                     TO MAINTL.
  9727     MOVE 'X'                    TO ERROR-SWITCH.
  9728     MOVE ER-0426                TO EMI-ERROR.
  9729     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9730
  9731 1620-EXIT.
  9732     EXIT.
  9733
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 180
* EL131.cbl
  9735 2000-UPDATE-CLAIM.
  9736
  9737     MOVE SPACES                 TO ERROR-SWITCH.
  9738     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
  9739     MOVE PI-CARRIER             TO CARRIER-CODE.
  9740     MOVE PI-CLAIM-NO            TO CLAIM-NO.
  9741     MOVE PI-CERT-NO             TO CERT-NO.
  9742
  9743     IF DELETE-CLAIM
  9744         GO TO 3000-DELETE-CLAIM.
  9745
  9746     IF  NOT MODIFY-CAP
  9747         MOVE ER-0070            TO EMI-ERROR
  9748         MOVE 'X'                TO ERROR-SWITCH
  9749         MOVE -1                 TO MAINTL
  9750         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9751         GO TO 2000-EXIT.
  9752
  9753     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
  9754     MOVE ZERO                   TO TRLR-SEQ-NO.
  9755
  9756
  9757* EXEC CICS READ UPDATE
  9758*         SET       (ADDRESS OF CLAIM-MASTER)
  9759*         DATASET   (CLMS-FILE-ID)
  9760*         RIDFLD    (MSTR-KEY)
  9761*    END-EXEC.
  9762*    MOVE '&"S        EU         (   #00009113' TO DFHEIV0
  9763     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9764     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9765     MOVE X'2020233030303039313133' TO DFHEIV0(25:11)
  9766     CALL 'kxdfhei1' USING DFHEIV0,
  9767           CLMS-FILE-ID,
  9768           DFHEIV20,
  9769           DFHEIV99,
  9770           MSTR-KEY,
  9771           DFHEIV99,
  9772           DFHEIV99,
  9773           DFHEIV99
  9774     SET ADDRESS OF CLAIM-MASTER TO
  9775         DFHEIV20
  9776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9777
  9778
  9779     if (incl > zeros)
  9780        and (cl-no-of-pmts-made > 0)
  9781        and (hold-incur > low-values)
  9782        and (hold-incur not = cl-incurred-dt)
  9783        if hold-incur > cl-incurred-dt
  9784           move cl-incurred-dt   to dc-bin-date-1
  9785           move hold-incur       to dc-bin-date-2
  9786        else
  9787           move hold-incur       to dc-bin-date-1
  9788           move cl-incurred-dt   to dc-bin-date-2
  9789        end-if
  9790        move '1'                 to dc-option-code
  9791        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9792        if dc-elapsed-days > +60
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 181
* EL131.cbl
  9793           MOVE ER-1663             TO EMI-ERROR
  9794           PERFORM 9900-ERROR-FORMAT
  9795                                 THRU 9900-EXIT
  9796           MOVE -1                  TO MAINTL
  9797           GO TO 8110-SEND-DATA
  9798        end-if
  9799     end-if
  9800     IF (CL-PRIORITY-CD = '8')
  9801        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
  9802             AND 'AMWA' AND 'KMSB')
  9803        MOVE ER-8003             TO EMI-ERROR
  9804        PERFORM 9900-ERROR-FORMAT
  9805                                 THRU 9900-EXIT
  9806        MOVE -1                  TO MAINTL
  9807        GO TO 8110-SEND-DATA
  9808     END-IF
  9809
  9810     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
  9811         MOVE ER-0068            TO EMI-ERROR
  9812         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9813         GO TO 2000-EXIT.
  9814
  9815     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
  9816         MOVE ER-0068            TO EMI-ERROR
  9817         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9818         GO TO 2000-EXIT.
  9819
  9820     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  9821         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
  9822
  9823     IF CL-PURGED-DT NOT = LOW-VALUES
  9824         MOVE ER-7691            TO EMI-ERROR
  9825         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9826         GO TO 2000-EXIT.
  9827
  9828     IF CERT-KEY-CHANGED
  9829         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
  9830
  9831     IF SCREEN-ERROR
  9832         MOVE ER-0068            TO EMI-ERROR
  9833         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9834         GO TO 2000-EXIT.
  9835
  9836     IF NINETY-TRLR-UPDATED
  9837         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
  9838
  9839     IF MSTR-KEY-CHANGED
  9840         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
  9841        ELSE
  9842         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
  9843
  9844     IF TRLR-UPDATE-REQUIRED
  9845         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
  9846
  9847 2000-CHECK-CERT.
  9848     IF NOT CERT-UPDATES
  9849         GO TO 2000-EXIT.
  9850
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 182
* EL131.cbl
  9851     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9852     MOVE PI-CARRIER             TO CERT-CARRIER.
  9853     MOVE PI-GROUPING            TO CERT-GROUP.
  9854     MOVE PI-STATE               TO CERT-STATE.
  9855     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9856     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9857     MOVE PI-CERT-NO             TO CERT-CERT.
  9858
  9859     IF CERT-ALT-KEY-CHANGED
  9860         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
  9861     ELSE
  9862         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
  9863
  9864 2000-EXIT.
  9865     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 183
* EL131.cbl
  9867 2010-RELEASE-REC.
  9868
  9869* EXEC CICS UNLOCK
  9870*         DATASET  (CLMS-FILE-ID)
  9871*    END-EXEC
  9872*    MOVE '&*                    #   #00009208' TO DFHEIV0
  9873     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9874     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9875     MOVE X'2020233030303039323038' TO DFHEIV0(25:11)
  9876     CALL 'kxdfhei1' USING DFHEIV0,
  9877           CLMS-FILE-ID,
  9878           DFHEIV99
  9879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9880
  9881     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9882     MOVE 'X'                    TO ERROR-SWITCH.
  9883
  9884 2010-EXIT.
  9885     EXIT.
  9886
  9887 2020-NORMAL-UPDATE.
  9888     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
  9889
  9890     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
  9891
  9892     IF WS-OPEN-CLOSE-SW = 'Y'
  9893       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
  9894       IF PI-REC-FOUND-SW = 'Y'
  9895         IF CL-ACTIVITY-CODE = 09
  9896           NEXT SENTENCE
  9897         ELSE
  9898           IF WS-RESET-SW = 'Y'
  9899             IF CL-CLAIM-STATUS = 'C'
  9900               MOVE 07               TO  CL-ACTIVITY-CODE
  9901               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
  9902               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
  9903             ELSE
  9904               MOVE 08               TO  CL-ACTIVITY-CODE
  9905               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
  9906               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
  9907
  9908     IF PI-COMPANY-ID = 'CID' or 'AHL'
  9909         MOVE 'Y'                TO CL-YESNOSW
  9910     END-IF.
  9911
  9912     if pi-company-id = 'DCC'
  9913        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9914        perform 2120-check-pdef  thru 2120-exit
  9915     end-if
  9916
  9917* EXEC CICS HANDLE CONDITION
  9918*         DUPKEY   (2020-EXIT)
  9919*    END-EXEC.
  9920*    MOVE '"$$                   ! + #00009247' TO DFHEIV0
  9921     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9922     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9923     MOVE X'2B20233030303039323437' TO DFHEIV0(25:11)
  9924     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 184
* EL131.cbl
  9925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9926
  9927
  9928
  9929* EXEC CICS REWRITE
  9930*         DATASET   (CLMS-FILE-ID)
  9931*         FROM      (CLAIM-MASTER)
  9932*    END-EXEC.
  9933     MOVE LENGTH OF
  9934      CLAIM-MASTER
  9935       TO DFHEIV11
  9936*    MOVE '&& L                  %   #00009251' TO DFHEIV0
  9937     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9938     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9939     MOVE X'2020233030303039323531' TO DFHEIV0(25:11)
  9940     CALL 'kxdfhei1' USING DFHEIV0,
  9941           CLMS-FILE-ID,
  9942           CLAIM-MASTER,
  9943           DFHEIV11,
  9944           DFHEIV99
  9945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9946
  9947
  9948 2020-EXIT.
  9949     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 185
* EL131.cbl
  9951 2030-KEY-UPDATE.
  9952     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
  9953
  9954
  9955* EXEC CICS DELETE
  9956*        DATASET  (CLMS-FILE-ID)
  9957*    END-EXEC.
  9958*    MOVE '&(                    &   #00009262' TO DFHEIV0
  9959     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9960     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9961     MOVE X'2020233030303039323632' TO DFHEIV0(25:11)
  9962     CALL 'kxdfhei1' USING DFHEIV0,
  9963           CLMS-FILE-ID,
  9964           DFHEIV99,
  9965           DFHEIV99,
  9966           DFHEIV99,
  9967           DFHEIV99
  9968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9969
  9970
  9971
  9972* EXEC CICS GETMAIN
  9973*         SET      (ADDRESS OF CLAIM-MASTER)
  9974*         LENGTH   (MSTR-LENGTH)
  9975*         INITIMG  (GETMAIN-SPACE)
  9976*    END-EXEC.
  9977*    MOVE ',"IL                  $   #00009266' TO DFHEIV0
  9978     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9979     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9980     MOVE X'2020233030303039323636' TO DFHEIV0(25:11)
  9981     CALL 'kxdfhei1' USING DFHEIV0,
  9982           DFHEIV20,
  9983           MSTR-LENGTH,
  9984           GETMAIN-SPACE
  9985     SET ADDRESS OF CLAIM-MASTER TO
  9986         DFHEIV20
  9987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9988
  9989
  9990     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
  9991
  9992     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
  9993
  9994     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
  9995
  9996     IF WS-OPEN-CLOSE-SW = 'Y'
  9997       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
  9998         IF PI-REC-FOUND-SW = 'Y'
  9999           IF CL-ACTIVITY-CODE = 09
 10000             NEXT SENTENCE
 10001           ELSE
 10002             IF WS-RESET-SW = 'Y'
 10003               IF CL-CLAIM-STATUS = 'C'
 10004                 MOVE 07             TO  CL-ACTIVITY-CODE
 10005                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10006                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10007               ELSE
 10008                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 186
* EL131.cbl
 10009                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10010                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10011
 10012
 10013* EXEC CICS HANDLE CONDITION
 10014*         DUPKEY    (2030-EXIT)
 10015*    END-EXEC.
 10016*    MOVE '"$$                   ! , #00009294' TO DFHEIV0
 10017     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10018     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10019     MOVE X'2C20233030303039323934' TO DFHEIV0(25:11)
 10020     CALL 'kxdfhei1' USING DFHEIV0
 10021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10022
 10023
 10024** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10025*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10026
 10027     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10028         MOVE 'Y'                TO CL-YESNOSW
 10029     END-IF.
 10030
 10031
 10032* EXEC CICS WRITE
 10033*         DATASET   (CLMS-FILE-ID)
 10034*         RIDFLD    (MSTR-KEY)
 10035*         FROM      (CLAIM-MASTER)
 10036*    END-EXEC.
 10037     MOVE LENGTH OF
 10038      CLAIM-MASTER
 10039       TO DFHEIV11
 10040*    MOVE '&$ L                  ''   #00009305' TO DFHEIV0
 10041     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10042     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10043     MOVE X'2020233030303039333035' TO DFHEIV0(25:11)
 10044     CALL 'kxdfhei1' USING DFHEIV0,
 10045           CLMS-FILE-ID,
 10046           CLAIM-MASTER,
 10047           DFHEIV11,
 10048           MSTR-KEY,
 10049           DFHEIV99,
 10050           DFHEIV99
 10051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10052
 10053
 10054 2030-EXIT.
 10055     EXIT.
 10056
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 187
* EL131.cbl
 10058 2040-NORMAL-UPDATE.
 10059
 10060* EXEC CICS READ UPDATE
 10061*         DATASET  (CERT-FILE-ID)
 10062*         RIDFLD   (CERT-KEY)
 10063*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10064*    END-EXEC.
 10065*    MOVE '&"S        EU         (   #00009316' TO DFHEIV0
 10066     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10067     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10068     MOVE X'2020233030303039333136' TO DFHEIV0(25:11)
 10069     CALL 'kxdfhei1' USING DFHEIV0,
 10070           CERT-FILE-ID,
 10071           DFHEIV20,
 10072           DFHEIV99,
 10073           CERT-KEY,
 10074           DFHEIV99,
 10075           DFHEIV99,
 10076           DFHEIV99
 10077     SET ADDRESS OF CERTIFICATE-MASTER TO
 10078         DFHEIV20
 10079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10080
 10081
 10082     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10083
 10084
 10085* EXEC CICS HANDLE CONDITION
 10086*         DUPKEY   (2040-EXIT)
 10087*    END-EXEC.
 10088*    MOVE '"$$                   ! - #00009324' TO DFHEIV0
 10089     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10090     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10091     MOVE X'2D20233030303039333234' TO DFHEIV0(25:11)
 10092     CALL 'kxdfhei1' USING DFHEIV0
 10093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10094
 10095
 10096
 10097* EXEC CICS REWRITE
 10098*         DATASET  (CERT-FILE-ID)
 10099*         FROM     (CERTIFICATE-MASTER)
 10100*    END-EXEC.
 10101     MOVE LENGTH OF
 10102      CERTIFICATE-MASTER
 10103       TO DFHEIV11
 10104*    MOVE '&& L                  %   #00009328' TO DFHEIV0
 10105     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10106     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10107     MOVE X'2020233030303039333238' TO DFHEIV0(25:11)
 10108     CALL 'kxdfhei1' USING DFHEIV0,
 10109           CERT-FILE-ID,
 10110           CERTIFICATE-MASTER,
 10111           DFHEIV11,
 10112           DFHEIV99
 10113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10114
 10115
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 188
* EL131.cbl
 10116 2040-EXIT.
 10117     EXIT.
 10118
 10119 2050-KEY-UPDATE.
 10120
 10121* EXEC CICS READ UPDATE
 10122*         DATASET  (CERT-FILE-ID)
 10123*         RIDFLD   (CERT-KEY)
 10124*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10125*    END-EXEC.
 10126*    MOVE '&"S        EU         (   #00009337' TO DFHEIV0
 10127     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10128     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10129     MOVE X'2020233030303039333337' TO DFHEIV0(25:11)
 10130     CALL 'kxdfhei1' USING DFHEIV0,
 10131           CERT-FILE-ID,
 10132           DFHEIV20,
 10133           DFHEIV99,
 10134           CERT-KEY,
 10135           DFHEIV99,
 10136           DFHEIV99,
 10137           DFHEIV99
 10138     SET ADDRESS OF CERTIFICATE-MASTER TO
 10139         DFHEIV20
 10140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10141
 10142
 10143     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10144
 10145
 10146* EXEC CICS DELETE
 10147*         DATASET   (CERT-FILE-ID)
 10148*    END-EXEC.
 10149*    MOVE '&(                    &   #00009345' TO DFHEIV0
 10150     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10151     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10152     MOVE X'2020233030303039333435' TO DFHEIV0(25:11)
 10153     CALL 'kxdfhei1' USING DFHEIV0,
 10154           CERT-FILE-ID,
 10155           DFHEIV99,
 10156           DFHEIV99,
 10157           DFHEIV99,
 10158           DFHEIV99
 10159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10160
 10161
 10162
 10163* EXEC CICS GETMAIN
 10164*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10165*         LENGTH    (CERT-LENGTH)
 10166*         INITIMG   (GETMAIN-SPACE)
 10167*    END-EXEC.
 10168*    MOVE ',"IL                  $   #00009349' TO DFHEIV0
 10169     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10170     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10171     MOVE X'2020233030303039333439' TO DFHEIV0(25:11)
 10172     CALL 'kxdfhei1' USING DFHEIV0,
 10173           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 189
* EL131.cbl
 10174           CERT-LENGTH,
 10175           GETMAIN-SPACE
 10176     SET ADDRESS OF CERTIFICATE-MASTER TO
 10177         DFHEIV20
 10178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10179
 10180
 10181     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 10182
 10183     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10184
 10185
 10186* EXEC CICS HANDLE CONDITION
 10187*         DUPKEY (2050-EXIT)
 10188*    END-EXEC.
 10189*    MOVE '"$$                   ! . #00009359' TO DFHEIV0
 10190     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10191     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10192     MOVE X'2E20233030303039333539' TO DFHEIV0(25:11)
 10193     CALL 'kxdfhei1' USING DFHEIV0
 10194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10195
 10196
 10197
 10198* EXEC CICS WRITE
 10199*         DATASET  (CERT-FILE-ID)
 10200*         RIDFLD   (CERT-KEY)
 10201*         FROM     (CERTIFICATE-MASTER)
 10202*    END-EXEC.
 10203     MOVE LENGTH OF
 10204      CERTIFICATE-MASTER
 10205       TO DFHEIV11
 10206*    MOVE '&$ L                  ''   #00009363' TO DFHEIV0
 10207     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10208     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10209     MOVE X'2020233030303039333633' TO DFHEIV0(25:11)
 10210     CALL 'kxdfhei1' USING DFHEIV0,
 10211           CERT-FILE-ID,
 10212           CERTIFICATE-MASTER,
 10213           DFHEIV11,
 10214           CERT-KEY,
 10215           DFHEIV99,
 10216           DFHEIV99
 10217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10218
 10219
 10220 2050-EXIT.
 10221     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 190
* EL131.cbl
 10223 2060-CHANGE-CERT.
 10224     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10225     MOVE PI-CARRIER             TO CERT-CARRIER.
 10226     MOVE PI-GROUPING            TO CERT-GROUP.
 10227     MOVE PI-STATE               TO CERT-STATE.
 10228     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10229     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10230     MOVE PI-CERT-NO             TO CERT-CERT.
 10231     IF CERTEFFI GREATER THAN LOW-VALUES
 10232         MOVE HOLD-EFF           TO CERT-DATE.
 10233     IF CERTACTI GREATER THAN LOW-VALUES
 10234         MOVE CERTACTI           TO CERT-ACCOUNT.
 10235     IF CERTSTI GREATER THAN LOW-VALUES
 10236         MOVE CERTSTI            TO CERT-STATE.
 10237     IF CERTCARI GREATER THAN LOW-VALUES
 10238         MOVE CERTCARI           TO CERT-CARRIER.
 10239     IF CERTGRPI GREATER THAN LOW-VALUES
 10240         MOVE CERTGRPI           TO CERT-GROUP.
 10241     IF CERTI GREATER THAN LOW-VALUES
 10242         MOVE CERTI              TO CERT-CERT-PRIME.
 10243     IF SUFXI GREATER THAN LOW-VALUES
 10244         MOVE SUFXI              TO CERT-CERT-SUFX.
 10245
 10246
 10247* EXEC CICS HANDLE CONDITION
 10248*         NOTFND   (2060-CERT-NOTFND)
 10249*    END-EXEC.
 10250*    MOVE '"$I                   ! / #00009395' TO DFHEIV0
 10251     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10252     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10253     MOVE X'2F20233030303039333935' TO DFHEIV0(25:11)
 10254     CALL 'kxdfhei1' USING DFHEIV0
 10255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10256
 10257
 10258
 10259* EXEC CICS READ UPDATE
 10260*         DATASET  (CERT-FILE-ID)
 10261*         RIDFLD   (CERT-KEY)
 10262*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10263*    END-EXEC.
 10264*    MOVE '&"S        EU         (   #00009399' TO DFHEIV0
 10265     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10266     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10267     MOVE X'2020233030303039333939' TO DFHEIV0(25:11)
 10268     CALL 'kxdfhei1' USING DFHEIV0,
 10269           CERT-FILE-ID,
 10270           DFHEIV20,
 10271           DFHEIV99,
 10272           CERT-KEY,
 10273           DFHEIV99,
 10274           DFHEIV99,
 10275           DFHEIV99
 10276     SET ADDRESS OF CERTIFICATE-MASTER TO
 10277         DFHEIV20
 10278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10279
 10280
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 191
* EL131.cbl
 10281     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 10282
 10283     IF CM-CLAIM-INTERFACE-SW = SPACES
 10284        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10285
 10286
 10287* EXEC CICS HANDLE CONDITION
 10288*         DUPKEY   (2060-DUPKEY)
 10289*    END-EXEC.
 10290*    MOVE '"$$                   ! 0 #00009410' TO DFHEIV0
 10291     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10292     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10293     MOVE X'3020233030303039343130' TO DFHEIV0(25:11)
 10294     CALL 'kxdfhei1' USING DFHEIV0
 10295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10296
 10297
 10298
 10299* EXEC CICS REWRITE
 10300*         DATASET  (CERT-FILE-ID)
 10301*         FROM     (CERTIFICATE-MASTER)
 10302*    END-EXEC.
 10303     MOVE LENGTH OF
 10304      CERTIFICATE-MASTER
 10305       TO DFHEIV11
 10306*    MOVE '&& L                  %   #00009414' TO DFHEIV0
 10307     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10308     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10309     MOVE X'2020233030303039343134' TO DFHEIV0(25:11)
 10310     CALL 'kxdfhei1' USING DFHEIV0,
 10311           CERT-FILE-ID,
 10312           CERTIFICATE-MASTER,
 10313           DFHEIV11,
 10314           DFHEIV99
 10315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10316
 10317
 10318 2060-DUPKEY.
 10319
 10320     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10321
 10322 2060-CHANGE-TRLR-ACTQ.
 10323     IF SCREEN-ERROR
 10324         GO TO 2060-EXIT.
 10325
 10326     IF CERTI    GREATER LOW-VALUES OR
 10327        SUFXI    GREATER LOW-VALUES OR
 10328        CERTCARI GREATER LOW-VALUES
 10329         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 10330         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 10331
 10332     MOVE SPACES                 TO CERT-KEY-SWITCH
 10333                                    CERT-SWITCH
 10334                                    TRLR-SWITCH
 10335                                    NINETY-TRLR-SWITCH.
 10336     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 10337     GO TO 2060-EXIT.
 10338
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 192
* EL131.cbl
 10339 2060-CERT-NOTFND.
 10340     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10341
 10342     IF WS-REC-FOUND-SW = 'N'
 10343         MOVE ER-0206            TO  EMI-ERROR
 10344         MOVE -1                 TO  MAINTL
 10345         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10346
 10347* EXEC CICS UNLOCK
 10348*            DATASET   (CLMS-FILE-ID)
 10349*        END-EXEC
 10350*    MOVE '&*                    #   #00009447' TO DFHEIV0
 10351     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10352     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10353     MOVE X'2020233030303039343437' TO DFHEIV0(25:11)
 10354     CALL 'kxdfhei1' USING DFHEIV0,
 10355           CLMS-FILE-ID,
 10356           DFHEIV99
 10357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10358         GO TO 8110-SEND-DATA.
 10359
 10360     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 10361
 10362     GO TO 2060-CHANGE-TRLR-ACTQ.
 10363
 10364 2060-EXIT.
 10365     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 193
* EL131.cbl
 10367 2070-CHECK-OLD.
 10368
 10369
 10370* EXEC CICS HANDLE CONDITION
 10371*        NOTFND   (2070-NOT-FOUND)
 10372*    END-EXEC.
 10373*    MOVE '"$I                   ! 1 #00009461' TO DFHEIV0
 10374     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10375     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10376     MOVE X'3120233030303039343631' TO DFHEIV0(25:11)
 10377     CALL 'kxdfhei1' USING DFHEIV0
 10378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10379
 10380
 10381     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10382     MOVE PI-CARRIER             TO CERT-CARRIER.
 10383     MOVE PI-GROUPING            TO CERT-GROUP.
 10384     MOVE PI-STATE               TO CERT-STATE.
 10385     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10386     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10387     MOVE PI-CERT-NO             TO CERT-CERT.
 10388
 10389
 10390* EXEC CICS READ UPDATE
 10391*         DATASET  (CERT-FILE-ID)
 10392*         RIDFLD   (CERT-KEY)
 10393*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10394*    END-EXEC.
 10395*    MOVE '&"S        EU         (   #00009473' TO DFHEIV0
 10396     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10397     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10398     MOVE X'2020233030303039343733' TO DFHEIV0(25:11)
 10399     CALL 'kxdfhei1' USING DFHEIV0,
 10400           CERT-FILE-ID,
 10401           DFHEIV20,
 10402           DFHEIV99,
 10403           CERT-KEY,
 10404           DFHEIV99,
 10405           DFHEIV99,
 10406           DFHEIV99
 10407     SET ADDRESS OF CERTIFICATE-MASTER TO
 10408         DFHEIV20
 10409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10410
 10411
 10412     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 10413     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 10414     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 10415
 10416     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 10417         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 10418
 10419     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10420       AND
 10421        CERT-WAS-CREATED-FOR-CLAIM
 10422         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 10423
 10424* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 194
* EL131.cbl
 10425*             DATASET   (CERT-FILE-ID)
 10426*        END-EXEC
 10427*    MOVE '&(                    &   #00009490' TO DFHEIV0
 10428     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10429     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10430     MOVE X'2020233030303039343930' TO DFHEIV0(25:11)
 10431     CALL 'kxdfhei1' USING DFHEIV0,
 10432           CERT-FILE-ID,
 10433           DFHEIV99,
 10434           DFHEIV99,
 10435           DFHEIV99,
 10436           DFHEIV99
 10437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10438         GO TO 2070-EXIT.
 10439
 10440     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10441         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10442
 10443
 10444* EXEC CICS HANDLE CONDITION
 10445*         DUPKEY   (2070-EXIT)
 10446*    END-EXEC.
 10447*    MOVE '"$$                   ! 2 #00009498' TO DFHEIV0
 10448     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10449     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10450     MOVE X'3220233030303039343938' TO DFHEIV0(25:11)
 10451     CALL 'kxdfhei1' USING DFHEIV0
 10452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10453
 10454
 10455
 10456* EXEC CICS REWRITE
 10457*         DATASET  (CERT-FILE-ID)
 10458*         FROM     (CERTIFICATE-MASTER)
 10459*    END-EXEC.
 10460     MOVE LENGTH OF
 10461      CERTIFICATE-MASTER
 10462       TO DFHEIV11
 10463*    MOVE '&& L                  %   #00009502' TO DFHEIV0
 10464     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10465     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10466     MOVE X'2020233030303039353032' TO DFHEIV0(25:11)
 10467     CALL 'kxdfhei1' USING DFHEIV0,
 10468           CERT-FILE-ID,
 10469           CERTIFICATE-MASTER,
 10470           DFHEIV11,
 10471           DFHEIV99
 10472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10473
 10474
 10475     GO TO 2070-EXIT.
 10476
 10477 2070-NOT-FOUND.
 10478     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 10479
 10480 2070-EXIT.
 10481     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 195
* EL131.cbl
 10483 2080-CREATE-CERT.
 10484
 10485* EXEC CICS GETMAIN
 10486*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10487*         LENGTH    (CERT-LENGTH)
 10488*         INITIMG   (GETMAIN-SPACE)
 10489*    END-EXEC.
 10490*    MOVE ',"IL                  $   #00009516' TO DFHEIV0
 10491     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10492     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10493     MOVE X'2020233030303039353136' TO DFHEIV0(25:11)
 10494     CALL 'kxdfhei1' USING DFHEIV0,
 10495           DFHEIV20,
 10496           CERT-LENGTH,
 10497           GETMAIN-SPACE
 10498     SET ADDRESS OF CERTIFICATE-MASTER TO
 10499         DFHEIV20
 10500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10501
 10502
 10503     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 10504
 10505     IF CERTEFFI GREATER THAN LOW-VALUES
 10506         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 10507                                    DC-BIN-DATE-1
 10508         MOVE '6'                TO DC-OPTION-CODE
 10509         MOVE +1                 TO DC-ELAPSED-MONTHS
 10510         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10511         IF NO-CONVERSION-ERROR
 10512             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 10513
 10514     IF CERTACTI GREATER THAN LOW-VALUES
 10515         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 10516     IF CERTSTI GREATER THAN LOW-VALUES
 10517         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 10518     IF CERTCARI GREATER THAN LOW-VALUES
 10519         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 10520     IF CERTGRPI GREATER THAN LOW-VALUES
 10521         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 10522     IF CERTI GREATER THAN LOW-VALUES
 10523         MOVE CERTI              TO CERT-CERT-PRIME
 10524                                    CM-CERT-PRIME
 10525         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10526
 10527     IF SUFXI GREATER THAN LOW-VALUES
 10528         MOVE SUFXI              TO CERT-CERT-SUFX
 10529                                    CM-CERT-SFX
 10530         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10531
 10532     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10533
 10534     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10535
 10536     MOVE SPACES                 TO CM-ENTRY-BATCH
 10537                                    CM-LF-EXIT-BATCH
 10538                                    CM-AH-EXIT-BATCH
 10539                                    CM-CREDIT-INTERFACE-SW-1
 10540                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 196
* EL131.cbl
 10541
 10542     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10543                               '9' OR 'D' OR 'V'
 10544         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10545
 10546     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10547                               '9' OR 'D' OR 'V'
 10548         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10549
 10550     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 10551                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 10552     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 10553
 10554
 10555* EXEC CICS HANDLE CONDITION
 10556*         DUPKEY (2080-EXIT)
 10557*    END-EXEC.
 10558*    MOVE '"$$                   ! 3 #00009573' TO DFHEIV0
 10559     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10561     MOVE X'3320233030303039353733' TO DFHEIV0(25:11)
 10562     CALL 'kxdfhei1' USING DFHEIV0
 10563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10564
 10565
 10566
 10567* EXEC CICS WRITE
 10568*         DATASET  (CERT-FILE-ID)
 10569*         RIDFLD   (CERT-KEY)
 10570*         FROM     (CERTIFICATE-MASTER)
 10571*    END-EXEC.
 10572     MOVE LENGTH OF
 10573      CERTIFICATE-MASTER
 10574       TO DFHEIV11
 10575*    MOVE '&$ L                  ''   #00009577' TO DFHEIV0
 10576     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10577     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10578     MOVE X'2020233030303039353737' TO DFHEIV0(25:11)
 10579     CALL 'kxdfhei1' USING DFHEIV0,
 10580           CERT-FILE-ID,
 10581           CERTIFICATE-MASTER,
 10582           DFHEIV11,
 10583           CERT-KEY,
 10584           DFHEIV99,
 10585           DFHEIV99
 10586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10587
 10588
 10589 2080-EXIT.
 10590     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 197
* EL131.cbl
 10592 2100-MOVE-MSTR.
 10593     IF TYPEI GREATER THAN LOW-VALUES
 10594         MOVE TYPEI              TO CL-CLAIM-TYPE.
 10595
 10596     IF STATUSI = LOW-VALUES
 10597         GO TO 2100-NO-STATUS-CHANGE.
 10598
 10599     IF STATUSI = 'OPEN' OR 'O'
 10600         IF CL-CLAIM-STATUS = 'O'
 10601             MOVE SPACES         TO TRLR-SWITCH
 10602                 GO TO 2100-NO-STATUS-CHANGE.
 10603
 10604     IF STATUSI = 'CLOSED' OR 'C'
 10605         IF CL-CLAIM-STATUS = 'C'
 10606             MOVE SPACES         TO TRLR-SWITCH
 10607                 GO TO 2100-NO-STATUS-CHANGE.
 10608
 10609     IF PI-COMPANY-ID = 'DMD'
 10610        IF STATUSI = 'OPEN' OR 'O'
 10611           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 10612              MOVE ZERO       TO STATUSL
 10613              MOVE LOW-VALUES TO STATUSI
 10614              GO TO 2100-NO-STATUS-CHANGE.
 10615
 10616     IF PI-COMPANY-ID = 'DMD'
 10617         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 10618
 10619     MOVE STATUSI                TO CL-CLAIM-STATUS.
 10620
 10621 2100-NO-STATUS-CHANGE.
 10622
 10623     IF CCNOI GREATER THAN LOW-VALUES
 10624         MOVE CCNOI              TO CL-CCN.
 10625
 10626     IF PROCI GREATER THAN LOW-VALUES
 10627         MOVE PROCI              TO CL-PROCESSOR-ID.
 10628
 10629     if accswi > low-values
 10630        and accswi = 'Y' OR 'N'
 10631        move accswi              to cl-accident-claim-sw
 10632     end-if
 10633     IF SEXI GREATER THAN LOW-VALUES
 10634         MOVE SEXI               TO CL-INSURED-SEX-CD.
 10635
 10636     IF BIRTHI GREATER THAN LOW-VALUES
 10637         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 10638
 10639     IF SOCIALI GREATER THAN LOW-VALUES
 10640       AND
 10641        SOCIALI = SPACES
 10642         MOVE CL-CERT-STATE      TO CL-SSN-STATE
 10643         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 10644         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 10645     ELSE
 10646         IF SOCIALI GREATER THAN LOW-VALUES
 10647             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 10648
 10649     IF OCCI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 198
* EL131.cbl
 10650         MOVE OCCI               TO CL-INSURED-OCC-CD.
 10651
 10652     IF BENEL GREATER THAN ZERO
 10653         MOVE BENEI              TO CL-BENEFICIARY.
 10654
 10655     IF DIAGI GREATER THAN LOW-VALUES
 10656         MOVE DIAGI              TO WS-DIAGNOSIS.
 10657
 10658     IF PREMTYPI GREATER THAN LOW-VALUES
 10659         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 10660
 10661     IF CAUSEI GREATER THAN LOW-VALUES
 10662         MOVE CAUSEI             TO CL-CAUSE-CD.
 10663
 10664     IF ENDI GREATER THAN LOW-VALUES
 10665         MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 10666
 10667     IF PDTHRUI GREATER THAN LOW-VALUES
 10668        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 10669
 10670     IF PDAMTL GREATER THAN +0
 10671        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 10672
 10673     IF NODAYSI GREATER THAN LOW-VALUES
 10674        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 10675
 10676     IF NOPMTSI GREATER THAN LOW-VALUES
 10677        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 10678
 10679     IF FORMTYPI GREATER THAN LOW-VALUES
 10680        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 10681
 10682     IF INCI GREATER THAN LOW-VALUES
 10683        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 10684
 10685     IF REPI GREATER THAN LOW-VALUES
 10686        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 10687
 10688     IF ADDONDTI GREATER THAN LOW-VALUES
 10689        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 10690
 10691     IF PRICDI GREATER THAN LOW-VALUES
 10692         MOVE PRICDI             TO CL-PRIORITY-CD.
 10693
 10694     IF CRITPTL > ZEROS
 10695        MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 10696     END-IF
 10697
 10698     IF RTWMOSL > ZEROS
 10699        MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 10700     END-IF
 10701     IF FILETOI GREATER THAN LOW-VALUES
 10702         MOVE FILETOI            TO CL-FILE-LOCATION.
 10703
 10704     IF SUPVI GREATER THAN LOW-VALUES
 10705         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 10706
 10707     IF MLNAMEI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 199
* EL131.cbl
 10708         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 10709
 10710     IF MFNAMEI GREATER THAN LOW-VALUES
 10711         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 10712
 10713     IF MMINITI GREATER THAN LOW-VALUES
 10714         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 10715
 10716     IF CERTEFFI GREATER THAN LOW-VALUES
 10717         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 10718
 10719     IF CERTACTI GREATER THAN LOW-VALUES
 10720         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 10721
 10722     IF CERTSTI GREATER THAN LOW-VALUES
 10723         MOVE CERTSTI            TO CL-CERT-STATE.
 10724
 10725     IF CERTCARI GREATER THAN LOW-VALUES
 10726         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 10727                                    CL-CARRIER.
 10728
 10729     IF CERTGRPI GREATER THAN LOW-VALUES
 10730         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 10731
 10732     IF CERTI GREATER THAN LOW-VALUES
 10733         MOVE CERTI              TO CERT-NO-PRIME.
 10734
 10735     IF SUFXI GREATER THAN LOW-VALUES
 10736         MOVE SUFXI              TO CERT-NO-SUFX.
 10737
 10738     MOVE CERT-NO                TO CL-CERT-NO
 10739                                    CL-CERT-NO-A4.
 10740
 10741     IF PI-COMPANY-ID = 'FLA'
 10742          NEXT SENTENCE
 10743     ELSE
 10744         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 10745         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 10746         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 10747         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 10748
 10749     IF TRLR-UPDATE-REQUIRED
 10750        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 10751        MOVE ZEROS              TO TRLR-SEQ-NO
 10752
 10753* EXEC CICS READ
 10754*            DATASET   (TRLR-FILE-ID)
 10755*            RIDFLD    (TRLR-KEY)
 10756*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10757*       END-EXEC
 10758*    MOVE '&"S        E          (   #00009746' TO DFHEIV0
 10759     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10760     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10761     MOVE X'2020233030303039373436' TO DFHEIV0(25:11)
 10762     CALL 'kxdfhei1' USING DFHEIV0,
 10763           TRLR-FILE-ID,
 10764           DFHEIV20,
 10765           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 200
* EL131.cbl
 10766           TRLR-KEY,
 10767           DFHEIV99,
 10768           DFHEIV99,
 10769           DFHEIV99
 10770     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10771         DFHEIV20
 10772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10773        IF AT-TRAILER-TYPE = '1'
 10774           MOVE +1 TO MISC-SUB
 10775           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 10776           MISC-SUB GREATER THAN +6 OR
 10777           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 10778           IF MISC-SUB GREATER THAN +1
 10779              SUBTRACT +1 FROM MISC-SUB
 10780              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10781                 GO TO 2100-BYPASS-LAST-UPDATE.
 10782
 10783     IF TRLR-UPDATE-REQUIRED AND
 10784        CLAIM-IS-OPEN
 10785         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 10786     ELSE
 10787         IF TRLR-UPDATE-REQUIRED AND
 10788            CLAIM-IS-CLOSED
 10789             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 10790             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 10791
 10792 2100-BYPASS-LAST-UPDATE.
 10793     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10794     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 10795
 10796     GO TO 2100-EXIT.
 10797
 10798 2100-BUMP-OPEN-CLOSE-HIST.
 10799     ADD +1                      TO MISC-SUB.
 10800
 10801 2100-EXIT.
 10802     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 201
* EL131.cbl
 10804 2120-check-pdef.
 10805
 10806
 10807     move +0                     to s1
 10808     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 10809     move spaces                 to ws-dcc-error-line
 10810     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 10811     IF ERPDEF-FOUND
 10812        perform 2130-check-trlr  thru 2130-exit
 10813        move +1                  to s1
 10814*       if cl-accident-claim-sw = ' '
 10815*          move er-1655             to ws-error-no (s1)
 10816*          add +1 to s1
 10817*       end-if
 10818        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 10819        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 10820        MOVE '1'                 TO DC-OPTION-CODE
 10821        MOVE +0                  TO DC-ELAPSED-MONTHS
 10822                                    DC-ELAPSED-DAYS
 10823        PERFORM 9800-CONVERT-DATE
 10824                                 THRU 9800-EXIT
 10825        IF NO-CONVERSION-ERROR
 10826           MOVE DC-ELAPSED-MONTHS
 10827                                 TO WS-MONTHS-BETWEEN
 10828           IF DC-ELAPSED-DAYS > 1
 10829              ADD 1 TO WS-MONTHS-BETWEEN
 10830           END-IF
 10831        ELSE
 10832           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 10833        END-IF
 10834        IF (WS-EXCL-PERIOD = ZEROS)
 10835           OR (WS-MONTHS-BETWEEN = ZEROS)
 10836           CONTINUE
 10837        ELSE
 10838           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 10839              MOVE ER-1651       TO ws-error-no (s1)
 10840              add +1             to s1
 10841           END-IF
 10842        END-IF
 10843        IF (WS-COV-ENDS = ZEROS)
 10844           OR (WS-MONTHS-BETWEEN = ZEROS)
 10845           CONTINUE
 10846        ELSE
 10847           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 10848              MOVE -1            TO MAINTL
 10849              MOVE ER-1653       TO ws-error-no (s1)
 10850              add +1 to s1
 10851           END-IF
 10852        END-IF
 10853        IF (WS-ACC-PERIOD = ZEROS)
 10854           OR (WS-MONTHS-BETWEEN = ZEROS)
 10855           CONTINUE
 10856        ELSE
 10857           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
 10858              and (cl-accident-claim-sw = ' ')
 10859              move er-1655       to ws-error-no (s1)
 10860              add +1             to s1
 10861           end-if
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 202
* EL131.cbl
 10862           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 10863              if cl-accident-claim-sw not = 'Y'
 10864                 MOVE ER-1652    TO ws-error-no (s1)
 10865              else
 10866                 move er-1662    to ws-error-no (s1)
 10867              end-if
 10868              MOVE -1            TO MAINTL
 10869              add +1             to s1
 10870           END-IF
 10871        END-IF
 10872        if cl-claim-type  = 'I'
 10873           move er-1661          to ws-error-no (s1)
 10874           add +1                to s1
 10875        end-if
 10876        perform 2130-check-trlr  thru 2130-exit
 10877     END-IF
 10878
 10879     .
 10880 2120-exit.
 10881     exit.
 10882
 10883 2130-check-trlr.
 10884
 10885     evaluate true
 10886        when s1 = +0
 10887           move cl-control-primary
 10888                                 to trlr-key
 10889           MOVE +95              TO TRLR-SEQ-NO
 10890
 10891* EXEC CICS READ
 10892*             update
 10893*             DATASET  ('ELTRLR')
 10894*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10895*             RIDFLD   (TRLR-KEY)
 10896*             RESP     (WS-RESPONSE)
 10897*          END-EXEC
 10898     MOVE 'ELTRLR' TO DFHEIV1
 10899*    MOVE '&"S        EU         (  N#00009868' TO DFHEIV0
 10900     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10901     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10902     MOVE X'204E233030303039383638' TO DFHEIV0(25:11)
 10903     CALL 'kxdfhei1' USING DFHEIV0,
 10904           DFHEIV1,
 10905           DFHEIV20,
 10906           DFHEIV99,
 10907           TRLR-KEY,
 10908           DFHEIV99,
 10909           DFHEIV99,
 10910           DFHEIV99
 10911     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10912         DFHEIV20
 10913     MOVE EIBRESP  TO WS-RESPONSE
 10914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10915           if ws-resp-normal
 10916              move spaces        to at-info-line-1
 10917           end-if
 10918        when s1 = +1
 10919           if ws-resp-normal
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 203
* EL131.cbl
 10920
 10921* exec cics rewrite
 10922*                dataset   ('ELTRLR')
 10923*                from      (activity-trailers)
 10924*             end-exec
 10925     MOVE LENGTH OF
 10926      activity-trailers
 10927       TO DFHEIV11
 10928     MOVE 'ELTRLR' TO DFHEIV1
 10929*    MOVE '&& L                  %   #00009880' TO DFHEIV0
 10930     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10931     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10932     MOVE X'2020233030303039383830' TO DFHEIV0(25:11)
 10933     CALL 'kxdfhei1' USING DFHEIV0,
 10934           DFHEIV1,
 10935           activity-trailers,
 10936           DFHEIV11,
 10937           DFHEIV99
 10938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10939           end-if
 10940        when s1 > +1
 10941           if ws-resp-normal
 10942              move ws-dcc-error-line
 10943                                 to at-info-line-1
 10944
 10945* exec cics rewrite
 10946*                dataset   ('ELTRLR')
 10947*                from      (activity-trailers)
 10948*             end-exec
 10949     MOVE LENGTH OF
 10950      activity-trailers
 10951       TO DFHEIV11
 10952     MOVE 'ELTRLR' TO DFHEIV1
 10953*    MOVE '&& L                  %   #00009889' TO DFHEIV0
 10954     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10955     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10956     MOVE X'2020233030303039383839' TO DFHEIV0(25:11)
 10957     CALL 'kxdfhei1' USING DFHEIV0,
 10958           DFHEIV1,
 10959           activity-trailers,
 10960           DFHEIV11,
 10961           DFHEIV99
 10962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10963           else
 10964
 10965* EXEC CICS GETMAIN
 10966*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10967*                LENGTH   (TRLR-LENGTH)
 10968*                INITIMG  (GETMAIN-SPACE)
 10969*             END-EXEC
 10970*    MOVE ',"IL                  $   #00009894' TO DFHEIV0
 10971     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10972     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10973     MOVE X'2020233030303039383934' TO DFHEIV0(25:11)
 10974     CALL 'kxdfhei1' USING DFHEIV0,
 10975           DFHEIV20,
 10976           TRLR-LENGTH,
 10977           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 204
* EL131.cbl
 10978     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10979         DFHEIV20
 10980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10981              move 'AT'          to at-record-id
 10982              move cl-control-primary
 10983                                 to at-control-primary
 10984              move +95           to at-sequence-no
 10985              move '6'           to at-trailer-type
 10986              move ws-dcc-error-line
 10987                                 to at-info-line-1
 10988              move 'E'           to at-info-trailer-type
 10989              move save-bin-date to at-recorded-dt
 10990                                    at-gen-info-last-maint-dt
 10991              move pi-processor-id
 10992                                 to at-recorded-by
 10993                                    at-gen-info-last-updated-by
 10994              move eibtime       to at-last-maint-hhmmss
 10995
 10996* exec cics write
 10997*                dataset   ('ELTRLR')
 10998*                from      (activity-trailers)
 10999*                ridfld    (trlr-key)
 11000*             end-exec
 11001     MOVE LENGTH OF
 11002      activity-trailers
 11003       TO DFHEIV11
 11004     MOVE 'ELTRLR' TO DFHEIV1
 11005*    MOVE '&$ L                  ''   #00009913' TO DFHEIV0
 11006     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11007     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11008     MOVE X'2020233030303039393133' TO DFHEIV0(25:11)
 11009     CALL 'kxdfhei1' USING DFHEIV0,
 11010           DFHEIV1,
 11011           activity-trailers,
 11012           DFHEIV11,
 11013           trlr-key,
 11014           DFHEIV99,
 11015           DFHEIV99
 11016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11017              perform varying s1 from +1 by +1 until
 11018                 ws-error-no (s1) = spaces
 11019                 move ws-error-no (s1)
 11020                                 to emi-error
 11021                 PERFORM 9900-ERROR-FORMAT
 11022                                 THRU 9900-EXIT
 11023              end-perform
 11024           end-if
 11025     end-evaluate
 11026
 11027     .
 11028 2130-exit.
 11029     exit.
 11030 2200-MOVE-CERT.
 11031     IF CRTLNMEI GREATER THAN LOW-VALUES
 11032         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 11033
 11034     IF CRTFNMEI GREATER THAN LOW-VALUES
 11035         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 205
* EL131.cbl
 11036         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 11037
 11038     IF CRTINITI GREATER THAN LOW-VALUES
 11039         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 11040
 11041     IF CM-INSURED-INITIALS = SPACES
 11042         MOVE '**'               TO CM-INSURED-INITIALS.
 11043
 11044     IF ISSAGEI GREATER THAN LOW-VALUES
 11045         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 11046
 11047     IF JNTFNMEI GREATER THAN LOW-VALUES
 11048         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 11049
 11050     IF JNTLNMEI GREATER THAN LOW-VALUES
 11051         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 11052
 11053     IF JNTINITI GREATER THAN LOW-VALUES
 11054         MOVE JNTINITI           TO CM-JT-INITIAL.
 11055
 11056     IF JNTAGEI GREATER THAN LOW-VALUES
 11057         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 11058
 11059     IF ADDONDTI GREATER THAN LOW-VALUES
 11060        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 11061
 11062     IF LCVCDI GREATER THAN LOW-VALUES
 11063        IF LCVCDI = SPACES OR ZEROS
 11064           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 11065        ELSE
 11066           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 11067
 11068     IF LCVOTRMI GREATER THAN LOW-VALUES
 11069         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 11070
 11071     IF LCVRATEL GREATER THAN +0
 11072         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 11073
 11074     IF LCVBENEL GREATER THAN +0
 11075         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 11076
 11077     IF LCVFORMI GREATER THAN LOW-VALUES
 11078         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 11079
 11080     IF LCVCNDTI = LOW-VALUES
 11081        GO TO 2210-SET-STATUS.
 11082
 11083     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 11084        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 11085        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 11086        GO TO 2210-SET-STATUS.
 11087
 11088     IF CM-LF-CURRENT-STATUS = '7'
 11089        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 11090        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 11091        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11092                                    CM-LF-DEATH-DT
 11093        GO TO 2210-SET-STATUS.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 206
* EL131.cbl
 11094
 11095     IF CM-LF-CURRENT-STATUS = '8'
 11096        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 11097        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11098                                    CM-LF-CANCEL-DT.
 11099
 11100 2210-SET-STATUS.
 11101
 11102     IF CM-LF-CURRENT-STATUS = SPACES
 11103         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11104
 11105     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 11106         MOVE '6'                TO DC-OPTION-CODE
 11107         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11108         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11109         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11110         IF NO-CONVERSION-ERROR
 11111             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 11112         ELSE
 11113             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 11114     ELSE
 11115         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 11116
 11117 2215-PROCESS-AH-SIDE.
 11118
 11119     IF ACVCDI GREATER THAN LOW-VALUES
 11120        IF ACVCDI = SPACES OR ZEROS
 11121           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 11122        ELSE
 11123           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 11124
 11125     IF ACVOTRMI GREATER THAN LOW-VALUES
 11126         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 11127
 11128     IF ACVRATEL GREATER THAN +0
 11129         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 11130
 11131     IF ACVBENEL GREATER THAN +0
 11132         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
 11133                                    PI-PAYMENT-AMT.
 11134
 11135     IF ACVFORMI GREATER THAN LOW-VALUES
 11136         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 11137
 11138     IF ACVCNDTI = LOW-VALUES
 11139        GO TO 2220-SET-STATUS.
 11140
 11141     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 11142        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 11143        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 11144        GO TO 2220-SET-STATUS.
 11145
 11146     IF CM-AH-CURRENT-STATUS = '6'
 11147        MOVE CM-AH-STATUS-AT-SETTLEMENT
 11148                                 TO CM-AH-CURRENT-STATUS
 11149        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 11150        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11151                                    CM-AH-SETTLEMENT-DT
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 207
* EL131.cbl
 11152        GO TO 2220-SET-STATUS.
 11153
 11154     IF CM-AH-CURRENT-STATUS = '8'
 11155        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 11156        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11157                                    CM-AH-CANCEL-DT.
 11158
 11159 2220-SET-STATUS.
 11160     IF CM-AH-CURRENT-STATUS = SPACES
 11161         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11162
 11163     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 11164         MOVE '6'                TO DC-OPTION-CODE
 11165         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11166         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11167         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11168         IF NO-CONVERSION-ERROR
 11169             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 11170         ELSE
 11171             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 11172     ELSE
 11173         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 11174
 11175 2225-FINISH-CERT.
 11176     IF APRL GREATER THAN +0
 11177         MOVE HOLD-APR           TO CM-LOAN-APR.
 11178
 11179     IF PMTFREQI GREATER THAN LOW-VALUES
 11180         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 11181
 11182     IF INDGRPI GREATER THAN LOW-VALUES
 11183         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 11184
 11185     IF LOANNOI GREATER THAN LOW-VALUES
 11186        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 11187
 11188     IF LOANBALL GREATER THAN +0
 11189        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 11190
 11191     IF PREMTYPI GREATER THAN LOW-VALUES
 11192         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 11193
 11194     IF REINCDI GREATER THAN LOW-VALUES
 11195         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 11196                                    WS-REIN-1
 11197                                    WS-REIN-2
 11198                                    WS-REIN-3
 11199         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 11200
 11201     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 11202
 11203     MOVE ZEROS                  TO CM-LOAN-TERM
 11204                                    CM-LIFE-COMM-PCT
 11205                                    CM-AH-COMM-PCT.
 11206
 11207*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 11208*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 11209*         PI-NO-PMTS = ZEROS
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 208
* EL131.cbl
 11210*          IF LOANBALL GREATER THAN +0          OR
 11211*             ACVBENEL GREATER THAN +0          OR
 11212*             APRL     GREATER THAN +0          OR
 11213*             LCVRATEL GREATER THAN +0          OR
 11214*             ACVRATEL GREATER THAN +0
 11215*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 11216
 11217 2200-EXIT.
 11218     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 209
* EL131.cbl
 11220 2300-UPDATE-TRLR.
 11221     MOVE ZERO                   TO TRLR-SEQ-NO.
 11222
 11223* EXEC CICS READ UPDATE
 11224*         DATASET  (TRLR-FILE-ID)
 11225*         RIDFLD   (TRLR-KEY)
 11226*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11227*    END-EXEC.
 11228*    MOVE '&"S        EU         (   #00010123' TO DFHEIV0
 11229     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11230     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11231     MOVE X'2020233030303130313233' TO DFHEIV0(25:11)
 11232     CALL 'kxdfhei1' USING DFHEIV0,
 11233           TRLR-FILE-ID,
 11234           DFHEIV20,
 11235           DFHEIV99,
 11236           TRLR-KEY,
 11237           DFHEIV99,
 11238           DFHEIV99,
 11239           DFHEIV99
 11240     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11241         DFHEIV20
 11242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11243
 11244
 11245     MOVE ZERO                   TO COUNT-2.
 11246
 11247     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11248         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11249
 11250     IF NOT UPDATE-MADE
 11251         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11252
 11253
 11254* EXEC CICS REWRITE
 11255*         DATASET  (TRLR-FILE-ID)
 11256*         FROM     (ACTIVITY-TRAILERS)
 11257*    END-EXEC.
 11258     MOVE LENGTH OF
 11259      ACTIVITY-TRAILERS
 11260       TO DFHEIV11
 11261*    MOVE '&& L                  %   #00010137' TO DFHEIV0
 11262     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11263     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11264     MOVE X'2020233030303130313337' TO DFHEIV0(25:11)
 11265     CALL 'kxdfhei1' USING DFHEIV0,
 11266           TRLR-FILE-ID,
 11267           ACTIVITY-TRAILERS,
 11268           DFHEIV11,
 11269           DFHEIV99
 11270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11271
 11272
 11273 2300-EXIT.
 11274     EXIT.
 11275
 11276 2310-INS-STATUS.
 11277     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 210
* EL131.cbl
 11278     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 11279         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 11280         MOVE 'Y'                TO TRLR-SWITCH.
 11281
 11282 2310-EXIT.
 11283     EXIT.
 11284
 11285 2320-SHIFT-STATUS.
 11286     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 11287        MOVE 6                   TO COUNT-2
 11288        GO TO 2320-EXIT.
 11289
 11290     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 11291     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 11292     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 11293     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 11294     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 11295     MOVE 6       TO COUNT-2.
 11296     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 11297
 11298 2320-EXIT.
 11299     EXIT.
 11300
 11301 2330-ADD-UPDATE.
 11302
 11303     IF COUNT-2 GREATER THAN 1
 11304        COMPUTE MISC-SUB = (COUNT-2 - 1)
 11305        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11306           GO TO 2330-EXIT.
 11307
 11308     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 11309                                   AT-RESERVES-LAST-MAINT-DT
 11310
 11311     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 11312     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 11313     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 11314     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 11315
 11316 2330-EXIT.
 11317     EXIT.
 11318
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 211
* EL131.cbl
 11320 2400-UPDATE-TRLR.
 11321
 11322* EXEC CICS HANDLE CONDITION
 11323*         NOTFND    (2400-TRLR-NOTFND)
 11324*         ENDFILE   (2410-EXIT)
 11325*    END-EXEC.
 11326*    MOVE '"$I''                  ! 4 #00010190' TO DFHEIV0
 11327     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11328     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11329     MOVE X'3420233030303130313930' TO DFHEIV0(25:11)
 11330     CALL 'kxdfhei1' USING DFHEIV0
 11331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11332
 11333
 11334
 11335* EXEC CICS STARTBR
 11336*        DATASET (TRLR-FILE-ID)
 11337*        RIDFLD  (TRLR-KEY)
 11338*    END-EXEC.
 11339     MOVE 0
 11340       TO DFHEIV11
 11341*    MOVE '&,         G          &   #00010195' TO DFHEIV0
 11342     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11343     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11344     MOVE X'2020233030303130313935' TO DFHEIV0(25:11)
 11345     CALL 'kxdfhei1' USING DFHEIV0,
 11346           TRLR-FILE-ID,
 11347           TRLR-KEY,
 11348           DFHEIV99,
 11349           DFHEIV11,
 11350           DFHEIV99
 11351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11352
 11353
 11354
 11355* EXEC CICS GETMAIN
 11356*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11357*         LENGTH    (TRLR-LENGTH)
 11358*         INITIMG   (GETMAIN-SPACE)
 11359*    END-EXEC.
 11360*    MOVE ',"IL                  $   #00010200' TO DFHEIV0
 11361     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11362     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11363     MOVE X'2020233030303130323030' TO DFHEIV0(25:11)
 11364     CALL 'kxdfhei1' USING DFHEIV0,
 11365           DFHEIV20,
 11366           TRLR-LENGTH,
 11367           GETMAIN-SPACE
 11368     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11369         DFHEIV20
 11370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11371
 11372
 11373     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 11374
 11375
 11376* EXEC CICS ENDBR
 11377*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 212
* EL131.cbl
 11378*    END-EXEC.
 11379     MOVE 0
 11380       TO DFHEIV11
 11381*    MOVE '&2                    $   #00010208' TO DFHEIV0
 11382     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11383     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11384     MOVE X'2020233030303130323038' TO DFHEIV0(25:11)
 11385     CALL 'kxdfhei1' USING DFHEIV0,
 11386           TRLR-FILE-ID,
 11387           DFHEIV11,
 11388           DFHEIV99
 11389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11390
 11391
 11392     GO TO 2400-EXIT.
 11393
 11394 2400-TRLR-NOTFND.
 11395     MOVE ER-0205                TO EMI-ERROR.
 11396     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11397     MOVE 'X'                    TO ERROR-SWITCH.
 11398
 11399 2400-EXIT.
 11400     EXIT.
 11401
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 213
* EL131.cbl
 11403 2410-CHANGE-TRLR.
 11404
 11405* EXEC CICS READNEXT
 11406*        DATASET (TRLR-FILE-ID)
 11407*        RIDFLD  (TRLR-KEY)
 11408*        INTO    (ACTIVITY-TRAILERS)
 11409*    END-EXEC.
 11410     MOVE LENGTH OF
 11411      ACTIVITY-TRAILERS
 11412       TO DFHEIV12
 11413     MOVE 0
 11414       TO DFHEIV11
 11415*    MOVE '&.IL                  )   #00010224' TO DFHEIV0
 11416     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11417     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11418     MOVE X'2020233030303130323234' TO DFHEIV0(25:11)
 11419     CALL 'kxdfhei1' USING DFHEIV0,
 11420           TRLR-FILE-ID,
 11421           ACTIVITY-TRAILERS,
 11422           DFHEIV12,
 11423           TRLR-KEY,
 11424           DFHEIV99,
 11425           DFHEIV11,
 11426           DFHEIV99,
 11427           DFHEIV99
 11428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11429
 11430
 11431     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 11432        GO TO 2410-CHANGE-TRLR.
 11433
 11434     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 11435                                    CHECK-KEY.
 11436
 11437     IF CHECK-KEY NOT = MSTR-KEY
 11438         GO TO 2410-EXIT.
 11439
 11440
 11441* EXEC CICS ENDBR
 11442*        DATASET (TRLR-FILE-ID)
 11443*    END-EXEC.
 11444     MOVE 0
 11445       TO DFHEIV11
 11446*    MOVE '&2                    $   #00010239' TO DFHEIV0
 11447     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11448     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11449     MOVE X'2020233030303130323339' TO DFHEIV0(25:11)
 11450     CALL 'kxdfhei1' USING DFHEIV0,
 11451           TRLR-FILE-ID,
 11452           DFHEIV11,
 11453           DFHEIV99
 11454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11455
 11456
 11457
 11458* EXEC CICS READ UPDATE
 11459*        DATASET (TRLR-FILE-ID)
 11460*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 214
* EL131.cbl
 11461*        INTO    (ACTIVITY-TRAILERS)
 11462*    END-EXEC.
 11463     MOVE LENGTH OF
 11464      ACTIVITY-TRAILERS
 11465       TO DFHEIV11
 11466*    MOVE '&"IL       EU         (   #00010243' TO DFHEIV0
 11467     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11468     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11469     MOVE X'2020233030303130323433' TO DFHEIV0(25:11)
 11470     CALL 'kxdfhei1' USING DFHEIV0,
 11471           TRLR-FILE-ID,
 11472           ACTIVITY-TRAILERS,
 11473           DFHEIV11,
 11474           TRLR-KEY,
 11475           DFHEIV99,
 11476           DFHEIV99,
 11477           DFHEIV99
 11478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11479
 11480
 11481
 11482* EXEC CICS DELETE
 11483*        DATASET (TRLR-FILE-ID)
 11484*    END-EXEC.
 11485*    MOVE '&(                    &   #00010249' TO DFHEIV0
 11486     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11487     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11488     MOVE X'2020233030303130323439' TO DFHEIV0(25:11)
 11489     CALL 'kxdfhei1' USING DFHEIV0,
 11490           TRLR-FILE-ID,
 11491           DFHEIV99,
 11492           DFHEIV99,
 11493           DFHEIV99,
 11494           DFHEIV99
 11495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11496
 11497
 11498     IF AT-SEQUENCE-NO = ZERO AND
 11499        TRLR-UPDATE-REQUIRED
 11500         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 11501
 11502     IF CERTI GREATER THAN LOW-VALUES
 11503        MOVE CERTI               TO AT-CERT-PRIME.
 11504
 11505     IF SUFXI GREATER THAN LOW-VALUES
 11506        MOVE SUFXI               TO AT-CERT-SFX.
 11507
 11508     IF CERTCARI GREATER THAN LOW-VALUES
 11509        MOVE CERTCARI            TO AT-CARRIER.
 11510
 11511     IF PAYMENT-TR
 11512        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 11513           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 11514              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 11515
 11516     IF CORRESPONDENCE-TR
 11517        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 11518           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 215
* EL131.cbl
 11519
 11520
 11521* EXEC CICS WRITE
 11522*         DATASET  (TRLR-FILE-ID)
 11523*         RIDFLD   (AT-CONTROL-PRIMARY)
 11524*         FROM     (ACTIVITY-TRAILERS)
 11525*    END-EXEC.
 11526     MOVE LENGTH OF
 11527      ACTIVITY-TRAILERS
 11528       TO DFHEIV11
 11529*    MOVE '&$ L                  ''   #00010275' TO DFHEIV0
 11530     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11531     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11532     MOVE X'2020233030303130323735' TO DFHEIV0(25:11)
 11533     CALL 'kxdfhei1' USING DFHEIV0,
 11534           TRLR-FILE-ID,
 11535           ACTIVITY-TRAILERS,
 11536           DFHEIV11,
 11537           AT-CONTROL-PRIMARY,
 11538           DFHEIV99,
 11539           DFHEIV99
 11540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11541
 11542
 11543
 11544* EXEC CICS STARTBR
 11545*         DATASET  (TRLR-FILE-ID)
 11546*         RIDFLD   (TRLR-KEY)
 11547*    END-EXEC.
 11548     MOVE 0
 11549       TO DFHEIV11
 11550*    MOVE '&,         G          &   #00010281' TO DFHEIV0
 11551     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11552     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11553     MOVE X'2020233030303130323831' TO DFHEIV0(25:11)
 11554     CALL 'kxdfhei1' USING DFHEIV0,
 11555           TRLR-FILE-ID,
 11556           TRLR-KEY,
 11557           DFHEIV99,
 11558           DFHEIV11,
 11559           DFHEIV99
 11560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11561
 11562
 11563     GO TO 2410-CHANGE-TRLR.
 11564
 11565 2410-EXIT.
 11566     EXIT.
 11567
 11568 2420-UPDATE-TRLR.
 11569     MOVE ZERO TO COUNT-2.
 11570     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11571         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11572
 11573     IF NOT UPDATE-MADE
 11574         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11575
 11576 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 216
* EL131.cbl
 11577     EXIT.
 11578
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 217
* EL131.cbl
 11580 2425-UPDATE-NINETY-TRLR.
 11581
 11582     MOVE +90                    TO TRLR-SEQ-NO.
 11583
 11584
 11585* EXEC CICS HANDLE CONDITION
 11586*         NOTFND    (2425-NINETY-NOTFND)
 11587*         ENDFILE   (2425-NINETY-NOTFND)
 11588*    END-EXEC.
 11589*    MOVE '"$I''                  ! 5 #00010307' TO DFHEIV0
 11590     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11591     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11592     MOVE X'3520233030303130333037' TO DFHEIV0(25:11)
 11593     CALL 'kxdfhei1' USING DFHEIV0
 11594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11595
 11596
 11597
 11598* EXEC CICS READ UPDATE
 11599*        DATASET (TRLR-FILE-ID)
 11600*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11601*        RIDFLD  (TRLR-KEY)
 11602*    END-EXEC.
 11603*    MOVE '&"S        EU         (   #00010312' TO DFHEIV0
 11604     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11605     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11606     MOVE X'2020233030303130333132' TO DFHEIV0(25:11)
 11607     CALL 'kxdfhei1' USING DFHEIV0,
 11608           TRLR-FILE-ID,
 11609           DFHEIV20,
 11610           DFHEIV99,
 11611           TRLR-KEY,
 11612           DFHEIV99,
 11613           DFHEIV99,
 11614           DFHEIV99
 11615     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11616         DFHEIV20
 11617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11618
 11619
 11620     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
 11621
 11622     MOVE DIAGI                 TO AT-INFO-LINE-1.
 11623
 11624
 11625* EXEC CICS REWRITE
 11626*        DATASET (TRLR-FILE-ID)
 11627*        FROM    (ACTIVITY-TRAILERS)
 11628*    END-EXEC.
 11629     MOVE LENGTH OF
 11630      ACTIVITY-TRAILERS
 11631       TO DFHEIV11
 11632*    MOVE '&& L                  %   #00010322' TO DFHEIV0
 11633     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11634     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11635     MOVE X'2020233030303130333232' TO DFHEIV0(25:11)
 11636     CALL 'kxdfhei1' USING DFHEIV0,
 11637           TRLR-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 218
* EL131.cbl
 11638           ACTIVITY-TRAILERS,
 11639           DFHEIV11,
 11640           DFHEIV99
 11641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11642
 11643
 11644     IF DIAGI NOT = WS-DIAGNOSIS
 11645         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 11646         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 11647         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11648
 11649     GO TO 2425-EXIT.
 11650
 11651 2425-NINETY-NOTFND.
 11652
 11653
 11654* EXEC CICS GETMAIN
 11655*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11656*         LENGTH    (TRLR-LENGTH)
 11657*         INITIMG   (GETMAIN-SPACE)
 11658*    END-EXEC.
 11659*    MOVE ',"IL                  $   #00010336' TO DFHEIV0
 11660     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11661     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11662     MOVE X'2020233030303130333336' TO DFHEIV0(25:11)
 11663     CALL 'kxdfhei1' USING DFHEIV0,
 11664           DFHEIV20,
 11665           TRLR-LENGTH,
 11666           GETMAIN-SPACE
 11667     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11668         DFHEIV20
 11669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11670
 11671
 11672     MOVE +90                  TO TRLR-SEQ-NO.
 11673     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 11674
 11675     MOVE 'AT'                 TO AT-RECORD-ID
 11676     MOVE '6'                  TO AT-TRAILER-TYPE
 11677     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 11678                                  AT-GEN-INFO-LAST-MAINT-DT
 11679     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 11680                                  AT-GEN-INFO-LAST-UPDATED-BY
 11681     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 11682     MOVE DIAGI                TO AT-INFO-LINE-1.
 11683
 11684
 11685* EXEC CICS WRITE
 11686*        DATASET (TRLR-FILE-ID)
 11687*        FROM    (ACTIVITY-TRAILERS)
 11688*        RIDFLD  (TRLR-KEY)
 11689*    END-EXEC.
 11690     MOVE LENGTH OF
 11691      ACTIVITY-TRAILERS
 11692       TO DFHEIV11
 11693*    MOVE '&$ L                  ''   #00010354' TO DFHEIV0
 11694     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11695     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 219
* EL131.cbl
 11696     MOVE X'2020233030303130333534' TO DFHEIV0(25:11)
 11697     CALL 'kxdfhei1' USING DFHEIV0,
 11698           TRLR-FILE-ID,
 11699           ACTIVITY-TRAILERS,
 11700           DFHEIV11,
 11701           TRLR-KEY,
 11702           DFHEIV99,
 11703           DFHEIV99
 11704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11705
 11706
 11707 2425-EXIT.
 11708     EXIT.
 11709
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 220
* EL131.cbl
 11711 2430-UPDATE-ACTQ.
 11712
 11713* EXEC CICS HANDLE CONDITION
 11714*         NOTFND    (2430-EXIT)
 11715*         ENDFILE   (2440-EXIT)
 11716*    END-EXEC.
 11717*    MOVE '"$I''                  ! 6 #00010365' TO DFHEIV0
 11718     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11719     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11720     MOVE X'3620233030303130333635' TO DFHEIV0(25:11)
 11721     CALL 'kxdfhei1' USING DFHEIV0
 11722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11723
 11724
 11725
 11726* EXEC CICS STARTBR
 11727*         DATASET  (ACTQ-FILE-ID)
 11728*         RIDFLD   (ACTQ-KEY)
 11729*    END-EXEC.
 11730     MOVE 0
 11731       TO DFHEIV11
 11732*    MOVE '&,         G          &   #00010370' TO DFHEIV0
 11733     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11734     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11735     MOVE X'2020233030303130333730' TO DFHEIV0(25:11)
 11736     CALL 'kxdfhei1' USING DFHEIV0,
 11737           ACTQ-FILE-ID,
 11738           ACTQ-KEY,
 11739           DFHEIV99,
 11740           DFHEIV11,
 11741           DFHEIV99
 11742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11743
 11744
 11745
 11746* EXEC CICS GETMAIN
 11747*         SET      (ADDRESS OF ACTIVITY-QUE)
 11748*         LENGTH   (ACTQ-LENGTH)
 11749*         INITIMG  (GETMAIN-SPACE)
 11750*    END-EXEC.
 11751*    MOVE ',"IL                  $   #00010375' TO DFHEIV0
 11752     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11753     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11754     MOVE X'2020233030303130333735' TO DFHEIV0(25:11)
 11755     CALL 'kxdfhei1' USING DFHEIV0,
 11756           DFHEIV20,
 11757           ACTQ-LENGTH,
 11758           GETMAIN-SPACE
 11759     SET ADDRESS OF ACTIVITY-QUE TO
 11760         DFHEIV20
 11761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11762
 11763
 11764     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 11765
 11766 2430-EXIT.
 11767     EXIT.
 11768
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 221
* EL131.cbl
 11769 2440-CHANGE-ACTQ.
 11770
 11771
 11772* EXEC CICS READNEXT
 11773*         DATASET  (ACTQ-FILE-ID)
 11774*         RIDFLD   (ACTQ-KEY)
 11775*         INTO     (ACTIVITY-QUE)
 11776*    END-EXEC.
 11777     MOVE LENGTH OF
 11778      ACTIVITY-QUE
 11779       TO DFHEIV12
 11780     MOVE 0
 11781       TO DFHEIV11
 11782*    MOVE '&.IL                  )   #00010388' TO DFHEIV0
 11783     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11784     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11785     MOVE X'2020233030303130333838' TO DFHEIV0(25:11)
 11786     CALL 'kxdfhei1' USING DFHEIV0,
 11787           ACTQ-FILE-ID,
 11788           ACTIVITY-QUE,
 11789           DFHEIV12,
 11790           ACTQ-KEY,
 11791           DFHEIV99,
 11792           DFHEIV11,
 11793           DFHEIV99,
 11794           DFHEIV99
 11795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11796
 11797
 11798
 11799* EXEC CICS ENDBR
 11800*         DATASET (ACTQ-FILE-ID)
 11801*    END-EXEC.
 11802     MOVE 0
 11803       TO DFHEIV11
 11804*    MOVE '&2                    $   #00010394' TO DFHEIV0
 11805     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11806     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11807     MOVE X'2020233030303130333934' TO DFHEIV0(25:11)
 11808     CALL 'kxdfhei1' USING DFHEIV0,
 11809           ACTQ-FILE-ID,
 11810           DFHEIV11,
 11811           DFHEIV99
 11812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11813
 11814
 11815     IF ACTQ-KEY NOT = MSTR-KEY
 11816         GO TO 2440-EXIT.
 11817
 11818
 11819* EXEC CICS READ UPDATE
 11820*         DATASET  (ACTQ-FILE-ID)
 11821*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11822*         SET      (ADDRESS OF ACTIVITY-QUE)
 11823*    END-EXEC.
 11824*    MOVE '&"S        EU         (   #00010401' TO DFHEIV0
 11825     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11826     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 222
* EL131.cbl
 11827     MOVE X'2020233030303130343031' TO DFHEIV0(25:11)
 11828     CALL 'kxdfhei1' USING DFHEIV0,
 11829           ACTQ-FILE-ID,
 11830           DFHEIV20,
 11831           DFHEIV99,
 11832           AQ-CONTROL-PRIMARY,
 11833           DFHEIV99,
 11834           DFHEIV99,
 11835           DFHEIV99
 11836     SET ADDRESS OF ACTIVITY-QUE TO
 11837         DFHEIV20
 11838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11839
 11840
 11841     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 11842
 11843
 11844* EXEC CICS DELETE
 11845*         DATASET (ACTQ-FILE-ID)
 11846*    END-EXEC.
 11847*    MOVE '&(                    &   #00010409' TO DFHEIV0
 11848     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11849     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11850     MOVE X'2020233030303130343039' TO DFHEIV0(25:11)
 11851     CALL 'kxdfhei1' USING DFHEIV0,
 11852           ACTQ-FILE-ID,
 11853           DFHEIV99,
 11854           DFHEIV99,
 11855           DFHEIV99,
 11856           DFHEIV99
 11857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11858
 11859
 11860     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 11861     IF CERTI GREATER THAN LOW-VALUES
 11862        MOVE CERTI               TO AQ-CERT-PRIME.
 11863     IF SUFXI GREATER THAN LOW-VALUES
 11864        MOVE SUFXI               TO AQ-CERT-SFX.
 11865     IF CERTCARI GREATER THAN LOW-VALUES
 11866        MOVE CERTCARI            TO AQ-CARRIER.
 11867
 11868
 11869* EXEC CICS HANDLE CONDITION
 11870*         DUPREC   (2440-EXIT)
 11871*    END-EXEC.
 11872*    MOVE '"$%                   ! 7 #00010421' TO DFHEIV0
 11873     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11874     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11875     MOVE X'3720233030303130343231' TO DFHEIV0(25:11)
 11876     CALL 'kxdfhei1' USING DFHEIV0
 11877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11878
 11879
 11880
 11881* EXEC CICS WRITE
 11882*         DATASET  (ACTQ-FILE-ID)
 11883*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11884*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 223
* EL131.cbl
 11885*    END-EXEC.
 11886     MOVE LENGTH OF
 11887      ACTIVITY-QUE
 11888       TO DFHEIV11
 11889*    MOVE '&$ L                  ''   #00010425' TO DFHEIV0
 11890     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11891     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11892     MOVE X'2020233030303130343235' TO DFHEIV0(25:11)
 11893     CALL 'kxdfhei1' USING DFHEIV0,
 11894           ACTQ-FILE-ID,
 11895           ACTIVITY-QUE,
 11896           DFHEIV11,
 11897           AQ-CONTROL-PRIMARY,
 11898           DFHEIV99,
 11899           DFHEIV99
 11900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11901
 11902
 11903 2440-EXIT.
 11904     EXIT.
 11905
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 224
* EL131.cbl
 11907 2460-UPDATE-CHECKQ.
 11908
 11909* EXEC CICS HANDLE CONDITION
 11910*         NOTFND   (2460-EXIT)
 11911*    END-EXEC.
 11912*    MOVE '"$I                   ! 8 #00010436' TO DFHEIV0
 11913     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11914     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11915     MOVE X'3820233030303130343336' TO DFHEIV0(25:11)
 11916     CALL 'kxdfhei1' USING DFHEIV0
 11917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11918
 11919
 11920     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 11921     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 11922     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 11923
 11924
 11925* EXEC CICS READ UPDATE
 11926*         DATASET   (CHKQ-FILE-ID)
 11927*         RIDFLD    (CHKQ-KEY)
 11928*         SET       (ADDRESS OF CHECK-QUE)
 11929*    END-EXEC.
 11930*    MOVE '&"S        EU         (   #00010444' TO DFHEIV0
 11931     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11932     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11933     MOVE X'2020233030303130343434' TO DFHEIV0(25:11)
 11934     CALL 'kxdfhei1' USING DFHEIV0,
 11935           CHKQ-FILE-ID,
 11936           DFHEIV20,
 11937           DFHEIV99,
 11938           CHKQ-KEY,
 11939           DFHEIV99,
 11940           DFHEIV99,
 11941           DFHEIV99
 11942     SET ADDRESS OF CHECK-QUE TO
 11943         DFHEIV20
 11944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11945
 11946
 11947     IF CERTI GREATER THAN LOW-VALUES
 11948        MOVE CERTI               TO CQ-CERT-PRIME.
 11949     IF SUFXI GREATER THAN LOW-VALUES
 11950        MOVE SUFXI               TO CQ-CERT-SFX.
 11951     IF CERTCARI GREATER THAN LOW-VALUES
 11952        MOVE CERTCARI            TO CQ-CARRIER.
 11953
 11954
 11955* EXEC CICS REWRITE
 11956*         DATASET  (CHKQ-FILE-ID)
 11957*         FROM     (CHECK-QUE)
 11958*    END-EXEC.
 11959     MOVE LENGTH OF
 11960      CHECK-QUE
 11961       TO DFHEIV11
 11962*    MOVE '&& L                  %   #00010457' TO DFHEIV0
 11963     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11964     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 225
* EL131.cbl
 11965     MOVE X'2020233030303130343537' TO DFHEIV0(25:11)
 11966     CALL 'kxdfhei1' USING DFHEIV0,
 11967           CHKQ-FILE-ID,
 11968           CHECK-QUE,
 11969           DFHEIV11,
 11970           DFHEIV99
 11971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11972
 11973
 11974 2460-EXIT.
 11975     EXIT.
 11976
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 226
* EL131.cbl
 11978 2475-UPDATE-LETTER.
 11979
 11980* EXEC CICS HANDLE CONDITION
 11981*         NOTFND   (2475-EXIT)
 11982*    END-EXEC.
 11983*    MOVE '"$I                   ! 9 #00010467' TO DFHEIV0
 11984     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11985     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11986     MOVE X'3920233030303130343637' TO DFHEIV0(25:11)
 11987     CALL 'kxdfhei1' USING DFHEIV0
 11988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11989
 11990
 11991     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 11992     MOVE '1'                    TO ARCH-RECORD-TYPE.
 11993     MOVE ZEROS                  TO ARCH-SEQ-NO.
 11994     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 11995
 11996
 11997* EXEC CICS READ UPDATE
 11998*         DATASET   (ARCH-FILE-ID)
 11999*         RIDFLD    (ARCH-KEY)
 12000*         SET       (ADDRESS OF LETTER-ARCHIVE)
 12001*    END-EXEC.
 12002*    MOVE '&"S        EU         (   #00010476' TO DFHEIV0
 12003     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12004     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12005     MOVE X'2020233030303130343736' TO DFHEIV0(25:11)
 12006     CALL 'kxdfhei1' USING DFHEIV0,
 12007           ARCH-FILE-ID,
 12008           DFHEIV20,
 12009           DFHEIV99,
 12010           ARCH-KEY,
 12011           DFHEIV99,
 12012           DFHEIV99,
 12013           DFHEIV99
 12014     SET ADDRESS OF LETTER-ARCHIVE TO
 12015         DFHEIV20
 12016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12017
 12018
 12019* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 12020* TO THIS MASTER-KEY INFORMATION.
 12021
 12022     IF LA-CARRIER  = CARRIER-CODE AND
 12023        LA-CLAIM-NO = CLAIM-NO     AND
 12024        LA-CERT-NO  = CERT-NO
 12025        NEXT SENTENCE
 12026     ELSE
 12027        GO TO 2475-UNLOCK.
 12028
 12029     IF CERTI GREATER THAN LOW-VALUES
 12030        MOVE CERTI               TO LA-CERT-PRIME.
 12031     IF SUFXI GREATER THAN LOW-VALUES
 12032        MOVE SUFXI               TO LA-CERT-SFX.
 12033     IF CERTCARI GREATER THAN LOW-VALUES
 12034        MOVE CERTCARI            TO LA-CARRIER.
 12035
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 227
* EL131.cbl
 12036
 12037* EXEC CICS REWRITE
 12038*         DATASET  (ARCH-FILE-ID)
 12039*         FROM     (LETTER-ARCHIVE)
 12040*    END-EXEC.
 12041     MOVE LENGTH OF
 12042      LETTER-ARCHIVE
 12043       TO DFHEIV11
 12044*    MOVE '&& L                  %   #00010499' TO DFHEIV0
 12045     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12046     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12047     MOVE X'2020233030303130343939' TO DFHEIV0(25:11)
 12048     CALL 'kxdfhei1' USING DFHEIV0,
 12049           ARCH-FILE-ID,
 12050           LETTER-ARCHIVE,
 12051           DFHEIV11,
 12052           DFHEIV99
 12053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12054
 12055
 12056     GO TO 2475-EXIT.
 12057
 12058 2475-UNLOCK.
 12059
 12060* EXEC CICS UNLOCK
 12061*         DATASET  (ARCH-FILE-ID)
 12062*    END-EXEC.
 12063*    MOVE '&*                    #   #00010507' TO DFHEIV0
 12064     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12065     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12066     MOVE X'2020233030303130353037' TO DFHEIV0(25:11)
 12067     CALL 'kxdfhei1' USING DFHEIV0,
 12068           ARCH-FILE-ID,
 12069           DFHEIV99
 12070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12071
 12072
 12073 2475-EXIT.
 12074     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 228
* EL131.cbl
 12076 2600-CREATE-MAINT-NOTE.
 12077     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12078     MOVE '1'                    TO CNTL-REC-TYPE.
 12079     MOVE SPACES                 TO CNTL-PROC-ID.
 12080     MOVE ZERO                   TO CNTL-SEQ-NO.
 12081
 12082
 12083* EXEC CICS READ
 12084*         SET        (ADDRESS OF CONTROL-FILE)
 12085*         DATASET    ('ELCNTL')
 12086*         RIDFLD     (CNTL-KEY)
 12087*    END-EXEC.
 12088     MOVE 'ELCNTL' TO DFHEIV1
 12089*    MOVE '&"S        E          (   #00010520' TO DFHEIV0
 12090     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12091     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12092     MOVE X'2020233030303130353230' TO DFHEIV0(25:11)
 12093     CALL 'kxdfhei1' USING DFHEIV0,
 12094           DFHEIV1,
 12095           DFHEIV20,
 12096           DFHEIV99,
 12097           CNTL-KEY,
 12098           DFHEIV99,
 12099           DFHEIV99,
 12100           DFHEIV99
 12101     SET ADDRESS OF CONTROL-FILE TO
 12102         DFHEIV20
 12103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12104
 12105
 12106     IF CO-NO-USE-AUDIT-CHANGES
 12107         GO TO 2600-EXIT.
 12108
 12109     IF PROCL GREATER ZERO
 12110     IF PROCI NOT = LOW-VALUES
 12111     IF PROCI NOT = CL-PROCESSOR-ID
 12112         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 12113         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 12114         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12115
 12116     IF SEXL GREATER ZERO
 12117     IF SEXI NOT = LOW-VALUES
 12118     IF SEXI NOT = CL-INSURED-SEX-CD
 12119         MOVE 'SEX'                TO SPLIT-INFO-DESC
 12120         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 12121         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12122
 12123     IF BIRTHL GREATER ZERO
 12124     IF HOLD-BIRTH NOT = LOW-VALUES
 12125     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 12126         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 12127         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 12128         MOVE SPACES               TO DC-OPTION-CODE
 12129         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12130         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12131         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12132
 12133     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 229
* EL131.cbl
 12134     IF SOCIALI NOT = LOW-VALUES
 12135     IF SOCIALI NOT = CL-SOC-SEC-NO
 12136         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 12137         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 12138         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12139
 12140     IF OCCL GREATER ZERO
 12141     IF OCCI NOT = LOW-VALUES
 12142     IF OCCI NOT = CL-INSURED-OCC-CD
 12143         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 12144         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 12145         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12146
 12147     IF BENEL GREATER ZERO
 12148     IF BENEI NOT = LOW-VALUES
 12149     IF BENEI NOT = CL-BENEFICIARY
 12150         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 12151         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 12152         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12153
 12154     IF PREMTYPL GREATER ZERO
 12155     IF PREMTYPI NOT = LOW-VALUES
 12156     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 12157         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 12158         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 12159         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12160
 12161     IF CAUSEL GREATER ZERO
 12162     IF CAUSEI NOT = LOW-VALUES
 12163     IF CAUSEI NOT = CL-CAUSE-CD
 12164         MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 12165         MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 12166         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12167
 12168     IF ENDL GREATER ZERO
 12169     IF HOLD-END NOT = LOW-VALUES
 12170     IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 12171         MOVE 'END DT'             TO SPLIT-INFO-DESC
 12172         MOVE CL-EST-END-OF-DISAB-DT
 12173                                   TO DC-BIN-DATE-1
 12174         MOVE SPACES               TO DC-OPTION-CODE
 12175         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12176         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12177         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12178
 12179     IF PDTHRUL GREATER ZERO
 12180     IF HOLD-PDTHRU NOT = LOW-VALUES
 12181     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 12182         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 12183         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 12184         MOVE SPACES               TO DC-OPTION-CODE
 12185         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12186         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12187         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12188
 12189     IF PDAMTL GREATER ZERO
 12190     IF HOLD-PDAMT NOT = ZEROS
 12191     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 230
* EL131.cbl
 12192         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 12193         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 12194         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 12195         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12196
 12197     IF NODAYSL GREATER ZERO
 12198     IF HOLD-NODAYS NOT = ZEROS
 12199     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 12200         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 12201         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 12202         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12203         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12204
 12205     IF NOPMTSL GREATER ZERO
 12206     IF HOLD-NOPMTS NOT = ZEROS
 12207     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 12208         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 12209         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 12210         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12211         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12212
 12213     IF FORMTYPL GREATER ZERO
 12214     IF FORMTYPI NOT = LOW-VALUES
 12215     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 12216         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 12217         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 12218         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12219
 12220     IF REPL GREATER ZERO
 12221     IF HOLD-REPORTED NOT = LOW-VALUES
 12222     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 12223         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 12224         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 12225         MOVE SPACES               TO DC-OPTION-CODE
 12226         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12227         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12228         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12229
 12230     IF ADDONDTL GREATER ZERO
 12231     IF HOLD-ADDON NOT = LOW-VALUES
 12232     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 12233         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 12234         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 12235         MOVE SPACES               TO DC-OPTION-CODE
 12236         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12237         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12238         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12239
 12240     IF PRICDL GREATER ZERO
 12241     IF PRICDI NOT = LOW-VALUES
 12242     IF PRICDI NOT = CL-PRIORITY-CD
 12243         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 12244         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 12245         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12246
 12247     IF FILETOL GREATER ZERO
 12248     IF FILETOI NOT = LOW-VALUES
 12249     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 231
* EL131.cbl
 12250         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 12251         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 12252         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12253
 12254     IF SUPVL GREATER ZERO
 12255     IF SUPVI NOT = LOW-VALUES
 12256     IF SUPVI NOT = CL-SUPV-ATTN-CD
 12257         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 12258         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 12259         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12260     IF (CRITPTL > ZERO)
 12261        AND (CRITPTI NOT = LOW-VALUES)
 12262        AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 12263        MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 12264        MOVE CL-CRIT-PER-RECURRENT
 12265                                 TO SPLIT-INFO-OLD
 12266        PERFORM 2650-WRITE-MAINT-NOTE
 12267                                 THRU 2650-EXIT
 12268     END-IF
 12269
 12270     IF (RTWMOSL > ZERO)
 12271        AND (RTWMOSI NOT = LOW-VALUES)
 12272        AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 12273        MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 12274        MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 12275        PERFORM 2650-WRITE-MAINT-NOTE
 12276                                 THRU 2650-EXIT
 12277     END-IF
 12278     IF MLNAMEL GREATER ZERO
 12279     IF MLNAMEI NOT = LOW-VALUES
 12280     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 12281         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 12282         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 12283         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12284
 12285     IF MFNAMEL GREATER ZERO
 12286     IF MFNAMEI NOT = LOW-VALUES
 12287     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 12288         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 12289         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 12290         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12291
 12292     IF MMINITL GREATER ZERO
 12293     IF MMINITI NOT = LOW-VALUES
 12294     IF MMINITI NOT = CL-INSURED-MID-INIT
 12295         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 12296         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 12297         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12298
 12299     IF CERTEFFL GREATER ZERO
 12300     IF HOLD-EFF NOT = LOW-VALUES
 12301     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 12302         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 12303         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 12304         MOVE SPACES               TO DC-OPTION-CODE
 12305         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12306         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12307         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 232
* EL131.cbl
 12308
 12309     IF CERTACTL GREATER ZERO
 12310     IF CERTACTI NOT = LOW-VALUES
 12311     IF CERTACTI NOT = CL-CERT-ACCOUNT
 12312         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 12313         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 12314         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12315
 12316     IF CERTSTL GREATER ZERO
 12317     IF CERTSTI NOT = LOW-VALUES
 12318     IF CERTSTI NOT = CL-CERT-STATE
 12319         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 12320         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 12321         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12322
 12323     IF CERTCARL GREATER ZERO
 12324     IF CERTCARI NOT = LOW-VALUES
 12325     IF CERTCARI NOT = CL-CERT-CARRIER
 12326         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 12327         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 12328         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12329
 12330     IF CERTGRPL GREATER ZERO
 12331     IF CERTGRPI NOT = LOW-VALUES
 12332     IF CERTGRPI NOT = CL-CERT-GROUPING
 12333         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 12334         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 12335         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12336
 12337     IF CERTL GREATER ZERO OR
 12338        SUFXL GREATER ZERO
 12339     IF (CERTI NOT = LOW-VALUES AND
 12340                     CL-CERT-PRIME)
 12341                OR
 12342        (SUFXI NOT = LOW-VALUES AND
 12343                     CL-CERT-SFX)
 12344         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 12345         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 12346         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12347     IF incl > zeros
 12348        IF (HOLD-INCUR NOT = LOW-VALUES)
 12349           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 12350           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 12351           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 12352           MOVE SPACES           TO DC-OPTION-CODE
 12353           PERFORM 9800-CONVERT-DATE
 12354                                 THRU 9800-EXIT
 12355           MOVE DC-GREG-DATE-1-EDIT
 12356                                 TO SPLIT-INFO-OLD
 12357           PERFORM 2650-WRITE-MAINT-NOTE
 12358                                 THRU 2650-EXIT
 12359        END-IF
 12360     END-IF
 12361     .
 12362 2600-EXIT.
 12363      EXIT.
 12364
 12365 2650-WRITE-MAINT-NOTE.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 233
* EL131.cbl
 12366
 12367* EXEC CICS GETMAIN
 12368*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12369*         LENGTH   (TRLR-LENGTH)
 12370*         INITIMG  (GETMAIN-SPACE)
 12371*    END-EXEC.
 12372*    MOVE ',"IL                  $   #00010786' TO DFHEIV0
 12373     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12374     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12375     MOVE X'2020233030303130373836' TO DFHEIV0(25:11)
 12376     CALL 'kxdfhei1' USING DFHEIV0,
 12377           DFHEIV20,
 12378           TRLR-LENGTH,
 12379           GETMAIN-SPACE
 12380     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12381         DFHEIV20
 12382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12383
 12384
 12385
 12386* EXEC CICS HANDLE CONDITION
 12387*         DUPREC   (2650-EXIT)
 12388*    END-EXEC.
 12389*    MOVE '"$%                   ! : #00010792' TO DFHEIV0
 12390     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12391     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12392     MOVE X'3A20233030303130373932' TO DFHEIV0(25:11)
 12393     CALL 'kxdfhei1' USING DFHEIV0
 12394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12395
 12396
 12397     MOVE SPACES             TO ACTIVITY-TRAILERS.
 12398
 12399     IF CERTL GREATER ZERO
 12400         MOVE CERTI          TO CL-CERT-PRIME.
 12401
 12402     IF SUFXL GREATER ZERO
 12403         MOVE SUFXI          TO CL-CERT-SFX.
 12404
 12405     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 12406
 12407     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 12408     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 12409
 12410     MOVE 'AT'               TO AT-RECORD-ID.
 12411
 12412     MOVE '6'                TO AT-TRAILER-TYPE.
 12413     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 12414                                AT-GEN-INFO-LAST-MAINT-DT.
 12415     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 12416                                AT-GEN-INFO-LAST-UPDATED-BY.
 12417     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 12418     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 12419     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 12420
 12421
 12422* EXEC CICS WRITE
 12423*         DATASET  (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 234
* EL131.cbl
 12424*         RIDFLD   (AT-CONTROL-PRIMARY)
 12425*         FROM     (ACTIVITY-TRAILERS)
 12426*    END-EXEC.
 12427     MOVE LENGTH OF
 12428      ACTIVITY-TRAILERS
 12429       TO DFHEIV11
 12430*    MOVE '&$ L                  ''   #00010820' TO DFHEIV0
 12431     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12432     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12433     MOVE X'2020233030303130383230' TO DFHEIV0(25:11)
 12434     CALL 'kxdfhei1' USING DFHEIV0,
 12435           TRLR-FILE-ID,
 12436           ACTIVITY-TRAILERS,
 12437           DFHEIV11,
 12438           AT-CONTROL-PRIMARY,
 12439           DFHEIV99,
 12440           DFHEIV99
 12441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12442
 12443
 12444 2650-EXIT.
 12445      EXIT.
 12446
 12447 2800-CHECK-AUTO-PAY.
 12448
 12449     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 12450     MOVE PI-CARRIER         TO TRLR-CARRIER.
 12451     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 12452     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 12453     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 12454
 12455
 12456* EXEC CICS HANDLE CONDITION
 12457*         NOTFND    (2800-EXIT)
 12458*         ENDFILE   (2800-EXIT)
 12459*    END-EXEC.
 12460*    MOVE '"$I''                  ! ; #00010837' TO DFHEIV0
 12461     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12462     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12463     MOVE X'3B20233030303130383337' TO DFHEIV0(25:11)
 12464     CALL 'kxdfhei1' USING DFHEIV0
 12465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12466
 12467
 12468
 12469* EXEC CICS READ
 12470*        DATASET (TRLR-FILE-ID)
 12471*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12472*        RIDFLD  (TRLR-KEY)
 12473*    END-EXEC.
 12474*    MOVE '&"S        E          (   #00010842' TO DFHEIV0
 12475     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12476     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12477     MOVE X'2020233030303130383432' TO DFHEIV0(25:11)
 12478     CALL 'kxdfhei1' USING DFHEIV0,
 12479           TRLR-FILE-ID,
 12480           DFHEIV20,
 12481           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 235
* EL131.cbl
 12482           TRLR-KEY,
 12483           DFHEIV99,
 12484           DFHEIV99,
 12485           DFHEIV99
 12486     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12487         DFHEIV20
 12488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12489
 12490
 12491     IF BENEFICIARY-PAID-AUTO
 12492         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 12493     END-IF.
 12494
 12495 2800-EXIT.
 12496      EXIT.
 12497
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 236
* EL131.cbl
 12499 3000-DELETE-CLAIM.
 12500     IF  NOT MODIFY-CAP
 12501         MOVE ER-0070            TO EMI-ERROR
 12502         MOVE -1                 TO MAINTL
 12503         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12504         GO TO 8110-SEND-DATA.
 12505
 12506
 12507* EXEC CICS READ
 12508*         SET      (ADDRESS OF CLAIM-MASTER)
 12509*         DATASET  (CLMS-FILE-ID)
 12510*         RIDFLD   (MSTR-KEY)
 12511*    END-EXEC.
 12512*    MOVE '&"S        E          (   #00010863' TO DFHEIV0
 12513     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12514     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12515     MOVE X'2020233030303130383633' TO DFHEIV0(25:11)
 12516     CALL 'kxdfhei1' USING DFHEIV0,
 12517           CLMS-FILE-ID,
 12518           DFHEIV20,
 12519           DFHEIV99,
 12520           MSTR-KEY,
 12521           DFHEIV99,
 12522           DFHEIV99,
 12523           DFHEIV99
 12524     SET ADDRESS OF CLAIM-MASTER TO
 12525         DFHEIV20
 12526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12527
 12528
 12529     IF CL-1ST-TRL-AVAIL
 12530         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 12531     ELSE
 12532        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 12533        MOVE 0                   TO TRLR-SEQ-NO
 12534
 12535* EXEC CICS STARTBR
 12536*            DATASET (TRLR-FILE-ID)
 12537*            RIDFLD  (TRLR-KEY)
 12538*        END-EXEC
 12539     MOVE 0
 12540       TO DFHEIV11
 12541*    MOVE '&,         G          &   #00010874' TO DFHEIV0
 12542     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12543     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12544     MOVE X'2020233030303130383734' TO DFHEIV0(25:11)
 12545     CALL 'kxdfhei1' USING DFHEIV0,
 12546           TRLR-FILE-ID,
 12547           TRLR-KEY,
 12548           DFHEIV99,
 12549           DFHEIV11,
 12550           DFHEIV99
 12551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12552         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 12553
 12554* EXEC CICS ENDBR
 12555*            DATASET (TRLR-FILE-ID)
 12556*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 237
* EL131.cbl
 12557     MOVE 0
 12558       TO DFHEIV11
 12559*    MOVE '&2                    $   #00010879' TO DFHEIV0
 12560     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12561     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12562     MOVE X'2020233030303130383739' TO DFHEIV0(25:11)
 12563     CALL 'kxdfhei1' USING DFHEIV0,
 12564           TRLR-FILE-ID,
 12565           DFHEIV11,
 12566           DFHEIV99
 12567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12568        IF SCREEN-ERROR
 12569            MOVE ER-0208         TO EMI-ERROR
 12570            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12571            MOVE -1              TO MAINTL
 12572            GO TO 8110-SEND-DATA
 12573        ELSE
 12574            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 12575
 12576     IF SCREEN-ERROR
 12577         MOVE -1                 TO MAINTL
 12578         GO TO 8110-SEND-DATA.
 12579
 12580     MOVE -1                     TO ONE-OR-MIN1.
 12581     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 12582
 12583     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 12584         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 12585                                    WS-SAVE-CLAIM-KEY
 12586         MOVE +1                 TO ONE-OR-MIN1
 12587         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 12588
 12589     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 12590
 12591     MOVE LOW-VALUES             TO EL131AO.
 12592     MOVE ER-0000                TO EMI-ERROR.
 12593     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12594     MOVE 'X'                    TO PI-RETURN-CD-1.
 12595     MOVE -1                     TO MAINTL.
 12596     GO TO 8100-SEND-MAP.
 12597
 12598 3010-DEL-MSTR-TRLR.
 12599
 12600* EXEC CICS READ UPDATE
 12601*         SET       (ADDRESS OF CLAIM-MASTER)
 12602*         DATASET   (CLMS-FILE-ID)
 12603*         RIDFLD    (MSTR-KEY)
 12604*    END-EXEC.
 12605*    MOVE '&"S        EU         (   #00010913' TO DFHEIV0
 12606     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12607     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12608     MOVE X'2020233030303130393133' TO DFHEIV0(25:11)
 12609     CALL 'kxdfhei1' USING DFHEIV0,
 12610           CLMS-FILE-ID,
 12611           DFHEIV20,
 12612           DFHEIV99,
 12613           MSTR-KEY,
 12614           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 238
* EL131.cbl
 12615           DFHEIV99,
 12616           DFHEIV99
 12617     SET ADDRESS OF CLAIM-MASTER TO
 12618         DFHEIV20
 12619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12620
 12621
 12622     if (cl-priority-cd = '8')
 12623        and (pi-processor-id not = 'PEMA' and 'JMS '
 12624             AND 'AMWA')
 12625        MOVE ER-8003             TO EMI-ERROR
 12626        PERFORM 9900-ERROR-FORMAT
 12627                                 THRU 9900-EXIT
 12628        MOVE -1                  TO MAINTL
 12629        GO TO 8110-SEND-DATA
 12630     end-if
 12631
 12632     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 12633     MOVE ZERO                   TO TRLR-SEQ-NO.
 12634
 12635
 12636* EXEC CICS HANDLE CONDITION
 12637*         NOTFND    (3010-DEL-ACTQ)
 12638*         ENDFILE   (3040-EXIT)
 12639*    END-EXEC.
 12640*    MOVE '"$I''                  ! < #00010932' TO DFHEIV0
 12641     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12643     MOVE X'3C20233030303130393332' TO DFHEIV0(25:11)
 12644     CALL 'kxdfhei1' USING DFHEIV0
 12645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12646
 12647
 12648     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 12649
 12650 3010-DEL-ACTQ.
 12651
 12652
 12653* EXEC CICS HANDLE CONDITION
 12654*         NOTFND    (3010-NO-ACTIVITY)
 12655*         ENDFILE   (3050-EXIT)
 12656*    END-EXEC.
 12657*    MOVE '"$I''                  ! = #00010941' TO DFHEIV0
 12658     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12659     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12660     MOVE X'3D20233030303130393431' TO DFHEIV0(25:11)
 12661     CALL 'kxdfhei1' USING DFHEIV0
 12662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12663
 12664
 12665
 12666* EXEC CICS STARTBR
 12667*         DATASET  (ACTQ-FILE-ID)
 12668*         RIDFLD   (ACTQ-KEY)
 12669*    END-EXEC.
 12670     MOVE 0
 12671       TO DFHEIV11
 12672*    MOVE '&,         G          &   #00010946' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 239
* EL131.cbl
 12673     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12674     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12675     MOVE X'2020233030303130393436' TO DFHEIV0(25:11)
 12676     CALL 'kxdfhei1' USING DFHEIV0,
 12677           ACTQ-FILE-ID,
 12678           ACTQ-KEY,
 12679           DFHEIV99,
 12680           DFHEIV11,
 12681           DFHEIV99
 12682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12683
 12684
 12685
 12686* EXEC CICS GETMAIN
 12687*         SET      (ADDRESS OF ACTIVITY-QUE)
 12688*         LENGTH   (ACTQ-LENGTH)
 12689*         INITIMG  (GETMAIN-SPACE)
 12690*    END-EXEC.
 12691*    MOVE ',"IL                  $   #00010951' TO DFHEIV0
 12692     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12693     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12694     MOVE X'2020233030303130393531' TO DFHEIV0(25:11)
 12695     CALL 'kxdfhei1' USING DFHEIV0,
 12696           DFHEIV20,
 12697           ACTQ-LENGTH,
 12698           GETMAIN-SPACE
 12699     SET ADDRESS OF ACTIVITY-QUE TO
 12700         DFHEIV20
 12701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12702
 12703
 12704     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 12705
 12706
 12707* EXEC CICS ENDBR
 12708*         DATASET (ACTQ-FILE-ID)
 12709*    END-EXEC.
 12710     MOVE 0
 12711       TO DFHEIV11
 12712*    MOVE '&2                    $   #00010959' TO DFHEIV0
 12713     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12714     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12715     MOVE X'2020233030303130393539' TO DFHEIV0(25:11)
 12716     CALL 'kxdfhei1' USING DFHEIV0,
 12717           ACTQ-FILE-ID,
 12718           DFHEIV11,
 12719           DFHEIV99
 12720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12721
 12722
 12723 3010-NO-ACTIVITY.
 12724
 12725
 12726* EXEC CICS HANDLE CONDITION
 12727*        NOTFND   (3010-CERT-NOT-FOUND)
 12728*    END-EXEC.
 12729*    MOVE '"$I                   ! > #00010965' TO DFHEIV0
 12730     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 240
* EL131.cbl
 12731     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12732     MOVE X'3E20233030303130393635' TO DFHEIV0(25:11)
 12733     CALL 'kxdfhei1' USING DFHEIV0
 12734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12735
 12736
 12737     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 12738     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12739     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 12740     MOVE CL-CERT-STATE          TO CERT-STATE.
 12741     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12742     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 12743     MOVE CL-CERT-NO             TO CERT-CERT.
 12744
 12745
 12746* EXEC CICS READ
 12747*        DATASET   (CERT-FILE-ID)
 12748*        RIDFLD    (CERT-KEY)
 12749*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 12750*    END-EXEC.
 12751*    MOVE '&"S        E          (   #00010977' TO DFHEIV0
 12752     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12753     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12754     MOVE X'2020233030303130393737' TO DFHEIV0(25:11)
 12755     CALL 'kxdfhei1' USING DFHEIV0,
 12756           CERT-FILE-ID,
 12757           DFHEIV20,
 12758           DFHEIV99,
 12759           CERT-KEY,
 12760           DFHEIV99,
 12761           DFHEIV99,
 12762           DFHEIV99
 12763     SET ADDRESS OF CERTIFICATE-MASTER TO
 12764         DFHEIV20
 12765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12766
 12767
 12768     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 12769       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 12770         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 12771     ELSE
 12772         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 12773
 12774  3010-UPDATE-CERT-TRLR.
 12775
 12776      MOVE CERT-KEY              TO ELCRTT-KEY
 12777      MOVE 'B'                   TO CTRLR-REC-TYPE
 12778
 12779* EXEC CICS READ
 12780*        UPDATE
 12781*        DATASET   ('ELCRTT')
 12782*        RIDFLD    (ELCRTT-KEY)
 12783*        INTO      (CERTIFICATE-TRAILERS)
 12784*        RESP      (WS-RESPONSE)
 12785*     END-EXEC
 12786     MOVE LENGTH OF
 12787      CERTIFICATE-TRAILERS
 12788       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 241
* EL131.cbl
 12789     MOVE 'ELCRTT' TO DFHEIV1
 12790*    MOVE '&"IL       EU         (  N#00010993' TO DFHEIV0
 12791     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12792     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12793     MOVE X'204E233030303130393933' TO DFHEIV0(25:11)
 12794     CALL 'kxdfhei1' USING DFHEIV0,
 12795           DFHEIV1,
 12796           CERTIFICATE-TRAILERS,
 12797           DFHEIV11,
 12798           ELCRTT-KEY,
 12799           DFHEIV99,
 12800           DFHEIV99,
 12801           DFHEIV99
 12802     MOVE EIBRESP  TO WS-RESPONSE
 12803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12804      IF WS-RESP-NORMAL
 12805*    if cl-insured-claim = 'S'
 12806*       move +2 to s1
 12807*    else
 12808*       MOVE +1 to s1
 12809*    end-if
 12810
 12811     move +1 to s1
 12812     evaluate cl-claim-type
 12813        when 'A'
 12814           move +1 to s2
 12815        when 'I'
 12816           move +2 to s2
 12817        when 'G'
 12818           move +3 to s2
 12819        when 'L'
 12820           move +4 to s2
 12821        when 'P'
 12822           move +5 to s2
 12823     end-evaluate
 12824     SUBTRACT +1 FROM CS-NO-OF-CLAIMS (S1 S2)
 12825     IF CS-NO-OF-CLAIMS (S1 S2) < ZEROS
 12826        MOVE ZEROS               TO CS-NO-OF-CLAIMS (S1 S2)
 12827     END-IF
 12828     if cs-no-of-claims (s1 s2) = zeros
 12829        move spaces              to cs-claim-type (s1 s2)
 12830     end-if
 12831
 12832
 12833* EXEC CICS REWRITE
 12834*       DATASET   ('ELCRTT')
 12835*       FROM      (CERTIFICATE-TRAILERS)
 12836*    END-EXEC
 12837     MOVE LENGTH OF
 12838      CERTIFICATE-TRAILERS
 12839       TO DFHEIV11
 12840     MOVE 'ELCRTT' TO DFHEIV1
 12841*    MOVE '&& L                  %   #00011028' TO DFHEIV0
 12842     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12843     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12844     MOVE X'2020233030303131303238' TO DFHEIV0(25:11)
 12845     CALL 'kxdfhei1' USING DFHEIV0,
 12846           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 242
* EL131.cbl
 12847           CERTIFICATE-TRAILERS,
 12848           DFHEIV11,
 12849           DFHEIV99
 12850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12851     .
 12852 3010-CERT-NOT-FOUND.
 12853
 12854
 12855* EXEC CICS DELETE
 12856*        DATASET  (CLMS-FILE-ID)
 12857*    END-EXEC.
 12858*    MOVE '&(                    &   #00011035' TO DFHEIV0
 12859     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12860     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12861     MOVE X'2020233030303131303335' TO DFHEIV0(25:11)
 12862     CALL 'kxdfhei1' USING DFHEIV0,
 12863           CLMS-FILE-ID,
 12864           DFHEIV99,
 12865           DFHEIV99,
 12866           DFHEIV99,
 12867           DFHEIV99
 12868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12869
 12870
 12871 3010-EXIT.
 12872      EXIT.
 12873
 12874 3020-UPDATE-CERT.
 12875
 12876* EXEC CICS READ UPDATE
 12877*         DATASET  (CERT-FILE-ID)
 12878*         RIDFLD   (CERT-KEY)
 12879*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12880*    END-EXEC.
 12881*    MOVE '&"S        EU         (   #00011043' TO DFHEIV0
 12882     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12883     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12884     MOVE X'2020233030303131303433' TO DFHEIV0(25:11)
 12885     CALL 'kxdfhei1' USING DFHEIV0,
 12886           CERT-FILE-ID,
 12887           DFHEIV20,
 12888           DFHEIV99,
 12889           CERT-KEY,
 12890           DFHEIV99,
 12891           DFHEIV99,
 12892           DFHEIV99
 12893     SET ADDRESS OF CERTIFICATE-MASTER TO
 12894         DFHEIV20
 12895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12896
 12897
 12898     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 12899
 12900
 12901* EXEC CICS HANDLE CONDITION
 12902*         DUPKEY   (3020-EXIT)
 12903*    END-EXEC.
 12904*    MOVE '"$$                   ! ? #00011051' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 243
* EL131.cbl
 12905     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12906     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12907     MOVE X'3F20233030303131303531' TO DFHEIV0(25:11)
 12908     CALL 'kxdfhei1' USING DFHEIV0
 12909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12910
 12911
 12912
 12913* EXEC CICS REWRITE
 12914*         DATASET  (CERT-FILE-ID)
 12915*         FROM     (CERTIFICATE-MASTER)
 12916*    END-EXEC.
 12917     MOVE LENGTH OF
 12918      CERTIFICATE-MASTER
 12919       TO DFHEIV11
 12920*    MOVE '&& L                  %   #00011055' TO DFHEIV0
 12921     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12922     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12923     MOVE X'2020233030303131303535' TO DFHEIV0(25:11)
 12924     CALL 'kxdfhei1' USING DFHEIV0,
 12925           CERT-FILE-ID,
 12926           CERTIFICATE-MASTER,
 12927           DFHEIV11,
 12928           DFHEIV99
 12929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12930
 12931
 12932 3020-EXIT.
 12933     EXIT.
 12934
 12935 3030-DELETE-CERT.
 12936
 12937* EXEC CICS READ UPDATE
 12938*         DATASET  (CERT-FILE-ID)
 12939*         RIDFLD   (CERT-KEY)
 12940*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12941*    END-EXEC.
 12942*    MOVE '&"S        EU         (   #00011064' TO DFHEIV0
 12943     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12944     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12945     MOVE X'2020233030303131303634' TO DFHEIV0(25:11)
 12946     CALL 'kxdfhei1' USING DFHEIV0,
 12947           CERT-FILE-ID,
 12948           DFHEIV20,
 12949           DFHEIV99,
 12950           CERT-KEY,
 12951           DFHEIV99,
 12952           DFHEIV99,
 12953           DFHEIV99
 12954     SET ADDRESS OF CERTIFICATE-MASTER TO
 12955         DFHEIV20
 12956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12957
 12958
 12959
 12960* EXEC CICS DELETE
 12961*         DATASET   (CERT-FILE-ID)
 12962*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 244
* EL131.cbl
 12963*    MOVE '&(                    &   #00011070' TO DFHEIV0
 12964     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12965     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12966     MOVE X'2020233030303131303730' TO DFHEIV0(25:11)
 12967     CALL 'kxdfhei1' USING DFHEIV0,
 12968           CERT-FILE-ID,
 12969           DFHEIV99,
 12970           DFHEIV99,
 12971           DFHEIV99,
 12972           DFHEIV99
 12973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12974
 12975
 12976 3030-EXIT.
 12977     EXIT.
 12978
 12979 3040-DELETE-TRLR.
 12980
 12981* EXEC CICS READ
 12982*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12983*         DATASET  (TRLR-FILE-ID)
 12984*         RIDFLD   (TRLR-KEY)
 12985*         GTEQ
 12986*    END-EXEC.
 12987*    MOVE '&"S        G          (   #00011078' TO DFHEIV0
 12988     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12989     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12990     MOVE X'2020233030303131303738' TO DFHEIV0(25:11)
 12991     CALL 'kxdfhei1' USING DFHEIV0,
 12992           TRLR-FILE-ID,
 12993           DFHEIV20,
 12994           DFHEIV99,
 12995           TRLR-KEY,
 12996           DFHEIV99,
 12997           DFHEIV99,
 12998           DFHEIV99
 12999     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13000         DFHEIV20
 13001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13002
 13003
 13004     IF PI-COMPANY-CD = AT-COMPANY-CD
 13005        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 13006        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13007           GO TO 3040-EXIT
 13008        ELSE
 13009           NEXT SENTENCE
 13010     ELSE
 13011        GO TO 3040-EXIT.
 13012
 13013
 13014* EXEC CICS DELETE
 13015*         DATASET  (TRLR-FILE-ID)
 13016*         RIDFLD   (TRLR-KEY)
 13017*    END-EXEC.
 13018*    MOVE '&(  R                 &   #00011094' TO DFHEIV0
 13019     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13020     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 245
* EL131.cbl
 13021     MOVE X'2020233030303131303934' TO DFHEIV0(25:11)
 13022     CALL 'kxdfhei1' USING DFHEIV0,
 13023           TRLR-FILE-ID,
 13024           TRLR-KEY,
 13025           DFHEIV99,
 13026           DFHEIV99,
 13027           DFHEIV99
 13028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13029
 13030
 13031     GO TO 3040-DELETE-TRLR.
 13032
 13033 3040-EXIT.
 13034     EXIT.
 13035
 13036 3050-DELETE-ACTQ.
 13037
 13038* EXEC CICS READNEXT
 13039*         DATASET  (ACTQ-FILE-ID)
 13040*         RIDFLD   (ACTQ-KEY)
 13041*         INTO     (ACTIVITY-QUE)
 13042*    END-EXEC.
 13043     MOVE LENGTH OF
 13044      ACTIVITY-QUE
 13045       TO DFHEIV12
 13046     MOVE 0
 13047       TO DFHEIV11
 13048*    MOVE '&.IL                  )   #00011105' TO DFHEIV0
 13049     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13050     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13051     MOVE X'2020233030303131313035' TO DFHEIV0(25:11)
 13052     CALL 'kxdfhei1' USING DFHEIV0,
 13053           ACTQ-FILE-ID,
 13054           ACTIVITY-QUE,
 13055           DFHEIV12,
 13056           ACTQ-KEY,
 13057           DFHEIV99,
 13058           DFHEIV11,
 13059           DFHEIV99,
 13060           DFHEIV99
 13061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13062
 13063
 13064     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 13065         GO TO 3050-EXIT.
 13066
 13067
 13068* EXEC CICS ENDBR
 13069*         DATASET  (ACTQ-FILE-ID)
 13070*    END-EXEC.
 13071     MOVE 0
 13072       TO DFHEIV11
 13073*    MOVE '&2                    $   #00011114' TO DFHEIV0
 13074     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13075     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13076     MOVE X'2020233030303131313134' TO DFHEIV0(25:11)
 13077     CALL 'kxdfhei1' USING DFHEIV0,
 13078           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 246
* EL131.cbl
 13079           DFHEIV11,
 13080           DFHEIV99
 13081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13082
 13083
 13084
 13085* EXEC CICS DELETE
 13086*         DATASET   (ACTQ-FILE-ID)
 13087*         RIDFLD    (ACTQ-KEY)
 13088*    END-EXEC.
 13089*    MOVE '&(  R                 &   #00011118' TO DFHEIV0
 13090     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13091     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13092     MOVE X'2020233030303131313138' TO DFHEIV0(25:11)
 13093     CALL 'kxdfhei1' USING DFHEIV0,
 13094           ACTQ-FILE-ID,
 13095           ACTQ-KEY,
 13096           DFHEIV99,
 13097           DFHEIV99,
 13098           DFHEIV99
 13099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13100
 13101
 13102
 13103* EXEC CICS STARTBR
 13104*         DATASET   (ACTQ-FILE-ID)
 13105*         RIDFLD    (ACTQ-KEY)
 13106*    END-EXEC.
 13107     MOVE 0
 13108       TO DFHEIV11
 13109*    MOVE '&,         G          &   #00011123' TO DFHEIV0
 13110     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13111     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13112     MOVE X'2020233030303131313233' TO DFHEIV0(25:11)
 13113     CALL 'kxdfhei1' USING DFHEIV0,
 13114           ACTQ-FILE-ID,
 13115           ACTQ-KEY,
 13116           DFHEIV99,
 13117           DFHEIV11,
 13118           DFHEIV99
 13119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13120
 13121
 13122     GO TO 3050-DELETE-ACTQ.
 13123
 13124 3050-EXIT.
 13125     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 247
* EL131.cbl
 13127 3060-READ-TRLR.
 13128
 13129* EXEC CICS HANDLE CONDITION
 13130*         NOTFND    (3060-EXIT)
 13131*         ENDFILE   (3060-EXIT)
 13132*    END-EXEC.
 13133*    MOVE '"$I''                  ! @ #00011134' TO DFHEIV0
 13134     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13135     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13136     MOVE X'4020233030303131313334' TO DFHEIV0(25:11)
 13137     CALL 'kxdfhei1' USING DFHEIV0
 13138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13139
 13140
 13141 3060-LOOP.
 13142
 13143* EXEC CICS READNEXT
 13144*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13145*         DATASET  (TRLR-FILE-ID)
 13146*         RIDFLD   (TRLR-KEY)
 13147*    END-EXEC.
 13148     MOVE 0
 13149       TO DFHEIV11
 13150*    MOVE '&.S                   )   #00011140' TO DFHEIV0
 13151     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13152     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13153     MOVE X'2020233030303131313430' TO DFHEIV0(25:11)
 13154     CALL 'kxdfhei1' USING DFHEIV0,
 13155           TRLR-FILE-ID,
 13156           DFHEIV20,
 13157           DFHEIV99,
 13158           TRLR-KEY,
 13159           DFHEIV99,
 13160           DFHEIV11,
 13161           DFHEIV99,
 13162           DFHEIV99
 13163     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13164         DFHEIV20
 13165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13166
 13167
 13168     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13169         GO TO 3060-EXIT.
 13170
 13171     IF FORM-CONTROL-TR
 13172         IF AT-RECORDED-DT = SAVE-BIN-DATE
 13173             NEXT SENTENCE
 13174         ELSE
 13175             MOVE 'X'            TO ERROR-SWITCH
 13176             GO TO 3060-EXIT
 13177     ELSE
 13178         IF PAYMENT-TR OR CORRESPONDENCE-TR
 13179            MOVE 'X'                 TO ERROR-SWITCH
 13180            GO TO 3060-EXIT.
 13181
 13182     GO TO 3060-LOOP.
 13183
 13184 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 248
* EL131.cbl
 13185     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 249
* EL131.cbl
 13187 3997-GET-ERPDEF.
 13188
 13189     move cl-company-cd          to cert-company-code
 13190     move cl-cert-key-data       to cert-key (2:21)
 13191     move cl-cert-no             to cert-cert
 13192
 13193
 13194* EXEC CICS READ
 13195*        DATASET   (CERT-FILE-ID)
 13196*        RIDFLD    (CERT-KEY)
 13197*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13198*        resp      (ws-response)
 13199*    END-EXEC
 13200*    MOVE '&"S        E          (  N#00011171' TO DFHEIV0
 13201     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13202     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13203     MOVE X'204E233030303131313731' TO DFHEIV0(25:11)
 13204     CALL 'kxdfhei1' USING DFHEIV0,
 13205           CERT-FILE-ID,
 13206           DFHEIV20,
 13207           DFHEIV99,
 13208           CERT-KEY,
 13209           DFHEIV99,
 13210           DFHEIV99,
 13211           DFHEIV99
 13212     SET ADDRESS OF CERTIFICATE-MASTER TO
 13213         DFHEIV20
 13214     MOVE EIBRESP  TO ws-response
 13215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13216
 13217     MOVE SPACES                 TO WS-CRIT-PER-RECURRENT
 13218                                    WS-ERPDEF-SW
 13219     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 13220                                    WS-CRIT-PER-RTW-MOS
 13221
 13222     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 13223     MOVE CM-STATE               TO ERPDEF-STATE
 13224     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 13225     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 13226     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
 13227     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 13228     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 13229
 13230
 13231* EXEC CICS STARTBR
 13232*        DATASET  ('ERPDEF')
 13233*        RIDFLD   (ERPDEF-KEY)
 13234*        GTEQ
 13235*        RESP     (WS-RESPONSE)
 13236*    END-EXEC
 13237     MOVE 'ERPDEF' TO DFHEIV1
 13238     MOVE 0
 13239       TO DFHEIV11
 13240*    MOVE '&,         G          &  N#00011191' TO DFHEIV0
 13241     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13242     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13243     MOVE X'204E233030303131313931' TO DFHEIV0(25:11)
 13244     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 250
* EL131.cbl
 13245           DFHEIV1,
 13246           ERPDEF-KEY,
 13247           DFHEIV99,
 13248           DFHEIV11,
 13249           DFHEIV99
 13250     MOVE EIBRESP  TO WS-RESPONSE
 13251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13252
 13253     IF WS-RESP-NORMAL
 13254
 13255* EXEC CICS READNEXT
 13256*          DATASET  ('ERPDEF')
 13257*          INTO     (PRODUCT-MASTER)
 13258*          RIDFLD   (ERPDEF-KEY)
 13259*          RESP     (WS-RESPONSE)
 13260*       END-EXEC
 13261     MOVE LENGTH OF
 13262      PRODUCT-MASTER
 13263       TO DFHEIV12
 13264     MOVE 'ERPDEF' TO DFHEIV1
 13265     MOVE 0
 13266       TO DFHEIV11
 13267*    MOVE '&.IL                  )  N#00011199' TO DFHEIV0
 13268     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13269     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13270     MOVE X'204E233030303131313939' TO DFHEIV0(25:11)
 13271     CALL 'kxdfhei1' USING DFHEIV0,
 13272           DFHEIV1,
 13273           PRODUCT-MASTER,
 13274           DFHEIV12,
 13275           ERPDEF-KEY,
 13276           DFHEIV99,
 13277           DFHEIV11,
 13278           DFHEIV99,
 13279           DFHEIV99
 13280     MOVE EIBRESP  TO WS-RESPONSE
 13281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13282        IF WS-RESP-NORMAL
 13283           IF (ERPDEF-KEY-SAVE (1:16) =
 13284              PD-CONTROL-PRIMARY (1:16))
 13285              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 13286              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 13287                 (A1 > +8)
 13288                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 13289              END-PERFORM
 13290              IF A1 < +9
 13291                 SET ERPDEF-FOUND TO TRUE
 13292                 MOVE PD-CRIT-PERIOD (A1)
 13293                              TO WS-CRITICAL-PERIOD
 13294                 MOVE PD-REC-CRIT-PERIOD (A1)
 13295                              TO WS-CRIT-PER-RECURRENT
 13296                 IF PD-RTW-MOS (A1) NUMERIC
 13297                    MOVE PD-RTW-MOS (A1)
 13298                              TO WS-CRIT-PER-RTW-MOS
 13299                 ELSE
 13300                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 13301                 END-IF
 13302                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 251
* EL131.cbl
 13303                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 13304                                 TO WS-EXCL-PERIOD
 13305                 END-IF
 13306                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 13307                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 13308                                 TO WS-COV-ENDS
 13309                 END-IF
 13310                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 13311                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 13312                                 TO WS-ACC-PERIOD
 13313                 END-IF
 13314              END-IF
 13315           END-IF
 13316        END-IF
 13317     END-IF
 13318
 13319     .
 13320 3997-EXIT.
 13321     EXIT.
 13322 4000-FORCE-ERRORS.
 13323     IF PI-RETURN-CD-1 = 'X'
 13324         MOVE ER-0311            TO EMI-ERROR
 13325         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13326         MOVE -1                 TO MAINTL
 13327         GO TO 8110-SEND-DATA.
 13328
 13329     IF NOT FORCE-CAP
 13330         MOVE ER-0416            TO EMI-ERROR
 13331         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13332         MOVE -1                 TO MAINTL
 13333         GO TO 8110-SEND-DATA.
 13334
 13335     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 13336     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 13337     IF EMI-FATAL-CTR GREATER THAN ZERO
 13338         GO TO 4000-FATAL-ERRORS.
 13339
 13340     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 13341
 13342     IF EMI-FATAL-CTR GREATER THAN ZERO
 13343         GO TO 4000-FATAL-ERRORS.
 13344
 13345     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 13346
 13347     IF EMI-FATAL-CTR GREATER THAN ZERO
 13348         GO TO 4000-FATAL-ERRORS.
 13349
 13350     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 13351     MOVE AL-UANOF               TO CERTA.
 13352     MOVE ER-0000 TO EMI-ERROR.
 13353     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13354
 13355 4000-FATAL-ERRORS.
 13356     MOVE -1                     TO MAINTL.
 13357     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 252
* EL131.cbl
 13359 5000-BUILD-MAP.
 13360     IF PI-RETURN-CD-1 = SPACE
 13361         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 13362
 13363     MOVE SPACE                  TO PI-RETURN-CD-1.
 13364
 13365     MOVE LOW-VALUES             TO EL131AI.
 13366
 13367     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 13368     MOVE PI-CARRIER             TO CARRIER-CODE.
 13369     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 13370     MOVE PI-CERT-NO             TO CERT-NO.
 13371
 13372 5000-READ-CLAIM-MASTER.
 13373
 13374
 13375* EXEC CICS READ
 13376*         SET      (ADDRESS OF CLAIM-MASTER)
 13377*         DATASET  (CLMS-FILE-ID)
 13378*         RIDFLD   (MSTR-KEY)
 13379*    END-EXEC.
 13380*    MOVE '&"S        E          (   #00011297' TO DFHEIV0
 13381     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13382     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13383     MOVE X'2020233030303131323937' TO DFHEIV0(25:11)
 13384     CALL 'kxdfhei1' USING DFHEIV0,
 13385           CLMS-FILE-ID,
 13386           DFHEIV20,
 13387           DFHEIV99,
 13388           MSTR-KEY,
 13389           DFHEIV99,
 13390           DFHEIV99,
 13391           DFHEIV99
 13392     SET ADDRESS OF CLAIM-MASTER TO
 13393         DFHEIV20
 13394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13395
 13396
 13397     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 13398
 13399 5000-READ-DIAGNOSIS-TRAILER.
 13400
 13401
 13402* EXEC CICS HANDLE CONDITION
 13403*         NOTFND (5000-TRLR-NOT-FOUND)
 13404*    END-EXEC.
 13405*    MOVE '"$I                   ! A #00011307' TO DFHEIV0
 13406     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13407     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13408     MOVE X'4120233030303131333037' TO DFHEIV0(25:11)
 13409     CALL 'kxdfhei1' USING DFHEIV0
 13410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13411
 13412
 13413     MOVE MSTR-KEY               TO TRLR-KEY.
 13414     MOVE NINETY                 TO TRLR-SEQ-NO.
 13415
 13416
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 253
* EL131.cbl
 13417* EXEC CICS READ
 13418*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13419*         DATASET  (TRLR-FILE-ID)
 13420*         RIDFLD   (TRLR-KEY)
 13421*    END-EXEC.
 13422*    MOVE '&"S        E          (   #00011314' TO DFHEIV0
 13423     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13424     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13425     MOVE X'2020233030303131333134' TO DFHEIV0(25:11)
 13426     CALL 'kxdfhei1' USING DFHEIV0,
 13427           TRLR-FILE-ID,
 13428           DFHEIV20,
 13429           DFHEIV99,
 13430           TRLR-KEY,
 13431           DFHEIV99,
 13432           DFHEIV99,
 13433           DFHEIV99
 13434     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13435         DFHEIV20
 13436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13437
 13438
 13439     MOVE AT-INFO-LINE-1         TO DIAGO.
 13440
 13441 5000-READ-CERTIFICATE-MASTER.
 13442
 13443     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 13444     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 13445     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 13446     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 13447     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 13448     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 13449     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 13450
 13451
 13452* EXEC CICS HANDLE CONDITION
 13453*         NOTFND (5000-CERT-NOT-FOUND)
 13454*    END-EXEC.
 13455*    MOVE '"$I                   ! B #00011332' TO DFHEIV0
 13456     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13457     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13458     MOVE X'4220233030303131333332' TO DFHEIV0(25:11)
 13459     CALL 'kxdfhei1' USING DFHEIV0
 13460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13461
 13462
 13463
 13464* EXEC CICS READ
 13465*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13466*         DATASET  (CERT-FILE-ID)
 13467*         RIDFLD   (CERT-KEY)
 13468*    END-EXEC.
 13469*    MOVE '&"S        E          (   #00011336' TO DFHEIV0
 13470     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13471     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13472     MOVE X'2020233030303131333336' TO DFHEIV0(25:11)
 13473     CALL 'kxdfhei1' USING DFHEIV0,
 13474           CERT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 254
* EL131.cbl
 13475           DFHEIV20,
 13476           DFHEIV99,
 13477           CERT-KEY,
 13478           DFHEIV99,
 13479           DFHEIV99,
 13480           DFHEIV99
 13481     SET ADDRESS OF CERTIFICATE-MASTER TO
 13482         DFHEIV20
 13483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13484
 13485
 13486     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 13487     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 13488
 13489     GO TO 5000-EXIT.
 13490
 13491 5000-TRLR-NOT-FOUND.
 13492     MOVE ER-7687                TO EMI-ERROR.
 13493     MOVE -1                     TO DIAGL.
 13494     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13495     GO TO 5000-EXIT.
 13496
 13497 5000-CERT-NOT-FOUND.
 13498     MOVE ER-0206                TO EMI-ERROR.
 13499     MOVE -1                     TO CERTL.
 13500     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13501
 13502 5000-EXIT.
 13503     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 255
* EL131.cbl
 13505 5010-RESET-PI-AREA.
 13506     IF CERTI GREATER THAN LOW-VALUES
 13507         MOVE CERTI              TO PI-CERT-PRIME.
 13508
 13509     IF SUFXI GREATER THAN LOW-VALUES
 13510         MOVE SUFXI              TO PI-CERT-SFX.
 13511
 13512     IF CERTEFFI GREATER THAN LOW-VALUES
 13513         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 13514
 13515     IF CERTACTI GREATER THAN LOW-VALUES
 13516         MOVE CERTACTI           TO PI-ACCOUNT.
 13517
 13518     IF CERTSTI GREATER THAN LOW-VALUES
 13519         MOVE CERTSTI            TO PI-STATE.
 13520
 13521     IF CERTCARI GREATER THAN LOW-VALUES
 13522         MOVE CERTCARI           TO PI-CARRIER.
 13523
 13524     IF CERTGRPI GREATER THAN LOW-VALUES
 13525         MOVE CERTGRPI           TO PI-GROUPING.
 13526
 13527 5010-EXIT.
 13528     EXIT.
 13529
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 256
* EL131.cbl
 13531 5020-MOVE-MSTR.
 13532
 13533     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 13534     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 13535     MOVE WS-CLAIM-SEQU          TO SEQUO.
 13536     MOVE AL-SABON               TO SEQUA.
 13537     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 13538     MOVE CL-CLAIM-TYPE          TO TYPEO
 13539                                    pi-claim-type
 13540
 13541     IF CL-TOTAL-PAID-AMT  = +0 AND
 13542        CL-LAST-PMT-AMT    = +0 AND
 13543        CL-NO-OF-PMTS-MADE = +0
 13544          MOVE AL-UANON          TO TYPEA.
 13545
 13546     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 13547     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 13548     MOVE CL-CERT-PRIME          TO CERTO.
 13549     MOVE CL-CERT-SFX            TO SUFXO.
 13550     MOVE CL-CERT-CARRIER        TO CARRO.
 13551
 13552     IF CL-CLAIM-STATUS = 'C'
 13553         MOVE 'CLOSED'           TO STATUSO
 13554     ELSE
 13555         MOVE 'OPEN  '           TO STATUSO.
 13556
 13557     move cl-accident-claim-sw   to accswo
 13558     MOVE CL-PROCESSOR-ID        TO PROCO.
 13559
 13560     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 13561     MOVE CL-CCN                 TO CCNOO.
 13562
 13563     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 13564     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 13565     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 13566     MOVE CL-INSURED-SEX-CD      TO SEXO.
 13567
 13568     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 13569         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 13570         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13571         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13572         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 13573     ELSE
 13574         MOVE SPACES             TO BIRTHO.
 13575
 13576     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 13577        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 13578         NEXT SENTENCE
 13579       ELSE
 13580         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 13581
 13582     IF PI-COMPANY-ID = 'DMD'
 13583       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
 13584          IF SOCIALO = SPACES OR LOW-VALUES
 13585            MOVE ER-0885         TO EMI-ERROR
 13586            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13587
 13588     MOVE CL-INSURED-OCC-CD      TO OCCO.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 257
* EL131.cbl
 13589     MOVE CL-CAUSE-CD            TO CAUSEO.
 13590
 13591     IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 13592         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 13593         MOVE SPACES                 TO DC-OPTION-CODE
 13594         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13595         MOVE DC-GREG-DATE-1-EDIT TO ENDO
 13596     ELSE
 13597         MOVE SPACES             TO ENDO.
 13598
 13599     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 13600        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 13601        MOVE SPACES             TO DC-OPTION-CODE
 13602        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13603        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 13604        IF PI-USES-PAID-TO
 13605           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 13606           MOVE '6'                TO DC-OPTION-CODE
 13607           MOVE +1                 TO DC-ELAPSED-DAYS
 13608           MOVE +0                 TO DC-ELAPSED-MONTHS
 13609           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13610           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 13611        ELSE
 13612           NEXT SENTENCE
 13613     ELSE
 13614        MOVE SPACES             TO PDTHRUO.
 13615
 13616     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 13617     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 13618     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 13619     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 13620
 13621     IF MODIFY-CAP
 13622        MOVE AL-UNNOF            TO PDAMTA
 13623                                    NODAYSA
 13624                                    NOPMTSA
 13625        MOVE AL-UANOF            TO PDTHRUA.
 13626     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 13627     MOVE '2'                    TO CNTL-REC-TYPE
 13628     MOVE +0                     TO CNTL-SEQ-NO
 13629     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 13630
 13631
 13632* EXEC CICS READ
 13633*         DATASET  (CNTL-FILE-ID)
 13634*         SET      (ADDRESS OF CONTROL-FILE)
 13635*         RIDFLD   (CNTL-KEY)
 13636*         RESP     (WS-RESPONSE)
 13637*    END-EXEC
 13638*    MOVE '&"S        E          (  N#00011487' TO DFHEIV0
 13639     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13640     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13641     MOVE X'204E233030303131343837' TO DFHEIV0(25:11)
 13642     CALL 'kxdfhei1' USING DFHEIV0,
 13643           CNTL-FILE-ID,
 13644           DFHEIV20,
 13645           DFHEIV99,
 13646           CNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 258
* EL131.cbl
 13647           DFHEIV99,
 13648           DFHEIV99,
 13649           DFHEIV99
 13650     SET ADDRESS OF CONTROL-FILE TO
 13651         DFHEIV20
 13652     MOVE EIBRESP  TO WS-RESPONSE
 13653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13654
 13655     IF WS-RESP-NORMAL
 13656        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 13657     end-if
 13658     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 13659         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13660         MOVE SPACES             TO DC-OPTION-CODE
 13661         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13662         MOVE DC-GREG-DATE-1-EDIT TO INCO
 13663     ELSE
 13664         MOVE SPACES             TO INCO.
 13665
 13666     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 13667        or (pi-approval-level = '4')
 13668        MOVE AL-UANOF            TO INCA
 13669     end-if
 13670     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 13671
 13672     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 13673         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 13674         MOVE SPACES             TO DC-OPTION-CODE
 13675         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13676         MOVE DC-GREG-DATE-1-EDIT TO REPO
 13677     ELSE
 13678         MOVE SPACES             TO REPO.
 13679
 13680     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 13681         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 13682         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13683         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13684         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 13685     ELSE
 13686         MOVE SPACES             TO ESTO.
 13687
 13688     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 13689         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 13690         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13691         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13692         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 13693     ELSE
 13694         MOVE SPACES             TO MNTDTO.
 13695
 13696
 13697     IF CL-LAST-MAINT-TYPE = SPACE
 13698         MOVE 'SET-UP'           TO MNTTYPEO
 13699     ELSE
 13700     IF CL-LAST-MAINT-TYPE = '1'
 13701         MOVE 'PAYMNT'           TO MNTTYPEO
 13702     ELSE
 13703     IF CL-LAST-MAINT-TYPE = '2'
 13704         MOVE 'LETTER'           TO MNTTYPEO
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 259
* EL131.cbl
 13705     ELSE
 13706     IF CL-LAST-MAINT-TYPE = '3'
 13707         MOVE 'UPDATE'           TO MNTTYPEO
 13708     ELSE
 13709     IF CL-LAST-MAINT-TYPE = '4'
 13710         MOVE 'RESTOR'           TO MNTTYPEO
 13711     ELSE
 13712     IF CL-LAST-MAINT-TYPE = '5'
 13713         MOVE 'INC DT'           TO MNTTYPEO
 13714     ELSE
 13715     IF CL-LAST-MAINT-TYPE = '6'
 13716         MOVE ' CONV'            TO MNTTYPEO
 13717     ELSE
 13718     IF CL-LAST-MAINT-TYPE = 'C'
 13719         MOVE 'CHGBEN'           TO MNTTYPEO
 13720     ELSE
 13721     IF CL-LAST-MAINT-TYPE = 'E'
 13722         MOVE 'ERRCOR'           TO MNTTYPEO
 13723     ELSE
 13724         MOVE SPACES             TO MNTTYPEO.
 13725
 13726     MOVE CL-BENEFICIARY         TO BENEO.
 13727     MOVE CL-FILE-LOCATION       TO FILETOO.
 13728     IF CL-CRITICAL-PERIOD NOT NUMERIC
 13729        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 13730     END-IF
 13731     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 13732     MOVE CL-CRIT-PER-RECURRENT
 13733                                 TO CRITPTO
 13734     IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 13735        MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 13736     END-IF
 13737     MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 13738     MOVE CL-PRIORITY-CD         TO PRICDO.
 13739     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 13740     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 13741     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 13742     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 13743
 13744 5020-EXIT.
 13745     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 260
* EL131.cbl
 13747 5030-MOVE-CERT.
 13748
 13749     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 13750         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 13751         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13752         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13753         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 13754       ELSE
 13755         MOVE SPACES             TO CERTEFFO
 13756         MOVE ZERO               TO HOLD-DATE.
 13757
 13758     MOVE CM-ACCOUNT             TO CERTACTO.
 13759     MOVE CM-STATE               TO CERTSTO PI-STATE.
 13760     MOVE CM-GROUPING            TO CERTGRPO.
 13761     MOVE CM-CARRIER             TO CERTCARO.
 13762     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 13763     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 13764     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 13765     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 13766     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 13767     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 13768     MOVE CM-JT-INITIAL          TO JNTINITO.
 13769     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 13770
 13771*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 13772     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 13773     MOVE '3'                    TO CNTL-REC-TYPE.
 13774     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 13775     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 13776     MOVE ZERO                   TO CNTL-SEQ-NO.
 13777
 13778
 13779* EXEC CICS READ
 13780*         SET        (ADDRESS OF CONTROL-FILE)
 13781*         DATASET    ('ELCNTL')
 13782*         RIDFLD     (CNTL-KEY)
 13783*         RESP       (WS-RESPONSE)
 13784*    END-EXEC.
 13785     MOVE 'ELCNTL' TO DFHEIV1
 13786*    MOVE '&"S        E          (  N#00011617' TO DFHEIV0
 13787     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13788     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13789     MOVE X'204E233030303131363137' TO DFHEIV0(25:11)
 13790     CALL 'kxdfhei1' USING DFHEIV0,
 13791           DFHEIV1,
 13792           DFHEIV20,
 13793           DFHEIV99,
 13794           CNTL-KEY,
 13795           DFHEIV99,
 13796           DFHEIV99,
 13797           DFHEIV99
 13798     SET ADDRESS OF CONTROL-FILE TO
 13799         DFHEIV20
 13800     MOVE EIBRESP  TO WS-RESPONSE
 13801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13802
 13803
 13804     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 261
* EL131.cbl
 13805        MOVE ZERO                TO CP-FREE-LOOK
 13806     ELSE
 13807        MOVE CF-ST-FREE-LOOK-PERIOD
 13808                                 TO CP-FREE-LOOK.
 13809
 13810     IF CM-LF-BENEFIT-CD = '00'
 13811        GO TO 5030-MOVE-CERT-AH.
 13812
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 262
* EL131.cbl
 13814     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 13815     MOVE '5'                    TO DC-OPTION-CODE
 13816     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13817     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 13818     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 13819     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 13820     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 13821     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 13822     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13823     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 13824     MOVE '4'                    TO CP-REM-TERM-METHOD
 13825     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 13826     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13827     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 13828
 13829     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 13830     IF CM-LF-PREMIUM-RATE NUMERIC
 13831         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 13832     ELSE
 13833         MOVE ZEROS              TO LCVRATEO.
 13834
 13835     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 13836         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 13837
 13838     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 13839
 13840     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 13841
 13842     IF CM-LF-CURRENT-STATUS = '8'
 13843        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 13844            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 13845            MOVE ' '             TO DC-OPTION-CODE
 13846            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13847            IF NOT DATE-CONVERSION-ERROR
 13848                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 13849
 13850     IF CM-LF-CURRENT-STATUS = '7'
 13851        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13852            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 13853            MOVE ' '             TO DC-OPTION-CODE
 13854            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13855            IF NOT DATE-CONVERSION-ERROR
 13856                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 13857
 13858     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 13859         MOVE ' '                TO DC-OPTION-CODE
 13860         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 13861         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13862         IF NOT DATE-CONVERSION-ERROR
 13863             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 13864             MOVE HOLD-MONTH     TO WORK-MONTH
 13865             MOVE HOLD-YEAR      TO WORK-YEAR
 13866             MOVE WORK-DATE-MY   TO LCVEXITO.
 13867
 13868     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 13869        IF CP-REMAINING-TERM-3 = ZEROS
 13870           MOVE 'EXPIRED'        TO LCVSTATO
 13871        ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 263
* EL131.cbl
 13872           MOVE 'ACTIVE'         TO LCVSTATO.
 13873
 13874     IF CM-LF-CURRENT-STATUS = '2'
 13875        MOVE 'PEND   '           TO LCVSTATO.
 13876     IF CM-LF-CURRENT-STATUS = '3'
 13877        MOVE 'RESTORE'           TO LCVSTATO.
 13878     IF CM-LF-CURRENT-STATUS = '5'
 13879        MOVE 'REISSUE'           TO LCVSTATO.
 13880     IF CM-LF-CURRENT-STATUS = '6'
 13881        MOVE 'LMP DIS'           TO LCVSTATO.
 13882     IF CM-LF-CURRENT-STATUS = '7'
 13883        MOVE 'DEATH  '           TO LCVSTATO.
 13884     IF CM-LF-CURRENT-STATUS = '8'
 13885        MOVE 'CANCEL '           TO LCVSTATO.
 13886     IF CM-LF-CURRENT-STATUS = '9'
 13887        MOVE 'RE-ONLY'           TO LCVSTATO.
 13888     IF CM-LF-CURRENT-STATUS = 'V'
 13889        MOVE 'VOID   '           TO LCVSTATO.
 13890     IF CM-LF-CURRENT-STATUS = 'D'
 13891        MOVE 'DECLINE'           TO LCVSTATO.
 13892
 13893     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 13894     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 13895     MOVE '4'                    TO BEN-REC-TYPE.
 13896     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 13897     MOVE ZERO                   TO BEN-SEQ-NO.
 13898
 13899
 13900* EXEC CICS READ GTEQ
 13901*         DATASET  (CNTL-FILE-ID)
 13902*         RIDFLD   (BENEFIT-KEY)
 13903*         SET      (ADDRESS OF CONTROL-FILE)
 13904*    END-EXEC.
 13905*    MOVE '&"S        G          (   #00011719' TO DFHEIV0
 13906     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13907     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13908     MOVE X'2020233030303131373139' TO DFHEIV0(25:11)
 13909     CALL 'kxdfhei1' USING DFHEIV0,
 13910           CNTL-FILE-ID,
 13911           DFHEIV20,
 13912           DFHEIV99,
 13913           BENEFIT-KEY,
 13914           DFHEIV99,
 13915           DFHEIV99,
 13916           DFHEIV99
 13917     SET ADDRESS OF CONTROL-FILE TO
 13918         DFHEIV20
 13919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13920
 13921
 13922     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 13923        CF-RECORD-TYPE NOT = '4'
 13924         MOVE ER-0240            TO EMI-ERROR
 13925         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13926         GO TO 5030-MOVE-CERT-FINISH.
 13927
 13928     MOVE ZERO                   TO COUNT-2.
 13929     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 264
* EL131.cbl
 13930
 13931     IF SCREEN-ERROR
 13932         MOVE ER-0282            TO EMI-ERROR
 13933         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13934        ELSE
 13935         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 13936
 13937 5030-MOVE-CERT-AH.
 13938
 13939     IF CM-LF-BENEFIT-CD = '00'
 13940         IF CM-AH-BENEFIT-CD = '00'
 13941             GO TO 5030-MOVE-CERT-FINISH.
 13942
 13943     IF CM-AH-BENEFIT-CD = '00'
 13944        MOVE SPACES             TO ACVKINDO
 13945        COMPUTE PI-PAYMENT-AMT =
 13946                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 13947        GO TO 5030-MOVE-CERT-FINISH.
 13948
 13949     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 13950     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 13951     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 13952     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 13953     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 13954     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13955     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13956     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 13957
 13958**DMD **********************************************
 13959     IF PI-COMPANY-ID = 'DMD'
 13960         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 13961                                   CM-PMT-EXTENSION-DAYS
 13962         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 13963                                      CL-NO-OF-DAYS-PAID
 13964         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 13965             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 13966         MOVE WS-REM-MOS         TO ACVRTRMO
 13967                                    CP-REMAINING-TERM-3
 13968*        MOVE WS-REM-DAYS        TO DAYSPO
 13969         GO TO 5030-SKIP-RTRM.
 13970**DMD **********************************************
 13971
 13972     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13973     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13974     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 13975     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 13976
 13977 5030-SKIP-RTRM.
 13978     IF CM-AH-PREMIUM-RATE NUMERIC
 13979         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 13980     ELSE
 13981         MOVE ZEROS              TO ACVRATEO.
 13982
 13983     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 13984     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 13985
 13986     IF CM-AH-CURRENT-STATUS = '8'
 13987        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 265
* EL131.cbl
 13988            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 13989            MOVE ' '             TO DC-OPTION-CODE
 13990            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13991            IF NOT DATE-CONVERSION-ERROR
 13992                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 13993
 13994     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 13995        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 13996            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 13997            MOVE ' '             TO DC-OPTION-CODE
 13998            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13999            IF NOT DATE-CONVERSION-ERROR
 14000                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 14001
 14002     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 14003        IF CP-REMAINING-TERM-3 = ZEROS
 14004           MOVE 'EXPIRED'        TO ACVSTATO
 14005        ELSE
 14006           MOVE 'ACTIVE'         TO ACVSTATO.
 14007
 14008     IF CM-AH-CURRENT-STATUS = '2'
 14009        MOVE 'PEND   '           TO ACVSTATO.
 14010     IF CM-AH-CURRENT-STATUS = '3'
 14011        MOVE 'RESTORE'           TO ACVSTATO.
 14012     IF CM-AH-CURRENT-STATUS = '5'
 14013        MOVE 'REISSUE'           TO ACVSTATO.
 14014     IF CM-AH-CURRENT-STATUS = '6'
 14015        MOVE 'LMP DIS'           TO ACVSTATO.
 14016     IF CM-AH-CURRENT-STATUS = '7'
 14017        MOVE 'DEATH  '           TO ACVSTATO.
 14018     IF CM-AH-CURRENT-STATUS = '8'
 14019        MOVE 'CANCEL '           TO ACVSTATO.
 14020     IF CM-AH-CURRENT-STATUS = '9'
 14021        MOVE 'RE-ONLY'           TO ACVSTATO.
 14022     IF CM-AH-CURRENT-STATUS = 'V'
 14023        MOVE 'VOID   '           TO ACVSTATO.
 14024     IF CM-AH-CURRENT-STATUS = '9'
 14025        MOVE 'DECLINE'           TO ACVSTATO.
 14026
 14027     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 14028         MOVE ' '                TO DC-OPTION-CODE
 14029         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 14030         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14031         IF NOT DATE-CONVERSION-ERROR
 14032             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 14033             MOVE HOLD-MONTH     TO WORK-MONTH
 14034             MOVE HOLD-YEAR      TO WORK-YEAR
 14035             MOVE WORK-DATE-MY   TO ACVEXITO.
 14036
 14037     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 14038
 14039     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 14040     MOVE '5'                    TO BEN-REC-TYPE.
 14041     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 14042     MOVE ZERO                   TO BEN-SEQ-NO.
 14043
 14044
 14045* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 266
* EL131.cbl
 14046*         DATASET  (CNTL-FILE-ID)
 14047*         RIDFLD   (BENEFIT-KEY)
 14048*         SET      (ADDRESS OF CONTROL-FILE)
 14049*    END-EXEC.
 14050*    MOVE '&"S        G          (   #00011847' TO DFHEIV0
 14051     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14052     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14053     MOVE X'2020233030303131383437' TO DFHEIV0(25:11)
 14054     CALL 'kxdfhei1' USING DFHEIV0,
 14055           CNTL-FILE-ID,
 14056           DFHEIV20,
 14057           DFHEIV99,
 14058           BENEFIT-KEY,
 14059           DFHEIV99,
 14060           DFHEIV99,
 14061           DFHEIV99
 14062     SET ADDRESS OF CONTROL-FILE TO
 14063         DFHEIV20
 14064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14065
 14066
 14067     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 14068        CF-RECORD-TYPE NOT = '5'
 14069         MOVE ER-0250            TO EMI-ERROR
 14070         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14071         GO TO 5030-MOVE-CERT-FINISH.
 14072
 14073     MOVE ZERO                   TO COUNT-2.
 14074     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 14075
 14076     IF SCREEN-ERROR
 14077         MOVE ER-0283            TO EMI-ERROR
 14078         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14079       ELSE
 14080         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 14081
 14082 5030-MOVE-CERT-FINISH.
 14083
 14084     MOVE CM-LOAN-APR            TO APRO.
 14085     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 14086     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 14087     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 14088     MOVE CM-LOAN-NUMBER         TO LOANNOO
 14089     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 14090     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 14091
 14092     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 14093         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 14094         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14095         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14096         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 14097     ELSE
 14098         MOVE SPACES               TO ADDONDTO.
 14099
 14100     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 14101
 14102 5030-EXIT.
 14103     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 267
* EL131.cbl
 14105 5040-FIND-BENEFIT.
 14106     ADD 1                       TO COUNT-2.
 14107     IF COUNT-2 GREATER THAN 8
 14108         GO TO 5050-BENEFIT-NOTFND.
 14109
 14110     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 14111         GO TO 5060-EXIT.
 14112
 14113     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 14114         GO TO 5050-BENEFIT-NOTFND.
 14115
 14116     GO TO 5040-FIND-BENEFIT.
 14117
 14118 5050-BENEFIT-NOTFND.
 14119     MOVE 'X'                    TO ERROR-SWITCH.
 14120
 14121 5060-EXIT.
 14122     EXIT.
 14123
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 268
* EL131.cbl
 14125 6000-CALCULATE-CERT-TERM.
 14126
 14127     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 14128         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 14129     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 14130         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 14131     IF CM-LOAN-APR NOT NUMERIC
 14132         MOVE ZEROS              TO CM-LOAN-APR.
 14133
 14134*    IF WS-CALC-METHOD  = 'G'
 14135         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 14136*     ELSE
 14137*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 14138
 14139     IF N GREATER 120
 14140         MOVE 120                TO N.
 14141
 14142     MOVE '6'                    TO DC-OPTION-CODE.
 14143     MOVE N                      TO DC-ELAPSED-MONTHS.
 14144     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14145     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 14146
 14147     IF CM-LF-BENEFIT-CD NOT = ZERO
 14148         MOVE N                  TO CM-LF-ORIG-TERM
 14149         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 14150         IF NO-CONVERSION-ERROR
 14151             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 14152
 14153     IF CM-AH-BENEFIT-CD NOT = ZERO
 14154         MOVE N                  TO CM-AH-ORIG-TERM
 14155         IF NO-CONVERSION-ERROR
 14156             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 14157
 14158 6000-EXIT.
 14159      EXIT.
 14160
 14161 6100-CALC-GROSS-TERM.
 14162     MOVE CM-LOAN-BALANCE         TO L.
 14163     MOVE PI-PAYMENT-AMT          TO M.
 14164
 14165     COMPUTE N = L / M.
 14166     IF N LESS 1
 14167         MOVE 1  TO N.
 14168
 14169     IF CM-LF-BENEFIT-CD NOT = ZERO
 14170         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 14171     ELSE
 14172         MOVE ZEROS               TO WS-LF-RATE.
 14173
 14174     IF CM-AH-BENEFIT-CD NOT = ZERO
 14175         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 14176     ELSE
 14177         MOVE ZEROS               TO WS-AH-RATE.
 14178
 14179     COMPUTE I = CM-LOAN-APR / +1200.
 14180
 14181 6105-LOOP.
 14182     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 269
* EL131.cbl
 14183         GO TO 6200-EXIT.
 14184     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 14185     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 14186         ADD 1 TO N
 14187         GO TO 6105-LOOP.
 14188
 14189 6200-EXIT.
 14190      EXIT.
 14191
 14192 6210-CALC-LEFT-RIGHTONE.
 14193      MOVE L         TO LEFT-TOT-1.
 14194      SUBTRACT 1 FROM N.
 14195      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 14196      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 14197      ADD 1 TO N.
 14198 6211-CALC-TERM1.
 14199      MOVE N         TO TERM1.
 14200      MULTIPLY M BY TERM1.
 14201 6212-LOOP.
 14202      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 14203      ADD 1 TO A-N.
 14204      MULTIPLY A-N BY TERM1.
 14205      SUBTRACT 1 FROM A-N.
 14206      ADD TERM1 TO LEFT-TOT-1.
 14207 6213-CALC-TERM2.
 14208      MOVE M         TO TERM2.
 14209      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 14210      MULTIPLY IA-N BY TERM2.
 14211      SUBTRACT TERM2 FROM LEFT-TOT-1.
 14212 6215-CALC-RIGHTONE.
 14213      MOVE M         TO RIGHT-TOT-1.
 14214      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 14215      MULTIPLY A-N BY RIGHT-TOT-1.
 14216 6220-EXIT.
 14217      EXIT.
 14218
 14219 6300-CALC-A-N.
 14220     IF N LESS 1
 14221         MOVE 0     TO A-N
 14222         GO TO 6300-EXIT.
 14223     IF I = 0
 14224         MOVE .00001 TO I.
 14225     ADD 1 TO I.
 14226     DIVIDE I INTO 1 GIVING V.
 14227     SUBTRACT 1 FROM I.
 14228     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 14229     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 14230     DIVIDE I INTO TERM3 GIVING A-N.
 14231 6300-EXIT.
 14232      EXIT.
 14233
 14234 6350-CALC-IA-N.
 14235     IF N LESS 1
 14236         MOVE 0      TO IA-N
 14237         GO TO 6400-EXIT.
 14238     ADD 1 TO N.
 14239     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 14240     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 270
* EL131.cbl
 14241     MULTIPLY N BY V-EX-N GIVING TERM3.
 14242     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 14243     SUBTRACT V FROM 1 GIVING TERM4.
 14244     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 14245 6400-EXIT.
 14246      EXIT.
 14247
 14248 6450-CALC-V-EX-N.
 14249     IF N LESS 1
 14250         MOVE 1    TO V-EX-N
 14251         GO TO 6490-EXIT.
 14252     MOVE N        TO NV-STORE.
 14253     IF V-EX-ONETIME = 1  OR
 14254        V NOT = V-EXPONENT (1)
 14255          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 14256 6460-LOOP.
 14257     IF N GREATER 248
 14258         MOVE 248 TO N.
 14259     IF N = 1
 14260         MOVE V               TO V-EX-N
 14261      ELSE
 14262         MOVE V-EXPONENT (N)  TO V-EX-N.
 14263     GO TO 6490-EXIT.
 14264
 14265 6470-BUILD-V-EX-TABLE.
 14266     MOVE 2      TO N.
 14267     MOVE V      TO V-EXPONENT (1)
 14268                    V-EX-N.
 14269 6471-LOOP.
 14270     MULTIPLY V BY V-EX-N.
 14271     MOVE V-EX-N   TO V-EXPONENT (N).
 14272     ADD 1 TO N.
 14273     IF N LESS 248
 14274         GO TO 6471-LOOP.
 14275     MOVE NV-STORE     TO N.
 14276     MOVE 0            TO V-EX-ONETIME.
 14277 6480-EXIT.
 14278      EXIT.
 14279
 14280 6490-EXIT.
 14281      EXIT.
 14282
 14283 6500-CALC-NET-TERM.
 14284     MOVE CM-LOAN-BALANCE         TO L.
 14285     MOVE PI-PAYMENT-AMT          TO M.
 14286
 14287     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 14288     IF WS-REMAIN GREATER ZERO
 14289         ADD 1 TO N.
 14290     IF N = 0
 14291         MOVE 1 TO N.
 14292
 14293 6700-EXIT.
 14294      EXIT.
 14295
 14296 6999-CALC-TERM-EXIT.
 14297     EXIT.
 14298
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 271
* EL131.cbl
 14300 7000-RESET-ATTRIBUTE.
 14301
 14302     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 14303                                    CERTSTA   CERTCARA
 14304                                    CERTGRPA.
 14305     MOVE -1                     TO CERTCARL.
 14306
 14307 7000-EXIT.
 14308     EXIT.
 14309
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 272
* EL131.cbl
 14311 7600-BROWSE-CLAIM.
 14312
 14313
 14314* EXEC CICS READ
 14315*        DATASET(CLMS-FILE-ID)
 14316*        SET    (ADDRESS OF CLAIM-MASTER)
 14317*        RIDFLD (MSTR-KEY)
 14318*        GENERIC
 14319*        EQUAL
 14320*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14321*    END-EXEC.
 14322*    MOVE '&"S  KG    E          (   #00012099' TO DFHEIV0
 14323     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14324     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14325     MOVE X'2020233030303132303939' TO DFHEIV0(25:11)
 14326     CALL 'kxdfhei1' USING DFHEIV0,
 14327           CLMS-FILE-ID,
 14328           DFHEIV20,
 14329           DFHEIV99,
 14330           MSTR-KEY,
 14331           ELMSTR-GENERIC-LENGTH,
 14332           DFHEIV99,
 14333           DFHEIV99
 14334     SET ADDRESS OF CLAIM-MASTER TO
 14335         DFHEIV20
 14336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14337
 14338
 14339     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 14340
 14341     if cl-assoc-cert-total = 0
 14342        move 1 to cl-assoc-cert-total
 14343     end-if
 14344     IF CL-ASSOC-CERT-SEQU = 0
 14345        MOVE 1 TO CL-ASSOC-CERT-SEQU
 14346     END-IF
 14347
 14348     IF CL-ASSOC-CERT-TOTAL = 1
 14349         MOVE AL-SADOF           TO BCERT1A
 14350                                    BSUFX1A
 14351                                    BCERT2A
 14352                                    BSUFX2A
 14353                                    BCERT3A
 14354                                    BSUFX3A
 14355                                    BCERT4A
 14356                                    BSUFX4A
 14357                                    BCERT5A
 14358                                    BSUFX5A
 14359                                    PCERTNOA
 14360                                    PSUFXA
 14361                                    LABEL1A
 14362                                    LABEL2A
 14363         GO TO 7699-EXIT.
 14364
 14365 7610-BROWSE-CLAIM-LOOP.
 14366
 14367     MOVE LOW-VALUES             TO BCERT1O
 14368                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 273
* EL131.cbl
 14369                                    BCERT2O
 14370                                    BSUFX2O
 14371                                    BCERT3O
 14372                                    BSUFX3O
 14373                                    BCERT4O
 14374                                    BSUFX4O
 14375                                    BCERT5O
 14376                                    BSUFX5O.
 14377
 14378
 14379* EXEC CICS HANDLE CONDITION
 14380*        ENDFILE  (7630-END-BROWSE)
 14381*    END-EXEC.
 14382*    MOVE '"$''                   ! C #00012147' TO DFHEIV0
 14383     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14384     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14385     MOVE X'4320233030303132313437' TO DFHEIV0(25:11)
 14386     CALL 'kxdfhei1' USING DFHEIV0
 14387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14388
 14389
 14390
 14391* EXEC CICS STARTBR
 14392*        DATASET    (CLMS-FILE-ID)
 14393*        RIDFLD     (MSTR-KEY)
 14394*    END-EXEC.
 14395     MOVE 0
 14396       TO DFHEIV11
 14397*    MOVE '&,         G          &   #00012151' TO DFHEIV0
 14398     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14399     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14400     MOVE X'2020233030303132313531' TO DFHEIV0(25:11)
 14401     CALL 'kxdfhei1' USING DFHEIV0,
 14402           CLMS-FILE-ID,
 14403           MSTR-KEY,
 14404           DFHEIV99,
 14405           DFHEIV11,
 14406           DFHEIV99
 14407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14408
 14409
 14410     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 14411
 14412 7620-READ-CLAIM-LOOP.
 14413
 14414
 14415* EXEC CICS READNEXT
 14416*        DATASET   (CLMS-FILE-ID)
 14417*        SET       (ADDRESS OF CLAIM-MASTER)
 14418*        RIDFLD    (MSTR-KEY)
 14419*    END-EXEC.
 14420     MOVE 0
 14421       TO DFHEIV11
 14422*    MOVE '&.S                   )   #00012160' TO DFHEIV0
 14423     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14424     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14425     MOVE X'2020233030303132313630' TO DFHEIV0(25:11)
 14426     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 274
* EL131.cbl
 14427           CLMS-FILE-ID,
 14428           DFHEIV20,
 14429           DFHEIV99,
 14430           MSTR-KEY,
 14431           DFHEIV99,
 14432           DFHEIV11,
 14433           DFHEIV99,
 14434           DFHEIV99
 14435     SET ADDRESS OF CLAIM-MASTER TO
 14436         DFHEIV20
 14437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14438
 14439
 14440     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 14441        CL-CARRIER     NOT = CARRI           OR
 14442        CL-CLAIM-NO    NOT = CLAIMI
 14443        GO TO 7630-END-BROWSE.
 14444
 14445     IF WS-ASSOCIATED-CERTS = 1
 14446         MOVE CL-CERT-PRIME      TO BCERT1O
 14447         MOVE CL-CERT-SFX        TO BSUFX1O.
 14448
 14449     IF WS-ASSOCIATED-CERTS = 2
 14450         MOVE CL-CERT-PRIME      TO BCERT2O
 14451         MOVE CL-CERT-SFX        TO BSUFX2O.
 14452
 14453     IF WS-ASSOCIATED-CERTS = 3
 14454         MOVE CL-CERT-PRIME      TO BCERT3O
 14455         MOVE CL-CERT-SFX        TO BSUFX3O.
 14456
 14457     IF WS-ASSOCIATED-CERTS = 4
 14458         MOVE CL-CERT-PRIME      TO BCERT4O
 14459         MOVE CL-CERT-SFX        TO BSUFX4O.
 14460
 14461     IF WS-ASSOCIATED-CERTS = 5
 14462         MOVE CL-CERT-PRIME      TO BCERT5O
 14463         MOVE CL-CERT-SFX        TO BSUFX5O
 14464     ELSE
 14465         ADD +1                  TO WS-ASSOCIATED-CERTS
 14466         GO TO 7620-READ-CLAIM-LOOP.
 14467
 14468 7630-END-BROWSE.
 14469
 14470
 14471* EXEC CICS ENDBR
 14472*        DATASET   (CLMS-FILE-ID)
 14473*    END-EXEC.
 14474     MOVE 0
 14475       TO DFHEIV11
 14476*    MOVE '&2                    $   #00012196' TO DFHEIV0
 14477     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14478     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14479     MOVE X'2020233030303132313936' TO DFHEIV0(25:11)
 14480     CALL 'kxdfhei1' USING DFHEIV0,
 14481           CLMS-FILE-ID,
 14482           DFHEIV11,
 14483           DFHEIV99
 14484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 275
* EL131.cbl
 14485
 14486
 14487 7640-HIGHLIGHT-CERT-DISPLAYED.
 14488
 14489     MOVE AL-SANON               TO BCERT1A
 14490                                    BSUFX1A
 14491                                    BCERT2A
 14492                                    BSUFX2A
 14493                                    BCERT3A
 14494                                    BSUFX3A
 14495                                    BCERT4A
 14496                                    BSUFX4A
 14497                                    BCERT5A
 14498                                    BSUFX5A.
 14499
 14500     IF BCERT1O = CERTI AND
 14501        BSUFX1O = SUFXI
 14502            MOVE AL-SABON        TO BCERT1A
 14503                                    BSUFX1A.
 14504
 14505     IF BCERT2O = CERTI AND
 14506        BSUFX2O = SUFXI
 14507            MOVE AL-SABON        TO BCERT2A
 14508                                    BSUFX2A.
 14509
 14510     IF BCERT3O = CERTI AND
 14511        BSUFX3O = SUFXI
 14512            MOVE AL-SABON        TO BCERT3A
 14513                                    BSUFX3A.
 14514
 14515     IF BCERT4O = CERTI AND
 14516        BSUFX4O = SUFXI
 14517            MOVE AL-SABON        TO BCERT4A
 14518                                    BSUFX4A.
 14519
 14520     IF BCERT5O = CERTI AND
 14521        BSUFX5O = SUFXI
 14522            MOVE AL-SABON        TO BCERT5A
 14523                                    BSUFX5A.
 14524
 14525 7699-EXIT.
 14526     EXIT.
 14527
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 276
* EL131.cbl
 14529 7700-CHECK-SEQUENCE.
 14530
 14531
 14532* EXEC CICS HANDLE CONDITION
 14533*        ENDFILE  (7799-EXIT)
 14534*        NOTFND   (7799-EXIT)
 14535*    END-EXEC.
 14536*    MOVE '"$''I                  ! D #00012244' TO DFHEIV0
 14537     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 14538     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14539     MOVE X'4420233030303132323434' TO DFHEIV0(25:11)
 14540     CALL 'kxdfhei1' USING DFHEIV0
 14541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14542
 14543
 14544
 14545* EXEC CICS READ
 14546*        DATASET(CLMS-FILE-ID)
 14547*        SET    (ADDRESS OF CLAIM-MASTER)
 14548*        RIDFLD (MSTR-KEY)
 14549*        GENERIC
 14550*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14551*    END-EXEC.
 14552*    MOVE '&"S  KG    E          (   #00012249' TO DFHEIV0
 14553     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14555     MOVE X'2020233030303132323439' TO DFHEIV0(25:11)
 14556     CALL 'kxdfhei1' USING DFHEIV0,
 14557           CLMS-FILE-ID,
 14558           DFHEIV20,
 14559           DFHEIV99,
 14560           MSTR-KEY,
 14561           ELMSTR-GENERIC-LENGTH,
 14562           DFHEIV99,
 14563           DFHEIV99
 14564     SET ADDRESS OF CLAIM-MASTER TO
 14565         DFHEIV20
 14566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14567
 14568
 14569     COMPUTE WS-ASSOC-CERT-TOTAL =
 14570             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 14571
 14572     GO TO 7799-EXIT.
 14573
 14574 7710-RESEQUENCE-CLAIMS.
 14575
 14576
 14577* EXEC CICS HANDLE CONDITION
 14578*        ENDFILE  (7799-EXIT)
 14579*    END-EXEC.
 14580*    MOVE '"$''                   ! E #00012264' TO DFHEIV0
 14581     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14582     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14583     MOVE X'4520233030303132323634' TO DFHEIV0(25:11)
 14584     CALL 'kxdfhei1' USING DFHEIV0
 14585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14586
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 277
* EL131.cbl
 14587
 14588
 14589* EXEC CICS STARTBR
 14590*        DATASET(CLMS-FILE-ID)
 14591*        RIDFLD (MSTR-KEY)
 14592*    END-EXEC.
 14593     MOVE 0
 14594       TO DFHEIV11
 14595*    MOVE '&,         G          &   #00012268' TO DFHEIV0
 14596     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14597     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14598     MOVE X'2020233030303132323638' TO DFHEIV0(25:11)
 14599     CALL 'kxdfhei1' USING DFHEIV0,
 14600           CLMS-FILE-ID,
 14601           MSTR-KEY,
 14602           DFHEIV99,
 14603           DFHEIV11,
 14604           DFHEIV99
 14605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14606
 14607
 14608     COMPUTE WS-ASSOC-CERT-SEQU =
 14609             WS-ASSOC-CERT-SEQU + 1.
 14610
 14611     COMPUTE WS-READNEXT-SWITCH =
 14612             WS-READNEXT-SWITCH + 1.
 14613
 14614 7720-READ-CLAIM-LOOP.
 14615
 14616
 14617* EXEC CICS READNEXT
 14618*        DATASET(CLMS-FILE-ID)
 14619*        SET    (ADDRESS OF CLAIM-MASTER)
 14620*        RIDFLD (MSTR-KEY)
 14621*    END-EXEC.
 14622     MOVE 0
 14623       TO DFHEIV11
 14624*    MOVE '&.S                   )   #00012281' TO DFHEIV0
 14625     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14626     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14627     MOVE X'2020233030303132323831' TO DFHEIV0(25:11)
 14628     CALL 'kxdfhei1' USING DFHEIV0,
 14629           CLMS-FILE-ID,
 14630           DFHEIV20,
 14631           DFHEIV99,
 14632           MSTR-KEY,
 14633           DFHEIV99,
 14634           DFHEIV11,
 14635           DFHEIV99,
 14636           DFHEIV99
 14637     SET ADDRESS OF CLAIM-MASTER TO
 14638         DFHEIV20
 14639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14640
 14641
 14642     IF WS-READNEXT-SWITCH = 1
 14643         ADD 1                   TO WS-READNEXT-SWITCH
 14644         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 278
* EL131.cbl
 14645
 14646 7730-END-BROWSE.
 14647
 14648
 14649* EXEC CICS ENDBR
 14650*        DATASET(CLMS-FILE-ID)
 14651*    END-EXEC.
 14652     MOVE 0
 14653       TO DFHEIV11
 14654*    MOVE '&2                    $   #00012293' TO DFHEIV0
 14655     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14656     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14657     MOVE X'2020233030303132323933' TO DFHEIV0(25:11)
 14658     CALL 'kxdfhei1' USING DFHEIV0,
 14659           CLMS-FILE-ID,
 14660           DFHEIV11,
 14661           DFHEIV99
 14662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14663
 14664
 14665 7740-READ-CLAIM-UPDATE.
 14666
 14667     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 14668        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 14669        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 14670        GO TO 7799-EXIT
 14671     ELSE
 14672        MOVE ZERO                TO WS-READNEXT-SWITCH.
 14673
 14674
 14675* EXEC CICS READ
 14676*        DATASET(CLMS-FILE-ID)
 14677*        SET    (ADDRESS OF CLAIM-MASTER)
 14678*        RIDFLD (MSTR-KEY)
 14679*        UPDATE
 14680*    END-EXEC.
 14681*    MOVE '&"S        EU         (   #00012306' TO DFHEIV0
 14682     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14683     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14684     MOVE X'2020233030303132333036' TO DFHEIV0(25:11)
 14685     CALL 'kxdfhei1' USING DFHEIV0,
 14686           CLMS-FILE-ID,
 14687           DFHEIV20,
 14688           DFHEIV99,
 14689           MSTR-KEY,
 14690           DFHEIV99,
 14691           DFHEIV99,
 14692           DFHEIV99
 14693     SET ADDRESS OF CLAIM-MASTER TO
 14694         DFHEIV20
 14695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14696
 14697
 14698     if (cl-priority-cd = '8')
 14699        and (pi-processor-id not = 'PEMA' and 'JMS '
 14700             AND 'AMWA')
 14701        MOVE ER-8003             TO EMI-ERROR
 14702        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 279
* EL131.cbl
 14703                                 THRU 9900-EXIT
 14704        MOVE -1                  TO MAINTL
 14705        GO TO 8110-SEND-DATA
 14706     end-if
 14707
 14708     IF PI-COMPANY-ID = 'CID' or 'AHL'
 14709         MOVE 'Y'                TO CL-YESNOSW
 14710     END-IF.
 14711
 14712     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 14713     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 14714
 14715
 14716* EXEC CICS REWRITE
 14717*         DATASET(CLMS-FILE-ID)
 14718*         FROM   (CLAIM-MASTER)
 14719*    END-EXEC.
 14720     MOVE LENGTH OF
 14721      CLAIM-MASTER
 14722       TO DFHEIV11
 14723*    MOVE '&& L                  %   #00012330' TO DFHEIV0
 14724     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14725     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14726     MOVE X'2020233030303132333330' TO DFHEIV0(25:11)
 14727     CALL 'kxdfhei1' USING DFHEIV0,
 14728           CLMS-FILE-ID,
 14729           CLAIM-MASTER,
 14730           DFHEIV11,
 14731           DFHEIV99
 14732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14733
 14734
 14735     GO TO 7710-RESEQUENCE-CLAIMS.
 14736
 14737 7799-EXIT.
 14738     EXIT.
 14739
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 280
* EL131.cbl
 14741 7800-CHECK-AUTO-ACTIVITY.
 14742
 14743
 14744* EXEC CICS HANDLE CONDITION
 14745*        NOTFND   (7800-NOT-FOUND)
 14746*    END-EXEC.
 14747*    MOVE '"$I                   ! F #00012343' TO DFHEIV0
 14748     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14749     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14750     MOVE X'4620233030303132333433' TO DFHEIV0(25:11)
 14751     CALL 'kxdfhei1' USING DFHEIV0
 14752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14753
 14754
 14755     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 14756     MOVE 'T'                        TO  CNTL-REC-TYPE.
 14757     MOVE SPACES                     TO  CNTL-PROC-ID.
 14758     MOVE +0                         TO  CNTL-SEQ-NO.
 14759
 14760
 14761* EXEC CICS READ
 14762*        DATASET   (CNTL-FILE-ID)
 14763*        RIDFLD    (CNTL-KEY)
 14764*        SET       (ADDRESS OF CONTROL-FILE)
 14765*    END-EXEC.
 14766*    MOVE '&"S        E          (   #00012352' TO DFHEIV0
 14767     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14768     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14769     MOVE X'2020233030303132333532' TO DFHEIV0(25:11)
 14770     CALL 'kxdfhei1' USING DFHEIV0,
 14771           CNTL-FILE-ID,
 14772           DFHEIV20,
 14773           DFHEIV99,
 14774           CNTL-KEY,
 14775           DFHEIV99,
 14776           DFHEIV99,
 14777           DFHEIV99
 14778     SET ADDRESS OF CONTROL-FILE TO
 14779         DFHEIV20
 14780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14781
 14782
 14783     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 14784         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 14785
 14786     IF CL-ACTIVITY-CODE NOT = ZEROS
 14787         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 14788         IF MISC-SUB IS GREATER THAN +9
 14789             SUBTRACT +9 FROM MISC-SUB
 14790             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 14791         ELSE
 14792             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 14793     ELSE
 14794         MOVE 'Y'                              TO  WS-RESET-SW.
 14795
 14796     IF STATUSI = 'C' OR 'CLOSED'
 14797         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 14798             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 281
* EL131.cbl
 14799                                         PI-LETTER-SW
 14800             GO TO 7800-EXIT.
 14801
 14802     IF STATUSI = 'C' OR 'CLOSED'
 14803         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 14804             MOVE 'N'                TO  PI-LETTER-SW
 14805         ELSE
 14806             MOVE 'Y'                TO  PI-LETTER-SW.
 14807
 14808     IF STATUSI = 'O' OR 'OPEN'
 14809         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 14810             MOVE 'N'                TO  PI-REC-FOUND-SW
 14811                                         PI-LETTER-SW
 14812             GO TO 7800-EXIT.
 14813
 14814     IF STATUSI = 'O' OR 'OPEN'
 14815         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 14816             MOVE 'N'                TO  PI-LETTER-SW
 14817         ELSE
 14818             MOVE 'Y'                TO  PI-LETTER-SW.
 14819
 14820     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 14821     GO TO 7800-EXIT.
 14822
 14823 7800-NOT-FOUND.
 14824
 14825     MOVE 'N'                        TO  PI-REC-FOUND-SW
 14826                                         PI-LETTER-SW.
 14827
 14828 7800-EXIT.
 14829     EXIT.
 14830
 14831 7850-AUTO-LETTER-WRITER.
 14832
 14833     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 14834     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 14835
 14836     IF STATUSI = 'C' OR 'CLOSED'
 14837         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 14838     ELSE
 14839         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 14840
 14841     IF STATUSI = 'C' OR 'CLOSED'
 14842         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 14843             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 14844             MOVE '6'                TO  DC-OPTION-CODE
 14845             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 14846             MOVE +0                 TO  DC-ELAPSED-MONTHS
 14847             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14848             IF NO-CONVERSION-ERROR
 14849                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 14850             ELSE
 14851                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 14852
 14853     IF STATUSI = 'C' OR 'CLOSED'
 14854         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 14855             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 14856             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 282
* EL131.cbl
 14857             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 14858             MOVE +0                 TO  DC-ELAPSED-MONTHS
 14859             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14860             IF NO-CONVERSION-ERROR
 14861                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 14862             ELSE
 14863                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 14864
 14865     IF STATUSI = 'O' OR 'OPEN'
 14866         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 14867             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 14868             MOVE '6'                TO  DC-OPTION-CODE
 14869             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 14870             MOVE +0                 TO  DC-ELAPSED-MONTHS
 14871             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14872             IF NO-CONVERSION-ERROR
 14873                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 14874             ELSE
 14875                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 14876
 14877     IF STATUSI = 'O' OR 'OPEN'
 14878         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 14879             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 14880             MOVE '6'                TO  DC-OPTION-CODE
 14881             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 14882             MOVE +0                 TO  DC-ELAPSED-MONTHS
 14883             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14884             IF NO-CONVERSION-ERROR
 14885                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 14886             ELSE
 14887                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 14888
 14889
 14890* EXEC CICS LINK
 14891*        PROGRAM    (LINK-1523)
 14892*        COMMAREA   (W-1523-LINKDATA)
 14893*        LENGTH     (W-1523-COMM-LENGTH)
 14894*    END-EXEC.
 14895*    MOVE '."C                   (   #00012464' TO DFHEIV0
 14896     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14897     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14898     MOVE X'2020233030303132343634' TO DFHEIV0(25:11)
 14899     CALL 'kxdfhei1' USING DFHEIV0,
 14900           LINK-1523,
 14901           W-1523-LINKDATA,
 14902           W-1523-COMM-LENGTH,
 14903           DFHEIV99,
 14904           DFHEIV99,
 14905           DFHEIV99,
 14906           DFHEIV99
 14907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14908
 14909
 14910     IF W-1523-ERROR-CODE = ZEROS
 14911         GO TO 7850-EXIT.
 14912
 14913     IF W-1523-FATAL-ERROR
 14914         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 283
* EL131.cbl
 14915         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14916
 14917     IF W-1523-ERROR-CODE = 0191
 14918         MOVE ER-0803                TO  EMI-ERROR
 14919         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14920
 14921 7850-EXIT.
 14922     EXIT.
 14923
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 284
* EL131.cbl
 14925 8000-CREATE-DMO-REC.
 14926     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 14927     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 14928     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 14929
 14930
 14931* EXEC CICS HANDLE CONDITION
 14932*         NOTFND   (8000-NOTE-NOT-FOUND)
 14933*    END-EXEC.
 14934*    MOVE '"$I                   ! G #00012490' TO DFHEIV0
 14935     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14936     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14937     MOVE X'4720233030303132343930' TO DFHEIV0(25:11)
 14938     CALL 'kxdfhei1' USING DFHEIV0
 14939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14940
 14941
 14942
 14943* EXEC CICS READ
 14944*         DATASET(NOTE-FILE-ID)
 14945*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14946*         RIDFLD (NOTE-KEY)
 14947*    END-EXEC.
 14948*    MOVE '&"S        E          (   #00012494' TO DFHEIV0
 14949     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14950     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14951     MOVE X'2020233030303132343934' TO DFHEIV0(25:11)
 14952     CALL 'kxdfhei1' USING DFHEIV0,
 14953           NOTE-FILE-ID,
 14954           DFHEIV20,
 14955           DFHEIV99,
 14956           NOTE-KEY,
 14957           DFHEIV99,
 14958           DFHEIV99,
 14959           DFHEIV99
 14960     SET ADDRESS OF CERTIFICATE-NOTE TO
 14961         DFHEIV20
 14962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14963
 14964
 14965     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14966     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14967     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14968
 14969     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 14970         MOVE 'CC'               TO DCT-PRODUCT-CODE
 14971     ELSE
 14972         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14973
 14974     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14975     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14976
 14977
 14978* EXEC CICS LINK
 14979*        PROGRAM    ('DLO006')
 14980*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14981*        LENGTH     (WS-DCT-LENGTH)
 14982*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 285
* EL131.cbl
 14983     MOVE 'DLO006' TO DFHEIV1
 14984*    MOVE '."C                   (   #00012512' TO DFHEIV0
 14985     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14986     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14987     MOVE X'2020233030303132353132' TO DFHEIV0(25:11)
 14988     CALL 'kxdfhei1' USING DFHEIV0,
 14989           DFHEIV1,
 14990           DCT-COMMUNICATION-AREA,
 14991           WS-DCT-LENGTH,
 14992           DFHEIV99,
 14993           DFHEIV99,
 14994           DFHEIV99,
 14995           DFHEIV99
 14996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14997
 14998
 14999     IF  DCT-RETURN-CODE = 'OK'
 15000         GO TO 8000-CONT.
 15001
 15002     IF DCT-RETURN-CODE = '01' OR '02'
 15003         GO TO 8000-EXIT.
 15004
 15005     IF DCT-RETURN-CODE = '03'
 15006         MOVE ER-0951            TO EMI-ERROR
 15007         MOVE -1                 TO MAINTL
 15008         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15009         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15010         GO TO 8110-SEND-DATA.
 15011
 15012     IF DCT-RETURN-CODE = '04'
 15013         MOVE ER-0946            TO EMI-ERROR
 15014         MOVE -1                 TO MAINTL
 15015         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15016         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15017         GO TO 8110-SEND-DATA.
 15018
 15019     IF DCT-RETURN-CODE = '05'
 15020         MOVE ER-0947            TO EMI-ERROR
 15021         MOVE -1                 TO MAINTL
 15022         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15023         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15024         GO TO 8110-SEND-DATA.
 15025
 15026     IF DCT-RETURN-CODE = '06'
 15027         MOVE ER-0921            TO EMI-ERROR
 15028         MOVE -1                 TO MAINTL
 15029         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15030         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15031         GO TO 8110-SEND-DATA.
 15032
 15033     IF DCT-RETURN-CODE = '07'
 15034         MOVE ER-0919            TO EMI-ERROR
 15035         MOVE -1                 TO MAINTL
 15036         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15037         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15038         GO TO 8110-SEND-DATA.
 15039
 15040     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 286
* EL131.cbl
 15041         MOVE ER-0948            TO EMI-ERROR
 15042         MOVE -1                 TO MAINTL
 15043         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15044         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15045         GO TO 8110-SEND-DATA.
 15046
 15047     IF DCT-RETURN-CODE = 'N1'
 15048         MOVE ER-0950            TO EMI-ERROR
 15049         MOVE -1                 TO MAINTL
 15050         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15051         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15052         GO TO 8110-SEND-DATA.
 15053
 15054     IF DCT-RETURN-CODE = 'E1'
 15055         MOVE ER-0974            TO EMI-ERROR
 15056         MOVE -1                 TO MAINTL
 15057         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15058         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15059         GO TO 8110-SEND-DATA.
 15060
 15061     IF DCT-RETURN-CODE = 'E2'
 15062         MOVE ER-0975            TO EMI-ERROR
 15063         MOVE -1                 TO MAINTL
 15064         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15065         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15066         GO TO 8110-SEND-DATA.
 15067
 15068     IF DCT-RETURN-CODE NOT = 'OK'
 15069         MOVE ER-0949            TO EMI-ERROR
 15070         MOVE -1                 TO MAINTL
 15071         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15072         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15073         GO TO 8110-SEND-DATA.
 15074
 15075 8000-CONT.
 15076
 15077     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 15078     MOVE 'CS'                   TO DM-RECORD-TYPE.
 15079     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 15080     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 15081     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 15082     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 15083     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 15084     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 15085
 15086     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 15087     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 15088     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 15089     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 15090     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 15091
 15092     IF STATUSI = 'OPEN' OR 'O'
 15093         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 15094      ELSE
 15095         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 15096
 15097     IF STATUSI = 'OPEN' OR 'O'
 15098        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 287
* EL131.cbl
 15099         MOVE '1'                TO DM-CLAIM-STATUS
 15100      ELSE
 15101         MOVE '2'                TO DM-CLAIM-STATUS.
 15102
 15103     IF STATUSI = 'CLOSED' OR 'C'
 15104        IF NOT FINAL-PAID
 15105         MOVE '3'                TO DM-CLAIM-STATUS
 15106      ELSE
 15107         MOVE '4'                TO DM-CLAIM-STATUS.
 15108
 15109     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 15110
 15111
 15112* EXEC CICS LINK
 15113*        PROGRAM    ('DLO025')
 15114*        COMMAREA   (DMO-COMMUNICATION-AREA)
 15115*        LENGTH     (WS-DMO-LENGTH)
 15116*    END-EXEC.
 15117     MOVE 'DLO025' TO DFHEIV1
 15118*    MOVE '."C                   (   #00012630' TO DFHEIV0
 15119     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15120     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15121     MOVE X'2020233030303132363330' TO DFHEIV0(25:11)
 15122     CALL 'kxdfhei1' USING DFHEIV0,
 15123           DFHEIV1,
 15124           DMO-COMMUNICATION-AREA,
 15125           WS-DMO-LENGTH,
 15126           DFHEIV99,
 15127           DFHEIV99,
 15128           DFHEIV99,
 15129           DFHEIV99
 15130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15131
 15132
 15133     IF  DM-RETURN-CODE = 'OK'
 15134         GO TO 8000-EXIT.
 15135
 15136     IF DM-RETURN-CODE = '01'
 15137         MOVE ER-8051            TO EMI-ERROR
 15138         MOVE -1                 TO MAINTL
 15139         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15140         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15141         GO TO 8110-SEND-DATA.
 15142
 15143     IF DM-RETURN-CODE = '02'
 15144         MOVE ER-8052            TO EMI-ERROR
 15145         MOVE -1                 TO MAINTL
 15146         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15147         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15148         GO TO 8110-SEND-DATA.
 15149
 15150     IF DM-RETURN-CODE = '03'
 15151         MOVE ER-8053            TO EMI-ERROR
 15152         MOVE -1                 TO MAINTL
 15153         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15154         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15155         GO TO 8110-SEND-DATA.
 15156
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 288
* EL131.cbl
 15157     IF DM-RETURN-CODE = '04'
 15158         MOVE ER-8054            TO EMI-ERROR
 15159         MOVE -1                 TO MAINTL
 15160         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15161         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15162         GO TO 8110-SEND-DATA.
 15163
 15164     IF DM-RETURN-CODE = '05'
 15165         MOVE ER-8055            TO EMI-ERROR
 15166         MOVE -1                 TO MAINTL
 15167         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15168         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15169         GO TO 8110-SEND-DATA.
 15170
 15171     IF DM-RETURN-CODE = '06'
 15172         MOVE ER-8056            TO EMI-ERROR
 15173         MOVE -1                 TO MAINTL
 15174         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15175         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15176         GO TO 8110-SEND-DATA.
 15177
 15178     IF DM-RETURN-CODE = '07'
 15179         MOVE ER-8057            TO EMI-ERROR
 15180         MOVE -1                 TO MAINTL
 15181         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15182         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15183         GO TO 8110-SEND-DATA.
 15184
 15185     IF DM-RETURN-CODE = '08'
 15186         MOVE ER-8058            TO EMI-ERROR
 15187         MOVE -1                 TO MAINTL
 15188         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15189         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15190         GO TO 8110-SEND-DATA.
 15191
 15192     IF DM-RETURN-CODE = '09'
 15193         MOVE ER-8059            TO EMI-ERROR
 15194         MOVE -1                 TO MAINTL
 15195         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15196         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15197         GO TO 8110-SEND-DATA.
 15198
 15199     IF DM-RETURN-CODE = '10'
 15200         MOVE ER-8060            TO EMI-ERROR
 15201         MOVE -1                 TO MAINTL
 15202         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15203         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15204         GO TO 8110-SEND-DATA.
 15205
 15206     IF DM-RETURN-CODE = '11'
 15207         MOVE ER-8061            TO EMI-ERROR
 15208         MOVE -1                 TO MAINTL
 15209         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15210         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15211         GO TO 8110-SEND-DATA.
 15212
 15213     IF DM-RETURN-CODE = '12'
 15214         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 289
* EL131.cbl
 15215         MOVE -1                 TO MAINTL
 15216         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15217         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15218         GO TO 8110-SEND-DATA.
 15219
 15220     IF DM-RETURN-CODE = '13'
 15221         MOVE ER-8063            TO EMI-ERROR
 15222         MOVE -1                 TO MAINTL
 15223         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15224         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15225         GO TO 8110-SEND-DATA.
 15226
 15227     IF DM-RETURN-CODE = '14'
 15228         MOVE ER-8064            TO EMI-ERROR
 15229         MOVE -1                 TO MAINTL
 15230         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15231         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15232         GO TO 8110-SEND-DATA.
 15233
 15234     IF DM-RETURN-CODE = '15'
 15235         MOVE ER-8065            TO EMI-ERROR
 15236         MOVE -1                 TO MAINTL
 15237         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15238         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15239         GO TO 8110-SEND-DATA.
 15240
 15241     IF DM-RETURN-CODE = '16'
 15242         MOVE ER-8154            TO EMI-ERROR
 15243         MOVE -1                 TO MAINTL
 15244         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15245         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15246         GO TO 8110-SEND-DATA.
 15247
 15248     IF DM-RETURN-CODE = '17'
 15249         MOVE ER-8155            TO EMI-ERROR
 15250         MOVE -1                 TO MAINTL
 15251         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15252         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15253         GO TO 8110-SEND-DATA.
 15254
 15255     IF DM-RETURN-CODE = 'N1'
 15256         MOVE ER-8152            TO EMI-ERROR
 15257         MOVE -1                 TO MAINTL
 15258         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15259         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15260         GO TO 8110-SEND-DATA.
 15261
 15262     IF DM-RETURN-CODE = 'E1'
 15263         MOVE ER-8153            TO EMI-ERROR
 15264         MOVE -1                 TO MAINTL
 15265         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15266         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15267         GO TO 8110-SEND-DATA.
 15268
 15269     MOVE ER-8066                TO EMI-ERROR.
 15270     MOVE -1                     TO MAINTL.
 15271     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15272     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 290
* EL131.cbl
 15273     GO TO 8110-SEND-DATA.
 15274
 15275 8000-NOTE-NOT-FOUND.
 15276
 15277* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15278*    MOVE '6"R                   !   #00012779' TO DFHEIV0
 15279     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15280     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15281     MOVE X'2020233030303132373739' TO DFHEIV0(25:11)
 15282     CALL 'kxdfhei1' USING DFHEIV0
 15283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15284
 15285     MOVE ER-0954                TO EMI-ERROR.
 15286     MOVE -1                     TO MAINTL.
 15287     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15288     GO TO 8110-SEND-DATA.
 15289
 15290 8000-EXIT.
 15291     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 291
* EL131.cbl
 15293 8050-FORMAT-LAST-NAME-1ST.
 15294*****************************************************************
 15295*             M O V E   N A M E   R O U T I N E                 *
 15296*                                                               *
 15297*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15298*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15299*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 15300*                                                               *
 15301*                  FIELD               VALUE                    *
 15302*                  -----               -----                    *
 15303*           W-NAME-LAST    (CL15)      SMITH                    *
 15304*           W-NAME-FIRST   (CL15)      JOHN                     *
 15305*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15306*                                                               *
 15307*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 15308*                SMITH, JOHN ALLEN                              *
 15309*                     OR                                        *
 15310*                SMITH, JOHN A.                                 *
 15311*                                                               *
 15312*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 15313*     COPYBOOK, ELCNWA.                                         *
 15314*****************************************************************.
 15315
 15316     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15317     MOVE ZERO                   TO WS-NAME-SW.
 15318     SET NWA-INDEX               TO +1.
 15319
 15320     IF W-NAME-LAST   = SPACES  AND
 15321        W-NAME-MIDDLE = SPACES
 15322          MOVE +1                TO WS-NAME-SW.
 15323
 15324     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15325     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15326
 15327     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15328     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15329
 15330     SET NWA-INDEX UP BY +1.
 15331
 15332     IF W-NAME-MIDDLE NOT = SPACES
 15333         IF W-NAME-MIDDLE-2 = SPACES
 15334             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15335             SET NWA-INDEX UP BY +1
 15336             MOVE '.'            TO WS-NW (NWA-INDEX)
 15337             SET NWA-INDEX UP BY +2
 15338         ELSE
 15339             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15340             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15341
 15342 8050-EXIT.
 15343     EXIT.
 15344
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 292
* EL131.cbl
 15346 8060-MOVE-NAME.
 15347     IF WS-NAME-SW GREATER THAN +1
 15348         GO TO 8060-EXIT.
 15349
 15350     IF WS-NAME-WORK2 = SPACES
 15351         GO TO 8060-EXIT.
 15352
 15353     SET NWA-INDEX2            TO +1.
 15354     SET NWA-INDEX3            TO +2.
 15355
 15356 8060-MOVE-NAME-CYCLE.
 15357     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15358
 15359     IF NWA-INDEX LESS THAN +30
 15360         SET NWA-INDEX UP BY +1
 15361     ELSE
 15362         ADD +2 TO  WS-NAME-SW
 15363         GO TO 8060-EXIT.
 15364
 15365     IF NWA-INDEX2 LESS THAN +20
 15366         SET NWA-INDEX3 UP BY +1
 15367         SET NWA-INDEX2 UP BY +1.
 15368
 15369     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 15370        WS-NW2 (NWA-INDEX3) = SPACES
 15371         IF WS-NAME-SW = ZERO
 15372             MOVE ','            TO WS-NW (NWA-INDEX)
 15373             SET NWA-INDEX UP BY +2
 15374             MOVE +1             TO WS-NAME-SW
 15375             GO TO 8060-EXIT
 15376         ELSE
 15377             GO TO 8060-EXIT.
 15378
 15379     GO TO 8060-MOVE-NAME-CYCLE.
 15380
 15381 8060-EXIT.
 15382     EXIT.
 15383
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 293
* EL131.cbl
 15385
 15386 8070-UNLOCK-CLAIM-MSTR.
 15387
 15388* EXEC CICS UNLOCK
 15389*        DATASET   (CLMS-FILE-ID)
 15390*    END-EXEC.
 15391*    MOVE '&*                    #   #00012882' TO DFHEIV0
 15392     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 15393     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15394     MOVE X'2020233030303132383832' TO DFHEIV0(25:11)
 15395     CALL 'kxdfhei1' USING DFHEIV0,
 15396           CLMS-FILE-ID,
 15397           DFHEIV99
 15398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15399
 15400
 15401 8070-EXIT.
 15402      EXIT.
 15403
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 294
* EL131.cbl
 15405 8100-SEND-MAP.
 15406     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 15407
 15408     IF NOT PI-NO-CARRIER-SECURITY
 15409        MOVE AL-SANOF            TO CERTCARA.
 15410     IF NOT PI-NO-ACCOUNT-SECURITY
 15411        MOVE AL-SANOF            TO CERTACTA.
 15412
 15413     IF PI-PROCESSOR-ID = 'LGXX'
 15414        MOVE AL-UANON            TO CCNOA.
 15415
 15416     IF PI-COMPANY-ID = 'DMD'
 15417        NEXT SENTENCE
 15418     ELSE
 15419        MOVE AL-SADOF            TO PFKEY6A.
 15420
 15421     IF PI-USES-PAID-TO
 15422        MOVE 'PAID TO  :' TO PTHRHDGO.
 15423
 15424
 15425* EXEC CICS SEND
 15426*         MAP     ('EL131A')
 15427*         MAPSET  ('EL131S')
 15428*         ERASE
 15429*         FREEKB
 15430*         CURSOR
 15431*    END-EXEC.
 15432     MOVE 'EL131A' TO DFHEIV1
 15433     MOVE -1
 15434       TO DFHEIV11
 15435     MOVE 'EL131S' TO DFHEIV2
 15436*    MOVE '8$     CT  E F  H     ,   #00012909' TO DFHEIV0
 15437     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15438     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 15439     MOVE X'2020233030303132393039' TO DFHEIV0(25:11)
 15440     CALL 'kxdfhei1' USING DFHEIV0,
 15441           DFHEIV1,
 15442           EL131AO,
 15443           DFHEIV99,
 15444           DFHEIV2,
 15445           DFHEIV99,
 15446           DFHEIV99,
 15447           DFHEIV99,
 15448           DFHEIV11,
 15449           DFHEIV99,
 15450           DFHEIV99,
 15451           DFHEIV99
 15452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15453
 15454
 15455     GO TO 9000-RETURN-TRANS.
 15456
 15457 8110-SEND-DATA.
 15458     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 15459
 15460     IF PI-USES-PAID-TO
 15461        MOVE 'PAID TO  :' TO PTHRHDGO.
 15462
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 295
* EL131.cbl
 15463     IF PI-PROCESSOR-ID = 'LGXX'
 15464        MOVE AL-UANON            TO CCNOA.
 15465
 15466     IF PI-COMPANY-ID = 'DMD'
 15467        NEXT SENTENCE
 15468     ELSE
 15469        MOVE AL-SADOF            TO PFKEY6A.
 15470
 15471
 15472* EXEC CICS SEND
 15473*         MAP      ('EL131A')
 15474*         MAPSET   ('EL131S')
 15475*         DATAONLY
 15476*         FREEKB
 15477*         CURSOR
 15478*    END-EXEC.
 15479     MOVE 'EL131A' TO DFHEIV1
 15480     MOVE -1
 15481       TO DFHEIV11
 15482     MOVE 'EL131S' TO DFHEIV2
 15483*    MOVE '8$D    CT    F  H     ,   #00012933' TO DFHEIV0
 15484     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15485     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 15486     MOVE X'2020233030303132393333' TO DFHEIV0(25:11)
 15487     CALL 'kxdfhei1' USING DFHEIV0,
 15488           DFHEIV1,
 15489           EL131AO,
 15490           DFHEIV99,
 15491           DFHEIV2,
 15492           DFHEIV99,
 15493           DFHEIV99,
 15494           DFHEIV99,
 15495           DFHEIV11,
 15496           DFHEIV99,
 15497           DFHEIV99,
 15498           DFHEIV99
 15499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15500
 15501
 15502     GO TO 9000-RETURN-TRANS.
 15503
 15504 8120-FORMAT-TIME-DATE.
 15505     perform 8140-check-for-prev-errors
 15506                                 thru 8140-exit
 15507     IF SKIP-ATTRIBUTE = 'Y'
 15508        MOVE SPACES              TO SKIP-ATTRIBUTE
 15509        MOVE ER-0598             TO EMI-ERROR
 15510        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15511        GO TO 8125-SKIP-ATTRIBUTE.
 15512
 15513*     IF PI-COMPANY-ID = 'DMD'
 15514      IF PI-PROCESSOR-ID <> 'EMER'
 15515         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 15516                                    CERTCARA  CERTGRPA CERTA SUFXA
 15517
 15518     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 15519                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 15520                                    JNTINITA  JNTAGEA   APRA
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 296
* EL131.cbl
 15521                                    LCVCDA    LCVOTRMA  LCVRTRMA
 15522                                    LCVBENEA  LCVFORMA  LCVCNDTA
 15523                                    LCVEXITA  LCVSTATA  LCVKINDA
 15524                                    ACVCDA    ACVOTRMA  ACVRTRMA
 15525                                    ACVBENEA  ACVFORMA  ACVCNDTA
 15526                                    ACVEXITA  ACVSTATA  ACVKINDA
 15527                                    PMTFREQA  INDGRPA   PREMTYPA
 15528                                    REINCDA   LCVRATEA  ACVRATEA
 15529                                    ADDONDTA.
 15530
 15531*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 15532*       IF PI-COMPANY-ID = 'DMD'
 15533*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 15534*                                   SUFXA
 15535*                                   PDAMTA    NODAYSA   NOPMTSA
 15536*                                   INCA      OCCA
 15537*          IF NOT SYSTEM-MODIFY-CAP
 15538*              MOVE AL-SANOF         TO PDTHRUA.
 15539
 15540     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 15541         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15542
 15543 8125-SKIP-ATTRIBUTE.
 15544
 15545     MOVE SAVE-DATE              TO DATEO.
 15546
 15547* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 15548*    END-EXEC
 15549*    MOVE '0"A                   "   #00012985' TO DFHEIV0
 15550     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 15551     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 15552     MOVE X'2020233030303132393835' TO DFHEIV0(25:11)
 15553     CALL 'kxdfhei1' USING DFHEIV0,
 15554           LCP-CICS-TIME
 15555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15556
 15557* EXEC CICS FORMATTIME
 15558*              ABSTIME(LCP-CICS-TIME)
 15559*              TIME(LCP-TIME-OF-DAY-XX)
 15560*    END-EXEC
 15561*    MOVE 'j$(     (             #   #00012987' TO DFHEIV0
 15562     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 15563     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15564     MOVE X'2020233030303132393837' TO DFHEIV0(25:11)
 15565     CALL 'kxdfhei1' USING DFHEIV0,
 15566           LCP-CICS-TIME,
 15567           LCP-TIME-OF-DAY-XX
 15568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15569     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 15570     MOVE UN-HOURS               TO FOR-HOURS.
 15571     MOVE UN-MINUTES             TO FOR-MINUTES.
 15572     MOVE TIME-OUT               TO TIMEO.
 15573     MOVE PI-COMPANY-ID          TO COMPO.
 15574     MOVE PI-PROCESSOR-ID        TO USERIDO.
 15575     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 15576     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 15577     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 15578     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 297
* EL131.cbl
 15579
 15580 8130-EXIT.
 15581     EXIT.
 15582
 15583 8140-check-for-prev-errors.
 15584
 15585     MOVE PI-COMPANY-CD          TO trlr-company-cd
 15586     MOVE PI-CARRIER             TO trlr-carrier
 15587     MOVE PI-CLAIM-NO            TO trlr-claim-no
 15588     MOVE PI-CERT-NO             TO trlr-cert-no
 15589     MOVE +95                    TO TRLR-SEQ-NO
 15590
 15591
 15592* EXEC CICS READ
 15593*       DATASET  ('ELTRLR')
 15594*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15595*       RIDFLD   (TRLR-KEY)
 15596*       RESP     (WS-RESPONSE)
 15597*    END-EXEC
 15598     MOVE 'ELTRLR' TO DFHEIV1
 15599*    MOVE '&"S        E          (  N#00013013' TO DFHEIV0
 15600     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15601     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15602     MOVE X'204E233030303133303133' TO DFHEIV0(25:11)
 15603     CALL 'kxdfhei1' USING DFHEIV0,
 15604           DFHEIV1,
 15605           DFHEIV20,
 15606           DFHEIV99,
 15607           TRLR-KEY,
 15608           DFHEIV99,
 15609           DFHEIV99,
 15610           DFHEIV99
 15611     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15612         DFHEIV20
 15613     MOVE EIBRESP  TO WS-RESPONSE
 15614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15615
 15616     if ws-resp-normal
 15617        perform varying s1 from +1 by +1 until
 15618           at-note-error-no (s1) = spaces
 15619           if at-note-error-no (s1) = '1652'
 15620              continue
 15621           else
 15622              move at-note-error-no (s1)
 15623                                 to emi-error
 15624              move -1 to maintl
 15625              if at-note-error-no (s1) = '1653'
 15626                 evaluate true
 15627                    when pi-claim-type = 'L'
 15628                       move '  LF  '
 15629                        to emi-claim-type
 15630                    when pi-claim-type = 'I'
 15631                       move '  IU  '
 15632                        to emi-claim-type
 15633                    when other
 15634                       move '  AH  '
 15635                        to emi-claim-type
 15636                 end-evaluate
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 298
* EL131.cbl
 15637              end-if
 15638              PERFORM 9900-ERROR-FORMAT
 15639                                 THRU 9900-EXIT
 15640           end-if
 15641*          if at-note-error-no (s1) = '1653'
 15642*             perform varying emi-sub from 1 by 1 until
 15643*                emi-sub > 3
 15644*                if emi-error-number (emi-sub) = '1653'
 15645*                   evaluate true
 15646*                      when pi-claim-type = 'L'
 15647*                         move '  LF  '
 15648*                          to emi-claim-type
 15649*                      when pi-claim-type = 'I'
 15650*                         move '  IU  '
 15651*                          to emi-claim-type
 15652*                      when other
 15653*                         move '  AH  '
 15654*                          to emi-claim-type
 15655*                   end-evaluate
 15656*                end-if
 15657*             end-perform
 15658*          end-if
 15659        end-perform
 15660     else
 15661        display ' resp not normal ' ws-response ' '
 15662        trlr-key (2:19)
 15663     end-if
 15664
 15665     .
 15666 8140-exit.
 15667     exit.
 15668 8150-ENTERED-CLAIM-NOTFOUND.
 15669
 15670     MOVE ER-0204                TO EMI-ERROR.
 15671     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15672     MOVE -1                     TO MAINTL.
 15673     GO TO 8100-SEND-MAP.
 15674
 15675 8200-RETURN-PRIOR.
 15676     MOVE SPACE                  TO PI-RETURN-CD-1.
 15677     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 15678     GO TO 9200-XCTL.
 15679
 15680 8300-GET-HELP.
 15681     MOVE XCTL-EL010             TO CALL-PGM.
 15682     GO TO 9200-XCTL.
 15683
 15684 8400-RETURN-MASTER.
 15685     MOVE SPACE                  TO PI-RETURN-CD-1.
 15686     MOVE XCTL-EL126             TO CALL-PGM.
 15687     GO TO 9200-XCTL.
 15688
 15689 8500-TRLR-MNT.
 15690     IF PI-RETURN-CD-1 = 'X'
 15691         MOVE ER-0311            TO EMI-ERROR
 15692         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15693         MOVE -1                 TO MAINTL
 15694         GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 299
* EL131.cbl
 15695
 15696
 15697* EXEC CICS WRITEQ TS
 15698*         QUEUE     (PI-KEY)
 15699*         FROM      (PROGRAM-INTERFACE-BLOCK)
 15700*         LENGTH    (PI-COMM-LENGTH)
 15701*    END-EXEC.
 15702*    MOVE '*"                    ''   #00013100' TO DFHEIV0
 15703     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 15704     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15705     MOVE X'2020233030303133313030' TO DFHEIV0(25:11)
 15706     CALL 'kxdfhei1' USING DFHEIV0,
 15707           PI-KEY,
 15708           PROGRAM-INTERFACE-BLOCK,
 15709           PI-COMM-LENGTH,
 15710           DFHEIV99,
 15711           DFHEIV99,
 15712           DFHEIV99
 15713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15714
 15715
 15716     MOVE XCTL-EL142             TO CALL-PGM.
 15717     GO TO 9200-XCTL.
 15718
 15719 8600-ADDR-MNT.
 15720     IF PI-RETURN-CD-1 = 'X'
 15721         MOVE ER-0311            TO EMI-ERROR
 15722         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15723         MOVE -1                 TO MAINTL
 15724         GO TO 8110-SEND-DATA.
 15725
 15726
 15727* EXEC CICS WRITEQ TS
 15728*         QUEUE     (PI-KEY)
 15729*         FROM      (PROGRAM-INTERFACE-BLOCK)
 15730*         LENGTH    (PI-COMM-LENGTH)
 15731*    END-EXEC.
 15732*    MOVE '*"                    ''   #00013116' TO DFHEIV0
 15733     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 15734     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15735     MOVE X'2020233030303133313136' TO DFHEIV0(25:11)
 15736     CALL 'kxdfhei1' USING DFHEIV0,
 15737           PI-KEY,
 15738           PROGRAM-INTERFACE-BLOCK,
 15739           PI-COMM-LENGTH,
 15740           DFHEIV99,
 15741           DFHEIV99,
 15742           DFHEIV99
 15743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15744
 15745
 15746     MOVE XCTL-EL141             TO CALL-PGM.
 15747     GO TO 9200-XCTL.
 15748
 15749 8700-CERT-MNT.
 15750     IF PI-RETURN-CD-1 = 'X'
 15751         MOVE ER-7690            TO EMI-ERROR
 15752         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 300
* EL131.cbl
 15753         MOVE -1                 TO MAINTL
 15754         GO TO 8110-SEND-DATA.
 15755
 15756
 15757* EXEC CICS WRITEQ TS
 15758*         QUEUE     (PI-KEY)
 15759*         FROM      (PROGRAM-INTERFACE-BLOCK)
 15760*         LENGTH    (PI-COMM-LENGTH)
 15761*    END-EXEC.
 15762*    MOVE '*"                    ''   #00013132' TO DFHEIV0
 15763     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 15764     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15765     MOVE X'2020233030303133313332' TO DFHEIV0(25:11)
 15766     CALL 'kxdfhei1' USING DFHEIV0,
 15767           PI-KEY,
 15768           PROGRAM-INTERFACE-BLOCK,
 15769           PI-COMM-LENGTH,
 15770           DFHEIV99,
 15771           DFHEIV99,
 15772           DFHEIV99
 15773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15774
 15775
 15776     MOVE XCTL-EL1273            TO CALL-PGM.
 15777     GO TO 9200-XCTL.
 15778
 15779 8750-DMD-CLM-FIX.
 15780
 15781* EXEC CICS WRITEQ TS
 15782*         QUEUE     (PI-KEY)
 15783*         FROM      (PROGRAM-INTERFACE-BLOCK)
 15784*         LENGTH    (PI-COMM-LENGTH)
 15785*    END-EXEC.
 15786*    MOVE '*"                    ''   #00013142' TO DFHEIV0
 15787     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 15788     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15789     MOVE X'2020233030303133313432' TO DFHEIV0(25:11)
 15790     CALL 'kxdfhei1' USING DFHEIV0,
 15791           PI-KEY,
 15792           PROGRAM-INTERFACE-BLOCK,
 15793           PI-COMM-LENGTH,
 15794           DFHEIV99,
 15795           DFHEIV99,
 15796           DFHEIV99
 15797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15798
 15799
 15800     MOVE XCTL-EL400DMD          TO CALL-PGM.
 15801     GO TO 9200-XCTL.
 15802
 15803 8800-UNAUTHORIZED-ACCESS.
 15804     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 15805     GO TO 8990-SEND-TEXT.
 15806
 15807 8810-PF23-ENTERED.
 15808     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 15809     MOVE XCTL-EL005             TO CALL-PGM.
 15810     GO TO 9200-XCTL.
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 301
* EL131.cbl
 15811
 15812 8820-XCTL-ERROR.
 15813
 15814* EXEC CICS HANDLE CONDITION
 15815*        PGMIDERR (8990-SEND-TEXT)
 15816*    END-EXEC.
 15817*    MOVE '"$L                   ! H #00013161' TO DFHEIV0
 15818     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 15819     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15820     MOVE X'4820233030303133313631' TO DFHEIV0(25:11)
 15821     CALL 'kxdfhei1' USING DFHEIV0
 15822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15823
 15824
 15825     MOVE SPACE                 TO PI-ENTRY-CD-1.
 15826     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 15827     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 15828     MOVE XCTL-EL005            TO CALL-PGM.
 15829     GO TO 9200-XCTL.
 15830
 15831 8990-SEND-TEXT.
 15832
 15833* EXEC CICS SEND TEXT
 15834*         FROM      (LOGOFF-TEXT)
 15835*         LENGTH    (LOGOFF-LENGTH)
 15836*         ERASE
 15837*         FREEKB
 15838*    END-EXEC.
 15839*    MOVE '8&      T  E F  H   F -   #00013172' TO DFHEIV0
 15840     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 15841     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 15842     MOVE X'2020233030303133313732' TO DFHEIV0(25:11)
 15843     CALL 'kxdfhei1' USING DFHEIV0,
 15844           LOGOFF-TEXT,
 15845           LOGOFF-LENGTH,
 15846           DFHEIV99,
 15847           DFHEIV99,
 15848           DFHEIV99,
 15849           DFHEIV99,
 15850           DFHEIV99,
 15851           DFHEIV99,
 15852           DFHEIV99,
 15853           DFHEIV99,
 15854           DFHEIV99,
 15855           DFHEIV99
 15856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15857
 15858
 15859     GO TO 9100-RETURN-CICS.
 15860
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 302
* EL131.cbl
 15862 9000-RETURN-TRANS.
 15863
 15864* EXEC CICS RETURN
 15865*         TRANSID   (TRANS-ID)
 15866*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 15867*         LENGTH    (PI-COMM-LENGTH)
 15868*    END-EXEC.
 15869*    MOVE '.(CT                  ''   #00013183' TO DFHEIV0
 15870     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 15871     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15872     MOVE X'2020233030303133313833' TO DFHEIV0(25:11)
 15873     CALL 'kxdfhei1' USING DFHEIV0,
 15874           TRANS-ID,
 15875           PROGRAM-INTERFACE-BLOCK,
 15876           PI-COMM-LENGTH,
 15877           DFHEIV99,
 15878           DFHEIV99,
 15879           DFHEIV99
 15880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15881
 15882
 15883
 15884* GOBACK.
 15885     MOVE '9%                    "   ' TO DFHEIV0
 15886     MOVE 'EL131' TO DFHEIV1
 15887     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15888     GOBACK.
 15889
 15890 9100-RETURN-CICS.
 15891
 15892* EXEC CICS RETURN
 15893*    END-EXEC.
 15894*    MOVE '.(                    ''   #00013192' TO DFHEIV0
 15895     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15896     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15897     MOVE X'2020233030303133313932' TO DFHEIV0(25:11)
 15898     CALL 'kxdfhei1' USING DFHEIV0,
 15899           DFHEIV99,
 15900           DFHEIV99,
 15901           DFHEIV99,
 15902           DFHEIV99,
 15903           DFHEIV99,
 15904           DFHEIV99
 15905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15906
 15907
 15908
 15909* GOBACK.
 15910     MOVE '9%                    "   ' TO DFHEIV0
 15911     MOVE 'EL131' TO DFHEIV1
 15912     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15913     GOBACK.
 15914
 15915 9200-XCTL.
 15916
 15917* EXEC CICS XCTL
 15918*         PROGRAM    (CALL-PGM)
 15919*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 303
* EL131.cbl
 15920*         LENGTH     (PI-COMM-LENGTH)
 15921*    END-EXEC.
 15922*    MOVE '.$C                   %   #00013198' TO DFHEIV0
 15923     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 15924     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15925     MOVE X'2020233030303133313938' TO DFHEIV0(25:11)
 15926     CALL 'kxdfhei1' USING DFHEIV0,
 15927           CALL-PGM,
 15928           PROGRAM-INTERFACE-BLOCK,
 15929           PI-COMM-LENGTH,
 15930           DFHEIV99
 15931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15932
 15933
 15934 9700-LINK-RTRM-FILE-ID.
 15935
 15936* EXEC CICS LINK
 15937*        PROGRAM  (RTRM-FILE-ID)
 15938*        COMMAREA (CALCULATION-PASS-AREA)
 15939*        LENGTH   (CP-COMM-LENGTH)
 15940*    END-EXEC.
 15941*    MOVE '."C                   (   #00013205' TO DFHEIV0
 15942     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15943     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15944     MOVE X'2020233030303133323035' TO DFHEIV0(25:11)
 15945     CALL 'kxdfhei1' USING DFHEIV0,
 15946           RTRM-FILE-ID,
 15947           CALCULATION-PASS-AREA,
 15948           CP-COMM-LENGTH,
 15949           DFHEIV99,
 15950           DFHEIV99,
 15951           DFHEIV99,
 15952           DFHEIV99
 15953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15954
 15955
 15956 9700-EXIT.
 15957      EXIT.
 15958
 15959 9800-CONVERT-DATE.
 15960     MOVE SPACES TO DC-ERROR-CODE.
 15961
 15962* EXEC CICS LINK
 15963*         PROGRAM    (DATE-CONV)
 15964*         COMMAREA   (DATE-CONVERSION-DATA)
 15965*         LENGTH     (DC-COMM-LENGTH)
 15966*    END-EXEC.
 15967*    MOVE '."C                   (   #00013216' TO DFHEIV0
 15968     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15969     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15970     MOVE X'2020233030303133323136' TO DFHEIV0(25:11)
 15971     CALL 'kxdfhei1' USING DFHEIV0,
 15972           DATE-CONV,
 15973           DATE-CONVERSION-DATA,
 15974           DC-COMM-LENGTH,
 15975           DFHEIV99,
 15976           DFHEIV99,
 15977           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 304
* EL131.cbl
 15978           DFHEIV99
 15979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15980
 15981
 15982 9800-EXIT.
 15983     EXIT.
 15984
 15985 9900-ERROR-FORMAT.
 15986
 15987* EXEC CICS LINK
 15988*         PROGRAM    (XCTL-EL001)
 15989*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 15990*         LENGTH     (EMI-COMM-LENGTH)
 15991*    END-EXEC.
 15992*    MOVE '."C                   (   #00013226' TO DFHEIV0
 15993     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15994     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15995     MOVE X'2020233030303133323236' TO DFHEIV0(25:11)
 15996     CALL 'kxdfhei1' USING DFHEIV0,
 15997           XCTL-EL001,
 15998           ERROR-MESSAGE-INTERFACE-BLOCK,
 15999           EMI-COMM-LENGTH,
 16000           DFHEIV99,
 16001           DFHEIV99,
 16002           DFHEIV99,
 16003           DFHEIV99
 16004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16005
 16006
 16007 9900-EXIT.
 16008     EXIT.
 16009
 16010 9990-ABEND.
 16011     MOVE DFHEIBLK               TO EMI-LINE1.
 16012
 16013* EXEC CICS LINK
 16014*         PROGRAM   (XCTL-EL004)
 16015*         COMMAREA  (EMI-LINE1)
 16016*         LENGTH    (72)
 16017*     END-EXEC.
 16018     MOVE 72
 16019       TO DFHEIV11
 16020*    MOVE '."C                   (   #00013237' TO DFHEIV0
 16021     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16022     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16023     MOVE X'2020233030303133323337' TO DFHEIV0(25:11)
 16024     CALL 'kxdfhei1' USING DFHEIV0,
 16025           XCTL-EL004,
 16026           EMI-LINE1,
 16027           DFHEIV11,
 16028           DFHEIV99,
 16029           DFHEIV99,
 16030           DFHEIV99,
 16031           DFHEIV99
 16032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16033
 16034
 16035     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 305
* EL131.cbl
 16036
 16037     GO TO 8110-SEND-DATA.
 16038
 16039 9995-SECURITY-VIOLATION.
 16040*           COPY ELCSCTP.
 16041******************************************************************
 16042*                                                                *
 16043*                            ELCSCTP                             *
 16044*                            VMOD=2.001                          *
 16045*                                                                *
 16046*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 16047******************************************************************
 16048
 16049
 16050     MOVE EIBDATE          TO SM-JUL-DATE.
 16051     MOVE EIBTRMID         TO SM-TERMID.
 16052     MOVE THIS-PGM         TO SM-PGM.
 16053     MOVE EIBTIME          TO TIME-IN.
 16054     MOVE TIME-OUT         TO SM-TIME.
 16055     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 16056
 16057
 16058* EXEC CICS LINK
 16059*         PROGRAM  ('EL003')
 16060*         COMMAREA (SECURITY-MESSAGE)
 16061*         LENGTH   (80)
 16062*    END-EXEC.
 16063     MOVE 'EL003' TO DFHEIV1
 16064     MOVE 80
 16065       TO DFHEIV11
 16066*    MOVE '."C                   (   #00013265' TO DFHEIV0
 16067     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16068     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16069     MOVE X'2020233030303133323635' TO DFHEIV0(25:11)
 16070     CALL 'kxdfhei1' USING DFHEIV0,
 16071           DFHEIV1,
 16072           SECURITY-MESSAGE,
 16073           DFHEIV11,
 16074           DFHEIV99,
 16075           DFHEIV99,
 16076           DFHEIV99,
 16077           DFHEIV99
 16078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16079
 16080
 16081******************************************************************
 16082
 16083
 16084
 16085 9999-DFHBACK SECTION.
 16086     MOVE '9%                    "   ' TO DFHEIV0
 16087     MOVE 'EL131' TO DFHEIV1
 16088     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16089     GOBACK.
 16090 9999-DFHEXIT.
 16091     IF DFHEIGDJ EQUAL 0001
 16092         NEXT SENTENCE
 16093     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 306
* EL131.cbl
 16094         GO TO 8820-XCTL-ERROR,
 16095               8150-ENTERED-CLAIM-NOTFOUND,
 16096               9990-ABEND
 16097         DEPENDING ON DFHEIGDI
 16098     ELSE IF DFHEIGDJ EQUAL 3
 16099         GO TO 0130-TS-ERROR,
 16100               0130-TS-ERROR
 16101         DEPENDING ON DFHEIGDI
 16102     ELSE IF DFHEIGDJ EQUAL 4
 16103         GO TO 0600-CONTINUE-NAME-UPDATE
 16104         DEPENDING ON DFHEIGDI
 16105     ELSE IF DFHEIGDJ EQUAL 5
 16106         GO TO 1004-BENE-NOT-FOUND
 16107         DEPENDING ON DFHEIGDI
 16108     ELSE IF DFHEIGDJ EQUAL 6
 16109         GO TO 1120-CNTL-NOTFND
 16110         DEPENDING ON DFHEIGDI
 16111     ELSE IF DFHEIGDJ EQUAL 7
 16112         GO TO 1150-NOTOPEN-ERROR,
 16113               1150-EXIT
 16114         DEPENDING ON DFHEIGDI
 16115     ELSE IF DFHEIGDJ EQUAL 8
 16116         GO TO 1490-STATE-NOTFND
 16117         DEPENDING ON DFHEIGDI
 16118     ELSE IF DFHEIGDJ EQUAL 9
 16119         GO TO 1500-CARR-NOTFND
 16120         DEPENDING ON DFHEIGDI
 16121     ELSE IF DFHEIGDJ EQUAL 10
 16122         GO TO 1620-ACCT-NOTFND
 16123         DEPENDING ON DFHEIGDI
 16124     ELSE IF DFHEIGDJ EQUAL 11
 16125         GO TO 2020-EXIT
 16126         DEPENDING ON DFHEIGDI
 16127     ELSE IF DFHEIGDJ EQUAL 12
 16128         GO TO 2030-EXIT
 16129         DEPENDING ON DFHEIGDI
 16130     ELSE IF DFHEIGDJ EQUAL 13
 16131         GO TO 2040-EXIT
 16132         DEPENDING ON DFHEIGDI
 16133     ELSE IF DFHEIGDJ EQUAL 14
 16134         GO TO 2050-EXIT
 16135         DEPENDING ON DFHEIGDI
 16136     ELSE IF DFHEIGDJ EQUAL 15
 16137         GO TO 2060-CERT-NOTFND
 16138         DEPENDING ON DFHEIGDI
 16139     ELSE IF DFHEIGDJ EQUAL 16
 16140         GO TO 2060-DUPKEY
 16141         DEPENDING ON DFHEIGDI
 16142     ELSE IF DFHEIGDJ EQUAL 17
 16143         GO TO 2070-NOT-FOUND
 16144         DEPENDING ON DFHEIGDI
 16145     ELSE IF DFHEIGDJ EQUAL 18
 16146         GO TO 2070-EXIT
 16147         DEPENDING ON DFHEIGDI
 16148     ELSE IF DFHEIGDJ EQUAL 19
 16149         GO TO 2080-EXIT
 16150         DEPENDING ON DFHEIGDI
 16151     ELSE IF DFHEIGDJ EQUAL 20
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 307
* EL131.cbl
 16152         GO TO 2400-TRLR-NOTFND,
 16153               2410-EXIT
 16154         DEPENDING ON DFHEIGDI
 16155     ELSE IF DFHEIGDJ EQUAL 21
 16156         GO TO 2425-NINETY-NOTFND,
 16157               2425-NINETY-NOTFND
 16158         DEPENDING ON DFHEIGDI
 16159     ELSE IF DFHEIGDJ EQUAL 22
 16160         GO TO 2430-EXIT,
 16161               2440-EXIT
 16162         DEPENDING ON DFHEIGDI
 16163     ELSE IF DFHEIGDJ EQUAL 23
 16164         GO TO 2440-EXIT
 16165         DEPENDING ON DFHEIGDI
 16166     ELSE IF DFHEIGDJ EQUAL 24
 16167         GO TO 2460-EXIT
 16168         DEPENDING ON DFHEIGDI
 16169     ELSE IF DFHEIGDJ EQUAL 25
 16170         GO TO 2475-EXIT
 16171         DEPENDING ON DFHEIGDI
 16172     ELSE IF DFHEIGDJ EQUAL 26
 16173         GO TO 2650-EXIT
 16174         DEPENDING ON DFHEIGDI
 16175     ELSE IF DFHEIGDJ EQUAL 27
 16176         GO TO 2800-EXIT,
 16177               2800-EXIT
 16178         DEPENDING ON DFHEIGDI
 16179     ELSE IF DFHEIGDJ EQUAL 28
 16180         GO TO 3010-DEL-ACTQ,
 16181               3040-EXIT
 16182         DEPENDING ON DFHEIGDI
 16183     ELSE IF DFHEIGDJ EQUAL 29
 16184         GO TO 3010-NO-ACTIVITY,
 16185               3050-EXIT
 16186         DEPENDING ON DFHEIGDI
 16187     ELSE IF DFHEIGDJ EQUAL 30
 16188         GO TO 3010-CERT-NOT-FOUND
 16189         DEPENDING ON DFHEIGDI
 16190     ELSE IF DFHEIGDJ EQUAL 31
 16191         GO TO 3020-EXIT
 16192         DEPENDING ON DFHEIGDI
 16193     ELSE IF DFHEIGDJ EQUAL 32
 16194         GO TO 3060-EXIT,
 16195               3060-EXIT
 16196         DEPENDING ON DFHEIGDI
 16197     ELSE IF DFHEIGDJ EQUAL 33
 16198         GO TO 5000-TRLR-NOT-FOUND
 16199         DEPENDING ON DFHEIGDI
 16200     ELSE IF DFHEIGDJ EQUAL 34
 16201         GO TO 5000-CERT-NOT-FOUND
 16202         DEPENDING ON DFHEIGDI
 16203     ELSE IF DFHEIGDJ EQUAL 35
 16204         GO TO 7630-END-BROWSE
 16205         DEPENDING ON DFHEIGDI
 16206     ELSE IF DFHEIGDJ EQUAL 36
 16207         GO TO 7799-EXIT,
 16208               7799-EXIT
 16209         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 15-Aug-13 09:20 Page 308
* EL131.cbl
 16210     ELSE IF DFHEIGDJ EQUAL 37
 16211         GO TO 7799-EXIT
 16212         DEPENDING ON DFHEIGDI
 16213     ELSE IF DFHEIGDJ EQUAL 38
 16214         GO TO 7800-NOT-FOUND
 16215         DEPENDING ON DFHEIGDI
 16216     ELSE IF DFHEIGDJ EQUAL 39
 16217         GO TO 8000-NOTE-NOT-FOUND
 16218         DEPENDING ON DFHEIGDI
 16219     ELSE IF DFHEIGDJ EQUAL 40
 16220         GO TO 8990-SEND-TEXT
 16221         DEPENDING ON DFHEIGDI.
 16222     MOVE '9%                    "   ' TO DFHEIV0
 16223     MOVE 'EL131' TO DFHEIV1
 16224     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16225     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13132     Code:       54787
