* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
    79* 022017  IR2017022000002  PEMA  PREVENT DEL OF ISS W/CHECK
    80* 101016  CR2015082500001  PEMA  ADD COMPANY VPP
    81* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    82* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    83* 052918  CR2018040600002  PEMA  ADD REFUND DIRECT INDICATOR
    84* 021519  CR2019021100001  PEMA  non-monthly al calcs
    85******************************************************************
    86
    87 ENVIRONMENT DIVISION.
    88
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   4
* EL6311.cbl
    90 DATA DIVISION.
    91 WORKING-STORAGE SECTION.
    92 01  DFH-START PIC X(04).
    93 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    94 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    95 77  FILLER  PIC X(32)  VALUE '********************************'.
    96 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    97 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    98 77  A1                          PIC S999 COMP-3 VALUE +0.
    99 77  N1                          PIC S999 COMP-3 VALUE +0.
   100 77  N2                          PIC S999 COMP-3 VALUE +0.
   101 77  N3                          PIC S999 COMP-3 VALUE +0.
   102 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
   103 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
   104 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   105     88  REVERSAL                    VALUE 'Y'.
   106 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   107 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   108 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   109 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   110 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   111     88  ERMAIL-FOUND                 VALUE 'Y'.
   112 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   113 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   114 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   115 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   116     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   117 77  ws-stop-sw                  pic x value ' '.
   118     88  i-say-stop                 value 'Y'.
   119 77  ws-check-sw                 pic x value ' '.
   120     88  i-have-checks              value 'Y'.
   121 77  ws-proc-check-sw            pic x value ' '.
   122     88  i-have-processed-checks    value 'Y'.
   123 77  ws-any-check-sw             pic x value ' '.
   124     88  i-have-a-check-period      value 'Y'.
   125 77  ws-chek-browse-sw           pic x value ' '.
   126 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   127 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   128 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   129 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   130 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   131 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   132 77  ws-elcrtt-update-sw         pic x value ' '.
   133     88  update-elcrtt              value 'Y'.
   134 01  P pointer.
   135 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   136 01  var-ptr pointer.
   137 01  env-var-len                 pic 9(4)  binary.
   138 01  rc                          pic 9(9)  binary.
   139 01  WS-KIXSYS.
   140     05  WS-KIX-FIL1             PIC X(10).
   141     05  WS-KIX-APPS             PIC X(10).
   142     05  WS-KIX-ENV              PIC X(10).
   143     05  WS-KIX-MYENV            PIC X(10).
   144     05  WS-KIX-SYS              PIC X(10).
   145*    COPY ELCSCTM.
   146******************************************************************
   147*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   5
* EL6311.cbl
   148*                                                                *
   149*                            ELCSCTM                             *
   150*                            VMOD=2.001                          *
   151*                                                                *
   152*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   153*                                                                *
   154******************************************************************
   155 01  SECURITY-MESSAGE.
   156     12  FILLER                          PIC X(30)
   157            VALUE '** LOGIC SECURITY VIOLATION -'.
   158     12  SM-READ                         PIC X(6).
   159     12  FILLER                          PIC X(5)
   160            VALUE ' PGM='.
   161     12  SM-PGM                          PIC X(6).
   162     12  FILLER                          PIC X(5)
   163            VALUE ' OPR='.
   164     12  SM-PROCESSOR-ID                 PIC X(4).
   165     12  FILLER                          PIC X(6)
   166            VALUE ' TERM='.
   167     12  SM-TERMID                       PIC X(4).
   168     12  FILLER                          PIC XX   VALUE SPACE.
   169     12  SM-JUL-DATE                     PIC 9(5).
   170     12  FILLER                          PIC X    VALUE SPACE.
   171     12  SM-TIME                         PIC 99.99.
   172
   173
   174*    COPY ELCSCRTY.
   175******************************************************************
   176*                                                                *
   177*                                                                *
   178*                            ELCSCRTY                            *
   179*                            VMOD=2.001                          *
   180*                                                                *
   181*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   182*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   183*        SAVED IN PI-SECURITY-ADDRESS.                           *
   184*                                                                *
   185******************************************************************
   186 01  SECURITY-CONTROL.
   187     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   188     12  FILLER                       PIC XX    VALUE 'SC'.
   189     12  SC-CREDIT-CODES.
   190         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   191             20  SC-CREDIT-DISPLAY    PIC X.
   192             20  SC-CREDIT-UPDATE     PIC X.
   193     12  SC-CLAIMS-CODES.
   194         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   195             20  SC-CLAIMS-DISPLAY    PIC X.
   196             20  SC-CLAIMS-UPDATE     PIC X.
   197
   198 01  WS-VA-NO-COMM-MESS.
   199     12  FILLER                  PIC X(41) VALUE
   200        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   201 01  WS-OC-MESSAGE.
   202     12  FILLER                  PIC X(43) VALUE
   203        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   204     12  WS-OC-DIS-AMT           PIC -----9.99.
   205     12  FILLER                  PIC X(4) VALUE ' ON '.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   6
* EL6311.cbl
   206     12  WS-OC-DATE              PIC X(10).
   207 01  WS-DATE-AREA.
   208     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   209     12  WS-CURRENT-DT.
   210         16  FILLER              PIC X(6)    VALUE SPACES.
   211         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   212     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   213     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   214     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   215
   216 01  STANDARD-AREAS.
   217     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   218     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   219     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   220     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   221     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   222     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   223     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   224     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   225     12  PGM-NAME                PIC X(8).
   226     12  TIME-IN                 PIC S9(7).
   227     12  TIME-OUT-R  REDEFINES TIME-IN.
   228         16  FILLER              PIC X.
   229         16  TIME-OUT            PIC 99V99.
   230         16  FILLER              PIC XX.
   231     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   232     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   233     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   234     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   235     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   236     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   237     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   238     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   239     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   240     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   241     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   242     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   243     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   244     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   245     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   246     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   247     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   248     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   249     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   250     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   251     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   252     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   253     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   254     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   255     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   256     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   257     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   258     12  FILE-ID                 PIC X(8).
   259     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   260     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   261     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   262     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   263     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   7
* EL6311.cbl
   264     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   265     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   266     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   267     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   268     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   269     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   270     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   271     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   272     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   273     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   274
   275 01  WS-PASS-AREA.
   276     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   277     05  WS-PASS-VADS-REC    PIC X(350).
   278*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   279*                                COPY ELCZREC.
   280******************************************************************
   281*                                                                *
   282*                                                                *
   283*                            ELCZREC.                            *
   284*                                                                *
   285*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   286*                                                                *
   287******************************************************************
   288*-----------------------------------------------------------------
   289*                   C H A N G E   L O G
   290*
   291* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   292*-----------------------------------------------------------------
   293*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   294* EFFECTIVE    NUMBER
   295*-----------------------------------------------------------------
   296* 122011    2011022800001  AJRA  NEW FILE
   297* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   298* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   299* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   300* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   301*-----------------------------------------------------------------
   302 01  W-Z-CONTROL-DATA.
   303     05  W-NUMBER-OF-COPIES      PIC  9.
   304     05  FILLER                  PIC  X.
   305     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   306     05  FILLER                  PIC  X.
   307     05  W-DAYS-TO-RESEND        PIC  999.
   308     05  FILLER                  PIC  X.
   309     05  W-FORM-TO-RESEND        PIC  X(4).
   310     05  W-ADD-BAR-CODE          PIC  X.
   311     05  W-PROMPT-LETTER         PIC  X.
   312     05  W-HAS-RETURN-ENV        PIC  X.
   313     05  W-ENCLOSURE-CD          PIC  XXX.
   314     05  W-SIG-FLAG-DEFAULT      PIC  X.
   315     05  W-AUTO-CLOSE-IND        PIC  X.
   316     05  FILLER                  PIC  X.
   317     05  W-LETTER-TO-BENE        PIC  X.
   318     05  FILLER                  PIC  X.
   319     05  W-LETTER-TO-ACCT        PIC  X.
   320     05  FILLER                  PIC  X.
   321     05  W-LETTER-TYPE           PIC  X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   8
* EL6311.cbl
   322     05  FILLER                  PIC  X.
   323     05  W-PRINT-CERTIFICATE     PIC  X.
   324     05  FILLER                  PIC  X.
   325     05  W-REFUND-REQUIRED       PIC  X.
   326     05  FILLER                  PIC  X.
   327     05  W-ONBASE-CODE           PIC  XX.
   328     05  FILLER                  PIC  X.
   329     05  W-ACCT-SUMM             PIC  X.
   330     05  FILLER                  PIC  X.
   331     05  W-CSO-SUMM              PIC  X.
   332     05  FILLER                  PIC  X.
   333     05  W-REASONS-REQUIRED      PIC  X.
   334     05  FILLER                  PIC  X(29).
   335******************************************************************
   336*                                                                *
   337*              A C C E S S   K E Y S                             *
   338*                                                                *
   339******************************************************************
   340
   341 01  ACCESS-KEYS.
   342     12  ERPYAJ-KEY.
   343         16  ERPYAJ-COMPANY-CD       PIC X.
   344         16  ERPYAJ-CARRIER          PIC X.
   345         16  ERPYAJ-GROUPING         PIC X(6).
   346         16  ERPYAJ-FIN-RESP         PIC X(10).
   347         16  ERPYAJ-ACCOUNT          PIC X(10).
   348         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   349         16  ERPYAJ-TYPE             PIC X.
   350     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   351     12  ELCERT-KEY.
   352         16  ELCERT-COMPANY-CD       PIC X.
   353         16  ELCERT-CARRIER          PIC X.
   354         16  ELCERT-GROUPING         PIC X(6).
   355         16  ELCERT-STATE            PIC XX.
   356         16  ELCERT-ACCOUNT          PIC X(10).
   357         16  ELCERT-CERT-EFF-DT      PIC XX.
   358         16  ELCERT-CERT-NO.
   359             20  ELCERT-CERT-PRIME   PIC X(10).
   360             20  ELCERT-CERT-SFX     PIC X.
   361
   362     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   363     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   364     12  ELCRTO-KEY.
   365         16  ELCRTO-COMPANY-CD       PIC X.
   366         16  ELCRTO-CARRIER          PIC X.
   367         16  ELCRTO-GROUPING         PIC X(6).
   368         16  ELCRTO-STATE            PIC XX.
   369         16  ELCRTO-ACCOUNT          PIC X(10).
   370         16  ELCRTO-CERT-EFF-DT      PIC XX.
   371         16  ELCRTO-CERT-NO.
   372             20  ELCRTO-CERT-PRIME   PIC X(10).
   373             20  ELCRTO-CERT-SFX     PIC X.
   374         16  ELCRTO-RECORD-TYPE      PIC X.
   375         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   376
   377     12  ELCRTT-KEY.
   378         16  ELCRTT-PRIMARY          PIC X(33).
   379         16  ELCRTT-REC-TYPE         PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   9
* EL6311.cbl
   380     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   381     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   382
   383     12  ERPNDB-KEY.
   384         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   385         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   386         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   387         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   388             ERPNDB-BATCH-SEQ-NO     PIC XX.
   389         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   390
   391     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   392     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   393     12  ERCHEK-KEY.
   394         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   395         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   396         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   397         16  CHEK-STATE              PIC XX      VALUE SPACES.
   398         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   399         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   400         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   401         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   402         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   403     12  ELLETR-KEY.
   404         16  LETR-COMPANY-CD     PIC X.
   405         16  LETR-LETTER-ID      PIC X(4).
   406         16  LETR-FILLER         PIC X(8).
   407         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   408     12  ERPNDM-KEY.
   409         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   410         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   411         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   412         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   413
   414*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   415     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   416*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   417     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   418
   419     12  ERPNDB-ALT-KEY.
   420         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   421         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   422         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   423         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   424         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   425         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   426         16  ERPNDB-CERT-NO.
   427             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   428             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   429         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   430         16  ERPNDB-RECORD-TYPE      PIC X.
   431
   432      12  ERPNDB-CSR-KEY.
   433          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   434          20  ERPNDB-CSR-ID                PIC X(4).
   435          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   436          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   437          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  10
* EL6311.cbl
   438
   439     12  ERNOTE-KEY.
   440         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   441         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   442         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   443         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   444         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   445         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   446         16  ERNOTE-CERT-NO.
   447             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   448             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   449
   450     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   451     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   452
   453     12  ERCNOT-KEY.
   454         16  ERCNOT-PART-KEY.
   455             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   456             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   457             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   458             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   459             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   460             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   461             20  ERCNOT-CERT-NO.
   462                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   463                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   464         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   465         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   466
   467     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   468     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   469
   470     12  ERMAIL-KEY.
   471         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   472         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   473         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   474         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   475         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   476         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   477         16  ERMAIL-CERT-NO.
   478             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   479             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   480
   481     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   482     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   483
   484     12  ERRQST-KEY.
   485         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   486         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   487
   488     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   489     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   490
   491     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   492
   493     12  ERLOFC-KEY.
   494         16  ERLOFC-COMPANY-CD          PIC  X.
   495         16  ERLOFC-CARRIER             PIC  X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  11
* EL6311.cbl
   496         16  ERLOFC-GROUPING            PIC  X(6).
   497         16  ERLOFC-STATE               PIC  XX.
   498         16  ERLOFC-ACCOUNT             PIC  X(10).
   499         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   500*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   501
   502     12  ERACCT-KEY.
   503         16  ERACCT-COMPANY-CD          PIC  X.
   504         16  ERACCT-CARRIER             PIC  X.
   505         16  ERACCT-GROUPING            PIC  X(6).
   506         16  ERACCT-STATE               PIC  XX.
   507         16  ERACCT-ACCOUNT             PIC  X(10).
   508         16  ERACCT-EXP-DT.
   509             20  ERACCT-DT              PIC  XX.
   510             20  ERACCT-FILL            PIC  X(4).
   511     12  ERACNT-KEY.
   512         16  ERACNT-COMPANY-CD          PIC  X.
   513         16  ERACNT-CARRIER             PIC  X.
   514         16  ERACNT-GROUPING            PIC  X(6).
   515         16  ERACNT-STATE               PIC  XX.
   516         16  ERACNT-ACCOUNT             PIC  X(10).
   517         16  ERACNT-REC-TYPE            PIC  X.
   518         16  ERACNT-SEQ-NO              PIC  S9(4) COMP.
   519     12  ERENDT-KEY.
   520         16  ENDT-COMPANY-CD       PIC X.
   521         16  ENDT-CARRIER          PIC X.
   522         16  ENDT-GROUPING         PIC X(6).
   523         16  ENDT-STATE            PIC XX.
   524         16  ENDT-ACCOUNT          PIC X(10).
   525         16  ENDT-CERT-EFF-DT      PIC XX.
   526         16  ENDT-CERT-PRIME       PIC X(10).
   527         16  ENDT-CERT-SFX         PIC X.
   528         16  ENDT-RECORD-TYPE      PIC X.
   529         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   530
   531 01  WS-ELMSTR-WORK.
   532     12  ELMSTR-KEY.
   533         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   534         16  MSTR-CERT-NO.
   535             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   536             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   537     12  W-CLAIM-KEY.
   538         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   539         16  W-CL-CERT-NO.
   540             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   541             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   542      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   543 01  CANCEL-GEN-PASS-AREA.
   544     05  CG-OPTION-CODE          PIC X.
   545         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   546         88  CG-FLAT-CANCEL        VALUE '1'.
   547         88  CG-CANCEL             VALUE '2'.
   548         88  CG-CANCEL-REISSUE     VALUE '3'.
   549     05  CG-ERROR-CODE           PIC 99.
   550         88  CG-SUCCESS            VALUE 00.
   551         88  CG-DATE-ERROR         VALUE 01.
   552         88  CG-CERT-NOT-FOUND     VALUE 02.
   553         88  CG-AMOUNT-ERROR       VALUE 04.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  12
* EL6311.cbl
   554         88  CG-OPTION-ERROR       VALUE 05.
   555         88  CG-PREV-CAN           VALUE 06.
   556         88  CG-INVALID-DATA       VALUE 07.
   557         88  CG-NO-ACCT-MSTR       VALUE 08.
   558         88  CG-SFX-A-EXIST        VALUE 09.
   559         88  CG-MISC-ERROR         VALUE 99.
   560     05  CG-COMPANY-ID           PIC XXX.
   561     05  CG-PROC-ID              PIC XXXX.
   562     05  CG-CURRENT-DT           PIC XX.
   563     05  CG-MONTH-END-DT         PIC XX.
   564     05  CG-CERT-KEY.
   565         10  CG-CERT-COMPANY-CD  PIC X.
   566         10  CG-CERT-CARRIER     PIC X.
   567         10  CG-CERT-GROUP       PIC X(6).
   568         10  CG-CERT-STATE       PIC XX.
   569         10  CG-CERT-ACCOUNT     PIC X(10).
   570         10  CG-CERT-EFF-DT      PIC XX.
   571         10  CG-CERT-CERT-NO     PIC X(11).
   572     05  CG-LF-CAN-DATA.
   573         10  CG-LF-CAN-DT        PIC XX.
   574         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   575     05  CG-AH-CAN-DATA.
   576         10  CG-AH-CAN-DT        PIC XX.
   577         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   578     05  CG-CERT-PROFILE-DATA.
   579         10  CG-INS-LNAME        PIC X(15).
   580         10  CG-INS-FNAME        PIC X(10).
   581         10  CG-INS-MID-INIT     PIC X.
   582         10  CG-INS-AGE          PIC 99.
   583         10  CG-JNT-LNAME        PIC X(15).
   584         10  CG-JNT-FNAME        PIC X(10).
   585         10  CG-JNT-MID-INIT     PIC X.
   586         10  CG-JNT-AGE          PIC 99.
   587     05  CG-LF-ISS-DATA.
   588         10  CG-LF-BENCD         PIC XX.
   589         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   590         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   591     05  CG-AH-ISS-DATA.
   592         10  CG-AH-BENCD         PIC XX.
   593         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   594     05  CG-BATCH-NO             PIC X(6).
   595     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   596     05  FILLER                  PIC X(306).
   597******************************************************************
   598*                                                                *
   599*            G E N E R A L   W O R K   A R E A                   *
   600*                                                                *
   601******************************************************************
   602
   603 01  WORK-AREA.
   604     12  WS-RESPONSE             PIC S9(8)   COMP.
   605         88  RESP-NORMAL           VALUE +0.
   606         88  resp-file-notfnd      value +12.
   607         88  RESP-NOTFND           VALUE +13.
   608         88  resp-duprec           value +14.
   609         88  resp-dupkey           value +15.
   610         88  resp-invreq           value +16.
   611         88  RESP-NOTOPEN          VALUE +19.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  13
* EL6311.cbl
   612         88  RESP-ENDFILE          VALUE +20.
   613         88  resp-lengtherr        value +22.
   614     12  DEEDIT-FIELD            PIC X(15).
   615     12  FILLER          REDEFINES DEEDIT-FIELD.
   616         16  FILLER              PIC X(4).
   617         16  DEEDIT-FIELD-X11    PIC X(11).
   618     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   619                                 PIC S9(15).
   620     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   621                                 PIC S9(13)V99.
   622     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   623                                 PIC S9(11)V9999.
   624     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   625     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   626     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   627         16  WS-CALC-TERM-WHOLE  PIC S999.
   628         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   629
   630     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   631     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   632         16  WS-HR-MINS          PIC 99V99.
   633         16  FILLER              PIC XX.
   634
   635     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   636     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   637
   638     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   639     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   640
   641     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   642     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   643     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   644     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   645     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   646     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   647     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   648
   649     12  QID.
   650         16  QID-TERM            PIC X(4).
   651         16  FILLER              PIC X(4)    VALUE '607B'.
   652
   653     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   654         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   655
   656     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   657         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   658
   659     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   660         88 WS-MODE-CODE-VALID     VALUE ' '
   661                                         'W'     *> Weekly
   662                                         'B'     *> Bi-weekly
   663                                         'S'     *> Semi-monthly
   664                                         'M'     *> Monthly (Def)
   665                                         'Q'     *> Quarterly
   666                                         'N'     *> Bi-Monthly??
   667                                         'T'     *> Semi-annual
   668                                         'A'.    *> Annual Pay
   669
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  14
* EL6311.cbl
   670     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   671
   672     12  WS-NUMERIC-SW           PIC X.
   673        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   674
   675     12  WS-EDIT-CSO-FIELD.
   676         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   677                                 PIC X.
   678
   679     12  WS-SAVE-INPUT-FIELDS.
   680         16  WS-BAGE             PIC 99       VALUE ZERO.
   681*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   682         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   683         16  FILLER REDEFINES WS-BAPR.
   684             20  WS-APR-WHOLE-NUM    PIC 99.
   685             20  WS-APR-DEC          PIC 9999.
   686         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   687         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   688
   689         16  WS-B-COVERAGE OCCURS 2 TIMES.
   690             20  WS-TERM-IN-DAYS-SW  PIC X.
   691                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   692             20  WS-BTERM        PIC 999       COMP-3.
   693             20  WS-BALT-TERM    PIC 999       COMP-3.
   694             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   695             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   696             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   697             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   698             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   699             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   700
   701         16  WS-C-FIELDS COMP-3.
   702             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   703             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   704             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   705
   706         16  WS-D-FIELDS COMP-3.
   707             20  WS-DRISS        PIC S9(5)    VALUE +0.
   708             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   709             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   710             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   711             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   712             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   713
   714     12  WS-SAVE-BIRTH-DATE.
   715         16  FILLER              PIC X(4)   VALUE SPACES.
   716         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   717
   718     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   719     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   720     12  FILLER REDEFINES WS-WORK-BIN-RED.
   721         16  FILLER              PIC X(02).
   722         16  WS-WORK-BIN-DT      PIC X(02).
   723     12  WS-SW-1                 PIC X     VALUE SPACE.
   724     12  WS-SW-2                 PIC X     VALUE SPACE.
   725     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   726         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   727     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  15
* EL6311.cbl
   728         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   729
   730     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   731     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   732     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   733     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   734     12  WS-CONVERTED-CANCEL-DATES.
   735         16  WS-CONVERTED-CANDT1                  PIC XX.
   736         16  WS-CONVERTED-CANDT2                  PIC XX.
   737
   738     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   739
   740     12  WS-REC-FOUND-SW         PIC X.
   741         88  RECORD-NOT-FOUND    VALUE 'N'.
   742
   743     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   744         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   745         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   746
   747     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   748         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   749         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   750
   751     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   752         88  BROWSE-STARTED      VALUE 'Y'.
   753
   754     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   755         88  FIRST-TIME          VALUE 'Y'.
   756
   757     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   758         88  FIRST-ENTRY         VALUE 'Y'.
   759
   760     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   761         88  REC-BILLED          VALUE 'Y'.
   762
   763     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   764         88  NO-CURSOR-SET       VALUE +0.
   765         88  CURSOR-SET          VALUE +1.
   766
   767     12  WS-ERR-SW               PIC X.
   768         88  STD-ERRORS          VALUE 'S'.
   769         88  TRN-ERRORS          VALUE 'T'.
   770
   771     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   772         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   773
   774     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   775         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   776
   777     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   778         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   779
   780     12  WS-ERR-CODE.
   781         16  FILLER              PIC 99.
   782         16  WS-ERROR-SUB        PIC 99.
   783
   784     12  WS-DATE-WORK.
   785         16  WS-WORK-MM          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  16
* EL6311.cbl
   786         16  WS-WORK-DD          PIC XX.
   787         16  WS-WORK-YY          PIC XX.
   788
   789     12  WS-MM-YY.
   790         16  WS-MM               PIC XX.
   791         16  FILLER              PIC X     VALUE '/'.
   792         16  WS-YY               PIC XX.
   793
   794     12  WS-CERT-EFF-DT          PIC XX.
   795
   796     12  WS-MEMBER-NO            PIC X(12).
   797     12  FILLER  REDEFINES  WS-MEMBER-NO.
   798         16  WS-MEMBER-NO-1-8    PIC 9(8).
   799         16  FILLER              PIC X(4).
   800
   801     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   802
   803     12  WS-ERPNDB-ALT-KEY.
   804         16  WS-PB-COMPANY-CD-A1         PIC X.
   805         16  WS-PB-CARRIER               PIC X.
   806         16  WS-PB-GROUPING              PIC X(6).
   807         16  WS-PB-STATE                 PIC XX.
   808         16  WS-PB-ACCOUNT               PIC X(10).
   809         16  WS-PB-CERT-EFF-DT           PIC XX.
   810         16  WS-PB-CERT-NO.
   811             20  WS-PB-CERT-PRIME        PIC X(10).
   812             20  WS-PB-CERT-SFX          PIC X.
   813         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   814         16  WS-PB-RECORD-TYPE           PIC X.
   815
   816     12  WS-SHOW-SAVE-AREAS.
   817         16  WS-NEW-CERT-NO.
   818             20  WS-NEW-PRIME    PIC X(10).
   819             20  WS-NEW-SUFFIX   PIC X.
   820         16  WS-NEW-CERT-EFF-DT  PIC XX.
   821         16  WS-NEW-RECORD-TYPE  PIC X.
   822         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   823             88   SHOW-RECORD            VALUE 'Y'.
   824
   825     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   826
   827     12  WS-BATCH-NO.
   828         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   829         16  FILLER              PIC X(5) VALUE SPACES.
   830
   831     12  WS-FIRST-NAME.
   832         16  WS-1ST-INIT         PIC X.
   833         16  FILLER              PIC X(9).
   834
   835     12  WS-INITIALS.
   836         16  WS-INITIAL-1        PIC X.
   837         16  WS-INITIAL-2        PIC X.
   838
   839     12  WS-C-HDG.
   840         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   841         16  FILLER              PIC X(4) VALUE '-REF'.
   842
   843     12  WS-D-PREM-HDG.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  17
* EL6311.cbl
   844         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   845         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   846
   847     12  WS-D-REFUND-HDG.
   848         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   849         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   850
   851     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   852
   853     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   854     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   855     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   856     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   857     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   858     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   859     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   860
   861     12  WS-01-CANCEL-ERR        PIC X(25)
   862         VALUE 'CANCEL DATE ERROR'.
   863     12  WS-02-CANCEL-ERR        PIC X(25)
   864         VALUE 'CERT NOT FOUND'.
   865     12  WS-04-CANCEL-ERR        PIC X(25)
   866         VALUE 'CANCEL AMOUNT ERROR'.
   867     12  WS-05-CANCEL-ERR        PIC X(25)
   868         VALUE 'CANCEL OPTION ERROR'.
   869     12  WS-06-CANCEL-ERR        PIC X(25)
   870         VALUE 'PREVIOUSLY CANCELLED'.
   871     12  WS-07-CANCEL-ERR        PIC X(25)
   872         VALUE 'INVALID DATA'.
   873     12  WS-08-CANCEL-ERR        PIC X(25)
   874         VALUE 'NO ACCOUNT MASTER'.
   875     12  WS-09-CANCEL-ERR        PIC X(25)
   876         VALUE 'SUFFIX ALREADY EXISTS'.
   877     12  WS-99-CANCEL-ERR        PIC X(25)
   878         VALUE 'MISC CANCEL ERROR'.
   879
   880     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   881     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   882
   883     12  WS-AGE-FIELDS.
   884         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   885         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   886         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   887         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   888
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  18
* EL6311.cbl
   890
   891******************************************************************
   892*                                                                *
   893*                 B A T C H   T O T A L S                        *
   894*                                                                *
   895******************************************************************
   896
   897     12  WS-BATCH-RECORD.
   898         16  FILLER                       PIC X(10).
   899         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   900         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   901         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   902         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   903         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   904         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   905         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   906         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   907         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   908         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   909         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   910         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   911         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   912         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   913         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   914         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   915         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   916         16  WS-ACCOUNT-NAME              PIC X(30).
   917         16  FILLER                       PIC X.
   918         16  WS-REFERENCE                 PIC X(12).
   919         16  FILLER                       PIC X(197).
   920
   921     12  WS-BATCH-TOTALS.
   922         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   923         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   924         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   925         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   926         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   927         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   928         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   929         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   930         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   931         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   932         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   933         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   934         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   935         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   936         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   937         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   938         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   939         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   940         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   941
   942     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   943
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  19
* EL6311.cbl
   945
   946******************************************************************
   947*                                                                *
   948*                E R R O R   M E S S A G E S                     *
   949*                                                                *
   950******************************************************************
   951
   952 01  ERROR-MESSAGES.
   953     12  ER-0004                 PIC  9(4) VALUE 0004.
   954     12  ER-0008                 PIC  9(4) VALUE 0008.
   955     12  ER-0023                 PIC  9(4) VALUE 0023.
   956     12  ER-0029                 PIC  9(4) VALUE 0029.
   957     12  ER-0033                 PIC  9(4) VALUE 0033.
   958     12  ER-0070                 PIC  9(4) VALUE 0070.
   959     12  ER-0220                 PIC  9(4) VALUE 0220.
   960     12  ER-0248                 PIC  9(4) VALUE 0248.
   961     12  ER-0280                 PIC  9(4) VALUE 0280.
   962     12  ER-0348                 PIC  9(4) VALUE 0348.
   963     12  ER-0582                 PIC  9(4) VALUE 0582.
   964     12  ER-0877                 PIC  9(4) VALUE 0877.
   965     12  ER-1236                 PIC  9(4) VALUE 1236.
   966     12  ER-1570                 PIC  9(4) VALUE 1570.
   967     12  ER-1575                 PIC  9(4) VALUE 1575.
   968     12  ER-1609                 PIC  9(4) VALUE 1609.
   969     12  er-1762                 pic  9(4) value 1762.
   970     12  ER-1819                 PIC  9(4) VALUE 1819.
   971     12  ER-2077                 PIC  9(4) VALUE 2077.
   972     12  ER-2129                 PIC  9(4) VALUE 2129.
   973     12  ER-2188                 PIC  9(4) VALUE 2188.
   974     12  ER-2192                 PIC  9(4) VALUE 2192.
   975     12  ER-2196                 PIC  9(4) VALUE 2196.
   976     12  ER-2197                 PIC  9(4) VALUE 2197.
   977     12  ER-2198                 PIC  9(4) VALUE 2198.
   978     12  ER-2200                 PIC  9(4) VALUE 2200.
   979     12  ER-2212                 PIC  9(4) VALUE 2212.
   980     12  ER-2218                 PIC  9(4) VALUE 2218.
   981     12  ER-2220                 PIC  9(4) VALUE 2220.
   982     12  ER-2222                 PIC  9(4) VALUE 2222.
   983     12  ER-2223                 PIC  9(4) VALUE 2223.
   984     12  ER-2224                 PIC  9(4) VALUE 2224.
   985     12  ER-2225                 PIC  9(4) VALUE 2225.
   986     12  ER-2226                 PIC  9(4) VALUE 2226.
   987     12  ER-2227                 PIC  9(4) VALUE 2227.
   988     12  ER-2228                 PIC  9(4) VALUE 2228.
   989     12  ER-2240                 PIC  9(4) VALUE 2240.
   990     12  ER-2241                 PIC  9(4) VALUE 2241.
   991     12  ER-2242                 PIC  9(4) VALUE 2242.
   992     12  ER-2243                 PIC  9(4) VALUE 2243.
   993     12  ER-2244                 PIC  9(4) VALUE 2244.
   994     12  ER-2245                 PIC  9(4) VALUE 2245.
   995     12  ER-2246                 PIC  9(4) VALUE 2246.
   996     12  ER-2247                 PIC  9(4) VALUE 2247.
   997     12  ER-2251                 PIC  9(4) VALUE 2251.
   998     12  ER-2252                 PIC  9(4) VALUE 2252.
   999     12  ER-2253                 PIC  9(4) VALUE 2253.
  1000     12  ER-2254                 PIC  9(4) VALUE 2254.
  1001     12  ER-2255                 PIC  9(4) VALUE 2255.
  1002     12  ER-2256                 PIC  9(4) VALUE 2256.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  20
* EL6311.cbl
  1003     12  ER-2257                 PIC  9(4) VALUE 2257.
  1004     12  ER-2258                 PIC  9(4) VALUE 2258.
  1005     12  ER-2259                 PIC  9(4) VALUE 2259.
  1006     12  ER-2260                 PIC  9(4) VALUE 2260.
  1007     12  ER-2261                 PIC  9(4) VALUE 2261.
  1008     12  ER-2287                 PIC  9(4) VALUE 2287.
  1009     12  ER-2336                 PIC  9(4) VALUE 2336.
  1010     12  ER-2337                 PIC  9(4) VALUE 2337.
  1011     12  ER-2437                 PIC  9(4) VALUE 2437.
  1012     12  ER-2471                 PIC  9(4) VALUE 2471.
  1013     12  ER-2530                 PIC  9(4) VALUE 2530.
  1014     12  ER-2531                 PIC  9(4) VALUE 2531.
  1015     12  ER-2532                 PIC  9(4) VALUE 2532.
  1016     12  ER-2533                 PIC  9(4) VALUE 2533.
  1017     12  ER-2547                 PIC  9(4) VALUE 2547.
  1018     12  ER-2591                 PIC  9(4) VALUE 2591.
  1019     12  ER-2592                 PIC  9(4) VALUE 2592.
  1020     12  ER-2593                 PIC  9(4) VALUE 2593.
  1021     12  ER-2600                 PIC  9(4) VALUE 2600.
  1022     12  ER-2601                 PIC  9(4) VALUE 2601.
  1023     12  ER-2604                 PIC  9(4) VALUE 2604.
  1024     12  ER-2605                 PIC  9(4) VALUE 2605.
  1025     12  ER-2606                 PIC  9(4) VALUE 2606.
  1026     12  ER-2607                 PIC  9(4) VALUE 2607.
  1027     12  ER-2622                 PIC  9(4) VALUE 2622.
  1028     12  ER-2625                 PIC  9(4) VALUE 2625.
  1029     12  ER-2626                 PIC  9(4) VALUE 2626.
  1030     12  ER-2627                 PIC  9(4) VALUE 2627.
  1031     12  ER-2628                 PIC  9(4) VALUE 2628.
  1032     12  ER-2629                 PIC  9(4) VALUE 2629.
  1033     12  ER-2630                 PIC  9(4) VALUE 2630.
  1034     12  ER-2631                 PIC  9(4) VALUE 2631.
  1035     12  ER-2632                 PIC  9(4) VALUE 2632.
  1036     12  ER-2633                 PIC  9(4) VALUE 2633.
  1037     12  ER-2634                 PIC  9(4) VALUE 2634.
  1038     12  ER-2635                 PIC  9(4) VALUE 2635.
  1039     12  ER-2636                 PIC  9(4) VALUE 2636.
  1040     12  ER-2639                 PIC  9(4) VALUE 2639.
  1041     12  ER-2640                 PIC  9(4) VALUE 2640.
  1042     12  ER-2647                 PIC  9(4) VALUE 2647.
  1043     12  ER-2648                 PIC  9(4) VALUE 2648.
  1044     12  ER-2649                 PIC  9(4) VALUE 2649.
  1045     12  ER-2650                 PIC  9(4) VALUE 2650.
  1046     12  ER-2653                 PIC  9(4) VALUE 2653.
  1047     12  ER-2654                 PIC  9(4) VALUE 2654.
  1048     12  ER-2655                 PIC  9(4) VALUE 2655.
  1049     12  ER-2656                 PIC  9(4) VALUE 2656.
  1050     12  ER-2657                 PIC  9(4) VALUE 2657.
  1051     12  ER-2660                 PIC  9(4) VALUE 2660.
  1052     12  ER-2661                 PIC  9(4) VALUE 2661.
  1053     12  ER-2662                 PIC  9(4) VALUE 2662.
  1054     12  ER-2663                 PIC  9(4) VALUE 2663.
  1055     12  ER-2664                 PIC  9(4) VALUE 2664.
  1056     12  ER-2667                 PIC  9(4) VALUE 2667.
  1057     12  ER-2668                 PIC  9(4) VALUE 2668.
  1058     12  ER-2669                 PIC  9(4) VALUE 2669.
  1059     12  ER-2670                 PIC  9(4) VALUE 2670.
  1060     12  ER-2671                 PIC  9(4) VALUE 2671.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  21
* EL6311.cbl
  1061     12  ER-2672                 PIC  9(4) VALUE 2672.
  1062     12  ER-2673                 PIC  9(4) VALUE 2673.
  1063     12  ER-2677                 PIC  9(4) VALUE 2677.
  1064     12  ER-2678                 PIC  9(4) VALUE 2678.
  1065     12  ER-2679                 PIC  9(4) VALUE 2679.
  1066     12  ER-2680                 PIC  9(4) VALUE 2680.
  1067     12  ER-2681                 PIC  9(4) VALUE 2681.
  1068     12  ER-2682                 PIC  9(4) VALUE 2682.
  1069     12  ER-2683                 PIC  9(4) VALUE 2683.
  1070     12  ER-2684                 PIC  9(4) VALUE 2684.
  1071     12  ER-2686                 PIC  9(4) VALUE 2686.
  1072     12  ER-2689                 PIC  9(4) VALUE 2689.
  1073     12  ER-2690                 PIC  9(4) VALUE 2690.
  1074     12  ER-2693                 PIC  9(4) VALUE 2693.
  1075     12  ER-2695                 PIC  9(4) VALUE 2695.
  1076     12  ER-2701                 PIC  9(4) VALUE 2701.
  1077     12  ER-2720                 PIC  9(4) VALUE 2720.
  1078     12  ER-2709                 PIC  9(4) VALUE 2709.
  1079     12  ER-2704                 PIC  9(4) VALUE 2704.
  1080     12  ER-2725                 PIC  9(4) VALUE 2725.
  1081     12  ER-2726                 PIC  9(4) VALUE 2726.
  1082     12  ER-2728                 PIC  9(4) VALUE 2728.
  1083     12  ER-2729                 PIC  9(4) VALUE 2729.
  1084     12  ER-2731                 PIC  9(4) VALUE 2731.
  1085     12  ER-2732                 PIC  9(4) VALUE 2732.
  1086     12  ER-2733                 PIC  9(4) VALUE 2733.
  1087     12  ER-2735                 PIC  9(4) VALUE 2735.
  1088     12  ER-2738                 PIC  9(4) VALUE 2738.
  1089     12  ER-2742                 PIC  9(4) VALUE 2742.
  1090     12  ER-2743                 PIC  9(4) VALUE 2743.
  1091     12  ER-2744                 PIC  9(4) VALUE 2744.
  1092     12  ER-2747                 PIC  9(4) VALUE 2747.
  1093     12  ER-2749                 PIC  9(4) VALUE 2749.
  1094     12  ER-2753                 PIC  9(4) VALUE 2753.
  1095     12  ER-2755                 PIC  9(4) VALUE 2755.
  1096     12  ER-2757                 PIC  9(4) VALUE 2757.
  1097     12  ER-2771                 PIC  9(4) VALUE 2771.
  1098     12  ER-2774                 PIC  9(4) VALUE 2774.
  1099     12  ER-2775                 PIC  9(4) VALUE 2775.
  1100     12  ER-2776                 PIC  9(4) VALUE 2776.
  1101     12  ER-2777                 PIC  9(4) VALUE 2777.
  1102     12  ER-2794                 PIC  9(4) VALUE 2794.
  1103     12  ER-2799                 PIC  9(4) VALUE 2799.
  1104     12  ER-2900                 PIC  9(4) VALUE 2900.
  1105     12  ER-2902                 PIC  9(4) VALUE 2902.
  1106     12  ER-2945                 PIC  9(4) VALUE 2945.
  1107     12  ER-3000                 PIC  9(4) VALUE 3000.
  1108     12  ER-3006                 PIC  9(4) VALUE 3006.
  1109     12  ER-3054                 PIC  9(4) VALUE 3054.
  1110     12  ER-3224                 PIC  9(4) VALUE 3224.
  1111     12  ER-3269                 PIC  9(4) VALUE 3269.
  1112     12  er-3444                 pic  9(4) value 3444.
  1113     12  er-3446                 pic  9(4) value 3446.
  1114     12  er-3447                 pic  9(4) value 3447.
  1115     12  er-3448                 pic  9(4) value 3448.
  1116     12  er-3449                 pic  9(4) value 3449.
  1117     12  ER-3456                 PIC  9(4) VALUE 3456.
  1118     12  ER-3457                 PIC  9(4) VALUE 3457.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  22
* EL6311.cbl
  1119     12  ER-3458                 PIC  9(4) VALUE 3458.
  1120     12  ER-3504                 PIC  9(4) VALUE 3504.
  1121     12  ER-3513                 PIC  9(4) VALUE 3513.
  1122     12  ER-3831                 PIC  9(4) VALUE 3831.
  1123     12  ER-3834                 PIC  9(4) VALUE 3834.
  1124     12  ER-3835                 PIC  9(4) VALUE 3835.
  1125     12  ER-4005                 PIC  9(4) VALUE 4005.
  1126     12  ER-7144                 PIC  9(4) VALUE 7144.
  1127     12  ER-7401                 PIC  9(4) VALUE 7401.
  1128     12  ER-7402                 PIC  9(4) VALUE 7402.
  1129     12  ER-7403                 PIC  9(4) VALUE 7403.
  1130     12  ER-7404                 PIC  9(4) VALUE 7404.
  1131     12  ER-7423                 PIC  9(4) VALUE 7423.
  1132     12  ER-7424                 PIC  9(4) VALUE 7424.
  1133     12  ER-7433                 PIC  9(4) VALUE 7433.
  1134     12  ER-7450                 PIC  9(4) VALUE 7450.
  1135     12  ER-7451                 PIC  9(4) VALUE 7451.
  1136     12  ER-7530                 PIC  9(4) VALUE 7530.
  1137     12  ER-7573                 PIC  9(4) VALUE 7573.
  1138     12  ER-7631                 PIC  9(4) VALUE 7631.
  1139     12  ER-7632                 PIC  9(4) VALUE 7632.
  1140     12  ER-7633                 PIC  9(4) VALUE 7633.
  1141     12  ER-7537                 PIC  9(4) VALUE 7537.
  1142     12  ER-7538                 PIC  9(4) VALUE 7538.
  1143     12  ER-7574                 PIC  9(4) VALUE 7574.
  1144     12  ER-7997                 PIC  9(4) VALUE 7997.
  1145     12  ER-7998                 PIC  9(4) VALUE 7998.
  1146     12  ER-8148                 PIC  9(4) VALUE 8148.
  1147     12  ER-9063                 PIC  9(4) VALUE 9063.
  1148     12  ER-9076                 PIC  9(4) VALUE 9076.
  1149     12  ER-9618                 PIC  9(4) VALUE 9618.
  1150     12  ER-9841                 PIC  9(4) VALUE 9841.
  1151
  1152*                                COPY ELCTEXT.
  1153******************************************************************
  1154*                                                                *
  1155*                                                                *
  1156*                            ELCTEXT.                            *
  1157*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1158*                            VMOD=2.008                          *
  1159*                                                                *
  1160*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1161*                                     FORM LETTERS,              *
  1162*                                     CERT FORM DISPLAY.
  1163*                                                                *
  1164*   FILE TYPE = VSAM,KSDS                                        *
  1165*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1166*                                                                *
  1167*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1168*       ALTERNATE INDEX = NONE                                   *
  1169*                                                                *
  1170*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1171*       ALTERNATE INDEX = NONE                                   *
  1172*                                                                *
  1173*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1174*       ALTERNATE INDEX = NONE                                   *
  1175*                                                                *
  1176*   LOG = NO                                                     *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  23
* EL6311.cbl
  1177*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1178******************************************************************
  1179 01  TEXT-FILES.
  1180     12  TEXT-FILE-ID                PIC XX.
  1181         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1182         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1183         88  HELP-FILE-TEXT             VALUE 'TH'.
  1184
  1185     12  TX-CONTROL-PRIMARY.
  1186         16  TX-COMPANY-CD           PIC X.
  1187             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1188         16  TX-ACCESS-CD-GENL       PIC X(12).
  1189
  1190         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1191             20  TX-LETTER-NO        PIC X(4).
  1192             20  FILLER              PIC X(8).
  1193
  1194         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1195             20  TX-FORM-NO          PIC X(12).
  1196
  1197         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1198             20  TX-HELP-TYPE        PIC X.
  1199                 88  HELP-FOR-GENERAL   VALUE ' '.
  1200                 88  HELP-BY-SCREEN     VALUE 'S'.
  1201                 88  HELP-BY-ERROR      VALUE 'E'.
  1202             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1203                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1204             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1205                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1206             20  FILLER              PIC X(4).
  1207
  1208         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1209
  1210     12  TX-PROCESS-CONTROL          PIC XX.
  1211         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1212
  1213     12  TX-TEXT-LINE                PIC X(70).
  1214
  1215     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1216         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1217         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1218         88  TX-VALID-FORM-SQUEEZE-VALUE
  1219                                        VALUE 'Y' ' '.
  1220
  1221     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1222         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1223         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1224         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1225         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1226         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1227         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1228         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1229                                              'K' 'N' ' '
  1230                                              'Z'.
  1231
  1232     12  TX-ARCHIVE-SW               PIC X.
  1233         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1234         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  24
* EL6311.cbl
  1235         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1236
  1237     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1238     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1239
  1240     12  TX-BSR-CODE                 PIC X.
  1241         88  TX-BSR-LETTER              VALUE 'B'.
  1242         88  TX-NON-BSR-LETTER          VALUE ' '.
  1243
  1244     12  FILLER                      PIC X.
  1245*****************************************************************
  1246*                                COPY ELCCRTO.
  1247******************************************************************
  1248*                                                                *
  1249*                            ELCCRTO.                            *
  1250*                                                                *
  1251*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1252*                                                                *
  1253*   FILE TYPE = VSAM,KSDS                                        *
  1254*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1255*                                                                *
  1256*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1257*                                                                *
  1258*   LOG = YES                                                    *
  1259*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1260******************************************************************
  1261*                   C H A N G E   L O G
  1262*
  1263* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1264*-----------------------------------------------------------------
  1265*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1266* EFFECTIVE    NUMBER
  1267*-----------------------------------------------------------------
  1268* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1269* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1270* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1271* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1272* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1273******************************************************************
  1274 01  ORIGINAL-CERTIFICATE.
  1275     12  OC-RECORD-ID                      PIC XX.
  1276         88  VALID-OC-ID                      VALUE 'OC'.
  1277     12  OC-CONTROL-PRIMARY.
  1278         16  OC-COMPANY-CD                 PIC X.
  1279         16  OC-CARRIER                    PIC X.
  1280         16  OC-GROUPING                   PIC X(6).
  1281         16  OC-STATE                      PIC XX.
  1282         16  OC-ACCOUNT                    PIC X(10).
  1283         16  OC-CERT-EFF-DT                PIC XX.
  1284         16  OC-CERT-NO.
  1285             20  OC-CERT-PRIME             PIC X(10).
  1286             20  OC-CERT-SFX               PIC X.
  1287         16  OC-RECORD-TYPE                PIC X.
  1288         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1289     12  OC-LAST-MAINT-DT                  PIC XX.
  1290     12  OC-LAST-MAINT-BY                  PIC X(4).
  1291     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1292     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  25
* EL6311.cbl
  1293     12  FILLER                            PIC X(49).
  1294     12  OC-ORIG-REC.
  1295         16  OC-INS-LAST-NAME              PIC X(15).
  1296         16  OC-INS-FIRST-NAME             PIC X(10).
  1297         16  OC-INS-MIDDLE-INIT            PIC X.
  1298         16  OC-INS-AGE                    PIC S999     COMP-3.
  1299         16  OC-JNT-LAST-NAME              PIC X(15).
  1300         16  OC-JNT-FIRST-NAME             PIC X(10).
  1301         16  OC-JNT-MIDDLE-INIT            PIC X.
  1302         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1303         16  OC-LF-BENCD                   PIC XX.
  1304         16  OC-LF-TERM                    PIC S999      COMP-3.
  1305         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1306         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1307         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1308         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1309         16  OC-LF-EXP-DT                  PIC XX.
  1310         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1311         16  OC-LF-CANCEL-DT               PIC XX.
  1312         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1313         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1314         16  OC-AH-BENCD                   PIC XX.
  1315         16  OC-AH-TERM                    PIC S999      COMP-3.
  1316         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1317         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1318         16  OC-AH-EXP-DT                  PIC XX.
  1319         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1320         16  OC-AH-CP                      PIC 99.
  1321         16  OC-AH-CANCEL-DT               PIC XX.
  1322         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1323         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1324         16  OC-CRED-BENE-NAME             PIC X(25).
  1325         16  OC-1ST-PMT-DT                 PIC XX.
  1326         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1327         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1328         16  OC-ISSUE-TRAN-IND             PIC X.
  1329         16  OC-CANCEL-TRAN-IND            PIC X.
  1330         16  FILLER                        PIC X(211).
  1331
  1332     12  FILLER                            PIC X(50).
  1333******************************************************************
  1334*                                COPY ERCACCT.
  1335******************************************************************
  1336*                                                                *
  1337*                                                                *
  1338*                            ERCACCT                             *
  1339*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1340*                            VMOD=2.031                          *
  1341*                                                                *
  1342*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1343*                                                                *
  1344*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1345*   VSAM ACCOUNT MASTER FILES.                                   *
  1346*                                                                *
  1347*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1348*                                                                *
  1349*   FILE TYPE = VSAM,KSDS                                        *
  1350*   RECORD SIZE = 2000  RECFORM = FIX                            *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  26
* EL6311.cbl
  1351*                                                                *
  1352*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1353*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1354*                                                                *
  1355*   LOG = NO                                                     *
  1356*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1357*                                                                *
  1358*                                                                *
  1359******************************************************************
  1360*                   C H A N G E   L O G
  1361*
  1362* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1363*-----------------------------------------------------------------
  1364*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1365* EFFECTIVE    NUMBER
  1366*-----------------------------------------------------------------
  1367* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1368* 092705    2005050300006  PEMA  ADD SPP LEASES
  1369* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1370* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1371* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1372* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1373* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1374* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1375******************************************************************
  1376
  1377 01  ACCOUNT-MASTER.
  1378     12  AM-RECORD-ID                      PIC XX.
  1379         88  VALID-AM-ID                      VALUE 'AM'.
  1380
  1381     12  AM-CONTROL-PRIMARY.
  1382         16  AM-COMPANY-CD                 PIC X.
  1383         16  AM-MSTR-CNTRL.
  1384             20  AM-CONTROL-A.
  1385                 24  AM-CARRIER            PIC X.
  1386                 24  AM-GROUPING.
  1387                     28 AM-GROUPING-PREFIX PIC XXX.
  1388                     28 AM-GROUPING-PRIME  PIC XXX.
  1389                 24  AM-STATE              PIC XX.
  1390                 24  AM-ACCOUNT.
  1391                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1392                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1393             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1394                                           PIC X(19).
  1395             20  AM-CNTRL-B.
  1396                 24  AM-EXPIRATION-DT      PIC XX.
  1397                 24  FILLER                PIC X(4).
  1398             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1399                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1400
  1401     12  AM-CONTROL-BY-VAR-GRP.
  1402         16  AM-COMPANY-CD-A1              PIC X.
  1403         16  AM-VG-CARRIER                 PIC X.
  1404         16  AM-VG-GROUPING                PIC X(6).
  1405         16  AM-VG-STATE                   PIC XX.
  1406         16  AM-VG-ACCOUNT                 PIC X(10).
  1407         16  AM-VG-DATE.
  1408             20  AM-VG-EXPIRATION-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  27
* EL6311.cbl
  1409             20  FILLER                    PIC X(4).
  1410         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1411                                           PIC 9(11)      COMP-3.
  1412     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1413         16  FILLER                        PIC X(10).
  1414         16  AM-VG-KEY3.
  1415             20  AM-VG3-ACCOUNT            PIC X(10).
  1416             20  AM-VG3-EXP-DT             PIC XX.
  1417         16  FILLER                        PIC X(4).
  1418     12  AM-MAINT-INFORMATION.
  1419         16  AM-LAST-MAINT-DT              PIC XX.
  1420         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1421         16  AM-LAST-MAINT-USER            PIC X(4).
  1422         16  FILLER                        PIC XX.
  1423
  1424     12  AM-EFFECTIVE-DT                   PIC XX.
  1425     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1426
  1427     12  AM-PREV-DATES  COMP-3.
  1428         16  AM-PREV-EXP-DT                PIC 9(11).
  1429         16  AM-PREV-EFF-DT                PIC 9(11).
  1430
  1431     12  AM-REPORT-CODE-1                  PIC X(10).
  1432     12  AM-REPORT-CODE-2                  PIC X(10).
  1433
  1434     12  AM-CITY-CODE                      PIC X(4).
  1435     12  AM-COUNTY-PARISH                  PIC X(6).
  1436
  1437     12  AM-NAME                           PIC X(30).
  1438     12  AM-PERSON                         PIC X(30).
  1439     12  AM-ADDRS                          PIC X(30).
  1440     12  AM-CITY.
  1441         16  AM-ADDR-CITY                  PIC X(28).
  1442         16  AM-ADDR-STATE                 PIC XX.
  1443     12  AM-ZIP.
  1444         16  AM-ZIP-PRIME.
  1445             20  AM-ZIP-PRI-1ST            PIC X.
  1446                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1447             20  FILLER                    PIC X(4).
  1448         16  AM-ZIP-PLUS4                  PIC X(4).
  1449     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1450         16  AM-CAN-POSTAL-1               PIC XXX.
  1451         16  AM-CAN-POSTAL-2               PIC XXX.
  1452         16  FILLER                        PIC XXX.
  1453     12  AM-TEL-NO.
  1454         16  AM-AREA-CODE                  PIC 999.
  1455         16  AM-TEL-PRE                    PIC 999.
  1456         16  AM-TEL-NBR                    PIC 9(4).
  1457     12  AM-TEL-LOC                        PIC X.
  1458         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1459         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1460
  1461     12  AM-COMM-STRUCTURE.
  1462         16  AM-DEFN-1.
  1463             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1464                 24  AM-AGT.
  1465                     28  AM-AGT-PREFIX     PIC X(4).
  1466                     28  AM-AGT-PRIME      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  28
* EL6311.cbl
  1467                 24  AM-COM-TYP            PIC X.
  1468                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1469                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1470                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1471                 24  AM-RECALC-LV-INDIC    PIC X.
  1472                 24  AM-RETRO-LV-INDIC     PIC X.
  1473                 24  AM-GL-CODES           PIC X.
  1474                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1475                 24  FILLER                PIC X(01).
  1476         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1477             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1478                 24  FILLER                PIC X(11).
  1479                 24  AM-L-COMA             PIC XXX.
  1480                 24  AM-J-COMA             PIC XXX.
  1481                 24  AM-A-COMA             PIC XXX.
  1482                 24  FILLER                PIC X(6).
  1483
  1484     12  AM-COMM-CHANGE-STATUS             PIC X.
  1485         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1486
  1487     12  AM-CSR-CODE                       PIC X(4).
  1488
  1489     12  AM-BILLING-STATUS                 PIC X.
  1490         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1491         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1492     12  AM-AUTO-REFUND-SW                 PIC X.
  1493         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1494         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1495     12  AM-GPCD                           PIC 99.
  1496     12  AM-IG                             PIC X.
  1497         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1498         88  AM-HAS-GROUP                     VALUE '2'.
  1499     12  AM-STATUS                         PIC X.
  1500         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1501         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1502         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1503         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1504         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1505         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1506         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1507         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1508         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1509         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1510     12  AM-REMIT-TO                       PIC 99.
  1511     12  AM-ID-NO                          PIC X(11).
  1512
  1513     12  AM-CAL-TABLE                      PIC XX.
  1514     12  AM-LF-DEVIATION                   PIC XXX.
  1515     12  AM-AH-DEVIATION                   PIC XXX.
  1516     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1517     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1518     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1519     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1520     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1521     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1522
  1523     12  AM-USER-FIELDS.
  1524         16  AM-FLD-1                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  29
* EL6311.cbl
  1525         16  AM-FLD-2                      PIC XX.
  1526         16  AM-FLD-3                      PIC XX.
  1527         16  AM-FLD-4                      PIC XX.
  1528         16  AM-FLD-5                      PIC XX.
  1529
  1530     12  AM-1ST-PROD-DATE.
  1531         16  AM-1ST-PROD-YR                PIC XX.
  1532         16  AM-1ST-PROD-MO                PIC XX.
  1533         16  AM-1ST-PROD-DA                PIC XX.
  1534     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1535     12  AM-CERTS-PURGED-DATE.
  1536         16  AM-PUR-YR                     PIC XX.
  1537         16  AM-PUR-MO                     PIC XX.
  1538         16  AM-PUR-DA                     PIC XX.
  1539     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1540     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1541     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1542     12  AM-INACTIVE-DATE.
  1543         16  AM-INA-MO                     PIC 99.
  1544         16  AM-INA-DA                     PIC 99.
  1545         16  AM-INA-YR                     PIC 99.
  1546     12  AM-AR-HI-CERT-DATE                PIC XX.
  1547
  1548     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1549     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1550
  1551     12  AM-OB-PAYMENT-MODE                PIC X.
  1552         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1553         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1554         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1555         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1556
  1557     12  AM-AH-ONLY-INDICATOR              PIC X.
  1558         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1559         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1560
  1561     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1562
  1563     12  AM-OVER-SHORT.
  1564         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1565         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1566
  1567     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1568     12  AM-DCC-CLP-STATE                  PIC XX.
  1569
  1570     12  AM-RECALC-COMM                    PIC X.
  1571     12  AM-RECALC-REIN                    PIC X.
  1572
  1573     12  AM-REI-TABLE                      PIC XXX.
  1574     12  AM-REI-ET-LF                      PIC X.
  1575     12  AM-REI-ET-AH                      PIC X.
  1576     12  AM-REI-PE-LF                      PIC X.
  1577     12  AM-REI-PE-AH                      PIC X.
  1578     12  AM-REI-PRT-ST                     PIC X.
  1579     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1580     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1581     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1582     12  AM-REI-GROUP-A                    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  30
* EL6311.cbl
  1583     12  AM-REI-MORT                       PIC X(4).
  1584     12  AM-REI-PRT-OW                     PIC X.
  1585     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1586     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1587     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1588     12  AM-REI-GROUP-B                    PIC X(6).
  1589
  1590     12  AM-TRUST-TYPE                     PIC X(2).
  1591
  1592     12  AM-EMPLOYER-STMT-USED             PIC X.
  1593     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1594
  1595     12  AM-STD-AH-TYPE                    PIC XX.
  1596     12  AM-EARN-METHODS.
  1597         16  AM-EARN-METHOD-R              PIC X.
  1598             88 AM-REF-RL-R78                 VALUE 'R'.
  1599             88 AM-REF-RL-PR                  VALUE 'P'.
  1600             88 AM-REF-RL-MEAN                VALUE 'M'.
  1601             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1602         16  AM-EARN-METHOD-L              PIC X.
  1603             88 AM-REF-LL-R78                 VALUE 'R'.
  1604             88 AM-REF-LL-PR                  VALUE 'P'.
  1605             88 AM-REF-LL-MEAN                VALUE 'M'.
  1606             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1607         16  AM-EARN-METHOD-A              PIC X.
  1608             88 AM-REF-AH-R78                 VALUE 'R'.
  1609             88 AM-REF-AH-PR                  VALUE 'P'.
  1610             88 AM-REF-AH-MEAN                VALUE 'M'.
  1611             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1612             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1613             88 AM-REF-AH-NET                 VALUE 'N'.
  1614
  1615     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1616     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1617     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1618
  1619     12  AM-RET-Y-N                        PIC X.
  1620     12  AM-RET-P-E                        PIC X.
  1621     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1622     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1623     12  AM-RET-GRP                        PIC X(6).
  1624     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1625         16  AM-POOL-PRIME                 PIC XXX.
  1626         16  AM-POOL-SUB                   PIC XXX.
  1627     12  AM-RETRO-EARNINGS.
  1628         16  AM-RET-EARN-R                 PIC X.
  1629         16  AM-RET-EARN-L                 PIC X.
  1630         16  AM-RET-EARN-A                 PIC X.
  1631     12  AM-RET-ST-TAX-USE                 PIC X.
  1632         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1633         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1634     12  AM-RETRO-BEG-EARNINGS.
  1635         16  AM-RET-BEG-EARN-R             PIC X.
  1636         16  AM-RET-BEG-EARN-L             PIC X.
  1637         16  AM-RET-BEG-EARN-A             PIC X.
  1638     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1639     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1640
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  31
* EL6311.cbl
  1641     12  AM-USER-SELECT-OPTIONS.
  1642         16  AM-USER-SELECT-1              PIC X(10).
  1643         16  AM-USER-SELECT-2              PIC X(10).
  1644         16  AM-USER-SELECT-3              PIC X(10).
  1645         16  AM-USER-SELECT-4              PIC X(10).
  1646         16  AM-USER-SELECT-5              PIC X(10).
  1647
  1648     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1649
  1650     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1651
  1652     12  AM-RPT045A-SWITCH                 PIC X.
  1653         88  RPT045A-OFF                   VALUE 'N'.
  1654
  1655     12  AM-INSURANCE-LIMITS.
  1656         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1657         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1658
  1659     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1660         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1661
  1662     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1663         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1664         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1665
  1666     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1667
  1668     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1669     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1670     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1671     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1672     12  AM-DCC-UEF-STATE                  PIC XX.
  1673     12  FILLER                            PIC XXX.
  1674     12  AM-REPORT-CODE-3                  PIC X(10).
  1675*    12  FILLER                            PIC X(22).
  1676
  1677     12  AM-RESERVE-DATE.
  1678         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1679         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1680         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1681
  1682     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1683     12  AM-NOTIFICATION-TYPES.
  1684         16  AM-NOTIF-OF-LETTERS           PIC X.
  1685         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1686         16  AM-NOTIF-OF-REPORTS           PIC X.
  1687         16  AM-NOTIF-OF-STATUS            PIC X.
  1688
  1689     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1690         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1691         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1692         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1693         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1694
  1695     12  AM-BENEFIT-CONTROLS.
  1696         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1697             20  AM-BENEFIT-CODE           PIC XX.
  1698             20  AM-BENEFIT-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  32
* EL6311.cbl
  1699             20  AM-BENEFIT-REVISION       PIC XXX.
  1700             20  AM-BENEFIT-REM-TERM       PIC X.
  1701             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1702             20  FILLER                    PIC XX.
  1703         16  FILLER                        PIC X(80).
  1704
  1705     12  AM-TRANSFER-DATA.
  1706         16  AM-TRANSFERRED-FROM.
  1707             20  AM-TRNFROM-CARRIER        PIC X.
  1708             20  AM-TRNFROM-GROUPING.
  1709                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1710                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1711             20  AM-TRNFROM-STATE          PIC XX.
  1712             20  AM-TRNFROM-ACCOUNT.
  1713                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1714                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1715             20  AM-TRNFROM-DTE            PIC XX.
  1716         16  AM-TRANSFERRED-TO.
  1717             20  AM-TRNTO-CARRIER          PIC X.
  1718             20  AM-TRNTO-GROUPING.
  1719                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1720                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1721             20  AM-TRNTO-STATE            PIC XX.
  1722             20  AM-TRNTO-ACCOUNT.
  1723                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1724                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1725             20  AM-TRNTO-DTE              PIC XX.
  1726         16  FILLER                        PIC X(10).
  1727
  1728     12  AM-SAVED-REMIT-TO                 PIC 99.
  1729
  1730     12  AM-COMM-STRUCTURE-SAVED.
  1731         16  AM-DEFN-1-SAVED.
  1732             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1733                 24  AM-AGT-SV             PIC X(10).
  1734                 24  AM-COM-TYP-SV         PIC X.
  1735                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1736                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1737                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1738                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1739                 24  FILLER                PIC X.
  1740                 24  AM-GL-CODES-SV        PIC X.
  1741                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1742                 24  FILLER                PIC X.
  1743         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1744             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1745                 24  FILLER                PIC X(11).
  1746                 24  AM-L-COMA-SV          PIC XXX.
  1747                 24  AM-J-COMA-SV          PIC XXX.
  1748                 24  AM-A-COMA-SV          PIC XXX.
  1749                 24  FILLER                PIC X(6).
  1750
  1751     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1752         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1753            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1754            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1755            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1756
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  33
* EL6311.cbl
  1757     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1758     12  FILLER                            PIC X(120).
  1759
  1760     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1761         16  AM-CONTROL-NAME               PIC X(30).
  1762         16  AM-EXECUTIVE-ONE.
  1763             20  AM-EXEC1-NAME             PIC X(15).
  1764             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1765                                                          COMP-3.
  1766             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1767                                                          COMP-3.
  1768         16  AM-EXECUTIVE-TWO.
  1769             20  AM-EXEC2-NAME             PIC X(15).
  1770             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1771                                                          COMP-3.
  1772             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1773                                                          COMP-3.
  1774
  1775     12  AM-RETRO-ADDITIONAL-DATA.
  1776         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1777         16  AM-RETRO-PREM-P-E             PIC X.
  1778         16  AM-RETRO-CLMS-P-I             PIC X.
  1779         16  AM-RETRO-RET-BRACKET-LF.
  1780             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1781                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1782                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1783             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1784                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1785                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1786             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1787                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1788                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1789         16  AM-RETRO-RET-BRACKET-AH.
  1790             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1791                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1792                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1793                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1794             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1795                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1796                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1797             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1798                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1799                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1800
  1801     12  AM-COMMENTS.
  1802         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1803
  1804     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1805         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1806         16  AM-FLI-BILLING-CODE           PIC X.
  1807         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1808         16  AM-FLI-UNITED-IDENT           PIC X.
  1809         16  AM-FLI-INTEREST-LOST-DATA.
  1810             20  AM-FLI-BANK-NO            PIC X(5).
  1811             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1812             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1813             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1814         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  34
* EL6311.cbl
  1815             20  AM-FLI-AGT                PIC X(9).
  1816             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1817             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1818         16  FILLER                        PIC X(102).
  1819
  1820     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1821         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1822             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1823             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1824             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1825             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1826             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1827         16  FILLER                          PIC X(10).
  1828******************************************************************
  1829*                                copy ERCACNT.
  1830******************************************************************
  1831*                                                                *
  1832*                                                                *
  1833*                            ERCACNT.                            *
  1834*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1835*                            VMOD=2.002                          *
  1836*                                                                *
  1837*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1838*                                                                *
  1839*   FILE TYPE = VSAM,KSDS                                        *
  1840*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1841*                                                                *
  1842*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1843*       ALTERNATE INDEX = NONE                                   *
  1844*                                                                *
  1845*                                                                *
  1846*   LOG = YES                                                    *
  1847*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1848******************************************************************
  1849*                   C H A N G E   L O G
  1850*
  1851* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1852*-----------------------------------------------------------------
  1853*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1854* EFFECTIVE    NUMBER
  1855*-----------------------------------------------------------------
  1856* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1857*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1858******************************************************************
  1859 01  NOTE-FILE.
  1860     12  NT-FILE-ID                  PIC XX.
  1861         88  VALID-NOTE-ID              VALUE 'NT'.
  1862
  1863     12  NT-CONTROL-PRIMARY.
  1864         16  NT-COMPANY-CD           PIC X.
  1865         16  NT-ACCT-NOTE-KEY.
  1866             18  NT-CARRIER              PIC X.
  1867             18  NT-GROUPING             PIC X(06).
  1868             18  NT-STATE                PIC XX.
  1869             18  NT-ACCOUNT              PIC X(10).
  1870         16  NT-RECORD-TYPE          PIC X.
  1871              88  ACCT-NOTE          VALUE '1'.
  1872              88  ACCT-BRANCH-LOC    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  35
* EL6311.cbl
  1873              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1874         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1875
  1876     12  NT-LAST-MAINT-DT            PIC XX.
  1877     12  NT-LAST-MAINT-BY            PIC X(4).
  1878     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1879
  1880*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1881*     SEQUENCE NUMBERS
  1882     12  NT-NOTE-INFORMATION.
  1883         16  NT-NOTE-LINE            PIC X(60).
  1884         16  FILLER                  PIC X(25).
  1885*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1886     12  NT-LOCATION-INFORMATION REDEFINES
  1887                         NT-NOTE-INFORMATION.
  1888         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1889         16  FILLER                  PIC X(25).
  1890* Account special indicator is record type '2', sequence 3
  1891     12  filler REDEFINES NT-NOTE-INFORMATION.
  1892         16  nt-account-special      PIC X.
  1893         16  FILLER                  PIC X(84).
  1894*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1895*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1896*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1897*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1898*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1899*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1900*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1901     12  NT-SHIPPING-INFORMATION REDEFINES
  1902                         NT-NOTE-INFORMATION.
  1903         16  NT-SHIPPING-LINE        PIC X(60).
  1904         16  NT-SHIP-STATE           PIC XX.
  1905         16  NT-SHIP-ZIP             PIC X(10).
  1906         16  FILLER                  PIC X(13).
  1907*****************************************************************
  1908*                                COPY ELCVADS.
  1909******************************************************************
  1910*                                                                *
  1911*                                                                *
  1912*                            ELCVADS.                            *
  1913*                                                                *
  1914*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1915*   ELVADS                  LENGTH = 350                         *
  1916******************************************************************
  1917******************************************************************
  1918*                   C H A N G E   L O G
  1919*
  1920* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1921*-----------------------------------------------------------------
  1922*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1923* EFFECTIVE    NUMBER
  1924*-----------------------------------------------------------------
  1925* 100111    2011022800001  AJRA  NAPERSOFT
  1926******************************************************************
  1927
  1928 01  VIRGINIA-DISCLOSURE.
  1929     12  VD-COMPANY-CD              PIC X.
  1930     12  VD-CARRIER                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  36
* EL6311.cbl
  1931     12  VD-GROUPING.
  1932         20  VD-GROUPING-PREFIX     PIC XXX.
  1933         20  VD-GROUPING-PRIME      PIC XXX.
  1934     12  VD-STATE                   PIC XX.
  1935     12  VD-ACCOUNT.
  1936         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1937         20  VD-ACCOUNT-PRIME       PIC X(6).
  1938     12  VD-CERT-EFF-DT             PIC XX.
  1939     12  VD-CERT-NO.
  1940         20  VD-CERT-PRIME          PIC X(10).
  1941         20  VD-CERT-SFX            PIC X.
  1942     12  VD-ENTRY-BATCH             PIC X(6).
  1943     12  VD-CSR-ID                  PIC X(4).
  1944     12  VD-NAME.
  1945         20  VD-INSURED-LAST-NAME   PIC X(15).
  1946         20  VD-INSURED-FIRST-NAME.
  1947             24  VD-INSURED-1ST-INIT PIC X.
  1948             24  FILLER             PIC X(9).
  1949         20  VD-INSURED-MIDDLE-INIT PIC X.
  1950     12  VD-JOINT-INSURED.
  1951         20 VD-JOINT-LAST-NAME      PIC X(15).
  1952         20 VD-JOINT-FIRST-NAME.
  1953            24  VD-JOINT-FIRST-INIT PIC X.
  1954            24  FILLER              PIC X(9).
  1955         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1956     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1957     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1958     12  VD-INSURED-CITY-STATE.
  1959         20  VD-INSURED-CITY        PIC X(28).
  1960         20  VD-INSURED-STATE       PIC XX.
  1961     12  VD-INSURED-ZIP-CODE.
  1962         20  VD-INSURED-ZIP-PRIME.
  1963             24  VD-INSURED-ZIP-1   PIC X.
  1964                 88  VD-CANADIAN-POST-CODE
  1965                                       VALUE 'A' THRU 'Z'.
  1966             24  FILLER             PIC X(4).
  1967         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1968     12  VD-BENEFICIARY-NAME        PIC X(30).
  1969     12  VD-ACCOUNT-NAME            PIC X(30).
  1970     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1971     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1972     12  VD-1ST-PMT-DT              PIC XX.
  1973     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1974         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1975         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1976                                             '90' THRU '99'.
  1977     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1978                                    PIC XX.
  1979     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1980     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1981     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1982     12  VD-LF-TERM                 PIC S999   COMP-3.
  1983     12  VD-AH-BENEFIT-CD           PIC XX.
  1984         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1985         88  VD-INVALID-AH             VALUE '  ' '00'
  1986                                             '90' THRU '99'.
  1987     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1988     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  37
* EL6311.cbl
  1989     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1990     12  VD-AH-TERM                 PIC S999   COMP-3.
  1991     12  VD-LETTER-ID               PIC X(4).
  1992     12  VD-PROC-ID                 PIC X(4).
  1993     12  VD-COMP-ID                 PIC X(3).
  1994     12  VD-CURRENT-DATE            PIC XX.
  1995     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1996     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1997     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  38
* EL6311.cbl
  1999*    COPY ELCDATE.
  2000******************************************************************
  2001*                                                                *
  2002*                                                                *
  2003*                            ELCDATE.                            *
  2004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2005*                            VMOD=2.003
  2006*                                                                *
  2007*                                                                *
  2008*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2009*                 LENGTH = 200                                   *
  2010******************************************************************
  2011
  2012 01  DATE-CONVERSION-DATA.
  2013     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2014     12  DC-OPTION-CODE                PIC X.
  2015         88  BIN-TO-GREG                VALUE ' '.
  2016         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2017         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2018         88  YMD-GREG-TO-BIN            VALUE '3'.
  2019         88  MDY-GREG-TO-BIN            VALUE '4'.
  2020         88  JULIAN-TO-BIN              VALUE '5'.
  2021         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2022         88  FIND-CENTURY               VALUE '7'.
  2023         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2024         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2025         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2026         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2027         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2028         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2029         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2030         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2031         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2032         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2033         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2034         88  BIN-3-TO-GREG              VALUE 'I'.
  2035         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2036         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2037         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2038         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2039         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2040         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2041         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2042         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2043         88  THREE-CHARACTER-BIN
  2044                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2045         88  GREGORIAN-TO-BIN
  2046                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2047         88  BIN-TO-GREGORIAN
  2048                  VALUES ' ' '1' 'I' '8' 'G'.
  2049         88  JULIAN-TO-BINARY
  2050                  VALUES '5' 'C' 'E' 'F'.
  2051     12  DC-ERROR-CODE                 PIC X.
  2052         88  NO-CONVERSION-ERROR        VALUE ' '.
  2053         88  DATE-CONVERSION-ERROR
  2054                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2055         88  DATE-IS-ZERO               VALUE '1'.
  2056         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  39
* EL6311.cbl
  2057         88  DATE-IS-INVALID            VALUE '3'.
  2058         88  DATE1-GREATER-DATE2        VALUE '4'.
  2059         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2060         88  DATE-INVALID-OPTION        VALUE '9'.
  2061         88  INVALID-CENTURY            VALUE 'A'.
  2062         88  ONLY-CENTURY               VALUE 'B'.
  2063         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2064         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2065     12  DC-END-OF-MONTH               PIC X.
  2066         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2067     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2068         88  USE-NORMAL-PROCESS         VALUE ' '.
  2069         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2070         88  ADJUST-UP-100-YRS          VALUE '2'.
  2071     12  FILLER                        PIC X.
  2072     12  DC-CONVERSION-DATES.
  2073         16  DC-BIN-DATE-1             PIC XX.
  2074         16  DC-BIN-DATE-2             PIC XX.
  2075         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2076         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2077                       DC-GREG-DATE-1-EDIT.
  2078             20  DC-EDIT1-MONTH        PIC 99.
  2079             20  SLASH1-1              PIC X.
  2080             20  DC-EDIT1-DAY          PIC 99.
  2081             20  SLASH1-2              PIC X.
  2082             20  DC-EDIT1-YEAR         PIC 99.
  2083         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2084         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2085                     DC-GREG-DATE-2-EDIT.
  2086             20  DC-EDIT2-MONTH        PIC 99.
  2087             20  SLASH2-1              PIC X.
  2088             20  DC-EDIT2-DAY          PIC 99.
  2089             20  SLASH2-2              PIC X.
  2090             20  DC-EDIT2-YEAR         PIC 99.
  2091         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2092         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2093                     DC-GREG-DATE-1-YMD.
  2094             20  DC-YMD-YEAR           PIC 99.
  2095             20  DC-YMD-MONTH          PIC 99.
  2096             20  DC-YMD-DAY            PIC 99.
  2097         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2098         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2099                      DC-GREG-DATE-1-MDY.
  2100             20  DC-MDY-MONTH          PIC 99.
  2101             20  DC-MDY-DAY            PIC 99.
  2102             20  DC-MDY-YEAR           PIC 99.
  2103         16  DC-GREG-DATE-1-ALPHA.
  2104             20  DC-ALPHA-MONTH        PIC X(10).
  2105             20  DC-ALPHA-DAY          PIC 99.
  2106             20  FILLER                PIC XX.
  2107             20  DC-ALPHA-CENTURY.
  2108                 24 DC-ALPHA-CEN-N     PIC 99.
  2109             20  DC-ALPHA-YEAR         PIC 99.
  2110         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2111         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2112         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2113         16  DC-JULIAN-DATE            PIC 9(05).
  2114         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  40
* EL6311.cbl
  2115                                       PIC 9(05).
  2116         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2117             20  DC-JULIAN-YEAR        PIC 99.
  2118             20  DC-JULIAN-DAYS        PIC 999.
  2119         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2120         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2121         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2122     12  DATE-CONVERSION-VARIBLES.
  2123         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2124         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2125             20  FILLER                PIC 9(3).
  2126             20  HOLD-CEN-1-CCYY.
  2127                 24  HOLD-CEN-1-CC     PIC 99.
  2128                 24  HOLD-CEN-1-YY     PIC 99.
  2129             20  HOLD-CEN-1-MO         PIC 99.
  2130             20  HOLD-CEN-1-DA         PIC 99.
  2131         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2132             20  HOLD-CEN-1-R-MO       PIC 99.
  2133             20  HOLD-CEN-1-R-DA       PIC 99.
  2134             20  HOLD-CEN-1-R-CCYY.
  2135                 24  HOLD-CEN-1-R-CC   PIC 99.
  2136                 24  HOLD-CEN-1-R-YY   PIC 99.
  2137             20  FILLER                PIC 9(3).
  2138         16  HOLD-CENTURY-1-X.
  2139             20  FILLER                PIC X(3)  VALUE SPACES.
  2140             20  HOLD-CEN-1-X-CCYY.
  2141                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2142                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2143             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2144             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2145         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2146             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2147             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2148             20  HOLD-CEN-1-R-X-CCYY.
  2149                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2150                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2151             20  FILLER                PIC XXX.
  2152         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2153         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2154         16  DC-JULIAN-DATE-1          PIC 9(07).
  2155         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2156             20  DC-JULIAN-1-CCYY.
  2157                 24  DC-JULIAN-1-CC    PIC 99.
  2158                 24  DC-JULIAN-1-YR    PIC 99.
  2159             20  DC-JULIAN-DA-1        PIC 999.
  2160         16  DC-JULIAN-DATE-2          PIC 9(07).
  2161         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2162             20  DC-JULIAN-2-CCYY.
  2163                 24  DC-JULIAN-2-CC    PIC 99.
  2164                 24  DC-JULIAN-2-YR    PIC 99.
  2165             20  DC-JULIAN-DA-2        PIC 999.
  2166         16  DC-GREG-DATE-A-EDIT.
  2167             20  DC-EDITA-MONTH        PIC 99.
  2168             20  SLASHA-1              PIC X VALUE '/'.
  2169             20  DC-EDITA-DAY          PIC 99.
  2170             20  SLASHA-2              PIC X VALUE '/'.
  2171             20  DC-EDITA-CCYY.
  2172                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  41
* EL6311.cbl
  2173                 24  DC-EDITA-YEAR     PIC 99.
  2174         16  DC-GREG-DATE-B-EDIT.
  2175             20  DC-EDITB-MONTH        PIC 99.
  2176             20  SLASHB-1              PIC X VALUE '/'.
  2177             20  DC-EDITB-DAY          PIC 99.
  2178             20  SLASHB-2              PIC X VALUE '/'.
  2179             20  DC-EDITB-CCYY.
  2180                 24  DC-EDITB-CENT     PIC 99.
  2181                 24  DC-EDITB-YEAR     PIC 99.
  2182         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2183         16  DC-GREG-DATE-CYMD-R REDEFINES
  2184                              DC-GREG-DATE-CYMD.
  2185             20  DC-CYMD-CEN           PIC 99.
  2186             20  DC-CYMD-YEAR          PIC 99.
  2187             20  DC-CYMD-MONTH         PIC 99.
  2188             20  DC-CYMD-DAY           PIC 99.
  2189         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2190         16  DC-GREG-DATE-MDCY-R REDEFINES
  2191                              DC-GREG-DATE-MDCY.
  2192             20  DC-MDCY-MONTH         PIC 99.
  2193             20  DC-MDCY-DAY           PIC 99.
  2194             20  DC-MDCY-CEN           PIC 99.
  2195             20  DC-MDCY-YEAR          PIC 99.
  2196    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2197        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2198    12  DC-EL310-DATE                  PIC X(21).
  2199    12  FILLER                         PIC X(28).
  2200
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  42
* EL6311.cbl
  2202*    COPY ELCLOGOF.
  2203******************************************************************
  2204*                                                                *
  2205*                                                                *
  2206*                            ELCLOGOF.                           *
  2207*                            VMOD=2.001                          *
  2208*                                                                *
  2209*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2210*                                                                *
  2211******************************************************************
  2212 01  CLASIC-LOGOFF.
  2213     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2214     12  LOGOFF-TEXT.
  2215         16  FILLER          PIC X(5)    VALUE SPACES.
  2216         16  LOGOFF-MSG.
  2217             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2218             20  FILLER      PIC X       VALUE SPACES.
  2219             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2220         16  FILLER          PIC X(80)
  2221           VALUE '* YOU ARE NOW LOGGED OFF'.
  2222         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2223         16  FILLER          PIC X       VALUE QUOTE.
  2224         16  LOGOFF-SYS-MSG  PIC X(17)
  2225           VALUE 'S CLAS-IC SYSTEM '.
  2226     12  TEXT-MESSAGES.
  2227         16  UNACCESS-MSG    PIC X(29)
  2228             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2229         16  PGMIDERR-MSG    PIC X(17)
  2230             VALUE 'PROGRAM NOT FOUND'.
  2231
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  43
* EL6311.cbl
  2233*    COPY ELCATTR.
  2234******************************************************************
  2235*                                                                *
  2236*                            ELCATTR.                            *
  2237*                            VMOD=2.001                          *
  2238*                                                                *
  2239*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2240*                                                                *
  2241*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2242*                                                                *
  2243*                   POS 1   P=PROTECTED                          *
  2244*                           U=UNPROTECTED                        *
  2245*                           S=ASKIP                              *
  2246*                   POS 2   A=ALPHA/NUMERIC                      *
  2247*                           N=NUMERIC                            *
  2248*                   POS 3   N=NORMAL                             *
  2249*                           B=BRIGHT                             *
  2250*                           D=DARK                               *
  2251*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2252*                           OF=MODIFIED DATA TAG OFF             *
  2253*                                                                *
  2254*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2255******************************************************************
  2256 01  ATTRIBUTE-LIST.
  2257     12  AL-PABOF            PIC X       VALUE 'Y'.
  2258     12  AL-PABON            PIC X       VALUE 'Z'.
  2259     12  AL-PADOF            PIC X       VALUE '%'.
  2260     12  AL-PADON            PIC X       VALUE '_'.
  2261     12  AL-PANOF            PIC X       VALUE '-'.
  2262     12  AL-PANON            PIC X       VALUE '/'.
  2263     12  AL-SABOF            PIC X       VALUE '8'.
  2264     12  AL-SABON            PIC X       VALUE '9'.
  2265     12  AL-SADOF            PIC X       VALUE '@'.
  2266     12  AL-SADON            PIC X       VALUE QUOTE.
  2267     12  AL-SANOF            PIC X       VALUE '0'.
  2268     12  AL-SANON            PIC X       VALUE '1'.
  2269     12  AL-UABOF            PIC X       VALUE 'H'.
  2270     12  AL-UABON            PIC X       VALUE 'I'.
  2271     12  AL-UADOF            PIC X       VALUE '<'.
  2272     12  AL-UADON            PIC X       VALUE '('.
  2273     12  AL-UANOF            PIC X       VALUE ' '.
  2274     12  AL-UANON            PIC X       VALUE 'A'.
  2275     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2276     12  AL-UNBON            PIC X       VALUE 'R'.
  2277     12  AL-UNDOF            PIC X       VALUE '*'.
  2278     12  AL-UNDON            PIC X       VALUE ')'.
  2279     12  AL-UNNOF            PIC X       VALUE '&'.
  2280     12  AL-UNNON            PIC X       VALUE 'J'.
  2281
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  44
* EL6311.cbl
  2283*    COPY ELCEMIB.
  2284******************************************************************
  2285*                                                                *
  2286*                                                                *
  2287*                            ELCEMIB.                            *
  2288*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2289*                            VMOD=2.005                          *
  2290*                                                                *
  2291*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2292*                                                                *
  2293******************************************************************
  2294 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2295     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2296     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2297     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2298     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2299     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2300     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2301     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2302     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2303     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2304         88  EMI-NO-ERRORS                    VALUE '1'.
  2305         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2306         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2307     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2308         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2309     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2310         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2311         88  EMI-AREA1-FULL                   VALUE '2'.
  2312     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2313         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2314         88  EMI-AREA2-FULL                   VALUE '2'.
  2315     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2316         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2317         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2318         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2319         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2320         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2321     12  EMI-ERROR-LINES.
  2322         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2323         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2324         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2325         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2326             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2327                 24  EMI-ERR-NUM         PIC X(4).
  2328                 24  EMI-FILLER          PIC X.
  2329                 24  EMI-SEV             PIC X.
  2330                 24  FILLER              PIC X.
  2331             20  FILLER                  PIC X(02).
  2332     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2333         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2334             20  EMI-ERROR-NUMBER    PIC X(4).
  2335             20  EMI-FILL            PIC X.
  2336             20  EMI-SEVERITY        PIC X.
  2337             20  FILLER              PIC X.
  2338             20  EMI-ERROR-TEXT.
  2339                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2340                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  45
* EL6311.cbl
  2341     12  EMI-SEVERITY-SAVE           PIC X.
  2342         88  EMI-NOTE                    VALUE 'N'.
  2343         88  EMI-WARNING                 VALUE 'W'.
  2344         88  EMI-FORCABLE                VALUE 'F'.
  2345         88  EMI-FATAL                   VALUE 'X'.
  2346     12  EMI-MESSAGE-FLAG            PIC X.
  2347         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2348         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2349     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2350     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2351         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2352         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2353         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2354     12  emi-claim-no                pic x(7).
  2355     12  emi-claim-type              pic x(6).
  2356     12  FILLER                      PIC X(124)  VALUE SPACES.
  2357     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2358     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2359     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2360     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2361
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  46
* EL6311.cbl
  2363*    COPY ELCINTF.
  2364******************************************************************
  2365*                                                                *
  2366*                                                                *
  2367*                            ELCINTF.                            *
  2368*                            VMOD=2.017                          *
  2369*                                                                *
  2370*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2371*                                                                *
  2372*       LENGTH = 1024                                            *
  2373*                                                                *
  2374******************************************************************
  2375*                   C H A N G E   L O G
  2376*
  2377* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2378*-----------------------------------------------------------------
  2379*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2380* EFFECTIVE    NUMBER
  2381*-----------------------------------------------------------------
  2382* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2383******************************************************************
  2384 01  PROGRAM-INTERFACE-BLOCK.
  2385     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2386     12  PI-CALLING-PROGRAM              PIC X(8).
  2387     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2388     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2389     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2390     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2391     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2392     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2393     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2394     12  PI-COMPANY-ID                   PIC XXX.
  2395     12  PI-COMPANY-CD                   PIC X.
  2396
  2397     12  PI-COMPANY-PASSWORD             PIC X(8).
  2398
  2399     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2400
  2401     12  PI-CONTROL-IN-PROGRESS.
  2402         16  PI-CARRIER                  PIC X.
  2403         16  PI-GROUPING                 PIC X(6).
  2404         16  PI-STATE                    PIC XX.
  2405         16  PI-ACCOUNT                  PIC X(10).
  2406         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2407                                         PIC X(10).
  2408         16  PI-CLAIM-CERT-GRP.
  2409             20  PI-CLAIM-NO             PIC X(7).
  2410             20  PI-CERT-NO.
  2411                 25  PI-CERT-PRIME       PIC X(10).
  2412                 25  PI-CERT-SFX         PIC X.
  2413             20  PI-CERT-EFF-DT          PIC XX.
  2414         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2415             20  PI-PLAN-CODE            PIC X(2).
  2416             20  PI-REVISION-NUMBER      PIC X(3).
  2417             20  PI-PLAN-EFF-DT          PIC X(2).
  2418             20  PI-PLAN-EXP-DT          PIC X(2).
  2419             20  FILLER                  PIC X(11).
  2420         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  47
* EL6311.cbl
  2421             20  PI-OE-REFERENCE-1.
  2422                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2423                 25  PI-OE-REF-1-SUFF    PIC XX.
  2424
  2425     12  PI-SESSION-IN-PROGRESS          PIC X.
  2426         88  CLAIM-SESSION                   VALUE '1'.
  2427         88  CREDIT-SESSION                  VALUE '2'.
  2428         88  WARRANTY-SESSION                VALUE '3'.
  2429         88  MORTGAGE-SESSION                VALUE '4'.
  2430         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2431
  2432
  2433*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2434
  2435     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2436     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2437
  2438     12  PI-CREDIT-USER                  PIC X.
  2439         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2440         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2441
  2442     12  PI-CLAIM-USER                   PIC X.
  2443         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2444         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2445
  2446     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2447         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2448         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2449         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2450         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2451         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2452
  2453     12  PI-PROCESSOR-ID                 PIC X(4).
  2454
  2455     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2456
  2457     12  PI-MEMBER-CAPTION               PIC X(10).
  2458
  2459     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2460         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2461
  2462     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2463     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2464     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2465     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2466
  2467     12  PI-AH-OVERRIDE-L1               PIC X.
  2468     12  PI-AH-OVERRIDE-L2               PIC XX.
  2469     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2470     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2471
  2472     12  PI-NEW-SYSTEM                   PIC X(2).
  2473
  2474     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2475     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2476         88  PI-USES-PAID-TO                 VALUE '1'.
  2477     12  PI-CRDTCRD-SYSTEM.
  2478         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  48
* EL6311.cbl
  2479             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2480             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2481         16  PI-CC-MONTH-END-DT          PIC XX.
  2482     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2483
  2484     12  PI-OE-REFERENCE-2.
  2485         16  PI-OE-REF-2-PRIME           PIC X(10).
  2486         16  PI-OE-REF-2-SUFF            PIC X.
  2487
  2488     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2489
  2490     12  PI-LANGUAGE-TYPE                PIC X.
  2491             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2492             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2493             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2494
  2495     12  PI-POLICY-LINKAGE-IND           PIC X.
  2496         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2497         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2498                                                   LOW-VALUES.
  2499
  2500     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2501     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2502         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2503         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2504
  2505     12  PI-PROCESSOR-CSR-IND            PIC X.
  2506         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2507         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2508
  2509     12  FILLER                          PIC X(3).
  2510
  2511     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2512
  2513     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2514         PI-SYSTEM-LEVEL.
  2515
  2516         16  PI-ENTRY-CODES.
  2517             20  PI-ENTRY-CD-1           PIC X.
  2518             20  PI-ENTRY-CD-2           PIC X.
  2519
  2520         16  PI-RETURN-CODES.
  2521             20  PI-RETURN-CD-1          PIC X.
  2522             20  PI-RETURN-CD-2          PIC X.
  2523
  2524         16  PI-UPDATE-STATUS-SAVE.
  2525             20  PI-UPDATE-BY            PIC X(4).
  2526             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2527
  2528         16  PI-LOWER-CASE-LETTERS       PIC X.
  2529             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2530
  2531*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2532*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2533*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2534
  2535         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2536             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  49
* EL6311.cbl
  2537             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2538             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2539             88  ACCNT-CNTL                  VALUE '3'.
  2540             88  CARR-ACCNT-CNTL             VALUE '4'.
  2541
  2542         16  PI-PROCESSOR-CAP-LIST.
  2543             20  PI-SYSTEM-CONTROLS.
  2544                24 PI-SYSTEM-DISPLAY     PIC X.
  2545                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2546                24 PI-SYSTEM-MODIFY      PIC X.
  2547                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2548             20  FILLER                  PIC XX.
  2549             20  PI-DISPLAY-CAP          PIC X.
  2550                 88  DISPLAY-CAP             VALUE 'Y'.
  2551             20  PI-MODIFY-CAP           PIC X.
  2552                 88  MODIFY-CAP              VALUE 'Y'.
  2553             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2554                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2555             20  PI-FORCE-CAP            PIC X.
  2556                 88  FORCE-CAP               VALUE 'Y'.
  2557
  2558         16  PI-PROGRAM-CONTROLS.
  2559             20  PI-PGM-PRINT-OPT        PIC X.
  2560             20  PI-PGM-FORMAT-OPT       PIC X.
  2561             20  PI-PGM-PROCESS-OPT      PIC X.
  2562             20  PI-PGM-TOTALS-OPT       PIC X.
  2563
  2564         16  PI-HELP-INTERFACE.
  2565             20  PI-LAST-ERROR-NO        PIC X(4).
  2566             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2567
  2568         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2569             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2570
  2571         16  PI-CR-CONTROL-IN-PROGRESS.
  2572             20  PI-CR-CARRIER           PIC X.
  2573             20  PI-CR-GROUPING          PIC X(6).
  2574             20  PI-CR-STATE             PIC XX.
  2575             20  PI-CR-ACCOUNT           PIC X(10).
  2576             20  PI-CR-FIN-RESP          PIC X(10).
  2577             20  PI-CR-TYPE              PIC X.
  2578
  2579         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2580
  2581         16  PI-CR-MONTH-END-DT          PIC XX.
  2582
  2583         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2584             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2585             88  PI-ZERO-CARRIER             VALUE '1'.
  2586             88  PI-ZERO-GROUPING            VALUE '2'.
  2587             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2588
  2589         16  PI-CARRIER-SECURITY         PIC X.
  2590             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2591
  2592         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2593             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2594             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  50
* EL6311.cbl
  2595
  2596         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2597             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2598                                         INDEXED BY PI-ACCESS-NDX
  2599                                         PIC X.
  2600
  2601         16  PI-GA-BILLING-CONTROL       PIC X.
  2602             88  PI-GA-BILLING               VALUE '1'.
  2603
  2604         16  PI-MAIL-PROCESSING          PIC X.
  2605             88  PI-MAIL-YES                 VALUE 'Y'.
  2606
  2607         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2608
  2609         16  PI-AR-SYSTEM.
  2610             20  PI-AR-PROCESSING-CNTL   PIC X.
  2611                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2612             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2613             20  PI-AR-MONTH-END-DT      PIC XX.
  2614
  2615         16  PI-MP-SYSTEM.
  2616             20  PI-MORTGAGE-USER            PIC X.
  2617                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2618                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2619             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2620                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2621                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2622                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2623                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2624                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2625             20  PI-MP-MONTH-END-DT          PIC XX.
  2626             20  PI-MP-REFERENCE-NO.
  2627                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2628                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2629
  2630         16  PI-LABEL-CONTROL            PIC X(01).
  2631             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2632             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2633
  2634         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2635             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2636
  2637         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2638             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2639             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2640
  2641         16  FILLER                      PIC X(14).
  2642
  2643     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2644******************************************************************
  2645
  2646     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2647*    COPY ELC631PI.
  2648******************************************************************
  2649*                                                                *
  2650*                                                                *
  2651*                            ELC631PI                            *
  2652*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  51
* EL6311.cbl
  2653*                                                                *
  2654*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2655*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2656*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2657*                                                                *
  2658*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2659*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2660*    BETWEEN PROGRAMS.                                           *
  2661*                                                                *
  2662*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2663*                                                                *
  2664*               EL631 - EL6311 - EL6312 - EL6313                 *
  2665*                                                                *
  2666******************************************************************
  2667*                   C H A N G E   L O G
  2668*
  2669* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2670*-----------------------------------------------------------------
  2671*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2672* EFFECTIVE    NUMBER
  2673*-----------------------------------------------------------------
  2674* 021414    2003053000001  PEMA  changes for auto chk request
  2675******************************************************************
  2676
  2677         16  PI-631-DATA.
  2678             20  PI-ERPNDB-KEY.
  2679                 24  PI-PB-COMPANY-CD     PIC X.
  2680                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2681                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2682                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2683
  2684             20  PI-ERPNDB-ALT-KEY.
  2685                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2686                 24  PI-PB-CARRIER        PIC X.
  2687                 24  PI-PB-GROUPING       PIC X(6).
  2688                 24  PI-PB-STATE          PIC XX.
  2689                 24  PI-PB-ACCOUNT        PIC X(10).
  2690                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2691                 24  PI-PB-CERT-NO.
  2692                     28  PI-PB-CERT-PRIME PIC X(10).
  2693                     28  PI-PB-CERT-SFX   PIC X.
  2694                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2695                 24  PI-PB-RECORD-TYPE    PIC X.
  2696
  2697             20  PI-ERPNDB-CSR-KEY.
  2698                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2699                 24  PI-PB-CSR-ID             PIC X(4).
  2700                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2701                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2702                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2703
  2704             20  PI-BROWSE-TYPE               PIC X.
  2705                 88  PI-FILE-BROWSE             VALUE ' '.
  2706                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2707                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2708                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2709                 88  PI-CSR-BROWSE              VALUE '4'.
  2710
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  52
* EL6311.cbl
  2711             20  PI-MAINT-FUNCTION            PIC X.
  2712                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2713                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2714                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2715                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2716                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2717                 88  PI-PF5-FUNCTION            VALUE '5'.
  2718                 88  PI-PF6-FUNCTION            VALUE '6'.
  2719
  2720             20  PI-FILE-SWITCHES.
  2721                 24  PI-ALL-ISSUES-SW         PIC X.
  2722                     88  ALL-ISSUES             VALUE 'Y'.
  2723                 24  PI-ALL-CANCELS-SW        PIC X.
  2724                     88  ALL-CANCELS            VALUE 'Y'.
  2725                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2726                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2727                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2728                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2729                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2730                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2731                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2732                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2733                 24  PI-HOLD-REC-SW           PIC X.
  2734                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2735                 24  PI-CHANGE-REC-SW         PIC X.
  2736                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2737                 24  PI-CHK-REQ-REC-SW        PIC X.
  2738                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2739                 24  PI-ISSUE-WARNING-SW      PIC X.
  2740                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2741                 24  PI-CANCEL-WARNING-SW     PIC X.
  2742                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2743             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2744                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2745             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2746                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2747
  2748             20  PI-MAP-NAME                  PIC X(8).
  2749
  2750             20  PI-CURSOR                    PIC S9(4) COMP.
  2751
  2752             20  PI-PREV-ALT-KEY              PIC X(36).
  2753             20  PI-PREV-CSR-KEY              PIC X(15).
  2754             20  PI-PREV-KEY.
  2755                 24  PI-PREV-COMPANY-CD       PIC X.
  2756                 24  PI-PREV-BATCH            PIC X(6).
  2757                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2758                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2759             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2760             20  PI-BROWSE-SW                 PIC X.
  2761                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2762                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2763             20  PI-SV-CARRIER                PIC X.
  2764             20  PI-SV-GROUPING               PIC X(6).
  2765             20  PI-SV-STATE                  PIC XX.
  2766             20  PI-EDIT-SW                   PIC X.
  2767             20  PI-DISPLAY-SW                PIC XX.
  2768                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  53
* EL6311.cbl
  2769                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2770             20  PI-CRITERIA-DATA             PIC X(350).
  2771             20  PI-BMODE                     PIC X.
  2772             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2773             20  PI-BPMTS                     PIC S999     COMP-3.
  2774             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2775             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2776             20  PI-CSR-SESSION-SW            PIC X.
  2777                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2778             20  PI-ERRORS-SW                 PIC X.
  2779                 88  FATAL-ERRORS               VALUE 'X'.
  2780*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2781             20  pi-unforced-sw               pic x.
  2782                 88  unforced-errors            value 'X'.
  2783             20  FILLER                       PIC X(4).
  2784
  2785        16  pi-6311-fatal-ctr    pic s999 comp-3.
  2786        16  FILLER             PIC X(92).
  2787
  2788 01  W-LETTER-COMMUNICATION-AREAS.
  2789*    COPY ELC1042.
  2790******************************************************************
  2791*                                                                *
  2792*                                                                *
  2793*                           ELC1042                              *
  2794*                            VMOD=2.002                          *
  2795*                                                                *
  2796*    NOTE                                                        *
  2797*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2798*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2799*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2800*        TO THESE PROGRAMS.                                      *
  2801*                                                                *
  2802*    NOTE                                                        *
  2803*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2804*        USE ONLY!                                               *
  2805*                                                                *
  2806******************************************************************
  2807
  2808         16  PI-1042-WA.
  2809             20  PI-ACTION       PIC  X(01).
  2810                 88 PI-SHOW-MODE           VALUE '1'.
  2811                 88 PI-CLEAR-MODE          VALUE '2'.
  2812                 88 PI-CREATE-MODE         VALUE '3'.
  2813             20  PI-COMM-CONTROL PIC  X(12).
  2814             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2815             20  PI-EOF-SW       PIC  X(01).
  2816                 88  PI-FILE-EOF           VALUE 'Y'.
  2817             20  PI-FILETYP      PIC  X(01).
  2818             20  PI-FORM-SQUEEZE-CONTROL
  2819                                 PIC  X(01).
  2820                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2821                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2822             20  PI-LAST-CONTROL PIC  X(12).
  2823             20  PI-TEMP-STOR-ITEMS
  2824                                 PIC S9(04) COMP.
  2825             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2826             20  PI-UPDATE-SW    PIC  9(01).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  54
* EL6311.cbl
  2827                 88 ANY-UPDATES            VALUE 1.
  2828             20  PI-104-SCREEN-SENT-IND
  2829                                 PIC  X(01).
  2830                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2831                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2832             20  PI-1042-SCREEN-SENT-IND
  2833                                 PIC  X(01).
  2834                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2835                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2836             20  PI-1042-ARCHIVE-IND
  2837                                 PIC  X(01).
  2838                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2839             20  FILLER          PIC  X(29).
  2840*    COPY ELC689PI.
  2841******************************************************************
  2842*                                                                *
  2843*                            ELC689PI                            *
  2844*                            VMOD=2.003                          *
  2845*                                                                *
  2846*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2847*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2848*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2849*                                                                *
  2850*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2851*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2852*    BETWEEN PROGRAMS.                                           *
  2853*                                                                *
  2854*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2855*                                                                *
  2856*               EL631 - EL689  - EL6891 - EL6892                 *
  2857*                                                                *
  2858******************************************************************
  2859*                   C H A N G E   L O G
  2860*
  2861* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2862*-----------------------------------------------------------------
  2863*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2864* EFFECTIVE    NUMBER
  2865*-----------------------------------------------------------------
  2866* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2867* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2868* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2869******************************************************************
  2870
  2871
  2872         16  PI-689-WORK-AREA.
  2873             20  PI-689-ALT-PRINTER-ID
  2874                                 PIC  X(04).
  2875             20  PI-689-ARCHIVE-NUMBER
  2876                                 PIC  9(08).
  2877             20  PI-689-ARCHIVE-SW
  2878                                 PIC  X(01).
  2879                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2880             20  PI-689-DATA-SOURCE
  2881                                 PIC  X(01).
  2882                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2883                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2884                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  55
* EL6311.cbl
  2885                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2886                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2887             20  PI-689-ERROR-IND
  2888                                 PIC  X(01).
  2889                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2890             20  PI-689-ERROR    PIC  9(04).
  2891                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2892                 88  PI-689-FATAL-ERROR
  2893                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2894                            0042 0047 0051 0066 0067 0070
  2895                            0168 0169 0174 0175 0176 0177 0179
  2896                            0180 0181 0182 0184 0185 0189 0190
  2897                            0191
  2898                            0215 0279 0280
  2899                            0412 0413 0454
  2900                            0533 0537
  2901                            2055 2114 2208 2209 2216 2232 2369
  2902                            2398 2433 2908 2999
  2903                            3000 3770 3771 3775
  2904                            7250 7365 7367 7368 7369 7370 7371
  2905                            7272 7373 7374 7376 7377 7378 7379
  2906                            7381 7388 7390 7393 7395 7396 7398
  2907                            9095 9096 9281 9298 9299 9320 9327
  2908                            9426 9427.
  2909                 88  PI-689-STOP-ERROR
  2910                     VALUES 0004 0008 0013 0023 0029 0033
  2911                            0042 0047 0066 0067 0070
  2912                            0168 0169 0174 0175 0176 0177
  2913                            0181 0182 0184 0185 0189 0190
  2914                            0279 0280
  2915                            0412 0413 0454
  2916                            2055 2208 2209 2216 2232
  2917                            2398 2999
  2918                            3000 3770 3771 3775
  2919                            7250 7365 7369 7370 7371
  2920                            7272 7373 7374 7376 7377 7378 7379
  2921                            7381 7388 7390 7393 7396 7398
  2922                            9095 9096 9299 9320 9426.
  2923             20  PI-689-FOLLOW-UP-DATE
  2924                                 PIC  X(02).
  2925             20  PI-689-FORM-NUMBER
  2926                                 PIC  X(04).
  2927             20  PI-689-LABEL-SOURCE
  2928                                 PIC X(01).
  2929                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2930                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2931                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2932                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2933                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2934                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2935                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2936             20  PI-689-NUMBER-COPIES
  2937                                 PIC  9(01).
  2938             20  PI-689-NUMBER-LABEL-LINES
  2939                                 PIC  9(01).
  2940             20  PI-689-NUMBER-TEXT-RECORDS
  2941                                 PIC  9(03).
  2942             20  PI-689-PRINT-ORDER-SW
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  56
* EL6311.cbl
  2943                                 PIC  X(01).
  2944                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2945                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2946                 88  PI-689-PRINT-LATER     VALUE '3'.
  2947                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2948             20  PI-689-PRINT-RESTRICTION
  2949                                 PIC  X(01).
  2950                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2951                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2952                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2953             20  PI-689-PRINT-SW PIC  X(01).
  2954                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2955             20  PI-689-RESEND-DATE-1
  2956                                 PIC  X(02).
  2957             20  PI-689-RESEND-LETR-1
  2958                                 PIC X(4).
  2959             20  PI-689-TEMP-STOR-ID
  2960                                 PIC  X(08).
  2961             20  PI-689-USE-SCREEN-IND
  2962                                 PIC  X(01).
  2963                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2964             20  PI-689-ARCH-POINTER
  2965                                 PIC S9(08) COMP.
  2966                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2967             20  PI-689-ARCT-POINTER
  2968                                 PIC S9(08) COMP.
  2969                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2970             20  PI-689-VARIABLE-DATA-GRP.
  2971                 24  PI-689-VARIABLE-DATA-1
  2972                                 PIC  X(30).
  2973                 24  PI-689-VARIABLE-DATA-2
  2974                                 PIC  X(30).
  2975                 24  PI-689-VARIABLE-DATA-3
  2976                                 PIC  X(30).
  2977                 24  PI-689-VARIABLE-DATA-4
  2978                                 PIC  X(30).
  2979
  2980         16  PI-689-KEY-DATA-FIELDS.
  2981             20  PI-689-ACCOUNT  PIC  X(10).
  2982             20  PI-689-CARRIER  PIC  X(01).
  2983             20  PI-689-CERT-NO.
  2984                 24  PI-689-CERT-PRIME
  2985                                 PIC  X(10).
  2986                 24  PI-689-CERT-SFX
  2987                                 PIC  X(01).
  2988             20  PI-689-CHG-SEQ-NO
  2989                                 PIC S9(04)    COMP.
  2990             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2991                                 PIC  X(02).
  2992             20  PI-689-ENTRY-BATCH
  2993                                 PIC  X(06).
  2994             20  PI-689-EFF-DATE PIC  X(02).
  2995             20  PI-689-EXP-DATE PIC  X(02).
  2996             20  PI-689-GROUPING PIC  X(06).
  2997             20  PI-689-RESP-PERSON
  2998                                 PIC  X(10).
  2999             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  3000             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  57
* EL6311.cbl
  3001                                 PIC  X(04).
  3002             20  PI-689-STATE    PIC  X(02).
  3003             20  PI-689-TYPE     PIC  X(01).
  3004             20  PI-689-CONTROL  PIC S9(08)    COMP.
  3005             20  PI-689-ALT-SEQ-NO
  3006                                 PIC S9(04)    COMP.
  3007         16  PI-689-DATE-EDIT    PIC  X(08).
  3008         16  PI-689-FOLLOW-UP-EDIT
  3009                                 PIC  X(08).
  3010         16  PI-689-RESEND1-EDIT PIC  X(08).
  3011         16  PI-689-SEQ-EDIT     PIC  X(08).
  3012         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  3013         16  PI-689-LBL-OVERRIDE PIC  X(01).
  3014             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  3015         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  3016         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  58
* EL6311.cbl
  3018
  3019 01  WS-EL6315-PASS-AREA.
  3020        16  PI-6315-ISS-CAN-SW      PIC X.
  3021        16  FILLER                  PIC X(120).
  3022        16  PI-RES-REF-CLM-TYPE     PIC X.
  3023        16  FILLER                  PIC X.
  3024        16  PI-6315-PASS-AREA.
  3025            20 FILLER               PIC X(236).
  3026            20 PI-6315-FINALIZED    PIC X.
  3027            20 FILLER               PIC X(280).
  3028
  3029 01  WS-EL6316-PASS-AREA.
  3030        16  PI-ISS-CAN-SW           PIC X.
  3031        16  FILLER                  PIC X(121).
  3032        16  PI-CLM-RESC-IND         PIC X.
  3033        16  PI-6316-PASS-AREA.
  3034            20 FILLER               PIC X(236).
  3035            20 PI-6316-FINALIZED    PIC X.
  3036            20 FILLER               PIC X(280).
  3037
  3038******************************************************************
  3039*                                                                *
  3040*         P A S S   A R E A   F O R   E D I T                    *
  3041*                                                                *
  3042******************************************************************
  3043
  3044 01  PASSED-RECORD.
  3045     12  RECORD-SAVE                  PIC X(585).
  3046* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  3047*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  3048*                    BY  WK-CURRENT-DATE.
  3049******************************************************************
  3050*                                                                *
  3051*                                                                *
  3052*                             ELC50W1                            *
  3053*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3054*                            VMOD=2.004                          *
  3055*                                                                *
  3056*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  3057*                                                                *
  3058*                                                                *
  3059******************************************************************
  3060
  3061     12  WK-WORK-AREA.
  3062         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  3063         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  3064         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  3065         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  3066         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  3067         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  3068         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  3069         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  3070         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  3071         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  3072         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  3073         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  3074         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  3075         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  59
* EL6311.cbl
  3076         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  3077         16  WK-CREDIT-EDIT-CONTROLS.
  3078             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  3079             20  WK-MIN-AGE           PIC 99  VALUE 00.
  3080             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  3081             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  3082             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  3083             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  3084         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  3085         16  WK-SAVE-REIN-DATA.
  3086             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  3087             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  3088             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  3089         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  3090             88  ENTRY-FROM-EL6311       VALUE '6'.
  3091         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  3092         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  3093     12  WK-RECORD-ADDRESSES.
  3094         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3095         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  3096         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  3097         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  3098         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  3099         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  3100         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3101         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3102     12  WK-OVER-SHORT-AREA.
  3103         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3104         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3105         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3106             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3107         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  60
* EL6311.cbl
  3109
  3110*    COPY ELCEDITC.
  3111******************************************************************
  3112*                                                                *
  3113*                                                                *
  3114*                            ELCEDITC                            *
  3115*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3116*                            VMOD=2.012                          *
  3117*                                                                *
  3118*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3119*                     EL6313, EL050 AND EL517.                   *
  3120*                                                                *
  3121******************************************************************
  3122******************************************************************
  3123*                   C H A N G E   L O G
  3124*
  3125* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3126*-----------------------------------------------------------------
  3127*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3128* EFFECTIVE    NUMBER
  3129*-----------------------------------------------------------------
  3130* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3131******************************************************************
  3132
  3133     12  EDIT-CRITERIA-DATA.
  3134         16  EC-CO-MONTH-END-DT       PIC XX.
  3135         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3136         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3137         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3138         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3139         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3140         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3141         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3142         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3143         16  EC-CO-REM-TERM-CALC      PIC X.
  3144               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3145               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3146               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3147               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3148
  3149         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3150               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3151               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3152               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3153               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3154               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3155               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3156               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3157               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3158               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3159               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3160
  3161         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3162               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3163               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3164               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3165               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3166               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  61
* EL6311.cbl
  3167               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3168               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3169               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3170
  3171         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3172                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3173                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3174
  3175         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3176                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3177                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3178                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3179                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3180                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3181                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3182                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3183                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3184
  3185         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3186               88  EC-BR-REDUCING                   VALUE 'R'.
  3187               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3188
  3189         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3190         16  EC-BR-LF-DESC             PIC X(10).
  3191         16  EC-BR-AH-DESC             PIC X(10).
  3192         16  EC-BR-LF-COMMENT          PIC X(10).
  3193         16  EC-BR-AH-COMMENT          PIC X(10).
  3194
  3195         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3196               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3197               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3198               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3199               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3200
  3201         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3202               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3203               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3204               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3205               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3206
  3207         16  EC-BR-LF-REFUND-CALC      PIC X.
  3208                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3209                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3210                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3211                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3212                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3213                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3214                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3215
  3216         16  EC-BR-AH-REFUND-CALC      PIC X.
  3217                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3218                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3219                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3220                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3221                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3222                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3223                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3224                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  62
* EL6311.cbl
  3225
  3226         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3227                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3228                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3229                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3230
  3231         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3232                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3233                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3234                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3235
  3236         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3237         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3238         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3239         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3240
  3241         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3242         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3243                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3244                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3245                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3246                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3247
  3248         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3249               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3250               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3251               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3252               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3253               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3254
  3255         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3256               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3257               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3258               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3259               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3260               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3261
  3262         16  EC-ST-LF-REFUND-CALC      PIC X.
  3263                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3264                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3265                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3266                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3267                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3268                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3269                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3270                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3271
  3272         16  EC-ST-AH-REFUND-CALC      PIC X.
  3273                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3274                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3275                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3276                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3277                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3278                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3279                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3280                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3281
  3282         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  63
* EL6311.cbl
  3283         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3284         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3285         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3286         16  EC-AM-EXPIRATION-DT       PIC XX.
  3287         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3288         16  EC-AM-CLASS-CD            PIC XX.
  3289         16  EC-AM-LF-DEVIATION        PIC XXX.
  3290         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3291         16  EC-AM-AH-DEVIATION        PIC XXX.
  3292         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3293         16  EC-AM-PHONE-NO            PIC X(10).
  3294
  3295         16  EC-AM-LF-REFUND-CALC      PIC X.
  3296                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3297                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3298                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3299                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3300                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3301                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3302                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3303
  3304         16  EC-AM-AH-REFUND-CALC      PIC X.
  3305                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3306                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3307                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3308                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3309                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3310                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3311                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3312
  3313         16  EC-AM-BEN-I-G-CD          PIC X.
  3314                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3315                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3316                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3317
  3318         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3319         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3320         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3321         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3322         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3323         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3324         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3325         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3326         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3327
  3328         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3329         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3330         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3331         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3332         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3333         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3334         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3335         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3336         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3337         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3338         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3339         16  EC-RT-LF-NSP-ST           PIC XX.
  3340         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  64
* EL6311.cbl
  3341         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3342         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3343
  3344         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3345             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3346                                             'M' '5' '9' '2'.
  3347             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3348             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3349             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3350             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3351             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3352             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3353             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3354             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3355             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3356             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3357
  3358         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3359             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3360                                             'M' '5' '9' '2'.
  3361             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3362             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3363             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3364             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3365             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3366             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3367             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3368             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3369             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3370             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3371
  3372         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3373         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3374         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3375         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3376         16  EC-CM-DEATH-DT            PIC XX.
  3377
  3378*DMD CUSTOM CODING FIELDS BELOW
  3379*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3380         16  EC-BR-DMD-RATING-SW       PIC X.
  3381                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3382                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3383                 88  NO-DMD-RATING               VALUE 'N'.
  3384
  3385         16  EC-NEW-CERT               PIC X(11).
  3386         16  EC-NEW-STATE              PIC XX.
  3387         16  FILLER                    PIC X.
  3388*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3389         16  OVER-SHORT-EDIT-FIELDS.
  3390             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3391             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3392             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3393             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3394             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3395             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3396             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3397             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3398             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  65
* EL6311.cbl
  3399         16  FILLER                    PIC X(71).
  3400
  3401******************************************************************
  3402
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  66
* EL6311.cbl
  3404
  3405*    COPY ELCJPFX.
  3406******************************************************************
  3407*                                                                *
  3408*                                                                *
  3409*                            ELCJPFX.                            *
  3410*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3411*                            VMOD=2.002                          *
  3412*                                                                *
  3413*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3414*                                                                *
  3415*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3416*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3417*        ELCNTL - CONTROL FILE                                   *
  3418*        ELMSTR - CLAIM MASTERS                                  *
  3419*        ELTRLR - ACTIVITY TRAILERS                              *
  3420*        ELCHKQ - CHECK QUE                                      *
  3421******************************************************************
  3422 01  JOURNAL-RECORD.
  3423     12  jp-date                     pic s9(5) comp-3.
  3424     12  jp-time                     pic s9(7) comp-3.
  3425     12  JP-USER-ID                  PIC X(4).
  3426     12  JP-FILE-ID                  PIC X(8).
  3427     12  JP-PROGRAM-ID               PIC X(8).
  3428     12  JP-RECORD-TYPE              PIC X.
  3429         88 JP-ADD              VALUE 'A'.
  3430         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3431         88 JP-AFTER-CHANGE     VALUE 'C'.
  3432         88 JP-DELETE           VALUE 'D'.
  3433         88 JP-GENERIC-DELETE   VALUE 'G'.
  3434         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3435         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3436     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3437     12  JP-RECORD-AREA
  3438
  3439
  3440                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  67
* EL6311.cbl
  3442*    COPY ELCAID.
  3443******************************************************************
  3444*                                                                *
  3445*                            ELCAID.                             *
  3446*                            VMOD=2.001                          *
  3447*                                                                *
  3448*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3449*                                                                *
  3450*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3451*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3452******************************************************************
  3453
  3454 01  DFHAID.
  3455   02  DFHNULL   PIC  X  VALUE  ' '.
  3456   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3457   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3458   02  DFHPEN    PIC  X  VALUE  '='.
  3459   02  DFHOPID   PIC  X  VALUE  'W'.
  3460   02  DFHPA1    PIC  X  VALUE  '%'.
  3461   02  DFHPA2    PIC  X  VALUE  '>'.
  3462   02  DFHPA3    PIC  X  VALUE  ','.
  3463   02  DFHPF1    PIC  X  VALUE  '1'.
  3464   02  DFHPF2    PIC  X  VALUE  '2'.
  3465   02  DFHPF3    PIC  X  VALUE  '3'.
  3466   02  DFHPF4    PIC  X  VALUE  '4'.
  3467   02  DFHPF5    PIC  X  VALUE  '5'.
  3468   02  DFHPF6    PIC  X  VALUE  '6'.
  3469   02  DFHPF7    PIC  X  VALUE  '7'.
  3470   02  DFHPF8    PIC  X  VALUE  '8'.
  3471   02  DFHPF9    PIC  X  VALUE  '9'.
  3472   02  DFHPF10   PIC  X  VALUE  ':'.
  3473   02  DFHPF11   PIC  X  VALUE  '#'.
  3474   02  DFHPF12   PIC  X  VALUE  '@'.
  3475   02  DFHPF13   PIC  X  VALUE  'A'.
  3476   02  DFHPF14   PIC  X  VALUE  'B'.
  3477   02  DFHPF15   PIC  X  VALUE  'C'.
  3478   02  DFHPF16   PIC  X  VALUE  'D'.
  3479   02  DFHPF17   PIC  X  VALUE  'E'.
  3480   02  DFHPF18   PIC  X  VALUE  'F'.
  3481   02  DFHPF19   PIC  X  VALUE  'G'.
  3482   02  DFHPF20   PIC  X  VALUE  'H'.
  3483   02  DFHPF21   PIC  X  VALUE  'I'.
  3484*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3485   02  DFHPF22   PIC  X  VALUE  '['.
  3486   02  DFHPF23   PIC  X  VALUE  '.'.
  3487   02  DFHPF24   PIC  X  VALUE  '<'.
  3488   02  DFHMSRE   PIC  X  VALUE  'X'.
  3489   02  DFHSTRF   PIC  X  VALUE  'h'.
  3490   02  DFHTRIG   PIC  X  VALUE  '"'.
  3491
  3492 01  FILLER    REDEFINES DFHAID.
  3493     12  FILLER              PIC X(8).
  3494     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3495
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  68
* EL6311.cbl
  3497*    COPY EL6311S.
  3498 01  EL631BI.
  3499     05  FILLER            PIC  X(0012).
  3500*    -------------------------------
  3501     05  BDATEL PIC S9(0004) COMP.
  3502     05  BDATEF PIC  X(0001).
  3503     05  FILLER REDEFINES BDATEF.
  3504         10  BDATEA PIC  X(0001).
  3505     05  BDATEI PIC  X(0008).
  3506*    -------------------------------
  3507     05  BTIMEL PIC S9(0004) COMP.
  3508     05  BTIMEF PIC  X(0001).
  3509     05  FILLER REDEFINES BTIMEF.
  3510         10  BTIMEA PIC  X(0001).
  3511     05  BTIMEI PIC  X(0005).
  3512*    -------------------------------
  3513     05  BHEADL PIC S9(0004) COMP.
  3514     05  BHEADF PIC  X(0001).
  3515     05  FILLER REDEFINES BHEADF.
  3516         10  BHEADA PIC  X(0001).
  3517     05  BHEADI PIC  X(0038).
  3518*    -------------------------------
  3519     05  BNCERTLL PIC S9(0004) COMP.
  3520     05  BNCERTLF PIC  X(0001).
  3521     05  FILLER REDEFINES BNCERTLF.
  3522         10  BNCERTLA PIC  X(0001).
  3523     05  BNCERTLI PIC  X(0008).
  3524*    -------------------------------
  3525     05  BNCERTL PIC S9(0004) COMP.
  3526     05  BNCERTF PIC  X(0001).
  3527     05  FILLER REDEFINES BNCERTF.
  3528         10  BNCERTA PIC  X(0001).
  3529     05  BNCERTI PIC  X(0011).
  3530*    -------------------------------
  3531     05  BNSTATLL PIC S9(0004) COMP.
  3532     05  BNSTATLF PIC  X(0001).
  3533     05  FILLER REDEFINES BNSTATLF.
  3534         10  BNSTATLA PIC  X(0001).
  3535     05  BNSTATLI PIC  X(0009).
  3536*    -------------------------------
  3537     05  BNSTATL PIC S9(0004) COMP.
  3538     05  BNSTATF PIC  X(0001).
  3539     05  FILLER REDEFINES BNSTATF.
  3540         10  BNSTATA PIC  X(0001).
  3541     05  BNSTATI PIC  X(0002).
  3542*    -------------------------------
  3543     05  BCHGTL PIC S9(0004) COMP.
  3544     05  BCHGTF PIC  X(0001).
  3545     05  FILLER REDEFINES BCHGTF.
  3546         10  BCHGTA PIC  X(0001).
  3547     05  BCHGTI PIC  X(0004).
  3548*    -------------------------------
  3549     05  BCHGL PIC S9(0004) COMP.
  3550     05  BCHGF PIC  X(0001).
  3551     05  FILLER REDEFINES BCHGF.
  3552         10  BCHGA PIC  X(0001).
  3553     05  BCHGI PIC  X(0004).
  3554*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  69
* EL6311.cbl
  3555     05  BCOMPIDL PIC S9(0004) COMP.
  3556     05  BCOMPIDF PIC  X(0001).
  3557     05  FILLER REDEFINES BCOMPIDF.
  3558         10  BCOMPIDA PIC  X(0001).
  3559     05  BCOMPIDI PIC  X(0003).
  3560*    -------------------------------
  3561     05  BREGIONL PIC S9(0004) COMP.
  3562     05  BREGIONF PIC  X(0001).
  3563     05  FILLER REDEFINES BREGIONF.
  3564         10  BREGIONA PIC  X(0001).
  3565     05  BREGIONI PIC  X(0006).
  3566*    -------------------------------
  3567     05  BUSERL PIC S9(0004) COMP.
  3568     05  BUSERF PIC  X(0001).
  3569     05  FILLER REDEFINES BUSERF.
  3570         10  BUSERA PIC  X(0001).
  3571     05  BUSERI PIC  X(0004).
  3572*    -------------------------------
  3573     05  BMAINTL PIC S9(0004) COMP.
  3574     05  BMAINTF PIC  X(0001).
  3575     05  FILLER REDEFINES BMAINTF.
  3576         10  BMAINTA PIC  X(0001).
  3577     05  BMAINTI PIC  X(0001).
  3578*    -------------------------------
  3579     05  BMANTBYL PIC S9(0004) COMP.
  3580     05  BMANTBYF PIC  X(0001).
  3581     05  FILLER REDEFINES BMANTBYF.
  3582         10  BMANTBYA PIC  X(0001).
  3583     05  BMANTBYI PIC  X(0004).
  3584*    -------------------------------
  3585     05  BCHGHDGL PIC S9(0004) COMP.
  3586     05  BCHGHDGF PIC  X(0001).
  3587     05  FILLER REDEFINES BCHGHDGF.
  3588         10  BCHGHDGA PIC  X(0001).
  3589     05  BCHGHDGI PIC  X(0003).
  3590*    -------------------------------
  3591     05  BMANTDTL PIC S9(0004) COMP.
  3592     05  BMANTDTF PIC  X(0001).
  3593     05  FILLER REDEFINES BMANTDTF.
  3594         10  BMANTDTA PIC  X(0001).
  3595     05  BMANTDTI PIC  X(0008).
  3596*    -------------------------------
  3597     05  BMANTATL PIC S9(0004) COMP.
  3598     05  BMANTATF PIC  X(0001).
  3599     05  FILLER REDEFINES BMANTATF.
  3600         10  BMANTATA PIC  X(0001).
  3601     05  BMANTATI PIC  X(0005).
  3602*    -------------------------------
  3603     05  BCSRL PIC S9(0004) COMP.
  3604     05  BCSRF PIC  X(0001).
  3605     05  FILLER REDEFINES BCSRF.
  3606         10  BCSRA PIC  X(0001).
  3607     05  BCSRI PIC  X(0004).
  3608*    -------------------------------
  3609     05  BBATCHL PIC S9(0004) COMP.
  3610     05  BBATCHF PIC  X(0001).
  3611     05  FILLER REDEFINES BBATCHF.
  3612         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  70
* EL6311.cbl
  3613     05  BBATCHI PIC  X(0006).
  3614*    -------------------------------
  3615     05  BSEQL PIC S9(0004) COMP.
  3616     05  BSEQF PIC  X(0001).
  3617     05  FILLER REDEFINES BSEQF.
  3618         10  BSEQA PIC  X(0001).
  3619     05  BSEQI PIC  X(0004).
  3620*    -------------------------------
  3621     05  BMOENDTL PIC S9(0004) COMP.
  3622     05  BMOENDTF PIC  X(0001).
  3623     05  FILLER REDEFINES BMOENDTF.
  3624         10  BMOENDTA PIC  X(0001).
  3625     05  BMOENDTI PIC  X(0008).
  3626*    -------------------------------
  3627     05  BCARRL PIC S9(0004) COMP.
  3628     05  BCARRF PIC  X(0001).
  3629     05  FILLER REDEFINES BCARRF.
  3630         10  BCARRA PIC  X(0001).
  3631     05  BCARRI PIC  X(0001).
  3632*    -------------------------------
  3633     05  BGROUPL PIC S9(0004) COMP.
  3634     05  BGROUPF PIC  X(0001).
  3635     05  FILLER REDEFINES BGROUPF.
  3636         10  BGROUPA PIC  X(0001).
  3637     05  BGROUPI PIC  X(0006).
  3638*    -------------------------------
  3639     05  BSTATEL PIC S9(0004) COMP.
  3640     05  BSTATEF PIC  X(0001).
  3641     05  FILLER REDEFINES BSTATEF.
  3642         10  BSTATEA PIC  X(0001).
  3643     05  BSTATEI PIC  X(0002).
  3644*    -------------------------------
  3645     05  BACCTL PIC S9(0004) COMP.
  3646     05  BACCTF PIC  X(0001).
  3647     05  FILLER REDEFINES BACCTF.
  3648         10  BACCTA PIC  X(0001).
  3649     05  BACCTI PIC  X(0010).
  3650*    -------------------------------
  3651     05  BVINHL PIC S9(0004) COMP.
  3652     05  BVINHF PIC  X(0001).
  3653     05  FILLER REDEFINES BVINHF.
  3654         10  BVINHA PIC  X(0001).
  3655     05  BVINHI PIC  X(0004).
  3656*    -------------------------------
  3657     05  BVINL PIC S9(0004) COMP.
  3658     05  BVINF PIC  X(0001).
  3659     05  FILLER REDEFINES BVINF.
  3660         10  BVINA PIC  X(0001).
  3661     05  BVINI PIC  X(0017).
  3662*    -------------------------------
  3663     05  BREFHDGL PIC S9(0004) COMP.
  3664     05  BREFHDGF PIC  X(0001).
  3665     05  FILLER REDEFINES BREFHDGF.
  3666         10  BREFHDGA PIC  X(0001).
  3667     05  BREFHDGI PIC  X(0004).
  3668*    -------------------------------
  3669     05  BREFL PIC S9(0004) COMP.
  3670     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  71
* EL6311.cbl
  3671     05  FILLER REDEFINES BREFF.
  3672         10  BREFA PIC  X(0001).
  3673     05  BREFI PIC  X(0012).
  3674*    -------------------------------
  3675     05  BAGEDEFL PIC S9(0004) COMP.
  3676     05  BAGEDEFF PIC  X(0001).
  3677     05  FILLER REDEFINES BAGEDEFF.
  3678         10  BAGEDEFA PIC  X(0001).
  3679     05  BAGEDEFI PIC  X(0004).
  3680*    -------------------------------
  3681     05  BCERTNOL PIC S9(0004) COMP.
  3682     05  BCERTNOF PIC  X(0001).
  3683     05  FILLER REDEFINES BCERTNOF.
  3684         10  BCERTNOA PIC  X(0001).
  3685     05  BCERTNOI PIC  X(0010).
  3686*    -------------------------------
  3687     05  BSUFIXL PIC S9(0004) COMP.
  3688     05  BSUFIXF PIC  X(0001).
  3689     05  FILLER REDEFINES BSUFIXF.
  3690         10  BSUFIXA PIC  X(0001).
  3691     05  BSUFIXI PIC  X(0001).
  3692*    -------------------------------
  3693     05  BEFFDTL PIC S9(0004) COMP.
  3694     05  BEFFDTF PIC  X(0001).
  3695     05  FILLER REDEFINES BEFFDTF.
  3696         10  BEFFDTA PIC  X(0001).
  3697     05  BEFFDTI PIC  X(0008).
  3698*    -------------------------------
  3699     05  BLSTNML PIC S9(0004) COMP.
  3700     05  BLSTNMF PIC  X(0001).
  3701     05  FILLER REDEFINES BLSTNMF.
  3702         10  BLSTNMA PIC  X(0001).
  3703     05  BLSTNMI PIC  X(0015).
  3704*    -------------------------------
  3705     05  B1STNML PIC S9(0004) COMP.
  3706     05  B1STNMF PIC  X(0001).
  3707     05  FILLER REDEFINES B1STNMF.
  3708         10  B1STNMA PIC  X(0001).
  3709     05  B1STNMI PIC  X(0010).
  3710*    -------------------------------
  3711     05  BINITL PIC S9(0004) COMP.
  3712     05  BINITF PIC  X(0001).
  3713     05  FILLER REDEFINES BINITF.
  3714         10  BINITA PIC  X(0001).
  3715     05  BINITI PIC  X(0001).
  3716*    -------------------------------
  3717     05  BSEXL PIC S9(0004) COMP.
  3718     05  BSEXF PIC  X(0001).
  3719     05  FILLER REDEFINES BSEXF.
  3720         10  BSEXA PIC  X(0001).
  3721     05  BSEXI PIC  X(0001).
  3722*    -------------------------------
  3723     05  BAGEL PIC S9(0004) COMP.
  3724     05  BAGEF PIC  X(0001).
  3725     05  FILLER REDEFINES BAGEF.
  3726         10  BAGEA PIC  X(0001).
  3727     05  BAGEI PIC  X(0002).
  3728*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  72
* EL6311.cbl
  3729     05  BBIRTHL PIC S9(0004) COMP.
  3730     05  BBIRTHF PIC  X(0001).
  3731     05  FILLER REDEFINES BBIRTHF.
  3732         10  BBIRTHA PIC  X(0001).
  3733     05  BBIRTHI PIC  X(0008).
  3734*    -------------------------------
  3735     05  B1STPMTL PIC S9(0004) COMP.
  3736     05  B1STPMTF PIC  X(0001).
  3737     05  FILLER REDEFINES B1STPMTF.
  3738         10  B1STPMTA PIC  X(0001).
  3739     05  B1STPMTI PIC  X(0008).
  3740*    -------------------------------
  3741     05  BDAYSL PIC S9(0004) COMP.
  3742     05  BDAYSF PIC  X(0001).
  3743     05  FILLER REDEFINES BDAYSF.
  3744         10  BDAYSA PIC  X(0001).
  3745     05  BDAYSI PIC  X(0003).
  3746*    -------------------------------
  3747     05  BLNTRML PIC S9(0004) COMP.
  3748     05  BLNTRMF PIC  X(0001).
  3749     05  FILLER REDEFINES BLNTRMF.
  3750         10  BLNTRMA PIC  X(0001).
  3751     05  BLNTRMI PIC  X(0003).
  3752*    -------------------------------
  3753     05  BLNOFCRL PIC S9(0004) COMP.
  3754     05  BLNOFCRF PIC  X(0001).
  3755     05  FILLER REDEFINES BLNOFCRF.
  3756         10  BLNOFCRA PIC  X(0001).
  3757     05  BLNOFCRI PIC  X(0005).
  3758*    -------------------------------
  3759     05  BMODEL PIC S9(0004) COMP.
  3760     05  BMODEF PIC  X(0001).
  3761     05  FILLER REDEFINES BMODEF.
  3762         10  BMODEA PIC  X(0001).
  3763     05  BMODEI PIC  X(0001).
  3764*    -------------------------------
  3765     05  BFREQL PIC S9(0004) COMP.
  3766     05  BFREQF PIC  X(0001).
  3767     05  FILLER REDEFINES BFREQF.
  3768         10  BFREQA PIC  X(0001).
  3769     05  BFREQI PIC  X(0002).
  3770*    -------------------------------
  3771     05  BPMTSL PIC S9(0004) COMP.
  3772     05  BPMTSF PIC  X(0001).
  3773     05  FILLER REDEFINES BPMTSF.
  3774         10  BPMTSA PIC  X(0001).
  3775     05  BPMTSI PIC  999.
  3776*    -------------------------------
  3777     05  BPMTAMTL PIC S9(0004) COMP.
  3778     05  BPMTAMTF PIC  X(0001).
  3779     05  FILLER REDEFINES BPMTAMTF.
  3780         10  BPMTAMTA PIC  X(0001).
  3781     05  BPMTAMTI PIC  9(7)V99.
  3782*    -------------------------------
  3783     05  BAPRL PIC S9(0004) COMP.
  3784     05  BAPRF PIC  X(0001).
  3785     05  FILLER REDEFINES BAPRF.
  3786         10  BAPRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  73
* EL6311.cbl
  3787     05  BAPRI PIC  X(7).
  3788*    -------------------------------
  3789     05  BLIVESL PIC S9(0004) COMP.
  3790     05  BLIVESF PIC  X(0001).
  3791     05  FILLER REDEFINES BLIVESF.
  3792         10  BLIVESA PIC  X(0001).
  3793     05  BLIVESI PIC  X(0009).
  3794*    -------------------------------
  3795     05  BMEMCAPL PIC S9(0004) COMP.
  3796     05  BMEMCAPF PIC  X(0001).
  3797     05  FILLER REDEFINES BMEMCAPF.
  3798         10  BMEMCAPA PIC  X(0001).
  3799     05  BMEMCAPI PIC  X(0011).
  3800*    -------------------------------
  3801     05  BORIGHDL PIC S9(0004) COMP.
  3802     05  BORIGHDF PIC  X(0001).
  3803     05  FILLER REDEFINES BORIGHDF.
  3804         10  BORIGHDA PIC  X(0001).
  3805     05  BORIGHDI PIC  X(0009).
  3806*    -------------------------------
  3807     05  DMDBILL PIC S9(0004) COMP.
  3808     05  DMDBILF PIC  X(0001).
  3809     05  FILLER REDEFINES DMDBILF.
  3810         10  DMDBILA PIC  X(0001).
  3811     05  DMDBILI PIC  X(0006).
  3812*    -------------------------------
  3813     05  BFORCEL PIC S9(0004) COMP.
  3814     05  BFORCEF PIC  X(0001).
  3815     05  FILLER REDEFINES BFORCEF.
  3816         10  BFORCEA PIC  X(0001).
  3817     05  BFORCEI PIC  X(0001).
  3818*    -------------------------------
  3819     05  BENTRYL PIC S9(0004) COMP.
  3820     05  BENTRYF PIC  X(0001).
  3821     05  FILLER REDEFINES BENTRYF.
  3822         10  BENTRYA PIC  X(0001).
  3823     05  BENTRYI PIC  X(0001).
  3824*    -------------------------------
  3825     05  BREINL PIC S9(0004) COMP.
  3826     05  BREINF PIC  X(0001).
  3827     05  FILLER REDEFINES BREINF.
  3828         10  BREINA PIC  X(0001).
  3829     05  BREINI PIC  X(0001).
  3830*    -------------------------------
  3831     05  BBILCDL PIC S9(0004) COMP.
  3832     05  BBILCDF PIC  X(0001).
  3833     05  FILLER REDEFINES BBILCDF.
  3834         10  BBILCDA PIC  X(0001).
  3835     05  BBILCDI PIC  X(0001).
  3836*    -------------------------------
  3837     05  BUNWRITL PIC S9(0004) COMP.
  3838     05  BUNWRITF PIC  X(0001).
  3839     05  FILLER REDEFINES BUNWRITF.
  3840         10  BUNWRITA PIC  X(0001).
  3841     05  BUNWRITI PIC  X(0001).
  3842*    -------------------------------
  3843     05  BSKPCDL PIC S9(0004) COMP.
  3844     05  BSKPCDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  74
* EL6311.cbl
  3845     05  FILLER REDEFINES BSKPCDF.
  3846         10  BSKPCDA PIC  X(0001).
  3847     05  BSKPCDI PIC  X(0001).
  3848*    -------------------------------
  3849     05  BINDGRPL PIC S9(0004) COMP.
  3850     05  BINDGRPF PIC  X(0001).
  3851     05  FILLER REDEFINES BINDGRPF.
  3852         10  BINDGRPA PIC  X(0001).
  3853     05  BINDGRPI PIC  X(0001).
  3854*    -------------------------------
  3855     05  BSIGL PIC S9(0004) COMP.
  3856     05  BSIGF PIC  X(0001).
  3857     05  FILLER REDEFINES BSIGF.
  3858         10  BSIGA PIC  X(0001).
  3859     05  BSIGI PIC  X(0001).
  3860*    -------------------------------
  3861     05  BRTCLSL PIC S9(0004) COMP.
  3862     05  BRTCLSF PIC  X(0001).
  3863     05  FILLER REDEFINES BRTCLSF.
  3864         10  BRTCLSA PIC  X(0001).
  3865     05  BRTCLSI PIC  X(0002).
  3866*    -------------------------------
  3867     05  BCHGCNTL PIC S9(0004) COMP.
  3868     05  BCHGCNTF PIC  X(0001).
  3869     05  FILLER REDEFINES BCHGCNTF.
  3870         10  BCHGCNTA PIC  X(0001).
  3871     05  BCHGCNTI PIC  X(0003).
  3872*    -------------------------------
  3873     05  BMEMBERL PIC S9(0004) COMP.
  3874     05  BMEMBERF PIC  X(0001).
  3875     05  FILLER REDEFINES BMEMBERF.
  3876         10  BMEMBERA PIC  X(0001).
  3877     05  BMEMBERI PIC  X(0012).
  3878*    -------------------------------
  3879     05  BORGNOL PIC S9(0004) COMP.
  3880     05  BORGNOF PIC  X(0001).
  3881     05  FILLER REDEFINES BORGNOF.
  3882         10  BORGNOA PIC  X(0001).
  3883     05  BORGNOI PIC  X(0006).
  3884*    -------------------------------
  3885     05  BORGSEQL PIC S9(0004) COMP.
  3886     05  BORGSEQF PIC  X(0001).
  3887     05  FILLER REDEFINES BORGSEQF.
  3888         10  BORGSEQA PIC  X(0001).
  3889     05  BORGSEQI PIC  X(0004).
  3890*    -------------------------------
  3891     05  BBILLEDL PIC S9(0004) COMP.
  3892     05  BBILLEDF PIC  X(0001).
  3893     05  FILLER REDEFINES BBILLEDF.
  3894         10  BBILLEDA PIC  X(0001).
  3895     05  BBILLEDI PIC  9(9).
  3896*    -------------------------------
  3897     05  BKIND1L PIC S9(0004) COMP.
  3898     05  BKIND1F PIC  X(0001).
  3899     05  FILLER REDEFINES BKIND1F.
  3900         10  BKIND1A PIC  X(0001).
  3901     05  BKIND1I PIC  X(0002).
  3902*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  75
* EL6311.cbl
  3903     05  BTYPE1L PIC S9(0004) COMP.
  3904     05  BTYPE1F PIC  X(0001).
  3905     05  FILLER REDEFINES BTYPE1F.
  3906         10  BTYPE1A PIC  X(0001).
  3907     05  BTYPE1I PIC  X(0003).
  3908*    -------------------------------
  3909     05  BTERM1L PIC S9(0004) COMP.
  3910     05  BTERM1F PIC  X(0001).
  3911     05  FILLER REDEFINES BTERM1F.
  3912         10  BTERM1A PIC  X(0001).
  3913     05  BTERM1I PIC  X(0003).
  3914*    -------------------------------
  3915     05  BBEN1L PIC S9(0004) COMP.
  3916     05  BBEN1F PIC  X(0001).
  3917     05  FILLER REDEFINES BBEN1F.
  3918         10  BBEN1A PIC  X(0001).
  3919     05  BBEN1I PIC  X(0012).
  3920*    -------------------------------
  3921     05  BPREM1L PIC S9(0004) COMP.
  3922     05  BPREM1F PIC  X(0001).
  3923     05  FILLER REDEFINES BPREM1F.
  3924         10  BPREM1A PIC  X(0001).
  3925     05  BPREM1I PIC  X(0011).
  3926*    -------------------------------
  3927     05  BEXPIR1L PIC S9(0004) COMP.
  3928     05  BEXPIR1F PIC  X(0001).
  3929     05  FILLER REDEFINES BEXPIR1F.
  3930         10  BEXPIR1A PIC  X(0001).
  3931     05  BEXPIR1I PIC  X(0008).
  3932*    -------------------------------
  3933     05  BCP1L PIC S9(0004) COMP.
  3934     05  BCP1F PIC  X(0001).
  3935     05  FILLER REDEFINES BCP1F.
  3936         10  BCP1A PIC  X(0001).
  3937     05  BCP1I PIC  X(0002).
  3938*    -------------------------------
  3939     05  BALTBN1L PIC S9(0004) COMP.
  3940     05  BALTBN1F PIC  X(0001).
  3941     05  FILLER REDEFINES BALTBN1F.
  3942         10  BALTBN1A PIC  X(0001).
  3943     05  BALTBN1I PIC  X(0012).
  3944*    -------------------------------
  3945     05  BALTPR1L PIC S9(0004) COMP.
  3946     05  BALTPR1F PIC  X(0001).
  3947     05  FILLER REDEFINES BALTPR1F.
  3948         10  BALTPR1A PIC  X(0001).
  3949     05  BALTPR1I PIC  X(0011).
  3950*    -------------------------------
  3951     05  BBNCD1L PIC S9(0004) COMP.
  3952     05  BBNCD1F PIC  X(0001).
  3953     05  FILLER REDEFINES BBNCD1F.
  3954         10  BBNCD1A PIC  X(0001).
  3955     05  BBNCD1I PIC  X(0003).
  3956*    -------------------------------
  3957     05  BCPRM1L PIC S9(0004) COMP.
  3958     05  BCPRM1F PIC  X(0001).
  3959     05  FILLER REDEFINES BCPRM1F.
  3960         10  BCPRM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  76
* EL6311.cbl
  3961     05  BCPRM1I PIC  X(0011).
  3962*    -------------------------------
  3963     05  BCAPRM1L PIC S9(0004) COMP.
  3964     05  BCAPRM1F PIC  X(0001).
  3965     05  FILLER REDEFINES BCAPRM1F.
  3966         10  BCAPRM1A PIC  X(0001).
  3967     05  BCAPRM1I PIC  X(0011).
  3968*    -------------------------------
  3969     05  BENABR1L PIC S9(0004) COMP.
  3970     05  BENABR1F PIC  X(0001).
  3971     05  FILLER REDEFINES BENABR1F.
  3972         10  BENABR1A PIC  X(0001).
  3973     05  BENABR1I PIC  X(0005).
  3974*    -------------------------------
  3975     05  BDIFF1L PIC S9(0004) COMP.
  3976     05  BDIFF1F PIC  X(0001).
  3977     05  FILLER REDEFINES BDIFF1F.
  3978         10  BDIFF1A PIC  X(0001).
  3979     05  BDIFF1I PIC  X(0011).
  3980*    -------------------------------
  3981     05  BBILIT1L PIC S9(0004) COMP.
  3982     05  BBILIT1F PIC  X(0001).
  3983     05  FILLER REDEFINES BBILIT1F.
  3984         10  BBILIT1A PIC  X(0001).
  3985     05  BBILIT1I PIC  X(0008).
  3986*    -------------------------------
  3987     05  BADIFF1L PIC S9(0004) COMP.
  3988     05  BADIFF1F PIC  X(0001).
  3989     05  FILLER REDEFINES BADIFF1F.
  3990         10  BADIFF1A PIC  X(0001).
  3991     05  BADIFF1I PIC  X(0011).
  3992*    -------------------------------
  3993     05  BKIND2L PIC S9(0004) COMP.
  3994     05  BKIND2F PIC  X(0001).
  3995     05  FILLER REDEFINES BKIND2F.
  3996         10  BKIND2A PIC  X(0001).
  3997     05  BKIND2I PIC  X(0002).
  3998*    -------------------------------
  3999     05  BTYPE2L PIC S9(0004) COMP.
  4000     05  BTYPE2F PIC  X(0001).
  4001     05  FILLER REDEFINES BTYPE2F.
  4002         10  BTYPE2A PIC  X(0001).
  4003     05  BTYPE2I PIC  X(0003).
  4004*    -------------------------------
  4005     05  BTERM2L PIC S9(0004) COMP.
  4006     05  BTERM2F PIC  X(0001).
  4007     05  FILLER REDEFINES BTERM2F.
  4008         10  BTERM2A PIC  X(0001).
  4009     05  BTERM2I PIC  X(0003).
  4010*    -------------------------------
  4011     05  BBEN2L PIC S9(0004) COMP.
  4012     05  BBEN2F PIC  X(0001).
  4013     05  FILLER REDEFINES BBEN2F.
  4014         10  BBEN2A PIC  X(0001).
  4015     05  BBEN2I PIC  X(0012).
  4016*    -------------------------------
  4017     05  BPREM2L PIC S9(0004) COMP.
  4018     05  BPREM2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  77
* EL6311.cbl
  4019     05  FILLER REDEFINES BPREM2F.
  4020         10  BPREM2A PIC  X(0001).
  4021     05  BPREM2I PIC  X(0011).
  4022*    -------------------------------
  4023     05  BEXPIR2L PIC S9(0004) COMP.
  4024     05  BEXPIR2F PIC  X(0001).
  4025     05  FILLER REDEFINES BEXPIR2F.
  4026         10  BEXPIR2A PIC  X(0001).
  4027     05  BEXPIR2I PIC  X(0008).
  4028*    -------------------------------
  4029     05  BCP2L PIC S9(0004) COMP.
  4030     05  BCP2F PIC  X(0001).
  4031     05  FILLER REDEFINES BCP2F.
  4032         10  BCP2A PIC  X(0001).
  4033     05  BCP2I PIC  X(0002).
  4034*    -------------------------------
  4035     05  BALTBN2L PIC S9(0004) COMP.
  4036     05  BALTBN2F PIC  X(0001).
  4037     05  FILLER REDEFINES BALTBN2F.
  4038         10  BALTBN2A PIC  X(0001).
  4039     05  BALTBN2I PIC  X(0012).
  4040*    -------------------------------
  4041     05  BALTPR2L PIC S9(0004) COMP.
  4042     05  BALTPR2F PIC  X(0001).
  4043     05  FILLER REDEFINES BALTPR2F.
  4044         10  BALTPR2A PIC  X(0001).
  4045     05  BALTPR2I PIC  X(0011).
  4046*    -------------------------------
  4047     05  BBNCD2L PIC S9(0004) COMP.
  4048     05  BBNCD2F PIC  X(0001).
  4049     05  FILLER REDEFINES BBNCD2F.
  4050         10  BBNCD2A PIC  X(0001).
  4051     05  BBNCD2I PIC  X(0003).
  4052*    -------------------------------
  4053     05  BCPRM2L PIC S9(0004) COMP.
  4054     05  BCPRM2F PIC  X(0001).
  4055     05  FILLER REDEFINES BCPRM2F.
  4056         10  BCPRM2A PIC  X(0001).
  4057     05  BCPRM2I PIC  X(0011).
  4058*    -------------------------------
  4059     05  BCAPRM2L PIC S9(0004) COMP.
  4060     05  BCAPRM2F PIC  X(0001).
  4061     05  FILLER REDEFINES BCAPRM2F.
  4062         10  BCAPRM2A PIC  X(0001).
  4063     05  BCAPRM2I PIC  X(0011).
  4064*    -------------------------------
  4065     05  BENABR2L PIC S9(0004) COMP.
  4066     05  BENABR2F PIC  X(0001).
  4067     05  FILLER REDEFINES BENABR2F.
  4068         10  BENABR2A PIC  X(0001).
  4069     05  BENABR2I PIC  X(0005).
  4070*    -------------------------------
  4071     05  BDIFF2L PIC S9(0004) COMP.
  4072     05  BDIFF2F PIC  X(0001).
  4073     05  FILLER REDEFINES BDIFF2F.
  4074         10  BDIFF2A PIC  X(0001).
  4075     05  BDIFF2I PIC  X(0011).
  4076*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  78
* EL6311.cbl
  4077     05  BBILIT2L PIC S9(0004) COMP.
  4078     05  BBILIT2F PIC  X(0001).
  4079     05  FILLER REDEFINES BBILIT2F.
  4080         10  BBILIT2A PIC  X(0001).
  4081     05  BBILIT2I PIC  X(0008).
  4082*    -------------------------------
  4083     05  BADIFF2L PIC S9(0004) COMP.
  4084     05  BADIFF2F PIC  X(0001).
  4085     05  FILLER REDEFINES BADIFF2F.
  4086         10  BADIFF2A PIC  X(0001).
  4087     05  BADIFF2I PIC  X(0011).
  4088*    -------------------------------
  4089     05  BERMSG1L PIC S9(0004) COMP.
  4090     05  BERMSG1F PIC  X(0001).
  4091     05  FILLER REDEFINES BERMSG1F.
  4092         10  BERMSG1A PIC  X(0001).
  4093     05  BERMSG1I PIC  X(0078).
  4094*    -------------------------------
  4095     05  BERMSG2L PIC S9(0004) COMP.
  4096     05  BERMSG2F PIC  X(0001).
  4097     05  FILLER REDEFINES BERMSG2F.
  4098         10  BERMSG2A PIC  X(0001).
  4099     05  BERMSG2I PIC  X(0078).
  4100*    -------------------------------
  4101     05  BERMSG3L PIC S9(0004) COMP.
  4102     05  BERMSG3F PIC  X(0001).
  4103     05  FILLER REDEFINES BERMSG3F.
  4104         10  BERMSG3A PIC  X(0001).
  4105     05  BERMSG3I PIC  X(0078).
  4106*    -------------------------------
  4107     05  BPFENTRL PIC S9(0004) COMP.
  4108     05  BPFENTRF PIC  X(0001).
  4109     05  FILLER REDEFINES BPFENTRF.
  4110         10  BPFENTRA PIC  X(0001).
  4111     05  BPFENTRI PIC  9(2).
  4112*    -------------------------------
  4113     05  BPF5HDRL PIC S9(0004) COMP.
  4114     05  BPF5HDRF PIC  X(0001).
  4115     05  FILLER REDEFINES BPF5HDRF.
  4116         10  BPF5HDRA PIC  X(0001).
  4117     05  BPF5HDRI PIC  X(0005).
  4118*    -------------------------------
  4119     05  BPF4HDRL PIC S9(0004) COMP.
  4120     05  BPF4HDRF PIC  X(0001).
  4121     05  FILLER REDEFINES BPF4HDRF.
  4122         10  BPF4HDRA PIC  X(0001).
  4123     05  BPF4HDRI PIC  X(0013).
  4124*    -------------------------------
  4125     05  BF15HDRL PIC S9(0004) COMP.
  4126     05  BF15HDRF PIC  X(0001).
  4127     05  FILLER REDEFINES BF15HDRF.
  4128         10  BF15HDRA PIC  X(0001).
  4129     05  BF15HDRI PIC  X(0010).
  4130 01  EL631BO REDEFINES EL631BI.
  4131     05  FILLER            PIC  X(0012).
  4132*    -------------------------------
  4133     05  FILLER            PIC  X(0003).
  4134     05  BDATEO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  79
* EL6311.cbl
  4135*    -------------------------------
  4136     05  FILLER            PIC  X(0003).
  4137     05  BTIMEO PIC  99.99.
  4138*    -------------------------------
  4139     05  FILLER            PIC  X(0003).
  4140     05  BHEADO PIC  X(0038).
  4141*    -------------------------------
  4142     05  FILLER            PIC  X(0003).
  4143     05  BNCERTLO PIC  X(0008).
  4144*    -------------------------------
  4145     05  FILLER            PIC  X(0003).
  4146     05  BNCERTO PIC  X(0011).
  4147*    -------------------------------
  4148     05  FILLER            PIC  X(0003).
  4149     05  BNSTATLO PIC  X(0009).
  4150*    -------------------------------
  4151     05  FILLER            PIC  X(0003).
  4152     05  BNSTATO PIC  X(0002).
  4153*    -------------------------------
  4154     05  FILLER            PIC  X(0003).
  4155     05  BCHGTO PIC  X(0004).
  4156*    -------------------------------
  4157     05  FILLER            PIC  X(0003).
  4158     05  BCHGO PIC  ZZZ9.
  4159*    -------------------------------
  4160     05  FILLER            PIC  X(0003).
  4161     05  BCOMPIDO PIC  X(0003).
  4162*    -------------------------------
  4163     05  FILLER            PIC  X(0003).
  4164     05  BREGIONO PIC  X(0006).
  4165*    -------------------------------
  4166     05  FILLER            PIC  X(0003).
  4167     05  BUSERO PIC  X(0004).
  4168*    -------------------------------
  4169     05  FILLER            PIC  X(0003).
  4170     05  BMAINTO PIC  X(0001).
  4171*    -------------------------------
  4172     05  FILLER            PIC  X(0003).
  4173     05  BMANTBYO PIC  X(0004).
  4174*    -------------------------------
  4175     05  FILLER            PIC  X(0003).
  4176     05  BCHGHDGO PIC  X(0003).
  4177*    -------------------------------
  4178     05  FILLER            PIC  X(0003).
  4179     05  BMANTDTO PIC  X(0008).
  4180*    -------------------------------
  4181     05  FILLER            PIC  X(0003).
  4182     05  BMANTATO PIC  99.99.
  4183*    -------------------------------
  4184     05  FILLER            PIC  X(0003).
  4185     05  BCSRO PIC  X(0004).
  4186*    -------------------------------
  4187     05  FILLER            PIC  X(0003).
  4188     05  BBATCHO PIC  X(0006).
  4189*    -------------------------------
  4190     05  FILLER            PIC  X(0003).
  4191     05  BSEQO PIC  X(0004).
  4192*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  80
* EL6311.cbl
  4193     05  FILLER            PIC  X(0003).
  4194     05  BMOENDTO PIC  X(0008).
  4195*    -------------------------------
  4196     05  FILLER            PIC  X(0003).
  4197     05  BCARRO PIC  X(0001).
  4198*    -------------------------------
  4199     05  FILLER            PIC  X(0003).
  4200     05  BGROUPO PIC  X(0006).
  4201*    -------------------------------
  4202     05  FILLER            PIC  X(0003).
  4203     05  BSTATEO PIC  X(0002).
  4204*    -------------------------------
  4205     05  FILLER            PIC  X(0003).
  4206     05  BACCTO PIC  X(0010).
  4207*    -------------------------------
  4208     05  FILLER            PIC  X(0003).
  4209     05  BVINHO PIC  X(0004).
  4210*    -------------------------------
  4211     05  FILLER            PIC  X(0003).
  4212     05  BVINO PIC  X(0017).
  4213*    -------------------------------
  4214     05  FILLER            PIC  X(0003).
  4215     05  BREFHDGO PIC  X(0004).
  4216*    -------------------------------
  4217     05  FILLER            PIC  X(0003).
  4218     05  BREFO PIC  X(0012).
  4219*    -------------------------------
  4220     05  FILLER            PIC  X(0003).
  4221     05  BAGEDEFO PIC  X(0004).
  4222*    -------------------------------
  4223     05  FILLER            PIC  X(0003).
  4224     05  BCERTNOO PIC  X(0010).
  4225*    -------------------------------
  4226     05  FILLER            PIC  X(0003).
  4227     05  BSUFIXO PIC  X(0001).
  4228*    -------------------------------
  4229     05  FILLER            PIC  X(0003).
  4230     05  BEFFDTO PIC  X(0008).
  4231*    -------------------------------
  4232     05  FILLER            PIC  X(0003).
  4233     05  BLSTNMO PIC  X(0015).
  4234*    -------------------------------
  4235     05  FILLER            PIC  X(0003).
  4236     05  B1STNMO PIC  X(0010).
  4237*    -------------------------------
  4238     05  FILLER            PIC  X(0003).
  4239     05  BINITO PIC  X(0001).
  4240*    -------------------------------
  4241     05  FILLER            PIC  X(0003).
  4242     05  BSEXO PIC  X(0001).
  4243*    -------------------------------
  4244     05  FILLER            PIC  X(0003).
  4245     05  BAGEO PIC  X(0002).
  4246*    -------------------------------
  4247     05  FILLER            PIC  X(0003).
  4248     05  BBIRTHO PIC  X(0008).
  4249*    -------------------------------
  4250     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  81
* EL6311.cbl
  4251     05  B1STPMTO PIC  X(0008).
  4252*    -------------------------------
  4253     05  FILLER            PIC  X(0003).
  4254     05  BDAYSO PIC  X(0003).
  4255*    -------------------------------
  4256     05  FILLER            PIC  X(0003).
  4257     05  BLNTRMO PIC  X(0003).
  4258*    -------------------------------
  4259     05  FILLER            PIC  X(0003).
  4260     05  BLNOFCRO PIC  X(0005).
  4261*    -------------------------------
  4262     05  FILLER            PIC  X(0003).
  4263     05  BMODEO PIC  X(0001).
  4264*    -------------------------------
  4265     05  FILLER            PIC  X(0003).
  4266     05  BFREQO PIC  X(0002).
  4267*    -------------------------------
  4268     05  FILLER            PIC  X(0003).
  4269     05  BPMTSO PIC  X(0003).
  4270*    -------------------------------
  4271     05  FILLER            PIC  X(0003).
  4272     05  BPMTAMTO PIC  ZZZZZ9.99.
  4273*    -------------------------------
  4274     05  FILLER            PIC  X(0003).
  4275     05  BAPRO PIC  99.9999.
  4276*    -------------------------------
  4277     05  FILLER            PIC  X(0003).
  4278     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4279*    -------------------------------
  4280     05  FILLER            PIC  X(0003).
  4281     05  BMEMCAPO PIC  X(0011).
  4282*    -------------------------------
  4283     05  FILLER            PIC  X(0003).
  4284     05  BORIGHDO PIC  X(0009).
  4285*    -------------------------------
  4286     05  FILLER            PIC  X(0003).
  4287     05  DMDBILO PIC  X(0006).
  4288*    -------------------------------
  4289     05  FILLER            PIC  X(0003).
  4290     05  BFORCEO PIC  X(0001).
  4291*    -------------------------------
  4292     05  FILLER            PIC  X(0003).
  4293     05  BENTRYO PIC  X(0001).
  4294*    -------------------------------
  4295     05  FILLER            PIC  X(0003).
  4296     05  BREINO PIC  X(0001).
  4297*    -------------------------------
  4298     05  FILLER            PIC  X(0003).
  4299     05  BBILCDO PIC  X(0001).
  4300*    -------------------------------
  4301     05  FILLER            PIC  X(0003).
  4302     05  BUNWRITO PIC  X(0001).
  4303*    -------------------------------
  4304     05  FILLER            PIC  X(0003).
  4305     05  BSKPCDO PIC  X(0001).
  4306*    -------------------------------
  4307     05  FILLER            PIC  X(0003).
  4308     05  BINDGRPO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  82
* EL6311.cbl
  4309*    -------------------------------
  4310     05  FILLER            PIC  X(0003).
  4311     05  BSIGO PIC  X(0001).
  4312*    -------------------------------
  4313     05  FILLER            PIC  X(0003).
  4314     05  BRTCLSO PIC  X(0002).
  4315*    -------------------------------
  4316     05  FILLER            PIC  X(0003).
  4317     05  BCHGCNTO PIC  X(0003).
  4318*    -------------------------------
  4319     05  FILLER            PIC  X(0003).
  4320     05  BMEMBERO PIC  X(0012).
  4321*    -------------------------------
  4322     05  FILLER            PIC  X(0003).
  4323     05  BORGNOO PIC  X(0006).
  4324*    -------------------------------
  4325     05  FILLER            PIC  X(0003).
  4326     05  BORGSEQO PIC  X(0004).
  4327*    -------------------------------
  4328     05  FILLER            PIC  X(0003).
  4329     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4330*    -------------------------------
  4331     05  FILLER            PIC  X(0003).
  4332     05  BKIND1O PIC  X(0002).
  4333*    -------------------------------
  4334     05  FILLER            PIC  X(0003).
  4335     05  BTYPE1O PIC  X(0003).
  4336*    -------------------------------
  4337     05  FILLER            PIC  X(0003).
  4338     05  BTERM1O PIC  X(0003).
  4339*    -------------------------------
  4340     05  FILLER            PIC  X(0003).
  4341     05  BBEN1O PIC  X(0012).
  4342*    -------------------------------
  4343     05  FILLER            PIC  X(0003).
  4344     05  BPREM1O PIC  X(0011).
  4345*    -------------------------------
  4346     05  FILLER            PIC  X(0003).
  4347     05  BEXPIR1O PIC  X(0008).
  4348*    -------------------------------
  4349     05  FILLER            PIC  X(0003).
  4350     05  BCP1O PIC  X(0002).
  4351*    -------------------------------
  4352     05  FILLER            PIC  X(0003).
  4353     05  BALTBN1O PIC  X(0012).
  4354*    -------------------------------
  4355     05  FILLER            PIC  X(0003).
  4356     05  BALTPR1O PIC  X(0011).
  4357*    -------------------------------
  4358     05  FILLER            PIC  X(0003).
  4359     05  BBNCD1O PIC  X(0003).
  4360*    -------------------------------
  4361     05  FILLER            PIC  X(0003).
  4362     05  BCPRM1O PIC  X(0011).
  4363*    -------------------------------
  4364     05  FILLER            PIC  X(0003).
  4365     05  BCAPRM1O PIC  X(0011).
  4366*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  83
* EL6311.cbl
  4367     05  FILLER            PIC  X(0003).
  4368     05  BENABR1O PIC  X(0005).
  4369*    -------------------------------
  4370     05  FILLER            PIC  X(0003).
  4371     05  BDIFF1O PIC  X(0011).
  4372*    -------------------------------
  4373     05  FILLER            PIC  X(0003).
  4374     05  BBILIT1O PIC  X(0008).
  4375*    -------------------------------
  4376     05  FILLER            PIC  X(0003).
  4377     05  BADIFF1O PIC  X(0011).
  4378*    -------------------------------
  4379     05  FILLER            PIC  X(0003).
  4380     05  BKIND2O PIC  X(0002).
  4381*    -------------------------------
  4382     05  FILLER            PIC  X(0003).
  4383     05  BTYPE2O PIC  X(0003).
  4384*    -------------------------------
  4385     05  FILLER            PIC  X(0003).
  4386     05  BTERM2O PIC  X(0003).
  4387*    -------------------------------
  4388     05  FILLER            PIC  X(0003).
  4389     05  BBEN2O PIC  X(0012).
  4390*    -------------------------------
  4391     05  FILLER            PIC  X(0003).
  4392     05  BPREM2O PIC  X(0011).
  4393*    -------------------------------
  4394     05  FILLER            PIC  X(0003).
  4395     05  BEXPIR2O PIC  X(0008).
  4396*    -------------------------------
  4397     05  FILLER            PIC  X(0003).
  4398     05  BCP2O PIC  X(0002).
  4399*    -------------------------------
  4400     05  FILLER            PIC  X(0003).
  4401     05  BALTBN2O PIC  X(0012).
  4402*    -------------------------------
  4403     05  FILLER            PIC  X(0003).
  4404     05  BALTPR2O PIC  X(0011).
  4405*    -------------------------------
  4406     05  FILLER            PIC  X(0003).
  4407     05  BBNCD2O PIC  X(0003).
  4408*    -------------------------------
  4409     05  FILLER            PIC  X(0003).
  4410     05  BCPRM2O PIC  X(0011).
  4411*    -------------------------------
  4412     05  FILLER            PIC  X(0003).
  4413     05  BCAPRM2O PIC  X(0011).
  4414*    -------------------------------
  4415     05  FILLER            PIC  X(0003).
  4416     05  BENABR2O PIC  X(0005).
  4417*    -------------------------------
  4418     05  FILLER            PIC  X(0003).
  4419     05  BDIFF2O PIC  X(0011).
  4420*    -------------------------------
  4421     05  FILLER            PIC  X(0003).
  4422     05  BBILIT2O PIC  X(0008).
  4423*    -------------------------------
  4424     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  84
* EL6311.cbl
  4425     05  BADIFF2O PIC  X(0011).
  4426*    -------------------------------
  4427     05  FILLER            PIC  X(0003).
  4428     05  BERMSG1O PIC  X(0078).
  4429*    -------------------------------
  4430     05  FILLER            PIC  X(0003).
  4431     05  BERMSG2O PIC  X(0078).
  4432*    -------------------------------
  4433     05  FILLER            PIC  X(0003).
  4434     05  BERMSG3O PIC  X(0078).
  4435*    -------------------------------
  4436     05  FILLER            PIC  X(0003).
  4437     05  BPFENTRO PIC  X(0002).
  4438*    -------------------------------
  4439     05  FILLER            PIC  X(0003).
  4440     05  BPF5HDRO PIC  X(0005).
  4441*    -------------------------------
  4442     05  FILLER            PIC  X(0003).
  4443     05  BPF4HDRO PIC  X(0013).
  4444*    -------------------------------
  4445     05  FILLER            PIC  X(0003).
  4446     05  BF15HDRO PIC  X(0010).
  4447*    -------------------------------
  4448 01  EL631CI REDEFINES EL631BI.
  4449     05  FILLER            PIC  X(0012).
  4450*    -------------------------------
  4451     05  CDATEL PIC S9(0004) COMP.
  4452     05  CDATEF PIC  X(0001).
  4453     05  FILLER REDEFINES CDATEF.
  4454         10  CDATEA PIC  X(0001).
  4455     05  CDATEI PIC  X(0008).
  4456*    -------------------------------
  4457     05  CTIMEL PIC S9(0004) COMP.
  4458     05  CTIMEF PIC  X(0001).
  4459     05  FILLER REDEFINES CTIMEF.
  4460         10  CTIMEA PIC  X(0001).
  4461     05  CTIMEI PIC  X(0005).
  4462*    -------------------------------
  4463     05  CHEADL PIC S9(0004) COMP.
  4464     05  CHEADF PIC  X(0001).
  4465     05  FILLER REDEFINES CHEADF.
  4466         10  CHEADA PIC  X(0001).
  4467     05  CHEADI PIC  X(0038).
  4468*    -------------------------------
  4469     05  CCHGTL PIC S9(0004) COMP.
  4470     05  CCHGTF PIC  X(0001).
  4471     05  FILLER REDEFINES CCHGTF.
  4472         10  CCHGTA PIC  X(0001).
  4473     05  CCHGTI PIC  X(0004).
  4474*    -------------------------------
  4475     05  CCHGL PIC S9(0004) COMP.
  4476     05  CCHGF PIC  X(0001).
  4477     05  FILLER REDEFINES CCHGF.
  4478         10  CCHGA PIC  X(0001).
  4479     05  CCHGI PIC  X(0004).
  4480*    -------------------------------
  4481     05  CMAINTL PIC S9(0004) COMP.
  4482     05  CMAINTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  85
* EL6311.cbl
  4483     05  FILLER REDEFINES CMAINTF.
  4484         10  CMAINTA PIC  X(0001).
  4485     05  CMAINTI PIC  X(0001).
  4486*    -------------------------------
  4487     05  CMANTBYL PIC S9(0004) COMP.
  4488     05  CMANTBYF PIC  X(0001).
  4489     05  FILLER REDEFINES CMANTBYF.
  4490         10  CMANTBYA PIC  X(0001).
  4491     05  CMANTBYI PIC  X(0004).
  4492*    -------------------------------
  4493     05  CCHGHDGL PIC S9(0004) COMP.
  4494     05  CCHGHDGF PIC  X(0001).
  4495     05  FILLER REDEFINES CCHGHDGF.
  4496         10  CCHGHDGA PIC  X(0001).
  4497     05  CCHGHDGI PIC  X(0003).
  4498*    -------------------------------
  4499     05  CMANTDTL PIC S9(0004) COMP.
  4500     05  CMANTDTF PIC  X(0001).
  4501     05  FILLER REDEFINES CMANTDTF.
  4502         10  CMANTDTA PIC  X(0001).
  4503     05  CMANTDTI PIC  X(0008).
  4504*    -------------------------------
  4505     05  CMANTATL PIC S9(0004) COMP.
  4506     05  CMANTATF PIC  X(0001).
  4507     05  FILLER REDEFINES CMANTATF.
  4508         10  CMANTATA PIC  X(0001).
  4509     05  CMANTATI PIC  X(0005).
  4510*    -------------------------------
  4511     05  CCSRL PIC S9(0004) COMP.
  4512     05  CCSRF PIC  X(0001).
  4513     05  FILLER REDEFINES CCSRF.
  4514         10  CCSRA PIC  X(0001).
  4515     05  CCSRI PIC  X(0004).
  4516*    -------------------------------
  4517     05  CBATCHL PIC S9(0004) COMP.
  4518     05  CBATCHF PIC  X(0001).
  4519     05  FILLER REDEFINES CBATCHF.
  4520         10  CBATCHA PIC  X(0001).
  4521     05  CBATCHI PIC  X(0006).
  4522*    -------------------------------
  4523     05  CSEQL PIC S9(0004) COMP.
  4524     05  CSEQF PIC  X(0001).
  4525     05  FILLER REDEFINES CSEQF.
  4526         10  CSEQA PIC  X(0001).
  4527     05  CSEQI PIC  X(0004).
  4528*    -------------------------------
  4529     05  CMOENDTL PIC S9(0004) COMP.
  4530     05  CMOENDTF PIC  X(0001).
  4531     05  FILLER REDEFINES CMOENDTF.
  4532         10  CMOENDTA PIC  X(0001).
  4533     05  CMOENDTI PIC  X(0008).
  4534*    -------------------------------
  4535     05  CCARRL PIC S9(0004) COMP.
  4536     05  CCARRF PIC  X(0001).
  4537     05  FILLER REDEFINES CCARRF.
  4538         10  CCARRA PIC  X(0001).
  4539     05  CCARRI PIC  X(0001).
  4540*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  86
* EL6311.cbl
  4541     05  CGROUPL PIC S9(0004) COMP.
  4542     05  CGROUPF PIC  X(0001).
  4543     05  FILLER REDEFINES CGROUPF.
  4544         10  CGROUPA PIC  X(0001).
  4545     05  CGROUPI PIC  X(0006).
  4546*    -------------------------------
  4547     05  CSTATEL PIC S9(0004) COMP.
  4548     05  CSTATEF PIC  X(0001).
  4549     05  FILLER REDEFINES CSTATEF.
  4550         10  CSTATEA PIC  X(0001).
  4551     05  CSTATEI PIC  X(0002).
  4552*    -------------------------------
  4553     05  CACCTL PIC S9(0004) COMP.
  4554     05  CACCTF PIC  X(0001).
  4555     05  FILLER REDEFINES CACCTF.
  4556         10  CACCTA PIC  X(0001).
  4557     05  CACCTI PIC  X(0010).
  4558*    -------------------------------
  4559     05  CORIGHDL PIC S9(0004) COMP.
  4560     05  CORIGHDF PIC  X(0001).
  4561     05  FILLER REDEFINES CORIGHDF.
  4562         10  CORIGHDA PIC  X(0001).
  4563     05  CORIGHDI PIC  X(0011).
  4564*    -------------------------------
  4565     05  CORGNOL PIC S9(0004) COMP.
  4566     05  CORGNOF PIC  X(0001).
  4567     05  FILLER REDEFINES CORGNOF.
  4568         10  CORGNOA PIC  X(0001).
  4569     05  CORGNOI PIC  X(0006).
  4570*    -------------------------------
  4571     05  CORGSEQL PIC S9(0004) COMP.
  4572     05  CORGSEQF PIC  X(0001).
  4573     05  FILLER REDEFINES CORGSEQF.
  4574         10  CORGSEQA PIC  X(0001).
  4575     05  CORGSEQI PIC  X(0004).
  4576*    -------------------------------
  4577     05  CREFHDGL PIC S9(0004) COMP.
  4578     05  CREFHDGF PIC  X(0001).
  4579     05  FILLER REDEFINES CREFHDGF.
  4580         10  CREFHDGA PIC  X(0001).
  4581     05  CREFHDGI PIC  X(0010).
  4582*    -------------------------------
  4583     05  CREFL PIC S9(0004) COMP.
  4584     05  CREFF PIC  X(0001).
  4585     05  FILLER REDEFINES CREFF.
  4586         10  CREFA PIC  X(0001).
  4587     05  CREFI PIC  X(0012).
  4588*    -------------------------------
  4589     05  CNHINTL PIC S9(0004) COMP.
  4590     05  CNHINTF PIC  X(0001).
  4591     05  FILLER REDEFINES CNHINTF.
  4592         10  CNHINTA PIC  X(0001).
  4593     05  CNHINTI PIC  9(7)V99.
  4594*    -------------------------------
  4595     05  CCERTNOL PIC S9(0004) COMP.
  4596     05  CCERTNOF PIC  X(0001).
  4597     05  FILLER REDEFINES CCERTNOF.
  4598         10  CCERTNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  87
* EL6311.cbl
  4599     05  CCERTNOI PIC  X(0010).
  4600*    -------------------------------
  4601     05  CSUFIXL PIC S9(0004) COMP.
  4602     05  CSUFIXF PIC  X(0001).
  4603     05  FILLER REDEFINES CSUFIXF.
  4604         10  CSUFIXA PIC  X(0001).
  4605     05  CSUFIXI PIC  X(0001).
  4606*    -------------------------------
  4607     05  CEFFDTL PIC S9(0004) COMP.
  4608     05  CEFFDTF PIC  X(0001).
  4609     05  FILLER REDEFINES CEFFDTF.
  4610         10  CEFFDTA PIC  X(0001).
  4611     05  CEFFDTI PIC  X(0008).
  4612*    -------------------------------
  4613     05  CLSTNML PIC S9(0004) COMP.
  4614     05  CLSTNMF PIC  X(0001).
  4615     05  FILLER REDEFINES CLSTNMF.
  4616         10  CLSTNMA PIC  X(0001).
  4617     05  CLSTNMI PIC  X(0015).
  4618*    -------------------------------
  4619     05  CPCYNL PIC S9(0004) COMP.
  4620     05  CPCYNF PIC  X(0001).
  4621     05  FILLER REDEFINES CPCYNF.
  4622         10  CPCYNA PIC  X(0001).
  4623     05  CPCYNI PIC  X(0001).
  4624*    -------------------------------
  4625     05  CINAMEL PIC S9(0004) COMP.
  4626     05  CINAMEF PIC  X(0001).
  4627     05  FILLER REDEFINES CINAMEF.
  4628         10  CINAMEA PIC  X(0001).
  4629     05  CINAMEI PIC  X(0015).
  4630*    -------------------------------
  4631     05  CINITSL PIC S9(0004) COMP.
  4632     05  CINITSF PIC  X(0001).
  4633     05  FILLER REDEFINES CINITSF.
  4634         10  CINITSA PIC  X(0001).
  4635     05  CINITSI PIC  X(0010).
  4636*    -------------------------------
  4637     05  CCANREAL PIC S9(0004) COMP.
  4638     05  CCANREAF PIC  X(0001).
  4639     05  FILLER REDEFINES CCANREAF.
  4640         10  CCANREAA PIC  X(0001).
  4641     05  CCANREAI PIC  X(0001).
  4642*    -------------------------------
  4643     05  ACTSPCL PIC S9(0004) COMP.
  4644     05  ACTSPCF PIC  X(0001).
  4645     05  FILLER REDEFINES ACTSPCF.
  4646         10  ACTSPCA PIC  X(0001).
  4647     05  ACTSPCI PIC  X(0001).
  4648*    -------------------------------
  4649     05  CKIND1L PIC S9(0004) COMP.
  4650     05  CKIND1F PIC  X(0001).
  4651     05  FILLER REDEFINES CKIND1F.
  4652         10  CKIND1A PIC  X(0001).
  4653     05  CKIND1I PIC  X(0002).
  4654*    -------------------------------
  4655     05  CCANDT1L PIC S9(0004) COMP.
  4656     05  CCANDT1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  88
* EL6311.cbl
  4657     05  FILLER REDEFINES CCANDT1F.
  4658         10  CCANDT1A PIC  X(0001).
  4659     05  CCANDT1I PIC  X(0008).
  4660*    -------------------------------
  4661     05  CREFND1L PIC S9(0004) COMP.
  4662     05  CREFND1F PIC  X(0001).
  4663     05  FILLER REDEFINES CREFND1F.
  4664         10  CREFND1A PIC  X(0001).
  4665     05  CREFND1I PIC  S9(9)V99.
  4666*    -------------------------------
  4667     05  CMTHD1L PIC S9(0004) COMP.
  4668     05  CMTHD1F PIC  X(0001).
  4669     05  FILLER REDEFINES CMTHD1F.
  4670         10  CMTHD1A PIC  X(0001).
  4671     05  CMTHD1I PIC  X(0001).
  4672*    -------------------------------
  4673     05  CKIND2L PIC S9(0004) COMP.
  4674     05  CKIND2F PIC  X(0001).
  4675     05  FILLER REDEFINES CKIND2F.
  4676         10  CKIND2A PIC  X(0001).
  4677     05  CKIND2I PIC  X(0002).
  4678*    -------------------------------
  4679     05  CCANDT2L PIC S9(0004) COMP.
  4680     05  CCANDT2F PIC  X(0001).
  4681     05  FILLER REDEFINES CCANDT2F.
  4682         10  CCANDT2A PIC  X(0001).
  4683     05  CCANDT2I PIC  X(0008).
  4684*    -------------------------------
  4685     05  CREFND2L PIC S9(0004) COMP.
  4686     05  CREFND2F PIC  X(0001).
  4687     05  FILLER REDEFINES CREFND2F.
  4688         10  CREFND2A PIC  X(0001).
  4689     05  CREFND2I PIC  S9(9)V99.
  4690*    -------------------------------
  4691     05  CMTHD2L PIC S9(0004) COMP.
  4692     05  CMTHD2F PIC  X(0001).
  4693     05  FILLER REDEFINES CMTHD2F.
  4694         10  CMTHD2A PIC  X(0001).
  4695     05  CMTHD2I PIC  X(0001).
  4696*    -------------------------------
  4697     05  CLIVESL PIC S9(0004) COMP.
  4698     05  CLIVESF PIC  X(0001).
  4699     05  FILLER REDEFINES CLIVESF.
  4700         10  CLIVESA PIC  X(0001).
  4701     05  CLIVESI PIC  X(0003).
  4702*    -------------------------------
  4703     05  CFORCEL PIC S9(0004) COMP.
  4704     05  CFORCEF PIC  X(0001).
  4705     05  FILLER REDEFINES CFORCEF.
  4706         10  CFORCEA PIC  X(0001).
  4707     05  CFORCEI PIC  X(0001).
  4708*    -------------------------------
  4709     05  CBILCDL PIC S9(0004) COMP.
  4710     05  CBILCDF PIC  X(0001).
  4711     05  FILLER REDEFINES CBILCDF.
  4712         10  CBILCDA PIC  X(0001).
  4713     05  CBILCDI PIC  X(0001).
  4714*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  89
* EL6311.cbl
  4715     05  CCRFND1L PIC S9(0004) COMP.
  4716     05  CCRFND1F PIC  X(0001).
  4717     05  FILLER REDEFINES CCRFND1F.
  4718         10  CCRFND1A PIC  X(0001).
  4719     05  CCRFND1I PIC  X(0011).
  4720*    -------------------------------
  4721     05  CCRFND2L PIC S9(0004) COMP.
  4722     05  CCRFND2F PIC  X(0001).
  4723     05  FILLER REDEFINES CCRFND2F.
  4724         10  CCRFND2A PIC  X(0001).
  4725     05  CCRFND2I PIC  X(0011).
  4726*    -------------------------------
  4727     05  CBILIT1L PIC S9(0004) COMP.
  4728     05  CBILIT1F PIC  X(0001).
  4729     05  FILLER REDEFINES CBILIT1F.
  4730         10  CBILIT1A PIC  X(0001).
  4731     05  CBILIT1I PIC  X(0008).
  4732*    -------------------------------
  4733     05  CDRFND1L PIC S9(0004) COMP.
  4734     05  CDRFND1F PIC  X(0001).
  4735     05  FILLER REDEFINES CDRFND1F.
  4736         10  CDRFND1A PIC  X(0001).
  4737     05  CDRFND1I PIC  X(0011).
  4738*    -------------------------------
  4739     05  CBILIT2L PIC S9(0004) COMP.
  4740     05  CBILIT2F PIC  X(0001).
  4741     05  FILLER REDEFINES CBILIT2F.
  4742         10  CBILIT2A PIC  X(0001).
  4743     05  CBILIT2I PIC  X(0008).
  4744*    -------------------------------
  4745     05  CDRFND2L PIC S9(0004) COMP.
  4746     05  CDRFND2F PIC  X(0001).
  4747     05  FILLER REDEFINES CDRFND2F.
  4748         10  CDRFND2A PIC  X(0001).
  4749     05  CDRFND2I PIC  X(0011).
  4750*    -------------------------------
  4751     05  CCANTXTL PIC S9(0004) COMP.
  4752     05  CCANTXTF PIC  X(0001).
  4753     05  FILLER REDEFINES CCANTXTF.
  4754         10  CCANTXTA PIC  X(0001).
  4755     05  CCANTXTI PIC  X(0005).
  4756*    -------------------------------
  4757     05  CCANFEEL PIC S9(0004) COMP.
  4758     05  CCANFEEF PIC  X(0001).
  4759     05  FILLER REDEFINES CCANFEEF.
  4760         10  CCANFEEA PIC  X(0001).
  4761     05  CCANFEEI PIC  X(0002).
  4762*    -------------------------------
  4763     05  CTERM1L PIC S9(0004) COMP.
  4764     05  CTERM1F PIC  X(0001).
  4765     05  FILLER REDEFINES CTERM1F.
  4766         10  CTERM1A PIC  X(0001).
  4767     05  CTERM1I PIC  X(0003).
  4768*    -------------------------------
  4769     05  CRTERM1L PIC S9(0004) COMP.
  4770     05  CRTERM1F PIC  X(0001).
  4771     05  FILLER REDEFINES CRTERM1F.
  4772         10  CRTERM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  90
* EL6311.cbl
  4773     05  CRTERM1I PIC  X(0003).
  4774*    -------------------------------
  4775     05  CPREM1L PIC S9(0004) COMP.
  4776     05  CPREM1F PIC  X(0001).
  4777     05  FILLER REDEFINES CPREM1F.
  4778         10  CPREM1A PIC  X(0001).
  4779     05  CPREM1I PIC  X(0011).
  4780*    -------------------------------
  4781     05  CTERM2L PIC S9(0004) COMP.
  4782     05  CTERM2F PIC  X(0001).
  4783     05  FILLER REDEFINES CTERM2F.
  4784         10  CTERM2A PIC  X(0001).
  4785     05  CTERM2I PIC  X(0003).
  4786*    -------------------------------
  4787     05  CRTERM2L PIC S9(0004) COMP.
  4788     05  CRTERM2F PIC  X(0001).
  4789     05  FILLER REDEFINES CRTERM2F.
  4790         10  CRTERM2A PIC  X(0001).
  4791     05  CRTERM2I PIC  X(0003).
  4792*    -------------------------------
  4793     05  CPREM2L PIC S9(0004) COMP.
  4794     05  CPREM2F PIC  X(0001).
  4795     05  FILLER REDEFINES CPREM2F.
  4796         10  CPREM2A PIC  X(0001).
  4797     05  CPREM2I PIC  X(0011).
  4798*    -------------------------------
  4799     05  CENTRDTL PIC S9(0004) COMP.
  4800     05  CENTRDTF PIC  X(0001).
  4801     05  FILLER REDEFINES CENTRDTF.
  4802         10  CENTRDTA PIC  X(0001).
  4803     05  CENTRDTI PIC  X(0008).
  4804*    -------------------------------
  4805     05  CPAYEEL PIC S9(0004) COMP.
  4806     05  CPAYEEF PIC  X(0001).
  4807     05  FILLER REDEFINES CPAYEEF.
  4808         10  CPAYEEA PIC  X(0001).
  4809     05  CPAYEEI PIC  X(0006).
  4810*    -------------------------------
  4811     05  CRFNDSWL PIC S9(0004) COMP.
  4812     05  CRFNDSWF PIC  X(0001).
  4813     05  FILLER REDEFINES CRFNDSWF.
  4814         10  CRFNDSWA PIC  X(0001).
  4815     05  CRFNDSWI PIC  X(0003).
  4816*    -------------------------------
  4817     05  CLFHDGL PIC S9(0004) COMP.
  4818     05  CLFHDGF PIC  X(0001).
  4819     05  FILLER REDEFINES CLFHDGF.
  4820         10  CLFHDGA PIC  X(0001).
  4821     05  CLFHDGI PIC  X(0006).
  4822*    -------------------------------
  4823     05  CAHHDGL PIC S9(0004) COMP.
  4824     05  CAHHDGF PIC  X(0001).
  4825     05  FILLER REDEFINES CAHHDGF.
  4826         10  CAHHDGA PIC  X(0001).
  4827     05  CAHHDGI PIC  X(0006).
  4828*    -------------------------------
  4829     05  CENTDTL PIC S9(0004) COMP.
  4830     05  CENTDTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  91
* EL6311.cbl
  4831     05  FILLER REDEFINES CENTDTF.
  4832         10  CENTDTA PIC  X(0001).
  4833     05  CENTDTI PIC  X(0008).
  4834*    -------------------------------
  4835     05  CENTBYL PIC S9(0004) COMP.
  4836     05  CENTBYF PIC  X(0001).
  4837     05  FILLER REDEFINES CENTBYF.
  4838         10  CENTBYA PIC  X(0001).
  4839     05  CENTBYI PIC  X(0004).
  4840*    -------------------------------
  4841     05  CCHGCNTL PIC S9(0004) COMP.
  4842     05  CCHGCNTF PIC  X(0001).
  4843     05  FILLER REDEFINES CCHGCNTF.
  4844         10  CCHGCNTA PIC  X(0001).
  4845     05  CCHGCNTI PIC  X(0003).
  4846*    -------------------------------
  4847     05  CLFREFNL PIC S9(0004) COMP.
  4848     05  CLFREFNF PIC  X(0001).
  4849     05  FILLER REDEFINES CLFREFNF.
  4850         10  CLFREFNA PIC  X(0001).
  4851     05  CLFREFNI PIC  X(0006).
  4852*    -------------------------------
  4853     05  CAHREFNL PIC S9(0004) COMP.
  4854     05  CAHREFNF PIC  X(0001).
  4855     05  FILLER REDEFINES CAHREFNF.
  4856         10  CAHREFNA PIC  X(0001).
  4857     05  CAHREFNI PIC  X(0006).
  4858*    -------------------------------
  4859     05  CREINCDL PIC S9(0004) COMP.
  4860     05  CREINCDF PIC  X(0001).
  4861     05  FILLER REDEFINES CREINCDF.
  4862         10  CREINCDA PIC  X(0001).
  4863     05  CREINCDI PIC  X(0003).
  4864*    -------------------------------
  4865     05  CAEFFDTL PIC S9(0004) COMP.
  4866     05  CAEFFDTF PIC  X(0001).
  4867     05  FILLER REDEFINES CAEFFDTF.
  4868         10  CAEFFDTA PIC  X(0001).
  4869     05  CAEFFDTI PIC  X(0008).
  4870*    -------------------------------
  4871     05  CAEXPDTL PIC S9(0004) COMP.
  4872     05  CAEXPDTF PIC  X(0001).
  4873     05  FILLER REDEFINES CAEXPDTF.
  4874         10  CAEXPDTA PIC  X(0001).
  4875     05  CAEXPDTI PIC  X(0008).
  4876*    -------------------------------
  4877     05  COMMLFL PIC S9(0004) COMP.
  4878     05  COMMLFF PIC  X(0001).
  4879     05  FILLER REDEFINES COMMLFF.
  4880         10  COMMLFA PIC  X(0001).
  4881     05  COMMLFI PIC  X(0006).
  4882*    -------------------------------
  4883     05  COMMAHL PIC S9(0004) COMP.
  4884     05  COMMAHF PIC  X(0001).
  4885     05  FILLER REDEFINES COMMAHF.
  4886         10  COMMAHA PIC  X(0001).
  4887     05  COMMAHI PIC  X(0006).
  4888*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  92
* EL6311.cbl
  4889     05  CERMSG1L PIC S9(0004) COMP.
  4890     05  CERMSG1F PIC  X(0001).
  4891     05  FILLER REDEFINES CERMSG1F.
  4892         10  CERMSG1A PIC  X(0001).
  4893     05  CERMSG1I PIC  X(0078).
  4894*    -------------------------------
  4895     05  CERMSG2L PIC S9(0004) COMP.
  4896     05  CERMSG2F PIC  X(0001).
  4897     05  FILLER REDEFINES CERMSG2F.
  4898         10  CERMSG2A PIC  X(0001).
  4899     05  CERMSG2I PIC  X(0078).
  4900*    -------------------------------
  4901     05  CERMSG3L PIC S9(0004) COMP.
  4902     05  CERMSG3F PIC  X(0001).
  4903     05  FILLER REDEFINES CERMSG3F.
  4904         10  CERMSG3A PIC  X(0001).
  4905     05  CERMSG3I PIC  X(0078).
  4906*    -------------------------------
  4907     05  CPFENTRL PIC S9(0004) COMP.
  4908     05  CPFENTRF PIC  X(0001).
  4909     05  FILLER REDEFINES CPFENTRF.
  4910         10  CPFENTRA PIC  X(0001).
  4911     05  CPFENTRI PIC  9(2).
  4912*    -------------------------------
  4913     05  CPF5HDRL PIC S9(0004) COMP.
  4914     05  CPF5HDRF PIC  X(0001).
  4915     05  FILLER REDEFINES CPF5HDRF.
  4916         10  CPF5HDRA PIC  X(0001).
  4917     05  CPF5HDRI PIC  X(0005).
  4918*    -------------------------------
  4919     05  CPF4HDRL PIC S9(0004) COMP.
  4920     05  CPF4HDRF PIC  X(0001).
  4921     05  FILLER REDEFINES CPF4HDRF.
  4922         10  CPF4HDRA PIC  X(0001).
  4923     05  CPF4HDRI PIC  X(0013).
  4924*    -------------------------------
  4925     05  CF15HDRL PIC S9(0004) COMP.
  4926     05  CF15HDRF PIC  X(0001).
  4927     05  FILLER REDEFINES CF15HDRF.
  4928         10  CF15HDRA PIC  X(0001).
  4929     05  CF15HDRI PIC  X(0022).
  4930 01  EL631CO REDEFINES EL631BI.
  4931     05  FILLER            PIC  X(0012).
  4932*    -------------------------------
  4933     05  FILLER            PIC  X(0003).
  4934     05  CDATEO PIC  X(0008).
  4935*    -------------------------------
  4936     05  FILLER            PIC  X(0003).
  4937     05  CTIMEO PIC  99.99.
  4938*    -------------------------------
  4939     05  FILLER            PIC  X(0003).
  4940     05  CHEADO PIC  X(0038).
  4941*    -------------------------------
  4942     05  FILLER            PIC  X(0003).
  4943     05  CCHGTO PIC  X(0004).
  4944*    -------------------------------
  4945     05  FILLER            PIC  X(0003).
  4946     05  CCHGO PIC  ZZZ9.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  93
* EL6311.cbl
  4947*    -------------------------------
  4948     05  FILLER            PIC  X(0003).
  4949     05  CMAINTO PIC  X(0001).
  4950*    -------------------------------
  4951     05  FILLER            PIC  X(0003).
  4952     05  CMANTBYO PIC  X(0004).
  4953*    -------------------------------
  4954     05  FILLER            PIC  X(0003).
  4955     05  CCHGHDGO PIC  X(0003).
  4956*    -------------------------------
  4957     05  FILLER            PIC  X(0003).
  4958     05  CMANTDTO PIC  X(0008).
  4959*    -------------------------------
  4960     05  FILLER            PIC  X(0003).
  4961     05  CMANTATO PIC  99.99.
  4962*    -------------------------------
  4963     05  FILLER            PIC  X(0003).
  4964     05  CCSRO PIC  X(0004).
  4965*    -------------------------------
  4966     05  FILLER            PIC  X(0003).
  4967     05  CBATCHO PIC  X(0006).
  4968*    -------------------------------
  4969     05  FILLER            PIC  X(0003).
  4970     05  CSEQO PIC  X(0004).
  4971*    -------------------------------
  4972     05  FILLER            PIC  X(0003).
  4973     05  CMOENDTO PIC  X(0008).
  4974*    -------------------------------
  4975     05  FILLER            PIC  X(0003).
  4976     05  CCARRO PIC  X(0001).
  4977*    -------------------------------
  4978     05  FILLER            PIC  X(0003).
  4979     05  CGROUPO PIC  X(0006).
  4980*    -------------------------------
  4981     05  FILLER            PIC  X(0003).
  4982     05  CSTATEO PIC  X(0002).
  4983*    -------------------------------
  4984     05  FILLER            PIC  X(0003).
  4985     05  CACCTO PIC  X(0010).
  4986*    -------------------------------
  4987     05  FILLER            PIC  X(0003).
  4988     05  CORIGHDO PIC  X(0011).
  4989*    -------------------------------
  4990     05  FILLER            PIC  X(0003).
  4991     05  CORGNOO PIC  X(0006).
  4992*    -------------------------------
  4993     05  FILLER            PIC  X(0003).
  4994     05  CORGSEQO PIC  X(0004).
  4995*    -------------------------------
  4996     05  FILLER            PIC  X(0003).
  4997     05  CREFHDGO PIC  X(0010).
  4998*    -------------------------------
  4999     05  FILLER            PIC  X(0003).
  5000     05  CREFO PIC  X(0012).
  5001*    -------------------------------
  5002     05  FILLER            PIC  X(0003).
  5003     05  CNHINTO PIC  ZZZZZ9.99.
  5004*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  94
* EL6311.cbl
  5005     05  FILLER            PIC  X(0003).
  5006     05  CCERTNOO PIC  X(0010).
  5007*    -------------------------------
  5008     05  FILLER            PIC  X(0003).
  5009     05  CSUFIXO PIC  X(0001).
  5010*    -------------------------------
  5011     05  FILLER            PIC  X(0003).
  5012     05  CEFFDTO PIC  X(0008).
  5013*    -------------------------------
  5014     05  FILLER            PIC  X(0003).
  5015     05  CLSTNMO PIC  X(0015).
  5016*    -------------------------------
  5017     05  FILLER            PIC  X(0003).
  5018     05  CPCYNO PIC  X(0001).
  5019*    -------------------------------
  5020     05  FILLER            PIC  X(0003).
  5021     05  CINAMEO PIC  X(0015).
  5022*    -------------------------------
  5023     05  FILLER            PIC  X(0003).
  5024     05  CINITSO PIC  X(0010).
  5025*    -------------------------------
  5026     05  FILLER            PIC  X(0003).
  5027     05  CCANREAO PIC  X(0001).
  5028*    -------------------------------
  5029     05  FILLER            PIC  X(0003).
  5030     05  ACTSPCO PIC  X(0001).
  5031*    -------------------------------
  5032     05  FILLER            PIC  X(0003).
  5033     05  CKIND1O PIC  X(0002).
  5034*    -------------------------------
  5035     05  FILLER            PIC  X(0003).
  5036     05  CCANDT1O PIC  X(0008).
  5037*    -------------------------------
  5038     05  FILLER            PIC  X(0003).
  5039     05  CREFND1O PIC  Z(7).99-.
  5040*    -------------------------------
  5041     05  FILLER            PIC  X(0003).
  5042     05  CMTHD1O PIC  X(0001).
  5043*    -------------------------------
  5044     05  FILLER            PIC  X(0003).
  5045     05  CKIND2O PIC  X(0002).
  5046*    -------------------------------
  5047     05  FILLER            PIC  X(0003).
  5048     05  CCANDT2O PIC  X(0008).
  5049*    -------------------------------
  5050     05  FILLER            PIC  X(0003).
  5051     05  CREFND2O PIC  Z(7).99-.
  5052*    -------------------------------
  5053     05  FILLER            PIC  X(0003).
  5054     05  CMTHD2O PIC  X(0001).
  5055*    -------------------------------
  5056     05  FILLER            PIC  X(0003).
  5057     05  CLIVESO PIC  X(0003).
  5058*    -------------------------------
  5059     05  FILLER            PIC  X(0003).
  5060     05  CFORCEO PIC  X(0001).
  5061*    -------------------------------
  5062     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  95
* EL6311.cbl
  5063     05  CBILCDO PIC  X(0001).
  5064*    -------------------------------
  5065     05  FILLER            PIC  X(0003).
  5066     05  CCRFND1O PIC  Z(7).99-.
  5067*    -------------------------------
  5068     05  FILLER            PIC  X(0003).
  5069     05  CCRFND2O PIC  Z(7).99-.
  5070*    -------------------------------
  5071     05  FILLER            PIC  X(0003).
  5072     05  CBILIT1O PIC  X(0008).
  5073*    -------------------------------
  5074     05  FILLER            PIC  X(0003).
  5075     05  CDRFND1O PIC  Z(7).99-.
  5076*    -------------------------------
  5077     05  FILLER            PIC  X(0003).
  5078     05  CBILIT2O PIC  X(0008).
  5079*    -------------------------------
  5080     05  FILLER            PIC  X(0003).
  5081     05  CDRFND2O PIC  Z(7).99-.
  5082*    -------------------------------
  5083     05  FILLER            PIC  X(0003).
  5084     05  CCANTXTO PIC  X(0005).
  5085*    -------------------------------
  5086     05  FILLER            PIC  X(0003).
  5087     05  CCANFEEO PIC  Z9.
  5088*    -------------------------------
  5089     05  FILLER            PIC  X(0003).
  5090     05  CTERM1O PIC  ZZ9.
  5091*    -------------------------------
  5092     05  FILLER            PIC  X(0003).
  5093     05  CRTERM1O PIC  ZZ9.
  5094*    -------------------------------
  5095     05  FILLER            PIC  X(0003).
  5096     05  CPREM1O PIC  ZZZZZZ9.99-.
  5097*    -------------------------------
  5098     05  FILLER            PIC  X(0003).
  5099     05  CTERM2O PIC  ZZ9.
  5100*    -------------------------------
  5101     05  FILLER            PIC  X(0003).
  5102     05  CRTERM2O PIC  ZZ9.
  5103*    -------------------------------
  5104     05  FILLER            PIC  X(0003).
  5105     05  CPREM2O PIC  ZZZZZZ9.99-.
  5106*    -------------------------------
  5107     05  FILLER            PIC  X(0003).
  5108     05  CENTRDTO PIC  X(0008).
  5109*    -------------------------------
  5110     05  FILLER            PIC  X(0003).
  5111     05  CPAYEEO PIC  X(0006).
  5112*    -------------------------------
  5113     05  FILLER            PIC  X(0003).
  5114     05  CRFNDSWO PIC  X(0003).
  5115*    -------------------------------
  5116     05  FILLER            PIC  X(0003).
  5117     05  CLFHDGO PIC  X(0006).
  5118*    -------------------------------
  5119     05  FILLER            PIC  X(0003).
  5120     05  CAHHDGO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  96
* EL6311.cbl
  5121*    -------------------------------
  5122     05  FILLER            PIC  X(0003).
  5123     05  CENTDTO PIC  X(0008).
  5124*    -------------------------------
  5125     05  FILLER            PIC  X(0003).
  5126     05  CENTBYO PIC  X(0004).
  5127*    -------------------------------
  5128     05  FILLER            PIC  X(0003).
  5129     05  CCHGCNTO PIC  X(0003).
  5130*    -------------------------------
  5131     05  FILLER            PIC  X(0003).
  5132     05  CLFREFNO PIC  X(0006).
  5133*    -------------------------------
  5134     05  FILLER            PIC  X(0003).
  5135     05  CAHREFNO PIC  X(0006).
  5136*    -------------------------------
  5137     05  FILLER            PIC  X(0003).
  5138     05  CREINCDO PIC  X(0003).
  5139*    -------------------------------
  5140     05  FILLER            PIC  X(0003).
  5141     05  CAEFFDTO PIC  X(0008).
  5142*    -------------------------------
  5143     05  FILLER            PIC  X(0003).
  5144     05  CAEXPDTO PIC  X(0008).
  5145*    -------------------------------
  5146     05  FILLER            PIC  X(0003).
  5147     05  COMMLFO PIC  .99999.
  5148*    -------------------------------
  5149     05  FILLER            PIC  X(0003).
  5150     05  COMMAHO PIC  .99999.
  5151*    -------------------------------
  5152     05  FILLER            PIC  X(0003).
  5153     05  CERMSG1O PIC  X(0078).
  5154*    -------------------------------
  5155     05  FILLER            PIC  X(0003).
  5156     05  CERMSG2O PIC  X(0078).
  5157*    -------------------------------
  5158     05  FILLER            PIC  X(0003).
  5159     05  CERMSG3O PIC  X(0078).
  5160*    -------------------------------
  5161     05  FILLER            PIC  X(0003).
  5162     05  CPFENTRO PIC  X(0002).
  5163*    -------------------------------
  5164     05  FILLER            PIC  X(0003).
  5165     05  CPF5HDRO PIC  X(0005).
  5166*    -------------------------------
  5167     05  FILLER            PIC  X(0003).
  5168     05  CPF4HDRO PIC  X(0013).
  5169*    -------------------------------
  5170     05  FILLER            PIC  X(0003).
  5171     05  CF15HDRO PIC  X(0022).
  5172*    -------------------------------
  5173 01  EL631DI REDEFINES EL631BI.
  5174     05  FILLER            PIC  X(0012).
  5175*    -------------------------------
  5176     05  DDATEL PIC S9(0004) COMP.
  5177     05  DDATEF PIC  X(0001).
  5178     05  FILLER REDEFINES DDATEF.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  97
* EL6311.cbl
  5179         10  DDATEA PIC  X(0001).
  5180     05  DDATEI PIC  X(0008).
  5181*    -------------------------------
  5182     05  DTIMEL PIC S9(0004) COMP.
  5183     05  DTIMEF PIC  X(0001).
  5184     05  FILLER REDEFINES DTIMEF.
  5185         10  DTIMEA PIC  X(0001).
  5186     05  DTIMEI PIC  X(0005).
  5187*    -------------------------------
  5188     05  DHEADL PIC S9(0004) COMP.
  5189     05  DHEADF PIC  X(0001).
  5190     05  FILLER REDEFINES DHEADF.
  5191         10  DHEADA PIC  X(0001).
  5192     05  DHEADI PIC  X(0038).
  5193*    -------------------------------
  5194     05  DLDATEL PIC S9(0004) COMP.
  5195     05  DLDATEF PIC  X(0001).
  5196     05  FILLER REDEFINES DLDATEF.
  5197         10  DLDATEA PIC  X(0001).
  5198     05  DLDATEI PIC  X(0010).
  5199*    -------------------------------
  5200     05  DBATCHL PIC S9(0004) COMP.
  5201     05  DBATCHF PIC  X(0001).
  5202     05  FILLER REDEFINES DBATCHF.
  5203         10  DBATCHA PIC  X(0001).
  5204     05  DBATCHI PIC  X(0011).
  5205*    -------------------------------
  5206     05  DACCTNML PIC S9(0004) COMP.
  5207     05  DACCTNMF PIC  X(0001).
  5208     05  FILLER REDEFINES DACCTNMF.
  5209         10  DACCTNMA PIC  X(0001).
  5210     05  DACCTNMI PIC  X(0030).
  5211*    -------------------------------
  5212     05  DPROCDTL PIC S9(0004) COMP.
  5213     05  DPROCDTF PIC  X(0001).
  5214     05  FILLER REDEFINES DPROCDTF.
  5215         10  DPROCDTA PIC  X(0001).
  5216     05  DPROCDTI PIC  X(0008).
  5217*    -------------------------------
  5218     05  DINPUTL PIC S9(0004) COMP.
  5219     05  DINPUTF PIC  X(0001).
  5220     05  FILLER REDEFINES DINPUTF.
  5221         10  DINPUTA PIC  X(0001).
  5222     05  DINPUTI PIC  X(0008).
  5223*    -------------------------------
  5224     05  DMAINDTL PIC S9(0004) COMP.
  5225     05  DMAINDTF PIC  X(0001).
  5226     05  FILLER REDEFINES DMAINDTF.
  5227         10  DMAINDTA PIC  X(0001).
  5228     05  DMAINDTI PIC  X(0008).
  5229*    -------------------------------
  5230     05  DCARRL PIC S9(0004) COMP.
  5231     05  DCARRF PIC  X(0001).
  5232     05  FILLER REDEFINES DCARRF.
  5233         10  DCARRA PIC  X(0001).
  5234     05  DCARRI PIC  X(0001).
  5235*    -------------------------------
  5236     05  DGROUPL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  98
* EL6311.cbl
  5237     05  DGROUPF PIC  X(0001).
  5238     05  FILLER REDEFINES DGROUPF.
  5239         10  DGROUPA PIC  X(0001).
  5240     05  DGROUPI PIC  X(0006).
  5241*    -------------------------------
  5242     05  DSTATEL PIC S9(0004) COMP.
  5243     05  DSTATEF PIC  X(0001).
  5244     05  FILLER REDEFINES DSTATEF.
  5245         10  DSTATEA PIC  X(0001).
  5246     05  DSTATEI PIC  X(0002).
  5247*    -------------------------------
  5248     05  DACCTL PIC S9(0004) COMP.
  5249     05  DACCTF PIC  X(0001).
  5250     05  FILLER REDEFINES DACCTF.
  5251         10  DACCTA PIC  X(0001).
  5252     05  DACCTI PIC  X(0010).
  5253*    -------------------------------
  5254     05  DRECVDTL PIC S9(0004) COMP.
  5255     05  DRECVDTF PIC  X(0001).
  5256     05  FILLER REDEFINES DRECVDTF.
  5257         10  DRECVDTA PIC  X(0001).
  5258     05  DRECVDTI PIC  X(0008).
  5259*    -------------------------------
  5260     05  DCSRL PIC S9(0004) COMP.
  5261     05  DCSRF PIC  X(0001).
  5262     05  FILLER REDEFINES DCSRF.
  5263         10  DCSRA PIC  X(0001).
  5264     05  DCSRI PIC  X(0004).
  5265*    -------------------------------
  5266     05  DREFHDGL PIC S9(0004) COMP.
  5267     05  DREFHDGF PIC  X(0001).
  5268     05  FILLER REDEFINES DREFHDGF.
  5269         10  DREFHDGA PIC  X(0001).
  5270     05  DREFHDGI PIC  X(0010).
  5271*    -------------------------------
  5272     05  DREFL PIC S9(0004) COMP.
  5273     05  DREFF PIC  X(0001).
  5274     05  FILLER REDEFINES DREFF.
  5275         10  DREFA PIC  X(0001).
  5276     05  DREFI PIC  X(0012).
  5277*    -------------------------------
  5278     05  DLFPHDGL PIC S9(0004) COMP.
  5279     05  DLFPHDGF PIC  X(0001).
  5280     05  FILLER REDEFINES DLFPHDGF.
  5281         10  DLFPHDGA PIC  X(0001).
  5282     05  DLFPHDGI PIC  X(0010).
  5283*    -------------------------------
  5284     05  DAHPHDGL PIC S9(0004) COMP.
  5285     05  DAHPHDGF PIC  X(0001).
  5286     05  FILLER REDEFINES DAHPHDGF.
  5287         10  DAHPHDGA PIC  X(0001).
  5288     05  DAHPHDGI PIC  X(0010).
  5289*    -------------------------------
  5290     05  DLFRHDGL PIC S9(0004) COMP.
  5291     05  DLFRHDGF PIC  X(0001).
  5292     05  FILLER REDEFINES DLFRHDGF.
  5293         10  DLFRHDGA PIC  X(0001).
  5294     05  DLFRHDGI PIC  X(0009).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  99
* EL6311.cbl
  5295*    -------------------------------
  5296     05  DAHRHDGL PIC S9(0004) COMP.
  5297     05  DAHRHDGF PIC  X(0001).
  5298     05  FILLER REDEFINES DAHRHDGF.
  5299         10  DAHRHDGA PIC  X(0001).
  5300     05  DAHRHDGI PIC  X(0009).
  5301*    -------------------------------
  5302     05  DRISSL PIC S9(0004) COMP.
  5303     05  DRISSF PIC  X(0001).
  5304     05  FILLER REDEFINES DRISSF.
  5305         10  DRISSA PIC  X(0001).
  5306     05  DRISSI PIC  X(0005).
  5307*    -------------------------------
  5308     05  DRLFPRML PIC S9(0004) COMP.
  5309     05  DRLFPRMF PIC  X(0001).
  5310     05  FILLER REDEFINES DRLFPRMF.
  5311         10  DRLFPRMA PIC  X(0001).
  5312     05  DRLFPRMI PIC  S9(9)V99.
  5313*    -------------------------------
  5314     05  DRAHPRML PIC S9(0004) COMP.
  5315     05  DRAHPRMF PIC  X(0001).
  5316     05  FILLER REDEFINES DRAHPRMF.
  5317         10  DRAHPRMA PIC  X(0001).
  5318     05  DRAHPRMI PIC  S9(9)V99.
  5319*    -------------------------------
  5320     05  DRCANCL PIC S9(0004) COMP.
  5321     05  DRCANCF PIC  X(0001).
  5322     05  FILLER REDEFINES DRCANCF.
  5323         10  DRCANCA PIC  X(0001).
  5324     05  DRCANCI PIC  X(0005).
  5325*    -------------------------------
  5326     05  DRLFRFDL PIC S9(0004) COMP.
  5327     05  DRLFRFDF PIC  X(0001).
  5328     05  FILLER REDEFINES DRLFRFDF.
  5329         10  DRLFRFDA PIC  X(0001).
  5330     05  DRLFRFDI PIC  S9(9)V99.
  5331*    -------------------------------
  5332     05  DRAHRFDL PIC S9(0004) COMP.
  5333     05  DRAHRFDF PIC  X(0001).
  5334     05  FILLER REDEFINES DRAHRFDF.
  5335         10  DRAHRFDA PIC  X(0001).
  5336     05  DRAHRFDI PIC  S9(9)V99.
  5337*    -------------------------------
  5338     05  DEISSL PIC S9(0004) COMP.
  5339     05  DEISSF PIC  X(0001).
  5340     05  FILLER REDEFINES DEISSF.
  5341         10  DEISSA PIC  X(0001).
  5342     05  DEISSI PIC  X(0005).
  5343*    -------------------------------
  5344     05  DELFPRML PIC S9(0004) COMP.
  5345     05  DELFPRMF PIC  X(0001).
  5346     05  FILLER REDEFINES DELFPRMF.
  5347         10  DELFPRMA PIC  X(0001).
  5348     05  DELFPRMI PIC  X(0011).
  5349*    -------------------------------
  5350     05  DEAHPRML PIC S9(0004) COMP.
  5351     05  DEAHPRMF PIC  X(0001).
  5352     05  FILLER REDEFINES DEAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 100
* EL6311.cbl
  5353         10  DEAHPRMA PIC  X(0001).
  5354     05  DEAHPRMI PIC  X(0011).
  5355*    -------------------------------
  5356     05  DECANCL PIC S9(0004) COMP.
  5357     05  DECANCF PIC  X(0001).
  5358     05  FILLER REDEFINES DECANCF.
  5359         10  DECANCA PIC  X(0001).
  5360     05  DECANCI PIC  X(0005).
  5361*    -------------------------------
  5362     05  DELFRFDL PIC S9(0004) COMP.
  5363     05  DELFRFDF PIC  X(0001).
  5364     05  FILLER REDEFINES DELFRFDF.
  5365         10  DELFRFDA PIC  X(0001).
  5366     05  DELFRFDI PIC  X(0011).
  5367*    -------------------------------
  5368     05  DEAHRFDL PIC S9(0004) COMP.
  5369     05  DEAHRFDF PIC  X(0001).
  5370     05  FILLER REDEFINES DEAHRFDF.
  5371         10  DEAHRFDA PIC  X(0001).
  5372     05  DEAHRFDI PIC  X(0011).
  5373*    -------------------------------
  5374     05  DCISSL PIC S9(0004) COMP.
  5375     05  DCISSF PIC  X(0001).
  5376     05  FILLER REDEFINES DCISSF.
  5377         10  DCISSA PIC  X(0001).
  5378     05  DCISSI PIC  X(0005).
  5379*    -------------------------------
  5380     05  DCLFPRML PIC S9(0004) COMP.
  5381     05  DCLFPRMF PIC  X(0001).
  5382     05  FILLER REDEFINES DCLFPRMF.
  5383         10  DCLFPRMA PIC  X(0001).
  5384     05  DCLFPRMI PIC  X(0011).
  5385*    -------------------------------
  5386     05  DCAHPRML PIC S9(0004) COMP.
  5387     05  DCAHPRMF PIC  X(0001).
  5388     05  FILLER REDEFINES DCAHPRMF.
  5389         10  DCAHPRMA PIC  X(0001).
  5390     05  DCAHPRMI PIC  X(0011).
  5391*    -------------------------------
  5392     05  DCCANCL PIC S9(0004) COMP.
  5393     05  DCCANCF PIC  X(0001).
  5394     05  FILLER REDEFINES DCCANCF.
  5395         10  DCCANCA PIC  X(0001).
  5396     05  DCCANCI PIC  X(0005).
  5397*    -------------------------------
  5398     05  DCLFRFDL PIC S9(0004) COMP.
  5399     05  DCLFRFDF PIC  X(0001).
  5400     05  FILLER REDEFINES DCLFRFDF.
  5401         10  DCLFRFDA PIC  X(0001).
  5402     05  DCLFRFDI PIC  X(0011).
  5403*    -------------------------------
  5404     05  DCAHRFDL PIC S9(0004) COMP.
  5405     05  DCAHRFDF PIC  X(0001).
  5406     05  FILLER REDEFINES DCAHRFDF.
  5407         10  DCAHRFDA PIC  X(0001).
  5408     05  DCAHRFDI PIC  X(0011).
  5409*    -------------------------------
  5410     05  DOISSL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 101
* EL6311.cbl
  5411     05  DOISSF PIC  X(0001).
  5412     05  FILLER REDEFINES DOISSF.
  5413         10  DOISSA PIC  X(0001).
  5414     05  DOISSI PIC  X(0005).
  5415*    -------------------------------
  5416     05  DOLFPRML PIC S9(0004) COMP.
  5417     05  DOLFPRMF PIC  X(0001).
  5418     05  FILLER REDEFINES DOLFPRMF.
  5419         10  DOLFPRMA PIC  X(0001).
  5420     05  DOLFPRMI PIC  X(0011).
  5421*    -------------------------------
  5422     05  DOAHPRML PIC S9(0004) COMP.
  5423     05  DOAHPRMF PIC  X(0001).
  5424     05  FILLER REDEFINES DOAHPRMF.
  5425         10  DOAHPRMA PIC  X(0001).
  5426     05  DOAHPRMI PIC  X(0011).
  5427*    -------------------------------
  5428     05  DOCANCL PIC S9(0004) COMP.
  5429     05  DOCANCF PIC  X(0001).
  5430     05  FILLER REDEFINES DOCANCF.
  5431         10  DOCANCA PIC  X(0001).
  5432     05  DOCANCI PIC  X(0005).
  5433*    -------------------------------
  5434     05  DOLFRFDL PIC S9(0004) COMP.
  5435     05  DOLFRFDF PIC  X(0001).
  5436     05  FILLER REDEFINES DOLFRFDF.
  5437         10  DOLFRFDA PIC  X(0001).
  5438     05  DOLFRFDI PIC  X(0011).
  5439*    -------------------------------
  5440     05  DOAHRFDL PIC S9(0004) COMP.
  5441     05  DOAHRFDF PIC  X(0001).
  5442     05  FILLER REDEFINES DOAHRFDF.
  5443         10  DOAHRFDA PIC  X(0001).
  5444     05  DOAHRFDI PIC  X(0011).
  5445*    -------------------------------
  5446     05  DITOTALL PIC S9(0004) COMP.
  5447     05  DITOTALF PIC  X(0001).
  5448     05  FILLER REDEFINES DITOTALF.
  5449         10  DITOTALA PIC  X(0001).
  5450     05  DITOTALI PIC  X(0005).
  5451*    -------------------------------
  5452     05  DIFATALL PIC S9(0004) COMP.
  5453     05  DIFATALF PIC  X(0001).
  5454     05  FILLER REDEFINES DIFATALF.
  5455         10  DIFATALA PIC  X(0001).
  5456     05  DIFATALI PIC  X(0005).
  5457*    -------------------------------
  5458     05  DIFORCEL PIC S9(0004) COMP.
  5459     05  DIFORCEF PIC  X(0001).
  5460     05  FILLER REDEFINES DIFORCEF.
  5461         10  DIFORCEA PIC  X(0001).
  5462     05  DIFORCEI PIC  X(0005).
  5463*    -------------------------------
  5464     05  DIHOLDL PIC S9(0004) COMP.
  5465     05  DIHOLDF PIC  X(0001).
  5466     05  FILLER REDEFINES DIHOLDF.
  5467         10  DIHOLDA PIC  X(0001).
  5468     05  DIHOLDI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 102
* EL6311.cbl
  5469*    -------------------------------
  5470     05  DIAVAILL PIC S9(0004) COMP.
  5471     05  DIAVAILF PIC  X(0001).
  5472     05  FILLER REDEFINES DIAVAILF.
  5473         10  DIAVAILA PIC  X(0001).
  5474     05  DIAVAILI PIC  X(0005).
  5475*    -------------------------------
  5476     05  DIGPREML PIC S9(0004) COMP.
  5477     05  DIGPREMF PIC  X(0001).
  5478     05  FILLER REDEFINES DIGPREMF.
  5479         10  DIGPREMA PIC  X(0001).
  5480     05  DIGPREMI PIC  X(0011).
  5481*    -------------------------------
  5482     05  DIBPREML PIC S9(0004) COMP.
  5483     05  DIBPREMF PIC  X(0001).
  5484     05  FILLER REDEFINES DIBPREMF.
  5485         10  DIBPREMA PIC  X(0001).
  5486     05  DIBPREMI PIC  X(0011).
  5487*    -------------------------------
  5488     05  DCTOTALL PIC S9(0004) COMP.
  5489     05  DCTOTALF PIC  X(0001).
  5490     05  FILLER REDEFINES DCTOTALF.
  5491         10  DCTOTALA PIC  X(0001).
  5492     05  DCTOTALI PIC  X(0005).
  5493*    -------------------------------
  5494     05  DCFATALL PIC S9(0004) COMP.
  5495     05  DCFATALF PIC  X(0001).
  5496     05  FILLER REDEFINES DCFATALF.
  5497         10  DCFATALA PIC  X(0001).
  5498     05  DCFATALI PIC  X(0005).
  5499*    -------------------------------
  5500     05  DCFORCEL PIC S9(0004) COMP.
  5501     05  DCFORCEF PIC  X(0001).
  5502     05  FILLER REDEFINES DCFORCEF.
  5503         10  DCFORCEA PIC  X(0001).
  5504     05  DCFORCEI PIC  X(0005).
  5505*    -------------------------------
  5506     05  DCHOLDL PIC S9(0004) COMP.
  5507     05  DCHOLDF PIC  X(0001).
  5508     05  FILLER REDEFINES DCHOLDF.
  5509         10  DCHOLDA PIC  X(0001).
  5510     05  DCHOLDI PIC  X(0005).
  5511*    -------------------------------
  5512     05  DCAVAILL PIC S9(0004) COMP.
  5513     05  DCAVAILF PIC  X(0001).
  5514     05  FILLER REDEFINES DCAVAILF.
  5515         10  DCAVAILA PIC  X(0001).
  5516     05  DCAVAILI PIC  X(0005).
  5517*    -------------------------------
  5518     05  DCGPREML PIC S9(0004) COMP.
  5519     05  DCGPREMF PIC  X(0001).
  5520     05  FILLER REDEFINES DCGPREMF.
  5521         10  DCGPREMA PIC  X(0001).
  5522     05  DCGPREMI PIC  X(0011).
  5523*    -------------------------------
  5524     05  DCBPREML PIC S9(0004) COMP.
  5525     05  DCBPREMF PIC  X(0001).
  5526     05  FILLER REDEFINES DCBPREMF.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 103
* EL6311.cbl
  5527         10  DCBPREMA PIC  X(0001).
  5528     05  DCBPREMI PIC  X(0011).
  5529*    -------------------------------
  5530     05  DNTOTALL PIC S9(0004) COMP.
  5531     05  DNTOTALF PIC  X(0001).
  5532     05  FILLER REDEFINES DNTOTALF.
  5533         10  DNTOTALA PIC  X(0001).
  5534     05  DNTOTALI PIC  X(0005).
  5535*    -------------------------------
  5536     05  DNFATALL PIC S9(0004) COMP.
  5537     05  DNFATALF PIC  X(0001).
  5538     05  FILLER REDEFINES DNFATALF.
  5539         10  DNFATALA PIC  X(0001).
  5540     05  DNFATALI PIC  X(0005).
  5541*    -------------------------------
  5542     05  DNFORCEL PIC S9(0004) COMP.
  5543     05  DNFORCEF PIC  X(0001).
  5544     05  FILLER REDEFINES DNFORCEF.
  5545         10  DNFORCEA PIC  X(0001).
  5546     05  DNFORCEI PIC  X(0005).
  5547*    -------------------------------
  5548     05  DNHOLDL PIC S9(0004) COMP.
  5549     05  DNHOLDF PIC  X(0001).
  5550     05  FILLER REDEFINES DNHOLDF.
  5551         10  DNHOLDA PIC  X(0001).
  5552     05  DNHOLDI PIC  X(0005).
  5553*    -------------------------------
  5554     05  DNAVAILL PIC S9(0004) COMP.
  5555     05  DNAVAILF PIC  X(0001).
  5556     05  FILLER REDEFINES DNAVAILF.
  5557         10  DNAVAILA PIC  X(0001).
  5558     05  DNAVAILI PIC  X(0005).
  5559*    -------------------------------
  5560     05  DNGPREML PIC S9(0004) COMP.
  5561     05  DNGPREMF PIC  X(0001).
  5562     05  FILLER REDEFINES DNGPREMF.
  5563         10  DNGPREMA PIC  X(0001).
  5564     05  DNGPREMI PIC  X(0011).
  5565*    -------------------------------
  5566     05  DNBPREML PIC S9(0004) COMP.
  5567     05  DNBPREMF PIC  X(0001).
  5568     05  FILLER REDEFINES DNBPREMF.
  5569         10  DNBPREMA PIC  X(0001).
  5570     05  DNBPREMI PIC  X(0011).
  5571*    -------------------------------
  5572     05  DERMSGL PIC S9(0004) COMP.
  5573     05  DERMSGF PIC  X(0001).
  5574     05  FILLER REDEFINES DERMSGF.
  5575         10  DERMSGA PIC  X(0001).
  5576     05  DERMSGI PIC  X(0075).
  5577*    -------------------------------
  5578     05  DPFENTRL PIC S9(0004) COMP.
  5579     05  DPFENTRF PIC  X(0001).
  5580     05  FILLER REDEFINES DPFENTRF.
  5581         10  DPFENTRA PIC  X(0001).
  5582     05  DPFENTRI PIC  9(2).
  5583 01  EL631DO REDEFINES EL631BI.
  5584     05  FILLER            PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 104
* EL6311.cbl
  5585*    -------------------------------
  5586     05  FILLER            PIC  X(0003).
  5587     05  DDATEO PIC  X(0008).
  5588*    -------------------------------
  5589     05  FILLER            PIC  X(0003).
  5590     05  DTIMEO PIC  99.99.
  5591*    -------------------------------
  5592     05  FILLER            PIC  X(0003).
  5593     05  DHEADO PIC  X(0038).
  5594*    -------------------------------
  5595     05  FILLER            PIC  X(0003).
  5596     05  DLDATEO PIC  X(0010).
  5597*    -------------------------------
  5598     05  FILLER            PIC  X(0003).
  5599     05  DBATCHO PIC  X(0011).
  5600*    -------------------------------
  5601     05  FILLER            PIC  X(0003).
  5602     05  DACCTNMO PIC  X(0030).
  5603*    -------------------------------
  5604     05  FILLER            PIC  X(0003).
  5605     05  DPROCDTO PIC  X(0008).
  5606*    -------------------------------
  5607     05  FILLER            PIC  X(0003).
  5608     05  DINPUTO PIC  X(0008).
  5609*    -------------------------------
  5610     05  FILLER            PIC  X(0003).
  5611     05  DMAINDTO PIC  X(0008).
  5612*    -------------------------------
  5613     05  FILLER            PIC  X(0003).
  5614     05  DCARRO PIC  X(0001).
  5615*    -------------------------------
  5616     05  FILLER            PIC  X(0003).
  5617     05  DGROUPO PIC  X(0006).
  5618*    -------------------------------
  5619     05  FILLER            PIC  X(0003).
  5620     05  DSTATEO PIC  X(0002).
  5621*    -------------------------------
  5622     05  FILLER            PIC  X(0003).
  5623     05  DACCTO PIC  X(0010).
  5624*    -------------------------------
  5625     05  FILLER            PIC  X(0003).
  5626     05  DRECVDTO PIC  X(0008).
  5627*    -------------------------------
  5628     05  FILLER            PIC  X(0003).
  5629     05  DCSRO PIC  X(0004).
  5630*    -------------------------------
  5631     05  FILLER            PIC  X(0003).
  5632     05  DREFHDGO PIC  X(0010).
  5633*    -------------------------------
  5634     05  FILLER            PIC  X(0003).
  5635     05  DREFO PIC  X(0012).
  5636*    -------------------------------
  5637     05  FILLER            PIC  X(0003).
  5638     05  DLFPHDGO PIC  X(0010).
  5639*    -------------------------------
  5640     05  FILLER            PIC  X(0003).
  5641     05  DAHPHDGO PIC  X(0010).
  5642*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 105
* EL6311.cbl
  5643     05  FILLER            PIC  X(0003).
  5644     05  DLFRHDGO PIC  X(0009).
  5645*    -------------------------------
  5646     05  FILLER            PIC  X(0003).
  5647     05  DAHRHDGO PIC  X(0009).
  5648*    -------------------------------
  5649     05  FILLER            PIC  X(0003).
  5650     05  DRISSO PIC  ZZ99-.
  5651*    -------------------------------
  5652     05  FILLER            PIC  X(0003).
  5653     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5654*    -------------------------------
  5655     05  FILLER            PIC  X(0003).
  5656     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5657*    -------------------------------
  5658     05  FILLER            PIC  X(0003).
  5659     05  DRCANCO PIC  ZZ99-.
  5660*    -------------------------------
  5661     05  FILLER            PIC  X(0003).
  5662     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5663*    -------------------------------
  5664     05  FILLER            PIC  X(0003).
  5665     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5666*    -------------------------------
  5667     05  FILLER            PIC  X(0003).
  5668     05  DEISSO PIC  ZZ99-.
  5669*    -------------------------------
  5670     05  FILLER            PIC  X(0003).
  5671     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5672*    -------------------------------
  5673     05  FILLER            PIC  X(0003).
  5674     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5675*    -------------------------------
  5676     05  FILLER            PIC  X(0003).
  5677     05  DECANCO PIC  ZZ99-.
  5678*    -------------------------------
  5679     05  FILLER            PIC  X(0003).
  5680     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5681*    -------------------------------
  5682     05  FILLER            PIC  X(0003).
  5683     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5684*    -------------------------------
  5685     05  FILLER            PIC  X(0003).
  5686     05  DCISSO PIC  ZZ99-.
  5687*    -------------------------------
  5688     05  FILLER            PIC  X(0003).
  5689     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5690*    -------------------------------
  5691     05  FILLER            PIC  X(0003).
  5692     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5693*    -------------------------------
  5694     05  FILLER            PIC  X(0003).
  5695     05  DCCANCO PIC  ZZ99-.
  5696*    -------------------------------
  5697     05  FILLER            PIC  X(0003).
  5698     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5699*    -------------------------------
  5700     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 106
* EL6311.cbl
  5701     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5702*    -------------------------------
  5703     05  FILLER            PIC  X(0003).
  5704     05  DOISSO PIC  ZZ99-.
  5705*    -------------------------------
  5706     05  FILLER            PIC  X(0003).
  5707     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5708*    -------------------------------
  5709     05  FILLER            PIC  X(0003).
  5710     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5711*    -------------------------------
  5712     05  FILLER            PIC  X(0003).
  5713     05  DOCANCO PIC  ZZ99-.
  5714*    -------------------------------
  5715     05  FILLER            PIC  X(0003).
  5716     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5717*    -------------------------------
  5718     05  FILLER            PIC  X(0003).
  5719     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5720*    -------------------------------
  5721     05  FILLER            PIC  X(0003).
  5722     05  DITOTALO PIC  ZZZ99.
  5723*    -------------------------------
  5724     05  FILLER            PIC  X(0003).
  5725     05  DIFATALO PIC  ZZZ99.
  5726*    -------------------------------
  5727     05  FILLER            PIC  X(0003).
  5728     05  DIFORCEO PIC  ZZZ99.
  5729*    -------------------------------
  5730     05  FILLER            PIC  X(0003).
  5731     05  DIHOLDO PIC  ZZZ99.
  5732*    -------------------------------
  5733     05  FILLER            PIC  X(0003).
  5734     05  DIAVAILO PIC  ZZZ99.
  5735*    -------------------------------
  5736     05  FILLER            PIC  X(0003).
  5737     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5738*    -------------------------------
  5739     05  FILLER            PIC  X(0003).
  5740     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5741*    -------------------------------
  5742     05  FILLER            PIC  X(0003).
  5743     05  DCTOTALO PIC  ZZZ99.
  5744*    -------------------------------
  5745     05  FILLER            PIC  X(0003).
  5746     05  DCFATALO PIC  ZZZ99.
  5747*    -------------------------------
  5748     05  FILLER            PIC  X(0003).
  5749     05  DCFORCEO PIC  ZZZ99.
  5750*    -------------------------------
  5751     05  FILLER            PIC  X(0003).
  5752     05  DCHOLDO PIC  ZZZ99.
  5753*    -------------------------------
  5754     05  FILLER            PIC  X(0003).
  5755     05  DCAVAILO PIC  ZZZ99.
  5756*    -------------------------------
  5757     05  FILLER            PIC  X(0003).
  5758     05  DCGPREMO PIC  ZZZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 107
* EL6311.cbl
  5759*    -------------------------------
  5760     05  FILLER            PIC  X(0003).
  5761     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5762*    -------------------------------
  5763     05  FILLER            PIC  X(0003).
  5764     05  DNTOTALO PIC  ---99.
  5765*    -------------------------------
  5766     05  FILLER            PIC  X(0003).
  5767     05  DNFATALO PIC  ---99.
  5768*    -------------------------------
  5769     05  FILLER            PIC  X(0003).
  5770     05  DNFORCEO PIC  ---99.
  5771*    -------------------------------
  5772     05  FILLER            PIC  X(0003).
  5773     05  DNHOLDO PIC  ---99.
  5774*    -------------------------------
  5775     05  FILLER            PIC  X(0003).
  5776     05  DNAVAILO PIC  ---99.
  5777*    -------------------------------
  5778     05  FILLER            PIC  X(0003).
  5779     05  DNGPREMO PIC  -------9.99.
  5780*    -------------------------------
  5781     05  FILLER            PIC  X(0003).
  5782     05  DNBPREMO PIC  -------9.99.
  5783*    -------------------------------
  5784     05  FILLER            PIC  X(0003).
  5785     05  DERMSGO PIC  X(0075).
  5786*    -------------------------------
  5787     05  FILLER            PIC  X(0003).
  5788     05  DPFENTRO PIC  X(0002).
  5789*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 108
* EL6311.cbl
  5791 01  MAP-B REDEFINES EL631BI.
  5792     12  FILLER                  PIC X(591).
  5793*    12  FILLER                  PIC X(512).
  5794*    12  FILLER                  PIC X(510).
  5795     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5796         16  BKIND-LEN               PIC S9(4)  COMP.
  5797         16  BKIND-ATTRB             PIC X.
  5798         16  BKIND                   PIC XX.
  5799         16  BTYPE-LEN               PIC S9(4)  COMP.
  5800         16  BTYPE-ATTRB             PIC X.
  5801         16  BTYPE                   PIC X(3).
  5802         16  BTERM-LEN               PIC S9(4)  COMP.
  5803         16  BTERM-ATTRB             PIC X.
  5804         16  BTERMI                  PIC 999.
  5805         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5806         16  BBEN-LEN                PIC S9(4)  COMP.
  5807         16  BBEN-ATTRB              PIC X.
  5808         16  BBENI                   PIC 9(10)V99.
  5809*        16  BBENI                   PIC 9(12).
  5810         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5811         16  BPREM-LEN               PIC S9(4)  COMP.
  5812         16  BPREM-ATTRB             PIC X.
  5813         16  BPREMI                  PIC S9(9)V99.
  5814*        16  BPREMI                  PIC 9(11).
  5815         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5816         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5817         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5818         16  BEXPIRE-ATTRB           PIC X.
  5819         16  BEXPIRE                 PIC X(8).
  5820         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5821         16  BCRIT-PERD-ATTRB        PIC X.
  5822         16  BCRIT-PERDI             PIC 99.
  5823         16  BCRIT-PERDO REDEFINES
  5824                         BCRIT-PERDI PIC ZZ.
  5825         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5826         16  BALT-BEN-ATTRB          PIC X.
  5827         16  BALT-BENI               PIC 9(10)V99.
  5828*        16  BALT-BENI               PIC 9(12).
  5829         16  BALT-BENO REDEFINES
  5830                           BALT-BENI PIC Z(9).ZZ.
  5831         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5832         16  BALT-PREM-ATTRB         PIC X.
  5833         16  BALT-PREMI              PIC 9(9)V99.
  5834*        16  BALT-PREMI              PIC 9(11).
  5835         16  BALT-PREMO REDEFINES
  5836                          BALT-PREMI PIC Z(7).ZZ-.
  5837         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5838         16  BBEN-CD-ATTRB           PIC X.
  5839         16  BBEN-CD                 PIC XXX.
  5840         16  BCPREM-LEN              PIC S9(4)  COMP.
  5841         16  BCPREM-ATTRB            PIC X.
  5842         16  BCPREMI                 PIC S9(9)V99.
  5843*        16  BCPREMI                 PIC X(11).
  5844         16  BCPREMO REDEFINES BCPREMI
  5845                                     PIC Z(7).99-.
  5846         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5847         16  BCALT-PREM-ATTRB        PIC X.
  5848         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 109
* EL6311.cbl
  5849         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5850         16  BBEN-ABBR-ATTRB         PIC X.
  5851         16  BBEN-ABBR               PIC X(5).
  5852         16  BDIFF-LEN               PIC S9(4)  COMP.
  5853         16  BDIFF-ATTRB             PIC X.
  5854         16  BDIFFO                  PIC Z(7).99-.
  5855         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5856         16  BBILL-LIT-ATTRB         PIC X.
  5857         16  BBILL-LIT               PIC X(8).
  5858         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5859         16  BDALT-PREM-ATTRB        PIC X.
  5860         16  BDALT-PREM              PIC Z(7).99-.
  5861
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 110
* EL6311.cbl
  5863
  5864****************************************************************
  5865*
  5866* Copyright (c) 2007-2013 Dell Inc.
  5867* All rights reserved.
  5868*
  5869****************************************************************
  5870 01  DFHEIV.
  5871   02  DFHEIV0               PIC X(35).
  5872   02  DFHEIV1               PIC X(08).
  5873   02  DFHEIV2               PIC X(08).
  5874   02  DFHEIV3               PIC X(08).
  5875   02  DFHEIV4               PIC X(06).
  5876   02  DFHEIV5               PIC X(04).
  5877   02  DFHEIV6               PIC X(04).
  5878   02  DFHEIV7               PIC X(02).
  5879   02  DFHEIV8               PIC X(02).
  5880   02  DFHEIV9               PIC X(01).
  5881   02  DFHEIV10              PIC S9(7) COMP-3.
  5882   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5883   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5884   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5885   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5886   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5887   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5888   02  DFHEIV17              PIC X(04).
  5889   02  DFHEIV18              PIC X(04).
  5890   02  DFHEIV19              PIC X(04).
  5891   02  DFHEIV20              USAGE IS POINTER.
  5892   02  DFHEIV21              USAGE IS POINTER.
  5893   02  DFHEIV22              USAGE IS POINTER.
  5894   02  DFHEIV23              USAGE IS POINTER.
  5895   02  DFHEIV24              USAGE IS POINTER.
  5896   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5897   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5898   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5899   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5900   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5901   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5902   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5903   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5904   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5905   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5906   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5907   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5908   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5909   02  FILLER                PIC X(02).
  5910   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5911   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5912   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5913   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5914   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5915   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5916   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5917 LINKAGE  SECTION.
  5918*****************************************************************
  5919*                                                               *
  5920* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 111
* EL6311.cbl
  5921* All rights reserved.                                          *
  5922*                                                               *
  5923*****************************************************************
  5924 01  dfheiblk.
  5925     02  eibtime          pic s9(7) comp-3.
  5926     02  eibdate          pic s9(7) comp-3.
  5927     02  eibtrnid         pic x(4).
  5928     02  eibtaskn         pic s9(7) comp-3.
  5929     02  eibtrmid         pic x(4).
  5930     02  dfheigdi         pic s9(4) comp.
  5931     02  eibcposn         pic s9(4) comp.
  5932     02  eibcalen         pic s9(4) comp.
  5933     02  eibaid           pic x(1).
  5934     02  eibfiller1       pic x(1).
  5935     02  eibfn            pic x(2).
  5936     02  eibfiller2       pic x(2).
  5937     02  eibrcode         pic x(6).
  5938     02  eibfiller3       pic x(2).
  5939     02  eibds            pic x(8).
  5940     02  eibreqid         pic x(8).
  5941     02  eibrsrce         pic x(8).
  5942     02  eibsync          pic x(1).
  5943     02  eibfree          pic x(1).
  5944     02  eibrecv          pic x(1).
  5945     02  eibsend          pic x(1).
  5946     02  eibatt           pic x(1).
  5947     02  eibeoc           pic x(1).
  5948     02  eibfmh           pic x(1).
  5949     02  eibcompl         pic x(1).
  5950     02  eibsig           pic x(1).
  5951     02  eibconf          pic x(1).
  5952     02  eiberr           pic x(1).
  5953     02  eibrldbk         pic x(1).
  5954     02  eiberrcd         pic x(4).
  5955     02  eibsynrb         pic x(1).
  5956     02  eibnodat         pic x(1).
  5957     02  eibfiller5       pic x(2).
  5958     02  eibresp          pic s9(8) comp.
  5959     02  eibresp2         pic s9(8) comp.
  5960     02  dfheigdj         pic s9(4) comp.
  5961     02  dfheigdk         pic s9(4) comp.
  5962 01  DFHCOMMAREA                 PIC X(1300).
  5963*                                COPY ERCPNDB.
  5964******************************************************************
  5965*                                                                *
  5966*                                                                *
  5967*                            ERCPNDB.                            *
  5968*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5969*                            VMOD=2.025                          *
  5970*                                                                *
  5971*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5972*                                                                *
  5973******************************************************************
  5974*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5975*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5976******************************************************************
  5977*                                                                *
  5978*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 112
* EL6311.cbl
  5979*   FILE TYPE = VSAM,KSDS                                        *
  5980*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5981*                                                                *
  5982*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5983*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5984*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5985*                                                 RKP=13,LEN=36  *
  5986*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5987*                                      AND CHG-SEQ.)             *
  5988*                                                RKP=49,LEN=11   *
  5989*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5990*                                      AND CHG-SEQ.)             *
  5991*                                                RKP=60,LEN=15   *
  5992*                                                                *
  5993*   LOG = NO                                                     *
  5994*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5995******************************************************************
  5996******************************************************************
  5997*                   C H A N G E   L O G
  5998*
  5999* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6000*-----------------------------------------------------------------
  6001*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6002* EFFECTIVE    NUMBER
  6003*-----------------------------------------------------------------
  6004* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6005* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6006* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  6007* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6008* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  6009* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6010* 032306                   PEMA  ADD BOW LOAN NUMBER
  6011* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  6012* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  6013* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6014* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6015* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  6016* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  6017* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6018* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  6019* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  6020* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6021* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  6022* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6023******************************************************************
  6024
  6025 01  PENDING-BUSINESS.
  6026     12  PB-RECORD-ID                     PIC XX.
  6027         88  VALID-PB-ID                        VALUE 'PB'.
  6028
  6029     12  PB-CONTROL-PRIMARY.
  6030         16  PB-COMPANY-CD                PIC X.
  6031         16  PB-ENTRY-BATCH               PIC X(6).
  6032         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  6033         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  6034
  6035     12  PB-CONTROL-BY-ACCOUNT.
  6036         16  PB-COMPANY-CD-A1             PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 113
* EL6311.cbl
  6037         16  PB-CARRIER                   PIC X.
  6038         16  PB-GROUPING.
  6039             20  PB-GROUPING-PREFIX       PIC XXX.
  6040             20  PB-GROUPING-PRIME        PIC XXX.
  6041         16  PB-STATE                     PIC XX.
  6042         16  PB-ACCOUNT.
  6043             20  PB-ACCOUNT-PREFIX        PIC X(4).
  6044             20  PB-ACCOUNT-PRIME         PIC X(6).
  6045         16  PB-CERT-EFF-DT               PIC XX.
  6046         16  PB-CERT-NO.
  6047             20  PB-CERT-PRIME            PIC X(10).
  6048             20  PB-CERT-SFX              PIC X.
  6049         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  6050
  6051         16  PB-RECORD-TYPE               PIC X.
  6052             88  PB-MAILING-DATA                VALUE '0'.
  6053             88  PB-ISSUE                       VALUE '1'.
  6054             88  PB-CANCELLATION                VALUE '2'.
  6055             88  PB-BATCH-TRAILER               VALUE '9'.
  6056
  6057     12  PB-CONTROL-BY-ORIG-BATCH.
  6058         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  6059         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  6060         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  6061         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  6062
  6063     12  PB-CONTROL-BY-CSR.
  6064         16  PB-CSR-COMPANY-CD            PIC X.
  6065         16  PB-CSR-ID                    PIC X(4).
  6066         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  6067         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  6068         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  6069******************************************************************
  6070*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  6071******************************************************************
  6072
  6073     12  PB-LAST-MAINT-DT                 PIC XX.
  6074     12  PB-LAST-MAINT-BY                 PIC X(4).
  6075     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  6076
  6077     12  PB-RECORD-BODY                   PIC X(375).
  6078
  6079     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  6080         16  PB-CERT-ORIGIN               PIC X.
  6081             88  CLASIC-CREATED-CERT         VALUE '1'.
  6082         16  PB-I-NAME.
  6083             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  6084             20  PB-I-INSURED-FIRST-NAME.
  6085                 24  PB-I-INSURED-1ST-INIT PIC X.
  6086                 24  FILLER                PIC X(9).
  6087             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  6088         16  PB-I-AGE                     PIC S99   COMP-3.
  6089         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  6090         16  PB-I-BIRTHDAY                PIC XX.
  6091         16  PB-I-INSURED-SEX             PIC X.
  6092             88  PB-SEX-MALE     VALUE 'M'.
  6093             88  PB-SEX-FEMALE   VALUE 'F'.
  6094
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 114
* EL6311.cbl
  6095         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  6096         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  6097         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  6098         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  6099         16  PB-I-SKIP-CODE               PIC X.
  6100             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  6101             88  PB-SKIP-JULY              VALUE '1'.
  6102             88  PB-SKIP-AUGUST            VALUE '2'.
  6103             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  6104             88  PB-SKIP-JULY-AUG          VALUE '4'.
  6105             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  6106             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  6107             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  6108             88  PB-SKIP-JUNE              VALUE '8'.
  6109             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  6110             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6111             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6112         16  PB-I-TERM-TYPE               PIC X.
  6113             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6114             88  PB-PAID-WEEKLY            VALUE 'W'.
  6115             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6116             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6117             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6118         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6119         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6120         16  PB-I-DATA-ENTRY-SW           PIC X.
  6121             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6122             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6123             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6124             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6125         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6126         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6127*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6128         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6129         16  FILLER                       PIC X.
  6130
  6131         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6132             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6133             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6134                                                   '90' THRU '99'.
  6135         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6136                                          PIC XX.
  6137         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6138         16  PB-I-AMOUNT-FINANCED REDEFINES
  6139                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6140         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6141         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6142                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6143         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6144         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6145         16  PB-I-CLP-AMOUNT REDEFINES
  6146                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6147         16  PB-I-LF-CALC-FLAG            PIC X.
  6148             88 PB-COMP-LF-PREM               VALUE '?'.
  6149         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6150         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6151         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  6152         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 115
* EL6311.cbl
  6153         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6154         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6155         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6156         16  PB-I-LF-ABBR                 PIC XXX.
  6157         16  PB-I-LF-INPUT-CD             PIC XX.
  6158
  6159         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6160             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6161             88  PB-INVALID-AH               VALUE '  ' '00'
  6162                                                   '90' THRU '99'.
  6163         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6164         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6165         16  PB-I-AH-CALC-FLAG            PIC X.
  6166             88 PB-COMP-AH-PREM                  VALUE '?'.
  6167         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6168         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6169         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  6170         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6171         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6172         16  PB-I-AH-ABBR                 PIC XXX.
  6173         16  PB-I-AH-INPUT-CD             PIC XXX.
  6174
  6175         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6176         16  PB-I-REIN-TABLE              PIC XXX.
  6177         16  PB-I-BUSINESS-TYPE           PIC 99.
  6178         16  PB-I-INDV-GRP-CD             PIC X.
  6179         16  PB-I-MORT-CODE.
  6180             20  PB-I-TABLE               PIC X.
  6181             20  PB-I-INTEREST            PIC XX.
  6182             20  PB-I-MORT-TYP            PIC X.
  6183         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6184         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6185         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6186         16  PB-I-INDV-GRP-OVRD           PIC X.
  6187         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6188         16  PB-I-SIG-SW                  PIC X.
  6189             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6190         16  PB-I-RATE-CLASS              PIC XX.
  6191         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6192         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6193         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6194         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6195         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6196         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6197         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6198         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6199         16  PB-I-OB-FLAG                 PIC X.
  6200             88  PB-I-OB                      VALUE 'B'.
  6201             88  PB-I-SUMMARY                 VALUE 'Z'.
  6202         16  PB-I-ENTRY-STATUS            PIC X.
  6203             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6204                                              'M' '5' '9' '2'.
  6205             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6206             88  PB-I-POLICY-PENDING          VALUE '2'.
  6207             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6208             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6209             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  6210             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 116
* EL6311.cbl
  6211             88  PB-I-REIN-ONLY               VALUE '9'.
  6212             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6213             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6214             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6215             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6216         16  PB-I-INT-CODE                PIC X.
  6217             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6218             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6219         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6220         16  PB-I-SOC-SEC-NO              PIC X(11).
  6221         16  PB-I-MEMBER-NO               PIC X(12).
  6222         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6223*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6224         16  PB-I-OLD-LOF                 PIC XXX.
  6225         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6226         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6227         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6228         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6229         16  PB-I-LIFE-INDICATOR          PIC X.
  6230             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6231         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6232         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6233                                          PIC S9(5)V99    COMP-3.
  6234         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6235             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6236             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6237         16  PB-I-1ST-PMT-DT              PIC XX.
  6238         16  PB-I-JOINT-INSURED.
  6239             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6240             20 PB-I-JOINT-FIRST-NAME.
  6241                24  PB-I-JOINT-FIRST-INIT PIC X.
  6242                24  FILLER                PIC X(9).
  6243             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6244*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6245         16  PB-I-BENEFICIARY-NAME.
  6246             20  PB-I-BANK-NUMBER         PIC X(10).
  6247             20  FILLER                   PIC X(15).
  6248         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6249         16  PB-I-REFERENCE               PIC X(12).
  6250         16  FILLER REDEFINES PB-I-REFERENCE.
  6251             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6252             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6253             20  PB-I-CLP-STATE           PIC XX.
  6254         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6255             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6256             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6257             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6258         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6259         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6260         16  PB-I-RESIDENT-STATE          PIC XX.
  6261         16  PB-I-RATE-CODE               PIC X(4).
  6262         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6263         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6264         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6265         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6266         16  PB-I-BANK-NOCHRGB            PIC 99.
  6267         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6268         16  PB-I-JOINT-BIRTHDAY          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 117
* EL6311.cbl
  6269
  6270     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6271         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6272             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6273         16  PB-C-CANCEL-ORIGIN           PIC X.
  6274             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6275         16  PB-C-LF-CANCEL-DT            PIC XX.
  6276         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6277         16  PB-C-LF-CALC-REQ             PIC X.
  6278             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6279         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6280         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6281         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6282             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6283         16  PB-C-AH-CANCEL-DT            PIC XX.
  6284         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6285         16  PB-C-AH-CALC-REQ             PIC X.
  6286             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6287         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6288         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6289         16  PB-C-LAST-NAME               PIC X(15).
  6290         16  PB-C-REFUND-SW               PIC X.
  6291             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6292             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6293         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6294         16  PB-C-PAYEE-CODE              PIC X(6).
  6295         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6296         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6297         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6298         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6299         16  PB-C-REFERENCE               PIC X(12).
  6300         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6301         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6302         16  PB-C-POST-CARD-IND           PIC X.
  6303         16  PB-C-CANCEL-REASON           PIC X.
  6304         16  PB-C-REF-INTERFACE-SW        PIC X.
  6305         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6306         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6307         16  FILLER                       PIC X(01).
  6308*        16  FILLER                       PIC X(18).
  6309         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6310*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6311         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  6312         16  PB-CANCELED-CERT-DATA.
  6313             20  PB-CI-INSURED-NAME.
  6314                 24  PB-CI-LAST-NAME      PIC X(15).
  6315                 24  PB-CI-INITIALS       PIC XX.
  6316             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6317             20  PB-CI-INSURED-SEX        PIC X.
  6318             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6319             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6320             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6321             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6322             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6323             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6324             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6325             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6326             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 118
* EL6311.cbl
  6327             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6328             20  PB-CI-RATE-CLASS         PIC XX.
  6329             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6330             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6331             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6332             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6333             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6334             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6335             20  PB-CI-LF-ABBR            PIC X(3).
  6336             20  PB-CI-AH-ABBR            PIC X(3).
  6337             20  PB-CI-OB-FLAG            PIC X.
  6338                 88  PB-CI-OB                VALUE 'B'.
  6339             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6340                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6341                                           'M' '4' '5' '9' '2'.
  6342                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6343                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6344                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6345                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6346                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6347                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6348                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6349                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6350                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6351                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6352                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6353                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6354                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6355             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6356                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6357                                           'M' '4' '5' '9' '2'.
  6358                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6359                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6360                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6361                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6362                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6363                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6364                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6365                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6366                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6367                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6368                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6369                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6370                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6371             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6372             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6373             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6374             20  PB-CI-MEMBER-NO          PIC X(12).
  6375             20  PB-CI-INT-CODE           PIC X.
  6376                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6377                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6378             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6379             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6380             20  PB-CI-COMP-EXCP-SW       PIC X.
  6381                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6382                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6383             20  PB-CI-ENTRY-STATUS       PIC X.
  6384             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 119
* EL6311.cbl
  6385             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6386             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6387             20  PB-CI-DEATH-DT           PIC XX.
  6388             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6389             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6390             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6391             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6392             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6393             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6394             20  PB-CI-ENTRY-DT              PIC XX.
  6395             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6396             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6397             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6398             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6399             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6400             20  PB-CI-OLD-LOF               PIC XXX.
  6401*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6402             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6403             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6404             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6405             20  PB-CI-INDV-GRP-CD           PIC X.
  6406             20  PB-CI-BENEFICIARY-NAME.
  6407                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6408                 24  FILLER                  PIC X(15).
  6409             20  PB-CI-NOTE-SW               PIC X.
  6410             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6411             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6412             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6413             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6414             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6415             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6416             20  PB-CI-FIRST-NAME            PIC X(10).
  6417             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6418
  6419         16  FILLER                       PIC X(13).
  6420*032306  16  FILLER                       PIC X(27).
  6421*        16  FILLER                       PIC X(46).
  6422
  6423     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6424         16  FILLER                       PIC X(10).
  6425         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6426         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6427         16  PB-M-INSURED-MID-INIT        PIC X.
  6428         16  PB-M-INSURED-AGE             PIC 99.
  6429         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6430         16  PB-M-INSURED-SEX             PIC X.
  6431         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6432         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6433         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6434         16  PB-M-INSURED-CITY-STATE.
  6435             20  PB-M-INSURED-CITY        PIC X(28).
  6436             20  PB-M-INSURED-STATE       PIC XX.
  6437         16  PB-M-INSURED-ZIP-CODE.
  6438             20  PB-M-INSURED-ZIP-PRIME.
  6439                 24  PB-M-INSURED-ZIP-1   PIC X.
  6440                     88  PB-M-CANADIAN-POST-CODE
  6441                                             VALUE 'A' THRU 'Z'.
  6442                 24  FILLER               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 120
* EL6311.cbl
  6443             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6444         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6445                                        PB-M-INSURED-ZIP-CODE.
  6446             20  PM-M-INS-CAN-POST1       PIC XXX.
  6447             20  PM-M-INS-CAN-POST2       PIC XXX.
  6448             20  FILLER                   PIC XXX.
  6449         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6450         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6451         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6452         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6453         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6454         16  PB-M-CRED-BENE-CITYST.
  6455             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6456             20  PB-M-CRED-BENE-STATE     PIC XX.
  6457         16  FILLER                       PIC X(92).
  6458
  6459     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6460         16  FILLER                       PIC X(10).
  6461         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6462         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6463         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6464         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6465         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6466         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6467         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6468         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6469         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6470         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6471         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6472         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6473         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6474         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6475         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6476         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6477         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6478         16  PB-ACCOUNT-NAME              PIC X(30).
  6479         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6480         16  PB-REFERENCE                 PIC X(12).
  6481         16  PB-B-RECEIVED-DT             PIC XX.
  6482         16  FILLER                       PIC X(234).
  6483
  6484     12  PB-RECORD-STATUS.
  6485         16  PB-CREDIT-SELECT-DT          PIC XX.
  6486         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6487         16  PB-BILLED-DT                 PIC XX.
  6488         16  PB-BILLING-STATUS            PIC X.
  6489             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6490             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6491             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6492         16  PB-RECORD-BILL               PIC X.
  6493             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6494             88  PB-RECORD-RETURNED           VALUE 'R'.
  6495             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6496             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6497             88  PB-OVERRIDE-AH               VALUE 'A'.
  6498             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6499         16  PB-BATCH-ENTRY               PIC X.
  6500             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 121
* EL6311.cbl
  6501             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6502             88  PB-REISSUED-CERT             VALUE 'E'.
  6503             88  PB-CASH-CERT                 VALUE 'C'.
  6504             88  PB-MONTHLY-CERT              VALUE 'M'.
  6505             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6506             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6507             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6508         16  PB-FORCE-CODE                PIC X.
  6509             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6510             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6511             88  PB-CANCEL-FORCE              VALUE '8'.
  6512             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6513             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6514             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6515             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6516             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6517             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6518             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6519             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6520         16  PB-FATAL-FLAG                PIC X.
  6521             88  PB-FATAL-ERRORS              VALUE 'X'.
  6522         16  PB-FORCE-ER-CD               PIC X.
  6523             88  PB-FORCE-ERRORS              VALUE 'F'.
  6524             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6525         16  PB-WARN-ER-CD                PIC X.
  6526             88  PB-WARNING-ERRORS            VALUE 'W'.
  6527         16  FILLER                       PIC X.
  6528         16  PB-OUT-BAL-CD                PIC X.
  6529             88  PB-OUT-OF-BAL                VALUE 'O'.
  6530         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6531         16  PB-AH-OVERRIDE-L1            PIC X.
  6532         16  PB-INPUT-DT                  PIC XX.
  6533         16  PB-INPUT-BY                  PIC X(4).
  6534         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6535         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6536         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6537         16  PB-LF-EARNING-METHOD         PIC X.
  6538         16  PB-AH-EARNING-METHOD         PIC X.
  6539         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6540         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6541         16  PB-REIN-CD                   PIC XXX.
  6542         16  PB-LF-REFUND-TYPE            PIC X.
  6543         16  PB-AH-REFUND-TYPE            PIC X.
  6544         16  PB-ACCT-EFF-DT               PIC XX.
  6545         16  PB-ACCT-EXP-DT               PIC XX.
  6546         16  PB-COMPANY-ID                PIC X(3).
  6547         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6548         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6549         16  PB-SV-CARRIER                PIC X.
  6550         16  PB-SV-GROUPING               PIC X(6).
  6551         16  PB-SV-STATE                  PIC XX.
  6552         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6553         16  PB-GA-BILLING-INFO.
  6554             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6555                                          PIC XX.
  6556         16  PB-SV-REMIT-TO  REDEFINES
  6557             PB-GA-BILLING-INFO           PIC X(10).
  6558         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 122
* EL6311.cbl
  6559         16  PB-I-LOAN-OFFICER            PIC X(5).
  6560         16  PB-I-VIN                     PIC X(17).
  6561
  6562         16  FILLER                       PIC X(04).
  6563         16  IMNET-BYPASS-SW              PIC X.
  6564
  6565******************************************************************
  6566*                COMMON EDIT ERRORS                              *
  6567******************************************************************
  6568
  6569     12  PB-COMMON-ERRORS.
  6570         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6571                                           PIC S9(4)     COMP.
  6572
  6573******************************************************************
  6574*                                COPY ELCCERT.
  6575******************************************************************
  6576*                                                                *
  6577*                            ELCCERT.                            *
  6578*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6579*                            VMOD=2.013                          *
  6580*                                                                *
  6581*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6582*                                                                *
  6583*   FILE TYPE = VSAM,KSDS                                        *
  6584*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6585*                                                                *
  6586*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6587*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6588*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6589*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6590*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6591*                                                                *
  6592*   LOG = YES                                                    *
  6593*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6594******************************************************************
  6595*                   C H A N G E   L O G
  6596*
  6597* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6598*-----------------------------------------------------------------
  6599*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6600* EFFECTIVE    NUMBER
  6601*-----------------------------------------------------------------
  6602* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6603* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6604* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6605* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6606* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6607* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6608* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6609* 032612  CR2011110200001  PEMA  AHL CHANGES
  6610* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6611* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6612* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6613******************************************************************
  6614
  6615 01  CERTIFICATE-MASTER.
  6616     12  CM-RECORD-ID                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 123
* EL6311.cbl
  6617         88  VALID-CM-ID                      VALUE 'CM'.
  6618
  6619     12  CM-CONTROL-PRIMARY.
  6620         16  CM-COMPANY-CD                 PIC X.
  6621         16  CM-CARRIER                    PIC X.
  6622         16  CM-GROUPING.
  6623             20  CM-GROUPING-PREFIX        PIC X(3).
  6624             20  CM-GROUPING-PRIME         PIC X(3).
  6625         16  CM-STATE                      PIC XX.
  6626         16  CM-ACCOUNT.
  6627             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6628             20  CM-ACCOUNT-PRIME          PIC X(6).
  6629         16  CM-CERT-EFF-DT                PIC XX.
  6630         16  CM-CERT-NO.
  6631             20  CM-CERT-PRIME             PIC X(10).
  6632             20  CM-CERT-SFX               PIC X.
  6633
  6634     12  CM-CONTROL-BY-NAME.
  6635         16  CM-COMPANY-CD-A1              PIC X.
  6636         16  CM-INSURED-LAST-NAME          PIC X(15).
  6637         16  CM-INSURED-INITIALS.
  6638             20  CM-INSURED-INITIAL1       PIC X.
  6639             20  CM-INSURED-INITIAL2       PIC X.
  6640
  6641     12  CM-CONTROL-BY-SSN.
  6642         16  CM-COMPANY-CD-A2              PIC X.
  6643         16  CM-SOC-SEC-NO.
  6644             20  CM-SSN-STATE              PIC XX.
  6645             20  CM-SSN-ACCOUNT            PIC X(6).
  6646             20  CM-SSN-LN3.
  6647                 25  CM-INSURED-INITIALS-A2.
  6648                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6649                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6650                 25 CM-PART-LAST-NAME-A2         PIC X.
  6651
  6652     12  CM-CONTROL-BY-CERT-NO.
  6653         16  CM-COMPANY-CD-A4              PIC X.
  6654         16  CM-CERT-NO-A4                 PIC X(11).
  6655
  6656     12  CM-CONTROL-BY-MEMB.
  6657         16  CM-COMPANY-CD-A5              PIC X.
  6658         16  CM-MEMBER-NO.
  6659             20  CM-MEMB-STATE             PIC XX.
  6660             20  CM-MEMB-ACCOUNT           PIC X(6).
  6661             20  CM-MEMB-LN4.
  6662                 25  CM-INSURED-INITIALS-A5.
  6663                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6664                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6665                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6666
  6667     12  CM-INSURED-PROFILE-DATA.
  6668         16  CM-INSURED-FIRST-NAME.
  6669             20  CM-INSURED-1ST-INIT       PIC X.
  6670             20  FILLER                    PIC X(9).
  6671         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6672         16  CM-INSURED-SEX                PIC X.
  6673             88  CM-SEX-MALE                  VALUE 'M'.
  6674             88  CM-SEX-FEMAL                 VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 124
* EL6311.cbl
  6675         16  CM-INSURED-JOINT-AGE          PIC 99.
  6676         16  CM-JOINT-INSURED-NAME.
  6677             20  CM-JT-LAST-NAME           PIC X(15).
  6678             20  CM-JT-FIRST-NAME.
  6679                 24  CM-JT-1ST-INIT        PIC X.
  6680                 24  FILLER                PIC X(9).
  6681             20  CM-JT-INITIAL             PIC X.
  6682
  6683     12  CM-LIFE-DATA.
  6684         16  CM-LF-BENEFIT-CD              PIC XX.
  6685         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6686         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6687         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6688         16  CM-LF-DEV-CODE                PIC XXX.
  6689         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6690         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6691         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6692         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6693         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6694         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6695         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6696         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6697         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6698         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6699         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6700         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6701         16  cm-temp-epiq                  pic xx.
  6702             88  EPIQ-CLASS                  value 'EQ'.
  6703*        16  FILLER                        PIC XX.
  6704
  6705     12  CM-AH-DATA.
  6706         16  CM-AH-BENEFIT-CD              PIC XX.
  6707         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6708         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6709         16  CM-AH-DEV-CODE                PIC XXX.
  6710         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6711         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6712         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6713         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6714         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6715         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6716         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6717         16  CM-AH-PAID-THRU-DT            PIC XX.
  6718             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6719         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6720         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6721         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6722         16  FILLER                        PIC X.
  6723
  6724     12  CM-LOAN-INFORMATION.
  6725         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6726         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6727                                           PIC S9(5)V99  COMP-3.
  6728         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6729         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6730         16  CM-PAY-FREQUENCY              PIC S99.
  6731         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6732         16  CM-RATE-CLASS                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 125
* EL6311.cbl
  6733         16  CM-BENEFICIARY                PIC X(25).
  6734         16  CM-POLICY-FORM-NO             PIC X(12).
  6735         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6736         16  CM-LAST-ADD-ON-DT             PIC XX.
  6737         16  CM-DEDUCTIBLE-AMOUNTS.
  6738             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6739             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6740         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6741             20  CM-RESIDENT-STATE         PIC XX.
  6742             20  CM-RATE-CODE              PIC X(4).
  6743             20  FILLER                    PIC XX.
  6744         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6745             20  CM-LOAN-OFFICER           PIC X(5).
  6746             20  FILLER                    PIC XXX.
  6747         16  CM-CSR-CODE                   PIC XXX.
  6748         16  CM-UNDERWRITING-CODE          PIC X.
  6749             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6750         16  CM-POST-CARD-IND              PIC X.
  6751         16  CM-REF-INTERFACE-SW           PIC X.
  6752         16  CM-PREMIUM-TYPE               PIC X.
  6753             88  CM-SING-PRM                  VALUE '1'.
  6754             88  CM-O-B-COVERAGE              VALUE '2'.
  6755             88  CM-OPEN-END                  VALUE '3'.
  6756         16  CM-IND-GRP-TYPE               PIC X.
  6757             88  CM-INDIVIDUAL                VALUE 'I'.
  6758             88  CM-GROUP                     VALUE 'G'.
  6759         16  CM-SKIP-CODE                  PIC X.
  6760             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6761             88  SKIP-JULY                    VALUE '1'.
  6762             88  SKIP-AUGUST                  VALUE '2'.
  6763             88  SKIP-SEPTEMBER               VALUE '3'.
  6764             88  SKIP-JULY-AUG                VALUE '4'.
  6765             88  SKIP-AUG-SEPT                VALUE '5'.
  6766             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6767             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6768             88  SKIP-JUNE                    VALUE '8'.
  6769             88  SKIP-JUNE-JULY               VALUE '9'.
  6770             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6771             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6772         16  CM-PAYMENT-MODE               PIC X.
  6773             88  PAY-MONTHLY                  VALUE SPACE.
  6774             88  PAY-WEEKLY                   VALUE '1'.
  6775             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6776             88  PAY-BI-WEEKLY                VALUE '3'.
  6777             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6778         16  CM-LOAN-NUMBER                PIC X(8).
  6779         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6780         16  CM-OLD-LOF                    PIC XXX.
  6781*        16  CM-LOAN-OFFICER               PIC XXX.
  6782         16  CM-REIN-TABLE                 PIC XXX.
  6783         16  CM-SPECIAL-REIN-CODE          PIC X.
  6784         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6785         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6786         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6787
  6788     12  CM-STATUS-DATA.
  6789         16  CM-ENTRY-STATUS               PIC X.
  6790         16  CM-ENTRY-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 126
* EL6311.cbl
  6791
  6792         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6793         16  CM-LF-CANCEL-DT               PIC XX.
  6794         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6795
  6796         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6797         16  CM-LF-DEATH-DT                PIC XX.
  6798         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6799
  6800         16  CM-LF-CURRENT-STATUS          PIC X.
  6801             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6802                                                'M' '4' '5' '9'.
  6803             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6804             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6805             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6806             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6807             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6808             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6809             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6810             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6811             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6812             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6813             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6814             88  CM-LF-DECLINED               VALUE 'D'.
  6815             88  CM-LF-VOIDED                 VALUE 'V'.
  6816
  6817         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6818         16  CM-AH-CANCEL-DT               PIC XX.
  6819         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6820
  6821         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6822         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6823         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6824
  6825         16  CM-AH-CURRENT-STATUS          PIC X.
  6826             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6827                                                'M' '4' '5' '9'.
  6828             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6829             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6830             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6831             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6832             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6833             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6834             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6835             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6836             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6837             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6838             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6839             88  CM-AH-DECLINED               VALUE 'D'.
  6840             88  CM-AH-VOIDED                 VALUE 'V'.
  6841
  6842         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6843             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6844             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6845             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6846         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6847
  6848         16  CM-ENTRY-BATCH                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 127
* EL6311.cbl
  6849         16  CM-LF-EXIT-BATCH              PIC X(6).
  6850         16  CM-AH-EXIT-BATCH              PIC X(6).
  6851         16  CM-LAST-MONTH-END             PIC XX.
  6852
  6853     12  CM-NOTE-SW                        PIC X.
  6854         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6855         88  CERT-NOTES-PRESENT               VALUE '1'.
  6856         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6857         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6858         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6859         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6860         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6861         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6862     12  CM-COMP-EXCP-SW                   PIC X.
  6863         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6864         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6865     12  CM-INSURED-ADDRESS-SW             PIC X.
  6866         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6867         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6868
  6869*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6870     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6871     12  FILLER                            PIC X.
  6872
  6873*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6874     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6875     12  FILLER                            PIC X.
  6876*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6877     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  6878
  6879     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6880         88  CERT-ADDED-BATCH                 VALUE ' '.
  6881         88  CERT-ADDED-ONLINE                VALUE '1'.
  6882         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6883         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6884         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6885     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6886         88  CERT-AS-LOADED                   VALUE ' '.
  6887         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6888         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6889         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6890         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6891         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6892         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6893         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6894
  6895     12  CM-ACCOUNT-COMM-PCTS.
  6896         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6897         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6898
  6899     12  CM-USER-FIELD                     PIC X.
  6900     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6901     12  CM-CLP-STATE                      PIC XX.
  6902     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6903     12  CM-USER-RESERVED                  PIC XXX.
  6904     12  FILLER REDEFINES CM-USER-RESERVED.
  6905         16  CM-AH-CLASS-CD                PIC XX.
  6906         16  F                             PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 128
* EL6311.cbl
  6907******************************************************************
  6908*                                COPY ERCNOTE.
  6909******************************************************************
  6910*                                                                *
  6911*                                                                *
  6912*                            ERCNOTE                             *
  6913*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6914*                            VMOD=2.003                          *
  6915*                                                                *
  6916*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6917*                                                                *
  6918*        FILE TYPE= VSAM,KSDS                                    *
  6919*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6920*                                                                *
  6921*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6922*                                                                *
  6923*        LOG = YES                                               *
  6924*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6925*                                                                *
  6926******************************************************************
  6927*                   C H A N G E   L O G
  6928*
  6929* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6930*-----------------------------------------------------------------
  6931*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6932* EFFECTIVE    NUMBER
  6933*-----------------------------------------------------------------
  6934* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6935*                                FILE WILL CONTAIN BILLING NOTES O
  6936******************************************************************
  6937
  6938 01  CERTIFICATE-NOTE.
  6939     12  CN-RECORD-ID                PIC  XX.
  6940         88  VALID-CN-ID                  VALUE 'CN'.
  6941
  6942     12  CN-CONTROL-PRIMARY.
  6943         16  CN-COMPANY-CD           PIC X.
  6944         16  CN-CARRIER              PIC X.
  6945         16  CN-GROUPING.
  6946             20 CN-GROUPING-PREFIX   PIC XXX.
  6947             20 CN-GROUPING-PRIME    PIC XXX.
  6948         16  CN-STATE                PIC XX.
  6949         16  CN-ACCOUNT.
  6950             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6951             20 CN-ACCOUNT-PRIME     PIC X(6).
  6952         16  CN-CERT-EFF-DT          PIC XX.
  6953         16  CN-CERT-NO.
  6954             20  CN-CERT-PRIME       PIC X(10).
  6955             20  CN-CERT-SFX         PIC X.
  6956
  6957     12  CN-BILLING-START-LINE-NO    PIC 99.
  6958     12  CN-BILLING-END-LINE-NO      PIC 99.
  6959
  6960     12  CN-LINES.
  6961         16  CN-LINE OCCURS 10       PIC X(77).
  6962
  6963     12  CN-LAST-MAINT-DT            PIC XX.
  6964     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 129
* EL6311.cbl
  6965     12  CN-LAST-MAINT-USER          PIC X(4).
  6966     12  FILLER                      PIC X(6).
  6967******************************************************************
  6968*                                COPY ERCPNDM.
  6969******************************************************************
  6970*                                                                *
  6971*                                                                *
  6972*                            ERCPNDM                             *
  6973*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6974*                            VMOD=2.003                          *
  6975*                                                                *
  6976*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6977*                                                                *
  6978*   FILE TYPE = VSAM,KSDS                                        *
  6979*   RECORD SIZE = 374   RECFORM = FIX                            *
  6980*                                                                *
  6981*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6982*   ALTERNATE PATH    = NOT USED                                 *
  6983*                                                                *
  6984*   LOG = YES                                                    *
  6985*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6986******************************************************************
  6987*                   C H A N G E   L O G
  6988*
  6989* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6990*-----------------------------------------------------------------
  6991*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6992* EFFECTIVE    NUMBER
  6993*-----------------------------------------------------------------
  6994* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6995* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6996* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6997* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  6998******************************************************************
  6999
  7000 01  PENDING-MAILING-DATA.
  7001     12  PM-RECORD-ID                      PIC XX.
  7002         88  VALID-MA-ID                       VALUE 'PM'.
  7003
  7004     12  PM-CONTROL-PRIMARY.
  7005         16  PM-COMPANY-CD                 PIC X.
  7006         16  PM-ENTRY-BATCH                PIC X(6).
  7007         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  7008         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  7009
  7010     12  FILLER                            PIC X(14).
  7011
  7012     12  PM-ACCESS-CONTROL.
  7013         16  PM-SOURCE-SYSTEM              PIC XX.
  7014             88  PM-FROM-CREDIT                VALUE 'CR'.
  7015             88  PM-FROM-VSI                   VALUE 'VS'.
  7016             88  PM-FROM-WARRANTY              VALUE 'WA'.
  7017             88  PM-FROM-OTHER                 VALUE 'OT'.
  7018         16  PM-RECORD-ADD-DT              PIC XX.
  7019         16  PM-RECORD-ADDED-BY            PIC XXXX.
  7020         16  PM-LAST-MAINT-DT              PIC XX.
  7021         16  PM-LAST-MAINT-BY              PIC XXXX.
  7022         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 130
* EL6311.cbl
  7023
  7024     12  PM-PROFILE-INFO.
  7025         16  PM-QUALIFY-CODE-1             PIC XX.
  7026         16  PM-QUALIFY-CODE-2             PIC XX.
  7027         16  PM-QUALIFY-CODE-3             PIC XX.
  7028         16  PM-QUALIFY-CODE-4             PIC XX.
  7029         16  PM-QUALIFY-CODE-5             PIC XX.
  7030
  7031         16  PM-INSURED-LAST-NAME          PIC X(15).
  7032         16  PM-INSURED-FIRST-NAME         PIC X(10).
  7033         16  PM-INSURED-MIDDLE-INIT        PIC X.
  7034         16  PM-INSURED-ISSUE-AGE          PIC 99.
  7035         16  PM-INSURED-BIRTH-DT           PIC XX.
  7036         16  PM-INSURED-SEX                PIC X.
  7037             88  PM-SEX-MALE                   VALUE 'M'.
  7038             88  PM-SEX-FEMALE                 VALUE 'F'.
  7039         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  7040
  7041         16  PM-ADDRESS-CORRECTED          PIC X.
  7042         16  PM-JOINT-BIRTH-DT             PIC XX.
  7043*        16  FILLER                        PIC X(12).
  7044
  7045         16  PM-ADDRESS-LINE-1             PIC X(30).
  7046         16  PM-ADDRESS-LINE-2             PIC X(30).
  7047         16  PM-CITY-STATE.
  7048             20  PM-CITY                   PIC X(28).
  7049             20  PM-STATE                  PIC XX.
  7050         16  PM-ZIP.
  7051             20  PM-ZIP-CODE.
  7052                 24  PM-ZIP-1              PIC X.
  7053                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7054                 24  FILLER                PIC X(4).
  7055             20  PM-ZIP-PLUS4              PIC X(4).
  7056         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  7057             20  PM-CAN-POST1              PIC XXX.
  7058             20  PM-CAN-POST2              PIC XXX.
  7059             20  FILLER                    PIC XXX.
  7060
  7061         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  7062         16  pm-city-st-zip-verified       pic x.
  7063         16  FILLER                        PIC XX.
  7064
  7065     12  PM-CRED-BENE-INFO.
  7066         16  PM-CRED-BENE-NAME             PIC X(25).
  7067         16  PM-CRED-BENE-ADDR             PIC X(30).
  7068         16  PM-CRED-BENE-ADDR2            PIC X(30).
  7069         16  PM-CRED-BENE-CTYST.
  7070             20  PM-CRED-BENE-CITY         PIC X(28).
  7071             20  PM-CRED-BENE-STATE        PIC XX.
  7072         16  PM-CRED-BENE-ZIP.
  7073             20  PM-CB-ZIP-CODE.
  7074                 24  PM-CB-ZIP-1           PIC X.
  7075                     88  PM-CB-CANADIAN-POST-CODE
  7076                                  VALUE 'A' THRU 'Z'.
  7077                 24  FILLER                PIC X(4).
  7078             20  PM-CB-ZIP-PLUS4           PIC X(4).
  7079         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  7080             20  PM-CB-CAN-POST1           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 131
* EL6311.cbl
  7081             20  PM-CB-CAN-POST2           PIC XXX.
  7082             20  FILLER                    PIC XXX.
  7083     12  PM-POST-CARD-MAIL-DATA.
  7084         16  PM-MAIL-DATA OCCURS 7.
  7085             20  PM-MAIL-TYPE              PIC X.
  7086                 88  PM-12MO-MAILING           VALUE '1'.
  7087                 88  PM-EXP-MAILING            VALUE '2'.
  7088             20  PM-MAIL-STATUS            PIC X.
  7089                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  7090                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  7091                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  7092             20  PM-MAIL-DATE              PIC XX.
  7093     12  FILLER                            PIC XX.
  7094     12  FILLER                            PIC X(12).
  7095*    12  FILLER                            PIC X(30).
  7096
  7097******************************************************************
  7098*                                COPY ERCMAIL.
  7099******************************************************************
  7100*                                                                *
  7101*                                                                *
  7102*                            ERCMAIL                             *
  7103*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7104*                            VMOD=2.003                          *
  7105*                                                                *
  7106*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7107*                                                                *
  7108*   FILE TYPE = VSAM,KSDS                                        *
  7109*   RECORD SIZE = 374   RECFORM = FIX                            *
  7110*                                                                *
  7111*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7112*   ALTERNATE PATH    = NOT USED                                 *
  7113*                                                                *
  7114*   LOG = YES                                                    *
  7115*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7116******************************************************************
  7117*                   C H A N G E   L O G
  7118*
  7119* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7120*-----------------------------------------------------------------
  7121*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7122* EFFECTIVE    NUMBER
  7123*-----------------------------------------------------------------
  7124* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7125* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7126* 111108                   PEMA  ADD CRED BENE ADDR2
  7127******************************************************************
  7128
  7129 01  MAILING-DATA.
  7130     12  MA-RECORD-ID                      PIC XX.
  7131         88  VALID-MA-ID                       VALUE 'MA'.
  7132
  7133     12  MA-CONTROL-PRIMARY.
  7134         16  MA-COMPANY-CD                 PIC X.
  7135         16  MA-CARRIER                    PIC X.
  7136         16  MA-GROUPING.
  7137             20  MA-GROUPING-PREFIX        PIC XXX.
  7138             20  MA-GROUPING-PRIME         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 132
* EL6311.cbl
  7139         16  MA-STATE                      PIC XX.
  7140         16  MA-ACCOUNT.
  7141             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7142             20  MA-ACCOUNT-PRIME          PIC X(6).
  7143         16  MA-CERT-EFF-DT                PIC XX.
  7144         16  MA-CERT-NO.
  7145             20  MA-CERT-PRIME             PIC X(10).
  7146             20  MA-CERT-SFX               PIC X.
  7147
  7148     12  FILLER                            PIC XX.
  7149
  7150     12  MA-ACCESS-CONTROL.
  7151         16  MA-SOURCE-SYSTEM              PIC XX.
  7152             88  MA-FROM-CREDIT                VALUE 'CR'.
  7153             88  MA-FROM-VSI                   VALUE 'VS'.
  7154             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7155             88  MA-FROM-OTHER                 VALUE 'OT'.
  7156         16  MA-RECORD-ADD-DT              PIC XX.
  7157         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7158         16  MA-LAST-MAINT-DT              PIC XX.
  7159         16  MA-LAST-MAINT-BY              PIC XXXX.
  7160         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7161
  7162     12  MA-PROFILE-INFO.
  7163         16  MA-QUALIFY-CODE-1             PIC XX.
  7164         16  MA-QUALIFY-CODE-2             PIC XX.
  7165         16  MA-QUALIFY-CODE-3             PIC XX.
  7166         16  MA-QUALIFY-CODE-4             PIC XX.
  7167         16  MA-QUALIFY-CODE-5             PIC XX.
  7168
  7169         16  MA-INSURED-LAST-NAME          PIC X(15).
  7170         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7171         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7172         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7173         16  MA-INSURED-BIRTH-DT           PIC XX.
  7174         16  MA-INSURED-SEX                PIC X.
  7175             88  MA-SEX-MALE                   VALUE 'M'.
  7176             88  MA-SEX-FEMALE                 VALUE 'F'.
  7177         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7178
  7179         16  MA-ADDRESS-CORRECTED          PIC X.
  7180         16  MA-JOINT-BIRTH-DT             PIC XX.
  7181*        16  FILLER                        PIC X(12).
  7182
  7183         16  MA-ADDRESS-LINE-1             PIC X(30).
  7184         16  MA-ADDRESS-LINE-2             PIC X(30).
  7185         16  MA-CITY-STATE.
  7186             20  MA-CITY                   PIC X(28).
  7187             20  MA-ADDR-STATE             PIC XX.
  7188         16  MA-ZIP.
  7189             20  MA-ZIP-CODE.
  7190                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7191                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7192                 24  FILLER                PIC X(4).
  7193             20  MA-ZIP-PLUS4              PIC X(4).
  7194         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7195             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7196             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 133
* EL6311.cbl
  7197             20  FILLER                    PIC X(3).
  7198
  7199         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7200
  7201         16  FILLER                        PIC XXX.
  7202*        16  FILLER                        PIC X(10).
  7203
  7204     12  MA-CRED-BENE-INFO.
  7205         16  MA-CRED-BENE-NAME                 PIC X(25).
  7206         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7207         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7208         16  MA-CRED-BENE-CTYST.
  7209             20  MA-CRED-BENE-CITY             PIC X(28).
  7210             20  MA-CRED-BENE-STATE            PIC XX.
  7211         16  MA-CRED-BENE-ZIP.
  7212             20  MA-CB-ZIP-CODE.
  7213                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7214                     88  MA-CB-CANADIAN-POST-CODE
  7215                                           VALUE 'A' THRU 'Z'.
  7216                 24  FILLER                    PIC X(4).
  7217             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7218         16  MA-CB-CANADIAN-POSTAL-CODE
  7219                            REDEFINES MA-CRED-BENE-ZIP.
  7220             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7221             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7222             20  FILLER                        PIC X(3).
  7223     12  MA-POST-CARD-MAIL-DATA.
  7224         16  MA-MAIL-DATA OCCURS 7.
  7225             20  MA-MAIL-TYPE              PIC X.
  7226                 88  MA-12MO-MAILING           VALUE '1'.
  7227                 88  MA-EXP-MAILING            VALUE '2'.
  7228             20  MA-MAIL-STATUS            PIC X.
  7229                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7230                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7231                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7232             20  MA-MAIL-DATE              PIC XX.
  7233     12  FILLER                            PIC XX.
  7234     12  FILLER                            PIC XX.
  7235*    12  FILLER                            PIC X(30).
  7236******************************************************************
  7237*                                COPY ERCRQST.
  7238******************************************************************
  7239*                                                                *
  7240*                                                                *
  7241*                            ERCRQST.                            *
  7242*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7243*                            VMOD=2.002                          *
  7244*                                                                *
  7245*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7246*                                                                *
  7247*   FILE TYPE = VSAM,KSDS                                        *
  7248*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7249*                                                                *
  7250*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7251*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7252*                                   ACCOUNT, REF, BATCH)         *
  7253*                                                RKP=9, LEN=38   *
  7254*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 134
* EL6311.cbl
  7255*                                   ACCOUNT, REF, BATCH)         *
  7256*                                                RKP=47, LEN=46  *
  7257*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7258*                                   BATCH)                       *
  7259*                                                RKP=93, LEN=24  *
  7260*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7261*                                   REF, BATCH)                  *
  7262*                                                RKP=117, LEN=35 *
  7263*   LOG = NO                                                     *
  7264*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7265******************************************************************
  7266
  7267 01  AR-REQUEST-RECORD.
  7268     12  RQ-RECORD-ID                     PIC XX.
  7269         88  VALID-RQ-ID                        VALUE 'RQ'.
  7270
  7271     12  RQ-CONTROL-PRIMARY.
  7272         16  RQ-COMPANY-CD                PIC X.
  7273         16  RQ-ENTRY-BATCH               PIC X(6).
  7274
  7275     12  RQ-CONTROL-BY-ACCT-REF.
  7276         16  RQ-COMPANY-CD-A1             PIC X.
  7277         16  RQ-CARRIER-A1                PIC X.
  7278         16  RQ-GROUPING-A1               PIC X(6).
  7279         16  RQ-STATE-A1                  PIC XX.
  7280         16  RQ-ACCOUNT-A1                PIC X(10).
  7281         16  RQ-REFERENCE-A1              PIC X(12).
  7282         16  RQ-BATCH-A1                  PIC X(6).
  7283
  7284     12  RQ-CONTROL-BY-FIN-RESP.
  7285         16  RQ-COMPANY-CD-A2             PIC X.
  7286         16  RQ-CARRIER-A2                PIC X.
  7287         16  RQ-GROUPING-A2               PIC X(6).
  7288         16  RQ-FIN-RESP-A2               PIC X(10).
  7289         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7290         16  RQ-REFERENCE-A2              PIC X(12).
  7291         16  RQ-BATCH-A2                  PIC X(6).
  7292
  7293     12  RQ-CONTROL-BY-ACCT-AGENT.
  7294         16  RQ-COMPANY-CD-A3             PIC X.
  7295         16  RQ-CARRIER-A3                PIC X.
  7296         16  RQ-GROUPING-A3               PIC X(6).
  7297         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7298         16  RQ-BATCH-A3                  PIC X(6).
  7299
  7300     12  RQ-CONTROL-BY-SUMMARY.
  7301         16  RQ-COMPANY-CD-A4             PIC X.
  7302         16  RQ-SUMMARY-CODE              PIC X(6).
  7303         16  RQ-ACCOUNT-A4                PIC X(10).
  7304         16  RQ-REFERENCE-A4              PIC X(12).
  7305         16  RQ-BATCH-A4                  PIC X(6).
  7306
  7307     12  RQ-REQUEST-METHOD                PIC X.
  7308         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7309         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7310         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7311         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7312     12  FILLER                           PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 135
* EL6311.cbl
  7313     12  RQ-STATUS                        PIC X.
  7314         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7315         88  RQ-RESUBMIT                      VALUE 'R'.
  7316     12  RQ-PROCESSOR-ID                  PIC X(4).
  7317     12  RQ-ENTRY-DT                      PIC XX.
  7318     12  RQ-MO-END-DT                     PIC XX.
  7319     12  RQ-REQUEST-DT                    PIC XX.
  7320     12  RQ-STMT-DT                       PIC XX.
  7321     12  RQ-REVERSAL-DT                   PIC XX.
  7322     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7323     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7324
  7325     12  FILLER                           PIC X(27).
  7326
  7327******************************************************************
  7328
  7329*                                COPY ERCLOFC.
  7330******************************************************************
  7331*                                                                *
  7332*                                                                *
  7333*                            ERCLOFC                             *
  7334*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7335*                            VMOD=2.003                          *
  7336*                                                                *
  7337*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7338*                                                                *
  7339*   FILE TYPE = VSAM,KSDS                                        *
  7340*   RECORD SIZE = 670   RECFORM = FIX                            *
  7341*                                                                *
  7342*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7343*                                                                *
  7344*   LOG = YES                                                    *
  7345*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7346*                                                                *
  7347******************************************************************
  7348
  7349 01  LOAN-OFFICER-MASTER.
  7350     12  LO-RECORD-ID                PIC XX.
  7351         88  VALID-LO-ID                VALUE 'LO'.
  7352
  7353     12  LO-CONTROL-PRIMARY.
  7354         16  LO-COMPANY-CD           PIC X.
  7355         16  LO-CARRIER              PIC X.
  7356         16  LO-GROUPING.
  7357             20  LO-GROUPING-PREFIX  PIC XXX.
  7358             20  LO-GROUPING-PRIME   PIC XXX.
  7359         16  LO-STATE                PIC XX.
  7360         16  LO-ACCOUNT.
  7361             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7362             20  LO-ACCOUNT-PRIME    PIC X(6).
  7363         16  LO-OFFICER-CODE         PIC X(5).
  7364
  7365     12  LO-OFFICER-NAME             PIC X(30).
  7366
  7367     12  LO-LAST-MAINT-DT            PIC XX.
  7368     12  LO-LAST-USER                PIC X(4).
  7369     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7370
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 136
* EL6311.cbl
  7371     12  LO-COMP-CONTROL             PIC X.
  7372             88  LO-SHOW-COMP           VALUE 'Y'.
  7373             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7374     12  LO-DETAIL-CONTROL           PIC X.
  7375             88  LO-PRINT-DETAIL        VALUE 'D'.
  7376             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7377
  7378     12  LO-SV-CARRIER               PIC X.
  7379     12  LO-SV-GROUPING              PIC X(6).
  7380     12  LO-SV-STATE                 PIC XX.
  7381
  7382     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7383     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7384
  7385     12  LO-OFFICER-INFO.
  7386         16  FILLER OCCURS 12 TIMES.
  7387             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7388             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7389             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7390             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7391             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7392             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7393             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7394             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7395     12  FILLER                      PIC X(198).
  7396******************************************************************
  7397*                                COPY ERCPYAJ.
  7398******************************************************************
  7399*                                                                *
  7400*                            ERCPYAJ                             *
  7401*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7402*                            VMOD=2.015                          *
  7403*                                                                *
  7404*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7405*                                                                *
  7406*                                                                *
  7407*   FILE TYPE = VSAM,KSDS                                        *
  7408*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7409*                                                                *
  7410*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7411*       ALTERNATE PATHS = NONE                                   *
  7412*                                                                *
  7413*   LOG = YES                                                    *
  7414*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7415******************************************************************
  7416******************************************************************
  7417*                   C H A N G E   L O G
  7418*
  7419* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7420*-----------------------------------------------------------------
  7421*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7422* EFFECTIVE    NUMBER
  7423*-----------------------------------------------------------------
  7424* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7425* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7426******************************************************************
  7427
  7428 01  PENDING-PAY-ADJ.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 137
* EL6311.cbl
  7429     12  PY-RECORD-ID                     PIC XX.
  7430         88  VALID-PY-ID                        VALUE 'PY'.
  7431
  7432     12  PY-CONTROL-PRIMARY.
  7433         16  PY-COMPANY-CD                PIC X.
  7434         16  PY-CARRIER                   PIC X.
  7435         16  PY-GROUPING                  PIC X(6).
  7436         16  PY-FIN-RESP                  PIC X(10).
  7437         16  PY-ACCOUNT                   PIC X(10).
  7438         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7439                                          PIC X(10).
  7440         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7441         16  PY-RECORD-TYPE               PIC X.
  7442             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7443             88  PY-DEPOSIT                   VALUE 'D'.
  7444             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7445             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7446             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7447             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7448             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7449             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7450             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7451             88  PY-FICA-ENTRY                VALUE 'F'.
  7452             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7453             88  PY-POLICY-FEE                VALUE 'W'.
  7454             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7455
  7456     12  PY-PYMT-TYPE                     PIC X.
  7457             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7458             88  PY-REINS-PYMT                VALUE 'R'.
  7459             88  PY-EXP-PYMT                  VALUE 'E'.
  7460
  7461     12  PY-BIL-INV                       PIC X(6).
  7462     12  PY-REF-NO                        PIC X(12).
  7463
  7464     12  PY-LAST-MAINT-DT                 PIC XX.
  7465     12  PY-LAST-MAINT-BY                 PIC X(4).
  7466     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7467
  7468     12  PY-PYADJ-RECORD.
  7469         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7470         16  PY-ENTRY-COMMENT             PIC X(30).
  7471         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7472             20  PY-GL-ACCOUNT            PIC X(10).
  7473             20  PY-GL-STATE              PIC X(02).
  7474             20  PY-GL-CANC-SW            PIC X(01).
  7475                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7476                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7477             20  PY-GL-COMMENT            PIC X(10).
  7478             20  FILLER      REDEFINES PY-GL-COMMENT.
  7479                 24  PY-GL-CHECK-NO       PIC 9(06).
  7480                 24  FILLER               PIC X(04).
  7481             20  FILLER                   PIC X(07).
  7482         16  PY-SAVE-ACCOUNT              PIC X(10).
  7483         16  PY-SAVE-TYPE                 PIC X(01).
  7484
  7485         16  PY-LETTERS.
  7486             20  PY-LETTER OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 138
* EL6311.cbl
  7487                           INDEXED BY PY-LET-NDX
  7488                                          PIC X(04).
  7489
  7490         16  PY-ERCOMP-TYPE               PIC X.
  7491             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7492             88  PY-GA-TYPE                   VALUE 'G'.
  7493             88  PY-BANK-TYPE                 VALUE 'B'.
  7494         16  FILLER                       PIC X(05).
  7495
  7496     12  PY-RECORD-STATUS.
  7497         16  PY-CREDIT-SELECT-DT          PIC XX.
  7498         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7499         16  PY-BILLED-DATE               PIC XX.
  7500         16  PY-REPORTED-DT               PIC XX.
  7501         16  PY-PMT-APPLIED               PIC X.
  7502             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7503             88  PY-GA-PMT                    VALUE 'G'.
  7504             88  PY-OVWRITE-PMT               VALUE 'O'.
  7505             88  PY-NON-AR-PMT                VALUE 'N'.
  7506         16  FILLER                       PIC X(5).
  7507         16  PY-INPUT-DT                  PIC XX.
  7508         16  PY-CHECK-NUMBER              PIC X(6).
  7509         16  PY-VOID-SW                   PIC X.
  7510             88  PY-CHECK-VOIDED              VALUE 'V'.
  7511         16  PY-CHECK-ORIGIN-SW           PIC X.
  7512             88  PY-BILLING-CHECK             VALUE 'B'.
  7513             88  PY-REFUND-CHECK              VALUE 'R'.
  7514             88  PY-GA-CHECK                  VALUE 'G'.
  7515             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7516             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7517         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7518         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7519         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7520         16  PY-BILL-FLAG                 PIC X.
  7521             88  PY-BILLED                    VALUE 'B'.
  7522         16  PY-AR-FLAG                   PIC X.
  7523             88  PY-AR-CYCLE                  VALUE 'C'.
  7524             88  PY-AR-MONTH-END              VALUE 'M'.
  7525         16  PY-AR-DATE                   PIC XX.
  7526
  7527     12  PY-GL-CODES.
  7528         16  PY-GL-DB                     PIC X(14).
  7529         16  PY-GL-CR                     PIC X(14).
  7530         16  PY-GL-FLAG                   PIC X.
  7531         16  PY-GL-DATE                   PIC XX.
  7532
  7533     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7534     12  FILLER                           PIC X(3).
  7535******************************************************************
  7536*                                COPY ERCCNOT.
  7537******************************************************************
  7538*                                                                *
  7539*                            ERCCNOT                             *
  7540*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7541*                            VMOD=2.003                          *
  7542*                                                                *
  7543*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7544*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 139
* EL6311.cbl
  7545*        FILE TYPE= VSAM,KSDS                                    *
  7546*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7547*                                                                *
  7548*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7549*                                                                *
  7550*        LOG = YES                                               *
  7551*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7552*                                                                *
  7553******************************************************************
  7554*                   C H A N G E   L O G
  7555*
  7556* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7557*-----------------------------------------------------------------
  7558*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7559* EFFECTIVE    NUMBER
  7560*-----------------------------------------------------------------
  7561* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7562******************************************************************
  7563
  7564 01  CERT-NOTE-FILE.
  7565     12  CZ-RECORD-ID                PIC  XX.
  7566         88  VALID-CZ-ID                  VALUE 'CZ'.
  7567
  7568     12  CZ-CONTROL-PRIMARY.
  7569         16  CZ-COMPANY-CD           PIC X.
  7570         16  CZ-CARRIER              PIC X.
  7571         16  CZ-GROUPING.
  7572             20 CZ-GROUPING-PREFIX   PIC XXX.
  7573             20 CZ-GROUPING-PRIME    PIC XXX.
  7574         16  CZ-STATE                PIC XX.
  7575         16  CZ-ACCOUNT.
  7576             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7577             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7578         16  CZ-CERT-EFF-DT          PIC XX.
  7579         16  CZ-CERT-NO.
  7580             20  CZ-CERT-PRIME       PIC X(10).
  7581             20  CZ-CERT-SFX         PIC X.
  7582         16  CZ-RECORD-TYPE          PIC X.
  7583             88  CERT-NOTE           VALUE '1'.
  7584             88  CLAIM-CERT-NOTE     VALUE '2'.
  7585         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7586
  7587     12  CZ-LAST-MAINT-DT            PIC XX.
  7588     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7589     12  CZ-LAST-MAINT-USER          PIC X(4).
  7590
  7591     12  CZ-NOTE-INFORMATION.
  7592         16  CZ-NOTE                 PIC X(63).
  7593         16  FILLER                  PIC X(39).
  7594******************************************************************
  7595*                                COPY ELCMSTR.
  7596******************************************************************
  7597*                                                                *
  7598*                            ELCMSTR.                            *
  7599*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7600*                            VMOD=2.012                          *
  7601*                                                                *
  7602*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 140
* EL6311.cbl
  7603*                                                                *
  7604*   FILE TYPE = VSAM,KSDS                                        *
  7605*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7606*                                                                *
  7607*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7608*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7609*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7610*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7611*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7612*                                                 RKP=75,LEN=21  *
  7613*                                                                *
  7614*   **** NOTE ****                                               *
  7615*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7616*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7617*                                                                *
  7618*   LOG = YES                                                    *
  7619*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7620******************************************************************
  7621*                   C H A N G E   L O G
  7622*
  7623* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7624*-----------------------------------------------------------------
  7625*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7626* EFFECTIVE    NUMBER
  7627*-----------------------------------------------------------------
  7628* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7629* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7630* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7631* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7632* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7633* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7634* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7635******************************************************************
  7636 01  CLAIM-MASTER.
  7637     12  CL-RECORD-ID                PIC XX.
  7638         88  VALID-CL-ID         VALUE 'CL'.
  7639
  7640     12  CL-CONTROL-PRIMARY.
  7641         16  CL-COMPANY-CD           PIC X.
  7642         16  CL-CARRIER              PIC X.
  7643         16  CL-CLAIM-NO             PIC X(7).
  7644         16  CL-CERT-NO.
  7645             20  CL-CERT-PRIME       PIC X(10).
  7646             20  CL-CERT-SFX         PIC X.
  7647
  7648     12  CL-CONTROL-BY-NAME.
  7649         16  CL-COMPANY-CD-A1        PIC X.
  7650         16  CL-INSURED-LAST-NAME    PIC X(15).
  7651         16  CL-INSURED-NAME.
  7652             20  CL-INSURED-1ST-NAME PIC X(12).
  7653             20  CL-INSURED-MID-INIT PIC X.
  7654
  7655     12  CL-CONTROL-BY-SSN.
  7656         16  CL-COMPANY-CD-A2        PIC X.
  7657         16  CL-SOC-SEC-NO.
  7658             20  CL-SSN-STATE        PIC XX.
  7659             20  CL-SSN-ACCOUNT      PIC X(6).
  7660             20  CL-SSN-LN3          PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 141
* EL6311.cbl
  7661
  7662     12  CL-CONTROL-BY-CERT-NO.
  7663         16  CL-COMPANY-CD-A4        PIC X.
  7664         16  CL-CERT-NO-A4.
  7665             20  CL-CERT-A4-PRIME    PIC X(10).
  7666             20  CL-CERT-A4-SFX      PIC X.
  7667
  7668     12  CL-CONTROL-BY-CCN.
  7669         16  CL-COMPANY-CD-A5        PIC X.
  7670         16  CL-CCN-A5.
  7671             20  CL-CCN.
  7672                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7673                 24  CL-CCN-PRIME-A5 PIC X(12).
  7674             20  CL-CCN-FILLER-A5    PIC X(4).
  7675
  7676     12  CL-INSURED-PROFILE-DATA.
  7677         16  CL-INSURED-BIRTH-DT     PIC XX.
  7678         16  CL-INSURED-SEX-CD       PIC X.
  7679             88  INSURED-IS-MALE        VALUE 'M'.
  7680             88  INSURED-IS-FEMALE      VALUE 'F'.
  7681             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7682         16  CL-INSURED-OCC-CD       PIC X(6).
  7683         16  FILLER                  PIC X(5).
  7684
  7685     12  CL-PROCESSING-INFO.
  7686         16  CL-PROCESSOR-ID         PIC X(4).
  7687         16  CL-CLAIM-STATUS         PIC X.
  7688             88  CLAIM-IS-OPEN          VALUE 'O'.
  7689             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7690         16  CL-CLAIM-TYPE           PIC X.
  7691*            88  AH-CLAIM               VALUE 'A'.
  7692*            88  LIFE-CLAIM             VALUE 'L'.
  7693*            88  PROPERTY-CLAIM         VALUE 'P'.
  7694*            88  IUI-CLAIM              VALUE 'I'.
  7695*            88  GAP-CLAIM              VALUE 'G'.
  7696*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7697*            88  OTHER-CLAIM            VALUE 'O'.
  7698         16  CL-CLAIM-PREM-TYPE      PIC X.
  7699             88  SINGLE-PREMIUM         VALUE '1'.
  7700             88  O-B-COVERAGE           VALUE '2'.
  7701             88  OPEN-END-COVERAGE      VALUE '3'.
  7702         16  CL-INCURRED-DT          PIC XX.
  7703         16  CL-REPORTED-DT          PIC XX.
  7704         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7705         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7706         16  CL-LAST-PMT-DT          PIC XX.
  7707         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7708         16  CL-PAID-THRU-DT         PIC XX.
  7709         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7710         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7711         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7712         16  CL-PMT-CALC-METHOD      PIC X.
  7713             88  CL-360-DAY-YR          VALUE '1'.
  7714             88  CL-365-DAY-YR          VALUE '2'.
  7715             88  CL-FULL-MONTHS         VALUE '3'.
  7716         16  CL-CAUSE-CD             PIC X(6).
  7717
  7718         16  CL-PRIME-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 142
* EL6311.cbl
  7719             20  CL-PRIME-CERT-PRIME PIC X(10).
  7720             20  CL-PRIME-CERT-SFX   PIC X.
  7721
  7722         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7723             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7724             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7725
  7726         16  CL-MICROFILM-NO         PIC X(10).
  7727         16  FILLER REDEFINES CL-MICROFILM-NO.
  7728             20  CL-BENEFIT-PERIOD   PIC 99.
  7729             20  FILLER              PIC X(8).
  7730         16  CL-PROG-FORM-TYPE       PIC X.
  7731         16  CL-LAST-ADD-ON-DT       PIC XX.
  7732
  7733         16  CL-LAST-REOPEN-DT       PIC XX.
  7734         16  CL-LAST-CLOSE-DT        PIC XX.
  7735         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7736             88  FINAL-PAID             VALUE '1'.
  7737             88  CLAIM-DENIED           VALUE '2'.
  7738             88  AUTO-CLOSE             VALUE '3'.
  7739             88  MANUAL-CLOSE           VALUE '4'.
  7740             88  BENEFITS-CHANGED       VALUE 'C'.
  7741             88  SETUP-ERRORS           VALUE 'E'.
  7742         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7743         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7744         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7745             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7746         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7747         16  FILLER                  PIC X.
  7748
  7749     12  CL-CERTIFICATE-DATA.
  7750         16  CL-CERT-ORIGIN          PIC X.
  7751             88  CERT-WAS-ONLINE        VALUE '1'.
  7752             88  CERT-WAS-CREATED       VALUE '2'.
  7753             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7754         16  CL-CERT-KEY-DATA.
  7755             20  CL-CERT-CARRIER     PIC X.
  7756             20  CL-CERT-GROUPING    PIC X(6).
  7757             20  CL-CERT-STATE       PIC XX.
  7758             20  CL-CERT-ACCOUNT.
  7759                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7760                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7761             20  CL-CERT-EFF-DT      PIC XX.
  7762
  7763     12  CL-STATUS-CONTROLS.
  7764         16  CL-PRIORITY-CD          PIC X.
  7765             88  CONFIDENTIAL-DATA      VALUE '8'.
  7766             88  HIGHEST-PRIORITY       VALUE '9'.
  7767         16  CL-SUPV-ATTN-CD         PIC X.
  7768             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7769             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7770         16  CL-PURGED-DT            PIC XX.
  7771         16  CL-RESTORED-DT          PIC XX.
  7772         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7773         16  CL-NEXT-RESEND-DT       PIC XX.
  7774         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7775         16  CL-CRITICAL-PERIOD      PIC 99.
  7776*        16  FILLER                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 143
* EL6311.cbl
  7777         16  CL-LAST-MAINT-DT        PIC XX.
  7778         16  CL-LAST-MAINT-USER      PIC X(4).
  7779         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7780         16  CL-LAST-MAINT-TYPE      PIC X.
  7781             88  CLAIM-SET-UP           VALUE ' '.
  7782             88  PAYMENT-MADE           VALUE '1'.
  7783             88  LETTER-SENT            VALUE '2'.
  7784             88  MASTER-WAS-ALTERED     VALUE '3'.
  7785             88  MASTER-WAS-RESTORED    VALUE '4'.
  7786             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7787             88  FILE-CONVERTED         VALUE '6'.
  7788             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7789             88  ERROR-CORRECTION       VALUE 'E'.
  7790         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7791         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7792         16  CL-BENEFICIARY          PIC X(10).
  7793         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7794         16  CL-DENIAL-TYPE          PIC X.
  7795             88  CL-TYPE-DENIAL          VALUE '1'.
  7796             88  CL-TYPE-RESCISSION      VALUE '2'.
  7797             88  CL-TYPE-REFORMATION     VALUE '3'.
  7798             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7799             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7800         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7801         16  filler                  pic x(3).
  7802*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7803*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7804*        16  CL-RTW-DT               PIC XX.
  7805
  7806     12  CL-TRAILER-CONTROLS.
  7807         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7808             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7809             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7810             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7811         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7812         16  FILLER                  PIC XX.
  7813         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7814         16  CL-ADDRESS-TRAILER-CNT.
  7815             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7816                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7817             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7818                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7819             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7820                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7821             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7822                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7823             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7824                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7825             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7826                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7827             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7828                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7829
  7830     12  CL-CV-REFERENCE-NO.
  7831         16  CL-CV-REFNO-PRIME       PIC X(18).
  7832         16  CL-CV-REFNO-SFX         PIC XX.
  7833
  7834     12  CL-FILE-LOCATION            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 144
* EL6311.cbl
  7835
  7836     12  CL-PROCESS-ERRORS.
  7837         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7838             88  NO-FATAL-ERRORS        VALUE ZERO.
  7839         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7840             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7841
  7842     12  CL-PRODUCT-CD               PIC X.
  7843
  7844     12  CL-CURRENT-KEY-DATA.
  7845         16  CL-CURRENT-CARRIER      PIC X.
  7846         16  CL-CURRENT-GROUPING     PIC X(6).
  7847         16  CL-CURRENT-STATE        PIC XX.
  7848         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7849
  7850     12  CL-ASSOCIATES               PIC X.
  7851         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7852         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7853         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7854         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7855
  7856     12  CL-ACTIVITY-CODE            PIC 99.
  7857     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7858     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7859
  7860     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7861     12  CL-LAG-REPORT-CODE          PIC 9.
  7862     12  CL-LOAN-TYPE                PIC XX.
  7863     12  CL-LEGAL-STATE              PIC XX.
  7864
  7865     12  CL-YESNOSW                  PIC X.
  7866     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7867         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7868         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7869         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7870     12  cl-insured-type             pic x.
  7871         88  cl-claim-on-primary         value 'P'.
  7872         88  cl-claim-on-co-borrower     value 'C'.
  7873     12  cl-benefit-expiration-dt    PIC XX.
  7874*                                COPY ERCENDT.
  7875******************************************************************
  7876*                                                                *
  7877*                                                                *
  7878*                            ERCENDT.                            *
  7879*                            VMOD=2.001                          *
  7880*                                                                *
  7881*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7882*                                                                *
  7883*   FILE TYPE = VSAM,KSDS                                        *
  7884*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7885*                                                                *
  7886*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7887*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7888*                                                                *
  7889*   LOG = NO                                                     *
  7890*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7891******************************************************************
  7892*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 145
* EL6311.cbl
  7893*                   C H A N G E   L O G
  7894*
  7895* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7896*-----------------------------------------------------------------
  7897*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7898* EFFECTIVE    NUMBER
  7899*-----------------------------------------------------------------
  7900* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7901*                                WITH OPEN CLAIMS
  7902* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7903* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7904* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7905* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7906*-----------------------------------------------------------------
  7907 01  ENDORSEMENT-RECORD.
  7908     12  EN-RECORD-ID                PIC XX.
  7909         88  VALID-EN-ID                VALUE 'EN'.
  7910     12  EN-CONTROL-PRIMARY.
  7911         16  EN-COMPANY-CD           PIC X.
  7912         16  EN-CARRIER              PIC X.
  7913         16  EN-GROUPING             PIC X(6).
  7914         16  EN-STATE                PIC XX.
  7915         16  EN-ACCOUNT              PIC X(10).
  7916         16  EN-CERT-EFF-DT          PIC XX.
  7917         16  EN-CERT-NO.
  7918             20  EN-CERT-PRIME       PIC X(10).
  7919             20  EN-CERT-SFX         PIC X.
  7920         16  EN-REC-TYPE             PIC X.
  7921             88  EN-ISSUE               VALUE 'I'.
  7922             88  EN-CANCELLATION        VALUE 'C'.
  7923         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7924     12  EN-CONTROL-BY-ARCH-NO.
  7925         16  EN-COMPANY-CD-A1              PIC X.
  7926         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7927     12  EN-LAST-MAINT-DT            PIC XX.
  7928     12  EN-LAST-MAINT-BY            PIC X(4).
  7929     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7930     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7931     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7932         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7933         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7934         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7935         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7936         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7937         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7938         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7939         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7940         16  EN-LF-ORIG-BENCD        PIC XX.
  7941         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7942         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7943         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7944         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7945         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7946         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7947*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7948         16  EN-ORIG-CRED-BENE       PIC X(25).
  7949         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7950         16  FILLER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 146
* EL6311.cbl
  7951         16  EN-AH-ORIG-BENCD        PIC XX.
  7952         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7953         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7954         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7955         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7956*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7957*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7958         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7959         16  F                       PIC X(09).
  7960         16  EN-AH-ORIG-CP           PIC 99.
  7961         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7962         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7963         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7964         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7965         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7966         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7967         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7968         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7969         16  EN-LF-NEW-BENCD         PIC XX.
  7970         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7971         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7972         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7973         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7974         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7975         16  EN-LF-NEW-EXP-DT        PIC XX.
  7976         16  EN-NEW-CRED-BENE        PIC X(25).
  7977         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7978         16  FILLER                  PIC X.
  7979         16  EN-AH-NEW-BENCD         PIC XX.
  7980         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7981         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7982         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7983         16  EN-AH-NEW-EXP-DT        PIC XX.
  7984*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7985*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7986*        16  F                       PIC X(12).
  7987         16  EN-AH-NEW-CP            PIC 99.
  7988         16  EN-SIG-SW               PIC X.
  7989         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7990         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7991         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7992         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7993         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7994         16  FILLER                  PIC X(33).
  7995     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7996         16  EN-LF-ORIG-REF-DT       PIC XX.
  7997         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7998         16  EN-AH-ORIG-REF-DT       PIC XX.
  7999         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8000         16  EN-LF-NEW-REF-DT        PIC XX.
  8001         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8002         16  EN-AH-NEW-REF-DT        PIC XX.
  8003         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8004         16  EN-FLAG-CERT            PIC X.
  8005         16  EN-INS-LAST-NAME        PIC X(15).
  8006         16  EN-INS-FIRST-NAME       PIC X(10).
  8007         16  EN-INS-MIDDLE-INIT      PIC X.
  8008         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 147
* EL6311.cbl
  8009         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8010         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8011         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8012         16  FILLER                  PIC X(262).
  8013     12  EN-MONEY-SW             PIC X.
  8014     12  EN-HEALTH-APP           PIC X.
  8015     12  EN-VOUCHER-SW           PIC X.
  8016     12  EN-PAYEE                PIC X(14).
  8017     12  EN-INPUT-DT             PIC XX.
  8018     12  EN-PROCESS-DT           PIC XX.
  8019     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8020     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8021     12  EN-REASON-CODES.
  8022         16  F OCCURS 12.
  8023             20  EN-REASON-CODE  PIC X(4).
  8024     12  EN-TEMPLATE-USED        PIC X(8).
  8025     12  EN-DOCU-TYPE            PIC X.
  8026         88  EN-VERI-DOCU          VALUE 'V'.
  8027         88  EN-GCE-DOCU           VALUE 'G'.
  8028         88  EN-CANC-DOCU          VALUE 'C'.
  8029     12  EN-COMMENTS1            PIC X(13).
  8030     12  EN-COMMENTS2            PIC X(70).
  8031     12  EN-COMM-CHGBK           PIC X.
  8032         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8033         88  EN-CHG-ACCT           VALUE 'Y'.
  8034     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8035     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8036     12  EN-BATCH-NUMBER         PIC X(6).
  8037     12  EN-ACCT-SUMM            PIC X.
  8038     12  EN-CSO-SUMM             PIC X.
  8039     12  en-check-type           pic x.
  8040     12  FILLER                  PIC X(12).
  8041******************************************************************
  8042*                                COPY ELCCRTT.
  8043******************************************************************
  8044*                                                                *
  8045*                            ELCCRTT.                            *
  8046*                                                                *
  8047*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8048*                                                                *
  8049*   FILE TYPE = VSAM,KSDS                                        *
  8050*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8051*                                                                *
  8052*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8053*                                                                *
  8054*   LOG = YES                                                    *
  8055*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8056******************************************************************
  8057*                   C H A N G E   L O G
  8058*
  8059* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8060*-----------------------------------------------------------------
  8061*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8062* EFFECTIVE    NUMBER
  8063*-----------------------------------------------------------------
  8064* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8065* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8066* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 148
* EL6311.cbl
  8067* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8068* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8069* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8070* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8071* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8072* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8073* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8074* 091318  CR2018073000001  PEMA  ADD Refund methods
  8075* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8076******************************************************************
  8077
  8078 01  CERTIFICATE-TRAILERS.
  8079     12  CS-RECORD-ID                      PIC XX.
  8080         88  VALID-CS-ID                      VALUE 'CS'.
  8081
  8082     12  CS-CONTROL-PRIMARY.
  8083         16  CS-COMPANY-CD                 PIC X.
  8084         16  CS-CARRIER                    PIC X.
  8085         16  CS-GROUPING                   PIC X(6).
  8086         16  CS-STATE                      PIC XX.
  8087         16  CS-ACCOUNT                    PIC X(10).
  8088         16  CS-CERT-EFF-DT                PIC XX.
  8089         16  CS-CERT-NO.
  8090             20  CS-CERT-PRIME             PIC X(10).
  8091             20  CS-CERT-SFX               PIC X.
  8092         16  CS-TRAILER-TYPE               PIC X.
  8093             88  COMM-TRLR           VALUE 'A'.
  8094             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8095             88  CERT-DATA-TRLR      VALUE 'C'.
  8096
  8097     12  CS-DATA-AREA                      PIC X(516).
  8098
  8099     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8100         16  CS-BANK-COMMISSION-AREA.
  8101             20  CS-BANK-COMMS       OCCURS 10.
  8102                 24  CS-AGT                PIC X(10).
  8103                 24  CS-COM-TYP            PIC X.
  8104                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8105                 24  CS-RECALC-LV-INDIC    PIC X.
  8106                 24  FILLER                PIC X(10).
  8107         16  FILLER                        PIC X(256).
  8108
  8109     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8110****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8111         16  CS-MB-CLAIM-DATA OCCURS 24.
  8112             20  CS-CLAIM-NO               PIC X(7).
  8113             20  CS-CLAIM-TYPE             PIC X.
  8114                 88  CS-AH-CLM               VALUE 'A'.
  8115                 88  CS-IU-CLM               VALUE 'I'.
  8116                 88  CS-GP-CLM               VALUE 'G'.
  8117                 88  CS-LF-CLM               VALUE 'L'.
  8118                 88  CS-PR-CLM               VALUE 'P'.
  8119                 88  CS-FL-CLM               VALUE 'F'.
  8120                 88  CS-OT-CLM               VALUE 'O'.
  8121             20  CS-INSURED-TYPE           PIC X.
  8122                 88  CS-PRIM-INSURED          VALUE 'P'.
  8123                 88  CS-CO-BORROWER           VALUE 'C'.
  8124             20  CS-BENEFIT-PERIOD         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 149
* EL6311.cbl
  8125             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8126             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8127             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8128         16  FILLER                        PIC X(12).
  8129     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8130         16  CS-VIN-NUMBER                 PIC X(17).
  8131         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8132         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8133         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8134         16  cs-agent-name.
  8135             20  cs-agent-fname            pic x(20).
  8136             20  cs-agent-mi               pic x.
  8137             20  cs-agent-lname            pic x(25).
  8138         16  cs-license-no                 pic x(15).
  8139         16  cs-npn-number                 pic x(10).
  8140         16  cs-agent-edit-status          pic x.
  8141             88  cs-ae-refer-to-manager      value 'M'.
  8142             88  cs-ae-cover-sheet           value 'C'.
  8143             88  cs-ae-sig-form              value 'S'.
  8144             88  cs-ae-verified              value 'V'.
  8145             88  cs-unidentified-signature   value 'U'.
  8146             88  cs-cert-returned            value 'R'.
  8147             88  cs-accept-no-commission     value 'N'.
  8148         16  cs-year                       pic 9999.
  8149         16  cs-make                       pic x(20).
  8150         16  cs-model                      pic x(20).
  8151         16  cs-future                     pic x(20).
  8152         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8153         16  cs-claim-verification-status  pic x.
  8154             88  cs-clm-ver-eligible         value 'A'.
  8155             88  cs-clm-ver-partial-elig     value 'B'.
  8156             88  cs-clm-ver-not-eligible     value 'C'.
  8157             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8158             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8159             88  cs-clm-ver-ND-CERT          value 'F'.
  8160             88  cs-clm-ver-spec-other       value 'G'.
  8161             88  cs-clam-ver-pratial-corrected
  8162                                             value 'H'.
  8163             88  cs-clm-ver-no-matches       value 'I'.
  8164             88  cs-clm-ver-not-elig-corrected
  8165                                             value 'J'.
  8166             88  cs-clm-ver-needs-review     value 'R'.
  8167             88  cs-clm-ver-sent-to-claims   value 'W'.
  8168         16  CS-LF-REFUND-METHOD           PIC X.
  8169         16  CS-AH-REFUND-METHOD           PIC X.
  8170         16  FILLER                        PIC X(353). *> was 420
  8171*        16  FILLER                        PIC X(496).
  8172*                                COPY ERCCHEK.
  8173******************************************************************
  8174*                                                                *
  8175*                                                                *
  8176*                            ERCCHEK                             *
  8177*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8178*                            VMOD=2.008                          *
  8179*                                                                *
  8180*   FILE DESCRIPTION = CHECK RECORDS                             *
  8181*                                                                *
  8182*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 150
* EL6311.cbl
  8183*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8184*                                                                *
  8185*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8186*       ALTERNATE INDEX = NONE                                   *
  8187*                                                                *
  8188*   LOG = YES                                                    *
  8189*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8190******************************************************************
  8191*                   C H A N G E   L O G
  8192*
  8193* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8194*-----------------------------------------------------------------
  8195*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8196* EFFECTIVE    NUMBER
  8197*-----------------------------------------------------------------
  8198* 021414    2003053000001  PEMA  changes for auto chk request
  8199******************************************************************
  8200 01  CHECK-RECORDS.
  8201     12  CH-RECORD-ID                      PIC XX.
  8202         88  VALID-CH-ID                      VALUE 'CH'.
  8203
  8204     12  CH-CONTROL-PRIMARY.
  8205         16  CH-COMPANY-CD                 PIC X.
  8206         16  CH-CARRIER                    PIC X.
  8207         16  CH-GROUPING                   PIC X(6).
  8208         16  CH-STATE                      PIC XX.
  8209         16  CH-ACCOUNT                    PIC X(10).
  8210         16  CH-CERT-EFF-DT                PIC XX.
  8211         16  CH-CERT-NO.
  8212             20  CH-CERT-PRIME             PIC X(10).
  8213             20  CH-CERT-SFX               PIC X.
  8214         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8215
  8216     12  CH-RECORDED-DT                    PIC XX.
  8217     12  CH-RECORDED-BY                    PIC X(4).
  8218     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8219
  8220     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8221     12  CH-CHECK-NO                       PIC X(7).
  8222     12  CH-REASON-FOR-CHECK               PIC X(25).
  8223     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8224     12  FILLER                            PIC X.
  8225
  8226     12  CH-PAYEE-INFO.
  8227         16  CH-PAYEE-NAME-1               PIC X(30).
  8228         16  CH-PAYEE-NAME-2               PIC X(30).
  8229         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8230         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8231         16  CH-PAYEE-CITY-ST.
  8232             20  CH-PAYEE-CITY             PIC X(28).
  8233             20  CH-PAYEE-STATE            PIC XX.
  8234         16  CH-PAYEE-ZIP-CODE.
  8235             20  CH-PAYEE-ZIP.
  8236                 24  CH-ZIP-PRI-1ST        PIC X.
  8237                     88  CH-CANADIAN-POST-CODE
  8238                                           VALUES 'A' THRU 'Z'.
  8239                 24  FILLER                PIC X(4).
  8240             20  CH-PAYEE-ZIP-EXT          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 151
* EL6311.cbl
  8241         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8242             20  CH-CAN-POSTAL-1           PIC XXX.
  8243             20  CH-CAN-POSTAL-2           PIC XXX.
  8244             20  FILLER                    PIC XXX.
  8245
  8246     12  CH-CHECK-STUB-TEXT.
  8247         16  CH-STUB-LINE-1                PIC X(30).
  8248         16  CH-TEXT-LINE-1                PIC X(50).
  8249         16  CH-TEXT-LINE-2                PIC X(50).
  8250         16  CH-TEXT-LINE-3                PIC X(40).
  8251     12  CH-RETURN-TO                      PIC X(30).
  8252
  8253     12  CH-COMPENSATION-CONTROL.
  8254         16  CH-COMP-CARRIER               PIC X.
  8255         16  CH-COMP-GROUPING              PIC X(6).
  8256         16  CH-COMP-FIN-RESP              PIC X(10).
  8257         16  CH-COMP-ACCOUNT               PIC X(10).
  8258
  8259     12  CH-CREDIT-SELECT-DT               PIC XX.
  8260     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8261     12  CH-PAYEE-CODE                     PIC X(6).
  8262
  8263     12  CH-VOID-DATA.
  8264         20  CH-VOID-DT                    PIC XX.
  8265         20  CH-VOID-BY                    PIC X(4).
  8266         20  CH-VOID-REASON                PIC X(25).
  8267
  8268     12  CH-APPROVAL-DATA.
  8269         20  CH-APPROVAL-DT                PIC XX.
  8270         20  CH-APPROVAL-STATUS            PIC X.
  8271             88  CH-IN-LIMBO                  VALUE ' '.
  8272             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8273             88  CH-APPROVED                  VALUE 'A'.
  8274             88  CH-DENIED                    VALUE 'D'.
  8275         20  CH-APPROVED-BY                PIC XXXX.
  8276     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8277             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8278     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8279
  8280     12  ch-released-dt                    pic xx.
  8281     12  ch-check-cashed-dt                pic xx.
  8282     12  FILLER                            PIC X.
  8283*    12  CH-CHECK-REFERENCE                PIC X(12).
  8284     12  CH-CHECK-ORIGIN-SW                PIC X.
  8285             88  CH-REFUND-CHECK              VALUE 'R'.
  8286             88  CH-MAINT-CHECK               VALUE 'M'.
  8287
  8288     12  CH-CANC-DT                        PIC XX.
  8289     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8290     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8291
  8292     12  CH-INSURED-NAME                   PIC X(28).
  8293
  8294     12  ch-released-by                    pic x(4).
  8295     12  ch-csr                            pic x(4).
  8296     12  ch-deduct-commission              pic x.
  8297         88  ch-deduct-comm                  value 'Y'.
  8298         88  ch-do-not-deduct-comm           value 'N'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 152
* EL6311.cbl
  8299
  8300     12  FILLER                            PIC X(11).
  8301*    12  CH-LETTER-TABLE.
  8302*        16  CH-LETTERS OCCURS 3 TIMES
  8303*                       INDEXED BY CH-LT-NDX
  8304*                                          PIC X(04).
  8305
  8306     12  FILLER                            PIC X(07).
  8307
  8308 01  var                         pic x(30).
  8309 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8310                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8311                          PENDING-MAILING-DATA MAILING-DATA
  8312                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8313                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8314                          CLAIM-MASTER ENDORSEMENT-RECORD
  8315                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8316                          VAR.
  8317 0000-DFHEXIT SECTION.
  8318     MOVE '9#                    $   ' TO DFHEIV0.
  8319     MOVE 'EL6311' TO DFHEIV1.
  8320     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8321
  8322     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8323     MOVE EIBTRMID               TO QID-TERM.
  8324     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8325     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8326     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8327     MOVE 2                      TO EMI-SWITCH2.
  8328
  8329     move spaces to ws-kix-myenv
  8330     set P to address of KIXSYS
  8331     CALL "getenv" using by value P returning var-ptr
  8332     if var-ptr = null then
  8333        display ' kixsys not set '
  8334     else
  8335        set address of var to var-ptr
  8336        move 0 to env-var-len
  8337        inspect var tallying env-var-len
  8338          for characters before X'00'
  8339        unstring var (1:env-var-len) delimited by '/'
  8340           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8341              WS-KIX-SYS
  8342        end-unstring
  8343     end-if
  8344     perform varying a1 from +1 by +1 until a1 > +10
  8345        if ws-kix-myenv (a1:1) = low-values or high-values
  8346           display ' found low or hi val '
  8347           move spaces to ws-kix-myenv (a1:1)
  8348        end-if
  8349     end-perform
  8350*    display ' env *' ws-kix-myenv '*'
  8351     IF EIBCALEN = 0
  8352         GO TO 8800-UNAUTHORIZED-ACCESS.
  8353
  8354     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8355     MOVE '5'                   TO DC-OPTION-CODE.
  8356     PERFORM 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 153
* EL6311.cbl
  8357     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8358     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8359
  8360     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8361     MOVE SPACE                  TO DC-OPTION-CODE.
  8362     PERFORM 9700-DATE-LINK.
  8363     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8364     MOVE LOW-VALUES             TO EL631BI.
  8365
  8366
  8367* EXEC CICS HANDLE CONDITION
  8368*        PGMIDERR  (9600-PGMID-ERROR)
  8369*        ERROR     (9990-ABEND)
  8370*        INVREQ    (9990-ABEND)
  8371*        QIDERR    (0010-MAIN-LOGIC)
  8372*    END-EXEC.
  8373*    MOVE '"$L.8N                ! " #00008362' TO DFHEIV0
  8374     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8375     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8376     MOVE X'2220233030303038333632' TO DFHEIV0(25:11)
  8377     CALL 'kxdfhei1' USING DFHEIV0
  8378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8379
  8380
  8381     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8382         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8383             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8384             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8385             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8386             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8387             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8388             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8389             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8390             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8391
  8392             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8393                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8394
  8395             ELSE
  8396                 NEXT SENTENCE
  8397
  8398         ELSE
  8399             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8400             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8401             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8402             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8403             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8404             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8405             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8406             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8407             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8408             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8409             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8410             GO TO 3900-RE-DISPLAY-RECORD
  8411     ELSE
  8412         GO TO 0020-MAIN-LOGIC.
  8413
  8414 0010-MAIN-LOGIC.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 154
* EL6311.cbl
  8415     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8416                                    WS-FIRST-ENTRY-SW.
  8417
  8418     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8419
  8420     MOVE LOW-VALUES             TO EC-NEW-CERT
  8421                                    EC-NEW-STATE.
  8422
  8423     IF PI-DISPLAY-ORIGINAL-BATCH
  8424         NEXT SENTENCE
  8425     ELSE
  8426         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8427             GO TO 5000-BROWSE-BATCH-HEADERS.
  8428
  8429     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8430         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8431
  8432     IF PI-CSR-BROWSE
  8433        GO TO 4200-BROWSE-CSR-FORWARD.
  8434
  8435     IF PI-FILE-BROWSE
  8436         GO TO 4300-BROWSE-FILE-FORWARD.
  8437
  8438     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8439
  8440 0020-MAIN-LOGIC.
  8441     IF EIBAID = DFHCLEAR
  8442         GO TO 9400-CLEAR.
  8443
  8444     MOVE LOW-VALUES             TO EC-NEW-CERT
  8445                                    EC-NEW-STATE.
  8446
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 155
* EL6311.cbl
  8448
  8449******************************************************************
  8450*                                                                *
  8451*              R E C E I V E   M A P                             *
  8452*                                                                *
  8453******************************************************************
  8454
  8455 0200-RECEIVE.
  8456     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8457         MOVE ER-0008            TO EMI-ERROR
  8458         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8459         IF PI-MAP-NAME = EL631B
  8460             MOVE -1                 TO BMAINTL
  8461             GO TO 8200-SEND-DATAONLY
  8462         ELSE
  8463             IF PI-MAP-NAME = EL631C
  8464                 MOVE -1                 TO CMAINTL
  8465                 GO TO 8200-SEND-DATAONLY
  8466             ELSE
  8467                 IF PI-MAP-NAME = EL631D
  8468                     MOVE -1                 TO DPFENTRL
  8469                     GO TO 8200-SEND-DATAONLY.
  8470
  8471
  8472* EXEC CICS RECEIVE
  8473*        MAP      (PI-MAP-NAME)
  8474*        MAPSET   (MAPSET-EL6311S)
  8475*        INTO     (EL631BI)
  8476*    END-EXEC.
  8477     MOVE LENGTH OF
  8478      EL631BI
  8479       TO DFHEIV11
  8480*    MOVE '8"T I  L              ''   #00008459' TO DFHEIV0
  8481     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8482     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8483     MOVE X'2020233030303038343539' TO DFHEIV0(25:11)
  8484     CALL 'kxdfhei1' USING DFHEIV0,
  8485           PI-MAP-NAME,
  8486           EL631BI,
  8487           DFHEIV11,
  8488           MAPSET-EL6311S,
  8489           DFHEIV99,
  8490           DFHEIV99
  8491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8492
  8493
  8494******************************************************************
  8495*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8496******************************************************************
  8497
  8498     IF BTYPE-LEN (1) EQUAL +3
  8499        IF BTYPE (1) EQUAL ALL ' '
  8500            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8501
  8502     IF BTYPE-LEN (2) EQUAL +3
  8503        IF BTYPE (2) EQUAL ALL ' '
  8504            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8505
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 156
* EL6311.cbl
  8506     INSPECT EL631BI CONVERTING '_' TO ' '.
  8507
  8508     IF PI-MAP-NAME = EL631B
  8509         IF BPFENTRL GREATER THAN ZEROS
  8510             IF EIBAID NOT = DFHENTER
  8511                 MOVE ER-0004       TO EMI-ERROR
  8512                 MOVE -1            TO BPFENTRL
  8513                 MOVE AL-UNBOF      TO BPFENTRA
  8514                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8515                 GO TO 8200-SEND-DATAONLY
  8516             ELSE
  8517                 IF BPFENTRI NUMERIC AND
  8518                   (BPFENTRI GREATER 0 AND LESS 25)
  8519                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8520                 ELSE
  8521                     MOVE ER-0029  TO EMI-ERROR
  8522                     MOVE AL-UNBON TO BPFENTRA
  8523                     MOVE -1       TO BPFENTRL
  8524                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8525                     GO TO 8200-SEND-DATAONLY
  8526         ELSE
  8527             NEXT SENTENCE
  8528     ELSE
  8529         IF PI-MAP-NAME = EL631C
  8530            IF CPFENTRL GREATER THAN ZEROS
  8531                IF EIBAID NOT = DFHENTER
  8532                 MOVE ER-0004         TO EMI-ERROR
  8533                 MOVE -1              TO CPFENTRL
  8534                 MOVE AL-UNBOF        TO CPFENTRA
  8535                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8536                 GO TO 8200-SEND-DATAONLY
  8537             ELSE
  8538                 IF CPFENTRI NUMERIC AND
  8539                   (CPFENTRI GREATER 0 AND LESS 25)
  8540                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8541                 ELSE
  8542                     MOVE ER-0029      TO EMI-ERROR
  8543                     MOVE AL-UNBON     TO CPFENTRA
  8544                     MOVE -1           TO CPFENTRL
  8545                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8546                     GO TO 8200-SEND-DATAONLY
  8547         ELSE
  8548             NEXT SENTENCE
  8549     ELSE
  8550     IF PI-MAP-NAME = EL631D
  8551         IF DPFENTRL GREATER THAN ZEROS
  8552             IF EIBAID NOT = DFHENTER
  8553                 MOVE ER-0004         TO EMI-ERROR
  8554                 MOVE -1              TO DPFENTRL
  8555                 MOVE AL-UNBOF        TO DPFENTRA
  8556                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8557                 GO TO 8200-SEND-DATAONLY
  8558             ELSE
  8559                 IF DPFENTRI NUMERIC AND
  8560                   (DPFENTRI GREATER 0 AND LESS 25)
  8561                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8562                 ELSE
  8563                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 157
* EL6311.cbl
  8564                     MOVE AL-UNBON     TO DPFENTRA
  8565                     MOVE -1           TO DPFENTRL
  8566                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8567                     GO TO 8200-SEND-DATAONLY.
  8568
  8569     IF EIBAID = DFHPF23
  8570         GO TO 8810-PF23.
  8571
  8572     IF EIBAID = DFHPF24
  8573         GO TO 9200-RETURN-MAIN-MENU.
  8574
  8575     IF EIBAID = DFHPF12
  8576         GO TO 9500-PF12.
  8577
  8578     IF PI-MAP-NAME = EL631B
  8579        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8580
  8581     IF PI-MAP-NAME = EL631C
  8582        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8583
  8584     IF PI-MAP-NAME = EL631D
  8585        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8586
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 158
* EL6311.cbl
  8588
  8589******************************************************************
  8590*                                                                *
  8591*      ISSUE SCREEN PF KEY CHECKING                              *
  8592*                                                                *
  8593******************************************************************
  8594
  8595******************************************************************
  8596*                                                                *
  8597*      PF KEY FUNCTIONS:                                         *
  8598*                                                                *
  8599*      PF1  = BROWSE FORWARD                                     *
  8600*      PF2  = BROWSE BACKWARD                                    *
  8601*      PF3  = CERTIFICATE LOOKUP                                 *
  8602*      PF4  = DISPLAY BATCH HEADER                               *
  8603*      PF5  = ADD ISSUE  SCREEN                                  *
  8604*      PF6  = ADD CANCEL SCREEN                                  *
  8605*      PF7  = CERTIFICATE DISPLAY                                *
  8606*      PF8  = CERTIFICATE NOTES                                  *
  8607*      PF9  = EDIT CONTROL                                       *
  8608*      PF10 = DISPLAY LETTER SCREEN                              *
  8609*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8610*      PF12 = HELP SCREEN                                        *
  8611*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8612*      PF14 = ACCOUNT MASTER                                     *
  8613*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8614*      PF16 = DISPLAY LETTER REVIEW                              *
  8615*                                                                *
  8616******************************************************************
  8617
  8618 0300-CHECK-ISSUE-PF-KEYS.
  8619     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8620        MOVE ER-2337            TO EMI-ERROR
  8621        MOVE -1                  TO BMAINTL
  8622        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8623        GO TO 8200-SEND-DATAONLY.
  8624
  8625     IF EIBAID = DFHPF1
  8626        MOVE '0'                TO PI-EDIT-SW
  8627        IF PI-PRIMARY-BROWSE
  8628           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8629        ELSE
  8630           IF PI-PRIMARY-WITH-SELECT
  8631              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8632           ELSE
  8633              IF PI-FILE-BROWSE
  8634                 GO TO 4300-BROWSE-FILE-FORWARD
  8635              ELSE
  8636                 IF PI-CSR-BROWSE
  8637                    GO TO 4200-BROWSE-CSR-FORWARD
  8638                 ELSE
  8639                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8640
  8641     IF EIBAID = DFHPF2
  8642        MOVE '0'                TO PI-EDIT-SW
  8643        IF PI-PRIMARY-BROWSE
  8644           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8645        ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 159
* EL6311.cbl
  8646           IF PI-PRIMARY-WITH-SELECT
  8647              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8648           ELSE
  8649              IF PI-FILE-BROWSE
  8650                 GO TO 4800-BROWSE-FILE-BACKWARD
  8651              ELSE
  8652                 IF PI-CSR-BROWSE
  8653                    GO TO 4900-BROWSE-CSR-BACKWARD
  8654                 ELSE
  8655                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8656
  8657     IF EIBAID = DFHPF3
  8658        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8659        MOVE XCTL-EL127         TO PGM-NAME
  8660        GO TO 9300-XCTL.
  8661
  8662     IF (EIBAID = DFHPF15 OR DFHPF6)
  8663        AND (CSR-EDIT-SESSION)
  8664*       AND (FATAL-OR-UNFORCED)
  8665*       AND (FATAL-ERRORS)
  8666        and (pi-6311-fatal-ctr <> +0)
  8667        MOVE ER-1819             TO EMI-ERROR
  8668        MOVE -1                  TO BMAINTL
  8669        MOVE AL-UANON            TO BMAINTA
  8670        PERFORM 9900-ERROR-FORMAT
  8671                                 THRU 9900-EXIT
  8672        GO TO 8200-SEND-DATAONLY
  8673     END-IF
  8674     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8675      OR (EIBAID = DFHPF10)
  8676        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8677        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8678        IF (RESP-NORMAL)
  8679           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8680              AM-CONTROL-PRIMARY (1:20))
  8681            IF AM-NAME NOT GREATER THAN SPACES OR
  8682               AM-ADDRS NOT GREATER THAN SPACES  OR
  8683               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8684               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8685               AM-ZIP NOT GREATER THAN SPACES
  8686               MOVE ER-3834             TO EMI-ERROR
  8687               MOVE -1                  TO BMAINTL
  8688               MOVE AL-UANON            TO BMAINTA
  8689               PERFORM 9900-ERROR-FORMAT
  8690                                 THRU 9900-EXIT
  8691               GO TO 8200-SEND-DATAONLY
  8692            END-IF
  8693        ELSE
  8694           MOVE ER-1609             TO EMI-ERROR
  8695           MOVE -1                  TO BMAINTL
  8696           MOVE AL-UANON            TO BMAINTA
  8697           PERFORM 9900-ERROR-FORMAT
  8698                                THRU 9900-EXIT
  8699           GO TO 8200-SEND-DATAONLY
  8700        END-IF
  8701
  8702        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8703        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 160
* EL6311.cbl
  8704        IF (ERMAIL-FOUND)
  8705            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8706               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8707               MA-CITY NOT GREATER THAN SPACES OR
  8708               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8709               MA-ZIP-CODE NOT GREATER THAN SPACES
  8710               MOVE ER-3835             TO EMI-ERROR
  8711               MOVE -1                  TO BMAINTL
  8712               MOVE AL-UANON            TO BMAINTA
  8713               PERFORM 9900-ERROR-FORMAT
  8714                                 THRU 9900-EXIT
  8715               GO TO 8200-SEND-DATAONLY
  8716            END-IF
  8717        ELSE
  8718           MOVE ER-3000             TO EMI-ERROR
  8719           MOVE -1                  TO BMAINTL
  8720           MOVE AL-UANON            TO BMAINTA
  8721           PERFORM 9900-ERROR-FORMAT
  8722                                THRU 9900-EXIT
  8723           GO TO 8200-SEND-DATAONLY
  8724        END-IF
  8725
  8726     END-IF
  8727     IF (EIBAID = DFHPF15)
  8728        AND (CSR-EDIT-SESSION)
  8729        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8730        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8731        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8732        MOVE PI-SV-STATE         TO PI-STATE
  8733        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8734        MOVE BCERTNOI            TO PI-CERT-PRIME
  8735        MOVE BSUFIXI             TO PI-CERT-SFX
  8736        MOVE BEFFDTI             TO DEEDIT-FIELD
  8737        PERFORM 8600-DEEDIT
  8738        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8739        MOVE '4'                 TO DC-OPTION-CODE
  8740        PERFORM 9700-DATE-LINK
  8741        IF DATE-CONVERSION-ERROR
  8742           MOVE ER-0348          TO EMI-ERROR
  8743           MOVE -1               TO BEFFDTL
  8744           MOVE AL-UABON         TO BEFFDTA
  8745           PERFORM 9900-ERROR-FORMAT
  8746                                 THRU 9900-EXIT
  8747           GO TO 8200-SEND-DATAONLY
  8748        ELSE
  8749           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8750           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8751           MOVE XCTL-EL6315      TO PGM-NAME
  8752           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8753           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8754           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8755           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8756           GO TO 9300-XCTL
  8757        END-IF
  8758     END-IF
  8759
  8760     IF EIBAID = DFHPF4
  8761        MOVE '0'                TO PI-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 161
* EL6311.cbl
  8762        IF PI-DISPLAY-ORIGINAL-BATCH
  8763           NEXT SENTENCE
  8764        ELSE
  8765           GO TO 7200-DISPLAY-BATCHES.
  8766
  8767     IF EIBAID = DFHPF5
  8768        MOVE ER-0029                TO EMI-ERROR
  8769        MOVE -1                     TO BPFENTRL
  8770        MOVE AL-UNBON               TO BPFENTRA
  8771        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8772        GO TO 8200-SEND-DATAONLY.
  8773*        MOVE '0'                TO PI-EDIT-SW
  8774*        IF PI-DISPLAY-ORIGINAL-BATCH
  8775*           NEXT SENTENCE
  8776*        ELSE
  8777*           MOVE EL631B              TO PI-MAP-NAME
  8778*           MOVE LOW-VALUES          TO EL631BI
  8779*           MOVE 'A'                 TO BMAINTO
  8780*           MOVE AL-UANON            TO BMAINTA
  8781*           MOVE -1                  TO BMAINTL
  8782*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8783*           GO TO 8100-SEND-INITIAL-MAP.
  8784
  8785     IF EIBAID = DFHPF6
  8786        IF NOT CSR-EDIT-SESSION
  8787           MOVE ER-0029                TO EMI-ERROR
  8788           MOVE -1                     TO BPFENTRL
  8789           MOVE AL-UNBON               TO BPFENTRA
  8790           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8791           GO TO 8200-SEND-DATAONLY
  8792*           MOVE '0'              TO PI-EDIT-SW
  8793*           IF PI-DISPLAY-ORIGINAL-BATCH
  8794*              NEXT SENTENCE
  8795*           ELSE
  8796*              MOVE EL631C        TO PI-MAP-NAME
  8797*              MOVE LOW-VALUES    TO EL631CI
  8798*              MOVE 'A'           TO CMAINTO
  8799*              MOVE AL-UANON      TO CMAINTA
  8800*              MOVE -1            TO CMAINTL
  8801*              MOVE '6'           TO PI-MAINT-FUNCTION
  8802*              GO TO 8100-SEND-INITIAL-MAP
  8803*           END-IF
  8804        ELSE
  8805           PERFORM 5100-PROCESS-POL-RESC
  8806                                 THRU 5100-EXIT
  8807           MOVE  PI-PREV-CONTROL-PRIMARY
  8808                                 TO ERPNDB-KEY
  8809
  8810* EXEC CICS READ
  8811*              SET     (ADDRESS OF PENDING-BUSINESS)
  8812*              DATASET (FILE-ID-ERPNDB)
  8813*              RIDFLD  (ERPNDB-KEY)
  8814*          END-EXEC
  8815*    MOVE '&"S        E          (   #00008780' TO DFHEIV0
  8816     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8817     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8818     MOVE X'2020233030303038373830' TO DFHEIV0(25:11)
  8819     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 162
* EL6311.cbl
  8820           FILE-ID-ERPNDB,
  8821           DFHEIV20,
  8822           DFHEIV99,
  8823           ERPNDB-KEY,
  8824           DFHEIV99,
  8825           DFHEIV99,
  8826           DFHEIV99
  8827     SET ADDRESS OF PENDING-BUSINESS TO
  8828         DFHEIV20
  8829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8830           PERFORM 9800-LINK-PENDING-EDIT
  8831                                 THRU 9800-EXIT
  8832           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8833           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8834                                    PI-PREV-SEQ-NO
  8835           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8836*                                    WS-CANCEL-LETTER-SW
  8837                                    PI-ALL-ISSUES-SW
  8838                                    PI-ALL-CANCELS-SW
  8839           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8840        END-IF
  8841     END-IF
  8842     IF EIBAID = DFHPF7
  8843        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8844        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8845        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8846        MOVE PI-SV-STATE            TO PI-STATE
  8847        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8848        MOVE BCERTNOI               TO PI-CERT-PRIME
  8849        MOVE BSUFIXI                TO PI-CERT-SFX
  8850        MOVE BEFFDTI                TO DEEDIT-FIELD
  8851        PERFORM 8600-DEEDIT
  8852        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8853        MOVE '4'                    TO DC-OPTION-CODE
  8854        PERFORM 9700-DATE-LINK
  8855        IF DATE-CONVERSION-ERROR
  8856           MOVE ER-0348            TO EMI-ERROR
  8857           MOVE -1                  TO BEFFDTL
  8858           MOVE AL-UABON            TO BEFFDTA
  8859           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8860           GO TO 8200-SEND-DATAONLY
  8861        ELSE
  8862           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8863           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8864           MOVE XCTL-EL1273        TO PGM-NAME
  8865           GO TO 9300-XCTL.
  8866
  8867     IF EIBAID = DFHPF8
  8868        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8869        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8870        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8871        MOVE PI-SV-STATE            TO PI-STATE
  8872        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8873        MOVE BCERTNOI               TO PI-CERT-PRIME
  8874        MOVE BSUFIXI                TO PI-CERT-SFX
  8875        MOVE BEFFDTI                TO DEEDIT-FIELD
  8876        PERFORM 8600-DEEDIT
  8877        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 163
* EL6311.cbl
  8878        MOVE '4'                    TO DC-OPTION-CODE
  8879        PERFORM 9700-DATE-LINK
  8880        IF DATE-CONVERSION-ERROR
  8881           MOVE ER-0348            TO EMI-ERROR
  8882           MOVE -1                  TO BEFFDTL
  8883           MOVE AL-UABON            TO BEFFDTA
  8884           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8885           GO TO 8200-SEND-DATAONLY
  8886        ELSE
  8887           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8888           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8889           IF PI-COMPANY-ID = 'DMD'
  8890               MOVE XCTL-EL401DMD      TO PGM-NAME
  8891             ELSE
  8892               MOVE XCTL-EL1279        TO PGM-NAME
  8893           END-IF
  8894           GO TO 9300-XCTL.
  8895
  8896     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8897        MOVE XCTL-EL6312         TO PGM-NAME
  8898
  8899* EXEC CICS XCTL
  8900*           PROGRAM   (PGM-NAME)
  8901*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8902*           LENGTH    (WS-COMM-LENGTH)
  8903*       END-EXEC
  8904*    MOVE '.$C                   %   #00008853' TO DFHEIV0
  8905     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8906     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8907     MOVE X'2020233030303038383533' TO DFHEIV0(25:11)
  8908     CALL 'kxdfhei1' USING DFHEIV0,
  8909           PGM-NAME,
  8910           PROGRAM-INTERFACE-BLOCK,
  8911           WS-COMM-LENGTH,
  8912           DFHEIV99
  8913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8914     ELSE
  8915        MOVE '0'                 TO  PI-EDIT-SW.
  8916
  8917     IF  EIBAID = DFHPF10
  8918         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8919         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8920         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8921                                    PI-1042-WA
  8922         MOVE 4                  TO PI-689-DATA-SOURCE
  8923         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8924         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8925         MOVE PI-SV-STATE        TO PI-689-STATE
  8926         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8927         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8928         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8929         MOVE PI-PB-ALT-CHG-SEQ-NO
  8930                                 TO PI-689-ALT-SEQ-NO
  8931         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8932         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8933         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8934         MOVE +0                 TO PI-689-CONTROL
  8935         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 164
* EL6311.cbl
  8936                                    PI-689-EXP-DATE
  8937                                    PI-689-RESP-PERSON
  8938                                    PI-689-TYPE
  8939                                    PI-689-FOLLOW-UP-EDIT
  8940                                    PI-689-RESEND1-EDIT
  8941                                    PI-689-SEQ-EDIT
  8942                                    PI-689-BCSEQ-EDIT
  8943                                    PI-689-LBL-OVERRIDE
  8944         MOVE W-LETTER-COMMUNICATION-AREAS
  8945                                 TO PI-PROGRAM-WORK-AREA
  8946         MOVE XCTL-EL689         TO PGM-NAME
  8947         GO TO 9300-XCTL.
  8948
  8949     IF  EIBAID = DFHPF16
  8950         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8951         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8952         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8953                                    PI-1042-WA
  8954         MOVE 4                  TO PI-689-DATA-SOURCE
  8955         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8956         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8957         MOVE PI-SV-STATE        TO PI-689-STATE
  8958         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8959         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8960         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8961         MOVE PI-PB-ALT-CHG-SEQ-NO
  8962                                 TO PI-689-ALT-SEQ-NO
  8963         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8964         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8965         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8966         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8967         MOVE W-LETTER-COMMUNICATION-AREAS
  8968                                 TO PI-PROGRAM-WORK-AREA
  8969         MOVE XCTL-EL690         TO PGM-NAME
  8970         GO TO 9300-XCTL.
  8971
  8972     IF EIBAID = DFHPF13
  8973         MOVE XCTL-EL6313        TO PGM-NAME
  8974         GO TO 9300-XCTL.
  8975
  8976     IF EIBAID = DFHPF17
  8977        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8978        IF (PB-I-LOAN-APR numeric)
  8979           and (pb-i-loan-apr < 99.9999)
  8980           AND (PB-I-BENEFICIARY-NAME NOT
  8981              = SPACES AND LOW-VALUES)
  8982
  8983           MOVE LINK-ELVADS          TO PGM-NAME
  8984
  8985* EXEC CICS LINK
  8986*              PROGRAM    (PGM-NAME)
  8987*              COMMAREA   (WS-PASS-AREA)
  8988*              LENGTH     (WS-PASS-AREA-LENGTH)
  8989*          END-EXEC
  8990*    MOVE '."C                   (   #00008928' TO DFHEIV0
  8991     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8992     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8993     MOVE X'2020233030303038393238' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 165
* EL6311.cbl
  8994     CALL 'kxdfhei1' USING DFHEIV0,
  8995           PGM-NAME,
  8996           WS-PASS-AREA,
  8997           WS-PASS-AREA-LENGTH,
  8998           DFHEIV99,
  8999           DFHEIV99,
  9000           DFHEIV99,
  9001           DFHEIV99
  9002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9003
  9004           MOVE 0000             TO EMI-ERROR
  9005           MOVE -1               TO BMAINTL
  9006           PERFORM 9900-ERROR-FORMAT
  9007                                 THRU 9900-EXIT
  9008           GO TO 8200-SEND-DATAONLY
  9009        ELSE
  9010           MOVE ER-0877            TO EMI-ERROR
  9011           MOVE -1                  TO BEFFDTL
  9012           MOVE AL-UABON            TO BEFFDTA
  9013           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9014           GO TO 8200-SEND-DATAONLY
  9015        END-IF
  9016     END-IF
  9017     IF EIBAID = DFHPF14
  9018        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9019        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9020        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9021        MOVE PI-SV-STATE            TO PI-CR-STATE
  9022        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9023        MOVE SPACE                  TO PI-EDIT-SW
  9024        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9025        MOVE XCTL-EL650             TO PGM-NAME
  9026        GO TO 9300-XCTL.
  9027
  9028     IF EIBAID = DFHPF15
  9029        IF PI-COMPANY-ID  =  'HER'
  9030            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9031            MOVE XCTL-EL680         TO PGM-NAME
  9032            GO TO 9300-XCTL.
  9033
  9034     IF EIBAID = DFHENTER OR DFHPF11
  9035        GO TO 1000-ISSUE-MAINLINE.
  9036
  9037     MOVE ER-0029                TO EMI-ERROR
  9038     MOVE -1                     TO BPFENTRL
  9039     MOVE AL-UNBON               TO BPFENTRA
  9040     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9041     GO TO 8200-SEND-DATAONLY.
  9042
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 166
* EL6311.cbl
  9044
  9045******************************************************************
  9046*                                                                *
  9047*      CANCEL SCREEN PF KEY CHECKING                             *
  9048*                                                                *
  9049******************************************************************
  9050
  9051******************************************************************
  9052*                                                                *
  9053*      PF KEY FUNCTIONS:                                         *
  9054*                                                                *
  9055*      PF1  = BROWSE FORWARD                                     *
  9056*      PF2  = BROWSE BACKWARD                                    *
  9057*      PF3  = CERTIFICATE LOOKUP                                 *
  9058*      PF4  = DISPLAY BATCH HEADER                               *
  9059*      PF5  = ADD ISSUE SCREEN                                   *
  9060*      PF6  = ADD CANCEL SCREEN                                  *
  9061*      PF7  = CERTIFICATE DISPLAY                                *
  9062*      PF8  = CERTIFICATE NOTES                                  *
  9063*      PF9  = EDIT CONTROL                                       *
  9064*      PF10 = DISPLAY LETTER SCREEN                              *
  9065*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  9066*      PF12 = DISPLAY HELP SCREEN                                *
  9067*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  9068*      PF14 = ACCOUNT MASTER                                     *
  9069*      PF16 = LETTER REVIEW                                      *
  9070*                                                                *
  9071******************************************************************
  9072
  9073 0400-CHECK-CANCEL-PF-KEYS.
  9074     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  9075        MOVE ER-2337             TO EMI-ERROR
  9076        MOVE -1                  TO CMAINTL
  9077        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9078        GO TO 8200-SEND-DATAONLY.
  9079
  9080     IF EIBAID = DFHPF1
  9081        MOVE '0'                TO PI-EDIT-SW
  9082        IF PI-PRIMARY-BROWSE
  9083           GO TO 4100-BROWSE-PRIMARY-FORWARD
  9084        ELSE
  9085           IF PI-PRIMARY-WITH-SELECT
  9086              GO TO 4100-BROWSE-PRIMARY-FORWARD
  9087           ELSE
  9088              IF PI-FILE-BROWSE
  9089                 GO TO 4300-BROWSE-FILE-FORWARD
  9090              ELSE
  9091                 IF PI-CSR-BROWSE
  9092                    GO TO 4200-BROWSE-CSR-FORWARD
  9093                 ELSE
  9094                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  9095
  9096     IF EIBAID = DFHPF2
  9097        MOVE '0'                TO PI-EDIT-SW
  9098        IF PI-PRIMARY-BROWSE
  9099           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9100        ELSE
  9101           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 167
* EL6311.cbl
  9102              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9103           ELSE
  9104              IF PI-FILE-BROWSE
  9105                 GO TO 4800-BROWSE-FILE-BACKWARD
  9106              ELSE
  9107                 IF PI-CSR-BROWSE
  9108                    GO TO 4900-BROWSE-CSR-BACKWARD
  9109                 ELSE
  9110                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  9111
  9112     IF EIBAID = DFHPF3
  9113        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9114        MOVE XCTL-EL127         TO PGM-NAME
  9115        GO TO 9300-XCTL.
  9116
  9117     IF (EIBAID = DFHPF15 OR DFHPF17)
  9118        AND (CSR-EDIT-SESSION)
  9119*       AND (FATAL-OR-UNFORCED)
  9120        AND (FATAL-ERRORS)
  9121        MOVE ER-1819             TO EMI-ERROR
  9122        MOVE -1                  TO CMAINTL
  9123        MOVE AL-UANON            TO CMAINTA
  9124        PERFORM 9900-ERROR-FORMAT
  9125                                 THRU 9900-EXIT
  9126        GO TO 8200-SEND-DATAONLY
  9127     END-IF
  9128     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  9129       AND (CSR-EDIT-SESSION)
  9130        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  9131        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  9132        IF (RESP-NORMAL)
  9133           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  9134              AM-CONTROL-PRIMARY (1:20))
  9135            IF AM-NAME NOT GREATER THAN SPACES OR
  9136               AM-ADDRS NOT GREATER THAN SPACES  OR
  9137               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  9138               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  9139               AM-ZIP NOT GREATER THAN SPACES
  9140               MOVE ER-3834             TO EMI-ERROR
  9141               MOVE -1                  TO BMAINTL
  9142               MOVE AL-UANON            TO BMAINTA
  9143               PERFORM 9900-ERROR-FORMAT
  9144                                 THRU 9900-EXIT
  9145               GO TO 8200-SEND-DATAONLY
  9146            END-IF
  9147        ELSE
  9148           MOVE ER-1609             TO EMI-ERROR
  9149           MOVE -1                  TO BMAINTL
  9150           MOVE AL-UANON            TO BMAINTA
  9151           PERFORM 9900-ERROR-FORMAT
  9152                                THRU 9900-EXIT
  9153           GO TO 8200-SEND-DATAONLY
  9154        END-IF
  9155
  9156        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  9157        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  9158        IF (ERMAIL-FOUND)
  9159            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 168
* EL6311.cbl
  9160               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  9161               MA-CITY NOT GREATER THAN SPACES OR
  9162               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  9163               MA-ZIP-CODE NOT GREATER THAN SPACES
  9164               MOVE ER-3835             TO EMI-ERROR
  9165               MOVE -1                  TO BMAINTL
  9166               MOVE AL-UANON            TO BMAINTA
  9167               PERFORM 9900-ERROR-FORMAT
  9168                                 THRU 9900-EXIT
  9169               GO TO 8200-SEND-DATAONLY
  9170            END-IF
  9171        ELSE
  9172           MOVE ER-3000             TO EMI-ERROR
  9173           MOVE -1                  TO BMAINTL
  9174           MOVE AL-UANON            TO BMAINTA
  9175           PERFORM 9900-ERROR-FORMAT
  9176                                THRU 9900-EXIT
  9177           GO TO 8200-SEND-DATAONLY
  9178        END-IF
  9179
  9180     END-IF
  9181     IF (EIBAID = DFHPF15 OR DFHPF17)
  9182        AND (CSR-EDIT-SESSION)
  9183        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9184        MOVE PI-SV-CARRIER       TO PI-CARRIER
  9185        MOVE PI-SV-GROUPING      TO PI-GROUPING
  9186        MOVE PI-SV-STATE         TO PI-STATE
  9187        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  9188        MOVE CCERTNOI            TO PI-CERT-PRIME
  9189        MOVE CSUFIXI             TO PI-CERT-SFX
  9190        MOVE CEFFDTI             TO DEEDIT-FIELD
  9191        PERFORM 8600-DEEDIT
  9192        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9193        MOVE '4'                 TO DC-OPTION-CODE
  9194        PERFORM 9700-DATE-LINK
  9195        IF DATE-CONVERSION-ERROR
  9196           MOVE ER-0348          TO EMI-ERROR
  9197           MOVE -1               TO CEFFDTL
  9198           MOVE AL-UABON         TO CEFFDTA
  9199           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9200           GO TO 8200-SEND-DATAONLY
  9201        ELSE
  9202           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9203           PERFORM 6000-CREATE-TEMP-STORAGE
  9204                                 THRU 6000-EXIT
  9205           IF EIBAID = DFHPF17
  9206               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9207                                  THRU 6400-EXIT
  9208               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9209                                 '2' AND '3' AND '4'
  9210                  MOVE ER-3831     TO  EMI-ERROR
  9211                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9212                  GO TO 8200-SEND-DATAONLY
  9213               END-IF
  9214               MOVE 'Y'          TO PI-CLM-RESC-IND
  9215           ELSE
  9216               MOVE 'N'          TO PI-CLM-RESC-IND
  9217           END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 169
* EL6311.cbl
  9218           MOVE XCTL-EL6316      TO PGM-NAME
  9219           MOVE '2'              TO PI-ISS-CAN-SW
  9220           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9221           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9222           GO TO 9300-XCTL
  9223        END-IF
  9224     END-IF
  9225
  9226     IF EIBAID = DFHPF4
  9227        MOVE '0'                TO PI-EDIT-SW
  9228        IF PI-DISPLAY-ORIGINAL-BATCH
  9229           NEXT SENTENCE
  9230        ELSE
  9231           GO TO 7200-DISPLAY-BATCHES.
  9232
  9233     IF EIBAID = DFHPF5
  9234        MOVE ER-0029                TO EMI-ERROR
  9235        MOVE -1                     TO BPFENTRL
  9236        MOVE AL-UNBON               TO BPFENTRA
  9237        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9238        GO TO 8200-SEND-DATAONLY.
  9239*        MOVE '0'                TO PI-EDIT-SW
  9240*        IF PI-DISPLAY-ORIGINAL-BATCH
  9241*           NEXT SENTENCE
  9242*        ELSE
  9243*           MOVE EL631B              TO PI-MAP-NAME
  9244*           MOVE LOW-VALUES          TO EL631BI
  9245*           MOVE 'A'                 TO BMAINTO
  9246*           MOVE AL-UANON            TO BMAINTA
  9247*           MOVE -1                  TO BMAINTL
  9248*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9249*           GO TO 8100-SEND-INITIAL-MAP.
  9250
  9251     IF EIBAID = DFHPF6
  9252        MOVE ER-0029                TO EMI-ERROR
  9253        MOVE -1                     TO BPFENTRL
  9254        MOVE AL-UNBON               TO BPFENTRA
  9255        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9256        GO TO 8200-SEND-DATAONLY.
  9257*        MOVE '0'                TO PI-EDIT-SW
  9258*        IF PI-DISPLAY-ORIGINAL-BATCH
  9259*           NEXT SENTENCE
  9260*        ELSE
  9261*           MOVE EL631C              TO PI-MAP-NAME
  9262*           MOVE LOW-VALUES          TO EL631CI
  9263*           MOVE 'A'                 TO CMAINTO
  9264*           MOVE AL-UANON            TO CMAINTA
  9265*           MOVE -1                  TO CMAINTL
  9266*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9267*           GO TO 8100-SEND-INITIAL-MAP.
  9268
  9269     IF EIBAID = DFHPF7
  9270        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9271        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9272        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9273        MOVE PI-SV-STATE            TO PI-STATE
  9274        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9275        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 170
* EL6311.cbl
  9276        MOVE CSUFIXI                TO PI-CERT-SFX
  9277        MOVE CEFFDTI                TO DEEDIT-FIELD
  9278        PERFORM 8600-DEEDIT
  9279        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9280        MOVE '4'                    TO DC-OPTION-CODE
  9281        PERFORM 9700-DATE-LINK
  9282        IF DATE-CONVERSION-ERROR
  9283           MOVE ER-0348            TO EMI-ERROR
  9284           MOVE -1                  TO BEFFDTL
  9285           MOVE AL-UABON            TO BEFFDTA
  9286           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9287           GO TO 8200-SEND-DATAONLY
  9288        ELSE
  9289           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9290           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9291           MOVE XCTL-EL1273        TO PGM-NAME
  9292           GO TO 9300-XCTL.
  9293
  9294     IF EIBAID = DFHPF8
  9295        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9296        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9297        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9298        MOVE PI-SV-STATE            TO PI-STATE
  9299        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9300        MOVE CCERTNOI               TO PI-CERT-PRIME
  9301        MOVE CSUFIXI                TO PI-CERT-SFX
  9302        MOVE CEFFDTI                TO DEEDIT-FIELD
  9303        PERFORM 8600-DEEDIT
  9304        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9305        MOVE '4'                    TO DC-OPTION-CODE
  9306        PERFORM 9700-DATE-LINK
  9307        IF DATE-CONVERSION-ERROR
  9308           MOVE ER-0348             TO EMI-ERROR
  9309           MOVE -1                  TO BEFFDTL
  9310           MOVE AL-UABON            TO BEFFDTA
  9311           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9312           GO TO 8200-SEND-DATAONLY
  9313        ELSE
  9314           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9315           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9316           IF PI-COMPANY-ID = 'DMD'
  9317               MOVE XCTL-EL401DMD      TO PGM-NAME
  9318             ELSE
  9319               MOVE XCTL-EL1279        TO PGM-NAME
  9320           END-IF
  9321           GO TO 9300-XCTL.
  9322
  9323     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9324        MOVE XCTL-EL6312     TO PGM-NAME
  9325
  9326* EXEC CICS XCTL
  9327*           PROGRAM  (PGM-NAME)
  9328*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9329*           LENGTH   (WS-COMM-LENGTH)
  9330*       END-EXEC
  9331*    MOVE '.$C                   %   #00009255' TO DFHEIV0
  9332     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9333     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 171
* EL6311.cbl
  9334     MOVE X'2020233030303039323535' TO DFHEIV0(25:11)
  9335     CALL 'kxdfhei1' USING DFHEIV0,
  9336           PGM-NAME,
  9337           PROGRAM-INTERFACE-BLOCK,
  9338           WS-COMM-LENGTH,
  9339           DFHEIV99
  9340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9341     ELSE
  9342        MOVE '0'                 TO  PI-EDIT-SW.
  9343
  9344     IF EIBAID = DFHPF10
  9345         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9346         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9347         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9348         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9349                                    PI-1042-WA
  9350         MOVE 4                  TO PI-689-DATA-SOURCE
  9351         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9352         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9353         MOVE PI-SV-STATE        TO PI-689-STATE
  9354         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9355         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9356         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9357         MOVE PI-PB-ALT-CHG-SEQ-NO
  9358                                 TO PI-689-ALT-SEQ-NO
  9359         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9360         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9361         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9362         MOVE +0                 TO PI-689-CONTROL
  9363         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9364                                    PI-689-EXP-DATE
  9365                                    PI-689-RESP-PERSON
  9366                                    PI-689-TYPE
  9367                                    PI-689-FOLLOW-UP-EDIT
  9368                                    PI-689-RESEND1-EDIT
  9369                                    PI-689-SEQ-EDIT
  9370                                    PI-689-BCSEQ-EDIT
  9371                                    PI-689-LBL-OVERRIDE
  9372         MOVE W-LETTER-COMMUNICATION-AREAS
  9373                                 TO PI-PROGRAM-WORK-AREA
  9374         MOVE XCTL-EL689         TO PGM-NAME
  9375         GO TO 9300-XCTL.
  9376
  9377     IF  EIBAID = DFHPF16
  9378         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9379         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9380         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9381                                    PI-1042-WA
  9382         MOVE 4                  TO PI-689-DATA-SOURCE
  9383         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9384         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9385         MOVE PI-SV-STATE        TO PI-689-STATE
  9386         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9387         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9388         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9389         MOVE PI-PB-ALT-CHG-SEQ-NO
  9390                                 TO PI-689-ALT-SEQ-NO
  9391         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 172
* EL6311.cbl
  9392         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9393         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9394         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9395         MOVE W-LETTER-COMMUNICATION-AREAS
  9396                                 TO PI-PROGRAM-WORK-AREA
  9397         MOVE XCTL-EL690         TO PGM-NAME
  9398         GO TO 9300-XCTL.
  9399     IF (EIBAID = DFHPF13)
  9400        if (not fatal-errors)
  9401           and (not unforced-errors)
  9402           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9403           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9404           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9405           MOVE PI-SV-STATE      TO PI-STATE
  9406           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9407           MOVE CCERTNOI         TO PI-CERT-PRIME
  9408           MOVE CSUFIXI          TO PI-CERT-SFX
  9409           MOVE CEFFDTI          TO DEEDIT-FIELD
  9410           PERFORM 8600-DEEDIT
  9411           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9412           MOVE '4'              TO DC-OPTION-CODE
  9413           PERFORM 9700-DATE-LINK
  9414           IF DATE-CONVERSION-ERROR
  9415              MOVE ER-0348       TO EMI-ERROR
  9416              MOVE -1            TO CEFFDTL
  9417              MOVE AL-UABON      TO CEFFDTA
  9418              PERFORM 9900-ERROR-FORMAT
  9419                                 THRU 9900-EXIT
  9420              GO TO 8200-SEND-DATAONLY
  9421           ELSE
  9422              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9423              MOVE AL-UANON      TO CEFFDTA
  9424              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9425              PERFORM 6000-CREATE-TEMP-STORAGE
  9426                                 THRU 6000-EXIT
  9427              MOVE XCTL-EL677    TO PGM-NAME
  9428              GO TO 9300-XCTL
  9429           end-if
  9430        else
  9431           MOVE ER-3444          TO EMI-ERROR
  9432           MOVE -1               TO CPFENTRL
  9433           MOVE AL-UNBON         TO CPFENTRA
  9434           PERFORM 9900-ERROR-FORMAT
  9435                                 THRU 9900-EXIT
  9436           GO TO 8200-SEND-DATAONLY
  9437        end-if
  9438     end-if
  9439
  9440     IF EIBAID = DFHPF14
  9441        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9442        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9443        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9444        MOVE PI-SV-STATE            TO PI-CR-STATE
  9445        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9446        MOVE SPACE                  TO PI-EDIT-SW
  9447        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9448        MOVE XCTL-EL650             TO PGM-NAME
  9449        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 173
* EL6311.cbl
  9450
  9451     IF EIBAID = DFHENTER OR DFHPF11
  9452        GO TO 2000-CANCEL-MAINLINE.
  9453
  9454     MOVE ER-0029                TO EMI-ERROR.
  9455     MOVE -1                     TO CPFENTRL.
  9456     MOVE AL-UNBON               TO CPFENTRA.
  9457     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9458     GO TO 8200-SEND-DATAONLY.
  9459
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 174
* EL6311.cbl
  9461
  9462******************************************************************
  9463*                                                                *
  9464*      BATCH SCREEN PF KEY CHECKING                              *
  9465*                                                                *
  9466******************************************************************
  9467
  9468******************************************************************
  9469*                                                                *
  9470*      PF KEY FUNCTIONS:                                         *
  9471*                                                                *
  9472*      PF1 = BROWSE FORWARD                                      *
  9473*      PF2 = BROWSE BACKWARD                                     *
  9474*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9475*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9476*                                                                *
  9477*                                                                *
  9478******************************************************************
  9479
  9480 0500-CHECK-BATCH-PF-KEYS.
  9481     IF EIBAID = DFHPF1
  9482        MOVE '0'                TO PI-EDIT-SW
  9483        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9484           GO TO 5000-BROWSE-BATCH-HEADERS
  9485        ELSE
  9486           IF PI-GOOD-BROWSE
  9487              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9488                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9489              ELSE
  9490                 IF PI-FILE-BROWSE
  9491                    GO TO 4300-BROWSE-FILE-FORWARD
  9492                 ELSE
  9493                    IF PI-CSR-BROWSE
  9494                       GO TO 4200-BROWSE-CSR-FORWARD
  9495                    ELSE
  9496                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9497           ELSE
  9498              GO TO 0800-BROWSE-ERROR.
  9499
  9500     IF EIBAID = DFHPF2
  9501        MOVE '0'                TO PI-EDIT-SW
  9502        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9503           GO TO 5500-BROWSE-BATCH-BACKWARD
  9504        ELSE
  9505           IF PI-GOOD-BROWSE
  9506              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9507                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9508              ELSE
  9509                 IF PI-FILE-BROWSE
  9510                    GO TO 4800-BROWSE-FILE-BACKWARD
  9511                 ELSE
  9512                    IF PI-CSR-BROWSE
  9513                       GO TO 4900-BROWSE-CSR-BACKWARD
  9514                    ELSE
  9515                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9516           ELSE
  9517              GO TO 0800-BROWSE-ERROR.
  9518
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 175
* EL6311.cbl
  9519     IF EIBAID = DFHPF3
  9520        GO TO 3000-BATCH-MAINLINE.
  9521
  9522     IF  EIBAID = DFHPF4
  9523        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9524        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9525        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9526        MOVE PI-SV-STATE            TO PI-CR-STATE
  9527        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9528                                       PI-CR-FIN-RESP
  9529        MOVE 'A'                    TO PI-CR-TYPE
  9530        MOVE SPACE                  TO PI-EDIT-SW
  9531        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9532        MOVE XCTL-EL640             TO PGM-NAME
  9533        GO TO 9300-XCTL.
  9534
  9535     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9536       AND
  9537        (EIBAID = DFHENTER)
  9538           GO TO 3500-EDIT-BATCH-DATA.
  9539
  9540     IF EIBAID = DFHENTER
  9541        GO TO 3500-EDIT-BATCH-DATA.
  9542
  9543     MOVE ER-0029             TO EMI-ERROR.
  9544     MOVE -1                  TO DPFENTRL.
  9545     MOVE AL-UNBON            TO DPFENTRA.
  9546     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9547     GO TO 8200-SEND-DATAONLY.
  9548
  9549 0800-BROWSE-ERROR.
  9550     MOVE ER-2258                TO EMI-ERROR.
  9551     MOVE -1                     TO DPFENTRL.
  9552     MOVE AL-UNBON               TO DPFENTRA.
  9553     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9554     GO TO 8200-SEND-DATAONLY.
  9555
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 176
* EL6311.cbl
  9557
  9558******************************************************************
  9559*                                                                *
  9560*                I S S U E   M A I N L I N E                     *
  9561*                                                                *
  9562******************************************************************
  9563
  9564 1000-ISSUE-MAINLINE.
  9565     IF PI-DISPLAY-ORIGINAL-BATCH
  9566        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9567           MOVE ER-0023             TO EMI-ERROR
  9568           MOVE -1                  TO BMAINTL
  9569           MOVE AL-UABON            TO BMAINTA
  9570           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9571           GO TO 8200-SEND-DATAONLY
  9572        ELSE
  9573           NEXT SENTENCE
  9574     ELSE
  9575        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9576           MOVE ER-0023             TO EMI-ERROR
  9577           MOVE -1                  TO BMAINTL
  9578           MOVE AL-UABON            TO BMAINTA
  9579           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9580           GO TO 8200-SEND-DATAONLY.
  9581
  9582     IF BMAINTI = 'S'
  9583        GO TO 1100-SHOW-REQUEST.
  9584
  9585     IF NOT MODIFY-CAP
  9586         MOVE 'UPDATE'       TO SM-READ
  9587         PERFORM 9995-SECURITY-VIOLATION
  9588         MOVE ER-0070        TO EMI-ERROR
  9589         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9590         GO TO 8100-SEND-INITIAL-MAP.
  9591
  9592     IF BMAINTL GREATER THAN ZEROS
  9593        IF PI-PF5-FUNCTION
  9594           IF BMAINTI NOT = 'A'
  9595              MOVE AL-UABON  TO BMAINTA
  9596              MOVE -1        TO BMAINTL
  9597              MOVE ER-2260   TO EMI-ERROR
  9598              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9599              GO TO 8200-SEND-DATAONLY.
  9600
  9601     IF BCERTNOL = ZEROS
  9602       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9603         NEXT SENTENCE
  9604     ELSE
  9605         IF BCERTNOL NOT = ZEROS
  9606             MOVE AL-UANON       TO BCERTNOA
  9607         ELSE
  9608             MOVE -1             TO BCERTNOL
  9609             MOVE  1             TO SET-CURSOR-SW
  9610             MOVE ER-2218        TO EMI-ERROR
  9611             MOVE AL-UABON       TO BCERTNOA
  9612             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9613
  9614     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 177
* EL6311.cbl
  9615         MOVE AL-UANON       TO BSUFIXA
  9616     ELSE
  9617         MOVE AL-SANOF       TO BSUFIXA.
  9618
  9619     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9620        NEXT SENTENCE
  9621     ELSE
  9622        IF BEFFDTL NOT = ZEROS
  9623           MOVE AL-UNNON             TO BEFFDTA
  9624           MOVE BEFFDTI              TO DEEDIT-FIELD
  9625           PERFORM 8600-DEEDIT
  9626           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9627           MOVE 4                    TO DC-OPTION-CODE
  9628           PERFORM 9700-DATE-LINK
  9629           IF NO-CONVERSION-ERROR
  9630              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9631              ELSE
  9632              MOVE -1                TO BEFFDTL
  9633              MOVE  1                TO SET-CURSOR-SW
  9634              MOVE ER-2226           TO EMI-ERROR
  9635              MOVE AL-UNBON          TO BEFFDTA
  9636              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9637           ELSE
  9638              MOVE -1                TO BEFFDTL
  9639              MOVE  1                TO SET-CURSOR-SW
  9640              MOVE ER-2220           TO EMI-ERROR
  9641              MOVE AL-UNBON          TO BEFFDTA
  9642              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9643
  9644     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9645
  9646     IF BCERTNOL NOT = ZEROS
  9647        MOVE BCERTNOI                TO WS-NEW-PRIME
  9648     ELSE
  9649        MOVE SPACES                  TO WS-NEW-PRIME.
  9650
  9651     IF BSUFIXL NOT = ZEROS
  9652        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9653     ELSE
  9654        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9655
  9656     IF BEFFDTL NOT = ZEROS
  9657        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9658     ELSE
  9659        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9660
  9661     IF BMAINTI = 'A' OR 'K' OR 'S'
  9662        NEXT SENTENCE
  9663     ELSE
  9664        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9665        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9666           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9667           WS-PB-RECORD-TYPE NOT = '1'
  9668           IF BMAINTI = 'C'
  9669               MOVE ER-2287          TO EMI-ERROR
  9670               MOVE -1               TO BCERTNOL
  9671               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9672               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 178
* EL6311.cbl
  9673               GO TO 8200-SEND-DATAONLY
  9674             ELSE
  9675               MOVE ER-2260          TO EMI-ERROR
  9676               MOVE -1               TO BCERTNOL
  9677               MOVE AL-UABON         TO BCERTNOA
  9678               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9679               GO TO 8200-SEND-DATAONLY.
  9680
  9681     IF BMAINTI = 'D'
  9682         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9683
  9684*    IF BMICRNOL  NOT =  ZEROS
  9685*        IF BMICRNOI  NUMERIC
  9686*            MOVE AL-UNNON       TO  BMICRNOA
  9687*        ELSE
  9688*            MOVE -1             TO  BMICRNOL
  9689*            MOVE 1              TO  SET-CURSOR-SW
  9690*            MOVE AL-UNBON       TO  BMICRNOA
  9691*            MOVE ER-2701        TO  EMI-ERROR
  9692*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9693     IF BVINL NOT = ZEROS
  9694        MOVE AL-UANON            TO BVINA
  9695     END-IF
  9696     IF B1STNML NOT = ZEROS
  9697         MOVE AL-UANON                TO B1STNMA.
  9698
  9699     IF BINITL  NOT = ZEROS
  9700        MOVE AL-UANON                TO BINITA.
  9701
  9702     IF BSEXL NOT = ZEROS
  9703        IF BSEXI = 'M' OR 'F'
  9704           MOVE AL-UANON             TO BSEXA
  9705        ELSE
  9706           MOVE -1               TO BSEXL
  9707           MOVE ER-2629          TO EMI-ERROR
  9708           MOVE AL-UABON         TO BSEXA
  9709           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9710
  9711     IF BAGEL NOT = ZEROS
  9712         IF BAGEI NUMERIC
  9713             MOVE BAGEI              TO WS-BAGE
  9714             MOVE AL-UNNON           TO BAGEA
  9715         ELSE
  9716             MOVE -1                 TO BAGEL
  9717             MOVE  1                 TO SET-CURSOR-SW
  9718             MOVE ER-2223            TO EMI-ERROR
  9719             MOVE AL-UNBON           TO BAGEA
  9720             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9721
  9722     IF BLSTNML NOT = ZERO  OR
  9723        B1STNML NOT = ZERO  OR
  9724        BINITL NOT = ZERO
  9725         IF BAGEL = ZEROS
  9726             MOVE -1                 TO BAGEL
  9727             MOVE  1                 TO SET-CURSOR-SW
  9728             MOVE ER-3269            TO EMI-ERROR
  9729             MOVE AL-UNBON           TO BAGEA
  9730             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 179
* EL6311.cbl
  9731         END-IF
  9732     END-IF.
  9733
  9734     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9735
  9736     IF (BBIRTHL GREATER THAN +0) AND
  9737        (BBIRTHI NOT EQUAL SPACES)
  9738        NEXT SENTENCE
  9739     ELSE
  9740        GO TO 1010-CHECK-AGE.
  9741
  9742     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9743     PERFORM 8600-DEEDIT.
  9744     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9745     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9746     MOVE AL-UNNON               TO BBIRTHA.
  9747     MOVE '4'                    TO DC-OPTION-CODE.
  9748     PERFORM 9700-DATE-LINK.
  9749     IF DATE-CONVERSION-ERROR
  9750        MOVE -1                  TO BBIRTHL
  9751        MOVE  1                  TO SET-CURSOR-SW
  9752        MOVE ER-2228             TO EMI-ERROR
  9753        MOVE AL-UNBON            TO BBIRTHA
  9754        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9755        GO TO 1010-CHECK-AGE.
  9756
  9757     IF (NO-CONVERSION-ERROR) AND
  9758        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9759        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9760        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9761        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9762                                    WS-CONVERTED-BIRTH
  9763        MOVE AL-UANON            TO BBIRTHA
  9764     ELSE
  9765        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9766        MOVE AL-UANON            TO BBIRTHA.
  9767
  9768 1010-CHECK-AGE.
  9769
  9770*    IF BAGEL = ZERO
  9771*       IF BBIRTHL GREATER THAN ZERO
  9772*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9773
  9774     IF B1STPMTL NOT = ZEROS
  9775        IF B1STPMTI = SPACES
  9776           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9777        ELSE
  9778           MOVE B1STPMTI             TO DEEDIT-FIELD
  9779           PERFORM 8600-DEEDIT
  9780           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9781           MOVE AL-UNNON             TO B1STPMTA
  9782           MOVE 4                    TO DC-OPTION-CODE
  9783           PERFORM 9700-DATE-LINK
  9784           IF NO-CONVERSION-ERROR
  9785              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9786              MOVE AL-UANON          TO B1STPMTA
  9787           ELSE
  9788              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 180
* EL6311.cbl
  9789              MOVE  1                TO SET-CURSOR-SW
  9790              MOVE ER-2200           TO EMI-ERROR
  9791              MOVE AL-UNBON          TO B1STPMTA
  9792              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9793
  9794     IF BDAYSL NOT = ZEROS
  9795         IF BDAYSI NUMERIC
  9796             MOVE AL-UNNON           TO BDAYSA
  9797         ELSE
  9798             MOVE -1                 TO BDAYSL
  9799             MOVE ER-2530            TO EMI-ERROR
  9800             MOVE AL-UNBON           TO BDAYSA
  9801             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9802
  9803     IF BLNTRML NOT = ZEROS
  9804         IF BLNTRMI NUMERIC
  9805             MOVE AL-UNNON       TO BLNTRMA
  9806         ELSE
  9807             MOVE -1             TO BLNTRML
  9808             MOVE ER-2533        TO EMI-ERROR
  9809             MOVE AL-UNBON       TO BLNTRMA
  9810             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9811
  9812**   IF PI-COMPANY-ID = 'DMD'
  9813     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9814        NEXT SENTENCE
  9815     ELSE
  9816         IF BLNOFCRL NOT = ZEROS
  9817            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9818            IF LOAN-OFFICER-FOUND
  9819                MOVE AL-UANON        TO BLNOFCRA
  9820             ELSE
  9821                 MOVE SPACE          TO WS-LOAN-OFFICER
  9822                 MOVE -1             TO BLNOFCRL
  9823                 MOVE  1             TO SET-CURSOR-SW
  9824                 MOVE ER-3006        TO EMI-ERROR
  9825                 MOVE AL-UNBON       TO BLNOFCRA
  9826                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9827
  9828     IF BFREQL NOT = ZEROS
  9829         IF BFREQI NUMERIC
  9830             MOVE AL-UNNON       TO BFREQA
  9831         ELSE
  9832             MOVE -1             TO BFREQL
  9833             MOVE  1             TO SET-CURSOR-SW
  9834             MOVE ER-2223        TO EMI-ERROR
  9835             MOVE AL-UNBON       TO BFREQA
  9836             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9837
  9838     IF BMODEL NOT = ZEROS
  9839         MOVE BMODEI             TO WS-MODE-CODE
  9840                                    PI-BMODE
  9841         IF WS-MODE-CODE-VALID
  9842             MOVE AL-UANON       TO BMODEA
  9843         ELSE
  9844             MOVE -1             TO BMODEL
  9845             MOVE ER-2591        TO EMI-ERROR
  9846             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 181
* EL6311.cbl
  9847             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9848
  9849     IF BPMTSL NOT = ZEROS
  9850         IF BPMTSI NUMERIC
  9851             MOVE AL-UNNON           TO BPMTSA
  9852             MOVE BPMTSI             TO PI-BPMTS
  9853         ELSE
  9854             MOVE -1                 TO BPMTSL
  9855             MOVE ER-2592            TO EMI-ERROR
  9856             MOVE AL-UNBON           TO BPMTSA
  9857             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9858
  9859     IF BPMTAMTL NOT = ZEROS
  9860
  9861* EXEC CICS BIF DEEDIT
  9862*            FIELD  (BPMTAMTI)
  9863*            LENGTH (9)
  9864*       END-EXEC
  9865     MOVE 9
  9866       TO DFHEIV11
  9867*    MOVE '@"L                   #   #00009779' TO DFHEIV0
  9868     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9869     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9870     MOVE X'2020233030303039373739' TO DFHEIV0(25:11)
  9871     CALL 'kxdfhei1' USING DFHEIV0,
  9872           BPMTAMTI,
  9873           DFHEIV11
  9874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9875        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9876*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9877*        PERFORM 8600-DEEDIT
  9878*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9879
  9880*    IF BAPRL NOT = ZEROS
  9881*        EXEC CICS BIF DEEDIT
  9882*            FIELD  (BAPRI)
  9883*            LENGTH (7)
  9884*        END-EXEC
  9885*        MOVE BAPRI              TO WS-BAPR.
  9886
  9887     IF BAPRL > 0
  9888        MOVE +0                  TO  WS-BAPR
  9889        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9890           (WS-SUB > 7)
  9891           OR (BAPRI (WS-SUB:1) NUMERIC)
  9892           OR (BAPRI (WS-SUB:1) = '.')
  9893        END-PERFORM
  9894        IF WS-SUB > 7
  9895           MOVE ER-2471       TO EMI-ERROR
  9896           MOVE -1            TO BAPRL
  9897           MOVE AL-UNBON      TO BAPRA
  9898           PERFORM 9900-ERROR-FORMAT
  9899                                 THRU 9900-EXIT
  9900        ELSE
  9901           IF BAPRI (WS-SUB:1) NUMERIC
  9902              MOVE WS-SUB           TO WS-BEG
  9903              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9904                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 182
* EL6311.cbl
  9905                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9906              END-PERFORM
  9907              COMPUTE WS-END = WS-SUB - WS-BEG
  9908              MOVE BAPRI (WS-BEG:WS-END)
  9909                                 TO WS-APR-WHOLE-NUM
  9910           END-IF
  9911           IF BAPRI (WS-SUB:1) = '.'
  9912              COMPUTE WS-BEG = WS-SUB + 1
  9913              IF (WS-BEG < 8)
  9914                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9915                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9916                    (WS-SUB > 7)
  9917                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9918                 END-PERFORM
  9919                 COMPUTE WS-END = WS-SUB - WS-BEG
  9920                 MOVE BAPRI (WS-BEG:WS-END)
  9921                                 TO WS-APR-DEC (1:WS-END)
  9922              END-IF
  9923           END-IF
  9924           MOVE AL-UNNON      TO BAPRA
  9925           MOVE WS-BAPR       TO BAPRO
  9926        END-IF
  9927     END-IF
  9928*     IF BAPRL NOT = ZEROS
  9929*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9930*        PERFORM 8600-DEEDIT
  9931*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9932
  9933     IF BLIVESL NOT = ZEROS
  9934        MOVE BLIVESI             TO DEEDIT-FIELD
  9935        PERFORM 8600-DEEDIT
  9936        IF DEEDIT-FIELD-V0 NUMERIC
  9937           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9938           MOVE AL-UNNON         TO BLIVESA
  9939        ELSE
  9940           MOVE -1               TO BLIVESL
  9941           MOVE AL-UNBON         TO BLIVESA
  9942           MOVE ER-2223          TO EMI-ERROR
  9943           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9944
  9945*DMD CUSTOM CODING*************START
  9946*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9947     IF PI-COMPANY-ID NOT = 'DMD'
  9948         MOVE ZEROS               TO BBILLEDL
  9949         GO TO 1010-EDIT-CONT.
  9950
  9951     IF BBILLEDL NOT = ZEROS
  9952        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9953        MOVE 'Y'                 TO WS-NUMERIC-SW
  9954        MOVE +1                  TO WS-CSO-SUB
  9955        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9956        IF CSO-NUMERIC-FIELD
  9957
  9958* EXEC CICS BIF DEEDIT
  9959*              FIELD  (BBILLEDI)
  9960*              LENGTH (9)
  9961*          END-EXEC
  9962     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 183
* EL6311.cbl
  9963       TO DFHEIV11
  9964*    MOVE '@"L                   #   #00009865' TO DFHEIV0
  9965     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9966     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9967     MOVE X'2020233030303039383635' TO DFHEIV0(25:11)
  9968     CALL 'kxdfhei1' USING DFHEIV0,
  9969           BBILLEDI,
  9970           DFHEIV11
  9971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9972           MOVE BBILLEDI         TO WS-BILLED
  9973           MOVE AL-UNNON         TO BBILLEDA
  9974        ELSE
  9975           MOVE -1               TO BBILLEDL
  9976           MOVE AL-UNBON         TO BBILLEDA
  9977           MOVE ER-2547          TO EMI-ERROR
  9978           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9979     ELSE
  9980        IF BMAINTI EQUAL 'A'
  9981           MOVE -1               TO BBILLEDL
  9982           MOVE AL-UNBON         TO BBILLEDA
  9983           MOVE ER-8148          TO EMI-ERROR
  9984           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9985
  9986 1010-EDIT-CONT.
  9987
  9988     IF BFORCEL  NOT = ZEROS
  9989         IF FORCE-CAP
  9990            MOVE AL-UANON            TO BFORCEA
  9991         ELSE
  9992            MOVE ER-2945             TO EMI-ERROR
  9993            MOVE AL-UABON            TO BFORCEA
  9994            MOVE -1                  TO BFORCEL
  9995            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9996
  9997     if (bforcel not = zeros)
  9998        and (bforcei = 'L')
  9999        and (not csr-edit-session)
 10000        and (emi-error <> er-2945)
 10001        MOVE ER-2670             TO EMI-ERROR
 10002        MOVE AL-UABON            TO BFORCEA
 10003        MOVE -1                  TO BFORCEL
 10004        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10005     end-if
 10006     IF BENTRYL NOT = ZEROS
 10007        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
 10008                 'C' and 'D' AND 'V' AND 'U' AND 'M'
 10009           MOVE ER-2224              TO EMI-ERROR
 10010           MOVE AL-UABON             TO BENTRYA
 10011           MOVE -1                   TO BENTRYL
 10012           MOVE  1                   TO SET-CURSOR-SW
 10013           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10014        ELSE
 10015           MOVE AL-UANON             TO BENTRYA.
 10016
 10017     IF BUNWRITL NOT = ZEROS
 10018        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
 10019           MOVE ER-7574              TO EMI-ERROR
 10020           MOVE AL-UABON             TO BUNWRITA
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 184
* EL6311.cbl
 10021           MOVE -1                   TO BUNWRITL
 10022           MOVE  1                   TO SET-CURSOR-SW
 10023           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10024        ELSE
 10025           MOVE AL-UANON             TO BUNWRITA.
 10026
 10027     IF BREINL  NOT = ZEROS
 10028         MOVE AL-UANON               TO BREINA.
 10029
 10030     IF BBILCDL NOT = ZEROS
 10031        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 10032                             AND 'A' AND 'B' AND 'E'
 10033           MOVE ER-2225              TO EMI-ERROR
 10034           MOVE AL-UABON             TO BBILCDA
 10035           MOVE -1                   TO BBILCDL
 10036           MOVE  1                   TO SET-CURSOR-SW
 10037           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10038        ELSE
 10039           MOVE AL-UANON             TO BBILCDA.
 10040
 10041     IF BSKPCDL NOT = ZEROS
 10042         MOVE AL-UANON               TO BSKPCDA.
 10043
 10044     IF BINDGRPL NOT = ZEROS
 10045         MOVE AL-UANON               TO BINDGRPA.
 10046
 10047     IF BSIGL   NOT = ZEROS
 10048         MOVE AL-UANON               TO BSIGA.
 10049
 10050     IF BRTCLSL NOT = ZEROS
 10051         MOVE AL-UANON               TO BRTCLSA.
 10052
 10053     IF BMEMBERL NOT = ZEROS
 10054         MOVE AL-UANON               TO BMEMBERA.
 10055
 10056     MOVE +0                         TO WS-SUB1.
 10057
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 185
* EL6311.cbl
 10059
 10060******************************************************************
 10061*                                                                *
 10062*           E D I T   I S S U E   C O V E R A G E S              *
 10063*                                                                *
 10064******************************************************************
 10065
 10066 1020-EDIT-COVERAGES.
 10067     ADD +1                      TO WS-SUB1.
 10068
 10069     IF WS-SUB1 GREATER +2
 10070        GO TO 1025-EDIT-CONTINUE
 10071     END-IF
 10072
 10073     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10074       IF (BMODEL   GREATER ZERO  OR
 10075            BPMTSL   GREATER ZERO  OR
 10076            BPMTAMTL GREATER ZERO)
 10077          AND
 10078            BTYPE-LEN (WS-SUB1) GREATER THAN +0
 10079               GO TO 1021-CONT-EDIT.
 10080
 10081     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10082        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10083        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
 10084        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10085        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
 10086        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
 10087        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
 10088        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
 10089        NEXT SENTENCE
 10090         ELSE
 10091            GO TO 1020-EDIT-COVERAGES.
 10092
 10093 1021-CONT-EDIT.
 10094
 10095     IF BMAINTI = 'A'
 10096        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10097           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
 10098        ELSE
 10099           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
 10100           MOVE ER-7404          TO EMI-ERROR
 10101           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
 10102           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10103     ELSE
 10104        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10105           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
 10106
 10107     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
 10108        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
 10109        PERFORM 8600-DEEDIT
 10110        IF DEEDIT-FIELD-V0 NUMERIC
 10111           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
 10112        ELSE
 10113           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
 10114
 10115     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10116*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 186
* EL6311.cbl
 10117        IF BMODEL  GREATER THAN ZEROS  AND
 10118           BPMTSL  GREATER THAN ZEROS
 10119           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10120
 10121     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10122         IF BMODEL   GREATER THAN ZEROS  OR
 10123            BPMTSL   GREATER THAN ZEROS  OR
 10124            BPMTAMTL GREATER THAN ZEROS
 10125             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10126
 10127     IF BMAINTI = ('C' OR 'K')
 10128        IF BTERM-LEN (WS-SUB1)  = ZEROS
 10129           NEXT SENTENCE
 10130        ELSE
 10131           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10132           PERFORM 8600-DEEDIT
 10133           IF DEEDIT-FIELD-V0 NUMERIC
 10134              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
 10135              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
 10136                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
 10137              ELSE
 10138                    MOVE ER-2241      TO EMI-ERROR
 10139                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
 10140                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
 10141                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10142           ELSE
 10143              MOVE ER-2223          TO EMI-ERROR
 10144              MOVE -1               TO BTERM-LEN     (WS-SUB1)
 10145              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
 10146              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10147     ELSE
 10148        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
 10149            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10150            PERFORM 8600-DEEDIT
 10151            IF DEEDIT-FIELD-V0      NUMERIC
 10152               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
 10153                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
 10154                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
 10155               ELSE
 10156                  MOVE ER-2241         TO EMI-ERROR
 10157                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
 10158                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
 10159                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10160            ELSE
 10161              MOVE ER-2223             TO EMI-ERROR
 10162              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
 10163              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
 10164              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10165        ELSE
 10166            MOVE ER-2240               TO EMI-ERROR
 10167            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
 10168            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10169*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10170*        IF BMODEL  GREATER THAN ZEROS  AND
 10171*           BPMTSL  GREATER THAN ZEROS
 10172*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10173
 10174     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 187
* EL6311.cbl
 10175        AND BMAINTI = ('C' OR 'K')
 10176           NEXT SENTENCE
 10177     ELSE
 10178        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
 10179           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
 10180
 10181* EXEC CICS BIF DEEDIT
 10182*              FIELD  (BBENI (WS-SUB1))
 10183*              LENGTH (12)
 10184*          END-EXEC
 10185     MOVE 12
 10186       TO DFHEIV11
 10187*    MOVE '@"L                   #   #00010077' TO DFHEIV0
 10188     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10189     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10190     MOVE X'2020233030303130303737' TO DFHEIV0(25:11)
 10191     CALL 'kxdfhei1' USING DFHEIV0,
 10192           BBENI(WS-SUB1),
 10193           DFHEIV11
 10194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10195           IF BBENI (WS-SUB1)  NUMERIC
 10196              IF BBENI (WS-SUB1) GREATER THAN ZEROS
 10197                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
 10198*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
 10199*          PERFORM 8600-DEEDIT
 10200*          IF DEEDIT-FIELD-V2  NUMERIC
 10201*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10202*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10203              ELSE
 10204                 MOVE ER-7632    TO EMI-ERROR
 10205                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10206                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10207                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10208           ELSE
 10209              MOVE ER-2223         TO EMI-ERROR
 10210              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10211              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10212              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10213        ELSE
 10214           MOVE ER-7632    TO EMI-ERROR
 10215           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10216           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10217           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10218
 10219     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10220        AND (BMAINTI = ('C' OR 'K'))
 10221        CONTINUE
 10222     ELSE
 10223        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10224           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10225           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10226              FOR ALL '.'
 10227           IF WS-TALLY > 1
 10228              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10229                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10230              END-PERFORM
 10231              IF A1 < 9
 10232                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 188
* EL6311.cbl
 10233                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10234              END-IF
 10235           ELSE
 10236              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10237                (A1 > 11)
 10238                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10239                  LOW-VALUES OR SPACES)
 10240              END-PERFORM
 10241              IF A1 > 1 AND < 12
 10242                 MOVE SPACES
 10243                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10244              END-IF
 10245           END-IF
 10246
 10247* EXEC CICS BIF DEEDIT
 10248*              FIELD  (BPREMI (WS-SUB1))
 10249*              LENGTH (11)
 10250*          END-EXEC
 10251     MOVE 11
 10252       TO DFHEIV11
 10253*    MOVE '@"L                   #   #00010132' TO DFHEIV0
 10254     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10255     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10256     MOVE X'2020233030303130313332' TO DFHEIV0(25:11)
 10257     CALL 'kxdfhei1' USING DFHEIV0,
 10258           BPREMI(WS-SUB1),
 10259           DFHEIV11
 10260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10261           IF BPREMI (WS-SUB1) NUMERIC
 10262              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10263                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10264*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10265*          PERFORM 8600-DEEDIT
 10266*          IF DEEDIT-FIELD-V2  NUMERIC
 10267*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10268*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10269              ELSE
 10270                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10271                    MOVE ER-7633    TO EMI-ERROR
 10272                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10273                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10274                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10275                 END-IF
 10276              END-IF
 10277           ELSE
 10278              MOVE ER-2223         TO EMI-ERROR
 10279              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10280              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10281              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10282           END-IF
 10283        ELSE
 10284           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10285              MOVE ER-7633         TO EMI-ERROR
 10286              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10287              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10288              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10289           END-IF
 10290        END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 189
* EL6311.cbl
 10291     END-IF
 10292
 10293     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10294        NEXT SENTENCE
 10295     ELSE
 10296        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10297
 10298* EXEC CICS BIF DEEDIT
 10299*           FIELD  (BCPREMI (WS-SUB1))
 10300*           LENGTH (11)
 10301*       END-EXEC
 10302     MOVE 11
 10303       TO DFHEIV11
 10304*    MOVE '@"L                   #   #00010172' TO DFHEIV0
 10305     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10306     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10307     MOVE X'2020233030303130313732' TO DFHEIV0(25:11)
 10308     CALL 'kxdfhei1' USING DFHEIV0,
 10309           BCPREMI(WS-SUB1),
 10310           DFHEIV11
 10311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10312        IF BCPREMI (WS-SUB1) NUMERIC
 10313           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10314*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10315*       PERFORM 8600-DEEDIT
 10316*       IF DEEDIT-FIELD-V2  NUMERIC
 10317*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10318        ELSE
 10319           MOVE ER-2223         TO EMI-ERROR
 10320           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10321           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10322           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10323
 10324     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10325        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10326        PERFORM 8600-DEEDIT
 10327        IF DEEDIT-FIELD-V0 NUMERIC
 10328           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10329           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10330         ELSE
 10331           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10332           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10333           MOVE ER-2223              TO EMI-ERROR
 10334           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10335
 10336     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10337        IF BEXPIRE   (WS-SUB1) = SPACES
 10338           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10339        ELSE
 10340           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10341           PERFORM 8600-DEEDIT
 10342           IF DEEDIT-FIELD-V0        NUMERIC
 10343              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10344              MOVE 4                TO DC-OPTION-CODE
 10345              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10346              PERFORM 9700-DATE-LINK
 10347              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10348                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 190
* EL6311.cbl
 10349              IF NO-CONVERSION-ERROR
 10350                 NEXT SENTENCE
 10351              ELSE
 10352                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10353                 MOVE ER-2531    TO EMI-ERROR
 10354                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10355                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10356           ELSE
 10357             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10358             MOVE ER-2532        TO EMI-ERROR
 10359             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10360             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10361
 10362     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10363        NEXT SENTENCE
 10364     ELSE
 10365
 10366* EXEC CICS BIF DEEDIT
 10367*           FIELD  (BALT-BENI (WS-SUB1))
 10368*           LENGTH (12)
 10369*       END-EXEC
 10370     MOVE 12
 10371       TO DFHEIV11
 10372*    MOVE '@"L                   #   #00010229' TO DFHEIV0
 10373     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10374     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10375     MOVE X'2020233030303130323239' TO DFHEIV0(25:11)
 10376     CALL 'kxdfhei1' USING DFHEIV0,
 10377           BALT-BENI(WS-SUB1),
 10378           DFHEIV11
 10379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10380        IF BALT-BENI (WS-SUB1) NUMERIC
 10381           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10382*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10383*       PERFORM 8600-DEEDIT
 10384*       IF DEEDIT-FIELD-V0 NUMERIC
 10385*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10386        ELSE
 10387           MOVE ER-2223         TO EMI-ERROR
 10388           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10389           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10390           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10391
 10392     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10393        NEXT SENTENCE
 10394     ELSE
 10395
 10396* EXEC CICS BIF DEEDIT
 10397*           FIELD  (BALT-PREMI (WS-SUB1))
 10398*           LENGTH (11)
 10399*       END-EXEC
 10400     MOVE 11
 10401       TO DFHEIV11
 10402*    MOVE '@"L                   #   #00010248' TO DFHEIV0
 10403     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10404     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10405     MOVE X'2020233030303130323438' TO DFHEIV0(25:11)
 10406     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 191
* EL6311.cbl
 10407           BALT-PREMI(WS-SUB1),
 10408           DFHEIV11
 10409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10410        IF BALT-PREMI (WS-SUB1) NUMERIC
 10411           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10412*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10413*       PERFORM 8600-DEEDIT
 10414*       IF DEEDIT-FIELD-V0 NUMERIC
 10415*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10416        ELSE
 10417           MOVE ER-2223         TO EMI-ERROR
 10418           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10419           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10420           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10421
 10422      GO TO 1020-EDIT-COVERAGES.
 10423     .
 10424 1025-edit-continue.
 10425     IF PI-COMPANY-ID  =  'DMD'
 10426        MOVE LOW-VALUES             TO BNCERTI
 10427                                       BNSTATI.
 10428
 10429     IF EMI-ERROR = ZEROS
 10430         NEXT SENTENCE
 10431     ELSE
 10432         GO TO 8200-SEND-DATAONLY.
 10433
 10434     IF BMAINTI = 'A'
 10435         GO TO 1200-ADD-ISSUE-ROUTINE.
 10436
 10437     IF BMAINTI = 'C'
 10438         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10439
 10440     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10441
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 192
* EL6311.cbl
 10443
 10444 1030-EDIT-FOR-NUMERICS.
 10445     IF WS-CSO-SUB EQUAL 10
 10446        GO TO 1030-EDIT-EXIT.
 10447
 10448     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10449        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10450        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10451           ADD +1               TO WS-CSO-SUB
 10452           GO TO 1030-EDIT-FOR-NUMERICS.
 10453
 10454     MOVE 'N'                   TO WS-NUMERIC-SW.
 10455
 10456 1030-EDIT-EXIT.
 10457******************************************************************
 10458*                                                                *
 10459*                 C A L C U L A T E   A G E                      *
 10460*                                                                *
 10461******************************************************************
 10462
 10463
 10464 1095-CALC-AGE.
 10465
 10466     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10467     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10468     MOVE 1                  TO DC-OPTION-CODE.
 10469     PERFORM 9700-DATE-LINK
 10470     IF NO-CONVERSION-ERROR
 10471         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10472         MOVE WS-BAGE            TO BAGEI
 10473         MOVE +2                 TO BAGEL
 10474         MOVE AL-UNNON TO BAGEA.
 10475
 10476 1099-EXIT.
 10477     EXIT.
 10478
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 193
* EL6311.cbl
 10480
 10481******************************************************************
 10482*                                                                *
 10483*                   S H O W   I S S U E                          *
 10484*                                                                *
 10485******************************************************************
 10486
 10487 1100-SHOW-REQUEST.
 10488     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10489
 10490     IF BCERTNOL = ZEROS AND
 10491        BEFFDTL  = ZEROS
 10492        MOVE -1                  TO BMAINTL
 10493        GO TO 8200-SEND-DATAONLY.
 10494
 10495     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10496
 10497     IF BSUFIXL NOT = ZEROS
 10498        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10499     ELSE
 10500        MOVE SPACE               TO WS-NEW-SUFFIX.
 10501
 10502     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10503     PERFORM 8600-DEEDIT.
 10504     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10505     MOVE '4'                    TO DC-OPTION-CODE.
 10506     PERFORM 9700-DATE-LINK.
 10507     IF DATE-CONVERSION-ERROR
 10508        MOVE ER-0348             TO EMI-ERROR
 10509        MOVE -1                  TO BEFFDTL
 10510        MOVE AL-UABON            TO BEFFDTA
 10511        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10512        GO TO 8200-SEND-DATAONLY
 10513     ELSE
 10514        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10515        MOVE AL-UANON            TO BEFFDTA
 10516        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10517
 10518     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10519
 10520     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10521        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10522          MOVE 'Y'                    TO WS-SHOW-SW
 10523          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10524             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10525           ELSE
 10526             IF PI-FILE-BROWSE
 10527                GO TO 4300-BROWSE-FILE-FORWARD
 10528              ELSE
 10529                IF PI-CSR-BROWSE
 10530                   GO TO 4200-BROWSE-CSR-FORWARD
 10531                ELSE
 10532                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10533        ELSE
 10534           GO TO 3900-RE-DISPLAY-RECORD.
 10535
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 194
* EL6311.cbl
 10537
 10538******************************************************************
 10539*                                                                *
 10540*            A D D   I S S U E   R O U T I N E                   *
 10541*                                                                *
 10542******************************************************************
 10543
 10544***************************************************************
 10545*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10546*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10547*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10548*     4. LINK TO THE EDIT ROUTINE.                            *
 10549*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10550*     6. WRITE THE NEW ISSUE RECORD.                          *
 10551*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10552*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10553*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10554*        ELSE                                                 *
 10555*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10556***************************************************************
 10557
 10558 1200-ADD-ISSUE-ROUTINE.
 10559     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10560
 10561
 10562* EXEC CICS GETMAIN
 10563*        SET     (ADDRESS OF PENDING-BUSINESS)
 10564*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10565*    END-EXEC.
 10566*    MOVE '," L                  $   #00010403' TO DFHEIV0
 10567     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10568     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10569     MOVE X'2020233030303130343033' TO DFHEIV0(25:11)
 10570     CALL 'kxdfhei1' USING DFHEIV0,
 10571           DFHEIV20,
 10572           ERPNDB-RECORD-LENGTH,
 10573           DFHEIV99
 10574     SET ADDRESS OF PENDING-BUSINESS TO
 10575         DFHEIV20
 10576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10577
 10578
 10579
 10580* EXEC CICS HANDLE CONDITION
 10581*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10582*    END-EXEC.
 10583*    MOVE '"$I                   ! # #00010408' TO DFHEIV0
 10584     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10585     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10586     MOVE X'2320233030303130343038' TO DFHEIV0(25:11)
 10587     CALL 'kxdfhei1' USING DFHEIV0
 10588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10589
 10590
 10591     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10592     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10593     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10594
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 195
* EL6311.cbl
 10595
 10596* EXEC CICS READ
 10597*        INTO    (PENDING-BUSINESS)
 10598*        DATASET (FILE-ID-ERPNDB)
 10599*        RIDFLD  (ERPNDB-KEY)
 10600*    END-EXEC.
 10601     MOVE LENGTH OF
 10602      PENDING-BUSINESS
 10603       TO DFHEIV11
 10604*    MOVE '&"IL       E          (   #00010416' TO DFHEIV0
 10605     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10606     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10607     MOVE X'2020233030303130343136' TO DFHEIV0(25:11)
 10608     CALL 'kxdfhei1' USING DFHEIV0,
 10609           FILE-ID-ERPNDB,
 10610           PENDING-BUSINESS,
 10611           DFHEIV11,
 10612           ERPNDB-KEY,
 10613           DFHEIV99,
 10614           DFHEIV99,
 10615           DFHEIV99
 10616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10617
 10618
 10619     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10620
 10621     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10622     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10623     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10624     MOVE SPACES                 TO PENDING-BUSINESS.
 10625     MOVE 'PB'                   TO PB-RECORD-ID.
 10626     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10627     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10628     MOVE SPACES                 TO PB-CERT-SFX.
 10629     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10630     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10631                                    PB-ALT-CHG-SEQ-NO.
 10632
 10633     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10634     MOVE '1'                    TO PB-RECORD-TYPE.
 10635
 10636     IF BSUFIXL NOT = ZEROS
 10637        MOVE BSUFIXI             TO PB-CERT-SFX.
 10638
 10639     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10640
 10641     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10642     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10643
 10644     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10645                                    PB-I-LF-PREM-CALC
 10646                                    PB-I-LF-ALT-PREM-CALC
 10647                                    PB-I-LF-RATE
 10648                                    PB-I-LF-ALT-RATE
 10649                                    PB-I-LF-REI-RATE
 10650                                    PB-I-LF-ALT-REI-RATE
 10651                                    PB-I-RATE-DEV-PCT-LF
 10652                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 196
* EL6311.cbl
 10653                                    PB-I-AH-RATE
 10654                                    PB-I-AH-REI-RATE
 10655                                    PB-I-AH-RATE-TRM
 10656                                    PB-I-RATE-DEV-PCT-AH
 10657                                    PB-I-BUSINESS-TYPE
 10658                                    PB-I-LIFE-COMMISSION
 10659                                    PB-I-JOINT-COMMISSION
 10660                                    PB-I-JOINT-AGE
 10661                                    PB-I-AH-COMMISSION
 10662                                    PB-I-CURR-SEQ
 10663                                    PB-CHG-COUNT
 10664                                    PB-LF-BILLED-AMTS
 10665                                    PB-AH-BILLED-AMTS
 10666                                    PB-CALC-TOLERANCE
 10667                                    PB-I-EXTENTION-DAYS
 10668*                                   PB-I-MICROFILM-NO
 10669                                    PB-I-TERM-IN-DAYS.
 10670
 10671     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10672                                    PB-I-LF-EXPIRE-DT
 10673                                    PB-I-AH-EXPIRE-DT
 10674                                    PB-BILLED-DT
 10675                                    PB-ACCT-EFF-DT
 10676                                    PB-ACCT-EXP-DT
 10677                                    PB-I-1ST-PMT-DT.
 10678
 10679     MOVE 'X'                    TO PB-FATAL-FLAG.
 10680
 10681     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10682
 10683     IF BLSTNML GREATER THAN ZEROS
 10684         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10685
 10686*    IF BMICRNOL  GREATER  ZEROS
 10687*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10688*    ELSE
 10689*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10690     IF BVINL > ZEROS
 10691        MOVE BVINI               TO PB-I-VIN
 10692     END-IF
 10693     IF B1STNML GREATER THAN ZEROS
 10694         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10695
 10696     IF BINITL  GREATER THAN ZEROS
 10697         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10698
 10699     IF BBIRTHL GREATER THAN ZERO
 10700         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10701     ELSE
 10702         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10703
 10704     IF B1STPMTL GREATER THAN ZERO
 10705         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10706     ELSE
 10707         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10708
 10709     IF BAGEL    GREATER THAN ZEROS
 10710         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 197
* EL6311.cbl
 10711        ELSE
 10712         MOVE ZEROS              TO PB-I-AGE.
 10713
 10714     IF BSEXL    GREATER THAN ZEROS
 10715         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10716
 10717     IF BTERM-LEN (1) GREATER THAN ZEROS
 10718        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10719     ELSE
 10720        MOVE ZEROS               TO PB-I-LF-TERM.
 10721
 10722     IF BTERM-LEN (2) GREATER THAN ZEROS
 10723        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10724     ELSE
 10725        MOVE ZEROS               TO PB-I-AH-TERM.
 10726
 10727     IF BLNTRML       GREATER THAN ZEROS
 10728         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10729        ELSE
 10730         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10731
 10732     IF BFREQL        GREATER THAN ZEROS
 10733         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10734        ELSE
 10735         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10736
 10737     IF BSKPCDL       GREATER THAN ZEROS
 10738         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10739
 10740     IF BMODEL        GREATER THAN ZEROS
 10741         MOVE BMODEI             TO PB-I-TERM-TYPE
 10742                                    PI-BMODE.
 10743
 10744     IF BPMTSL        GREATER THAN ZEROS
 10745         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10746                                    PI-BPMTS
 10747        ELSE
 10748         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10749                                    PI-BPMTS.
 10750
 10751     IF BPMTAMTL      GREATER THAN ZEROS
 10752         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10753        ELSE
 10754         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10755
 10756     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10757        IF BTYPE  (1)   NOT = ZEROS
 10758           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10759                                    PI-BTYPE (1)
 10760           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10761           MOVE SPACES           TO PB-I-LF-ABBR
 10762        ELSE
 10763           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10764                                    PB-I-LF-ABBR
 10765           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10766     ELSE
 10767        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10768                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 198
* EL6311.cbl
 10769        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10770
 10771     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10772         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10773     ELSE
 10774         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10775
 10776     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10777         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10778     ELSE
 10779         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10780
 10781     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10782         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10783            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10784            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10785         ELSE
 10786            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10787*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10788*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10789         END-IF
 10790     ELSE
 10791         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10792
 10793     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10794         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10795
 10796     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10797         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10798         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10799     ELSE
 10800         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10801
 10802     IF  BALT-PREM-LEN     (2) > ZEROS
 10803         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10804     ELSE
 10805         MOVE ZEROS            TO PB-I-TOT-FEES.
 10806
 10807     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10808        IF BTYPE      (2)   NOT = ZEROS
 10809           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10810                                  PI-BTYPE (2)
 10811           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10812           MOVE SPACES         TO PB-I-AH-ABBR
 10813        ELSE
 10814           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10815                                  PB-I-AH-ABBR
 10816           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10817     ELSE
 10818        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10819                                  PB-I-AH-ABBR
 10820        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10821
 10822     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10823         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10824     ELSE
 10825         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10826
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 199
* EL6311.cbl
 10827     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10828         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10829            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10830            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10831         ELSE
 10832            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10833*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10834*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10835         END-IF
 10836     ELSE
 10837         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10838
 10839     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10840         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10841
 10842     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10843        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10844     ELSE
 10845        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10846
 10847     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10848        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10849     ELSE
 10850        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10851
 10852     IF BINDGRPL  GREATER THAN ZEROS
 10853         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10854
 10855     IF BRTCLSL   GREATER THAN ZEROS
 10856         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10857
 10858     IF BSIGL     GREATER THAN ZEROS
 10859         MOVE BSIGI              TO PB-I-SIG-SW.
 10860     IF BAPRL > ZEROS
 10861         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10862     ELSE
 10863        if pi-company-id = 'CID'
 10864           move +99.9999         to pb-i-loan-apr
 10865        else
 10866           MOVE ZEROS            TO PB-I-LOAN-APR
 10867        end-if
 10868     end-if
 10869     IF BMEMBERL  GREATER THAN ZEROS
 10870         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10871
 10872     IF BLNOFCRL  GREATER THAN ZEROS
 10873         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10874
 10875     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10876        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10877     ELSE
 10878        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10879
 10880     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10881        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10882     ELSE
 10883        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10884
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 200
* EL6311.cbl
 10885     IF BDAYSL   GREATER THAN ZEROS
 10886        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10887                                    PB-I-EXTENTION-DAYS
 10888     ELSE
 10889        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10890                                    PB-I-EXTENTION-DAYS.
 10891
 10892     IF BDAYSL GREATER THAN ZEROS
 10893        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10894
 10895     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10896        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10897           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10898
 10899     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10900        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10901           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10902
 10903     IF B1STPMTL GREATER THAN ZEROS
 10904        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10905
 10906     IF PB-EXT-DAYS-PROCESSING
 10907        IF PB-I-EXTENTION-DAYS = ZEROS
 10908           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10909
 10910     IF PB-EXPIRE-DT-PROCESSING
 10911        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10912           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10913             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10914
 10915     IF PB-1ST-PMT-DT-PROCESSING
 10916        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10917           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10918
 10919     IF BREINL GREATER THAN ZEROS
 10920        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10921
 10922     IF BENTRYL NOT = ZEROS
 10923        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10924        IF PI-COMPANY-ID = 'CID'
 10925           AND (PB-BATCH-ENTRY = 'P')
 10926           AND (PB-STATE = 'VA')
 10927           PERFORM 1500-UPDATE-ERNOTE
 10928                                 THRU 1500-EXIT
 10929        END-IF
 10930     END-IF
 10931     IF BUNWRITL NOT = ZEROS
 10932        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10933
 10934     IF BFORCEL NOT = ZEROS
 10935        MOVE BFORCEI             TO PB-FORCE-CODE.
 10936
 10937     IF BBILCDL NOT = ZEROS
 10938        MOVE BBILCDI             TO PB-RECORD-BILL.
 10939
 10940     IF BLIVESL GREATER THAN ZEROS
 10941        MOVE WS-BLIVES           TO PB-I-LIVES
 10942     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 201
* EL6311.cbl
 10943        MOVE ZEROS               TO PB-I-LIVES.
 10944
 10945     IF BBILLEDL GREATER THAN ZEROS
 10946        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10947     ELSE
 10948        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10949
 10950*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10951
 10952 1260-WRITE-PB-RECORD.
 10953     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10954                                    PB-INPUT-BY.
 10955     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10956     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10957                                    PB-INPUT-DT.
 10958
 10959     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10960     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10961                                    PB-CONTROL-BY-ORIG-BATCH.
 10962
 10963
 10964     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10965     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10966     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10967     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10968     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10969
 10970     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10971
 10972     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10973
 10974     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10975     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10976     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10977
 10978     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10979     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10980
 10981 1275-WRITE-PENDING-BUSINESS.
 10982     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10983     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10984     MOVE 'A'                    TO JP-RECORD-TYPE.
 10985     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10986
 10987
 10988* EXEC CICS HANDLE CONDITION
 10989*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10990*    END-EXEC.
 10991*    MOVE '"$%                   ! $ #00010790' TO DFHEIV0
 10992     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10994     MOVE X'2420233030303130373930' TO DFHEIV0(25:11)
 10995     CALL 'kxdfhei1' USING DFHEIV0
 10996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10997
 10998
 10999
 11000* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 202
* EL6311.cbl
 11001*        DATASET (FILE-ID-ERPNDB)
 11002*        FROM    (PENDING-BUSINESS)
 11003*        RIDFLD  (PB-CONTROL-PRIMARY)
 11004*    END-EXEC.
 11005     MOVE LENGTH OF
 11006      PENDING-BUSINESS
 11007       TO DFHEIV11
 11008*    MOVE '&$ L                  ''   #00010794' TO DFHEIV0
 11009     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11010     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11011     MOVE X'2020233030303130373934' TO DFHEIV0(25:11)
 11012     CALL 'kxdfhei1' USING DFHEIV0,
 11013           FILE-ID-ERPNDB,
 11014           PENDING-BUSINESS,
 11015           DFHEIV11,
 11016           PB-CONTROL-PRIMARY,
 11017           DFHEIV99,
 11018           DFHEIV99
 11019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11020
 11021
 11022     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 11023
 11024     PERFORM 8400-LOG-JOURNAL-RECORD.
 11025
 11026******************************************************************
 11027*       A D D  O R I G I N A L  C E R T  I N F O                 *
 11028******************************************************************
 11029     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11030     MOVE ' '                    TO WS-ERMAIL-SW
 11031
 11032* EXEC CICS READ
 11033*       DATASET   (FILE-ID-ERMAIL)
 11034*       SET       (ADDRESS OF MAILING-DATA)
 11035*       RIDFLD    (ERMAIL-KEY)
 11036*       RESP      (WS-RESPONSE)
 11037*    END-EXEC
 11038*    MOVE '&"S        E          (  N#00010810' TO DFHEIV0
 11039     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11040     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11041     MOVE X'204E233030303130383130' TO DFHEIV0(25:11)
 11042     CALL 'kxdfhei1' USING DFHEIV0,
 11043           FILE-ID-ERMAIL,
 11044           DFHEIV20,
 11045           DFHEIV99,
 11046           ERMAIL-KEY,
 11047           DFHEIV99,
 11048           DFHEIV99,
 11049           DFHEIV99
 11050     SET ADDRESS OF MAILING-DATA TO
 11051         DFHEIV20
 11052     MOVE EIBRESP  TO WS-RESPONSE
 11053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11054     IF RESP-NORMAL
 11055        SET ERMAIL-FOUND TO TRUE
 11056     END-IF
 11057
 11058     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 203
* EL6311.cbl
 11059     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 11060     MOVE 'OC'                   TO OC-RECORD-ID
 11061     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11062                                 TO OC-CONTROL-PRIMARY (1:33)
 11063     MOVE 'I'                    TO OC-RECORD-TYPE
 11064     MOVE +4096                  TO OC-KEY-SEQ-NO
 11065     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 11066     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 11067     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 11068     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11069     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11070     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11071     MOVE PB-I-AGE               TO OC-INS-AGE
 11072     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 11073     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 11074     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11075     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 11076     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 11077     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 11078     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 11079     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 11080     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11081     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11082     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 11083     IF PB-I-JOINT-COMMISSION > +0
 11084         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 11085     ELSE
 11086         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 11087     END-IF
 11088     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 11089     MOVE +0                     TO OC-LF-CANCEL-AMT
 11090                                    OC-LF-ITD-CANCEL-AMT
 11091     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 11092     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 11093     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 11094     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 11095     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 11096     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 11097     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 11098     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 11099     MOVE +0                     TO OC-AH-CANCEL-AMT
 11100                                    OC-AH-ITD-CANCEL-AMT
 11101     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 11102     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 11103     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 11104     IF ERMAIL-FOUND
 11105        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 11106     END-IF
 11107     IF NOT CERT-TRL-REC-NOT-FOUND
 11108        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11109                           OC-INS-AGE-DEFAULT-FLAG
 11110        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11111                           OC-JNT-AGE-DEFAULT-FLAG
 11112     END-IF
 11113     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 11114     .
 11115 1275-WRITE-ELCRTO.
 11116
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 204
* EL6311.cbl
 11117* EXEC CICS WRITE
 11118*       DATASET   ('ELCRTO')
 11119*       FROM      (ORIGINAL-CERTIFICATE)
 11120*       RIDFLD    (OC-CONTROL-PRIMARY)
 11121*       RESP      (WS-RESPONSE)
 11122*    END-EXEC
 11123     MOVE LENGTH OF
 11124      ORIGINAL-CERTIFICATE
 11125       TO DFHEIV11
 11126     MOVE 'ELCRTO' TO DFHEIV1
 11127*    MOVE '&$ L                  ''  N#00010878' TO DFHEIV0
 11128     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11129     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11130     MOVE X'204E233030303130383738' TO DFHEIV0(25:11)
 11131     CALL 'kxdfhei1' USING DFHEIV0,
 11132           DFHEIV1,
 11133           ORIGINAL-CERTIFICATE,
 11134           DFHEIV11,
 11135           OC-CONTROL-PRIMARY,
 11136           DFHEIV99,
 11137           DFHEIV99
 11138     MOVE EIBRESP  TO WS-RESPONSE
 11139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11140*    display ' just wrote 1275 ' ws-response
 11141     IF RESP-DUPKEY
 11142        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 11143        GO TO 1275-WRITE-ELCRTO
 11144     ELSE
 11145        IF NOT RESP-NORMAL
 11146           MOVE -1               TO BMAINTL
 11147           MOVE ER-7450          TO EMI-ERROR
 11148           PERFORM 9900-ERROR-FORMAT
 11149                                 THRU 9900-EXIT
 11150           GO TO 8200-SEND-DATAONLY
 11151        END-IF
 11152     END-IF
 11153******************************************************************
 11154*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11155******************************************************************
 11156
 11157
 11158* EXEC CICS READ
 11159*        INTO    (PENDING-BUSINESS)
 11160*        DATASET (FILE-ID-ERPNDB)
 11161*        RIDFLD  (ERPNDB-KEY)
 11162*        UPDATE
 11163*    END-EXEC.
 11164     MOVE LENGTH OF
 11165      PENDING-BUSINESS
 11166       TO DFHEIV11
 11167*    MOVE '&"IL       EU         (   #00010901' TO DFHEIV0
 11168     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11169     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11170     MOVE X'2020233030303130393031' TO DFHEIV0(25:11)
 11171     CALL 'kxdfhei1' USING DFHEIV0,
 11172           FILE-ID-ERPNDB,
 11173           PENDING-BUSINESS,
 11174           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 205
* EL6311.cbl
 11175           ERPNDB-KEY,
 11176           DFHEIV99,
 11177           DFHEIV99,
 11178           DFHEIV99
 11179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11180
 11181
 11182     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11183     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11184     MOVE 'B'                    TO JP-RECORD-TYPE.
 11185     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11186
 11187     PERFORM 8400-LOG-JOURNAL-RECORD.
 11188
 11189     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 11190
 11191
 11192* EXEC CICS REWRITE
 11193*        DATASET (FILE-ID-ERPNDB)
 11194*        FROM    (PENDING-BUSINESS)
 11195*    END-EXEC.
 11196     MOVE LENGTH OF
 11197      PENDING-BUSINESS
 11198       TO DFHEIV11
 11199*    MOVE '&& L                  %   #00010917' TO DFHEIV0
 11200     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11201     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11202     MOVE X'2020233030303130393137' TO DFHEIV0(25:11)
 11203     CALL 'kxdfhei1' USING DFHEIV0,
 11204           FILE-ID-ERPNDB,
 11205           PENDING-BUSINESS,
 11206           DFHEIV11,
 11207           DFHEIV99
 11208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11209
 11210
 11211     MOVE 'C'                    TO JP-RECORD-TYPE.
 11212     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11213
 11214     PERFORM 8400-LOG-JOURNAL-RECORD.
 11215
 11216     IF WS-ERRORS-PRESENT
 11217         GO TO 3900-RE-DISPLAY-RECORD.
 11218
 11219     MOVE ZEROS                  TO EMI-ERROR.
 11220     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11221     MOVE LOW-VALUES             TO EL631BI.
 11222     MOVE  -1                    TO BMAINTL.
 11223     GO TO 8100-SEND-INITIAL-MAP.
 11224
 11225 1280-BATCH-HDR-NOT-FOUND.
 11226     MOVE -1                     TO BMAINTL.
 11227     MOVE ER-7450                TO EMI-ERROR.
 11228     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11229     GO TO 8200-SEND-DATAONLY.
 11230
 11231 1290-DUPLICATE-ALT-INDEX.
 11232
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 206
* EL6311.cbl
 11233******************************************************************
 11234*                                                                *
 11235*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11236*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11237*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11238*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11239*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11240*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11241*                                                                *
 11242******************************************************************
 11243
 11244     IF LCP-ONCTR-01 =  0
 11245         ADD 1 TO LCP-ONCTR-01
 11246        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11247
 11248     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11249
 11250     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11251         NEXT SENTENCE
 11252     ELSE
 11253         ADD +1 TO PB-BATCH-SEQ-NO
 11254                   PB-CSR-BATCH-SEQ-NO
 11255         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11256         GO TO 1275-WRITE-PENDING-BUSINESS.
 11257
 11258     MOVE -1                     TO BCERTNOL.
 11259     MOVE AL-UABON               TO BCERTNOA.
 11260     MOVE AL-UNBON               TO BEFFDTA.
 11261
 11262     MOVE 1                      TO EMI-SUB
 11263                                    EMI-SWITCH1
 11264                                    EMI-SWITCH-AREA-1
 11265                                    EMI-SWITCH-AREA-2.
 11266
 11267     MOVE SPACES                 TO EMI-ERROR-LINES.
 11268
 11269
 11270* EXEC CICS SYNCPOINT ROLLBACK
 11271*    END-EXEC.
 11272*    MOVE '6"R                   !   #00010980' TO DFHEIV0
 11273     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11274     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11275     MOVE X'2020233030303130393830' TO DFHEIV0(25:11)
 11276     CALL 'kxdfhei1' USING DFHEIV0
 11277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11278
 11279
 11280     MOVE ER-2247                TO EMI-ERROR.
 11281     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11282     GO TO 8200-SEND-DATAONLY.
 11283
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 207
* EL6311.cbl
 11285
 11286
 11287 1295-READ-CERT-TRAILER.
 11288
 11289
 11290* EXEC CICS GETMAIN
 11291*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11292*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11293*        INITIMG (GETMAIN-SPACE)
 11294*    END-EXEC
 11295*    MOVE ',"IL                  $   #00010992' TO DFHEIV0
 11296     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11297     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11298     MOVE X'2020233030303130393932' TO DFHEIV0(25:11)
 11299     CALL 'kxdfhei1' USING DFHEIV0,
 11300           DFHEIV20,
 11301           ELCRTT-RECORD-LENGTH,
 11302           GETMAIN-SPACE
 11303     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11304         DFHEIV20
 11305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11306
 11307     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11308     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11309     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11310
 11311
 11312* EXEC CICS HANDLE CONDITION
 11313*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11314*    END-EXEC.
 11315*    MOVE '"$I                   ! % #00011002' TO DFHEIV0
 11316     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11317     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11318     MOVE X'2520233030303131303032' TO DFHEIV0(25:11)
 11319     CALL 'kxdfhei1' USING DFHEIV0
 11320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11321
 11322
 11323
 11324* EXEC CICS READ
 11325*        DATASET  (CRTT-ID)
 11326*        RIDFLD   (ELCRTT-KEY)
 11327*        INTO     (CERTIFICATE-TRAILERS)
 11328*    END-EXEC.
 11329     MOVE LENGTH OF
 11330      CERTIFICATE-TRAILERS
 11331       TO DFHEIV11
 11332*    MOVE '&"IL       E          (   #00011006' TO DFHEIV0
 11333     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11334     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11335     MOVE X'2020233030303131303036' TO DFHEIV0(25:11)
 11336     CALL 'kxdfhei1' USING DFHEIV0,
 11337           CRTT-ID,
 11338           CERTIFICATE-TRAILERS,
 11339           DFHEIV11,
 11340           ELCRTT-KEY,
 11341           DFHEIV99,
 11342           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 208
* EL6311.cbl
 11343           DFHEIV99
 11344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11345
 11346
 11347     GO TO 1295-EXIT.
 11348
 11349 1295-CERT-TRL-REC-NOTFND.
 11350     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11351
 11352 1295-EXIT.
 11353     EXIT.
 11354
 11355******************************************************************
 11356*                                                                *
 11357*          C H A N G E   I S S U E   R O U T I N E               *
 11358*                                                                *
 11359******************************************************************
 11360
 11361***************************************************************
 11362*                                                             *
 11363*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11364*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11365*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11366*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11367*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11368*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11369*     5. LINK TO THE EDIT ROUTINE.                            *
 11370*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11371*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11372*              THE EDIT ROUTINE.                              *
 11373*     7. REWRITE THE NEW ISSUE                                *
 11374*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11375*                                                             *
 11376***************************************************************
 11377
 11378 1300-CHANGE-ISSUE-ROUTINE.
 11379     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11380
 11381     IF BCHGL NOT = ZEROS
 11382        MOVE ER-2196             TO EMI-ERROR
 11383        MOVE AL-UABON            TO BMAINTA
 11384        MOVE -1                  TO BMAINTL
 11385        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11386        GO TO 8200-SEND-DATAONLY.
 11387
 11388     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11389
 11390     IF BSUFIXL NOT = ZEROS
 11391        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11392     ELSE
 11393        MOVE SPACE               TO WS-NEW-SUFFIX.
 11394
 11395     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11396     PERFORM 8600-DEEDIT.
 11397     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11398     MOVE '4'                    TO DC-OPTION-CODE.
 11399     PERFORM 9700-DATE-LINK.
 11400     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 209
* EL6311.cbl
 11401        MOVE ER-0348             TO EMI-ERROR
 11402        MOVE -1                  TO BEFFDTL
 11403        MOVE AL-UABON            TO BEFFDTA
 11404        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11405        GO TO 8200-SEND-DATAONLY
 11406     ELSE
 11407        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11408        MOVE AL-UANON            TO BEFFDTA
 11409        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11410
 11411 1325-PROCESS-ISSUE-CHANGES.
 11412
 11413* EXEC CICS HANDLE CONDITION
 11414*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11415*    END-EXEC.
 11416*    MOVE '"$I                   ! & #00011077' TO DFHEIV0
 11417     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11418     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11419     MOVE X'2620233030303131303737' TO DFHEIV0(25:11)
 11420     CALL 'kxdfhei1' USING DFHEIV0
 11421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11422
 11423
 11424     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11425     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11426     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11427
 11428
 11429* EXEC CICS GETMAIN
 11430*        SET      (ADDRESS OF PENDING-BUSINESS)
 11431*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11432*        INITIMG  (GETMAIN-SPACE)
 11433*     END-EXEC.
 11434*    MOVE ',"IL                  $   #00011085' TO DFHEIV0
 11435     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11436     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11437     MOVE X'2020233030303131303835' TO DFHEIV0(25:11)
 11438     CALL 'kxdfhei1' USING DFHEIV0,
 11439           DFHEIV20,
 11440           ERPNDB-RECORD-LENGTH,
 11441           GETMAIN-SPACE
 11442     SET ADDRESS OF PENDING-BUSINESS TO
 11443         DFHEIV20
 11444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11445
 11446
 11447
 11448* EXEC CICS READ
 11449*        INTO    (PENDING-BUSINESS)
 11450*        DATASET (FILE-ID-ERPNDB)
 11451*        RIDFLD  (ERPNDB-KEY)
 11452*    END-EXEC.
 11453     MOVE LENGTH OF
 11454      PENDING-BUSINESS
 11455       TO DFHEIV11
 11456*    MOVE '&"IL       E          (   #00011091' TO DFHEIV0
 11457     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11458     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 210
* EL6311.cbl
 11459     MOVE X'2020233030303131303931' TO DFHEIV0(25:11)
 11460     CALL 'kxdfhei1' USING DFHEIV0,
 11461           FILE-ID-ERPNDB,
 11462           PENDING-BUSINESS,
 11463           DFHEIV11,
 11464           ERPNDB-KEY,
 11465           DFHEIV99,
 11466           DFHEIV99,
 11467           DFHEIV99
 11468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11469
 11470
 11471     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11472
 11473
 11474* EXEC CICS HANDLE CONDITION
 11475*         NOTFND     (1385-REC-NOT-FOUND)
 11476*    END-EXEC.
 11477*    MOVE '"$I                   ! '' #00011099' TO DFHEIV0
 11478     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11479     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11480     MOVE X'2720233030303131303939' TO DFHEIV0(25:11)
 11481     CALL 'kxdfhei1' USING DFHEIV0
 11482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11483
 11484
 11485**********************************************************
 11486*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11487*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11488**********************************************************
 11489
 11490
 11491* EXEC CICS READ
 11492*        DATASET (FILE-ID-ERPNDB)
 11493*        INTO    (PENDING-BUSINESS)
 11494*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11495*    END-EXEC.
 11496     MOVE LENGTH OF
 11497      PENDING-BUSINESS
 11498       TO DFHEIV11
 11499*    MOVE '&"IL       E          (   #00011108' TO DFHEIV0
 11500     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11501     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11502     MOVE X'2020233030303131313038' TO DFHEIV0(25:11)
 11503     CALL 'kxdfhei1' USING DFHEIV0,
 11504           FILE-ID-ERPNDB,
 11505           PENDING-BUSINESS,
 11506           DFHEIV11,
 11507           PI-PREV-CONTROL-PRIMARY,
 11508           DFHEIV99,
 11509           DFHEIV99,
 11510           DFHEIV99
 11511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11512
 11513
 11514********** DO NOT ALLOW CHANGES IF THRU A/R
 11515     IF BMAINTI = 'C'
 11516         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 211
* EL6311.cbl
 11517             MOVE ER-4005          TO EMI-ERROR
 11518             MOVE -1               TO BMAINTL
 11519             MOVE AL-UABON         TO BMAINTA
 11520             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11521             GO TO 8200-SEND-DATAONLY.
 11522**********
 11523
 11524     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11525        MOVE -1                 TO BMAINTL
 11526        MOVE ER-2197            TO EMI-ERROR
 11527        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11528        GO TO 8200-SEND-DATAONLY.
 11529
 11530     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11531        MOVE ER-2196             TO EMI-ERROR
 11532        MOVE AL-UABON            TO BMAINTA
 11533        MOVE -1                  TO BMAINTL
 11534        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11535        GO TO 8200-SEND-DATAONLY.
 11536
 11537     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11538
 11539     IF PB-BILLED-DT = LOW-VALUES AND
 11540        PB-CHG-COUNT = ZEROS
 11541        NEXT SENTENCE
 11542     ELSE
 11543        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11544            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11545           OR
 11546           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11547            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11548           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11549     move zeros                  to ws-check-amts
 11550     move ' '                    to ws-stop-sw
 11551                                    ws-check-sw
 11552                                    ws-proc-check-sw
 11553                                    ws-any-check-sw
 11554                                    ws-chek-browse-sw
 11555
 11556     perform 2500-browse-checks  thru 2500-exit
 11557
 11558     if i-have-processed-checks
 11559        or i-have-checks
 11560        continue
 11561     else
 11562        go to 1330-continue
 11563     end-if
 11564
 11565     compute ws-tot-orig-prem =
 11566        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11567        pb-i-lf-alt-premium-amt
 11568
 11569     if bprem1l <> zeros
 11570        MOVE AL-UNNON            TO bprem1a
 11571        move ws-bprem (1)        to ws-new-iss-total
 11572     else
 11573        move pb-i-lf-premium-amt to ws-new-iss-total
 11574     end-if
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 212
* EL6311.cbl
 11575     display ' new iss totala ' ws-new-iss-total
 11576
 11577     if baltpr1l <> zeros
 11578        MOVE AL-UNNON            TO baltpr1a
 11579        compute ws-new-iss-total =
 11580           ws-new-iss-total + ws-balt-prem(1)
 11581     else
 11582        compute ws-new-iss-total =
 11583           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11584     end-if
 11585
 11586     if bprem2l <> zeros
 11587        MOVE AL-UNNON            TO bprem2a
 11588        compute ws-new-iss-total = ws-new-iss-total +
 11589           ws-bprem (2)
 11590     else
 11591        compute ws-new-iss-total = ws-new-iss-total +
 11592           pb-i-ah-premium-amt
 11593     end-if
 11594
 11595     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11596        if ((bprem1l <> zeros)
 11597           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11598                      or
 11599           ((bprem2l <> zeros)
 11600           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11601           move er-3456          to emi-error
 11602           perform 9900-error-format
 11603                                 thru 9900-exit
 11604           go to 1330-continue
 11605        end-if
 11606     end-if
 11607
 11608     if ws-new-iss-total > ws-tot-orig-prem
 11609        move er-3458             to emi-error
 11610        perform 9900-error-format thru 9900-exit
 11611        move al-uabon            to bmainta
 11612        move -1                  to bmaintl
 11613        go to 8200-send-dataonly
 11614     end-if
 11615
 11616     if ws-new-iss-total < ws-tot-orig-prem
 11617        move er-3457             to emi-error
 11618        move al-uabon            to bprem1a
 11619                                    bprem2a
 11620        move +0 to bprem1l bprem2l
 11621        perform 9900-error-format thru 9900-exit
 11622        move -1                  to bmaintl
 11623        go to 1330-continue
 11624     end-if
 11625
 11626     .
 11627 1330-continue.
 11628
 11629
 11630* EXEC CICS READ
 11631*        DATASET (FILE-ID-ERPNDB)
 11632*        INTO    (PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 213
* EL6311.cbl
 11633*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11634*        UPDATE
 11635*    END-EXEC.
 11636     MOVE LENGTH OF
 11637      PENDING-BUSINESS
 11638       TO DFHEIV11
 11639*    MOVE '&"IL       EU         (   #00011229' TO DFHEIV0
 11640     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11641     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11642     MOVE X'2020233030303131323239' TO DFHEIV0(25:11)
 11643     CALL 'kxdfhei1' USING DFHEIV0,
 11644           FILE-ID-ERPNDB,
 11645           PENDING-BUSINESS,
 11646           DFHEIV11,
 11647           PI-PREV-CONTROL-PRIMARY,
 11648           DFHEIV99,
 11649           DFHEIV99,
 11650           DFHEIV99
 11651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11652
 11653
 11654     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11655     MOVE 'B'                    TO JP-RECORD-TYPE
 11656     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11657     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11658
 11659     PERFORM 8400-LOG-JOURNAL-RECORD.
 11660
 11661     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11662        PB-CHG-COUNT NOT = ZEROS
 11663        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11664            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11665           OR
 11666           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11667            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11668            MOVE LOW-VALUES             TO PB-BILLED-DT
 11669            ADD +1                      TO PB-CHG-COUNT.
 11670
 11671     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11672     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11673     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11674     MOVE '5'                    TO DC-OPTION-CODE.
 11675     PERFORM 9700-DATE-LINK
 11676     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11677
 11678*    IF BMICRNOL  GREATER  ZEROS
 11679*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11680
 11681     IF BVINL > ZEROS
 11682        MOVE BVINI               TO PB-I-VIN
 11683     END-IF
 11684     IF (BFORCEL NOT = ZEROS)
 11685        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11686        AND (BFORCEI = ' ')
 11687        AND (PB-FORCE-CODE = 'O')
 11688        COMPUTE PB-I-AH-PREMIUM-AMT =
 11689           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11690        PERFORM 1800-REMOVE-CERT-NOTES
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 214
* EL6311.cbl
 11691                                 THRU 1800-EXIT
 11692        PERFORM 1900-DELETE-ERPYAJ
 11693                                 THRU 1900-EXIT
 11694        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11695     END-IF
 11696     IF (BFORCEL NOT = ZEROS)
 11697        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11698        AND (BFORCEI = 'O')
 11699        AND (PB-FORCE-CODE NOT = 'O')
 11700        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11701           PB-I-AH-PREM-CALC
 11702        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11703        MOVE SPACE               TO DC-OPTION-CODE
 11704        PERFORM 9700-DATE-LINK
 11705        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11706        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11707        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11708        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11709        PERFORM 1500-UPDATE-ERNOTE
 11710                                 THRU 1500-EXIT
 11711        PERFORM 1600-UPDATE-ERPYAJ
 11712                                 THRU 1600-EXIT
 11713     END-IF
 11714     IF BLSTNML  GREATER THAN ZEROS
 11715         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11716
 11717     IF B1STNML  GREATER THAN ZEROS
 11718         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11719
 11720     IF BINITL   GREATER THAN ZEROS
 11721         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11722
 11723     IF BBIRTHL  GREATER THAN ZERO
 11724         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11725
 11726     IF B1STPMTL GREATER THAN ZERO
 11727         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11728
 11729     IF BAGEL    GREATER THAN ZEROS
 11730         MOVE BAGEI              TO PB-I-AGE.
 11731
 11732     MOVE 'N'                    TO WS-INS-AGE-SET
 11733                                    WS-JNT-AGE-SET.
 11734     IF BAGEL    GREATER THAN ZEROS
 11735        MOVE 'Y'                TO WS-INS-AGE-SET
 11736        IF BAGEI = ZERO AND
 11737             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11738           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11739           MOVE 'AGE*'          TO BAGEDEFO
 11740        ELSE
 11741           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11742           MOVE 'AGE '          TO BAGEDEFO
 11743        END-IF
 11744        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11745     END-IF.
 11746
 11747     IF BSEXL    GREATER THAN ZEROS
 11748         MOVE BSEXI              TO PB-I-INSURED-SEX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 215
* EL6311.cbl
 11749
 11750     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11751        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11752
 11753     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11754        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11755
 11756     IF BLNTRML  GREATER THAN ZEROS
 11757         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11758
 11759     IF BFREQL   GREATER THAN ZEROS
 11760         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11761
 11762     IF BSKPCDL  GREATER THAN ZEROS
 11763         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11764
 11765     IF BMODEL   GREATER THAN ZEROS
 11766         MOVE BMODEI             TO PB-I-TERM-TYPE
 11767                                    PI-BMODE.
 11768
 11769     IF BPMTSL   GREATER THAN ZEROS
 11770         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11771                                    PI-BPMTS.
 11772
 11773     IF BPMTAMTL GREATER THAN ZEROS
 11774         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11775
 11776     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11777         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11778
 11779     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11780         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11781
 11782     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11783
 11784     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11785         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11786            SUBTRACT PB-I-LF-PREMIUM-AMT
 11787                     FROM WS-B-LF-ISS-PRM-ENTERED
 11788            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11789            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11790            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11791         ELSE
 11792            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11793*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11794*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11795         END-IF
 11796     END-IF.
 11797
 11798     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11799            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11800                     FROM WS-B-LF-ISS-PRM-ENTERED
 11801         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11802         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11803
 11804     IF  BALT-PREM-LEN     (2)  > ZEROS
 11805         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11806
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 216
* EL6311.cbl
 11807     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11808         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11809
 11810     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11811         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11812            SUBTRACT PB-I-AH-PREMIUM-AMT
 11813                     FROM WS-B-AH-ISS-PRM-ENTERED
 11814            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11815            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11816            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11817         ELSE
 11818            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11819*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11820*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11821         END-IF
 11822     END-IF
 11823
 11824     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11825        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11826
 11827     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11828        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11829
 11830     IF BINDGRPL            GREATER THAN ZEROS
 11831         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11832
 11833     IF BRTCLSL             GREATER THAN ZEROS
 11834         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11835
 11836     IF BSIGL               GREATER THAN ZEROS
 11837         MOVE BSIGI              TO PB-I-SIG-SW.
 11838
 11839     IF BAPRL               GREATER THAN ZEROS
 11840         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11841
 11842     IF BMEMBERL            GREATER THAN ZEROS
 11843         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11844
 11845     IF BLNOFCRL            GREATER THAN ZEROS
 11846         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11847
 11848     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11849        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11850
 11851     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11852        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11853
 11854     IF BDAYSL              GREATER THAN ZEROS
 11855        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11856                                    PB-I-EXTENTION-DAYS.
 11857
 11858     IF BDAYSL GREATER THAN ZEROS
 11859        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11860
 11861     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11862        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11863           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11864
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 217
* EL6311.cbl
 11865     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11866        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11867           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11868
 11869     IF B1STPMTL GREATER THAN ZEROS
 11870        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11871
 11872     IF PB-EXT-DAYS-PROCESSING
 11873        IF PB-I-EXTENTION-DAYS = ZEROS
 11874           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11875
 11876     IF PB-EXPIRE-DT-PROCESSING
 11877        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11878           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11879             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11880
 11881     IF PB-1ST-PMT-DT-PROCESSING
 11882        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11883           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11884
 11885     IF BREINL GREATER THAN ZEROS
 11886        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11887
 11888     IF BFORCEL NOT = ZEROS
 11889        MOVE BFORCEI             TO PB-FORCE-CODE.
 11890     IF (BENTRYL NOT = ZEROS)
 11891        AND (PB-COMPANY-ID = 'CID')
 11892        AND (PB-STATE = 'VA')
 11893        AND (BENTRYI NOT = 'P')
 11894        AND (PB-BATCH-ENTRY = 'P')
 11895        PERFORM 1800-REMOVE-CERT-NOTES
 11896                                 THRU 1800-EXIT
 11897     END-IF
 11898     IF BENTRYL NOT = ZEROS
 11899        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11900        IF PI-COMPANY-ID = 'CID'
 11901           AND (PB-BATCH-ENTRY = 'P')
 11902           AND (PB-STATE = 'VA')
 11903           PERFORM 1500-UPDATE-ERNOTE
 11904                                 THRU 1500-EXIT
 11905        END-IF
 11906     END-IF
 11907
 11908     IF BUNWRITL NOT = ZEROS
 11909        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11910
 11911     IF BBILCDL NOT = ZEROS
 11912        MOVE BBILCDI             TO PB-RECORD-BILL.
 11913
 11914     IF BLIVESL GREATER THAN ZEROS
 11915        MOVE WS-BLIVES           TO PB-I-LIVES.
 11916
 11917
 11918*DMD CUSTOM CODING*************START
 11919     IF PI-COMPANY-ID NOT = 'DMD'
 11920         MOVE ZEROS               TO BBILLEDL.
 11921*DMD CUSTOM CODING*************END
 11922
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 218
* EL6311.cbl
 11923     IF BBILLEDL GREATER THAN ZEROS
 11924        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11925
 11926
 11927*****************************************************************
 11928*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11929*****************************************************************
 11930
 11931     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11932        IF BTYPE  (1)   = ZEROS OR SPACES
 11933           IF REMOVE-LF-COVERAGE
 11934               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11935                                        PI-BTYPE (1)
 11936               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11937                                        WS-B-LF-ISS-PRM-ENTERED
 11938               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11939                                        WS-B-LF-ISS-PRM-ENTERED
 11940               SUBTRACT PB-I-LF-PREM-CALC FROM
 11941                                        WS-B-LF-ISS-PRM-COMPUTED
 11942               MOVE ZEROS            TO PB-I-LF-TERM
 11943                                        PB-I-LF-BENEFIT-AMT
 11944                                        PB-I-LF-PREMIUM-AMT
 11945                                        PB-I-LF-BENEFIT-CD
 11946                                        PB-I-LF-PREM-CALC
 11947                                        PB-I-LF-CRIT-PER
 11948                                        PB-I-LF-ALT-BENEFIT-AMT
 11949                                        PB-I-LF-ALT-PREMIUM-AMT
 11950               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11951           ELSE
 11952               NEXT SENTENCE
 11953        ELSE
 11954           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11955                                    PI-BTYPE (1).
 11956     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11957        IF BTYPE  (2)   = ZEROS OR SPACES
 11958           IF  REMOVE-AH-COVERAGE
 11959               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11960                                        PI-BTYPE (2)
 11961               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11962                                        WS-B-AH-ISS-PRM-ENTERED
 11963               SUBTRACT PB-I-AH-PREM-CALC FROM
 11964                                        WS-B-AH-ISS-PRM-COMPUTED
 11965               MOVE ZEROS            TO PB-I-AH-TERM
 11966                                        PB-I-AH-BENEFIT-AMT
 11967                                        PB-I-AH-PREMIUM-AMT
 11968                                        PB-I-AH-BENEFIT-CD
 11969                                        PB-I-AH-PREM-CALC
 11970                                        PB-I-AH-CRIT-PER
 11971               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11972           ELSE
 11973               NEXT SENTENCE
 11974        ELSE
 11975           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11976                                    PI-BTYPE (2).
 11977 1360-REWRITE-PB-RECORD.
 11978     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11979
 11980     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 219
* EL6311.cbl
 11981     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11982
 11983     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11984
 11985     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11986     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11987
 11988     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11989         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11990
 11991     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11992         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11993
 11994     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11995
 11996     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11997
 11998     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11999
 12000     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 12001     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 12002     MOVE PB-SV-STATE            TO PI-SV-STATE.
 12003
 12004     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 12005     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 12006
 12007 1375-REWRITE-PB-RECORD.
 12008     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12009     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 12010     MOVE 'C'                    TO JP-RECORD-TYPE.
 12011     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12012
 12013
 12014* EXEC CICS REWRITE
 12015*        DATASET (FILE-ID-ERPNDB)
 12016*        FROM    (PENDING-BUSINESS)
 12017*    END-EXEC.
 12018     MOVE LENGTH OF
 12019      PENDING-BUSINESS
 12020       TO DFHEIV11
 12021*    MOVE '&& L                  %   #00011595' TO DFHEIV0
 12022     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12023     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12024     MOVE X'2020233030303131353935' TO DFHEIV0(25:11)
 12025     CALL 'kxdfhei1' USING DFHEIV0,
 12026           FILE-ID-ERPNDB,
 12027           PENDING-BUSINESS,
 12028           DFHEIV11,
 12029           DFHEIV99
 12030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12031
 12032
 12033     PERFORM 8400-LOG-JOURNAL-RECORD.
 12034******************************************************************
 12035*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 12036******************************************************************
 12037     MOVE ELCERT-KEY             TO ERMAIL-KEY
 12038     MOVE ' '                    TO WS-ERMAIL-SW
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 220
* EL6311.cbl
 12039
 12040* EXEC CICS READ
 12041*       DATASET   (FILE-ID-ERMAIL)
 12042*       SET       (ADDRESS OF MAILING-DATA)
 12043*       RIDFLD    (ERMAIL-KEY)
 12044*       RESP      (WS-RESPONSE)
 12045*    END-EXEC
 12046*    MOVE '&"S        E          (  N#00011606' TO DFHEIV0
 12047     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12048     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12049     MOVE X'204E233030303131363036' TO DFHEIV0(25:11)
 12050     CALL 'kxdfhei1' USING DFHEIV0,
 12051           FILE-ID-ERMAIL,
 12052           DFHEIV20,
 12053           DFHEIV99,
 12054           ERMAIL-KEY,
 12055           DFHEIV99,
 12056           DFHEIV99,
 12057           DFHEIV99
 12058     SET ADDRESS OF MAILING-DATA TO
 12059         DFHEIV20
 12060     MOVE EIBRESP  TO WS-RESPONSE
 12061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12062     IF RESP-NORMAL
 12063        SET ERMAIL-FOUND TO TRUE
 12064     END-IF
 12065
 12066     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 12067     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12068                                 TO ELCRTO-KEY
 12069     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12070     MOVE +0                     TO ELCRTO-SEQ-NO
 12071
 12072* EXEC CICS READ
 12073*       DATASET   ('ELCRTO')
 12074*       INTO      (ORIGINAL-CERTIFICATE)
 12075*       RIDFLD    (ELCRTO-KEY)
 12076*       GTEQ
 12077*       RESP      (WS-RESPONSE)
 12078*    END-EXEC
 12079     MOVE LENGTH OF
 12080      ORIGINAL-CERTIFICATE
 12081       TO DFHEIV11
 12082     MOVE 'ELCRTO' TO DFHEIV1
 12083*    MOVE '&"IL       G          (  N#00011621' TO DFHEIV0
 12084     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12085     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12086     MOVE X'204E233030303131363231' TO DFHEIV0(25:11)
 12087     CALL 'kxdfhei1' USING DFHEIV0,
 12088           DFHEIV1,
 12089           ORIGINAL-CERTIFICATE,
 12090           DFHEIV11,
 12091           ELCRTO-KEY,
 12092           DFHEIV99,
 12093           DFHEIV99,
 12094           DFHEIV99
 12095     MOVE EIBRESP  TO WS-RESPONSE
 12096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 221
* EL6311.cbl
 12097*    display ' just read gteq ' ws-response
 12098     IF RESP-NORMAL
 12099        AND (OC-CONTROL-PRIMARY (1:33) =
 12100                 PB-CONTROL-BY-ACCOUNT (1:33))
 12101        AND (OC-RECORD-TYPE = 'I')
 12102        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 12103           display ' csr edit session ' PI-CSR-SESSION-SW
 12104           IF NOT CSR-EDIT-SESSION
 12105
 12106* EXEC CICS READ
 12107*                DATASET   ('ELCRTO')
 12108*                INTO      (ORIGINAL-CERTIFICATE)
 12109*                RIDFLD    (OC-CONTROL-PRIMARY)
 12110*                UPDATE
 12111*                RESP      (WS-RESPONSE)
 12112*             END-EXEC
 12113     MOVE LENGTH OF
 12114      ORIGINAL-CERTIFICATE
 12115       TO DFHEIV11
 12116     MOVE 'ELCRTO' TO DFHEIV1
 12117*    MOVE '&"IL       EU         (  N#00011638' TO DFHEIV0
 12118     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12119     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12120     MOVE X'204E233030303131363338' TO DFHEIV0(25:11)
 12121     CALL 'kxdfhei1' USING DFHEIV0,
 12122           DFHEIV1,
 12123           ORIGINAL-CERTIFICATE,
 12124           DFHEIV11,
 12125           OC-CONTROL-PRIMARY,
 12126           DFHEIV99,
 12127           DFHEIV99,
 12128           DFHEIV99
 12129     MOVE EIBRESP  TO WS-RESPONSE
 12130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12131              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 12132              IF RESP-NORMAL
 12133                 display ' good read upd '
 12134                 MOVE PB-I-INSURED-LAST-NAME TO
 12135                         OC-INS-LAST-NAME
 12136                 MOVE PB-I-INSURED-FIRST-NAME TO
 12137                         OC-INS-FIRST-NAME
 12138                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 12139                         OC-INS-MIDDLE-INIT
 12140                 MOVE PB-I-AGE         TO OC-INS-AGE
 12141                 MOVE PB-I-JOINT-LAST-NAME   TO
 12142                         OC-JNT-LAST-NAME
 12143                 MOVE PB-I-JOINT-FIRST-NAME  TO
 12144                         OC-JNT-FIRST-NAME
 12145                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 12146                         OC-JNT-MIDDLE-INIT
 12147                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12148                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12149                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12150                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12151                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12152                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 12153                         OC-LF-ALT-BEN-AMT
 12154                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 222
* EL6311.cbl
 12155                         OC-LF-ALT-PRM-AMT
 12156                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12157                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12158                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12159                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12160                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12161                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12162                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12163                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12164                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12165                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12166                 IF OC-CANCEL-TRAN-IND = 'N'
 12167                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 12168                    MOVE +0            TO OC-LF-CANCEL-AMT
 12169                                          OC-LF-ITD-CANCEL-AMT
 12170                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 12171                    MOVE +0            TO OC-AH-CANCEL-AMT
 12172                                          OC-AH-ITD-CANCEL-AMT
 12173                 END-IF
 12174                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12175                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12176                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12177                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12178                 IF ERMAIL-FOUND
 12179                    MOVE MA-CRED-BENE-NAME
 12180                                 TO OC-CRED-BENE-NAME
 12181                 END-IF
 12182                 IF NOT CERT-TRL-REC-NOT-FOUND
 12183                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12184                           OC-INS-AGE-DEFAULT-FLAG
 12185                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12186                           OC-JNT-AGE-DEFAULT-FLAG
 12187                 END-IF
 12188
 12189* EXEC CICS REWRITE
 12190*                   DATASET   ('ELCRTO')
 12191*                   FROM      (ORIGINAL-CERTIFICATE)
 12192*                   RESP      (WS-RESPONSE)
 12193*                END-EXEC
 12194     MOVE LENGTH OF
 12195      ORIGINAL-CERTIFICATE
 12196       TO DFHEIV11
 12197     MOVE 'ELCRTO' TO DFHEIV1
 12198*    MOVE '&& L                  %  N#00011702' TO DFHEIV0
 12199     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12200     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12201     MOVE X'204E233030303131373032' TO DFHEIV0(25:11)
 12202     CALL 'kxdfhei1' USING DFHEIV0,
 12203           DFHEIV1,
 12204           ORIGINAL-CERTIFICATE,
 12205           DFHEIV11,
 12206           DFHEIV99
 12207     MOVE EIBRESP  TO WS-RESPONSE
 12208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12209                 display ' just rewrote ' ws-response
 12210              END-IF
 12211           END-IF
 12212        ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 223
* EL6311.cbl
 12213           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12214           MOVE 'OC'             TO OC-RECORD-ID
 12215           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12216           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12217           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12218           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12219           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12220           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12221           MOVE PB-I-AGE         TO OC-INS-AGE
 12222           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12223           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12224           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12225           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12226           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12227           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12228           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12229           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12230           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12231           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12232           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12233           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12234           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12235           MOVE +0               TO OC-LF-CANCEL-AMT
 12236                                    OC-LF-ITD-CANCEL-AMT
 12237           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12238           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12239           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12240           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12241           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12242           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12243           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12244           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12245           MOVE +0               TO OC-AH-CANCEL-AMT
 12246                                    OC-AH-ITD-CANCEL-AMT
 12247           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12248           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12249           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12250           IF ERMAIL-FOUND
 12251              MOVE MA-CRED-BENE-NAME
 12252                                 TO OC-CRED-BENE-NAME
 12253           END-IF
 12254           IF NOT CERT-TRL-REC-NOT-FOUND
 12255              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12256                           OC-INS-AGE-DEFAULT-FLAG
 12257              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12258                           OC-JNT-AGE-DEFAULT-FLAG
 12259           END-IF
 12260           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12261
 12262* EXEC CICS WRITE
 12263*             DATASET   ('ELCRTO')
 12264*             FROM      (ORIGINAL-CERTIFICATE)
 12265*             RIDFLD    (OC-CONTROL-PRIMARY)
 12266*             RESP      (WS-RESPONSE)
 12267*          END-EXEC
 12268     MOVE LENGTH OF
 12269      ORIGINAL-CERTIFICATE
 12270       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 224
* EL6311.cbl
 12271     MOVE 'ELCRTO' TO DFHEIV1
 12272*    MOVE '&$ L                  ''  N#00011759' TO DFHEIV0
 12273     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12274     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12275     MOVE X'204E233030303131373539' TO DFHEIV0(25:11)
 12276     CALL 'kxdfhei1' USING DFHEIV0,
 12277           DFHEIV1,
 12278           ORIGINAL-CERTIFICATE,
 12279           DFHEIV11,
 12280           OC-CONTROL-PRIMARY,
 12281           DFHEIV99,
 12282           DFHEIV99
 12283     MOVE EIBRESP  TO WS-RESPONSE
 12284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12285        END-IF
 12286     ELSE
 12287        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12288        MOVE 'OC'                TO OC-RECORD-ID
 12289        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12290                                 TO OC-CONTROL-PRIMARY (1:33)
 12291        MOVE 'I'                 TO OC-RECORD-TYPE
 12292        MOVE +4096               TO OC-KEY-SEQ-NO
 12293        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12294        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12295        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12296        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12297        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12298        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12299        MOVE PB-I-AGE            TO OC-INS-AGE
 12300        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12301        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12302        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12303        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12304        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12305        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12306        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12307        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12308        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12309        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12310        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12311        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12312        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 12313        MOVE +0                  TO OC-LF-CANCEL-AMT
 12314                                    OC-LF-ITD-CANCEL-AMT
 12315        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12316        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12317        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12318        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12319        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12320        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12321        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12322        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12323        MOVE +0                  TO OC-AH-CANCEL-AMT
 12324                                    OC-AH-ITD-CANCEL-AMT
 12325        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12326        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12327        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12328        IF ERMAIL-FOUND
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 225
* EL6311.cbl
 12329           MOVE MA-CRED-BENE-NAME
 12330                                 TO OC-CRED-BENE-NAME
 12331        END-IF
 12332        IF NOT CERT-TRL-REC-NOT-FOUND
 12333           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12334                           OC-INS-AGE-DEFAULT-FLAG
 12335           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12336                           OC-JNT-AGE-DEFAULT-FLAG
 12337        END-IF
 12338        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12339
 12340* EXEC CICS WRITE
 12341*          DATASET   ('ELCRTO')
 12342*          FROM      (ORIGINAL-CERTIFICATE)
 12343*          RIDFLD    (OC-CONTROL-PRIMARY)
 12344*          RESP      (WS-RESPONSE)
 12345*       END-EXEC
 12346     MOVE LENGTH OF
 12347      ORIGINAL-CERTIFICATE
 12348       TO DFHEIV11
 12349     MOVE 'ELCRTO' TO DFHEIV1
 12350*    MOVE '&$ L                  ''  N#00011819' TO DFHEIV0
 12351     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12352     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12353     MOVE X'204E233030303131383139' TO DFHEIV0(25:11)
 12354     CALL 'kxdfhei1' USING DFHEIV0,
 12355           DFHEIV1,
 12356           ORIGINAL-CERTIFICATE,
 12357           DFHEIV11,
 12358           OC-CONTROL-PRIMARY,
 12359           DFHEIV99,
 12360           DFHEIV99
 12361     MOVE EIBRESP  TO WS-RESPONSE
 12362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12363     END-IF
 12364******************************************************************
 12365*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12366******************************************************************
 12367
 12368     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12369     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12370
 12371
 12372* EXEC CICS READ
 12373*        INTO    (PENDING-BUSINESS)
 12374*        DATASET (FILE-ID-ERPNDB)
 12375*        RIDFLD  (ERPNDB-KEY)
 12376*        UPDATE
 12377*    END-EXEC.
 12378     MOVE LENGTH OF
 12379      PENDING-BUSINESS
 12380       TO DFHEIV11
 12381*    MOVE '&"IL       EU         (   #00011833' TO DFHEIV0
 12382     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12383     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12384     MOVE X'2020233030303131383333' TO DFHEIV0(25:11)
 12385     CALL 'kxdfhei1' USING DFHEIV0,
 12386           FILE-ID-ERPNDB,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 226
* EL6311.cbl
 12387           PENDING-BUSINESS,
 12388           DFHEIV11,
 12389           ERPNDB-KEY,
 12390           DFHEIV99,
 12391           DFHEIV99,
 12392           DFHEIV99
 12393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12394
 12395
 12396     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12397     MOVE 'B'                    TO JP-RECORD-TYPE.
 12398     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12399
 12400     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12401
 12402     PERFORM 8400-LOG-JOURNAL-RECORD.
 12403
 12404     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12405
 12406     MOVE 'C'                    TO JP-RECORD-TYPE.
 12407     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12408
 12409
 12410* EXEC CICS REWRITE
 12411*        DATASET    (FILE-ID-ERPNDB)
 12412*        FROM       (PENDING-BUSINESS)
 12413*    END-EXEC.
 12414     MOVE LENGTH OF
 12415      PENDING-BUSINESS
 12416       TO DFHEIV11
 12417*    MOVE '&& L                  %   #00011853' TO DFHEIV0
 12418     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12419     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12420     MOVE X'2020233030303131383533' TO DFHEIV0(25:11)
 12421     CALL 'kxdfhei1' USING DFHEIV0,
 12422           FILE-ID-ERPNDB,
 12423           PENDING-BUSINESS,
 12424           DFHEIV11,
 12425           DFHEIV99
 12426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12427
 12428
 12429     PERFORM 8400-LOG-JOURNAL-RECORD.
 12430
 12431     IF WS-ERRORS-PRESENT
 12432        GO TO 3900-RE-DISPLAY-RECORD.
 12433
 12434     MOVE ZEROS                  TO EMI-ERROR.
 12435     MOVE -1                     TO BMAINTL.
 12436     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12437     GO TO 3900-RE-DISPLAY-RECORD.
 12438
 12439 1380-BATCH-HDR-NOT-FOUND.
 12440     MOVE -1                     TO BMAINTL.
 12441     MOVE ER-7450                TO EMI-ERROR.
 12442     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12443     GO TO 8200-SEND-DATAONLY.
 12444
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 227
* EL6311.cbl
 12445 1385-REC-NOT-FOUND.
 12446     MOVE -1                     TO BMAINTL.
 12447     MOVE ER-7451                TO EMI-ERROR.
 12448     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12449     GO TO 8200-SEND-DATAONLY.
 12450
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 228
* EL6311.cbl
 12452
 12453 1386-UPDATE-AGE-FLAGS.
 12454
 12455
 12456* EXEC CICS GETMAIN
 12457*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12458*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12459*        INITIMG (GETMAIN-SPACE)
 12460*    END-EXEC
 12461*    MOVE ',"IL                  $   #00011884' TO DFHEIV0
 12462     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12463     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12464     MOVE X'2020233030303131383834' TO DFHEIV0(25:11)
 12465     CALL 'kxdfhei1' USING DFHEIV0,
 12466           DFHEIV20,
 12467           ELCRTT-RECORD-LENGTH,
 12468           GETMAIN-SPACE
 12469     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12470         DFHEIV20
 12471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12472
 12473
 12474* EXEC CICS HANDLE CONDITION
 12475*        NOTFND   (1386-NOTFND)
 12476*    END-EXEC.
 12477*    MOVE '"$I                   ! ( #00011890' TO DFHEIV0
 12478     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12479     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12480     MOVE X'2820233030303131383930' TO DFHEIV0(25:11)
 12481     CALL 'kxdfhei1' USING DFHEIV0
 12482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12483
 12484
 12485     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12486     MOVE 'C'                TO ELCRTT-REC-TYPE
 12487
 12488
 12489* EXEC CICS READ
 12490*        UPDATE
 12491*        DATASET  (CRTT-ID)
 12492*        RIDFLD   (ELCRTT-KEY)
 12493*        INTO     (CERTIFICATE-TRAILERS)
 12494*    END-EXEC.
 12495     MOVE LENGTH OF
 12496      CERTIFICATE-TRAILERS
 12497       TO DFHEIV11
 12498*    MOVE '&"IL       EU         (   #00011897' TO DFHEIV0
 12499     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12500     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12501     MOVE X'2020233030303131383937' TO DFHEIV0(25:11)
 12502     CALL 'kxdfhei1' USING DFHEIV0,
 12503           CRTT-ID,
 12504           CERTIFICATE-TRAILERS,
 12505           DFHEIV11,
 12506           ELCRTT-KEY,
 12507           DFHEIV99,
 12508           DFHEIV99,
 12509           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 229
* EL6311.cbl
 12510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12511
 12512
 12513     IF WS-INS-AGE-SET = 'Y'
 12514        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12515     END-IF
 12516     IF WS-JNT-AGE-SET = 'Y'
 12517        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12518     END-IF
 12519
 12520
 12521* EXEC CICS REWRITE
 12522*       DATASET  (CRTT-ID)
 12523*       FROM     (CERTIFICATE-TRAILERS)
 12524*    END-EXEC.
 12525     MOVE LENGTH OF
 12526      CERTIFICATE-TRAILERS
 12527       TO DFHEIV11
 12528*    MOVE '&& L                  %   #00011911' TO DFHEIV0
 12529     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12530     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12531     MOVE X'2020233030303131393131' TO DFHEIV0(25:11)
 12532     CALL 'kxdfhei1' USING DFHEIV0,
 12533           CRTT-ID,
 12534           CERTIFICATE-TRAILERS,
 12535           DFHEIV11,
 12536           DFHEIV99
 12537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12538
 12539
 12540     GO TO 1386-EXIT.
 12541
 12542 1386-NOTFND.
 12543
 12544     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12545     MOVE 'CS'         TO CS-RECORD-ID.
 12546     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12547     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12548     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12549     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12550     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12551
 12552* EXEC CICS WRITE
 12553*       DATASET  (CRTT-ID)
 12554*       RIDFLD   (ELCRTT-KEY)
 12555*       FROM     (CERTIFICATE-TRAILERS)
 12556*    END-EXEC.
 12557     MOVE LENGTH OF
 12558      CERTIFICATE-TRAILERS
 12559       TO DFHEIV11
 12560*    MOVE '&$ L                  ''   #00011927' TO DFHEIV0
 12561     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12562     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12563     MOVE X'2020233030303131393237' TO DFHEIV0(25:11)
 12564     CALL 'kxdfhei1' USING DFHEIV0,
 12565           CRTT-ID,
 12566           CERTIFICATE-TRAILERS,
 12567           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 230
* EL6311.cbl
 12568           ELCRTT-KEY,
 12569           DFHEIV99,
 12570           DFHEIV99
 12571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12572
 12573
 12574 1386-EXIT.
 12575     EXIT.
 12576
 12577 1390-UPDATE-ERPNDM.
 12578
 12579
 12580* EXEC CICS HANDLE CONDITION
 12581*        NOTFND (1399-EXIT)
 12582*    END-EXEC.
 12583*    MOVE '"$I                   ! ) #00011938' TO DFHEIV0
 12584     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12585     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12586     MOVE X'2920233030303131393338' TO DFHEIV0(25:11)
 12587     CALL 'kxdfhei1' USING DFHEIV0
 12588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12589
 12590
 12591     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12592
 12593
 12594* EXEC CICS READ
 12595*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12596*        DATASET (FILE-ID-ERPNDM)
 12597*        RIDFLD  (ERPNDM-KEY)
 12598*        UPDATE
 12599*    END-EXEC.
 12600*    MOVE '&"S        EU         (   #00011944' TO DFHEIV0
 12601     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12602     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12603     MOVE X'2020233030303131393434' TO DFHEIV0(25:11)
 12604     CALL 'kxdfhei1' USING DFHEIV0,
 12605           FILE-ID-ERPNDM,
 12606           DFHEIV20,
 12607           DFHEIV99,
 12608           ERPNDM-KEY,
 12609           DFHEIV99,
 12610           DFHEIV99,
 12611           DFHEIV99
 12612     SET ADDRESS OF PENDING-MAILING-DATA TO
 12613         DFHEIV20
 12614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12615
 12616
 12617     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12618     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12619     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12620
 12621     IF BLSTNML GREATER THAN ZEROS
 12622         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12623
 12624     IF B1STNML GREATER  THAN ZEROS
 12625         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 231
* EL6311.cbl
 12626
 12627     IF BINITL GREATER THAN ZEROS
 12628         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12629
 12630     IF BAGEL GREATER THAN ZEROS
 12631         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12632
 12633     IF BBIRTHL GREATER THAN ZEROS
 12634         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12635
 12636     IF BSEXL GREATER THAN ZEROS
 12637         MOVE  BSEXI             TO PM-INSURED-SEX.
 12638
 12639
 12640* EXEC CICS REWRITE
 12641*        DATASET (FILE-ID-ERPNDM)
 12642*        FROM    (PENDING-MAILING-DATA)
 12643*    END-EXEC.
 12644     MOVE LENGTH OF
 12645      PENDING-MAILING-DATA
 12646       TO DFHEIV11
 12647*    MOVE '&& L                  %   #00011973' TO DFHEIV0
 12648     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12649     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12650     MOVE X'2020233030303131393733' TO DFHEIV0(25:11)
 12651     CALL 'kxdfhei1' USING DFHEIV0,
 12652           FILE-ID-ERPNDM,
 12653           PENDING-MAILING-DATA,
 12654           DFHEIV11,
 12655           DFHEIV99
 12656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12657
 12658
 12659 1399-EXIT.
 12660     EXIT.
 12661
 12662******************************************************************
 12663*                                                                *
 12664*          D E L E T E   I S S U E   R O U T I N E               *
 12665*                                                                *
 12666******************************************************************
 12667
 12668 1400-DELETE-ISSUE-ROUTINE.
 12669     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12670
 12671     IF BCHGL NOT = ZEROS
 12672        MOVE ER-2196             TO EMI-ERROR
 12673        MOVE AL-UABON            TO BMAINTA
 12674        MOVE -1                  TO BMAINTL
 12675        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12676        GO TO 8200-SEND-DATAONLY.
 12677
 12678
 12679* EXEC CICS HANDLE CONDITION
 12680*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12681*    END-EXEC.
 12682*    MOVE '"$I                   ! * #00011997' TO DFHEIV0
 12683     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 232
* EL6311.cbl
 12684     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12685     MOVE X'2A20233030303131393937' TO DFHEIV0(25:11)
 12686     CALL 'kxdfhei1' USING DFHEIV0
 12687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12688
 12689
 12690     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12691     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12692     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12693
 12694
 12695* EXEC CICS READ
 12696*        SET     (ADDRESS OF PENDING-BUSINESS)
 12697*        DATASET (FILE-ID-ERPNDB)
 12698*        RIDFLD  (ERPNDB-KEY)
 12699*    END-EXEC.
 12700*    MOVE '&"S        E          (   #00012005' TO DFHEIV0
 12701     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12702     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12703     MOVE X'2020233030303132303035' TO DFHEIV0(25:11)
 12704     CALL 'kxdfhei1' USING DFHEIV0,
 12705           FILE-ID-ERPNDB,
 12706           DFHEIV20,
 12707           DFHEIV99,
 12708           ERPNDB-KEY,
 12709           DFHEIV99,
 12710           DFHEIV99,
 12711           DFHEIV99
 12712     SET ADDRESS OF PENDING-BUSINESS TO
 12713         DFHEIV20
 12714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12715
 12716
 12717     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12718
 12719     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12720
 12721     IF BSUFIXL NOT = ZEROS
 12722        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12723     ELSE
 12724        MOVE SPACE               TO WS-NEW-SUFFIX.
 12725
 12726     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12727     PERFORM 8600-DEEDIT.
 12728     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12729     MOVE '4'                    TO DC-OPTION-CODE.
 12730     PERFORM 9700-DATE-LINK.
 12731     IF DATE-CONVERSION-ERROR
 12732        MOVE ER-0348             TO EMI-ERROR
 12733        MOVE -1                  TO BEFFDTL
 12734        MOVE AL-UABON            TO BEFFDTA
 12735        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12736        GO TO 8200-SEND-DATAONLY
 12737     ELSE
 12738        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12739        MOVE AL-UANON            TO BEFFDTA
 12740        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12741
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 233
* EL6311.cbl
 12742
 12743* EXEC CICS HANDLE CONDITION
 12744*         NOTFND    (1490-RECORD-NOT-FOUND)
 12745*    END-EXEC.
 12746*    MOVE '"$I                   ! + #00012036' TO DFHEIV0
 12747     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12748     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12749     MOVE X'2B20233030303132303336' TO DFHEIV0(25:11)
 12750     CALL 'kxdfhei1' USING DFHEIV0
 12751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12752
 12753
 12754
 12755* EXEC CICS READ
 12756*        SET     (ADDRESS OF PENDING-BUSINESS)
 12757*        DATASET (FILE-ID-ERPNDB)
 12758*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12759*        UPDATE
 12760*    END-EXEC.
 12761*    MOVE '&"S        EU         (   #00012040' TO DFHEIV0
 12762     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12763     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12764     MOVE X'2020233030303132303430' TO DFHEIV0(25:11)
 12765     CALL 'kxdfhei1' USING DFHEIV0,
 12766           FILE-ID-ERPNDB,
 12767           DFHEIV20,
 12768           DFHEIV99,
 12769           PI-PREV-CONTROL-PRIMARY,
 12770           DFHEIV99,
 12771           DFHEIV99,
 12772           DFHEIV99
 12773     SET ADDRESS OF PENDING-BUSINESS TO
 12774         DFHEIV20
 12775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12776
 12777
 12778     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12779        MOVE -1                 TO BMAINTL
 12780        MOVE ER-2197            TO EMI-ERROR
 12781        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12782        GO TO 8200-SEND-DATAONLY.
 12783
 12784     IF PB-BILLED-DT NOT = LOW-VALUES
 12785        MOVE -1                 TO BMAINTL
 12786        MOVE ER-2129            TO EMI-ERROR
 12787        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12788        GO TO 8200-SEND-DATAONLY.
 12789
 12790     IF PB-CHG-COUNT NOT = ZEROS
 12791        MOVE ER-2336            TO EMI-ERROR
 12792        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12793        MOVE AL-UABON            TO BMAINTA
 12794        MOVE -1                  TO BMAINTL
 12795        GO TO 8200-SEND-DATAONLY.
 12796
 12797     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12798        PB-CHG-COUNT NOT = ZEROS
 12799        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 234
* EL6311.cbl
 12800        MOVE AL-UABON            TO BMAINTA
 12801        MOVE -1                  TO BMAINTL
 12802        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12803        GO TO 8200-SEND-DATAONLY.
 12804******************************************************************
 12805*                                                                *
 12806*       Determine if there have been any checks created          *
 12807*                                                                *
 12808******************************************************************
 12809
 12810     perform 2500-browse-checks  thru 2500-exit
 12811
 12812     if i-have-processed-checks
 12813        or i-have-checks
 12814        or i-have-a-check-period
 12815        move er-3446             to emi-error
 12816        perform 9900-error-format thru 9900-exit
 12817        move al-uabon            to bmainta
 12818        move -1                  to bmaintl
 12819        go to 8200-send-dataonly
 12820     end-if
 12821******************************************************************
 12822*                                                                *
 12823*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12824*                                                                *
 12825******************************************************************
 12826     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12827     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12828     MOVE +0                     TO ELCRTO-SEQ-NO
 12829
 12830* EXEC CICS READ
 12831*       DATASET   ('ELCRTO')
 12832*       INTO      (ORIGINAL-CERTIFICATE)
 12833*       RIDFLD    (ELCRTO-KEY)
 12834*       GTEQ
 12835*       RESP      (WS-RESPONSE)
 12836*    END-EXEC
 12837     MOVE LENGTH OF
 12838      ORIGINAL-CERTIFICATE
 12839       TO DFHEIV11
 12840     MOVE 'ELCRTO' TO DFHEIV1
 12841*    MOVE '&"IL       G          (  N#00012098' TO DFHEIV0
 12842     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12843     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12844     MOVE X'204E233030303132303938' TO DFHEIV0(25:11)
 12845     CALL 'kxdfhei1' USING DFHEIV0,
 12846           DFHEIV1,
 12847           ORIGINAL-CERTIFICATE,
 12848           DFHEIV11,
 12849           ELCRTO-KEY,
 12850           DFHEIV99,
 12851           DFHEIV99,
 12852           DFHEIV99
 12853     MOVE EIBRESP  TO WS-RESPONSE
 12854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12855     IF RESP-NORMAL
 12856        AND (OC-CONTROL-PRIMARY (1:33) =
 12857                 PB-CONTROL-BY-ACCOUNT (1:33))
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 235
* EL6311.cbl
 12858        AND (OC-RECORD-TYPE = 'I')
 12859
 12860* EXEC CICS READ
 12861*          DATASET   ('ELCRTO')
 12862*          INTO      (ORIGINAL-CERTIFICATE)
 12863*          RIDFLD    (ELCRTO-KEY)
 12864*          UPDATE
 12865*          RESP      (WS-RESPONSE)
 12866*       END-EXEC
 12867     MOVE LENGTH OF
 12868      ORIGINAL-CERTIFICATE
 12869       TO DFHEIV11
 12870     MOVE 'ELCRTO' TO DFHEIV1
 12871*    MOVE '&"IL       EU         (  N#00012109' TO DFHEIV0
 12872     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12873     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12874     MOVE X'204E233030303132313039' TO DFHEIV0(25:11)
 12875     CALL 'kxdfhei1' USING DFHEIV0,
 12876           DFHEIV1,
 12877           ORIGINAL-CERTIFICATE,
 12878           DFHEIV11,
 12879           ELCRTO-KEY,
 12880           DFHEIV99,
 12881           DFHEIV99,
 12882           DFHEIV99
 12883     MOVE EIBRESP  TO WS-RESPONSE
 12884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12885        IF RESP-NORMAL
 12886
 12887* EXEC CICS DELETE
 12888*             DATASET   ('ELCRTO')
 12889*          END-EXEC
 12890     MOVE 'ELCRTO' TO DFHEIV1
 12891*    MOVE '&(                    &   #00012117' TO DFHEIV0
 12892     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12893     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12894     MOVE X'2020233030303132313137' TO DFHEIV0(25:11)
 12895     CALL 'kxdfhei1' USING DFHEIV0,
 12896           DFHEIV1,
 12897           DFHEIV99,
 12898           DFHEIV99,
 12899           DFHEIV99,
 12900           DFHEIV99
 12901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12902        END-IF
 12903     END-IF
 12904******************************************************************
 12905*                                                                *
 12906*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12907*                                                                *
 12908******************************************************************
 12909
 12910* EXEC CICS HANDLE CONDITION
 12911*        NOTFND    (1405-DELETE-CERTIFICATE)
 12912*    END-EXEC.
 12913*    MOVE '"$I                   ! , #00012127' TO DFHEIV0
 12914     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12915     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 236
* EL6311.cbl
 12916     MOVE X'2C20233030303132313237' TO DFHEIV0(25:11)
 12917     CALL 'kxdfhei1' USING DFHEIV0
 12918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12919
 12920
 12921
 12922* EXEC CICS READ
 12923*        EQUAL
 12924*        DATASET   (FILE-ID-ERPNDM)
 12925*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12926*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12927*        UPDATE
 12928*    END-EXEC.
 12929*    MOVE '&"S        EU         (   #00012131' TO DFHEIV0
 12930     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12931     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12932     MOVE X'2020233030303132313331' TO DFHEIV0(25:11)
 12933     CALL 'kxdfhei1' USING DFHEIV0,
 12934           FILE-ID-ERPNDM,
 12935           DFHEIV20,
 12936           DFHEIV99,
 12937           PI-PREV-CONTROL-PRIMARY,
 12938           DFHEIV99,
 12939           DFHEIV99,
 12940           DFHEIV99
 12941     SET ADDRESS OF PENDING-MAILING-DATA TO
 12942         DFHEIV20
 12943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12944
 12945
 12946     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12947     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12948     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12949
 12950     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12951
 12952
 12953* EXEC CICS DELETE
 12954*        DATASET   (FILE-ID-ERPNDM)
 12955*    END-EXEC.
 12956*    MOVE '&(                    &   #00012145' TO DFHEIV0
 12957     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12958     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12959     MOVE X'2020233030303132313435' TO DFHEIV0(25:11)
 12960     CALL 'kxdfhei1' USING DFHEIV0,
 12961           FILE-ID-ERPNDM,
 12962           DFHEIV99,
 12963           DFHEIV99,
 12964           DFHEIV99,
 12965           DFHEIV99
 12966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12967
 12968
 12969******************************************************************
 12970*                PROCESS   CERTIFICATE                           *
 12971******************************************************************
 12972
 12973 1405-DELETE-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 237
* EL6311.cbl
 12974
 12975* EXEC CICS HANDLE CONDITION
 12976*         NOTFND  (1420-CONTINUE-DELETE)
 12977*    END-EXEC.
 12978*    MOVE '"$I                   ! - #00012154' TO DFHEIV0
 12979     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12980     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12981     MOVE X'2D20233030303132313534' TO DFHEIV0(25:11)
 12982     CALL 'kxdfhei1' USING DFHEIV0
 12983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12984
 12985
 12986     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12987     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12988     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12989     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12990
 12991
 12992* EXEC CICS READ
 12993*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12994*        DATASET (FILE-ID-ELCERT)
 12995*        RIDFLD  (ELCERT-KEY)
 12996*        UPDATE
 12997*    END-EXEC.
 12998*    MOVE '&"S        EU         (   #00012163' TO DFHEIV0
 12999     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13000     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13001     MOVE X'2020233030303132313633' TO DFHEIV0(25:11)
 13002     CALL 'kxdfhei1' USING DFHEIV0,
 13003           FILE-ID-ELCERT,
 13004           DFHEIV20,
 13005           DFHEIV99,
 13006           ELCERT-KEY,
 13007           DFHEIV99,
 13008           DFHEIV99,
 13009           DFHEIV99
 13010     SET ADDRESS OF CERTIFICATE-MASTER TO
 13011         DFHEIV20
 13012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13013
 13014
 13015     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13016
 13017     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 13018     MOVE 'B'                    TO JP-RECORD-TYPE
 13019     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 13020
 13021     PERFORM 8400-LOG-JOURNAL-RECORD.
 13022
 13023     IF CERT-NOTES-ARE-NOT-PRESENT
 13024        MOVE ' '                 TO WS-CERT-NOTE-SW
 13025     ELSE
 13026        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 13027
 13028     IF INSURED-ADDR-PRESENT
 13029        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 13030
 13031******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 238
* EL6311.cbl
 13032******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 13033******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 13034******************************************************************
 13035******************************************************************
 13036
 13037     IF CERT-ADDED-BATCH AND
 13038        (NOT NO-CLAIM-ATTACHED
 13039         OR
 13040         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 13041        GO TO 1410-REWRITE-CERT.
 13042
 13043******************************************************************
 13044******************************************************************
 13045
 13046     IF CERT-ADDED-BATCH  AND
 13047        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 13048        GO TO 1410-REWRITE-CERT.
 13049
 13050     IF NO-CLAIM-ATTACHED
 13051        NEXT SENTENCE
 13052     ELSE
 13053        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 13054        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 13055        GO TO 1410-REWRITE-CERT.
 13056
 13057     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13058     MOVE 'D'                      TO JP-RECORD-TYPE.
 13059     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13060
 13061
 13062* EXEC CICS DELETE
 13063*         DATASET    (FILE-ID-ELCERT)
 13064*    END-EXEC.
 13065*    MOVE '&(                    &   #00012216' TO DFHEIV0
 13066     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13067     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13068     MOVE X'2020233030303132323136' TO DFHEIV0(25:11)
 13069     CALL 'kxdfhei1' USING DFHEIV0,
 13070           FILE-ID-ELCERT,
 13071           DFHEIV99,
 13072           DFHEIV99,
 13073           DFHEIV99,
 13074           DFHEIV99
 13075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13076
 13077
 13078     PERFORM 8400-LOG-JOURNAL-RECORD.
 13079
 13080******************************************************************
 13081*                                                                *
 13082*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 13083*                                                                *
 13084******************************************************************
 13085
 13086     IF  CERT-NOTES-ARE-PRESENT
 13087         NEXT SENTENCE
 13088     ELSE
 13089         GO TO 1407-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 239
* EL6311.cbl
 13090
 13091
 13092* EXEC CICS HANDLE CONDITION
 13093*         NOTFND  (1406-DELETE-ERNOTE)
 13094*    END-EXEC.
 13095*    MOVE '"$I                   ! . #00012233' TO DFHEIV0
 13096     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13097     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13098     MOVE X'2E20233030303132323333' TO DFHEIV0(25:11)
 13099     CALL 'kxdfhei1' USING DFHEIV0
 13100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13101
 13102
 13103     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 13104     MOVE '0'                   TO ERCNOT-REC-TYPE.
 13105     MOVE 0                     TO ERCNOT-SEQUENCE.
 13106
 13107 1406-DELETE-ERCNOT-LOOP.
 13108
 13109
 13110* EXEC CICS READ
 13111*        GTEQ
 13112*        DATASET   (FILE-ID-ERCNOT)
 13113*        SET       (ADDRESS OF CERT-NOTE-FILE)
 13114*        RIDFLD    (ERCNOT-KEY)
 13115*    END-EXEC.
 13116*    MOVE '&"S        G          (   #00012243' TO DFHEIV0
 13117     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13118     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13119     MOVE X'2020233030303132323433' TO DFHEIV0(25:11)
 13120     CALL 'kxdfhei1' USING DFHEIV0,
 13121           FILE-ID-ERCNOT,
 13122           DFHEIV20,
 13123           DFHEIV99,
 13124           ERCNOT-KEY,
 13125           DFHEIV99,
 13126           DFHEIV99,
 13127           DFHEIV99
 13128     SET ADDRESS OF CERT-NOTE-FILE TO
 13129         DFHEIV20
 13130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13131
 13132
 13133     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 13134     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 13135         GO TO 1406-DELETE-ERNOTE
 13136     END-IF.
 13137
 13138     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 13139     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13140     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 13141
 13142     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13143
 13144
 13145* EXEC CICS DELETE
 13146*        DATASET   (FILE-ID-ERCNOT)
 13147*        RIDFLD    (ERCNOT-KEY)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 240
* EL6311.cbl
 13148*        END-EXEC.
 13149*    MOVE '&(  R                 &   #00012261' TO DFHEIV0
 13150     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13151     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13152     MOVE X'2020233030303132323631' TO DFHEIV0(25:11)
 13153     CALL 'kxdfhei1' USING DFHEIV0,
 13154           FILE-ID-ERCNOT,
 13155           ERCNOT-KEY,
 13156           DFHEIV99,
 13157           DFHEIV99,
 13158           DFHEIV99
 13159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13160
 13161
 13162     PERFORM 8400-LOG-JOURNAL-RECORD.
 13163
 13164     GO TO 1406-DELETE-ERCNOT-LOOP.
 13165
 13166 1406-DELETE-ERNOTE.
 13167
 13168
 13169* EXEC CICS HANDLE CONDITION
 13170*         NOTFND  (1407-DELETE-MAILING)
 13171*    END-EXEC.
 13172*    MOVE '"$I                   ! / #00012272' TO DFHEIV0
 13173     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13174     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13175     MOVE X'2F20233030303132323732' TO DFHEIV0(25:11)
 13176     CALL 'kxdfhei1' USING DFHEIV0
 13177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13178
 13179
 13180
 13181* EXEC CICS READ
 13182*        EQUAL
 13183*        DATASET   (FILE-ID-ERNOTE)
 13184*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 13185*        RIDFLD    (ELCERT-KEY)
 13186*        UPDATE
 13187*    END-EXEC.
 13188*    MOVE '&"S        EU         (   #00012276' TO DFHEIV0
 13189     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13190     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13191     MOVE X'2020233030303132323736' TO DFHEIV0(25:11)
 13192     CALL 'kxdfhei1' USING DFHEIV0,
 13193           FILE-ID-ERNOTE,
 13194           DFHEIV20,
 13195           DFHEIV99,
 13196           ELCERT-KEY,
 13197           DFHEIV99,
 13198           DFHEIV99,
 13199           DFHEIV99
 13200     SET ADDRESS OF CERTIFICATE-NOTE TO
 13201         DFHEIV20
 13202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13203
 13204
 13205     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 241
* EL6311.cbl
 13206     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13207     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13208
 13209     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13210
 13211
 13212* EXEC CICS DELETE
 13213*        DATASET   (FILE-ID-ERNOTE)
 13214*        END-EXEC.
 13215*    MOVE '&(                    &   #00012290' TO DFHEIV0
 13216     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13217     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13218     MOVE X'2020233030303132323930' TO DFHEIV0(25:11)
 13219     CALL 'kxdfhei1' USING DFHEIV0,
 13220           FILE-ID-ERNOTE,
 13221           DFHEIV99,
 13222           DFHEIV99,
 13223           DFHEIV99,
 13224           DFHEIV99
 13225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13226
 13227
 13228     PERFORM 8400-LOG-JOURNAL-RECORD.
 13229
 13230******************************************************************
 13231*                                                                *
 13232*                DELETE MAILING ADDRESS RECORDS                  *
 13233*                                                                *
 13234******************************************************************
 13235
 13236 1407-DELETE-MAILING.
 13237     IF CERT-ADDRESS-PRESENT
 13238        NEXT SENTENCE
 13239     ELSE
 13240        GO TO 1420-CONTINUE-DELETE.
 13241
 13242
 13243* EXEC CICS HANDLE CONDITION
 13244*         NOTFND  (1420-CONTINUE-DELETE)
 13245*    END-EXEC.
 13246*    MOVE '"$I                   ! 0 #00012308' TO DFHEIV0
 13247     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13248     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13249     MOVE X'3020233030303132333038' TO DFHEIV0(25:11)
 13250     CALL 'kxdfhei1' USING DFHEIV0
 13251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13252
 13253
 13254
 13255* EXEC CICS READ
 13256*        EQUAL
 13257*        DATASET   (FILE-ID-ERMAIL)
 13258*        SET       (ADDRESS OF MAILING-DATA)
 13259*        RIDFLD    (ELCERT-KEY)
 13260*        UPDATE
 13261*    END-EXEC.
 13262*    MOVE '&"S        EU         (   #00012312' TO DFHEIV0
 13263     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 242
* EL6311.cbl
 13264     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13265     MOVE X'2020233030303132333132' TO DFHEIV0(25:11)
 13266     CALL 'kxdfhei1' USING DFHEIV0,
 13267           FILE-ID-ERMAIL,
 13268           DFHEIV20,
 13269           DFHEIV99,
 13270           ELCERT-KEY,
 13271           DFHEIV99,
 13272           DFHEIV99,
 13273           DFHEIV99
 13274     SET ADDRESS OF MAILING-DATA TO
 13275         DFHEIV20
 13276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13277
 13278
 13279     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13280     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13281     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13282
 13283     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13284
 13285
 13286* EXEC CICS DELETE
 13287*        DATASET   (FILE-ID-ERMAIL)
 13288*    END-EXEC.
 13289*    MOVE '&(                    &   #00012326' TO DFHEIV0
 13290     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13291     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13292     MOVE X'2020233030303132333236' TO DFHEIV0(25:11)
 13293     CALL 'kxdfhei1' USING DFHEIV0,
 13294           FILE-ID-ERMAIL,
 13295           DFHEIV99,
 13296           DFHEIV99,
 13297           DFHEIV99,
 13298           DFHEIV99
 13299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13300
 13301
 13302     GO TO 1420-CONTINUE-DELETE.
 13303
 13304 1410-REWRITE-CERT.
 13305     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13306     MOVE 'C'                      TO JP-RECORD-TYPE.
 13307     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13308     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13309
 13310
 13311* EXEC CICS REWRITE
 13312*         DATASET    (FILE-ID-ELCERT)
 13313*         FROM       (CERTIFICATE-MASTER)
 13314*         END-EXEC.
 13315     MOVE LENGTH OF
 13316      CERTIFICATE-MASTER
 13317       TO DFHEIV11
 13318*    MOVE '&& L                  %   #00012338' TO DFHEIV0
 13319     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13320     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13321     MOVE X'2020233030303132333338' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 243
* EL6311.cbl
 13322     CALL 'kxdfhei1' USING DFHEIV0,
 13323           FILE-ID-ELCERT,
 13324           CERTIFICATE-MASTER,
 13325           DFHEIV11,
 13326           DFHEIV99
 13327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13328
 13329
 13330     PERFORM 8400-LOG-JOURNAL-RECORD.
 13331
 13332 1420-CONTINUE-DELETE.
 13333     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 13334     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13335
 13336     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13337     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13338
 13339     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13340
 13341 1450-DELETE-PB-RECORD.
 13342     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13343     MOVE 'D'                      TO JP-RECORD-TYPE
 13344     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13345
 13346
 13347* EXEC CICS DELETE
 13348*        DATASET    (FILE-ID-ERPNDB)
 13349*    END-EXEC.
 13350*    MOVE '&(                    &   #00012359' TO DFHEIV0
 13351     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13352     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13353     MOVE X'2020233030303132333539' TO DFHEIV0(25:11)
 13354     CALL 'kxdfhei1' USING DFHEIV0,
 13355           FILE-ID-ERPNDB,
 13356           DFHEIV99,
 13357           DFHEIV99,
 13358           DFHEIV99,
 13359           DFHEIV99
 13360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13361
 13362
 13363     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13364
 13365     PERFORM 8400-LOG-JOURNAL-RECORD.
 13366
 13367     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13368     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13369     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13370
 13371
 13372* EXEC CICS HANDLE CONDITION
 13373*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13374*    END-EXEC.
 13375*    MOVE '"$I                   ! 1 #00012371' TO DFHEIV0
 13376     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13377     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13378     MOVE X'3120233030303132333731' TO DFHEIV0(25:11)
 13379     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 244
* EL6311.cbl
 13380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13381
 13382
 13383
 13384* EXEC CICS READ
 13385*        SET     (ADDRESS OF PENDING-BUSINESS)
 13386*        DATASET (FILE-ID-ERPNDB)
 13387*        RIDFLD  (ERPNDB-KEY)
 13388*        UPDATE
 13389*    END-EXEC.
 13390*    MOVE '&"S        EU         (   #00012375' TO DFHEIV0
 13391     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13392     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13393     MOVE X'2020233030303132333735' TO DFHEIV0(25:11)
 13394     CALL 'kxdfhei1' USING DFHEIV0,
 13395           FILE-ID-ERPNDB,
 13396           DFHEIV20,
 13397           DFHEIV99,
 13398           ERPNDB-KEY,
 13399           DFHEIV99,
 13400           DFHEIV99,
 13401           DFHEIV99
 13402     SET ADDRESS OF PENDING-BUSINESS TO
 13403         DFHEIV20
 13404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13405
 13406
 13407     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13408
 13409     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13410
 13411     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13412        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13413        MOVE 'D'                   TO JP-RECORD-TYPE
 13414        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13415
 13416* EXEC CICS DELETE
 13417*            DATASET    (FILE-ID-ERPNDB)
 13418*       END-EXEC
 13419*    MOVE '&(                    &   #00012390' TO DFHEIV0
 13420     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13421     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13422     MOVE X'2020233030303132333930' TO DFHEIV0(25:11)
 13423     CALL 'kxdfhei1' USING DFHEIV0,
 13424           FILE-ID-ERPNDB,
 13425           DFHEIV99,
 13426           DFHEIV99,
 13427           DFHEIV99,
 13428           DFHEIV99
 13429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13430        PERFORM 8400-LOG-JOURNAL-RECORD
 13431     ELSE
 13432        MOVE 'B'                 TO JP-RECORD-TYPE
 13433        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13434        PERFORM 8400-LOG-JOURNAL-RECORD
 13435        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13436        MOVE 'C'                 TO JP-RECORD-TYPE
 13437        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 245
* EL6311.cbl
 13438
 13439* EXEC CICS REWRITE
 13440*            DATASET    (FILE-ID-ERPNDB)
 13441*            FROM       (PENDING-BUSINESS)
 13442*       END-EXEC
 13443     MOVE LENGTH OF
 13444      PENDING-BUSINESS
 13445       TO DFHEIV11
 13446*    MOVE '&& L                  %   #00012401' TO DFHEIV0
 13447     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13448     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13449     MOVE X'2020233030303132343031' TO DFHEIV0(25:11)
 13450     CALL 'kxdfhei1' USING DFHEIV0,
 13451           FILE-ID-ERPNDB,
 13452           PENDING-BUSINESS,
 13453           DFHEIV11,
 13454           DFHEIV99
 13455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13456        PERFORM 8400-LOG-JOURNAL-RECORD.
 13457
 13458******************************************************************
 13459*                                                                *
 13460*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13461*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13462*                                                                *
 13463******************************************************************
 13464
 13465     IF NOT PI-AR-PROCESSING
 13466        GO TO 1475-DELETE-FINISHED.
 13467
 13468     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13469        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13470        NEXT SENTENCE
 13471     ELSE
 13472        GO TO 1475-DELETE-FINISHED.
 13473
 13474
 13475* EXEC CICS HANDLE CONDITION
 13476*         NOTFND    (1475-DELETE-FINISHED)
 13477*         END-EXEC.
 13478*    MOVE '"$I                   ! 2 #00012423' TO DFHEIV0
 13479     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13480     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13481     MOVE X'3220233030303132343233' TO DFHEIV0(25:11)
 13482     CALL 'kxdfhei1' USING DFHEIV0
 13483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13484
 13485
 13486     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13487     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13488
 13489
 13490* EXEC CICS READ
 13491*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13492*        DATASET (FILE-ID-ERRQST)
 13493*        RIDFLD  (ERRQST-KEY)
 13494*        UPDATE
 13495*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 246
* EL6311.cbl
 13496*    MOVE '&"S        EU         (   #00012430' TO DFHEIV0
 13497     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13498     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13499     MOVE X'2020233030303132343330' TO DFHEIV0(25:11)
 13500     CALL 'kxdfhei1' USING DFHEIV0,
 13501           FILE-ID-ERRQST,
 13502           DFHEIV20,
 13503           DFHEIV99,
 13504           ERRQST-KEY,
 13505           DFHEIV99,
 13506           DFHEIV99,
 13507           DFHEIV99
 13508     SET ADDRESS OF AR-REQUEST-RECORD TO
 13509         DFHEIV20
 13510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13511
 13512
 13513     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13514
 13515     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13516
 13517     MOVE 'D'                      TO JP-RECORD-TYPE.
 13518     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13519
 13520
 13521* EXEC CICS DELETE
 13522*         DATASET    (FILE-ID-ERRQST)
 13523*    END-EXEC.
 13524*    MOVE '&(                    &   #00012444' TO DFHEIV0
 13525     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13526     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13527     MOVE X'2020233030303132343434' TO DFHEIV0(25:11)
 13528     CALL 'kxdfhei1' USING DFHEIV0,
 13529           FILE-ID-ERRQST,
 13530           DFHEIV99,
 13531           DFHEIV99,
 13532           DFHEIV99,
 13533           DFHEIV99
 13534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13535
 13536
 13537     PERFORM 8400-LOG-JOURNAL-RECORD.
 13538
 13539 1475-DELETE-FINISHED.
 13540     MOVE ZEROS                  TO EMI-ERROR.
 13541     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13542     MOVE LOW-VALUES             TO EL631BI.
 13543     MOVE -1                     TO BMAINTL.
 13544     GO TO 8100-SEND-INITIAL-MAP.
 13545
 13546 1480-BATCH-HDR-NOT-FOUND.
 13547     MOVE -1                     TO BMAINTL.
 13548     MOVE ER-7450                TO EMI-ERROR.
 13549     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13550     GO TO 8200-SEND-DATAONLY.
 13551
 13552 1490-RECORD-NOT-FOUND.
 13553     MOVE -1                     TO BMAINTL.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 247
* EL6311.cbl
 13554     MOVE ER-7451                TO EMI-ERROR.
 13555     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13556     GO TO 8200-SEND-DATAONLY.
 13557
 13558******************************************************************
 13559*            O V E R   C H A R G E   P R O C E S S I N G         *
 13560******************************************************************
 13561 1500-UPDATE-ERNOTE.
 13562     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13563     MOVE 'A'                    TO WS-NOTE-SW
 13564     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13565     .
 13566 1500-EXIT.
 13567     EXIT.
 13568 1510-ADD-ERNOTE-REC.
 13569
 13570* EXEC CICS GETMAIN
 13571*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13572*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13573*        INITIMG (GETMAIN-SPACE)
 13574*    END-EXEC
 13575*    MOVE ',"IL                  $   #00012480' TO DFHEIV0
 13576     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13577     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13578     MOVE X'2020233030303132343830' TO DFHEIV0(25:11)
 13579     CALL 'kxdfhei1' USING DFHEIV0,
 13580           DFHEIV20,
 13581           ERNOTE-RECORD-LENGTH,
 13582           GETMAIN-SPACE
 13583     SET ADDRESS OF CERTIFICATE-NOTE TO
 13584         DFHEIV20
 13585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13586     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13587                                 TO ERNOTE-KEY
 13588
 13589* EXEC CICS READ
 13590*       DATASET    (FILE-ID-ERNOTE)
 13591*       RIDFLD     (ERNOTE-KEY)
 13592*       INTO       (CERTIFICATE-NOTE)
 13593*       RESP       (WS-RESPONSE)
 13594*       UPDATE
 13595*    END-EXEC
 13596     MOVE LENGTH OF
 13597      CERTIFICATE-NOTE
 13598       TO DFHEIV11
 13599*    MOVE '&"IL       EU         (  N#00012487' TO DFHEIV0
 13600     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13601     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13602     MOVE X'204E233030303132343837' TO DFHEIV0(25:11)
 13603     CALL 'kxdfhei1' USING DFHEIV0,
 13604           FILE-ID-ERNOTE,
 13605           CERTIFICATE-NOTE,
 13606           DFHEIV11,
 13607           ERNOTE-KEY,
 13608           DFHEIV99,
 13609           DFHEIV99,
 13610           DFHEIV99
 13611     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 248
* EL6311.cbl
 13612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13613     IF RESP-NORMAL
 13614        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13615           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13616        END-IF
 13617        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13618           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13619        END-IF
 13620        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13621           (N1 > +10)
 13622           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13623           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13624        END-PERFORM
 13625        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13626          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13627
 13628* EXEC CICS UNLOCK
 13629*            DATASET    (FILE-ID-ERNOTE)
 13630*          END-EXEC
 13631*    MOVE '&*                    #   #00012508' TO DFHEIV0
 13632     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13633     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13634     MOVE X'2020233030303132353038' TO DFHEIV0(25:11)
 13635     CALL 'kxdfhei1' USING DFHEIV0,
 13636           FILE-ID-ERNOTE,
 13637           DFHEIV99
 13638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13639        ELSE
 13640          PERFORM VARYING N1 FROM +1 BY +1
 13641           UNTIL (N1 > +10)
 13642           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13643          END-PERFORM
 13644          IF (N1 < +11)
 13645            IF N1 >= CN-BILLING-START-LINE-NO AND
 13646              N1 <= CN-BILLING-END-LINE-NO
 13647              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13648                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13649              ELSE
 13650                 MOVE WS-VA-NO-COMM-MESS
 13651                                    TO CN-LINE (N1)
 13652              END-IF
 13653            ELSE
 13654              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13655               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13656                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13657                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13658                ELSE
 13659                  MOVE WS-VA-NO-COMM-MESS
 13660                                    TO CN-LINE (N1)
 13661                END-IF
 13662                MOVE N1             TO CN-BILLING-END-LINE-NO
 13663              ELSE
 13664                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13665                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13666                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13667                  ELSE
 13668                     MOVE WS-VA-NO-COMM-MESS
 13669                                    TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 249
* EL6311.cbl
 13670                  END-IF
 13671                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13672                                      CN-BILLING-START-LINE-NO
 13673                ELSE
 13674                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13675                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13676                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13677                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13678                     ELSE
 13679                       MOVE WS-VA-NO-COMM-MESS
 13680                                    TO CN-LINE (N1)
 13681                     END-IF
 13682                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13683                  ELSE
 13684                     PERFORM 1700-SQUEEZE-IT-IN
 13685                                 THRU 1700-EXIT
 13686                  END-IF
 13687                END-IF
 13688              END-IF
 13689            END-IF
 13690            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13691            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13692            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13693
 13694* EXEC CICS REWRITE
 13695*              DATASET    (FILE-ID-ERNOTE)
 13696*              FROM       (CERTIFICATE-NOTE)
 13697*              RESP       (WS-RESPONSE)
 13698*           END-EXEC
 13699     MOVE LENGTH OF
 13700      CERTIFICATE-NOTE
 13701       TO DFHEIV11
 13702*    MOVE '&& L                  %  N#00012565' TO DFHEIV0
 13703     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13704     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13705     MOVE X'204E233030303132353635' TO DFHEIV0(25:11)
 13706     CALL 'kxdfhei1' USING DFHEIV0,
 13707           FILE-ID-ERNOTE,
 13708           CERTIFICATE-NOTE,
 13709           DFHEIV11,
 13710           DFHEIV99
 13711     MOVE EIBRESP  TO WS-RESPONSE
 13712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13713          END-IF
 13714        END-IF
 13715     ELSE
 13716        MOVE SPACES              TO CERTIFICATE-NOTE
 13717        MOVE 'CN'                TO CN-RECORD-ID
 13718        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13719                                 TO CN-CONTROL-PRIMARY
 13720                                    ERNOTE-KEY
 13721        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13722                                    CN-BILLING-END-LINE-NO
 13723        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13724           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13725        ELSE
 13726           MOVE WS-VA-NO-COMM-MESS
 13727                                 TO CN-LINE (1)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 250
* EL6311.cbl
 13728        END-IF
 13729        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13730        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13731        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13732
 13733* EXEC CICS WRITE
 13734*          DATASET    (FILE-ID-ERNOTE)
 13735*          FROM       (CERTIFICATE-NOTE)
 13736*          RIDFLD     (ERNOTE-KEY)
 13737*          RESP       (WS-RESPONSE)
 13738*       END-EXEC
 13739     MOVE LENGTH OF
 13740      CERTIFICATE-NOTE
 13741       TO DFHEIV11
 13742*    MOVE '&$ L                  ''  N#00012589' TO DFHEIV0
 13743     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13744     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13745     MOVE X'204E233030303132353839' TO DFHEIV0(25:11)
 13746     CALL 'kxdfhei1' USING DFHEIV0,
 13747           FILE-ID-ERNOTE,
 13748           CERTIFICATE-NOTE,
 13749           DFHEIV11,
 13750           ERNOTE-KEY,
 13751           DFHEIV99,
 13752           DFHEIV99
 13753     MOVE EIBRESP  TO WS-RESPONSE
 13754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13755     END-IF
 13756     .
 13757 1510-EXIT.
 13758     EXIT.
 13759 1520-UPDATE-ELCERT.
 13760     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13761                                 TO ELCERT-KEY
 13762
 13763* EXEC CICS READ
 13764*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13765*        DATASET (FILE-ID-ELCERT)
 13766*        RIDFLD  (ELCERT-KEY)
 13767*        UPDATE
 13768*        RESP    (WS-RESPONSE)
 13769*    END-EXEC
 13770*    MOVE '&"S        EU         (  N#00012602' TO DFHEIV0
 13771     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13772     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13773     MOVE X'204E233030303132363032' TO DFHEIV0(25:11)
 13774     CALL 'kxdfhei1' USING DFHEIV0,
 13775           FILE-ID-ELCERT,
 13776           DFHEIV20,
 13777           DFHEIV99,
 13778           ELCERT-KEY,
 13779           DFHEIV99,
 13780           DFHEIV99,
 13781           DFHEIV99
 13782     SET ADDRESS OF CERTIFICATE-MASTER TO
 13783         DFHEIV20
 13784     MOVE EIBRESP  TO WS-RESPONSE
 13785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 251
* EL6311.cbl
 13786     IF RESP-NORMAL
 13787        IF WS-NOTE-SW = 'A'
 13788           IF CM-NOTE-SW = ' '
 13789              MOVE '2'             TO CM-NOTE-SW
 13790           ELSE
 13791             IF CM-NOTE-SW = '1'
 13792                MOVE '3'           TO CM-NOTE-SW
 13793             ELSE
 13794               IF CM-NOTE-SW = '4'
 13795                  MOVE '6'         TO CM-NOTE-SW
 13796               ELSE
 13797                 IF CM-NOTE-SW = '5'
 13798                    MOVE '7'       TO CM-NOTE-SW
 13799                 END-IF
 13800               END-IF
 13801             END-IF
 13802           END-IF
 13803        ELSE
 13804           IF CM-NOTE-SW = '2'
 13805              MOVE ' '             TO CM-NOTE-SW
 13806           ELSE
 13807             IF CM-NOTE-SW = '3'
 13808                MOVE '1'           TO CM-NOTE-SW
 13809             ELSE
 13810               IF CM-NOTE-SW = '6'
 13811                  MOVE '4'         TO CM-NOTE-SW
 13812               ELSE
 13813                 IF CM-NOTE-SW = '7'
 13814                    MOVE '5'       TO CM-NOTE-SW
 13815                 END-IF
 13816               END-IF
 13817             END-IF
 13818           END-IF
 13819        END-IF
 13820
 13821* EXEC CICS REWRITE
 13822*          DATASET    (FILE-ID-ELCERT)
 13823*          FROM       (CERTIFICATE-MASTER)
 13824*          RESP       (WS-RESPONSE)
 13825*       END-EXEC
 13826     MOVE LENGTH OF
 13827      CERTIFICATE-MASTER
 13828       TO DFHEIV11
 13829*    MOVE '&& L                  %  N#00012643' TO DFHEIV0
 13830     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13831     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13832     MOVE X'204E233030303132363433' TO DFHEIV0(25:11)
 13833     CALL 'kxdfhei1' USING DFHEIV0,
 13834           FILE-ID-ELCERT,
 13835           CERTIFICATE-MASTER,
 13836           DFHEIV11,
 13837           DFHEIV99
 13838     MOVE EIBRESP  TO WS-RESPONSE
 13839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13840        IF RESP-NORMAL
 13841           CONTINUE
 13842        ELSE
 13843           MOVE WS-RESPONSE TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 252
* EL6311.cbl
 13844           PERFORM 9900-ERROR-FORMAT
 13845                                 THRU 9900-EXIT
 13846           GO TO 8200-SEND-DATAONLY
 13847        END-IF
 13848     ELSE
 13849        MOVE -1                  TO BMAINTL
 13850        MOVE 0249                TO EMI-ERROR
 13851        PERFORM 9900-ERROR-FORMAT
 13852                                 THRU 9900-EXIT
 13853        GO TO 8200-SEND-DATAONLY
 13854     END-IF
 13855     .
 13856 1520-EXIT.
 13857     EXIT.
 13858 1600-UPDATE-ERPYAJ.
 13859     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13860                                 THRU 1610-EXIT
 13861     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13862                                 THRU 1620-EXIT
 13863     .
 13864 1600-EXIT.
 13865     EXIT.
 13866 1610-ADD-ERPYAJ-BANK-REC.
 13867
 13868* EXEC CICS GETMAIN
 13869*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13870*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13871*        INITIMG (GETMAIN-SPACE)
 13872*    END-EXEC
 13873*    MOVE ',"IL                  $   #00012675' TO DFHEIV0
 13874     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13875     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13876     MOVE X'2020233030303132363735' TO DFHEIV0(25:11)
 13877     CALL 'kxdfhei1' USING DFHEIV0,
 13878           DFHEIV20,
 13879           ERPYAJ-RECORD-LENGTH,
 13880           GETMAIN-SPACE
 13881     SET ADDRESS OF PENDING-PAY-ADJ TO
 13882         DFHEIV20
 13883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13884     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13885     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13886     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13887     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13888     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13889     MOVE +10                    TO ERPYAJ-SEQ-NO
 13890     MOVE 'R'                    TO ERPYAJ-TYPE
 13891     IF REVERSAL
 13892        MOVE 'C'                 TO ERPYAJ-TYPE
 13893     END-IF
 13894     MOVE SPACES                 TO PENDING-PAY-ADJ
 13895     MOVE 'PY'                   TO PY-RECORD-ID
 13896     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13897     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13898     IF REVERSAL
 13899        MOVE PB-I-DCC-OVER-CHG-AMT
 13900                                 TO PY-ENTRY-AMT
 13901     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 253
* EL6311.cbl
 13902     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13903                                    PY-INPUT-DT
 13904*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13905*                                   PY-INPUT-DT
 13906     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13907     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13908     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13909     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13910     IF PB-CARRIER = '2'
 13911        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13912     ELSE
 13913        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13914     END-IF
 13915     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13916                                    PY-BILLED-DATE
 13917                                    PY-AR-DATE
 13918                                    PY-REPORTED-DT
 13919                                    PY-CHECK-WRITTEN-DT
 13920     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13921                                    PY-CHECK-QUE-SEQUENCE
 13922     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13923     PERFORM WITH TEST AFTER
 13924        UNTIL (NOT RESP-DUPKEY)
 13925           AND (NOT RESP-DUPREC)
 13926
 13927* EXEC CICS WRITE
 13928*          DATASET    (FILE-ID-ERPYAJ)
 13929*          FROM       (PENDING-PAY-ADJ)
 13930*          RIDFLD     (ERPYAJ-KEY)
 13931*          RESP       (WS-RESPONSE)
 13932*       END-EXEC
 13933     MOVE LENGTH OF
 13934      PENDING-PAY-ADJ
 13935       TO DFHEIV11
 13936*    MOVE '&$ L                  ''  N#00012722' TO DFHEIV0
 13937     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13938     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13939     MOVE X'204E233030303132373232' TO DFHEIV0(25:11)
 13940     CALL 'kxdfhei1' USING DFHEIV0,
 13941           FILE-ID-ERPYAJ,
 13942           PENDING-PAY-ADJ,
 13943           DFHEIV11,
 13944           ERPYAJ-KEY,
 13945           DFHEIV99,
 13946           DFHEIV99
 13947     MOVE EIBRESP  TO WS-RESPONSE
 13948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13949        IF RESP-DUPKEY OR RESP-DUPREC
 13950           ADD +1                TO ERPYAJ-SEQ-NO
 13951           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13952        END-IF
 13953     END-PERFORM
 13954     .
 13955 1610-EXIT.
 13956     EXIT.
 13957 1620-ADD-ERPYAJ-DLR-REC.
 13958     MOVE 'C'                    TO ERPYAJ-TYPE
 13959     IF REVERSAL
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 254
* EL6311.cbl
 13960        MOVE 'R'                 TO ERPYAJ-TYPE
 13961     END-IF
 13962     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13963                                    ERPYAJ-ACCOUNT
 13964     ADD +1                      TO ERPYAJ-SEQ-NO
 13965     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13966     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13967     IF PB-CARRIER = '2'
 13968        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13969     ELSE
 13970        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13971     END-IF
 13972     PERFORM WITH TEST AFTER
 13973        UNTIL (NOT RESP-DUPKEY)
 13974           AND (NOT RESP-DUPREC)
 13975
 13976* EXEC CICS WRITE
 13977*          DATASET    (FILE-ID-ERPYAJ)
 13978*          FROM       (PENDING-PAY-ADJ)
 13979*          RIDFLD     (ERPYAJ-KEY)
 13980*          RESP       (WS-RESPONSE)
 13981*       END-EXEC
 13982     MOVE LENGTH OF
 13983      PENDING-PAY-ADJ
 13984       TO DFHEIV11
 13985*    MOVE '&$ L                  ''  N#00012754' TO DFHEIV0
 13986     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13987     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13988     MOVE X'204E233030303132373534' TO DFHEIV0(25:11)
 13989     CALL 'kxdfhei1' USING DFHEIV0,
 13990           FILE-ID-ERPYAJ,
 13991           PENDING-PAY-ADJ,
 13992           DFHEIV11,
 13993           ERPYAJ-KEY,
 13994           DFHEIV99,
 13995           DFHEIV99
 13996     MOVE EIBRESP  TO WS-RESPONSE
 13997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13998        IF RESP-DUPKEY OR RESP-DUPREC
 13999           ADD +1                TO ERPYAJ-SEQ-NO
 14000           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14001        END-IF
 14002     END-PERFORM
 14003     .
 14004 1620-EXIT.
 14005     EXIT.
 14006 1700-SQUEEZE-IT-IN.
 14007     IF (N1 > CN-BILLING-END-LINE-NO)
 14008        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 14009           N1 = +1
 14010           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 14011           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 14012              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14013                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 14014              ELSE
 14015                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 14016              END-IF
 14017              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 255
* EL6311.cbl
 14018              MOVE +2 TO N1
 14019           END-IF
 14020        END-PERFORM
 14021     ELSE
 14022        IF (N1 < CN-BILLING-START-LINE-NO)
 14023           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 14024              N1 = +10
 14025              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 14026              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 14027                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14028                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 14029                 ELSE
 14030                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 14031                 END-IF
 14032                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 14033                 MOVE +9 TO N1
 14034              END-IF
 14035           END-PERFORM
 14036        END-IF
 14037     END-IF
 14038     .
 14039 1700-EXIT.
 14040     EXIT.
 14041 1800-REMOVE-CERT-NOTES.
 14042     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14043                                 TO ERNOTE-KEY
 14044
 14045* EXEC CICS READ
 14046*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 14047*       DATASET    (FILE-ID-ERNOTE)
 14048*       RIDFLD     (ERNOTE-KEY)
 14049*       RESP       (WS-RESPONSE)
 14050*       UPDATE
 14051*    END-EXEC
 14052*    MOVE '&"S        EU         (  N#00012806' TO DFHEIV0
 14053     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14054     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14055     MOVE X'204E233030303132383036' TO DFHEIV0(25:11)
 14056     CALL 'kxdfhei1' USING DFHEIV0,
 14057           FILE-ID-ERNOTE,
 14058           DFHEIV20,
 14059           DFHEIV99,
 14060           ERNOTE-KEY,
 14061           DFHEIV99,
 14062           DFHEIV99,
 14063           DFHEIV99
 14064     SET ADDRESS OF CERTIFICATE-NOTE TO
 14065         DFHEIV20
 14066     MOVE EIBRESP  TO WS-RESPONSE
 14067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14068     IF RESP-NORMAL
 14069        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 14070           (N1 > +10)
 14071           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 14072           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 14073        END-PERFORM
 14074        IF N1 < +11
 14075           MOVE SPACES              TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 256
* EL6311.cbl
 14076           IF N1 >= CN-BILLING-START-LINE-NO  AND
 14077              N1 <= CN-BILLING-END-LINE-NO
 14078              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 14079              IF CN-BILLING-END-LINE-NO <
 14080                               CN-BILLING-START-LINE-NO
 14081                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 14082                                     CN-BILLING-START-LINE-NO
 14083              END-IF
 14084              PERFORM 1820-SQUEEZE-ERNOTE
 14085                                  THRU 1820-EXIT
 14086           END-IF
 14087           IF CN-LINES = SPACES
 14088
 14089* EXEC CICS DELETE
 14090*                DATASET    (FILE-ID-ERNOTE)
 14091*                RESP       (WS-RESPONSE)
 14092*             END-EXEC
 14093*    MOVE '&(                    &  N#00012833' TO DFHEIV0
 14094     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14095     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14096     MOVE X'204E233030303132383333' TO DFHEIV0(25:11)
 14097     CALL 'kxdfhei1' USING DFHEIV0,
 14098           FILE-ID-ERNOTE,
 14099           DFHEIV99,
 14100           DFHEIV99,
 14101           DFHEIV99,
 14102           DFHEIV99
 14103     MOVE EIBRESP  TO WS-RESPONSE
 14104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14105              IF RESP-NORMAL
 14106                 MOVE 'D'        TO WS-NOTE-SW
 14107                 PERFORM 1520-UPDATE-ELCERT
 14108                                 THRU 1520-EXIT
 14109              END-IF
 14110           ELSE
 14111
 14112* EXEC CICS REWRITE
 14113*                DATASET    (FILE-ID-ERNOTE)
 14114*                FROM       (CERTIFICATE-NOTE)
 14115*                RESP       (WS-RESPONSE)
 14116*             END-EXEC
 14117     MOVE LENGTH OF
 14118      CERTIFICATE-NOTE
 14119       TO DFHEIV11
 14120*    MOVE '&& L                  %  N#00012843' TO DFHEIV0
 14121     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14122     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14123     MOVE X'204E233030303132383433' TO DFHEIV0(25:11)
 14124     CALL 'kxdfhei1' USING DFHEIV0,
 14125           FILE-ID-ERNOTE,
 14126           CERTIFICATE-NOTE,
 14127           DFHEIV11,
 14128           DFHEIV99
 14129     MOVE EIBRESP  TO WS-RESPONSE
 14130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14131           END-IF
 14132        END-IF
 14133     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 257
* EL6311.cbl
 14134     .
 14135 1800-EXIT.
 14136     EXIT.
 14137 1820-SQUEEZE-ERNOTE.
 14138     MOVE CN-BILLING-START-LINE-NO TO N2
 14139     IF N2 = 0
 14140         MOVE +1                 TO N2
 14141     END-IF
 14142     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 14143        (N1 > +9)
 14144        IF CN-LINE (N1) = SPACES
 14145           MOVE CN-LINE (N1 + +1)
 14146                                 TO CN-LINE (N1)
 14147           MOVE SPACES           TO CN-LINE (N1 + +1)
 14148        END-IF
 14149     END-PERFORM
 14150     .
 14151 1820-EXIT.
 14152     EXIT.
 14153 1900-DELETE-ERPYAJ.
 14154     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14155     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14156     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14157     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14158     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14159     MOVE +10                    TO ERPYAJ-SEQ-NO
 14160     MOVE 'R'                    TO ERPYAJ-TYPE
 14161     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14162
 14163* EXEC CICS STARTBR
 14164*       DATASET    (FILE-ID-ERPYAJ)
 14165*       RIDFLD     (ERPYAJ-KEY)
 14166*       RESP       (WS-RESPONSE)
 14167*    END-EXEC
 14168     MOVE 0
 14169       TO DFHEIV11
 14170*    MOVE '&,         G          &  N#00012879' TO DFHEIV0
 14171     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14172     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14173     MOVE X'204E233030303132383739' TO DFHEIV0(25:11)
 14174     CALL 'kxdfhei1' USING DFHEIV0,
 14175           FILE-ID-ERPYAJ,
 14176           ERPYAJ-KEY,
 14177           DFHEIV99,
 14178           DFHEIV11,
 14179           DFHEIV99
 14180     MOVE EIBRESP  TO WS-RESPONSE
 14181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14182     IF RESP-NORMAL
 14183        CONTINUE
 14184     ELSE
 14185        GO TO 1900-GET-DEALER
 14186     END-IF
 14187     .
 14188 1900-READNEXT-ERPYAJ-B.
 14189*  GET THE BANK ERPYAJ RECORD
 14190
 14191* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 258
* EL6311.cbl
 14192*       DATASET    (FILE-ID-ERPYAJ)
 14193*       RIDFLD     (ERPYAJ-KEY)
 14194*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14195*       RESP       (WS-RESPONSE)
 14196*    END-EXEC
 14197     MOVE 0
 14198       TO DFHEIV11
 14199*    MOVE '&.S                   )  N#00012892' TO DFHEIV0
 14200     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14201     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14202     MOVE X'204E233030303132383932' TO DFHEIV0(25:11)
 14203     CALL 'kxdfhei1' USING DFHEIV0,
 14204           FILE-ID-ERPYAJ,
 14205           DFHEIV20,
 14206           DFHEIV99,
 14207           ERPYAJ-KEY,
 14208           DFHEIV99,
 14209           DFHEIV11,
 14210           DFHEIV99,
 14211           DFHEIV99
 14212     SET ADDRESS OF PENDING-PAY-ADJ TO
 14213         DFHEIV20
 14214     MOVE EIBRESP  TO WS-RESPONSE
 14215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14216     IF RESP-NORMAL
 14217        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14218           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14219              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14220                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14221
 14222* EXEC CICS READ
 14223*                   DATASET    (FILE-ID-ERPYAJ)
 14224*                   RIDFLD     (ERPYAJ-KEY)
 14225*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14226*                   RESP       (WS-RESPONSE)
 14227*                   UPDATE
 14228*                END-EXEC
 14229*    MOVE '&"S        EU         (  N#00012903' TO DFHEIV0
 14230     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14231     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14232     MOVE X'204E233030303132393033' TO DFHEIV0(25:11)
 14233     CALL 'kxdfhei1' USING DFHEIV0,
 14234           FILE-ID-ERPYAJ,
 14235           DFHEIV20,
 14236           DFHEIV99,
 14237           ERPYAJ-KEY,
 14238           DFHEIV99,
 14239           DFHEIV99,
 14240           DFHEIV99
 14241     SET ADDRESS OF PENDING-PAY-ADJ TO
 14242         DFHEIV20
 14243     MOVE EIBRESP  TO WS-RESPONSE
 14244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14245                 IF RESP-NORMAL
 14246
 14247* EXEC CICS DELETE
 14248*                      DATASET   (FILE-ID-ERPYAJ)
 14249*                      RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 259
* EL6311.cbl
 14250*                   END-EXEC
 14251*    MOVE '&(                    &  N#00012911' TO DFHEIV0
 14252     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14253     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14254     MOVE X'204E233030303132393131' TO DFHEIV0(25:11)
 14255     CALL 'kxdfhei1' USING DFHEIV0,
 14256           FILE-ID-ERPYAJ,
 14257           DFHEIV99,
 14258           DFHEIV99,
 14259           DFHEIV99,
 14260           DFHEIV99
 14261     MOVE EIBRESP  TO WS-RESPONSE
 14262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14263                 END-IF
 14264              ELSE
 14265                 SET REVERSAL    TO TRUE
 14266                 PERFORM 1600-UPDATE-ERPYAJ
 14267                                 THRU 1600-EXIT
 14268                 GO TO 1900-EXIT
 14269              END-IF
 14270           ELSE
 14271              GO TO 1900-READNEXT-ERPYAJ-B
 14272           END-IF
 14273        END-IF
 14274
 14275* EXEC CICS ENDBR
 14276*          DATASET   (FILE-ID-ERPYAJ)
 14277*       END-EXEC
 14278     MOVE 0
 14279       TO DFHEIV11
 14280*    MOVE '&2                    $   #00012926' TO DFHEIV0
 14281     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14282     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14283     MOVE X'2020233030303132393236' TO DFHEIV0(25:11)
 14284     CALL 'kxdfhei1' USING DFHEIV0,
 14285           FILE-ID-ERPYAJ,
 14286           DFHEIV11,
 14287           DFHEIV99
 14288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14289     END-IF
 14290     .
 14291 1900-GET-DEALER.
 14292     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14293     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14294     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14295     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14296     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14297     MOVE +10                    TO ERPYAJ-SEQ-NO
 14298     MOVE 'C'                    TO ERPYAJ-TYPE
 14299     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14300
 14301* EXEC CICS STARTBR
 14302*       DATASET    (FILE-ID-ERPYAJ)
 14303*       RIDFLD     (ERPYAJ-KEY)
 14304*       RESP       (WS-RESPONSE)
 14305*    END-EXEC
 14306     MOVE 0
 14307       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 260
* EL6311.cbl
 14308*    MOVE '&,         G          &  N#00012940' TO DFHEIV0
 14309     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14310     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14311     MOVE X'204E233030303132393430' TO DFHEIV0(25:11)
 14312     CALL 'kxdfhei1' USING DFHEIV0,
 14313           FILE-ID-ERPYAJ,
 14314           ERPYAJ-KEY,
 14315           DFHEIV99,
 14316           DFHEIV11,
 14317           DFHEIV99
 14318     MOVE EIBRESP  TO WS-RESPONSE
 14319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14320     IF RESP-NORMAL
 14321        CONTINUE
 14322     ELSE
 14323        GO TO 1900-EXIT
 14324     END-IF
 14325     .
 14326 1900-READNEXT-ERPYAJ-D.
 14327*  GET THE DEALER ERPYAJ RECORD
 14328
 14329* EXEC CICS READNEXT
 14330*       DATASET    (FILE-ID-ERPYAJ)
 14331*       RIDFLD     (ERPYAJ-KEY)
 14332*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14333*       RESP       (WS-RESPONSE)
 14334*    END-EXEC
 14335     MOVE 0
 14336       TO DFHEIV11
 14337*    MOVE '&.S                   )  N#00012953' TO DFHEIV0
 14338     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14339     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14340     MOVE X'204E233030303132393533' TO DFHEIV0(25:11)
 14341     CALL 'kxdfhei1' USING DFHEIV0,
 14342           FILE-ID-ERPYAJ,
 14343           DFHEIV20,
 14344           DFHEIV99,
 14345           ERPYAJ-KEY,
 14346           DFHEIV99,
 14347           DFHEIV11,
 14348           DFHEIV99,
 14349           DFHEIV99
 14350     SET ADDRESS OF PENDING-PAY-ADJ TO
 14351         DFHEIV20
 14352     MOVE EIBRESP  TO WS-RESPONSE
 14353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14354     IF RESP-NORMAL
 14355        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14356           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14357              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14358                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14359
 14360* EXEC CICS READ
 14361*                   DATASET    (FILE-ID-ERPYAJ)
 14362*                   RIDFLD     (ERPYAJ-KEY)
 14363*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14364*                   RESP       (WS-RESPONSE)
 14365*                   UPDATE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 261
* EL6311.cbl
 14366*                END-EXEC
 14367*    MOVE '&"S        EU         (  N#00012964' TO DFHEIV0
 14368     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14369     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14370     MOVE X'204E233030303132393634' TO DFHEIV0(25:11)
 14371     CALL 'kxdfhei1' USING DFHEIV0,
 14372           FILE-ID-ERPYAJ,
 14373           DFHEIV20,
 14374           DFHEIV99,
 14375           ERPYAJ-KEY,
 14376           DFHEIV99,
 14377           DFHEIV99,
 14378           DFHEIV99
 14379     SET ADDRESS OF PENDING-PAY-ADJ TO
 14380         DFHEIV20
 14381     MOVE EIBRESP  TO WS-RESPONSE
 14382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14383                 IF RESP-NORMAL
 14384
 14385* EXEC CICS DELETE
 14386*                      DATASET   (FILE-ID-ERPYAJ)
 14387*                      RESP      (WS-RESPONSE)
 14388*                   END-EXEC
 14389*    MOVE '&(                    &  N#00012972' TO DFHEIV0
 14390     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14391     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14392     MOVE X'204E233030303132393732' TO DFHEIV0(25:11)
 14393     CALL 'kxdfhei1' USING DFHEIV0,
 14394           FILE-ID-ERPYAJ,
 14395           DFHEIV99,
 14396           DFHEIV99,
 14397           DFHEIV99,
 14398           DFHEIV99
 14399     MOVE EIBRESP  TO WS-RESPONSE
 14400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14401                 END-IF
 14402              ELSE
 14403                 SET REVERSAL    TO TRUE
 14404              END-IF
 14405           ELSE
 14406              GO TO 1900-READNEXT-ERPYAJ-D
 14407           END-IF
 14408        END-IF
 14409
 14410* EXEC CICS ENDBR
 14411*          DATASET   (FILE-ID-ERPYAJ)
 14412*       END-EXEC
 14413     MOVE 0
 14414       TO DFHEIV11
 14415*    MOVE '&2                    $   #00012984' TO DFHEIV0
 14416     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14417     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14418     MOVE X'2020233030303132393834' TO DFHEIV0(25:11)
 14419     CALL 'kxdfhei1' USING DFHEIV0,
 14420           FILE-ID-ERPYAJ,
 14421           DFHEIV11,
 14422           DFHEIV99
 14423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 262
* EL6311.cbl
 14424     END-IF
 14425     .
 14426 1900-EXIT.
 14427     EXIT.
 14428******************************************************************
 14429*            C A N C E L   M A I N L I N E                       *
 14430******************************************************************
 14431
 14432 2000-CANCEL-MAINLINE.
 14433     IF PI-DISPLAY-ORIGINAL-BATCH
 14434        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14435           MOVE ER-0023             TO EMI-ERROR
 14436           MOVE -1                  TO CMAINTL
 14437           MOVE AL-UABON            TO CMAINTA
 14438           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14439           GO TO 8200-SEND-DATAONLY
 14440        ELSE
 14441           NEXT SENTENCE
 14442     ELSE
 14443        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14444           MOVE ER-0023             TO EMI-ERROR
 14445           MOVE -1                  TO CMAINTL
 14446           MOVE AL-UABON            TO CMAINTA
 14447           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14448           GO TO 8200-SEND-DATAONLY.
 14449
 14450     IF CMAINTI = 'S'
 14451        GO TO 2100-SHOW-REQUEST.
 14452
 14453     IF NOT MODIFY-CAP
 14454         MOVE 'UPDATE'       TO SM-READ
 14455         PERFORM 9995-SECURITY-VIOLATION
 14456         MOVE ER-0070        TO EMI-ERROR
 14457         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14458         GO TO 8100-SEND-INITIAL-MAP.
 14459
 14460     IF CMAINTL GREATER THAN ZEROS
 14461        IF PI-PF6-FUNCTION
 14462           IF CMAINTI NOT = 'A'
 14463              MOVE AL-UABON  TO CMAINTA
 14464              MOVE -1        TO CMAINTL
 14465              MOVE ER-2260   TO EMI-ERROR
 14466              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14467              GO TO 8200-SEND-DATAONLY.
 14468
 14469     IF CCERTNOL = ZEROS
 14470       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14471         NEXT SENTENCE
 14472     ELSE
 14473         IF CCERTNOL NOT = ZEROS
 14474             MOVE AL-UANON       TO CCERTNOA
 14475         ELSE
 14476             MOVE -1             TO CCERTNOL
 14477             MOVE  1             TO SET-CURSOR-SW
 14478             MOVE ER-2218       TO EMI-ERROR
 14479             MOVE AL-UABON       TO CCERTNOA
 14480             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14481
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 263
* EL6311.cbl
 14482     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14483        NEXT SENTENCE
 14484     ELSE
 14485        IF CEFFDTL NOT = ZEROS
 14486           MOVE AL-UNNON         TO CEFFDTA
 14487           MOVE CEFFDTI TO DEEDIT-FIELD
 14488           PERFORM 8600-DEEDIT
 14489           MOVE 4                TO DC-OPTION-CODE
 14490           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14491           PERFORM 9700-DATE-LINK
 14492           IF NO-CONVERSION-ERROR
 14493              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14494              ELSE
 14495              MOVE -1            TO CEFFDTL
 14496              MOVE  1            TO SET-CURSOR-SW
 14497              MOVE ER-2226      TO EMI-ERROR
 14498              MOVE AL-UNBON      TO CEFFDTA
 14499              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14500          ELSE
 14501          MOVE -1                 TO CEFFDTL
 14502          MOVE  1                 TO SET-CURSOR-SW
 14503          MOVE ER-2220            TO EMI-ERROR
 14504          MOVE AL-UNBON           TO CEFFDTA
 14505          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14506
 14507     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14508
 14509     IF CCERTNOL NOT = ZEROS
 14510        MOVE CCERTNOI                TO WS-NEW-PRIME
 14511     ELSE
 14512        MOVE SPACES                  TO WS-NEW-PRIME.
 14513
 14514     IF CSUFIXL NOT = ZEROS
 14515        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14516     ELSE
 14517        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14518
 14519     IF CEFFDTL NOT = ZEROS
 14520        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14521     ELSE
 14522        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14523
 14524     IF CMAINTI = 'A' OR 'K' OR 'S'
 14525        NEXT SENTENCE
 14526     ELSE
 14527        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14528        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14529           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14530           WS-PB-RECORD-TYPE NOT = '2'
 14531           IF CMAINTI = 'C'
 14532              MOVE ER-2287          TO EMI-ERROR
 14533              MOVE -1               TO CCERTNOL
 14534              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14535              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14536              GO TO 8200-SEND-DATAONLY
 14537             ELSE
 14538              MOVE ER-2260          TO EMI-ERROR
 14539              MOVE -1               TO CCERTNOL
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 264
* EL6311.cbl
 14540              MOVE AL-UABON         TO CCERTNOA
 14541              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14542              GO TO 8200-SEND-DATAONLY.
 14543
 14544     IF CMAINTI = 'D'
 14545        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14546
 14547     IF CLSTNML GREATER THAN ZEROS
 14548         MOVE AL-UANON           TO CLSTNMA.
 14549
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 265
* EL6311.cbl
 14551
 14552******************************************************************
 14553*                                                                *
 14554*           E D I T   C A N C E L   C O V E R A G E S            *
 14555*                                                                *
 14556******************************************************************
 14557
 14558 2015-EDIT-COVERAGES.
 14559     IF CCANDT1L      GREATER THAN ZEROS OR
 14560        CREFND1L      GREATER THAN ZEROS OR
 14561        CCANDT2L      GREATER THAN ZEROS OR
 14562        CREFND2L      GREATER THAN ZEROS OR
 14563        CMTHD1L       GREATER THAN ZEROS OR
 14564        CMTHD2L       GREATER THAN ZEROS OR
 14565        CLIVESL       GREATER THAN ZEROS OR
 14566        CPAYEEL       GREATER THAN ZEROS OR
 14567        CFORCEL       GREATER THAN ZEROS OR
 14568        CBILCDL       GREATER THAN ZEROS OR
 14569        CCANREAL      GREATER THAN ZEROS
 14570            NEXT SENTENCE
 14571         ELSE
 14572            GO TO 2030-EDIT-COMPLETE.
 14573
 14574     IF CCANDT1L = ZEROS
 14575        AND (CMAINTI = 'C' OR 'K')
 14576        NEXT SENTENCE
 14577     ELSE
 14578        IF CCANDT1L      GREATER THAN ZEROS
 14579            MOVE AL-UNNON            TO CCANDT1A
 14580            IF CCANDT1I = SPACES
 14581               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14582            ELSE
 14583               MOVE CCANDT1I            TO DEEDIT-FIELD
 14584               PERFORM 8600-DEEDIT
 14585               IF DEEDIT-FIELD-V0   NUMERIC
 14586                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14587                  MOVE 4                TO DC-OPTION-CODE
 14588                  PERFORM 9700-DATE-LINK
 14589                  IF NO-CONVERSION-ERROR
 14590                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14591                  ELSE
 14592                      MOVE -1        TO CCANDT1L
 14593                      MOVE ER-2227   TO EMI-ERROR
 14594                      MOVE AL-UNBON  TO CCANDT1A
 14595                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14596               ELSE
 14597                  MOVE -1         TO CCANDT1L
 14598                  MOVE ER-2223    TO EMI-ERROR
 14599                  MOVE AL-UNBON   TO CCANDT1A
 14600                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14601        ELSE
 14602            IF CREFND1L GREATER THAN ZEROS
 14603               MOVE -1             TO CCANDT1L
 14604               MOVE ER-2222        TO EMI-ERROR
 14605               MOVE AL-UNBOF       TO CCANDT1A
 14606               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14607
 14608     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 266
* EL6311.cbl
 14609        AND (CMAINTI = 'C' OR 'K')
 14610         NEXT SENTENCE
 14611     ELSE
 14612         IF CREFND1L NOT = ZEROS
 14613            MOVE AL-UNNON        TO CREFND1A
 14614
 14615* EXEC CICS BIF DEEDIT
 14616*               FIELD  (CREFND1I)
 14617*               LENGTH (11)
 14618*           END-EXEC
 14619     MOVE 11
 14620       TO DFHEIV11
 14621*    MOVE '@"L                   #   #00013177' TO DFHEIV0
 14622     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14623     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14624     MOVE X'2020233030303133313737' TO DFHEIV0(25:11)
 14625     CALL 'kxdfhei1' USING DFHEIV0,
 14626           CREFND1I,
 14627           DFHEIV11
 14628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14629            MOVE CREFND1I        TO WS-CREFND1
 14630*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14631*           PERFORM 8600-DEEDIT
 14632*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14633            IF WS-CREFND1  = ZEROS
 14634               AND CMAINTI = 'A'
 14635             MOVE ER-2437        TO EMI-ERROR
 14636             MOVE -1             TO CREFND1L
 14637             MOVE AL-UNBON       TO CREFND1A
 14638             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14639
 14640     IF CCANREAL > +0
 14641        MOVE AL-UANON            TO CCANREAA
 14642        IF CCANREAI = 'R' OR ' '
 14643           CONTINUE
 14644        ELSE
 14645           MOVE ER-9841        TO EMI-ERROR
 14646           MOVE -1             TO CCANREAL
 14647           MOVE AL-UABON       TO CCANREAA
 14648           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14649        END-IF
 14650     END-IF
 14651     IF CMTHD1L EQUAL +0
 14652        NEXT SENTENCE
 14653     ELSE
 14654        IF CMTHD1L NOT = +0
 14655           MOVE AL-UNNON        TO CMTHD1A
 14656           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14657                         OR '5' OR '6' OR '8' OR '9'
 14658                         OR 'R' OR ' '
 14659              NEXT SENTENCE
 14660           ELSE
 14661              MOVE ER-0582        TO EMI-ERROR
 14662              MOVE -1             TO CMTHD1L
 14663              MOVE AL-UNBON       TO CMTHD1A
 14664              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14665
 14666     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 267
* EL6311.cbl
 14667        AND (CMAINTI = 'C' OR 'K')
 14668         NEXT SENTENCE
 14669     ELSE
 14670         IF CCANDT2L  GREATER THAN ZEROS
 14671             MOVE AL-UNNON       TO CCANDT2A
 14672             IF CCANDT2I = SPACES
 14673                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14674             ELSE
 14675                MOVE CCANDT2I       TO DEEDIT-FIELD
 14676                PERFORM 8600-DEEDIT
 14677                IF DEEDIT-FIELD-V0   NUMERIC
 14678                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14679                   MOVE 4                TO DC-OPTION-CODE
 14680                   PERFORM 9700-DATE-LINK
 14681                   IF NO-CONVERSION-ERROR
 14682                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14683                   ELSE
 14684                      MOVE -1       TO CCANDT2L
 14685                      MOVE ER-2227  TO EMI-ERROR
 14686                      MOVE AL-UNBON TO CCANDT2A
 14687                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14688                ELSE
 14689                   MOVE -1         TO CCANDT2L
 14690                   MOVE ER-2223    TO EMI-ERROR
 14691                   MOVE AL-UNBON   TO CCANDT2A
 14692                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14693         ELSE
 14694            IF CREFND2L GREATER THAN ZEROS
 14695               MOVE -1             TO CCANDT2L
 14696               MOVE ER-2222        TO EMI-ERROR
 14697               MOVE AL-UNBOF       TO CCANDT2A
 14698               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14699
 14700     IF CREFND2L = ZEROS
 14701        AND (CMAINTI = 'C' OR 'K')
 14702         NEXT SENTENCE
 14703     ELSE
 14704         IF CREFND2L NOT = ZEROS
 14705            MOVE AL-UNNON        TO CREFND2A
 14706
 14707* EXEC CICS BIF DEEDIT
 14708*               FIELD  (CREFND2I)
 14709*               LENGTH (11)
 14710*           END-EXEC
 14711     MOVE 11
 14712       TO DFHEIV11
 14713*    MOVE '@"L                   #   #00013258' TO DFHEIV0
 14714     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14715     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14716     MOVE X'2020233030303133323538' TO DFHEIV0(25:11)
 14717     CALL 'kxdfhei1' USING DFHEIV0,
 14718           CREFND2I,
 14719           DFHEIV11
 14720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14721            MOVE CREFND2I        TO WS-CREFND2
 14722*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14723*           PERFORM 8600-DEEDIT
 14724*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 268
* EL6311.cbl
 14725            IF WS-CREFND2  = ZEROS
 14726               AND CMAINTI = 'A'
 14727             MOVE ER-2437        TO EMI-ERROR
 14728             MOVE -1             TO CREFND2L
 14729             MOVE AL-UNBON       TO CREFND2A
 14730             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14731
 14732     IF CMTHD2L EQUAL +0
 14733        NEXT SENTENCE
 14734     ELSE
 14735        IF CMTHD2L NOT = +0
 14736           MOVE AL-UNNON        TO CMTHD2A
 14737           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14738                         OR '5' OR '6' OR '8' OR '9'
 14739                         OR ' ' OR 'R'
 14740              NEXT SENTENCE
 14741           ELSE
 14742              MOVE ER-0582        TO EMI-ERROR
 14743              MOVE -1             TO CMTHD2L
 14744              MOVE AL-UNBON       TO CMTHD2A
 14745              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14746
 14747     IF CLIVESL GREATER THAN ZEROS
 14748         MOVE CLIVESI            TO DEEDIT-FIELD
 14749         PERFORM 8600-DEEDIT
 14750         IF DEEDIT-FIELD-V0 NUMERIC
 14751             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14752             MOVE AL-UNNON       TO CLIVESA
 14753         ELSE
 14754             MOVE -1             TO CLIVESL
 14755             MOVE AL-UNBON       TO CLIVESA
 14756             MOVE ER-2223        TO EMI-ERROR
 14757             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14758
 14759     IF CFORCEL  NOT = ZEROS
 14760         IF FORCE-CAP
 14761            MOVE AL-UANON            TO CFORCEA
 14762         ELSE
 14763            MOVE ER-2945             TO EMI-ERROR
 14764            MOVE AL-UABON            TO CFORCEA
 14765            MOVE -1                  TO CFORCEL
 14766            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14767
 14768     IF CPAYEEL GREATER THAN ZEROS
 14769        MOVE AL-UANON            TO CPAYEEA.
 14770
 14771     IF CBILCDL NOT = ZEROS
 14772        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14773                             AND 'A' AND 'B' AND 'E'
 14774           MOVE ER-2225              TO EMI-ERROR
 14775           MOVE AL-UABON             TO CBILCDA
 14776           MOVE -1                   TO CBILCDL
 14777           MOVE  1                   TO SET-CURSOR-SW
 14778           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14779        ELSE
 14780           MOVE AL-UANON             TO CBILCDA.
 14781
 14782 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 269
* EL6311.cbl
 14783     IF EMI-ERROR = ZEROS
 14784         NEXT SENTENCE
 14785     ELSE
 14786         GO TO 8200-SEND-DATAONLY.
 14787
 14788     IF CMAINTI = 'A'
 14789        GO TO 2200-ADD-CANCEL-ROUTINE.
 14790
 14791     IF CMAINTI = 'C'
 14792        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14793
 14794     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14795
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 270
* EL6311.cbl
 14797
 14798******************************************************************
 14799*                                                                *
 14800*                   S H O W   C A N C E L                        *
 14801*                                                                *
 14802******************************************************************
 14803
 14804 2100-SHOW-REQUEST.
 14805     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14806
 14807     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14808        MOVE -1                  TO CMAINTL
 14809        GO TO 8200-SEND-DATAONLY.
 14810
 14811     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14812
 14813     IF CSUFIXL NOT = ZEROS
 14814        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14815       ELSE
 14816        MOVE SPACE            TO WS-NEW-SUFFIX.
 14817
 14818     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14819     PERFORM 8600-DEEDIT.
 14820     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14821     MOVE '4'                    TO DC-OPTION-CODE.
 14822     PERFORM 9700-DATE-LINK.
 14823     IF DATE-CONVERSION-ERROR
 14824        MOVE ER-0348             TO EMI-ERROR
 14825        MOVE -1                  TO CEFFDTL
 14826        MOVE AL-UABON            TO CEFFDTA
 14827        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14828        GO TO 8200-SEND-DATAONLY
 14829     ELSE
 14830        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14831        MOVE AL-UANON            TO CEFFDTA
 14832        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14833
 14834     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14835
 14836     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14837        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14838        MOVE 'Y'                    TO WS-SHOW-SW
 14839        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14840           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14841        ELSE
 14842           IF PI-FILE-BROWSE
 14843              GO TO 4300-BROWSE-FILE-FORWARD
 14844           ELSE
 14845              IF PI-CSR-BROWSE
 14846                 GO TO 4200-BROWSE-CSR-FORWARD
 14847              ELSE
 14848                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14849     ELSE
 14850        GO TO 3900-RE-DISPLAY-RECORD.
 14851
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 271
* EL6311.cbl
 14853
 14854
 14855******************************************************************
 14856*                                                                *
 14857*            A D D   C A N C E L   R O U T I N E                 *
 14858*                                                                *
 14859******************************************************************
 14860
 14861 2200-ADD-CANCEL-ROUTINE.
 14862     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14863
 14864
 14865* EXEC CICS GETMAIN
 14866*        SET     (ADDRESS OF PENDING-BUSINESS)
 14867*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14868*    END-EXEC.
 14869*    MOVE '," L                  $   #00013405' TO DFHEIV0
 14870     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14871     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14872     MOVE X'2020233030303133343035' TO DFHEIV0(25:11)
 14873     CALL 'kxdfhei1' USING DFHEIV0,
 14874           DFHEIV20,
 14875           ERPNDB-RECORD-LENGTH,
 14876           DFHEIV99
 14877     SET ADDRESS OF PENDING-BUSINESS TO
 14878         DFHEIV20
 14879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14880
 14881
 14882
 14883* EXEC CICS HANDLE CONDITION
 14884*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14885*    END-EXEC.
 14886*    MOVE '"$I                   ! 3 #00013410' TO DFHEIV0
 14887     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14888     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14889     MOVE X'3320233030303133343130' TO DFHEIV0(25:11)
 14890     CALL 'kxdfhei1' USING DFHEIV0
 14891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14892
 14893
 14894     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14895     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14896     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14897
 14898
 14899* EXEC CICS READ
 14900*        INTO    (PENDING-BUSINESS)
 14901*        DATASET (FILE-ID-ERPNDB)
 14902*        RIDFLD  (ERPNDB-KEY)
 14903*    END-EXEC.
 14904     MOVE LENGTH OF
 14905      PENDING-BUSINESS
 14906       TO DFHEIV11
 14907*    MOVE '&"IL       E          (   #00013418' TO DFHEIV0
 14908     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14909     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14910     MOVE X'2020233030303133343138' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 272
* EL6311.cbl
 14911     CALL 'kxdfhei1' USING DFHEIV0,
 14912           FILE-ID-ERPNDB,
 14913           PENDING-BUSINESS,
 14914           DFHEIV11,
 14915           ERPNDB-KEY,
 14916           DFHEIV99,
 14917           DFHEIV99,
 14918           DFHEIV99
 14919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14920
 14921
 14922     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14923
 14924     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14925     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14926     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14927     MOVE SPACES                 TO PENDING-BUSINESS.
 14928     MOVE 'PB'                   TO PB-RECORD-ID.
 14929     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14930     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14931     MOVE SPACES                 TO PB-CERT-SFX.
 14932     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14933     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14934                                    PB-ALT-CHG-SEQ-NO.
 14935
 14936     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14937     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14938     MOVE '2'                    TO PB-RECORD-TYPE.
 14939
 14940     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14941     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14942
 14943
 14944     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14945                                    PB-ALT-CHG-SEQ-NO
 14946                                    PB-C-LF-REF-CALC
 14947                                    PB-C-AH-REF-CALC
 14948                                    PB-C-LF-RFND-CLP
 14949                                    PB-C-AH-RFND-CLP
 14950                                    PB-CI-INSURED-AGE
 14951                                    PB-CI-LF-TERM
 14952                                    PB-CI-AH-TERM
 14953                                    PB-CI-LF-BENEFIT-CD
 14954                                    PB-CI-LF-BENEFIT-AMT
 14955                                    PB-CI-LF-ALT-BENEFIT-AMT
 14956                                    PB-CI-LF-PREMIUM-AMT
 14957                                    PB-CI-LF-ALT-PREMIUM-AMT
 14958                                    PB-CI-AH-BENEFIT-CD
 14959                                    PB-CI-AH-BENEFIT-AMT
 14960                                    PB-CI-AH-PREMIUM-AMT
 14961                                    PB-CI-PAY-FREQUENCY
 14962                                    PB-CI-LOAN-APR
 14963                                    PB-CI-LOAN-TERM
 14964                                    PB-CI-LIFE-COMMISSION
 14965                                    PB-CI-AH-COMMISSION
 14966                                    PB-CI-CURR-SEQ
 14967                                    PB-CI-AH-CANCEL-AMT
 14968                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 273
* EL6311.cbl
 14969                                    PB-CI-RATE-DEV-PCT-LF
 14970                                    PB-CI-RATE-DEV-PCT-AH
 14971                                    PB-CI-EXTENTION-DAYS
 14972                                    PB-CI-TERM-IN-DAYS
 14973                                    PB-CI-LIVES
 14974                                    PB-CI-LF-CRIT-PER
 14975                                    PB-CI-AH-CRIT-PER
 14976                                    PB-C-LF-REM-TERM
 14977                                    PB-C-AH-REM-TERM
 14978                                    PB-CHG-COUNT
 14979                                    PB-LF-BILLED-AMTS
 14980                                    PB-AH-BILLED-AMTS
 14981                                    PB-C-INT-ON-REFS
 14982*                                   PB-C-MICROFILM-NO
 14983                                    PB-CALC-TOLERANCE.
 14984
 14985     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14986                                    PB-CI-AH-SETTLEMENT-DT
 14987                                    PB-CI-DEATH-DT
 14988                                    PB-CI-LF-PRIOR-CANCEL-DT
 14989                                    PB-CI-AH-PRIOR-CANCEL-DT
 14990                                    PB-CI-ENTRY-DT
 14991                                    PB-CI-LF-EXPIRE-DT
 14992                                    PB-CI-AH-EXPIRE-DT
 14993                                    PB-CI-LOAN-1ST-PMT-DT
 14994                                    PB-C-LF-CANCEL-DT
 14995                                    PB-C-AH-CANCEL-DT
 14996                                    PB-CREDIT-ACCEPT-DT
 14997                                    PB-BILLED-DT
 14998                                    PB-ACCT-EFF-DT
 14999                                    PB-ACCT-EXP-DT.
 15000
 15001     MOVE 'X'                    TO PB-FATAL-FLAG.
 15002
 15003     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 15004
 15005     IF CSUFIXL     GREATER THAN ZEROS
 15006        MOVE CSUFIXI             TO PB-CERT-SFX.
 15007
 15008*    IF CMICRNOL  GREATER  ZEROS
 15009*        IF CMICRNOI  NUMERIC
 15010*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15011*            MOVE AL-UNNON       TO  CMICRNOA
 15012*        ELSE
 15013*            MOVE -1             TO  CMICRNOL
 15014*            MOVE AL-UNBON       TO  CMICRNOA
 15015*            MOVE ER-2701        TO  EMI-ERROR
 15016*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15017
 15018     IF CLSTNML     GREATER THAN ZEROS
 15019        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 15020
 15021     IF CCANREAL > ZEROS
 15022        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15023     END-IF
 15024     IF CPCYNL > ZEROS
 15025        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15026     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 274
* EL6311.cbl
 15027     IF CCANDT1L    GREATER THAN ZEROS
 15028        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15029
 15030     IF CCANDT2L    GREATER THAN ZEROS
 15031        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15032
 15033     IF CMTHD1L    GREATER THAN +0
 15034        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15035
 15036     IF CMTHD2L    GREATER THAN +0
 15037        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15038
 15039     IF CREFND1L    GREATER THAN ZEROS
 15040        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15041        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15042     ELSE
 15043        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 15044
 15045     IF CREFND2L    GREATER THAN ZEROS
 15046        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15047        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15048     ELSE
 15049        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 15050
 15051     IF CLIVESL     GREATER THAN ZEROS
 15052        MOVE WS-CLIVES           TO PB-C-LIVES
 15053     ELSE
 15054        MOVE ZEROS               TO PB-C-LIVES.
 15055
 15056     IF CPAYEEL     GREATER THAN ZEROS
 15057        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15058
 15059     IF CFORCEL     GREATER THAN ZEROS
 15060        MOVE CFORCEI             TO PB-FORCE-CODE.
 15061
 15062     IF CBILCDL     GREATER THAN ZEROS
 15063        MOVE CBILCDI             TO PB-RECORD-BILL.
 15064
 15065*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 15066
 15067 2260-WRITE-PB-RECORD.
 15068     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 15069                                    PB-INPUT-BY.
 15070     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15071     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 15072                                    PB-INPUT-DT.
 15073
 15074     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15075     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15076                                    PB-CONTROL-BY-ORIG-BATCH.
 15077
 15078     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 15079     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 15080     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 15081     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 15082     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 15083
 15084     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 275
* EL6311.cbl
 15085
 15086     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15087
 15088     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15089     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15090     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15091
 15092     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15093     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15094
 15095 2275-WRITE-PENDING-BUSINESS.
 15096     MOVE 'A'                    TO JP-RECORD-TYPE.
 15097     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15098     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15099     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15100
 15101
 15102* EXEC CICS HANDLE CONDITION
 15103*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 15104*    END-EXEC.
 15105*    MOVE '"$%                   ! 4 #00013603' TO DFHEIV0
 15106     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15108     MOVE X'3420233030303133363033' TO DFHEIV0(25:11)
 15109     CALL 'kxdfhei1' USING DFHEIV0
 15110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15111
 15112
 15113
 15114* EXEC CICS WRITE
 15115*        DATASET (FILE-ID-ERPNDB)
 15116*        FROM    (PENDING-BUSINESS)
 15117*        RIDFLD  (PB-CONTROL-PRIMARY)
 15118*    END-EXEC.
 15119     MOVE LENGTH OF
 15120      PENDING-BUSINESS
 15121       TO DFHEIV11
 15122*    MOVE '&$ L                  ''   #00013607' TO DFHEIV0
 15123     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15124     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15125     MOVE X'2020233030303133363037' TO DFHEIV0(25:11)
 15126     CALL 'kxdfhei1' USING DFHEIV0,
 15127           FILE-ID-ERPNDB,
 15128           PENDING-BUSINESS,
 15129           DFHEIV11,
 15130           PB-CONTROL-PRIMARY,
 15131           DFHEIV99,
 15132           DFHEIV99
 15133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15134
 15135
 15136     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 15137
 15138     PERFORM 8400-LOG-JOURNAL-RECORD.
 15139
 15140******************************************************************
 15141*       A D D  O R I G I N A L  C E R T  I N F O                 *
 15142******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 276
* EL6311.cbl
 15143
 15144     display ' made it to add orig CANCEL cert '
 15145     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15146     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15147     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15148     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15149
 15150
 15151* EXEC CICS READ
 15152*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15153*        DATASET (FILE-ID-ELCERT)
 15154*        RIDFLD  (ELCERT-KEY)
 15155*        RESP    (WS-RESPONSE)
 15156*    END-EXEC.
 15157*    MOVE '&"S        E          (  N#00013627' TO DFHEIV0
 15158     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15159     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15160     MOVE X'204E233030303133363237' TO DFHEIV0(25:11)
 15161     CALL 'kxdfhei1' USING DFHEIV0,
 15162           FILE-ID-ELCERT,
 15163           DFHEIV20,
 15164           DFHEIV99,
 15165           ELCERT-KEY,
 15166           DFHEIV99,
 15167           DFHEIV99,
 15168           DFHEIV99
 15169     SET ADDRESS OF CERTIFICATE-MASTER TO
 15170         DFHEIV20
 15171     MOVE EIBRESP  TO WS-RESPONSE
 15172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15173
 15174
 15175     IF NOT RESP-NORMAL
 15176        GO TO 2276-BYPASS-CRTO
 15177     END-IF
 15178
 15179     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15180     MOVE ' '                    TO WS-ERMAIL-SW
 15181
 15182
 15183* EXEC CICS READ
 15184*       DATASET   (FILE-ID-ERMAIL)
 15185*       SET       (ADDRESS OF MAILING-DATA)
 15186*       RIDFLD    (ERMAIL-KEY)
 15187*       RESP      (WS-RESPONSE)
 15188*    END-EXEC
 15189*    MOVE '&"S        E          (  N#00013641' TO DFHEIV0
 15190     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15191     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15192     MOVE X'204E233030303133363431' TO DFHEIV0(25:11)
 15193     CALL 'kxdfhei1' USING DFHEIV0,
 15194           FILE-ID-ERMAIL,
 15195           DFHEIV20,
 15196           DFHEIV99,
 15197           ERMAIL-KEY,
 15198           DFHEIV99,
 15199           DFHEIV99,
 15200           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 277
* EL6311.cbl
 15201     SET ADDRESS OF MAILING-DATA TO
 15202         DFHEIV20
 15203     MOVE EIBRESP  TO WS-RESPONSE
 15204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15205
 15206     IF RESP-NORMAL
 15207        SET ERMAIL-FOUND TO TRUE
 15208     END-IF
 15209
 15210     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15211
 15212     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 15213     MOVE 'OC'                   TO OC-RECORD-ID
 15214     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15215                                 TO OC-CONTROL-PRIMARY (1:33)
 15216     MOVE 'I'                    TO OC-RECORD-TYPE
 15217     MOVE +4096                  TO OC-KEY-SEQ-NO
 15218     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15219     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15220     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15221
 15222     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15223     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15224     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15225     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15226     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15227     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15228     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15229     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15230     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15231     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15232     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15233     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15234     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15235     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15236     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15237     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15238     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15239     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15240     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15241     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15242     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15243     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15244     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15245     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15246     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15247     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15248     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15249     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15250     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15251     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15252     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15253     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15254
 15255     IF ERMAIL-FOUND
 15256        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15257     END-IF
 15258     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 278
* EL6311.cbl
 15259        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15260                           OC-INS-AGE-DEFAULT-FLAG
 15261        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15262                           OC-JNT-AGE-DEFAULT-FLAG
 15263     END-IF
 15264     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15265     .
 15266 2275-WRITE-ELCRTO.
 15267
 15268
 15269* EXEC CICS WRITE
 15270*       DATASET   ('ELCRTO')
 15271*       FROM      (ORIGINAL-CERTIFICATE)
 15272*       RIDFLD    (OC-CONTROL-PRIMARY)
 15273*       RESP      (WS-RESPONSE)
 15274*    END-EXEC
 15275     MOVE LENGTH OF
 15276      ORIGINAL-CERTIFICATE
 15277       TO DFHEIV11
 15278     MOVE 'ELCRTO' TO DFHEIV1
 15279*    MOVE '&$ L                  ''  N#00013710' TO DFHEIV0
 15280     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15281     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15282     MOVE X'204E233030303133373130' TO DFHEIV0(25:11)
 15283     CALL 'kxdfhei1' USING DFHEIV0,
 15284           DFHEIV1,
 15285           ORIGINAL-CERTIFICATE,
 15286           DFHEIV11,
 15287           OC-CONTROL-PRIMARY,
 15288           DFHEIV99,
 15289           DFHEIV99
 15290     MOVE EIBRESP  TO WS-RESPONSE
 15291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15292
 15293     display ' just wrote 2275 ' ws-response
 15294     IF RESP-DUPKEY
 15295        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15296        GO TO 2275-WRITE-ELCRTO
 15297     ELSE
 15298        IF NOT RESP-NORMAL
 15299           MOVE -1               TO BMAINTL
 15300           MOVE ER-7450          TO EMI-ERROR
 15301           PERFORM 9900-ERROR-FORMAT
 15302                                 THRU 9900-EXIT
 15303           GO TO 8200-SEND-DATAONLY
 15304        END-IF
 15305     END-IF.
 15306
 15307 2276-BYPASS-CRTO.
 15308******************************************************************
 15309*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15310******************************************************************
 15311
 15312
 15313* EXEC CICS READ
 15314*        INTO    (PENDING-BUSINESS)
 15315*        DATASET (FILE-ID-ERPNDB)
 15316*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 279
* EL6311.cbl
 15317*        UPDATE
 15318*    END-EXEC.
 15319     MOVE LENGTH OF
 15320      PENDING-BUSINESS
 15321       TO DFHEIV11
 15322*    MOVE '&"IL       EU         (   #00013736' TO DFHEIV0
 15323     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15324     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15325     MOVE X'2020233030303133373336' TO DFHEIV0(25:11)
 15326     CALL 'kxdfhei1' USING DFHEIV0,
 15327           FILE-ID-ERPNDB,
 15328           PENDING-BUSINESS,
 15329           DFHEIV11,
 15330           ERPNDB-KEY,
 15331           DFHEIV99,
 15332           DFHEIV99,
 15333           DFHEIV99
 15334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15335
 15336
 15337     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15338     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15339     MOVE 'B'                    TO JP-RECORD-TYPE.
 15340     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15341
 15342     PERFORM 8400-LOG-JOURNAL-RECORD.
 15343
 15344     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15345
 15346
 15347* EXEC CICS REWRITE
 15348*        DATASET (FILE-ID-ERPNDB)
 15349*        FROM    (PENDING-BUSINESS)
 15350*    END-EXEC.
 15351     MOVE LENGTH OF
 15352      PENDING-BUSINESS
 15353       TO DFHEIV11
 15354*    MOVE '&& L                  %   #00013752' TO DFHEIV0
 15355     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15356     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15357     MOVE X'2020233030303133373532' TO DFHEIV0(25:11)
 15358     CALL 'kxdfhei1' USING DFHEIV0,
 15359           FILE-ID-ERPNDB,
 15360           PENDING-BUSINESS,
 15361           DFHEIV11,
 15362           DFHEIV99
 15363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15364
 15365
 15366     MOVE 'C'                    TO JP-RECORD-TYPE.
 15367     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15368
 15369     PERFORM 8400-LOG-JOURNAL-RECORD.
 15370
 15371     IF WS-ERRORS-PRESENT
 15372        GO TO 3900-RE-DISPLAY-RECORD.
 15373
 15374     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 280
* EL6311.cbl
 15375     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15376     MOVE LOW-VALUES             TO EL631CI.
 15377     MOVE  -1                    TO CMAINTL.
 15378     GO TO 8100-SEND-INITIAL-MAP.
 15379
 15380 2280-BATCH-HDR-NOT-FOUND.
 15381     MOVE -1                     TO BMAINTL.
 15382     MOVE ER-7450                TO EMI-ERROR.
 15383     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15384     GO TO 8200-SEND-DATAONLY.
 15385
 15386 2290-DUPLICATE-ALT-INDEX.
 15387
 15388******************************************************************
 15389*                                                                *
 15390*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15391*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15392*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15393*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15394*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15395*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15396*                                                                *
 15397******************************************************************
 15398
 15399     IF LCP-ONCTR-02 =  0
 15400         ADD 1 TO LCP-ONCTR-02
 15401        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15402
 15403     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15404
 15405     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15406         NEXT SENTENCE
 15407     ELSE
 15408         ADD +1 TO PB-BATCH-SEQ-NO
 15409                   PB-CSR-BATCH-SEQ-NO
 15410         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15411         GO TO 2275-WRITE-PENDING-BUSINESS.
 15412
 15413     MOVE -1                     TO CCERTNOL.
 15414     MOVE AL-UABON               TO CCERTNOA.
 15415     MOVE AL-UNBON               TO CEFFDTA.
 15416
 15417     MOVE 1                      TO EMI-SUB
 15418                                    EMI-SWITCH1
 15419                                    EMI-SWITCH-AREA-1
 15420                                    EMI-SWITCH-AREA-2.
 15421
 15422     MOVE SPACES                 TO EMI-ERROR-LINES.
 15423
 15424
 15425* EXEC CICS SYNCPOINT ROLLBACK
 15426*    END-EXEC.
 15427*    MOVE '6"R                   !   #00013815' TO DFHEIV0
 15428     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15430     MOVE X'2020233030303133383135' TO DFHEIV0(25:11)
 15431     CALL 'kxdfhei1' USING DFHEIV0
 15432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 281
* EL6311.cbl
 15433
 15434
 15435     MOVE ER-2247                TO EMI-ERROR.
 15436     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15437     GO TO 8200-SEND-DATAONLY.
 15438
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 282
* EL6311.cbl
 15440
 15441******************************************************************
 15442*                                                                *
 15443*          C H A N G E   C A N C E L   R O U T I N E             *
 15444*                                                                *
 15445******************************************************************
 15446
 15447***************************************************************
 15448*                                                             *
 15449*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15450*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15451*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15452*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15453*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15454*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15455*     5. LINK TO THE EDIT ROUTINE.                            *
 15456*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15457*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15458*              THE EDIT ROUTINE.                              *
 15459*     7. REWRITE THE NEW ISSUE                                *
 15460*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15461*                                                             *
 15462***************************************************************
 15463 2300-CHANGE-CANCEL-ROUTINE.
 15464     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15465
 15466     IF CCHGL NOT = ZEROS
 15467        MOVE ER-2196             TO EMI-ERROR
 15468        MOVE AL-UABON            TO CMAINTA
 15469        MOVE -1                  TO CMAINTL
 15470        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15471        GO TO 8200-SEND-DATAONLY.
 15472
 15473     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15474
 15475     IF CSUFIXL NOT = ZEROS
 15476        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15477     ELSE
 15478        MOVE SPACE               TO WS-NEW-SUFFIX.
 15479
 15480     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15481     PERFORM 8600-DEEDIT.
 15482     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15483     MOVE '4'                    TO DC-OPTION-CODE.
 15484
 15485     PERFORM 9700-DATE-LINK.
 15486
 15487     IF DATE-CONVERSION-ERROR
 15488        MOVE ER-0348             TO EMI-ERROR
 15489        MOVE -1                  TO CEFFDTL
 15490        MOVE AL-UABON            TO CEFFDTA
 15491        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15492        GO TO 8200-SEND-DATAONLY
 15493     ELSE
 15494        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15495        MOVE AL-UANON            TO CEFFDTA
 15496        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15497
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 283
* EL6311.cbl
 15498 2325-PROCESS-CANCEL-CHANGES.
 15499
 15500* EXEC CICS HANDLE CONDITION
 15501*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15502*    END-EXEC.
 15503*    MOVE '"$I                   ! 5 #00013882' TO DFHEIV0
 15504     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15505     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15506     MOVE X'3520233030303133383832' TO DFHEIV0(25:11)
 15507     CALL 'kxdfhei1' USING DFHEIV0
 15508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15509
 15510
 15511     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15512     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15513     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15514
 15515
 15516* EXEC CICS GETMAIN
 15517*        SET      (ADDRESS OF PENDING-BUSINESS)
 15518*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15519*        INITIMG  (GETMAIN-SPACE)
 15520*     END-EXEC.
 15521*    MOVE ',"IL                  $   #00013890' TO DFHEIV0
 15522     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15523     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15524     MOVE X'2020233030303133383930' TO DFHEIV0(25:11)
 15525     CALL 'kxdfhei1' USING DFHEIV0,
 15526           DFHEIV20,
 15527           ERPNDB-RECORD-LENGTH,
 15528           GETMAIN-SPACE
 15529     SET ADDRESS OF PENDING-BUSINESS TO
 15530         DFHEIV20
 15531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15532
 15533
 15534
 15535* EXEC CICS READ
 15536*        INTO    (PENDING-BUSINESS)
 15537*        DATASET (FILE-ID-ERPNDB)
 15538*        RIDFLD  (ERPNDB-KEY)
 15539*    END-EXEC.
 15540     MOVE LENGTH OF
 15541      PENDING-BUSINESS
 15542       TO DFHEIV11
 15543*    MOVE '&"IL       E          (   #00013896' TO DFHEIV0
 15544     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15545     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15546     MOVE X'2020233030303133383936' TO DFHEIV0(25:11)
 15547     CALL 'kxdfhei1' USING DFHEIV0,
 15548           FILE-ID-ERPNDB,
 15549           PENDING-BUSINESS,
 15550           DFHEIV11,
 15551           ERPNDB-KEY,
 15552           DFHEIV99,
 15553           DFHEIV99,
 15554           DFHEIV99
 15555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 284
* EL6311.cbl
 15556
 15557
 15558     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15559
 15560
 15561* EXEC CICS HANDLE CONDITION
 15562*         NOTFND     (2385-REC-NOT-FOUND)
 15563*    END-EXEC.
 15564*    MOVE '"$I                   ! 6 #00013904' TO DFHEIV0
 15565     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15566     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15567     MOVE X'3620233030303133393034' TO DFHEIV0(25:11)
 15568     CALL 'kxdfhei1' USING DFHEIV0
 15569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15570
 15571
 15572**********************************************************
 15573*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15574*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15575**********************************************************
 15576
 15577
 15578* EXEC CICS READ
 15579*        DATASET (FILE-ID-ERPNDB)
 15580*        INTO    (PENDING-BUSINESS)
 15581*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15582*    END-EXEC.
 15583     MOVE LENGTH OF
 15584      PENDING-BUSINESS
 15585       TO DFHEIV11
 15586*    MOVE '&"IL       E          (   #00013913' TO DFHEIV0
 15587     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15588     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15589     MOVE X'2020233030303133393133' TO DFHEIV0(25:11)
 15590     CALL 'kxdfhei1' USING DFHEIV0,
 15591           FILE-ID-ERPNDB,
 15592           PENDING-BUSINESS,
 15593           DFHEIV11,
 15594           PI-PREV-CONTROL-PRIMARY,
 15595           DFHEIV99,
 15596           DFHEIV99,
 15597           DFHEIV99
 15598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15599
 15600
 15601********** DO NOT ALLOW CHANGES IF THRU A/R
 15602     IF BMAINTI = 'C'
 15603         IF PB-EL860-INTERNAL-PROCESS
 15604             MOVE ER-4005          TO EMI-ERROR
 15605             MOVE -1               TO BMAINTL
 15606             MOVE AL-UABON         TO BMAINTA
 15607             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15608             GO TO 8200-SEND-DATAONLY.
 15609**********
 15610
 15611     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15612        MOVE -1                 TO CMAINTL
 15613        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 285
* EL6311.cbl
 15614        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15615        GO TO 8200-SEND-DATAONLY.
 15616
 15617     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15618        MOVE ER-2196             TO EMI-ERROR
 15619        MOVE AL-UABON            TO CMAINTA
 15620        MOVE -1                  TO CMAINTL
 15621        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15622        GO TO 8200-SEND-DATAONLY.
 15623     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15624
 15625     IF PB-BILLED-DT = LOW-VALUES AND
 15626        PB-CHG-COUNT = ZEROS
 15627        NEXT SENTENCE
 15628     ELSE
 15629        IF (CREFND1L GREATER THAN ZEROS AND
 15630            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15631           OR
 15632           (CREFND2L GREATER THAN ZEROS AND
 15633            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15634           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15635     if ((crefnd1l <> zeros)
 15636        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15637                      or
 15638        ((crefnd2l <> zeros)
 15639        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15640        continue
 15641     else
 15642        go to 2330-continue-change
 15643     end-if
 15644
 15645     move zeros                  to ws-check-amts
 15646     move ' '                    to ws-stop-sw
 15647                                    ws-check-sw
 15648                                    ws-any-check-sw
 15649                                    ws-proc-check-sw
 15650                                    ws-chek-browse-sw
 15651
 15652     perform 2500-browse-checks  thru 2500-exit
 15653
 15654     if i-have-processed-checks
 15655        or i-have-checks
 15656        continue
 15657     else
 15658        go to 2330-continue-change
 15659     end-if
 15660
 15661     if crefnd1l <> zeros
 15662        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15663        move ws-crefnd1 to ws-new-ref-total
 15664     else
 15665        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15666     end-if
 15667     if crefnd2l <> zeros
 15668        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15669        compute ws-new-ref-total = ws-new-ref-total +
 15670           ws-crefnd2
 15671     else
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 286
* EL6311.cbl
 15672        compute ws-new-ref-total = ws-new-ref-total +
 15673           pb-c-ah-cancel-amt
 15674     end-if
 15675
 15676     if zeros = (ws-lf-diff + ws-ah-diff)
 15677        move er-3449             to emi-error
 15678        perform 9900-error-format thru 9900-exit
 15679        go to 2330-continue-change
 15680     end-if
 15681
 15682     if (ws-new-ref-total < ws-check-amts)
 15683        and (pb-c-refund-sw = 'Y')
 15684        move er-3447             to emi-error
 15685        perform 9900-error-format thru 9900-exit
 15686        move al-uabon            to cmainta
 15687        move -1                  to cmaintl
 15688        go to 8200-send-dataonly
 15689     end-if
 15690
 15691     if (ws-new-ref-total > ws-check-amts)
 15692        and (ws-check-amts not = zeros)
 15693        move er-3448             to emi-error
 15694        move al-uabon            to crefnd1a
 15695                                    crefnd2a
 15696        perform 9900-error-format thru 9900-exit
 15697     end-if
 15698
 15699*     if (ws-lf-diff + ws-ah-diff) < zeros
 15700*        move er-3447             to emi-error
 15701*        perform 9900-error-format thru 9900-exit
 15702*        move al-uabon            to cmainta
 15703*        move -1                  to cmaintl
 15704*        go to 8200-send-dataonly
 15705*     end-if
 15706     .
 15707 2330-continue-change.
 15708
 15709
 15710* EXEC CICS READ
 15711*        DATASET (FILE-ID-ERPNDB)
 15712*        INTO    (PENDING-BUSINESS)
 15713*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15714*        UPDATE
 15715*    END-EXEC.
 15716     MOVE LENGTH OF
 15717      PENDING-BUSINESS
 15718       TO DFHEIV11
 15719*    MOVE '&"IL       EU         (   #00014027' TO DFHEIV0
 15720     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15721     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15722     MOVE X'2020233030303134303237' TO DFHEIV0(25:11)
 15723     CALL 'kxdfhei1' USING DFHEIV0,
 15724           FILE-ID-ERPNDB,
 15725           PENDING-BUSINESS,
 15726           DFHEIV11,
 15727           PI-PREV-CONTROL-PRIMARY,
 15728           DFHEIV99,
 15729           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 287
* EL6311.cbl
 15730           DFHEIV99
 15731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15732
 15733
 15734     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15735     MOVE 'B'                    TO JP-RECORD-TYPE
 15736     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15737     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15738
 15739     PERFORM 8400-LOG-JOURNAL-RECORD.
 15740
 15741     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15742          PB-CHG-COUNT NOT = ZEROS
 15743        IF (CREFND1L GREATER THAN ZEROS AND
 15744            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15745           OR
 15746           (CREFND2L GREATER THAN ZEROS AND
 15747            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15748            ADD +1                      TO PB-CHG-COUNT
 15749            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15750
 15751*    IF CMICRNOL  GREATER  ZEROS
 15752*        IF CMICRNOI  NUMERIC
 15753*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15754*            MOVE AL-UNNON       TO  CMICRNOA
 15755*        ELSE
 15756*            MOVE -1             TO  CMICRNOL
 15757*            MOVE AL-UNBON       TO  CMICRNOA
 15758*            MOVE ER-2701        TO  EMI-ERROR
 15759*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15760
 15761     IF CSUFIXL GREATER THAN ZEROS
 15762        MOVE CSUFIXI             TO PB-CERT-SFX.
 15763
 15764     IF CLSTNML GREATER THAN ZEROS
 15765         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15766
 15767     IF CCANREAL > ZEROS
 15768        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15769     END-IF
 15770     IF CPCYNL > ZEROS
 15771        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15772     END-IF
 15773     IF CCANDT1L    GREATER THAN ZEROS
 15774        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15775
 15776     IF CCANDT2L    GREATER THAN ZEROS
 15777        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15778
 15779     IF CMTHD1L    GREATER THAN +0
 15780        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15781
 15782     IF CMTHD2L    GREATER THAN +0
 15783        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15784
 15785     IF CREFND1L    GREATER THAN ZEROS
 15786        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15787        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 288
* EL6311.cbl
 15788        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15789        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15790
 15791     IF CREFND2L    GREATER THAN ZEROS
 15792        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15793        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15794        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15795        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15796
 15797     IF CLIVESL     GREATER THAN ZEROS
 15798        MOVE WS-CLIVES           TO PB-C-LIVES.
 15799
 15800     IF CPAYEEL     GREATER THAN ZEROS
 15801        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15802
 15803     IF CFORCEL     GREATER THAN ZEROS
 15804        MOVE CFORCEI             TO PB-FORCE-CODE.
 15805
 15806     IF CBILCDL     GREATER THAN ZEROS
 15807        MOVE CBILCDI             TO PB-RECORD-BILL.
 15808
 15809 2360-REWRITE-PB-RECORD.
 15810     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15811     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15812     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15813     MOVE 'C'                    TO JP-RECORD-TYPE.
 15814     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15815     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15816     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15817
 15818     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15819
 15820     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15821     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15822
 15823     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15824
 15825     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15826
 15827     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15828     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15829     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15830
 15831     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15832     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15833
 15834 2375-REWRITE-PENDING-BUSINESS.
 15835     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15836     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15837     MOVE 'C'                    TO JP-RECORD-TYPE.
 15838     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15839
 15840
 15841* EXEC CICS REWRITE
 15842*        DATASET (FILE-ID-ERPNDB)
 15843*        FROM    (PENDING-BUSINESS)
 15844*    END-EXEC.
 15845     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 289
* EL6311.cbl
 15846      PENDING-BUSINESS
 15847       TO DFHEIV11
 15848*    MOVE '&& L                  %   #00014140' TO DFHEIV0
 15849     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15850     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15851     MOVE X'2020233030303134313430' TO DFHEIV0(25:11)
 15852     CALL 'kxdfhei1' USING DFHEIV0,
 15853           FILE-ID-ERPNDB,
 15854           PENDING-BUSINESS,
 15855           DFHEIV11,
 15856           DFHEIV99
 15857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15858
 15859
 15860     PERFORM 8400-LOG-JOURNAL-RECORD.
 15861
 15862******************************************************************
 15863*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15864******************************************************************
 15865
 15866     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15867     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15868     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15869     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15870
 15871
 15872* EXEC CICS READ
 15873*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15874*        DATASET (FILE-ID-ELCERT)
 15875*        RIDFLD  (ELCERT-KEY)
 15876*        RESP    (WS-RESPONSE)
 15877*    END-EXEC.
 15878*    MOVE '&"S        E          (  N#00014156' TO DFHEIV0
 15879     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15880     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15881     MOVE X'204E233030303134313536' TO DFHEIV0(25:11)
 15882     CALL 'kxdfhei1' USING DFHEIV0,
 15883           FILE-ID-ELCERT,
 15884           DFHEIV20,
 15885           DFHEIV99,
 15886           ELCERT-KEY,
 15887           DFHEIV99,
 15888           DFHEIV99,
 15889           DFHEIV99
 15890     SET ADDRESS OF CERTIFICATE-MASTER TO
 15891         DFHEIV20
 15892     MOVE EIBRESP  TO WS-RESPONSE
 15893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15894
 15895
 15896     IF NOT RESP-NORMAL
 15897        GO TO 2376-BYPASS-CRTO
 15898     END-IF
 15899
 15900
 15901     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15902     MOVE ' '                    TO WS-ERMAIL-SW
 15903
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 290
* EL6311.cbl
 15904
 15905* EXEC CICS READ
 15906*       DATASET   (FILE-ID-ERMAIL)
 15907*       SET       (ADDRESS OF MAILING-DATA)
 15908*       RIDFLD    (ERMAIL-KEY)
 15909*       RESP      (WS-RESPONSE)
 15910*    END-EXEC
 15911*    MOVE '&"S        E          (  N#00014171' TO DFHEIV0
 15912     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15913     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15914     MOVE X'204E233030303134313731' TO DFHEIV0(25:11)
 15915     CALL 'kxdfhei1' USING DFHEIV0,
 15916           FILE-ID-ERMAIL,
 15917           DFHEIV20,
 15918           DFHEIV99,
 15919           ERMAIL-KEY,
 15920           DFHEIV99,
 15921           DFHEIV99,
 15922           DFHEIV99
 15923     SET ADDRESS OF MAILING-DATA TO
 15924         DFHEIV20
 15925     MOVE EIBRESP  TO WS-RESPONSE
 15926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15927
 15928     IF RESP-NORMAL
 15929        SET ERMAIL-FOUND TO TRUE
 15930     END-IF
 15931
 15932     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15933
 15934     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15935                                 TO ELCRTO-KEY
 15936     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15937     MOVE +0                     TO ELCRTO-SEQ-NO
 15938
 15939
 15940* EXEC CICS READ
 15941*       DATASET   ('ELCRTO')
 15942*       INTO      (ORIGINAL-CERTIFICATE)
 15943*       RIDFLD    (ELCRTO-KEY)
 15944*       GTEQ
 15945*       RESP      (WS-RESPONSE)
 15946*    END-EXEC
 15947     MOVE LENGTH OF
 15948      ORIGINAL-CERTIFICATE
 15949       TO DFHEIV11
 15950     MOVE 'ELCRTO' TO DFHEIV1
 15951*    MOVE '&"IL       G          (  N#00014189' TO DFHEIV0
 15952     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15953     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15954     MOVE X'204E233030303134313839' TO DFHEIV0(25:11)
 15955     CALL 'kxdfhei1' USING DFHEIV0,
 15956           DFHEIV1,
 15957           ORIGINAL-CERTIFICATE,
 15958           DFHEIV11,
 15959           ELCRTO-KEY,
 15960           DFHEIV99,
 15961           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 291
* EL6311.cbl
 15962           DFHEIV99
 15963     MOVE EIBRESP  TO WS-RESPONSE
 15964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15965
 15966     IF RESP-NORMAL
 15967        AND (OC-CONTROL-PRIMARY (1:33) =
 15968                 PB-CONTROL-BY-ACCOUNT (1:33))
 15969        AND (OC-RECORD-TYPE = 'I')
 15970        display ' resp norm, key =, type i '
 15971        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15972           display ' end proc blank '
 15973           display ' csr edit session ' PI-CSR-SESSION-SW
 15974           IF NOT CSR-EDIT-SESSION
 15975
 15976* EXEC CICS READ
 15977*                DATASET   ('ELCRTO')
 15978*                INTO      (ORIGINAL-CERTIFICATE)
 15979*                RIDFLD    (OC-CONTROL-PRIMARY)
 15980*                UPDATE
 15981*                RESP      (WS-RESPONSE)
 15982*             END-EXEC
 15983     MOVE LENGTH OF
 15984      ORIGINAL-CERTIFICATE
 15985       TO DFHEIV11
 15986     MOVE 'ELCRTO' TO DFHEIV1
 15987*    MOVE '&"IL       EU         (  N#00014206' TO DFHEIV0
 15988     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15989     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15990     MOVE X'204E233030303134323036' TO DFHEIV0(25:11)
 15991     CALL 'kxdfhei1' USING DFHEIV0,
 15992           DFHEIV1,
 15993           ORIGINAL-CERTIFICATE,
 15994           DFHEIV11,
 15995           OC-CONTROL-PRIMARY,
 15996           DFHEIV99,
 15997           DFHEIV99,
 15998           DFHEIV99
 15999     MOVE EIBRESP  TO WS-RESPONSE
 16000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16001              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 16002              IF RESP-NORMAL
 16003                 display ' good read upd '
 16004                 IF OC-ISSUE-TRAN-IND = 'N'
 16005                    MOVE CM-INSURED-LAST-NAME   TO
 16006                         OC-INS-LAST-NAME
 16007                    MOVE CM-INSURED-FIRST-NAME  TO
 16008                         OC-INS-FIRST-NAME
 16009                    MOVE CM-INSURED-INITIAL2    TO
 16010                         OC-INS-MIDDLE-INIT
 16011                    MOVE CM-INSURED-ISSUE-AGE   TO
 16012                         OC-INS-AGE
 16013                    MOVE CM-JT-LAST-NAME        TO
 16014                         OC-JNT-LAST-NAME
 16015                    MOVE CM-JT-FIRST-NAME       TO
 16016                         OC-JNT-FIRST-NAME
 16017                    MOVE CM-JT-INITIAL          TO
 16018                         OC-JNT-MIDDLE-INIT
 16019                    MOVE CM-INSURED-JOINT-AGE   TO
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 292
* EL6311.cbl
 16020                         OC-JNT-AGE
 16021                    MOVE CM-LF-BENEFIT-CD       TO
 16022                         OC-LF-BENCD
 16023                    MOVE CM-LF-ORIG-TERM        TO
 16024                         OC-LF-TERM
 16025                    MOVE CM-LF-BENEFIT-AMT      TO
 16026                         OC-LF-BEN-AMT
 16027                    MOVE CM-LF-PREMIUM-AMT      TO
 16028                         OC-LF-PRM-AMT
 16029                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 16030                         OC-LF-ALT-BEN-AMT
 16031                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 16032                         OC-LF-ALT-PRM-AMT
 16033                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 16034                         OC-LF-EXP-DT
 16035                    MOVE CM-LIFE-COMM-PCT       TO
 16036                         OC-LF-COMM-PCT
 16037                    MOVE CM-AH-BENEFIT-CD       TO
 16038                         OC-AH-BENCD
 16039                    MOVE CM-AH-ORIG-TERM        TO
 16040                         OC-AH-TERM
 16041                    MOVE CM-AH-BENEFIT-AMT      TO
 16042                         OC-AH-BEN-AMT
 16043                    MOVE CM-AH-PREMIUM-AMT      TO
 16044                         OC-AH-PRM-AMT
 16045                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 16046                         OC-AH-EXP-DT
 16047                    MOVE CM-AH-COMM-PCT         TO
 16048                         OC-AH-COMM-PCT
 16049                    MOVE CM-AH-CRITICAL-PERIOD  TO
 16050                         OC-AH-CP
 16051                    MOVE CM-LOAN-1ST-PMT-DT     TO
 16052                         OC-1ST-PMT-DT
 16053                 END-IF
 16054                 MOVE PB-C-LF-CANCEL-DT      TO
 16055                         OC-LF-CANCEL-DT
 16056                 MOVE PB-C-LF-CANCEL-AMT     TO
 16057                         OC-LF-CANCEL-AMT
 16058                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 16059                         OC-LF-ITD-CANCEL-AMT
 16060                 MOVE PB-C-AH-CANCEL-DT      TO
 16061                         OC-AH-CANCEL-DT
 16062                 MOVE PB-C-AH-CANCEL-AMT     TO
 16063                         OC-AH-CANCEL-AMT
 16064                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 16065                         OC-AH-ITD-CANCEL-AMT
 16066                 MOVE 'Y'                    TO
 16067                         OC-CANCEL-TRAN-IND
 16068                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16069                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16070                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16071                 IF ERMAIL-FOUND
 16072                    MOVE MA-CRED-BENE-NAME
 16073                                 TO OC-CRED-BENE-NAME
 16074                 END-IF
 16075                 IF NOT CERT-TRL-REC-NOT-FOUND
 16076                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16077                           OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 293
* EL6311.cbl
 16078                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16079                           OC-JNT-AGE-DEFAULT-FLAG
 16080                 END-IF
 16081
 16082* EXEC CICS REWRITE
 16083*                   DATASET   ('ELCRTO')
 16084*                   FROM      (ORIGINAL-CERTIFICATE)
 16085*                   RESP      (WS-RESPONSE)
 16086*                END-EXEC
 16087     MOVE LENGTH OF
 16088      ORIGINAL-CERTIFICATE
 16089       TO DFHEIV11
 16090     MOVE 'ELCRTO' TO DFHEIV1
 16091*    MOVE '&& L                  %  N#00014293' TO DFHEIV0
 16092     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16093     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16094     MOVE X'204E233030303134323933' TO DFHEIV0(25:11)
 16095     CALL 'kxdfhei1' USING DFHEIV0,
 16096           DFHEIV1,
 16097           ORIGINAL-CERTIFICATE,
 16098           DFHEIV11,
 16099           DFHEIV99
 16100     MOVE EIBRESP  TO WS-RESPONSE
 16101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16102                 display ' just rewrote ' ws-response
 16103              END-IF
 16104           END-IF
 16105        ELSE
 16106           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 16107           MOVE 'OC'             TO OC-RECORD-ID
 16108           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16109           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16110           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16111           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16112           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16113           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16114           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16115           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16116           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16117           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16118           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16119           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16120           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16121           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16122           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16123           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16124           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16125           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16126           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16127           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16128           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16129           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16130           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16131           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16132           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16133           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16134           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16135           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 294
* EL6311.cbl
 16136           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16137           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16138           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16139           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16140           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16141           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16142           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16143           IF ERMAIL-FOUND
 16144              MOVE MA-CRED-BENE-NAME
 16145                                 TO OC-CRED-BENE-NAME
 16146           END-IF
 16147           IF NOT CERT-TRL-REC-NOT-FOUND
 16148              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16149                           OC-INS-AGE-DEFAULT-FLAG
 16150              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16151                           OC-JNT-AGE-DEFAULT-FLAG
 16152           END-IF
 16153           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 16154
 16155* EXEC CICS WRITE
 16156*             DATASET   ('ELCRTO')
 16157*             FROM      (ORIGINAL-CERTIFICATE)
 16158*             RIDFLD    (OC-CONTROL-PRIMARY)
 16159*             RESP      (WS-RESPONSE)
 16160*          END-EXEC
 16161     MOVE LENGTH OF
 16162      ORIGINAL-CERTIFICATE
 16163       TO DFHEIV11
 16164     MOVE 'ELCRTO' TO DFHEIV1
 16165*    MOVE '&$ L                  ''  N#00014350' TO DFHEIV0
 16166     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16167     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16168     MOVE X'204E233030303134333530' TO DFHEIV0(25:11)
 16169     CALL 'kxdfhei1' USING DFHEIV0,
 16170           DFHEIV1,
 16171           ORIGINAL-CERTIFICATE,
 16172           DFHEIV11,
 16173           OC-CONTROL-PRIMARY,
 16174           DFHEIV99,
 16175           DFHEIV99
 16176     MOVE EIBRESP  TO WS-RESPONSE
 16177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16178        END-IF
 16179     ELSE
 16180        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 16181        MOVE 'OC'                TO OC-RECORD-ID
 16182        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16183                                 TO OC-CONTROL-PRIMARY (1:33)
 16184        MOVE 'I'                 TO OC-RECORD-TYPE
 16185        MOVE +4096               TO OC-KEY-SEQ-NO
 16186        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 16187        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 16188        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 16189        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16190        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16191        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16192        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16193        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 295
* EL6311.cbl
 16194        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16195        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16196        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16197        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16198        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16199        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16200        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16201        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16202        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16203        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16204        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16205        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16206        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16207        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16208        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16209        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16210        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16211        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16212        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16213        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16214        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16215        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16216        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16217        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16218        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16219        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16220        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16221        IF ERMAIL-FOUND
 16222           MOVE MA-CRED-BENE-NAME
 16223                                 TO OC-CRED-BENE-NAME
 16224        END-IF
 16225        IF NOT CERT-TRL-REC-NOT-FOUND
 16226           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16227                           OC-INS-AGE-DEFAULT-FLAG
 16228           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16229                           OC-JNT-AGE-DEFAULT-FLAG
 16230        END-IF
 16231        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16232
 16233
 16234* EXEC CICS WRITE
 16235*          DATASET   ('ELCRTO')
 16236*          FROM      (ORIGINAL-CERTIFICATE)
 16237*          RIDFLD    (OC-CONTROL-PRIMARY)
 16238*          RESP      (WS-RESPONSE)
 16239*       END-EXEC
 16240     MOVE LENGTH OF
 16241      ORIGINAL-CERTIFICATE
 16242       TO DFHEIV11
 16243     MOVE 'ELCRTO' TO DFHEIV1
 16244*    MOVE '&$ L                  ''  N#00014411' TO DFHEIV0
 16245     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16246     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16247     MOVE X'204E233030303134343131' TO DFHEIV0(25:11)
 16248     CALL 'kxdfhei1' USING DFHEIV0,
 16249           DFHEIV1,
 16250           ORIGINAL-CERTIFICATE,
 16251           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 296
* EL6311.cbl
 16252           OC-CONTROL-PRIMARY,
 16253           DFHEIV99,
 16254           DFHEIV99
 16255     MOVE EIBRESP  TO WS-RESPONSE
 16256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16257     END-IF.
 16258
 16259 2376-BYPASS-CRTO.
 16260******************************************************************
 16261*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16262******************************************************************
 16263
 16264
 16265* EXEC CICS HANDLE CONDITION
 16266*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16267*    END-EXEC.
 16268*    MOVE '"$I                   ! 7 #00014424' TO DFHEIV0
 16269     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16270     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16271     MOVE X'3720233030303134343234' TO DFHEIV0(25:11)
 16272     CALL 'kxdfhei1' USING DFHEIV0
 16273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16274
 16275
 16276
 16277* EXEC CICS READ
 16278*        INTO    (PENDING-BUSINESS)
 16279*        DATASET (FILE-ID-ERPNDB)
 16280*        RIDFLD  (ERPNDB-KEY)
 16281*        UPDATE
 16282*    END-EXEC.
 16283     MOVE LENGTH OF
 16284      PENDING-BUSINESS
 16285       TO DFHEIV11
 16286*    MOVE '&"IL       EU         (   #00014428' TO DFHEIV0
 16287     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16288     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16289     MOVE X'2020233030303134343238' TO DFHEIV0(25:11)
 16290     CALL 'kxdfhei1' USING DFHEIV0,
 16291           FILE-ID-ERPNDB,
 16292           PENDING-BUSINESS,
 16293           DFHEIV11,
 16294           ERPNDB-KEY,
 16295           DFHEIV99,
 16296           DFHEIV99,
 16297           DFHEIV99
 16298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16299
 16300
 16301     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16302     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16303     MOVE 'B'                    TO JP-RECORD-TYPE.
 16304     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16305
 16306     PERFORM 8400-LOG-JOURNAL-RECORD.
 16307
 16308     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16309
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 297
* EL6311.cbl
 16310
 16311* EXEC CICS REWRITE
 16312*        DATASET (FILE-ID-ERPNDB)
 16313*        FROM    (PENDING-BUSINESS)
 16314*    END-EXEC.
 16315     MOVE LENGTH OF
 16316      PENDING-BUSINESS
 16317       TO DFHEIV11
 16318*    MOVE '&& L                  %   #00014444' TO DFHEIV0
 16319     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16320     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16321     MOVE X'2020233030303134343434' TO DFHEIV0(25:11)
 16322     CALL 'kxdfhei1' USING DFHEIV0,
 16323           FILE-ID-ERPNDB,
 16324           PENDING-BUSINESS,
 16325           DFHEIV11,
 16326           DFHEIV99
 16327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16328
 16329
 16330     MOVE 'C'                    TO JP-RECORD-TYPE.
 16331     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16332
 16333     PERFORM 8400-LOG-JOURNAL-RECORD.
 16334
 16335     IF WS-ERRORS-PRESENT
 16336         GO TO 3900-RE-DISPLAY-RECORD.
 16337
 16338     MOVE ZEROS                  TO EMI-ERROR
 16339     MOVE -1                     TO CMAINTL
 16340     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16341     GO TO 3900-RE-DISPLAY-RECORD.
 16342
 16343 2380-BATCH-HDR-NOT-FOUND.
 16344     MOVE -1                     TO BMAINTL.
 16345     MOVE ER-7450                TO EMI-ERROR.
 16346     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16347     GO TO 8200-SEND-DATAONLY.
 16348
 16349 2385-REC-NOT-FOUND.
 16350     MOVE -1                     TO BMAINTL.
 16351     MOVE ER-7451                TO EMI-ERROR.
 16352     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16353     GO TO 8200-SEND-DATAONLY.
 16354
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 298
* EL6311.cbl
 16356
 16357******************************************************************
 16358*                                                                *
 16359*          D E L E T E   C A N C E L   R O U T I N E             *
 16360*                                                                *
 16361******************************************************************
 16362
 16363 2400-DELETE-CANCEL-ROUTINE.
 16364     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16365
 16366     IF CCHGL NOT = ZEROS
 16367        MOVE ER-2196             TO EMI-ERROR
 16368        MOVE AL-UABON            TO CMAINTA
 16369        MOVE -1                  TO CMAINTL
 16370        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16371        GO TO 8200-SEND-DATAONLY.
 16372
 16373
 16374* EXEC CICS HANDLE CONDITION
 16375*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16376*    END-EXEC.
 16377*    MOVE '"$I                   ! 8 #00014492' TO DFHEIV0
 16378     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16379     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16380     MOVE X'3820233030303134343932' TO DFHEIV0(25:11)
 16381     CALL 'kxdfhei1' USING DFHEIV0
 16382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16383
 16384
 16385     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16386     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16387     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16388
 16389
 16390* EXEC CICS READ
 16391*        SET     (ADDRESS OF PENDING-BUSINESS)
 16392*        DATASET (FILE-ID-ERPNDB)
 16393*        RIDFLD  (ERPNDB-KEY)
 16394*    END-EXEC.
 16395*    MOVE '&"S        E          (   #00014500' TO DFHEIV0
 16396     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16397     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16398     MOVE X'2020233030303134353030' TO DFHEIV0(25:11)
 16399     CALL 'kxdfhei1' USING DFHEIV0,
 16400           FILE-ID-ERPNDB,
 16401           DFHEIV20,
 16402           DFHEIV99,
 16403           ERPNDB-KEY,
 16404           DFHEIV99,
 16405           DFHEIV99,
 16406           DFHEIV99
 16407     SET ADDRESS OF PENDING-BUSINESS TO
 16408         DFHEIV20
 16409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16410
 16411
 16412     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16413
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 299
* EL6311.cbl
 16414     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16415
 16416     IF CSUFIXL NOT = ZEROS
 16417        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16418     ELSE
 16419        MOVE SPACE               TO WS-NEW-SUFFIX.
 16420
 16421     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16422
 16423     PERFORM 8600-DEEDIT.
 16424     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16425     MOVE '4'                    TO DC-OPTION-CODE.
 16426     PERFORM 9700-DATE-LINK.
 16427
 16428     IF DATE-CONVERSION-ERROR
 16429        MOVE ER-0348             TO EMI-ERROR
 16430        MOVE -1                  TO CEFFDTL
 16431        MOVE AL-UABON            TO CEFFDTA
 16432        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16433        GO TO 8200-SEND-DATAONLY
 16434     ELSE
 16435        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16436        MOVE AL-UANON            TO CEFFDTA
 16437        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16438
 16439
 16440* EXEC CICS HANDLE CONDITION
 16441*         NOTFND    (2490-RECORD-NOT-FOUND)
 16442*    END-EXEC.
 16443*    MOVE '"$I                   ! 9 #00014533' TO DFHEIV0
 16444     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16445     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16446     MOVE X'3920233030303134353333' TO DFHEIV0(25:11)
 16447     CALL 'kxdfhei1' USING DFHEIV0
 16448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16449
 16450
 16451
 16452* EXEC CICS READ
 16453*        SET     (ADDRESS OF PENDING-BUSINESS)
 16454*        DATASET (FILE-ID-ERPNDB)
 16455*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16456*        UPDATE
 16457*    END-EXEC.
 16458*    MOVE '&"S        EU         (   #00014537' TO DFHEIV0
 16459     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16460     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16461     MOVE X'2020233030303134353337' TO DFHEIV0(25:11)
 16462     CALL 'kxdfhei1' USING DFHEIV0,
 16463           FILE-ID-ERPNDB,
 16464           DFHEIV20,
 16465           DFHEIV99,
 16466           PI-PREV-CONTROL-PRIMARY,
 16467           DFHEIV99,
 16468           DFHEIV99,
 16469           DFHEIV99
 16470     SET ADDRESS OF PENDING-BUSINESS TO
 16471         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 300
* EL6311.cbl
 16472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16473
 16474
 16475     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16476        MOVE -1                 TO CMAINTL
 16477        MOVE ER-2197            TO EMI-ERROR
 16478        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16479        GO TO 8200-SEND-DATAONLY.
 16480
 16481     IF PB-BILLED-DT NOT = LOW-VALUES
 16482        MOVE -1                 TO CMAINTL
 16483        MOVE ER-2129            TO EMI-ERROR
 16484        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16485        GO TO 8200-SEND-DATAONLY.
 16486
 16487     IF PB-CHG-COUNT NOT = ZEROS
 16488        MOVE ER-2336            TO EMI-ERROR
 16489        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16490        MOVE AL-UABON            TO CMAINTA
 16491        MOVE -1                  TO CMAINTL
 16492        GO TO 8200-SEND-DATAONLY.
 16493
 16494     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16495        PB-CHG-COUNT NOT = ZEROS
 16496        MOVE ER-2196             TO EMI-ERROR
 16497        MOVE AL-UABON            TO CMAINTA
 16498        MOVE -1                  TO CMAINTL
 16499        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16500        GO TO 8200-SEND-DATAONLY.
 16501
 16502     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16503        MOVE ER-2900 TO EMI-ERROR
 16504        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16505        MOVE AL-UABON         TO CMAINTA
 16506        MOVE -1               TO CMAINTL
 16507        GO TO 8200-SEND-DATAONLY.
 16508     move ' '                    to ws-stop-sw
 16509                                    ws-check-sw
 16510                                    ws-any-check-sw
 16511                                    ws-proc-check-sw
 16512                                    ws-chek-browse-sw
 16513
 16514     perform 2500-browse-checks  thru 2500-exit
 16515     if (i-have-processed-checks)
 16516        and (pb-c-refund-sw = 'Y')
 16517        move er-3446             to emi-error
 16518        perform 9900-error-format thru 9900-exit
 16519        move al-uabon            to cmainta
 16520        move -1                  to cmaintl
 16521        go to 8200-send-dataonly
 16522     end-if
 16523
 16524* EXEC CICS HANDLE CONDITION
 16525*         NOTFND  (2475-CONTINUE-DELETE)
 16526*    END-EXEC
 16527*    MOVE '"$I                   ! : #00014592' TO DFHEIV0
 16528     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16529     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 301
* EL6311.cbl
 16530     MOVE X'3A20233030303134353932' TO DFHEIV0(25:11)
 16531     CALL 'kxdfhei1' USING DFHEIV0
 16532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16533
 16534     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16535     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16536     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16537     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16538
 16539
 16540* EXEC CICS READ
 16541*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16542*        DATASET (FILE-ID-ELCERT)
 16543*        RIDFLD  (ELCERT-KEY)
 16544*        UPDATE
 16545*    END-EXEC.
 16546*    MOVE '&"S        EU         (   #00014601' TO DFHEIV0
 16547     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16548     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16549     MOVE X'2020233030303134363031' TO DFHEIV0(25:11)
 16550     CALL 'kxdfhei1' USING DFHEIV0,
 16551           FILE-ID-ELCERT,
 16552           DFHEIV20,
 16553           DFHEIV99,
 16554           ELCERT-KEY,
 16555           DFHEIV99,
 16556           DFHEIV99,
 16557           DFHEIV99
 16558     SET ADDRESS OF CERTIFICATE-MASTER TO
 16559         DFHEIV20
 16560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16561
 16562
 16563     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16564
 16565     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16566     MOVE 'B'                    TO JP-RECORD-TYPE.
 16567     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16568     PERFORM 8400-LOG-JOURNAL-RECORD.
 16569
 16570     IF PB-CI-LIVES NOT NUMERIC
 16571         MOVE ZERO                    TO PB-CI-LIVES.
 16572
 16573     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16574        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16575           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16576           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16577           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16578                                            CM-LF-CANCEL-DT
 16579           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16580        ELSE
 16581           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16582           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16583           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16584           MOVE PB-CI-LIVES              TO CM-LIVES.
 16585
 16586     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16587        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 302
* EL6311.cbl
 16588           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16589               MOVE CM-LF-STATUS-AT-CANCEL
 16590                                        TO CM-LF-CURRENT-STATUS
 16591               MOVE SPACE
 16592                                        TO CM-LF-STATUS-AT-CANCEL
 16593           ELSE
 16594               MOVE PB-CI-LF-POLICY-STATUS
 16595                                        TO CM-LF-CURRENT-STATUS
 16596        ELSE
 16597           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16598
 16599
 16600     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16601        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16602           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16603           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16604           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16605                                            CM-AH-CANCEL-DT
 16606           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16607        ELSE
 16608           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16609           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16610           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16611           MOVE PB-CI-LIVES              TO CM-LIVES.
 16612
 16613     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16614        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16615           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16616               MOVE CM-AH-STATUS-AT-CANCEL
 16617                                        TO CM-AH-CURRENT-STATUS
 16618               MOVE SPACE
 16619                                        TO CM-AH-STATUS-AT-CANCEL
 16620           ELSE
 16621               MOVE PB-CI-AH-POLICY-STATUS
 16622                                        TO CM-AH-CURRENT-STATUS
 16623        ELSE
 16624           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16625
 16626 2450-REWRITE-CERT.
 16627     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16628     MOVE 'C'                      TO JP-RECORD-TYPE.
 16629     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16630
 16631
 16632* EXEC CICS REWRITE
 16633*        DATASET  (FILE-ID-ELCERT)
 16634*        FROM     (CERTIFICATE-MASTER)
 16635*    END-EXEC.
 16636     MOVE LENGTH OF
 16637      CERTIFICATE-MASTER
 16638       TO DFHEIV11
 16639*    MOVE '&& L                  %   #00014676' TO DFHEIV0
 16640     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16641     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16642     MOVE X'2020233030303134363736' TO DFHEIV0(25:11)
 16643     CALL 'kxdfhei1' USING DFHEIV0,
 16644           FILE-ID-ELCERT,
 16645           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 303
* EL6311.cbl
 16646           DFHEIV11,
 16647           DFHEIV99
 16648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16649
 16650
 16651     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16652
 16653     PERFORM 8400-LOG-JOURNAL-RECORD.
 16654
 16655     move ' '                    to ws-stop-sw
 16656                                    ws-any-check-sw
 16657                                    ws-proc-check-sw
 16658                                    ws-chek-browse-sw
 16659
 16660     if i-have-checks
 16661        perform until i-say-stop
 16662           perform 2510-startbr-erchek
 16663                                 thru 2510-exit
 16664           if resp-normal
 16665              perform 2520-readnext-erchek
 16666                                 thru 2520-exit
 16667           end-if
 16668           if (not resp-normal)
 16669              or (pb-control-by-account (1:33) not =
 16670                 ch-control-primary (1:33))
 16671                 set i-say-stop to true
 16672           else
 16673              perform 2530-readupd-erchek
 16674                                 thru 2530-exit
 16675              if resp-normal
 16676                 perform 2540-delete-erchek
 16677                                 thru 2540-exit
 16678              end-if
 16679              if ws-chek-browse-sw = 'Y'
 16680                 perform 2525-endbr-erchek
 16681                                 thru 2525-exit
 16682                 move ' '        to ws-chek-browse-sw
 16683              end-if
 16684           end-if
 16685        end-perform
 16686     end-if
 16687
 16688     if ws-chek-browse-sw = 'Y'
 16689        perform 2525-endbr-erchek thru 2525-exit
 16690     end-if
 16691     .
 16692 2475-CONTINUE-DELETE.
 16693     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16694     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16695
 16696     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16697     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16698
 16699     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16700
 16701     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16702     MOVE 'D'                    TO JP-RECORD-TYPE
 16703     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 304
* EL6311.cbl
 16704
 16705
 16706* EXEC CICS DELETE
 16707*        DATASET    (FILE-ID-ERPNDB)
 16708*    END-EXEC.
 16709*    MOVE '&(                    &   #00014735' TO DFHEIV0
 16710     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16711     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16712     MOVE X'2020233030303134373335' TO DFHEIV0(25:11)
 16713     CALL 'kxdfhei1' USING DFHEIV0,
 16714           FILE-ID-ERPNDB,
 16715           DFHEIV99,
 16716           DFHEIV99,
 16717           DFHEIV99,
 16718           DFHEIV99
 16719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16720
 16721
 16722     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16723
 16724     PERFORM 8400-LOG-JOURNAL-RECORD.
 16725
 16726     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16727     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16728
 16729
 16730* EXEC CICS HANDLE CONDITION
 16731*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16732*    END-EXEC.
 16733*    MOVE '"$I                   ! ; #00014746' TO DFHEIV0
 16734     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16735     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16736     MOVE X'3B20233030303134373436' TO DFHEIV0(25:11)
 16737     CALL 'kxdfhei1' USING DFHEIV0
 16738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16739
 16740
 16741
 16742* EXEC CICS READ
 16743*        SET     (ADDRESS OF PENDING-BUSINESS)
 16744*        DATASET (FILE-ID-ERPNDB)
 16745*        RIDFLD  (ERPNDB-KEY)
 16746*        UPDATE
 16747*    END-EXEC.
 16748*    MOVE '&"S        EU         (   #00014750' TO DFHEIV0
 16749     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16750     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16751     MOVE X'2020233030303134373530' TO DFHEIV0(25:11)
 16752     CALL 'kxdfhei1' USING DFHEIV0,
 16753           FILE-ID-ERPNDB,
 16754           DFHEIV20,
 16755           DFHEIV99,
 16756           ERPNDB-KEY,
 16757           DFHEIV99,
 16758           DFHEIV99,
 16759           DFHEIV99
 16760     SET ADDRESS OF PENDING-BUSINESS TO
 16761         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 305
* EL6311.cbl
 16762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16763
 16764
 16765     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16766     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16767
 16768     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16769        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16770        MOVE 'D'                 TO JP-RECORD-TYPE
 16771        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16772
 16773* EXEC CICS DELETE
 16774*            DATASET    (FILE-ID-ERPNDB)
 16775*       END-EXEC
 16776*    MOVE '&(                    &   #00014764' TO DFHEIV0
 16777     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16778     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16779     MOVE X'2020233030303134373634' TO DFHEIV0(25:11)
 16780     CALL 'kxdfhei1' USING DFHEIV0,
 16781           FILE-ID-ERPNDB,
 16782           DFHEIV99,
 16783           DFHEIV99,
 16784           DFHEIV99,
 16785           DFHEIV99
 16786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16787        PERFORM 8400-LOG-JOURNAL-RECORD
 16788     ELSE
 16789        MOVE 'B'                 TO JP-RECORD-TYPE
 16790        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16791        PERFORM 8400-LOG-JOURNAL-RECORD
 16792        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16793        MOVE 'C'                 TO JP-RECORD-TYPE
 16794        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16795
 16796* EXEC CICS REWRITE
 16797*            DATASET    (FILE-ID-ERPNDB)
 16798*            FROM       (PENDING-BUSINESS)
 16799*       END-EXEC
 16800     MOVE LENGTH OF
 16801      PENDING-BUSINESS
 16802       TO DFHEIV11
 16803*    MOVE '&& L                  %   #00014775' TO DFHEIV0
 16804     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16805     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16806     MOVE X'2020233030303134373735' TO DFHEIV0(25:11)
 16807     CALL 'kxdfhei1' USING DFHEIV0,
 16808           FILE-ID-ERPNDB,
 16809           PENDING-BUSINESS,
 16810           DFHEIV11,
 16811           DFHEIV99
 16812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16813        PERFORM 8400-LOG-JOURNAL-RECORD.
 16814
 16815******************************************************************
 16816*                                                                *
 16817*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16818*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16819*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 306
* EL6311.cbl
 16820******************************************************************
 16821
 16822     IF NOT PI-AR-PROCESSING
 16823        GO TO 2480-DELETE-FINISHED.
 16824
 16825     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16826        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16827        NEXT SENTENCE
 16828     ELSE
 16829        GO TO 2480-DELETE-FINISHED.
 16830
 16831
 16832* EXEC CICS HANDLE CONDITION
 16833*         NOTFND    (2480-DELETE-FINISHED)
 16834*    END-EXEC.
 16835*    MOVE '"$I                   ! < #00014797' TO DFHEIV0
 16836     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16837     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16838     MOVE X'3C20233030303134373937' TO DFHEIV0(25:11)
 16839     CALL 'kxdfhei1' USING DFHEIV0
 16840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16841
 16842
 16843     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16844     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16845
 16846
 16847* EXEC CICS READ
 16848*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16849*        DATASET (FILE-ID-ERRQST)
 16850*        RIDFLD  (ERRQST-KEY)
 16851*        UPDATE
 16852*    END-EXEC.
 16853*    MOVE '&"S        EU         (   #00014804' TO DFHEIV0
 16854     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16855     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16856     MOVE X'2020233030303134383034' TO DFHEIV0(25:11)
 16857     CALL 'kxdfhei1' USING DFHEIV0,
 16858           FILE-ID-ERRQST,
 16859           DFHEIV20,
 16860           DFHEIV99,
 16861           ERRQST-KEY,
 16862           DFHEIV99,
 16863           DFHEIV99,
 16864           DFHEIV99
 16865     SET ADDRESS OF AR-REQUEST-RECORD TO
 16866         DFHEIV20
 16867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16868
 16869
 16870     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16871
 16872     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16873
 16874     MOVE 'D'                      TO JP-RECORD-TYPE.
 16875     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16876
 16877
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 307
* EL6311.cbl
 16878* EXEC CICS DELETE
 16879*         DATASET    (FILE-ID-ERRQST)
 16880*    END-EXEC.
 16881*    MOVE '&(                    &   #00014818' TO DFHEIV0
 16882     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16883     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16884     MOVE X'2020233030303134383138' TO DFHEIV0(25:11)
 16885     CALL 'kxdfhei1' USING DFHEIV0,
 16886           FILE-ID-ERRQST,
 16887           DFHEIV99,
 16888           DFHEIV99,
 16889           DFHEIV99,
 16890           DFHEIV99
 16891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16892
 16893
 16894     PERFORM 8400-LOG-JOURNAL-RECORD.
 16895
 16896 2480-DELETE-FINISHED.
 16897     MOVE ZEROS                  TO EMI-ERROR.
 16898     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16899     MOVE LOW-VALUES             TO EL631CI.
 16900     MOVE -1                     TO CMAINTL.
 16901     GO TO 8100-SEND-INITIAL-MAP.
 16902
 16903 2485-BATCH-HDR-NOT-FOUND.
 16904     MOVE -1                     TO CMAINTL
 16905     MOVE AL-UABON               TO CMAINTA.
 16906     MOVE ER-7450                TO EMI-ERROR.
 16907     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16908     GO TO 8200-SEND-DATAONLY.
 16909
 16910 2490-RECORD-NOT-FOUND.
 16911     MOVE -1                     TO CMAINTL
 16912     MOVE AL-UABON               TO CMAINTA.
 16913     MOVE ER-7451                TO EMI-ERROR.
 16914     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16915     GO TO 8200-SEND-DATAONLY.
 16916***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16917***                                                            ***
 16918***     2500  B R O W S E   C H E C K S                        ***
 16919***  We perform this routine from 2 different places.          ***
 16920***  1. If the user changes the refund amount on a cancel, we  ***
 16921***    want to.........                                        ***
 16922***    a. determine if prior checks have been processed        ***
 16923***    b. If the amt is larger, display message instructing    ***
 16924***     them to create another check to make up the difference.***
 16925***    c. If the amt is less, do not allow the change and      ***
 16926***     display a FATAL error suggesting they deal with check  ***
 16927***     records befor continuing.                              ***
 16928***  2. If the user wants to delete a cancel record we......   ***
 16929***    a. browse through all the checks and if there is a      ***
 16930***     processed check, send FATAL message.                   ***
 16931***    b. If there is a non-released check, then delete that   ***
 16932***     check after you delete the pending cancel record.      ***
 16933***                                                            ***
 16934***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16935
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 308
* EL6311.cbl
 16936 2500-browse-checks.
 16937
 16938     perform 2510-startbr-erchek thru 2510-exit
 16939
 16940     if not resp-normal
 16941        go to 2500-exit
 16942     end-if
 16943
 16944     perform until i-say-stop
 16945        perform 2520-readnext-erchek
 16946                                 thru 2520-exit
 16947        if (not resp-normal)
 16948           or (pb-control-by-account (1:33) not =
 16949              ch-control-primary (1:33))
 16950              set i-say-stop to true
 16951        else
 16952           set i-have-a-check-period to true
 16953           if (ch-approval-status) = ' '
 16954              and (ch-void-dt = low-values)
 16955              and (ch-released-dt = low-values)
 16956              set i-have-checks to true
 16957           else
 16958              if ch-void-dt = low-values
 16959                 set i-have-processed-checks to true
 16960              end-if
 16961           end-if
 16962           if (ch-credit-accept-dt = low-values)
 16963              and (ch-void-dt = low-values)
 16964              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16965              if (ch-check-origin-sw not = 'R')
 16966                 and (pb-record-type = '2')
 16967                 continue
 16968              else
 16969                 compute ws-check-amts =
 16970                    ws-check-amts + ch-amount-paid
 16971              end-if
 16972           end-if
 16973        end-if
 16974     end-perform
 16975
 16976     if ws-chek-browse-sw = 'Y'
 16977        perform 2525-endbr-erchek thru 2525-exit
 16978     end-if
 16979
 16980    .
 16981 2500-exit.
 16982     exit.
 16983
 16984 2510-startbr-erchek.
 16985
 16986     move pb-control-by-account  to erchek-key
 16987     move +0                     to chek-record-seq
 16988
 16989
 16990* exec cics startbr
 16991*       dataset   ('ERCHEK')
 16992*       ridfld    (erchek-key)
 16993*       gteq
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 309
* EL6311.cbl
 16994*       resp      (ws-response)
 16995*    end-exec
 16996     MOVE 'ERCHEK' TO DFHEIV1
 16997     MOVE 0
 16998       TO DFHEIV11
 16999*    MOVE '&,         G          &  N#00014917' TO DFHEIV0
 17000     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17001     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17002     MOVE X'204E233030303134393137' TO DFHEIV0(25:11)
 17003     CALL 'kxdfhei1' USING DFHEIV0,
 17004           DFHEIV1,
 17005           erchek-key,
 17006           DFHEIV99,
 17007           DFHEIV11,
 17008           DFHEIV99
 17009     MOVE EIBRESP  TO ws-response
 17010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17011
 17012     IF RESP-NORMAL
 17013        move 'Y'                 to ws-chek-browse-sw
 17014     end-if
 17015
 17016     .
 17017 2510-exit.
 17018     exit.
 17019
 17020 2520-readnext-erchek.
 17021
 17022
 17023* EXEC CICS READNEXT
 17024*       SET     (ADDRESS OF CHECK-RECORDS)
 17025*       DATASET ('ERCHEK')
 17026*       RIDFLD  (ERCHEK-KEY)
 17027*       RESP    (WS-RESPONSE)
 17028*    END-EXEC
 17029     MOVE 'ERCHEK' TO DFHEIV1
 17030     MOVE 0
 17031       TO DFHEIV11
 17032*    MOVE '&.S                   )  N#00014934' TO DFHEIV0
 17033     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17034     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17035     MOVE X'204E233030303134393334' TO DFHEIV0(25:11)
 17036     CALL 'kxdfhei1' USING DFHEIV0,
 17037           DFHEIV1,
 17038           DFHEIV20,
 17039           DFHEIV99,
 17040           ERCHEK-KEY,
 17041           DFHEIV99,
 17042           DFHEIV11,
 17043           DFHEIV99,
 17044           DFHEIV99
 17045     SET ADDRESS OF CHECK-RECORDS TO
 17046         DFHEIV20
 17047     MOVE EIBRESP  TO WS-RESPONSE
 17048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17049
 17050     .
 17051 2520-exit.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 310
* EL6311.cbl
 17052     exit.
 17053
 17054 2525-endbr-erchek.
 17055
 17056
 17057* exec cics endbr
 17058*       dataset  ('ERCHEK')
 17059*    end-exec
 17060     MOVE 'ERCHEK' TO DFHEIV1
 17061     MOVE 0
 17062       TO DFHEIV11
 17063*    MOVE '&2                    $   #00014947' TO DFHEIV0
 17064     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17065     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17066     MOVE X'2020233030303134393437' TO DFHEIV0(25:11)
 17067     CALL 'kxdfhei1' USING DFHEIV0,
 17068           DFHEIV1,
 17069           DFHEIV11,
 17070           DFHEIV99
 17071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17072
 17073     .
 17074 2525-exit.
 17075     exit.
 17076
 17077 2530-readupd-erchek.
 17078
 17079
 17080* EXEC CICS READ
 17081*       UPDATE
 17082*       SET     (ADDRESS OF CHECK-RECORDS)
 17083*       DATASET ('ERCHEK')
 17084*       RIDFLD  (ERCHEK-KEY)
 17085*       RESP    (WS-RESPONSE)
 17086*    END-EXEC
 17087     MOVE 'ERCHEK' TO DFHEIV1
 17088*    MOVE '&"S        EU         (  N#00014957' TO DFHEIV0
 17089     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17090     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17091     MOVE X'204E233030303134393537' TO DFHEIV0(25:11)
 17092     CALL 'kxdfhei1' USING DFHEIV0,
 17093           DFHEIV1,
 17094           DFHEIV20,
 17095           DFHEIV99,
 17096           ERCHEK-KEY,
 17097           DFHEIV99,
 17098           DFHEIV99,
 17099           DFHEIV99
 17100     SET ADDRESS OF CHECK-RECORDS TO
 17101         DFHEIV20
 17102     MOVE EIBRESP  TO WS-RESPONSE
 17103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17104
 17105     .
 17106 2530-exit.
 17107     exit.
 17108
 17109 2540-delete-erchek.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 311
* EL6311.cbl
 17110
 17111
 17112* EXEC CICS DELETE
 17113*       DATASET ('ERCHEK')
 17114*       RESP    (WS-RESPONSE)
 17115*    END-EXEC
 17116     MOVE 'ERCHEK' TO DFHEIV1
 17117*    MOVE '&(                    &  N#00014971' TO DFHEIV0
 17118     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17119     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17120     MOVE X'204E233030303134393731' TO DFHEIV0(25:11)
 17121     CALL 'kxdfhei1' USING DFHEIV0,
 17122           DFHEIV1,
 17123           DFHEIV99,
 17124           DFHEIV99,
 17125           DFHEIV99,
 17126           DFHEIV99
 17127     MOVE EIBRESP  TO WS-RESPONSE
 17128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17129
 17130     .
 17131 2540-exit.
 17132     exit.
 17133***************************************************************
 17134*                                                             *
 17135*       B U I L D   C O R R E C T I O N   R E C O R D         *
 17136*                                                             *
 17137***************************************************************
 17138
 17139***************************************************************
 17140*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 17141*     AN ALREADY BILLED RECORD.                               *
 17142***************************************************************
 17143
 17144 2700-BUILD-CORRECTION-RECORD.
 17145     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17146     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17147     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17148     MOVE '5'                    TO DC-OPTION-CODE.
 17149     PERFORM 9700-DATE-LINK.
 17150     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17151
 17152     IF PB-CHG-COUNT = ZEROS
 17153        MOVE +1                  TO WS-SEQ-SAVE
 17154     ELSE
 17155        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 17156
 17157     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 17158     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 17159
 17160     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 17161
 17162     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17163     MOVE 'A'                    TO JP-RECORD-TYPE.
 17164     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17165
 17166
 17167* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 312
* EL6311.cbl
 17168*        DATASET    (FILE-ID-ERPNDB)
 17169*        FROM       (PENDING-BUSINESS)
 17170*        RIDFLD     (PB-CONTROL-PRIMARY)
 17171*    END-EXEC.
 17172     MOVE LENGTH OF
 17173      PENDING-BUSINESS
 17174       TO DFHEIV11
 17175*    MOVE '&$ L                  ''   #00015012' TO DFHEIV0
 17176     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17177     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17178     MOVE X'2020233030303135303132' TO DFHEIV0(25:11)
 17179     CALL 'kxdfhei1' USING DFHEIV0,
 17180           FILE-ID-ERPNDB,
 17181           PENDING-BUSINESS,
 17182           DFHEIV11,
 17183           PB-CONTROL-PRIMARY,
 17184           DFHEIV99,
 17185           DFHEIV99
 17186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17187
 17188
 17189     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17190
 17191     PERFORM 8400-LOG-JOURNAL-RECORD.
 17192
 17193 2799-EXIT.
 17194      EXIT.
 17195
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 313
* EL6311.cbl
 17197
 17198******************************************************************
 17199*                                                                *
 17200*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 17201*                                                                *
 17202******************************************************************
 17203
 17204 2800-REWRITE-ISSUE-CERT-KEY.
 17205     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17206
 17207     IF  BCERTNOL GREATER THAN ZEROS
 17208         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 17209
 17210     IF  BSUFIXL  GREATER THAN ZEROS
 17211         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 17212
 17213     IF  BEFFDTL  GREATER THAN ZEROS
 17214         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17215
 17216 2810-READ-BY-ACCOUNT.
 17217
 17218* EXEC CICS HANDLE CONDITION
 17219*         NOTFND    (2820-PROCESS-REWRITE)
 17220*    END-EXEC.
 17221*    MOVE '"$I                   ! = #00015046' TO DFHEIV0
 17222     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17223     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17224     MOVE X'3D20233030303135303436' TO DFHEIV0(25:11)
 17225     CALL 'kxdfhei1' USING DFHEIV0
 17226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17227
 17228
 17229***  read pndb using new key
 17230
 17231* EXEC CICS READ
 17232*        SET     (ADDRESS OF PENDING-BUSINESS)
 17233*        DATASET (FILE-ID-ERPNDB2)
 17234*        RIDFLD  (ERPNDB-ALT-KEY)
 17235*    END-EXEC.
 17236*    MOVE '&"S        E          (   #00015051' TO DFHEIV0
 17237     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17238     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17239     MOVE X'2020233030303135303531' TO DFHEIV0(25:11)
 17240     CALL 'kxdfhei1' USING DFHEIV0,
 17241           FILE-ID-ERPNDB2,
 17242           DFHEIV20,
 17243           DFHEIV99,
 17244           ERPNDB-ALT-KEY,
 17245           DFHEIV99,
 17246           DFHEIV99,
 17247           DFHEIV99
 17248     SET ADDRESS OF PENDING-BUSINESS TO
 17249         DFHEIV20
 17250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17251
 17252
 17253     GO TO 2890-DUPLICATE-RECORD.
 17254
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 314
* EL6311.cbl
 17255  2820-PROCESS-REWRITE.
 17256
 17257* EXEC CICS HANDLE CONDITION
 17258*         NOTFND    (2885-RECORD-MISSING)
 17259*    END-EXEC.
 17260*    MOVE '"$I                   ! > #00015060' TO DFHEIV0
 17261     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17263     MOVE X'3E20233030303135303630' TO DFHEIV0(25:11)
 17264     CALL 'kxdfhei1' USING DFHEIV0
 17265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17266
 17267
 17268     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17269
 17270***  read pndb using original key
 17271
 17272* EXEC CICS READ
 17273*        SET     (ADDRESS OF PENDING-BUSINESS)
 17274*        DATASET (FILE-ID-ERPNDB)
 17275*        RIDFLD  (ERPNDB-KEY)
 17276*        UPDATE
 17277*    END-EXEC.
 17278*    MOVE '&"S        EU         (   #00015067' TO DFHEIV0
 17279     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17280     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17281     MOVE X'2020233030303135303637' TO DFHEIV0(25:11)
 17282     CALL 'kxdfhei1' USING DFHEIV0,
 17283           FILE-ID-ERPNDB,
 17284           DFHEIV20,
 17285           DFHEIV99,
 17286           ERPNDB-KEY,
 17287           DFHEIV99,
 17288           DFHEIV99,
 17289           DFHEIV99
 17290     SET ADDRESS OF PENDING-BUSINESS TO
 17291         DFHEIV20
 17292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17293
 17294
 17295     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17296     MOVE 'D'                    TO JP-RECORD-TYPE.
 17297     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17298     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17299
 17300     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17301
 17302     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17303     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17304     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17305
 17306***  delete pndb using original key
 17307
 17308* EXEC CICS DELETE
 17309*        DATASET    (FILE-ID-ERPNDB)
 17310*    END-EXEC.
 17311*    MOVE '&(                    &   #00015086' TO DFHEIV0
 17312     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 315
* EL6311.cbl
 17313     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17314     MOVE X'2020233030303135303836' TO DFHEIV0(25:11)
 17315     CALL 'kxdfhei1' USING DFHEIV0,
 17316           FILE-ID-ERPNDB,
 17317           DFHEIV99,
 17318           DFHEIV99,
 17319           DFHEIV99,
 17320           DFHEIV99
 17321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17322
 17323
 17324     PERFORM 8400-LOG-JOURNAL-RECORD.
 17325
 17326
 17327* EXEC CICS GETMAIN
 17328*        SET      (ADDRESS OF PENDING-BUSINESS)
 17329*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17330*        INITIMG  (GETMAIN-SPACE)
 17331*    END-EXEC.
 17332*    MOVE ',"IL                  $   #00015092' TO DFHEIV0
 17333     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17334     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17335     MOVE X'2020233030303135303932' TO DFHEIV0(25:11)
 17336     CALL 'kxdfhei1' USING DFHEIV0,
 17337           DFHEIV20,
 17338           ERPNDB-RECORD-LENGTH,
 17339           GETMAIN-SPACE
 17340     SET ADDRESS OF PENDING-BUSINESS TO
 17341         DFHEIV20
 17342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17343
 17344
 17345***  pending-business now has original record
 17346     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17347
 17348
 17349* EXEC CICS HANDLE CONDITION
 17350*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 17351*    END-EXEC.
 17352*    MOVE '"$I                   ! ? #00015101' TO DFHEIV0
 17353     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17355     MOVE X'3F20233030303135313031' TO DFHEIV0(25:11)
 17356     CALL 'kxdfhei1' USING DFHEIV0
 17357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17358
 17359
 17360***  read elcert using original key
 17361
 17362* EXEC CICS READ
 17363*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17364*        DATASET (FILE-ID-ELCERT)
 17365*        RIDFLD  (ELCERT-KEY)
 17366*        UPDATE
 17367*    END-EXEC.
 17368*    MOVE '&"S        EU         (   #00015106' TO DFHEIV0
 17369     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17370     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 316
* EL6311.cbl
 17371     MOVE X'2020233030303135313036' TO DFHEIV0(25:11)
 17372     CALL 'kxdfhei1' USING DFHEIV0,
 17373           FILE-ID-ELCERT,
 17374           DFHEIV20,
 17375           DFHEIV99,
 17376           ELCERT-KEY,
 17377           DFHEIV99,
 17378           DFHEIV99,
 17379           DFHEIV99
 17380     SET ADDRESS OF CERTIFICATE-MASTER TO
 17381         DFHEIV20
 17382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17383
 17384
 17385     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 17386     MOVE 'B'                    TO JP-RECORD-TYPE
 17387     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17388     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17389
 17390     IF INSURED-ADDR-PRESENT
 17391        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 17392
 17393     IF CERT-NOTES-ARE-NOT-PRESENT
 17394        MOVE SPACE               TO WS-CERT-NOTE-SW
 17395     ELSE
 17396        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 17397
 17398     IF CERT-ADDED-BATCH      OR
 17399        CERT-AND-CLAIM-ONLINE OR
 17400        CERT-WAS-CREATED-FOR-CLAIM
 17401        NEXT SENTENCE
 17402     ELSE
 17403        GO TO 2825-DELETE-CERTIFICATE.
 17404
 17405     PERFORM 8400-LOG-JOURNAL-RECORD.
 17406
 17407*********************************************************
 17408** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 17409     IF CERT-ADDED-BATCH
 17410         GO TO 2822-REWRITE-ELCERT.
 17411*********************************************************
 17412
 17413     IF NO-CLAIM-ATTACHED
 17414        NEXT SENTENCE
 17415     ELSE
 17416        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17417        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17418
 17419 2822-REWRITE-ELCERT.
 17420     MOVE 'C'                    TO JP-RECORD-TYPE
 17421     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17422
 17423     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17424
 17425
 17426* EXEC CICS REWRITE
 17427*         DATASET    (FILE-ID-ELCERT)
 17428*         FROM       (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 317
* EL6311.cbl
 17429*    END-EXEC.
 17430     MOVE LENGTH OF
 17431      CERTIFICATE-MASTER
 17432       TO DFHEIV11
 17433*    MOVE '&& L                  %   #00015153' TO DFHEIV0
 17434     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17435     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17436     MOVE X'2020233030303135313533' TO DFHEIV0(25:11)
 17437     CALL 'kxdfhei1' USING DFHEIV0,
 17438           FILE-ID-ELCERT,
 17439           CERTIFICATE-MASTER,
 17440           DFHEIV11,
 17441           DFHEIV99
 17442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17443
 17444
 17445     PERFORM 8400-LOG-JOURNAL-RECORD.
 17446
 17447     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17448
 17449 2825-DELETE-CERTIFICATE.
 17450     MOVE 'D'                      TO JP-RECORD-TYPE.
 17451     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17452
 17453     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17454
 17455
 17456* EXEC CICS DELETE
 17457*         DATASET    (FILE-ID-ELCERT)
 17458*    END-EXEC.
 17459*    MOVE '&(                    &   #00015168' TO DFHEIV0
 17460     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17461     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17462     MOVE X'2020233030303135313638' TO DFHEIV0(25:11)
 17463     CALL 'kxdfhei1' USING DFHEIV0,
 17464           FILE-ID-ELCERT,
 17465           DFHEIV99,
 17466           DFHEIV99,
 17467           DFHEIV99,
 17468           DFHEIV99
 17469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17470
 17471
 17472     PERFORM 8400-LOG-JOURNAL-RECORD.
 17473
 17474******************************************************************
 17475*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17476******************************************************************
 17477
 17478     IF CERT-NOTES-ARE-PRESENT
 17479        NEXT SENTENCE
 17480     ELSE
 17481        GO TO 2827-DELETE-MAILING.
 17482
 17483
 17484* EXEC CICS HANDLE CONDITION
 17485*         NOTFND  (2827-DELETE-MAILING)
 17486*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 318
* EL6311.cbl
 17487*    MOVE '"$I                   ! @ #00015183' TO DFHEIV0
 17488     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17489     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17490     MOVE X'4020233030303135313833' TO DFHEIV0(25:11)
 17491     CALL 'kxdfhei1' USING DFHEIV0
 17492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17493
 17494
 17495
 17496* EXEC CICS READ
 17497*        EQUAL
 17498*        DATASET   (FILE-ID-ERNOTE)
 17499*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17500*        RIDFLD    (ELCERT-KEY)
 17501*        UPDATE
 17502*    END-EXEC.
 17503*    MOVE '&"S        EU         (   #00015187' TO DFHEIV0
 17504     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17505     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17506     MOVE X'2020233030303135313837' TO DFHEIV0(25:11)
 17507     CALL 'kxdfhei1' USING DFHEIV0,
 17508           FILE-ID-ERNOTE,
 17509           DFHEIV20,
 17510           DFHEIV99,
 17511           ELCERT-KEY,
 17512           DFHEIV99,
 17513           DFHEIV99,
 17514           DFHEIV99
 17515     SET ADDRESS OF CERTIFICATE-NOTE TO
 17516         DFHEIV20
 17517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17518
 17519
 17520     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17521     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17522     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17523
 17524     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17525
 17526
 17527* EXEC CICS DELETE
 17528*        DATASET   (FILE-ID-ERNOTE)
 17529*    END-EXEC.
 17530*    MOVE '&(                    &   #00015201' TO DFHEIV0
 17531     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17532     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17533     MOVE X'2020233030303135323031' TO DFHEIV0(25:11)
 17534     CALL 'kxdfhei1' USING DFHEIV0,
 17535           FILE-ID-ERNOTE,
 17536           DFHEIV99,
 17537           DFHEIV99,
 17538           DFHEIV99,
 17539           DFHEIV99
 17540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17541
 17542
 17543     PERFORM 8400-LOG-JOURNAL-RECORD.
 17544
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 319
* EL6311.cbl
 17545******************************************************************
 17546*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17547******************************************************************
 17548
 17549 2827-DELETE-MAILING.
 17550     IF CERT-ADDRESS-PRESENT
 17551        NEXT SENTENCE
 17552     ELSE
 17553        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17554
 17555
 17556* EXEC CICS HANDLE CONDITION
 17557*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17558*    END-EXEC.
 17559*    MOVE '"$I                   ! A #00015217' TO DFHEIV0
 17560     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17561     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17562     MOVE X'4120233030303135323137' TO DFHEIV0(25:11)
 17563     CALL 'kxdfhei1' USING DFHEIV0
 17564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17565
 17566
 17567     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17568
 17569
 17570* EXEC CICS READ
 17571*        EQUAL
 17572*        DATASET   (FILE-ID-ERMAIL)
 17573*        SET       (ADDRESS OF MAILING-DATA)
 17574*        RIDFLD    (ERMAIL-KEY)
 17575*        UPDATE
 17576*    END-EXEC.
 17577*    MOVE '&"S        EU         (   #00015223' TO DFHEIV0
 17578     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17579     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17580     MOVE X'2020233030303135323233' TO DFHEIV0(25:11)
 17581     CALL 'kxdfhei1' USING DFHEIV0,
 17582           FILE-ID-ERMAIL,
 17583           DFHEIV20,
 17584           DFHEIV99,
 17585           ERMAIL-KEY,
 17586           DFHEIV99,
 17587           DFHEIV99,
 17588           DFHEIV99
 17589     SET ADDRESS OF MAILING-DATA TO
 17590         DFHEIV20
 17591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17592
 17593
 17594     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17595     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17596     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17597
 17598     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17599
 17600
 17601* EXEC CICS DELETE
 17602*        DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 320
* EL6311.cbl
 17603*    END-EXEC.
 17604*    MOVE '&(                    &   #00015237' TO DFHEIV0
 17605     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17606     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17607     MOVE X'2020233030303135323337' TO DFHEIV0(25:11)
 17608     CALL 'kxdfhei1' USING DFHEIV0,
 17609           FILE-ID-ERMAIL,
 17610           DFHEIV99,
 17611           DFHEIV99,
 17612           DFHEIV99,
 17613           DFHEIV99
 17614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17615
 17616
 17617     PERFORM 8400-LOG-JOURNAL-RECORD.
 17618
 17619 2830-BUILD-NEW-ISSUE-RECORD.
 17620     MOVE SPACES                 TO ELCERT-KEY.
 17621
 17622     IF  BCERTNOL GREATER THAN ZEROS
 17623         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17624
 17625     IF  BSUFIXL  GREATER THAN ZEROS
 17626         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17627
 17628     IF BEFFDTL GREATER THAN ZEROS
 17629        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17630
 17631 2870-WRITE-PENDING-BUSINESS.
 17632     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17633     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17634     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17635     MOVE '5'                    TO DC-OPTION-CODE.
 17636     PERFORM 9700-DATE-LINK.
 17637     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17638
 17639     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17640
 17641     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17642     MOVE 'A'                    TO JP-RECORD-TYPE.
 17643     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17644
 17645
 17646* EXEC CICS WRITE
 17647*        DATASET  (FILE-ID-ERPNDB)
 17648*        FROM     (PENDING-BUSINESS)
 17649*        RIDFLD   (PB-CONTROL-PRIMARY)
 17650*    END-EXEC.
 17651     MOVE LENGTH OF
 17652      PENDING-BUSINESS
 17653       TO DFHEIV11
 17654*    MOVE '&$ L                  ''   #00015269' TO DFHEIV0
 17655     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17656     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17657     MOVE X'2020233030303135323639' TO DFHEIV0(25:11)
 17658     CALL 'kxdfhei1' USING DFHEIV0,
 17659           FILE-ID-ERPNDB,
 17660           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 321
* EL6311.cbl
 17661           DFHEIV11,
 17662           PB-CONTROL-PRIMARY,
 17663           DFHEIV99,
 17664           DFHEIV99
 17665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17666
 17667
 17668     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17669
 17670     PERFORM 8400-LOG-JOURNAL-RECORD.
 17671
 17672     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17673
 17674 2885-RECORD-MISSING.
 17675     MOVE -1                     TO BMAINTL
 17676     MOVE AL-UABON               TO BMAINTA
 17677     MOVE ER-2902                TO EMI-ERROR.
 17678     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17679     GO TO 8200-SEND-DATAONLY.
 17680
 17681 2890-DUPLICATE-RECORD.
 17682     MOVE -1                     TO BMAINTL.
 17683     MOVE AL-UABON               TO BCERTNOA.
 17684     MOVE AL-UNBON               TO BEFFDTA.
 17685     MOVE SPACE                  TO BMAINTI.
 17686
 17687     MOVE 1                      TO EMI-SUB
 17688                                    EMI-SWITCH1
 17689                                    EMI-SWITCH-AREA-1
 17690                                    EMI-SWITCH-AREA-2.
 17691
 17692     MOVE SPACES                 TO EMI-ERROR-LINES.
 17693
 17694
 17695* EXEC CICS SYNCPOINT ROLLBACK
 17696*    END-EXEC.
 17697*    MOVE '6"R                   !   #00015301' TO DFHEIV0
 17698     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17700     MOVE X'2020233030303135333031' TO DFHEIV0(25:11)
 17701     CALL 'kxdfhei1' USING DFHEIV0
 17702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17703
 17704
 17705     MOVE ER-2247                TO EMI-ERROR.
 17706     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17707     GO TO 8200-SEND-DATAONLY.
 17708
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 322
* EL6311.cbl
 17710
 17711******************************************************************
 17712*                                                                *
 17713*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17714*                                                                *
 17715******************************************************************
 17716
 17717 2900-REWRITE-CAN-CERT-KEY.
 17718     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17719
 17720     IF  CCERTNOL GREATER THAN ZEROS
 17721         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17722
 17723     IF  CSUFIXL  GREATER THAN ZEROS
 17724         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17725
 17726     IF  CEFFDTL  GREATER THAN ZEROS
 17727         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17728
 17729 2910-READ-BY-ACCOUNT.
 17730
 17731* EXEC CICS HANDLE CONDITION
 17732*         NOTFND    (2920-PROCESS-REWRITE)
 17733*    END-EXEC.
 17734*    MOVE '"$I                   ! B #00015329' TO DFHEIV0
 17735     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17736     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17737     MOVE X'4220233030303135333239' TO DFHEIV0(25:11)
 17738     CALL 'kxdfhei1' USING DFHEIV0
 17739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17740
 17741
 17742
 17743* EXEC CICS READ
 17744*        SET     (ADDRESS OF PENDING-BUSINESS)
 17745*        DATASET (FILE-ID-ERPNDB2)
 17746*        RIDFLD  (ERPNDB-ALT-KEY)
 17747*    END-EXEC.
 17748*    MOVE '&"S        E          (   #00015333' TO DFHEIV0
 17749     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17750     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17751     MOVE X'2020233030303135333333' TO DFHEIV0(25:11)
 17752     CALL 'kxdfhei1' USING DFHEIV0,
 17753           FILE-ID-ERPNDB2,
 17754           DFHEIV20,
 17755           DFHEIV99,
 17756           ERPNDB-ALT-KEY,
 17757           DFHEIV99,
 17758           DFHEIV99,
 17759           DFHEIV99
 17760     SET ADDRESS OF PENDING-BUSINESS TO
 17761         DFHEIV20
 17762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17763
 17764
 17765     GO TO 2990-DUPLICATE-RECORD.
 17766
 17767  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 323
* EL6311.cbl
 17768
 17769* EXEC CICS HANDLE CONDITION
 17770*         NOTFND    (2985-RECORD-MISSING)
 17771*    END-EXEC.
 17772*    MOVE '"$I                   ! C #00015342' TO DFHEIV0
 17773     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17775     MOVE X'4320233030303135333432' TO DFHEIV0(25:11)
 17776     CALL 'kxdfhei1' USING DFHEIV0
 17777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17778
 17779
 17780     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17781
 17782
 17783* EXEC CICS READ
 17784*        SET     (ADDRESS OF PENDING-BUSINESS)
 17785*        DATASET (FILE-ID-ERPNDB)
 17786*        RIDFLD  (ERPNDB-KEY)
 17787*        UPDATE
 17788*    END-EXEC.
 17789*    MOVE '&"S        EU         (   #00015348' TO DFHEIV0
 17790     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17791     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17792     MOVE X'2020233030303135333438' TO DFHEIV0(25:11)
 17793     CALL 'kxdfhei1' USING DFHEIV0,
 17794           FILE-ID-ERPNDB,
 17795           DFHEIV20,
 17796           DFHEIV99,
 17797           ERPNDB-KEY,
 17798           DFHEIV99,
 17799           DFHEIV99,
 17800           DFHEIV99
 17801     SET ADDRESS OF PENDING-BUSINESS TO
 17802         DFHEIV20
 17803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17804
 17805
 17806     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17807     MOVE 'D'                    TO JP-RECORD-TYPE.
 17808     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17809     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17810
 17811     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17812
 17813     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17814     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17815     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17816
 17817
 17818* EXEC CICS DELETE
 17819*        DATASET    (FILE-ID-ERPNDB)
 17820*    END-EXEC.
 17821*    MOVE '&(                    &   #00015366' TO DFHEIV0
 17822     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17823     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17824     MOVE X'2020233030303135333636' TO DFHEIV0(25:11)
 17825     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 324
* EL6311.cbl
 17826           FILE-ID-ERPNDB,
 17827           DFHEIV99,
 17828           DFHEIV99,
 17829           DFHEIV99,
 17830           DFHEIV99
 17831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17832
 17833
 17834     PERFORM 8400-LOG-JOURNAL-RECORD.
 17835
 17836
 17837* EXEC CICS GETMAIN
 17838*        SET      (ADDRESS OF PENDING-BUSINESS)
 17839*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17840*        INITIMG  (GETMAIN-SPACE)
 17841*    END-EXEC.
 17842*    MOVE ',"IL                  $   #00015372' TO DFHEIV0
 17843     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17844     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17845     MOVE X'2020233030303135333732' TO DFHEIV0(25:11)
 17846     CALL 'kxdfhei1' USING DFHEIV0,
 17847           DFHEIV20,
 17848           ERPNDB-RECORD-LENGTH,
 17849           GETMAIN-SPACE
 17850     SET ADDRESS OF PENDING-BUSINESS TO
 17851         DFHEIV20
 17852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17853
 17854
 17855     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17856
 17857 2950-PROCESS-CANCELS.
 17858
 17859
 17860* EXEC CICS HANDLE CONDITION
 17861*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17862*    END-EXEC.
 17863*    MOVE '"$I                   ! D #00015382' TO DFHEIV0
 17864     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17865     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17866     MOVE X'4420233030303135333832' TO DFHEIV0(25:11)
 17867     CALL 'kxdfhei1' USING DFHEIV0
 17868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17869
 17870
 17871
 17872* EXEC CICS READ
 17873*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17874*        DATASET (FILE-ID-ELCERT)
 17875*        RIDFLD  (ELCERT-KEY)
 17876*        UPDATE
 17877*    END-EXEC.
 17878*    MOVE '&"S        EU         (   #00015386' TO DFHEIV0
 17879     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17880     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17881     MOVE X'2020233030303135333836' TO DFHEIV0(25:11)
 17882     CALL 'kxdfhei1' USING DFHEIV0,
 17883           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 325
* EL6311.cbl
 17884           DFHEIV20,
 17885           DFHEIV99,
 17886           ELCERT-KEY,
 17887           DFHEIV99,
 17888           DFHEIV99,
 17889           DFHEIV99
 17890     SET ADDRESS OF CERTIFICATE-MASTER TO
 17891         DFHEIV20
 17892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17893
 17894
 17895     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17896
 17897     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17898     MOVE 'B'                      TO JP-RECORD-TYPE.
 17899     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17900     PERFORM 8400-LOG-JOURNAL-RECORD.
 17901
 17902     IF PB-CI-LIVES NOT NUMERIC
 17903         MOVE ZERO                    TO PB-CI-LIVES.
 17904
 17905     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17906        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17907        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17908        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17909                                         CM-LF-CANCEL-DT
 17910     ELSE
 17911        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17912        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17913        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17914        MOVE PB-CI-LIVES              TO CM-LIVES.
 17915
 17916     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17917        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17918            MOVE CM-LF-STATUS-AT-CANCEL
 17919                                     TO CM-LF-CURRENT-STATUS
 17920            MOVE SPACE
 17921                                     TO CM-LF-STATUS-AT-CANCEL
 17922        ELSE
 17923            MOVE PB-CI-LF-POLICY-STATUS
 17924                                     TO CM-LF-CURRENT-STATUS
 17925     ELSE
 17926        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17927
 17928     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17929        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17930        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17931        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17932                                         CM-AH-CANCEL-DT
 17933     ELSE
 17934        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17935        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17936        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17937        MOVE PB-CI-LIVES              TO CM-LIVES.
 17938
 17939     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17940        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17941            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 326
* EL6311.cbl
 17942                                     TO CM-AH-CURRENT-STATUS
 17943            MOVE SPACE
 17944                                     TO CM-AH-STATUS-AT-CANCEL
 17945        ELSE
 17946            MOVE PB-CI-AH-POLICY-STATUS
 17947                                     TO CM-AH-CURRENT-STATUS
 17948     ELSE
 17949        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17950
 17951 2975-REWRITE-CERT.
 17952     MOVE 'C'                      TO JP-RECORD-TYPE.
 17953     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17954
 17955
 17956* EXEC CICS REWRITE
 17957*        DATASET    (FILE-ID-ELCERT)
 17958*        FROM       (CERTIFICATE-MASTER)
 17959*    END-EXEC.
 17960     MOVE LENGTH OF
 17961      CERTIFICATE-MASTER
 17962       TO DFHEIV11
 17963*    MOVE '&& L                  %   #00015453' TO DFHEIV0
 17964     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17965     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17966     MOVE X'2020233030303135343533' TO DFHEIV0(25:11)
 17967     CALL 'kxdfhei1' USING DFHEIV0,
 17968           FILE-ID-ELCERT,
 17969           CERTIFICATE-MASTER,
 17970           DFHEIV11,
 17971           DFHEIV99
 17972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17973
 17974
 17975     PERFORM 8400-LOG-JOURNAL-RECORD.
 17976
 17977 2960-BUILD-NEW-CANCEL-RECORD.
 17978     IF  CCERTNOL GREATER THAN ZEROS
 17979         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17980
 17981     IF  CSUFIXL  GREATER THAN ZEROS
 17982         MOVE CSUFIXI             TO PB-CERT-SFX.
 17983
 17984     IF  CEFFDTL  GREATER  THAN ZEROS
 17985         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17986
 17987 2970-WRITE-PENDING-BUSINESS.
 17988     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17989     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17990     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17991     MOVE '5'                    TO DC-OPTION-CODE.
 17992     PERFORM 9700-DATE-LINK.
 17993     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17994
 17995     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17996
 17997     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17998                                    PB-CI-INSURED-SEX
 17999                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 327
* EL6311.cbl
 18000                                    PB-CI-AH-BENEFIT-CD
 18001                                    PB-CI-RATE-CLASS
 18002                                    PB-CI-RATE-DEV-LF
 18003                                    PB-CI-RATE-DEV-AH
 18004                                    PB-CI-LF-ABBR
 18005                                    PB-CI-AH-ABBR
 18006                                    PB-CI-OB-FLAG
 18007                                    PB-CI-LF-POLICY-STATUS
 18008                                    PB-CI-AH-POLICY-STATUS
 18009                                    PB-CI-INDV-GRP-CD
 18010                                    PB-CI-BENEFICIARY-NAME
 18011                                    PB-CI-NOTE-SW
 18012                                    PB-CI-SOC-SEC-NO
 18013                                    PB-CI-MEMBER-NO
 18014                                    PB-CI-INT-CODE
 18015                                    PB-CI-COMP-EXCP-SW
 18016                                    PB-CI-ENTRY-STATUS
 18017                                    PB-CI-CREDIT-INTERFACE-SW-1
 18018                                    PB-CI-CREDIT-INTERFACE-SW-2
 18019                                    PB-CI-ENTRY-BATCH.
 18020
 18021     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 18022                                    PB-CI-AH-SETTLEMENT-DT
 18023                                    PB-CI-DEATH-DT
 18024                                    PB-CI-LF-PRIOR-CANCEL-DT
 18025                                    PB-CI-AH-PRIOR-CANCEL-DT
 18026                                    PB-CI-LOAN-1ST-PMT-DT
 18027                                    PB-CI-ENTRY-DT
 18028                                    PB-CI-LF-EXPIRE-DT
 18029                                    PB-CI-AH-EXPIRE-DT.
 18030
 18031     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 18032                                    PB-CI-LF-TERM
 18033                                    PB-CI-LF-BENEFIT-AMT
 18034                                    PB-CI-LF-ALT-BENEFIT-AMT
 18035                                    PB-CI-LF-PREMIUM-AMT
 18036                                    PB-CI-LF-ALT-PREMIUM-AMT
 18037                                    PB-CI-AH-TERM
 18038                                    PB-CI-AH-BENEFIT-AMT
 18039                                    PB-CI-AH-PREMIUM-AMT
 18040                                    PB-CI-RATE-DEV-PCT-LF
 18041                                    PB-CI-RATE-DEV-PCT-AH
 18042                                    PB-CI-LIFE-COMMISSION
 18043                                    PB-CI-AH-COMMISSION
 18044                                    PB-CI-PAY-FREQUENCY
 18045                                    PB-CI-LOAN-APR
 18046                                    PB-CI-LOAN-TERM
 18047                                    PB-CI-CURR-SEQ
 18048                                    PB-CI-AH-CANCEL-AMT
 18049                                    PB-CI-LF-CANCEL-AMT
 18050                                    PB-CI-EXTENTION-DAYS
 18051                                    PB-CI-TERM-IN-DAYS
 18052                                    PB-CI-LOAN-OFFICER
 18053                                    PB-CI-LIVES
 18054                                    PB-CI-LF-CRIT-PER
 18055                                    PB-CI-AH-CRIT-PER
 18056                                    PB-C-LF-REM-TERM
 18057                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 328
* EL6311.cbl
 18058
 18059     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 18060     MOVE 'A'                    TO JP-RECORD-TYPE.
 18061     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18062
 18063
 18064* EXEC CICS HANDLE CONDITION
 18065*        DUPREC   (2990-DUPLICATE-RECORD)
 18066*    END-EXEC.
 18067*    MOVE '"$%                   ! E #00015546' TO DFHEIV0
 18068     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18069     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18070     MOVE X'4520233030303135353436' TO DFHEIV0(25:11)
 18071     CALL 'kxdfhei1' USING DFHEIV0
 18072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18073
 18074
 18075
 18076* EXEC CICS WRITE
 18077*        DATASET  (FILE-ID-ERPNDB)
 18078*        FROM     (PENDING-BUSINESS)
 18079*        RIDFLD   (PB-CONTROL-PRIMARY)
 18080*    END-EXEC.
 18081     MOVE LENGTH OF
 18082      PENDING-BUSINESS
 18083       TO DFHEIV11
 18084*    MOVE '&$ L                  ''   #00015550' TO DFHEIV0
 18085     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18086     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18087     MOVE X'2020233030303135353530' TO DFHEIV0(25:11)
 18088     CALL 'kxdfhei1' USING DFHEIV0,
 18089           FILE-ID-ERPNDB,
 18090           PENDING-BUSINESS,
 18091           DFHEIV11,
 18092           PB-CONTROL-PRIMARY,
 18093           DFHEIV99,
 18094           DFHEIV99
 18095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18096
 18097
 18098     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 18099
 18100     PERFORM 8400-LOG-JOURNAL-RECORD.
 18101
 18102     GO TO 2325-PROCESS-CANCEL-CHANGES.
 18103
 18104 2985-RECORD-MISSING.
 18105     MOVE -1                     TO CMAINTL
 18106     MOVE AL-UABON               TO CMAINTA.
 18107
 18108     MOVE ER-2902                TO EMI-ERROR.
 18109     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18110     GO TO 8200-SEND-DATAONLY.
 18111
 18112 2990-DUPLICATE-RECORD.
 18113     MOVE SPACE                  TO CMAINTI.
 18114     MOVE -1                     TO CMAINTL.
 18115     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 329
* EL6311.cbl
 18116     MOVE AL-UNBON               TO CEFFDTA.
 18117
 18118     MOVE 1                      TO EMI-SUB
 18119                                    EMI-SWITCH1
 18120                                    EMI-SWITCH-AREA-1
 18121                                    EMI-SWITCH-AREA-2.
 18122     MOVE SPACES                 TO EMI-ERROR-LINES.
 18123
 18124
 18125* EXEC CICS SYNCPOINT ROLLBACK
 18126*    END-EXEC.
 18127*    MOVE '6"R                   !   #00015582' TO DFHEIV0
 18128     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18129     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18130     MOVE X'2020233030303135353832' TO DFHEIV0(25:11)
 18131     CALL 'kxdfhei1' USING DFHEIV0
 18132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18133
 18134
 18135     MOVE ER-2247                TO EMI-ERROR.
 18136     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18137     GO TO 8200-SEND-DATAONLY.
 18138
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 330
* EL6311.cbl
 18140
 18141***************************************************************
 18142*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 18143*     PREMIUM FOR A SINGLE BATCH.                             *
 18144*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 18145***************************************************************
 18146
 18147 3000-BATCH-MAINLINE.
 18148     IF PI-PREV-KEY NOT = SPACES
 18149         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 18150     ELSE
 18151         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 18152
 18153     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 18154
 18155 3010-READNEXT.
 18156
 18157* EXEC CICS READ
 18158*         DATASET    (FILE-ID-ERPNDB)
 18159*         SET        (ADDRESS OF PENDING-BUSINESS)
 18160*         RIDFLD     (ERPNDB-KEY)
 18161*         GTEQ
 18162*    END-EXEC.
 18163*    MOVE '&"S        G          (   #00015606' TO DFHEIV0
 18164     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18165     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18166     MOVE X'2020233030303135363036' TO DFHEIV0(25:11)
 18167     CALL 'kxdfhei1' USING DFHEIV0,
 18168           FILE-ID-ERPNDB,
 18169           DFHEIV20,
 18170           DFHEIV99,
 18171           ERPNDB-KEY,
 18172           DFHEIV99,
 18173           DFHEIV99,
 18174           DFHEIV99
 18175     SET ADDRESS OF PENDING-BUSINESS TO
 18176         DFHEIV20
 18177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18178
 18179
 18180     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 18181        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 18182          GO TO 3030-END-BATCH.
 18183
 18184     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 18185
 18186     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 18187        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 18188          GO TO 3020-BUMP-SEQ.
 18189
 18190     IF PB-ISSUE
 18191        ADD +1                   TO WS-ISS-TOTAL-CNT
 18192        IF PB-FATAL-ERRORS
 18193           ADD +1                      TO WS-ISS-FATAL-CNT
 18194           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18195           GO TO 3020-BUMP-SEQ
 18196        ELSE
 18197           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 331
* EL6311.cbl
 18198              ADD +1                      TO WS-ISS-FORCE-CNT
 18199              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18200              GO TO 3020-BUMP-SEQ
 18201           ELSE
 18202              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18203                 ADD +1                      TO WS-ISS-HOLD-CNT
 18204                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18205                 GO TO 3020-BUMP-SEQ
 18206              ELSE
 18207                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 18208                     THRU  3299-EXIT
 18209                 GO TO 3020-BUMP-SEQ.
 18210
 18211     IF PB-CANCELLATION
 18212        ADD +1                   TO WS-CAN-TOTAL-CNT
 18213        IF PB-FATAL-ERRORS
 18214           ADD +1                 TO WS-CAN-FATAL-CNT
 18215           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18216           GO TO 3020-BUMP-SEQ
 18217        ELSE
 18218           IF PB-UNFORCED-ERRORS
 18219              ADD +1                 TO WS-CAN-FORCE-CNT
 18220              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18221              GO TO 3020-BUMP-SEQ
 18222           ELSE
 18223              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18224                 ADD +1                 TO WS-CAN-HOLD-CNT
 18225                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18226                 GO TO 3020-BUMP-SEQ
 18227              ELSE
 18228                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 18229                     THRU  3499-EXIT
 18230                 GO TO 3020-BUMP-SEQ.
 18231
 18232     IF PB-BATCH-TRAILER
 18233         GO TO 3030-END-BATCH.
 18234
 18235 3020-BUMP-SEQ.
 18236     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 18237     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18238     GO TO 3010-READNEXT.
 18239
 18240 3030-END-BATCH.
 18241     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 18242     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 18243     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 18244     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 18245
 18246     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18247                                          - WS-ISS-FORCE-CNT
 18248                                          - WS-ISS-HOLD-CNT).
 18249
 18250     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 18251     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 18252
 18253     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 18254     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 18255     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 332
* EL6311.cbl
 18256     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 18257     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18258                                          - WS-CAN-FORCE-CNT
 18259                                          - WS-CAN-HOLD-CNT).
 18260     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 18261     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 18262
 18263     COMPUTE WS-NET-TOTAL-CNT
 18264         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 18265     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 18266     COMPUTE WS-NET-FATAL-CNT
 18267         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 18268     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 18269     COMPUTE WS-NET-FORCE-CNT
 18270         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 18271     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 18272     COMPUTE WS-NET-HOLD-CNT
 18273         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 18274     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 18275
 18276     COMPUTE WS-NET-AVAIL-CNT
 18277          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18278                              - WS-ISS-FORCE-CNT
 18279                              - WS-ISS-HOLD-CNT)
 18280          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18281                              - WS-CAN-FORCE-CNT
 18282                              - WS-CAN-HOLD-CNT).
 18283     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 18284
 18285     COMPUTE WS-NET-GOOD-PREM
 18286         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 18287     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 18288     COMPUTE WS-NET-BAD-PREM
 18289         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 18290     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 18291
 18292     MOVE 0000                   TO EMI-ERROR.
 18293     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18294     MOVE -1                     TO DPFENTRL.
 18295     GO TO 8200-SEND-DATAONLY.
 18296
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 333
* EL6311.cbl
 18298
 18299******************************************************************
 18300*                                                                *
 18301*           A D D    B A D   I S S U E   P R E M I U M           *
 18302*                                                                *
 18303******************************************************************
 18304
 18305 3100-ADD-BAD-ISSUE-PREM.
 18306     IF PB-OVERRIDE-LIFE
 18307       OR PB-OVERRIDE-BOTH
 18308           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18309           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18310       ELSE
 18311           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18312           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18313
 18314     IF PB-OVERRIDE-AH
 18315       OR PB-OVERRIDE-BOTH
 18316           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18317       ELSE
 18318           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18319
 18320 3199-EXIT.
 18321     EXIT.
 18322
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 334
* EL6311.cbl
 18324
 18325******************************************************************
 18326*                                                                *
 18327*       A D D   G O O D   I S S U E   P R E M I U M              *
 18328*                                                                *
 18329******************************************************************
 18330
 18331 3200-ADD-GOOD-ISSUE-PREM.
 18332     IF PB-OVERRIDE-LIFE
 18333       OR PB-OVERRIDE-BOTH
 18334           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18335           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18336       ELSE
 18337           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18338           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18339
 18340     IF PB-OVERRIDE-AH
 18341       OR PB-OVERRIDE-BOTH
 18342           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18343       ELSE
 18344           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18345
 18346 3299-EXIT.
 18347     EXIT.
 18348
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 335
* EL6311.cbl
 18350
 18351
 18352******************************************************************
 18353*                                                                *
 18354*        A D D   B A D   C A N C E L   P R E M I U M             *
 18355*                                                                *
 18356******************************************************************
 18357
 18358 3300-ADD-BAD-CANCEL-PREM.
 18359     IF PB-OVERRIDE-LIFE
 18360       OR PB-OVERRIDE-BOTH
 18361           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18362       ELSE
 18363           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18364
 18365     IF PB-OVERRIDE-AH
 18366       OR PB-OVERRIDE-BOTH
 18367           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18368       ELSE
 18369           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18370
 18371 3399-EXIT.
 18372     EXIT.
 18373
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 336
* EL6311.cbl
 18375
 18376******************************************************************
 18377*                                                                *
 18378*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18379*                                                                *
 18380******************************************************************
 18381
 18382 3400-ADD-GOOD-CANCEL-PREM.
 18383     IF PB-OVERRIDE-LIFE
 18384       OR PB-OVERRIDE-BOTH
 18385           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18386       ELSE
 18387           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18388
 18389     IF PB-OVERRIDE-AH
 18390       OR PB-OVERRIDE-BOTH
 18391           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18392       ELSE
 18393           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18394
 18395 3499-EXIT.
 18396     EXIT.
 18397
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 337
* EL6311.cbl
 18399
 18400******************************************************************
 18401*                                                                *
 18402*           E D I T   B A T C H   D A T A                        *
 18403*                                                                *
 18404******************************************************************
 18405
 18406 3500-EDIT-BATCH-DATA.
 18407     IF PI-PREV-KEY NOT = SPACES
 18408        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18409     ELSE
 18410        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18411
 18412     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18413     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18414
 18415
 18416* EXEC CICS HANDLE CONDITION
 18417*         NOTFND      (3590-NOT-FOUND)
 18418*    END-EXEC.
 18419*    MOVE '"$I                   ! F #00015848' TO DFHEIV0
 18420     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18421     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18422     MOVE X'4620233030303135383438' TO DFHEIV0(25:11)
 18423     CALL 'kxdfhei1' USING DFHEIV0
 18424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18425
 18426
 18427     IF DRISSL   GREATER THAN ZEROS OR
 18428        DRISSL   GREATER THAN ZEROS OR
 18429        DRLFPRML GREATER THAN ZEROS OR
 18430        DRAHPRML GREATER THAN ZEROS OR
 18431        DRCANCL  GREATER THAN ZEROS OR
 18432        DRLFRFDL GREATER THAN ZEROS OR
 18433        DRAHRFDL GREATER THAN ZEROS
 18434              NEXT SENTENCE
 18435          ELSE
 18436              MOVE ER-3224    TO EMI-ERROR
 18437              MOVE -1         TO DPFENTRL
 18438              MOVE AL-UNBON   TO DPFENTRA
 18439              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18440              GO TO 8200-SEND-DATAONLY.
 18441
 18442     IF NOT MODIFY-CAP
 18443         MOVE 'UPDATE'       TO SM-READ
 18444         PERFORM 9995-SECURITY-VIOLATION
 18445         MOVE ER-0070        TO EMI-ERROR
 18446         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18447         GO TO 8100-SEND-INITIAL-MAP.
 18448
 18449        IF DRISSL GREATER THAN ZEROS
 18450           MOVE AL-UNNON         TO DRISSA
 18451           MOVE DRISSI           TO DEEDIT-FIELD
 18452           PERFORM 8600-DEEDIT
 18453           IF DEEDIT-FIELD-V0  NUMERIC
 18454              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18455           ELSE
 18456              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 338
* EL6311.cbl
 18457              MOVE -1         TO DRISSL
 18458              MOVE AL-UNBON   TO DRISSA
 18459              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18460
 18461        IF DRLFPRML GREATER THAN ZEROS
 18462           MOVE AL-UNNON         TO DRLFPRMA
 18463
 18464* EXEC CICS BIF DEEDIT
 18465*              FIELD  (DRLFPRMI)
 18466*              LENGTH (11)
 18467*          END-EXEC
 18468     MOVE 11
 18469       TO DFHEIV11
 18470*    MOVE '@"L                   #   #00015888' TO DFHEIV0
 18471     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18472     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18473     MOVE X'2020233030303135383838' TO DFHEIV0(25:11)
 18474     CALL 'kxdfhei1' USING DFHEIV0,
 18475           DRLFPRMI,
 18476           DFHEIV11
 18477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18478           IF DRLFPRMI NUMERIC
 18479              MOVE DRLFPRMI   TO WS-DRLFPRM
 18480*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18481*          PERFORM 8600-DEEDIT
 18482*          IF DEEDIT-FIELD-V2  NUMERIC
 18483*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18484           ELSE
 18485              MOVE ER-2223    TO EMI-ERROR
 18486              MOVE -1         TO DRLFPRML
 18487              MOVE AL-UNBON   TO DRLFPRMA
 18488              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18489
 18490        IF DRAHPRML GREATER THAN ZEROS
 18491           MOVE AL-UNNON         TO DRAHPRMA
 18492
 18493* EXEC CICS BIF DEEDIT
 18494*              FIELD  (DRAHPRMI)
 18495*              LENGTH (11)
 18496*          END-EXEC
 18497     MOVE 11
 18498       TO DFHEIV11
 18499*    MOVE '@"L                   #   #00015906' TO DFHEIV0
 18500     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18501     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18502     MOVE X'2020233030303135393036' TO DFHEIV0(25:11)
 18503     CALL 'kxdfhei1' USING DFHEIV0,
 18504           DRAHPRMI,
 18505           DFHEIV11
 18506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18507           IF DRAHPRMI NUMERIC
 18508              MOVE DRAHPRMI   TO WS-DRAHPRM
 18509*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18510*          PERFORM 8600-DEEDIT
 18511*          IF DEEDIT-FIELD-V2  NUMERIC
 18512*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18513           ELSE
 18514              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 339
* EL6311.cbl
 18515              MOVE -1         TO DRAHPRML
 18516              MOVE AL-UNBON   TO DRAHPRMA
 18517              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18518
 18519        IF DRCANCL GREATER THAN ZEROS
 18520           MOVE AL-UNNON         TO DRCANCA
 18521           MOVE DRCANCI          TO DEEDIT-FIELD
 18522           PERFORM 8600-DEEDIT
 18523           IF DEEDIT-FIELD-V0  NUMERIC
 18524              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18525           ELSE
 18526              MOVE ER-2223    TO EMI-ERROR
 18527              MOVE -1         TO DRCANCL
 18528              MOVE AL-UNBON   TO DRCANCL
 18529              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18530
 18531        IF DRLFRFDL GREATER THAN ZEROS
 18532           MOVE AL-UNNON         TO DRLFRFDA
 18533
 18534* EXEC CICS BIF DEEDIT
 18535*              FIELD  (DRLFRFDI)
 18536*              LENGTH (11)
 18537*          END-EXEC
 18538     MOVE 11
 18539       TO DFHEIV11
 18540*    MOVE '@"L                   #   #00015936' TO DFHEIV0
 18541     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18542     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18543     MOVE X'2020233030303135393336' TO DFHEIV0(25:11)
 18544     CALL 'kxdfhei1' USING DFHEIV0,
 18545           DRLFRFDI,
 18546           DFHEIV11
 18547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18548           IF DRLFRFDI NUMERIC
 18549              MOVE DRLFRFDI   TO WS-DRLFRFD
 18550*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18551*          PERFORM 8600-DEEDIT
 18552*          IF DEEDIT-FIELD-V2  NUMERIC
 18553*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18554           ELSE
 18555              MOVE ER-2223    TO EMI-ERROR
 18556              MOVE -1         TO DRLFRFDL
 18557              MOVE AL-UNBON   TO DRLFRFDA
 18558              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18559
 18560        IF DRAHRFDL GREATER THAN ZEROS
 18561           MOVE AL-UNNON         TO DRAHRFDA
 18562
 18563* EXEC CICS BIF DEEDIT
 18564*              FIELD  (DRAHRFDI)
 18565*              LENGTH (11)
 18566*          END-EXEC
 18567     MOVE 11
 18568       TO DFHEIV11
 18569*    MOVE '@"L                   #   #00015954' TO DFHEIV0
 18570     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18571     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18572     MOVE X'2020233030303135393534' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 340
* EL6311.cbl
 18573     CALL 'kxdfhei1' USING DFHEIV0,
 18574           DRAHRFDI,
 18575           DFHEIV11
 18576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18577           IF DRAHRFDI NUMERIC
 18578              MOVE DRAHRFDI   TO WS-DRAHRFD
 18579*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18580*          PERFORM 8600-DEEDIT
 18581*          IF DEEDIT-FIELD-V2  NUMERIC
 18582*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18583           ELSE
 18584              MOVE ER-2223    TO EMI-ERROR
 18585              MOVE -1         TO DRAHRFDL
 18586              MOVE AL-UNBON   TO DRAHRFDA
 18587              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18588
 18589     IF EMI-ERROR = ZEROS
 18590        GO 3600-UPDATE-BATCH-HEADER.
 18591
 18592     GO TO 8200-SEND-DATAONLY.
 18593
 18594 3590-NOT-FOUND.
 18595     MOVE ER-2192                TO EMI-ERROR.
 18596     MOVE -1                     TO DPFENTRL.
 18597     MOVE AL-UNBON               TO DPFENTRA.
 18598     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18599     GO TO 8200-SEND-DATAONLY.
 18600
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 341
* EL6311.cbl
 18602
 18603******************************************************************
 18604*                                                                *
 18605*           U P D A T E   B A T C H   H E A D E R                *
 18606*                                                                *
 18607******************************************************************
 18608
 18609 3600-UPDATE-BATCH-HEADER.
 18610
 18611* EXEC CICS HANDLE CONDITION
 18612*         NOTFND      (3690-NOT-FOUND)
 18613*    END-EXEC.
 18614*    MOVE '"$I                   ! G #00015991' TO DFHEIV0
 18615     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18616     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18617     MOVE X'4720233030303135393931' TO DFHEIV0(25:11)
 18618     CALL 'kxdfhei1' USING DFHEIV0
 18619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18620
 18621
 18622
 18623* EXEC CICS READ
 18624*        DATASET (FILE-ID-ERPNDB)
 18625*        RIDFLD  (ERPNDB-KEY)
 18626*        SET     (ADDRESS OF PENDING-BUSINESS)
 18627*        UPDATE
 18628*    END-EXEC.
 18629*    MOVE '&"S        EU         (   #00015995' TO DFHEIV0
 18630     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18631     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18632     MOVE X'2020233030303135393935' TO DFHEIV0(25:11)
 18633     CALL 'kxdfhei1' USING DFHEIV0,
 18634           FILE-ID-ERPNDB,
 18635           DFHEIV20,
 18636           DFHEIV99,
 18637           ERPNDB-KEY,
 18638           DFHEIV99,
 18639           DFHEIV99,
 18640           DFHEIV99
 18641     SET ADDRESS OF PENDING-BUSINESS TO
 18642         DFHEIV20
 18643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18644
 18645
 18646     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18647     MOVE 'B'                    TO JP-RECORD-TYPE.
 18648     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18649
 18650     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18651
 18652     PERFORM 8400-LOG-JOURNAL-RECORD.
 18653
 18654     IF DRISSL GREATER THAN ZEROS
 18655        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18656
 18657     IF DRCANCL GREATER THAN ZEROS
 18658        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18659
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 342
* EL6311.cbl
 18660
 18661     IF DRLFPRML GREATER THAN ZEROS
 18662        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18663
 18664     IF DRAHPRML GREATER THAN ZEROS
 18665        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18666
 18667     IF DRLFRFDL GREATER THAN ZEROS
 18668        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18669
 18670     IF DRAHRFDL GREATER THAN ZEROS
 18671        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18672
 18673 3670-REWRITE-BATCH-HEADER.
 18674     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18675        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18676        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18677        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18678        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18679        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18680        MOVE SPACE               TO PB-OUT-BAL-CD
 18681     ELSE
 18682        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18683
 18684     MOVE 'C'                    TO JP-RECORD-TYPE.
 18685     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18686
 18687
 18688* EXEC CICS REWRITE
 18689*         DATASET      (FILE-ID-ERPNDB)
 18690*         FROM         (PENDING-BUSINESS)
 18691*    END-EXEC.
 18692     MOVE LENGTH OF
 18693      PENDING-BUSINESS
 18694       TO DFHEIV11
 18695*    MOVE '&& L                  %   #00016043' TO DFHEIV0
 18696     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18697     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18698     MOVE X'2020233030303136303433' TO DFHEIV0(25:11)
 18699     CALL 'kxdfhei1' USING DFHEIV0,
 18700           FILE-ID-ERPNDB,
 18701           PENDING-BUSINESS,
 18702           DFHEIV11,
 18703           DFHEIV99
 18704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18705
 18706
 18707     PERFORM 8400-LOG-JOURNAL-RECORD.
 18708
 18709     GO TO 7200-DISPLAY-BATCHES.
 18710
 18711 3690-NOT-FOUND.
 18712     MOVE ER-2192                TO EMI-ERROR.
 18713     MOVE -1                     TO DPFENTRL.
 18714     MOVE AL-UNBON               TO DPFENTRA.
 18715     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18716     GO TO 8200-SEND-DATAONLY.
 18717
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 343
* EL6311.cbl
 18719
 18720******************************************************************
 18721*                                                                *
 18722*           R E - D I S P L A Y   R E C O R D                    *
 18723*                                                                *
 18724******************************************************************
 18725
 18726 3900-RE-DISPLAY-RECORD.
 18727
 18728* EXEC CICS HANDLE CONDITION
 18729*         NOTFND   (3990-NOT-FOUND)
 18730*    END-EXEC.
 18731*    MOVE '"$I                   ! H #00016068' TO DFHEIV0
 18732     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18733     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18734     MOVE X'4820233030303136303638' TO DFHEIV0(25:11)
 18735     CALL 'kxdfhei1' USING DFHEIV0
 18736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18737
 18738
 18739     IF PI-DISPLAY-ORIGINAL-BATCH
 18740         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18741     ELSE
 18742         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18743
 18744
 18745* EXEC CICS READ
 18746*         DATASET   (FILE-ID)
 18747*         RIDFLD    (PI-PREV-KEY)
 18748*         SET       (ADDRESS OF PENDING-BUSINESS)
 18749*    END-EXEC.
 18750*    MOVE '&"S        E          (   #00016077' TO DFHEIV0
 18751     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18752     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18753     MOVE X'2020233030303136303737' TO DFHEIV0(25:11)
 18754     CALL 'kxdfhei1' USING DFHEIV0,
 18755           FILE-ID,
 18756           DFHEIV20,
 18757           DFHEIV99,
 18758           PI-PREV-KEY,
 18759           DFHEIV99,
 18760           DFHEIV99,
 18761           DFHEIV99
 18762     SET ADDRESS OF PENDING-BUSINESS TO
 18763         DFHEIV20
 18764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18765
 18766
 18767     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18768
 18769     IF PB-ISSUE
 18770         GO TO 7000-DISPLAY-ISSUES.
 18771
 18772     IF PB-CANCELLATION
 18773         GO TO 7100-DISPLAY-CANCELS.
 18774
 18775     IF PB-BATCH-TRAILER
 18776         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 344
* EL6311.cbl
 18777
 18778 3990-NOT-FOUND.
 18779     MOVE LOW-VALUES             TO EL631BI.
 18780
 18781     IF PI-MAP-NAME = EL631B
 18782         MOVE -1                  TO BMAINTL
 18783     ELSE
 18784         MOVE -1                  TO CMAINTL.
 18785
 18786     GO TO 8100-SEND-INITIAL-MAP.
 18787
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 345
* EL6311.cbl
 18789
 18790***************************************************************
 18791*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18792*                                                             *
 18793*      1. START BROWSE WITH                                   *
 18794*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18795*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18796*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18797*                                                             *
 18798*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18799*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18800*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18801*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18802*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18803*               AND IS IT TO BE DISPLAYED.                    *
 18804*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18805*               DISPLAYED.                                    *
 18806*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18807*               DISPLAYED.                                    *
 18808*                                                             *
 18809*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18810*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18811***************************************************************
 18812
 18813 4000-BROWSE-DETAIL-FORWARD.
 18814     IF FIRST-TIME
 18815        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18816     ELSE
 18817        IF SHOW-RECORD
 18818           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18819           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18820           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18821           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18822           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18823        ELSE
 18824           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18825
 18826
 18827* EXEC CICS HANDLE CONDITION
 18828*         NOTFND   (4050-END-RECORDS)
 18829*         ENDFILE  (4050-END-RECORDS)
 18830*    END-EXEC.
 18831*    MOVE '"$I''                  ! I #00016142' TO DFHEIV0
 18832     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18833     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18834     MOVE X'4920233030303136313432' TO DFHEIV0(25:11)
 18835     CALL 'kxdfhei1' USING DFHEIV0
 18836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18837
 18838
 18839
 18840* EXEC CICS STARTBR
 18841*         DATASET   (FILE-ID-ERPNDB2)
 18842*         RIDFLD    (ERPNDB-ALT-KEY)
 18843*    END-EXEC.
 18844     MOVE 0
 18845       TO DFHEIV11
 18846*    MOVE '&,         G          &   #00016147' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 346
* EL6311.cbl
 18847     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18848     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18849     MOVE X'2020233030303136313437' TO DFHEIV0(25:11)
 18850     CALL 'kxdfhei1' USING DFHEIV0,
 18851           FILE-ID-ERPNDB2,
 18852           ERPNDB-ALT-KEY,
 18853           DFHEIV99,
 18854           DFHEIV11,
 18855           DFHEIV99
 18856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18857
 18858
 18859     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18860
 18861     IF FIRST-TIME OR SHOW-RECORD
 18862        MOVE SPACE               TO WS-FIRST-TIME-SW
 18863        GO TO 4005-READ-NEXT-RECORD.
 18864
 18865
 18866* EXEC CICS READNEXT
 18867*         DATASET    (FILE-ID-ERPNDB2)
 18868*         SET        (ADDRESS OF PENDING-BUSINESS)
 18869*         RIDFLD     (ERPNDB-ALT-KEY)
 18870*    END-EXEC.
 18871     MOVE 0
 18872       TO DFHEIV11
 18873*    MOVE '&.S                   )   #00016158' TO DFHEIV0
 18874     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18875     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18876     MOVE X'2020233030303136313538' TO DFHEIV0(25:11)
 18877     CALL 'kxdfhei1' USING DFHEIV0,
 18878           FILE-ID-ERPNDB2,
 18879           DFHEIV20,
 18880           DFHEIV99,
 18881           ERPNDB-ALT-KEY,
 18882           DFHEIV99,
 18883           DFHEIV11,
 18884           DFHEIV99,
 18885           DFHEIV99
 18886     SET ADDRESS OF PENDING-BUSINESS TO
 18887         DFHEIV20
 18888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18889
 18890
 18891 4005-READ-NEXT-RECORD.
 18892
 18893* EXEC CICS READNEXT
 18894*         DATASET    (FILE-ID-ERPNDB2)
 18895*         SET        (ADDRESS OF PENDING-BUSINESS)
 18896*         RIDFLD     (ERPNDB-ALT-KEY)
 18897*    END-EXEC.
 18898     MOVE 0
 18899       TO DFHEIV11
 18900*    MOVE '&.S                   )   #00016165' TO DFHEIV0
 18901     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18902     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18903     MOVE X'2020233030303136313635' TO DFHEIV0(25:11)
 18904     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 347
* EL6311.cbl
 18905           FILE-ID-ERPNDB2,
 18906           DFHEIV20,
 18907           DFHEIV99,
 18908           ERPNDB-ALT-KEY,
 18909           DFHEIV99,
 18910           DFHEIV11,
 18911           DFHEIV99,
 18912           DFHEIV99
 18913     SET ADDRESS OF PENDING-BUSINESS TO
 18914         DFHEIV20
 18915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18916
 18917
 18918     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18919
 18920     IF WS-BATCH-PREFIX = '#CL'
 18921        GO TO 4005-READ-NEXT-RECORD.
 18922
 18923     IF SHOW-RECORD
 18924        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18925           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18926           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18927           PB-STATE         NOT = PI-PB-STATE          OR
 18928           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18929           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18930           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18931           GO TO 4050-END-RECORDS
 18932        ELSE
 18933           GO TO 4010-CHECK-REC-TYPE.
 18934
 18935     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18936        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18937        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18938        PB-STATE            NOT = PI-PB-STATE          OR
 18939        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18940        GO TO 4050-END-RECORDS.
 18941
 18942     IF PB-BATCH-TRAILER
 18943        GO TO 4005-READ-NEXT-RECORD.
 18944
 18945     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18946        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18947           GO TO 4005-READ-NEXT-RECORD
 18948        ELSE
 18949           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18950              GO TO 4010-CHECK-REC-TYPE
 18951           ELSE
 18952              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18953                 GO TO 4010-CHECK-REC-TYPE
 18954              ELSE
 18955                 GO TO 4005-READ-NEXT-RECORD.
 18956
 18957     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18958        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18959           GO TO 4005-READ-NEXT-RECORD.
 18960
 18961 4010-CHECK-REC-TYPE.
 18962     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 348
* EL6311.cbl
 18963         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18964             NEXT SENTENCE
 18965         ELSE
 18966             GO TO 4005-READ-NEXT-RECORD.
 18967
 18968     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18969         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18970             NEXT SENTENCE
 18971        ELSE
 18972             GO TO 4005-READ-NEXT-RECORD.
 18973
 18974     IF NOT DISPLAY-CHANGE-RECORDS AND
 18975            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18976        GO TO 4005-READ-NEXT-RECORD.
 18977
 18978     IF DISPLAY-HOLD-RECORDS AND
 18979        NOT PB-RECORD-ON-HOLD
 18980          GO TO 4005-READ-NEXT-RECORD.
 18981
 18982     IF PB-ISSUE
 18983        IF DISPLAY-CHK-REQ-RECORDS
 18984            GO TO 4005-READ-NEXT-RECORD.
 18985
 18986     IF PB-ISSUE
 18987        IF ISSUE-WITH-WARNING
 18988           IF PB-WARNING-ERRORS
 18989              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18990                  GO TO 4005-READ-NEXT-RECORD
 18991              ELSE
 18992                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18993                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18994                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18995                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18996                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18997                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18998                 GO TO 7000-DISPLAY-ISSUES
 18999           ELSE
 19000              GO TO 4005-READ-NEXT-RECORD.
 19001
 19002     IF PB-ISSUE
 19003        IF (ISSUES-IN-ERROR AND
 19004            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19005            ALL-ISSUES
 19006            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19007            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19008            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19009            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19010            MOVE PB-SV-STATE            TO PI-SV-STATE
 19011            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19012            GO TO 7000-DISPLAY-ISSUES
 19013        ELSE
 19014            GO TO 4005-READ-NEXT-RECORD.
 19015
 19016     IF PB-CANCELLATION
 19017        IF DISPLAY-CHK-REQ-RECORDS
 19018           IF PB-C-REFUND-REQUESTED
 19019              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19020              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 349
* EL6311.cbl
 19021              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19022              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19023              MOVE PB-SV-STATE            TO PI-SV-STATE
 19024              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19025              GO TO 7100-DISPLAY-CANCELS
 19026           ELSE
 19027               GO TO 4005-READ-NEXT-RECORD.
 19028
 19029     IF PB-CANCELLATION
 19030        IF CANCEL-WITH-WARNING
 19031           IF PB-WARNING-ERRORS
 19032              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19033                  GO TO 4005-READ-NEXT-RECORD
 19034              ELSE
 19035                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19036                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19037                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19038                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19039                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19040                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19041                 GO TO 7100-DISPLAY-CANCELS
 19042           ELSE
 19043              GO TO 4005-READ-NEXT-RECORD.
 19044
 19045     IF PB-CANCELLATION
 19046        IF (CANCEL-IN-ERROR  AND
 19047            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19048            ALL-CANCELS
 19049            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19050            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19051            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19052            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19053            MOVE PB-SV-STATE            TO PI-SV-STATE
 19054            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19055            GO TO 7100-DISPLAY-CANCELS.
 19056
 19057     GO TO 4005-READ-NEXT-RECORD.
 19058
 19059 4050-END-RECORDS.
 19060******************************************************************
 19061*                                                                *
 19062*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19063*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19064*         PROGRAM.                                               *
 19065*                                                                *
 19066******************************************************************
 19067
 19068     IF BROWSE-STARTED
 19069        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19070
 19071* EXEC CICS ENDBR
 19072*            DATASET  (FILE-ID-ERPNDB2)
 19073*       END-EXEC.
 19074     MOVE 0
 19075       TO DFHEIV11
 19076*    MOVE '&2                    $   #00016323' TO DFHEIV0
 19077     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19078     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 350
* EL6311.cbl
 19079     MOVE X'2020233030303136333233' TO DFHEIV0(25:11)
 19080     CALL 'kxdfhei1' USING DFHEIV0,
 19081           FILE-ID-ERPNDB2,
 19082           DFHEIV11,
 19083           DFHEIV99
 19084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19085
 19086
 19087     IF  EIBTRNID NOT = TRANS-EXB1
 19088         IF PENDING-BUS-RECS-FOUND
 19089             NEXT SENTENCE
 19090           ELSE
 19091             MOVE '9'            TO PI-BROWSE-SW
 19092             GO TO 9400-CLEAR.
 19093
 19094     IF SHOW-RECORD
 19095        MOVE ER-2253            TO EMI-ERROR
 19096       ELSE
 19097        MOVE ER-2254            TO EMI-ERROR.
 19098
 19099     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19100
 19101     IF PI-MAP-NAME = SPACES
 19102        MOVE -1                  TO DPFENTRL
 19103        MOVE EL631D               TO PI-MAP-NAME
 19104        GO TO 8100-SEND-INITIAL-MAP.
 19105
 19106     IF PI-MAP-NAME = EL631B
 19107        MOVE -1                  TO BMAINTL
 19108     ELSE
 19109        IF PI-MAP-NAME = EL631C
 19110           MOVE -1               TO CMAINTL
 19111        ELSE
 19112           MOVE -1               TO DPFENTRL.
 19113
 19114     GO TO 8200-SEND-DATAONLY.
 19115
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 351
* EL6311.cbl
 19117
 19118***************************************************************
 19119*                                                             *
 19120*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 19121*                                                             *
 19122*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 19123*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19124*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19125*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 19126*                                                             *
 19127*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19128*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19129*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 19130*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19131*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19132*                AND IS IT TO BE DISPLAYED.                   *
 19133*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19134*                DISPLAYED.                                   *
 19135*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19136*                DISPLAYED.                                   *
 19137*                                                             *
 19138*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19139*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19140*                                                             *
 19141*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19142*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19143*                THEY ARE NOT TO BE DISPLAYED.                *
 19144*                                                             *
 19145***************************************************************
 19146
 19147 4100-BROWSE-PRIMARY-FORWARD.
 19148     IF FIRST-TIME  OR SHOW-RECORD
 19149        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 19150        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 19151        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 19152     ELSE
 19153        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 19154        IF ERPNDB-BATCH-SEQ-NO = +9999
 19155           GO TO 4150-END-BATCH
 19156        ELSE
 19157           IF DISPLAY-CHANGE-RECORDS
 19158              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19159           ELSE
 19160              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19161              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19162
 19163     IF FIRST-TIME
 19164         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 19165            PI-PB-BATCH-SEQ-NO NOT = ZERO
 19166              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 19167
 19168
 19169* EXEC CICS HANDLE CONDITION
 19170*         ENDFILE  (4150-END-BATCH)
 19171*    END-EXEC.
 19172*    MOVE '"$''                   ! J #00016408' TO DFHEIV0
 19173     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 19174     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 352
* EL6311.cbl
 19175     MOVE X'4A20233030303136343038' TO DFHEIV0(25:11)
 19176     CALL 'kxdfhei1' USING DFHEIV0
 19177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19178
 19179
 19180 4105-READ-NEXT.
 19181
 19182* EXEC CICS HANDLE CONDITION
 19183*         NOTFND    (4150-END-BATCH)
 19184*    END-EXEC.
 19185*    MOVE '"$I                   ! K #00016413' TO DFHEIV0
 19186     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19187     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19188     MOVE X'4B20233030303136343133' TO DFHEIV0(25:11)
 19189     CALL 'kxdfhei1' USING DFHEIV0
 19190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19191
 19192
 19193     MOVE SPACES                 TO WS-REC-FOUND-SW.
 19194
 19195     IF PI-DISPLAY-ORIGINAL-BATCH
 19196        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19197     ELSE
 19198        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19199
 19200
 19201* EXEC CICS READ
 19202*         DATASET   (FILE-ID)
 19203*         SET       (ADDRESS OF PENDING-BUSINESS)
 19204*         RIDFLD    (ERPNDB-KEY)
 19205*         GTEQ
 19206*    END-EXEC.
 19207*    MOVE '&"S        G          (   #00016424' TO DFHEIV0
 19208     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19209     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19210     MOVE X'2020233030303136343234' TO DFHEIV0(25:11)
 19211     CALL 'kxdfhei1' USING DFHEIV0,
 19212           FILE-ID,
 19213           DFHEIV20,
 19214           DFHEIV99,
 19215           ERPNDB-KEY,
 19216           DFHEIV99,
 19217           DFHEIV99,
 19218           DFHEIV99
 19219     SET ADDRESS OF PENDING-BUSINESS TO
 19220         DFHEIV20
 19221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19222
 19223
 19224     IF PI-DISPLAY-ORIGINAL-BATCH
 19225        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19226           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19227           GO TO 4150-END-BATCH
 19228        ELSE
 19229           IF PB-BATCH-TRAILER
 19230              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 19231              GO TO 4105-READ-NEXT
 19232           ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 353
* EL6311.cbl
 19233              NEXT SENTENCE
 19234     ELSE
 19235        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19236           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19237           GO TO 4150-END-BATCH.
 19238
 19239     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19240
 19241     IF WS-BATCH-PREFIX = '#CL'
 19242         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19243         GO TO 4105-READ-NEXT.
 19244
 19245     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19246     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19247     MOVE PB-STATE               TO PI-PB-STATE.
 19248     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19249
 19250     IF PB-BATCH-TRAILER
 19251        IF SHOW-RECORD
 19252           GO TO 4150-END-BATCH
 19253        ELSE
 19254           MOVE ER-2251         TO EMI-ERROR
 19255           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19256           MOVE 1               TO PI-BROWSE-TYPE
 19257           GO TO 7200-DISPLAY-BATCHES.
 19258
 19259     IF SHOW-RECORD
 19260           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19261              GO TO 4110-BUMP-SEQ
 19262           ELSE
 19263              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19264                 GO TO 4110-BUMP-SEQ
 19265              ELSE
 19266                 GO TO 4107-CHECK-REC-TYPE.
 19267
 19268     IF NOT  PI-PRIMARY-WITH-SELECT
 19269        GO TO 4107-CHECK-REC-TYPE.
 19270
 19271     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19272        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19273           GO TO 4110-BUMP-SEQ
 19274        ELSE
 19275           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19276              GO TO 4107-CHECK-REC-TYPE
 19277           ELSE
 19278              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19279                 GO TO 4107-CHECK-REC-TYPE
 19280              ELSE
 19281                 GO TO 4110-BUMP-SEQ.
 19282
 19283     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19284        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19285           GO TO 4110-BUMP-SEQ.
 19286
 19287 4107-CHECK-REC-TYPE.
 19288     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19289         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19290             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 354
* EL6311.cbl
 19291           ELSE
 19292             GO TO 4110-BUMP-SEQ.
 19293
 19294     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19295         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19296             NEXT SENTENCE
 19297           ELSE
 19298             GO TO 4110-BUMP-SEQ.
 19299
 19300     IF NOT DISPLAY-CHANGE-RECORDS AND
 19301        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19302           GO TO 4110-BUMP-SEQ.
 19303
 19304     IF DISPLAY-HOLD-RECORDS AND
 19305        NOT PB-RECORD-ON-HOLD
 19306          GO TO 4110-BUMP-SEQ.
 19307
 19308     IF PB-ISSUE
 19309        IF DISPLAY-CHK-REQ-RECORDS
 19310            GO TO 4110-BUMP-SEQ.
 19311
 19312     IF PB-ISSUE
 19313        IF ISSUE-WITH-WARNING
 19314           IF PB-WARNING-ERRORS
 19315              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19316                  GO TO 4110-BUMP-SEQ
 19317              ELSE
 19318                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19319                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19320                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19321                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19322                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19323                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19324                 GO TO 7000-DISPLAY-ISSUES
 19325        ELSE
 19326            GO TO 4110-BUMP-SEQ.
 19327
 19328     IF PB-ISSUE
 19329        IF (ISSUES-IN-ERROR AND
 19330            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19331            ALL-ISSUES
 19332            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19333            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19334            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19335            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19336            MOVE PB-SV-STATE            TO PI-SV-STATE
 19337            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19338            GO TO 7000-DISPLAY-ISSUES
 19339        ELSE
 19340            GO TO 4110-BUMP-SEQ.
 19341
 19342     IF PB-CANCELLATION
 19343        IF DISPLAY-CHK-REQ-RECORDS
 19344           IF PB-C-REFUND-REQUESTED
 19345              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19346              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19347              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19348              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 355
* EL6311.cbl
 19349              MOVE PB-SV-STATE            TO PI-SV-STATE
 19350              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19351              GO TO 7100-DISPLAY-CANCELS
 19352           ELSE
 19353              GO TO 4110-BUMP-SEQ.
 19354
 19355     IF PB-CANCELLATION
 19356        IF CANCEL-WITH-WARNING
 19357           IF PB-WARNING-ERRORS
 19358              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19359                  GO TO 4110-BUMP-SEQ
 19360              ELSE
 19361                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19362                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19363                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19364                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19365                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19366                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19367                 GO TO 7100-DISPLAY-CANCELS
 19368           ELSE
 19369              GO TO 4110-BUMP-SEQ.
 19370
 19371     IF PB-CANCELLATION
 19372        IF (CANCEL-IN-ERROR  AND
 19373            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19374            ALL-CANCELS
 19375            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19376            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19377            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19378            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19379            MOVE PB-SV-STATE            TO PI-SV-STATE
 19380            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19381            GO TO 7100-DISPLAY-CANCELS.
 19382
 19383 4110-BUMP-SEQ.
 19384     IF NOT DISPLAY-CHANGE-RECORDS
 19385        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19386        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19387     ELSE
 19388        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19389           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19390           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19391        ELSE
 19392           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19393           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19394
 19395     GO TO 4105-READ-NEXT.
 19396
 19397 4150-END-BATCH.
 19398******************************************************************
 19399*                                                                *
 19400*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19401*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19402*         PROGRAM.                                               *
 19403*                                                                *
 19404******************************************************************
 19405
 19406     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 356
* EL6311.cbl
 19407         IF PENDING-BUS-RECS-FOUND
 19408             NEXT SENTENCE
 19409           ELSE
 19410             MOVE '9'            TO PI-BROWSE-SW
 19411             GO TO 9400-CLEAR.
 19412
 19413     IF SHOW-RECORD
 19414        MOVE ER-2253             TO EMI-ERROR
 19415     ELSE
 19416        MOVE ER-2251             TO EMI-ERROR.
 19417
 19418     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19419
 19420     IF PI-MAP-NAME = SPACES
 19421        MOVE -1                  TO BMAINTL
 19422        MOVE EL631B              TO PI-MAP-NAME
 19423        GO TO 8100-SEND-INITIAL-MAP.
 19424
 19425     IF PI-MAP-NAME = EL631B
 19426        MOVE -1                  TO BMAINTL
 19427     ELSE
 19428        IF PI-MAP-NAME = EL631C
 19429           MOVE -1               TO CMAINTL
 19430        ELSE
 19431           MOVE -1               TO DPFENTRL.
 19432
 19433     GO TO 8200-SEND-DATAONLY.
 19434
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 357
* EL6311.cbl
 19436
 19437***************************************************************
 19438*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19439*                                                             *
 19440*      1. START BROWSE WITH                                   *
 19441*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19442*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19443*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19444*                                                             *
 19445*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19446*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19447*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19448*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19449*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19450*               AND IS IT TO BE DISPLAYED.                    *
 19451*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19452*               DISPLAYED.                                    *
 19453*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19454*               DISPLAYED.                                    *
 19455*                                                             *
 19456*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19457*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19458***************************************************************
 19459
 19460 4200-BROWSE-CSR-FORWARD.
 19461
 19462     IF FIRST-TIME
 19463        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19464     ELSE
 19465        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19466
 19467
 19468* EXEC CICS HANDLE CONDITION
 19469*         NOTFND   (4250-END-RECORDS)
 19470*         ENDFILE  (4250-END-RECORDS)
 19471*    END-EXEC.
 19472*    MOVE '"$I''                  ! L #00016674' TO DFHEIV0
 19473     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19474     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19475     MOVE X'4C20233030303136363734' TO DFHEIV0(25:11)
 19476     CALL 'kxdfhei1' USING DFHEIV0
 19477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19478
 19479
 19480
 19481* EXEC CICS STARTBR
 19482*         DATASET   (FILE-ID-ERPNDB4)
 19483*         RIDFLD    (ERPNDB-CSR-KEY)
 19484*    END-EXEC.
 19485     MOVE 0
 19486       TO DFHEIV11
 19487*    MOVE '&,         G          &   #00016679' TO DFHEIV0
 19488     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19489     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19490     MOVE X'2020233030303136363739' TO DFHEIV0(25:11)
 19491     CALL 'kxdfhei1' USING DFHEIV0,
 19492           FILE-ID-ERPNDB4,
 19493           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 358
* EL6311.cbl
 19494           DFHEIV99,
 19495           DFHEIV11,
 19496           DFHEIV99
 19497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19498
 19499
 19500     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19501
 19502     IF FIRST-TIME
 19503        MOVE SPACE               TO WS-FIRST-TIME-SW
 19504        GO TO 4205-READ-NEXT-RECORD.
 19505
 19506
 19507* EXEC CICS READNEXT
 19508*         DATASET    (FILE-ID-ERPNDB4)
 19509*         SET        (ADDRESS OF PENDING-BUSINESS)
 19510*         RIDFLD     (ERPNDB-CSR-KEY)
 19511*    END-EXEC.
 19512     MOVE 0
 19513       TO DFHEIV11
 19514*    MOVE '&.S                   )   #00016690' TO DFHEIV0
 19515     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19516     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19517     MOVE X'2020233030303136363930' TO DFHEIV0(25:11)
 19518     CALL 'kxdfhei1' USING DFHEIV0,
 19519           FILE-ID-ERPNDB4,
 19520           DFHEIV20,
 19521           DFHEIV99,
 19522           ERPNDB-CSR-KEY,
 19523           DFHEIV99,
 19524           DFHEIV11,
 19525           DFHEIV99,
 19526           DFHEIV99
 19527     SET ADDRESS OF PENDING-BUSINESS TO
 19528         DFHEIV20
 19529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19530
 19531
 19532 4205-READ-NEXT-RECORD.
 19533
 19534
 19535* EXEC CICS READNEXT
 19536*         DATASET    (FILE-ID-ERPNDB4)
 19537*         SET        (ADDRESS OF PENDING-BUSINESS)
 19538*         RIDFLD     (ERPNDB-CSR-KEY)
 19539*    END-EXEC.
 19540     MOVE 0
 19541       TO DFHEIV11
 19542*    MOVE '&.S                   )   #00016698' TO DFHEIV0
 19543     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19544     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19545     MOVE X'2020233030303136363938' TO DFHEIV0(25:11)
 19546     CALL 'kxdfhei1' USING DFHEIV0,
 19547           FILE-ID-ERPNDB4,
 19548           DFHEIV20,
 19549           DFHEIV99,
 19550           ERPNDB-CSR-KEY,
 19551           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 359
* EL6311.cbl
 19552           DFHEIV11,
 19553           DFHEIV99,
 19554           DFHEIV99
 19555     SET ADDRESS OF PENDING-BUSINESS TO
 19556         DFHEIV20
 19557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19558
 19559
 19560     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19561
 19562     IF WS-BATCH-PREFIX = '#CL'
 19563        GO TO 4205-READ-NEXT-RECORD.
 19564
 19565     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19566        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19567        GO TO 4250-END-RECORDS.
 19568
 19569     IF PB-BATCH-TRAILER
 19570        GO TO 4205-READ-NEXT-RECORD.
 19571
 19572     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19573        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19574           GO TO 4205-READ-NEXT-RECORD
 19575        ELSE
 19576           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19577              GO TO 4210-CHECK-REC-TYPE
 19578           ELSE
 19579              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19580                 GO TO 4210-CHECK-REC-TYPE
 19581              ELSE
 19582                 GO TO 4205-READ-NEXT-RECORD.
 19583
 19584     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19585        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19586           GO TO 4205-READ-NEXT-RECORD.
 19587
 19588 4210-CHECK-REC-TYPE.
 19589     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19590         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19591             NEXT SENTENCE
 19592         ELSE
 19593             GO TO 4205-READ-NEXT-RECORD.
 19594
 19595     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19596         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19597             NEXT SENTENCE
 19598        ELSE
 19599             GO TO 4205-READ-NEXT-RECORD.
 19600
 19601     IF NOT DISPLAY-CHANGE-RECORDS AND
 19602            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19603        GO TO 4205-READ-NEXT-RECORD.
 19604
 19605     IF DISPLAY-HOLD-RECORDS AND
 19606        NOT PB-RECORD-ON-HOLD
 19607          GO TO 4205-READ-NEXT-RECORD.
 19608
 19609     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 360
* EL6311.cbl
 19610        IF DISPLAY-CHK-REQ-RECORDS
 19611            GO TO 4205-READ-NEXT-RECORD.
 19612
 19613     IF PB-ISSUE
 19614        IF ISSUE-WITH-WARNING
 19615           IF PB-WARNING-ERRORS
 19616              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19617                  GO TO 4205-READ-NEXT-RECORD
 19618              ELSE
 19619                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19620                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19621                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19622                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19623                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19624                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19625                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19626                 GO TO 7000-DISPLAY-ISSUES
 19627           ELSE
 19628              GO TO 4205-READ-NEXT-RECORD.
 19629
 19630     IF PB-ISSUE
 19631        IF (ISSUES-IN-ERROR AND
 19632            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19633            ALL-ISSUES
 19634            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19635            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19636            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19637            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19638            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19639            MOVE PB-SV-STATE            TO PI-SV-STATE
 19640            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19641            GO TO 7000-DISPLAY-ISSUES
 19642        ELSE
 19643            GO TO 4205-READ-NEXT-RECORD.
 19644
 19645     IF PB-CANCELLATION
 19646        IF DISPLAY-CHK-REQ-RECORDS
 19647           IF PB-C-REFUND-REQUESTED
 19648              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19649              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19650              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19651              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19652              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19653              MOVE PB-SV-STATE            TO PI-SV-STATE
 19654              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19655              GO TO 7100-DISPLAY-CANCELS
 19656           ELSE
 19657               GO TO 4205-READ-NEXT-RECORD.
 19658
 19659     IF PB-CANCELLATION
 19660        IF CANCEL-WITH-WARNING
 19661           IF PB-WARNING-ERRORS
 19662              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19663                  GO TO 4205-READ-NEXT-RECORD
 19664              ELSE
 19665                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19666                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19667                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 361
* EL6311.cbl
 19668                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19669                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19670                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19671                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19672                 GO TO 7100-DISPLAY-CANCELS
 19673           ELSE
 19674              GO TO 4205-READ-NEXT-RECORD.
 19675
 19676     IF PB-CANCELLATION
 19677        IF (CANCEL-IN-ERROR  AND
 19678            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19679            ALL-CANCELS
 19680            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19681            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19682            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19683            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19684            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19685            MOVE PB-SV-STATE            TO PI-SV-STATE
 19686            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19687            GO TO 7100-DISPLAY-CANCELS.
 19688
 19689     GO TO 4205-READ-NEXT-RECORD.
 19690
 19691 4250-END-RECORDS.
 19692******************************************************************
 19693*                                                                *
 19694*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19695*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19696*         PROGRAM.                                               *
 19697*                                                                *
 19698******************************************************************
 19699
 19700     IF BROWSE-STARTED
 19701        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19702
 19703* EXEC CICS ENDBR
 19704*            DATASET  (FILE-ID-ERPNDB4)
 19705*       END-EXEC.
 19706     MOVE 0
 19707       TO DFHEIV11
 19708*    MOVE '&2                    $   #00016846' TO DFHEIV0
 19709     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19710     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19711     MOVE X'2020233030303136383436' TO DFHEIV0(25:11)
 19712     CALL 'kxdfhei1' USING DFHEIV0,
 19713           FILE-ID-ERPNDB4,
 19714           DFHEIV11,
 19715           DFHEIV99
 19716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19717
 19718
 19719     IF  EIBTRNID NOT = TRANS-EXB1
 19720         IF PENDING-BUS-RECS-FOUND
 19721             NEXT SENTENCE
 19722           ELSE
 19723             MOVE '9'            TO PI-BROWSE-SW
 19724             GO TO 9400-CLEAR.
 19725
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 362
* EL6311.cbl
 19726     IF SHOW-RECORD
 19727        MOVE ER-2253            TO EMI-ERROR
 19728       ELSE
 19729        MOVE ER-2254            TO EMI-ERROR.
 19730
 19731     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19732
 19733     IF PI-MAP-NAME = SPACES
 19734        MOVE -1                  TO DPFENTRL
 19735        MOVE EL631D               TO PI-MAP-NAME
 19736        GO TO 8100-SEND-INITIAL-MAP.
 19737
 19738     IF PI-MAP-NAME = EL631B
 19739        MOVE -1                  TO BMAINTL
 19740     ELSE
 19741        IF PI-MAP-NAME = EL631C
 19742           MOVE -1               TO CMAINTL
 19743        ELSE
 19744           MOVE -1               TO DPFENTRL.
 19745
 19746     GO TO 8200-SEND-DATAONLY.
 19747
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 363
* EL6311.cbl
 19749
 19750***************************************************************
 19751*                                                             *
 19752*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19753*                                                             *
 19754*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19755*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19756*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19757*                                                             *
 19758*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19759*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19760*          A. IS IT WITHIN THE SAME COMPANY                   *
 19761*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19762*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19763*                AND IS IT TO BE DISPLAYED.                   *
 19764*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19765*                DISPLAYED.                                   *
 19766*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19767*                DISPLAYED.                                   *
 19768*                                                             *
 19769*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19770*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19771*                                                             *
 19772*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19773*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19774*                THEY ARE NOT TO BE DISPLAYED.                *
 19775*                                                             *
 19776***************************************************************
 19777
 19778 4300-BROWSE-FILE-FORWARD.
 19779     IF FIRST-TIME OR SHOW-RECORD
 19780        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19781        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19782        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19783     ELSE
 19784        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19785        IF ERPNDB-BATCH-SEQ-NO = +9999
 19786           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19787        ELSE
 19788           IF DISPLAY-CHANGE-RECORDS
 19789              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19790           ELSE
 19791              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19792              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19793
 19794
 19795* EXEC CICS HANDLE CONDITION
 19796*         ENDFILE  (4350-END-BATCH)
 19797*         NOTFND   (4350-END-BATCH)
 19798*    END-EXEC.
 19799*    MOVE '"$''I                  ! M #00016925' TO DFHEIV0
 19800     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19801     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19802     MOVE X'4D20233030303136393235' TO DFHEIV0(25:11)
 19803     CALL 'kxdfhei1' USING DFHEIV0
 19804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19805
 19806
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 364
* EL6311.cbl
 19807 4305-READ-NEXT.
 19808     IF PI-DISPLAY-ORIGINAL-BATCH
 19809        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19810     ELSE
 19811        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19812
 19813
 19814* EXEC CICS READ
 19815*         DATASET   (FILE-ID)
 19816*         SET       (ADDRESS OF PENDING-BUSINESS)
 19817*         RIDFLD    (ERPNDB-KEY)
 19818*         GTEQ
 19819*    END-EXEC.
 19820*    MOVE '&"S        G          (   #00016936' TO DFHEIV0
 19821     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19822     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19823     MOVE X'2020233030303136393336' TO DFHEIV0(25:11)
 19824     CALL 'kxdfhei1' USING DFHEIV0,
 19825           FILE-ID,
 19826           DFHEIV20,
 19827           DFHEIV99,
 19828           ERPNDB-KEY,
 19829           DFHEIV99,
 19830           DFHEIV99,
 19831           DFHEIV99
 19832     SET ADDRESS OF PENDING-BUSINESS TO
 19833         DFHEIV20
 19834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19835
 19836
 19837     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19838        GO TO 4350-END-BATCH.
 19839
 19840     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19841                                    WS-BATCH-NO.
 19842
 19843     IF  WS-BATCH-PREFIX = '#CL'
 19844         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19845         GO TO 4305-READ-NEXT.
 19846
 19847     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19848     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19849     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19850     MOVE PB-STATE               TO PI-PB-STATE.
 19851     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19852
 19853     IF PB-BATCH-TRAILER
 19854        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19855        GO TO 4305-READ-NEXT.
 19856
 19857     IF SHOW-RECORD
 19858           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19859              GO TO 4310-BUMP-SEQ
 19860           ELSE
 19861              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19862                 GO TO 4310-BUMP-SEQ
 19863              ELSE
 19864                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 365
* EL6311.cbl
 19865
 19866     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19867        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19868           GO TO 4310-BUMP-SEQ
 19869        ELSE
 19870           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19871              GO TO 4307-CHECK-REC-TYPE
 19872           ELSE
 19873              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19874                 GO TO 4307-CHECK-REC-TYPE
 19875              ELSE
 19876                 GO TO 4310-BUMP-SEQ.
 19877
 19878     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19879        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19880           GO TO 4310-BUMP-SEQ.
 19881
 19882 4307-CHECK-REC-TYPE.
 19883     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19884         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19885             NEXT SENTENCE
 19886         ELSE
 19887             GO TO 4310-BUMP-SEQ.
 19888
 19889     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19890         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19891             NEXT SENTENCE
 19892        ELSE
 19893             GO TO 4310-BUMP-SEQ.
 19894
 19895     IF NOT DISPLAY-CHANGE-RECORDS AND
 19896            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19897        GO TO 4310-BUMP-SEQ.
 19898
 19899     IF DISPLAY-HOLD-RECORDS AND
 19900        NOT PB-RECORD-ON-HOLD
 19901          GO TO 4310-BUMP-SEQ.
 19902
 19903     IF PB-ISSUE
 19904        IF DISPLAY-CHK-REQ-RECORDS
 19905           GO TO 4310-BUMP-SEQ.
 19906
 19907     IF PB-ISSUE
 19908        IF ISSUE-WITH-WARNING
 19909           IF PB-WARNING-ERRORS
 19910              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19911                  GO TO 4310-BUMP-SEQ
 19912              ELSE
 19913                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19914                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19915                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19916                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19917                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19918                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19919                 GO TO 7000-DISPLAY-ISSUES
 19920           ELSE
 19921              GO TO 4310-BUMP-SEQ.
 19922
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 366
* EL6311.cbl
 19923     IF PB-ISSUE
 19924        IF (ISSUES-IN-ERROR AND
 19925            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19926            ALL-ISSUES
 19927            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19928            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19929            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19930            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19931            MOVE PB-SV-STATE            TO PI-SV-STATE
 19932            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19933            GO TO 7000-DISPLAY-ISSUES
 19934        ELSE
 19935            GO TO 4310-BUMP-SEQ.
 19936
 19937     IF PB-CANCELLATION
 19938        IF DISPLAY-CHK-REQ-RECORDS
 19939           IF PB-C-REFUND-REQUESTED
 19940              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19941              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19942              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19943              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19944              MOVE PB-SV-STATE            TO PI-SV-STATE
 19945              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19946              GO TO 7100-DISPLAY-CANCELS
 19947           ELSE
 19948              GO TO 4310-BUMP-SEQ.
 19949
 19950     IF PB-CANCELLATION
 19951        IF CANCEL-WITH-WARNING
 19952           IF PB-WARNING-ERRORS
 19953              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19954                  GO TO 4310-BUMP-SEQ
 19955              ELSE
 19956                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19957                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19958                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19959                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19960                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19961                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19962                 GO TO 7100-DISPLAY-CANCELS
 19963           ELSE
 19964              GO TO 4310-BUMP-SEQ.
 19965
 19966     IF PB-CANCELLATION
 19967        IF (CANCEL-IN-ERROR  AND
 19968            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19969            ALL-CANCELS
 19970            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19971            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19972            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19973            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19974            MOVE PB-SV-STATE            TO PI-SV-STATE
 19975            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19976            GO TO 7100-DISPLAY-CANCELS.
 19977
 19978 4310-BUMP-SEQ.
 19979     IF NOT DISPLAY-CHANGE-RECORDS
 19980        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 367
* EL6311.cbl
 19981        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19982     ELSE
 19983        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19984           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19985           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19986        ELSE
 19987           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19988           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19989
 19990     GO TO 4305-READ-NEXT.
 19991
 19992 4350-END-BATCH.
 19993
 19994******************************************************************
 19995*                                                                *
 19996*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19997*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19998*         PROGRAM.                                               *
 19999*                                                                *
 20000******************************************************************
 20001
 20002     IF  EIBTRNID NOT = TRANS-EXB1
 20003         IF PENDING-BUS-RECS-FOUND
 20004             NEXT SENTENCE
 20005           ELSE
 20006             MOVE '9'            TO PI-BROWSE-SW
 20007             GO TO 9400-CLEAR.
 20008
 20009     IF SHOW-RECORD
 20010        MOVE ER-2253            TO EMI-ERROR
 20011     ELSE
 20012        MOVE ER-2251            TO EMI-ERROR.
 20013
 20014     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20015
 20016     IF PI-MAP-NAME = SPACES
 20017        MOVE -1                  TO BMAINTL
 20018        MOVE EL631B               TO PI-MAP-NAME
 20019        GO TO 8100-SEND-INITIAL-MAP.
 20020
 20021     IF PI-MAP-NAME = EL631B
 20022        MOVE -1                  TO BMAINTL
 20023     ELSE
 20024        IF PI-MAP-NAME = EL631C
 20025           MOVE -1               TO CMAINTL
 20026        ELSE
 20027           MOVE -1               TO DPFENTRL.
 20028
 20029     GO TO 8200-SEND-DATAONLY.
 20030
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 368
* EL6311.cbl
 20032
 20033******************************************************************
 20034*                                                                *
 20035*        B R O W S E   D E T A I L   B A C K W A R D             *
 20036*                                                                *
 20037******************************************************************
 20038
 20039 4500-BROWSE-DETAIL-BACKWARD.
 20040
 20041     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 20042
 20043
 20044* EXEC CICS HANDLE CONDITION
 20045*         NOTFND   (4570-NOT-FOUND)
 20046*         ENDFILE  (4550-END-RECORDS)
 20047*    END-EXEC
 20048*    MOVE '"$I''                  ! N #00017149' TO DFHEIV0
 20049     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20050     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20051     MOVE X'4E20233030303137313439' TO DFHEIV0(25:11)
 20052     CALL 'kxdfhei1' USING DFHEIV0
 20053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20054
 20055
 20056* EXEC CICS STARTBR
 20057*         DATASET   (FILE-ID-ERPNDB2)
 20058*         RIDFLD    (ERPNDB-ALT-KEY)
 20059*    END-EXEC.
 20060     MOVE 0
 20061       TO DFHEIV11
 20062*    MOVE '&,         G          &   #00017154' TO DFHEIV0
 20063     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20064     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20065     MOVE X'2020233030303137313534' TO DFHEIV0(25:11)
 20066     CALL 'kxdfhei1' USING DFHEIV0,
 20067           FILE-ID-ERPNDB2,
 20068           ERPNDB-ALT-KEY,
 20069           DFHEIV99,
 20070           DFHEIV11,
 20071           DFHEIV99
 20072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20073
 20074
 20075     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20076                                    WS-FIRST-TIME-SW.
 20077
 20078 4505-READ-PREV-RECORD.
 20079
 20080* EXEC CICS READPREV
 20081*         DATASET    (FILE-ID-ERPNDB2)
 20082*         SET        (ADDRESS OF PENDING-BUSINESS)
 20083*         RIDFLD     (ERPNDB-ALT-KEY)
 20084*    END-EXEC.
 20085     MOVE 0
 20086       TO DFHEIV11
 20087*    MOVE '&0S                   )   #00017163' TO DFHEIV0
 20088     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20089     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 369
* EL6311.cbl
 20090     MOVE X'2020233030303137313633' TO DFHEIV0(25:11)
 20091     CALL 'kxdfhei1' USING DFHEIV0,
 20092           FILE-ID-ERPNDB2,
 20093           DFHEIV20,
 20094           DFHEIV99,
 20095           ERPNDB-ALT-KEY,
 20096           DFHEIV99,
 20097           DFHEIV11,
 20098           DFHEIV99,
 20099           DFHEIV99
 20100     SET ADDRESS OF PENDING-BUSINESS TO
 20101         DFHEIV20
 20102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20103
 20104
 20105     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20106
 20107     IF WS-BATCH-PREFIX = '#CL'
 20108         GO TO 4505-READ-PREV-RECORD.
 20109
 20110     IF FIRST-TIME
 20111         MOVE SPACE               TO WS-FIRST-TIME-SW
 20112         GO TO 4505-READ-PREV-RECORD.
 20113
 20114     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 20115        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 20116        PB-GROUPING      NOT = PI-PB-GROUPING OR
 20117        PB-STATE         NOT = PI-PB-STATE    OR
 20118        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 20119          GO TO 4550-END-RECORDS.
 20120
 20121
 20122     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 20123
 20124     IF PB-BATCH-TRAILER
 20125        GO TO 4505-READ-PREV-RECORD.
 20126
 20127     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20128
 20129     IF  WS-BATCH-PREFIX = '#CL'
 20130         GO TO 4505-READ-PREV-RECORD.
 20131
 20132     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20133        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20134           GO TO 4505-READ-PREV-RECORD
 20135        ELSE
 20136           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20137              GO TO 4510-CHECK-REC-TYPE
 20138           ELSE
 20139              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20140                 GO TO 4510-CHECK-REC-TYPE
 20141              ELSE
 20142                 GO TO 4505-READ-PREV-RECORD.
 20143
 20144     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20145        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20146           GO TO 4505-READ-PREV-RECORD.
 20147
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 370
* EL6311.cbl
 20148 4510-CHECK-REC-TYPE.
 20149     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20150         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20151             NEXT SENTENCE
 20152         ELSE
 20153             GO TO 4505-READ-PREV-RECORD.
 20154
 20155     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20156         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20157             NEXT SENTENCE
 20158        ELSE
 20159             GO TO 4505-READ-PREV-RECORD.
 20160
 20161     IF NOT DISPLAY-CHANGE-RECORDS AND
 20162            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20163        GO TO 4505-READ-PREV-RECORD.
 20164
 20165     IF DISPLAY-HOLD-RECORDS AND
 20166        NOT PB-RECORD-ON-HOLD
 20167          GO TO 4505-READ-PREV-RECORD.
 20168
 20169     IF PB-ISSUE
 20170        IF DISPLAY-CHK-REQ-RECORDS
 20171           GO TO 4505-READ-PREV-RECORD.
 20172
 20173     IF PB-ISSUE
 20174        IF ISSUE-WITH-WARNING
 20175           IF PB-WARNING-ERRORS
 20176              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20177                  GO TO 4505-READ-PREV-RECORD
 20178              ELSE
 20179                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20180                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20181                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20182                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20183                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20184                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20185                 GO TO 7000-DISPLAY-ISSUES
 20186           ELSE
 20187              GO TO 4505-READ-PREV-RECORD.
 20188
 20189     IF PB-ISSUE
 20190        IF (ISSUES-IN-ERROR AND
 20191            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20192            ALL-ISSUES
 20193            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20194            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20195            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20196            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20197            MOVE PB-SV-STATE            TO PI-SV-STATE
 20198            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20199            GO TO 7000-DISPLAY-ISSUES
 20200        ELSE
 20201            GO TO 4505-READ-PREV-RECORD.
 20202
 20203     IF PB-CANCELLATION
 20204        IF DISPLAY-CHK-REQ-RECORDS
 20205           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 371
* EL6311.cbl
 20206              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20207              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20208              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20209              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20210              MOVE PB-SV-STATE            TO PI-SV-STATE
 20211              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20212              GO TO 7100-DISPLAY-CANCELS
 20213           ELSE
 20214              GO TO 4505-READ-PREV-RECORD.
 20215
 20216     IF PB-CANCELLATION
 20217        IF CANCEL-WITH-WARNING
 20218           IF PB-WARNING-ERRORS
 20219              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20220                  GO TO 4505-READ-PREV-RECORD
 20221              ELSE
 20222                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20223                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20224                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20225                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20226                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20227                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20228                 GO TO 7100-DISPLAY-CANCELS
 20229           ELSE
 20230              GO TO 4505-READ-PREV-RECORD.
 20231
 20232     IF PB-CANCELLATION
 20233        IF (CANCEL-IN-ERROR  AND
 20234            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20235            ALL-CANCELS
 20236            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20237            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20238            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20239            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20240            MOVE PB-SV-STATE            TO PI-SV-STATE
 20241            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20242            GO TO 7100-DISPLAY-CANCELS.
 20243
 20244     GO TO 4505-READ-PREV-RECORD.
 20245
 20246 4550-END-RECORDS.
 20247     IF PI-MAP-NAME = EL631B
 20248        MOVE -1                  TO BMAINTL
 20249     ELSE
 20250        IF PI-MAP-NAME = EL631C
 20251           MOVE -1               TO CMAINTL
 20252        ELSE
 20253           MOVE -1               TO DPFENTRL.
 20254
 20255     MOVE ER-2255               TO EMI-ERROR.
 20256     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20257     GO TO 8200-SEND-DATAONLY.
 20258
 20259 4570-NOT-FOUND.
 20260
 20261******************************************************************
 20262*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20263******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 372
* EL6311.cbl
 20264
 20265
 20266* EXEC CICS RESETBR
 20267*         DATASET    (FILE-ID-ERPNDB2)
 20268*         RIDFLD     (ERPNDB-ALT-KEY)
 20269*    END-EXEC.
 20270     MOVE 0
 20271       TO DFHEIV11
 20272*    MOVE '&4         G          &   #00017329' TO DFHEIV0
 20273     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20274     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20275     MOVE X'2020233030303137333239' TO DFHEIV0(25:11)
 20276     CALL 'kxdfhei1' USING DFHEIV0,
 20277           FILE-ID-ERPNDB2,
 20278           ERPNDB-ALT-KEY,
 20279           DFHEIV99,
 20280           DFHEIV11,
 20281           DFHEIV99
 20282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20283
 20284
 20285
 20286* EXEC CICS READNEXT
 20287*         DATASET    (FILE-ID-ERPNDB2)
 20288*         SET        (ADDRESS OF PENDING-BUSINESS)
 20289*         RIDFLD     (ERPNDB-ALT-KEY)
 20290*    END-EXEC.
 20291     MOVE 0
 20292       TO DFHEIV11
 20293*    MOVE '&.S                   )   #00017334' TO DFHEIV0
 20294     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20295     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20296     MOVE X'2020233030303137333334' TO DFHEIV0(25:11)
 20297     CALL 'kxdfhei1' USING DFHEIV0,
 20298           FILE-ID-ERPNDB2,
 20299           DFHEIV20,
 20300           DFHEIV99,
 20301           ERPNDB-ALT-KEY,
 20302           DFHEIV99,
 20303           DFHEIV11,
 20304           DFHEIV99,
 20305           DFHEIV99
 20306     SET ADDRESS OF PENDING-BUSINESS TO
 20307         DFHEIV20
 20308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20309
 20310
 20311
 20312* EXEC CICS READPREV
 20313*         DATASET    (FILE-ID-ERPNDB2)
 20314*         SET        (ADDRESS OF PENDING-BUSINESS)
 20315*         RIDFLD     (ERPNDB-ALT-KEY)
 20316*    END-EXEC.
 20317     MOVE 0
 20318       TO DFHEIV11
 20319*    MOVE '&0S                   )   #00017340' TO DFHEIV0
 20320     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20321     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 373
* EL6311.cbl
 20322     MOVE X'2020233030303137333430' TO DFHEIV0(25:11)
 20323     CALL 'kxdfhei1' USING DFHEIV0,
 20324           FILE-ID-ERPNDB2,
 20325           DFHEIV20,
 20326           DFHEIV99,
 20327           ERPNDB-ALT-KEY,
 20328           DFHEIV99,
 20329           DFHEIV11,
 20330           DFHEIV99,
 20331           DFHEIV99
 20332     SET ADDRESS OF PENDING-BUSINESS TO
 20333         DFHEIV20
 20334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20335
 20336
 20337 4580-READ-PREV-RECORD.
 20338
 20339* EXEC CICS READPREV
 20340*         DATASET    (FILE-ID-ERPNDB2)
 20341*         SET        (ADDRESS OF PENDING-BUSINESS)
 20342*         RIDFLD     (ERPNDB-ALT-KEY)
 20343*    END-EXEC.
 20344     MOVE 0
 20345       TO DFHEIV11
 20346*    MOVE '&0S                   )   #00017347' TO DFHEIV0
 20347     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20348     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20349     MOVE X'2020233030303137333437' TO DFHEIV0(25:11)
 20350     CALL 'kxdfhei1' USING DFHEIV0,
 20351           FILE-ID-ERPNDB2,
 20352           DFHEIV20,
 20353           DFHEIV99,
 20354           ERPNDB-ALT-KEY,
 20355           DFHEIV99,
 20356           DFHEIV11,
 20357           DFHEIV99,
 20358           DFHEIV99
 20359     SET ADDRESS OF PENDING-BUSINESS TO
 20360         DFHEIV20
 20361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20362
 20363
 20364     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20365
 20366     IF WS-BATCH-PREFIX = '#CL'
 20367        GO TO 4580-READ-PREV-RECORD.
 20368
 20369     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20370     GO TO 4505-READ-PREV-RECORD.
 20371
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 374
* EL6311.cbl
 20373
 20374******************************************************************
 20375*                                                                *
 20376*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20377*                                                                *
 20378******************************************************************
 20379
 20380 4600-BROWSE-PRIMARY-BACKWARD.
 20381        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20382
 20383     IF ERPNDB-BATCH-SEQ-NO = +9999
 20384        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20385
 20386        IF ERPNDB-BATCH-SEQ-NO = +0000
 20387           GO TO 4650-END-BATCH
 20388        ELSE
 20389           IF PI-MAP-NAME NOT = EL631D
 20390              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20391                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20392              ELSE
 20393                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20394                 IF DISPLAY-CHANGE-RECORDS
 20395                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20396                 ELSE
 20397                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20398
 20399
 20400* EXEC CICS HANDLE CONDITION
 20401*         NOTFND    (4680-NOT-FOUND)
 20402*         ENDFILE   (4680-NOT-FOUND)
 20403*    END-EXEC.
 20404*    MOVE '"$I''                  ! O #00017388' TO DFHEIV0
 20405     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20406     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20407     MOVE X'4F20233030303137333838' TO DFHEIV0(25:11)
 20408     CALL 'kxdfhei1' USING DFHEIV0
 20409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20410
 20411
 20412 4605-READ-NEXT.
 20413     IF ERPNDB-BATCH-SEQ-NO = +0000
 20414        GO TO 4650-END-BATCH.
 20415
 20416     IF PI-DISPLAY-ORIGINAL-BATCH
 20417        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20418     ELSE
 20419        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20420
 20421
 20422* EXEC CICS READ
 20423*         DATASET   (FILE-ID)
 20424*         SET       (ADDRESS OF PENDING-BUSINESS)
 20425*         RIDFLD    (ERPNDB-KEY)
 20426*    END-EXEC.
 20427*    MOVE '&"S        E          (   #00017402' TO DFHEIV0
 20428     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20429     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20430     MOVE X'2020233030303137343032' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 375
* EL6311.cbl
 20431     CALL 'kxdfhei1' USING DFHEIV0,
 20432           FILE-ID,
 20433           DFHEIV20,
 20434           DFHEIV99,
 20435           ERPNDB-KEY,
 20436           DFHEIV99,
 20437           DFHEIV99,
 20438           DFHEIV99
 20439     SET ADDRESS OF PENDING-BUSINESS TO
 20440         DFHEIV20
 20441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20442
 20443
 20444     IF NOT  PI-PRIMARY-WITH-SELECT
 20445        GO TO 4607-CHECK-REC-TYPE.
 20446
 20447     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20448
 20449     IF  WS-BATCH-PREFIX = '#CL'
 20450         GO TO 4610-BUMP-SEQ.
 20451
 20452     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20453        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20454           GO TO 4610-BUMP-SEQ
 20455        ELSE
 20456           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20457              GO TO 4607-CHECK-REC-TYPE
 20458           ELSE
 20459              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20460                 GO TO 4607-CHECK-REC-TYPE
 20461              ELSE
 20462                 GO TO 4610-BUMP-SEQ.
 20463
 20464     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20465        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20466           GO TO 4610-BUMP-SEQ.
 20467
 20468 4607-CHECK-REC-TYPE.
 20469     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20470         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20471             NEXT SENTENCE
 20472         ELSE
 20473             GO TO 4610-BUMP-SEQ.
 20474
 20475     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20476         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20477             NEXT SENTENCE
 20478        ELSE
 20479             GO TO 4610-BUMP-SEQ.
 20480
 20481     IF NOT DISPLAY-CHANGE-RECORDS AND
 20482            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20483        GO TO 4610-BUMP-SEQ.
 20484
 20485     IF DISPLAY-HOLD-RECORDS AND
 20486        NOT PB-RECORD-ON-HOLD
 20487          GO TO 4610-BUMP-SEQ.
 20488
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 376
* EL6311.cbl
 20489     IF PB-ISSUE
 20490        IF DISPLAY-CHK-REQ-RECORDS
 20491           GO TO 4610-BUMP-SEQ.
 20492
 20493     IF PB-ISSUE
 20494        IF ISSUE-WITH-WARNING
 20495           IF PB-WARNING-ERRORS
 20496              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20497                  GO TO 4610-BUMP-SEQ
 20498              ELSE
 20499                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20500                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20501                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20502                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20503                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20504                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20505                 GO TO 7000-DISPLAY-ISSUES
 20506           ELSE
 20507              GO TO 4610-BUMP-SEQ.
 20508
 20509     IF PB-ISSUE
 20510        IF (ISSUES-IN-ERROR AND
 20511            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20512            ALL-ISSUES
 20513            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20514            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20515            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20516            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20517            MOVE PB-SV-STATE            TO PI-SV-STATE
 20518            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20519            GO TO 7000-DISPLAY-ISSUES
 20520        ELSE
 20521            GO TO 4610-BUMP-SEQ.
 20522
 20523     IF PB-CANCELLATION
 20524        IF DISPLAY-CHK-REQ-RECORDS
 20525           IF PB-C-REFUND-REQUESTED
 20526              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20527              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20528              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20529              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20530              MOVE PB-SV-STATE            TO PI-SV-STATE
 20531              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20532              GO TO 7100-DISPLAY-CANCELS
 20533           ELSE
 20534              GO TO 4610-BUMP-SEQ.
 20535
 20536     IF PB-CANCELLATION
 20537        IF CANCEL-WITH-WARNING
 20538           IF PB-WARNING-ERRORS
 20539              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20540                  GO TO 4610-BUMP-SEQ
 20541              ELSE
 20542                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20543                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20544                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20545                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20546                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 377
* EL6311.cbl
 20547                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20548                 GO TO 7100-DISPLAY-CANCELS
 20549           ELSE
 20550              GO TO 4610-BUMP-SEQ.
 20551
 20552     IF PB-CANCELLATION
 20553        IF (CANCEL-IN-ERROR  AND
 20554            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20555            ALL-CANCELS
 20556            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20557            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20558            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20559            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20560            MOVE PB-SV-STATE            TO PI-SV-STATE
 20561            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20562            GO TO 7100-DISPLAY-CANCELS.
 20563
 20564 4610-BUMP-SEQ.
 20565     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20566        GO TO 4650-END-BATCH.
 20567
 20568     IF DISPLAY-CHANGE-RECORDS
 20569        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20570           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20571        ELSE
 20572           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20573           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20574        ELSE
 20575           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20576           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20577
 20578        GO TO 4605-READ-NEXT.
 20579
 20580 4650-END-BATCH.
 20581     IF PI-MAP-NAME = EL631B
 20582        MOVE -1                  TO BMAINTL
 20583     ELSE
 20584        IF PI-MAP-NAME = EL631C
 20585           MOVE -1               TO CMAINTL
 20586        ELSE
 20587           MOVE -1               TO DPFENTRL.
 20588
 20589     MOVE ER-2252               TO EMI-ERROR.
 20590     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20591     GO TO 8200-SEND-DATAONLY.
 20592
 20593 4680-NOT-FOUND.
 20594     IF DISPLAY-CHANGE-RECORDS
 20595        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20596           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20597        ELSE
 20598           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20599           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20600     ELSE
 20601        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20602
 20603     GO TO 4605-READ-NEXT.
 20604
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 378
* EL6311.cbl
 20606
 20607******************************************************************
 20608*                                                                *
 20609*        B R O W S E   F I L E   B A C K W A R D S               *
 20610*                                                                *
 20611******************************************************************
 20612
 20613 4800-BROWSE-FILE-BACKWARD.
 20614
 20615* EXEC CICS HANDLE CONDITION
 20616*         NOTFND   (4860-NOT-FOUND)
 20617*         ENDFILE  (4850-END-RECORDS)
 20618*    END-EXEC.
 20619*    MOVE '"$I''                  ! P #00017578' TO DFHEIV0
 20620     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20622     MOVE X'5020233030303137353738' TO DFHEIV0(25:11)
 20623     CALL 'kxdfhei1' USING DFHEIV0
 20624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20625
 20626
 20627     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20628
 20629     IF PI-DISPLAY-ORIGINAL-BATCH
 20630        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20631     ELSE
 20632        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20633
 20634
 20635* EXEC CICS STARTBR
 20636*         DATASET   (FILE-ID)
 20637*         RIDFLD    (ERPNDB-KEY)
 20638*    END-EXEC.
 20639     MOVE 0
 20640       TO DFHEIV11
 20641*    MOVE '&,         G          &   #00017590' TO DFHEIV0
 20642     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20643     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20644     MOVE X'2020233030303137353930' TO DFHEIV0(25:11)
 20645     CALL 'kxdfhei1' USING DFHEIV0,
 20646           FILE-ID,
 20647           ERPNDB-KEY,
 20648           DFHEIV99,
 20649           DFHEIV11,
 20650           DFHEIV99
 20651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20652
 20653
 20654     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20655
 20656
 20657* EXEC CICS READPREV
 20658*         DATASET    (FILE-ID-ERPNDB)
 20659*         SET        (ADDRESS OF PENDING-BUSINESS)
 20660*         RIDFLD     (ERPNDB-KEY)
 20661*    END-EXEC.
 20662     MOVE 0
 20663       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 379
* EL6311.cbl
 20664*    MOVE '&0S                   )   #00017597' TO DFHEIV0
 20665     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20666     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20667     MOVE X'2020233030303137353937' TO DFHEIV0(25:11)
 20668     CALL 'kxdfhei1' USING DFHEIV0,
 20669           FILE-ID-ERPNDB,
 20670           DFHEIV20,
 20671           DFHEIV99,
 20672           ERPNDB-KEY,
 20673           DFHEIV99,
 20674           DFHEIV11,
 20675           DFHEIV99,
 20676           DFHEIV99
 20677     SET ADDRESS OF PENDING-BUSINESS TO
 20678         DFHEIV20
 20679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20680
 20681
 20682 4810-READ-PREV-RECORD.
 20683
 20684* EXEC CICS READPREV
 20685*         DATASET    (FILE-ID-ERPNDB)
 20686*         SET        (ADDRESS OF PENDING-BUSINESS)
 20687*         RIDFLD     (ERPNDB-KEY)
 20688*    END-EXEC.
 20689     MOVE 0
 20690       TO DFHEIV11
 20691*    MOVE '&0S                   )   #00017604' TO DFHEIV0
 20692     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20693     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20694     MOVE X'2020233030303137363034' TO DFHEIV0(25:11)
 20695     CALL 'kxdfhei1' USING DFHEIV0,
 20696           FILE-ID-ERPNDB,
 20697           DFHEIV20,
 20698           DFHEIV99,
 20699           ERPNDB-KEY,
 20700           DFHEIV99,
 20701           DFHEIV11,
 20702           DFHEIV99,
 20703           DFHEIV99
 20704     SET ADDRESS OF PENDING-BUSINESS TO
 20705         DFHEIV20
 20706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20707
 20708
 20709     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20710        GO TO 4850-END-RECORDS.
 20711
 20712     IF PB-BATCH-TRAILER
 20713        GO TO 4810-READ-PREV-RECORD.
 20714
 20715     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20716
 20717     IF  WS-BATCH-PREFIX = '#CL'
 20718         GO TO 4810-READ-PREV-RECORD.
 20719
 20720     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20721        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 380
* EL6311.cbl
 20722           GO TO 4810-READ-PREV-RECORD
 20723        ELSE
 20724           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20725              GO TO 4820-CHECK-REC-TYPE
 20726           ELSE
 20727              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20728                 GO TO 4820-CHECK-REC-TYPE
 20729              ELSE
 20730                 GO TO 4810-READ-PREV-RECORD.
 20731
 20732     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20733        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20734           GO TO 4810-READ-PREV-RECORD.
 20735
 20736 4820-CHECK-REC-TYPE.
 20737     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20738         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20739             NEXT SENTENCE
 20740         ELSE
 20741             GO TO 4810-READ-PREV-RECORD.
 20742
 20743     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20744         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20745             NEXT SENTENCE
 20746        ELSE
 20747             GO TO 4810-READ-PREV-RECORD.
 20748
 20749     IF NOT DISPLAY-CHANGE-RECORDS AND
 20750            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20751        GO TO 4810-READ-PREV-RECORD.
 20752
 20753     IF DISPLAY-HOLD-RECORDS AND
 20754        NOT PB-RECORD-ON-HOLD
 20755          GO TO 4810-READ-PREV-RECORD.
 20756
 20757     IF PB-ISSUE
 20758        IF DISPLAY-CHK-REQ-RECORDS
 20759           GO TO 4810-READ-PREV-RECORD.
 20760
 20761     IF PB-ISSUE
 20762        IF ISSUE-WITH-WARNING
 20763           IF PB-WARNING-ERRORS
 20764              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20765                  GO TO 4810-READ-PREV-RECORD
 20766              ELSE
 20767                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20768                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20769                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20770                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20771                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20772                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20773                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20774                 GO TO 7000-DISPLAY-ISSUES
 20775           ELSE
 20776              GO TO 4810-READ-PREV-RECORD.
 20777
 20778     IF PB-ISSUE
 20779        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 381
* EL6311.cbl
 20780            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20781            ALL-ISSUES
 20782            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20783            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20784            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20785            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20786            MOVE PB-SV-STATE            TO PI-SV-STATE
 20787            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20788            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20789            GO TO 7000-DISPLAY-ISSUES
 20790        ELSE
 20791            GO TO 4810-READ-PREV-RECORD.
 20792
 20793     IF PB-CANCELLATION
 20794        IF DISPLAY-CHK-REQ-RECORDS
 20795           IF PB-C-REFUND-REQUESTED
 20796              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20797              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20798              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20799              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20800              MOVE PB-SV-STATE            TO PI-SV-STATE
 20801              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20802              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20803              GO TO 7100-DISPLAY-CANCELS
 20804           ELSE
 20805              GO TO 4810-READ-PREV-RECORD.
 20806
 20807     IF PB-CANCELLATION
 20808        IF CANCEL-WITH-WARNING
 20809           IF PB-WARNING-ERRORS
 20810              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20811                  GO TO 4810-READ-PREV-RECORD
 20812              ELSE
 20813                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20814                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20815                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20816                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20817                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20818                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20819                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20820                 GO TO 7100-DISPLAY-CANCELS
 20821           ELSE
 20822              GO TO 4810-READ-PREV-RECORD.
 20823
 20824     IF PB-CANCELLATION
 20825        IF (CANCEL-IN-ERROR  AND
 20826            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20827            ALL-CANCELS
 20828            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20829            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20830            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20831            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20832            MOVE PB-SV-STATE            TO PI-SV-STATE
 20833            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20834            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20835            GO TO 7100-DISPLAY-CANCELS.
 20836
 20837     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 382
* EL6311.cbl
 20838
 20839 4850-END-RECORDS.
 20840     MOVE ER-2252                TO EMI-ERROR.
 20841     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20842
 20843     IF PI-MAP-NAME = EL631B
 20844        MOVE -1                  TO BPFENTRL
 20845     ELSE
 20846        MOVE -1                  TO CPFENTRL.
 20847
 20848     GO TO 8200-SEND-DATAONLY.
 20849
 20850 4860-NOT-FOUND.
 20851
 20852******************************************************************
 20853*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20854******************************************************************
 20855
 20856
 20857* EXEC CICS RESETBR
 20858*         DATASET    (FILE-ID-ERPNDB)
 20859*         RIDFLD     (ERPNDB-KEY)
 20860*     END-EXEC.
 20861     MOVE 0
 20862       TO DFHEIV11
 20863*    MOVE '&4         G          &   #00017757' TO DFHEIV0
 20864     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20865     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20866     MOVE X'2020233030303137373537' TO DFHEIV0(25:11)
 20867     CALL 'kxdfhei1' USING DFHEIV0,
 20868           FILE-ID-ERPNDB,
 20869           ERPNDB-KEY,
 20870           DFHEIV99,
 20871           DFHEIV11,
 20872           DFHEIV99
 20873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20874
 20875
 20876
 20877* EXEC CICS READNEXT
 20878*         DATASET    (FILE-ID-ERPNDB)
 20879*         SET        (ADDRESS OF PENDING-BUSINESS)
 20880*         RIDFLD     (ERPNDB-KEY)
 20881*    END-EXEC.
 20882     MOVE 0
 20883       TO DFHEIV11
 20884*    MOVE '&.S                   )   #00017762' TO DFHEIV0
 20885     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20886     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20887     MOVE X'2020233030303137373632' TO DFHEIV0(25:11)
 20888     CALL 'kxdfhei1' USING DFHEIV0,
 20889           FILE-ID-ERPNDB,
 20890           DFHEIV20,
 20891           DFHEIV99,
 20892           ERPNDB-KEY,
 20893           DFHEIV99,
 20894           DFHEIV11,
 20895           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 383
* EL6311.cbl
 20896           DFHEIV99
 20897     SET ADDRESS OF PENDING-BUSINESS TO
 20898         DFHEIV20
 20899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20900
 20901
 20902
 20903* EXEC CICS READPREV
 20904*         DATASET    (FILE-ID-ERPNDB)
 20905*         SET        (ADDRESS OF PENDING-BUSINESS)
 20906*         RIDFLD     (ERPNDB-KEY)
 20907*    END-EXEC.
 20908     MOVE 0
 20909       TO DFHEIV11
 20910*    MOVE '&0S                   )   #00017768' TO DFHEIV0
 20911     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20912     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20913     MOVE X'2020233030303137373638' TO DFHEIV0(25:11)
 20914     CALL 'kxdfhei1' USING DFHEIV0,
 20915           FILE-ID-ERPNDB,
 20916           DFHEIV20,
 20917           DFHEIV99,
 20918           ERPNDB-KEY,
 20919           DFHEIV99,
 20920           DFHEIV11,
 20921           DFHEIV99,
 20922           DFHEIV99
 20923     SET ADDRESS OF PENDING-BUSINESS TO
 20924         DFHEIV20
 20925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20926
 20927
 20928     GO TO 4810-READ-PREV-RECORD.
 20929
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 384
* EL6311.cbl
 20931
 20932******************************************************************
 20933*                                                                *
 20934*           B R O W S E   C S R   B A C K W A R D                *
 20935*                                                                *
 20936******************************************************************
 20937
 20938 4900-BROWSE-CSR-BACKWARD.
 20939
 20940     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20941
 20942
 20943* EXEC CICS HANDLE CONDITION
 20944*         NOTFND   (4970-NOT-FOUND)
 20945*         ENDFILE  (4950-END-RECORDS)
 20946*    END-EXEC
 20947*    MOVE '"$I''                  ! Q #00017788' TO DFHEIV0
 20948     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20949     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20950     MOVE X'5120233030303137373838' TO DFHEIV0(25:11)
 20951     CALL 'kxdfhei1' USING DFHEIV0
 20952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20953
 20954
 20955* EXEC CICS STARTBR
 20956*         DATASET   (FILE-ID-ERPNDB4)
 20957*         RIDFLD    (ERPNDB-CSR-KEY)
 20958*    END-EXEC.
 20959     MOVE 0
 20960       TO DFHEIV11
 20961*    MOVE '&,         G          &   #00017793' TO DFHEIV0
 20962     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20963     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20964     MOVE X'2020233030303137373933' TO DFHEIV0(25:11)
 20965     CALL 'kxdfhei1' USING DFHEIV0,
 20966           FILE-ID-ERPNDB4,
 20967           ERPNDB-CSR-KEY,
 20968           DFHEIV99,
 20969           DFHEIV11,
 20970           DFHEIV99
 20971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20972
 20973
 20974     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20975                                    WS-FIRST-TIME-SW.
 20976
 20977 4905-READ-PREV-RECORD.
 20978
 20979* EXEC CICS READPREV
 20980*         DATASET    (FILE-ID-ERPNDB4)
 20981*         SET        (ADDRESS OF PENDING-BUSINESS)
 20982*         RIDFLD     (ERPNDB-CSR-KEY)
 20983*    END-EXEC.
 20984     MOVE 0
 20985       TO DFHEIV11
 20986*    MOVE '&0S                   )   #00017802' TO DFHEIV0
 20987     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20988     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 385
* EL6311.cbl
 20989     MOVE X'2020233030303137383032' TO DFHEIV0(25:11)
 20990     CALL 'kxdfhei1' USING DFHEIV0,
 20991           FILE-ID-ERPNDB4,
 20992           DFHEIV20,
 20993           DFHEIV99,
 20994           ERPNDB-CSR-KEY,
 20995           DFHEIV99,
 20996           DFHEIV11,
 20997           DFHEIV99,
 20998           DFHEIV99
 20999     SET ADDRESS OF PENDING-BUSINESS TO
 21000         DFHEIV20
 21001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21002
 21003
 21004     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21005
 21006     IF WS-BATCH-PREFIX = '#CL'
 21007         GO TO 4905-READ-PREV-RECORD.
 21008
 21009     IF FIRST-TIME
 21010         MOVE SPACE               TO WS-FIRST-TIME-SW
 21011         GO TO 4905-READ-PREV-RECORD.
 21012
 21013     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 21014        PB-CSR-ID           NOT = PI-PB-CSR-ID
 21015        GO TO 4950-END-RECORDS.
 21016
 21017     IF PB-BATCH-TRAILER
 21018        GO TO 4905-READ-PREV-RECORD.
 21019
 21020     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21021
 21022     IF  WS-BATCH-PREFIX = '#CL'
 21023         GO TO 4905-READ-PREV-RECORD.
 21024
 21025     IF PI-PB-CERT-NO NOT = LOW-VALUES
 21026        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 21027           GO TO 4905-READ-PREV-RECORD
 21028        ELSE
 21029           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 21030              GO TO 4910-CHECK-REC-TYPE
 21031           ELSE
 21032              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 21033                 GO TO 4910-CHECK-REC-TYPE
 21034              ELSE
 21035                 GO TO 4905-READ-PREV-RECORD.
 21036
 21037     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 21038        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 21039           GO TO 4905-READ-PREV-RECORD.
 21040
 21041 4910-CHECK-REC-TYPE.
 21042     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21043         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21044             NEXT SENTENCE
 21045         ELSE
 21046             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 386
* EL6311.cbl
 21047
 21048     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21049         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21050             NEXT SENTENCE
 21051        ELSE
 21052             GO TO 4905-READ-PREV-RECORD.
 21053
 21054     IF NOT DISPLAY-CHANGE-RECORDS AND
 21055            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21056        GO TO 4905-READ-PREV-RECORD.
 21057
 21058     IF DISPLAY-HOLD-RECORDS AND
 21059        NOT PB-RECORD-ON-HOLD
 21060          GO TO 4905-READ-PREV-RECORD.
 21061
 21062     IF PB-ISSUE
 21063        IF DISPLAY-CHK-REQ-RECORDS
 21064           GO TO 4905-READ-PREV-RECORD.
 21065
 21066     IF PB-ISSUE
 21067        IF ISSUE-WITH-WARNING
 21068           IF PB-WARNING-ERRORS
 21069              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 21070                  GO TO 4505-READ-PREV-RECORD
 21071              ELSE
 21072                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21073                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21074                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21075                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21076                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21077                 MOVE PB-SV-STATE            TO PI-SV-STATE
 21078                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21079                 GO TO 7000-DISPLAY-ISSUES
 21080           ELSE
 21081              GO TO 4905-READ-PREV-RECORD.
 21082
 21083     IF PB-ISSUE
 21084        IF (ISSUES-IN-ERROR AND
 21085            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 21086            ALL-ISSUES
 21087            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21088            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21089            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21090            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21091            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21092            MOVE PB-SV-STATE            TO PI-SV-STATE
 21093            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21094            GO TO 7000-DISPLAY-ISSUES
 21095        ELSE
 21096            GO TO 4905-READ-PREV-RECORD.
 21097
 21098     IF PB-CANCELLATION
 21099        IF DISPLAY-CHK-REQ-RECORDS
 21100           IF PB-C-REFUND-REQUESTED
 21101              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21102              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21103              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21104              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 387
* EL6311.cbl
 21105              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21106              MOVE PB-SV-STATE            TO PI-SV-STATE
 21107              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21108              GO TO 7100-DISPLAY-CANCELS
 21109           ELSE
 21110              GO TO 4905-READ-PREV-RECORD.
 21111
 21112     IF PB-CANCELLATION
 21113        IF CANCEL-WITH-WARNING
 21114           IF PB-WARNING-ERRORS
 21115              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 21116                  GO TO 4505-READ-PREV-RECORD
 21117              ELSE
 21118                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21119                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21120                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21121                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21122                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21123                 MOVE PB-SV-STATE            TO PI-SV-STATE
 21124                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21125                 GO TO 7100-DISPLAY-CANCELS
 21126           ELSE
 21127              GO TO 4905-READ-PREV-RECORD.
 21128
 21129     IF PB-CANCELLATION
 21130        IF (CANCEL-IN-ERROR  AND
 21131            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 21132            ALL-CANCELS
 21133            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21134            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21135            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21136            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21137            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21138            MOVE PB-SV-STATE            TO PI-SV-STATE
 21139            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21140            GO TO 7100-DISPLAY-CANCELS.
 21141
 21142     GO TO 4905-READ-PREV-RECORD.
 21143
 21144 4950-END-RECORDS.
 21145     IF PI-MAP-NAME = EL631B
 21146        MOVE -1                  TO BMAINTL
 21147     ELSE
 21148        IF PI-MAP-NAME = EL631C
 21149           MOVE -1               TO CMAINTL
 21150        ELSE
 21151           MOVE -1               TO DPFENTRL.
 21152
 21153     MOVE ER-2255               TO EMI-ERROR.
 21154     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21155     GO TO 8200-SEND-DATAONLY.
 21156
 21157 4970-NOT-FOUND.
 21158
 21159******************************************************************
 21160*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 21161******************************************************************
 21162
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 388
* EL6311.cbl
 21163
 21164* EXEC CICS RESETBR
 21165*         DATASET    (FILE-ID-ERPNDB4)
 21166*         RIDFLD     (ERPNDB-CSR-KEY)
 21167*    END-EXEC.
 21168     MOVE 0
 21169       TO DFHEIV11
 21170*    MOVE '&4         G          &   #00017967' TO DFHEIV0
 21171     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 21172     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21173     MOVE X'2020233030303137393637' TO DFHEIV0(25:11)
 21174     CALL 'kxdfhei1' USING DFHEIV0,
 21175           FILE-ID-ERPNDB4,
 21176           ERPNDB-CSR-KEY,
 21177           DFHEIV99,
 21178           DFHEIV11,
 21179           DFHEIV99
 21180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21181
 21182
 21183
 21184* EXEC CICS READNEXT
 21185*         DATASET    (FILE-ID-ERPNDB4)
 21186*         SET        (ADDRESS OF PENDING-BUSINESS)
 21187*         RIDFLD     (ERPNDB-CSR-KEY)
 21188*    END-EXEC.
 21189     MOVE 0
 21190       TO DFHEIV11
 21191*    MOVE '&.S                   )   #00017972' TO DFHEIV0
 21192     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21193     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21194     MOVE X'2020233030303137393732' TO DFHEIV0(25:11)
 21195     CALL 'kxdfhei1' USING DFHEIV0,
 21196           FILE-ID-ERPNDB4,
 21197           DFHEIV20,
 21198           DFHEIV99,
 21199           ERPNDB-CSR-KEY,
 21200           DFHEIV99,
 21201           DFHEIV11,
 21202           DFHEIV99,
 21203           DFHEIV99
 21204     SET ADDRESS OF PENDING-BUSINESS TO
 21205         DFHEIV20
 21206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21207
 21208
 21209
 21210* EXEC CICS READPREV
 21211*         DATASET    (FILE-ID-ERPNDB4)
 21212*         SET        (ADDRESS OF PENDING-BUSINESS)
 21213*         RIDFLD     (ERPNDB-CSR-KEY)
 21214*    END-EXEC.
 21215     MOVE 0
 21216       TO DFHEIV11
 21217*    MOVE '&0S                   )   #00017978' TO DFHEIV0
 21218     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21219     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21220     MOVE X'2020233030303137393738' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 389
* EL6311.cbl
 21221     CALL 'kxdfhei1' USING DFHEIV0,
 21222           FILE-ID-ERPNDB4,
 21223           DFHEIV20,
 21224           DFHEIV99,
 21225           ERPNDB-CSR-KEY,
 21226           DFHEIV99,
 21227           DFHEIV11,
 21228           DFHEIV99,
 21229           DFHEIV99
 21230     SET ADDRESS OF PENDING-BUSINESS TO
 21231         DFHEIV20
 21232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21233
 21234
 21235 4980-READ-PREV-RECORD.
 21236
 21237* EXEC CICS READPREV
 21238*         DATASET    (FILE-ID-ERPNDB4)
 21239*         SET        (ADDRESS OF PENDING-BUSINESS)
 21240*         RIDFLD     (ERPNDB-CSR-KEY)
 21241*    END-EXEC.
 21242     MOVE 0
 21243       TO DFHEIV11
 21244*    MOVE '&0S                   )   #00017985' TO DFHEIV0
 21245     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21246     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21247     MOVE X'2020233030303137393835' TO DFHEIV0(25:11)
 21248     CALL 'kxdfhei1' USING DFHEIV0,
 21249           FILE-ID-ERPNDB4,
 21250           DFHEIV20,
 21251           DFHEIV99,
 21252           ERPNDB-CSR-KEY,
 21253           DFHEIV99,
 21254           DFHEIV11,
 21255           DFHEIV99,
 21256           DFHEIV99
 21257     SET ADDRESS OF PENDING-BUSINESS TO
 21258         DFHEIV20
 21259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21260
 21261
 21262     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21263
 21264     IF WS-BATCH-PREFIX = '#CL'
 21265        GO TO 4980-READ-PREV-RECORD.
 21266
 21267     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 21268     GO TO 4905-READ-PREV-RECORD.
 21269
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 390
* EL6311.cbl
 21271
 21272
 21273******************************************************************
 21274*                                                                *
 21275*        B R O W S E   B A T C H   H E A D E R S                 *
 21276*                                                                *
 21277******************************************************************
 21278
 21279 5000-BROWSE-BATCH-HEADERS.
 21280
 21281     IF EIBTRNID NOT = TRANS-EXB1
 21282        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 21283        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21284        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21285        GO TO 5010-READ-NEXT-RECORD.
 21286
 21287     IF EIBAID = DFHPF4
 21288        MOVE '0'                TO PI-EDIT-SW
 21289        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21290        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21291        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21292        GO TO 5010-READ-NEXT-RECORD.
 21293
 21294     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21295     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21296     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21297
 21298
 21299* EXEC CICS HANDLE CONDITION
 21300*         ENDFILE  (5050-NOT-FOUND)
 21301*    END-EXEC.
 21302*    MOVE '"$''                   ! R #00018027' TO DFHEIV0
 21303     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21304     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21305     MOVE X'5220233030303138303237' TO DFHEIV0(25:11)
 21306     CALL 'kxdfhei1' USING DFHEIV0
 21307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21308
 21309
 21310 5010-READ-NEXT-RECORD.
 21311
 21312* EXEC CICS HANDLE CONDITION
 21313*         NOTFND    (5050-NOT-FOUND)
 21314*    END-EXEC.
 21315*    MOVE '"$I                   ! S #00018032' TO DFHEIV0
 21316     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21317     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21318     MOVE X'5320233030303138303332' TO DFHEIV0(25:11)
 21319     CALL 'kxdfhei1' USING DFHEIV0
 21320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21321
 21322
 21323
 21324* EXEC CICS READ
 21325*         DATASET   (FILE-ID-ERPNDB)
 21326*         SET       (ADDRESS OF PENDING-BUSINESS)
 21327*         RIDFLD    (ERPNDB-KEY)
 21328*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 391
* EL6311.cbl
 21329*    END-EXEC.
 21330*    MOVE '&"S        G          (   #00018036' TO DFHEIV0
 21331     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21332     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21333     MOVE X'2020233030303138303336' TO DFHEIV0(25:11)
 21334     CALL 'kxdfhei1' USING DFHEIV0,
 21335           FILE-ID-ERPNDB,
 21336           DFHEIV20,
 21337           DFHEIV99,
 21338           ERPNDB-KEY,
 21339           DFHEIV99,
 21340           DFHEIV99,
 21341           DFHEIV99
 21342     SET ADDRESS OF PENDING-BUSINESS TO
 21343         DFHEIV20
 21344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21345
 21346
 21347     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21348         GO TO 5050-NOT-FOUND.
 21349
 21350     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21351
 21352     IF WS-BATCH-PREFIX = '#CL'
 21353         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21354         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21355         GO TO 5010-READ-NEXT-RECORD.
 21356
 21357     IF NOT PB-BATCH-TRAILER
 21358         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21359         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21360         GO TO 5010-READ-NEXT-RECORD.
 21361
 21362     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21363         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21364             NEXT SENTENCE
 21365         ELSE
 21366             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21367             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21368             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21369             GO TO 5010-READ-NEXT-RECORD.
 21370
 21371     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21372         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21373             NEXT SENTENCE
 21374        ELSE
 21375             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21376             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21377             GO TO 5010-READ-NEXT-RECORD.
 21378
 21379     IF EIBAID = DFHPF4
 21380        MOVE '0'                TO PI-EDIT-SW
 21381        GO TO 7200-DISPLAY-BATCHES.
 21382
 21383     IF PI-CSR-BROWSE
 21384        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21385           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21386           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 392
* EL6311.cbl
 21387           GO TO 5010-READ-NEXT-RECORD.
 21388
 21389     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21390       IF PI-PB-CARRIER    = SPACES AND
 21391          PI-PB-GROUPING   = SPACES AND
 21392          PI-PB-STATE      = SPACES AND
 21393          PI-PB-ACCOUNT    = SPACES
 21394            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21395            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21396            GO TO 7200-DISPLAY-BATCHES
 21397         ELSE
 21398           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21399              PI-PB-GROUPING   = PB-GROUPING AND
 21400              PI-PB-STATE      = PB-STATE    AND
 21401              PI-PB-ACCOUNT    = PB-ACCOUNT
 21402              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21403              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21404              GO TO 7200-DISPLAY-BATCHES.
 21405
 21406     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21407     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21408
 21409
 21410* EXEC CICS HANDLE CONDITION
 21411*         NOTFND    (5050-NOT-FOUND)
 21412*    END-EXEC.
 21413*    MOVE '"$I                   ! T #00018105' TO DFHEIV0
 21414     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21415     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21416     MOVE X'5420233030303138313035' TO DFHEIV0(25:11)
 21417     CALL 'kxdfhei1' USING DFHEIV0
 21418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21419
 21420
 21421
 21422* EXEC CICS READ
 21423*         DATASET   (FILE-ID-ERPNDB)
 21424*         SET       (ADDRESS OF PENDING-BUSINESS)
 21425*         RIDFLD    (ERPNDB-KEY)
 21426*         GTEQ
 21427*    END-EXEC.
 21428*    MOVE '&"S        G          (   #00018109' TO DFHEIV0
 21429     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21431     MOVE X'2020233030303138313039' TO DFHEIV0(25:11)
 21432     CALL 'kxdfhei1' USING DFHEIV0,
 21433           FILE-ID-ERPNDB,
 21434           DFHEIV20,
 21435           DFHEIV99,
 21436           ERPNDB-KEY,
 21437           DFHEIV99,
 21438           DFHEIV99,
 21439           DFHEIV99
 21440     SET ADDRESS OF PENDING-BUSINESS TO
 21441         DFHEIV20
 21442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21443
 21444
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 393
* EL6311.cbl
 21445     GO TO 5010-READ-NEXT-RECORD.
 21446
 21447 5050-NOT-FOUND.
 21448
 21449******************************************************************
 21450*                                                                *
 21451*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21452*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21453*         PROGRAM.                                               *
 21454*                                                                *
 21455******************************************************************
 21456
 21457     IF EIBTRNID NOT = TRANS-EXB1
 21458        IF PENDING-BUS-RECS-FOUND
 21459            NEXT SENTENCE
 21460          ELSE
 21461            MOVE '9'            TO PI-BROWSE-SW
 21462            GO TO 9400-CLEAR.
 21463
 21464     MOVE ER-2256                TO EMI-ERROR.
 21465     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21466
 21467     IF PI-MAP-NAME = SPACES
 21468        MOVE EL631D              TO PI-MAP-NAME
 21469        MOVE -1                  TO DPFENTRL
 21470        GO TO 8100-SEND-INITIAL-MAP.
 21471
 21472     IF PI-MAP-NAME = EL631B
 21473        MOVE -1                  TO BMAINTL
 21474     ELSE
 21475        IF PI-MAP-NAME = EL631C
 21476           MOVE -1               TO CMAINTL
 21477        ELSE
 21478           MOVE -1               TO DPFENTRL
 21479           GO TO 8200-SEND-DATAONLY.
 21480
 21481     GO TO 8100-SEND-INITIAL-MAP.
 21482
 21483     .
 21484 5100-PROCESS-POL-RESC.
 21485     MOVE ZEROS                  TO CG-LF-BENCD
 21486                                    CG-AH-BENCD
 21487                                    CG-LF-CAN-AMT
 21488                                    CG-AH-CAN-AMT
 21489     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21490                                    CG-AH-CAN-DT
 21491     MOVE SPACES                 TO CG-BATCH-NO
 21492     MOVE '4'                    TO CG-OPTION-CODE
 21493     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21494     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21495     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21496     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21497     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21498     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21499     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21500     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21501     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21502     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 394
* EL6311.cbl
 21503     MOVE PI-PREV-ALT-KEY (1:33)
 21504                                 TO CG-CERT-KEY
 21505     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21506     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21507                                    CG-AH-CAN-AMT
 21508     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21509                                    CG-AH-CAN-DT
 21510     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21511     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21512      display 'about to cancel ' cg-cert-key
 21513
 21514* EXEC CICS LINK
 21515*        PROGRAM  ('ELCANC')
 21516*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21517*    END-EXEC
 21518     MOVE LENGTH OF
 21519      CANCEL-GEN-PASS-AREA
 21520       TO DFHEIV11
 21521     MOVE 'ELCANC' TO DFHEIV1
 21522*    MOVE '."C                   (   #00018184' TO DFHEIV0
 21523     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21524     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21525     MOVE X'2020233030303138313834' TO DFHEIV0(25:11)
 21526     CALL 'kxdfhei1' USING DFHEIV0,
 21527           DFHEIV1,
 21528           CANCEL-GEN-PASS-AREA,
 21529           DFHEIV11,
 21530           DFHEIV99,
 21531           DFHEIV99,
 21532           DFHEIV99,
 21533           DFHEIV99
 21534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21535     IF CG-SUCCESS
 21536        CONTINUE
 21537     ELSE
 21538        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21539        MOVE '3'                 TO EMI-SWITCH1
 21540        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21541        EVALUATE TRUE
 21542           WHEN CG-DATE-ERROR
 21543             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21544           WHEN CG-CERT-NOT-FOUND
 21545             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21546           WHEN CG-AMOUNT-ERROR
 21547             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21548           WHEN CG-OPTION-ERROR
 21549             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21550           WHEN CG-PREV-CAN
 21551             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21552           WHEN CG-INVALID-DATA
 21553             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21554           WHEN CG-NO-ACCT-MSTR
 21555             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21556           WHEN CG-SFX-A-EXIST
 21557             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21558           WHEN CG-MISC-ERROR
 21559             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21560           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 395
* EL6311.cbl
 21561             MOVE ' ERROR - ELCANC - RETURN '
 21562                                 TO EMI-ERROR-TEXT (1) (12:25)
 21563        END-EVALUATE
 21564        GO TO 8200-SEND-DATAONLY
 21565     END-IF
 21566
 21567* EXEC CICS GETMAIN
 21568*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 21569*        LENGTH  (ELCRTT-RECORD-LENGTH)
 21570*        INITIMG (GETMAIN-SPACE)
 21571*    END-EXEC
 21572*    MOVE ',"IL                  $   #00018219' TO DFHEIV0
 21573     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21574     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21575     MOVE X'2020233030303138323139' TO DFHEIV0(25:11)
 21576     CALL 'kxdfhei1' USING DFHEIV0,
 21577           DFHEIV20,
 21578           ELCRTT-RECORD-LENGTH,
 21579           GETMAIN-SPACE
 21580     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 21581         DFHEIV20
 21582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21583
 21584     move ' '                    to ws-elcrtt-update-sw
 21585     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTT-PRIMARY
 21586     MOVE 'C'                    TO ELCRTT-REC-TYPE
 21587
 21588
 21589* EXEC CICS READ
 21590*        UPDATE
 21591*        DATASET  (CRTT-ID)
 21592*        RIDFLD   (ELCRTT-KEY)
 21593*        INTO     (CERTIFICATE-TRAILERS)
 21594*        resp     (ws-response)
 21595*    END-EXEC
 21596     MOVE LENGTH OF
 21597      CERTIFICATE-TRAILERS
 21598       TO DFHEIV11
 21599*    MOVE '&"IL       EU         (  N#00018229' TO DFHEIV0
 21600     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21601     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21602     MOVE X'204E233030303138323239' TO DFHEIV0(25:11)
 21603     CALL 'kxdfhei1' USING DFHEIV0,
 21604           CRTT-ID,
 21605           CERTIFICATE-TRAILERS,
 21606           DFHEIV11,
 21607           ELCRTT-KEY,
 21608           DFHEIV99,
 21609           DFHEIV99,
 21610           DFHEIV99
 21611     MOVE EIBRESP  TO ws-response
 21612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21613
 21614     if resp-normal
 21615        if cs-claim-verification-status = 'B' or 'C' or 'D' or
 21616                  'E' or 'F' or 'G'
 21617           move 'J'              to cs-claim-verification-status
 21618           set update-elcrtt to true
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 396
* EL6311.cbl
 21619        end-if
 21620        if update-elcrtt
 21621
 21622* EXEC CICS REWRITE
 21623*             DATASET    (crtt-ID)
 21624*             FROM       (CERTIFICATE-TRAILERS)
 21625*          END-EXEC
 21626     MOVE LENGTH OF
 21627      CERTIFICATE-TRAILERS
 21628       TO DFHEIV11
 21629*    MOVE '&& L                  %   #00018244' TO DFHEIV0
 21630     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21631     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21632     MOVE X'2020233030303138323434' TO DFHEIV0(25:11)
 21633     CALL 'kxdfhei1' USING DFHEIV0,
 21634           crtt-ID,
 21635           CERTIFICATE-TRAILERS,
 21636           DFHEIV11,
 21637           DFHEIV99
 21638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21639        else
 21640
 21641* exec cics unlock
 21642*             dataset    (crtt-ID)
 21643*          end-exec
 21644*    MOVE '&*                    #   #00018249' TO DFHEIV0
 21645     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21646     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21647     MOVE X'2020233030303138323439' TO DFHEIV0(25:11)
 21648     CALL 'kxdfhei1' USING DFHEIV0,
 21649           crtt-ID,
 21650           DFHEIV99
 21651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21652        end-if
 21653     end-if
 21654     .
 21655 5100-EXIT.
 21656     EXIT.
 21657
 21658******************************************************************
 21659*                                                                *
 21660*        B R O W S E   B A T C H   B A C K W A R D S             *
 21661*                                                                *
 21662******************************************************************
 21663
 21664 5500-BROWSE-BATCH-BACKWARD.
 21665
 21666* EXEC CICS HANDLE CONDITION
 21667*         NOTFND   (5550-END-RECORDS)
 21668*         ENDFILE  (5550-END-RECORDS)
 21669*    END-EXEC.
 21670*    MOVE '"$I''                  ! U #00018265' TO DFHEIV0
 21671     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21673     MOVE X'5520233030303138323635' TO DFHEIV0(25:11)
 21674     CALL 'kxdfhei1' USING DFHEIV0
 21675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21676
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 397
* EL6311.cbl
 21677
 21678 5505-START-BROWSE.
 21679     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21680     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21681     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21682
 21683
 21684* EXEC CICS STARTBR
 21685*         DATASET   (FILE-ID-ERPNDB)
 21686*         RIDFLD    (ERPNDB-ALT-KEY)
 21687*    END-EXEC.
 21688     MOVE 0
 21689       TO DFHEIV11
 21690*    MOVE '&,         G          &   #00018275' TO DFHEIV0
 21691     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21692     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21693     MOVE X'2020233030303138323735' TO DFHEIV0(25:11)
 21694     CALL 'kxdfhei1' USING DFHEIV0,
 21695           FILE-ID-ERPNDB,
 21696           ERPNDB-ALT-KEY,
 21697           DFHEIV99,
 21698           DFHEIV11,
 21699           DFHEIV99
 21700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21701
 21702
 21703     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21704
 21705
 21706* EXEC CICS READNEXT
 21707*         DATASET    (FILE-ID-ERPNDB)
 21708*         SET        (ADDRESS OF PENDING-BUSINESS)
 21709*         RIDFLD     (ERPNDB-KEY)
 21710*    END-EXEC.
 21711     MOVE 0
 21712       TO DFHEIV11
 21713*    MOVE '&.S                   )   #00018282' TO DFHEIV0
 21714     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21715     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21716     MOVE X'2020233030303138323832' TO DFHEIV0(25:11)
 21717     CALL 'kxdfhei1' USING DFHEIV0,
 21718           FILE-ID-ERPNDB,
 21719           DFHEIV20,
 21720           DFHEIV99,
 21721           ERPNDB-KEY,
 21722           DFHEIV99,
 21723           DFHEIV11,
 21724           DFHEIV99,
 21725           DFHEIV99
 21726     SET ADDRESS OF PENDING-BUSINESS TO
 21727         DFHEIV20
 21728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21729
 21730
 21731
 21732* EXEC CICS READPREV
 21733*         DATASET    (FILE-ID-ERPNDB)
 21734*         SET        (ADDRESS OF PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 398
* EL6311.cbl
 21735*         RIDFLD     (ERPNDB-KEY)
 21736*    END-EXEC.
 21737     MOVE 0
 21738       TO DFHEIV11
 21739*    MOVE '&0S                   )   #00018288' TO DFHEIV0
 21740     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21741     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21742     MOVE X'2020233030303138323838' TO DFHEIV0(25:11)
 21743     CALL 'kxdfhei1' USING DFHEIV0,
 21744           FILE-ID-ERPNDB,
 21745           DFHEIV20,
 21746           DFHEIV99,
 21747           ERPNDB-KEY,
 21748           DFHEIV99,
 21749           DFHEIV11,
 21750           DFHEIV99,
 21751           DFHEIV99
 21752     SET ADDRESS OF PENDING-BUSINESS TO
 21753         DFHEIV20
 21754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21755
 21756
 21757
 21758* EXEC CICS READPREV
 21759*         DATASET    (FILE-ID-ERPNDB)
 21760*         SET        (ADDRESS OF PENDING-BUSINESS)
 21761*         RIDFLD     (ERPNDB-KEY)
 21762*    END-EXEC.
 21763     MOVE 0
 21764       TO DFHEIV11
 21765*    MOVE '&0S                   )   #00018294' TO DFHEIV0
 21766     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21767     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21768     MOVE X'2020233030303138323934' TO DFHEIV0(25:11)
 21769     CALL 'kxdfhei1' USING DFHEIV0,
 21770           FILE-ID-ERPNDB,
 21771           DFHEIV20,
 21772           DFHEIV99,
 21773           ERPNDB-KEY,
 21774           DFHEIV99,
 21775           DFHEIV11,
 21776           DFHEIV99,
 21777           DFHEIV99
 21778     SET ADDRESS OF PENDING-BUSINESS TO
 21779         DFHEIV20
 21780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21781
 21782
 21783     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21784        GO TO 5550-END-RECORDS.
 21785
 21786     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21787
 21788     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21789
 21790     IF  WS-BATCH-PREFIX = '#CL'
 21791             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21792
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 399
* EL6311.cbl
 21793* EXEC CICS ENDBR
 21794*                 DATASET  (FILE-ID-ERPNDB)
 21795*            END-EXEC
 21796     MOVE 0
 21797       TO DFHEIV11
 21798*    MOVE '&2                    $   #00018309' TO DFHEIV0
 21799     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21800     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21801     MOVE X'2020233030303138333039' TO DFHEIV0(25:11)
 21802     CALL 'kxdfhei1' USING DFHEIV0,
 21803           FILE-ID-ERPNDB,
 21804           DFHEIV11,
 21805           DFHEIV99
 21806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21807         GO TO 5505-START-BROWSE.
 21808
 21809     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21810         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21811             NEXT SENTENCE
 21812         ELSE
 21813             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21814
 21815* EXEC CICS ENDBR
 21816*                 DATASET  (FILE-ID-ERPNDB)
 21817*            END-EXEC
 21818     MOVE 0
 21819       TO DFHEIV11
 21820*    MOVE '&2                    $   #00018319' TO DFHEIV0
 21821     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21822     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21823     MOVE X'2020233030303138333139' TO DFHEIV0(25:11)
 21824     CALL 'kxdfhei1' USING DFHEIV0,
 21825           FILE-ID-ERPNDB,
 21826           DFHEIV11,
 21827           DFHEIV99
 21828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21829             GO TO 5505-START-BROWSE.
 21830
 21831
 21832     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21833         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21834             NEXT SENTENCE
 21835        ELSE
 21836             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21837
 21838* EXEC CICS ENDBR
 21839*                 DATASET  (FILE-ID-ERPNDB)
 21840*            END-EXEC
 21841     MOVE 0
 21842       TO DFHEIV11
 21843*    MOVE '&2                    $   #00018330' TO DFHEIV0
 21844     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21845     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21846     MOVE X'2020233030303138333330' TO DFHEIV0(25:11)
 21847     CALL 'kxdfhei1' USING DFHEIV0,
 21848           FILE-ID-ERPNDB,
 21849           DFHEIV11,
 21850           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 400
* EL6311.cbl
 21851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21852             GO TO 5505-START-BROWSE.
 21853
 21854     IF NOT PB-BATCH-TRAILER
 21855        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21856
 21857* EXEC CICS ENDBR
 21858*            DATASET  (FILE-ID-ERPNDB)
 21859*       END-EXEC
 21860     MOVE 0
 21861       TO DFHEIV11
 21862*    MOVE '&2                    $   #00018337' TO DFHEIV0
 21863     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21864     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21865     MOVE X'2020233030303138333337' TO DFHEIV0(25:11)
 21866     CALL 'kxdfhei1' USING DFHEIV0,
 21867           FILE-ID-ERPNDB,
 21868           DFHEIV11,
 21869           DFHEIV99
 21870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21871        GO TO 5505-START-BROWSE.
 21872
 21873     IF PI-CSR-BROWSE
 21874        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21875           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21876
 21877* EXEC CICS ENDBR
 21878*               DATASET  (FILE-ID-ERPNDB)
 21879*          END-EXEC
 21880     MOVE 0
 21881       TO DFHEIV11
 21882*    MOVE '&2                    $   #00018345' TO DFHEIV0
 21883     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21884     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21885     MOVE X'2020233030303138333435' TO DFHEIV0(25:11)
 21886     CALL 'kxdfhei1' USING DFHEIV0,
 21887           FILE-ID-ERPNDB,
 21888           DFHEIV11,
 21889           DFHEIV99
 21890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21891           GO TO 5505-START-BROWSE.
 21892
 21893     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21894        IF PI-PB-CARRIER    = SPACES AND
 21895           PI-PB-GROUPING   = SPACES AND
 21896           PI-PB-STATE      = SPACES AND
 21897           PI-PB-ACCOUNT    = SPACES
 21898             GO TO 7200-DISPLAY-BATCHES
 21899          ELSE
 21900            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21901               PI-PB-GROUPING   = PB-GROUPING AND
 21902               PI-PB-STATE      = PB-STATE    AND
 21903               PI-PB-ACCOUNT    = PB-ACCOUNT
 21904                 GO TO 7200-DISPLAY-BATCHES.
 21905
 21906     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21907
 21908
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 401
* EL6311.cbl
 21909* EXEC CICS ENDBR
 21910*         DATASET  (FILE-ID-ERPNDB)
 21911*    END-EXEC.
 21912     MOVE 0
 21913       TO DFHEIV11
 21914*    MOVE '&2                    $   #00018365' TO DFHEIV0
 21915     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21916     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21917     MOVE X'2020233030303138333635' TO DFHEIV0(25:11)
 21918     CALL 'kxdfhei1' USING DFHEIV0,
 21919           FILE-ID-ERPNDB,
 21920           DFHEIV11,
 21921           DFHEIV99
 21922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21923
 21924
 21925     GO TO 5505-START-BROWSE.
 21926
 21927 5550-END-RECORDS.
 21928     MOVE ER-2257                TO EMI-ERROR.
 21929     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21930     MOVE -1                     TO DPFENTRL.
 21931
 21932     GO TO 8200-SEND-DATAONLY.
 21933
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 402
* EL6311.cbl
 21935
 21936******************************************************************
 21937*                                                                *
 21938*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21939*                                                                *
 21940******************************************************************
 21941
 21942 6000-CREATE-TEMP-STORAGE.
 21943
 21944
 21945* EXEC CICS HANDLE CONDITION
 21946*        QIDERR  (6050-QID-ERROR)
 21947*    END-EXEC.
 21948*    MOVE '"$N                   ! V #00018388' TO DFHEIV0
 21949     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21950     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21951     MOVE X'5620233030303138333838' TO DFHEIV0(25:11)
 21952     CALL 'kxdfhei1' USING DFHEIV0
 21953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21954
 21955
 21956
 21957* EXEC CICS WRITEQ TS
 21958*        QUEUE    (QID)
 21959*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21960*        LENGTH   (WS-COMM-LENGTH)
 21961*        ITEM     (W-ONE)
 21962*    END-EXEC.
 21963*    MOVE '*" I   L              ''   #00018392' TO DFHEIV0
 21964     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 21965     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21966     MOVE X'2020233030303138333932' TO DFHEIV0(25:11)
 21967     CALL 'kxdfhei1' USING DFHEIV0,
 21968           QID,
 21969           PROGRAM-INTERFACE-BLOCK,
 21970           WS-COMM-LENGTH,
 21971           W-ONE,
 21972           DFHEIV99,
 21973           DFHEIV99
 21974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21975
 21976
 21977 6000-EXIT.
 21978      EXIT.
 21979
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 403
* EL6311.cbl
 21981
 21982******************************************************************
 21983*                                                                *
 21984*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21985*                                                                *
 21986******************************************************************
 21987
 21988 6050-RECOVER-TEMP-STORAGE.
 21989     IF PGM-NAME = XCTL-EL6312
 21990        GO TO 6050-EXIT.
 21991
 21992     IF PGM-NAME = XCTL-EL6313
 21993        GO TO 6050-EXIT.
 21994
 21995     IF PGM-NAME = XCTL-EL6315
 21996         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21997     END-IF
 21998
 21999     IF PGM-NAME = XCTL-EL6316
 22000         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 22001     END-IF
 22002
 22003
 22004* EXEC CICS HANDLE CONDITION
 22005*        QIDERR  (6050-QID-ERROR)
 22006*    END-EXEC.
 22007*    MOVE '"$N                   ! W #00018425' TO DFHEIV0
 22008     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 22009     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22010     MOVE X'5720233030303138343235' TO DFHEIV0(25:11)
 22011     CALL 'kxdfhei1' USING DFHEIV0
 22012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22013
 22014
 22015
 22016* EXEC CICS READQ TS
 22017*         QUEUE   (QID)
 22018*         INTO    (PROGRAM-INTERFACE-BLOCK)
 22019*         LENGTH  (WS-COMM-LENGTH)
 22020*         ITEM    (W-ONE)
 22021*     END-EXEC.
 22022*    MOVE '*$II   L              ''   #00018429' TO DFHEIV0
 22023     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 22024     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22025     MOVE X'2020233030303138343239' TO DFHEIV0(25:11)
 22026     CALL 'kxdfhei1' USING DFHEIV0,
 22027           QID,
 22028           PROGRAM-INTERFACE-BLOCK,
 22029           WS-COMM-LENGTH,
 22030           W-ONE,
 22031           DFHEIV99,
 22032           DFHEIV99
 22033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22034
 22035
 22036 6050-DELETE-TEMP-STORAGE.
 22037
 22038
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 404
* EL6311.cbl
 22039* EXEC CICS DELETEQ TS
 22040*        QUEUE   (QID)
 22041*    END-EXEC.
 22042*    MOVE '*&                    #   #00018438' TO DFHEIV0
 22043     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 22044     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22045     MOVE X'2020233030303138343338' TO DFHEIV0(25:11)
 22046     CALL 'kxdfhei1' USING DFHEIV0,
 22047           QID,
 22048           DFHEIV99
 22049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22050
 22051
 22052     GO TO 6050-EXIT.
 22053
 22054 6050-QID-ERROR.
 22055     MOVE ER-0033                TO EMI-ERROR
 22056     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22057
 22058 6050-EXIT.
 22059      EXIT.
 22060
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 405
* EL6311.cbl
 22062
 22063******************************************************************
 22064*                                                                *
 22065*            T E R M   C O N V E R S I O N                       *
 22066*                                                                *
 22067******************************************************************
 22068
 22069 6100-TERM-CONVERSION.
 22070
 22071     IF PI-BPMTS = ZERO
 22072         GO TO 6199-EXIT.
 22073
 22074     IF PI-BMODE = ' ' OR 'M'
 22075         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 22076         GO TO 6105-ROUND-TERM.
 22077
 22078     IF PI-BMODE = 'S'
 22079         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 22080         GO TO 6105-ROUND-TERM.
 22081
 22082     IF PI-BMODE = 'W'
 22083         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 22084         GO TO 6105-ROUND-TERM.
 22085
 22086     IF PI-BMODE = 'B'
 22087         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 22088         GO TO 6105-ROUND-TERM.
 22089
 22090     IF PI-BMODE = 'T'
 22091         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 22092
 22093 6105-ROUND-TERM.
 22094
 22095     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 22096         ADD +1                  TO WS-CALC-TERM-WHOLE
 22097         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 22098
 22099     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 22100         GO TO 6125-COMPUTE-TERM-BENEFIT.
 22101
 22102     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 22103         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 22104                                      WS-BTERM    (WS-SUB1)
 22105         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 22106
 22107     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 22108         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 22109             MOVE -1               TO BMODEL
 22110             MOVE ER-2593          TO EMI-ERROR
 22111             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 22112             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22113
 22114 6124-CHECK-BENEFIT.
 22115
 22116     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 22117        GO TO 6126-COMPUTE-BENEFIT.
 22118
 22119     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 406
* EL6311.cbl
 22120
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 407
* EL6311.cbl
 22122******************************************************************
 22123**         COMPUTE TERM AND BENEFIT
 22124******************************************************************
 22125 6125-COMPUTE-TERM-BENEFIT.
 22126
 22127     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 22128        PI-BPMTAMT = ZERO
 22129         GO TO 6199-EXIT.
 22130
 22131     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 22132                                     WS-BTERM  (WS-SUB1).
 22133     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 22134
 22135 6126-COMPUTE-BENEFIT.
 22136
 22137     IF PI-BMODE = 'M' OR  ' '
 22138         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 22139
 22140     IF PI-BMODE = 'W'
 22141         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 22142
 22143     IF PI-BMODE = 'S'
 22144         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 22145
 22146     IF PI-BMODE = 'B'
 22147         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 22148
 22149     IF PI-BMODE = 'T'
 22150         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 22151
 22152     IF WS-SUB1 = +1
 22153        COMPUTE WS-BBEN (WS-SUB1) =
 22154                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 22155
 22156     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 22157     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 22158     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 22159
 22160 6199-EXIT.
 22161     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 408
* EL6311.cbl
 22163
 22164******************************************************************
 22165*                                                                *
 22166*             D I S P L A Y   I S S U E S                        *
 22167*                                                                *
 22168******************************************************************
 22169
 22170 6200-CREATE-VADS.
 22171     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 22172     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 22173     MOVE SPACES                 TO WS-PASS-VADS-REC
 22174
 22175* EXEC CICS GETMAIN
 22176*       SET      (ADDRESS OF PENDING-BUSINESS)
 22177*       LENGTH   (ERPNDB-RECORD-LENGTH)
 22178*       INITIMG  (GETMAIN-SPACE)
 22179*       RESP     (WS-RESPONSE)
 22180*    END-EXEC
 22181*    MOVE ',"IL                  $  N#00018564' TO DFHEIV0
 22182     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22183     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22184     MOVE X'204E233030303138353634' TO DFHEIV0(25:11)
 22185     CALL 'kxdfhei1' USING DFHEIV0,
 22186           DFHEIV20,
 22187           ERPNDB-RECORD-LENGTH,
 22188           GETMAIN-SPACE
 22189     SET ADDRESS OF PENDING-BUSINESS TO
 22190         DFHEIV20
 22191     MOVE EIBRESP  TO WS-RESPONSE
 22192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22193
 22194* EXEC CICS READ
 22195*       INTO    (PENDING-BUSINESS)
 22196*       DATASET (FILE-ID-ERPNDB)
 22197*       RIDFLD  (ERPNDB-KEY)
 22198*       RESP    (WS-RESPONSE)
 22199*    END-EXEC
 22200     MOVE LENGTH OF
 22201      PENDING-BUSINESS
 22202       TO DFHEIV11
 22203*    MOVE '&"IL       E          (  N#00018570' TO DFHEIV0
 22204     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22205     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22206     MOVE X'204E233030303138353730' TO DFHEIV0(25:11)
 22207     CALL 'kxdfhei1' USING DFHEIV0,
 22208           FILE-ID-ERPNDB,
 22209           PENDING-BUSINESS,
 22210           DFHEIV11,
 22211           ERPNDB-KEY,
 22212           DFHEIV99,
 22213           DFHEIV99,
 22214           DFHEIV99
 22215     MOVE EIBRESP  TO WS-RESPONSE
 22216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22217     IF RESP-NORMAL
 22218        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22219        IF (RESP-NORMAL)
 22220           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 409
* EL6311.cbl
 22221              AM-CONTROL-PRIMARY (1:20))
 22222           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 22223        ELSE
 22224           MOVE 'ACCOUNT NOT FOUND'
 22225                                 TO VD-ACCOUNT-NAME
 22226        END-IF
 22227        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 22228                                    TO M1
 22229        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 22230        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 22231           (A2 > M1)
 22232           OR (WS-WORK-FIELD (A2:1) = '*')
 22233           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 22234           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 22235        END-PERFORM
 22236        IF A2 > M1
 22237           CONTINUE
 22238        ELSE
 22239           MOVE WS-WORK-FIELD (1:A2 - 1)
 22240                                    TO VD-ACCOUNT-NAME
 22241        END-IF
 22242        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 22243        MOVE PB-CARRIER          TO VD-CARRIER
 22244        MOVE PB-GROUPING         TO VD-GROUPING
 22245        MOVE PB-STATE            TO VD-STATE
 22246        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 22247        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 22248        MOVE PB-CERT-NO          TO VD-CERT-NO
 22249        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 22250        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 22251        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 22252        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 22253        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 22254        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 22255        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 22256        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 22257        MOVE PB-CSR-ID           TO VD-CSR-ID
 22258        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 22259        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 22260        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 22261        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 22262        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 22263        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 22264        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 22265        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 22266        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 22267        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 22268        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 22269        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 22270        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 22271     END-IF
 22272     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 22273
 22274
 22275* EXEC CICS GETMAIN
 22276*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 22277*       LENGTH   (ERPNDM-RECORD-LENGTH)
 22278*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 410
* EL6311.cbl
 22279*       RESP     (WS-RESPONSE)
 22280*    END-EXEC
 22281*    MOVE ',"IL                  $  N#00018633' TO DFHEIV0
 22282     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22283     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22284     MOVE X'204E233030303138363333' TO DFHEIV0(25:11)
 22285     CALL 'kxdfhei1' USING DFHEIV0,
 22286           DFHEIV20,
 22287           ERPNDM-RECORD-LENGTH,
 22288           GETMAIN-SPACE
 22289     SET ADDRESS OF PENDING-MAILING-DATA TO
 22290         DFHEIV20
 22291     MOVE EIBRESP  TO WS-RESPONSE
 22292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22293
 22294
 22295* EXEC CICS READ
 22296*       INTO    (PENDING-MAILING-DATA)
 22297*       DATASET (FILE-ID-ERPNDM)
 22298*       RIDFLD  (ERPNDM-KEY)
 22299*       RESP    (WS-RESPONSE)
 22300*    END-EXEC
 22301     MOVE LENGTH OF
 22302      PENDING-MAILING-DATA
 22303       TO DFHEIV11
 22304*    MOVE '&"IL       E          (  N#00018640' TO DFHEIV0
 22305     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22306     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22307     MOVE X'204E233030303138363430' TO DFHEIV0(25:11)
 22308     CALL 'kxdfhei1' USING DFHEIV0,
 22309           FILE-ID-ERPNDM,
 22310           PENDING-MAILING-DATA,
 22311           DFHEIV11,
 22312           ERPNDM-KEY,
 22313           DFHEIV99,
 22314           DFHEIV99,
 22315           DFHEIV99
 22316     MOVE EIBRESP  TO WS-RESPONSE
 22317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22318
 22319     IF RESP-NORMAL
 22320        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22321        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22322        MOVE PM-CITY              TO VD-INSURED-CITY
 22323        MOVE PM-STATE             TO VD-INSURED-STATE
 22324        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22325     END-IF
 22326
 22327     MOVE 'VAC1'                  TO VD-LETTER-ID
 22328     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22329     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22330     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22331     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22332     MOVE +0                      TO VD-ARCHIVE-NO
 22333     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22334     .
 22335 6200-EXIT.
 22336     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 411
* EL6311.cbl
 22337 6210-READ-ERACCT.
 22338     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22339     MOVE LOW-VALUES             TO ERACCT-FILL
 22340
 22341* EXEC CICS READ
 22342*         DATASET   ('ERACCT')
 22343*         INTO      (ACCOUNT-MASTER)
 22344*         RIDFLD    (ERACCT-KEY)
 22345*         GTEQ
 22346*         RESP      (WS-RESPONSE)
 22347*    END-EXEC
 22348     MOVE LENGTH OF
 22349      ACCOUNT-MASTER
 22350       TO DFHEIV11
 22351     MOVE 'ERACCT' TO DFHEIV1
 22352*    MOVE '&"IL       G          (  N#00018668' TO DFHEIV0
 22353     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22354     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22355     MOVE X'204E233030303138363638' TO DFHEIV0(25:11)
 22356     CALL 'kxdfhei1' USING DFHEIV0,
 22357           DFHEIV1,
 22358           ACCOUNT-MASTER,
 22359           DFHEIV11,
 22360           ERACCT-KEY,
 22361           DFHEIV99,
 22362           DFHEIV99,
 22363           DFHEIV99
 22364     MOVE EIBRESP  TO WS-RESPONSE
 22365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22366     .
 22367 6210-EXIT.
 22368     EXIT.
 22369
 22370 6220-READ-ERMAIL.
 22371
 22372     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22373     MOVE ' '                    TO WS-ERMAIL-SW
 22374
 22375
 22376* EXEC CICS READ
 22377*       DATASET   (FILE-ID-ERMAIL)
 22378*       SET       (ADDRESS OF MAILING-DATA)
 22379*       RIDFLD    (ERMAIL-KEY)
 22380*       RESP      (WS-RESPONSE)
 22381*    END-EXEC
 22382*    MOVE '&"S        E          (  N#00018684' TO DFHEIV0
 22383     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22384     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22385     MOVE X'204E233030303138363834' TO DFHEIV0(25:11)
 22386     CALL 'kxdfhei1' USING DFHEIV0,
 22387           FILE-ID-ERMAIL,
 22388           DFHEIV20,
 22389           DFHEIV99,
 22390           ERMAIL-KEY,
 22391           DFHEIV99,
 22392           DFHEIV99,
 22393           DFHEIV99
 22394     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 412
* EL6311.cbl
 22395         DFHEIV20
 22396     MOVE EIBRESP  TO WS-RESPONSE
 22397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22398
 22399     IF RESP-NORMAL
 22400        SET ERMAIL-FOUND TO TRUE
 22401     END-IF
 22402     .
 22403 6220-EXIT.
 22404     EXIT.
 22405
 22406 6400-CHECK-FOR-RES-REF-CLAIM.
 22407     display 'made it to 6400- for ' pi-cert-no
 22408     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22409
 22410     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22411                                    W-CL-COMP-CD.
 22412     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22413                                    W-CL-CERT-NO.
 22414     MOVE SPACES                 TO MSTR-CERT-SFX.
 22415
 22416
 22417* EXEC CICS HANDLE CONDITION
 22418*        NOTFND  (6400-CONTINUE)
 22419*        ENDFILE (6400-CONTINUE)
 22420*    END-EXEC.
 22421*    MOVE '"$I''                  ! X #00018708' TO DFHEIV0
 22422     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22423     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22424     MOVE X'5820233030303138373038' TO DFHEIV0(25:11)
 22425     CALL 'kxdfhei1' USING DFHEIV0
 22426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22427
 22428
 22429
 22430* EXEC CICS IGNORE CONDITION
 22431*        DUPKEY
 22432*    END-EXEC.
 22433*    MOVE '"*$                   !   #00018713' TO DFHEIV0
 22434     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22435     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22436     MOVE X'2020233030303138373133' TO DFHEIV0(25:11)
 22437     CALL 'kxdfhei1' USING DFHEIV0
 22438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22439
 22440
 22441
 22442* EXEC CICS STARTBR
 22443*        DATASET   (CLMS-ID)
 22444*        RIDFLD    (ELMSTR-KEY)
 22445*        GENERIC   EQUAL
 22446*        KEYLENGTH (ELMSTR-LENGTH)
 22447*    END-EXEC.
 22448     MOVE 0
 22449       TO DFHEIV11
 22450*    MOVE '&,   KG    E          &   #00018717' TO DFHEIV0
 22451     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22452     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 413
* EL6311.cbl
 22453     MOVE X'2020233030303138373137' TO DFHEIV0(25:11)
 22454     CALL 'kxdfhei1' USING DFHEIV0,
 22455           CLMS-ID,
 22456           ELMSTR-KEY,
 22457           ELMSTR-LENGTH,
 22458           DFHEIV11,
 22459           DFHEIV99
 22460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22461
 22462
 22463     display 'browse started'
 22464     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22465
 22466 6400-NEXT-CLAIM.
 22467
 22468
 22469* EXEC CICS READNEXT
 22470*        DATASET   (CLMS-ID)
 22471*        RIDFLD    (ELMSTR-KEY)
 22472*        SET       (ADDRESS OF CLAIM-MASTER)
 22473*    END-EXEC.
 22474     MOVE 0
 22475       TO DFHEIV11
 22476*    MOVE '&.S                   )   #00018729' TO DFHEIV0
 22477     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22478     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22479     MOVE X'2020233030303138373239' TO DFHEIV0(25:11)
 22480     CALL 'kxdfhei1' USING DFHEIV0,
 22481           CLMS-ID,
 22482           DFHEIV20,
 22483           DFHEIV99,
 22484           ELMSTR-KEY,
 22485           DFHEIV99,
 22486           DFHEIV11,
 22487           DFHEIV99,
 22488           DFHEIV99
 22489     SET ADDRESS OF CLAIM-MASTER TO
 22490         DFHEIV20
 22491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22492
 22493
 22494     display 'read claim for ' mstr-cert-no
 22495     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22496        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22497         GO TO 6400-CONTINUE
 22498     END-IF.
 22499
 22500     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22501        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22502        PI-STATE       NOT = CL-CERT-STATE     OR
 22503        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22504        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22505         GO TO 6400-NEXT-CLAIM
 22506     END-IF.
 22507
 22508     display 'found claim ' cl-claim-no
 22509        ' with denial type ' cl-denial-type
 22510     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 414
* EL6311.cbl
 22511         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22512         GO TO 6400-CONTINUE
 22513     END-IF.
 22514
 22515     GO TO 6400-NEXT-CLAIM.
 22516
 22517 6400-CONTINUE.
 22518
 22519     IF WS-BROWSE-STARTED-SW = 'Y'
 22520
 22521* EXEC CICS ENDBR
 22522*            DATASET   (CLMS-ID)
 22523*        END-EXEC
 22524     MOVE 0
 22525       TO DFHEIV11
 22526*    MOVE '&2                    $   #00018761' TO DFHEIV0
 22527     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22528     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22529     MOVE X'2020233030303138373631' TO DFHEIV0(25:11)
 22530     CALL 'kxdfhei1' USING DFHEIV0,
 22531           CLMS-ID,
 22532           DFHEIV11,
 22533           DFHEIV99
 22534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22535         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22536     END-IF.
 22537
 22538 6400-EXIT.
 22539     EXIT.
 22540
 22541 7000-DISPLAY-ISSUES.
 22542
 22543     IF PI-DISPLAY-ORIGINAL-BATCH
 22544        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22545        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22546     ELSE
 22547        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22548
 22549     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22550
 22551     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22552     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22553
 22554     MOVE LOW-VALUES                 TO EL631BI.
 22555     MOVE ZEROS                      TO PI-BPMTAMT
 22556                                        PI-BPMTS.
 22557     MOVE SPACE                      TO PI-BMODE
 22558                                        PI-BTYPE (1)
 22559                                        PI-BTYPE (2).
 22560     MOVE EL631B                     TO PI-MAP-NAME.
 22561     MOVE 'Y'                        TO PI-BROWSE-SW.
 22562     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22563                                        PI-HIGH-SEQ-NO.
 22564
 22565     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22566        MOVE AL-SABOF                TO BCHGTA
 22567        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22568        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 415
* EL6311.cbl
 22569     ELSE
 22570        MOVE AL-SADOF                TO BCHGTA
 22571                                        BCHGA
 22572        MOVE PB-CHG-COUNT            TO BCHGO.
 22573
 22574     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22575     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22576     MOVE WS-HR-MINS                 TO BMANTATO.
 22577
 22578     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22579        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22580        MOVE SPACE                   TO DC-OPTION-CODE
 22581        PERFORM 9700-DATE-LINK
 22582        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22583        MOVE 'INACTIVE'              TO BMOENDTO
 22584     ELSE
 22585        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22586        MOVE SPACE                   TO DC-OPTION-CODE
 22587        PERFORM 9700-DATE-LINK
 22588        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22589        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22590        MOVE SPACE                   TO DC-OPTION-CODE
 22591        PERFORM 9700-DATE-LINK
 22592        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22593
 22594*    MOVE PB-I-REFERENCE             TO BREFO.
 22595
 22596*    IF PI-COMPANY-ID EQUAL 'HER'
 22597*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22598*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22599*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22600*                MOVE WS-MEMBER-NO-1-8
 22601*                                TO  BMICRNOO.
 22602
 22603*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22604*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22605*            MOVE PB-I-MICROFILM-NO
 22606*                                TO  BMICRNOO.
 22607     IF PB-I-VIN NOT = SPACES
 22608        MOVE PB-I-VIN            TO BVINO
 22609     END-IF
 22610
 22611     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22612     MOVE PB-CERT-SFX                TO BSUFIXO.
 22613     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22614     MOVE SPACE                      TO DC-OPTION-CODE.
 22615     PERFORM 9700-DATE-LINK.
 22616     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22617
 22618     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22619     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22620     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22621     MOVE PB-I-INSURED-SEX           TO BSEXO
 22622
 22623     IF PB-I-AGE NOT = ZEROS
 22624         MOVE PB-I-AGE               TO BAGEO.
 22625
 22626     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 416
* EL6311.cbl
 22627                                 TO ELCERT-KEY
 22628     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22629     IF NOT CERT-TRL-REC-NOT-FOUND
 22630         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22631             MOVE 'AGE*'             TO BAGEDEFO
 22632         ELSE
 22633             MOVE 'AGE '             TO BAGEDEFO
 22634         END-IF
 22635     ELSE
 22636         MOVE 'AGE '             TO BAGEDEFO
 22637     END-IF
 22638
 22639     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22640         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22641         MOVE SPACE                  TO DC-OPTION-CODE
 22642         PERFORM 9700-DATE-LINK
 22643         IF NO-CONVERSION-ERROR
 22644            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22645
 22646     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22647         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22648         MOVE SPACE                  TO DC-OPTION-CODE
 22649         PERFORM 9700-DATE-LINK
 22650         IF NO-CONVERSION-ERROR
 22651            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22652
 22653     IF PB-I-EXTENTION-DAYS NUMERIC
 22654        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22655           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22656        ELSE
 22657           IF PB-I-TERM-IN-DAYS NUMERIC
 22658              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22659                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22660
 22661     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22662        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22663
 22664     MOVE PB-FORCE-CODE              TO BFORCEO.
 22665     MOVE PB-I-TERM-TYPE             TO BMODEO
 22666                                        PI-BMODE.
 22667
 22668     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22669        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22670
 22671     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22672         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22673                                        PI-BPMTS.
 22674
 22675     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22676         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22677           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22678                                        PI-BPMTAMT.
 22679
 22680     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22681     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22682     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22683     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22684     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 417
* EL6311.cbl
 22685     MOVE PB-I-SIG-SW                TO BSIGO.
 22686     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22687     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22688     MOVE PB-RECORD-BILL             TO BBILCDO.
 22689     MOVE PB-FORCE-CODE              TO BFORCEO.
 22690
 22691     IF (PB-I-LIVES NUMERIC)
 22692        AND (PB-I-LIVES > ZEROS)
 22693        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22694        IF (RESP-NORMAL)
 22695           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22696           CONTINUE
 22697        ELSE
 22698           MOVE PB-I-LIVES       TO BLIVESO
 22699        END-IF
 22700     END-IF
 22701
 22702     IF PB-I-NUM-BILLED NUMERIC AND
 22703        PB-I-NUM-BILLED GREATER THAN ZEROS
 22704        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22705*    ELSE
 22706*       MOVE ZEROS                   TO BBILLEDO.
 22707
 22708     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22709
 22710     IF PB-I-LOAN-APR NOT = +99.9999
 22711        MOVE PB-I-LOAN-APR           TO BAPRO.
 22712
 22713     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22714        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22715
 22716     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22717        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22718           MOVE AL-SANOF                TO BORIGHDA
 22719           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22720           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22721
 22722     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22723
 22724     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22725        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22726
 22727     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22728        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22729                                        PI-BTYPE (1).
 22730
 22731     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22732        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22733
 22734     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22735        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22736
 22737     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22738        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22739
 22740     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22741        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22742
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 418
* EL6311.cbl
 22743     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22744        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22745
 22746     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22747         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22748         MOVE SPACE                  TO DC-OPTION-CODE
 22749         PERFORM 9700-DATE-LINK
 22750         IF NO-CONVERSION-ERROR
 22751            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22752
 22753     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22754        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22755        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22756        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22757        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22758                 GIVING BDIFFO (1)
 22759     ELSE
 22760        MOVE SPACES                  TO BBEN-CD     (1)
 22761                                        BBEN-ABBR   (1).
 22762
 22763     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22764        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22765        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22766                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22767
 22768     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22769       IF PB-RECORD-ON-HOLD
 22770          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22771
 22772     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22773       IF PB-RECORD-RETURNED
 22774          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22775
 22776     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22777        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22778             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22779
 22780     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22781
 22782     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22783        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22784
 22785     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22786        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22787                                        PI-BTYPE (2).
 22788
 22789     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22790        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22791
 22792     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22793        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22794
 22795     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22796        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22797
 22798     IF PB-I-TOT-FEES NOT NUMERIC
 22799        MOVE ZEROS               TO PB-I-TOT-FEES
 22800     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 419
* EL6311.cbl
 22801     IF PB-I-TOT-FEES > ZEROS
 22802        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22803
 22804     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22805         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22806         MOVE SPACE                  TO DC-OPTION-CODE
 22807         PERFORM 9700-DATE-LINK
 22808         IF NO-CONVERSION-ERROR
 22809            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22810
 22811     IF PB-I-TOT-FEES > ZEROS
 22812        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22813        SUBTRACT PB-I-TOT-FEES FROM
 22814                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22815
 22816     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22817        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22818        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22819        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22820        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22821                 GIVING BDIFFO (2)
 22822     ELSE
 22823        MOVE SPACES                  TO BBEN-CD     (2)
 22824                                        BBEN-ABBR   (2).
 22825
 22826     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22827       IF PB-RECORD-ON-HOLD
 22828          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22829
 22830     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22831       IF PB-RECORD-RETURNED
 22832          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22833
 22834     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22835        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22836             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22837
 22838     MOVE PB-CSR-ID                  TO BCSRO.
 22839
 22840     IF PI-COMPANY-ID  =  'DMD'
 22841        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22842            NEXT SENTENCE
 22843        ELSE
 22844            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22845               MOVE 'NEW CERT'       TO BNCERTLI
 22846               MOVE EC-NEW-CERT      TO BNCERTO.
 22847
 22848     IF PI-COMPANY-ID  =  'DMD'
 22849        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22850            NEXT SENTENCE
 22851        ELSE
 22852           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22853               MOVE 'NEW STATE'      TO BNSTATLI
 22854               MOVE EC-NEW-STATE     TO BNSTATO.
 22855
 22856 7000-CONTINUE.
 22857     MOVE 'C'                        TO BMAINTI.
 22858     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 420
* EL6311.cbl
 22859
 22860     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22861        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22862
 22863     IF PI-6315-FINALIZED = 'Y'   AND
 22864        PB-UNFORCED-ERRORS
 22865          MOVE -1                TO BFORCEL
 22866          MOVE  1                TO SET-CURSOR-SW
 22867     END-IF
 22868
 22869     IF NO-CURSOR-SET
 22870        MOVE -1                      TO BMAINTL.
 22871
 22872     GO TO 8100-SEND-INITIAL-MAP.
 22873
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 421
* EL6311.cbl
 22875
 22876******************************************************************
 22877*                                                                *
 22878*             D I S P L A Y   C A N C E L S                      *
 22879*                                                                *
 22880******************************************************************
 22881
 22882 7100-DISPLAY-CANCELS.
 22883     IF PI-DISPLAY-ORIGINAL-BATCH
 22884        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22885        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22886     ELSE
 22887        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22888
 22889     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22890
 22891     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22892     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22893
 22894     MOVE LOW-VALUES                 TO EL631CI.
 22895     MOVE EL631C                     TO PI-MAP-NAME.
 22896     MOVE 'Y'                        TO PI-BROWSE-SW.
 22897     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22898                                        PI-HIGH-SEQ-NO.
 22899
 22900     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22901        MOVE AL-SABOF                TO CCHGTA
 22902        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22903        MOVE AL-SANON                TO CCHGA
 22904      ELSE
 22905        MOVE AL-SADOF                TO CCHGTA
 22906                                        CCHGA
 22907        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22908
 22909*    MOVE PB-C-REFERENCE             TO CREFO.
 22910
 22911*    IF PB-C-MICROFILM-NO IS NUMERIC
 22912*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22913*          MOVE PB-C-MICROFILM-NO
 22914*                                TO CMICRNOO
 22915*          MOVE AL-UNNON         TO CMICRNOA
 22916*       END-IF
 22917*    END-IF
 22918     IF PB-C-INT-ON-REFS NUMERIC
 22919        IF PB-C-INT-ON-REFS NOT = ZEROS
 22920           MOVE PB-C-INT-ON-REFS
 22921                                 TO CNHINTO
 22922           MOVE AL-SANOF         TO CNHINTA
 22923        END-IF
 22924     END-IF
 22925     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22926     MOVE PB-CERT-SFX                TO CSUFIXO.
 22927     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22928     MOVE SPACE                      TO DC-OPTION-CODE.
 22929     PERFORM 9700-DATE-LINK.
 22930     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22931
 22932     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 422
* EL6311.cbl
 22933        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22934        MOVE SPACE                   TO DC-OPTION-CODE
 22935        PERFORM 9700-DATE-LINK
 22936        IF NO-CONVERSION-ERROR
 22937           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22938
 22939     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22940        NEXT SENTENCE
 22941     ELSE
 22942        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22943
 22944     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22945        NEXT SENTENCE
 22946     ELSE
 22947        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22948
 22949     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22950        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22951        MOVE SPACE                   TO DC-OPTION-CODE
 22952        PERFORM 9700-DATE-LINK
 22953        IF NO-CONVERSION-ERROR
 22954           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22955
 22956     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22957         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22958
 22959     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22960         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22961
 22962     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22963        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22964        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22965                 GIVING CDRFND1O.
 22966
 22967     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22968        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22969        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22970                 GIVING CDRFND2O.
 22971
 22972     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22973       IF PB-RECORD-ON-HOLD
 22974          MOVE 'ON HOLD'             TO CBILIT1O.
 22975
 22976     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22977       IF PB-RECORD-RETURNED
 22978          MOVE 'RETURNED'            TO CBILIT1O.
 22979
 22980     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22981        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22982             MOVE 'OVERRIDE'         TO CBILIT1O.
 22983
 22984     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22985       IF PB-RECORD-ON-HOLD
 22986          MOVE 'ON HOLD'             TO CBILIT2O.
 22987
 22988     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22989       IF PB-RECORD-RETURNED
 22990          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 423
* EL6311.cbl
 22991
 22992     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22993        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22994             MOVE 'OVERRIDE'         TO CBILIT2O.
 22995
 22996     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22997     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22998     IF PB-C-POST-CARD-IND = 'Y'
 22999        MOVE 'Y'                     TO CPCYNO
 23000     ELSE
 23001        MOVE 'N'                     TO CPCYNO
 23002     END-IF
 23003     MOVE PB-FORCE-CODE              TO CFORCEO.
 23004     MOVE PB-RECORD-BILL             TO CBILCDO.
 23005     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 23006     MOVE SPACES                     TO CINITSO.
 23007     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 23008         MOVE PB-CI-FIRST-NAME       TO CINITSO
 23009     ELSE
 23010         MOVE PB-CI-INITIALS         TO CINITSO
 23011     END-IF.
 23012
 23013     IF PB-CI-CANCEL-FEE NUMERIC
 23014        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 23015        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 23016     ELSE
 23017        MOVE ZEROES                  TO W-CANCEL-FEE.
 23018
 23019     MOVE W-CANCEL-FEE               TO CCANFEEO.
 23020
 23021     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 23022        ADD PB-CI-LF-PREMIUM-AMT
 23023             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 23024
 23025     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 23026        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 23027
 23028     MOVE PB-CI-LF-TERM              TO CTERM1O.
 23029     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 23030     MOVE PB-CI-AH-TERM              TO CTERM2O.
 23031     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 23032
 23033     IF PB-C-LIVES NUMERIC
 23034        MOVE PB-C-LIVES              TO CLIVESO.
 23035
 23036     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 23037        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 23038
 23039     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 23040        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 23041        MOVE SPACE                   TO DC-OPTION-CODE
 23042        PERFORM 9700-DATE-LINK
 23043        IF NO-CONVERSION-ERROR
 23044           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 23045
 23046     IF  PB-C-REFUND-CREATED
 23047         MOVE 'YES'                  TO CRFNDSWO
 23048     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 424
* EL6311.cbl
 23049         IF PB-C-REFUND-REQUESTED
 23050            MOVE 'REQ'               TO CRFNDSWO
 23051         ELSE
 23052            MOVE 'NO'                TO CRFNDSWO.
 23053
 23054     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 23055     MOVE SPACE                      TO DC-OPTION-CODE.
 23056     PERFORM 9700-DATE-LINK.
 23057     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 23058     MOVE PB-INPUT-BY                TO CENTBYO.
 23059
 23060     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23061        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 23062        MOVE SPACE                   TO DC-OPTION-CODE
 23063        PERFORM 9700-DATE-LINK
 23064        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 23065        MOVE 'INACTIVE'              TO CMOENDTO
 23066     ELSE
 23067        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 23068        MOVE SPACE                   TO DC-OPTION-CODE
 23069        PERFORM 9700-DATE-LINK
 23070        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 23071        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 23072        MOVE SPACE                   TO DC-OPTION-CODE
 23073        PERFORM 9700-DATE-LINK
 23074        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 23075
 23076     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 23077
 23078     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 23079     MOVE WS-HR-MINS                 TO CMANTATO.
 23080
 23081     EVALUATE PB-LF-REFUND-TYPE
 23082        WHEN '1'
 23083           MOVE 'RULE78'            TO CLFREFNO
 23084        WHEN '2'
 23085           MOVE 'PRORAT'            TO CLFREFNO
 23086        WHEN '3'
 23087           MOVE 'CALIF'             TO CLFREFNO
 23088        WHEN '4'
 23089           MOVE 'IRREG'             TO CLFREFNO
 23090        WHEN '5'
 23091           MOVE 'NETPAY'            TO CLFREFNO
 23092        WHEN '6'
 23093           MOVE 'ATCP'              TO CLFREFNO
 23094        WHEN '7'
 23095           MOVE 'UTAH'              TO CLFREFNO
 23096        WHEN '8'
 23097           MOVE 'MEAN'              TO CLFREFNO
 23098        WHEN '9'
 23099           MOVE 'SUM '              TO CLFREFNO
 23100        WHEN 'B'
 23101           MOVE 'BALN'              TO CLFREFNO
 23102     END-EVALUATE.
 23103
 23104     EVALUATE TRUE
 23105        WHEN PB-AH-REFUND-TYPE =  '1'
 23106           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 425
* EL6311.cbl
 23107        WHEN PB-AH-REFUND-TYPE =  '2'
 23108           MOVE 'PRORAT'            TO CAHREFNO
 23109        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 23110           MOVE 'CALIF'             TO CAHREFNO
 23111        WHEN PB-AH-REFUND-TYPE =  '4'
 23112           MOVE 'IRREG'             TO CAHREFNO
 23113        WHEN PB-AH-REFUND-TYPE =  '5'
 23114           MOVE 'NETPAY'            TO CAHREFNO
 23115        WHEN PB-AH-REFUND-TYPE =  '6'
 23116           MOVE 'ATCP'              TO CAHREFNO
 23117        WHEN PB-AH-REFUND-TYPE =  '7'
 23118           MOVE 'UTAH'              TO CAHREFNO
 23119        WHEN PB-AH-REFUND-TYPE =  '8'
 23120           MOVE 'MEAN'              TO CAHREFNO
 23121        WHEN PB-AH-REFUND-TYPE =  '9'
 23122           MOVE 'SUM '              TO CAHREFNO
 23123        WHEN PB-AH-REFUND-TYPE =  'B'
 23124           MOVE 'BALN'              TO CAHREFNO
 23125     END-EVALUATE.
 23126
 23127     MOVE PB-REIN-CD                 TO CREINCDO.
 23128
 23129     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 23130        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 23131        MOVE SPACE                   TO DC-OPTION-CODE
 23132        PERFORM 9700-DATE-LINK
 23133        IF NO-CONVERSION-ERROR
 23134           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 23135
 23136     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 23137        MOVE 999999                  TO WS-EXP-DT-EDIT
 23138        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 23139        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 23140     ELSE
 23141        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 23142           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 23143           MOVE SPACE                   TO DC-OPTION-CODE
 23144           PERFORM 9700-DATE-LINK
 23145           IF NO-CONVERSION-ERROR
 23146              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 23147
 23148     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 23149        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 23150           MOVE AL-SANOF                TO CORIGHDA
 23151           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 23152           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 23153
 23154     MOVE PB-CSR-ID              TO CCSRO.
 23155
 23156     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 23157     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 23158     MOVE 'N'                    TO ACTSPCO
 23159     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACNT-KEY
 23160     MOVE '2'                    TO ERACNT-REC-TYPE
 23161     MOVE +3                     TO ERACNT-SEQ-NO
 23162
 23163
 23164* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 426
* EL6311.cbl
 23165*         DATASET   ('ERACNT')
 23166*         INTO      (NOTE-FILE)
 23167*         RIDFLD    (ERACNT-KEY)
 23168*         RESP      (WS-RESPONSE)
 23169*    END-EXEC
 23170     MOVE LENGTH OF
 23171      NOTE-FILE
 23172       TO DFHEIV11
 23173     MOVE 'ERACNT' TO DFHEIV1
 23174*    MOVE '&"IL       E          (  N#00019392' TO DFHEIV0
 23175     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23176     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23177     MOVE X'204E233030303139333932' TO DFHEIV0(25:11)
 23178     CALL 'kxdfhei1' USING DFHEIV0,
 23179           DFHEIV1,
 23180           NOTE-FILE,
 23181           DFHEIV11,
 23182           ERACNT-KEY,
 23183           DFHEIV99,
 23184           DFHEIV99,
 23185           DFHEIV99
 23186     MOVE EIBRESP  TO WS-RESPONSE
 23187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23188
 23189     IF RESP-NORMAL
 23190        IF NT-account-special = 'Y'
 23191           MOVE 'Y'              TO actspcO
 23192           MOVE ER-1762          TO EMI-ERROR
 23193           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23194        END-IF
 23195     END-IF
 23196     MOVE 'C'                    TO CMAINTI.
 23197     MOVE AL-UANON               TO CMAINTA.
 23198
 23199     IF PI-6316-FINALIZED = 'Y'  AND
 23200        PB-UNFORCED-ERRORS
 23201          MOVE -1                TO CFORCEL
 23202          MOVE  1                TO SET-CURSOR-SW
 23203     END-IF
 23204
 23205     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 23206        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 23207
 23208     IF NO-CURSOR-SET
 23209        MOVE -1                  TO CMAINTL.
 23210
 23211     GO TO 8100-SEND-INITIAL-MAP.
 23212
 23213
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 427
* EL6311.cbl
 23215***************************************************************
 23216*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 23217*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 23218***************************************************************
 23219
 23220 7200-DISPLAY-BATCHES.
 23221     MOVE EL631D                 TO PI-MAP-NAME.
 23222     MOVE LOW-VALUES             TO EL631DI.
 23223
 23224     MOVE 'Y'                    TO WS-DISPLAY-SW.
 23225
 23226
 23227* EXEC CICS HANDLE CONDITION
 23228*         NOTFND   (3690-NOT-FOUND)
 23229*    END-EXEC.
 23230*    MOVE '"$I                   ! Y #00019436' TO DFHEIV0
 23231     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23232     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23233     MOVE X'5920233030303139343336' TO DFHEIV0(25:11)
 23234     CALL 'kxdfhei1' USING DFHEIV0
 23235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23236
 23237
 23238     IF PI-DISPLAY-SCREEN
 23239        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 23240     ELSE
 23241        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 23242
 23243     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 23244     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 23245
 23246
 23247* EXEC CICS READ
 23248*         DATASET   (FILE-ID-ERPNDB)
 23249*         RIDFLD    (ERPNDB-KEY)
 23250*         SET       (ADDRESS OF PENDING-BUSINESS)
 23251*    END-EXEC.
 23252*    MOVE '&"S        E          (   #00019448' TO DFHEIV0
 23253     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23254     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23255     MOVE X'2020233030303139343438' TO DFHEIV0(25:11)
 23256     CALL 'kxdfhei1' USING DFHEIV0,
 23257           FILE-ID-ERPNDB,
 23258           DFHEIV20,
 23259           DFHEIV99,
 23260           ERPNDB-KEY,
 23261           DFHEIV99,
 23262           DFHEIV99,
 23263           DFHEIV99
 23264     SET ADDRESS OF PENDING-BUSINESS TO
 23265         DFHEIV20
 23266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23267
 23268
 23269     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 23270     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 23271     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 23272     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 428
* EL6311.cbl
 23273     MOVE PB-SV-STATE            TO PI-SV-STATE.
 23274
 23275     MOVE EL631D                 TO PI-MAP-NAME.
 23276     MOVE LOW-VALUES             TO EL631DI.
 23277     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 23278
 23279*    IF PI-AR-PROCESSING
 23280*       MOVE PB-REFERENCE        TO DREFO.
 23281
 23282     MOVE PB-CSR-ID              TO DCSRO.
 23283
 23284     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23285        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 23286        MOVE SPACE               TO DC-OPTION-CODE
 23287        PERFORM 9700-DATE-LINK
 23288        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 23289        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 23290        MOVE 'INACTIVE'          TO DLDATEO
 23291     ELSE
 23292        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 23293        MOVE SPACE               TO DC-OPTION-CODE
 23294        PERFORM 9700-DATE-LINK
 23295        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 23296
 23297     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 23298     MOVE SPACE                  TO DC-OPTION-CODE.
 23299     PERFORM 9700-DATE-LINK.
 23300     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 23301
 23302     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 23303        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 23304     ELSE
 23305        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 23306        MOVE SPACE               TO DC-OPTION-CODE
 23307        PERFORM 9700-DATE-LINK
 23308        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 23309
 23310     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 23311     MOVE SPACE                  TO DC-OPTION-CODE.
 23312     PERFORM 9700-DATE-LINK.
 23313     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 23314
 23315     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 23316     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 23317
 23318     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 23319        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 23320                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 23321
 23322     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 23323     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 23324     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 23325
 23326     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 23327        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 23328                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 23329
 23330     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 429
* EL6311.cbl
 23331     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 23332     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 23333
 23334     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 23335        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 23336                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 23337
 23338     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 23339     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 23340
 23341     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 23342        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 23343                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 23344
 23345     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23346     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23347     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23348
 23349     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23350        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23351                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23352
 23353     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23354     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23355     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23356
 23357     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23358        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23359                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23360
 23361     MOVE -1                     TO DPFENTRL.
 23362     GO TO 8100-SEND-INITIAL-MAP.
 23363
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 430
* EL6311.cbl
 23365
 23366***************************************************************
 23367*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23368*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23369*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23370*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23371*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23372*     ARE THEN SET ACCORDINGLY.                               *
 23373*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23374*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23375*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23376***************************************************************
 23377
 23378******************************************************************
 23379*                                                                *
 23380*            E R R O R   A N A L Y S I S                         *
 23381*                                                                *
 23382******************************************************************
 23383
 23384******************************************************************
 23385*                                                                *
 23386*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23387*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23388*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23389*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23390*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23391*                                                                *
 23392*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23393*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23394*                                                                *
 23395******************************************************************
 23396
 23397 7300-FORMAT-ERRORS.
 23398     MOVE ' '                    TO PI-ERRORS-SW
 23399     IF PB-COMMON-ERRORS = LOW-VALUES
 23400        IF PB-FATAL-ERRORS
 23401           MOVE ER-2695          TO EMI-ERROR
 23402           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23403           GO TO 7399-EXIT.
 23404
 23405     MOVE +0                     TO WS-SUB4
 23406     move +0                     to pi-6311-fatal-ctr
 23407     .
 23408 7310-ERROR-LOOP.
 23409
 23410     ADD +1                      TO WS-SUB4.
 23411
 23412     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23413        GO TO 7350-SET-ERROR-FLAGS.
 23414
 23415     IF PI-COMPANY-ID = 'UCL'
 23416         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23417             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23418             MOVE ' '                   TO DC-OPTION-CODE
 23419             PERFORM 9700-DATE-LINK
 23420             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23421
 23422     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 431
* EL6311.cbl
 23423     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23424     if (emi-fatal)
 23425        and (emi-error not = 1753 and 1754 and 1757 and
 23426                             1758 and 1759 and 1760)
 23427        add +1                   to pi-6311-fatal-ctr
 23428     end-if
 23429     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23430
 23431     GO TO 7310-ERROR-LOOP.
 23432
 23433
 23434 7350-SET-ERROR-FLAGS.
 23435
 23436     IF EMI-FATAL-CTR NOT = ZEROS
 23437        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23438        MOVE 'X'                 TO PB-FATAL-FLAG
 23439                                    PI-ERRORS-SW
 23440        GO TO 7355-SET-ERROR-FLAGS.
 23441
 23442     move ' ' to pi-unforced-sw
 23443     IF EMI-FORCABLE-CTR NOT = ZEROS
 23444        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23445        IF PB-ISSUE
 23446           IF PB-ISSUE-FORCE
 23447              MOVE 'F'           TO PB-FORCE-ER-CD
 23448              MOVE ER-2600       TO EMI-ERROR
 23449              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23450             ELSE
 23451              MOVE 'X'           TO PB-FORCE-ER-CD
 23452*                                   PI-ERRORS-SW
 23453          ELSE
 23454           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23455              MOVE 'F'           TO PB-FORCE-ER-CD
 23456                                    pi-unforced-sw
 23457              MOVE ER-2600       TO EMI-ERROR
 23458              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23459             ELSE
 23460              MOVE 'X'           TO PB-FORCE-ER-CD
 23461                                    pi-unforced-sw.
 23462*                                   PI-ERRORS-SW.
 23463
 23464     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23465     IF PB-ISSUE
 23466         MOVE 'I'                TO ENDT-RECORD-TYPE
 23467     ELSE
 23468         MOVE 'C'                TO ENDT-RECORD-TYPE
 23469     END-IF
 23470     MOVE +0                     TO ENDT-SEQ-NO
 23471
 23472
 23473* EXEC CICS READ
 23474*        DATASET   (FILE-ID-ERENDT)
 23475*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23476*        RIDFLD    (ERENDT-KEY)
 23477*        RESP      (WS-RESPONSE)
 23478*        GTEQ
 23479*    END-EXEC
 23480*    MOVE '&"S        G          (  N#00019657' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 432
* EL6311.cbl
 23481     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23482     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23483     MOVE X'204E233030303139363537' TO DFHEIV0(25:11)
 23484     CALL 'kxdfhei1' USING DFHEIV0,
 23485           FILE-ID-ERENDT,
 23486           DFHEIV20,
 23487           DFHEIV99,
 23488           ERENDT-KEY,
 23489           DFHEIV99,
 23490           DFHEIV99,
 23491           DFHEIV99
 23492     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23493         DFHEIV20
 23494     MOVE EIBRESP  TO WS-RESPONSE
 23495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23496
 23497     IF RESP-NORMAL
 23498        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23499        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23500            MOVE ER-0280          TO EMI-ERROR
 23501            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23502            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23503            EVALUATE TRUE
 23504              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23505                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23506              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23507                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23508              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23509                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23510            END-EVALUATE
 23511        END-IF
 23512     END-IF
 23513
 23514
 23515
 23516     IF FIRST-ENTRY OR
 23517        EIBAID = DFHPF1 OR DFHPF2
 23518        MOVE '0'                TO PI-EDIT-SW
 23519        GO TO 7399-EXIT.
 23520
 23521 7355-SET-ERROR-FLAGS.
 23522
 23523     IF EMI-WARNING-CTR NOT = ZEROS
 23524        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23525        MOVE 'W'                 TO PB-WARN-ER-CD.
 23526
 23527     IF PB-UNFORCED-ERRORS OR
 23528        PB-FATAL-ERRORS    OR
 23529        PB-RECORD-ON-HOLD  OR
 23530        PB-RECORD-RETURNED OR
 23531        PB-CANCELLATION
 23532          NEXT SENTENCE
 23533        ELSE
 23534          GO TO 7399-EXIT.
 23535
 23536
 23537* EXEC CICS  HANDLE CONDITION
 23538*           NOTFND   (7399-EXIT)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 433
* EL6311.cbl
 23539*    END-EXEC.
 23540*    MOVE '"$I                   ! Z #00019704' TO DFHEIV0
 23541     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23542     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23543     MOVE X'5A20233030303139373034' TO DFHEIV0(25:11)
 23544     CALL 'kxdfhei1' USING DFHEIV0
 23545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23546
 23547
 23548     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23549     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23550     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23551     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23552
 23553
 23554* EXEC CICS READ
 23555*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23556*        DATASET (FILE-ID-ELCERT)
 23557*        RIDFLD  (ELCERT-KEY)
 23558*        UPDATE
 23559*    END-EXEC.
 23560*    MOVE '&"S        EU         (   #00019713' TO DFHEIV0
 23561     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23562     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23563     MOVE X'2020233030303139373133' TO DFHEIV0(25:11)
 23564     CALL 'kxdfhei1' USING DFHEIV0,
 23565           FILE-ID-ELCERT,
 23566           DFHEIV20,
 23567           DFHEIV99,
 23568           ELCERT-KEY,
 23569           DFHEIV99,
 23570           DFHEIV99,
 23571           DFHEIV99
 23572     SET ADDRESS OF CERTIFICATE-MASTER TO
 23573         DFHEIV20
 23574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23575
 23576
 23577
 23578     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23579     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23580
 23581     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23582        GO TO 7360-REWRITE-CERT-MASTER.
 23583
 23584     IF PB-ISSUE
 23585        IF PB-RECORD-RETURNED
 23586            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23587            GO TO 7360-REWRITE-CERT-MASTER
 23588        ELSE
 23589            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23590            GO TO 7360-REWRITE-CERT-MASTER.
 23591
 23592     IF PB-RECORD-RETURNED
 23593         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 23594         GO TO 7360-REWRITE-CERT-MASTER.
 23595
 23596     IF (PB-C-LF-CANCEL-VOIDED)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 434
* EL6311.cbl
 23597        or (pb-c-ah-cancel-voided)
 23598        IF (PB-UNFORCED-ERRORS OR
 23599            PB-FATAL-ERRORS    OR
 23600            PB-RECORD-ON-HOLD)
 23601            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23602            GO TO 7360-REWRITE-CERT-MASTER
 23603        ELSE
 23604            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23605            GO TO 7360-REWRITE-CERT-MASTER.
 23606
 23607     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23608                            OR PB-RECORD-ON-HOLD)
 23609        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23610     ELSE
 23611        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23612
 23613 7360-REWRITE-CERT-MASTER.
 23614
 23615     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23616        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23617
 23618* EXEC CICS UNLOCK
 23619*            DATASET    (FILE-ID-ELCERT)
 23620*       END-EXEC
 23621*    MOVE '&*                    #   #00019760' TO DFHEIV0
 23622     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23623     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23624     MOVE X'2020233030303139373630' TO DFHEIV0(25:11)
 23625     CALL 'kxdfhei1' USING DFHEIV0,
 23626           FILE-ID-ELCERT,
 23627           DFHEIV99
 23628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23629        GO TO 7399-EXIT.
 23630
 23631
 23632* EXEC CICS REWRITE
 23633*         DATASET    (FILE-ID-ELCERT)
 23634*         FROM       (CERTIFICATE-MASTER)
 23635*    END-EXEC.
 23636     MOVE LENGTH OF
 23637      CERTIFICATE-MASTER
 23638       TO DFHEIV11
 23639*    MOVE '&& L                  %   #00019765' TO DFHEIV0
 23640     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23641     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23642     MOVE X'2020233030303139373635' TO DFHEIV0(25:11)
 23643     CALL 'kxdfhei1' USING DFHEIV0,
 23644           FILE-ID-ELCERT,
 23645           CERTIFICATE-MASTER,
 23646           DFHEIV11,
 23647           DFHEIV99
 23648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23649
 23650
 23651 7399-EXIT.
 23652      EXIT.
 23653
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 435
* EL6311.cbl
 23655
 23656*************************************************************
 23657*                                                           *
 23658*              S E T   A T T R I B U T E S                  *
 23659*                                                           *
 23660*************************************************************
 23661
 23662 7400-SET-ATTRIBUTES.
 23663
 23664     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23665        GO TO 7499-EXIT.
 23666
 23667**2601**
 23668
 23669     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23670        IF PB-ISSUE
 23671           MOVE AL-UABON         TO BEFFDTA
 23672           GO TO 7499-EXIT
 23673         ELSE
 23674           MOVE AL-UABON         TO CEFFDTA
 23675           GO TO 7499-EXIT.
 23676
 23677**2604**
 23678
 23679     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23680        IF PB-ISSUE
 23681           MOVE AL-UABON         TO BTYPE1A
 23682           MOVE -1               TO BTYPE1L
 23683           MOVE  1               TO SET-CURSOR-SW
 23684           GO TO 7499-EXIT.
 23685
 23686**2605**
 23687
 23688     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23689        IF PB-ISSUE
 23690           MOVE AL-UABON         TO BTYPE2A
 23691           MOVE -1               TO BTYPE2L
 23692           MOVE  1               TO SET-CURSOR-SW
 23693           GO TO 7499-EXIT.
 23694
 23695**2606**
 23696
 23697     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23698        IF PB-ISSUE
 23699           MOVE AL-UABON         TO BSIGA
 23700           MOVE -1               TO BSIGL
 23701           MOVE  1               TO SET-CURSOR-SW
 23702           GO TO 7499-EXIT.
 23703
 23704**2607**
 23705
 23706     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23707        IF PB-ISSUE
 23708           MOVE AL-UABON         TO BSIGA
 23709           MOVE -1               TO BSIGL
 23710           MOVE  1               TO SET-CURSOR-SW
 23711           GO TO 7499-EXIT.
 23712
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 436
* EL6311.cbl
 23713**2615**
 23714
 23715     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23716        IF PB-ISSUE
 23717           MOVE AL-UABOF         TO BREINA
 23718           MOVE -1               TO BREINL
 23719           GO TO 7499-EXIT.
 23720
 23721**2622**
 23722
 23723     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23724        IF PB-ISSUE
 23725           MOVE AL-UABON         TO BEFFDTA
 23726           GO TO 7499-EXIT
 23727        ELSE
 23728           MOVE AL-UABON         TO CEFFDTA
 23729           GO TO 7499-EXIT.
 23730
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 437
* EL6311.cbl
 23732
 23733*************************************************************
 23734*                                                           *
 23735*              I S S U E   E R R O R S                      *
 23736*                                                           *
 23737*************************************************************
 23738
 23739 7420-ISSUE-ERRORS.
 23740
 23741**2626**
 23742
 23743     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23744        MOVE AL-UABON            TO BCERTNOA
 23745        GO TO 7499-EXIT.
 23746
 23747**2627**
 23748
 23749     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23750        MOVE AL-UNBON            TO BAGEA
 23751        MOVE -1                  TO BAGEL
 23752        MOVE  1                  TO SET-CURSOR-SW
 23753        GO TO 7499-EXIT.
 23754
 23755**2628**
 23756
 23757     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23758        MOVE AL-UNBON            TO BAGEA
 23759        MOVE -1                  TO BAGEL
 23760        MOVE  1                  TO SET-CURSOR-SW
 23761        GO TO 7499-EXIT.
 23762
 23763**2629**
 23764
 23765     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23766        MOVE AL-UABON            TO BSEXA
 23767        MOVE -1                  TO BSEXL
 23768        MOVE  1                  TO SET-CURSOR-SW
 23769        GO TO 7499-EXIT.
 23770
 23771**2630**
 23772
 23773     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23774        MOVE -1                  TO BTYPE1L
 23775        MOVE  1                  TO SET-CURSOR-SW
 23776        GO TO 7499-EXIT.
 23777
 23778**2631**
 23779
 23780     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23781        MOVE -1                  TO BTYPE1L
 23782        MOVE  1                  TO SET-CURSOR-SW
 23783        GO TO 7499-EXIT.
 23784
 23785**2632**
 23786
 23787     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23788        MOVE AL-UNBON            TO BBEN1A
 23789        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 438
* EL6311.cbl
 23790        MOVE  1                  TO SET-CURSOR-SW
 23791        GO TO 7499-EXIT.
 23792
 23793**2633**
 23794
 23795     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23796        MOVE AL-UNBON            TO BPREM1A
 23797        MOVE -1                  TO BPREM1L
 23798        MOVE  1                  TO SET-CURSOR-SW
 23799        GO TO 7499-EXIT.
 23800
 23801**2634**
 23802
 23803     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23804        MOVE -1                  TO BTYPE2L
 23805        MOVE  1                  TO SET-CURSOR-SW
 23806        GO TO 7499-EXIT.
 23807
 23808**2635**
 23809
 23810     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23811        MOVE AL-UNBON            TO BBEN2A
 23812        MOVE -1                  TO BBEN2L
 23813        MOVE  1                  TO SET-CURSOR-SW
 23814        GO TO 7499-EXIT.
 23815
 23816**2636**
 23817
 23818     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23819        MOVE AL-UNBON            TO BPREM2A
 23820        MOVE -1                  TO BPREM2L
 23821        MOVE  1                  TO SET-CURSOR-SW
 23822        GO TO 7499-EXIT.
 23823
 23824**2639**
 23825
 23826     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23827        MOVE AL-UNBON            TO BBEN1A
 23828        MOVE -1                  TO BBEN1L
 23829        MOVE  1                  TO SET-CURSOR-SW
 23830        GO TO 7499-EXIT.
 23831
 23832**2640**
 23833
 23834     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23835        MOVE AL-UNBON            TO BBEN2A
 23836        MOVE -1                  TO BBEN2L
 23837        MOVE  1                  TO SET-CURSOR-SW
 23838        GO TO 7499-EXIT.
 23839
 23840**2647**
 23841
 23842     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23843        MOVE AL-UNBON            TO BTERM1A
 23844        MOVE -1                  TO BTERM1L
 23845        MOVE  1                  TO SET-CURSOR-SW
 23846        GO TO 7499-EXIT.
 23847
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 439
* EL6311.cbl
 23848**2648**
 23849
 23850     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23851        MOVE AL-UNBON            TO BLNTRMA
 23852        MOVE -1                  TO BLNTRML
 23853        MOVE  1                  TO SET-CURSOR-SW
 23854        GO TO 7499-EXIT.
 23855
 23856**2649**
 23857
 23858     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23859        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23860            MOVE AL-UNBON            TO BPREM1A
 23861            MOVE -1                  TO BPREM1L
 23862            MOVE  1                  TO SET-CURSOR-SW
 23863            GO TO 7499-EXIT
 23864     ELSE
 23865        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23866           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23867            MOVE AL-UNBON            TO BPREM2A
 23868            MOVE -1                  TO BPREM2L
 23869            MOVE  1                  TO SET-CURSOR-SW
 23870            GO TO 7499-EXIT.
 23871
 23872**2650**
 23873
 23874     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23875        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23876            MOVE AL-UNBON        TO BPREM1A
 23877            MOVE -1              TO BPREM1L
 23878            MOVE  1              TO SET-CURSOR-SW
 23879            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23880                MOVE AL-UNBON        TO BPREM2A
 23881                MOVE -1              TO BPREM2L
 23882                MOVE  1              TO SET-CURSOR-SW
 23883                GO TO 7499-EXIT
 23884            ELSE
 23885                GO TO 7499-EXIT
 23886        ELSE
 23887            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23888                MOVE AL-UNBON        TO BPREM2A
 23889                MOVE -1              TO BPREM2L
 23890                MOVE  1              TO SET-CURSOR-SW
 23891                GO TO 7499-EXIT
 23892            ELSE
 23893                GO TO 7499-EXIT.
 23894
 23895**2651**
 23896
 23897     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23898        MOVE AL-UABON            TO BSIGA
 23899        MOVE -1                  TO BSIGL
 23900        MOVE  1                  TO SET-CURSOR-SW
 23901        GO TO 7499-EXIT.
 23902
 23903**2653**
 23904
 23905     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 440
* EL6311.cbl
 23906        MOVE AL-UABON            TO BFREQA
 23907        MOVE -1                  TO BFREQL
 23908        MOVE  1                  TO SET-CURSOR-SW
 23909        GO TO 7499-EXIT.
 23910
 23911**2654**
 23912
 23913     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23914        MOVE AL-UABON            TO BFREQA
 23915        MOVE -1                  TO BFREQL
 23916        MOVE  1                  TO SET-CURSOR-SW
 23917        GO TO 7499-EXIT.
 23918
 23919**2655**
 23920
 23921     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23922        MOVE AL-UABON            TO BFREQA
 23923        MOVE -1                  TO BFREQL
 23924        MOVE  1                  TO SET-CURSOR-SW
 23925        GO TO 7499-EXIT.
 23926
 23927**2656**
 23928
 23929     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23930        MOVE AL-UNBON            TO BAPRA
 23931        MOVE -1                  TO BAPRL
 23932        MOVE  1                  TO SET-CURSOR-SW
 23933        GO TO 7499-EXIT.
 23934
 23935**2657**
 23936
 23937     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23938        MOVE AL-UNBON            TO BAPRA
 23939        MOVE -1                  TO BAPRL
 23940        MOVE  1                  TO SET-CURSOR-SW
 23941        GO TO 7499-EXIT.
 23942
 23943**2658**
 23944
 23945     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23946        MOVE AL-UNBON            TO BTERM2A
 23947        MOVE -1                  TO BTERM2L
 23948        MOVE  1                  TO SET-CURSOR-SW
 23949        GO TO 7499-EXIT.
 23950
 23951**2660**
 23952
 23953     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23954        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23955        MOVE -1                  TO BLSTNML
 23956        MOVE  1                  TO SET-CURSOR-SW
 23957        GO TO 7499-EXIT.
 23958
 23959
 23960**2662**
 23961
 23962     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23963        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 441
* EL6311.cbl
 23964        MOVE -1                  TO BAGEL
 23965        MOVE  1                  TO SET-CURSOR-SW
 23966        GO TO 7499-EXIT.
 23967
 23968**2663**
 23969
 23970     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23971        MOVE AL-UNBON            TO BAGEA
 23972        MOVE -1                  TO BAGEL
 23973        MOVE  1                  TO SET-CURSOR-SW
 23974        GO TO 7499-EXIT.
 23975
 23976**2664**
 23977
 23978     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23979        MOVE AL-UABON            TO BREINA
 23980        MOVE -1                  TO BREINL
 23981        MOVE  1                  TO SET-CURSOR-SW
 23982        GO TO 7499-EXIT.
 23983
 23984**2667**
 23985
 23986     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23987        MOVE AL-UNBON            TO BBEN2A
 23988        MOVE -1                  TO BBEN2L
 23989        MOVE  1                  TO SET-CURSOR-SW
 23990        GO TO 7499-EXIT.
 23991
 23992**2668**
 23993
 23994     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23995        MOVE AL-UABON            TO BEFFDTA
 23996        GO TO 7499-EXIT.
 23997
 23998**2669**
 23999
 24000     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 24001       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 24002       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 24003        MOVE AL-UNBON            TO BAGEA
 24004        MOVE -1                  TO BAGEL
 24005        MOVE  1                  TO SET-CURSOR-SW
 24006        GO TO 7499-EXIT.
 24007
 24008**2670**
 24009
 24010     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 24011        MOVE AL-UABON            TO BFORCEA
 24012        MOVE -1                  TO BFORCEL
 24013        MOVE  1                  TO SET-CURSOR-SW
 24014        GO TO 7499-EXIT.
 24015
 24016**2671**
 24017
 24018     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 24019        MOVE AL-UABON            TO BEFFDTA
 24020        GO TO 7499-EXIT.
 24021
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 442
* EL6311.cbl
 24022**2672**
 24023
 24024     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 24025        MOVE AL-UABON            TO BEFFDTA
 24026        GO TO 7499-EXIT.
 24027
 24028**2673**
 24029
 24030     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 24031        MOVE AL-UABON            TO BEFFDTA
 24032        GO TO 7499-EXIT.
 24033
 24034**2674**
 24035
 24036     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 24037        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 24038        MOVE -1                  TO BTYPE1L
 24039        MOVE  1                  TO SET-CURSOR-SW
 24040        GO TO 7499-EXIT.
 24041
 24042**2677**
 24043
 24044     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 24045        MOVE AL-UNBON            TO BTERM1A
 24046        MOVE -1                  TO BTERM1L
 24047        MOVE  1                  TO SET-CURSOR-SW
 24048        GO TO 7499-EXIT.
 24049
 24050**2678**
 24051
 24052     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 24053        MOVE AL-UNBON            TO BTERM2A
 24054        MOVE -1                  TO BTERM2L
 24055        MOVE  1                  TO SET-CURSOR-SW
 24056        GO TO 7499-EXIT.
 24057
 24058**2679**
 24059
 24060     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 24061        MOVE AL-UABON            TO BTYPE1A
 24062        MOVE -1                  TO BTYPE1L
 24063        MOVE  1                  TO SET-CURSOR-SW
 24064        GO TO 7499-EXIT.
 24065
 24066**2680**
 24067
 24068     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 24069        MOVE AL-UABOF            TO B1STPMTA
 24070        MOVE -1                  TO B1STPMTL
 24071        MOVE  1                  TO SET-CURSOR-SW
 24072        GO TO 7499-EXIT.
 24073
 24074**2681**
 24075
 24076     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 24077        MOVE AL-UABON            TO BDAYSA
 24078        MOVE -1                  TO BDAYSL
 24079        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 443
* EL6311.cbl
 24080        GO TO 7499-EXIT.
 24081
 24082**2682**
 24083
 24084     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 24085        MOVE AL-UABON            TO BTERM1A
 24086        MOVE -1                  TO BTERM1L
 24087        MOVE  1                  TO SET-CURSOR-SW
 24088        GO TO 7499-EXIT.
 24089
 24090**2683**
 24091
 24092     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 24093        MOVE AL-UABON            TO BSKPCDA
 24094        MOVE -1                  TO BSKPCDL
 24095        MOVE  1                  TO SET-CURSOR-SW
 24096        GO TO 7499-EXIT.
 24097
 24098**2684**
 24099
 24100     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 24101        MOVE AL-UABON            TO BTYPE2A
 24102        MOVE -1                  TO BTYPE2L
 24103        MOVE  1                  TO SET-CURSOR-SW
 24104        GO TO 7499-EXIT.
 24105
 24106**2686**
 24107
 24108     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 24109        MOVE AL-UABON            TO BTYPE2A
 24110        MOVE -1                  TO BTYPE2L
 24111        MOVE  1                  TO SET-CURSOR-SW
 24112        GO TO 7499-EXIT.
 24113
 24114**2689**
 24115
 24116     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 24117        MOVE AL-UABON            TO BSIGA
 24118        MOVE -1                  TO BSIGL
 24119        MOVE  1                  TO SET-CURSOR-SW
 24120        GO TO 7499-EXIT.
 24121
 24122**2690**
 24123
 24124     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 24125        MOVE AL-UABOF            TO BLNOFCRA
 24126        MOVE -1                  TO BLNOFCRL
 24127        MOVE  1                  TO SET-CURSOR-SW
 24128        GO TO 7499-EXIT.
 24129
 24130**2693**
 24131
 24132     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 24133        MOVE AL-UABOF            TO BLNOFCRA
 24134        MOVE AL-UNBON            TO BBEN1A
 24135        MOVE -1                  TO BBEN1L
 24136        MOVE  1                  TO SET-CURSOR-SW
 24137        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 444
* EL6311.cbl
 24138
 24139**2720**
 24140
 24141     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 24142        MOVE AL-UNBON            TO BBEN1A
 24143        MOVE -1                  TO BBEN1L
 24144        MOVE  1                  TO SET-CURSOR-SW
 24145        GO TO 7499-EXIT.
 24146
 24147**2709**
 24148
 24149*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 24150*       MOVE AL-UNBON            TO BBEN1A
 24151*       MOVE -1                  TO BBEN1L
 24152*       MOVE  1                  TO SET-CURSOR-SW
 24153*       GO TO 7499-EXIT.
 24154
 24155*************************************************************
 24156*                                                           *
 24157*            C A N C E L   E R R O R S                      *
 24158*                                                           *
 24159*************************************************************
 24160
 24161**2726**
 24162
 24163     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 24164        MOVE AL-UABON            TO CCERTNOA
 24165        GO TO 7499-EXIT.
 24166
 24167**2728**
 24168
 24169     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 24170        MOVE AL-UABON            TO CCERTNOA
 24171        GO TO 7499-EXIT.
 24172
 24173**2729**
 24174
 24175     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 24176        MOVE AL-UABON            TO CCERTNOA
 24177        GO TO 7499-EXIT.
 24178
 24179**2730**
 24180
 24181     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 24182        MOVE AL-UABON            TO CCERTNOA
 24183        GO TO 7499-EXIT.
 24184
 24185**2731**
 24186
 24187     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 24188        MOVE AL-UABON            TO CCANDT1A
 24189        MOVE -1                  TO CCANDT1L
 24190        MOVE  1                  TO SET-CURSOR-SW
 24191        GO TO 7499-EXIT.
 24192
 24193**2732**
 24194
 24195     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 445
* EL6311.cbl
 24196        MOVE AL-UABON            TO CCANDT1A
 24197        MOVE -1                  TO CCANDT1L
 24198        MOVE  1                  TO SET-CURSOR-SW
 24199        GO TO 7499-EXIT.
 24200
 24201**2733**
 24202
 24203     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24204        MOVE AL-UABON            TO CCANDT1A
 24205        MOVE -1                  TO CCANDT1L
 24206        MOVE  1                  TO SET-CURSOR-SW
 24207        GO TO 7499-EXIT.
 24208
 24209**2734**
 24210
 24211     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24212        MOVE AL-UNBON            TO CREFND1A
 24213        MOVE -1                  TO CREFND1L
 24214        MOVE  1                  TO SET-CURSOR-SW
 24215        GO TO 7499-EXIT.
 24216
 24217**2735**
 24218
 24219     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24220        MOVE AL-UABON            TO CCANDT2A
 24221        MOVE -1                  TO CCANDT2L
 24222        MOVE  1                  TO SET-CURSOR-SW
 24223        GO TO 7499-EXIT.
 24224
 24225**2736**
 24226
 24227     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24228        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24229            MOVE AL-UNBON        TO CREFND1A
 24230            MOVE -1              TO CREFND1L
 24231            MOVE  1              TO SET-CURSOR-SW
 24232            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24233                MOVE AL-UNBON        TO CREFND2A
 24234                MOVE -1              TO CREFND2L
 24235                MOVE  1              TO SET-CURSOR-SW
 24236                GO TO 7499-EXIT
 24237            ELSE
 24238                GO TO 7499-EXIT
 24239        ELSE
 24240            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24241                MOVE AL-UNBON        TO CREFND2A
 24242                MOVE -1              TO CREFND2L
 24243                MOVE  1              TO SET-CURSOR-SW
 24244                GO TO 7499-EXIT
 24245            ELSE
 24246                GO TO 7499-EXIT.
 24247
 24248**2738**
 24249
 24250     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24251        MOVE -1                  TO CREFND2L
 24252        MOVE  1                  TO SET-CURSOR-SW
 24253        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 446
* EL6311.cbl
 24254
 24255**2739**
 24256
 24257     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24258        MOVE -1                  TO CREFND1L
 24259        MOVE  1                  TO SET-CURSOR-SW
 24260        GO TO 7499-EXIT.
 24261
 24262**2741**
 24263
 24264     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24265        MOVE -1                  TO CREFND1L
 24266        MOVE  1                  TO SET-CURSOR-SW
 24267        GO TO 7499-EXIT.
 24268
 24269**2743**
 24270
 24271     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 24272        MOVE AL-UNBON            TO CCANDT1A
 24273        MOVE -1                  TO CCANDT1L
 24274        MOVE  1                  TO SET-CURSOR-SW
 24275        GO TO 7499-EXIT.
 24276
 24277**2744**
 24278
 24279     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 24280        MOVE AL-UNBON            TO CCANDT2A
 24281        MOVE -1                  TO CCANDT2L
 24282        MOVE  1                  TO SET-CURSOR-SW
 24283        GO TO 7499-EXIT.
 24284
 24285**2747**
 24286
 24287     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 24288        MOVE AL-UABON            TO CLSTNMA
 24289        MOVE -1                  TO CLSTNML
 24290        MOVE  1                  TO SET-CURSOR-SW
 24291        GO TO 7499-EXIT.
 24292
 24293**2749**
 24294
 24295     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 24296        MOVE AL-UABON            TO CFORCEA
 24297        MOVE -1                  TO CFORCEL
 24298        MOVE  1                  TO SET-CURSOR-SW
 24299        GO TO 7499-EXIT.
 24300
 24301**2753**
 24302
 24303     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 24304        MOVE AL-UNBON            TO CCANDT1A
 24305        MOVE -1                  TO CCANDT1L
 24306        MOVE  1                  TO SET-CURSOR-SW
 24307        GO TO 7499-EXIT.
 24308
 24309**2755**
 24310
 24311     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 447
* EL6311.cbl
 24312        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24313            MOVE AL-UNBON        TO CREFND1A
 24314            MOVE -1              TO CREFND1L
 24315            MOVE  1              TO SET-CURSOR-SW
 24316            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24317                MOVE AL-UNBON        TO CREFND2A
 24318                MOVE -1              TO CREFND2L
 24319                MOVE  1              TO SET-CURSOR-SW
 24320                GO TO 7499-EXIT
 24321            ELSE
 24322                GO TO 7499-EXIT
 24323        ELSE
 24324            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24325                MOVE AL-UNBON        TO CREFND2A
 24326                MOVE -1              TO CREFND2L
 24327                MOVE  1              TO SET-CURSOR-SW
 24328            ELSE
 24329                GO TO 7499-EXIT.
 24330
 24331**2757**
 24332
 24333     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 24334        MOVE AL-UNBON            TO CLIVESA
 24335        MOVE -1                  TO CLIVESL
 24336        MOVE  1                  TO SET-CURSOR-SW
 24337        GO TO 7499-EXIT.
 24338
 24339**2771**
 24340
 24341     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 24342        MOVE AL-UABON            TO CCANDT2A
 24343        MOVE -1                  TO CCANDT2L
 24344        MOVE  1                  TO SET-CURSOR-SW
 24345        GO TO 7499-EXIT.
 24346
 24347**2774**
 24348
 24349     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 24350        MOVE AL-UABON            TO CCANDT1A
 24351        MOVE -1                  TO CCANDT1L
 24352        MOVE  1                  TO SET-CURSOR-SW
 24353        GO TO 7499-EXIT.
 24354
 24355**2775**
 24356
 24357     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24358        MOVE AL-UABON            TO CCANDT2A
 24359        MOVE -1                  TO CCANDT2L
 24360        MOVE  1                  TO SET-CURSOR-SW
 24361        GO TO 7499-EXIT.
 24362
 24363**2776**
 24364
 24365     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24366        MOVE AL-UABON            TO CCANDT1A
 24367        MOVE -1                  TO CCANDT1L
 24368        MOVE  1                  TO SET-CURSOR-SW
 24369        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 448
* EL6311.cbl
 24370
 24371
 24372**2777**
 24373
 24374     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24375        MOVE AL-UABON            TO CCANDT2A
 24376        MOVE -1                  TO CCANDT2L
 24377        MOVE  1                  TO SET-CURSOR-SW
 24378        GO TO 7499-EXIT.
 24379
 24380**2794**
 24381
 24382     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24383        MOVE AL-UABON            TO CFORCEA
 24384        MOVE -1                  TO CFORCEL
 24385        MOVE  1                  TO SET-CURSOR-SW
 24386        GO TO 7499-EXIT.
 24387
 24388**2799**
 24389
 24390     IF PI-COMPANY-ID = 'UCL'
 24391         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24392             MOVE AL-UNBON            TO BEFFDTA
 24393             MOVE -1                  TO BEFFDTL
 24394             MOVE  1                  TO SET-CURSOR-SW
 24395             GO TO 7499-EXIT.
 24396
 24397 7499-EXIT.
 24398      EXIT.
 24399
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 449
* EL6311.cbl
 24401
 24402 7500-READ-ERLOFC.
 24403     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24404                                     ERLOFC-KEY.
 24405
 24406     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24407
 24408     IF ST-ACCNT-CNTL
 24409         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24410
 24411     IF CARR-GROUP-ST-ACCNT-CNTL
 24412         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24413         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24414         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24415
 24416     IF CARR-ST-ACCNT-CNTL
 24417         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24418         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24419
 24420     IF CARR-ACCNT-CNTL
 24421         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24422
 24423     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24424
 24425     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24426
 24427
 24428* EXEC CICS HANDLE CONDITION
 24429*        NOTFND   (7550-OFFICER-NOTFND)
 24430*    END-EXEC.
 24431*    MOVE '"$I                   ! [ #00020546' TO DFHEIV0
 24432     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24433     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24434     MOVE X'5B20233030303230353436' TO DFHEIV0(25:11)
 24435     CALL 'kxdfhei1' USING DFHEIV0
 24436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24437
 24438
 24439
 24440* EXEC CICS READ
 24441*        DATASET   (FILE-ID-ERLOFC)
 24442*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24443*        RIDFLD    (ERLOFC-KEY)
 24444*        EQUAL
 24445*    END-EXEC.
 24446*    MOVE '&"S        E          (   #00020550' TO DFHEIV0
 24447     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24448     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24449     MOVE X'2020233030303230353530' TO DFHEIV0(25:11)
 24450     CALL 'kxdfhei1' USING DFHEIV0,
 24451           FILE-ID-ERLOFC,
 24452           DFHEIV20,
 24453           DFHEIV99,
 24454           ERLOFC-KEY,
 24455           DFHEIV99,
 24456           DFHEIV99,
 24457           DFHEIV99
 24458     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 450
* EL6311.cbl
 24459         DFHEIV20
 24460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24461
 24462
 24463     GO TO 7599-EXIT.
 24464
 24465 7550-OFFICER-NOTFND.
 24466     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24467
 24468 7599-EXIT.
 24469      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 451
* EL6311.cbl
 24471******************************************************************
 24472*                                                                *
 24473*            S  E N D    I N I T I A L   M A P                   *
 24474*                                                                *
 24475******************************************************************
 24476
 24477 8100-SEND-INITIAL-MAP.
 24478     MOVE EIBTIME                TO TIME-IN.
 24479
 24480     IF EIBAID = DFHPF11
 24481        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24482        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24483
 24484
 24485     IF PI-COMPANY-ID = CLIENT-GIC
 24486        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24487                                       BCPREM-ATTRB (2).
 24488
 24489     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24490                         CLIENT-PEM OR
 24491                         CLIENT-CSO)
 24492        AND PI-DISPLAY-ORIGINAL-BATCH
 24493          IF PI-MAP-NAME = EL631B
 24494             MOVE AL-SADOF               TO BPF5HDRA
 24495                                            BPF4HDRA
 24496          ELSE
 24497             IF PI-MAP-NAME = EL631C
 24498                MOVE AL-SADOF            TO CPF5HDRA
 24499                                            CPF4HDRA.
 24500
 24501     IF PI-MAP-NAME = EL631B
 24502        MOVE AL-SADOF               TO BPF5HDRA
 24503     ELSE
 24504        MOVE AL-SADOF               TO CPF5HDRA
 24505     END-IF
 24506
 24507*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24508     IF PI-MAP-NAME = EL631B
 24509          IF PI-COMPANY-ID NOT = 'DMD'
 24510             MOVE AL-SANOF            TO BBILLEDA
 24511             MOVE AL-SADOF            TO DMDBILA.
 24512*DMD CUSTOM CODING*************END
 24513
 24514     IF PI-PROCESSOR-ID = 'LGXX'
 24515        IF PI-MAP-NAME = EL631B
 24516           MOVE AL-SABOF                    TO BREFHDGA
 24517           MOVE AL-SANOF                    TO BREFA
 24518        ELSE
 24519           IF PI-MAP-NAME = EL631C
 24520              MOVE AL-SABOF                 TO CREFHDGA
 24521              MOVE AL-SANOF                 TO CREFA.
 24522
 24523     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 24524        continue
 24525     ELSE
 24526        IF PI-MAP-NAME = EL631C
 24527           MOVE AL-SADOF         TO CCANTXTA
 24528                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 452
* EL6311.cbl
 24529        end-if
 24530     end-if
 24531     IF PI-MAP-NAME = EL631D
 24532        IF PI-AR-PROCESSING
 24533           MOVE AL-SANOF            TO DREFHDGA
 24534        ELSE
 24535           MOVE AL-SADOF            TO DREFHDGA.
 24536
 24537     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 24538        AND (PI-MAP-NAME = EL631B)
 24539        MOVE AL-SADOF            TO BVINHA
 24540                                    BVINA
 24541     END-IF
 24542     IF PI-MAP-NAME = EL631B
 24543        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24544        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24545                                 TO BREGIONO
 24546        MOVE PI-PROCESSOR-ID     TO BUSERO
 24547        IF CSR-EDIT-SESSION
 24548           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24549                                 TO BHEADO
 24550           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24551        ELSE
 24552           MOVE AL-SADOF         TO BF15HDRA
 24553           MOVE '4=B-HDR      '  TO BPF4HDRO
 24554        END-IF
 24555        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24556        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24557        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24558        MOVE WS-CURRENT-DT          TO BDATEO
 24559        MOVE TIME-OUT               TO BTIMEO
 24560        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24561        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24562        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24563        IF   WS-DISPLAY-SCREEN
 24564             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24565             MOVE PB-SV-CARRIER     TO BCARRO
 24566             MOVE PB-SV-GROUPING    TO BGROUPO
 24567             MOVE PB-SV-STATE       TO BSTATEO
 24568             MOVE PB-ACCOUNT        TO BACCTO
 24569        ELSE
 24570             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24571     ELSE
 24572        IF PI-MAP-NAME = EL631C
 24573           MOVE '4=B-HDR      '     TO CPF4HDRO
 24574           IF CSR-EDIT-SESSION
 24575              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24576                                 TO CHEADO
 24577           ELSE
 24578              MOVE AL-SADOF      TO CF15HDRA
 24579           END-IF
 24580           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24581           MOVE WS-CURRENT-DT          TO CDATEO
 24582           MOVE TIME-OUT               TO CTIMEO
 24583           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24584           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24585           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24586           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 453
* EL6311.cbl
 24587           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24588           MOVE WS-C-HDG               TO CAHHDGO
 24589           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24590           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24591           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24592           IF   WS-DISPLAY-SCREEN
 24593                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24594                MOVE PB-SV-CARRIER     TO CCARRO
 24595                MOVE PB-SV-GROUPING    TO CGROUPO
 24596                MOVE PB-SV-STATE       TO CSTATEO
 24597                MOVE PB-ACCOUNT        TO CACCTO
 24598           ELSE
 24599                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24600        ELSE
 24601           MOVE WS-CURRENT-DT          TO DDATEO
 24602           MOVE TIME-OUT               TO DTIMEO
 24603           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24604                                          WS-REFUND-HDG-OVERRIDE
 24605           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24606           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24607           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24608                                          WS-REFUND-HDG-OVERRIDE
 24609           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24610           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24611           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24612           IF CSR-EDIT-SESSION
 24613              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24614                                 TO DHEADO
 24615           END-IF
 24616           IF  WS-DISPLAY-SCREEN
 24617               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24618               MOVE PB-CARRIER         TO DCARRO
 24619               MOVE PB-GROUPING        TO DGROUPO
 24620               MOVE PB-STATE           TO DSTATEO
 24621               MOVE PB-ACCOUNT         TO DACCTO
 24622               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24623           ELSE
 24624               MOVE EL631D             TO PI-MAP-NAME
 24625               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24626               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24627
 24628     MOVE SPACE                        TO WS-DISPLAY-SW.
 24629
 24630
 24631* EXEC CICS SEND
 24632*        MAP      (PI-MAP-NAME)
 24633*        MAPSET   (MAPSET-EL6311S)
 24634*        FROM     (EL631BI)
 24635*        ERASE
 24636*        CURSOR
 24637*    END-EXEC.
 24638     MOVE LENGTH OF
 24639      EL631BI
 24640       TO DFHEIV12
 24641     MOVE -1
 24642       TO DFHEIV11
 24643*    MOVE '8$     CT  E    H L F ,   #00020724' TO DFHEIV0
 24644     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 454
* EL6311.cbl
 24645     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24646     MOVE X'2020233030303230373234' TO DFHEIV0(25:11)
 24647     CALL 'kxdfhei1' USING DFHEIV0,
 24648           PI-MAP-NAME,
 24649           EL631BI,
 24650           DFHEIV12,
 24651           MAPSET-EL6311S,
 24652           DFHEIV99,
 24653           DFHEIV99,
 24654           DFHEIV99,
 24655           DFHEIV11,
 24656           DFHEIV99,
 24657           DFHEIV99,
 24658           DFHEIV99
 24659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24660
 24661
 24662     GO TO 9100-RETURN-TRAN.
 24663
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 455
* EL6311.cbl
 24665
 24666******************************************************************
 24667*                                                                *
 24668*              S E N D    D A T A O N L Y                        *
 24669*                                                                *
 24670******************************************************************
 24671
 24672 8200-SEND-DATAONLY.
 24673     MOVE EIBTIME                TO TIME-IN.
 24674
 24675     IF PI-COMPANY-ID = CLIENT-GIC
 24676        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24677                                       BCPREM-ATTRB (2).
 24678
 24679     IF PI-MAP-NAME = EL631B
 24680        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24681        MOVE WS-CURRENT-DT          TO BDATEO
 24682        MOVE TIME-OUT               TO BTIMEO
 24683        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24684        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24685        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24686        MOVE SPACES                 TO BPFENTRO
 24687        MOVE AL-UANOF               TO BPFENTRA
 24688
 24689*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24690        IF PI-COMPANY-ID NOT = 'DMD'
 24691             MOVE AL-SANOF            TO BBILLEDA
 24692             MOVE AL-SADOF            TO DMDBILA
 24693         ELSE
 24694            NEXT SENTENCE
 24695*DMD CUSTOM CODING*************END
 24696     ELSE
 24697        IF PI-MAP-NAME = EL631C
 24698           MOVE WS-CURRENT-DT          TO CDATEO
 24699           MOVE TIME-OUT               TO CTIMEO
 24700           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24701           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24702           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24703           MOVE SPACES                 TO CPFENTRO
 24704           MOVE AL-UANOF               TO CPFENTRA
 24705        ELSE
 24706           MOVE WS-CURRENT-DT          TO DDATEO
 24707           MOVE TIME-OUT               TO DTIMEO
 24708           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24709
 24710
 24711* EXEC CICS SEND
 24712*        MAP      (PI-MAP-NAME)
 24713*        MAPSET   (MAPSET-EL6311S)
 24714*        FROM     (EL631BI)
 24715*        DATAONLY
 24716*        CURSOR
 24717*    END-EXEC.
 24718     MOVE LENGTH OF
 24719      EL631BI
 24720       TO DFHEIV12
 24721     MOVE -1
 24722       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 456
* EL6311.cbl
 24723*    MOVE '8$D    CT       H L F ,   #00020780' TO DFHEIV0
 24724     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24725     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24726     MOVE X'2020233030303230373830' TO DFHEIV0(25:11)
 24727     CALL 'kxdfhei1' USING DFHEIV0,
 24728           PI-MAP-NAME,
 24729           EL631BI,
 24730           DFHEIV12,
 24731           MAPSET-EL6311S,
 24732           DFHEIV99,
 24733           DFHEIV99,
 24734           DFHEIV99,
 24735           DFHEIV11,
 24736           DFHEIV99,
 24737           DFHEIV99,
 24738           DFHEIV99
 24739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24740
 24741
 24742     GO TO 9100-RETURN-TRAN.
 24743
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 457
* EL6311.cbl
 24745
 24746******************************************************************
 24747*                                                                *
 24748*           U T I L I T Y   R O U T I N E S                      *
 24749*                                                                *
 24750******************************************************************
 24751
 24752 8300-SEND-TEXT.
 24753
 24754* EXEC CICS SEND TEXT
 24755*        FROM     (LOGOFF-TEXT)
 24756*        LENGTH   (LOGOFF-LENGTH)
 24757*        ERASE
 24758*        FREEKB
 24759*    END-EXEC.
 24760*    MOVE '8&      T  E F  H   F -   #00020799' TO DFHEIV0
 24761     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24762     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24763     MOVE X'2020233030303230373939' TO DFHEIV0(25:11)
 24764     CALL 'kxdfhei1' USING DFHEIV0,
 24765           LOGOFF-TEXT,
 24766           LOGOFF-LENGTH,
 24767           DFHEIV99,
 24768           DFHEIV99,
 24769           DFHEIV99,
 24770           DFHEIV99,
 24771           DFHEIV99,
 24772           DFHEIV99,
 24773           DFHEIV99,
 24774           DFHEIV99,
 24775           DFHEIV99,
 24776           DFHEIV99
 24777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24778
 24779
 24780
 24781* EXEC CICS RETURN
 24782*    END-EXEC.
 24783*    MOVE '.(                    ''   #00020806' TO DFHEIV0
 24784     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24785     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24786     MOVE X'2020233030303230383036' TO DFHEIV0(25:11)
 24787     CALL 'kxdfhei1' USING DFHEIV0,
 24788           DFHEIV99,
 24789           DFHEIV99,
 24790           DFHEIV99,
 24791           DFHEIV99,
 24792           DFHEIV99,
 24793           DFHEIV99
 24794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24795
 24796
 24797 8400-LOG-JOURNAL-RECORD.
 24798     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24799     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24800
 24801*    EXEC CICS JOURNAL
 24802*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 458
* EL6311.cbl
 24803*        JTYPEID     ('EL')
 24804*        FROM        (JOURNAL-RECORD)
 24805*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24806*    END-EXEC.
 24807
 24808 8600-DEEDIT.
 24809
 24810* EXEC CICS BIF DEEDIT
 24811*         FIELD   (DEEDIT-FIELD)
 24812*         LENGTH  (15)
 24813*    END-EXEC.
 24814     MOVE 15
 24815       TO DFHEIV11
 24816*    MOVE '@"L                   #   #00020821' TO DFHEIV0
 24817     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24818     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24819     MOVE X'2020233030303230383231' TO DFHEIV0(25:11)
 24820     CALL 'kxdfhei1' USING DFHEIV0,
 24821           DEEDIT-FIELD,
 24822           DFHEIV11
 24823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24824
 24825
 24826 8800-UNAUTHORIZED-ACCESS.
 24827     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24828     GO TO 8300-SEND-TEXT.
 24829
 24830 8810-PF23.
 24831     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24832     MOVE XCTL-EL005             TO PGM-NAME.
 24833     GO TO 9300-XCTL.
 24834
 24835 9100-RETURN-TRAN.
 24836     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24837
 24838     IF  PI-MAP-NAME =  EL631B
 24839         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24840
 24841     IF  PI-MAP-NAME =  EL631C
 24842         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24843
 24844     IF  PI-MAP-NAME =  EL631D
 24845         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24846
 24847
 24848* EXEC CICS RETURN
 24849*        TRANSID    (TRANS-EXB1)
 24850*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24851*        LENGTH     (1300)
 24852*    END-EXEC.
 24853     MOVE 1300
 24854       TO DFHEIV11
 24855*    MOVE '.(CT                  ''   #00020847' TO DFHEIV0
 24856     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24857     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24858     MOVE X'2020233030303230383437' TO DFHEIV0(25:11)
 24859     CALL 'kxdfhei1' USING DFHEIV0,
 24860           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 459
* EL6311.cbl
 24861           PROGRAM-INTERFACE-BLOCK,
 24862           DFHEIV11,
 24863           DFHEIV99,
 24864           DFHEIV99,
 24865           DFHEIV99
 24866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24867
 24868
 24869 9200-RETURN-MAIN-MENU.
 24870     MOVE XCTL-EL626             TO PGM-NAME.
 24871     GO TO 9300-XCTL.
 24872
 24873 9300-XCTL.
 24874
 24875* EXEC CICS XCTL
 24876*        PROGRAM    (PGM-NAME)
 24877*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24878*        LENGTH     (PI-COMM-LENGTH)
 24879*    END-EXEC.
 24880*    MOVE '.$C                   %   #00020858' TO DFHEIV0
 24881     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24882     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24883     MOVE X'2020233030303230383538' TO DFHEIV0(25:11)
 24884     CALL 'kxdfhei1' USING DFHEIV0,
 24885           PGM-NAME,
 24886           PROGRAM-INTERFACE-BLOCK,
 24887           PI-COMM-LENGTH,
 24888           DFHEIV99
 24889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24890
 24891
 24892 9400-CLEAR.
 24893     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24894     GO TO 9300-XCTL.
 24895
 24896 9500-PF12.
 24897     MOVE XCTL-EL010             TO PGM-NAME.
 24898     GO TO 9300-XCTL.
 24899
 24900 9600-PGMID-ERROR.
 24901
 24902* EXEC CICS HANDLE CONDITION
 24903*        PGMIDERR    (8300-SEND-TEXT)
 24904*    END-EXEC.
 24905*    MOVE '"$L                   ! \ #00020873' TO DFHEIV0
 24906     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24907     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24908     MOVE X'5C20233030303230383733' TO DFHEIV0(25:11)
 24909     CALL 'kxdfhei1' USING DFHEIV0
 24910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24911
 24912
 24913     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24914     MOVE ' '                    TO PI-ENTRY-CD-1.
 24915     MOVE XCTL-EL005             TO PGM-NAME.
 24916     MOVE PGM-NAME               TO LOGOFF-PGM.
 24917     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24918     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 460
* EL6311.cbl
 24919
 24920 9700-DATE-LINK.
 24921     MOVE LINK-ELDATCV           TO PGM-NAME.
 24922
 24923* EXEC CICS LINK
 24924*        PROGRAM    (PGM-NAME)
 24925*        COMMAREA   (DATE-CONVERSION-DATA)
 24926*        LENGTH     (DC-COMM-LENGTH)
 24927*    END-EXEC.
 24928*    MOVE '."C                   (   #00020886' TO DFHEIV0
 24929     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24930     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24931     MOVE X'2020233030303230383836' TO DFHEIV0(25:11)
 24932     CALL 'kxdfhei1' USING DFHEIV0,
 24933           PGM-NAME,
 24934           DATE-CONVERSION-DATA,
 24935           DC-COMM-LENGTH,
 24936           DFHEIV99,
 24937           DFHEIV99,
 24938           DFHEIV99,
 24939           DFHEIV99
 24940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24941
 24942
 24943 9800-LINK-PENDING-EDIT.
 24944     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24945     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24946
 24947     MOVE LINK-EL050             TO PGM-NAME
 24948     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24949     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24950                                    WK-CO-TOL-CLAIM
 24951                                    WK-CO-TOL-PREM
 24952                                    WK-CO-TOL-REFUND
 24953                                    WK-CO-TOL-PREM-PCT
 24954                                    WK-CO-TOL-REFUND-PCT
 24955                                    WK-REFUND-OVS-AMT
 24956                                    WK-REFUND-OVS-PCT
 24957                                    WK-ACCT-ADDR
 24958                                    WK-LIFE-EDIT-ADDR
 24959                                    WK-AH-EDIT-ADDR
 24960                                    WK-LIFE-BEN-ADDR
 24961                                    WK-AH-BEN-ADDR
 24962                                    WK-STATE-ADDR
 24963                                    WK-PLAN-ADDR
 24964                                    WK-FORM-ADDR
 24965     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24966
 24967     MOVE '6'                    TO WK-ENTRY-SW.
 24968
 24969     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24970
 24971     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24972                                    EC-AM-EXPIRATION-DT
 24973                                    EC-AM-EFFECTIVE-DT
 24974                                    EC-CM-LF-CANCEL-DT
 24975                                    EC-CM-AH-CANCEL-DT
 24976                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 461
* EL6311.cbl
 24977
 24978     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24979                                    EC-CO-TOL-REFUND
 24980                                    EC-CO-MIN-AGE
 24981                                    EC-CO-MIN-PREMIUM
 24982                                    EC-CO-MIN-TERM
 24983                                    EC-CO-MAX-TERM
 24984                                    EC-ST-TOL-PREM
 24985                                    EC-ST-TOL-REFUND
 24986                                    EC-AM-LF-TOL-PREM
 24987                                    EC-AM-AH-TOL-PREM
 24988                                    EC-AM-LF-MAX-ATT-AGE
 24989                                    EC-AM-LF-MAX-AGE
 24990                                    EC-AM-LF-MAX-TERM
 24991                                    EC-AM-LF-MAX-TOT-BEN
 24992                                    EC-AM-AH-MAX-ATT-AGE
 24993                                    EC-AM-AH-MAX-AGE
 24994                                    EC-AM-AH-MAX-TERM
 24995                                    EC-AM-AH-MAX-TOT-BEN
 24996                                    EC-AM-AH-MAX-MON-BEN
 24997                                    EC-RT-LF-MAX-ATT-AGE
 24998                                    EC-RT-LF-MAX-AGE
 24999                                    EC-RT-LF-MAX-TERM
 25000                                    EC-RT-LF-MAX-TOT-BEN
 25001                                    EC-RT-AH-MAX-ATT-AGE
 25002                                    EC-RT-AH-MAX-AGE
 25003                                    EC-RT-AH-MAX-TERM
 25004                                    EC-RT-AH-MAX-TOT-BEN
 25005                                    EC-RT-AH-MAX-MON-BEN
 25006                                    EC-RT-AH-RATE
 25007                                    EC-RT-LF-RATE
 25008                                    EC-RT-LF-NSP-RATE
 25009                                    EC-RT-AH-NSP-RATE
 25010                                    EC-CM-LF-PRIOR-REFUND
 25011                                    EC-CM-AH-PRIOR-REFUND.
 25012
 25013     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 25014                                    EC-ST-TOL-PREM-PCT
 25015                                    EC-AM-LF-TOL-REFUND
 25016                                    EC-AM-LF-DEV-PERCENT
 25017                                    EC-CO-TOL-REFUND-PCT
 25018                                    EC-ST-TOL-REFUND-PCT
 25019                                    EC-AM-AH-TOL-REFUND
 25020                                    EC-AM-AH-DEV-PERCENT.
 25021
 25022
 25023* EXEC CICS LINK
 25024*         PROGRAM   (PGM-NAME)
 25025*         COMMAREA  (PASSED-RECORD)
 25026*         LENGTH    (WS-EDIT-PASS-LENGTH)
 25027*    END-EXEC.
 25028*    MOVE '."C                   (   #00020971' TO DFHEIV0
 25029     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25030     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25031     MOVE X'2020233030303230393731' TO DFHEIV0(25:11)
 25032     CALL 'kxdfhei1' USING DFHEIV0,
 25033           PGM-NAME,
 25034           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 462
* EL6311.cbl
 25035           WS-EDIT-PASS-LENGTH,
 25036           DFHEIV99,
 25037           DFHEIV99,
 25038           DFHEIV99,
 25039           DFHEIV99
 25040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25041
 25042
 25043     MOVE '1'                    TO PI-EDIT-SW.
 25044     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 25045
 25046     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 25047
 25048     IF PI-COMPANY-ID = 'UCL'
 25049         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 25050
 25051     IF VALID-PB-ID
 25052        GO TO 9800-EXIT.
 25053
 25054     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 25055
 25056     IF PI-MAP-NAME = EL631B
 25057        MOVE -1                  TO BMAINTL
 25058       ELSE
 25059        MOVE -1                  TO CMAINTL.
 25060
 25061     GO TO 8200-SEND-DATAONLY.
 25062
 25063 9800-EXIT.
 25064      EXIT.
 25065
 25066 9900-ERROR-FORMAT.
 25067
 25068     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 25069
 25070     IF NOT EMI-ERRORS-COMPLETE
 25071         MOVE LINK-EL001         TO PGM-NAME
 25072
 25073* EXEC CICS LINK
 25074*            PROGRAM    (PGM-NAME)
 25075*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 25076*            LENGTH     (EMI-COMM-LENGTH)
 25077*        END-EXEC.
 25078*    MOVE '."C                   (   #00021006' TO DFHEIV0
 25079     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25081     MOVE X'2020233030303231303036' TO DFHEIV0(25:11)
 25082     CALL 'kxdfhei1' USING DFHEIV0,
 25083           PGM-NAME,
 25084           ERROR-MESSAGE-INTERFACE-BLOCK,
 25085           EMI-COMM-LENGTH,
 25086           DFHEIV99,
 25087           DFHEIV99,
 25088           DFHEIV99,
 25089           DFHEIV99
 25090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25091
 25092
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 463
* EL6311.cbl
 25093 9900-EXIT.
 25094     EXIT.
 25095
 25096 9990-ABEND.
 25097     MOVE LINK-EL004             TO PGM-NAME.
 25098     MOVE DFHEIBLK               TO EMI-LINE1.
 25099
 25100* EXEC CICS LINK
 25101*        PROGRAM   (PGM-NAME)
 25102*        COMMAREA  (EMI-LINE1)
 25103*        LENGTH    (72)
 25104*    END-EXEC.
 25105     MOVE 72
 25106       TO DFHEIV11
 25107*    MOVE '."C                   (   #00021018' TO DFHEIV0
 25108     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25109     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25110     MOVE X'2020233030303231303138' TO DFHEIV0(25:11)
 25111     CALL 'kxdfhei1' USING DFHEIV0,
 25112           PGM-NAME,
 25113           EMI-LINE1,
 25114           DFHEIV11,
 25115           DFHEIV99,
 25116           DFHEIV99,
 25117           DFHEIV99,
 25118           DFHEIV99
 25119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25120
 25121
 25122     IF PI-MAP-NAME = EL631B
 25123        MOVE -1                  TO BMAINTL
 25124       ELSE
 25125        MOVE -1                  TO CMAINTL.
 25126
 25127     IF EIBTRNID NOT = TRANS-EXB1
 25128        GO TO 8100-SEND-INITIAL-MAP
 25129       ELSE
 25130        GO TO 8200-SEND-DATAONLY.
 25131
 25132 9995-SECURITY-VIOLATION.
 25133*                            COPY ELCSCTP.
 25134******************************************************************
 25135*                                                                *
 25136*                            ELCSCTP                             *
 25137*                            VMOD=2.001                          *
 25138*                                                                *
 25139*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 25140******************************************************************
 25141
 25142
 25143     MOVE EIBDATE          TO SM-JUL-DATE.
 25144     MOVE EIBTRMID         TO SM-TERMID.
 25145     MOVE THIS-PGM         TO SM-PGM.
 25146     MOVE EIBTIME          TO TIME-IN.
 25147     MOVE TIME-OUT         TO SM-TIME.
 25148     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 25149
 25150
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 464
* EL6311.cbl
 25151* EXEC CICS LINK
 25152*         PROGRAM  ('EL003')
 25153*         COMMAREA (SECURITY-MESSAGE)
 25154*         LENGTH   (80)
 25155*    END-EXEC.
 25156     MOVE 'EL003' TO DFHEIV1
 25157     MOVE 80
 25158       TO DFHEIV11
 25159*    MOVE '."C                   (   #00021052' TO DFHEIV0
 25160     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25162     MOVE X'2020233030303231303532' TO DFHEIV0(25:11)
 25163     CALL 'kxdfhei1' USING DFHEIV0,
 25164           DFHEIV1,
 25165           SECURITY-MESSAGE,
 25166           DFHEIV11,
 25167           DFHEIV99,
 25168           DFHEIV99,
 25169           DFHEIV99,
 25170           DFHEIV99
 25171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25172
 25173
 25174******************************************************************
 25175
 25176
 25177 9999-DFHBACK SECTION.
 25178     MOVE '9%                    "   ' TO DFHEIV0
 25179     MOVE 'EL6311' TO DFHEIV1
 25180     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25181     GOBACK.
 25182 9999-DFHEXIT.
 25183     IF DFHEIGDJ EQUAL 0001
 25184         NEXT SENTENCE
 25185     ELSE IF DFHEIGDJ EQUAL 2
 25186         GO TO 9600-PGMID-ERROR,
 25187               9990-ABEND,
 25188               9990-ABEND,
 25189               0010-MAIN-LOGIC
 25190         DEPENDING ON DFHEIGDI
 25191     ELSE IF DFHEIGDJ EQUAL 3
 25192         GO TO 1280-BATCH-HDR-NOT-FOUND
 25193         DEPENDING ON DFHEIGDI
 25194     ELSE IF DFHEIGDJ EQUAL 4
 25195         GO TO 1290-DUPLICATE-ALT-INDEX
 25196         DEPENDING ON DFHEIGDI
 25197     ELSE IF DFHEIGDJ EQUAL 5
 25198         GO TO 1295-CERT-TRL-REC-NOTFND
 25199         DEPENDING ON DFHEIGDI
 25200     ELSE IF DFHEIGDJ EQUAL 6
 25201         GO TO 1380-BATCH-HDR-NOT-FOUND
 25202         DEPENDING ON DFHEIGDI
 25203     ELSE IF DFHEIGDJ EQUAL 7
 25204         GO TO 1385-REC-NOT-FOUND
 25205         DEPENDING ON DFHEIGDI
 25206     ELSE IF DFHEIGDJ EQUAL 8
 25207         GO TO 1386-NOTFND
 25208         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 465
* EL6311.cbl
 25209     ELSE IF DFHEIGDJ EQUAL 9
 25210         GO TO 1399-EXIT
 25211         DEPENDING ON DFHEIGDI
 25212     ELSE IF DFHEIGDJ EQUAL 10
 25213         GO TO 1480-BATCH-HDR-NOT-FOUND
 25214         DEPENDING ON DFHEIGDI
 25215     ELSE IF DFHEIGDJ EQUAL 11
 25216         GO TO 1490-RECORD-NOT-FOUND
 25217         DEPENDING ON DFHEIGDI
 25218     ELSE IF DFHEIGDJ EQUAL 12
 25219         GO TO 1405-DELETE-CERTIFICATE
 25220         DEPENDING ON DFHEIGDI
 25221     ELSE IF DFHEIGDJ EQUAL 13
 25222         GO TO 1420-CONTINUE-DELETE
 25223         DEPENDING ON DFHEIGDI
 25224     ELSE IF DFHEIGDJ EQUAL 14
 25225         GO TO 1406-DELETE-ERNOTE
 25226         DEPENDING ON DFHEIGDI
 25227     ELSE IF DFHEIGDJ EQUAL 15
 25228         GO TO 1407-DELETE-MAILING
 25229         DEPENDING ON DFHEIGDI
 25230     ELSE IF DFHEIGDJ EQUAL 16
 25231         GO TO 1420-CONTINUE-DELETE
 25232         DEPENDING ON DFHEIGDI
 25233     ELSE IF DFHEIGDJ EQUAL 17
 25234         GO TO 1480-BATCH-HDR-NOT-FOUND
 25235         DEPENDING ON DFHEIGDI
 25236     ELSE IF DFHEIGDJ EQUAL 18
 25237         GO TO 1475-DELETE-FINISHED
 25238         DEPENDING ON DFHEIGDI
 25239     ELSE IF DFHEIGDJ EQUAL 19
 25240         GO TO 2280-BATCH-HDR-NOT-FOUND
 25241         DEPENDING ON DFHEIGDI
 25242     ELSE IF DFHEIGDJ EQUAL 20
 25243         GO TO 2290-DUPLICATE-ALT-INDEX
 25244         DEPENDING ON DFHEIGDI
 25245     ELSE IF DFHEIGDJ EQUAL 21
 25246         GO TO 2380-BATCH-HDR-NOT-FOUND
 25247         DEPENDING ON DFHEIGDI
 25248     ELSE IF DFHEIGDJ EQUAL 22
 25249         GO TO 2385-REC-NOT-FOUND
 25250         DEPENDING ON DFHEIGDI
 25251     ELSE IF DFHEIGDJ EQUAL 23
 25252         GO TO 2380-BATCH-HDR-NOT-FOUND
 25253         DEPENDING ON DFHEIGDI
 25254     ELSE IF DFHEIGDJ EQUAL 24
 25255         GO TO 2485-BATCH-HDR-NOT-FOUND
 25256         DEPENDING ON DFHEIGDI
 25257     ELSE IF DFHEIGDJ EQUAL 25
 25258         GO TO 2490-RECORD-NOT-FOUND
 25259         DEPENDING ON DFHEIGDI
 25260     ELSE IF DFHEIGDJ EQUAL 26
 25261         GO TO 2475-CONTINUE-DELETE
 25262         DEPENDING ON DFHEIGDI
 25263     ELSE IF DFHEIGDJ EQUAL 27
 25264         GO TO 2485-BATCH-HDR-NOT-FOUND
 25265         DEPENDING ON DFHEIGDI
 25266     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 466
* EL6311.cbl
 25267         GO TO 2480-DELETE-FINISHED
 25268         DEPENDING ON DFHEIGDI
 25269     ELSE IF DFHEIGDJ EQUAL 29
 25270         GO TO 2820-PROCESS-REWRITE
 25271         DEPENDING ON DFHEIGDI
 25272     ELSE IF DFHEIGDJ EQUAL 30
 25273         GO TO 2885-RECORD-MISSING
 25274         DEPENDING ON DFHEIGDI
 25275     ELSE IF DFHEIGDJ EQUAL 31
 25276         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 25277         DEPENDING ON DFHEIGDI
 25278     ELSE IF DFHEIGDJ EQUAL 32
 25279         GO TO 2827-DELETE-MAILING
 25280         DEPENDING ON DFHEIGDI
 25281     ELSE IF DFHEIGDJ EQUAL 33
 25282         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 25283         DEPENDING ON DFHEIGDI
 25284     ELSE IF DFHEIGDJ EQUAL 34
 25285         GO TO 2920-PROCESS-REWRITE
 25286         DEPENDING ON DFHEIGDI
 25287     ELSE IF DFHEIGDJ EQUAL 35
 25288         GO TO 2985-RECORD-MISSING
 25289         DEPENDING ON DFHEIGDI
 25290     ELSE IF DFHEIGDJ EQUAL 36
 25291         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 25292         DEPENDING ON DFHEIGDI
 25293     ELSE IF DFHEIGDJ EQUAL 37
 25294         GO TO 2990-DUPLICATE-RECORD
 25295         DEPENDING ON DFHEIGDI
 25296     ELSE IF DFHEIGDJ EQUAL 38
 25297         GO TO 3590-NOT-FOUND
 25298         DEPENDING ON DFHEIGDI
 25299     ELSE IF DFHEIGDJ EQUAL 39
 25300         GO TO 3690-NOT-FOUND
 25301         DEPENDING ON DFHEIGDI
 25302     ELSE IF DFHEIGDJ EQUAL 40
 25303         GO TO 3990-NOT-FOUND
 25304         DEPENDING ON DFHEIGDI
 25305     ELSE IF DFHEIGDJ EQUAL 41
 25306         GO TO 4050-END-RECORDS,
 25307               4050-END-RECORDS
 25308         DEPENDING ON DFHEIGDI
 25309     ELSE IF DFHEIGDJ EQUAL 42
 25310         GO TO 4150-END-BATCH
 25311         DEPENDING ON DFHEIGDI
 25312     ELSE IF DFHEIGDJ EQUAL 43
 25313         GO TO 4150-END-BATCH
 25314         DEPENDING ON DFHEIGDI
 25315     ELSE IF DFHEIGDJ EQUAL 44
 25316         GO TO 4250-END-RECORDS,
 25317               4250-END-RECORDS
 25318         DEPENDING ON DFHEIGDI
 25319     ELSE IF DFHEIGDJ EQUAL 45
 25320         GO TO 4350-END-BATCH,
 25321               4350-END-BATCH
 25322         DEPENDING ON DFHEIGDI
 25323     ELSE IF DFHEIGDJ EQUAL 46
 25324         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 467
* EL6311.cbl
 25325               4550-END-RECORDS
 25326         DEPENDING ON DFHEIGDI
 25327     ELSE IF DFHEIGDJ EQUAL 47
 25328         GO TO 4680-NOT-FOUND,
 25329               4680-NOT-FOUND
 25330         DEPENDING ON DFHEIGDI
 25331     ELSE IF DFHEIGDJ EQUAL 48
 25332         GO TO 4860-NOT-FOUND,
 25333               4850-END-RECORDS
 25334         DEPENDING ON DFHEIGDI
 25335     ELSE IF DFHEIGDJ EQUAL 49
 25336         GO TO 4970-NOT-FOUND,
 25337               4950-END-RECORDS
 25338         DEPENDING ON DFHEIGDI
 25339     ELSE IF DFHEIGDJ EQUAL 50
 25340         GO TO 5050-NOT-FOUND
 25341         DEPENDING ON DFHEIGDI
 25342     ELSE IF DFHEIGDJ EQUAL 51
 25343         GO TO 5050-NOT-FOUND
 25344         DEPENDING ON DFHEIGDI
 25345     ELSE IF DFHEIGDJ EQUAL 52
 25346         GO TO 5050-NOT-FOUND
 25347         DEPENDING ON DFHEIGDI
 25348     ELSE IF DFHEIGDJ EQUAL 53
 25349         GO TO 5550-END-RECORDS,
 25350               5550-END-RECORDS
 25351         DEPENDING ON DFHEIGDI
 25352     ELSE IF DFHEIGDJ EQUAL 54
 25353         GO TO 6050-QID-ERROR
 25354         DEPENDING ON DFHEIGDI
 25355     ELSE IF DFHEIGDJ EQUAL 55
 25356         GO TO 6050-QID-ERROR
 25357         DEPENDING ON DFHEIGDI
 25358     ELSE IF DFHEIGDJ EQUAL 56
 25359         GO TO 6400-CONTINUE,
 25360               6400-CONTINUE
 25361         DEPENDING ON DFHEIGDI
 25362     ELSE IF DFHEIGDJ EQUAL 57
 25363         GO TO 3690-NOT-FOUND
 25364         DEPENDING ON DFHEIGDI
 25365     ELSE IF DFHEIGDJ EQUAL 58
 25366         GO TO 7399-EXIT
 25367         DEPENDING ON DFHEIGDI
 25368     ELSE IF DFHEIGDJ EQUAL 59
 25369         GO TO 7550-OFFICER-NOTFND
 25370         DEPENDING ON DFHEIGDI
 25371     ELSE IF DFHEIGDJ EQUAL 60
 25372         GO TO 8300-SEND-TEXT
 25373         DEPENDING ON DFHEIGDI.
 25374     MOVE '9%                    "   ' TO DFHEIV0
 25375     MOVE 'EL6311' TO DFHEIV1
 25376     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25377     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15972     Code:      100267
