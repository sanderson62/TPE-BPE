* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67******************************************************************
    68
    69 ENVIRONMENT DIVISION.
    70
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page   3
* EL6311.cbl
    72 DATA DIVISION.
    73 WORKING-STORAGE SECTION.
    74 01  DFH-START PIC X(04).
    75 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    76 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    77 77  FILLER  PIC X(32)  VALUE '********************************'.
    78 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    79 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    80 77  A1                          PIC S999 COMP-3 VALUE +0.
    81 77  N1                          PIC S999 COMP-3 VALUE +0.
    82 77  N2                          PIC S999 COMP-3 VALUE +0.
    83 77  N3                          PIC S999 COMP-3 VALUE +0.
    84 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    85 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    86 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    87     88  REVERSAL                    VALUE 'Y'.
    88 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    89 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    90 77  WS-END                      PIC S999 COMP-3 VALUE +0.
    91 77  WS-TALLY                    PIC 99  VALUE ZEROS.
    92 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
    93     88  ERMAIL-FOUND                 VALUE 'Y'.
    94 77  A2                          PIC S9(5) COMP-3 VALUE +0.
    95 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    96 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    97 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    98     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
    99
   100*    COPY ELCSCTM.
   101******************************************************************
   102*                                                                *
   103*                                                                *
   104*                            ELCSCTM                             *
   105*                            VMOD=2.001                          *
   106*                                                                *
   107*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   108*                                                                *
   109******************************************************************
   110 01  SECURITY-MESSAGE.
   111     12  FILLER                          PIC X(30)
   112            VALUE '** LOGIC SECURITY VIOLATION -'.
   113     12  SM-READ                         PIC X(6).
   114     12  FILLER                          PIC X(5)
   115            VALUE ' PGM='.
   116     12  SM-PGM                          PIC X(6).
   117     12  FILLER                          PIC X(5)
   118            VALUE ' OPR='.
   119     12  SM-PROCESSOR-ID                 PIC X(4).
   120     12  FILLER                          PIC X(6)
   121            VALUE ' TERM='.
   122     12  SM-TERMID                       PIC X(4).
   123     12  FILLER                          PIC XX   VALUE SPACE.
   124     12  SM-JUL-DATE                     PIC 9(5).
   125     12  FILLER                          PIC X    VALUE SPACE.
   126     12  SM-TIME                         PIC 99.99.
   127
   128
   129*    COPY ELCSCRTY.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page   4
* EL6311.cbl
   130******************************************************************
   131*                                                                *
   132*                                                                *
   133*                            ELCSCRTY                            *
   134*                            VMOD=2.001                          *
   135*                                                                *
   136*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   137*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   138*        SAVED IN PI-SECURITY-ADDRESS.                           *
   139*                                                                *
   140******************************************************************
   141 01  SECURITY-CONTROL.
   142     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   143     12  FILLER                       PIC XX    VALUE 'SC'.
   144     12  SC-CREDIT-CODES.
   145         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   146             20  SC-CREDIT-DISPLAY    PIC X.
   147             20  SC-CREDIT-UPDATE     PIC X.
   148     12  SC-CLAIMS-CODES.
   149         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   150             20  SC-CLAIMS-DISPLAY    PIC X.
   151             20  SC-CLAIMS-UPDATE     PIC X.
   152
   153 01  WS-VA-NO-COMM-MESS.
   154     12  FILLER                  PIC X(41) VALUE
   155        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   156 01  WS-OC-MESSAGE.
   157     12  FILLER                  PIC X(43) VALUE
   158        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   159     12  WS-OC-DIS-AMT           PIC -----9.99.
   160     12  FILLER                  PIC X(4) VALUE ' ON '.
   161     12  WS-OC-DATE              PIC X(10).
   162 01  WS-DATE-AREA.
   163     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   164     12  WS-CURRENT-DT.
   165         16  FILLER              PIC X(6)    VALUE SPACES.
   166         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   167     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   168     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   169     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   170
   171 01  STANDARD-AREAS.
   172     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   173     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   174     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   175     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   176     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   177     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   178     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   179     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   180     12  PGM-NAME                PIC X(8).
   181     12  TIME-IN                 PIC S9(7).
   182     12  TIME-OUT-R  REDEFINES TIME-IN.
   183         16  FILLER              PIC X.
   184         16  TIME-OUT            PIC 99V99.
   185         16  FILLER              PIC XX.
   186     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   187     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page   5
* EL6311.cbl
   188     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   189     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   190     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   191     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   192     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   193     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   194     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   195     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   196     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   197     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   198     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   199     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   200     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   201     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   202     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   203     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   204     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   205     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   206     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   207     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   208     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   209     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   210     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   211     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   212     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   213     12  FILE-ID                 PIC X(8).
   214     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   215     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   216     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   217     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   218     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   219     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   220     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   221     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   222     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   223     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   224     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   225     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   226     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   227     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   228     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   229
   230 01  WS-PASS-AREA.
   231     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   232     05  WS-PASS-VADS-REC    PIC X(350).
   233*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   234*                                COPY ELCZREC.
   235******************************************************************
   236*                                                                *
   237*                                                                *
   238*                            ELCZREC.                            *
   239*                                                                *
   240*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   241*                                                                *
   242******************************************************************
   243*-----------------------------------------------------------------
   244*                   C H A N G E   L O G
   245*
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page   6
* EL6311.cbl
   246* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   247*-----------------------------------------------------------------
   248*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   249* EFFECTIVE    NUMBER
   250*-----------------------------------------------------------------
   251* 122011    2011022800001  AJRA  NEW FILE
   252* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   253* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   254* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   255*-----------------------------------------------------------------
   256 01  W-Z-CONTROL-DATA.
   257     05  W-NUMBER-OF-COPIES      PIC  9.
   258     05  FILLER                  PIC  X.
   259     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   260     05  FILLER                  PIC  X.
   261     05  W-DAYS-TO-RESEND        PIC  999.
   262     05  FILLER                  PIC  X.
   263     05  W-FORM-TO-RESEND        PIC  X(4).
   264     05  W-ADD-BAR-CODE          PIC  X.
   265     05  W-PROMPT-LETTER         PIC  X.
   266     05  W-HAS-RETURN-ENV        PIC  X.
   267     05  W-ENCLOSURE-CD          PIC  XXX.
   268     05  FILLER                  PIC  X.
   269     05  W-AUTO-CLOSE-IND        PIC  X.
   270     05  FILLER                  PIC  X.
   271     05  W-LETTER-TO-BENE        PIC  X.
   272     05  FILLER                  PIC  X.
   273     05  W-LETTER-TO-ACCT        PIC  X.
   274     05  FILLER                  PIC  X.
   275     05  W-LETTER-TYPE           PIC  X.
   276     05  FILLER                  PIC  X.
   277     05  W-PRINT-CERTIFICATE     PIC  X.
   278     05  FILLER                  PIC  X.
   279     05  W-REFUND-REQUIRED       PIC  X.
   280     05  FILLER                  PIC  X.
   281     05  W-ONBASE-CODE           PIC  XX.
   282     05  FILLER                  PIC  X.
   283     05  W-ACCT-SUMM             PIC  X.
   284     05  FILLER                  PIC  X.
   285     05  W-CSO-SUMM              PIC  X.
   286     05  FILLER                  PIC  X.
   287     05  W-REASONS-REQUIRED      PIC  X.
   288     05  FILLER                  PIC  X(29).
   289******************************************************************
   290*                                                                *
   291*              A C C E S S   K E Y S                             *
   292*                                                                *
   293******************************************************************
   294
   295 01  ACCESS-KEYS.
   296     12  ERPYAJ-KEY.
   297         16  ERPYAJ-COMPANY-CD       PIC X.
   298         16  ERPYAJ-CARRIER          PIC X.
   299         16  ERPYAJ-GROUPING         PIC X(6).
   300         16  ERPYAJ-FIN-RESP         PIC X(10).
   301         16  ERPYAJ-ACCOUNT          PIC X(10).
   302         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   303         16  ERPYAJ-TYPE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page   7
* EL6311.cbl
   304     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   305     12  ELCERT-KEY.
   306         16  ELCERT-COMPANY-CD       PIC X.
   307         16  ELCERT-CARRIER          PIC X.
   308         16  ELCERT-GROUPING         PIC X(6).
   309         16  ELCERT-STATE            PIC XX.
   310         16  ELCERT-ACCOUNT          PIC X(10).
   311         16  ELCERT-CERT-EFF-DT      PIC XX.
   312         16  ELCERT-CERT-NO.
   313             20  ELCERT-CERT-PRIME   PIC X(10).
   314             20  ELCERT-CERT-SFX     PIC X.
   315
   316     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   317     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   318     12  ELCRTO-KEY.
   319         16  ELCRTO-COMPANY-CD       PIC X.
   320         16  ELCRTO-CARRIER          PIC X.
   321         16  ELCRTO-GROUPING         PIC X(6).
   322         16  ELCRTO-STATE            PIC XX.
   323         16  ELCRTO-ACCOUNT          PIC X(10).
   324         16  ELCRTO-CERT-EFF-DT      PIC XX.
   325         16  ELCRTO-CERT-NO.
   326             20  ELCRTO-CERT-PRIME   PIC X(10).
   327             20  ELCRTO-CERT-SFX     PIC X.
   328         16  ELCRTO-RECORD-TYPE      PIC X.
   329         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   330
   331     12  ELCRTT-KEY.
   332         16  ELCRTT-PRIMARY          PIC X(33).
   333         16  ELCRTT-REC-TYPE         PIC X(1).
   334     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   335     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   336
   337     12  ERPNDB-KEY.
   338         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   339         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   340         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   341         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   342             ERPNDB-BATCH-SEQ-NO     PIC XX.
   343         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   344
   345     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   346     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   347     12  ELLETR-KEY.
   348         16  LETR-COMPANY-CD     PIC X.
   349         16  LETR-LETTER-ID      PIC X(4).
   350         16  LETR-FILLER         PIC X(8).
   351         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   352     12  ERPNDM-KEY.
   353         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   354         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   355         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   356         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   357
   358*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   359     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   360*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   361     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page   8
* EL6311.cbl
   362
   363     12  ERPNDB-ALT-KEY.
   364         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   365         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   366         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   367         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   368         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   369         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   370         16  ERPNDB-CERT-NO.
   371             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   372             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   373         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   374         16  ERPNDB-RECORD-TYPE      PIC X.
   375
   376      12  ERPNDB-CSR-KEY.
   377          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   378          20  ERPNDB-CSR-ID                PIC X(4).
   379          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   380          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   381          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   382
   383     12  ERNOTE-KEY.
   384         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   385         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   386         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   387         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   388         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   389         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   390         16  ERNOTE-CERT-NO.
   391             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   392             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   393
   394     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   395     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   396
   397     12  ERCNOT-KEY.
   398         16  ERCNOT-PART-KEY.
   399             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   400             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   401             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   402             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   403             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   404             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   405             20  ERCNOT-CERT-NO.
   406                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   407                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   408         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   409         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   410
   411     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   412     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   413
   414     12  ERMAIL-KEY.
   415         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   416         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   417         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   418         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   419         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page   9
* EL6311.cbl
   420         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   421         16  ERMAIL-CERT-NO.
   422             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   423             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   424
   425     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   426     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   427
   428     12  ERRQST-KEY.
   429         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   430         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   431
   432     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   433     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   434
   435     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   436
   437     12  ERLOFC-KEY.
   438         16  ERLOFC-COMPANY-CD          PIC  X.
   439         16  ERLOFC-CARRIER             PIC  X.
   440         16  ERLOFC-GROUPING            PIC  X(6).
   441         16  ERLOFC-STATE               PIC  XX.
   442         16  ERLOFC-ACCOUNT             PIC  X(10).
   443         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   444*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   445
   446     12  ERACCT-KEY.
   447         16  ERACCT-COMPANY-CD          PIC  X.
   448         16  ERACCT-CARRIER             PIC  X.
   449         16  ERACCT-GROUPING            PIC  X(6).
   450         16  ERACCT-STATE               PIC  XX.
   451         16  ERACCT-ACCOUNT             PIC  X(10).
   452         16  ERACCT-EXP-DT.
   453             20  ERACCT-DT              PIC  XX.
   454             20  ERACCT-FILL            PIC  X(4).
   455
   456     12  ERENDT-KEY.
   457         16  ENDT-COMPANY-CD       PIC X.
   458         16  ENDT-CARRIER          PIC X.
   459         16  ENDT-GROUPING         PIC X(6).
   460         16  ENDT-STATE            PIC XX.
   461         16  ENDT-ACCOUNT          PIC X(10).
   462         16  ENDT-CERT-EFF-DT      PIC XX.
   463         16  ENDT-CERT-PRIME       PIC X(10).
   464         16  ENDT-CERT-SFX         PIC X.
   465         16  ENDT-RECORD-TYPE      PIC X.
   466         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   467
   468 01  WS-ELMSTR-WORK.
   469     12  ELMSTR-KEY.
   470         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   471         16  MSTR-CERT-NO.
   472             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   473             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   474     12  W-CLAIM-KEY.
   475         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   476         16  W-CL-CERT-NO.
   477             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  10
* EL6311.cbl
   478             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   479      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   480 01  CANCEL-GEN-PASS-AREA.
   481     05  CG-OPTION-CODE          PIC X.
   482         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   483         88  CG-FLAT-CANCEL        VALUE '1'.
   484         88  CG-CANCEL             VALUE '2'.
   485         88  CG-CANCEL-REISSUE     VALUE '3'.
   486     05  CG-ERROR-CODE           PIC 99.
   487         88  CG-SUCCESS            VALUE 00.
   488         88  CG-DATE-ERROR         VALUE 01.
   489         88  CG-CERT-NOT-FOUND     VALUE 02.
   490         88  CG-AMOUNT-ERROR       VALUE 04.
   491         88  CG-OPTION-ERROR       VALUE 05.
   492         88  CG-PREV-CAN           VALUE 06.
   493         88  CG-INVALID-DATA       VALUE 07.
   494         88  CG-NO-ACCT-MSTR       VALUE 08.
   495         88  CG-SFX-A-EXIST        VALUE 09.
   496         88  CG-MISC-ERROR         VALUE 99.
   497     05  CG-COMPANY-ID           PIC XXX.
   498     05  CG-PROC-ID              PIC XXXX.
   499     05  CG-CURRENT-DT           PIC XX.
   500     05  CG-MONTH-END-DT         PIC XX.
   501     05  CG-CERT-KEY.
   502         10  CG-CERT-COMPANY-CD  PIC X.
   503         10  CG-CERT-CARRIER     PIC X.
   504         10  CG-CERT-GROUP       PIC X(6).
   505         10  CG-CERT-STATE       PIC XX.
   506         10  CG-CERT-ACCOUNT     PIC X(10).
   507         10  CG-CERT-EFF-DT      PIC XX.
   508         10  CG-CERT-CERT-NO     PIC X(11).
   509     05  CG-LF-CAN-DATA.
   510         10  CG-LF-CAN-DT        PIC XX.
   511         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   512     05  CG-AH-CAN-DATA.
   513         10  CG-AH-CAN-DT        PIC XX.
   514         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   515     05  CG-CERT-PROFILE-DATA.
   516         10  CG-INS-LNAME        PIC X(15).
   517         10  CG-INS-FNAME        PIC X(10).
   518         10  CG-INS-MID-INIT     PIC X.
   519         10  CG-INS-AGE          PIC 99.
   520         10  CG-JNT-LNAME        PIC X(15).
   521         10  CG-JNT-FNAME        PIC X(10).
   522         10  CG-JNT-MID-INIT     PIC X.
   523         10  CG-JNT-AGE          PIC 99.
   524     05  CG-LF-ISS-DATA.
   525         10  CG-LF-BENCD         PIC XX.
   526         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   527         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   528     05  CG-AH-ISS-DATA.
   529         10  CG-AH-BENCD         PIC XX.
   530         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   531     05  CG-BATCH-NO             PIC X(6).
   532     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   533     05  FILLER                  PIC X(306).
   534******************************************************************
   535*                                                                *
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  11
* EL6311.cbl
   536*            G E N E R A L   W O R K   A R E A                   *
   537*                                                                *
   538******************************************************************
   539
   540 01  WORK-AREA.
   541     12  WS-RESPONSE             PIC S9(8)   COMP.
   542         88  RESP-NORMAL                  VALUE +00.
   543         88  RESP-NOTFND                  VALUE +13.
   544         88  RESP-DUPREC                  VALUE +14.
   545         88  RESP-DUPKEY                  VALUE +15.
   546         88  RESP-NOTOPEN                 VALUE +19.
   547         88  RESP-ENDFILE                 VALUE +20.
   548     12  DEEDIT-FIELD            PIC X(15).
   549     12  FILLER          REDEFINES DEEDIT-FIELD.
   550         16  FILLER              PIC X(4).
   551         16  DEEDIT-FIELD-X11    PIC X(11).
   552     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   553                                 PIC S9(15).
   554     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   555                                 PIC S9(13)V99.
   556     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   557                                 PIC S9(11)V9999.
   558     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   559     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   560     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   561         16  WS-CALC-TERM-WHOLE  PIC S999.
   562         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   563
   564     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   565     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   566         16  WS-HR-MINS          PIC 99V99.
   567         16  FILLER              PIC XX.
   568
   569     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   570     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   571
   572     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   573     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   574
   575     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   576     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   577     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   578     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   579     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   580     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   581     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   582
   583     12  QID.
   584         16  QID-TERM            PIC X(4).
   585         16  FILLER              PIC X(4)    VALUE '607B'.
   586
   587     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   588         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   589
   590     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   591         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   592
   593     12  WS-MODE-CODE            PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  12
* EL6311.cbl
   594         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   595                                         'A'.
   596
   597     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   598
   599     12  WS-NUMERIC-SW           PIC X.
   600        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   601
   602     12  WS-EDIT-CSO-FIELD.
   603         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   604                                 PIC X.
   605
   606     12  WS-SAVE-INPUT-FIELDS.
   607         16  WS-BAGE             PIC 99       VALUE ZERO.
   608*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   609         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   610         16  FILLER REDEFINES WS-BAPR.
   611             20  WS-APR-WHOLE-NUM    PIC 99.
   612             20  WS-APR-DEC          PIC 9999.
   613         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   614         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   615
   616         16  WS-B-COVERAGE OCCURS 2 TIMES.
   617             20  WS-TERM-IN-DAYS-SW  PIC X.
   618                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   619             20  WS-BTERM        PIC 999       COMP-3.
   620             20  WS-BALT-TERM    PIC 999       COMP-3.
   621             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   622             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   623             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   624             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   625             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   626             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   627
   628         16  WS-C-FIELDS COMP-3.
   629             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   630             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   631             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   632
   633         16  WS-D-FIELDS COMP-3.
   634             20  WS-DRISS        PIC S9(5)    VALUE +0.
   635             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   636             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   637             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   638             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   639             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   640
   641     12  WS-SAVE-BIRTH-DATE.
   642         16  FILLER              PIC X(4)   VALUE SPACES.
   643         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   644
   645     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   646     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   647     12  FILLER REDEFINES WS-WORK-BIN-RED.
   648         16  FILLER              PIC X(02).
   649         16  WS-WORK-BIN-DT      PIC X(02).
   650     12  WS-SW-1                 PIC X     VALUE SPACE.
   651     12  WS-SW-2                 PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  13
* EL6311.cbl
   652     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   653         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   654     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   655         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   656
   657     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   658     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   659     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   660     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   661     12  WS-CONVERTED-CANCEL-DATES.
   662         16  WS-CONVERTED-CANDT1                  PIC XX.
   663         16  WS-CONVERTED-CANDT2                  PIC XX.
   664
   665     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   666
   667     12  WS-REC-FOUND-SW         PIC X.
   668         88  RECORD-NOT-FOUND    VALUE 'N'.
   669
   670     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   671         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   672         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   673
   674     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   675         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   676         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   677
   678     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   679         88  BROWSE-STARTED      VALUE 'Y'.
   680
   681     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   682         88  FIRST-TIME          VALUE 'Y'.
   683
   684     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   685         88  FIRST-ENTRY         VALUE 'Y'.
   686
   687     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   688         88  REC-BILLED          VALUE 'Y'.
   689
   690     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   691         88  NO-CURSOR-SET       VALUE +0.
   692         88  CURSOR-SET          VALUE +1.
   693
   694     12  WS-ERR-SW               PIC X.
   695         88  STD-ERRORS          VALUE 'S'.
   696         88  TRN-ERRORS          VALUE 'T'.
   697
   698     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   699         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   700
   701     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   702         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   703
   704     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   705         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   706
   707     12  WS-ERR-CODE.
   708         16  FILLER              PIC 99.
   709         16  WS-ERROR-SUB        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  14
* EL6311.cbl
   710
   711     12  WS-DATE-WORK.
   712         16  WS-WORK-MM          PIC XX.
   713         16  WS-WORK-DD          PIC XX.
   714         16  WS-WORK-YY          PIC XX.
   715
   716     12  WS-MM-YY.
   717         16  WS-MM               PIC XX.
   718         16  FILLER              PIC X     VALUE '/'.
   719         16  WS-YY               PIC XX.
   720
   721     12  WS-CERT-EFF-DT          PIC XX.
   722
   723     12  WS-MEMBER-NO            PIC X(12).
   724     12  FILLER  REDEFINES  WS-MEMBER-NO.
   725         16  WS-MEMBER-NO-1-8    PIC 9(8).
   726         16  FILLER              PIC X(4).
   727
   728     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   729
   730     12  WS-ERPNDB-ALT-KEY.
   731         16  WS-PB-COMPANY-CD-A1         PIC X.
   732         16  WS-PB-CARRIER               PIC X.
   733         16  WS-PB-GROUPING              PIC X(6).
   734         16  WS-PB-STATE                 PIC XX.
   735         16  WS-PB-ACCOUNT               PIC X(10).
   736         16  WS-PB-CERT-EFF-DT           PIC XX.
   737         16  WS-PB-CERT-NO.
   738             20  WS-PB-CERT-PRIME        PIC X(10).
   739             20  WS-PB-CERT-SFX          PIC X.
   740         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   741         16  WS-PB-RECORD-TYPE           PIC X.
   742
   743     12  WS-SHOW-SAVE-AREAS.
   744         16  WS-NEW-CERT-NO.
   745             20  WS-NEW-PRIME    PIC X(10).
   746             20  WS-NEW-SUFFIX   PIC X.
   747         16  WS-NEW-CERT-EFF-DT  PIC XX.
   748         16  WS-NEW-RECORD-TYPE  PIC X.
   749         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   750             88   SHOW-RECORD            VALUE 'Y'.
   751
   752     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   753
   754     12  WS-BATCH-NO.
   755         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   756         16  FILLER              PIC X(5) VALUE SPACES.
   757
   758     12  WS-FIRST-NAME.
   759         16  WS-1ST-INIT         PIC X.
   760         16  FILLER              PIC X(9).
   761
   762     12  WS-INITIALS.
   763         16  WS-INITIAL-1        PIC X.
   764         16  WS-INITIAL-2        PIC X.
   765
   766     12  WS-C-HDG.
   767         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  15
* EL6311.cbl
   768         16  FILLER              PIC X(4) VALUE '-REF'.
   769
   770     12  WS-D-PREM-HDG.
   771         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   772         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   773
   774     12  WS-D-REFUND-HDG.
   775         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   776         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   777
   778     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   779
   780     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   781     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   782     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   783     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   784     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   785     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   786     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   787
   788     12  WS-01-CANCEL-ERR        PIC X(25)
   789         VALUE 'CANCEL DATE ERROR'.
   790     12  WS-02-CANCEL-ERR        PIC X(25)
   791         VALUE 'CERT NOT FOUND'.
   792     12  WS-04-CANCEL-ERR        PIC X(25)
   793         VALUE 'CANCEL AMOUNT ERROR'.
   794     12  WS-05-CANCEL-ERR        PIC X(25)
   795         VALUE 'CANCEL OPTION ERROR'.
   796     12  WS-06-CANCEL-ERR        PIC X(25)
   797         VALUE 'PREVIOUSLY CANCELLED'.
   798     12  WS-07-CANCEL-ERR        PIC X(25)
   799         VALUE 'INVALID DATA'.
   800     12  WS-08-CANCEL-ERR        PIC X(25)
   801         VALUE 'NO ACCOUNT MASTER'.
   802     12  WS-09-CANCEL-ERR        PIC X(25)
   803         VALUE 'SUFFIX ALREADY EXISTS'.
   804     12  WS-99-CANCEL-ERR        PIC X(25)
   805         VALUE 'MISC CANCEL ERROR'.
   806
   807     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   808     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   809
   810     12  WS-AGE-FIELDS.
   811         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   812         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   813         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   814         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   815
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  16
* EL6311.cbl
   817
   818******************************************************************
   819*                                                                *
   820*                 B A T C H   T O T A L S                        *
   821*                                                                *
   822******************************************************************
   823
   824     12  WS-BATCH-RECORD.
   825         16  FILLER                       PIC X(10).
   826         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   827         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   828         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   829         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   830         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   831         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   832         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   833         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   834         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   835         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   836         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   837         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   838         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   839         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   840         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   841         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   842         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   843         16  WS-ACCOUNT-NAME              PIC X(30).
   844         16  FILLER                       PIC X.
   845         16  WS-REFERENCE                 PIC X(12).
   846         16  FILLER                       PIC X(197).
   847
   848     12  WS-BATCH-TOTALS.
   849         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   850         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   851         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   852         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   853         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   854         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   855         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   856         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   857         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   858         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   859         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   860         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   861         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   862         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   863         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   864         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   865         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   866         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   867         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   868
   869     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   870
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  17
* EL6311.cbl
   872
   873******************************************************************
   874*                                                                *
   875*                E R R O R   M E S S A G E S                     *
   876*                                                                *
   877******************************************************************
   878
   879 01  ERROR-MESSAGES.
   880     12  ER-0004                 PIC  9(4) VALUE 0004.
   881     12  ER-0008                 PIC  9(4) VALUE 0008.
   882     12  ER-0023                 PIC  9(4) VALUE 0023.
   883     12  ER-0029                 PIC  9(4) VALUE 0029.
   884     12  ER-0033                 PIC  9(4) VALUE 0033.
   885     12  ER-0070                 PIC  9(4) VALUE 0070.
   886     12  ER-0220                 PIC  9(4) VALUE 0220.
   887     12  ER-0248                 PIC  9(4) VALUE 0248.
   888     12  ER-0280                 PIC  9(4) VALUE 0280.
   889     12  ER-0348                 PIC  9(4) VALUE 0348.
   890     12  ER-0582                 PIC  9(4) VALUE 0582.
   891     12  ER-0877                 PIC  9(4) VALUE 0877.
   892     12  ER-1236                 PIC  9(4) VALUE 1236.
   893     12  ER-1570                 PIC  9(4) VALUE 1570.
   894     12  ER-1575                 PIC  9(4) VALUE 1575.
   895     12  ER-1609                 PIC  9(4) VALUE 1609.
   896     12  ER-1819                 PIC  9(4) VALUE 1819.
   897     12  ER-2077                 PIC  9(4) VALUE 2077.
   898     12  ER-2129                 PIC  9(4) VALUE 2129.
   899     12  ER-2188                 PIC  9(4) VALUE 2188.
   900     12  ER-2192                 PIC  9(4) VALUE 2192.
   901     12  ER-2196                 PIC  9(4) VALUE 2196.
   902     12  ER-2197                 PIC  9(4) VALUE 2197.
   903     12  ER-2198                 PIC  9(4) VALUE 2198.
   904     12  ER-2200                 PIC  9(4) VALUE 2200.
   905     12  ER-2212                 PIC  9(4) VALUE 2212.
   906     12  ER-2218                 PIC  9(4) VALUE 2218.
   907     12  ER-2220                 PIC  9(4) VALUE 2220.
   908     12  ER-2222                 PIC  9(4) VALUE 2222.
   909     12  ER-2223                 PIC  9(4) VALUE 2223.
   910     12  ER-2224                 PIC  9(4) VALUE 2224.
   911     12  ER-2225                 PIC  9(4) VALUE 2225.
   912     12  ER-2226                 PIC  9(4) VALUE 2226.
   913     12  ER-2227                 PIC  9(4) VALUE 2227.
   914     12  ER-2228                 PIC  9(4) VALUE 2228.
   915     12  ER-2240                 PIC  9(4) VALUE 2240.
   916     12  ER-2241                 PIC  9(4) VALUE 2241.
   917     12  ER-2242                 PIC  9(4) VALUE 2242.
   918     12  ER-2243                 PIC  9(4) VALUE 2243.
   919     12  ER-2244                 PIC  9(4) VALUE 2244.
   920     12  ER-2245                 PIC  9(4) VALUE 2245.
   921     12  ER-2246                 PIC  9(4) VALUE 2246.
   922     12  ER-2247                 PIC  9(4) VALUE 2247.
   923     12  ER-2251                 PIC  9(4) VALUE 2251.
   924     12  ER-2252                 PIC  9(4) VALUE 2252.
   925     12  ER-2253                 PIC  9(4) VALUE 2253.
   926     12  ER-2254                 PIC  9(4) VALUE 2254.
   927     12  ER-2255                 PIC  9(4) VALUE 2255.
   928     12  ER-2256                 PIC  9(4) VALUE 2256.
   929     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  18
* EL6311.cbl
   930     12  ER-2258                 PIC  9(4) VALUE 2258.
   931     12  ER-2259                 PIC  9(4) VALUE 2259.
   932     12  ER-2260                 PIC  9(4) VALUE 2260.
   933     12  ER-2261                 PIC  9(4) VALUE 2261.
   934     12  ER-2287                 PIC  9(4) VALUE 2287.
   935     12  ER-2336                 PIC  9(4) VALUE 2336.
   936     12  ER-2337                 PIC  9(4) VALUE 2337.
   937     12  ER-2437                 PIC  9(4) VALUE 2437.
   938     12  ER-2471                 PIC  9(4) VALUE 2471.
   939     12  ER-2530                 PIC  9(4) VALUE 2530.
   940     12  ER-2531                 PIC  9(4) VALUE 2531.
   941     12  ER-2532                 PIC  9(4) VALUE 2532.
   942     12  ER-2533                 PIC  9(4) VALUE 2533.
   943     12  ER-2547                 PIC  9(4) VALUE 2547.
   944     12  ER-2591                 PIC  9(4) VALUE 2591.
   945     12  ER-2592                 PIC  9(4) VALUE 2592.
   946     12  ER-2593                 PIC  9(4) VALUE 2593.
   947     12  ER-2600                 PIC  9(4) VALUE 2600.
   948     12  ER-2601                 PIC  9(4) VALUE 2601.
   949     12  ER-2604                 PIC  9(4) VALUE 2604.
   950     12  ER-2605                 PIC  9(4) VALUE 2605.
   951     12  ER-2606                 PIC  9(4) VALUE 2606.
   952     12  ER-2607                 PIC  9(4) VALUE 2607.
   953     12  ER-2622                 PIC  9(4) VALUE 2622.
   954     12  ER-2625                 PIC  9(4) VALUE 2625.
   955     12  ER-2626                 PIC  9(4) VALUE 2626.
   956     12  ER-2627                 PIC  9(4) VALUE 2627.
   957     12  ER-2628                 PIC  9(4) VALUE 2628.
   958     12  ER-2629                 PIC  9(4) VALUE 2629.
   959     12  ER-2630                 PIC  9(4) VALUE 2630.
   960     12  ER-2631                 PIC  9(4) VALUE 2631.
   961     12  ER-2632                 PIC  9(4) VALUE 2632.
   962     12  ER-2633                 PIC  9(4) VALUE 2633.
   963     12  ER-2634                 PIC  9(4) VALUE 2634.
   964     12  ER-2635                 PIC  9(4) VALUE 2635.
   965     12  ER-2636                 PIC  9(4) VALUE 2636.
   966     12  ER-2639                 PIC  9(4) VALUE 2639.
   967     12  ER-2640                 PIC  9(4) VALUE 2640.
   968     12  ER-2647                 PIC  9(4) VALUE 2647.
   969     12  ER-2648                 PIC  9(4) VALUE 2648.
   970     12  ER-2649                 PIC  9(4) VALUE 2649.
   971     12  ER-2650                 PIC  9(4) VALUE 2650.
   972     12  ER-2653                 PIC  9(4) VALUE 2653.
   973     12  ER-2654                 PIC  9(4) VALUE 2654.
   974     12  ER-2655                 PIC  9(4) VALUE 2655.
   975     12  ER-2656                 PIC  9(4) VALUE 2656.
   976     12  ER-2657                 PIC  9(4) VALUE 2657.
   977     12  ER-2660                 PIC  9(4) VALUE 2660.
   978     12  ER-2661                 PIC  9(4) VALUE 2661.
   979     12  ER-2662                 PIC  9(4) VALUE 2662.
   980     12  ER-2663                 PIC  9(4) VALUE 2663.
   981     12  ER-2664                 PIC  9(4) VALUE 2664.
   982     12  ER-2667                 PIC  9(4) VALUE 2667.
   983     12  ER-2668                 PIC  9(4) VALUE 2668.
   984     12  ER-2669                 PIC  9(4) VALUE 2669.
   985     12  ER-2670                 PIC  9(4) VALUE 2670.
   986     12  ER-2671                 PIC  9(4) VALUE 2671.
   987     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  19
* EL6311.cbl
   988     12  ER-2673                 PIC  9(4) VALUE 2673.
   989     12  ER-2677                 PIC  9(4) VALUE 2677.
   990     12  ER-2678                 PIC  9(4) VALUE 2678.
   991     12  ER-2679                 PIC  9(4) VALUE 2679.
   992     12  ER-2680                 PIC  9(4) VALUE 2680.
   993     12  ER-2681                 PIC  9(4) VALUE 2681.
   994     12  ER-2682                 PIC  9(4) VALUE 2682.
   995     12  ER-2683                 PIC  9(4) VALUE 2683.
   996     12  ER-2684                 PIC  9(4) VALUE 2684.
   997     12  ER-2686                 PIC  9(4) VALUE 2686.
   998     12  ER-2689                 PIC  9(4) VALUE 2689.
   999     12  ER-2690                 PIC  9(4) VALUE 2690.
  1000     12  ER-2693                 PIC  9(4) VALUE 2693.
  1001     12  ER-2695                 PIC  9(4) VALUE 2695.
  1002     12  ER-2701                 PIC  9(4) VALUE 2701.
  1003     12  ER-2720                 PIC  9(4) VALUE 2720.
  1004     12  ER-2709                 PIC  9(4) VALUE 2709.
  1005     12  ER-2704                 PIC  9(4) VALUE 2704.
  1006     12  ER-2725                 PIC  9(4) VALUE 2725.
  1007     12  ER-2726                 PIC  9(4) VALUE 2726.
  1008     12  ER-2728                 PIC  9(4) VALUE 2728.
  1009     12  ER-2729                 PIC  9(4) VALUE 2729.
  1010     12  ER-2731                 PIC  9(4) VALUE 2731.
  1011     12  ER-2732                 PIC  9(4) VALUE 2732.
  1012     12  ER-2733                 PIC  9(4) VALUE 2733.
  1013     12  ER-2735                 PIC  9(4) VALUE 2735.
  1014     12  ER-2738                 PIC  9(4) VALUE 2738.
  1015     12  ER-2742                 PIC  9(4) VALUE 2742.
  1016     12  ER-2743                 PIC  9(4) VALUE 2743.
  1017     12  ER-2744                 PIC  9(4) VALUE 2744.
  1018     12  ER-2747                 PIC  9(4) VALUE 2747.
  1019     12  ER-2749                 PIC  9(4) VALUE 2749.
  1020     12  ER-2753                 PIC  9(4) VALUE 2753.
  1021     12  ER-2755                 PIC  9(4) VALUE 2755.
  1022     12  ER-2757                 PIC  9(4) VALUE 2757.
  1023     12  ER-2771                 PIC  9(4) VALUE 2771.
  1024     12  ER-2774                 PIC  9(4) VALUE 2774.
  1025     12  ER-2775                 PIC  9(4) VALUE 2775.
  1026     12  ER-2776                 PIC  9(4) VALUE 2776.
  1027     12  ER-2777                 PIC  9(4) VALUE 2777.
  1028     12  ER-2794                 PIC  9(4) VALUE 2794.
  1029     12  ER-2799                 PIC  9(4) VALUE 2799.
  1030     12  ER-2900                 PIC  9(4) VALUE 2900.
  1031     12  ER-2902                 PIC  9(4) VALUE 2902.
  1032     12  ER-2945                 PIC  9(4) VALUE 2945.
  1033     12  ER-3000                 PIC  9(4) VALUE 3000.
  1034     12  ER-3006                 PIC  9(4) VALUE 3006.
  1035     12  ER-3054                 PIC  9(4) VALUE 3054.
  1036     12  ER-3224                 PIC  9(4) VALUE 3224.
  1037     12  ER-3504                 PIC  9(4) VALUE 3504.
  1038     12  ER-3513                 PIC  9(4) VALUE 3513.
  1039     12  ER-3831                 PIC  9(4) VALUE 3831.
  1040     12  ER-3834                 PIC  9(4) VALUE 3834.
  1041     12  ER-3835                 PIC  9(4) VALUE 3835.
  1042     12  ER-4005                 PIC  9(4) VALUE 4005.
  1043     12  ER-7144                 PIC  9(4) VALUE 7144.
  1044     12  ER-7401                 PIC  9(4) VALUE 7401.
  1045     12  ER-7402                 PIC  9(4) VALUE 7402.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  20
* EL6311.cbl
  1046     12  ER-7403                 PIC  9(4) VALUE 7403.
  1047     12  ER-7404                 PIC  9(4) VALUE 7404.
  1048     12  ER-7423                 PIC  9(4) VALUE 7423.
  1049     12  ER-7424                 PIC  9(4) VALUE 7424.
  1050     12  ER-7433                 PIC  9(4) VALUE 7433.
  1051     12  ER-7450                 PIC  9(4) VALUE 7450.
  1052     12  ER-7451                 PIC  9(4) VALUE 7451.
  1053     12  ER-7530                 PIC  9(4) VALUE 7530.
  1054     12  ER-7573                 PIC  9(4) VALUE 7573.
  1055     12  ER-7631                 PIC  9(4) VALUE 7631.
  1056     12  ER-7632                 PIC  9(4) VALUE 7632.
  1057     12  ER-7633                 PIC  9(4) VALUE 7633.
  1058     12  ER-7537                 PIC  9(4) VALUE 7537.
  1059     12  ER-7538                 PIC  9(4) VALUE 7538.
  1060     12  ER-7574                 PIC  9(4) VALUE 7574.
  1061     12  ER-7997                 PIC  9(4) VALUE 7997.
  1062     12  ER-7998                 PIC  9(4) VALUE 7998.
  1063     12  ER-8148                 PIC  9(4) VALUE 8148.
  1064     12  ER-9063                 PIC  9(4) VALUE 9063.
  1065     12  ER-9076                 PIC  9(4) VALUE 9076.
  1066     12  ER-9618                 PIC  9(4) VALUE 9618.
  1067     12  ER-9841                 PIC  9(4) VALUE 9841.
  1068
  1069*                                COPY ELCTEXT.
  1070******************************************************************
  1071*                                                                *
  1072*                                                                *
  1073*                            ELCTEXT.                            *
  1074*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1075*                            VMOD=2.008                          *
  1076*                                                                *
  1077*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1078*                                     FORM LETTERS,              *
  1079*                                     CERT FORM DISPLAY.
  1080*                                                                *
  1081*   FILE TYPE = VSAM,KSDS                                        *
  1082*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1083*                                                                *
  1084*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1085*       ALTERNATE INDEX = NONE                                   *
  1086*                                                                *
  1087*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1088*       ALTERNATE INDEX = NONE                                   *
  1089*                                                                *
  1090*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1091*       ALTERNATE INDEX = NONE                                   *
  1092*                                                                *
  1093*   LOG = NO                                                     *
  1094*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1095******************************************************************
  1096 01  TEXT-FILES.
  1097     12  TEXT-FILE-ID                PIC XX.
  1098         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1099         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1100         88  HELP-FILE-TEXT             VALUE 'TH'.
  1101
  1102     12  TX-CONTROL-PRIMARY.
  1103         16  TX-COMPANY-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  21
* EL6311.cbl
  1104             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1105         16  TX-ACCESS-CD-GENL       PIC X(12).
  1106
  1107         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1108             20  TX-LETTER-NO        PIC X(4).
  1109             20  FILLER              PIC X(8).
  1110
  1111         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1112             20  TX-FORM-NO          PIC X(12).
  1113
  1114         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1115             20  TX-HELP-TYPE        PIC X.
  1116                 88  HELP-FOR-GENERAL   VALUE ' '.
  1117                 88  HELP-BY-SCREEN     VALUE 'S'.
  1118                 88  HELP-BY-ERROR      VALUE 'E'.
  1119             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1120                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1121             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1122                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1123             20  FILLER              PIC X(4).
  1124
  1125         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1126
  1127     12  TX-PROCESS-CONTROL          PIC XX.
  1128         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1129
  1130     12  TX-TEXT-LINE                PIC X(70).
  1131
  1132     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1133         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1134         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1135         88  TX-VALID-FORM-SQUEEZE-VALUE
  1136                                        VALUE 'Y' ' '.
  1137
  1138     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1139         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1140         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1141         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1142         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1143         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1144         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1145         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1146                                              'K' 'N' ' '
  1147                                              'Z'.
  1148
  1149     12  TX-ARCHIVE-SW               PIC X.
  1150         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1151         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1152         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1153
  1154     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1155     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1156
  1157     12  TX-BSR-CODE                 PIC X.
  1158         88  TX-BSR-LETTER              VALUE 'B'.
  1159         88  TX-NON-BSR-LETTER          VALUE ' '.
  1160
  1161     12  FILLER                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  22
* EL6311.cbl
  1162*****************************************************************
  1163*                                COPY ELCCRTO.
  1164******************************************************************
  1165*                                                                *
  1166*                            ELCCRTO.                            *
  1167*                                                                *
  1168*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1169*                                                                *
  1170*   FILE TYPE = VSAM,KSDS                                        *
  1171*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1172*                                                                *
  1173*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1174*                                                                *
  1175*   LOG = YES                                                    *
  1176*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1177******************************************************************
  1178*                   C H A N G E   L O G
  1179*
  1180* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1181*-----------------------------------------------------------------
  1182*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1183* EFFECTIVE    NUMBER
  1184*-----------------------------------------------------------------
  1185* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1186* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1187* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1188* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1189* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1190******************************************************************
  1191 01  ORIGINAL-CERTIFICATE.
  1192     12  OC-RECORD-ID                      PIC XX.
  1193         88  VALID-OC-ID                      VALUE 'OC'.
  1194     12  OC-CONTROL-PRIMARY.
  1195         16  OC-COMPANY-CD                 PIC X.
  1196         16  OC-CARRIER                    PIC X.
  1197         16  OC-GROUPING                   PIC X(6).
  1198         16  OC-STATE                      PIC XX.
  1199         16  OC-ACCOUNT                    PIC X(10).
  1200         16  OC-CERT-EFF-DT                PIC XX.
  1201         16  OC-CERT-NO.
  1202             20  OC-CERT-PRIME             PIC X(10).
  1203             20  OC-CERT-SFX               PIC X.
  1204         16  OC-RECORD-TYPE                PIC X.
  1205         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1206     12  OC-LAST-MAINT-DT                  PIC XX.
  1207     12  OC-LAST-MAINT-BY                  PIC X(4).
  1208     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1209     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1210     12  FILLER                            PIC X(49).
  1211     12  OC-ORIG-REC.
  1212         16  OC-INS-LAST-NAME              PIC X(15).
  1213         16  OC-INS-FIRST-NAME             PIC X(10).
  1214         16  OC-INS-MIDDLE-INIT            PIC X.
  1215         16  OC-INS-AGE                    PIC S999     COMP-3.
  1216         16  OC-JNT-LAST-NAME              PIC X(15).
  1217         16  OC-JNT-FIRST-NAME             PIC X(10).
  1218         16  OC-JNT-MIDDLE-INIT            PIC X.
  1219         16  OC-JNT-AGE                    PIC S999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  23
* EL6311.cbl
  1220         16  OC-LF-BENCD                   PIC XX.
  1221         16  OC-LF-TERM                    PIC S999      COMP-3.
  1222         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1223         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1224         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1225         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1226         16  OC-LF-EXP-DT                  PIC XX.
  1227         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1228         16  OC-LF-CANCEL-DT               PIC XX.
  1229         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1230         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1231         16  OC-AH-BENCD                   PIC XX.
  1232         16  OC-AH-TERM                    PIC S999      COMP-3.
  1233         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1234         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1235         16  OC-AH-EXP-DT                  PIC XX.
  1236         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1237         16  OC-AH-CP                      PIC 99.
  1238         16  OC-AH-CANCEL-DT               PIC XX.
  1239         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1240         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1241         16  OC-CRED-BENE-NAME             PIC X(25).
  1242         16  OC-1ST-PMT-DT                 PIC XX.
  1243         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1244         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1245         16  OC-ISSUE-TRAN-IND             PIC X.
  1246         16  OC-CANCEL-TRAN-IND            PIC X.
  1247         16  FILLER                        PIC X(211).
  1248
  1249     12  FILLER                            PIC X(50).
  1250******************************************************************
  1251*                                COPY ERCACCT.
  1252******************************************************************
  1253*                                                                *
  1254*                                                                *
  1255*                            ERCACCT                             *
  1256*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1257*                            VMOD=2.031                          *
  1258*                                                                *
  1259*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1260*                                                                *
  1261*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1262*   VSAM ACCOUNT MASTER FILES.                                   *
  1263*                                                                *
  1264*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1265*                                                                *
  1266*   FILE TYPE = VSAM,KSDS                                        *
  1267*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1268*                                                                *
  1269*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1270*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1271*                                                                *
  1272*   LOG = NO                                                     *
  1273*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1274*                                                                *
  1275*                                                                *
  1276******************************************************************
  1277*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  24
* EL6311.cbl
  1278*
  1279* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1280*-----------------------------------------------------------------
  1281*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1282* EFFECTIVE    NUMBER
  1283*-----------------------------------------------------------------
  1284* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1285* 092705    2005050300006  PEMA  ADD SPP LEASES
  1286* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1287* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1288* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1289* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1290* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1291******************************************************************
  1292
  1293 01  ACCOUNT-MASTER.
  1294     12  AM-RECORD-ID                      PIC XX.
  1295         88  VALID-AM-ID                      VALUE 'AM'.
  1296
  1297     12  AM-CONTROL-PRIMARY.
  1298         16  AM-COMPANY-CD                 PIC X.
  1299         16  AM-MSTR-CNTRL.
  1300             20  AM-CONTROL-A.
  1301                 24  AM-CARRIER            PIC X.
  1302                 24  AM-GROUPING.
  1303                     28 AM-GROUPING-PREFIX PIC XXX.
  1304                     28 AM-GROUPING-PRIME  PIC XXX.
  1305                 24  AM-STATE              PIC XX.
  1306                 24  AM-ACCOUNT.
  1307                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1308                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1309             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1310                                           PIC X(19).
  1311             20  AM-CNTRL-B.
  1312                 24  AM-EXPIRATION-DT      PIC XX.
  1313                 24  FILLER                PIC X(4).
  1314             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1315                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1316
  1317     12  AM-CONTROL-BY-VAR-GRP.
  1318         16  AM-COMPANY-CD-A1              PIC X.
  1319         16  AM-VG-CARRIER                 PIC X.
  1320         16  AM-VG-GROUPING                PIC X(6).
  1321         16  AM-VG-STATE                   PIC XX.
  1322         16  AM-VG-ACCOUNT                 PIC X(10).
  1323         16  AM-VG-DATE.
  1324             20  AM-VG-EXPIRATION-DT       PIC XX.
  1325             20  FILLER                    PIC X(4).
  1326         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1327                                           PIC 9(11)      COMP-3.
  1328     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1329         16  FILLER                        PIC X(10).
  1330         16  AM-VG-KEY3.
  1331             20  AM-VG3-ACCOUNT            PIC X(10).
  1332             20  AM-VG3-EXP-DT             PIC XX.
  1333         16  FILLER                        PIC X(4).
  1334     12  AM-MAINT-INFORMATION.
  1335         16  AM-LAST-MAINT-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  25
* EL6311.cbl
  1336         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1337         16  AM-LAST-MAINT-USER            PIC X(4).
  1338         16  FILLER                        PIC XX.
  1339
  1340     12  AM-EFFECTIVE-DT                   PIC XX.
  1341     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1342
  1343     12  AM-PREV-DATES  COMP-3.
  1344         16  AM-PREV-EXP-DT                PIC 9(11).
  1345         16  AM-PREV-EFF-DT                PIC 9(11).
  1346
  1347     12  AM-REPORT-CODE-1                  PIC X(10).
  1348     12  AM-REPORT-CODE-2                  PIC X(10).
  1349
  1350     12  AM-CITY-CODE                      PIC X(4).
  1351     12  AM-COUNTY-PARISH                  PIC X(6).
  1352
  1353     12  AM-NAME                           PIC X(30).
  1354     12  AM-PERSON                         PIC X(30).
  1355     12  AM-ADDRS                          PIC X(30).
  1356     12  AM-CITY.
  1357         16  AM-ADDR-CITY                  PIC X(28).
  1358         16  AM-ADDR-STATE                 PIC XX.
  1359     12  AM-ZIP.
  1360         16  AM-ZIP-PRIME.
  1361             20  AM-ZIP-PRI-1ST            PIC X.
  1362                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1363             20  FILLER                    PIC X(4).
  1364         16  AM-ZIP-PLUS4                  PIC X(4).
  1365     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1366         16  AM-CAN-POSTAL-1               PIC XXX.
  1367         16  AM-CAN-POSTAL-2               PIC XXX.
  1368         16  FILLER                        PIC XXX.
  1369     12  AM-TEL-NO.
  1370         16  AM-AREA-CODE                  PIC 999.
  1371         16  AM-TEL-PRE                    PIC 999.
  1372         16  AM-TEL-NBR                    PIC 9(4).
  1373     12  AM-TEL-LOC                        PIC X.
  1374         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1375         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1376
  1377     12  AM-COMM-STRUCTURE.
  1378         16  AM-DEFN-1.
  1379             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1380                 24  AM-AGT.
  1381                     28  AM-AGT-PREFIX     PIC X(4).
  1382                     28  AM-AGT-PRIME      PIC X(6).
  1383                 24  AM-COM-TYP            PIC X.
  1384                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1385                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1386                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1387                 24  AM-RECALC-LV-INDIC    PIC X.
  1388                 24  AM-RETRO-LV-INDIC     PIC X.
  1389                 24  AM-GL-CODES           PIC X.
  1390                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1391                 24  FILLER                PIC X(01).
  1392         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1393             20  AM-COM-TBLS        OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  26
* EL6311.cbl
  1394                 24  FILLER                PIC X(11).
  1395                 24  AM-L-COMA             PIC XXX.
  1396                 24  AM-J-COMA             PIC XXX.
  1397                 24  AM-A-COMA             PIC XXX.
  1398                 24  FILLER                PIC X(6).
  1399
  1400     12  AM-COMM-CHANGE-STATUS             PIC X.
  1401         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1402
  1403     12  AM-CSR-CODE                       PIC X(4).
  1404
  1405     12  AM-BILLING-STATUS                 PIC X.
  1406         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1407         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1408     12  AM-AUTO-REFUND-SW                 PIC X.
  1409         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1410         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1411     12  AM-GPCD                           PIC 99.
  1412     12  AM-IG                             PIC X.
  1413         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1414         88  AM-HAS-GROUP                     VALUE '2'.
  1415     12  AM-STATUS                         PIC X.
  1416         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1417         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1418         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1419         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1420         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1421         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1422     12  AM-REMIT-TO                       PIC 99.
  1423     12  AM-ID-NO                          PIC X(11).
  1424
  1425     12  AM-CAL-TABLE                      PIC XX.
  1426     12  AM-LF-DEVIATION                   PIC XXX.
  1427     12  AM-AH-DEVIATION                   PIC XXX.
  1428     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1429     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1430     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1431     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1432     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1433     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1434
  1435     12  AM-USER-FIELDS.
  1436         16  AM-FLD-1                      PIC XX.
  1437         16  AM-FLD-2                      PIC XX.
  1438         16  AM-FLD-3                      PIC XX.
  1439         16  AM-FLD-4                      PIC XX.
  1440         16  AM-FLD-5                      PIC XX.
  1441
  1442     12  AM-1ST-PROD-DATE.
  1443         16  AM-1ST-PROD-YR                PIC XX.
  1444         16  AM-1ST-PROD-MO                PIC XX.
  1445         16  AM-1ST-PROD-DA                PIC XX.
  1446     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1447     12  AM-CERTS-PURGED-DATE.
  1448         16  AM-PUR-YR                     PIC XX.
  1449         16  AM-PUR-MO                     PIC XX.
  1450         16  AM-PUR-DA                     PIC XX.
  1451     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  27
* EL6311.cbl
  1452     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1453     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1454     12  AM-INACTIVE-DATE.
  1455         16  AM-INA-MO                     PIC 99.
  1456         16  AM-INA-DA                     PIC 99.
  1457         16  AM-INA-YR                     PIC 99.
  1458     12  AM-AR-HI-CERT-DATE                PIC XX.
  1459
  1460     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1461     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1462
  1463     12  AM-OB-PAYMENT-MODE                PIC X.
  1464         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1465         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1466         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1467         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1468
  1469     12  AM-AH-ONLY-INDICATOR              PIC X.
  1470         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1471         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1472
  1473     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1474
  1475     12  AM-OVER-SHORT.
  1476         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1477         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1478
  1479     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1480     12  AM-DCC-CLP-STATE                  PIC XX.
  1481
  1482     12  AM-RECALC-COMM                    PIC X.
  1483     12  AM-RECALC-REIN                    PIC X.
  1484
  1485     12  AM-REI-TABLE                      PIC XXX.
  1486     12  AM-REI-ET-LF                      PIC X.
  1487     12  AM-REI-ET-AH                      PIC X.
  1488     12  AM-REI-PE-LF                      PIC X.
  1489     12  AM-REI-PE-AH                      PIC X.
  1490     12  AM-REI-PRT-ST                     PIC X.
  1491     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1492     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1493     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1494     12  AM-REI-GROUP-A                    PIC X(6).
  1495     12  AM-REI-MORT                       PIC X(4).
  1496     12  AM-REI-PRT-OW                     PIC X.
  1497     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1498     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1499     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1500     12  AM-REI-GROUP-B                    PIC X(6).
  1501
  1502     12  AM-TRUST-TYPE                     PIC X(2).
  1503
  1504     12  AM-EMPLOYER-STMT-USED             PIC X.
  1505     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1506
  1507     12  AM-STD-AH-TYPE                    PIC XX.
  1508     12  AM-EARN-METHODS.
  1509         16  AM-EARN-METHOD-R              PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  28
* EL6311.cbl
  1510             88 AM-REF-RL-R78                 VALUE 'R'.
  1511             88 AM-REF-RL-PR                  VALUE 'P'.
  1512             88 AM-REF-RL-MEAN                VALUE 'M'.
  1513             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1514         16  AM-EARN-METHOD-L              PIC X.
  1515             88 AM-REF-LL-R78                 VALUE 'R'.
  1516             88 AM-REF-LL-PR                  VALUE 'P'.
  1517             88 AM-REF-LL-MEAN                VALUE 'M'.
  1518             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1519         16  AM-EARN-METHOD-A              PIC X.
  1520             88 AM-REF-AH-R78                 VALUE 'R'.
  1521             88 AM-REF-AH-PR                  VALUE 'P'.
  1522             88 AM-REF-AH-MEAN                VALUE 'M'.
  1523             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1524             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1525             88 AM-REF-AH-NET                 VALUE 'N'.
  1526
  1527     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1528     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1529     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1530
  1531     12  AM-RET-Y-N                        PIC X.
  1532     12  AM-RET-P-E                        PIC X.
  1533     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1534     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1535     12  AM-RET-GRP                        PIC X(6).
  1536     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1537         16  AM-POOL-PRIME                 PIC XXX.
  1538         16  AM-POOL-SUB                   PIC XXX.
  1539     12  AM-RETRO-EARNINGS.
  1540         16  AM-RET-EARN-R                 PIC X.
  1541         16  AM-RET-EARN-L                 PIC X.
  1542         16  AM-RET-EARN-A                 PIC X.
  1543     12  AM-RET-ST-TAX-USE                 PIC X.
  1544         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1545         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1546     12  AM-RETRO-BEG-EARNINGS.
  1547         16  AM-RET-BEG-EARN-R             PIC X.
  1548         16  AM-RET-BEG-EARN-L             PIC X.
  1549         16  AM-RET-BEG-EARN-A             PIC X.
  1550     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1551     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1552
  1553     12  AM-USER-SELECT-OPTIONS.
  1554         16  AM-USER-SELECT-1              PIC X(10).
  1555         16  AM-USER-SELECT-2              PIC X(10).
  1556         16  AM-USER-SELECT-3              PIC X(10).
  1557         16  AM-USER-SELECT-4              PIC X(10).
  1558         16  AM-USER-SELECT-5              PIC X(10).
  1559
  1560     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1561
  1562     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1563
  1564     12  AM-RPT045A-SWITCH                 PIC X.
  1565         88  RPT045A-OFF                   VALUE 'N'.
  1566
  1567     12  AM-INSURANCE-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  29
* EL6311.cbl
  1568         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1569         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1570
  1571     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1572         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1573
  1574     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1575         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1576         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1577
  1578     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1579
  1580     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1581     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1582     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1583     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1584     12  AM-DCC-UEF-STATE                  PIC XX.
  1585     12  FILLER                            PIC XXX.
  1586     12  AM-REPORT-CODE-3                  PIC X(10).
  1587*    12  FILLER                            PIC X(22).
  1588
  1589     12  AM-RESERVE-DATE.
  1590         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1591         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1592         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1593
  1594     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1595     12  AM-NOTIFICATION-TYPES.
  1596         16  AM-NOTIF-OF-LETTERS           PIC X.
  1597         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1598         16  AM-NOTIF-OF-REPORTS           PIC X.
  1599         16  AM-NOTIF-OF-STATUS            PIC X.
  1600
  1601     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1602         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1603         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1604         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1605         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1606
  1607     12  AM-BENEFIT-CONTROLS.
  1608         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1609             20  AM-BENEFIT-CODE           PIC XX.
  1610             20  AM-BENEFIT-TYPE           PIC X.
  1611             20  AM-BENEFIT-REVISION       PIC XXX.
  1612             20  AM-BENEFIT-REM-TERM       PIC X.
  1613             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1614             20  FILLER                    PIC XX.
  1615         16  FILLER                        PIC X(80).
  1616
  1617     12  AM-TRANSFER-DATA.
  1618         16  AM-TRANSFERRED-FROM.
  1619             20  AM-TRNFROM-CARRIER        PIC X.
  1620             20  AM-TRNFROM-GROUPING.
  1621                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1622                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1623             20  AM-TRNFROM-STATE          PIC XX.
  1624             20  AM-TRNFROM-ACCOUNT.
  1625                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  30
* EL6311.cbl
  1626                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1627             20  AM-TRNFROM-DTE            PIC XX.
  1628         16  AM-TRANSFERRED-TO.
  1629             20  AM-TRNTO-CARRIER          PIC X.
  1630             20  AM-TRNTO-GROUPING.
  1631                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1632                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1633             20  AM-TRNTO-STATE            PIC XX.
  1634             20  AM-TRNTO-ACCOUNT.
  1635                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1636                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1637             20  AM-TRNTO-DTE              PIC XX.
  1638         16  FILLER                        PIC X(10).
  1639
  1640     12  AM-SAVED-REMIT-TO                 PIC 99.
  1641
  1642     12  AM-COMM-STRUCTURE-SAVED.
  1643         16  AM-DEFN-1-SAVED.
  1644             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1645                 24  AM-AGT-SV             PIC X(10).
  1646                 24  AM-COM-TYP-SV         PIC X.
  1647                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1648                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1649                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1650                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1651                 24  FILLER                PIC X.
  1652                 24  AM-GL-CODES-SV        PIC X.
  1653                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1654                 24  FILLER                PIC X.
  1655         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1656             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1657                 24  FILLER                PIC X(11).
  1658                 24  AM-L-COMA-SV          PIC XXX.
  1659                 24  AM-J-COMA-SV          PIC XXX.
  1660                 24  AM-A-COMA-SV          PIC XXX.
  1661                 24  FILLER                PIC X(6).
  1662
  1663     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1664         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1665            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1666            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1667            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1668
  1669     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1670     12  FILLER                            PIC X(120).
  1671
  1672     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1673         16  AM-CONTROL-NAME               PIC X(30).
  1674         16  AM-EXECUTIVE-ONE.
  1675             20  AM-EXEC1-NAME             PIC X(15).
  1676             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1677                                                          COMP-3.
  1678             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1679                                                          COMP-3.
  1680         16  AM-EXECUTIVE-TWO.
  1681             20  AM-EXEC2-NAME             PIC X(15).
  1682             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1683                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  31
* EL6311.cbl
  1684             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1685                                                          COMP-3.
  1686
  1687     12  AM-RETRO-ADDITIONAL-DATA.
  1688         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1689         16  AM-RETRO-PREM-P-E             PIC X.
  1690         16  AM-RETRO-CLMS-P-I             PIC X.
  1691         16  AM-RETRO-RET-BRACKET-LF.
  1692             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1693                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1694                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1695             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1696                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1697                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1698             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1699                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1700                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1701         16  AM-RETRO-RET-BRACKET-AH.
  1702             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1703                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1704                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1705                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1706             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1707                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1708                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1709             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1710                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1711                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1712
  1713     12  AM-COMMENTS.
  1714         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1715
  1716     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1717         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1718         16  AM-FLI-BILLING-CODE           PIC X.
  1719         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1720         16  AM-FLI-UNITED-IDENT           PIC X.
  1721         16  AM-FLI-INTEREST-LOST-DATA.
  1722             20  AM-FLI-BANK-NO            PIC X(5).
  1723             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1724             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1725             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1726         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1727             20  AM-FLI-AGT                PIC X(9).
  1728             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1729             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1730         16  FILLER                        PIC X(102).
  1731
  1732     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1733         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1734             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1735             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1736             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1737             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1738             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1739         16  FILLER                          PIC X(10).
  1740******************************************************************
  1741*                                COPY ELCVADS.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  32
* EL6311.cbl
  1742******************************************************************
  1743*                                                                *
  1744*                                                                *
  1745*                            ELCVADS.                            *
  1746*                                                                *
  1747*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1748*   ELVADS                  LENGTH = 350                         *
  1749******************************************************************
  1750******************************************************************
  1751*                   C H A N G E   L O G
  1752*
  1753* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1754*-----------------------------------------------------------------
  1755*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1756* EFFECTIVE    NUMBER
  1757*-----------------------------------------------------------------
  1758* 100111    2011022800001  AJRA  NAPERSOFT
  1759******************************************************************
  1760
  1761 01  VIRGINIA-DISCLOSURE.
  1762     12  VD-COMPANY-CD              PIC X.
  1763     12  VD-CARRIER                 PIC X.
  1764     12  VD-GROUPING.
  1765         20  VD-GROUPING-PREFIX     PIC XXX.
  1766         20  VD-GROUPING-PRIME      PIC XXX.
  1767     12  VD-STATE                   PIC XX.
  1768     12  VD-ACCOUNT.
  1769         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1770         20  VD-ACCOUNT-PRIME       PIC X(6).
  1771     12  VD-CERT-EFF-DT             PIC XX.
  1772     12  VD-CERT-NO.
  1773         20  VD-CERT-PRIME          PIC X(10).
  1774         20  VD-CERT-SFX            PIC X.
  1775     12  VD-ENTRY-BATCH             PIC X(6).
  1776     12  VD-CSR-ID                  PIC X(4).
  1777     12  VD-NAME.
  1778         20  VD-INSURED-LAST-NAME   PIC X(15).
  1779         20  VD-INSURED-FIRST-NAME.
  1780             24  VD-INSURED-1ST-INIT PIC X.
  1781             24  FILLER             PIC X(9).
  1782         20  VD-INSURED-MIDDLE-INIT PIC X.
  1783     12  VD-JOINT-INSURED.
  1784         20 VD-JOINT-LAST-NAME      PIC X(15).
  1785         20 VD-JOINT-FIRST-NAME.
  1786            24  VD-JOINT-FIRST-INIT PIC X.
  1787            24  FILLER              PIC X(9).
  1788         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1789     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1790     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1791     12  VD-INSURED-CITY-STATE.
  1792         20  VD-INSURED-CITY        PIC X(28).
  1793         20  VD-INSURED-STATE       PIC XX.
  1794     12  VD-INSURED-ZIP-CODE.
  1795         20  VD-INSURED-ZIP-PRIME.
  1796             24  VD-INSURED-ZIP-1   PIC X.
  1797                 88  VD-CANADIAN-POST-CODE
  1798                                       VALUE 'A' THRU 'Z'.
  1799             24  FILLER             PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  33
* EL6311.cbl
  1800         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1801     12  VD-BENEFICIARY-NAME        PIC X(30).
  1802     12  VD-ACCOUNT-NAME            PIC X(30).
  1803     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1804     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1805     12  VD-1ST-PMT-DT              PIC XX.
  1806     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1807         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1808         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1809                                             '90' THRU '99'.
  1810     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1811                                    PIC XX.
  1812     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1813     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1814     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1815     12  VD-LF-TERM                 PIC S999   COMP-3.
  1816     12  VD-AH-BENEFIT-CD           PIC XX.
  1817         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1818         88  VD-INVALID-AH             VALUE '  ' '00'
  1819                                             '90' THRU '99'.
  1820     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1821     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1822     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1823     12  VD-AH-TERM                 PIC S999   COMP-3.
  1824     12  VD-LETTER-ID               PIC X(4).
  1825     12  VD-PROC-ID                 PIC X(4).
  1826     12  VD-COMP-ID                 PIC X(3).
  1827     12  VD-CURRENT-DATE            PIC XX.
  1828     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1829     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1830     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  34
* EL6311.cbl
  1832*    COPY ELCDATE.
  1833******************************************************************
  1834*                                                                *
  1835*                                                                *
  1836*                            ELCDATE.                            *
  1837*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1838*                            VMOD=2.003
  1839*                                                                *
  1840*                                                                *
  1841*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1842*                 LENGTH = 200                                   *
  1843******************************************************************
  1844
  1845 01  DATE-CONVERSION-DATA.
  1846     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1847     12  DC-OPTION-CODE                PIC X.
  1848         88  BIN-TO-GREG                VALUE ' '.
  1849         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1850         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1851         88  YMD-GREG-TO-BIN            VALUE '3'.
  1852         88  MDY-GREG-TO-BIN            VALUE '4'.
  1853         88  JULIAN-TO-BIN              VALUE '5'.
  1854         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1855         88  FIND-CENTURY               VALUE '7'.
  1856         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1857         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1858         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1859         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1860         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1861         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1862         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1863         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1864         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1865         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1866         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1867         88  BIN-3-TO-GREG              VALUE 'I'.
  1868         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1869         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1870         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1871         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1872         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1873         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1874         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1875         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1876         88  THREE-CHARACTER-BIN
  1877                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1878         88  GREGORIAN-TO-BIN
  1879                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1880         88  BIN-TO-GREGORIAN
  1881                  VALUES ' ' '1' 'I' '8' 'G'.
  1882         88  JULIAN-TO-BINARY
  1883                  VALUES '5' 'C' 'E' 'F'.
  1884     12  DC-ERROR-CODE                 PIC X.
  1885         88  NO-CONVERSION-ERROR        VALUE ' '.
  1886         88  DATE-CONVERSION-ERROR
  1887                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1888         88  DATE-IS-ZERO               VALUE '1'.
  1889         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  35
* EL6311.cbl
  1890         88  DATE-IS-INVALID            VALUE '3'.
  1891         88  DATE1-GREATER-DATE2        VALUE '4'.
  1892         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1893         88  DATE-INVALID-OPTION        VALUE '9'.
  1894         88  INVALID-CENTURY            VALUE 'A'.
  1895         88  ONLY-CENTURY               VALUE 'B'.
  1896         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1897         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1898     12  DC-END-OF-MONTH               PIC X.
  1899         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1900     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1901         88  USE-NORMAL-PROCESS         VALUE ' '.
  1902         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1903         88  ADJUST-UP-100-YRS          VALUE '2'.
  1904     12  FILLER                        PIC X.
  1905     12  DC-CONVERSION-DATES.
  1906         16  DC-BIN-DATE-1             PIC XX.
  1907         16  DC-BIN-DATE-2             PIC XX.
  1908         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1909         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1910                       DC-GREG-DATE-1-EDIT.
  1911             20  DC-EDIT1-MONTH        PIC 99.
  1912             20  SLASH1-1              PIC X.
  1913             20  DC-EDIT1-DAY          PIC 99.
  1914             20  SLASH1-2              PIC X.
  1915             20  DC-EDIT1-YEAR         PIC 99.
  1916         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1917         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1918                     DC-GREG-DATE-2-EDIT.
  1919             20  DC-EDIT2-MONTH        PIC 99.
  1920             20  SLASH2-1              PIC X.
  1921             20  DC-EDIT2-DAY          PIC 99.
  1922             20  SLASH2-2              PIC X.
  1923             20  DC-EDIT2-YEAR         PIC 99.
  1924         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1925         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1926                     DC-GREG-DATE-1-YMD.
  1927             20  DC-YMD-YEAR           PIC 99.
  1928             20  DC-YMD-MONTH          PIC 99.
  1929             20  DC-YMD-DAY            PIC 99.
  1930         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1931         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1932                      DC-GREG-DATE-1-MDY.
  1933             20  DC-MDY-MONTH          PIC 99.
  1934             20  DC-MDY-DAY            PIC 99.
  1935             20  DC-MDY-YEAR           PIC 99.
  1936         16  DC-GREG-DATE-1-ALPHA.
  1937             20  DC-ALPHA-MONTH        PIC X(10).
  1938             20  DC-ALPHA-DAY          PIC 99.
  1939             20  FILLER                PIC XX.
  1940             20  DC-ALPHA-CENTURY.
  1941                 24 DC-ALPHA-CEN-N     PIC 99.
  1942             20  DC-ALPHA-YEAR         PIC 99.
  1943         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1944         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1945         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1946         16  DC-JULIAN-DATE            PIC 9(05).
  1947         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  36
* EL6311.cbl
  1948                                       PIC 9(05).
  1949         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1950             20  DC-JULIAN-YEAR        PIC 99.
  1951             20  DC-JULIAN-DAYS        PIC 999.
  1952         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1953         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1954         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1955     12  DATE-CONVERSION-VARIBLES.
  1956         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1957         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1958             20  FILLER                PIC 9(3).
  1959             20  HOLD-CEN-1-CCYY.
  1960                 24  HOLD-CEN-1-CC     PIC 99.
  1961                 24  HOLD-CEN-1-YY     PIC 99.
  1962             20  HOLD-CEN-1-MO         PIC 99.
  1963             20  HOLD-CEN-1-DA         PIC 99.
  1964         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1965             20  HOLD-CEN-1-R-MO       PIC 99.
  1966             20  HOLD-CEN-1-R-DA       PIC 99.
  1967             20  HOLD-CEN-1-R-CCYY.
  1968                 24  HOLD-CEN-1-R-CC   PIC 99.
  1969                 24  HOLD-CEN-1-R-YY   PIC 99.
  1970             20  FILLER                PIC 9(3).
  1971         16  HOLD-CENTURY-1-X.
  1972             20  FILLER                PIC X(3)  VALUE SPACES.
  1973             20  HOLD-CEN-1-X-CCYY.
  1974                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1975                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1976             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1977             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1978         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1979             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1980             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1981             20  HOLD-CEN-1-R-X-CCYY.
  1982                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1983                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1984             20  FILLER                PIC XXX.
  1985         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1986         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1987         16  DC-JULIAN-DATE-1          PIC 9(07).
  1988         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1989             20  DC-JULIAN-1-CCYY.
  1990                 24  DC-JULIAN-1-CC    PIC 99.
  1991                 24  DC-JULIAN-1-YR    PIC 99.
  1992             20  DC-JULIAN-DA-1        PIC 999.
  1993         16  DC-JULIAN-DATE-2          PIC 9(07).
  1994         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1995             20  DC-JULIAN-2-CCYY.
  1996                 24  DC-JULIAN-2-CC    PIC 99.
  1997                 24  DC-JULIAN-2-YR    PIC 99.
  1998             20  DC-JULIAN-DA-2        PIC 999.
  1999         16  DC-GREG-DATE-A-EDIT.
  2000             20  DC-EDITA-MONTH        PIC 99.
  2001             20  SLASHA-1              PIC X VALUE '/'.
  2002             20  DC-EDITA-DAY          PIC 99.
  2003             20  SLASHA-2              PIC X VALUE '/'.
  2004             20  DC-EDITA-CCYY.
  2005                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  37
* EL6311.cbl
  2006                 24  DC-EDITA-YEAR     PIC 99.
  2007         16  DC-GREG-DATE-B-EDIT.
  2008             20  DC-EDITB-MONTH        PIC 99.
  2009             20  SLASHB-1              PIC X VALUE '/'.
  2010             20  DC-EDITB-DAY          PIC 99.
  2011             20  SLASHB-2              PIC X VALUE '/'.
  2012             20  DC-EDITB-CCYY.
  2013                 24  DC-EDITB-CENT     PIC 99.
  2014                 24  DC-EDITB-YEAR     PIC 99.
  2015         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2016         16  DC-GREG-DATE-CYMD-R REDEFINES
  2017                              DC-GREG-DATE-CYMD.
  2018             20  DC-CYMD-CEN           PIC 99.
  2019             20  DC-CYMD-YEAR          PIC 99.
  2020             20  DC-CYMD-MONTH         PIC 99.
  2021             20  DC-CYMD-DAY           PIC 99.
  2022         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2023         16  DC-GREG-DATE-MDCY-R REDEFINES
  2024                              DC-GREG-DATE-MDCY.
  2025             20  DC-MDCY-MONTH         PIC 99.
  2026             20  DC-MDCY-DAY           PIC 99.
  2027             20  DC-MDCY-CEN           PIC 99.
  2028             20  DC-MDCY-YEAR          PIC 99.
  2029    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2030        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2031    12  DC-EL310-DATE                  PIC X(21).
  2032    12  FILLER                         PIC X(28).
  2033
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  38
* EL6311.cbl
  2035*    COPY ELCLOGOF.
  2036******************************************************************
  2037*                                                                *
  2038*                                                                *
  2039*                            ELCLOGOF.                           *
  2040*                            VMOD=2.001                          *
  2041*                                                                *
  2042*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2043*                                                                *
  2044******************************************************************
  2045 01  CLASIC-LOGOFF.
  2046     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2047     12  LOGOFF-TEXT.
  2048         16  FILLER          PIC X(5)    VALUE SPACES.
  2049         16  LOGOFF-MSG.
  2050             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2051             20  FILLER      PIC X       VALUE SPACES.
  2052             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2053         16  FILLER          PIC X(80)
  2054           VALUE '* YOU ARE NOW LOGGED OFF'.
  2055         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2056         16  FILLER          PIC X       VALUE QUOTE.
  2057         16  LOGOFF-SYS-MSG  PIC X(17)
  2058           VALUE 'S CLAS-IC SYSTEM '.
  2059     12  TEXT-MESSAGES.
  2060         16  UNACCESS-MSG    PIC X(29)
  2061             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2062         16  PGMIDERR-MSG    PIC X(17)
  2063             VALUE 'PROGRAM NOT FOUND'.
  2064
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  39
* EL6311.cbl
  2066*    COPY ELCATTR.
  2067******************************************************************
  2068*                                                                *
  2069*                            ELCATTR.                            *
  2070*                            VMOD=2.001                          *
  2071*                                                                *
  2072*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2073*                                                                *
  2074*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2075*                                                                *
  2076*                   POS 1   P=PROTECTED                          *
  2077*                           U=UNPROTECTED                        *
  2078*                           S=ASKIP                              *
  2079*                   POS 2   A=ALPHA/NUMERIC                      *
  2080*                           N=NUMERIC                            *
  2081*                   POS 3   N=NORMAL                             *
  2082*                           B=BRIGHT                             *
  2083*                           D=DARK                               *
  2084*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2085*                           OF=MODIFIED DATA TAG OFF             *
  2086*                                                                *
  2087*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2088******************************************************************
  2089 01  ATTRIBUTE-LIST.
  2090     12  AL-PABOF            PIC X       VALUE 'Y'.
  2091     12  AL-PABON            PIC X       VALUE 'Z'.
  2092     12  AL-PADOF            PIC X       VALUE '%'.
  2093     12  AL-PADON            PIC X       VALUE '_'.
  2094     12  AL-PANOF            PIC X       VALUE '-'.
  2095     12  AL-PANON            PIC X       VALUE '/'.
  2096     12  AL-SABOF            PIC X       VALUE '8'.
  2097     12  AL-SABON            PIC X       VALUE '9'.
  2098     12  AL-SADOF            PIC X       VALUE '@'.
  2099     12  AL-SADON            PIC X       VALUE QUOTE.
  2100     12  AL-SANOF            PIC X       VALUE '0'.
  2101     12  AL-SANON            PIC X       VALUE '1'.
  2102     12  AL-UABOF            PIC X       VALUE 'H'.
  2103     12  AL-UABON            PIC X       VALUE 'I'.
  2104     12  AL-UADOF            PIC X       VALUE '<'.
  2105     12  AL-UADON            PIC X       VALUE '('.
  2106     12  AL-UANOF            PIC X       VALUE ' '.
  2107     12  AL-UANON            PIC X       VALUE 'A'.
  2108     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2109     12  AL-UNBON            PIC X       VALUE 'R'.
  2110     12  AL-UNDOF            PIC X       VALUE '*'.
  2111     12  AL-UNDON            PIC X       VALUE ')'.
  2112     12  AL-UNNOF            PIC X       VALUE '&'.
  2113     12  AL-UNNON            PIC X       VALUE 'J'.
  2114
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  40
* EL6311.cbl
  2116*    COPY ELCEMIB.
  2117******************************************************************
  2118*                                                                *
  2119*                                                                *
  2120*                            ELCEMIB.                            *
  2121*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2122*                            VMOD=2.005                          *
  2123*                                                                *
  2124*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2125*                                                                *
  2126******************************************************************
  2127 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2128     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2129     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2130     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2131     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2132     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2133     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2134     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2135     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2136     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2137         88  EMI-NO-ERRORS                    VALUE '1'.
  2138         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2139         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2140     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2141         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2142     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2143         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2144         88  EMI-AREA1-FULL                   VALUE '2'.
  2145     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2146         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2147         88  EMI-AREA2-FULL                   VALUE '2'.
  2148     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2149         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2150         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2151         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2152         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2153         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2154     12  EMI-ERROR-LINES.
  2155         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2156         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2157         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2158         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2159             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2160                 24  EMI-ERR-NUM         PIC X(4).
  2161                 24  EMI-FILLER          PIC X.
  2162                 24  EMI-SEV             PIC X.
  2163                 24  FILLER              PIC X.
  2164             20  FILLER                  PIC X(02).
  2165     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2166         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2167             20  EMI-ERROR-NUMBER    PIC X(4).
  2168             20  EMI-FILL            PIC X.
  2169             20  EMI-SEVERITY        PIC X.
  2170             20  FILLER              PIC X.
  2171             20  EMI-ERROR-TEXT.
  2172                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2173                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  41
* EL6311.cbl
  2174     12  EMI-SEVERITY-SAVE           PIC X.
  2175         88  EMI-NOTE                    VALUE 'N'.
  2176         88  EMI-WARNING                 VALUE 'W'.
  2177         88  EMI-FORCABLE                VALUE 'F'.
  2178         88  EMI-FATAL                   VALUE 'X'.
  2179     12  EMI-MESSAGE-FLAG            PIC X.
  2180         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2181         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2182     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2183     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2184         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2185         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2186         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2187     12  emi-claim-no                pic x(7).
  2188     12  emi-claim-type              pic x(6).
  2189     12  FILLER                      PIC X(124)  VALUE SPACES.
  2190     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2191     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2192     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2193     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2194
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  42
* EL6311.cbl
  2196*    COPY ELCINTF.
  2197******************************************************************
  2198*                                                                *
  2199*                                                                *
  2200*                            ELCINTF.                            *
  2201*                            VMOD=2.017                          *
  2202*                                                                *
  2203*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2204*                                                                *
  2205*       LENGTH = 1024                                            *
  2206*                                                                *
  2207******************************************************************
  2208*                   C H A N G E   L O G
  2209*
  2210* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2211*-----------------------------------------------------------------
  2212*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2213* EFFECTIVE    NUMBER
  2214*-----------------------------------------------------------------
  2215* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2216******************************************************************
  2217 01  PROGRAM-INTERFACE-BLOCK.
  2218     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2219     12  PI-CALLING-PROGRAM              PIC X(8).
  2220     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2221     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2222     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2223     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2224     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2225     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2226     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2227     12  PI-COMPANY-ID                   PIC XXX.
  2228     12  PI-COMPANY-CD                   PIC X.
  2229
  2230     12  PI-COMPANY-PASSWORD             PIC X(8).
  2231
  2232     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2233
  2234     12  PI-CONTROL-IN-PROGRESS.
  2235         16  PI-CARRIER                  PIC X.
  2236         16  PI-GROUPING                 PIC X(6).
  2237         16  PI-STATE                    PIC XX.
  2238         16  PI-ACCOUNT                  PIC X(10).
  2239         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2240                                         PIC X(10).
  2241         16  PI-CLAIM-CERT-GRP.
  2242             20  PI-CLAIM-NO             PIC X(7).
  2243             20  PI-CERT-NO.
  2244                 25  PI-CERT-PRIME       PIC X(10).
  2245                 25  PI-CERT-SFX         PIC X.
  2246             20  PI-CERT-EFF-DT          PIC XX.
  2247         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2248             20  PI-PLAN-CODE            PIC X(2).
  2249             20  PI-REVISION-NUMBER      PIC X(3).
  2250             20  PI-PLAN-EFF-DT          PIC X(2).
  2251             20  PI-PLAN-EXP-DT          PIC X(2).
  2252             20  FILLER                  PIC X(11).
  2253         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  43
* EL6311.cbl
  2254             20  PI-OE-REFERENCE-1.
  2255                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2256                 25  PI-OE-REF-1-SUFF    PIC XX.
  2257
  2258     12  PI-SESSION-IN-PROGRESS          PIC X.
  2259         88  CLAIM-SESSION                   VALUE '1'.
  2260         88  CREDIT-SESSION                  VALUE '2'.
  2261         88  WARRANTY-SESSION                VALUE '3'.
  2262         88  MORTGAGE-SESSION                VALUE '4'.
  2263         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2264
  2265
  2266*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2267
  2268     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2269     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2270
  2271     12  PI-CREDIT-USER                  PIC X.
  2272         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2273         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2274
  2275     12  PI-CLAIM-USER                   PIC X.
  2276         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2277         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2278
  2279     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2280         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2281         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2282         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2283         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2284         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2285
  2286     12  PI-PROCESSOR-ID                 PIC X(4).
  2287
  2288     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2289
  2290     12  PI-MEMBER-CAPTION               PIC X(10).
  2291
  2292     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2293         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2294
  2295     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2296     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2297     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2298     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2299
  2300     12  PI-AH-OVERRIDE-L1               PIC X.
  2301     12  PI-AH-OVERRIDE-L2               PIC XX.
  2302     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2303     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2304
  2305     12  PI-NEW-SYSTEM                   PIC X(2).
  2306
  2307     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2308     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2309         88  PI-USES-PAID-TO                 VALUE '1'.
  2310     12  PI-CRDTCRD-SYSTEM.
  2311         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  44
* EL6311.cbl
  2312             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2313             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2314         16  PI-CC-MONTH-END-DT          PIC XX.
  2315     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2316
  2317     12  PI-OE-REFERENCE-2.
  2318         16  PI-OE-REF-2-PRIME           PIC X(10).
  2319         16  PI-OE-REF-2-SUFF            PIC X.
  2320
  2321     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2322
  2323     12  PI-LANGUAGE-TYPE                PIC X.
  2324             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2325             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2326             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2327
  2328     12  PI-POLICY-LINKAGE-IND           PIC X.
  2329         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2330         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2331                                                   LOW-VALUES.
  2332
  2333     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2334     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2335         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2336         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2337
  2338     12  PI-PROCESSOR-CSR-IND            PIC X.
  2339         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2340         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2341
  2342     12  FILLER                          PIC X(3).
  2343
  2344     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2345
  2346     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2347         PI-SYSTEM-LEVEL.
  2348
  2349         16  PI-ENTRY-CODES.
  2350             20  PI-ENTRY-CD-1           PIC X.
  2351             20  PI-ENTRY-CD-2           PIC X.
  2352
  2353         16  PI-RETURN-CODES.
  2354             20  PI-RETURN-CD-1          PIC X.
  2355             20  PI-RETURN-CD-2          PIC X.
  2356
  2357         16  PI-UPDATE-STATUS-SAVE.
  2358             20  PI-UPDATE-BY            PIC X(4).
  2359             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2360
  2361         16  PI-LOWER-CASE-LETTERS       PIC X.
  2362             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2363
  2364*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2365*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2366*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2367
  2368         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2369             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  45
* EL6311.cbl
  2370             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2371             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2372             88  ACCNT-CNTL                  VALUE '3'.
  2373             88  CARR-ACCNT-CNTL             VALUE '4'.
  2374
  2375         16  PI-PROCESSOR-CAP-LIST.
  2376             20  PI-SYSTEM-CONTROLS.
  2377                24 PI-SYSTEM-DISPLAY     PIC X.
  2378                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2379                24 PI-SYSTEM-MODIFY      PIC X.
  2380                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2381             20  FILLER                  PIC XX.
  2382             20  PI-DISPLAY-CAP          PIC X.
  2383                 88  DISPLAY-CAP             VALUE 'Y'.
  2384             20  PI-MODIFY-CAP           PIC X.
  2385                 88  MODIFY-CAP              VALUE 'Y'.
  2386             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2387                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2388             20  PI-FORCE-CAP            PIC X.
  2389                 88  FORCE-CAP               VALUE 'Y'.
  2390
  2391         16  PI-PROGRAM-CONTROLS.
  2392             20  PI-PGM-PRINT-OPT        PIC X.
  2393             20  PI-PGM-FORMAT-OPT       PIC X.
  2394             20  PI-PGM-PROCESS-OPT      PIC X.
  2395             20  PI-PGM-TOTALS-OPT       PIC X.
  2396
  2397         16  PI-HELP-INTERFACE.
  2398             20  PI-LAST-ERROR-NO        PIC X(4).
  2399             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2400
  2401         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2402             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2403
  2404         16  PI-CR-CONTROL-IN-PROGRESS.
  2405             20  PI-CR-CARRIER           PIC X.
  2406             20  PI-CR-GROUPING          PIC X(6).
  2407             20  PI-CR-STATE             PIC XX.
  2408             20  PI-CR-ACCOUNT           PIC X(10).
  2409             20  PI-CR-FIN-RESP          PIC X(10).
  2410             20  PI-CR-TYPE              PIC X.
  2411
  2412         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2413
  2414         16  PI-CR-MONTH-END-DT          PIC XX.
  2415
  2416         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2417             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2418             88  PI-ZERO-CARRIER             VALUE '1'.
  2419             88  PI-ZERO-GROUPING            VALUE '2'.
  2420             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2421
  2422         16  PI-CARRIER-SECURITY         PIC X.
  2423             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2424
  2425         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2426             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2427             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  46
* EL6311.cbl
  2428
  2429         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2430             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2431                                         INDEXED BY PI-ACCESS-NDX
  2432                                         PIC X.
  2433
  2434         16  PI-GA-BILLING-CONTROL       PIC X.
  2435             88  PI-GA-BILLING               VALUE '1'.
  2436
  2437         16  PI-MAIL-PROCESSING          PIC X.
  2438             88  PI-MAIL-YES                 VALUE 'Y'.
  2439
  2440         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2441
  2442         16  PI-AR-SYSTEM.
  2443             20  PI-AR-PROCESSING-CNTL   PIC X.
  2444                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2445             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2446             20  PI-AR-MONTH-END-DT      PIC XX.
  2447
  2448         16  PI-MP-SYSTEM.
  2449             20  PI-MORTGAGE-USER            PIC X.
  2450                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2451                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2452             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2453                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2454                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2455                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2456                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2457                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2458             20  PI-MP-MONTH-END-DT          PIC XX.
  2459             20  PI-MP-REFERENCE-NO.
  2460                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2461                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2462
  2463         16  PI-LABEL-CONTROL            PIC X(01).
  2464             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2465             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2466
  2467         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2468             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2469
  2470         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2471             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2472             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2473
  2474         16  FILLER                      PIC X(14).
  2475
  2476     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2477******************************************************************
  2478
  2479     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2480*    COPY ELC631PI.
  2481******************************************************************
  2482*                                                                *
  2483*                                                                *
  2484*                            ELC631PI                            *
  2485*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  47
* EL6311.cbl
  2486*                                                                *
  2487*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2488*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2489*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2490*                                                                *
  2491*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2492*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2493*    BETWEEN PROGRAMS.                                           *
  2494*                                                                *
  2495*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2496*                                                                *
  2497*               EL631 - EL6311 - EL6312 - EL6313                 *
  2498*                                                                *
  2499******************************************************************
  2500
  2501         16  PI-631-DATA.
  2502             20  PI-ERPNDB-KEY.
  2503                 24  PI-PB-COMPANY-CD     PIC X.
  2504                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2505                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2506                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2507
  2508             20  PI-ERPNDB-ALT-KEY.
  2509                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2510                 24  PI-PB-CARRIER        PIC X.
  2511                 24  PI-PB-GROUPING       PIC X(6).
  2512                 24  PI-PB-STATE          PIC XX.
  2513                 24  PI-PB-ACCOUNT        PIC X(10).
  2514                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2515                 24  PI-PB-CERT-NO.
  2516                     28  PI-PB-CERT-PRIME PIC X(10).
  2517                     28  PI-PB-CERT-SFX   PIC X.
  2518                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2519                 24  PI-PB-RECORD-TYPE    PIC X.
  2520
  2521             20  PI-ERPNDB-CSR-KEY.
  2522                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2523                 24  PI-PB-CSR-ID             PIC X(4).
  2524                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2525                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2526                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2527
  2528             20  PI-BROWSE-TYPE               PIC X.
  2529                 88  PI-FILE-BROWSE             VALUE ' '.
  2530                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2531                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2532                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2533                 88  PI-CSR-BROWSE              VALUE '4'.
  2534
  2535             20  PI-MAINT-FUNCTION            PIC X.
  2536                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2537                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2538                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2539                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2540                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2541                 88  PI-PF5-FUNCTION            VALUE '5'.
  2542                 88  PI-PF6-FUNCTION            VALUE '6'.
  2543
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  48
* EL6311.cbl
  2544             20  PI-FILE-SWITCHES.
  2545                 24  PI-ALL-ISSUES-SW         PIC X.
  2546                     88  ALL-ISSUES             VALUE 'Y'.
  2547                 24  PI-ALL-CANCELS-SW        PIC X.
  2548                     88  ALL-CANCELS            VALUE 'Y'.
  2549                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2550                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2551                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2552                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2553                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2554                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2555                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2556                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2557                 24  PI-HOLD-REC-SW           PIC X.
  2558                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2559                 24  PI-CHANGE-REC-SW         PIC X.
  2560                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2561                 24  PI-CHK-REQ-REC-SW        PIC X.
  2562                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2563                 24  PI-ISSUE-WARNING-SW      PIC X.
  2564                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2565                 24  PI-CANCEL-WARNING-SW     PIC X.
  2566                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2567             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2568                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2569             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2570                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2571
  2572             20  PI-MAP-NAME                  PIC X(8).
  2573
  2574             20  PI-CURSOR                    PIC S9(4) COMP.
  2575
  2576             20  PI-PREV-ALT-KEY              PIC X(36).
  2577             20  PI-PREV-CSR-KEY              PIC X(15).
  2578             20  PI-PREV-KEY.
  2579                 24  PI-PREV-COMPANY-CD       PIC X.
  2580                 24  PI-PREV-BATCH            PIC X(6).
  2581                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2582                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2583             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2584             20  PI-BROWSE-SW                 PIC X.
  2585                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2586                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2587             20  PI-SV-CARRIER                PIC X.
  2588             20  PI-SV-GROUPING               PIC X(6).
  2589             20  PI-SV-STATE                  PIC XX.
  2590             20  PI-EDIT-SW                   PIC X.
  2591             20  PI-DISPLAY-SW                PIC XX.
  2592                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  2593                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2594             20  PI-CRITERIA-DATA             PIC X(350).
  2595             20  PI-BMODE                     PIC X.
  2596             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2597             20  PI-BPMTS                     PIC S999     COMP-3.
  2598             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2599             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2600             20  PI-CSR-SESSION-SW            PIC X.
  2601                 88  CSR-EDIT-SESSION           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  49
* EL6311.cbl
  2602             20  PI-ERRORS-SW                 PIC X.
  2603                 88  FATAL-ERRORS               VALUE 'X'.
  2604*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2605             20  FILLER                       PIC X(5).
  2606
  2607        16  FILLER             PIC X(94).
  2608
  2609 01  W-LETTER-COMMUNICATION-AREAS.
  2610*    COPY ELC1042.
  2611******************************************************************
  2612*                                                                *
  2613*                                                                *
  2614*                           ELC1042                              *
  2615*                            VMOD=2.002                          *
  2616*                                                                *
  2617*    NOTE                                                        *
  2618*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2619*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2620*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2621*        TO THESE PROGRAMS.                                      *
  2622*                                                                *
  2623*    NOTE                                                        *
  2624*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2625*        USE ONLY!                                               *
  2626*                                                                *
  2627******************************************************************
  2628
  2629         16  PI-1042-WA.
  2630             20  PI-ACTION       PIC  X(01).
  2631                 88 PI-SHOW-MODE           VALUE '1'.
  2632                 88 PI-CLEAR-MODE          VALUE '2'.
  2633                 88 PI-CREATE-MODE         VALUE '3'.
  2634             20  PI-COMM-CONTROL PIC  X(12).
  2635             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2636             20  PI-EOF-SW       PIC  X(01).
  2637                 88  PI-FILE-EOF           VALUE 'Y'.
  2638             20  PI-FILETYP      PIC  X(01).
  2639             20  PI-FORM-SQUEEZE-CONTROL
  2640                                 PIC  X(01).
  2641                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2642                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2643             20  PI-LAST-CONTROL PIC  X(12).
  2644             20  PI-TEMP-STOR-ITEMS
  2645                                 PIC S9(04) COMP.
  2646             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2647             20  PI-UPDATE-SW    PIC  9(01).
  2648                 88 ANY-UPDATES            VALUE 1.
  2649             20  PI-104-SCREEN-SENT-IND
  2650                                 PIC  X(01).
  2651                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2652                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2653             20  PI-1042-SCREEN-SENT-IND
  2654                                 PIC  X(01).
  2655                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2656                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2657             20  PI-1042-ARCHIVE-IND
  2658                                 PIC  X(01).
  2659                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  50
* EL6311.cbl
  2660             20  FILLER          PIC  X(29).
  2661*    COPY ELC689PI.
  2662******************************************************************
  2663*                                                                *
  2664*                            ELC689PI                            *
  2665*                            VMOD=2.003                          *
  2666*                                                                *
  2667*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2668*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2669*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2670*                                                                *
  2671*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2672*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2673*    BETWEEN PROGRAMS.                                           *
  2674*                                                                *
  2675*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2676*                                                                *
  2677*               EL631 - EL689  - EL6891 - EL6892                 *
  2678*                                                                *
  2679******************************************************************
  2680*                   C H A N G E   L O G
  2681*
  2682* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2683*-----------------------------------------------------------------
  2684*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2685* EFFECTIVE    NUMBER
  2686*-----------------------------------------------------------------
  2687* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2688* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2689* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2690******************************************************************
  2691
  2692
  2693         16  PI-689-WORK-AREA.
  2694             20  PI-689-ALT-PRINTER-ID
  2695                                 PIC  X(04).
  2696             20  PI-689-ARCHIVE-NUMBER
  2697                                 PIC  9(08).
  2698             20  PI-689-ARCHIVE-SW
  2699                                 PIC  X(01).
  2700                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2701             20  PI-689-DATA-SOURCE
  2702                                 PIC  X(01).
  2703                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2704                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2705                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2706                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2707                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2708             20  PI-689-ERROR-IND
  2709                                 PIC  X(01).
  2710                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2711             20  PI-689-ERROR    PIC  9(04).
  2712                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2713                 88  PI-689-FATAL-ERROR
  2714                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2715                            0042 0047 0051 0066 0067 0070
  2716                            0168 0169 0174 0175 0176 0177 0179
  2717                            0180 0181 0182 0184 0185 0189 0190
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  51
* EL6311.cbl
  2718                            0191
  2719                            0215 0279 0280
  2720                            0412 0413 0454
  2721                            0533 0537
  2722                            2055 2114 2208 2209 2216 2232 2369
  2723                            2398 2433 2908 2999
  2724                            3000 3770 3771 3775
  2725                            7250 7365 7367 7368 7369 7370 7371
  2726                            7272 7373 7374 7376 7377 7378 7379
  2727                            7381 7388 7390 7393 7395 7396 7398
  2728                            9095 9096 9281 9298 9299 9320 9327
  2729                            9426 9427.
  2730                 88  PI-689-STOP-ERROR
  2731                     VALUES 0004 0008 0013 0023 0029 0033
  2732                            0042 0047 0066 0067 0070
  2733                            0168 0169 0174 0175 0176 0177
  2734                            0181 0182 0184 0185 0189 0190
  2735                            0279 0280
  2736                            0412 0413 0454
  2737                            2055 2208 2209 2216 2232
  2738                            2398 2999
  2739                            3000 3770 3771 3775
  2740                            7250 7365 7369 7370 7371
  2741                            7272 7373 7374 7376 7377 7378 7379
  2742                            7381 7388 7390 7393 7396 7398
  2743                            9095 9096 9299 9320 9426.
  2744             20  PI-689-FOLLOW-UP-DATE
  2745                                 PIC  X(02).
  2746             20  PI-689-FORM-NUMBER
  2747                                 PIC  X(04).
  2748             20  PI-689-LABEL-SOURCE
  2749                                 PIC X(01).
  2750                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2751                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2752                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2753                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2754                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2755                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2756                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2757             20  PI-689-NUMBER-COPIES
  2758                                 PIC  9(01).
  2759             20  PI-689-NUMBER-LABEL-LINES
  2760                                 PIC  9(01).
  2761             20  PI-689-NUMBER-TEXT-RECORDS
  2762                                 PIC  9(03).
  2763             20  PI-689-PRINT-ORDER-SW
  2764                                 PIC  X(01).
  2765                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2766                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2767                 88  PI-689-PRINT-LATER     VALUE '3'.
  2768                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2769             20  PI-689-PRINT-RESTRICTION
  2770                                 PIC  X(01).
  2771                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2772                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2773                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2774             20  PI-689-PRINT-SW PIC  X(01).
  2775                 88  PI-689-PRINT-PERFORMED VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  52
* EL6311.cbl
  2776             20  PI-689-RESEND-DATE-1
  2777                                 PIC  X(02).
  2778             20  PI-689-RESEND-LETR-1
  2779                                 PIC X(4).
  2780             20  PI-689-TEMP-STOR-ID
  2781                                 PIC  X(08).
  2782             20  PI-689-USE-SCREEN-IND
  2783                                 PIC  X(01).
  2784                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2785             20  PI-689-ARCH-POINTER
  2786                                 PIC S9(08) COMP.
  2787                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2788             20  PI-689-ARCT-POINTER
  2789                                 PIC S9(08) COMP.
  2790                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2791             20  PI-689-VARIABLE-DATA-GRP.
  2792                 24  PI-689-VARIABLE-DATA-1
  2793                                 PIC  X(30).
  2794                 24  PI-689-VARIABLE-DATA-2
  2795                                 PIC  X(30).
  2796                 24  PI-689-VARIABLE-DATA-3
  2797                                 PIC  X(30).
  2798                 24  PI-689-VARIABLE-DATA-4
  2799                                 PIC  X(30).
  2800
  2801         16  PI-689-KEY-DATA-FIELDS.
  2802             20  PI-689-ACCOUNT  PIC  X(10).
  2803             20  PI-689-CARRIER  PIC  X(01).
  2804             20  PI-689-CERT-NO.
  2805                 24  PI-689-CERT-PRIME
  2806                                 PIC  X(10).
  2807                 24  PI-689-CERT-SFX
  2808                                 PIC  X(01).
  2809             20  PI-689-CHG-SEQ-NO
  2810                                 PIC S9(04)    COMP.
  2811             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2812                                 PIC  X(02).
  2813             20  PI-689-ENTRY-BATCH
  2814                                 PIC  X(06).
  2815             20  PI-689-EFF-DATE PIC  X(02).
  2816             20  PI-689-EXP-DATE PIC  X(02).
  2817             20  PI-689-GROUPING PIC  X(06).
  2818             20  PI-689-RESP-PERSON
  2819                                 PIC  X(10).
  2820             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2821             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2822                                 PIC  X(04).
  2823             20  PI-689-STATE    PIC  X(02).
  2824             20  PI-689-TYPE     PIC  X(01).
  2825             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2826             20  PI-689-ALT-SEQ-NO
  2827                                 PIC S9(04)    COMP.
  2828         16  PI-689-DATE-EDIT    PIC  X(08).
  2829         16  PI-689-FOLLOW-UP-EDIT
  2830                                 PIC  X(08).
  2831         16  PI-689-RESEND1-EDIT PIC  X(08).
  2832         16  PI-689-SEQ-EDIT     PIC  X(08).
  2833         16  PI-689-BCSEQ-EDIT   PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  53
* EL6311.cbl
  2834         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2835             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2836         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2837         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  54
* EL6311.cbl
  2839
  2840 01  WS-EL6315-PASS-AREA.
  2841        16  PI-6315-ISS-CAN-SW      PIC X.
  2842        16  FILLER                  PIC X(120).
  2843        16  PI-RES-REF-CLM-TYPE     PIC X.
  2844        16  FILLER                  PIC X.
  2845        16  PI-6315-PASS-AREA.
  2846            20 FILLER               PIC X(236).
  2847            20 PI-6315-FINALIZED    PIC X.
  2848            20 FILLER               PIC X(280).
  2849
  2850 01  WS-EL6316-PASS-AREA.
  2851        16  PI-ISS-CAN-SW           PIC X.
  2852        16  FILLER                  PIC X(121).
  2853        16  PI-CLM-RESC-IND         PIC X.
  2854        16  PI-6316-PASS-AREA.
  2855            20 FILLER               PIC X(236).
  2856            20 PI-6316-FINALIZED    PIC X.
  2857            20 FILLER               PIC X(280).
  2858
  2859******************************************************************
  2860*                                                                *
  2861*         P A S S   A R E A   F O R   E D I T                    *
  2862*                                                                *
  2863******************************************************************
  2864
  2865 01  PASSED-RECORD.
  2866     12  RECORD-SAVE                  PIC X(585).
  2867* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2868*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2869*                    BY  WK-CURRENT-DATE.
  2870******************************************************************
  2871*                                                                *
  2872*                                                                *
  2873*                             ELC50W1                            *
  2874*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2875*                            VMOD=2.004                          *
  2876*                                                                *
  2877*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2878*                                                                *
  2879*                                                                *
  2880******************************************************************
  2881
  2882     12  WK-WORK-AREA.
  2883         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2884         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2885         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2886         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2887         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2888         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2889         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2890         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2891         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2892         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2893         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2894         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2895         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2896         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  55
* EL6311.cbl
  2897         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2898         16  WK-CREDIT-EDIT-CONTROLS.
  2899             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2900             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2901             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2902             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2903             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2904             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2905         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2906         16  WK-SAVE-REIN-DATA.
  2907             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2908             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2909             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2910         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2911             88  ENTRY-FROM-EL6311       VALUE '6'.
  2912         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2913         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2914     12  WK-RECORD-ADDRESSES.
  2915         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2916         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2917         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2918         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2919         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2920         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2921         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2922         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2923     12  WK-OVER-SHORT-AREA.
  2924         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2925         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2926         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2927             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2928         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  56
* EL6311.cbl
  2930
  2931*    COPY ELCEDITC.
  2932******************************************************************
  2933*                                                                *
  2934*                                                                *
  2935*                            ELCEDITC                            *
  2936*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2937*                            VMOD=2.012                          *
  2938*                                                                *
  2939*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  2940*                     EL6313, EL050 AND EL517.                   *
  2941*                                                                *
  2942******************************************************************
  2943******************************************************************
  2944*                   C H A N G E   L O G
  2945*
  2946* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2947*-----------------------------------------------------------------
  2948*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2949* EFFECTIVE    NUMBER
  2950*-----------------------------------------------------------------
  2951* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2952******************************************************************
  2953
  2954     12  EDIT-CRITERIA-DATA.
  2955         16  EC-CO-MONTH-END-DT       PIC XX.
  2956         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  2957         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  2958         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  2959         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  2960         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  2961         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  2962         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  2963         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  2964         16  EC-CO-REM-TERM-CALC      PIC X.
  2965               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  2966               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  2967               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  2968               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  2969
  2970         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  2971               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  2972               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  2973               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  2974               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  2975               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  2976               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  2977               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  2978               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  2979               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  2980               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  2981
  2982         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  2983               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  2984               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  2985               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  2986               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  2987               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  57
* EL6311.cbl
  2988               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  2989               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  2990               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  2991
  2992         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  2993                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  2994                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  2995
  2996         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  2997                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  2998                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  2999                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3000                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3001                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3002                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3003                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3004                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3005
  3006         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3007               88  EC-BR-REDUCING                   VALUE 'R'.
  3008               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3009
  3010         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3011         16  EC-BR-LF-DESC             PIC X(10).
  3012         16  EC-BR-AH-DESC             PIC X(10).
  3013         16  EC-BR-LF-COMMENT          PIC X(10).
  3014         16  EC-BR-AH-COMMENT          PIC X(10).
  3015
  3016         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3017               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3018               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3019               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3020               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3021
  3022         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3023               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3024               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3025               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3026               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3027
  3028         16  EC-BR-LF-REFUND-CALC      PIC X.
  3029                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3030                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3031                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3032                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3033                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3034                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3035                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3036
  3037         16  EC-BR-AH-REFUND-CALC      PIC X.
  3038                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3039                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3040                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3041                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3042                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3043                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3044                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3045                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  58
* EL6311.cbl
  3046
  3047         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3048                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3049                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3050                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3051
  3052         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3053                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3054                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3055                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3056
  3057         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3058         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3059         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3060         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3061
  3062         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3063         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3064                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3065                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3066                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3067                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3068
  3069         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3070               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3071               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3072               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3073               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3074               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3075
  3076         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3077               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3078               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3079               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3080               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3081               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3082
  3083         16  EC-ST-LF-REFUND-CALC      PIC X.
  3084                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3085                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3086                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3087                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3088                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3089                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3090                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3091                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3092
  3093         16  EC-ST-AH-REFUND-CALC      PIC X.
  3094                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3095                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3096                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3097                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3098                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3099                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3100                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3101                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3102
  3103         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  59
* EL6311.cbl
  3104         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3105         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3106         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3107         16  EC-AM-EXPIRATION-DT       PIC XX.
  3108         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3109         16  EC-AM-CLASS-CD            PIC XX.
  3110         16  EC-AM-LF-DEVIATION        PIC XXX.
  3111         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3112         16  EC-AM-AH-DEVIATION        PIC XXX.
  3113         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3114         16  EC-AM-PHONE-NO            PIC X(10).
  3115
  3116         16  EC-AM-LF-REFUND-CALC      PIC X.
  3117                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3118                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3119                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3120                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3121                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3122                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3123                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3124
  3125         16  EC-AM-AH-REFUND-CALC      PIC X.
  3126                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3127                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3128                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3129                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3130                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3131                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3132                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3133
  3134         16  EC-AM-BEN-I-G-CD          PIC X.
  3135                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3136                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3137                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3138
  3139         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3140         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3141         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3142         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3143         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3144         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3145         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3146         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3147         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3148
  3149         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3150         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3151         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3152         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3153         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3154         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3155         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3156         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3157         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3158         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3159         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3160         16  EC-RT-LF-NSP-ST           PIC XX.
  3161         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  60
* EL6311.cbl
  3162         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3163         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3164
  3165         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3166             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3167                                             'M' '5' '9' '2'.
  3168             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3169             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3170             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3171             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3172             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3173             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3174             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3175             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3176             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3177             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3178
  3179         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3180             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3181                                             'M' '5' '9' '2'.
  3182             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3183             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3184             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3185             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3186             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3187             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3188             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3189             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3190             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3191             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3192
  3193         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3194         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3195         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3196         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3197         16  EC-CM-DEATH-DT            PIC XX.
  3198
  3199*DMD CUSTOM CODING FIELDS BELOW
  3200*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3201         16  EC-BR-DMD-RATING-SW       PIC X.
  3202                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3203                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3204                 88  NO-DMD-RATING               VALUE 'N'.
  3205
  3206         16  EC-NEW-CERT               PIC X(11).
  3207         16  EC-NEW-STATE              PIC XX.
  3208         16  FILLER                    PIC X.
  3209*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3210         16  OVER-SHORT-EDIT-FIELDS.
  3211             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3212             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3213             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3214             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3215             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3216             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3217             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3218             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3219             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  61
* EL6311.cbl
  3220         16  FILLER                    PIC X(71).
  3221
  3222******************************************************************
  3223
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  62
* EL6311.cbl
  3225
  3226*    COPY ELCJPFX.
  3227******************************************************************
  3228*                                                                *
  3229*                                                                *
  3230*                            ELCJPFX.                            *
  3231*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3232*                            VMOD=2.002                          *
  3233*                                                                *
  3234*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3235*                                                                *
  3236*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3237*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3238*        ELCNTL - CONTROL FILE                                   *
  3239*        ELMSTR - CLAIM MASTERS                                  *
  3240*        ELTRLR - ACTIVITY TRAILERS                              *
  3241*        ELCHKQ - CHECK QUE                                      *
  3242******************************************************************
  3243 01  JOURNAL-RECORD.
  3244     12  jp-date                     pic s9(5) comp-3.
  3245     12  jp-time                     pic s9(7) comp-3.
  3246     12  JP-USER-ID                  PIC X(4).
  3247     12  JP-FILE-ID                  PIC X(8).
  3248     12  JP-PROGRAM-ID               PIC X(8).
  3249     12  JP-RECORD-TYPE              PIC X.
  3250         88 JP-ADD              VALUE 'A'.
  3251         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3252         88 JP-AFTER-CHANGE     VALUE 'C'.
  3253         88 JP-DELETE           VALUE 'D'.
  3254         88 JP-GENERIC-DELETE   VALUE 'G'.
  3255         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3256         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3257     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3258     12  JP-RECORD-AREA
  3259
  3260
  3261                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  63
* EL6311.cbl
  3263*    COPY ELCAID.
  3264******************************************************************
  3265*                                                                *
  3266*                            ELCAID.                             *
  3267*                            VMOD=2.001                          *
  3268*                                                                *
  3269*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3270*                                                                *
  3271*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3272*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3273******************************************************************
  3274
  3275 01  DFHAID.
  3276   02  DFHNULL   PIC  X  VALUE  ' '.
  3277   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3278   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3279   02  DFHPEN    PIC  X  VALUE  '='.
  3280   02  DFHOPID   PIC  X  VALUE  'W'.
  3281   02  DFHPA1    PIC  X  VALUE  '%'.
  3282   02  DFHPA2    PIC  X  VALUE  '>'.
  3283   02  DFHPA3    PIC  X  VALUE  ','.
  3284   02  DFHPF1    PIC  X  VALUE  '1'.
  3285   02  DFHPF2    PIC  X  VALUE  '2'.
  3286   02  DFHPF3    PIC  X  VALUE  '3'.
  3287   02  DFHPF4    PIC  X  VALUE  '4'.
  3288   02  DFHPF5    PIC  X  VALUE  '5'.
  3289   02  DFHPF6    PIC  X  VALUE  '6'.
  3290   02  DFHPF7    PIC  X  VALUE  '7'.
  3291   02  DFHPF8    PIC  X  VALUE  '8'.
  3292   02  DFHPF9    PIC  X  VALUE  '9'.
  3293   02  DFHPF10   PIC  X  VALUE  ':'.
  3294   02  DFHPF11   PIC  X  VALUE  '#'.
  3295   02  DFHPF12   PIC  X  VALUE  '@'.
  3296   02  DFHPF13   PIC  X  VALUE  'A'.
  3297   02  DFHPF14   PIC  X  VALUE  'B'.
  3298   02  DFHPF15   PIC  X  VALUE  'C'.
  3299   02  DFHPF16   PIC  X  VALUE  'D'.
  3300   02  DFHPF17   PIC  X  VALUE  'E'.
  3301   02  DFHPF18   PIC  X  VALUE  'F'.
  3302   02  DFHPF19   PIC  X  VALUE  'G'.
  3303   02  DFHPF20   PIC  X  VALUE  'H'.
  3304   02  DFHPF21   PIC  X  VALUE  'I'.
  3305*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3306   02  DFHPF22   PIC  X  VALUE  '['.
  3307   02  DFHPF23   PIC  X  VALUE  '.'.
  3308   02  DFHPF24   PIC  X  VALUE  '<'.
  3309   02  DFHMSRE   PIC  X  VALUE  'X'.
  3310   02  DFHSTRF   PIC  X  VALUE  'h'.
  3311   02  DFHTRIG   PIC  X  VALUE  '"'.
  3312
  3313 01  FILLER    REDEFINES DFHAID.
  3314     12  FILLER              PIC X(8).
  3315     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3316
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  64
* EL6311.cbl
  3318*    COPY EL6311S.
  3319 01  EL631BI.
  3320     05  FILLER            PIC  X(0012).
  3321*    -------------------------------
  3322     05  BDATEL PIC S9(0004) COMP.
  3323     05  BDATEF PIC  X(0001).
  3324     05  FILLER REDEFINES BDATEF.
  3325         10  BDATEA PIC  X(0001).
  3326     05  BDATEI PIC  X(0008).
  3327*    -------------------------------
  3328     05  BTIMEL PIC S9(0004) COMP.
  3329     05  BTIMEF PIC  X(0001).
  3330     05  FILLER REDEFINES BTIMEF.
  3331         10  BTIMEA PIC  X(0001).
  3332     05  BTIMEI PIC  X(0005).
  3333*    -------------------------------
  3334     05  BHEADL PIC S9(0004) COMP.
  3335     05  BHEADF PIC  X(0001).
  3336     05  FILLER REDEFINES BHEADF.
  3337         10  BHEADA PIC  X(0001).
  3338     05  BHEADI PIC  X(0038).
  3339*    -------------------------------
  3340     05  BNCERTLL PIC S9(0004) COMP.
  3341     05  BNCERTLF PIC  X(0001).
  3342     05  FILLER REDEFINES BNCERTLF.
  3343         10  BNCERTLA PIC  X(0001).
  3344     05  BNCERTLI PIC  X(0008).
  3345*    -------------------------------
  3346     05  BNCERTL PIC S9(0004) COMP.
  3347     05  BNCERTF PIC  X(0001).
  3348     05  FILLER REDEFINES BNCERTF.
  3349         10  BNCERTA PIC  X(0001).
  3350     05  BNCERTI PIC  X(0011).
  3351*    -------------------------------
  3352     05  BNSTATLL PIC S9(0004) COMP.
  3353     05  BNSTATLF PIC  X(0001).
  3354     05  FILLER REDEFINES BNSTATLF.
  3355         10  BNSTATLA PIC  X(0001).
  3356     05  BNSTATLI PIC  X(0009).
  3357*    -------------------------------
  3358     05  BNSTATL PIC S9(0004) COMP.
  3359     05  BNSTATF PIC  X(0001).
  3360     05  FILLER REDEFINES BNSTATF.
  3361         10  BNSTATA PIC  X(0001).
  3362     05  BNSTATI PIC  X(0002).
  3363*    -------------------------------
  3364     05  BCHGTL PIC S9(0004) COMP.
  3365     05  BCHGTF PIC  X(0001).
  3366     05  FILLER REDEFINES BCHGTF.
  3367         10  BCHGTA PIC  X(0001).
  3368     05  BCHGTI PIC  X(0004).
  3369*    -------------------------------
  3370     05  BCHGL PIC S9(0004) COMP.
  3371     05  BCHGF PIC  X(0001).
  3372     05  FILLER REDEFINES BCHGF.
  3373         10  BCHGA PIC  X(0001).
  3374     05  BCHGI PIC  X(0004).
  3375*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  65
* EL6311.cbl
  3376     05  BMAINTL PIC S9(0004) COMP.
  3377     05  BMAINTF PIC  X(0001).
  3378     05  FILLER REDEFINES BMAINTF.
  3379         10  BMAINTA PIC  X(0001).
  3380     05  BMAINTI PIC  X(0001).
  3381*    -------------------------------
  3382     05  BMANTBYL PIC S9(0004) COMP.
  3383     05  BMANTBYF PIC  X(0001).
  3384     05  FILLER REDEFINES BMANTBYF.
  3385         10  BMANTBYA PIC  X(0001).
  3386     05  BMANTBYI PIC  X(0004).
  3387*    -------------------------------
  3388     05  BCHGHDGL PIC S9(0004) COMP.
  3389     05  BCHGHDGF PIC  X(0001).
  3390     05  FILLER REDEFINES BCHGHDGF.
  3391         10  BCHGHDGA PIC  X(0001).
  3392     05  BCHGHDGI PIC  X(0003).
  3393*    -------------------------------
  3394     05  BMANTDTL PIC S9(0004) COMP.
  3395     05  BMANTDTF PIC  X(0001).
  3396     05  FILLER REDEFINES BMANTDTF.
  3397         10  BMANTDTA PIC  X(0001).
  3398     05  BMANTDTI PIC  X(0008).
  3399*    -------------------------------
  3400     05  BMANTATL PIC S9(0004) COMP.
  3401     05  BMANTATF PIC  X(0001).
  3402     05  FILLER REDEFINES BMANTATF.
  3403         10  BMANTATA PIC  X(0001).
  3404     05  BMANTATI PIC  X(0005).
  3405*    -------------------------------
  3406     05  BCSRL PIC S9(0004) COMP.
  3407     05  BCSRF PIC  X(0001).
  3408     05  FILLER REDEFINES BCSRF.
  3409         10  BCSRA PIC  X(0001).
  3410     05  BCSRI PIC  X(0004).
  3411*    -------------------------------
  3412     05  BBATCHL PIC S9(0004) COMP.
  3413     05  BBATCHF PIC  X(0001).
  3414     05  FILLER REDEFINES BBATCHF.
  3415         10  BBATCHA PIC  X(0001).
  3416     05  BBATCHI PIC  X(0006).
  3417*    -------------------------------
  3418     05  BSEQL PIC S9(0004) COMP.
  3419     05  BSEQF PIC  X(0001).
  3420     05  FILLER REDEFINES BSEQF.
  3421         10  BSEQA PIC  X(0001).
  3422     05  BSEQI PIC  X(0004).
  3423*    -------------------------------
  3424     05  BMOENDTL PIC S9(0004) COMP.
  3425     05  BMOENDTF PIC  X(0001).
  3426     05  FILLER REDEFINES BMOENDTF.
  3427         10  BMOENDTA PIC  X(0001).
  3428     05  BMOENDTI PIC  X(0008).
  3429*    -------------------------------
  3430     05  BCARRL PIC S9(0004) COMP.
  3431     05  BCARRF PIC  X(0001).
  3432     05  FILLER REDEFINES BCARRF.
  3433         10  BCARRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  66
* EL6311.cbl
  3434     05  BCARRI PIC  X(0001).
  3435*    -------------------------------
  3436     05  BGROUPL PIC S9(0004) COMP.
  3437     05  BGROUPF PIC  X(0001).
  3438     05  FILLER REDEFINES BGROUPF.
  3439         10  BGROUPA PIC  X(0001).
  3440     05  BGROUPI PIC  X(0006).
  3441*    -------------------------------
  3442     05  BSTATEL PIC S9(0004) COMP.
  3443     05  BSTATEF PIC  X(0001).
  3444     05  FILLER REDEFINES BSTATEF.
  3445         10  BSTATEA PIC  X(0001).
  3446     05  BSTATEI PIC  X(0002).
  3447*    -------------------------------
  3448     05  BACCTL PIC S9(0004) COMP.
  3449     05  BACCTF PIC  X(0001).
  3450     05  FILLER REDEFINES BACCTF.
  3451         10  BACCTA PIC  X(0001).
  3452     05  BACCTI PIC  X(0010).
  3453*    -------------------------------
  3454     05  BVINHL PIC S9(0004) COMP.
  3455     05  BVINHF PIC  X(0001).
  3456     05  FILLER REDEFINES BVINHF.
  3457         10  BVINHA PIC  X(0001).
  3458     05  BVINHI PIC  X(0004).
  3459*    -------------------------------
  3460     05  BVINL PIC S9(0004) COMP.
  3461     05  BVINF PIC  X(0001).
  3462     05  FILLER REDEFINES BVINF.
  3463         10  BVINA PIC  X(0001).
  3464     05  BVINI PIC  X(0017).
  3465*    -------------------------------
  3466     05  BREFHDGL PIC S9(0004) COMP.
  3467     05  BREFHDGF PIC  X(0001).
  3468     05  FILLER REDEFINES BREFHDGF.
  3469         10  BREFHDGA PIC  X(0001).
  3470     05  BREFHDGI PIC  X(0004).
  3471*    -------------------------------
  3472     05  BREFL PIC S9(0004) COMP.
  3473     05  BREFF PIC  X(0001).
  3474     05  FILLER REDEFINES BREFF.
  3475         10  BREFA PIC  X(0001).
  3476     05  BREFI PIC  X(0012).
  3477*    -------------------------------
  3478     05  BAGEDEFL PIC S9(0004) COMP.
  3479     05  BAGEDEFF PIC  X(0001).
  3480     05  FILLER REDEFINES BAGEDEFF.
  3481         10  BAGEDEFA PIC  X(0001).
  3482     05  BAGEDEFI PIC  X(0004).
  3483*    -------------------------------
  3484     05  BCERTNOL PIC S9(0004) COMP.
  3485     05  BCERTNOF PIC  X(0001).
  3486     05  FILLER REDEFINES BCERTNOF.
  3487         10  BCERTNOA PIC  X(0001).
  3488     05  BCERTNOI PIC  X(0010).
  3489*    -------------------------------
  3490     05  BSUFIXL PIC S9(0004) COMP.
  3491     05  BSUFIXF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  67
* EL6311.cbl
  3492     05  FILLER REDEFINES BSUFIXF.
  3493         10  BSUFIXA PIC  X(0001).
  3494     05  BSUFIXI PIC  X(0001).
  3495*    -------------------------------
  3496     05  BEFFDTL PIC S9(0004) COMP.
  3497     05  BEFFDTF PIC  X(0001).
  3498     05  FILLER REDEFINES BEFFDTF.
  3499         10  BEFFDTA PIC  X(0001).
  3500     05  BEFFDTI PIC  X(0008).
  3501*    -------------------------------
  3502     05  BLSTNML PIC S9(0004) COMP.
  3503     05  BLSTNMF PIC  X(0001).
  3504     05  FILLER REDEFINES BLSTNMF.
  3505         10  BLSTNMA PIC  X(0001).
  3506     05  BLSTNMI PIC  X(0015).
  3507*    -------------------------------
  3508     05  B1STNML PIC S9(0004) COMP.
  3509     05  B1STNMF PIC  X(0001).
  3510     05  FILLER REDEFINES B1STNMF.
  3511         10  B1STNMA PIC  X(0001).
  3512     05  B1STNMI PIC  X(0010).
  3513*    -------------------------------
  3514     05  BINITL PIC S9(0004) COMP.
  3515     05  BINITF PIC  X(0001).
  3516     05  FILLER REDEFINES BINITF.
  3517         10  BINITA PIC  X(0001).
  3518     05  BINITI PIC  X(0001).
  3519*    -------------------------------
  3520     05  BSEXL PIC S9(0004) COMP.
  3521     05  BSEXF PIC  X(0001).
  3522     05  FILLER REDEFINES BSEXF.
  3523         10  BSEXA PIC  X(0001).
  3524     05  BSEXI PIC  X(0001).
  3525*    -------------------------------
  3526     05  BAGEL PIC S9(0004) COMP.
  3527     05  BAGEF PIC  X(0001).
  3528     05  FILLER REDEFINES BAGEF.
  3529         10  BAGEA PIC  X(0001).
  3530     05  BAGEI PIC  X(0002).
  3531*    -------------------------------
  3532     05  BBIRTHL PIC S9(0004) COMP.
  3533     05  BBIRTHF PIC  X(0001).
  3534     05  FILLER REDEFINES BBIRTHF.
  3535         10  BBIRTHA PIC  X(0001).
  3536     05  BBIRTHI PIC  X(0008).
  3537*    -------------------------------
  3538     05  B1STPMTL PIC S9(0004) COMP.
  3539     05  B1STPMTF PIC  X(0001).
  3540     05  FILLER REDEFINES B1STPMTF.
  3541         10  B1STPMTA PIC  X(0001).
  3542     05  B1STPMTI PIC  X(0008).
  3543*    -------------------------------
  3544     05  BDAYSL PIC S9(0004) COMP.
  3545     05  BDAYSF PIC  X(0001).
  3546     05  FILLER REDEFINES BDAYSF.
  3547         10  BDAYSA PIC  X(0001).
  3548     05  BDAYSI PIC  X(0003).
  3549*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  68
* EL6311.cbl
  3550     05  BLNTRML PIC S9(0004) COMP.
  3551     05  BLNTRMF PIC  X(0001).
  3552     05  FILLER REDEFINES BLNTRMF.
  3553         10  BLNTRMA PIC  X(0001).
  3554     05  BLNTRMI PIC  X(0003).
  3555*    -------------------------------
  3556     05  BLNOFCRL PIC S9(0004) COMP.
  3557     05  BLNOFCRF PIC  X(0001).
  3558     05  FILLER REDEFINES BLNOFCRF.
  3559         10  BLNOFCRA PIC  X(0001).
  3560     05  BLNOFCRI PIC  X(0005).
  3561*    -------------------------------
  3562     05  BMODEL PIC S9(0004) COMP.
  3563     05  BMODEF PIC  X(0001).
  3564     05  FILLER REDEFINES BMODEF.
  3565         10  BMODEA PIC  X(0001).
  3566     05  BMODEI PIC  X(0001).
  3567*    -------------------------------
  3568     05  BFREQL PIC S9(0004) COMP.
  3569     05  BFREQF PIC  X(0001).
  3570     05  FILLER REDEFINES BFREQF.
  3571         10  BFREQA PIC  X(0001).
  3572     05  BFREQI PIC  X(0002).
  3573*    -------------------------------
  3574     05  BPMTSL PIC S9(0004) COMP.
  3575     05  BPMTSF PIC  X(0001).
  3576     05  FILLER REDEFINES BPMTSF.
  3577         10  BPMTSA PIC  X(0001).
  3578     05  BPMTSI PIC  999.
  3579*    -------------------------------
  3580     05  BPMTAMTL PIC S9(0004) COMP.
  3581     05  BPMTAMTF PIC  X(0001).
  3582     05  FILLER REDEFINES BPMTAMTF.
  3583         10  BPMTAMTA PIC  X(0001).
  3584     05  BPMTAMTI PIC  9(7)V99.
  3585*    -------------------------------
  3586     05  BAPRL PIC S9(0004) COMP.
  3587     05  BAPRF PIC  X(0001).
  3588     05  FILLER REDEFINES BAPRF.
  3589         10  BAPRA PIC  X(0001).
  3590     05  BAPRI PIC  X(7).
  3591*    -------------------------------
  3592     05  BLIVESL PIC S9(0004) COMP.
  3593     05  BLIVESF PIC  X(0001).
  3594     05  FILLER REDEFINES BLIVESF.
  3595         10  BLIVESA PIC  X(0001).
  3596     05  BLIVESI PIC  X(0009).
  3597*    -------------------------------
  3598     05  BMEMCAPL PIC S9(0004) COMP.
  3599     05  BMEMCAPF PIC  X(0001).
  3600     05  FILLER REDEFINES BMEMCAPF.
  3601         10  BMEMCAPA PIC  X(0001).
  3602     05  BMEMCAPI PIC  X(0011).
  3603*    -------------------------------
  3604     05  BORIGHDL PIC S9(0004) COMP.
  3605     05  BORIGHDF PIC  X(0001).
  3606     05  FILLER REDEFINES BORIGHDF.
  3607         10  BORIGHDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  69
* EL6311.cbl
  3608     05  BORIGHDI PIC  X(0009).
  3609*    -------------------------------
  3610     05  DMDBILL PIC S9(0004) COMP.
  3611     05  DMDBILF PIC  X(0001).
  3612     05  FILLER REDEFINES DMDBILF.
  3613         10  DMDBILA PIC  X(0001).
  3614     05  DMDBILI PIC  X(0006).
  3615*    -------------------------------
  3616     05  BFORCEL PIC S9(0004) COMP.
  3617     05  BFORCEF PIC  X(0001).
  3618     05  FILLER REDEFINES BFORCEF.
  3619         10  BFORCEA PIC  X(0001).
  3620     05  BFORCEI PIC  X(0001).
  3621*    -------------------------------
  3622     05  BENTRYL PIC S9(0004) COMP.
  3623     05  BENTRYF PIC  X(0001).
  3624     05  FILLER REDEFINES BENTRYF.
  3625         10  BENTRYA PIC  X(0001).
  3626     05  BENTRYI PIC  X(0001).
  3627*    -------------------------------
  3628     05  BREINL PIC S9(0004) COMP.
  3629     05  BREINF PIC  X(0001).
  3630     05  FILLER REDEFINES BREINF.
  3631         10  BREINA PIC  X(0001).
  3632     05  BREINI PIC  X(0001).
  3633*    -------------------------------
  3634     05  BBILCDL PIC S9(0004) COMP.
  3635     05  BBILCDF PIC  X(0001).
  3636     05  FILLER REDEFINES BBILCDF.
  3637         10  BBILCDA PIC  X(0001).
  3638     05  BBILCDI PIC  X(0001).
  3639*    -------------------------------
  3640     05  BUNWRITL PIC S9(0004) COMP.
  3641     05  BUNWRITF PIC  X(0001).
  3642     05  FILLER REDEFINES BUNWRITF.
  3643         10  BUNWRITA PIC  X(0001).
  3644     05  BUNWRITI PIC  X(0001).
  3645*    -------------------------------
  3646     05  BSKPCDL PIC S9(0004) COMP.
  3647     05  BSKPCDF PIC  X(0001).
  3648     05  FILLER REDEFINES BSKPCDF.
  3649         10  BSKPCDA PIC  X(0001).
  3650     05  BSKPCDI PIC  X(0001).
  3651*    -------------------------------
  3652     05  BINDGRPL PIC S9(0004) COMP.
  3653     05  BINDGRPF PIC  X(0001).
  3654     05  FILLER REDEFINES BINDGRPF.
  3655         10  BINDGRPA PIC  X(0001).
  3656     05  BINDGRPI PIC  X(0001).
  3657*    -------------------------------
  3658     05  BSIGL PIC S9(0004) COMP.
  3659     05  BSIGF PIC  X(0001).
  3660     05  FILLER REDEFINES BSIGF.
  3661         10  BSIGA PIC  X(0001).
  3662     05  BSIGI PIC  X(0001).
  3663*    -------------------------------
  3664     05  BRTCLSL PIC S9(0004) COMP.
  3665     05  BRTCLSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  70
* EL6311.cbl
  3666     05  FILLER REDEFINES BRTCLSF.
  3667         10  BRTCLSA PIC  X(0001).
  3668     05  BRTCLSI PIC  X(0002).
  3669*    -------------------------------
  3670     05  BCHGCNTL PIC S9(0004) COMP.
  3671     05  BCHGCNTF PIC  X(0001).
  3672     05  FILLER REDEFINES BCHGCNTF.
  3673         10  BCHGCNTA PIC  X(0001).
  3674     05  BCHGCNTI PIC  X(0003).
  3675*    -------------------------------
  3676     05  BMEMBERL PIC S9(0004) COMP.
  3677     05  BMEMBERF PIC  X(0001).
  3678     05  FILLER REDEFINES BMEMBERF.
  3679         10  BMEMBERA PIC  X(0001).
  3680     05  BMEMBERI PIC  X(0012).
  3681*    -------------------------------
  3682     05  BORGNOL PIC S9(0004) COMP.
  3683     05  BORGNOF PIC  X(0001).
  3684     05  FILLER REDEFINES BORGNOF.
  3685         10  BORGNOA PIC  X(0001).
  3686     05  BORGNOI PIC  X(0006).
  3687*    -------------------------------
  3688     05  BORGSEQL PIC S9(0004) COMP.
  3689     05  BORGSEQF PIC  X(0001).
  3690     05  FILLER REDEFINES BORGSEQF.
  3691         10  BORGSEQA PIC  X(0001).
  3692     05  BORGSEQI PIC  X(0004).
  3693*    -------------------------------
  3694     05  BBILLEDL PIC S9(0004) COMP.
  3695     05  BBILLEDF PIC  X(0001).
  3696     05  FILLER REDEFINES BBILLEDF.
  3697         10  BBILLEDA PIC  X(0001).
  3698     05  BBILLEDI PIC  9(9).
  3699*    -------------------------------
  3700     05  BKIND1L PIC S9(0004) COMP.
  3701     05  BKIND1F PIC  X(0001).
  3702     05  FILLER REDEFINES BKIND1F.
  3703         10  BKIND1A PIC  X(0001).
  3704     05  BKIND1I PIC  X(0002).
  3705*    -------------------------------
  3706     05  BTYPE1L PIC S9(0004) COMP.
  3707     05  BTYPE1F PIC  X(0001).
  3708     05  FILLER REDEFINES BTYPE1F.
  3709         10  BTYPE1A PIC  X(0001).
  3710     05  BTYPE1I PIC  X(0003).
  3711*    -------------------------------
  3712     05  BTERM1L PIC S9(0004) COMP.
  3713     05  BTERM1F PIC  X(0001).
  3714     05  FILLER REDEFINES BTERM1F.
  3715         10  BTERM1A PIC  X(0001).
  3716     05  BTERM1I PIC  X(0003).
  3717*    -------------------------------
  3718     05  BBEN1L PIC S9(0004) COMP.
  3719     05  BBEN1F PIC  X(0001).
  3720     05  FILLER REDEFINES BBEN1F.
  3721         10  BBEN1A PIC  X(0001).
  3722     05  BBEN1I PIC  X(0012).
  3723*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  71
* EL6311.cbl
  3724     05  BPREM1L PIC S9(0004) COMP.
  3725     05  BPREM1F PIC  X(0001).
  3726     05  FILLER REDEFINES BPREM1F.
  3727         10  BPREM1A PIC  X(0001).
  3728     05  BPREM1I PIC  X(0011).
  3729*    -------------------------------
  3730     05  BEXPIR1L PIC S9(0004) COMP.
  3731     05  BEXPIR1F PIC  X(0001).
  3732     05  FILLER REDEFINES BEXPIR1F.
  3733         10  BEXPIR1A PIC  X(0001).
  3734     05  BEXPIR1I PIC  X(0008).
  3735*    -------------------------------
  3736     05  BCP1L PIC S9(0004) COMP.
  3737     05  BCP1F PIC  X(0001).
  3738     05  FILLER REDEFINES BCP1F.
  3739         10  BCP1A PIC  X(0001).
  3740     05  BCP1I PIC  X(0002).
  3741*    -------------------------------
  3742     05  BALTBN1L PIC S9(0004) COMP.
  3743     05  BALTBN1F PIC  X(0001).
  3744     05  FILLER REDEFINES BALTBN1F.
  3745         10  BALTBN1A PIC  X(0001).
  3746     05  BALTBN1I PIC  X(0012).
  3747*    -------------------------------
  3748     05  BALTPR1L PIC S9(0004) COMP.
  3749     05  BALTPR1F PIC  X(0001).
  3750     05  FILLER REDEFINES BALTPR1F.
  3751         10  BALTPR1A PIC  X(0001).
  3752     05  BALTPR1I PIC  X(0011).
  3753*    -------------------------------
  3754     05  BBNCD1L PIC S9(0004) COMP.
  3755     05  BBNCD1F PIC  X(0001).
  3756     05  FILLER REDEFINES BBNCD1F.
  3757         10  BBNCD1A PIC  X(0001).
  3758     05  BBNCD1I PIC  X(0003).
  3759*    -------------------------------
  3760     05  BCPRM1L PIC S9(0004) COMP.
  3761     05  BCPRM1F PIC  X(0001).
  3762     05  FILLER REDEFINES BCPRM1F.
  3763         10  BCPRM1A PIC  X(0001).
  3764     05  BCPRM1I PIC  X(0011).
  3765*    -------------------------------
  3766     05  BCAPRM1L PIC S9(0004) COMP.
  3767     05  BCAPRM1F PIC  X(0001).
  3768     05  FILLER REDEFINES BCAPRM1F.
  3769         10  BCAPRM1A PIC  X(0001).
  3770     05  BCAPRM1I PIC  X(0011).
  3771*    -------------------------------
  3772     05  BENABR1L PIC S9(0004) COMP.
  3773     05  BENABR1F PIC  X(0001).
  3774     05  FILLER REDEFINES BENABR1F.
  3775         10  BENABR1A PIC  X(0001).
  3776     05  BENABR1I PIC  X(0005).
  3777*    -------------------------------
  3778     05  BDIFF1L PIC S9(0004) COMP.
  3779     05  BDIFF1F PIC  X(0001).
  3780     05  FILLER REDEFINES BDIFF1F.
  3781         10  BDIFF1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  72
* EL6311.cbl
  3782     05  BDIFF1I PIC  X(0011).
  3783*    -------------------------------
  3784     05  BBILIT1L PIC S9(0004) COMP.
  3785     05  BBILIT1F PIC  X(0001).
  3786     05  FILLER REDEFINES BBILIT1F.
  3787         10  BBILIT1A PIC  X(0001).
  3788     05  BBILIT1I PIC  X(0008).
  3789*    -------------------------------
  3790     05  BADIFF1L PIC S9(0004) COMP.
  3791     05  BADIFF1F PIC  X(0001).
  3792     05  FILLER REDEFINES BADIFF1F.
  3793         10  BADIFF1A PIC  X(0001).
  3794     05  BADIFF1I PIC  X(0011).
  3795*    -------------------------------
  3796     05  BKIND2L PIC S9(0004) COMP.
  3797     05  BKIND2F PIC  X(0001).
  3798     05  FILLER REDEFINES BKIND2F.
  3799         10  BKIND2A PIC  X(0001).
  3800     05  BKIND2I PIC  X(0002).
  3801*    -------------------------------
  3802     05  BTYPE2L PIC S9(0004) COMP.
  3803     05  BTYPE2F PIC  X(0001).
  3804     05  FILLER REDEFINES BTYPE2F.
  3805         10  BTYPE2A PIC  X(0001).
  3806     05  BTYPE2I PIC  X(0003).
  3807*    -------------------------------
  3808     05  BTERM2L PIC S9(0004) COMP.
  3809     05  BTERM2F PIC  X(0001).
  3810     05  FILLER REDEFINES BTERM2F.
  3811         10  BTERM2A PIC  X(0001).
  3812     05  BTERM2I PIC  X(0003).
  3813*    -------------------------------
  3814     05  BBEN2L PIC S9(0004) COMP.
  3815     05  BBEN2F PIC  X(0001).
  3816     05  FILLER REDEFINES BBEN2F.
  3817         10  BBEN2A PIC  X(0001).
  3818     05  BBEN2I PIC  X(0012).
  3819*    -------------------------------
  3820     05  BPREM2L PIC S9(0004) COMP.
  3821     05  BPREM2F PIC  X(0001).
  3822     05  FILLER REDEFINES BPREM2F.
  3823         10  BPREM2A PIC  X(0001).
  3824     05  BPREM2I PIC  X(0011).
  3825*    -------------------------------
  3826     05  BEXPIR2L PIC S9(0004) COMP.
  3827     05  BEXPIR2F PIC  X(0001).
  3828     05  FILLER REDEFINES BEXPIR2F.
  3829         10  BEXPIR2A PIC  X(0001).
  3830     05  BEXPIR2I PIC  X(0008).
  3831*    -------------------------------
  3832     05  BCP2L PIC S9(0004) COMP.
  3833     05  BCP2F PIC  X(0001).
  3834     05  FILLER REDEFINES BCP2F.
  3835         10  BCP2A PIC  X(0001).
  3836     05  BCP2I PIC  X(0002).
  3837*    -------------------------------
  3838     05  BALTBN2L PIC S9(0004) COMP.
  3839     05  BALTBN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  73
* EL6311.cbl
  3840     05  FILLER REDEFINES BALTBN2F.
  3841         10  BALTBN2A PIC  X(0001).
  3842     05  BALTBN2I PIC  X(0012).
  3843*    -------------------------------
  3844     05  BALTPR2L PIC S9(0004) COMP.
  3845     05  BALTPR2F PIC  X(0001).
  3846     05  FILLER REDEFINES BALTPR2F.
  3847         10  BALTPR2A PIC  X(0001).
  3848     05  BALTPR2I PIC  X(0011).
  3849*    -------------------------------
  3850     05  BBNCD2L PIC S9(0004) COMP.
  3851     05  BBNCD2F PIC  X(0001).
  3852     05  FILLER REDEFINES BBNCD2F.
  3853         10  BBNCD2A PIC  X(0001).
  3854     05  BBNCD2I PIC  X(0003).
  3855*    -------------------------------
  3856     05  BCPRM2L PIC S9(0004) COMP.
  3857     05  BCPRM2F PIC  X(0001).
  3858     05  FILLER REDEFINES BCPRM2F.
  3859         10  BCPRM2A PIC  X(0001).
  3860     05  BCPRM2I PIC  X(0011).
  3861*    -------------------------------
  3862     05  BCAPRM2L PIC S9(0004) COMP.
  3863     05  BCAPRM2F PIC  X(0001).
  3864     05  FILLER REDEFINES BCAPRM2F.
  3865         10  BCAPRM2A PIC  X(0001).
  3866     05  BCAPRM2I PIC  X(0011).
  3867*    -------------------------------
  3868     05  BENABR2L PIC S9(0004) COMP.
  3869     05  BENABR2F PIC  X(0001).
  3870     05  FILLER REDEFINES BENABR2F.
  3871         10  BENABR2A PIC  X(0001).
  3872     05  BENABR2I PIC  X(0005).
  3873*    -------------------------------
  3874     05  BDIFF2L PIC S9(0004) COMP.
  3875     05  BDIFF2F PIC  X(0001).
  3876     05  FILLER REDEFINES BDIFF2F.
  3877         10  BDIFF2A PIC  X(0001).
  3878     05  BDIFF2I PIC  X(0011).
  3879*    -------------------------------
  3880     05  BBILIT2L PIC S9(0004) COMP.
  3881     05  BBILIT2F PIC  X(0001).
  3882     05  FILLER REDEFINES BBILIT2F.
  3883         10  BBILIT2A PIC  X(0001).
  3884     05  BBILIT2I PIC  X(0008).
  3885*    -------------------------------
  3886     05  BADIFF2L PIC S9(0004) COMP.
  3887     05  BADIFF2F PIC  X(0001).
  3888     05  FILLER REDEFINES BADIFF2F.
  3889         10  BADIFF2A PIC  X(0001).
  3890     05  BADIFF2I PIC  X(0011).
  3891*    -------------------------------
  3892     05  BERMSG1L PIC S9(0004) COMP.
  3893     05  BERMSG1F PIC  X(0001).
  3894     05  FILLER REDEFINES BERMSG1F.
  3895         10  BERMSG1A PIC  X(0001).
  3896     05  BERMSG1I PIC  X(0078).
  3897*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  74
* EL6311.cbl
  3898     05  BERMSG2L PIC S9(0004) COMP.
  3899     05  BERMSG2F PIC  X(0001).
  3900     05  FILLER REDEFINES BERMSG2F.
  3901         10  BERMSG2A PIC  X(0001).
  3902     05  BERMSG2I PIC  X(0078).
  3903*    -------------------------------
  3904     05  BERMSG3L PIC S9(0004) COMP.
  3905     05  BERMSG3F PIC  X(0001).
  3906     05  FILLER REDEFINES BERMSG3F.
  3907         10  BERMSG3A PIC  X(0001).
  3908     05  BERMSG3I PIC  X(0078).
  3909*    -------------------------------
  3910     05  BPFENTRL PIC S9(0004) COMP.
  3911     05  BPFENTRF PIC  X(0001).
  3912     05  FILLER REDEFINES BPFENTRF.
  3913         10  BPFENTRA PIC  X(0001).
  3914     05  BPFENTRI PIC  9(2).
  3915*    -------------------------------
  3916     05  BPF5HDRL PIC S9(0004) COMP.
  3917     05  BPF5HDRF PIC  X(0001).
  3918     05  FILLER REDEFINES BPF5HDRF.
  3919         10  BPF5HDRA PIC  X(0001).
  3920     05  BPF5HDRI PIC  X(0005).
  3921*    -------------------------------
  3922     05  BPF4HDRL PIC S9(0004) COMP.
  3923     05  BPF4HDRF PIC  X(0001).
  3924     05  FILLER REDEFINES BPF4HDRF.
  3925         10  BPF4HDRA PIC  X(0001).
  3926     05  BPF4HDRI PIC  X(0013).
  3927*    -------------------------------
  3928     05  BF15HDRL PIC S9(0004) COMP.
  3929     05  BF15HDRF PIC  X(0001).
  3930     05  FILLER REDEFINES BF15HDRF.
  3931         10  BF15HDRA PIC  X(0001).
  3932     05  BF15HDRI PIC  X(0010).
  3933 01  EL631BO REDEFINES EL631BI.
  3934     05  FILLER            PIC  X(0012).
  3935*    -------------------------------
  3936     05  FILLER            PIC  X(0003).
  3937     05  BDATEO PIC  X(0008).
  3938*    -------------------------------
  3939     05  FILLER            PIC  X(0003).
  3940     05  BTIMEO PIC  99.99.
  3941*    -------------------------------
  3942     05  FILLER            PIC  X(0003).
  3943     05  BHEADO PIC  X(0038).
  3944*    -------------------------------
  3945     05  FILLER            PIC  X(0003).
  3946     05  BNCERTLO PIC  X(0008).
  3947*    -------------------------------
  3948     05  FILLER            PIC  X(0003).
  3949     05  BNCERTO PIC  X(0011).
  3950*    -------------------------------
  3951     05  FILLER            PIC  X(0003).
  3952     05  BNSTATLO PIC  X(0009).
  3953*    -------------------------------
  3954     05  FILLER            PIC  X(0003).
  3955     05  BNSTATO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  75
* EL6311.cbl
  3956*    -------------------------------
  3957     05  FILLER            PIC  X(0003).
  3958     05  BCHGTO PIC  X(0004).
  3959*    -------------------------------
  3960     05  FILLER            PIC  X(0003).
  3961     05  BCHGO PIC  ZZZ9.
  3962*    -------------------------------
  3963     05  FILLER            PIC  X(0003).
  3964     05  BMAINTO PIC  X(0001).
  3965*    -------------------------------
  3966     05  FILLER            PIC  X(0003).
  3967     05  BMANTBYO PIC  X(0004).
  3968*    -------------------------------
  3969     05  FILLER            PIC  X(0003).
  3970     05  BCHGHDGO PIC  X(0003).
  3971*    -------------------------------
  3972     05  FILLER            PIC  X(0003).
  3973     05  BMANTDTO PIC  X(0008).
  3974*    -------------------------------
  3975     05  FILLER            PIC  X(0003).
  3976     05  BMANTATO PIC  99.99.
  3977*    -------------------------------
  3978     05  FILLER            PIC  X(0003).
  3979     05  BCSRO PIC  X(0004).
  3980*    -------------------------------
  3981     05  FILLER            PIC  X(0003).
  3982     05  BBATCHO PIC  X(0006).
  3983*    -------------------------------
  3984     05  FILLER            PIC  X(0003).
  3985     05  BSEQO PIC  X(0004).
  3986*    -------------------------------
  3987     05  FILLER            PIC  X(0003).
  3988     05  BMOENDTO PIC  X(0008).
  3989*    -------------------------------
  3990     05  FILLER            PIC  X(0003).
  3991     05  BCARRO PIC  X(0001).
  3992*    -------------------------------
  3993     05  FILLER            PIC  X(0003).
  3994     05  BGROUPO PIC  X(0006).
  3995*    -------------------------------
  3996     05  FILLER            PIC  X(0003).
  3997     05  BSTATEO PIC  X(0002).
  3998*    -------------------------------
  3999     05  FILLER            PIC  X(0003).
  4000     05  BACCTO PIC  X(0010).
  4001*    -------------------------------
  4002     05  FILLER            PIC  X(0003).
  4003     05  BVINHO PIC  X(0004).
  4004*    -------------------------------
  4005     05  FILLER            PIC  X(0003).
  4006     05  BVINO PIC  X(0017).
  4007*    -------------------------------
  4008     05  FILLER            PIC  X(0003).
  4009     05  BREFHDGO PIC  X(0004).
  4010*    -------------------------------
  4011     05  FILLER            PIC  X(0003).
  4012     05  BREFO PIC  X(0012).
  4013*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  76
* EL6311.cbl
  4014     05  FILLER            PIC  X(0003).
  4015     05  BAGEDEFO PIC  X(0004).
  4016*    -------------------------------
  4017     05  FILLER            PIC  X(0003).
  4018     05  BCERTNOO PIC  X(0010).
  4019*    -------------------------------
  4020     05  FILLER            PIC  X(0003).
  4021     05  BSUFIXO PIC  X(0001).
  4022*    -------------------------------
  4023     05  FILLER            PIC  X(0003).
  4024     05  BEFFDTO PIC  X(0008).
  4025*    -------------------------------
  4026     05  FILLER            PIC  X(0003).
  4027     05  BLSTNMO PIC  X(0015).
  4028*    -------------------------------
  4029     05  FILLER            PIC  X(0003).
  4030     05  B1STNMO PIC  X(0010).
  4031*    -------------------------------
  4032     05  FILLER            PIC  X(0003).
  4033     05  BINITO PIC  X(0001).
  4034*    -------------------------------
  4035     05  FILLER            PIC  X(0003).
  4036     05  BSEXO PIC  X(0001).
  4037*    -------------------------------
  4038     05  FILLER            PIC  X(0003).
  4039     05  BAGEO PIC  X(0002).
  4040*    -------------------------------
  4041     05  FILLER            PIC  X(0003).
  4042     05  BBIRTHO PIC  X(0008).
  4043*    -------------------------------
  4044     05  FILLER            PIC  X(0003).
  4045     05  B1STPMTO PIC  X(0008).
  4046*    -------------------------------
  4047     05  FILLER            PIC  X(0003).
  4048     05  BDAYSO PIC  X(0003).
  4049*    -------------------------------
  4050     05  FILLER            PIC  X(0003).
  4051     05  BLNTRMO PIC  X(0003).
  4052*    -------------------------------
  4053     05  FILLER            PIC  X(0003).
  4054     05  BLNOFCRO PIC  X(0005).
  4055*    -------------------------------
  4056     05  FILLER            PIC  X(0003).
  4057     05  BMODEO PIC  X(0001).
  4058*    -------------------------------
  4059     05  FILLER            PIC  X(0003).
  4060     05  BFREQO PIC  X(0002).
  4061*    -------------------------------
  4062     05  FILLER            PIC  X(0003).
  4063     05  BPMTSO PIC  X(0003).
  4064*    -------------------------------
  4065     05  FILLER            PIC  X(0003).
  4066     05  BPMTAMTO PIC  ZZZZZ9.99.
  4067*    -------------------------------
  4068     05  FILLER            PIC  X(0003).
  4069     05  BAPRO PIC  99.9999.
  4070*    -------------------------------
  4071     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  77
* EL6311.cbl
  4072     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4073*    -------------------------------
  4074     05  FILLER            PIC  X(0003).
  4075     05  BMEMCAPO PIC  X(0011).
  4076*    -------------------------------
  4077     05  FILLER            PIC  X(0003).
  4078     05  BORIGHDO PIC  X(0009).
  4079*    -------------------------------
  4080     05  FILLER            PIC  X(0003).
  4081     05  DMDBILO PIC  X(0006).
  4082*    -------------------------------
  4083     05  FILLER            PIC  X(0003).
  4084     05  BFORCEO PIC  X(0001).
  4085*    -------------------------------
  4086     05  FILLER            PIC  X(0003).
  4087     05  BENTRYO PIC  X(0001).
  4088*    -------------------------------
  4089     05  FILLER            PIC  X(0003).
  4090     05  BREINO PIC  X(0001).
  4091*    -------------------------------
  4092     05  FILLER            PIC  X(0003).
  4093     05  BBILCDO PIC  X(0001).
  4094*    -------------------------------
  4095     05  FILLER            PIC  X(0003).
  4096     05  BUNWRITO PIC  X(0001).
  4097*    -------------------------------
  4098     05  FILLER            PIC  X(0003).
  4099     05  BSKPCDO PIC  X(0001).
  4100*    -------------------------------
  4101     05  FILLER            PIC  X(0003).
  4102     05  BINDGRPO PIC  X(0001).
  4103*    -------------------------------
  4104     05  FILLER            PIC  X(0003).
  4105     05  BSIGO PIC  X(0001).
  4106*    -------------------------------
  4107     05  FILLER            PIC  X(0003).
  4108     05  BRTCLSO PIC  X(0002).
  4109*    -------------------------------
  4110     05  FILLER            PIC  X(0003).
  4111     05  BCHGCNTO PIC  X(0003).
  4112*    -------------------------------
  4113     05  FILLER            PIC  X(0003).
  4114     05  BMEMBERO PIC  X(0012).
  4115*    -------------------------------
  4116     05  FILLER            PIC  X(0003).
  4117     05  BORGNOO PIC  X(0006).
  4118*    -------------------------------
  4119     05  FILLER            PIC  X(0003).
  4120     05  BORGSEQO PIC  X(0004).
  4121*    -------------------------------
  4122     05  FILLER            PIC  X(0003).
  4123     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4124*    -------------------------------
  4125     05  FILLER            PIC  X(0003).
  4126     05  BKIND1O PIC  X(0002).
  4127*    -------------------------------
  4128     05  FILLER            PIC  X(0003).
  4129     05  BTYPE1O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  78
* EL6311.cbl
  4130*    -------------------------------
  4131     05  FILLER            PIC  X(0003).
  4132     05  BTERM1O PIC  X(0003).
  4133*    -------------------------------
  4134     05  FILLER            PIC  X(0003).
  4135     05  BBEN1O PIC  X(0012).
  4136*    -------------------------------
  4137     05  FILLER            PIC  X(0003).
  4138     05  BPREM1O PIC  X(0011).
  4139*    -------------------------------
  4140     05  FILLER            PIC  X(0003).
  4141     05  BEXPIR1O PIC  X(0008).
  4142*    -------------------------------
  4143     05  FILLER            PIC  X(0003).
  4144     05  BCP1O PIC  X(0002).
  4145*    -------------------------------
  4146     05  FILLER            PIC  X(0003).
  4147     05  BALTBN1O PIC  X(0012).
  4148*    -------------------------------
  4149     05  FILLER            PIC  X(0003).
  4150     05  BALTPR1O PIC  X(0011).
  4151*    -------------------------------
  4152     05  FILLER            PIC  X(0003).
  4153     05  BBNCD1O PIC  X(0003).
  4154*    -------------------------------
  4155     05  FILLER            PIC  X(0003).
  4156     05  BCPRM1O PIC  X(0011).
  4157*    -------------------------------
  4158     05  FILLER            PIC  X(0003).
  4159     05  BCAPRM1O PIC  X(0011).
  4160*    -------------------------------
  4161     05  FILLER            PIC  X(0003).
  4162     05  BENABR1O PIC  X(0005).
  4163*    -------------------------------
  4164     05  FILLER            PIC  X(0003).
  4165     05  BDIFF1O PIC  X(0011).
  4166*    -------------------------------
  4167     05  FILLER            PIC  X(0003).
  4168     05  BBILIT1O PIC  X(0008).
  4169*    -------------------------------
  4170     05  FILLER            PIC  X(0003).
  4171     05  BADIFF1O PIC  X(0011).
  4172*    -------------------------------
  4173     05  FILLER            PIC  X(0003).
  4174     05  BKIND2O PIC  X(0002).
  4175*    -------------------------------
  4176     05  FILLER            PIC  X(0003).
  4177     05  BTYPE2O PIC  X(0003).
  4178*    -------------------------------
  4179     05  FILLER            PIC  X(0003).
  4180     05  BTERM2O PIC  X(0003).
  4181*    -------------------------------
  4182     05  FILLER            PIC  X(0003).
  4183     05  BBEN2O PIC  X(0012).
  4184*    -------------------------------
  4185     05  FILLER            PIC  X(0003).
  4186     05  BPREM2O PIC  X(0011).
  4187*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  79
* EL6311.cbl
  4188     05  FILLER            PIC  X(0003).
  4189     05  BEXPIR2O PIC  X(0008).
  4190*    -------------------------------
  4191     05  FILLER            PIC  X(0003).
  4192     05  BCP2O PIC  X(0002).
  4193*    -------------------------------
  4194     05  FILLER            PIC  X(0003).
  4195     05  BALTBN2O PIC  X(0012).
  4196*    -------------------------------
  4197     05  FILLER            PIC  X(0003).
  4198     05  BALTPR2O PIC  X(0011).
  4199*    -------------------------------
  4200     05  FILLER            PIC  X(0003).
  4201     05  BBNCD2O PIC  X(0003).
  4202*    -------------------------------
  4203     05  FILLER            PIC  X(0003).
  4204     05  BCPRM2O PIC  X(0011).
  4205*    -------------------------------
  4206     05  FILLER            PIC  X(0003).
  4207     05  BCAPRM2O PIC  X(0011).
  4208*    -------------------------------
  4209     05  FILLER            PIC  X(0003).
  4210     05  BENABR2O PIC  X(0005).
  4211*    -------------------------------
  4212     05  FILLER            PIC  X(0003).
  4213     05  BDIFF2O PIC  X(0011).
  4214*    -------------------------------
  4215     05  FILLER            PIC  X(0003).
  4216     05  BBILIT2O PIC  X(0008).
  4217*    -------------------------------
  4218     05  FILLER            PIC  X(0003).
  4219     05  BADIFF2O PIC  X(0011).
  4220*    -------------------------------
  4221     05  FILLER            PIC  X(0003).
  4222     05  BERMSG1O PIC  X(0078).
  4223*    -------------------------------
  4224     05  FILLER            PIC  X(0003).
  4225     05  BERMSG2O PIC  X(0078).
  4226*    -------------------------------
  4227     05  FILLER            PIC  X(0003).
  4228     05  BERMSG3O PIC  X(0078).
  4229*    -------------------------------
  4230     05  FILLER            PIC  X(0003).
  4231     05  BPFENTRO PIC  X(0002).
  4232*    -------------------------------
  4233     05  FILLER            PIC  X(0003).
  4234     05  BPF5HDRO PIC  X(0005).
  4235*    -------------------------------
  4236     05  FILLER            PIC  X(0003).
  4237     05  BPF4HDRO PIC  X(0013).
  4238*    -------------------------------
  4239     05  FILLER            PIC  X(0003).
  4240     05  BF15HDRO PIC  X(0010).
  4241*    -------------------------------
  4242 01  EL631CI REDEFINES EL631BI.
  4243     05  FILLER            PIC  X(0012).
  4244*    -------------------------------
  4245     05  CDATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  80
* EL6311.cbl
  4246     05  CDATEF PIC  X(0001).
  4247     05  FILLER REDEFINES CDATEF.
  4248         10  CDATEA PIC  X(0001).
  4249     05  CDATEI PIC  X(0008).
  4250*    -------------------------------
  4251     05  CTIMEL PIC S9(0004) COMP.
  4252     05  CTIMEF PIC  X(0001).
  4253     05  FILLER REDEFINES CTIMEF.
  4254         10  CTIMEA PIC  X(0001).
  4255     05  CTIMEI PIC  X(0005).
  4256*    -------------------------------
  4257     05  CHEADL PIC S9(0004) COMP.
  4258     05  CHEADF PIC  X(0001).
  4259     05  FILLER REDEFINES CHEADF.
  4260         10  CHEADA PIC  X(0001).
  4261     05  CHEADI PIC  X(0038).
  4262*    -------------------------------
  4263     05  CCHGTL PIC S9(0004) COMP.
  4264     05  CCHGTF PIC  X(0001).
  4265     05  FILLER REDEFINES CCHGTF.
  4266         10  CCHGTA PIC  X(0001).
  4267     05  CCHGTI PIC  X(0004).
  4268*    -------------------------------
  4269     05  CCHGL PIC S9(0004) COMP.
  4270     05  CCHGF PIC  X(0001).
  4271     05  FILLER REDEFINES CCHGF.
  4272         10  CCHGA PIC  X(0001).
  4273     05  CCHGI PIC  X(0004).
  4274*    -------------------------------
  4275     05  CMAINTL PIC S9(0004) COMP.
  4276     05  CMAINTF PIC  X(0001).
  4277     05  FILLER REDEFINES CMAINTF.
  4278         10  CMAINTA PIC  X(0001).
  4279     05  CMAINTI PIC  X(0001).
  4280*    -------------------------------
  4281     05  CMANTBYL PIC S9(0004) COMP.
  4282     05  CMANTBYF PIC  X(0001).
  4283     05  FILLER REDEFINES CMANTBYF.
  4284         10  CMANTBYA PIC  X(0001).
  4285     05  CMANTBYI PIC  X(0004).
  4286*    -------------------------------
  4287     05  CCHGHDGL PIC S9(0004) COMP.
  4288     05  CCHGHDGF PIC  X(0001).
  4289     05  FILLER REDEFINES CCHGHDGF.
  4290         10  CCHGHDGA PIC  X(0001).
  4291     05  CCHGHDGI PIC  X(0003).
  4292*    -------------------------------
  4293     05  CMANTDTL PIC S9(0004) COMP.
  4294     05  CMANTDTF PIC  X(0001).
  4295     05  FILLER REDEFINES CMANTDTF.
  4296         10  CMANTDTA PIC  X(0001).
  4297     05  CMANTDTI PIC  X(0008).
  4298*    -------------------------------
  4299     05  CMANTATL PIC S9(0004) COMP.
  4300     05  CMANTATF PIC  X(0001).
  4301     05  FILLER REDEFINES CMANTATF.
  4302         10  CMANTATA PIC  X(0001).
  4303     05  CMANTATI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  81
* EL6311.cbl
  4304*    -------------------------------
  4305     05  CCSRL PIC S9(0004) COMP.
  4306     05  CCSRF PIC  X(0001).
  4307     05  FILLER REDEFINES CCSRF.
  4308         10  CCSRA PIC  X(0001).
  4309     05  CCSRI PIC  X(0004).
  4310*    -------------------------------
  4311     05  CBATCHL PIC S9(0004) COMP.
  4312     05  CBATCHF PIC  X(0001).
  4313     05  FILLER REDEFINES CBATCHF.
  4314         10  CBATCHA PIC  X(0001).
  4315     05  CBATCHI PIC  X(0006).
  4316*    -------------------------------
  4317     05  CSEQL PIC S9(0004) COMP.
  4318     05  CSEQF PIC  X(0001).
  4319     05  FILLER REDEFINES CSEQF.
  4320         10  CSEQA PIC  X(0001).
  4321     05  CSEQI PIC  X(0004).
  4322*    -------------------------------
  4323     05  CMOENDTL PIC S9(0004) COMP.
  4324     05  CMOENDTF PIC  X(0001).
  4325     05  FILLER REDEFINES CMOENDTF.
  4326         10  CMOENDTA PIC  X(0001).
  4327     05  CMOENDTI PIC  X(0008).
  4328*    -------------------------------
  4329     05  CCARRL PIC S9(0004) COMP.
  4330     05  CCARRF PIC  X(0001).
  4331     05  FILLER REDEFINES CCARRF.
  4332         10  CCARRA PIC  X(0001).
  4333     05  CCARRI PIC  X(0001).
  4334*    -------------------------------
  4335     05  CGROUPL PIC S9(0004) COMP.
  4336     05  CGROUPF PIC  X(0001).
  4337     05  FILLER REDEFINES CGROUPF.
  4338         10  CGROUPA PIC  X(0001).
  4339     05  CGROUPI PIC  X(0006).
  4340*    -------------------------------
  4341     05  CSTATEL PIC S9(0004) COMP.
  4342     05  CSTATEF PIC  X(0001).
  4343     05  FILLER REDEFINES CSTATEF.
  4344         10  CSTATEA PIC  X(0001).
  4345     05  CSTATEI PIC  X(0002).
  4346*    -------------------------------
  4347     05  CACCTL PIC S9(0004) COMP.
  4348     05  CACCTF PIC  X(0001).
  4349     05  FILLER REDEFINES CACCTF.
  4350         10  CACCTA PIC  X(0001).
  4351     05  CACCTI PIC  X(0010).
  4352*    -------------------------------
  4353     05  CORIGHDL PIC S9(0004) COMP.
  4354     05  CORIGHDF PIC  X(0001).
  4355     05  FILLER REDEFINES CORIGHDF.
  4356         10  CORIGHDA PIC  X(0001).
  4357     05  CORIGHDI PIC  X(0011).
  4358*    -------------------------------
  4359     05  CORGNOL PIC S9(0004) COMP.
  4360     05  CORGNOF PIC  X(0001).
  4361     05  FILLER REDEFINES CORGNOF.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  82
* EL6311.cbl
  4362         10  CORGNOA PIC  X(0001).
  4363     05  CORGNOI PIC  X(0006).
  4364*    -------------------------------
  4365     05  CORGSEQL PIC S9(0004) COMP.
  4366     05  CORGSEQF PIC  X(0001).
  4367     05  FILLER REDEFINES CORGSEQF.
  4368         10  CORGSEQA PIC  X(0001).
  4369     05  CORGSEQI PIC  X(0004).
  4370*    -------------------------------
  4371     05  CREFHDGL PIC S9(0004) COMP.
  4372     05  CREFHDGF PIC  X(0001).
  4373     05  FILLER REDEFINES CREFHDGF.
  4374         10  CREFHDGA PIC  X(0001).
  4375     05  CREFHDGI PIC  X(0010).
  4376*    -------------------------------
  4377     05  CREFL PIC S9(0004) COMP.
  4378     05  CREFF PIC  X(0001).
  4379     05  FILLER REDEFINES CREFF.
  4380         10  CREFA PIC  X(0001).
  4381     05  CREFI PIC  X(0012).
  4382*    -------------------------------
  4383     05  CNHINTL PIC S9(0004) COMP.
  4384     05  CNHINTF PIC  X(0001).
  4385     05  FILLER REDEFINES CNHINTF.
  4386         10  CNHINTA PIC  X(0001).
  4387     05  CNHINTI PIC  9(7)V99.
  4388*    -------------------------------
  4389     05  CCERTNOL PIC S9(0004) COMP.
  4390     05  CCERTNOF PIC  X(0001).
  4391     05  FILLER REDEFINES CCERTNOF.
  4392         10  CCERTNOA PIC  X(0001).
  4393     05  CCERTNOI PIC  X(0010).
  4394*    -------------------------------
  4395     05  CSUFIXL PIC S9(0004) COMP.
  4396     05  CSUFIXF PIC  X(0001).
  4397     05  FILLER REDEFINES CSUFIXF.
  4398         10  CSUFIXA PIC  X(0001).
  4399     05  CSUFIXI PIC  X(0001).
  4400*    -------------------------------
  4401     05  CEFFDTL PIC S9(0004) COMP.
  4402     05  CEFFDTF PIC  X(0001).
  4403     05  FILLER REDEFINES CEFFDTF.
  4404         10  CEFFDTA PIC  X(0001).
  4405     05  CEFFDTI PIC  X(0008).
  4406*    -------------------------------
  4407     05  CLSTNML PIC S9(0004) COMP.
  4408     05  CLSTNMF PIC  X(0001).
  4409     05  FILLER REDEFINES CLSTNMF.
  4410         10  CLSTNMA PIC  X(0001).
  4411     05  CLSTNMI PIC  X(0015).
  4412*    -------------------------------
  4413     05  CPCYNL PIC S9(0004) COMP.
  4414     05  CPCYNF PIC  X(0001).
  4415     05  FILLER REDEFINES CPCYNF.
  4416         10  CPCYNA PIC  X(0001).
  4417     05  CPCYNI PIC  X(0001).
  4418*    -------------------------------
  4419     05  CINAMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  83
* EL6311.cbl
  4420     05  CINAMEF PIC  X(0001).
  4421     05  FILLER REDEFINES CINAMEF.
  4422         10  CINAMEA PIC  X(0001).
  4423     05  CINAMEI PIC  X(0015).
  4424*    -------------------------------
  4425     05  CINITSL PIC S9(0004) COMP.
  4426     05  CINITSF PIC  X(0001).
  4427     05  FILLER REDEFINES CINITSF.
  4428         10  CINITSA PIC  X(0001).
  4429     05  CINITSI PIC  X(0010).
  4430*    -------------------------------
  4431     05  CCANREAL PIC S9(0004) COMP.
  4432     05  CCANREAF PIC  X(0001).
  4433     05  FILLER REDEFINES CCANREAF.
  4434         10  CCANREAA PIC  X(0001).
  4435     05  CCANREAI PIC  X(0001).
  4436*    -------------------------------
  4437     05  CKIND1L PIC S9(0004) COMP.
  4438     05  CKIND1F PIC  X(0001).
  4439     05  FILLER REDEFINES CKIND1F.
  4440         10  CKIND1A PIC  X(0001).
  4441     05  CKIND1I PIC  X(0002).
  4442*    -------------------------------
  4443     05  CCANDT1L PIC S9(0004) COMP.
  4444     05  CCANDT1F PIC  X(0001).
  4445     05  FILLER REDEFINES CCANDT1F.
  4446         10  CCANDT1A PIC  X(0001).
  4447     05  CCANDT1I PIC  X(0008).
  4448*    -------------------------------
  4449     05  CREFND1L PIC S9(0004) COMP.
  4450     05  CREFND1F PIC  X(0001).
  4451     05  FILLER REDEFINES CREFND1F.
  4452         10  CREFND1A PIC  X(0001).
  4453     05  CREFND1I PIC  S9(9)V99.
  4454*    -------------------------------
  4455     05  CMTHD1L PIC S9(0004) COMP.
  4456     05  CMTHD1F PIC  X(0001).
  4457     05  FILLER REDEFINES CMTHD1F.
  4458         10  CMTHD1A PIC  X(0001).
  4459     05  CMTHD1I PIC  X(0001).
  4460*    -------------------------------
  4461     05  CKIND2L PIC S9(0004) COMP.
  4462     05  CKIND2F PIC  X(0001).
  4463     05  FILLER REDEFINES CKIND2F.
  4464         10  CKIND2A PIC  X(0001).
  4465     05  CKIND2I PIC  X(0002).
  4466*    -------------------------------
  4467     05  CCANDT2L PIC S9(0004) COMP.
  4468     05  CCANDT2F PIC  X(0001).
  4469     05  FILLER REDEFINES CCANDT2F.
  4470         10  CCANDT2A PIC  X(0001).
  4471     05  CCANDT2I PIC  X(0008).
  4472*    -------------------------------
  4473     05  CREFND2L PIC S9(0004) COMP.
  4474     05  CREFND2F PIC  X(0001).
  4475     05  FILLER REDEFINES CREFND2F.
  4476         10  CREFND2A PIC  X(0001).
  4477     05  CREFND2I PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  84
* EL6311.cbl
  4478*    -------------------------------
  4479     05  CMTHD2L PIC S9(0004) COMP.
  4480     05  CMTHD2F PIC  X(0001).
  4481     05  FILLER REDEFINES CMTHD2F.
  4482         10  CMTHD2A PIC  X(0001).
  4483     05  CMTHD2I PIC  X(0001).
  4484*    -------------------------------
  4485     05  CLIVESL PIC S9(0004) COMP.
  4486     05  CLIVESF PIC  X(0001).
  4487     05  FILLER REDEFINES CLIVESF.
  4488         10  CLIVESA PIC  X(0001).
  4489     05  CLIVESI PIC  X(0003).
  4490*    -------------------------------
  4491     05  CFORCEL PIC S9(0004) COMP.
  4492     05  CFORCEF PIC  X(0001).
  4493     05  FILLER REDEFINES CFORCEF.
  4494         10  CFORCEA PIC  X(0001).
  4495     05  CFORCEI PIC  X(0001).
  4496*    -------------------------------
  4497     05  CBILCDL PIC S9(0004) COMP.
  4498     05  CBILCDF PIC  X(0001).
  4499     05  FILLER REDEFINES CBILCDF.
  4500         10  CBILCDA PIC  X(0001).
  4501     05  CBILCDI PIC  X(0001).
  4502*    -------------------------------
  4503     05  CCRFND1L PIC S9(0004) COMP.
  4504     05  CCRFND1F PIC  X(0001).
  4505     05  FILLER REDEFINES CCRFND1F.
  4506         10  CCRFND1A PIC  X(0001).
  4507     05  CCRFND1I PIC  X(0011).
  4508*    -------------------------------
  4509     05  CCRFND2L PIC S9(0004) COMP.
  4510     05  CCRFND2F PIC  X(0001).
  4511     05  FILLER REDEFINES CCRFND2F.
  4512         10  CCRFND2A PIC  X(0001).
  4513     05  CCRFND2I PIC  X(0011).
  4514*    -------------------------------
  4515     05  CBILIT1L PIC S9(0004) COMP.
  4516     05  CBILIT1F PIC  X(0001).
  4517     05  FILLER REDEFINES CBILIT1F.
  4518         10  CBILIT1A PIC  X(0001).
  4519     05  CBILIT1I PIC  X(0008).
  4520*    -------------------------------
  4521     05  CDRFND1L PIC S9(0004) COMP.
  4522     05  CDRFND1F PIC  X(0001).
  4523     05  FILLER REDEFINES CDRFND1F.
  4524         10  CDRFND1A PIC  X(0001).
  4525     05  CDRFND1I PIC  X(0011).
  4526*    -------------------------------
  4527     05  CBILIT2L PIC S9(0004) COMP.
  4528     05  CBILIT2F PIC  X(0001).
  4529     05  FILLER REDEFINES CBILIT2F.
  4530         10  CBILIT2A PIC  X(0001).
  4531     05  CBILIT2I PIC  X(0008).
  4532*    -------------------------------
  4533     05  CDRFND2L PIC S9(0004) COMP.
  4534     05  CDRFND2F PIC  X(0001).
  4535     05  FILLER REDEFINES CDRFND2F.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  85
* EL6311.cbl
  4536         10  CDRFND2A PIC  X(0001).
  4537     05  CDRFND2I PIC  X(0011).
  4538*    -------------------------------
  4539     05  CCANTXTL PIC S9(0004) COMP.
  4540     05  CCANTXTF PIC  X(0001).
  4541     05  FILLER REDEFINES CCANTXTF.
  4542         10  CCANTXTA PIC  X(0001).
  4543     05  CCANTXTI PIC  X(0005).
  4544*    -------------------------------
  4545     05  CCANFEEL PIC S9(0004) COMP.
  4546     05  CCANFEEF PIC  X(0001).
  4547     05  FILLER REDEFINES CCANFEEF.
  4548         10  CCANFEEA PIC  X(0001).
  4549     05  CCANFEEI PIC  X(0002).
  4550*    -------------------------------
  4551     05  CTERM1L PIC S9(0004) COMP.
  4552     05  CTERM1F PIC  X(0001).
  4553     05  FILLER REDEFINES CTERM1F.
  4554         10  CTERM1A PIC  X(0001).
  4555     05  CTERM1I PIC  X(0003).
  4556*    -------------------------------
  4557     05  CRTERM1L PIC S9(0004) COMP.
  4558     05  CRTERM1F PIC  X(0001).
  4559     05  FILLER REDEFINES CRTERM1F.
  4560         10  CRTERM1A PIC  X(0001).
  4561     05  CRTERM1I PIC  X(0003).
  4562*    -------------------------------
  4563     05  CPREM1L PIC S9(0004) COMP.
  4564     05  CPREM1F PIC  X(0001).
  4565     05  FILLER REDEFINES CPREM1F.
  4566         10  CPREM1A PIC  X(0001).
  4567     05  CPREM1I PIC  X(0011).
  4568*    -------------------------------
  4569     05  CTERM2L PIC S9(0004) COMP.
  4570     05  CTERM2F PIC  X(0001).
  4571     05  FILLER REDEFINES CTERM2F.
  4572         10  CTERM2A PIC  X(0001).
  4573     05  CTERM2I PIC  X(0003).
  4574*    -------------------------------
  4575     05  CRTERM2L PIC S9(0004) COMP.
  4576     05  CRTERM2F PIC  X(0001).
  4577     05  FILLER REDEFINES CRTERM2F.
  4578         10  CRTERM2A PIC  X(0001).
  4579     05  CRTERM2I PIC  X(0003).
  4580*    -------------------------------
  4581     05  CPREM2L PIC S9(0004) COMP.
  4582     05  CPREM2F PIC  X(0001).
  4583     05  FILLER REDEFINES CPREM2F.
  4584         10  CPREM2A PIC  X(0001).
  4585     05  CPREM2I PIC  X(0011).
  4586*    -------------------------------
  4587     05  CENTRDTL PIC S9(0004) COMP.
  4588     05  CENTRDTF PIC  X(0001).
  4589     05  FILLER REDEFINES CENTRDTF.
  4590         10  CENTRDTA PIC  X(0001).
  4591     05  CENTRDTI PIC  X(0008).
  4592*    -------------------------------
  4593     05  CPAYEEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  86
* EL6311.cbl
  4594     05  CPAYEEF PIC  X(0001).
  4595     05  FILLER REDEFINES CPAYEEF.
  4596         10  CPAYEEA PIC  X(0001).
  4597     05  CPAYEEI PIC  X(0006).
  4598*    -------------------------------
  4599     05  CRFNDSWL PIC S9(0004) COMP.
  4600     05  CRFNDSWF PIC  X(0001).
  4601     05  FILLER REDEFINES CRFNDSWF.
  4602         10  CRFNDSWA PIC  X(0001).
  4603     05  CRFNDSWI PIC  X(0003).
  4604*    -------------------------------
  4605     05  CLFHDGL PIC S9(0004) COMP.
  4606     05  CLFHDGF PIC  X(0001).
  4607     05  FILLER REDEFINES CLFHDGF.
  4608         10  CLFHDGA PIC  X(0001).
  4609     05  CLFHDGI PIC  X(0006).
  4610*    -------------------------------
  4611     05  CAHHDGL PIC S9(0004) COMP.
  4612     05  CAHHDGF PIC  X(0001).
  4613     05  FILLER REDEFINES CAHHDGF.
  4614         10  CAHHDGA PIC  X(0001).
  4615     05  CAHHDGI PIC  X(0006).
  4616*    -------------------------------
  4617     05  CENTDTL PIC S9(0004) COMP.
  4618     05  CENTDTF PIC  X(0001).
  4619     05  FILLER REDEFINES CENTDTF.
  4620         10  CENTDTA PIC  X(0001).
  4621     05  CENTDTI PIC  X(0008).
  4622*    -------------------------------
  4623     05  CENTBYL PIC S9(0004) COMP.
  4624     05  CENTBYF PIC  X(0001).
  4625     05  FILLER REDEFINES CENTBYF.
  4626         10  CENTBYA PIC  X(0001).
  4627     05  CENTBYI PIC  X(0004).
  4628*    -------------------------------
  4629     05  CCHGCNTL PIC S9(0004) COMP.
  4630     05  CCHGCNTF PIC  X(0001).
  4631     05  FILLER REDEFINES CCHGCNTF.
  4632         10  CCHGCNTA PIC  X(0001).
  4633     05  CCHGCNTI PIC  X(0003).
  4634*    -------------------------------
  4635     05  CLFREFNL PIC S9(0004) COMP.
  4636     05  CLFREFNF PIC  X(0001).
  4637     05  FILLER REDEFINES CLFREFNF.
  4638         10  CLFREFNA PIC  X(0001).
  4639     05  CLFREFNI PIC  X(0006).
  4640*    -------------------------------
  4641     05  CAHREFNL PIC S9(0004) COMP.
  4642     05  CAHREFNF PIC  X(0001).
  4643     05  FILLER REDEFINES CAHREFNF.
  4644         10  CAHREFNA PIC  X(0001).
  4645     05  CAHREFNI PIC  X(0006).
  4646*    -------------------------------
  4647     05  CREINCDL PIC S9(0004) COMP.
  4648     05  CREINCDF PIC  X(0001).
  4649     05  FILLER REDEFINES CREINCDF.
  4650         10  CREINCDA PIC  X(0001).
  4651     05  CREINCDI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  87
* EL6311.cbl
  4652*    -------------------------------
  4653     05  CAEFFDTL PIC S9(0004) COMP.
  4654     05  CAEFFDTF PIC  X(0001).
  4655     05  FILLER REDEFINES CAEFFDTF.
  4656         10  CAEFFDTA PIC  X(0001).
  4657     05  CAEFFDTI PIC  X(0008).
  4658*    -------------------------------
  4659     05  CAEXPDTL PIC S9(0004) COMP.
  4660     05  CAEXPDTF PIC  X(0001).
  4661     05  FILLER REDEFINES CAEXPDTF.
  4662         10  CAEXPDTA PIC  X(0001).
  4663     05  CAEXPDTI PIC  X(0008).
  4664*    -------------------------------
  4665     05  COMMLFL PIC S9(0004) COMP.
  4666     05  COMMLFF PIC  X(0001).
  4667     05  FILLER REDEFINES COMMLFF.
  4668         10  COMMLFA PIC  X(0001).
  4669     05  COMMLFI PIC  X(0006).
  4670*    -------------------------------
  4671     05  COMMAHL PIC S9(0004) COMP.
  4672     05  COMMAHF PIC  X(0001).
  4673     05  FILLER REDEFINES COMMAHF.
  4674         10  COMMAHA PIC  X(0001).
  4675     05  COMMAHI PIC  X(0006).
  4676*    -------------------------------
  4677     05  CERMSG1L PIC S9(0004) COMP.
  4678     05  CERMSG1F PIC  X(0001).
  4679     05  FILLER REDEFINES CERMSG1F.
  4680         10  CERMSG1A PIC  X(0001).
  4681     05  CERMSG1I PIC  X(0078).
  4682*    -------------------------------
  4683     05  CERMSG2L PIC S9(0004) COMP.
  4684     05  CERMSG2F PIC  X(0001).
  4685     05  FILLER REDEFINES CERMSG2F.
  4686         10  CERMSG2A PIC  X(0001).
  4687     05  CERMSG2I PIC  X(0078).
  4688*    -------------------------------
  4689     05  CERMSG3L PIC S9(0004) COMP.
  4690     05  CERMSG3F PIC  X(0001).
  4691     05  FILLER REDEFINES CERMSG3F.
  4692         10  CERMSG3A PIC  X(0001).
  4693     05  CERMSG3I PIC  X(0078).
  4694*    -------------------------------
  4695     05  CPFENTRL PIC S9(0004) COMP.
  4696     05  CPFENTRF PIC  X(0001).
  4697     05  FILLER REDEFINES CPFENTRF.
  4698         10  CPFENTRA PIC  X(0001).
  4699     05  CPFENTRI PIC  9(2).
  4700*    -------------------------------
  4701     05  CPF5HDRL PIC S9(0004) COMP.
  4702     05  CPF5HDRF PIC  X(0001).
  4703     05  FILLER REDEFINES CPF5HDRF.
  4704         10  CPF5HDRA PIC  X(0001).
  4705     05  CPF5HDRI PIC  X(0005).
  4706*    -------------------------------
  4707     05  CPF4HDRL PIC S9(0004) COMP.
  4708     05  CPF4HDRF PIC  X(0001).
  4709     05  FILLER REDEFINES CPF4HDRF.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  88
* EL6311.cbl
  4710         10  CPF4HDRA PIC  X(0001).
  4711     05  CPF4HDRI PIC  X(0013).
  4712*    -------------------------------
  4713     05  CF15HDRL PIC S9(0004) COMP.
  4714     05  CF15HDRF PIC  X(0001).
  4715     05  FILLER REDEFINES CF15HDRF.
  4716         10  CF15HDRA PIC  X(0001).
  4717     05  CF15HDRI PIC  X(0022).
  4718 01  EL631CO REDEFINES EL631BI.
  4719     05  FILLER            PIC  X(0012).
  4720*    -------------------------------
  4721     05  FILLER            PIC  X(0003).
  4722     05  CDATEO PIC  X(0008).
  4723*    -------------------------------
  4724     05  FILLER            PIC  X(0003).
  4725     05  CTIMEO PIC  99.99.
  4726*    -------------------------------
  4727     05  FILLER            PIC  X(0003).
  4728     05  CHEADO PIC  X(0038).
  4729*    -------------------------------
  4730     05  FILLER            PIC  X(0003).
  4731     05  CCHGTO PIC  X(0004).
  4732*    -------------------------------
  4733     05  FILLER            PIC  X(0003).
  4734     05  CCHGO PIC  ZZZ9.
  4735*    -------------------------------
  4736     05  FILLER            PIC  X(0003).
  4737     05  CMAINTO PIC  X(0001).
  4738*    -------------------------------
  4739     05  FILLER            PIC  X(0003).
  4740     05  CMANTBYO PIC  X(0004).
  4741*    -------------------------------
  4742     05  FILLER            PIC  X(0003).
  4743     05  CCHGHDGO PIC  X(0003).
  4744*    -------------------------------
  4745     05  FILLER            PIC  X(0003).
  4746     05  CMANTDTO PIC  X(0008).
  4747*    -------------------------------
  4748     05  FILLER            PIC  X(0003).
  4749     05  CMANTATO PIC  99.99.
  4750*    -------------------------------
  4751     05  FILLER            PIC  X(0003).
  4752     05  CCSRO PIC  X(0004).
  4753*    -------------------------------
  4754     05  FILLER            PIC  X(0003).
  4755     05  CBATCHO PIC  X(0006).
  4756*    -------------------------------
  4757     05  FILLER            PIC  X(0003).
  4758     05  CSEQO PIC  X(0004).
  4759*    -------------------------------
  4760     05  FILLER            PIC  X(0003).
  4761     05  CMOENDTO PIC  X(0008).
  4762*    -------------------------------
  4763     05  FILLER            PIC  X(0003).
  4764     05  CCARRO PIC  X(0001).
  4765*    -------------------------------
  4766     05  FILLER            PIC  X(0003).
  4767     05  CGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  89
* EL6311.cbl
  4768*    -------------------------------
  4769     05  FILLER            PIC  X(0003).
  4770     05  CSTATEO PIC  X(0002).
  4771*    -------------------------------
  4772     05  FILLER            PIC  X(0003).
  4773     05  CACCTO PIC  X(0010).
  4774*    -------------------------------
  4775     05  FILLER            PIC  X(0003).
  4776     05  CORIGHDO PIC  X(0011).
  4777*    -------------------------------
  4778     05  FILLER            PIC  X(0003).
  4779     05  CORGNOO PIC  X(0006).
  4780*    -------------------------------
  4781     05  FILLER            PIC  X(0003).
  4782     05  CORGSEQO PIC  X(0004).
  4783*    -------------------------------
  4784     05  FILLER            PIC  X(0003).
  4785     05  CREFHDGO PIC  X(0010).
  4786*    -------------------------------
  4787     05  FILLER            PIC  X(0003).
  4788     05  CREFO PIC  X(0012).
  4789*    -------------------------------
  4790     05  FILLER            PIC  X(0003).
  4791     05  CNHINTO PIC  999999.99.
  4792*    -------------------------------
  4793     05  FILLER            PIC  X(0003).
  4794     05  CCERTNOO PIC  X(0010).
  4795*    -------------------------------
  4796     05  FILLER            PIC  X(0003).
  4797     05  CSUFIXO PIC  X(0001).
  4798*    -------------------------------
  4799     05  FILLER            PIC  X(0003).
  4800     05  CEFFDTO PIC  X(0008).
  4801*    -------------------------------
  4802     05  FILLER            PIC  X(0003).
  4803     05  CLSTNMO PIC  X(0015).
  4804*    -------------------------------
  4805     05  FILLER            PIC  X(0003).
  4806     05  CPCYNO PIC  X(0001).
  4807*    -------------------------------
  4808     05  FILLER            PIC  X(0003).
  4809     05  CINAMEO PIC  X(0015).
  4810*    -------------------------------
  4811     05  FILLER            PIC  X(0003).
  4812     05  CINITSO PIC  X(0010).
  4813*    -------------------------------
  4814     05  FILLER            PIC  X(0003).
  4815     05  CCANREAO PIC  X(0001).
  4816*    -------------------------------
  4817     05  FILLER            PIC  X(0003).
  4818     05  CKIND1O PIC  X(0002).
  4819*    -------------------------------
  4820     05  FILLER            PIC  X(0003).
  4821     05  CCANDT1O PIC  X(0008).
  4822*    -------------------------------
  4823     05  FILLER            PIC  X(0003).
  4824     05  CREFND1O PIC  Z(7).99-.
  4825*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  90
* EL6311.cbl
  4826     05  FILLER            PIC  X(0003).
  4827     05  CMTHD1O PIC  X(0001).
  4828*    -------------------------------
  4829     05  FILLER            PIC  X(0003).
  4830     05  CKIND2O PIC  X(0002).
  4831*    -------------------------------
  4832     05  FILLER            PIC  X(0003).
  4833     05  CCANDT2O PIC  X(0008).
  4834*    -------------------------------
  4835     05  FILLER            PIC  X(0003).
  4836     05  CREFND2O PIC  Z(7).99-.
  4837*    -------------------------------
  4838     05  FILLER            PIC  X(0003).
  4839     05  CMTHD2O PIC  X(0001).
  4840*    -------------------------------
  4841     05  FILLER            PIC  X(0003).
  4842     05  CLIVESO PIC  X(0003).
  4843*    -------------------------------
  4844     05  FILLER            PIC  X(0003).
  4845     05  CFORCEO PIC  X(0001).
  4846*    -------------------------------
  4847     05  FILLER            PIC  X(0003).
  4848     05  CBILCDO PIC  X(0001).
  4849*    -------------------------------
  4850     05  FILLER            PIC  X(0003).
  4851     05  CCRFND1O PIC  Z(7).99-.
  4852*    -------------------------------
  4853     05  FILLER            PIC  X(0003).
  4854     05  CCRFND2O PIC  Z(7).99-.
  4855*    -------------------------------
  4856     05  FILLER            PIC  X(0003).
  4857     05  CBILIT1O PIC  X(0008).
  4858*    -------------------------------
  4859     05  FILLER            PIC  X(0003).
  4860     05  CDRFND1O PIC  Z(7).99-.
  4861*    -------------------------------
  4862     05  FILLER            PIC  X(0003).
  4863     05  CBILIT2O PIC  X(0008).
  4864*    -------------------------------
  4865     05  FILLER            PIC  X(0003).
  4866     05  CDRFND2O PIC  Z(7).99-.
  4867*    -------------------------------
  4868     05  FILLER            PIC  X(0003).
  4869     05  CCANTXTO PIC  X(0005).
  4870*    -------------------------------
  4871     05  FILLER            PIC  X(0003).
  4872     05  CCANFEEO PIC  Z9.
  4873*    -------------------------------
  4874     05  FILLER            PIC  X(0003).
  4875     05  CTERM1O PIC  ZZ9.
  4876*    -------------------------------
  4877     05  FILLER            PIC  X(0003).
  4878     05  CRTERM1O PIC  ZZ9.
  4879*    -------------------------------
  4880     05  FILLER            PIC  X(0003).
  4881     05  CPREM1O PIC  ZZZZZZ9.99-.
  4882*    -------------------------------
  4883     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  91
* EL6311.cbl
  4884     05  CTERM2O PIC  ZZ9.
  4885*    -------------------------------
  4886     05  FILLER            PIC  X(0003).
  4887     05  CRTERM2O PIC  ZZ9.
  4888*    -------------------------------
  4889     05  FILLER            PIC  X(0003).
  4890     05  CPREM2O PIC  ZZZZZZ9.99-.
  4891*    -------------------------------
  4892     05  FILLER            PIC  X(0003).
  4893     05  CENTRDTO PIC  X(0008).
  4894*    -------------------------------
  4895     05  FILLER            PIC  X(0003).
  4896     05  CPAYEEO PIC  X(0006).
  4897*    -------------------------------
  4898     05  FILLER            PIC  X(0003).
  4899     05  CRFNDSWO PIC  X(0003).
  4900*    -------------------------------
  4901     05  FILLER            PIC  X(0003).
  4902     05  CLFHDGO PIC  X(0006).
  4903*    -------------------------------
  4904     05  FILLER            PIC  X(0003).
  4905     05  CAHHDGO PIC  X(0006).
  4906*    -------------------------------
  4907     05  FILLER            PIC  X(0003).
  4908     05  CENTDTO PIC  X(0008).
  4909*    -------------------------------
  4910     05  FILLER            PIC  X(0003).
  4911     05  CENTBYO PIC  X(0004).
  4912*    -------------------------------
  4913     05  FILLER            PIC  X(0003).
  4914     05  CCHGCNTO PIC  X(0003).
  4915*    -------------------------------
  4916     05  FILLER            PIC  X(0003).
  4917     05  CLFREFNO PIC  X(0006).
  4918*    -------------------------------
  4919     05  FILLER            PIC  X(0003).
  4920     05  CAHREFNO PIC  X(0006).
  4921*    -------------------------------
  4922     05  FILLER            PIC  X(0003).
  4923     05  CREINCDO PIC  X(0003).
  4924*    -------------------------------
  4925     05  FILLER            PIC  X(0003).
  4926     05  CAEFFDTO PIC  X(0008).
  4927*    -------------------------------
  4928     05  FILLER            PIC  X(0003).
  4929     05  CAEXPDTO PIC  X(0008).
  4930*    -------------------------------
  4931     05  FILLER            PIC  X(0003).
  4932     05  COMMLFO PIC  .99999.
  4933*    -------------------------------
  4934     05  FILLER            PIC  X(0003).
  4935     05  COMMAHO PIC  .99999.
  4936*    -------------------------------
  4937     05  FILLER            PIC  X(0003).
  4938     05  CERMSG1O PIC  X(0078).
  4939*    -------------------------------
  4940     05  FILLER            PIC  X(0003).
  4941     05  CERMSG2O PIC  X(0078).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  92
* EL6311.cbl
  4942*    -------------------------------
  4943     05  FILLER            PIC  X(0003).
  4944     05  CERMSG3O PIC  X(0078).
  4945*    -------------------------------
  4946     05  FILLER            PIC  X(0003).
  4947     05  CPFENTRO PIC  X(0002).
  4948*    -------------------------------
  4949     05  FILLER            PIC  X(0003).
  4950     05  CPF5HDRO PIC  X(0005).
  4951*    -------------------------------
  4952     05  FILLER            PIC  X(0003).
  4953     05  CPF4HDRO PIC  X(0013).
  4954*    -------------------------------
  4955     05  FILLER            PIC  X(0003).
  4956     05  CF15HDRO PIC  X(0022).
  4957*    -------------------------------
  4958 01  EL631DI REDEFINES EL631BI.
  4959     05  FILLER            PIC  X(0012).
  4960*    -------------------------------
  4961     05  DDATEL PIC S9(0004) COMP.
  4962     05  DDATEF PIC  X(0001).
  4963     05  FILLER REDEFINES DDATEF.
  4964         10  DDATEA PIC  X(0001).
  4965     05  DDATEI PIC  X(0008).
  4966*    -------------------------------
  4967     05  DTIMEL PIC S9(0004) COMP.
  4968     05  DTIMEF PIC  X(0001).
  4969     05  FILLER REDEFINES DTIMEF.
  4970         10  DTIMEA PIC  X(0001).
  4971     05  DTIMEI PIC  X(0005).
  4972*    -------------------------------
  4973     05  DHEADL PIC S9(0004) COMP.
  4974     05  DHEADF PIC  X(0001).
  4975     05  FILLER REDEFINES DHEADF.
  4976         10  DHEADA PIC  X(0001).
  4977     05  DHEADI PIC  X(0038).
  4978*    -------------------------------
  4979     05  DLDATEL PIC S9(0004) COMP.
  4980     05  DLDATEF PIC  X(0001).
  4981     05  FILLER REDEFINES DLDATEF.
  4982         10  DLDATEA PIC  X(0001).
  4983     05  DLDATEI PIC  X(0010).
  4984*    -------------------------------
  4985     05  DBATCHL PIC S9(0004) COMP.
  4986     05  DBATCHF PIC  X(0001).
  4987     05  FILLER REDEFINES DBATCHF.
  4988         10  DBATCHA PIC  X(0001).
  4989     05  DBATCHI PIC  X(0011).
  4990*    -------------------------------
  4991     05  DACCTNML PIC S9(0004) COMP.
  4992     05  DACCTNMF PIC  X(0001).
  4993     05  FILLER REDEFINES DACCTNMF.
  4994         10  DACCTNMA PIC  X(0001).
  4995     05  DACCTNMI PIC  X(0030).
  4996*    -------------------------------
  4997     05  DPROCDTL PIC S9(0004) COMP.
  4998     05  DPROCDTF PIC  X(0001).
  4999     05  FILLER REDEFINES DPROCDTF.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  93
* EL6311.cbl
  5000         10  DPROCDTA PIC  X(0001).
  5001     05  DPROCDTI PIC  X(0008).
  5002*    -------------------------------
  5003     05  DINPUTL PIC S9(0004) COMP.
  5004     05  DINPUTF PIC  X(0001).
  5005     05  FILLER REDEFINES DINPUTF.
  5006         10  DINPUTA PIC  X(0001).
  5007     05  DINPUTI PIC  X(0008).
  5008*    -------------------------------
  5009     05  DMAINDTL PIC S9(0004) COMP.
  5010     05  DMAINDTF PIC  X(0001).
  5011     05  FILLER REDEFINES DMAINDTF.
  5012         10  DMAINDTA PIC  X(0001).
  5013     05  DMAINDTI PIC  X(0008).
  5014*    -------------------------------
  5015     05  DCARRL PIC S9(0004) COMP.
  5016     05  DCARRF PIC  X(0001).
  5017     05  FILLER REDEFINES DCARRF.
  5018         10  DCARRA PIC  X(0001).
  5019     05  DCARRI PIC  X(0001).
  5020*    -------------------------------
  5021     05  DGROUPL PIC S9(0004) COMP.
  5022     05  DGROUPF PIC  X(0001).
  5023     05  FILLER REDEFINES DGROUPF.
  5024         10  DGROUPA PIC  X(0001).
  5025     05  DGROUPI PIC  X(0006).
  5026*    -------------------------------
  5027     05  DSTATEL PIC S9(0004) COMP.
  5028     05  DSTATEF PIC  X(0001).
  5029     05  FILLER REDEFINES DSTATEF.
  5030         10  DSTATEA PIC  X(0001).
  5031     05  DSTATEI PIC  X(0002).
  5032*    -------------------------------
  5033     05  DACCTL PIC S9(0004) COMP.
  5034     05  DACCTF PIC  X(0001).
  5035     05  FILLER REDEFINES DACCTF.
  5036         10  DACCTA PIC  X(0001).
  5037     05  DACCTI PIC  X(0010).
  5038*    -------------------------------
  5039     05  DRECVDTL PIC S9(0004) COMP.
  5040     05  DRECVDTF PIC  X(0001).
  5041     05  FILLER REDEFINES DRECVDTF.
  5042         10  DRECVDTA PIC  X(0001).
  5043     05  DRECVDTI PIC  X(0008).
  5044*    -------------------------------
  5045     05  DCSRL PIC S9(0004) COMP.
  5046     05  DCSRF PIC  X(0001).
  5047     05  FILLER REDEFINES DCSRF.
  5048         10  DCSRA PIC  X(0001).
  5049     05  DCSRI PIC  X(0004).
  5050*    -------------------------------
  5051     05  DREFHDGL PIC S9(0004) COMP.
  5052     05  DREFHDGF PIC  X(0001).
  5053     05  FILLER REDEFINES DREFHDGF.
  5054         10  DREFHDGA PIC  X(0001).
  5055     05  DREFHDGI PIC  X(0010).
  5056*    -------------------------------
  5057     05  DREFL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  94
* EL6311.cbl
  5058     05  DREFF PIC  X(0001).
  5059     05  FILLER REDEFINES DREFF.
  5060         10  DREFA PIC  X(0001).
  5061     05  DREFI PIC  X(0012).
  5062*    -------------------------------
  5063     05  DLFPHDGL PIC S9(0004) COMP.
  5064     05  DLFPHDGF PIC  X(0001).
  5065     05  FILLER REDEFINES DLFPHDGF.
  5066         10  DLFPHDGA PIC  X(0001).
  5067     05  DLFPHDGI PIC  X(0010).
  5068*    -------------------------------
  5069     05  DAHPHDGL PIC S9(0004) COMP.
  5070     05  DAHPHDGF PIC  X(0001).
  5071     05  FILLER REDEFINES DAHPHDGF.
  5072         10  DAHPHDGA PIC  X(0001).
  5073     05  DAHPHDGI PIC  X(0010).
  5074*    -------------------------------
  5075     05  DLFRHDGL PIC S9(0004) COMP.
  5076     05  DLFRHDGF PIC  X(0001).
  5077     05  FILLER REDEFINES DLFRHDGF.
  5078         10  DLFRHDGA PIC  X(0001).
  5079     05  DLFRHDGI PIC  X(0009).
  5080*    -------------------------------
  5081     05  DAHRHDGL PIC S9(0004) COMP.
  5082     05  DAHRHDGF PIC  X(0001).
  5083     05  FILLER REDEFINES DAHRHDGF.
  5084         10  DAHRHDGA PIC  X(0001).
  5085     05  DAHRHDGI PIC  X(0009).
  5086*    -------------------------------
  5087     05  DRISSL PIC S9(0004) COMP.
  5088     05  DRISSF PIC  X(0001).
  5089     05  FILLER REDEFINES DRISSF.
  5090         10  DRISSA PIC  X(0001).
  5091     05  DRISSI PIC  X(0005).
  5092*    -------------------------------
  5093     05  DRLFPRML PIC S9(0004) COMP.
  5094     05  DRLFPRMF PIC  X(0001).
  5095     05  FILLER REDEFINES DRLFPRMF.
  5096         10  DRLFPRMA PIC  X(0001).
  5097     05  DRLFPRMI PIC  S9(9)V99.
  5098*    -------------------------------
  5099     05  DRAHPRML PIC S9(0004) COMP.
  5100     05  DRAHPRMF PIC  X(0001).
  5101     05  FILLER REDEFINES DRAHPRMF.
  5102         10  DRAHPRMA PIC  X(0001).
  5103     05  DRAHPRMI PIC  S9(9)V99.
  5104*    -------------------------------
  5105     05  DRCANCL PIC S9(0004) COMP.
  5106     05  DRCANCF PIC  X(0001).
  5107     05  FILLER REDEFINES DRCANCF.
  5108         10  DRCANCA PIC  X(0001).
  5109     05  DRCANCI PIC  X(0005).
  5110*    -------------------------------
  5111     05  DRLFRFDL PIC S9(0004) COMP.
  5112     05  DRLFRFDF PIC  X(0001).
  5113     05  FILLER REDEFINES DRLFRFDF.
  5114         10  DRLFRFDA PIC  X(0001).
  5115     05  DRLFRFDI PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  95
* EL6311.cbl
  5116*    -------------------------------
  5117     05  DRAHRFDL PIC S9(0004) COMP.
  5118     05  DRAHRFDF PIC  X(0001).
  5119     05  FILLER REDEFINES DRAHRFDF.
  5120         10  DRAHRFDA PIC  X(0001).
  5121     05  DRAHRFDI PIC  S9(9)V99.
  5122*    -------------------------------
  5123     05  DEISSL PIC S9(0004) COMP.
  5124     05  DEISSF PIC  X(0001).
  5125     05  FILLER REDEFINES DEISSF.
  5126         10  DEISSA PIC  X(0001).
  5127     05  DEISSI PIC  X(0005).
  5128*    -------------------------------
  5129     05  DELFPRML PIC S9(0004) COMP.
  5130     05  DELFPRMF PIC  X(0001).
  5131     05  FILLER REDEFINES DELFPRMF.
  5132         10  DELFPRMA PIC  X(0001).
  5133     05  DELFPRMI PIC  X(0011).
  5134*    -------------------------------
  5135     05  DEAHPRML PIC S9(0004) COMP.
  5136     05  DEAHPRMF PIC  X(0001).
  5137     05  FILLER REDEFINES DEAHPRMF.
  5138         10  DEAHPRMA PIC  X(0001).
  5139     05  DEAHPRMI PIC  X(0011).
  5140*    -------------------------------
  5141     05  DECANCL PIC S9(0004) COMP.
  5142     05  DECANCF PIC  X(0001).
  5143     05  FILLER REDEFINES DECANCF.
  5144         10  DECANCA PIC  X(0001).
  5145     05  DECANCI PIC  X(0005).
  5146*    -------------------------------
  5147     05  DELFRFDL PIC S9(0004) COMP.
  5148     05  DELFRFDF PIC  X(0001).
  5149     05  FILLER REDEFINES DELFRFDF.
  5150         10  DELFRFDA PIC  X(0001).
  5151     05  DELFRFDI PIC  X(0011).
  5152*    -------------------------------
  5153     05  DEAHRFDL PIC S9(0004) COMP.
  5154     05  DEAHRFDF PIC  X(0001).
  5155     05  FILLER REDEFINES DEAHRFDF.
  5156         10  DEAHRFDA PIC  X(0001).
  5157     05  DEAHRFDI PIC  X(0011).
  5158*    -------------------------------
  5159     05  DCISSL PIC S9(0004) COMP.
  5160     05  DCISSF PIC  X(0001).
  5161     05  FILLER REDEFINES DCISSF.
  5162         10  DCISSA PIC  X(0001).
  5163     05  DCISSI PIC  X(0005).
  5164*    -------------------------------
  5165     05  DCLFPRML PIC S9(0004) COMP.
  5166     05  DCLFPRMF PIC  X(0001).
  5167     05  FILLER REDEFINES DCLFPRMF.
  5168         10  DCLFPRMA PIC  X(0001).
  5169     05  DCLFPRMI PIC  X(0011).
  5170*    -------------------------------
  5171     05  DCAHPRML PIC S9(0004) COMP.
  5172     05  DCAHPRMF PIC  X(0001).
  5173     05  FILLER REDEFINES DCAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  96
* EL6311.cbl
  5174         10  DCAHPRMA PIC  X(0001).
  5175     05  DCAHPRMI PIC  X(0011).
  5176*    -------------------------------
  5177     05  DCCANCL PIC S9(0004) COMP.
  5178     05  DCCANCF PIC  X(0001).
  5179     05  FILLER REDEFINES DCCANCF.
  5180         10  DCCANCA PIC  X(0001).
  5181     05  DCCANCI PIC  X(0005).
  5182*    -------------------------------
  5183     05  DCLFRFDL PIC S9(0004) COMP.
  5184     05  DCLFRFDF PIC  X(0001).
  5185     05  FILLER REDEFINES DCLFRFDF.
  5186         10  DCLFRFDA PIC  X(0001).
  5187     05  DCLFRFDI PIC  X(0011).
  5188*    -------------------------------
  5189     05  DCAHRFDL PIC S9(0004) COMP.
  5190     05  DCAHRFDF PIC  X(0001).
  5191     05  FILLER REDEFINES DCAHRFDF.
  5192         10  DCAHRFDA PIC  X(0001).
  5193     05  DCAHRFDI PIC  X(0011).
  5194*    -------------------------------
  5195     05  DOISSL PIC S9(0004) COMP.
  5196     05  DOISSF PIC  X(0001).
  5197     05  FILLER REDEFINES DOISSF.
  5198         10  DOISSA PIC  X(0001).
  5199     05  DOISSI PIC  X(0005).
  5200*    -------------------------------
  5201     05  DOLFPRML PIC S9(0004) COMP.
  5202     05  DOLFPRMF PIC  X(0001).
  5203     05  FILLER REDEFINES DOLFPRMF.
  5204         10  DOLFPRMA PIC  X(0001).
  5205     05  DOLFPRMI PIC  X(0011).
  5206*    -------------------------------
  5207     05  DOAHPRML PIC S9(0004) COMP.
  5208     05  DOAHPRMF PIC  X(0001).
  5209     05  FILLER REDEFINES DOAHPRMF.
  5210         10  DOAHPRMA PIC  X(0001).
  5211     05  DOAHPRMI PIC  X(0011).
  5212*    -------------------------------
  5213     05  DOCANCL PIC S9(0004) COMP.
  5214     05  DOCANCF PIC  X(0001).
  5215     05  FILLER REDEFINES DOCANCF.
  5216         10  DOCANCA PIC  X(0001).
  5217     05  DOCANCI PIC  X(0005).
  5218*    -------------------------------
  5219     05  DOLFRFDL PIC S9(0004) COMP.
  5220     05  DOLFRFDF PIC  X(0001).
  5221     05  FILLER REDEFINES DOLFRFDF.
  5222         10  DOLFRFDA PIC  X(0001).
  5223     05  DOLFRFDI PIC  X(0011).
  5224*    -------------------------------
  5225     05  DOAHRFDL PIC S9(0004) COMP.
  5226     05  DOAHRFDF PIC  X(0001).
  5227     05  FILLER REDEFINES DOAHRFDF.
  5228         10  DOAHRFDA PIC  X(0001).
  5229     05  DOAHRFDI PIC  X(0011).
  5230*    -------------------------------
  5231     05  DITOTALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  97
* EL6311.cbl
  5232     05  DITOTALF PIC  X(0001).
  5233     05  FILLER REDEFINES DITOTALF.
  5234         10  DITOTALA PIC  X(0001).
  5235     05  DITOTALI PIC  X(0005).
  5236*    -------------------------------
  5237     05  DIFATALL PIC S9(0004) COMP.
  5238     05  DIFATALF PIC  X(0001).
  5239     05  FILLER REDEFINES DIFATALF.
  5240         10  DIFATALA PIC  X(0001).
  5241     05  DIFATALI PIC  X(0005).
  5242*    -------------------------------
  5243     05  DIFORCEL PIC S9(0004) COMP.
  5244     05  DIFORCEF PIC  X(0001).
  5245     05  FILLER REDEFINES DIFORCEF.
  5246         10  DIFORCEA PIC  X(0001).
  5247     05  DIFORCEI PIC  X(0005).
  5248*    -------------------------------
  5249     05  DIHOLDL PIC S9(0004) COMP.
  5250     05  DIHOLDF PIC  X(0001).
  5251     05  FILLER REDEFINES DIHOLDF.
  5252         10  DIHOLDA PIC  X(0001).
  5253     05  DIHOLDI PIC  X(0005).
  5254*    -------------------------------
  5255     05  DIAVAILL PIC S9(0004) COMP.
  5256     05  DIAVAILF PIC  X(0001).
  5257     05  FILLER REDEFINES DIAVAILF.
  5258         10  DIAVAILA PIC  X(0001).
  5259     05  DIAVAILI PIC  X(0005).
  5260*    -------------------------------
  5261     05  DIGPREML PIC S9(0004) COMP.
  5262     05  DIGPREMF PIC  X(0001).
  5263     05  FILLER REDEFINES DIGPREMF.
  5264         10  DIGPREMA PIC  X(0001).
  5265     05  DIGPREMI PIC  X(0011).
  5266*    -------------------------------
  5267     05  DIBPREML PIC S9(0004) COMP.
  5268     05  DIBPREMF PIC  X(0001).
  5269     05  FILLER REDEFINES DIBPREMF.
  5270         10  DIBPREMA PIC  X(0001).
  5271     05  DIBPREMI PIC  X(0011).
  5272*    -------------------------------
  5273     05  DCTOTALL PIC S9(0004) COMP.
  5274     05  DCTOTALF PIC  X(0001).
  5275     05  FILLER REDEFINES DCTOTALF.
  5276         10  DCTOTALA PIC  X(0001).
  5277     05  DCTOTALI PIC  X(0005).
  5278*    -------------------------------
  5279     05  DCFATALL PIC S9(0004) COMP.
  5280     05  DCFATALF PIC  X(0001).
  5281     05  FILLER REDEFINES DCFATALF.
  5282         10  DCFATALA PIC  X(0001).
  5283     05  DCFATALI PIC  X(0005).
  5284*    -------------------------------
  5285     05  DCFORCEL PIC S9(0004) COMP.
  5286     05  DCFORCEF PIC  X(0001).
  5287     05  FILLER REDEFINES DCFORCEF.
  5288         10  DCFORCEA PIC  X(0001).
  5289     05  DCFORCEI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  98
* EL6311.cbl
  5290*    -------------------------------
  5291     05  DCHOLDL PIC S9(0004) COMP.
  5292     05  DCHOLDF PIC  X(0001).
  5293     05  FILLER REDEFINES DCHOLDF.
  5294         10  DCHOLDA PIC  X(0001).
  5295     05  DCHOLDI PIC  X(0005).
  5296*    -------------------------------
  5297     05  DCAVAILL PIC S9(0004) COMP.
  5298     05  DCAVAILF PIC  X(0001).
  5299     05  FILLER REDEFINES DCAVAILF.
  5300         10  DCAVAILA PIC  X(0001).
  5301     05  DCAVAILI PIC  X(0005).
  5302*    -------------------------------
  5303     05  DCGPREML PIC S9(0004) COMP.
  5304     05  DCGPREMF PIC  X(0001).
  5305     05  FILLER REDEFINES DCGPREMF.
  5306         10  DCGPREMA PIC  X(0001).
  5307     05  DCGPREMI PIC  X(0011).
  5308*    -------------------------------
  5309     05  DCBPREML PIC S9(0004) COMP.
  5310     05  DCBPREMF PIC  X(0001).
  5311     05  FILLER REDEFINES DCBPREMF.
  5312         10  DCBPREMA PIC  X(0001).
  5313     05  DCBPREMI PIC  X(0011).
  5314*    -------------------------------
  5315     05  DNTOTALL PIC S9(0004) COMP.
  5316     05  DNTOTALF PIC  X(0001).
  5317     05  FILLER REDEFINES DNTOTALF.
  5318         10  DNTOTALA PIC  X(0001).
  5319     05  DNTOTALI PIC  X(0005).
  5320*    -------------------------------
  5321     05  DNFATALL PIC S9(0004) COMP.
  5322     05  DNFATALF PIC  X(0001).
  5323     05  FILLER REDEFINES DNFATALF.
  5324         10  DNFATALA PIC  X(0001).
  5325     05  DNFATALI PIC  X(0005).
  5326*    -------------------------------
  5327     05  DNFORCEL PIC S9(0004) COMP.
  5328     05  DNFORCEF PIC  X(0001).
  5329     05  FILLER REDEFINES DNFORCEF.
  5330         10  DNFORCEA PIC  X(0001).
  5331     05  DNFORCEI PIC  X(0005).
  5332*    -------------------------------
  5333     05  DNHOLDL PIC S9(0004) COMP.
  5334     05  DNHOLDF PIC  X(0001).
  5335     05  FILLER REDEFINES DNHOLDF.
  5336         10  DNHOLDA PIC  X(0001).
  5337     05  DNHOLDI PIC  X(0005).
  5338*    -------------------------------
  5339     05  DNAVAILL PIC S9(0004) COMP.
  5340     05  DNAVAILF PIC  X(0001).
  5341     05  FILLER REDEFINES DNAVAILF.
  5342         10  DNAVAILA PIC  X(0001).
  5343     05  DNAVAILI PIC  X(0005).
  5344*    -------------------------------
  5345     05  DNGPREML PIC S9(0004) COMP.
  5346     05  DNGPREMF PIC  X(0001).
  5347     05  FILLER REDEFINES DNGPREMF.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page  99
* EL6311.cbl
  5348         10  DNGPREMA PIC  X(0001).
  5349     05  DNGPREMI PIC  X(0011).
  5350*    -------------------------------
  5351     05  DNBPREML PIC S9(0004) COMP.
  5352     05  DNBPREMF PIC  X(0001).
  5353     05  FILLER REDEFINES DNBPREMF.
  5354         10  DNBPREMA PIC  X(0001).
  5355     05  DNBPREMI PIC  X(0011).
  5356*    -------------------------------
  5357     05  DERMSGL PIC S9(0004) COMP.
  5358     05  DERMSGF PIC  X(0001).
  5359     05  FILLER REDEFINES DERMSGF.
  5360         10  DERMSGA PIC  X(0001).
  5361     05  DERMSGI PIC  X(0075).
  5362*    -------------------------------
  5363     05  DPFENTRL PIC S9(0004) COMP.
  5364     05  DPFENTRF PIC  X(0001).
  5365     05  FILLER REDEFINES DPFENTRF.
  5366         10  DPFENTRA PIC  X(0001).
  5367     05  DPFENTRI PIC  9(2).
  5368 01  EL631DO REDEFINES EL631BI.
  5369     05  FILLER            PIC  X(0012).
  5370*    -------------------------------
  5371     05  FILLER            PIC  X(0003).
  5372     05  DDATEO PIC  X(0008).
  5373*    -------------------------------
  5374     05  FILLER            PIC  X(0003).
  5375     05  DTIMEO PIC  99.99.
  5376*    -------------------------------
  5377     05  FILLER            PIC  X(0003).
  5378     05  DHEADO PIC  X(0038).
  5379*    -------------------------------
  5380     05  FILLER            PIC  X(0003).
  5381     05  DLDATEO PIC  X(0010).
  5382*    -------------------------------
  5383     05  FILLER            PIC  X(0003).
  5384     05  DBATCHO PIC  X(0011).
  5385*    -------------------------------
  5386     05  FILLER            PIC  X(0003).
  5387     05  DACCTNMO PIC  X(0030).
  5388*    -------------------------------
  5389     05  FILLER            PIC  X(0003).
  5390     05  DPROCDTO PIC  X(0008).
  5391*    -------------------------------
  5392     05  FILLER            PIC  X(0003).
  5393     05  DINPUTO PIC  X(0008).
  5394*    -------------------------------
  5395     05  FILLER            PIC  X(0003).
  5396     05  DMAINDTO PIC  X(0008).
  5397*    -------------------------------
  5398     05  FILLER            PIC  X(0003).
  5399     05  DCARRO PIC  X(0001).
  5400*    -------------------------------
  5401     05  FILLER            PIC  X(0003).
  5402     05  DGROUPO PIC  X(0006).
  5403*    -------------------------------
  5404     05  FILLER            PIC  X(0003).
  5405     05  DSTATEO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 100
* EL6311.cbl
  5406*    -------------------------------
  5407     05  FILLER            PIC  X(0003).
  5408     05  DACCTO PIC  X(0010).
  5409*    -------------------------------
  5410     05  FILLER            PIC  X(0003).
  5411     05  DRECVDTO PIC  X(0008).
  5412*    -------------------------------
  5413     05  FILLER            PIC  X(0003).
  5414     05  DCSRO PIC  X(0004).
  5415*    -------------------------------
  5416     05  FILLER            PIC  X(0003).
  5417     05  DREFHDGO PIC  X(0010).
  5418*    -------------------------------
  5419     05  FILLER            PIC  X(0003).
  5420     05  DREFO PIC  X(0012).
  5421*    -------------------------------
  5422     05  FILLER            PIC  X(0003).
  5423     05  DLFPHDGO PIC  X(0010).
  5424*    -------------------------------
  5425     05  FILLER            PIC  X(0003).
  5426     05  DAHPHDGO PIC  X(0010).
  5427*    -------------------------------
  5428     05  FILLER            PIC  X(0003).
  5429     05  DLFRHDGO PIC  X(0009).
  5430*    -------------------------------
  5431     05  FILLER            PIC  X(0003).
  5432     05  DAHRHDGO PIC  X(0009).
  5433*    -------------------------------
  5434     05  FILLER            PIC  X(0003).
  5435     05  DRISSO PIC  ZZ99-.
  5436*    -------------------------------
  5437     05  FILLER            PIC  X(0003).
  5438     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5439*    -------------------------------
  5440     05  FILLER            PIC  X(0003).
  5441     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5442*    -------------------------------
  5443     05  FILLER            PIC  X(0003).
  5444     05  DRCANCO PIC  ZZ99-.
  5445*    -------------------------------
  5446     05  FILLER            PIC  X(0003).
  5447     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5448*    -------------------------------
  5449     05  FILLER            PIC  X(0003).
  5450     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5451*    -------------------------------
  5452     05  FILLER            PIC  X(0003).
  5453     05  DEISSO PIC  ZZ99-.
  5454*    -------------------------------
  5455     05  FILLER            PIC  X(0003).
  5456     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5457*    -------------------------------
  5458     05  FILLER            PIC  X(0003).
  5459     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5460*    -------------------------------
  5461     05  FILLER            PIC  X(0003).
  5462     05  DECANCO PIC  ZZ99-.
  5463*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 101
* EL6311.cbl
  5464     05  FILLER            PIC  X(0003).
  5465     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5466*    -------------------------------
  5467     05  FILLER            PIC  X(0003).
  5468     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5469*    -------------------------------
  5470     05  FILLER            PIC  X(0003).
  5471     05  DCISSO PIC  ZZ99-.
  5472*    -------------------------------
  5473     05  FILLER            PIC  X(0003).
  5474     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5475*    -------------------------------
  5476     05  FILLER            PIC  X(0003).
  5477     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5478*    -------------------------------
  5479     05  FILLER            PIC  X(0003).
  5480     05  DCCANCO PIC  ZZ99-.
  5481*    -------------------------------
  5482     05  FILLER            PIC  X(0003).
  5483     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5484*    -------------------------------
  5485     05  FILLER            PIC  X(0003).
  5486     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5487*    -------------------------------
  5488     05  FILLER            PIC  X(0003).
  5489     05  DOISSO PIC  ZZ99-.
  5490*    -------------------------------
  5491     05  FILLER            PIC  X(0003).
  5492     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5493*    -------------------------------
  5494     05  FILLER            PIC  X(0003).
  5495     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5496*    -------------------------------
  5497     05  FILLER            PIC  X(0003).
  5498     05  DOCANCO PIC  ZZ99-.
  5499*    -------------------------------
  5500     05  FILLER            PIC  X(0003).
  5501     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5502*    -------------------------------
  5503     05  FILLER            PIC  X(0003).
  5504     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5505*    -------------------------------
  5506     05  FILLER            PIC  X(0003).
  5507     05  DITOTALO PIC  ZZZ99.
  5508*    -------------------------------
  5509     05  FILLER            PIC  X(0003).
  5510     05  DIFATALO PIC  ZZZ99.
  5511*    -------------------------------
  5512     05  FILLER            PIC  X(0003).
  5513     05  DIFORCEO PIC  ZZZ99.
  5514*    -------------------------------
  5515     05  FILLER            PIC  X(0003).
  5516     05  DIHOLDO PIC  ZZZ99.
  5517*    -------------------------------
  5518     05  FILLER            PIC  X(0003).
  5519     05  DIAVAILO PIC  ZZZ99.
  5520*    -------------------------------
  5521     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 102
* EL6311.cbl
  5522     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5523*    -------------------------------
  5524     05  FILLER            PIC  X(0003).
  5525     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5526*    -------------------------------
  5527     05  FILLER            PIC  X(0003).
  5528     05  DCTOTALO PIC  ZZZ99.
  5529*    -------------------------------
  5530     05  FILLER            PIC  X(0003).
  5531     05  DCFATALO PIC  ZZZ99.
  5532*    -------------------------------
  5533     05  FILLER            PIC  X(0003).
  5534     05  DCFORCEO PIC  ZZZ99.
  5535*    -------------------------------
  5536     05  FILLER            PIC  X(0003).
  5537     05  DCHOLDO PIC  ZZZ99.
  5538*    -------------------------------
  5539     05  FILLER            PIC  X(0003).
  5540     05  DCAVAILO PIC  ZZZ99.
  5541*    -------------------------------
  5542     05  FILLER            PIC  X(0003).
  5543     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5544*    -------------------------------
  5545     05  FILLER            PIC  X(0003).
  5546     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5547*    -------------------------------
  5548     05  FILLER            PIC  X(0003).
  5549     05  DNTOTALO PIC  ---99.
  5550*    -------------------------------
  5551     05  FILLER            PIC  X(0003).
  5552     05  DNFATALO PIC  ---99.
  5553*    -------------------------------
  5554     05  FILLER            PIC  X(0003).
  5555     05  DNFORCEO PIC  ---99.
  5556*    -------------------------------
  5557     05  FILLER            PIC  X(0003).
  5558     05  DNHOLDO PIC  ---99.
  5559*    -------------------------------
  5560     05  FILLER            PIC  X(0003).
  5561     05  DNAVAILO PIC  ---99.
  5562*    -------------------------------
  5563     05  FILLER            PIC  X(0003).
  5564     05  DNGPREMO PIC  -------9.99.
  5565*    -------------------------------
  5566     05  FILLER            PIC  X(0003).
  5567     05  DNBPREMO PIC  -------9.99.
  5568*    -------------------------------
  5569     05  FILLER            PIC  X(0003).
  5570     05  DERMSGO PIC  X(0075).
  5571*    -------------------------------
  5572     05  FILLER            PIC  X(0003).
  5573     05  DPFENTRO PIC  X(0002).
  5574*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 103
* EL6311.cbl
  5576 01  MAP-B REDEFINES EL631BI.
  5577     12  FILLER                  PIC X(569).
  5578*    12  FILLER                  PIC X(512).
  5579*    12  FILLER                  PIC X(510).
  5580     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5581         16  BKIND-LEN               PIC S9(4)  COMP.
  5582         16  BKIND-ATTRB             PIC X.
  5583         16  BKIND                   PIC XX.
  5584         16  BTYPE-LEN               PIC S9(4)  COMP.
  5585         16  BTYPE-ATTRB             PIC X.
  5586         16  BTYPE                   PIC X(3).
  5587         16  BTERM-LEN               PIC S9(4)  COMP.
  5588         16  BTERM-ATTRB             PIC X.
  5589         16  BTERMI                  PIC 999.
  5590         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5591         16  BBEN-LEN                PIC S9(4)  COMP.
  5592         16  BBEN-ATTRB              PIC X.
  5593         16  BBENI                   PIC 9(10)V99.
  5594*        16  BBENI                   PIC 9(12).
  5595         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5596         16  BPREM-LEN               PIC S9(4)  COMP.
  5597         16  BPREM-ATTRB             PIC X.
  5598         16  BPREMI                  PIC S9(9)V99.
  5599*        16  BPREMI                  PIC 9(11).
  5600         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5601         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5602         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5603         16  BEXPIRE-ATTRB           PIC X.
  5604         16  BEXPIRE                 PIC X(8).
  5605         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5606         16  BCRIT-PERD-ATTRB        PIC X.
  5607         16  BCRIT-PERDI             PIC 99.
  5608         16  BCRIT-PERDO REDEFINES
  5609                         BCRIT-PERDI PIC ZZ.
  5610         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5611         16  BALT-BEN-ATTRB          PIC X.
  5612         16  BALT-BENI               PIC 9(10)V99.
  5613*        16  BALT-BENI               PIC 9(12).
  5614         16  BALT-BENO REDEFINES
  5615                           BALT-BENI PIC Z(9).ZZ.
  5616         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5617         16  BALT-PREM-ATTRB         PIC X.
  5618         16  BALT-PREMI              PIC 9(9)V99.
  5619*        16  BALT-PREMI              PIC 9(11).
  5620         16  BALT-PREMO REDEFINES
  5621                          BALT-PREMI PIC Z(7).ZZ-.
  5622         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5623         16  BBEN-CD-ATTRB           PIC X.
  5624         16  BBEN-CD                 PIC XXX.
  5625         16  BCPREM-LEN              PIC S9(4)  COMP.
  5626         16  BCPREM-ATTRB            PIC X.
  5627         16  BCPREMI                 PIC S9(9)V99.
  5628*        16  BCPREMI                 PIC X(11).
  5629         16  BCPREMO REDEFINES BCPREMI
  5630                                     PIC Z(7).99-.
  5631         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5632         16  BCALT-PREM-ATTRB        PIC X.
  5633         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 104
* EL6311.cbl
  5634         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5635         16  BBEN-ABBR-ATTRB         PIC X.
  5636         16  BBEN-ABBR               PIC X(5).
  5637         16  BDIFF-LEN               PIC S9(4)  COMP.
  5638         16  BDIFF-ATTRB             PIC X.
  5639         16  BDIFFO                  PIC Z(7).99-.
  5640         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5641         16  BBILL-LIT-ATTRB         PIC X.
  5642         16  BBILL-LIT               PIC X(8).
  5643         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5644         16  BDALT-PREM-ATTRB        PIC X.
  5645         16  BDALT-PREM              PIC Z(7).99-.
  5646
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 105
* EL6311.cbl
  5648
  5649****************************************************************
  5650*
  5651* Copyright (c) 2007 by Clerity Solutions, Inc.
  5652* All rights reserved.
  5653*
  5654****************************************************************
  5655 01  DFHEIV.
  5656   02  DFHEIV0               PIC X(35).
  5657   02  DFHEIV1               PIC X(08).
  5658   02  DFHEIV2               PIC X(08).
  5659   02  DFHEIV3               PIC X(08).
  5660   02  DFHEIV4               PIC X(06).
  5661   02  DFHEIV5               PIC X(04).
  5662   02  DFHEIV6               PIC X(04).
  5663   02  DFHEIV7               PIC X(02).
  5664   02  DFHEIV8               PIC X(02).
  5665   02  DFHEIV9               PIC X(01).
  5666   02  DFHEIV10              PIC S9(7) COMP-3.
  5667   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5668   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5669   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5670   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5671   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5672   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5673   02  DFHEIV17              PIC X(04).
  5674   02  DFHEIV18              PIC X(04).
  5675   02  DFHEIV19              PIC X(04).
  5676   02  DFHEIV20              USAGE IS POINTER.
  5677   02  DFHEIV21              USAGE IS POINTER.
  5678   02  DFHEIV22              USAGE IS POINTER.
  5679   02  DFHEIV23              USAGE IS POINTER.
  5680   02  DFHEIV24              USAGE IS POINTER.
  5681   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5682   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5683   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5684   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5685   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5686   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5687   02  FILLER                PIC X(02).
  5688   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5689   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5690   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5691   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5692   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5693 LINKAGE  SECTION.
  5694*****************************************************************
  5695*                                                               *
  5696* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5697* All rights reserved.                                          *
  5698*                                                               *
  5699*****************************************************************
  5700 01  dfheiblk.
  5701     02  eibtime          pic s9(7) comp-3.
  5702     02  eibdate          pic s9(7) comp-3.
  5703     02  eibtrnid         pic x(4).
  5704     02  eibtaskn         pic s9(7) comp-3.
  5705     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 106
* EL6311.cbl
  5706     02  dfheigdi         pic s9(4) comp.
  5707     02  eibcposn         pic s9(4) comp.
  5708     02  eibcalen         pic s9(4) comp.
  5709     02  eibaid           pic x(1).
  5710     02  eibfiller1       pic x(1).
  5711     02  eibfn            pic x(2).
  5712     02  eibfiller2       pic x(2).
  5713     02  eibrcode         pic x(6).
  5714     02  eibfiller3       pic x(2).
  5715     02  eibds            pic x(8).
  5716     02  eibreqid         pic x(8).
  5717     02  eibrsrce         pic x(8).
  5718     02  eibsync          pic x(1).
  5719     02  eibfree          pic x(1).
  5720     02  eibrecv          pic x(1).
  5721     02  eibsend          pic x(1).
  5722     02  eibatt           pic x(1).
  5723     02  eibeoc           pic x(1).
  5724     02  eibfmh           pic x(1).
  5725     02  eibcompl         pic x(1).
  5726     02  eibsig           pic x(1).
  5727     02  eibconf          pic x(1).
  5728     02  eiberr           pic x(1).
  5729     02  eibrldbk         pic x(1).
  5730     02  eiberrcd         pic x(4).
  5731     02  eibsynrb         pic x(1).
  5732     02  eibnodat         pic x(1).
  5733     02  eibfiller5       pic x(2).
  5734     02  eibresp          pic 9(09) comp.
  5735     02  eibresp2         pic 9(09) comp.
  5736     02  dfheigdj         pic s9(4) comp.
  5737     02  dfheigdk         pic s9(4) comp.
  5738 01  DFHCOMMAREA                 PIC X(1300).
  5739
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 107
* EL6311.cbl
  5741*    COPY ERCPNDB.
  5742******************************************************************
  5743*                                                                *
  5744*                                                                *
  5745*                            ERCPNDB.                            *
  5746*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5747*                            VMOD=2.025                          *
  5748*                                                                *
  5749*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5750*                                                                *
  5751******************************************************************
  5752*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5753*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5754******************************************************************
  5755*                                                                *
  5756*                                                                *
  5757*   FILE TYPE = VSAM,KSDS                                        *
  5758*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5759*                                                                *
  5760*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5761*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5762*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5763*                                                 RKP=13,LEN=36  *
  5764*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5765*                                      AND CHG-SEQ.)             *
  5766*                                                RKP=49,LEN=11   *
  5767*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5768*                                      AND CHG-SEQ.)             *
  5769*                                                RKP=60,LEN=15   *
  5770*                                                                *
  5771*   LOG = NO                                                     *
  5772*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5773******************************************************************
  5774******************************************************************
  5775*                   C H A N G E   L O G
  5776*
  5777* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5778*-----------------------------------------------------------------
  5779*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5780* EFFECTIVE    NUMBER
  5781*-----------------------------------------------------------------
  5782* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5783* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5784* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5785* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5786* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5787* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5788* 032306                   PEMA  ADD BOW LOAN NUMBER
  5789* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5790* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5791* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5792* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5793* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5794* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5795* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5796* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5797******************************************************************
  5798
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 108
* EL6311.cbl
  5799 01  PENDING-BUSINESS.
  5800     12  PB-RECORD-ID                     PIC XX.
  5801         88  VALID-PB-ID                        VALUE 'PB'.
  5802
  5803     12  PB-CONTROL-PRIMARY.
  5804         16  PB-COMPANY-CD                PIC X.
  5805         16  PB-ENTRY-BATCH               PIC X(6).
  5806         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5807         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5808
  5809     12  PB-CONTROL-BY-ACCOUNT.
  5810         16  PB-COMPANY-CD-A1             PIC X.
  5811         16  PB-CARRIER                   PIC X.
  5812         16  PB-GROUPING.
  5813             20  PB-GROUPING-PREFIX       PIC XXX.
  5814             20  PB-GROUPING-PRIME        PIC XXX.
  5815         16  PB-STATE                     PIC XX.
  5816         16  PB-ACCOUNT.
  5817             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5818             20  PB-ACCOUNT-PRIME         PIC X(6).
  5819         16  PB-CERT-EFF-DT               PIC XX.
  5820         16  PB-CERT-NO.
  5821             20  PB-CERT-PRIME            PIC X(10).
  5822             20  PB-CERT-SFX              PIC X.
  5823         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5824
  5825         16  PB-RECORD-TYPE               PIC X.
  5826             88  PB-MAILING-DATA                VALUE '0'.
  5827             88  PB-ISSUE                       VALUE '1'.
  5828             88  PB-CANCELLATION                VALUE '2'.
  5829             88  PB-BATCH-TRAILER               VALUE '9'.
  5830
  5831     12  PB-CONTROL-BY-ORIG-BATCH.
  5832         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5833         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5834         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5835         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5836
  5837     12  PB-CONTROL-BY-CSR.
  5838         16  PB-CSR-COMPANY-CD            PIC X.
  5839         16  PB-CSR-ID                    PIC X(4).
  5840         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5841         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5842         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5843******************************************************************
  5844*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5845******************************************************************
  5846
  5847     12  PB-LAST-MAINT-DT                 PIC XX.
  5848     12  PB-LAST-MAINT-BY                 PIC X(4).
  5849     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5850
  5851     12  PB-RECORD-BODY                   PIC X(375).
  5852
  5853     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5854         16  PB-CERT-ORIGIN               PIC X.
  5855             88  CLASIC-CREATED-CERT         VALUE '1'.
  5856         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 109
* EL6311.cbl
  5857             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5858             20  PB-I-INSURED-FIRST-NAME.
  5859                 24  PB-I-INSURED-1ST-INIT PIC X.
  5860                 24  FILLER                PIC X(9).
  5861             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5862         16  PB-I-AGE                     PIC S99   COMP-3.
  5863         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5864         16  PB-I-BIRTHDAY                PIC XX.
  5865         16  PB-I-INSURED-SEX             PIC X.
  5866             88  PB-SEX-MALE     VALUE 'M'.
  5867             88  PB-SEX-FEMALE   VALUE 'F'.
  5868
  5869         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5870         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5871         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5872         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5873         16  PB-I-SKIP-CODE               PIC X.
  5874             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5875             88  PB-SKIP-JULY              VALUE '1'.
  5876             88  PB-SKIP-AUGUST            VALUE '2'.
  5877             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5878             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5879             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5880             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5881             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5882             88  PB-SKIP-JUNE              VALUE '8'.
  5883             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5884             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5885             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5886         16  PB-I-TERM-TYPE               PIC X.
  5887             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5888             88  PB-PAID-WEEKLY            VALUE 'W'.
  5889             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5890             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5891             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5892         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5893         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5894         16  PB-I-DATA-ENTRY-SW           PIC X.
  5895             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5896             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5897             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5898             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5899         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5900         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5901*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5902         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5903         16  FILLER                       PIC X.
  5904
  5905         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5906             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5907             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5908                                                   '90' THRU '99'.
  5909         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5910                                          PIC XX.
  5911         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5912         16  PB-I-AMOUNT-FINANCED REDEFINES
  5913                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5914         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 110
* EL6311.cbl
  5915         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5916                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5917         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5918         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5919         16  PB-I-CLP-AMOUNT REDEFINES
  5920                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5921         16  PB-I-LF-CALC-FLAG            PIC X.
  5922             88 PB-COMP-LF-PREM               VALUE '?'.
  5923         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5924         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5925         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5926         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5927         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5928         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5929         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5930         16  PB-I-LF-ABBR                 PIC XXX.
  5931         16  PB-I-LF-INPUT-CD             PIC XX.
  5932
  5933         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5934             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5935             88  PB-INVALID-AH               VALUE '  ' '00'
  5936                                                   '90' THRU '99'.
  5937         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5938         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5939         16  PB-I-AH-CALC-FLAG            PIC X.
  5940             88 PB-COMP-AH-PREM                  VALUE '?'.
  5941         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5942         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5943         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5944         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5945         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5946         16  PB-I-AH-ABBR                 PIC XXX.
  5947         16  PB-I-AH-INPUT-CD             PIC XXX.
  5948
  5949         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5950         16  PB-I-REIN-TABLE              PIC XXX.
  5951         16  PB-I-BUSINESS-TYPE           PIC 99.
  5952         16  PB-I-INDV-GRP-CD             PIC X.
  5953         16  PB-I-MORT-CODE.
  5954             20  PB-I-TABLE               PIC X.
  5955             20  PB-I-INTEREST            PIC XX.
  5956             20  PB-I-MORT-TYP            PIC X.
  5957         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5958         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5959         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5960         16  PB-I-INDV-GRP-OVRD           PIC X.
  5961         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5962         16  PB-I-SIG-SW                  PIC X.
  5963             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5964         16  PB-I-RATE-CLASS              PIC XX.
  5965         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5966         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5967         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5968         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5969         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5970         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5971         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5972         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 111
* EL6311.cbl
  5973         16  PB-I-OB-FLAG                 PIC X.
  5974             88  PB-I-OB                      VALUE 'B'.
  5975             88  PB-I-SUMMARY                 VALUE 'Z'.
  5976         16  PB-I-ENTRY-STATUS            PIC X.
  5977             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5978                                              'M' '5' '9' '2'.
  5979             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5980             88  PB-I-POLICY-PENDING          VALUE '2'.
  5981             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5982             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5983             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5984             88  PB-I-REIN-ONLY               VALUE '9'.
  5985             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5986             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5987             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5988             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5989         16  PB-I-INT-CODE                PIC X.
  5990             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5991             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5992         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5993         16  PB-I-SOC-SEC-NO              PIC X(11).
  5994         16  PB-I-MEMBER-NO               PIC X(12).
  5995         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5996*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5997         16  PB-I-OLD-LOF                 PIC XXX.
  5998         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5999         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6000         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6001         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6002         16  PB-I-LIFE-INDICATOR          PIC X.
  6003             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6004         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6005         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6006                                          PIC S9(5)V99    COMP-3.
  6007         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6008             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6009             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6010         16  PB-I-1ST-PMT-DT              PIC XX.
  6011         16  PB-I-JOINT-INSURED.
  6012             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6013             20 PB-I-JOINT-FIRST-NAME.
  6014                24  PB-I-JOINT-FIRST-INIT PIC X.
  6015                24  FILLER                PIC X(9).
  6016             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6017*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6018         16  PB-I-BENEFICIARY-NAME.
  6019             20  PB-I-BANK-NUMBER         PIC X(10).
  6020             20  FILLER                   PIC X(15).
  6021         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6022         16  PB-I-REFERENCE               PIC X(12).
  6023         16  FILLER REDEFINES PB-I-REFERENCE.
  6024             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6025             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6026             20  PB-I-CLP-STATE           PIC XX.
  6027         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6028             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6029             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6030             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 112
* EL6311.cbl
  6031         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6032         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6033         16  PB-I-RESIDENT-STATE          PIC XX.
  6034         16  PB-I-RATE-CODE               PIC X(4).
  6035         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6036         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6037         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6038         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6039         16  PB-I-BANK-NOCHRGB            PIC 99.
  6040         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6041         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6042
  6043     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6044         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6045             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6046         16  PB-C-CANCEL-ORIGIN           PIC X.
  6047             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6048         16  PB-C-LF-CANCEL-DT            PIC XX.
  6049         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6050         16  PB-C-LF-CALC-REQ             PIC X.
  6051             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6052         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6053         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6054         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6055             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6056         16  PB-C-AH-CANCEL-DT            PIC XX.
  6057         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6058         16  PB-C-AH-CALC-REQ             PIC X.
  6059             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6060         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6061         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6062         16  PB-C-LAST-NAME               PIC X(15).
  6063         16  PB-C-REFUND-SW               PIC X.
  6064             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6065             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6066         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6067         16  PB-C-PAYEE-CODE              PIC X(6).
  6068         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6069         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6070         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6071         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6072         16  PB-C-REFERENCE               PIC X(12).
  6073         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6074         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6075         16  PB-C-POST-CARD-IND           PIC X.
  6076         16  PB-C-CANCEL-REASON           PIC X.
  6077         16  PB-C-REF-INTERFACE-SW        PIC X.
  6078         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6079         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6080         16  FILLER                       PIC X(01).
  6081*        16  FILLER                       PIC X(18).
  6082         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6083*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6084         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6085         16  PB-CANCELED-CERT-DATA.
  6086             20  PB-CI-INSURED-NAME.
  6087                 24  PB-CI-LAST-NAME      PIC X(15).
  6088                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 113
* EL6311.cbl
  6089             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6090             20  PB-CI-INSURED-SEX        PIC X.
  6091             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6092             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6093             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6094             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6095             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6096             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6097             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6098             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6099             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6100             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6101             20  PB-CI-RATE-CLASS         PIC XX.
  6102             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6103             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6104             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6105             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6106             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6107             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6108             20  PB-CI-LF-ABBR            PIC X(3).
  6109             20  PB-CI-AH-ABBR            PIC X(3).
  6110             20  PB-CI-OB-FLAG            PIC X.
  6111                 88  PB-CI-OB                VALUE 'B'.
  6112             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6113                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6114                                           'M' '4' '5' '9' '2'.
  6115                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6116                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6117                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6118                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6119                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6120                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6121                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6122                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6123                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6124                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6125                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6126                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6127             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6128                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6129                                           'M' '4' '5' '9' '2'.
  6130                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6131                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6132                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6133                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6134                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6135                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6136                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6137                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6138                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6139                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6140                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6141                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6142             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6143             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6144             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6145             20  PB-CI-MEMBER-NO          PIC X(12).
  6146             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 114
* EL6311.cbl
  6147                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6148                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6149             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6150             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6151             20  PB-CI-COMP-EXCP-SW       PIC X.
  6152                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6153                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6154             20  PB-CI-ENTRY-STATUS       PIC X.
  6155             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6156             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6157             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6158             20  PB-CI-DEATH-DT           PIC XX.
  6159             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6160             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6161             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6162             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6163             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6164             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6165             20  PB-CI-ENTRY-DT              PIC XX.
  6166             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6167             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6168             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6169             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6170             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6171             20  PB-CI-OLD-LOF               PIC XXX.
  6172*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6173             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6174             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6175             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6176             20  PB-CI-INDV-GRP-CD           PIC X.
  6177             20  PB-CI-BENEFICIARY-NAME.
  6178                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6179                 24  FILLER                  PIC X(15).
  6180             20  PB-CI-NOTE-SW               PIC X.
  6181             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6182             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6183             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6184             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6185             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6186             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6187             20  PB-CI-FIRST-NAME            PIC X(10).
  6188             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6189
  6190         16  FILLER                       PIC X(13).
  6191*032306  16  FILLER                       PIC X(27).
  6192*        16  FILLER                       PIC X(46).
  6193
  6194     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6195         16  FILLER                       PIC X(10).
  6196         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6197         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6198         16  PB-M-INSURED-MID-INIT        PIC X.
  6199         16  PB-M-INSURED-AGE             PIC 99.
  6200         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6201         16  PB-M-INSURED-SEX             PIC X.
  6202         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6203         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6204         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 115
* EL6311.cbl
  6205         16  PB-M-INSURED-CITY-STATE.
  6206             20  PB-M-INSURED-CITY        PIC X(28).
  6207             20  PB-M-INSURED-STATE       PIC XX.
  6208         16  PB-M-INSURED-ZIP-CODE.
  6209             20  PB-M-INSURED-ZIP-PRIME.
  6210                 24  PB-M-INSURED-ZIP-1   PIC X.
  6211                     88  PB-M-CANADIAN-POST-CODE
  6212                                             VALUE 'A' THRU 'Z'.
  6213                 24  FILLER               PIC X(4).
  6214             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6215         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6216                                        PB-M-INSURED-ZIP-CODE.
  6217             20  PM-M-INS-CAN-POST1       PIC XXX.
  6218             20  PM-M-INS-CAN-POST2       PIC XXX.
  6219             20  FILLER                   PIC XXX.
  6220         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6221         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6222         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6223         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6224         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6225         16  PB-M-CRED-BENE-CITYST.
  6226             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6227             20  PB-M-CRED-BENE-STATE     PIC XX.
  6228         16  FILLER                       PIC X(92).
  6229
  6230     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6231         16  FILLER                       PIC X(10).
  6232         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6233         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6234         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6235         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6236         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6237         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6238         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6239         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6240         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6241         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6242         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6243         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6244         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6245         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6246         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6247         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6248         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6249         16  PB-ACCOUNT-NAME              PIC X(30).
  6250         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6251         16  PB-REFERENCE                 PIC X(12).
  6252         16  PB-B-RECEIVED-DT             PIC XX.
  6253         16  FILLER                       PIC X(234).
  6254
  6255     12  PB-RECORD-STATUS.
  6256         16  PB-CREDIT-SELECT-DT          PIC XX.
  6257         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6258         16  PB-BILLED-DT                 PIC XX.
  6259         16  PB-BILLING-STATUS            PIC X.
  6260             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6261             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6262             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 116
* EL6311.cbl
  6263         16  PB-RECORD-BILL               PIC X.
  6264             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6265             88  PB-RECORD-RETURNED           VALUE 'R'.
  6266             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6267             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6268             88  PB-OVERRIDE-AH               VALUE 'A'.
  6269             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6270         16  PB-BATCH-ENTRY               PIC X.
  6271             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6272             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6273             88  PB-REISSUED-CERT             VALUE 'E'.
  6274             88  PB-MONTHLY-CERT              VALUE 'M'.
  6275             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6276             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6277             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6278         16  PB-FORCE-CODE                PIC X.
  6279             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6280             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6281             88  PB-CANCEL-FORCE              VALUE '8'.
  6282             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6283             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6284             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6285             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6286             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6287             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6288             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6289         16  PB-FATAL-FLAG                PIC X.
  6290             88  PB-FATAL-ERRORS              VALUE 'X'.
  6291         16  PB-FORCE-ER-CD               PIC X.
  6292             88  PB-FORCE-ERRORS              VALUE 'F'.
  6293             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6294         16  PB-WARN-ER-CD                PIC X.
  6295             88  PB-WARNING-ERRORS            VALUE 'W'.
  6296         16  FILLER                       PIC X.
  6297         16  PB-OUT-BAL-CD                PIC X.
  6298             88  PB-OUT-OF-BAL                VALUE 'O'.
  6299         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6300         16  PB-AH-OVERRIDE-L1            PIC X.
  6301         16  PB-INPUT-DT                  PIC XX.
  6302         16  PB-INPUT-BY                  PIC X(4).
  6303         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6304         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6305         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6306         16  PB-LF-EARNING-METHOD         PIC X.
  6307         16  PB-AH-EARNING-METHOD         PIC X.
  6308         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6309         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6310         16  PB-REIN-CD                   PIC XXX.
  6311         16  PB-LF-REFUND-TYPE            PIC X.
  6312         16  PB-AH-REFUND-TYPE            PIC X.
  6313         16  PB-ACCT-EFF-DT               PIC XX.
  6314         16  PB-ACCT-EXP-DT               PIC XX.
  6315         16  PB-COMPANY-ID                PIC X(3).
  6316         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6317         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6318         16  PB-SV-CARRIER                PIC X.
  6319         16  PB-SV-GROUPING               PIC X(6).
  6320         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 117
* EL6311.cbl
  6321         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6322         16  PB-GA-BILLING-INFO.
  6323             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6324                                          PIC XX.
  6325         16  PB-SV-REMIT-TO  REDEFINES
  6326             PB-GA-BILLING-INFO           PIC X(10).
  6327         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6328         16  PB-I-LOAN-OFFICER            PIC X(5).
  6329         16  PB-I-VIN                     PIC X(17).
  6330
  6331         16  FILLER                       PIC X(04).
  6332         16  IMNET-BYPASS-SW              PIC X.
  6333
  6334******************************************************************
  6335*                COMMON EDIT ERRORS                              *
  6336******************************************************************
  6337
  6338     12  PB-COMMON-ERRORS.
  6339         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6340                                           PIC S9(4)     COMP.
  6341
  6342******************************************************************
  6343
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 118
* EL6311.cbl
  6345*    COPY ELCCERT.
  6346******************************************************************
  6347*                                                                *
  6348*                            ELCCERT.                            *
  6349*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6350*                            VMOD=2.013                          *
  6351*                                                                *
  6352*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6353*                                                                *
  6354*   FILE TYPE = VSAM,KSDS                                        *
  6355*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6356*                                                                *
  6357*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6358*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6359*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6360*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6361*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6362*                                                                *
  6363*   LOG = YES                                                    *
  6364*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6365******************************************************************
  6366*                   C H A N G E   L O G
  6367*
  6368* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6369*-----------------------------------------------------------------
  6370*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6371* EFFECTIVE    NUMBER
  6372*-----------------------------------------------------------------
  6373* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6374* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6375* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6376* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6377* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6378* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6379* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6380* 032612  CR2011110200001  PEMA  AHL CHANGES
  6381******************************************************************
  6382
  6383 01  CERTIFICATE-MASTER.
  6384     12  CM-RECORD-ID                      PIC XX.
  6385         88  VALID-CM-ID                      VALUE 'CM'.
  6386
  6387     12  CM-CONTROL-PRIMARY.
  6388         16  CM-COMPANY-CD                 PIC X.
  6389         16  CM-CARRIER                    PIC X.
  6390         16  CM-GROUPING.
  6391             20  CM-GROUPING-PREFIX        PIC X(3).
  6392             20  CM-GROUPING-PRIME         PIC X(3).
  6393         16  CM-STATE                      PIC XX.
  6394         16  CM-ACCOUNT.
  6395             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6396             20  CM-ACCOUNT-PRIME          PIC X(6).
  6397         16  CM-CERT-EFF-DT                PIC XX.
  6398         16  CM-CERT-NO.
  6399             20  CM-CERT-PRIME             PIC X(10).
  6400             20  CM-CERT-SFX               PIC X.
  6401
  6402     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 119
* EL6311.cbl
  6403         16  CM-COMPANY-CD-A1              PIC X.
  6404         16  CM-INSURED-LAST-NAME          PIC X(15).
  6405         16  CM-INSURED-INITIALS.
  6406             20  CM-INSURED-INITIAL1       PIC X.
  6407             20  CM-INSURED-INITIAL2       PIC X.
  6408
  6409     12  CM-CONTROL-BY-SSN.
  6410         16  CM-COMPANY-CD-A2              PIC X.
  6411         16  CM-SOC-SEC-NO.
  6412             20  CM-SSN-STATE              PIC XX.
  6413             20  CM-SSN-ACCOUNT            PIC X(6).
  6414             20  CM-SSN-LN3.
  6415                 25  CM-INSURED-INITIALS-A2.
  6416                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6417                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6418                 25 CM-PART-LAST-NAME-A2         PIC X.
  6419
  6420     12  CM-CONTROL-BY-CERT-NO.
  6421         16  CM-COMPANY-CD-A4              PIC X.
  6422         16  CM-CERT-NO-A4                 PIC X(11).
  6423
  6424     12  CM-CONTROL-BY-MEMB.
  6425         16  CM-COMPANY-CD-A5              PIC X.
  6426         16  CM-MEMBER-NO.
  6427             20  CM-MEMB-STATE             PIC XX.
  6428             20  CM-MEMB-ACCOUNT           PIC X(6).
  6429             20  CM-MEMB-LN4.
  6430                 25  CM-INSURED-INITIALS-A5.
  6431                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6432                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6433                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6434
  6435     12  CM-INSURED-PROFILE-DATA.
  6436         16  CM-INSURED-FIRST-NAME.
  6437             20  CM-INSURED-1ST-INIT       PIC X.
  6438             20  FILLER                    PIC X(9).
  6439         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6440         16  CM-INSURED-SEX                PIC X.
  6441             88  CM-SEX-MALE                  VALUE 'M'.
  6442             88  CM-SEX-FEMAL                 VALUE 'F'.
  6443         16  CM-INSURED-JOINT-AGE          PIC 99.
  6444         16  CM-JOINT-INSURED-NAME.
  6445             20  CM-JT-LAST-NAME           PIC X(15).
  6446             20  CM-JT-FIRST-NAME.
  6447                 24  CM-JT-1ST-INIT        PIC X.
  6448                 24  FILLER                PIC X(9).
  6449             20  CM-JT-INITIAL             PIC X.
  6450
  6451     12  CM-LIFE-DATA.
  6452         16  CM-LF-BENEFIT-CD              PIC XX.
  6453         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6454         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6455         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6456         16  CM-LF-DEV-CODE                PIC XXX.
  6457         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6458         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6459         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6460         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 120
* EL6311.cbl
  6461         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6462         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6463         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6464         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6465         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6466         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6467         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6468         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6469         16  FILLER                        PIC XX.
  6470
  6471     12  CM-AH-DATA.
  6472         16  CM-AH-BENEFIT-CD              PIC XX.
  6473         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6474         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6475         16  CM-AH-DEV-CODE                PIC XXX.
  6476         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6477         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6478         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6479         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6480         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6481         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6482         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6483         16  CM-AH-PAID-THRU-DT            PIC XX.
  6484             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6485         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6486         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6487         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6488         16  FILLER                        PIC X.
  6489
  6490     12  CM-LOAN-INFORMATION.
  6491         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6492         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6493                                           PIC S9(5)V99  COMP-3.
  6494         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6495         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6496         16  CM-PAY-FREQUENCY              PIC S99.
  6497         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6498         16  CM-RATE-CLASS                 PIC XX.
  6499         16  CM-BENEFICIARY                PIC X(25).
  6500         16  CM-POLICY-FORM-NO             PIC X(12).
  6501         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6502         16  CM-LAST-ADD-ON-DT             PIC XX.
  6503         16  CM-DEDUCTIBLE-AMOUNTS.
  6504             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6505             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6506         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6507             20  CM-RESIDENT-STATE         PIC XX.
  6508             20  CM-RATE-CODE              PIC X(4).
  6509             20  FILLER                    PIC XX.
  6510         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6511             20  CM-LOAN-OFFICER           PIC X(5).
  6512             20  FILLER                    PIC XXX.
  6513         16  CM-CSR-CODE                   PIC XXX.
  6514         16  CM-UNDERWRITING-CODE          PIC X.
  6515             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6516         16  CM-POST-CARD-IND              PIC X.
  6517         16  CM-NH-INTERFACE-SW            PIC X.
  6518         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 121
* EL6311.cbl
  6519             88  CM-SING-PRM                  VALUE '1'.
  6520             88  CM-O-B-COVERAGE              VALUE '2'.
  6521             88  CM-OPEN-END                  VALUE '3'.
  6522         16  CM-IND-GRP-TYPE               PIC X.
  6523             88  CM-INDIVIDUAL                VALUE 'I'.
  6524             88  CM-GROUP                     VALUE 'G'.
  6525         16  CM-SKIP-CODE                  PIC X.
  6526             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6527             88  SKIP-JULY                    VALUE '1'.
  6528             88  SKIP-AUGUST                  VALUE '2'.
  6529             88  SKIP-SEPTEMBER               VALUE '3'.
  6530             88  SKIP-JULY-AUG                VALUE '4'.
  6531             88  SKIP-AUG-SEPT                VALUE '5'.
  6532             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6533             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6534             88  SKIP-JUNE                    VALUE '8'.
  6535             88  SKIP-JUNE-JULY               VALUE '9'.
  6536             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6537             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6538         16  CM-PAYMENT-MODE               PIC X.
  6539             88  PAY-MONTHLY                  VALUE SPACE.
  6540             88  PAY-WEEKLY                   VALUE '1'.
  6541             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6542             88  PAY-BI-WEEKLY                VALUE '3'.
  6543             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6544         16  CM-LOAN-NUMBER                PIC X(8).
  6545         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6546         16  CM-OLD-LOF                    PIC XXX.
  6547*        16  CM-LOAN-OFFICER               PIC XXX.
  6548         16  CM-REIN-TABLE                 PIC XXX.
  6549         16  CM-SPECIAL-REIN-CODE          PIC X.
  6550         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6551         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6552         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6553
  6554     12  CM-STATUS-DATA.
  6555         16  CM-ENTRY-STATUS               PIC X.
  6556         16  CM-ENTRY-DT                   PIC XX.
  6557
  6558         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6559         16  CM-LF-CANCEL-DT               PIC XX.
  6560         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6561
  6562         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6563         16  CM-LF-DEATH-DT                PIC XX.
  6564         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6565
  6566         16  CM-LF-CURRENT-STATUS          PIC X.
  6567             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6568                                                'M' '4' '5' '9'.
  6569             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6570             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6571             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6572             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6573             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6574             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6575             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6576             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 122
* EL6311.cbl
  6577             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6578             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6579             88  CM-LF-DECLINED               VALUE 'D'.
  6580             88  CM-LF-VOIDED                 VALUE 'V'.
  6581
  6582         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6583         16  CM-AH-CANCEL-DT               PIC XX.
  6584         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6585
  6586         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6587         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6588         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6589
  6590         16  CM-AH-CURRENT-STATUS          PIC X.
  6591             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6592                                                'M' '4' '5' '9'.
  6593             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6594             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6595             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6596             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6597             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6598             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6599             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6600             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6601             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6602             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6603             88  CM-AH-DECLINED               VALUE 'D'.
  6604             88  CM-AH-VOIDED                 VALUE 'V'.
  6605
  6606         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6607             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6608             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6609             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6610         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6611
  6612         16  CM-ENTRY-BATCH                PIC X(6).
  6613         16  CM-LF-EXIT-BATCH              PIC X(6).
  6614         16  CM-AH-EXIT-BATCH              PIC X(6).
  6615         16  CM-LAST-MONTH-END             PIC XX.
  6616
  6617     12  CM-NOTE-SW                        PIC X.
  6618         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6619         88  CERT-NOTES-PRESENT               VALUE '1'.
  6620         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6621         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6622         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6623         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6624         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6625         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6626     12  CM-COMP-EXCP-SW                   PIC X.
  6627         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6628         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6629     12  CM-INSURED-ADDRESS-SW             PIC X.
  6630         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6631         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6632
  6633*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6634     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 123
* EL6311.cbl
  6635     12  FILLER                            PIC X.
  6636
  6637*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6638     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6639     12  FILLER                            PIC X.
  6640*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6641     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6642
  6643     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6644         88  CERT-ADDED-BATCH                 VALUE ' '.
  6645         88  CERT-ADDED-ONLINE                VALUE '1'.
  6646         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6647         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6648         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6649     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6650         88  CERT-AS-LOADED                   VALUE ' '.
  6651         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6652         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6653         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6654         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6655         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6656         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6657         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6658
  6659     12  CM-ACCOUNT-COMM-PCTS.
  6660         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6661         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6662
  6663     12  CM-USER-FIELD                     PIC X.
  6664     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6665     12  CM-CLP-STATE                      PIC XX.
  6666     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6667     12  CM-USER-RESERVED                  PIC XXX.
  6668     12  FILLER REDEFINES CM-USER-RESERVED.
  6669         16  CM-AH-CLASS-CD                PIC XX.
  6670         16  F                             PIC X.
  6671******************************************************************
  6672
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 124
* EL6311.cbl
  6674*    COPY ERCNOTE.
  6675******************************************************************
  6676*                                                                *
  6677*                                                                *
  6678*                            ERCNOTE                             *
  6679*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6680*                            VMOD=2.003                          *
  6681*                                                                *
  6682*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6683*                                                                *
  6684*        FILE TYPE= VSAM,KSDS                                    *
  6685*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6686*                                                                *
  6687*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6688*                                                                *
  6689*        LOG = YES                                               *
  6690*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6691*                                                                *
  6692******************************************************************
  6693*                   C H A N G E   L O G
  6694*
  6695* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6696*-----------------------------------------------------------------
  6697*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6698* EFFECTIVE    NUMBER
  6699*-----------------------------------------------------------------
  6700* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6701*                                FILE WILL CONTAIN BILLING NOTES O
  6702******************************************************************
  6703
  6704 01  CERTIFICATE-NOTE.
  6705     12  CN-RECORD-ID                PIC  XX.
  6706         88  VALID-CN-ID                  VALUE 'CN'.
  6707
  6708     12  CN-CONTROL-PRIMARY.
  6709         16  CN-COMPANY-CD           PIC X.
  6710         16  CN-CARRIER              PIC X.
  6711         16  CN-GROUPING.
  6712             20 CN-GROUPING-PREFIX   PIC XXX.
  6713             20 CN-GROUPING-PRIME    PIC XXX.
  6714         16  CN-STATE                PIC XX.
  6715         16  CN-ACCOUNT.
  6716             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6717             20 CN-ACCOUNT-PRIME     PIC X(6).
  6718         16  CN-CERT-EFF-DT          PIC XX.
  6719         16  CN-CERT-NO.
  6720             20  CN-CERT-PRIME       PIC X(10).
  6721             20  CN-CERT-SFX         PIC X.
  6722
  6723     12  CN-BILLING-START-LINE-NO    PIC 99.
  6724     12  CN-BILLING-END-LINE-NO      PIC 99.
  6725
  6726     12  CN-LINES.
  6727         16  CN-LINE OCCURS 10       PIC X(77).
  6728
  6729     12  CN-LAST-MAINT-DT            PIC XX.
  6730     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6731     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 125
* EL6311.cbl
  6732     12  FILLER                      PIC X(6).
  6733******************************************************************
  6734
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 126
* EL6311.cbl
  6736*    COPY ERCPNDM.
  6737******************************************************************
  6738*                                                                *
  6739*                                                                *
  6740*                            ERCPNDM                             *
  6741*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6742*                            VMOD=2.003                          *
  6743*                                                                *
  6744*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6745*                                                                *
  6746*   FILE TYPE = VSAM,KSDS                                        *
  6747*   RECORD SIZE = 374   RECFORM = FIX                            *
  6748*                                                                *
  6749*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6750*   ALTERNATE PATH    = NOT USED                                 *
  6751*                                                                *
  6752*   LOG = YES                                                    *
  6753*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6754******************************************************************
  6755*                   C H A N G E   L O G
  6756*
  6757* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6758*-----------------------------------------------------------------
  6759*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6760* EFFECTIVE    NUMBER
  6761*-----------------------------------------------------------------
  6762* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6763* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6764* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6765******************************************************************
  6766
  6767 01  PENDING-MAILING-DATA.
  6768     12  PM-RECORD-ID                      PIC XX.
  6769         88  VALID-MA-ID                       VALUE 'PM'.
  6770
  6771     12  PM-CONTROL-PRIMARY.
  6772         16  PM-COMPANY-CD                 PIC X.
  6773         16  PM-ENTRY-BATCH                PIC X(6).
  6774         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6775         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6776
  6777     12  FILLER                            PIC X(14).
  6778
  6779     12  PM-ACCESS-CONTROL.
  6780         16  PM-SOURCE-SYSTEM              PIC XX.
  6781             88  PM-FROM-CREDIT                VALUE 'CR'.
  6782             88  PM-FROM-VSI                   VALUE 'VS'.
  6783             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6784             88  PM-FROM-OTHER                 VALUE 'OT'.
  6785         16  PM-RECORD-ADD-DT              PIC XX.
  6786         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6787         16  PM-LAST-MAINT-DT              PIC XX.
  6788         16  PM-LAST-MAINT-BY              PIC XXXX.
  6789         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6790
  6791     12  PM-PROFILE-INFO.
  6792         16  PM-QUALIFY-CODE-1             PIC XX.
  6793         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 127
* EL6311.cbl
  6794         16  PM-QUALIFY-CODE-3             PIC XX.
  6795         16  PM-QUALIFY-CODE-4             PIC XX.
  6796         16  PM-QUALIFY-CODE-5             PIC XX.
  6797
  6798         16  PM-INSURED-LAST-NAME          PIC X(15).
  6799         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6800         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6801         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6802         16  PM-INSURED-BIRTH-DT           PIC XX.
  6803         16  PM-INSURED-SEX                PIC X.
  6804             88  PM-SEX-MALE                   VALUE 'M'.
  6805             88  PM-SEX-FEMALE                 VALUE 'F'.
  6806         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6807
  6808         16  PM-ADDRESS-CORRECTED          PIC X.
  6809         16  PM-JOINT-BIRTH-DT             PIC XX.
  6810*        16  FILLER                        PIC X(12).
  6811
  6812         16  PM-ADDRESS-LINE-1             PIC X(30).
  6813         16  PM-ADDRESS-LINE-2             PIC X(30).
  6814         16  PM-CITY-STATE.
  6815             20  PM-CITY                   PIC X(28).
  6816             20  PM-STATE                  PIC XX.
  6817         16  PM-ZIP.
  6818             20  PM-ZIP-CODE.
  6819                 24  PM-ZIP-1              PIC X.
  6820                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6821                 24  FILLER                PIC X(4).
  6822             20  PM-ZIP-PLUS4              PIC X(4).
  6823         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6824             20  PM-CAN-POST1              PIC XXX.
  6825             20  PM-CAN-POST2              PIC XXX.
  6826             20  FILLER                    PIC XXX.
  6827
  6828         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6829
  6830         16  FILLER                        PIC X(03).
  6831
  6832     12  PM-CRED-BENE-INFO.
  6833         16  PM-CRED-BENE-NAME             PIC X(25).
  6834         16  PM-CRED-BENE-ADDR             PIC X(30).
  6835         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6836         16  PM-CRED-BENE-CTYST.
  6837             20  PM-CRED-BENE-CITY         PIC X(28).
  6838             20  PM-CRED-BENE-STATE        PIC XX.
  6839         16  PM-CRED-BENE-ZIP.
  6840             20  PM-CB-ZIP-CODE.
  6841                 24  PM-CB-ZIP-1           PIC X.
  6842                     88  PM-CB-CANADIAN-POST-CODE
  6843                                  VALUE 'A' THRU 'Z'.
  6844                 24  FILLER                PIC X(4).
  6845             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6846         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6847             20  PM-CB-CAN-POST1           PIC XXX.
  6848             20  PM-CB-CAN-POST2           PIC XXX.
  6849             20  FILLER                    PIC XXX.
  6850     12  PM-POST-CARD-MAIL-DATA.
  6851         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 128
* EL6311.cbl
  6852             20  PM-MAIL-TYPE              PIC X.
  6853                 88  PM-12MO-MAILING           VALUE '1'.
  6854                 88  PM-EXP-MAILING            VALUE '2'.
  6855             20  PM-MAIL-STATUS            PIC X.
  6856                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6857                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6858                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6859             20  PM-MAIL-DATE              PIC XX.
  6860     12  FILLER                            PIC XX.
  6861     12  FILLER                            PIC X(12).
  6862*    12  FILLER                            PIC X(30).
  6863
  6864******************************************************************
  6865
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 129
* EL6311.cbl
  6867*    COPY ERCMAIL.
  6868******************************************************************
  6869*                                                                *
  6870*                                                                *
  6871*                            ERCMAIL                             *
  6872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6873*                            VMOD=2.003                          *
  6874*                                                                *
  6875*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6876*                                                                *
  6877*   FILE TYPE = VSAM,KSDS                                        *
  6878*   RECORD SIZE = 374   RECFORM = FIX                            *
  6879*                                                                *
  6880*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6881*   ALTERNATE PATH    = NOT USED                                 *
  6882*                                                                *
  6883*   LOG = YES                                                    *
  6884*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6885******************************************************************
  6886*                   C H A N G E   L O G
  6887*
  6888* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6889*-----------------------------------------------------------------
  6890*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6891* EFFECTIVE    NUMBER
  6892*-----------------------------------------------------------------
  6893* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6894* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6895* 111108                   PEMA  ADD CRED BENE ADDR2
  6896******************************************************************
  6897
  6898 01  MAILING-DATA.
  6899     12  MA-RECORD-ID                      PIC XX.
  6900         88  VALID-MA-ID                       VALUE 'MA'.
  6901
  6902     12  MA-CONTROL-PRIMARY.
  6903         16  MA-COMPANY-CD                 PIC X.
  6904         16  MA-CARRIER                    PIC X.
  6905         16  MA-GROUPING.
  6906             20  MA-GROUPING-PREFIX        PIC XXX.
  6907             20  MA-GROUPING-PRIME         PIC XXX.
  6908         16  MA-STATE                      PIC XX.
  6909         16  MA-ACCOUNT.
  6910             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6911             20  MA-ACCOUNT-PRIME          PIC X(6).
  6912         16  MA-CERT-EFF-DT                PIC XX.
  6913         16  MA-CERT-NO.
  6914             20  MA-CERT-PRIME             PIC X(10).
  6915             20  MA-CERT-SFX               PIC X.
  6916
  6917     12  FILLER                            PIC XX.
  6918
  6919     12  MA-ACCESS-CONTROL.
  6920         16  MA-SOURCE-SYSTEM              PIC XX.
  6921             88  MA-FROM-CREDIT                VALUE 'CR'.
  6922             88  MA-FROM-VSI                   VALUE 'VS'.
  6923             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6924             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 130
* EL6311.cbl
  6925         16  MA-RECORD-ADD-DT              PIC XX.
  6926         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6927         16  MA-LAST-MAINT-DT              PIC XX.
  6928         16  MA-LAST-MAINT-BY              PIC XXXX.
  6929         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6930
  6931     12  MA-PROFILE-INFO.
  6932         16  MA-QUALIFY-CODE-1             PIC XX.
  6933         16  MA-QUALIFY-CODE-2             PIC XX.
  6934         16  MA-QUALIFY-CODE-3             PIC XX.
  6935         16  MA-QUALIFY-CODE-4             PIC XX.
  6936         16  MA-QUALIFY-CODE-5             PIC XX.
  6937
  6938         16  MA-INSURED-LAST-NAME          PIC X(15).
  6939         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6940         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6941         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6942         16  MA-INSURED-BIRTH-DT           PIC XX.
  6943         16  MA-INSURED-SEX                PIC X.
  6944             88  MA-SEX-MALE                   VALUE 'M'.
  6945             88  MA-SEX-FEMALE                 VALUE 'F'.
  6946         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6947
  6948         16  MA-ADDRESS-CORRECTED          PIC X.
  6949         16  MA-JOINT-BIRTH-DT             PIC XX.
  6950*        16  FILLER                        PIC X(12).
  6951
  6952         16  MA-ADDRESS-LINE-1             PIC X(30).
  6953         16  MA-ADDRESS-LINE-2             PIC X(30).
  6954         16  MA-CITY-STATE.
  6955             20  MA-CITY                   PIC X(28).
  6956             20  MA-ADDR-STATE             PIC XX.
  6957         16  MA-ZIP.
  6958             20  MA-ZIP-CODE.
  6959                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6960                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6961                 24  FILLER                PIC X(4).
  6962             20  MA-ZIP-PLUS4              PIC X(4).
  6963         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6964             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6965             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6966             20  FILLER                    PIC X(3).
  6967
  6968         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6969
  6970         16  FILLER                        PIC XXX.
  6971*        16  FILLER                        PIC X(10).
  6972
  6973     12  MA-CRED-BENE-INFO.
  6974         16  MA-CRED-BENE-NAME                 PIC X(25).
  6975         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6976         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6977         16  MA-CRED-BENE-CTYST.
  6978             20  MA-CRED-BENE-CITY             PIC X(28).
  6979             20  MA-CRED-BENE-STATE            PIC XX.
  6980         16  MA-CRED-BENE-ZIP.
  6981             20  MA-CB-ZIP-CODE.
  6982                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 131
* EL6311.cbl
  6983                     88  MA-CB-CANADIAN-POST-CODE
  6984                                           VALUE 'A' THRU 'Z'.
  6985                 24  FILLER                    PIC X(4).
  6986             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6987         16  MA-CB-CANADIAN-POSTAL-CODE
  6988                            REDEFINES MA-CRED-BENE-ZIP.
  6989             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6990             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6991             20  FILLER                        PIC X(3).
  6992     12  MA-POST-CARD-MAIL-DATA.
  6993         16  MA-MAIL-DATA OCCURS 7.
  6994             20  MA-MAIL-TYPE              PIC X.
  6995                 88  MA-12MO-MAILING           VALUE '1'.
  6996                 88  MA-EXP-MAILING            VALUE '2'.
  6997             20  MA-MAIL-STATUS            PIC X.
  6998                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6999                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7000                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7001             20  MA-MAIL-DATE              PIC XX.
  7002     12  FILLER                            PIC XX.
  7003     12  FILLER                            PIC XX.
  7004*    12  FILLER                            PIC X(30).
  7005******************************************************************
  7006
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 132
* EL6311.cbl
  7008*    COPY ERCRQST.
  7009******************************************************************
  7010*                                                                *
  7011*                                                                *
  7012*                            ERCRQST.                            *
  7013*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7014*                            VMOD=2.002                          *
  7015*                                                                *
  7016*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7017*                                                                *
  7018*   FILE TYPE = VSAM,KSDS                                        *
  7019*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7020*                                                                *
  7021*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7022*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7023*                                   ACCOUNT, REF, BATCH)         *
  7024*                                                RKP=9, LEN=38   *
  7025*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7026*                                   ACCOUNT, REF, BATCH)         *
  7027*                                                RKP=47, LEN=46  *
  7028*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7029*                                   BATCH)                       *
  7030*                                                RKP=93, LEN=24  *
  7031*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7032*                                   REF, BATCH)                  *
  7033*                                                RKP=117, LEN=35 *
  7034*   LOG = NO                                                     *
  7035*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7036******************************************************************
  7037
  7038 01  AR-REQUEST-RECORD.
  7039     12  RQ-RECORD-ID                     PIC XX.
  7040         88  VALID-RQ-ID                        VALUE 'RQ'.
  7041
  7042     12  RQ-CONTROL-PRIMARY.
  7043         16  RQ-COMPANY-CD                PIC X.
  7044         16  RQ-ENTRY-BATCH               PIC X(6).
  7045
  7046     12  RQ-CONTROL-BY-ACCT-REF.
  7047         16  RQ-COMPANY-CD-A1             PIC X.
  7048         16  RQ-CARRIER-A1                PIC X.
  7049         16  RQ-GROUPING-A1               PIC X(6).
  7050         16  RQ-STATE-A1                  PIC XX.
  7051         16  RQ-ACCOUNT-A1                PIC X(10).
  7052         16  RQ-REFERENCE-A1              PIC X(12).
  7053         16  RQ-BATCH-A1                  PIC X(6).
  7054
  7055     12  RQ-CONTROL-BY-FIN-RESP.
  7056         16  RQ-COMPANY-CD-A2             PIC X.
  7057         16  RQ-CARRIER-A2                PIC X.
  7058         16  RQ-GROUPING-A2               PIC X(6).
  7059         16  RQ-FIN-RESP-A2               PIC X(10).
  7060         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7061         16  RQ-REFERENCE-A2              PIC X(12).
  7062         16  RQ-BATCH-A2                  PIC X(6).
  7063
  7064     12  RQ-CONTROL-BY-ACCT-AGENT.
  7065         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 133
* EL6311.cbl
  7066         16  RQ-CARRIER-A3                PIC X.
  7067         16  RQ-GROUPING-A3               PIC X(6).
  7068         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7069         16  RQ-BATCH-A3                  PIC X(6).
  7070
  7071     12  RQ-CONTROL-BY-SUMMARY.
  7072         16  RQ-COMPANY-CD-A4             PIC X.
  7073         16  RQ-SUMMARY-CODE              PIC X(6).
  7074         16  RQ-ACCOUNT-A4                PIC X(10).
  7075         16  RQ-REFERENCE-A4              PIC X(12).
  7076         16  RQ-BATCH-A4                  PIC X(6).
  7077
  7078     12  RQ-REQUEST-METHOD                PIC X.
  7079         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7080         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7081         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7082         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7083     12  FILLER                           PIC X.
  7084     12  RQ-STATUS                        PIC X.
  7085         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7086         88  RQ-RESUBMIT                      VALUE 'R'.
  7087     12  RQ-PROCESSOR-ID                  PIC X(4).
  7088     12  RQ-ENTRY-DT                      PIC XX.
  7089     12  RQ-MO-END-DT                     PIC XX.
  7090     12  RQ-REQUEST-DT                    PIC XX.
  7091     12  RQ-STMT-DT                       PIC XX.
  7092     12  RQ-REVERSAL-DT                   PIC XX.
  7093     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7094     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7095
  7096     12  FILLER                           PIC X(27).
  7097
  7098******************************************************************
  7099
  7100
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 134
* EL6311.cbl
  7102*    COPY ERCLOFC.
  7103******************************************************************
  7104*                                                                *
  7105*                                                                *
  7106*                            ERCLOFC                             *
  7107*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7108*                            VMOD=2.003                          *
  7109*                                                                *
  7110*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7111*                                                                *
  7112*   FILE TYPE = VSAM,KSDS                                        *
  7113*   RECORD SIZE = 670   RECFORM = FIX                            *
  7114*                                                                *
  7115*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7116*                                                                *
  7117*   LOG = YES                                                    *
  7118*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7119*                                                                *
  7120******************************************************************
  7121
  7122 01  LOAN-OFFICER-MASTER.
  7123     12  LO-RECORD-ID                PIC XX.
  7124         88  VALID-LO-ID                VALUE 'LO'.
  7125
  7126     12  LO-CONTROL-PRIMARY.
  7127         16  LO-COMPANY-CD           PIC X.
  7128         16  LO-CARRIER              PIC X.
  7129         16  LO-GROUPING.
  7130             20  LO-GROUPING-PREFIX  PIC XXX.
  7131             20  LO-GROUPING-PRIME   PIC XXX.
  7132         16  LO-STATE                PIC XX.
  7133         16  LO-ACCOUNT.
  7134             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7135             20  LO-ACCOUNT-PRIME    PIC X(6).
  7136         16  LO-OFFICER-CODE         PIC X(5).
  7137
  7138     12  LO-OFFICER-NAME             PIC X(30).
  7139
  7140     12  LO-LAST-MAINT-DT            PIC XX.
  7141     12  LO-LAST-USER                PIC X(4).
  7142     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7143
  7144     12  LO-COMP-CONTROL             PIC X.
  7145             88  LO-SHOW-COMP           VALUE 'Y'.
  7146             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7147     12  LO-DETAIL-CONTROL           PIC X.
  7148             88  LO-PRINT-DETAIL        VALUE 'D'.
  7149             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7150
  7151     12  LO-SV-CARRIER               PIC X.
  7152     12  LO-SV-GROUPING              PIC X(6).
  7153     12  LO-SV-STATE                 PIC XX.
  7154
  7155     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7156     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7157
  7158     12  LO-OFFICER-INFO.
  7159         16  FILLER OCCURS 12 TIMES.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 135
* EL6311.cbl
  7160             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7161             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7162             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7163             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7164             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7165             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7166             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7167             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7168     12  FILLER                      PIC X(198).
  7169******************************************************************
  7170
  7171*    COPY ERCPYAJ.
  7172******************************************************************
  7173*                                                                *
  7174*                            ERCPYAJ                             *
  7175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7176*                            VMOD=2.015                          *
  7177*                                                                *
  7178*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7179*                                                                *
  7180*                                                                *
  7181*   FILE TYPE = VSAM,KSDS                                        *
  7182*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7183*                                                                *
  7184*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7185*       ALTERNATE PATHS = NONE                                   *
  7186*                                                                *
  7187*   LOG = YES                                                    *
  7188*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7189******************************************************************
  7190******************************************************************
  7191*                   C H A N G E   L O G
  7192*
  7193* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7194*-----------------------------------------------------------------
  7195*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7196* EFFECTIVE    NUMBER
  7197*-----------------------------------------------------------------
  7198* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7199* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7200******************************************************************
  7201
  7202 01  PENDING-PAY-ADJ.
  7203     12  PY-RECORD-ID                     PIC XX.
  7204         88  VALID-PY-ID                        VALUE 'PY'.
  7205
  7206     12  PY-CONTROL-PRIMARY.
  7207         16  PY-COMPANY-CD                PIC X.
  7208         16  PY-CARRIER                   PIC X.
  7209         16  PY-GROUPING                  PIC X(6).
  7210         16  PY-FIN-RESP                  PIC X(10).
  7211         16  PY-ACCOUNT                   PIC X(10).
  7212         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7213                                          PIC X(10).
  7214         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7215         16  PY-RECORD-TYPE               PIC X.
  7216             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7217             88  PY-DEPOSIT                   VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 136
* EL6311.cbl
  7218             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7219             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7220             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7221             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7222             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7223             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7224             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7225             88  PY-FICA-ENTRY                VALUE 'F'.
  7226             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7227             88  PY-POLICY-FEE                VALUE 'W'.
  7228             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7229
  7230     12  PY-PYMT-TYPE                     PIC X.
  7231             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7232             88  PY-REINS-PYMT                VALUE 'R'.
  7233             88  PY-EXP-PYMT                  VALUE 'E'.
  7234
  7235     12  PY-BIL-INV                       PIC X(6).
  7236     12  PY-REF-NO                        PIC X(12).
  7237
  7238     12  PY-LAST-MAINT-DT                 PIC XX.
  7239     12  PY-LAST-MAINT-BY                 PIC X(4).
  7240     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7241
  7242     12  PY-PYADJ-RECORD.
  7243         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7244         16  PY-ENTRY-COMMENT             PIC X(30).
  7245         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7246             20  PY-GL-ACCOUNT            PIC X(10).
  7247             20  PY-GL-STATE              PIC X(02).
  7248             20  PY-GL-CANC-SW            PIC X(01).
  7249                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7250                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7251             20  PY-GL-COMMENT            PIC X(10).
  7252             20  FILLER      REDEFINES PY-GL-COMMENT.
  7253                 24  PY-GL-CHECK-NO       PIC 9(06).
  7254                 24  FILLER               PIC X(04).
  7255             20  FILLER                   PIC X(07).
  7256         16  PY-SAVE-ACCOUNT              PIC X(10).
  7257         16  PY-SAVE-TYPE                 PIC X(01).
  7258
  7259         16  PY-LETTERS.
  7260             20  PY-LETTER OCCURS 3 TIMES
  7261                           INDEXED BY PY-LET-NDX
  7262                                          PIC X(04).
  7263
  7264         16  PY-ERCOMP-TYPE               PIC X.
  7265             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7266             88  PY-GA-TYPE                   VALUE 'G'.
  7267             88  PY-BANK-TYPE                 VALUE 'B'.
  7268         16  FILLER                       PIC X(05).
  7269
  7270     12  PY-RECORD-STATUS.
  7271         16  PY-CREDIT-SELECT-DT          PIC XX.
  7272         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7273         16  PY-BILLED-DATE               PIC XX.
  7274         16  PY-REPORTED-DT               PIC XX.
  7275         16  PY-PMT-APPLIED               PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 137
* EL6311.cbl
  7276             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7277             88  PY-GA-PMT                    VALUE 'G'.
  7278             88  PY-OVWRITE-PMT               VALUE 'O'.
  7279             88  PY-NON-AR-PMT                VALUE 'N'.
  7280         16  FILLER                       PIC X(5).
  7281         16  PY-INPUT-DT                  PIC XX.
  7282         16  PY-CHECK-NUMBER              PIC X(6).
  7283         16  PY-VOID-SW                   PIC X.
  7284             88  PY-CHECK-VOIDED              VALUE 'V'.
  7285         16  PY-CHECK-ORIGIN-SW           PIC X.
  7286             88  PY-BILLING-CHECK             VALUE 'B'.
  7287             88  PY-REFUND-CHECK              VALUE 'R'.
  7288             88  PY-GA-CHECK                  VALUE 'G'.
  7289             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7290             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7291         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7292         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7293         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7294         16  PY-BILL-FLAG                 PIC X.
  7295             88  PY-BILLED                    VALUE 'B'.
  7296         16  PY-AR-FLAG                   PIC X.
  7297             88  PY-AR-CYCLE                  VALUE 'C'.
  7298             88  PY-AR-MONTH-END              VALUE 'M'.
  7299         16  PY-AR-DATE                   PIC XX.
  7300
  7301     12  PY-GL-CODES.
  7302         16  PY-GL-DB                     PIC X(14).
  7303         16  PY-GL-CR                     PIC X(14).
  7304         16  PY-GL-FLAG                   PIC X.
  7305         16  PY-GL-DATE                   PIC XX.
  7306
  7307     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7308     12  FILLER                           PIC X(3).
  7309******************************************************************
  7310
  7311*    COPY ERCCNOT.
  7312******************************************************************
  7313*                                                                *
  7314*                            ERCCNOT                             *
  7315*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7316*                            VMOD=2.003                          *
  7317*                                                                *
  7318*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7319*                                                                *
  7320*        FILE TYPE= VSAM,KSDS                                    *
  7321*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7322*                                                                *
  7323*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7324*                                                                *
  7325*        LOG = YES                                               *
  7326*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7327*                                                                *
  7328******************************************************************
  7329*                   C H A N G E   L O G
  7330*
  7331* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7332*-----------------------------------------------------------------
  7333*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 138
* EL6311.cbl
  7334* EFFECTIVE    NUMBER
  7335*-----------------------------------------------------------------
  7336* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7337******************************************************************
  7338
  7339 01  CERT-NOTE-FILE.
  7340     12  CZ-RECORD-ID                PIC  XX.
  7341         88  VALID-CZ-ID                  VALUE 'CZ'.
  7342
  7343     12  CZ-CONTROL-PRIMARY.
  7344         16  CZ-COMPANY-CD           PIC X.
  7345         16  CZ-CARRIER              PIC X.
  7346         16  CZ-GROUPING.
  7347             20 CZ-GROUPING-PREFIX   PIC XXX.
  7348             20 CZ-GROUPING-PRIME    PIC XXX.
  7349         16  CZ-STATE                PIC XX.
  7350         16  CZ-ACCOUNT.
  7351             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7352             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7353         16  CZ-CERT-EFF-DT          PIC XX.
  7354         16  CZ-CERT-NO.
  7355             20  CZ-CERT-PRIME       PIC X(10).
  7356             20  CZ-CERT-SFX         PIC X.
  7357         16  CZ-RECORD-TYPE          PIC X.
  7358             88  CERT-NOTE           VALUE '1'.
  7359             88  CLAIM-CERT-NOTE     VALUE '2'.
  7360         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7361
  7362     12  CZ-LAST-MAINT-DT            PIC XX.
  7363     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7364     12  CZ-LAST-MAINT-USER          PIC X(4).
  7365
  7366     12  CZ-NOTE-INFORMATION.
  7367         16  CZ-NOTE                 PIC X(63).
  7368         16  FILLER                  PIC X(39).
  7369******************************************************************
  7370
  7371*    COPY ELCMSTR.
  7372******************************************************************
  7373*                                                                *
  7374*                            ELCMSTR.                            *
  7375*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7376*                            VMOD=2.012                          *
  7377*                                                                *
  7378*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7379*                                                                *
  7380*   FILE TYPE = VSAM,KSDS                                        *
  7381*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7382*                                                                *
  7383*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7384*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7385*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7386*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7387*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7388*                                                 RKP=75,LEN=21  *
  7389*                                                                *
  7390*   **** NOTE ****                                               *
  7391*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 139
* EL6311.cbl
  7392*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7393*                                                                *
  7394*   LOG = YES                                                    *
  7395*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7396******************************************************************
  7397*                   C H A N G E   L O G
  7398*
  7399* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7400*-----------------------------------------------------------------
  7401*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7402* EFFECTIVE    NUMBER
  7403*-----------------------------------------------------------------
  7404* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7405* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7406* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7407******************************************************************
  7408 01  CLAIM-MASTER.
  7409     12  CL-RECORD-ID                PIC XX.
  7410         88  VALID-CL-ID         VALUE 'CL'.
  7411
  7412     12  CL-CONTROL-PRIMARY.
  7413         16  CL-COMPANY-CD           PIC X.
  7414         16  CL-CARRIER              PIC X.
  7415         16  CL-CLAIM-NO             PIC X(7).
  7416         16  CL-CERT-NO.
  7417             20  CL-CERT-PRIME       PIC X(10).
  7418             20  CL-CERT-SFX         PIC X.
  7419
  7420     12  CL-CONTROL-BY-NAME.
  7421         16  CL-COMPANY-CD-A1        PIC X.
  7422         16  CL-INSURED-LAST-NAME    PIC X(15).
  7423         16  CL-INSURED-NAME.
  7424             20  CL-INSURED-1ST-NAME PIC X(12).
  7425             20  CL-INSURED-MID-INIT PIC X.
  7426
  7427     12  CL-CONTROL-BY-SSN.
  7428         16  CL-COMPANY-CD-A2        PIC X.
  7429         16  CL-SOC-SEC-NO.
  7430             20  CL-SSN-STATE        PIC XX.
  7431             20  CL-SSN-ACCOUNT      PIC X(6).
  7432             20  CL-SSN-LN3          PIC X(3).
  7433
  7434     12  CL-CONTROL-BY-CERT-NO.
  7435         16  CL-COMPANY-CD-A4        PIC X.
  7436         16  CL-CERT-NO-A4.
  7437             20  CL-CERT-A4-PRIME    PIC X(10).
  7438             20  CL-CERT-A4-SFX      PIC X.
  7439
  7440     12  CL-CONTROL-BY-CCN.
  7441         16  CL-COMPANY-CD-A5        PIC X.
  7442         16  CL-CCN-A5.
  7443             20  CL-CCN.
  7444                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7445                 24  CL-CCN-PRIME-A5 PIC X(12).
  7446             20  CL-CCN-FILLER-A5    PIC X(4).
  7447
  7448     12  CL-INSURED-PROFILE-DATA.
  7449         16  CL-INSURED-BIRTH-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 140
* EL6311.cbl
  7450         16  CL-INSURED-SEX-CD       PIC X.
  7451             88  INSURED-IS-MALE        VALUE 'M'.
  7452             88  INSURED-IS-FEMALE      VALUE 'F'.
  7453             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7454         16  CL-INSURED-OCC-CD       PIC X(6).
  7455         16  FILLER                  PIC X(5).
  7456
  7457     12  CL-PROCESSING-INFO.
  7458         16  CL-PROCESSOR-ID         PIC X(4).
  7459         16  CL-CLAIM-STATUS         PIC X.
  7460             88  CLAIM-IS-OPEN          VALUE 'O'.
  7461             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7462         16  CL-CLAIM-TYPE           PIC X.
  7463*            88  AH-CLAIM               VALUE 'A'.
  7464*            88  LIFE-CLAIM             VALUE 'L'.
  7465*            88  PROPERTY-CLAIM         VALUE 'P'.
  7466*            88  IUI-CLAIM              VALUE 'I'.
  7467*            88  GAP-CLAIM              VALUE 'G'.
  7468         16  CL-CLAIM-PREM-TYPE      PIC X.
  7469             88  SINGLE-PREMIUM         VALUE '1'.
  7470             88  O-B-COVERAGE           VALUE '2'.
  7471             88  OPEN-END-COVERAGE      VALUE '3'.
  7472         16  CL-INCURRED-DT          PIC XX.
  7473         16  CL-REPORTED-DT          PIC XX.
  7474         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7475         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7476         16  CL-LAST-PMT-DT          PIC XX.
  7477         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7478         16  CL-PAID-THRU-DT         PIC XX.
  7479         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7480         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7481         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7482         16  CL-PMT-CALC-METHOD      PIC X.
  7483             88  CL-360-DAY-YR          VALUE '1'.
  7484             88  CL-365-DAY-YR          VALUE '2'.
  7485             88  CL-FULL-MONTHS         VALUE '3'.
  7486         16  CL-CAUSE-CD             PIC X(6).
  7487
  7488         16  CL-PRIME-CERT-NO.
  7489             20  CL-PRIME-CERT-PRIME PIC X(10).
  7490             20  CL-PRIME-CERT-SFX   PIC X.
  7491
  7492         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7493             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7494             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7495
  7496         16  CL-MICROFILM-NO         PIC X(10).
  7497         16  CL-PROG-FORM-TYPE       PIC X.
  7498         16  CL-LAST-ADD-ON-DT       PIC XX.
  7499
  7500         16  CL-LAST-REOPEN-DT       PIC XX.
  7501         16  CL-LAST-CLOSE-DT        PIC XX.
  7502         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7503             88  FINAL-PAID             VALUE '1'.
  7504             88  CLAIM-DENIED           VALUE '2'.
  7505             88  AUTO-CLOSE             VALUE '3'.
  7506             88  MANUAL-CLOSE           VALUE '4'.
  7507             88  BENEFITS-CHANGED       VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 141
* EL6311.cbl
  7508             88  SETUP-ERRORS           VALUE 'E'.
  7509         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7510         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7511         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7512             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7513         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7514         16  FILLER                  PIC X.
  7515
  7516     12  CL-CERTIFICATE-DATA.
  7517         16  CL-CERT-ORIGIN          PIC X.
  7518             88  CERT-WAS-ONLINE        VALUE '1'.
  7519             88  CERT-WAS-CREATED       VALUE '2'.
  7520             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7521         16  CL-CERT-KEY-DATA.
  7522             20  CL-CERT-CARRIER     PIC X.
  7523             20  CL-CERT-GROUPING    PIC X(6).
  7524             20  CL-CERT-STATE       PIC XX.
  7525             20  CL-CERT-ACCOUNT.
  7526                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7527                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7528             20  CL-CERT-EFF-DT      PIC XX.
  7529
  7530     12  CL-STATUS-CONTROLS.
  7531         16  CL-PRIORITY-CD          PIC X.
  7532             88  CONFIDENTIAL-DATA      VALUE '8'.
  7533             88  HIGHEST-PRIORITY       VALUE '9'.
  7534         16  CL-SUPV-ATTN-CD         PIC X.
  7535             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7536             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7537         16  CL-PURGED-DT            PIC XX.
  7538         16  CL-RESTORED-DT          PIC XX.
  7539         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7540         16  CL-NEXT-RESEND-DT       PIC XX.
  7541         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7542         16  CL-CRITICAL-PERIOD      PIC 99.
  7543*        16  FILLER                  PIC XX.
  7544         16  CL-LAST-MAINT-DT        PIC XX.
  7545         16  CL-LAST-MAINT-USER      PIC X(4).
  7546         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7547         16  CL-LAST-MAINT-TYPE      PIC X.
  7548             88  CLAIM-SET-UP           VALUE ' '.
  7549             88  PAYMENT-MADE           VALUE '1'.
  7550             88  LETTER-SENT            VALUE '2'.
  7551             88  MASTER-WAS-ALTERED     VALUE '3'.
  7552             88  MASTER-WAS-RESTORED    VALUE '4'.
  7553             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7554             88  FILE-CONVERTED         VALUE '6'.
  7555             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7556             88  ERROR-CORRECTION       VALUE 'E'.
  7557         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7558         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7559         16  CL-BENEFICIARY          PIC X(10).
  7560         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7561         16  CL-DENIAL-TYPE          PIC X.
  7562             88  CL-TYPE-DENIAL          VALUE '1'.
  7563             88  CL-TYPE-RESCISSION      VALUE '2'.
  7564             88  CL-TYPE-REFORMATION     VALUE '3'.
  7565             88  CL-TYPE-REF-TO-RES      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 142
* EL6311.cbl
  7566             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7567         16  CL-CRIT-PER-RECURRENT   PIC X.
  7568         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7569         16  CL-RTW-DT               PIC XX.
  7570
  7571     12  CL-TRAILER-CONTROLS.
  7572         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7573             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7574             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7575             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7576         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7577         16  FILLER                  PIC XX.
  7578         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7579         16  CL-ADDRESS-TRAILER-CNT.
  7580             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7581                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7582             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7583                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7584             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7585                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7586             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7587                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7588             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7589                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7590             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7591                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7592             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7593                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7594
  7595     12  CL-CV-REFERENCE-NO.
  7596         16  CL-CV-REFNO-PRIME       PIC X(18).
  7597         16  CL-CV-REFNO-SFX         PIC XX.
  7598
  7599     12  CL-FILE-LOCATION            PIC X(4).
  7600
  7601     12  CL-PROCESS-ERRORS.
  7602         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7603             88  NO-FATAL-ERRORS        VALUE ZERO.
  7604         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7605             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7606
  7607     12  CL-PRODUCT-CD               PIC X.
  7608
  7609     12  CL-CURRENT-KEY-DATA.
  7610         16  CL-CURRENT-CARRIER      PIC X.
  7611         16  CL-CURRENT-GROUPING     PIC X(6).
  7612         16  CL-CURRENT-STATE        PIC XX.
  7613         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7614
  7615     12  CL-ASSOCIATES               PIC X.
  7616         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7617         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7618         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7619         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7620
  7621     12  CL-ACTIVITY-CODE            PIC 99.
  7622     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7623     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 143
* EL6311.cbl
  7624
  7625     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7626     12  CL-LAG-REPORT-CODE          PIC 9.
  7627     12  CL-LOAN-TYPE                PIC XX.
  7628     12  CL-LEGAL-STATE              PIC XX.
  7629
  7630     12  CL-YESNOSW                  PIC X.
  7631     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7632         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7633         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7634         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7635     12  cl-insured-claim            pic x.
  7636         88  cl-claim-on-primary         value 'P'.
  7637         88  cl-claim-on-secondary       value 'S'.
  7638     12  cl-benefit-expiration-dt    PIC XX.
  7639
  7640*    COPY ERCENDT.
  7641******************************************************************
  7642*                                                                *
  7643*                                                                *
  7644*                            ERCENDT.                            *
  7645*                            VMOD=2.001                          *
  7646*                                                                *
  7647*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7648*                                                                *
  7649*   FILE TYPE = VSAM,KSDS                                        *
  7650*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7651*                                                                *
  7652*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7653*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7654*                                                                *
  7655*   LOG = NO                                                     *
  7656*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7657******************************************************************
  7658*-----------------------------------------------------------------
  7659*                   C H A N G E   L O G
  7660*
  7661* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7662*-----------------------------------------------------------------
  7663*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7664* EFFECTIVE    NUMBER
  7665*-----------------------------------------------------------------
  7666* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7667*                                WITH OPEN CLAIMS
  7668* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7669* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7670* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7671*-----------------------------------------------------------------
  7672 01  ENDORSEMENT-RECORD.
  7673     12  EN-RECORD-ID                PIC XX.
  7674         88  VALID-EN-ID                VALUE 'EN'.
  7675     12  EN-CONTROL-PRIMARY.
  7676         16  EN-COMPANY-CD           PIC X.
  7677         16  EN-CARRIER              PIC X.
  7678         16  EN-GROUPING             PIC X(6).
  7679         16  EN-STATE                PIC XX.
  7680         16  EN-ACCOUNT              PIC X(10).
  7681         16  EN-CERT-EFF-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 144
* EL6311.cbl
  7682         16  EN-CERT-NO.
  7683             20  EN-CERT-PRIME       PIC X(10).
  7684             20  EN-CERT-SFX         PIC X.
  7685         16  EN-REC-TYPE             PIC X.
  7686             88  EN-ISSUE               VALUE 'I'.
  7687             88  EN-CANCELLATION        VALUE 'C'.
  7688         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7689     12  EN-CONTROL-BY-ARCH-NO.
  7690         16  EN-COMPANY-CD-A1              PIC X.
  7691         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7692     12  EN-LAST-MAINT-DT            PIC XX.
  7693     12  EN-LAST-MAINT-BY            PIC X(4).
  7694     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7695     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7696     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7697         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7698         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7699         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7700         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7701         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7702         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7703         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7704         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7705         16  EN-LF-ORIG-BENCD        PIC XX.
  7706         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7707         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7708         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7709         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7710         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7711         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7712*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7713         16  EN-ORIG-CRED-BENE       PIC X(25).
  7714         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7715         16  FILLER                  PIC X.
  7716         16  EN-AH-ORIG-BENCD        PIC XX.
  7717         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7718         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7719         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7720         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7721*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7722*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7723         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7724         16  F                       PIC X(09).
  7725         16  EN-AH-ORIG-CP           PIC 99.
  7726         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7727         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7728         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7729         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7730         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7731         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7732         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7733         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7734         16  EN-LF-NEW-BENCD         PIC XX.
  7735         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7736         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7737         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7738         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7739         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 145
* EL6311.cbl
  7740         16  EN-LF-NEW-EXP-DT        PIC XX.
  7741         16  EN-NEW-CRED-BENE        PIC X(25).
  7742         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7743         16  FILLER                  PIC X.
  7744         16  EN-AH-NEW-BENCD         PIC XX.
  7745         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7746         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7747         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7748         16  EN-AH-NEW-EXP-DT        PIC XX.
  7749*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7750*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7751*        16  F                       PIC X(12).
  7752         16  EN-AH-NEW-CP            PIC 99.
  7753         16  EN-SIG-SW               PIC X.
  7754         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7755         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7756         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7757         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7758         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7759         16  FILLER                  PIC X(33).
  7760     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7761         16  EN-LF-ORIG-REF-DT       PIC XX.
  7762         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7763         16  EN-AH-ORIG-REF-DT       PIC XX.
  7764         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7765         16  EN-LF-NEW-REF-DT        PIC XX.
  7766         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7767         16  EN-AH-NEW-REF-DT        PIC XX.
  7768         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7769         16  EN-FLAG-CERT            PIC X.
  7770         16  EN-INS-LAST-NAME        PIC X(15).
  7771         16  EN-INS-FIRST-NAME       PIC X(10).
  7772         16  EN-INS-MIDDLE-INIT      PIC X.
  7773         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7774         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7775         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7776         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7777         16  FILLER                  PIC X(262).
  7778     12  EN-MONEY-SW             PIC X.
  7779     12  EN-HEALTH-APP           PIC X.
  7780     12  EN-VOUCHER-SW           PIC X.
  7781     12  EN-PAYEE                PIC X(14).
  7782     12  EN-INPUT-DT             PIC XX.
  7783     12  EN-PROCESS-DT           PIC XX.
  7784     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7785     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7786     12  EN-REASON-CODES.
  7787         16  F OCCURS 12.
  7788             20  EN-REASON-CODE  PIC X(4).
  7789     12  EN-TEMPLATE-USED        PIC X(8).
  7790     12  EN-DOCU-TYPE            PIC X.
  7791         88  EN-VERI-DOCU          VALUE 'V'.
  7792         88  EN-GCE-DOCU           VALUE 'G'.
  7793         88  EN-CANC-DOCU          VALUE 'C'.
  7794     12  EN-COMMENTS1            PIC X(13).
  7795     12  EN-COMMENTS2            PIC X(70).
  7796     12  EN-COMM-CHGBK           PIC X.
  7797         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 146
* EL6311.cbl
  7798         88  EN-CHG-ACCT           VALUE 'Y'.
  7799     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7800     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7801     12  EN-BATCH-NUMBER         PIC X(6).
  7802     12  EN-ACCT-SUMM            PIC X.
  7803     12  EN-CSO-SUMM             PIC X.
  7804     12  FILLER                  PIC X(13).
  7805******************************************************************
  7806
  7807*    COPY ELCCRTT.
  7808******************************************************************
  7809*                                                                *
  7810*                            ELCCRTT.                            *
  7811*                                                                *
  7812*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7813*                                                                *
  7814*   FILE TYPE = VSAM,KSDS                                        *
  7815*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7816*                                                                *
  7817*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7818*                                                                *
  7819*   LOG = YES                                                    *
  7820*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7821******************************************************************
  7822*                   C H A N G E   L O G
  7823*
  7824* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7825*-----------------------------------------------------------------
  7826*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7827* EFFECTIVE    NUMBER
  7828*-----------------------------------------------------------------
  7829* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7830* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7831* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7832* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7833* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7834******************************************************************
  7835
  7836 01  CERTIFICATE-TRAILERS.
  7837     12  CS-RECORD-ID                      PIC XX.
  7838         88  VALID-CS-ID                      VALUE 'CS'.
  7839
  7840     12  CS-CONTROL-PRIMARY.
  7841         16  CS-COMPANY-CD                 PIC X.
  7842         16  CS-CARRIER                    PIC X.
  7843         16  CS-GROUPING                   PIC X(6).
  7844         16  CS-STATE                      PIC XX.
  7845         16  CS-ACCOUNT                    PIC X(10).
  7846         16  CS-CERT-EFF-DT                PIC XX.
  7847         16  CS-CERT-NO.
  7848             20  CS-CERT-PRIME             PIC X(10).
  7849             20  CS-CERT-SFX               PIC X.
  7850         16  CS-TRAILER-TYPE               PIC X.
  7851             88  COMM-TRLR           VALUE 'A'.
  7852             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7853             88  CERT-DATA-TRLR      VALUE 'C'.
  7854
  7855     12  CS-DATA-AREA                      PIC X(516).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 147
* EL6311.cbl
  7856
  7857     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7858         16  CS-BANK-COMMISSION-AREA.
  7859             20  CS-BANK-COMMS       OCCURS 10.
  7860                 24  CS-AGT                PIC X(10).
  7861                 24  CS-COM-TYP            PIC X.
  7862                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7863                 24  CS-RECALC-LV-INDIC    PIC X.
  7864                 24  FILLER                PIC X(10).
  7865         16  FILLER                        PIC X(256).
  7866
  7867     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7868****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7869****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7870         16  CS-MB-CLAIM-DATA OCCURS 2.
  7871             20  FILLER OCCURS 10.
  7872                 24  CS-CLAIM-TYPE         PIC X.
  7873                     88  CS-AH-CLM           VALUE 'A'.
  7874                     88  CS-IU-CLM           VALUE 'I'.
  7875                     88  CS-GP-CLM           VALUE 'G'.
  7876                     88  CS-LF-CLM           VALUE 'L'.
  7877                     88  CS-PR-CLM           VALUE 'P'.
  7878                 24  CS-BANK               PIC S999 COMP-3.
  7879                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7880                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7881                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  7882         16  FILLER                        PIC X(216).
  7883     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7884         16  CS-VIN-NUMBER                 PIC X(17).
  7885         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7886         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7887         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7888         16  FILLER                        PIC X(496).
  7889******************************************************************
  7890
  7891 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  7892                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  7893                          PENDING-MAILING-DATA MAILING-DATA
  7894                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  7895                          PENDING-PAY-ADJ CERT-NOTE-FILE
  7896                          CLAIM-MASTER ENDORSEMENT-RECORD
  7897                          CERTIFICATE-TRAILERS.
  7898 0000-DFHEXIT SECTION.
  7899     MOVE '9#                    $   ' TO DFHEIV0.
  7900     MOVE 'EL6311' TO DFHEIV1.
  7901     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7902
  7903     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7904     MOVE EIBTRMID               TO QID-TERM.
  7905     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  7906     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7907     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7908     MOVE 2                      TO EMI-SWITCH2.
  7909
  7910     IF EIBCALEN = 0
  7911         GO TO 8800-UNAUTHORIZED-ACCESS.
  7912
  7913     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 148
* EL6311.cbl
  7914     MOVE '5'                   TO DC-OPTION-CODE.
  7915     PERFORM 9700-DATE-LINK.
  7916     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  7917     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  7918
  7919     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  7920     MOVE SPACE                  TO DC-OPTION-CODE.
  7921     PERFORM 9700-DATE-LINK.
  7922     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  7923     MOVE LOW-VALUES             TO EL631BI.
  7924
  7925
  7926* EXEC CICS HANDLE CONDITION
  7927*        PGMIDERR  (9600-PGMID-ERROR)
  7928*        ERROR     (9990-ABEND)
  7929*        INVREQ    (9990-ABEND)
  7930*        QIDERR    (0010-MAIN-LOGIC)
  7931*    END-EXEC.
  7932*    MOVE '"$L.8N                ! " #00007921' TO DFHEIV0
  7933     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  7934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7935     MOVE X'2220233030303037393231' TO DFHEIV0(25:11)
  7936     CALL 'kxdfhei1' USING DFHEIV0
  7937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7938
  7939
  7940     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7941         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7942             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7943             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7944             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7945             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7946             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7947             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7948             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7949             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7950
  7951             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  7952                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  7953
  7954             ELSE
  7955                 NEXT SENTENCE
  7956
  7957         ELSE
  7958             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  7959             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7960             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7961             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7962             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7963             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7964             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7965             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7966             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7967             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  7968             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  7969             GO TO 3900-RE-DISPLAY-RECORD
  7970     ELSE
  7971         GO TO 0020-MAIN-LOGIC.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 149
* EL6311.cbl
  7972
  7973 0010-MAIN-LOGIC.
  7974     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  7975                                    WS-FIRST-ENTRY-SW.
  7976
  7977     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  7978
  7979     MOVE LOW-VALUES             TO EC-NEW-CERT
  7980                                    EC-NEW-STATE.
  7981
  7982     IF PI-DISPLAY-ORIGINAL-BATCH
  7983         NEXT SENTENCE
  7984     ELSE
  7985         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  7986             GO TO 5000-BROWSE-BATCH-HEADERS.
  7987
  7988     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  7989         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  7990
  7991     IF PI-CSR-BROWSE
  7992        GO TO 4200-BROWSE-CSR-FORWARD.
  7993
  7994     IF PI-FILE-BROWSE
  7995         GO TO 4300-BROWSE-FILE-FORWARD.
  7996
  7997     GO TO 4000-BROWSE-DETAIL-FORWARD.
  7998
  7999 0020-MAIN-LOGIC.
  8000     IF EIBAID = DFHCLEAR
  8001         GO TO 9400-CLEAR.
  8002
  8003     MOVE LOW-VALUES             TO EC-NEW-CERT
  8004                                    EC-NEW-STATE.
  8005
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 150
* EL6311.cbl
  8007
  8008******************************************************************
  8009*                                                                *
  8010*              R E C E I V E   M A P                             *
  8011*                                                                *
  8012******************************************************************
  8013
  8014 0200-RECEIVE.
  8015     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8016         MOVE ER-0008            TO EMI-ERROR
  8017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8018         IF PI-MAP-NAME = EL631B
  8019             MOVE -1                 TO BMAINTL
  8020             GO TO 8200-SEND-DATAONLY
  8021         ELSE
  8022             IF PI-MAP-NAME = EL631C
  8023                 MOVE -1                 TO CMAINTL
  8024                 GO TO 8200-SEND-DATAONLY
  8025             ELSE
  8026                 IF PI-MAP-NAME = EL631D
  8027                     MOVE -1                 TO DPFENTRL
  8028                     GO TO 8200-SEND-DATAONLY.
  8029
  8030
  8031* EXEC CICS RECEIVE
  8032*        MAP      (PI-MAP-NAME)
  8033*        MAPSET   (MAPSET-EL6311S)
  8034*        INTO     (EL631BI)
  8035*    END-EXEC.
  8036     MOVE LENGTH OF
  8037      EL631BI
  8038       TO DFHEIV11
  8039*    MOVE '8"T I  L              ''   #00008018' TO DFHEIV0
  8040     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8041     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8042     MOVE X'2020233030303038303138' TO DFHEIV0(25:11)
  8043     CALL 'kxdfhei1' USING DFHEIV0,
  8044           PI-MAP-NAME,
  8045           EL631BI,
  8046           DFHEIV11,
  8047           MAPSET-EL6311S,
  8048           DFHEIV99,
  8049           DFHEIV99
  8050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8051
  8052
  8053******************************************************************
  8054*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8055******************************************************************
  8056
  8057     IF BTYPE-LEN (1) EQUAL +3
  8058        IF BTYPE (1) EQUAL ALL ' '
  8059            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8060
  8061     IF BTYPE-LEN (2) EQUAL +3
  8062        IF BTYPE (2) EQUAL ALL ' '
  8063            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8064
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 151
* EL6311.cbl
  8065     INSPECT EL631BI CONVERTING '_' TO ' '.
  8066
  8067     IF PI-MAP-NAME = EL631B
  8068         IF BPFENTRL GREATER THAN ZEROS
  8069             IF EIBAID NOT = DFHENTER
  8070                 MOVE ER-0004       TO EMI-ERROR
  8071                 MOVE -1            TO BPFENTRL
  8072                 MOVE AL-UNBOF      TO BPFENTRA
  8073                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8074                 GO TO 8200-SEND-DATAONLY
  8075             ELSE
  8076                 IF BPFENTRI NUMERIC AND
  8077                   (BPFENTRI GREATER 0 AND LESS 25)
  8078                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8079                 ELSE
  8080                     MOVE ER-0029  TO EMI-ERROR
  8081                     MOVE AL-UNBON TO BPFENTRA
  8082                     MOVE -1       TO BPFENTRL
  8083                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8084                     GO TO 8200-SEND-DATAONLY
  8085         ELSE
  8086             NEXT SENTENCE
  8087     ELSE
  8088         IF PI-MAP-NAME = EL631C
  8089            IF CPFENTRL GREATER THAN ZEROS
  8090                IF EIBAID NOT = DFHENTER
  8091                 MOVE ER-0004         TO EMI-ERROR
  8092                 MOVE -1              TO CPFENTRL
  8093                 MOVE AL-UNBOF        TO CPFENTRA
  8094                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8095                 GO TO 8200-SEND-DATAONLY
  8096             ELSE
  8097                 IF CPFENTRI NUMERIC AND
  8098                   (CPFENTRI GREATER 0 AND LESS 25)
  8099                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8100                 ELSE
  8101                     MOVE ER-0029      TO EMI-ERROR
  8102                     MOVE AL-UNBON     TO CPFENTRA
  8103                     MOVE -1           TO CPFENTRL
  8104                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8105                     GO TO 8200-SEND-DATAONLY
  8106         ELSE
  8107             NEXT SENTENCE
  8108     ELSE
  8109     IF PI-MAP-NAME = EL631D
  8110         IF DPFENTRL GREATER THAN ZEROS
  8111             IF EIBAID NOT = DFHENTER
  8112                 MOVE ER-0004         TO EMI-ERROR
  8113                 MOVE -1              TO DPFENTRL
  8114                 MOVE AL-UNBOF        TO DPFENTRA
  8115                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8116                 GO TO 8200-SEND-DATAONLY
  8117             ELSE
  8118                 IF DPFENTRI NUMERIC AND
  8119                   (DPFENTRI GREATER 0 AND LESS 25)
  8120                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8121                 ELSE
  8122                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 152
* EL6311.cbl
  8123                     MOVE AL-UNBON     TO DPFENTRA
  8124                     MOVE -1           TO DPFENTRL
  8125                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8126                     GO TO 8200-SEND-DATAONLY.
  8127
  8128     IF EIBAID = DFHPF23
  8129         GO TO 8810-PF23.
  8130
  8131     IF EIBAID = DFHPF24
  8132         GO TO 9200-RETURN-MAIN-MENU.
  8133
  8134     IF EIBAID = DFHPF12
  8135         GO TO 9500-PF12.
  8136
  8137     IF PI-MAP-NAME = EL631B
  8138        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8139
  8140     IF PI-MAP-NAME = EL631C
  8141        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8142
  8143     IF PI-MAP-NAME = EL631D
  8144        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8145
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 153
* EL6311.cbl
  8147
  8148******************************************************************
  8149*                                                                *
  8150*      ISSUE SCREEN PF KEY CHECKING                              *
  8151*                                                                *
  8152******************************************************************
  8153
  8154******************************************************************
  8155*                                                                *
  8156*      PF KEY FUNCTIONS:                                         *
  8157*                                                                *
  8158*      PF1  = BROWSE FORWARD                                     *
  8159*      PF2  = BROWSE BACKWARD                                    *
  8160*      PF3  = CERTIFICATE LOOKUP                                 *
  8161*      PF4  = DISPLAY BATCH HEADER                               *
  8162*      PF5  = ADD ISSUE  SCREEN                                  *
  8163*      PF6  = ADD CANCEL SCREEN                                  *
  8164*      PF7  = CERTIFICATE DISPLAY                                *
  8165*      PF8  = CERTIFICATE NOTES                                  *
  8166*      PF9  = EDIT CONTROL                                       *
  8167*      PF10 = DISPLAY LETTER SCREEN                              *
  8168*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8169*      PF12 = HELP SCREEN                                        *
  8170*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8171*      PF14 = ACCOUNT MASTER                                     *
  8172*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8173*      PF16 = DISPLAY LETTER REVIEW                              *
  8174*                                                                *
  8175******************************************************************
  8176
  8177 0300-CHECK-ISSUE-PF-KEYS.
  8178     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8179        MOVE ER-2337            TO EMI-ERROR
  8180        MOVE -1                  TO BMAINTL
  8181        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8182        GO TO 8200-SEND-DATAONLY.
  8183
  8184     IF EIBAID = DFHPF1
  8185        MOVE '0'                TO PI-EDIT-SW
  8186        IF PI-PRIMARY-BROWSE
  8187           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8188        ELSE
  8189           IF PI-PRIMARY-WITH-SELECT
  8190              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8191           ELSE
  8192              IF PI-FILE-BROWSE
  8193                 GO TO 4300-BROWSE-FILE-FORWARD
  8194              ELSE
  8195                 IF PI-CSR-BROWSE
  8196                    GO TO 4200-BROWSE-CSR-FORWARD
  8197                 ELSE
  8198                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8199
  8200     IF EIBAID = DFHPF2
  8201        MOVE '0'                TO PI-EDIT-SW
  8202        IF PI-PRIMARY-BROWSE
  8203           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8204        ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 154
* EL6311.cbl
  8205           IF PI-PRIMARY-WITH-SELECT
  8206              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8207           ELSE
  8208              IF PI-FILE-BROWSE
  8209                 GO TO 4800-BROWSE-FILE-BACKWARD
  8210              ELSE
  8211                 IF PI-CSR-BROWSE
  8212                    GO TO 4900-BROWSE-CSR-BACKWARD
  8213                 ELSE
  8214                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8215
  8216     IF EIBAID = DFHPF3
  8217        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8218        MOVE XCTL-EL127         TO PGM-NAME
  8219        GO TO 9300-XCTL.
  8220
  8221     IF (EIBAID = DFHPF15 OR DFHPF6)
  8222        AND (CSR-EDIT-SESSION)
  8223*       AND (FATAL-OR-UNFORCED)
  8224        AND (FATAL-ERRORS)
  8225        MOVE ER-1819             TO EMI-ERROR
  8226        MOVE -1                  TO BMAINTL
  8227        MOVE AL-UANON            TO BMAINTA
  8228        PERFORM 9900-ERROR-FORMAT
  8229                                 THRU 9900-EXIT
  8230        GO TO 8200-SEND-DATAONLY
  8231     END-IF
  8232     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8233      OR (EIBAID = DFHPF10)
  8234        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8235        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8236        IF (RESP-NORMAL)
  8237           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8238              AM-CONTROL-PRIMARY (1:20))
  8239            IF AM-NAME NOT GREATER THAN SPACES OR
  8240               AM-ADDRS NOT GREATER THAN SPACES  OR
  8241               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8242               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8243               AM-ZIP NOT GREATER THAN SPACES
  8244               MOVE ER-3834             TO EMI-ERROR
  8245               MOVE -1                  TO BMAINTL
  8246               MOVE AL-UANON            TO BMAINTA
  8247               PERFORM 9900-ERROR-FORMAT
  8248                                 THRU 9900-EXIT
  8249               GO TO 8200-SEND-DATAONLY
  8250            END-IF
  8251        ELSE
  8252           MOVE ER-1609             TO EMI-ERROR
  8253           MOVE -1                  TO BMAINTL
  8254           MOVE AL-UANON            TO BMAINTA
  8255           PERFORM 9900-ERROR-FORMAT
  8256                                THRU 9900-EXIT
  8257           GO TO 8200-SEND-DATAONLY
  8258        END-IF
  8259
  8260        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8261        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8262        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 155
* EL6311.cbl
  8263            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8264               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8265               MA-CITY NOT GREATER THAN SPACES OR
  8266               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8267               MA-ZIP-CODE NOT GREATER THAN SPACES
  8268               MOVE ER-3835             TO EMI-ERROR
  8269               MOVE -1                  TO BMAINTL
  8270               MOVE AL-UANON            TO BMAINTA
  8271               PERFORM 9900-ERROR-FORMAT
  8272                                 THRU 9900-EXIT
  8273               GO TO 8200-SEND-DATAONLY
  8274            END-IF
  8275        ELSE
  8276           MOVE ER-3000             TO EMI-ERROR
  8277           MOVE -1                  TO BMAINTL
  8278           MOVE AL-UANON            TO BMAINTA
  8279           PERFORM 9900-ERROR-FORMAT
  8280                                THRU 9900-EXIT
  8281           GO TO 8200-SEND-DATAONLY
  8282        END-IF
  8283
  8284     END-IF
  8285     IF (EIBAID = DFHPF15)
  8286        AND (CSR-EDIT-SESSION)
  8287        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8288        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8289        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8290        MOVE PI-SV-STATE         TO PI-STATE
  8291        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8292        MOVE BCERTNOI            TO PI-CERT-PRIME
  8293        MOVE BSUFIXI             TO PI-CERT-SFX
  8294        MOVE BEFFDTI             TO DEEDIT-FIELD
  8295        PERFORM 8600-DEEDIT
  8296        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8297        MOVE '4'                 TO DC-OPTION-CODE
  8298        PERFORM 9700-DATE-LINK
  8299        IF DATE-CONVERSION-ERROR
  8300           MOVE ER-0348          TO EMI-ERROR
  8301           MOVE -1               TO BEFFDTL
  8302           MOVE AL-UABON         TO BEFFDTA
  8303           PERFORM 9900-ERROR-FORMAT
  8304                                 THRU 9900-EXIT
  8305           GO TO 8200-SEND-DATAONLY
  8306        ELSE
  8307           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8308           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8309           MOVE XCTL-EL6315      TO PGM-NAME
  8310           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8311           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8312           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8313           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8314           GO TO 9300-XCTL
  8315        END-IF
  8316     END-IF
  8317
  8318     IF EIBAID = DFHPF4
  8319        MOVE '0'                TO PI-EDIT-SW
  8320        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 156
* EL6311.cbl
  8321           NEXT SENTENCE
  8322        ELSE
  8323           GO TO 7200-DISPLAY-BATCHES.
  8324
  8325     IF EIBAID = DFHPF5
  8326        MOVE ER-0029                TO EMI-ERROR
  8327        MOVE -1                     TO BPFENTRL
  8328        MOVE AL-UNBON               TO BPFENTRA
  8329        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8330        GO TO 8200-SEND-DATAONLY.
  8331*        MOVE '0'                TO PI-EDIT-SW
  8332*        IF PI-DISPLAY-ORIGINAL-BATCH
  8333*           NEXT SENTENCE
  8334*        ELSE
  8335*           MOVE EL631B              TO PI-MAP-NAME
  8336*           MOVE LOW-VALUES          TO EL631BI
  8337*           MOVE 'A'                 TO BMAINTO
  8338*           MOVE AL-UANON            TO BMAINTA
  8339*           MOVE -1                  TO BMAINTL
  8340*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8341*           GO TO 8100-SEND-INITIAL-MAP.
  8342
  8343     IF EIBAID = DFHPF6
  8344        IF NOT CSR-EDIT-SESSION
  8345           MOVE ER-0029                TO EMI-ERROR
  8346           MOVE -1                     TO BPFENTRL
  8347           MOVE AL-UNBON               TO BPFENTRA
  8348           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8349           GO TO 8200-SEND-DATAONLY
  8350*           MOVE '0'              TO PI-EDIT-SW
  8351*           IF PI-DISPLAY-ORIGINAL-BATCH
  8352*              NEXT SENTENCE
  8353*           ELSE
  8354*              MOVE EL631C        TO PI-MAP-NAME
  8355*              MOVE LOW-VALUES    TO EL631CI
  8356*              MOVE 'A'           TO CMAINTO
  8357*              MOVE AL-UANON      TO CMAINTA
  8358*              MOVE -1            TO CMAINTL
  8359*              MOVE '6'           TO PI-MAINT-FUNCTION
  8360*              GO TO 8100-SEND-INITIAL-MAP
  8361*           END-IF
  8362        ELSE
  8363           PERFORM 5100-PROCESS-POL-RESC
  8364                                 THRU 5100-EXIT
  8365           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8366           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8367                                    PI-PREV-SEQ-NO
  8368           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8369*                                    WS-CANCEL-LETTER-SW
  8370                                    PI-ALL-ISSUES-SW
  8371                                    PI-ALL-CANCELS-SW
  8372           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8373        END-IF
  8374     END-IF
  8375     IF EIBAID = DFHPF7
  8376        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8377        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8378        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 157
* EL6311.cbl
  8379        MOVE PI-SV-STATE            TO PI-STATE
  8380        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8381        MOVE BCERTNOI               TO PI-CERT-PRIME
  8382        MOVE BSUFIXI                TO PI-CERT-SFX
  8383        MOVE BEFFDTI                TO DEEDIT-FIELD
  8384        PERFORM 8600-DEEDIT
  8385        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8386        MOVE '4'                    TO DC-OPTION-CODE
  8387        PERFORM 9700-DATE-LINK
  8388        IF DATE-CONVERSION-ERROR
  8389           MOVE ER-0348            TO EMI-ERROR
  8390           MOVE -1                  TO BEFFDTL
  8391           MOVE AL-UABON            TO BEFFDTA
  8392           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8393           GO TO 8200-SEND-DATAONLY
  8394        ELSE
  8395           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8396           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8397           MOVE XCTL-EL1273        TO PGM-NAME
  8398           GO TO 9300-XCTL.
  8399
  8400     IF EIBAID = DFHPF8
  8401        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8402        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8403        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8404        MOVE PI-SV-STATE            TO PI-STATE
  8405        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8406        MOVE BCERTNOI               TO PI-CERT-PRIME
  8407        MOVE BSUFIXI                TO PI-CERT-SFX
  8408        MOVE BEFFDTI                TO DEEDIT-FIELD
  8409        PERFORM 8600-DEEDIT
  8410        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8411        MOVE '4'                    TO DC-OPTION-CODE
  8412        PERFORM 9700-DATE-LINK
  8413        IF DATE-CONVERSION-ERROR
  8414           MOVE ER-0348            TO EMI-ERROR
  8415           MOVE -1                  TO BEFFDTL
  8416           MOVE AL-UABON            TO BEFFDTA
  8417           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8418           GO TO 8200-SEND-DATAONLY
  8419        ELSE
  8420           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8421           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8422           IF PI-COMPANY-ID = 'DMD'
  8423               MOVE XCTL-EL401DMD      TO PGM-NAME
  8424             ELSE
  8425               MOVE XCTL-EL1279        TO PGM-NAME
  8426           END-IF
  8427           GO TO 9300-XCTL.
  8428
  8429     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8430        MOVE XCTL-EL6312         TO PGM-NAME
  8431
  8432* EXEC CICS XCTL
  8433*           PROGRAM   (PGM-NAME)
  8434*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8435*           LENGTH    (WS-COMM-LENGTH)
  8436*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 158
* EL6311.cbl
  8437*    MOVE '.$C                   %   #00008402' TO DFHEIV0
  8438     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8439     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8440     MOVE X'2020233030303038343032' TO DFHEIV0(25:11)
  8441     CALL 'kxdfhei1' USING DFHEIV0,
  8442           PGM-NAME,
  8443           PROGRAM-INTERFACE-BLOCK,
  8444           WS-COMM-LENGTH,
  8445           DFHEIV99
  8446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8447     ELSE
  8448        MOVE '0'                 TO  PI-EDIT-SW.
  8449
  8450     IF  EIBAID = DFHPF10
  8451         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8452         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8453         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8454                                    PI-1042-WA
  8455         MOVE 4                  TO PI-689-DATA-SOURCE
  8456         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8457         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8458         MOVE PI-SV-STATE        TO PI-689-STATE
  8459         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8460         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8461         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8462         MOVE PI-PB-ALT-CHG-SEQ-NO
  8463                                 TO PI-689-ALT-SEQ-NO
  8464         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8465         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8466         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8467         MOVE +0                 TO PI-689-CONTROL
  8468         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8469                                    PI-689-EXP-DATE
  8470                                    PI-689-RESP-PERSON
  8471                                    PI-689-TYPE
  8472                                    PI-689-FOLLOW-UP-EDIT
  8473                                    PI-689-RESEND1-EDIT
  8474                                    PI-689-SEQ-EDIT
  8475                                    PI-689-BCSEQ-EDIT
  8476                                    PI-689-LBL-OVERRIDE
  8477         MOVE W-LETTER-COMMUNICATION-AREAS
  8478                                 TO PI-PROGRAM-WORK-AREA
  8479         MOVE XCTL-EL689         TO PGM-NAME
  8480         GO TO 9300-XCTL.
  8481
  8482     IF  EIBAID = DFHPF16
  8483         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8484         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8485         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8486                                    PI-1042-WA
  8487         MOVE 4                  TO PI-689-DATA-SOURCE
  8488         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8489         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8490         MOVE PI-SV-STATE        TO PI-689-STATE
  8491         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8492         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8493         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8494         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 159
* EL6311.cbl
  8495                                 TO PI-689-ALT-SEQ-NO
  8496         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8497         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8498         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8499         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8500         MOVE W-LETTER-COMMUNICATION-AREAS
  8501                                 TO PI-PROGRAM-WORK-AREA
  8502         MOVE XCTL-EL690         TO PGM-NAME
  8503         GO TO 9300-XCTL.
  8504
  8505     IF EIBAID = DFHPF13
  8506         MOVE XCTL-EL6313        TO PGM-NAME
  8507         GO TO 9300-XCTL.
  8508
  8509     IF EIBAID = DFHPF17
  8510        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8511        IF (PB-I-LOAN-APR > ZEROS)
  8512           and (pb-i-loan-apr < 99.9999)
  8513           AND (PB-I-BENEFICIARY-NAME NOT
  8514              = SPACES AND LOW-VALUES)
  8515
  8516           MOVE LINK-ELVADS          TO PGM-NAME
  8517
  8518* EXEC CICS LINK
  8519*              PROGRAM    (PGM-NAME)
  8520*              COMMAREA   (WS-PASS-AREA)
  8521*              LENGTH     (WS-PASS-AREA-LENGTH)
  8522*          END-EXEC
  8523*    MOVE '."C                   (   #00008477' TO DFHEIV0
  8524     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8525     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8526     MOVE X'2020233030303038343737' TO DFHEIV0(25:11)
  8527     CALL 'kxdfhei1' USING DFHEIV0,
  8528           PGM-NAME,
  8529           WS-PASS-AREA,
  8530           WS-PASS-AREA-LENGTH,
  8531           DFHEIV99,
  8532           DFHEIV99,
  8533           DFHEIV99,
  8534           DFHEIV99
  8535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8536
  8537           MOVE 0000             TO EMI-ERROR
  8538           MOVE -1               TO BMAINTL
  8539           PERFORM 9900-ERROR-FORMAT
  8540                                 THRU 9900-EXIT
  8541           GO TO 8200-SEND-DATAONLY
  8542        ELSE
  8543           MOVE ER-0877            TO EMI-ERROR
  8544           MOVE -1                  TO BEFFDTL
  8545           MOVE AL-UABON            TO BEFFDTA
  8546           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8547           GO TO 8200-SEND-DATAONLY
  8548        END-IF
  8549     END-IF
  8550     IF EIBAID = DFHPF14
  8551        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8552        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 160
* EL6311.cbl
  8553        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8554        MOVE PI-SV-STATE            TO PI-CR-STATE
  8555        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8556        MOVE SPACE                  TO PI-EDIT-SW
  8557        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8558        MOVE XCTL-EL650             TO PGM-NAME
  8559        GO TO 9300-XCTL.
  8560
  8561     IF EIBAID = DFHPF15
  8562        IF PI-COMPANY-ID  =  'HER'
  8563            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8564            MOVE XCTL-EL680         TO PGM-NAME
  8565            GO TO 9300-XCTL.
  8566
  8567     IF EIBAID = DFHENTER OR DFHPF11
  8568        GO TO 1000-ISSUE-MAINLINE.
  8569
  8570     MOVE ER-0029                TO EMI-ERROR
  8571     MOVE -1                     TO BPFENTRL
  8572     MOVE AL-UNBON               TO BPFENTRA
  8573     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8574     GO TO 8200-SEND-DATAONLY.
  8575
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 161
* EL6311.cbl
  8577
  8578******************************************************************
  8579*                                                                *
  8580*      CANCEL SCREEN PF KEY CHECKING                             *
  8581*                                                                *
  8582******************************************************************
  8583
  8584******************************************************************
  8585*                                                                *
  8586*      PF KEY FUNCTIONS:                                         *
  8587*                                                                *
  8588*      PF1  = BROWSE FORWARD                                     *
  8589*      PF2  = BROWSE BACKWARD                                    *
  8590*      PF3  = CERTIFICATE LOOKUP                                 *
  8591*      PF4  = DISPLAY BATCH HEADER                               *
  8592*      PF5  = ADD ISSUE SCREEN                                   *
  8593*      PF6  = ADD CANCEL SCREEN                                  *
  8594*      PF7  = CERTIFICATE DISPLAY                                *
  8595*      PF8  = CERTIFICATE NOTES                                  *
  8596*      PF9  = EDIT CONTROL                                       *
  8597*      PF10 = DISPLAY LETTER SCREEN                              *
  8598*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8599*      PF12 = DISPLAY HELP SCREEN                                *
  8600*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8601*      PF14 = ACCOUNT MASTER                                     *
  8602*      PF16 = LETTER REVIEW                                      *
  8603*                                                                *
  8604******************************************************************
  8605
  8606 0400-CHECK-CANCEL-PF-KEYS.
  8607     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8608        MOVE ER-2337             TO EMI-ERROR
  8609        MOVE -1                  TO CMAINTL
  8610        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8611        GO TO 8200-SEND-DATAONLY.
  8612
  8613     IF EIBAID = DFHPF1
  8614        MOVE '0'                TO PI-EDIT-SW
  8615        IF PI-PRIMARY-BROWSE
  8616           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8617        ELSE
  8618           IF PI-PRIMARY-WITH-SELECT
  8619              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8620           ELSE
  8621              IF PI-FILE-BROWSE
  8622                 GO TO 4300-BROWSE-FILE-FORWARD
  8623              ELSE
  8624                 IF PI-CSR-BROWSE
  8625                    GO TO 4200-BROWSE-CSR-FORWARD
  8626                 ELSE
  8627                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8628
  8629     IF EIBAID = DFHPF2
  8630        MOVE '0'                TO PI-EDIT-SW
  8631        IF PI-PRIMARY-BROWSE
  8632           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8633        ELSE
  8634           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 162
* EL6311.cbl
  8635              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8636           ELSE
  8637              IF PI-FILE-BROWSE
  8638                 GO TO 4800-BROWSE-FILE-BACKWARD
  8639              ELSE
  8640                 IF PI-CSR-BROWSE
  8641                    GO TO 4900-BROWSE-CSR-BACKWARD
  8642                 ELSE
  8643                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8644
  8645     IF EIBAID = DFHPF3
  8646        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8647        MOVE XCTL-EL127         TO PGM-NAME
  8648        GO TO 9300-XCTL.
  8649
  8650     IF (EIBAID = DFHPF15 OR DFHPF17)
  8651        AND (CSR-EDIT-SESSION)
  8652*       AND (FATAL-OR-UNFORCED)
  8653        AND (FATAL-ERRORS)
  8654        MOVE ER-1819             TO EMI-ERROR
  8655        MOVE -1                  TO CMAINTL
  8656        MOVE AL-UANON            TO CMAINTA
  8657        PERFORM 9900-ERROR-FORMAT
  8658                                 THRU 9900-EXIT
  8659        GO TO 8200-SEND-DATAONLY
  8660     END-IF
  8661     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8662       AND (CSR-EDIT-SESSION)
  8663        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8664        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8665        IF (RESP-NORMAL)
  8666           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8667              AM-CONTROL-PRIMARY (1:20))
  8668            IF AM-NAME NOT GREATER THAN SPACES OR
  8669               AM-ADDRS NOT GREATER THAN SPACES  OR
  8670               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8671               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8672               AM-ZIP NOT GREATER THAN SPACES
  8673               MOVE ER-3834             TO EMI-ERROR
  8674               MOVE -1                  TO BMAINTL
  8675               MOVE AL-UANON            TO BMAINTA
  8676               PERFORM 9900-ERROR-FORMAT
  8677                                 THRU 9900-EXIT
  8678               GO TO 8200-SEND-DATAONLY
  8679            END-IF
  8680        ELSE
  8681           MOVE ER-1609             TO EMI-ERROR
  8682           MOVE -1                  TO BMAINTL
  8683           MOVE AL-UANON            TO BMAINTA
  8684           PERFORM 9900-ERROR-FORMAT
  8685                                THRU 9900-EXIT
  8686           GO TO 8200-SEND-DATAONLY
  8687        END-IF
  8688
  8689        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8690        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8691        IF (ERMAIL-FOUND)
  8692            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 163
* EL6311.cbl
  8693               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8694               MA-CITY NOT GREATER THAN SPACES OR
  8695               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8696               MA-ZIP-CODE NOT GREATER THAN SPACES
  8697               MOVE ER-3835             TO EMI-ERROR
  8698               MOVE -1                  TO BMAINTL
  8699               MOVE AL-UANON            TO BMAINTA
  8700               PERFORM 9900-ERROR-FORMAT
  8701                                 THRU 9900-EXIT
  8702               GO TO 8200-SEND-DATAONLY
  8703            END-IF
  8704        ELSE
  8705           MOVE ER-3000             TO EMI-ERROR
  8706           MOVE -1                  TO BMAINTL
  8707           MOVE AL-UANON            TO BMAINTA
  8708           PERFORM 9900-ERROR-FORMAT
  8709                                THRU 9900-EXIT
  8710           GO TO 8200-SEND-DATAONLY
  8711        END-IF
  8712
  8713     END-IF
  8714     IF (EIBAID = DFHPF15 OR DFHPF17)
  8715        AND (CSR-EDIT-SESSION)
  8716        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8717        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8718        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8719        MOVE PI-SV-STATE         TO PI-STATE
  8720        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8721        MOVE CCERTNOI            TO PI-CERT-PRIME
  8722        MOVE CSUFIXI             TO PI-CERT-SFX
  8723        MOVE CEFFDTI             TO DEEDIT-FIELD
  8724        PERFORM 8600-DEEDIT
  8725        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8726        MOVE '4'                 TO DC-OPTION-CODE
  8727        PERFORM 9700-DATE-LINK
  8728        IF DATE-CONVERSION-ERROR
  8729           MOVE ER-0348          TO EMI-ERROR
  8730           MOVE -1               TO CEFFDTL
  8731           MOVE AL-UABON         TO CEFFDTA
  8732           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8733           GO TO 8200-SEND-DATAONLY
  8734        ELSE
  8735           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8736           PERFORM 6000-CREATE-TEMP-STORAGE
  8737                                 THRU 6000-EXIT
  8738           IF EIBAID = DFHPF17
  8739               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8740                                  THRU 6400-EXIT
  8741               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8742                                 '2' AND '3' AND '4'
  8743                  MOVE ER-3831     TO  EMI-ERROR
  8744                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8745                  GO TO 8200-SEND-DATAONLY
  8746               END-IF
  8747               MOVE 'Y'          TO PI-CLM-RESC-IND
  8748           ELSE
  8749               MOVE 'N'          TO PI-CLM-RESC-IND
  8750           END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 164
* EL6311.cbl
  8751           MOVE XCTL-EL6316      TO PGM-NAME
  8752           MOVE '2'              TO PI-ISS-CAN-SW
  8753           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8754           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8755           GO TO 9300-XCTL
  8756        END-IF
  8757     END-IF
  8758
  8759     IF EIBAID = DFHPF4
  8760        MOVE '0'                TO PI-EDIT-SW
  8761        IF PI-DISPLAY-ORIGINAL-BATCH
  8762           NEXT SENTENCE
  8763        ELSE
  8764           GO TO 7200-DISPLAY-BATCHES.
  8765
  8766     IF EIBAID = DFHPF5
  8767        MOVE ER-0029                TO EMI-ERROR
  8768        MOVE -1                     TO BPFENTRL
  8769        MOVE AL-UNBON               TO BPFENTRA
  8770        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8771        GO TO 8200-SEND-DATAONLY.
  8772*        MOVE '0'                TO PI-EDIT-SW
  8773*        IF PI-DISPLAY-ORIGINAL-BATCH
  8774*           NEXT SENTENCE
  8775*        ELSE
  8776*           MOVE EL631B              TO PI-MAP-NAME
  8777*           MOVE LOW-VALUES          TO EL631BI
  8778*           MOVE 'A'                 TO BMAINTO
  8779*           MOVE AL-UANON            TO BMAINTA
  8780*           MOVE -1                  TO BMAINTL
  8781*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8782*           GO TO 8100-SEND-INITIAL-MAP.
  8783
  8784     IF EIBAID = DFHPF6
  8785        MOVE ER-0029                TO EMI-ERROR
  8786        MOVE -1                     TO BPFENTRL
  8787        MOVE AL-UNBON               TO BPFENTRA
  8788        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8789        GO TO 8200-SEND-DATAONLY.
  8790*        MOVE '0'                TO PI-EDIT-SW
  8791*        IF PI-DISPLAY-ORIGINAL-BATCH
  8792*           NEXT SENTENCE
  8793*        ELSE
  8794*           MOVE EL631C              TO PI-MAP-NAME
  8795*           MOVE LOW-VALUES          TO EL631CI
  8796*           MOVE 'A'                 TO CMAINTO
  8797*           MOVE AL-UANON            TO CMAINTA
  8798*           MOVE -1                  TO CMAINTL
  8799*           MOVE '6'                 TO PI-MAINT-FUNCTION
  8800*           GO TO 8100-SEND-INITIAL-MAP.
  8801
  8802     IF EIBAID = DFHPF7
  8803        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8804        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8805        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8806        MOVE PI-SV-STATE            TO PI-STATE
  8807        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8808        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 165
* EL6311.cbl
  8809        MOVE CSUFIXI                TO PI-CERT-SFX
  8810        MOVE CEFFDTI                TO DEEDIT-FIELD
  8811        PERFORM 8600-DEEDIT
  8812        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8813        MOVE '4'                    TO DC-OPTION-CODE
  8814        PERFORM 9700-DATE-LINK
  8815        IF DATE-CONVERSION-ERROR
  8816           MOVE ER-0348            TO EMI-ERROR
  8817           MOVE -1                  TO BEFFDTL
  8818           MOVE AL-UABON            TO BEFFDTA
  8819           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8820           GO TO 8200-SEND-DATAONLY
  8821        ELSE
  8822           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8823           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8824           MOVE XCTL-EL1273        TO PGM-NAME
  8825           GO TO 9300-XCTL.
  8826
  8827     IF EIBAID = DFHPF8
  8828        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8829        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8830        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8831        MOVE PI-SV-STATE            TO PI-STATE
  8832        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8833        MOVE CCERTNOI               TO PI-CERT-PRIME
  8834        MOVE CSUFIXI                TO PI-CERT-SFX
  8835        MOVE CEFFDTI                TO DEEDIT-FIELD
  8836        PERFORM 8600-DEEDIT
  8837        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8838        MOVE '4'                    TO DC-OPTION-CODE
  8839        PERFORM 9700-DATE-LINK
  8840        IF DATE-CONVERSION-ERROR
  8841           MOVE ER-0348             TO EMI-ERROR
  8842           MOVE -1                  TO BEFFDTL
  8843           MOVE AL-UABON            TO BEFFDTA
  8844           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8845           GO TO 8200-SEND-DATAONLY
  8846        ELSE
  8847           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8848           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8849           IF PI-COMPANY-ID = 'DMD'
  8850               MOVE XCTL-EL401DMD      TO PGM-NAME
  8851             ELSE
  8852               MOVE XCTL-EL1279        TO PGM-NAME
  8853           END-IF
  8854           GO TO 9300-XCTL.
  8855
  8856     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8857        MOVE XCTL-EL6312     TO PGM-NAME
  8858
  8859* EXEC CICS XCTL
  8860*           PROGRAM  (PGM-NAME)
  8861*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  8862*           LENGTH   (WS-COMM-LENGTH)
  8863*       END-EXEC
  8864*    MOVE '.$C                   %   #00008804' TO DFHEIV0
  8865     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8866     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 166
* EL6311.cbl
  8867     MOVE X'2020233030303038383034' TO DFHEIV0(25:11)
  8868     CALL 'kxdfhei1' USING DFHEIV0,
  8869           PGM-NAME,
  8870           PROGRAM-INTERFACE-BLOCK,
  8871           WS-COMM-LENGTH,
  8872           DFHEIV99
  8873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8874     ELSE
  8875        MOVE '0'                 TO  PI-EDIT-SW.
  8876
  8877     IF EIBAID = DFHPF10
  8878         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8879         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  8880         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8881         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8882                                    PI-1042-WA
  8883         MOVE 4                  TO PI-689-DATA-SOURCE
  8884         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8885         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8886         MOVE PI-SV-STATE        TO PI-689-STATE
  8887         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8888         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8889         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8890         MOVE PI-PB-ALT-CHG-SEQ-NO
  8891                                 TO PI-689-ALT-SEQ-NO
  8892         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8893         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8894         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8895         MOVE +0                 TO PI-689-CONTROL
  8896         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8897                                    PI-689-EXP-DATE
  8898                                    PI-689-RESP-PERSON
  8899                                    PI-689-TYPE
  8900                                    PI-689-FOLLOW-UP-EDIT
  8901                                    PI-689-RESEND1-EDIT
  8902                                    PI-689-SEQ-EDIT
  8903                                    PI-689-BCSEQ-EDIT
  8904                                    PI-689-LBL-OVERRIDE
  8905         MOVE W-LETTER-COMMUNICATION-AREAS
  8906                                 TO PI-PROGRAM-WORK-AREA
  8907         MOVE XCTL-EL689         TO PGM-NAME
  8908         GO TO 9300-XCTL.
  8909
  8910     IF  EIBAID = DFHPF16
  8911         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8912         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8913         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8914                                    PI-1042-WA
  8915         MOVE 4                  TO PI-689-DATA-SOURCE
  8916         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8917         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8918         MOVE PI-SV-STATE        TO PI-689-STATE
  8919         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8920         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8921         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8922         MOVE PI-PB-ALT-CHG-SEQ-NO
  8923                                 TO PI-689-ALT-SEQ-NO
  8924         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 167
* EL6311.cbl
  8925         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8926         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8927         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8928         MOVE W-LETTER-COMMUNICATION-AREAS
  8929                                 TO PI-PROGRAM-WORK-AREA
  8930         MOVE XCTL-EL690         TO PGM-NAME
  8931         GO TO 9300-XCTL.
  8932
  8933     IF EIBAID = DFHPF13
  8934        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8935        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8936        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8937        MOVE PI-SV-STATE            TO PI-STATE
  8938        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8939        MOVE CCERTNOI               TO PI-CERT-PRIME
  8940        MOVE CSUFIXI                TO PI-CERT-SFX
  8941        MOVE CEFFDTI                TO DEEDIT-FIELD
  8942        PERFORM 8600-DEEDIT
  8943        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8944        MOVE '4'                    TO DC-OPTION-CODE
  8945        PERFORM 9700-DATE-LINK
  8946        IF DATE-CONVERSION-ERROR
  8947           MOVE ER-0348            TO EMI-ERROR
  8948           MOVE -1                  TO CEFFDTL
  8949           MOVE AL-UABON            TO CEFFDTA
  8950           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8951           GO TO 8200-SEND-DATAONLY
  8952        ELSE
  8953           MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  8954           MOVE AL-UANON            TO CEFFDTA
  8955           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8956           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8957           MOVE XCTL-EL677         TO PGM-NAME
  8958           GO TO 9300-XCTL.
  8959
  8960     IF EIBAID = DFHPF14
  8961        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8962        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8963        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8964        MOVE PI-SV-STATE            TO PI-CR-STATE
  8965        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8966        MOVE SPACE                  TO PI-EDIT-SW
  8967        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8968        MOVE XCTL-EL650             TO PGM-NAME
  8969        GO TO 9300-XCTL.
  8970
  8971     IF EIBAID = DFHENTER OR DFHPF11
  8972        GO TO 2000-CANCEL-MAINLINE.
  8973
  8974     MOVE ER-0029                TO EMI-ERROR.
  8975     MOVE -1                     TO CPFENTRL.
  8976     MOVE AL-UNBON               TO CPFENTRA.
  8977     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8978     GO TO 8200-SEND-DATAONLY.
  8979
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 168
* EL6311.cbl
  8981
  8982******************************************************************
  8983*                                                                *
  8984*      BATCH SCREEN PF KEY CHECKING                              *
  8985*                                                                *
  8986******************************************************************
  8987
  8988******************************************************************
  8989*                                                                *
  8990*      PF KEY FUNCTIONS:                                         *
  8991*                                                                *
  8992*      PF1 = BROWSE FORWARD                                      *
  8993*      PF2 = BROWSE BACKWARD                                     *
  8994*      PF3 = DISPLAY PREMIUM TOTALS                              *
  8995*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  8996*                                                                *
  8997*                                                                *
  8998******************************************************************
  8999
  9000 0500-CHECK-BATCH-PF-KEYS.
  9001     IF EIBAID = DFHPF1
  9002        MOVE '0'                TO PI-EDIT-SW
  9003        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9004           GO TO 5000-BROWSE-BATCH-HEADERS
  9005        ELSE
  9006           IF PI-GOOD-BROWSE
  9007              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9008                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9009              ELSE
  9010                 IF PI-FILE-BROWSE
  9011                    GO TO 4300-BROWSE-FILE-FORWARD
  9012                 ELSE
  9013                    IF PI-CSR-BROWSE
  9014                       GO TO 4200-BROWSE-CSR-FORWARD
  9015                    ELSE
  9016                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9017           ELSE
  9018              GO TO 0800-BROWSE-ERROR.
  9019
  9020     IF EIBAID = DFHPF2
  9021        MOVE '0'                TO PI-EDIT-SW
  9022        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9023           GO TO 5500-BROWSE-BATCH-BACKWARD
  9024        ELSE
  9025           IF PI-GOOD-BROWSE
  9026              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9027                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9028              ELSE
  9029                 IF PI-FILE-BROWSE
  9030                    GO TO 4800-BROWSE-FILE-BACKWARD
  9031                 ELSE
  9032                    IF PI-CSR-BROWSE
  9033                       GO TO 4900-BROWSE-CSR-BACKWARD
  9034                    ELSE
  9035                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9036           ELSE
  9037              GO TO 0800-BROWSE-ERROR.
  9038
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 169
* EL6311.cbl
  9039     IF EIBAID = DFHPF3
  9040        GO TO 3000-BATCH-MAINLINE.
  9041
  9042     IF  EIBAID = DFHPF4
  9043        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9044        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9045        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9046        MOVE PI-SV-STATE            TO PI-CR-STATE
  9047        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9048                                       PI-CR-FIN-RESP
  9049        MOVE 'A'                    TO PI-CR-TYPE
  9050        MOVE SPACE                  TO PI-EDIT-SW
  9051        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9052        MOVE XCTL-EL640             TO PGM-NAME
  9053        GO TO 9300-XCTL.
  9054
  9055     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9056       AND
  9057        (EIBAID = DFHENTER)
  9058           GO TO 3500-EDIT-BATCH-DATA.
  9059
  9060     IF EIBAID = DFHENTER
  9061        GO TO 3500-EDIT-BATCH-DATA.
  9062
  9063     MOVE ER-0029             TO EMI-ERROR.
  9064     MOVE -1                  TO DPFENTRL.
  9065     MOVE AL-UNBON            TO DPFENTRA.
  9066     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9067     GO TO 8200-SEND-DATAONLY.
  9068
  9069 0800-BROWSE-ERROR.
  9070     MOVE ER-2258                TO EMI-ERROR.
  9071     MOVE -1                     TO DPFENTRL.
  9072     MOVE AL-UNBON               TO DPFENTRA.
  9073     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9074     GO TO 8200-SEND-DATAONLY.
  9075
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 170
* EL6311.cbl
  9077
  9078******************************************************************
  9079*                                                                *
  9080*                I S S U E   M A I N L I N E                     *
  9081*                                                                *
  9082******************************************************************
  9083
  9084 1000-ISSUE-MAINLINE.
  9085     IF PI-DISPLAY-ORIGINAL-BATCH
  9086        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9087           MOVE ER-0023             TO EMI-ERROR
  9088           MOVE -1                  TO BMAINTL
  9089           MOVE AL-UABON            TO BMAINTA
  9090           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9091           GO TO 8200-SEND-DATAONLY
  9092        ELSE
  9093           NEXT SENTENCE
  9094     ELSE
  9095        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9096           MOVE ER-0023             TO EMI-ERROR
  9097           MOVE -1                  TO BMAINTL
  9098           MOVE AL-UABON            TO BMAINTA
  9099           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9100           GO TO 8200-SEND-DATAONLY.
  9101
  9102     IF BMAINTI = 'S'
  9103        GO TO 1100-SHOW-REQUEST.
  9104
  9105     IF NOT MODIFY-CAP
  9106         MOVE 'UPDATE'       TO SM-READ
  9107         PERFORM 9995-SECURITY-VIOLATION
  9108         MOVE ER-0070        TO EMI-ERROR
  9109         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9110         GO TO 8100-SEND-INITIAL-MAP.
  9111
  9112     IF BMAINTL GREATER THAN ZEROS
  9113        IF PI-PF5-FUNCTION
  9114           IF BMAINTI NOT = 'A'
  9115              MOVE AL-UABON  TO BMAINTA
  9116              MOVE -1        TO BMAINTL
  9117              MOVE ER-2260   TO EMI-ERROR
  9118              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9119              GO TO 8200-SEND-DATAONLY.
  9120
  9121     IF BCERTNOL = ZEROS
  9122       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9123         NEXT SENTENCE
  9124     ELSE
  9125         IF BCERTNOL NOT = ZEROS
  9126             MOVE AL-UANON       TO BCERTNOA
  9127         ELSE
  9128             MOVE -1             TO BCERTNOL
  9129             MOVE  1             TO SET-CURSOR-SW
  9130             MOVE ER-2218        TO EMI-ERROR
  9131             MOVE AL-UABON       TO BCERTNOA
  9132             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9133
  9134     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 171
* EL6311.cbl
  9135         MOVE AL-UANON       TO BSUFIXA
  9136     ELSE
  9137         MOVE AL-SANOF       TO BSUFIXA.
  9138
  9139     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9140        NEXT SENTENCE
  9141     ELSE
  9142        IF BEFFDTL NOT = ZEROS
  9143           MOVE AL-UNNON             TO BEFFDTA
  9144           MOVE BEFFDTI              TO DEEDIT-FIELD
  9145           PERFORM 8600-DEEDIT
  9146           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9147           MOVE 4                    TO DC-OPTION-CODE
  9148           PERFORM 9700-DATE-LINK
  9149           IF NO-CONVERSION-ERROR
  9150              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9151              ELSE
  9152              MOVE -1                TO BEFFDTL
  9153              MOVE  1                TO SET-CURSOR-SW
  9154              MOVE ER-2226           TO EMI-ERROR
  9155              MOVE AL-UNBON          TO BEFFDTA
  9156              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9157           ELSE
  9158              MOVE -1                TO BEFFDTL
  9159              MOVE  1                TO SET-CURSOR-SW
  9160              MOVE ER-2220           TO EMI-ERROR
  9161              MOVE AL-UNBON          TO BEFFDTA
  9162              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9163
  9164     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9165
  9166     IF BCERTNOL NOT = ZEROS
  9167        MOVE BCERTNOI                TO WS-NEW-PRIME
  9168     ELSE
  9169        MOVE SPACES                  TO WS-NEW-PRIME.
  9170
  9171     IF BSUFIXL NOT = ZEROS
  9172        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9173     ELSE
  9174        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9175
  9176     IF BEFFDTL NOT = ZEROS
  9177        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9178     ELSE
  9179        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9180
  9181     IF BMAINTI = 'A' OR 'K' OR 'S'
  9182        NEXT SENTENCE
  9183     ELSE
  9184        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9185        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9186           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9187           WS-PB-RECORD-TYPE NOT = '1'
  9188           IF BMAINTI = 'C'
  9189               MOVE ER-2287          TO EMI-ERROR
  9190               MOVE -1               TO BCERTNOL
  9191               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9192               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 172
* EL6311.cbl
  9193               GO TO 8200-SEND-DATAONLY
  9194             ELSE
  9195               MOVE ER-2260          TO EMI-ERROR
  9196               MOVE -1               TO BCERTNOL
  9197               MOVE AL-UABON         TO BCERTNOA
  9198               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9199               GO TO 8200-SEND-DATAONLY.
  9200
  9201     IF BMAINTI = 'D'
  9202         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9203
  9204*    IF BMICRNOL  NOT =  ZEROS
  9205*        IF BMICRNOI  NUMERIC
  9206*            MOVE AL-UNNON       TO  BMICRNOA
  9207*        ELSE
  9208*            MOVE -1             TO  BMICRNOL
  9209*            MOVE 1              TO  SET-CURSOR-SW
  9210*            MOVE AL-UNBON       TO  BMICRNOA
  9211*            MOVE ER-2701        TO  EMI-ERROR
  9212*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9213     IF BVINL NOT = ZEROS
  9214        MOVE AL-UANON            TO BVINA
  9215     END-IF
  9216     IF B1STNML NOT = ZEROS
  9217         MOVE AL-UANON                TO B1STNMA.
  9218
  9219     IF BINITL  NOT = ZEROS
  9220        MOVE AL-UANON                TO BINITA.
  9221
  9222     IF BSEXL NOT = ZEROS
  9223        IF BSEXI = 'M' OR 'F'
  9224           MOVE AL-UANON             TO BSEXA
  9225        ELSE
  9226           MOVE -1               TO BSEXL
  9227           MOVE ER-2629          TO EMI-ERROR
  9228           MOVE AL-UABON         TO BSEXA
  9229           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9230
  9231     IF BAGEL NOT = ZEROS
  9232         IF BAGEI NUMERIC
  9233             MOVE BAGEI              TO WS-BAGE
  9234             MOVE AL-UNNON           TO BAGEA
  9235         ELSE
  9236             MOVE -1                 TO BAGEL
  9237             MOVE  1                 TO SET-CURSOR-SW
  9238             MOVE ER-2223            TO EMI-ERROR
  9239             MOVE AL-UNBON           TO BAGEA
  9240             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9241
  9242     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9243
  9244     IF (BBIRTHL GREATER THAN +0) AND
  9245        (BBIRTHI NOT EQUAL SPACES)
  9246        NEXT SENTENCE
  9247     ELSE
  9248        GO TO 1010-CHECK-AGE.
  9249
  9250     MOVE BBIRTHI                TO DEEDIT-FIELD.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 173
* EL6311.cbl
  9251     PERFORM 8600-DEEDIT.
  9252     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9253     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9254     MOVE AL-UNNON               TO BBIRTHA.
  9255     MOVE '4'                    TO DC-OPTION-CODE.
  9256     PERFORM 9700-DATE-LINK.
  9257     IF DATE-CONVERSION-ERROR
  9258        MOVE -1                  TO BBIRTHL
  9259        MOVE  1                  TO SET-CURSOR-SW
  9260        MOVE ER-2228             TO EMI-ERROR
  9261        MOVE AL-UNBON            TO BBIRTHA
  9262        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9263        GO TO 1010-CHECK-AGE.
  9264
  9265     IF (NO-CONVERSION-ERROR) AND
  9266        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9267        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9268        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9269        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9270                                    WS-CONVERTED-BIRTH
  9271        MOVE AL-UANON            TO BBIRTHA
  9272     ELSE
  9273        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9274        MOVE AL-UANON            TO BBIRTHA.
  9275
  9276 1010-CHECK-AGE.
  9277
  9278*    IF BAGEL = ZERO
  9279*       IF BBIRTHL GREATER THAN ZERO
  9280*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9281
  9282     IF B1STPMTL NOT = ZEROS
  9283        IF B1STPMTI = SPACES
  9284           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9285        ELSE
  9286           MOVE B1STPMTI             TO DEEDIT-FIELD
  9287           PERFORM 8600-DEEDIT
  9288           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9289           MOVE AL-UNNON             TO B1STPMTA
  9290           MOVE 4                    TO DC-OPTION-CODE
  9291           PERFORM 9700-DATE-LINK
  9292           IF NO-CONVERSION-ERROR
  9293              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9294              MOVE AL-UANON          TO B1STPMTA
  9295           ELSE
  9296              MOVE -1                TO B1STPMTL
  9297              MOVE  1                TO SET-CURSOR-SW
  9298              MOVE ER-2200           TO EMI-ERROR
  9299              MOVE AL-UNBON          TO B1STPMTA
  9300              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9301
  9302     IF BDAYSL NOT = ZEROS
  9303         IF BDAYSI NUMERIC
  9304             MOVE AL-UNNON           TO BDAYSA
  9305         ELSE
  9306             MOVE -1                 TO BDAYSL
  9307             MOVE ER-2530            TO EMI-ERROR
  9308             MOVE AL-UNBON           TO BDAYSA
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 174
* EL6311.cbl
  9309             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9310
  9311     IF BLNTRML NOT = ZEROS
  9312         IF BLNTRMI NUMERIC
  9313             MOVE AL-UNNON       TO BLNTRMA
  9314         ELSE
  9315             MOVE -1             TO BLNTRML
  9316             MOVE ER-2533        TO EMI-ERROR
  9317             MOVE AL-UNBON       TO BLNTRMA
  9318             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9319
  9320**   IF PI-COMPANY-ID = 'DMD'
  9321     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9322        NEXT SENTENCE
  9323     ELSE
  9324         IF BLNOFCRL NOT = ZEROS
  9325            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9326            IF LOAN-OFFICER-FOUND
  9327                MOVE AL-UANON        TO BLNOFCRA
  9328             ELSE
  9329                 MOVE SPACE          TO WS-LOAN-OFFICER
  9330                 MOVE -1             TO BLNOFCRL
  9331                 MOVE  1             TO SET-CURSOR-SW
  9332                 MOVE ER-3006        TO EMI-ERROR
  9333                 MOVE AL-UNBON       TO BLNOFCRA
  9334                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9335
  9336     IF BFREQL NOT = ZEROS
  9337         IF BFREQI NUMERIC
  9338             MOVE AL-UNNON       TO BFREQA
  9339         ELSE
  9340             MOVE -1             TO BFREQL
  9341             MOVE  1             TO SET-CURSOR-SW
  9342             MOVE ER-2223        TO EMI-ERROR
  9343             MOVE AL-UNBON       TO BFREQA
  9344             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9345
  9346     IF BMODEL NOT = ZEROS
  9347         MOVE BMODEI             TO WS-MODE-CODE
  9348                                    PI-BMODE
  9349         IF WS-MODE-CODE-VALID
  9350             MOVE AL-UANON       TO BMODEA
  9351         ELSE
  9352             MOVE -1             TO BMODEL
  9353             MOVE ER-2591        TO EMI-ERROR
  9354             MOVE AL-UABON       TO BMODEA
  9355             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9356
  9357     IF BPMTSL NOT = ZEROS
  9358         IF BPMTSI NUMERIC
  9359             MOVE AL-UNNON           TO BPMTSA
  9360             MOVE BPMTSI             TO PI-BPMTS
  9361         ELSE
  9362             MOVE -1                 TO BPMTSL
  9363             MOVE ER-2592            TO EMI-ERROR
  9364             MOVE AL-UNBON           TO BPMTSA
  9365             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9366
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 175
* EL6311.cbl
  9367     IF BPMTAMTL NOT = ZEROS
  9368
  9369* EXEC CICS BIF DEEDIT
  9370*            FIELD  (BPMTAMTI)
  9371*            LENGTH (9)
  9372*       END-EXEC
  9373     MOVE 9
  9374       TO DFHEIV11
  9375*    MOVE '@"L                   #   #00009303' TO DFHEIV0
  9376     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9377     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9378     MOVE X'2020233030303039333033' TO DFHEIV0(25:11)
  9379     CALL 'kxdfhei1' USING DFHEIV0,
  9380           BPMTAMTI,
  9381           DFHEIV11
  9382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9383        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9384*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9385*        PERFORM 8600-DEEDIT
  9386*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9387
  9388*    IF BAPRL NOT = ZEROS
  9389*        EXEC CICS BIF DEEDIT
  9390*            FIELD  (BAPRI)
  9391*            LENGTH (7)
  9392*        END-EXEC
  9393*        MOVE BAPRI              TO WS-BAPR.
  9394
  9395     IF BAPRL > 0
  9396        MOVE +0                  TO  WS-BAPR
  9397        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9398           (WS-SUB > 7)
  9399           OR (BAPRI (WS-SUB:1) NUMERIC)
  9400           OR (BAPRI (WS-SUB:1) = '.')
  9401        END-PERFORM
  9402        IF WS-SUB > 7
  9403           MOVE ER-2471       TO EMI-ERROR
  9404           MOVE -1            TO BAPRL
  9405           MOVE AL-UNBON      TO BAPRA
  9406           PERFORM 9900-ERROR-FORMAT
  9407                                 THRU 9900-EXIT
  9408        ELSE
  9409           IF BAPRI (WS-SUB:1) NUMERIC
  9410              MOVE WS-SUB           TO WS-BEG
  9411              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9412                 (WS-SUB > 7)
  9413                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9414              END-PERFORM
  9415              COMPUTE WS-END = WS-SUB - WS-BEG
  9416              MOVE BAPRI (WS-BEG:WS-END)
  9417                                 TO WS-APR-WHOLE-NUM
  9418           END-IF
  9419           IF BAPRI (WS-SUB:1) = '.'
  9420              COMPUTE WS-BEG = WS-SUB + 1
  9421              IF (WS-BEG < 8)
  9422                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9423                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9424                    (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 176
* EL6311.cbl
  9425                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9426                 END-PERFORM
  9427                 COMPUTE WS-END = WS-SUB - WS-BEG
  9428                 MOVE BAPRI (WS-BEG:WS-END)
  9429                                 TO WS-APR-DEC (1:WS-END)
  9430              END-IF
  9431           END-IF
  9432           MOVE AL-UNNON      TO BAPRA
  9433           MOVE WS-BAPR       TO BAPRO
  9434        END-IF
  9435     END-IF
  9436*     IF BAPRL NOT = ZEROS
  9437*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9438*        PERFORM 8600-DEEDIT
  9439*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9440
  9441     IF BLIVESL NOT = ZEROS
  9442        MOVE BLIVESI             TO DEEDIT-FIELD
  9443        PERFORM 8600-DEEDIT
  9444        IF DEEDIT-FIELD-V0 NUMERIC
  9445           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9446           MOVE AL-UNNON         TO BLIVESA
  9447        ELSE
  9448           MOVE -1               TO BLIVESL
  9449           MOVE AL-UNBON         TO BLIVESA
  9450           MOVE ER-2223          TO EMI-ERROR
  9451           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9452
  9453*DMD CUSTOM CODING*************START
  9454*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9455     IF PI-COMPANY-ID NOT = 'DMD'
  9456         MOVE ZEROS               TO BBILLEDL
  9457         GO TO 1010-EDIT-CONT.
  9458
  9459     IF BBILLEDL NOT = ZEROS
  9460        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9461        MOVE 'Y'                 TO WS-NUMERIC-SW
  9462        MOVE +1                  TO WS-CSO-SUB
  9463        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9464        IF CSO-NUMERIC-FIELD
  9465
  9466* EXEC CICS BIF DEEDIT
  9467*              FIELD  (BBILLEDI)
  9468*              LENGTH (9)
  9469*          END-EXEC
  9470     MOVE 9
  9471       TO DFHEIV11
  9472*    MOVE '@"L                   #   #00009389' TO DFHEIV0
  9473     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9474     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9475     MOVE X'2020233030303039333839' TO DFHEIV0(25:11)
  9476     CALL 'kxdfhei1' USING DFHEIV0,
  9477           BBILLEDI,
  9478           DFHEIV11
  9479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9480           MOVE BBILLEDI         TO WS-BILLED
  9481           MOVE AL-UNNON         TO BBILLEDA
  9482        ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 177
* EL6311.cbl
  9483           MOVE -1               TO BBILLEDL
  9484           MOVE AL-UNBON         TO BBILLEDA
  9485           MOVE ER-2547          TO EMI-ERROR
  9486           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9487     ELSE
  9488        IF BMAINTI EQUAL 'A'
  9489           MOVE -1               TO BBILLEDL
  9490           MOVE AL-UNBON         TO BBILLEDA
  9491           MOVE ER-8148          TO EMI-ERROR
  9492           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9493
  9494 1010-EDIT-CONT.
  9495
  9496     IF BFORCEL  NOT = ZEROS
  9497         IF FORCE-CAP
  9498            MOVE AL-UANON            TO BFORCEA
  9499         ELSE
  9500            MOVE ER-2945             TO EMI-ERROR
  9501            MOVE AL-UABON            TO BFORCEA
  9502            MOVE -1                  TO BFORCEL
  9503            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9504
  9505     IF BENTRYL NOT = ZEROS
  9506        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9507                         'D' AND 'V' AND 'U' AND 'M'
  9508           MOVE ER-2224              TO EMI-ERROR
  9509           MOVE AL-UABON             TO BENTRYA
  9510           MOVE -1                   TO BENTRYL
  9511           MOVE  1                   TO SET-CURSOR-SW
  9512           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9513        ELSE
  9514           MOVE AL-UANON             TO BENTRYA.
  9515
  9516     IF BUNWRITL NOT = ZEROS
  9517        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9518           MOVE ER-7574              TO EMI-ERROR
  9519           MOVE AL-UABON             TO BUNWRITA
  9520           MOVE -1                   TO BUNWRITL
  9521           MOVE  1                   TO SET-CURSOR-SW
  9522           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9523        ELSE
  9524           MOVE AL-UANON             TO BUNWRITA.
  9525
  9526     IF BREINL  NOT = ZEROS
  9527         MOVE AL-UANON               TO BREINA.
  9528
  9529     IF BBILCDL NOT = ZEROS
  9530        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9531                             AND 'A' AND 'B' AND 'E'
  9532           MOVE ER-2225              TO EMI-ERROR
  9533           MOVE AL-UABON             TO BBILCDA
  9534           MOVE -1                   TO BBILCDL
  9535           MOVE  1                   TO SET-CURSOR-SW
  9536           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9537        ELSE
  9538           MOVE AL-UANON             TO BBILCDA.
  9539
  9540     IF BSKPCDL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 178
* EL6311.cbl
  9541         MOVE AL-UANON               TO BSKPCDA.
  9542
  9543     IF BINDGRPL NOT = ZEROS
  9544         MOVE AL-UANON               TO BINDGRPA.
  9545
  9546     IF BSIGL   NOT = ZEROS
  9547         MOVE AL-UANON               TO BSIGA.
  9548
  9549     IF BRTCLSL NOT = ZEROS
  9550         MOVE AL-UANON               TO BRTCLSA.
  9551
  9552     IF BMEMBERL NOT = ZEROS
  9553         MOVE AL-UANON               TO BMEMBERA.
  9554
  9555     MOVE +0                         TO WS-SUB1.
  9556
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 179
* EL6311.cbl
  9558
  9559******************************************************************
  9560*                                                                *
  9561*           E D I T   I S S U E   C O V E R A G E S              *
  9562*                                                                *
  9563******************************************************************
  9564
  9565 1020-EDIT-COVERAGES.
  9566     ADD +1                      TO WS-SUB1.
  9567
  9568     IF WS-SUB1 GREATER +2
  9569        GO TO 1025-EDIT-COMPLETE.
  9570
  9571     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9572       IF (BMODEL   GREATER ZERO  OR
  9573            BPMTSL   GREATER ZERO  OR
  9574            BPMTAMTL GREATER ZERO)
  9575          AND
  9576            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9577               GO TO 1021-CONT-EDIT.
  9578
  9579     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9580        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9581        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9582        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9583        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9584        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9585        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9586        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9587        NEXT SENTENCE
  9588         ELSE
  9589            GO TO 1020-EDIT-COVERAGES.
  9590
  9591 1021-CONT-EDIT.
  9592
  9593     IF BMAINTI = 'A'
  9594        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9595           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9596        ELSE
  9597           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9598           MOVE ER-7404          TO EMI-ERROR
  9599           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9600           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9601     ELSE
  9602        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9603           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9604
  9605     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9606        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9607        PERFORM 8600-DEEDIT
  9608        IF DEEDIT-FIELD-V0 NUMERIC
  9609           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9610        ELSE
  9611           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9612
  9613     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9614*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9615        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 180
* EL6311.cbl
  9616           BPMTSL  GREATER THAN ZEROS
  9617           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9618
  9619     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9620         IF BMODEL   GREATER THAN ZEROS  OR
  9621            BPMTSL   GREATER THAN ZEROS  OR
  9622            BPMTAMTL GREATER THAN ZEROS
  9623             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9624
  9625     IF BMAINTI = ('C' OR 'K')
  9626        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9627           NEXT SENTENCE
  9628        ELSE
  9629           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9630           PERFORM 8600-DEEDIT
  9631           IF DEEDIT-FIELD-V0 NUMERIC
  9632              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9633              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9634                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9635              ELSE
  9636                    MOVE ER-2241      TO EMI-ERROR
  9637                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9638                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9639                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9640           ELSE
  9641              MOVE ER-2223          TO EMI-ERROR
  9642              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9643              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9644              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9645     ELSE
  9646        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9647            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9648            PERFORM 8600-DEEDIT
  9649            IF DEEDIT-FIELD-V0      NUMERIC
  9650               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9651                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9652                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9653               ELSE
  9654                  MOVE ER-2241         TO EMI-ERROR
  9655                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9656                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9657                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9658            ELSE
  9659              MOVE ER-2223             TO EMI-ERROR
  9660              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9661              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9662              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9663        ELSE
  9664            MOVE ER-2240               TO EMI-ERROR
  9665            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9666            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9667*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9668*        IF BMODEL  GREATER THAN ZEROS  AND
  9669*           BPMTSL  GREATER THAN ZEROS
  9670*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9671
  9672     IF BBEN-LEN (WS-SUB1) = ZEROS
  9673        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 181
* EL6311.cbl
  9674           NEXT SENTENCE
  9675     ELSE
  9676        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9677           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9678
  9679* EXEC CICS BIF DEEDIT
  9680*              FIELD  (BBENI (WS-SUB1))
  9681*              LENGTH (12)
  9682*          END-EXEC
  9683     MOVE 12
  9684       TO DFHEIV11
  9685*    MOVE '@"L                   #   #00009591' TO DFHEIV0
  9686     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9687     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9688     MOVE X'2020233030303039353931' TO DFHEIV0(25:11)
  9689     CALL 'kxdfhei1' USING DFHEIV0,
  9690           BBENI(WS-SUB1),
  9691           DFHEIV11
  9692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9693           IF BBENI (WS-SUB1)  NUMERIC
  9694              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9695                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9696*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9697*          PERFORM 8600-DEEDIT
  9698*          IF DEEDIT-FIELD-V2  NUMERIC
  9699*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9700*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9701              ELSE
  9702                 MOVE ER-7632    TO EMI-ERROR
  9703                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9704                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9705                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9706           ELSE
  9707              MOVE ER-2223         TO EMI-ERROR
  9708              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9709              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9710              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9711        ELSE
  9712           MOVE ER-7632    TO EMI-ERROR
  9713           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9714           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9715           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9716
  9717     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9718        AND (BMAINTI = ('C' OR 'K'))
  9719        CONTINUE
  9720     ELSE
  9721        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9722           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9723           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9724              FOR ALL '.'
  9725           IF WS-TALLY > 1
  9726              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9727                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9728              END-PERFORM
  9729              IF A1 < 9
  9730                 ADD 3 TO A1
  9731                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 182
* EL6311.cbl
  9732              END-IF
  9733           ELSE
  9734              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9735                (A1 > 11)
  9736                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9737                  LOW-VALUES OR SPACES)
  9738              END-PERFORM
  9739              IF A1 > 1 AND < 12
  9740                 MOVE SPACES
  9741                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9742              END-IF
  9743           END-IF
  9744
  9745* EXEC CICS BIF DEEDIT
  9746*              FIELD  (BPREMI (WS-SUB1))
  9747*              LENGTH (11)
  9748*          END-EXEC
  9749     MOVE 11
  9750       TO DFHEIV11
  9751*    MOVE '@"L                   #   #00009646' TO DFHEIV0
  9752     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9753     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9754     MOVE X'2020233030303039363436' TO DFHEIV0(25:11)
  9755     CALL 'kxdfhei1' USING DFHEIV0,
  9756           BPREMI(WS-SUB1),
  9757           DFHEIV11
  9758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9759           IF BPREMI (WS-SUB1) NUMERIC
  9760              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9761                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9762*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9763*          PERFORM 8600-DEEDIT
  9764*          IF DEEDIT-FIELD-V2  NUMERIC
  9765*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9766*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9767              ELSE
  9768                 IF PI-COMPANY-ID NOT = 'DCC'
  9769                    MOVE ER-7633    TO EMI-ERROR
  9770                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9771                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9772                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9773                 END-IF
  9774              END-IF
  9775           ELSE
  9776              MOVE ER-2223         TO EMI-ERROR
  9777              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9778              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9779              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9780           END-IF
  9781        ELSE
  9782           IF PI-COMPANY-ID NOT = 'DCC'
  9783              MOVE ER-7633         TO EMI-ERROR
  9784              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9785              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9786              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9787           END-IF
  9788        END-IF
  9789     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 183
* EL6311.cbl
  9790
  9791     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9792        NEXT SENTENCE
  9793     ELSE
  9794        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9795
  9796* EXEC CICS BIF DEEDIT
  9797*           FIELD  (BCPREMI (WS-SUB1))
  9798*           LENGTH (11)
  9799*       END-EXEC
  9800     MOVE 11
  9801       TO DFHEIV11
  9802*    MOVE '@"L                   #   #00009686' TO DFHEIV0
  9803     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9804     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9805     MOVE X'2020233030303039363836' TO DFHEIV0(25:11)
  9806     CALL 'kxdfhei1' USING DFHEIV0,
  9807           BCPREMI(WS-SUB1),
  9808           DFHEIV11
  9809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9810        IF BCPREMI (WS-SUB1) NUMERIC
  9811           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
  9812*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
  9813*       PERFORM 8600-DEEDIT
  9814*       IF DEEDIT-FIELD-V2  NUMERIC
  9815*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
  9816        ELSE
  9817           MOVE ER-2223         TO EMI-ERROR
  9818           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
  9819           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
  9820           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9821
  9822     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9823        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
  9824        PERFORM 8600-DEEDIT
  9825        IF DEEDIT-FIELD-V0 NUMERIC
  9826           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
  9827           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9828         ELSE
  9829           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
  9830           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9831           MOVE ER-2223              TO EMI-ERROR
  9832           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9833
  9834     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9835        IF BEXPIRE   (WS-SUB1) = SPACES
  9836           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
  9837        ELSE
  9838           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
  9839           PERFORM 8600-DEEDIT
  9840           IF DEEDIT-FIELD-V0        NUMERIC
  9841              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
  9842              MOVE 4                TO DC-OPTION-CODE
  9843              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9844              PERFORM 9700-DATE-LINK
  9845              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
  9846                                                        (WS-SUB1)
  9847              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 184
* EL6311.cbl
  9848                 NEXT SENTENCE
  9849              ELSE
  9850                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
  9851                 MOVE ER-2531    TO EMI-ERROR
  9852                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
  9853                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9854           ELSE
  9855             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
  9856             MOVE ER-2532        TO EMI-ERROR
  9857             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
  9858             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9859
  9860     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
  9861        NEXT SENTENCE
  9862     ELSE
  9863
  9864* EXEC CICS BIF DEEDIT
  9865*           FIELD  (BALT-BENI (WS-SUB1))
  9866*           LENGTH (12)
  9867*       END-EXEC
  9868     MOVE 12
  9869       TO DFHEIV11
  9870*    MOVE '@"L                   #   #00009743' TO DFHEIV0
  9871     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9872     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9873     MOVE X'2020233030303039373433' TO DFHEIV0(25:11)
  9874     CALL 'kxdfhei1' USING DFHEIV0,
  9875           BALT-BENI(WS-SUB1),
  9876           DFHEIV11
  9877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9878        IF BALT-BENI (WS-SUB1) NUMERIC
  9879           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
  9880*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
  9881*       PERFORM 8600-DEEDIT
  9882*       IF DEEDIT-FIELD-V0 NUMERIC
  9883*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
  9884        ELSE
  9885           MOVE ER-2223         TO EMI-ERROR
  9886           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
  9887           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
  9888           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9889
  9890     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
  9891        NEXT SENTENCE
  9892     ELSE
  9893
  9894* EXEC CICS BIF DEEDIT
  9895*           FIELD  (BALT-PREMI (WS-SUB1))
  9896*           LENGTH (11)
  9897*       END-EXEC
  9898     MOVE 11
  9899       TO DFHEIV11
  9900*    MOVE '@"L                   #   #00009762' TO DFHEIV0
  9901     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9902     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9903     MOVE X'2020233030303039373632' TO DFHEIV0(25:11)
  9904     CALL 'kxdfhei1' USING DFHEIV0,
  9905           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 185
* EL6311.cbl
  9906           DFHEIV11
  9907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9908        IF BALT-PREMI (WS-SUB1) NUMERIC
  9909           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
  9910*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
  9911*       PERFORM 8600-DEEDIT
  9912*       IF DEEDIT-FIELD-V0 NUMERIC
  9913*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
  9914        ELSE
  9915           MOVE ER-2223         TO EMI-ERROR
  9916           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
  9917           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
  9918           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9919
  9920      GO TO 1020-EDIT-COVERAGES.
  9921
  9922 1025-EDIT-COMPLETE.
  9923     IF PI-COMPANY-ID  =  'DMD'
  9924        MOVE LOW-VALUES             TO BNCERTI
  9925                                       BNSTATI.
  9926
  9927     IF EMI-ERROR = ZEROS
  9928         NEXT SENTENCE
  9929     ELSE
  9930         GO TO 8200-SEND-DATAONLY.
  9931
  9932     IF BMAINTI = 'A'
  9933         GO TO 1200-ADD-ISSUE-ROUTINE.
  9934
  9935     IF BMAINTI = 'C'
  9936         GO TO 1300-CHANGE-ISSUE-ROUTINE.
  9937
  9938     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
  9939
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 186
* EL6311.cbl
  9941
  9942 1030-EDIT-FOR-NUMERICS.
  9943     IF WS-CSO-SUB EQUAL 10
  9944        GO TO 1030-EDIT-EXIT.
  9945
  9946     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
  9947        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
  9948        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
  9949           ADD +1               TO WS-CSO-SUB
  9950           GO TO 1030-EDIT-FOR-NUMERICS.
  9951
  9952     MOVE 'N'                   TO WS-NUMERIC-SW.
  9953
  9954 1030-EDIT-EXIT.
  9955******************************************************************
  9956*                                                                *
  9957*                 C A L C U L A T E   A G E                      *
  9958*                                                                *
  9959******************************************************************
  9960
  9961
  9962 1095-CALC-AGE.
  9963
  9964     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
  9965     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
  9966     MOVE 1                  TO DC-OPTION-CODE.
  9967     PERFORM 9700-DATE-LINK
  9968     IF NO-CONVERSION-ERROR
  9969         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
  9970         MOVE WS-BAGE            TO BAGEI
  9971         MOVE +2                 TO BAGEL
  9972         MOVE AL-UNNON TO BAGEA.
  9973
  9974 1099-EXIT.
  9975     EXIT.
  9976
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 187
* EL6311.cbl
  9978
  9979******************************************************************
  9980*                                                                *
  9981*                   S H O W   I S S U E                          *
  9982*                                                                *
  9983******************************************************************
  9984
  9985 1100-SHOW-REQUEST.
  9986     MOVE 'S'                    TO PI-MAINT-FUNCTION.
  9987
  9988     IF BCERTNOL = ZEROS AND
  9989        BEFFDTL  = ZEROS
  9990        MOVE -1                  TO BMAINTL
  9991        GO TO 8200-SEND-DATAONLY.
  9992
  9993     MOVE BCERTNOI               TO WS-NEW-PRIME.
  9994
  9995     IF BSUFIXL NOT = ZEROS
  9996        MOVE BSUFIXI             TO WS-NEW-SUFFIX
  9997     ELSE
  9998        MOVE SPACE               TO WS-NEW-SUFFIX.
  9999
 10000     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10001     PERFORM 8600-DEEDIT.
 10002     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10003     MOVE '4'                    TO DC-OPTION-CODE.
 10004     PERFORM 9700-DATE-LINK.
 10005     IF DATE-CONVERSION-ERROR
 10006        MOVE ER-0348             TO EMI-ERROR
 10007        MOVE -1                  TO BEFFDTL
 10008        MOVE AL-UABON            TO BEFFDTA
 10009        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10010        GO TO 8200-SEND-DATAONLY
 10011     ELSE
 10012        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10013        MOVE AL-UANON            TO BEFFDTA
 10014        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10015
 10016     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10017
 10018     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10019        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10020          MOVE 'Y'                    TO WS-SHOW-SW
 10021          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10022             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10023           ELSE
 10024             IF PI-FILE-BROWSE
 10025                GO TO 4300-BROWSE-FILE-FORWARD
 10026              ELSE
 10027                IF PI-CSR-BROWSE
 10028                   GO TO 4200-BROWSE-CSR-FORWARD
 10029                ELSE
 10030                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10031        ELSE
 10032           GO TO 3900-RE-DISPLAY-RECORD.
 10033
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 188
* EL6311.cbl
 10035
 10036******************************************************************
 10037*                                                                *
 10038*            A D D   I S S U E   R O U T I N E                   *
 10039*                                                                *
 10040******************************************************************
 10041
 10042***************************************************************
 10043*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10044*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10045*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10046*     4. LINK TO THE EDIT ROUTINE.                            *
 10047*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10048*     6. WRITE THE NEW ISSUE RECORD.                          *
 10049*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10050*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10051*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10052*        ELSE                                                 *
 10053*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10054***************************************************************
 10055
 10056 1200-ADD-ISSUE-ROUTINE.
 10057     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10058
 10059
 10060* EXEC CICS GETMAIN
 10061*        SET     (ADDRESS OF PENDING-BUSINESS)
 10062*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10063*    END-EXEC.
 10064*    MOVE '," L                  $   #00009917' TO DFHEIV0
 10065     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10066     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10067     MOVE X'2020233030303039393137' TO DFHEIV0(25:11)
 10068     CALL 'kxdfhei1' USING DFHEIV0,
 10069           DFHEIV20,
 10070           ERPNDB-RECORD-LENGTH,
 10071           DFHEIV99
 10072     SET ADDRESS OF PENDING-BUSINESS TO
 10073         DFHEIV20
 10074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10075
 10076
 10077
 10078* EXEC CICS HANDLE CONDITION
 10079*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10080*    END-EXEC.
 10081*    MOVE '"$I                   ! # #00009922' TO DFHEIV0
 10082     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10083     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10084     MOVE X'2320233030303039393232' TO DFHEIV0(25:11)
 10085     CALL 'kxdfhei1' USING DFHEIV0
 10086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10087
 10088
 10089     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10090     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10091     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10092
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 189
* EL6311.cbl
 10093
 10094* EXEC CICS READ
 10095*        INTO    (PENDING-BUSINESS)
 10096*        DATASET (FILE-ID-ERPNDB)
 10097*        RIDFLD  (ERPNDB-KEY)
 10098*    END-EXEC.
 10099     MOVE LENGTH OF
 10100      PENDING-BUSINESS
 10101       TO DFHEIV11
 10102*    MOVE '&"IL       E          (   #00009930' TO DFHEIV0
 10103     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10104     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10105     MOVE X'2020233030303039393330' TO DFHEIV0(25:11)
 10106     CALL 'kxdfhei1' USING DFHEIV0,
 10107           FILE-ID-ERPNDB,
 10108           PENDING-BUSINESS,
 10109           DFHEIV11,
 10110           ERPNDB-KEY,
 10111           DFHEIV99,
 10112           DFHEIV99,
 10113           DFHEIV99
 10114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10115
 10116
 10117     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10118
 10119     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10120     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10121     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10122     MOVE SPACES                 TO PENDING-BUSINESS.
 10123     MOVE 'PB'                   TO PB-RECORD-ID.
 10124     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10125     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10126     MOVE SPACES                 TO PB-CERT-SFX.
 10127     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10128     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10129                                    PB-ALT-CHG-SEQ-NO.
 10130
 10131     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10132     MOVE '1'                    TO PB-RECORD-TYPE.
 10133
 10134     IF BSUFIXL NOT = ZEROS
 10135        MOVE BSUFIXI             TO PB-CERT-SFX.
 10136
 10137     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10138
 10139     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10140     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10141
 10142     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10143                                    PB-I-LF-PREM-CALC
 10144                                    PB-I-LF-ALT-PREM-CALC
 10145                                    PB-I-LF-RATE
 10146                                    PB-I-LF-ALT-RATE
 10147                                    PB-I-LF-REI-RATE
 10148                                    PB-I-LF-ALT-REI-RATE
 10149                                    PB-I-RATE-DEV-PCT-LF
 10150                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 190
* EL6311.cbl
 10151                                    PB-I-AH-RATE
 10152                                    PB-I-AH-REI-RATE
 10153                                    PB-I-AH-RATE-TRM
 10154                                    PB-I-RATE-DEV-PCT-AH
 10155                                    PB-I-BUSINESS-TYPE
 10156                                    PB-I-LIFE-COMMISSION
 10157                                    PB-I-JOINT-COMMISSION
 10158                                    PB-I-JOINT-AGE
 10159                                    PB-I-AH-COMMISSION
 10160                                    PB-I-CURR-SEQ
 10161                                    PB-CHG-COUNT
 10162                                    PB-LF-BILLED-AMTS
 10163                                    PB-AH-BILLED-AMTS
 10164                                    PB-CALC-TOLERANCE
 10165                                    PB-I-EXTENTION-DAYS
 10166*                                   PB-I-MICROFILM-NO
 10167                                    PB-I-TERM-IN-DAYS.
 10168
 10169     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10170                                    PB-I-LF-EXPIRE-DT
 10171                                    PB-I-AH-EXPIRE-DT
 10172                                    PB-BILLED-DT
 10173                                    PB-ACCT-EFF-DT
 10174                                    PB-ACCT-EXP-DT
 10175                                    PB-I-1ST-PMT-DT.
 10176
 10177     MOVE 'X'                    TO PB-FATAL-FLAG.
 10178
 10179     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10180
 10181     IF BLSTNML GREATER THAN ZEROS
 10182         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10183
 10184*    IF BMICRNOL  GREATER  ZEROS
 10185*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10186*    ELSE
 10187*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10188     IF BVINL > ZEROS
 10189        MOVE BVINI               TO PB-I-VIN
 10190     END-IF
 10191     IF B1STNML GREATER THAN ZEROS
 10192         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10193
 10194     IF BINITL  GREATER THAN ZEROS
 10195         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10196
 10197     IF BBIRTHL GREATER THAN ZERO
 10198         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10199     ELSE
 10200         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10201
 10202     IF B1STPMTL GREATER THAN ZERO
 10203         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10204     ELSE
 10205         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10206
 10207     IF BAGEL    GREATER THAN ZEROS
 10208         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 191
* EL6311.cbl
 10209        ELSE
 10210         MOVE ZEROS              TO PB-I-AGE.
 10211
 10212     IF BSEXL    GREATER THAN ZEROS
 10213         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10214
 10215     IF BTERM-LEN (1) GREATER THAN ZEROS
 10216        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10217     ELSE
 10218        MOVE ZEROS               TO PB-I-LF-TERM.
 10219
 10220     IF BTERM-LEN (2) GREATER THAN ZEROS
 10221        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10222     ELSE
 10223        MOVE ZEROS               TO PB-I-AH-TERM.
 10224
 10225     IF BLNTRML       GREATER THAN ZEROS
 10226         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10227        ELSE
 10228         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10229
 10230     IF BFREQL        GREATER THAN ZEROS
 10231         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10232        ELSE
 10233         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10234
 10235     IF BSKPCDL       GREATER THAN ZEROS
 10236         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10237
 10238     IF BMODEL        GREATER THAN ZEROS
 10239         MOVE BMODEI             TO PB-I-TERM-TYPE
 10240                                    PI-BMODE.
 10241
 10242     IF BPMTSL        GREATER THAN ZEROS
 10243         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10244                                    PI-BPMTS
 10245        ELSE
 10246         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10247                                    PI-BPMTS.
 10248
 10249     IF BPMTAMTL      GREATER THAN ZEROS
 10250         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10251        ELSE
 10252         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10253
 10254     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10255        IF BTYPE  (1)   NOT = ZEROS
 10256           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10257                                    PI-BTYPE (1)
 10258           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10259           MOVE SPACES           TO PB-I-LF-ABBR
 10260        ELSE
 10261           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10262                                    PB-I-LF-ABBR
 10263           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10264     ELSE
 10265        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10266                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 192
* EL6311.cbl
 10267        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10268
 10269     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10270         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10271     ELSE
 10272         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10273
 10274     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10275         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10276     ELSE
 10277         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10278
 10279     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10280         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10281            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10282            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10283         ELSE
 10284            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10285            MOVE '?'             TO PB-I-LF-CALC-FLAG
 10286     ELSE
 10287         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10288
 10289     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10290         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10291
 10292     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10293         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10294         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10295     ELSE
 10296         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10297
 10298     IF  BALT-PREM-LEN     (2) > ZEROS
 10299         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10300     ELSE
 10301         MOVE ZEROS            TO PB-I-TOT-FEES.
 10302
 10303     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10304        IF BTYPE      (2)   NOT = ZEROS
 10305           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10306                                  PI-BTYPE (2)
 10307           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10308           MOVE SPACES         TO PB-I-AH-ABBR
 10309        ELSE
 10310           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10311                                  PB-I-AH-ABBR
 10312           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10313     ELSE
 10314        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10315                                  PB-I-AH-ABBR
 10316        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10317
 10318     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10319         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10320     ELSE
 10321         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10322
 10323     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10324         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 193
* EL6311.cbl
 10325            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10326            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10327         ELSE
 10328            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10329            MOVE '?'             TO PB-I-AH-CALC-FLAG
 10330     ELSE
 10331         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10332
 10333     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10334         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10335
 10336     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10337        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10338     ELSE
 10339        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10340
 10341     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10342        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10343     ELSE
 10344        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10345
 10346     IF BINDGRPL  GREATER THAN ZEROS
 10347         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10348
 10349     IF BRTCLSL   GREATER THAN ZEROS
 10350         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10351
 10352     IF BSIGL     GREATER THAN ZEROS
 10353         MOVE BSIGI              TO PB-I-SIG-SW.
 10354     IF BAPRL > ZEROS
 10355         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10356     ELSE
 10357        if pi-company-id = 'CID'
 10358           move +99.9999         to pb-i-loan-apr
 10359        else
 10360           MOVE ZEROS            TO PB-I-LOAN-APR
 10361        end-if
 10362     end-if
 10363     IF BMEMBERL  GREATER THAN ZEROS
 10364         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10365
 10366     IF BLNOFCRL  GREATER THAN ZEROS
 10367         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10368
 10369     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10370        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10371     ELSE
 10372        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10373
 10374     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10375        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10376     ELSE
 10377        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10378
 10379     IF BDAYSL   GREATER THAN ZEROS
 10380        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10381                                    PB-I-EXTENTION-DAYS
 10382     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 194
* EL6311.cbl
 10383        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10384                                    PB-I-EXTENTION-DAYS.
 10385
 10386     IF BDAYSL GREATER THAN ZEROS
 10387        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10388
 10389     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10390        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10391           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10392
 10393     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10394        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10395           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10396
 10397     IF B1STPMTL GREATER THAN ZEROS
 10398        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10399
 10400     IF PB-EXT-DAYS-PROCESSING
 10401        IF PB-I-EXTENTION-DAYS = ZEROS
 10402           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10403
 10404     IF PB-EXPIRE-DT-PROCESSING
 10405        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10406           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10407             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10408
 10409     IF PB-1ST-PMT-DT-PROCESSING
 10410        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10411           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10412
 10413     IF BREINL GREATER THAN ZEROS
 10414        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10415
 10416     IF BENTRYL NOT = ZEROS
 10417        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10418        IF PI-COMPANY-ID = 'CID'
 10419           AND (PB-BATCH-ENTRY = 'P')
 10420           AND (PB-STATE = 'VA')
 10421           PERFORM 1500-UPDATE-ERNOTE
 10422                                 THRU 1500-EXIT
 10423        END-IF
 10424     END-IF
 10425     IF BUNWRITL NOT = ZEROS
 10426        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10427
 10428     IF BFORCEL NOT = ZEROS
 10429        MOVE BFORCEI             TO PB-FORCE-CODE.
 10430
 10431     IF BBILCDL NOT = ZEROS
 10432        MOVE BBILCDI             TO PB-RECORD-BILL.
 10433
 10434     IF BLIVESL GREATER THAN ZEROS
 10435        MOVE WS-BLIVES           TO PB-I-LIVES
 10436     ELSE
 10437        MOVE ZEROS               TO PB-I-LIVES.
 10438
 10439     IF BBILLEDL GREATER THAN ZEROS
 10440        MOVE WS-BILLED           TO PB-I-NUM-BILLED
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 195
* EL6311.cbl
 10441     ELSE
 10442        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10443
 10444*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10445
 10446 1260-WRITE-PB-RECORD.
 10447     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10448                                    PB-INPUT-BY.
 10449     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10450     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10451                                    PB-INPUT-DT.
 10452
 10453     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10454     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10455                                    PB-CONTROL-BY-ORIG-BATCH.
 10456
 10457
 10458     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10459     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10460     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10461     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10462     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10463
 10464     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10465
 10466     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10467
 10468     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10469     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10470     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10471
 10472     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10473     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10474
 10475 1275-WRITE-PENDING-BUSINESS.
 10476     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10477     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10478     MOVE 'A'                    TO JP-RECORD-TYPE.
 10479     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10480
 10481
 10482* EXEC CICS HANDLE CONDITION
 10483*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10484*    END-EXEC.
 10485*    MOVE '"$%                   ! $ #00010300' TO DFHEIV0
 10486     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10487     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10488     MOVE X'2420233030303130333030' TO DFHEIV0(25:11)
 10489     CALL 'kxdfhei1' USING DFHEIV0
 10490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10491
 10492
 10493
 10494* EXEC CICS WRITE
 10495*        DATASET (FILE-ID-ERPNDB)
 10496*        FROM    (PENDING-BUSINESS)
 10497*        RIDFLD  (PB-CONTROL-PRIMARY)
 10498*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 196
* EL6311.cbl
 10499     MOVE LENGTH OF
 10500      PENDING-BUSINESS
 10501       TO DFHEIV11
 10502*    MOVE '&$ L                  ''   #00010304' TO DFHEIV0
 10503     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10504     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10505     MOVE X'2020233030303130333034' TO DFHEIV0(25:11)
 10506     CALL 'kxdfhei1' USING DFHEIV0,
 10507           FILE-ID-ERPNDB,
 10508           PENDING-BUSINESS,
 10509           DFHEIV11,
 10510           PB-CONTROL-PRIMARY,
 10511           DFHEIV99,
 10512           DFHEIV99
 10513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10514
 10515
 10516     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10517
 10518     PERFORM 8400-LOG-JOURNAL-RECORD.
 10519
 10520******************************************************************
 10521*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10522******************************************************************
 10523     display ' made it to add orig cert '
 10524     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10525     MOVE ' '                    TO WS-ERMAIL-SW
 10526
 10527* EXEC CICS READ
 10528*       DATASET   (FILE-ID-ERMAIL)
 10529*       SET       (ADDRESS OF MAILING-DATA)
 10530*       RIDFLD    (ERMAIL-KEY)
 10531*       RESP      (WS-RESPONSE)
 10532*    END-EXEC
 10533*    MOVE '&"S        E          (  N#00010320' TO DFHEIV0
 10534     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10535     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10536     MOVE X'204E233030303130333230' TO DFHEIV0(25:11)
 10537     CALL 'kxdfhei1' USING DFHEIV0,
 10538           FILE-ID-ERMAIL,
 10539           DFHEIV20,
 10540           DFHEIV99,
 10541           ERMAIL-KEY,
 10542           DFHEIV99,
 10543           DFHEIV99,
 10544           DFHEIV99
 10545     SET ADDRESS OF MAILING-DATA TO
 10546         DFHEIV20
 10547     MOVE EIBRESP  TO WS-RESPONSE
 10548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10549     IF RESP-NORMAL
 10550        SET ERMAIL-FOUND TO TRUE
 10551     END-IF
 10552
 10553     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10554     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10555     MOVE 'OC'                   TO OC-RECORD-ID
 10556     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 197
* EL6311.cbl
 10557                                 TO OC-CONTROL-PRIMARY (1:33)
 10558     MOVE 'I'                    TO OC-RECORD-TYPE
 10559     MOVE +4096                  TO OC-KEY-SEQ-NO
 10560     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10561     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10562     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10563     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10564     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10565     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10566     MOVE PB-I-AGE               TO OC-INS-AGE
 10567     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10568     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10569     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10570     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10571     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10572     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10573     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10574     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10575     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10576     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10577     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10578     IF PB-I-JOINT-COMMISSION > +0
 10579         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10580     ELSE
 10581         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10582     END-IF
 10583     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10584     MOVE +0                     TO OC-LF-CANCEL-AMT
 10585                                    OC-LF-ITD-CANCEL-AMT
 10586     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10587     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10588     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10589     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10590     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10591     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10592     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10593     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10594     MOVE +0                     TO OC-AH-CANCEL-AMT
 10595                                    OC-AH-ITD-CANCEL-AMT
 10596     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10597     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10598     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10599     IF ERMAIL-FOUND
 10600        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10601     END-IF
 10602     IF NOT CERT-TRL-REC-NOT-FOUND
 10603        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10604                           OC-INS-AGE-DEFAULT-FLAG
 10605        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10606                           OC-JNT-AGE-DEFAULT-FLAG
 10607     END-IF
 10608     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10609     .
 10610 1275-WRITE-ELCRTO.
 10611
 10612* EXEC CICS WRITE
 10613*       DATASET   ('ELCRTO')
 10614*       FROM      (ORIGINAL-CERTIFICATE)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 198
* EL6311.cbl
 10615*       RIDFLD    (OC-CONTROL-PRIMARY)
 10616*       RESP      (WS-RESPONSE)
 10617*    END-EXEC
 10618     MOVE LENGTH OF
 10619      ORIGINAL-CERTIFICATE
 10620       TO DFHEIV11
 10621     MOVE 'ELCRTO' TO DFHEIV1
 10622*    MOVE '&$ L                  ''  N#00010388' TO DFHEIV0
 10623     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10624     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10625     MOVE X'204E233030303130333838' TO DFHEIV0(25:11)
 10626     CALL 'kxdfhei1' USING DFHEIV0,
 10627           DFHEIV1,
 10628           ORIGINAL-CERTIFICATE,
 10629           DFHEIV11,
 10630           OC-CONTROL-PRIMARY,
 10631           DFHEIV99,
 10632           DFHEIV99
 10633     MOVE EIBRESP  TO WS-RESPONSE
 10634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10635     display ' just wrote 1275 ' ws-response
 10636     IF RESP-DUPKEY
 10637        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10638        GO TO 1275-WRITE-ELCRTO
 10639     ELSE
 10640        IF NOT RESP-NORMAL
 10641           MOVE -1               TO BMAINTL
 10642           MOVE ER-7450          TO EMI-ERROR
 10643           PERFORM 9900-ERROR-FORMAT
 10644                                 THRU 9900-EXIT
 10645           GO TO 8200-SEND-DATAONLY
 10646        END-IF
 10647     END-IF
 10648******************************************************************
 10649*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10650******************************************************************
 10651
 10652
 10653* EXEC CICS READ
 10654*        INTO    (PENDING-BUSINESS)
 10655*        DATASET (FILE-ID-ERPNDB)
 10656*        RIDFLD  (ERPNDB-KEY)
 10657*        UPDATE
 10658*    END-EXEC.
 10659     MOVE LENGTH OF
 10660      PENDING-BUSINESS
 10661       TO DFHEIV11
 10662*    MOVE '&"IL       EU         (   #00010411' TO DFHEIV0
 10663     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10664     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10665     MOVE X'2020233030303130343131' TO DFHEIV0(25:11)
 10666     CALL 'kxdfhei1' USING DFHEIV0,
 10667           FILE-ID-ERPNDB,
 10668           PENDING-BUSINESS,
 10669           DFHEIV11,
 10670           ERPNDB-KEY,
 10671           DFHEIV99,
 10672           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 199
* EL6311.cbl
 10673           DFHEIV99
 10674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10675
 10676
 10677     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10678     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10679     MOVE 'B'                    TO JP-RECORD-TYPE.
 10680     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10681
 10682     PERFORM 8400-LOG-JOURNAL-RECORD.
 10683
 10684     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10685
 10686
 10687* EXEC CICS REWRITE
 10688*        DATASET (FILE-ID-ERPNDB)
 10689*        FROM    (PENDING-BUSINESS)
 10690*    END-EXEC.
 10691     MOVE LENGTH OF
 10692      PENDING-BUSINESS
 10693       TO DFHEIV11
 10694*    MOVE '&& L                  %   #00010427' TO DFHEIV0
 10695     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10696     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10697     MOVE X'2020233030303130343237' TO DFHEIV0(25:11)
 10698     CALL 'kxdfhei1' USING DFHEIV0,
 10699           FILE-ID-ERPNDB,
 10700           PENDING-BUSINESS,
 10701           DFHEIV11,
 10702           DFHEIV99
 10703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10704
 10705
 10706     MOVE 'C'                    TO JP-RECORD-TYPE.
 10707     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10708
 10709     PERFORM 8400-LOG-JOURNAL-RECORD.
 10710
 10711     IF WS-ERRORS-PRESENT
 10712         GO TO 3900-RE-DISPLAY-RECORD.
 10713
 10714     MOVE ZEROS                  TO EMI-ERROR.
 10715     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10716     MOVE LOW-VALUES             TO EL631BI.
 10717     MOVE  -1                    TO BMAINTL.
 10718     GO TO 8100-SEND-INITIAL-MAP.
 10719
 10720 1280-BATCH-HDR-NOT-FOUND.
 10721     MOVE -1                     TO BMAINTL.
 10722     MOVE ER-7450                TO EMI-ERROR.
 10723     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10724     GO TO 8200-SEND-DATAONLY.
 10725
 10726 1290-DUPLICATE-ALT-INDEX.
 10727
 10728******************************************************************
 10729*                                                                *
 10730*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 200
* EL6311.cbl
 10731*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10732*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10733*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 10734*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10735*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10736*                                                                *
 10737******************************************************************
 10738
 10739     IF LCP-ONCTR-01 =  0
 10740         ADD 1 TO LCP-ONCTR-01
 10741        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10742
 10743     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10744
 10745     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10746         NEXT SENTENCE
 10747     ELSE
 10748         ADD +1 TO PB-BATCH-SEQ-NO
 10749                   PB-CSR-BATCH-SEQ-NO
 10750         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10751         GO TO 1275-WRITE-PENDING-BUSINESS.
 10752
 10753     MOVE -1                     TO BCERTNOL.
 10754     MOVE AL-UABON               TO BCERTNOA.
 10755     MOVE AL-UNBON               TO BEFFDTA.
 10756
 10757     MOVE 1                      TO EMI-SUB
 10758                                    EMI-SWITCH1
 10759                                    EMI-SWITCH-AREA-1
 10760                                    EMI-SWITCH-AREA-2.
 10761
 10762     MOVE SPACES                 TO EMI-ERROR-LINES.
 10763
 10764
 10765* EXEC CICS SYNCPOINT ROLLBACK
 10766*    END-EXEC.
 10767*    MOVE '6"R                   !   #00010490' TO DFHEIV0
 10768     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10769     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10770     MOVE X'2020233030303130343930' TO DFHEIV0(25:11)
 10771     CALL 'kxdfhei1' USING DFHEIV0
 10772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10773
 10774
 10775     MOVE ER-2247                TO EMI-ERROR.
 10776     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10777     GO TO 8200-SEND-DATAONLY.
 10778
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 201
* EL6311.cbl
 10780
 10781
 10782 1295-READ-CERT-TRAILER.
 10783
 10784
 10785* EXEC CICS GETMAIN
 10786*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 10787*        LENGTH  (ELCRTT-RECORD-LENGTH)
 10788*        INITIMG (GETMAIN-SPACE)
 10789*    END-EXEC
 10790*    MOVE ',"IL                  $   #00010502' TO DFHEIV0
 10791     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10792     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10793     MOVE X'2020233030303130353032' TO DFHEIV0(25:11)
 10794     CALL 'kxdfhei1' USING DFHEIV0,
 10795           DFHEIV20,
 10796           ELCRTT-RECORD-LENGTH,
 10797           GETMAIN-SPACE
 10798     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 10799         DFHEIV20
 10800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10801
 10802     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 10803     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 10804     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 10805
 10806
 10807* EXEC CICS HANDLE CONDITION
 10808*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 10809*    END-EXEC.
 10810*    MOVE '"$I                   ! % #00010512' TO DFHEIV0
 10811     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10812     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10813     MOVE X'2520233030303130353132' TO DFHEIV0(25:11)
 10814     CALL 'kxdfhei1' USING DFHEIV0
 10815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10816
 10817
 10818
 10819* EXEC CICS READ
 10820*        DATASET  (CRTT-ID)
 10821*        RIDFLD   (ELCRTT-KEY)
 10822*        INTO     (CERTIFICATE-TRAILERS)
 10823*    END-EXEC.
 10824     MOVE LENGTH OF
 10825      CERTIFICATE-TRAILERS
 10826       TO DFHEIV11
 10827*    MOVE '&"IL       E          (   #00010516' TO DFHEIV0
 10828     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10829     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10830     MOVE X'2020233030303130353136' TO DFHEIV0(25:11)
 10831     CALL 'kxdfhei1' USING DFHEIV0,
 10832           CRTT-ID,
 10833           CERTIFICATE-TRAILERS,
 10834           DFHEIV11,
 10835           ELCRTT-KEY,
 10836           DFHEIV99,
 10837           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 202
* EL6311.cbl
 10838           DFHEIV99
 10839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10840
 10841
 10842     GO TO 1295-EXIT.
 10843
 10844 1295-CERT-TRL-REC-NOTFND.
 10845     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 10846
 10847 1295-EXIT.
 10848     EXIT.
 10849
 10850******************************************************************
 10851*                                                                *
 10852*          C H A N G E   I S S U E   R O U T I N E               *
 10853*                                                                *
 10854******************************************************************
 10855
 10856***************************************************************
 10857*                                                             *
 10858*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 10859*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10860*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 10861*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 10862*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 10863*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 10864*     5. LINK TO THE EDIT ROUTINE.                            *
 10865*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10866*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 10867*              THE EDIT ROUTINE.                              *
 10868*     7. REWRITE THE NEW ISSUE                                *
 10869*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10870*                                                             *
 10871***************************************************************
 10872
 10873 1300-CHANGE-ISSUE-ROUTINE.
 10874     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 10875
 10876     IF BCHGL NOT = ZEROS
 10877        MOVE ER-2196             TO EMI-ERROR
 10878        MOVE AL-UABON            TO BMAINTA
 10879        MOVE -1                  TO BMAINTL
 10880        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10881        GO TO 8200-SEND-DATAONLY.
 10882
 10883     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10884
 10885     IF BSUFIXL NOT = ZEROS
 10886        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10887     ELSE
 10888        MOVE SPACE               TO WS-NEW-SUFFIX.
 10889
 10890     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10891     PERFORM 8600-DEEDIT.
 10892     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10893     MOVE '4'                    TO DC-OPTION-CODE.
 10894     PERFORM 9700-DATE-LINK.
 10895     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 203
* EL6311.cbl
 10896        MOVE ER-0348             TO EMI-ERROR
 10897        MOVE -1                  TO BEFFDTL
 10898        MOVE AL-UABON            TO BEFFDTA
 10899        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10900        GO TO 8200-SEND-DATAONLY
 10901     ELSE
 10902        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10903        MOVE AL-UANON            TO BEFFDTA
 10904        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10905
 10906 1325-PROCESS-ISSUE-CHANGES.
 10907
 10908* EXEC CICS HANDLE CONDITION
 10909*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 10910*    END-EXEC.
 10911*    MOVE '"$I                   ! & #00010587' TO DFHEIV0
 10912     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10913     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10914     MOVE X'2620233030303130353837' TO DFHEIV0(25:11)
 10915     CALL 'kxdfhei1' USING DFHEIV0
 10916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10917
 10918
 10919     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 10920     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 10921     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 10922
 10923
 10924* EXEC CICS GETMAIN
 10925*        SET      (ADDRESS OF PENDING-BUSINESS)
 10926*        LENGTH   (ERPNDB-RECORD-LENGTH)
 10927*        INITIMG  (GETMAIN-SPACE)
 10928*     END-EXEC.
 10929*    MOVE ',"IL                  $   #00010595' TO DFHEIV0
 10930     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10931     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10932     MOVE X'2020233030303130353935' TO DFHEIV0(25:11)
 10933     CALL 'kxdfhei1' USING DFHEIV0,
 10934           DFHEIV20,
 10935           ERPNDB-RECORD-LENGTH,
 10936           GETMAIN-SPACE
 10937     SET ADDRESS OF PENDING-BUSINESS TO
 10938         DFHEIV20
 10939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10940
 10941
 10942
 10943* EXEC CICS READ
 10944*        INTO    (PENDING-BUSINESS)
 10945*        DATASET (FILE-ID-ERPNDB)
 10946*        RIDFLD  (ERPNDB-KEY)
 10947*    END-EXEC.
 10948     MOVE LENGTH OF
 10949      PENDING-BUSINESS
 10950       TO DFHEIV11
 10951*    MOVE '&"IL       E          (   #00010601' TO DFHEIV0
 10952     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10953     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 204
* EL6311.cbl
 10954     MOVE X'2020233030303130363031' TO DFHEIV0(25:11)
 10955     CALL 'kxdfhei1' USING DFHEIV0,
 10956           FILE-ID-ERPNDB,
 10957           PENDING-BUSINESS,
 10958           DFHEIV11,
 10959           ERPNDB-KEY,
 10960           DFHEIV99,
 10961           DFHEIV99,
 10962           DFHEIV99
 10963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10964
 10965
 10966     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10967
 10968
 10969* EXEC CICS HANDLE CONDITION
 10970*         NOTFND     (1385-REC-NOT-FOUND)
 10971*    END-EXEC.
 10972*    MOVE '"$I                   ! '' #00010609' TO DFHEIV0
 10973     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10974     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10975     MOVE X'2720233030303130363039' TO DFHEIV0(25:11)
 10976     CALL 'kxdfhei1' USING DFHEIV0
 10977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10978
 10979
 10980**********************************************************
 10981*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 10982*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 10983**********************************************************
 10984
 10985
 10986* EXEC CICS READ
 10987*        DATASET (FILE-ID-ERPNDB)
 10988*        INTO    (PENDING-BUSINESS)
 10989*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 10990*    END-EXEC.
 10991     MOVE LENGTH OF
 10992      PENDING-BUSINESS
 10993       TO DFHEIV11
 10994*    MOVE '&"IL       E          (   #00010618' TO DFHEIV0
 10995     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10996     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10997     MOVE X'2020233030303130363138' TO DFHEIV0(25:11)
 10998     CALL 'kxdfhei1' USING DFHEIV0,
 10999           FILE-ID-ERPNDB,
 11000           PENDING-BUSINESS,
 11001           DFHEIV11,
 11002           PI-PREV-CONTROL-PRIMARY,
 11003           DFHEIV99,
 11004           DFHEIV99,
 11005           DFHEIV99
 11006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11007
 11008
 11009********** DO NOT ALLOW CHANGES IF THRU A/R
 11010     IF BMAINTI = 'C'
 11011         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 205
* EL6311.cbl
 11012             MOVE ER-4005          TO EMI-ERROR
 11013             MOVE -1               TO BMAINTL
 11014             MOVE AL-UABON         TO BMAINTA
 11015             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11016             GO TO 8200-SEND-DATAONLY.
 11017**********
 11018
 11019     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11020        MOVE -1                 TO BMAINTL
 11021        MOVE ER-2197            TO EMI-ERROR
 11022        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11023        GO TO 8200-SEND-DATAONLY.
 11024
 11025     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11026        MOVE ER-2196             TO EMI-ERROR
 11027        MOVE AL-UABON            TO BMAINTA
 11028        MOVE -1                  TO BMAINTL
 11029        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11030        GO TO 8200-SEND-DATAONLY.
 11031
 11032     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11033
 11034     IF PB-BILLED-DT = LOW-VALUES AND
 11035        PB-CHG-COUNT = ZEROS
 11036        NEXT SENTENCE
 11037     ELSE
 11038        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11039            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11040           OR
 11041           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11042            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11043           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11044
 11045
 11046* EXEC CICS READ
 11047*        DATASET (FILE-ID-ERPNDB)
 11048*        INTO    (PENDING-BUSINESS)
 11049*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11050*        UPDATE
 11051*    END-EXEC.
 11052     MOVE LENGTH OF
 11053      PENDING-BUSINESS
 11054       TO DFHEIV11
 11055*    MOVE '&"IL       EU         (   #00010660' TO DFHEIV0
 11056     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11057     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11058     MOVE X'2020233030303130363630' TO DFHEIV0(25:11)
 11059     CALL 'kxdfhei1' USING DFHEIV0,
 11060           FILE-ID-ERPNDB,
 11061           PENDING-BUSINESS,
 11062           DFHEIV11,
 11063           PI-PREV-CONTROL-PRIMARY,
 11064           DFHEIV99,
 11065           DFHEIV99,
 11066           DFHEIV99
 11067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11068
 11069
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 206
* EL6311.cbl
 11070     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11071     MOVE 'B'                    TO JP-RECORD-TYPE
 11072     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11073     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11074
 11075     PERFORM 8400-LOG-JOURNAL-RECORD.
 11076
 11077     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11078        PB-CHG-COUNT NOT = ZEROS
 11079        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11080            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11081           OR
 11082           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11083            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11084            MOVE LOW-VALUES             TO PB-BILLED-DT
 11085            ADD +1                      TO PB-CHG-COUNT.
 11086
 11087     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11088     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11089     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11090     MOVE '5'                    TO DC-OPTION-CODE.
 11091     PERFORM 9700-DATE-LINK
 11092     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11093
 11094*    IF BMICRNOL  GREATER  ZEROS
 11095*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11096
 11097     IF BVINL > ZEROS
 11098        MOVE BVINI               TO PB-I-VIN
 11099     END-IF
 11100     IF (BFORCEL NOT = ZEROS)
 11101        AND (PB-COMPANY-ID = 'DCC')
 11102        AND (BFORCEI = ' ')
 11103        AND (PB-FORCE-CODE = 'O')
 11104        COMPUTE PB-I-AH-PREMIUM-AMT =
 11105           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11106        PERFORM 1800-REMOVE-CERT-NOTES
 11107                                 THRU 1800-EXIT
 11108        PERFORM 1900-DELETE-ERPYAJ
 11109                                 THRU 1900-EXIT
 11110        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11111     END-IF
 11112     IF (BFORCEL NOT = ZEROS)
 11113        AND (PB-COMPANY-ID = 'DCC')
 11114        AND (BFORCEI = 'O')
 11115        AND (PB-FORCE-CODE NOT = 'O')
 11116        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11117           PB-I-AH-PREM-CALC
 11118        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11119        MOVE SPACE               TO DC-OPTION-CODE
 11120        PERFORM 9700-DATE-LINK
 11121        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11122        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11123        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11124        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11125        PERFORM 1500-UPDATE-ERNOTE
 11126                                 THRU 1500-EXIT
 11127        PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 207
* EL6311.cbl
 11128                                 THRU 1600-EXIT
 11129     END-IF
 11130     IF BLSTNML  GREATER THAN ZEROS
 11131         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11132
 11133     IF B1STNML  GREATER THAN ZEROS
 11134         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11135
 11136     IF BINITL   GREATER THAN ZEROS
 11137         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11138
 11139     IF BBIRTHL  GREATER THAN ZERO
 11140         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11141
 11142     IF B1STPMTL GREATER THAN ZERO
 11143         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11144
 11145     IF BAGEL    GREATER THAN ZEROS
 11146         MOVE BAGEI              TO PB-I-AGE.
 11147
 11148     MOVE 'N'                    TO WS-INS-AGE-SET
 11149                                    WS-JNT-AGE-SET.
 11150     IF BAGEL    GREATER THAN ZEROS
 11151        MOVE 'Y'                TO WS-INS-AGE-SET
 11152        IF BAGEI = ZERO AND
 11153             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11154           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11155           MOVE 'AGE*'          TO BAGEDEFO
 11156        ELSE
 11157           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11158           MOVE 'AGE '          TO BAGEDEFO
 11159        END-IF
 11160        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11161     END-IF.
 11162
 11163     IF BSEXL    GREATER THAN ZEROS
 11164         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11165
 11166     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11167        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11168
 11169     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11170        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11171
 11172     IF BLNTRML  GREATER THAN ZEROS
 11173         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11174
 11175     IF BFREQL   GREATER THAN ZEROS
 11176         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11177
 11178     IF BSKPCDL  GREATER THAN ZEROS
 11179         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11180
 11181     IF BMODEL   GREATER THAN ZEROS
 11182         MOVE BMODEI             TO PB-I-TERM-TYPE
 11183                                    PI-BMODE.
 11184
 11185     IF BPMTSL   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 208
* EL6311.cbl
 11186         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11187                                    PI-BPMTS.
 11188
 11189     IF BPMTAMTL GREATER THAN ZEROS
 11190         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11191
 11192     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11193         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11194
 11195     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11196         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11197
 11198     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11199
 11200     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11201         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11202            SUBTRACT PB-I-LF-PREMIUM-AMT
 11203                     FROM WS-B-LF-ISS-PRM-ENTERED
 11204            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11205            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11206            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11207         ELSE
 11208            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11209            MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11210
 11211     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11212            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11213                     FROM WS-B-LF-ISS-PRM-ENTERED
 11214         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11215         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11216
 11217     IF  BALT-PREM-LEN     (2)  > ZEROS
 11218         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11219
 11220     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11221         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11222
 11223     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11224         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11225            SUBTRACT PB-I-AH-PREMIUM-AMT
 11226                     FROM WS-B-AH-ISS-PRM-ENTERED
 11227            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11228            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11229            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11230         ELSE
 11231            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11232            MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11233
 11234     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11235        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11236
 11237     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11238        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11239
 11240     IF BINDGRPL            GREATER THAN ZEROS
 11241         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11242
 11243     IF BRTCLSL             GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 209
* EL6311.cbl
 11244         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11245
 11246     IF BSIGL               GREATER THAN ZEROS
 11247         MOVE BSIGI              TO PB-I-SIG-SW.
 11248
 11249     IF BAPRL               GREATER THAN ZEROS
 11250         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11251
 11252     IF BMEMBERL            GREATER THAN ZEROS
 11253         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11254
 11255     IF BLNOFCRL            GREATER THAN ZEROS
 11256         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11257
 11258     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11259        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11260
 11261     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11262        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11263
 11264     IF BDAYSL              GREATER THAN ZEROS
 11265        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11266                                    PB-I-EXTENTION-DAYS.
 11267
 11268     IF BDAYSL GREATER THAN ZEROS
 11269        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11270
 11271     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11272        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11273           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11274
 11275     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11276        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11277           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11278
 11279     IF B1STPMTL GREATER THAN ZEROS
 11280        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11281
 11282     IF PB-EXT-DAYS-PROCESSING
 11283        IF PB-I-EXTENTION-DAYS = ZEROS
 11284           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11285
 11286     IF PB-EXPIRE-DT-PROCESSING
 11287        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11288           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11289             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11290
 11291     IF PB-1ST-PMT-DT-PROCESSING
 11292        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11293           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11294
 11295     IF BREINL GREATER THAN ZEROS
 11296        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11297
 11298     IF BFORCEL NOT = ZEROS
 11299        MOVE BFORCEI             TO PB-FORCE-CODE.
 11300     IF (BENTRYL NOT = ZEROS)
 11301        AND (PB-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 210
* EL6311.cbl
 11302        AND (PB-STATE = 'VA')
 11303        AND (BENTRYI NOT = 'P')
 11304        AND (PB-BATCH-ENTRY = 'P')
 11305        PERFORM 1800-REMOVE-CERT-NOTES
 11306                                 THRU 1800-EXIT
 11307     END-IF
 11308     IF BENTRYL NOT = ZEROS
 11309        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11310        IF PI-COMPANY-ID = 'CID'
 11311           AND (PB-BATCH-ENTRY = 'P')
 11312           AND (PB-STATE = 'VA')
 11313           PERFORM 1500-UPDATE-ERNOTE
 11314                                 THRU 1500-EXIT
 11315        END-IF
 11316     END-IF
 11317
 11318     IF BUNWRITL NOT = ZEROS
 11319        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11320
 11321     IF BBILCDL NOT = ZEROS
 11322        MOVE BBILCDI             TO PB-RECORD-BILL.
 11323
 11324     IF BLIVESL GREATER THAN ZEROS
 11325        MOVE WS-BLIVES           TO PB-I-LIVES.
 11326
 11327
 11328*DMD CUSTOM CODING*************START
 11329     IF PI-COMPANY-ID NOT = 'DMD'
 11330         MOVE ZEROS               TO BBILLEDL.
 11331*DMD CUSTOM CODING*************END
 11332
 11333     IF BBILLEDL GREATER THAN ZEROS
 11334        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11335
 11336
 11337*****************************************************************
 11338*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11339*****************************************************************
 11340
 11341     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11342        IF BTYPE  (1)   = ZEROS OR SPACES
 11343           IF REMOVE-LF-COVERAGE
 11344               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11345                                        PI-BTYPE (1)
 11346               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11347                                        WS-B-LF-ISS-PRM-ENTERED
 11348               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11349                                        WS-B-LF-ISS-PRM-ENTERED
 11350               SUBTRACT PB-I-LF-PREM-CALC FROM
 11351                                        WS-B-LF-ISS-PRM-COMPUTED
 11352               MOVE ZEROS            TO PB-I-LF-TERM
 11353                                        PB-I-LF-BENEFIT-AMT
 11354                                        PB-I-LF-PREMIUM-AMT
 11355                                        PB-I-LF-BENEFIT-CD
 11356                                        PB-I-LF-PREM-CALC
 11357                                        PB-I-LF-CRIT-PER
 11358                                        PB-I-LF-ALT-BENEFIT-AMT
 11359                                        PB-I-LF-ALT-PREMIUM-AMT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 211
* EL6311.cbl
 11360               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11361           ELSE
 11362               NEXT SENTENCE
 11363        ELSE
 11364           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11365                                    PI-BTYPE (1).
 11366     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11367        IF BTYPE  (2)   = ZEROS OR SPACES
 11368           IF  REMOVE-AH-COVERAGE
 11369               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11370                                        PI-BTYPE (2)
 11371               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11372                                        WS-B-AH-ISS-PRM-ENTERED
 11373               SUBTRACT PB-I-AH-PREM-CALC FROM
 11374                                        WS-B-AH-ISS-PRM-COMPUTED
 11375               MOVE ZEROS            TO PB-I-AH-TERM
 11376                                        PB-I-AH-BENEFIT-AMT
 11377                                        PB-I-AH-PREMIUM-AMT
 11378                                        PB-I-AH-BENEFIT-CD
 11379                                        PB-I-AH-PREM-CALC
 11380                                        PB-I-AH-CRIT-PER
 11381               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11382           ELSE
 11383               NEXT SENTENCE
 11384        ELSE
 11385           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11386                                    PI-BTYPE (2).
 11387 1360-REWRITE-PB-RECORD.
 11388     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11389
 11390     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11391     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11392
 11393     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11394
 11395     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11396     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11397
 11398     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11399         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11400
 11401     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11402         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11403
 11404     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11405
 11406     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11407
 11408     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11409
 11410     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11411     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11412     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11413
 11414     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11415     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11416
 11417 1375-REWRITE-PB-RECORD.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 212
* EL6311.cbl
 11418     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11419     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11420     MOVE 'C'                    TO JP-RECORD-TYPE.
 11421     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11422
 11423
 11424* EXEC CICS REWRITE
 11425*        DATASET (FILE-ID-ERPNDB)
 11426*        FROM    (PENDING-BUSINESS)
 11427*    END-EXEC.
 11428     MOVE LENGTH OF
 11429      PENDING-BUSINESS
 11430       TO DFHEIV11
 11431*    MOVE '&& L                  %   #00011020' TO DFHEIV0
 11432     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11433     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11434     MOVE X'2020233030303131303230' TO DFHEIV0(25:11)
 11435     CALL 'kxdfhei1' USING DFHEIV0,
 11436           FILE-ID-ERPNDB,
 11437           PENDING-BUSINESS,
 11438           DFHEIV11,
 11439           DFHEIV99
 11440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11441
 11442
 11443     PERFORM 8400-LOG-JOURNAL-RECORD.
 11444******************************************************************
 11445*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11446******************************************************************
 11447     display ' made it to update orig cert '
 11448     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11449     MOVE ' '                    TO WS-ERMAIL-SW
 11450
 11451* EXEC CICS READ
 11452*       DATASET   (FILE-ID-ERMAIL)
 11453*       SET       (ADDRESS OF MAILING-DATA)
 11454*       RIDFLD    (ERMAIL-KEY)
 11455*       RESP      (WS-RESPONSE)
 11456*    END-EXEC
 11457*    MOVE '&"S        E          (  N#00011032' TO DFHEIV0
 11458     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11459     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11460     MOVE X'204E233030303131303332' TO DFHEIV0(25:11)
 11461     CALL 'kxdfhei1' USING DFHEIV0,
 11462           FILE-ID-ERMAIL,
 11463           DFHEIV20,
 11464           DFHEIV99,
 11465           ERMAIL-KEY,
 11466           DFHEIV99,
 11467           DFHEIV99,
 11468           DFHEIV99
 11469     SET ADDRESS OF MAILING-DATA TO
 11470         DFHEIV20
 11471     MOVE EIBRESP  TO WS-RESPONSE
 11472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11473     IF RESP-NORMAL
 11474        SET ERMAIL-FOUND TO TRUE
 11475     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 213
* EL6311.cbl
 11476
 11477     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11478     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11479                                 TO ELCRTO-KEY
 11480     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11481     MOVE +0                     TO ELCRTO-SEQ-NO
 11482
 11483* EXEC CICS READ
 11484*       DATASET   ('ELCRTO')
 11485*       INTO      (ORIGINAL-CERTIFICATE)
 11486*       RIDFLD    (ELCRTO-KEY)
 11487*       GTEQ
 11488*       RESP      (WS-RESPONSE)
 11489*    END-EXEC
 11490     MOVE LENGTH OF
 11491      ORIGINAL-CERTIFICATE
 11492       TO DFHEIV11
 11493     MOVE 'ELCRTO' TO DFHEIV1
 11494*    MOVE '&"IL       G          (  N#00011047' TO DFHEIV0
 11495     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11496     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11497     MOVE X'204E233030303131303437' TO DFHEIV0(25:11)
 11498     CALL 'kxdfhei1' USING DFHEIV0,
 11499           DFHEIV1,
 11500           ORIGINAL-CERTIFICATE,
 11501           DFHEIV11,
 11502           ELCRTO-KEY,
 11503           DFHEIV99,
 11504           DFHEIV99,
 11505           DFHEIV99
 11506     MOVE EIBRESP  TO WS-RESPONSE
 11507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11508     display ' just read gteq ' ws-response
 11509     IF RESP-NORMAL
 11510        AND (OC-CONTROL-PRIMARY (1:33) =
 11511                 PB-CONTROL-BY-ACCOUNT (1:33))
 11512        AND (OC-RECORD-TYPE = 'I')
 11513        display ' resp norm, key =, type i '
 11514        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11515           display ' end proc blank '
 11516           display ' csr edit session ' PI-CSR-SESSION-SW
 11517           IF NOT CSR-EDIT-SESSION
 11518
 11519* EXEC CICS READ
 11520*                DATASET   ('ELCRTO')
 11521*                INTO      (ORIGINAL-CERTIFICATE)
 11522*                RIDFLD    (OC-CONTROL-PRIMARY)
 11523*                UPDATE
 11524*                RESP      (WS-RESPONSE)
 11525*             END-EXEC
 11526     MOVE LENGTH OF
 11527      ORIGINAL-CERTIFICATE
 11528       TO DFHEIV11
 11529     MOVE 'ELCRTO' TO DFHEIV1
 11530*    MOVE '&"IL       EU         (  N#00011064' TO DFHEIV0
 11531     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11532     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11533     MOVE X'204E233030303131303634' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 214
* EL6311.cbl
 11534     CALL 'kxdfhei1' USING DFHEIV0,
 11535           DFHEIV1,
 11536           ORIGINAL-CERTIFICATE,
 11537           DFHEIV11,
 11538           OC-CONTROL-PRIMARY,
 11539           DFHEIV99,
 11540           DFHEIV99,
 11541           DFHEIV99
 11542     MOVE EIBRESP  TO WS-RESPONSE
 11543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11544              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11545              IF RESP-NORMAL
 11546                 display ' good read upd '
 11547                 MOVE PB-I-INSURED-LAST-NAME TO
 11548                         OC-INS-LAST-NAME
 11549                 MOVE PB-I-INSURED-FIRST-NAME TO
 11550                         OC-INS-FIRST-NAME
 11551                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11552                         OC-INS-MIDDLE-INIT
 11553                 MOVE PB-I-AGE         TO OC-INS-AGE
 11554                 MOVE PB-I-JOINT-LAST-NAME   TO
 11555                         OC-JNT-LAST-NAME
 11556                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11557                         OC-JNT-FIRST-NAME
 11558                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11559                         OC-JNT-MIDDLE-INIT
 11560                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11561                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11562                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11563                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11564                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11565                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11566                         OC-LF-ALT-BEN-AMT
 11567                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11568                         OC-LF-ALT-PRM-AMT
 11569                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11570                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11571                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11572                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11573                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11574                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11575                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11576                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11577                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11578                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11579                 IF OC-CANCEL-TRAN-IND = 'N'
 11580                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11581                    MOVE +0            TO OC-LF-CANCEL-AMT
 11582                                          OC-LF-ITD-CANCEL-AMT
 11583                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11584                    MOVE +0            TO OC-AH-CANCEL-AMT
 11585                                          OC-AH-ITD-CANCEL-AMT
 11586                 END-IF
 11587                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11588                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11589                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11590                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11591                 IF ERMAIL-FOUND
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 215
* EL6311.cbl
 11592                    MOVE MA-CRED-BENE-NAME
 11593                                 TO OC-CRED-BENE-NAME
 11594                 END-IF
 11595                 IF NOT CERT-TRL-REC-NOT-FOUND
 11596                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11597                           OC-INS-AGE-DEFAULT-FLAG
 11598                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11599                           OC-JNT-AGE-DEFAULT-FLAG
 11600                 END-IF
 11601
 11602* EXEC CICS REWRITE
 11603*                   DATASET   ('ELCRTO')
 11604*                   FROM      (ORIGINAL-CERTIFICATE)
 11605*                   RESP      (WS-RESPONSE)
 11606*                END-EXEC
 11607     MOVE LENGTH OF
 11608      ORIGINAL-CERTIFICATE
 11609       TO DFHEIV11
 11610     MOVE 'ELCRTO' TO DFHEIV1
 11611*    MOVE '&& L                  %  N#00011128' TO DFHEIV0
 11612     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11613     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11614     MOVE X'204E233030303131313238' TO DFHEIV0(25:11)
 11615     CALL 'kxdfhei1' USING DFHEIV0,
 11616           DFHEIV1,
 11617           ORIGINAL-CERTIFICATE,
 11618           DFHEIV11,
 11619           DFHEIV99
 11620     MOVE EIBRESP  TO WS-RESPONSE
 11621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11622                 display ' just rewrote ' ws-response
 11623              END-IF
 11624           END-IF
 11625        ELSE
 11626           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11627           MOVE 'OC'             TO OC-RECORD-ID
 11628           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11629           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11630           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11631           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11632           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11633           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11634           MOVE PB-I-AGE         TO OC-INS-AGE
 11635           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11636           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11637           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11638           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11639           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11640           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11641           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11642           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11643           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11644           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11645           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11646           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11647           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11648           MOVE +0               TO OC-LF-CANCEL-AMT
 11649                                    OC-LF-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 216
* EL6311.cbl
 11650           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11651           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11652           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11653           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11654           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11655           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11656           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11657           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11658           MOVE +0               TO OC-AH-CANCEL-AMT
 11659                                    OC-AH-ITD-CANCEL-AMT
 11660           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11661           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11662           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11663           IF ERMAIL-FOUND
 11664              MOVE MA-CRED-BENE-NAME
 11665                                 TO OC-CRED-BENE-NAME
 11666           END-IF
 11667           IF NOT CERT-TRL-REC-NOT-FOUND
 11668              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11669                           OC-INS-AGE-DEFAULT-FLAG
 11670              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11671                           OC-JNT-AGE-DEFAULT-FLAG
 11672           END-IF
 11673           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11674
 11675* EXEC CICS WRITE
 11676*             DATASET   ('ELCRTO')
 11677*             FROM      (ORIGINAL-CERTIFICATE)
 11678*             RIDFLD    (OC-CONTROL-PRIMARY)
 11679*             RESP      (WS-RESPONSE)
 11680*          END-EXEC
 11681     MOVE LENGTH OF
 11682      ORIGINAL-CERTIFICATE
 11683       TO DFHEIV11
 11684     MOVE 'ELCRTO' TO DFHEIV1
 11685*    MOVE '&$ L                  ''  N#00011185' TO DFHEIV0
 11686     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11687     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11688     MOVE X'204E233030303131313835' TO DFHEIV0(25:11)
 11689     CALL 'kxdfhei1' USING DFHEIV0,
 11690           DFHEIV1,
 11691           ORIGINAL-CERTIFICATE,
 11692           DFHEIV11,
 11693           OC-CONTROL-PRIMARY,
 11694           DFHEIV99,
 11695           DFHEIV99
 11696     MOVE EIBRESP  TO WS-RESPONSE
 11697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11698        END-IF
 11699     ELSE
 11700        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11701        MOVE 'OC'                TO OC-RECORD-ID
 11702        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11703                                 TO OC-CONTROL-PRIMARY (1:33)
 11704        MOVE 'I'                 TO OC-RECORD-TYPE
 11705        MOVE +4096               TO OC-KEY-SEQ-NO
 11706        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11707        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 217
* EL6311.cbl
 11708        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11709        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11710        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11711        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11712        MOVE PB-I-AGE            TO OC-INS-AGE
 11713        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11714        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11715        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11716        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11717        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11718        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11719        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11720        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11721        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11722        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11723        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11724        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11725        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11726        MOVE +0                  TO OC-LF-CANCEL-AMT
 11727                                    OC-LF-ITD-CANCEL-AMT
 11728        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11729        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11730        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11731        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11732        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11733        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11734        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11735        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11736        MOVE +0                  TO OC-AH-CANCEL-AMT
 11737                                    OC-AH-ITD-CANCEL-AMT
 11738        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11739        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 11740        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 11741        IF ERMAIL-FOUND
 11742           MOVE MA-CRED-BENE-NAME
 11743                                 TO OC-CRED-BENE-NAME
 11744        END-IF
 11745        IF NOT CERT-TRL-REC-NOT-FOUND
 11746           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11747                           OC-INS-AGE-DEFAULT-FLAG
 11748           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11749                           OC-JNT-AGE-DEFAULT-FLAG
 11750        END-IF
 11751        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11752
 11753* EXEC CICS WRITE
 11754*          DATASET   ('ELCRTO')
 11755*          FROM      (ORIGINAL-CERTIFICATE)
 11756*          RIDFLD    (OC-CONTROL-PRIMARY)
 11757*          RESP      (WS-RESPONSE)
 11758*       END-EXEC
 11759     MOVE LENGTH OF
 11760      ORIGINAL-CERTIFICATE
 11761       TO DFHEIV11
 11762     MOVE 'ELCRTO' TO DFHEIV1
 11763*    MOVE '&$ L                  ''  N#00011245' TO DFHEIV0
 11764     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11765     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 218
* EL6311.cbl
 11766     MOVE X'204E233030303131323435' TO DFHEIV0(25:11)
 11767     CALL 'kxdfhei1' USING DFHEIV0,
 11768           DFHEIV1,
 11769           ORIGINAL-CERTIFICATE,
 11770           DFHEIV11,
 11771           OC-CONTROL-PRIMARY,
 11772           DFHEIV99,
 11773           DFHEIV99
 11774     MOVE EIBRESP  TO WS-RESPONSE
 11775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11776     END-IF
 11777******************************************************************
 11778*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11779******************************************************************
 11780
 11781     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11782     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11783
 11784
 11785* EXEC CICS READ
 11786*        INTO    (PENDING-BUSINESS)
 11787*        DATASET (FILE-ID-ERPNDB)
 11788*        RIDFLD  (ERPNDB-KEY)
 11789*        UPDATE
 11790*    END-EXEC.
 11791     MOVE LENGTH OF
 11792      PENDING-BUSINESS
 11793       TO DFHEIV11
 11794*    MOVE '&"IL       EU         (   #00011259' TO DFHEIV0
 11795     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11796     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11797     MOVE X'2020233030303131323539' TO DFHEIV0(25:11)
 11798     CALL 'kxdfhei1' USING DFHEIV0,
 11799           FILE-ID-ERPNDB,
 11800           PENDING-BUSINESS,
 11801           DFHEIV11,
 11802           ERPNDB-KEY,
 11803           DFHEIV99,
 11804           DFHEIV99,
 11805           DFHEIV99
 11806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11807
 11808
 11809     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 11810     MOVE 'B'                    TO JP-RECORD-TYPE.
 11811     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11812
 11813     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11814
 11815     PERFORM 8400-LOG-JOURNAL-RECORD.
 11816
 11817     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 11818
 11819     MOVE 'C'                    TO JP-RECORD-TYPE.
 11820     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11821
 11822
 11823* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 219
* EL6311.cbl
 11824*        DATASET    (FILE-ID-ERPNDB)
 11825*        FROM       (PENDING-BUSINESS)
 11826*    END-EXEC.
 11827     MOVE LENGTH OF
 11828      PENDING-BUSINESS
 11829       TO DFHEIV11
 11830*    MOVE '&& L                  %   #00011279' TO DFHEIV0
 11831     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11832     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11833     MOVE X'2020233030303131323739' TO DFHEIV0(25:11)
 11834     CALL 'kxdfhei1' USING DFHEIV0,
 11835           FILE-ID-ERPNDB,
 11836           PENDING-BUSINESS,
 11837           DFHEIV11,
 11838           DFHEIV99
 11839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11840
 11841
 11842     PERFORM 8400-LOG-JOURNAL-RECORD.
 11843
 11844     IF WS-ERRORS-PRESENT
 11845        GO TO 3900-RE-DISPLAY-RECORD.
 11846
 11847     MOVE ZEROS                  TO EMI-ERROR.
 11848     MOVE -1                     TO BMAINTL.
 11849     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11850     GO TO 3900-RE-DISPLAY-RECORD.
 11851
 11852 1380-BATCH-HDR-NOT-FOUND.
 11853     MOVE -1                     TO BMAINTL.
 11854     MOVE ER-7450                TO EMI-ERROR.
 11855     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11856     GO TO 8200-SEND-DATAONLY.
 11857
 11858 1385-REC-NOT-FOUND.
 11859     MOVE -1                     TO BMAINTL.
 11860     MOVE ER-7451                TO EMI-ERROR.
 11861     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11862     GO TO 8200-SEND-DATAONLY.
 11863
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 220
* EL6311.cbl
 11865
 11866 1386-UPDATE-AGE-FLAGS.
 11867
 11868
 11869* EXEC CICS GETMAIN
 11870*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11871*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11872*        INITIMG (GETMAIN-SPACE)
 11873*    END-EXEC
 11874*    MOVE ',"IL                  $   #00011310' TO DFHEIV0
 11875     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11876     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11877     MOVE X'2020233030303131333130' TO DFHEIV0(25:11)
 11878     CALL 'kxdfhei1' USING DFHEIV0,
 11879           DFHEIV20,
 11880           ELCRTT-RECORD-LENGTH,
 11881           GETMAIN-SPACE
 11882     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11883         DFHEIV20
 11884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11885
 11886
 11887* EXEC CICS HANDLE CONDITION
 11888*        NOTFND   (1386-NOTFND)
 11889*    END-EXEC.
 11890*    MOVE '"$I                   ! ( #00011316' TO DFHEIV0
 11891     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11893     MOVE X'2820233030303131333136' TO DFHEIV0(25:11)
 11894     CALL 'kxdfhei1' USING DFHEIV0
 11895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11896
 11897
 11898     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 11899     MOVE 'C'                TO ELCRTT-REC-TYPE
 11900
 11901
 11902* EXEC CICS READ
 11903*        UPDATE
 11904*        DATASET  (CRTT-ID)
 11905*        RIDFLD   (ELCRTT-KEY)
 11906*        INTO     (CERTIFICATE-TRAILERS)
 11907*    END-EXEC.
 11908     MOVE LENGTH OF
 11909      CERTIFICATE-TRAILERS
 11910       TO DFHEIV11
 11911*    MOVE '&"IL       EU         (   #00011323' TO DFHEIV0
 11912     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11913     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11914     MOVE X'2020233030303131333233' TO DFHEIV0(25:11)
 11915     CALL 'kxdfhei1' USING DFHEIV0,
 11916           CRTT-ID,
 11917           CERTIFICATE-TRAILERS,
 11918           DFHEIV11,
 11919           ELCRTT-KEY,
 11920           DFHEIV99,
 11921           DFHEIV99,
 11922           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 221
* EL6311.cbl
 11923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11924
 11925
 11926     IF WS-INS-AGE-SET = 'Y'
 11927        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 11928     END-IF
 11929     IF WS-JNT-AGE-SET = 'Y'
 11930        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 11931     END-IF
 11932
 11933
 11934* EXEC CICS REWRITE
 11935*       DATASET  (CRTT-ID)
 11936*       FROM     (CERTIFICATE-TRAILERS)
 11937*    END-EXEC.
 11938     MOVE LENGTH OF
 11939      CERTIFICATE-TRAILERS
 11940       TO DFHEIV11
 11941*    MOVE '&& L                  %   #00011337' TO DFHEIV0
 11942     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11943     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11944     MOVE X'2020233030303131333337' TO DFHEIV0(25:11)
 11945     CALL 'kxdfhei1' USING DFHEIV0,
 11946           CRTT-ID,
 11947           CERTIFICATE-TRAILERS,
 11948           DFHEIV11,
 11949           DFHEIV99
 11950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11951
 11952
 11953     GO TO 1386-EXIT.
 11954
 11955 1386-NOTFND.
 11956
 11957     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 11958     MOVE 'CS'         TO CS-RECORD-ID.
 11959     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 11960     MOVE 'C'          TO ELCRTT-REC-TYPE.
 11961     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 11962     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 11963     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 11964
 11965* EXEC CICS WRITE
 11966*       DATASET  (CRTT-ID)
 11967*       RIDFLD   (ELCRTT-KEY)
 11968*       FROM     (CERTIFICATE-TRAILERS)
 11969*    END-EXEC.
 11970     MOVE LENGTH OF
 11971      CERTIFICATE-TRAILERS
 11972       TO DFHEIV11
 11973*    MOVE '&$ L                  ''   #00011353' TO DFHEIV0
 11974     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11975     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11976     MOVE X'2020233030303131333533' TO DFHEIV0(25:11)
 11977     CALL 'kxdfhei1' USING DFHEIV0,
 11978           CRTT-ID,
 11979           CERTIFICATE-TRAILERS,
 11980           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 222
* EL6311.cbl
 11981           ELCRTT-KEY,
 11982           DFHEIV99,
 11983           DFHEIV99
 11984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11985
 11986
 11987 1386-EXIT.
 11988     EXIT.
 11989
 11990 1390-UPDATE-ERPNDM.
 11991
 11992
 11993* EXEC CICS HANDLE CONDITION
 11994*        NOTFND (1399-EXIT)
 11995*    END-EXEC.
 11996*    MOVE '"$I                   ! ) #00011364' TO DFHEIV0
 11997     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11998     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11999     MOVE X'2920233030303131333634' TO DFHEIV0(25:11)
 12000     CALL 'kxdfhei1' USING DFHEIV0
 12001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12002
 12003
 12004     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12005
 12006
 12007* EXEC CICS READ
 12008*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12009*        DATASET (FILE-ID-ERPNDM)
 12010*        RIDFLD  (ERPNDM-KEY)
 12011*        UPDATE
 12012*    END-EXEC.
 12013*    MOVE '&"S        EU         (   #00011370' TO DFHEIV0
 12014     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12015     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12016     MOVE X'2020233030303131333730' TO DFHEIV0(25:11)
 12017     CALL 'kxdfhei1' USING DFHEIV0,
 12018           FILE-ID-ERPNDM,
 12019           DFHEIV20,
 12020           DFHEIV99,
 12021           ERPNDM-KEY,
 12022           DFHEIV99,
 12023           DFHEIV99,
 12024           DFHEIV99
 12025     SET ADDRESS OF PENDING-MAILING-DATA TO
 12026         DFHEIV20
 12027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12028
 12029
 12030     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12031     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12032     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12033
 12034     IF BLSTNML GREATER THAN ZEROS
 12035         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12036
 12037     IF B1STNML GREATER  THAN ZEROS
 12038         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 223
* EL6311.cbl
 12039
 12040     IF BINITL GREATER THAN ZEROS
 12041         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12042
 12043     IF BAGEL GREATER THAN ZEROS
 12044         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12045
 12046     IF BBIRTHL GREATER THAN ZEROS
 12047         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12048
 12049     IF BSEXL GREATER THAN ZEROS
 12050         MOVE  BSEXI             TO PM-INSURED-SEX.
 12051
 12052
 12053* EXEC CICS REWRITE
 12054*        DATASET (FILE-ID-ERPNDM)
 12055*        FROM    (PENDING-MAILING-DATA)
 12056*    END-EXEC.
 12057     MOVE LENGTH OF
 12058      PENDING-MAILING-DATA
 12059       TO DFHEIV11
 12060*    MOVE '&& L                  %   #00011399' TO DFHEIV0
 12061     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12062     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12063     MOVE X'2020233030303131333939' TO DFHEIV0(25:11)
 12064     CALL 'kxdfhei1' USING DFHEIV0,
 12065           FILE-ID-ERPNDM,
 12066           PENDING-MAILING-DATA,
 12067           DFHEIV11,
 12068           DFHEIV99
 12069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12070
 12071
 12072 1399-EXIT.
 12073     EXIT.
 12074
 12075******************************************************************
 12076*                                                                *
 12077*          D E L E T E   I S S U E   R O U T I N E               *
 12078*                                                                *
 12079******************************************************************
 12080
 12081 1400-DELETE-ISSUE-ROUTINE.
 12082     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12083
 12084     IF BCHGL NOT = ZEROS
 12085        MOVE ER-2196             TO EMI-ERROR
 12086        MOVE AL-UABON            TO BMAINTA
 12087        MOVE -1                  TO BMAINTL
 12088        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12089        GO TO 8200-SEND-DATAONLY.
 12090
 12091
 12092* EXEC CICS HANDLE CONDITION
 12093*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12094*    END-EXEC.
 12095*    MOVE '"$I                   ! * #00011423' TO DFHEIV0
 12096     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 224
* EL6311.cbl
 12097     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12098     MOVE X'2A20233030303131343233' TO DFHEIV0(25:11)
 12099     CALL 'kxdfhei1' USING DFHEIV0
 12100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12101
 12102
 12103     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12104     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12105     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12106
 12107
 12108* EXEC CICS READ
 12109*        SET     (ADDRESS OF PENDING-BUSINESS)
 12110*        DATASET (FILE-ID-ERPNDB)
 12111*        RIDFLD  (ERPNDB-KEY)
 12112*    END-EXEC.
 12113*    MOVE '&"S        E          (   #00011431' TO DFHEIV0
 12114     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12115     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12116     MOVE X'2020233030303131343331' TO DFHEIV0(25:11)
 12117     CALL 'kxdfhei1' USING DFHEIV0,
 12118           FILE-ID-ERPNDB,
 12119           DFHEIV20,
 12120           DFHEIV99,
 12121           ERPNDB-KEY,
 12122           DFHEIV99,
 12123           DFHEIV99,
 12124           DFHEIV99
 12125     SET ADDRESS OF PENDING-BUSINESS TO
 12126         DFHEIV20
 12127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12128
 12129
 12130     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12131
 12132     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12133
 12134     IF BSUFIXL NOT = ZEROS
 12135        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12136     ELSE
 12137        MOVE SPACE               TO WS-NEW-SUFFIX.
 12138
 12139     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12140     PERFORM 8600-DEEDIT.
 12141     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12142     MOVE '4'                    TO DC-OPTION-CODE.
 12143     PERFORM 9700-DATE-LINK.
 12144     IF DATE-CONVERSION-ERROR
 12145        MOVE ER-0348             TO EMI-ERROR
 12146        MOVE -1                  TO BEFFDTL
 12147        MOVE AL-UABON            TO BEFFDTA
 12148        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12149        GO TO 8200-SEND-DATAONLY
 12150     ELSE
 12151        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12152        MOVE AL-UANON            TO BEFFDTA
 12153        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12154
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 225
* EL6311.cbl
 12155
 12156* EXEC CICS HANDLE CONDITION
 12157*         NOTFND    (1490-RECORD-NOT-FOUND)
 12158*    END-EXEC.
 12159*    MOVE '"$I                   ! + #00011462' TO DFHEIV0
 12160     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12162     MOVE X'2B20233030303131343632' TO DFHEIV0(25:11)
 12163     CALL 'kxdfhei1' USING DFHEIV0
 12164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12165
 12166
 12167
 12168* EXEC CICS READ
 12169*        SET     (ADDRESS OF PENDING-BUSINESS)
 12170*        DATASET (FILE-ID-ERPNDB)
 12171*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12172*        UPDATE
 12173*    END-EXEC.
 12174*    MOVE '&"S        EU         (   #00011466' TO DFHEIV0
 12175     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12176     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12177     MOVE X'2020233030303131343636' TO DFHEIV0(25:11)
 12178     CALL 'kxdfhei1' USING DFHEIV0,
 12179           FILE-ID-ERPNDB,
 12180           DFHEIV20,
 12181           DFHEIV99,
 12182           PI-PREV-CONTROL-PRIMARY,
 12183           DFHEIV99,
 12184           DFHEIV99,
 12185           DFHEIV99
 12186     SET ADDRESS OF PENDING-BUSINESS TO
 12187         DFHEIV20
 12188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12189
 12190
 12191     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12192        MOVE -1                 TO BMAINTL
 12193        MOVE ER-2197            TO EMI-ERROR
 12194        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12195        GO TO 8200-SEND-DATAONLY.
 12196
 12197     IF PB-BILLED-DT NOT = LOW-VALUES
 12198        MOVE -1                 TO BMAINTL
 12199        MOVE ER-2129            TO EMI-ERROR
 12200        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12201        GO TO 8200-SEND-DATAONLY.
 12202
 12203     IF PB-CHG-COUNT NOT = ZEROS
 12204        MOVE ER-2336            TO EMI-ERROR
 12205        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12206        MOVE AL-UABON            TO BMAINTA
 12207        MOVE -1                  TO BMAINTL
 12208        GO TO 8200-SEND-DATAONLY.
 12209
 12210     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12211        PB-CHG-COUNT NOT = ZEROS
 12212        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 226
* EL6311.cbl
 12213        MOVE AL-UABON            TO BMAINTA
 12214        MOVE -1                  TO BMAINTL
 12215        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12216        GO TO 8200-SEND-DATAONLY.
 12217******************************************************************
 12218*                                                                *
 12219*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12220*                                                                *
 12221******************************************************************
 12222     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12223     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12224     MOVE +0                     TO ELCRTO-SEQ-NO
 12225
 12226* EXEC CICS READ
 12227*       DATASET   ('ELCRTO')
 12228*       INTO      (ORIGINAL-CERTIFICATE)
 12229*       RIDFLD    (ELCRTO-KEY)
 12230*       GTEQ
 12231*       RESP      (WS-RESPONSE)
 12232*    END-EXEC
 12233     MOVE LENGTH OF
 12234      ORIGINAL-CERTIFICATE
 12235       TO DFHEIV11
 12236     MOVE 'ELCRTO' TO DFHEIV1
 12237*    MOVE '&"IL       G          (  N#00011507' TO DFHEIV0
 12238     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12239     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12240     MOVE X'204E233030303131353037' TO DFHEIV0(25:11)
 12241     CALL 'kxdfhei1' USING DFHEIV0,
 12242           DFHEIV1,
 12243           ORIGINAL-CERTIFICATE,
 12244           DFHEIV11,
 12245           ELCRTO-KEY,
 12246           DFHEIV99,
 12247           DFHEIV99,
 12248           DFHEIV99
 12249     MOVE EIBRESP  TO WS-RESPONSE
 12250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12251     IF RESP-NORMAL
 12252        AND (OC-CONTROL-PRIMARY (1:33) =
 12253                 PB-CONTROL-BY-ACCOUNT (1:33))
 12254        AND (OC-RECORD-TYPE = 'I')
 12255
 12256* EXEC CICS READ
 12257*          DATASET   ('ELCRTO')
 12258*          INTO      (ORIGINAL-CERTIFICATE)
 12259*          RIDFLD    (ELCRTO-KEY)
 12260*          UPDATE
 12261*          RESP      (WS-RESPONSE)
 12262*       END-EXEC
 12263     MOVE LENGTH OF
 12264      ORIGINAL-CERTIFICATE
 12265       TO DFHEIV11
 12266     MOVE 'ELCRTO' TO DFHEIV1
 12267*    MOVE '&"IL       EU         (  N#00011518' TO DFHEIV0
 12268     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12269     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12270     MOVE X'204E233030303131353138' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 227
* EL6311.cbl
 12271     CALL 'kxdfhei1' USING DFHEIV0,
 12272           DFHEIV1,
 12273           ORIGINAL-CERTIFICATE,
 12274           DFHEIV11,
 12275           ELCRTO-KEY,
 12276           DFHEIV99,
 12277           DFHEIV99,
 12278           DFHEIV99
 12279     MOVE EIBRESP  TO WS-RESPONSE
 12280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12281        IF RESP-NORMAL
 12282
 12283* EXEC CICS DELETE
 12284*             DATASET   ('ELCRTO')
 12285*          END-EXEC
 12286     MOVE 'ELCRTO' TO DFHEIV1
 12287*    MOVE '&(                    &   #00011526' TO DFHEIV0
 12288     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12289     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12290     MOVE X'2020233030303131353236' TO DFHEIV0(25:11)
 12291     CALL 'kxdfhei1' USING DFHEIV0,
 12292           DFHEIV1,
 12293           DFHEIV99,
 12294           DFHEIV99,
 12295           DFHEIV99,
 12296           DFHEIV99
 12297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12298        END-IF
 12299     END-IF
 12300******************************************************************
 12301*                                                                *
 12302*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12303*                                                                *
 12304******************************************************************
 12305
 12306* EXEC CICS HANDLE CONDITION
 12307*        NOTFND    (1405-DELETE-CERTIFICATE)
 12308*    END-EXEC.
 12309*    MOVE '"$I                   ! , #00011536' TO DFHEIV0
 12310     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12311     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12312     MOVE X'2C20233030303131353336' TO DFHEIV0(25:11)
 12313     CALL 'kxdfhei1' USING DFHEIV0
 12314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12315
 12316
 12317
 12318* EXEC CICS READ
 12319*        EQUAL
 12320*        DATASET   (FILE-ID-ERPNDM)
 12321*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12322*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12323*        UPDATE
 12324*    END-EXEC.
 12325*    MOVE '&"S        EU         (   #00011540' TO DFHEIV0
 12326     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12327     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12328     MOVE X'2020233030303131353430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 228
* EL6311.cbl
 12329     CALL 'kxdfhei1' USING DFHEIV0,
 12330           FILE-ID-ERPNDM,
 12331           DFHEIV20,
 12332           DFHEIV99,
 12333           PI-PREV-CONTROL-PRIMARY,
 12334           DFHEIV99,
 12335           DFHEIV99,
 12336           DFHEIV99
 12337     SET ADDRESS OF PENDING-MAILING-DATA TO
 12338         DFHEIV20
 12339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12340
 12341
 12342     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12343     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12344     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12345
 12346     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12347
 12348
 12349* EXEC CICS DELETE
 12350*        DATASET   (FILE-ID-ERPNDM)
 12351*    END-EXEC.
 12352*    MOVE '&(                    &   #00011554' TO DFHEIV0
 12353     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12354     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12355     MOVE X'2020233030303131353534' TO DFHEIV0(25:11)
 12356     CALL 'kxdfhei1' USING DFHEIV0,
 12357           FILE-ID-ERPNDM,
 12358           DFHEIV99,
 12359           DFHEIV99,
 12360           DFHEIV99,
 12361           DFHEIV99
 12362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12363
 12364
 12365******************************************************************
 12366*                PROCESS   CERTIFICATE                           *
 12367******************************************************************
 12368
 12369 1405-DELETE-CERTIFICATE.
 12370
 12371* EXEC CICS HANDLE CONDITION
 12372*         NOTFND  (1420-CONTINUE-DELETE)
 12373*    END-EXEC.
 12374*    MOVE '"$I                   ! - #00011563' TO DFHEIV0
 12375     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12376     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12377     MOVE X'2D20233030303131353633' TO DFHEIV0(25:11)
 12378     CALL 'kxdfhei1' USING DFHEIV0
 12379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12380
 12381
 12382     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12383     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12384     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12385     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12386
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 229
* EL6311.cbl
 12387
 12388* EXEC CICS READ
 12389*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12390*        DATASET (FILE-ID-ELCERT)
 12391*        RIDFLD  (ELCERT-KEY)
 12392*        UPDATE
 12393*    END-EXEC.
 12394*    MOVE '&"S        EU         (   #00011572' TO DFHEIV0
 12395     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12396     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12397     MOVE X'2020233030303131353732' TO DFHEIV0(25:11)
 12398     CALL 'kxdfhei1' USING DFHEIV0,
 12399           FILE-ID-ELCERT,
 12400           DFHEIV20,
 12401           DFHEIV99,
 12402           ELCERT-KEY,
 12403           DFHEIV99,
 12404           DFHEIV99,
 12405           DFHEIV99
 12406     SET ADDRESS OF CERTIFICATE-MASTER TO
 12407         DFHEIV20
 12408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12409
 12410
 12411     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12412
 12413     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12414     MOVE 'B'                    TO JP-RECORD-TYPE
 12415     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12416
 12417     PERFORM 8400-LOG-JOURNAL-RECORD.
 12418
 12419     IF CERT-NOTES-ARE-NOT-PRESENT
 12420        MOVE ' '                 TO WS-CERT-NOTE-SW
 12421     ELSE
 12422        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12423
 12424     IF INSURED-ADDR-PRESENT
 12425        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12426
 12427******************************************************************
 12428******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12429******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12430******************************************************************
 12431******************************************************************
 12432
 12433     IF CERT-ADDED-BATCH AND
 12434        (NOT NO-CLAIM-ATTACHED
 12435         OR
 12436         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12437        GO TO 1410-REWRITE-CERT.
 12438
 12439******************************************************************
 12440******************************************************************
 12441
 12442     IF CERT-ADDED-BATCH  AND
 12443        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12444        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 230
* EL6311.cbl
 12445
 12446     IF NO-CLAIM-ATTACHED
 12447        NEXT SENTENCE
 12448     ELSE
 12449        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12450        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12451        GO TO 1410-REWRITE-CERT.
 12452
 12453     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12454     MOVE 'D'                      TO JP-RECORD-TYPE.
 12455     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12456
 12457
 12458* EXEC CICS DELETE
 12459*         DATASET    (FILE-ID-ELCERT)
 12460*    END-EXEC.
 12461*    MOVE '&(                    &   #00011625' TO DFHEIV0
 12462     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12463     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12464     MOVE X'2020233030303131363235' TO DFHEIV0(25:11)
 12465     CALL 'kxdfhei1' USING DFHEIV0,
 12466           FILE-ID-ELCERT,
 12467           DFHEIV99,
 12468           DFHEIV99,
 12469           DFHEIV99,
 12470           DFHEIV99
 12471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12472
 12473
 12474     PERFORM 8400-LOG-JOURNAL-RECORD.
 12475
 12476******************************************************************
 12477*                                                                *
 12478*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12479*                                                                *
 12480******************************************************************
 12481
 12482     IF  CERT-NOTES-ARE-PRESENT
 12483         NEXT SENTENCE
 12484     ELSE
 12485         GO TO 1407-DELETE-MAILING.
 12486
 12487
 12488* EXEC CICS HANDLE CONDITION
 12489*         NOTFND  (1406-DELETE-ERNOTE)
 12490*    END-EXEC.
 12491*    MOVE '"$I                   ! . #00011642' TO DFHEIV0
 12492     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12493     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12494     MOVE X'2E20233030303131363432' TO DFHEIV0(25:11)
 12495     CALL 'kxdfhei1' USING DFHEIV0
 12496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12497
 12498
 12499     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12500     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12501     MOVE 0                     TO ERCNOT-SEQUENCE.
 12502
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 231
* EL6311.cbl
 12503 1406-DELETE-ERCNOT-LOOP.
 12504
 12505
 12506* EXEC CICS READ
 12507*        GTEQ
 12508*        DATASET   (FILE-ID-ERCNOT)
 12509*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12510*        RIDFLD    (ERCNOT-KEY)
 12511*    END-EXEC.
 12512*    MOVE '&"S        G          (   #00011652' TO DFHEIV0
 12513     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12514     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12515     MOVE X'2020233030303131363532' TO DFHEIV0(25:11)
 12516     CALL 'kxdfhei1' USING DFHEIV0,
 12517           FILE-ID-ERCNOT,
 12518           DFHEIV20,
 12519           DFHEIV99,
 12520           ERCNOT-KEY,
 12521           DFHEIV99,
 12522           DFHEIV99,
 12523           DFHEIV99
 12524     SET ADDRESS OF CERT-NOTE-FILE TO
 12525         DFHEIV20
 12526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12527
 12528
 12529     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12530     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12531         GO TO 1406-DELETE-ERNOTE
 12532     END-IF.
 12533
 12534     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12535     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12536     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12537
 12538     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12539
 12540
 12541* EXEC CICS DELETE
 12542*        DATASET   (FILE-ID-ERCNOT)
 12543*        RIDFLD    (ERCNOT-KEY)
 12544*        END-EXEC.
 12545*    MOVE '&(  R                 &   #00011670' TO DFHEIV0
 12546     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12547     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12548     MOVE X'2020233030303131363730' TO DFHEIV0(25:11)
 12549     CALL 'kxdfhei1' USING DFHEIV0,
 12550           FILE-ID-ERCNOT,
 12551           ERCNOT-KEY,
 12552           DFHEIV99,
 12553           DFHEIV99,
 12554           DFHEIV99
 12555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12556
 12557
 12558     PERFORM 8400-LOG-JOURNAL-RECORD.
 12559
 12560     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 232
* EL6311.cbl
 12561
 12562 1406-DELETE-ERNOTE.
 12563
 12564
 12565* EXEC CICS HANDLE CONDITION
 12566*         NOTFND  (1407-DELETE-MAILING)
 12567*    END-EXEC.
 12568*    MOVE '"$I                   ! / #00011681' TO DFHEIV0
 12569     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12570     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12571     MOVE X'2F20233030303131363831' TO DFHEIV0(25:11)
 12572     CALL 'kxdfhei1' USING DFHEIV0
 12573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12574
 12575
 12576
 12577* EXEC CICS READ
 12578*        EQUAL
 12579*        DATASET   (FILE-ID-ERNOTE)
 12580*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12581*        RIDFLD    (ELCERT-KEY)
 12582*        UPDATE
 12583*    END-EXEC.
 12584*    MOVE '&"S        EU         (   #00011685' TO DFHEIV0
 12585     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12586     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12587     MOVE X'2020233030303131363835' TO DFHEIV0(25:11)
 12588     CALL 'kxdfhei1' USING DFHEIV0,
 12589           FILE-ID-ERNOTE,
 12590           DFHEIV20,
 12591           DFHEIV99,
 12592           ELCERT-KEY,
 12593           DFHEIV99,
 12594           DFHEIV99,
 12595           DFHEIV99
 12596     SET ADDRESS OF CERTIFICATE-NOTE TO
 12597         DFHEIV20
 12598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12599
 12600
 12601     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12602     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12603     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12604
 12605     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12606
 12607
 12608* EXEC CICS DELETE
 12609*        DATASET   (FILE-ID-ERNOTE)
 12610*        END-EXEC.
 12611*    MOVE '&(                    &   #00011699' TO DFHEIV0
 12612     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12613     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12614     MOVE X'2020233030303131363939' TO DFHEIV0(25:11)
 12615     CALL 'kxdfhei1' USING DFHEIV0,
 12616           FILE-ID-ERNOTE,
 12617           DFHEIV99,
 12618           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 233
* EL6311.cbl
 12619           DFHEIV99,
 12620           DFHEIV99
 12621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12622
 12623
 12624     PERFORM 8400-LOG-JOURNAL-RECORD.
 12625
 12626******************************************************************
 12627*                                                                *
 12628*                DELETE MAILING ADDRESS RECORDS                  *
 12629*                                                                *
 12630******************************************************************
 12631
 12632 1407-DELETE-MAILING.
 12633     IF CERT-ADDRESS-PRESENT
 12634        NEXT SENTENCE
 12635     ELSE
 12636        GO TO 1420-CONTINUE-DELETE.
 12637
 12638
 12639* EXEC CICS HANDLE CONDITION
 12640*         NOTFND  (1420-CONTINUE-DELETE)
 12641*    END-EXEC.
 12642*    MOVE '"$I                   ! 0 #00011717' TO DFHEIV0
 12643     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12644     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12645     MOVE X'3020233030303131373137' TO DFHEIV0(25:11)
 12646     CALL 'kxdfhei1' USING DFHEIV0
 12647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12648
 12649
 12650
 12651* EXEC CICS READ
 12652*        EQUAL
 12653*        DATASET   (FILE-ID-ERMAIL)
 12654*        SET       (ADDRESS OF MAILING-DATA)
 12655*        RIDFLD    (ELCERT-KEY)
 12656*        UPDATE
 12657*    END-EXEC.
 12658*    MOVE '&"S        EU         (   #00011721' TO DFHEIV0
 12659     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12660     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12661     MOVE X'2020233030303131373231' TO DFHEIV0(25:11)
 12662     CALL 'kxdfhei1' USING DFHEIV0,
 12663           FILE-ID-ERMAIL,
 12664           DFHEIV20,
 12665           DFHEIV99,
 12666           ELCERT-KEY,
 12667           DFHEIV99,
 12668           DFHEIV99,
 12669           DFHEIV99
 12670     SET ADDRESS OF MAILING-DATA TO
 12671         DFHEIV20
 12672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12673
 12674
 12675     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12676     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 234
* EL6311.cbl
 12677     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12678
 12679     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12680
 12681
 12682* EXEC CICS DELETE
 12683*        DATASET   (FILE-ID-ERMAIL)
 12684*    END-EXEC.
 12685*    MOVE '&(                    &   #00011735' TO DFHEIV0
 12686     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12687     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12688     MOVE X'2020233030303131373335' TO DFHEIV0(25:11)
 12689     CALL 'kxdfhei1' USING DFHEIV0,
 12690           FILE-ID-ERMAIL,
 12691           DFHEIV99,
 12692           DFHEIV99,
 12693           DFHEIV99,
 12694           DFHEIV99
 12695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12696
 12697
 12698     GO TO 1420-CONTINUE-DELETE.
 12699
 12700 1410-REWRITE-CERT.
 12701     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12702     MOVE 'C'                      TO JP-RECORD-TYPE.
 12703     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12704     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12705
 12706
 12707* EXEC CICS REWRITE
 12708*         DATASET    (FILE-ID-ELCERT)
 12709*         FROM       (CERTIFICATE-MASTER)
 12710*         END-EXEC.
 12711     MOVE LENGTH OF
 12712      CERTIFICATE-MASTER
 12713       TO DFHEIV11
 12714*    MOVE '&& L                  %   #00011747' TO DFHEIV0
 12715     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12716     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12717     MOVE X'2020233030303131373437' TO DFHEIV0(25:11)
 12718     CALL 'kxdfhei1' USING DFHEIV0,
 12719           FILE-ID-ELCERT,
 12720           CERTIFICATE-MASTER,
 12721           DFHEIV11,
 12722           DFHEIV99
 12723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12724
 12725
 12726     PERFORM 8400-LOG-JOURNAL-RECORD.
 12727
 12728 1420-CONTINUE-DELETE.
 12729     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12730     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12731
 12732     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12733     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12734
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 235
* EL6311.cbl
 12735     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12736
 12737 1450-DELETE-PB-RECORD.
 12738     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12739     MOVE 'D'                      TO JP-RECORD-TYPE
 12740     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12741
 12742
 12743* EXEC CICS DELETE
 12744*        DATASET    (FILE-ID-ERPNDB)
 12745*    END-EXEC.
 12746*    MOVE '&(                    &   #00011768' TO DFHEIV0
 12747     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12748     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12749     MOVE X'2020233030303131373638' TO DFHEIV0(25:11)
 12750     CALL 'kxdfhei1' USING DFHEIV0,
 12751           FILE-ID-ERPNDB,
 12752           DFHEIV99,
 12753           DFHEIV99,
 12754           DFHEIV99,
 12755           DFHEIV99
 12756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12757
 12758
 12759     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12760
 12761     PERFORM 8400-LOG-JOURNAL-RECORD.
 12762
 12763     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12764     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12765     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12766
 12767
 12768* EXEC CICS HANDLE CONDITION
 12769*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12770*    END-EXEC.
 12771*    MOVE '"$I                   ! 1 #00011780' TO DFHEIV0
 12772     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12773     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12774     MOVE X'3120233030303131373830' TO DFHEIV0(25:11)
 12775     CALL 'kxdfhei1' USING DFHEIV0
 12776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12777
 12778
 12779
 12780* EXEC CICS READ
 12781*        SET     (ADDRESS OF PENDING-BUSINESS)
 12782*        DATASET (FILE-ID-ERPNDB)
 12783*        RIDFLD  (ERPNDB-KEY)
 12784*        UPDATE
 12785*    END-EXEC.
 12786*    MOVE '&"S        EU         (   #00011784' TO DFHEIV0
 12787     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12788     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12789     MOVE X'2020233030303131373834' TO DFHEIV0(25:11)
 12790     CALL 'kxdfhei1' USING DFHEIV0,
 12791           FILE-ID-ERPNDB,
 12792           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 236
* EL6311.cbl
 12793           DFHEIV99,
 12794           ERPNDB-KEY,
 12795           DFHEIV99,
 12796           DFHEIV99,
 12797           DFHEIV99
 12798     SET ADDRESS OF PENDING-BUSINESS TO
 12799         DFHEIV20
 12800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12801
 12802
 12803     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12804
 12805     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 12806
 12807     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12808        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12809        MOVE 'D'                   TO JP-RECORD-TYPE
 12810        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 12811
 12812* EXEC CICS DELETE
 12813*            DATASET    (FILE-ID-ERPNDB)
 12814*       END-EXEC
 12815*    MOVE '&(                    &   #00011799' TO DFHEIV0
 12816     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12817     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12818     MOVE X'2020233030303131373939' TO DFHEIV0(25:11)
 12819     CALL 'kxdfhei1' USING DFHEIV0,
 12820           FILE-ID-ERPNDB,
 12821           DFHEIV99,
 12822           DFHEIV99,
 12823           DFHEIV99,
 12824           DFHEIV99
 12825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12826        PERFORM 8400-LOG-JOURNAL-RECORD
 12827     ELSE
 12828        MOVE 'B'                 TO JP-RECORD-TYPE
 12829        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12830        PERFORM 8400-LOG-JOURNAL-RECORD
 12831        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 12832        MOVE 'C'                 TO JP-RECORD-TYPE
 12833        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12834
 12835* EXEC CICS REWRITE
 12836*            DATASET    (FILE-ID-ERPNDB)
 12837*            FROM       (PENDING-BUSINESS)
 12838*       END-EXEC
 12839     MOVE LENGTH OF
 12840      PENDING-BUSINESS
 12841       TO DFHEIV11
 12842*    MOVE '&& L                  %   #00011810' TO DFHEIV0
 12843     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12844     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12845     MOVE X'2020233030303131383130' TO DFHEIV0(25:11)
 12846     CALL 'kxdfhei1' USING DFHEIV0,
 12847           FILE-ID-ERPNDB,
 12848           PENDING-BUSINESS,
 12849           DFHEIV11,
 12850           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 237
* EL6311.cbl
 12851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12852        PERFORM 8400-LOG-JOURNAL-RECORD.
 12853
 12854******************************************************************
 12855*                                                                *
 12856*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 12857*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 12858*                                                                *
 12859******************************************************************
 12860
 12861     IF NOT PI-AR-PROCESSING
 12862        GO TO 1475-DELETE-FINISHED.
 12863
 12864     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12865        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12866        NEXT SENTENCE
 12867     ELSE
 12868        GO TO 1475-DELETE-FINISHED.
 12869
 12870
 12871* EXEC CICS HANDLE CONDITION
 12872*         NOTFND    (1475-DELETE-FINISHED)
 12873*         END-EXEC.
 12874*    MOVE '"$I                   ! 2 #00011832' TO DFHEIV0
 12875     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12876     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12877     MOVE X'3220233030303131383332' TO DFHEIV0(25:11)
 12878     CALL 'kxdfhei1' USING DFHEIV0
 12879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12880
 12881
 12882     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 12883     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 12884
 12885
 12886* EXEC CICS READ
 12887*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 12888*        DATASET (FILE-ID-ERRQST)
 12889*        RIDFLD  (ERRQST-KEY)
 12890*        UPDATE
 12891*    END-EXEC.
 12892*    MOVE '&"S        EU         (   #00011839' TO DFHEIV0
 12893     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12894     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12895     MOVE X'2020233030303131383339' TO DFHEIV0(25:11)
 12896     CALL 'kxdfhei1' USING DFHEIV0,
 12897           FILE-ID-ERRQST,
 12898           DFHEIV20,
 12899           DFHEIV99,
 12900           ERRQST-KEY,
 12901           DFHEIV99,
 12902           DFHEIV99,
 12903           DFHEIV99
 12904     SET ADDRESS OF AR-REQUEST-RECORD TO
 12905         DFHEIV20
 12906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12907
 12908
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 238
* EL6311.cbl
 12909     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12910
 12911     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 12912
 12913     MOVE 'D'                      TO JP-RECORD-TYPE.
 12914     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 12915
 12916
 12917* EXEC CICS DELETE
 12918*         DATASET    (FILE-ID-ERRQST)
 12919*    END-EXEC.
 12920*    MOVE '&(                    &   #00011853' TO DFHEIV0
 12921     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12922     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12923     MOVE X'2020233030303131383533' TO DFHEIV0(25:11)
 12924     CALL 'kxdfhei1' USING DFHEIV0,
 12925           FILE-ID-ERRQST,
 12926           DFHEIV99,
 12927           DFHEIV99,
 12928           DFHEIV99,
 12929           DFHEIV99
 12930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12931
 12932
 12933     PERFORM 8400-LOG-JOURNAL-RECORD.
 12934
 12935 1475-DELETE-FINISHED.
 12936     MOVE ZEROS                  TO EMI-ERROR.
 12937     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12938     MOVE LOW-VALUES             TO EL631BI.
 12939     MOVE -1                     TO BMAINTL.
 12940     GO TO 8100-SEND-INITIAL-MAP.
 12941
 12942 1480-BATCH-HDR-NOT-FOUND.
 12943     MOVE -1                     TO BMAINTL.
 12944     MOVE ER-7450                TO EMI-ERROR.
 12945     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12946     GO TO 8200-SEND-DATAONLY.
 12947
 12948 1490-RECORD-NOT-FOUND.
 12949     MOVE -1                     TO BMAINTL.
 12950     MOVE ER-7451                TO EMI-ERROR.
 12951     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12952     GO TO 8200-SEND-DATAONLY.
 12953
 12954******************************************************************
 12955*            O V E R   C H A R G E   P R O C E S S I N G         *
 12956******************************************************************
 12957 1500-UPDATE-ERNOTE.
 12958     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 12959     MOVE 'A'                    TO WS-NOTE-SW
 12960     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 12961     .
 12962 1500-EXIT.
 12963     EXIT.
 12964 1510-ADD-ERNOTE-REC.
 12965
 12966* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 239
* EL6311.cbl
 12967*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 12968*        LENGTH  (ERNOTE-RECORD-LENGTH)
 12969*        INITIMG (GETMAIN-SPACE)
 12970*    END-EXEC
 12971*    MOVE ',"IL                  $   #00011889' TO DFHEIV0
 12972     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12973     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12974     MOVE X'2020233030303131383839' TO DFHEIV0(25:11)
 12975     CALL 'kxdfhei1' USING DFHEIV0,
 12976           DFHEIV20,
 12977           ERNOTE-RECORD-LENGTH,
 12978           GETMAIN-SPACE
 12979     SET ADDRESS OF CERTIFICATE-NOTE TO
 12980         DFHEIV20
 12981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12982     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12983                                 TO ERNOTE-KEY
 12984
 12985* EXEC CICS READ
 12986*       DATASET    (FILE-ID-ERNOTE)
 12987*       RIDFLD     (ERNOTE-KEY)
 12988*       INTO       (CERTIFICATE-NOTE)
 12989*       RESP       (WS-RESPONSE)
 12990*       UPDATE
 12991*    END-EXEC
 12992     MOVE LENGTH OF
 12993      CERTIFICATE-NOTE
 12994       TO DFHEIV11
 12995*    MOVE '&"IL       EU         (  N#00011896' TO DFHEIV0
 12996     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12997     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12998     MOVE X'204E233030303131383936' TO DFHEIV0(25:11)
 12999     CALL 'kxdfhei1' USING DFHEIV0,
 13000           FILE-ID-ERNOTE,
 13001           CERTIFICATE-NOTE,
 13002           DFHEIV11,
 13003           ERNOTE-KEY,
 13004           DFHEIV99,
 13005           DFHEIV99,
 13006           DFHEIV99
 13007     MOVE EIBRESP  TO WS-RESPONSE
 13008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13009     IF RESP-NORMAL
 13010        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13011           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13012        END-IF
 13013        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13014           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13015        END-IF
 13016        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13017           (N1 > +10)
 13018           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13019           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13020        END-PERFORM
 13021        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13022          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13023
 13024* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 240
* EL6311.cbl
 13025*            DATASET    (FILE-ID-ERNOTE)
 13026*          END-EXEC
 13027*    MOVE '&*                    #   #00011917' TO DFHEIV0
 13028     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13029     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13030     MOVE X'2020233030303131393137' TO DFHEIV0(25:11)
 13031     CALL 'kxdfhei1' USING DFHEIV0,
 13032           FILE-ID-ERNOTE,
 13033           DFHEIV99
 13034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13035        ELSE
 13036          PERFORM VARYING N1 FROM +1 BY +1
 13037           UNTIL (N1 > +10)
 13038           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13039          END-PERFORM
 13040          IF (N1 < +11)
 13041            IF N1 >= CN-BILLING-START-LINE-NO AND
 13042              N1 <= CN-BILLING-END-LINE-NO
 13043              IF PI-COMPANY-ID = 'DCC'
 13044                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13045              ELSE
 13046                 MOVE WS-VA-NO-COMM-MESS
 13047                                    TO CN-LINE (N1)
 13048              END-IF
 13049            ELSE
 13050              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13051               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13052                IF PI-COMPANY-ID = 'DCC'
 13053                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13054                ELSE
 13055                  MOVE WS-VA-NO-COMM-MESS
 13056                                    TO CN-LINE (N1)
 13057                END-IF
 13058                MOVE N1             TO CN-BILLING-END-LINE-NO
 13059              ELSE
 13060                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13061                  IF PI-COMPANY-ID = 'DCC'
 13062                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13063                  ELSE
 13064                     MOVE WS-VA-NO-COMM-MESS
 13065                                    TO CN-LINE (N1)
 13066                  END-IF
 13067                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13068                                      CN-BILLING-START-LINE-NO
 13069                ELSE
 13070                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13071                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13072                     IF PI-COMPANY-ID = 'DCC'
 13073                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13074                     ELSE
 13075                       MOVE WS-VA-NO-COMM-MESS
 13076                                    TO CN-LINE (N1)
 13077                     END-IF
 13078                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13079                  ELSE
 13080                     PERFORM 1700-SQUEEZE-IT-IN
 13081                                 THRU 1700-EXIT
 13082                  END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 241
* EL6311.cbl
 13083                END-IF
 13084              END-IF
 13085            END-IF
 13086            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13087            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13088            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13089
 13090* EXEC CICS REWRITE
 13091*              DATASET    (FILE-ID-ERNOTE)
 13092*              FROM       (CERTIFICATE-NOTE)
 13093*              RESP       (WS-RESPONSE)
 13094*           END-EXEC
 13095     MOVE LENGTH OF
 13096      CERTIFICATE-NOTE
 13097       TO DFHEIV11
 13098*    MOVE '&& L                  %  N#00011974' TO DFHEIV0
 13099     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13100     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13101     MOVE X'204E233030303131393734' TO DFHEIV0(25:11)
 13102     CALL 'kxdfhei1' USING DFHEIV0,
 13103           FILE-ID-ERNOTE,
 13104           CERTIFICATE-NOTE,
 13105           DFHEIV11,
 13106           DFHEIV99
 13107     MOVE EIBRESP  TO WS-RESPONSE
 13108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13109          END-IF
 13110        END-IF
 13111     ELSE
 13112        MOVE SPACES              TO CERTIFICATE-NOTE
 13113        MOVE 'CN'                TO CN-RECORD-ID
 13114        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13115                                 TO CN-CONTROL-PRIMARY
 13116                                    ERNOTE-KEY
 13117        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13118                                    CN-BILLING-END-LINE-NO
 13119        IF PI-COMPANY-ID = 'DCC'
 13120           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13121        ELSE
 13122           MOVE WS-VA-NO-COMM-MESS
 13123                                 TO CN-LINE (1)
 13124        END-IF
 13125        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13126        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13127        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13128
 13129* EXEC CICS WRITE
 13130*          DATASET    (FILE-ID-ERNOTE)
 13131*          FROM       (CERTIFICATE-NOTE)
 13132*          RIDFLD     (ERNOTE-KEY)
 13133*          RESP       (WS-RESPONSE)
 13134*       END-EXEC
 13135     MOVE LENGTH OF
 13136      CERTIFICATE-NOTE
 13137       TO DFHEIV11
 13138*    MOVE '&$ L                  ''  N#00011998' TO DFHEIV0
 13139     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13140     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 242
* EL6311.cbl
 13141     MOVE X'204E233030303131393938' TO DFHEIV0(25:11)
 13142     CALL 'kxdfhei1' USING DFHEIV0,
 13143           FILE-ID-ERNOTE,
 13144           CERTIFICATE-NOTE,
 13145           DFHEIV11,
 13146           ERNOTE-KEY,
 13147           DFHEIV99,
 13148           DFHEIV99
 13149     MOVE EIBRESP  TO WS-RESPONSE
 13150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13151     END-IF
 13152     .
 13153 1510-EXIT.
 13154     EXIT.
 13155 1520-UPDATE-ELCERT.
 13156     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13157                                 TO ELCERT-KEY
 13158
 13159* EXEC CICS READ
 13160*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13161*        DATASET (FILE-ID-ELCERT)
 13162*        RIDFLD  (ELCERT-KEY)
 13163*        UPDATE
 13164*        RESP    (WS-RESPONSE)
 13165*    END-EXEC
 13166*    MOVE '&"S        EU         (  N#00012011' TO DFHEIV0
 13167     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13168     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13169     MOVE X'204E233030303132303131' TO DFHEIV0(25:11)
 13170     CALL 'kxdfhei1' USING DFHEIV0,
 13171           FILE-ID-ELCERT,
 13172           DFHEIV20,
 13173           DFHEIV99,
 13174           ELCERT-KEY,
 13175           DFHEIV99,
 13176           DFHEIV99,
 13177           DFHEIV99
 13178     SET ADDRESS OF CERTIFICATE-MASTER TO
 13179         DFHEIV20
 13180     MOVE EIBRESP  TO WS-RESPONSE
 13181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13182     IF RESP-NORMAL
 13183        IF WS-NOTE-SW = 'A'
 13184           IF CM-NOTE-SW = ' '
 13185              MOVE '2'             TO CM-NOTE-SW
 13186           ELSE
 13187             IF CM-NOTE-SW = '1'
 13188                MOVE '3'           TO CM-NOTE-SW
 13189             ELSE
 13190               IF CM-NOTE-SW = '4'
 13191                  MOVE '6'         TO CM-NOTE-SW
 13192               ELSE
 13193                 IF CM-NOTE-SW = '5'
 13194                    MOVE '7'       TO CM-NOTE-SW
 13195                 END-IF
 13196               END-IF
 13197             END-IF
 13198           END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 243
* EL6311.cbl
 13199        ELSE
 13200           IF CM-NOTE-SW = '2'
 13201              MOVE ' '             TO CM-NOTE-SW
 13202           ELSE
 13203             IF CM-NOTE-SW = '3'
 13204                MOVE '1'           TO CM-NOTE-SW
 13205             ELSE
 13206               IF CM-NOTE-SW = '6'
 13207                  MOVE '4'         TO CM-NOTE-SW
 13208               ELSE
 13209                 IF CM-NOTE-SW = '7'
 13210                    MOVE '5'       TO CM-NOTE-SW
 13211                 END-IF
 13212               END-IF
 13213             END-IF
 13214           END-IF
 13215        END-IF
 13216
 13217* EXEC CICS REWRITE
 13218*          DATASET    (FILE-ID-ELCERT)
 13219*          FROM       (CERTIFICATE-MASTER)
 13220*          RESP       (WS-RESPONSE)
 13221*       END-EXEC
 13222     MOVE LENGTH OF
 13223      CERTIFICATE-MASTER
 13224       TO DFHEIV11
 13225*    MOVE '&& L                  %  N#00012052' TO DFHEIV0
 13226     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13227     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13228     MOVE X'204E233030303132303532' TO DFHEIV0(25:11)
 13229     CALL 'kxdfhei1' USING DFHEIV0,
 13230           FILE-ID-ELCERT,
 13231           CERTIFICATE-MASTER,
 13232           DFHEIV11,
 13233           DFHEIV99
 13234     MOVE EIBRESP  TO WS-RESPONSE
 13235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13236        IF RESP-NORMAL
 13237           CONTINUE
 13238        ELSE
 13239           MOVE WS-RESPONSE TO EMI-ERROR
 13240           PERFORM 9900-ERROR-FORMAT
 13241                                 THRU 9900-EXIT
 13242           GO TO 8200-SEND-DATAONLY
 13243        END-IF
 13244     ELSE
 13245        MOVE -1                  TO BMAINTL
 13246        MOVE 0249                TO EMI-ERROR
 13247        PERFORM 9900-ERROR-FORMAT
 13248                                 THRU 9900-EXIT
 13249        GO TO 8200-SEND-DATAONLY
 13250     END-IF
 13251     .
 13252 1520-EXIT.
 13253     EXIT.
 13254 1600-UPDATE-ERPYAJ.
 13255     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13256                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 244
* EL6311.cbl
 13257     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13258                                 THRU 1620-EXIT
 13259     .
 13260 1600-EXIT.
 13261     EXIT.
 13262 1610-ADD-ERPYAJ-BANK-REC.
 13263
 13264* EXEC CICS GETMAIN
 13265*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13266*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13267*        INITIMG (GETMAIN-SPACE)
 13268*    END-EXEC
 13269*    MOVE ',"IL                  $   #00012084' TO DFHEIV0
 13270     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13271     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13272     MOVE X'2020233030303132303834' TO DFHEIV0(25:11)
 13273     CALL 'kxdfhei1' USING DFHEIV0,
 13274           DFHEIV20,
 13275           ERPYAJ-RECORD-LENGTH,
 13276           GETMAIN-SPACE
 13277     SET ADDRESS OF PENDING-PAY-ADJ TO
 13278         DFHEIV20
 13279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13280     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13281     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13282     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13283     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13284     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13285     MOVE +10                    TO ERPYAJ-SEQ-NO
 13286     MOVE 'R'                    TO ERPYAJ-TYPE
 13287     IF REVERSAL
 13288        MOVE 'C'                 TO ERPYAJ-TYPE
 13289     END-IF
 13290     MOVE SPACES                 TO PENDING-PAY-ADJ
 13291     MOVE 'PY'                   TO PY-RECORD-ID
 13292     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13293     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13294     IF REVERSAL
 13295        MOVE PB-I-DCC-OVER-CHG-AMT
 13296                                 TO PY-ENTRY-AMT
 13297     END-IF
 13298     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13299                                    PY-INPUT-DT
 13300*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13301*                                   PY-INPUT-DT
 13302     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13303     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13304     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13305     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13306     IF PB-CARRIER = '2'
 13307        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13308     ELSE
 13309        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13310     END-IF
 13311     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13312                                    PY-BILLED-DATE
 13313                                    PY-AR-DATE
 13314                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 245
* EL6311.cbl
 13315                                    PY-CHECK-WRITTEN-DT
 13316     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13317                                    PY-CHECK-QUE-SEQUENCE
 13318     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13319     PERFORM WITH TEST AFTER
 13320        UNTIL (NOT RESP-DUPKEY)
 13321           AND (NOT RESP-DUPREC)
 13322
 13323* EXEC CICS WRITE
 13324*          DATASET    (FILE-ID-ERPYAJ)
 13325*          FROM       (PENDING-PAY-ADJ)
 13326*          RIDFLD     (ERPYAJ-KEY)
 13327*          RESP       (WS-RESPONSE)
 13328*       END-EXEC
 13329     MOVE LENGTH OF
 13330      PENDING-PAY-ADJ
 13331       TO DFHEIV11
 13332*    MOVE '&$ L                  ''  N#00012131' TO DFHEIV0
 13333     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13334     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13335     MOVE X'204E233030303132313331' TO DFHEIV0(25:11)
 13336     CALL 'kxdfhei1' USING DFHEIV0,
 13337           FILE-ID-ERPYAJ,
 13338           PENDING-PAY-ADJ,
 13339           DFHEIV11,
 13340           ERPYAJ-KEY,
 13341           DFHEIV99,
 13342           DFHEIV99
 13343     MOVE EIBRESP  TO WS-RESPONSE
 13344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13345        IF RESP-DUPKEY OR RESP-DUPREC
 13346           ADD +1                TO ERPYAJ-SEQ-NO
 13347           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13348        END-IF
 13349     END-PERFORM
 13350     .
 13351 1610-EXIT.
 13352     EXIT.
 13353 1620-ADD-ERPYAJ-DLR-REC.
 13354     MOVE 'C'                    TO ERPYAJ-TYPE
 13355     IF REVERSAL
 13356        MOVE 'R'                 TO ERPYAJ-TYPE
 13357     END-IF
 13358     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13359                                    ERPYAJ-ACCOUNT
 13360     ADD +1                      TO ERPYAJ-SEQ-NO
 13361     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13362     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13363     IF PB-CARRIER = '2'
 13364        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13365     ELSE
 13366        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13367     END-IF
 13368     PERFORM WITH TEST AFTER
 13369        UNTIL (NOT RESP-DUPKEY)
 13370           AND (NOT RESP-DUPREC)
 13371
 13372* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 246
* EL6311.cbl
 13373*          DATASET    (FILE-ID-ERPYAJ)
 13374*          FROM       (PENDING-PAY-ADJ)
 13375*          RIDFLD     (ERPYAJ-KEY)
 13376*          RESP       (WS-RESPONSE)
 13377*       END-EXEC
 13378     MOVE LENGTH OF
 13379      PENDING-PAY-ADJ
 13380       TO DFHEIV11
 13381*    MOVE '&$ L                  ''  N#00012163' TO DFHEIV0
 13382     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13383     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13384     MOVE X'204E233030303132313633' TO DFHEIV0(25:11)
 13385     CALL 'kxdfhei1' USING DFHEIV0,
 13386           FILE-ID-ERPYAJ,
 13387           PENDING-PAY-ADJ,
 13388           DFHEIV11,
 13389           ERPYAJ-KEY,
 13390           DFHEIV99,
 13391           DFHEIV99
 13392     MOVE EIBRESP  TO WS-RESPONSE
 13393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13394        IF RESP-DUPKEY OR RESP-DUPREC
 13395           ADD +1                TO ERPYAJ-SEQ-NO
 13396           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13397        END-IF
 13398     END-PERFORM
 13399     .
 13400 1620-EXIT.
 13401     EXIT.
 13402 1700-SQUEEZE-IT-IN.
 13403     IF (N1 > CN-BILLING-END-LINE-NO)
 13404        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13405           N1 = +1
 13406           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13407           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13408              IF PI-COMPANY-ID = 'DCC'
 13409                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13410              ELSE
 13411                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13412              END-IF
 13413              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13414              MOVE +2 TO N1
 13415           END-IF
 13416        END-PERFORM
 13417     ELSE
 13418        IF (N1 < CN-BILLING-START-LINE-NO)
 13419           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13420              N1 = +10
 13421              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13422              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13423                 IF PI-COMPANY-ID = 'DCC'
 13424                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13425                 ELSE
 13426                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13427                 END-IF
 13428                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13429                 MOVE +9 TO N1
 13430              END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 247
* EL6311.cbl
 13431           END-PERFORM
 13432        END-IF
 13433     END-IF
 13434     .
 13435 1700-EXIT.
 13436     EXIT.
 13437 1800-REMOVE-CERT-NOTES.
 13438     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13439                                 TO ERNOTE-KEY
 13440
 13441* EXEC CICS READ
 13442*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13443*       DATASET    (FILE-ID-ERNOTE)
 13444*       RIDFLD     (ERNOTE-KEY)
 13445*       RESP       (WS-RESPONSE)
 13446*       UPDATE
 13447*    END-EXEC
 13448*    MOVE '&"S        EU         (  N#00012215' TO DFHEIV0
 13449     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13450     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13451     MOVE X'204E233030303132323135' TO DFHEIV0(25:11)
 13452     CALL 'kxdfhei1' USING DFHEIV0,
 13453           FILE-ID-ERNOTE,
 13454           DFHEIV20,
 13455           DFHEIV99,
 13456           ERNOTE-KEY,
 13457           DFHEIV99,
 13458           DFHEIV99,
 13459           DFHEIV99
 13460     SET ADDRESS OF CERTIFICATE-NOTE TO
 13461         DFHEIV20
 13462     MOVE EIBRESP  TO WS-RESPONSE
 13463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13464     IF RESP-NORMAL
 13465        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13466           (N1 > +10)
 13467           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13468           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13469        END-PERFORM
 13470        IF N1 < +11
 13471           MOVE SPACES              TO CN-LINE (N1)
 13472           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13473              N1 <= CN-BILLING-END-LINE-NO
 13474              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13475              IF CN-BILLING-END-LINE-NO <
 13476                               CN-BILLING-START-LINE-NO
 13477                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13478                                     CN-BILLING-START-LINE-NO
 13479              END-IF
 13480              PERFORM 1820-SQUEEZE-ERNOTE
 13481                                  THRU 1820-EXIT
 13482           END-IF
 13483           IF CN-LINES = SPACES
 13484
 13485* EXEC CICS DELETE
 13486*                DATASET    (FILE-ID-ERNOTE)
 13487*                RESP       (WS-RESPONSE)
 13488*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 248
* EL6311.cbl
 13489*    MOVE '&(                    &  N#00012242' TO DFHEIV0
 13490     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13491     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13492     MOVE X'204E233030303132323432' TO DFHEIV0(25:11)
 13493     CALL 'kxdfhei1' USING DFHEIV0,
 13494           FILE-ID-ERNOTE,
 13495           DFHEIV99,
 13496           DFHEIV99,
 13497           DFHEIV99,
 13498           DFHEIV99
 13499     MOVE EIBRESP  TO WS-RESPONSE
 13500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13501              IF RESP-NORMAL
 13502                 MOVE 'D'        TO WS-NOTE-SW
 13503                 PERFORM 1520-UPDATE-ELCERT
 13504                                 THRU 1520-EXIT
 13505              END-IF
 13506           ELSE
 13507
 13508* EXEC CICS REWRITE
 13509*                DATASET    (FILE-ID-ERNOTE)
 13510*                FROM       (CERTIFICATE-NOTE)
 13511*                RESP       (WS-RESPONSE)
 13512*             END-EXEC
 13513     MOVE LENGTH OF
 13514      CERTIFICATE-NOTE
 13515       TO DFHEIV11
 13516*    MOVE '&& L                  %  N#00012252' TO DFHEIV0
 13517     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13518     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13519     MOVE X'204E233030303132323532' TO DFHEIV0(25:11)
 13520     CALL 'kxdfhei1' USING DFHEIV0,
 13521           FILE-ID-ERNOTE,
 13522           CERTIFICATE-NOTE,
 13523           DFHEIV11,
 13524           DFHEIV99
 13525     MOVE EIBRESP  TO WS-RESPONSE
 13526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13527           END-IF
 13528        END-IF
 13529     END-IF
 13530     .
 13531 1800-EXIT.
 13532     EXIT.
 13533 1820-SQUEEZE-ERNOTE.
 13534     MOVE CN-BILLING-START-LINE-NO TO N2
 13535     IF N2 = 0
 13536         MOVE +1                 TO N2
 13537     END-IF
 13538     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13539        (N1 > +9)
 13540        IF CN-LINE (N1) = SPACES
 13541           MOVE CN-LINE (N1 + +1)
 13542                                 TO CN-LINE (N1)
 13543           MOVE SPACES           TO CN-LINE (N1 + +1)
 13544        END-IF
 13545     END-PERFORM
 13546     .
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 249
* EL6311.cbl
 13547 1820-EXIT.
 13548     EXIT.
 13549 1900-DELETE-ERPYAJ.
 13550     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13551     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13552     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13553     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13554     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13555     MOVE +10                    TO ERPYAJ-SEQ-NO
 13556     MOVE 'R'                    TO ERPYAJ-TYPE
 13557     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13558
 13559* EXEC CICS STARTBR
 13560*       DATASET    (FILE-ID-ERPYAJ)
 13561*       RIDFLD     (ERPYAJ-KEY)
 13562*       RESP       (WS-RESPONSE)
 13563*    END-EXEC
 13564     MOVE 0
 13565       TO DFHEIV11
 13566*    MOVE '&,         G          &  N#00012288' TO DFHEIV0
 13567     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13568     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13569     MOVE X'204E233030303132323838' TO DFHEIV0(25:11)
 13570     CALL 'kxdfhei1' USING DFHEIV0,
 13571           FILE-ID-ERPYAJ,
 13572           ERPYAJ-KEY,
 13573           DFHEIV99,
 13574           DFHEIV11,
 13575           DFHEIV99
 13576     MOVE EIBRESP  TO WS-RESPONSE
 13577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13578     IF RESP-NORMAL
 13579        CONTINUE
 13580     ELSE
 13581        GO TO 1900-GET-DEALER
 13582     END-IF
 13583     .
 13584 1900-READNEXT-ERPYAJ-B.
 13585*  GET THE BANK ERPYAJ RECORD
 13586
 13587* EXEC CICS READNEXT
 13588*       DATASET    (FILE-ID-ERPYAJ)
 13589*       RIDFLD     (ERPYAJ-KEY)
 13590*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13591*       RESP       (WS-RESPONSE)
 13592*    END-EXEC
 13593     MOVE 0
 13594       TO DFHEIV11
 13595*    MOVE '&.S                   )  N#00012301' TO DFHEIV0
 13596     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13597     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13598     MOVE X'204E233030303132333031' TO DFHEIV0(25:11)
 13599     CALL 'kxdfhei1' USING DFHEIV0,
 13600           FILE-ID-ERPYAJ,
 13601           DFHEIV20,
 13602           DFHEIV99,
 13603           ERPYAJ-KEY,
 13604           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 250
* EL6311.cbl
 13605           DFHEIV11,
 13606           DFHEIV99,
 13607           DFHEIV99
 13608     SET ADDRESS OF PENDING-PAY-ADJ TO
 13609         DFHEIV20
 13610     MOVE EIBRESP  TO WS-RESPONSE
 13611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13612     IF RESP-NORMAL
 13613        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13614           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13615              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13616                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13617
 13618* EXEC CICS READ
 13619*                   DATASET    (FILE-ID-ERPYAJ)
 13620*                   RIDFLD     (ERPYAJ-KEY)
 13621*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13622*                   RESP       (WS-RESPONSE)
 13623*                   UPDATE
 13624*                END-EXEC
 13625*    MOVE '&"S        EU         (  N#00012312' TO DFHEIV0
 13626     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13627     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13628     MOVE X'204E233030303132333132' TO DFHEIV0(25:11)
 13629     CALL 'kxdfhei1' USING DFHEIV0,
 13630           FILE-ID-ERPYAJ,
 13631           DFHEIV20,
 13632           DFHEIV99,
 13633           ERPYAJ-KEY,
 13634           DFHEIV99,
 13635           DFHEIV99,
 13636           DFHEIV99
 13637     SET ADDRESS OF PENDING-PAY-ADJ TO
 13638         DFHEIV20
 13639     MOVE EIBRESP  TO WS-RESPONSE
 13640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13641                 IF RESP-NORMAL
 13642
 13643* EXEC CICS DELETE
 13644*                      DATASET   (FILE-ID-ERPYAJ)
 13645*                      RESP      (WS-RESPONSE)
 13646*                   END-EXEC
 13647*    MOVE '&(                    &  N#00012320' TO DFHEIV0
 13648     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13649     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13650     MOVE X'204E233030303132333230' TO DFHEIV0(25:11)
 13651     CALL 'kxdfhei1' USING DFHEIV0,
 13652           FILE-ID-ERPYAJ,
 13653           DFHEIV99,
 13654           DFHEIV99,
 13655           DFHEIV99,
 13656           DFHEIV99
 13657     MOVE EIBRESP  TO WS-RESPONSE
 13658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13659                 END-IF
 13660              ELSE
 13661                 SET REVERSAL    TO TRUE
 13662                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 251
* EL6311.cbl
 13663                                 THRU 1600-EXIT
 13664                 GO TO 1900-EXIT
 13665              END-IF
 13666           ELSE
 13667              GO TO 1900-READNEXT-ERPYAJ-B
 13668           END-IF
 13669        END-IF
 13670
 13671* EXEC CICS ENDBR
 13672*          DATASET   (FILE-ID-ERPYAJ)
 13673*       END-EXEC
 13674     MOVE 0
 13675       TO DFHEIV11
 13676*    MOVE '&2                    $   #00012335' TO DFHEIV0
 13677     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13678     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13679     MOVE X'2020233030303132333335' TO DFHEIV0(25:11)
 13680     CALL 'kxdfhei1' USING DFHEIV0,
 13681           FILE-ID-ERPYAJ,
 13682           DFHEIV11,
 13683           DFHEIV99
 13684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13685     END-IF
 13686     .
 13687 1900-GET-DEALER.
 13688     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13689     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13690     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13691     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13692     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13693     MOVE +10                    TO ERPYAJ-SEQ-NO
 13694     MOVE 'C'                    TO ERPYAJ-TYPE
 13695     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13696
 13697* EXEC CICS STARTBR
 13698*       DATASET    (FILE-ID-ERPYAJ)
 13699*       RIDFLD     (ERPYAJ-KEY)
 13700*       RESP       (WS-RESPONSE)
 13701*    END-EXEC
 13702     MOVE 0
 13703       TO DFHEIV11
 13704*    MOVE '&,         G          &  N#00012349' TO DFHEIV0
 13705     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13706     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13707     MOVE X'204E233030303132333439' TO DFHEIV0(25:11)
 13708     CALL 'kxdfhei1' USING DFHEIV0,
 13709           FILE-ID-ERPYAJ,
 13710           ERPYAJ-KEY,
 13711           DFHEIV99,
 13712           DFHEIV11,
 13713           DFHEIV99
 13714     MOVE EIBRESP  TO WS-RESPONSE
 13715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13716     IF RESP-NORMAL
 13717        CONTINUE
 13718     ELSE
 13719        GO TO 1900-EXIT
 13720     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 252
* EL6311.cbl
 13721     .
 13722 1900-READNEXT-ERPYAJ-D.
 13723*  GET THE DEALER ERPYAJ RECORD
 13724
 13725* EXEC CICS READNEXT
 13726*       DATASET    (FILE-ID-ERPYAJ)
 13727*       RIDFLD     (ERPYAJ-KEY)
 13728*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13729*       RESP       (WS-RESPONSE)
 13730*    END-EXEC
 13731     MOVE 0
 13732       TO DFHEIV11
 13733*    MOVE '&.S                   )  N#00012362' TO DFHEIV0
 13734     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13735     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13736     MOVE X'204E233030303132333632' TO DFHEIV0(25:11)
 13737     CALL 'kxdfhei1' USING DFHEIV0,
 13738           FILE-ID-ERPYAJ,
 13739           DFHEIV20,
 13740           DFHEIV99,
 13741           ERPYAJ-KEY,
 13742           DFHEIV99,
 13743           DFHEIV11,
 13744           DFHEIV99,
 13745           DFHEIV99
 13746     SET ADDRESS OF PENDING-PAY-ADJ TO
 13747         DFHEIV20
 13748     MOVE EIBRESP  TO WS-RESPONSE
 13749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13750     IF RESP-NORMAL
 13751        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13752           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13753              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13754                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13755
 13756* EXEC CICS READ
 13757*                   DATASET    (FILE-ID-ERPYAJ)
 13758*                   RIDFLD     (ERPYAJ-KEY)
 13759*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13760*                   RESP       (WS-RESPONSE)
 13761*                   UPDATE
 13762*                END-EXEC
 13763*    MOVE '&"S        EU         (  N#00012373' TO DFHEIV0
 13764     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13765     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13766     MOVE X'204E233030303132333733' TO DFHEIV0(25:11)
 13767     CALL 'kxdfhei1' USING DFHEIV0,
 13768           FILE-ID-ERPYAJ,
 13769           DFHEIV20,
 13770           DFHEIV99,
 13771           ERPYAJ-KEY,
 13772           DFHEIV99,
 13773           DFHEIV99,
 13774           DFHEIV99
 13775     SET ADDRESS OF PENDING-PAY-ADJ TO
 13776         DFHEIV20
 13777     MOVE EIBRESP  TO WS-RESPONSE
 13778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 253
* EL6311.cbl
 13779                 IF RESP-NORMAL
 13780
 13781* EXEC CICS DELETE
 13782*                      DATASET   (FILE-ID-ERPYAJ)
 13783*                      RESP      (WS-RESPONSE)
 13784*                   END-EXEC
 13785*    MOVE '&(                    &  N#00012381' TO DFHEIV0
 13786     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13787     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13788     MOVE X'204E233030303132333831' TO DFHEIV0(25:11)
 13789     CALL 'kxdfhei1' USING DFHEIV0,
 13790           FILE-ID-ERPYAJ,
 13791           DFHEIV99,
 13792           DFHEIV99,
 13793           DFHEIV99,
 13794           DFHEIV99
 13795     MOVE EIBRESP  TO WS-RESPONSE
 13796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13797                 END-IF
 13798              ELSE
 13799                 SET REVERSAL    TO TRUE
 13800              END-IF
 13801           ELSE
 13802              GO TO 1900-READNEXT-ERPYAJ-D
 13803           END-IF
 13804        END-IF
 13805
 13806* EXEC CICS ENDBR
 13807*          DATASET   (FILE-ID-ERPYAJ)
 13808*       END-EXEC
 13809     MOVE 0
 13810       TO DFHEIV11
 13811*    MOVE '&2                    $   #00012393' TO DFHEIV0
 13812     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13813     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13814     MOVE X'2020233030303132333933' TO DFHEIV0(25:11)
 13815     CALL 'kxdfhei1' USING DFHEIV0,
 13816           FILE-ID-ERPYAJ,
 13817           DFHEIV11,
 13818           DFHEIV99
 13819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13820     END-IF
 13821     .
 13822 1900-EXIT.
 13823     EXIT.
 13824******************************************************************
 13825*            C A N C E L   M A I N L I N E                       *
 13826******************************************************************
 13827
 13828 2000-CANCEL-MAINLINE.
 13829     IF PI-DISPLAY-ORIGINAL-BATCH
 13830        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 13831           MOVE ER-0023             TO EMI-ERROR
 13832           MOVE -1                  TO CMAINTL
 13833           MOVE AL-UABON            TO CMAINTA
 13834           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13835           GO TO 8200-SEND-DATAONLY
 13836        ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 254
* EL6311.cbl
 13837           NEXT SENTENCE
 13838     ELSE
 13839        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 13840           MOVE ER-0023             TO EMI-ERROR
 13841           MOVE -1                  TO CMAINTL
 13842           MOVE AL-UABON            TO CMAINTA
 13843           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13844           GO TO 8200-SEND-DATAONLY.
 13845
 13846     IF CMAINTI = 'S'
 13847        GO TO 2100-SHOW-REQUEST.
 13848
 13849     IF NOT MODIFY-CAP
 13850         MOVE 'UPDATE'       TO SM-READ
 13851         PERFORM 9995-SECURITY-VIOLATION
 13852         MOVE ER-0070        TO EMI-ERROR
 13853         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13854         GO TO 8100-SEND-INITIAL-MAP.
 13855
 13856     IF CMAINTL GREATER THAN ZEROS
 13857        IF PI-PF6-FUNCTION
 13858           IF CMAINTI NOT = 'A'
 13859              MOVE AL-UABON  TO CMAINTA
 13860              MOVE -1        TO CMAINTL
 13861              MOVE ER-2260   TO EMI-ERROR
 13862              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13863              GO TO 8200-SEND-DATAONLY.
 13864
 13865     IF CCERTNOL = ZEROS
 13866       AND (CMAINTI = 'C' OR 'K' OR 'D')
 13867         NEXT SENTENCE
 13868     ELSE
 13869         IF CCERTNOL NOT = ZEROS
 13870             MOVE AL-UANON       TO CCERTNOA
 13871         ELSE
 13872             MOVE -1             TO CCERTNOL
 13873             MOVE  1             TO SET-CURSOR-SW
 13874             MOVE ER-2218       TO EMI-ERROR
 13875             MOVE AL-UABON       TO CCERTNOA
 13876             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13877
 13878     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 13879        NEXT SENTENCE
 13880     ELSE
 13881        IF CEFFDTL NOT = ZEROS
 13882           MOVE AL-UNNON         TO CEFFDTA
 13883           MOVE CEFFDTI TO DEEDIT-FIELD
 13884           PERFORM 8600-DEEDIT
 13885           MOVE 4                TO DC-OPTION-CODE
 13886           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13887           PERFORM 9700-DATE-LINK
 13888           IF NO-CONVERSION-ERROR
 13889              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 13890              ELSE
 13891              MOVE -1            TO CEFFDTL
 13892              MOVE  1            TO SET-CURSOR-SW
 13893              MOVE ER-2226      TO EMI-ERROR
 13894              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 255
* EL6311.cbl
 13895              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13896          ELSE
 13897          MOVE -1                 TO CEFFDTL
 13898          MOVE  1                 TO SET-CURSOR-SW
 13899          MOVE ER-2220            TO EMI-ERROR
 13900          MOVE AL-UNBON           TO CEFFDTA
 13901          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13902
 13903     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 13904
 13905     IF CCERTNOL NOT = ZEROS
 13906        MOVE CCERTNOI                TO WS-NEW-PRIME
 13907     ELSE
 13908        MOVE SPACES                  TO WS-NEW-PRIME.
 13909
 13910     IF CSUFIXL NOT = ZEROS
 13911        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 13912     ELSE
 13913        MOVE SPACE                   TO WS-NEW-SUFFIX.
 13914
 13915     IF CEFFDTL NOT = ZEROS
 13916        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 13917     ELSE
 13918        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 13919
 13920     IF CMAINTI = 'A' OR 'K' OR 'S'
 13921        NEXT SENTENCE
 13922     ELSE
 13923        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 13924        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 13925           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 13926           WS-PB-RECORD-TYPE NOT = '2'
 13927           IF CMAINTI = 'C'
 13928              MOVE ER-2287          TO EMI-ERROR
 13929              MOVE -1               TO CCERTNOL
 13930              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 13931              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13932              GO TO 8200-SEND-DATAONLY
 13933             ELSE
 13934              MOVE ER-2260          TO EMI-ERROR
 13935              MOVE -1               TO CCERTNOL
 13936              MOVE AL-UABON         TO CCERTNOA
 13937              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13938              GO TO 8200-SEND-DATAONLY.
 13939
 13940     IF CMAINTI = 'D'
 13941        GO TO 2400-DELETE-CANCEL-ROUTINE.
 13942
 13943     IF CLSTNML GREATER THAN ZEROS
 13944         MOVE AL-UANON           TO CLSTNMA.
 13945
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 256
* EL6311.cbl
 13947
 13948******************************************************************
 13949*                                                                *
 13950*           E D I T   C A N C E L   C O V E R A G E S            *
 13951*                                                                *
 13952******************************************************************
 13953
 13954 2015-EDIT-COVERAGES.
 13955     IF CCANDT1L      GREATER THAN ZEROS OR
 13956        CREFND1L      GREATER THAN ZEROS OR
 13957        CCANDT2L      GREATER THAN ZEROS OR
 13958        CREFND2L      GREATER THAN ZEROS OR
 13959        CMTHD1L       GREATER THAN ZEROS OR
 13960        CMTHD2L       GREATER THAN ZEROS OR
 13961        CLIVESL       GREATER THAN ZEROS OR
 13962        CPAYEEL       GREATER THAN ZEROS OR
 13963        CFORCEL       GREATER THAN ZEROS OR
 13964        CBILCDL       GREATER THAN ZEROS OR
 13965        CCANREAL      GREATER THAN ZEROS
 13966            NEXT SENTENCE
 13967         ELSE
 13968            GO TO 2030-EDIT-COMPLETE.
 13969
 13970     IF CCANDT1L = ZEROS
 13971        AND (CMAINTI = 'C' OR 'K')
 13972        NEXT SENTENCE
 13973     ELSE
 13974        IF CCANDT1L      GREATER THAN ZEROS
 13975            MOVE AL-UNNON            TO CCANDT1A
 13976            IF CCANDT1I = SPACES
 13977               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 13978            ELSE
 13979               MOVE CCANDT1I            TO DEEDIT-FIELD
 13980               PERFORM 8600-DEEDIT
 13981               IF DEEDIT-FIELD-V0   NUMERIC
 13982                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13983                  MOVE 4                TO DC-OPTION-CODE
 13984                  PERFORM 9700-DATE-LINK
 13985                  IF NO-CONVERSION-ERROR
 13986                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 13987                  ELSE
 13988                      MOVE -1        TO CCANDT1L
 13989                      MOVE ER-2227   TO EMI-ERROR
 13990                      MOVE AL-UNBON  TO CCANDT1A
 13991                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13992               ELSE
 13993                  MOVE -1         TO CCANDT1L
 13994                  MOVE ER-2223    TO EMI-ERROR
 13995                  MOVE AL-UNBON   TO CCANDT1A
 13996                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13997        ELSE
 13998            IF CREFND1L GREATER THAN ZEROS
 13999               MOVE -1             TO CCANDT1L
 14000               MOVE ER-2222        TO EMI-ERROR
 14001               MOVE AL-UNBOF       TO CCANDT1A
 14002               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14003
 14004     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 257
* EL6311.cbl
 14005        AND (CMAINTI = 'C' OR 'K')
 14006         NEXT SENTENCE
 14007     ELSE
 14008         IF CREFND1L NOT = ZEROS
 14009            MOVE AL-UNNON        TO CREFND1A
 14010
 14011* EXEC CICS BIF DEEDIT
 14012*               FIELD  (CREFND1I)
 14013*               LENGTH (11)
 14014*           END-EXEC
 14015     MOVE 11
 14016       TO DFHEIV11
 14017*    MOVE '@"L                   #   #00012586' TO DFHEIV0
 14018     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14019     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14020     MOVE X'2020233030303132353836' TO DFHEIV0(25:11)
 14021     CALL 'kxdfhei1' USING DFHEIV0,
 14022           CREFND1I,
 14023           DFHEIV11
 14024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14025            MOVE CREFND1I        TO WS-CREFND1
 14026*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14027*           PERFORM 8600-DEEDIT
 14028*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14029            IF WS-CREFND1  = ZEROS
 14030               AND CMAINTI = 'A'
 14031             MOVE ER-2437        TO EMI-ERROR
 14032             MOVE -1             TO CREFND1L
 14033             MOVE AL-UNBON       TO CREFND1A
 14034             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14035
 14036     IF CCANREAL > +0
 14037        MOVE AL-UANON            TO CCANREAA
 14038        IF CCANREAI = 'R' OR ' '
 14039           CONTINUE
 14040        ELSE
 14041           MOVE ER-9841        TO EMI-ERROR
 14042           MOVE -1             TO CCANREAL
 14043           MOVE AL-UABON       TO CCANREAA
 14044           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14045        END-IF
 14046     END-IF
 14047     IF CMTHD1L EQUAL +0
 14048        NEXT SENTENCE
 14049     ELSE
 14050        IF CMTHD1L NOT = +0
 14051           MOVE AL-UNNON        TO CMTHD1A
 14052           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14053                         OR '5' OR '6' OR '8' OR '9'
 14054                         OR 'R' OR ' '
 14055              NEXT SENTENCE
 14056           ELSE
 14057              MOVE ER-0582        TO EMI-ERROR
 14058              MOVE -1             TO CMTHD1L
 14059              MOVE AL-UNBON       TO CMTHD1A
 14060              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14061
 14062     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 258
* EL6311.cbl
 14063        AND (CMAINTI = 'C' OR 'K')
 14064         NEXT SENTENCE
 14065     ELSE
 14066         IF CCANDT2L  GREATER THAN ZEROS
 14067             MOVE AL-UNNON       TO CCANDT2A
 14068             IF CCANDT2I = SPACES
 14069                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14070             ELSE
 14071                MOVE CCANDT2I       TO DEEDIT-FIELD
 14072                PERFORM 8600-DEEDIT
 14073                IF DEEDIT-FIELD-V0   NUMERIC
 14074                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14075                   MOVE 4                TO DC-OPTION-CODE
 14076                   PERFORM 9700-DATE-LINK
 14077                   IF NO-CONVERSION-ERROR
 14078                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14079                   ELSE
 14080                      MOVE -1       TO CCANDT2L
 14081                      MOVE ER-2227  TO EMI-ERROR
 14082                      MOVE AL-UNBON TO CCANDT2A
 14083                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14084                ELSE
 14085                   MOVE -1         TO CCANDT2L
 14086                   MOVE ER-2223    TO EMI-ERROR
 14087                   MOVE AL-UNBON   TO CCANDT2A
 14088                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14089         ELSE
 14090            IF CREFND2L GREATER THAN ZEROS
 14091               MOVE -1             TO CCANDT2L
 14092               MOVE ER-2222        TO EMI-ERROR
 14093               MOVE AL-UNBOF       TO CCANDT2A
 14094               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14095
 14096     IF CREFND2L = ZEROS
 14097        AND (CMAINTI = 'C' OR 'K')
 14098         NEXT SENTENCE
 14099     ELSE
 14100         IF CREFND2L NOT = ZEROS
 14101            MOVE AL-UNNON        TO CREFND2A
 14102
 14103* EXEC CICS BIF DEEDIT
 14104*               FIELD  (CREFND2I)
 14105*               LENGTH (11)
 14106*           END-EXEC
 14107     MOVE 11
 14108       TO DFHEIV11
 14109*    MOVE '@"L                   #   #00012667' TO DFHEIV0
 14110     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14111     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14112     MOVE X'2020233030303132363637' TO DFHEIV0(25:11)
 14113     CALL 'kxdfhei1' USING DFHEIV0,
 14114           CREFND2I,
 14115           DFHEIV11
 14116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14117            MOVE CREFND2I        TO WS-CREFND2
 14118*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14119*           PERFORM 8600-DEEDIT
 14120*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 259
* EL6311.cbl
 14121            IF WS-CREFND2  = ZEROS
 14122               AND CMAINTI = 'A'
 14123             MOVE ER-2437        TO EMI-ERROR
 14124             MOVE -1             TO CREFND2L
 14125             MOVE AL-UNBON       TO CREFND2A
 14126             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14127
 14128     IF CMTHD2L EQUAL +0
 14129        NEXT SENTENCE
 14130     ELSE
 14131        IF CMTHD2L NOT = +0
 14132           MOVE AL-UNNON        TO CMTHD2A
 14133           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14134                         OR '5' OR '6' OR '8' OR '9'
 14135                         OR ' ' OR 'R'
 14136              NEXT SENTENCE
 14137           ELSE
 14138              MOVE ER-0582        TO EMI-ERROR
 14139              MOVE -1             TO CMTHD2L
 14140              MOVE AL-UNBON       TO CMTHD2A
 14141              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14142
 14143     IF CLIVESL GREATER THAN ZEROS
 14144         MOVE CLIVESI            TO DEEDIT-FIELD
 14145         PERFORM 8600-DEEDIT
 14146         IF DEEDIT-FIELD-V0 NUMERIC
 14147             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14148             MOVE AL-UNNON       TO CLIVESA
 14149         ELSE
 14150             MOVE -1             TO CLIVESL
 14151             MOVE AL-UNBON       TO CLIVESA
 14152             MOVE ER-2223        TO EMI-ERROR
 14153             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14154
 14155     IF CFORCEL  NOT = ZEROS
 14156         IF FORCE-CAP
 14157            MOVE AL-UANON            TO CFORCEA
 14158         ELSE
 14159            MOVE ER-2945             TO EMI-ERROR
 14160            MOVE AL-UABON            TO CFORCEA
 14161            MOVE -1                  TO CFORCEL
 14162            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14163
 14164     IF CPAYEEL GREATER THAN ZEROS
 14165        MOVE AL-UANON            TO CPAYEEA.
 14166
 14167     IF CBILCDL NOT = ZEROS
 14168        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14169                             AND 'A' AND 'B' AND 'E'
 14170           MOVE ER-2225              TO EMI-ERROR
 14171           MOVE AL-UABON             TO CBILCDA
 14172           MOVE -1                   TO CBILCDL
 14173           MOVE  1                   TO SET-CURSOR-SW
 14174           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14175        ELSE
 14176           MOVE AL-UANON             TO CBILCDA.
 14177
 14178 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 260
* EL6311.cbl
 14179     IF EMI-ERROR = ZEROS
 14180         NEXT SENTENCE
 14181     ELSE
 14182         GO TO 8200-SEND-DATAONLY.
 14183
 14184     IF CMAINTI = 'A'
 14185        GO TO 2200-ADD-CANCEL-ROUTINE.
 14186
 14187     IF CMAINTI = 'C'
 14188        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14189
 14190     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14191
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 261
* EL6311.cbl
 14193
 14194******************************************************************
 14195*                                                                *
 14196*                   S H O W   C A N C E L                        *
 14197*                                                                *
 14198******************************************************************
 14199
 14200 2100-SHOW-REQUEST.
 14201     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14202
 14203     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14204        MOVE -1                  TO CMAINTL
 14205        GO TO 8200-SEND-DATAONLY.
 14206
 14207     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14208
 14209     IF CSUFIXL NOT = ZEROS
 14210        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14211       ELSE
 14212        MOVE SPACE            TO WS-NEW-SUFFIX.
 14213
 14214     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14215     PERFORM 8600-DEEDIT.
 14216     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14217     MOVE '4'                    TO DC-OPTION-CODE.
 14218     PERFORM 9700-DATE-LINK.
 14219     IF DATE-CONVERSION-ERROR
 14220        MOVE ER-0348             TO EMI-ERROR
 14221        MOVE -1                  TO CEFFDTL
 14222        MOVE AL-UABON            TO CEFFDTA
 14223        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14224        GO TO 8200-SEND-DATAONLY
 14225     ELSE
 14226        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14227        MOVE AL-UANON            TO CEFFDTA
 14228        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14229
 14230     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14231
 14232     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14233        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14234        MOVE 'Y'                    TO WS-SHOW-SW
 14235        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14236           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14237        ELSE
 14238           IF PI-FILE-BROWSE
 14239              GO TO 4300-BROWSE-FILE-FORWARD
 14240           ELSE
 14241              IF PI-CSR-BROWSE
 14242                 GO TO 4200-BROWSE-CSR-FORWARD
 14243              ELSE
 14244                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14245     ELSE
 14246        GO TO 3900-RE-DISPLAY-RECORD.
 14247
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 262
* EL6311.cbl
 14249
 14250
 14251******************************************************************
 14252*                                                                *
 14253*            A D D   C A N C E L   R O U T I N E                 *
 14254*                                                                *
 14255******************************************************************
 14256
 14257 2200-ADD-CANCEL-ROUTINE.
 14258     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14259
 14260
 14261* EXEC CICS GETMAIN
 14262*        SET     (ADDRESS OF PENDING-BUSINESS)
 14263*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14264*    END-EXEC.
 14265*    MOVE '," L                  $   #00012814' TO DFHEIV0
 14266     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14267     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14268     MOVE X'2020233030303132383134' TO DFHEIV0(25:11)
 14269     CALL 'kxdfhei1' USING DFHEIV0,
 14270           DFHEIV20,
 14271           ERPNDB-RECORD-LENGTH,
 14272           DFHEIV99
 14273     SET ADDRESS OF PENDING-BUSINESS TO
 14274         DFHEIV20
 14275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14276
 14277
 14278
 14279* EXEC CICS HANDLE CONDITION
 14280*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14281*    END-EXEC.
 14282*    MOVE '"$I                   ! 3 #00012819' TO DFHEIV0
 14283     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14284     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14285     MOVE X'3320233030303132383139' TO DFHEIV0(25:11)
 14286     CALL 'kxdfhei1' USING DFHEIV0
 14287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14288
 14289
 14290     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14291     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14292     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14293
 14294
 14295* EXEC CICS READ
 14296*        INTO    (PENDING-BUSINESS)
 14297*        DATASET (FILE-ID-ERPNDB)
 14298*        RIDFLD  (ERPNDB-KEY)
 14299*    END-EXEC.
 14300     MOVE LENGTH OF
 14301      PENDING-BUSINESS
 14302       TO DFHEIV11
 14303*    MOVE '&"IL       E          (   #00012827' TO DFHEIV0
 14304     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14305     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14306     MOVE X'2020233030303132383237' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 263
* EL6311.cbl
 14307     CALL 'kxdfhei1' USING DFHEIV0,
 14308           FILE-ID-ERPNDB,
 14309           PENDING-BUSINESS,
 14310           DFHEIV11,
 14311           ERPNDB-KEY,
 14312           DFHEIV99,
 14313           DFHEIV99,
 14314           DFHEIV99
 14315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14316
 14317
 14318     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14319
 14320     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14321     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14322     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14323     MOVE SPACES                 TO PENDING-BUSINESS.
 14324     MOVE 'PB'                   TO PB-RECORD-ID.
 14325     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14326     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14327     MOVE SPACES                 TO PB-CERT-SFX.
 14328     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14329     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14330                                    PB-ALT-CHG-SEQ-NO.
 14331
 14332     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14333     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14334     MOVE '2'                    TO PB-RECORD-TYPE.
 14335
 14336     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14337     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14338
 14339
 14340     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14341                                    PB-ALT-CHG-SEQ-NO
 14342                                    PB-C-LF-REF-CALC
 14343                                    PB-C-AH-REF-CALC
 14344                                    PB-C-LF-RFND-CLP
 14345                                    PB-C-AH-RFND-CLP
 14346                                    PB-CI-INSURED-AGE
 14347                                    PB-CI-LF-TERM
 14348                                    PB-CI-AH-TERM
 14349                                    PB-CI-LF-BENEFIT-CD
 14350                                    PB-CI-LF-BENEFIT-AMT
 14351                                    PB-CI-LF-ALT-BENEFIT-AMT
 14352                                    PB-CI-LF-PREMIUM-AMT
 14353                                    PB-CI-LF-ALT-PREMIUM-AMT
 14354                                    PB-CI-AH-BENEFIT-CD
 14355                                    PB-CI-AH-BENEFIT-AMT
 14356                                    PB-CI-AH-PREMIUM-AMT
 14357                                    PB-CI-PAY-FREQUENCY
 14358                                    PB-CI-LOAN-APR
 14359                                    PB-CI-LOAN-TERM
 14360                                    PB-CI-LIFE-COMMISSION
 14361                                    PB-CI-AH-COMMISSION
 14362                                    PB-CI-CURR-SEQ
 14363                                    PB-CI-AH-CANCEL-AMT
 14364                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 264
* EL6311.cbl
 14365                                    PB-CI-RATE-DEV-PCT-LF
 14366                                    PB-CI-RATE-DEV-PCT-AH
 14367                                    PB-CI-EXTENTION-DAYS
 14368                                    PB-CI-TERM-IN-DAYS
 14369                                    PB-CI-LIVES
 14370                                    PB-CI-LF-CRIT-PER
 14371                                    PB-CI-AH-CRIT-PER
 14372                                    PB-C-LF-REM-TERM
 14373                                    PB-C-AH-REM-TERM
 14374                                    PB-CHG-COUNT
 14375                                    PB-LF-BILLED-AMTS
 14376                                    PB-AH-BILLED-AMTS
 14377                                    PB-C-NH-INT-ON-REFS
 14378*                                   PB-C-MICROFILM-NO
 14379                                    PB-CALC-TOLERANCE.
 14380
 14381     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14382                                    PB-CI-AH-SETTLEMENT-DT
 14383                                    PB-CI-DEATH-DT
 14384                                    PB-CI-LF-PRIOR-CANCEL-DT
 14385                                    PB-CI-AH-PRIOR-CANCEL-DT
 14386                                    PB-CI-ENTRY-DT
 14387                                    PB-CI-LF-EXPIRE-DT
 14388                                    PB-CI-AH-EXPIRE-DT
 14389                                    PB-CI-LOAN-1ST-PMT-DT
 14390                                    PB-C-LF-CANCEL-DT
 14391                                    PB-C-AH-CANCEL-DT
 14392                                    PB-CREDIT-ACCEPT-DT
 14393                                    PB-BILLED-DT
 14394                                    PB-ACCT-EFF-DT
 14395                                    PB-ACCT-EXP-DT.
 14396
 14397     MOVE 'X'                    TO PB-FATAL-FLAG.
 14398
 14399     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14400
 14401     IF CSUFIXL     GREATER THAN ZEROS
 14402        MOVE CSUFIXI             TO PB-CERT-SFX.
 14403
 14404*    IF CMICRNOL  GREATER  ZEROS
 14405*        IF CMICRNOI  NUMERIC
 14406*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14407*            MOVE AL-UNNON       TO  CMICRNOA
 14408*        ELSE
 14409*            MOVE -1             TO  CMICRNOL
 14410*            MOVE AL-UNBON       TO  CMICRNOA
 14411*            MOVE ER-2701        TO  EMI-ERROR
 14412*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14413
 14414     IF CLSTNML     GREATER THAN ZEROS
 14415        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14416
 14417     IF CCANREAL > ZEROS
 14418        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14419     END-IF
 14420     IF CPCYNL > ZEROS
 14421        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14422     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 265
* EL6311.cbl
 14423     IF CCANDT1L    GREATER THAN ZEROS
 14424        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14425
 14426     IF CCANDT2L    GREATER THAN ZEROS
 14427        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14428
 14429     IF CMTHD1L    GREATER THAN +0
 14430        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14431
 14432     IF CMTHD2L    GREATER THAN +0
 14433        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14434
 14435     IF CREFND1L    GREATER THAN ZEROS
 14436        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14437        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14438     ELSE
 14439        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14440
 14441     IF CREFND2L    GREATER THAN ZEROS
 14442        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14443        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14444     ELSE
 14445        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14446
 14447     IF CLIVESL     GREATER THAN ZEROS
 14448        MOVE WS-CLIVES           TO PB-C-LIVES
 14449     ELSE
 14450        MOVE ZEROS               TO PB-C-LIVES.
 14451
 14452     IF CPAYEEL     GREATER THAN ZEROS
 14453        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14454
 14455     IF CFORCEL     GREATER THAN ZEROS
 14456        MOVE CFORCEI             TO PB-FORCE-CODE.
 14457
 14458     IF CBILCDL     GREATER THAN ZEROS
 14459        MOVE CBILCDI             TO PB-RECORD-BILL.
 14460
 14461*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14462
 14463 2260-WRITE-PB-RECORD.
 14464     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14465                                    PB-INPUT-BY.
 14466     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14467     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14468                                    PB-INPUT-DT.
 14469
 14470     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14471     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14472                                    PB-CONTROL-BY-ORIG-BATCH.
 14473
 14474     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14475     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14476     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14477     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14478     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14479
 14480     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 266
* EL6311.cbl
 14481
 14482     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14483
 14484     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14485     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14486     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14487
 14488     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14489     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14490
 14491 2275-WRITE-PENDING-BUSINESS.
 14492     MOVE 'A'                    TO JP-RECORD-TYPE.
 14493     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14494     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14495     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14496
 14497
 14498* EXEC CICS HANDLE CONDITION
 14499*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14500*    END-EXEC.
 14501*    MOVE '"$%                   ! 4 #00013012' TO DFHEIV0
 14502     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14503     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14504     MOVE X'3420233030303133303132' TO DFHEIV0(25:11)
 14505     CALL 'kxdfhei1' USING DFHEIV0
 14506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14507
 14508
 14509
 14510* EXEC CICS WRITE
 14511*        DATASET (FILE-ID-ERPNDB)
 14512*        FROM    (PENDING-BUSINESS)
 14513*        RIDFLD  (PB-CONTROL-PRIMARY)
 14514*    END-EXEC.
 14515     MOVE LENGTH OF
 14516      PENDING-BUSINESS
 14517       TO DFHEIV11
 14518*    MOVE '&$ L                  ''   #00013016' TO DFHEIV0
 14519     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14520     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14521     MOVE X'2020233030303133303136' TO DFHEIV0(25:11)
 14522     CALL 'kxdfhei1' USING DFHEIV0,
 14523           FILE-ID-ERPNDB,
 14524           PENDING-BUSINESS,
 14525           DFHEIV11,
 14526           PB-CONTROL-PRIMARY,
 14527           DFHEIV99,
 14528           DFHEIV99
 14529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14530
 14531
 14532     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14533
 14534     PERFORM 8400-LOG-JOURNAL-RECORD.
 14535
 14536******************************************************************
 14537*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14538******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 267
* EL6311.cbl
 14539
 14540     display ' made it to add orig CANCEL cert '
 14541     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14542     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14543     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14544     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14545
 14546
 14547* EXEC CICS READ
 14548*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14549*        DATASET (FILE-ID-ELCERT)
 14550*        RIDFLD  (ELCERT-KEY)
 14551*        RESP    (WS-RESPONSE)
 14552*    END-EXEC.
 14553*    MOVE '&"S        E          (  N#00013036' TO DFHEIV0
 14554     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14555     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14556     MOVE X'204E233030303133303336' TO DFHEIV0(25:11)
 14557     CALL 'kxdfhei1' USING DFHEIV0,
 14558           FILE-ID-ELCERT,
 14559           DFHEIV20,
 14560           DFHEIV99,
 14561           ELCERT-KEY,
 14562           DFHEIV99,
 14563           DFHEIV99,
 14564           DFHEIV99
 14565     SET ADDRESS OF CERTIFICATE-MASTER TO
 14566         DFHEIV20
 14567     MOVE EIBRESP  TO WS-RESPONSE
 14568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14569
 14570
 14571     IF NOT RESP-NORMAL
 14572        GO TO 2276-BYPASS-CRTO
 14573     END-IF
 14574
 14575     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14576     MOVE ' '                    TO WS-ERMAIL-SW
 14577
 14578
 14579* EXEC CICS READ
 14580*       DATASET   (FILE-ID-ERMAIL)
 14581*       SET       (ADDRESS OF MAILING-DATA)
 14582*       RIDFLD    (ERMAIL-KEY)
 14583*       RESP      (WS-RESPONSE)
 14584*    END-EXEC
 14585*    MOVE '&"S        E          (  N#00013050' TO DFHEIV0
 14586     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14587     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14588     MOVE X'204E233030303133303530' TO DFHEIV0(25:11)
 14589     CALL 'kxdfhei1' USING DFHEIV0,
 14590           FILE-ID-ERMAIL,
 14591           DFHEIV20,
 14592           DFHEIV99,
 14593           ERMAIL-KEY,
 14594           DFHEIV99,
 14595           DFHEIV99,
 14596           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 268
* EL6311.cbl
 14597     SET ADDRESS OF MAILING-DATA TO
 14598         DFHEIV20
 14599     MOVE EIBRESP  TO WS-RESPONSE
 14600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14601
 14602     IF RESP-NORMAL
 14603        SET ERMAIL-FOUND TO TRUE
 14604     END-IF
 14605
 14606     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14607
 14608     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14609     MOVE 'OC'                   TO OC-RECORD-ID
 14610     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14611                                 TO OC-CONTROL-PRIMARY (1:33)
 14612     MOVE 'I'                    TO OC-RECORD-TYPE
 14613     MOVE +4096                  TO OC-KEY-SEQ-NO
 14614     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14615     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14616     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14617
 14618     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14619     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14620     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14621     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14622     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14623     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14624     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14625     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14626     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14627     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14628     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14629     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14630     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14631     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14632     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14633     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14634     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14635     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14636     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14637     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14638     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14639     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14640     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14641     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14642     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14643     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14644     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14645     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14646     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14647     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14648     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14649     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14650
 14651     IF ERMAIL-FOUND
 14652        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14653     END-IF
 14654     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 269
* EL6311.cbl
 14655        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14656                           OC-INS-AGE-DEFAULT-FLAG
 14657        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14658                           OC-JNT-AGE-DEFAULT-FLAG
 14659     END-IF
 14660     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14661     .
 14662 2275-WRITE-ELCRTO.
 14663
 14664
 14665* EXEC CICS WRITE
 14666*       DATASET   ('ELCRTO')
 14667*       FROM      (ORIGINAL-CERTIFICATE)
 14668*       RIDFLD    (OC-CONTROL-PRIMARY)
 14669*       RESP      (WS-RESPONSE)
 14670*    END-EXEC
 14671     MOVE LENGTH OF
 14672      ORIGINAL-CERTIFICATE
 14673       TO DFHEIV11
 14674     MOVE 'ELCRTO' TO DFHEIV1
 14675*    MOVE '&$ L                  ''  N#00013119' TO DFHEIV0
 14676     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14677     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14678     MOVE X'204E233030303133313139' TO DFHEIV0(25:11)
 14679     CALL 'kxdfhei1' USING DFHEIV0,
 14680           DFHEIV1,
 14681           ORIGINAL-CERTIFICATE,
 14682           DFHEIV11,
 14683           OC-CONTROL-PRIMARY,
 14684           DFHEIV99,
 14685           DFHEIV99
 14686     MOVE EIBRESP  TO WS-RESPONSE
 14687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14688
 14689     display ' just wrote 2275 ' ws-response
 14690     IF RESP-DUPKEY
 14691        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14692        GO TO 2275-WRITE-ELCRTO
 14693     ELSE
 14694        IF NOT RESP-NORMAL
 14695           MOVE -1               TO BMAINTL
 14696           MOVE ER-7450          TO EMI-ERROR
 14697           PERFORM 9900-ERROR-FORMAT
 14698                                 THRU 9900-EXIT
 14699           GO TO 8200-SEND-DATAONLY
 14700        END-IF
 14701     END-IF.
 14702
 14703 2276-BYPASS-CRTO.
 14704******************************************************************
 14705*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14706******************************************************************
 14707
 14708
 14709* EXEC CICS READ
 14710*        INTO    (PENDING-BUSINESS)
 14711*        DATASET (FILE-ID-ERPNDB)
 14712*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 270
* EL6311.cbl
 14713*        UPDATE
 14714*    END-EXEC.
 14715     MOVE LENGTH OF
 14716      PENDING-BUSINESS
 14717       TO DFHEIV11
 14718*    MOVE '&"IL       EU         (   #00013145' TO DFHEIV0
 14719     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14720     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14721     MOVE X'2020233030303133313435' TO DFHEIV0(25:11)
 14722     CALL 'kxdfhei1' USING DFHEIV0,
 14723           FILE-ID-ERPNDB,
 14724           PENDING-BUSINESS,
 14725           DFHEIV11,
 14726           ERPNDB-KEY,
 14727           DFHEIV99,
 14728           DFHEIV99,
 14729           DFHEIV99
 14730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14731
 14732
 14733     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14734     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14735     MOVE 'B'                    TO JP-RECORD-TYPE.
 14736     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14737
 14738     PERFORM 8400-LOG-JOURNAL-RECORD.
 14739
 14740     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14741
 14742
 14743* EXEC CICS REWRITE
 14744*        DATASET (FILE-ID-ERPNDB)
 14745*        FROM    (PENDING-BUSINESS)
 14746*    END-EXEC.
 14747     MOVE LENGTH OF
 14748      PENDING-BUSINESS
 14749       TO DFHEIV11
 14750*    MOVE '&& L                  %   #00013161' TO DFHEIV0
 14751     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14752     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14753     MOVE X'2020233030303133313631' TO DFHEIV0(25:11)
 14754     CALL 'kxdfhei1' USING DFHEIV0,
 14755           FILE-ID-ERPNDB,
 14756           PENDING-BUSINESS,
 14757           DFHEIV11,
 14758           DFHEIV99
 14759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14760
 14761
 14762     MOVE 'C'                    TO JP-RECORD-TYPE.
 14763     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14764
 14765     PERFORM 8400-LOG-JOURNAL-RECORD.
 14766
 14767     IF WS-ERRORS-PRESENT
 14768        GO TO 3900-RE-DISPLAY-RECORD.
 14769
 14770     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 271
* EL6311.cbl
 14771     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14772     MOVE LOW-VALUES             TO EL631CI.
 14773     MOVE  -1                    TO CMAINTL.
 14774     GO TO 8100-SEND-INITIAL-MAP.
 14775
 14776 2280-BATCH-HDR-NOT-FOUND.
 14777     MOVE -1                     TO BMAINTL.
 14778     MOVE ER-7450                TO EMI-ERROR.
 14779     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14780     GO TO 8200-SEND-DATAONLY.
 14781
 14782 2290-DUPLICATE-ALT-INDEX.
 14783
 14784******************************************************************
 14785*                                                                *
 14786*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14787*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14788*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14789*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14790*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14791*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14792*                                                                *
 14793******************************************************************
 14794
 14795     IF LCP-ONCTR-02 =  0
 14796         ADD 1 TO LCP-ONCTR-02
 14797        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14798
 14799     ADD +1                      TO WS-SEQ-NO-COUNTER.
 14800
 14801     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 14802         NEXT SENTENCE
 14803     ELSE
 14804         ADD +1 TO PB-BATCH-SEQ-NO
 14805                   PB-CSR-BATCH-SEQ-NO
 14806         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 14807         GO TO 2275-WRITE-PENDING-BUSINESS.
 14808
 14809     MOVE -1                     TO CCERTNOL.
 14810     MOVE AL-UABON               TO CCERTNOA.
 14811     MOVE AL-UNBON               TO CEFFDTA.
 14812
 14813     MOVE 1                      TO EMI-SUB
 14814                                    EMI-SWITCH1
 14815                                    EMI-SWITCH-AREA-1
 14816                                    EMI-SWITCH-AREA-2.
 14817
 14818     MOVE SPACES                 TO EMI-ERROR-LINES.
 14819
 14820
 14821* EXEC CICS SYNCPOINT ROLLBACK
 14822*    END-EXEC.
 14823*    MOVE '6"R                   !   #00013224' TO DFHEIV0
 14824     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14825     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14826     MOVE X'2020233030303133323234' TO DFHEIV0(25:11)
 14827     CALL 'kxdfhei1' USING DFHEIV0
 14828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 272
* EL6311.cbl
 14829
 14830
 14831     MOVE ER-2247                TO EMI-ERROR.
 14832     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14833     GO TO 8200-SEND-DATAONLY.
 14834
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 273
* EL6311.cbl
 14836
 14837******************************************************************
 14838*                                                                *
 14839*          C H A N G E   C A N C E L   R O U T I N E             *
 14840*                                                                *
 14841******************************************************************
 14842
 14843***************************************************************
 14844*                                                             *
 14845*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 14846*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 14847*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 14848*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 14849*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 14850*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 14851*     5. LINK TO THE EDIT ROUTINE.                            *
 14852*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 14853*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 14854*              THE EDIT ROUTINE.                              *
 14855*     7. REWRITE THE NEW ISSUE                                *
 14856*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 14857*                                                             *
 14858***************************************************************
 14859 2300-CHANGE-CANCEL-ROUTINE.
 14860     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 14861
 14862     IF CCHGL NOT = ZEROS
 14863        MOVE ER-2196             TO EMI-ERROR
 14864        MOVE AL-UABON            TO CMAINTA
 14865        MOVE -1                  TO CMAINTL
 14866        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14867        GO TO 8200-SEND-DATAONLY.
 14868
 14869     MOVE CCERTNOI               TO WS-NEW-PRIME.
 14870
 14871     IF CSUFIXL NOT = ZEROS
 14872        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 14873     ELSE
 14874        MOVE SPACE               TO WS-NEW-SUFFIX.
 14875
 14876     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14877     PERFORM 8600-DEEDIT.
 14878     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14879     MOVE '4'                    TO DC-OPTION-CODE.
 14880
 14881     PERFORM 9700-DATE-LINK.
 14882
 14883     IF DATE-CONVERSION-ERROR
 14884        MOVE ER-0348             TO EMI-ERROR
 14885        MOVE -1                  TO CEFFDTL
 14886        MOVE AL-UABON            TO CEFFDTA
 14887        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14888        GO TO 8200-SEND-DATAONLY
 14889     ELSE
 14890        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14891        MOVE AL-UANON            TO CEFFDTA
 14892        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14893
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 274
* EL6311.cbl
 14894 2325-PROCESS-CANCEL-CHANGES.
 14895
 14896* EXEC CICS HANDLE CONDITION
 14897*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 14898*    END-EXEC.
 14899*    MOVE '"$I                   ! 5 #00013291' TO DFHEIV0
 14900     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14901     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14902     MOVE X'3520233030303133323931' TO DFHEIV0(25:11)
 14903     CALL 'kxdfhei1' USING DFHEIV0
 14904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14905
 14906
 14907     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 14908     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14909     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14910
 14911
 14912* EXEC CICS GETMAIN
 14913*        SET      (ADDRESS OF PENDING-BUSINESS)
 14914*        LENGTH   (ERPNDB-RECORD-LENGTH)
 14915*        INITIMG  (GETMAIN-SPACE)
 14916*     END-EXEC.
 14917*    MOVE ',"IL                  $   #00013299' TO DFHEIV0
 14918     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14919     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14920     MOVE X'2020233030303133323939' TO DFHEIV0(25:11)
 14921     CALL 'kxdfhei1' USING DFHEIV0,
 14922           DFHEIV20,
 14923           ERPNDB-RECORD-LENGTH,
 14924           GETMAIN-SPACE
 14925     SET ADDRESS OF PENDING-BUSINESS TO
 14926         DFHEIV20
 14927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14928
 14929
 14930
 14931* EXEC CICS READ
 14932*        INTO    (PENDING-BUSINESS)
 14933*        DATASET (FILE-ID-ERPNDB)
 14934*        RIDFLD  (ERPNDB-KEY)
 14935*    END-EXEC.
 14936     MOVE LENGTH OF
 14937      PENDING-BUSINESS
 14938       TO DFHEIV11
 14939*    MOVE '&"IL       E          (   #00013305' TO DFHEIV0
 14940     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14942     MOVE X'2020233030303133333035' TO DFHEIV0(25:11)
 14943     CALL 'kxdfhei1' USING DFHEIV0,
 14944           FILE-ID-ERPNDB,
 14945           PENDING-BUSINESS,
 14946           DFHEIV11,
 14947           ERPNDB-KEY,
 14948           DFHEIV99,
 14949           DFHEIV99,
 14950           DFHEIV99
 14951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 275
* EL6311.cbl
 14952
 14953
 14954     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14955
 14956
 14957* EXEC CICS HANDLE CONDITION
 14958*         NOTFND     (2385-REC-NOT-FOUND)
 14959*    END-EXEC.
 14960*    MOVE '"$I                   ! 6 #00013313' TO DFHEIV0
 14961     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14962     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14963     MOVE X'3620233030303133333133' TO DFHEIV0(25:11)
 14964     CALL 'kxdfhei1' USING DFHEIV0
 14965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14966
 14967
 14968**********************************************************
 14969*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 14970*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 14971**********************************************************
 14972
 14973
 14974* EXEC CICS READ
 14975*        DATASET (FILE-ID-ERPNDB)
 14976*        INTO    (PENDING-BUSINESS)
 14977*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 14978*    END-EXEC.
 14979     MOVE LENGTH OF
 14980      PENDING-BUSINESS
 14981       TO DFHEIV11
 14982*    MOVE '&"IL       E          (   #00013322' TO DFHEIV0
 14983     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14985     MOVE X'2020233030303133333232' TO DFHEIV0(25:11)
 14986     CALL 'kxdfhei1' USING DFHEIV0,
 14987           FILE-ID-ERPNDB,
 14988           PENDING-BUSINESS,
 14989           DFHEIV11,
 14990           PI-PREV-CONTROL-PRIMARY,
 14991           DFHEIV99,
 14992           DFHEIV99,
 14993           DFHEIV99
 14994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14995
 14996
 14997********** DO NOT ALLOW CHANGES IF THRU A/R
 14998     IF BMAINTI = 'C'
 14999         IF PB-EL860-INTERNAL-PROCESS
 15000             MOVE ER-4005          TO EMI-ERROR
 15001             MOVE -1               TO BMAINTL
 15002             MOVE AL-UABON         TO BMAINTA
 15003             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15004             GO TO 8200-SEND-DATAONLY.
 15005**********
 15006
 15007     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15008        MOVE -1                 TO CMAINTL
 15009        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 276
* EL6311.cbl
 15010        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15011        GO TO 8200-SEND-DATAONLY.
 15012
 15013     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15014        MOVE ER-2196             TO EMI-ERROR
 15015        MOVE AL-UABON            TO CMAINTA
 15016        MOVE -1                  TO CMAINTL
 15017        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15018        GO TO 8200-SEND-DATAONLY.
 15019     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15020
 15021     IF PB-BILLED-DT = LOW-VALUES AND
 15022        PB-CHG-COUNT = ZEROS
 15023        NEXT SENTENCE
 15024     ELSE
 15025        IF (CREFND1L GREATER THAN ZEROS AND
 15026            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15027           OR
 15028           (CREFND2L GREATER THAN ZEROS AND
 15029            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15030           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15031
 15032
 15033* EXEC CICS READ
 15034*        DATASET (FILE-ID-ERPNDB)
 15035*        INTO    (PENDING-BUSINESS)
 15036*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15037*        UPDATE
 15038*    END-EXEC.
 15039     MOVE LENGTH OF
 15040      PENDING-BUSINESS
 15041       TO DFHEIV11
 15042*    MOVE '&"IL       EU         (   #00013363' TO DFHEIV0
 15043     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15044     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15045     MOVE X'2020233030303133333633' TO DFHEIV0(25:11)
 15046     CALL 'kxdfhei1' USING DFHEIV0,
 15047           FILE-ID-ERPNDB,
 15048           PENDING-BUSINESS,
 15049           DFHEIV11,
 15050           PI-PREV-CONTROL-PRIMARY,
 15051           DFHEIV99,
 15052           DFHEIV99,
 15053           DFHEIV99
 15054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15055
 15056
 15057     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15058     MOVE 'B'                    TO JP-RECORD-TYPE
 15059     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15060     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15061
 15062     PERFORM 8400-LOG-JOURNAL-RECORD.
 15063
 15064     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15065          PB-CHG-COUNT NOT = ZEROS
 15066        IF (CREFND1L GREATER THAN ZEROS AND
 15067            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 277
* EL6311.cbl
 15068           OR
 15069           (CREFND2L GREATER THAN ZEROS AND
 15070            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15071            ADD +1                      TO PB-CHG-COUNT
 15072            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15073
 15074*    IF CMICRNOL  GREATER  ZEROS
 15075*        IF CMICRNOI  NUMERIC
 15076*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15077*            MOVE AL-UNNON       TO  CMICRNOA
 15078*        ELSE
 15079*            MOVE -1             TO  CMICRNOL
 15080*            MOVE AL-UNBON       TO  CMICRNOA
 15081*            MOVE ER-2701        TO  EMI-ERROR
 15082*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15083
 15084     IF CSUFIXL GREATER THAN ZEROS
 15085        MOVE CSUFIXI             TO PB-CERT-SFX.
 15086
 15087     IF CLSTNML GREATER THAN ZEROS
 15088         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15089
 15090     IF CCANREAL > ZEROS
 15091        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15092     END-IF
 15093     IF CPCYNL > ZEROS
 15094        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15095     END-IF
 15096     IF CCANDT1L    GREATER THAN ZEROS
 15097        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15098
 15099     IF CCANDT2L    GREATER THAN ZEROS
 15100        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15101
 15102     IF CMTHD1L    GREATER THAN +0
 15103        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15104
 15105     IF CMTHD2L    GREATER THAN +0
 15106        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15107
 15108     IF CREFND1L    GREATER THAN ZEROS
 15109        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15110        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15111        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15112        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15113
 15114     IF CREFND2L    GREATER THAN ZEROS
 15115        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15116        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15117        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15118        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15119
 15120     IF CLIVESL     GREATER THAN ZEROS
 15121        MOVE WS-CLIVES           TO PB-C-LIVES.
 15122
 15123     IF CPAYEEL     GREATER THAN ZEROS
 15124        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15125
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 278
* EL6311.cbl
 15126     IF CFORCEL     GREATER THAN ZEROS
 15127        MOVE CFORCEI             TO PB-FORCE-CODE.
 15128
 15129     IF CBILCDL     GREATER THAN ZEROS
 15130        MOVE CBILCDI             TO PB-RECORD-BILL.
 15131
 15132 2360-REWRITE-PB-RECORD.
 15133     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15134     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15135     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15136     MOVE 'C'                    TO JP-RECORD-TYPE.
 15137     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15138     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15139     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15140
 15141     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15142
 15143     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15144     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15145
 15146     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15147
 15148     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15149
 15150     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15151     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15152     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15153
 15154     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15155     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15156
 15157 2375-REWRITE-PENDING-BUSINESS.
 15158     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15159     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15160     MOVE 'C'                    TO JP-RECORD-TYPE.
 15161     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15162
 15163
 15164* EXEC CICS REWRITE
 15165*        DATASET (FILE-ID-ERPNDB)
 15166*        FROM    (PENDING-BUSINESS)
 15167*    END-EXEC.
 15168     MOVE LENGTH OF
 15169      PENDING-BUSINESS
 15170       TO DFHEIV11
 15171*    MOVE '&& L                  %   #00013476' TO DFHEIV0
 15172     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15173     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15174     MOVE X'2020233030303133343736' TO DFHEIV0(25:11)
 15175     CALL 'kxdfhei1' USING DFHEIV0,
 15176           FILE-ID-ERPNDB,
 15177           PENDING-BUSINESS,
 15178           DFHEIV11,
 15179           DFHEIV99
 15180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15181
 15182
 15183     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 279
* EL6311.cbl
 15184
 15185******************************************************************
 15186*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15187******************************************************************
 15188
 15189     display ' made it to update orig cancel cert '
 15190
 15191     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15192     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15193     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15194     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15195
 15196
 15197* EXEC CICS READ
 15198*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15199*        DATASET (FILE-ID-ELCERT)
 15200*        RIDFLD  (ELCERT-KEY)
 15201*        RESP    (WS-RESPONSE)
 15202*    END-EXEC.
 15203*    MOVE '&"S        E          (  N#00013494' TO DFHEIV0
 15204     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15205     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15206     MOVE X'204E233030303133343934' TO DFHEIV0(25:11)
 15207     CALL 'kxdfhei1' USING DFHEIV0,
 15208           FILE-ID-ELCERT,
 15209           DFHEIV20,
 15210           DFHEIV99,
 15211           ELCERT-KEY,
 15212           DFHEIV99,
 15213           DFHEIV99,
 15214           DFHEIV99
 15215     SET ADDRESS OF CERTIFICATE-MASTER TO
 15216         DFHEIV20
 15217     MOVE EIBRESP  TO WS-RESPONSE
 15218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15219
 15220
 15221     IF NOT RESP-NORMAL
 15222        GO TO 2376-BYPASS-CRTO
 15223     END-IF
 15224
 15225
 15226     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15227     MOVE ' '                    TO WS-ERMAIL-SW
 15228
 15229
 15230* EXEC CICS READ
 15231*       DATASET   (FILE-ID-ERMAIL)
 15232*       SET       (ADDRESS OF MAILING-DATA)
 15233*       RIDFLD    (ERMAIL-KEY)
 15234*       RESP      (WS-RESPONSE)
 15235*    END-EXEC
 15236*    MOVE '&"S        E          (  N#00013509' TO DFHEIV0
 15237     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15238     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15239     MOVE X'204E233030303133353039' TO DFHEIV0(25:11)
 15240     CALL 'kxdfhei1' USING DFHEIV0,
 15241           FILE-ID-ERMAIL,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 280
* EL6311.cbl
 15242           DFHEIV20,
 15243           DFHEIV99,
 15244           ERMAIL-KEY,
 15245           DFHEIV99,
 15246           DFHEIV99,
 15247           DFHEIV99
 15248     SET ADDRESS OF MAILING-DATA TO
 15249         DFHEIV20
 15250     MOVE EIBRESP  TO WS-RESPONSE
 15251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15252
 15253     IF RESP-NORMAL
 15254        SET ERMAIL-FOUND TO TRUE
 15255     END-IF
 15256
 15257     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15258
 15259     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15260                                 TO ELCRTO-KEY
 15261     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15262     MOVE +0                     TO ELCRTO-SEQ-NO
 15263
 15264
 15265* EXEC CICS READ
 15266*       DATASET   ('ELCRTO')
 15267*       INTO      (ORIGINAL-CERTIFICATE)
 15268*       RIDFLD    (ELCRTO-KEY)
 15269*       GTEQ
 15270*       RESP      (WS-RESPONSE)
 15271*    END-EXEC
 15272     MOVE LENGTH OF
 15273      ORIGINAL-CERTIFICATE
 15274       TO DFHEIV11
 15275     MOVE 'ELCRTO' TO DFHEIV1
 15276*    MOVE '&"IL       G          (  N#00013527' TO DFHEIV0
 15277     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15278     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15279     MOVE X'204E233030303133353237' TO DFHEIV0(25:11)
 15280     CALL 'kxdfhei1' USING DFHEIV0,
 15281           DFHEIV1,
 15282           ORIGINAL-CERTIFICATE,
 15283           DFHEIV11,
 15284           ELCRTO-KEY,
 15285           DFHEIV99,
 15286           DFHEIV99,
 15287           DFHEIV99
 15288     MOVE EIBRESP  TO WS-RESPONSE
 15289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15290
 15291     display ' just read gteq ' ws-response
 15292     IF RESP-NORMAL
 15293        AND (OC-CONTROL-PRIMARY (1:33) =
 15294                 PB-CONTROL-BY-ACCOUNT (1:33))
 15295        AND (OC-RECORD-TYPE = 'I')
 15296        display ' resp norm, key =, type i '
 15297        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15298           display ' end proc blank '
 15299           display ' csr edit session ' PI-CSR-SESSION-SW
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 281
* EL6311.cbl
 15300           IF NOT CSR-EDIT-SESSION
 15301
 15302* EXEC CICS READ
 15303*                DATASET   ('ELCRTO')
 15304*                INTO      (ORIGINAL-CERTIFICATE)
 15305*                RIDFLD    (OC-CONTROL-PRIMARY)
 15306*                UPDATE
 15307*                RESP      (WS-RESPONSE)
 15308*             END-EXEC
 15309     MOVE LENGTH OF
 15310      ORIGINAL-CERTIFICATE
 15311       TO DFHEIV11
 15312     MOVE 'ELCRTO' TO DFHEIV1
 15313*    MOVE '&"IL       EU         (  N#00013545' TO DFHEIV0
 15314     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15315     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15316     MOVE X'204E233030303133353435' TO DFHEIV0(25:11)
 15317     CALL 'kxdfhei1' USING DFHEIV0,
 15318           DFHEIV1,
 15319           ORIGINAL-CERTIFICATE,
 15320           DFHEIV11,
 15321           OC-CONTROL-PRIMARY,
 15322           DFHEIV99,
 15323           DFHEIV99,
 15324           DFHEIV99
 15325     MOVE EIBRESP  TO WS-RESPONSE
 15326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15327              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15328              IF RESP-NORMAL
 15329                 display ' good read upd '
 15330                 IF OC-ISSUE-TRAN-IND = 'N'
 15331                    MOVE CM-INSURED-LAST-NAME   TO
 15332                         OC-INS-LAST-NAME
 15333                    MOVE CM-INSURED-FIRST-NAME  TO
 15334                         OC-INS-FIRST-NAME
 15335                    MOVE CM-INSURED-INITIAL2    TO
 15336                         OC-INS-MIDDLE-INIT
 15337                    MOVE CM-INSURED-ISSUE-AGE   TO
 15338                         OC-INS-AGE
 15339                    MOVE CM-JT-LAST-NAME        TO
 15340                         OC-JNT-LAST-NAME
 15341                    MOVE CM-JT-FIRST-NAME       TO
 15342                         OC-JNT-FIRST-NAME
 15343                    MOVE CM-JT-INITIAL          TO
 15344                         OC-JNT-MIDDLE-INIT
 15345                    MOVE CM-INSURED-JOINT-AGE   TO
 15346                         OC-JNT-AGE
 15347                    MOVE CM-LF-BENEFIT-CD       TO
 15348                         OC-LF-BENCD
 15349                    MOVE CM-LF-ORIG-TERM        TO
 15350                         OC-LF-TERM
 15351                    MOVE CM-LF-BENEFIT-AMT      TO
 15352                         OC-LF-BEN-AMT
 15353                    MOVE CM-LF-PREMIUM-AMT      TO
 15354                         OC-LF-PRM-AMT
 15355                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15356                         OC-LF-ALT-BEN-AMT
 15357                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 282
* EL6311.cbl
 15358                         OC-LF-ALT-PRM-AMT
 15359                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15360                         OC-LF-EXP-DT
 15361                    MOVE CM-LIFE-COMM-PCT       TO
 15362                         OC-LF-COMM-PCT
 15363                    MOVE CM-AH-BENEFIT-CD       TO
 15364                         OC-AH-BENCD
 15365                    MOVE CM-AH-ORIG-TERM        TO
 15366                         OC-AH-TERM
 15367                    MOVE CM-AH-BENEFIT-AMT      TO
 15368                         OC-AH-BEN-AMT
 15369                    MOVE CM-AH-PREMIUM-AMT      TO
 15370                         OC-AH-PRM-AMT
 15371                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15372                         OC-AH-EXP-DT
 15373                    MOVE CM-AH-COMM-PCT         TO
 15374                         OC-AH-COMM-PCT
 15375                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15376                         OC-AH-CP
 15377                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15378                         OC-1ST-PMT-DT
 15379                 END-IF
 15380                 MOVE PB-C-LF-CANCEL-DT      TO
 15381                         OC-LF-CANCEL-DT
 15382                 MOVE PB-C-LF-CANCEL-AMT     TO
 15383                         OC-LF-CANCEL-AMT
 15384                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15385                         OC-LF-ITD-CANCEL-AMT
 15386                 MOVE PB-C-AH-CANCEL-DT      TO
 15387                         OC-AH-CANCEL-DT
 15388                 MOVE PB-C-AH-CANCEL-AMT     TO
 15389                         OC-AH-CANCEL-AMT
 15390                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15391                         OC-AH-ITD-CANCEL-AMT
 15392                 MOVE 'Y'                    TO
 15393                         OC-CANCEL-TRAN-IND
 15394                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15395                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15396                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15397                 IF ERMAIL-FOUND
 15398                    MOVE MA-CRED-BENE-NAME
 15399                                 TO OC-CRED-BENE-NAME
 15400                 END-IF
 15401                 IF NOT CERT-TRL-REC-NOT-FOUND
 15402                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15403                           OC-INS-AGE-DEFAULT-FLAG
 15404                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15405                           OC-JNT-AGE-DEFAULT-FLAG
 15406                 END-IF
 15407
 15408* EXEC CICS REWRITE
 15409*                   DATASET   ('ELCRTO')
 15410*                   FROM      (ORIGINAL-CERTIFICATE)
 15411*                   RESP      (WS-RESPONSE)
 15412*                END-EXEC
 15413     MOVE LENGTH OF
 15414      ORIGINAL-CERTIFICATE
 15415       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 283
* EL6311.cbl
 15416     MOVE 'ELCRTO' TO DFHEIV1
 15417*    MOVE '&& L                  %  N#00013632' TO DFHEIV0
 15418     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15419     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15420     MOVE X'204E233030303133363332' TO DFHEIV0(25:11)
 15421     CALL 'kxdfhei1' USING DFHEIV0,
 15422           DFHEIV1,
 15423           ORIGINAL-CERTIFICATE,
 15424           DFHEIV11,
 15425           DFHEIV99
 15426     MOVE EIBRESP  TO WS-RESPONSE
 15427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15428                 display ' just rewrote ' ws-response
 15429              END-IF
 15430           END-IF
 15431        ELSE
 15432           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15433           MOVE 'OC'             TO OC-RECORD-ID
 15434           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15435           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15436           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15437           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15438           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15439           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15440           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15441           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15442           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15443           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15444           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15445           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15446           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15447           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15448           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15449           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15450           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15451           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15452           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15453           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15454           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15455           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15456           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15457           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15458           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15459           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15460           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15461           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15462           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15463           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15464           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15465           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15466           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15467           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15468           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15469           IF ERMAIL-FOUND
 15470              MOVE MA-CRED-BENE-NAME
 15471                                 TO OC-CRED-BENE-NAME
 15472           END-IF
 15473           IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 284
* EL6311.cbl
 15474              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15475                           OC-INS-AGE-DEFAULT-FLAG
 15476              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15477                           OC-JNT-AGE-DEFAULT-FLAG
 15478           END-IF
 15479           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15480
 15481* EXEC CICS WRITE
 15482*             DATASET   ('ELCRTO')
 15483*             FROM      (ORIGINAL-CERTIFICATE)
 15484*             RIDFLD    (OC-CONTROL-PRIMARY)
 15485*             RESP      (WS-RESPONSE)
 15486*          END-EXEC
 15487     MOVE LENGTH OF
 15488      ORIGINAL-CERTIFICATE
 15489       TO DFHEIV11
 15490     MOVE 'ELCRTO' TO DFHEIV1
 15491*    MOVE '&$ L                  ''  N#00013689' TO DFHEIV0
 15492     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15493     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15494     MOVE X'204E233030303133363839' TO DFHEIV0(25:11)
 15495     CALL 'kxdfhei1' USING DFHEIV0,
 15496           DFHEIV1,
 15497           ORIGINAL-CERTIFICATE,
 15498           DFHEIV11,
 15499           OC-CONTROL-PRIMARY,
 15500           DFHEIV99,
 15501           DFHEIV99
 15502     MOVE EIBRESP  TO WS-RESPONSE
 15503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15504        END-IF
 15505     ELSE
 15506        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15507        MOVE 'OC'                TO OC-RECORD-ID
 15508        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15509                                 TO OC-CONTROL-PRIMARY (1:33)
 15510        MOVE 'I'                 TO OC-RECORD-TYPE
 15511        MOVE +4096               TO OC-KEY-SEQ-NO
 15512        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15513        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15514        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15515        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15516        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15517        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15518        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15519        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15520        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15521        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15522        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15523        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15524        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15525        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15526        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15527        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15528        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15529        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15530        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15531        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 285
* EL6311.cbl
 15532        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15533        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15534        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15535        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15536        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15537        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15538        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15539        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15540        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15541        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15542        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15543        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15544        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15545        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15546        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15547        IF ERMAIL-FOUND
 15548           MOVE MA-CRED-BENE-NAME
 15549                                 TO OC-CRED-BENE-NAME
 15550        END-IF
 15551        IF NOT CERT-TRL-REC-NOT-FOUND
 15552           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15553                           OC-INS-AGE-DEFAULT-FLAG
 15554           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15555                           OC-JNT-AGE-DEFAULT-FLAG
 15556        END-IF
 15557        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15558
 15559
 15560* EXEC CICS WRITE
 15561*          DATASET   ('ELCRTO')
 15562*          FROM      (ORIGINAL-CERTIFICATE)
 15563*          RIDFLD    (OC-CONTROL-PRIMARY)
 15564*          RESP      (WS-RESPONSE)
 15565*       END-EXEC
 15566     MOVE LENGTH OF
 15567      ORIGINAL-CERTIFICATE
 15568       TO DFHEIV11
 15569     MOVE 'ELCRTO' TO DFHEIV1
 15570*    MOVE '&$ L                  ''  N#00013750' TO DFHEIV0
 15571     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15572     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15573     MOVE X'204E233030303133373530' TO DFHEIV0(25:11)
 15574     CALL 'kxdfhei1' USING DFHEIV0,
 15575           DFHEIV1,
 15576           ORIGINAL-CERTIFICATE,
 15577           DFHEIV11,
 15578           OC-CONTROL-PRIMARY,
 15579           DFHEIV99,
 15580           DFHEIV99
 15581     MOVE EIBRESP  TO WS-RESPONSE
 15582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15583     END-IF.
 15584
 15585 2376-BYPASS-CRTO.
 15586******************************************************************
 15587*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15588******************************************************************
 15589
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 286
* EL6311.cbl
 15590
 15591* EXEC CICS HANDLE CONDITION
 15592*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15593*    END-EXEC.
 15594*    MOVE '"$I                   ! 7 #00013763' TO DFHEIV0
 15595     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15596     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15597     MOVE X'3720233030303133373633' TO DFHEIV0(25:11)
 15598     CALL 'kxdfhei1' USING DFHEIV0
 15599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15600
 15601
 15602
 15603* EXEC CICS READ
 15604*        INTO    (PENDING-BUSINESS)
 15605*        DATASET (FILE-ID-ERPNDB)
 15606*        RIDFLD  (ERPNDB-KEY)
 15607*        UPDATE
 15608*    END-EXEC.
 15609     MOVE LENGTH OF
 15610      PENDING-BUSINESS
 15611       TO DFHEIV11
 15612*    MOVE '&"IL       EU         (   #00013767' TO DFHEIV0
 15613     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15614     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15615     MOVE X'2020233030303133373637' TO DFHEIV0(25:11)
 15616     CALL 'kxdfhei1' USING DFHEIV0,
 15617           FILE-ID-ERPNDB,
 15618           PENDING-BUSINESS,
 15619           DFHEIV11,
 15620           ERPNDB-KEY,
 15621           DFHEIV99,
 15622           DFHEIV99,
 15623           DFHEIV99
 15624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15625
 15626
 15627     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15628     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15629     MOVE 'B'                    TO JP-RECORD-TYPE.
 15630     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15631
 15632     PERFORM 8400-LOG-JOURNAL-RECORD.
 15633
 15634     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15635
 15636
 15637* EXEC CICS REWRITE
 15638*        DATASET (FILE-ID-ERPNDB)
 15639*        FROM    (PENDING-BUSINESS)
 15640*    END-EXEC.
 15641     MOVE LENGTH OF
 15642      PENDING-BUSINESS
 15643       TO DFHEIV11
 15644*    MOVE '&& L                  %   #00013783' TO DFHEIV0
 15645     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15646     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15647     MOVE X'2020233030303133373833' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 287
* EL6311.cbl
 15648     CALL 'kxdfhei1' USING DFHEIV0,
 15649           FILE-ID-ERPNDB,
 15650           PENDING-BUSINESS,
 15651           DFHEIV11,
 15652           DFHEIV99
 15653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15654
 15655
 15656     MOVE 'C'                    TO JP-RECORD-TYPE.
 15657     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15658
 15659     PERFORM 8400-LOG-JOURNAL-RECORD.
 15660
 15661     IF WS-ERRORS-PRESENT
 15662         GO TO 3900-RE-DISPLAY-RECORD.
 15663
 15664     MOVE ZEROS                  TO EMI-ERROR
 15665     MOVE -1                     TO CMAINTL
 15666     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15667     GO TO 3900-RE-DISPLAY-RECORD.
 15668
 15669 2380-BATCH-HDR-NOT-FOUND.
 15670     MOVE -1                     TO BMAINTL.
 15671     MOVE ER-7450                TO EMI-ERROR.
 15672     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15673     GO TO 8200-SEND-DATAONLY.
 15674
 15675 2385-REC-NOT-FOUND.
 15676     MOVE -1                     TO BMAINTL.
 15677     MOVE ER-7451                TO EMI-ERROR.
 15678     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15679     GO TO 8200-SEND-DATAONLY.
 15680
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 288
* EL6311.cbl
 15682
 15683******************************************************************
 15684*                                                                *
 15685*          D E L E T E   C A N C E L   R O U T I N E             *
 15686*                                                                *
 15687******************************************************************
 15688
 15689 2400-DELETE-CANCEL-ROUTINE.
 15690     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15691
 15692     IF CCHGL NOT = ZEROS
 15693        MOVE ER-2196             TO EMI-ERROR
 15694        MOVE AL-UABON            TO CMAINTA
 15695        MOVE -1                  TO CMAINTL
 15696        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15697        GO TO 8200-SEND-DATAONLY.
 15698
 15699
 15700* EXEC CICS HANDLE CONDITION
 15701*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15702*    END-EXEC.
 15703*    MOVE '"$I                   ! 8 #00013831' TO DFHEIV0
 15704     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15705     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15706     MOVE X'3820233030303133383331' TO DFHEIV0(25:11)
 15707     CALL 'kxdfhei1' USING DFHEIV0
 15708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15709
 15710
 15711     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15712     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15713     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15714
 15715
 15716* EXEC CICS READ
 15717*        SET     (ADDRESS OF PENDING-BUSINESS)
 15718*        DATASET (FILE-ID-ERPNDB)
 15719*        RIDFLD  (ERPNDB-KEY)
 15720*    END-EXEC.
 15721*    MOVE '&"S        E          (   #00013839' TO DFHEIV0
 15722     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15723     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15724     MOVE X'2020233030303133383339' TO DFHEIV0(25:11)
 15725     CALL 'kxdfhei1' USING DFHEIV0,
 15726           FILE-ID-ERPNDB,
 15727           DFHEIV20,
 15728           DFHEIV99,
 15729           ERPNDB-KEY,
 15730           DFHEIV99,
 15731           DFHEIV99,
 15732           DFHEIV99
 15733     SET ADDRESS OF PENDING-BUSINESS TO
 15734         DFHEIV20
 15735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15736
 15737
 15738     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15739
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 289
* EL6311.cbl
 15740     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15741
 15742     IF CSUFIXL NOT = ZEROS
 15743        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15744     ELSE
 15745        MOVE SPACE               TO WS-NEW-SUFFIX.
 15746
 15747     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15748
 15749     PERFORM 8600-DEEDIT.
 15750     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15751     MOVE '4'                    TO DC-OPTION-CODE.
 15752     PERFORM 9700-DATE-LINK.
 15753
 15754     IF DATE-CONVERSION-ERROR
 15755        MOVE ER-0348             TO EMI-ERROR
 15756        MOVE -1                  TO CEFFDTL
 15757        MOVE AL-UABON            TO CEFFDTA
 15758        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15759        GO TO 8200-SEND-DATAONLY
 15760     ELSE
 15761        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15762        MOVE AL-UANON            TO CEFFDTA
 15763        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15764
 15765
 15766* EXEC CICS HANDLE CONDITION
 15767*         NOTFND    (2490-RECORD-NOT-FOUND)
 15768*    END-EXEC.
 15769*    MOVE '"$I                   ! 9 #00013872' TO DFHEIV0
 15770     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15771     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15772     MOVE X'3920233030303133383732' TO DFHEIV0(25:11)
 15773     CALL 'kxdfhei1' USING DFHEIV0
 15774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15775
 15776
 15777
 15778* EXEC CICS READ
 15779*        SET     (ADDRESS OF PENDING-BUSINESS)
 15780*        DATASET (FILE-ID-ERPNDB)
 15781*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15782*        UPDATE
 15783*    END-EXEC.
 15784*    MOVE '&"S        EU         (   #00013876' TO DFHEIV0
 15785     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15786     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15787     MOVE X'2020233030303133383736' TO DFHEIV0(25:11)
 15788     CALL 'kxdfhei1' USING DFHEIV0,
 15789           FILE-ID-ERPNDB,
 15790           DFHEIV20,
 15791           DFHEIV99,
 15792           PI-PREV-CONTROL-PRIMARY,
 15793           DFHEIV99,
 15794           DFHEIV99,
 15795           DFHEIV99
 15796     SET ADDRESS OF PENDING-BUSINESS TO
 15797         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 290
* EL6311.cbl
 15798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15799
 15800
 15801     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15802        MOVE -1                 TO CMAINTL
 15803        MOVE ER-2197            TO EMI-ERROR
 15804        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15805        GO TO 8200-SEND-DATAONLY.
 15806
 15807     IF PB-BILLED-DT NOT = LOW-VALUES
 15808        MOVE -1                 TO CMAINTL
 15809        MOVE ER-2129            TO EMI-ERROR
 15810        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15811        GO TO 8200-SEND-DATAONLY.
 15812
 15813     IF PB-CHG-COUNT NOT = ZEROS
 15814        MOVE ER-2336            TO EMI-ERROR
 15815        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15816        MOVE AL-UABON            TO CMAINTA
 15817        MOVE -1                  TO CMAINTL
 15818        GO TO 8200-SEND-DATAONLY.
 15819
 15820     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 15821        PB-CHG-COUNT NOT = ZEROS
 15822        MOVE ER-2196             TO EMI-ERROR
 15823        MOVE AL-UABON            TO CMAINTA
 15824        MOVE -1                  TO CMAINTL
 15825        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15826        GO TO 8200-SEND-DATAONLY.
 15827
 15828     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 15829        MOVE ER-2900 TO EMI-ERROR
 15830        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15831        MOVE AL-UABON         TO CMAINTA
 15832        MOVE -1               TO CMAINTL
 15833        GO TO 8200-SEND-DATAONLY.
 15834
 15835
 15836* EXEC CICS HANDLE CONDITION
 15837*         NOTFND  (2475-CONTINUE-DELETE)
 15838*    END-EXEC
 15839*    MOVE '"$I                   ! : #00013917' TO DFHEIV0
 15840     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15841     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15842     MOVE X'3A20233030303133393137' TO DFHEIV0(25:11)
 15843     CALL 'kxdfhei1' USING DFHEIV0
 15844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15845
 15846     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15847     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15848     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15849     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15850
 15851
 15852* EXEC CICS READ
 15853*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15854*        DATASET (FILE-ID-ELCERT)
 15855*        RIDFLD  (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 291
* EL6311.cbl
 15856*        UPDATE
 15857*    END-EXEC.
 15858*    MOVE '&"S        EU         (   #00013926' TO DFHEIV0
 15859     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15860     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15861     MOVE X'2020233030303133393236' TO DFHEIV0(25:11)
 15862     CALL 'kxdfhei1' USING DFHEIV0,
 15863           FILE-ID-ELCERT,
 15864           DFHEIV20,
 15865           DFHEIV99,
 15866           ELCERT-KEY,
 15867           DFHEIV99,
 15868           DFHEIV99,
 15869           DFHEIV99
 15870     SET ADDRESS OF CERTIFICATE-MASTER TO
 15871         DFHEIV20
 15872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15873
 15874
 15875     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15876
 15877     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 15878     MOVE 'B'                    TO JP-RECORD-TYPE.
 15879     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 15880     PERFORM 8400-LOG-JOURNAL-RECORD.
 15881
 15882     IF PB-CI-LIVES NOT NUMERIC
 15883         MOVE ZERO                    TO PB-CI-LIVES.
 15884
 15885     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15886        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15887           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15888           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 15889           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 15890                                            CM-LF-CANCEL-DT
 15891           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 15892        ELSE
 15893           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15894           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 15895           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 15896           MOVE PB-CI-LIVES              TO CM-LIVES.
 15897
 15898     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15899        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15900           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15901               MOVE CM-LF-STATUS-AT-CANCEL
 15902                                        TO CM-LF-CURRENT-STATUS
 15903               MOVE SPACE
 15904                                        TO CM-LF-STATUS-AT-CANCEL
 15905           ELSE
 15906               MOVE PB-CI-LF-POLICY-STATUS
 15907                                        TO CM-LF-CURRENT-STATUS
 15908        ELSE
 15909           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 15910
 15911
 15912     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15913        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 292
* EL6311.cbl
 15914           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15915           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 15916           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 15917                                            CM-AH-CANCEL-DT
 15918           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 15919        ELSE
 15920           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15921           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 15922           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 15923           MOVE PB-CI-LIVES              TO CM-LIVES.
 15924
 15925     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15926        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 15927           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15928               MOVE CM-AH-STATUS-AT-CANCEL
 15929                                        TO CM-AH-CURRENT-STATUS
 15930               MOVE SPACE
 15931                                        TO CM-AH-STATUS-AT-CANCEL
 15932           ELSE
 15933               MOVE PB-CI-AH-POLICY-STATUS
 15934                                        TO CM-AH-CURRENT-STATUS
 15935        ELSE
 15936           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 15937
 15938 2450-REWRITE-CERT.
 15939     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 15940     MOVE 'C'                      TO JP-RECORD-TYPE.
 15941     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 15942
 15943
 15944* EXEC CICS REWRITE
 15945*        DATASET  (FILE-ID-ELCERT)
 15946*        FROM     (CERTIFICATE-MASTER)
 15947*    END-EXEC.
 15948     MOVE LENGTH OF
 15949      CERTIFICATE-MASTER
 15950       TO DFHEIV11
 15951*    MOVE '&& L                  %   #00014001' TO DFHEIV0
 15952     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15953     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15954     MOVE X'2020233030303134303031' TO DFHEIV0(25:11)
 15955     CALL 'kxdfhei1' USING DFHEIV0,
 15956           FILE-ID-ELCERT,
 15957           CERTIFICATE-MASTER,
 15958           DFHEIV11,
 15959           DFHEIV99
 15960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15961
 15962
 15963     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 15964
 15965     PERFORM 8400-LOG-JOURNAL-RECORD.
 15966
 15967 2475-CONTINUE-DELETE.
 15968     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 15969     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 15970
 15971     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 293
* EL6311.cbl
 15972     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 15973
 15974     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 15975
 15976     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 15977     MOVE 'D'                    TO JP-RECORD-TYPE
 15978     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15979
 15980
 15981* EXEC CICS DELETE
 15982*        DATASET    (FILE-ID-ERPNDB)
 15983*    END-EXEC.
 15984*    MOVE '&(                    &   #00014023' TO DFHEIV0
 15985     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 15986     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15987     MOVE X'2020233030303134303233' TO DFHEIV0(25:11)
 15988     CALL 'kxdfhei1' USING DFHEIV0,
 15989           FILE-ID-ERPNDB,
 15990           DFHEIV99,
 15991           DFHEIV99,
 15992           DFHEIV99,
 15993           DFHEIV99
 15994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15995
 15996
 15997     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15998
 15999     PERFORM 8400-LOG-JOURNAL-RECORD.
 16000
 16001     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16002     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16003
 16004
 16005* EXEC CICS HANDLE CONDITION
 16006*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16007*    END-EXEC.
 16008*    MOVE '"$I                   ! ; #00014034' TO DFHEIV0
 16009     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16010     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16011     MOVE X'3B20233030303134303334' TO DFHEIV0(25:11)
 16012     CALL 'kxdfhei1' USING DFHEIV0
 16013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16014
 16015
 16016
 16017* EXEC CICS READ
 16018*        SET     (ADDRESS OF PENDING-BUSINESS)
 16019*        DATASET (FILE-ID-ERPNDB)
 16020*        RIDFLD  (ERPNDB-KEY)
 16021*        UPDATE
 16022*    END-EXEC.
 16023*    MOVE '&"S        EU         (   #00014038' TO DFHEIV0
 16024     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16025     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16026     MOVE X'2020233030303134303338' TO DFHEIV0(25:11)
 16027     CALL 'kxdfhei1' USING DFHEIV0,
 16028           FILE-ID-ERPNDB,
 16029           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 294
* EL6311.cbl
 16030           DFHEIV99,
 16031           ERPNDB-KEY,
 16032           DFHEIV99,
 16033           DFHEIV99,
 16034           DFHEIV99
 16035     SET ADDRESS OF PENDING-BUSINESS TO
 16036         DFHEIV20
 16037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16038
 16039
 16040     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16041     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16042
 16043     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16044        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16045        MOVE 'D'                 TO JP-RECORD-TYPE
 16046        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16047
 16048* EXEC CICS DELETE
 16049*            DATASET    (FILE-ID-ERPNDB)
 16050*       END-EXEC
 16051*    MOVE '&(                    &   #00014052' TO DFHEIV0
 16052     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16053     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16054     MOVE X'2020233030303134303532' TO DFHEIV0(25:11)
 16055     CALL 'kxdfhei1' USING DFHEIV0,
 16056           FILE-ID-ERPNDB,
 16057           DFHEIV99,
 16058           DFHEIV99,
 16059           DFHEIV99,
 16060           DFHEIV99
 16061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16062        PERFORM 8400-LOG-JOURNAL-RECORD
 16063     ELSE
 16064        MOVE 'B'                 TO JP-RECORD-TYPE
 16065        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16066        PERFORM 8400-LOG-JOURNAL-RECORD
 16067        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16068        MOVE 'C'                 TO JP-RECORD-TYPE
 16069        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16070
 16071* EXEC CICS REWRITE
 16072*            DATASET    (FILE-ID-ERPNDB)
 16073*            FROM       (PENDING-BUSINESS)
 16074*       END-EXEC
 16075     MOVE LENGTH OF
 16076      PENDING-BUSINESS
 16077       TO DFHEIV11
 16078*    MOVE '&& L                  %   #00014063' TO DFHEIV0
 16079     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16080     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16081     MOVE X'2020233030303134303633' TO DFHEIV0(25:11)
 16082     CALL 'kxdfhei1' USING DFHEIV0,
 16083           FILE-ID-ERPNDB,
 16084           PENDING-BUSINESS,
 16085           DFHEIV11,
 16086           DFHEIV99
 16087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 295
* EL6311.cbl
 16088        PERFORM 8400-LOG-JOURNAL-RECORD.
 16089
 16090******************************************************************
 16091*                                                                *
 16092*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16093*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16094*                                                                *
 16095******************************************************************
 16096
 16097     IF NOT PI-AR-PROCESSING
 16098        GO TO 2480-DELETE-FINISHED.
 16099
 16100     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16101        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16102        NEXT SENTENCE
 16103     ELSE
 16104        GO TO 2480-DELETE-FINISHED.
 16105
 16106
 16107* EXEC CICS HANDLE CONDITION
 16108*         NOTFND    (2480-DELETE-FINISHED)
 16109*    END-EXEC.
 16110*    MOVE '"$I                   ! < #00014085' TO DFHEIV0
 16111     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16112     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16113     MOVE X'3C20233030303134303835' TO DFHEIV0(25:11)
 16114     CALL 'kxdfhei1' USING DFHEIV0
 16115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16116
 16117
 16118     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16119     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16120
 16121
 16122* EXEC CICS READ
 16123*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16124*        DATASET (FILE-ID-ERRQST)
 16125*        RIDFLD  (ERRQST-KEY)
 16126*        UPDATE
 16127*    END-EXEC.
 16128*    MOVE '&"S        EU         (   #00014092' TO DFHEIV0
 16129     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16130     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16131     MOVE X'2020233030303134303932' TO DFHEIV0(25:11)
 16132     CALL 'kxdfhei1' USING DFHEIV0,
 16133           FILE-ID-ERRQST,
 16134           DFHEIV20,
 16135           DFHEIV99,
 16136           ERRQST-KEY,
 16137           DFHEIV99,
 16138           DFHEIV99,
 16139           DFHEIV99
 16140     SET ADDRESS OF AR-REQUEST-RECORD TO
 16141         DFHEIV20
 16142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16143
 16144
 16145     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 296
* EL6311.cbl
 16146
 16147     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16148
 16149     MOVE 'D'                      TO JP-RECORD-TYPE.
 16150     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16151
 16152
 16153* EXEC CICS DELETE
 16154*         DATASET    (FILE-ID-ERRQST)
 16155*    END-EXEC.
 16156*    MOVE '&(                    &   #00014106' TO DFHEIV0
 16157     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16158     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16159     MOVE X'2020233030303134313036' TO DFHEIV0(25:11)
 16160     CALL 'kxdfhei1' USING DFHEIV0,
 16161           FILE-ID-ERRQST,
 16162           DFHEIV99,
 16163           DFHEIV99,
 16164           DFHEIV99,
 16165           DFHEIV99
 16166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16167
 16168
 16169     PERFORM 8400-LOG-JOURNAL-RECORD.
 16170
 16171 2480-DELETE-FINISHED.
 16172     MOVE ZEROS                  TO EMI-ERROR.
 16173     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16174     MOVE LOW-VALUES             TO EL631CI.
 16175     MOVE -1                     TO CMAINTL.
 16176     GO TO 8100-SEND-INITIAL-MAP.
 16177
 16178 2485-BATCH-HDR-NOT-FOUND.
 16179     MOVE -1                     TO CMAINTL
 16180     MOVE AL-UABON               TO CMAINTA.
 16181     MOVE ER-7450                TO EMI-ERROR.
 16182     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16183     GO TO 8200-SEND-DATAONLY.
 16184
 16185 2490-RECORD-NOT-FOUND.
 16186     MOVE -1                     TO CMAINTL
 16187     MOVE AL-UABON               TO CMAINTA.
 16188     MOVE ER-7451                TO EMI-ERROR.
 16189     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16190     GO TO 8200-SEND-DATAONLY.
 16191
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 297
* EL6311.cbl
 16193
 16194***************************************************************
 16195*                                                             *
 16196*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16197*                                                             *
 16198***************************************************************
 16199
 16200***************************************************************
 16201*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16202*     AN ALREADY BILLED RECORD.                               *
 16203***************************************************************
 16204
 16205 2700-BUILD-CORRECTION-RECORD.
 16206     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16207     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16208     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16209     MOVE '5'                    TO DC-OPTION-CODE.
 16210     PERFORM 9700-DATE-LINK.
 16211     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16212
 16213     IF PB-CHG-COUNT = ZEROS
 16214        MOVE +1                  TO WS-SEQ-SAVE
 16215     ELSE
 16216        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16217
 16218     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16219     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16220
 16221     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16222
 16223     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16224     MOVE 'A'                    TO JP-RECORD-TYPE.
 16225     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16226
 16227
 16228* EXEC CICS WRITE
 16229*        DATASET    (FILE-ID-ERPNDB)
 16230*        FROM       (PENDING-BUSINESS)
 16231*        RIDFLD     (PB-CONTROL-PRIMARY)
 16232*    END-EXEC.
 16233     MOVE LENGTH OF
 16234      PENDING-BUSINESS
 16235       TO DFHEIV11
 16236*    MOVE '&$ L                  ''   #00014168' TO DFHEIV0
 16237     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16238     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16239     MOVE X'2020233030303134313638' TO DFHEIV0(25:11)
 16240     CALL 'kxdfhei1' USING DFHEIV0,
 16241           FILE-ID-ERPNDB,
 16242           PENDING-BUSINESS,
 16243           DFHEIV11,
 16244           PB-CONTROL-PRIMARY,
 16245           DFHEIV99,
 16246           DFHEIV99
 16247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16248
 16249
 16250     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 298
* EL6311.cbl
 16251
 16252     PERFORM 8400-LOG-JOURNAL-RECORD.
 16253
 16254 2799-EXIT.
 16255      EXIT.
 16256
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 299
* EL6311.cbl
 16258
 16259******************************************************************
 16260*                                                                *
 16261*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16262*                                                                *
 16263******************************************************************
 16264
 16265 2800-REWRITE-ISSUE-CERT-KEY.
 16266     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16267
 16268     IF  BCERTNOL GREATER THAN ZEROS
 16269         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16270
 16271     IF  BSUFIXL  GREATER THAN ZEROS
 16272         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16273
 16274     IF  BEFFDTL  GREATER THAN ZEROS
 16275         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16276
 16277 2810-READ-BY-ACCOUNT.
 16278
 16279* EXEC CICS HANDLE CONDITION
 16280*         NOTFND    (2820-PROCESS-REWRITE)
 16281*    END-EXEC.
 16282*    MOVE '"$I                   ! = #00014202' TO DFHEIV0
 16283     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16284     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16285     MOVE X'3D20233030303134323032' TO DFHEIV0(25:11)
 16286     CALL 'kxdfhei1' USING DFHEIV0
 16287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16288
 16289
 16290
 16291* EXEC CICS READ
 16292*        SET     (ADDRESS OF PENDING-BUSINESS)
 16293*        DATASET (FILE-ID-ERPNDB2)
 16294*        RIDFLD  (ERPNDB-ALT-KEY)
 16295*    END-EXEC.
 16296*    MOVE '&"S        E          (   #00014206' TO DFHEIV0
 16297     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16298     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16299     MOVE X'2020233030303134323036' TO DFHEIV0(25:11)
 16300     CALL 'kxdfhei1' USING DFHEIV0,
 16301           FILE-ID-ERPNDB2,
 16302           DFHEIV20,
 16303           DFHEIV99,
 16304           ERPNDB-ALT-KEY,
 16305           DFHEIV99,
 16306           DFHEIV99,
 16307           DFHEIV99
 16308     SET ADDRESS OF PENDING-BUSINESS TO
 16309         DFHEIV20
 16310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16311
 16312
 16313     GO TO 2890-DUPLICATE-RECORD.
 16314
 16315  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 300
* EL6311.cbl
 16316
 16317* EXEC CICS HANDLE CONDITION
 16318*         NOTFND    (2885-RECORD-MISSING)
 16319*    END-EXEC.
 16320*    MOVE '"$I                   ! > #00014215' TO DFHEIV0
 16321     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16322     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16323     MOVE X'3E20233030303134323135' TO DFHEIV0(25:11)
 16324     CALL 'kxdfhei1' USING DFHEIV0
 16325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16326
 16327
 16328     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16329
 16330
 16331* EXEC CICS READ
 16332*        SET     (ADDRESS OF PENDING-BUSINESS)
 16333*        DATASET (FILE-ID-ERPNDB)
 16334*        RIDFLD  (ERPNDB-KEY)
 16335*        UPDATE
 16336*    END-EXEC.
 16337*    MOVE '&"S        EU         (   #00014221' TO DFHEIV0
 16338     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16339     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16340     MOVE X'2020233030303134323231' TO DFHEIV0(25:11)
 16341     CALL 'kxdfhei1' USING DFHEIV0,
 16342           FILE-ID-ERPNDB,
 16343           DFHEIV20,
 16344           DFHEIV99,
 16345           ERPNDB-KEY,
 16346           DFHEIV99,
 16347           DFHEIV99,
 16348           DFHEIV99
 16349     SET ADDRESS OF PENDING-BUSINESS TO
 16350         DFHEIV20
 16351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16352
 16353
 16354     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16355     MOVE 'D'                    TO JP-RECORD-TYPE.
 16356     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16357     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16358
 16359     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16360
 16361     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16362     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16363     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16364
 16365
 16366* EXEC CICS DELETE
 16367*        DATASET    (FILE-ID-ERPNDB)
 16368*    END-EXEC.
 16369*    MOVE '&(                    &   #00014239' TO DFHEIV0
 16370     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16371     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16372     MOVE X'2020233030303134323339' TO DFHEIV0(25:11)
 16373     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 301
* EL6311.cbl
 16374           FILE-ID-ERPNDB,
 16375           DFHEIV99,
 16376           DFHEIV99,
 16377           DFHEIV99,
 16378           DFHEIV99
 16379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16380
 16381
 16382     PERFORM 8400-LOG-JOURNAL-RECORD.
 16383
 16384
 16385* EXEC CICS GETMAIN
 16386*        SET      (ADDRESS OF PENDING-BUSINESS)
 16387*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16388*        INITIMG  (GETMAIN-SPACE)
 16389*    END-EXEC.
 16390*    MOVE ',"IL                  $   #00014245' TO DFHEIV0
 16391     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16392     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16393     MOVE X'2020233030303134323435' TO DFHEIV0(25:11)
 16394     CALL 'kxdfhei1' USING DFHEIV0,
 16395           DFHEIV20,
 16396           ERPNDB-RECORD-LENGTH,
 16397           GETMAIN-SPACE
 16398     SET ADDRESS OF PENDING-BUSINESS TO
 16399         DFHEIV20
 16400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16401
 16402
 16403     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16404
 16405
 16406* EXEC CICS HANDLE CONDITION
 16407*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16408*    END-EXEC.
 16409*    MOVE '"$I                   ! ? #00014253' TO DFHEIV0
 16410     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16411     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16412     MOVE X'3F20233030303134323533' TO DFHEIV0(25:11)
 16413     CALL 'kxdfhei1' USING DFHEIV0
 16414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16415
 16416
 16417
 16418* EXEC CICS READ
 16419*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16420*        DATASET (FILE-ID-ELCERT)
 16421*        RIDFLD  (ELCERT-KEY)
 16422*        UPDATE
 16423*    END-EXEC.
 16424*    MOVE '&"S        EU         (   #00014257' TO DFHEIV0
 16425     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16426     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16427     MOVE X'2020233030303134323537' TO DFHEIV0(25:11)
 16428     CALL 'kxdfhei1' USING DFHEIV0,
 16429           FILE-ID-ELCERT,
 16430           DFHEIV20,
 16431           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 302
* EL6311.cbl
 16432           ELCERT-KEY,
 16433           DFHEIV99,
 16434           DFHEIV99,
 16435           DFHEIV99
 16436     SET ADDRESS OF CERTIFICATE-MASTER TO
 16437         DFHEIV20
 16438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16439
 16440
 16441     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16442     MOVE 'B'                    TO JP-RECORD-TYPE
 16443     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16444     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16445
 16446     IF INSURED-ADDR-PRESENT
 16447        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16448
 16449     IF CERT-NOTES-ARE-NOT-PRESENT
 16450        MOVE SPACE               TO WS-CERT-NOTE-SW
 16451     ELSE
 16452        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16453
 16454     IF CERT-ADDED-BATCH      OR
 16455        CERT-AND-CLAIM-ONLINE OR
 16456        CERT-WAS-CREATED-FOR-CLAIM
 16457        NEXT SENTENCE
 16458     ELSE
 16459        GO TO 2825-DELETE-CERTIFICATE.
 16460
 16461     PERFORM 8400-LOG-JOURNAL-RECORD.
 16462
 16463*********************************************************
 16464** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16465     IF CERT-ADDED-BATCH
 16466         GO TO 2822-REWRITE-ELCERT.
 16467*********************************************************
 16468
 16469     IF NO-CLAIM-ATTACHED
 16470        NEXT SENTENCE
 16471     ELSE
 16472        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 16473        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 16474
 16475 2822-REWRITE-ELCERT.
 16476     MOVE 'C'                    TO JP-RECORD-TYPE
 16477     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16478
 16479     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16480
 16481
 16482* EXEC CICS REWRITE
 16483*         DATASET    (FILE-ID-ELCERT)
 16484*         FROM       (CERTIFICATE-MASTER)
 16485*    END-EXEC.
 16486     MOVE LENGTH OF
 16487      CERTIFICATE-MASTER
 16488       TO DFHEIV11
 16489*    MOVE '&& L                  %   #00014304' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 303
* EL6311.cbl
 16490     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16491     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16492     MOVE X'2020233030303134333034' TO DFHEIV0(25:11)
 16493     CALL 'kxdfhei1' USING DFHEIV0,
 16494           FILE-ID-ELCERT,
 16495           CERTIFICATE-MASTER,
 16496           DFHEIV11,
 16497           DFHEIV99
 16498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16499
 16500
 16501     PERFORM 8400-LOG-JOURNAL-RECORD.
 16502
 16503     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16504
 16505 2825-DELETE-CERTIFICATE.
 16506     MOVE 'D'                      TO JP-RECORD-TYPE.
 16507     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16508
 16509     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16510
 16511
 16512* EXEC CICS DELETE
 16513*         DATASET    (FILE-ID-ELCERT)
 16514*    END-EXEC.
 16515*    MOVE '&(                    &   #00014319' TO DFHEIV0
 16516     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16517     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16518     MOVE X'2020233030303134333139' TO DFHEIV0(25:11)
 16519     CALL 'kxdfhei1' USING DFHEIV0,
 16520           FILE-ID-ELCERT,
 16521           DFHEIV99,
 16522           DFHEIV99,
 16523           DFHEIV99,
 16524           DFHEIV99
 16525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16526
 16527
 16528     PERFORM 8400-LOG-JOURNAL-RECORD.
 16529
 16530******************************************************************
 16531*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 16532******************************************************************
 16533
 16534     IF CERT-NOTES-ARE-PRESENT
 16535        NEXT SENTENCE
 16536     ELSE
 16537        GO TO 2827-DELETE-MAILING.
 16538
 16539
 16540* EXEC CICS HANDLE CONDITION
 16541*         NOTFND  (2827-DELETE-MAILING)
 16542*    END-EXEC.
 16543*    MOVE '"$I                   ! @ #00014334' TO DFHEIV0
 16544     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16545     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16546     MOVE X'4020233030303134333334' TO DFHEIV0(25:11)
 16547     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 304
* EL6311.cbl
 16548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16549
 16550
 16551
 16552* EXEC CICS READ
 16553*        EQUAL
 16554*        DATASET   (FILE-ID-ERNOTE)
 16555*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 16556*        RIDFLD    (ELCERT-KEY)
 16557*        UPDATE
 16558*    END-EXEC.
 16559*    MOVE '&"S        EU         (   #00014338' TO DFHEIV0
 16560     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16561     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16562     MOVE X'2020233030303134333338' TO DFHEIV0(25:11)
 16563     CALL 'kxdfhei1' USING DFHEIV0,
 16564           FILE-ID-ERNOTE,
 16565           DFHEIV20,
 16566           DFHEIV99,
 16567           ELCERT-KEY,
 16568           DFHEIV99,
 16569           DFHEIV99,
 16570           DFHEIV99
 16571     SET ADDRESS OF CERTIFICATE-NOTE TO
 16572         DFHEIV20
 16573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16574
 16575
 16576     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 16577     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16578     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 16579
 16580     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16581
 16582
 16583* EXEC CICS DELETE
 16584*        DATASET   (FILE-ID-ERNOTE)
 16585*    END-EXEC.
 16586*    MOVE '&(                    &   #00014352' TO DFHEIV0
 16587     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16588     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16589     MOVE X'2020233030303134333532' TO DFHEIV0(25:11)
 16590     CALL 'kxdfhei1' USING DFHEIV0,
 16591           FILE-ID-ERNOTE,
 16592           DFHEIV99,
 16593           DFHEIV99,
 16594           DFHEIV99,
 16595           DFHEIV99
 16596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16597
 16598
 16599     PERFORM 8400-LOG-JOURNAL-RECORD.
 16600
 16601******************************************************************
 16602*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 16603******************************************************************
 16604
 16605 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 305
* EL6311.cbl
 16606     IF CERT-ADDRESS-PRESENT
 16607        NEXT SENTENCE
 16608     ELSE
 16609        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16610
 16611
 16612* EXEC CICS HANDLE CONDITION
 16613*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 16614*    END-EXEC.
 16615*    MOVE '"$I                   ! A #00014368' TO DFHEIV0
 16616     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16617     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16618     MOVE X'4120233030303134333638' TO DFHEIV0(25:11)
 16619     CALL 'kxdfhei1' USING DFHEIV0
 16620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16621
 16622
 16623     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 16624
 16625
 16626* EXEC CICS READ
 16627*        EQUAL
 16628*        DATASET   (FILE-ID-ERMAIL)
 16629*        SET       (ADDRESS OF MAILING-DATA)
 16630*        RIDFLD    (ERMAIL-KEY)
 16631*        UPDATE
 16632*    END-EXEC.
 16633*    MOVE '&"S        EU         (   #00014374' TO DFHEIV0
 16634     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16635     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16636     MOVE X'2020233030303134333734' TO DFHEIV0(25:11)
 16637     CALL 'kxdfhei1' USING DFHEIV0,
 16638           FILE-ID-ERMAIL,
 16639           DFHEIV20,
 16640           DFHEIV99,
 16641           ERMAIL-KEY,
 16642           DFHEIV99,
 16643           DFHEIV99,
 16644           DFHEIV99
 16645     SET ADDRESS OF MAILING-DATA TO
 16646         DFHEIV20
 16647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16648
 16649
 16650     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 16651     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16652     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 16653
 16654     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 16655
 16656
 16657* EXEC CICS DELETE
 16658*        DATASET   (FILE-ID-ERMAIL)
 16659*    END-EXEC.
 16660*    MOVE '&(                    &   #00014388' TO DFHEIV0
 16661     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16662     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16663     MOVE X'2020233030303134333838' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 306
* EL6311.cbl
 16664     CALL 'kxdfhei1' USING DFHEIV0,
 16665           FILE-ID-ERMAIL,
 16666           DFHEIV99,
 16667           DFHEIV99,
 16668           DFHEIV99,
 16669           DFHEIV99
 16670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16671
 16672
 16673     PERFORM 8400-LOG-JOURNAL-RECORD.
 16674
 16675 2830-BUILD-NEW-ISSUE-RECORD.
 16676     MOVE SPACES                 TO ELCERT-KEY.
 16677
 16678     IF  BCERTNOL GREATER THAN ZEROS
 16679         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 16680
 16681     IF  BSUFIXL  GREATER THAN ZEROS
 16682         MOVE BSUFIXI            TO  PB-CERT-SFX.
 16683
 16684     IF BEFFDTL GREATER THAN ZEROS
 16685        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 16686
 16687 2870-WRITE-PENDING-BUSINESS.
 16688     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16689     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16690     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16691     MOVE '5'                    TO DC-OPTION-CODE.
 16692     PERFORM 9700-DATE-LINK.
 16693     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16694
 16695     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 16696
 16697     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16698     MOVE 'A'                    TO JP-RECORD-TYPE.
 16699     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16700
 16701
 16702* EXEC CICS WRITE
 16703*        DATASET  (FILE-ID-ERPNDB)
 16704*        FROM     (PENDING-BUSINESS)
 16705*        RIDFLD   (PB-CONTROL-PRIMARY)
 16706*    END-EXEC.
 16707     MOVE LENGTH OF
 16708      PENDING-BUSINESS
 16709       TO DFHEIV11
 16710*    MOVE '&$ L                  ''   #00014420' TO DFHEIV0
 16711     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16712     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16713     MOVE X'2020233030303134343230' TO DFHEIV0(25:11)
 16714     CALL 'kxdfhei1' USING DFHEIV0,
 16715           FILE-ID-ERPNDB,
 16716           PENDING-BUSINESS,
 16717           DFHEIV11,
 16718           PB-CONTROL-PRIMARY,
 16719           DFHEIV99,
 16720           DFHEIV99
 16721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 307
* EL6311.cbl
 16722
 16723
 16724     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 16725
 16726     PERFORM 8400-LOG-JOURNAL-RECORD.
 16727
 16728     GO TO 1325-PROCESS-ISSUE-CHANGES.
 16729
 16730 2885-RECORD-MISSING.
 16731     MOVE -1                     TO BMAINTL
 16732     MOVE AL-UABON               TO BMAINTA
 16733     MOVE ER-2902                TO EMI-ERROR.
 16734     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16735     GO TO 8200-SEND-DATAONLY.
 16736
 16737 2890-DUPLICATE-RECORD.
 16738     MOVE -1                     TO BMAINTL.
 16739     MOVE AL-UABON               TO BCERTNOA.
 16740     MOVE AL-UNBON               TO BEFFDTA.
 16741     MOVE SPACE                  TO BMAINTI.
 16742
 16743     MOVE 1                      TO EMI-SUB
 16744                                    EMI-SWITCH1
 16745                                    EMI-SWITCH-AREA-1
 16746                                    EMI-SWITCH-AREA-2.
 16747
 16748     MOVE SPACES                 TO EMI-ERROR-LINES.
 16749
 16750
 16751* EXEC CICS SYNCPOINT ROLLBACK
 16752*    END-EXEC.
 16753*    MOVE '6"R                   !   #00014452' TO DFHEIV0
 16754     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16755     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16756     MOVE X'2020233030303134343532' TO DFHEIV0(25:11)
 16757     CALL 'kxdfhei1' USING DFHEIV0
 16758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16759
 16760
 16761     MOVE ER-2247                TO EMI-ERROR.
 16762     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 16763     GO TO 8200-SEND-DATAONLY.
 16764
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 308
* EL6311.cbl
 16766
 16767******************************************************************
 16768*                                                                *
 16769*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 16770*                                                                *
 16771******************************************************************
 16772
 16773 2900-REWRITE-CAN-CERT-KEY.
 16774     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16775
 16776     IF  CCERTNOL GREATER THAN ZEROS
 16777         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 16778
 16779     IF  CSUFIXL  GREATER THAN ZEROS
 16780         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 16781
 16782     IF  CEFFDTL  GREATER THAN ZEROS
 16783         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16784
 16785 2910-READ-BY-ACCOUNT.
 16786
 16787* EXEC CICS HANDLE CONDITION
 16788*         NOTFND    (2920-PROCESS-REWRITE)
 16789*    END-EXEC.
 16790*    MOVE '"$I                   ! B #00014480' TO DFHEIV0
 16791     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16792     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16793     MOVE X'4220233030303134343830' TO DFHEIV0(25:11)
 16794     CALL 'kxdfhei1' USING DFHEIV0
 16795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16796
 16797
 16798
 16799* EXEC CICS READ
 16800*        SET     (ADDRESS OF PENDING-BUSINESS)
 16801*        DATASET (FILE-ID-ERPNDB2)
 16802*        RIDFLD  (ERPNDB-ALT-KEY)
 16803*    END-EXEC.
 16804*    MOVE '&"S        E          (   #00014484' TO DFHEIV0
 16805     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16807     MOVE X'2020233030303134343834' TO DFHEIV0(25:11)
 16808     CALL 'kxdfhei1' USING DFHEIV0,
 16809           FILE-ID-ERPNDB2,
 16810           DFHEIV20,
 16811           DFHEIV99,
 16812           ERPNDB-ALT-KEY,
 16813           DFHEIV99,
 16814           DFHEIV99,
 16815           DFHEIV99
 16816     SET ADDRESS OF PENDING-BUSINESS TO
 16817         DFHEIV20
 16818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16819
 16820
 16821     GO TO 2990-DUPLICATE-RECORD.
 16822
 16823  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 309
* EL6311.cbl
 16824
 16825* EXEC CICS HANDLE CONDITION
 16826*         NOTFND    (2985-RECORD-MISSING)
 16827*    END-EXEC.
 16828*    MOVE '"$I                   ! C #00014493' TO DFHEIV0
 16829     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16830     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16831     MOVE X'4320233030303134343933' TO DFHEIV0(25:11)
 16832     CALL 'kxdfhei1' USING DFHEIV0
 16833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16834
 16835
 16836     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16837
 16838
 16839* EXEC CICS READ
 16840*        SET     (ADDRESS OF PENDING-BUSINESS)
 16841*        DATASET (FILE-ID-ERPNDB)
 16842*        RIDFLD  (ERPNDB-KEY)
 16843*        UPDATE
 16844*    END-EXEC.
 16845*    MOVE '&"S        EU         (   #00014499' TO DFHEIV0
 16846     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16847     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16848     MOVE X'2020233030303134343939' TO DFHEIV0(25:11)
 16849     CALL 'kxdfhei1' USING DFHEIV0,
 16850           FILE-ID-ERPNDB,
 16851           DFHEIV20,
 16852           DFHEIV99,
 16853           ERPNDB-KEY,
 16854           DFHEIV99,
 16855           DFHEIV99,
 16856           DFHEIV99
 16857     SET ADDRESS OF PENDING-BUSINESS TO
 16858         DFHEIV20
 16859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16860
 16861
 16862     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16863     MOVE 'D'                    TO JP-RECORD-TYPE.
 16864     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16865     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16866
 16867     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16868
 16869     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16870     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16871     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16872
 16873
 16874* EXEC CICS DELETE
 16875*        DATASET    (FILE-ID-ERPNDB)
 16876*    END-EXEC.
 16877*    MOVE '&(                    &   #00014517' TO DFHEIV0
 16878     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16879     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16880     MOVE X'2020233030303134353137' TO DFHEIV0(25:11)
 16881     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 310
* EL6311.cbl
 16882           FILE-ID-ERPNDB,
 16883           DFHEIV99,
 16884           DFHEIV99,
 16885           DFHEIV99,
 16886           DFHEIV99
 16887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16888
 16889
 16890     PERFORM 8400-LOG-JOURNAL-RECORD.
 16891
 16892
 16893* EXEC CICS GETMAIN
 16894*        SET      (ADDRESS OF PENDING-BUSINESS)
 16895*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16896*        INITIMG  (GETMAIN-SPACE)
 16897*    END-EXEC.
 16898*    MOVE ',"IL                  $   #00014523' TO DFHEIV0
 16899     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16900     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16901     MOVE X'2020233030303134353233' TO DFHEIV0(25:11)
 16902     CALL 'kxdfhei1' USING DFHEIV0,
 16903           DFHEIV20,
 16904           ERPNDB-RECORD-LENGTH,
 16905           GETMAIN-SPACE
 16906     SET ADDRESS OF PENDING-BUSINESS TO
 16907         DFHEIV20
 16908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16909
 16910
 16911     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16912
 16913 2950-PROCESS-CANCELS.
 16914
 16915
 16916* EXEC CICS HANDLE CONDITION
 16917*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 16918*    END-EXEC.
 16919*    MOVE '"$I                   ! D #00014533' TO DFHEIV0
 16920     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16921     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16922     MOVE X'4420233030303134353333' TO DFHEIV0(25:11)
 16923     CALL 'kxdfhei1' USING DFHEIV0
 16924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16925
 16926
 16927
 16928* EXEC CICS READ
 16929*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16930*        DATASET (FILE-ID-ELCERT)
 16931*        RIDFLD  (ELCERT-KEY)
 16932*        UPDATE
 16933*    END-EXEC.
 16934*    MOVE '&"S        EU         (   #00014537' TO DFHEIV0
 16935     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16936     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16937     MOVE X'2020233030303134353337' TO DFHEIV0(25:11)
 16938     CALL 'kxdfhei1' USING DFHEIV0,
 16939           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 311
* EL6311.cbl
 16940           DFHEIV20,
 16941           DFHEIV99,
 16942           ELCERT-KEY,
 16943           DFHEIV99,
 16944           DFHEIV99,
 16945           DFHEIV99
 16946     SET ADDRESS OF CERTIFICATE-MASTER TO
 16947         DFHEIV20
 16948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16949
 16950
 16951     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16952
 16953     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16954     MOVE 'B'                      TO JP-RECORD-TYPE.
 16955     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16956     PERFORM 8400-LOG-JOURNAL-RECORD.
 16957
 16958     IF PB-CI-LIVES NOT NUMERIC
 16959         MOVE ZERO                    TO PB-CI-LIVES.
 16960
 16961     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16962        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16963        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16964        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16965                                         CM-LF-CANCEL-DT
 16966     ELSE
 16967        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16968        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16969        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16970        MOVE PB-CI-LIVES              TO CM-LIVES.
 16971
 16972     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16973        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16974            MOVE CM-LF-STATUS-AT-CANCEL
 16975                                     TO CM-LF-CURRENT-STATUS
 16976            MOVE SPACE
 16977                                     TO CM-LF-STATUS-AT-CANCEL
 16978        ELSE
 16979            MOVE PB-CI-LF-POLICY-STATUS
 16980                                     TO CM-LF-CURRENT-STATUS
 16981     ELSE
 16982        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16983
 16984     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16985        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16986        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16987        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16988                                         CM-AH-CANCEL-DT
 16989     ELSE
 16990        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16991        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16992        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16993        MOVE PB-CI-LIVES              TO CM-LIVES.
 16994
 16995     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16996        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16997            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 312
* EL6311.cbl
 16998                                     TO CM-AH-CURRENT-STATUS
 16999            MOVE SPACE
 17000                                     TO CM-AH-STATUS-AT-CANCEL
 17001        ELSE
 17002            MOVE PB-CI-AH-POLICY-STATUS
 17003                                     TO CM-AH-CURRENT-STATUS
 17004     ELSE
 17005        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17006
 17007 2975-REWRITE-CERT.
 17008     MOVE 'C'                      TO JP-RECORD-TYPE.
 17009     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17010
 17011
 17012* EXEC CICS REWRITE
 17013*        DATASET    (FILE-ID-ELCERT)
 17014*        FROM       (CERTIFICATE-MASTER)
 17015*    END-EXEC.
 17016     MOVE LENGTH OF
 17017      CERTIFICATE-MASTER
 17018       TO DFHEIV11
 17019*    MOVE '&& L                  %   #00014604' TO DFHEIV0
 17020     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17021     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17022     MOVE X'2020233030303134363034' TO DFHEIV0(25:11)
 17023     CALL 'kxdfhei1' USING DFHEIV0,
 17024           FILE-ID-ELCERT,
 17025           CERTIFICATE-MASTER,
 17026           DFHEIV11,
 17027           DFHEIV99
 17028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17029
 17030
 17031     PERFORM 8400-LOG-JOURNAL-RECORD.
 17032
 17033 2960-BUILD-NEW-CANCEL-RECORD.
 17034     IF  CCERTNOL GREATER THAN ZEROS
 17035         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17036
 17037     IF  CSUFIXL  GREATER THAN ZEROS
 17038         MOVE CSUFIXI             TO PB-CERT-SFX.
 17039
 17040     IF  CEFFDTL  GREATER  THAN ZEROS
 17041         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17042
 17043 2970-WRITE-PENDING-BUSINESS.
 17044     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17045     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17046     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17047     MOVE '5'                    TO DC-OPTION-CODE.
 17048     PERFORM 9700-DATE-LINK.
 17049     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17050
 17051     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17052
 17053     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17054                                    PB-CI-INSURED-SEX
 17055                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 313
* EL6311.cbl
 17056                                    PB-CI-AH-BENEFIT-CD
 17057                                    PB-CI-RATE-CLASS
 17058                                    PB-CI-RATE-DEV-LF
 17059                                    PB-CI-RATE-DEV-AH
 17060                                    PB-CI-LF-ABBR
 17061                                    PB-CI-AH-ABBR
 17062                                    PB-CI-OB-FLAG
 17063                                    PB-CI-LF-POLICY-STATUS
 17064                                    PB-CI-AH-POLICY-STATUS
 17065                                    PB-CI-INDV-GRP-CD
 17066                                    PB-CI-BENEFICIARY-NAME
 17067                                    PB-CI-NOTE-SW
 17068                                    PB-CI-SOC-SEC-NO
 17069                                    PB-CI-MEMBER-NO
 17070                                    PB-CI-INT-CODE
 17071                                    PB-CI-COMP-EXCP-SW
 17072                                    PB-CI-ENTRY-STATUS
 17073                                    PB-CI-CREDIT-INTERFACE-SW-1
 17074                                    PB-CI-CREDIT-INTERFACE-SW-2
 17075                                    PB-CI-ENTRY-BATCH.
 17076
 17077     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17078                                    PB-CI-AH-SETTLEMENT-DT
 17079                                    PB-CI-DEATH-DT
 17080                                    PB-CI-LF-PRIOR-CANCEL-DT
 17081                                    PB-CI-AH-PRIOR-CANCEL-DT
 17082                                    PB-CI-LOAN-1ST-PMT-DT
 17083                                    PB-CI-ENTRY-DT
 17084                                    PB-CI-LF-EXPIRE-DT
 17085                                    PB-CI-AH-EXPIRE-DT.
 17086
 17087     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17088                                    PB-CI-LF-TERM
 17089                                    PB-CI-LF-BENEFIT-AMT
 17090                                    PB-CI-LF-ALT-BENEFIT-AMT
 17091                                    PB-CI-LF-PREMIUM-AMT
 17092                                    PB-CI-LF-ALT-PREMIUM-AMT
 17093                                    PB-CI-AH-TERM
 17094                                    PB-CI-AH-BENEFIT-AMT
 17095                                    PB-CI-AH-PREMIUM-AMT
 17096                                    PB-CI-RATE-DEV-PCT-LF
 17097                                    PB-CI-RATE-DEV-PCT-AH
 17098                                    PB-CI-LIFE-COMMISSION
 17099                                    PB-CI-AH-COMMISSION
 17100                                    PB-CI-PAY-FREQUENCY
 17101                                    PB-CI-LOAN-APR
 17102                                    PB-CI-LOAN-TERM
 17103                                    PB-CI-CURR-SEQ
 17104                                    PB-CI-AH-CANCEL-AMT
 17105                                    PB-CI-LF-CANCEL-AMT
 17106                                    PB-CI-EXTENTION-DAYS
 17107                                    PB-CI-TERM-IN-DAYS
 17108                                    PB-CI-LOAN-OFFICER
 17109                                    PB-CI-LIVES
 17110                                    PB-CI-LF-CRIT-PER
 17111                                    PB-CI-AH-CRIT-PER
 17112                                    PB-C-LF-REM-TERM
 17113                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 314
* EL6311.cbl
 17114
 17115     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17116     MOVE 'A'                    TO JP-RECORD-TYPE.
 17117     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17118
 17119
 17120* EXEC CICS HANDLE CONDITION
 17121*        DUPREC   (2990-DUPLICATE-RECORD)
 17122*    END-EXEC.
 17123*    MOVE '"$%                   ! E #00014697' TO DFHEIV0
 17124     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17125     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17126     MOVE X'4520233030303134363937' TO DFHEIV0(25:11)
 17127     CALL 'kxdfhei1' USING DFHEIV0
 17128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17129
 17130
 17131
 17132* EXEC CICS WRITE
 17133*        DATASET  (FILE-ID-ERPNDB)
 17134*        FROM     (PENDING-BUSINESS)
 17135*        RIDFLD   (PB-CONTROL-PRIMARY)
 17136*    END-EXEC.
 17137     MOVE LENGTH OF
 17138      PENDING-BUSINESS
 17139       TO DFHEIV11
 17140*    MOVE '&$ L                  ''   #00014701' TO DFHEIV0
 17141     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17142     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17143     MOVE X'2020233030303134373031' TO DFHEIV0(25:11)
 17144     CALL 'kxdfhei1' USING DFHEIV0,
 17145           FILE-ID-ERPNDB,
 17146           PENDING-BUSINESS,
 17147           DFHEIV11,
 17148           PB-CONTROL-PRIMARY,
 17149           DFHEIV99,
 17150           DFHEIV99
 17151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17152
 17153
 17154     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17155
 17156     PERFORM 8400-LOG-JOURNAL-RECORD.
 17157
 17158     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17159
 17160 2985-RECORD-MISSING.
 17161     MOVE -1                     TO CMAINTL
 17162     MOVE AL-UABON               TO CMAINTA.
 17163
 17164     MOVE ER-2902                TO EMI-ERROR.
 17165     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17166     GO TO 8200-SEND-DATAONLY.
 17167
 17168 2990-DUPLICATE-RECORD.
 17169     MOVE SPACE                  TO CMAINTI.
 17170     MOVE -1                     TO CMAINTL.
 17171     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 315
* EL6311.cbl
 17172     MOVE AL-UNBON               TO CEFFDTA.
 17173
 17174     MOVE 1                      TO EMI-SUB
 17175                                    EMI-SWITCH1
 17176                                    EMI-SWITCH-AREA-1
 17177                                    EMI-SWITCH-AREA-2.
 17178     MOVE SPACES                 TO EMI-ERROR-LINES.
 17179
 17180
 17181* EXEC CICS SYNCPOINT ROLLBACK
 17182*    END-EXEC.
 17183*    MOVE '6"R                   !   #00014733' TO DFHEIV0
 17184     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17185     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17186     MOVE X'2020233030303134373333' TO DFHEIV0(25:11)
 17187     CALL 'kxdfhei1' USING DFHEIV0
 17188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17189
 17190
 17191     MOVE ER-2247                TO EMI-ERROR.
 17192     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17193     GO TO 8200-SEND-DATAONLY.
 17194
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 316
* EL6311.cbl
 17196
 17197***************************************************************
 17198*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17199*     PREMIUM FOR A SINGLE BATCH.                             *
 17200*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17201***************************************************************
 17202
 17203 3000-BATCH-MAINLINE.
 17204     IF PI-PREV-KEY NOT = SPACES
 17205         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17206     ELSE
 17207         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17208
 17209     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17210
 17211 3010-READNEXT.
 17212
 17213* EXEC CICS READ
 17214*         DATASET    (FILE-ID-ERPNDB)
 17215*         SET        (ADDRESS OF PENDING-BUSINESS)
 17216*         RIDFLD     (ERPNDB-KEY)
 17217*         GTEQ
 17218*    END-EXEC.
 17219*    MOVE '&"S        G          (   #00014757' TO DFHEIV0
 17220     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17221     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17222     MOVE X'2020233030303134373537' TO DFHEIV0(25:11)
 17223     CALL 'kxdfhei1' USING DFHEIV0,
 17224           FILE-ID-ERPNDB,
 17225           DFHEIV20,
 17226           DFHEIV99,
 17227           ERPNDB-KEY,
 17228           DFHEIV99,
 17229           DFHEIV99,
 17230           DFHEIV99
 17231     SET ADDRESS OF PENDING-BUSINESS TO
 17232         DFHEIV20
 17233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17234
 17235
 17236     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17237        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17238          GO TO 3030-END-BATCH.
 17239
 17240     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17241
 17242     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17243        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17244          GO TO 3020-BUMP-SEQ.
 17245
 17246     IF PB-ISSUE
 17247        ADD +1                   TO WS-ISS-TOTAL-CNT
 17248        IF PB-FATAL-ERRORS
 17249           ADD +1                      TO WS-ISS-FATAL-CNT
 17250           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17251           GO TO 3020-BUMP-SEQ
 17252        ELSE
 17253           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 317
* EL6311.cbl
 17254              ADD +1                      TO WS-ISS-FORCE-CNT
 17255              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17256              GO TO 3020-BUMP-SEQ
 17257           ELSE
 17258              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17259                 ADD +1                      TO WS-ISS-HOLD-CNT
 17260                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17261                 GO TO 3020-BUMP-SEQ
 17262              ELSE
 17263                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17264                     THRU  3299-EXIT
 17265                 GO TO 3020-BUMP-SEQ.
 17266
 17267     IF PB-CANCELLATION
 17268        ADD +1                   TO WS-CAN-TOTAL-CNT
 17269        IF PB-FATAL-ERRORS
 17270           ADD +1                 TO WS-CAN-FATAL-CNT
 17271           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17272           GO TO 3020-BUMP-SEQ
 17273        ELSE
 17274           IF PB-UNFORCED-ERRORS
 17275              ADD +1                 TO WS-CAN-FORCE-CNT
 17276              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17277              GO TO 3020-BUMP-SEQ
 17278           ELSE
 17279              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17280                 ADD +1                 TO WS-CAN-HOLD-CNT
 17281                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17282                 GO TO 3020-BUMP-SEQ
 17283              ELSE
 17284                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17285                     THRU  3499-EXIT
 17286                 GO TO 3020-BUMP-SEQ.
 17287
 17288     IF PB-BATCH-TRAILER
 17289         GO TO 3030-END-BATCH.
 17290
 17291 3020-BUMP-SEQ.
 17292     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17293     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17294     GO TO 3010-READNEXT.
 17295
 17296 3030-END-BATCH.
 17297     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17298     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17299     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17300     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17301
 17302     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17303                                          - WS-ISS-FORCE-CNT
 17304                                          - WS-ISS-HOLD-CNT).
 17305
 17306     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17307     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17308
 17309     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17310     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17311     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 318
* EL6311.cbl
 17312     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17313     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17314                                          - WS-CAN-FORCE-CNT
 17315                                          - WS-CAN-HOLD-CNT).
 17316     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17317     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17318
 17319     COMPUTE WS-NET-TOTAL-CNT
 17320         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17321     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17322     COMPUTE WS-NET-FATAL-CNT
 17323         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17324     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17325     COMPUTE WS-NET-FORCE-CNT
 17326         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17327     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17328     COMPUTE WS-NET-HOLD-CNT
 17329         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17330     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17331
 17332     COMPUTE WS-NET-AVAIL-CNT
 17333          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17334                              - WS-ISS-FORCE-CNT
 17335                              - WS-ISS-HOLD-CNT)
 17336          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17337                              - WS-CAN-FORCE-CNT
 17338                              - WS-CAN-HOLD-CNT).
 17339     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17340
 17341     COMPUTE WS-NET-GOOD-PREM
 17342         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17343     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17344     COMPUTE WS-NET-BAD-PREM
 17345         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17346     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17347
 17348     MOVE 0000                   TO EMI-ERROR.
 17349     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17350     MOVE -1                     TO DPFENTRL.
 17351     GO TO 8200-SEND-DATAONLY.
 17352
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 319
* EL6311.cbl
 17354
 17355******************************************************************
 17356*                                                                *
 17357*           A D D    B A D   I S S U E   P R E M I U M           *
 17358*                                                                *
 17359******************************************************************
 17360
 17361 3100-ADD-BAD-ISSUE-PREM.
 17362     IF PB-OVERRIDE-LIFE
 17363       OR PB-OVERRIDE-BOTH
 17364           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17365           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17366       ELSE
 17367           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17368           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17369
 17370     IF PB-OVERRIDE-AH
 17371       OR PB-OVERRIDE-BOTH
 17372           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17373       ELSE
 17374           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17375
 17376 3199-EXIT.
 17377     EXIT.
 17378
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 320
* EL6311.cbl
 17380
 17381******************************************************************
 17382*                                                                *
 17383*       A D D   G O O D   I S S U E   P R E M I U M              *
 17384*                                                                *
 17385******************************************************************
 17386
 17387 3200-ADD-GOOD-ISSUE-PREM.
 17388     IF PB-OVERRIDE-LIFE
 17389       OR PB-OVERRIDE-BOTH
 17390           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17391           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17392       ELSE
 17393           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17394           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17395
 17396     IF PB-OVERRIDE-AH
 17397       OR PB-OVERRIDE-BOTH
 17398           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17399       ELSE
 17400           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17401
 17402 3299-EXIT.
 17403     EXIT.
 17404
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 321
* EL6311.cbl
 17406
 17407
 17408******************************************************************
 17409*                                                                *
 17410*        A D D   B A D   C A N C E L   P R E M I U M             *
 17411*                                                                *
 17412******************************************************************
 17413
 17414 3300-ADD-BAD-CANCEL-PREM.
 17415     IF PB-OVERRIDE-LIFE
 17416       OR PB-OVERRIDE-BOTH
 17417           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17418       ELSE
 17419           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17420
 17421     IF PB-OVERRIDE-AH
 17422       OR PB-OVERRIDE-BOTH
 17423           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17424       ELSE
 17425           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17426
 17427 3399-EXIT.
 17428     EXIT.
 17429
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 322
* EL6311.cbl
 17431
 17432******************************************************************
 17433*                                                                *
 17434*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17435*                                                                *
 17436******************************************************************
 17437
 17438 3400-ADD-GOOD-CANCEL-PREM.
 17439     IF PB-OVERRIDE-LIFE
 17440       OR PB-OVERRIDE-BOTH
 17441           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17442       ELSE
 17443           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17444
 17445     IF PB-OVERRIDE-AH
 17446       OR PB-OVERRIDE-BOTH
 17447           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17448       ELSE
 17449           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17450
 17451 3499-EXIT.
 17452     EXIT.
 17453
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 323
* EL6311.cbl
 17455
 17456******************************************************************
 17457*                                                                *
 17458*           E D I T   B A T C H   D A T A                        *
 17459*                                                                *
 17460******************************************************************
 17461
 17462 3500-EDIT-BATCH-DATA.
 17463     IF PI-PREV-KEY NOT = SPACES
 17464        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17465     ELSE
 17466        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17467
 17468     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 17469     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17470
 17471
 17472* EXEC CICS HANDLE CONDITION
 17473*         NOTFND      (3590-NOT-FOUND)
 17474*    END-EXEC.
 17475*    MOVE '"$I                   ! F #00014999' TO DFHEIV0
 17476     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17477     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17478     MOVE X'4620233030303134393939' TO DFHEIV0(25:11)
 17479     CALL 'kxdfhei1' USING DFHEIV0
 17480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17481
 17482
 17483     IF DRISSL   GREATER THAN ZEROS OR
 17484        DRISSL   GREATER THAN ZEROS OR
 17485        DRLFPRML GREATER THAN ZEROS OR
 17486        DRAHPRML GREATER THAN ZEROS OR
 17487        DRCANCL  GREATER THAN ZEROS OR
 17488        DRLFRFDL GREATER THAN ZEROS OR
 17489        DRAHRFDL GREATER THAN ZEROS
 17490              NEXT SENTENCE
 17491          ELSE
 17492              MOVE ER-3224    TO EMI-ERROR
 17493              MOVE -1         TO DPFENTRL
 17494              MOVE AL-UNBON   TO DPFENTRA
 17495              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17496              GO TO 8200-SEND-DATAONLY.
 17497
 17498     IF NOT MODIFY-CAP
 17499         MOVE 'UPDATE'       TO SM-READ
 17500         PERFORM 9995-SECURITY-VIOLATION
 17501         MOVE ER-0070        TO EMI-ERROR
 17502         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17503         GO TO 8100-SEND-INITIAL-MAP.
 17504
 17505        IF DRISSL GREATER THAN ZEROS
 17506           MOVE AL-UNNON         TO DRISSA
 17507           MOVE DRISSI           TO DEEDIT-FIELD
 17508           PERFORM 8600-DEEDIT
 17509           IF DEEDIT-FIELD-V0  NUMERIC
 17510              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 17511           ELSE
 17512              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 324
* EL6311.cbl
 17513              MOVE -1         TO DRISSL
 17514              MOVE AL-UNBON   TO DRISSA
 17515              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17516
 17517        IF DRLFPRML GREATER THAN ZEROS
 17518           MOVE AL-UNNON         TO DRLFPRMA
 17519
 17520* EXEC CICS BIF DEEDIT
 17521*              FIELD  (DRLFPRMI)
 17522*              LENGTH (11)
 17523*          END-EXEC
 17524     MOVE 11
 17525       TO DFHEIV11
 17526*    MOVE '@"L                   #   #00015039' TO DFHEIV0
 17527     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17528     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17529     MOVE X'2020233030303135303339' TO DFHEIV0(25:11)
 17530     CALL 'kxdfhei1' USING DFHEIV0,
 17531           DRLFPRMI,
 17532           DFHEIV11
 17533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17534           IF DRLFPRMI NUMERIC
 17535              MOVE DRLFPRMI   TO WS-DRLFPRM
 17536*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 17537*          PERFORM 8600-DEEDIT
 17538*          IF DEEDIT-FIELD-V2  NUMERIC
 17539*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 17540           ELSE
 17541              MOVE ER-2223    TO EMI-ERROR
 17542              MOVE -1         TO DRLFPRML
 17543              MOVE AL-UNBON   TO DRLFPRMA
 17544              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17545
 17546        IF DRAHPRML GREATER THAN ZEROS
 17547           MOVE AL-UNNON         TO DRAHPRMA
 17548
 17549* EXEC CICS BIF DEEDIT
 17550*              FIELD  (DRAHPRMI)
 17551*              LENGTH (11)
 17552*          END-EXEC
 17553     MOVE 11
 17554       TO DFHEIV11
 17555*    MOVE '@"L                   #   #00015057' TO DFHEIV0
 17556     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17557     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17558     MOVE X'2020233030303135303537' TO DFHEIV0(25:11)
 17559     CALL 'kxdfhei1' USING DFHEIV0,
 17560           DRAHPRMI,
 17561           DFHEIV11
 17562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17563           IF DRAHPRMI NUMERIC
 17564              MOVE DRAHPRMI   TO WS-DRAHPRM
 17565*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 17566*          PERFORM 8600-DEEDIT
 17567*          IF DEEDIT-FIELD-V2  NUMERIC
 17568*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 17569           ELSE
 17570              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 325
* EL6311.cbl
 17571              MOVE -1         TO DRAHPRML
 17572              MOVE AL-UNBON   TO DRAHPRMA
 17573              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17574
 17575        IF DRCANCL GREATER THAN ZEROS
 17576           MOVE AL-UNNON         TO DRCANCA
 17577           MOVE DRCANCI          TO DEEDIT-FIELD
 17578           PERFORM 8600-DEEDIT
 17579           IF DEEDIT-FIELD-V0  NUMERIC
 17580              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 17581           ELSE
 17582              MOVE ER-2223    TO EMI-ERROR
 17583              MOVE -1         TO DRCANCL
 17584              MOVE AL-UNBON   TO DRCANCL
 17585              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17586
 17587        IF DRLFRFDL GREATER THAN ZEROS
 17588           MOVE AL-UNNON         TO DRLFRFDA
 17589
 17590* EXEC CICS BIF DEEDIT
 17591*              FIELD  (DRLFRFDI)
 17592*              LENGTH (11)
 17593*          END-EXEC
 17594     MOVE 11
 17595       TO DFHEIV11
 17596*    MOVE '@"L                   #   #00015087' TO DFHEIV0
 17597     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17598     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17599     MOVE X'2020233030303135303837' TO DFHEIV0(25:11)
 17600     CALL 'kxdfhei1' USING DFHEIV0,
 17601           DRLFRFDI,
 17602           DFHEIV11
 17603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17604           IF DRLFRFDI NUMERIC
 17605              MOVE DRLFRFDI   TO WS-DRLFRFD
 17606*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 17607*          PERFORM 8600-DEEDIT
 17608*          IF DEEDIT-FIELD-V2  NUMERIC
 17609*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 17610           ELSE
 17611              MOVE ER-2223    TO EMI-ERROR
 17612              MOVE -1         TO DRLFRFDL
 17613              MOVE AL-UNBON   TO DRLFRFDA
 17614              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17615
 17616        IF DRAHRFDL GREATER THAN ZEROS
 17617           MOVE AL-UNNON         TO DRAHRFDA
 17618
 17619* EXEC CICS BIF DEEDIT
 17620*              FIELD  (DRAHRFDI)
 17621*              LENGTH (11)
 17622*          END-EXEC
 17623     MOVE 11
 17624       TO DFHEIV11
 17625*    MOVE '@"L                   #   #00015105' TO DFHEIV0
 17626     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17627     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17628     MOVE X'2020233030303135313035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 326
* EL6311.cbl
 17629     CALL 'kxdfhei1' USING DFHEIV0,
 17630           DRAHRFDI,
 17631           DFHEIV11
 17632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17633           IF DRAHRFDI NUMERIC
 17634              MOVE DRAHRFDI   TO WS-DRAHRFD
 17635*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 17636*          PERFORM 8600-DEEDIT
 17637*          IF DEEDIT-FIELD-V2  NUMERIC
 17638*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 17639           ELSE
 17640              MOVE ER-2223    TO EMI-ERROR
 17641              MOVE -1         TO DRAHRFDL
 17642              MOVE AL-UNBON   TO DRAHRFDA
 17643              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17644
 17645     IF EMI-ERROR = ZEROS
 17646        GO 3600-UPDATE-BATCH-HEADER.
 17647
 17648     GO TO 8200-SEND-DATAONLY.
 17649
 17650 3590-NOT-FOUND.
 17651     MOVE ER-2192                TO EMI-ERROR.
 17652     MOVE -1                     TO DPFENTRL.
 17653     MOVE AL-UNBON               TO DPFENTRA.
 17654     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17655     GO TO 8200-SEND-DATAONLY.
 17656
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 327
* EL6311.cbl
 17658
 17659******************************************************************
 17660*                                                                *
 17661*           U P D A T E   B A T C H   H E A D E R                *
 17662*                                                                *
 17663******************************************************************
 17664
 17665 3600-UPDATE-BATCH-HEADER.
 17666
 17667* EXEC CICS HANDLE CONDITION
 17668*         NOTFND      (3690-NOT-FOUND)
 17669*    END-EXEC.
 17670*    MOVE '"$I                   ! G #00015142' TO DFHEIV0
 17671     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17673     MOVE X'4720233030303135313432' TO DFHEIV0(25:11)
 17674     CALL 'kxdfhei1' USING DFHEIV0
 17675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17676
 17677
 17678
 17679* EXEC CICS READ
 17680*        DATASET (FILE-ID-ERPNDB)
 17681*        RIDFLD  (ERPNDB-KEY)
 17682*        SET     (ADDRESS OF PENDING-BUSINESS)
 17683*        UPDATE
 17684*    END-EXEC.
 17685*    MOVE '&"S        EU         (   #00015146' TO DFHEIV0
 17686     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17687     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17688     MOVE X'2020233030303135313436' TO DFHEIV0(25:11)
 17689     CALL 'kxdfhei1' USING DFHEIV0,
 17690           FILE-ID-ERPNDB,
 17691           DFHEIV20,
 17692           DFHEIV99,
 17693           ERPNDB-KEY,
 17694           DFHEIV99,
 17695           DFHEIV99,
 17696           DFHEIV99
 17697     SET ADDRESS OF PENDING-BUSINESS TO
 17698         DFHEIV20
 17699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17700
 17701
 17702     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17703     MOVE 'B'                    TO JP-RECORD-TYPE.
 17704     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17705
 17706     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17707
 17708     PERFORM 8400-LOG-JOURNAL-RECORD.
 17709
 17710     IF DRISSL GREATER THAN ZEROS
 17711        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 17712
 17713     IF DRCANCL GREATER THAN ZEROS
 17714        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 17715
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 328
* EL6311.cbl
 17716
 17717     IF DRLFPRML GREATER THAN ZEROS
 17718        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 17719
 17720     IF DRAHPRML GREATER THAN ZEROS
 17721        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 17722
 17723     IF DRLFRFDL GREATER THAN ZEROS
 17724        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 17725
 17726     IF DRAHRFDL GREATER THAN ZEROS
 17727        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 17728
 17729 3670-REWRITE-BATCH-HEADER.
 17730     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 17731        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 17732        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 17733        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 17734        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 17735        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 17736        MOVE SPACE               TO PB-OUT-BAL-CD
 17737     ELSE
 17738        MOVE 'O'                 TO PB-OUT-BAL-CD.
 17739
 17740     MOVE 'C'                    TO JP-RECORD-TYPE.
 17741     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17742
 17743
 17744* EXEC CICS REWRITE
 17745*         DATASET      (FILE-ID-ERPNDB)
 17746*         FROM         (PENDING-BUSINESS)
 17747*    END-EXEC.
 17748     MOVE LENGTH OF
 17749      PENDING-BUSINESS
 17750       TO DFHEIV11
 17751*    MOVE '&& L                  %   #00015194' TO DFHEIV0
 17752     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17753     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17754     MOVE X'2020233030303135313934' TO DFHEIV0(25:11)
 17755     CALL 'kxdfhei1' USING DFHEIV0,
 17756           FILE-ID-ERPNDB,
 17757           PENDING-BUSINESS,
 17758           DFHEIV11,
 17759           DFHEIV99
 17760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17761
 17762
 17763     PERFORM 8400-LOG-JOURNAL-RECORD.
 17764
 17765     GO TO 7200-DISPLAY-BATCHES.
 17766
 17767 3690-NOT-FOUND.
 17768     MOVE ER-2192                TO EMI-ERROR.
 17769     MOVE -1                     TO DPFENTRL.
 17770     MOVE AL-UNBON               TO DPFENTRA.
 17771     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17772     GO TO 8200-SEND-DATAONLY.
 17773
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 329
* EL6311.cbl
 17775
 17776******************************************************************
 17777*                                                                *
 17778*           R E - D I S P L A Y   R E C O R D                    *
 17779*                                                                *
 17780******************************************************************
 17781
 17782 3900-RE-DISPLAY-RECORD.
 17783
 17784* EXEC CICS HANDLE CONDITION
 17785*         NOTFND   (3990-NOT-FOUND)
 17786*    END-EXEC.
 17787*    MOVE '"$I                   ! H #00015219' TO DFHEIV0
 17788     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17789     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17790     MOVE X'4820233030303135323139' TO DFHEIV0(25:11)
 17791     CALL 'kxdfhei1' USING DFHEIV0
 17792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17793
 17794
 17795     IF PI-DISPLAY-ORIGINAL-BATCH
 17796         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 17797     ELSE
 17798         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 17799
 17800
 17801* EXEC CICS READ
 17802*         DATASET   (FILE-ID)
 17803*         RIDFLD    (PI-PREV-KEY)
 17804*         SET       (ADDRESS OF PENDING-BUSINESS)
 17805*    END-EXEC.
 17806*    MOVE '&"S        E          (   #00015228' TO DFHEIV0
 17807     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17808     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17809     MOVE X'2020233030303135323238' TO DFHEIV0(25:11)
 17810     CALL 'kxdfhei1' USING DFHEIV0,
 17811           FILE-ID,
 17812           DFHEIV20,
 17813           DFHEIV99,
 17814           PI-PREV-KEY,
 17815           DFHEIV99,
 17816           DFHEIV99,
 17817           DFHEIV99
 17818     SET ADDRESS OF PENDING-BUSINESS TO
 17819         DFHEIV20
 17820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17821
 17822
 17823     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 17824
 17825     IF PB-ISSUE
 17826         GO TO 7000-DISPLAY-ISSUES.
 17827
 17828     IF PB-CANCELLATION
 17829         GO TO 7100-DISPLAY-CANCELS.
 17830
 17831     IF PB-BATCH-TRAILER
 17832         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 330
* EL6311.cbl
 17833
 17834 3990-NOT-FOUND.
 17835     MOVE LOW-VALUES             TO EL631BI.
 17836
 17837     IF PI-MAP-NAME = EL631B
 17838         MOVE -1                  TO BMAINTL
 17839     ELSE
 17840         MOVE -1                  TO CMAINTL.
 17841
 17842     GO TO 8100-SEND-INITIAL-MAP.
 17843
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 331
* EL6311.cbl
 17845
 17846***************************************************************
 17847*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 17848*                                                             *
 17849*      1. START BROWSE WITH                                   *
 17850*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 17851*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 17852*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 17853*                                                             *
 17854*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 17855*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 17856*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 17857*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 17858*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 17859*               AND IS IT TO BE DISPLAYED.                    *
 17860*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 17861*               DISPLAYED.                                    *
 17862*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 17863*               DISPLAYED.                                    *
 17864*                                                             *
 17865*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 17866*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 17867***************************************************************
 17868
 17869 4000-BROWSE-DETAIL-FORWARD.
 17870     IF FIRST-TIME
 17871        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 17872     ELSE
 17873        IF SHOW-RECORD
 17874           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 17875           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 17876           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 17877           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 17878           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 17879        ELSE
 17880           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 17881
 17882
 17883* EXEC CICS HANDLE CONDITION
 17884*         NOTFND   (4050-END-RECORDS)
 17885*         ENDFILE  (4050-END-RECORDS)
 17886*    END-EXEC.
 17887*    MOVE '"$I''                  ! I #00015293' TO DFHEIV0
 17888     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 17889     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17890     MOVE X'4920233030303135323933' TO DFHEIV0(25:11)
 17891     CALL 'kxdfhei1' USING DFHEIV0
 17892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17893
 17894
 17895
 17896* EXEC CICS STARTBR
 17897*         DATASET   (FILE-ID-ERPNDB2)
 17898*         RIDFLD    (ERPNDB-ALT-KEY)
 17899*    END-EXEC.
 17900     MOVE 0
 17901       TO DFHEIV11
 17902*    MOVE '&,         G          &   #00015298' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 332
* EL6311.cbl
 17903     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17904     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17905     MOVE X'2020233030303135323938' TO DFHEIV0(25:11)
 17906     CALL 'kxdfhei1' USING DFHEIV0,
 17907           FILE-ID-ERPNDB2,
 17908           ERPNDB-ALT-KEY,
 17909           DFHEIV99,
 17910           DFHEIV11,
 17911           DFHEIV99
 17912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17913
 17914
 17915     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 17916
 17917     IF FIRST-TIME OR SHOW-RECORD
 17918        MOVE SPACE               TO WS-FIRST-TIME-SW
 17919        GO TO 4005-READ-NEXT-RECORD.
 17920
 17921
 17922* EXEC CICS READNEXT
 17923*         DATASET    (FILE-ID-ERPNDB2)
 17924*         SET        (ADDRESS OF PENDING-BUSINESS)
 17925*         RIDFLD     (ERPNDB-ALT-KEY)
 17926*    END-EXEC.
 17927     MOVE 0
 17928       TO DFHEIV11
 17929*    MOVE '&.S                   )   #00015309' TO DFHEIV0
 17930     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17931     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17932     MOVE X'2020233030303135333039' TO DFHEIV0(25:11)
 17933     CALL 'kxdfhei1' USING DFHEIV0,
 17934           FILE-ID-ERPNDB2,
 17935           DFHEIV20,
 17936           DFHEIV99,
 17937           ERPNDB-ALT-KEY,
 17938           DFHEIV99,
 17939           DFHEIV11,
 17940           DFHEIV99,
 17941           DFHEIV99
 17942     SET ADDRESS OF PENDING-BUSINESS TO
 17943         DFHEIV20
 17944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17945
 17946
 17947 4005-READ-NEXT-RECORD.
 17948
 17949* EXEC CICS READNEXT
 17950*         DATASET    (FILE-ID-ERPNDB2)
 17951*         SET        (ADDRESS OF PENDING-BUSINESS)
 17952*         RIDFLD     (ERPNDB-ALT-KEY)
 17953*    END-EXEC.
 17954     MOVE 0
 17955       TO DFHEIV11
 17956*    MOVE '&.S                   )   #00015316' TO DFHEIV0
 17957     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17958     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17959     MOVE X'2020233030303135333136' TO DFHEIV0(25:11)
 17960     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 333
* EL6311.cbl
 17961           FILE-ID-ERPNDB2,
 17962           DFHEIV20,
 17963           DFHEIV99,
 17964           ERPNDB-ALT-KEY,
 17965           DFHEIV99,
 17966           DFHEIV11,
 17967           DFHEIV99,
 17968           DFHEIV99
 17969     SET ADDRESS OF PENDING-BUSINESS TO
 17970         DFHEIV20
 17971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17972
 17973
 17974     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 17975
 17976     IF WS-BATCH-PREFIX = '#CL'
 17977        GO TO 4005-READ-NEXT-RECORD.
 17978
 17979     IF SHOW-RECORD
 17980        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 17981           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 17982           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 17983           PB-STATE         NOT = PI-PB-STATE          OR
 17984           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 17985           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 17986           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 17987           GO TO 4050-END-RECORDS
 17988        ELSE
 17989           GO TO 4010-CHECK-REC-TYPE.
 17990
 17991     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 17992        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 17993        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 17994        PB-STATE            NOT = PI-PB-STATE          OR
 17995        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 17996        GO TO 4050-END-RECORDS.
 17997
 17998     IF PB-BATCH-TRAILER
 17999        GO TO 4005-READ-NEXT-RECORD.
 18000
 18001     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18002        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18003           GO TO 4005-READ-NEXT-RECORD
 18004        ELSE
 18005           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18006              GO TO 4010-CHECK-REC-TYPE
 18007           ELSE
 18008              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18009                 GO TO 4010-CHECK-REC-TYPE
 18010              ELSE
 18011                 GO TO 4005-READ-NEXT-RECORD.
 18012
 18013     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18014        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18015           GO TO 4005-READ-NEXT-RECORD.
 18016
 18017 4010-CHECK-REC-TYPE.
 18018     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 334
* EL6311.cbl
 18019         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18020             NEXT SENTENCE
 18021         ELSE
 18022             GO TO 4005-READ-NEXT-RECORD.
 18023
 18024     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18025         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18026             NEXT SENTENCE
 18027        ELSE
 18028             GO TO 4005-READ-NEXT-RECORD.
 18029
 18030     IF NOT DISPLAY-CHANGE-RECORDS AND
 18031            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18032        GO TO 4005-READ-NEXT-RECORD.
 18033
 18034     IF DISPLAY-HOLD-RECORDS AND
 18035        NOT PB-RECORD-ON-HOLD
 18036          GO TO 4005-READ-NEXT-RECORD.
 18037
 18038     IF PB-ISSUE
 18039        IF DISPLAY-CHK-REQ-RECORDS
 18040            GO TO 4005-READ-NEXT-RECORD.
 18041
 18042     IF PB-ISSUE
 18043        IF ISSUE-WITH-WARNING
 18044           IF PB-WARNING-ERRORS
 18045              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18046                  GO TO 4005-READ-NEXT-RECORD
 18047              ELSE
 18048                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18049                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18050                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18051                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18052                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18053                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18054                 GO TO 7000-DISPLAY-ISSUES
 18055           ELSE
 18056              GO TO 4005-READ-NEXT-RECORD.
 18057
 18058     IF PB-ISSUE
 18059        IF (ISSUES-IN-ERROR AND
 18060            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18061            ALL-ISSUES
 18062            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18063            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18064            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18065            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18066            MOVE PB-SV-STATE            TO PI-SV-STATE
 18067            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18068            GO TO 7000-DISPLAY-ISSUES
 18069        ELSE
 18070            GO TO 4005-READ-NEXT-RECORD.
 18071
 18072     IF PB-CANCELLATION
 18073        IF DISPLAY-CHK-REQ-RECORDS
 18074           IF PB-C-REFUND-REQUESTED
 18075              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18076              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 335
* EL6311.cbl
 18077              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18078              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18079              MOVE PB-SV-STATE            TO PI-SV-STATE
 18080              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18081              GO TO 7100-DISPLAY-CANCELS
 18082           ELSE
 18083               GO TO 4005-READ-NEXT-RECORD.
 18084
 18085     IF PB-CANCELLATION
 18086        IF CANCEL-WITH-WARNING
 18087           IF PB-WARNING-ERRORS
 18088              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18089                  GO TO 4005-READ-NEXT-RECORD
 18090              ELSE
 18091                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18092                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18093                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18094                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18095                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18096                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18097                 GO TO 7100-DISPLAY-CANCELS
 18098           ELSE
 18099              GO TO 4005-READ-NEXT-RECORD.
 18100
 18101     IF PB-CANCELLATION
 18102        IF (CANCEL-IN-ERROR  AND
 18103            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18104            ALL-CANCELS
 18105            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18106            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18107            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18108            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18109            MOVE PB-SV-STATE            TO PI-SV-STATE
 18110            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18111            GO TO 7100-DISPLAY-CANCELS.
 18112
 18113     GO TO 4005-READ-NEXT-RECORD.
 18114
 18115 4050-END-RECORDS.
 18116******************************************************************
 18117*                                                                *
 18118*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18119*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18120*         PROGRAM.                                               *
 18121*                                                                *
 18122******************************************************************
 18123
 18124     IF BROWSE-STARTED
 18125        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18126
 18127* EXEC CICS ENDBR
 18128*            DATASET  (FILE-ID-ERPNDB2)
 18129*       END-EXEC.
 18130     MOVE 0
 18131       TO DFHEIV11
 18132*    MOVE '&2                    $   #00015474' TO DFHEIV0
 18133     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18134     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 336
* EL6311.cbl
 18135     MOVE X'2020233030303135343734' TO DFHEIV0(25:11)
 18136     CALL 'kxdfhei1' USING DFHEIV0,
 18137           FILE-ID-ERPNDB2,
 18138           DFHEIV11,
 18139           DFHEIV99
 18140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18141
 18142
 18143     IF  EIBTRNID NOT = TRANS-EXB1
 18144         IF PENDING-BUS-RECS-FOUND
 18145             NEXT SENTENCE
 18146           ELSE
 18147             MOVE '9'            TO PI-BROWSE-SW
 18148             GO TO 9400-CLEAR.
 18149
 18150     IF SHOW-RECORD
 18151        MOVE ER-2253            TO EMI-ERROR
 18152       ELSE
 18153        MOVE ER-2254            TO EMI-ERROR.
 18154
 18155     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18156
 18157     IF PI-MAP-NAME = SPACES
 18158        MOVE -1                  TO DPFENTRL
 18159        MOVE EL631D               TO PI-MAP-NAME
 18160        GO TO 8100-SEND-INITIAL-MAP.
 18161
 18162     IF PI-MAP-NAME = EL631B
 18163        MOVE -1                  TO BMAINTL
 18164     ELSE
 18165        IF PI-MAP-NAME = EL631C
 18166           MOVE -1               TO CMAINTL
 18167        ELSE
 18168           MOVE -1               TO DPFENTRL.
 18169
 18170     GO TO 8200-SEND-DATAONLY.
 18171
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 337
* EL6311.cbl
 18173
 18174***************************************************************
 18175*                                                             *
 18176*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18177*                                                             *
 18178*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18179*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18180*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18181*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18182*                                                             *
 18183*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18184*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18185*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18186*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18187*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18188*                AND IS IT TO BE DISPLAYED.                   *
 18189*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18190*                DISPLAYED.                                   *
 18191*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18192*                DISPLAYED.                                   *
 18193*                                                             *
 18194*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18195*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18196*                                                             *
 18197*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18198*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18199*                THEY ARE NOT TO BE DISPLAYED.                *
 18200*                                                             *
 18201***************************************************************
 18202
 18203 4100-BROWSE-PRIMARY-FORWARD.
 18204     IF FIRST-TIME  OR SHOW-RECORD
 18205        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18206        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18207        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18208     ELSE
 18209        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18210        IF ERPNDB-BATCH-SEQ-NO = +9999
 18211           GO TO 4150-END-BATCH
 18212        ELSE
 18213           IF DISPLAY-CHANGE-RECORDS
 18214              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18215           ELSE
 18216              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18217              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18218
 18219     IF FIRST-TIME
 18220         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18221            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18222              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18223
 18224
 18225* EXEC CICS HANDLE CONDITION
 18226*         ENDFILE  (4150-END-BATCH)
 18227*    END-EXEC.
 18228*    MOVE '"$''                   ! J #00015559' TO DFHEIV0
 18229     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18230     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 338
* EL6311.cbl
 18231     MOVE X'4A20233030303135353539' TO DFHEIV0(25:11)
 18232     CALL 'kxdfhei1' USING DFHEIV0
 18233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18234
 18235
 18236 4105-READ-NEXT.
 18237
 18238* EXEC CICS HANDLE CONDITION
 18239*         NOTFND    (4150-END-BATCH)
 18240*    END-EXEC.
 18241*    MOVE '"$I                   ! K #00015564' TO DFHEIV0
 18242     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18243     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18244     MOVE X'4B20233030303135353634' TO DFHEIV0(25:11)
 18245     CALL 'kxdfhei1' USING DFHEIV0
 18246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18247
 18248
 18249     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18250
 18251     IF PI-DISPLAY-ORIGINAL-BATCH
 18252        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18253     ELSE
 18254        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18255
 18256
 18257* EXEC CICS READ
 18258*         DATASET   (FILE-ID)
 18259*         SET       (ADDRESS OF PENDING-BUSINESS)
 18260*         RIDFLD    (ERPNDB-KEY)
 18261*         GTEQ
 18262*    END-EXEC.
 18263*    MOVE '&"S        G          (   #00015575' TO DFHEIV0
 18264     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18265     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18266     MOVE X'2020233030303135353735' TO DFHEIV0(25:11)
 18267     CALL 'kxdfhei1' USING DFHEIV0,
 18268           FILE-ID,
 18269           DFHEIV20,
 18270           DFHEIV99,
 18271           ERPNDB-KEY,
 18272           DFHEIV99,
 18273           DFHEIV99,
 18274           DFHEIV99
 18275     SET ADDRESS OF PENDING-BUSINESS TO
 18276         DFHEIV20
 18277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18278
 18279
 18280     IF PI-DISPLAY-ORIGINAL-BATCH
 18281        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18282           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18283           GO TO 4150-END-BATCH
 18284        ELSE
 18285           IF PB-BATCH-TRAILER
 18286              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18287              GO TO 4105-READ-NEXT
 18288           ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 339
* EL6311.cbl
 18289              NEXT SENTENCE
 18290     ELSE
 18291        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18292           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18293           GO TO 4150-END-BATCH.
 18294
 18295     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18296
 18297     IF WS-BATCH-PREFIX = '#CL'
 18298         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18299         GO TO 4105-READ-NEXT.
 18300
 18301     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18302     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18303     MOVE PB-STATE               TO PI-PB-STATE.
 18304     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18305
 18306     IF PB-BATCH-TRAILER
 18307        IF SHOW-RECORD
 18308           GO TO 4150-END-BATCH
 18309        ELSE
 18310           MOVE ER-2251         TO EMI-ERROR
 18311           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18312           MOVE 1               TO PI-BROWSE-TYPE
 18313           GO TO 7200-DISPLAY-BATCHES.
 18314
 18315     IF SHOW-RECORD
 18316           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18317              GO TO 4110-BUMP-SEQ
 18318           ELSE
 18319              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18320                 GO TO 4110-BUMP-SEQ
 18321              ELSE
 18322                 GO TO 4107-CHECK-REC-TYPE.
 18323
 18324     IF NOT  PI-PRIMARY-WITH-SELECT
 18325        GO TO 4107-CHECK-REC-TYPE.
 18326
 18327     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18328        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18329           GO TO 4110-BUMP-SEQ
 18330        ELSE
 18331           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18332              GO TO 4107-CHECK-REC-TYPE
 18333           ELSE
 18334              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18335                 GO TO 4107-CHECK-REC-TYPE
 18336              ELSE
 18337                 GO TO 4110-BUMP-SEQ.
 18338
 18339     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18340        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18341           GO TO 4110-BUMP-SEQ.
 18342
 18343 4107-CHECK-REC-TYPE.
 18344     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18345         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18346             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 340
* EL6311.cbl
 18347           ELSE
 18348             GO TO 4110-BUMP-SEQ.
 18349
 18350     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18351         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18352             NEXT SENTENCE
 18353           ELSE
 18354             GO TO 4110-BUMP-SEQ.
 18355
 18356     IF NOT DISPLAY-CHANGE-RECORDS AND
 18357        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18358           GO TO 4110-BUMP-SEQ.
 18359
 18360     IF DISPLAY-HOLD-RECORDS AND
 18361        NOT PB-RECORD-ON-HOLD
 18362          GO TO 4110-BUMP-SEQ.
 18363
 18364     IF PB-ISSUE
 18365        IF DISPLAY-CHK-REQ-RECORDS
 18366            GO TO 4110-BUMP-SEQ.
 18367
 18368     IF PB-ISSUE
 18369        IF ISSUE-WITH-WARNING
 18370           IF PB-WARNING-ERRORS
 18371              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18372                  GO TO 4110-BUMP-SEQ
 18373              ELSE
 18374                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18375                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18376                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18377                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18378                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18379                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18380                 GO TO 7000-DISPLAY-ISSUES
 18381        ELSE
 18382            GO TO 4110-BUMP-SEQ.
 18383
 18384     IF PB-ISSUE
 18385        IF (ISSUES-IN-ERROR AND
 18386            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18387            ALL-ISSUES
 18388            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18389            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18390            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18391            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18392            MOVE PB-SV-STATE            TO PI-SV-STATE
 18393            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18394            GO TO 7000-DISPLAY-ISSUES
 18395        ELSE
 18396            GO TO 4110-BUMP-SEQ.
 18397
 18398     IF PB-CANCELLATION
 18399        IF DISPLAY-CHK-REQ-RECORDS
 18400           IF PB-C-REFUND-REQUESTED
 18401              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18402              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18403              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18404              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 341
* EL6311.cbl
 18405              MOVE PB-SV-STATE            TO PI-SV-STATE
 18406              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18407              GO TO 7100-DISPLAY-CANCELS
 18408           ELSE
 18409              GO TO 4110-BUMP-SEQ.
 18410
 18411     IF PB-CANCELLATION
 18412        IF CANCEL-WITH-WARNING
 18413           IF PB-WARNING-ERRORS
 18414              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18415                  GO TO 4110-BUMP-SEQ
 18416              ELSE
 18417                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18418                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18419                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18420                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18421                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18422                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18423                 GO TO 7100-DISPLAY-CANCELS
 18424           ELSE
 18425              GO TO 4110-BUMP-SEQ.
 18426
 18427     IF PB-CANCELLATION
 18428        IF (CANCEL-IN-ERROR  AND
 18429            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18430            ALL-CANCELS
 18431            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18432            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18433            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18434            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18435            MOVE PB-SV-STATE            TO PI-SV-STATE
 18436            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18437            GO TO 7100-DISPLAY-CANCELS.
 18438
 18439 4110-BUMP-SEQ.
 18440     IF NOT DISPLAY-CHANGE-RECORDS
 18441        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18442        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18443     ELSE
 18444        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18445           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18446           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18447        ELSE
 18448           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18449           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18450
 18451     GO TO 4105-READ-NEXT.
 18452
 18453 4150-END-BATCH.
 18454******************************************************************
 18455*                                                                *
 18456*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18457*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 18458*         PROGRAM.                                               *
 18459*                                                                *
 18460******************************************************************
 18461
 18462     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 342
* EL6311.cbl
 18463         IF PENDING-BUS-RECS-FOUND
 18464             NEXT SENTENCE
 18465           ELSE
 18466             MOVE '9'            TO PI-BROWSE-SW
 18467             GO TO 9400-CLEAR.
 18468
 18469     IF SHOW-RECORD
 18470        MOVE ER-2253             TO EMI-ERROR
 18471     ELSE
 18472        MOVE ER-2251             TO EMI-ERROR.
 18473
 18474     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18475
 18476     IF PI-MAP-NAME = SPACES
 18477        MOVE -1                  TO BMAINTL
 18478        MOVE EL631B              TO PI-MAP-NAME
 18479        GO TO 8100-SEND-INITIAL-MAP.
 18480
 18481     IF PI-MAP-NAME = EL631B
 18482        MOVE -1                  TO BMAINTL
 18483     ELSE
 18484        IF PI-MAP-NAME = EL631C
 18485           MOVE -1               TO CMAINTL
 18486        ELSE
 18487           MOVE -1               TO DPFENTRL.
 18488
 18489     GO TO 8200-SEND-DATAONLY.
 18490
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 343
* EL6311.cbl
 18492
 18493***************************************************************
 18494*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 18495*                                                             *
 18496*      1. START BROWSE WITH                                   *
 18497*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18498*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18499*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18500*                                                             *
 18501*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18502*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18503*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18504*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18505*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18506*               AND IS IT TO BE DISPLAYED.                    *
 18507*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18508*               DISPLAYED.                                    *
 18509*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18510*               DISPLAYED.                                    *
 18511*                                                             *
 18512*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18513*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18514***************************************************************
 18515
 18516 4200-BROWSE-CSR-FORWARD.
 18517
 18518     IF FIRST-TIME
 18519        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 18520     ELSE
 18521        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 18522
 18523
 18524* EXEC CICS HANDLE CONDITION
 18525*         NOTFND   (4250-END-RECORDS)
 18526*         ENDFILE  (4250-END-RECORDS)
 18527*    END-EXEC.
 18528*    MOVE '"$I''                  ! L #00015825' TO DFHEIV0
 18529     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18530     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18531     MOVE X'4C20233030303135383235' TO DFHEIV0(25:11)
 18532     CALL 'kxdfhei1' USING DFHEIV0
 18533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18534
 18535
 18536
 18537* EXEC CICS STARTBR
 18538*         DATASET   (FILE-ID-ERPNDB4)
 18539*         RIDFLD    (ERPNDB-CSR-KEY)
 18540*    END-EXEC.
 18541     MOVE 0
 18542       TO DFHEIV11
 18543*    MOVE '&,         G          &   #00015830' TO DFHEIV0
 18544     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18545     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18546     MOVE X'2020233030303135383330' TO DFHEIV0(25:11)
 18547     CALL 'kxdfhei1' USING DFHEIV0,
 18548           FILE-ID-ERPNDB4,
 18549           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 344
* EL6311.cbl
 18550           DFHEIV99,
 18551           DFHEIV11,
 18552           DFHEIV99
 18553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18554
 18555
 18556     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18557
 18558     IF FIRST-TIME
 18559        MOVE SPACE               TO WS-FIRST-TIME-SW
 18560        GO TO 4205-READ-NEXT-RECORD.
 18561
 18562
 18563* EXEC CICS READNEXT
 18564*         DATASET    (FILE-ID-ERPNDB4)
 18565*         SET        (ADDRESS OF PENDING-BUSINESS)
 18566*         RIDFLD     (ERPNDB-CSR-KEY)
 18567*    END-EXEC.
 18568     MOVE 0
 18569       TO DFHEIV11
 18570*    MOVE '&.S                   )   #00015841' TO DFHEIV0
 18571     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18572     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18573     MOVE X'2020233030303135383431' TO DFHEIV0(25:11)
 18574     CALL 'kxdfhei1' USING DFHEIV0,
 18575           FILE-ID-ERPNDB4,
 18576           DFHEIV20,
 18577           DFHEIV99,
 18578           ERPNDB-CSR-KEY,
 18579           DFHEIV99,
 18580           DFHEIV11,
 18581           DFHEIV99,
 18582           DFHEIV99
 18583     SET ADDRESS OF PENDING-BUSINESS TO
 18584         DFHEIV20
 18585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18586
 18587
 18588 4205-READ-NEXT-RECORD.
 18589
 18590
 18591* EXEC CICS READNEXT
 18592*         DATASET    (FILE-ID-ERPNDB4)
 18593*         SET        (ADDRESS OF PENDING-BUSINESS)
 18594*         RIDFLD     (ERPNDB-CSR-KEY)
 18595*    END-EXEC.
 18596     MOVE 0
 18597       TO DFHEIV11
 18598*    MOVE '&.S                   )   #00015849' TO DFHEIV0
 18599     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18600     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18601     MOVE X'2020233030303135383439' TO DFHEIV0(25:11)
 18602     CALL 'kxdfhei1' USING DFHEIV0,
 18603           FILE-ID-ERPNDB4,
 18604           DFHEIV20,
 18605           DFHEIV99,
 18606           ERPNDB-CSR-KEY,
 18607           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 345
* EL6311.cbl
 18608           DFHEIV11,
 18609           DFHEIV99,
 18610           DFHEIV99
 18611     SET ADDRESS OF PENDING-BUSINESS TO
 18612         DFHEIV20
 18613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18614
 18615
 18616     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18617
 18618     IF WS-BATCH-PREFIX = '#CL'
 18619        GO TO 4205-READ-NEXT-RECORD.
 18620
 18621     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 18622        PB-CSR-ID           NOT = PI-PB-CSR-ID
 18623        GO TO 4250-END-RECORDS.
 18624
 18625     IF PB-BATCH-TRAILER
 18626        GO TO 4205-READ-NEXT-RECORD.
 18627
 18628     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18629        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18630           GO TO 4205-READ-NEXT-RECORD
 18631        ELSE
 18632           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18633              GO TO 4210-CHECK-REC-TYPE
 18634           ELSE
 18635              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18636                 GO TO 4210-CHECK-REC-TYPE
 18637              ELSE
 18638                 GO TO 4205-READ-NEXT-RECORD.
 18639
 18640     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18641        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18642           GO TO 4205-READ-NEXT-RECORD.
 18643
 18644 4210-CHECK-REC-TYPE.
 18645     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18646         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18647             NEXT SENTENCE
 18648         ELSE
 18649             GO TO 4205-READ-NEXT-RECORD.
 18650
 18651     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18652         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18653             NEXT SENTENCE
 18654        ELSE
 18655             GO TO 4205-READ-NEXT-RECORD.
 18656
 18657     IF NOT DISPLAY-CHANGE-RECORDS AND
 18658            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18659        GO TO 4205-READ-NEXT-RECORD.
 18660
 18661     IF DISPLAY-HOLD-RECORDS AND
 18662        NOT PB-RECORD-ON-HOLD
 18663          GO TO 4205-READ-NEXT-RECORD.
 18664
 18665     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 346
* EL6311.cbl
 18666        IF DISPLAY-CHK-REQ-RECORDS
 18667            GO TO 4205-READ-NEXT-RECORD.
 18668
 18669     IF PB-ISSUE
 18670        IF ISSUE-WITH-WARNING
 18671           IF PB-WARNING-ERRORS
 18672              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18673                  GO TO 4205-READ-NEXT-RECORD
 18674              ELSE
 18675                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18676                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18677                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18678                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18679                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18680                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18681                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18682                 GO TO 7000-DISPLAY-ISSUES
 18683           ELSE
 18684              GO TO 4205-READ-NEXT-RECORD.
 18685
 18686     IF PB-ISSUE
 18687        IF (ISSUES-IN-ERROR AND
 18688            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18689            ALL-ISSUES
 18690            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18691            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18692            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18693            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18694            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18695            MOVE PB-SV-STATE            TO PI-SV-STATE
 18696            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18697            GO TO 7000-DISPLAY-ISSUES
 18698        ELSE
 18699            GO TO 4205-READ-NEXT-RECORD.
 18700
 18701     IF PB-CANCELLATION
 18702        IF DISPLAY-CHK-REQ-RECORDS
 18703           IF PB-C-REFUND-REQUESTED
 18704              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18705              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18706              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18707              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18708              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18709              MOVE PB-SV-STATE            TO PI-SV-STATE
 18710              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18711              GO TO 7100-DISPLAY-CANCELS
 18712           ELSE
 18713               GO TO 4205-READ-NEXT-RECORD.
 18714
 18715     IF PB-CANCELLATION
 18716        IF CANCEL-WITH-WARNING
 18717           IF PB-WARNING-ERRORS
 18718              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18719                  GO TO 4205-READ-NEXT-RECORD
 18720              ELSE
 18721                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18722                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18723                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 347
* EL6311.cbl
 18724                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18725                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18726                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18727                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18728                 GO TO 7100-DISPLAY-CANCELS
 18729           ELSE
 18730              GO TO 4205-READ-NEXT-RECORD.
 18731
 18732     IF PB-CANCELLATION
 18733        IF (CANCEL-IN-ERROR  AND
 18734            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18735            ALL-CANCELS
 18736            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18737            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18738            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18739            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18740            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18741            MOVE PB-SV-STATE            TO PI-SV-STATE
 18742            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18743            GO TO 7100-DISPLAY-CANCELS.
 18744
 18745     GO TO 4205-READ-NEXT-RECORD.
 18746
 18747 4250-END-RECORDS.
 18748******************************************************************
 18749*                                                                *
 18750*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18751*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18752*         PROGRAM.                                               *
 18753*                                                                *
 18754******************************************************************
 18755
 18756     IF BROWSE-STARTED
 18757        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18758
 18759* EXEC CICS ENDBR
 18760*            DATASET  (FILE-ID-ERPNDB4)
 18761*       END-EXEC.
 18762     MOVE 0
 18763       TO DFHEIV11
 18764*    MOVE '&2                    $   #00015997' TO DFHEIV0
 18765     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18766     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18767     MOVE X'2020233030303135393937' TO DFHEIV0(25:11)
 18768     CALL 'kxdfhei1' USING DFHEIV0,
 18769           FILE-ID-ERPNDB4,
 18770           DFHEIV11,
 18771           DFHEIV99
 18772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18773
 18774
 18775     IF  EIBTRNID NOT = TRANS-EXB1
 18776         IF PENDING-BUS-RECS-FOUND
 18777             NEXT SENTENCE
 18778           ELSE
 18779             MOVE '9'            TO PI-BROWSE-SW
 18780             GO TO 9400-CLEAR.
 18781
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 348
* EL6311.cbl
 18782     IF SHOW-RECORD
 18783        MOVE ER-2253            TO EMI-ERROR
 18784       ELSE
 18785        MOVE ER-2254            TO EMI-ERROR.
 18786
 18787     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18788
 18789     IF PI-MAP-NAME = SPACES
 18790        MOVE -1                  TO DPFENTRL
 18791        MOVE EL631D               TO PI-MAP-NAME
 18792        GO TO 8100-SEND-INITIAL-MAP.
 18793
 18794     IF PI-MAP-NAME = EL631B
 18795        MOVE -1                  TO BMAINTL
 18796     ELSE
 18797        IF PI-MAP-NAME = EL631C
 18798           MOVE -1               TO CMAINTL
 18799        ELSE
 18800           MOVE -1               TO DPFENTRL.
 18801
 18802     GO TO 8200-SEND-DATAONLY.
 18803
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 349
* EL6311.cbl
 18805
 18806***************************************************************
 18807*                                                             *
 18808*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 18809*                                                             *
 18810*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 18811*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18812*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18813*                                                             *
 18814*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18815*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18816*          A. IS IT WITHIN THE SAME COMPANY                   *
 18817*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18818*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18819*                AND IS IT TO BE DISPLAYED.                   *
 18820*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18821*                DISPLAYED.                                   *
 18822*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18823*                DISPLAYED.                                   *
 18824*                                                             *
 18825*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18826*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18827*                                                             *
 18828*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18829*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18830*                THEY ARE NOT TO BE DISPLAYED.                *
 18831*                                                             *
 18832***************************************************************
 18833
 18834 4300-BROWSE-FILE-FORWARD.
 18835     IF FIRST-TIME OR SHOW-RECORD
 18836        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 18837        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 18838        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18839     ELSE
 18840        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18841        IF ERPNDB-BATCH-SEQ-NO = +9999
 18842           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 18843        ELSE
 18844           IF DISPLAY-CHANGE-RECORDS
 18845              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18846           ELSE
 18847              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18848              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18849
 18850
 18851* EXEC CICS HANDLE CONDITION
 18852*         ENDFILE  (4350-END-BATCH)
 18853*         NOTFND   (4350-END-BATCH)
 18854*    END-EXEC.
 18855*    MOVE '"$''I                  ! M #00016076' TO DFHEIV0
 18856     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18857     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18858     MOVE X'4D20233030303136303736' TO DFHEIV0(25:11)
 18859     CALL 'kxdfhei1' USING DFHEIV0
 18860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18861
 18862
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 350
* EL6311.cbl
 18863 4305-READ-NEXT.
 18864     IF PI-DISPLAY-ORIGINAL-BATCH
 18865        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18866     ELSE
 18867        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18868
 18869
 18870* EXEC CICS READ
 18871*         DATASET   (FILE-ID)
 18872*         SET       (ADDRESS OF PENDING-BUSINESS)
 18873*         RIDFLD    (ERPNDB-KEY)
 18874*         GTEQ
 18875*    END-EXEC.
 18876*    MOVE '&"S        G          (   #00016087' TO DFHEIV0
 18877     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18878     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18879     MOVE X'2020233030303136303837' TO DFHEIV0(25:11)
 18880     CALL 'kxdfhei1' USING DFHEIV0,
 18881           FILE-ID,
 18882           DFHEIV20,
 18883           DFHEIV99,
 18884           ERPNDB-KEY,
 18885           DFHEIV99,
 18886           DFHEIV99,
 18887           DFHEIV99
 18888     SET ADDRESS OF PENDING-BUSINESS TO
 18889         DFHEIV20
 18890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18891
 18892
 18893     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 18894        GO TO 4350-END-BATCH.
 18895
 18896     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 18897                                    WS-BATCH-NO.
 18898
 18899     IF  WS-BATCH-PREFIX = '#CL'
 18900         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18901         GO TO 4305-READ-NEXT.
 18902
 18903     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 18904     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18905     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18906     MOVE PB-STATE               TO PI-PB-STATE.
 18907     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18908
 18909     IF PB-BATCH-TRAILER
 18910        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 18911        GO TO 4305-READ-NEXT.
 18912
 18913     IF SHOW-RECORD
 18914           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18915              GO TO 4310-BUMP-SEQ
 18916           ELSE
 18917              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18918                 GO TO 4310-BUMP-SEQ
 18919              ELSE
 18920                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 351
* EL6311.cbl
 18921
 18922     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18923        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18924           GO TO 4310-BUMP-SEQ
 18925        ELSE
 18926           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18927              GO TO 4307-CHECK-REC-TYPE
 18928           ELSE
 18929              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18930                 GO TO 4307-CHECK-REC-TYPE
 18931              ELSE
 18932                 GO TO 4310-BUMP-SEQ.
 18933
 18934     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18935        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18936           GO TO 4310-BUMP-SEQ.
 18937
 18938 4307-CHECK-REC-TYPE.
 18939     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18940         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18941             NEXT SENTENCE
 18942         ELSE
 18943             GO TO 4310-BUMP-SEQ.
 18944
 18945     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18946         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18947             NEXT SENTENCE
 18948        ELSE
 18949             GO TO 4310-BUMP-SEQ.
 18950
 18951     IF NOT DISPLAY-CHANGE-RECORDS AND
 18952            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18953        GO TO 4310-BUMP-SEQ.
 18954
 18955     IF DISPLAY-HOLD-RECORDS AND
 18956        NOT PB-RECORD-ON-HOLD
 18957          GO TO 4310-BUMP-SEQ.
 18958
 18959     IF PB-ISSUE
 18960        IF DISPLAY-CHK-REQ-RECORDS
 18961           GO TO 4310-BUMP-SEQ.
 18962
 18963     IF PB-ISSUE
 18964        IF ISSUE-WITH-WARNING
 18965           IF PB-WARNING-ERRORS
 18966              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18967                  GO TO 4310-BUMP-SEQ
 18968              ELSE
 18969                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18970                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18971                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18972                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18973                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18974                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18975                 GO TO 7000-DISPLAY-ISSUES
 18976           ELSE
 18977              GO TO 4310-BUMP-SEQ.
 18978
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 352
* EL6311.cbl
 18979     IF PB-ISSUE
 18980        IF (ISSUES-IN-ERROR AND
 18981            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18982            ALL-ISSUES
 18983            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18984            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18985            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18986            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18987            MOVE PB-SV-STATE            TO PI-SV-STATE
 18988            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18989            GO TO 7000-DISPLAY-ISSUES
 18990        ELSE
 18991            GO TO 4310-BUMP-SEQ.
 18992
 18993     IF PB-CANCELLATION
 18994        IF DISPLAY-CHK-REQ-RECORDS
 18995           IF PB-C-REFUND-REQUESTED
 18996              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18997              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18998              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18999              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19000              MOVE PB-SV-STATE            TO PI-SV-STATE
 19001              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19002              GO TO 7100-DISPLAY-CANCELS
 19003           ELSE
 19004              GO TO 4310-BUMP-SEQ.
 19005
 19006     IF PB-CANCELLATION
 19007        IF CANCEL-WITH-WARNING
 19008           IF PB-WARNING-ERRORS
 19009              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19010                  GO TO 4310-BUMP-SEQ
 19011              ELSE
 19012                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19013                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19014                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19015                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19016                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19017                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19018                 GO TO 7100-DISPLAY-CANCELS
 19019           ELSE
 19020              GO TO 4310-BUMP-SEQ.
 19021
 19022     IF PB-CANCELLATION
 19023        IF (CANCEL-IN-ERROR  AND
 19024            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19025            ALL-CANCELS
 19026            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19027            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19028            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19029            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19030            MOVE PB-SV-STATE            TO PI-SV-STATE
 19031            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19032            GO TO 7100-DISPLAY-CANCELS.
 19033
 19034 4310-BUMP-SEQ.
 19035     IF NOT DISPLAY-CHANGE-RECORDS
 19036        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 353
* EL6311.cbl
 19037        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19038     ELSE
 19039        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19040           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19041           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19042        ELSE
 19043           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19044           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19045
 19046     GO TO 4305-READ-NEXT.
 19047
 19048 4350-END-BATCH.
 19049
 19050******************************************************************
 19051*                                                                *
 19052*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19053*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19054*         PROGRAM.                                               *
 19055*                                                                *
 19056******************************************************************
 19057
 19058     IF  EIBTRNID NOT = TRANS-EXB1
 19059         IF PENDING-BUS-RECS-FOUND
 19060             NEXT SENTENCE
 19061           ELSE
 19062             MOVE '9'            TO PI-BROWSE-SW
 19063             GO TO 9400-CLEAR.
 19064
 19065     IF SHOW-RECORD
 19066        MOVE ER-2253            TO EMI-ERROR
 19067     ELSE
 19068        MOVE ER-2251            TO EMI-ERROR.
 19069
 19070     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19071
 19072     IF PI-MAP-NAME = SPACES
 19073        MOVE -1                  TO BMAINTL
 19074        MOVE EL631B               TO PI-MAP-NAME
 19075        GO TO 8100-SEND-INITIAL-MAP.
 19076
 19077     IF PI-MAP-NAME = EL631B
 19078        MOVE -1                  TO BMAINTL
 19079     ELSE
 19080        IF PI-MAP-NAME = EL631C
 19081           MOVE -1               TO CMAINTL
 19082        ELSE
 19083           MOVE -1               TO DPFENTRL.
 19084
 19085     GO TO 8200-SEND-DATAONLY.
 19086
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 354
* EL6311.cbl
 19088
 19089******************************************************************
 19090*                                                                *
 19091*        B R O W S E   D E T A I L   B A C K W A R D             *
 19092*                                                                *
 19093******************************************************************
 19094
 19095 4500-BROWSE-DETAIL-BACKWARD.
 19096
 19097     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19098
 19099
 19100* EXEC CICS HANDLE CONDITION
 19101*         NOTFND   (4570-NOT-FOUND)
 19102*         ENDFILE  (4550-END-RECORDS)
 19103*    END-EXEC
 19104*    MOVE '"$I''                  ! N #00016300' TO DFHEIV0
 19105     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19107     MOVE X'4E20233030303136333030' TO DFHEIV0(25:11)
 19108     CALL 'kxdfhei1' USING DFHEIV0
 19109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19110
 19111
 19112* EXEC CICS STARTBR
 19113*         DATASET   (FILE-ID-ERPNDB2)
 19114*         RIDFLD    (ERPNDB-ALT-KEY)
 19115*    END-EXEC.
 19116     MOVE 0
 19117       TO DFHEIV11
 19118*    MOVE '&,         G          &   #00016305' TO DFHEIV0
 19119     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19120     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19121     MOVE X'2020233030303136333035' TO DFHEIV0(25:11)
 19122     CALL 'kxdfhei1' USING DFHEIV0,
 19123           FILE-ID-ERPNDB2,
 19124           ERPNDB-ALT-KEY,
 19125           DFHEIV99,
 19126           DFHEIV11,
 19127           DFHEIV99
 19128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19129
 19130
 19131     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19132                                    WS-FIRST-TIME-SW.
 19133
 19134 4505-READ-PREV-RECORD.
 19135
 19136* EXEC CICS READPREV
 19137*         DATASET    (FILE-ID-ERPNDB2)
 19138*         SET        (ADDRESS OF PENDING-BUSINESS)
 19139*         RIDFLD     (ERPNDB-ALT-KEY)
 19140*    END-EXEC.
 19141     MOVE 0
 19142       TO DFHEIV11
 19143*    MOVE '&0S                   )   #00016314' TO DFHEIV0
 19144     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19145     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 355
* EL6311.cbl
 19146     MOVE X'2020233030303136333134' TO DFHEIV0(25:11)
 19147     CALL 'kxdfhei1' USING DFHEIV0,
 19148           FILE-ID-ERPNDB2,
 19149           DFHEIV20,
 19150           DFHEIV99,
 19151           ERPNDB-ALT-KEY,
 19152           DFHEIV99,
 19153           DFHEIV11,
 19154           DFHEIV99,
 19155           DFHEIV99
 19156     SET ADDRESS OF PENDING-BUSINESS TO
 19157         DFHEIV20
 19158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19159
 19160
 19161     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19162
 19163     IF WS-BATCH-PREFIX = '#CL'
 19164         GO TO 4505-READ-PREV-RECORD.
 19165
 19166     IF FIRST-TIME
 19167         MOVE SPACE               TO WS-FIRST-TIME-SW
 19168         GO TO 4505-READ-PREV-RECORD.
 19169
 19170     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19171        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19172        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19173        PB-STATE         NOT = PI-PB-STATE    OR
 19174        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19175          GO TO 4550-END-RECORDS.
 19176
 19177
 19178     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19179
 19180     IF PB-BATCH-TRAILER
 19181        GO TO 4505-READ-PREV-RECORD.
 19182
 19183     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19184
 19185     IF  WS-BATCH-PREFIX = '#CL'
 19186         GO TO 4505-READ-PREV-RECORD.
 19187
 19188     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19189        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19190           GO TO 4505-READ-PREV-RECORD
 19191        ELSE
 19192           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19193              GO TO 4510-CHECK-REC-TYPE
 19194           ELSE
 19195              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19196                 GO TO 4510-CHECK-REC-TYPE
 19197              ELSE
 19198                 GO TO 4505-READ-PREV-RECORD.
 19199
 19200     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19201        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19202           GO TO 4505-READ-PREV-RECORD.
 19203
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 356
* EL6311.cbl
 19204 4510-CHECK-REC-TYPE.
 19205     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19206         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19207             NEXT SENTENCE
 19208         ELSE
 19209             GO TO 4505-READ-PREV-RECORD.
 19210
 19211     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19212         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19213             NEXT SENTENCE
 19214        ELSE
 19215             GO TO 4505-READ-PREV-RECORD.
 19216
 19217     IF NOT DISPLAY-CHANGE-RECORDS AND
 19218            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19219        GO TO 4505-READ-PREV-RECORD.
 19220
 19221     IF DISPLAY-HOLD-RECORDS AND
 19222        NOT PB-RECORD-ON-HOLD
 19223          GO TO 4505-READ-PREV-RECORD.
 19224
 19225     IF PB-ISSUE
 19226        IF DISPLAY-CHK-REQ-RECORDS
 19227           GO TO 4505-READ-PREV-RECORD.
 19228
 19229     IF PB-ISSUE
 19230        IF ISSUE-WITH-WARNING
 19231           IF PB-WARNING-ERRORS
 19232              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19233                  GO TO 4505-READ-PREV-RECORD
 19234              ELSE
 19235                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19236                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19237                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19238                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19239                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19240                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19241                 GO TO 7000-DISPLAY-ISSUES
 19242           ELSE
 19243              GO TO 4505-READ-PREV-RECORD.
 19244
 19245     IF PB-ISSUE
 19246        IF (ISSUES-IN-ERROR AND
 19247            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19248            ALL-ISSUES
 19249            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19250            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19251            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19252            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19253            MOVE PB-SV-STATE            TO PI-SV-STATE
 19254            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19255            GO TO 7000-DISPLAY-ISSUES
 19256        ELSE
 19257            GO TO 4505-READ-PREV-RECORD.
 19258
 19259     IF PB-CANCELLATION
 19260        IF DISPLAY-CHK-REQ-RECORDS
 19261           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 357
* EL6311.cbl
 19262              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19263              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19264              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19265              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19266              MOVE PB-SV-STATE            TO PI-SV-STATE
 19267              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19268              GO TO 7100-DISPLAY-CANCELS
 19269           ELSE
 19270              GO TO 4505-READ-PREV-RECORD.
 19271
 19272     IF PB-CANCELLATION
 19273        IF CANCEL-WITH-WARNING
 19274           IF PB-WARNING-ERRORS
 19275              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19276                  GO TO 4505-READ-PREV-RECORD
 19277              ELSE
 19278                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19279                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19280                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19281                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19282                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19283                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19284                 GO TO 7100-DISPLAY-CANCELS
 19285           ELSE
 19286              GO TO 4505-READ-PREV-RECORD.
 19287
 19288     IF PB-CANCELLATION
 19289        IF (CANCEL-IN-ERROR  AND
 19290            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19291            ALL-CANCELS
 19292            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19293            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19294            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19295            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19296            MOVE PB-SV-STATE            TO PI-SV-STATE
 19297            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19298            GO TO 7100-DISPLAY-CANCELS.
 19299
 19300     GO TO 4505-READ-PREV-RECORD.
 19301
 19302 4550-END-RECORDS.
 19303     IF PI-MAP-NAME = EL631B
 19304        MOVE -1                  TO BMAINTL
 19305     ELSE
 19306        IF PI-MAP-NAME = EL631C
 19307           MOVE -1               TO CMAINTL
 19308        ELSE
 19309           MOVE -1               TO DPFENTRL.
 19310
 19311     MOVE ER-2255               TO EMI-ERROR.
 19312     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19313     GO TO 8200-SEND-DATAONLY.
 19314
 19315 4570-NOT-FOUND.
 19316
 19317******************************************************************
 19318*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19319******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 358
* EL6311.cbl
 19320
 19321
 19322* EXEC CICS RESETBR
 19323*         DATASET    (FILE-ID-ERPNDB2)
 19324*         RIDFLD     (ERPNDB-ALT-KEY)
 19325*    END-EXEC.
 19326     MOVE 0
 19327       TO DFHEIV11
 19328*    MOVE '&4         G          &   #00016480' TO DFHEIV0
 19329     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19330     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19331     MOVE X'2020233030303136343830' TO DFHEIV0(25:11)
 19332     CALL 'kxdfhei1' USING DFHEIV0,
 19333           FILE-ID-ERPNDB2,
 19334           ERPNDB-ALT-KEY,
 19335           DFHEIV99,
 19336           DFHEIV11,
 19337           DFHEIV99
 19338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19339
 19340
 19341
 19342* EXEC CICS READNEXT
 19343*         DATASET    (FILE-ID-ERPNDB2)
 19344*         SET        (ADDRESS OF PENDING-BUSINESS)
 19345*         RIDFLD     (ERPNDB-ALT-KEY)
 19346*    END-EXEC.
 19347     MOVE 0
 19348       TO DFHEIV11
 19349*    MOVE '&.S                   )   #00016485' TO DFHEIV0
 19350     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19351     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19352     MOVE X'2020233030303136343835' TO DFHEIV0(25:11)
 19353     CALL 'kxdfhei1' USING DFHEIV0,
 19354           FILE-ID-ERPNDB2,
 19355           DFHEIV20,
 19356           DFHEIV99,
 19357           ERPNDB-ALT-KEY,
 19358           DFHEIV99,
 19359           DFHEIV11,
 19360           DFHEIV99,
 19361           DFHEIV99
 19362     SET ADDRESS OF PENDING-BUSINESS TO
 19363         DFHEIV20
 19364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19365
 19366
 19367
 19368* EXEC CICS READPREV
 19369*         DATASET    (FILE-ID-ERPNDB2)
 19370*         SET        (ADDRESS OF PENDING-BUSINESS)
 19371*         RIDFLD     (ERPNDB-ALT-KEY)
 19372*    END-EXEC.
 19373     MOVE 0
 19374       TO DFHEIV11
 19375*    MOVE '&0S                   )   #00016491' TO DFHEIV0
 19376     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19377     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 359
* EL6311.cbl
 19378     MOVE X'2020233030303136343931' TO DFHEIV0(25:11)
 19379     CALL 'kxdfhei1' USING DFHEIV0,
 19380           FILE-ID-ERPNDB2,
 19381           DFHEIV20,
 19382           DFHEIV99,
 19383           ERPNDB-ALT-KEY,
 19384           DFHEIV99,
 19385           DFHEIV11,
 19386           DFHEIV99,
 19387           DFHEIV99
 19388     SET ADDRESS OF PENDING-BUSINESS TO
 19389         DFHEIV20
 19390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19391
 19392
 19393 4580-READ-PREV-RECORD.
 19394
 19395* EXEC CICS READPREV
 19396*         DATASET    (FILE-ID-ERPNDB2)
 19397*         SET        (ADDRESS OF PENDING-BUSINESS)
 19398*         RIDFLD     (ERPNDB-ALT-KEY)
 19399*    END-EXEC.
 19400     MOVE 0
 19401       TO DFHEIV11
 19402*    MOVE '&0S                   )   #00016498' TO DFHEIV0
 19403     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19404     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19405     MOVE X'2020233030303136343938' TO DFHEIV0(25:11)
 19406     CALL 'kxdfhei1' USING DFHEIV0,
 19407           FILE-ID-ERPNDB2,
 19408           DFHEIV20,
 19409           DFHEIV99,
 19410           ERPNDB-ALT-KEY,
 19411           DFHEIV99,
 19412           DFHEIV11,
 19413           DFHEIV99,
 19414           DFHEIV99
 19415     SET ADDRESS OF PENDING-BUSINESS TO
 19416         DFHEIV20
 19417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19418
 19419
 19420     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19421
 19422     IF WS-BATCH-PREFIX = '#CL'
 19423        GO TO 4580-READ-PREV-RECORD.
 19424
 19425     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19426     GO TO 4505-READ-PREV-RECORD.
 19427
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 360
* EL6311.cbl
 19429
 19430******************************************************************
 19431*                                                                *
 19432*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19433*                                                                *
 19434******************************************************************
 19435
 19436 4600-BROWSE-PRIMARY-BACKWARD.
 19437        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19438
 19439     IF ERPNDB-BATCH-SEQ-NO = +9999
 19440        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19441
 19442        IF ERPNDB-BATCH-SEQ-NO = +0000
 19443           GO TO 4650-END-BATCH
 19444        ELSE
 19445           IF PI-MAP-NAME NOT = EL631D
 19446              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19447                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19448              ELSE
 19449                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19450                 IF DISPLAY-CHANGE-RECORDS
 19451                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19452                 ELSE
 19453                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19454
 19455
 19456* EXEC CICS HANDLE CONDITION
 19457*         NOTFND    (4680-NOT-FOUND)
 19458*         ENDFILE   (4680-NOT-FOUND)
 19459*    END-EXEC.
 19460*    MOVE '"$I''                  ! O #00016539' TO DFHEIV0
 19461     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19462     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19463     MOVE X'4F20233030303136353339' TO DFHEIV0(25:11)
 19464     CALL 'kxdfhei1' USING DFHEIV0
 19465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19466
 19467
 19468 4605-READ-NEXT.
 19469     IF ERPNDB-BATCH-SEQ-NO = +0000
 19470        GO TO 4650-END-BATCH.
 19471
 19472     IF PI-DISPLAY-ORIGINAL-BATCH
 19473        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19474     ELSE
 19475        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19476
 19477
 19478* EXEC CICS READ
 19479*         DATASET   (FILE-ID)
 19480*         SET       (ADDRESS OF PENDING-BUSINESS)
 19481*         RIDFLD    (ERPNDB-KEY)
 19482*    END-EXEC.
 19483*    MOVE '&"S        E          (   #00016553' TO DFHEIV0
 19484     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19485     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19486     MOVE X'2020233030303136353533' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 361
* EL6311.cbl
 19487     CALL 'kxdfhei1' USING DFHEIV0,
 19488           FILE-ID,
 19489           DFHEIV20,
 19490           DFHEIV99,
 19491           ERPNDB-KEY,
 19492           DFHEIV99,
 19493           DFHEIV99,
 19494           DFHEIV99
 19495     SET ADDRESS OF PENDING-BUSINESS TO
 19496         DFHEIV20
 19497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19498
 19499
 19500     IF NOT  PI-PRIMARY-WITH-SELECT
 19501        GO TO 4607-CHECK-REC-TYPE.
 19502
 19503     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19504
 19505     IF  WS-BATCH-PREFIX = '#CL'
 19506         GO TO 4610-BUMP-SEQ.
 19507
 19508     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19509        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19510           GO TO 4610-BUMP-SEQ
 19511        ELSE
 19512           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19513              GO TO 4607-CHECK-REC-TYPE
 19514           ELSE
 19515              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19516                 GO TO 4607-CHECK-REC-TYPE
 19517              ELSE
 19518                 GO TO 4610-BUMP-SEQ.
 19519
 19520     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19521        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19522           GO TO 4610-BUMP-SEQ.
 19523
 19524 4607-CHECK-REC-TYPE.
 19525     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19526         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19527             NEXT SENTENCE
 19528         ELSE
 19529             GO TO 4610-BUMP-SEQ.
 19530
 19531     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19532         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19533             NEXT SENTENCE
 19534        ELSE
 19535             GO TO 4610-BUMP-SEQ.
 19536
 19537     IF NOT DISPLAY-CHANGE-RECORDS AND
 19538            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19539        GO TO 4610-BUMP-SEQ.
 19540
 19541     IF DISPLAY-HOLD-RECORDS AND
 19542        NOT PB-RECORD-ON-HOLD
 19543          GO TO 4610-BUMP-SEQ.
 19544
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 362
* EL6311.cbl
 19545     IF PB-ISSUE
 19546        IF DISPLAY-CHK-REQ-RECORDS
 19547           GO TO 4610-BUMP-SEQ.
 19548
 19549     IF PB-ISSUE
 19550        IF ISSUE-WITH-WARNING
 19551           IF PB-WARNING-ERRORS
 19552              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19553                  GO TO 4610-BUMP-SEQ
 19554              ELSE
 19555                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19556                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19557                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19558                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19559                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19560                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19561                 GO TO 7000-DISPLAY-ISSUES
 19562           ELSE
 19563              GO TO 4610-BUMP-SEQ.
 19564
 19565     IF PB-ISSUE
 19566        IF (ISSUES-IN-ERROR AND
 19567            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19568            ALL-ISSUES
 19569            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19570            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19571            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19572            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19573            MOVE PB-SV-STATE            TO PI-SV-STATE
 19574            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19575            GO TO 7000-DISPLAY-ISSUES
 19576        ELSE
 19577            GO TO 4610-BUMP-SEQ.
 19578
 19579     IF PB-CANCELLATION
 19580        IF DISPLAY-CHK-REQ-RECORDS
 19581           IF PB-C-REFUND-REQUESTED
 19582              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19583              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19584              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19585              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19586              MOVE PB-SV-STATE            TO PI-SV-STATE
 19587              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19588              GO TO 7100-DISPLAY-CANCELS
 19589           ELSE
 19590              GO TO 4610-BUMP-SEQ.
 19591
 19592     IF PB-CANCELLATION
 19593        IF CANCEL-WITH-WARNING
 19594           IF PB-WARNING-ERRORS
 19595              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19596                  GO TO 4610-BUMP-SEQ
 19597              ELSE
 19598                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19599                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19600                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19601                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19602                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 363
* EL6311.cbl
 19603                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19604                 GO TO 7100-DISPLAY-CANCELS
 19605           ELSE
 19606              GO TO 4610-BUMP-SEQ.
 19607
 19608     IF PB-CANCELLATION
 19609        IF (CANCEL-IN-ERROR  AND
 19610            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19611            ALL-CANCELS
 19612            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19613            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19614            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19615            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19616            MOVE PB-SV-STATE            TO PI-SV-STATE
 19617            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19618            GO TO 7100-DISPLAY-CANCELS.
 19619
 19620 4610-BUMP-SEQ.
 19621     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 19622        GO TO 4650-END-BATCH.
 19623
 19624     IF DISPLAY-CHANGE-RECORDS
 19625        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19626           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 19627        ELSE
 19628           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19629           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19630        ELSE
 19631           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19632           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 19633
 19634        GO TO 4605-READ-NEXT.
 19635
 19636 4650-END-BATCH.
 19637     IF PI-MAP-NAME = EL631B
 19638        MOVE -1                  TO BMAINTL
 19639     ELSE
 19640        IF PI-MAP-NAME = EL631C
 19641           MOVE -1               TO CMAINTL
 19642        ELSE
 19643           MOVE -1               TO DPFENTRL.
 19644
 19645     MOVE ER-2252               TO EMI-ERROR.
 19646     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19647     GO TO 8200-SEND-DATAONLY.
 19648
 19649 4680-NOT-FOUND.
 19650     IF DISPLAY-CHANGE-RECORDS
 19651        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19652           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19653        ELSE
 19654           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19655           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19656     ELSE
 19657        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 19658
 19659     GO TO 4605-READ-NEXT.
 19660
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 364
* EL6311.cbl
 19662
 19663******************************************************************
 19664*                                                                *
 19665*        B R O W S E   F I L E   B A C K W A R D S               *
 19666*                                                                *
 19667******************************************************************
 19668
 19669 4800-BROWSE-FILE-BACKWARD.
 19670
 19671* EXEC CICS HANDLE CONDITION
 19672*         NOTFND   (4860-NOT-FOUND)
 19673*         ENDFILE  (4850-END-RECORDS)
 19674*    END-EXEC.
 19675*    MOVE '"$I''                  ! P #00016729' TO DFHEIV0
 19676     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19677     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19678     MOVE X'5020233030303136373239' TO DFHEIV0(25:11)
 19679     CALL 'kxdfhei1' USING DFHEIV0
 19680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19681
 19682
 19683     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 19684
 19685     IF PI-DISPLAY-ORIGINAL-BATCH
 19686        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19687     ELSE
 19688        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19689
 19690
 19691* EXEC CICS STARTBR
 19692*         DATASET   (FILE-ID)
 19693*         RIDFLD    (ERPNDB-KEY)
 19694*    END-EXEC.
 19695     MOVE 0
 19696       TO DFHEIV11
 19697*    MOVE '&,         G          &   #00016741' TO DFHEIV0
 19698     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19699     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19700     MOVE X'2020233030303136373431' TO DFHEIV0(25:11)
 19701     CALL 'kxdfhei1' USING DFHEIV0,
 19702           FILE-ID,
 19703           ERPNDB-KEY,
 19704           DFHEIV99,
 19705           DFHEIV11,
 19706           DFHEIV99
 19707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19708
 19709
 19710     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19711
 19712
 19713* EXEC CICS READPREV
 19714*         DATASET    (FILE-ID-ERPNDB)
 19715*         SET        (ADDRESS OF PENDING-BUSINESS)
 19716*         RIDFLD     (ERPNDB-KEY)
 19717*    END-EXEC.
 19718     MOVE 0
 19719       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 365
* EL6311.cbl
 19720*    MOVE '&0S                   )   #00016748' TO DFHEIV0
 19721     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19722     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19723     MOVE X'2020233030303136373438' TO DFHEIV0(25:11)
 19724     CALL 'kxdfhei1' USING DFHEIV0,
 19725           FILE-ID-ERPNDB,
 19726           DFHEIV20,
 19727           DFHEIV99,
 19728           ERPNDB-KEY,
 19729           DFHEIV99,
 19730           DFHEIV11,
 19731           DFHEIV99,
 19732           DFHEIV99
 19733     SET ADDRESS OF PENDING-BUSINESS TO
 19734         DFHEIV20
 19735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19736
 19737
 19738 4810-READ-PREV-RECORD.
 19739
 19740* EXEC CICS READPREV
 19741*         DATASET    (FILE-ID-ERPNDB)
 19742*         SET        (ADDRESS OF PENDING-BUSINESS)
 19743*         RIDFLD     (ERPNDB-KEY)
 19744*    END-EXEC.
 19745     MOVE 0
 19746       TO DFHEIV11
 19747*    MOVE '&0S                   )   #00016755' TO DFHEIV0
 19748     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19749     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19750     MOVE X'2020233030303136373535' TO DFHEIV0(25:11)
 19751     CALL 'kxdfhei1' USING DFHEIV0,
 19752           FILE-ID-ERPNDB,
 19753           DFHEIV20,
 19754           DFHEIV99,
 19755           ERPNDB-KEY,
 19756           DFHEIV99,
 19757           DFHEIV11,
 19758           DFHEIV99,
 19759           DFHEIV99
 19760     SET ADDRESS OF PENDING-BUSINESS TO
 19761         DFHEIV20
 19762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19763
 19764
 19765     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 19766        GO TO 4850-END-RECORDS.
 19767
 19768     IF PB-BATCH-TRAILER
 19769        GO TO 4810-READ-PREV-RECORD.
 19770
 19771     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19772
 19773     IF  WS-BATCH-PREFIX = '#CL'
 19774         GO TO 4810-READ-PREV-RECORD.
 19775
 19776     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19777        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 366
* EL6311.cbl
 19778           GO TO 4810-READ-PREV-RECORD
 19779        ELSE
 19780           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19781              GO TO 4820-CHECK-REC-TYPE
 19782           ELSE
 19783              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19784                 GO TO 4820-CHECK-REC-TYPE
 19785              ELSE
 19786                 GO TO 4810-READ-PREV-RECORD.
 19787
 19788     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19789        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19790           GO TO 4810-READ-PREV-RECORD.
 19791
 19792 4820-CHECK-REC-TYPE.
 19793     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19794         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19795             NEXT SENTENCE
 19796         ELSE
 19797             GO TO 4810-READ-PREV-RECORD.
 19798
 19799     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19800         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19801             NEXT SENTENCE
 19802        ELSE
 19803             GO TO 4810-READ-PREV-RECORD.
 19804
 19805     IF NOT DISPLAY-CHANGE-RECORDS AND
 19806            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19807        GO TO 4810-READ-PREV-RECORD.
 19808
 19809     IF DISPLAY-HOLD-RECORDS AND
 19810        NOT PB-RECORD-ON-HOLD
 19811          GO TO 4810-READ-PREV-RECORD.
 19812
 19813     IF PB-ISSUE
 19814        IF DISPLAY-CHK-REQ-RECORDS
 19815           GO TO 4810-READ-PREV-RECORD.
 19816
 19817     IF PB-ISSUE
 19818        IF ISSUE-WITH-WARNING
 19819           IF PB-WARNING-ERRORS
 19820              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19821                  GO TO 4810-READ-PREV-RECORD
 19822              ELSE
 19823                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19824                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19825                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19826                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19827                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19828                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19829                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19830                 GO TO 7000-DISPLAY-ISSUES
 19831           ELSE
 19832              GO TO 4810-READ-PREV-RECORD.
 19833
 19834     IF PB-ISSUE
 19835        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 367
* EL6311.cbl
 19836            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19837            ALL-ISSUES
 19838            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19839            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19840            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19841            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19842            MOVE PB-SV-STATE            TO PI-SV-STATE
 19843            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19844            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19845            GO TO 7000-DISPLAY-ISSUES
 19846        ELSE
 19847            GO TO 4810-READ-PREV-RECORD.
 19848
 19849     IF PB-CANCELLATION
 19850        IF DISPLAY-CHK-REQ-RECORDS
 19851           IF PB-C-REFUND-REQUESTED
 19852              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19853              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19854              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19855              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19856              MOVE PB-SV-STATE            TO PI-SV-STATE
 19857              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19858              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19859              GO TO 7100-DISPLAY-CANCELS
 19860           ELSE
 19861              GO TO 4810-READ-PREV-RECORD.
 19862
 19863     IF PB-CANCELLATION
 19864        IF CANCEL-WITH-WARNING
 19865           IF PB-WARNING-ERRORS
 19866              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19867                  GO TO 4810-READ-PREV-RECORD
 19868              ELSE
 19869                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19870                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19871                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19872                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19873                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19874                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19875                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19876                 GO TO 7100-DISPLAY-CANCELS
 19877           ELSE
 19878              GO TO 4810-READ-PREV-RECORD.
 19879
 19880     IF PB-CANCELLATION
 19881        IF (CANCEL-IN-ERROR  AND
 19882            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19883            ALL-CANCELS
 19884            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19885            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19886            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19887            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19888            MOVE PB-SV-STATE            TO PI-SV-STATE
 19889            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19890            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19891            GO TO 7100-DISPLAY-CANCELS.
 19892
 19893     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 368
* EL6311.cbl
 19894
 19895 4850-END-RECORDS.
 19896     MOVE ER-2252                TO EMI-ERROR.
 19897     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19898
 19899     IF PI-MAP-NAME = EL631B
 19900        MOVE -1                  TO BPFENTRL
 19901     ELSE
 19902        MOVE -1                  TO CPFENTRL.
 19903
 19904     GO TO 8200-SEND-DATAONLY.
 19905
 19906 4860-NOT-FOUND.
 19907
 19908******************************************************************
 19909*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 19910******************************************************************
 19911
 19912
 19913* EXEC CICS RESETBR
 19914*         DATASET    (FILE-ID-ERPNDB)
 19915*         RIDFLD     (ERPNDB-KEY)
 19916*     END-EXEC.
 19917     MOVE 0
 19918       TO DFHEIV11
 19919*    MOVE '&4         G          &   #00016908' TO DFHEIV0
 19920     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19921     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19922     MOVE X'2020233030303136393038' TO DFHEIV0(25:11)
 19923     CALL 'kxdfhei1' USING DFHEIV0,
 19924           FILE-ID-ERPNDB,
 19925           ERPNDB-KEY,
 19926           DFHEIV99,
 19927           DFHEIV11,
 19928           DFHEIV99
 19929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19930
 19931
 19932
 19933* EXEC CICS READNEXT
 19934*         DATASET    (FILE-ID-ERPNDB)
 19935*         SET        (ADDRESS OF PENDING-BUSINESS)
 19936*         RIDFLD     (ERPNDB-KEY)
 19937*    END-EXEC.
 19938     MOVE 0
 19939       TO DFHEIV11
 19940*    MOVE '&.S                   )   #00016913' TO DFHEIV0
 19941     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19942     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19943     MOVE X'2020233030303136393133' TO DFHEIV0(25:11)
 19944     CALL 'kxdfhei1' USING DFHEIV0,
 19945           FILE-ID-ERPNDB,
 19946           DFHEIV20,
 19947           DFHEIV99,
 19948           ERPNDB-KEY,
 19949           DFHEIV99,
 19950           DFHEIV11,
 19951           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 369
* EL6311.cbl
 19952           DFHEIV99
 19953     SET ADDRESS OF PENDING-BUSINESS TO
 19954         DFHEIV20
 19955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19956
 19957
 19958
 19959* EXEC CICS READPREV
 19960*         DATASET    (FILE-ID-ERPNDB)
 19961*         SET        (ADDRESS OF PENDING-BUSINESS)
 19962*         RIDFLD     (ERPNDB-KEY)
 19963*    END-EXEC.
 19964     MOVE 0
 19965       TO DFHEIV11
 19966*    MOVE '&0S                   )   #00016919' TO DFHEIV0
 19967     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19968     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19969     MOVE X'2020233030303136393139' TO DFHEIV0(25:11)
 19970     CALL 'kxdfhei1' USING DFHEIV0,
 19971           FILE-ID-ERPNDB,
 19972           DFHEIV20,
 19973           DFHEIV99,
 19974           ERPNDB-KEY,
 19975           DFHEIV99,
 19976           DFHEIV11,
 19977           DFHEIV99,
 19978           DFHEIV99
 19979     SET ADDRESS OF PENDING-BUSINESS TO
 19980         DFHEIV20
 19981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19982
 19983
 19984     GO TO 4810-READ-PREV-RECORD.
 19985
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 370
* EL6311.cbl
 19987
 19988******************************************************************
 19989*                                                                *
 19990*           B R O W S E   C S R   B A C K W A R D                *
 19991*                                                                *
 19992******************************************************************
 19993
 19994 4900-BROWSE-CSR-BACKWARD.
 19995
 19996     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19997
 19998
 19999* EXEC CICS HANDLE CONDITION
 20000*         NOTFND   (4970-NOT-FOUND)
 20001*         ENDFILE  (4950-END-RECORDS)
 20002*    END-EXEC
 20003*    MOVE '"$I''                  ! Q #00016939' TO DFHEIV0
 20004     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20005     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20006     MOVE X'5120233030303136393339' TO DFHEIV0(25:11)
 20007     CALL 'kxdfhei1' USING DFHEIV0
 20008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20009
 20010
 20011* EXEC CICS STARTBR
 20012*         DATASET   (FILE-ID-ERPNDB4)
 20013*         RIDFLD    (ERPNDB-CSR-KEY)
 20014*    END-EXEC.
 20015     MOVE 0
 20016       TO DFHEIV11
 20017*    MOVE '&,         G          &   #00016944' TO DFHEIV0
 20018     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20019     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20020     MOVE X'2020233030303136393434' TO DFHEIV0(25:11)
 20021     CALL 'kxdfhei1' USING DFHEIV0,
 20022           FILE-ID-ERPNDB4,
 20023           ERPNDB-CSR-KEY,
 20024           DFHEIV99,
 20025           DFHEIV11,
 20026           DFHEIV99
 20027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20028
 20029
 20030     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20031                                    WS-FIRST-TIME-SW.
 20032
 20033 4905-READ-PREV-RECORD.
 20034
 20035* EXEC CICS READPREV
 20036*         DATASET    (FILE-ID-ERPNDB4)
 20037*         SET        (ADDRESS OF PENDING-BUSINESS)
 20038*         RIDFLD     (ERPNDB-CSR-KEY)
 20039*    END-EXEC.
 20040     MOVE 0
 20041       TO DFHEIV11
 20042*    MOVE '&0S                   )   #00016953' TO DFHEIV0
 20043     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20044     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 371
* EL6311.cbl
 20045     MOVE X'2020233030303136393533' TO DFHEIV0(25:11)
 20046     CALL 'kxdfhei1' USING DFHEIV0,
 20047           FILE-ID-ERPNDB4,
 20048           DFHEIV20,
 20049           DFHEIV99,
 20050           ERPNDB-CSR-KEY,
 20051           DFHEIV99,
 20052           DFHEIV11,
 20053           DFHEIV99,
 20054           DFHEIV99
 20055     SET ADDRESS OF PENDING-BUSINESS TO
 20056         DFHEIV20
 20057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20058
 20059
 20060     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20061
 20062     IF WS-BATCH-PREFIX = '#CL'
 20063         GO TO 4905-READ-PREV-RECORD.
 20064
 20065     IF FIRST-TIME
 20066         MOVE SPACE               TO WS-FIRST-TIME-SW
 20067         GO TO 4905-READ-PREV-RECORD.
 20068
 20069     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20070        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20071        GO TO 4950-END-RECORDS.
 20072
 20073     IF PB-BATCH-TRAILER
 20074        GO TO 4905-READ-PREV-RECORD.
 20075
 20076     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20077
 20078     IF  WS-BATCH-PREFIX = '#CL'
 20079         GO TO 4905-READ-PREV-RECORD.
 20080
 20081     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20082        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20083           GO TO 4905-READ-PREV-RECORD
 20084        ELSE
 20085           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20086              GO TO 4910-CHECK-REC-TYPE
 20087           ELSE
 20088              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20089                 GO TO 4910-CHECK-REC-TYPE
 20090              ELSE
 20091                 GO TO 4905-READ-PREV-RECORD.
 20092
 20093     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20094        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20095           GO TO 4905-READ-PREV-RECORD.
 20096
 20097 4910-CHECK-REC-TYPE.
 20098     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20099         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20100             NEXT SENTENCE
 20101         ELSE
 20102             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 372
* EL6311.cbl
 20103
 20104     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20105         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20106             NEXT SENTENCE
 20107        ELSE
 20108             GO TO 4905-READ-PREV-RECORD.
 20109
 20110     IF NOT DISPLAY-CHANGE-RECORDS AND
 20111            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20112        GO TO 4905-READ-PREV-RECORD.
 20113
 20114     IF DISPLAY-HOLD-RECORDS AND
 20115        NOT PB-RECORD-ON-HOLD
 20116          GO TO 4905-READ-PREV-RECORD.
 20117
 20118     IF PB-ISSUE
 20119        IF DISPLAY-CHK-REQ-RECORDS
 20120           GO TO 4905-READ-PREV-RECORD.
 20121
 20122     IF PB-ISSUE
 20123        IF ISSUE-WITH-WARNING
 20124           IF PB-WARNING-ERRORS
 20125              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20126                  GO TO 4505-READ-PREV-RECORD
 20127              ELSE
 20128                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20129                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20130                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20131                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20132                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20133                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20134                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20135                 GO TO 7000-DISPLAY-ISSUES
 20136           ELSE
 20137              GO TO 4905-READ-PREV-RECORD.
 20138
 20139     IF PB-ISSUE
 20140        IF (ISSUES-IN-ERROR AND
 20141            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20142            ALL-ISSUES
 20143            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20144            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20145            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20146            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20147            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20148            MOVE PB-SV-STATE            TO PI-SV-STATE
 20149            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20150            GO TO 7000-DISPLAY-ISSUES
 20151        ELSE
 20152            GO TO 4905-READ-PREV-RECORD.
 20153
 20154     IF PB-CANCELLATION
 20155        IF DISPLAY-CHK-REQ-RECORDS
 20156           IF PB-C-REFUND-REQUESTED
 20157              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20158              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20159              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20160              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 373
* EL6311.cbl
 20161              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20162              MOVE PB-SV-STATE            TO PI-SV-STATE
 20163              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20164              GO TO 7100-DISPLAY-CANCELS
 20165           ELSE
 20166              GO TO 4905-READ-PREV-RECORD.
 20167
 20168     IF PB-CANCELLATION
 20169        IF CANCEL-WITH-WARNING
 20170           IF PB-WARNING-ERRORS
 20171              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20172                  GO TO 4505-READ-PREV-RECORD
 20173              ELSE
 20174                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20175                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20176                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20177                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20178                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20179                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20180                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20181                 GO TO 7100-DISPLAY-CANCELS
 20182           ELSE
 20183              GO TO 4905-READ-PREV-RECORD.
 20184
 20185     IF PB-CANCELLATION
 20186        IF (CANCEL-IN-ERROR  AND
 20187            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20188            ALL-CANCELS
 20189            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20190            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20191            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20192            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20193            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20194            MOVE PB-SV-STATE            TO PI-SV-STATE
 20195            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20196            GO TO 7100-DISPLAY-CANCELS.
 20197
 20198     GO TO 4905-READ-PREV-RECORD.
 20199
 20200 4950-END-RECORDS.
 20201     IF PI-MAP-NAME = EL631B
 20202        MOVE -1                  TO BMAINTL
 20203     ELSE
 20204        IF PI-MAP-NAME = EL631C
 20205           MOVE -1               TO CMAINTL
 20206        ELSE
 20207           MOVE -1               TO DPFENTRL.
 20208
 20209     MOVE ER-2255               TO EMI-ERROR.
 20210     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20211     GO TO 8200-SEND-DATAONLY.
 20212
 20213 4970-NOT-FOUND.
 20214
 20215******************************************************************
 20216*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20217******************************************************************
 20218
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 374
* EL6311.cbl
 20219
 20220* EXEC CICS RESETBR
 20221*         DATASET    (FILE-ID-ERPNDB4)
 20222*         RIDFLD     (ERPNDB-CSR-KEY)
 20223*    END-EXEC.
 20224     MOVE 0
 20225       TO DFHEIV11
 20226*    MOVE '&4         G          &   #00017118' TO DFHEIV0
 20227     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20228     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20229     MOVE X'2020233030303137313138' TO DFHEIV0(25:11)
 20230     CALL 'kxdfhei1' USING DFHEIV0,
 20231           FILE-ID-ERPNDB4,
 20232           ERPNDB-CSR-KEY,
 20233           DFHEIV99,
 20234           DFHEIV11,
 20235           DFHEIV99
 20236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20237
 20238
 20239
 20240* EXEC CICS READNEXT
 20241*         DATASET    (FILE-ID-ERPNDB4)
 20242*         SET        (ADDRESS OF PENDING-BUSINESS)
 20243*         RIDFLD     (ERPNDB-CSR-KEY)
 20244*    END-EXEC.
 20245     MOVE 0
 20246       TO DFHEIV11
 20247*    MOVE '&.S                   )   #00017123' TO DFHEIV0
 20248     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20249     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20250     MOVE X'2020233030303137313233' TO DFHEIV0(25:11)
 20251     CALL 'kxdfhei1' USING DFHEIV0,
 20252           FILE-ID-ERPNDB4,
 20253           DFHEIV20,
 20254           DFHEIV99,
 20255           ERPNDB-CSR-KEY,
 20256           DFHEIV99,
 20257           DFHEIV11,
 20258           DFHEIV99,
 20259           DFHEIV99
 20260     SET ADDRESS OF PENDING-BUSINESS TO
 20261         DFHEIV20
 20262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20263
 20264
 20265
 20266* EXEC CICS READPREV
 20267*         DATASET    (FILE-ID-ERPNDB4)
 20268*         SET        (ADDRESS OF PENDING-BUSINESS)
 20269*         RIDFLD     (ERPNDB-CSR-KEY)
 20270*    END-EXEC.
 20271     MOVE 0
 20272       TO DFHEIV11
 20273*    MOVE '&0S                   )   #00017129' TO DFHEIV0
 20274     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20275     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20276     MOVE X'2020233030303137313239' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 375
* EL6311.cbl
 20277     CALL 'kxdfhei1' USING DFHEIV0,
 20278           FILE-ID-ERPNDB4,
 20279           DFHEIV20,
 20280           DFHEIV99,
 20281           ERPNDB-CSR-KEY,
 20282           DFHEIV99,
 20283           DFHEIV11,
 20284           DFHEIV99,
 20285           DFHEIV99
 20286     SET ADDRESS OF PENDING-BUSINESS TO
 20287         DFHEIV20
 20288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20289
 20290
 20291 4980-READ-PREV-RECORD.
 20292
 20293* EXEC CICS READPREV
 20294*         DATASET    (FILE-ID-ERPNDB4)
 20295*         SET        (ADDRESS OF PENDING-BUSINESS)
 20296*         RIDFLD     (ERPNDB-CSR-KEY)
 20297*    END-EXEC.
 20298     MOVE 0
 20299       TO DFHEIV11
 20300*    MOVE '&0S                   )   #00017136' TO DFHEIV0
 20301     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20302     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20303     MOVE X'2020233030303137313336' TO DFHEIV0(25:11)
 20304     CALL 'kxdfhei1' USING DFHEIV0,
 20305           FILE-ID-ERPNDB4,
 20306           DFHEIV20,
 20307           DFHEIV99,
 20308           ERPNDB-CSR-KEY,
 20309           DFHEIV99,
 20310           DFHEIV11,
 20311           DFHEIV99,
 20312           DFHEIV99
 20313     SET ADDRESS OF PENDING-BUSINESS TO
 20314         DFHEIV20
 20315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20316
 20317
 20318     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20319
 20320     IF WS-BATCH-PREFIX = '#CL'
 20321        GO TO 4980-READ-PREV-RECORD.
 20322
 20323     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20324     GO TO 4905-READ-PREV-RECORD.
 20325
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 376
* EL6311.cbl
 20327
 20328
 20329******************************************************************
 20330*                                                                *
 20331*        B R O W S E   B A T C H   H E A D E R S                 *
 20332*                                                                *
 20333******************************************************************
 20334
 20335 5000-BROWSE-BATCH-HEADERS.
 20336
 20337     IF EIBTRNID NOT = TRANS-EXB1
 20338        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20339        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20340        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20341        GO TO 5010-READ-NEXT-RECORD.
 20342
 20343     IF EIBAID = DFHPF4
 20344        MOVE '0'                TO PI-EDIT-SW
 20345        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20346        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20347        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20348        GO TO 5010-READ-NEXT-RECORD.
 20349
 20350     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20351     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20352     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20353
 20354
 20355* EXEC CICS HANDLE CONDITION
 20356*         ENDFILE  (5050-NOT-FOUND)
 20357*    END-EXEC.
 20358*    MOVE '"$''                   ! R #00017178' TO DFHEIV0
 20359     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20360     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20361     MOVE X'5220233030303137313738' TO DFHEIV0(25:11)
 20362     CALL 'kxdfhei1' USING DFHEIV0
 20363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20364
 20365
 20366 5010-READ-NEXT-RECORD.
 20367
 20368* EXEC CICS HANDLE CONDITION
 20369*         NOTFND    (5050-NOT-FOUND)
 20370*    END-EXEC.
 20371*    MOVE '"$I                   ! S #00017183' TO DFHEIV0
 20372     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20373     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20374     MOVE X'5320233030303137313833' TO DFHEIV0(25:11)
 20375     CALL 'kxdfhei1' USING DFHEIV0
 20376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20377
 20378
 20379
 20380* EXEC CICS READ
 20381*         DATASET   (FILE-ID-ERPNDB)
 20382*         SET       (ADDRESS OF PENDING-BUSINESS)
 20383*         RIDFLD    (ERPNDB-KEY)
 20384*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 377
* EL6311.cbl
 20385*    END-EXEC.
 20386*    MOVE '&"S        G          (   #00017187' TO DFHEIV0
 20387     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20388     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20389     MOVE X'2020233030303137313837' TO DFHEIV0(25:11)
 20390     CALL 'kxdfhei1' USING DFHEIV0,
 20391           FILE-ID-ERPNDB,
 20392           DFHEIV20,
 20393           DFHEIV99,
 20394           ERPNDB-KEY,
 20395           DFHEIV99,
 20396           DFHEIV99,
 20397           DFHEIV99
 20398     SET ADDRESS OF PENDING-BUSINESS TO
 20399         DFHEIV20
 20400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20401
 20402
 20403     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20404         GO TO 5050-NOT-FOUND.
 20405
 20406     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20407
 20408     IF WS-BATCH-PREFIX = '#CL'
 20409         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20410         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20411         GO TO 5010-READ-NEXT-RECORD.
 20412
 20413     IF NOT PB-BATCH-TRAILER
 20414         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20415         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20416         GO TO 5010-READ-NEXT-RECORD.
 20417
 20418     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20419         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20420             NEXT SENTENCE
 20421         ELSE
 20422             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20423             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20424             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20425             GO TO 5010-READ-NEXT-RECORD.
 20426
 20427     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20428         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20429             NEXT SENTENCE
 20430        ELSE
 20431             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20432             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20433             GO TO 5010-READ-NEXT-RECORD.
 20434
 20435     IF EIBAID = DFHPF4
 20436        MOVE '0'                TO PI-EDIT-SW
 20437        GO TO 7200-DISPLAY-BATCHES.
 20438
 20439     IF PI-CSR-BROWSE
 20440        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20441           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20442           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 378
* EL6311.cbl
 20443           GO TO 5010-READ-NEXT-RECORD.
 20444
 20445     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20446       IF PI-PB-CARRIER    = SPACES AND
 20447          PI-PB-GROUPING   = SPACES AND
 20448          PI-PB-STATE      = SPACES AND
 20449          PI-PB-ACCOUNT    = SPACES
 20450            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20451            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20452            GO TO 7200-DISPLAY-BATCHES
 20453         ELSE
 20454           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20455              PI-PB-GROUPING   = PB-GROUPING AND
 20456              PI-PB-STATE      = PB-STATE    AND
 20457              PI-PB-ACCOUNT    = PB-ACCOUNT
 20458              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20459              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20460              GO TO 7200-DISPLAY-BATCHES.
 20461
 20462     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20463     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20464
 20465
 20466* EXEC CICS HANDLE CONDITION
 20467*         NOTFND    (5050-NOT-FOUND)
 20468*    END-EXEC.
 20469*    MOVE '"$I                   ! T #00017256' TO DFHEIV0
 20470     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20471     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20472     MOVE X'5420233030303137323536' TO DFHEIV0(25:11)
 20473     CALL 'kxdfhei1' USING DFHEIV0
 20474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20475
 20476
 20477
 20478* EXEC CICS READ
 20479*         DATASET   (FILE-ID-ERPNDB)
 20480*         SET       (ADDRESS OF PENDING-BUSINESS)
 20481*         RIDFLD    (ERPNDB-KEY)
 20482*         GTEQ
 20483*    END-EXEC.
 20484*    MOVE '&"S        G          (   #00017260' TO DFHEIV0
 20485     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20486     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20487     MOVE X'2020233030303137323630' TO DFHEIV0(25:11)
 20488     CALL 'kxdfhei1' USING DFHEIV0,
 20489           FILE-ID-ERPNDB,
 20490           DFHEIV20,
 20491           DFHEIV99,
 20492           ERPNDB-KEY,
 20493           DFHEIV99,
 20494           DFHEIV99,
 20495           DFHEIV99
 20496     SET ADDRESS OF PENDING-BUSINESS TO
 20497         DFHEIV20
 20498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20499
 20500
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 379
* EL6311.cbl
 20501     GO TO 5010-READ-NEXT-RECORD.
 20502
 20503 5050-NOT-FOUND.
 20504
 20505******************************************************************
 20506*                                                                *
 20507*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 20508*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 20509*         PROGRAM.                                               *
 20510*                                                                *
 20511******************************************************************
 20512
 20513     IF EIBTRNID NOT = TRANS-EXB1
 20514        IF PENDING-BUS-RECS-FOUND
 20515            NEXT SENTENCE
 20516          ELSE
 20517            MOVE '9'            TO PI-BROWSE-SW
 20518            GO TO 9400-CLEAR.
 20519
 20520     MOVE ER-2256                TO EMI-ERROR.
 20521     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20522
 20523     IF PI-MAP-NAME = SPACES
 20524        MOVE EL631D              TO PI-MAP-NAME
 20525        MOVE -1                  TO DPFENTRL
 20526        GO TO 8100-SEND-INITIAL-MAP.
 20527
 20528     IF PI-MAP-NAME = EL631B
 20529        MOVE -1                  TO BMAINTL
 20530     ELSE
 20531        IF PI-MAP-NAME = EL631C
 20532           MOVE -1               TO CMAINTL
 20533        ELSE
 20534           MOVE -1               TO DPFENTRL
 20535           GO TO 8200-SEND-DATAONLY.
 20536
 20537     GO TO 8100-SEND-INITIAL-MAP.
 20538
 20539     .
 20540 5100-PROCESS-POL-RESC.
 20541     MOVE ZEROS                  TO CG-LF-BENCD
 20542                                    CG-AH-BENCD
 20543                                    CG-LF-CAN-AMT
 20544                                    CG-AH-CAN-AMT
 20545     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20546                                    CG-AH-CAN-DT
 20547     MOVE SPACES                 TO CG-BATCH-NO
 20548     MOVE '4'                    TO CG-OPTION-CODE
 20549     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 20550     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 20551     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 20552     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 20553     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 20554     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 20555     MOVE PI-SV-STATE            TO CG-CERT-STATE
 20556     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 20557     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 20558     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 380
* EL6311.cbl
 20559     MOVE PI-PREV-ALT-KEY (1:33)
 20560                                 TO CG-CERT-KEY
 20561     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 20562     MOVE ZEROS                  TO CG-LF-CAN-AMT
 20563                                    CG-AH-CAN-AMT
 20564     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20565                                    CG-AH-CAN-DT
 20566     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 20567     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 20568      display 'about to cancel ' cg-cert-key
 20569
 20570* EXEC CICS LINK
 20571*        PROGRAM  ('ELCANC')
 20572*        COMMAREA (CANCEL-GEN-PASS-AREA)
 20573*    END-EXEC
 20574     MOVE LENGTH OF
 20575      CANCEL-GEN-PASS-AREA
 20576       TO DFHEIV11
 20577     MOVE 'ELCANC' TO DFHEIV1
 20578*    MOVE '."C                   (   #00017335' TO DFHEIV0
 20579     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20580     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20581     MOVE X'2020233030303137333335' TO DFHEIV0(25:11)
 20582     CALL 'kxdfhei1' USING DFHEIV0,
 20583           DFHEIV1,
 20584           CANCEL-GEN-PASS-AREA,
 20585           DFHEIV11,
 20586           DFHEIV99,
 20587           DFHEIV99,
 20588           DFHEIV99,
 20589           DFHEIV99
 20590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20591     IF CG-SUCCESS
 20592        CONTINUE
 20593     ELSE
 20594        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 20595        MOVE '3'                 TO EMI-SWITCH1
 20596        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 20597        EVALUATE TRUE
 20598           WHEN CG-DATE-ERROR
 20599             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20600           WHEN CG-CERT-NOT-FOUND
 20601             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20602           WHEN CG-AMOUNT-ERROR
 20603             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20604           WHEN CG-OPTION-ERROR
 20605             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20606           WHEN CG-PREV-CAN
 20607             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20608           WHEN CG-INVALID-DATA
 20609             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20610           WHEN CG-NO-ACCT-MSTR
 20611             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20612           WHEN CG-SFX-A-EXIST
 20613             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20614           WHEN CG-MISC-ERROR
 20615             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20616           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 381
* EL6311.cbl
 20617             MOVE ' ERROR - ELCANC - RETURN '
 20618                                 TO EMI-ERROR-TEXT (1) (12:25)
 20619        END-EVALUATE
 20620        GO TO 8200-SEND-DATAONLY
 20621     END-IF
 20622     .
 20623 5100-EXIT.
 20624     EXIT.
 20625
 20626******************************************************************
 20627*                                                                *
 20628*        B R O W S E   B A T C H   B A C K W A R D S             *
 20629*                                                                *
 20630******************************************************************
 20631
 20632 5500-BROWSE-BATCH-BACKWARD.
 20633
 20634* EXEC CICS HANDLE CONDITION
 20635*         NOTFND   (5550-END-RECORDS)
 20636*         ENDFILE  (5550-END-RECORDS)
 20637*    END-EXEC.
 20638*    MOVE '"$I''                  ! U #00017381' TO DFHEIV0
 20639     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20640     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20641     MOVE X'5520233030303137333831' TO DFHEIV0(25:11)
 20642     CALL 'kxdfhei1' USING DFHEIV0
 20643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20644
 20645
 20646 5505-START-BROWSE.
 20647     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20648     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 20649     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20650
 20651
 20652* EXEC CICS STARTBR
 20653*         DATASET   (FILE-ID-ERPNDB)
 20654*         RIDFLD    (ERPNDB-ALT-KEY)
 20655*    END-EXEC.
 20656     MOVE 0
 20657       TO DFHEIV11
 20658*    MOVE '&,         G          &   #00017391' TO DFHEIV0
 20659     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20660     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20661     MOVE X'2020233030303137333931' TO DFHEIV0(25:11)
 20662     CALL 'kxdfhei1' USING DFHEIV0,
 20663           FILE-ID-ERPNDB,
 20664           ERPNDB-ALT-KEY,
 20665           DFHEIV99,
 20666           DFHEIV11,
 20667           DFHEIV99
 20668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20669
 20670
 20671     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20672
 20673
 20674* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 382
* EL6311.cbl
 20675*         DATASET    (FILE-ID-ERPNDB)
 20676*         SET        (ADDRESS OF PENDING-BUSINESS)
 20677*         RIDFLD     (ERPNDB-KEY)
 20678*    END-EXEC.
 20679     MOVE 0
 20680       TO DFHEIV11
 20681*    MOVE '&.S                   )   #00017398' TO DFHEIV0
 20682     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20683     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20684     MOVE X'2020233030303137333938' TO DFHEIV0(25:11)
 20685     CALL 'kxdfhei1' USING DFHEIV0,
 20686           FILE-ID-ERPNDB,
 20687           DFHEIV20,
 20688           DFHEIV99,
 20689           ERPNDB-KEY,
 20690           DFHEIV99,
 20691           DFHEIV11,
 20692           DFHEIV99,
 20693           DFHEIV99
 20694     SET ADDRESS OF PENDING-BUSINESS TO
 20695         DFHEIV20
 20696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20697
 20698
 20699
 20700* EXEC CICS READPREV
 20701*         DATASET    (FILE-ID-ERPNDB)
 20702*         SET        (ADDRESS OF PENDING-BUSINESS)
 20703*         RIDFLD     (ERPNDB-KEY)
 20704*    END-EXEC.
 20705     MOVE 0
 20706       TO DFHEIV11
 20707*    MOVE '&0S                   )   #00017404' TO DFHEIV0
 20708     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20709     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20710     MOVE X'2020233030303137343034' TO DFHEIV0(25:11)
 20711     CALL 'kxdfhei1' USING DFHEIV0,
 20712           FILE-ID-ERPNDB,
 20713           DFHEIV20,
 20714           DFHEIV99,
 20715           ERPNDB-KEY,
 20716           DFHEIV99,
 20717           DFHEIV11,
 20718           DFHEIV99,
 20719           DFHEIV99
 20720     SET ADDRESS OF PENDING-BUSINESS TO
 20721         DFHEIV20
 20722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20723
 20724
 20725
 20726* EXEC CICS READPREV
 20727*         DATASET    (FILE-ID-ERPNDB)
 20728*         SET        (ADDRESS OF PENDING-BUSINESS)
 20729*         RIDFLD     (ERPNDB-KEY)
 20730*    END-EXEC.
 20731     MOVE 0
 20732       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 383
* EL6311.cbl
 20733*    MOVE '&0S                   )   #00017410' TO DFHEIV0
 20734     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20735     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20736     MOVE X'2020233030303137343130' TO DFHEIV0(25:11)
 20737     CALL 'kxdfhei1' USING DFHEIV0,
 20738           FILE-ID-ERPNDB,
 20739           DFHEIV20,
 20740           DFHEIV99,
 20741           ERPNDB-KEY,
 20742           DFHEIV99,
 20743           DFHEIV11,
 20744           DFHEIV99,
 20745           DFHEIV99
 20746     SET ADDRESS OF PENDING-BUSINESS TO
 20747         DFHEIV20
 20748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20749
 20750
 20751     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20752        GO TO 5550-END-RECORDS.
 20753
 20754     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 20755
 20756     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20757
 20758     IF  WS-BATCH-PREFIX = '#CL'
 20759             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20760
 20761* EXEC CICS ENDBR
 20762*                 DATASET  (FILE-ID-ERPNDB)
 20763*            END-EXEC
 20764     MOVE 0
 20765       TO DFHEIV11
 20766*    MOVE '&2                    $   #00017425' TO DFHEIV0
 20767     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20768     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20769     MOVE X'2020233030303137343235' TO DFHEIV0(25:11)
 20770     CALL 'kxdfhei1' USING DFHEIV0,
 20771           FILE-ID-ERPNDB,
 20772           DFHEIV11,
 20773           DFHEIV99
 20774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20775         GO TO 5505-START-BROWSE.
 20776
 20777     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20778         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20779             NEXT SENTENCE
 20780         ELSE
 20781             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20782
 20783* EXEC CICS ENDBR
 20784*                 DATASET  (FILE-ID-ERPNDB)
 20785*            END-EXEC
 20786     MOVE 0
 20787       TO DFHEIV11
 20788*    MOVE '&2                    $   #00017435' TO DFHEIV0
 20789     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20790     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 384
* EL6311.cbl
 20791     MOVE X'2020233030303137343335' TO DFHEIV0(25:11)
 20792     CALL 'kxdfhei1' USING DFHEIV0,
 20793           FILE-ID-ERPNDB,
 20794           DFHEIV11,
 20795           DFHEIV99
 20796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20797             GO TO 5505-START-BROWSE.
 20798
 20799
 20800     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20801         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20802             NEXT SENTENCE
 20803        ELSE
 20804             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20805
 20806* EXEC CICS ENDBR
 20807*                 DATASET  (FILE-ID-ERPNDB)
 20808*            END-EXEC
 20809     MOVE 0
 20810       TO DFHEIV11
 20811*    MOVE '&2                    $   #00017446' TO DFHEIV0
 20812     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20813     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20814     MOVE X'2020233030303137343436' TO DFHEIV0(25:11)
 20815     CALL 'kxdfhei1' USING DFHEIV0,
 20816           FILE-ID-ERPNDB,
 20817           DFHEIV11,
 20818           DFHEIV99
 20819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20820             GO TO 5505-START-BROWSE.
 20821
 20822     IF NOT PB-BATCH-TRAILER
 20823        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20824
 20825* EXEC CICS ENDBR
 20826*            DATASET  (FILE-ID-ERPNDB)
 20827*       END-EXEC
 20828     MOVE 0
 20829       TO DFHEIV11
 20830*    MOVE '&2                    $   #00017453' TO DFHEIV0
 20831     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20832     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20833     MOVE X'2020233030303137343533' TO DFHEIV0(25:11)
 20834     CALL 'kxdfhei1' USING DFHEIV0,
 20835           FILE-ID-ERPNDB,
 20836           DFHEIV11,
 20837           DFHEIV99
 20838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20839        GO TO 5505-START-BROWSE.
 20840
 20841     IF PI-CSR-BROWSE
 20842        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20843           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 20844
 20845* EXEC CICS ENDBR
 20846*               DATASET  (FILE-ID-ERPNDB)
 20847*          END-EXEC
 20848     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 385
* EL6311.cbl
 20849       TO DFHEIV11
 20850*    MOVE '&2                    $   #00017461' TO DFHEIV0
 20851     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20852     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20853     MOVE X'2020233030303137343631' TO DFHEIV0(25:11)
 20854     CALL 'kxdfhei1' USING DFHEIV0,
 20855           FILE-ID-ERPNDB,
 20856           DFHEIV11,
 20857           DFHEIV99
 20858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20859           GO TO 5505-START-BROWSE.
 20860
 20861     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20862        IF PI-PB-CARRIER    = SPACES AND
 20863           PI-PB-GROUPING   = SPACES AND
 20864           PI-PB-STATE      = SPACES AND
 20865           PI-PB-ACCOUNT    = SPACES
 20866             GO TO 7200-DISPLAY-BATCHES
 20867          ELSE
 20868            IF PI-PB-CARRIER    = PB-CARRIER  AND
 20869               PI-PB-GROUPING   = PB-GROUPING AND
 20870               PI-PB-STATE      = PB-STATE    AND
 20871               PI-PB-ACCOUNT    = PB-ACCOUNT
 20872                 GO TO 7200-DISPLAY-BATCHES.
 20873
 20874     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 20875
 20876
 20877* EXEC CICS ENDBR
 20878*         DATASET  (FILE-ID-ERPNDB)
 20879*    END-EXEC.
 20880     MOVE 0
 20881       TO DFHEIV11
 20882*    MOVE '&2                    $   #00017481' TO DFHEIV0
 20883     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20884     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20885     MOVE X'2020233030303137343831' TO DFHEIV0(25:11)
 20886     CALL 'kxdfhei1' USING DFHEIV0,
 20887           FILE-ID-ERPNDB,
 20888           DFHEIV11,
 20889           DFHEIV99
 20890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20891
 20892
 20893     GO TO 5505-START-BROWSE.
 20894
 20895 5550-END-RECORDS.
 20896     MOVE ER-2257                TO EMI-ERROR.
 20897     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20898     MOVE -1                     TO DPFENTRL.
 20899
 20900     GO TO 8200-SEND-DATAONLY.
 20901
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 386
* EL6311.cbl
 20903
 20904******************************************************************
 20905*                                                                *
 20906*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 20907*                                                                *
 20908******************************************************************
 20909
 20910 6000-CREATE-TEMP-STORAGE.
 20911
 20912
 20913* EXEC CICS HANDLE CONDITION
 20914*        QIDERR  (6050-QID-ERROR)
 20915*    END-EXEC.
 20916*    MOVE '"$N                   ! V #00017504' TO DFHEIV0
 20917     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20918     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20919     MOVE X'5620233030303137353034' TO DFHEIV0(25:11)
 20920     CALL 'kxdfhei1' USING DFHEIV0
 20921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20922
 20923
 20924
 20925* EXEC CICS WRITEQ TS
 20926*        QUEUE    (QID)
 20927*        FROM     (PROGRAM-INTERFACE-BLOCK)
 20928*        LENGTH   (WS-COMM-LENGTH)
 20929*        ITEM     (W-ONE)
 20930*    END-EXEC.
 20931*    MOVE '*" I                  ''   #00017508' TO DFHEIV0
 20932     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 20933     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20934     MOVE X'2020233030303137353038' TO DFHEIV0(25:11)
 20935     CALL 'kxdfhei1' USING DFHEIV0,
 20936           QID,
 20937           PROGRAM-INTERFACE-BLOCK,
 20938           WS-COMM-LENGTH,
 20939           W-ONE,
 20940           DFHEIV99,
 20941           DFHEIV99
 20942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20943
 20944
 20945 6000-EXIT.
 20946      EXIT.
 20947
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 387
* EL6311.cbl
 20949
 20950******************************************************************
 20951*                                                                *
 20952*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 20953*                                                                *
 20954******************************************************************
 20955
 20956 6050-RECOVER-TEMP-STORAGE.
 20957     IF PGM-NAME = XCTL-EL6312
 20958        GO TO 6050-EXIT.
 20959
 20960     IF PGM-NAME = XCTL-EL6313
 20961        GO TO 6050-EXIT.
 20962
 20963     IF PGM-NAME = XCTL-EL6315
 20964         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 20965     END-IF
 20966
 20967     IF PGM-NAME = XCTL-EL6316
 20968         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 20969     END-IF
 20970
 20971
 20972* EXEC CICS HANDLE CONDITION
 20973*        QIDERR  (6050-QID-ERROR)
 20974*    END-EXEC.
 20975*    MOVE '"$N                   ! W #00017541' TO DFHEIV0
 20976     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20977     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20978     MOVE X'5720233030303137353431' TO DFHEIV0(25:11)
 20979     CALL 'kxdfhei1' USING DFHEIV0
 20980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20981
 20982
 20983
 20984* EXEC CICS READQ TS
 20985*         QUEUE   (QID)
 20986*         INTO    (PROGRAM-INTERFACE-BLOCK)
 20987*         LENGTH  (WS-COMM-LENGTH)
 20988*         ITEM    (W-ONE)
 20989*     END-EXEC.
 20990*    MOVE '*$II   L              ''   #00017545' TO DFHEIV0
 20991     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 20992     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20993     MOVE X'2020233030303137353435' TO DFHEIV0(25:11)
 20994     CALL 'kxdfhei1' USING DFHEIV0,
 20995           QID,
 20996           PROGRAM-INTERFACE-BLOCK,
 20997           WS-COMM-LENGTH,
 20998           W-ONE,
 20999           DFHEIV99,
 21000           DFHEIV99
 21001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21002
 21003
 21004 6050-DELETE-TEMP-STORAGE.
 21005
 21006
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 388
* EL6311.cbl
 21007* EXEC CICS DELETEQ TS
 21008*        QUEUE   (QID)
 21009*    END-EXEC.
 21010*    MOVE '*&                    #   #00017554' TO DFHEIV0
 21011     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21012     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21013     MOVE X'2020233030303137353534' TO DFHEIV0(25:11)
 21014     CALL 'kxdfhei1' USING DFHEIV0,
 21015           QID,
 21016           DFHEIV99
 21017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21018
 21019
 21020     GO TO 6050-EXIT.
 21021
 21022 6050-QID-ERROR.
 21023     MOVE ER-0033                TO EMI-ERROR
 21024     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21025
 21026 6050-EXIT.
 21027      EXIT.
 21028
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 389
* EL6311.cbl
 21030
 21031******************************************************************
 21032*                                                                *
 21033*            T E R M   C O N V E R S I O N                       *
 21034*                                                                *
 21035******************************************************************
 21036
 21037 6100-TERM-CONVERSION.
 21038
 21039     IF PI-BPMTS = ZERO
 21040         GO TO 6199-EXIT.
 21041
 21042     IF PI-BMODE = ' ' OR 'M'
 21043         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21044         GO TO 6105-ROUND-TERM.
 21045
 21046     IF PI-BMODE = 'S'
 21047         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21048         GO TO 6105-ROUND-TERM.
 21049
 21050     IF PI-BMODE = 'W'
 21051         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21052         GO TO 6105-ROUND-TERM.
 21053
 21054     IF PI-BMODE = 'B'
 21055         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21056         GO TO 6105-ROUND-TERM.
 21057
 21058     IF PI-BMODE = 'T'
 21059         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21060
 21061 6105-ROUND-TERM.
 21062
 21063     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21064         ADD +1                  TO WS-CALC-TERM-WHOLE
 21065         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21066
 21067     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21068         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21069
 21070     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21071         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21072                                      WS-BTERM    (WS-SUB1)
 21073         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21074
 21075     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21076         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21077             MOVE -1               TO BMODEL
 21078             MOVE ER-2593          TO EMI-ERROR
 21079             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21080             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21081
 21082 6124-CHECK-BENEFIT.
 21083
 21084     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21085        GO TO 6126-COMPUTE-BENEFIT.
 21086
 21087     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 390
* EL6311.cbl
 21088
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 391
* EL6311.cbl
 21090******************************************************************
 21091**         COMPUTE TERM AND BENEFIT
 21092******************************************************************
 21093 6125-COMPUTE-TERM-BENEFIT.
 21094
 21095     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21096        PI-BPMTAMT = ZERO
 21097         GO TO 6199-EXIT.
 21098
 21099     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21100                                     WS-BTERM  (WS-SUB1).
 21101     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21102
 21103 6126-COMPUTE-BENEFIT.
 21104
 21105     IF PI-BMODE = 'M' OR  ' '
 21106         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21107
 21108     IF PI-BMODE = 'W'
 21109         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21110
 21111     IF PI-BMODE = 'S'
 21112         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21113
 21114     IF PI-BMODE = 'B'
 21115         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21116
 21117     IF PI-BMODE = 'T'
 21118         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21119
 21120     IF WS-SUB1 = +1
 21121        COMPUTE WS-BBEN (WS-SUB1) =
 21122                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21123
 21124     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21125     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21126     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21127
 21128 6199-EXIT.
 21129     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 392
* EL6311.cbl
 21131
 21132******************************************************************
 21133*                                                                *
 21134*             D I S P L A Y   I S S U E S                        *
 21135*                                                                *
 21136******************************************************************
 21137
 21138 6200-CREATE-VADS.
 21139     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21140     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21141     MOVE SPACES                 TO WS-PASS-VADS-REC
 21142
 21143* EXEC CICS GETMAIN
 21144*       SET      (ADDRESS OF PENDING-BUSINESS)
 21145*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21146*       INITIMG  (GETMAIN-SPACE)
 21147*       RESP     (WS-RESPONSE)
 21148*    END-EXEC
 21149*    MOVE ',"IL                  $  N#00017680' TO DFHEIV0
 21150     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21151     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21152     MOVE X'204E233030303137363830' TO DFHEIV0(25:11)
 21153     CALL 'kxdfhei1' USING DFHEIV0,
 21154           DFHEIV20,
 21155           ERPNDB-RECORD-LENGTH,
 21156           GETMAIN-SPACE
 21157     SET ADDRESS OF PENDING-BUSINESS TO
 21158         DFHEIV20
 21159     MOVE EIBRESP  TO WS-RESPONSE
 21160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21161
 21162* EXEC CICS READ
 21163*       INTO    (PENDING-BUSINESS)
 21164*       DATASET (FILE-ID-ERPNDB)
 21165*       RIDFLD  (ERPNDB-KEY)
 21166*       RESP    (WS-RESPONSE)
 21167*    END-EXEC
 21168     MOVE LENGTH OF
 21169      PENDING-BUSINESS
 21170       TO DFHEIV11
 21171*    MOVE '&"IL       E          (  N#00017686' TO DFHEIV0
 21172     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21173     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21174     MOVE X'204E233030303137363836' TO DFHEIV0(25:11)
 21175     CALL 'kxdfhei1' USING DFHEIV0,
 21176           FILE-ID-ERPNDB,
 21177           PENDING-BUSINESS,
 21178           DFHEIV11,
 21179           ERPNDB-KEY,
 21180           DFHEIV99,
 21181           DFHEIV99,
 21182           DFHEIV99
 21183     MOVE EIBRESP  TO WS-RESPONSE
 21184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21185     IF RESP-NORMAL
 21186        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21187        IF (RESP-NORMAL)
 21188           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 393
* EL6311.cbl
 21189              AM-CONTROL-PRIMARY (1:20))
 21190           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21191        ELSE
 21192           MOVE 'ACCOUNT NOT FOUND'
 21193                                 TO VD-ACCOUNT-NAME
 21194        END-IF
 21195        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21196                                    TO M1
 21197        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21198        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21199           (A2 > M1)
 21200           OR (WS-WORK-FIELD (A2:1) = '*')
 21201           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21202           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21203        END-PERFORM
 21204        IF A2 > M1
 21205           CONTINUE
 21206        ELSE
 21207           MOVE WS-WORK-FIELD (1:A2 - 1)
 21208                                    TO VD-ACCOUNT-NAME
 21209        END-IF
 21210        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21211        MOVE PB-CARRIER          TO VD-CARRIER
 21212        MOVE PB-GROUPING         TO VD-GROUPING
 21213        MOVE PB-STATE            TO VD-STATE
 21214        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21215        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21216        MOVE PB-CERT-NO          TO VD-CERT-NO
 21217        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21218        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21219        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21220        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21221        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21222        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21223        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21224        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21225        MOVE PB-CSR-ID           TO VD-CSR-ID
 21226        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21227        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21228        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21229        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21230        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21231        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21232        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21233        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21234        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21235        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21236        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21237        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21238        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21239     END-IF
 21240     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21241
 21242
 21243* EXEC CICS GETMAIN
 21244*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21245*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21246*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 394
* EL6311.cbl
 21247*       RESP     (WS-RESPONSE)
 21248*    END-EXEC
 21249*    MOVE ',"IL                  $  N#00017749' TO DFHEIV0
 21250     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21251     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21252     MOVE X'204E233030303137373439' TO DFHEIV0(25:11)
 21253     CALL 'kxdfhei1' USING DFHEIV0,
 21254           DFHEIV20,
 21255           ERPNDM-RECORD-LENGTH,
 21256           GETMAIN-SPACE
 21257     SET ADDRESS OF PENDING-MAILING-DATA TO
 21258         DFHEIV20
 21259     MOVE EIBRESP  TO WS-RESPONSE
 21260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21261
 21262
 21263* EXEC CICS READ
 21264*       INTO    (PENDING-MAILING-DATA)
 21265*       DATASET (FILE-ID-ERPNDM)
 21266*       RIDFLD  (ERPNDM-KEY)
 21267*       RESP    (WS-RESPONSE)
 21268*    END-EXEC
 21269     MOVE LENGTH OF
 21270      PENDING-MAILING-DATA
 21271       TO DFHEIV11
 21272*    MOVE '&"IL       E          (  N#00017756' TO DFHEIV0
 21273     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21274     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21275     MOVE X'204E233030303137373536' TO DFHEIV0(25:11)
 21276     CALL 'kxdfhei1' USING DFHEIV0,
 21277           FILE-ID-ERPNDM,
 21278           PENDING-MAILING-DATA,
 21279           DFHEIV11,
 21280           ERPNDM-KEY,
 21281           DFHEIV99,
 21282           DFHEIV99,
 21283           DFHEIV99
 21284     MOVE EIBRESP  TO WS-RESPONSE
 21285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21286
 21287     IF RESP-NORMAL
 21288        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21289        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21290        MOVE PM-CITY              TO VD-INSURED-CITY
 21291        MOVE PM-STATE             TO VD-INSURED-STATE
 21292        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21293     END-IF
 21294
 21295     MOVE 'VAC1'                  TO VD-LETTER-ID
 21296     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21297     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21298     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21299     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21300     MOVE +0                      TO VD-ARCHIVE-NO
 21301     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21302     .
 21303 6200-EXIT.
 21304     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 395
* EL6311.cbl
 21305 6210-READ-ERACCT.
 21306     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21307     MOVE LOW-VALUES             TO ERACCT-FILL
 21308
 21309* EXEC CICS READ
 21310*         DATASET   ('ERACCT')
 21311*         INTO      (ACCOUNT-MASTER)
 21312*         RIDFLD    (ERACCT-KEY)
 21313*         GTEQ
 21314*         RESP      (WS-RESPONSE)
 21315*    END-EXEC
 21316     MOVE LENGTH OF
 21317      ACCOUNT-MASTER
 21318       TO DFHEIV11
 21319     MOVE 'ERACCT' TO DFHEIV1
 21320*    MOVE '&"IL       G          (  N#00017784' TO DFHEIV0
 21321     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21322     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21323     MOVE X'204E233030303137373834' TO DFHEIV0(25:11)
 21324     CALL 'kxdfhei1' USING DFHEIV0,
 21325           DFHEIV1,
 21326           ACCOUNT-MASTER,
 21327           DFHEIV11,
 21328           ERACCT-KEY,
 21329           DFHEIV99,
 21330           DFHEIV99,
 21331           DFHEIV99
 21332     MOVE EIBRESP  TO WS-RESPONSE
 21333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21334     .
 21335 6210-EXIT.
 21336     EXIT.
 21337
 21338 6220-READ-ERMAIL.
 21339
 21340     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21341     MOVE ' '                    TO WS-ERMAIL-SW
 21342
 21343
 21344* EXEC CICS READ
 21345*       DATASET   (FILE-ID-ERMAIL)
 21346*       SET       (ADDRESS OF MAILING-DATA)
 21347*       RIDFLD    (ERMAIL-KEY)
 21348*       RESP      (WS-RESPONSE)
 21349*    END-EXEC
 21350*    MOVE '&"S        E          (  N#00017800' TO DFHEIV0
 21351     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21352     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21353     MOVE X'204E233030303137383030' TO DFHEIV0(25:11)
 21354     CALL 'kxdfhei1' USING DFHEIV0,
 21355           FILE-ID-ERMAIL,
 21356           DFHEIV20,
 21357           DFHEIV99,
 21358           ERMAIL-KEY,
 21359           DFHEIV99,
 21360           DFHEIV99,
 21361           DFHEIV99
 21362     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 396
* EL6311.cbl
 21363         DFHEIV20
 21364     MOVE EIBRESP  TO WS-RESPONSE
 21365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21366
 21367     IF RESP-NORMAL
 21368        SET ERMAIL-FOUND TO TRUE
 21369     END-IF
 21370     .
 21371 6220-EXIT.
 21372     EXIT.
 21373
 21374 6400-CHECK-FOR-RES-REF-CLAIM.
 21375     display 'made it to 6400- for ' pi-cert-no
 21376     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21377
 21378     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21379                                    W-CL-COMP-CD.
 21380     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21381                                    W-CL-CERT-NO.
 21382     MOVE SPACES                 TO MSTR-CERT-SFX.
 21383
 21384
 21385* EXEC CICS HANDLE CONDITION
 21386*        NOTFND  (6400-CONTINUE)
 21387*        ENDFILE (6400-CONTINUE)
 21388*    END-EXEC.
 21389*    MOVE '"$I''                  ! X #00017824' TO DFHEIV0
 21390     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21391     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21392     MOVE X'5820233030303137383234' TO DFHEIV0(25:11)
 21393     CALL 'kxdfhei1' USING DFHEIV0
 21394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21395
 21396
 21397
 21398* EXEC CICS IGNORE CONDITION
 21399*        DUPKEY
 21400*    END-EXEC.
 21401*    MOVE '"*$                   !   #00017829' TO DFHEIV0
 21402     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21403     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21404     MOVE X'2020233030303137383239' TO DFHEIV0(25:11)
 21405     CALL 'kxdfhei1' USING DFHEIV0
 21406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21407
 21408
 21409
 21410* EXEC CICS STARTBR
 21411*        DATASET   (CLMS-ID)
 21412*        RIDFLD    (ELMSTR-KEY)
 21413*        GENERIC   EQUAL
 21414*        KEYLENGTH (ELMSTR-LENGTH)
 21415*    END-EXEC.
 21416     MOVE 0
 21417       TO DFHEIV11
 21418*    MOVE '&,   KG    E          &   #00017833' TO DFHEIV0
 21419     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21420     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 397
* EL6311.cbl
 21421     MOVE X'2020233030303137383333' TO DFHEIV0(25:11)
 21422     CALL 'kxdfhei1' USING DFHEIV0,
 21423           CLMS-ID,
 21424           ELMSTR-KEY,
 21425           ELMSTR-LENGTH,
 21426           DFHEIV11,
 21427           DFHEIV99
 21428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21429
 21430
 21431     display 'browse started'
 21432     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21433
 21434 6400-NEXT-CLAIM.
 21435
 21436
 21437* EXEC CICS READNEXT
 21438*        DATASET   (CLMS-ID)
 21439*        RIDFLD    (ELMSTR-KEY)
 21440*        SET       (ADDRESS OF CLAIM-MASTER)
 21441*    END-EXEC.
 21442     MOVE 0
 21443       TO DFHEIV11
 21444*    MOVE '&.S                   )   #00017845' TO DFHEIV0
 21445     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21446     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21447     MOVE X'2020233030303137383435' TO DFHEIV0(25:11)
 21448     CALL 'kxdfhei1' USING DFHEIV0,
 21449           CLMS-ID,
 21450           DFHEIV20,
 21451           DFHEIV99,
 21452           ELMSTR-KEY,
 21453           DFHEIV99,
 21454           DFHEIV11,
 21455           DFHEIV99,
 21456           DFHEIV99
 21457     SET ADDRESS OF CLAIM-MASTER TO
 21458         DFHEIV20
 21459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21460
 21461
 21462     display 'read claim for ' mstr-cert-no
 21463     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21464        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21465         GO TO 6400-CONTINUE
 21466     END-IF.
 21467
 21468     IF PI-CARRIER     NOT = CL-CARRIER        OR
 21469        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 21470        PI-STATE       NOT = CL-CERT-STATE     OR
 21471        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 21472        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 21473         GO TO 6400-NEXT-CLAIM
 21474     END-IF.
 21475
 21476     display 'found claim ' cl-claim-no
 21477        ' with denial type ' cl-denial-type
 21478     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 398
* EL6311.cbl
 21479         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 21480         GO TO 6400-CONTINUE
 21481     END-IF.
 21482
 21483     GO TO 6400-NEXT-CLAIM.
 21484
 21485 6400-CONTINUE.
 21486
 21487     IF WS-BROWSE-STARTED-SW = 'Y'
 21488
 21489* EXEC CICS ENDBR
 21490*            DATASET   (CLMS-ID)
 21491*        END-EXEC
 21492     MOVE 0
 21493       TO DFHEIV11
 21494*    MOVE '&2                    $   #00017877' TO DFHEIV0
 21495     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21496     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21497     MOVE X'2020233030303137383737' TO DFHEIV0(25:11)
 21498     CALL 'kxdfhei1' USING DFHEIV0,
 21499           CLMS-ID,
 21500           DFHEIV11,
 21501           DFHEIV99
 21502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21503         MOVE 'N' TO WS-BROWSE-STARTED-SW
 21504     END-IF.
 21505
 21506 6400-EXIT.
 21507     EXIT.
 21508
 21509 7000-DISPLAY-ISSUES.
 21510
 21511     IF PI-DISPLAY-ORIGINAL-BATCH
 21512        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21513        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21514     ELSE
 21515        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21516
 21517     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21518
 21519     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21520     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21521
 21522     MOVE LOW-VALUES                 TO EL631BI.
 21523     MOVE ZEROS                      TO PI-BPMTAMT
 21524                                        PI-BPMTS.
 21525     MOVE SPACE                      TO PI-BMODE
 21526                                        PI-BTYPE (1)
 21527                                        PI-BTYPE (2).
 21528     MOVE EL631B                     TO PI-MAP-NAME.
 21529     MOVE 'Y'                        TO PI-BROWSE-SW.
 21530     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 21531                                        PI-HIGH-SEQ-NO.
 21532
 21533     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21534        MOVE AL-SABOF                TO BCHGTA
 21535        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 21536        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 399
* EL6311.cbl
 21537     ELSE
 21538        MOVE AL-SADOF                TO BCHGTA
 21539                                        BCHGA
 21540        MOVE PB-CHG-COUNT            TO BCHGO.
 21541
 21542     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 21543     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 21544     MOVE WS-HR-MINS                 TO BMANTATO.
 21545
 21546     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 21547        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 21548        MOVE SPACE                   TO DC-OPTION-CODE
 21549        PERFORM 9700-DATE-LINK
 21550        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21551        MOVE 'INACTIVE'              TO BMOENDTO
 21552     ELSE
 21553        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 21554        MOVE SPACE                   TO DC-OPTION-CODE
 21555        PERFORM 9700-DATE-LINK
 21556        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21557        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 21558        MOVE SPACE                   TO DC-OPTION-CODE
 21559        PERFORM 9700-DATE-LINK
 21560        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 21561
 21562*    MOVE PB-I-REFERENCE             TO BREFO.
 21563
 21564*    IF PI-COMPANY-ID EQUAL 'HER'
 21565*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 21566*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 21567*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 21568*                MOVE WS-MEMBER-NO-1-8
 21569*                                TO  BMICRNOO.
 21570
 21571*    IF PB-I-MICROFILM-NO  IS NUMERIC
 21572*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 21573*            MOVE PB-I-MICROFILM-NO
 21574*                                TO  BMICRNOO.
 21575     IF PB-I-VIN NOT = SPACES
 21576        MOVE PB-I-VIN            TO BVINO
 21577     END-IF
 21578
 21579     MOVE PB-CERT-PRIME              TO BCERTNOO.
 21580     MOVE PB-CERT-SFX                TO BSUFIXO.
 21581     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21582     MOVE SPACE                      TO DC-OPTION-CODE.
 21583     PERFORM 9700-DATE-LINK.
 21584     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 21585
 21586     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 21587     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 21588     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 21589     MOVE PB-I-INSURED-SEX           TO BSEXO
 21590
 21591     IF PB-I-AGE NOT = ZEROS
 21592         MOVE PB-I-AGE               TO BAGEO.
 21593
 21594     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 400
* EL6311.cbl
 21595                                 TO ELCERT-KEY
 21596     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 21597     IF NOT CERT-TRL-REC-NOT-FOUND
 21598         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 21599             MOVE 'AGE*'             TO BAGEDEFO
 21600         ELSE
 21601             MOVE 'AGE '             TO BAGEDEFO
 21602         END-IF
 21603     ELSE
 21604         MOVE 'AGE '             TO BAGEDEFO
 21605     END-IF
 21606
 21607     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 21608         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 21609         MOVE SPACE                  TO DC-OPTION-CODE
 21610         PERFORM 9700-DATE-LINK
 21611         IF NO-CONVERSION-ERROR
 21612            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 21613
 21614     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 21615         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 21616         MOVE SPACE                  TO DC-OPTION-CODE
 21617         PERFORM 9700-DATE-LINK
 21618         IF NO-CONVERSION-ERROR
 21619            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 21620
 21621     IF PB-I-EXTENTION-DAYS NUMERIC
 21622        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 21623           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 21624        ELSE
 21625           IF PB-I-TERM-IN-DAYS NUMERIC
 21626              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 21627                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 21628
 21629     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 21630        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 21631
 21632     MOVE PB-FORCE-CODE              TO BFORCEO.
 21633     MOVE PB-I-TERM-TYPE             TO BMODEO
 21634                                        PI-BMODE.
 21635
 21636     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 21637        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 21638
 21639     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 21640         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 21641                                        PI-BPMTS.
 21642
 21643     IF PB-I-PAYMENT-AMOUNT NUMERIC
 21644         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 21645           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 21646                                        PI-BPMTAMT.
 21647
 21648     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 21649     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 21650     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 21651     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 21652     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 401
* EL6311.cbl
 21653     MOVE PB-I-SIG-SW                TO BSIGO.
 21654     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 21655     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 21656     MOVE PB-RECORD-BILL             TO BBILCDO.
 21657     MOVE PB-FORCE-CODE              TO BFORCEO.
 21658
 21659     IF (PB-I-LIVES NUMERIC)
 21660        AND (PB-I-LIVES > ZEROS)
 21661        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21662        IF (RESP-NORMAL)
 21663           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 21664           CONTINUE
 21665        ELSE
 21666           MOVE PB-I-LIVES       TO BLIVESO
 21667        END-IF
 21668     END-IF
 21669
 21670     IF PB-I-NUM-BILLED NUMERIC AND
 21671        PB-I-NUM-BILLED GREATER THAN ZEROS
 21672        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 21673*    ELSE
 21674*       MOVE ZEROS                   TO BBILLEDO.
 21675
 21676     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 21677
 21678     IF PB-I-LOAN-APR NOT = ZEROS and +99.9999
 21679        MOVE PB-I-LOAN-APR           TO BAPRO.
 21680
 21681     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 21682        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 21683
 21684     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 21685        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 21686           MOVE AL-SANOF                TO BORIGHDA
 21687           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 21688           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 21689
 21690     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 21691
 21692     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 21693        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 21694
 21695     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 21696        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 21697                                        PI-BTYPE (1).
 21698
 21699     IF PB-I-LF-TERM     GREATER THAN ZEROS
 21700        MOVE PB-I-LF-TERM            TO BTERMO (1).
 21701
 21702     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 21703        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 21704
 21705     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 21706        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 21707
 21708     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 21709        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 21710
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 402
* EL6311.cbl
 21711     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21712        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 21713
 21714     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 21715         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 21716         MOVE SPACE                  TO DC-OPTION-CODE
 21717         PERFORM 9700-DATE-LINK
 21718         IF NO-CONVERSION-ERROR
 21719            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 21720
 21721     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21722        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 21723        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 21724        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 21725        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 21726                 GIVING BDIFFO (1)
 21727     ELSE
 21728        MOVE SPACES                  TO BBEN-CD     (1)
 21729                                        BBEN-ABBR   (1).
 21730
 21731     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21732        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 21733        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 21734                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 21735
 21736     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21737       IF PB-RECORD-ON-HOLD
 21738          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 21739
 21740     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21741       IF PB-RECORD-RETURNED
 21742          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 21743
 21744     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21745        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21746             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 21747
 21748     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 21749
 21750     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 21751        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 21752
 21753     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 21754        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 21755                                        PI-BTYPE (2).
 21756
 21757     IF PB-I-AH-TERM     GREATER THAN ZEROS
 21758        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 21759
 21760     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 21761        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 21762
 21763     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 21764        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 21765
 21766     IF PB-I-TOT-FEES NOT NUMERIC
 21767        MOVE ZEROS               TO PB-I-TOT-FEES
 21768     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 403
* EL6311.cbl
 21769     IF PB-I-TOT-FEES > ZEROS
 21770        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 21771
 21772     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 21773         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 21774         MOVE SPACE                  TO DC-OPTION-CODE
 21775         PERFORM 9700-DATE-LINK
 21776         IF NO-CONVERSION-ERROR
 21777            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 21778
 21779     IF PB-I-TOT-FEES > ZEROS
 21780        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 21781        SUBTRACT PB-I-TOT-FEES FROM
 21782                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 21783
 21784     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21785        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 21786        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 21787        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 21788        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 21789                 GIVING BDIFFO (2)
 21790     ELSE
 21791        MOVE SPACES                  TO BBEN-CD     (2)
 21792                                        BBEN-ABBR   (2).
 21793
 21794     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21795       IF PB-RECORD-ON-HOLD
 21796          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 21797
 21798     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21799       IF PB-RECORD-RETURNED
 21800          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 21801
 21802     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21803        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21804             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 21805
 21806     MOVE PB-CSR-ID                  TO BCSRO.
 21807
 21808     IF PI-COMPANY-ID  =  'DMD'
 21809        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 21810            NEXT SENTENCE
 21811        ELSE
 21812            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 21813               MOVE 'NEW CERT'       TO BNCERTLI
 21814               MOVE EC-NEW-CERT      TO BNCERTO.
 21815
 21816     IF PI-COMPANY-ID  =  'DMD'
 21817        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 21818            NEXT SENTENCE
 21819        ELSE
 21820           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 21821               MOVE 'NEW STATE'      TO BNSTATLI
 21822               MOVE EC-NEW-STATE     TO BNSTATO.
 21823
 21824 7000-CONTINUE.
 21825     MOVE 'C'                        TO BMAINTI.
 21826     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 404
* EL6311.cbl
 21827
 21828     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 21829        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 21830
 21831     IF PI-6315-FINALIZED = 'Y'   AND
 21832        PB-UNFORCED-ERRORS
 21833          MOVE -1                TO BFORCEL
 21834          MOVE  1                TO SET-CURSOR-SW
 21835     END-IF
 21836
 21837     IF NO-CURSOR-SET
 21838        MOVE -1                      TO BMAINTL.
 21839
 21840     GO TO 8100-SEND-INITIAL-MAP.
 21841
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 405
* EL6311.cbl
 21843
 21844******************************************************************
 21845*                                                                *
 21846*             D I S P L A Y   C A N C E L S                      *
 21847*                                                                *
 21848******************************************************************
 21849
 21850 7100-DISPLAY-CANCELS.
 21851     IF PI-DISPLAY-ORIGINAL-BATCH
 21852        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21853        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21854     ELSE
 21855        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21856
 21857     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21858
 21859     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21860     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21861
 21862     MOVE LOW-VALUES                 TO EL631CI.
 21863     MOVE EL631C                     TO PI-MAP-NAME.
 21864     MOVE 'Y'                        TO PI-BROWSE-SW.
 21865     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 21866                                        PI-HIGH-SEQ-NO.
 21867
 21868     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21869        MOVE AL-SABOF                TO CCHGTA
 21870        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 21871        MOVE AL-SANON                TO CCHGA
 21872      ELSE
 21873        MOVE AL-SADOF                TO CCHGTA
 21874                                        CCHGA
 21875        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 21876
 21877*    MOVE PB-C-REFERENCE             TO CREFO.
 21878
 21879*    IF PB-C-MICROFILM-NO IS NUMERIC
 21880*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 21881*          MOVE PB-C-MICROFILM-NO
 21882*                                TO CMICRNOO
 21883*          MOVE AL-UNNON         TO CMICRNOA
 21884*       END-IF
 21885*    END-IF
 21886     IF PB-C-NH-INT-ON-REFS NUMERIC
 21887        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 21888           MOVE PB-C-NH-INT-ON-REFS
 21889                                 TO CNHINTO
 21890           MOVE AL-SANOF         TO CNHINTA
 21891        END-IF
 21892     END-IF
 21893     MOVE PB-CERT-PRIME              TO CCERTNOO.
 21894     MOVE PB-CERT-SFX                TO CSUFIXO.
 21895     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21896     MOVE SPACE                      TO DC-OPTION-CODE.
 21897     PERFORM 9700-DATE-LINK.
 21898     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 21899
 21900     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 406
* EL6311.cbl
 21901        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 21902        MOVE SPACE                   TO DC-OPTION-CODE
 21903        PERFORM 9700-DATE-LINK
 21904        IF NO-CONVERSION-ERROR
 21905           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 21906
 21907     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 21908        NEXT SENTENCE
 21909     ELSE
 21910        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 21911
 21912     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 21913        NEXT SENTENCE
 21914     ELSE
 21915        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 21916
 21917     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 21918        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 21919        MOVE SPACE                   TO DC-OPTION-CODE
 21920        PERFORM 9700-DATE-LINK
 21921        IF NO-CONVERSION-ERROR
 21922           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 21923
 21924     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21925         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 21926
 21927     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21928         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 21929
 21930     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 21931        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 21932        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 21933                 GIVING CDRFND1O.
 21934
 21935     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 21936        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 21937        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 21938                 GIVING CDRFND2O.
 21939
 21940     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21941       IF PB-RECORD-ON-HOLD
 21942          MOVE 'ON HOLD'             TO CBILIT1O.
 21943
 21944     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21945       IF PB-RECORD-RETURNED
 21946          MOVE 'RETURNED'            TO CBILIT1O.
 21947
 21948     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21949        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21950             MOVE 'OVERRIDE'         TO CBILIT1O.
 21951
 21952     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21953       IF PB-RECORD-ON-HOLD
 21954          MOVE 'ON HOLD'             TO CBILIT2O.
 21955
 21956     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21957       IF PB-RECORD-RETURNED
 21958          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 407
* EL6311.cbl
 21959
 21960     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21961        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21962             MOVE 'OVERRIDE'         TO CBILIT2O.
 21963
 21964     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 21965     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 21966     IF PB-C-POST-CARD-IND = 'Y'
 21967        MOVE 'Y'                     TO CPCYNO
 21968     ELSE
 21969        MOVE 'N'                     TO CPCYNO
 21970     END-IF
 21971     MOVE PB-FORCE-CODE              TO CFORCEO.
 21972     MOVE PB-RECORD-BILL             TO CBILCDO.
 21973     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 21974     MOVE SPACES                     TO CINITSO.
 21975     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 21976         MOVE PB-CI-FIRST-NAME       TO CINITSO
 21977     ELSE
 21978         MOVE PB-CI-INITIALS         TO CINITSO
 21979     END-IF.
 21980
 21981     IF PB-CI-CANCEL-FEE NUMERIC
 21982        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 21983        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 21984     ELSE
 21985        MOVE ZEROES                  TO W-CANCEL-FEE.
 21986
 21987     MOVE W-CANCEL-FEE               TO CCANFEEO.
 21988
 21989     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 21990        ADD PB-CI-LF-PREMIUM-AMT
 21991             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 21992
 21993     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 21994        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 21995
 21996     MOVE PB-CI-LF-TERM              TO CTERM1O.
 21997     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 21998     MOVE PB-CI-AH-TERM              TO CTERM2O.
 21999     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22000
 22001     IF PB-C-LIVES NUMERIC
 22002        MOVE PB-C-LIVES              TO CLIVESO.
 22003
 22004     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22005        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22006
 22007     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22008        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22009        MOVE SPACE                   TO DC-OPTION-CODE
 22010        PERFORM 9700-DATE-LINK
 22011        IF NO-CONVERSION-ERROR
 22012           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22013
 22014     IF  PB-C-REFUND-CREATED
 22015         MOVE 'YES'                  TO CRFNDSWO
 22016     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 408
* EL6311.cbl
 22017         IF PB-C-REFUND-REQUESTED
 22018            MOVE 'REQ'               TO CRFNDSWO
 22019         ELSE
 22020            MOVE 'NO'                TO CRFNDSWO.
 22021
 22022     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22023     MOVE SPACE                      TO DC-OPTION-CODE.
 22024     PERFORM 9700-DATE-LINK.
 22025     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22026     MOVE PB-INPUT-BY                TO CENTBYO.
 22027
 22028     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22029        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22030        MOVE SPACE                   TO DC-OPTION-CODE
 22031        PERFORM 9700-DATE-LINK
 22032        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22033        MOVE 'INACTIVE'              TO CMOENDTO
 22034     ELSE
 22035        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22036        MOVE SPACE                   TO DC-OPTION-CODE
 22037        PERFORM 9700-DATE-LINK
 22038        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22039        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22040        MOVE SPACE                   TO DC-OPTION-CODE
 22041        PERFORM 9700-DATE-LINK
 22042        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22043
 22044     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22045
 22046     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22047     MOVE WS-HR-MINS                 TO CMANTATO.
 22048
 22049     EVALUATE PB-LF-REFUND-TYPE
 22050        WHEN '1'
 22051           MOVE 'RULE78'            TO CLFREFNO
 22052        WHEN '2'
 22053           MOVE 'PRORAT'            TO CLFREFNO
 22054        WHEN '3'
 22055           MOVE 'CALIF'             TO CLFREFNO
 22056        WHEN '4'
 22057           MOVE 'IRREG'             TO CLFREFNO
 22058        WHEN '5'
 22059           MOVE 'NETPAY'            TO CLFREFNO
 22060        WHEN '6'
 22061           MOVE 'ATCP'              TO CLFREFNO
 22062        WHEN '7'
 22063           MOVE 'UTAH'              TO CLFREFNO
 22064        WHEN '8'
 22065           MOVE 'MEAN'              TO CLFREFNO
 22066        WHEN '9'
 22067           MOVE 'SUM '              TO CLFREFNO
 22068        WHEN 'B'
 22069           MOVE 'BALN'              TO CLFREFNO
 22070     END-EVALUATE.
 22071
 22072     EVALUATE TRUE
 22073        WHEN PB-AH-REFUND-TYPE =  '1'
 22074           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 409
* EL6311.cbl
 22075        WHEN PB-AH-REFUND-TYPE =  '2'
 22076           MOVE 'PRORAT'            TO CAHREFNO
 22077        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22078           MOVE 'CALIF'             TO CAHREFNO
 22079        WHEN PB-AH-REFUND-TYPE =  '4'
 22080           MOVE 'IRREG'             TO CAHREFNO
 22081        WHEN PB-AH-REFUND-TYPE =  '5'
 22082           MOVE 'NETPAY'            TO CAHREFNO
 22083        WHEN PB-AH-REFUND-TYPE =  '6'
 22084           MOVE 'ATCP'              TO CAHREFNO
 22085        WHEN PB-AH-REFUND-TYPE =  '7'
 22086           MOVE 'UTAH'              TO CAHREFNO
 22087        WHEN PB-AH-REFUND-TYPE =  '8'
 22088           MOVE 'MEAN'              TO CAHREFNO
 22089        WHEN PB-AH-REFUND-TYPE =  '9'
 22090           MOVE 'SUM '              TO CAHREFNO
 22091        WHEN PB-AH-REFUND-TYPE =  'B'
 22092           MOVE 'BALN'              TO CAHREFNO
 22093     END-EVALUATE.
 22094
 22095     MOVE PB-REIN-CD                 TO CREINCDO.
 22096
 22097     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22098        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22099        MOVE SPACE                   TO DC-OPTION-CODE
 22100        PERFORM 9700-DATE-LINK
 22101        IF NO-CONVERSION-ERROR
 22102           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22103
 22104     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22105        MOVE 999999                  TO WS-EXP-DT-EDIT
 22106        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22107        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22108     ELSE
 22109        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22110           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22111           MOVE SPACE                   TO DC-OPTION-CODE
 22112           PERFORM 9700-DATE-LINK
 22113           IF NO-CONVERSION-ERROR
 22114              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22115
 22116     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22117        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22118           MOVE AL-SANOF                TO CORIGHDA
 22119           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22120           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22121
 22122     MOVE PB-CSR-ID              TO CCSRO.
 22123
 22124     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22125     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22126
 22127     MOVE 'C'                    TO CMAINTI.
 22128     MOVE AL-UANON               TO CMAINTA.
 22129
 22130     IF PI-6316-FINALIZED = 'Y'  AND
 22131        PB-UNFORCED-ERRORS
 22132          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 410
* EL6311.cbl
 22133          MOVE  1                TO SET-CURSOR-SW
 22134     END-IF
 22135
 22136     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22137        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22138
 22139     IF NO-CURSOR-SET
 22140        MOVE -1                  TO CMAINTL.
 22141
 22142     GO TO 8100-SEND-INITIAL-MAP.
 22143
 22144
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 411
* EL6311.cbl
 22146***************************************************************
 22147*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22148*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22149***************************************************************
 22150
 22151 7200-DISPLAY-BATCHES.
 22152     MOVE EL631D                 TO PI-MAP-NAME.
 22153     MOVE LOW-VALUES             TO EL631DI.
 22154
 22155     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22156
 22157
 22158* EXEC CICS HANDLE CONDITION
 22159*         NOTFND   (3690-NOT-FOUND)
 22160*    END-EXEC.
 22161*    MOVE '"$I                   ! Y #00018534' TO DFHEIV0
 22162     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22163     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22164     MOVE X'5920233030303138353334' TO DFHEIV0(25:11)
 22165     CALL 'kxdfhei1' USING DFHEIV0
 22166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22167
 22168
 22169     IF PI-DISPLAY-SCREEN
 22170        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22171     ELSE
 22172        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22173
 22174     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22175     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22176
 22177
 22178* EXEC CICS READ
 22179*         DATASET   (FILE-ID-ERPNDB)
 22180*         RIDFLD    (ERPNDB-KEY)
 22181*         SET       (ADDRESS OF PENDING-BUSINESS)
 22182*    END-EXEC.
 22183*    MOVE '&"S        E          (   #00018546' TO DFHEIV0
 22184     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22185     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22186     MOVE X'2020233030303138353436' TO DFHEIV0(25:11)
 22187     CALL 'kxdfhei1' USING DFHEIV0,
 22188           FILE-ID-ERPNDB,
 22189           DFHEIV20,
 22190           DFHEIV99,
 22191           ERPNDB-KEY,
 22192           DFHEIV99,
 22193           DFHEIV99,
 22194           DFHEIV99
 22195     SET ADDRESS OF PENDING-BUSINESS TO
 22196         DFHEIV20
 22197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22198
 22199
 22200     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22201     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22202     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22203     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 412
* EL6311.cbl
 22204     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22205
 22206     MOVE EL631D                 TO PI-MAP-NAME.
 22207     MOVE LOW-VALUES             TO EL631DI.
 22208     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22209
 22210*    IF PI-AR-PROCESSING
 22211*       MOVE PB-REFERENCE        TO DREFO.
 22212
 22213     MOVE PB-CSR-ID              TO DCSRO.
 22214
 22215     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22216        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22217        MOVE SPACE               TO DC-OPTION-CODE
 22218        PERFORM 9700-DATE-LINK
 22219        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22220        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22221        MOVE 'INACTIVE'          TO DLDATEO
 22222     ELSE
 22223        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22224        MOVE SPACE               TO DC-OPTION-CODE
 22225        PERFORM 9700-DATE-LINK
 22226        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22227
 22228     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22229     MOVE SPACE                  TO DC-OPTION-CODE.
 22230     PERFORM 9700-DATE-LINK.
 22231     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22232
 22233     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22234        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22235     ELSE
 22236        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22237        MOVE SPACE               TO DC-OPTION-CODE
 22238        PERFORM 9700-DATE-LINK
 22239        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22240
 22241     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22242     MOVE SPACE                  TO DC-OPTION-CODE.
 22243     PERFORM 9700-DATE-LINK.
 22244     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22245
 22246     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22247     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22248
 22249     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22250        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22251                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22252
 22253     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22254     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22255     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22256
 22257     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22258        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22259                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22260
 22261     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 413
* EL6311.cbl
 22262     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22263     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22264
 22265     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22266        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22267                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22268
 22269     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22270     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22271
 22272     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22273        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22274                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22275
 22276     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22277     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22278     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22279
 22280     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22281        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22282                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22283
 22284     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22285     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22286     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22287
 22288     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22289        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22290                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22291
 22292     MOVE -1                     TO DPFENTRL.
 22293     GO TO 8100-SEND-INITIAL-MAP.
 22294
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 414
* EL6311.cbl
 22296
 22297***************************************************************
 22298*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22299*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22300*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22301*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22302*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22303*     ARE THEN SET ACCORDINGLY.                               *
 22304*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22305*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22306*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22307***************************************************************
 22308
 22309******************************************************************
 22310*                                                                *
 22311*            E R R O R   A N A L Y S I S                         *
 22312*                                                                *
 22313******************************************************************
 22314
 22315******************************************************************
 22316*                                                                *
 22317*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22318*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22319*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22320*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22321*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22322*                                                                *
 22323*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22324*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22325*                                                                *
 22326******************************************************************
 22327
 22328 7300-FORMAT-ERRORS.
 22329     MOVE ' '                    TO PI-ERRORS-SW
 22330     IF PB-COMMON-ERRORS = LOW-VALUES
 22331        IF PB-FATAL-ERRORS
 22332           MOVE ER-2695          TO EMI-ERROR
 22333           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22334           GO TO 7399-EXIT.
 22335
 22336     MOVE +0                     TO WS-SUB4.
 22337
 22338 7310-ERROR-LOOP.
 22339
 22340     ADD +1                      TO WS-SUB4.
 22341
 22342     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22343        GO TO 7350-SET-ERROR-FLAGS.
 22344
 22345     IF PI-COMPANY-ID = 'UCL'
 22346         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22347             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22348             MOVE ' '                   TO DC-OPTION-CODE
 22349             PERFORM 9700-DATE-LINK
 22350             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22351
 22352     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22353     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 415
* EL6311.cbl
 22354     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22355
 22356     GO TO 7310-ERROR-LOOP.
 22357
 22358
 22359 7350-SET-ERROR-FLAGS.
 22360
 22361     IF EMI-FATAL-CTR NOT = ZEROS
 22362        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22363        MOVE 'X'                 TO PB-FATAL-FLAG
 22364                                    PI-ERRORS-SW
 22365        GO TO 7355-SET-ERROR-FLAGS.
 22366
 22367     IF EMI-FORCABLE-CTR NOT = ZEROS
 22368        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22369        IF PB-ISSUE
 22370           IF PB-ISSUE-FORCE
 22371              MOVE 'F'           TO PB-FORCE-ER-CD
 22372              MOVE ER-2600       TO EMI-ERROR
 22373              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22374             ELSE
 22375              MOVE 'X'           TO PB-FORCE-ER-CD
 22376*                                   PI-ERRORS-SW
 22377          ELSE
 22378           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22379              MOVE 'F'           TO PB-FORCE-ER-CD
 22380              MOVE ER-2600       TO EMI-ERROR
 22381              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22382             ELSE
 22383              MOVE 'X'           TO PB-FORCE-ER-CD.
 22384*                                   PI-ERRORS-SW.
 22385
 22386     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22387     IF PB-ISSUE
 22388         MOVE 'I'                TO ENDT-RECORD-TYPE
 22389     ELSE
 22390         MOVE 'C'                TO ENDT-RECORD-TYPE
 22391     END-IF
 22392     MOVE +0                     TO ENDT-SEQ-NO
 22393
 22394
 22395* EXEC CICS READ
 22396*        DATASET   (FILE-ID-ERENDT)
 22397*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22398*        RIDFLD    (ERENDT-KEY)
 22399*        RESP      (WS-RESPONSE)
 22400*        GTEQ
 22401*    END-EXEC
 22402*    MOVE '&"S        G          (  N#00018746' TO DFHEIV0
 22403     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22404     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22405     MOVE X'204E233030303138373436' TO DFHEIV0(25:11)
 22406     CALL 'kxdfhei1' USING DFHEIV0,
 22407           FILE-ID-ERENDT,
 22408           DFHEIV20,
 22409           DFHEIV99,
 22410           ERENDT-KEY,
 22411           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 416
* EL6311.cbl
 22412           DFHEIV99,
 22413           DFHEIV99
 22414     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22415         DFHEIV20
 22416     MOVE EIBRESP  TO WS-RESPONSE
 22417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22418
 22419     IF RESP-NORMAL
 22420        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22421        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22422            MOVE ER-0280          TO EMI-ERROR
 22423            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22424            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22425            EVALUATE TRUE
 22426              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22427                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22428              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22429                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22430              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22431                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22432            END-EVALUATE
 22433        END-IF
 22434     END-IF
 22435
 22436
 22437
 22438     IF FIRST-ENTRY OR
 22439        EIBAID = DFHPF1 OR DFHPF2
 22440        MOVE '0'                TO PI-EDIT-SW
 22441        GO TO 7399-EXIT.
 22442
 22443 7355-SET-ERROR-FLAGS.
 22444
 22445     IF EMI-WARNING-CTR NOT = ZEROS
 22446        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22447        MOVE 'W'                 TO PB-WARN-ER-CD.
 22448
 22449     IF PB-UNFORCED-ERRORS OR
 22450        PB-FATAL-ERRORS    OR
 22451        PB-RECORD-ON-HOLD  OR
 22452        PB-RECORD-RETURNED OR
 22453        PB-CANCELLATION
 22454          NEXT SENTENCE
 22455        ELSE
 22456          GO TO 7399-EXIT.
 22457
 22458
 22459* EXEC CICS  HANDLE CONDITION
 22460*           NOTFND   (7399-EXIT)
 22461*    END-EXEC.
 22462*    MOVE '"$I                   ! Z #00018793' TO DFHEIV0
 22463     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22464     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22465     MOVE X'5A20233030303138373933' TO DFHEIV0(25:11)
 22466     CALL 'kxdfhei1' USING DFHEIV0
 22467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22468
 22469
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 417
* EL6311.cbl
 22470     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 22471     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 22472     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 22473     MOVE PB-SV-STATE            TO ELCERT-STATE.
 22474
 22475
 22476* EXEC CICS READ
 22477*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 22478*        DATASET (FILE-ID-ELCERT)
 22479*        RIDFLD  (ELCERT-KEY)
 22480*        UPDATE
 22481*    END-EXEC.
 22482*    MOVE '&"S        EU         (   #00018802' TO DFHEIV0
 22483     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22484     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22485     MOVE X'2020233030303138383032' TO DFHEIV0(25:11)
 22486     CALL 'kxdfhei1' USING DFHEIV0,
 22487           FILE-ID-ELCERT,
 22488           DFHEIV20,
 22489           DFHEIV99,
 22490           ELCERT-KEY,
 22491           DFHEIV99,
 22492           DFHEIV99,
 22493           DFHEIV99
 22494     SET ADDRESS OF CERTIFICATE-MASTER TO
 22495         DFHEIV20
 22496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22497
 22498
 22499
 22500     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 22501     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 22502
 22503     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 22504        GO TO 7360-REWRITE-CERT-MASTER.
 22505
 22506     IF PB-ISSUE
 22507        IF PB-RECORD-RETURNED
 22508            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 22509            GO TO 7360-REWRITE-CERT-MASTER
 22510        ELSE
 22511            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 22512            GO TO 7360-REWRITE-CERT-MASTER.
 22513
 22514     IF PB-RECORD-RETURNED
 22515         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 22516         GO TO 7360-REWRITE-CERT-MASTER.
 22517
 22518     IF (PB-C-LF-CANCEL-VOIDED)
 22519        or (pb-c-ah-cancel-voided)
 22520        IF (PB-UNFORCED-ERRORS OR
 22521            PB-FATAL-ERRORS    OR
 22522            PB-RECORD-ON-HOLD)
 22523            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 22524            GO TO 7360-REWRITE-CERT-MASTER
 22525        ELSE
 22526            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 22527            GO TO 7360-REWRITE-CERT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 418
* EL6311.cbl
 22528
 22529     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 22530                            OR PB-RECORD-ON-HOLD)
 22531        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 22532     ELSE
 22533        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 22534
 22535 7360-REWRITE-CERT-MASTER.
 22536
 22537     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22538        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22539
 22540* EXEC CICS UNLOCK
 22541*            DATASET    (FILE-ID-ELCERT)
 22542*       END-EXEC
 22543*    MOVE '&*                    #   #00018849' TO DFHEIV0
 22544     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22545     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22546     MOVE X'2020233030303138383439' TO DFHEIV0(25:11)
 22547     CALL 'kxdfhei1' USING DFHEIV0,
 22548           FILE-ID-ELCERT,
 22549           DFHEIV99
 22550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22551        GO TO 7399-EXIT.
 22552
 22553
 22554* EXEC CICS REWRITE
 22555*         DATASET    (FILE-ID-ELCERT)
 22556*         FROM       (CERTIFICATE-MASTER)
 22557*    END-EXEC.
 22558     MOVE LENGTH OF
 22559      CERTIFICATE-MASTER
 22560       TO DFHEIV11
 22561*    MOVE '&& L                  %   #00018854' TO DFHEIV0
 22562     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22563     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22564     MOVE X'2020233030303138383534' TO DFHEIV0(25:11)
 22565     CALL 'kxdfhei1' USING DFHEIV0,
 22566           FILE-ID-ELCERT,
 22567           CERTIFICATE-MASTER,
 22568           DFHEIV11,
 22569           DFHEIV99
 22570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22571
 22572
 22573 7399-EXIT.
 22574      EXIT.
 22575
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 419
* EL6311.cbl
 22577
 22578*************************************************************
 22579*                                                           *
 22580*              S E T   A T T R I B U T E S                  *
 22581*                                                           *
 22582*************************************************************
 22583
 22584 7400-SET-ATTRIBUTES.
 22585
 22586     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22587        GO TO 7499-EXIT.
 22588
 22589**2601**
 22590
 22591     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 22592        IF PB-ISSUE
 22593           MOVE AL-UABON         TO BEFFDTA
 22594           GO TO 7499-EXIT
 22595         ELSE
 22596           MOVE AL-UABON         TO CEFFDTA
 22597           GO TO 7499-EXIT.
 22598
 22599**2604**
 22600
 22601     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 22602        IF PB-ISSUE
 22603           MOVE AL-UABON         TO BTYPE1A
 22604           MOVE -1               TO BTYPE1L
 22605           MOVE  1               TO SET-CURSOR-SW
 22606           GO TO 7499-EXIT.
 22607
 22608**2605**
 22609
 22610     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 22611        IF PB-ISSUE
 22612           MOVE AL-UABON         TO BTYPE2A
 22613           MOVE -1               TO BTYPE2L
 22614           MOVE  1               TO SET-CURSOR-SW
 22615           GO TO 7499-EXIT.
 22616
 22617**2606**
 22618
 22619     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 22620        IF PB-ISSUE
 22621           MOVE AL-UABON         TO BSIGA
 22622           MOVE -1               TO BSIGL
 22623           MOVE  1               TO SET-CURSOR-SW
 22624           GO TO 7499-EXIT.
 22625
 22626**2607**
 22627
 22628     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22629        IF PB-ISSUE
 22630           MOVE AL-UABON         TO BSIGA
 22631           MOVE -1               TO BSIGL
 22632           MOVE  1               TO SET-CURSOR-SW
 22633           GO TO 7499-EXIT.
 22634
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 420
* EL6311.cbl
 22635**2615**
 22636
 22637     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22638        IF PB-ISSUE
 22639           MOVE AL-UABOF         TO BREINA
 22640           MOVE -1               TO BREINL
 22641           GO TO 7499-EXIT.
 22642
 22643**2622**
 22644
 22645     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 22646        IF PB-ISSUE
 22647           MOVE AL-UABON         TO BEFFDTA
 22648           GO TO 7499-EXIT
 22649        ELSE
 22650           MOVE AL-UABON         TO CEFFDTA
 22651           GO TO 7499-EXIT.
 22652
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 421
* EL6311.cbl
 22654
 22655*************************************************************
 22656*                                                           *
 22657*              I S S U E   E R R O R S                      *
 22658*                                                           *
 22659*************************************************************
 22660
 22661 7420-ISSUE-ERRORS.
 22662
 22663**2626**
 22664
 22665     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 22666        MOVE AL-UABON            TO BCERTNOA
 22667        GO TO 7499-EXIT.
 22668
 22669**2627**
 22670
 22671     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 22672        MOVE AL-UNBON            TO BAGEA
 22673        MOVE -1                  TO BAGEL
 22674        MOVE  1                  TO SET-CURSOR-SW
 22675        GO TO 7499-EXIT.
 22676
 22677**2628**
 22678
 22679     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 22680        MOVE AL-UNBON            TO BAGEA
 22681        MOVE -1                  TO BAGEL
 22682        MOVE  1                  TO SET-CURSOR-SW
 22683        GO TO 7499-EXIT.
 22684
 22685**2629**
 22686
 22687     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 22688        MOVE AL-UABON            TO BSEXA
 22689        MOVE -1                  TO BSEXL
 22690        MOVE  1                  TO SET-CURSOR-SW
 22691        GO TO 7499-EXIT.
 22692
 22693**2630**
 22694
 22695     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 22696        MOVE -1                  TO BTYPE1L
 22697        MOVE  1                  TO SET-CURSOR-SW
 22698        GO TO 7499-EXIT.
 22699
 22700**2631**
 22701
 22702     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 22703        MOVE -1                  TO BTYPE1L
 22704        MOVE  1                  TO SET-CURSOR-SW
 22705        GO TO 7499-EXIT.
 22706
 22707**2632**
 22708
 22709     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 22710        MOVE AL-UNBON            TO BBEN1A
 22711        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 422
* EL6311.cbl
 22712        MOVE  1                  TO SET-CURSOR-SW
 22713        GO TO 7499-EXIT.
 22714
 22715**2633**
 22716
 22717     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 22718        MOVE AL-UNBON            TO BPREM1A
 22719        MOVE -1                  TO BPREM1L
 22720        MOVE  1                  TO SET-CURSOR-SW
 22721        GO TO 7499-EXIT.
 22722
 22723**2634**
 22724
 22725     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 22726        MOVE -1                  TO BTYPE2L
 22727        MOVE  1                  TO SET-CURSOR-SW
 22728        GO TO 7499-EXIT.
 22729
 22730**2635**
 22731
 22732     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 22733        MOVE AL-UNBON            TO BBEN2A
 22734        MOVE -1                  TO BBEN2L
 22735        MOVE  1                  TO SET-CURSOR-SW
 22736        GO TO 7499-EXIT.
 22737
 22738**2636**
 22739
 22740     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 22741        MOVE AL-UNBON            TO BPREM2A
 22742        MOVE -1                  TO BPREM2L
 22743        MOVE  1                  TO SET-CURSOR-SW
 22744        GO TO 7499-EXIT.
 22745
 22746**2639**
 22747
 22748     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 22749        MOVE AL-UNBON            TO BBEN1A
 22750        MOVE -1                  TO BBEN1L
 22751        MOVE  1                  TO SET-CURSOR-SW
 22752        GO TO 7499-EXIT.
 22753
 22754**2640**
 22755
 22756     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 22757        MOVE AL-UNBON            TO BBEN2A
 22758        MOVE -1                  TO BBEN2L
 22759        MOVE  1                  TO SET-CURSOR-SW
 22760        GO TO 7499-EXIT.
 22761
 22762**2647**
 22763
 22764     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 22765        MOVE AL-UNBON            TO BTERM1A
 22766        MOVE -1                  TO BTERM1L
 22767        MOVE  1                  TO SET-CURSOR-SW
 22768        GO TO 7499-EXIT.
 22769
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 423
* EL6311.cbl
 22770**2648**
 22771
 22772     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 22773        MOVE AL-UNBON            TO BLNTRMA
 22774        MOVE -1                  TO BLNTRML
 22775        MOVE  1                  TO SET-CURSOR-SW
 22776        GO TO 7499-EXIT.
 22777
 22778**2649**
 22779
 22780     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22781        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22782            MOVE AL-UNBON            TO BPREM1A
 22783            MOVE -1                  TO BPREM1L
 22784            MOVE  1                  TO SET-CURSOR-SW
 22785            GO TO 7499-EXIT
 22786     ELSE
 22787        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22788           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22789            MOVE AL-UNBON            TO BPREM2A
 22790            MOVE -1                  TO BPREM2L
 22791            MOVE  1                  TO SET-CURSOR-SW
 22792            GO TO 7499-EXIT.
 22793
 22794**2650**
 22795
 22796     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22797        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22798            MOVE AL-UNBON        TO BPREM1A
 22799            MOVE -1              TO BPREM1L
 22800            MOVE  1              TO SET-CURSOR-SW
 22801            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22802                MOVE AL-UNBON        TO BPREM2A
 22803                MOVE -1              TO BPREM2L
 22804                MOVE  1              TO SET-CURSOR-SW
 22805                GO TO 7499-EXIT
 22806            ELSE
 22807                GO TO 7499-EXIT
 22808        ELSE
 22809            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22810                MOVE AL-UNBON        TO BPREM2A
 22811                MOVE -1              TO BPREM2L
 22812                MOVE  1              TO SET-CURSOR-SW
 22813                GO TO 7499-EXIT
 22814            ELSE
 22815                GO TO 7499-EXIT.
 22816
 22817**2651**
 22818
 22819     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22820        MOVE AL-UABON            TO BSIGA
 22821        MOVE -1                  TO BSIGL
 22822        MOVE  1                  TO SET-CURSOR-SW
 22823        GO TO 7499-EXIT.
 22824
 22825**2653**
 22826
 22827     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 424
* EL6311.cbl
 22828        MOVE AL-UABON            TO BFREQA
 22829        MOVE -1                  TO BFREQL
 22830        MOVE  1                  TO SET-CURSOR-SW
 22831        GO TO 7499-EXIT.
 22832
 22833**2654**
 22834
 22835     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 22836        MOVE AL-UABON            TO BFREQA
 22837        MOVE -1                  TO BFREQL
 22838        MOVE  1                  TO SET-CURSOR-SW
 22839        GO TO 7499-EXIT.
 22840
 22841**2655**
 22842
 22843     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 22844        MOVE AL-UABON            TO BFREQA
 22845        MOVE -1                  TO BFREQL
 22846        MOVE  1                  TO SET-CURSOR-SW
 22847        GO TO 7499-EXIT.
 22848
 22849**2656**
 22850
 22851     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 22852        MOVE AL-UNBON            TO BAPRA
 22853        MOVE -1                  TO BAPRL
 22854        MOVE  1                  TO SET-CURSOR-SW
 22855        GO TO 7499-EXIT.
 22856
 22857**2657**
 22858
 22859     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22860        MOVE AL-UNBON            TO BAPRA
 22861        MOVE -1                  TO BAPRL
 22862        MOVE  1                  TO SET-CURSOR-SW
 22863        GO TO 7499-EXIT.
 22864
 22865**2658**
 22866
 22867     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22868        MOVE AL-UNBON            TO BTERM2A
 22869        MOVE -1                  TO BTERM2L
 22870        MOVE  1                  TO SET-CURSOR-SW
 22871        GO TO 7499-EXIT.
 22872
 22873**2660**
 22874
 22875     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 22876        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 22877        MOVE -1                  TO BLSTNML
 22878        MOVE  1                  TO SET-CURSOR-SW
 22879        GO TO 7499-EXIT.
 22880
 22881
 22882**2662**
 22883
 22884     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 22885        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 425
* EL6311.cbl
 22886        MOVE -1                  TO BAGEL
 22887        MOVE  1                  TO SET-CURSOR-SW
 22888        GO TO 7499-EXIT.
 22889
 22890**2663**
 22891
 22892     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 22893        MOVE AL-UNBON            TO BAGEA
 22894        MOVE -1                  TO BAGEL
 22895        MOVE  1                  TO SET-CURSOR-SW
 22896        GO TO 7499-EXIT.
 22897
 22898**2664**
 22899
 22900     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 22901        MOVE AL-UABON            TO BREINA
 22902        MOVE -1                  TO BREINL
 22903        MOVE  1                  TO SET-CURSOR-SW
 22904        GO TO 7499-EXIT.
 22905
 22906**2667**
 22907
 22908     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 22909        MOVE AL-UNBON            TO BBEN2A
 22910        MOVE -1                  TO BBEN2L
 22911        MOVE  1                  TO SET-CURSOR-SW
 22912        GO TO 7499-EXIT.
 22913
 22914**2668**
 22915
 22916     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 22917        MOVE AL-UABON            TO BEFFDTA
 22918        GO TO 7499-EXIT.
 22919
 22920**2669**
 22921
 22922     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 22923       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 22924       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 22925        MOVE AL-UNBON            TO BAGEA
 22926        MOVE -1                  TO BAGEL
 22927        MOVE  1                  TO SET-CURSOR-SW
 22928        GO TO 7499-EXIT.
 22929
 22930**2670**
 22931
 22932     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 22933        MOVE AL-UABON            TO BFORCEA
 22934        MOVE -1                  TO BFORCEL
 22935        MOVE  1                  TO SET-CURSOR-SW
 22936        GO TO 7499-EXIT.
 22937
 22938**2671**
 22939
 22940     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 22941        MOVE AL-UABON            TO BEFFDTA
 22942        GO TO 7499-EXIT.
 22943
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 426
* EL6311.cbl
 22944**2672**
 22945
 22946     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 22947        MOVE AL-UABON            TO BEFFDTA
 22948        GO TO 7499-EXIT.
 22949
 22950**2673**
 22951
 22952     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22953        MOVE AL-UABON            TO BEFFDTA
 22954        GO TO 7499-EXIT.
 22955
 22956**2674**
 22957
 22958     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22959        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 22960        MOVE -1                  TO BTYPE1L
 22961        MOVE  1                  TO SET-CURSOR-SW
 22962        GO TO 7499-EXIT.
 22963
 22964**2677**
 22965
 22966     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 22967        MOVE AL-UNBON            TO BTERM1A
 22968        MOVE -1                  TO BTERM1L
 22969        MOVE  1                  TO SET-CURSOR-SW
 22970        GO TO 7499-EXIT.
 22971
 22972**2678**
 22973
 22974     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 22975        MOVE AL-UNBON            TO BTERM2A
 22976        MOVE -1                  TO BTERM2L
 22977        MOVE  1                  TO SET-CURSOR-SW
 22978        GO TO 7499-EXIT.
 22979
 22980**2679**
 22981
 22982     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 22983        MOVE AL-UABON            TO BTYPE1A
 22984        MOVE -1                  TO BTYPE1L
 22985        MOVE  1                  TO SET-CURSOR-SW
 22986        GO TO 7499-EXIT.
 22987
 22988**2680**
 22989
 22990     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 22991        MOVE AL-UABOF            TO B1STPMTA
 22992        MOVE -1                  TO B1STPMTL
 22993        MOVE  1                  TO SET-CURSOR-SW
 22994        GO TO 7499-EXIT.
 22995
 22996**2681**
 22997
 22998     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 22999        MOVE AL-UABON            TO BDAYSA
 23000        MOVE -1                  TO BDAYSL
 23001        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 427
* EL6311.cbl
 23002        GO TO 7499-EXIT.
 23003
 23004**2682**
 23005
 23006     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23007        MOVE AL-UABON            TO BTERM1A
 23008        MOVE -1                  TO BTERM1L
 23009        MOVE  1                  TO SET-CURSOR-SW
 23010        GO TO 7499-EXIT.
 23011
 23012**2683**
 23013
 23014     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23015        MOVE AL-UABON            TO BSKPCDA
 23016        MOVE -1                  TO BSKPCDL
 23017        MOVE  1                  TO SET-CURSOR-SW
 23018        GO TO 7499-EXIT.
 23019
 23020**2684**
 23021
 23022     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23023        MOVE AL-UABON            TO BTYPE2A
 23024        MOVE -1                  TO BTYPE2L
 23025        MOVE  1                  TO SET-CURSOR-SW
 23026        GO TO 7499-EXIT.
 23027
 23028**2686**
 23029
 23030     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23031        MOVE AL-UABON            TO BTYPE2A
 23032        MOVE -1                  TO BTYPE2L
 23033        MOVE  1                  TO SET-CURSOR-SW
 23034        GO TO 7499-EXIT.
 23035
 23036**2689**
 23037
 23038     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23039        MOVE AL-UABON            TO BSIGA
 23040        MOVE -1                  TO BSIGL
 23041        MOVE  1                  TO SET-CURSOR-SW
 23042        GO TO 7499-EXIT.
 23043
 23044**2690**
 23045
 23046     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23047        MOVE AL-UABOF            TO BLNOFCRA
 23048        MOVE -1                  TO BLNOFCRL
 23049        MOVE  1                  TO SET-CURSOR-SW
 23050        GO TO 7499-EXIT.
 23051
 23052**2693**
 23053
 23054     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23055        MOVE AL-UABOF            TO BLNOFCRA
 23056        MOVE AL-UNBON            TO BBEN1A
 23057        MOVE -1                  TO BBEN1L
 23058        MOVE  1                  TO SET-CURSOR-SW
 23059        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 428
* EL6311.cbl
 23060
 23061**2720**
 23062
 23063     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23064        MOVE AL-UNBON            TO BBEN1A
 23065        MOVE -1                  TO BBEN1L
 23066        MOVE  1                  TO SET-CURSOR-SW
 23067        GO TO 7499-EXIT.
 23068
 23069**2709**
 23070
 23071*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23072*       MOVE AL-UNBON            TO BBEN1A
 23073*       MOVE -1                  TO BBEN1L
 23074*       MOVE  1                  TO SET-CURSOR-SW
 23075*       GO TO 7499-EXIT.
 23076
 23077*************************************************************
 23078*                                                           *
 23079*            C A N C E L   E R R O R S                      *
 23080*                                                           *
 23081*************************************************************
 23082
 23083**2726**
 23084
 23085     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23086        MOVE AL-UABON            TO CCERTNOA
 23087        GO TO 7499-EXIT.
 23088
 23089**2728**
 23090
 23091     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23092        MOVE AL-UABON            TO CCERTNOA
 23093        GO TO 7499-EXIT.
 23094
 23095**2729**
 23096
 23097     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23098        MOVE AL-UABON            TO CCERTNOA
 23099        GO TO 7499-EXIT.
 23100
 23101**2730**
 23102
 23103     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23104        MOVE AL-UABON            TO CCERTNOA
 23105        GO TO 7499-EXIT.
 23106
 23107**2731**
 23108
 23109     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23110        MOVE AL-UABON            TO CCANDT1A
 23111        MOVE -1                  TO CCANDT1L
 23112        MOVE  1                  TO SET-CURSOR-SW
 23113        GO TO 7499-EXIT.
 23114
 23115**2732**
 23116
 23117     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 429
* EL6311.cbl
 23118        MOVE AL-UABON            TO CCANDT1A
 23119        MOVE -1                  TO CCANDT1L
 23120        MOVE  1                  TO SET-CURSOR-SW
 23121        GO TO 7499-EXIT.
 23122
 23123**2733**
 23124
 23125     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23126        MOVE AL-UABON            TO CCANDT1A
 23127        MOVE -1                  TO CCANDT1L
 23128        MOVE  1                  TO SET-CURSOR-SW
 23129        GO TO 7499-EXIT.
 23130
 23131**2734**
 23132
 23133     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23134        MOVE AL-UNBON            TO CREFND1A
 23135        MOVE -1                  TO CREFND1L
 23136        MOVE  1                  TO SET-CURSOR-SW
 23137        GO TO 7499-EXIT.
 23138
 23139**2735**
 23140
 23141     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23142        MOVE AL-UABON            TO CCANDT2A
 23143        MOVE -1                  TO CCANDT2L
 23144        MOVE  1                  TO SET-CURSOR-SW
 23145        GO TO 7499-EXIT.
 23146
 23147**2736**
 23148
 23149     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23150        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23151            MOVE AL-UNBON        TO CREFND1A
 23152            MOVE -1              TO CREFND1L
 23153            MOVE  1              TO SET-CURSOR-SW
 23154            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23155                MOVE AL-UNBON        TO CREFND2A
 23156                MOVE -1              TO CREFND2L
 23157                MOVE  1              TO SET-CURSOR-SW
 23158                GO TO 7499-EXIT
 23159            ELSE
 23160                GO TO 7499-EXIT
 23161        ELSE
 23162            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23163                MOVE AL-UNBON        TO CREFND2A
 23164                MOVE -1              TO CREFND2L
 23165                MOVE  1              TO SET-CURSOR-SW
 23166                GO TO 7499-EXIT
 23167            ELSE
 23168                GO TO 7499-EXIT.
 23169
 23170**2738**
 23171
 23172     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23173        MOVE -1                  TO CREFND2L
 23174        MOVE  1                  TO SET-CURSOR-SW
 23175        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 430
* EL6311.cbl
 23176
 23177**2739**
 23178
 23179     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23180        MOVE -1                  TO CREFND1L
 23181        MOVE  1                  TO SET-CURSOR-SW
 23182        GO TO 7499-EXIT.
 23183
 23184**2741**
 23185
 23186     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23187        MOVE -1                  TO CREFND1L
 23188        MOVE  1                  TO SET-CURSOR-SW
 23189        GO TO 7499-EXIT.
 23190
 23191**2743**
 23192
 23193     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23194        MOVE AL-UNBON            TO CCANDT1A
 23195        MOVE -1                  TO CCANDT1L
 23196        MOVE  1                  TO SET-CURSOR-SW
 23197        GO TO 7499-EXIT.
 23198
 23199**2744**
 23200
 23201     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23202        MOVE AL-UNBON            TO CCANDT2A
 23203        MOVE -1                  TO CCANDT2L
 23204        MOVE  1                  TO SET-CURSOR-SW
 23205        GO TO 7499-EXIT.
 23206
 23207**2747**
 23208
 23209     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23210        MOVE AL-UABON            TO CLSTNMA
 23211        MOVE -1                  TO CLSTNML
 23212        MOVE  1                  TO SET-CURSOR-SW
 23213        GO TO 7499-EXIT.
 23214
 23215**2749**
 23216
 23217     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23218        MOVE AL-UABON            TO CFORCEA
 23219        MOVE -1                  TO CFORCEL
 23220        MOVE  1                  TO SET-CURSOR-SW
 23221        GO TO 7499-EXIT.
 23222
 23223**2753**
 23224
 23225     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23226        MOVE AL-UNBON            TO CCANDT1A
 23227        MOVE -1                  TO CCANDT1L
 23228        MOVE  1                  TO SET-CURSOR-SW
 23229        GO TO 7499-EXIT.
 23230
 23231**2755**
 23232
 23233     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 431
* EL6311.cbl
 23234        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23235            MOVE AL-UNBON        TO CREFND1A
 23236            MOVE -1              TO CREFND1L
 23237            MOVE  1              TO SET-CURSOR-SW
 23238            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23239                MOVE AL-UNBON        TO CREFND2A
 23240                MOVE -1              TO CREFND2L
 23241                MOVE  1              TO SET-CURSOR-SW
 23242                GO TO 7499-EXIT
 23243            ELSE
 23244                GO TO 7499-EXIT
 23245        ELSE
 23246            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23247                MOVE AL-UNBON        TO CREFND2A
 23248                MOVE -1              TO CREFND2L
 23249                MOVE  1              TO SET-CURSOR-SW
 23250            ELSE
 23251                GO TO 7499-EXIT.
 23252
 23253**2757**
 23254
 23255     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23256        MOVE AL-UNBON            TO CLIVESA
 23257        MOVE -1                  TO CLIVESL
 23258        MOVE  1                  TO SET-CURSOR-SW
 23259        GO TO 7499-EXIT.
 23260
 23261**2771**
 23262
 23263     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23264        MOVE AL-UABON            TO CCANDT2A
 23265        MOVE -1                  TO CCANDT2L
 23266        MOVE  1                  TO SET-CURSOR-SW
 23267        GO TO 7499-EXIT.
 23268
 23269**2774**
 23270
 23271     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23272        MOVE AL-UABON            TO CCANDT1A
 23273        MOVE -1                  TO CCANDT1L
 23274        MOVE  1                  TO SET-CURSOR-SW
 23275        GO TO 7499-EXIT.
 23276
 23277**2775**
 23278
 23279     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23280        MOVE AL-UABON            TO CCANDT2A
 23281        MOVE -1                  TO CCANDT2L
 23282        MOVE  1                  TO SET-CURSOR-SW
 23283        GO TO 7499-EXIT.
 23284
 23285**2776**
 23286
 23287     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23288        MOVE AL-UABON            TO CCANDT1A
 23289        MOVE -1                  TO CCANDT1L
 23290        MOVE  1                  TO SET-CURSOR-SW
 23291        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 432
* EL6311.cbl
 23292
 23293
 23294**2777**
 23295
 23296     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23297        MOVE AL-UABON            TO CCANDT2A
 23298        MOVE -1                  TO CCANDT2L
 23299        MOVE  1                  TO SET-CURSOR-SW
 23300        GO TO 7499-EXIT.
 23301
 23302**2794**
 23303
 23304     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23305        MOVE AL-UABON            TO CFORCEA
 23306        MOVE -1                  TO CFORCEL
 23307        MOVE  1                  TO SET-CURSOR-SW
 23308        GO TO 7499-EXIT.
 23309
 23310**2799**
 23311
 23312     IF PI-COMPANY-ID = 'UCL'
 23313         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23314             MOVE AL-UNBON            TO BEFFDTA
 23315             MOVE -1                  TO BEFFDTL
 23316             MOVE  1                  TO SET-CURSOR-SW
 23317             GO TO 7499-EXIT.
 23318
 23319 7499-EXIT.
 23320      EXIT.
 23321
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 433
* EL6311.cbl
 23323
 23324 7500-READ-ERLOFC.
 23325     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23326                                     ERLOFC-KEY.
 23327
 23328     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23329
 23330     IF ST-ACCNT-CNTL
 23331         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23332
 23333     IF CARR-GROUP-ST-ACCNT-CNTL
 23334         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23335         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23336         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23337
 23338     IF CARR-ST-ACCNT-CNTL
 23339         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23340         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23341
 23342     IF CARR-ACCNT-CNTL
 23343         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23344
 23345     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23346
 23347     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23348
 23349
 23350* EXEC CICS HANDLE CONDITION
 23351*        NOTFND   (7550-OFFICER-NOTFND)
 23352*    END-EXEC.
 23353*    MOVE '"$I                   ! [ #00019635' TO DFHEIV0
 23354     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23355     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23356     MOVE X'5B20233030303139363335' TO DFHEIV0(25:11)
 23357     CALL 'kxdfhei1' USING DFHEIV0
 23358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23359
 23360
 23361
 23362* EXEC CICS READ
 23363*        DATASET   (FILE-ID-ERLOFC)
 23364*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23365*        RIDFLD    (ERLOFC-KEY)
 23366*        EQUAL
 23367*    END-EXEC.
 23368*    MOVE '&"S        E          (   #00019639' TO DFHEIV0
 23369     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23370     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23371     MOVE X'2020233030303139363339' TO DFHEIV0(25:11)
 23372     CALL 'kxdfhei1' USING DFHEIV0,
 23373           FILE-ID-ERLOFC,
 23374           DFHEIV20,
 23375           DFHEIV99,
 23376           ERLOFC-KEY,
 23377           DFHEIV99,
 23378           DFHEIV99,
 23379           DFHEIV99
 23380     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 434
* EL6311.cbl
 23381         DFHEIV20
 23382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23383
 23384
 23385     GO TO 7599-EXIT.
 23386
 23387 7550-OFFICER-NOTFND.
 23388     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23389
 23390 7599-EXIT.
 23391      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 435
* EL6311.cbl
 23393******************************************************************
 23394*                                                                *
 23395*            S  E N D    I N I T I A L   M A P                   *
 23396*                                                                *
 23397******************************************************************
 23398
 23399 8100-SEND-INITIAL-MAP.
 23400     MOVE EIBTIME                TO TIME-IN.
 23401
 23402     IF EIBAID = DFHPF11
 23403        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23404        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23405
 23406
 23407     IF PI-COMPANY-ID = CLIENT-GIC
 23408        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23409                                       BCPREM-ATTRB (2).
 23410
 23411     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23412                         CLIENT-PEM OR
 23413                         CLIENT-CSO)
 23414        AND PI-DISPLAY-ORIGINAL-BATCH
 23415          IF PI-MAP-NAME = EL631B
 23416             MOVE AL-SADOF               TO BPF5HDRA
 23417                                            BPF4HDRA
 23418          ELSE
 23419             IF PI-MAP-NAME = EL631C
 23420                MOVE AL-SADOF            TO CPF5HDRA
 23421                                            CPF4HDRA.
 23422
 23423     IF PI-MAP-NAME = EL631B
 23424        MOVE AL-SADOF               TO BPF5HDRA
 23425     ELSE
 23426        MOVE AL-SADOF               TO CPF5HDRA
 23427     END-IF
 23428
 23429*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23430     IF PI-MAP-NAME = EL631B
 23431          IF PI-COMPANY-ID NOT = 'DMD'
 23432             MOVE AL-SANOF            TO BBILLEDA
 23433             MOVE AL-SADOF            TO DMDBILA.
 23434*DMD CUSTOM CODING*************END
 23435
 23436     IF PI-PROCESSOR-ID = 'LGXX'
 23437        IF PI-MAP-NAME = EL631B
 23438           MOVE AL-SABOF                    TO BREFHDGA
 23439           MOVE AL-SANOF                    TO BREFA
 23440        ELSE
 23441           IF PI-MAP-NAME = EL631C
 23442              MOVE AL-SABOF                 TO CREFHDGA
 23443              MOVE AL-SANOF                 TO CREFA.
 23444
 23445*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 23446     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 23447        NEXT SENTENCE
 23448     ELSE
 23449        IF PI-MAP-NAME = EL631C
 23450           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 436
* EL6311.cbl
 23451                                       CCANFEEA.
 23452
 23453     IF PI-MAP-NAME = EL631D
 23454        IF PI-AR-PROCESSING
 23455           MOVE AL-SANOF            TO DREFHDGA
 23456        ELSE
 23457           MOVE AL-SADOF            TO DREFHDGA.
 23458
 23459     IF (PI-COMPANY-ID NOT = 'DCC')
 23460        AND (PI-MAP-NAME = EL631B)
 23461        MOVE AL-SADOF            TO BVINHA
 23462                                    BVINA
 23463     END-IF
 23464     IF PI-MAP-NAME = EL631B
 23465        IF CSR-EDIT-SESSION
 23466           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23467                                 TO BHEADO
 23468           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 23469        ELSE
 23470           MOVE AL-SADOF         TO BF15HDRA
 23471           MOVE '4=B-HDR      '  TO BPF4HDRO
 23472        END-IF
 23473        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23474        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 23475        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 23476        MOVE WS-CURRENT-DT          TO BDATEO
 23477        MOVE TIME-OUT               TO BTIMEO
 23478        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23479        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23480        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23481        IF   WS-DISPLAY-SCREEN
 23482             MOVE PB-ENTRY-BATCH    TO BBATCHO
 23483             MOVE PB-SV-CARRIER     TO BCARRO
 23484             MOVE PB-SV-GROUPING    TO BGROUPO
 23485             MOVE PB-SV-STATE       TO BSTATEO
 23486             MOVE PB-ACCOUNT        TO BACCTO
 23487        ELSE
 23488             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 23489     ELSE
 23490        IF PI-MAP-NAME = EL631C
 23491           MOVE '4=B-HDR      '     TO CPF4HDRO
 23492           IF CSR-EDIT-SESSION
 23493              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23494                                 TO CHEADO
 23495           ELSE
 23496              MOVE AL-SADOF      TO CF15HDRA
 23497           END-IF
 23498           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 23499           MOVE WS-CURRENT-DT          TO CDATEO
 23500           MOVE TIME-OUT               TO CTIMEO
 23501           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 23502           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 23503           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 23504           MOVE WS-C-HDG               TO CLFHDGO
 23505           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 23506           MOVE WS-C-HDG               TO CAHHDGO
 23507           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23508           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 437
* EL6311.cbl
 23509           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23510           IF   WS-DISPLAY-SCREEN
 23511                MOVE PB-ENTRY-BATCH    TO CBATCHO
 23512                MOVE PB-SV-CARRIER     TO CCARRO
 23513                MOVE PB-SV-GROUPING    TO CGROUPO
 23514                MOVE PB-SV-STATE       TO CSTATEO
 23515                MOVE PB-ACCOUNT        TO CACCTO
 23516           ELSE
 23517                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 23518        ELSE
 23519           MOVE WS-CURRENT-DT          TO DDATEO
 23520           MOVE TIME-OUT               TO DTIMEO
 23521           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 23522                                          WS-REFUND-HDG-OVERRIDE
 23523           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 23524           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 23525           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 23526                                          WS-REFUND-HDG-OVERRIDE
 23527           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 23528           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 23529           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 23530           IF CSR-EDIT-SESSION
 23531              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23532                                 TO DHEADO
 23533           END-IF
 23534           IF  WS-DISPLAY-SCREEN
 23535               MOVE PB-ENTRY-BATCH     TO DBATCHO
 23536               MOVE PB-CARRIER         TO DCARRO
 23537               MOVE PB-GROUPING        TO DGROUPO
 23538               MOVE PB-STATE           TO DSTATEO
 23539               MOVE PB-ACCOUNT         TO DACCTO
 23540               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 23541           ELSE
 23542               MOVE EL631D             TO PI-MAP-NAME
 23543               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 23544               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 23545
 23546     MOVE SPACE                        TO WS-DISPLAY-SW.
 23547
 23548
 23549* EXEC CICS SEND
 23550*        MAP      (PI-MAP-NAME)
 23551*        MAPSET   (MAPSET-EL6311S)
 23552*        FROM     (EL631BI)
 23553*        ERASE
 23554*        CURSOR
 23555*    END-EXEC.
 23556     MOVE LENGTH OF
 23557      EL631BI
 23558       TO DFHEIV12
 23559     MOVE -1
 23560       TO DFHEIV11
 23561*    MOVE '8$     CT  E    H L F ,   #00019809' TO DFHEIV0
 23562     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 23563     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23564     MOVE X'2020233030303139383039' TO DFHEIV0(25:11)
 23565     CALL 'kxdfhei1' USING DFHEIV0,
 23566           PI-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 438
* EL6311.cbl
 23567           EL631BI,
 23568           DFHEIV12,
 23569           MAPSET-EL6311S,
 23570           DFHEIV99,
 23571           DFHEIV99,
 23572           DFHEIV99,
 23573           DFHEIV11,
 23574           DFHEIV99,
 23575           DFHEIV99,
 23576           DFHEIV99
 23577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23578
 23579
 23580     GO TO 9100-RETURN-TRAN.
 23581
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 439
* EL6311.cbl
 23583
 23584******************************************************************
 23585*                                                                *
 23586*              S E N D    D A T A O N L Y                        *
 23587*                                                                *
 23588******************************************************************
 23589
 23590 8200-SEND-DATAONLY.
 23591     MOVE EIBTIME                TO TIME-IN.
 23592
 23593     IF PI-COMPANY-ID = CLIENT-GIC
 23594        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23595                                       BCPREM-ATTRB (2).
 23596
 23597     IF PI-MAP-NAME = EL631B
 23598        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23599        MOVE WS-CURRENT-DT          TO BDATEO
 23600        MOVE TIME-OUT               TO BTIMEO
 23601        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23602        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23603        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23604        MOVE SPACES                 TO BPFENTRO
 23605        MOVE AL-UANOF               TO BPFENTRA
 23606
 23607*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23608        IF PI-COMPANY-ID NOT = 'DMD'
 23609             MOVE AL-SANOF            TO BBILLEDA
 23610             MOVE AL-SADOF            TO DMDBILA
 23611         ELSE
 23612            NEXT SENTENCE
 23613*DMD CUSTOM CODING*************END
 23614     ELSE
 23615        IF PI-MAP-NAME = EL631C
 23616           MOVE WS-CURRENT-DT          TO CDATEO
 23617           MOVE TIME-OUT               TO CTIMEO
 23618           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23619           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 23620           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23621           MOVE SPACES                 TO CPFENTRO
 23622           MOVE AL-UANOF               TO CPFENTRA
 23623        ELSE
 23624           MOVE WS-CURRENT-DT          TO DDATEO
 23625           MOVE TIME-OUT               TO DTIMEO
 23626           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 23627
 23628
 23629* EXEC CICS SEND
 23630*        MAP      (PI-MAP-NAME)
 23631*        MAPSET   (MAPSET-EL6311S)
 23632*        FROM     (EL631BI)
 23633*        DATAONLY
 23634*        CURSOR
 23635*    END-EXEC.
 23636     MOVE LENGTH OF
 23637      EL631BI
 23638       TO DFHEIV12
 23639     MOVE -1
 23640       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 440
* EL6311.cbl
 23641*    MOVE '8$D    CT       H L F ,   #00019865' TO DFHEIV0
 23642     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 23643     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23644     MOVE X'2020233030303139383635' TO DFHEIV0(25:11)
 23645     CALL 'kxdfhei1' USING DFHEIV0,
 23646           PI-MAP-NAME,
 23647           EL631BI,
 23648           DFHEIV12,
 23649           MAPSET-EL6311S,
 23650           DFHEIV99,
 23651           DFHEIV99,
 23652           DFHEIV99,
 23653           DFHEIV11,
 23654           DFHEIV99,
 23655           DFHEIV99,
 23656           DFHEIV99
 23657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23658
 23659
 23660     GO TO 9100-RETURN-TRAN.
 23661
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 441
* EL6311.cbl
 23663
 23664******************************************************************
 23665*                                                                *
 23666*           U T I L I T Y   R O U T I N E S                      *
 23667*                                                                *
 23668******************************************************************
 23669
 23670 8300-SEND-TEXT.
 23671
 23672* EXEC CICS SEND TEXT
 23673*        FROM     (LOGOFF-TEXT)
 23674*        LENGTH   (LOGOFF-LENGTH)
 23675*        ERASE
 23676*        FREEKB
 23677*    END-EXEC.
 23678*    MOVE '8&      T  E F  H   F -   #00019884' TO DFHEIV0
 23679     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 23680     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 23681     MOVE X'2020233030303139383834' TO DFHEIV0(25:11)
 23682     CALL 'kxdfhei1' USING DFHEIV0,
 23683           LOGOFF-TEXT,
 23684           LOGOFF-LENGTH,
 23685           DFHEIV99,
 23686           DFHEIV99,
 23687           DFHEIV99,
 23688           DFHEIV99,
 23689           DFHEIV99,
 23690           DFHEIV99,
 23691           DFHEIV99,
 23692           DFHEIV99,
 23693           DFHEIV99,
 23694           DFHEIV99
 23695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23696
 23697
 23698
 23699* EXEC CICS RETURN
 23700*    END-EXEC.
 23701*    MOVE '.(                    ''   #00019891' TO DFHEIV0
 23702     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23703     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23704     MOVE X'2020233030303139383931' TO DFHEIV0(25:11)
 23705     CALL 'kxdfhei1' USING DFHEIV0,
 23706           DFHEIV99,
 23707           DFHEIV99,
 23708           DFHEIV99,
 23709           DFHEIV99,
 23710           DFHEIV99,
 23711           DFHEIV99
 23712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23713
 23714
 23715 8400-LOG-JOURNAL-RECORD.
 23716     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 23717     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 23718
 23719*    EXEC CICS JOURNAL
 23720*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 442
* EL6311.cbl
 23721*        JTYPEID     ('EL')
 23722*        FROM        (JOURNAL-RECORD)
 23723*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 23724*    END-EXEC.
 23725
 23726 8600-DEEDIT.
 23727
 23728* EXEC CICS BIF DEEDIT
 23729*         FIELD   (DEEDIT-FIELD)
 23730*         LENGTH  (15)
 23731*    END-EXEC.
 23732     MOVE 15
 23733       TO DFHEIV11
 23734*    MOVE '@"L                   #   #00019906' TO DFHEIV0
 23735     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 23736     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23737     MOVE X'2020233030303139393036' TO DFHEIV0(25:11)
 23738     CALL 'kxdfhei1' USING DFHEIV0,
 23739           DEEDIT-FIELD,
 23740           DFHEIV11
 23741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23742
 23743
 23744 8800-UNAUTHORIZED-ACCESS.
 23745     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 23746     GO TO 8300-SEND-TEXT.
 23747
 23748 8810-PF23.
 23749     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 23750     MOVE XCTL-EL005             TO PGM-NAME.
 23751     GO TO 9300-XCTL.
 23752
 23753 9100-RETURN-TRAN.
 23754     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 23755
 23756     IF  PI-MAP-NAME =  EL631B
 23757         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 23758
 23759     IF  PI-MAP-NAME =  EL631C
 23760         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 23761
 23762     IF  PI-MAP-NAME =  EL631D
 23763         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 23764
 23765
 23766* EXEC CICS RETURN
 23767*        TRANSID    (TRANS-EXB1)
 23768*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23769*        LENGTH     (1300)
 23770*    END-EXEC.
 23771     MOVE 1300
 23772       TO DFHEIV11
 23773*    MOVE '.(CT                  ''   #00019932' TO DFHEIV0
 23774     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 23775     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23776     MOVE X'2020233030303139393332' TO DFHEIV0(25:11)
 23777     CALL 'kxdfhei1' USING DFHEIV0,
 23778           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 443
* EL6311.cbl
 23779           PROGRAM-INTERFACE-BLOCK,
 23780           DFHEIV11,
 23781           DFHEIV99,
 23782           DFHEIV99,
 23783           DFHEIV99
 23784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23785
 23786
 23787 9200-RETURN-MAIN-MENU.
 23788     MOVE XCTL-EL626             TO PGM-NAME.
 23789     GO TO 9300-XCTL.
 23790
 23791 9300-XCTL.
 23792
 23793* EXEC CICS XCTL
 23794*        PROGRAM    (PGM-NAME)
 23795*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23796*        LENGTH     (PI-COMM-LENGTH)
 23797*    END-EXEC.
 23798*    MOVE '.$C                   %   #00019943' TO DFHEIV0
 23799     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 23800     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23801     MOVE X'2020233030303139393433' TO DFHEIV0(25:11)
 23802     CALL 'kxdfhei1' USING DFHEIV0,
 23803           PGM-NAME,
 23804           PROGRAM-INTERFACE-BLOCK,
 23805           PI-COMM-LENGTH,
 23806           DFHEIV99
 23807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23808
 23809
 23810 9400-CLEAR.
 23811     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 23812     GO TO 9300-XCTL.
 23813
 23814 9500-PF12.
 23815     MOVE XCTL-EL010             TO PGM-NAME.
 23816     GO TO 9300-XCTL.
 23817
 23818 9600-PGMID-ERROR.
 23819
 23820* EXEC CICS HANDLE CONDITION
 23821*        PGMIDERR    (8300-SEND-TEXT)
 23822*    END-EXEC.
 23823*    MOVE '"$L                   ! \ #00019958' TO DFHEIV0
 23824     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 23825     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23826     MOVE X'5C20233030303139393538' TO DFHEIV0(25:11)
 23827     CALL 'kxdfhei1' USING DFHEIV0
 23828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23829
 23830
 23831     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 23832     MOVE ' '                    TO PI-ENTRY-CD-1.
 23833     MOVE XCTL-EL005             TO PGM-NAME.
 23834     MOVE PGM-NAME               TO LOGOFF-PGM.
 23835     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 23836     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 444
* EL6311.cbl
 23837
 23838 9700-DATE-LINK.
 23839     MOVE LINK-ELDATCV           TO PGM-NAME.
 23840
 23841* EXEC CICS LINK
 23842*        PROGRAM    (PGM-NAME)
 23843*        COMMAREA   (DATE-CONVERSION-DATA)
 23844*        LENGTH     (DC-COMM-LENGTH)
 23845*    END-EXEC.
 23846*    MOVE '."C                   (   #00019971' TO DFHEIV0
 23847     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23848     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23849     MOVE X'2020233030303139393731' TO DFHEIV0(25:11)
 23850     CALL 'kxdfhei1' USING DFHEIV0,
 23851           PGM-NAME,
 23852           DATE-CONVERSION-DATA,
 23853           DC-COMM-LENGTH,
 23854           DFHEIV99,
 23855           DFHEIV99,
 23856           DFHEIV99,
 23857           DFHEIV99
 23858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23859
 23860
 23861 9800-LINK-PENDING-EDIT.
 23862     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 23863     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 23864
 23865     MOVE LINK-EL050             TO PGM-NAME
 23866     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 23867     MOVE ZEROS                  TO WK-CO-MAX-CAP
 23868                                    WK-CO-TOL-CLAIM
 23869                                    WK-CO-TOL-PREM
 23870                                    WK-CO-TOL-REFUND
 23871                                    WK-CO-TOL-PREM-PCT
 23872                                    WK-CO-TOL-REFUND-PCT
 23873                                    WK-REFUND-OVS-AMT
 23874                                    WK-REFUND-OVS-PCT
 23875                                    WK-ACCT-ADDR
 23876                                    WK-LIFE-EDIT-ADDR
 23877                                    WK-AH-EDIT-ADDR
 23878                                    WK-LIFE-BEN-ADDR
 23879                                    WK-AH-BEN-ADDR
 23880                                    WK-STATE-ADDR
 23881                                    WK-PLAN-ADDR
 23882                                    WK-FORM-ADDR
 23883     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 23884
 23885     MOVE '6'                    TO WK-ENTRY-SW.
 23886
 23887     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 23888
 23889     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 23890                                    EC-AM-EXPIRATION-DT
 23891                                    EC-AM-EFFECTIVE-DT
 23892                                    EC-CM-LF-CANCEL-DT
 23893                                    EC-CM-AH-CANCEL-DT
 23894                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 445
* EL6311.cbl
 23895
 23896     MOVE ZEROS                  TO EC-CO-TOL-PREM
 23897                                    EC-CO-TOL-REFUND
 23898                                    EC-CO-MIN-AGE
 23899                                    EC-CO-MIN-PREMIUM
 23900                                    EC-CO-MIN-TERM
 23901                                    EC-CO-MAX-TERM
 23902                                    EC-ST-TOL-PREM
 23903                                    EC-ST-TOL-REFUND
 23904                                    EC-AM-LF-TOL-PREM
 23905                                    EC-AM-AH-TOL-PREM
 23906                                    EC-AM-LF-MAX-ATT-AGE
 23907                                    EC-AM-LF-MAX-AGE
 23908                                    EC-AM-LF-MAX-TERM
 23909                                    EC-AM-LF-MAX-TOT-BEN
 23910                                    EC-AM-AH-MAX-ATT-AGE
 23911                                    EC-AM-AH-MAX-AGE
 23912                                    EC-AM-AH-MAX-TERM
 23913                                    EC-AM-AH-MAX-TOT-BEN
 23914                                    EC-AM-AH-MAX-MON-BEN
 23915                                    EC-RT-LF-MAX-ATT-AGE
 23916                                    EC-RT-LF-MAX-AGE
 23917                                    EC-RT-LF-MAX-TERM
 23918                                    EC-RT-LF-MAX-TOT-BEN
 23919                                    EC-RT-AH-MAX-ATT-AGE
 23920                                    EC-RT-AH-MAX-AGE
 23921                                    EC-RT-AH-MAX-TERM
 23922                                    EC-RT-AH-MAX-TOT-BEN
 23923                                    EC-RT-AH-MAX-MON-BEN
 23924                                    EC-RT-AH-RATE
 23925                                    EC-RT-LF-RATE
 23926                                    EC-RT-LF-NSP-RATE
 23927                                    EC-RT-AH-NSP-RATE
 23928                                    EC-CM-LF-PRIOR-REFUND
 23929                                    EC-CM-AH-PRIOR-REFUND.
 23930
 23931     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 23932                                    EC-ST-TOL-PREM-PCT
 23933                                    EC-AM-LF-TOL-REFUND
 23934                                    EC-AM-LF-DEV-PERCENT
 23935                                    EC-CO-TOL-REFUND-PCT
 23936                                    EC-ST-TOL-REFUND-PCT
 23937                                    EC-AM-AH-TOL-REFUND
 23938                                    EC-AM-AH-DEV-PERCENT.
 23939
 23940
 23941* EXEC CICS LINK
 23942*         PROGRAM   (PGM-NAME)
 23943*         COMMAREA  (PASSED-RECORD)
 23944*         LENGTH    (WS-EDIT-PASS-LENGTH)
 23945*    END-EXEC.
 23946*    MOVE '."C                   (   #00020056' TO DFHEIV0
 23947     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23948     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23949     MOVE X'2020233030303230303536' TO DFHEIV0(25:11)
 23950     CALL 'kxdfhei1' USING DFHEIV0,
 23951           PGM-NAME,
 23952           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 446
* EL6311.cbl
 23953           WS-EDIT-PASS-LENGTH,
 23954           DFHEIV99,
 23955           DFHEIV99,
 23956           DFHEIV99,
 23957           DFHEIV99
 23958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23959
 23960
 23961     MOVE '1'                    TO PI-EDIT-SW.
 23962     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 23963
 23964     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 23965
 23966     IF PI-COMPANY-ID = 'UCL'
 23967         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 23968
 23969     IF VALID-PB-ID
 23970        GO TO 9800-EXIT.
 23971
 23972     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 23973
 23974     IF PI-MAP-NAME = EL631B
 23975        MOVE -1                  TO BMAINTL
 23976       ELSE
 23977        MOVE -1                  TO CMAINTL.
 23978
 23979     GO TO 8200-SEND-DATAONLY.
 23980
 23981 9800-EXIT.
 23982      EXIT.
 23983
 23984 9900-ERROR-FORMAT.
 23985
 23986     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 23987
 23988     IF NOT EMI-ERRORS-COMPLETE
 23989         MOVE LINK-EL001         TO PGM-NAME
 23990
 23991* EXEC CICS LINK
 23992*            PROGRAM    (PGM-NAME)
 23993*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 23994*            LENGTH     (EMI-COMM-LENGTH)
 23995*        END-EXEC.
 23996*    MOVE '."C                   (   #00020091' TO DFHEIV0
 23997     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23998     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23999     MOVE X'2020233030303230303931' TO DFHEIV0(25:11)
 24000     CALL 'kxdfhei1' USING DFHEIV0,
 24001           PGM-NAME,
 24002           ERROR-MESSAGE-INTERFACE-BLOCK,
 24003           EMI-COMM-LENGTH,
 24004           DFHEIV99,
 24005           DFHEIV99,
 24006           DFHEIV99,
 24007           DFHEIV99
 24008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24009
 24010
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 447
* EL6311.cbl
 24011 9900-EXIT.
 24012     EXIT.
 24013
 24014 9990-ABEND.
 24015     MOVE LINK-EL004             TO PGM-NAME.
 24016     MOVE DFHEIBLK               TO EMI-LINE1.
 24017
 24018* EXEC CICS LINK
 24019*        PROGRAM   (PGM-NAME)
 24020*        COMMAREA  (EMI-LINE1)
 24021*        LENGTH    (72)
 24022*    END-EXEC.
 24023     MOVE 72
 24024       TO DFHEIV11
 24025*    MOVE '."C                   (   #00020103' TO DFHEIV0
 24026     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24027     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24028     MOVE X'2020233030303230313033' TO DFHEIV0(25:11)
 24029     CALL 'kxdfhei1' USING DFHEIV0,
 24030           PGM-NAME,
 24031           EMI-LINE1,
 24032           DFHEIV11,
 24033           DFHEIV99,
 24034           DFHEIV99,
 24035           DFHEIV99,
 24036           DFHEIV99
 24037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24038
 24039
 24040     IF PI-MAP-NAME = EL631B
 24041        MOVE -1                  TO BMAINTL
 24042       ELSE
 24043        MOVE -1                  TO CMAINTL.
 24044
 24045     IF EIBTRNID NOT = TRANS-EXB1
 24046        GO TO 8100-SEND-INITIAL-MAP
 24047       ELSE
 24048        GO TO 8200-SEND-DATAONLY.
 24049
 24050 9995-SECURITY-VIOLATION.
 24051*                            COPY ELCSCTP.
 24052******************************************************************
 24053*                                                                *
 24054*                            ELCSCTP                             *
 24055*                            VMOD=2.001                          *
 24056*                                                                *
 24057*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24058******************************************************************
 24059
 24060
 24061     MOVE EIBDATE          TO SM-JUL-DATE.
 24062     MOVE EIBTRMID         TO SM-TERMID.
 24063     MOVE THIS-PGM         TO SM-PGM.
 24064     MOVE EIBTIME          TO TIME-IN.
 24065     MOVE TIME-OUT         TO SM-TIME.
 24066     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24067
 24068
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 448
* EL6311.cbl
 24069* EXEC CICS LINK
 24070*         PROGRAM  ('EL003')
 24071*         COMMAREA (SECURITY-MESSAGE)
 24072*         LENGTH   (80)
 24073*    END-EXEC.
 24074     MOVE 'EL003' TO DFHEIV1
 24075     MOVE 80
 24076       TO DFHEIV11
 24077*    MOVE '."C                   (   #00020137' TO DFHEIV0
 24078     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24079     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24080     MOVE X'2020233030303230313337' TO DFHEIV0(25:11)
 24081     CALL 'kxdfhei1' USING DFHEIV0,
 24082           DFHEIV1,
 24083           SECURITY-MESSAGE,
 24084           DFHEIV11,
 24085           DFHEIV99,
 24086           DFHEIV99,
 24087           DFHEIV99,
 24088           DFHEIV99
 24089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24090
 24091
 24092******************************************************************
 24093
 24094
 24095 9999-DFHBACK SECTION.
 24096     MOVE '9%                    "   ' TO DFHEIV0
 24097     MOVE 'EL6311' TO DFHEIV1
 24098     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24099     GOBACK.
 24100 9999-DFHEXIT.
 24101     IF DFHEIGDJ EQUAL 0001
 24102         NEXT SENTENCE
 24103     ELSE IF DFHEIGDJ EQUAL 2
 24104         GO TO 9600-PGMID-ERROR,
 24105               9990-ABEND,
 24106               9990-ABEND,
 24107               0010-MAIN-LOGIC
 24108         DEPENDING ON DFHEIGDI
 24109     ELSE IF DFHEIGDJ EQUAL 3
 24110         GO TO 1280-BATCH-HDR-NOT-FOUND
 24111         DEPENDING ON DFHEIGDI
 24112     ELSE IF DFHEIGDJ EQUAL 4
 24113         GO TO 1290-DUPLICATE-ALT-INDEX
 24114         DEPENDING ON DFHEIGDI
 24115     ELSE IF DFHEIGDJ EQUAL 5
 24116         GO TO 1295-CERT-TRL-REC-NOTFND
 24117         DEPENDING ON DFHEIGDI
 24118     ELSE IF DFHEIGDJ EQUAL 6
 24119         GO TO 1380-BATCH-HDR-NOT-FOUND
 24120         DEPENDING ON DFHEIGDI
 24121     ELSE IF DFHEIGDJ EQUAL 7
 24122         GO TO 1385-REC-NOT-FOUND
 24123         DEPENDING ON DFHEIGDI
 24124     ELSE IF DFHEIGDJ EQUAL 8
 24125         GO TO 1386-NOTFND
 24126         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 449
* EL6311.cbl
 24127     ELSE IF DFHEIGDJ EQUAL 9
 24128         GO TO 1399-EXIT
 24129         DEPENDING ON DFHEIGDI
 24130     ELSE IF DFHEIGDJ EQUAL 10
 24131         GO TO 1480-BATCH-HDR-NOT-FOUND
 24132         DEPENDING ON DFHEIGDI
 24133     ELSE IF DFHEIGDJ EQUAL 11
 24134         GO TO 1490-RECORD-NOT-FOUND
 24135         DEPENDING ON DFHEIGDI
 24136     ELSE IF DFHEIGDJ EQUAL 12
 24137         GO TO 1405-DELETE-CERTIFICATE
 24138         DEPENDING ON DFHEIGDI
 24139     ELSE IF DFHEIGDJ EQUAL 13
 24140         GO TO 1420-CONTINUE-DELETE
 24141         DEPENDING ON DFHEIGDI
 24142     ELSE IF DFHEIGDJ EQUAL 14
 24143         GO TO 1406-DELETE-ERNOTE
 24144         DEPENDING ON DFHEIGDI
 24145     ELSE IF DFHEIGDJ EQUAL 15
 24146         GO TO 1407-DELETE-MAILING
 24147         DEPENDING ON DFHEIGDI
 24148     ELSE IF DFHEIGDJ EQUAL 16
 24149         GO TO 1420-CONTINUE-DELETE
 24150         DEPENDING ON DFHEIGDI
 24151     ELSE IF DFHEIGDJ EQUAL 17
 24152         GO TO 1480-BATCH-HDR-NOT-FOUND
 24153         DEPENDING ON DFHEIGDI
 24154     ELSE IF DFHEIGDJ EQUAL 18
 24155         GO TO 1475-DELETE-FINISHED
 24156         DEPENDING ON DFHEIGDI
 24157     ELSE IF DFHEIGDJ EQUAL 19
 24158         GO TO 2280-BATCH-HDR-NOT-FOUND
 24159         DEPENDING ON DFHEIGDI
 24160     ELSE IF DFHEIGDJ EQUAL 20
 24161         GO TO 2290-DUPLICATE-ALT-INDEX
 24162         DEPENDING ON DFHEIGDI
 24163     ELSE IF DFHEIGDJ EQUAL 21
 24164         GO TO 2380-BATCH-HDR-NOT-FOUND
 24165         DEPENDING ON DFHEIGDI
 24166     ELSE IF DFHEIGDJ EQUAL 22
 24167         GO TO 2385-REC-NOT-FOUND
 24168         DEPENDING ON DFHEIGDI
 24169     ELSE IF DFHEIGDJ EQUAL 23
 24170         GO TO 2380-BATCH-HDR-NOT-FOUND
 24171         DEPENDING ON DFHEIGDI
 24172     ELSE IF DFHEIGDJ EQUAL 24
 24173         GO TO 2485-BATCH-HDR-NOT-FOUND
 24174         DEPENDING ON DFHEIGDI
 24175     ELSE IF DFHEIGDJ EQUAL 25
 24176         GO TO 2490-RECORD-NOT-FOUND
 24177         DEPENDING ON DFHEIGDI
 24178     ELSE IF DFHEIGDJ EQUAL 26
 24179         GO TO 2475-CONTINUE-DELETE
 24180         DEPENDING ON DFHEIGDI
 24181     ELSE IF DFHEIGDJ EQUAL 27
 24182         GO TO 2485-BATCH-HDR-NOT-FOUND
 24183         DEPENDING ON DFHEIGDI
 24184     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 450
* EL6311.cbl
 24185         GO TO 2480-DELETE-FINISHED
 24186         DEPENDING ON DFHEIGDI
 24187     ELSE IF DFHEIGDJ EQUAL 29
 24188         GO TO 2820-PROCESS-REWRITE
 24189         DEPENDING ON DFHEIGDI
 24190     ELSE IF DFHEIGDJ EQUAL 30
 24191         GO TO 2885-RECORD-MISSING
 24192         DEPENDING ON DFHEIGDI
 24193     ELSE IF DFHEIGDJ EQUAL 31
 24194         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24195         DEPENDING ON DFHEIGDI
 24196     ELSE IF DFHEIGDJ EQUAL 32
 24197         GO TO 2827-DELETE-MAILING
 24198         DEPENDING ON DFHEIGDI
 24199     ELSE IF DFHEIGDJ EQUAL 33
 24200         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24201         DEPENDING ON DFHEIGDI
 24202     ELSE IF DFHEIGDJ EQUAL 34
 24203         GO TO 2920-PROCESS-REWRITE
 24204         DEPENDING ON DFHEIGDI
 24205     ELSE IF DFHEIGDJ EQUAL 35
 24206         GO TO 2985-RECORD-MISSING
 24207         DEPENDING ON DFHEIGDI
 24208     ELSE IF DFHEIGDJ EQUAL 36
 24209         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24210         DEPENDING ON DFHEIGDI
 24211     ELSE IF DFHEIGDJ EQUAL 37
 24212         GO TO 2990-DUPLICATE-RECORD
 24213         DEPENDING ON DFHEIGDI
 24214     ELSE IF DFHEIGDJ EQUAL 38
 24215         GO TO 3590-NOT-FOUND
 24216         DEPENDING ON DFHEIGDI
 24217     ELSE IF DFHEIGDJ EQUAL 39
 24218         GO TO 3690-NOT-FOUND
 24219         DEPENDING ON DFHEIGDI
 24220     ELSE IF DFHEIGDJ EQUAL 40
 24221         GO TO 3990-NOT-FOUND
 24222         DEPENDING ON DFHEIGDI
 24223     ELSE IF DFHEIGDJ EQUAL 41
 24224         GO TO 4050-END-RECORDS,
 24225               4050-END-RECORDS
 24226         DEPENDING ON DFHEIGDI
 24227     ELSE IF DFHEIGDJ EQUAL 42
 24228         GO TO 4150-END-BATCH
 24229         DEPENDING ON DFHEIGDI
 24230     ELSE IF DFHEIGDJ EQUAL 43
 24231         GO TO 4150-END-BATCH
 24232         DEPENDING ON DFHEIGDI
 24233     ELSE IF DFHEIGDJ EQUAL 44
 24234         GO TO 4250-END-RECORDS,
 24235               4250-END-RECORDS
 24236         DEPENDING ON DFHEIGDI
 24237     ELSE IF DFHEIGDJ EQUAL 45
 24238         GO TO 4350-END-BATCH,
 24239               4350-END-BATCH
 24240         DEPENDING ON DFHEIGDI
 24241     ELSE IF DFHEIGDJ EQUAL 46
 24242         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:09 Page 451
* EL6311.cbl
 24243               4550-END-RECORDS
 24244         DEPENDING ON DFHEIGDI
 24245     ELSE IF DFHEIGDJ EQUAL 47
 24246         GO TO 4680-NOT-FOUND,
 24247               4680-NOT-FOUND
 24248         DEPENDING ON DFHEIGDI
 24249     ELSE IF DFHEIGDJ EQUAL 48
 24250         GO TO 4860-NOT-FOUND,
 24251               4850-END-RECORDS
 24252         DEPENDING ON DFHEIGDI
 24253     ELSE IF DFHEIGDJ EQUAL 49
 24254         GO TO 4970-NOT-FOUND,
 24255               4950-END-RECORDS
 24256         DEPENDING ON DFHEIGDI
 24257     ELSE IF DFHEIGDJ EQUAL 50
 24258         GO TO 5050-NOT-FOUND
 24259         DEPENDING ON DFHEIGDI
 24260     ELSE IF DFHEIGDJ EQUAL 51
 24261         GO TO 5050-NOT-FOUND
 24262         DEPENDING ON DFHEIGDI
 24263     ELSE IF DFHEIGDJ EQUAL 52
 24264         GO TO 5050-NOT-FOUND
 24265         DEPENDING ON DFHEIGDI
 24266     ELSE IF DFHEIGDJ EQUAL 53
 24267         GO TO 5550-END-RECORDS,
 24268               5550-END-RECORDS
 24269         DEPENDING ON DFHEIGDI
 24270     ELSE IF DFHEIGDJ EQUAL 54
 24271         GO TO 6050-QID-ERROR
 24272         DEPENDING ON DFHEIGDI
 24273     ELSE IF DFHEIGDJ EQUAL 55
 24274         GO TO 6050-QID-ERROR
 24275         DEPENDING ON DFHEIGDI
 24276     ELSE IF DFHEIGDJ EQUAL 56
 24277         GO TO 6400-CONTINUE,
 24278               6400-CONTINUE
 24279         DEPENDING ON DFHEIGDI
 24280     ELSE IF DFHEIGDJ EQUAL 57
 24281         GO TO 3690-NOT-FOUND
 24282         DEPENDING ON DFHEIGDI
 24283     ELSE IF DFHEIGDJ EQUAL 58
 24284         GO TO 7399-EXIT
 24285         DEPENDING ON DFHEIGDI
 24286     ELSE IF DFHEIGDJ EQUAL 59
 24287         GO TO 7550-OFFICER-NOTFND
 24288         DEPENDING ON DFHEIGDI
 24289     ELSE IF DFHEIGDJ EQUAL 60
 24290         GO TO 8300-SEND-TEXT
 24291         DEPENDING ON DFHEIGDI.
 24292     MOVE '9%                    "   ' TO DFHEIV0
 24293     MOVE 'EL6311' TO DFHEIV1
 24294     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24295     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14768     Code:       96554
