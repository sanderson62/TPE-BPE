* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL642.cbl
* Options: int("EL642.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL642.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL642.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL642.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL642 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 01/06/95 10:16:47.
     7*                            VMOD=2.031
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL642.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXH7 - GENERAL AGENT BILLING
    27*                           (PREPARE AN AGENT STATEMENT).
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    38* 050206    2005072800002  PEMA  ADD PROCESSING FOR DCC COMM.
    39* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    40******************************************************************
    41
    42 ENVIRONMENT DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL642.cbl
    44 DATA DIVISION.
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47
    48 77  FILLER  PIC X(32)  VALUE '********************************'.
    49 77  FILLER  PIC X(32)  VALUE '*    EL642 WORKING STORAGE     *'.
    50 77  FILLER  PIC X(32)  VALUE '***********VMOD 2.031 **********'.
    51 77  CNC-FACT                    PIC S999V9(7) COMP-3 VALUE +0.
    52 77  S1                          PIC S999 COMP-3 VALUE +0.
    53 77  CLAS-LOOK                   PIC XX      VALUE '  '.
    54
    55*    COPY ELCSCTM.
    56******************************************************************
    57*                                                                *
    58*                                                                *
    59*                            ELCSCTM                             *
    60*                            VMOD=2.001                          *
    61*                                                                *
    62*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    63*                                                                *
    64******************************************************************
    65 01  SECURITY-MESSAGE.
    66     12  FILLER                          PIC X(30)
    67            VALUE '** LOGIC SECURITY VIOLATION -'.
    68     12  SM-READ                         PIC X(6).
    69     12  FILLER                          PIC X(5)
    70            VALUE ' PGM='.
    71     12  SM-PGM                          PIC X(6).
    72     12  FILLER                          PIC X(5)
    73            VALUE ' OPR='.
    74     12  SM-PROCESSOR-ID                 PIC X(4).
    75     12  FILLER                          PIC X(6)
    76            VALUE ' TERM='.
    77     12  SM-TERMID                       PIC X(4).
    78     12  FILLER                          PIC XX   VALUE SPACE.
    79     12  SM-JUL-DATE                     PIC 9(5).
    80     12  FILLER                          PIC X    VALUE SPACE.
    81     12  SM-TIME                         PIC 99.99.
    82
    83*    COPY ELCSCRTY.
    84******************************************************************
    85*                                                                *
    86*                                                                *
    87*                            ELCSCRTY                            *
    88*                            VMOD=2.001                          *
    89*                                                                *
    90*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    91*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    92*        SAVED IN PI-SECURITY-ADDRESS.                           *
    93*                                                                *
    94******************************************************************
    95 01  SECURITY-CONTROL.
    96     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    97     12  FILLER                       PIC XX    VALUE 'SC'.
    98     12  SC-CREDIT-CODES.
    99         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   100             20  SC-CREDIT-DISPLAY    PIC X.
   101             20  SC-CREDIT-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL642.cbl
   102     12  SC-CLAIMS-CODES.
   103         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   104             20  SC-CLAIMS-DISPLAY    PIC X.
   105             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL642.cbl
   107 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   108     88  RESP-NORMAL               VALUE +0.
   109     88  RESP-NOTFND               VALUE +13.
   110     88  RESP-NOTOPEN              VALUE +19.
   111     88  RESP-ENDFILE              VALUE +20.
   112 01  WS-AH-CATEGORY              PIC X   VALUE SPACES.
   113 01  STANDARD-AREAS.
   114     12  SC-ITEM             PIC S9(4)   COMP    VALUE +1.
   115
   116     12  W-TRANSFER-CONTROL.
   117         16  WT-CR-CARRIER           PIC X.
   118         16  WT-CR-GROUPING          PIC X(6).
   119         16  WT-CR-STATE             PIC XX.
   120         16  WT-CR-ACCOUNT           PIC X(10).
   121         16  WT-CR-FIN-RESP          PIC X(10).
   122         16  WT-CR-TYPE              PIC X.
   123
   124     12  GETMAIN-SPACE       PIC  X              VALUE SPACE.
   125     12  MAP-NAME            PIC  X(8)           VALUE 'EL642A'.
   126     12  MAPSET-NAME         PIC  X(8)           VALUE 'EL642S'.
   127     12  SCREEN-NUMBER       PIC  X(4)           VALUE '642A'.
   128     12  TRANS-ID            PIC  X(4)           VALUE 'EXH7'.
   129     12  EL633-TRANS-ID      PIC  X(4)           VALUE 'EXB7'.
   130     12  EL633DMD-TRANS-ID   PIC  X(4)           VALUE 'EX1F'.
   131     12  EL635-TRANS-ID      PIC  X(4)           VALUE 'EXJ4'.
   132     12  EL650-TRANS-ID      PIC  X(4)           VALUE 'EXC4'.
   133     12  EL652-TRANS-ID      PIC  X(4)           VALUE 'EXD4'.
   134     12  EL658-TRANS-ID      PIC  X(4)           VALUE 'EXJ3'.
   135     12  THIS-PGM            PIC  X(8)           VALUE 'EL642'.
   136     12  EL642A              PIC  X(8)           VALUE 'EL642A'.
   137     12  EL642B              PIC  X(8)           VALUE 'EL642B'.
   138     12  PGM-NAME            PIC  X(8).
   139     12  TIME-IN             PIC S9(7).
   140     12  TIME-OUT-R  REDEFINES  TIME-IN.
   141         16  FILLER          PIC  X.
   142         16  TIME-OUT        PIC  99V99.
   143         16  FILLER          PIC  XX.
   144     12  XCTL-005            PIC  X(8)           VALUE 'EL005'.
   145     12  XCTL-010            PIC  X(8)           VALUE 'EL010'.
   146     12  XCTL-626            PIC  X(8)           VALUE 'EL626'.
   147     12  XCTL-633            PIC  X(8)           VALUE 'EL633'.
   148     12  XCTL-633DMD         PIC  X(8)           VALUE 'EL633DMD'.
   149     12  XCTL-635            PIC  X(8)           VALUE 'EL635'.
   150     12  XCTL-PYAJ           PIC  X(8)           VALUE 'EL633'.
   151     12  XCTL-650            PIC  X(8)           VALUE 'EL650'.
   152     12  XCTL-652            PIC  X(8)           VALUE 'EL652'.
   153     12  XCTL-6401           PIC  X(8)           VALUE 'EL6401'.
   154     12  XCTL-658            PIC  X(8)           VALUE 'EL658'.
   155     12  LINK-001            PIC  X(8)           VALUE 'EL001'.
   156     12  LINK-004            PIC  X(8)           VALUE 'EL004'.
   157     12  LINK-ELDATCV        PIC  X(8)           VALUE 'ELDATCV'.
   158     12  ERPNDB-ALT-FILE-ID  PIC  X(8)           VALUE 'ERPNDB2'.
   159     12  ERPNDB-FILE-ID      PIC  X(8)           VALUE 'ERPNDB'.
   160     12  ELCNTL-FILE-ID      PIC  X(8)           VALUE 'ELCNTL'.
   161     12  ERCOMP-FILE-ID      PIC  X(8)           VALUE 'ERCOMP'.
   162     12  ERPYAJ-FILE-ID      PIC  X(8)           VALUE 'ERPYAJ'.
   163     12  ERACCT-ALT-FILE-ID  PIC  X(8)           VALUE 'ERACCT2'.
   164     12  ERACCT-FILE-ID      PIC  X(8)           VALUE 'ERACCT'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL642.cbl
   165     12  ERBILL-FILE-ID      PIC  X(8)           VALUE 'ERBILL'.
   166     12  ERGXRF-FILE-ID      PIC  X(8)           VALUE 'ERGXRF'.
   167     12  ERCOMM-FILE-ID      PIC  X(8)           VALUE 'ERCOMM'.
   168     12  ERCTBL-FILE-ID      PIC  X(8)           VALUE 'ERCTBL'.
   169     12  ERRESC-FILE-ID      PIC  X(8)           VALUE 'ERRESC'.
   170     12  RETURNED-FROM       PIC  X(8)           VALUE SPACES.
   171     12  QID.
   172         16  QID-TERM        PIC  X(4).
   173         16  FILLER          PIC  X(4)           VALUE '642A'.
   174
   175 01  WORK-AREA.
   176     12  FIRST-TIME-SW               PIC  X      VALUE 'Y'.
   177         88  FIRST-TIME                          VALUE 'Y'.
   178     12  COMPENSATION-SW             PIC  X      VALUE ' '.
   179         88  GENERAL-AGENT                       VALUE 'G'.
   180     12  LIFE-INDICATOR              PIC  X      VALUE ' '.
   181         88  JOINT-LIFE                          VALUE 'J'.
   182     12  BENEFIT-MASTER-FOUND-SW     PIC  X      VALUE ' '.
   183         88  BENEFIT-MASTER-FOUND                VALUE 'Y'.
   184     12  COMMISSION-TBL-SW           PIC  X      VALUE ' '.
   185         88  COMMISSION-TBL-PRESENT              VALUE 'Y'.
   186     12  INVALID-ACCOUNT-SW          PIC  X      VALUE ' '.
   187         88  INVALID-ACCOUNT                     VALUE 'Y'.
   188     12  NEW-ACCOUNT-SW              PIC  X      VALUE ' '.
   189         88  NEW-ACCOUNT                         VALUE 'Y'.
   190     12  VALID-BILL-TYPE-VALUES      PIC  X      VALUE SPACE.
   191         88  VALID-BILL-TYPE                     VALUE  '1' '2'
   192                                                    '3' '4' '5'.
   193     12  BILL-BATCH-TRAILER-SW       PIC  X      VALUE SPACE.
   194         88  BILL-BATCH-TRAILER                  VALUE 'Y'.
   195     12  ERCOMM-FOUND-SW             PIC  X      VALUE SPACE.
   196         88  ERCOMM-FOUND                        VALUE 'Y'.
   197         88  ERCOMM-NOT-FOUND                    VALUE 'N'.
   198     12  ERCTBL-FOUND-SW             PIC  X      VALUE SPACE.
   199         88  ERCTBL-FOUND                        VALUE 'Y'.
   200         88  ERCTBL-NOT-FOUND                    VALUE 'N'.
   201     12  GXRF-EOF-SW                 PIC  X      VALUE SPACE.
   202         88  GXRF-EOF                            VALUE 'Y'.
   203     12  PNDB-EOF-SW                 PIC  X      VALUE SPACE.
   204         88  PNDB-EOF                            VALUE 'Y'.
   205     12  PYAJ-EOF-SW                 PIC  X      VALUE SPACE.
   206         88  PYAJ-EOF                            VALUE 'Y'.
   207     12  COMP-UPDATE-SW              PIC  X      VALUE SPACE.
   208         88  UPDATE-COMP-TOTALS                  VALUE 'Y'.
   209     12  LIMIT-BILLING-SW            PIC  X      VALUE SPACE.
   210         88  LIMIT-BILLING                       VALUE 'Y'.
   211     12  WS-PROCESS-SW               PIC  X      VALUE SPACE.
   212         88  DO-NOT-BILL-THIS-ACCT               VALUE 'Y'.
   213     12  NO-BILL-REC-SW              PIC  X      VALUE SPACE.
   214         88  NO-BILL-RECS                        VALUE 'Y'.
   215     12  DATA-VOIDED-SW              PIC  X      VALUE SPACE.
   216         88  DATA-VOIDED                         VALUE 'Y'.
   217     12  BATCHES-PROCESSED-SW        PIC  X      VALUE SPACE.
   218         88  MORE-THAN-6-BATCHES                 VALUE 'Y'.
   219     12  ACCOUNT-CARRY-BAL-SW        PIC  X      VALUE SPACE.
   220         88  ACCOUNT-CARRY-BAL                   VALUE 'Y'.
   221     12  BILLING-DETAIL-TYPE         PIC  XX VALUE SPACES.
   222         88  TOTAL-STATEMENT                     VALUE 'TS'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL642.cbl
   223         88  TOTAL-ACCOUNT                       VALUE 'TA'.
   224         88  TOTAL-BOTH                          VALUE 'TB'.
   225         88  GEN-AGT-ADDRESS                     VALUE 'GA'.
   226     12  ELCNTL-UPDATE-SW            PIC  X      VALUE SPACE.
   227         88  ELCNTL-UPDATE                       VALUE 'Y'.
   228     12  WS-BILL-TYPE                PIC  X      VALUE SPACE.
   229         88  WS-UPDATE-FILES                     VALUE '3' '4'
   230                                                       '5'.
   231     12  SUB                     PIC S999 COMP-3 VALUE ZEROS.
   232     12  ACCOM-SUB               PIC  99 COMP VALUE ZEROS.
   233     12  GX-SUB                  PIC S9(4) COMP VALUE ZEROS.
   234     12  COMP-SUB                PIC S9(4) COMP VALUE ZEROS.
   235     12  CE-SUB                  PIC S9(4) COMP VALUE ZEROS.
   236     12  BEN-SUB                 PIC S9(4) COMP VALUE ZEROS.
   237     12  WORK-SEQ-NO             PIC S9(9) COMP-3.
   238     12  WS-ERROR-MSG.
   239         16  WS-ERROR-TEXT       PIC  X(35)      VALUE SPACES.
   240         16  WS-ERROR-BATCH      PIC  X(6)       VALUE SPACES.
   241         16  FILLER              PIC  X(24)      VALUE SPACES.
   242     12  WS-WORK-DATE.
   243         16  WS-MONTH            PIC  99         VALUE ZEROS.
   244         16  WS-DAY              PIC  99         VALUE ZEROS.
   245         16  WS-YEAR             PIC  99         VALUE ZEROS.
   246     12  WS-MONTH-END-DATE.
   247         16  WS-ME-YEAR          PIC  99         VALUE ZEROS.
   248         16  WS-ME-MONTH         PIC  99         VALUE ZEROS.
   249         16  WS-ME-DAY           PIC  99         VALUE ZEROS.
   250     12  WS-CURRENT-DATE         PIC  XX         VALUE SPACES.
   251     12  WS-CURRENT-DATE-MDY     PIC  X(6)       VALUE SPACES.
   252     12  WS-CURRENT-DATE-EDIT    PIC  X(8)       VALUE SPACES.
   253     12  WS-PREV-BILL-DATE       PIC  XX     VALUE LOW-VALUES.
   254     12  MONTHS-DIFF-LF          PIC S9(05).
   255     12  MONTHS-DIFF-AH          PIC S9(05).
   256     12  WS-LF-CANCEL-DATE.
   257         16  WS-LF-CANCEL-YR     PIC 99.
   258         16  WS-LF-CANCEL-MO     PIC 99.
   259         16  WS-LF-CANCEL-DA     PIC 99.
   260     12  WS-AH-CANCEL-DATE.
   261         16  WS-AH-CANCEL-YR     PIC 99.
   262         16  WS-AH-CANCEL-MO     PIC 99.
   263         16  WS-AH-CANCEL-DA     PIC 99.
   264     12  WS-EFFECT-DATE.
   265         16  WS-EFFECT-YR        PIC 99.
   266         16  WS-EFFECT-MO        PIC 99.
   267         16  WS-EFFECT-DA        PIC 99.
   268     12  WS-BEGIN-DATE.
   269         16  FILLER              PIC  X(3)       VALUE SPACES.
   270         16  WS-BEGIN-DAY        PIC  XX         VALUE SPACES.
   271         16  FILLER              PIC  X(3)       VALUE SPACES.
   272     12  PRINT-CONTROL.
   273         16  SINGLE-SPACE        PIC  X          VALUE SPACE.
   274         16  DOUBLE-SPACE        PIC  X          VALUE ZERO.
   275         16  TRIPLE-SPACE        PIC  X          VALUE '-'.
   276         16  SUPPRESS-SPACE      PIC  X          VALUE '+'.
   277         16  TOP-OF-PAGE         PIC  X          VALUE '1'.
   278     12  WS-EXP-DATE.
   279         16  WS-SAV-EXP-DT   OCCURS  10  TIMES
   280                 INDEXED BY  DTNDX   PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL642.cbl
   281     12  WS-REMIT-TO.
   282         16  WS-SAV-REMIT-TO     OCCURS  10  TIMES
   283                 INDEXED BY  RTNDX   PIC  X(6).
   284     12  WORK-REMIT-TO           PIC  X(6)       VALUE SPACES.
   285     12  WS-REMITTED             PIC S9(6)V99    VALUE ZEROS.
   286     12  WS-LINECTR              PIC  99         VALUE ZEROS.
   287     12  WS-PGECTR               PIC  9(3)       VALUE 1.
   288     12  WS-LINE-SEQ-NO          PIC S9(4) COMP VALUE +1.
   289     12  WS-CARR-COMP.
   290         16  WS-CARRIER          PIC  X          VALUE SPACE.
   291         16  WS-COMP             PIC  X(3)       VALUE SPACES.
   292     12  WORK-AMT                PIC S9(7)V99    VALUE ZEROS.
   293     12  JOURNAL-LENGTH          PIC S9(4) COMP VALUE ZERO.
   294     12  LF-COMM-TBL-NO          PIC  X(3)       VALUE SPACES.
   295     12  JT-COMM-TBL-NO          PIC  X(3)       VALUE SPACES.
   296     12  AH-COMM-TBL-NO          PIC  X(3)       VALUE SPACES.
   297     12  AGENT-OWES              PIC  X(18)      VALUE
   298             'AGENT OWES       ='.
   299     12  OWED-TO-AGENT           PIC  X(18)      VALUE
   300             'OWED TO AGENT    ='.
   301     12  WS-PY-ENTRY-COMMENT.
   302         16  WS-PY-CURRENT-DATE  PIC  X(6).
   303         16  FILLER              PIC  X(14)      VALUE
   304                 ' CHK TO AGENT'.
   305     12  WS-ACCT-NOT-BILLED      PIC  X(18)      VALUE
   306             'ACCOUNT NOT BILLED'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL642.cbl
   308     12  WS-AGENT-ADDR-AREA.
   309         16  WS-AGENT-LINES  OCCURS  6  TIMES
   310                 INDEXED BY  A-INDX.
   311             20  WS-AGENT-ZIP.
   312                 24  WS-AGENT-1ST-ZIP    PIC  X(4).
   313                 24  WS-AGENT-2ND-ZIP    PIC  X(5).
   314             20  FILLER                  PIC  X(12).
   315             20  WS-A-LAST-ZIP.
   316                 24  WS-A-LAST-1ST-ZIP   PIC  X(4).
   317                 24  WS-A-LAST-2ND-ZIP   PIC  X(5).
   318     12  WS-COMPENSATION-WORK-AREA.
   319         16  WS-COMM-CK-AMT      PIC S9(5)V99 COMP-3 VALUE +0.
   320         16  WS-COMM-AGE         PIC  99.
   321         16  WS-COMM-TERM        PIC  9(3).
   322         16  WS-LF-ISS-COMP      PIC S9(5)V99 COMP-3 VALUE +0.
   323         16  WS-AH-ISS-COMP      PIC S9(5)V99 COMP-3 VALUE +0.
   324         16  WS-I-LF-PREMIUM-AMT PIC S9(7)V99 COMP-3 VALUE +0.
   325         16  WS-I-AH-PREMIUM-AMT PIC S9(7)V99 COMP-3 VALUE +0.
   326         16  WS-I-LF-BENEFIT-AMT PIC S9(9)V99 COMP-3 VALUE +0.
   327         16  WS-I-AH-BENEFIT-AMT PIC S9(9)V99 COMP-3 VALUE +0.
   328         16  WS-C-LF-CANCEL-AMT  PIC S9(7)V99 COMP-3 VALUE +0.
   329         16  WS-C-AH-CANCEL-AMT  PIC S9(7)V99 COMP-3 VALUE +0.
   330         16  WS-WK-RATE          PIC SV9(5)    COMP-3 VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL642.cbl
   332     12  WS-ACCOUNT-TOTALS       COMP-3.
   333         16  WS-ACCT-BEG-BAL         PIC S9(7)V99 VALUE ZEROS.
   334         16  WS-ACCT-NET-PREM        PIC S9(7)V99 VALUE ZEROS.
   335         16  WS-AH-ACCT-COMP         PIC S9(7)V99 VALUE ZEROS.
   336         16  WS-ACCT-COMP            PIC S9(7)V99 VALUE ZEROS.
   337         16  WS-ACCT-PAY-ADJS        PIC S9(7)V99 VALUE ZEROS.
   338         16  WS-ACCT-UNPAID-NET-PREM PIC S9(7)V99 VALUE ZEROS.
   339         16  WS-ACCT-LF-OVERWRITE    PIC S9(7)V99 VALUE ZEROS.
   340         16  WS-ACCT-AH-OVERWRITE    PIC S9(7)V99 VALUE ZEROS.
   341     12  WS-GENERAL-AGENT-TOTALS COMP-3.
   342         16  WS-GA-BEG-BAL           PIC S9(7)V99 VALUE ZEROS.
   343         16  WS-GA-NET-PREM          PIC S9(7)V99 VALUE ZEROS.
   344         16  WS-GA-COMP              PIC S9(7)V99 VALUE ZEROS.
   345         16  WS-GA-PAY-ADJS          PIC S9(7)V99 VALUE ZEROS.
   346         16  WS-GA-UNPAID-NET-PREM   PIC S9(7)V99 VALUE ZEROS.
   347         16  WS-GA-LF-OVERWRITE      PIC S9(7)V99 VALUE ZEROS.
   348         16  WS-GA-AH-OVERWRITE      PIC S9(7)V99 VALUE ZEROS.
   349         16  WS-GA-END-BAL           PIC S9(7)V99 VALUE ZEROS.
   350         16  WS-GA-AMT-DUE           PIC S9(7)V99 VALUE ZEROS.
   351     12  WS-GENERAL-AGENT-COMMISSIONS.
   352         16  WS-GA-LEVEL         PIC S99     COMP   VALUE +0.
   353         16  WS-GA-LF-COM        PIC SV9(5) COMP-3 VALUE +.0.
   354         16  WS-GA-AH-COM        PIC SV9(5) COMP-3 VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL642.cbl
   356 01  ACCESS-KEYS.
   357     12  ERPNDB-PRIME-KEY.
   358         16  ERPNDB-CO-CD        PIC  X          VALUE SPACES.
   359         16  ERPNDB-BATCH        PIC  X(6)       VALUE SPACES.
   360         16  ERPNDB-SEQ-NO       PIC S9(4) COMP.
   361         16  ERPNDB-CHG-SEQ-NO   PIC S9(4) COMP.
   362     12  ERPNDB-LENGTH           PIC S9(4) COMP VALUE +585.
   363     12  ERPNDB-ALT-KEY.
   364         16  ERPNDB-CO-CD-A1     PIC  X          VALUE SPACES.
   365         16  ERPNDB-CARR         PIC  X          VALUE SPACES.
   366         16  ERPNDB-GROUP        PIC  X(6)       VALUE SPACES.
   367         16  ERPNDB-STATE        PIC  XX         VALUE SPACES.
   368         16  ERPNDB-ACCT         PIC  X(10)      VALUE SPACES.
   369         16  ERPNDB-EFF-DT       PIC  XX         VALUE SPACES.
   370         16  ERPNDB-CERT.
   371             20  ERPNDB-CERT-PRM PIC  X(10)      VALUE SPACES.
   372             20  ERPNDB-CERTSFX  PIC  X          VALUE SPACES.
   373         16  ERPNDB-ACHG-SEQ-NO  PIC S9(4) COMP.
   374         16  ERPNDB-REC-TYPE     PIC  X          VALUE SPACES.
   375     12  ELCNTL-KEY.
   376         16  ELCNTL-COMPANY-ID   PIC  X(3)       VALUE SPACES.
   377         16  ELCNTL-REC-TYPE     PIC  X          VALUE SPACES.
   378         16  ELCNTL-ACCESS.
   379             20  ELCNTL-FILLER   PIC  X(3)       VALUE SPACES.
   380             20  ELCNTL-CARRIER  PIC  X          VALUE SPACES.
   381         16  ELCNTL-SEQ-NO       PIC S9(4) COMP VALUE ZEROS.
   382     12  ELCNTL-BENEFIT-KEY.
   383         16  CLBENF-COMPANY-ID   PIC  X(3)       VALUE SPACES.
   384         16  CLBENF-REC-TYPE     PIC  X          VALUE SPACES.
   385         16  CLBENF-ACCESS.
   386             20  FILLER          PIC  XX         VALUE SPACES.
   387             20  CLBENF-CD       PIC  XX         VALUE SPACES.
   388         16  CLBENF-SEQ-NO       PIC S9(4) COMP VALUE ZEROS.
   389     12  ELCNTL-LENGTH           PIC S9(4) COMP VALUE +504.
   390     12  ERCOMP-KEY.
   391         16  ERCOMP-COMP-CD      PIC  X          VALUE SPACE.
   392         16  ERCOMP-CARRIER      PIC  X          VALUE SPACES.
   393         16  ERCOMP-GROUPING     PIC  X(6)       VALUE SPACES.
   394         16  ERCOMP-FIN-RESP     PIC  X(10)      VALUE SPACES.
   395         16  ERCOMP-ACCT         PIC  X(10)      VALUE SPACES.
   396         16  ERCOMP-RECORD-TYPE  PIC  X          VALUE SPACES.
   397     12  ERPYAJ-BROWSE-COMP-KEY.
   398         16  ERPYAJ-BR-COMP-CD   PIC  X          VALUE SPACE.
   399         16  ERPYAJ-BR-CARRIER   PIC  X          VALUE SPACES.
   400         16  ERPYAJ-BR-GROUPING  PIC  X(6)       VALUE SPACES.
   401         16  ERPYAJ-BR-FIN-RESP  PIC  X(10)      VALUE SPACES.
   402         16  ERPYAJ-BR-ACCOUNT   PIC  X(10)      VALUE SPACES.
   403     12  ERCOMP-PREV-KEY         PIC  X(29)      VALUE SPACES.
   404     12  ERCOMP-LENGTH           PIC S9(4) COMP VALUE +700.
   405     12  ERPYAJ-KEY.
   406         16  ERPYAJ-COMP-CD      PIC  X          VALUE SPACE.
   407         16  ERPYAJ-CARRIER      PIC  X          VALUE SPACES.
   408         16  ERPYAJ-GROUPING     PIC  X(6)       VALUE SPACES.
   409         16  ERPYAJ-FIN-RESP     PIC  X(10)      VALUE SPACES.
   410         16  ERPYAJ-ACCOUNT      PIC  X(10)      VALUE SPACES.
   411         16  ERPYAJ-FILE-SEQ-NO  PIC S9(8) COMP VALUE +0.
   412         16  ERPYAJ-RECORD-TYPE  PIC  X          VALUE SPACES.
   413     12  ERPYAJ-LENGTH           PIC S9(4) COMP VALUE +200.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL642.cbl
   414     12  ERACCT-PRIME-KEY.
   415         16  ERACCT-P-CO-CD      PIC  X          VALUE SPACES.
   416         16  ERACCT-P-CARRIER    PIC  X          VALUE SPACES.
   417         16  ERACCT-P-GROUPING   PIC  X(6)       VALUE SPACES.
   418         16  ERACCT-P-STATE      PIC  XX         VALUE SPACES.
   419         16  ERACCT-P-ACCOUNT    PIC  X(10)      VALUE SPACES.
   420         16  ERACCT-P-EXP-DATE   PIC  XX         VALUE SPACES.
   421         16  FILLER              PIC  X(4)   VALUE LOW-VALUES.
   422     12  ERACCT-LENGTH           PIC S9(4) COMP VALUE +2000.
   423     12  ERACCT-ALT-KEY.
   424         16  ERACCT-A-CO-CD      PIC  X          VALUE SPACES.
   425         16  ERACCT-A-CARRIER    PIC  X          VALUE SPACES.
   426         16  ERACCT-A-GROUPING   PIC  X(6)       VALUE SPACES.
   427         16  ERACCT-A-STATE      PIC  XX         VALUE SPACES.
   428         16  ERACCT-A-ACCOUNT    PIC  X(10)      VALUE SPACES.
   429         16  ERACCT-A-EXP-DATE   PIC  XX         VALUE SPACES.
   430         16  FILLER              PIC  X(4)   VALUE LOW-VALUES.
   431     12  ERBILL-KEY.
   432         16  ERBILL-CO-CD        PIC  X.
   433         16  ERBILL-CARRIER      PIC  X.
   434         16  ERBILL-GROUP        PIC  X(6).
   435         16  ERBILL-ACCT         PIC  X(10).
   436         16  ERBILL-FIN-RESP     PIC  X(10).
   437         16  ERBILL-REC-TYPE     PIC  X.
   438         16  ERBILL-LINE-SEQ-NO  PIC S9(4) COMP.
   439     12  ERBILL-LENGTH           PIC S9(4) COMP VALUE +210.
   440     12  ERGXRF-KEY.
   441         16  ERGXRF-COMPANY-CD   PIC  X.
   442         16  ERGXRF-CARRIER      PIC  X.
   443         16  ERGXRF-GROUPING     PIC  X(6).
   444         16  ERGXRF-AGENT-NO     PIC  X(10).
   445     12  ERGXRF-FIXED-LENGTH     PIC S9(4) COMP VALUE +64.
   446     12  ERGXRF-VAR-LENGTH       PIC S9(4) COMP VALUE +24.
   447     12  ERGXRF-LENGTH           PIC S9(4) COMP VALUE ZEROS.
   448     12  ERCOMM-KEY.
   449         16  ERCOMM-COMPANY-CD   PIC  X.
   450         16  ERCOMM-CARRIER      PIC  X.
   451         16  ERCOMM-GROUPING     PIC  X(6).
   452         16  ERCOMM-STATE        PIC  XX.
   453         16  ERCOMM-ACCOUNT      PIC  X(10).
   454         16  ERCOMM-CERT-EFF-DT  PIC  XX.
   455         16  ERCOMM-CERT-NO.
   456             20  CE-CERT-PRIME   PIC  X(10).
   457             20  CE-CERT-SFX     PIC  X.
   458     12  ERCOMM-LENGTH           PIC S9(4) COMP VALUE +250.
   459     12  ERCTBL-KEY.
   460         16  ERCTBL-COMPANY-CD       PIC  X.
   461         16  ERCTBL-TABLE            PIC  X(3).
   462         16  ERCTBL-CNTRL-2.
   463             20  ERCTBL-BEN-TYPE     PIC  X.
   464             20  ERCTBL-BEN-CODE     PIC  XX.
   465     12  ERCTBL-LENGTH               PIC S9(4) COMP VALUE +200.
   466     12  SAVE-ERACCT-PRIME-KEY.
   467         16  SV-ERACCT-P-CO-CD       PIC  X      VALUE SPACES.
   468         16  SV-ERACCT-P-CARRIER     PIC  X      VALUE SPACES.
   469         16  SV-ERACCT-P-GROUPING    PIC  X(6)   VALUE SPACES.
   470         16  SV-ERACCT-P-STATE       PIC  XX     VALUE SPACES.
   471         16  SV-ERACCT-P-ACCOUNT     PIC  X(10)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL642.cbl
   472         16  SV-ERACCT-P-EXP-DATE    PIC  XX     VALUE SPACES.
   473*****************************************************************
   474*      START OF WORKING STORAGE FOR CLIENT-DMD                  *
   475*****************************************************************
   476*RESIDENT STATE TAXES MASTER(ERRESC)
   477*
   478     12  WS-SV-ERRESC-KEY             PIC X(32).
   479
   480     12  WS-ERRESC-KEY.
   481         16 WS-ERRESC-SEARCH-KEY.
   482             20  WS-ERRESC-COMPANY-CD PIC  X.
   483             20  WS-ERRESC-CARRIER    PIC  X.
   484             20  WS-ERRESC-GROUP      PIC X(6).
   485             20  WS-ERRESC-STATE      PIC XX.
   486             20  WS-ERRESC-ACCOUNT    PIC X(10).
   487         16 WS-ERRESC-RESIDUAL-KEY.
   488             20  WS-ERRESC-AGENT      PIC X(10).
   489             20  WS-ERRESC-RES-STATE  PIC XX.
   490             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   491*                                          YYYYMMDD
   492     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   493     12  WS-SUB1                      PIC    S99 COMP-3.
   494     12  WS-SUB                       PIC    S99 COMP-3.
   495     12  WS-CONTRACT-DATE             PIC 9(8).
   496     12  WS-COMM-SW                   PIC XX VALUE SPACES.
   497         88  AH-COMM                             VALUE 'AH'.
   498         88  LF-COMM                             VALUE 'LF'.
   499*****************************************************************
   500*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   501*****************************************************************
   502
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL642.cbl
   504 01  ERROR-NUMBERS.
   505     12  ER-0004             PIC  X(4)           VALUE '0004'.
   506     12  ER-0008             PIC  X(4)           VALUE '0008'.
   507     12  ER-0022             PIC  X(4)           VALUE '0022'.
   508     12  ER-0028             PIC  X(4)           VALUE '0028'.
   509     12  ER-0029             PIC  X(4)           VALUE '0029'.
   510     12  ER-0070             PIC  X(4)           VALUE '0070'.
   511     12  ER-0194             PIC  X(4)           VALUE '0194'.
   512     12  ER-0195             PIC  X(4)           VALUE '0195'.
   513     12  ER-0196             PIC  X(4)           VALUE '0196'.
   514     12  ER-0197             PIC  X(4)           VALUE '0197'.
   515     12  ER-2208             PIC  X(4)           VALUE '2208'.
   516     12  ER-2210             PIC  X(4)           VALUE '2210'.
   517     12  ER-2215             PIC  X(4)           VALUE '2215'.
   518     12  ER-2230             PIC  X(4)           VALUE '2230'.
   519     12  ER-2233             PIC  X(4)           VALUE '2233'.
   520     12  ER-2370             PIC  X(4)           VALUE '2370'.
   521     12  ER-2371             PIC  X(4)           VALUE '2371'.
   522     12  ER-2249             PIC  X(4)           VALUE '2249'.
   523     12  ER-2250             PIC  X(4)           VALUE '2250'.
   524     12  ER-2383             PIC  X(4)           VALUE '2383'.
   525     12  ER-2385             PIC  X(4)           VALUE '2385'.
   526     12  ER-2399             PIC  X(4)           VALUE '2399'.
   527     12  ER-2400             PIC  X(4)           VALUE '2400'.
   528     12  ER-2401             PIC  X(4)           VALUE '2401'.
   529     12  ER-2403             PIC  X(4)           VALUE '2403'.
   530     12  ER-2404             PIC  X(4)           VALUE '2404'.
   531     12  ER-2405             PIC  X(4)           VALUE '2405'.
   532     12  ER-2406             PIC  X(4)           VALUE '2406'.
   533     12  ER-2407             PIC  X(4)           VALUE '2407'.
   534     12  ER-2408             PIC  X(4)           VALUE '2408'.
   535     12  ER-2409             PIC  X(4)           VALUE '2409'.
   536     12  ER-2411             PIC  X(4)           VALUE '2411'.
   537     12  ER-2421             PIC  X(4)           VALUE '2421'.
   538     12  ER-2434             PIC  X(4)           VALUE '2434'.
   539     12  ER-2435             PIC  X(4)           VALUE '2435'.
   540     12  ER-2436             PIC  X(4)           VALUE '2436'.
   541     12  ER-2438             PIC  X(4)           VALUE '2438'.
   542     12  ER-2439             PIC  X(4)           VALUE '2439'.
   543     12  ER-2443             PIC  X(4)           VALUE '2443'.
   544     12  ER-2472             PIC  X(4)           VALUE '2472'.
   545     12  ER-2564             PIC  X(4)           VALUE '2564'.
   546     12  ER-2570             PIC  X(4)           VALUE '2570'.
   547     12  ER-2571             PIC  X(4)           VALUE '2571'.
   548     12  ER-2590             PIC  X(4)           VALUE '2571'.
   549     12  ER-2597             PIC  X(4)           VALUE '2597'.
   550     12  ER-2910             PIC  X(4)           VALUE '2910'.
   551     12  ER-2911             PIC  X(4)           VALUE '2911'.
   552     12  ER-2912             PIC  X(4)           VALUE '2912'.
   553     12  ER-2913             PIC  X(4)           VALUE '2913'.
   554     12  ER-2914             PIC  X(4)           VALUE '2914'.
   555     12  ER-2915             PIC  X(4)           VALUE '2915'.
   556     12  ER-2916             PIC  X(4)           VALUE '2916'.
   557     12  ER-2917             PIC  X(4)           VALUE '2917'.
   558     12  ER-2918             PIC  X(4)           VALUE '2918'.
   559     12  ER-3145             PIC  X(4)           VALUE '3145'.
   560     12  ER-3165             PIC  X(4)           VALUE '3165'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL642.cbl
   562 01  CENTER-DATA-WORK-AREA.
   563     12  X1                  PIC S9(4)   COMP    VALUE +0.
   564     12  X2                  PIC S9(4)   COMP    VALUE +0.
   565     12  X3                  PIC S9(4)   COMP    VALUE +0.
   566     12  X-LEN               PIC S9(4)   COMP    VALUE +0.
   567     12  CENTER-WORK-1.
   568         16  CW1-PIC         PIC  X      OCCURS  44  TIMES.
   569     12  CENTER-WORK-2.
   570         16  CW2-PIC         PIC  X      OCCURS  44  TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL642.cbl
   572 01  GA-REPORT-HEADINGS.
   573     12  GA-PREVIEW-HD.
   574         16  FILLER          PIC  X(44)          VALUE
   575                 '                                          **'.
   576         16  FILLER          PIC  X(45)          VALUE
   577                 '** STATEMENT IS FOR REVIEW PURPOSES ONLY ***'.
   578         16  FILLER          PIC  X(44)          VALUE
   579                 '*                                           '.
   580     12  GA-HD1.
   581         16  FILLER          PIC  X(44)          VALUE SPACES.
   582         16  FILLER          PIC  X(44)          VALUE
   583                 '            AGENT    STATEMENT              '.
   584         16  FILLER          PIC  X(37)          VALUE SPACES.
   585         16  FILLER          PIC  X(7)           VALUE ' EL642 '.
   586     12  GA-HD2.
   587         16  FILLER          PIC  X(43)          VALUE SPACES.
   588         16  HD-CO           PIC  X(44)          VALUE SPACES.
   589         16  FILLER          PIC  X(37)          VALUE SPACES.
   590         16  HD-RUN-DT       PIC  X(8)           VALUE SPACES.
   591     12  GA-HD3.
   592         16  FILLER          PIC  X(57)          VALUE SPACES.
   593         16  HD-DT           PIC  X(18)          VALUE SPACES.
   594         16  FILLER          PIC  X(37)          VALUE SPACES.
   595         16  FILLER          PIC  X(5)           VALUE 'PAGE '.
   596         16  HD-PG           PIC ZZ,ZZ9.
   597     12  GA-HD4.
   598         16  FILLER          PIC  X(44)          VALUE
   599                 ' ------------- A C C O U N T -------------  '.
   600         16  FILLER          PIC  X(44)          VALUE
   601                 'BEGINNING      NET       ACCOUNT    PAYMENTS'.
   602         16  FILLER          PIC  X(44)          VALUE
   603                 '     UNPAID                          AMT.   '.
   604     12  GA-HD5.
   605         16  FILLER          PIC  X(44)          VALUE
   606                 '   NUMBER                 NAME              '.
   607         16  FILLER          PIC  X(44)          VALUE
   608                 ' BALANCE     PREMIUM     COMPENS.   ADJUSTS.'.
   609         16  FILLER          PIC  X(44)          VALUE
   610                 '  NET PREMIUM  BENEFIT  OVERWRITE    DUE    '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL642.cbl
   612*                            COPY ELCDATE.
   613******************************************************************
   614*                                                                *
   615*                                                                *
   616*                            ELCDATE.                            *
   617*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   618*                            VMOD=2.003
   619*                                                                *
   620*                                                                *
   621*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   622*                 LENGTH = 200                                   *
   623******************************************************************
   624
   625 01  DATE-CONVERSION-DATA.
   626     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   627     12  DC-OPTION-CODE                PIC X.
   628         88  BIN-TO-GREG                VALUE ' '.
   629         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   630         88  EDIT-GREG-TO-BIN           VALUE '2'.
   631         88  YMD-GREG-TO-BIN            VALUE '3'.
   632         88  MDY-GREG-TO-BIN            VALUE '4'.
   633         88  JULIAN-TO-BIN              VALUE '5'.
   634         88  BIN-PLUS-ELAPSED           VALUE '6'.
   635         88  FIND-CENTURY               VALUE '7'.
   636         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   637         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   638         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   639         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   640         88  JULIAN-TO-BIN-3            VALUE 'C'.
   641         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   642         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   643         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   644         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   645         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   646         88  CHECK-LEAP-YEAR            VALUE 'H'.
   647         88  BIN-3-TO-GREG              VALUE 'I'.
   648         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   649         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   650         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   651         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   652         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   653         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   654         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   655         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   656         88  THREE-CHARACTER-BIN
   657                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   658         88  GREGORIAN-TO-BIN
   659                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   660         88  BIN-TO-GREGORIAN
   661                  VALUES ' ' '1' 'I' '8' 'G'.
   662         88  JULIAN-TO-BINARY
   663                  VALUES '5' 'C' 'E' 'F'.
   664     12  DC-ERROR-CODE                 PIC X.
   665         88  NO-CONVERSION-ERROR        VALUE ' '.
   666         88  DATE-CONVERSION-ERROR
   667                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   668         88  DATE-IS-ZERO               VALUE '1'.
   669         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL642.cbl
   670         88  DATE-IS-INVALID            VALUE '3'.
   671         88  DATE1-GREATER-DATE2        VALUE '4'.
   672         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   673         88  DATE-INVALID-OPTION        VALUE '9'.
   674         88  INVALID-CENTURY            VALUE 'A'.
   675         88  ONLY-CENTURY               VALUE 'B'.
   676         88  ONLY-LEAP-YEAR             VALUE 'C'.
   677         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   678     12  DC-END-OF-MONTH               PIC X.
   679         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   680     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   681         88  USE-NORMAL-PROCESS         VALUE ' '.
   682         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   683         88  ADJUST-UP-100-YRS          VALUE '2'.
   684     12  FILLER                        PIC X.
   685     12  DC-CONVERSION-DATES.
   686         16  DC-BIN-DATE-1             PIC XX.
   687         16  DC-BIN-DATE-2             PIC XX.
   688         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   689         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   690                       DC-GREG-DATE-1-EDIT.
   691             20  DC-EDIT1-MONTH        PIC 99.
   692             20  SLASH1-1              PIC X.
   693             20  DC-EDIT1-DAY          PIC 99.
   694             20  SLASH1-2              PIC X.
   695             20  DC-EDIT1-YEAR         PIC 99.
   696         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   697         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   698                     DC-GREG-DATE-2-EDIT.
   699             20  DC-EDIT2-MONTH        PIC 99.
   700             20  SLASH2-1              PIC X.
   701             20  DC-EDIT2-DAY          PIC 99.
   702             20  SLASH2-2              PIC X.
   703             20  DC-EDIT2-YEAR         PIC 99.
   704         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   705         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   706                     DC-GREG-DATE-1-YMD.
   707             20  DC-YMD-YEAR           PIC 99.
   708             20  DC-YMD-MONTH          PIC 99.
   709             20  DC-YMD-DAY            PIC 99.
   710         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   711         16  DC-GREG-DATE-1-MDY-R REDEFINES
   712                      DC-GREG-DATE-1-MDY.
   713             20  DC-MDY-MONTH          PIC 99.
   714             20  DC-MDY-DAY            PIC 99.
   715             20  DC-MDY-YEAR           PIC 99.
   716         16  DC-GREG-DATE-1-ALPHA.
   717             20  DC-ALPHA-MONTH        PIC X(10).
   718             20  DC-ALPHA-DAY          PIC 99.
   719             20  FILLER                PIC XX.
   720             20  DC-ALPHA-CENTURY.
   721                 24 DC-ALPHA-CEN-N     PIC 99.
   722             20  DC-ALPHA-YEAR         PIC 99.
   723         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   724         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   725         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   726         16  DC-JULIAN-DATE            PIC 9(05).
   727         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL642.cbl
   728                                       PIC 9(05).
   729         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   730             20  DC-JULIAN-YEAR        PIC 99.
   731             20  DC-JULIAN-DAYS        PIC 999.
   732         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   733         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   734         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   735     12  DATE-CONVERSION-VARIBLES.
   736         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   737         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   738             20  FILLER                PIC 9(3).
   739             20  HOLD-CEN-1-CCYY.
   740                 24  HOLD-CEN-1-CC     PIC 99.
   741                 24  HOLD-CEN-1-YY     PIC 99.
   742             20  HOLD-CEN-1-MO         PIC 99.
   743             20  HOLD-CEN-1-DA         PIC 99.
   744         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   745             20  HOLD-CEN-1-R-MO       PIC 99.
   746             20  HOLD-CEN-1-R-DA       PIC 99.
   747             20  HOLD-CEN-1-R-CCYY.
   748                 24  HOLD-CEN-1-R-CC   PIC 99.
   749                 24  HOLD-CEN-1-R-YY   PIC 99.
   750             20  FILLER                PIC 9(3).
   751         16  HOLD-CENTURY-1-X.
   752             20  FILLER                PIC X(3)  VALUE SPACES.
   753             20  HOLD-CEN-1-X-CCYY.
   754                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   755                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   756             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   757             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   758         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   759             20  HOLD-CEN-1-R-X-MO     PIC XX.
   760             20  HOLD-CEN-1-R-X-DA     PIC XX.
   761             20  HOLD-CEN-1-R-X-CCYY.
   762                 24  HOLD-CEN-1-R-X-CC PIC XX.
   763                 24  HOLD-CEN-1-R-X-YY PIC XX.
   764             20  FILLER                PIC XXX.
   765         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   766         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   767         16  DC-JULIAN-DATE-1          PIC 9(07).
   768         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   769             20  DC-JULIAN-1-CCYY.
   770                 24  DC-JULIAN-1-CC    PIC 99.
   771                 24  DC-JULIAN-1-YR    PIC 99.
   772             20  DC-JULIAN-DA-1        PIC 999.
   773         16  DC-JULIAN-DATE-2          PIC 9(07).
   774         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   775             20  DC-JULIAN-2-CCYY.
   776                 24  DC-JULIAN-2-CC    PIC 99.
   777                 24  DC-JULIAN-2-YR    PIC 99.
   778             20  DC-JULIAN-DA-2        PIC 999.
   779         16  DC-GREG-DATE-A-EDIT.
   780             20  DC-EDITA-MONTH        PIC 99.
   781             20  SLASHA-1              PIC X VALUE '/'.
   782             20  DC-EDITA-DAY          PIC 99.
   783             20  SLASHA-2              PIC X VALUE '/'.
   784             20  DC-EDITA-CCYY.
   785                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL642.cbl
   786                 24  DC-EDITA-YEAR     PIC 99.
   787         16  DC-GREG-DATE-B-EDIT.
   788             20  DC-EDITB-MONTH        PIC 99.
   789             20  SLASHB-1              PIC X VALUE '/'.
   790             20  DC-EDITB-DAY          PIC 99.
   791             20  SLASHB-2              PIC X VALUE '/'.
   792             20  DC-EDITB-CCYY.
   793                 24  DC-EDITB-CENT     PIC 99.
   794                 24  DC-EDITB-YEAR     PIC 99.
   795         16  DC-GREG-DATE-CYMD         PIC 9(08).
   796         16  DC-GREG-DATE-CYMD-R REDEFINES
   797                              DC-GREG-DATE-CYMD.
   798             20  DC-CYMD-CEN           PIC 99.
   799             20  DC-CYMD-YEAR          PIC 99.
   800             20  DC-CYMD-MONTH         PIC 99.
   801             20  DC-CYMD-DAY           PIC 99.
   802         16  DC-GREG-DATE-MDCY         PIC 9(08).
   803         16  DC-GREG-DATE-MDCY-R REDEFINES
   804                              DC-GREG-DATE-MDCY.
   805             20  DC-MDCY-MONTH         PIC 99.
   806             20  DC-MDCY-DAY           PIC 99.
   807             20  DC-MDCY-CEN           PIC 99.
   808             20  DC-MDCY-YEAR          PIC 99.
   809    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   810        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   811    12  DC-EL310-DATE                  PIC X(21).
   812    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL642.cbl
   814*                            COPY ELCLOGOF.
   815******************************************************************
   816*                                                                *
   817*                                                                *
   818*                            ELCLOGOF.                           *
   819*                            VMOD=2.001                          *
   820*                                                                *
   821*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   822*                                                                *
   823******************************************************************
   824 01  CLASIC-LOGOFF.
   825     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   826     12  LOGOFF-TEXT.
   827         16  FILLER          PIC X(5)    VALUE SPACES.
   828         16  LOGOFF-MSG.
   829             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   830             20  FILLER      PIC X       VALUE SPACES.
   831             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   832         16  FILLER          PIC X(80)
   833           VALUE '* YOU ARE NOW LOGGED OFF'.
   834         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   835         16  FILLER          PIC X       VALUE QUOTE.
   836         16  LOGOFF-SYS-MSG  PIC X(17)
   837           VALUE 'S CLAS-IC SYSTEM '.
   838     12  TEXT-MESSAGES.
   839         16  UNACCESS-MSG    PIC X(29)
   840             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   841         16  PGMIDERR-MSG    PIC X(17)
   842             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL642.cbl
   844*                            COPY ELCATTR.
   845******************************************************************
   846*                                                                *
   847*                            ELCATTR.                            *
   848*                            VMOD=2.001                          *
   849*                                                                *
   850*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   851*                                                                *
   852*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   853*                                                                *
   854*                   POS 1   P=PROTECTED                          *
   855*                           U=UNPROTECTED                        *
   856*                           S=ASKIP                              *
   857*                   POS 2   A=ALPHA/NUMERIC                      *
   858*                           N=NUMERIC                            *
   859*                   POS 3   N=NORMAL                             *
   860*                           B=BRIGHT                             *
   861*                           D=DARK                               *
   862*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   863*                           OF=MODIFIED DATA TAG OFF             *
   864*                                                                *
   865*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   866******************************************************************
   867 01  ATTRIBUTE-LIST.
   868     12  AL-PABOF            PIC X       VALUE 'Y'.
   869     12  AL-PABON            PIC X       VALUE 'Z'.
   870     12  AL-PADOF            PIC X       VALUE '%'.
   871     12  AL-PADON            PIC X       VALUE '_'.
   872     12  AL-PANOF            PIC X       VALUE '-'.
   873     12  AL-PANON            PIC X       VALUE '/'.
   874     12  AL-SABOF            PIC X       VALUE '8'.
   875     12  AL-SABON            PIC X       VALUE '9'.
   876     12  AL-SADOF            PIC X       VALUE '@'.
   877     12  AL-SADON            PIC X       VALUE QUOTE.
   878     12  AL-SANOF            PIC X       VALUE '0'.
   879     12  AL-SANON            PIC X       VALUE '1'.
   880     12  AL-UABOF            PIC X       VALUE 'H'.
   881     12  AL-UABON            PIC X       VALUE 'I'.
   882     12  AL-UADOF            PIC X       VALUE '<'.
   883     12  AL-UADON            PIC X       VALUE '('.
   884     12  AL-UANOF            PIC X       VALUE ' '.
   885     12  AL-UANON            PIC X       VALUE 'A'.
   886     12  AL-UNBOF            PIC X       VALUE 'Q'.
   887     12  AL-UNBON            PIC X       VALUE 'R'.
   888     12  AL-UNDOF            PIC X       VALUE '*'.
   889     12  AL-UNDON            PIC X       VALUE ')'.
   890     12  AL-UNNOF            PIC X       VALUE '&'.
   891     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL642.cbl
   893*                            COPY ELCEMIB.
   894******************************************************************
   895*                                                                *
   896*                                                                *
   897*                            ELCEMIB.                            *
   898*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   899*                            VMOD=2.005                          *
   900*                                                                *
   901*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   902*                                                                *
   903******************************************************************
   904 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   905     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   906     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   907     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   908     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   909     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   910     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   911     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   912     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   913     12  EMI-SWITCH1             PIC X        VALUE '1'.
   914         88  EMI-NO-ERRORS                    VALUE '1'.
   915         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   916         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   917     12  EMI-SWITCH2             PIC X        VALUE '1'.
   918         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   919     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   920         88  EMI-AREA1-EMPTY                  VALUE '1'.
   921         88  EMI-AREA1-FULL                   VALUE '2'.
   922     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   923         88  EMI-AREA2-EMPTY                  VALUE '1'.
   924         88  EMI-AREA2-FULL                   VALUE '2'.
   925     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   926         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   927         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   928         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   929         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   930         88  EMI-BYPASS-FATALS                VALUE 'X'.
   931     12  EMI-ERROR-LINES.
   932         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   933         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   934         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   935         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   936             20  EMI-ERR-CODES OCCURS 10 TIMES.
   937                 24  EMI-ERR-NUM         PIC X(4).
   938                 24  EMI-FILLER          PIC X.
   939                 24  EMI-SEV             PIC X.
   940                 24  FILLER              PIC X.
   941             20  FILLER                  PIC X(02).
   942     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   943         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   944             20  EMI-ERROR-NUMBER    PIC X(4).
   945             20  EMI-FILL            PIC X.
   946             20  EMI-SEVERITY        PIC X.
   947             20  FILLER              PIC X.
   948             20  EMI-ERROR-TEXT.
   949                 24  EMI-TEXT-VARIABLE   PIC X(10).
   950                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL642.cbl
   951     12  EMI-SEVERITY-SAVE           PIC X.
   952         88  EMI-NOTE                    VALUE 'N'.
   953         88  EMI-WARNING                 VALUE 'W'.
   954         88  EMI-FORCABLE                VALUE 'F'.
   955         88  EMI-FATAL                   VALUE 'X'.
   956     12  EMI-MESSAGE-FLAG            PIC X.
   957         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   958         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   959     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   960     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   961         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   962         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   963         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   964     12  FILLER                      PIC X(137)  VALUE SPACES.
   965     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   966     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   967     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   968     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL642.cbl
   970*                            COPY ELCINTF.
   971******************************************************************
   972*                                                                *
   973*                                                                *
   974*                            ELCINTF.                            *
   975*                            VMOD=2.017                          *
   976*                                                                *
   977*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   978*                                                                *
   979*       LENGTH = 1024                                            *
   980*                                                                *
   981******************************************************************
   982 01  PROGRAM-INTERFACE-BLOCK.
   983     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   984     12  PI-CALLING-PROGRAM              PIC X(8).
   985     12  PI-SAVED-PROGRAM-1              PIC X(8).
   986     12  PI-SAVED-PROGRAM-2              PIC X(8).
   987     12  PI-SAVED-PROGRAM-3              PIC X(8).
   988     12  PI-SAVED-PROGRAM-4              PIC X(8).
   989     12  PI-SAVED-PROGRAM-5              PIC X(8).
   990     12  PI-SAVED-PROGRAM-6              PIC X(8).
   991     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   992     12  PI-COMPANY-ID                   PIC XXX.
   993     12  PI-COMPANY-CD                   PIC X.
   994
   995     12  PI-COMPANY-PASSWORD             PIC X(8).
   996
   997     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   998
   999     12  PI-CONTROL-IN-PROGRESS.
  1000         16  PI-CARRIER                  PIC X.
  1001         16  PI-GROUPING                 PIC X(6).
  1002         16  PI-STATE                    PIC XX.
  1003         16  PI-ACCOUNT                  PIC X(10).
  1004         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1005                                         PIC X(10).
  1006         16  PI-CLAIM-CERT-GRP.
  1007             20  PI-CLAIM-NO             PIC X(7).
  1008             20  PI-CERT-NO.
  1009                 25  PI-CERT-PRIME       PIC X(10).
  1010                 25  PI-CERT-SFX         PIC X.
  1011             20  PI-CERT-EFF-DT          PIC XX.
  1012         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1013             20  PI-PLAN-CODE            PIC X(2).
  1014             20  PI-REVISION-NUMBER      PIC X(3).
  1015             20  PI-PLAN-EFF-DT          PIC X(2).
  1016             20  PI-PLAN-EXP-DT          PIC X(2).
  1017             20  FILLER                  PIC X(11).
  1018         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1019             20  PI-OE-REFERENCE-1.
  1020                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1021                 25  PI-OE-REF-1-SUFF    PIC XX.
  1022
  1023     12  PI-SESSION-IN-PROGRESS          PIC X.
  1024         88  CLAIM-SESSION                   VALUE '1'.
  1025         88  CREDIT-SESSION                  VALUE '2'.
  1026         88  WARRANTY-SESSION                VALUE '3'.
  1027         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL642.cbl
  1028         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1029
  1030
  1031*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1032
  1033     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1034     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1035
  1036     12  PI-CREDIT-USER                  PIC X.
  1037         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1038         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1039
  1040     12  PI-CLAIM-USER                   PIC X.
  1041         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1042         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1043
  1044     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1045         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1046         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1047         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1048         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1049         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1050
  1051     12  PI-PROCESSOR-ID                 PIC X(4).
  1052
  1053     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1054
  1055     12  PI-MEMBER-CAPTION               PIC X(10).
  1056
  1057     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1058         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1059
  1060     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1061     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1062     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1063     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1064
  1065     12  PI-AH-OVERRIDE-L1               PIC X.
  1066     12  PI-AH-OVERRIDE-L2               PIC XX.
  1067     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1068     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1069
  1070     12  PI-NEW-SYSTEM                   PIC X(2).
  1071
  1072     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1073     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1074         88  PI-USES-PAID-TO                 VALUE '1'.
  1075     12  PI-CRDTCRD-SYSTEM.
  1076         16  PI-CRDTCRD-USER             PIC X.
  1077             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1078             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1079         16  PI-CC-MONTH-END-DT          PIC XX.
  1080     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1081
  1082     12  PI-OE-REFERENCE-2.
  1083         16  PI-OE-REF-2-PRIME           PIC X(10).
  1084         16  PI-OE-REF-2-SUFF            PIC X.
  1085
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL642.cbl
  1086     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1087
  1088     12  PI-LANGUAGE-TYPE                PIC X.
  1089             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1090             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1091             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1092
  1093     12  PI-POLICY-LINKAGE-IND           PIC X.
  1094         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1095         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1096                                                   LOW-VALUES.
  1097
  1098     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1099     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1100         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1101         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1102     12  FILLER                          PIC X(4).
  1103
  1104     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1105
  1106     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1107         PI-SYSTEM-LEVEL.
  1108
  1109         16  PI-ENTRY-CODES.
  1110             20  PI-ENTRY-CD-1           PIC X.
  1111             20  PI-ENTRY-CD-2           PIC X.
  1112
  1113         16  PI-RETURN-CODES.
  1114             20  PI-RETURN-CD-1          PIC X.
  1115             20  PI-RETURN-CD-2          PIC X.
  1116
  1117         16  PI-UPDATE-STATUS-SAVE.
  1118             20  PI-UPDATE-BY            PIC X(4).
  1119             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1120
  1121         16  PI-LOWER-CASE-LETTERS       PIC X.
  1122             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1123
  1124*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1125*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1126*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1127
  1128         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1129             88  ST-ACCNT-CNTL               VALUE ' '.
  1130             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1131             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1132             88  ACCNT-CNTL                  VALUE '3'.
  1133             88  CARR-ACCNT-CNTL             VALUE '4'.
  1134
  1135         16  PI-PROCESSOR-CAP-LIST.
  1136             20  PI-SYSTEM-CONTROLS.
  1137                24 PI-SYSTEM-DISPLAY     PIC X.
  1138                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1139                24 PI-SYSTEM-MODIFY      PIC X.
  1140                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1141             20  FILLER                  PIC XX.
  1142             20  PI-DISPLAY-CAP          PIC X.
  1143                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL642.cbl
  1144             20  PI-MODIFY-CAP           PIC X.
  1145                 88  MODIFY-CAP              VALUE 'Y'.
  1146             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1147                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1148             20  PI-FORCE-CAP            PIC X.
  1149                 88  FORCE-CAP               VALUE 'Y'.
  1150
  1151         16  PI-PROGRAM-CONTROLS.
  1152             20  PI-PGM-PRINT-OPT        PIC X.
  1153             20  PI-PGM-FORMAT-OPT       PIC X.
  1154             20  PI-PGM-PROCESS-OPT      PIC X.
  1155             20  PI-PGM-TOTALS-OPT       PIC X.
  1156
  1157         16  PI-HELP-INTERFACE.
  1158             20  PI-LAST-ERROR-NO        PIC X(4).
  1159             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1160
  1161         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1162             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1163
  1164         16  PI-CR-CONTROL-IN-PROGRESS.
  1165             20  PI-CR-CARRIER           PIC X.
  1166             20  PI-CR-GROUPING          PIC X(6).
  1167             20  PI-CR-STATE             PIC XX.
  1168             20  PI-CR-ACCOUNT           PIC X(10).
  1169             20  PI-CR-FIN-RESP          PIC X(10).
  1170             20  PI-CR-TYPE              PIC X.
  1171
  1172         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1173
  1174         16  PI-CR-MONTH-END-DT          PIC XX.
  1175
  1176         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1177             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1178             88  PI-ZERO-CARRIER             VALUE '1'.
  1179             88  PI-ZERO-GROUPING            VALUE '2'.
  1180             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1181
  1182         16  PI-CARRIER-SECURITY         PIC X.
  1183             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1184
  1185         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1186             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1187             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1188
  1189         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1190             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1191                                         INDEXED BY PI-ACCESS-NDX
  1192                                         PIC X.
  1193
  1194         16  PI-GA-BILLING-CONTROL       PIC X.
  1195             88  PI-GA-BILLING               VALUE '1'.
  1196
  1197         16  PI-MAIL-PROCESSING          PIC X.
  1198             88  PI-MAIL-YES                 VALUE 'Y'.
  1199
  1200         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1201
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL642.cbl
  1202         16  PI-AR-SYSTEM.
  1203             20  PI-AR-PROCESSING-CNTL   PIC X.
  1204                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1205             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1206             20  PI-AR-MONTH-END-DT      PIC XX.
  1207
  1208         16  PI-MP-SYSTEM.
  1209             20  PI-MORTGAGE-USER            PIC X.
  1210                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1211                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1212             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1213                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1214                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1215                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1216                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1217                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1218             20  PI-MP-MONTH-END-DT          PIC XX.
  1219             20  PI-MP-REFERENCE-NO.
  1220                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1221                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1222
  1223         16  PI-LABEL-CONTROL            PIC X(01).
  1224             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1225             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1226
  1227         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1228             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1229
  1230         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1231             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1232             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1233
  1234         16  FILLER                      PIC X(14).
  1235
  1236     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1237******************************************************************
  1238     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1239         16  PI-MAP-NAME         PIC  X(8).
  1240         16  PI-AGENT-NAME       PIC  X(20).
  1241         16  PI-SAV-REMIT-TO     PIC  X(10).
  1242         16  PI-SAV-FIN-RESP     PIC  X(10).
  1243         16  PI-SAV-ACCT         PIC  X(10).
  1244         16  PI-SAV-ACCT-AGT     PIC  X(10).
  1245         16  PI-SAV-ACCT-NAME    PIC  X(30).
  1246         16  PI-SAV-AGENT        PIC  X(10).
  1247         16  PI-SAV-CARR         PIC  X.
  1248         16  PI-SAV-GROUP        PIC  X(6).
  1249         16  PI-SAV-STATE        PIC  XX.
  1250         16  PI-SAV-EXP-DT       PIC  XX.
  1251         16  PI-UNPAID-NET-PREM  PIC S9(7)V99    COMP-3.
  1252         16  PI-COMP-UNPAID-PREM PIC S9(7)V99    COMP-3.
  1253         16  PI-BAL-FRWD         PIC S9(7)V99    COMP-3.
  1254         16  PI-PREMIUM          PIC S9(7)V99    COMP-3.
  1255         16  PI-REMITTED         PIC S9(7)V99    COMP-3.
  1256         16  PI-TOT-ISS-COMP     PIC S9(7)V99    COMP-3.
  1257         16  PI-TOT-CAN-COMP     PIC S9(7)V99    COMP-3.
  1258         16  PI-ADJUSTMNTS       PIC S9(7)V99    COMP-3.
  1259         16  PI-DISBURSED        PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL642.cbl
  1260         16  PI-END-BAL          PIC S9(7)V99    COMP-3.
  1261         16  PI-LF-ISS-COMP      PIC S9(7)V99    COMP-3.
  1262         16  PI-AH-ISS-COMP      PIC S9(7)V99    COMP-3.
  1263         16  PI-LF-CAN-COMP      PIC S9(7)V99    COMP-3.
  1264         16  PI-AH-CAN-COMP      PIC S9(7)V99    COMP-3.
  1265         16  PI-DUE-FOR-ACCT     PIC S9(7)V99    COMP-3.
  1266         16  PI-ACCT-BEG-BAL     PIC S9(7)V99    COMP-3.
  1267         16  PI-ACCT-NET-PREM    PIC S9(7)V99    COMP-3.
  1268         16  PI-ACCT-COMP        PIC S9(7)V99    COMP-3.
  1269         16  PI-ACCT-PAY-ADJS    PIC S9(7)V99    COMP-3.
  1270         16  PI-BILL-TYPE        PIC  X.
  1271             88  PI-PREV-BILL                    VALUE '1'.
  1272             88  PI-PREV-REBILL                  VALUE '2'.
  1273             88  PI-PREVIEW                      VALUE '1' '2'.
  1274             88  PI-BILL                         VALUE '3'.
  1275             88  PI-REBILLING                    VALUE '4'.
  1276             88  PI-VOID-BILL                    VALUE '5'.
  1277             88  PI-TOT-REBILL                   VALUE '2' '4'.
  1278             88  PI-UPDATE-FILES                 VALUE '3' '4'
  1279                                                       '5'.
  1280             88  PI-BILLING-FUNCTION             VALUE '1' '2'
  1281                                                       '3' '4'.
  1282         16  PI-BILL-ERRS        PIC  X.
  1283         16  PI-CHECK-SW         PIC  X.
  1284             88  PI-CHECK-PRODUCED               VALUE 'Y'.
  1285         16  PI-DATA-BILLED-SW   PIC  X.
  1286             88  PI-DATA-BILLED                  VALUE 'Y'.
  1287         16  PI-ACCT-BILLED-SW   PIC  X.
  1288             88  PI-ACCT-BILLED                  VALUE 'Y'.
  1289         16  PI-MONTH-END-DATE.
  1290             20  PI-ME-MONTH     PIC  99.
  1291             20  FILLER          PIC  X.
  1292             20  PI-ME-DAY       PIC  99.
  1293             20  FILLER          PIC  X.
  1294             20  PI-ME-YEAR      PIC  99.
  1295         16  PI-LIMIT-BILLING-ACCOUNTS.
  1296             20  PI-BILLING-ACCOUNTS     OCCURS  3  TIMES
  1297                                     PIC  X(10).
  1298         16  PI-ISSUE-INFO.
  1299             20  PI-ISSUES-BILLED    PIC S9(6) COMP-3.
  1300             20  PI-ISSUES-INER      PIC S9(6) COMP-3.
  1301             20  PI-ISSUES-PREV      PIC S9(6) COMP-3.
  1302         16  PI-CANCEL-INFO.
  1303             20  PI-CANCELS-BILLED   PIC S9(6) COMP-3.
  1304             20  PI-CANCELS-INER     PIC S9(6) COMP-3.
  1305             20  PI-CANCELS-PREV     PIC S9(6) COMP-3.
  1306         16  PI-UNKNOWN              PIC S9(6) COMP-3.
  1307         16  PI-COMP-CONTROL.
  1308             20  PI-COMP-CARRIER     PIC  X.
  1309             20  PI-COMP-GROUPING    PIC  X(6).
  1310             20  PI-COMP-FIN-RESP    PIC  X(10).
  1311         16  PI-SCRN-CONTROL.
  1312             20  PI-SCR-CARRIER      PIC  X.
  1313             20  PI-SCR-GROUPING     PIC  X(6).
  1314             20  PI-SCR-STATE        PIC  XX.
  1315             20  PI-SCR-ACCOUNT      PIC  X(10).
  1316             20  PI-SCR-FIN-RESP     PIC  X(10).
  1317             20  PI-SCR-TYPE         PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL642.cbl
  1318         16  PI-TRANSFER-SW          PIC  X.
  1319             88  PI-TRANSFER-BEFORE-ACT  VALUE 'Y'.
  1320         16  FILLER                  PIC  X(307).
  1321
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL642.cbl
  1323*                            COPY ELCJPFX.
  1324******************************************************************
  1325*                                                                *
  1326*                                                                *
  1327*                            ELCJPFX.                            *
  1328*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1329*                            VMOD=2.002                          *
  1330*                                                                *
  1331*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1332*                                                                *
  1333*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1334*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1335*        ELCNTL - CONTROL FILE                                   *
  1336*        ELMSTR - CLAIM MASTERS                                  *
  1337*        ELTRLR - ACTIVITY TRAILERS                              *
  1338*        ELCHKQ - CHECK QUE                                      *
  1339******************************************************************
  1340 01  JOURNAL-RECORD.
  1341     12  JP-USER-ID                  PIC X(4).
  1342     12  JP-FILE-ID                  PIC X(8).
  1343     12  JP-PROGRAM-ID               PIC X(8).
  1344     12  JP-RECORD-TYPE              PIC X.
  1345         88 JP-ADD              VALUE 'A'.
  1346         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1347         88 JP-AFTER-CHANGE     VALUE 'C'.
  1348         88 JP-DELETE           VALUE 'D'.
  1349         88 JP-GENERIC-DELETE   VALUE 'G'.
  1350         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1351         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1352     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1353     12  JP-RECORD-AREA
  1354
  1355
  1356                             PIC  X(1464).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL642.cbl
  1358*                            COPY ELCAID.
  1359******************************************************************
  1360*                                                                *
  1361*                            ELCAID.                             *
  1362*                            VMOD=2.001                          *
  1363*                                                                *
  1364*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1365*                                                                *
  1366*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1367*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1368******************************************************************
  1369
  1370 01  DFHAID.
  1371   02  DFHNULL   PIC  X  VALUE  ' '.
  1372   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1373   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1374   02  DFHPEN    PIC  X  VALUE  '='.
  1375   02  DFHOPID   PIC  X  VALUE  'W'.
  1376   02  DFHPA1    PIC  X  VALUE  '%'.
  1377   02  DFHPA2    PIC  X  VALUE  '>'.
  1378   02  DFHPA3    PIC  X  VALUE  ','.
  1379   02  DFHPF1    PIC  X  VALUE  '1'.
  1380   02  DFHPF2    PIC  X  VALUE  '2'.
  1381   02  DFHPF3    PIC  X  VALUE  '3'.
  1382   02  DFHPF4    PIC  X  VALUE  '4'.
  1383   02  DFHPF5    PIC  X  VALUE  '5'.
  1384   02  DFHPF6    PIC  X  VALUE  '6'.
  1385   02  DFHPF7    PIC  X  VALUE  '7'.
  1386   02  DFHPF8    PIC  X  VALUE  '8'.
  1387   02  DFHPF9    PIC  X  VALUE  '9'.
  1388   02  DFHPF10   PIC  X  VALUE  ':'.
  1389   02  DFHPF11   PIC  X  VALUE  '#'.
  1390   02  DFHPF12   PIC  X  VALUE  '@'.
  1391   02  DFHPF13   PIC  X  VALUE  'A'.
  1392   02  DFHPF14   PIC  X  VALUE  'B'.
  1393   02  DFHPF15   PIC  X  VALUE  'C'.
  1394   02  DFHPF16   PIC  X  VALUE  'D'.
  1395   02  DFHPF17   PIC  X  VALUE  'E'.
  1396   02  DFHPF18   PIC  X  VALUE  'F'.
  1397   02  DFHPF19   PIC  X  VALUE  'G'.
  1398   02  DFHPF20   PIC  X  VALUE  'H'.
  1399   02  DFHPF21   PIC  X  VALUE  'I'.
  1400*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1401   02  DFHPF22   PIC  X  VALUE  '['.
  1402   02  DFHPF23   PIC  X  VALUE  '.'.
  1403   02  DFHPF24   PIC  X  VALUE  '<'.
  1404   02  DFHMSRE   PIC  X  VALUE  'X'.
  1405   02  DFHSTRF   PIC  X  VALUE  'h'.
  1406   02  DFHTRIG   PIC  X  VALUE  '"'.
  1407
  1408 01  FILLER  REDEFINES  DFHAID.
  1409     12  FILLER              PIC  X(8).
  1410     12  PF-VALUES           PIC  X      OCCURS  2  TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL642.cbl
  1412*                            COPY EL642S.
  1413 01  EL642AI.
  1414     05  FILLER            PIC  X(0012).
  1415*    -------------------------------
  1416     05  ADATEL PIC S9(0004) COMP.
  1417     05  ADATEF PIC  X(0001).
  1418     05  FILLER REDEFINES ADATEF.
  1419         10  ADATEA PIC  X(0001).
  1420     05  ADATEI PIC  X(0008).
  1421*    -------------------------------
  1422     05  ATIMEL PIC S9(0004) COMP.
  1423     05  ATIMEF PIC  X(0001).
  1424     05  FILLER REDEFINES ATIMEF.
  1425         10  ATIMEA PIC  X(0001).
  1426     05  ATIMEI PIC  X(0005).
  1427*    -------------------------------
  1428     05  CMPNYIDL PIC S9(0004) COMP.
  1429     05  CMPNYIDF PIC  X(0001).
  1430     05  FILLER REDEFINES CMPNYIDF.
  1431         10  CMPNYIDA PIC  X(0001).
  1432     05  CMPNYIDI PIC  X(0003).
  1433*    -------------------------------
  1434     05  USERIDL PIC S9(0004) COMP.
  1435     05  USERIDF PIC  X(0001).
  1436     05  FILLER REDEFINES USERIDF.
  1437         10  USERIDA PIC  X(0001).
  1438     05  USERIDI PIC  X(0004).
  1439*    -------------------------------
  1440     05  ABEGBALL PIC S9(0004) COMP.
  1441     05  ABEGBALF PIC  X(0001).
  1442     05  FILLER REDEFINES ABEGBALF.
  1443         10  ABEGBALA PIC  X(0001).
  1444     05  ABEGBALI PIC  X(0010).
  1445*    -------------------------------
  1446     05  ACARHDGL PIC S9(0004) COMP.
  1447     05  ACARHDGF PIC  X(0001).
  1448     05  FILLER REDEFINES ACARHDGF.
  1449         10  ACARHDGA PIC  X(0001).
  1450     05  ACARHDGI PIC  X(0007).
  1451*    -------------------------------
  1452     05  AGRPHDGL PIC S9(0004) COMP.
  1453     05  AGRPHDGF PIC  X(0001).
  1454     05  FILLER REDEFINES AGRPHDGF.
  1455         10  AGRPHDGA PIC  X(0001).
  1456     05  AGRPHDGI PIC  X(0005).
  1457*    -------------------------------
  1458     05  AUPDPRML PIC S9(0004) COMP.
  1459     05  AUPDPRMF PIC  X(0001).
  1460     05  FILLER REDEFINES AUPDPRMF.
  1461         10  AUPDPRMA PIC  X(0001).
  1462     05  AUPDPRMI PIC  X(0010).
  1463*    -------------------------------
  1464     05  AAGENTL PIC S9(0004) COMP.
  1465     05  AAGENTF PIC  X(0001).
  1466     05  FILLER REDEFINES AAGENTF.
  1467         10  AAGENTA PIC  X(0001).
  1468     05  AAGENTI PIC  X(0010).
  1469*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL642.cbl
  1470     05  ACARIERL PIC S9(0004) COMP.
  1471     05  ACARIERF PIC  X(0001).
  1472     05  FILLER REDEFINES ACARIERF.
  1473         10  ACARIERA PIC  X(0001).
  1474     05  ACARIERI PIC  X(0001).
  1475*    -------------------------------
  1476     05  AGROUPL PIC S9(0004) COMP.
  1477     05  AGROUPF PIC  X(0001).
  1478     05  FILLER REDEFINES AGROUPF.
  1479         10  AGROUPA PIC  X(0001).
  1480     05  AGROUPI PIC  X(0006).
  1481*    -------------------------------
  1482     05  AUPDCOML PIC S9(0004) COMP.
  1483     05  AUPDCOMF PIC  X(0001).
  1484     05  FILLER REDEFINES AUPDCOMF.
  1485         10  AUPDCOMA PIC  X(0001).
  1486     05  AUPDCOMI PIC  X(0010).
  1487*    -------------------------------
  1488     05  APREMUML PIC S9(0004) COMP.
  1489     05  APREMUMF PIC  X(0001).
  1490     05  FILLER REDEFINES APREMUMF.
  1491         10  APREMUMA PIC  X(0001).
  1492     05  APREMUMI PIC  X(0010).
  1493*    -------------------------------
  1494     05  ACOMPISL PIC S9(0004) COMP.
  1495     05  ACOMPISF PIC  X(0001).
  1496     05  FILLER REDEFINES ACOMPISF.
  1497         10  ACOMPISA PIC  X(0001).
  1498     05  ACOMPISI PIC  X(0010).
  1499*    -------------------------------
  1500     05  ACOMCANL PIC S9(0004) COMP.
  1501     05  ACOMCANF PIC  X(0001).
  1502     05  FILLER REDEFINES ACOMCANF.
  1503         10  ACOMCANA PIC  X(0001).
  1504     05  ACOMCANI PIC  X(0010).
  1505*    -------------------------------
  1506     05  ABILL1L PIC S9(0004) COMP.
  1507     05  ABILL1F PIC  X(0001).
  1508     05  FILLER REDEFINES ABILL1F.
  1509         10  ABILL1A PIC  X(0001).
  1510     05  ABILL1I PIC  X(0005).
  1511*    -------------------------------
  1512     05  AINER1L PIC S9(0004) COMP.
  1513     05  AINER1F PIC  X(0001).
  1514     05  FILLER REDEFINES AINER1F.
  1515         10  AINER1A PIC  X(0001).
  1516     05  AINER1I PIC  X(0005).
  1517*    -------------------------------
  1518     05  APRVBL1L PIC S9(0004) COMP.
  1519     05  APRVBL1F PIC  X(0001).
  1520     05  FILLER REDEFINES APRVBL1F.
  1521         10  APRVBL1A PIC  X(0001).
  1522     05  APRVBL1I PIC  X(0005).
  1523*    -------------------------------
  1524     05  AADJUSTL PIC S9(0004) COMP.
  1525     05  AADJUSTF PIC  X(0001).
  1526     05  FILLER REDEFINES AADJUSTF.
  1527         10  AADJUSTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL642.cbl
  1528     05  AADJUSTI PIC  X(0010).
  1529*    -------------------------------
  1530     05  ABILL2L PIC S9(0004) COMP.
  1531     05  ABILL2F PIC  X(0001).
  1532     05  FILLER REDEFINES ABILL2F.
  1533         10  ABILL2A PIC  X(0001).
  1534     05  ABILL2I PIC  X(0005).
  1535*    -------------------------------
  1536     05  AINER2L PIC S9(0004) COMP.
  1537     05  AINER2F PIC  X(0001).
  1538     05  FILLER REDEFINES AINER2F.
  1539         10  AINER2A PIC  X(0001).
  1540     05  AINER2I PIC  X(0005).
  1541*    -------------------------------
  1542     05  APRVBL2L PIC S9(0004) COMP.
  1543     05  APRVBL2F PIC  X(0001).
  1544     05  FILLER REDEFINES APRVBL2F.
  1545         10  APRVBL2A PIC  X(0001).
  1546     05  APRVBL2I PIC  X(0005).
  1547*    -------------------------------
  1548     05  AREMITL PIC S9(0004) COMP.
  1549     05  AREMITF PIC  X(0001).
  1550     05  FILLER REDEFINES AREMITF.
  1551         10  AREMITA PIC  X(0001).
  1552     05  AREMITI PIC  X(0010).
  1553*    -------------------------------
  1554     05  ADISBURL PIC S9(0004) COMP.
  1555     05  ADISBURF PIC  X(0001).
  1556     05  FILLER REDEFINES ADISBURF.
  1557         10  ADISBURA PIC  X(0001).
  1558     05  ADISBURI PIC  X(0010).
  1559*    -------------------------------
  1560     05  AACTHDGL PIC S9(0004) COMP.
  1561     05  AACTHDGF PIC  X(0001).
  1562     05  FILLER REDEFINES AACTHDGF.
  1563         10  AACTHDGA PIC  X(0001).
  1564     05  AACTHDGI PIC  X(0029).
  1565*    -------------------------------
  1566     05  AACTDUEL PIC S9(0004) COMP.
  1567     05  AACTDUEF PIC  X(0001).
  1568     05  FILLER REDEFINES AACTDUEF.
  1569         10  AACTDUEA PIC  X(0001).
  1570     05  AACTDUEI PIC  X(0010).
  1571*    -------------------------------
  1572     05  AENDHDGL PIC S9(0004) COMP.
  1573     05  AENDHDGF PIC  X(0001).
  1574     05  FILLER REDEFINES AENDHDGF.
  1575         10  AENDHDGA PIC  X(0001).
  1576     05  AENDHDGI PIC  X(0018).
  1577*    -------------------------------
  1578     05  ANETDUEL PIC S9(0004) COMP.
  1579     05  ANETDUEF PIC  X(0001).
  1580     05  FILLER REDEFINES ANETDUEF.
  1581         10  ANETDUEA PIC  X(0001).
  1582     05  ANETDUEI PIC  X(0010).
  1583*    -------------------------------
  1584     05  ABILTYPL PIC S9(0004) COMP.
  1585     05  ABILTYPF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL642.cbl
  1586     05  FILLER REDEFINES ABILTYPF.
  1587         10  ABILTYPA PIC  X(0001).
  1588     05  ABILTYPI PIC  X(0001).
  1589*    -------------------------------
  1590     05  APRODSWL PIC S9(0004) COMP.
  1591     05  APRODSWF PIC  X(0001).
  1592     05  FILLER REDEFINES APRODSWF.
  1593         10  APRODSWA PIC  X(0001).
  1594     05  APRODSWI PIC  X(0001).
  1595*    -------------------------------
  1596     05  AACCT1L PIC S9(0004) COMP.
  1597     05  AACCT1F PIC  X(0001).
  1598     05  FILLER REDEFINES AACCT1F.
  1599         10  AACCT1A PIC  X(0001).
  1600     05  AACCT1I PIC  X(0010).
  1601*    -------------------------------
  1602     05  AACCT2L PIC S9(0004) COMP.
  1603     05  AACCT2F PIC  X(0001).
  1604     05  FILLER REDEFINES AACCT2F.
  1605         10  AACCT2A PIC  X(0001).
  1606     05  AACCT2I PIC  X(0010).
  1607*    -------------------------------
  1608     05  AACCT3L PIC S9(0004) COMP.
  1609     05  AACCT3F PIC  X(0001).
  1610     05  FILLER REDEFINES AACCT3F.
  1611         10  AACCT3A PIC  X(0001).
  1612     05  AACCT3I PIC  X(0010).
  1613*    -------------------------------
  1614     05  AUNKNERL PIC S9(0004) COMP.
  1615     05  AUNKNERF PIC  X(0001).
  1616     05  FILLER REDEFINES AUNKNERF.
  1617         10  AUNKNERA PIC  X(0001).
  1618     05  AUNKNERI PIC  X(0008).
  1619*    -------------------------------
  1620     05  AERMSG1L PIC S9(0004) COMP.
  1621     05  AERMSG1F PIC  X(0001).
  1622     05  FILLER REDEFINES AERMSG1F.
  1623         10  AERMSG1A PIC  X(0001).
  1624     05  AERMSG1I PIC  X(0076).
  1625*    -------------------------------
  1626     05  AERMSG2L PIC S9(0004) COMP.
  1627     05  AERMSG2F PIC  X(0001).
  1628     05  FILLER REDEFINES AERMSG2F.
  1629         10  AERMSG2A PIC  X(0001).
  1630     05  AERMSG2I PIC  X(0076).
  1631*    -------------------------------
  1632     05  APFNTERL PIC S9(0004) COMP.
  1633     05  APFNTERF PIC  X(0001).
  1634     05  FILLER REDEFINES APFNTERF.
  1635         10  APFNTERA PIC  X(0001).
  1636     05  APFNTERI PIC  9(2).
  1637 01  EL642AO REDEFINES EL642AI.
  1638     05  FILLER            PIC  X(0012).
  1639*    -------------------------------
  1640     05  FILLER            PIC  X(0003).
  1641     05  ADATEO PIC  X(0008).
  1642*    -------------------------------
  1643     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL642.cbl
  1644     05  ATIMEO PIC  99.99.
  1645*    -------------------------------
  1646     05  FILLER            PIC  X(0003).
  1647     05  CMPNYIDO PIC  X(0003).
  1648*    -------------------------------
  1649     05  FILLER            PIC  X(0003).
  1650     05  USERIDO PIC  X(0004).
  1651*    -------------------------------
  1652     05  FILLER            PIC  X(0003).
  1653     05  ABEGBALO PIC  ZZZZZ9.99-.
  1654*    -------------------------------
  1655     05  FILLER            PIC  X(0003).
  1656     05  ACARHDGO PIC  X(0007).
  1657*    -------------------------------
  1658     05  FILLER            PIC  X(0003).
  1659     05  AGRPHDGO PIC  X(0005).
  1660*    -------------------------------
  1661     05  FILLER            PIC  X(0003).
  1662     05  AUPDPRMO PIC  ZZZZZ9.99-.
  1663*    -------------------------------
  1664     05  FILLER            PIC  X(0003).
  1665     05  AAGENTO PIC  X(0010).
  1666*    -------------------------------
  1667     05  FILLER            PIC  X(0003).
  1668     05  ACARIERO PIC  X(0001).
  1669*    -------------------------------
  1670     05  FILLER            PIC  X(0003).
  1671     05  AGROUPO PIC  X(0006).
  1672*    -------------------------------
  1673     05  FILLER            PIC  X(0003).
  1674     05  AUPDCOMO PIC  ZZZZZ9.99-.
  1675*    -------------------------------
  1676     05  FILLER            PIC  X(0003).
  1677     05  APREMUMO PIC  ZZZZZ9.99-.
  1678*    -------------------------------
  1679     05  FILLER            PIC  X(0003).
  1680     05  ACOMPISO PIC  ZZZZZ9.99-.
  1681*    -------------------------------
  1682     05  FILLER            PIC  X(0003).
  1683     05  ACOMCANO PIC  ZZZZZ9.99-.
  1684*    -------------------------------
  1685     05  FILLER            PIC  X(0003).
  1686     05  ABILL1O PIC  Z,ZZZ.
  1687*    -------------------------------
  1688     05  FILLER            PIC  X(0003).
  1689     05  AINER1O PIC  Z,ZZZ.
  1690*    -------------------------------
  1691     05  FILLER            PIC  X(0003).
  1692     05  APRVBL1O PIC  Z,ZZZ.
  1693*    -------------------------------
  1694     05  FILLER            PIC  X(0003).
  1695     05  AADJUSTO PIC  ZZZZZ9.99-.
  1696*    -------------------------------
  1697     05  FILLER            PIC  X(0003).
  1698     05  ABILL2O PIC  Z,ZZZ.
  1699*    -------------------------------
  1700     05  FILLER            PIC  X(0003).
  1701     05  AINER2O PIC  Z,ZZZ.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL642.cbl
  1702*    -------------------------------
  1703     05  FILLER            PIC  X(0003).
  1704     05  APRVBL2O PIC  Z,ZZZ.
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  AREMITO PIC  ZZZZZ9.99-.
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  ADISBURO PIC  ZZZZZ9.99-.
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  AACTHDGO PIC  X(0029).
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  AACTDUEO PIC  ZZZZZ9.99-.
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  AENDHDGO PIC  X(0018).
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
  1722     05  ANETDUEO PIC  ZZZZZ9.99-.
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  ABILTYPO PIC  X(0001).
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
  1728     05  APRODSWO PIC  X(0001).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  AACCT1O PIC  X(0010).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  AACCT2O PIC  X(0010).
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  AACCT3O PIC  X(0010).
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  AUNKNERO PIC  ZZZ,ZZZ-.
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  AERMSG1O PIC  X(0076).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  AERMSG2O PIC  X(0076).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  APFNTERO PIC  99.
  1750*    -------------------------------
  1751 01  EL642BI REDEFINES EL642AI.
  1752     05  FILLER            PIC  X(0012).
  1753*    -------------------------------
  1754     05  BDATEL PIC S9(0004) COMP.
  1755     05  BDATEF PIC  X(0001).
  1756     05  FILLER REDEFINES BDATEF.
  1757         10  BDATEA PIC  X(0001).
  1758     05  BDATEI PIC  X(0008).
  1759*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL642.cbl
  1760     05  BTIMEL PIC S9(0004) COMP.
  1761     05  BTIMEF PIC  X(0001).
  1762     05  FILLER REDEFINES BTIMEF.
  1763         10  BTIMEA PIC  X(0001).
  1764     05  BTIMEI PIC  X(0005).
  1765*    -------------------------------
  1766     05  BCMPNYL PIC S9(0004) COMP.
  1767     05  BCMPNYF PIC  X(0001).
  1768     05  FILLER REDEFINES BCMPNYF.
  1769         10  BCMPNYA PIC  X(0001).
  1770     05  BCMPNYI PIC  X(0003).
  1771*    -------------------------------
  1772     05  BUSERIDL PIC S9(0004) COMP.
  1773     05  BUSERIDF PIC  X(0001).
  1774     05  FILLER REDEFINES BUSERIDF.
  1775         10  BUSERIDA PIC  X(0001).
  1776     05  BUSERIDI PIC  X(0004).
  1777*    -------------------------------
  1778     05  BCHKNOL PIC S9(0004) COMP.
  1779     05  BCHKNOF PIC  X(0001).
  1780     05  FILLER REDEFINES BCHKNOF.
  1781         10  BCHKNOA PIC  X(0001).
  1782     05  BCHKNOI PIC  9(6).
  1783*    -------------------------------
  1784     05  BNAMEL PIC S9(0004) COMP.
  1785     05  BNAMEF PIC  X(0001).
  1786     05  FILLER REDEFINES BNAMEF.
  1787         10  BNAMEA PIC  X(0001).
  1788     05  BNAMEI PIC  X(0029).
  1789*    -------------------------------
  1790     05  BCHKAMTL PIC S9(0004) COMP.
  1791     05  BCHKAMTF PIC  X(0001).
  1792     05  FILLER REDEFINES BCHKAMTF.
  1793         10  BCHKAMTA PIC  X(0001).
  1794     05  BCHKAMTI PIC  9(7)V99.
  1795*    -------------------------------
  1796     05  BADDR1L PIC S9(0004) COMP.
  1797     05  BADDR1F PIC  X(0001).
  1798     05  FILLER REDEFINES BADDR1F.
  1799         10  BADDR1A PIC  X(0001).
  1800     05  BADDR1I PIC  X(0029).
  1801*    -------------------------------
  1802     05  BADDR2L PIC S9(0004) COMP.
  1803     05  BADDR2F PIC  X(0001).
  1804     05  FILLER REDEFINES BADDR2F.
  1805         10  BADDR2A PIC  X(0001).
  1806     05  BADDR2I PIC  X(0029).
  1807*    -------------------------------
  1808     05  BPAYDT1L PIC S9(0004) COMP.
  1809     05  BPAYDT1F PIC  X(0001).
  1810     05  FILLER REDEFINES BPAYDT1F.
  1811         10  BPAYDT1A PIC  X(0001).
  1812     05  BPAYDT1I PIC  X(0008).
  1813*    -------------------------------
  1814     05  BCITYSTL PIC S9(0004) COMP.
  1815     05  BCITYSTF PIC  X(0001).
  1816     05  FILLER REDEFINES BCITYSTF.
  1817         10  BCITYSTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL642.cbl
  1818     05  BCITYSTI PIC  X(0029).
  1819*    -------------------------------
  1820     05  BPAYDT2L PIC S9(0004) COMP.
  1821     05  BPAYDT2F PIC  X(0001).
  1822     05  FILLER REDEFINES BPAYDT2F.
  1823         10  BPAYDT2A PIC  X(0001).
  1824     05  BPAYDT2I PIC  X(0008).
  1825*    -------------------------------
  1826     05  BZIPL PIC S9(0004) COMP.
  1827     05  BZIPF PIC  X(0001).
  1828     05  FILLER REDEFINES BZIPF.
  1829         10  BZIPA PIC  X(0001).
  1830     05  BZIPI PIC  X(0009).
  1831*    -------------------------------
  1832     05  BALAMTL PIC S9(0004) COMP.
  1833     05  BALAMTF PIC  X(0001).
  1834     05  FILLER REDEFINES BALAMTF.
  1835         10  BALAMTA PIC  X(0001).
  1836     05  BALAMTI PIC  X(0010).
  1837*    -------------------------------
  1838     05  BERMSGL PIC S9(0004) COMP.
  1839     05  BERMSGF PIC  X(0001).
  1840     05  FILLER REDEFINES BERMSGF.
  1841         10  BERMSGA PIC  X(0001).
  1842     05  BERMSGI PIC  X(0078).
  1843*    -------------------------------
  1844     05  BPFNTERL PIC S9(0004) COMP.
  1845     05  BPFNTERF PIC  X(0001).
  1846     05  FILLER REDEFINES BPFNTERF.
  1847         10  BPFNTERA PIC  X(0001).
  1848     05  BPFNTERI PIC  9(2).
  1849 01  EL642BO REDEFINES EL642AI.
  1850     05  FILLER            PIC  X(0012).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  BDATEO PIC  X(0008).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  BTIMEO PIC  99.99.
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  BCMPNYO PIC  X(0003).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  BUSERIDO PIC  X(0004).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  BCHKNOO PIC  X(0006).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  BNAMEO PIC  X(0029).
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  BCHKAMTO PIC  Z(6).99.
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  BADDR1O PIC  X(0029).
  1875*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL642.cbl
  1876     05  FILLER            PIC  X(0003).
  1877     05  BADDR2O PIC  X(0029).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  BPAYDT1O PIC  X(0008).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  BCITYSTO PIC  X(0029).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  BPAYDT2O PIC  X(0008).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  BZIPO PIC  X(0009).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  BALAMTO PIC  Z(6).99-.
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  BERMSGO PIC  X(0078).
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  BPFNTERO PIC  9(2).
  1899*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL642.cbl
  1901****************************************************************
  1902*
  1903* Copyright (c) 2007 by Clerity Solutions, Inc.
  1904* All rights reserved.
  1905*
  1906****************************************************************
  1907 01  DFHEIV.
  1908   02  DFHEIV0               PIC X(35).
  1909   02  DFHEIV1               PIC X(08).
  1910   02  DFHEIV2               PIC X(08).
  1911   02  DFHEIV3               PIC X(08).
  1912   02  DFHEIV4               PIC X(06).
  1913   02  DFHEIV5               PIC X(04).
  1914   02  DFHEIV6               PIC X(04).
  1915   02  DFHEIV7               PIC X(02).
  1916   02  DFHEIV8               PIC X(02).
  1917   02  DFHEIV9               PIC X(01).
  1918   02  DFHEIV10              PIC S9(7) COMP-3.
  1919   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1920   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1921   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1922   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1923   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1924   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1925   02  DFHEIV17              PIC X(04).
  1926   02  DFHEIV18              PIC X(04).
  1927   02  DFHEIV19              PIC X(04).
  1928   02  DFHEIV20              USAGE IS POINTER.
  1929   02  DFHEIV21              USAGE IS POINTER.
  1930   02  DFHEIV22              USAGE IS POINTER.
  1931   02  DFHEIV23              USAGE IS POINTER.
  1932   02  DFHEIV24              USAGE IS POINTER.
  1933   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1934   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1935   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1936   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1937   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1938   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1939   02  FILLER                PIC X(02).
  1940   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1941   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1942   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1943   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1944   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1945 LINKAGE  SECTION.
  1946*****************************************************************
  1947*                                                               *
  1948* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1949* All rights reserved.                                          *
  1950*                                                               *
  1951*****************************************************************
  1952 01  dfheiblk.
  1953     02  eibtime          pic s9(7) comp-3.
  1954     02  eibdate          pic s9(7) comp-3.
  1955     02  eibtrnid         pic x(4).
  1956     02  eibtaskn         pic s9(7) comp-3.
  1957     02  eibtrmid         pic x(4).
  1958     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL642.cbl
  1959     02  eibcposn         pic s9(4) comp.
  1960     02  eibcalen         pic s9(4) comp.
  1961     02  eibaid           pic x(1).
  1962     02  eibfiller1       pic x(1).
  1963     02  eibfn            pic x(2).
  1964     02  eibfiller2       pic x(2).
  1965     02  eibrcode         pic x(6).
  1966     02  eibfiller3       pic x(2).
  1967     02  eibds            pic x(8).
  1968     02  eibreqid         pic x(8).
  1969     02  eibrsrce         pic x(8).
  1970     02  eibsync          pic x(1).
  1971     02  eibfree          pic x(1).
  1972     02  eibrecv          pic x(1).
  1973     02  eibsend          pic x(1).
  1974     02  eibatt           pic x(1).
  1975     02  eibeoc           pic x(1).
  1976     02  eibfmh           pic x(1).
  1977     02  eibcompl         pic x(1).
  1978     02  eibsig           pic x(1).
  1979     02  eibconf          pic x(1).
  1980     02  eiberr           pic x(1).
  1981     02  eibrldbk         pic x(1).
  1982     02  eiberrcd         pic x(4).
  1983     02  eibsynrb         pic x(1).
  1984     02  eibnodat         pic x(1).
  1985     02  eibfiller5       pic x(2).
  1986     02  eibresp          pic 9(09) comp.
  1987     02  eibresp2         pic 9(09) comp.
  1988     02  dfheigdj         pic s9(4) comp.
  1989     02  dfheigdk         pic s9(4) comp.
  1990
  1991 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL642.cbl
  1993*01 PARMLIST             COMP.
  1994*    12  FILLER              PIC S9(8).
  1995*    12  ERPNDB-POINTER      PIC S9(8).
  1996*    12  ELCNTL-POINTER      PIC S9(8).
  1997*    12  ERCOMP-POINTER      PIC S9(8).
  1998*    12  ERPYAJ-POINTER      PIC S9(8).
  1999*    12  ERACCT-POINTER      PIC S9(8).
  2000*    12  ERBILL-POINTER      PIC S9(8).
  2001*    12  ERCOMM-POINTER      PIC S9(8).
  2002*    12  ERCTBL-POINTER      PIC S9(8).
  2003*    12  ERGXRF-POINTER      PIC S9(8).
  2004*    12  ERGXRF2-POINTER     PIC S9(8).
  2005*    12  ERGXRF3-POINTER     PIC S9(8).
  2006*    12  ERGXRF4-POINTER     PIC S9(8).
  2007*    12  ERGXRF5-POINTER     PIC S9(8).
  2008*    12  ERGXRF6-POINTER     PIC S9(8).
  2009*    12  ERGXRF7-POINTER     PIC S9(8).
  2010*    12  ERGXRF8-POINTER     PIC S9(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL642.cbl
  2012*                            COPY ERCPNDB.
  2013******************************************************************
  2014*                                                                *
  2015*                                                                *
  2016*                            ERCPNDB.                            *
  2017*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2018*                            VMOD=2.025                          *
  2019*                                                                *
  2020*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2021*                                                                *
  2022******************************************************************
  2023*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2024*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2025******************************************************************
  2026*                                                                *
  2027*                                                                *
  2028*   FILE TYPE = VSAM,KSDS                                        *
  2029*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2030*                                                                *
  2031*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2032*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2033*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2034*                                                 RKP=13,LEN=36  *
  2035*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2036*                                      AND CHG-SEQ.)             *
  2037*                                                RKP=49,LEN=11   *
  2038*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2039*                                      AND CHG-SEQ.)             *
  2040*                                                RKP=60,LEN=15   *
  2041*                                                                *
  2042*   LOG = NO                                                     *
  2043*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2044******************************************************************
  2045******************************************************************
  2046*                   C H A N G E   L O G
  2047*
  2048* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2049*-----------------------------------------------------------------
  2050*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2051* EFFECTIVE    NUMBER
  2052*-----------------------------------------------------------------
  2053* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2054* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2055* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2056* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2057* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2058* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2059* 032306                   PEMA  ADD BOW LOAN NUMBER
  2060* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2061* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2062* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2063* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2064* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2065* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2066* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2067******************************************************************
  2068
  2069 01  PENDING-BUSINESS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL642.cbl
  2070     12  PB-RECORD-ID                     PIC XX.
  2071         88  VALID-PB-ID                        VALUE 'PB'.
  2072
  2073     12  PB-CONTROL-PRIMARY.
  2074         16  PB-COMPANY-CD                PIC X.
  2075         16  PB-ENTRY-BATCH               PIC X(6).
  2076         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  2077         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  2078
  2079     12  PB-CONTROL-BY-ACCOUNT.
  2080         16  PB-COMPANY-CD-A1             PIC X.
  2081         16  PB-CARRIER                   PIC X.
  2082         16  PB-GROUPING.
  2083             20  PB-GROUPING-PREFIX       PIC XXX.
  2084             20  PB-GROUPING-PRIME        PIC XXX.
  2085         16  PB-STATE                     PIC XX.
  2086         16  PB-ACCOUNT.
  2087             20  PB-ACCOUNT-PREFIX        PIC X(4).
  2088             20  PB-ACCOUNT-PRIME         PIC X(6).
  2089         16  PB-CERT-EFF-DT               PIC XX.
  2090         16  PB-CERT-NO.
  2091             20  PB-CERT-PRIME            PIC X(10).
  2092             20  PB-CERT-SFX              PIC X.
  2093         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  2094
  2095         16  PB-RECORD-TYPE               PIC X.
  2096             88  PB-MAILING-DATA                VALUE '0'.
  2097             88  PB-ISSUE                       VALUE '1'.
  2098             88  PB-CANCELLATION                VALUE '2'.
  2099             88  PB-BATCH-TRAILER               VALUE '9'.
  2100
  2101     12  PB-CONTROL-BY-ORIG-BATCH.
  2102         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  2103         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  2104         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  2105         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  2106
  2107     12  PB-CONTROL-BY-CSR.
  2108         16  PB-CSR-COMPANY-CD            PIC X.
  2109         16  PB-CSR-ID                    PIC X(4).
  2110         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  2111         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  2112         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  2113******************************************************************
  2114*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  2115******************************************************************
  2116
  2117     12  PB-LAST-MAINT-DT                 PIC XX.
  2118     12  PB-LAST-MAINT-BY                 PIC X(4).
  2119     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2120
  2121     12  PB-RECORD-BODY                   PIC X(375).
  2122
  2123     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  2124         16  PB-CERT-ORIGIN               PIC X.
  2125             88  CLASIC-CREATED-CERT         VALUE '1'.
  2126         16  PB-I-NAME.
  2127             20  PB-I-INSURED-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL642.cbl
  2128             20  PB-I-INSURED-FIRST-NAME.
  2129                 24  PB-I-INSURED-1ST-INIT PIC X.
  2130                 24  FILLER                PIC X(9).
  2131             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  2132         16  PB-I-AGE                     PIC S99   COMP-3.
  2133         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  2134         16  PB-I-BIRTHDAY                PIC XX.
  2135         16  PB-I-INSURED-SEX             PIC X.
  2136             88  PB-SEX-MALE     VALUE 'M'.
  2137             88  PB-SEX-FEMALE   VALUE 'F'.
  2138
  2139         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  2140         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  2141         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  2142         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  2143         16  PB-I-SKIP-CODE               PIC X.
  2144             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  2145             88  PB-SKIP-JULY              VALUE '1'.
  2146             88  PB-SKIP-AUGUST            VALUE '2'.
  2147             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  2148             88  PB-SKIP-JULY-AUG          VALUE '4'.
  2149             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  2150             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  2151             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  2152             88  PB-SKIP-JUNE              VALUE '8'.
  2153             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  2154             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  2155             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  2156         16  PB-I-TERM-TYPE               PIC X.
  2157             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  2158             88  PB-PAID-WEEKLY            VALUE 'W'.
  2159             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  2160             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  2161             88  PB-PAID-13-YEARLY         VALUE 'T'.
  2162         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  2163         16  PB-I-POLICY-FORM-NO          PIC X(12).
  2164         16  PB-I-DATA-ENTRY-SW           PIC X.
  2165             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  2166             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  2167             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  2168             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  2169         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  2170         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  2171*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  2172         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  2173         16  FILLER                       PIC X.
  2174
  2175         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  2176             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  2177             88  PB-INVALID-LIFE             VALUE '  ' '00'
  2178                                                   '90' THRU '99'.
  2179         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  2180                                          PIC XX.
  2181         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2182         16  PB-I-AMOUNT-FINANCED REDEFINES
  2183                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  2184         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  2185         16  PB-I-UNPAID-CASH-PRICE REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL642.cbl
  2186                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  2187         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2188         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  2189         16  PB-I-CLP-AMOUNT REDEFINES
  2190                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2191         16  PB-I-LF-CALC-FLAG            PIC X.
  2192             88 PB-COMP-LF-PREM               VALUE '?'.
  2193         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2194         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2195         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2196         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2197         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2198         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2199         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2200         16  PB-I-LF-ABBR                 PIC XXX.
  2201         16  PB-I-LF-INPUT-CD             PIC XX.
  2202
  2203         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2204             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2205             88  PB-INVALID-AH               VALUE '  ' '00'
  2206                                                   '90' THRU '99'.
  2207         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2208         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2209         16  PB-I-AH-CALC-FLAG            PIC X.
  2210             88 PB-COMP-AH-PREM                  VALUE '?'.
  2211         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2212         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2213         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2214         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2215         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2216         16  PB-I-AH-ABBR                 PIC XXX.
  2217         16  PB-I-AH-INPUT-CD             PIC XXX.
  2218
  2219         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2220         16  PB-I-REIN-TABLE              PIC XXX.
  2221         16  PB-I-BUSINESS-TYPE           PIC 99.
  2222         16  PB-I-INDV-GRP-CD             PIC X.
  2223         16  PB-I-MORT-CODE.
  2224             20  PB-I-TABLE               PIC X.
  2225             20  PB-I-INTEREST            PIC XX.
  2226             20  PB-I-MORT-TYP            PIC X.
  2227         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2228         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2229         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2230         16  PB-I-INDV-GRP-OVRD           PIC X.
  2231         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2232         16  PB-I-SIG-SW                  PIC X.
  2233             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2234         16  PB-I-RATE-CLASS              PIC XX.
  2235         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2236         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2237         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2238         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2239         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2240         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2241         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  2242         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2243         16  PB-I-OB-FLAG                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL642.cbl
  2244             88  PB-I-OB                      VALUE 'B'.
  2245             88  PB-I-SUMMARY                 VALUE 'Z'.
  2246         16  PB-I-ENTRY-STATUS            PIC X.
  2247             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2248                                              'M' '5' '9' '2'.
  2249             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2250             88  PB-I-POLICY-PENDING          VALUE '2'.
  2251             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2252             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2253             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2254             88  PB-I-REIN-ONLY               VALUE '9'.
  2255             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2256             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2257             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2258             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2259         16  PB-I-INT-CODE                PIC X.
  2260             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2261             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2262         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2263         16  PB-I-SOC-SEC-NO              PIC X(11).
  2264         16  PB-I-MEMBER-NO               PIC X(12).
  2265         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2266*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2267         16  PB-I-OLD-LOF                 PIC XXX.
  2268         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2269         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2270         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2271         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2272         16  PB-I-LIFE-INDICATOR          PIC X.
  2273             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2274         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2275         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2276             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2277             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2278         16  PB-I-1ST-PMT-DT              PIC XX.
  2279         16  PB-I-JOINT-INSURED.
  2280             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2281             20 PB-I-JOINT-FIRST-NAME.
  2282                24  PB-I-JOINT-FIRST-INIT PIC X.
  2283                24  FILLER                PIC X(9).
  2284             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2285*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2286         16  PB-I-BENEFICIARY-NAME.
  2287             20  PB-I-BANK-NUMBER         PIC X(10).
  2288             20  FILLER                   PIC X(15).
  2289         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2290         16  PB-I-REFERENCE               PIC X(12).
  2291         16  FILLER REDEFINES PB-I-REFERENCE.
  2292             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2293             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2294             20  PB-I-CLP-STATE           PIC XX.
  2295         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2296             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2297             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  2298             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2299         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2300         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2301         16  PB-I-RESIDENT-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL642.cbl
  2302         16  PB-I-RATE-CODE               PIC X(4).
  2303         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2304         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2305         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2306         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2307         16  PB-I-BANK-NOCHRGB            PIC 99.
  2308         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2309         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2310
  2311     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2312         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2313             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2314         16  PB-C-CANCEL-ORIGIN           PIC X.
  2315             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2316         16  PB-C-LF-CANCEL-DT            PIC XX.
  2317         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2318         16  PB-C-LF-CALC-REQ             PIC X.
  2319             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2320         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2321         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2322         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2323             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2324         16  PB-C-AH-CANCEL-DT            PIC XX.
  2325         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2326         16  PB-C-AH-CALC-REQ             PIC X.
  2327             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2328         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2329         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2330         16  PB-C-LAST-NAME               PIC X(15).
  2331         16  PB-C-REFUND-SW               PIC X.
  2332             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2333             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2334         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2335         16  PB-C-PAYEE-CODE              PIC X(6).
  2336         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2337         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2338         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2339         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2340         16  PB-C-REFERENCE               PIC X(12).
  2341         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2342         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2343         16  PB-C-POST-CARD-IND           PIC X.
  2344         16  PB-C-CANCEL-REASON           PIC X.
  2345         16  PB-C-REF-INTERFACE-SW        PIC X.
  2346         16  FILLER                       PIC X(09).
  2347*        16  FILLER                       PIC X(18).
  2348         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2349*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2350         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2351         16  PB-CANCELED-CERT-DATA.
  2352             20  PB-CI-INSURED-NAME.
  2353                 24  PB-CI-LAST-NAME      PIC X(15).
  2354                 24  PB-CI-INITIALS       PIC XX.
  2355             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2356             20  PB-CI-INSURED-SEX        PIC X.
  2357             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2358             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2359             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL642.cbl
  2360             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2361             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2362             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2363             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2364             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2365             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2366             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2367             20  PB-CI-RATE-CLASS         PIC XX.
  2368             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2369             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2370             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2371             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2372             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2373             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2374             20  PB-CI-LF-ABBR            PIC X(3).
  2375             20  PB-CI-AH-ABBR            PIC X(3).
  2376             20  PB-CI-OB-FLAG            PIC X.
  2377                 88  PB-CI-OB                VALUE 'B'.
  2378             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2379                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2380                                           'M' '4' '5' '9' '2'.
  2381                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2382                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2383                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2384                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2385                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2386                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2387                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2388                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2389                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2390                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2391                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2392                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2393             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2394                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2395                                           'M' '4' '5' '9' '2'.
  2396                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2397                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2398                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2399                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2400                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2401                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2402                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2403                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2404                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2405                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2406                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2407                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2408             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2409             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2410             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2411             20  PB-CI-MEMBER-NO          PIC X(12).
  2412             20  PB-CI-INT-CODE           PIC X.
  2413                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2414                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2415             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2416             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2417             20  PB-CI-COMP-EXCP-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL642.cbl
  2418                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2419                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2420             20  PB-CI-ENTRY-STATUS       PIC X.
  2421             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2422             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2423             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2424             20  PB-CI-DEATH-DT           PIC XX.
  2425             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2426             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2427             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2428             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2429             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2430             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2431             20  PB-CI-ENTRY-DT              PIC XX.
  2432             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2433             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2434             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2435             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2436             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2437             20  PB-CI-OLD-LOF               PIC XXX.
  2438*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2439             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2440             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2441             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2442             20  PB-CI-INDV-GRP-CD           PIC X.
  2443             20  PB-CI-BENEFICIARY-NAME.
  2444                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2445                 24  FILLER                  PIC X(15).
  2446             20  PB-CI-NOTE-SW               PIC X.
  2447             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2448             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2449             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2450             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2451             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2452             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2453             20  PB-CI-FIRST-NAME            PIC X(10).
  2454
  2455         16  FILLER                       PIC X(17).
  2456*032306  16  FILLER                       PIC X(27).
  2457*        16  FILLER                       PIC X(46).
  2458
  2459     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2460         16  FILLER                       PIC X(10).
  2461         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2462         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2463         16  PB-M-INSURED-MID-INIT        PIC X.
  2464         16  PB-M-INSURED-AGE             PIC 99.
  2465         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2466         16  PB-M-INSURED-SEX             PIC X.
  2467         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2468         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  2469         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2470         16  PB-M-INSURED-CITY-STATE.
  2471             20  PB-M-INSURED-CITY        PIC X(28).
  2472             20  PB-M-INSURED-STATE       PIC XX.
  2473         16  PB-M-INSURED-ZIP-CODE.
  2474             20  PB-M-INSURED-ZIP-PRIME.
  2475                 24  PB-M-INSURED-ZIP-1   PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL642.cbl
  2476                     88  PB-M-CANADIAN-POST-CODE
  2477                                             VALUE 'A' THRU 'Z'.
  2478                 24  FILLER               PIC X(4).
  2479             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2480         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2481                                        PB-M-INSURED-ZIP-CODE.
  2482             20  PM-M-INS-CAN-POST1       PIC XXX.
  2483             20  PM-M-INS-CAN-POST2       PIC XXX.
  2484             20  FILLER                   PIC XXX.
  2485         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2486         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2487         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2488         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2489         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2490         16  PB-M-CRED-BENE-CITYST.
  2491             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2492             20  PB-M-CRED-BENE-STATE     PIC XX.
  2493         16  FILLER                       PIC X(92).
  2494
  2495     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2496         16  FILLER                       PIC X(10).
  2497         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2498         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2499         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2500         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2501         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2502         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2503         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2504         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2505         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2506         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2507         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2508         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2509         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2510         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2511         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2512         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2513         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2514         16  PB-ACCOUNT-NAME              PIC X(30).
  2515         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2516         16  PB-REFERENCE                 PIC X(12).
  2517         16  PB-B-RECEIVED-DT             PIC XX.
  2518         16  FILLER                       PIC X(234).
  2519
  2520     12  PB-RECORD-STATUS.
  2521         16  PB-CREDIT-SELECT-DT          PIC XX.
  2522         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2523         16  PB-BILLED-DT                 PIC XX.
  2524         16  PB-BILLING-STATUS            PIC X.
  2525             88  PB-ENTRY-REVERSED            VALUE 'R'.
  2526             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2527             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2528         16  PB-RECORD-BILL               PIC X.
  2529             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2530             88  PB-RECORD-RETURNED           VALUE 'R'.
  2531             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2532             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2533             88  PB-OVERRIDE-AH               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL642.cbl
  2534             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2535         16  PB-BATCH-ENTRY               PIC X.
  2536             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2537             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2538             88  PB-REISSUED-CERT             VALUE 'E'.
  2539             88  PB-MONTHLY-CERT              VALUE 'M'.
  2540             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2541             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2542             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2543         16  PB-FORCE-CODE                PIC X.
  2544             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2545             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2546             88  PB-CANCEL-FORCE              VALUE '8'.
  2547             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2548             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2549             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2550             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2551             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2552             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2553             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2554         16  PB-FATAL-FLAG                PIC X.
  2555             88  PB-FATAL-ERRORS              VALUE 'X'.
  2556         16  PB-FORCE-ER-CD               PIC X.
  2557             88  PB-FORCE-ERRORS              VALUE 'F'.
  2558             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2559         16  PB-WARN-ER-CD                PIC X.
  2560             88  PB-WARNING-ERRORS            VALUE 'W'.
  2561         16  FILLER                       PIC X.
  2562         16  PB-OUT-BAL-CD                PIC X.
  2563             88  PB-OUT-OF-BAL                VALUE 'O'.
  2564         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2565         16  PB-AH-OVERRIDE-L1            PIC X.
  2566         16  PB-INPUT-DT                  PIC XX.
  2567         16  PB-INPUT-BY                  PIC X(4).
  2568         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2569         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2570         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2571         16  PB-LF-EARNING-METHOD         PIC X.
  2572         16  PB-AH-EARNING-METHOD         PIC X.
  2573         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2574         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2575         16  PB-REIN-CD                   PIC XXX.
  2576         16  PB-LF-REFUND-TYPE            PIC X.
  2577         16  PB-AH-REFUND-TYPE            PIC X.
  2578         16  PB-ACCT-EFF-DT               PIC XX.
  2579         16  PB-ACCT-EXP-DT               PIC XX.
  2580         16  PB-COMPANY-ID                PIC X(3).
  2581         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2582         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2583         16  PB-SV-CARRIER                PIC X.
  2584         16  PB-SV-GROUPING               PIC X(6).
  2585         16  PB-SV-STATE                  PIC XX.
  2586         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2587         16  PB-GA-BILLING-INFO.
  2588             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2589                                          PIC XX.
  2590         16  PB-SV-REMIT-TO  REDEFINES
  2591             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL642.cbl
  2592         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2593         16  PB-I-LOAN-OFFICER            PIC X(5).
  2594         16  PB-I-VIN                     PIC X(17).
  2595
  2596         16  FILLER                       PIC X(04).
  2597         16  IMNET-BYPASS-SW              PIC X.
  2598
  2599******************************************************************
  2600*                COMMON EDIT ERRORS                              *
  2601******************************************************************
  2602
  2603     12  PB-COMMON-ERRORS.
  2604         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2605                                           PIC S9(4)     COMP.
  2606
  2607******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL642.cbl
  2609*                            COPY ELCCNTL.
  2610******************************************************************
  2611*                                                                *
  2612*                                                                *
  2613*                            ELCCNTL.                            *
  2614*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2615*                            VMOD=2.059                          *
  2616*                                                                *
  2617*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2618*                                                                *
  2619*   FILE TYPE = VSAM,KSDS                                        *
  2620*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2621*                                                                *
  2622*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2623*       ALTERNATE INDEX = NONE                                   *
  2624*                                                                *
  2625*   LOG = YES                                                    *
  2626*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2627******************************************************************
  2628*                   C H A N G E   L O G
  2629*
  2630* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2631*-----------------------------------------------------------------
  2632*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2633* EFFECTIVE    NUMBER
  2634*-----------------------------------------------------------------
  2635* 082503                   PEMA  ADD BENEFIT GROUP
  2636* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2637* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2638* 092705    2005050300006  PEMA  ADD SPP LEASES
  2639* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2640* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2641* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2642* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2643******************************************************************
  2644*
  2645 01  CONTROL-FILE.
  2646     12  CF-RECORD-ID                       PIC XX.
  2647         88  VALID-CF-ID                        VALUE 'CF'.
  2648
  2649     12  CF-CONTROL-PRIMARY.
  2650         16  CF-COMPANY-ID                  PIC XXX.
  2651         16  CF-RECORD-TYPE                 PIC X.
  2652             88  CF-COMPANY-MASTER              VALUE '1'.
  2653             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2654             88  CF-STATE-MASTER                VALUE '3'.
  2655             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2656             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2657             88  CF-CARRIER-MASTER              VALUE '6'.
  2658             88  CF-MORTALITY-MASTER            VALUE '7'.
  2659             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2660             88  CF-TERMINAL-MASTER             VALUE '9'.
  2661             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2662             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2663             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2664             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2665             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2666             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL642.cbl
  2667             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2668             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2669             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2670         16  CF-ACCESS-CD-GENL              PIC X(4).
  2671         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2672             20  CF-PROCESSOR               PIC X(4).
  2673         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2674             20  CF-STATE-CODE              PIC XX.
  2675             20  FILLER                     PIC XX.
  2676         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2677             20  FILLER                     PIC XX.
  2678             20  CF-HI-BEN-IN-REC           PIC XX.
  2679         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2680             20  FILLER                     PIC XXX.
  2681             20  CF-CARRIER-CNTL            PIC X.
  2682         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2683             20  FILLER                     PIC XX.
  2684             20  CF-HI-TYPE-IN-REC          PIC 99.
  2685         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2686             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2687                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2688             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2689             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2690         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2691             20  FILLER                     PIC X.
  2692             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2693         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2694             20  FILLER                     PIC XX.
  2695             20  CF-MORTGAGE-PLAN           PIC XX.
  2696         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2697
  2698     12  CF-LAST-MAINT-DT                   PIC XX.
  2699     12  CF-LAST-MAINT-BY                   PIC X(4).
  2700     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2701
  2702     12  CF-RECORD-BODY                     PIC X(728).
  2703
  2704
  2705****************************************************************
  2706*             COMPANY MASTER RECORD                            *
  2707****************************************************************
  2708
  2709     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2710         16  CF-COMPANY-ADDRESS.
  2711             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2712             20  CF-CL-IN-CARE-OF           PIC X(30).
  2713             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2714             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2715             20  CF-CL-CITY-STATE           PIC X(30).
  2716             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2717             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2718         16  CF-COMPANY-CD                  PIC X.
  2719         16  CF-COMPANY-PASSWORD            PIC X(8).
  2720         16  CF-SECURITY-OPTION             PIC X.
  2721             88  ALL-SECURITY                   VALUE '1'.
  2722             88  COMPANY-VERIFY                 VALUE '2'.
  2723             88  PROCESSOR-VERIFY               VALUE '3'.
  2724             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL642.cbl
  2725             88  ALL-BUT-TERM                   VALUE '5'.
  2726         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2727             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2728         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2729             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2730         16  CF-INFORCE-LOCATION            PIC X.
  2731             88  CERTS-ARE-ONLINE               VALUE '1'.
  2732             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2733             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2734         16  CF-LOWER-CASE-LETTERS          PIC X.
  2735         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2736             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2737             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2738             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2739             88  CF-ACCNT-CNTL                  VALUE '3'.
  2740             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2741
  2742         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2743         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2744
  2745         16  CF-LGX-CREDIT-USER             PIC X.
  2746             88  CO-IS-NOT-USER                 VALUE 'N'.
  2747             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2748
  2749         16 CF-CREDIT-CALC-CODES.
  2750             20  CF-CR-REM-TERM-CALC PIC X.
  2751               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2752               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2753               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2754               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2755               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2756               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2757               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2758             20  CF-CR-R78-METHOD           PIC X.
  2759               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2760               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2761
  2762         16  CF-CLAIM-CONTROL-COUNTS.
  2763             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2764                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2765
  2766             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2767                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2768
  2769             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2770                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2771
  2772             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2773                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2774
  2775         16  CF-CURRENT-MONTH-END           PIC XX.
  2776
  2777         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2778             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2779             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2780             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2781             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2782                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL642.cbl
  2783                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2784             20  CF-CO-PREM-REJECT-SW       PIC X.
  2785                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2786                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2787             20  CF-CO-REF-REJECT-SW        PIC X.
  2788                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2789                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2790
  2791         16  CF-CO-REPORTING-DT             PIC XX.
  2792         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2793         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2794           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2795           88  CF-CO-MONTH-END                  VALUE '1'.
  2796
  2797         16  CF-LGX-CLAIM-USER              PIC X.
  2798             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2799             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2800
  2801         16  CF-CREDIT-EDIT-CONTROLS.
  2802             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2803             20  CF-MIN-AGE                 PIC 99.
  2804             20  CF-DEFAULT-AGE             PIC 99.
  2805             20  CF-MIN-TERM                PIC S999      COMP-3.
  2806             20  CF-MAX-TERM                PIC S999      COMP-3.
  2807             20  CF-DEFAULT-SEX             PIC X.
  2808             20  CF-JOINT-AGE-INPUT         PIC X.
  2809                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2810             20  CF-BIRTH-DATE-INPUT        PIC X.
  2811                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2812             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2813                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2814                 88  CF-ZERO-CARRIER            VALUE '1'.
  2815                 88  CF-ZERO-GROUPING           VALUE '2'.
  2816                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2817             20  CF-EDIT-SW                 PIC X.
  2818                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2819             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2820             20  CF-CR-PR-METHOD            PIC X.
  2821               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2822               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2823             20  FILLER                     PIC X.
  2824
  2825         16  CF-CREDIT-MISC-CONTROLS.
  2826             20  CF-REIN-TABLE-SW           PIC X.
  2827                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2828             20  CF-COMP-TABLE-SW           PIC X.
  2829                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2830             20  CF-EXPERIENCE-RETENTION-AGE
  2831                                            PIC S9        COMP-3.
  2832             20  CF-CONVERSION-DT           PIC XX.
  2833             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2834             20  CF-RUN-FREQUENCY-SW        PIC X.
  2835                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2836                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2837
  2838             20  CF-CR-CHECK-NO-CONTROL.
  2839                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2840                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL642.cbl
  2841                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2842                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2843                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2844                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2845
  2846                 24  CF-CR-CHECK-COUNT       REDEFINES
  2847                     CF-CR-CHECK-COUNTER      PIC X(4).
  2848
  2849                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2850                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2851
  2852                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2853                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2854                 24  CF-MAIL-PROCESSING       PIC X.
  2855                     88  MAIL-PROCESSING          VALUE 'Y'.
  2856
  2857         16  CF-MISC-SYSTEM-CONTROL.
  2858             20  CF-SYSTEM-C                 PIC X.
  2859                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2860             20  CF-SYSTEM-D                 PIC X.
  2861                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2862             20  CF-SOC-SEC-NO-SW            PIC X.
  2863                 88  SOC-SEC-NO-USED             VALUE '1'.
  2864             20  CF-MEMBER-NO-SW             PIC X.
  2865                 88  MEMBER-NO-USED              VALUE '1'.
  2866             20  CF-TAX-ID-NUMBER            PIC X(11).
  2867             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2868             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2869                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2870                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2871                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2872                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2873             20  CF-SYSTEM-E                 PIC X.
  2874                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2875
  2876         16  CF-LGX-LIFE-USER               PIC X.
  2877             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2878             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2879
  2880         16  CF-CR-MONTH-END-DT             PIC XX.
  2881
  2882         16  CF-FILE-MAINT-DATES.
  2883             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2884                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2885             20  CF-LAST-BATCH       REDEFINES
  2886                 CF-LAST-BATCH-NO               PIC X(4).
  2887             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2888             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2889             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2890             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2891             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2892             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2893             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2894             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2895             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2896             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2897
  2898         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL642.cbl
  2899         16  FILLER                         PIC X.
  2900
  2901         16  CF-ALT-MORT-CODE               PIC X(4).
  2902         16  CF-MEMBER-CAPTION              PIC X(10).
  2903
  2904         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2905             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2906             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2907             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2908             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2909             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2910
  2911         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2912
  2913         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2914         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2915         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2916         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2917
  2918         16  CF-AH-OVERRIDE-L1              PIC X.
  2919         16  CF-AH-OVERRIDE-L2              PIC XX.
  2920         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2921         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2922
  2923         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2924         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2925
  2926         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2927         16  CF-AR-LAST-EL860-DT            PIC XX.
  2928         16  CF-MP-MONTH-END-DT             PIC XX.
  2929
  2930         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2931         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2932             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2933
  2934         16  CF-AR-MONTH-END-DT             PIC XX.
  2935
  2936         16  CF-CRDTCRD-USER                PIC X.
  2937             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2938             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2939
  2940         16  CF-CC-MONTH-END-DT             PIC XX.
  2941
  2942         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2943
  2944         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2945             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2946             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2947             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2948         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2949         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2950         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2951         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2952             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2953             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2954         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2955         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2956         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL642.cbl
  2957             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2958         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2959
  2960         16  CF-CL-ZIP-CODE.
  2961             20  CF-CL-ZIP-PRIME.
  2962                 24  CF-CL-ZIP-1ST          PIC X.
  2963                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2964                 24  FILLER                 PIC X(4).
  2965             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2966         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2967             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2968             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2969             20  FILLER                     PIC XXX.
  2970
  2971         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2972         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2973         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2974         16  CF-CO-OPTION-START-DATE        PIC XX.
  2975         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2976           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2977                                                      '3' '4'.
  2978           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2979           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2980           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2981           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2982           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2983           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2984
  2985         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2986
  2987         16  CF-PAYMENT-APPROVAL-LEVELS.
  2988             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2989             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2990             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2991             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2992             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2993             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2994
  2995         16  CF-END-USER-REPORTING-USER     PIC X.
  2996             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2997             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2998
  2999         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3000             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3001             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3002
  3003         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3004
  3005         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3006         16  FILLER                         PIC X.
  3007
  3008         16  CF-CREDIT-ARCHIVE-CNTL.
  3009             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3010             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3011             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3012
  3013         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3014
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL642.cbl
  3015         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3016             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3017             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3018
  3019         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3020             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3021             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3022
  3023         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3024
  3025         16  CF-CO-ACH-ID-CODE              PIC  X.
  3026             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3027             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3028             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3029         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3030         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3031         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3032         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3033         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3034         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3035         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3036         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3037         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3038                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3039         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3040                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3041
  3042         16  CF-CO-OVER-SHORT.
  3043             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3044             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3045
  3046*         16  FILLER                         PIC X(102).
  3047         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3048             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3049             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3050
  3051         16  CF-AH-APPROVAL-DAYS.
  3052             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3053             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3054             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3055             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3056
  3057         16  FILLER                         PIC X(82).
  3058****************************************************************
  3059*             PROCESSOR/USER RECORD                            *
  3060****************************************************************
  3061
  3062     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3063         16  CF-PROCESSOR-NAME              PIC X(30).
  3064         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3065         16  CF-PROCESSOR-TITLE             PIC X(26).
  3066         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3067                 88  MESSAGE-YES                VALUE 'Y'.
  3068                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3069
  3070*****************************************************
  3071****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3072****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL642.cbl
  3073****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3074****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3075*****************************************************
  3076
  3077         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3078             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3079             20  CF-APPLICATION-FORCE       PIC X.
  3080             20  CF-INDIVIDUAL-APP.
  3081                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3082                     28  CF-BROWSE-APP      PIC X.
  3083                     28  CF-UPDATE-APP      PIC X.
  3084
  3085         16  CF-CURRENT-TERM-ON             PIC X(4).
  3086         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3087             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3088             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3089             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3090             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3091             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3092             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3093             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3094         16  CF-PROCESSOR-CARRIER           PIC X.
  3095             88  NO-CARRIER-SECURITY            VALUE ' '.
  3096         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3097             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3098         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3099             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3100         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3101             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3102
  3103         16  CF-PROC-SYS-ACCESS-SW.
  3104             20  CF-PROC-CREDIT-CLAIMS-SW.
  3105                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3106                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3107                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3108                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3109             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3110                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3111                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3112             20  CF-PROC-LIFE-GNRLDGR-SW.
  3113                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3114                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3115                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3116                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3117             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3118                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3119                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3120         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3121             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3122             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3123         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3124
  3125         16  CF-APPROVAL-LEVEL                  PIC X.
  3126             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3127             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3128             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3129             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3130
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL642.cbl
  3131         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3132
  3133         16  CF-LANGUAGE-TYPE                   PIC X.
  3134             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3135             88  CF-LANG-IS-FR                      VALUE 'F'.
  3136         16  FILLER                             PIC  X(240).
  3137
  3138****************************************************************
  3139*             PROCESSOR/REMINDERS RECORD                       *
  3140****************************************************************
  3141
  3142     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3143         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3144             20  CF-START-REMIND-DT         PIC XX.
  3145             20  CF-END-REMIND-DT           PIC XX.
  3146             20  CF-REMINDER-TEXT           PIC X(50).
  3147         16  FILLER                         PIC X(296).
  3148
  3149
  3150****************************************************************
  3151*             STATE MASTER RECORD                              *
  3152****************************************************************
  3153
  3154     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3155         16  CF-STATE-ABBREVIATION          PIC XX.
  3156         16  CF-STATE-NAME                  PIC X(25).
  3157         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3158         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3159             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3160             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3161             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3162             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3163                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3164                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3165             20  CF-ST-PREM-REJECT-SW       PIC X.
  3166                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3167                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3168             20  CF-ST-REF-REJECT-SW        PIC X.
  3169                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3170                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3171         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3172         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3173         16  CF-ST-REFUND-RULES.
  3174             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3175             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3176             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3177         16  CF-ST-FST-PMT-EXTENSION.
  3178             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3179             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3180                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3181                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3182                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3183                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3184         16  CF-ST-STATE-CALL.
  3185             20  CF-ST-CALL-UNEARNED        PIC X.
  3186             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3187             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3188         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL642.cbl
  3189             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3190             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3191         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3192         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3193         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3194         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3195         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3196         16  FILLER                         PIC X.
  3197         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3198             20  CF-ST-BENEFIT-CD           PIC XX.
  3199             20  CF-ST-BENEFIT-KIND         PIC X.
  3200                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3201                 88  CF-ST-AH-KIND              VALUE 'A'.
  3202             20  CF-ST-REM-TERM-CALC        PIC X.
  3203                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3204                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3205                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3206                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3207                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3208                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3209                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3210                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3211
  3212             20  CF-ST-REFUND-CALC          PIC X.
  3213                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3214                 88  ST-REFD-BY-R78             VALUE '1'.
  3215                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3216                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3217                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3218                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3219                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3220                 88  ST-REFD-UTAH               VALUE '7'.
  3221                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3222                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3223                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3224
  3225             20  CF-ST-EARNING-CALC         PIC X.
  3226                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3227                 88  ST-EARN-BY-R78             VALUE '1'.
  3228                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3229                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3230                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3231                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3232                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3233                 88  ST-EARN-MEAN               VALUE '8'.
  3234                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3235
  3236             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3237                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3238                 88  ST-OVRD-BY-R78             VALUE '1'.
  3239                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3240                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3241                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3242                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3243                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3244                 88  ST-OVRD-MEAN               VALUE '8'.
  3245                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3246             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL642.cbl
  3247
  3248         16  CF-ST-COMMISSION-CAPS.
  3249             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3250             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3251             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3252             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3253         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3254                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3255
  3256         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3257
  3258         16  CF-ST-STATUTORY-INTEREST.
  3259             20  CF-ST-STAT-DATE-FROM       PIC X.
  3260                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3261                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3262             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3263             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3264             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3265             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3266             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3267
  3268         16  CF-ST-OVER-SHORT.
  3269             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3270             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3271
  3272         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3273
  3274         16  CF-ST-RT-CALC                  PIC X.
  3275
  3276         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3277         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3278         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3279         16  CF-ST-RF-LR-CALC               PIC X.
  3280         16  CF-ST-RF-LL-CALC               PIC X.
  3281         16  CF-ST-RF-LN-CALC               PIC X.
  3282         16  CF-ST-RF-AH-CALC               PIC X.
  3283         16  CF-ST-RF-CP-CALC               PIC X.
  3284*        16  FILLER                         PIC X(206).
  3285*CIDMOD         16  FILLER                         PIC X(192).
  3286         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3287             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3288         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3289         16  FILLER                         PIC X(187).
  3290
  3291****************************************************************
  3292*             BENEFIT MASTER RECORD                            *
  3293****************************************************************
  3294
  3295     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3296         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3297             20  CF-BENEFIT-CODE            PIC XX.
  3298             20  CF-BENEFIT-NUMERIC  REDEFINES
  3299                 CF-BENEFIT-CODE            PIC XX.
  3300             20  CF-BENEFIT-ALPHA           PIC XXX.
  3301             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3302             20  CF-BENEFIT-COMMENT         PIC X(10).
  3303
  3304             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL642.cbl
  3305                 88  CF-REDUCING                VALUE 'R'.
  3306                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3307
  3308             20  CF-SPECIAL-CALC-CD         PIC X.
  3309                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3310                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3311                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3312                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3313                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3314                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3315                 88  CF-FARM-PLAN               VALUE 'F'.
  3316                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3317                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3318                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3319                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3320                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3321                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3322                 88  CF-PRUDENTIAL              VALUE 'P'.
  3323                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3324                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3325                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3326                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3327                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3328                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3329
  3330             20  CF-JOINT-INDICATOR         PIC X.
  3331                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3332
  3333*            20  FILLER                     PIC X(12).
  3334             20  FILLER                     PIC X(11).
  3335             20  CF-BENEFIT-CATEGORY        PIC X.
  3336             20  CF-LOAN-TYPE               PIC X(8).
  3337
  3338             20  CF-CO-REM-TERM-CALC        PIC X.
  3339                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3340                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3341                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3342                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3343                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3344
  3345             20  CF-CO-EARNINGS-CALC        PIC X.
  3346                 88  CO-EARN-BY-R78             VALUE '1'.
  3347                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3348                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3349                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3350                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3351                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3352                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3353                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3354
  3355             20  CF-CO-REFUND-CALC          PIC X.
  3356                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3357                 88  CO-REFD-BY-R78             VALUE '1'.
  3358                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3359                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3360                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3361                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3362                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL642.cbl
  3363                 88  CO-REFD-MEAN               VALUE '8'.
  3364                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3365                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3366                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3367
  3368             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3369                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3370                 88  CO-OVRD-BY-R78             VALUE '1'.
  3371                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3372                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3373                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3374                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3375                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3376                 88  CO-OVRD-MEAN               VALUE '8'.
  3377                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3378
  3379             20  CF-CO-BEN-I-G-CD           PIC X.
  3380                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3381                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3382                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3383
  3384         16  FILLER                         PIC X(304).
  3385
  3386
  3387****************************************************************
  3388*             CARRIER MASTER RECORD                            *
  3389****************************************************************
  3390
  3391     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3392         16  CF-ADDRESS-DATA.
  3393             20  CF-MAIL-TO-NAME            PIC X(30).
  3394             20  CF-IN-CARE-OF              PIC X(30).
  3395             20  CF-ADDRESS-LINE-1          PIC X(30).
  3396             20  CF-ADDRESS-LINE-2          PIC X(30).
  3397             20  CF-CITY-STATE              PIC X(30).
  3398             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3399             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3400
  3401         16  CF-CLAIM-NO-CONTROL.
  3402             20  CF-CLAIM-NO-METHOD         PIC X.
  3403                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3404                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3405                 88  CLAIM-NO-SEQ               VALUE '3'.
  3406                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3407             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3408                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3409                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3410                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3411
  3412         16  CF-CHECK-NO-CONTROL.
  3413             20  CF-CHECK-NO-METHOD         PIC X.
  3414                 88  CHECK-NO-MANUAL            VALUE '1'.
  3415                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3416                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3417                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3418             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3419                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3420
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL642.cbl
  3421         16  CF-DOMICILE-STATE              PIC XX.
  3422
  3423         16  CF-EXPENSE-CONTROLS.
  3424             20  CF-EXPENSE-METHOD          PIC X.
  3425                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3426                 88  DOLLARS-PER-PMT            VALUE '2'.
  3427                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3428                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3429             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3430             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3431
  3432         16  CF-CORRESPONDENCE-CONTROL.
  3433             20  CF-LETTER-RESEND-OPT       PIC X.
  3434                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3435                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3436             20  FILLER                     PIC X(4).
  3437
  3438         16  CF-RESERVE-CONTROLS.
  3439             20  CF-MANUAL-SW               PIC X.
  3440                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3441             20  CF-FUTURE-SW               PIC X.
  3442                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3443             20  CF-PTC-SW                  PIC X.
  3444                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3445             20  CF-IBNR-SW                 PIC X.
  3446                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3447             20  CF-PTC-LF-SW               PIC X.
  3448                 88  CF-LF-PTC-USED             VALUE '1'.
  3449             20  CF-CDT-ACCESS-METHOD       PIC X.
  3450                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3451                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3452                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3453             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3454
  3455         16  CF-CLAIM-CALC-METHOD           PIC X.
  3456             88  360-PLUS-MONTHS                VALUE '1'.
  3457             88  365-PLUS-MONTHS                VALUE '2'.
  3458             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3459             88  360-DAILY                      VALUE '4'.
  3460             88  365-DAILY                      VALUE '5'.
  3461
  3462         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3463         16  FILLER                         PIC X(11).
  3464
  3465         16  CF-LIMIT-AMOUNTS.
  3466             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3467             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3468             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3469             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3470             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3471             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3472             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3473             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3474             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3475             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3476
  3477         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3478         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL642.cbl
  3479         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3480
  3481         16  CF-ZIP-CODE.
  3482             20  CF-ZIP-PRIME.
  3483                 24  CF-ZIP-1ST             PIC X.
  3484                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3485                 24  FILLER                 PIC X(4).
  3486             20  CF-ZIP-PLUS4               PIC X(4).
  3487         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3488             20  CF-CAN-POSTAL-1            PIC XXX.
  3489             20  CF-CAN-POSTAL-2            PIC XXX.
  3490             20  FILLER                     PIC XXX.
  3491
  3492         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3493         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3494         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3495
  3496         16  CF-RATING-SWITCH               PIC X.
  3497             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3498             88  CF-NO-RATING                   VALUE 'N'.
  3499
  3500         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3501
  3502         16  CF-CARRIER-OVER-SHORT.
  3503             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3504             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3505
  3506         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3507         16  CF-SECPAY-SWITCH               PIC X.
  3508             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3509             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3510         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3511         16  FILLER                         PIC X(448).
  3512*        16  FILLER                         PIC X(452).
  3513
  3514
  3515****************************************************************
  3516*             MORTALITY MASTER RECORD                          *
  3517****************************************************************
  3518
  3519     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3520         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3521                                INDEXED BY CF-MORT-NDX.
  3522             20  CF-MORT-TABLE              PIC X(5).
  3523             20  CF-MORT-TABLE-TYPE         PIC X.
  3524                 88  CF-MORT-JOINT              VALUE 'J'.
  3525                 88  CF-MORT-SINGLE             VALUE 'S'.
  3526                 88  CF-MORT-COMBINED           VALUE 'C'.
  3527                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3528                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3529             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3530             20  CF-MORT-AGE-METHOD         PIC XX.
  3531                 88  CF-AGE-LAST                VALUE 'AL'.
  3532                 88  CF-AGE-NEAR                VALUE 'AN'.
  3533             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3534             20  CF-MORT-ADJUSTMENT-DIRECTION
  3535                                            PIC X.
  3536                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL642.cbl
  3537                 88  CF-PLUS                    VALUE '+'.
  3538             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3539             20  CF-MORT-JOINT-CODE         PIC X.
  3540                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3541             20  CF-MORT-PC-Q               PIC X.
  3542                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3543             20  CF-MORT-TABLE-CODE         PIC X(4).
  3544             20  CF-MORT-COMMENTS           PIC X(15).
  3545             20  FILLER                     PIC X(14).
  3546
  3547         16  FILLER                         PIC X(251).
  3548
  3549
  3550****************************************************************
  3551*             BUSSINESS TYPE MASTER RECORD                     *
  3552****************************************************************
  3553
  3554     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3555* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3556* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3557* AND RECORD 05 IS TYPES 81-99
  3558         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3559             20  CF-BUSINESS-TITLE          PIC  X(19).
  3560             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3561                                            PIC S9V9(4) COMP-3.
  3562             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3563             20  FILLER                     PIC  X.
  3564         16  FILLER                         PIC  X(248).
  3565
  3566
  3567****************************************************************
  3568*             TERMINAL MASTER RECORD                           *
  3569****************************************************************
  3570
  3571     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3572
  3573         16  CF-COMPANY-TERMINALS.
  3574             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3575                                  PIC X(4).
  3576         16  FILLER               PIC X(248).
  3577
  3578
  3579****************************************************************
  3580*             LIFE EDIT MASTER RECORD                          *
  3581****************************************************************
  3582
  3583     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3584         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3585             20  CF-LIFE-CODE-IN            PIC XX.
  3586             20  CF-LIFE-CODE-OUT           PIC XX.
  3587         16  FILLER                         PIC X(248).
  3588
  3589
  3590****************************************************************
  3591*             AH EDIT MASTER RECORD                            *
  3592****************************************************************
  3593
  3594     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL642.cbl
  3595         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3596             20  CF-AH-CODE-IN              PIC XXX.
  3597             20  CF-AH-CODE-OUT             PIC XX.
  3598         16  FILLER                         PIC X(248).
  3599
  3600
  3601****************************************************************
  3602*             CREDIBILITY TABLES                               *
  3603****************************************************************
  3604
  3605     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3606         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3607                             INDEXED BY CF-CRDB-NDX.
  3608             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3609             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3610             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3611         16  FILLER                         PIC  X(332).
  3612
  3613
  3614****************************************************************
  3615*             REPORT CUSTOMIZATION RECORD                      *
  3616****************************************************************
  3617
  3618     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3619         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3620             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3621             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3622             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3623**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3624****       A T-TRANSFER.                                   ****
  3625             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3626
  3627         16  FILLER                         PIC XX.
  3628
  3629         16  CF-CARRIER-CNTL-OPT.
  3630             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3631                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3632                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3633             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3634                                            PIC X.
  3635         16  CF-GROUP-CNTL-OPT.
  3636             20  CF-GROUP-OPT-SEQ           PIC 9.
  3637                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3638                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3639             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3640                                            PIC X(6).
  3641         16  CF-STATE-CNTL-OPT.
  3642             20  CF-STATE-OPT-SEQ           PIC 9.
  3643                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3644                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3645             20  CF-STATE-SELECT OCCURS 3 TIMES
  3646                                            PIC XX.
  3647         16  CF-ACCOUNT-CNTL-OPT.
  3648             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3649                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3650                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3651             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3652                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL642.cbl
  3653         16  CF-BUS-TYP-CNTL-OPT.
  3654             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3655                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3656                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3657             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3658                                            PIC XX.
  3659         16  CF-LF-TYP-CNTL-OPT.
  3660             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3661                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3662                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3663             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3664                                            PIC XX.
  3665         16  CF-AH-TYP-CNTL-OPT.
  3666             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3667                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3668                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3669             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3670                                            PIC XX.
  3671         16  CF-REPTCD1-CNTL-OPT.
  3672             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3673                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3674                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3675             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3676                                            PIC X(10).
  3677         16  CF-REPTCD2-CNTL-OPT.
  3678             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3679                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3680                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3681             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3682                                            PIC X(10).
  3683         16  CF-USER1-CNTL-OPT.
  3684             20  CF-USER1-OPT-SEQ           PIC 9.
  3685                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3686                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3687             20  CF-USER1-SELECT OCCURS 3 TIMES
  3688                                            PIC X(10).
  3689         16  CF-USER2-CNTL-OPT.
  3690             20  CF-USER2-OPT-SEQ           PIC 9.
  3691                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3692                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3693             20  CF-USER2-SELECT OCCURS 3 TIMES
  3694                                            PIC X(10).
  3695         16  CF-USER3-CNTL-OPT.
  3696             20  CF-USER3-OPT-SEQ           PIC 9.
  3697                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3698                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3699             20  CF-USER3-SELECT OCCURS 3 TIMES
  3700                                            PIC X(10).
  3701         16  CF-USER4-CNTL-OPT.
  3702             20  CF-USER4-OPT-SEQ           PIC 9.
  3703                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3704                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3705             20  CF-USER4-SELECT OCCURS 3 TIMES
  3706                                            PIC X(10).
  3707         16  CF-USER5-CNTL-OPT.
  3708             20  CF-USER5-OPT-SEQ           PIC 9.
  3709                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3710                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL642.cbl
  3711             20  CF-USER5-SELECT OCCURS 3 TIMES
  3712                                            PIC X(10).
  3713         16  CF-REINS-CNTL-OPT.
  3714             20  CF-REINS-OPT-SEQ           PIC 9.
  3715                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3716                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3717             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3718                 24  CF-REINS-PRIME         PIC XXX.
  3719                 24  CF-REINS-SUB           PIC XXX.
  3720
  3721         16  CF-AGENT-CNTL-OPT.
  3722             20  CF-AGENT-OPT-SEQ           PIC 9.
  3723                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3724                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3725             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3726                                            PIC X(10).
  3727
  3728         16  FILLER                         PIC X(43).
  3729
  3730         16  CF-LOSS-RATIO-SELECT.
  3731             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3732             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3733         16  CF-ENTRY-DATE-SELECT.
  3734             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3735             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3736         16  CF-EFFECTIVE-DATE-SELECT.
  3737             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3738             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3739
  3740         16  CF-EXCEPTION-LIST-IND          PIC X.
  3741             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3742
  3743         16  FILLER                         PIC X(318).
  3744
  3745****************************************************************
  3746*                  EXCEPTION REPORTING RECORD                  *
  3747****************************************************************
  3748
  3749     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3750         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3751             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3752
  3753         16  CF-COMBINED-LIFE-AH-OPT.
  3754             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3755             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3756             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3757             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3758
  3759         16  CF-LIFE-OPT.
  3760             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3761             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3762             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3763             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3764             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3765             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3766             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3767             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3768             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL642.cbl
  3769             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3770
  3771         16  CF-AH-OPT.
  3772             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3773             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3774             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3775             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3776             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3777             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3778             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3779             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3780             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3781             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3782
  3783         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3784             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3785             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3786             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3787
  3788         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3789
  3790         16  FILLER                         PIC X(673).
  3791
  3792
  3793****************************************************************
  3794*             MORTGAGE SYSTEM PLAN RECORD                      *
  3795****************************************************************
  3796
  3797     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3798         16  CF-PLAN-TYPE                   PIC X.
  3799             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3800             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3801             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3802         16  CF-PLAN-ABBREV                 PIC XXX.
  3803         16  CF-PLAN-DESCRIPT               PIC X(10).
  3804         16  CF-PLAN-NOTES                  PIC X(20).
  3805         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3806         16  CF-PLAN-UNDERWRITING.
  3807             20  CF-PLAN-TERM-DATA.
  3808                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3809                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3810             20  CF-PLAN-AGE-DATA.
  3811                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3812                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3813                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3814             20  CF-PLAN-BENEFIT-DATA.
  3815                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3816                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3817                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3818                                            PIC S9(7)V99  COMP-3.
  3819         16  CF-PLAN-POLICY-FORMS.
  3820             20  CF-POLICY-FORM             PIC X(12).
  3821             20  CF-MASTER-APPLICATION      PIC X(12).
  3822             20  CF-MASTER-POLICY           PIC X(12).
  3823         16  CF-PLAN-RATING.
  3824             20  CF-RATE-CODE               PIC X(5).
  3825             20  CF-SEX-RATING              PIC X.
  3826                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL642.cbl
  3827                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3828             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3829             20  CF-SUB-STD-TYPE            PIC X.
  3830                 88  CF-PCT-OF-PREM            VALUE '1'.
  3831                 88  CF-PCT-OF-BENE            VALUE '2'.
  3832         16  CF-PLAN-PREM-TOLERANCES.
  3833             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3834             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3835         16  CF-PLAN-PYMT-TOLERANCES.
  3836             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3837             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3838         16  CF-PLAN-MISC-DATA.
  3839             20  FILLER                     PIC X.
  3840             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3841             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3842         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3843         16  CF-PLAN-IND-GRP                PIC X.
  3844             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3845                                                     '1'.
  3846             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3847                                                     '2'.
  3848         16  CF-MIB-SEARCH-SW               PIC X.
  3849             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3850             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3851             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3852             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3853         16  CF-ALPHA-SEARCH-SW             PIC X.
  3854             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3855             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3856             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3857             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3858             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3859             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3860             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3861             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3862             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3863             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3864                                                     'A' 'B' 'C'
  3865                                                     'X' 'Y' 'Z'.
  3866         16  CF-EFF-DT-RULE-SW              PIC X.
  3867             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3868             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3869             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3870             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3871             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3872         16  FILLER                         PIC X(4).
  3873         16  CF-HEALTH-QUESTIONS            PIC X.
  3874             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3875         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3876         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3877         16  CF-PLAN-SNGL-JNT               PIC X.
  3878             88  CF-COMBINED-PLAN              VALUE 'C'.
  3879             88  CF-JNT-PLAN                   VALUE 'J'.
  3880             88  CF-SNGL-PLAN                  VALUE 'S'.
  3881         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3882         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3883         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3884         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL642.cbl
  3885         16  CF-RERATE-CNTL                 PIC  X.
  3886             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3887             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3888             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3889             88  CF-AUTO-RECALC                 VALUE '4'.
  3890         16  CF-BENEFIT-TYPE                PIC  X.
  3891             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3892             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3893         16  CF-POLICY-FEE                  PIC S999V99
  3894                                                    COMP-3.
  3895         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3896         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3897         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3898         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3899         16  FILLER                         PIC  X(32).
  3900         16  CF-TERMINATION-FORM            PIC  X(04).
  3901         16  FILLER                         PIC  X(08).
  3902         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3903                                                       COMP-3.
  3904         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3905         16  CF-ISSUE-LETTER                PIC  X(4).
  3906         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3907         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3908             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3909             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3910         16  CF-MP-REFUND-CALC              PIC X.
  3911             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3912             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3913             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3914             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3915             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3916             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3917             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3918             88  CF-MP-REFD-MEAN                VALUE '8'.
  3919         16  CF-ALT-RATE-CODE               PIC  X(5).
  3920
  3921
  3922         16  FILLER                         PIC X(498).
  3923****************************************************************
  3924*             MORTGAGE COMPANY MASTER RECORD                   *
  3925****************************************************************
  3926
  3927     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3928         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3929         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3930             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3931             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3932             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3933             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3934             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3935
  3936         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3937         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3938         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3939         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3940         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3941
  3942         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL642.cbl
  3943             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3944         16  CF-MP-RECON-USE-IND            PIC X(1).
  3945             88  CF-MP-USE-RECON             VALUE 'Y'.
  3946         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3947             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3948         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3949             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3950             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3951         16  FILLER                         PIC X(1).
  3952         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3953             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3954         16  CF-MORTG-MIB-VERSION           PIC X.
  3955             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3956             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3957             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3958         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3959             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3960                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3961             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3962                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3963             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3964                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3965             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3966                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3967             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3968                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3969             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3970                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3971         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3972         16  FILLER                         PIC X(7).
  3973         16  CF-MORTG-DESTINATION-SYMBOL.
  3974             20  CF-MORTG-MIB-COMM          PIC X(5).
  3975             20  CF-MORTG-MIB-TERM          PIC X(5).
  3976         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3977             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3978         16  FILLER                         PIC X(03).
  3979         16  CF-MP-CHECK-NO-CONTROL.
  3980             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3981                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3982                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3983                                                ' ' LOW-VALUES.
  3984                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3985                                               VALUE '3'.
  3986         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3987         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3988         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3989             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3990                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3991             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3992                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3993             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3994                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3995             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3996                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3997             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3998                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3999             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4000                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL642.cbl
  4001         16  CF-MORTG-BILLING-AREA.
  4002             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4003                                            PIC X.
  4004         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4005         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4006         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4007         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4008             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4009             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4010         16  FILLER                         PIC X.
  4011         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4012             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4013             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4014         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4015         16  FILLER                         PIC X(8).
  4016         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4017         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4018         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4019         16  CF-ACH-COMPANY-ID.
  4020             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4021                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4022                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4023                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4024             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4025         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4026             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4027         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4028             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4029             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4030         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4031         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4032         16  FILLER                         PIC X(536).
  4033
  4034****************************************************************
  4035*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4036****************************************************************
  4037
  4038     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4039         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4040             20  CF-FEMALE-HEIGHT.
  4041                 24  CF-FEMALE-FT           PIC 99.
  4042                 24  CF-FEMALE-IN           PIC 99.
  4043             20  CF-FEMALE-MIN-WT           PIC 999.
  4044             20  CF-FEMALE-MAX-WT           PIC 999.
  4045         16  FILLER                         PIC X(428).
  4046
  4047     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4048         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4049             20  CF-MALE-HEIGHT.
  4050                 24  CF-MALE-FT             PIC 99.
  4051                 24  CF-MALE-IN             PIC 99.
  4052             20  CF-MALE-MIN-WT             PIC 999.
  4053             20  CF-MALE-MAX-WT             PIC 999.
  4054         16  FILLER                         PIC X(428).
  4055******************************************************************
  4056*             AUTOMATIC ACTIVITY RECORD                          *
  4057******************************************************************
  4058     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL642.cbl
  4059         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4060             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4061             20  CF-SYS-LETTER-ID           PIC X(04).
  4062             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4063             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4064             20  CF-SYS-RESET-SW            PIC X(01).
  4065             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4066             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4067
  4068         16  FILLER                         PIC X(50).
  4069
  4070         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4071             20  CF-USER-ACTIVE-SW          PIC X(01).
  4072             20  CF-USER-LETTER-ID          PIC X(04).
  4073             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4074             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4075             20  CF-USER-RESET-SW           PIC X(01).
  4076             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4077             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4078             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4079
  4080         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL642.cbl
  4082*                            COPY ERCCOMP.
  4083******************************************************************
  4084*                                                                *
  4085*                                                                *
  4086*                            ERCCOMP                             *
  4087*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4088*                            VMOD=2.019                          *
  4089*                                                                *
  4090*   ONLINE CREDIT SYSTEM                                         *
  4091*                                                                *
  4092*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4093*                                                                *
  4094*   FILE TYPE = VSAM,KSDS                                        *
  4095*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4096*                                                                *
  4097*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4098*       ALTERNATE PATH = NONE                                    *
  4099*                                                                *
  4100*   LOG = NO                                                     *
  4101*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4102*                                                                *
  4103******************************************************************
  4104*                   C H A N G E   L O G
  4105*
  4106* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4107*-----------------------------------------------------------------
  4108*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4109* EFFECTIVE    NUMBER
  4110*-----------------------------------------------------------------
  4111* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4112* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4113* 092205    2005050300006  PEMA  ADD LEASE FEE
  4114* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4115* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4116* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4117* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4118* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4119******************************************************************
  4120
  4121 01  COMPENSATION-MASTER.
  4122     12  CO-RECORD-ID                          PIC XX.
  4123         88  VALID-CO-ID                          VALUE 'CO'.
  4124
  4125     12  CO-CONTROL-PRIMARY.
  4126         16  CO-COMPANY-CD                     PIC X.
  4127         16  CO-CONTROL.
  4128             20  CO-CTL-1.
  4129                 24  CO-CARR-GROUP.
  4130                     28  CO-CARRIER            PIC X.
  4131                     28  CO-GROUPING.
  4132                         32  CO-GROUP-PREFIX   PIC XXX.
  4133                         32  CO-GROUP-PRIME    PIC XXX.
  4134                 24  CO-RESP-NO.
  4135                     28  CO-RESP-PREFIX        PIC X(4).
  4136                     28  CO-RESP-PRIME         PIC X(6).
  4137             20  CO-CTL-2.
  4138                 24  CO-ACCOUNT.
  4139                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL642.cbl
  4140                     28  CO-ACCT-PRIME         PIC X(6).
  4141         16  CO-TYPE                           PIC X.
  4142             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4143             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4144             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4145
  4146     12  CO-MAINT-INFORMATION.
  4147         16  CO-LAST-MAINT-DT                  PIC XX.
  4148         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4149         16  CO-LAST-MAINT-USER                PIC X(4).
  4150     12  FILLER                                PIC XX.
  4151     12  CO-STMT-TYPE                          PIC XXX.
  4152     12  CO-COMP-TYPE                          PIC X.
  4153         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4154     12  CO-STMT-OWNER                         PIC X(4).
  4155     12  CO-BALANCE-CONTROL                    PIC X.
  4156         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4157         88  CO-NO-BALANCE                        VALUE 'N'.
  4158
  4159     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4160         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4161         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4162         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4163
  4164     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4165         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4166         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4167
  4168     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4169     12  CO-GA-DIRECT-DEP                      PIC X.
  4170     12  CO-FUTURE-SPACE                       PIC X.
  4171         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4172
  4173     12  CO-ACCT-NAME                          PIC X(30).
  4174     12  CO-MAIL-NAME                          PIC X(30).
  4175     12  CO-ADDR-1                             PIC X(30).
  4176     12  CO-ADDR-2                             PIC X(30).
  4177     12  CO-ADDR-3.
  4178         16  CO-ADDR-CITY                      PIC X(27).
  4179         16  CO-ADDR-STATE                     PIC XX.
  4180     12  CO-CSO-1099                           PIC X.
  4181     12  CO-ZIP.
  4182         16  CO-ZIP-PRIME.
  4183             20  CO-ZIP-PRI-1ST                PIC X.
  4184                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4185             20  FILLER                        PIC X(4).
  4186         16  CO-ZIP-PLUS4                      PIC X(4).
  4187     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4188         16  CO-CAN-POSTAL-1                   PIC XXX.
  4189         16  CO-CAN-POSTAL-2                   PIC XXX.
  4190         16  FILLER                            PIC XXX.
  4191     12  CO-SOC-SEC                            PIC X(13).
  4192     12  CO-TELEPHONE.
  4193         16  CO-AREA-CODE                      PIC XXX.
  4194         16  CO-PREFIX                         PIC XXX.
  4195         16  CO-PHONE                          PIC X(4).
  4196
  4197     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL642.cbl
  4198
  4199     12  CO-AR-BAL-LEVEL                       PIC X.
  4200         88  CO-AR-REF-LVL                        VALUE '1'.
  4201         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4202         88  CO-AR-BILL-LVL                       VALUE '2'.
  4203         88  CO-AR-AGT-LVL                        VALUE '3'.
  4204         88  CO-AR-FR-LVL                         VALUE '4'.
  4205
  4206     12  CO-AR-NORMAL-PRINT                    PIC X.
  4207         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4208         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4209
  4210     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4211
  4212     12  CO-AR-REPORTING                       PIC X.
  4213         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4214         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4215
  4216     12  CO-AR-PULL-CHECK                      PIC X.
  4217         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4218         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4219
  4220     12  CO-AR-BALANCE-PRINT                   PIC X.
  4221         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4222
  4223     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4224         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4225         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4226         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4227
  4228     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4229
  4230     12  CO-USER-CODE                          PIC X.
  4231     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4232
  4233******************************************************************
  4234*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4235*    THE LAST MONTH END RUN.
  4236******************************************************************
  4237
  4238     12  CO-LAST-ACTIVITY-DATE.
  4239         16  CO-ACT-YEAR                       PIC 99.
  4240         16  CO-ACT-MONTH                      PIC 99.
  4241         16  CO-ACT-DAY                        PIC 99.
  4242
  4243     12  CO-LAST-STMT-DT.
  4244         16  CO-LAST-STMT-YEAR                 PIC 99.
  4245         16  CO-LAST-STMT-MONTH                PIC 99.
  4246         16  CO-LAST-STMT-DAY                  PIC 99.
  4247
  4248     12  CO-MO-END-TOTALS.
  4249         16  CO-MONTHLY-TOTALS.
  4250             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4251             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4252             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4253             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4254             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4255
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL642.cbl
  4256         16  CO-AGING-TOTALS.
  4257             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4258             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4259             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4260             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4261
  4262         16  CO-YTD-TOTALS.
  4263             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4264             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4265
  4266         16  CO-OVER-UNDER-TOTALS.
  4267             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4268             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4269
  4270     12  CO-MISCELLANEOUS-TOTALS.
  4271         16  CO-FICA-TOTALS.
  4272             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4273             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4274
  4275         16  CO-CLAIM-TOTALS.
  4276             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4277             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4278
  4279******************************************************************
  4280*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4281*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4282******************************************************************
  4283
  4284     12  CO-CURRENT-TOTALS.
  4285         16  CO-CURRENT-LAST-STMT-DT.
  4286             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4287             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4288             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4289
  4290         16  CO-CURRENT-MONTHLY-TOTALS.
  4291             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4292             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4293             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4294             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4295             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4296
  4297         16  CO-CURRENT-AGING-TOTALS.
  4298             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4299             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4300             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4301             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4302
  4303         16  CO-CURRENT-YTD-TOTALS.
  4304             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4305             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4306
  4307     12  CO-PAID-COMM-TOTALS.
  4308         16  CO-YTD-PAID-COMMS.
  4309             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4310             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4311
  4312     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4313         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL642.cbl
  4314         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4315
  4316     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4317         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4318         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4319         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4320         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4321         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4322         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4323         88  CO-FINAL-LETTER                  VALUE 'F'.
  4324         88  CO-RECONCILING                   VALUE 'R'.
  4325         88  CO-PHONE-CALL                    VALUE 'P'.
  4326         88  CO-LEGAL                         VALUE 'L'.
  4327         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4328         88  CO-WRITE-OFF                     VALUE 'W'.
  4329         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4330
  4331     12  CO-CSR-CODE                       PIC X(4).
  4332
  4333     12  CO-GA-STATUS-INFO.
  4334         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4335         16  CO-GA-TERMINATION-DT          PIC XX.
  4336         16  CO-GA-STATUS-CODE             PIC X.
  4337             88  CO-GA-ACTIVE                 VALUE 'A'.
  4338             88  CO-GA-INACTIVE               VALUE 'I'.
  4339             88  CO-GA-PENDING                VALUE 'P'.
  4340         16  CO-GA-COMMENTS.
  4341             20  CO-GA-COMMENT-1           PIC X(40).
  4342             20  CO-GA-COMMENT-2           PIC X(40).
  4343             20  CO-GA-COMMENT-3           PIC X(40).
  4344             20  CO-GA-COMMENT-4           PIC X(40).
  4345
  4346     12  CO-RPTCD2                         PIC X(10).
  4347
  4348     12  CO-TYPE-AGENT                     PIC X(01).
  4349         88  CO-CORPORATION                   VALUE 'C'.
  4350         88  CO-PARTNERSHIP                   VALUE 'P'.
  4351         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4352         88  CO-TRUST                         VALUE 'T'.
  4353         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4354
  4355     12  CO-FAXNO.
  4356         16  CO-FAX-AREA-CODE                  PIC XXX.
  4357         16  CO-FAX-PREFIX                     PIC XXX.
  4358         16  CO-FAX-PHONE                      PIC X(4).
  4359
  4360     12  CO-BANK-INFORMATION.
  4361         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4362         16  CO-BANK-TRANSIT-NON REDEFINES
  4363             CO-BANK-TRANSIT-NO                PIC 9(8).
  4364
  4365         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4366     12  CO-MISC-DEDUCT-INFO REDEFINES
  4367                  CO-BANK-INFORMATION.
  4368         16  CO-MD-GL-ACCT                     PIC X(10).
  4369         16  CO-MD-DIV                         PIC XX.
  4370         16  CO-MD-CENTER                      PIC X(4).
  4371         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL642.cbl
  4372         16  CO-CREATE-AP-CHECK                PIC X.
  4373         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4374         16  FILLER                            PIC XXX.
  4375     12  CO-ACH-STATUS                         PIC X.
  4376         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4377         88  CO-ACH-PENDING                        VALUE 'P'.
  4378
  4379     12  CO-BILL-SW                            PIC X.
  4380     12  CO-CONTROL-NAME                       PIC X(30).
  4381     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4382     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4383     12  CO-CLP-STATE                          PIC XX.
  4384     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4385     12  CO-SPP-REFUND-EDIT                    PIC X.
  4386
  4387******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL642.cbl
  4389*                            COPY ERCPYAJ.
  4390******************************************************************
  4391*                                                                *
  4392*                            ERCPYAJ                             *
  4393*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4394*                            VMOD=2.015                          *
  4395*                                                                *
  4396*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  4397*                                                                *
  4398*                                                                *
  4399*   FILE TYPE = VSAM,KSDS                                        *
  4400*   RECORD SIZE = 200  RECFORM = FIXED                           *
  4401*                                                                *
  4402*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  4403*       ALTERNATE PATHS = NONE                                   *
  4404*                                                                *
  4405*   LOG = YES                                                    *
  4406*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4407******************************************************************
  4408******************************************************************
  4409*                   C H A N G E   L O G
  4410*
  4411* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4412*-----------------------------------------------------------------
  4413*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4414* EFFECTIVE    NUMBER
  4415*-----------------------------------------------------------------
  4416* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  4417* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  4418******************************************************************
  4419
  4420 01  PENDING-PAY-ADJ.
  4421     12  PY-RECORD-ID                     PIC XX.
  4422         88  VALID-PY-ID                        VALUE 'PY'.
  4423
  4424     12  PY-CONTROL-PRIMARY.
  4425         16  PY-COMPANY-CD                PIC X.
  4426         16  PY-CARRIER                   PIC X.
  4427         16  PY-GROUPING                  PIC X(6).
  4428         16  PY-FIN-RESP                  PIC X(10).
  4429         16  PY-ACCOUNT                   PIC X(10).
  4430         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  4431                                          PIC X(10).
  4432         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  4433         16  PY-RECORD-TYPE               PIC X.
  4434             88  PY-REMIT-RECEIVED            VALUE 'R'.
  4435             88  PY-DEPOSIT                   VALUE 'D'.
  4436             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  4437             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  4438             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  4439             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  4440             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  4441             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  4442             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  4443             88  PY-FICA-ENTRY                VALUE 'F'.
  4444             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  4445             88  PY-POLICY-FEE                VALUE 'W'.
  4446             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL642.cbl
  4447
  4448     12  PY-PYMT-TYPE                     PIC X.
  4449             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  4450             88  PY-REINS-PYMT                VALUE 'R'.
  4451             88  PY-EXP-PYMT                  VALUE 'E'.
  4452
  4453     12  PY-BIL-INV                       PIC X(6).
  4454     12  PY-REF-NO                        PIC X(12).
  4455
  4456     12  PY-LAST-MAINT-DT                 PIC XX.
  4457     12  PY-LAST-MAINT-BY                 PIC X(4).
  4458     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4459
  4460     12  PY-PYADJ-RECORD.
  4461         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  4462         16  PY-ENTRY-COMMENT             PIC X(30).
  4463         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  4464             20  PY-GL-ACCOUNT            PIC X(10).
  4465             20  PY-GL-STATE              PIC X(02).
  4466             20  PY-GL-CANC-SW            PIC X(01).
  4467                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  4468                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  4469             20  PY-GL-COMMENT            PIC X(10).
  4470             20  FILLER      REDEFINES PY-GL-COMMENT.
  4471                 24  PY-GL-CHECK-NO       PIC 9(06).
  4472                 24  FILLER               PIC X(04).
  4473             20  FILLER                   PIC X(07).
  4474         16  PY-SAVE-ACCOUNT              PIC X(10).
  4475         16  PY-SAVE-TYPE                 PIC X(01).
  4476
  4477         16  PY-LETTERS.
  4478             20  PY-LETTER OCCURS 3 TIMES
  4479                           INDEXED BY PY-LET-NDX
  4480                                          PIC X(04).
  4481
  4482         16  PY-ERCOMP-TYPE               PIC X.
  4483             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  4484             88  PY-GA-TYPE                   VALUE 'G'.
  4485             88  PY-BANK-TYPE                 VALUE 'B'.
  4486         16  FILLER                       PIC X(05).
  4487
  4488     12  PY-RECORD-STATUS.
  4489         16  PY-CREDIT-SELECT-DT          PIC XX.
  4490         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  4491         16  PY-BILLED-DATE               PIC XX.
  4492         16  PY-REPORTED-DT               PIC XX.
  4493         16  PY-PMT-APPLIED               PIC X.
  4494             88  PY-ACCOUNT-PMT               VALUE 'A'.
  4495             88  PY-GA-PMT                    VALUE 'G'.
  4496             88  PY-OVWRITE-PMT               VALUE 'O'.
  4497             88  PY-NON-AR-PMT                VALUE 'N'.
  4498         16  FILLER                       PIC X(5).
  4499         16  PY-INPUT-DT                  PIC XX.
  4500         16  PY-CHECK-NUMBER              PIC X(6).
  4501         16  PY-VOID-SW                   PIC X.
  4502             88  PY-CHECK-VOIDED              VALUE 'V'.
  4503         16  PY-CHECK-ORIGIN-SW           PIC X.
  4504             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL642.cbl
  4505             88  PY-REFUND-CHECK              VALUE 'R'.
  4506             88  PY-GA-CHECK                  VALUE 'G'.
  4507             88  PY-CHECK-WRITTEN             VALUE 'W'.
  4508             88  PY-CHECK-REVERSAL            VALUE 'V'.
  4509         16  PY-CHECK-WRITTEN-DT          PIC XX.
  4510         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  4511         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  4512         16  PY-BILL-FLAG                 PIC X.
  4513             88  PY-BILLED                    VALUE 'B'.
  4514         16  PY-AR-FLAG                   PIC X.
  4515             88  PY-AR-CYCLE                  VALUE 'C'.
  4516             88  PY-AR-MONTH-END              VALUE 'M'.
  4517         16  PY-AR-DATE                   PIC XX.
  4518
  4519     12  PY-GL-CODES.
  4520         16  PY-GL-DB                     PIC X(14).
  4521         16  PY-GL-CR                     PIC X(14).
  4522         16  PY-GL-FLAG                   PIC X.
  4523         16  PY-GL-DATE                   PIC XX.
  4524
  4525     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  4526     12  FILLER                           PIC X(3).
  4527******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL642.cbl
  4529*                            COPY ERCACCT.
  4530******************************************************************
  4531*                                                                *
  4532*                                                                *
  4533*                            ERCACCT                             *
  4534*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4535*                            VMOD=2.031                          *
  4536*                                                                *
  4537*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4538*                                                                *
  4539*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4540*   VSAM ACCOUNT MASTER FILES.                                   *
  4541*                                                                *
  4542*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4543*                                                                *
  4544*   FILE TYPE = VSAM,KSDS                                        *
  4545*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4546*                                                                *
  4547*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4548*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4549*                                                                *
  4550*   LOG = NO                                                     *
  4551*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4552*                                                                *
  4553*                                                                *
  4554******************************************************************
  4555*                   C H A N G E   L O G
  4556*
  4557* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4558*-----------------------------------------------------------------
  4559*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4560* EFFECTIVE    NUMBER
  4561*-----------------------------------------------------------------
  4562* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4563* 092705    2005050300006  PEMA  ADD SPP LEASES
  4564* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4565* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4566******************************************************************
  4567
  4568 01  ACCOUNT-MASTER.
  4569     12  AM-RECORD-ID                      PIC XX.
  4570         88  VALID-AM-ID                      VALUE 'AM'.
  4571
  4572     12  AM-CONTROL-PRIMARY.
  4573         16  AM-COMPANY-CD                 PIC X.
  4574         16  AM-MSTR-CNTRL.
  4575             20  AM-CONTROL-A.
  4576                 24  AM-CARRIER            PIC X.
  4577                 24  AM-GROUPING.
  4578                     28 AM-GROUPING-PREFIX PIC XXX.
  4579                     28 AM-GROUPING-PRIME  PIC XXX.
  4580                 24  AM-STATE              PIC XX.
  4581                 24  AM-ACCOUNT.
  4582                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4583                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4584             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4585                                           PIC X(19).
  4586             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL642.cbl
  4587                 24  AM-EXPIRATION-DT      PIC XX.
  4588                 24  FILLER                PIC X(4).
  4589             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4590                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4591
  4592     12  AM-CONTROL-BY-VAR-GRP.
  4593         16  AM-COMPANY-CD-A1              PIC X.
  4594         16  AM-VG-CARRIER                 PIC X.
  4595         16  AM-VG-GROUPING                PIC X(6).
  4596         16  AM-VG-STATE                   PIC XX.
  4597         16  AM-VG-ACCOUNT                 PIC X(10).
  4598         16  AM-VG-DATE.
  4599             20  AM-VG-EXPIRATION-DT       PIC XX.
  4600             20  FILLER                    PIC X(4).
  4601         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4602                                           PIC 9(11)      COMP-3.
  4603     12  AM-MAINT-INFORMATION.
  4604         16  AM-LAST-MAINT-DT              PIC XX.
  4605         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4606         16  AM-LAST-MAINT-USER            PIC X(4).
  4607         16  FILLER                        PIC XX.
  4608
  4609     12  AM-EFFECTIVE-DT                   PIC XX.
  4610     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4611
  4612     12  AM-PREV-DATES  COMP-3.
  4613         16  AM-PREV-EXP-DT                PIC 9(11).
  4614         16  AM-PREV-EFF-DT                PIC 9(11).
  4615
  4616     12  AM-REPORT-CODE-1                  PIC X(10).
  4617     12  AM-REPORT-CODE-2                  PIC X(10).
  4618
  4619     12  AM-CITY-CODE                      PIC X(4).
  4620     12  AM-COUNTY-PARISH                  PIC X(6).
  4621
  4622     12  AM-NAME                           PIC X(30).
  4623     12  AM-PERSON                         PIC X(30).
  4624     12  AM-ADDRS                          PIC X(30).
  4625     12  AM-CITY.
  4626         16  AM-ADDR-CITY                  PIC X(28).
  4627         16  AM-ADDR-STATE                 PIC XX.
  4628     12  AM-ZIP.
  4629         16  AM-ZIP-PRIME.
  4630             20  AM-ZIP-PRI-1ST            PIC X.
  4631                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4632             20  FILLER                    PIC X(4).
  4633         16  AM-ZIP-PLUS4                  PIC X(4).
  4634     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4635         16  AM-CAN-POSTAL-1               PIC XXX.
  4636         16  AM-CAN-POSTAL-2               PIC XXX.
  4637         16  FILLER                        PIC XXX.
  4638     12  AM-TEL-NO.
  4639         16  AM-AREA-CODE                  PIC 999.
  4640         16  AM-TEL-PRE                    PIC 999.
  4641         16  AM-TEL-NBR                    PIC 9(4).
  4642     12  AM-TEL-LOC                        PIC X.
  4643         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4644         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL642.cbl
  4645
  4646     12  AM-COMM-STRUCTURE.
  4647         16  AM-DEFN-1.
  4648             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4649                 24  AM-AGT.
  4650                     28  AM-AGT-PREFIX     PIC X(4).
  4651                     28  AM-AGT-PRIME      PIC X(6).
  4652                 24  AM-COM-TYP            PIC X.
  4653                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4654                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4655                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4656                 24  AM-RECALC-LV-INDIC    PIC X.
  4657                 24  AM-RETRO-LV-INDIC     PIC X.
  4658                 24  AM-GL-CODES           PIC X.
  4659                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4660                 24  FILLER                PIC X(01).
  4661         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4662             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4663                 24  FILLER                PIC X(11).
  4664                 24  AM-L-COMA             PIC XXX.
  4665                 24  AM-J-COMA             PIC XXX.
  4666                 24  AM-A-COMA             PIC XXX.
  4667                 24  FILLER                PIC X(6).
  4668
  4669     12  AM-COMM-CHANGE-STATUS             PIC X.
  4670         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4671
  4672     12  AM-CSR-CODE                       PIC X(4).
  4673
  4674     12  AM-BILLING-STATUS                 PIC X.
  4675         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4676         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4677     12  AM-AUTO-REFUND-SW                 PIC X.
  4678         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4679         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4680     12  AM-GPCD                           PIC 99.
  4681     12  AM-IG                             PIC X.
  4682         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4683         88  AM-HAS-GROUP                     VALUE '2'.
  4684     12  AM-STATUS                         PIC X.
  4685         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4686         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4687         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4688         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4689         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4690     12  AM-REMIT-TO                       PIC 99.
  4691     12  AM-ID-NO                          PIC X(11).
  4692
  4693     12  AM-CAL-TABLE                      PIC XX.
  4694     12  AM-LF-DEVIATION                   PIC XXX.
  4695     12  AM-AH-DEVIATION                   PIC XXX.
  4696     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4697     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4698     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4699     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4700     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4701     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4702
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL642.cbl
  4703     12  AM-USER-FIELDS.
  4704         16  AM-FLD-1                      PIC XX.
  4705         16  AM-FLD-2                      PIC XX.
  4706         16  AM-FLD-3                      PIC XX.
  4707         16  AM-FLD-4                      PIC XX.
  4708         16  AM-FLD-5                      PIC XX.
  4709
  4710     12  AM-1ST-PROD-DATE.
  4711         16  AM-1ST-PROD-YR                PIC XX.
  4712         16  AM-1ST-PROD-MO                PIC XX.
  4713         16  AM-1ST-PROD-DA                PIC XX.
  4714     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4715     12  AM-CERTS-PURGED-DATE.
  4716         16  AM-PUR-YR                     PIC XX.
  4717         16  AM-PUR-MO                     PIC XX.
  4718         16  AM-PUR-DA                     PIC XX.
  4719     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4720     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4721     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4722     12  AM-INACTIVE-DATE.
  4723         16  AM-INA-MO                     PIC 99.
  4724         16  AM-INA-DA                     PIC 99.
  4725         16  AM-INA-YR                     PIC 99.
  4726     12  AM-AR-HI-CERT-DATE                PIC XX.
  4727
  4728     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4729     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4730
  4731     12  AM-OB-PAYMENT-MODE                PIC X.
  4732         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4733         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4734         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4735         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4736
  4737     12  AM-AH-ONLY-INDICATOR              PIC X.
  4738         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4739         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4740
  4741     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4742
  4743     12  AM-OVER-SHORT.
  4744         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4745         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4746
  4747     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4748     12  AM-DCC-CLP-STATE                  PIC XX.
  4749
  4750     12  AM-RECALC-COMM                    PIC X.
  4751     12  AM-RECALC-REIN                    PIC X.
  4752
  4753     12  AM-REI-TABLE                      PIC XXX.
  4754     12  AM-REI-ET-LF                      PIC X.
  4755     12  AM-REI-ET-AH                      PIC X.
  4756     12  AM-REI-PE-LF                      PIC X.
  4757     12  AM-REI-PE-AH                      PIC X.
  4758     12  AM-REI-PRT-ST                     PIC X.
  4759     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4760     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL642.cbl
  4761     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4762     12  AM-REI-GROUP-A                    PIC X(6).
  4763     12  AM-REI-MORT                       PIC X(4).
  4764     12  AM-REI-PRT-OW                     PIC X.
  4765     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4766     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4767     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4768     12  AM-REI-GROUP-B                    PIC X(6).
  4769
  4770     12  AM-TRUST-TYPE                     PIC X(2).
  4771
  4772     12  AM-EMPLOYER-STMT-USED             PIC X.
  4773     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4774
  4775     12  AM-STD-AH-TYPE                    PIC XX.
  4776     12  AM-EARN-METHODS.
  4777         16  AM-EARN-METHOD-R              PIC X.
  4778             88 AM-REF-RL-R78                 VALUE 'R'.
  4779             88 AM-REF-RL-PR                  VALUE 'P'.
  4780             88 AM-REF-RL-MEAN                VALUE 'M'.
  4781             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4782         16  AM-EARN-METHOD-L              PIC X.
  4783             88 AM-REF-LL-R78                 VALUE 'R'.
  4784             88 AM-REF-LL-PR                  VALUE 'P'.
  4785             88 AM-REF-LL-MEAN                VALUE 'M'.
  4786             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4787         16  AM-EARN-METHOD-A              PIC X.
  4788             88 AM-REF-AH-R78                 VALUE 'R'.
  4789             88 AM-REF-AH-PR                  VALUE 'P'.
  4790             88 AM-REF-AH-MEAN                VALUE 'M'.
  4791             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4792             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4793             88 AM-REF-AH-NET                 VALUE 'N'.
  4794
  4795     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4796     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4797     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4798
  4799     12  AM-RET-Y-N                        PIC X.
  4800     12  AM-RET-P-E                        PIC X.
  4801     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4802     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4803     12  AM-RET-GRP                        PIC X(6).
  4804     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4805         16  AM-POOL-PRIME                 PIC XXX.
  4806         16  AM-POOL-SUB                   PIC XXX.
  4807     12  AM-RETRO-EARNINGS.
  4808         16  AM-RET-EARN-R                 PIC X.
  4809         16  AM-RET-EARN-L                 PIC X.
  4810         16  AM-RET-EARN-A                 PIC X.
  4811     12  AM-RET-ST-TAX-USE                 PIC X.
  4812         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4813         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4814     12  AM-RETRO-BEG-EARNINGS.
  4815         16  AM-RET-BEG-EARN-R             PIC X.
  4816         16  AM-RET-BEG-EARN-L             PIC X.
  4817         16  AM-RET-BEG-EARN-A             PIC X.
  4818     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL642.cbl
  4819     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4820
  4821     12  AM-USER-SELECT-OPTIONS.
  4822         16  AM-USER-SELECT-1              PIC X(10).
  4823         16  AM-USER-SELECT-2              PIC X(10).
  4824         16  AM-USER-SELECT-3              PIC X(10).
  4825         16  AM-USER-SELECT-4              PIC X(10).
  4826         16  AM-USER-SELECT-5              PIC X(10).
  4827
  4828     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4829
  4830     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4831
  4832     12  AM-RPT045A-SWITCH                 PIC X.
  4833         88  RPT045A-OFF                   VALUE 'N'.
  4834
  4835     12  AM-INSURANCE-LIMITS.
  4836         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4837         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4838
  4839     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4840         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4841
  4842     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4843         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4844         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4845
  4846     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4847
  4848     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4849     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4850     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4851     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4852     12  FILLER                            PIC X(5).
  4853     12  AM-REPORT-CODE-3                  PIC X(10).
  4854*    12  FILLER                            PIC X(22).
  4855
  4856     12  AM-RESERVE-DATE.
  4857         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4858         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4859         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4860
  4861     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4862     12  AM-NOTIFICATION-TYPES.
  4863         16  AM-NOTIF-OF-LETTERS           PIC X.
  4864         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4865         16  AM-NOTIF-OF-REPORTS           PIC X.
  4866         16  AM-NOTIF-OF-STATUS            PIC X.
  4867
  4868     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4869         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4870         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4871         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4872         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4873
  4874     12  AM-BENEFIT-CONTROLS.
  4875         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4876             20  AM-BENEFIT-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL642.cbl
  4877             20  AM-BENEFIT-TYPE           PIC X.
  4878             20  AM-BENEFIT-REVISION       PIC XXX.
  4879             20  AM-BENEFIT-REM-TERM       PIC X.
  4880             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4881             20  FILLER                    PIC XX.
  4882         16  FILLER                        PIC X(80).
  4883
  4884     12  AM-TRANSFER-DATA.
  4885         16  AM-TRANSFERRED-FROM.
  4886             20  AM-TRNFROM-CARRIER        PIC X.
  4887             20  AM-TRNFROM-GROUPING.
  4888                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4889                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4890             20  AM-TRNFROM-STATE          PIC XX.
  4891             20  AM-TRNFROM-ACCOUNT.
  4892                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4893                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4894             20  AM-TRNFROM-DTE            PIC XX.
  4895         16  AM-TRANSFERRED-TO.
  4896             20  AM-TRNTO-CARRIER          PIC X.
  4897             20  AM-TRNTO-GROUPING.
  4898                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4899                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4900             20  AM-TRNTO-STATE            PIC XX.
  4901             20  AM-TRNTO-ACCOUNT.
  4902                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4903                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4904             20  AM-TRNTO-DTE              PIC XX.
  4905         16  FILLER                        PIC X(10).
  4906
  4907     12  AM-SAVED-REMIT-TO                 PIC 99.
  4908
  4909     12  AM-COMM-STRUCTURE-SAVED.
  4910         16  AM-DEFN-1-SAVED.
  4911             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4912                 24  AM-AGT-SV             PIC X(10).
  4913                 24  AM-COM-TYP-SV         PIC X.
  4914                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4915                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4916                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4917                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4918                 24  FILLER                PIC X.
  4919                 24  AM-GL-CODES-SV        PIC X.
  4920                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4921                 24  FILLER                PIC X.
  4922         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4923             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4924                 24  FILLER                PIC X(11).
  4925                 24  AM-L-COMA-SV          PIC XXX.
  4926                 24  AM-J-COMA-SV          PIC XXX.
  4927                 24  AM-A-COMA-SV          PIC XXX.
  4928                 24  FILLER                PIC X(6).
  4929
  4930     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4931         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4932            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4933            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4934            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL642.cbl
  4935
  4936     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4937     12  FILLER                            PIC X(120).
  4938
  4939     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4940         16  AM-CONTROL-NAME               PIC X(30).
  4941         16  AM-EXECUTIVE-ONE.
  4942             20  AM-EXEC1-NAME             PIC X(15).
  4943             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4944                                                          COMP-3.
  4945             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4946                                                          COMP-3.
  4947         16  AM-EXECUTIVE-TWO.
  4948             20  AM-EXEC2-NAME             PIC X(15).
  4949             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4950                                                          COMP-3.
  4951             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4952                                                          COMP-3.
  4953
  4954     12  AM-RETRO-ADDITIONAL-DATA.
  4955         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4956         16  AM-RETRO-PREM-P-E             PIC X.
  4957         16  AM-RETRO-CLMS-P-I             PIC X.
  4958         16  AM-RETRO-RET-BRACKET-LF.
  4959             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4960                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4961                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4962             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4963                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4964                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4965             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4966                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4967                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4968         16  AM-RETRO-RET-BRACKET-AH.
  4969             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4970                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4971                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4972                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4973             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4974                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4975                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4976             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4977                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4978                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4979
  4980     12  AM-COMMENTS.
  4981         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4982
  4983     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4984         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4985         16  AM-FLI-BILLING-CODE           PIC X.
  4986         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4987         16  AM-FLI-UNITED-IDENT           PIC X.
  4988         16  AM-FLI-INTEREST-LOST-DATA.
  4989             20  AM-FLI-BANK-NO            PIC X(5).
  4990             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4991             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4992             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL642.cbl
  4993         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4994             20  AM-FLI-AGT                PIC X(9).
  4995             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4996             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4997         16  FILLER                        PIC X(102).
  4998
  4999     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5000         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5001             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5002             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5003             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5004             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5005             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5006         16  FILLER                          PIC X(10).
  5007******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL642.cbl
  5009*                            COPY ERCBILL.
  5010******************************************************************
  5011*                                                                *
  5012*                                                                *
  5013*                            ERCBILL                             *
  5014*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5015*                            VMOD=2.007                          *
  5016*                                                                *
  5017*   FILE DESCRIPTION = BILLING STATEMENTS FOR PRINTING           *
  5018*                                                                *
  5019*   FILE TYPE = VSAM,KSDS                                        *
  5020*   RECORD SIZE = 210  RECFORM = FIXED                           *
  5021*                                                                *
  5022*   BASE CLUSTER = ERBILL                        RKP=2,LEN=31    *
  5023*                                                                *
  5024*   LOG = NO                                                     *
  5025*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5026******************************************************************
  5027 01  BILLING-STATEMENT.
  5028     02 BILLING-STATEMENT-FILE.
  5029     12  BI-RECORD-ID                PIC XX.
  5030         88  VALID-BI-ID                VALUE 'BI'.
  5031
  5032     12  BI-CONTROL-PRIMARY.
  5033         16  BI-COMPANY-CD           PIC X.
  5034         16  BI-CARRIER              PIC X.
  5035         16  BI-GROUPING             PIC X(6).
  5036         16  BI-ACCOUNT              PIC X(10).
  5037         16  BI-FIN-RESP             PIC X(10).
  5038         16  BI-RECORD-TYPE          PIC X.
  5039             88  BI-HEADER-DATA         VALUE '1'.
  5040             88  BI-ADDRESS-DATA        VALUE '2'.
  5041             88  BI-TEXT-DATA           VALUE '3'.
  5042         16  BI-LINE-SEQ-NO          PIC S9(4)     COMP.
  5043
  5044     12  BI-TEXT-RECORD.
  5045         16  BI-SKIP-CONTROL         PIC X.
  5046         16  BI-TEXT-LINE            PIC X(157).
  5047         16  BI-TEXT-LINE-1 REDEFINES BI-TEXT-LINE.
  5048             20  BI-ADDR-LIT         PIC X(14).
  5049             20  BI-CO               PIC X(7).
  5050             20  BI-DASH             PIC X.
  5051             20  BI-ACCT             PIC X(10).
  5052             20  FILLER              PIC XX.
  5053             20  BI-ACCT-ADDR        PIC X(30).
  5054             20  FILLER              PIC X.
  5055             20  BI-REMIT-LIT        PIC X(11).
  5056             20  FILLER              PIC XX.
  5057             20  BI-REMIT-ADDR       PIC X(30).
  5058             20  FILLER              PIC X(49).
  5059         16  BI-TEXT-LINE-2 REDEFINES BI-TEXT-LINE.
  5060             20  BI-INS-LAST-NAME    PIC X(15).
  5061             20  FILLER              PIC X.
  5062             20  BI-INS-1ST-NAME     PIC X(10).
  5063             20  FILLER REDEFINES BI-INS-1ST-NAME.
  5064                 24  BI-INS-INITS    PIC XX.
  5065                 24  FILLER          PIC X(8).
  5066             20  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL642.cbl
  5067             20  BI-UNDRWRTR.
  5068                 24  BI-INS-INIT     PIC X.
  5069                 24  FILLER          PIC XXX.
  5070             20  BI-CERT             PIC X(11).
  5071             20  FILLER              PIC XX.
  5072             20  BI-EFF-DT           PIC X(8).
  5073             20  FILLER              PIC XX.
  5074             20  BI-CAN-DT           PIC X(8).
  5075             20  FILLER              PIC XX.
  5076             20  BI-ED-TERM          PIC ZZZ.
  5077             20  FILLER              PIC XX.
  5078             20  BI-TYPE             PIC XXXX.
  5079             20  FILLER              PIC X.
  5080             20  BI-PREM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5081             20  FILLER              PIC X(3).
  5082             20  BI-ED-RATE          PIC ZZZ.ZZZ.
  5083             20  FILLER              PIC XX.
  5084             20  BI-COMM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5085             20  FILLER              PIC XX.
  5086             20  BI-FACE-AMT         PIC ZZZ,ZZZ,ZZZ.ZZ-.
  5087             20  FILLER              PIC X(26).
  5088         16  BI-TEXT-LINE-3 REDEFINES BI-TEXT-LINE.
  5089             20  FILLER              PIC X(42).
  5090             20  BI-TOT-DESC         PIC X(20).
  5091             20  FILLER REDEFINES BI-TOT-DESC.
  5092                 24  BI-TOT-LIT      PIC X(6).
  5093                 24  BI-OVERRIDE-L6  PIC X(14).
  5094             20  FILLER              PIC X(11).
  5095             20  BI-TOT-PREM         PIC ZZZ,ZZZ,ZZZ.99-.
  5096             20  BI-TOT-DASH REDEFINES
  5097                 BI-TOT-PREM         PIC X(15).
  5098             20  FILLER              PIC X(11).
  5099             20  BI-COM-TOT          PIC ZZZ,ZZZ,ZZZ.99-.
  5100             20  FILLER              PIC XX.
  5101             20  BI-FACE-TOT         PIC ZZZ,ZZZ,ZZZ.99-.
  5102             20  FILLER              PIC X(26).
  5103         16  BI-TEXT-LINE-4 REDEFINES BI-TEXT-LINE.
  5104             20  BI-ENTRY-DESC       PIC X(30).
  5105             20  FILLER              PIC X(11).
  5106             20  BI-ENTRY-AMT        PIC ZZZZ,ZZZ,ZZZ.99-.
  5107             20  FILLER              PIC X(31).
  5108             20  BI-ACCTG-COMMENT    PIC X(30).
  5109             20  FILLER              PIC X(39).
  5110         16  BI-TEXT-LINE-5 REDEFINES BI-TEXT-LINE.
  5111             20  FILLER              PIC X(42).
  5112             20  BI-TOT-DESC5        PIC X(20).
  5113             20  FILLER              PIC X(11).
  5114             20  BI-TOT-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5115             20  BI-COM-TOT5         PIC ZZZ,ZZZ,ZZZ.99-.
  5116             20  BI-NON-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5117             20  BI-NON-COMM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5118             20  FILLER              PIC X(24).
  5119         16  BI-TEXT-FIRST REDEFINES BI-TEXT-LINE.
  5120             20  BI-TEXT-2-81        PIC X(80).
  5121             20  FILLER              PIC X(77).
  5122         16  BI-TEXT-LAST REDEFINES BI-TEXT-LINE.
  5123             20  FILLER              PIC X(53).
  5124             20  BI-TEXT-55-133      PIC X(79).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL642.cbl
  5125             20  FILLER              PIC X(25).
  5126         16  BI-TEXT-TYPE            PIC X.
  5127             88 DETAIL-LINE              VALUE 'D'.
  5128         16  BI-TERM                 PIC S999.
  5129         16  BI-BENEFIT-AMT          PIC S9(9)V99 COMP-3.
  5130         16  BI-PREMIUM-AMT          PIC S9(7)V99 COMP-3.
  5131         16  BI-RATE                 PIC S99V9(5) COMP-3.
  5132
  5133     12  BI-ADDRESS-RECORD  REDEFINES  BI-TEXT-RECORD.
  5134         16  FILLER                  PIC X.
  5135         16  BI-ACCT-ADDRESS-LINE    PIC X(30).
  5136         16  FILLER                  PIC X(10).
  5137         16  BI-REMIT-ADDRESS-LINE   PIC X(30).
  5138         16  FILLER                  PIC X(106).
  5139
  5140     12  BI-HEADER-RECORD  REDEFINES  BI-TEXT-RECORD.
  5141         16  BI-PROCESSOR-CD         PIC X(4).
  5142         16  BI-STATEMENT-TYPE       PIC X.
  5143             88  BI-PREVIEW-ONLY         VALUE 'P'.
  5144         16  BI-NO-OF-COPIES         PIC S9.
  5145         16  BI-CREATION-DT          PIC XX.
  5146         16  BI-INITIAL-PRINT-DATE   PIC XX.
  5147         16  BI-ACCOUNT-TOTALS.
  5148             20  BI-BAL-FRWD         PIC S9(9)V99     COMP-3.
  5149             20  BI-PREMIUM          PIC S9(9)V99     COMP-3.
  5150             20  BI-REMITTED         PIC S9(9)V99     COMP-3.
  5151             20  BI-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5152             20  BI-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5153             20  BI-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5154             20  BI-DISBURSED        PIC S9(9)V99     COMP-3.
  5155             20  BI-END-BAL          PIC S9(9)V99     COMP-3.
  5156         16  BI-FIN-RESP-ACCT        PIC X(10).
  5157         16  BI-FIN-RESP-NAME        PIC X(30).
  5158         16  FILLER                  PIC X(79).
  5159
  5160
  5161     02 GA-BILLING-STATEMENT REDEFINES BILLING-STATEMENT-FILE.
  5162     12  FILLER                      PIC XX.
  5163
  5164     12  GA-CONTROL-PRIMARY.
  5165         16  FILLER                  PIC X(31).
  5166
  5167     12  GA-TEXT-RECORD.
  5168         16  GA-SKIP-CONTROL         PIC X.
  5169         16  GA-TEXT-LINE            PIC X(132).
  5170         16  GA-TEXT-LINE-1 REDEFINES GA-TEXT-LINE.
  5171             20  FILLER              PIC X.
  5172             20  GA-CARRIER          PIC X.
  5173             20  GA-GROUPING         PIC X(6).
  5174             20  GA-DASH             PIC X.
  5175             20  GA-AGENT            PIC X(10).
  5176             20  FILLER              PIC X.
  5177             20  GA-AGENT-ADDR       PIC X(30).
  5178             20  FILLER              PIC X(82).
  5179         16  GA-TEXT-LINE-2 REDEFINES GA-TEXT-LINE.
  5180             20  GA-ACCT             PIC X(10).
  5181             20  FILLER              PIC X.
  5182             20  GA-ACCT-NAME        PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL642.cbl
  5183             20  GA-BEG-BAL          PIC ZZZZ,ZZZ.99-.
  5184             20  GA-NET-PREM         PIC ZZZZ,ZZZ.ZZ-.
  5185             20  GA-ACCT-COMP        PIC ZZZZ,ZZZ.ZZ-.
  5186             20  GA-PMTS-ADJS        PIC ZZZZ,ZZZ.ZZ-.
  5187             20  GA-UNPAID-NET-PREM  PIC ZZZZ,ZZZ.ZZ-.
  5188             20  GA-BEN-OVERRIDE-L6  PIC X(6).
  5189             20  FILLER              PIC X.
  5190             20  GA-OVERWRITE        PIC ZZZZ,ZZZ.ZZ-.
  5191             20  GA-AMT-DUE          PIC ZZZ,ZZZ.99-.
  5192             20  FILLER              PIC X.
  5193         16  GA-TEXT-LINE-3 REDEFINES GA-TEXT-LINE.
  5194             20  FILLER              PIC X(11).
  5195             20  GA-ENTRY-DESC       PIC X(30).
  5196             20  FILLER              PIC X(60).
  5197             20  GA-ENTRY-COMMENT    PIC X(30).
  5198             20  FILLER              PIC X.
  5199         16  FILLER.
  5200             20  GA-BENEFIT-CD       PIC XX.
  5201             20  GA-BEG-BAL-AMT      PIC S9(7)V99 COMP-3.
  5202             20  GA-END-BAL-AMT      PIC S9(7)V99 COMP-3.
  5203             20  GA-NET-PREM-AMT     PIC S9(7)V99 COMP-3.
  5204             20  GA-ACCT-COMP-AMT    PIC S9(7)V99 COMP-3.
  5205             20  GA-PMTS-ADJS-AMT    PIC S9(7)V99 COMP-3.
  5206             20  GA-UNPAID-NET-AMT   PIC S9(7)V99 COMP-3.
  5207             20  GA-OVERWRITE-AMT    PIC S9(7)V99 COMP-3.
  5208             20  GA-AMT-DUE-AMT      PIC S9(7)V99 COMP-3.
  5209
  5210     12  GA-ADDRESS-RECORD  REDEFINES  GA-TEXT-RECORD.
  5211         16  FILLER                  PIC X.
  5212         16  GA-ACCT-ADDRESS-LINE    PIC X(30).
  5213         16  FILLER                  PIC X(144).
  5214
  5215     12  GA-HEADER-RECORD  REDEFINES  GA-TEXT-RECORD.
  5216         16  GA-PROCESSOR-CD         PIC X(4).
  5217         16  GA-STATEMENT-TYPE       PIC X.
  5218             88  GA-PREVIEW-ONLY         VALUE 'P'.
  5219         16  GA-NO-OF-COPIES         PIC S9.
  5220         16  GA-CREATION-DT          PIC XX.
  5221         16  GA-INITIAL-PRINT-DATE   PIC XX.
  5222         16  GA-AGENT-TOTALS.
  5223             20  GA-NET-UNPD         PIC S9(9)V99     COMP-3.
  5224             20  GA-COMP-UNPD-PREM   PIC S9(9)V99     COMP-3.
  5225             20  GA-PREMIUM          PIC S9(9)V99     COMP-3.
  5226             20  GA-REMITTED         PIC S9(9)V99     COMP-3.
  5227             20  GA-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5228             20  GA-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5229             20  GA-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5230             20  GA-DISBURSED        PIC S9(9)V99     COMP-3.
  5231             20  GA-END-BALANCE      PIC S9(9)V99     COMP-3.
  5232         16  GA-AGENTS-NAME          PIC X(30).
  5233         16  FILLER                  PIC X(81).
  5234     12  FILLER                      PIC XX.
  5235
  5236
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL642.cbl
  5238*                            COPY ERCCOMM.
  5239******************************************************************
  5240*                                                                *
  5241*                                                                *
  5242*                            ERCCOMM                             *
  5243*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5244*                            VMOD=2.003                          *
  5245*                                                                *
  5246*        FILE DESCRIPTION = COMPENSATION RATES WHEN DIFFERENT    *
  5247*                             FROM THOSE IN ACCOUNT MASTER       *
  5248*                                                                *
  5249*        FILE TYPE= VSAM,KSDS                                    *
  5250*        RECORD SIZE = 250    RECFORM = FIXED                    *
  5251*                                                                *
  5252*        BASE CLUSTER = CRCOMM        RKP=2,LEN=33               *
  5253*                                                                *
  5254*        LOG = YES                                               *
  5255*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5256*                                                                *
  5257******************************************************************
  5258
  5259 01  COMMISSION-EXCEPTIONS.
  5260     12  CE-RECORD-ID                PIC  XX.
  5261         88  VALID-CE-ID         VALUE 'CE'.
  5262
  5263     12  CE-CONTROL-PRIMARY.
  5264         16  CE-COMPANY-CD           PIC  X.
  5265         16  CE-CARRIER              PIC  X.
  5266         16  CE-GROUPING             PIC  X(6).
  5267         16  CE-STATE                PIC  XX.
  5268         16  CE-ACCOUNT              PIC  X(10).
  5269         16  CE-CERT-EFF-DT          PIC  XX.
  5270         16  CE-CERT-NO.
  5271             20  CE-CERT-PRIME       PIC  X(10).
  5272             20  CE-CERT-SFX         PIC  X.
  5273
  5274     12  CE-CERT-EXPIRATION-DT       PIC  XX.
  5275
  5276     12  CE-COMP-STRUCTURE.
  5277         16  CE-DEFN-1.
  5278             20  CE-AGT-COMMS       OCCURS 10 TIMES.
  5279                 24  CE-AGENT-NO    PIC  X(10).
  5280                 24  CE-COMP-TYPE   PIC  X.
  5281                 24  CE-LF-COMP     PIC SV9(5)      COMP-3.
  5282                 24  CE-AH-COMP     PIC SV9(5)      COMP-3.
  5283         16  CE-DEFN-2              REDEFINES CE-DEFN-1.
  5284             20  CE-COMP-TABLES     OCCURS 10 TIMES.
  5285                 24  FILLER         PIC  X(11).
  5286                 24  CE-LF-COMPT    PIC  X(3).
  5287                 24  CE-AH-COMPT    PIC  X(3).
  5288
  5289     12  FILLER                     PIC  X(43).
  5290******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL642.cbl
  5292*                            COPY ERCCTBL.
  5293******************************************************************
  5294*                                                                *
  5295*                                                                *
  5296*                            ERCCTBL                             *
  5297*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5298*                            VMOD=2.003
  5299*                                                                *
  5300*   ONLINE CREDIT SYSTEM                                         *
  5301*                                                                *
  5302*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  5303*                                                                *
  5304*   FILE TYPE = VSAM,KSDS                                        *
  5305*   RECORD SIZE = 200   RECFORM = FIXED                          *
  5306*                                                                *
  5307*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  5308*       ALTERNATE PATH = NONE                                    *
  5309*                                                                *
  5310*   LOG = NO                                                     *
  5311*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5312*                                                                *
  5313*                                                                *
  5314******************************************************************
  5315
  5316 01  COMM-TABLE-RECORD.
  5317     12  CT-RECORD-ID                      PIC XX.
  5318         88  VALID-CT-ID                      VALUE 'CT'.
  5319
  5320     12  CT-CONTROL-PRIMARY.
  5321         16  CT-COMPANY-CD                 PIC X.
  5322         16  CT-TABLE                      PIC XXX.
  5323         16  CT-CNTRL-2.
  5324             20  CT-BEN-TYPE               PIC X.
  5325             20  CT-BEN-CODE               PIC XX.
  5326
  5327     12  CT-MAINT-INFORMATION.
  5328         16  CT-LAST-MAINT-DT              PIC XX.
  5329         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5330         16  CT-LAST-MAINT-USER            PIC X(4).
  5331         16  FILLER                        PIC X(31).
  5332
  5333     12  CT-LIMITS.
  5334         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  5335
  5336         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  5337
  5338         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  5339
  5340     12  CT-RATES.
  5341         16  CT-RTX          OCCURS 27 TIMES.
  5342             20  CT-RT                     PIC SV9(5)     COMP-3.
  5343             20  CT-RT-R   REDEFINES
  5344                 CT-RT                     PIC XXX.
  5345
  5346     12  FILLER                            PIC  X(42).
  5347
  5348******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL642.cbl
  5350*                            COPY ERCGXRF.
  5351******************************************************************
  5352*                                                                *
  5353*                                                                *
  5354*                            ERCGXRF                             *
  5355*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5356*                            VMOD=2.002                          *
  5357*                                                                *
  5358*   ONLINE CREDIT SYSTEM                                         *
  5359*                                                                *
  5360*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
  5361*                                                                *
  5362*   FILE TYPE = VSAM,KSDS                                        *
  5363*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  5364*                                                                *
  5365*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
  5366*       ALTERNATE PATH = NONE                                    *
  5367*                                                                *
  5368*   LOG = NO                                                     *
  5369*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5370*                                                                *
  5371******************************************************************
  5372
  5373 01  AGENT-CROSS-REFERENCE.
  5374     12  GX-RECORD-ID                PIC XX.
  5375         88  VALID-GX-ID             VALUE 'GX'.
  5376
  5377     12  GX-CONTROL-PRIMARY.
  5378         16  GX-COMPANY-CD           PIC X.
  5379         16  GX-CARRIER              PIC X.
  5380         16  GX-GROUPING             PIC X(6).
  5381         16  GX-AGENT-NO             PIC X(10).
  5382
  5383     12  GX-MAINT-INFORMATION.
  5384         16  GX-LAST-MAINT-DT        PIC XX.
  5385         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  5386         16  GX-LAST-MAINT-USER      PIC X(4).
  5387         16  FILLER                  PIC X(9).
  5388
  5389     12  FILLER                      PIC X(37).
  5390
  5391     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
  5392
  5393     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
  5394                            DEPENDING ON GX-AGENT-POINTER-CNT.
  5395         16  GX-AM-CARRIER           PIC X.
  5396         16  GX-AM-GROUPING          PIC X(6).
  5397         16  GX-AM-STATE             PIC XX.
  5398         16  GX-AM-ACCOUNT           PIC X(10).
  5399         16  GX-AM-EXPIRATION-DT     PIC XX.
  5400         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
  5401         16  GX-LAST-BILL-DT         PIC XX.
  5402         16  GX-AM-EFF-DT            PIC XX.
  5403         16  FILLER                  PIC X(4).
  5404
  5405******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL642.cbl
  5407*                            COPY ERCRESC.
  5408******************************************************************
  5409*                                                                *
  5410*                            ERCRESC                             *
  5411*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5412*                            VMOD=2.003                          *
  5413*                                                                *
  5414*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  5415*                                                                *
  5416*   FILE TYPE = VSAM,KSDS                                        *
  5417*   RECORD SIZE = 103 RECFORM = FIXED                            *
  5418*                                                                *
  5419*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  5420*       ALTERNATE PATH1 = NONE                                   *
  5421*                                                                *
  5422*   LOG = NO                                                     *
  5423*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5424*                                                                *
  5425******************************************************************
  5426
  5427 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  5428
  5429     10  ERRESC-RECORD-KEY.
  5430         15  RESC-COMPANY-CD           PIC   X.
  5431         15  RESC-CARRIER              PIC   X.
  5432         15  RESC-GROUP                PIC   X(6).
  5433         15  RESC-STATE                PIC   XX.
  5434         15  RESC-ACCOUNT              PIC   X(10).
  5435         15  RESC-AGENT                PIC   X(10).
  5436         15  RESC-RESIDENT-STATE       PIC   XX.
  5437         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  5438*                                           YYYYMMDD
  5439     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  5440
  5441     10  RESC-COMM-RECORD-DATA.
  5442         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  5443             20 RESC-COVERAGE-CAT      PIC    X.
  5444             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  5445             20 RESC-COMMISSION-TAB REDEFINES
  5446                RESC-COMMISSION-PER    PIC  XXX.
  5447
  5448     10  RESC-MAINT-BY                 PIC X(4).
  5449     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  5450     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  5451*                                          YYYYMMDD
  5452
  5453 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  5454                          CONTROL-FILE COMPENSATION-MASTER
  5455                          PENDING-PAY-ADJ ACCOUNT-MASTER
  5456                          BILLING-STATEMENT
  5457                          COMMISSION-EXCEPTIONS
  5458                          COMM-TABLE-RECORD
  5459                          AGENT-CROSS-REFERENCE
  5460                          ACCOUNT-RESIDENT-ST-COMMISSION.
  5461 0000-DFHEXIT SECTION.
  5462     MOVE '9#                    $   ' TO DFHEIV0.
  5463     MOVE 'EL642' TO DFHEIV1.
  5464     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL642.cbl
  5465
  5466     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5467     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5468     MOVE EIBTRMID               TO  QID-TERM.
  5469     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5470     MOVE '5'                    TO  DC-OPTION-CODE.
  5471
  5472     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  5473
  5474     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-DATE.
  5475     MOVE DC-GREG-DATE-1-MDY     TO  WS-CURRENT-DATE-MDY.
  5476     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DATE-EDIT.
  5477
  5478     IF EIBCALEN  =  ZERO
  5479         GO TO 8800-UNAUTHORIZED-ACCESS.
  5480
  5481     IF PI-RETURN-TO-PROGRAM  =  THIS-PGM
  5482         MOVE PI-CALLING-PROGRAM  TO  RETURNED-FROM.
  5483
  5484     IF PI-CALLING-PROGRAM NOT  =  THIS-PGM
  5485         IF PI-RETURN-TO-PROGRAM NOT  =  THIS-PGM
  5486             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  5487             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5488             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5489             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5490             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5491             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5492             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5493             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5494             MOVE PI-CR-CONTROL-IN-PROGRESS
  5495                                        TO  W-TRANSFER-CONTROL
  5496             MOVE SPACES
  5497                                   TO  PI-CR-CONTROL-IN-PROGRESS
  5498         ELSE
  5499             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5500             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5501             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  5502             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5503             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  5504             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  5505             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  5506             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  5507
  5508     MOVE LOW-VALUES             TO  EL642AI.
  5509
  5510     IF PI-AR-PROCESSING
  5511        MOVE XCTL-635            TO XCTL-PYAJ.
  5512
  5513     IF PI-COMPANY-ID = 'DMD'
  5514        MOVE XCTL-633DMD         TO XCTL-PYAJ.
  5515
  5516     IF RETURNED-FROM  NOT =  SPACES
  5517         PERFORM 0600-RECOVER-TEMP-STORAGE  THRU  0690-EXIT
  5518         IF RETURNED-FROM  =  XCTL-PYAJ
  5519           AND  NOT  PI-VOID-BILL
  5520             MOVE ZEROS          TO  PI-ADJUSTMNTS
  5521                                     PI-DISBURSED
  5522                                     PI-REMITTED
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL642.cbl
  5523             GO TO 1200-PYAJ-BILLING-COMPLETE
  5524         ELSE
  5525             MOVE -1             TO  APFNTERL
  5526             IF PI-TRANSFER-BEFORE-ACT
  5527                 GO TO 8100-SEND-INITIAL-MAP
  5528             ELSE
  5529                 PERFORM 5000-FORMAT-SCREEN  THRU  5090-EXIT
  5530                 GO TO 8100-SEND-INITIAL-MAP.
  5531
  5532     IF EIBTRNID  NOT =  TRANS-ID
  5533         MOVE EL642A             TO  PI-MAP-NAME
  5534         MOVE -1                 TO  APFNTERL
  5535         GO TO 8100-SEND-INITIAL-MAP.
  5536
  5537
  5538* EXEC CICS HANDLE CONDITION
  5539*        PGMIDERR  (9600-PGMID-ERROR)
  5540*        ERROR     (9990-ABEND)
  5541*    END-EXEC.
  5542*    MOVE '"$L.                  ! " #00005533' TO DFHEIV0
  5543     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5544     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5545     MOVE X'2220233030303035353333' TO DFHEIV0(25:11)
  5546     CALL 'kxdfhei1' USING DFHEIV0
  5547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5548
  5549
  5550     IF EIBAID  =  DFHCLEAR
  5551         IF PI-MAP-NAME  =  EL642B
  5552             PERFORM 5000-FORMAT-SCREEN  THRU  5090-EXIT
  5553             MOVE EL642A         TO  PI-MAP-NAME
  5554             MOVE -1             TO  APFNTERL
  5555             GO TO 8100-SEND-INITIAL-MAP
  5556         ELSE
  5557             GO TO 9400-CLEAR.
  5558
  5559     IF PI-PROCESSOR-ID  =  'LGXX'
  5560         GO TO 0200-RECEIVE.
  5561
  5562
  5563* EXEC CICS READQ TS
  5564*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5565*        INTO    (SECURITY-CONTROL)
  5566*        LENGTH  (SC-COMM-LENGTH)
  5567*        ITEM    (SC-ITEM)
  5568*    END-EXEC.
  5569*    MOVE '*$II   L              ''   #00005550' TO DFHEIV0
  5570     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5571     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5572     MOVE X'2020233030303035353530' TO DFHEIV0(25:11)
  5573     CALL 'kxdfhei1' USING DFHEIV0,
  5574           PI-SECURITY-TEMP-STORE-ID,
  5575           SECURITY-CONTROL,
  5576           SC-COMM-LENGTH,
  5577           SC-ITEM,
  5578           DFHEIV99,
  5579           DFHEIV99
  5580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL642.cbl
  5581
  5582
  5583     MOVE SC-CREDIT-DISPLAY (19)  TO  PI-DISPLAY-CAP.
  5584     MOVE SC-CREDIT-UPDATE  (19)  TO  PI-MODIFY-CAP.
  5585
  5586     IF NOT  DISPLAY-CAP
  5587         MOVE 'READ'              TO  SM-READ
  5588         PERFORM 9995-SECURITY-VIOLATION
  5589         MOVE ER-0070             TO  EMI-ERROR
  5590         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5591         GO TO 8100-SEND-INITIAL-MAP.
  5592
  5593 0200-RECEIVE.
  5594     IF EIBAID  =  DFHPA1  OR  DFHPA2  OR  DFHPA3
  5595         MOVE ER-0008            TO  EMI-ERROR
  5596         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5597         IF PI-MAP-NAME  =  EL642A
  5598             MOVE -1             TO  APFNTERL
  5599             GO TO 8200-SEND-DATAONLY
  5600         ELSE
  5601             MOVE -1             TO  BPFNTERL
  5602             GO TO 8200-SEND-DATAONLY.
  5603
  5604
  5605* EXEC CICS RECEIVE
  5606*        MAP     (PI-MAP-NAME)
  5607*        MAPSET  (MAPSET-NAME)
  5608*        INTO    (EL642AI)
  5609*    END-EXEC.
  5610     MOVE LENGTH OF
  5611      EL642AI
  5612       TO DFHEIV11
  5613*    MOVE '8"T I  L              ''   #00005578' TO DFHEIV0
  5614     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5615     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5616     MOVE X'2020233030303035353738' TO DFHEIV0(25:11)
  5617     CALL 'kxdfhei1' USING DFHEIV0,
  5618           PI-MAP-NAME,
  5619           EL642AI,
  5620           DFHEIV11,
  5621           MAPSET-NAME,
  5622           DFHEIV99,
  5623           DFHEIV99
  5624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5625
  5626
  5627     IF PI-MAP-NAME  =  EL642A
  5628         IF APFNTERL  GREATER THAN  ZERO
  5629             IF EIBAID  NOT =  DFHENTER
  5630                 MOVE ER-0004    TO  EMI-ERROR
  5631                 MOVE AL-UNBOF   TO  APFNTERA
  5632                 MOVE -1         TO  APFNTERL
  5633                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5634                 GO TO 8200-SEND-DATAONLY
  5635             ELSE
  5636                 IF APFNTERI  NUMERIC
  5637                   AND  APFNTERI  GREATER THAN  ZERO
  5638                   AND  APFNTERI  LESS THAN  25
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL642.cbl
  5639                     MOVE PF-VALUES (APFNTERI)  TO  EIBAID
  5640                 ELSE
  5641                     MOVE ER-0029   TO  EMI-ERROR
  5642                     MOVE AL-UNBOF  TO  APFNTERA
  5643                     MOVE -1        TO  APFNTERL
  5644                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5645                     GO TO 8200-SEND-DATAONLY
  5646         ELSE
  5647             NEXT SENTENCE
  5648     ELSE
  5649         IF PI-MAP-NAME  =  EL642B
  5650             IF BPFNTERL  GREATER THAN  ZERO
  5651                 IF EIBAID  NOT =  DFHENTER
  5652                     MOVE ER-0004   TO  EMI-ERROR
  5653                     MOVE AL-UNBOF  TO  BPFNTERA
  5654                     MOVE -1        TO  BPFNTERL
  5655                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5656                     GO TO 8200-SEND-DATAONLY
  5657                 ELSE
  5658                     IF BPFNTERI  NUMERIC
  5659                       AND  BPFNTERI  GREATER THAN  ZERO
  5660                       AND  BPFNTERI  LESS THAN  25
  5661                         MOVE PF-VALUES (BPFNTERI)  TO  EIBAID
  5662                     ELSE
  5663                         MOVE ER-0029   TO  EMI-ERROR
  5664                         MOVE AL-UNBOF  TO  BPFNTERA
  5665                         MOVE -1        TO  BPFNTERL
  5666                         PERFORM 9900-ERROR-FORMAT
  5667                             THRU  9900-EXIT
  5668                         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL642.cbl
  5670 0300-CHECK-PFKEYS.
  5671     IF EIBAID  =  DFHPF23
  5672         GO TO 8810-PF23.
  5673
  5674     IF EIBAID  =  DFHPF24
  5675         GO TO 9200-RETURN-MAIN-MENU.
  5676
  5677     IF EIBAID  =  DFHPF12
  5678         GO TO 9500-PF12.
  5679
  5680 0310-CHECK-PFKEYS.
  5681     IF EIBAID  =  DFHPF3
  5682       AND  PI-MAP-NAME  =  EL642A
  5683         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5684         MOVE SPACES             TO  PI-CR-CONTROL-IN-PROGRESS
  5685         MOVE XCTL-650           TO  PGM-NAME
  5686         GO TO 9300-XCTL.
  5687
  5688     IF EIBAID  =  DFHPF4
  5689       AND  PI-MAP-NAME  =  EL642A
  5690        NEXT SENTENCE
  5691     ELSE
  5692        GO TO 0320-CONT-PFKEYS.
  5693
  5694     IF PI-CR-FIN-RESP  NOT =  SPACES
  5695         MOVE PI-COMP-CARRIER   TO  PI-CR-CARRIER
  5696         MOVE PI-COMP-GROUPING  TO  PI-CR-GROUPING
  5697         MOVE SPACE             TO  PI-CR-STATE
  5698         MOVE LOW-VALUES        TO  PI-CR-ACCOUNT
  5699         MOVE PI-SAV-AGENT      TO  PI-CR-FIN-RESP
  5700         MOVE 'G'               TO  PI-CR-TYPE
  5701         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5702         MOVE XCTL-652       TO  PGM-NAME
  5703         GO TO 9300-XCTL.
  5704
  5705     IF PI-SCR-FIN-RESP EQUAL SPACES OR LOW-VALUES
  5706         GO TO 0315-PF4-ERROR.
  5707
  5708     PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT.
  5709
  5710     MOVE PI-SCR-CARRIER        TO  PI-CR-CARRIER.
  5711     MOVE PI-SCR-GROUPING       TO  PI-CR-GROUPING.
  5712     MOVE SPACE                 TO  PI-CR-STATE.
  5713     MOVE LOW-VALUES            TO  PI-CR-ACCOUNT.
  5714     MOVE PI-SCR-FIN-RESP       TO  PI-CR-FIN-RESP.
  5715     MOVE 'G'                   TO  PI-CR-TYPE.
  5716     MOVE 'Y'                   TO  PI-TRANSFER-SW.
  5717
  5718     IF PI-ZERO-CARRIER
  5719       OR  PI-ZERO-CAR-GROUP
  5720         MOVE ZEROS              TO  PI-CR-CARRIER.
  5721
  5722     IF PI-ZERO-GROUPING
  5723        OR  PI-ZERO-CAR-GROUP
  5724         MOVE ZEROS              TO  PI-CR-GROUPING.
  5725
  5726     MOVE XCTL-652       TO  PGM-NAME
  5727
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL642.cbl
  5728     GO TO 9300-XCTL.
  5729
  5730 0315-PF4-ERROR.
  5731
  5732     MOVE ER-2407        TO  EMI-ERROR.
  5733     MOVE -1             TO  APFNTERL.
  5734     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5735     GO TO 8200-SEND-DATAONLY.
  5736
  5737 0320-CONT-PFKEYS.
  5738
  5739     IF EIBAID  =  DFHPF6
  5740       AND  PI-MAP-NAME  =  EL642A
  5741         MOVE LOW-VALUES         TO  EL642AO
  5742         MOVE PI-SAV-CARR        TO  PI-CR-CARRIER
  5743         MOVE PI-SAV-GROUP       TO  PI-CR-GROUPING
  5744         MOVE SPACE              TO  PI-CR-STATE
  5745         MOVE LOW-VALUES         TO  PI-CR-ACCOUNT
  5746         MOVE PI-SAV-AGENT       TO  PI-CR-FIN-RESP
  5747         MOVE 'G'                TO  PI-CR-TYPE
  5748         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5749         MOVE XCTL-6401          TO  PGM-NAME
  5750         GO TO 9300-XCTL.
  5751
  5752     IF EIBAID  =  DFHPF7
  5753       AND  PI-MAP-NAME  =  EL642A
  5754         IF PI-CR-FIN-RESP  NOT =  SPACES
  5755             MOVE PI-COMP-CARRIER   TO  PI-CR-CARRIER
  5756             MOVE PI-COMP-GROUPING  TO  PI-CR-GROUPING
  5757             MOVE SPACE             TO  PI-CR-STATE
  5758             MOVE LOW-VALUES        TO  PI-CR-ACCOUNT
  5759             MOVE PI-SAV-AGENT      TO  PI-CR-FIN-RESP
  5760             MOVE 'G'               TO  PI-CR-TYPE
  5761             PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5762             MOVE XCTL-PYAJ      TO  PGM-NAME
  5763             GO TO 9300-XCTL
  5764         ELSE
  5765             IF PI-RETURN-TO-PROGRAM = XCTL-633 OR XCTL-635 OR
  5766                                       XCTL-633DMD
  5767                 GO TO 9400-CLEAR
  5768            ELSE
  5769                 MOVE ER-2411        TO  EMI-ERROR
  5770                 MOVE -1             TO  APFNTERL
  5771                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5772                 GO TO 8200-SEND-DATAONLY.
  5773
  5774     IF EIBAID  =  DFHPF8
  5775       AND  PI-MAP-NAME  =  EL642A
  5776         IF PI-CR-FIN-RESP  NOT =  SPACES
  5777             MOVE PI-SAV-CARR    TO  PI-CR-CARRIER
  5778             MOVE PI-SAV-GROUP   TO  PI-CR-GROUPING
  5779             MOVE SPACE          TO  PI-CR-STATE
  5780             MOVE LOW-VALUES     TO  PI-CR-ACCOUNT
  5781             MOVE PI-SAV-AGENT   TO  PI-CR-FIN-RESP
  5782             MOVE 'G'            TO  PI-CR-TYPE
  5783             PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5784             MOVE XCTL-658       TO  PGM-NAME
  5785             GO TO 9300-XCTL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL642.cbl
  5786         ELSE
  5787         IF PI-SCR-FIN-RESP  NOT =  SPACES
  5788             PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5789             MOVE PI-SCR-CARRIER  TO  PI-CR-CARRIER
  5790             MOVE PI-SCR-GROUPING TO  PI-CR-GROUPING
  5791             MOVE SPACE           TO  PI-CR-STATE
  5792             MOVE LOW-VALUES      TO  PI-CR-ACCOUNT
  5793             MOVE PI-SCR-FIN-RESP TO  PI-CR-FIN-RESP
  5794             MOVE 'G'             TO  PI-CR-TYPE
  5795             MOVE XCTL-658       TO  PGM-NAME
  5796             GO TO 9300-XCTL
  5797         ELSE
  5798             MOVE ER-2399        TO  EMI-ERROR
  5799             MOVE -1             TO  APFNTERL
  5800             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5801             GO TO 8200-SEND-DATAONLY.
  5802
  5803     IF EIBAID  =  DFHPF1
  5804       AND  PI-MAP-NAME  =  EL642B
  5805         GO TO 7500-PRODUCE-CHECK.
  5806
  5807     IF EIBAID  =  DFHPF5
  5808       AND  PI-MAP-NAME  =  EL642A
  5809         IF PI-CR-FIN-RESP NOT  =  SPACES
  5810             MOVE PI-SAV-CARR    TO  PI-CR-CARRIER
  5811             MOVE PI-SAV-GROUP   TO  PI-CR-GROUPING
  5812             MOVE SPACE          TO  PI-CR-STATE
  5813             MOVE LOW-VALUES     TO  PI-CR-ACCOUNT
  5814             MOVE PI-SAV-AGENT   TO  PI-CR-FIN-RESP
  5815             MOVE 'G'            TO  PI-CR-TYPE
  5816             MOVE EL642B         TO  PI-MAP-NAME
  5817             GO TO 7000-PROCESS-CHECK
  5818         ELSE
  5819             MOVE ER-2400        TO  EMI-ERROR
  5820             MOVE -1             TO  APFNTERL
  5821             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5822             GO TO 8200-SEND-DATAONLY.
  5823
  5824     IF PI-MAP-NAME  =  EL642A
  5825         IF EIBAID  =  DFHENTER
  5826           OR  DFHPF3
  5827             GO TO 0330-EDIT-DATA.
  5828
  5829 0320-INPUT-ERROR.
  5830     MOVE ER-0029                TO  EMI-ERROR.
  5831
  5832     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5833
  5834     IF PI-MAP-NAME  =  EL642A
  5835         MOVE AL-UNBON           TO  APFNTERA
  5836         MOVE -1                 TO  APFNTERL
  5837     ELSE
  5838         MOVE AL-UNBON           TO  BPFNTERA
  5839         MOVE -1                 TO  BPFNTERL.
  5840
  5841     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL642.cbl
  5843 0330-EDIT-DATA.
  5844     MOVE ABILTYPI               TO  VALID-BILL-TYPE-VALUES.
  5845
  5846     IF VALID-BILL-TYPE
  5847         IF NOT MODIFY-CAP
  5848             IF ABILTYPI  =  '1' OR '2'
  5849                 NEXT SENTENCE
  5850             ELSE
  5851                 MOVE 'UPDATE'   TO  SM-READ
  5852                 PERFORM 9995-SECURITY-VIOLATION
  5853                 MOVE ER-0070    TO  EMI-ERROR
  5854                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5855                 GO TO 8100-SEND-INITIAL-MAP.
  5856
  5857     MOVE SPACES                 TO  PI-LIMIT-BILLING-ACCOUNTS.
  5858
  5859 0350-ERROR-CHECK.
  5860     IF EMI-ERROR  =  ZEROS
  5861         NEXT SENTENCE
  5862     ELSE
  5863         GO TO 8200-SEND-DATAONLY.
  5864
  5865     IF AAGENTL  GREATER THAN  ZEROS
  5866         MOVE AL-UANON           TO  AAGENTA
  5867         MOVE AAGENTI            TO  PI-SAV-AGENT
  5868     ELSE
  5869         MOVE -1                 TO  AAGENTL
  5870         MOVE AL-UABON           TO  AAGENTA
  5871         MOVE ER-2910            TO  EMI-ERROR
  5872         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5873
  5874     IF ACARIERL  GREATER THAN  ZEROS
  5875         MOVE AL-UANON           TO  ACARIERA
  5876         MOVE ACARIERI           TO  PI-SAV-CARR
  5877                                     PI-CR-CARRIER
  5878                                     PI-COMP-CARRIER
  5879     ELSE
  5880         IF NOT  PI-ZERO-CARRIER
  5881           AND  NOT  PI-ZERO-CAR-GROUP
  5882             MOVE -1             TO  ACARIERL
  5883             MOVE AL-UABON       TO  ACARIERA
  5884             MOVE ER-0194        TO  EMI-ERROR
  5885             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5886         ELSE
  5887             MOVE ZERO           TO  PI-SAV-CARR
  5888                                     PI-COMP-CARRIER.
  5889
  5890     IF AGROUPL  GREATER THAN  ZEROS
  5891         MOVE AL-UANON           TO  AGROUPA
  5892         MOVE AGROUPI            TO  PI-SAV-GROUP
  5893                                     PI-CR-GROUPING
  5894                                     PI-COMP-GROUPING
  5895     ELSE
  5896         IF NOT  PI-ZERO-GROUPING
  5897           AND  NOT  PI-ZERO-CAR-GROUP
  5898             MOVE -1             TO  AGROUPL
  5899             MOVE AL-UABON       TO  AGROUPA
  5900             MOVE ER-0195        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL642.cbl
  5901             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5902         ELSE
  5903             MOVE ZERO           TO  PI-SAV-GROUP
  5904                                     PI-COMP-GROUPING.
  5905
  5906     MOVE ABILTYPI               TO  VALID-BILL-TYPE-VALUES.
  5907
  5908     IF VALID-BILL-TYPE
  5909         MOVE AL-UANON           TO  ABILTYPA
  5910         MOVE ABILTYPI           TO  PI-BILL-TYPE
  5911                                     WS-BILL-TYPE
  5912     ELSE
  5913         MOVE -1                 TO  ABILTYPL
  5914         MOVE ER-2249            TO  EMI-ERROR
  5915         MOVE AL-UABON           TO  ABILTYPA
  5916         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5917
  5918     IF PI-AR-PROCESSING
  5919        IF PI-PREVIEW
  5920           NEXT SENTENCE
  5921        ELSE
  5922           MOVE -1               TO ABILTYPL
  5923           MOVE ER-3145          TO EMI-ERROR
  5924           MOVE AL-UABON         TO ABILTYPA
  5925           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5926
  5927     IF APRODSWL  NOT =  ZEROS
  5928         IF PI-PREVIEW
  5929             IF APRODSWI  =  'Y'  OR  'N'
  5930                 MOVE AL-UANON   TO  APRODSWA
  5931             ELSE
  5932                 MOVE -1         TO  APRODSWL
  5933                 MOVE ER-2436    TO  EMI-ERROR
  5934                 MOVE AL-UABON   TO  APRODSWA
  5935                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5936         ELSE
  5937             MOVE -1             TO  APRODSWL
  5938             MOVE ER-2434        TO  EMI-ERROR
  5939             MOVE AL-UABON       TO  APRODSWA
  5940             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5941     ELSE
  5942         IF PI-PREVIEW
  5943             MOVE -1             TO  APRODSWL
  5944             MOVE ER-2435        TO  EMI-ERROR
  5945             MOVE AL-UABON       TO  APRODSWA
  5946             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5947
  5948     IF AACCT1L  NOT =  ZEROS
  5949         MOVE AL-UANON           TO  AACCT1A
  5950         MOVE 'Y'                TO  LIMIT-BILLING-SW
  5951         MOVE AACCT1I            TO  PI-BILLING-ACCOUNTS (1).
  5952
  5953     IF AACCT2L  NOT =  ZEROS
  5954         MOVE AL-UANON           TO  AACCT2A
  5955         MOVE 'Y'                TO  LIMIT-BILLING-SW
  5956         MOVE AACCT2I            TO  PI-BILLING-ACCOUNTS (2).
  5957
  5958     IF AACCT3L  NOT =  ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL642.cbl
  5959         MOVE AL-UANON           TO  AACCT3A
  5960         MOVE 'Y'                TO  LIMIT-BILLING-SW
  5961         MOVE AACCT3I            TO  PI-BILLING-ACCOUNTS (3).
  5962
  5963     IF EMI-ERROR  =  ZEROS
  5964         GO TO 1000-BILLING-PROCESS.
  5965
  5966     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL642.cbl
  5968 0500-CREATE-TEMP-STORAGE.
  5969     IF PI-BAL-FRWD  NOT  NUMERIC
  5970         MOVE ZEROS              TO  PI-BAL-FRWD
  5971                                     PI-PREMIUM
  5972                                     PI-REMITTED
  5973                                     PI-TOT-ISS-COMP
  5974                                     PI-TOT-CAN-COMP
  5975                                     PI-ADJUSTMNTS
  5976                                     PI-DISBURSED
  5977                                     PI-END-BAL
  5978                                     PI-UNPAID-NET-PREM
  5979                                     PI-COMP-UNPAID-PREM
  5980                                     PI-LF-ISS-COMP
  5981                                     PI-AH-ISS-COMP
  5982                                     PI-LF-CAN-COMP
  5983                                     PI-AH-CAN-COMP
  5984                                     PI-DUE-FOR-ACCT
  5985                                     PI-ACCT-BEG-BAL
  5986                                     PI-ACCT-NET-PREM
  5987                                     PI-ACCT-COMP
  5988                                     PI-ACCT-PAY-ADJS.
  5989
  5990
  5991* EXEC CICS WRITEQ TS
  5992*        QUEUE   (QID)
  5993*        FROM    (PROGRAM-INTERFACE-BLOCK)
  5994*        LENGTH  (PI-COMM-LENGTH)
  5995*    END-EXEC.
  5996*    MOVE '*"                    ''   #00005947' TO DFHEIV0
  5997     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  5998     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5999     MOVE X'2020233030303035393437' TO DFHEIV0(25:11)
  6000     CALL 'kxdfhei1' USING DFHEIV0,
  6001           QID,
  6002           PROGRAM-INTERFACE-BLOCK,
  6003           PI-COMM-LENGTH,
  6004           DFHEIV99,
  6005           DFHEIV99,
  6006           DFHEIV99
  6007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6008
  6009
  6010 0590-EXIT.
  6011      EXIT.
  6012
  6013 0600-RECOVER-TEMP-STORAGE.
  6014
  6015* EXEC CICS READQ TS
  6016*        QUEUE   (QID)
  6017*        INTO    (PROGRAM-INTERFACE-BLOCK)
  6018*        LENGTH  (PI-COMM-LENGTH)
  6019*    END-EXEC.
  6020*    MOVE '*$I    L              ''   #00005957' TO DFHEIV0
  6021     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  6022     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6023     MOVE X'2020233030303035393537' TO DFHEIV0(25:11)
  6024     CALL 'kxdfhei1' USING DFHEIV0,
  6025           QID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL642.cbl
  6026           PROGRAM-INTERFACE-BLOCK,
  6027           PI-COMM-LENGTH,
  6028           DFHEIV99,
  6029           DFHEIV99,
  6030           DFHEIV99
  6031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6032
  6033
  6034     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  6035
  6036     MOVE PI-SCRN-CONTROL TO W-TRANSFER-CONTROL.
  6037
  6038 0690-EXIT.
  6039      EXIT.
  6040
  6041 0800-DELETE-TS.
  6042
  6043* EXEC CICS HANDLE CONDITION
  6044*        QIDERR  (0890-EXIT)
  6045*    END-EXEC.
  6046*    MOVE '"$N                   ! # #00005971' TO DFHEIV0
  6047     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  6048     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6049     MOVE X'2320233030303035393731' TO DFHEIV0(25:11)
  6050     CALL 'kxdfhei1' USING DFHEIV0
  6051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6052
  6053
  6054
  6055* EXEC CICS DELETEQ TS
  6056*        QUEUE  (QID)
  6057*    END-EXEC.
  6058*    MOVE '*&                    #   #00005975' TO DFHEIV0
  6059     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  6060     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6061     MOVE X'2020233030303035393735' TO DFHEIV0(25:11)
  6062     CALL 'kxdfhei1' USING DFHEIV0,
  6063           QID,
  6064           DFHEIV99
  6065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6066
  6067
  6068 0890-EXIT.
  6069      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL642.cbl
  6071******************************************************************
  6072*    THIS SECTION PROCESSES THE PENDING BUSINESS FILE BASED ON   *
  6073*    ACCOUNT DATE RANGES FOR EACH ACCOUNT THAT A GENERAL AGENT   *
  6074*    RECEIVES COMMISION FROM.  THE PROFILE OF A GENERAL AGENT    *
  6075*    IS MAINTAINED IN THE AGENT-CROSS-REFERENCE FILE.            *
  6076*                                                                *
  6077*    1.  IF VOID BILLING                                         *
  6078*            GO TO VOID-BILLING.                                 *
  6079*                                                                *
  6080*    2.  READ COMPENSATIONG MASTER FOR GENERAL AGENT TO GET      *
  6081*        THE AGENT'S ENDING BALANCE AND ADDRESS.                 *
  6082*                                                                *
  6083*    3.  READ THE AGENT-CROSS-REFERENCE-FILE.                    *
  6084*                                                                *
  6085*    4.  PROCESS EACH ACCOUNT ASSOCIATED WITH A GENERAL AGENT.   *
  6086*                                                                *
  6087*        A.  PROCESSS EACH DATE RANGE PER ACCOUNT AND ACCUMULATE *
  6088*            STATISTICS FOR THAT ACCOUNT.                        *
  6089*                                                                *
  6090*            1. PROCESS THE ACTIVE RECORDS ON PENDING BUSINESS.  *
  6091*               OMIT ANY RECORDS THAT HAVE ANY FATAL OR UNFORCED *
  6092*               ERRORS.  DO NOT PROCESS ANY REINSURANCE OR BILL- *
  6093*               ING ADJUSTMENT RECORDS.  IF BILLING UPDATE, FLAG
  6094*               EACH PENDING BUSINESS RECORD THAT IS PRCESSED.   *
  6095*                                                                *
  6096*            2.  ACCUMULATE STATISTICS FOR SCREEN DISPLAY.       *
  6097*                                                                *
  6098*            3.  COMPUTE ACCOUNT AND AGENT COMMISSION.           *
  6099*                                                                *
  6100*         B.  ACCUMULATE THE PAYMENT AND ADJUSTMENTS FOR         *
  6101*             EACH ACCOUNT THE GENERAL AGENT IS RESPONSIBLE FOR. *
  6102*                                                                *
  6103*         C.  PRINT ACCUMULATED STATISTICS FOR EACH ACCOUNT.     *
  6104*             OMITT ANY ACCOUNTS THAT DIDN'T HAVE ANY NEW BUS.   *
  6105*                                                                *
  6106*    5.  PRINT AN AGENT TOTAL OF ALL THE ACCOUNTS AND THE        *
  6107*        GENERAL AGENTS PAYMENTS AND ADJUSTMENTS.                *
  6108******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL642.cbl
  6110 1000-BILLING-PROCESS.
  6111     MOVE PI-COMPANY-CD          TO  ERPNDB-CO-CD
  6112                                     ERPNDB-CO-CD-A1
  6113                                     ERCOMP-COMP-CD
  6114                                     ERPYAJ-COMP-CD
  6115                                     ERACCT-P-CO-CD
  6116                                     ERACCT-A-CO-CD
  6117                                     ERCOMM-COMPANY-CD
  6118                                     ERCTBL-COMPANY-CD.
  6119
  6120     MOVE ZEROS                  TO  PI-BAL-FRWD
  6121                                     PI-UNKNOWN
  6122                                     PI-UNPAID-NET-PREM
  6123                                     PI-COMP-UNPAID-PREM
  6124                                     PI-PREMIUM
  6125                                     PI-REMITTED
  6126                                     PI-TOT-ISS-COMP
  6127                                     PI-TOT-CAN-COMP
  6128                                     PI-ADJUSTMNTS
  6129                                     PI-DISBURSED
  6130                                     PI-END-BAL
  6131                                     PI-LF-ISS-COMP
  6132                                     PI-AH-ISS-COMP
  6133                                     PI-LF-CAN-COMP
  6134                                     PI-AH-CAN-COMP
  6135                                     PI-DUE-FOR-ACCT
  6136                                     PI-ACCT-BEG-BAL
  6137                                     PI-ACCT-NET-PREM
  6138                                     PI-ACCT-COMP
  6139                                     PI-ACCT-PAY-ADJS
  6140                                     PI-ISSUES-BILLED
  6141                                     PI-ISSUES-INER
  6142                                     PI-ISSUES-PREV
  6143                                     PI-CANCELS-BILLED
  6144                                     PI-CANCELS-INER
  6145                                     PI-CANCELS-PREV.
  6146
  6147     IF PI-VOID-BILL
  6148         GO TO 2000-VOID-BILLING.
  6149
  6150     MOVE SPACES                 TO  ELCNTL-KEY.
  6151     MOVE '1'                    TO  ELCNTL-REC-TYPE.
  6152
  6153     PERFORM 6100-READ-CONTROL-FILE  THRU  6120-EXIT.
  6154
  6155     IF EMI-ERROR  NOT =  ZEROS
  6156         GO TO 8200-SEND-DATAONLY.
  6157
  6158     IF CF-ACCOUNT-MSTR-MAINT-DT  =  LOW-VALUES
  6159       OR  CF-COMPENSATION-MSTR-MAINT-DT  =  LOW-VALUES
  6160         MOVE ER-2571            TO  EMI-ERROR
  6161         MOVE -1                 TO  APFNTERL
  6162         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6163         GO TO 8200-SEND-DATAONLY.
  6164
  6165     IF CF-FORMS-PRINTER-ID  =  SPACES
  6166       AND  (ABILTYPI = '3'  OR  '4')
  6167         MOVE ER-2590            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL642.cbl
  6168         MOVE -1                 TO  ABILTYPL
  6169         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6170         GO TO 8200-SEND-DATAONLY.
  6171
  6172     MOVE CF-CURRENT-MONTH-END   TO  DC-BIN-DATE-1.
  6173     MOVE SPACE                  TO  DC-OPTION-CODE.
  6174
  6175     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  6176
  6177     MOVE DC-GREG-DATE-1-EDIT    TO  PI-MONTH-END-DATE.
  6178     MOVE WS-CURRENT-DATE-EDIT   TO  HD-RUN-DT.
  6179     MOVE CF-CL-MAIL-TO-NAME     TO  CENTER-WORK-1.
  6180     MOVE +44                    TO  X-LEN.
  6181
  6182     PERFORM 8600-CENTER-DATA  THRU  8690-C-D-X.
  6183
  6184     MOVE CENTER-WORK-2          TO  HD-CO.
  6185     MOVE SPACE                  TO  PI-DATA-BILLED-SW.
  6186     MOVE 'G'                    TO  COMPENSATION-SW
  6187                                     PI-CR-TYPE.
  6188
  6189     PERFORM 6000-READ-COMP-MASTER  THRU  6090-EXIT.
  6190
  6191     PERFORM 6400-READ-CROSS-REFERENCE  THRU  6490-EXIT.
  6192
  6193     MOVE +0                     TO  GX-SUB.
  6194
  6195 1005-GXRF-BILLING-PROCESS-LOOP.
  6196     ADD +1                      TO  GX-SUB.
  6197
  6198     IF GX-SUB  GREATER THAN  GX-AGENT-POINTER-CNT
  6199         IF PI-ACCT-BILLED
  6200             PERFORM 1100-PYAJ-BILLING-PROCESS  THRU  1190-EXIT
  6201             GO TO 1200-PYAJ-BILLING-COMPLETE
  6202         ELSE
  6203             GO TO 1200-PYAJ-BILLING-COMPLETE.
  6204     IF LIMIT-BILLING
  6205         IF GX-AM-ACCOUNT (GX-SUB)  =  PI-BILLING-ACCOUNTS (1)
  6206                                   OR  PI-BILLING-ACCOUNTS (2)
  6207                                   OR  PI-BILLING-ACCOUNTS (3)
  6208             NEXT SENTENCE
  6209         ELSE
  6210             GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6211
  6212     IF FIRST-TIME
  6213         MOVE 'N'                      TO  FIRST-TIME-SW
  6214         MOVE GX-AM-CARRIER (GX-SUB)   TO  PI-CR-CARRIER
  6215         MOVE GX-AM-GROUPING (GX-SUB)  TO  PI-CR-GROUPING
  6216         MOVE GX-AM-STATE (GX-SUB)     TO  PI-CR-STATE
  6217         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  PI-CR-ACCOUNT.
  6218
  6219     IF GX-AM-CARRIER (GX-SUB)  =  PI-CR-CARRIER
  6220       AND  GX-AM-GROUPING (GX-SUB)  =  PI-CR-GROUPING
  6221       AND  GX-AM-STATE (GX-SUB)  =  PI-CR-STATE
  6222       AND  GX-AM-ACCOUNT (GX-SUB)  =  PI-CR-ACCOUNT
  6223         NEXT SENTENCE
  6224     ELSE
  6225         IF PI-ACCT-BILLED
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL642.cbl
  6226             PERFORM 1100-PYAJ-BILLING-PROCESS  THRU  1190-EXIT
  6227             MOVE 'TA'           TO  BILLING-DETAIL-TYPE
  6228             IF APRODSWI  =  'N'
  6229                 NEXT SENTENCE
  6230             ELSE
  6231                 PERFORM 3000-WRITE-BILLING-DETAIL
  6232                     THRU  3990-EXIT.
  6233
  6234     MOVE GX-AM-CARRIER (GX-SUB)   TO  PI-CR-CARRIER.
  6235     MOVE GX-AM-GROUPING (GX-SUB)  TO  PI-CR-GROUPING.
  6236     MOVE GX-AM-STATE (GX-SUB)     TO  PI-CR-STATE.
  6237     MOVE GX-AM-ACCOUNT (GX-SUB)   TO  PI-SAV-ACCT
  6238                                       PI-CR-ACCOUNT.
  6239     MOVE GX-AM-EXPIRATION-DT (GX-SUB)
  6240                                   TO  PI-SAV-EXP-DT.
  6241
  6242     PERFORM 4300-READ-ACCOUNT-MASTER  THRU  4390-EXIT.
  6243
  6244     IF INVALID-ACCOUNT
  6245         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6246
  6247     IF PI-UPDATE-FILES
  6248         MOVE WS-GA-LEVEL        TO  GX-AM-LEVEL-NO (GX-SUB)
  6249         MOVE WS-CURRENT-DATE    TO  GX-LAST-BILL-DT (GX-SUB).
  6250
  6251     IF NEW-ACCOUNT
  6252         IF PI-ACCT-BILLED
  6253             PERFORM 1100-PYAJ-BILLING-PROCESS  THRU  1190-EXIT
  6254             MOVE 'TA'           TO  BILLING-DETAIL-TYPE
  6255             IF APRODSWI  =  'N'
  6256                 NEXT SENTENCE
  6257             ELSE
  6258                 PERFORM 3000-WRITE-BILLING-DETAIL
  6259                     THRU  3990-EXIT.
  6260
  6261     MOVE 'A'                    TO  COMPENSATION-SW
  6262                                      PI-CR-TYPE.
  6263
  6264     PERFORM 6000-READ-COMP-MASTER     THRU 6090-EXIT.
  6265     PERFORM 1100-PYAJ-BILLING-PROCESS THRU 1190-EXIT.
  6266     PERFORM 4000-PNDB-START-BROWSE    THRU 4090-EXIT.
  6267
  6268     IF PNDB-EOF
  6269         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6270
  6271 1010-PNDB-BILLING-PROCESS-LOOP.
  6272     PERFORM 4100-PNDB-READ-NEXT  THRU  4150-EXIT.
  6273
  6274     IF PNDB-EOF
  6275         PERFORM 4160-PNDB-END-BROWSE
  6276         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6277
  6278     IF PB-COMPANY-CD-A1  =  PI-COMPANY-CD  AND
  6279        PB-SV-CARRIER     =  PI-CR-CARRIER  AND
  6280        PB-SV-GROUPING    =  PI-CR-GROUPING AND
  6281        PB-SV-STATE       =  PI-CR-STATE    AND
  6282        PB-ACCOUNT        =  PI-CR-ACCOUNT
  6283         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL642.cbl
  6284     ELSE
  6285         PERFORM 4160-PNDB-END-BROWSE
  6286         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6287
  6288     IF PB-BATCH-TRAILER
  6289         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6290
  6291     IF PB-ALT-CHG-SEQ-NO  NOT =  ZEROS
  6292         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6293
  6294     IF PB-CERT-EFF-DT LESS GX-AM-EXPIRATION-DT (GX-SUB)
  6295         NEXT SENTENCE
  6296      ELSE
  6297         PERFORM 4160-PNDB-END-BROWSE
  6298         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6299
  6300     IF PB-CERT-EFF-DT  LESS THAN  GX-AM-EFF-DT (GX-SUB)
  6301         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6302
  6303     IF PB-CERT-EFF-DT  GREATER THAN  ERACCT-P-EXP-DATE
  6304         PERFORM 4160-PNDB-END-BROWSE
  6305         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6306
  6307     IF (PB-ISSUE)
  6308       AND
  6309        (PB-I-POLICY-IS-REISSUE OR PB-I-REIN-ONLY OR
  6310         PB-I-POLICY-IS-MONTHLY OR
  6311         PB-I-POLICY-IS-DECLINED OR PB-I-POLICY-IS-VOIDED OR
  6312         PB-I-UNDERWRITE-POLICY)
  6313           GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6314     ELSE
  6315         IF (PB-CANCELLATION)
  6316           AND  (PB-CI-LF-POLICY-IS-REISSUE
  6317             OR  PB-CI-AH-POLICY-IS-REISSUE
  6318             OR  PB-CI-LF-POLICY-IS-MONTHLY
  6319             OR  PB-CI-AH-POLICY-IS-MONTHLY
  6320             OR  PB-CI-LF-POLICY-IS-DECLINED
  6321             OR  PB-CI-AH-POLICY-IS-VOID
  6322             OR  PB-CI-LF-REIN-ONLY
  6323             OR  PB-CI-AH-REIN-ONLY)
  6324               GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6325
  6326     IF PB-CREDIT-ACCEPT-DT  NOT =  LOW-VALUES
  6327         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6328
  6329     IF PB-RECORD-ON-HOLD
  6330         PERFORM 1040-UPDATE-BILLING-STATISTICS  THRU  1049-EXIT
  6331         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6332
  6333     IF PB-FATAL-ERRORS
  6334       OR  PB-UNFORCED-ERRORS
  6335         PERFORM 1040-UPDATE-BILLING-STATISTICS  THRU  1049-EXIT
  6336         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6337
  6338     MOVE 'Y'                    TO  PI-ACCT-BILLED-SW
  6339                                     PI-DATA-BILLED-SW.
  6340
  6341     PERFORM 1040-UPDATE-BILLING-STATISTICS  THRU  1049-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL642.cbl
  6342
  6343     PERFORM 1030-COMPUTE-COMMISSION-TOTALS  THRU  1039-EXIT.
  6344
  6345     IF PI-BILL
  6346       OR  PI-REBILLING
  6347         PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT.
  6348
  6349     GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL642.cbl
  6351 1030-COMPUTE-COMMISSION-TOTALS.
  6352     IF PB-CANCELLATION
  6353         GO TO 1035-COMPUTE-CANCEL-COMM.
  6354
  6355     MOVE SPACES                 TO WS-AH-CATEGORY
  6356     IF (PI-COMPANY-ID = 'DCC')
  6357        AND (NOT PB-INVALID-AH)
  6358        MOVE SPACES              TO ELCNTL-KEY
  6359        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6360        MOVE '5'                 TO ELCNTL-REC-TYPE
  6361        MOVE PB-I-AH-BENEFIT-CD  TO ELCNTL-ACCESS (3:2)
  6362                                    CLAS-LOOK
  6363        MOVE +0                  TO ELCNTL-SEQ-NO
  6364        PERFORM 6130-FIND-BENEFIT-CD
  6365                                 THRU 6140-EXIT
  6366     END-IF
  6367     PERFORM 4400-FIND-COMMISSION  THRU  4490-EXIT.
  6368
  6369     IF (PB-OVERRIDE-LIFE
  6370        OR PB-OVERRIDE-BOTH)
  6371        IF NOT PB-INVALID-LIFE
  6372           COMPUTE WS-I-LF-PREMIUM-AMT = PB-I-LF-PREM-CALC +
  6373                                       PB-I-LF-ALT-PREM-CALC
  6374        END-IF
  6375     ELSE
  6376        IF NOT PB-INVALID-LIFE
  6377           COMPUTE WS-I-LF-PREMIUM-AMT = PB-I-LF-PREMIUM-AMT +
  6378                                       PB-I-LF-ALT-PREMIUM-AMT
  6379        END-IF
  6380     END-IF
  6381
  6382     IF (PB-OVERRIDE-AH
  6383        OR PB-OVERRIDE-BOTH)
  6384        MOVE PB-I-AH-PREM-CALC   TO WS-I-AH-PREMIUM-AMT
  6385     ELSE
  6386        MOVE PB-I-AH-PREMIUM-AMT TO  WS-I-AH-PREMIUM-AMT
  6387     END-IF
  6388
  6389     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  (LOW-VALUES OR SPACES)
  6390       OR  PI-TOT-REBILL
  6391         COMPUTE PI-UNPAID-NET-PREM = PI-UNPAID-NET-PREM +
  6392             WS-I-LF-PREMIUM-AMT + WS-I-AH-PREMIUM-AMT
  6393         COMPUTE WS-ACCT-UNPAID-NET-PREM =
  6394             (WS-I-LF-PREMIUM-AMT + WS-I-AH-PREMIUM-AMT) +
  6395              WS-ACCT-UNPAID-NET-PREM.
  6396
  6397     COMPUTE PI-PREMIUM = PI-PREMIUM +
  6398         (WS-I-LF-PREMIUM-AMT + WS-I-AH-PREMIUM-AMT).
  6399
  6400     COMPUTE PI-LF-ISS-COMP ROUNDED =
  6401         (WS-I-LF-PREMIUM-AMT * WS-GA-LF-COM).
  6402
  6403     IF AM-COM-TYP (WS-GA-LEVEL) = 'K' OR 'I' OR 'L'
  6404        COMPUTE PI-AH-ISS-COMP = WS-GA-AH-COM * +1000
  6405     ELSE
  6406        COMPUTE PI-AH-ISS-COMP ROUNDED =
  6407         (WS-I-AH-PREMIUM-AMT  * WS-GA-AH-COM)
  6408     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL642.cbl
  6409
  6410     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  (LOW-VALUES OR SPACES)
  6411       OR  PI-TOT-REBILL
  6412         COMPUTE WS-ACCT-LF-OVERWRITE =
  6413             (PI-LF-ISS-COMP + WS-ACCT-LF-OVERWRITE)
  6414         COMPUTE WS-ACCT-AH-OVERWRITE =
  6415             (PI-AH-ISS-COMP + WS-ACCT-AH-OVERWRITE)
  6416         COMPUTE PI-COMP-UNPAID-PREM = PI-COMP-UNPAID-PREM +
  6417             PI-LF-ISS-COMP + PI-AH-ISS-COMP.
  6418
  6419     COMPUTE PI-TOT-ISS-COMP = PI-TOT-ISS-COMP +
  6420         (PI-LF-ISS-COMP + PI-AH-ISS-COMP).
  6421
  6422 1033-COMPUTE-ACCOUNT-COMM.
  6423
  6424     COMPUTE WS-ACCT-NET-PREM ROUNDED = WS-ACCT-NET-PREM +
  6425         (WS-I-LF-PREMIUM-AMT + WS-I-AH-PREMIUM-AMT).
  6426
  6427     IF PI-SAV-AGENT  NOT =  PI-SAV-REMIT-TO
  6428         GO TO 1039-EXIT.
  6429
  6430     COMPUTE WS-ACCT-COMP ROUNDED =
  6431        (WS-I-LF-PREMIUM-AMT * PB-I-LIFE-COMMISSION)
  6432        + WS-ACCT-COMP
  6433
  6434     IF WS-AH-CATEGORY = 'G' OR 'L'
  6435        COMPUTE WS-ACCT-COMP ROUNDED =
  6436           (WS-I-AH-PREMIUM-AMT - PB-I-LF-ALT-PREMIUM-AMT
  6437           - PB-I-ADDL-CLP) + WS-ACCT-COMP
  6438     ELSE
  6439        COMPUTE WS-ACCT-COMP ROUNDED =
  6440           (WS-I-AH-PREMIUM-AMT * PB-I-AH-COMMISSION)   +
  6441            WS-ACCT-COMP
  6442     END-IF
  6443
  6444     GO TO 1039-EXIT.
  6445
  6446 1035-COMPUTE-CANCEL-COMM.
  6447     IF PB-CI-CERT-HAS-ERCOMM-ENTRY
  6448         PERFORM 4700-PROCESS-COMM-EXCEPTION  THRU  4790-EXIT
  6449     ELSE
  6450         PERFORM 4400-FIND-COMMISSION  THRU  4490-EXIT.
  6451     MOVE SPACES                 TO WS-AH-CATEGORY
  6452     IF (PI-COMPANY-ID = 'DCC')
  6453        AND (PB-CI-AH-BENEFIT-CD NOT = SPACES AND ZEROS)
  6454        MOVE SPACES              TO ELCNTL-KEY
  6455        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6456        MOVE '5'                 TO ELCNTL-REC-TYPE
  6457        MOVE PB-CI-AH-BENEFIT-CD TO ELCNTL-ACCESS (3:2)
  6458                                    CLAS-LOOK
  6459        MOVE +0                  TO ELCNTL-SEQ-NO
  6460        PERFORM 6130-FIND-BENEFIT-CD
  6461                                 THRU 6140-EXIT
  6462     END-IF
  6463
  6464     IF PB-OVERRIDE-LIFE
  6465       OR  PB-OVERRIDE-BOTH
  6466         MOVE PB-C-LF-REF-CALC   TO  WS-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL642.cbl
  6467     ELSE
  6468         MOVE PB-C-LF-CANCEL-AMT
  6469                                 TO  WS-C-LF-CANCEL-AMT.
  6470
  6471     IF PB-OVERRIDE-AH
  6472       OR  PB-OVERRIDE-BOTH
  6473         MOVE PB-C-AH-REF-CALC   TO  WS-C-AH-CANCEL-AMT
  6474     ELSE
  6475         MOVE PB-C-AH-CANCEL-AMT
  6476                                 TO  WS-C-AH-CANCEL-AMT.
  6477
  6478     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  LOW-VALUES  OR  SPACES
  6479       OR  PI-TOT-REBILL
  6480         COMPUTE PI-UNPAID-NET-PREM = PI-UNPAID-NET-PREM -
  6481             (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT)
  6482         COMPUTE WS-ACCT-UNPAID-NET-PREM =
  6483             WS-ACCT-UNPAID-NET-PREM -
  6484             (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT).
  6485
  6486     COMPUTE PI-PREMIUM = PI-PREMIUM -
  6487         (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT).
  6488
  6489     MOVE  PB-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6490     MOVE  PB-C-LF-CANCEL-DT      TO  DC-BIN-DATE-2.
  6491     MOVE  '1'                    TO  DC-OPTION-CODE.
  6492     PERFORM  8500-DATE-CONVERT  THRU  8500-EXIT.
  6493     MOVE  DC-ELAPSED-MONTHS      TO  MONTHS-DIFF-LF.
  6494
  6495     IF DC-ODD-DAYS-OVER  GREATER THAN   ZEROS
  6496         ADD  +1                  TO  MONTHS-DIFF-LF.
  6497
  6498     MOVE  PB-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6499     MOVE  PB-C-AH-CANCEL-DT      TO  DC-BIN-DATE-2.
  6500     MOVE  '1'                    TO  DC-OPTION-CODE.
  6501     PERFORM  8500-DATE-CONVERT  THRU  8500-EXIT.
  6502     MOVE  DC-ELAPSED-MONTHS      TO  MONTHS-DIFF-AH.
  6503
  6504     IF DC-ODD-DAYS-OVER  GREATER THAN   ZEROS
  6505         ADD  +1                  TO  MONTHS-DIFF-AH.
  6506
  6507     MOVE ZEROS                   TO  SUB.
  6508     MOVE ZEROS                   TO  PI-LF-CAN-COMP
  6509                                      PI-AH-CAN-COMP.
  6510
  6511 1036-COMPUTE-GA-LOOP.
  6512
  6513     ADD  +1                      TO  SUB.
  6514
  6515     IF SUB > +10
  6516         MOVE  ZEROS              TO  SUB
  6517         GO TO  1037-CONTINUE.
  6518
  6519     IF AM-AGT (SUB)   NOT  EQUAL  PI-SAV-AGENT
  6520         GO TO  1036-COMPUTE-GA-LOOP.
  6521
  6522     IF AM-COM-TYP (SUB) = 'O' OR 'P' OR 'G' OR 'B' OR 'K'
  6523         NEXT SENTENCE
  6524     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL642.cbl
  6525         GO TO  1036-COMPUTE-GA-LOOP.
  6526
  6527     IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  6528         MOVE  ZEROS               TO  AM-COMM-CHARGEBACK (SUB).
  6529
  6530     IF AM-COMM-CHARGEBACK (SUB) = '99'
  6531         MOVE  ZEROS           TO  PI-LF-CAN-COMP
  6532         GO TO 1037-CHECK-AH-COMM.
  6533
  6534     IF (MONTHS-DIFF-LF  GREATER THAN  AM-COMM-CHARGEBACK (SUB))
  6535                              AND
  6536        (AM-COMM-CHARGEBACK (SUB)  NOT  EQUAL   ZEROS)
  6537         MOVE  ZEROS               TO  PI-LF-CAN-COMP
  6538     ELSE
  6539         COMPUTE PI-LF-CAN-COMP ROUNDED = PI-LF-CAN-COMP +
  6540             (WS-C-LF-CANCEL-AMT * WS-GA-LF-COM).
  6541
  6542 1037-CHECK-AH-COMM.
  6543
  6544     IF AM-COMM-CHARGEBACK (SUB)    EQUAL   '99'
  6545         MOVE  ZEROS           TO  PI-AH-CAN-COMP
  6546         GO TO 1036-COMPUTE-GA-LOOP.
  6547
  6548     IF (MONTHS-DIFF-AH GREATER THAN  AM-COMM-CHARGEBACK (SUB))
  6549                              AND
  6550        (AM-COMM-CHARGEBACK (SUB)  NOT  EQUAL   ZEROS)
  6551         MOVE  ZEROS               TO  PI-AH-CAN-COMP
  6552     ELSE
  6553        IF (AM-COM-TYP (SUB) = 'K')
  6554           AND (WS-C-AH-CANCEL-AMT > ZEROS)
  6555           COMPUTE PI-AH-CAN-COMP ROUNDED =
  6556              PI-AH-CAN-COMP + (WS-GA-AH-COM * +1000)
  6557        ELSE
  6558           COMPUTE PI-AH-CAN-COMP ROUNDED =  PI-AH-CAN-COMP +
  6559             (WS-C-AH-CANCEL-AMT  * WS-GA-AH-COM)
  6560        END-IF
  6561     END-IF
  6562
  6563     GO TO 1036-COMPUTE-GA-LOOP.
  6564
  6565 1037-CONTINUE.
  6566
  6567     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  (LOW-VALUES  OR  SPACES)
  6568       OR  PI-TOT-REBILL
  6569         COMPUTE WS-ACCT-LF-OVERWRITE =
  6570             (WS-ACCT-LF-OVERWRITE - PI-LF-CAN-COMP)
  6571         COMPUTE WS-ACCT-AH-OVERWRITE =
  6572             (WS-ACCT-AH-OVERWRITE - PI-AH-CAN-COMP)
  6573         COMPUTE PI-COMP-UNPAID-PREM = PI-COMP-UNPAID-PREM -
  6574             PI-LF-CAN-COMP - PI-AH-CAN-COMP.
  6575
  6576     COMPUTE PI-TOT-CAN-COMP = PI-TOT-CAN-COMP +
  6577         (PI-LF-CAN-COMP + PI-AH-CAN-COMP).
  6578
  6579 1038-COMPUTE-ACCOUNT-COMM.
  6580
  6581     COMPUTE WS-ACCT-NET-PREM = WS-ACCT-NET-PREM -
  6582         (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL642.cbl
  6583
  6584     IF PI-SAV-AGENT  NOT =  PI-SAV-REMIT-TO
  6585         GO TO 1039-EXIT.
  6586
  6587     MOVE ZEROS                   TO  SUB.
  6588
  6589 103X-ACCOUNT-LOOP.
  6590
  6591     ADD  +1                      TO  SUB.
  6592
  6593     IF SUB > +10
  6594         MOVE  ZEROS              TO  SUB
  6595         GO TO  1039-EXIT.
  6596
  6597     IF AM-COM-TYP (SUB) = 'C' OR 'D' OR 'F' OR 'S'
  6598         NEXT SENTENCE
  6599     ELSE
  6600         GO TO  103X-ACCOUNT-LOOP.
  6601
  6602     IF AM-COMM-CHARGEBACK (SUB)    NOT NUMERIC
  6603         MOVE  ZEROS               TO  AM-COMM-CHARGEBACK (SUB).
  6604
  6605     IF AM-COMM-CHARGEBACK (SUB)   EQUAL   '99'
  6606         MOVE  ZEROS          TO  WS-C-LF-CANCEL-AMT
  6607         GO TO 103X-CHECK-AH-COMM.
  6608
  6609     IF (MONTHS-DIFF-LF  GREATER THAN  AM-COMM-CHARGEBACK (SUB))
  6610                              AND
  6611        (AM-COMM-CHARGEBACK (SUB)  NOT  EQUAL   ZEROS)
  6612         MOVE  ZEROS              TO  WS-C-LF-CANCEL-AMT.
  6613
  6614 103X-CHECK-AH-COMM.
  6615
  6616     IF AM-COMM-CHARGEBACK (SUB)   EQUAL   '99'
  6617         MOVE  ZEROS          TO  WS-C-AH-CANCEL-AMT
  6618         GO TO 103X-COMPUTE-ACCT-TOT.
  6619
  6620     IF (MONTHS-DIFF-AH  GREATER THAN  AM-COMM-CHARGEBACK (SUB))
  6621                              AND
  6622        (AM-COMM-CHARGEBACK (SUB)  NOT  EQUAL   ZEROS)
  6623         MOVE  ZEROS              TO  WS-C-AH-CANCEL-AMT.
  6624
  6625 103X-COMPUTE-ACCT-TOT.
  6626     COMPUTE WS-ACCT-COMP   ROUNDED  =  WS-ACCT-COMP  -
  6627         (WS-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION)
  6628*        + (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION)
  6629     IF WS-AH-CATEGORY = 'G' OR 'L'
  6630        COMPUTE CNC-FACT = PB-C-AH-CANCEL-AMT /
  6631           PB-CI-AH-PREMIUM-AMT
  6632           COMPUTE WS-AH-ACCT-COMP ROUNDED =
  6633           (CNC-FACT * (PB-CI-AH-PREMIUM-AMT -
  6634           PB-CI-LF-ALT-PREMIUM-AMT
  6635           - PB-CI-ADDL-CLP))
  6636     ELSE
  6637        COMPUTE WS-AH-ACCT-COMP  ROUNDED =
  6638           (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION)
  6639     END-IF
  6640     COMPUTE WS-ACCT-COMP =  WS-ACCT-COMP  - WS-AH-ACCT-COMP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL642.cbl
  6641
  6642     GO TO 103X-ACCOUNT-LOOP.
  6643
  6644 1039-EXIT.
  6645     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL642.cbl
  6647 1040-UPDATE-BILLING-STATISTICS.
  6648     IF PB-ISSUE
  6649         IF PB-FATAL-ERRORS
  6650           OR  PB-UNFORCED-ERRORS
  6651           OR  PB-RECORD-ON-HOLD
  6652             ADD +1              TO  PI-ISSUES-INER
  6653             GO TO 1049-EXIT.
  6654
  6655     IF PB-CANCELLATION
  6656         IF PB-FATAL-ERRORS
  6657           OR  PB-UNFORCED-ERRORS
  6658           OR  PB-RECORD-ON-HOLD
  6659             ADD +1              TO  PI-CANCELS-INER
  6660             GO TO 1049-EXIT.
  6661
  6662     IF PB-ISSUE
  6663         IF PB-GA-BILL-DT (WS-GA-LEVEL)  =
  6664                (LOW-VALUES OR SPACES)
  6665           OR  PI-TOT-REBILL
  6666             ADD +1              TO  PI-ISSUES-BILLED
  6667             GO TO 1049-EXIT.
  6668
  6669     IF PB-CANCELLATION
  6670         IF PB-GA-BILL-DT (WS-GA-LEVEL)  =
  6671                (LOW-VALUES OR SPACES)
  6672           OR  PI-TOT-REBILL
  6673             ADD +1              TO  PI-CANCELS-BILLED
  6674             GO TO 1049-EXIT.
  6675
  6676     IF PB-ISSUE
  6677         IF PB-GA-BILL-DT (WS-GA-LEVEL)  NOT =  LOW-VALUES
  6678           AND  SPACES
  6679             ADD +1              TO  PI-ISSUES-PREV
  6680             GO TO 1049-EXIT.
  6681
  6682     IF PB-CANCELLATION
  6683         IF PB-GA-BILL-DT (WS-GA-LEVEL)  NOT =  LOW-VALUES
  6684           AND  SPACES
  6685             ADD +1              TO  PI-CANCELS-PREV
  6686             GO TO 1049-EXIT.
  6687
  6688     ADD +1                      TO  PI-UNKNOWN.
  6689
  6690 1049-EXIT.
  6691     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL642.cbl
  6693 1100-PYAJ-BILLING-PROCESS.
  6694******************************************************************
  6695*   PROCESS THE ACCOUNTS PAYMENTS AND ADUSTMENTS. IF THE GENERAL *
  6696*   AGENT IS NOT FINANCIALLY RESPONSIBLE FOR THE ACCOUNT DO NOT  *
  6697*   PROCESS THE ACCOUNT'S PAYMENTS AND ADJUSTMENTS.              *
  6698*                                                                *
  6699*   1.  PROCESS THE ACCOUNT'S PAYMENTS AND ADUSTMENTS.           *
  6700*                                                                *
  6701*   2.  IF THE GENERAL AGENT IS NOT FINANCIALLY RESPONSIBLE FOR  *
  6702*       THE ACCOUNT, DO NOT PROCESS THE ACCOUNT'S PAYMENTS AND   *
  6703*       ADJUSTMENTS.                                             *
  6704*                                                                *
  6705*   3.  IF PRINTED BILL IS NOT PRODUCED, DO NOT PROCESS THE      *
  6706*       ACCOUNT'S PAYMENTS AND ADJUSTMENTS.                      *
  6707******************************************************************
  6708
  6709     IF PI-SAV-AGENT  =  PI-SAV-REMIT-TO
  6710         NEXT SENTENCE
  6711     ELSE
  6712         GO TO 1190-EXIT.
  6713
  6714     IF PI-UPDATE-FILES
  6715       OR  (PI-PREVIEW  AND  APRODSWI = 'Y')
  6716         NEXT SENTENCE
  6717     ELSE
  6718         GO TO 1190-EXIT.
  6719
  6720 1105-PYAJ-BILLING-STARTBR-LOOP.
  6721     MOVE 'A'                    TO  COMPENSATION-SW.
  6722
  6723     PERFORM 4500-PYAJ-START-BROWSE  THRU  4590-EXIT.
  6724
  6725     IF PYAJ-EOF
  6726         GO TO 1190-EXIT.
  6727
  6728 1110-PYAJ-BILLING-READ-LOOP.
  6729     PERFORM 4600-PYAJ-READ-NEXT  THRU  4690-EXIT.
  6730
  6731     IF PYAJ-EOF
  6732         PERFORM 4800-PYAJ-END-BROWSE
  6733         GO TO 1190-EXIT.
  6734
  6735     IF PY-COMPANY-CD  =  ERPYAJ-BR-COMP-CD
  6736       AND  PY-CARRIER  =  ERPYAJ-BR-CARRIER
  6737       AND  PY-GROUPING  =  ERPYAJ-BR-GROUPING
  6738       AND  PY-FIN-RESP  =  ERPYAJ-BR-FIN-RESP
  6739       AND  PY-ACCOUNT  =  ERPYAJ-BR-ACCOUNT
  6740         NEXT SENTENCE
  6741     ELSE
  6742         PERFORM 4800-PYAJ-END-BROWSE
  6743         GO TO 1190-EXIT.
  6744
  6745     IF PY-CREDIT-ACCEPT-DT  NOT =  LOW-VALUES
  6746         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6747
  6748     IF PY-RECORD-TYPE  = 'R' OR 'D' OR 'C' OR 'S' OR 'T' OR 'U'
  6749                              OR 'Z'
  6750         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL642.cbl
  6751     ELSE
  6752         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6753
  6754     IF PY-VOID-SW  NOT =  SPACES
  6755         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6756
  6757     IF PI-AR-PROCESSING
  6758        IF PY-AR-DATE  =  LOW-VALUES
  6759           NEXT SENTENCE
  6760        ELSE
  6761           GO TO 1110-PYAJ-BILLING-READ-LOOP
  6762     ELSE
  6763        IF (PY-BILLED-DATE  =  LOW-VALUES AND
  6764            PY-AR-DATE = LOW-VALUES)
  6765           NEXT SENTENCE
  6766        ELSE
  6767           GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6768
  6769     IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  6770        PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  6771        PY-ADD-TO-BALANCE
  6772         ADD PY-ENTRY-AMT        TO  WS-ACCT-PAY-ADJS
  6773     ELSE
  6774         SUBTRACT PY-ENTRY-AMT   FROM  WS-ACCT-PAY-ADJS.
  6775
  6776     GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6777
  6778 1190-EXIT.
  6779     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL642.cbl
  6781 1200-PYAJ-BILLING-COMPLETE.
  6782******************************************************************
  6783*      1. IF PRINTED BILL IS PRODUCED PRINT THE GENERAL AGENT'S  *
  6784*         TOTALS.                                                *
  6785*                                                                *
  6786*      2. PROCESS THE GENERAL AGENT'S PAYMENTS AND ADJUSTMENTS.  *
  6787******************************************************************
  6788
  6789     IF PI-DATA-BILLED
  6790         NEXT SENTENCE
  6791     ELSE
  6792         MOVE ER-2913            TO  EMI-ERROR
  6793         MOVE -1                 TO  AACCT1L
  6794         MOVE AL-UABON           TO  AACCT1A
  6795         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6796
  6797     IF RETURNED-FROM  =  SPACES
  6798         IF PI-UPDATE-FILES
  6799           OR  (PI-PREVIEW  AND  APRODSWI = 'Y')
  6800             IF PI-ACCT-BILLED
  6801                 MOVE 'TB'       TO  BILLING-DETAIL-TYPE
  6802                 PERFORM 3000-WRITE-BILLING-DETAIL
  6803                         THRU  3990-EXIT
  6804             ELSE
  6805                 MOVE 'TS'       TO  BILLING-DETAIL-TYPE
  6806                 PERFORM 3000-WRITE-BILLING-DETAIL
  6807                         THRU  3990-EXIT.
  6808
  6809 1205-PYAJ-BILLING-STARTBR-LOOP.
  6810     MOVE PI-SAV-AGENT           TO  PI-SAV-FIN-RESP.
  6811     MOVE 'G'                    TO  COMPENSATION-SW.
  6812
  6813     PERFORM 4500-PYAJ-START-BROWSE  THRU  4590-EXIT.
  6814
  6815     IF PYAJ-EOF
  6816         GO TO 1260-BILLING-COMPLETE.
  6817
  6818 1210-PYAJ-BILLING-READ-LOOP.
  6819     PERFORM 4600-PYAJ-READ-NEXT  THRU  4690-EXIT.
  6820
  6821     IF PYAJ-EOF
  6822         GO TO 1250-END-AGENTS-PAY-ADJS.
  6823
  6824     IF NOT PI-AR-PROCESSING
  6825         IF PY-COMPANY-CD  =  ERPYAJ-BR-COMP-CD
  6826           AND  PY-CARRIER  =  ERPYAJ-BR-CARRIER
  6827           AND  PY-GROUPING  =  ERPYAJ-BR-GROUPING
  6828           AND  PY-FIN-RESP  =  ERPYAJ-BR-FIN-RESP
  6829           AND  PY-ACCOUNT  =  ERPYAJ-BR-ACCOUNT
  6830             GO TO 1230-CHECK-PYAJ-ENTRY
  6831         ELSE
  6832             GO TO 1250-END-AGENTS-PAY-ADJS
  6833     ELSE
  6834         IF PY-COMPANY-CD  =  ERPYAJ-BR-COMP-CD
  6835           AND  PY-CARRIER  =  ERPYAJ-BR-CARRIER
  6836           AND  PY-GROUPING  =  ERPYAJ-BR-GROUPING
  6837           AND  PY-FIN-RESP  =  ERPYAJ-BR-FIN-RESP
  6838             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL642.cbl
  6839         ELSE
  6840             GO TO 1250-END-AGENTS-PAY-ADJS.
  6841
  6842      IF PY-PMT-APPLIED = 'O' OR
  6843         PY-ACCOUNT = LOW-VALUES
  6844          NEXT SENTENCE
  6845      ELSE
  6846          GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6847
  6848 1230-CHECK-PYAJ-ENTRY.
  6849
  6850     IF PY-CREDIT-ACCEPT-DT  NOT =  LOW-VALUES
  6851         GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6852
  6853     IF PY-RECORD-TYPE  = 'R' OR 'D' OR 'C' OR 'S' OR 'T' OR 'U'
  6854                              OR 'Z'
  6855         NEXT SENTENCE
  6856     ELSE
  6857         GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6858
  6859     IF PY-VOID-SW  NOT =  SPACES
  6860         GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6861
  6862     IF PI-AR-PROCESSING
  6863        IF PY-AR-DATE  =  LOW-VALUES
  6864           OR  PI-TOT-REBILL
  6865           OR  RETURNED-FROM  =  XCTL-PYAJ
  6866               NEXT SENTENCE
  6867        ELSE
  6868           GO TO 1210-PYAJ-BILLING-READ-LOOP
  6869     ELSE
  6870        IF (PY-BILLED-DATE  =  LOW-VALUES AND
  6871            PY-AR-DATE = LOW-VALUES)
  6872           OR  PI-TOT-REBILL
  6873           OR  RETURNED-FROM  =  XCTL-PYAJ
  6874           NEXT SENTENCE
  6875        ELSE
  6876           GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6877
  6878     IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  6879        PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  6880        PY-ADD-TO-BALANCE
  6881         ADD PY-ENTRY-AMT        TO  PI-REMITTED
  6882     ELSE
  6883         IF PY-CHARGE-TO-AGENT
  6884           OR  PY-ADJ-CHG-TO-AGT
  6885             IF PY-GA-CHECK
  6886                 ADD PY-ENTRY-AMT  TO  PI-DISBURSED
  6887             ELSE
  6888                 ADD PY-ENTRY-AMT  TO  PI-ADJUSTMNTS.
  6889
  6890     IF RETURNED-FROM  =  SPACES
  6891         IF PI-UPDATE-FILES
  6892           OR  (PI-PREVIEW  AND  APRODSWI = 'Y')
  6893             MOVE 'BP'           TO  BILLING-DETAIL-TYPE
  6894             PERFORM 3000-WRITE-BILLING-DETAIL  THRU  3990-EXIT.
  6895
  6896     GO TO 1210-PYAJ-BILLING-READ-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL642.cbl
  6897
  6898 1250-END-AGENTS-PAY-ADJS.
  6899     PERFORM 4800-PYAJ-END-BROWSE.
  6900
  6901     IF PI-DATA-BILLED
  6902         NEXT SENTENCE
  6903     ELSE
  6904         MOVE ER-2913            TO  EMI-ERROR
  6905         MOVE -1                 TO  AACCT1L
  6906         MOVE AL-UABON           TO  AACCT1A
  6907         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6908
  6909 1260-BILLING-COMPLETE.
  6910     IF WS-UPDATE-FILES
  6911         PERFORM 6500-REWRITE-CROSS-REFERENCE.
  6912
  6913     IF EMI-NO-ERRORS
  6914         MOVE 0000               TO  EMI-ERROR
  6915         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6916
  6917     MOVE -1                     TO  AAGENTL.
  6918
  6919     PERFORM 5000-FORMAT-SCREEN  THRU  5090-EXIT.
  6920
  6921     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL642.cbl
  6923 2000-VOID-BILLING.
  6924******************************************************************
  6925*     THIS SECTION WILL RESET THE GA-BILLING-FLAGS IN THE        *
  6926*     PENDING BUSINESS RECORDS AND RESET THE LAST BILLED         *
  6927*     DATE IN THE GENERAL AGENT'S CROSS-REFERENCE-FILE TO        *
  6928*     LOW-VALUES.                                                *
  6929******************************************************************
  6930
  6931     MOVE SPACES                 TO  ELCNTL-KEY.
  6932     MOVE '1'                    TO  ELCNTL-REC-TYPE.
  6933
  6934     PERFORM 6100-READ-CONTROL-FILE  THRU  6120-EXIT.
  6935
  6936     IF EMI-ERROR  NOT =  ZEROS
  6937         GO TO 8200-SEND-DATAONLY.
  6938
  6939     MOVE CF-CURRENT-MONTH-END   TO  DC-BIN-DATE-1.
  6940     MOVE SPACE                  TO  DC-OPTION-CODE.
  6941
  6942     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  6943
  6944     MOVE DC-GREG-DATE-1-EDIT    TO  PI-MONTH-END-DATE.
  6945
  6946     PERFORM 6400-READ-CROSS-REFERENCE  THRU  6490-EXIT.
  6947
  6948     MOVE +0                     TO  GX-SUB.
  6949
  6950 2005-GXRF-BILLING-PROCESS-LOOP.
  6951     ADD +1                      TO  GX-SUB.
  6952
  6953     IF GX-SUB  GREATER THAN  GX-AGENT-POINTER-CNT
  6954         GO TO 2100-VOID-PNDB-COMPLETE.
  6955
  6956     MOVE GX-AM-CARRIER (GX-SUB)   TO  PI-CR-CARRIER.
  6957     MOVE GX-AM-GROUPING (GX-SUB)  TO  PI-CR-GROUPING.
  6958     MOVE GX-AM-STATE (GX-SUB)     TO  PI-CR-STATE.
  6959     MOVE GX-AM-ACCOUNT (GX-SUB)   TO  PI-CR-ACCOUNT.
  6960     MOVE GX-AGENT-NO              TO  PI-SAV-AGENT.
  6961     MOVE GX-AM-EXPIRATION-DT (GX-SUB)
  6962                                   TO  PI-SAV-EXP-DT.
  6963     MOVE GX-AM-LEVEL-NO (GX-SUB)  TO  WS-GA-LEVEL.
  6964     MOVE LOW-VALUES               TO  GX-LAST-BILL-DT (GX-SUB).
  6965
  6966     PERFORM 4000-PNDB-START-BROWSE  THRU  4090-EXIT.
  6967
  6968     IF PNDB-EOF
  6969         PERFORM 4160-PNDB-END-BROWSE
  6970         GO TO 2005-GXRF-BILLING-PROCESS-LOOP.
  6971
  6972 2010-VOID-PNDB-LOOP.
  6973     PERFORM 4100-PNDB-READ-NEXT  THRU  4150-EXIT.
  6974
  6975     IF PNDB-EOF
  6976         PERFORM 4160-PNDB-END-BROWSE
  6977         GO TO 2005-GXRF-BILLING-PROCESS-LOOP.
  6978
  6979     IF PB-COMPANY-CD-A1  =  PI-COMPANY-CD
  6980       AND  PB-SV-CARRIER  =  PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL642.cbl
  6981       AND  PB-SV-GROUPING  =  PI-CR-GROUPING
  6982       AND  PB-SV-STATE  =  PI-CR-STATE
  6983       AND  PB-ACCOUNT  =  PI-CR-ACCOUNT
  6984         NEXT SENTENCE
  6985     ELSE
  6986         PERFORM 4160-PNDB-END-BROWSE
  6987         GO TO 2005-GXRF-BILLING-PROCESS-LOOP.
  6988
  6989     IF PB-CREDIT-ACCEPT-DT  NOT =  LOW-VALUES
  6990         GO TO 2010-VOID-PNDB-LOOP.
  6991
  6992     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  (LOW-VALUES  OR  SPACES)
  6993         GO TO 2010-VOID-PNDB-LOOP.
  6994
  6995     IF PB-CERT-EFF-DT  =  GX-AM-EXPIRATION-DT (GX-SUB)
  6996       OR  PB-CERT-EFF-DT  GREATER THAN
  6997               GX-AM-EXPIRATION-DT (GX-SUB)
  6998         PERFORM 4160-PNDB-END-BROWSE
  6999         GO TO 2005-GXRF-BILLING-PROCESS-LOOP.
  7000
  7001     IF PB-CERT-EFF-DT  LESS THAN  GX-AM-EFF-DT (GX-SUB)
  7002         GO TO 2010-VOID-PNDB-LOOP.
  7003
  7004     IF PB-BATCH-TRAILER
  7005         GO TO 2010-VOID-PNDB-LOOP.
  7006
  7007     PERFORM 4200-PNDB-REWRITE  THRU  4290-EXIT.
  7008
  7009     MOVE 'Y'                    TO  DATA-VOIDED-SW.
  7010
  7011     GO TO 2010-VOID-PNDB-LOOP.
  7012
  7013 2100-VOID-PNDB-COMPLETE.
  7014     IF DATA-VOIDED
  7015         NEXT SENTENCE
  7016     ELSE
  7017         MOVE -1                 TO  APFNTERL
  7018         MOVE ER-2401            TO  EMI-ERROR
  7019         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7020         GO TO 8100-SEND-INITIAL-MAP.
  7021
  7022     PERFORM 3940-BILL-GENERIC-DELETE  THRU  3940-EXIT.
  7023
  7024     PERFORM 6500-REWRITE-CROSS-REFERENCE  THRU  6590-EXIT.
  7025
  7026 2105-VOID-COMPLETE.
  7027     MOVE 0000                   TO  EMI-ERROR
  7028
  7029     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7030
  7031     MOVE -1                     TO  AAGENTL.
  7032
  7033     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL642.cbl
  7035 3000-WRITE-BILLING-DETAIL.
  7036******************************************************************
  7037*     THIS SECTION FORMATS THE BILLING PRINT RECORDS.  THESE     *
  7038*     RECORDS ARE CREATED IN THE SAME FORMAT THAT THEY APPEAR    *
  7039*     WHEN PRINTED.                                              *
  7040*                                                                *
  7041*     THIS SECTION PRINTS THE BILLING STATEMENT AND PRINT LABELS.*
  7042*     BILLING-DETAIL-TYPES                                       *
  7043*            TOTAL-STATEMENT   TS                                *
  7044*            TOTAL-ACCOUNT     TA                                *
  7045*            TOTAL-BOTH        TB                                *
  7046*            GAN-AGT-ADDRESS   GA                                *
  7047*                              BP                                *
  7048******************************************************************
  7049
  7050     IF GEN-AGT-ADDRESS
  7051         PERFORM 3930-BILL-READ  THRU  3930-EXIT
  7052         IF NO-BILL-RECS
  7053             GO TO 3200-FORMAT-HDR-ADDR-RECS
  7054         ELSE
  7055             IF BI-PREVIEW-ONLY
  7056               OR  BI-INITIAL-PRINT-DATE  NOT =  LOW-VALUES
  7057               OR  PI-TOT-REBILL
  7058                 PERFORM 3940-BILL-GENERIC-DELETE
  7059                     THRU  3940-EXIT
  7060                 GO TO 3200-FORMAT-HDR-ADDR-RECS
  7061             ELSE
  7062                 MOVE ER-2403    TO  EMI-ERROR
  7063                 MOVE -1         TO  ABILTYPL
  7064                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7065                 GO TO 8200-SEND-DATAONLY.
  7066
  7067 3100-FORMAT-DETAIL-LINES.
  7068     IF WS-LINECTR  GREATER THAN  23
  7069         MOVE ZEROS              TO  WS-LINECTR
  7070         MOVE '3'                TO  BI-RECORD-TYPE
  7071         MOVE TRIPLE-SPACE       TO  BI-SKIP-CONTROL
  7072         MOVE '          CONTINUED ON NEXT PAGE'
  7073                                 TO  BI-TEXT-LINE
  7074         PERFORM 3920-BILL-WRITE
  7075         PERFORM 3300-FORMAT-HEADINGS  THRU  3380-EXIT.
  7076
  7077     IF WS-LINECTR  =  ZEROS
  7078         MOVE DOUBLE-SPACE       TO  BI-SKIP-CONTROL
  7079     ELSE
  7080         MOVE SINGLE-SPACE       TO  BI-SKIP-CONTROL.
  7081
  7082     MOVE '3'                    TO  BI-RECORD-TYPE.
  7083     MOVE SPACES                 TO  GA-TEXT-LINE.
  7084
  7085     IF TOTAL-STATEMENT
  7086         GO TO 3175-CHECK-AGENT-TOTAL.
  7087
  7088     IF BILLING-DETAIL-TYPE  =  'BP'
  7089        IF PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT
  7090            MOVE PY-ENTRY-COMMENT
  7091                                 TO  GA-ENTRY-DESC
  7092            MULTIPLY PY-ENTRY-AMT  BY  -1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL642.cbl
  7093                GIVING  GA-PMTS-ADJS
  7094            MOVE PY-ENTRY-COMMENT
  7095                                 TO  GA-ENTRY-DESC
  7096            MOVE '* ACCOUNTING ENTRY *'
  7097                                 TO  GA-ENTRY-COMMENT
  7098            ADD +1               TO  WS-LINECTR
  7099            IF PY-ACCOUNT = LOW-VALUES
  7100                MOVE SPACES      TO  GA-ACCT
  7101                PERFORM 3920-BILL-WRITE
  7102                GO TO 3990-EXIT
  7103            ELSE
  7104                MOVE PY-ACCOUNT  TO  GA-ACCT
  7105                PERFORM 3920-BILL-WRITE
  7106                GO TO 3990-EXIT.
  7107
  7108     IF BILLING-DETAIL-TYPE  =  'BP'
  7109         MOVE PY-ENTRY-COMMENT   TO  GA-ENTRY-DESC
  7110         MOVE PY-ENTRY-AMT       TO  GA-PMTS-ADJS
  7111         MOVE '* ACCOUNTING ENTRY *'
  7112                                 TO  GA-ENTRY-COMMENT
  7113         MOVE PY-ACCOUNT         TO  GA-ACCT
  7114         ADD +1                  TO  WS-LINECTR
  7115            IF PY-ACCOUNT = LOW-VALUES
  7116                MOVE SPACES      TO  GA-ACCT
  7117                PERFORM 3920-BILL-WRITE
  7118                GO TO 3990-EXIT
  7119            ELSE
  7120                MOVE PY-ACCOUNT  TO  GA-ACCT
  7121                PERFORM 3920-BILL-WRITE
  7122                GO TO 3990-EXIT.
  7123
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL642.cbl
  7125 3150-FORMAT-ACCOUNT-LINE.
  7126     MOVE SPACES                 TO  GA-TEXT-LINE.
  7127     MOVE PI-SAV-ACCT-AGT        TO  GA-ACCT.
  7128     MOVE PI-SAV-ACCT-NAME       TO  GA-ACCT-NAME.
  7129     MOVE WS-ACCT-BEG-BAL        TO  GA-BEG-BAL
  7130                                     GA-BEG-BAL-AMT.
  7131     MOVE WS-ACCT-NET-PREM       TO  GA-NET-PREM
  7132                                     GA-NET-PREM-AMT.
  7133     MOVE WS-ACCT-COMP           TO  GA-ACCT-COMP
  7134                                     GA-ACCT-COMP-AMT.
  7135     MOVE WS-ACCT-PAY-ADJS       TO  GA-PMTS-ADJS
  7136                                     GA-PMTS-ADJS-AMT.
  7137
  7138     IF PI-SAV-AGENT  NOT =  PI-SAV-REMIT-TO
  7139         MOVE ZEROS              TO  GA-END-BAL-AMT
  7140     ELSE
  7141         COMPUTE GA-END-BAL-AMT =
  7142             (WS-ACCT-BEG-BAL + WS-ACCT-NET-PREM) -
  7143              (WS-ACCT-COMP + WS-ACCT-PAY-ADJS).
  7144
  7145     MOVE WS-ACCT-UNPAID-NET-PREM
  7146                                 TO  GA-UNPAID-NET-PREM
  7147                                     GA-UNPAID-NET-AMT.
  7148     MOVE ZEROS                  TO  GA-OVERWRITE-AMT.
  7149
  7150     IF WS-ACCT-LF-OVERWRITE  NOT =  ZEROS
  7151         MOVE PI-LIFE-OVERRIDE-L6
  7152                                 TO  GA-BEN-OVERRIDE-L6
  7153         MOVE PI-LIFE-OVERRIDE-L2
  7154                                 TO  GA-BENEFIT-CD
  7155         MOVE WS-ACCT-LF-OVERWRITE
  7156                                 TO  GA-OVERWRITE
  7157                                     GA-OVERWRITE-AMT
  7158     ELSE
  7159         IF WS-ACCT-AH-OVERWRITE  NOT =  ZEROS
  7160             MOVE PI-AH-OVERRIDE-L6
  7161                                 TO  GA-BEN-OVERRIDE-L6
  7162             MOVE PI-AH-OVERRIDE-L2
  7163                                 TO  GA-BENEFIT-CD
  7164             MOVE WS-ACCT-AH-OVERWRITE
  7165                                 TO  GA-OVERWRITE
  7166                                     GA-OVERWRITE-AMT.
  7167
  7168     COMPUTE GA-AMT-DUE-AMT = GA-END-BAL-AMT -
  7169         (WS-ACCT-LF-OVERWRITE + WS-ACCT-AH-OVERWRITE).
  7170
  7171     ADD  GA-AMT-DUE-AMT         TO  WS-GA-AMT-DUE.
  7172
  7173     MOVE GA-AMT-DUE-AMT         TO  GA-AMT-DUE.
  7174
  7175     ADD +1                      TO  WS-LINECTR.
  7176
  7177     PERFORM 3920-BILL-WRITE.
  7178
  7179     MOVE SPACES                 TO  GA-TEXT-LINE.
  7180     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7181
  7182     IF WS-ACCT-LF-OVERWRITE  NOT =  ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL642.cbl
  7183         IF WS-ACCT-AH-OVERWRITE  NOT =  ZEROS
  7184             MOVE PI-AH-OVERRIDE-L6
  7185                                 TO  GA-BEN-OVERRIDE-L6
  7186             MOVE PI-AH-OVERRIDE-L2
  7187                                 TO  GA-BENEFIT-CD
  7188             MOVE WS-ACCT-AH-OVERWRITE
  7189                                 TO  GA-OVERWRITE
  7190                                     GA-OVERWRITE-AMT
  7191             MOVE ZEROS          TO  GA-BEG-BAL-AMT
  7192                                     GA-END-BAL-AMT
  7193                                     GA-NET-PREM-AMT
  7194                                     GA-ACCT-COMP-AMT
  7195                                     GA-PMTS-ADJS-AMT
  7196                                     GA-UNPAID-NET-AMT
  7197                                     GA-AMT-DUE-AMT
  7198             ADD +1              TO  WS-LINECTR
  7199             PERFORM 3920-BILL-WRITE.
  7200
  7201     ADD WS-ACCT-BEG-BAL         TO  WS-GA-BEG-BAL
  7202                                     PI-ACCT-BEG-BAL.
  7203     ADD WS-ACCT-NET-PREM        TO  WS-GA-NET-PREM
  7204                                     PI-ACCT-NET-PREM.
  7205     ADD WS-ACCT-COMP            TO  WS-GA-COMP
  7206                                     PI-ACCT-COMP.
  7207     ADD WS-ACCT-PAY-ADJS        TO  WS-GA-PAY-ADJS
  7208                                     PI-ACCT-PAY-ADJS.
  7209     ADD WS-ACCT-UNPAID-NET-PREM
  7210                                 TO  WS-GA-UNPAID-NET-PREM.
  7211     ADD WS-ACCT-LF-OVERWRITE    TO  WS-GA-LF-OVERWRITE.
  7212     ADD WS-ACCT-AH-OVERWRITE    TO  WS-GA-AH-OVERWRITE.
  7213     ADD GA-END-BAL-AMT          TO  WS-GA-END-BAL.
  7214
  7215     MOVE ZEROS                  TO  WS-ACCT-BEG-BAL
  7216                                     WS-ACCT-NET-PREM
  7217                                     WS-ACCT-COMP
  7218                                     WS-ACCT-PAY-ADJS
  7219                                     WS-ACCT-UNPAID-NET-PREM
  7220                                     WS-ACCT-LF-OVERWRITE
  7221                                     WS-ACCT-AH-OVERWRITE.
  7222     MOVE SPACE                  TO  PI-ACCT-BILLED-SW.
  7223     MOVE SPACE                  TO  ACCOUNT-CARRY-BAL-SW.
  7224
  7225     IF TOTAL-STATEMENT
  7226         GO TO 3400-FORMAT-TOTAL-LINE.
  7227
  7228 3175-CHECK-AGENT-TOTAL.
  7229
  7230     IF TOTAL-STATEMENT OR
  7231        TOTAL-BOTH
  7232         GO TO 3400-FORMAT-TOTAL-LINE.
  7233
  7234     GO TO 3990-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL642.cbl
  7236 3200-FORMAT-HDR-ADDR-RECS.
  7237     PERFORM 3910-BILL-GETMAIN.
  7238
  7239     MOVE ZEROS                  TO  WS-LINE-SEQ-NO.
  7240
  7241     SET A-INDX                  TO  1.
  7242
  7243     PERFORM 3210-FORMAT-ADDR-RECS  THRU  3210-EXIT  6  TIMES.
  7244
  7245     MOVE ZEROS                  TO  WS-LINE-SEQ-NO.
  7246
  7247     PERFORM 3300-FORMAT-HEADINGS  THRU  3380-EXIT.
  7248
  7249     PERFORM 3220-WRITE-AGENTS-BAL  THRU  3220-EXIT.
  7250
  7251     GO TO 3990-EXIT.
  7252
  7253 3210-FORMAT-ADDR-RECS.
  7254     MOVE '2'                    TO  BI-RECORD-TYPE.
  7255     MOVE SPACES                 TO  GA-TEXT-LINE.
  7256     MOVE WS-AGENT-LINES (A-INDX)
  7257                                 TO  GA-ACCT-ADDRESS-LINE.
  7258
  7259     PERFORM 3920-BILL-WRITE.
  7260
  7261     SET A-INDX                  UP  BY  1.
  7262
  7263 3210-EXIT.
  7264     EXIT.
  7265
  7266 3220-WRITE-AGENTS-BAL.
  7267     MOVE SPACES                 TO GA-TEXT-LINE.
  7268     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7269
  7270     PERFORM 3920-BILL-WRITE.
  7271
  7272     MOVE 'BEGINNING BALANCE'    TO  GA-ACCT-NAME
  7273     MOVE PI-BAL-FRWD            TO  GA-BEG-BAL.
  7274     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7275
  7276     PERFORM 3920-BILL-WRITE.
  7277
  7278     MOVE SPACES                 TO  GA-TEXT-LINE.
  7279     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7280
  7281     PERFORM 3920-BILL-WRITE.
  7282
  7283 3220-EXIT.
  7284     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL642.cbl
  7286 3300-FORMAT-HEADINGS.
  7287     MOVE WS-PGECTR              TO  HD-PG.
  7288
  7289     ADD +1                      TO  WS-PGECTR.
  7290
  7291     MOVE '3'                    TO  BI-RECORD-TYPE.
  7292     MOVE TOP-OF-PAGE            TO  BI-SKIP-CONTROL.
  7293
  7294     IF NOT PI-PREVIEW
  7295         MOVE GA-HD1             TO  GA-TEXT-LINE
  7296     ELSE
  7297         MOVE GA-PREVIEW-HD      TO  GA-TEXT-LINE
  7298         PERFORM 3920-BILL-WRITE
  7299         MOVE '3'                TO  BI-RECORD-TYPE
  7300         MOVE DOUBLE-SPACE       TO  BI-SKIP-CONTROL
  7301         MOVE GA-HD1             TO  GA-TEXT-LINE.
  7302
  7303     PERFORM 3920-BILL-WRITE.
  7304
  7305     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7306     MOVE GA-HD2                 TO  GA-TEXT-LINE.
  7307
  7308     PERFORM 3920-BILL-WRITE.
  7309
  7310     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7311     MOVE GA-HD3                 TO  GA-TEXT-LINE.
  7312
  7313     PERFORM 3920-BILL-WRITE.
  7314
  7315     SET A-INDX                  TO  1.
  7316
  7317     PERFORM 3390-FORMAT-ADDR-TEXT-LINES  THRU  3390-EXIT
  7318         6  TIMES.
  7319
  7320     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7321     MOVE GA-HD4                 TO  GA-TEXT-LINE.
  7322
  7323     PERFORM 3920-BILL-WRITE.
  7324
  7325     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7326     MOVE GA-HD5                 TO  GA-TEXT-LINE.
  7327
  7328     PERFORM 3920-BILL-WRITE.
  7329
  7330 3380-EXIT.
  7331     EXIT.
  7332
  7333 3390-FORMAT-ADDR-TEXT-LINES.
  7334     MOVE '3'                    TO  BI-RECORD-TYPE.
  7335     MOVE SPACES                 TO  GA-TEXT-LINE.
  7336
  7337     IF A-INDX  =  1
  7338         MOVE DOUBLE-SPACE       TO  BI-SKIP-CONTROL
  7339         MOVE PI-SAV-CARR        TO  GA-CARRIER
  7340         MOVE PI-SAV-GROUP       TO  GA-GROUPING
  7341         MOVE PI-SAV-AGENT       TO  GA-AGENT
  7342         MOVE '-'                TO  GA-DASH
  7343     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL642.cbl
  7344         MOVE SINGLE-SPACE       TO  BI-SKIP-CONTROL.
  7345
  7346     MOVE WS-AGENT-LINES (A-INDX)  TO  GA-AGENT-ADDR.
  7347
  7348     PERFORM 3920-BILL-WRITE.
  7349
  7350     SET A-INDX                  UP  BY  1.
  7351
  7352 3390-EXIT.
  7353     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL642.cbl
  7355 3400-FORMAT-TOTAL-LINE.
  7356     MOVE SPACES                 TO  GA-TEXT-LINE.
  7357     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7358     MOVE '3'                    TO  BI-RECORD-TYPE.
  7359     MOVE SPACES                 TO  GA-TEXT-LINE.
  7360
  7361     PERFORM 3920-BILL-WRITE.
  7362
  7363     MOVE SPACES                 TO  GA-TEXT-LINE.
  7364     MOVE 'AGENT TOTAL'          TO  GA-ACCT-NAME.
  7365     MOVE WS-GA-BEG-BAL          TO  GA-BEG-BAL
  7366                                     GA-BEG-BAL-AMT.
  7367     MOVE WS-GA-NET-PREM         TO  GA-NET-PREM
  7368                                     GA-NET-PREM-AMT.
  7369     MOVE WS-GA-COMP             TO  GA-ACCT-COMP
  7370                                     GA-ACCT-COMP-AMT.
  7371     MOVE WS-GA-PAY-ADJS         TO  GA-PMTS-ADJS
  7372                                     GA-PMTS-ADJS-AMT.
  7373     MOVE WS-GA-END-BAL          TO  GA-END-BAL-AMT.
  7374     MOVE WS-GA-UNPAID-NET-PREM  TO  GA-UNPAID-NET-PREM
  7375                                     GA-UNPAID-NET-AMT.
  7376     MOVE PI-LIFE-OVERRIDE-L6    TO  GA-BEN-OVERRIDE-L6.
  7377     MOVE PI-LIFE-OVERRIDE-L2    TO  GA-BENEFIT-CD.
  7378     MOVE WS-GA-LF-OVERWRITE     TO  GA-OVERWRITE
  7379                                     GA-OVERWRITE-AMT.
  7380     MOVE WS-GA-AMT-DUE          TO  GA-AMT-DUE-AMT
  7381                                     GA-AMT-DUE.
  7382
  7383     PERFORM 3920-BILL-WRITE.
  7384
  7385     MOVE SPACES                 TO  GA-TEXT-LINE.
  7386     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7387     MOVE PI-AH-OVERRIDE-L6      TO  GA-BEN-OVERRIDE-L6
  7388     MOVE PI-AH-OVERRIDE-L2      TO  GA-BENEFIT-CD
  7389     MOVE WS-GA-AH-OVERWRITE     TO  GA-OVERWRITE
  7390                                     GA-OVERWRITE-AMT.
  7391
  7392     PERFORM 3920-BILL-WRITE.
  7393
  7394     MOVE SPACES                 TO  GA-TEXT-LINE.
  7395     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7396
  7397     PERFORM 3920-BILL-WRITE.
  7398
  7399     MOVE SPACES                 TO  GA-TEXT-LINE.
  7400     MOVE '1'                    TO  BI-RECORD-TYPE.
  7401     MOVE PI-PROCESSOR-ID        TO  GA-PROCESSOR-CD.
  7402
  7403     IF PI-PREV-BILL
  7404       OR  PI-PREV-REBILL
  7405         MOVE 'P'                TO  GA-STATEMENT-TYPE.
  7406
  7407     MOVE +1                     TO  GA-NO-OF-COPIES.
  7408     MOVE WS-CURRENT-DATE        TO  GA-CREATION-DT.
  7409     MOVE LOW-VALUES             TO  GA-INITIAL-PRINT-DATE.
  7410     MOVE PI-UNPAID-NET-PREM     TO  GA-NET-UNPD.
  7411     MOVE PI-COMP-UNPAID-PREM    TO  GA-COMP-UNPD-PREM.
  7412     MOVE PI-PREMIUM             TO  GA-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL642.cbl
  7413     MOVE PI-REMITTED            TO  GA-REMITTED.
  7414     MOVE PI-TOT-ISS-COMP        TO  GA-TOT-ISS-COMP.
  7415     MOVE PI-TOT-CAN-COMP        TO  GA-TOT-CAN-COMP.
  7416     MOVE PI-ADJUSTMNTS          TO  GA-ADJUSTMNTS.
  7417     MOVE PI-DISBURSED           TO  GA-DISBURSED.
  7418     MOVE PI-AGENT-NAME          TO  GA-AGENTS-NAME.
  7419
  7420     PERFORM 3920-BILL-WRITE.
  7421
  7422     GO TO 3990-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL642.cbl
  7424 3910-BILL-GETMAIN.
  7425
  7426* EXEC CICS GETMAIN
  7427*        SET      (ADDRESS OF BILLING-STATEMENT)
  7428*        LENGTH   (210)
  7429*        INITIMG  (GETMAIN-SPACE)
  7430*    END-EXEC.
  7431     MOVE 210
  7432       TO DFHEIV11
  7433*    MOVE ',"IL                  $   #00007336' TO DFHEIV0
  7434     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7435     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7436     MOVE X'2020233030303037333336' TO DFHEIV0(25:11)
  7437     CALL 'kxdfhei1' USING DFHEIV0,
  7438           DFHEIV20,
  7439           DFHEIV11,
  7440           GETMAIN-SPACE
  7441     SET ADDRESS OF BILLING-STATEMENT TO
  7442         DFHEIV20
  7443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7444
  7445
  7446 3920-BILL-WRITE.
  7447     MOVE PI-COMPANY-CD          TO  BI-COMPANY-CD.
  7448     MOVE PI-SAV-CARR            TO  BI-CARRIER.
  7449     MOVE PI-SAV-GROUP           TO  BI-GROUPING.
  7450     MOVE LOW-VALUES             TO  BI-ACCOUNT.
  7451     MOVE PI-SAV-AGENT           TO  BI-FIN-RESP.
  7452     MOVE 'BI'                   TO  BI-RECORD-ID.
  7453
  7454     ADD +1                      TO  WS-LINE-SEQ-NO.
  7455
  7456     IF BI-RECORD-TYPE = '1'
  7457         MOVE ZEROS              TO  BI-LINE-SEQ-NO
  7458     ELSE
  7459         MOVE WS-LINE-SEQ-NO     TO  BI-LINE-SEQ-NO.
  7460
  7461
  7462* EXEC CICS WRITE
  7463*        DATASET  (ERBILL-FILE-ID)
  7464*        FROM     (BILLING-STATEMENT)
  7465*        RIDFLD   (BI-CONTROL-PRIMARY)
  7466*    END-EXEC.
  7467     MOVE LENGTH OF
  7468      BILLING-STATEMENT
  7469       TO DFHEIV11
  7470*    MOVE '&$ L                  ''   #00007357' TO DFHEIV0
  7471     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7472     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7473     MOVE X'2020233030303037333537' TO DFHEIV0(25:11)
  7474     CALL 'kxdfhei1' USING DFHEIV0,
  7475           ERBILL-FILE-ID,
  7476           BILLING-STATEMENT,
  7477           DFHEIV11,
  7478           BI-CONTROL-PRIMARY,
  7479           DFHEIV99,
  7480           DFHEIV99
  7481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL642.cbl
  7482
  7483
  7484 3930-BILL-READ.
  7485     MOVE PI-COMPANY-CD          TO  ERBILL-CO-CD.
  7486     MOVE PI-SAV-CARR            TO  ERBILL-CARRIER.
  7487     MOVE PI-SAV-GROUP           TO  ERBILL-GROUP.
  7488     MOVE LOW-VALUES             TO  ERBILL-ACCT.
  7489     MOVE PI-SAV-AGENT           TO  ERBILL-FIN-RESP.
  7490     MOVE '1'                    TO  ERBILL-REC-TYPE.
  7491     MOVE ZEROS                  TO  ERBILL-LINE-SEQ-NO.
  7492
  7493
  7494* EXEC CICS HANDLE CONDITION
  7495*        NOTFND  (3930-BILL-NOTFND)
  7496*    END-EXEC.
  7497*    MOVE '"$I                   ! $ #00007372' TO DFHEIV0
  7498     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7499     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7500     MOVE X'2420233030303037333732' TO DFHEIV0(25:11)
  7501     CALL 'kxdfhei1' USING DFHEIV0
  7502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7503
  7504
  7505
  7506* EXEC CICS READ
  7507*        SET      (ADDRESS OF BILLING-STATEMENT)
  7508*        DATASET  (ERBILL-FILE-ID)
  7509*        RIDFLD   (ERBILL-KEY)
  7510*        GTEQ
  7511*    END-EXEC.
  7512*    MOVE '&"S        G          (   #00007376' TO DFHEIV0
  7513     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7514     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7515     MOVE X'2020233030303037333736' TO DFHEIV0(25:11)
  7516     CALL 'kxdfhei1' USING DFHEIV0,
  7517           ERBILL-FILE-ID,
  7518           DFHEIV20,
  7519           DFHEIV99,
  7520           ERBILL-KEY,
  7521           DFHEIV99,
  7522           DFHEIV99,
  7523           DFHEIV99
  7524     SET ADDRESS OF BILLING-STATEMENT TO
  7525         DFHEIV20
  7526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7527
  7528
  7529     IF BI-COMPANY-CD  =  PI-COMPANY-CD
  7530       AND  BI-CARRIER  =  ERBILL-CARRIER
  7531       AND  BI-GROUPING  =  ERBILL-GROUP
  7532       AND  BI-ACCOUNT  =  ERBILL-ACCT
  7533       AND  BI-FIN-RESP  =  ERBILL-FIN-RESP
  7534         MOVE SPACE              TO  NO-BILL-REC-SW
  7535         GO TO 3930-EXIT
  7536     ELSE
  7537         GO TO 3930-BILL-NOTFND.
  7538
  7539 3930-BILL-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL642.cbl
  7540     MOVE 'Y'                    TO  NO-BILL-REC-SW.
  7541
  7542 3930-EXIT.
  7543     EXIT.
  7544
  7545 3940-BILL-GENERIC-DELETE.
  7546
  7547* EXEC CICS HANDLE CONDITION
  7548*        NOTFND  (3940-EXIT)
  7549*    END-EXEC.
  7550*    MOVE '"$I                   ! % #00007400' TO DFHEIV0
  7551     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7552     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7553     MOVE X'2520233030303037343030' TO DFHEIV0(25:11)
  7554     CALL 'kxdfhei1' USING DFHEIV0
  7555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7556
  7557
  7558     MOVE PI-COMPANY-CD          TO  ERBILL-CO-CD.
  7559     MOVE PI-SAV-CARR            TO  ERBILL-CARRIER.
  7560     MOVE PI-SAV-GROUP           TO  ERBILL-GROUP.
  7561     MOVE LOW-VALUES             TO  ERBILL-ACCT.
  7562     MOVE PI-SAV-AGENT           TO  ERBILL-FIN-RESP.
  7563
  7564
  7565* EXEC CICS DELETE
  7566*        DATASET    (ERBILL-FILE-ID)
  7567*        RIDFLD     (ERBILL-KEY)
  7568*        KEYLENGTH  (28)
  7569*        GENERIC
  7570*    END-EXEC.
  7571     MOVE 28
  7572       TO DFHEIV11
  7573*    MOVE '&(  RKG               &   #00007410' TO DFHEIV0
  7574     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  7575     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7576     MOVE X'2020233030303037343130' TO DFHEIV0(25:11)
  7577     CALL 'kxdfhei1' USING DFHEIV0,
  7578           ERBILL-FILE-ID,
  7579           ERBILL-KEY,
  7580           DFHEIV11,
  7581           DFHEIV99,
  7582           DFHEIV99
  7583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7584
  7585
  7586 3940-EXIT.
  7587     EXIT.
  7588
  7589 3990-EXIT.
  7590     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL642.cbl
  7592 4000-PNDB-START-BROWSE.
  7593     MOVE SPACES                 TO  ERPNDB-ALT-KEY.
  7594     MOVE PI-COMPANY-CD          TO  ERPNDB-CO-CD-A1.
  7595
  7596     IF CARR-GROUP-ST-ACCNT-CNTL
  7597         MOVE GX-AM-CARRIER  (GX-SUB)  TO  ERPNDB-CARR
  7598         MOVE GX-AM-GROUPING (GX-SUB)  TO  ERPNDB-GROUP
  7599         MOVE GX-AM-STATE    (GX-SUB)  TO  ERPNDB-STATE
  7600         MOVE GX-AM-ACCOUNT  (GX-SUB)  TO  ERPNDB-ACCT
  7601     ELSE
  7602     IF CARR-ST-ACCNT-CNTL
  7603         MOVE GX-AM-CARRIER (GX-SUB)   TO  ERPNDB-CARR
  7604         MOVE GX-AM-STATE   (GX-SUB)   TO  ERPNDB-STATE
  7605         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  ERPNDB-ACCT
  7606     ELSE
  7607     IF CARR-ACCNT-CNTL
  7608         MOVE GX-AM-CARRIER (GX-SUB)   TO  ERPNDB-CARR
  7609         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  ERPNDB-ACCT
  7610     ELSE
  7611     IF ACCNT-CNTL
  7612         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  ERPNDB-ACCT
  7613     ELSE
  7614         MOVE GX-AM-STATE   (GX-SUB)   TO  ERPNDB-STATE
  7615         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  ERPNDB-ACCT.
  7616
  7617     MOVE GX-AM-EFF-DT (GX-SUB)  TO  ERPNDB-EFF-DT.
  7618
  7619
  7620* EXEC CICS HANDLE CONDITION
  7621*        NOTFND  (4010-REC-NOT-FND)
  7622*    END-EXEC.
  7623*    MOVE '"$I                   ! & #00007450' TO DFHEIV0
  7624     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7625     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7626     MOVE X'2620233030303037343530' TO DFHEIV0(25:11)
  7627     CALL 'kxdfhei1' USING DFHEIV0
  7628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7629
  7630
  7631
  7632* EXEC CICS STARTBR
  7633*        DATASET  (ERPNDB-ALT-FILE-ID)
  7634*        RIDFLD   (ERPNDB-ALT-KEY)
  7635*        GTEQ
  7636*    END-EXEC.
  7637     MOVE 0
  7638       TO DFHEIV11
  7639*    MOVE '&,         G          &   #00007454' TO DFHEIV0
  7640     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7641     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7642     MOVE X'2020233030303037343534' TO DFHEIV0(25:11)
  7643     CALL 'kxdfhei1' USING DFHEIV0,
  7644           ERPNDB-ALT-FILE-ID,
  7645           ERPNDB-ALT-KEY,
  7646           DFHEIV99,
  7647           DFHEIV11,
  7648           DFHEIV99
  7649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL642.cbl
  7650
  7651
  7652     GO TO 4090-EXIT.
  7653
  7654 4010-REC-NOT-FND.
  7655     MOVE 'Y'                    TO  PNDB-EOF-SW.
  7656
  7657 4090-EXIT.
  7658     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL642.cbl
  7660 4100-PNDB-READ-NEXT.
  7661
  7662* EXEC CICS HANDLE CONDITION
  7663*        ENDFILE  (4110-END-OF-FILE)
  7664*    END-EXEC.
  7665*    MOVE '"$''                   ! '' #00007469' TO DFHEIV0
  7666     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7667     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7668     MOVE X'2720233030303037343639' TO DFHEIV0(25:11)
  7669     CALL 'kxdfhei1' USING DFHEIV0
  7670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7671
  7672
  7673
  7674* EXEC CICS READNEXT
  7675*        SET      (ADDRESS OF PENDING-BUSINESS)
  7676*        DATASET  (ERPNDB-ALT-FILE-ID)
  7677*        RIDFLD   (ERPNDB-ALT-KEY)
  7678*    END-EXEC.
  7679     MOVE 0
  7680       TO DFHEIV11
  7681*    MOVE '&.S                   )   #00007473' TO DFHEIV0
  7682     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7683     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7684     MOVE X'2020233030303037343733' TO DFHEIV0(25:11)
  7685     CALL 'kxdfhei1' USING DFHEIV0,
  7686           ERPNDB-ALT-FILE-ID,
  7687           DFHEIV20,
  7688           DFHEIV99,
  7689           ERPNDB-ALT-KEY,
  7690           DFHEIV99,
  7691           DFHEIV11,
  7692           DFHEIV99,
  7693           DFHEIV99
  7694     SET ADDRESS OF PENDING-BUSINESS TO
  7695         DFHEIV20
  7696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7697
  7698
  7699     GO TO 4150-EXIT.
  7700
  7701 4110-END-OF-FILE.
  7702     MOVE 'Y'                    TO  PNDB-EOF-SW.
  7703
  7704 4150-EXIT.
  7705     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL642.cbl
  7707 4160-PNDB-END-BROWSE.
  7708
  7709* EXEC CICS ENDBR
  7710*        DATASET  (ERPNDB-ALT-FILE-ID)
  7711*    END-EXEC.
  7712     MOVE 0
  7713       TO DFHEIV11
  7714*    MOVE '&2                    $   #00007488' TO DFHEIV0
  7715     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7716     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7717     MOVE X'2020233030303037343838' TO DFHEIV0(25:11)
  7718     CALL 'kxdfhei1' USING DFHEIV0,
  7719           ERPNDB-ALT-FILE-ID,
  7720           DFHEIV11,
  7721           DFHEIV99
  7722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7723
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL642.cbl
  7725 4200-PNDB-REWRITE.
  7726     MOVE PB-COMPANY-CD          TO  ERPNDB-CO-CD.
  7727     MOVE PB-ENTRY-BATCH         TO  ERPNDB-BATCH.
  7728     MOVE PB-BATCH-SEQ-NO        TO  ERPNDB-SEQ-NO.
  7729     MOVE PB-BATCH-CHG-SEQ-NO    TO  ERPNDB-CHG-SEQ-NO.
  7730
  7731     PERFORM 4160-PNDB-END-BROWSE
  7732
  7733
  7734* EXEC CICS READ
  7735*        SET      (ADDRESS OF PENDING-BUSINESS)
  7736*        DATASET  (ERPNDB-FILE-ID)
  7737*        RIDFLD   (ERPNDB-PRIME-KEY)
  7738*        UPDATE
  7739*    END-EXEC.
  7740*    MOVE '&"S        EU         (   #00007500' TO DFHEIV0
  7741     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7742     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7743     MOVE X'2020233030303037353030' TO DFHEIV0(25:11)
  7744     CALL 'kxdfhei1' USING DFHEIV0,
  7745           ERPNDB-FILE-ID,
  7746           DFHEIV20,
  7747           DFHEIV99,
  7748           ERPNDB-PRIME-KEY,
  7749           DFHEIV99,
  7750           DFHEIV99,
  7751           DFHEIV99
  7752     SET ADDRESS OF PENDING-BUSINESS TO
  7753         DFHEIV20
  7754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7755
  7756
  7757     MOVE 'B'                    TO  JP-RECORD-TYPE.
  7758     MOVE PENDING-BUSINESS       TO  JP-RECORD-AREA.
  7759     MOVE ERPNDB-FILE-ID         TO  JP-FILE-ID.
  7760
  7761     COMPUTE JOURNAL-LENGTH = ERPNDB-LENGTH + 23.
  7762
  7763     PERFORM 8400-LOG-JOURNAL-RECORD.
  7764
  7765     IF PI-VOID-BILL
  7766         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (WS-GA-LEVEL)
  7767     ELSE
  7768         MOVE WS-CURRENT-DATE    TO  PB-GA-BILL-DT (WS-GA-LEVEL).
  7769
  7770     MOVE PI-PROCESSOR-ID        TO  PB-LAST-MAINT-BY.
  7771     MOVE EIBTIME                TO  PB-LAST-MAINT-HHMMSS.
  7772     MOVE WS-CURRENT-DATE        TO  PB-LAST-MAINT-DT.
  7773     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7774     MOVE PENDING-BUSINESS       TO  JP-RECORD-AREA.
  7775     MOVE ERPNDB-FILE-ID         TO  JP-FILE-ID.
  7776
  7777     COMPUTE JOURNAL-LENGTH = ERPNDB-LENGTH + 23.
  7778
  7779
  7780* EXEC CICS REWRITE
  7781*        DATASET  (ERPNDB-FILE-ID)
  7782*        FROM     (PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL642.cbl
  7783*    END-EXEC.
  7784     MOVE LENGTH OF
  7785      PENDING-BUSINESS
  7786       TO DFHEIV11
  7787*    MOVE '&& L                  %   #00007529' TO DFHEIV0
  7788     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7789     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7790     MOVE X'2020233030303037353239' TO DFHEIV0(25:11)
  7791     CALL 'kxdfhei1' USING DFHEIV0,
  7792           ERPNDB-FILE-ID,
  7793           PENDING-BUSINESS,
  7794           DFHEIV11,
  7795           DFHEIV99
  7796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7797
  7798
  7799     PERFORM 8400-LOG-JOURNAL-RECORD.
  7800
  7801
  7802* EXEC CICS HANDLE CONDITION
  7803*        NOTFND  (4290-REC-NOT-FND)
  7804*    END-EXEC.
  7805*    MOVE '"$I                   ! ( #00007536' TO DFHEIV0
  7806     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7807     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7808     MOVE X'2820233030303037353336' TO DFHEIV0(25:11)
  7809     CALL 'kxdfhei1' USING DFHEIV0
  7810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7811
  7812
  7813
  7814* EXEC CICS STARTBR
  7815*        DATASET  (ERPNDB-ALT-FILE-ID)
  7816*        RIDFLD   (ERPNDB-ALT-KEY)
  7817*        GTEQ
  7818*    END-EXEC.
  7819     MOVE 0
  7820       TO DFHEIV11
  7821*    MOVE '&,         G          &   #00007540' TO DFHEIV0
  7822     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7823     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7824     MOVE X'2020233030303037353430' TO DFHEIV0(25:11)
  7825     CALL 'kxdfhei1' USING DFHEIV0,
  7826           ERPNDB-ALT-FILE-ID,
  7827           ERPNDB-ALT-KEY,
  7828           DFHEIV99,
  7829           DFHEIV11,
  7830           DFHEIV99
  7831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7832
  7833
  7834     PERFORM 4100-PNDB-READ-NEXT  THRU  4150-EXIT.
  7835
  7836     GO TO 4290-EXIT.
  7837
  7838 4290-REC-NOT-FND.
  7839     MOVE 'Y'                    TO  PYAJ-EOF-SW.
  7840
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL642.cbl
  7841 4290-EXIT.
  7842     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL642.cbl
  7844 4300-READ-ACCOUNT-MASTER.
  7845
  7846     MOVE SPACE                  TO  INVALID-ACCOUNT-SW.
  7847     MOVE PI-COMPANY-CD          TO  ERACCT-P-CO-CD.
  7848     MOVE PI-CR-CARRIER          TO  ERACCT-P-CARRIER.
  7849     MOVE PI-CR-GROUPING         TO  ERACCT-P-GROUPING.
  7850     MOVE PI-CR-STATE            TO  ERACCT-P-STATE.
  7851     MOVE PI-CR-ACCOUNT          TO  ERACCT-P-ACCOUNT.
  7852     MOVE PI-SAV-EXP-DT          TO  ERACCT-P-EXP-DATE.
  7853
  7854
  7855* EXEC CICS HANDLE CONDITION
  7856*        NOTFND  (4370-ACCOUNT-INVALID)
  7857*    END-EXEC.
  7858*    MOVE '"$I                   ! ) #00007566' TO DFHEIV0
  7859     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7860     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7861     MOVE X'2920233030303037353636' TO DFHEIV0(25:11)
  7862     CALL 'kxdfhei1' USING DFHEIV0
  7863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7864
  7865
  7866
  7867* EXEC CICS READ
  7868*        DATASET  (ERACCT-FILE-ID)
  7869*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7870*        RIDFLD   (ERACCT-PRIME-KEY)
  7871*        EQUAL
  7872*    END-EXEC.
  7873*    MOVE '&"S        E          (   #00007570' TO DFHEIV0
  7874     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7875     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7876     MOVE X'2020233030303037353730' TO DFHEIV0(25:11)
  7877     CALL 'kxdfhei1' USING DFHEIV0,
  7878           ERACCT-FILE-ID,
  7879           DFHEIV20,
  7880           DFHEIV99,
  7881           ERACCT-PRIME-KEY,
  7882           DFHEIV99,
  7883           DFHEIV99,
  7884           DFHEIV99
  7885     SET ADDRESS OF ACCOUNT-MASTER TO
  7886         DFHEIV20
  7887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7888
  7889
  7890     IF AM-REMIT-TO  NOT GREATER THAN  '00'
  7891         GO TO 4370-ACCOUNT-INVALID.
  7892
  7893     IF AM-AGT (AM-REMIT-TO)  =  SPACES
  7894         MOVE PI-CR-ACCOUNT      TO  PI-SAV-REMIT-TO
  7895     ELSE
  7896         MOVE AM-AGT (AM-REMIT-TO)
  7897                                 TO  PI-SAV-REMIT-TO.
  7898
  7899     MOVE AM-EXPIRATION-DT       TO  ERACCT-P-EXP-DATE.
  7900     MOVE AM-CARRIER             TO  PI-CR-CARRIER.
  7901     MOVE AM-GROUPING            TO  PI-CR-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL642.cbl
  7902     MOVE AM-STATE               TO  PI-CR-STATE.
  7903     MOVE AM-AGT (AM-REMIT-TO)   TO  PI-SAV-FIN-RESP
  7904                                     PI-COMP-FIN-RESP.
  7905
  7906     IF PI-ZERO-CARRIER
  7907       OR  PI-ZERO-CAR-GROUP
  7908         MOVE ZEROS              TO  PI-COMP-CARRIER
  7909     ELSE
  7910         MOVE AM-CARRIER         TO  PI-COMP-CARRIER.
  7911
  7912     IF PI-ZERO-GROUPING
  7913        OR  PI-ZERO-CAR-GROUP
  7914         MOVE ZEROS              TO  PI-COMP-GROUPING
  7915     ELSE
  7916         MOVE AM-GROUPING        TO  PI-COMP-GROUPING.
  7917
  7918     IF CARR-GROUP-ST-ACCNT-CNTL
  7919         MOVE SPACE              TO  NEW-ACCOUNT-SW.
  7920
  7921     MOVE +0                     TO  ACCOM-SUB.
  7922
  7923 4320-FIND-ACCT-RESPONSIBILITY.
  7924     ADD +1                      TO  ACCOM-SUB.
  7925
  7926     IF ACCOM-SUB  GREATER THAN  +10
  7927         MOVE  AM-ACCOUNT        TO  GA-ACCT
  7928         GO TO 4330-FIND-GA-COMMISSION.
  7929
  7930     IF AM-COM-TYP (ACCOM-SUB) = 'C' OR 'D' OR 'F' OR 'S'
  7931         NEXT SENTENCE
  7932     ELSE
  7933         GO TO 4320-FIND-ACCT-RESPONSIBILITY.
  7934
  7935     IF AM-AGT (ACCOM-SUB)  NOT =  PI-SAV-ACCT-AGT
  7936         MOVE 'Y'                TO  NEW-ACCOUNT-SW.
  7937
  7938     MOVE AM-AGT (ACCOM-SUB)     TO  PI-SAV-ACCT-AGT.
  7939     MOVE AM-NAME                TO  PI-SAV-ACCT-NAME.
  7940
  7941 4330-FIND-GA-COMMISSION.
  7942     MOVE ZEROS                  TO  WS-GA-LEVEL
  7943                                     WS-GA-LF-COM
  7944                                     WS-GA-AH-COM.
  7945     MOVE +0                     TO  ACCOM-SUB.
  7946
  7947 4340-SEARCH-FOR-GA-COMMISSION.
  7948     ADD +1                      TO  ACCOM-SUB.
  7949
  7950     IF ACCOM-SUB  GREATER THAN  +10
  7951         GO TO 4370-ACCOUNT-INVALID.
  7952
  7953     IF AM-COM-TYP (ACCOM-SUB) = 'O' OR 'P' OR 'G' OR 'B' OR 'K'
  7954        CONTINUE
  7955     ELSE
  7956        GO TO 4340-SEARCH-FOR-GA-COMMISSION
  7957     END-IF
  7958
  7959     IF AM-AGT (ACCOM-SUB)  NOT =  PI-SAV-AGENT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL642.cbl
  7960         GO TO 4340-SEARCH-FOR-GA-COMMISSION.
  7961
  7962     MOVE ACCOM-SUB              TO  WS-GA-LEVEL.
  7963
  7964     GO TO 4390-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL642.cbl
  7966 4370-ACCOUNT-INVALID.
  7967     MOVE 'Y'                    TO  INVALID-ACCOUNT-SW.
  7968     MOVE ER-2210                TO  EMI-ERROR.
  7969
  7970     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7971
  7972     GO TO 4390-EXIT.
  7973
  7974 4390-EXIT.
  7975     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL642.cbl
  7977 4400-FIND-COMMISSION.
  7978******************************************************************
  7979*    IF THE AGENT'S COMMISSION IS NUMERIC FOR A&H AND LIFE       *
  7980*    IN THE ACCOUNT MASTER THAT IS THE COMMISSION.  IF THE       *
  7981*    COMMISSION IN THE A&H AND LIFE CONTAINS A TABLE CODE        *
  7982*    READ THE COMMISSION-TABLE TO GET THE COMMISSION RATE.       *
  7983*    FOR CLIENT "DMD" THE ABOVE COMMISSION MAY BE OVERWRITTEN    *
  7984*    IF AN ACCOUNT RESIDENT STATE COMMISSION RECORD EXISTS.      *
  7985******************************************************************
  7986
  7987     MOVE PI-COMPANY-CD          TO  ERCTBL-COMPANY-CD.
  7988
  7989 4405-FIND-AH-COMMISSION.
  7990* SET UP COMMISSION TABLE KEY BEFORE DETERMINING COMMISSION
  7991     IF PB-ISSUE
  7992         MOVE PB-I-AH-BENEFIT-CD  TO  ERCTBL-BEN-CODE
  7993     ELSE
  7994         MOVE PB-CI-AH-BENEFIT-CD TO  ERCTBL-BEN-CODE.
  7995
  7996     MOVE 'A'                     TO  ERCTBL-BEN-TYPE.
  7997
  7998     MOVE 'AH'                   TO WS-COMM-SW.
  7999
  8000     IF AM-A-COM (WS-GA-LEVEL)  NUMERIC
  8001         MOVE AM-A-COM (WS-GA-LEVEL)
  8002                                 TO  WS-COMMISSION
  8003         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  8004         MOVE WS-COMMISSION      TO  WS-GA-AH-COM
  8005         GO TO 4410-FIND-LIFE-COMMISSION.
  8006
  8007     IF ERCTBL-BEN-CODE  =  ZEROS
  8008         MOVE ZEROS              TO  WS-GA-LF-COM
  8009         GO TO 4410-FIND-LIFE-COMMISSION.
  8010
  8011     MOVE ZEROS                  TO WS-SUB1.
  8012     PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT.
  8013     IF WS-SUB1 IS GREATER THAN ZEROS
  8014         GO TO 4410-FIND-LIFE-COMMISSION.
  8015
  8016     MOVE 'A'                     TO  ERCTBL-BEN-TYPE.
  8017
  8018     MOVE AM-A-COMA (WS-GA-LEVEL) TO ERCTBL-TABLE.
  8019     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8020
  8021     IF ERCTBL-NOT-FOUND
  8022         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8023         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8024         IF ERCTBL-NOT-FOUND
  8025             MOVE -1             TO  AAGENTL
  8026             MOVE ER-2916        TO  EMI-ERROR
  8027             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8028             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8029             GO TO 8200-SEND-DATAONLY.
  8030
  8031     PERFORM 6680-AH-GET-COMP-RATE.
  8032
  8033 4410-FIND-LIFE-COMMISSION.
  8034     IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL642.cbl
  8035         MOVE PB-CI-LF-BENEFIT-CD  TO CLBENF-CD
  8036     ELSE
  8037         MOVE PB-I-LF-BENEFIT-CD   TO CLBENF-CD.
  8038
  8039     MOVE 'LF'                   TO WS-COMM-SW.
  8040
  8041     IF CLBENF-CD  =  ZEROS  OR  SPACES
  8042         MOVE ZEROS              TO  WS-GA-LF-COM
  8043         GO TO 4490-EXIT.
  8044
  8045     IF PB-ISSUE
  8046         MOVE PB-I-LIFE-INDICATOR TO LIFE-INDICATOR
  8047         GO TO 4420-CONT-FIND-LIFE-COMMISSION.
  8048
  8049     PERFORM 6800-READ-BENEFIT-MASTER  THRU  6890-EXIT.
  8050
  8051     IF BENEFIT-MASTER-FOUND
  8052         NEXT SENTENCE
  8053     ELSE
  8054         MOVE -1                 TO  AAGENTL
  8055         MOVE ER-2917            TO  EMI-ERROR
  8056         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8057         PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8058         GO TO 8200-SEND-DATAONLY.
  8059
  8060 4420-CONT-FIND-LIFE-COMMISSION.
  8061* SET UP COMMISSION TABLE KEY BEFORE DETERMINING COMMISSION
  8062
  8063     IF PB-ISSUE
  8064         MOVE PB-I-LF-BENEFIT-CD  TO  ERCTBL-BEN-CODE
  8065     ELSE
  8066         MOVE PB-CI-LF-BENEFIT-CD TO  ERCTBL-BEN-CODE.
  8067
  8068     MOVE 'L'                     TO  ERCTBL-BEN-TYPE.
  8069
  8070     IF JOINT-LIFE
  8071         NEXT SENTENCE
  8072     ELSE
  8073         GO TO 4430-SINGLE-LIFE-COMMISSION.
  8074
  8075     IF AM-J-COM (WS-GA-LEVEL)  NUMERIC
  8076         MOVE AM-J-COM (WS-GA-LEVEL)
  8077                                 TO  WS-COMMISSION
  8078         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  8079         MOVE WS-COMMISSION      TO  WS-GA-LF-COM
  8080         GO TO 4490-EXIT.
  8081
  8082     MOVE ZEROS                  TO WS-SUB1.
  8083     PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT.
  8084     IF WS-SUB1 IS GREATER THAN ZEROS
  8085         GO TO 4490-EXIT.
  8086
  8087     MOVE AM-J-COMA (WS-GA-LEVEL) TO ERCTBL-TABLE.
  8088
  8089     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8090
  8091     IF ERCTBL-NOT-FOUND
  8092         MOVE 'AA'               TO  ERCTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL642.cbl
  8093         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8094         IF ERCTBL-NOT-FOUND
  8095             MOVE -1             TO  AAGENTL
  8096             MOVE ER-2916        TO  EMI-ERROR
  8097             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8098             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8099             GO TO 8200-SEND-DATAONLY.
  8100
  8101     PERFORM 6680-LF-GET-COMP-RATE.
  8102     GO TO 4490-EXIT.
  8103
  8104 4430-SINGLE-LIFE-COMMISSION.
  8105* SET UP COMMISSION TABLE KEY BEFORE DETERMINING COMMISSION
  8106
  8107     IF PB-ISSUE
  8108         MOVE PB-I-LF-BENEFIT-CD  TO  ERCTBL-BEN-CODE
  8109     ELSE
  8110         MOVE PB-CI-LF-BENEFIT-CD TO  ERCTBL-BEN-CODE.
  8111
  8112     MOVE 'L'                     TO  ERCTBL-BEN-TYPE.
  8113*
  8114     IF AM-L-COM (WS-GA-LEVEL)  NUMERIC
  8115         MOVE AM-L-COM (WS-GA-LEVEL)
  8116                                 TO  WS-COMMISSION
  8117         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  8118         MOVE WS-COMMISSION      TO  WS-GA-LF-COM
  8119         GO TO 4490-EXIT.
  8120
  8121     MOVE ZEROS                  TO WS-SUB1.
  8122     PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT.
  8123     IF WS-SUB1 IS GREATER THAN ZEROS
  8124         GO TO 4490-EXIT.
  8125
  8126     MOVE ZEROS                  TO WS-SUB1.
  8127     MOVE AM-L-COMA (WS-GA-LEVEL) TO ERCTBL-TABLE
  8128
  8129     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8130
  8131     IF ERCTBL-NOT-FOUND
  8132         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8133         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8134         IF ERCTBL-NOT-FOUND
  8135             MOVE -1             TO  AAGENTL
  8136             MOVE ER-2916        TO  EMI-ERROR
  8137             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8138             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8139             GO TO 8200-SEND-DATAONLY.
  8140
  8141     PERFORM 6680-LF-GET-COMP-RATE.
  8142     GO TO 4490-EXIT.
  8143
  8144 4490-EXIT.
  8145     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL642.cbl
  8147 4500-PYAJ-START-BROWSE.
  8148     MOVE LOW-VALUES             TO  ERPYAJ-KEY.
  8149     MOVE PI-COMPANY-CD          TO  ERPYAJ-COMP-CD.
  8150
  8151     IF GENERAL-AGENT
  8152         MOVE PI-SAV-CARR        TO  ERPYAJ-CARRIER
  8153         MOVE PI-SAV-GROUP       TO  ERPYAJ-GROUPING
  8154         MOVE PI-SAV-AGENT       TO  ERPYAJ-FIN-RESP
  8155         MOVE LOW-VALUES         TO  ERPYAJ-ACCOUNT
  8156     ELSE
  8157         MOVE PI-COMP-CARRIER    TO  ERPYAJ-CARRIER
  8158         MOVE PI-COMP-GROUPING   TO  ERPYAJ-GROUPING
  8159         MOVE PI-COMP-FIN-RESP   TO  ERPYAJ-FIN-RESP
  8160         MOVE PI-CR-ACCOUNT      TO  ERPYAJ-ACCOUNT.
  8161
  8162     MOVE ERPYAJ-KEY             TO  ERPYAJ-BROWSE-COMP-KEY.
  8163
  8164
  8165* EXEC CICS HANDLE CONDITION
  8166*        NOTFND  (4510-REC-NOT-FND)
  8167*    END-EXEC.
  8168*    MOVE '"$I                   ! * #00007851' TO DFHEIV0
  8169     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8170     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8171     MOVE X'2A20233030303037383531' TO DFHEIV0(25:11)
  8172     CALL 'kxdfhei1' USING DFHEIV0
  8173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8174
  8175
  8176
  8177* EXEC CICS STARTBR
  8178*        DATASET  (ERPYAJ-FILE-ID)
  8179*        RIDFLD   (ERPYAJ-KEY)
  8180*        GTEQ
  8181*    END-EXEC.
  8182     MOVE 0
  8183       TO DFHEIV11
  8184*    MOVE '&,         G          &   #00007855' TO DFHEIV0
  8185     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8186     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8187     MOVE X'2020233030303037383535' TO DFHEIV0(25:11)
  8188     CALL 'kxdfhei1' USING DFHEIV0,
  8189           ERPYAJ-FILE-ID,
  8190           ERPYAJ-KEY,
  8191           DFHEIV99,
  8192           DFHEIV11,
  8193           DFHEIV99
  8194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8195
  8196
  8197     GO TO 4590-EXIT.
  8198
  8199 4510-REC-NOT-FND.
  8200     MOVE 'Y'                    TO  PYAJ-EOF-SW.
  8201
  8202 4590-EXIT.
  8203     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL642.cbl
  8205 4600-PYAJ-READ-NEXT.
  8206
  8207* EXEC CICS HANDLE CONDITION
  8208*        ENDFILE  (4610-END-OF-FILE)
  8209*    END-EXEC.
  8210*    MOVE '"$''                   ! + #00007870' TO DFHEIV0
  8211     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8212     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8213     MOVE X'2B20233030303037383730' TO DFHEIV0(25:11)
  8214     CALL 'kxdfhei1' USING DFHEIV0
  8215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8216
  8217
  8218
  8219* EXEC CICS READNEXT
  8220*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  8221*        DATASET  (ERPYAJ-FILE-ID)
  8222*        RIDFLD   (ERPYAJ-KEY)
  8223*    END-EXEC.
  8224     MOVE 0
  8225       TO DFHEIV11
  8226*    MOVE '&.S                   )   #00007874' TO DFHEIV0
  8227     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8228     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8229     MOVE X'2020233030303037383734' TO DFHEIV0(25:11)
  8230     CALL 'kxdfhei1' USING DFHEIV0,
  8231           ERPYAJ-FILE-ID,
  8232           DFHEIV20,
  8233           DFHEIV99,
  8234           ERPYAJ-KEY,
  8235           DFHEIV99,
  8236           DFHEIV11,
  8237           DFHEIV99,
  8238           DFHEIV99
  8239     SET ADDRESS OF PENDING-PAY-ADJ TO
  8240         DFHEIV20
  8241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8242
  8243
  8244     GO TO 4690-EXIT.
  8245
  8246 4610-END-OF-FILE.
  8247     MOVE 'Y'                    TO  PYAJ-EOF-SW.
  8248
  8249 4690-EXIT.
  8250     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL642.cbl
  8252 4700-PROCESS-COMM-EXCEPTION.
  8253     PERFORM 6600-READ-COMMISSION-EXCEPTION  THRU  6620-EXIT.
  8254
  8255     IF ERCOMM-NOT-FOUND
  8256         MOVE -1                 TO  AAGENTL
  8257         MOVE ER-2915            TO  EMI-ERROR
  8258         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8259         PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8260         GO TO 8200-SEND-DATAONLY.
  8261
  8262     MOVE WS-GA-LEVEL            TO  CE-SUB.
  8263     MOVE PI-COMPANY-CD          TO  ERCTBL-COMPANY-CD.
  8264
  8265     IF CE-LF-COMP (CE-SUB)  NUMERIC
  8266         IF CE-AH-COMP (CE-SUB)  NUMERIC
  8267             MOVE CE-LF-COMP (CE-SUB)  TO  WS-GA-LF-COM
  8268             MOVE CE-AH-COMP (CE-SUB)  TO  WS-GA-AH-COM
  8269             GO TO 4790-EXIT.
  8270
  8271 4715-FIND-AH-COMMISSION.
  8272     IF CE-AH-COMP (CE-SUB)  NUMERIC
  8273         MOVE CE-AH-COMP (CE-SUB)  TO  WS-GA-AH-COM
  8274         GO TO 4750-FIND-LIFE-COMMISSION.
  8275
  8276     MOVE CE-AH-COMPT (CE-SUB)   TO  ERCTBL-TABLE.
  8277
  8278     IF PB-ISSUE
  8279         MOVE PB-I-AH-BENEFIT-CD   TO  ERCTBL-BEN-CODE
  8280     ELSE
  8281         MOVE PB-CI-AH-BENEFIT-CD  TO  ERCTBL-BEN-CODE.
  8282
  8283     IF ERCTBL-BEN-CODE  =  ZEROS
  8284         MOVE ZEROS              TO  WS-GA-AH-COM
  8285         GO TO 4750-FIND-LIFE-COMMISSION.
  8286
  8287     MOVE 'A'                    TO  ERCTBL-BEN-TYPE.
  8288
  8289     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8290
  8291     IF ERCTBL-NOT-FOUND
  8292         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8293         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8294         IF ERCTBL-NOT-FOUND
  8295             MOVE -1             TO  AAGENTL
  8296             MOVE ER-2916        TO  EMI-ERROR
  8297             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8298             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8299             GO TO 8200-SEND-DATAONLY.
  8300
  8301     IF PB-ISSUE
  8302         COMPUTE WS-COMM-CK-AMT =
  8303             PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8304         MOVE PB-I-AGE           TO  WS-COMM-AGE
  8305         MOVE PB-I-AH-TERM       TO  WS-COMM-TERM
  8306     ELSE
  8307         COMPUTE WS-COMM-CK-AMT =
  8308             PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8309         MOVE PB-CI-INSURED-AGE  TO  WS-COMM-AGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL642.cbl
  8310         MOVE PB-CI-AH-TERM      TO  WS-COMM-TERM.
  8311
  8312     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  8313
  8314     MOVE WS-WK-RATE             TO  WS-GA-AH-COM.
  8315
  8316 4750-FIND-LIFE-COMMISSION.
  8317     IF PB-ISSUE
  8318         MOVE PB-I-LF-BENEFIT-CD   TO  CLBENF-CD
  8319     ELSE
  8320         MOVE PB-CI-LF-BENEFIT-CD  TO  CLBENF-CD.
  8321
  8322     IF CLBENF-CD  =  ZEROS  OR  SPACES
  8323         MOVE ZEROS              TO  WS-GA-LF-COM
  8324         GO TO 4790-EXIT.
  8325
  8326     IF PB-ISSUE
  8327         MOVE PB-I-LIFE-INDICATOR  TO  LIFE-INDICATOR
  8328         GO TO 4760-CONT-FIND-LIFE-COMMISSION.
  8329
  8330     PERFORM 6800-READ-BENEFIT-MASTER  THRU  6890-EXIT.
  8331
  8332     IF BENEFIT-MASTER-FOUND
  8333         NEXT SENTENCE
  8334     ELSE
  8335         MOVE -1                 TO  AAGENTL
  8336         MOVE ER-2917            TO  EMI-ERROR
  8337         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8338         PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8339         GO TO 8200-SEND-DATAONLY.
  8340
  8341 4760-CONT-FIND-LIFE-COMMISSION.
  8342     IF JOINT-LIFE NEXT SENTENCE
  8343     ELSE
  8344         GO TO 4770-SINGLE-LIFE-COMMISSION.
  8345
  8346     IF CE-LF-COMP (CE-SUB)  NUMERIC
  8347         MOVE CE-LF-COMP (CE-SUB)  TO  WS-GA-LF-COM
  8348         GO TO 4790-EXIT.
  8349
  8350     MOVE CE-LF-COMPT (CE-SUB)   TO  ERCTBL-TABLE.
  8351
  8352     IF PB-ISSUE
  8353         MOVE PB-I-LF-BENEFIT-CD   TO  ERCTBL-BEN-CODE
  8354     ELSE
  8355         MOVE PB-CI-LF-BENEFIT-CD  TO  ERCTBL-BEN-CODE.
  8356
  8357     MOVE 'J'                    TO  ERCTBL-BEN-TYPE.
  8358
  8359     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8360
  8361     IF ERCTBL-NOT-FOUND
  8362         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8363         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8364         IF ERCTBL-NOT-FOUND
  8365             MOVE -1             TO  AAGENTL
  8366             MOVE ER-2916        TO  EMI-ERROR
  8367             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL642.cbl
  8368             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8369             GO TO 8200-SEND-DATAONLY.
  8370
  8371     IF PB-ISSUE
  8372         MOVE PB-I-LF-BENEFIT-AMT   TO  WS-COMM-CK-AMT
  8373         MOVE PB-I-AGE              TO  WS-COMM-AGE
  8374         MOVE PB-I-LF-TERM          TO  WS-COMM-TERM
  8375     ELSE
  8376         MOVE PB-CI-INSURED-AGE     TO  WS-COMM-AGE
  8377         MOVE PB-CI-LF-TERM         TO  WS-COMM-TERM
  8378         MOVE PB-CI-LF-BENEFIT-AMT  TO  WS-COMM-CK-AMT.
  8379
  8380     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  8381
  8382     MOVE WS-WK-RATE             TO  WS-GA-LF-COM.
  8383
  8384     GO TO 4790-EXIT.
  8385
  8386 4770-SINGLE-LIFE-COMMISSION.
  8387     IF CE-LF-COMP (CE-SUB)  NUMERIC
  8388         MOVE CE-LF-COMP (CE-SUB)  TO  WS-GA-LF-COM
  8389         GO TO 4790-EXIT.
  8390
  8391     MOVE CE-LF-COMPT (CE-SUB)   TO  ERCTBL-TABLE.
  8392
  8393     IF PB-ISSUE
  8394         MOVE PB-I-LF-BENEFIT-CD   TO  ERCTBL-BEN-CODE
  8395     ELSE
  8396         MOVE PB-CI-LF-BENEFIT-CD  TO  ERCTBL-BEN-CODE.
  8397
  8398     MOVE 'L'                    TO  ERCTBL-BEN-TYPE.
  8399
  8400     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8401
  8402     IF ERCTBL-NOT-FOUND
  8403         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8404         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8405         IF ERCTBL-NOT-FOUND
  8406             MOVE -1             TO  AAGENTL
  8407             MOVE ER-2916        TO  EMI-ERROR
  8408             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8409             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8410             GO TO 8200-SEND-DATAONLY.
  8411
  8412     IF PB-ISSUE
  8413         MOVE PB-I-LF-BENEFIT-AMT   TO  WS-COMM-CK-AMT
  8414         MOVE PB-I-AGE              TO  WS-COMM-AGE
  8415         MOVE PB-I-LF-TERM          TO  WS-COMM-TERM
  8416     ELSE
  8417         MOVE PB-CI-INSURED-AGE     TO  WS-COMM-AGE
  8418         MOVE PB-CI-LF-TERM         TO  WS-COMM-TERM
  8419         MOVE PB-CI-LF-BENEFIT-AMT  TO  WS-COMM-CK-AMT.
  8420
  8421     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  8422
  8423     MOVE WS-WK-RATE             TO  WS-GA-LF-COM.
  8424
  8425 4790-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL642.cbl
  8426     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL642.cbl
  8428 4800-PYAJ-END-BROWSE.
  8429
  8430* EXEC CICS ENDBR
  8431*        DATASET  (ERPYAJ-FILE-ID)
  8432*    END-EXEC.
  8433     MOVE 0
  8434       TO DFHEIV11
  8435*    MOVE '&2                    $   #00008065' TO DFHEIV0
  8436     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8437     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8438     MOVE X'2020233030303038303635' TO DFHEIV0(25:11)
  8439     CALL 'kxdfhei1' USING DFHEIV0,
  8440           ERPYAJ-FILE-ID,
  8441           DFHEIV11,
  8442           DFHEIV99
  8443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8444
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL642.cbl
  8446 4900-GET-COMP-RATE.
  8447     MOVE +1                     TO  COMP-SUB.
  8448
  8449     IF WS-COMM-CK-AMT  GREATER THAN  CT-TBF (1)
  8450         ADD +9                  TO  COMP-SUB
  8451         IF WS-COMM-CK-AMT  GREATER THAN  CT-TBF (2)
  8452             ADD +9              TO  COMP-SUB
  8453             IF WS-COMM-CK-AMT  GREATER THAN  CT-TBF (3)
  8454                 MOVE -1         TO  AAGENTL
  8455                 MOVE ER-2918    TO  EMI-ERROR
  8456                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8457                 PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8458                 GO TO 8200-SEND-DATAONLY.
  8459
  8460     IF WS-COMM-AGE  GREATER THAN  CT-AGE (1)
  8461         ADD +3                  TO  COMP-SUB
  8462         IF WS-COMM-AGE  GREATER THAN  CT-AGE (2)
  8463             ADD +1              TO  COMP-SUB
  8464             IF WS-COMM-AGE  GREATER THAN  CT-AGE (3)
  8465                 MOVE -1         TO  AAGENTL
  8466                 MOVE ER-2918    TO  EMI-ERROR
  8467                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8468                 PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8469                 GO TO 8200-SEND-DATAONLY.
  8470
  8471     IF WS-COMM-TERM  GREATER  CT-TRM (1)
  8472         ADD +1                  TO  COMP-SUB
  8473         IF WS-COMM-TERM  GREATER THAN  CT-TRM (2)
  8474             ADD +1              TO  COMP-SUB
  8475             IF WS-COMM-TERM  GREATER THAN  CT-TRM (3)
  8476                 MOVE -1         TO  AAGENTL
  8477                 MOVE ER-2918    TO  EMI-ERROR
  8478                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8479                 PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8480                 GO TO 8200-SEND-DATAONLY.
  8481
  8482     IF CT-RT (COMP-SUB)  NOT  NUMERIC
  8483         MOVE CT-RT-R (COMP-SUB)  TO  ERCTBL-TABLE
  8484         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8485         GO TO 4900-GET-COMP-RATE.
  8486
  8487     MOVE CT-RT (COMP-SUB)       TO  WS-WK-RATE.
  8488
  8489 4990-EXIT.
  8490     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL642.cbl
  8492 5000-FORMAT-SCREEN.
  8493     MOVE LOW-VALUES             TO  EL642AO.
  8494
  8495     IF PI-SAV-AGENT  GREATER THAN  SPACES
  8496         MOVE PI-SAV-AGENT       TO  AAGENTO
  8497         MOVE PI-SAV-CARR        TO  ACARIERO
  8498         MOVE PI-SAV-GROUP       TO  AGROUPO.
  8499
  8500     MOVE PI-BILL-TYPE           TO  ABILTYPI.
  8501     MOVE AL-UANON               TO  AAGENTA
  8502                                     ACARIERA
  8503                                     AGROUPA
  8504                                     ABILTYPA.
  8505
  8506     IF PI-BILLING-ACCOUNTS (1)  NOT =  SPACES
  8507         MOVE PI-BILLING-ACCOUNTS (1)
  8508                                 TO  AACCT1I
  8509         MOVE AL-UANON           TO  AACCT1A.
  8510
  8511     IF PI-BILLING-ACCOUNTS (2)  NOT =  SPACES
  8512         MOVE PI-BILLING-ACCOUNTS (2)
  8513                                 TO  AACCT2I
  8514         MOVE AL-UANON           TO  AACCT2A.
  8515
  8516     IF PI-BILLING-ACCOUNTS (3)  NOT =  SPACES
  8517         MOVE PI-BILLING-ACCOUNTS (3)
  8518                                 TO  AACCT3I
  8519         MOVE AL-UANON           TO  AACCT3A.
  8520
  8521 5005-FORMAT-STATS.
  8522
  8523     IF PI-CR-FIN-RESP = SPACES
  8524         GO TO 5090-EXIT.
  8525
  8526     MOVE PI-BAL-FRWD            TO  ABEGBALO.
  8527     MOVE PI-UNPAID-NET-PREM     TO  AUPDPRMO.
  8528     MOVE PI-COMP-UNPAID-PREM    TO  AUPDCOMO.
  8529     MOVE PI-ISSUES-BILLED       TO  ABILL1O.
  8530     MOVE PI-ISSUES-INER         TO  AINER1O.
  8531     MOVE PI-ISSUES-PREV         TO  APRVBL1O.
  8532     MOVE PI-CANCELS-BILLED      TO  ABILL2O.
  8533     MOVE PI-CANCELS-INER        TO  AINER2O.
  8534     MOVE PI-CANCELS-PREV        TO  APRVBL2O.
  8535
  8536
  8537     IF PI-UNKNOWN  GREATER THAN  ZEROS
  8538         MOVE ER-2912            TO  EMI-ERROR
  8539         MOVE PI-UNKNOWN         TO  AUNKNERO
  8540         MOVE AL-SABOF           TO  AUNKNERA
  8541         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8542
  8543     MOVE PI-PREMIUM             TO  APREMUMO.
  8544     MOVE PI-REMITTED            TO  AREMITO.
  8545     MOVE PI-TOT-ISS-COMP        TO  ACOMPISO.
  8546     MOVE PI-TOT-CAN-COMP        TO  ACOMCANO.
  8547     MOVE PI-ADJUSTMNTS          TO  AADJUSTO.
  8548     MOVE PI-DISBURSED           TO  ADISBURO.
  8549     MOVE ZERO                   TO  PI-END-BAL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL642.cbl
  8550
  8551     IF PI-SAV-AGENT = PI-SAV-REMIT-TO
  8552         COMPUTE PI-DUE-FOR-ACCT =
  8553             (PI-ACCT-BEG-BAL + PI-ACCT-NET-PREM) -
  8554              (PI-ACCT-COMP + PI-ACCT-PAY-ADJS).
  8555
  8556     COMPUTE PI-END-BAL = PI-BAL-FRWD - PI-TOT-ISS-COMP
  8557                        + PI-TOT-CAN-COMP + PI-ADJUSTMNTS
  8558                        - PI-REMITTED + PI-DISBURSED.
  8559
  8560     MOVE PI-END-BAL             TO  ANETDUEO.
  8561
  8562     IF PI-END-BAL  NEGATIVE
  8563         MOVE OWED-TO-AGENT      TO  AENDHDGO
  8564     ELSE
  8565         IF PI-END-BAL  GREATER THAN  ZERO
  8566             MOVE AGENT-OWES     TO  AENDHDGO
  8567         ELSE
  8568             MOVE 'BALANCE='     TO  AENDHDGO.
  8569
  8570     IF PI-SAV-AGENT = PI-SAV-REMIT-TO
  8571         IF PI-DUE-FOR-ACCT  NOT =  ZERO
  8572             MOVE PI-DUE-FOR-ACCT
  8573                                 TO  AACTDUEO
  8574             IF PI-DUE-FOR-ACCT  NEGATIVE
  8575                 MOVE 'DUE GA ON BEHALF OF ACCOUNTS'
  8576                                 TO  AACTHDGO
  8577             ELSE
  8578                 MOVE 'GA OWES ON BEHALF OF ACCOUNTS'
  8579                                 TO  AACTHDGO.
  8580
  8581 5080-CONT.
  8582     IF RETURNED-FROM  NOT =  SPACES
  8583         IF RETURNED-FROM  NOT =  XCTL-6401
  8584             MOVE ER-2421        TO  EMI-ERROR
  8585             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8586             MOVE ZEROS          TO  EMI-ERROR.
  8587
  8588 5090-EXIT.
  8589     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL642.cbl
  8591 6000-READ-COMP-MASTER.
  8592
  8593* EXEC CICS HANDLE CONDITION
  8594*        NOTFND  (6070-NO-COMP-MSTR)
  8595*    END-EXEC.
  8596*    MOVE '"$I                   ! , #00008215' TO DFHEIV0
  8597     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8599     MOVE X'2C20233030303038323135' TO DFHEIV0(25:11)
  8600     CALL 'kxdfhei1' USING DFHEIV0
  8601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8602
  8603
  8604     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  8605
  8606     IF GENERAL-AGENT
  8607         MOVE PI-SAV-CARR        TO  ERCOMP-CARRIER
  8608         MOVE PI-SAV-GROUP       TO  ERCOMP-GROUPING
  8609         MOVE PI-SAV-AGENT       TO  ERCOMP-FIN-RESP
  8610     ELSE
  8611         MOVE PI-COMP-CARRIER    TO  ERCOMP-CARRIER
  8612         MOVE PI-COMP-GROUPING   TO  ERCOMP-GROUPING
  8613         MOVE PI-COMP-FIN-RESP   TO  ERCOMP-FIN-RESP.
  8614
  8615     MOVE ERCOMP-FIN-RESP        TO  PI-CR-FIN-RESP.
  8616
  8617     IF EIBAID  =  DFHPF5  OR  GENERAL-AGENT
  8618         MOVE LOW-VALUES         TO  ERCOMP-ACCT
  8619         MOVE 'G'                TO  ERCOMP-RECORD-TYPE
  8620     ELSE
  8621         MOVE PI-SAV-ACCT-AGT    TO  ERCOMP-ACCT
  8622         MOVE 'A'                TO  ERCOMP-RECORD-TYPE.
  8623
  8624     IF ERCOMP-KEY  =  ERCOMP-PREV-KEY
  8625         GO TO 6090-EXIT.
  8626
  8627     MOVE ERCOMP-KEY             TO  ERCOMP-PREV-KEY.
  8628
  8629
  8630* EXEC CICS READ
  8631*        DATASET  (ERCOMP-FILE-ID)
  8632*        SET      (ADDRESS OF COMPENSATION-MASTER)
  8633*        RIDFLD   (ERCOMP-KEY)
  8634*        RESP     (WS-RESPONSE)
  8635*    END-EXEC.
  8636*    MOVE '&"S        E          (  N#00008244' TO DFHEIV0
  8637     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8638     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8639     MOVE X'204E233030303038323434' TO DFHEIV0(25:11)
  8640     CALL 'kxdfhei1' USING DFHEIV0,
  8641           ERCOMP-FILE-ID,
  8642           DFHEIV20,
  8643           DFHEIV99,
  8644           ERCOMP-KEY,
  8645           DFHEIV99,
  8646           DFHEIV99,
  8647           DFHEIV99
  8648     SET ADDRESS OF COMPENSATION-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL642.cbl
  8649         DFHEIV20
  8650     MOVE EIBRESP  TO WS-RESPONSE
  8651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8652
  8653
  8654     IF NOT RESP-NORMAL
  8655        IF ERCOMP-RECORD-TYPE = 'G'
  8656           MOVE 'B'              TO ERCOMP-RECORD-TYPE
  8657
  8658* EXEC CICS READ
  8659*             DATASET (ERCOMP-FILE-ID)
  8660*             SET     (ADDRESS OF COMPENSATION-MASTER)
  8661*             RIDFLD  (ERCOMP-KEY)
  8662*          END-EXEC
  8663*    MOVE '&"S        E          (   #00008254' TO DFHEIV0
  8664     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8665     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8666     MOVE X'2020233030303038323534' TO DFHEIV0(25:11)
  8667     CALL 'kxdfhei1' USING DFHEIV0,
  8668           ERCOMP-FILE-ID,
  8669           DFHEIV20,
  8670           DFHEIV99,
  8671           ERCOMP-KEY,
  8672           DFHEIV99,
  8673           DFHEIV99,
  8674           DFHEIV99
  8675     SET ADDRESS OF COMPENSATION-MASTER TO
  8676         DFHEIV20
  8677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8678        END-IF
  8679     END-IF
  8680
  8681     IF PI-MAP-NAME  =  EL642B
  8682         GO TO 6090-EXIT.
  8683
  8684     IF GENERAL-AGENT
  8685         MOVE CO-CURRENT-END-BAL TO  PI-BAL-FRWD
  8686     ELSE
  8687         IF PI-SAV-AGENT  =  PI-SAV-REMIT-TO
  8688             MOVE CO-CURRENT-END-BAL
  8689                                 TO  WS-ACCT-BEG-BAL
  8690             GO TO 6090-EXIT
  8691         ELSE
  8692             MOVE ZEROS          TO  WS-ACCT-BEG-BAL
  8693             GO TO 6090-EXIT.
  8694
  8695     IF PI-UPDATE-FILES
  8696       OR  (PI-PREVIEW  AND  APRODSWI  =  'Y')
  8697         NEXT SENTENCE
  8698     ELSE
  8699         GO TO 6090-EXIT.
  8700
  8701 6002-FORMAT-ADDRESS-LOOP.
  8702     MOVE CO-ACCT-NAME           TO  PI-AGENT-NAME.
  8703     MOVE CO-MAIL-NAME           TO  WS-AGENT-LINES (1).
  8704     MOVE CO-ACCT-NAME           TO  WS-AGENT-LINES (2).
  8705     MOVE CO-ADDR-1              TO  WS-AGENT-LINES (3).
  8706     MOVE CO-ADDR-2              TO  WS-AGENT-LINES (4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL642.cbl
  8707     MOVE CO-ADDR-3              TO  WS-AGENT-LINES (5).
  8708     MOVE CO-ZIP                 TO  WS-AGENT-LINES (6).
  8709
  8710 6060-FORMAT-ADDRESS-LOOP.
  8711     IF WS-AGENT-ADDR-AREA  =  SPACES
  8712         GO TO 6090-EXIT.
  8713
  8714     IF WS-AGENT-LINES (1)  =  SPACES
  8715         MOVE WS-AGENT-LINES (2)  TO  WS-AGENT-LINES (1)
  8716         MOVE WS-AGENT-LINES (3)  TO  WS-AGENT-LINES (2)
  8717         MOVE WS-AGENT-LINES (4)  TO  WS-AGENT-LINES (3)
  8718         MOVE WS-AGENT-LINES (5)  TO  WS-AGENT-LINES (4)
  8719         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8720         MOVE SPACES              TO  WS-AGENT-LINES (6)
  8721         GO TO 6060-FORMAT-ADDRESS-LOOP.
  8722
  8723     IF WS-AGENT-LINES (2)  =  SPACES
  8724       AND  WS-AGENT-LINES (3)  =  SPACES
  8725       AND  WS-AGENT-LINES (4)  =  SPACES
  8726       AND  WS-AGENT-LINES (5)  =  SPACES
  8727       AND  WS-AGENT-LINES (6)  =  SPACES
  8728         GO TO 6065-MOVE-ZIP.
  8729
  8730     IF WS-AGENT-LINES (2)  =  SPACES
  8731         MOVE WS-AGENT-LINES (3)  TO  WS-AGENT-LINES (2)
  8732         MOVE WS-AGENT-LINES (4)  TO  WS-AGENT-LINES (3)
  8733         MOVE WS-AGENT-LINES (5)  TO  WS-AGENT-LINES (4)
  8734         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8735         MOVE SPACES              TO  WS-AGENT-LINES (6)
  8736         GO TO 6060-FORMAT-ADDRESS-LOOP.
  8737
  8738     IF WS-AGENT-LINES (3)  =  SPACES
  8739       AND  WS-AGENT-LINES (4)  =  SPACES
  8740       AND  WS-AGENT-LINES (5)  =  SPACES
  8741       AND  WS-AGENT-LINES (6)  =  SPACES
  8742         GO TO 6065-MOVE-ZIP.
  8743
  8744     IF WS-AGENT-LINES (3)  =  SPACES
  8745         MOVE WS-AGENT-LINES (4)  TO  WS-AGENT-LINES (3)
  8746         MOVE WS-AGENT-LINES (5)  TO  WS-AGENT-LINES (4)
  8747         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8748         MOVE SPACES              TO  WS-AGENT-LINES (6)
  8749         GO TO 6060-FORMAT-ADDRESS-LOOP.
  8750
  8751     IF WS-AGENT-LINES (4)  =  SPACES
  8752       AND  WS-AGENT-LINES (5)  =  SPACES
  8753       AND  WS-AGENT-LINES (6)  =  SPACES
  8754         GO TO 6065-MOVE-ZIP.
  8755
  8756     IF WS-AGENT-LINES (4)  =  SPACES
  8757         MOVE WS-AGENT-LINES (5)  TO  WS-AGENT-LINES (4)
  8758         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8759         MOVE SPACES              TO  WS-AGENT-LINES (6)
  8760         GO TO 6060-FORMAT-ADDRESS-LOOP.
  8761
  8762     IF WS-AGENT-LINES (5)  =  SPACES
  8763         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8764         MOVE SPACES              TO  WS-AGENT-LINES (6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL642.cbl
  8765
  8766 6065-MOVE-ZIP.
  8767
  8768     IF WS-AGENT-LINES (6) NOT =  SPACES
  8769         IF CO-CANADIAN-POST-CODE
  8770                 OR
  8771            WS-AGENT-1ST-ZIP (6)  NOT =  ZEROS
  8772             MOVE WS-AGENT-ZIP (6)
  8773                                 TO  WS-A-LAST-ZIP (5)
  8774             MOVE SPACES         TO  WS-AGENT-LINES (6)
  8775         ELSE
  8776             MOVE WS-AGENT-2ND-ZIP (5)
  8777                                 TO  WS-A-LAST-2ND-ZIP (4)
  8778             MOVE SPACES         TO  WS-AGENT-LINES (5)
  8779     ELSE
  8780         IF WS-AGENT-LINES (5) NOT =  SPACES
  8781             IF CO-CANADIAN-POST-CODE
  8782                     OR
  8783                WS-AGENT-1ST-ZIP (5)  NOT =  ZEROS
  8784                 MOVE WS-AGENT-ZIP (5)
  8785                                 TO  WS-A-LAST-ZIP (5)
  8786                 MOVE SPACES     TO  WS-AGENT-ZIP (5)
  8787             ELSE
  8788                 MOVE WS-AGENT-2ND-ZIP (5)
  8789                                 TO  WS-A-LAST-2ND-ZIP (5)
  8790                 MOVE SPACES     TO  WS-AGENT-ZIP (5)
  8791         ELSE
  8792             IF WS-AGENT-LINES (4) NOT =  SPACES
  8793                 IF CO-CANADIAN-POST-CODE
  8794                         OR
  8795                    WS-AGENT-1ST-ZIP (4)  NOT =  ZEROS
  8796                     MOVE WS-AGENT-ZIP (4)
  8797                                 TO  WS-A-LAST-ZIP (4)
  8798                     MOVE SPACES TO  WS-AGENT-ZIP (4)
  8799                 ELSE
  8800                     MOVE WS-AGENT-2ND-ZIP (4)
  8801                                 TO  WS-A-LAST-2ND-ZIP (4)
  8802                     MOVE SPACES TO  WS-AGENT-ZIP (4).
  8803
  8804     MOVE 'GA'                   TO  BILLING-DETAIL-TYPE.
  8805
  8806     PERFORM 3000-WRITE-BILLING-DETAIL  THRU  3990-EXIT.
  8807
  8808     GO TO 6090-EXIT.
  8809
  8810 6070-NO-COMP-MSTR.
  8811     IF GENERAL-AGENT
  8812         MOVE -1                 TO  AAGENTL
  8813         MOVE ER-2230            TO  EMI-ERROR
  8814         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8815         GO TO 8200-SEND-DATAONLY.
  8816
  8817     MOVE ZEROS                  TO  WS-ACCT-BEG-BAL.
  8818
  8819     GO TO 6090-EXIT.
  8820
  8821 6090-EXIT.
  8822     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL642.cbl
  8824 6100-READ-CONTROL-FILE.
  8825     MOVE PI-COMPANY-ID          TO  ELCNTL-COMPANY-ID.
  8826     MOVE +0                     TO  ELCNTL-SEQ-NO.
  8827
  8828
  8829* EXEC CICS HANDLE CONDITION
  8830*        NOTFND  (6110-NO-RECORD)
  8831*    END-EXEC.
  8832*    MOVE '"$I                   ! - #00008409' TO DFHEIV0
  8833     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8834     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8835     MOVE X'2D20233030303038343039' TO DFHEIV0(25:11)
  8836     CALL 'kxdfhei1' USING DFHEIV0
  8837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8838
  8839
  8840     IF NOT  ELCNTL-UPDATE
  8841
  8842* EXEC CICS READ
  8843*            DATASET  (ELCNTL-FILE-ID)
  8844*            SET      (ADDRESS OF CONTROL-FILE)
  8845*            RIDFLD   (ELCNTL-KEY)
  8846*        END-EXEC
  8847*    MOVE '&"S        E          (   #00008414' TO DFHEIV0
  8848     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8849     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8850     MOVE X'2020233030303038343134' TO DFHEIV0(25:11)
  8851     CALL 'kxdfhei1' USING DFHEIV0,
  8852           ELCNTL-FILE-ID,
  8853           DFHEIV20,
  8854           DFHEIV99,
  8855           ELCNTL-KEY,
  8856           DFHEIV99,
  8857           DFHEIV99,
  8858           DFHEIV99
  8859     SET ADDRESS OF CONTROL-FILE TO
  8860         DFHEIV20
  8861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8862     ELSE
  8863         MOVE SPACE              TO  ELCNTL-UPDATE-SW
  8864
  8865* EXEC CICS READ
  8866*            DATASET  (ELCNTL-FILE-ID)
  8867*            SET      (ADDRESS OF CONTROL-FILE)
  8868*            RIDFLD   (ELCNTL-KEY)
  8869*            UPDATE
  8870*        END-EXEC.
  8871*    MOVE '&"S        EU         (   #00008421' TO DFHEIV0
  8872     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8873     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8874     MOVE X'2020233030303038343231' TO DFHEIV0(25:11)
  8875     CALL 'kxdfhei1' USING DFHEIV0,
  8876           ELCNTL-FILE-ID,
  8877           DFHEIV20,
  8878           DFHEIV99,
  8879           ELCNTL-KEY,
  8880           DFHEIV99,
  8881           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL642.cbl
  8882           DFHEIV99
  8883     SET ADDRESS OF CONTROL-FILE TO
  8884         DFHEIV20
  8885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8886
  8887
  8888     GO TO 6120-EXIT.
  8889
  8890 6110-NO-RECORD.
  8891     IF ELCNTL-REC-TYPE  =  1
  8892         MOVE ER-0022            TO  EMI-ERROR
  8893     ELSE
  8894         MOVE ER-2208            TO  EMI-ERROR
  8895         MOVE -1                 TO  ACARIERL
  8896         MOVE AL-UABON           TO  ACARIERA
  8897
  8898     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8899
  8900 6120-EXIT.
  8901     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL642.cbl
  8903 6130-FIND-BENEFIT-CD.
  8904
  8905* EXEC CICS READ
  8906*       DATASET (ELCNTL-FILE-ID)
  8907*       SET     (ADDRESS OF CONTROL-FILE)
  8908*       RIDFLD  (ELCNTL-KEY)
  8909*       GTEQ
  8910*       RESP    (WS-RESPONSE)
  8911*    END-EXEC
  8912*    MOVE '&"S        G          (  N#00008444' TO DFHEIV0
  8913     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8914     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8915     MOVE X'204E233030303038343434' TO DFHEIV0(25:11)
  8916     CALL 'kxdfhei1' USING DFHEIV0,
  8917           ELCNTL-FILE-ID,
  8918           DFHEIV20,
  8919           DFHEIV99,
  8920           ELCNTL-KEY,
  8921           DFHEIV99,
  8922           DFHEIV99,
  8923           DFHEIV99
  8924     SET ADDRESS OF CONTROL-FILE TO
  8925         DFHEIV20
  8926     MOVE EIBRESP  TO WS-RESPONSE
  8927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8928     IF RESP-NORMAL
  8929        IF (CF-COMPANY-ID = PI-COMPANY-ID)
  8930           AND (CF-RECORD-TYPE = '5')
  8931           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8932              (S1 > +8)
  8933              OR (CF-BENEFIT-CODE (S1) = CLAS-LOOK)
  8934           END-PERFORM
  8935           IF S1 NOT > +8
  8936              MOVE CF-BENEFIT-CATEGORY (S1)
  8937                                 TO WS-AH-CATEGORY
  8938              GO TO 6140-EXIT
  8939           END-IF
  8940        END-IF
  8941     END-IF
  8942     .
  8943 6140-NO-RECORD.
  8944     MOVE ER-0028                TO EMI-ERROR
  8945     MOVE -1                     TO ACARIERL
  8946     MOVE AL-UABON               TO ACARIERA
  8947     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  8948     .
  8949 6140-EXIT.
  8950     EXIT.
  8951 6200-REWRITE-CONTROL-FILE.
  8952     MOVE 'C'                    TO  JP-RECORD-TYPE.
  8953     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  8954     MOVE ELCNTL-FILE-ID         TO  JP-FILE-ID.
  8955
  8956     COMPUTE JOURNAL-LENGTH = ELCNTL-LENGTH + 23.
  8957
  8958
  8959* EXEC CICS REWRITE
  8960*        DATASET  (ELCNTL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL642.cbl
  8961*        FROM     (CONTROL-FILE)
  8962*    END-EXEC.
  8963     MOVE LENGTH OF
  8964      CONTROL-FILE
  8965       TO DFHEIV11
  8966*    MOVE '&& L                  %   #00008481' TO DFHEIV0
  8967     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8968     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8969     MOVE X'2020233030303038343831' TO DFHEIV0(25:11)
  8970     CALL 'kxdfhei1' USING DFHEIV0,
  8971           ELCNTL-FILE-ID,
  8972           CONTROL-FILE,
  8973           DFHEIV11,
  8974           DFHEIV99
  8975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8976
  8977
  8978     PERFORM 8400-LOG-JOURNAL-RECORD.
  8979
  8980 6290-EXIT.
  8981     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL642.cbl
  8983 6400-READ-CROSS-REFERENCE.
  8984     MOVE PI-COMPANY-CD          TO  ERGXRF-COMPANY-CD.
  8985     MOVE PI-SAV-AGENT           TO  ERGXRF-AGENT-NO.
  8986
  8987     IF NOT  PI-ZERO-CARRIER
  8988       AND  NOT  PI-ZERO-CAR-GROUP
  8989         MOVE PI-CR-CARRIER      TO  ERGXRF-CARRIER
  8990     ELSE
  8991         MOVE ZEROS              TO  ERGXRF-CARRIER.
  8992
  8993     IF NOT  PI-ZERO-GROUPING
  8994       AND  NOT  PI-ZERO-CAR-GROUP
  8995         MOVE PI-CR-GROUPING     TO  ERGXRF-GROUPING
  8996     ELSE
  8997         MOVE ZEROS              TO  ERGXRF-GROUPING.
  8998
  8999
  9000* EXEC CICS HANDLE CONDITION
  9001*        NOTFND  (6410-NOT-FOUND)
  9002*    END-EXEC.
  9003*    MOVE '"$I                   ! . #00008507' TO DFHEIV0
  9004     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9005     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9006     MOVE X'2E20233030303038353037' TO DFHEIV0(25:11)
  9007     CALL 'kxdfhei1' USING DFHEIV0
  9008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9009
  9010
  9011
  9012* EXEC CICS READ
  9013*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  9014*        DATASET  (ERGXRF-FILE-ID)
  9015*        RIDFLD   (ERGXRF-KEY)
  9016*        LENGTH   (ERGXRF-LENGTH)
  9017*        UPDATE
  9018*    END-EXEC.
  9019*    MOVE '&"SL       EU         (   #00008511' TO DFHEIV0
  9020     MOVE X'2622534C2020202020202045' TO DFHEIV0(1:12)
  9021     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9022     MOVE X'2020233030303038353131' TO DFHEIV0(25:11)
  9023     CALL 'kxdfhei1' USING DFHEIV0,
  9024           ERGXRF-FILE-ID,
  9025           DFHEIV20,
  9026           ERGXRF-LENGTH,
  9027           ERGXRF-KEY,
  9028           DFHEIV99,
  9029           DFHEIV99,
  9030           DFHEIV99
  9031     SET ADDRESS OF AGENT-CROSS-REFERENCE TO
  9032         DFHEIV20
  9033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9034
  9035
  9036     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  9037
  9038     IF PI-UPDATE-FILES
  9039         MOVE 'B'                TO  JP-RECORD-TYPE
  9040         MOVE AGENT-CROSS-REFERENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL642.cbl
  9041                                 TO  JP-RECORD-AREA
  9042         MOVE ERGXRF-FILE-ID     TO  JP-FILE-ID
  9043         COMPUTE JOURNAL-LENGTH = ERGXRF-LENGTH + 23
  9044         PERFORM 8400-LOG-JOURNAL-RECORD.
  9045
  9046     GO TO 6490-EXIT.
  9047
  9048 6410-NOT-FOUND.
  9049     MOVE -1                     TO  AAGENTL.
  9050     MOVE ER-2911                TO  EMI-ERROR.
  9051
  9052     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9053
  9054     GO TO 8200-SEND-DATAONLY.
  9055
  9056 6490-EXIT.
  9057     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL642.cbl
  9059 6500-REWRITE-CROSS-REFERENCE.
  9060     MOVE 'C'                    TO  JP-RECORD-TYPE.
  9061     MOVE AGENT-CROSS-REFERENCE  TO  JP-RECORD-AREA.
  9062     MOVE ERGXRF-FILE-ID         TO  JP-FILE-ID.
  9063
  9064
  9065* EXEC CICS REWRITE
  9066*        DATASET  (ERGXRF-FILE-ID)
  9067*        FROM     (AGENT-CROSS-REFERENCE)
  9068*        LENGTH   (ERGXRF-LENGTH)
  9069*    END-EXEC.
  9070*    MOVE '&& L                  %   #00008547' TO DFHEIV0
  9071     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9072     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9073     MOVE X'2020233030303038353437' TO DFHEIV0(25:11)
  9074     CALL 'kxdfhei1' USING DFHEIV0,
  9075           ERGXRF-FILE-ID,
  9076           AGENT-CROSS-REFERENCE,
  9077           ERGXRF-LENGTH,
  9078           DFHEIV99
  9079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9080
  9081
  9082     PERFORM 8400-LOG-JOURNAL-RECORD.
  9083
  9084 6590-EXIT.
  9085     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL642.cbl
  9087 6600-READ-COMMISSION-EXCEPTION.
  9088
  9089* EXEC CICS HANDLE CONDITION
  9090*        NOTFND  (6610-NOT-FOUND)
  9091*    END-EXEC.
  9092*    MOVE '"$I                   ! / #00008559' TO DFHEIV0
  9093     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9094     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9095     MOVE X'2F20233030303038353539' TO DFHEIV0(25:11)
  9096     CALL 'kxdfhei1' USING DFHEIV0
  9097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9098
  9099
  9100     MOVE 'Y'                    TO ERCOMM-FOUND-SW.
  9101     MOVE PB-CONTROL-BY-ACCOUNT  TO  ERCOMM-KEY.
  9102     MOVE PB-SV-CARRIER          TO  ERCOMM-CARRIER.
  9103     MOVE PB-SV-GROUPING         TO  ERCOMM-GROUPING.
  9104     MOVE PB-SV-STATE            TO  ERCOMM-STATE.
  9105
  9106
  9107* EXEC CICS READ
  9108*        SET      (ADDRESS OF COMMISSION-EXCEPTIONS)
  9109*        DATASET  (ERCOMM-FILE-ID)
  9110*        RIDFLD   (ERCOMM-KEY)
  9111*    END-EXEC.
  9112*    MOVE '&"S        E          (   #00008569' TO DFHEIV0
  9113     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9114     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9115     MOVE X'2020233030303038353639' TO DFHEIV0(25:11)
  9116     CALL 'kxdfhei1' USING DFHEIV0,
  9117           ERCOMM-FILE-ID,
  9118           DFHEIV20,
  9119           DFHEIV99,
  9120           ERCOMM-KEY,
  9121           DFHEIV99,
  9122           DFHEIV99,
  9123           DFHEIV99
  9124     SET ADDRESS OF COMMISSION-EXCEPTIONS TO
  9125         DFHEIV20
  9126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9127
  9128
  9129     GO TO 6620-EXIT.
  9130
  9131 6610-NOT-FOUND.
  9132     MOVE 'N'                    TO  ERCOMM-FOUND-SW.
  9133
  9134 6620-EXIT.
  9135     EXIT.
  9136
  9137**START***********************************************************
  9138*      CUSTOM CODING FOR CLIENT "DMD"
  9139******************************************************************
  9140*
  9141 6650-GET-RES-STATE-COMM.
  9142*6650-BROWSE-FORWARD.
  9143
  9144     IF PB-COMPANY-ID NOT = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL642.cbl
  9145         GO TO 6700-COMM-EXIT.
  9146
  9147     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
  9148     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
  9149     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
  9150     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
  9151     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
  9152     MOVE AM-AGT (WS-GA-LEVEL) TO WS-ERRESC-AGENT.
  9153     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
  9154
  9155*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
  9156*
  9157     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
  9158     SET BIN-TO-GREG          TO TRUE.
  9159     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9160
  9161     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
  9162
  9163     IF DC-GREG-DATE-1-YMD (1:2) IS LESS THAN '10'
  9164         MOVE '20'            TO WS-CONTRACT-DATE (1:2)
  9165     ELSE
  9166         MOVE '19'            TO WS-CONTRACT-DATE (1:2).
  9167
  9168     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
  9169
  9170
  9171* EXEC CICS HANDLE CONDITION
  9172*        INVREQ    (6660-START-BROWSE)
  9173*        NOTFND    (6700-COMM-EXIT)
  9174*    END-EXEC.
  9175*    MOVE '"$8I                  ! 0 #00008616' TO DFHEIV0
  9176     MOVE X'222438492020202020202020' TO DFHEIV0(1:12)
  9177     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9178     MOVE X'3020233030303038363136' TO DFHEIV0(25:11)
  9179     CALL 'kxdfhei1' USING DFHEIV0
  9180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9181
  9182
  9183
  9184* EXEC CICS RESETBR
  9185*        DATASET (ERRESC-FILE-ID)
  9186*        RIDFLD  (WS-ERRESC-KEY)
  9187*    END-EXEC.
  9188     MOVE 0
  9189       TO DFHEIV11
  9190*    MOVE '&4         G          &   #00008621' TO DFHEIV0
  9191     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
  9192     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9193     MOVE X'2020233030303038363231' TO DFHEIV0(25:11)
  9194     CALL 'kxdfhei1' USING DFHEIV0,
  9195           ERRESC-FILE-ID,
  9196           WS-ERRESC-KEY,
  9197           DFHEIV99,
  9198           DFHEIV11,
  9199           DFHEIV99
  9200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9201
  9202
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL642.cbl
  9203 6660-START-BROWSE.
  9204
  9205
  9206* EXEC CICS HANDLE CONDITION
  9207*        NOTFND    (6700-COMM-EXIT)
  9208*        ENDFILE   (6700-COMM-EXIT)
  9209*    END-EXEC.
  9210*    MOVE '"$I''                  ! 1 #00008628' TO DFHEIV0
  9211     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9212     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9213     MOVE X'3120233030303038363238' TO DFHEIV0(25:11)
  9214     CALL 'kxdfhei1' USING DFHEIV0
  9215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9216
  9217
  9218
  9219* EXEC CICS STARTBR
  9220*        DATASET (ERRESC-FILE-ID)
  9221*        RIDFLD  (WS-ERRESC-KEY)
  9222*        GTEQ
  9223*    END-EXEC.
  9224     MOVE 0
  9225       TO DFHEIV11
  9226*    MOVE '&,         G          &   #00008633' TO DFHEIV0
  9227     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9228     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9229     MOVE X'2020233030303038363333' TO DFHEIV0(25:11)
  9230     CALL 'kxdfhei1' USING DFHEIV0,
  9231           ERRESC-FILE-ID,
  9232           WS-ERRESC-KEY,
  9233           DFHEIV99,
  9234           DFHEIV11,
  9235           DFHEIV99
  9236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9237
  9238
  9239     MOVE WS-ERRESC-KEY           TO WS-SV-ERRESC-KEY.
  9240
  9241 6670-READ-NEXT-ERRESC-MASTER.
  9242
  9243
  9244* EXEC CICS HANDLE CONDITION
  9245*        NOTFND    (6700-COMM-EXIT)
  9246*        ENDFILE   (6700-COMM-EXIT)
  9247*    END-EXEC.
  9248*    MOVE '"$I''                  ! 2 #00008643' TO DFHEIV0
  9249     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9250     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9251     MOVE X'3220233030303038363433' TO DFHEIV0(25:11)
  9252     CALL 'kxdfhei1' USING DFHEIV0
  9253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9254
  9255
  9256
  9257* EXEC CICS READNEXT
  9258*        SET      (ADDRESS OF ACCOUNT-RESIDENT-ST-COMMISSION)
  9259*        DATASET (ERRESC-FILE-ID)
  9260*        RIDFLD  (WS-ERRESC-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL642.cbl
  9261*    END-EXEC.
  9262     MOVE 0
  9263       TO DFHEIV11
  9264*    MOVE '&.S                   )   #00008648' TO DFHEIV0
  9265     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9266     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9267     MOVE X'2020233030303038363438' TO DFHEIV0(25:11)
  9268     CALL 'kxdfhei1' USING DFHEIV0,
  9269           ERRESC-FILE-ID,
  9270           DFHEIV20,
  9271           DFHEIV99,
  9272           WS-ERRESC-KEY,
  9273           DFHEIV99,
  9274           DFHEIV11,
  9275           DFHEIV99,
  9276           DFHEIV99
  9277     SET ADDRESS OF ACCOUNT-RESIDENT-ST-COMMISSION TO
  9278         DFHEIV20
  9279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9280
  9281
  9282     IF ERRESC-RECORD-KEY (1:32) = WS-SV-ERRESC-KEY
  9283        NEXT SENTENCE
  9284     ELSE
  9285
  9286* EXEC CICS ENDBR
  9287*            DATASET (ERRESC-FILE-ID)
  9288*       END-EXEC
  9289     MOVE 0
  9290       TO DFHEIV11
  9291*    MOVE '&2                    $   #00008657' TO DFHEIV0
  9292     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9293     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9294     MOVE X'2020233030303038363537' TO DFHEIV0(25:11)
  9295     CALL 'kxdfhei1' USING DFHEIV0,
  9296           ERRESC-FILE-ID,
  9297           DFHEIV11,
  9298           DFHEIV99
  9299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9300        GO TO 6700-COMM-EXIT.
  9301
  9302* CHECK IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT RESIDENT
  9303* STATE COMMISSIONS RECORD'S EFFECT TIME PERIOD????
  9304     IF WS-CONTRACT-DATE IS LESS THAN RESC-EFFECTIVE-DATE
  9305
  9306* EXEC CICS ENDBR
  9307*            DATASET (ERRESC-FILE-ID)
  9308*       END-EXEC
  9309     MOVE 0
  9310       TO DFHEIV11
  9311*    MOVE '&2                    $   #00008665' TO DFHEIV0
  9312     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9313     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9314     MOVE X'2020233030303038363635' TO DFHEIV0(25:11)
  9315     CALL 'kxdfhei1' USING DFHEIV0,
  9316           ERRESC-FILE-ID,
  9317           DFHEIV11,
  9318           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL642.cbl
  9319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9320        GO TO 6700-COMM-EXIT.
  9321
  9322* SEARCH FOR MATCHING CATEGORY CODE ENTRY
  9323*
  9324*    IF RESC-COMMISSION IS NUMERIC THAT IS THE COMMISSION TO OVER-
  9325*    RIDE AH OR LIFE COMMISSION IN IN THE ACCOUNT MASTER.
  9326*    IF RESC-COMMISSION NOT NUMERIC, USE VALUE TO GET COMMISSION
  9327*    FROM COMMISSION TABLE IF RECORD EXISTS.
  9328*
  9329     MOVE ZEROS               TO WS-SUB WS-SUB1.
  9330
  9331     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
  9332
  9333     IF WS-SUB1 IS GREATER THAN ZERO
  9334         IF RESC-COMMISSION-TAB (WS-SUB) NUMERIC
  9335             PERFORM 6680-SET-COMMISSION
  9336         ELSE
  9337             PERFORM 6680-SET-TABLE-CODE.
  9338
  9339
  9340* EXEC CICS ENDBR
  9341*         DATASET (ERRESC-FILE-ID)
  9342*    END-EXEC.
  9343     MOVE 0
  9344       TO DFHEIV11
  9345*    MOVE '&2                    $   #00008687' TO DFHEIV0
  9346     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9347     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9348     MOVE X'2020233030303038363837' TO DFHEIV0(25:11)
  9349     CALL 'kxdfhei1' USING DFHEIV0,
  9350           ERRESC-FILE-ID,
  9351           DFHEIV11,
  9352           DFHEIV99
  9353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9354
  9355
  9356     GO TO 6700-COMM-EXIT.
  9357
  9358 6680-SET-TABLE-CODE.
  9359     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
  9360        MOVE ZEROS             TO WS-SUB1
  9361     ELSE
  9362
  9363* READ COMMISSION TABLE(CTBL)  KEY VALUES PRESET IN CALLING
  9364* PARAGRAPHS(4405-FIND-AH, 4420-CONT-FIND-LIFE, 4430-SINGLE-LIFE)
  9365
  9366     MOVE RESC-COMMISSION-TAB (WS-SUB) TO ERCTBL-TABLE
  9367     PERFORM 6680-READ-CTBL-TABLE.
  9368
  9369 6680-READ-CTBL-TABLE.
  9370*
  9371* READ COMMISSION TABLE TO VERIFY IF ACCOUNT RESIDENT STATE
  9372* COMMISSION RECORD CONTAINS A VALID COMPENSATION TABLE CODE.
  9373* IF CODE IS NOT VALID USE CODE IN ACCOUNT MASTER
  9374
  9375     PERFORM 6700-READ-COMMISSION-TABLE THRU 6790-EXIT.
  9376
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL642.cbl
  9377     IF ERCTBL-NOT-FOUND
  9378         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  9379         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  9380         IF ERCTBL-NOT-FOUND
  9381             MOVE ZEROS          TO  WS-SUB1.
  9382
  9383     IF ERCTBL-FOUND
  9384        IF AH-COMM
  9385            PERFORM 6680-AH-GET-COMP-RATE
  9386        ELSE
  9387            PERFORM 6680-LF-GET-COMP-RATE.
  9388
  9389 6680-AH-GET-COMP-RATE.
  9390     IF PB-ISSUE
  9391         COMPUTE WS-COMM-CK-AMT =
  9392             PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  9393         MOVE PB-I-AGE           TO  WS-COMM-AGE
  9394         MOVE PB-I-AH-TERM       TO  WS-COMM-TERM
  9395     ELSE
  9396         COMPUTE WS-COMM-CK-AMT =
  9397             PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  9398         MOVE PB-CI-INSURED-AGE  TO  WS-COMM-AGE
  9399         MOVE PB-CI-AH-TERM      TO  WS-COMM-TERM.
  9400
  9401     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  9402
  9403     MOVE WS-WK-RATE             TO  WS-GA-AH-COM.
  9404
  9405 6680-LF-GET-COMP-RATE.
  9406     IF PB-ISSUE
  9407         MOVE PB-I-LF-BENEFIT-AMT
  9408                                 TO  WS-COMM-CK-AMT
  9409         MOVE PB-I-AGE           TO  WS-COMM-AGE
  9410         MOVE PB-I-LF-TERM       TO  WS-COMM-TERM
  9411     ELSE
  9412         MOVE PB-CI-INSURED-AGE  TO  WS-COMM-AGE
  9413         MOVE PB-CI-LF-TERM      TO  WS-COMM-TERM
  9414         MOVE PB-CI-LF-BENEFIT-AMT
  9415                                 TO  WS-COMM-CK-AMT.
  9416
  9417     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  9418
  9419     MOVE WS-WK-RATE             TO  WS-GA-LF-COM.
  9420
  9421 6680-SET-COMMISSION.
  9422     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
  9423           MOVE ZEROS          TO WS-SUB1
  9424       ELSE
  9425           MOVE RESC-COMMISSION-PER (WS-SUB)
  9426                              TO WS-COMMISSION
  9427           IF AH-COMM
  9428              MOVE WS-COMMISSION TO WS-GA-AH-COM
  9429           ELSE
  9430              MOVE WS-COMMISSION TO WS-GA-LF-COM.
  9431
  9432 6680-SEARCH-CATEGORY.
  9433     ADD +1 TO WS-SUB.
  9434     IF WS-SUB IS GREATER THAN +12
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL642.cbl
  9435         GO TO 6680-EXIT.
  9436
  9437     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
  9438          MOVE WS-SUB         TO WS-SUB1
  9439          GO TO 6680-EXIT.
  9440
  9441     GO TO 6680-SEARCH-CATEGORY.
  9442
  9443 6680-EXIT.
  9444     EXIT.
  9445
  9446 6700-COMM-EXIT.
  9447     EXIT.
  9448**END*************************************************************
  9449*      CUSTOM CODING FOR CLIENT "DMD"
  9450******************************************************************
  9451*
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL642.cbl
  9453 6700-READ-COMMISSION-TABLE.
  9454
  9455* EXEC CICS HANDLE CONDITION
  9456*        NOTFND  (6710-NOT-FOUND)
  9457*    END-EXEC.
  9458*    MOVE '"$I                   ! 3 #00008789' TO DFHEIV0
  9459     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9460     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9461     MOVE X'3320233030303038373839' TO DFHEIV0(25:11)
  9462     CALL 'kxdfhei1' USING DFHEIV0
  9463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9464
  9465
  9466     MOVE 'Y'                    TO  ERCTBL-FOUND-SW.
  9467
  9468
  9469* EXEC CICS READ
  9470*        SET      (ADDRESS OF COMM-TABLE-RECORD)
  9471*        DATASET  (ERCTBL-FILE-ID)
  9472*        RIDFLD   (ERCTBL-KEY)
  9473*    END-EXEC.
  9474*    MOVE '&"S        E          (   #00008795' TO DFHEIV0
  9475     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9476     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9477     MOVE X'2020233030303038373935' TO DFHEIV0(25:11)
  9478     CALL 'kxdfhei1' USING DFHEIV0,
  9479           ERCTBL-FILE-ID,
  9480           DFHEIV20,
  9481           DFHEIV99,
  9482           ERCTBL-KEY,
  9483           DFHEIV99,
  9484           DFHEIV99,
  9485           DFHEIV99
  9486     SET ADDRESS OF COMM-TABLE-RECORD TO
  9487         DFHEIV20
  9488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9489
  9490
  9491     GO TO 6790-EXIT.
  9492
  9493 6710-NOT-FOUND.
  9494     MOVE 'N'                    TO  ERCTBL-FOUND-SW.
  9495
  9496 6790-EXIT.
  9497     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL642.cbl
  9499 6800-READ-BENEFIT-MASTER.
  9500
  9501* EXEC CICS HANDLE CONDITION
  9502*        NOTFND  (6880-NOT-FOUND)
  9503*    END-EXEC.
  9504*    MOVE '"$I                   ! 4 #00008810' TO DFHEIV0
  9505     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9506     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9507     MOVE X'3420233030303038383130' TO DFHEIV0(25:11)
  9508     CALL 'kxdfhei1' USING DFHEIV0
  9509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9510
  9511
  9512     MOVE 'Y'                    TO  BENEFIT-MASTER-FOUND-SW.
  9513     MOVE PB-COMPANY-ID          TO  CLBENF-COMPANY-ID.
  9514     MOVE '4'                    TO  CLBENF-REC-TYPE.
  9515     MOVE +0                     TO  CLBENF-SEQ-NO.
  9516
  9517
  9518* EXEC CICS READ
  9519*        SET      (ADDRESS OF CONTROL-FILE)
  9520*        DATASET  (ELCNTL-FILE-ID)
  9521*        RIDFLD   (ELCNTL-BENEFIT-KEY)
  9522*        GTEQ
  9523*    END-EXEC.
  9524*    MOVE '&"S        G          (   #00008819' TO DFHEIV0
  9525     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9526     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9527     MOVE X'2020233030303038383139' TO DFHEIV0(25:11)
  9528     CALL 'kxdfhei1' USING DFHEIV0,
  9529           ELCNTL-FILE-ID,
  9530           DFHEIV20,
  9531           DFHEIV99,
  9532           ELCNTL-BENEFIT-KEY,
  9533           DFHEIV99,
  9534           DFHEIV99,
  9535           DFHEIV99
  9536     SET ADDRESS OF CONTROL-FILE TO
  9537         DFHEIV20
  9538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9539
  9540
  9541     IF CLBENF-COMPANY-ID  NOT =  CF-COMPANY-ID
  9542         GO TO 6880-NOT-FOUND.
  9543
  9544     IF CLBENF-REC-TYPE  NOT =  CF-RECORD-TYPE
  9545         GO TO 6880-NOT-FOUND.
  9546
  9547     MOVE +0                     TO  BEN-SUB.
  9548
  9549 6810-FIND-BENEFIT.
  9550     ADD +1                      TO  BEN-SUB.
  9551
  9552     IF BEN-SUB  GREATER THAN  +8
  9553         GO TO 6880-NOT-FOUND.
  9554
  9555     IF CF-BENEFIT-CODE (BEN-SUB)  =  CLBENF-CD
  9556         MOVE CF-JOINT-INDICATOR (BEN-SUB)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL642.cbl
  9557                                 TO  LIFE-INDICATOR
  9558         GO TO 6890-EXIT.
  9559
  9560     GO TO 6810-FIND-BENEFIT.
  9561
  9562 6880-NOT-FOUND.
  9563     MOVE 'N'                    TO  BENEFIT-MASTER-FOUND-SW.
  9564
  9565 6890-EXIT.
  9566     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 198
* EL642.cbl
  9568 7000-PROCESS-CHECK.
  9569     MOVE LOW-VALUES             TO  EL642BO.
  9570
  9571     MOVE 'G'                    TO  COMPENSATION-SW
  9572                                     PI-CR-TYPE.
  9573
  9574     PERFORM 6000-READ-COMP-MASTER  THRU  6090-EXIT.
  9575
  9576     IF EMI-ERROR = ZEROS
  9577         MOVE CO-MAIL-NAME       TO  BNAMEO
  9578         MOVE CO-ADDR-1          TO  BADDR1O
  9579         MOVE CO-ADDR-2          TO  BADDR2O
  9580*        MOVE CO-ADDR-3          TO  BCITYSTO
  9581         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  9582            DELIMITED BY '  ' INTO BCITYSTO
  9583         END-STRING
  9584         MOVE CO-ZIP             TO  BZIPO
  9585     ELSE
  9586         MOVE EL642A             TO  PI-MAP-NAME
  9587         MOVE -1                 TO  BPFNTERL
  9588         GO TO 8200-SEND-DATAONLY.
  9589
  9590     IF PI-COMP-UNPAID-PREM  GREATER THAN  ZERO
  9591         MOVE PI-COMP-UNPAID-PREM
  9592                                 TO BCHKAMTO
  9593     ELSE
  9594         MOVE ZEROS              TO  BCHKAMTO.
  9595
  9596     MOVE AL-UNNON               TO  BCHKAMTA.
  9597     MOVE WS-CURRENT-DATE-EDIT   TO  BPAYDT1O.
  9598     MOVE -1                     TO  BCHKNOL.
  9599
  9600     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 199
* EL642.cbl
  9602 7500-PRODUCE-CHECK.
  9603     MOVE SPACES                 TO  ELCNTL-KEY.
  9604     MOVE '1'                    TO  ELCNTL-REC-TYPE.
  9605     MOVE 'Y'                    TO  ELCNTL-UPDATE-SW.
  9606
  9607     PERFORM 6100-READ-CONTROL-FILE  THRU  6120-EXIT.
  9608
  9609     IF EMI-ERROR  NOT =  ZEROS
  9610         GO TO 8200-SEND-DATAONLY.
  9611
  9612     IF CR-CHECK-NO-AUTO-SEQ
  9613         MOVE 'B'                TO  JP-RECORD-TYPE
  9614         MOVE CONTROL-FILE       TO  JP-RECORD-AREA
  9615         MOVE ELCNTL-FILE-ID     TO  JP-FILE-ID
  9616         COMPUTE JOURNAL-LENGTH = ELCNTL-LENGTH + 23
  9617         PERFORM 8400-LOG-JOURNAL-RECORD
  9618         IF CR-CHECK-CNT-RESET-VALUE
  9619             MOVE CF-CR-CHECK-COUNTER
  9620                                 TO  BCHKNOI
  9621             MOVE +1             TO  CF-CR-CHECK-COUNTER
  9622             MOVE 6              TO  BCHKNOL
  9623         ELSE
  9624             MOVE CF-CR-CHECK-COUNTER
  9625                                 TO  BCHKNOI
  9626             MOVE 6              TO  BCHKNOL
  9627             ADD +1              TO  CF-CR-CHECK-COUNTER.
  9628
  9629     IF CR-CHECK-NO-MANUAL
  9630         IF BCHKNOL = ZEROS
  9631             MOVE ER-2438        TO  EMI-ERROR
  9632             MOVE -1             TO  BCHKNOL
  9633             MOVE AL-UNBON       TO  BCHKNOA
  9634             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9635             GO TO 8200-SEND-DATAONLY
  9636         ELSE
  9637             IF BCHKNOI NOT NUMERIC
  9638                 MOVE ER-2439    TO  EMI-ERROR
  9639                 MOVE -1         TO  BCHKNOL
  9640                 MOVE AL-UNBON   TO  BCHKNOA
  9641                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9642                 GO TO 8200-SEND-DATAONLY.
  9643
  9644
  9645* EXEC CICS GETMAIN
  9646*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  9647*        LENGTH   (ERPYAJ-LENGTH)
  9648*        INITIMG  (GETMAIN-SPACE)
  9649*    END-EXEC.
  9650*    MOVE ',"IL                  $   #00008929' TO DFHEIV0
  9651     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9652     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9653     MOVE X'2020233030303038393239' TO DFHEIV0(25:11)
  9654     CALL 'kxdfhei1' USING DFHEIV0,
  9655           DFHEIV20,
  9656           ERPYAJ-LENGTH,
  9657           GETMAIN-SPACE
  9658     SET ADDRESS OF PENDING-PAY-ADJ TO
  9659         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 200
* EL642.cbl
  9660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9661
  9662
  9663
  9664* EXEC CICS BIF DEEDIT
  9665*        FIELD   (BCHKAMTI)
  9666*        LENGTH  (09)
  9667*    END-EXEC.
  9668     MOVE 09
  9669       TO DFHEIV11
  9670*    MOVE '@"L                   #   #00008935' TO DFHEIV0
  9671     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9672     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9673     MOVE X'2020233030303038393335' TO DFHEIV0(25:11)
  9674     CALL 'kxdfhei1' USING DFHEIV0,
  9675           BCHKAMTI,
  9676           DFHEIV11
  9677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9678
  9679
  9680     IF BCHKAMTI NOT GREATER THAN ZEROS
  9681         MOVE ER-3165    TO  EMI-ERROR
  9682         MOVE -1         TO  BCHKAMTL
  9683         MOVE AL-UNBON   TO  BCHKAMTA
  9684         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9685         GO TO 8200-SEND-DATAONLY.
  9686
  9687     MOVE 'Y'                    TO  PI-CHECK-SW.
  9688     MOVE 'PY'                   TO  PY-RECORD-ID.
  9689     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  9690     MOVE PI-SAV-CARR            TO  PY-CARRIER.
  9691     MOVE PI-SAV-GROUP           TO  PY-GROUPING.
  9692     MOVE PI-SAV-AGENT           TO  PY-FIN-RESP.
  9693     MOVE LOW-VALUES             TO  PY-ACCOUNT.
  9694     MOVE 'C'                    TO  PY-RECORD-TYPE.
  9695     MOVE EIBTIME                TO  PY-FILE-SEQ-NO.
  9696     MOVE WS-CURRENT-DATE-MDY    TO  WS-PY-CURRENT-DATE.
  9697     MOVE WS-PY-ENTRY-COMMENT    TO  PY-ENTRY-COMMENT.
  9698     MOVE BCHKAMTI               TO  PY-ENTRY-AMT.
  9699
  9700     ADD BCHKAMTI                TO  PI-DISBURSED.
  9701
  9702     IF NOT  CR-CHECK-NO-AT-PRINT
  9703         MOVE BCHKNOI            TO  PY-CHECK-NUMBER.
  9704
  9705     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  9706     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  9707     MOVE WS-CURRENT-DATE        TO  PY-LAST-MAINT-DT
  9708                                     PY-INPUT-DT.
  9709     MOVE LOW-VALUES             TO  PY-BILLED-DATE
  9710                                     PY-AR-DATE.
  9711     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  9712                                     PY-CHECK-QUE-SEQUENCE.
  9713     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  9714                                     PY-REPORTED-DT
  9715                                     PY-CHECK-WRITTEN-DT.
  9716     MOVE PI-CR-MONTH-END-DT     TO  PY-CREDIT-SELECT-DT.
  9717     MOVE 'G'                    TO  PY-CHECK-ORIGIN-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 201
* EL642.cbl
  9718     MOVE 'A'                    TO  JP-RECORD-TYPE.
  9719     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  9720     MOVE ERPYAJ-FILE-ID         TO  JP-FILE-ID.
  9721
  9722     COMPUTE JOURNAL-LENGTH = ERPYAJ-LENGTH + 23.
  9723
  9724
  9725* EXEC CICS WRITE
  9726*        DATASET  (ERPYAJ-FILE-ID)
  9727*        FROM     (PENDING-PAY-ADJ)
  9728*        RIDFLD   (PY-CONTROL-PRIMARY)
  9729*    END-EXEC.
  9730     MOVE LENGTH OF
  9731      PENDING-PAY-ADJ
  9732       TO DFHEIV11
  9733*    MOVE '&$ L                  ''   #00008984' TO DFHEIV0
  9734     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9735     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9736     MOVE X'2020233030303038393834' TO DFHEIV0(25:11)
  9737     CALL 'kxdfhei1' USING DFHEIV0,
  9738           ERPYAJ-FILE-ID,
  9739           PENDING-PAY-ADJ,
  9740           DFHEIV11,
  9741           PY-CONTROL-PRIMARY,
  9742           DFHEIV99,
  9743           DFHEIV99
  9744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9745
  9746
  9747     PERFORM 8400-LOG-JOURNAL-RECORD.
  9748
  9749     IF CR-CHECK-NO-AUTO-SEQ
  9750         PERFORM 6200-REWRITE-CONTROL-FILE  THRU  6290-EXIT
  9751     ELSE
  9752
  9753* EXEC CICS UNLOCK
  9754*            DATASET  (ELCNTL-FILE-ID)
  9755*        END-EXEC.
  9756*    MOVE '&*                    #   #00008995' TO DFHEIV0
  9757     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9758     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9759     MOVE X'2020233030303038393935' TO DFHEIV0(25:11)
  9760     CALL 'kxdfhei1' USING DFHEIV0,
  9761           ELCNTL-FILE-ID,
  9762           DFHEIV99
  9763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9764
  9765
  9766     MOVE EL642A                 TO  PI-MAP-NAME.
  9767
  9768     PERFORM 5000-FORMAT-SCREEN  THRU  5090-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 202
* EL642.cbl
  9770 8100-SEND-INITIAL-MAP.
  9771
  9772     MOVE SPACES TO PI-TRANSFER-SW.
  9773
  9774     IF PI-MAP-NAME  =  EL642A
  9775         NEXT SENTENCE
  9776     ELSE
  9777         GO TO 8110-SEND-INITIAL-CHECK-MAP.
  9778
  9779     MOVE WS-CURRENT-DATE-EDIT   TO  ADATEO.
  9780     MOVE EIBTIME                TO  TIME-IN.
  9781     MOVE TIME-OUT               TO  ATIMEO.
  9782     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9783     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9784     MOVE -1                     TO  AAGENTL.
  9785     MOVE EMI-MESSAGE-AREA (1)   TO  AERMSG1O.
  9786     MOVE EMI-MESSAGE-AREA (2)   TO  AERMSG2O.
  9787
  9788     IF PI-ZERO-CARRIER
  9789         MOVE AL-SADOF           TO  ACARHDGA
  9790                                     ACARIERA.
  9791
  9792     IF PI-ZERO-GROUPING
  9793         MOVE AL-SADOF           TO  AGRPHDGA
  9794                                     AGROUPA.
  9795
  9796     IF PI-ZERO-CAR-GROUP
  9797         MOVE AL-SADOF           TO  ACARHDGA
  9798                                     ACARIERA
  9799         MOVE AL-SADOF           TO  AGRPHDGA
  9800                                     AGROUPA.
  9801
  9802     IF (EIBTRNID = EL633-TRANS-ID OR EL635-TRANS-ID OR
  9803                    EL633DMD-TRANS-ID OR
  9804                    EL650-TRANS-ID OR EL652-TRANS-ID OR
  9805                    EL658-TRANS-ID)    AND
  9806        (WT-CR-FIN-RESP NOT EQUAL SPACES AND LOW-VALUES)
  9807         MOVE -1                    TO  ABILTYPL
  9808         MOVE WT-CR-STATE           TO  PI-SCR-STATE
  9809         MOVE WT-CR-ACCOUNT         TO  PI-SCR-ACCOUNT
  9810         MOVE WT-CR-TYPE            TO  PI-SCR-TYPE
  9811         IF PI-ZERO-CARRIER
  9812             MOVE WT-CR-FIN-RESP    TO  AAGENTI
  9813                                        PI-SCR-FIN-RESP
  9814             MOVE WT-CR-GROUPING    TO  AGROUPI
  9815                                        PI-SCR-GROUPING
  9816             MOVE AL-UANON          TO  AAGENTA
  9817                                        AGROUPA
  9818             MOVE 10                TO  AAGENTL
  9819             MOVE 6                 TO  AGROUPL
  9820         ELSE
  9821            IF PI-ZERO-GROUPING
  9822                MOVE WT-CR-CARRIER    TO  ACARIERI
  9823                                          PI-SCR-CARRIER
  9824                MOVE WT-CR-FIN-RESP   TO  AAGENTI
  9825                                          PI-SCR-FIN-RESP
  9826                MOVE AL-UANON         TO  ACARIERA
  9827                                          AAGENTA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 203
* EL642.cbl
  9828                MOVE 10               TO  AAGENTL
  9829                MOVE 1                TO  ACARIERL
  9830            ELSE
  9831               IF PI-ZERO-CAR-GROUP
  9832                   MOVE WT-CR-FIN-RESP TO  AAGENTI
  9833                                           PI-SCR-FIN-RESP
  9834                   MOVE AL-UANON       TO  AAGENTA
  9835                   MOVE 10             TO  AAGENTL
  9836               ELSE
  9837                   MOVE WT-CR-CARRIER     TO  ACARIERI
  9838                                              PI-SCR-CARRIER
  9839                   MOVE WT-CR-FIN-RESP    TO  AAGENTI
  9840                                              PI-SCR-FIN-RESP
  9841                   MOVE WT-CR-GROUPING    TO  AGROUPI
  9842                                              PI-SCR-GROUPING
  9843                   MOVE AL-UANON          TO  AAGENTA
  9844                                              AGROUPA
  9845                                              ACARIERA
  9846                   MOVE 10                TO  AAGENTL
  9847                   MOVE 6                 TO  AGROUPL
  9848                   MOVE 1                 TO  ACARIERL.
  9849
  9850
  9851* EXEC CICS SEND
  9852*        MAP     (PI-MAP-NAME)
  9853*        MAPSET  (MAPSET-NAME)
  9854*        FROM    (EL642AO)
  9855*        ERASE
  9856*        CURSOR
  9857*    END-EXEC.
  9858     MOVE LENGTH OF
  9859      EL642AO
  9860       TO DFHEIV12
  9861     MOVE -1
  9862       TO DFHEIV11
  9863*    MOVE '8$     CT  E    H L F ,   #00009083' TO DFHEIV0
  9864     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9865     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9866     MOVE X'2020233030303039303833' TO DFHEIV0(25:11)
  9867     CALL 'kxdfhei1' USING DFHEIV0,
  9868           PI-MAP-NAME,
  9869           EL642AO,
  9870           DFHEIV12,
  9871           MAPSET-NAME,
  9872           DFHEIV99,
  9873           DFHEIV99,
  9874           DFHEIV99,
  9875           DFHEIV11,
  9876           DFHEIV99,
  9877           DFHEIV99,
  9878           DFHEIV99
  9879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9880
  9881
  9882     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 204
* EL642.cbl
  9884 8110-SEND-INITIAL-CHECK-MAP.
  9885     MOVE WS-CURRENT-DATE-EDIT   TO  BDATEO.
  9886     MOVE EIBTIME                TO  TIME-IN.
  9887     MOVE TIME-OUT               TO  BTIMEO.
  9888     MOVE PI-COMPANY-ID          TO  BCMPNYO.
  9889     MOVE PI-PROCESSOR-ID        TO  BUSERIDO.
  9890     MOVE -1                     TO  BPFNTERL.
  9891     MOVE EMI-MESSAGE-AREA (1)   TO  BERMSGO.
  9892
  9893
  9894* EXEC CICS SEND
  9895*        MAP     (PI-MAP-NAME)
  9896*        MAPSET  (MAPSET-NAME)
  9897*        FROM    (EL642BO)
  9898*        ERASE
  9899*        CURSOR
  9900*    END-EXEC.
  9901     MOVE LENGTH OF
  9902      EL642BO
  9903       TO DFHEIV12
  9904     MOVE -1
  9905       TO DFHEIV11
  9906*    MOVE '8$     CT  E    H L F ,   #00009102' TO DFHEIV0
  9907     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9908     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9909     MOVE X'2020233030303039313032' TO DFHEIV0(25:11)
  9910     CALL 'kxdfhei1' USING DFHEIV0,
  9911           PI-MAP-NAME,
  9912           EL642BO,
  9913           DFHEIV12,
  9914           MAPSET-NAME,
  9915           DFHEIV99,
  9916           DFHEIV99,
  9917           DFHEIV99,
  9918           DFHEIV11,
  9919           DFHEIV99,
  9920           DFHEIV99,
  9921           DFHEIV99
  9922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9923
  9924
  9925     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 205
* EL642.cbl
  9927 8200-SEND-DATAONLY.
  9928     IF PI-MAP-NAME  =  EL642A
  9929         MOVE WS-CURRENT-DATE-EDIT  TO  ADATEO
  9930         MOVE EIBTIME               TO  TIME-IN
  9931         MOVE TIME-OUT              TO  ATIMEO
  9932         MOVE PI-COMPANY-ID         TO  CMPNYIDO
  9933         MOVE PI-PROCESSOR-ID       TO  USERIDO
  9934         MOVE EMI-MESSAGE-AREA (1)  TO  AERMSG1O
  9935         MOVE EMI-MESSAGE-AREA (2)  TO  AERMSG2O
  9936
  9937* EXEC CICS SEND
  9938*            MAP     (PI-MAP-NAME)
  9939*            MAPSET  (MAPSET-NAME)
  9940*            FROM    (EL642AO)
  9941*            DATAONLY
  9942*            ERASEAUP
  9943*            CURSOR
  9944*        END-EXEC
  9945     MOVE LENGTH OF
  9946      EL642AO
  9947       TO DFHEIV12
  9948     MOVE -1
  9949       TO DFHEIV11
  9950*    MOVE '8$D    CT  A    H L F ,   #00009121' TO DFHEIV0
  9951     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  9952     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9953     MOVE X'2020233030303039313231' TO DFHEIV0(25:11)
  9954     CALL 'kxdfhei1' USING DFHEIV0,
  9955           PI-MAP-NAME,
  9956           EL642AO,
  9957           DFHEIV12,
  9958           MAPSET-NAME,
  9959           DFHEIV99,
  9960           DFHEIV99,
  9961           DFHEIV99,
  9962           DFHEIV11,
  9963           DFHEIV99,
  9964           DFHEIV99,
  9965           DFHEIV99
  9966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9967     ELSE
  9968         MOVE WS-CURRENT-DATE-EDIT  TO  BDATEO
  9969         MOVE EIBTIME               TO  TIME-IN
  9970         MOVE TIME-OUT              TO  BTIMEO
  9971         MOVE PI-COMPANY-ID         TO  BCMPNYO
  9972         MOVE PI-PROCESSOR-ID       TO  BUSERIDO
  9973         MOVE EMI-MESSAGE-AREA (1)  TO  BERMSGO
  9974
  9975* EXEC CICS SEND
  9976*            MAP     (PI-MAP-NAME)
  9977*            MAPSET  (MAPSET-NAME)
  9978*            FROM    (EL642BO)
  9979*            DATAONLY
  9980*            ERASEAUP
  9981*            CURSOR
  9982*        END-EXEC.
  9983     MOVE LENGTH OF
  9984      EL642BO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 206
* EL642.cbl
  9985       TO DFHEIV12
  9986     MOVE -1
  9987       TO DFHEIV11
  9988*    MOVE '8$D    CT  A    H L F ,   #00009136' TO DFHEIV0
  9989     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  9990     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9991     MOVE X'2020233030303039313336' TO DFHEIV0(25:11)
  9992     CALL 'kxdfhei1' USING DFHEIV0,
  9993           PI-MAP-NAME,
  9994           EL642BO,
  9995           DFHEIV12,
  9996           MAPSET-NAME,
  9997           DFHEIV99,
  9998           DFHEIV99,
  9999           DFHEIV99,
 10000           DFHEIV11,
 10001           DFHEIV99,
 10002           DFHEIV99,
 10003           DFHEIV99
 10004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10005
 10006
 10007     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 207
* EL642.cbl
 10009 8300-SEND-TEXT.
 10010
 10011* EXEC CICS SEND TEXT
 10012*        FROM    (LOGOFF-TEXT)
 10013*        LENGTH  (LOGOFF-LENGTH)
 10014*        ERASE
 10015*        FREEKB
 10016*    END-EXEC.
 10017*    MOVE '8&      T  E F  H   F -   #00009148' TO DFHEIV0
 10018     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10019     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10020     MOVE X'2020233030303039313438' TO DFHEIV0(25:11)
 10021     CALL 'kxdfhei1' USING DFHEIV0,
 10022           LOGOFF-TEXT,
 10023           LOGOFF-LENGTH,
 10024           DFHEIV99,
 10025           DFHEIV99,
 10026           DFHEIV99,
 10027           DFHEIV99,
 10028           DFHEIV99,
 10029           DFHEIV99,
 10030           DFHEIV99,
 10031           DFHEIV99,
 10032           DFHEIV99,
 10033           DFHEIV99
 10034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10035
 10036
 10037
 10038* EXEC CICS RETURN
 10039*    END-EXEC.
 10040*    MOVE '.(                    &   #00009155' TO DFHEIV0
 10041     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10042     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10043     MOVE X'2020233030303039313535' TO DFHEIV0(25:11)
 10044     CALL 'kxdfhei1' USING DFHEIV0,
 10045           DFHEIV99,
 10046           DFHEIV99,
 10047           DFHEIV99,
 10048           DFHEIV99,
 10049           DFHEIV99
 10050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10051
 10052
 10053 8400-LOG-JOURNAL-RECORD.
 10054     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
 10055     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
 10056
 10057*    EXEC CICS JOURNAL
 10058*        JFILEID  (PI-JOURNAL-FILE-ID)
 10059*        JTYPEID  ('EL')
 10060*        FROM     (JOURNAL-RECORD)
 10061*        LENGTH   (JOURNAL-LENGTH)
 10062*    END-EXEC.
 10063
 10064 8500-DATE-CONVERT.
 10065
 10066* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 208
* EL642.cbl
 10067*        PROGRAM   (LINK-ELDATCV)
 10068*        COMMAREA  (DATE-CONVERSION-DATA)
 10069*        LENGTH    (DC-COMM-LENGTH) END-EXEC.
 10070*    MOVE '."C                   ''   #00009170' TO DFHEIV0
 10071     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10072     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10073     MOVE X'2020233030303039313730' TO DFHEIV0(25:11)
 10074     CALL 'kxdfhei1' USING DFHEIV0,
 10075           LINK-ELDATCV,
 10076           DATE-CONVERSION-DATA,
 10077           DC-COMM-LENGTH,
 10078           DFHEIV99,
 10079           DFHEIV99,
 10080           DFHEIV99
 10081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10082
 10083
 10084 8500-EXIT.
 10085     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 209
* EL642.cbl
 10087 8600-CENTER-DATA.
 10088     MOVE SPACE                  TO  CENTER-WORK-2.
 10089
 10090     IF CW1-PIC (1)  NOT =  SPACE
 10091       AND  CW1-PIC (X-LEN)  NOT =  SPACE
 10092         MOVE CENTER-WORK-1      TO  CENTER-WORK-2
 10093         GO TO 8690-C-D-X.
 10094
 10095     MOVE +0                     TO  X1.
 10096     MOVE X-LEN                  TO  X2.
 10097
 10098 8660-C-D-LOOP-1.
 10099     IF CW1-PIC (X2)  =  SPACE
 10100         ADD +1                  TO  X1
 10101         SUBTRACT +1             FROM  X2
 10102         GO TO 8660-C-D-LOOP-1.
 10103
 10104     MOVE +1                     TO  X2.
 10105
 10106 8670-C-D-LOOP-2.
 10107     IF CW1-PIC (X2)  =  SPACE
 10108         ADD +1                  TO  X1  X2
 10109         GO TO 8670-C-D-LOOP-2.
 10110
 10111     COMPUTE X3 = (X1 / +2) + +1.
 10112     COMPUTE X1 = X-LEN - X1.
 10113
 10114 8680-C-D-LOOP-3.
 10115     IF X1  NOT =  +0
 10116         MOVE CW1-PIC (X2)       TO  CW2-PIC (X3)
 10117         ADD +1                  TO  X2  X3
 10118         SUBTRACT +1             FROM  X1
 10119         GO TO 8680-C-D-LOOP-3.
 10120
 10121 8690-C-D-X.
 10122     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 210
* EL642.cbl
 10124 8800-UNAUTHORIZED-ACCESS.
 10125     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
 10126
 10127     GO TO 8300-SEND-TEXT.
 10128
 10129 8810-PF23.
 10130     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10131     MOVE XCTL-005               TO  PGM-NAME.
 10132
 10133     GO TO 9300-XCTL.
 10134
 10135 8900-SYNCPOINT-ROLLBACK.
 10136
 10137* EXEC CICS SYNCPOINT
 10138*        ROLLBACK
 10139*    END-EXEC.
 10140*    MOVE '6"R                   !   #00009227' TO DFHEIV0
 10141     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10142     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10143     MOVE X'2020233030303039323237' TO DFHEIV0(25:11)
 10144     CALL 'kxdfhei1' USING DFHEIV0
 10145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10146
 10147
 10148
 10149* EXEC CICS DUMP
 10150*        DUMPCODE  ('LGXX')
 10151*        TASK
 10152*    END-EXEC.
 10153     MOVE 'LGXX' TO DFHEIV5
 10154*    MOVE '<"   T                $   #00009231' TO DFHEIV0
 10155     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 10156     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10157     MOVE X'2020233030303039323331' TO DFHEIV0(25:11)
 10158     CALL 'kxdfhei1' USING DFHEIV0,
 10159           DFHEIV5,
 10160           DFHEIV99,
 10161           DFHEIV99
 10162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10163
 10164
 10165 8900-EXIT.
 10166     EXIT.
 10167
 10168 9100-RETURN-TRAN.
 10169     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10170     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10171
 10172
 10173* EXEC CICS RETURN
 10174*        TRANSID   (TRANS-ID)
 10175*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10176*        LENGTH    (PI-COMM-LENGTH)
 10177*    END-EXEC.
 10178*    MOVE '.(CT                  &   #00009243' TO DFHEIV0
 10179     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10180     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10181     MOVE X'2020233030303039323433' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 211
* EL642.cbl
 10182     CALL 'kxdfhei1' USING DFHEIV0,
 10183           TRANS-ID,
 10184           PROGRAM-INTERFACE-BLOCK,
 10185           PI-COMM-LENGTH,
 10186           DFHEIV99,
 10187           DFHEIV99
 10188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10189
 10190
 10191 9200-RETURN-MAIN-MENU.
 10192     MOVE XCTL-626               TO  PGM-NAME.
 10193
 10194     GO TO 9300-XCTL.
 10195
 10196 9300-XCTL.
 10197
 10198* EXEC CICS XCTL
 10199*        PROGRAM   (PGM-NAME)
 10200*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10201*        LENGTH    (PI-COMM-LENGTH)
 10202*    END-EXEC.
 10203*    MOVE '.$C                   $   #00009255' TO DFHEIV0
 10204     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10205     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10206     MOVE X'2020233030303039323535' TO DFHEIV0(25:11)
 10207     CALL 'kxdfhei1' USING DFHEIV0,
 10208           PGM-NAME,
 10209           PROGRAM-INTERFACE-BLOCK,
 10210           PI-COMM-LENGTH
 10211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10212
 10213
 10214 9400-CLEAR.
 10215     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME
 10216
 10217     GO TO 9300-XCTL.
 10218
 10219 9500-PF12.
 10220     MOVE XCTL-010               TO  PGM-NAME.
 10221
 10222     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 212
* EL642.cbl
 10224 9600-PGMID-ERROR.
 10225
 10226* EXEC CICS HANDLE CONDITION
 10227*        PGMIDERR  (8300-SEND-TEXT)
 10228*    END-EXEC.
 10229*    MOVE '"$L                   ! 5 #00009272' TO DFHEIV0
 10230     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10231     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10232     MOVE X'3520233030303039323732' TO DFHEIV0(25:11)
 10233     CALL 'kxdfhei1' USING DFHEIV0
 10234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10235
 10236
 10237     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10238     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10239     MOVE XCTL-005               TO  PGM-NAME.
 10240     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10241     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10242
 10243     GO TO 9300-XCTL.
 10244
 10245 9900-ERROR-FORMAT.
 10246     IF NOT  EMI-ERRORS-COMPLETE
 10247         MOVE LINK-001           TO  PGM-NAME
 10248
 10249* EXEC CICS LINK
 10250*            PROGRAM   (PGM-NAME)
 10251*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 10252*            LENGTH    (EMI-COMM-LENGTH)
 10253*        END-EXEC.
 10254*    MOVE '."C                   ''   #00009287' TO DFHEIV0
 10255     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10256     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10257     MOVE X'2020233030303039323837' TO DFHEIV0(25:11)
 10258     CALL 'kxdfhei1' USING DFHEIV0,
 10259           PGM-NAME,
 10260           ERROR-MESSAGE-INTERFACE-BLOCK,
 10261           EMI-COMM-LENGTH,
 10262           DFHEIV99,
 10263           DFHEIV99,
 10264           DFHEIV99
 10265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10266
 10267
 10268 9900-EXIT.
 10269     EXIT.
 10270
 10271 9990-ABEND.
 10272     MOVE LINK-004               TO  PGM-NAME.
 10273     MOVE DFHEIBLK               TO  EMI-LINE1
 10274
 10275
 10276* EXEC CICS LINK
 10277*        PROGRAM   (PGM-NAME)
 10278*        COMMAREA  (EMI-LINE1)
 10279*        LENGTH    (72)
 10280*    END-EXEC.
 10281     MOVE 72
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 213
* EL642.cbl
 10282       TO DFHEIV11
 10283*    MOVE '."C                   ''   #00009300' TO DFHEIV0
 10284     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10285     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10286     MOVE X'2020233030303039333030' TO DFHEIV0(25:11)
 10287     CALL 'kxdfhei1' USING DFHEIV0,
 10288           PGM-NAME,
 10289           EMI-LINE1,
 10290           DFHEIV11,
 10291           DFHEIV99,
 10292           DFHEIV99,
 10293           DFHEIV99
 10294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10295
 10296
 10297     IF PI-MAP-NAME  =  EL642A
 10298         MOVE -1                 TO  APFNTERL
 10299     ELSE
 10300         MOVE -1                 TO  BPFNTERL.
 10301
 10302     GO TO 8200-SEND-DATAONLY.
 10303
 10304 9995-SECURITY-VIOLATION.
 10305*                            COPY ELCSCTP.
 10306******************************************************************
 10307*                                                                *
 10308*                            ELCSCTP                             *
 10309*                            VMOD=2.001                          *
 10310*                                                                *
 10311*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10312******************************************************************
 10313
 10314
 10315     MOVE EIBDATE          TO SM-JUL-DATE.
 10316     MOVE EIBTRMID         TO SM-TERMID.
 10317     MOVE THIS-PGM         TO SM-PGM.
 10318     MOVE EIBTIME          TO TIME-IN.
 10319     MOVE TIME-OUT         TO SM-TIME.
 10320     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10321
 10322
 10323* EXEC CICS LINK
 10324*         PROGRAM  ('EL003')
 10325*         COMMAREA (SECURITY-MESSAGE)
 10326*         LENGTH   (80)
 10327*    END-EXEC.
 10328     MOVE 'EL003' TO DFHEIV1
 10329     MOVE 80
 10330       TO DFHEIV11
 10331*    MOVE '."C                   ''   #00009331' TO DFHEIV0
 10332     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10333     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10334     MOVE X'2020233030303039333331' TO DFHEIV0(25:11)
 10335     CALL 'kxdfhei1' USING DFHEIV0,
 10336           DFHEIV1,
 10337           SECURITY-MESSAGE,
 10338           DFHEIV11,
 10339           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 214
* EL642.cbl
 10340           DFHEIV99,
 10341           DFHEIV99
 10342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10343
 10344
 10345******************************************************************
 10346
 10347
 10348 9999-DFHBACK SECTION.
 10349     MOVE '9%                    "   ' TO DFHEIV0
 10350     MOVE 'EL642' TO DFHEIV1
 10351     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10352     GOBACK.
 10353 9999-DFHEXIT.
 10354     IF DFHEIGDJ EQUAL 0001
 10355         NEXT SENTENCE
 10356     ELSE IF DFHEIGDJ EQUAL 2
 10357         GO TO 9600-PGMID-ERROR,
 10358               9990-ABEND
 10359         DEPENDING ON DFHEIGDI
 10360     ELSE IF DFHEIGDJ EQUAL 3
 10361         GO TO 0890-EXIT
 10362         DEPENDING ON DFHEIGDI
 10363     ELSE IF DFHEIGDJ EQUAL 4
 10364         GO TO 3930-BILL-NOTFND
 10365         DEPENDING ON DFHEIGDI
 10366     ELSE IF DFHEIGDJ EQUAL 5
 10367         GO TO 3940-EXIT
 10368         DEPENDING ON DFHEIGDI
 10369     ELSE IF DFHEIGDJ EQUAL 6
 10370         GO TO 4010-REC-NOT-FND
 10371         DEPENDING ON DFHEIGDI
 10372     ELSE IF DFHEIGDJ EQUAL 7
 10373         GO TO 4110-END-OF-FILE
 10374         DEPENDING ON DFHEIGDI
 10375     ELSE IF DFHEIGDJ EQUAL 8
 10376         GO TO 4290-REC-NOT-FND
 10377         DEPENDING ON DFHEIGDI
 10378     ELSE IF DFHEIGDJ EQUAL 9
 10379         GO TO 4370-ACCOUNT-INVALID
 10380         DEPENDING ON DFHEIGDI
 10381     ELSE IF DFHEIGDJ EQUAL 10
 10382         GO TO 4510-REC-NOT-FND
 10383         DEPENDING ON DFHEIGDI
 10384     ELSE IF DFHEIGDJ EQUAL 11
 10385         GO TO 4610-END-OF-FILE
 10386         DEPENDING ON DFHEIGDI
 10387     ELSE IF DFHEIGDJ EQUAL 12
 10388         GO TO 6070-NO-COMP-MSTR
 10389         DEPENDING ON DFHEIGDI
 10390     ELSE IF DFHEIGDJ EQUAL 13
 10391         GO TO 6110-NO-RECORD
 10392         DEPENDING ON DFHEIGDI
 10393     ELSE IF DFHEIGDJ EQUAL 14
 10394         GO TO 6410-NOT-FOUND
 10395         DEPENDING ON DFHEIGDI
 10396     ELSE IF DFHEIGDJ EQUAL 15
 10397         GO TO 6610-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 215
* EL642.cbl
 10398         DEPENDING ON DFHEIGDI
 10399     ELSE IF DFHEIGDJ EQUAL 16
 10400         GO TO 6660-START-BROWSE,
 10401               6700-COMM-EXIT
 10402         DEPENDING ON DFHEIGDI
 10403     ELSE IF DFHEIGDJ EQUAL 17
 10404         GO TO 6700-COMM-EXIT,
 10405               6700-COMM-EXIT
 10406         DEPENDING ON DFHEIGDI
 10407     ELSE IF DFHEIGDJ EQUAL 18
 10408         GO TO 6700-COMM-EXIT,
 10409               6700-COMM-EXIT
 10410         DEPENDING ON DFHEIGDI
 10411     ELSE IF DFHEIGDJ EQUAL 19
 10412         GO TO 6710-NOT-FOUND
 10413         DEPENDING ON DFHEIGDI
 10414     ELSE IF DFHEIGDJ EQUAL 20
 10415         GO TO 6880-NOT-FOUND
 10416         DEPENDING ON DFHEIGDI
 10417     ELSE IF DFHEIGDJ EQUAL 21
 10418         GO TO 8300-SEND-TEXT
 10419         DEPENDING ON DFHEIGDI.
 10420     MOVE '9%                    "   ' TO DFHEIV0
 10421     MOVE 'EL642' TO DFHEIV1
 10422     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10423     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8016     Code:       29716
