* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   1
* EL151.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL151.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL151.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL151 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/06/95 13:08:11.
     7*                            VMOD=2.012.
     8*
     9*AUTHOR.    LOGIC, INC.
    10*           DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   2
* EL151.cbl
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24******************************************************************
    25*                   C H A N G E   L O G
    26*
    27* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    28*-----------------------------------------------------------------
    29*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    30* EFFECTIVE    NUMBER
    31*-----------------------------------------------------------------
    32* 050506    2006030600001  AJRA  ADD PROOF DATE TO DENIAL SCREEN
    33* 120808    2008100900001  PEMA  ADD FOR DENIAL CODE
    34******************************************************************
    35*REMARKS.
    36
    37*    SCREENS     - EL151S - DENIALS
    38
    39*    ENTERED BY  - EL150 - STATUS AND DISPOSITION
    40
    41*    EXIT TO     - EL150 - CALLING PROGRAM
    42
    43*    INPUT FILE  - ELMSTR - CLAIM MASTER
    44*                - ELTRLR - ACTIVITY TRAILERS
    45*                - ERNOTE - CERTIFICATE NOTES
    46
    47*    OUTPUT FILE - ELMSTR - CLAIM MASTER
    48*                - ELTRLR - ACTIVITY TRAILERS
    49
    50*    COMMAREA    - PASSED
    51
    52*    ERROR-CODES ACCESSED - 132,  133, 270, 137, 29, 315, 008, 50
    53
    54*    NARRATIVE   - 1- PROVIDE CREATION OF DENIAL TRAILERS
    55*                  2- UPDATE CLAIM STATUS TYPE TO CLOSED (ELMSTR)
    56*                  3- UPDATE RESERVE-EXPENSE TRAILER STATUS TO
    57*                     CLOSED, REASON DENIAL
    58
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   3
* EL151.cbl
    60 ENVIRONMENT DIVISION.
    61
    62 DATA DIVISION.
    63
    64 WORKING-STORAGE SECTION.
    65 01  DFH-START PIC X(04).
    66
    67 77  FILLER  PIC X(32)  VALUE '********************************'.
    68 77  FILLER  PIC X(32)  VALUE '*   EL151  WORKING STORAGE     *'.
    69 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.012 ********'.
    70
    71*                            COPY ELCSCTM.
    72******************************************************************
    73*                                                                *
    74*                                                                *
    75*                            ELCSCTM                             *
    76*                            VMOD=2.001                          *
    77*                                                                *
    78*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    79*                                                                *
    80******************************************************************
    81 01  SECURITY-MESSAGE.
    82     12  FILLER                          PIC X(30)
    83            VALUE '** LOGIC SECURITY VIOLATION -'.
    84     12  SM-READ                         PIC X(6).
    85     12  FILLER                          PIC X(5)
    86            VALUE ' PGM='.
    87     12  SM-PGM                          PIC X(6).
    88     12  FILLER                          PIC X(5)
    89            VALUE ' OPR='.
    90     12  SM-PROCESSOR-ID                 PIC X(4).
    91     12  FILLER                          PIC X(6)
    92            VALUE ' TERM='.
    93     12  SM-TERMID                       PIC X(4).
    94     12  FILLER                          PIC XX   VALUE SPACE.
    95     12  SM-JUL-DATE                     PIC 9(5).
    96     12  FILLER                          PIC X    VALUE SPACE.
    97     12  SM-TIME                         PIC 99.99.
    98
    99
   100*                            COPY ELCSCRTY.
   101******************************************************************
   102*                                                                *
   103*                                                                *
   104*                            ELCSCRTY                            *
   105*                            VMOD=2.001                          *
   106*                                                                *
   107*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   108*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   109*        SAVED IN PI-SECURITY-ADDRESS.                           *
   110*                                                                *
   111******************************************************************
   112 01  SECURITY-CONTROL.
   113     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   114     12  FILLER                       PIC XX    VALUE 'SC'.
   115     12  SC-CREDIT-CODES.
   116         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   117             20  SC-CREDIT-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   4
* EL151.cbl
   118             20  SC-CREDIT-UPDATE     PIC X.
   119     12  SC-CLAIMS-CODES.
   120         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   121             20  SC-CLAIMS-DISPLAY    PIC X.
   122             20  SC-CLAIMS-UPDATE     PIC X.
   123
   124*                            COPY ELCNWA.
   125*****************************************************************
   126*                                                               *
   127*                                                               *
   128*                            ELCNWA.                            *
   129*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   130*                            VMOD=2.003                         *
   131*                                                               *
   132*            M O V E   N A M E   W O R K   A R E A.             *
   133*                                                               *
   134*****************************************************************.
   135
   136 01  WS-NAME-WORK-AREA.
   137     05  WS-INSURED-LAST-NAME        PIC X(15).
   138     05  WS-INSURED-1ST-NAME         PIC X(12).
   139     05  WS-INSURED-MID-INIT         PIC X.
   140
   141     05  WS-NAME-WORK.
   142         10  WS-NW                   PIC X
   143             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   144
   145     05  WS-NAME-WORK2.
   146         10  WS-NW2                  PIC X
   147             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   148                                        NWA-INDEX0.
   149
   150     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   151                                     COMP-3.
   152
   153
   154 01  WS-DATE-AREA.
   155     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   156     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   157     05  WS-BLANK            PIC X       VALUE ' '.
   158
   159 01  WS-SCRATCH-AREA.
   160     05  GETMAIN-SPACE               PIC X     VALUE SPACE.
   161     05  WS-TRLR-LENGTH              PIC S9(4) VALUE +200  COMP.
   162     05  WS-DMO-LENGTH               PIC S9(4) VALUE +108  COMP.
   163     05  WS-DCT-LENGTH               PIC S9(4) VALUE +53   COMP.
   164     05  SC-ITEM                     PIC S9(4) VALUE +0001 COMP.
   165
   166     05  WS-TRANS-ID                 PIC X(4)   VALUE 'EX32'.
   167     05  WS-SEQ-NO-SAVED             PIC S9(4)   VALUE ZEROS.
   168
   169     05  WS-ORIG-SEQ-CNT             PIC S9(4)   VALUE ZEROS.
   170
   171     05  TR-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   172     05  TR-SUB-2                    PIC S9(4)   VALUE ZERO  COMP.
   173     05  MISC-SUB                    PIC S9(03)  COMP-3  VALUE +0.
   174
   175     05  MAP-NAME                    PIC X(08)   VALUE 'EL151A'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   5
* EL151.cbl
   176     05  MAPSET-NAME                 PIC X(08)   VALUE 'EL151S'.
   177
   178     05  ELTRLR-FILE-ID              PIC X(08)   VALUE 'ELTRLR'.
   179     05  ELMSTR-FILE-ID              PIC X(08)   VALUE 'ELMSTR'.
   180     05  ELCNTL-FILE-ID              PIC X(08)   VALUE 'ELCNTL'.
   181     05  ELARCH-FILE-ID              PIC X(08)   VALUE 'ELARCH'.
   182
   183     05  THIS-PGM                    PIC X(08)   VALUE  'EL151'.
   184
   185     05  WS-OC-LOAD-SW               PIC X(01)   VALUE SPACE.
   186         88  OC-HISTORY-LOADED       VALUE 'X'.
   187
   188     05  WS-CLAIM-SEQ-SW             PIC X(01)   VALUE SPACE.
   189         88  NO-SEQ-NUMBER           VALUE 'X'.
   190         88  SEQ-NUMBER-EXIST        VALUE ' '.
   191         88  NO-ACCT-TRLR            VALUE 'Y'.
   192
   193     05  WS-RESET-SW                 PIC X(01)   VALUE 'N'.
   194     05  WS-REC-FOUND-SW             PIC X(01)   VALUE 'N'.
   195     05  WS-BROWSE-SW                PIC X(01)   VALUE 'N'.
   196     05  WS-UPDATE-SW                PIC X(01)   VALUE 'N'.
   197
   198     05  TIME-IN                     PIC S9(7).
   199     05  TIME-OUT-R REDEFINES TIME-IN.
   200         10  FILLER                  PIC X(01).
   201         10  TIME-OUT                PIC 99V99.
   202         10  FILLER                  PIC X(02).
   203
   204     05  DEEDIT-FIELD                PIC X(15).
   205     05  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   206
   207     05  WS-PRF-DT                   PIC X(2).
   208     05  WS-MAX-LETTER-ANSWER-DT     PIC X(2)  VALUE LOW-VALUES.
   209
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   6
* EL151.cbl
   211     05  DENIAL-TABLE.
   212         10  FILLER                  PIC X(44)    VALUE
   213             'DPE  PRE-EXISTING DISABILITY                '.
   214         10  FILLER                  PIC X(44)    VALUE
   215             'DDN  DISABILITY NOT COVERED DUE TO NATURE   '.
   216         10  FILLER                  PIC X(44)    VALUE
   217             'DIR  INSURED RECOVERED FROM DISABILITY      '.
   218         10  FILLER                  PIC X(44)    VALUE
   219             'DEM  EMPLOYMENT INDICATES OCCUPATION NOT MET'.
   220         10  FILLER                  PIC X(44)    VALUE
   221             'DWP  DISABILITY WAITING PERIOD NOT SATISFIED'.
   222         10  FILLER                  PIC X(44)    VALUE
   223             'DNC  NO COVERAGE                            '.
   224         10  FILLER                  PIC X(44)    VALUE
   225             'DAP  APPLICATION MISREPRESENTATION          '.
   226         10  FILLER                  PIC X(44)    VALUE
   227             'DMA  MIS-STATEMENT OF AGE                   '.
   228         10  FILLER                  PIC X(44)    VALUE
   229             'DSU  SUICIDE OR SELF-INFLICTED INJURY       '.
   230         10  FILLER                  PIC X(44)    VALUE
   231             'DOT  OTHER                                  '.
   232         10  FILLER                  PIC X(44)    VALUE
   233             'DAR  AWARE OF UNEMPLOY./RED. AT INCEPTION   '.
   234         10  FILLER                  PIC X(44)    VALUE
   235             'DNE  NOT EMPLOYED SIX MONTHS PRIOR          '.
   236         10  FILLER                  PIC X(44)    VALUE
   237             'DNR  NOT MADE REDUNDANT/NOT UNEMPLOYED      '.
   238         10  FILLER                  PIC X(44)    VALUE
   239             'DSE  SELF EMPLOYED                          '.
   240         10  FILLER                  PIC X(44)    VALUE
   241             'DTW  TEMPORARY WORK                         '.
   242         10  FILLER                  PIC X(44)    VALUE
   243             'LAP  APPLICATION MISREPRESENTATION          '.
   244         10  FILLER                  PIC X(44)    VALUE
   245             'LMA  MIS-STATEMENT OF AGE                   '.
   246         10  FILLER                  PIC X(44)    VALUE
   247             'LNC  NO COVERAGE                            '.
   248         10  FILLER                  PIC X(44)    VALUE
   249             'LOT  OTHER                                  '.
   250     05  DEN-TABLE REDEFINES DENIAL-TABLE OCCURS 19
   251         INDEXED BY DEN-INDEX.
   252         10  DENIAL-CODE.
   253             15  DENIAL-1-1          PIC X(01).
   254             15  DENIAL-2-3          PIC X(02).
   255             15  DENIAL-4-4          PIC X(01).
   256         10  FILLER                  PIC X(01).
   257         10  DENIAL-DESC             PIC X(39).
   258
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   7
* EL151.cbl
   260 01  ACCESS-KEYS.
   261     05  WS-TRAILER-KEY.
   262         10  WS-CLAIM-KEY.
   263             15  WS-KEY-COMPANY-CD       PIC X.
   264             15  WS-KEY-CARRIER          PIC X.
   265             15  WS-KEY-CLAIM-NO         PIC X(7).
   266             15  WS-KEY-CERT-NO.
   267                 20  WS-KEY-CERT-PRIME   PIC X(10).
   268                 20  WS-KEY-CERT-SFX     PIC X.
   269         10  WS-KEY-SEQUENCE-NO      PIC   S9(4) COMP.
   270
   271     05  ELARCH-KEY.
   272         10  ELARCH-COMPANY-CD   PIC X(01).
   273         10  ELARCH-ARCHIVE-NO   PIC S9(08)  COMP.
   274         10  ELARCH-RECORD-TYPE  PIC X(01).
   275         10  ELARCH-SEQ-NO       PIC S9(04)  COMP.
   276
   277     05  WS-ELDENY-KEY.
   278         10  ELDENY-COMPANY-CD   PIC X.
   279         10  ELDENY-DENIAL-CODE  PIC X(4).
   280         10  FILLER              PIC X(10).
   281     05  ELCNTL-KEY.
   282         10  ELCNTL-COMPANY-ID   PIC X(03).
   283         10  ELCNTL-RECORD-TYPE  PIC X(01).
   284         10  ELCNTL-ACCESS       PIC X(04).
   285         10  ELCNTL-SEQ-NO       PIC S9(04)  COMP.
   286
   287     05  W-NOTE-KEY.
   288         10  W-NOTE-COMP-CD      PIC X.
   289         10  W-NOTE-CERT-KEY.
   290             16  W-NOTE-CARRIER  PIC X.
   291             16  W-NOTE-GROUPING PIC X(6).
   292             16  W-NOTE-STATE    PIC XX.
   293             16  W-NOTE-ACCOUNT  PIC X(10).
   294             16  W-NOTE-EFF-DT   PIC XX.
   295             16  W-NOTE-CERT-NO  PIC X(11).
   296
   297 01  WS-RESPONSE             PIC S9(8)   COMP.
   298     88  RESP-NORMAL              VALUE +00.
   299     88  RESP-ERROR               VALUE +01.
   300     88  RESP-NOTFND              VALUE +13.
   301     88  RESP-NOTOPEN             VALUE +19.
   302     88  RESP-ENDFILE             VALUE +20.
   303 01  ERROR-MESSAGES.
   304     12  ER-0000                 PIC X(4)  VALUE '0000'.
   305     12  ER-0004                 PIC X(4)  VALUE '0004'.
   306     12  ER-0008                 PIC X(4)  VALUE '0008'.
   307     12  ER-0021                 PIC X(4)  VALUE '0021'.
   308     12  ER-0029                 PIC X(4)  VALUE '0029'.
   309     12  ER-0050                 PIC X(4)  VALUE '0050'.
   310     12  ER-0070                 PIC X(4)  VALUE '0070'.
   311     12  ER-0132                 PIC X(4)  VALUE '0132'.
   312     12  ER-0133                 PIC X(4)  VALUE '0133'.
   313     12  ER-0137                 PIC X(4)  VALUE '0137'.
   314     12  ER-0154                 PIC X(4)  VALUE '0154'.
   315     12  ER-0172                 PIC X(4)  VALUE '0172'.
   316     12  ER-0270                 PIC X(4)  VALUE '0270'.
   317     12  ER-0483                 PIC X(4)  VALUE '0483'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   8
* EL151.cbl
   318     12  ER-0872                 PIC X(4)  VALUE '0872'.
   319     12  ER-0873                 PIC X(4)  VALUE '0873'.
   320     12  ER-0884                 PIC X(4)  VALUE '0884'.
   321     12  ER-0919                 PIC X(4)  VALUE '0919'.
   322     12  ER-0921                 PIC X(4)  VALUE '0921'.
   323     12  ER-0946                 PIC X(4)  VALUE '0946'.
   324     12  ER-0947                 PIC X(4)  VALUE '0947'.
   325     12  ER-0948                 PIC X(4)  VALUE '0948'.
   326     12  ER-0949                 PIC X(4)  VALUE '0949'.
   327     12  ER-0950                 PIC X(4)  VALUE '0950'.
   328     12  ER-0951                 PIC X(4)  VALUE '0951'.
   329     12  ER-0954                 PIC X(4)  VALUE '0954'.
   330     12  ER-0974                 PIC X(4)  VALUE '0974'.
   331     12  ER-0975                 PIC X(4)  VALUE '0975'.
   332     12  ER-8051                 PIC X(4)  VALUE '8051'.
   333     12  ER-8052                 PIC X(4)  VALUE '8052'.
   334     12  ER-8053                 PIC X(4)  VALUE '8053'.
   335     12  ER-8054                 PIC X(4)  VALUE '8054'.
   336     12  ER-8055                 PIC X(4)  VALUE '8055'.
   337     12  ER-8056                 PIC X(4)  VALUE '8056'.
   338     12  ER-8057                 PIC X(4)  VALUE '8057'.
   339     12  ER-8058                 PIC X(4)  VALUE '8058'.
   340     12  ER-8059                 PIC X(4)  VALUE '8059'.
   341     12  ER-8060                 PIC X(4)  VALUE '8060'.
   342     12  ER-8061                 PIC X(4)  VALUE '8061'.
   343     12  ER-8062                 PIC X(4)  VALUE '8062'.
   344     12  ER-8063                 PIC X(4)  VALUE '8063'.
   345     12  ER-8064                 PIC X(4)  VALUE '8064'.
   346     12  ER-8065                 PIC X(4)  VALUE '8065'.
   347     12  ER-8066                 PIC X(4)  VALUE '8066'.
   348     12  ER-8152                 PIC X(4)  VALUE '8152'.
   349     12  ER-8153                 PIC X(4)  VALUE '8153'.
   350     12  ER-8154                 PIC X(4)  VALUE '8154'.
   351     12  ER-8155                 PIC X(4)  VALUE '8155'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   9
* EL151.cbl
   353*                                    COPY ELCAID.
   354******************************************************************
   355*                                                                *
   356*                            ELCAID.                             *
   357*                            VMOD=2.001                          *
   358*                                                                *
   359*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   360*                                                                *
   361*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   362*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   363******************************************************************
   364
   365 01  DFHAID.
   366   02  DFHNULL   PIC  X  VALUE  ' '.
   367   02  DFHENTER  PIC  X  VALUE  QUOTE.
   368   02  DFHCLEAR  PIC  X  VALUE  '_'.
   369   02  DFHPEN    PIC  X  VALUE  '='.
   370   02  DFHOPID   PIC  X  VALUE  'W'.
   371   02  DFHPA1    PIC  X  VALUE  '%'.
   372   02  DFHPA2    PIC  X  VALUE  '>'.
   373   02  DFHPA3    PIC  X  VALUE  ','.
   374   02  DFHPF1    PIC  X  VALUE  '1'.
   375   02  DFHPF2    PIC  X  VALUE  '2'.
   376   02  DFHPF3    PIC  X  VALUE  '3'.
   377   02  DFHPF4    PIC  X  VALUE  '4'.
   378   02  DFHPF5    PIC  X  VALUE  '5'.
   379   02  DFHPF6    PIC  X  VALUE  '6'.
   380   02  DFHPF7    PIC  X  VALUE  '7'.
   381   02  DFHPF8    PIC  X  VALUE  '8'.
   382   02  DFHPF9    PIC  X  VALUE  '9'.
   383   02  DFHPF10   PIC  X  VALUE  ':'.
   384   02  DFHPF11   PIC  X  VALUE  '#'.
   385   02  DFHPF12   PIC  X  VALUE  '@'.
   386   02  DFHPF13   PIC  X  VALUE  'A'.
   387   02  DFHPF14   PIC  X  VALUE  'B'.
   388   02  DFHPF15   PIC  X  VALUE  'C'.
   389   02  DFHPF16   PIC  X  VALUE  'D'.
   390   02  DFHPF17   PIC  X  VALUE  'E'.
   391   02  DFHPF18   PIC  X  VALUE  'F'.
   392   02  DFHPF19   PIC  X  VALUE  'G'.
   393   02  DFHPF20   PIC  X  VALUE  'H'.
   394   02  DFHPF21   PIC  X  VALUE  'I'.
   395*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   396   02  DFHPF22   PIC  X  VALUE  '['.
   397   02  DFHPF23   PIC  X  VALUE  '.'.
   398   02  DFHPF24   PIC  X  VALUE  '<'.
   399   02  DFHMSRE   PIC  X  VALUE  'X'.
   400   02  DFHSTRF   PIC  X  VALUE  'h'.
   401   02  DFHTRIG   PIC  X  VALUE  '"'.
   402 01  PF-AID REDEFINES DFHAID.
   403     05  FILLER                      PIC X(8).
   404     05  PF-VALUES  OCCURS 24        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  10
* EL151.cbl
   406*                                    COPY ELCINTF.
   407******************************************************************
   408*                                                                *
   409*                                                                *
   410*                            ELCINTF.                            *
   411*                            VMOD=2.017                          *
   412*                                                                *
   413*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   414*                                                                *
   415*       LENGTH = 1024                                            *
   416*                                                                *
   417******************************************************************
   418 01  PROGRAM-INTERFACE-BLOCK.
   419     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   420     12  PI-CALLING-PROGRAM              PIC X(8).
   421     12  PI-SAVED-PROGRAM-1              PIC X(8).
   422     12  PI-SAVED-PROGRAM-2              PIC X(8).
   423     12  PI-SAVED-PROGRAM-3              PIC X(8).
   424     12  PI-SAVED-PROGRAM-4              PIC X(8).
   425     12  PI-SAVED-PROGRAM-5              PIC X(8).
   426     12  PI-SAVED-PROGRAM-6              PIC X(8).
   427     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   428     12  PI-COMPANY-ID                   PIC XXX.
   429     12  PI-COMPANY-CD                   PIC X.
   430
   431     12  PI-COMPANY-PASSWORD             PIC X(8).
   432
   433     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   434
   435     12  PI-CONTROL-IN-PROGRESS.
   436         16  PI-CARRIER                  PIC X.
   437         16  PI-GROUPING                 PIC X(6).
   438         16  PI-STATE                    PIC XX.
   439         16  PI-ACCOUNT                  PIC X(10).
   440         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   441                                         PIC X(10).
   442         16  PI-CLAIM-CERT-GRP.
   443             20  PI-CLAIM-NO             PIC X(7).
   444             20  PI-CERT-NO.
   445                 25  PI-CERT-PRIME       PIC X(10).
   446                 25  PI-CERT-SFX         PIC X.
   447             20  PI-CERT-EFF-DT          PIC XX.
   448         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   449             20  PI-PLAN-CODE            PIC X(2).
   450             20  PI-REVISION-NUMBER      PIC X(3).
   451             20  PI-PLAN-EFF-DT          PIC X(2).
   452             20  PI-PLAN-EXP-DT          PIC X(2).
   453             20  FILLER                  PIC X(11).
   454         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   455             20  PI-OE-REFERENCE-1.
   456                 25  PI-OE-REF-1-PRIME   PIC X(18).
   457                 25  PI-OE-REF-1-SUFF    PIC XX.
   458
   459     12  PI-SESSION-IN-PROGRESS          PIC X.
   460         88  CLAIM-SESSION                   VALUE '1'.
   461         88  CREDIT-SESSION                  VALUE '2'.
   462         88  WARRANTY-SESSION                VALUE '3'.
   463         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  11
* EL151.cbl
   464         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   465
   466
   467*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   468
   469     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   470     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   471
   472     12  PI-CREDIT-USER                  PIC X.
   473         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   474         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   475
   476     12  PI-CLAIM-USER                   PIC X.
   477         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   478         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   479
   480     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   481         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   482         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   483         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   484         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   485         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   486
   487     12  PI-PROCESSOR-ID                 PIC X(4).
   488
   489     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   490
   491     12  PI-MEMBER-CAPTION               PIC X(10).
   492
   493     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   494         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   495
   496     12  PI-LIFE-OVERRIDE-L1             PIC X.
   497     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   498     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   499     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   500
   501     12  PI-AH-OVERRIDE-L1               PIC X.
   502     12  PI-AH-OVERRIDE-L2               PIC XX.
   503     12  PI-AH-OVERRIDE-L6               PIC X(6).
   504     12  PI-AH-OVERRIDE-L12              PIC X(12).
   505
   506     12  PI-NEW-SYSTEM                   PIC X(2).
   507
   508     12  PI-PRIMARY-CERT-NO              PIC X(11).
   509     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   510         88  PI-USES-PAID-TO                 VALUE '1'.
   511     12  PI-CRDTCRD-SYSTEM.
   512         16  PI-CRDTCRD-USER             PIC X.
   513             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   514             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   515         16  PI-CC-MONTH-END-DT          PIC XX.
   516     12  PI-PROCESSOR-PRINTER            PIC X(4).
   517
   518     12  PI-OE-REFERENCE-2.
   519         16  PI-OE-REF-2-PRIME           PIC X(10).
   520         16  PI-OE-REF-2-SUFF            PIC X.
   521
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  12
* EL151.cbl
   522     12  PI-REM-TRM-CALC-OPTION          PIC X.
   523
   524     12  PI-LANGUAGE-TYPE                PIC X.
   525             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   526             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   527             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   528
   529     12  PI-POLICY-LINKAGE-IND           PIC X.
   530         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   531         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   532                                                   LOW-VALUES.
   533
   534     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   535     12  PI-CLAIM-PW-SESSION             PIC X(1).
   536         88  PI-CLAIM-CREDIT                 VALUE '1'.
   537         88  PI-CLAIM-CONVEN                 VALUE '2'.
   538     12  FILLER                          PIC X(4).
   539
   540     12  PI-SYSTEM-LEVEL                 PIC X(145).
   541
   542     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   543         PI-SYSTEM-LEVEL.
   544
   545         16  PI-ENTRY-CODES.
   546             20  PI-ENTRY-CD-1           PIC X.
   547             20  PI-ENTRY-CD-2           PIC X.
   548
   549         16  PI-RETURN-CODES.
   550             20  PI-RETURN-CD-1          PIC X.
   551             20  PI-RETURN-CD-2          PIC X.
   552
   553         16  PI-UPDATE-STATUS-SAVE.
   554             20  PI-UPDATE-BY            PIC X(4).
   555             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   556
   557         16  PI-LOWER-CASE-LETTERS       PIC X.
   558             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   559
   560*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   561*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   562*            88  CARRIER-CLM-CNTL            VALUE '2'.
   563
   564         16  PI-CERT-ACCESS-CONTROL      PIC X.
   565             88  ST-ACCNT-CNTL               VALUE ' '.
   566             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   567             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   568             88  ACCNT-CNTL                  VALUE '3'.
   569             88  CARR-ACCNT-CNTL             VALUE '4'.
   570
   571         16  PI-PROCESSOR-CAP-LIST.
   572             20  PI-SYSTEM-CONTROLS.
   573                24 PI-SYSTEM-DISPLAY     PIC X.
   574                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   575                24 PI-SYSTEM-MODIFY      PIC X.
   576                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   577             20  FILLER                  PIC XX.
   578             20  PI-DISPLAY-CAP          PIC X.
   579                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  13
* EL151.cbl
   580             20  PI-MODIFY-CAP           PIC X.
   581                 88  MODIFY-CAP              VALUE 'Y'.
   582             20  PI-MSG-AT-LOGON-CAP     PIC X.
   583                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   584             20  PI-FORCE-CAP            PIC X.
   585                 88  FORCE-CAP               VALUE 'Y'.
   586
   587         16  PI-PROGRAM-CONTROLS.
   588             20  PI-PGM-PRINT-OPT        PIC X.
   589             20  PI-PGM-FORMAT-OPT       PIC X.
   590             20  PI-PGM-PROCESS-OPT      PIC X.
   591             20  PI-PGM-TOTALS-OPT       PIC X.
   592
   593         16  PI-HELP-INTERFACE.
   594             20  PI-LAST-ERROR-NO        PIC X(4).
   595             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   596
   597         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   598             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   599
   600         16  PI-CR-CONTROL-IN-PROGRESS.
   601             20  PI-CR-CARRIER           PIC X.
   602             20  PI-CR-GROUPING          PIC X(6).
   603             20  PI-CR-STATE             PIC XX.
   604             20  PI-CR-ACCOUNT           PIC X(10).
   605             20  PI-CR-FIN-RESP          PIC X(10).
   606             20  PI-CR-TYPE              PIC X.
   607
   608         16  PI-CR-BATCH-NUMBER          PIC X(6).
   609
   610         16  PI-CR-MONTH-END-DT          PIC XX.
   611
   612         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   613             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   614             88  PI-ZERO-CARRIER             VALUE '1'.
   615             88  PI-ZERO-GROUPING            VALUE '2'.
   616             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   617
   618         16  PI-CARRIER-SECURITY         PIC X.
   619             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   620
   621         16  PI-ACCOUNT-SECURITY         PIC X(10).
   622             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   623             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   624
   625         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   626             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   627                                         INDEXED BY PI-ACCESS-NDX
   628                                         PIC X.
   629
   630         16  PI-GA-BILLING-CONTROL       PIC X.
   631             88  PI-GA-BILLING               VALUE '1'.
   632
   633         16  PI-MAIL-PROCESSING          PIC X.
   634             88  PI-MAIL-YES                 VALUE 'Y'.
   635
   636         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   637
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  14
* EL151.cbl
   638         16  PI-AR-SYSTEM.
   639             20  PI-AR-PROCESSING-CNTL   PIC X.
   640                 88  PI-AR-PROCESSING        VALUE 'Y'.
   641             20  PI-AR-SUMMARY-CODE      PIC X(6).
   642             20  PI-AR-MONTH-END-DT      PIC XX.
   643
   644         16  PI-MP-SYSTEM.
   645             20  PI-MORTGAGE-USER            PIC X.
   646                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   647                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   648             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   649                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   650                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   651                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   652                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   653                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   654             20  PI-MP-MONTH-END-DT          PIC XX.
   655             20  PI-MP-REFERENCE-NO.
   656                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   657                 24  PI-MP-REFERENCE-SFX     PIC XX.
   658
   659         16  PI-LABEL-CONTROL            PIC X(01).
   660             88  PI-CREATE-LABELS                    VALUE 'Y'.
   661             88  PI-BYPASS-LABELS                    VALUE 'N'.
   662
   663         16  PI-BILL-GROUPING-CODE       PIC X(01).
   664             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   665
   666         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   667             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   668             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   669
   670         16  FILLER                      PIC X(14).
   671
   672     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   673******************************************************************
   674     12  PI-REDEFINES REDEFINES PI-PROGRAM-WORK-AREA.
   675         16  PI-PREV-TRLR-KEY        PIC X(22).
   676*00252          16  FILLER                  PIC X(618).
   677         16  PI-PROOF-DATE           PIC 9(6).
   678         16  FILLER                  PIC X(612).
   679
   680* DLO023
   681 01  DL23-COMM-LENGTH              PIC S9(4) COMP VALUE +132.
   682 01  WS-DLO-CODES-TABLE.
   683     12  DL23-SYSTEM-ID            PIC XX.
   684     12  DL23-RECORD-TYPE          PIC XX.
   685     12  DL23-RECORD-KEY           PIC X(6).
   686     12  DL23-RETURN-CODE          PIC XX.
   687     12  DL23-CODE-DESC.
   688         16  DL23-CODE-TEXT        PIC X(20).
   689         16  DL23-RET-CODE         PIC X(40).
   690     12  DL23-GEN-DESC-1           PIC X(20).
   691     12  DL23-GEN-DESC-2           PIC X(20).
   692     12  DL23-GEN-DESC-3           PIC X(20).
   693
   694 01  DMD-DATE-YYYYMMDD.
   695     12  DMD-DECADE          PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  15
* EL151.cbl
   696     12  DMD-YYMMDD.
   697         16  DMD-YY          PIC XX      VALUE SPACES.
   698         16  DMD-MM          PIC XX      VALUE SPACES.
   699         16  DMD-DD          PIC XX      VALUE SPACES.
   700
   701     12  W-NAME-LAST             PIC  X(15).
   702     12  W-NAME-FIRST            PIC  X(15).
   703     12  W-NAME-MIDDLE.
   704         16  FILLER              PIC  X(01).
   705         16  W-NAME-MIDDLE-2     PIC  X(01).
   706         16  FILLER              PIC  X(13).
   707
   708*                                    COPY ELCDCTB.
   709******************************************************************
   710*                                                                *
   711*                                                                *
   712*                            ELCDCTB.                            *
   713*                            VMOD=2.002                          *
   714*                                                                *
   715*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   716*       COMMUNICATIONS AREA                                      *
   717*                                                                *
   718******************************************************************
   719 01  DCT-COMMUNICATION-AREA.
   720     12  DCT-BILLING-BANK-ID      PIC  X(05).
   721     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   722     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   723     12  DCT-PRODUCT-CODE         PIC  X(02).
   724     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   725     12  DCT-RETURN-CODE          PIC  X(02).
   726     12  DCT-MAIL-CODE            PIC  X(05).
   727     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   728     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  16
* EL151.cbl
   730*                                    COPY ELCATTR.
   731******************************************************************
   732*                                                                *
   733*                            ELCATTR.                            *
   734*                            VMOD=2.001                          *
   735*                                                                *
   736*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   737*                                                                *
   738*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   739*                                                                *
   740*                   POS 1   P=PROTECTED                          *
   741*                           U=UNPROTECTED                        *
   742*                           S=ASKIP                              *
   743*                   POS 2   A=ALPHA/NUMERIC                      *
   744*                           N=NUMERIC                            *
   745*                   POS 3   N=NORMAL                             *
   746*                           B=BRIGHT                             *
   747*                           D=DARK                               *
   748*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   749*                           OF=MODIFIED DATA TAG OFF             *
   750*                                                                *
   751*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   752******************************************************************
   753 01  ATTRIBUTE-LIST.
   754     12  AL-PABOF            PIC X       VALUE 'Y'.
   755     12  AL-PABON            PIC X       VALUE 'Z'.
   756     12  AL-PADOF            PIC X       VALUE '%'.
   757     12  AL-PADON            PIC X       VALUE '_'.
   758     12  AL-PANOF            PIC X       VALUE '-'.
   759     12  AL-PANON            PIC X       VALUE '/'.
   760     12  AL-SABOF            PIC X       VALUE '8'.
   761     12  AL-SABON            PIC X       VALUE '9'.
   762     12  AL-SADOF            PIC X       VALUE '@'.
   763     12  AL-SADON            PIC X       VALUE QUOTE.
   764     12  AL-SANOF            PIC X       VALUE '0'.
   765     12  AL-SANON            PIC X       VALUE '1'.
   766     12  AL-UABOF            PIC X       VALUE 'H'.
   767     12  AL-UABON            PIC X       VALUE 'I'.
   768     12  AL-UADOF            PIC X       VALUE '<'.
   769     12  AL-UADON            PIC X       VALUE '('.
   770     12  AL-UANOF            PIC X       VALUE ' '.
   771     12  AL-UANON            PIC X       VALUE 'A'.
   772     12  AL-UNBOF            PIC X       VALUE 'Q'.
   773     12  AL-UNBON            PIC X       VALUE 'R'.
   774     12  AL-UNDOF            PIC X       VALUE '*'.
   775     12  AL-UNDON            PIC X       VALUE ')'.
   776     12  AL-UNNOF            PIC X       VALUE '&'.
   777     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  17
* EL151.cbl
   779*                                    COPY ELCLOGOF.
   780******************************************************************
   781*                                                                *
   782*                                                                *
   783*                            ELCLOGOF.                           *
   784*                            VMOD=2.001                          *
   785*                                                                *
   786*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   787*                                                                *
   788******************************************************************
   789 01  CLASIC-LOGOFF.
   790     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   791     12  LOGOFF-TEXT.
   792         16  FILLER          PIC X(5)    VALUE SPACES.
   793         16  LOGOFF-MSG.
   794             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   795             20  FILLER      PIC X       VALUE SPACES.
   796             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   797         16  FILLER          PIC X(80)
   798           VALUE '* YOU ARE NOW LOGGED OFF'.
   799         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   800         16  FILLER          PIC X       VALUE QUOTE.
   801         16  LOGOFF-SYS-MSG  PIC X(17)
   802           VALUE 'S CLAS-IC SYSTEM '.
   803     12  TEXT-MESSAGES.
   804         16  UNACCESS-MSG    PIC X(29)
   805             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   806         16  PGMIDERR-MSG    PIC X(17)
   807             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  18
* EL151.cbl
   809*                                    COPY ELCDATE.
   810******************************************************************
   811*                                                                *
   812*                                                                *
   813*                            ELCDATE.                            *
   814*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   815*                            VMOD=2.003
   816*                                                                *
   817*                                                                *
   818*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   819*                 LENGTH = 200                                   *
   820******************************************************************
   821
   822 01  DATE-CONVERSION-DATA.
   823     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   824     12  DC-OPTION-CODE                PIC X.
   825         88  BIN-TO-GREG                VALUE ' '.
   826         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   827         88  EDIT-GREG-TO-BIN           VALUE '2'.
   828         88  YMD-GREG-TO-BIN            VALUE '3'.
   829         88  MDY-GREG-TO-BIN            VALUE '4'.
   830         88  JULIAN-TO-BIN              VALUE '5'.
   831         88  BIN-PLUS-ELAPSED           VALUE '6'.
   832         88  FIND-CENTURY               VALUE '7'.
   833         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   834         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   835         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   836         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   837         88  JULIAN-TO-BIN-3            VALUE 'C'.
   838         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   839         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   840         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   841         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   842         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   843         88  CHECK-LEAP-YEAR            VALUE 'H'.
   844         88  BIN-3-TO-GREG              VALUE 'I'.
   845         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   846         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   847         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   848         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   849         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   850         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   851         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   852         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   853         88  THREE-CHARACTER-BIN
   854                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   855         88  GREGORIAN-TO-BIN
   856                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   857         88  BIN-TO-GREGORIAN
   858                  VALUES ' ' '1' 'I' '8' 'G'.
   859         88  JULIAN-TO-BINARY
   860                  VALUES '5' 'C' 'E' 'F'.
   861     12  DC-ERROR-CODE                 PIC X.
   862         88  NO-CONVERSION-ERROR        VALUE ' '.
   863         88  DATE-CONVERSION-ERROR
   864                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   865         88  DATE-IS-ZERO               VALUE '1'.
   866         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  19
* EL151.cbl
   867         88  DATE-IS-INVALID            VALUE '3'.
   868         88  DATE1-GREATER-DATE2        VALUE '4'.
   869         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   870         88  DATE-INVALID-OPTION        VALUE '9'.
   871         88  INVALID-CENTURY            VALUE 'A'.
   872         88  ONLY-CENTURY               VALUE 'B'.
   873         88  ONLY-LEAP-YEAR             VALUE 'C'.
   874         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   875     12  DC-END-OF-MONTH               PIC X.
   876         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   877     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   878         88  USE-NORMAL-PROCESS         VALUE ' '.
   879         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   880         88  ADJUST-UP-100-YRS          VALUE '2'.
   881     12  FILLER                        PIC X.
   882     12  DC-CONVERSION-DATES.
   883         16  DC-BIN-DATE-1             PIC XX.
   884         16  DC-BIN-DATE-2             PIC XX.
   885         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   886         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   887                       DC-GREG-DATE-1-EDIT.
   888             20  DC-EDIT1-MONTH        PIC 99.
   889             20  SLASH1-1              PIC X.
   890             20  DC-EDIT1-DAY          PIC 99.
   891             20  SLASH1-2              PIC X.
   892             20  DC-EDIT1-YEAR         PIC 99.
   893         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   894         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   895                     DC-GREG-DATE-2-EDIT.
   896             20  DC-EDIT2-MONTH        PIC 99.
   897             20  SLASH2-1              PIC X.
   898             20  DC-EDIT2-DAY          PIC 99.
   899             20  SLASH2-2              PIC X.
   900             20  DC-EDIT2-YEAR         PIC 99.
   901         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   902         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   903                     DC-GREG-DATE-1-YMD.
   904             20  DC-YMD-YEAR           PIC 99.
   905             20  DC-YMD-MONTH          PIC 99.
   906             20  DC-YMD-DAY            PIC 99.
   907         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   908         16  DC-GREG-DATE-1-MDY-R REDEFINES
   909                      DC-GREG-DATE-1-MDY.
   910             20  DC-MDY-MONTH          PIC 99.
   911             20  DC-MDY-DAY            PIC 99.
   912             20  DC-MDY-YEAR           PIC 99.
   913         16  DC-GREG-DATE-1-ALPHA.
   914             20  DC-ALPHA-MONTH        PIC X(10).
   915             20  DC-ALPHA-DAY          PIC 99.
   916             20  FILLER                PIC XX.
   917             20  DC-ALPHA-CENTURY.
   918                 24 DC-ALPHA-CEN-N     PIC 99.
   919             20  DC-ALPHA-YEAR         PIC 99.
   920         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   921         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   922         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   923         16  DC-JULIAN-DATE            PIC 9(05).
   924         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  20
* EL151.cbl
   925                                       PIC 9(05).
   926         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   927             20  DC-JULIAN-YEAR        PIC 99.
   928             20  DC-JULIAN-DAYS        PIC 999.
   929         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   930         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   931         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   932     12  DATE-CONVERSION-VARIBLES.
   933         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   934         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   935             20  FILLER                PIC 9(3).
   936             20  HOLD-CEN-1-CCYY.
   937                 24  HOLD-CEN-1-CC     PIC 99.
   938                 24  HOLD-CEN-1-YY     PIC 99.
   939             20  HOLD-CEN-1-MO         PIC 99.
   940             20  HOLD-CEN-1-DA         PIC 99.
   941         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   942             20  HOLD-CEN-1-R-MO       PIC 99.
   943             20  HOLD-CEN-1-R-DA       PIC 99.
   944             20  HOLD-CEN-1-R-CCYY.
   945                 24  HOLD-CEN-1-R-CC   PIC 99.
   946                 24  HOLD-CEN-1-R-YY   PIC 99.
   947             20  FILLER                PIC 9(3).
   948         16  HOLD-CENTURY-1-X.
   949             20  FILLER                PIC X(3)  VALUE SPACES.
   950             20  HOLD-CEN-1-X-CCYY.
   951                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   952                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   953             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   954             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   955         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   956             20  HOLD-CEN-1-R-X-MO     PIC XX.
   957             20  HOLD-CEN-1-R-X-DA     PIC XX.
   958             20  HOLD-CEN-1-R-X-CCYY.
   959                 24  HOLD-CEN-1-R-X-CC PIC XX.
   960                 24  HOLD-CEN-1-R-X-YY PIC XX.
   961             20  FILLER                PIC XXX.
   962         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   963         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   964         16  DC-JULIAN-DATE-1          PIC 9(07).
   965         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   966             20  DC-JULIAN-1-CCYY.
   967                 24  DC-JULIAN-1-CC    PIC 99.
   968                 24  DC-JULIAN-1-YR    PIC 99.
   969             20  DC-JULIAN-DA-1        PIC 999.
   970         16  DC-JULIAN-DATE-2          PIC 9(07).
   971         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   972             20  DC-JULIAN-2-CCYY.
   973                 24  DC-JULIAN-2-CC    PIC 99.
   974                 24  DC-JULIAN-2-YR    PIC 99.
   975             20  DC-JULIAN-DA-2        PIC 999.
   976         16  DC-GREG-DATE-A-EDIT.
   977             20  DC-EDITA-MONTH        PIC 99.
   978             20  SLASHA-1              PIC X VALUE '/'.
   979             20  DC-EDITA-DAY          PIC 99.
   980             20  SLASHA-2              PIC X VALUE '/'.
   981             20  DC-EDITA-CCYY.
   982                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  21
* EL151.cbl
   983                 24  DC-EDITA-YEAR     PIC 99.
   984         16  DC-GREG-DATE-B-EDIT.
   985             20  DC-EDITB-MONTH        PIC 99.
   986             20  SLASHB-1              PIC X VALUE '/'.
   987             20  DC-EDITB-DAY          PIC 99.
   988             20  SLASHB-2              PIC X VALUE '/'.
   989             20  DC-EDITB-CCYY.
   990                 24  DC-EDITB-CENT     PIC 99.
   991                 24  DC-EDITB-YEAR     PIC 99.
   992         16  DC-GREG-DATE-CYMD         PIC 9(08).
   993         16  DC-GREG-DATE-CYMD-R REDEFINES
   994                              DC-GREG-DATE-CYMD.
   995             20  DC-CYMD-CEN           PIC 99.
   996             20  DC-CYMD-YEAR          PIC 99.
   997             20  DC-CYMD-MONTH         PIC 99.
   998             20  DC-CYMD-DAY           PIC 99.
   999         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1000         16  DC-GREG-DATE-MDCY-R REDEFINES
  1001                              DC-GREG-DATE-MDCY.
  1002             20  DC-MDCY-MONTH         PIC 99.
  1003             20  DC-MDCY-DAY           PIC 99.
  1004             20  DC-MDCY-CEN           PIC 99.
  1005             20  DC-MDCY-YEAR          PIC 99.
  1006    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1007        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1008    12  DC-EL310-DATE                  PIC X(21).
  1009    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  22
* EL151.cbl
  1011*                                    COPY ELCEMIB.
  1012******************************************************************
  1013*                                                                *
  1014*                                                                *
  1015*                            ELCEMIB.                            *
  1016*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1017*                            VMOD=2.005                          *
  1018*                                                                *
  1019*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1020*                                                                *
  1021******************************************************************
  1022 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1023     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1024     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1025     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1026     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1027     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1028     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1029     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1030     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1031     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1032         88  EMI-NO-ERRORS                    VALUE '1'.
  1033         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1034         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1035     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1036         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1037     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1038         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1039         88  EMI-AREA1-FULL                   VALUE '2'.
  1040     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1041         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1042         88  EMI-AREA2-FULL                   VALUE '2'.
  1043     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1044         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1045         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1046         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1047         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1048         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1049     12  EMI-ERROR-LINES.
  1050         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1051         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1052         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1053         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1054             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1055                 24  EMI-ERR-NUM         PIC X(4).
  1056                 24  EMI-FILLER          PIC X.
  1057                 24  EMI-SEV             PIC X.
  1058                 24  FILLER              PIC X.
  1059             20  FILLER                  PIC X(02).
  1060     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1061         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1062             20  EMI-ERROR-NUMBER    PIC X(4).
  1063             20  EMI-FILL            PIC X.
  1064             20  EMI-SEVERITY        PIC X.
  1065             20  FILLER              PIC X.
  1066             20  EMI-ERROR-TEXT.
  1067                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1068                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  23
* EL151.cbl
  1069     12  EMI-SEVERITY-SAVE           PIC X.
  1070         88  EMI-NOTE                    VALUE 'N'.
  1071         88  EMI-WARNING                 VALUE 'W'.
  1072         88  EMI-FORCABLE                VALUE 'F'.
  1073         88  EMI-FATAL                   VALUE 'X'.
  1074     12  EMI-MESSAGE-FLAG            PIC X.
  1075         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1076         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1077     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1078     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1079         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1080         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1081         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1082     12  FILLER                      PIC X(137)  VALUE SPACES.
  1083     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1084     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1085     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1086     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  24
* EL151.cbl
  1088*                                    COPY EL151S.
  1089 01  EL151AI.
  1090     05  FILLER            PIC  X(0012).
  1091*    -------------------------------
  1092     05  MRNDATEL PIC S9(0004) COMP.
  1093     05  MRNDATEF PIC  X(0001).
  1094     05  FILLER REDEFINES MRNDATEF.
  1095         10  MRNDATEA PIC  X(0001).
  1096     05  MRNDATEI PIC  X(0008).
  1097*    -------------------------------
  1098     05  MRNTIMEL PIC S9(0004) COMP.
  1099     05  MRNTIMEF PIC  X(0001).
  1100     05  FILLER REDEFINES MRNTIMEF.
  1101         10  MRNTIMEA PIC  X(0001).
  1102     05  MRNTIMEI PIC  X(0005).
  1103*    -------------------------------
  1104     05  MLINE1L PIC S9(0004) COMP.
  1105     05  MLINE1F PIC  X(0001).
  1106     05  FILLER REDEFINES MLINE1F.
  1107         10  MLINE1A PIC  X(0001).
  1108     05  MLINE1I PIC  X(0060).
  1109*    -------------------------------
  1110     05  MLINE2L PIC S9(0004) COMP.
  1111     05  MLINE2F PIC  X(0001).
  1112     05  FILLER REDEFINES MLINE2F.
  1113         10  MLINE2A PIC  X(0001).
  1114     05  MLINE2I PIC  X(0060).
  1115*    -------------------------------
  1116     05  MDENCDL PIC S9(0004) COMP.
  1117     05  MDENCDF PIC  X(0001).
  1118     05  FILLER REDEFINES MDENCDF.
  1119         10  MDENCDA PIC  X(0001).
  1120     05  MDENCDI PIC  X(0004).
  1121*    -------------------------------
  1122     05  MPRFDTL PIC S9(0004) COMP.
  1123     05  MPRFDTF PIC  X(0001).
  1124     05  FILLER REDEFINES MPRFDTF.
  1125         10  MPRFDTA PIC  X(0001).
  1126     05  MPRFDTI PIC  X(0008).
  1127*    -------------------------------
  1128     05  MERMSG1L PIC S9(0004) COMP.
  1129     05  MERMSG1F PIC  X(0001).
  1130     05  FILLER REDEFINES MERMSG1F.
  1131         10  MERMSG1A PIC  X(0001).
  1132     05  MERMSG1I PIC  X(0070).
  1133*    -------------------------------
  1134     05  MERMSG2L PIC S9(0004) COMP.
  1135     05  MERMSG2F PIC  X(0001).
  1136     05  FILLER REDEFINES MERMSG2F.
  1137         10  MERMSG2A PIC  X(0001).
  1138     05  MERMSG2I PIC  X(0070).
  1139*    -------------------------------
  1140     05  MPFNUMBL PIC S9(0004) COMP.
  1141     05  MPFNUMBF PIC  X(0001).
  1142     05  FILLER REDEFINES MPFNUMBF.
  1143         10  MPFNUMBA PIC  X(0001).
  1144     05  MPFNUMBI PIC  99.
  1145 01  EL151AO REDEFINES EL151AI.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  25
* EL151.cbl
  1146     05  FILLER            PIC  X(0012).
  1147*    -------------------------------
  1148     05  FILLER            PIC  X(0003).
  1149     05  MRNDATEO PIC  X(0008).
  1150*    -------------------------------
  1151     05  FILLER            PIC  X(0003).
  1152     05  MRNTIMEO PIC  99.99.
  1153*    -------------------------------
  1154     05  FILLER            PIC  X(0003).
  1155     05  MLINE1O PIC  X(0060).
  1156*    -------------------------------
  1157     05  FILLER            PIC  X(0003).
  1158     05  MLINE2O PIC  X(0060).
  1159*    -------------------------------
  1160     05  FILLER            PIC  X(0003).
  1161     05  MDENCDO PIC  X(0004).
  1162*    -------------------------------
  1163     05  FILLER            PIC  X(0003).
  1164     05  MPRFDTO PIC  99B99B99.
  1165*    -------------------------------
  1166     05  FILLER            PIC  X(0003).
  1167     05  MERMSG1O PIC  X(0070).
  1168*    -------------------------------
  1169     05  FILLER            PIC  X(0003).
  1170     05  MERMSG2O PIC  X(0070).
  1171*    -------------------------------
  1172     05  FILLER            PIC  X(0003).
  1173     05  MPFNUMBO PIC  99.
  1174*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  26
* EL151.cbl
  1176*                                    COPY ELCDMO.
  1177******************************************************************
  1178*                                                                *
  1179*                                                                *
  1180*                            ELCDMO.                             *
  1181*                            VMOD=2.004                          *
  1182*                                                                *
  1183*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  1184*        COMMUNICATION AREA                                      *
  1185*   FILE TYPE = NA                                               *
  1186*   RECORD SIZE = 110    RECFORM = FIXED                         *
  1187*                                                                *
  1188******************************************************************
  1189 01  DMO-COMMUNICATION-AREA.
  1190     12  DM-RECORD-TYPE                  PIC  X(02).
  1191             88  DM-ISSUE-TRAN                VALUE 'CC'.
  1192             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  1193             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  1194     12  DM-DIST-CODE                    PIC  X(04).
  1195     12  DM-MAIL-CODE                    PIC  X(05).
  1196     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  1197     12  DM-INSURED-NAME                 PIC  X(30).
  1198     12  DM-CLAIM-NO                     PIC  X(07).
  1199     12  DM-CLAIM-TYPE                   PIC  X.
  1200
  1201     12  DM-STATUS-DATA-AREA.
  1202         16  DM-CLAIM-STATUS             PIC  X.
  1203             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  1204             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  1205             88  DM-CLOSED                        VALUE '3'.
  1206             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  1207             88  DM-DEFAULT                       VALUE '9'.
  1208         16  DM-STATUS-DATE              PIC  X(08).
  1209******YYYYMMDD
  1210         16  DM-STAT-CHANGE-TYPE         PIC  X.
  1211             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  1212             88  DM-CLAIM-DENIED                  VALUE 'D'.
  1213             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  1214             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  1215             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  1216             88  DM-RE-OPENED                     VALUE 'R'.
  1217             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  1218             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  1219             88  DM-CLAIM-DELETED                 VALUE 'X'.
  1220         16  DM-STAT-CARRIER             PIC X.
  1221
  1222     12  DM-DRAFT-DATA-AREA.
  1223         16  DM-PAYMENT-TYPE             PIC  X.
  1224             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  1225         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  1226         16  DM-PAYMENT-DATE             PIC  X(08).
  1227******YYYYMMDD
  1228         16  DM-CERT-NO                  PIC  X(11).
  1229         16  DM-TRLR-SEQ-NO              PIC  9(04).
  1230         16  DM-CARRIER                  PIC  X.
  1231
  1232     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  27
* EL151.cbl
  1234****************************************************************
  1235*
  1236* Copyright (c) 2007 by Clerity Solutions, Inc.
  1237* All rights reserved.
  1238*
  1239****************************************************************
  1240 01  DFHEIV.
  1241   02  DFHEIV0               PIC X(35).
  1242   02  DFHEIV1               PIC X(08).
  1243   02  DFHEIV2               PIC X(08).
  1244   02  DFHEIV3               PIC X(08).
  1245   02  DFHEIV4               PIC X(06).
  1246   02  DFHEIV5               PIC X(04).
  1247   02  DFHEIV6               PIC X(04).
  1248   02  DFHEIV7               PIC X(02).
  1249   02  DFHEIV8               PIC X(02).
  1250   02  DFHEIV9               PIC X(01).
  1251   02  DFHEIV10              PIC S9(7) COMP-3.
  1252   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1253   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1254   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1255   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1256   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1257   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1258   02  DFHEIV17              PIC X(04).
  1259   02  DFHEIV18              PIC X(04).
  1260   02  DFHEIV19              PIC X(04).
  1261   02  DFHEIV20              USAGE IS POINTER.
  1262   02  DFHEIV21              USAGE IS POINTER.
  1263   02  DFHEIV22              USAGE IS POINTER.
  1264   02  DFHEIV23              USAGE IS POINTER.
  1265   02  DFHEIV24              USAGE IS POINTER.
  1266   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1267   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1268   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1269   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1270   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1271   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1272   02  FILLER                PIC X(02).
  1273   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1274   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1275   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1276   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1277   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1278 LINKAGE  SECTION.
  1279*****************************************************************
  1280*                                                               *
  1281* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1282* All rights reserved.                                          *
  1283*                                                               *
  1284*****************************************************************
  1285 01  dfheiblk.
  1286     02  eibtime          pic s9(7) comp-3.
  1287     02  eibdate          pic s9(7) comp-3.
  1288     02  eibtrnid         pic x(4).
  1289     02  eibtaskn         pic s9(7) comp-3.
  1290     02  eibtrmid         pic x(4).
  1291     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  28
* EL151.cbl
  1292     02  eibcposn         pic s9(4) comp.
  1293     02  eibcalen         pic s9(4) comp.
  1294     02  eibaid           pic x(1).
  1295     02  eibfiller1       pic x(1).
  1296     02  eibfn            pic x(2).
  1297     02  eibfiller2       pic x(2).
  1298     02  eibrcode         pic x(6).
  1299     02  eibfiller3       pic x(2).
  1300     02  eibds            pic x(8).
  1301     02  eibreqid         pic x(8).
  1302     02  eibrsrce         pic x(8).
  1303     02  eibsync          pic x(1).
  1304     02  eibfree          pic x(1).
  1305     02  eibrecv          pic x(1).
  1306     02  eibsend          pic x(1).
  1307     02  eibatt           pic x(1).
  1308     02  eibeoc           pic x(1).
  1309     02  eibfmh           pic x(1).
  1310     02  eibcompl         pic x(1).
  1311     02  eibsig           pic x(1).
  1312     02  eibconf          pic x(1).
  1313     02  eiberr           pic x(1).
  1314     02  eibrldbk         pic x(1).
  1315     02  eiberrcd         pic x(4).
  1316     02  eibsynrb         pic x(1).
  1317     02  eibnodat         pic x(1).
  1318     02  eibfiller5       pic x(2).
  1319     02  eibresp          pic 9(09) comp.
  1320     02  eibresp2         pic 9(09) comp.
  1321     02  dfheigdj         pic s9(4) comp.
  1322     02  dfheigdk         pic s9(4) comp.
  1323 01  DFHCOMMAREA                     PICTURE X(1024).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  29
* EL151.cbl
  1325*                                    COPY ELCMSTR.
  1326******************************************************************
  1327*                                                                *
  1328*                            ELCMSTR.                            *
  1329*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1330*                            VMOD=2.012                          *
  1331*                                                                *
  1332*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1333*                                                                *
  1334*   FILE TYPE = VSAM,KSDS                                        *
  1335*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1336*                                                                *
  1337*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1338*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1339*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1340*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1341*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1342*                                                 RKP=75,LEN=21  *
  1343*                                                                *
  1344*   **** NOTE ****                                               *
  1345*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1346*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1347*                                                                *
  1348*   LOG = YES                                                    *
  1349*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1350******************************************************************
  1351*                   C H A N G E   L O G
  1352*
  1353* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1354*-----------------------------------------------------------------
  1355*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1356* EFFECTIVE    NUMBER
  1357*-----------------------------------------------------------------
  1358* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1359* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1360******************************************************************
  1361 01  CLAIM-MASTER.
  1362     12  CL-RECORD-ID                PIC XX.
  1363         88  VALID-CL-ID         VALUE 'CL'.
  1364
  1365     12  CL-CONTROL-PRIMARY.
  1366         16  CL-COMPANY-CD           PIC X.
  1367         16  CL-CARRIER              PIC X.
  1368         16  CL-CLAIM-NO             PIC X(7).
  1369         16  CL-CERT-NO.
  1370             20  CL-CERT-PRIME       PIC X(10).
  1371             20  CL-CERT-SFX         PIC X.
  1372
  1373     12  CL-CONTROL-BY-NAME.
  1374         16  CL-COMPANY-CD-A1        PIC X.
  1375         16  CL-INSURED-LAST-NAME    PIC X(15).
  1376         16  CL-INSURED-NAME.
  1377             20  CL-INSURED-1ST-NAME PIC X(12).
  1378             20  CL-INSURED-MID-INIT PIC X.
  1379
  1380     12  CL-CONTROL-BY-SSN.
  1381         16  CL-COMPANY-CD-A2        PIC X.
  1382         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  30
* EL151.cbl
  1383             20  CL-SSN-STATE        PIC XX.
  1384             20  CL-SSN-ACCOUNT      PIC X(6).
  1385             20  CL-SSN-LN3          PIC X(3).
  1386
  1387     12  CL-CONTROL-BY-CERT-NO.
  1388         16  CL-COMPANY-CD-A4        PIC X.
  1389         16  CL-CERT-NO-A4.
  1390             20  CL-CERT-A4-PRIME    PIC X(10).
  1391             20  CL-CERT-A4-SFX      PIC X.
  1392
  1393     12  CL-CONTROL-BY-CCN.
  1394         16  CL-COMPANY-CD-A5        PIC X.
  1395         16  CL-CCN-A5.
  1396             20  CL-CCN.
  1397                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1398                 24  CL-CCN-PRIME-A5 PIC X(12).
  1399             20  CL-CCN-FILLER-A5    PIC X(4).
  1400
  1401     12  CL-INSURED-PROFILE-DATA.
  1402         16  CL-INSURED-BIRTH-DT     PIC XX.
  1403         16  CL-INSURED-SEX-CD       PIC X.
  1404             88  INSURED-IS-MALE        VALUE 'M'.
  1405             88  INSURED-IS-FEMALE      VALUE 'F'.
  1406             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1407         16  CL-INSURED-OCC-CD       PIC X(6).
  1408         16  FILLER                  PIC X(5).
  1409
  1410     12  CL-PROCESSING-INFO.
  1411         16  CL-PROCESSOR-ID         PIC X(4).
  1412         16  CL-CLAIM-STATUS         PIC X.
  1413             88  CLAIM-IS-OPEN          VALUE 'O'.
  1414             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1415         16  CL-CLAIM-TYPE           PIC X.
  1416*            88  AH-CLAIM               VALUE 'A'.
  1417*            88  LIFE-CLAIM             VALUE 'L'.
  1418*            88  PROPERTY-CLAIM         VALUE 'P'.
  1419*            88  IUI-CLAIM              VALUE 'I'.
  1420*            88  GAP-CLAIM              VALUE 'G'.
  1421         16  CL-CLAIM-PREM-TYPE      PIC X.
  1422             88  SINGLE-PREMIUM         VALUE '1'.
  1423             88  O-B-COVERAGE           VALUE '2'.
  1424             88  OPEN-END-COVERAGE      VALUE '3'.
  1425         16  CL-INCURRED-DT          PIC XX.
  1426         16  CL-REPORTED-DT          PIC XX.
  1427         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1428         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1429         16  CL-LAST-PMT-DT          PIC XX.
  1430         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1431         16  CL-PAID-THRU-DT         PIC XX.
  1432         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1433         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  1434         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1435         16  CL-PMT-CALC-METHOD      PIC X.
  1436             88  CL-360-DAY-YR          VALUE '1'.
  1437             88  CL-365-DAY-YR          VALUE '2'.
  1438             88  CL-FULL-MONTHS         VALUE '3'.
  1439         16  CL-CAUSE-CD             PIC X(6).
  1440
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  31
* EL151.cbl
  1441         16  CL-PRIME-CERT-NO.
  1442             20  CL-PRIME-CERT-PRIME PIC X(10).
  1443             20  CL-PRIME-CERT-SFX   PIC X.
  1444
  1445         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1446             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1447             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1448
  1449         16  CL-MICROFILM-NO         PIC X(10).
  1450         16  CL-PROG-FORM-TYPE       PIC X.
  1451         16  CL-LAST-ADD-ON-DT       PIC XX.
  1452
  1453         16  CL-LAST-REOPEN-DT       PIC XX.
  1454         16  CL-LAST-CLOSE-DT        PIC XX.
  1455         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1456             88  FINAL-PAID             VALUE '1'.
  1457             88  CLAIM-DENIED           VALUE '2'.
  1458             88  AUTO-CLOSE             VALUE '3'.
  1459             88  MANUAL-CLOSE           VALUE '4'.
  1460             88  BENEFITS-CHANGED       VALUE 'C'.
  1461             88  SETUP-ERRORS           VALUE 'E'.
  1462         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1463         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1464         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1465             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1466         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1467         16  FILLER                  PIC X.
  1468
  1469     12  CL-CERTIFICATE-DATA.
  1470         16  CL-CERT-ORIGIN          PIC X.
  1471             88  CERT-WAS-ONLINE        VALUE '1'.
  1472             88  CERT-WAS-CREATED       VALUE '2'.
  1473             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1474         16  CL-CERT-KEY-DATA.
  1475             20  CL-CERT-CARRIER     PIC X.
  1476             20  CL-CERT-GROUPING    PIC X(6).
  1477             20  CL-CERT-STATE       PIC XX.
  1478             20  CL-CERT-ACCOUNT.
  1479                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1480                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1481             20  CL-CERT-EFF-DT      PIC XX.
  1482
  1483     12  CL-STATUS-CONTROLS.
  1484         16  CL-PRIORITY-CD          PIC X.
  1485             88  CONFIDENTIAL-DATA      VALUE '8'.
  1486             88  HIGHEST-PRIORITY       VALUE '9'.
  1487         16  CL-SUPV-ATTN-CD         PIC X.
  1488             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  1489             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1490         16  CL-PURGED-DT            PIC XX.
  1491         16  CL-RESTORED-DT          PIC XX.
  1492         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1493         16  CL-NEXT-RESEND-DT       PIC XX.
  1494         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1495         16  FILLER                  PIC XX.
  1496         16  CL-LAST-MAINT-DT        PIC XX.
  1497         16  CL-LAST-MAINT-USER      PIC X(4).
  1498         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  32
* EL151.cbl
  1499         16  CL-LAST-MAINT-TYPE      PIC X.
  1500             88  CLAIM-SET-UP           VALUE ' '.
  1501             88  PAYMENT-MADE           VALUE '1'.
  1502             88  LETTER-SENT            VALUE '2'.
  1503             88  MASTER-WAS-ALTERED     VALUE '3'.
  1504             88  MASTER-WAS-RESTORED    VALUE '4'.
  1505             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1506             88  FILE-CONVERTED         VALUE '6'.
  1507             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1508             88  ERROR-CORRECTION       VALUE 'E'.
  1509         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1510         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1511         16  CL-BENEFICIARY          PIC X(10).
  1512         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1513         16  CL-DENIAL-TYPE          PIC X.
  1514             88  CL-TYPE-DENIAL          VALUE '1'.
  1515             88  CL-TYPE-RESCISSION      VALUE '2'.
  1516             88  CL-TYPE-REFORMATION     VALUE '3'.
  1517             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1518             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1519         16  FILLER                  PIC X(5).
  1520
  1521     12  CL-TRAILER-CONTROLS.
  1522         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1523             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1524             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1525             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1526         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1527         16  FILLER                  PIC XX.
  1528         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1529         16  CL-ADDRESS-TRAILER-CNT.
  1530             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1531                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1532             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1533                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1534             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1535                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1536             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1537                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1538             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1539                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1540             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1541                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  1542             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1543                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1544
  1545     12  CL-CV-REFERENCE-NO.
  1546         16  CL-CV-REFNO-PRIME       PIC X(18).
  1547         16  CL-CV-REFNO-SFX         PIC XX.
  1548
  1549     12  CL-FILE-LOCATION            PIC X(4).
  1550
  1551     12  CL-PROCESS-ERRORS.
  1552         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1553             88  NO-FATAL-ERRORS        VALUE ZERO.
  1554         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1555             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1556
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  33
* EL151.cbl
  1557     12  CL-PRODUCT-CD               PIC X.
  1558
  1559     12  CL-CURRENT-KEY-DATA.
  1560         16  CL-CURRENT-CARRIER      PIC X.
  1561         16  CL-CURRENT-GROUPING     PIC X(6).
  1562         16  CL-CURRENT-STATE        PIC XX.
  1563         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1564
  1565     12  CL-ASSOCIATES               PIC X.
  1566         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1567         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1568         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1569         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1570
  1571     12  CL-ACTIVITY-CODE            PIC 99.
  1572     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1573     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1574
  1575     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1576     12  CL-LAG-REPORT-CODE          PIC 9.
  1577     12  CL-LOAN-TYPE                PIC XX.
  1578     12  CL-LEGAL-STATE              PIC XX.
  1579
  1580*    12  FILLER                      PIC X(5).
  1581     12  CL-YESNOSW                  PIC X.
  1582     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  34
* EL151.cbl
  1584*                                    COPY ELCTRLR.
  1585******************************************************************
  1586*                                                                *
  1587*                            ELCTRLR.                            *
  1588*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1589*                            VMOD=2.014                          *
  1590*                                                                *
  1591*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  1592*                                                                *
  1593*   FILE TYPE = VSAM,KSDS                                        *
  1594*   RECORD SIZE = 200    RECFORM = FIXED                         *
  1595*                                                                *
  1596*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  1597*       ALTERNATE INDEX = NONE                                   *
  1598*                                                                *
  1599*   LOG = YES                                                    *
  1600*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1601******************************************************************
  1602*                   C H A N G E   L O G
  1603*
  1604* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1605*-----------------------------------------------------------------
  1606*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1607* EFFECTIVE    NUMBER
  1608*-----------------------------------------------------------------
  1609* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1610* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  1611* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  1612* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  1613* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  1614* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  1615* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  1616* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  1617* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  1618* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  1619* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  1620* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  1621******************************************************************
  1622 01  ACTIVITY-TRAILERS.
  1623     12  AT-RECORD-ID                    PIC XX.
  1624         88  VALID-AT-ID                       VALUE 'AT'.
  1625
  1626     12  AT-CONTROL-PRIMARY.
  1627         16  AT-COMPANY-CD               PIC X.
  1628         16  AT-CARRIER                  PIC X.
  1629         16  AT-CLAIM-NO                 PIC X(7).
  1630         16  AT-CERT-NO.
  1631             20  AT-CERT-PRIME           PIC X(10).
  1632             20  AT-CERT-SFX             PIC X.
  1633         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  1634             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  1635             88  AT-LAST-TRL-AVAIL            VALUE +100.
  1636             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  1637             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  1638             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  1639             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  1640             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  1641             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  35
* EL151.cbl
  1642             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  1643             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  1644             88  AT-DIAGNOSIS-TRL             VALUE +90.
  1645             88  AT-BENEFICIARY-TRL           VALUE +91.
  1646             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  1647
  1648     12  AT-TRAILER-TYPE                 PIC X.
  1649         88  RESERVE-EXPENSE-TR               VALUE '1'.
  1650         88  PAYMENT-TR                       VALUE '2'.
  1651         88  AUTO-PAY-TR                      VALUE '3'.
  1652         88  CORRESPONDENCE-TR                VALUE '4'.
  1653         88  ADDRESS-TR                       VALUE '5'.
  1654         88  GENERAL-INFO-TR                  VALUE '6'.
  1655         88  AUTO-PROMPT-TR                   VALUE '7'.
  1656         88  DENIAL-TR                        VALUE '8'.
  1657         88  INCURRED-CHG-TR                  VALUE '9'.
  1658         88  FORM-CONTROL-TR                  VALUE 'A'.
  1659
  1660     12  AT-RECORDED-DT                  PIC XX.
  1661     12  AT-RECORDED-BY                  PIC X(4).
  1662     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  1663
  1664     12  AT-TRAILER-BODY                 PIC X(165).
  1665
  1666     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  1667         16  AT-RESERVE-CONTROLS.
  1668             20  AT-MANUAL-SW            PIC X.
  1669                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  1670             20  AT-FUTURE-SW            PIC X.
  1671                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  1672             20  AT-PTC-SW               PIC X.
  1673                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  1674             20  AT-IBNR-SW              PIC X.
  1675                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  1676             20  AT-PTC-LF-SW            PIC X.
  1677                 88  AT-LF-PTC-USED          VALUE '1'.
  1678             20  AT-CDT-ACCESS-METHOD    PIC X.
  1679                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  1680                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  1681                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  1682             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  1683         16  AT-LAST-COMPUTED-DT         PIC XX.
  1684         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  1685         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  1686         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  1687         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  1688         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  1689         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  1690         16  AT-EXPENSE-CONTROLS.
  1691             20  AT-EXPENSE-METHOD       PIC X.
  1692                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  1693                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  1694                 88  PERCENT-OF-PMT           VALUE '3'.
  1695                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  1696             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  1697             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  1698         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  1699         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  36
* EL151.cbl
  1700
  1701         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  1702         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  1703
  1704*        16  FILLER                      PIC X(53).
  1705         16  FILLER                      PIC X(47).
  1706
  1707         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  1708         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  1709
  1710         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  1711             20  AT-OPEN-CLOSE-DATE      PIC XX.
  1712             20  AT-OPEN-CLOSE-TYPE      PIC X.
  1713*                    C = CLOSED
  1714*                    O = OPEN
  1715             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  1716*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  1717
  1718     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  1719         16  AT-PAYMENT-TYPE             PIC X.
  1720             88  PARTIAL-PAYMENT                VALUE '1'.
  1721             88  FINAL-PAYMENT                  VALUE '2'.
  1722             88  LUMP-SUM-PAYMENT               VALUE '3'.
  1723             88  ADDITIONAL-PAYMENT             VALUE '4'.
  1724             88  CHARGEABLE-EXPENSE             VALUE '5'.
  1725             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  1726             88  VOIDED-PAYMENT                 VALUE '9'.
  1727             88  TRANSFER                       VALUE 'T'.
  1728             88  LIFE-INTEREST                  VALUE 'I'.
  1729
  1730         16  AT-CLAIM-TYPE               PIC X.
  1731             88  PAID-FOR-AH                    VALUE 'A'.
  1732             88  PAID-FOR-LIFE                  VALUE 'L'.
  1733             88  PAID-FOR-IUI                   VALUE 'I'.
  1734             88  PAID-FOR-GAP                   VALUE 'G'.
  1735         16  AT-CLAIM-PREM-TYPE          PIC X.
  1736             88  AT-SINGLE-PREMIUM              VALUE '1'.
  1737             88  AT-O-B-COVERAGE                VALUE '2'.
  1738             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  1739         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  1740         16  AT-CHECK-NO                 PIC X(7).
  1741         16  AT-PAID-FROM-DT             PIC XX.
  1742         16  AT-PAID-THRU-DT             PIC XX.
  1743         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  1744         16  FILLER                      PIC X.
  1745         16  AT-PAYEES-NAME              PIC X(30).
  1746         16  AT-PAYMENT-ORIGIN           PIC X.
  1747             88  ONLINE-MANUAL-PMT              VALUE '1'.
  1748             88  ONLINE-AUTO-PMT                VALUE '2'.
  1749             88  OFFLINE-PMT                    VALUE '3'.
  1750         16  AT-CHECK-WRITTEN-DT         PIC XX.
  1751         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  1752         16  AT-VOID-DATA.
  1753             20  AT-VOID-DT              PIC XX.
  1754*00144       20  AT-VOID-REASON          PIC X(30).
  1755             20  AT-VOID-REASON          PIC X(26).
  1756         16  AT-PMT-APPROVED-BY          PIC X(04).
  1757         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  37
* EL151.cbl
  1758         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  1759         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  1760                                         PIC S99V9(5)  COMP-3.
  1761         16  AT-CREDIT-INTERFACE.
  1762             20  AT-PMT-SELECT-DT        PIC XX.
  1763                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  1764             20  AT-PMT-ACCEPT-DT        PIC XX.
  1765                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  1766             20  AT-VOID-SELECT-DT       PIC XX.
  1767                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  1768             20  AT-VOID-ACCEPT-DT       PIC XX.
  1769                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  1770
  1771         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  1772                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  1773                 88  CONVERSION-PAYMENT           VALUE +99999999.
  1774         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  1775
  1776         16  AT-FORCE-CONTROL            PIC X.
  1777             88  PAYMENT-WAS-FORCED           VALUE '1'.
  1778         16  AT-PREV-LAST-PMT-DT         PIC XX.
  1779         16  AT-PREV-PAID-THRU-DT        PIC XX.
  1780         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  1781         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  1782         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  1783         16  AT-BENEFIT-TYPE             PIC X.
  1784
  1785         16  AT-EXPENSE-TYPE             PIC X.
  1786         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  1787
  1788         16  AT-PAYEE-TYPE-CD.
  1789             20  AT-PAYEE-TYPE           PIC X.
  1790                 88  INSURED-PAID           VALUE 'I'.
  1791                 88  BENEFICIARY-PAID       VALUE 'B'.
  1792                 88  ACCOUNT-PAID           VALUE 'A'.
  1793                 88  OTHER-1-PAID           VALUE 'O'.
  1794                 88  OTHER-2-PAID           VALUE 'Q'.
  1795                 88  DOCTOR-PAID            VALUE 'P'.
  1796                 88  EMPLOYER-PAID          VALUE 'E'.
  1797             20  AT-PAYEE-SEQ            PIC X.
  1798
  1799         16  AT-CASH-PAYMENT             PIC X.
  1800         16  AT-GROUPED-PAYMENT          PIC X.
  1801         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  1802         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  1803         16  AT-APPROVED-LEVEL           PIC X.
  1804         16  AT-VOID-TYPE                PIC X.
  1805             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  1806             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  1807         16  AT-AIG-UNEMP-IND            PIC X.
  1808             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  1809         16  AT-ASSOCIATES               PIC X.
  1810             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  1811             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  1812
  1813         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  1814         16  AT-CV-PMT-CODE              PIC X.
  1815             88  FULL-DEATH-PAYMENT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  38
* EL151.cbl
  1816             88  HALF-DEATH-PAYMENT         VALUE '2'.
  1817             88  FULL-ADD-PAYMENT           VALUE '3'.
  1818             88  HALF-ADD-PAYMENT           VALUE '4'.
  1819             88  FULL-RIDER-PAYMENT         VALUE '5'.
  1820             88  HALF-RIDER-PAYMENT         VALUE '6'.
  1821             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  1822             88  ADDL-PAYMENT               VALUE '8'.
  1823
  1824         16  AT-EOB-CODE1                PIC XXX.
  1825         16  AT-EOB-CODE2                PIC XXX.
  1826         16  AT-EOB-CODE3                PIC XXX.
  1827         16  AT-EOB-CODE4                PIC XXX.
  1828         16  FILLER REDEFINES AT-EOB-CODE4.
  1829             20  AT-INT-PMT-SELECT-DT    PIC XX.
  1830             20  FILLER                  PIC X.
  1831         16  AT-EOB-CODE5                PIC XXX.
  1832         16  FILLER REDEFINES AT-EOB-CODE5.
  1833             20  AT-PMT-PROOF-DT         PIC XX.
  1834             20  FILLER                  PIC X.
  1835
  1836         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  1837             88  AT-PRINT-EOB            VALUE 'Y'.
  1838
  1839         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  1840         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  1841
  1842     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  1843         16  AT-SCHEDULE-START-DT        PIC XX.
  1844         16  AT-SCHEDULE-END-DT          PIC XX.
  1845         16  AT-TERMINATED-DT            PIC XX.
  1846         16  AT-LAST-PMT-TYPE            PIC X.
  1847             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  1848             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  1849         16  AT-FIRST-PMT-DATA.
  1850             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  1851             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  1852             20  AT-1ST-PAY-THRU-DT      PIC XX.
  1853         16  AT-REGULAR-PMT-DATA.
  1854             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  1855             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  1856             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  1857         16  AT-AUTO-PAYEE-CD.
  1858             20  AT-AUTO-PAYEE-TYPE      PIC X.
  1859                 88  INSURED-PAID-AUTO      VALUE 'I'.
  1860                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  1861                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  1862                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  1863                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  1864             20  AT-AUTO-PAYEE-SEQ       PIC X.
  1865         16  AT-AUTO-PAY-DAY             PIC 99.
  1866         16  AT-AUTO-CASH                PIC X.
  1867             88  AT-CASH                      VALUE 'Y'.
  1868             88  AT-NON-CASH                  VALUE 'N'.
  1869*        16  FILLER                      PIC X(129).
  1870         16  AT-AUTO-END-LETTER          PIC X(4).
  1871         16  FILLER                      PIC X(125).
  1872
  1873         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  39
* EL151.cbl
  1874         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  1875
  1876     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  1877         16  AT-LETTER-SENT-DT           PIC XX.
  1878         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  1879         16  AT-AUTO-RE-SEND-DT          PIC XX.
  1880         16  AT-LETTER-ANSWERED-DT       PIC XX.
  1881         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  1882         16  AT-LETTER-ORIGIN            PIC X.
  1883             88  ONLINE-CREATION              VALUE '1' '3'.
  1884             88  OFFLINE-CREATION             VALUE '2' '4'.
  1885             88  NAPER-ONLINE-CREATION        VALUE '3'.
  1886             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  1887         16  AT-STD-LETTER-FORM          PIC X(4).
  1888         16  AT-REASON-TEXT              PIC X(70).
  1889         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  1890         16  AT-ADDRESEE-TYPE            PIC X.
  1891              88  INSURED-ADDRESEE            VALUE 'I'.
  1892              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  1893              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  1894              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  1895              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  1896              88  OTHER-ADDRESEE-1            VALUE 'O'.
  1897              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  1898         16  AT-ADDRESSEE-NAME           PIC X(30).
  1899         16  AT-INITIAL-PRINT-DATE       PIC XX.
  1900         16  AT-RESEND-PRINT-DATE        PIC XX.
  1901         16  AT-CORR-SOL-UNSOL           PIC X.
  1902         16  AT-LETTER-PURGED-DT         PIC XX.
  1903*
  1904*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  1905*
  1906         16  AT-CSO-REDEFINITION.
  1907             20  AT-RESEND-LETTER-FORM   PIC X(4).
  1908             20  AT-AUTO-CLOSE-IND       PIC X(1).
  1909             20  AT-LETTER-TO-BENE       PIC X(1).
  1910             20  AT-STOP-LETTER-DT       PIC X(2).
  1911             20  FILLER                  PIC X(19).
  1912*             20  FILLER                  PIC X(27).
  1913             20  AT-CSO-LETTER-STATUS    PIC X.
  1914                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  1915                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  1916                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  1917             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  1918             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  1919*
  1920*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  1921*
  1922*        16  FILLER                      PIC X(26).
  1923*
  1924*        16  AT-DMD-BSR-CODE             PIC X.
  1925*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  1926*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  1927*
  1928*        16  AT-DMD-LETTER-STATUS        PIC X.
  1929*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  1930*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  1931*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  40
* EL151.cbl
  1932*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  1933*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  1934
  1935         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  1936         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  1937
  1938     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  1939         16  AT-ADDRESS-TYPE             PIC X.
  1940             88  INSURED-ADDRESS               VALUE 'I'.
  1941             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  1942             88  ACCOUNT-ADDRESS               VALUE 'A'.
  1943             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  1944             88  EMPLOYER-ADDRESS              VALUE 'E'.
  1945             88  OTHER-ADDRESS-1               VALUE 'O'.
  1946             88  OTHER-ADDRESS-2               VALUE 'Q'.
  1947         16  AT-MAIL-TO-NAME             PIC X(30).
  1948         16  AT-ADDRESS-LINE-1           PIC X(30).
  1949         16  AT-ADDRESS-LINE-2           PIC X(30).
  1950         16  AT-CITY-STATE.
  1951             20  AT-CITY                 PIC X(28).
  1952             20  AT-STATE                PIC XX.
  1953         16  AT-ZIP.
  1954             20  AT-ZIP-CODE.
  1955                 24  AT-ZIP-1ST          PIC X.
  1956                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1957                 24  FILLER              PIC X(4).
  1958             20  AT-ZIP-PLUS4            PIC X(4).
  1959         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  1960             20  AT-CAN-POSTAL-1         PIC XXX.
  1961             20  AT-CAN-POSTAL-2         PIC XXX.
  1962             20  FILLER                  PIC XXX.
  1963         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  1964         16  FILLER                      PIC X(23).
  1965         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  1966         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  1967
  1968     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1969         16  AT-INFO-LINE-1              PIC X(60).
  1970         16  AT-INFO-LINE-2              PIC X(60).
  1971         16  AT-INFO-TRAILER-TYPE        PIC X.
  1972             88  AT-PAYMENT-NOTE         VALUE 'P'.
  1973             88  AT-CALL-NOTE            VALUE 'C'.
  1974             88  AT-MAINT-NOTE           VALUE 'M'.
  1975             88  AT-CERT-CHANGE          VALUE 'X'.
  1976             88  AT-APPROVAL-NOTE        VALUE 'R'.
  1977             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  1978         16  AT-CALL-TYPE                PIC X.
  1979             88  AT-PHONE-CALL-IN        VALUE 'I'.
  1980             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  1981         16  AT-NOTE-CONTINUATION        PIC X.
  1982             88  AT-CONTINUED-NOTE       VALUE 'X'.
  1983         16  AT-EOB-CODES-EXIST          PIC X.
  1984             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  1985         16  FILLER                      PIC X(35).
  1986         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  1987         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  1988
  1989     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  41
* EL151.cbl
  1990         16  AT-PROMPT-LINE-1            PIC X(60).
  1991         16  AT-PROMPT-LINE-2            PIC X(60).
  1992         16  AT-PROMPT-START-DT          PIC XX.
  1993         16  AT-PROMPT-END-DT            PIC XX.
  1994         16  FILLER                      PIC X(35).
  1995         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  1996         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  1997
  1998     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1999         16  AT-DENIAL-INFO-1            PIC X(60).
  2000         16  AT-DENIAL-INFO-2            PIC X(60).
  2001         16  AT-DENIAL-DT                PIC XX.
  2002         16  AT-RETRACTION-DT            PIC XX.
  2003         16  AT-DENIAL-REASON-CODE       PIC X(4).
  2004*         16  FILLER                      PIC X(31).
  2005         16  AT-DENIAL-PROOF-DT          PIC XX.
  2006         16  FILLER                      PIC X(29).
  2007         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  2008         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  2009
  2010     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  2011         16  AT-OLD-INCURRED-DT          PIC XX.
  2012         16  AT-OLD-REPORTED-DT          PIC XX.
  2013         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  2014         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  2015         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  2016         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  2017         16  AT-OLD-PAID-THRU-DT         PIC XX.
  2018         16  AT-LAST-PMT-MADE-DT         PIC XX.
  2019         16  FILLER                      PIC X(26).
  2020         16  AT-OLD-DIAG-CODE            PIC X(6).
  2021         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  2022         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  2023         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  2024         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  2025         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  2026         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  2027         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  2028         16  FILLER                      PIC X(25).
  2029         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  2030
  2031     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  2032         16  AT-FORM-SEND-ON-DT          PIC XX.
  2033         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  2034         16  AT-FORM-RE-SEND-DT          PIC XX.
  2035         16  AT-FORM-ANSWERED-DT         PIC XX.
  2036         16  AT-FORM-PRINTED-DT          PIC XX.
  2037         16  AT-FORM-REPRINT-DT          PIC XX.
  2038         16  AT-FORM-TYPE                PIC X.
  2039             88  INITIAL-FORM                  VALUE '1'.
  2040             88  PROGRESS-FORM                 VALUE '2'.
  2041         16  AT-INSTRUCT-LN-1            PIC X(28).
  2042         16  AT-INSTRUCT-LN-2            PIC X(28).
  2043         16  AT-INSTRUCT-LN-3            PIC X(28).
  2044         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  2045         16  AT-FORM-ADDRESS             PIC X.
  2046             88  FORM-TO-INSURED              VALUE 'I'.
  2047             88  FORM-TO-ACCOUNT              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  42
* EL151.cbl
  2048             88  FORM-TO-OTHER-1              VALUE 'O'.
  2049             88  FORM-TO-OTHER-2              VALUE 'Q'.
  2050         16  AT-RELATED-1.
  2051             20 AT-REL-CARR-1            PIC X.
  2052             20 AT-REL-CLAIM-1           PIC X(7).
  2053             20 AT-REL-CERT-1            PIC X(11).
  2054         16  AT-RELATED-2.
  2055             20 AT-REL-CARR-2            PIC X.
  2056             20 AT-REL-CLAIM-2           PIC X(7).
  2057             20 AT-REL-CERT-2            PIC X(11).
  2058         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  2059         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  2060         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  2061         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  2062         16  AT-FORM-REM-PRINT-DT        PIC XX.
  2063         16  AT-STOP-FORM-DT             PIC X(2).
  2064
  2065         16  FILLER                      PIC X(09).
  2066         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  2067         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  2068******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  43
* EL151.cbl
  2070*                                    COPY ELCARCH.
  2071******************************************************************
  2072*                                                                *
  2073*                            ELCARCH.                            *
  2074*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2075*                            VMOD=2.007                          *
  2076*                                                                *
  2077*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  2078*                                                                *
  2079*   FILE TYPE = VSAM,KSDS                                        *
  2080*   RECORD SIZE = 090  RECFORM = FIXED                           *
  2081*                                                                *
  2082*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  2083*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  2084*                                                                *
  2085*   LOG = NO                                                     *
  2086*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2087*                                                                *
  2088*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  2089******************************************************************
  2090 01  LETTER-ARCHIVE.
  2091     12  LA-RECORD-ID                PIC XX.
  2092         88  VALID-LA-ID                VALUE 'LA'.
  2093
  2094     12  LA-CONTROL-PRIMARY.
  2095         16  LA-COMPANY-CD           PIC X.
  2096         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  2097         16  LA-RECORD-TYPE          PIC X.
  2098             88  LA-HEADER-DATA         VALUE '1'.
  2099             88  LA-ADDRESS-DATA        VALUE '2'.
  2100             88  LA-TEXT-DATA           VALUE '3'.
  2101             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  2102         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  2103
  2104     12  LA-CONTROL-BY-TYPE.
  2105         16  LA-COMPANY-CD-A1        PIC X.
  2106         16  LA-RECORD-TYPE-A1       PIC X.
  2107         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  2108         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  2109
  2110     12  LA-TEXT-RECORD.
  2111         16  LA-SKIP-CONTROL         PIC XX.
  2112             88  NO-LINES-SKIPPED       VALUE SPACES.
  2113             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  2114         16  LA-TEXT-LINE            PIC X(70).
  2115
  2116     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  2117         16  FILLER                  PIC XX.
  2118         16  LA-ADDRESS-LINE         PIC X(30).
  2119         16  FILLER                  PIC X(40).
  2120
  2121     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  2122         16  FILLER                  PIC XX.
  2123         16  LA-CARRIER              PIC X.
  2124         16  LA-CLAIM-NO             PIC X(7).
  2125         16  LA-CERT-NO.
  2126             20  LA-CERT-PRIME       PIC X(10).
  2127             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  44
* EL151.cbl
  2128         16  LA-NO-OF-COPIES         PIC S9.
  2129         16  LA-RESEND-DATE          PIC XX.
  2130         16  LA-PROCESSOR-CD         PIC X(4).
  2131         16  LA-CREATION-DT          PIC XX.
  2132         16  LA-INITIAL-PRINT-DATE   PIC XX.
  2133         16  LA-RESEND-PRINT-DATE    PIC XX.
  2134         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  2135         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  2136*
  2137* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  2138*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  2139*   I        20  LA-DMD-PROD-CODE        PIC XX.
  2140*   I        20  LA-DMD-RES-ST           PIC XX.
  2141*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  2142*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  2143*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  2144*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  2145*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  2146*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  2147*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  2148*   I        20  LA-DMD-UND-CODE         PIC XX.
  2149*   I        20  LA-DMD-BEN-CODE         PIC XX.
  2150*   V    16  FILLER                  PIC X(15).
  2151* -----
  2152*
  2153* REINSERTED  CSO  MODS
  2154*
  2155         16  FILLER.
  2156             20  FILLER                  PIC X(29).
  2157             20  LA-CSO-LETTER-STATUS    PIC X.
  2158                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  2159                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  2160                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  2161             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  2162             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  2163*
  2164
  2165     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  2166         16  FILLER                  PIC XX.
  2167         16  LA4-CARRIER             PIC X.
  2168         16  LA4-CLAIM-NO            PIC X(7).
  2169         16  LA4-CERT-NO.
  2170             20  LA4-CERT-PRIME      PIC X(10).
  2171             20  LA4-CERT-SFX        PIC X.
  2172         16  LA4-NO-OF-COPIES        PIC S9.
  2173         16  LA4-RESEND-DATE         PIC XX.
  2174         16  LA4-PROCESSOR-CD        PIC X(4).
  2175         16  LA4-CREATION-DT         PIC XX.
  2176         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  2177         16  LA4-RESEND-PRINT-DATE   PIC XX.
  2178         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  2179         16  LA4-FORM-TYPE           PIC X.
  2180             88  LA4-INITIAL-FORM    VALUE '1'.
  2181             88  LA4-PROGRESS-FORM   VALUE '2'.
  2182         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  2183         16  LA4-STATE               PIC X(02).
  2184         16  FILLER                  PIC X(31).
  2185******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  45
* EL151.cbl
  2187*                                    COPY ELCCNTL.
  2188******************************************************************
  2189*                                                                *
  2190*                                                                *
  2191*                            ELCCNTL.                            *
  2192*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2193*                            VMOD=2.059                          *
  2194*                                                                *
  2195*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2196*                                                                *
  2197*   FILE TYPE = VSAM,KSDS                                        *
  2198*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2199*                                                                *
  2200*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2201*       ALTERNATE INDEX = NONE                                   *
  2202*                                                                *
  2203*   LOG = YES                                                    *
  2204*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2205******************************************************************
  2206*                   C H A N G E   L O G
  2207*
  2208* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2209*-----------------------------------------------------------------
  2210*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2211* EFFECTIVE    NUMBER
  2212*-----------------------------------------------------------------
  2213* 082503                   PEMA  ADD BENEFIT GROUP
  2214* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2215* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2216* 092705    2005050300006  PEMA  ADD SPP LEASES
  2217* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2218* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2219* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2220* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2221******************************************************************
  2222*
  2223 01  CONTROL-FILE.
  2224     12  CF-RECORD-ID                       PIC XX.
  2225         88  VALID-CF-ID                        VALUE 'CF'.
  2226
  2227     12  CF-CONTROL-PRIMARY.
  2228         16  CF-COMPANY-ID                  PIC XXX.
  2229         16  CF-RECORD-TYPE                 PIC X.
  2230             88  CF-COMPANY-MASTER              VALUE '1'.
  2231             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2232             88  CF-STATE-MASTER                VALUE '3'.
  2233             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2234             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2235             88  CF-CARRIER-MASTER              VALUE '6'.
  2236             88  CF-MORTALITY-MASTER            VALUE '7'.
  2237             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2238             88  CF-TERMINAL-MASTER             VALUE '9'.
  2239             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2240             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2241             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2242             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2243             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2244             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  46
* EL151.cbl
  2245             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2246             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2247             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2248         16  CF-ACCESS-CD-GENL              PIC X(4).
  2249         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2250             20  CF-PROCESSOR               PIC X(4).
  2251         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2252             20  CF-STATE-CODE              PIC XX.
  2253             20  FILLER                     PIC XX.
  2254         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2255             20  FILLER                     PIC XX.
  2256             20  CF-HI-BEN-IN-REC           PIC XX.
  2257         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2258             20  FILLER                     PIC XXX.
  2259             20  CF-CARRIER-CNTL            PIC X.
  2260         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2261             20  FILLER                     PIC XX.
  2262             20  CF-HI-TYPE-IN-REC          PIC 99.
  2263         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2264             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2265                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2266             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2267             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2268         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2269             20  FILLER                     PIC X.
  2270             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2271         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2272             20  FILLER                     PIC XX.
  2273             20  CF-MORTGAGE-PLAN           PIC XX.
  2274         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2275
  2276     12  CF-LAST-MAINT-DT                   PIC XX.
  2277     12  CF-LAST-MAINT-BY                   PIC X(4).
  2278     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2279
  2280     12  CF-RECORD-BODY                     PIC X(728).
  2281
  2282
  2283****************************************************************
  2284*             COMPANY MASTER RECORD                            *
  2285****************************************************************
  2286
  2287     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2288         16  CF-COMPANY-ADDRESS.
  2289             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2290             20  CF-CL-IN-CARE-OF           PIC X(30).
  2291             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2292             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2293             20  CF-CL-CITY-STATE           PIC X(30).
  2294             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2295             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2296         16  CF-COMPANY-CD                  PIC X.
  2297         16  CF-COMPANY-PASSWORD            PIC X(8).
  2298         16  CF-SECURITY-OPTION             PIC X.
  2299             88  ALL-SECURITY                   VALUE '1'.
  2300             88  COMPANY-VERIFY                 VALUE '2'.
  2301             88  PROCESSOR-VERIFY               VALUE '3'.
  2302             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  47
* EL151.cbl
  2303             88  ALL-BUT-TERM                   VALUE '5'.
  2304         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2305             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2306         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2307             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2308         16  CF-INFORCE-LOCATION            PIC X.
  2309             88  CERTS-ARE-ONLINE               VALUE '1'.
  2310             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2311             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2312         16  CF-LOWER-CASE-LETTERS          PIC X.
  2313         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2314             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2315             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2316             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2317             88  CF-ACCNT-CNTL                  VALUE '3'.
  2318             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2319
  2320         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2321         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2322
  2323         16  CF-LGX-CREDIT-USER             PIC X.
  2324             88  CO-IS-NOT-USER                 VALUE 'N'.
  2325             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2326
  2327         16 CF-CREDIT-CALC-CODES.
  2328             20  CF-CR-REM-TERM-CALC PIC X.
  2329               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2330               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2331               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2332               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2333               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2334               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2335               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2336             20  CF-CR-R78-METHOD           PIC X.
  2337               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2338               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2339
  2340         16  CF-CLAIM-CONTROL-COUNTS.
  2341             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2342                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2343
  2344             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2345                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2346
  2347             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2348                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2349
  2350             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2351                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2352
  2353         16  CF-CURRENT-MONTH-END           PIC XX.
  2354
  2355         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2356             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2357             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2358             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2359             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2360                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  48
* EL151.cbl
  2361                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2362             20  CF-CO-PREM-REJECT-SW       PIC X.
  2363                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2364                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2365             20  CF-CO-REF-REJECT-SW        PIC X.
  2366                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2367                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2368
  2369         16  CF-CO-REPORTING-DT             PIC XX.
  2370         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2371         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2372           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2373           88  CF-CO-MONTH-END                  VALUE '1'.
  2374
  2375         16  CF-LGX-CLAIM-USER              PIC X.
  2376             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2377             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2378
  2379         16  CF-CREDIT-EDIT-CONTROLS.
  2380             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2381             20  CF-MIN-AGE                 PIC 99.
  2382             20  CF-DEFAULT-AGE             PIC 99.
  2383             20  CF-MIN-TERM                PIC S999      COMP-3.
  2384             20  CF-MAX-TERM                PIC S999      COMP-3.
  2385             20  CF-DEFAULT-SEX             PIC X.
  2386             20  CF-JOINT-AGE-INPUT         PIC X.
  2387                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2388             20  CF-BIRTH-DATE-INPUT        PIC X.
  2389                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2390             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2391                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2392                 88  CF-ZERO-CARRIER            VALUE '1'.
  2393                 88  CF-ZERO-GROUPING           VALUE '2'.
  2394                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2395             20  CF-EDIT-SW                 PIC X.
  2396                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2397             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2398             20  CF-CR-PR-METHOD            PIC X.
  2399               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2400               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2401             20  FILLER                     PIC X.
  2402
  2403         16  CF-CREDIT-MISC-CONTROLS.
  2404             20  CF-REIN-TABLE-SW           PIC X.
  2405                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2406             20  CF-COMP-TABLE-SW           PIC X.
  2407                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2408             20  CF-EXPERIENCE-RETENTION-AGE
  2409                                            PIC S9        COMP-3.
  2410             20  CF-CONVERSION-DT           PIC XX.
  2411             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2412             20  CF-RUN-FREQUENCY-SW        PIC X.
  2413                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2414                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2415
  2416             20  CF-CR-CHECK-NO-CONTROL.
  2417                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2418                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  49
* EL151.cbl
  2419                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2420                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2421                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2422                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2423
  2424                 24  CF-CR-CHECK-COUNT       REDEFINES
  2425                     CF-CR-CHECK-COUNTER      PIC X(4).
  2426
  2427                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2428                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2429
  2430                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2431                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2432                 24  CF-MAIL-PROCESSING       PIC X.
  2433                     88  MAIL-PROCESSING          VALUE 'Y'.
  2434
  2435         16  CF-MISC-SYSTEM-CONTROL.
  2436             20  CF-SYSTEM-C                 PIC X.
  2437                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2438             20  CF-SYSTEM-D                 PIC X.
  2439                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2440             20  CF-SOC-SEC-NO-SW            PIC X.
  2441                 88  SOC-SEC-NO-USED             VALUE '1'.
  2442             20  CF-MEMBER-NO-SW             PIC X.
  2443                 88  MEMBER-NO-USED              VALUE '1'.
  2444             20  CF-TAX-ID-NUMBER            PIC X(11).
  2445             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2446             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2447                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2448                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2449                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2450                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2451             20  CF-SYSTEM-E                 PIC X.
  2452                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2453
  2454         16  CF-LGX-LIFE-USER               PIC X.
  2455             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2456             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2457
  2458         16  CF-CR-MONTH-END-DT             PIC XX.
  2459
  2460         16  CF-FILE-MAINT-DATES.
  2461             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2462                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2463             20  CF-LAST-BATCH       REDEFINES
  2464                 CF-LAST-BATCH-NO               PIC X(4).
  2465             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2466             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2467             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2468             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2469             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2470             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2471             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2472             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2473             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2474             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2475
  2476         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  50
* EL151.cbl
  2477         16  FILLER                         PIC X.
  2478
  2479         16  CF-ALT-MORT-CODE               PIC X(4).
  2480         16  CF-MEMBER-CAPTION              PIC X(10).
  2481
  2482         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2483             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2484             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2485             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2486             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2487             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2488
  2489         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2490
  2491         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2492         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2493         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2494         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2495
  2496         16  CF-AH-OVERRIDE-L1              PIC X.
  2497         16  CF-AH-OVERRIDE-L2              PIC XX.
  2498         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2499         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2500
  2501         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2502         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2503
  2504         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2505         16  CF-AR-LAST-EL860-DT            PIC XX.
  2506         16  CF-MP-MONTH-END-DT             PIC XX.
  2507
  2508         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2509         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2510             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2511
  2512         16  CF-AR-MONTH-END-DT             PIC XX.
  2513
  2514         16  CF-CRDTCRD-USER                PIC X.
  2515             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2516             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2517
  2518         16  CF-CC-MONTH-END-DT             PIC XX.
  2519
  2520         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2521
  2522         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2523             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2524             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2525             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2526         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2527         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2528         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2529         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2530             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2531             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2532         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2533         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2534         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  51
* EL151.cbl
  2535             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2536         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2537
  2538         16  CF-CL-ZIP-CODE.
  2539             20  CF-CL-ZIP-PRIME.
  2540                 24  CF-CL-ZIP-1ST          PIC X.
  2541                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2542                 24  FILLER                 PIC X(4).
  2543             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2544         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2545             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2546             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2547             20  FILLER                     PIC XXX.
  2548
  2549         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2550         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2551         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2552         16  CF-CO-OPTION-START-DATE        PIC XX.
  2553         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2554           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2555                                                      '3' '4'.
  2556           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2557           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2558           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2559           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2560           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2561           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2562
  2563         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2564
  2565         16  CF-PAYMENT-APPROVAL-LEVELS.
  2566             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2567             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2568             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2569             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2570             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2571             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2572
  2573         16  CF-END-USER-REPORTING-USER     PIC X.
  2574             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2575             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2576
  2577         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2578             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2579             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2580
  2581         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2582
  2583         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2584         16  FILLER                         PIC X.
  2585
  2586         16  CF-CREDIT-ARCHIVE-CNTL.
  2587             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2588             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2589             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2590
  2591         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2592
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  52
* EL151.cbl
  2593         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2594             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2595             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2596
  2597         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2598             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2599             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2600
  2601         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2602
  2603         16  CF-CO-ACH-ID-CODE              PIC  X.
  2604             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2605             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2606             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2607         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2608         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2609         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2610         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2611         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2612         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2613         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2614         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2615         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2616                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2617         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2618                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2619
  2620         16  CF-CO-OVER-SHORT.
  2621             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2622             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2623
  2624*         16  FILLER                         PIC X(102).
  2625         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2626             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2627             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2628
  2629         16  CF-AH-APPROVAL-DAYS.
  2630             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2631             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2632             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2633             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2634
  2635         16  FILLER                         PIC X(82).
  2636****************************************************************
  2637*             PROCESSOR/USER RECORD                            *
  2638****************************************************************
  2639
  2640     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2641         16  CF-PROCESSOR-NAME              PIC X(30).
  2642         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2643         16  CF-PROCESSOR-TITLE             PIC X(26).
  2644         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2645                 88  MESSAGE-YES                VALUE 'Y'.
  2646                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2647
  2648*****************************************************
  2649****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2650****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  53
* EL151.cbl
  2651****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2652****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2653*****************************************************
  2654
  2655         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2656             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2657             20  CF-APPLICATION-FORCE       PIC X.
  2658             20  CF-INDIVIDUAL-APP.
  2659                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2660                     28  CF-BROWSE-APP      PIC X.
  2661                     28  CF-UPDATE-APP      PIC X.
  2662
  2663         16  CF-CURRENT-TERM-ON             PIC X(4).
  2664         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2665             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2666             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2667             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2668             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2669             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2670             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2671             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2672         16  CF-PROCESSOR-CARRIER           PIC X.
  2673             88  NO-CARRIER-SECURITY            VALUE ' '.
  2674         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2675             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2676         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2677             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2678         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2679             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2680
  2681         16  CF-PROC-SYS-ACCESS-SW.
  2682             20  CF-PROC-CREDIT-CLAIMS-SW.
  2683                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2684                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2685                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2686                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2687             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2688                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2689                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2690             20  CF-PROC-LIFE-GNRLDGR-SW.
  2691                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2692                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2693                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2694                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2695             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2696                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2697                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2698         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2699             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2700             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2701         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2702
  2703         16  CF-APPROVAL-LEVEL                  PIC X.
  2704             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2705             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2706             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2707             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2708
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  54
* EL151.cbl
  2709         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2710
  2711         16  CF-LANGUAGE-TYPE                   PIC X.
  2712             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2713             88  CF-LANG-IS-FR                      VALUE 'F'.
  2714         16  FILLER                             PIC  X(240).
  2715
  2716****************************************************************
  2717*             PROCESSOR/REMINDERS RECORD                       *
  2718****************************************************************
  2719
  2720     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2721         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2722             20  CF-START-REMIND-DT         PIC XX.
  2723             20  CF-END-REMIND-DT           PIC XX.
  2724             20  CF-REMINDER-TEXT           PIC X(50).
  2725         16  FILLER                         PIC X(296).
  2726
  2727
  2728****************************************************************
  2729*             STATE MASTER RECORD                              *
  2730****************************************************************
  2731
  2732     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2733         16  CF-STATE-ABBREVIATION          PIC XX.
  2734         16  CF-STATE-NAME                  PIC X(25).
  2735         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2736         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2737             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2738             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2739             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2740             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2741                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2742                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2743             20  CF-ST-PREM-REJECT-SW       PIC X.
  2744                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2745                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2746             20  CF-ST-REF-REJECT-SW        PIC X.
  2747                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2748                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2749         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2750         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2751         16  CF-ST-REFUND-RULES.
  2752             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2753             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2754             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2755         16  CF-ST-FST-PMT-EXTENSION.
  2756             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2757             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2758                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2759                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2760                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2761                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2762         16  CF-ST-STATE-CALL.
  2763             20  CF-ST-CALL-UNEARNED        PIC X.
  2764             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2765             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2766         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  55
* EL151.cbl
  2767             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2768             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2769         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2770         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2771         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2772         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2773         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2774         16  FILLER                         PIC X.
  2775         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2776             20  CF-ST-BENEFIT-CD           PIC XX.
  2777             20  CF-ST-BENEFIT-KIND         PIC X.
  2778                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2779                 88  CF-ST-AH-KIND              VALUE 'A'.
  2780             20  CF-ST-REM-TERM-CALC        PIC X.
  2781                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2782                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2783                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2784                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2785                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2786                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2787                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2788                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2789
  2790             20  CF-ST-REFUND-CALC          PIC X.
  2791                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2792                 88  ST-REFD-BY-R78             VALUE '1'.
  2793                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2794                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2795                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2796                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2797                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2798                 88  ST-REFD-UTAH               VALUE '7'.
  2799                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2800                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2801                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2802
  2803             20  CF-ST-EARNING-CALC         PIC X.
  2804                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2805                 88  ST-EARN-BY-R78             VALUE '1'.
  2806                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2807                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2808                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2809                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2810                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2811                 88  ST-EARN-MEAN               VALUE '8'.
  2812                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2813
  2814             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2815                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2816                 88  ST-OVRD-BY-R78             VALUE '1'.
  2817                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2818                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2819                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2820                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2821                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2822                 88  ST-OVRD-MEAN               VALUE '8'.
  2823                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2824             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  56
* EL151.cbl
  2825
  2826         16  CF-ST-COMMISSION-CAPS.
  2827             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2828             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2829             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2830             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2831         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2832                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2833
  2834         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2835
  2836         16  CF-ST-STATUTORY-INTEREST.
  2837             20  CF-ST-STAT-DATE-FROM       PIC X.
  2838                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2839                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2840             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2841             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2842             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2843             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2844             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2845
  2846         16  CF-ST-OVER-SHORT.
  2847             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2848             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2849
  2850         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2851
  2852         16  CF-ST-RT-CALC                  PIC X.
  2853
  2854         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2855         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2856         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2857         16  CF-ST-RF-LR-CALC               PIC X.
  2858         16  CF-ST-RF-LL-CALC               PIC X.
  2859         16  CF-ST-RF-LN-CALC               PIC X.
  2860         16  CF-ST-RF-AH-CALC               PIC X.
  2861         16  CF-ST-RF-CP-CALC               PIC X.
  2862*        16  FILLER                         PIC X(206).
  2863*CIDMOD         16  FILLER                         PIC X(192).
  2864         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2865             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2866         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2867         16  FILLER                         PIC X(187).
  2868
  2869****************************************************************
  2870*             BENEFIT MASTER RECORD                            *
  2871****************************************************************
  2872
  2873     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2874         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2875             20  CF-BENEFIT-CODE            PIC XX.
  2876             20  CF-BENEFIT-NUMERIC  REDEFINES
  2877                 CF-BENEFIT-CODE            PIC XX.
  2878             20  CF-BENEFIT-ALPHA           PIC XXX.
  2879             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2880             20  CF-BENEFIT-COMMENT         PIC X(10).
  2881
  2882             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  57
* EL151.cbl
  2883                 88  CF-REDUCING                VALUE 'R'.
  2884                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2885
  2886             20  CF-SPECIAL-CALC-CD         PIC X.
  2887                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2888                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2889                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2890                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2891                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2892                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2893                 88  CF-FARM-PLAN               VALUE 'F'.
  2894                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2895                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2896                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2897                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2898                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2899                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2900                 88  CF-PRUDENTIAL              VALUE 'P'.
  2901                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2902                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2903                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2904                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2905                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2906                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2907
  2908             20  CF-JOINT-INDICATOR         PIC X.
  2909                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2910
  2911*            20  FILLER                     PIC X(12).
  2912             20  FILLER                     PIC X(11).
  2913             20  CF-BENEFIT-CATEGORY        PIC X.
  2914             20  CF-LOAN-TYPE               PIC X(8).
  2915
  2916             20  CF-CO-REM-TERM-CALC        PIC X.
  2917                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2918                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2919                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2920                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2921                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2922
  2923             20  CF-CO-EARNINGS-CALC        PIC X.
  2924                 88  CO-EARN-BY-R78             VALUE '1'.
  2925                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2926                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2927                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2928                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2929                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2930                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2931                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2932
  2933             20  CF-CO-REFUND-CALC          PIC X.
  2934                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2935                 88  CO-REFD-BY-R78             VALUE '1'.
  2936                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2937                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2938                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2939                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2940                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  58
* EL151.cbl
  2941                 88  CO-REFD-MEAN               VALUE '8'.
  2942                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2943                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2944                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2945
  2946             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2947                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2948                 88  CO-OVRD-BY-R78             VALUE '1'.
  2949                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2950                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2951                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2952                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2953                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2954                 88  CO-OVRD-MEAN               VALUE '8'.
  2955                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2956
  2957             20  CF-CO-BEN-I-G-CD           PIC X.
  2958                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2959                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2960                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2961
  2962         16  FILLER                         PIC X(304).
  2963
  2964
  2965****************************************************************
  2966*             CARRIER MASTER RECORD                            *
  2967****************************************************************
  2968
  2969     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2970         16  CF-ADDRESS-DATA.
  2971             20  CF-MAIL-TO-NAME            PIC X(30).
  2972             20  CF-IN-CARE-OF              PIC X(30).
  2973             20  CF-ADDRESS-LINE-1          PIC X(30).
  2974             20  CF-ADDRESS-LINE-2          PIC X(30).
  2975             20  CF-CITY-STATE              PIC X(30).
  2976             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2977             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2978
  2979         16  CF-CLAIM-NO-CONTROL.
  2980             20  CF-CLAIM-NO-METHOD         PIC X.
  2981                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2982                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2983                 88  CLAIM-NO-SEQ               VALUE '3'.
  2984                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2985             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2986                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2987                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2988                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2989
  2990         16  CF-CHECK-NO-CONTROL.
  2991             20  CF-CHECK-NO-METHOD         PIC X.
  2992                 88  CHECK-NO-MANUAL            VALUE '1'.
  2993                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2994                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2995                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2996             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2997                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2998
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  59
* EL151.cbl
  2999         16  CF-DOMICILE-STATE              PIC XX.
  3000
  3001         16  CF-EXPENSE-CONTROLS.
  3002             20  CF-EXPENSE-METHOD          PIC X.
  3003                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3004                 88  DOLLARS-PER-PMT            VALUE '2'.
  3005                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3006                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3007             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3008             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3009
  3010         16  CF-CORRESPONDENCE-CONTROL.
  3011             20  CF-LETTER-RESEND-OPT       PIC X.
  3012                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3013                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3014             20  FILLER                     PIC X(4).
  3015
  3016         16  CF-RESERVE-CONTROLS.
  3017             20  CF-MANUAL-SW               PIC X.
  3018                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3019             20  CF-FUTURE-SW               PIC X.
  3020                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3021             20  CF-PTC-SW                  PIC X.
  3022                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3023             20  CF-IBNR-SW                 PIC X.
  3024                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3025             20  CF-PTC-LF-SW               PIC X.
  3026                 88  CF-LF-PTC-USED             VALUE '1'.
  3027             20  CF-CDT-ACCESS-METHOD       PIC X.
  3028                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3029                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3030                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3031             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3032
  3033         16  CF-CLAIM-CALC-METHOD           PIC X.
  3034             88  360-PLUS-MONTHS                VALUE '1'.
  3035             88  365-PLUS-MONTHS                VALUE '2'.
  3036             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3037             88  360-DAILY                      VALUE '4'.
  3038             88  365-DAILY                      VALUE '5'.
  3039
  3040         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3041         16  FILLER                         PIC X(11).
  3042
  3043         16  CF-LIMIT-AMOUNTS.
  3044             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3045             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3046             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3047             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3048             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3049             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3050             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3051             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3052             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3053             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3054
  3055         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3056         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  60
* EL151.cbl
  3057         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3058
  3059         16  CF-ZIP-CODE.
  3060             20  CF-ZIP-PRIME.
  3061                 24  CF-ZIP-1ST             PIC X.
  3062                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3063                 24  FILLER                 PIC X(4).
  3064             20  CF-ZIP-PLUS4               PIC X(4).
  3065         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3066             20  CF-CAN-POSTAL-1            PIC XXX.
  3067             20  CF-CAN-POSTAL-2            PIC XXX.
  3068             20  FILLER                     PIC XXX.
  3069
  3070         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3071         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3072         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3073
  3074         16  CF-RATING-SWITCH               PIC X.
  3075             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3076             88  CF-NO-RATING                   VALUE 'N'.
  3077
  3078         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3079
  3080         16  CF-CARRIER-OVER-SHORT.
  3081             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3082             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3083
  3084         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3085         16  CF-SECPAY-SWITCH               PIC X.
  3086             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3087             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3088         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3089         16  FILLER                         PIC X(448).
  3090*        16  FILLER                         PIC X(452).
  3091
  3092
  3093****************************************************************
  3094*             MORTALITY MASTER RECORD                          *
  3095****************************************************************
  3096
  3097     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3098         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3099                                INDEXED BY CF-MORT-NDX.
  3100             20  CF-MORT-TABLE              PIC X(5).
  3101             20  CF-MORT-TABLE-TYPE         PIC X.
  3102                 88  CF-MORT-JOINT              VALUE 'J'.
  3103                 88  CF-MORT-SINGLE             VALUE 'S'.
  3104                 88  CF-MORT-COMBINED           VALUE 'C'.
  3105                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3106                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3107             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3108             20  CF-MORT-AGE-METHOD         PIC XX.
  3109                 88  CF-AGE-LAST                VALUE 'AL'.
  3110                 88  CF-AGE-NEAR                VALUE 'AN'.
  3111             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3112             20  CF-MORT-ADJUSTMENT-DIRECTION
  3113                                            PIC X.
  3114                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  61
* EL151.cbl
  3115                 88  CF-PLUS                    VALUE '+'.
  3116             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3117             20  CF-MORT-JOINT-CODE         PIC X.
  3118                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3119             20  CF-MORT-PC-Q               PIC X.
  3120                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3121             20  CF-MORT-TABLE-CODE         PIC X(4).
  3122             20  CF-MORT-COMMENTS           PIC X(15).
  3123             20  FILLER                     PIC X(14).
  3124
  3125         16  FILLER                         PIC X(251).
  3126
  3127
  3128****************************************************************
  3129*             BUSSINESS TYPE MASTER RECORD                     *
  3130****************************************************************
  3131
  3132     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3133* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3134* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3135* AND RECORD 05 IS TYPES 81-99
  3136         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3137             20  CF-BUSINESS-TITLE          PIC  X(19).
  3138             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3139                                            PIC S9V9(4) COMP-3.
  3140             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3141             20  FILLER                     PIC  X.
  3142         16  FILLER                         PIC  X(248).
  3143
  3144
  3145****************************************************************
  3146*             TERMINAL MASTER RECORD                           *
  3147****************************************************************
  3148
  3149     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3150
  3151         16  CF-COMPANY-TERMINALS.
  3152             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3153                                  PIC X(4).
  3154         16  FILLER               PIC X(248).
  3155
  3156
  3157****************************************************************
  3158*             LIFE EDIT MASTER RECORD                          *
  3159****************************************************************
  3160
  3161     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3162         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3163             20  CF-LIFE-CODE-IN            PIC XX.
  3164             20  CF-LIFE-CODE-OUT           PIC XX.
  3165         16  FILLER                         PIC X(248).
  3166
  3167
  3168****************************************************************
  3169*             AH EDIT MASTER RECORD                            *
  3170****************************************************************
  3171
  3172     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  62
* EL151.cbl
  3173         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3174             20  CF-AH-CODE-IN              PIC XXX.
  3175             20  CF-AH-CODE-OUT             PIC XX.
  3176         16  FILLER                         PIC X(248).
  3177
  3178
  3179****************************************************************
  3180*             CREDIBILITY TABLES                               *
  3181****************************************************************
  3182
  3183     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3184         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3185                             INDEXED BY CF-CRDB-NDX.
  3186             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3187             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3188             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3189         16  FILLER                         PIC  X(332).
  3190
  3191
  3192****************************************************************
  3193*             REPORT CUSTOMIZATION RECORD                      *
  3194****************************************************************
  3195
  3196     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3197         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3198             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3199             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3200             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3201**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3202****       A T-TRANSFER.                                   ****
  3203             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3204
  3205         16  FILLER                         PIC XX.
  3206
  3207         16  CF-CARRIER-CNTL-OPT.
  3208             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3209                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3210                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3211             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3212                                            PIC X.
  3213         16  CF-GROUP-CNTL-OPT.
  3214             20  CF-GROUP-OPT-SEQ           PIC 9.
  3215                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3216                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3217             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3218                                            PIC X(6).
  3219         16  CF-STATE-CNTL-OPT.
  3220             20  CF-STATE-OPT-SEQ           PIC 9.
  3221                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3222                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3223             20  CF-STATE-SELECT OCCURS 3 TIMES
  3224                                            PIC XX.
  3225         16  CF-ACCOUNT-CNTL-OPT.
  3226             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3227                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3228                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3229             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3230                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  63
* EL151.cbl
  3231         16  CF-BUS-TYP-CNTL-OPT.
  3232             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3233                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3234                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3235             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3236                                            PIC XX.
  3237         16  CF-LF-TYP-CNTL-OPT.
  3238             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3239                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3240                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3241             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3242                                            PIC XX.
  3243         16  CF-AH-TYP-CNTL-OPT.
  3244             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3245                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3246                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3247             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3248                                            PIC XX.
  3249         16  CF-REPTCD1-CNTL-OPT.
  3250             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3251                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3252                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3253             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3254                                            PIC X(10).
  3255         16  CF-REPTCD2-CNTL-OPT.
  3256             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3257                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3258                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3259             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3260                                            PIC X(10).
  3261         16  CF-USER1-CNTL-OPT.
  3262             20  CF-USER1-OPT-SEQ           PIC 9.
  3263                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3264                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3265             20  CF-USER1-SELECT OCCURS 3 TIMES
  3266                                            PIC X(10).
  3267         16  CF-USER2-CNTL-OPT.
  3268             20  CF-USER2-OPT-SEQ           PIC 9.
  3269                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3270                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3271             20  CF-USER2-SELECT OCCURS 3 TIMES
  3272                                            PIC X(10).
  3273         16  CF-USER3-CNTL-OPT.
  3274             20  CF-USER3-OPT-SEQ           PIC 9.
  3275                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3276                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3277             20  CF-USER3-SELECT OCCURS 3 TIMES
  3278                                            PIC X(10).
  3279         16  CF-USER4-CNTL-OPT.
  3280             20  CF-USER4-OPT-SEQ           PIC 9.
  3281                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3282                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3283             20  CF-USER4-SELECT OCCURS 3 TIMES
  3284                                            PIC X(10).
  3285         16  CF-USER5-CNTL-OPT.
  3286             20  CF-USER5-OPT-SEQ           PIC 9.
  3287                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3288                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  64
* EL151.cbl
  3289             20  CF-USER5-SELECT OCCURS 3 TIMES
  3290                                            PIC X(10).
  3291         16  CF-REINS-CNTL-OPT.
  3292             20  CF-REINS-OPT-SEQ           PIC 9.
  3293                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3294                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3295             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3296                 24  CF-REINS-PRIME         PIC XXX.
  3297                 24  CF-REINS-SUB           PIC XXX.
  3298
  3299         16  CF-AGENT-CNTL-OPT.
  3300             20  CF-AGENT-OPT-SEQ           PIC 9.
  3301                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3302                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3303             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3304                                            PIC X(10).
  3305
  3306         16  FILLER                         PIC X(43).
  3307
  3308         16  CF-LOSS-RATIO-SELECT.
  3309             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3310             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3311         16  CF-ENTRY-DATE-SELECT.
  3312             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3313             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3314         16  CF-EFFECTIVE-DATE-SELECT.
  3315             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3316             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3317
  3318         16  CF-EXCEPTION-LIST-IND          PIC X.
  3319             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3320
  3321         16  FILLER                         PIC X(318).
  3322
  3323****************************************************************
  3324*                  EXCEPTION REPORTING RECORD                  *
  3325****************************************************************
  3326
  3327     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3328         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3329             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3330
  3331         16  CF-COMBINED-LIFE-AH-OPT.
  3332             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3333             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3334             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3335             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3336
  3337         16  CF-LIFE-OPT.
  3338             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3339             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3340             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3341             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3342             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3343             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3344             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3345             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3346             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  65
* EL151.cbl
  3347             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3348
  3349         16  CF-AH-OPT.
  3350             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3351             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3352             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3353             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3354             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3355             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3356             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3357             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3358             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3359             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3360
  3361         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3362             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3363             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3364             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3365
  3366         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3367
  3368         16  FILLER                         PIC X(673).
  3369
  3370
  3371****************************************************************
  3372*             MORTGAGE SYSTEM PLAN RECORD                      *
  3373****************************************************************
  3374
  3375     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3376         16  CF-PLAN-TYPE                   PIC X.
  3377             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3378             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3379             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3380         16  CF-PLAN-ABBREV                 PIC XXX.
  3381         16  CF-PLAN-DESCRIPT               PIC X(10).
  3382         16  CF-PLAN-NOTES                  PIC X(20).
  3383         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3384         16  CF-PLAN-UNDERWRITING.
  3385             20  CF-PLAN-TERM-DATA.
  3386                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3387                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3388             20  CF-PLAN-AGE-DATA.
  3389                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3390                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3391                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3392             20  CF-PLAN-BENEFIT-DATA.
  3393                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3394                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3395                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3396                                            PIC S9(7)V99  COMP-3.
  3397         16  CF-PLAN-POLICY-FORMS.
  3398             20  CF-POLICY-FORM             PIC X(12).
  3399             20  CF-MASTER-APPLICATION      PIC X(12).
  3400             20  CF-MASTER-POLICY           PIC X(12).
  3401         16  CF-PLAN-RATING.
  3402             20  CF-RATE-CODE               PIC X(5).
  3403             20  CF-SEX-RATING              PIC X.
  3404                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  66
* EL151.cbl
  3405                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3406             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3407             20  CF-SUB-STD-TYPE            PIC X.
  3408                 88  CF-PCT-OF-PREM            VALUE '1'.
  3409                 88  CF-PCT-OF-BENE            VALUE '2'.
  3410         16  CF-PLAN-PREM-TOLERANCES.
  3411             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3412             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3413         16  CF-PLAN-PYMT-TOLERANCES.
  3414             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3415             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3416         16  CF-PLAN-MISC-DATA.
  3417             20  FILLER                     PIC X.
  3418             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3419             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3420         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3421         16  CF-PLAN-IND-GRP                PIC X.
  3422             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3423                                                     '1'.
  3424             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3425                                                     '2'.
  3426         16  CF-MIB-SEARCH-SW               PIC X.
  3427             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3428             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3429             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3430             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3431         16  CF-ALPHA-SEARCH-SW             PIC X.
  3432             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3433             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3434             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3435             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3436             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3437             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3438             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3439             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3440             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3441             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3442                                                     'A' 'B' 'C'
  3443                                                     'X' 'Y' 'Z'.
  3444         16  CF-EFF-DT-RULE-SW              PIC X.
  3445             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3446             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3447             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3448             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3449             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3450         16  FILLER                         PIC X(4).
  3451         16  CF-HEALTH-QUESTIONS            PIC X.
  3452             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3453         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3454         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3455         16  CF-PLAN-SNGL-JNT               PIC X.
  3456             88  CF-COMBINED-PLAN              VALUE 'C'.
  3457             88  CF-JNT-PLAN                   VALUE 'J'.
  3458             88  CF-SNGL-PLAN                  VALUE 'S'.
  3459         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3460         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3461         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3462         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  67
* EL151.cbl
  3463         16  CF-RERATE-CNTL                 PIC  X.
  3464             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3465             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3466             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3467             88  CF-AUTO-RECALC                 VALUE '4'.
  3468         16  CF-BENEFIT-TYPE                PIC  X.
  3469             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3470             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3471         16  CF-POLICY-FEE                  PIC S999V99
  3472                                                    COMP-3.
  3473         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3474         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3475         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3476         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3477         16  FILLER                         PIC  X(32).
  3478         16  CF-TERMINATION-FORM            PIC  X(04).
  3479         16  FILLER                         PIC  X(08).
  3480         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3481                                                       COMP-3.
  3482         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3483         16  CF-ISSUE-LETTER                PIC  X(4).
  3484         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3485         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3486             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3487             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3488         16  CF-MP-REFUND-CALC              PIC X.
  3489             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3490             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3491             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3492             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3493             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3494             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3495             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3496             88  CF-MP-REFD-MEAN                VALUE '8'.
  3497         16  CF-ALT-RATE-CODE               PIC  X(5).
  3498
  3499
  3500         16  FILLER                         PIC X(498).
  3501****************************************************************
  3502*             MORTGAGE COMPANY MASTER RECORD                   *
  3503****************************************************************
  3504
  3505     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3506         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3507         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3508             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3509             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3510             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3511             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3512             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3513
  3514         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3515         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3516         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3517         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3518         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3519
  3520         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  68
* EL151.cbl
  3521             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3522         16  CF-MP-RECON-USE-IND            PIC X(1).
  3523             88  CF-MP-USE-RECON             VALUE 'Y'.
  3524         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3525             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3526         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3527             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3528             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3529         16  FILLER                         PIC X(1).
  3530         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3531             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3532         16  CF-MORTG-MIB-VERSION           PIC X.
  3533             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3534             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3535             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3536         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3537             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3538                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3539             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3540                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3541             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3542                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3543             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3544                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3545             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3546                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3547             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3548                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3549         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3550         16  FILLER                         PIC X(7).
  3551         16  CF-MORTG-DESTINATION-SYMBOL.
  3552             20  CF-MORTG-MIB-COMM          PIC X(5).
  3553             20  CF-MORTG-MIB-TERM          PIC X(5).
  3554         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3555             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3556         16  FILLER                         PIC X(03).
  3557         16  CF-MP-CHECK-NO-CONTROL.
  3558             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3559                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3560                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3561                                                ' ' LOW-VALUES.
  3562                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3563                                               VALUE '3'.
  3564         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3565         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3566         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3567             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3568                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3569             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3570                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3571             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3572                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3573             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3574                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3575             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3576                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3577             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3578                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  69
* EL151.cbl
  3579         16  CF-MORTG-BILLING-AREA.
  3580             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3581                                            PIC X.
  3582         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3583         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3584         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3585         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3586             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3587             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3588         16  FILLER                         PIC X.
  3589         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3590             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3591             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3592         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3593         16  FILLER                         PIC X(8).
  3594         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3595         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3596         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3597         16  CF-ACH-COMPANY-ID.
  3598             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3599                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3600                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3601                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3602             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3603         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3604             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3605         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3606             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3607             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3608         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3609         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3610         16  FILLER                         PIC X(536).
  3611
  3612****************************************************************
  3613*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3614****************************************************************
  3615
  3616     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3617         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3618             20  CF-FEMALE-HEIGHT.
  3619                 24  CF-FEMALE-FT           PIC 99.
  3620                 24  CF-FEMALE-IN           PIC 99.
  3621             20  CF-FEMALE-MIN-WT           PIC 999.
  3622             20  CF-FEMALE-MAX-WT           PIC 999.
  3623         16  FILLER                         PIC X(428).
  3624
  3625     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3626         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3627             20  CF-MALE-HEIGHT.
  3628                 24  CF-MALE-FT             PIC 99.
  3629                 24  CF-MALE-IN             PIC 99.
  3630             20  CF-MALE-MIN-WT             PIC 999.
  3631             20  CF-MALE-MAX-WT             PIC 999.
  3632         16  FILLER                         PIC X(428).
  3633******************************************************************
  3634*             AUTOMATIC ACTIVITY RECORD                          *
  3635******************************************************************
  3636     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  70
* EL151.cbl
  3637         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3638             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3639             20  CF-SYS-LETTER-ID           PIC X(04).
  3640             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3641             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3642             20  CF-SYS-RESET-SW            PIC X(01).
  3643             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3644             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3645
  3646         16  FILLER                         PIC X(50).
  3647
  3648         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3649             20  CF-USER-ACTIVE-SW          PIC X(01).
  3650             20  CF-USER-LETTER-ID          PIC X(04).
  3651             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3652             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3653             20  CF-USER-RESET-SW           PIC X(01).
  3654             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3655             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3656             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3657
  3658         16  FILLER                         PIC X(246).
  3659*                                    COPY ELCDENY.
  3660******************************************************************
  3661*                                                                *
  3662*                                                                *
  3663*                            ELCDENY                             *
  3664*                            VMOD=2.001                          *
  3665*                                                                *
  3666*   CLAIM SYSTEM DENIAL/RECESSION/REFORMATION TABLE              *
  3667*                                                                *
  3668*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3669*   VSAM DENIAL TABLE                                            *
  3670*                                                                *
  3671*   FILE DESCRIPTION = DENIAL CODE TABLE                         *
  3672*                                                                *
  3673*   FILE TYPE = VSAM,KSDS                                        *
  3674*   RECORD SIZE = 125   RECFORM = FIX                            *
  3675*                                                                *
  3676*   BASE CLUSTER NAME = ELCDENY                   RKP=2,LEN=15   *
  3677*       ALTERNATE PATH1 = ELDENY2 (ALT GROUPING) RKP=17,LEN=16   *
  3678*                                                                *
  3679*   LOG = NO                                                     *
  3680*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3681*                                                                *
  3682*                                                                *
  3683******************************************************************
  3684*                   C H A N G E   L O G
  3685*
  3686* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3687*-----------------------------------------------------------------
  3688*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3689* EFFECTIVE    NUMBER
  3690*-----------------------------------------------------------------
  3691* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  3692******************************************************************
  3693 01  DENIAL-CODES.
  3694     12  DN-RECORD-ID                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  71
* EL151.cbl
  3695         88  VALID-DN-ID                      VALUE 'DN'.
  3696     12  DN-CONTROL-PRIMARY.
  3697         16  DN-COMPANY-CD                 PIC X.
  3698         16  DN-DENIAL-CODE                PIC X(4).
  3699         16  FILLER                        PIC X(10).
  3700     12  DN-CONTROL-BY-TYPE.
  3701         16  DN-COMPANY-CD-A1              PIC X.
  3702         16  DN-RECORD-TYPE                PIC X.
  3703         16  DN-DENIAL-CODE-A1             PIC X(4).
  3704         16  FILLER                        PIC X(10).
  3705     12  DN-MAINT-INFORMATION.
  3706         16  DN-LAST-MAINT-DT              PIC XX.
  3707         16  DN-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3708         16  DN-LAST-MAINT-USER            PIC X(4).
  3709         16  FILLER                        PIC XX.
  3710     12  DN-DESCRIPTION                    PIC X(50).
  3711     12  FILLER                            PIC X(30).
  3712******************************************************************
  3713*                                    COPY ELCDAR.
  3714******************************************************************
  3715*                                                                *
  3716*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  3717*   FILE TYPE = VSAM,KSDS                                        *
  3718*   RECORD SIZE = 25   RECFORM = FIXED                           *
  3719*   BASE CLUSTER = DLYACTV                                       *
  3720*   LOG = YES                                                    *
  3721*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  3722*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  3723*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  3724*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  3725*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  3726*               BY PROGRAM "LGINFCE".                            *
  3727*                                                                *
  3728******************************************************************
  3729 01  DAILY-ACTIVITY-RECORD.
  3730     05  DA-KEY.
  3731         10  DA-COMP-CD          PIC X.
  3732         10  DA-CARRIER          PIC X.
  3733         10  DA-CLAIM-NO         PIC X(7).
  3734         10  DA-CERT-NO.
  3735             15  DA-CERT-PRIME   PIC X(10).
  3736             15  DA-CERT-SFX     PIC X.
  3737     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  3738     05  DA-RECORD-TYPE          PIC X.
  3739     05  FILLER                  PIC X(2).
  3740******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  72
* EL151.cbl
  3742*                                    COPY ERCDMDNT.
  3743******************************************************************
  3744*                                                                *
  3745*                            ERCDMDNT                            *
  3746*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3747*                            VMOD=2.005                          *
  3748*                                                                *
  3749*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  3750*                                                                *
  3751*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  3752*                                                                *
  3753*        FILE TYPE= VSAM,KSDS                                    *
  3754*        RECORD SIZE = 825    RECFORM = FIXED                    *
  3755*                                                                *
  3756*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  3757*                                                                *
  3758*        LOG = YES                                               *
  3759*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  3760*                                                                *
  3761******************************************************************
  3762
  3763 01  CERTIFICATE-NOTE.
  3764     12  CN-RECORD-ID                     PIC  XX.
  3765         88  VALID-CN-ID                      VALUE 'CN'.
  3766
  3767     12  CN-CONTROL-PRIMARY.
  3768         16  CN-COMPANY-CD                PIC X.
  3769         16  CN-CERT-KEY.
  3770             20  CN-CARRIER               PIC X.
  3771             20  CN-GROUPING.
  3772                 24  CN-GROUPING-PREFIX   PIC XXX.
  3773                 24  CN-GROUPING-PRIME    PIC XXX.
  3774             20  CN-STATE                 PIC XX.
  3775             20  CN-ACCOUNT.
  3776                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  3777                 24  CN-ACCOUNT-PRIME     PIC X(6).
  3778             20  CN-CERT-EFF-DT           PIC XX.
  3779             20  CN-CERT-NO.
  3780                 24  CN-CERT-PRIME        PIC X(10).
  3781                 24  CN-CERT-SFX          PIC X.
  3782
  3783     12  CN-BILLING-START-LINE-NO         PIC 99.
  3784     12  CN-BILLING-END-LINE-NO           PIC 99.
  3785
  3786     12  CN-LINES.
  3787         16  CN-LINE                      PIC X(77)  OCCURS 10.
  3788
  3789     12  CN-CSI-NOTES REDEFINES CN-LINES.
  3790         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  3791         16  CN-CSI-GENERAL-DATA-AREA.
  3792             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  3793
  3794         16  CN-CSI-GENERAL-DATA-R REDEFINES
  3795             CN-CSI-GENERAL-DATA-AREA.
  3796             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  3797             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  3798             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  3799             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  73
* EL151.cbl
  3800             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  3801             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  3802             20  CN-CSI-GEN-INFRM-MI          PIC X.
  3803             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  3804             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  3805             20  FILLER                       PIC XX.
  3806             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  3807             20  FILLER                       PIC X(38).
  3808
  3809         16  CN-CSI-PRODUCT-DATA-AREA.
  3810             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  3811
  3812         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  3813             CN-CSI-PRODUCT-DATA-AREA.
  3814             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  3815             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  3816             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  3817             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  3818             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  3819             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  3820             20  FILLER                   PIC XX.
  3821             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  3822             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  3823             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  3824             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  3825             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  3826             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  3827             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  3828             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  3829             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  3830             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  3831             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  3832             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  3833             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  3834             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  3835             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  3836             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  3837             20  CN-CSI-CC-TERM-AGE       PIC 999.
  3838             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  3839             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  3840             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  3841             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  3842             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  3843             20  FILLER                   PIC X(25).
  3844
  3845         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  3846             CN-CSI-CREDIT-CARD-DATA.
  3847             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  3848             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  3849             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  3850             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  3851             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  3852             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  3853             20  FILLER                   PIC XX.
  3854             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  3855             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  3856             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  3857             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  74
* EL151.cbl
  3858             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  3859             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  3860             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  3861             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  3862             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  3863             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  3864             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  3865             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  3866             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  3867             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  3868             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  3869             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  3870             20  CN-CSI-FL-TERM-AGE       PIC 999.
  3871             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  3872             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  3873             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  3874             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  3875             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  3876             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  3877             20  FILLER                   PIC X(17).
  3878
  3879         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  3880             CN-CSI-FAMILY-LEAVE-DATA.
  3881             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  3882             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  3883             20  CN-CSI-SL-BENE-REL       PIC X(8).
  3884             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  3885             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  3886             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  3887             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  3888             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  3889             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  3890             20  CN-CSI-SL-INT-ON-PROCEEDS
  3891                                          PIC S9(5)V99  COMP-3.
  3892             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  3893             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  3894             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  3895             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  3896             20  CN-CSI-SL-POLICY-BENEFITS
  3897                                          PIC S9(5)V99  COMP-3.
  3898             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  3899             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  3900             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  3901             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  3902             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  3903             20  CN-CSI-SL-PREM-MODE      PIC 99.
  3904             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  3905             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  3906             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  3907             20  CN-CSI-SL-STATE-NOT      PIC X.
  3908             20  FILLER                   PIC XX.
  3909
  3910         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  3911             CN-CSI-SENIOR-LIFE-DATA.
  3912             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  3913             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  3914             20  CN-CSI-PP-BEN-PAID-TO-DATE
  3915                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  75
* EL151.cbl
  3916             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  3917             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  3918             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  3919             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  3920             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  3921             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  3922             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  3923             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  3924             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  3925             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  3926             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  3927             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  3928             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  3929             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  3930             20  CN-CSI-PP-REPAIR         PIC X.
  3931             20  CN-CSI-PP-REPLACE        PIC X.
  3932             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  3933             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  3934             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  3935             20  CN-CSI-PP-TERM-AGE       PIC 999.
  3936             20  FILLER                   PIC X(5).
  3937
  3938         16  CN-CSI-EXT-WARR-DATA REDEFINES
  3939             CN-CSI-PURCH-PROP-DATA.
  3940             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  3941             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  3942             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  3943             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  3944             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  3945             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  3946             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  3947             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  3948             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  3949             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  3950             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  3951             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  3952             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  3953             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  3954             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  3955             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  3956             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  3957             20  CN-CSI-EW-REPLACE        PIC X.
  3958             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  3959             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  3960             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  3961             20  CN-CSI-EW-TERM-AGE       PIC 999.
  3962             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  3963             20  FILLER                   PIC X(4).
  3964
  3965     12  CN-LAST-MAINT-DT                 PIC XX.
  3966     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  3967     12  CN-LAST-MAINT-USER               PIC X(4).
  3968     12  FILLER                           PIC X(6).
  3969
  3970******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  76
* EL151.cbl
  3972 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  3973                          ACTIVITY-TRAILERS LETTER-ARCHIVE
  3974                          CONTROL-FILE DENIAL-CODES
  3975                          DAILY-ACTIVITY-RECORD
  3976                          CERTIFICATE-NOTE.
  3977 0000-DFHEXIT SECTION.
  3978     MOVE '9#                    $   ' TO DFHEIV0.
  3979     MOVE 'EL151' TO DFHEIV1.
  3980     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3981
  3982     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  3983     MOVE '5'                    TO DC-OPTION-CODE.
  3984     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  3985     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  3986     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  3987
  3988 0001-PROCESSING-EXITS.
  3989     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  3990     IF EIBCALEN NOT GREATER THAN ZEROS
  3991       GO TO 8800-UNAUTHORIZED-ACCESS.
  3992
  3993
  3994* EXEC CICS  HANDLE CONDITION
  3995*           ERROR    (9990-ABEND)
  3996*           PGMIDERR (9600-PGMID-ERROR)
  3997*    END-EXEC.
  3998*    MOVE '"$.L                  ! " #00003989' TO DFHEIV0
  3999     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  4000     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4001     MOVE X'2220233030303033393839' TO DFHEIV0(25:11)
  4002     CALL 'kxdfhei1' USING DFHEIV0
  4003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4004
  4005
  4006     IF PI-CALLING-PROGRAM  NOT  = THIS-PGM
  4007         IF PI-RETURN-TO-PROGRAM NOT  =  THIS-PGM
  4008             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  4009             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  4010             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  4011             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  4012             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  4013             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  4014             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  4015             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  4016         ELSE
  4017             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  4018             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  4019             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  4020             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  4021             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  4022             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  4023             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  4024             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  4025
  4026     IF EIBAID IS EQUAL TO DFHCLEAR
  4027         GO TO 9400-CLEAR.
  4028
  4029     IF PI-PROCESSOR-ID = 'LGXX'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  77
* EL151.cbl
  4030         NEXT SENTENCE
  4031     ELSE
  4032
  4033* EXEC CICS READQ TS
  4034*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  4035*            INTO    (SECURITY-CONTROL)
  4036*            LENGTH  (SC-COMM-LENGTH)
  4037*            ITEM    (SC-ITEM)
  4038*        END-EXEC
  4039*    MOVE '*$II   L              ''   #00004020' TO DFHEIV0
  4040     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4041     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4042     MOVE X'2020233030303034303230' TO DFHEIV0(25:11)
  4043     CALL 'kxdfhei1' USING DFHEIV0,
  4044           PI-SECURITY-TEMP-STORE-ID,
  4045           SECURITY-CONTROL,
  4046           SC-COMM-LENGTH,
  4047           SC-ITEM,
  4048           DFHEIV99,
  4049           DFHEIV99
  4050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4051         MOVE SC-CLAIMS-DISPLAY (6)    TO  PI-DISPLAY-CAP
  4052         MOVE SC-CLAIMS-UPDATE  (6)    TO  PI-MODIFY-CAP.
  4053
  4054     IF EIBTRNID IS EQUAL TO WS-TRANS-ID
  4055         GO TO 0200-RECEIVE.
  4056
  4057 0100-FIRST-TIME-IN.
  4058
  4059     MOVE LOW-VALUES                 TO  EL151AO
  4060     MOVE -1                         TO  MLINE1L
  4061     MOVE 1                          TO  EMI-NUMBER-OF-LINES.
  4062
  4063     MOVE SPACE                      TO  DC-ERROR-CODE
  4064                                         WS-CLAIM-SEQ-SW
  4065                                         MERMSG2O.
  4066
  4067     MOVE '153A'                     TO  PI-CURRENT-SCREEN-NO.
  4068
  4069     MOVE 0                          TO  PI-PROOF-DATE.
  4070     PERFORM 3550-FIND-LETTER-TRLR THRU 3550-EXIT.
  4071
  4072     GO TO 8100-SEND-INITIAL-MAP.
  4073
  4074 0200-RECEIVE.
  4075
  4076     MOVE LOW-VALUES              TO  EL151AI.
  4077
  4078     IF (EIBAID IS EQUAL TO DFHPA1 OR DFHPA2 OR DFHPA3)
  4079         MOVE ER-0008             TO  EMI-ERROR
  4080         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4081         MOVE -1                  TO  MPFNUMBL
  4082         GO TO 8200-SEND-DATAONLY.
  4083
  4084
  4085* EXEC CICS RECEIVE
  4086*        MAP      (MAP-NAME)
  4087*        MAPSET   (MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  78
* EL151.cbl
  4088*        INTO     (EL151AI)
  4089*    END-EXEC.
  4090     MOVE LENGTH OF
  4091      EL151AI
  4092       TO DFHEIV11
  4093*    MOVE '8"T I  L              ''   #00004059' TO DFHEIV0
  4094     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4095     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4096     MOVE X'2020233030303034303539' TO DFHEIV0(25:11)
  4097     CALL 'kxdfhei1' USING DFHEIV0,
  4098           MAP-NAME,
  4099           EL151AI,
  4100           DFHEIV11,
  4101           MAPSET-NAME,
  4102           DFHEIV99,
  4103           DFHEIV99
  4104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4105
  4106
  4107     IF MPFNUMBL IS EQUAL TO +0
  4108         GO TO 0300-CHECK-PFKEYS.
  4109
  4110     IF EIBAID IS NOT EQUAL TO DFHENTER
  4111         MOVE ER-0004             TO  EMI-ERROR
  4112         GO TO 0320-INPUT-ERROR.
  4113
  4114     IF (MPFNUMBI NUMERIC) AND (MPFNUMBI GREATER 0 AND LESS 25)
  4115         MOVE PF-VALUES (MPFNUMBI)    TO  EIBAID
  4116     ELSE
  4117         MOVE ER-0029                 TO  EMI-ERROR
  4118         GO TO 0320-INPUT-ERROR.
  4119
  4120 0300-CHECK-PFKEYS.
  4121
  4122     IF EIBAID IS EQUAL TO DFHPF12
  4123        MOVE  'EL010'            TO  THIS-PGM
  4124        GO TO 9300-XCTL.
  4125
  4126     IF EIBAID IS EQUAL TO DFHPF23
  4127        MOVE EIBAID              TO  PI-ENTRY-CD-1
  4128        MOVE 'EL005'             TO  THIS-PGM
  4129        GO TO 9300-XCTL.
  4130
  4131     IF EIBAID IS EQUAL TO DFHPF24
  4132        MOVE EIBAID              TO  PI-ENTRY-CD-1
  4133        MOVE  'EL126'            TO  THIS-PGM
  4134        GO TO 9300-XCTL.
  4135
  4136     IF EIBAID IS EQUAL TO DFHENTER
  4137        GO TO 0330-EDIT-DATA.
  4138
  4139     MOVE ER-0029                TO  EMI-ERROR.
  4140
  4141 0320-INPUT-ERROR.
  4142     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4143
  4144     MOVE -1                     TO  MPFNUMBL.
  4145     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  79
* EL151.cbl
  4146
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  80
* EL151.cbl
  4148 0330-EDIT-DATA.
  4149     IF NOT MODIFY-CAP
  4150        MOVE 'UPDATE'             TO  SM-READ
  4151        PERFORM 9995-SECURITY-VIOLATION
  4152        MOVE ER-0070              TO  EMI-ERROR
  4153        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4154        GO TO 8100-SEND-INITIAL-MAP.
  4155
  4156     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'CID' OR 'DCC'
  4157         IF MLINE1I = (LOW-VALUES OR SPACES) AND
  4158            MLINE2I = (LOW-VALUES OR SPACES) AND
  4159            MDENCDI = (LOW-VALUES OR SPACES)
  4160             MOVE ER-0483        TO  EMI-ERROR
  4161             MOVE -1             TO  MLINE1L
  4162             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4163             GO TO 8100-SEND-INITIAL-MAP
  4164         ELSE
  4165             NEXT SENTENCE
  4166     ELSE
  4167         IF MLINE1I  = (LOW-VALUES OR SPACES)  AND
  4168            MLINE2I  = (LOW-VALUES OR SPACES)
  4169             MOVE ER-0483        TO  EMI-ERROR
  4170             MOVE -1             TO  MLINE1L
  4171             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4172             GO TO 8100-SEND-INITIAL-MAP.
  4173
  4174     IF MPRFDTL > 0
  4175         MOVE MPRFDTI TO DEEDIT-FIELD
  4176         PERFORM 9650-DEEDIT      THRU 9650-EXIT
  4177         MOVE DEEDIT-FIELD-V0  TO PI-PROOF-DATE
  4178         MOVE PI-PROOF-DATE    TO MPRFDTO
  4179         INSPECT MPRFDTI REPLACING ALL ' ' BY '/'
  4180     END-IF.
  4181
  4182     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES
  4183*     IF  MPRFDTI  = LOW-VALUES OR SPACES
  4184         MOVE ER-0872             TO EMI-ERROR
  4185         MOVE -1                  TO MPRFDTL
  4186         MOVE AL-UABON            TO MPRFDTA
  4187         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4188         GO TO 8200-SEND-DATAONLY
  4189     END-IF.
  4190
  4191     IF  PI-PROOF-DATE > 0
  4192         MOVE PI-PROOF-DATE       TO DEEDIT-FIELD
  4193         PERFORM 9650-DEEDIT      THRU 9650-EXIT
  4194         MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  4195         MOVE '4'                 TO DC-OPTION-CODE
  4196         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
  4197         IF DATE-CONVERSION-ERROR
  4198            MOVE ER-0021          TO EMI-ERROR
  4199            MOVE -1               TO MPRFDTL
  4200            MOVE AL-UABON         TO MPRFDTA
  4201            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4202            GO TO 8200-SEND-DATAONLY
  4203         ELSE
  4204            IF DC-BIN-DATE-1 > SAVE-BIN-DATE
  4205                MOVE ER-0873      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  81
* EL151.cbl
  4206                MOVE -1           TO MPRFDTL
  4207                MOVE AL-UABON     TO MPRFDTA
  4208                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4209                GO TO 8200-SEND-DATAONLY
  4210            ELSE
  4211                MOVE DC-BIN-DATE-1    TO WS-PRF-DT
  4212                MOVE DEEDIT-FIELD-V0  TO PI-PROOF-DATE
  4213                MOVE PI-PROOF-DATE    TO MPRFDTO
  4214                INSPECT MPRFDTI REPLACING ALL ' ' BY '/'
  4215            END-IF
  4216         END-IF
  4217     END-IF.
  4218
  4219     MOVE LOW-VALUES             TO  WS-TRAILER-KEY.
  4220     MOVE PI-COMPANY-CD          TO  WS-KEY-COMPANY-CD.
  4221     MOVE PI-CARRIER             TO  WS-KEY-CARRIER.
  4222     MOVE PI-CLAIM-NO            TO  WS-KEY-CLAIM-NO.
  4223     MOVE PI-CERT-NO             TO  WS-KEY-CERT-NO.
  4224
  4225     PERFORM 7000-READ-ELMSTR-UPDATE THRU 7000-EXIT.
  4226
  4227     IF CL-LAST-TRL-AVAIL
  4228         MOVE ER-0137            TO  EMI-ERROR
  4229         MOVE -1                 TO  MLINE1L
  4230         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4231         GO TO 8200-SEND-DATAONLY.
  4232
  4233     MOVE CL-TRAILER-SEQ-CNT     TO  WS-ORIG-SEQ-CNT.
  4234     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  4235     MOVE CL-TRAILER-SEQ-CNT     TO  WS-SEQ-NO-SAVED.
  4236     MOVE 'C'                    TO  CL-CLAIM-STATUS.
  4237     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
  4238     MOVE '3'                    TO  CL-LAST-MAINT-TYPE.
  4239     MOVE '2'                    TO  CL-LAST-CLOSE-REASON.
  4240     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
  4241     MOVE SAVE-BIN-DATE          TO  CL-LAST-MAINT-DT
  4242                                     CL-LAST-CLOSE-DT.
  4243
  4244     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  4245         IF MDENCDL IS GREATER THAN +0
  4246             MOVE MDENCDI        TO  CL-FILE-LOCATION.
  4247
  4248*************************************************************
  4249*****         START BUILDING ACTIVITY RECORD HERE          **
  4250*************************************************************
  4251     IF PI-COMPANY-ID EQUAL 'CID'
  4252         PERFORM 2300-GETMAIN-DLYACTV THRU
  4253                 2300-EXIT
  4254         PERFORM 3500-BUILD-ACTIVITY-RECORD THRU
  4255                 3500-EXIT
  4256         PERFORM 2350-WRITE-DLYACTV THRU
  4257                 2350-EXIT
  4258     END-IF.
  4259
  4260*************************************************************
  4261*****            END OF BUILDING ACTIVITY RECORD           **
  4262*************************************************************
  4263
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  82
* EL151.cbl
  4264     PERFORM 7120-READ-ELTRLR-UPDATE THRU 7120-EXIT.
  4265
  4266     MOVE +1                     TO  MISC-SUB.
  4267     MOVE SPACES                 TO  WS-OC-LOAD-SW.
  4268     PERFORM 1000-SET-OPEN-CLOSE-HIST THRU 1000-EXIT.
  4269
  4270     MOVE +01                    TO  TR-SUB
  4271                                     TR-SUB-2.
  4272     PERFORM 1010-UPDATE-TR1-OC   THRU 1010-EXIT
  4273             UNTIL  OC-HISTORY-LOADED.
  4274
  4275     MOVE PI-PROCESSOR-ID        TO AT-RESERVES-LAST-UPDATED-BY
  4276     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  4277     MOVE SAVE-BIN-DATE          TO AT-RESERVES-LAST-MAINT-DT.
  4278
  4279     IF PI-COMPANY-ID = 'DMD'
  4280         PERFORM 2000-CREATE-DMD-DMO  THRU  2000-EXIT.
  4281
  4282     PERFORM 7130-REWRITE-ELTRLR THRU 7130-EXIT.
  4283
  4284     PERFORM 7100-GETMAIN-ELTRLR  THRU 7100-EXIT.
  4285     PERFORM 1050-BUILD-DENIAL-TRLR THRU 1090-EXIT.
  4286
  4287     PERFORM 7110-WRITE-ELTRLR    THRU 7110-EXIT.
  4288
  4289     PERFORM 6100-CHECK-AUTO-ACTIVITY THRU 6100-EXIT.
  4290
  4291     IF WS-REC-FOUND-SW IS EQUAL TO 'N'
  4292         GO TO 0340-FINISH-EDIT-DATA.
  4293
  4294     IF CL-ACTIVITY-CODE IS EQUAL TO 09
  4295         GO TO 0340-FINISH-EDIT-DATA.
  4296
  4297     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK') AND
  4298        (CL-ACTIVITY-CODE IS EQUAL TO 11)
  4299         GO TO 0340-FINISH-EDIT-DATA.
  4300
  4301     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  4302         PERFORM 6000-RESET-AUTO-ACTIVITY THRU 6000-EXIT
  4303         IF WS-UPDATE-SW IS EQUAL TO 'Y'
  4304             MOVE LOW-VALUES         TO  CL-NEXT-RESEND-DT
  4305                                         CL-NEXT-FOLLOWUP-DT.
  4306
  4307     IF WS-RESET-SW IS EQUAL TO 'Y'
  4308         MOVE ZEROS                  TO  CL-ACTIVITY-CODE
  4309         MOVE SAVE-BIN-DATE          TO  CL-ACTIVITY-MAINT-DT
  4310         MOVE 'DENY'                 TO  CL-ACTIVITY-MAINT-TYPE.
  4311
  4312 0340-FINISH-EDIT-DATA.
  4313
  4314     PERFORM 7010-REWRITE-ELMSTR  THRU 7010-EXIT.
  4315
  4316     MOVE ER-0000                TO EMI-ERROR.
  4317     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4318     MOVE -1                     TO MLINE1L.
  4319*    MOVE LOW-VALUES             TO MLINE1O
  4320*                                   MLINE2O
  4321*                                   MDENCDO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  83
* EL151.cbl
  4322     GO TO 8200-SEND-DATAONLY.
  4323
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  84
* EL151.cbl
  4325 1000-SET-OPEN-CLOSE-HIST.
  4326     PERFORM 1000-BUMP-OPEN-CLOSE-HIST UNTIL
  4327        (MISC-SUB GREATER THAN +6 OR
  4328        AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES).
  4329
  4330     IF MISC-SUB GREATER THAN +1
  4331        SUBTRACT +1 FROM MISC-SUB
  4332        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = 'C'
  4333           MOVE SAVE-BIN-DATE   TO AT-OPEN-CLOSE-DATE (MISC-SUB)
  4334           MOVE 'C'             TO AT-OPEN-CLOSE-TYPE (MISC-SUB)
  4335           MOVE 'DENIED'        TO AT-OPEN-CLOSE-REASON (MISC-SUB)
  4336           MOVE 'X'             TO WS-OC-LOAD-SW.
  4337
  4338     GO TO 1000-EXIT.
  4339
  4340 1000-BUMP-OPEN-CLOSE-HIST.
  4341     ADD +1 TO MISC-SUB.
  4342
  4343 1000-EXIT.
  4344     EXIT.
  4345
  4346 1010-UPDATE-TR1-OC.
  4347     IF  AT-OPEN-CLOSE-DATE (TR-SUB) = (LOW-VALUE OR SPACES)
  4348         MOVE SAVE-BIN-DATE      TO AT-OPEN-CLOSE-DATE (TR-SUB)
  4349         MOVE 'C'                TO AT-OPEN-CLOSE-TYPE (TR-SUB)
  4350         MOVE 'DENIED'           TO AT-OPEN-CLOSE-REASON (TR-SUB)
  4351         MOVE 'X'                TO WS-OC-LOAD-SW
  4352         GO TO 1010-EXIT.
  4353
  4354     ADD 1  TO TR-SUB.
  4355     IF  TR-SUB  GREATER THAN 6
  4356         MOVE +01                TO TR-SUB
  4357         MOVE +02                TO TR-SUB-2
  4358         PERFORM 1020-BUMP    THRU 1020-EXIT
  4359          UNTIL TR-SUB-2 GREATER THAN 6
  4360         MOVE SPACES             TO AT-OPEN-CLOSE-DATE (TR-SUB).
  4361
  4362 1010-EXIT.
  4363      EXIT.
  4364
  4365 1020-BUMP.
  4366     MOVE AT-OPEN-CLOSE-DATE (TR-SUB-2) TO
  4367                           AT-OPEN-CLOSE-DATE (TR-SUB).
  4368     MOVE AT-OPEN-CLOSE-TYPE (TR-SUB-2) TO
  4369                           AT-OPEN-CLOSE-TYPE (TR-SUB).
  4370     MOVE AT-OPEN-CLOSE-REASON (TR-SUB-2) TO
  4371                           AT-OPEN-CLOSE-REASON (TR-SUB).
  4372
  4373     ADD +1  TO TR-SUB
  4374                TR-SUB-2.
  4375
  4376 1020-EXIT.
  4377     EXIT.
  4378
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  85
* EL151.cbl
  4380 1050-BUILD-DENIAL-TRLR.
  4381
  4382     MOVE 'AT'                   TO AT-RECORD-ID.
  4383     MOVE '8'                    TO AT-TRAILER-TYPE.
  4384
  4385*DLO023
  4386     IF PI-COMPANY-ID NOT = 'DMD'
  4387         GO TO 1055-EDIT-CID-CODE
  4388     END-IF
  4389
  4390     IF MDENCDL GREATER +0
  4391         MOVE 'CL'               TO DL23-SYSTEM-ID
  4392         MOVE 'DN'               TO DL23-RECORD-TYPE
  4393         MOVE MDENCDI            TO DL23-RECORD-KEY
  4394
  4395* EXEC CICS LINK
  4396*            PROGRAM    ('DLO023')
  4397*            COMMAREA   (WS-DLO-CODES-TABLE)
  4398*            LENGTH     (DL23-COMM-LENGTH)
  4399*        END-EXEC
  4400     MOVE 'DLO023' TO DFHEIV1
  4401*    MOVE '."C                   ''   #00004352' TO DFHEIV0
  4402     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4403     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4404     MOVE X'2020233030303034333532' TO DFHEIV0(25:11)
  4405     CALL 'kxdfhei1' USING DFHEIV0,
  4406           DFHEIV1,
  4407           WS-DLO-CODES-TABLE,
  4408           DL23-COMM-LENGTH,
  4409           DFHEIV99,
  4410           DFHEIV99,
  4411           DFHEIV99
  4412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4413         IF DL23-RETURN-CODE = 'OK'
  4414             MOVE AL-UANON       TO MDENCDA
  4415          ELSE
  4416             MOVE AL-UABON       TO MDENCDA
  4417             MOVE -1             TO MDENCDL
  4418             MOVE ER-0884        TO EMI-ERROR
  4419             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4420             PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  4421             PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4422             GO TO 8200-SEND-DATAONLY.
  4423
  4424     IF MLINE1I = LOW-VALUES OR SPACES
  4425         MOVE SPACES         TO AT-DENIAL-INFO-1
  4426      ELSE
  4427         MOVE MLINE1I        TO AT-DENIAL-INFO-1.
  4428
  4429     GO TO 1070-CONTINUE.
  4430
  4431 1055-EDIT-CID-CODE.
  4432     IF MDENCDL > +0
  4433        MOVE LOW-VALUES          TO WS-ELDENY-KEY
  4434        MOVE PI-COMPANY-CD       TO ELDENY-COMPANY-CD
  4435        MOVE MDENCDI             TO ELDENY-DENIAL-CODE
  4436
  4437* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  86
* EL151.cbl
  4438*          DATASET('ELDENY')
  4439*          SET    (ADDRESS OF DENIAL-CODES)
  4440*          RIDFLD (WS-ELDENY-KEY)
  4441*          RESP   (WS-RESPONSE)
  4442*       END-EXEC
  4443     MOVE 'ELDENY' TO DFHEIV1
  4444*    MOVE '&"S        E          (  N#00004380' TO DFHEIV0
  4445     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4446     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4447     MOVE X'204E233030303034333830' TO DFHEIV0(25:11)
  4448     CALL 'kxdfhei1' USING DFHEIV0,
  4449           DFHEIV1,
  4450           DFHEIV20,
  4451           DFHEIV99,
  4452           WS-ELDENY-KEY,
  4453           DFHEIV99,
  4454           DFHEIV99,
  4455           DFHEIV99
  4456     SET ADDRESS OF DENIAL-CODES TO
  4457         DFHEIV20
  4458     MOVE EIBRESP  TO WS-RESPONSE
  4459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4460        IF RESP-NORMAL
  4461           IF MLINE1L > +0
  4462              STRING DN-DESCRIPTION ' ' MLINE1I
  4463                 DELIMITED BY '  ' INTO AT-DENIAL-INFO-1
  4464              END-STRING
  4465           ELSE
  4466              MOVE DN-DESCRIPTION
  4467                                 TO AT-DENIAL-INFO-1
  4468           END-IF
  4469           MOVE DN-RECORD-TYPE   TO CL-DENIAL-TYPE
  4470           MOVE AT-DENIAL-INFO-1 TO MLINE1O
  4471           MOVE +1               TO MLINE1L
  4472           MOVE AL-UANON         TO MLINE1A
  4473           MOVE DN-RECORD-TYPE
  4474                                 TO CL-DENIAL-TYPE
  4475        ELSE
  4476           MOVE AL-UABON         TO MDENCDA
  4477           MOVE -1               TO MDENCDL
  4478           MOVE ER-0884          TO EMI-ERROR
  4479           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4480           PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  4481           PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4482           GO TO 8200-SEND-DATAONLY
  4483        END-IF
  4484     ELSE
  4485        MOVE AL-UABON            TO MDENCDA
  4486        MOVE -1                  TO MDENCDL
  4487        MOVE ER-0884             TO EMI-ERROR
  4488        PERFORM 9900-ERROR-FORMAT
  4489                                 THRU 9900-EXIT
  4490        PERFORM 2250-UNLOCK-CLAIM-MSTR
  4491                                 THRU 2250-EXIT
  4492        PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4493        GO TO 8200-SEND-DATAONLY
  4494     END-IF
  4495     GO TO 1070-CONTINUE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  87
* EL151.cbl
  4496     .
  4497 1060-CONTINUE.
  4498     IF MDENCDL IS GREATER THAN +0
  4499         SET DEN-INDEX TO +1
  4500         SEARCH DEN-TABLE VARYING DEN-INDEX
  4501             AT END
  4502                 MOVE MLINE1I                TO  AT-DENIAL-INFO-1
  4503         WHEN MDENCDI IS EQUAL TO DENIAL-CODE (DEN-INDEX)
  4504             MOVE DENIAL-DESC (DEN-INDEX)    TO  AT-DENIAL-INFO-1
  4505                                                 MLINE1O
  4506     ELSE
  4507         IF MLINE1I = LOW-VALUES OR SPACES
  4508             MOVE SPACES         TO AT-DENIAL-INFO-1
  4509         ELSE
  4510             MOVE MLINE1I        TO AT-DENIAL-INFO-1.
  4511
  4512 1070-CONTINUE.
  4513     IF  MLINE2I  = LOW-VALUES OR SPACES
  4514         MOVE  SPACES            TO AT-DENIAL-INFO-2
  4515     ELSE
  4516         MOVE MLINE2I            TO AT-DENIAL-INFO-2.
  4517
  4518     IF (AT-DENIAL-INFO-1 IS EQUAL TO SPACES OR LOW-VALUES)
  4519         MOVE AT-DENIAL-INFO-2   TO AT-DENIAL-INFO-1
  4520         MOVE SPACES             TO AT-DENIAL-INFO-2.
  4521
  4522     MOVE WS-PRF-DT              TO AT-DENIAL-PROOF-DT.
  4523     MOVE WS-SEQ-NO-SAVED        TO WS-KEY-SEQUENCE-NO.
  4524
  4525     MOVE WS-TRAILER-KEY         TO AT-CONTROL-PRIMARY.
  4526     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  4527                                    AT-DENIAL-LAST-UPDATED-BY.
  4528     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  4529     MOVE SAVE-BIN-DATE          TO AT-RECORDED-DT
  4530                                    AT-DENIAL-DT
  4531                                    AT-DENIAL-LAST-MAINT-DT.
  4532     MOVE MDENCDI                TO AT-DENIAL-REASON-CODE.
  4533     MOVE LOW-VALUES             TO AT-RETRACTION-DT.
  4534
  4535 1090-EXIT.
  4536      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  88
* EL151.cbl
  4538******************************************************************
  4539*    DMD ONLY  -  CREATE THE DIRECT MARKETING OUTPUT FILE
  4540******************************************************************
  4541 2000-CREATE-DMD-DMO.
  4542
  4543     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
  4544     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
  4545     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
  4546
  4547
  4548* EXEC CICS HANDLE CONDITION
  4549*         NOTFND   (2000-NOTE-NOT-FOUND)
  4550*         END-EXEC.
  4551*    MOVE '"$I                   ! # #00004473' TO DFHEIV0
  4552     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4553     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4554     MOVE X'2320233030303034343733' TO DFHEIV0(25:11)
  4555     CALL 'kxdfhei1' USING DFHEIV0
  4556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4557
  4558
  4559
  4560* EXEC CICS READ
  4561*         DATASET('ERNOTE')
  4562*         SET    (ADDRESS OF CERTIFICATE-NOTE)
  4563*         RIDFLD (W-NOTE-KEY)
  4564*         END-EXEC.
  4565     MOVE 'ERNOTE' TO DFHEIV1
  4566*    MOVE '&"S        E          (   #00004477' TO DFHEIV0
  4567     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4568     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4569     MOVE X'2020233030303034343737' TO DFHEIV0(25:11)
  4570     CALL 'kxdfhei1' USING DFHEIV0,
  4571           DFHEIV1,
  4572           DFHEIV20,
  4573           DFHEIV99,
  4574           W-NOTE-KEY,
  4575           DFHEIV99,
  4576           DFHEIV99,
  4577           DFHEIV99
  4578     SET ADDRESS OF CERTIFICATE-NOTE TO
  4579         DFHEIV20
  4580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4581
  4582
  4583     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
  4584     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
  4585     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
  4586
  4587     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
  4588         MOVE 'CC'               TO DCT-PRODUCT-CODE
  4589     ELSE
  4590         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
  4591
  4592     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
  4593     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
  4594
  4595
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  89
* EL151.cbl
  4596* EXEC CICS LINK
  4597*        PROGRAM    ('DLO006')
  4598*        COMMAREA   (DCT-COMMUNICATION-AREA)
  4599*        LENGTH     (WS-DCT-LENGTH)
  4600*    END-EXEC.
  4601     MOVE 'DLO006' TO DFHEIV1
  4602*    MOVE '."C                   ''   #00004495' TO DFHEIV0
  4603     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4604     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4605     MOVE X'2020233030303034343935' TO DFHEIV0(25:11)
  4606     CALL 'kxdfhei1' USING DFHEIV0,
  4607           DFHEIV1,
  4608           DCT-COMMUNICATION-AREA,
  4609           WS-DCT-LENGTH,
  4610           DFHEIV99,
  4611           DFHEIV99,
  4612           DFHEIV99
  4613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4614
  4615
  4616     IF  DCT-RETURN-CODE = 'OK'
  4617         GO TO 2000-CONT.
  4618
  4619     IF  DCT-RETURN-CODE = '01' OR '02'
  4620         GO TO 2000-EXIT.
  4621
  4622     IF  DCT-RETURN-CODE = '03'
  4623         MOVE ER-0951            TO EMI-ERROR
  4624         MOVE -1                 TO MLINE1L
  4625         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4626         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4627             THRU 2250-EXIT
  4628         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4629         GO TO 8200-SEND-DATAONLY.
  4630
  4631     IF  DCT-RETURN-CODE = '06'
  4632         MOVE ER-0921            TO EMI-ERROR
  4633         MOVE -1                 TO MLINE1L
  4634         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4635         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4636             THRU 2250-EXIT
  4637         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4638         GO TO 8200-SEND-DATAONLY.
  4639
  4640     IF  DCT-RETURN-CODE = '07'
  4641         MOVE ER-0919            TO EMI-ERROR
  4642         MOVE -1                 TO MLINE1L
  4643         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4644         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4645             THRU 2250-EXIT
  4646         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4647         GO TO 8200-SEND-DATAONLY.
  4648
  4649     IF  DCT-RETURN-CODE = '04'
  4650         MOVE ER-0946            TO EMI-ERROR
  4651         MOVE -1                 TO MLINE1L
  4652         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4653         PERFORM 2250-UNLOCK-CLAIM-MSTR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  90
* EL151.cbl
  4654             THRU 2250-EXIT
  4655         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4656         GO TO 8200-SEND-DATAONLY.
  4657
  4658     IF  DCT-RETURN-CODE = '05'
  4659         MOVE ER-0947            TO EMI-ERROR
  4660         MOVE -1                 TO MLINE1L
  4661         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4662         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4663             THRU 2250-EXIT
  4664         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4665         GO TO 8200-SEND-DATAONLY.
  4666
  4667     IF  DCT-RETURN-CODE = '08'
  4668         MOVE ER-0948            TO EMI-ERROR
  4669         MOVE -1                 TO MLINE1L
  4670         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4671         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4672             THRU 2250-EXIT
  4673         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4674         GO TO 8200-SEND-DATAONLY.
  4675
  4676     IF  DCT-RETURN-CODE = 'N1'
  4677         MOVE ER-0950            TO EMI-ERROR
  4678         MOVE -1                 TO MLINE1L
  4679         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4680         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4681             THRU 2250-EXIT
  4682         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4683         GO TO 8200-SEND-DATAONLY.
  4684
  4685     IF DCT-RETURN-CODE = 'E1'
  4686         MOVE ER-0974            TO EMI-ERROR
  4687         MOVE -1                 TO MLINE1L
  4688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4689         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4690             THRU 2250-EXIT
  4691         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4692         GO TO 8200-SEND-DATAONLY.
  4693
  4694     IF DCT-RETURN-CODE = 'E2'
  4695         MOVE ER-0975            TO EMI-ERROR
  4696         MOVE -1                 TO MLINE1L
  4697         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4698         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4699             THRU 2250-EXIT
  4700         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4701         GO TO 8200-SEND-DATAONLY.
  4702
  4703     IF DCT-RETURN-CODE NOT = 'OK'
  4704         MOVE ER-0949            TO EMI-ERROR
  4705         MOVE -1                 TO MLINE1L
  4706         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4707         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4708             THRU 2250-EXIT
  4709         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4710         GO TO 8200-SEND-DATAONLY.
  4711
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  91
* EL151.cbl
  4712 2000-CONT.
  4713
  4714     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
  4715     MOVE 'CS'                   TO DM-RECORD-TYPE.
  4716     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
  4717     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
  4718     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
  4719     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
  4720     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
  4721
  4722     MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1.
  4723     MOVE ' '                    TO  DC-OPTION-CODE.
  4724     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  4725     MOVE DC-GREG-DATE-1-YMD     TO  DMD-YYMMDD.
  4726
  4727     IF DMD-YY GREATER THAN 70
  4728         MOVE '19'               TO  DMD-DECADE
  4729     ELSE
  4730         MOVE '20'               TO  DMD-DECADE.
  4731
  4732     MOVE DMD-DATE-YYYYMMDD      TO  DM-STATUS-DATE.
  4733     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
  4734     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
  4735     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
  4736     PERFORM 2100-FORMAT-LAST-NAME-1ST THRU 2100-EXIT.
  4737     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
  4738
  4739     MOVE 'D'                    TO DM-STAT-CHANGE-TYPE.
  4740     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
  4741     MOVE '3'                    TO DM-CLAIM-STATUS.
  4742
  4743
  4744* EXEC CICS LINK
  4745*        PROGRAM    ('DLO025')
  4746*        COMMAREA   (DMO-COMMUNICATION-AREA)
  4747*        LENGTH     (WS-DMO-LENGTH)
  4748*    END-EXEC.
  4749     MOVE 'DLO025' TO DFHEIV1
  4750*    MOVE '."C                   ''   #00004628' TO DFHEIV0
  4751     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4752     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4753     MOVE X'2020233030303034363238' TO DFHEIV0(25:11)
  4754     CALL 'kxdfhei1' USING DFHEIV0,
  4755           DFHEIV1,
  4756           DMO-COMMUNICATION-AREA,
  4757           WS-DMO-LENGTH,
  4758           DFHEIV99,
  4759           DFHEIV99,
  4760           DFHEIV99
  4761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4762
  4763
  4764     IF  DM-RETURN-CODE = 'OK'
  4765         GO TO 2000-EXIT.
  4766
  4767     IF  DM-RETURN-CODE = '01'
  4768         MOVE ER-8051            TO EMI-ERROR
  4769         MOVE -1                 TO MLINE1L
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  92
* EL151.cbl
  4770         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4771         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4772             THRU 2250-EXIT
  4773         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4774         GO TO 8200-SEND-DATAONLY.
  4775
  4776     IF  DM-RETURN-CODE = '02'
  4777         MOVE ER-8052            TO EMI-ERROR
  4778         MOVE -1                 TO MLINE1L
  4779         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4780         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4781             THRU 2250-EXIT
  4782         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4783         GO TO 8200-SEND-DATAONLY.
  4784
  4785     IF  DM-RETURN-CODE = '03'
  4786         MOVE ER-8053            TO EMI-ERROR
  4787         MOVE -1                 TO MLINE1L
  4788         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4789         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4790             THRU 2250-EXIT
  4791         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4792         GO TO 8200-SEND-DATAONLY.
  4793
  4794     IF  DM-RETURN-CODE = '04'
  4795         MOVE ER-8054            TO EMI-ERROR
  4796         MOVE -1                 TO MLINE1L
  4797         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4798         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4799             THRU 2250-EXIT
  4800         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4801         GO TO 8200-SEND-DATAONLY.
  4802
  4803     IF  DM-RETURN-CODE = '05'
  4804         MOVE ER-8055            TO EMI-ERROR
  4805         MOVE -1                 TO MLINE1L
  4806         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4807         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4808             THRU 2250-EXIT
  4809         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4810         GO TO 8200-SEND-DATAONLY.
  4811
  4812     IF  DM-RETURN-CODE = '06'
  4813         MOVE ER-8056            TO EMI-ERROR
  4814         MOVE -1                 TO MLINE1L
  4815         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4816         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4817             THRU 2250-EXIT
  4818         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4819         GO TO 8200-SEND-DATAONLY.
  4820
  4821     IF  DM-RETURN-CODE = '07'
  4822         MOVE ER-8057            TO EMI-ERROR
  4823         MOVE -1                 TO MLINE1L
  4824         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4825         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4826             THRU 2250-EXIT
  4827         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  93
* EL151.cbl
  4828         GO TO 8200-SEND-DATAONLY.
  4829
  4830     IF  DM-RETURN-CODE = '08'
  4831         MOVE ER-8058            TO EMI-ERROR
  4832         MOVE -1                 TO MLINE1L
  4833         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4834         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4835             THRU 2250-EXIT
  4836         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4837         GO TO 8200-SEND-DATAONLY.
  4838
  4839     IF  DM-RETURN-CODE = '09'
  4840         MOVE ER-8059            TO EMI-ERROR
  4841         MOVE -1                 TO MLINE1L
  4842         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4843         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4844             THRU 2250-EXIT
  4845         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4846         GO TO 8200-SEND-DATAONLY.
  4847
  4848     IF  DM-RETURN-CODE = '10'
  4849         MOVE ER-8060            TO EMI-ERROR
  4850         MOVE -1                 TO MLINE1L
  4851         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4852         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4853             THRU 2250-EXIT
  4854         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4855         GO TO 8200-SEND-DATAONLY.
  4856
  4857     IF  DM-RETURN-CODE = '11'
  4858         MOVE ER-8061            TO EMI-ERROR
  4859         MOVE -1                 TO MLINE1L
  4860         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4861         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4862             THRU 2250-EXIT
  4863         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4864         GO TO 8200-SEND-DATAONLY.
  4865
  4866     IF  DM-RETURN-CODE = '12'
  4867         MOVE ER-8062            TO EMI-ERROR
  4868         MOVE -1                 TO MLINE1L
  4869         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4870         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4871             THRU 2250-EXIT
  4872         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4873         GO TO 8200-SEND-DATAONLY.
  4874
  4875     IF  DM-RETURN-CODE = '13'
  4876         MOVE ER-8063            TO EMI-ERROR
  4877         MOVE -1                 TO MLINE1L
  4878         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4879         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4880             THRU 2250-EXIT
  4881         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4882         GO TO 8200-SEND-DATAONLY.
  4883
  4884     IF  DM-RETURN-CODE = '14'
  4885         MOVE ER-8064            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  94
* EL151.cbl
  4886         MOVE -1                 TO MLINE1L
  4887         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4888         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4889             THRU 2250-EXIT
  4890         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4891         GO TO 8200-SEND-DATAONLY.
  4892
  4893     IF  DM-RETURN-CODE = '15'
  4894         MOVE ER-8065            TO EMI-ERROR
  4895         MOVE -1                 TO MLINE1L
  4896         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4897         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4898             THRU 2250-EXIT
  4899         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4900         GO TO 8200-SEND-DATAONLY.
  4901
  4902     IF DM-RETURN-CODE = '16'
  4903         MOVE ER-8154            TO EMI-ERROR
  4904         MOVE -1                 TO MLINE1L
  4905         PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  4906         PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  4907         PERFORM 2255-UNLOCK-TRLR       THRU 2255-EXIT
  4908         GO TO 8200-SEND-DATAONLY.
  4909
  4910     IF DM-RETURN-CODE = '17'
  4911         MOVE ER-8155            TO EMI-ERROR
  4912         MOVE -1                 TO MLINE1L
  4913         PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  4914         PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  4915         PERFORM 2255-UNLOCK-TRLR       THRU 2255-EXIT
  4916         GO TO 8200-SEND-DATAONLY.
  4917
  4918     IF DM-RETURN-CODE = 'N1'
  4919         MOVE ER-8152            TO EMI-ERROR
  4920         MOVE -1                 TO MLINE1L
  4921         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4922         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4923             THRU 2250-EXIT
  4924         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4925         GO TO 8200-SEND-DATAONLY.
  4926
  4927     IF DM-RETURN-CODE = 'E1'
  4928         MOVE ER-8153            TO EMI-ERROR
  4929         MOVE -1                 TO MLINE1L
  4930         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4931         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4932             THRU 2250-EXIT
  4933         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4934         GO TO 8200-SEND-DATAONLY.
  4935
  4936     MOVE ER-8066                TO EMI-ERROR.
  4937     MOVE -1                     TO MLINE1L.
  4938     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4939     PERFORM 2250-UNLOCK-CLAIM-MSTR
  4940         THRU 2250-EXIT.
  4941     PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT.
  4942     GO TO 8200-SEND-DATAONLY.
  4943
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  95
* EL151.cbl
  4944 2000-NOTE-NOT-FOUND.
  4945
  4946     MOVE ER-0954                TO EMI-ERROR.
  4947     MOVE -1                     TO MLINE1L.
  4948     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4949     PERFORM 2250-UNLOCK-CLAIM-MSTR
  4950         THRU 2250-EXIT.
  4951     PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT.
  4952     GO TO 8200-SEND-DATAONLY.
  4953
  4954 2000-EXIT.
  4955     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  96
* EL151.cbl
  4957
  4958 2100-FORMAT-LAST-NAME-1ST.
  4959*****************************************************************
  4960*             M O V E   N A M E   R O U T I N E                 *
  4961*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
  4962*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
  4963*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
  4964*                  FIELD                   VALUE                *
  4965*           W-NAME-LAST    (CL15)      SMITH                    *
  4966*           W-NAME-FIRST   (CL15)      JOHN                     *
  4967*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
  4968*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
  4969*     CONTAIN                                                   *
  4970*                SMITH, JOHN ALLEN                              *
  4971*     OR                                                        *
  4972*                SMITH, JOHN A.                                 *
  4973*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
  4974*     COPYBOOK, ELCNWA.                                         *
  4975*****************************************************************.
  4976
  4977     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  4978     MOVE ZERO                   TO  WS-NAME-SW.
  4979     SET NWA-INDEX               TO +1.
  4980
  4981     IF  W-NAME-LAST EQUAL SPACES
  4982             AND
  4983         W-NAME-MIDDLE EQUAL SPACES
  4984         MOVE +1                 TO WS-NAME-SW.
  4985
  4986     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
  4987     PERFORM 2150-MOVE-NAME THRU 2150-EXIT.
  4988
  4989     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
  4990     PERFORM 2150-MOVE-NAME THRU 2150-EXIT.
  4991
  4992     SET NWA-INDEX UP BY +1.
  4993
  4994     IF  W-NAME-MIDDLE NOT EQUAL SPACES
  4995
  4996         IF  W-NAME-MIDDLE-2 EQUAL SPACES
  4997             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
  4998             SET NWA-INDEX UP BY +1
  4999             MOVE '.'            TO WS-NW (NWA-INDEX)
  5000             SET NWA-INDEX UP BY +2
  5001
  5002         ELSE
  5003             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
  5004             PERFORM 2150-MOVE-NAME THRU 2150-EXIT.
  5005
  5006 2100-EXIT.
  5007     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  97
* EL151.cbl
  5009 2150-MOVE-NAME.
  5010
  5011     IF  WS-NAME-SW GREATER THAN +1
  5012         GO TO 2150-EXIT.
  5013
  5014     IF  WS-NAME-WORK2 = SPACES
  5015         GO TO 2150-EXIT.
  5016
  5017     SET NWA-INDEX2            TO +1.
  5018     SET NWA-INDEX3            TO +2.
  5019
  5020 2150-MOVE-NAME-CYCLE.
  5021
  5022     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  5023
  5024     IF  NWA-INDEX LESS THAN +30
  5025         SET NWA-INDEX UP BY +1
  5026
  5027     ELSE
  5028         ADD +2                TO  WS-NAME-SW
  5029         GO TO 2150-EXIT.
  5030
  5031     IF  NWA-INDEX2 LESS THAN +20
  5032         SET NWA-INDEX3 UP BY +1
  5033         SET NWA-INDEX2 UP BY +1.
  5034
  5035     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
  5036             AND
  5037         WS-NW2 (NWA-INDEX3) EQUAL SPACES
  5038
  5039         IF  WS-NAME-SW EQUAL ZERO
  5040             MOVE ','            TO  WS-NW (NWA-INDEX)
  5041             SET NWA-INDEX UP BY +2
  5042             MOVE +1             TO  WS-NAME-SW
  5043             GO TO 2150-EXIT
  5044
  5045         ELSE
  5046             GO TO 2150-EXIT.
  5047
  5048     GO TO 2150-MOVE-NAME-CYCLE.
  5049
  5050 2150-EXIT.
  5051     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  98
* EL151.cbl
  5053 2250-UNLOCK-CLAIM-MSTR.
  5054
  5055* EXEC CICS UNLOCK
  5056*          DATASET  (ELMSTR-FILE-ID)
  5057*          END-EXEC.
  5058*    MOVE '&*                    #   #00004924' TO DFHEIV0
  5059     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5060     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5061     MOVE X'2020233030303034393234' TO DFHEIV0(25:11)
  5062     CALL 'kxdfhei1' USING DFHEIV0,
  5063           ELMSTR-FILE-ID,
  5064           DFHEIV99
  5065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5066
  5067 2250-EXIT.
  5068     EXIT.
  5069 2255-UNLOCK-TRLR.
  5070
  5071* EXEC CICS UNLOCK
  5072*          DATASET (ELTRLR-FILE-ID)
  5073*          END-EXEC.
  5074*    MOVE '&*                    #   #00004930' TO DFHEIV0
  5075     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5076     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5077     MOVE X'2020233030303034393330' TO DFHEIV0(25:11)
  5078     CALL 'kxdfhei1' USING DFHEIV0,
  5079           ELTRLR-FILE-ID,
  5080           DFHEIV99
  5081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5082
  5083 2255-EXIT.
  5084     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  99
* EL151.cbl
  5085/
  5086*************************************************************
  5087*****      CSO ADDITION - FOR BUILDING ACTIVITY FILE      ***
  5088*************************************************************
  5089 2300-GETMAIN-DLYACTV.
  5090
  5091* EXEC CICS GETMAIN
  5092*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  5093*        LENGTH (25)
  5094*        INITIMG (WS-BLANK)
  5095*    END-EXEC.
  5096     MOVE 25
  5097       TO DFHEIV11
  5098*    MOVE ',"IL                  $   #00004940' TO DFHEIV0
  5099     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5100     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5101     MOVE X'2020233030303034393430' TO DFHEIV0(25:11)
  5102     CALL 'kxdfhei1' USING DFHEIV0,
  5103           DFHEIV20,
  5104           DFHEIV11,
  5105           WS-BLANK
  5106     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  5107         DFHEIV20
  5108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5109
  5110 2300-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 100
* EL151.cbl
  5111/
  5112*************************************************************
  5113*****      CSO ADDITION - FOR BUILDING ACTIVITY FILE      ***
  5114*************************************************************
  5115 2350-WRITE-DLYACTV.
  5116
  5117* EXEC CICS HANDLE CONDITION
  5118*        NOTOPEN (9986-NOTOPEN-DLYACTV)
  5119*        DUPREC (2350-EXIT)
  5120*    END-EXEC.
  5121*    MOVE '"$J%                  ! $ #00004951' TO DFHEIV0
  5122     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  5123     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5124     MOVE X'2420233030303034393531' TO DFHEIV0(25:11)
  5125     CALL 'kxdfhei1' USING DFHEIV0
  5126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5127
  5128
  5129
  5130* EXEC CICS WRITE
  5131*        DATASET ('DLYACTV')
  5132*        RIDFLD (DA-KEY)
  5133*        FROM (DAILY-ACTIVITY-RECORD)
  5134*    END-EXEC.
  5135     MOVE LENGTH OF
  5136      DAILY-ACTIVITY-RECORD
  5137       TO DFHEIV11
  5138     MOVE 'DLYACTV' TO DFHEIV1
  5139*    MOVE '&$ L                  ''   #00004956' TO DFHEIV0
  5140     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5141     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5142     MOVE X'2020233030303034393536' TO DFHEIV0(25:11)
  5143     CALL 'kxdfhei1' USING DFHEIV0,
  5144           DFHEIV1,
  5145           DAILY-ACTIVITY-RECORD,
  5146           DFHEIV11,
  5147           DA-KEY,
  5148           DFHEIV99,
  5149           DFHEIV99
  5150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5151
  5152
  5153 2350-EXIT.
  5154     EXIT.
  5155
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 101
* EL151.cbl
  5156/
  5157*************************************************************
  5158*****      CSO ADDITION - FOR BUILDING ACTIVITY FILE      ***
  5159*************************************************************
  5160
  5161 3500-BUILD-ACTIVITY-RECORD.
  5162
  5163     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  5164     MOVE WS-CLAIM-KEY           TO DA-KEY.
  5165     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
  5166                                 GIVING DA-TRAILER-SEQ-NO.
  5167     MOVE 'D'                    TO DA-RECORD-TYPE.
  5168
  5169 3500-EXIT.
  5170     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 102
* EL151.cbl
  5171/
  5172 3550-FIND-LETTER-TRLR.
  5173      MOVE PI-COMPANY-CD             TO  WS-KEY-COMPANY-CD.
  5174      MOVE PI-CARRIER                TO  WS-KEY-CARRIER.
  5175      MOVE PI-CLAIM-NO               TO  WS-KEY-CLAIM-NO.
  5176      MOVE PI-CERT-NO                TO  WS-KEY-CERT-NO.
  5177      MOVE +100                      TO  WS-KEY-SEQUENCE-NO.
  5178
  5179 3550-STARTBR-ELTRLR.
  5180
  5181
  5182* EXEC CICS HANDLE CONDITION
  5183*         ENDFILE   (3550-END)
  5184*         NOTFND    (3550-END)
  5185*     END-EXEC.
  5186*    MOVE '"$''I                  ! % #00004990' TO DFHEIV0
  5187     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5188     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5189     MOVE X'2520233030303034393930' TO DFHEIV0(25:11)
  5190     CALL 'kxdfhei1' USING DFHEIV0
  5191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5192
  5193
  5194
  5195* EXEC CICS STARTBR
  5196*         DATASET   (ELTRLR-FILE-ID)
  5197*         RIDFLD    (WS-TRAILER-KEY)
  5198*         GTEQ
  5199*     END-EXEC.
  5200     MOVE 0
  5201       TO DFHEIV11
  5202*    MOVE '&,         G          &   #00004995' TO DFHEIV0
  5203     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5204     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5205     MOVE X'2020233030303034393935' TO DFHEIV0(25:11)
  5206     CALL 'kxdfhei1' USING DFHEIV0,
  5207           ELTRLR-FILE-ID,
  5208           WS-TRAILER-KEY,
  5209           DFHEIV99,
  5210           DFHEIV11,
  5211           DFHEIV99
  5212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5213
  5214
  5215      MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
  5216
  5217 3550-READNEXT-ELTRLR.
  5218
  5219
  5220* EXEC CICS READNEXT
  5221*         DATASET   (ELTRLR-FILE-ID)
  5222*         RIDFLD    (WS-TRAILER-KEY)
  5223*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5224*     END-EXEC.
  5225     MOVE 0
  5226       TO DFHEIV11
  5227*    MOVE '&.S                   )   #00005005' TO DFHEIV0
  5228     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 103
* EL151.cbl
  5229     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5230     MOVE X'2020233030303035303035' TO DFHEIV0(25:11)
  5231     CALL 'kxdfhei1' USING DFHEIV0,
  5232           ELTRLR-FILE-ID,
  5233           DFHEIV20,
  5234           DFHEIV99,
  5235           WS-TRAILER-KEY,
  5236           DFHEIV99,
  5237           DFHEIV11,
  5238           DFHEIV99,
  5239           DFHEIV99
  5240     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5241         DFHEIV20
  5242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5243
  5244
  5245      IF (PI-COMPANY-CD IS NOT EQUAL TO  WS-KEY-COMPANY-CD) OR
  5246         (PI-CARRIER    IS NOT EQUAL TO  WS-KEY-CARRIER)    OR
  5247         (PI-CLAIM-NO   IS NOT EQUAL TO  WS-KEY-CLAIM-NO)   OR
  5248         (PI-CERT-NO    IS NOT EQUAL TO  WS-KEY-CERT-NO)
  5249          GO TO 3550-END.
  5250
  5251      IF AT-TRAILER-TYPE IS NOT EQUAL TO '4'
  5252          GO TO 3550-READNEXT-ELTRLR.
  5253
  5254     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-ANSWER-DT
  5255         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER-DT
  5256     END-IF.
  5257
  5258     GO TO 3550-READNEXT-ELTRLR.
  5259
  5260 3550-END.
  5261
  5262     IF WS-MAX-LETTER-ANSWER-DT NOT EQUAL LOW-VALUES AND SPACES
  5263         MOVE SPACES             TO  DC-OPTION-CODE
  5264         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
  5265         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5266         MOVE DC-GREG-DATE-1-MDY TO PI-PROOF-DATE
  5267         MOVE PI-PROOF-DATE TO  MPRFDTO
  5268         INSPECT MPRFDTI REPLACING ALL ' ' BY '/'
  5269     END-IF.
  5270
  5271
  5272* EXEC CICS ENDBR
  5273*         DATASET   (ELTRLR-FILE-ID)
  5274*     END-EXEC.
  5275     MOVE 0
  5276       TO DFHEIV11
  5277*    MOVE '&2                    $   #00005037' TO DFHEIV0
  5278     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5279     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5280     MOVE X'2020233030303035303337' TO DFHEIV0(25:11)
  5281     CALL 'kxdfhei1' USING DFHEIV0,
  5282           ELTRLR-FILE-ID,
  5283           DFHEIV11,
  5284           DFHEIV99
  5285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5286
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 104
* EL151.cbl
  5287
  5288 3550-EXIT.
  5289     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 105
* EL151.cbl
  5290/
  5291 6000-RESET-AUTO-ACTIVITY.
  5292******************************************************************
  5293*    RESET ALL FUTURE LETTER ACTIVITY AWAITING FURTHER ACTION    *
  5294*    (RESEND, FOLLOW-UP, ETC) BY MOVING LOW-VALUES TO THE        *
  5295*    FOLLOW-UP OR RESEND DATES IN THE ACTIVITY TRAILER AND THE   *
  5296*    RESEND DATE IS THE LETTER ARCHIVE, IF NECESSARY.            *
  5297******************************************************************
  5298      MOVE PI-COMPANY-CD             TO  WS-KEY-COMPANY-CD.
  5299      MOVE PI-CARRIER                TO  WS-KEY-CARRIER.
  5300      MOVE PI-CLAIM-NO               TO  WS-KEY-CLAIM-NO.
  5301      MOVE PI-CERT-NO                TO  WS-KEY-CERT-NO.
  5302      MOVE +100                      TO  WS-KEY-SEQUENCE-NO.
  5303
  5304 6000-STARTBR-ELTRLR.
  5305
  5306
  5307* EXEC CICS HANDLE CONDITION
  5308*         ENDFILE   (6000-END-RESET)
  5309*         NOTFND    (6000-END-RESET)
  5310*     END-EXEC.
  5311*    MOVE '"$''I                  ! & #00005059' TO DFHEIV0
  5312     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5313     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5314     MOVE X'2620233030303035303539' TO DFHEIV0(25:11)
  5315     CALL 'kxdfhei1' USING DFHEIV0
  5316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5317
  5318
  5319
  5320* EXEC CICS STARTBR
  5321*         DATASET   (ELTRLR-FILE-ID)
  5322*         RIDFLD    (WS-TRAILER-KEY)
  5323*         GTEQ
  5324*     END-EXEC.
  5325     MOVE 0
  5326       TO DFHEIV11
  5327*    MOVE '&,         G          &   #00005064' TO DFHEIV0
  5328     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5329     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5330     MOVE X'2020233030303035303634' TO DFHEIV0(25:11)
  5331     CALL 'kxdfhei1' USING DFHEIV0,
  5332           ELTRLR-FILE-ID,
  5333           WS-TRAILER-KEY,
  5334           DFHEIV99,
  5335           DFHEIV11,
  5336           DFHEIV99
  5337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5338
  5339
  5340      MOVE 'Y'                       TO  WS-BROWSE-SW.
  5341
  5342 6000-READNEXT-ELTRLR.
  5343
  5344
  5345* EXEC CICS READNEXT
  5346*         DATASET   (ELTRLR-FILE-ID)
  5347*         RIDFLD    (WS-TRAILER-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 106
* EL151.cbl
  5348*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5349*     END-EXEC.
  5350     MOVE 0
  5351       TO DFHEIV11
  5352*    MOVE '&.S                   )   #00005074' TO DFHEIV0
  5353     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5354     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5355     MOVE X'2020233030303035303734' TO DFHEIV0(25:11)
  5356     CALL 'kxdfhei1' USING DFHEIV0,
  5357           ELTRLR-FILE-ID,
  5358           DFHEIV20,
  5359           DFHEIV99,
  5360           WS-TRAILER-KEY,
  5361           DFHEIV99,
  5362           DFHEIV11,
  5363           DFHEIV99,
  5364           DFHEIV99
  5365     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5366         DFHEIV20
  5367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5368
  5369
  5370      IF (PI-COMPANY-CD IS NOT EQUAL TO  WS-KEY-COMPANY-CD) OR
  5371         (PI-CARRIER    IS NOT EQUAL TO  WS-KEY-CARRIER)    OR
  5372         (PI-CLAIM-NO   IS NOT EQUAL TO  WS-KEY-CLAIM-NO)   OR
  5373         (PI-CERT-NO    IS NOT EQUAL TO  WS-KEY-CERT-NO)
  5374          GO TO 6000-END-RESET.
  5375
  5376      IF WS-TRAILER-KEY IS EQUAL TO PI-PREV-TRLR-KEY
  5377          GO TO 6000-READNEXT-ELTRLR.
  5378
  5379      IF AT-TRAILER-TYPE IS NOT EQUAL TO '4'
  5380          GO TO 6000-READNEXT-ELTRLR.
  5381
  5382      IF (AT-LETTER-ANSWERED-DT NOT EQUAL LOW-VALUES AND SPACES)
  5383          GO TO 6000-READNEXT-ELTRLR.
  5384
  5385      IF (AT-AUTO-RE-SEND-DT EQUAL LOW-VALUES OR SPACES)
  5386        AND
  5387         (AT-RECEIPT-FOLLOW-UP EQUAL LOW-VALUES OR SPACES)
  5388          GO TO 6000-READNEXT-ELTRLR.
  5389
  5390      IF AT-RECEIPT-FOLLOW-UP IS LESS THAN SAVE-BIN-DATE AND
  5391         AT-AUTO-RE-SEND-DT IS LESS THAN SAVE-BIN-DATE   AND
  5392         AT-RESEND-PRINT-DATE IS LESS THAN SAVE-BIN-DATE
  5393          GO TO 6000-READNEXT-ELTRLR.
  5394
  5395      IF (AT-AUTO-RE-SEND-DT NOT EQUAL LOW-VALUES AND SPACES)
  5396        AND
  5397         (AT-RESEND-PRINT-DATE NOT EQUAL LOW-VALUES AND SPACES)
  5398        AND
  5399         (AT-RECEIPT-FOLLOW-UP EQUAL LOW-VALUES)
  5400          GO TO 6000-READNEXT-ELTRLR.
  5401
  5402 6000-END-BROWSE.
  5403
  5404      MOVE WS-TRAILER-KEY            TO  PI-PREV-TRLR-KEY.
  5405
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 107
* EL151.cbl
  5406
  5407* EXEC CICS ENDBR
  5408*         DATASET   (ELTRLR-FILE-ID)
  5409*     END-EXEC.
  5410     MOVE 0
  5411       TO DFHEIV11
  5412*    MOVE '&2                    $   #00005116' TO DFHEIV0
  5413     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5414     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5415     MOVE X'2020233030303035313136' TO DFHEIV0(25:11)
  5416     CALL 'kxdfhei1' USING DFHEIV0,
  5417           ELTRLR-FILE-ID,
  5418           DFHEIV11,
  5419           DFHEIV99
  5420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5421
  5422
  5423      MOVE 'N'                       TO  WS-BROWSE-SW.
  5424
  5425 6000-READ-ELTRLR-UPDATE.
  5426
  5427
  5428* EXEC CICS READ
  5429*         DATASET   (ELTRLR-FILE-ID)
  5430*         RIDFLD    (WS-TRAILER-KEY)
  5431*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5432*         UPDATE
  5433*     END-EXEC.
  5434*    MOVE '&"S        EU         (   #00005124' TO DFHEIV0
  5435     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5436     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5437     MOVE X'2020233030303035313234' TO DFHEIV0(25:11)
  5438     CALL 'kxdfhei1' USING DFHEIV0,
  5439           ELTRLR-FILE-ID,
  5440           DFHEIV20,
  5441           DFHEIV99,
  5442           WS-TRAILER-KEY,
  5443           DFHEIV99,
  5444           DFHEIV99,
  5445           DFHEIV99
  5446     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5447         DFHEIV20
  5448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5449
  5450
  5451      MOVE 'Y'                       TO  WS-UPDATE-SW.
  5452
  5453      IF AT-AUTO-RE-SEND-DT IS NOT LESS THAN SAVE-BIN-DATE
  5454          MOVE LOW-VALUES            TO  AT-AUTO-RE-SEND-DT
  5455          MOVE PI-COMPANY-CD         TO  ELARCH-COMPANY-CD
  5456          MOVE AT-LETTER-ARCHIVE-NO  TO  ELARCH-ARCHIVE-NO
  5457          MOVE '1'                   TO  ELARCH-RECORD-TYPE
  5458          MOVE +0                    TO  ELARCH-SEQ-NO
  5459          PERFORM 6200-READ-ELARCH-UPDATE THRU 6200-EXIT.
  5460
  5461      IF AT-RECEIPT-FOLLOW-UP IS NOT LESS THAN SAVE-BIN-DATE
  5462          MOVE LOW-VALUES            TO  AT-RECEIPT-FOLLOW-UP.
  5463
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 108
* EL151.cbl
  5464 6000-REWRITE-ELTRLR.
  5465
  5466
  5467* EXEC CICS REWRITE
  5468*         DATASET   (ELTRLR-FILE-ID)
  5469*         FROM      (ACTIVITY-TRAILERS)
  5470*     END-EXEC.
  5471     MOVE LENGTH OF
  5472      ACTIVITY-TRAILERS
  5473       TO DFHEIV11
  5474*    MOVE '&& L                  %   #00005146' TO DFHEIV0
  5475     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5476     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5477     MOVE X'2020233030303035313436' TO DFHEIV0(25:11)
  5478     CALL 'kxdfhei1' USING DFHEIV0,
  5479           ELTRLR-FILE-ID,
  5480           ACTIVITY-TRAILERS,
  5481           DFHEIV11,
  5482           DFHEIV99
  5483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5484
  5485
  5486      GO TO 6000-STARTBR-ELTRLR.
  5487
  5488 6000-END-RESET.
  5489
  5490      IF WS-BROWSE-SW IS EQUAL TO 'Y'
  5491          MOVE 'N'                   TO  WS-BROWSE-SW
  5492
  5493* EXEC CICS ENDBR
  5494*             DATASET   (ELTRLR-FILE-ID)
  5495*         END-EXEC.
  5496     MOVE 0
  5497       TO DFHEIV11
  5498*    MOVE '&2                    $   #00005157' TO DFHEIV0
  5499     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5500     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5501     MOVE X'2020233030303035313537' TO DFHEIV0(25:11)
  5502     CALL 'kxdfhei1' USING DFHEIV0,
  5503           ELTRLR-FILE-ID,
  5504           DFHEIV11,
  5505           DFHEIV99
  5506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5507
  5508
  5509 6000-EXIT.
  5510     EXIT.
  5511
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 109
* EL151.cbl
  5513 6100-CHECK-AUTO-ACTIVITY.
  5514******************************************************************
  5515*    READ THE AUTOMATIC ACTIVITY RECORD TO DETERMINE IF THE      *
  5516*    AUTOMATIC ACTIVITY CODE IN THE CLAIM MASTER IS TO BE RESET. *
  5517******************************************************************
  5518
  5519
  5520* EXEC CICS HANDLE CONDITION
  5521*         NOTFND   (6100-NOT-FOUND)
  5522*     END-EXEC.
  5523*    MOVE '"$I                   ! '' #00005171' TO DFHEIV0
  5524     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5525     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5526     MOVE X'2720233030303035313731' TO DFHEIV0(25:11)
  5527     CALL 'kxdfhei1' USING DFHEIV0
  5528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5529
  5530
  5531      MOVE PI-COMPANY-ID             TO  ELCNTL-COMPANY-ID.
  5532      MOVE 'T'                       TO  ELCNTL-RECORD-TYPE.
  5533      MOVE SPACES                    TO  ELCNTL-ACCESS.
  5534      MOVE +0                        TO  ELCNTL-SEQ-NO.
  5535
  5536
  5537* EXEC CICS READ
  5538*         DATASET   (ELCNTL-FILE-ID)
  5539*         RIDFLD    (ELCNTL-KEY)
  5540*         SET       (ADDRESS OF CONTROL-FILE)
  5541*     END-EXEC.
  5542*    MOVE '&"S        E          (   #00005180' TO DFHEIV0
  5543     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5544     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5545     MOVE X'2020233030303035313830' TO DFHEIV0(25:11)
  5546     CALL 'kxdfhei1' USING DFHEIV0,
  5547           ELCNTL-FILE-ID,
  5548           DFHEIV20,
  5549           DFHEIV99,
  5550           ELCNTL-KEY,
  5551           DFHEIV99,
  5552           DFHEIV99,
  5553           DFHEIV99
  5554     SET ADDRESS OF CONTROL-FILE TO
  5555         DFHEIV20
  5556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5557
  5558
  5559      IF CL-ACTIVITY-CODE IS NOT EQUAL TO ZEROS
  5560          MOVE CL-ACTIVITY-CODE      TO  MISC-SUB
  5561          IF MISC-SUB IS GREATER THAN +9
  5562              SUBTRACT +9 FROM MISC-SUB
  5563              MOVE CF-USER-RESET-SW (MISC-SUB) TO  WS-RESET-SW
  5564          ELSE
  5565              MOVE CF-SYS-RESET-SW  (MISC-SUB) TO  WS-RESET-SW.
  5566
  5567      MOVE 'Y'                       TO  WS-REC-FOUND-SW.
  5568      GO TO 6100-EXIT.
  5569
  5570 6100-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 110
* EL151.cbl
  5571
  5572     MOVE 'N'                        TO  WS-RESET-SW
  5573                                         WS-REC-FOUND-SW.
  5574
  5575 6100-EXIT.
  5576     EXIT.
  5577
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 111
* EL151.cbl
  5579 6200-READ-ELARCH-UPDATE.
  5580******************************************************************
  5581*  READ AND UPDATE THE RESEND DATE IN THE LETTER ARCHIVE RECORD  *
  5582******************************************************************
  5583
  5584
  5585* EXEC CICS HANDLE CONDITION
  5586*         NOTFND   (6200-EXIT)
  5587*     END-EXEC.
  5588*    MOVE '"$I                   ! ( #00005211' TO DFHEIV0
  5589     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5590     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5591     MOVE X'2820233030303035323131' TO DFHEIV0(25:11)
  5592     CALL 'kxdfhei1' USING DFHEIV0
  5593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5594
  5595
  5596
  5597* EXEC CICS READ
  5598*         DATASET   (ELARCH-FILE-ID)
  5599*         RIDFLD    (ELARCH-KEY)
  5600*         SET       (ADDRESS OF LETTER-ARCHIVE)
  5601*         UPDATE
  5602*     END-EXEC.
  5603*    MOVE '&"S        EU         (   #00005215' TO DFHEIV0
  5604     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5605     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5606     MOVE X'2020233030303035323135' TO DFHEIV0(25:11)
  5607     CALL 'kxdfhei1' USING DFHEIV0,
  5608           ELARCH-FILE-ID,
  5609           DFHEIV20,
  5610           DFHEIV99,
  5611           ELARCH-KEY,
  5612           DFHEIV99,
  5613           DFHEIV99,
  5614           DFHEIV99
  5615     SET ADDRESS OF LETTER-ARCHIVE TO
  5616         DFHEIV20
  5617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5618
  5619
  5620      MOVE LOW-VALUES                TO  LA-RESEND-DATE.
  5621
  5622 6200-REWRITE-ELARCH.
  5623
  5624
  5625* EXEC CICS REWRITE
  5626*         DATASET   (ELARCH-FILE-ID)
  5627*         FROM      (LETTER-ARCHIVE)
  5628*     END-EXEC.
  5629     MOVE LENGTH OF
  5630      LETTER-ARCHIVE
  5631       TO DFHEIV11
  5632*    MOVE '&& L                  %   #00005226' TO DFHEIV0
  5633     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5634     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5635     MOVE X'2020233030303035323236' TO DFHEIV0(25:11)
  5636     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 112
* EL151.cbl
  5637           ELARCH-FILE-ID,
  5638           LETTER-ARCHIVE,
  5639           DFHEIV11,
  5640           DFHEIV99
  5641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5642
  5643
  5644 6200-EXIT.
  5645     EXIT.
  5646
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 113
* EL151.cbl
  5648 7000-READ-ELMSTR-UPDATE.
  5649
  5650
  5651* EXEC CICS  HANDLE CONDITION
  5652*           NOTFND  (7000-NOTFND)
  5653*           NOTOPEN (9981-NOTOPEN-MSTR)
  5654*    END-EXEC.
  5655*    MOVE '"$IJ                  ! ) #00005237' TO DFHEIV0
  5656     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  5657     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5658     MOVE X'2920233030303035323337' TO DFHEIV0(25:11)
  5659     CALL 'kxdfhei1' USING DFHEIV0
  5660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5661
  5662
  5663
  5664* EXEC CICS  READ
  5665*        DATASET  (ELMSTR-FILE-ID)
  5666*        RIDFLD   (WS-CLAIM-KEY)
  5667*        SET      (ADDRESS OF CLAIM-MASTER)
  5668*        UPDATE
  5669*    END-EXEC.
  5670*    MOVE '&"S        EU         (   #00005242' TO DFHEIV0
  5671     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5672     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5673     MOVE X'2020233030303035323432' TO DFHEIV0(25:11)
  5674     CALL 'kxdfhei1' USING DFHEIV0,
  5675           ELMSTR-FILE-ID,
  5676           DFHEIV20,
  5677           DFHEIV99,
  5678           WS-CLAIM-KEY,
  5679           DFHEIV99,
  5680           DFHEIV99,
  5681           DFHEIV99
  5682     SET ADDRESS OF CLAIM-MASTER TO
  5683         DFHEIV20
  5684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5685
  5686
  5687     GO TO 7000-EXIT.
  5688
  5689 7000-NOTFND.
  5690
  5691     MOVE ER-0133                TO  EMI-ERROR.
  5692     MOVE -1                     TO  MLINE1L.
  5693     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5694     GO TO 8200-SEND-DATAONLY.
  5695
  5696 7000-EXIT.
  5697      EXIT.
  5698
  5699 7010-REWRITE-ELMSTR.
  5700
  5701
  5702* EXEC CICS HANDLE CONDITION
  5703*        DUPKEY (7010-EXIT)
  5704*        END-EXEC.
  5705*    MOVE '"$$                   ! * #00005263' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 114
* EL151.cbl
  5706     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  5707     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5708     MOVE X'2A20233030303035323633' TO DFHEIV0(25:11)
  5709     CALL 'kxdfhei1' USING DFHEIV0
  5710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5711
  5712
  5713
  5714* EXEC CICS  REWRITE
  5715*        DATASET  (ELMSTR-FILE-ID)
  5716*        FROM     (CLAIM-MASTER)
  5717*    END-EXEC.
  5718     MOVE LENGTH OF
  5719      CLAIM-MASTER
  5720       TO DFHEIV11
  5721*    MOVE '&& L                  %   #00005267' TO DFHEIV0
  5722     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5723     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5724     MOVE X'2020233030303035323637' TO DFHEIV0(25:11)
  5725     CALL 'kxdfhei1' USING DFHEIV0,
  5726           ELMSTR-FILE-ID,
  5727           CLAIM-MASTER,
  5728           DFHEIV11,
  5729           DFHEIV99
  5730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5731
  5732
  5733 7010-EXIT.
  5734      EXIT.
  5735
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 115
* EL151.cbl
  5737 7100-GETMAIN-ELTRLR.
  5738
  5739
  5740* EXEC CICS GETMAIN
  5741*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  5742*        INITIMG (GETMAIN-SPACE)
  5743*        LENGTH  (WS-TRLR-LENGTH)
  5744*    END-EXEC.
  5745*    MOVE ',"IL                  $   #00005278' TO DFHEIV0
  5746     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5747     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5748     MOVE X'2020233030303035323738' TO DFHEIV0(25:11)
  5749     CALL 'kxdfhei1' USING DFHEIV0,
  5750           DFHEIV20,
  5751           WS-TRLR-LENGTH,
  5752           GETMAIN-SPACE
  5753     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5754         DFHEIV20
  5755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5756
  5757
  5758 7100-EXIT.
  5759     EXIT.
  5760
  5761 7110-WRITE-ELTRLR.
  5762
  5763* EXEC CICS  HANDLE CONDITION
  5764*           DUPREC   (7110-DUPREC)
  5765*    END-EXEC.
  5766*    MOVE '"$%                   ! + #00005288' TO DFHEIV0
  5767     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  5768     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5769     MOVE X'2B20233030303035323838' TO DFHEIV0(25:11)
  5770     CALL 'kxdfhei1' USING DFHEIV0
  5771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5772
  5773
  5774
  5775* EXEC CICS  WRITE
  5776*           DATASET  (ELTRLR-FILE-ID)
  5777*           RIDFLD   (WS-TRAILER-KEY)
  5778*           FROM     (ACTIVITY-TRAILERS)
  5779*    END-EXEC.
  5780     MOVE LENGTH OF
  5781      ACTIVITY-TRAILERS
  5782       TO DFHEIV11
  5783*    MOVE '&$ L                  ''   #00005292' TO DFHEIV0
  5784     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5785     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5786     MOVE X'2020233030303035323932' TO DFHEIV0(25:11)
  5787     CALL 'kxdfhei1' USING DFHEIV0,
  5788           ELTRLR-FILE-ID,
  5789           ACTIVITY-TRAILERS,
  5790           DFHEIV11,
  5791           WS-TRAILER-KEY,
  5792           DFHEIV99,
  5793           DFHEIV99
  5794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 116
* EL151.cbl
  5795
  5796
  5797     GO TO 7110-EXIT.
  5798
  5799 7110-DUPREC.
  5800
  5801     MOVE ER-0132                TO  EMI-ERROR.
  5802     MOVE -1                     TO  MLINE1L.
  5803     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5804     GO TO 8200-SEND-DATAONLY.
  5805
  5806 7110-EXIT.
  5807      EXIT.
  5808
  5809 7120-READ-ELTRLR-UPDATE.
  5810
  5811
  5812* EXEC CICS  HANDLE CONDITION
  5813*           NOTFND  (9965-NO-TRLR-ERROR)
  5814*           NOTOPEN (9982-NOTOPEN-TRLR)
  5815*    END-EXEC.
  5816*    MOVE '"$IJ                  ! , #00005312' TO DFHEIV0
  5817     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  5818     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5819     MOVE X'2C20233030303035333132' TO DFHEIV0(25:11)
  5820     CALL 'kxdfhei1' USING DFHEIV0
  5821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5822
  5823
  5824
  5825* EXEC CICS  READ
  5826*        DATASET  (ELTRLR-FILE-ID)
  5827*        RIDFLD   (WS-TRAILER-KEY)
  5828*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  5829*        UPDATE
  5830*    END-EXEC.
  5831*    MOVE '&"S        EU         (   #00005317' TO DFHEIV0
  5832     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5833     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5834     MOVE X'2020233030303035333137' TO DFHEIV0(25:11)
  5835     CALL 'kxdfhei1' USING DFHEIV0,
  5836           ELTRLR-FILE-ID,
  5837           DFHEIV20,
  5838           DFHEIV99,
  5839           WS-TRAILER-KEY,
  5840           DFHEIV99,
  5841           DFHEIV99,
  5842           DFHEIV99
  5843     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5844         DFHEIV20
  5845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5846
  5847
  5848 7120-EXIT.
  5849      EXIT.
  5850
  5851 7130-REWRITE-ELTRLR.
  5852
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 117
* EL151.cbl
  5853
  5854* EXEC CICS  REWRITE
  5855*        DATASET  (ELTRLR-FILE-ID)
  5856*        FROM     (ACTIVITY-TRAILERS)
  5857*    END-EXEC.
  5858     MOVE LENGTH OF
  5859      ACTIVITY-TRAILERS
  5860       TO DFHEIV11
  5861*    MOVE '&& L                  %   #00005329' TO DFHEIV0
  5862     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5863     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5864     MOVE X'2020233030303035333239' TO DFHEIV0(25:11)
  5865     CALL 'kxdfhei1' USING DFHEIV0,
  5866           ELTRLR-FILE-ID,
  5867           ACTIVITY-TRAILERS,
  5868           DFHEIV11,
  5869           DFHEIV99
  5870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5871
  5872
  5873 7130-EXIT.
  5874      EXIT.
  5875
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 118
* EL151.cbl
  5877 8100-SEND-INITIAL-MAP.
  5878
  5879     MOVE SAVE-DATE                  TO  MRNDATEO.
  5880     MOVE EIBTIME                    TO  TIME-IN.
  5881     MOVE TIME-OUT                   TO  MRNTIMEO.
  5882
  5883
  5884* EXEC CICS  SEND
  5885*         MAP      (MAP-NAME)
  5886*         MAPSET   (MAPSET-NAME)
  5887*         FROM     (EL151AO)
  5888*         ERASE
  5889*         CURSOR
  5890*    END-EXEC.
  5891     MOVE LENGTH OF
  5892      EL151AO
  5893       TO DFHEIV12
  5894     MOVE -1
  5895       TO DFHEIV11
  5896*    MOVE '8$     CT  E    H L F ,   #00005344' TO DFHEIV0
  5897     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5898     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5899     MOVE X'2020233030303035333434' TO DFHEIV0(25:11)
  5900     CALL 'kxdfhei1' USING DFHEIV0,
  5901           MAP-NAME,
  5902           EL151AO,
  5903           DFHEIV12,
  5904           MAPSET-NAME,
  5905           DFHEIV99,
  5906           DFHEIV99,
  5907           DFHEIV99,
  5908           DFHEIV11,
  5909           DFHEIV99,
  5910           DFHEIV99,
  5911           DFHEIV99
  5912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5913
  5914
  5915     GO TO 9100-RETURN-TRAN.
  5916
  5917 8200-SEND-DATAONLY.
  5918
  5919     MOVE SAVE-DATE                  TO  MRNDATEO.
  5920     MOVE EIBTIME                    TO  TIME-IN.
  5921     MOVE TIME-OUT                   TO  MRNTIMEO.
  5922
  5923
  5924* EXEC CICS  SEND
  5925*        MAP       (MAP-NAME)
  5926*        MAPSET    (MAPSET-NAME)
  5927*        FROM      (EL151AO)
  5928*        DATAONLY
  5929*        CURSOR
  5930*    END-EXEC.
  5931     MOVE LENGTH OF
  5932      EL151AO
  5933       TO DFHEIV12
  5934     MOVE -1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 119
* EL151.cbl
  5935       TO DFHEIV11
  5936*    MOVE '8$D    CT       H L F ,   #00005360' TO DFHEIV0
  5937     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5938     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5939     MOVE X'2020233030303035333630' TO DFHEIV0(25:11)
  5940     CALL 'kxdfhei1' USING DFHEIV0,
  5941           MAP-NAME,
  5942           EL151AO,
  5943           DFHEIV12,
  5944           MAPSET-NAME,
  5945           DFHEIV99,
  5946           DFHEIV99,
  5947           DFHEIV99,
  5948           DFHEIV11,
  5949           DFHEIV99,
  5950           DFHEIV99,
  5951           DFHEIV99
  5952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5953
  5954
  5955     GO TO 9100-RETURN-TRAN.
  5956
  5957 8300-SEND-TEXT.
  5958
  5959* EXEC CICS SEND TEXT
  5960*        FROM     (LOGOFF-TEXT)
  5961*        LENGTH   (LOGOFF-LENGTH)
  5962*        ERASE
  5963*        FREEKB
  5964*    END-EXEC.
  5965*    MOVE '8&      T  E F  H   F -   #00005371' TO DFHEIV0
  5966     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5967     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5968     MOVE X'2020233030303035333731' TO DFHEIV0(25:11)
  5969     CALL 'kxdfhei1' USING DFHEIV0,
  5970           LOGOFF-TEXT,
  5971           LOGOFF-LENGTH,
  5972           DFHEIV99,
  5973           DFHEIV99,
  5974           DFHEIV99,
  5975           DFHEIV99,
  5976           DFHEIV99,
  5977           DFHEIV99,
  5978           DFHEIV99,
  5979           DFHEIV99,
  5980           DFHEIV99,
  5981           DFHEIV99
  5982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5983
  5984
  5985
  5986* EXEC CICS RETURN
  5987*        END-EXEC.
  5988*    MOVE '.(                    &   #00005378' TO DFHEIV0
  5989     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5990     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5991     MOVE X'2020233030303035333738' TO DFHEIV0(25:11)
  5992     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 120
* EL151.cbl
  5993           DFHEIV99,
  5994           DFHEIV99,
  5995           DFHEIV99,
  5996           DFHEIV99,
  5997           DFHEIV99
  5998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5999
  6000
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 121
* EL151.cbl
  6002 9600-PGMID-ERROR.
  6003
  6004* EXEC CICS HANDLE CONDITION
  6005*        PGMIDERR (8300-SEND-TEXT)
  6006*    END-EXEC.
  6007*    MOVE '"$L                   ! - #00005383' TO DFHEIV0
  6008     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  6009     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6010     MOVE X'2D20233030303035333833' TO DFHEIV0(25:11)
  6011     CALL 'kxdfhei1' USING DFHEIV0
  6012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6013
  6014
  6015     MOVE THIS-PGM               TO LOGOFF-PGM
  6016                                    PI-CALLING-PROGRAM.
  6017     MOVE SPACES                 TO PI-ENTRY-CD-1.
  6018     MOVE 'EL005'                TO THIS-PGM.
  6019     MOVE THIS-PGM               TO LOGOFF-PGM.
  6020     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  6021     GO TO 9300-XCTL.
  6022
  6023 8800-UNAUTHORIZED-ACCESS.
  6024
  6025     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  6026     GO TO 8300-SEND-TEXT.
  6027
  6028 9100-RETURN-TRAN.
  6029     MOVE EMI-ERROR-NUMBER (1)    TO  PI-LAST-ERROR-NO.
  6030     MOVE '151A'                  TO  PI-CURRENT-SCREEN-NO.
  6031
  6032
  6033* EXEC CICS  RETURN
  6034*        TRANSID  (WS-TRANS-ID)
  6035*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  6036*        LENGTH   (PI-COMM-LENGTH)
  6037*    END-EXEC.
  6038*    MOVE '.(CT                  &   #00005404' TO DFHEIV0
  6039     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  6040     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6041     MOVE X'2020233030303035343034' TO DFHEIV0(25:11)
  6042     CALL 'kxdfhei1' USING DFHEIV0,
  6043           WS-TRANS-ID,
  6044           PROGRAM-INTERFACE-BLOCK,
  6045           PI-COMM-LENGTH,
  6046           DFHEIV99,
  6047           DFHEIV99
  6048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6049
  6050
  6051 9300-XCTL.
  6052
  6053* EXEC CICS XCTL
  6054*        PROGRAM  (THIS-PGM)
  6055*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  6056*        LENGTH   (PI-COMM-LENGTH)
  6057*    END-EXEC.
  6058*    MOVE '.$C                   $   #00005411' TO DFHEIV0
  6059     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 122
* EL151.cbl
  6060     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6061     MOVE X'2020233030303035343131' TO DFHEIV0(25:11)
  6062     CALL 'kxdfhei1' USING DFHEIV0,
  6063           THIS-PGM,
  6064           PROGRAM-INTERFACE-BLOCK,
  6065           PI-COMM-LENGTH
  6066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6067
  6068
  6069 9400-CLEAR.
  6070     MOVE PI-RETURN-TO-PROGRAM       TO  THIS-PGM.
  6071     GO TO 9300-XCTL.
  6072
  6073 9650-DEEDIT.
  6074
  6075* EXEC CICS BIF DEEDIT
  6076*        FIELD (DEEDIT-FIELD)
  6077*        LENGTH(15)
  6078*    END-EXEC.
  6079     MOVE 15
  6080       TO DFHEIV11
  6081*    MOVE '@"L                   #   #00005422' TO DFHEIV0
  6082     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6083     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6084     MOVE X'2020233030303035343232' TO DFHEIV0(25:11)
  6085     CALL 'kxdfhei1' USING DFHEIV0,
  6086           DEEDIT-FIELD,
  6087           DFHEIV11
  6088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6089
  6090
  6091 9650-EXIT.
  6092      EXIT.
  6093
  6094 9700-LINK-DATE-CONVERT.
  6095
  6096* EXEC CICS LINK
  6097*           PROGRAM  ('ELDATCV')
  6098*           COMMAREA (DATE-CONVERSION-DATA)
  6099*           LENGTH   (DC-COMM-LENGTH)
  6100*    END-EXEC.
  6101     MOVE 'ELDATCV' TO DFHEIV1
  6102*    MOVE '."C                   ''   #00005431' TO DFHEIV0
  6103     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6104     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6105     MOVE X'2020233030303035343331' TO DFHEIV0(25:11)
  6106     CALL 'kxdfhei1' USING DFHEIV0,
  6107           DFHEIV1,
  6108           DATE-CONVERSION-DATA,
  6109           DC-COMM-LENGTH,
  6110           DFHEIV99,
  6111           DFHEIV99,
  6112           DFHEIV99
  6113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6114
  6115
  6116 9700-EXIT.
  6117      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 123
* EL151.cbl
  6118
  6119 9900-ERROR-FORMAT.
  6120
  6121
  6122* EXEC CICS LINK
  6123*        PROGRAM  ('EL001')
  6124*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  6125*        LENGTH   (EMI-COMM-LENGTH)
  6126*    END-EXEC.
  6127     MOVE 'EL001' TO DFHEIV1
  6128*    MOVE '."C                   ''   #00005442' TO DFHEIV0
  6129     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6130     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6131     MOVE X'2020233030303035343432' TO DFHEIV0(25:11)
  6132     CALL 'kxdfhei1' USING DFHEIV0,
  6133           DFHEIV1,
  6134           ERROR-MESSAGE-INTERFACE-BLOCK,
  6135           EMI-COMM-LENGTH,
  6136           DFHEIV99,
  6137           DFHEIV99,
  6138           DFHEIV99
  6139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6140
  6141
  6142     MOVE EMI-LINE1              TO  MERMSG1O.
  6143
  6144 9900-EXIT.
  6145      EXIT.
  6146
  6147 9965-NO-TRLR-ERROR.
  6148     MOVE ER-0270                TO  EMI-ERROR.
  6149     MOVE -1                     TO  MLINE1L.
  6150     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6151     GO TO 8200-SEND-DATAONLY.
  6152
  6153 9981-NOTOPEN-MSTR.
  6154     MOVE ER-0154                TO EMI-ERROR
  6155     MOVE -1                     TO  MLINE1L.
  6156     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6157     GO TO 8200-SEND-DATAONLY.
  6158
  6159 9982-NOTOPEN-TRLR.
  6160     MOVE ER-0172                TO EMI-ERROR
  6161     MOVE -1                     TO  MLINE1L.
  6162     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6163     GO TO 8200-SEND-DATAONLY.
  6164
  6165 9986-NOTOPEN-DLYACTV.
  6166     MOVE '2955'                 TO EMI-ERROR.
  6167     MOVE -1                     TO  MLINE1L.
  6168     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6169     GO TO 8200-SEND-DATAONLY.
  6170
  6171 9995-SECURITY-VIOLATION.
  6172*                            COPY ELCSCTP.
  6173******************************************************************
  6174*                                                                *
  6175*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 124
* EL151.cbl
  6176*                            VMOD=2.001                          *
  6177*                                                                *
  6178*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  6179******************************************************************
  6180
  6181
  6182     MOVE EIBDATE          TO SM-JUL-DATE.
  6183     MOVE EIBTRMID         TO SM-TERMID.
  6184     MOVE THIS-PGM         TO SM-PGM.
  6185     MOVE EIBTIME          TO TIME-IN.
  6186     MOVE TIME-OUT         TO SM-TIME.
  6187     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  6188
  6189
  6190* EXEC CICS LINK
  6191*         PROGRAM  ('EL003')
  6192*         COMMAREA (SECURITY-MESSAGE)
  6193*         LENGTH   (80)
  6194*    END-EXEC.
  6195     MOVE 'EL003' TO DFHEIV1
  6196     MOVE 80
  6197       TO DFHEIV11
  6198*    MOVE '."C                   ''   #00005495' TO DFHEIV0
  6199     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6200     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6201     MOVE X'2020233030303035343935' TO DFHEIV0(25:11)
  6202     CALL 'kxdfhei1' USING DFHEIV0,
  6203           DFHEIV1,
  6204           SECURITY-MESSAGE,
  6205           DFHEIV11,
  6206           DFHEIV99,
  6207           DFHEIV99,
  6208           DFHEIV99
  6209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6210
  6211
  6212******************************************************************
  6213
  6214
  6215 9995-EXIT.
  6216     EXIT.
  6217
  6218 9990-ABEND.
  6219     MOVE -1                      TO  MPFNUMBL.
  6220     MOVE DFHEIBLK                TO  EMI-LINE1.
  6221
  6222
  6223* EXEC CICS LINK
  6224*          PROGRAM  ('EL004')
  6225*          COMMAREA (EMI-LINE1)
  6226*          LENGTH   (72)
  6227*    END-EXEC.
  6228     MOVE 'EL004' TO DFHEIV1
  6229     MOVE 72
  6230       TO DFHEIV11
  6231*    MOVE '."C                   ''   #00005511' TO DFHEIV0
  6232     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6233     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 125
* EL151.cbl
  6234     MOVE X'2020233030303035353131' TO DFHEIV0(25:11)
  6235     CALL 'kxdfhei1' USING DFHEIV0,
  6236           DFHEIV1,
  6237           EMI-LINE1,
  6238           DFHEIV11,
  6239           DFHEIV99,
  6240           DFHEIV99,
  6241           DFHEIV99
  6242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6243
  6244
  6245     MOVE EMI-LINE1               TO  MERMSG1O.
  6246     GO TO 8200-SEND-DATAONLY.
  6247
  6248
  6249 9999-DFHBACK SECTION.
  6250     MOVE '9%                    "   ' TO DFHEIV0
  6251     MOVE 'EL151' TO DFHEIV1
  6252     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6253     GOBACK.
  6254 9999-DFHEXIT.
  6255     IF DFHEIGDJ EQUAL 0001
  6256         NEXT SENTENCE
  6257     ELSE IF DFHEIGDJ EQUAL 2
  6258         GO TO 9990-ABEND,
  6259               9600-PGMID-ERROR
  6260         DEPENDING ON DFHEIGDI
  6261     ELSE IF DFHEIGDJ EQUAL 3
  6262         GO TO 2000-NOTE-NOT-FOUND
  6263         DEPENDING ON DFHEIGDI
  6264     ELSE IF DFHEIGDJ EQUAL 4
  6265         GO TO 9986-NOTOPEN-DLYACTV,
  6266               2350-EXIT
  6267         DEPENDING ON DFHEIGDI
  6268     ELSE IF DFHEIGDJ EQUAL 5
  6269         GO TO 3550-END,
  6270               3550-END
  6271         DEPENDING ON DFHEIGDI
  6272     ELSE IF DFHEIGDJ EQUAL 6
  6273         GO TO 6000-END-RESET,
  6274               6000-END-RESET
  6275         DEPENDING ON DFHEIGDI
  6276     ELSE IF DFHEIGDJ EQUAL 7
  6277         GO TO 6100-NOT-FOUND
  6278         DEPENDING ON DFHEIGDI
  6279     ELSE IF DFHEIGDJ EQUAL 8
  6280         GO TO 6200-EXIT
  6281         DEPENDING ON DFHEIGDI
  6282     ELSE IF DFHEIGDJ EQUAL 9
  6283         GO TO 7000-NOTFND,
  6284               9981-NOTOPEN-MSTR
  6285         DEPENDING ON DFHEIGDI
  6286     ELSE IF DFHEIGDJ EQUAL 10
  6287         GO TO 7010-EXIT
  6288         DEPENDING ON DFHEIGDI
  6289     ELSE IF DFHEIGDJ EQUAL 11
  6290         GO TO 7110-DUPREC
  6291         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 126
* EL151.cbl
  6292     ELSE IF DFHEIGDJ EQUAL 12
  6293         GO TO 9965-NO-TRLR-ERROR,
  6294               9982-NOTOPEN-TRLR
  6295         DEPENDING ON DFHEIGDI
  6296     ELSE IF DFHEIGDJ EQUAL 13
  6297         GO TO 8300-SEND-TEXT
  6298         DEPENDING ON DFHEIGDI.
  6299     MOVE '9%                    "   ' TO DFHEIV0
  6300     MOVE 'EL151' TO DFHEIV1
  6301     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6302     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        5328     Code:       14411
