* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   1
* EL689.cbl
* Options: int("EL689.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL689.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL689.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL689.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL689 .
     5*              PROGRAM CONVERTED BY
     6*              COBOL CONVERSION AID PO 5785-ABJ
     7*              CONVERSION DATE 04/20/94 15:10:07.
     8*                            VMOD=2.037
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12*DATE-COMPILED.
    13*REMARKS.    TRANSACTION - EXH3 - CREDIT LETTER WRITER.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   2
* EL689.cbl
    14*
    15******************************************************************
    16
    17* W-FILE-USED REFERENCE LIST:
    18* (1)  ELCNTL - COMPANY
    19* (2)  ELCNTL - LIFE BENEFIT
    20* (3)  ELCNTL - A&H BENEFIT
    21* (4)  ELCNTL - CARRIER
    22* (5)  MAIL
    23* (6)  ERACCT
    24* (7)  USED FOR SYSTEM VARIABLES ?
    25* (8)  ELCERT
    26* (9)  PENDING BUSINESS
    27* (10) COMPENSATION
    28* (11) ELCNTL - PROCESSOR DATA ?
    29* (12) ERCHEK
    30* (13) ERPYAJ
    31* (14) NOT USED
    32* (15) NOT USED
    33* (16) NOT USED
    34* (17) NOT USED
    35* (18) NOT USED
    36* (19) NOT USED
    37* (20) NOT USED
    38*
    39******************************************************************
    40*                   C H A N G E   L O G
    41*
    42* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    43*-----------------------------------------------------------------
    44*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    45* EFFECTIVE    NUMBER
    46*-----------------------------------------------------------------
    47* 101501    2001100100006  SMVA  ADD USERID to screen header
    48*                                ADJUSTED REDEFINES EL689AI FILLER
    49* 031504    2004020600009  SMVA  PULL MOST CURRENT ACCT ADDRESS
    50* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    51* 100705    2004072800003  PEMA  ADD NEW VARIABLES
    52* 072308    2008062700001  PEMA  ADD NEW VARIABLES
    53* 092908    2008013100006  PEMA  MOVE VAR 154
    54* 102408  CR2008091000001  PEMA  MOVE PNDB VARS TO CERT VARS
    55* 051209  CR2009021700003  PEMA  ADD CRED BENE VARIABLES
    56* 051209  CR2009042700002  PEMA  ADD ERACCT ACCT NUMBER VARIABLE
    57* 022510  IR2009062300003  PEMA  ADD ENDFILE TEST TO ERACCT READ
    58* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    59* 041811  CR2011010400001  PEMA  DISABLE PF8 FOR CERTAIN USERS
    60* 042011  CR2011010400001  PEMA  FIX CRED BENE ADDRESS LINES
    61* 061411  CR2011061300001  PEMA  ADD ALWA TO PF8 DISABLE LIST
    62* 092911  IR2011092900001  AJRA  CLEAR LABEL LINES BEFORE CRED BEN
    63* 022712  IR2012022700001  AJRA  DON'T COUNT &&&&&& IN LINES
    64* 122011  CR2011022800001  AJRA  NAPERSOFT
    65* 090612  IR2012090600001  AJRA  NAPERSOFT
    66* 091712  IR2012091400001  AJRA  NAPERSOFT CERT ID
    67* 091912  IR2012091900001  AJRA  ALLOW FOLLOW UP DATE TO = CURR DT
    68* 101812  CR2012101700002  AJRA  ADD ENDARCH AND SCREENID
    69* 110512  CR2012101700002  AJRA  EXIT LETTER WRITER AFTER PF7
    70* 120512  CR2012101700002  AJRA  ADD RE ENCL CODE
    71* 011013  CR2012101700002  AJRA  CHECK REQ REASON CODE IND
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   3
* EL689.cbl
    72* 012413  CR2013012100001  AJRA  ADD AUTO BILLING NOTE
    73* 121213  CR2013090300001  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    74* 123113  CR2013090300001  AJRA  USE NEXT BUS DT FOR RESEND DT CAL
    75* 010814  CR2013090300001  AJRA  CALL SQL STORED PROC FOR NEXT BUS
    76* 021214  IR2014021200002  AJRA  ADD SQL DISCONNECT
    77* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    78* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    79******************************************************************
    80
    81 DATA DIVISION.
    82 WORKING-STORAGE SECTION.
    83 01  DFH-START PIC X(04).
    84 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    85 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    86                                   USAGE POINTER.
    87 77  FILLER  PIC X(32) VALUE '********************************'.
    88 77  FILLER  PIC X(32) VALUE '*    EL689 WORKING STORAGE     *'.
    89 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
    90
*   91 EXEC SQL
*   92    INCLUDE SQLDA
*   93 END-EXEC
    94 01 SQLDA sync.
    95    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    96    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    97    05 SQLN                  PIC S9(4) COMP-5 value 0.
    98    05 SQLD                  PIC S9(4) COMP-5 value 0.
    99    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   100       10 SQLTYPE            PIC S9(4) COMP-5.
   101       10 SQLLEN             PIC S9(4) COMP-5.
   102$IF P64 SET
   103X      *> For 64-bit environments, ensure that SQLDATA is
   104X      *> aligned on an 8-byte boundary.
   105X      10 FILLER             PIC S9(9) COMP-5.
   106$END
   107       10 SQLDATA            USAGE POINTER.
   108       10 SQLIND             USAGE POINTER.
   109       10 SQLNAME.
   110          15 SQLNAMEL        PIC S9(4) COMP-5.
   111          15 SQLNAMEC        PIC X(30).
   112
   113* Values for SQLTYPE
   114
   115 78  ESQL-DATE-CHAR              VALUE 384.
   116 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   117 78  ESQL-DATE-REC               VALUE 386.
   118 78  ESQL-DATE-REC-NULL          VALUE 387.
   119 78  ESQL-TIME-CHAR              VALUE 388.
   120 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   121 78  ESQL-TIME-REC               VALUE 390.
   122 78  ESQL-TIME-REC-NULL          VALUE 391.
   123 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   124 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   125 78  ESQL-TIMESTAMP-REC          VALUE 394.
   126 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   127 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   128 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   129 78  ESQL-TS-OFFSET-REC          VALUE 398.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   4
* EL689.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   131 78  ESQL-LONGVARBINARY          VALUE 404.
   132 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   133 78  ESQL-LONGVARCHAR            VALUE 408.
   134 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   135 78  ESQL-BINARY                 VALUE 444.
   136 78  ESQL-BINARY-NULL            VALUE 445.
   137 78  ESQL-VARBINARY              VALUE 446.
   138 78  ESQL-VARBINARY-NULL         VALUE 447.
   139 78  ESQL-VARCHAR                VALUE 448.
   140 78  ESQL-VARCHAR-NULL           VALUE 449.
   141
   142 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   143 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   144
   145 78  ESQL-CHAR                   VALUE 452.
   146 78  ESQL-CHAR-NULL              VALUE 453.
   147
   148 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   149 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   150
   151 78  ESQL-DOUBLE                 VALUE 480.
   152 78  ESQL-DOUBLE-NULL            VALUE 481.
   153 78  ESQL-REAL                   VALUE 482.
   154 78  ESQL-REAL-NULL              VALUE 483.
   155 78  ESQL-DECIMAL                VALUE 484.
   156 78  ESQL-DECIMAL-NULL           VALUE 485.
   157 78  ESQL-INTEGER                VALUE 496.
   158 78  ESQL-INTEGER-NULL           VALUE 497.
   159 78  ESQL-SMALLINT               VALUE 500.
   160 78  ESQL-SMALLINT-NULL          VALUE 501.
   161 78  ESQL-TINYINT                VALUE 502.
   162 78  ESQL-TINYINT-NULL           VALUE 503.
   163
*  164 EXEC SQL
*  165    INCLUDE SQLCA
*  166 END-EXEC
   167 01 SQLCA.
   168     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   169     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   170     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   171     05  SQLERRM.
   172         49  SQLERRML    PIC S9(4) COMP-5.
   173         49  SQLERRMC    PIC X(70).
   174     05  SQLERRP         PIC X(8).
   175     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   176     05  SQLWARN.
   177         10  SQLWARN0    PIC X.
   178         10  SQLWARN1    PIC X.
   179         10  SQLWARN2    PIC X.
   180         10  SQLWARN3    PIC X.
   181         10  SQLWARN4    PIC X.
   182         10  SQLWARN5    PIC X.
   183         10  SQLWARN6    PIC X.
   184         10  SQLWARN7    PIC X.
   185     05  SQLEXT.
   186         10  SQLWARN8    PIC X.
   187         10  SQLWARN9    PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   5
* EL689.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188         10  SQLWARN10   PIC X.
   189         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   190     05  SQLSTATE    PIC X(5).
   191
   192 EXEC SQL
   193    BEGIN DECLARE SECTION
   194 END-EXEC
   195
   196 01  SQLCMD                      PIC X(1024).
   197 01  SVR                         PIC X(32).
   198 01  USR                         PIC X(32).
   199 01  PASS                        PIC X(32).
   200 01  USR-PASS                    PIC X(64).
   201
   202 01  WS-SQL-DATA.
   203     05  WS-CYCLE-DATE           PIC X(10).
   204     05  WS-NEXT-BUS-DT          PIC X(10).
   205
   206 EXEC SQL
   207    END DECLARE SECTION
   208 END-EXEC
   209
   210 01  P pointer.
   211 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   212 01  KIXHOST             pic x(9) value Z"HOSTNAME".
   213 01  var-ptr pointer.
   214 01  env-var-len                 pic 9(4)  binary.
   215 01  rc                          pic 9(9)  binary.
   216 01  WS-KIXHOST                  PIC X(10).
   217 01  WS-KIXSYS.
   218     05  WS-KIX-FIL1             PIC X(10).
   219     05  WS-KIX-APPS             PIC X(10).
   220     05  WS-KIX-ENV              PIC X(10).
   221     05  WS-KIX-MYENV            PIC X(10).
   222     05  WS-KIX-SYS              PIC X(10).
   223 01 srch-commarea.
   224*                                copy ELCADLTRSPI.
   225******************************************************************
   226*                   C H A N G E   L O G
   227*
   228* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   229*-----------------------------------------------------------------
   230*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   231* EFFECTIVE    NUMBER
   232*-----------------------------------------------------------------
   233* 060611    2011022800001  PEMA  NEW COPYBOOK
   234* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   235* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   236******************************************************************
   237****************************************
   238*  commarea for NaperSoft On Demand Admin services letters
   239*  (business logic input & output)
   240****************************************
   241     03  BL-INPUT.
   242         05  BL-DATA-SRCE        PIC X.
   243         05  BL-LETTER-ID        PIC XXXX.
   244         05  BL-CARRIER          PIC X.
   245         05  BL-GROUP            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   6
* EL689.cbl
   246         05  BL-STATE            PIC XX.
   247         05  BL-ACCOUNT          PIC X(10).
   248         05  BL-EFF-DT           PIC X(10).
   249         05  BL-CERT-NO          PIC X(11).
   250         05  BL-BATCH-NO         PIC X(6).
   251         05  BL-BATCH-SEQ        PIC 9(8).
   252         05  BL-RESP-NO          PIC X(10).
   253         05  BL-NO-OF-COPIES     PIC 99.
   254         05  BL-PROC-ID          PIC XXXX.
   255         05  BL-COMP-ID          PIC XXX.
   256         05  BL-PRINT-NOW-SW     PIC X.
   257         05  BL-ENC-CD           PIC XXX.
   258         05  BL-RESEND-DT        PIC X(10).
   259         05  BL-FOLLOW-UP-DT     PIC X(10).
   260         05  BL-ARCHIVE-NO       PIC 9(8).
   261         05  BL-FUNC             PIC X(8).
   262         05  BL-COMMENTS         PIC X(100).
   263         05  FILLER REDEFINES BL-COMMENTS.
   264             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   265             10  BL-LETTER-TO-ACCT PIC X.
   266             10  BL-LETTER-TO-BENE PIC X.
   267             10  BL-WRITE-ERARCH   PIC X.
   268                 88  ERARCH-QWS      VALUE 'Q'.
   269                 88  ERARCH-BATCH    VALUE 'B'.
   270                 88  ERARCH-TEMP     VALUE 'T'.
   271             10  BL-PROCESS-TYPE PIC X(07).
   272             10  BL-CERT-FORM-ID PIC X(05).
   273             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   274             10  BL-SOURCE-SCREEN PIC X(8).
   275             10  FILLER          PIC X(25).
   276     03  BL-OUTPUT.
   277         05  BL-STATUS                   PIC X.
   278             88  BL-OK                      VALUE "P".
   279             88  BL-FAIL                  VALUE "F".
   280         05  BL-MESSAGE          PIC X(50).
   281     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   282     03  FILLER                  PIC X(31).
   283 01  W-WORK-AREAS.
   284     12  FILLER                  PIC  X(18)
   285                                      VALUE 'PROGRAM WORK AREA:'.
   286
   287     12  W-ASKTIME-CTR           PIC S9(04)  COMP   VALUE +0.
   288     12  W-CWA-NDX               PIC S9(04)  COMP   VALUE +0.
   289     12  W-DISPLAY-NDX           PIC S9(04)  COMP   VALUE +0.
   290     12  W-FIRST-BAD-VARIABLE    PIC S9(04)  COMP   VALUE +0.
   291     12  W-NDX                   PIC S9(04)  COMP   VALUE +0.
   292     12  W-NDX2                  PIC S9(04)  COMP   VALUE +0.
   293     12  W-SEQ-CTR               PIC S9(04)  COMP   VALUE +0.
   294     12  W-TS-ITEM               PIC S9(04)  COMP   VALUE +0.
   295     12  W-TOTAL-LINE-LENGTH     PIC S9(04)  COMP   VALUE +0.
   296     12  W-WORK-NDX              PIC S9(04)  COMP   VALUE +0.
   297
   298     12  W-ADJUST-SHORT          PIC S9(03) VALUE +0   COMP-3.
   299     12  W-DIFFERENCE            PIC S9(07)V9(02)
   300                                            VALUE +0   COMP-3.
   301     12  W-INITIAL-COLUMN        PIC S9(03) VALUE +0   COMP-3.
   302     12  W-LAST-COLUMN           PIC S9(03) VALUE +70 COMP-3.
   303     12  W-LAST-SQUEEZED-SPACE   PIC S9(03) VALUE +0   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   7
* EL689.cbl
   304     12  W-LAST-TX-SPACE         PIC S9(03) VALUE +0   COMP-3.
   305     12  W-LAST-WC-SPACE         PIC S9(03) VALUE +0   COMP-3.
   306     12  W-LINE-COUNT            PIC S9(03) VALUE +0   COMP-3.
   307     12  W-LINE-INDENT-1         PIC  9(02) VALUE 0    COMP-3.
   308     12  W-LINE-INDENT-2         PIC  9(02) VALUE 0    COMP-3.
   309     12  W-LINE-INDENT-3         PIC  9(02) VALUE 0    COMP-3.
   310     12  W-LINE-INDENT-4         PIC  9(02) VALUE 0    COMP-3.
   311     12  W-LINE-INDENT-5         PIC  9(02) VALUE 0    COMP-3.
   312     12  W-MAX-LINES-PER-PAGE    PIC  9(02) VALUE 56   COMP-3.
   313     12  W-NEXT-INDENT           PIC  9(02) VALUE 0    COMP-3.
   314     12  W-PAGE                  PIC S9(02) VALUE +0   COMP-3.
   315     12  W-PAGE-LINE             PIC S9(03) VALUE +0   COMP-3.
   316     12  W-PARAGRAPH-INDENT      PIC  9(02) VALUE 0    COMP-3.
   317     12  W-ROLL-COUNTER          PIC S9(03) VALUE +0   COMP-3.
   318     12  W-START-COLUMN          PIC S9(03) VALUE +1   COMP-3.
   319     12  W-TEMP-CURRENT-LINE     PIC S9(03) VALUE +0   COMP-3.
   320     12  W-TOO-FAR               PIC S9(03) VALUE +71 COMP-3.
   321     12  W-TOP-MARGIN            PIC  9(02) VALUE 0    COMP-3.
   322     12  W-TOTAL-TX-LINES        PIC S9(03) VALUE +0   COMP-3.
   323     12  W-TS-GROUP-WORK         PIC  9(05) VALUE 0    COMP-3.
   324     12  W-WORK-INDENT           PIC  9(02) VALUE 0    COMP-3.
   325     12  W-WORK-AMOUNT           PIC S9(09)V9(02)
   326                                            VALUE +0   COMP-3.
   327
   328     12  W-DATA-SOURCE           PIC  9(01) VALUE 0.
   329     12  W-LABEL-SOURCE          PIC  9(01) value 0.
   330         88  W-LABEL-SOURCE-VALID           VALUE 1 THRU 7.
   331     12  W-LABEL-JOINT-NAME      PIC  X(30) VALUE SPACES.
   332     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   333     12  W-NUMB-LABEL-LINES      PIC  9(01) VALUE 0.
   334     12  W-PRINT-CONTROL         PIC  9(02) VALUE 0.
   335     12  W-SAVE-REVISION         PIC  9(03) value 0.
   336     12  W-DISPLAY-3             PIC  9(03) value 0.
   337     12  W-DISPLAY-8             PIC  9(08) value 0.
   338     12  W-DISPLAY-7             PIC  9(07) value 0.
   339     12  W-EDIT-2-5-S            PIC  Z9.9(05).
   340     12  W-EDIT-3-0              PIC  ZZ9.
   341     12  W-EDIT-7-2              PIC  $$,$$$,$$9.99.
   342     12  W-EDIT-7-2-NEGATIVE     PIC  $$,$$$,$$9.99-.
   343     12  W-EDIT-9-2              PIC  $$$$,$$$,$$9.99.
   344     12  W-EDIT-12-2             PIC  $$$$,$$$,$$$,$$9.99.
   345
   346     12  WS-ACCT-PKEY-MATCH-SW   PIC  X(01) VALUE SPACE.
   347         88  PRIOR-MATCH-ACCT-PKEY          VALUE 'Y'.
   348
   349     12  W-ARCH-SUPPRESS         PIC 99999999.
   350     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   351                                 PIC  X(08).
   352     12  W-COMP-WORK-AREA.
   353         16  W-CWA-CHAR OCCURS 10 TIMES
   354                                 PIC  X(01).
   355     12  W-INCOMING-ARCHIVE      PIC  X(08).
   356     12  W-INCOMING-ARCH-NO REDEFINES W-INCOMING-ARCHIVE
   357                                 PIC  9(08).
   358
   359     12  W-BATCH-BREAKDOWN.
   360         16  W-BATCH-CONTROL     PIC S9(08) COMP.
   361         16  W-BATCH-SEQ         PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   8
* EL689.cbl
   362     12  W-BEN-HOLD              PIC  X(02).
   363     12  W-BENEFIT-WORK          PIC  X(03).
   364     12  W-BEN-R REDEFINES W-BENEFIT-WORK.
   365         16  W-ELIM-DAYS         PIC  X(02).
   366         16  FILLER              PIC  X(01).
   367     12  W-CALL-PGM              PIC  X(08).
   368     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   369
   370     12  FILLER                  PIC  X(09) VALUE 'LINE CNTL'.
   371     12  W-LINE-CONTROL-RECORD.
   372         16  W-LC-LINE-WIDTH     PIC  9(02).
   373         16  FILLER              PIC  X(01).
   374         16  W-LC-PARAGRAPH-INDENT
   375                                 PIC  9(02).
   376         16  FILLER              PIC  X(01).
   377         16  W-LC-MAX-LINES-PER-PAGE
   378                                 PIC  9(02).
   379         16  FILLER              PIC  X(01).
   380         16  W-LC-LINE-ADJUST    PIC  9(02).
   381         16  FILLER              PIC  X(01).
   382         16  W-LC-LINE-INDENT-1  PIC  9(02).
   383         16  FILLER              PIC  X(01).
   384         16  W-LC-LINE-INDENT-2  PIC  9(02).
   385         16  FILLER              PIC  X(01).
   386         16  W-LC-LINE-INDENT-3  PIC  9(02).
   387         16  FILLER              PIC  X(01).
   388         16  W-LC-LINE-INDENT-4  PIC  9(02).
   389         16  FILLER              PIC  X(01).
   390         16  W-LC-LINE-INDENT-5  PIC  9(02).
   391         16  FILLER              PIC  X(01).
   392         16  W-LC-TOP-MARGIN     PIC  9(02).
   393         16  FILLER              PIC  X(01).
   394         16  W-LC-CASE-IND       PIC  X(01).
   395             88  W-LC-USE-BOTH-CASES        VALUE 'Y'.
   396         16  FILLER              PIC  X(01).
   397         16  W-LC-PAGE-IND       PIC  X(01).
   398             88  W-LC-CREATE-PAGES          VALUE 'Y'.
   399     12  W-DATE-WORK             PIC  9(07).
   400     12  W-DT-REDEF REDEFINES W-DATE-WORK.
   401         16  FILLER              PIC  X(02).
   402         16  W-DT-WORK           PIC  9(05).
   403
   404     12  W-DEEDIT-FIELD          PIC  X(15).
   405     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   406
   407     12  W-EDIT-DATE-1.
   408         16  W-ED1-MM            PIC  X(02).
   409         16  FILLER              PIC  X(01) VALUE '/'.
   410         16  W-ED1-DD            PIC  X(02).
   411         16  FILLER              PIC  X(01) VALUE '/'.
   412         16  W-ED1-YY            PIC  X(02).
   413
   414     12  W-EDIT-DATE-2.
   415         16  W-ED2-DD            PIC  X(02).
   416         16  FILLER              PIC  X(01) VALUE '/'.
   417         16  W-ED2-MM            PIC  X(02).
   418         16  FILLER              PIC  X(01) VALUE '/'.
   419         16  W-ED2-YY            PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   9
* EL689.cbl
   420
   421     12  W-EDIT-A-DATE.
   422         16  W-EDIT-A-MM                  PIC X(2).
   423         16  FILLER                       PIC X(1).
   424         16  W-EDIT-A-DD                  PIC X(2).
   425         16  FILLER                       PIC X(1).
   426         16  W-EDIT-A-CCYY.
   427             20  W-EDIT-A-CC              PIC X(2).
   428             20  W-EDIT-A-YY              PIC X(2).
   429
   430     12  W-LABEL-HOLD-AREA.
   431         16  W-LABEL-LINES OCCURS 6 TIMES.
   432             20  W-LABEL-ZIP.
   433                 24  W-LABEL-1ST-ZIP  PIC  X(05).
   434                 24  W-LABEL-DASH     PIC  X(01).
   435                 24  W-LABEL-2ND-ZIP  PIC  X(04).
   436             20  W-LAB-CAN-POSTAL-CODES REDEFINES W-LABEL-ZIP.
   437                 24  W-LAB-CAN-POSTAL-CD-1
   438                                      PIC  X(03).
   439                 24  W-LAB-CAN-DASH   PIC  X(01).
   440                 24  W-LAB-CAN-POSTAL-CD-2
   441                                      PIC  X(03).
   442                 24  W-LAB-CAN-FILLER PIC  X(03).
   443             20  FILLER               PIC  X(10).
   444             20  W-LAST-ZIP.
   445                 24  W-LAST-1ST-ZIP   PIC  X(05).
   446                 24  W-LABEL-DASH-LAST
   447                                      PIC  X(01).
   448                 24  W-LAST-2ND-ZIP   PIC  X(04).
   449             20  W-LAST-CAN-POSTAL-CODES REDEFINES W-LAST-ZIP.
   450                 24  W-LAST-CAN-POSTAL-CD-1
   451                                      PIC  X(03).
   452                 24  W-LAST-CAN-DASH  PIC  X(01).
   453                 24  W-LAST-CAN-POSTAL-CD-2
   454                                      PIC  X(03).
   455                 24  W-LAST-CAN-FILLER
   456                                      PIC  X(03).
   457
   458     12  W-LAST-CHAR             PIC  X(01).
   459         88  W-LAST-CHAR-PUNC    VALUE '-' '/'.
   460     12  W-LAST-SQ-CHAR          PIC  X(01).
   461
   462     12  W-LINE-NUM.
   463         16  W-LINE1             PIC  X(01).
   464         16  W-LINE23            PIC  9(02).
   465     12  W-LIN-NUM REDEFINES W-LINE-NUM
   466                                 PIC  9(03).
   467
   468     12  W-NAME-LAST             PIC  X(15).
   469     12  W-NAME-FIRST.
   470         16  W-NAME-FIRST-INIT   PIC  X(01).
   471         16  W-NAME-FIRST-REMAIN PIC  X(14).
   472     12  W-NAME-MIDDLE.
   473         16  FILLER              PIC  X(01).
   474         16  W-NAME-MIDDLE-2     PIC  X(01).
   475         16  FILLER              PIC  X(13).
   476
   477     12  W-PAGE-PRT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  10
* EL689.cbl
   478         16  FILLER              PIC  X(34) VALUE SPACES.
   479         16  W-PAGE-NUMBER       PIC  Z9.
   480         16  FILLER              PIC  X(01) VALUE '.'.
   481         16  FILLER              PIC  X(33) VALUE SPACES.
   482
   483     12  W-PHONE-IN              PIC  9(11) VALUE ZEROS.
   484     12  W-PHONE-IN-R   REDEFINES W-PHONE-IN.
   485         16  FILLER              PIC  9(01).
   486         16  W-PHI-AREA          PIC  9(03).
   487         16  W-PHI-PFX           PIC  9(03).
   488         16  W-PHI-SFX           PIC  9(04).
   489     12  W-PHONE-OUT.
   490         16  W-PO-AREA           PIC  X(03).
   491         16  FILLER              PIC  X(01) VALUE '-'.
   492         16  W-PO-PFX            PIC  X(03).
   493         16  FILLER              PIC  X(01) VALUE '-'.
   494         16  W-PO-SFX            PIC  X(04).
   495
   496     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   497     12  W-SAVE-BIN-NEXT-BUS-DT  PIC  X(02) VALUE SPACES.
   498     12  W-SAVE-NEXT-BUS-DT-EDIT-A PIC X(10)   VALUE SPACES.
   499     12  W-SAVE-CYCLE-DAY-OF-WEEK PIC S9   COMP-3 VALUE +0.
   500     12  W-SAVE-EDIT-A-DATE      PIC  X(10) VALUE SPACES.
   501     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
   502     12  W-SAVE-PLAN             PIC  X(02) VALUE SPACES.
   503
   504     12  W-SINGLE-LINE           PIC  X(70).
   505     12  W-SINGLE-LINE-BY REDEFINES W-SINGLE-LINE.
   506         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY NDX1 NDX2 NDXA
   507                                 PIC  X(01).
   508
   509     12  W-SQUEEZED-LINE.
   510         16  W-SQ-CHAR OCCURS 70 TIMES
   511                       INDEXED BY W-SQ-NDX
   512                                 PIC  X(01).
   513
   514     12  W-TIME-IN               PIC S9(07).
   515     12  W-TIME-OUT-R REDEFINES W-TIME-IN.
   516         16  FILLER              PIC  X(01).
   517         16  W-TIME-OUT          PIC  99V9(02).
   518         16  FILLER              PIC  X(02).
   519
   520     12  W-TS-NAME-TEXT.
   521         16  W-TS-ID-TEXT        PIC  X(04) VALUE '104A'.
   522         16  W-TS-ID-TIME
   523             REDEFINES W-TS-ID-TEXT
   524                                 PIC S9(07) COMP-3.
   525         16  W-TS-TERM-TEXT.
   526             20 W-TS-TERM-PREFIX PIC  X(02).
   527             20 FILLER           PIC  X(02).
   528     12  W-TS-NAME-SCREEN.
   529         16  FILLER              PIC  X(04) VALUE '689X'.
   530         16  W-TS-TERM-SCREEN    PIC  X(04).
   531
   532     12  W-WORK-LINE.
   533         16  W-WORK-CHAR OCCURS 70 TIMES
   534                       INDEXED BY W-WC-NDX
   535                                  W-WC-NDX2
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  11
* EL689.cbl
   536                                  W-WC-NDX3
   537                                 PIC  X(01).
   538
   539     12  W-WORK-ZIP-NUMERIC      PIC  9(09).
   540     12  W-WORK-ZIP REDEFINES W-WORK-ZIP-NUMERIC.
   541         16  W-WORK-ZIP5         PIC  X(05).
   542         16  W-WORK-ZIP4         PIC  X(04).
   543     12  W-CANADIAN-POSTAL-CODES REDEFINES W-WORK-ZIP-NUMERIC.
   544         16  W-CAN-POSTAL-CD-1.
   545             20  FILLER          PIC  X(01).
   546                 88 W-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   547             20  FILLER          PIC  X(02).
   548         16  W-CAN-POSTAL-CD-2   PIC  X(03).
   549         16  W-FILLER            PIC  X(03).
   550
   551**** Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   552*                   COPY ELCZREC.
   553******************************************************************
   554*                                                                *
   555*                                                                *
   556*                            ELCZREC.                            *
   557*                                                                *
   558*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   559*                                                                *
   560******************************************************************
   561*-----------------------------------------------------------------
   562*                   C H A N G E   L O G
   563*
   564* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   565*-----------------------------------------------------------------
   566*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   567* EFFECTIVE    NUMBER
   568*-----------------------------------------------------------------
   569* 122011    2011022800001  AJRA  NEW FILE
   570* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   571* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   572* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   573* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   574*-----------------------------------------------------------------
   575 01  W-Z-CONTROL-DATA.
   576     05  W-NUMBER-OF-COPIES      PIC  9.
   577     05  FILLER                  PIC  X.
   578     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   579     05  FILLER                  PIC  X.
   580     05  W-DAYS-TO-RESEND        PIC  999.
   581     05  FILLER                  PIC  X.
   582     05  W-FORM-TO-RESEND        PIC  X(4).
   583     05  W-ADD-BAR-CODE          PIC  X.
   584     05  W-PROMPT-LETTER         PIC  X.
   585     05  W-HAS-RETURN-ENV        PIC  X.
   586     05  W-ENCLOSURE-CD          PIC  XXX.
   587     05  W-SIG-FLAG-DEFAULT      PIC  X.
   588     05  W-AUTO-CLOSE-IND        PIC  X.
   589     05  FILLER                  PIC  X.
   590     05  W-LETTER-TO-BENE        PIC  X.
   591     05  FILLER                  PIC  X.
   592     05  W-LETTER-TO-ACCT        PIC  X.
   593     05  FILLER                  PIC  X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  12
* EL689.cbl
   594     05  W-LETTER-TYPE           PIC  X.
   595     05  FILLER                  PIC  X.
   596     05  W-PRINT-CERTIFICATE     PIC  X.
   597     05  FILLER                  PIC  X.
   598     05  W-REFUND-REQUIRED       PIC  X.
   599     05  FILLER                  PIC  X.
   600     05  W-ONBASE-CODE           PIC  XX.
   601     05  FILLER                  PIC  X.
   602     05  W-ACCT-SUMM             PIC  X.
   603     05  FILLER                  PIC  X.
   604     05  W-CSO-SUMM              PIC  X.
   605     05  FILLER                  PIC  X.
   606     05  W-REASONS-REQUIRED      PIC  X.
   607     05  FILLER                  PIC  X(29).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  13
* EL689.cbl
   609 01  W-SWITCH-INDICATORS-AREA.
   610     12  FILLER                  PIC  X(16)
   611                                      VALUE 'PROGRAM SWITCHS:'.
   612     12  W-ADDRESS-ONLY-SW       PIC  X(01) VALUE ' '.
   613         88  W-ADDRESS-ONLY      VALUE 'Y'.
   614         88  W-FULL-DATA         VALUE ' '.
   615     12  W-ACCT-BROWSE-STARTED-SW
   616                                 PIC  X(01) VALUE 'N'.
   617         88  W-ACCT-BROWSE-STARTED          VALUE 'Y'.
   618     12  W-ARCT-BROWSE-STARTED   PIC  X(01) VALUE 'N'.
   619     12  W-CERT-FOUND-SW         PIC  X(01) VALUE 'N'.
   620         88  W-CERT-FOUND                   VALUE 'Y'.
   621     12  W-CHARACTER-TYPE        PIC  X(01).
   622         88  W-END-OF-SENTENCE   VALUE '.' '?' '!'.
   623         88  W-PUNCTUATION       VALUE '.' '?' '!' ',' ';'.
   624         88  W-SPACE             VALUE ' '.
   625     12  W-COMP-BROWSE-SW        PIC  X(01) VALUE 'N'.
   626         88  W-COMP-BROWSE-STARTED          VALUE 'Y'.
   627     12  W-DATA-SHRINK-IND       PIC  X(01) VALUE SPACES.
   628         88  W-DATA-SHRINKING    VALUE 'Y'.
   629     12  W-END-OF-SENTENCE-IND   PIC  X(01) VALUE SPACES.
   630         88  W-END-OF-SENTENCE-WORKING      VALUE 'Y'.
   631     12  W-FIRST-BAD-VARIABLE-IND
   632                                 PIC  X(01) VALUE SPACES.
   633         88  W-FIRST-BAD-VARIABLE-FOUND     VALUE 'Y'.
   634     12  W-FIRST-CHAR-FOUND-IND  PIC  X(01) VALUE SPACES.
   635         88  W-FIRST-CHAR-FOUND             VALUE 'Y'.
   636         88  W-FIRST-CHAR-NOT-FOUND         VALUE SPACES.
   637     12  W-FORM-CHANGED-IND      PIC  X(01) VALUE SPACES.
   638         88  W-FORM-CHANGED                 VALUE 'Y'.
   639     12  W-FORM-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   640         88  W-FORM-SQUEEZE-ON              VALUE 'Y'.
   641         88  W-FORM-SQUEEZE-OFF             VALUE ' '.
   642     12  W-HOLD-IND              PIC  X(01) VALUE SPACES.
   643         88  W-HOLD-ON                      VALUE 'Y'.
   644         88  W-HOLD-OFF                     VALUE ' '.
   645     12  W-INDIVIDUAL-DATA-SW    PIC  X(01) VALUE ' '.
   646         88  W-INDIVIDUAL-DATA-COMPLETED    VALUE 'Y'.
   647         88  W-INDIV-DATA-NOT-COMPLETED     VALUE ' '.
   648     12  W-KEY-FIELDS-CHANGED-IND
   649                                 PIC  X(01) VALUE ' '.
   650         88  W-KEY-FIELDS-CHANGED           VALUE 'Y'.
   651         88  W-KEY-FIELDS-NOT-CHANGED       VALUE ' '.
   652     12  W-LAST-ONE              PIC  X(01) VALUE HIGH-VALUES.
   653         88  W-LAST-ONE-A-SPACE  VALUE ' '.
   654     12  W-LINE-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   655         88  W-NEW-PARAGRAPH                VALUE 'P' 'Q' 'R' 'S'
   656                                                   'T' 'U'.
   657         88  W-CONTINUE-PARAGRAPH           VALUE 'C' 'D' 'E' 'F'
   658                                                   'G' 'H'.
   659         88  W-FORM-CONTROL-LINE            VALUE 'K'.
   660         88  W-DO-NOT-ADJUST                VALUE 'N'.
   661         88  W-ADJUST-TO-LINE-LENGTH        VALUE 'A'.
   662         88  W-AS-IS                        VALUE 'A' 'N'.
   663         88  W-CONTINUE-PREVIOUS-PROCESS    VALUE ' ' '1' '2' '3'
   664                                                   '4' '5'.
   665
   666     12  W-PNDB-FOUND-SW         PIC  X(01) VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  14
* EL689.cbl
   667         88  W-PNDB-FOUND                   VALUE 'Y'.
   668     12  W-REMAINING-VAR-SW      PIC  X(01) VALUE SPACES.
   669         88  W-REMAINING-VAR-FOUND          VALUE 'Y'.
   670     12  W-REVERSE-DATE-SW       PIC  X(01) VALUE SPACES.
   671         88  W-REVERSE-DATE                 VALUE 'Y'.
   672     12  W-TEXT-BROWSED-SW       PIC  X(01) VALUE 'N'.
   673         88  W-TEXT-BROWSE-STARTED          VALUE 'Y'.
   674         88  W-TEXT-BROWSE-NOT-STARTED      VALUE 'N'.
   675
   676     12  W-VALID-ENDT-SW         PIC  X(01) VALUE 'N'.
   677         88  W-VALID-ENDT                   VALUE 'Y'.
   678     12  W-RESPONSE              PIC S9(8)   COMP.
   679         88  RESP-NORMAL                  VALUE +00.
   680         88  RESP-NOTFND                  VALUE +13.
   681         88  RESP-DUPREC                  VALUE +14.
   682         88  RESP-DUPKEY                  VALUE +15.
   683         88  RESP-NOTOPEN                 VALUE +19.
   684         88  RESP-ENDFILE                 VALUE +20.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  15
* EL689.cbl
   686 01  WS-SAVE-AREA.
   687     12  WS-SAV-AM-DEFN-1.
   688         16  WS-SAV-AM-AGT-COMMS OCCURS 10 TIMES.
   689             20  WS-SAV-AM-AGT             PIC  X(10).
   690             20  WS-SAV-AM-COM-TYP         PIC  X(01).
   691             20  FILLER                    PIC  X(15).
   692     12  WS-SAV-AM-REMIT-TO                PIC  9(02).
   693     12  WS-SAV-AM-CSR-CODE                PIC  X(04).
   694     12  WS-SAV-AM-CARRIER                 PIC  X(01).
   695     12  WS-SAV-AM-ACCOUNT                 PIC  X(10).
   696     12  WS-SAV-AM-CONTROL-NAME            PIC  X(30).
   697     12  WS-SAV-AM-NAME                    PIC  X(30).
   698     12  WS-SAV-AM-PERSON                  PIC  X(30).
   699     12  WS-SAV-AM-ADDRS                   PIC  X(30).
   700     12  WS-SAV-AM-CITY                    PIC  X(30).
   701     12  WS-SAV-AM-ERACCT-ACCOUNT          PIC  X(10).
   702     12  WS-SAV-AM-ZIP.
   703         16  WS-SAV-AM-ZIP-PRIME.
   704             20  WS-SAV-AM-ZIP-PRI-1ST     PIC  X(01).
   705                 88  SAVE-AM-CANADIAN-POST-CODE       VALUE
   706                     'A' THRU 'Z'.
   707             20  FILLER                    PIC  X(04).
   708         16  FILLER                        PIC  X(04).
   709     12  WS-SAV-AM-CANADIAN-POSTAL-CODE REDEFINES
   710                        WS-SAV-AM-ZIP      PIC  X(09).
   711     12  WS-SAV-AM-TEL-NO.
   712         16  WS-SAV-AM-AREA-CODE           PIC 9(03).
   713         16  WS-SAV-AM-TEL-PRE             PIC 9(03).
   714         16  WS-SAV-AM-TEL-NBR             PIC 9(04).
   715 01  W-KEY-AREAS.
   716     12  FILLER                    PIC  X(13)
   717                                      VALUE 'PROGRAM KEYS:'.
   718
   719     12  W-ACCT-SAVE-KEY           PIC  X(20).
   720     12  W-ACCT-KEY.
   721         16  W-ACCT-PARTIAL-KEY.
   722             20  W-ACCT-COMPANY-CD PIC  X(01).
   723             20  W-ACCT-CARRIER    PIC  X(01).
   724             20  W-ACCT-GROUPING   PIC  X(06).
   725             20  W-ACCT-STATE      PIC  X(02).
   726             20  W-ACCT-ACCOUNT    PIC  X(10).
   727         16  W-ACCT-EXP-DT         PIC  X(02).
   728
   729     12  W-ARCH-SAVE-KEY         PIC  X(05).
   730     12  W-ARCH-KEY.
   731         16  W-ARCH-PARTIAL-KEY.
   732             20  W-ARCH-COMPANY-CD
   733                                 PIC  X(01).
   734             20  W-ARCH-NUMBER   PIC S9(08)      COMP.
   735         16  W-ARCH-SEQ-NO       PIC S9(04)      COMP VALUE +0.
   736
   737     12  W-ARCT-KEY.
   738         16  W-ARCT-PARTIAL-KEY.
   739             20  W-ARCT-COMPANY-CD
   740                                 PIC  X(01).
   741             20  W-ARCT-NUMBER   PIC S9(08)      COMP.
   742         16  W-ARCT-REC-TYPE     PIC  X(01).
   743         16  W-ARCT-SEQ-NO       PIC S9(04)      COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  16
* EL689.cbl
   744
   745     12  W-CERT-KEY.
   746         16  W-CERT-COMPANY-CD   PIC  X(01).
   747         16  W-CERT-CARRIER      PIC  X(01).
   748         16  W-CERT-GROUPING     PIC  X(06).
   749         16  W-CERT-STATE        PIC  X(02).
   750         16  W-CERT-ACCOUNT      PIC  X(10).
   751         16  W-CERT-EFF-DT       PIC  X(02).
   752         16  W-CERT-CERT-NO.
   753             20  W-CERT-CERT-PRIME
   754                                 PIC  X(10).
   755             20  W-CERT-CERT-SFX PIC  X(01).
   756
   757     12  W-CHEK-KEY.
   758         16  W-CHEK-COMPANY-CD   PIC  X(01).
   759         16  W-CHEK-CARRIER      PIC  X(01).
   760         16  W-CHEK-GROUPING     PIC  X(06).
   761         16  W-CHEK-STATE        PIC  X(02).
   762         16  W-CHEK-ACCOUNT      PIC  X(10).
   763         16  W-CHEK-EFF-DT       PIC  X(02).
   764         16  W-CHEK-CERT-NO.
   765             20  W-CHEK-CERT-PRIME
   766                                 PIC  X(10).
   767             20  W-CHEK-CERT-SFX PIC  X(01).
   768         16  W-CHEK-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   769
   770     12  W-CNTL-KEY.
   771         16  W-CNTL-COMPANY-ID   PIC  X(03).
   772         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   773         16  W-CNTL-GENL.
   774             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   775             20  W-CNTL-GEN2.
   776                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   777                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   778         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   779
   780     12  W-COMP-SAVE-KEY         PIC  X(29).
   781     12  W-COMP-KEY.
   782         16  W-COMP-COMPANY-CD   PIC  X(01).
   783         16  W-COMP-CARRIER      PIC  X(01).
   784         16  W-COMP-GROUPING     PIC  X(06).
   785         16  W-COMP-RESP-PERSON.
   786             20  W-COMP-RP-CHAR OCCURS 10 TIMES
   787                                INDEXED BY W-COMP-NDX
   788                                 PIC  X(01).
   789         16  W-COMP-ACCOUNT      PIC  X(10).
   790         16  W-COMP-TYPE         PIC  X(01).
   791
   792     12  W-DELETE-KEY.
   793         16  W-DELETE-PARTIAL-KEY.
   794             20  W-DELETE-COMPANY-CD
   795                                 PIC  X(01).
   796             20  W-DELETE-NUMBER PIC S9(08)      COMP.
   797         16  W-DELETE-RECORD-TYPE
   798                                 PIC  X(01).
   799         16  W-DELETE-SEQ        PIC S9(04)      COMP VALUE +0.
   800
   801     12  W-MAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  17
* EL689.cbl
   802         16  W-MAIL-COMPANY-CD   PIC  X(01).
   803         16  W-MAIL-CARRIER      PIC  X(01).
   804         16  W-MAIL-GROUPING     PIC  X(06).
   805         16  W-MAIL-STATE        PIC  X(02).
   806         16  W-MAIL-ACCOUNT      PIC  X(10).
   807         16  W-MAIL-EFF-DT       PIC  X(02).
   808         16  W-MAIL-CERT-NO.
   809             20  W-MAIL-CERT-PRIME
   810                                 PIC  X(10).
   811             20  W-MAIL-CERT-SFX PIC  X(01).
   812
   813     12  W-PNDB-KEY.
   814         16  W-PNDB-COMPANY-CD   PIC  X(01).
   815         16  W-PNDB-ENTRY        PIC  X(06).
   816         16  W-PNDB-SEQ-NO       PIC S9(04)  COMP.
   817         16  W-PNDB-CHG-SEQ-NO   PIC S9(04)  COMP.
   818
   819     12  W-PNDB2-KEY.
   820         16  W-PNDB2-COMPANY-CD  PIC  X(01).
   821         16  W-PNDB2-CARRIER     PIC  X(01).
   822         16  W-PNDB2-GROUPING    PIC  X(06).
   823         16  W-PNDB2-STATE       PIC  X(02).
   824         16  W-PNDB2-ACCOUNT     PIC  X(10).
   825         16  W-PNDB2-EFF-DT      PIC  X(02).
   826         16  W-PNDB2-CERT-NO.
   827             20  W-PNDB2-CERT-PRIME
   828                                 PIC  X(10).
   829             20  W-PNDB2-CERT-SFX
   830                                 PIC  X(01).
   831         16  W-PNDB2-ALT-CHG-SEQ-NO
   832                                 PIC S9(04)  COMP.
   833         16  W-PNDB2-TYPE        PIC  X(01).
   834
   835     12  W-PYAJ-KEY.
   836         16  W-PYAJ-COMPANY-CD   PIC  X(01).
   837         16  W-PYAJ-CARRIER      PIC  X(01).
   838         16  W-PYAJ-GROUPING     PIC  X(06).
   839         16  W-PYAJ-FIN-RESP     PIC  X(10).
   840         16  W-PYAJ-ACCOUNT      PIC  X(10).
   841         16  W-PYAJ-FILE-SEQ-NO  PIC S9(08)    COMP.
   842         16  W-PYAJ-RECORD-TYPE  PIC  X(01).
   843
   844     12  W-SC-QUID-KEY.
   845         16  W-SC-QUID-TERMINAL  PIC  X(04).
   846         16  W-SC-QUID-SYSTEM    PIC  X(04).
   847
   848     12  W-TEXT-SAVE-KEY         PIC  X(05).
   849     12  W-TEXT-KEY.
   850         16  W-TEXT-PARTIAL-KEY.
   851             20  W-TEXT-COMPANY-CD
   852                                 PIC  X(01).
   853             20  W-TEXT-LETTER   PIC  X(04).
   854         16  W-TEXT-FILLER       PIC  X(08)   VALUE SPACES.
   855         16  W-TEXT-SEQ          PIC S9(04)   VALUE +0    COMP.
   856
   857     12  W-ERENDT-KEY-BY-ARCH.
   858         16  W-ERENDT-COMPANY-CD-A1 PIC X.
   859         16  W-ERENDT-ARCHIVE       PIC 9(8) BINARY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  18
* EL689.cbl
   860
   861     12  W-ELEOBC-KEY.
   862         16  W-EOBC-COMPANY-CD   PIC X.
   863         16  W-EOBC-REC-TYPE     PIC X.
   864         16  W-EOBC-CODE         PIC X(4).
   865         16  FILLER              PIC X(9).
   866     12  W-ERNOTE-KEY.
   867         16  W-NOTE-COMPANY-CD   PIC X.
   868         16  W-NOTE-CARRIER      PIC X.
   869         16  W-NOTE-GROUPING     PIC X(6).
   870         16  W-NOTE-STATE        PIC XX.
   871         16  W-NOTE-ACCOUNT      PIC X(10).
   872         16  W-NOTE-CERT-EFF-DT  PIC XX.
   873         16  W-NOTE-CERT-PRIME   PIC X(10).
   874         16  W-NOTE-CERT-SFX     PIC X.
   875     12  W-SAVE-KEY.
   876         16  W-SV-COMPANY-CD     PIC X.
   877         16  W-SV-CARRIER        PIC X.
   878         16  W-SV-GROUPING       PIC X(6).
   879         16  W-SV-STATE          PIC XX.
   880         16  W-SV-ACCOUNT        PIC X(10).
   881         16  W-SV-CERT-EFF-DT    PIC XX.
   882         16  W-SV-CERT-PRIME     PIC X(10).
   883         16  W-SV-CERT-SFX       PIC X.
   884     12  W-BILLING-NOTE.
   885         16  W-BN-NOTE           PIC X(25).
   886         16  W-BN-LTRID          PIC X(4).
   887         16  FILLER              PIC X(3).
   888         16  W-BN-DATE           PIC X(8).
   889         16  FILLER              PIC X(3).
   890         16  W-BN-USERID         PIC X(4).
   891         16  FILLER              PIC X(30).
   892     12  W-LEN                   PIC S9(5) COMP-3 VALUE +0.
   893     12  NOTE-SUB                PIC S9(5) COMP-3 VALUE +0.
   894     12  W-CERT-UPDATE-SW        PIC X  VALUE ' '.
   895         88  NO-CERT-RW                 VALUE 'N'.
   896         88  CERT-RW                    VALUE 'Y'.
   897
   898     12  W-ELENCC-KEY.
   899         16  W-ENCC-COMPANY-CD   PIC X.
   900         16  W-ENCC-REC-TYPE     PIC X.
   901         16  W-ENCC-ENC-CODE     PIC X(5).
   902         16  FILLER              PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  19
* EL689.cbl
   904 01  FILLER                      PIC  X(22)
   905                                 VALUE 'INTERFACE AREA STARTS:'.
   906*    COPY ELCINTF.
   907******************************************************************
   908*                                                                *
   909*                                                                *
   910*                            ELCINTF.                            *
   911*                            VMOD=2.017                          *
   912*                                                                *
   913*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   914*                                                                *
   915*       LENGTH = 1024                                            *
   916*                                                                *
   917******************************************************************
   918*                   C H A N G E   L O G
   919*
   920* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   921*-----------------------------------------------------------------
   922*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   923* EFFECTIVE    NUMBER
   924*-----------------------------------------------------------------
   925* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   926******************************************************************
   927 01  PROGRAM-INTERFACE-BLOCK.
   928     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   929     12  PI-CALLING-PROGRAM              PIC X(8).
   930     12  PI-SAVED-PROGRAM-1              PIC X(8).
   931     12  PI-SAVED-PROGRAM-2              PIC X(8).
   932     12  PI-SAVED-PROGRAM-3              PIC X(8).
   933     12  PI-SAVED-PROGRAM-4              PIC X(8).
   934     12  PI-SAVED-PROGRAM-5              PIC X(8).
   935     12  PI-SAVED-PROGRAM-6              PIC X(8).
   936     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   937     12  PI-COMPANY-ID                   PIC XXX.
   938     12  PI-COMPANY-CD                   PIC X.
   939
   940     12  PI-COMPANY-PASSWORD             PIC X(8).
   941
   942     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   943
   944     12  PI-CONTROL-IN-PROGRESS.
   945         16  PI-CARRIER                  PIC X.
   946         16  PI-GROUPING                 PIC X(6).
   947         16  PI-STATE                    PIC XX.
   948         16  PI-ACCOUNT                  PIC X(10).
   949         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   950                                         PIC X(10).
   951         16  PI-CLAIM-CERT-GRP.
   952             20  PI-CLAIM-NO             PIC X(7).
   953             20  PI-CERT-NO.
   954                 25  PI-CERT-PRIME       PIC X(10).
   955                 25  PI-CERT-SFX         PIC X.
   956             20  PI-CERT-EFF-DT          PIC XX.
   957         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   958             20  PI-PLAN-CODE            PIC X(2).
   959             20  PI-REVISION-NUMBER      PIC X(3).
   960             20  PI-PLAN-EFF-DT          PIC X(2).
   961             20  PI-PLAN-EXP-DT          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  20
* EL689.cbl
   962             20  FILLER                  PIC X(11).
   963         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   964             20  PI-OE-REFERENCE-1.
   965                 25  PI-OE-REF-1-PRIME   PIC X(18).
   966                 25  PI-OE-REF-1-SUFF    PIC XX.
   967
   968     12  PI-SESSION-IN-PROGRESS          PIC X.
   969         88  CLAIM-SESSION                   VALUE '1'.
   970         88  CREDIT-SESSION                  VALUE '2'.
   971         88  WARRANTY-SESSION                VALUE '3'.
   972         88  MORTGAGE-SESSION                VALUE '4'.
   973         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   974
   975
   976*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   977
   978     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   979     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   980
   981     12  PI-CREDIT-USER                  PIC X.
   982         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   983         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   984
   985     12  PI-CLAIM-USER                   PIC X.
   986         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   987         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   988
   989     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   990         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   991         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   992         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   993         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   994         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   995
   996     12  PI-PROCESSOR-ID                 PIC X(4).
   997
   998     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   999
  1000     12  PI-MEMBER-CAPTION               PIC X(10).
  1001
  1002     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1003         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1004
  1005     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1006     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1007     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1008     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1009
  1010     12  PI-AH-OVERRIDE-L1               PIC X.
  1011     12  PI-AH-OVERRIDE-L2               PIC XX.
  1012     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1013     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1014
  1015     12  PI-NEW-SYSTEM                   PIC X(2).
  1016
  1017     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1018     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1019         88  PI-USES-PAID-TO                 VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  21
* EL689.cbl
  1020     12  PI-CRDTCRD-SYSTEM.
  1021         16  PI-CRDTCRD-USER             PIC X.
  1022             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1023             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1024         16  PI-CC-MONTH-END-DT          PIC XX.
  1025     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1026
  1027     12  PI-OE-REFERENCE-2.
  1028         16  PI-OE-REF-2-PRIME           PIC X(10).
  1029         16  PI-OE-REF-2-SUFF            PIC X.
  1030
  1031     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1032
  1033     12  PI-LANGUAGE-TYPE                PIC X.
  1034             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1035             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1036             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1037
  1038     12  PI-POLICY-LINKAGE-IND           PIC X.
  1039         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1040         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1041                                                   LOW-VALUES.
  1042
  1043     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1044     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1045         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1046         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1047
  1048     12  PI-PROCESSOR-CSR-IND            PIC X.
  1049         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1050         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1051
  1052     12  FILLER                          PIC X(3).
  1053
  1054     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1055
  1056     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1057         PI-SYSTEM-LEVEL.
  1058
  1059         16  PI-ENTRY-CODES.
  1060             20  PI-ENTRY-CD-1           PIC X.
  1061             20  PI-ENTRY-CD-2           PIC X.
  1062
  1063         16  PI-RETURN-CODES.
  1064             20  PI-RETURN-CD-1          PIC X.
  1065             20  PI-RETURN-CD-2          PIC X.
  1066
  1067         16  PI-UPDATE-STATUS-SAVE.
  1068             20  PI-UPDATE-BY            PIC X(4).
  1069             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1070
  1071         16  PI-LOWER-CASE-LETTERS       PIC X.
  1072             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1073
  1074*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1075*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1076*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1077
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  22
* EL689.cbl
  1078         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1079             88  ST-ACCNT-CNTL               VALUE ' '.
  1080             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1081             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1082             88  ACCNT-CNTL                  VALUE '3'.
  1083             88  CARR-ACCNT-CNTL             VALUE '4'.
  1084
  1085         16  PI-PROCESSOR-CAP-LIST.
  1086             20  PI-SYSTEM-CONTROLS.
  1087                24 PI-SYSTEM-DISPLAY     PIC X.
  1088                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1089                24 PI-SYSTEM-MODIFY      PIC X.
  1090                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1091             20  FILLER                  PIC XX.
  1092             20  PI-DISPLAY-CAP          PIC X.
  1093                 88  DISPLAY-CAP             VALUE 'Y'.
  1094             20  PI-MODIFY-CAP           PIC X.
  1095                 88  MODIFY-CAP              VALUE 'Y'.
  1096             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1097                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1098             20  PI-FORCE-CAP            PIC X.
  1099                 88  FORCE-CAP               VALUE 'Y'.
  1100
  1101         16  PI-PROGRAM-CONTROLS.
  1102             20  PI-PGM-PRINT-OPT        PIC X.
  1103             20  PI-PGM-FORMAT-OPT       PIC X.
  1104             20  PI-PGM-PROCESS-OPT      PIC X.
  1105             20  PI-PGM-TOTALS-OPT       PIC X.
  1106
  1107         16  PI-HELP-INTERFACE.
  1108             20  PI-LAST-ERROR-NO        PIC X(4).
  1109             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1110
  1111         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1112             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1113
  1114         16  PI-CR-CONTROL-IN-PROGRESS.
  1115             20  PI-CR-CARRIER           PIC X.
  1116             20  PI-CR-GROUPING          PIC X(6).
  1117             20  PI-CR-STATE             PIC XX.
  1118             20  PI-CR-ACCOUNT           PIC X(10).
  1119             20  PI-CR-FIN-RESP          PIC X(10).
  1120             20  PI-CR-TYPE              PIC X.
  1121
  1122         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1123
  1124         16  PI-CR-MONTH-END-DT          PIC XX.
  1125
  1126         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1127             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1128             88  PI-ZERO-CARRIER             VALUE '1'.
  1129             88  PI-ZERO-GROUPING            VALUE '2'.
  1130             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1131
  1132         16  PI-CARRIER-SECURITY         PIC X.
  1133             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1134
  1135         16  PI-ACCOUNT-SECURITY         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  23
* EL689.cbl
  1136             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1137             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1138
  1139         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1140             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1141                                         INDEXED BY PI-ACCESS-NDX
  1142                                         PIC X.
  1143
  1144         16  PI-GA-BILLING-CONTROL       PIC X.
  1145             88  PI-GA-BILLING               VALUE '1'.
  1146
  1147         16  PI-MAIL-PROCESSING          PIC X.
  1148             88  PI-MAIL-YES                 VALUE 'Y'.
  1149
  1150         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1151
  1152         16  PI-AR-SYSTEM.
  1153             20  PI-AR-PROCESSING-CNTL   PIC X.
  1154                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1155             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1156             20  PI-AR-MONTH-END-DT      PIC XX.
  1157
  1158         16  PI-MP-SYSTEM.
  1159             20  PI-MORTGAGE-USER            PIC X.
  1160                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1161                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1162             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1163                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1164                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1165                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1166                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1167                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1168             20  PI-MP-MONTH-END-DT          PIC XX.
  1169             20  PI-MP-REFERENCE-NO.
  1170                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1171                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1172
  1173         16  PI-LABEL-CONTROL            PIC X(01).
  1174             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1175             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1176
  1177         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1178             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1179
  1180         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1181             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1182             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1183
  1184         16  FILLER                      PIC X(14).
  1185
  1186     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1187******************************************************************
  1188     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1189*    COPY ELC1042.
  1190******************************************************************
  1191*                                                                *
  1192*                                                                *
  1193*                           ELC1042                              *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  24
* EL689.cbl
  1194*                            VMOD=2.002                          *
  1195*                                                                *
  1196*    NOTE                                                        *
  1197*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1198*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1199*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1200*        TO THESE PROGRAMS.                                      *
  1201*                                                                *
  1202*    NOTE                                                        *
  1203*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1204*        USE ONLY!                                               *
  1205*                                                                *
  1206******************************************************************
  1207
  1208         16  PI-1042-WA.
  1209             20  PI-ACTION       PIC  X(01).
  1210                 88 PI-SHOW-MODE           VALUE '1'.
  1211                 88 PI-CLEAR-MODE          VALUE '2'.
  1212                 88 PI-CREATE-MODE         VALUE '3'.
  1213             20  PI-COMM-CONTROL PIC  X(12).
  1214             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1215             20  PI-EOF-SW       PIC  X(01).
  1216                 88  PI-FILE-EOF           VALUE 'Y'.
  1217             20  PI-FILETYP      PIC  X(01).
  1218             20  PI-FORM-SQUEEZE-CONTROL
  1219                                 PIC  X(01).
  1220                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1221                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1222             20  PI-LAST-CONTROL PIC  X(12).
  1223             20  PI-TEMP-STOR-ITEMS
  1224                                 PIC S9(04) COMP.
  1225             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1226             20  PI-UPDATE-SW    PIC  9(01).
  1227                 88 ANY-UPDATES            VALUE 1.
  1228             20  PI-104-SCREEN-SENT-IND
  1229                                 PIC  X(01).
  1230                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1231                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1232             20  PI-1042-SCREEN-SENT-IND
  1233                                 PIC  X(01).
  1234                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1235                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1236             20  PI-1042-ARCHIVE-IND
  1237                                 PIC  X(01).
  1238                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1239             20  FILLER          PIC  X(29).
  1240*    COPY ELC689PI.
  1241******************************************************************
  1242*                                                                *
  1243*                            ELC689PI                            *
  1244*                            VMOD=2.003                          *
  1245*                                                                *
  1246*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  1247*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  1248*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  1249*                                                                *
  1250*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  1251*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  25
* EL689.cbl
  1252*    BETWEEN PROGRAMS.                                           *
  1253*                                                                *
  1254*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1255*                                                                *
  1256*               EL631 - EL689  - EL6891 - EL6892                 *
  1257*                                                                *
  1258******************************************************************
  1259*                   C H A N G E   L O G
  1260*
  1261* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1262*-----------------------------------------------------------------
  1263*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1264* EFFECTIVE    NUMBER
  1265*-----------------------------------------------------------------
  1266* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  1267* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  1268* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1269******************************************************************
  1270
  1271
  1272         16  PI-689-WORK-AREA.
  1273             20  PI-689-ALT-PRINTER-ID
  1274                                 PIC  X(04).
  1275             20  PI-689-ARCHIVE-NUMBER
  1276                                 PIC  9(08).
  1277             20  PI-689-ARCHIVE-SW
  1278                                 PIC  X(01).
  1279                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  1280             20  PI-689-DATA-SOURCE
  1281                                 PIC  X(01).
  1282                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  1283                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  1284                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  1285                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  1286                 88  PI-689-SRC-CHECKS         VALUE '5'.
  1287             20  PI-689-ERROR-IND
  1288                                 PIC  X(01).
  1289                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  1290             20  PI-689-ERROR    PIC  9(04).
  1291                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  1292                 88  PI-689-FATAL-ERROR
  1293                     VALUES 0004 0006 0008 0013 0023 0029 0033
  1294                            0042 0047 0051 0066 0067 0070
  1295                            0168 0169 0174 0175 0176 0177 0179
  1296                            0180 0181 0182 0184 0185 0189 0190
  1297                            0191
  1298                            0215 0279 0280
  1299                            0412 0413 0454
  1300                            0533 0537
  1301                            2055 2114 2208 2209 2216 2232 2369
  1302                            2398 2433 2908 2999
  1303                            3000 3770 3771 3775
  1304                            7250 7365 7367 7368 7369 7370 7371
  1305                            7272 7373 7374 7376 7377 7378 7379
  1306                            7381 7388 7390 7393 7395 7396 7398
  1307                            9095 9096 9281 9298 9299 9320 9327
  1308                            9426 9427.
  1309                 88  PI-689-STOP-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  26
* EL689.cbl
  1310                     VALUES 0004 0008 0013 0023 0029 0033
  1311                            0042 0047 0066 0067 0070
  1312                            0168 0169 0174 0175 0176 0177
  1313                            0181 0182 0184 0185 0189 0190
  1314                            0279 0280
  1315                            0412 0413 0454
  1316                            2055 2208 2209 2216 2232
  1317                            2398 2999
  1318                            3000 3770 3771 3775
  1319                            7250 7365 7369 7370 7371
  1320                            7272 7373 7374 7376 7377 7378 7379
  1321                            7381 7388 7390 7393 7396 7398
  1322                            9095 9096 9299 9320 9426.
  1323             20  PI-689-FOLLOW-UP-DATE
  1324                                 PIC  X(02).
  1325             20  PI-689-FORM-NUMBER
  1326                                 PIC  X(04).
  1327             20  PI-689-LABEL-SOURCE
  1328                                 PIC X(01).
  1329                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1330                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1331                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1332                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1333                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1334                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1335                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1336             20  PI-689-NUMBER-COPIES
  1337                                 PIC  9(01).
  1338             20  PI-689-NUMBER-LABEL-LINES
  1339                                 PIC  9(01).
  1340             20  PI-689-NUMBER-TEXT-RECORDS
  1341                                 PIC  9(03).
  1342             20  PI-689-PRINT-ORDER-SW
  1343                                 PIC  X(01).
  1344                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1345                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1346                 88  PI-689-PRINT-LATER     VALUE '3'.
  1347                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1348             20  PI-689-PRINT-RESTRICTION
  1349                                 PIC  X(01).
  1350                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1351                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1352                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1353             20  PI-689-PRINT-SW PIC  X(01).
  1354                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1355             20  PI-689-RESEND-DATE-1
  1356                                 PIC  X(02).
  1357             20  PI-689-RESEND-LETR-1
  1358                                 PIC X(4).
  1359             20  PI-689-TEMP-STOR-ID
  1360                                 PIC  X(08).
  1361             20  PI-689-USE-SCREEN-IND
  1362                                 PIC  X(01).
  1363                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1364             20  PI-689-ARCH-POINTER
  1365                                 PIC S9(08) COMP.
  1366                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  1367             20  PI-689-ARCT-POINTER
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  27
* EL689.cbl
  1368                                 PIC S9(08) COMP.
  1369                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1370             20  PI-689-VARIABLE-DATA-GRP.
  1371                 24  PI-689-VARIABLE-DATA-1
  1372                                 PIC  X(30).
  1373                 24  PI-689-VARIABLE-DATA-2
  1374                                 PIC  X(30).
  1375                 24  PI-689-VARIABLE-DATA-3
  1376                                 PIC  X(30).
  1377                 24  PI-689-VARIABLE-DATA-4
  1378                                 PIC  X(30).
  1379
  1380         16  PI-689-KEY-DATA-FIELDS.
  1381             20  PI-689-ACCOUNT  PIC  X(10).
  1382             20  PI-689-CARRIER  PIC  X(01).
  1383             20  PI-689-CERT-NO.
  1384                 24  PI-689-CERT-PRIME
  1385                                 PIC  X(10).
  1386                 24  PI-689-CERT-SFX
  1387                                 PIC  X(01).
  1388             20  PI-689-CHG-SEQ-NO
  1389                                 PIC S9(04)    COMP.
  1390             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1391                                 PIC  X(02).
  1392             20  PI-689-ENTRY-BATCH
  1393                                 PIC  X(06).
  1394             20  PI-689-EFF-DATE PIC  X(02).
  1395             20  PI-689-EXP-DATE PIC  X(02).
  1396             20  PI-689-GROUPING PIC  X(06).
  1397             20  PI-689-RESP-PERSON
  1398                                 PIC  X(10).
  1399             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1400             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1401                                 PIC  X(04).
  1402             20  PI-689-STATE    PIC  X(02).
  1403             20  PI-689-TYPE     PIC  X(01).
  1404             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1405             20  PI-689-ALT-SEQ-NO
  1406                                 PIC S9(04)    COMP.
  1407         16  PI-689-DATE-EDIT    PIC  X(08).
  1408         16  PI-689-FOLLOW-UP-EDIT
  1409                                 PIC  X(08).
  1410         16  PI-689-RESEND1-EDIT PIC  X(08).
  1411         16  PI-689-SEQ-EDIT     PIC  X(08).
  1412         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1413         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1414             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1415         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1416         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1417         16  PI-PROMPT-IND       PIC X(1).
  1418         16  PI-CERT-FORM-ID     PIC X(5).
  1419         16  PI-PRINT-NOW        PIC X(1).
  1420         16  PI-ENCLOSURE-CD     PIC X(3).
  1421         16  PI-CERT-REQ-IND     PIC X(1).
  1422         16  PI-ENDT-ARCH-NO     PIC 9(8).
  1423         16  PI-REASON-REQ-IND   PIC X(1).
  1424         16  FILLER              PIC X(244).
  1425*        16  FILLER                        PIC X(276).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  28
* EL689.cbl
  1426*        16  FILLER                        PIC X(280).
  1427
  1428 01  FILLER                      PIC  X(20)
  1429                                 VALUE ':INTERFACE AREA ENDS'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  29
* EL689.cbl
  1431 01  FILLER                      PIC  X(16)
  1432                        VALUE 'MAP AREA STARTS:'.
  1433*    COPY EL689S.
  1434 01  EL689AI.
  1435     05  FILLER            PIC  X(0012).
  1436*    -------------------------------
  1437     05  RUNDTEL PIC S9(0004) COMP.
  1438     05  RUNDTEF PIC  X(0001).
  1439     05  FILLER REDEFINES RUNDTEF.
  1440         10  RUNDTEA PIC  X(0001).
  1441     05  RUNDTEI PIC  X(0008).
  1442*    -------------------------------
  1443     05  RUNTIMEL PIC S9(0004) COMP.
  1444     05  RUNTIMEF PIC  X(0001).
  1445     05  FILLER REDEFINES RUNTIMEF.
  1446         10  RUNTIMEA PIC  X(0001).
  1447     05  RUNTIMEI PIC  X(0005).
  1448*    -------------------------------
  1449     05  HOSTL PIC S9(0004) COMP.
  1450     05  HOSTF PIC  X(0001).
  1451     05  FILLER REDEFINES HOSTF.
  1452         10  HOSTA PIC  X(0001).
  1453     05  HOSTI PIC  X(0010).
  1454*    -------------------------------
  1455     05  SYSL PIC S9(0004) COMP.
  1456     05  SYSF PIC  X(0001).
  1457     05  FILLER REDEFINES SYSF.
  1458         10  SYSA PIC  X(0001).
  1459     05  SYSI PIC  X(0008).
  1460*    -------------------------------
  1461     05  COMPANYL PIC S9(0004) COMP.
  1462     05  COMPANYF PIC  X(0001).
  1463     05  FILLER REDEFINES COMPANYF.
  1464         10  COMPANYA PIC  X(0001).
  1465     05  COMPANYI PIC  X(0003).
  1466*    -------------------------------
  1467     05  USERIDL PIC S9(0004) COMP.
  1468     05  USERIDF PIC  X(0001).
  1469     05  FILLER REDEFINES USERIDF.
  1470         10  USERIDA PIC  X(0001).
  1471     05  USERIDI PIC  X(0004).
  1472*    -------------------------------
  1473     05  MAINTL PIC S9(0004) COMP.
  1474     05  MAINTF PIC  X(0001).
  1475     05  FILLER REDEFINES MAINTF.
  1476         10  MAINTA PIC  X(0001).
  1477     05  MAINTI PIC  X(0001).
  1478*    -------------------------------
  1479     05  FORML PIC S9(0004) COMP.
  1480     05  FORMF PIC  X(0001).
  1481     05  FILLER REDEFINES FORMF.
  1482         10  FORMA PIC  X(0001).
  1483     05  FORMI PIC  X(0004).
  1484*    -------------------------------
  1485     05  ARCHNUML PIC S9(0004) COMP.
  1486     05  ARCHNUMF PIC  X(0001).
  1487     05  FILLER REDEFINES ARCHNUMF.
  1488         10  ARCHNUMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  30
* EL689.cbl
  1489     05  ARCHNUMI PIC  99999999.
  1490*    -------------------------------
  1491     05  PRTNOWL PIC S9(0004) COMP.
  1492     05  PRTNOWF PIC  X(0001).
  1493     05  FILLER REDEFINES PRTNOWF.
  1494         10  PRTNOWA PIC  X(0001).
  1495     05  PRTNOWI PIC  X(0001).
  1496*    -------------------------------
  1497     05  CARRIERL PIC S9(0004) COMP.
  1498     05  CARRIERF PIC  X(0001).
  1499     05  FILLER REDEFINES CARRIERF.
  1500         10  CARRIERA PIC  X(0001).
  1501     05  CARRIERI PIC  X(0001).
  1502*    -------------------------------
  1503     05  GROUPL PIC S9(0004) COMP.
  1504     05  GROUPF PIC  X(0001).
  1505     05  FILLER REDEFINES GROUPF.
  1506         10  GROUPA PIC  X(0001).
  1507     05  GROUPI PIC  X(0006).
  1508*    -------------------------------
  1509     05  STATEL PIC S9(0004) COMP.
  1510     05  STATEF PIC  X(0001).
  1511     05  FILLER REDEFINES STATEF.
  1512         10  STATEA PIC  X(0001).
  1513     05  STATEI PIC  X(0002).
  1514*    -------------------------------
  1515     05  ACCTL PIC S9(0004) COMP.
  1516     05  ACCTF PIC  X(0001).
  1517     05  FILLER REDEFINES ACCTF.
  1518         10  ACCTA PIC  X(0001).
  1519     05  ACCTI PIC  X(0010).
  1520*    -------------------------------
  1521     05  CERTL PIC S9(0004) COMP.
  1522     05  CERTF PIC  X(0001).
  1523     05  FILLER REDEFINES CERTF.
  1524         10  CERTA PIC  X(0001).
  1525     05  CERTI PIC  X(0010).
  1526*    -------------------------------
  1527     05  SFXL PIC S9(0004) COMP.
  1528     05  SFXF PIC  X(0001).
  1529     05  FILLER REDEFINES SFXF.
  1530         10  SFXA PIC  X(0001).
  1531     05  SFXI PIC  X(0001).
  1532*    -------------------------------
  1533     05  TYPEL PIC S9(0004) COMP.
  1534     05  TYPEF PIC  X(0001).
  1535     05  FILLER REDEFINES TYPEF.
  1536         10  TYPEA PIC  X(0001).
  1537     05  TYPEI PIC  X(0001).
  1538*    -------------------------------
  1539     05  DATEL PIC S9(0004) COMP.
  1540     05  DATEF PIC  X(0001).
  1541     05  FILLER REDEFINES DATEF.
  1542         10  DATEA PIC  X(0001).
  1543     05  DATEI PIC  X(0008).
  1544*    -------------------------------
  1545     05  FOLLOWL PIC S9(0004) COMP.
  1546     05  FOLLOWF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  31
* EL689.cbl
  1547     05  FILLER REDEFINES FOLLOWF.
  1548         10  FOLLOWA PIC  X(0001).
  1549     05  FOLLOWI PIC  X(0008).
  1550*    -------------------------------
  1551     05  RESEND1L PIC S9(0004) COMP.
  1552     05  RESEND1F PIC  X(0001).
  1553     05  FILLER REDEFINES RESEND1F.
  1554         10  RESEND1A PIC  X(0001).
  1555     05  RESEND1I PIC  X(0008).
  1556*    -------------------------------
  1557     05  ENCL PIC S9(0004) COMP.
  1558     05  ENCF PIC  X(0001).
  1559     05  FILLER REDEFINES ENCF.
  1560         10  ENCA PIC  X(0001).
  1561     05  ENCI PIC  X(0003).
  1562*    -------------------------------
  1563     05  ENDARCHL PIC S9(0004) COMP.
  1564     05  ENDARCHF PIC  X(0001).
  1565     05  FILLER REDEFINES ENDARCHF.
  1566         10  ENDARCHA PIC  X(0001).
  1567     05  ENDARCHI PIC  99999999.
  1568*    -------------------------------
  1569     05  CERTIDL PIC S9(0004) COMP.
  1570     05  CERTIDF PIC  X(0001).
  1571     05  FILLER REDEFINES CERTIDF.
  1572         10  CERTIDA PIC  X(0001).
  1573     05  CERTIDI PIC  X(0005).
  1574*    -------------------------------
  1575     05  ADDRSL PIC S9(0004) COMP.
  1576     05  ADDRSF PIC  X(0001).
  1577     05  FILLER REDEFINES ADDRSF.
  1578         10  ADDRSA PIC  X(0001).
  1579     05  ADDRSI PIC  X(0001).
  1580*    -------------------------------
  1581     05  PRINTERL PIC S9(0004) COMP.
  1582     05  PRINTERF PIC  X(0001).
  1583     05  FILLER REDEFINES PRINTERF.
  1584         10  PRINTERA PIC  X(0001).
  1585     05  PRINTERI PIC  X(0004).
  1586*    -------------------------------
  1587     05  COPIESL PIC S9(0004) COMP.
  1588     05  COPIESF PIC  X(0001).
  1589     05  FILLER REDEFINES COPIESF.
  1590         10  COPIESA PIC  X(0001).
  1591     05  COPIESI PIC  X(0001).
  1592*    -------------------------------
  1593     05  DATASORL PIC S9(0004) COMP.
  1594     05  DATASORF PIC  X(0001).
  1595     05  FILLER REDEFINES DATASORF.
  1596         10  DATASORA PIC  X(0001).
  1597     05  DATASORI PIC  X(0001).
  1598*    -------------------------------
  1599     05  ADDRLBLL PIC S9(0004) COMP.
  1600     05  ADDRLBLF PIC  X(0001).
  1601     05  FILLER REDEFINES ADDRLBLF.
  1602         10  ADDRLBLA PIC  X(0001).
  1603     05  ADDRLBLI PIC  X(0001).
  1604*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  32
* EL689.cbl
  1605     05  RPERSONL PIC S9(0004) COMP.
  1606     05  RPERSONF PIC  X(0001).
  1607     05  FILLER REDEFINES RPERSONF.
  1608         10  RPERSONA PIC  X(0001).
  1609     05  RPERSONI PIC  X(0010).
  1610*    -------------------------------
  1611     05  BENTRYL PIC S9(0004) COMP.
  1612     05  BENTRYF PIC  X(0001).
  1613     05  FILLER REDEFINES BENTRYF.
  1614         10  BENTRYA PIC  X(0001).
  1615     05  BENTRYI PIC  X(0006).
  1616*    -------------------------------
  1617     05  SEQL PIC S9(0004) COMP.
  1618     05  SEQF PIC  X(0001).
  1619     05  FILLER REDEFINES SEQF.
  1620         10  SEQA PIC  X(0001).
  1621     05  SEQI PIC  X(0008).
  1622*    -------------------------------
  1623     05  BCSEQL PIC S9(0004) COMP.
  1624     05  BCSEQF PIC  X(0001).
  1625     05  FILLER REDEFINES BCSEQF.
  1626         10  BCSEQA PIC  X(0001).
  1627     05  BCSEQI PIC  X(0004).
  1628*    -------------------------------
  1629     05  L1L PIC S9(0004) COMP.
  1630     05  L1F PIC  X(0001).
  1631     05  FILLER REDEFINES L1F.
  1632         10  L1A PIC  X(0001).
  1633     05  L1I PIC  X(0003).
  1634*    -------------------------------
  1635     05  TEXT1L PIC S9(0004) COMP.
  1636     05  TEXT1F PIC  X(0001).
  1637     05  FILLER REDEFINES TEXT1F.
  1638         10  TEXT1A PIC  X(0001).
  1639     05  TEXT1I PIC  X(0070).
  1640*    -------------------------------
  1641     05  L2L PIC S9(0004) COMP.
  1642     05  L2F PIC  X(0001).
  1643     05  FILLER REDEFINES L2F.
  1644         10  L2A PIC  X(0001).
  1645     05  L2I PIC  X(0003).
  1646*    -------------------------------
  1647     05  TEXT2L PIC S9(0004) COMP.
  1648     05  TEXT2F PIC  X(0001).
  1649     05  FILLER REDEFINES TEXT2F.
  1650         10  TEXT2A PIC  X(0001).
  1651     05  TEXT2I PIC  X(0070).
  1652*    -------------------------------
  1653     05  L3L PIC S9(0004) COMP.
  1654     05  L3F PIC  X(0001).
  1655     05  FILLER REDEFINES L3F.
  1656         10  L3A PIC  X(0001).
  1657     05  L3I PIC  X(0003).
  1658*    -------------------------------
  1659     05  TEXT3L PIC S9(0004) COMP.
  1660     05  TEXT3F PIC  X(0001).
  1661     05  FILLER REDEFINES TEXT3F.
  1662         10  TEXT3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  33
* EL689.cbl
  1663     05  TEXT3I PIC  X(0070).
  1664*    -------------------------------
  1665     05  L4L PIC S9(0004) COMP.
  1666     05  L4F PIC  X(0001).
  1667     05  FILLER REDEFINES L4F.
  1668         10  L4A PIC  X(0001).
  1669     05  L4I PIC  X(0003).
  1670*    -------------------------------
  1671     05  TEXT4L PIC S9(0004) COMP.
  1672     05  TEXT4F PIC  X(0001).
  1673     05  FILLER REDEFINES TEXT4F.
  1674         10  TEXT4A PIC  X(0001).
  1675     05  TEXT4I PIC  X(0070).
  1676*    -------------------------------
  1677     05  L5L PIC S9(0004) COMP.
  1678     05  L5F PIC  X(0001).
  1679     05  FILLER REDEFINES L5F.
  1680         10  L5A PIC  X(0001).
  1681     05  L5I PIC  X(0003).
  1682*    -------------------------------
  1683     05  TEXT5L PIC S9(0004) COMP.
  1684     05  TEXT5F PIC  X(0001).
  1685     05  FILLER REDEFINES TEXT5F.
  1686         10  TEXT5A PIC  X(0001).
  1687     05  TEXT5I PIC  X(0070).
  1688*    -------------------------------
  1689     05  L6L PIC S9(0004) COMP.
  1690     05  L6F PIC  X(0001).
  1691     05  FILLER REDEFINES L6F.
  1692         10  L6A PIC  X(0001).
  1693     05  L6I PIC  X(0003).
  1694*    -------------------------------
  1695     05  TEXT6L PIC S9(0004) COMP.
  1696     05  TEXT6F PIC  X(0001).
  1697     05  FILLER REDEFINES TEXT6F.
  1698         10  TEXT6A PIC  X(0001).
  1699     05  TEXT6I PIC  X(0070).
  1700*    -------------------------------
  1701     05  L7L PIC S9(0004) COMP.
  1702     05  L7F PIC  X(0001).
  1703     05  FILLER REDEFINES L7F.
  1704         10  L7A PIC  X(0001).
  1705     05  L7I PIC  X(0003).
  1706*    -------------------------------
  1707     05  TEXT7L PIC S9(0004) COMP.
  1708     05  TEXT7F PIC  X(0001).
  1709     05  FILLER REDEFINES TEXT7F.
  1710         10  TEXT7A PIC  X(0001).
  1711     05  TEXT7I PIC  X(0070).
  1712*    -------------------------------
  1713     05  L8L PIC S9(0004) COMP.
  1714     05  L8F PIC  X(0001).
  1715     05  FILLER REDEFINES L8F.
  1716         10  L8A PIC  X(0001).
  1717     05  L8I PIC  X(0003).
  1718*    -------------------------------
  1719     05  TEXT8L PIC S9(0004) COMP.
  1720     05  TEXT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  34
* EL689.cbl
  1721     05  FILLER REDEFINES TEXT8F.
  1722         10  TEXT8A PIC  X(0001).
  1723     05  TEXT8I PIC  X(0070).
  1724*    -------------------------------
  1725     05  L9L PIC S9(0004) COMP.
  1726     05  L9F PIC  X(0001).
  1727     05  FILLER REDEFINES L9F.
  1728         10  L9A PIC  X(0001).
  1729     05  L9I PIC  X(0003).
  1730*    -------------------------------
  1731     05  TEXT9L PIC S9(0004) COMP.
  1732     05  TEXT9F PIC  X(0001).
  1733     05  FILLER REDEFINES TEXT9F.
  1734         10  TEXT9A PIC  X(0001).
  1735     05  TEXT9I PIC  X(0070).
  1736*    -------------------------------
  1737     05  L10L PIC S9(0004) COMP.
  1738     05  L10F PIC  X(0001).
  1739     05  FILLER REDEFINES L10F.
  1740         10  L10A PIC  X(0001).
  1741     05  L10I PIC  X(0003).
  1742*    -------------------------------
  1743     05  TEXT10L PIC S9(0004) COMP.
  1744     05  TEXT10F PIC  X(0001).
  1745     05  FILLER REDEFINES TEXT10F.
  1746         10  TEXT10A PIC  X(0001).
  1747     05  TEXT10I PIC  X(0070).
  1748*    -------------------------------
  1749     05  L11L PIC S9(0004) COMP.
  1750     05  L11F PIC  X(0001).
  1751     05  FILLER REDEFINES L11F.
  1752         10  L11A PIC  X(0001).
  1753     05  L11I PIC  X(0003).
  1754*    -------------------------------
  1755     05  TEXT11L PIC S9(0004) COMP.
  1756     05  TEXT11F PIC  X(0001).
  1757     05  FILLER REDEFINES TEXT11F.
  1758         10  TEXT11A PIC  X(0001).
  1759     05  TEXT11I PIC  X(0070).
  1760*    -------------------------------
  1761     05  L12L PIC S9(0004) COMP.
  1762     05  L12F PIC  X(0001).
  1763     05  FILLER REDEFINES L12F.
  1764         10  L12A PIC  X(0001).
  1765     05  L12I PIC  X(0003).
  1766*    -------------------------------
  1767     05  TEXT12L PIC S9(0004) COMP.
  1768     05  TEXT12F PIC  X(0001).
  1769     05  FILLER REDEFINES TEXT12F.
  1770         10  TEXT12A PIC  X(0001).
  1771     05  TEXT12I PIC  X(0070).
  1772*    -------------------------------
  1773     05  ERRMSGL PIC S9(0004) COMP.
  1774     05  ERRMSGF PIC  X(0001).
  1775     05  FILLER REDEFINES ERRMSGF.
  1776         10  ERRMSGA PIC  X(0001).
  1777     05  ERRMSGI PIC  X(0079).
  1778*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  35
* EL689.cbl
  1779     05  ENTERPFL PIC S9(0004) COMP.
  1780     05  ENTERPFF PIC  X(0001).
  1781     05  FILLER REDEFINES ENTERPFF.
  1782         10  ENTERPFA PIC  X(0001).
  1783     05  ENTERPFI PIC  99.
  1784*    -------------------------------
  1785     05  PF8HDL PIC S9(0004) COMP.
  1786     05  PF8HDF PIC  X(0001).
  1787     05  FILLER REDEFINES PF8HDF.
  1788         10  PF8HDA PIC  X(0001).
  1789     05  PF8HDI PIC  X(0022).
  1790 01  EL689AO REDEFINES EL689AI.
  1791     05  FILLER            PIC  X(0012).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  RUNDTEO PIC  X(0008).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  RUNTIMEO PIC  99.99.
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  HOSTO PIC  X(0010).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  SYSO PIC  X(0008).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  COMPANYO PIC  X(0003).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  USERIDO PIC  X(0004).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  MAINTO PIC  X(0001).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  FORMO PIC  X(0004).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  ARCHNUMO PIC  99999999.
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  PRTNOWO PIC  X(0001).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  CARRIERO PIC  X(0001).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  GROUPO PIC  X(0006).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  STATEO PIC  X(0002).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  ACCTO PIC  X(0010).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  CERTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  36
* EL689.cbl
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  SFXO PIC  X(0001).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  TYPEO PIC  X(0001).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  DATEO PIC  X(0008).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  FOLLOWO PIC  X(0008).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  RESEND1O PIC  X(0008).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  ENCO PIC  X(0003).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  ENDARCHO PIC  99999999.
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  CERTIDO PIC  X(0005).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  ADDRSO PIC  X(0001).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  PRINTERO PIC  X(0004).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  COPIESO PIC  X(0001).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  DATASORO PIC  X(0001).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  ADDRLBLO PIC  X(0001).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  RPERSONO PIC  X(0010).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  BENTRYO PIC  X(0006).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  SEQO PIC  X(0008).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  BCSEQO PIC  X(0004).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  L1O PIC  X(0003).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  TEXT1O PIC  X(0070).
  1894*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  37
* EL689.cbl
  1895     05  FILLER            PIC  X(0003).
  1896     05  L2O PIC  X(0003).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  TEXT2O PIC  X(0070).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  L3O PIC  X(0003).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  TEXT3O PIC  X(0070).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  L4O PIC  X(0003).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  TEXT4O PIC  X(0070).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  L5O PIC  X(0003).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  TEXT5O PIC  X(0070).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  L6O PIC  X(0003).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  TEXT6O PIC  X(0070).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  L7O PIC  X(0003).
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  TEXT7O PIC  X(0070).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  L8O PIC  X(0003).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  TEXT8O PIC  X(0070).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  L9O PIC  X(0003).
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  TEXT9O PIC  X(0070).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  L10O PIC  X(0003).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  TEXT10O PIC  X(0070).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  L11O PIC  X(0003).
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  38
* EL689.cbl
  1953     05  TEXT11O PIC  X(0070).
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  L12O PIC  X(0003).
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  TEXT12O PIC  X(0070).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  ERRMSGO PIC  X(0079).
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  ENTERPFO PIC  X(0002).
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  PF8HDO PIC  X(0022).
  1969*    -------------------------------
  1970 01  W-MAP-REDEF REDEFINES EL689AI.
  1971*    12  FILLER                  PIC X(218).
  1972     12  FILLER                  PIC X(267).
  1973     12  EL689RI.
  1974         16  W-TEXT-LINES OCCURS 12 TIMES INDEXED BY W-SC-NDX.
  1975             20  W-SC-LINEL      PIC S9(04) COMP.
  1976             20  W-SC-LINEA      PIC  X(01).
  1977             20  W-SC-LINE       PIC  X(03).
  1978             20  W-SC-TEXTL      PIC S9(04) COMP.
  1979             20  W-SC-TEXTA      PIC  X(01).
  1980             20  W-SC-TEXT       PIC  X(70).
  1981*    12  FILLER                  PIC  X(87).
  1982     12  FILLER                  PIC  X(112).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  39
* EL689.cbl
  1984 01  W-CONSTANT-AREA.
  1985     12  FILLER                  PIC  X(18)
  1986                                 VALUE 'PROGRAM CONSTANTS:'.
  1987     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
  1988     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
  1989     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
  1990     12  W-ENDT-LENGTH           PIC S9(04)  COMP  VALUE +579.
  1991     12  W-NOTE-LENGTH           PIC S9(04)  COMP  VALUE +825.
  1992     12  W-EOBC-LENGTH           PIC S9(04)  COMP  VALUE +350.
  1993     12  W-ENCC-LENGTH           PIC S9(04)  COMP  VALUE +400.
  1994     12  W-MAX-LINES             PIC S9(03) VALUE +300 COMP-3.
  1995     12  W-NUM-LINES-PER-SCREEN  PIC  9(02)        VALUE 12.
  1996     12  W-TS-NUM-REC-IN-GROUP   PIC  9(02)        VALUE 50.
  1997     12  W-TS-LENGTH             PIC S9(04)  COMP  VALUE +3650.
  1998     12  W-TS-MAP-LENGTH         PIC S9(04)  COMP  VALUE +1260.
  1999     12  W-ZEROS                 PIC S9(03) VALUE +000 COMP-3.
  2000
  2001     12  W-ACCT-FILE-ID          PIC  X(08) VALUE 'ERACCT'.
  2002     12  W-ACCT2-FILE-ID         PIC  X(08) VALUE 'ERACCT2'.
  2003     12  W-ARCH-FILE-ID          PIC  X(08) VALUE 'ERARCH'.
  2004     12  W-ARCH2-FILE-ID         PIC  X(08) VALUE 'ERARCH2'.
  2005     12  W-ARCH3-FILE-ID         PIC  X(08) VALUE 'ERARCH3'.
  2006     12  W-ARCH4-FILE-ID         PIC  X(08) VALUE 'ERARCH4'.
  2007     12  W-ARCH5-FILE-ID         PIC  X(08) VALUE 'ERARCH5'.
  2008     12  W-ARCT-FILE-ID          PIC  X(08) VALUE 'ERARCT'.
  2009     12  W-CERT-FILE-ID          PIC  X(08) VALUE 'ELCERT'.
  2010     12  W-CHEK-FILE-ID          PIC  X(08) VALUE 'ERCHEK'.
  2011     12  W-CNTL-FILE-ID          PIC  X(08) VALUE 'ELCNTL'.
  2012     12  W-COMP-FILE-ID          PIC  X(08) VALUE 'ERCOMP'.
  2013     12  W-NOTE-FILE-ID          PIC  X(08) VALUE 'ERNOTE'.
  2014     12  W-EOBC-FILE-ID          PIC  X(08) VALUE 'ELEOBC'.
  2015     12  W-ENCC-FILE-ID          PIC  X(08) VALUE 'ELENCC'.
  2016     12  W-GETMAIN-SPACE         PIC  X(01) VALUE SPACE.
  2017     12  W-LGXX-ID               PIC  X(04) VALUE 'LGXX'.
  2018     12  W-LINK-001              PIC  X(05) VALUE 'EL001'.
  2019     12  W-LINK-004              PIC  X(05) VALUE 'EL004'.
  2020     12  W-LINK-ELDATCV          PIC  X(07) VALUE 'ELDATCV'.
  2021     12  W-LOWER-CASE            PIC  X(26)
  2022         VALUE 'abcdefghijklmnopqrstuvwxyz'.
  2023     12  W-MAIL-FILE-ID          PIC  X(08) VALUE 'ERMAIL'.
  2024     12  W-MAP.
  2025         16  W-MAP-PREFIX        PIC  X(02) VALUE 'EL'.
  2026         16  W-MAP-NUM           PIC  X(04) VALUE '689A'.
  2027         16  W-MAP-FILLER        PIC  X(02) VALUE SPACES.
  2028     12  W-MAPSET                PIC  X(08) VALUE 'EL689S'.
  2029     12  W-PGM-EL1042            PIC  X(08) VALUE 'EL1042'.
  2030     12  W-PGM-EL690             PIC  X(08) VALUE 'EL690'.
  2031     12  W-PGM-EL626             PIC  X(08) VALUE 'EL626'.
  2032     12  W-PNDB-FILE-ID          PIC  X(08) VALUE 'ERPNDB'.
  2033     12  W-PRINT-TRANS           PIC  X(04) VALUE 'EXH5'.
  2034     12  W-PYAJ-FILE-ID          PIC  X(08) VALUE 'ERPYAJ'.
  2035
  2036     12  W-TEXT-FILE-ID          PIC  X(08) VALUE 'ELLETR'.
  2037     12  W-THIS-PGM              PIC  X(08) VALUE 'EL689'.
  2038     12  W-TOP-FORM              PIC  X(70)
  2039                              VALUE '*****TOP OF FORM *****'.
  2040     12  W-TRANSACTION           PIC  X(04) VALUE 'EXH3'.
  2041     12  W-UPPER-CASE            PIC  X(26)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  40
* EL689.cbl
  2042         VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
  2043     12  W-XCTL-005              PIC  X(05) VALUE 'EL005'.
  2044     12  W-XCTL-010              PIC  X(05) VALUE 'EL010'.
  2045     12  W-XCTL-626              PIC  X(05) VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  41
* EL689.cbl
  2047 01  W-VARIABLE-PROCESS-CNTLS.
  2048     12  FILLER                  PIC  X(26)
  2049                        VALUE 'VARIABLE WORK AREA STARTS:'.
  2050     12  W-NUM-OF-VARIABLES      PIC S9(03) VALUE +189 COMP-3.
  2051     12  W-VAR-HOLD.
  2052         16  W-V1                PIC  X(01).
  2053         16  W-V2                PIC  X(01).
  2054         16  W-V3                PIC  X(01).
  2055     12  FILLER REDEFINES W-VAR-HOLD.
  2056         16  W-VAR-RELATIVE-NUM  PIC  9(03).
  2057     12  W-FIELD-SQUEEZE-IND     PIC  X(01).
  2058         88  W-SQUEEZE-FIELD          VALUE '#'.
  2059
  2060 01  W-SUPPORTED-VARIABLES.
  2061
  2062*****************COMPANY VARIABLES - ELCNTL ********************
  2063*****COMPANY NAME
  2064     12  FILLER                  PIC  X(03) VALUE '001'.
  2065     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2066     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2067     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2068     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2069
  2070*****FULL COMPANY ADDRESS
  2071     12  FILLER                  PIC  X(03) VALUE '002'.
  2072     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2073     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2074     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2075     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2076
  2077     12  FILLER                  PIC  X(03) VALUE '003'.
  2078     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2079     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2080     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2081     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2082
  2083     12  FILLER                  PIC  X(03) VALUE '004'.
  2084     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2085     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2086     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2087     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2088
  2089     12  FILLER                  PIC  X(03) VALUE '005'.
  2090     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2091     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2092     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2093     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2094
  2095     12  FILLER                  PIC  X(03) VALUE '006'.
  2096     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2097     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2098     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2099     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2100
  2101*****REMAINING 4 ARE NOT CURRENTLY USED
  2102     12  FILLER                  PIC  X(03) VALUE '007'.
  2103     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2104     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  42
* EL689.cbl
  2105     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2106     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2107
  2108     12  FILLER                  PIC  X(03) VALUE '008'.
  2109     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2110     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2111     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2112     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2113
  2114     12  FILLER                  PIC  X(03) VALUE '009'.
  2115     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2116     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2117     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2118     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2119
  2120     12  FILLER                  PIC  X(03) VALUE '010'.
  2121     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2122     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2123     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2124     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2125
  2126************ LIFE BENEFIT VARIABLES - ELCNTL *******************
  2127*****LIFE BENEFIT DESCRIPTION
  2128     12  FILLER                  PIC  X(03) VALUE '011'.
  2129     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2130     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2131     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2132     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2133
  2134*****REMAINING 3 ARE NOT CURRENTLY USED
  2135     12  FILLER                  PIC  X(03) VALUE '012'.
  2136     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2137     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2138     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2139     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2140
  2141     12  FILLER                  PIC  X(03) VALUE '013'.
  2142     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2143     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2144     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2145     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2146
  2147     12  FILLER                  PIC  X(03) VALUE '014'.
  2148     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2149     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2150     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2151     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2152
  2153************* A&H BENEFIT VARIABLES - ELCNTL *******************
  2154*****AH BENEFIT DESCRIPTION
  2155     12  FILLER                  PIC  X(03) VALUE '015'.
  2156     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2157     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2158     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2159     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2160
  2161*****ELIMINATION PERIOD
  2162     12  FILLER                  PIC  X(03) VALUE '016'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  43
* EL689.cbl
  2163     12  FILLER                  PIC S9(04) COMP VALUE +2.
  2164     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2165     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2166     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2167
  2168*****REMAINING 3 ARE NOT CURRENTLY USED
  2169     12  FILLER                  PIC  X(03) VALUE '017'.
  2170     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2171     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2172     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2173     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2174
  2175     12  FILLER                  PIC  X(03) VALUE '018'.
  2176     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2177     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2178     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2179     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2180
  2181     12  FILLER                  PIC  X(03) VALUE '019'.
  2182     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2183     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2184     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2185     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2186
  2187*****************CARRIER VARIABLES - ELCNTL ********************
  2188*****CARRIER NAME
  2189     12  FILLER                  PIC  X(03) VALUE '020'.
  2190     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2191     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2192     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2193     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2194
  2195*****FULL CARRIER ADDRESS
  2196     12  FILLER                  PIC  X(03) VALUE '021'.
  2197     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2198     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2199     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2200     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2201
  2202     12  FILLER                  PIC  X(03) VALUE '022'.
  2203     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2204     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2205     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2206     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2207
  2208     12  FILLER                  PIC  X(03) VALUE '023'.
  2209     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2210     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2211     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2212     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2213
  2214     12  FILLER                  PIC  X(03) VALUE '024'.
  2215     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2216     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2217     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2218     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2219
  2220     12  FILLER                  PIC  X(03) VALUE '025'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  44
* EL689.cbl
  2221     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2222     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2223     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2224     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2225
  2226*****CARRIER PHONE NUMBER
  2227     12  FILLER                  PIC  X(03) VALUE '026'.
  2228     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2229     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2230     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2231     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2232
  2233*****REMAINING 4 ARE NOT CURRENTLY USED
  2234     12  FILLER                  PIC  X(03) VALUE '027'.
  2235     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2236     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2237     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2238     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2239
  2240     12  FILLER                  PIC  X(03) VALUE '028'.
  2241     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2242     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2243     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2244     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2245
  2246     12  FILLER                  PIC  X(03) VALUE '029'.
  2247     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2248     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2249     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2250     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2251
  2252     12  FILLER                  PIC  X(03) VALUE '030'.
  2253     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2254     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2255     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2256     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2257
  2258***************** MAIL VARIABLES - ELMAIL **********************
  2259*****FULL MAIL ADDRESS
  2260     12  FILLER                  PIC  X(03) VALUE '031'.
  2261     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2262     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2263     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2264     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2265
  2266     12  FILLER                  PIC  X(03) VALUE '032'.
  2267     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2268     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2269     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2270     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2271
  2272     12  FILLER                  PIC  X(03) VALUE '033'.
  2273     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2274     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2275     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2276     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2277
  2278     12  FILLER                  PIC  X(03) VALUE '034'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  45
* EL689.cbl
  2279     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2280     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2281     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2282     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2283
  2284     12  FILLER                  PIC  X(03) VALUE '035'.
  2285     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2286     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2287     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2288     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2289
  2290     12  FILLER                  PIC  X(03) VALUE '036'.
  2291     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2292     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2293     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2294     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2295**** CRED BENE NAME FROM ERMAIL
  2296     12  FILLER                  PIC  X(03) VALUE '037'.
  2297     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2298     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2299     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2300     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2301*****REMAINING 2 ARE NOT CURRENTLY USED
  2302     12  FILLER                  PIC  X(03) VALUE '038'.
  2303     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2304     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2305     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2306     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2307
  2308     12  FILLER                  PIC  X(03) VALUE '039'.
  2309     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2310     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2311     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2312     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2313
  2314*************** ACCOUNT VARIABLES - ERACCT *********************
  2315*****ACCOUNT NAME
  2316     12  FILLER                  PIC  X(03) VALUE '040'.
  2317     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2318     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2319     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2320     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2321
  2322*****FULL ACCOUNT ADDRESS
  2323     12  FILLER                  PIC  X(03) VALUE '041'.
  2324     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2325     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2326     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2327     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2328
  2329     12  FILLER                  PIC  X(03) VALUE '042'.
  2330     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2331     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2332     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2333     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2334
  2335     12  FILLER                  PIC  X(03) VALUE '043'.
  2336     12  FILLER                  PIC S9(04) COMP VALUE +30.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  46
* EL689.cbl
  2337     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2338     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2339     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2340
  2341     12  FILLER                  PIC  X(03) VALUE '044'.
  2342     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2343     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2344     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2345     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2346
  2347     12  FILLER                  PIC  X(03) VALUE '045'.
  2348     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2349     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2350     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2351     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2352
  2353*****ACCOUNT PHONE NUMBER
  2354     12  FILLER                  PIC  X(03) VALUE '046'.
  2355     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2356     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2357     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2358     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2359
  2360*****ACCOUNT CONTROL NAME AM-CONTROL-NAME
  2361     12  FILLER                  PIC  X(03) VALUE '047'.
  2362     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2363     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2364     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2365     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2366
  2367****ACCOUNT CSR CODE
  2368     12  FILLER                  PIC  X(03) VALUE '048'.
  2369     12  FILLER                  PIC S9(04) COMP VALUE +4..
  2370     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2371     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2372     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2373****ACCOUNT ACCOUNT NUMBER
  2374     12  FILLER                  PIC  X(03) VALUE '049'.
  2375     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2376     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2377     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2378     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2379
  2380**** CRED BENE ADDRESS LINE 1 ERMAIL
  2381     12  FILLER                  PIC  X(03) VALUE '050'.
  2382     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2383     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2384     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2385     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2386
  2387**** CRED BENE ADDRESS LINE 2 ERMAIL
  2388     12  FILLER                  PIC  X(03) VALUE '051'.
  2389     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2390     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2391     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2392     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2393
  2394**** CRED BENE CITY STATE   ERMAIL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  47
* EL689.cbl
  2395     12  FILLER                  PIC  X(03) VALUE '052'.
  2396     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2397     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2398     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2399     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2400
  2401**** CRED BENE ZIP  1 ERMAIL
  2402     12  FILLER                  PIC  X(03) VALUE '053'.
  2403     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2404     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2405     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2406     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2407
  2408*****REMAINING 6 ARE NOT CURRENTLY USED
  2409     12  FILLER                  PIC  X(03) VALUE '054'.
  2410     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2411     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2412     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2413     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2414
  2415     12  FILLER                  PIC  X(03) VALUE '055'.
  2416     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2417     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2418     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2419     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2420
  2421     12  FILLER                  PIC  X(03) VALUE '056'.
  2422     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2423     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2424     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2425     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2426
  2427     12  FILLER                  PIC  X(03) VALUE '057'.
  2428     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2429     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2430     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2431     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2432
  2433     12  FILLER                  PIC  X(03) VALUE '058'.
  2434     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2435     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2436     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2437     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2438
  2439     12  FILLER                  PIC  X(03) VALUE '059'.
  2440     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2441     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2442     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2443     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2444
  2445*************** NON FILE VARIABLES *****************************
  2446*****CURRENT DATE
  2447     12  FILLER                  PIC  X(03) VALUE '060'.
  2448     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2449     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2450     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2451     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2452
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  48
* EL689.cbl
  2453*****FULL CURRENT DATE
  2454     12  FILLER                  PIC  X(03) VALUE '061'.
  2455     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2456     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2457     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2458     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2459
  2460*****FORM
  2461     12  FILLER                  PIC  X(03) VALUE '062'.
  2462     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2463     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2464     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2465     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2466
  2467*****VARIABLE 1
  2468     12  FILLER                  PIC  X(03) VALUE '063'.
  2469     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2470     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2471     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2472     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2473
  2474*****VARIABLE 2
  2475     12  FILLER                  PIC  X(03) VALUE '064'.
  2476     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2477     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2478     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2479     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2480
  2481*****VARIABLE 3
  2482     12  FILLER                  PIC  X(03) VALUE '065'.
  2483     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2484     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2485     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2486     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2487
  2488*****VARIABLE 4
  2489     12  FILLER                  PIC  X(03) VALUE '066'.
  2490     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2491     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2492     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2493     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2494
  2495*****REMAINING 3 ARE NOT CURRENTLY USED
  2496     12  FILLER                  PIC  X(03) VALUE '067'.
  2497     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2498     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2499     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2500     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2501
  2502     12  FILLER                  PIC  X(03) VALUE '068'.
  2503     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2504     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2505     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2506     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2507
  2508     12  FILLER                  PIC  X(03) VALUE '069'.
  2509     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2510     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  49
* EL689.cbl
  2511     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2512     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2513
  2514************** CERTIFICATE VARIABLES - ELCERT *****************
  2515*****CARRIER CODE IN CERT
  2516     12  FILLER                  PIC  X(03) VALUE '070'.
  2517     12  FILLER                  PIC S9(04) COMP VALUE +1.
  2518     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2519     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2520     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2521
  2522*****GROUPING CODE IN CERT
  2523     12  FILLER                  PIC  X(03) VALUE '071'.
  2524     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2525     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2526     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2527     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2528
  2529*****ACCOUNT NUMBER IN CERT
  2530     12  FILLER                  PIC  X(03) VALUE '072'.
  2531     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2532     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2533     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2534     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2535
  2536*****CERTIFICATE NUMBER
  2537     12  FILLER                  PIC  X(03) VALUE '073'.
  2538     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2539     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2540     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2541     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2542
  2543*****CERT EFFECTIVE DATE
  2544     12  FILLER                  PIC  X(03) VALUE '074'.
  2545     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2546     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2547     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2548     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2549
  2550*****CERT EXPIRATION DATE (LIFE)
  2551     12  FILLER                  PIC  X(03) VALUE '075'.
  2552     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2553     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2554     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2555     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2556
  2557*****CERT EXPIRATION DATE (AH)
  2558     12  FILLER                  PIC  X(03) VALUE '076'.
  2559     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2560     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2561     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2562     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2563
  2564*****LIFE TERM
  2565     12  FILLER                  PIC  X(03) VALUE '077'.
  2566     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2567     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2568     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  50
* EL689.cbl
  2569     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2570
  2571*****AH  TERM
  2572     12  FILLER                  PIC  X(03) VALUE '078'.
  2573     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2574     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2575     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2576     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2577
  2578*****LIFE COVERAGE AMOUNT
  2579     12  FILLER                  PIC  X(03) VALUE '079'.
  2580     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2581     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2582     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2583     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2584
  2585*****AH MONTHLY BENEFIT
  2586     12  FILLER                  PIC  X(03) VALUE '080'.
  2587     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2588     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2589     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2590     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2591
  2592*****LIFE CANCEL DATE
  2593     12  FILLER                  PIC  X(03) VALUE '081'.
  2594     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2595     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2596     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2597     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2598
  2599*****AH CANCEL DATE
  2600     12  FILLER                  PIC  X(03) VALUE '082'.
  2601     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2602     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2603     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2604     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2605
  2606*****LIFE COVERAGE FORM NUMBER
  2607     12  FILLER                  PIC  X(03) VALUE '083'.
  2608     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2609     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2610     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2611     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2612
  2613*****UNUSED
  2614     12  FILLER                  PIC  X(03) VALUE '084'.
  2615     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2616     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2617     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2618     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2619
  2620*****INSUREDS AGE AT POLICY ISSUE (NOT USED)
  2621     12  FILLER                  PIC  X(03) VALUE '085'.
  2622     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2623     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2624     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2625     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2626
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  51
* EL689.cbl
  2627*****LOAN NUMBER
  2628     12  FILLER                  PIC  X(03) VALUE '086'.
  2629     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2630     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2631     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2632     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2633
  2634*****LOAN BALANCE
  2635     12  FILLER                  PIC  X(03) VALUE '087'.
  2636     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2637     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2638     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2639     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2640
  2641*****MEMBER NUMBER
  2642     12  FILLER                  PIC  X(03) VALUE '088'.
  2643     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2644     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2645     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2646     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2647
  2648*****INSURED SOC SEC NUMBER
  2649     12  FILLER                  PIC  X(03) VALUE '089'.
  2650     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2651     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2652     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2653     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2654
  2655*****INSURED INITIALS & LAST NAME (CERTIFICATE)
  2656     12  FILLER                  PIC  X(03) VALUE '090'.
  2657     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2658     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2659     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2660     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2661
  2662*****INSURED FIRST NAME (CERTIFICATE)
  2663     12  FILLER                  PIC  X(03) VALUE '091'.
  2664     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2665     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2666     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2667     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2668
  2669*****INSURED MIDDLE INITIAL (CERTIFICATE)
  2670     12  FILLER                  PIC  X(03) VALUE '092'.
  2671     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2672     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2673     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2674     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2675
  2676*****ORIG TERM * MON BEN
  2677     12  FILLER                  PIC  X(03) VALUE '093'.
  2678     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2679     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2680     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2681     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2682
  2683*****INSURED'S NAME (LAST, FIRST, INIT)
  2684     12  FILLER                  PIC  X(03) VALUE '094'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  52
* EL689.cbl
  2685     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2686     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2687     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2688     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2689
  2690*****INSURED'S NAME (FIRST, INIT, LAST)
  2691     12  FILLER                  PIC  X(03) VALUE  '095'.
  2692     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2693     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2694     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2695     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2696
  2697*****TITLE (MR/MS)
  2698     12  FILLER                  PIC  X(03) VALUE '096'.
  2699     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2700     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2701     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2702     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2703
  2704*****LIFE PREMIUM (CERTIFICATE)
  2705     12  FILLER                  PIC  X(03) VALUE '097'.
  2706     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2707     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2708     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2709     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2710
  2711*****A/H PREMIUM (CERTIFICATE)
  2712     12  FILLER                  PIC  X(03) VALUE '098'.
  2713     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2714     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2715     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2716     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2717
  2718*****JOINT'S INITIALS & LAST NAME (CERTIFICATE)
  2719     12  FILLER                  PIC  X(03) VALUE '099'.
  2720     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2721     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2722     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2723     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2724
  2725*****JOINT'S FIRST NAME (CERTIFICATE)
  2726     12  FILLER                  PIC  X(03) VALUE '100'.
  2727     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2728     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2729     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2730     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2731
  2732*****JOINT'S MIDDLE INITIAL (CERTIFICATE)
  2733     12  FILLER                  PIC  X(03) VALUE '101'.
  2734     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2735     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2736     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2737     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2738
  2739*****JOINT'S NAME (LAST, FIRST, INIT)
  2740     12  FILLER                  PIC  X(03) VALUE '102'.
  2741     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2742     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  53
* EL689.cbl
  2743     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2744     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2745
  2746*****JOINT'S NAME (FIRST, INIT, LAST)
  2747     12  FILLER                  PIC  X(03) VALUE '103'.
  2748     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2749     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2750     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2751     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2752
  2753*****INSURED'S FIRST AND LAST NAME
  2754     12  FILLER                  PIC  X(03) VALUE '104'.
  2755     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2756     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2757     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2758     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2759
  2760*****JOINT'S FIRST AND LAST NAME
  2761     12  FILLER                  PIC  X(03) VALUE '105'.
  2762     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2763     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2764     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2765     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2766
  2767*****ENTERED LIFE REFUND (CERT)
  2768     12  FILLER                  PIC  X(03) VALUE '106'.
  2769     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2770     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2771     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2772     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2773
  2774*****ENTERED A/H REFUND (CERT)
  2775     12  FILLER                  PIC  X(03) VALUE '107'.
  2776     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2777     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2778     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2779     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2780
  2781*****INSURED'S LAST NAME
  2782     12  FILLER                  PIC  X(03) VALUE '108'.
  2783     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2784     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2785     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2786     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2787
  2788*****BENEFICIARY
  2789     12  FILLER                  PIC  X(03) VALUE  '109'.
  2790     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2791     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2792     12  FILLER                  PIC  X(01) VALUE 'Y'.
  2793     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2794
  2795************** PENDING VARIABLES - ERPNDB *********************
  2796*****INSURED DATE OF BIRTH
  2797     12  FILLER                  PIC  X(03) VALUE '110'.
  2798     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2799     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2800     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  54
* EL689.cbl
  2801     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2802
  2803*****ENTERED LIFE PREMIUM (PENDING)
  2804     12  FILLER                  PIC  X(03) VALUE '111'.
  2805     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2806     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2807     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2808     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2809
  2810*****ENTERED A/H PREMIUM (PENDING)
  2811     12  FILLER                  PIC  X(03) VALUE '112'.
  2812     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2813     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2814     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2815     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2816
  2817*****CALCULATED LIFE PREMIUM (PENDING)
  2818     12  FILLER                  PIC  X(03) VALUE '113'.
  2819     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2820     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2821     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2822     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2823
  2824*****CALCULATED A/H PREMIUM (PENDING)
  2825     12  FILLER                  PIC  X(03) VALUE '114'.
  2826     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2827     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2828     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2829     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2830
  2831*****DIFFERENCE ENTER/COMPUTED LIFE PREMIUM (PENDING)
  2832     12  FILLER                  PIC  X(03) VALUE '115'.
  2833     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2834     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2835     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2836     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2837
  2838*****DIFFERENCE ENTER/COMPUTED A/H PREMIUM (PENDING)
  2839     12  FILLER                  PIC  X(03) VALUE '116'.
  2840     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2841     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2842     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2843     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2844
  2845*****PRIOR CANCEL DATE
  2846     12  FILLER                  PIC  X(03) VALUE '117'.
  2847     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2848     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2849     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2850     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2851
  2852*****ENTERED LIFE REFUND (PENDING)
  2853     12  FILLER                  PIC  X(03) VALUE '118'.
  2854     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2855     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2856     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2857     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2858
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  55
* EL689.cbl
  2859*****ENTERED A/H REFUND (PENDING)
  2860     12  FILLER                  PIC  X(03) VALUE '119'.
  2861     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2862     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2863     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2864     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2865
  2866*****CALCULATED LIFE REFUND (PENDING)
  2867     12  FILLER                  PIC  X(03) VALUE '120'.
  2868     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2869     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2870     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2871     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2872
  2873*****CALCULATED A/H REFUND (PENDING)
  2874     12  FILLER                  PIC  X(03) VALUE '121'.
  2875     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2876     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2877     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2878     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2879
  2880*****DIFFERENCE ENTER/COMPUTED LIFE REFUND (PENDING)
  2881     12  FILLER                  PIC  X(03) VALUE '122'.
  2882     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2883     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2884     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2885     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2886
  2887*****DIFFERENCE ENTER/COMPUTED A/H REFUND (PENDING)
  2888     12  FILLER                  PIC  X(03) VALUE '123'.
  2889     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2890     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2891     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2892     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2893
  2894*****INSUREDS AGE
  2895     12  FILLER                  PIC  X(03) VALUE '124'.
  2896     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2897     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2898     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2899     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2900
  2901*****LIFE BENEFIT (PENDING)
  2902     12  FILLER                  PIC  X(03) VALUE '125'.
  2903     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2904     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2905     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2906     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2907
  2908*****A/H BENEFIT (PENDING)
  2909     12  FILLER                  PIC  X(03) VALUE '126'.
  2910     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2911     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2912     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2913     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2914
  2915*****LIFE RATE
  2916     12  FILLER                  PIC  X(03) VALUE '127'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  56
* EL689.cbl
  2917     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2918     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2919     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2920     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2921
  2922*****A/H RATE
  2923     12  FILLER                  PIC  X(03) VALUE '128'.
  2924     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2925     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2926     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2927     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2928
  2929*****TERM (PENDING)
  2930     12  FILLER                  PIC  X(03) VALUE '129'.
  2931     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2932     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2933     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2934     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2935
  2936*****BATCH NUMBER
  2937     12  FILLER                  PIC  X(03) VALUE '130'.
  2938     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2939     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2940     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2941     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2942
  2943*****TOTAL OF LIFE AND A&H REFUND
  2944     12  FILLER                  PIC  X(03) VALUE '131'.
  2945     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2946     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2947     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2948     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2949
  2950*****NH INTEREST ON REFUNDS
  2951     12  FILLER                  PIC  X(03) VALUE '132'.
  2952     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2953     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2954     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2955     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2956*****GREATER OF THE LIFE AND AH CANCEL DATE
  2957     12  FILLER                  PIC  X(03) VALUE '133'.
  2958     12  FILLER                  PIC S9(04) COMP VALUE +8.
  2959     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2960     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2961     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2962
  2963*****THE NEXT 6 NOT CURRENTLY USED
  2964     12  FILLER                  PIC  X(03) VALUE '134'.
  2965     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2966     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2967     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2968     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2969
  2970     12  FILLER                  PIC  X(03) VALUE '135'.
  2971     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2972     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2973     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2974     12  FILLER                  PIC S9(04) COMP VALUE +09.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  57
* EL689.cbl
  2975
  2976     12  FILLER                  PIC  X(03) VALUE '136'.
  2977     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2978     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2979     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2980     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2981
  2982     12  FILLER                  PIC  X(03) VALUE '137'.
  2983     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2984     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2985     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2986     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2987
  2988     12  FILLER                  PIC  X(03) VALUE '138'.
  2989     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2990     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2991     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2992     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2993
  2994     12  FILLER                  PIC  X(03) VALUE '139'.
  2995     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2996     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2997     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2998     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2999
  3000************** COMPENSATION VARIABLES - ERCOMP ****************
  3001*****COMPENSATION ACCT NAME
  3002     12  FILLER                  PIC  X(03) VALUE '140'.
  3003     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3004     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3005     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3006     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3007
  3008*****FULL COMPENSATION ADDRESS TYPE 'A'
  3009     12  FILLER                  PIC  X(03) VALUE '141'.
  3010     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3011     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3012     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3013     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3014
  3015     12  FILLER                  PIC  X(03) VALUE '142'.
  3016     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3017     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3018     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3019     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3020
  3021     12  FILLER                  PIC  X(03) VALUE '143'.
  3022     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3023     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3024     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3025     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3026
  3027     12  FILLER                  PIC  X(03) VALUE '144'.
  3028     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3029     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3030     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3031     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3032
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  58
* EL689.cbl
  3033     12  FILLER                  PIC  X(03) VALUE '145'.
  3034     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3035     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3036     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3037     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3038
  3039     12  FILLER                  PIC  X(03) VALUE '146'.
  3040     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3041     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3042     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3043     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3044
  3045*****COMPENSATION PHONE NUMBER
  3046     12  FILLER                  PIC  X(03) VALUE '147'.
  3047     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3048     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3049     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3050     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3051
  3052*****COMPENSATION CSR NAME
  3053     12  FILLER                  PIC  X(03) VALUE '148'.
  3054     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3055     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3056     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3057     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3058
  3059*****COMPENSATION LAST STATEMENT DATE
  3060     12  FILLER                  PIC  X(03) VALUE '149'.
  3061     12  FILLER                  PIC S9(04) COMP VALUE +18.
  3062     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3063     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3064     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3065
  3066*****COMPENSATION ENDING BALANCE
  3067     12  FILLER                  PIC  X(03) VALUE '150'.
  3068     12  FILLER                  PIC S9(04) COMP VALUE +14.
  3069     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3070     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3071     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3072
  3073******************  PROCESSOR DATA - ELCNTL (2) ****************
  3074*****EXECUTING PROCESSOR NAME
  3075     12  FILLER                  PIC  X(03) VALUE '151'.
  3076     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3077     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3078     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3079     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3080
  3081*****PROCESSOR TITLE
  3082     12  FILLER                  PIC  X(03) VALUE '152'.
  3083     12  FILLER                  PIC S9(04) COMP VALUE +26.
  3084     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3085     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3086     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3087
  3088*****PROCESSOR
  3089     12  FILLER                  PIC  X(03) VALUE '153'.
  3090     12  FILLER                  PIC S9(04) COMP VALUE +04.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  59
* EL689.cbl
  3091     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3092     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3093     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3094
  3095*****CSR TITLE
  3096     12  FILLER                  PIC  X(03) VALUE '154'.
  3097     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3098     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3099     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3100     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3101*****REMAINING 2 ARE NOT CURRENTLY USED
  3102     12  FILLER                  PIC  X(03) VALUE '155'.
  3103     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3104     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3105     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3106     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3107
  3108     12  FILLER                  PIC  X(03) VALUE '156'.
  3109     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3110     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3111     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3112     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3113
  3114******************  CHECK DATA - ERCHEK    *********************
  3115*****CHECK AMOUNT
  3116     12  FILLER                  PIC  X(03) VALUE '157'.
  3117     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3118     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3119     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3120     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3121
  3122*****CHECK NUMBER
  3123     12  FILLER                  PIC  X(03) VALUE '158'.
  3124     12  FILLER                  PIC S9(04) COMP VALUE +7.
  3125     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3126     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3127     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3128
  3129*****PAYEE 1 NAME
  3130     12  FILLER                  PIC  X(03) VALUE '159'.
  3131     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3132     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3133     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3134     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3135
  3136*****PAYEE 2 NAME
  3137     12  FILLER                  PIC  X(03) VALUE '160'.
  3138     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3139     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3140     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3141     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3142
  3143*****ADDRSS 1
  3144     12  FILLER                  PIC  X(03) VALUE '161'.
  3145     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3146     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3147     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3148     12  FILLER                  PIC S9(04) COMP VALUE +12.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  60
* EL689.cbl
  3149
  3150*****ADDRESS 2
  3151     12  FILLER                  PIC  X(03) VALUE '162'.
  3152     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3153     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3154     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3155     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3156
  3157*****PAYEE CITY STATE
  3158     12  FILLER                  PIC  X(03) VALUE '163'.
  3159     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3160     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3161     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3162     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3163
  3164*****ZIP CODE
  3165     12  FILLER                  PIC  X(03) VALUE '164'.
  3166     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3167     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3168     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3169     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3170
  3171*****CHECK CONTROL
  3172     12  FILLER                  PIC  X(03) VALUE '165'.
  3173     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3174     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3175     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3176     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3177
  3178*****REASON FOR CHECK
  3179     12  FILLER                  PIC  X(03) VALUE '166'.
  3180     12  FILLER                  PIC S9(04) COMP VALUE +25.
  3181     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3182     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3183     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3184
  3185*****REMAINING 3 ARE NOT CURRENTLY USED
  3186     12  FILLER                  PIC  X(03) VALUE '167'.
  3187     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3188     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3189     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3190     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3191
  3192     12  FILLER                  PIC  X(03) VALUE '168'.
  3193     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3194     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3195     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3196     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3197
  3198     12  FILLER                  PIC  X(03) VALUE '169'.
  3199     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3200     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3201     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3202     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3203
  3204
  3205*********** PAYMENT AND ADJUSTMENT DATA - ERPYAJ  **************
  3206*****CHECK AMOUNT - PYAJ
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  61
* EL689.cbl
  3207     12  FILLER                  PIC  X(03) VALUE '170'.
  3208     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3209     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3210     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3211     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3212
  3213*****CHECK NUMBER - PYAJ
  3214     12  FILLER                  PIC  X(03) VALUE '171'.
  3215     12  FILLER                  PIC S9(04) COMP VALUE +7.
  3216     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3217     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3218     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3219
  3220*****CHECK CONTROL - PYAJ
  3221     12  FILLER                  PIC  X(03) VALUE '172'.
  3222     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3223     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3224     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3225     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3226
  3227***** COMMENT - PYAJ
  3228     12  FILLER                  PIC  X(03) VALUE '173'.
  3229     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3230     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3231     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3232     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3233
  3234*****NEW FIELDS.
  3235*****COMPENSATION FULL ADDRESS TYPE 'G'
  3236     12  FILLER                  PIC  X(03) VALUE '174'.
  3237     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3238     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3239     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3240     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3241
  3242     12  FILLER                  PIC  X(03) VALUE '175'.
  3243     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3244     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3245     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3246     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3247
  3248     12  FILLER                  PIC  X(03) VALUE '176'.
  3249     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3250     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3251     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3252     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3253
  3254     12  FILLER                  PIC  X(03) VALUE '177'.
  3255     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3256     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3257     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3258     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3259
  3260     12  FILLER                  PIC  X(03) VALUE '178'.
  3261     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3262     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3263     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3264     12  FILLER                  PIC S9(04) COMP VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  62
* EL689.cbl
  3265
  3266     12  FILLER                  PIC  X(03) VALUE '179'.
  3267     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3268     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3269     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3270     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3271
  3272*****COMPENSATION FINANCIAL RESPONSIBLE NO.
  3273     12  FILLER                  PIC  X(03) VALUE '180'.
  3274     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3275     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3276     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3277     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3278**** COMPENSATION BILLING SWITCH
  3279     12  FILLER                  PIC XXX    VALUE '181'.
  3280     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3281     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3282     12  FILLER                  PIC X      VALUE ALL 'N'.
  3283     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3284*****COMPENSATION FAX NUMBER
  3285     12  FILLER                  PIC  X(03) VALUE '182'.
  3286     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3287     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3288     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3289     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3290**** COMPENSATION STATUS
  3291     12  FILLER                  PIC XXX    VALUE '183'.
  3292     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3293     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3294     12  FILLER                  PIC X      VALUE ALL 'N'.
  3295     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3296***** THE VARS 184 - 189 WILL TYPICALLY BE USED FOR DCC BANKS
  3297*****COMPENSATION FULL ADDRESS TYPE 'B'
  3298     12  FILLER                  PIC  X(03) VALUE '184'.
  3299     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3300     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3301     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3302     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3303
  3304     12  FILLER                  PIC  X(03) VALUE '185'.
  3305     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3306     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3307     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3308     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3309
  3310     12  FILLER                  PIC  X(03) VALUE '186'.
  3311     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3312     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3313     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3314     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3315
  3316     12  FILLER                  PIC  X(03) VALUE '187'.
  3317     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3318     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3319     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3320     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3321
  3322     12  FILLER                  PIC  X(03) VALUE '188'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  63
* EL689.cbl
  3323     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3324     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3325     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3326     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3327
  3328     12  FILLER                  PIC  X(03) VALUE '189'.
  3329     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3330     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3331     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3332     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3333
  3334
  3335 01  FILLER REDEFINES W-SUPPORTED-VARIABLES.
  3336*    12  W-VARIABLE-GRP OCCURS 180 TIMES
  3337     12  W-VARIABLE-GRP OCCURS 189 TIMES
  3338                        INDEXED BY W-VG-NDX.
  3339         16  W-VARIABLE-ID         PIC  X(03).
  3340         16  W-VARIABLE-SIZE       PIC S9(04) COMP.
  3341         16  W-VG-TEXT.
  3342             20  W-VAR-CHAR
  3343                        OCCURS 30 TIMES
  3344                        INDEXED BY W-VC-NDX
  3345                                   PIC  X(01).
  3346         16  W-VARIABLE-UPLOW-IND  PIC  X(01).
  3347             88  W-USE-UPPER-AND-LOWER-CASE VALUE 'Y'.
  3348
  3349         16  W-VARIABLE-SOURCE   PIC S9(04) COMP.
  3350
  3351 01  W-VAR-END                   PIC  X(23)
  3352                        VALUE ':VARIABLE WORK AREA END'.
  3353
  3354 01  W-PROGRAM-TABLE-AREA.
  3355     12  FILLER                  PIC  X(15)
  3356                                 VALUE 'PROGRAM TABLES:'.
  3357
  3358     12  W-RECORD-TABLE              VALUE SPACES.
  3359         16  W-RC-GRP OCCURS 500 TIMES
  3360                       INDEXED BY W-RG-NDX
  3361                                  W-RG-NDX1.
  3362             20  W-RC-TEXT.
  3363                 24  W-RC-CHAR OCCURS 70 TIMES
  3364                                INDEXED BY W-RC-NDX
  3365                                           W-RC-NDX1
  3366                                 PIC  X(01).
  3367             20  W-RC-PC         PIC  9(02).
  3368             20  W-RC-SC         PIC  X(01).
  3369
  3370     12  FILLER REDEFINES W-RECORD-TABLE.
  3371         16  W-REC-CHAR OCCURS 36500 TIMES
  3372                        INDEXED BY W-RVS-NDX
  3373                                   W-RVS-NDX2
  3374                                 PIC  X(01).
  3375     12  FILLER REDEFINES W-RECORD-TABLE.
  3376         16  W-TS-GROUP OCCURS 10 TIMES
  3377                        INDEXED BY W-TS-NDX
  3378                                 PIC X(3650).
  3379
  3380     12  FILLER                  PIC  X(11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  64
* EL689.cbl
  3381                                 VALUE 'TEXT TABLE:'.
  3382     12  W-TX-TABLE                  VALUE SPACES.
  3383         16  W-TX-GRP OCCURS 500 TIMES
  3384                       INDEXED BY W-TG-NDX
  3385                                  W-TG-NDX2.
  3386             20  W-TX-TEXT.
  3387                 24  W-TX-CHAR OCCURS 70 TIMES
  3388                                    INDEXED BY W-TX-NDX
  3389                                               W-TX-NDX1
  3390                                               W-TX-NDX2
  3391                                 PIC  X(01).
  3392             20  W-TX-PC         PIC  9(02).
  3393             20  W-TX-SC         PIC  X(01).
  3394
  3395     12  FILLER                  PIC  X(11)
  3396                                 VALUE 'FILE TABLE:'.
  3397     12  W-FILE-TABLE                VALUE SPACES.
  3398         16  W-FILE-USE-IND OCCURS 20 TIMES
  3399                       INDEXED BY W-FILE-NDX
  3400                                 PIC  X(01).
  3401             88  W-FILE-NOT-USED     VALUE SPACE.
  3402             88  W-FILE-USED         VALUE 'Y'.
  3403
  3404     12  FILLER                  PIC  X(14)
  3405                                 VALUE 'END OF TABLES:'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  65
* EL689.cbl
  3407 01  ERROR-MESSAGES.
  3408     12  ER-0000                 PIC  X(04) VALUE '0000'.
  3409     12  ER-0004                 PIC  X(04) VALUE '0004'.
  3410     12  ER-0006                 PIC  X(04) VALUE '0006'.
  3411     12  ER-0008                 PIC  X(04) VALUE '0008'.
  3412     12  ER-0013                 PIC  X(04) VALUE '0013'.
  3413     12  ER-0023                 PIC  X(04) VALUE '0023'.
  3414     12  ER-0029                 PIC  X(04) VALUE '0029'.
  3415     12  ER-0033                 PIC  X(04) VALUE '0033'.
  3416     12  ER-0042                 PIC  X(04) VALUE '0042'.
  3417     12  ER-0047                 PIC  X(04) VALUE '0047'.
  3418     12  ER-0051                 PIC  X(04) VALUE '0051'.
  3419     12  ER-0066                 PIC  X(04) VALUE '0066'.
  3420     12  ER-0067                 PIC  X(04) VALUE '0067'.
  3421     12  ER-0070                 PIC  X(04) VALUE '0070'.
  3422     12  ER-0168                 PIC  X(04) VALUE '0168'.
  3423     12  ER-0169                 PIC  X(04) VALUE '0169'.
  3424     12  ER-0174                 PIC  X(04) VALUE '0174'.
  3425     12  ER-0175                 PIC  X(04) VALUE '0175'.
  3426     12  ER-0176                 PIC  X(04) VALUE '0176'.
  3427     12  ER-0177                 PIC  X(04) VALUE '0177'.
  3428     12  ER-0179                 PIC  X(04) VALUE '0179'.
  3429     12  ER-0180                 PIC  X(04) VALUE '0180'.
  3430     12  ER-0181                 PIC  X(04) VALUE '0181'.
  3431     12  ER-0182                 PIC  X(04) VALUE '0182'.
  3432     12  ER-0184                 PIC  X(04) VALUE '0184'.
  3433     12  ER-0185                 PIC  X(04) VALUE '0185'.
  3434     12  ER-0187                 PIC  X(04) VALUE '0187'.
  3435     12  ER-0188                 PIC  X(04) VALUE '0188'.
  3436     12  ER-0189                 PIC  X(04) VALUE '0189'.
  3437     12  ER-0190                 PIC  X(04) VALUE '0190'.
  3438     12  ER-0191                 PIC  X(04) VALUE '0191'.
  3439     12  ER-0215                 PIC  X(04) VALUE '0215'.
  3440     12  ER-0279                 PIC  X(04) VALUE '0279'.
  3441     12  ER-0280                 PIC  X(04) VALUE '0280'.
  3442     12  ER-0412                 PIC  X(04) VALUE '0412'.
  3443     12  ER-0413                 PIC  X(04) VALUE '0413'.
  3444     12  ER-0454                 PIC  X(04) VALUE '0454'.
  3445     12  ER-0533                 PIC  X(04) VALUE '0533'.
  3446     12  ER-0537                 PIC  X(04) VALUE '0537'.
  3447     12  ER-0715                 PIC  X(04) VALUE '0715'.
  3448     12  ER-0894                 PIC  X(04) VALUE '0894'.
  3449     12  ER-1560                 PIC  X(04) VALUE '1560'.
  3450     12  ER-1565                 PIC  X(04) VALUE '1565'.
  3451     12  ER-1778                 PIC  X(04) VALUE '1778'.
  3452     12  ER-1818                 PIC  X(04) VALUE '1818'.
  3453     12  ER-2055                 PIC  X(04) VALUE '2055'.
  3454     12  ER-2114                 PIC  X(04) VALUE '2114'.
  3455     12  ER-2208                 PIC  X(04) VALUE '2208'.
  3456     12  ER-2209                 PIC  X(04) VALUE '2209'.
  3457     12  ER-2216                 PIC  X(04) VALUE '2216'.
  3458     12  ER-2232                 PIC  X(04) VALUE '2232'.
  3459     12  ER-2369                 PIC  X(04) VALUE '2369'.
  3460     12  ER-2398                 PIC  X(04) VALUE '2398'.
  3461     12  ER-2433                 PIC  X(04) VALUE '2433'.
  3462     12  ER-2908                 PIC  X(04) VALUE '2908'.
  3463     12  ER-2999                 PIC  X(04) VALUE '2999'.
  3464     12  ER-3000                 PIC  X(04) VALUE '3000'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  66
* EL689.cbl
  3465     12  ER-3770                 PIC  X(04) VALUE '3770'.
  3466     12  ER-3771                 PIC  X(04) VALUE '3771'.
  3467     12  ER-3775                 PIC  X(04) VALUE '3775'.
  3468     12  ER-3783                 PIC  X(04) VALUE '3783'.
  3469     12  ER-7243                 PIC  X(04) VALUE '7243'.
  3470     12  ER-7245                 PIC  X(04) VALUE '7245'.
  3471     12  ER-7246                 PIC  X(04) VALUE '7246'.
  3472     12  ER-7247                 PIC  X(04) VALUE '7247'.
  3473     12  ER-7250                 PIC  X(04) VALUE '7250'.
  3474     12  ER-7365                 PIC  X(04) VALUE '7365'.
  3475     12  ER-7367                 PIC  X(04) VALUE '7367'.
  3476     12  ER-7368                 PIC  X(04) VALUE '7368'.
  3477     12  ER-7369                 PIC  X(04) VALUE '7369'.
  3478     12  ER-7370                 PIC  X(04) VALUE '7370'.
  3479     12  ER-7371                 PIC  X(04) VALUE '7371'.
  3480     12  ER-7372                 PIC  X(04) VALUE '7372'.
  3481     12  ER-7373                 PIC  X(04) VALUE '7373'.
  3482     12  ER-7374                 PIC  X(04) VALUE '7374'.
  3483     12  ER-7376                 PIC  X(04) VALUE '7376'.
  3484     12  ER-7377                 PIC  X(04) VALUE '7377'.
  3485     12  ER-7378                 PIC  X(04) VALUE '7378'.
  3486     12  ER-7379                 PIC  X(04) VALUE '7379'.
  3487     12  ER-7381                 PIC  X(04) VALUE '7381'.
  3488     12  ER-7388                 PIC  X(04) VALUE '7388'.
  3489     12  ER-7390                 PIC  X(04) VALUE '7390'.
  3490     12  ER-7393                 PIC  X(04) VALUE '7393'.
  3491     12  ER-7395                 PIC  X(04) VALUE '7395'.
  3492     12  ER-7396                 PIC  X(04) VALUE '7396'.
  3493     12  ER-7398                 PIC  X(04) VALUE '7398'.
  3494     12  ER-8965                 PIC  X(04) VALUE '8965'.
  3495     12  ER-9095                 PIC  X(04) VALUE '9095'.
  3496     12  ER-9097                 PIC  X(04) VALUE '9097'.
  3497     12  ER-9281                 PIC  X(04) VALUE '9281'.
  3498     12  ER-9283                 PIC  X(04) VALUE '9283'.
  3499     12  ER-9298                 PIC  X(04) VALUE '9298'.
  3500     12  ER-9299                 PIC  X(04) VALUE '9299'.
  3501     12  ER-9320                 PIC  X(04) VALUE '9320'.
  3502     12  ER-9327                 PIC  X(04) VALUE '9327'.
  3503     12  ER-9426                 PIC  X(04) VALUE '9426'.
  3504     12  ER-9427                 PIC  X(04) VALUE '9427'.
  3505     12  ER-9840                 PIC  X(04) VALUE '9840'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  67
* EL689.cbl
  3507*    COPY ELCAID.
  3508******************************************************************
  3509*                                                                *
  3510*                            ELCAID.                             *
  3511*                            VMOD=2.001                          *
  3512*                                                                *
  3513*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3514*                                                                *
  3515*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3516*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3517******************************************************************
  3518
  3519 01  DFHAID.
  3520   02  DFHNULL   PIC  X  VALUE  ' '.
  3521   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3522   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3523   02  DFHPEN    PIC  X  VALUE  '='.
  3524   02  DFHOPID   PIC  X  VALUE  'W'.
  3525   02  DFHPA1    PIC  X  VALUE  '%'.
  3526   02  DFHPA2    PIC  X  VALUE  '>'.
  3527   02  DFHPA3    PIC  X  VALUE  ','.
  3528   02  DFHPF1    PIC  X  VALUE  '1'.
  3529   02  DFHPF2    PIC  X  VALUE  '2'.
  3530   02  DFHPF3    PIC  X  VALUE  '3'.
  3531   02  DFHPF4    PIC  X  VALUE  '4'.
  3532   02  DFHPF5    PIC  X  VALUE  '5'.
  3533   02  DFHPF6    PIC  X  VALUE  '6'.
  3534   02  DFHPF7    PIC  X  VALUE  '7'.
  3535   02  DFHPF8    PIC  X  VALUE  '8'.
  3536   02  DFHPF9    PIC  X  VALUE  '9'.
  3537   02  DFHPF10   PIC  X  VALUE  ':'.
  3538   02  DFHPF11   PIC  X  VALUE  '#'.
  3539   02  DFHPF12   PIC  X  VALUE  '@'.
  3540   02  DFHPF13   PIC  X  VALUE  'A'.
  3541   02  DFHPF14   PIC  X  VALUE  'B'.
  3542   02  DFHPF15   PIC  X  VALUE  'C'.
  3543   02  DFHPF16   PIC  X  VALUE  'D'.
  3544   02  DFHPF17   PIC  X  VALUE  'E'.
  3545   02  DFHPF18   PIC  X  VALUE  'F'.
  3546   02  DFHPF19   PIC  X  VALUE  'G'.
  3547   02  DFHPF20   PIC  X  VALUE  'H'.
  3548   02  DFHPF21   PIC  X  VALUE  'I'.
  3549*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3550   02  DFHPF22   PIC  X  VALUE  '['.
  3551   02  DFHPF23   PIC  X  VALUE  '.'.
  3552   02  DFHPF24   PIC  X  VALUE  '<'.
  3553   02  DFHMSRE   PIC  X  VALUE  'X'.
  3554   02  DFHSTRF   PIC  X  VALUE  'h'.
  3555   02  DFHTRIG   PIC  X  VALUE  '"'.
  3556 01  FILLER    REDEFINES DFHAID.
  3557     12  FILLER                  PIC  X(08).
  3558     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  68
* EL689.cbl
  3560*    COPY ELCATTR.
  3561******************************************************************
  3562*                                                                *
  3563*                            ELCATTR.                            *
  3564*                            VMOD=2.001                          *
  3565*                                                                *
  3566*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  3567*                                                                *
  3568*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  3569*                                                                *
  3570*                   POS 1   P=PROTECTED                          *
  3571*                           U=UNPROTECTED                        *
  3572*                           S=ASKIP                              *
  3573*                   POS 2   A=ALPHA/NUMERIC                      *
  3574*                           N=NUMERIC                            *
  3575*                   POS 3   N=NORMAL                             *
  3576*                           B=BRIGHT                             *
  3577*                           D=DARK                               *
  3578*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  3579*                           OF=MODIFIED DATA TAG OFF             *
  3580*                                                                *
  3581*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  3582******************************************************************
  3583 01  ATTRIBUTE-LIST.
  3584     12  AL-PABOF            PIC X       VALUE 'Y'.
  3585     12  AL-PABON            PIC X       VALUE 'Z'.
  3586     12  AL-PADOF            PIC X       VALUE '%'.
  3587     12  AL-PADON            PIC X       VALUE '_'.
  3588     12  AL-PANOF            PIC X       VALUE '-'.
  3589     12  AL-PANON            PIC X       VALUE '/'.
  3590     12  AL-SABOF            PIC X       VALUE '8'.
  3591     12  AL-SABON            PIC X       VALUE '9'.
  3592     12  AL-SADOF            PIC X       VALUE '@'.
  3593     12  AL-SADON            PIC X       VALUE QUOTE.
  3594     12  AL-SANOF            PIC X       VALUE '0'.
  3595     12  AL-SANON            PIC X       VALUE '1'.
  3596     12  AL-UABOF            PIC X       VALUE 'H'.
  3597     12  AL-UABON            PIC X       VALUE 'I'.
  3598     12  AL-UADOF            PIC X       VALUE '<'.
  3599     12  AL-UADON            PIC X       VALUE '('.
  3600     12  AL-UANOF            PIC X       VALUE ' '.
  3601     12  AL-UANON            PIC X       VALUE 'A'.
  3602     12  AL-UNBOF            PIC X       VALUE 'Q'.
  3603     12  AL-UNBON            PIC X       VALUE 'R'.
  3604     12  AL-UNDOF            PIC X       VALUE '*'.
  3605     12  AL-UNDON            PIC X       VALUE ')'.
  3606     12  AL-UNNOF            PIC X       VALUE '&'.
  3607     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  69
* EL689.cbl
  3609*    COPY ELCDATE.
  3610******************************************************************
  3611*                                                                *
  3612*                                                                *
  3613*                            ELCDATE.                            *
  3614*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3615*                            VMOD=2.003
  3616*                                                                *
  3617*                                                                *
  3618*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3619*                 LENGTH = 200                                   *
  3620******************************************************************
  3621
  3622 01  DATE-CONVERSION-DATA.
  3623     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3624     12  DC-OPTION-CODE                PIC X.
  3625         88  BIN-TO-GREG                VALUE ' '.
  3626         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3627         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3628         88  YMD-GREG-TO-BIN            VALUE '3'.
  3629         88  MDY-GREG-TO-BIN            VALUE '4'.
  3630         88  JULIAN-TO-BIN              VALUE '5'.
  3631         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3632         88  FIND-CENTURY               VALUE '7'.
  3633         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3634         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3635         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3636         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3637         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3638         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3639         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3640         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3641         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3642         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3643         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3644         88  BIN-3-TO-GREG              VALUE 'I'.
  3645         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3646         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3647         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3648         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3649         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3650         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3651         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3652         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3653         88  THREE-CHARACTER-BIN
  3654                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3655         88  GREGORIAN-TO-BIN
  3656                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3657         88  BIN-TO-GREGORIAN
  3658                  VALUES ' ' '1' 'I' '8' 'G'.
  3659         88  JULIAN-TO-BINARY
  3660                  VALUES '5' 'C' 'E' 'F'.
  3661     12  DC-ERROR-CODE                 PIC X.
  3662         88  NO-CONVERSION-ERROR        VALUE ' '.
  3663         88  DATE-CONVERSION-ERROR
  3664                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3665         88  DATE-IS-ZERO               VALUE '1'.
  3666         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  70
* EL689.cbl
  3667         88  DATE-IS-INVALID            VALUE '3'.
  3668         88  DATE1-GREATER-DATE2        VALUE '4'.
  3669         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3670         88  DATE-INVALID-OPTION        VALUE '9'.
  3671         88  INVALID-CENTURY            VALUE 'A'.
  3672         88  ONLY-CENTURY               VALUE 'B'.
  3673         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3674         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3675     12  DC-END-OF-MONTH               PIC X.
  3676         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3677     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3678         88  USE-NORMAL-PROCESS         VALUE ' '.
  3679         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3680         88  ADJUST-UP-100-YRS          VALUE '2'.
  3681     12  FILLER                        PIC X.
  3682     12  DC-CONVERSION-DATES.
  3683         16  DC-BIN-DATE-1             PIC XX.
  3684         16  DC-BIN-DATE-2             PIC XX.
  3685         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3686         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3687                       DC-GREG-DATE-1-EDIT.
  3688             20  DC-EDIT1-MONTH        PIC 99.
  3689             20  SLASH1-1              PIC X.
  3690             20  DC-EDIT1-DAY          PIC 99.
  3691             20  SLASH1-2              PIC X.
  3692             20  DC-EDIT1-YEAR         PIC 99.
  3693         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3694         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3695                     DC-GREG-DATE-2-EDIT.
  3696             20  DC-EDIT2-MONTH        PIC 99.
  3697             20  SLASH2-1              PIC X.
  3698             20  DC-EDIT2-DAY          PIC 99.
  3699             20  SLASH2-2              PIC X.
  3700             20  DC-EDIT2-YEAR         PIC 99.
  3701         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3702         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3703                     DC-GREG-DATE-1-YMD.
  3704             20  DC-YMD-YEAR           PIC 99.
  3705             20  DC-YMD-MONTH          PIC 99.
  3706             20  DC-YMD-DAY            PIC 99.
  3707         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3708         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3709                      DC-GREG-DATE-1-MDY.
  3710             20  DC-MDY-MONTH          PIC 99.
  3711             20  DC-MDY-DAY            PIC 99.
  3712             20  DC-MDY-YEAR           PIC 99.
  3713         16  DC-GREG-DATE-1-ALPHA.
  3714             20  DC-ALPHA-MONTH        PIC X(10).
  3715             20  DC-ALPHA-DAY          PIC 99.
  3716             20  FILLER                PIC XX.
  3717             20  DC-ALPHA-CENTURY.
  3718                 24 DC-ALPHA-CEN-N     PIC 99.
  3719             20  DC-ALPHA-YEAR         PIC 99.
  3720         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3721         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3722         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3723         16  DC-JULIAN-DATE            PIC 9(05).
  3724         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  71
* EL689.cbl
  3725                                       PIC 9(05).
  3726         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3727             20  DC-JULIAN-YEAR        PIC 99.
  3728             20  DC-JULIAN-DAYS        PIC 999.
  3729         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3730         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3731         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3732     12  DATE-CONVERSION-VARIBLES.
  3733         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3734         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3735             20  FILLER                PIC 9(3).
  3736             20  HOLD-CEN-1-CCYY.
  3737                 24  HOLD-CEN-1-CC     PIC 99.
  3738                 24  HOLD-CEN-1-YY     PIC 99.
  3739             20  HOLD-CEN-1-MO         PIC 99.
  3740             20  HOLD-CEN-1-DA         PIC 99.
  3741         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3742             20  HOLD-CEN-1-R-MO       PIC 99.
  3743             20  HOLD-CEN-1-R-DA       PIC 99.
  3744             20  HOLD-CEN-1-R-CCYY.
  3745                 24  HOLD-CEN-1-R-CC   PIC 99.
  3746                 24  HOLD-CEN-1-R-YY   PIC 99.
  3747             20  FILLER                PIC 9(3).
  3748         16  HOLD-CENTURY-1-X.
  3749             20  FILLER                PIC X(3)  VALUE SPACES.
  3750             20  HOLD-CEN-1-X-CCYY.
  3751                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3752                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3753             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3754             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3755         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3756             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3757             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3758             20  HOLD-CEN-1-R-X-CCYY.
  3759                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3760                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3761             20  FILLER                PIC XXX.
  3762         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3763         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3764         16  DC-JULIAN-DATE-1          PIC 9(07).
  3765         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3766             20  DC-JULIAN-1-CCYY.
  3767                 24  DC-JULIAN-1-CC    PIC 99.
  3768                 24  DC-JULIAN-1-YR    PIC 99.
  3769             20  DC-JULIAN-DA-1        PIC 999.
  3770         16  DC-JULIAN-DATE-2          PIC 9(07).
  3771         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3772             20  DC-JULIAN-2-CCYY.
  3773                 24  DC-JULIAN-2-CC    PIC 99.
  3774                 24  DC-JULIAN-2-YR    PIC 99.
  3775             20  DC-JULIAN-DA-2        PIC 999.
  3776         16  DC-GREG-DATE-A-EDIT.
  3777             20  DC-EDITA-MONTH        PIC 99.
  3778             20  SLASHA-1              PIC X VALUE '/'.
  3779             20  DC-EDITA-DAY          PIC 99.
  3780             20  SLASHA-2              PIC X VALUE '/'.
  3781             20  DC-EDITA-CCYY.
  3782                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  72
* EL689.cbl
  3783                 24  DC-EDITA-YEAR     PIC 99.
  3784         16  DC-GREG-DATE-B-EDIT.
  3785             20  DC-EDITB-MONTH        PIC 99.
  3786             20  SLASHB-1              PIC X VALUE '/'.
  3787             20  DC-EDITB-DAY          PIC 99.
  3788             20  SLASHB-2              PIC X VALUE '/'.
  3789             20  DC-EDITB-CCYY.
  3790                 24  DC-EDITB-CENT     PIC 99.
  3791                 24  DC-EDITB-YEAR     PIC 99.
  3792         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3793         16  DC-GREG-DATE-CYMD-R REDEFINES
  3794                              DC-GREG-DATE-CYMD.
  3795             20  DC-CYMD-CEN           PIC 99.
  3796             20  DC-CYMD-YEAR          PIC 99.
  3797             20  DC-CYMD-MONTH         PIC 99.
  3798             20  DC-CYMD-DAY           PIC 99.
  3799         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3800         16  DC-GREG-DATE-MDCY-R REDEFINES
  3801                              DC-GREG-DATE-MDCY.
  3802             20  DC-MDCY-MONTH         PIC 99.
  3803             20  DC-MDCY-DAY           PIC 99.
  3804             20  DC-MDCY-CEN           PIC 99.
  3805             20  DC-MDCY-YEAR          PIC 99.
  3806    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3807        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3808    12  DC-EL310-DATE                  PIC X(21).
  3809    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  73
* EL689.cbl
  3811*    COPY ELCNWA.
  3812*****************************************************************
  3813*                                                               *
  3814*                                                               *
  3815*                            ELCNWA.                            *
  3816*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3817*                            VMOD=2.003                         *
  3818*                                                               *
  3819*            M O V E   N A M E   W O R K   A R E A.             *
  3820*                                                               *
  3821*****************************************************************.
  3822
  3823 01  WS-NAME-WORK-AREA.
  3824     05  WS-INSURED-LAST-NAME        PIC X(15).
  3825     05  WS-INSURED-1ST-NAME         PIC X(12).
  3826     05  WS-INSURED-MID-INIT         PIC X.
  3827
  3828     05  WS-NAME-WORK.
  3829         10  WS-NW                   PIC X
  3830             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  3831
  3832     05  WS-NAME-WORK2.
  3833         10  WS-NW2                  PIC X
  3834             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  3835                                        NWA-INDEX0.
  3836
  3837     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  3838                                     COMP-3.
  3839
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  74
* EL689.cbl
  3841*    COPY ELCEMIB.
  3842******************************************************************
  3843*                                                                *
  3844*                                                                *
  3845*                            ELCEMIB.                            *
  3846*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3847*                            VMOD=2.005                          *
  3848*                                                                *
  3849*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  3850*                                                                *
  3851******************************************************************
  3852 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  3853     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  3854     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  3855     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  3856     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  3857     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  3858     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  3859     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  3860     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  3861     12  EMI-SWITCH1             PIC X        VALUE '1'.
  3862         88  EMI-NO-ERRORS                    VALUE '1'.
  3863         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  3864         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  3865     12  EMI-SWITCH2             PIC X        VALUE '1'.
  3866         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  3867     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  3868         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3869         88  EMI-AREA1-FULL                   VALUE '2'.
  3870     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3871         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3872         88  EMI-AREA2-FULL                   VALUE '2'.
  3873     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3874         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3875         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3876         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3877         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3878         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3879     12  EMI-ERROR-LINES.
  3880         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3881         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3882         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3883         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3884             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3885                 24  EMI-ERR-NUM         PIC X(4).
  3886                 24  EMI-FILLER          PIC X.
  3887                 24  EMI-SEV             PIC X.
  3888                 24  FILLER              PIC X.
  3889             20  FILLER                  PIC X(02).
  3890     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3891         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3892             20  EMI-ERROR-NUMBER    PIC X(4).
  3893             20  EMI-FILL            PIC X.
  3894             20  EMI-SEVERITY        PIC X.
  3895             20  FILLER              PIC X.
  3896             20  EMI-ERROR-TEXT.
  3897                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3898                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  75
* EL689.cbl
  3899     12  EMI-SEVERITY-SAVE           PIC X.
  3900         88  EMI-NOTE                    VALUE 'N'.
  3901         88  EMI-WARNING                 VALUE 'W'.
  3902         88  EMI-FORCABLE                VALUE 'F'.
  3903         88  EMI-FATAL                   VALUE 'X'.
  3904     12  EMI-MESSAGE-FLAG            PIC X.
  3905         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3906         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3907     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3908     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3909         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3910         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3911         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3912     12  emi-claim-no                pic x(7).
  3913     12  emi-claim-type              pic x(6).
  3914     12  FILLER                      PIC X(124)  VALUE SPACES.
  3915     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3916     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3917     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3918     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  3919 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  76
* EL689.cbl
  3921*    COPY ELCLOGOF.
  3922******************************************************************
  3923*                                                                *
  3924*                                                                *
  3925*                            ELCLOGOF.                           *
  3926*                            VMOD=2.001                          *
  3927*                                                                *
  3928*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  3929*                                                                *
  3930******************************************************************
  3931 01  CLASIC-LOGOFF.
  3932     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  3933     12  LOGOFF-TEXT.
  3934         16  FILLER          PIC X(5)    VALUE SPACES.
  3935         16  LOGOFF-MSG.
  3936             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  3937             20  FILLER      PIC X       VALUE SPACES.
  3938             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  3939         16  FILLER          PIC X(80)
  3940           VALUE '* YOU ARE NOW LOGGED OFF'.
  3941         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  3942         16  FILLER          PIC X       VALUE QUOTE.
  3943         16  LOGOFF-SYS-MSG  PIC X(17)
  3944           VALUE 'S CLAS-IC SYSTEM '.
  3945     12  TEXT-MESSAGES.
  3946         16  UNACCESS-MSG    PIC X(29)
  3947             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  3948         16  PGMIDERR-MSG    PIC X(17)
  3949             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  77
* EL689.cbl
  3951*    COPY ELCSCTM.
  3952******************************************************************
  3953*                                                                *
  3954*                                                                *
  3955*                            ELCSCTM                             *
  3956*                            VMOD=2.001                          *
  3957*                                                                *
  3958*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  3959*                                                                *
  3960******************************************************************
  3961 01  SECURITY-MESSAGE.
  3962     12  FILLER                          PIC X(30)
  3963            VALUE '** LOGIC SECURITY VIOLATION -'.
  3964     12  SM-READ                         PIC X(6).
  3965     12  FILLER                          PIC X(5)
  3966            VALUE ' PGM='.
  3967     12  SM-PGM                          PIC X(6).
  3968     12  FILLER                          PIC X(5)
  3969            VALUE ' OPR='.
  3970     12  SM-PROCESSOR-ID                 PIC X(4).
  3971     12  FILLER                          PIC X(6)
  3972            VALUE ' TERM='.
  3973     12  SM-TERMID                       PIC X(4).
  3974     12  FILLER                          PIC XX   VALUE SPACE.
  3975     12  SM-JUL-DATE                     PIC 9(5).
  3976     12  FILLER                          PIC X    VALUE SPACE.
  3977     12  SM-TIME                         PIC 99.99.
  3978
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  78
* EL689.cbl
  3980*    COPY ELCSCRTY.
  3981******************************************************************
  3982*                                                                *
  3983*                                                                *
  3984*                            ELCSCRTY                            *
  3985*                            VMOD=2.001                          *
  3986*                                                                *
  3987*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  3988*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  3989*        SAVED IN PI-SECURITY-ADDRESS.                           *
  3990*                                                                *
  3991******************************************************************
  3992 01  SECURITY-CONTROL.
  3993     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  3994     12  FILLER                       PIC XX    VALUE 'SC'.
  3995     12  SC-CREDIT-CODES.
  3996         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  3997             20  SC-CREDIT-DISPLAY    PIC X.
  3998             20  SC-CREDIT-UPDATE     PIC X.
  3999     12  SC-CLAIMS-CODES.
  4000         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  4001             20  SC-CLAIMS-DISPLAY    PIC X.
  4002             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  79
* EL689.cbl
  4004
  4005 01  W-TS-WORK-AREA              PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  80
* EL689.cbl
  4007****************************************************************
  4008*
  4009* Copyright (c) 2007-2013 Dell Inc.
  4010* All rights reserved.
  4011*
  4012****************************************************************
  4013 01  DFHEIV.
  4014   02  DFHEIV0               PIC X(35).
  4015   02  DFHEIV1               PIC X(08).
  4016   02  DFHEIV2               PIC X(08).
  4017   02  DFHEIV3               PIC X(08).
  4018   02  DFHEIV4               PIC X(06).
  4019   02  DFHEIV5               PIC X(04).
  4020   02  DFHEIV6               PIC X(04).
  4021   02  DFHEIV7               PIC X(02).
  4022   02  DFHEIV8               PIC X(02).
  4023   02  DFHEIV9               PIC X(01).
  4024   02  DFHEIV10              PIC S9(7) COMP-3.
  4025   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4026   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4027   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4028   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4029   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4030   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4031   02  DFHEIV17              PIC X(04).
  4032   02  DFHEIV18              PIC X(04).
  4033   02  DFHEIV19              PIC X(04).
  4034   02  DFHEIV20              USAGE IS POINTER.
  4035   02  DFHEIV21              USAGE IS POINTER.
  4036   02  DFHEIV22              USAGE IS POINTER.
  4037   02  DFHEIV23              USAGE IS POINTER.
  4038   02  DFHEIV24              USAGE IS POINTER.
  4039   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4040   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4041   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4042   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4043   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4044   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4045   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4046   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4047   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4048   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4049   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4050   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4051   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4052   02  FILLER                PIC X(02).
  4053   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4054   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4055   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4056   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4057   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4058   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4059   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4060 LINKAGE  SECTION.
  4061*****************************************************************
  4062*                                                               *
  4063* Copyright (c) 2007-2013 Dell Inc.                             *
  4064* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  81
* EL689.cbl
  4065*                                                               *
  4066*****************************************************************
  4067 01  dfheiblk.
  4068     02  eibtime          pic s9(7) comp-3.
  4069     02  eibdate          pic s9(7) comp-3.
  4070     02  eibtrnid         pic x(4).
  4071     02  eibtaskn         pic s9(7) comp-3.
  4072     02  eibtrmid         pic x(4).
  4073     02  dfheigdi         pic s9(4) comp.
  4074     02  eibcposn         pic s9(4) comp.
  4075     02  eibcalen         pic s9(4) comp.
  4076     02  eibaid           pic x(1).
  4077     02  eibfiller1       pic x(1).
  4078     02  eibfn            pic x(2).
  4079     02  eibfiller2       pic x(2).
  4080     02  eibrcode         pic x(6).
  4081     02  eibfiller3       pic x(2).
  4082     02  eibds            pic x(8).
  4083     02  eibreqid         pic x(8).
  4084     02  eibrsrce         pic x(8).
  4085     02  eibsync          pic x(1).
  4086     02  eibfree          pic x(1).
  4087     02  eibrecv          pic x(1).
  4088     02  eibsend          pic x(1).
  4089     02  eibatt           pic x(1).
  4090     02  eibeoc           pic x(1).
  4091     02  eibfmh           pic x(1).
  4092     02  eibcompl         pic x(1).
  4093     02  eibsig           pic x(1).
  4094     02  eibconf          pic x(1).
  4095     02  eiberr           pic x(1).
  4096     02  eibrldbk         pic x(1).
  4097     02  eiberrcd         pic x(4).
  4098     02  eibsynrb         pic x(1).
  4099     02  eibnodat         pic x(1).
  4100     02  eibfiller5       pic x(2).
  4101     02  eibresp          pic s9(8) comp.
  4102     02  eibresp2         pic s9(8) comp.
  4103     02  dfheigdj         pic s9(4) comp.
  4104     02  dfheigdk         pic s9(4) comp.
  4105 01  DFHCOMMAREA                 PIC X(1024).
  4106 01  var  pic x(30).
  4107
  4108*    COPY ERCACCT.
  4109******************************************************************
  4110*                                                                *
  4111*                                                                *
  4112*                            ERCACCT                             *
  4113*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4114*                            VMOD=2.031                          *
  4115*                                                                *
  4116*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4117*                                                                *
  4118*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4119*   VSAM ACCOUNT MASTER FILES.                                   *
  4120*                                                                *
  4121*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4122*                                                                *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  82
* EL689.cbl
  4123*   FILE TYPE = VSAM,KSDS                                        *
  4124*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4125*                                                                *
  4126*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4127*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4128*                                                                *
  4129*   LOG = NO                                                     *
  4130*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4131*                                                                *
  4132*                                                                *
  4133******************************************************************
  4134*                   C H A N G E   L O G
  4135*
  4136* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4137*-----------------------------------------------------------------
  4138*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4139* EFFECTIVE    NUMBER
  4140*-----------------------------------------------------------------
  4141* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4142* 092705    2005050300006  PEMA  ADD SPP LEASES
  4143* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4144* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4145* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4146* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4147* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4148* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  4149******************************************************************
  4150
  4151 01  ACCOUNT-MASTER.
  4152     12  AM-RECORD-ID                      PIC XX.
  4153         88  VALID-AM-ID                      VALUE 'AM'.
  4154
  4155     12  AM-CONTROL-PRIMARY.
  4156         16  AM-COMPANY-CD                 PIC X.
  4157         16  AM-MSTR-CNTRL.
  4158             20  AM-CONTROL-A.
  4159                 24  AM-CARRIER            PIC X.
  4160                 24  AM-GROUPING.
  4161                     28 AM-GROUPING-PREFIX PIC XXX.
  4162                     28 AM-GROUPING-PRIME  PIC XXX.
  4163                 24  AM-STATE              PIC XX.
  4164                 24  AM-ACCOUNT.
  4165                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4166                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4167             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4168                                           PIC X(19).
  4169             20  AM-CNTRL-B.
  4170                 24  AM-EXPIRATION-DT      PIC XX.
  4171                 24  FILLER                PIC X(4).
  4172             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4173                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4174
  4175     12  AM-CONTROL-BY-VAR-GRP.
  4176         16  AM-COMPANY-CD-A1              PIC X.
  4177         16  AM-VG-CARRIER                 PIC X.
  4178         16  AM-VG-GROUPING                PIC X(6).
  4179         16  AM-VG-STATE                   PIC XX.
  4180         16  AM-VG-ACCOUNT                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  83
* EL689.cbl
  4181         16  AM-VG-DATE.
  4182             20  AM-VG-EXPIRATION-DT       PIC XX.
  4183             20  FILLER                    PIC X(4).
  4184         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4185                                           PIC 9(11)      COMP-3.
  4186     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4187         16  FILLER                        PIC X(10).
  4188         16  AM-VG-KEY3.
  4189             20  AM-VG3-ACCOUNT            PIC X(10).
  4190             20  AM-VG3-EXP-DT             PIC XX.
  4191         16  FILLER                        PIC X(4).
  4192     12  AM-MAINT-INFORMATION.
  4193         16  AM-LAST-MAINT-DT              PIC XX.
  4194         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4195         16  AM-LAST-MAINT-USER            PIC X(4).
  4196         16  FILLER                        PIC XX.
  4197
  4198     12  AM-EFFECTIVE-DT                   PIC XX.
  4199     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4200
  4201     12  AM-PREV-DATES  COMP-3.
  4202         16  AM-PREV-EXP-DT                PIC 9(11).
  4203         16  AM-PREV-EFF-DT                PIC 9(11).
  4204
  4205     12  AM-REPORT-CODE-1                  PIC X(10).
  4206     12  AM-REPORT-CODE-2                  PIC X(10).
  4207
  4208     12  AM-CITY-CODE                      PIC X(4).
  4209     12  AM-COUNTY-PARISH                  PIC X(6).
  4210
  4211     12  AM-NAME                           PIC X(30).
  4212     12  AM-PERSON                         PIC X(30).
  4213     12  AM-ADDRS                          PIC X(30).
  4214     12  AM-CITY.
  4215         16  AM-ADDR-CITY                  PIC X(28).
  4216         16  AM-ADDR-STATE                 PIC XX.
  4217     12  AM-ZIP.
  4218         16  AM-ZIP-PRIME.
  4219             20  AM-ZIP-PRI-1ST            PIC X.
  4220                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4221             20  FILLER                    PIC X(4).
  4222         16  AM-ZIP-PLUS4                  PIC X(4).
  4223     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4224         16  AM-CAN-POSTAL-1               PIC XXX.
  4225         16  AM-CAN-POSTAL-2               PIC XXX.
  4226         16  FILLER                        PIC XXX.
  4227     12  AM-TEL-NO.
  4228         16  AM-AREA-CODE                  PIC 999.
  4229         16  AM-TEL-PRE                    PIC 999.
  4230         16  AM-TEL-NBR                    PIC 9(4).
  4231     12  AM-TEL-LOC                        PIC X.
  4232         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4233         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4234
  4235     12  AM-COMM-STRUCTURE.
  4236         16  AM-DEFN-1.
  4237             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4238                 24  AM-AGT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  84
* EL689.cbl
  4239                     28  AM-AGT-PREFIX     PIC X(4).
  4240                     28  AM-AGT-PRIME      PIC X(6).
  4241                 24  AM-COM-TYP            PIC X.
  4242                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4243                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4244                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4245                 24  AM-RECALC-LV-INDIC    PIC X.
  4246                 24  AM-RETRO-LV-INDIC     PIC X.
  4247                 24  AM-GL-CODES           PIC X.
  4248                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4249                 24  FILLER                PIC X(01).
  4250         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4251             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4252                 24  FILLER                PIC X(11).
  4253                 24  AM-L-COMA             PIC XXX.
  4254                 24  AM-J-COMA             PIC XXX.
  4255                 24  AM-A-COMA             PIC XXX.
  4256                 24  FILLER                PIC X(6).
  4257
  4258     12  AM-COMM-CHANGE-STATUS             PIC X.
  4259         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4260
  4261     12  AM-CSR-CODE                       PIC X(4).
  4262
  4263     12  AM-BILLING-STATUS                 PIC X.
  4264         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4265         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4266     12  AM-AUTO-REFUND-SW                 PIC X.
  4267         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4268         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4269     12  AM-GPCD                           PIC 99.
  4270     12  AM-IG                             PIC X.
  4271         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4272         88  AM-HAS-GROUP                     VALUE '2'.
  4273     12  AM-STATUS                         PIC X.
  4274         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4275         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4276         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4277         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4278         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4279         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4280         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  4281         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  4282         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  4283         88  AM-ACCOUNT-PENDING               VALUE '9'.
  4284     12  AM-REMIT-TO                       PIC 99.
  4285     12  AM-ID-NO                          PIC X(11).
  4286
  4287     12  AM-CAL-TABLE                      PIC XX.
  4288     12  AM-LF-DEVIATION                   PIC XXX.
  4289     12  AM-AH-DEVIATION                   PIC XXX.
  4290     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4291     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4292     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4293     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4294     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4295     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4296
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  85
* EL689.cbl
  4297     12  AM-USER-FIELDS.
  4298         16  AM-FLD-1                      PIC XX.
  4299         16  AM-FLD-2                      PIC XX.
  4300         16  AM-FLD-3                      PIC XX.
  4301         16  AM-FLD-4                      PIC XX.
  4302         16  AM-FLD-5                      PIC XX.
  4303
  4304     12  AM-1ST-PROD-DATE.
  4305         16  AM-1ST-PROD-YR                PIC XX.
  4306         16  AM-1ST-PROD-MO                PIC XX.
  4307         16  AM-1ST-PROD-DA                PIC XX.
  4308     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4309     12  AM-CERTS-PURGED-DATE.
  4310         16  AM-PUR-YR                     PIC XX.
  4311         16  AM-PUR-MO                     PIC XX.
  4312         16  AM-PUR-DA                     PIC XX.
  4313     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4314     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4315     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4316     12  AM-INACTIVE-DATE.
  4317         16  AM-INA-MO                     PIC 99.
  4318         16  AM-INA-DA                     PIC 99.
  4319         16  AM-INA-YR                     PIC 99.
  4320     12  AM-AR-HI-CERT-DATE                PIC XX.
  4321
  4322     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4323     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4324
  4325     12  AM-OB-PAYMENT-MODE                PIC X.
  4326         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4327         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4328         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4329         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4330
  4331     12  AM-AH-ONLY-INDICATOR              PIC X.
  4332         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4333         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4334
  4335     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4336
  4337     12  AM-OVER-SHORT.
  4338         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4339         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4340
  4341     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4342     12  AM-DCC-CLP-STATE                  PIC XX.
  4343
  4344     12  AM-RECALC-COMM                    PIC X.
  4345     12  AM-RECALC-REIN                    PIC X.
  4346
  4347     12  AM-REI-TABLE                      PIC XXX.
  4348     12  AM-REI-ET-LF                      PIC X.
  4349     12  AM-REI-ET-AH                      PIC X.
  4350     12  AM-REI-PE-LF                      PIC X.
  4351     12  AM-REI-PE-AH                      PIC X.
  4352     12  AM-REI-PRT-ST                     PIC X.
  4353     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4354     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  86
* EL689.cbl
  4355     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4356     12  AM-REI-GROUP-A                    PIC X(6).
  4357     12  AM-REI-MORT                       PIC X(4).
  4358     12  AM-REI-PRT-OW                     PIC X.
  4359     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4360     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4361     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4362     12  AM-REI-GROUP-B                    PIC X(6).
  4363
  4364     12  AM-TRUST-TYPE                     PIC X(2).
  4365
  4366     12  AM-EMPLOYER-STMT-USED             PIC X.
  4367     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4368
  4369     12  AM-STD-AH-TYPE                    PIC XX.
  4370     12  AM-EARN-METHODS.
  4371         16  AM-EARN-METHOD-R              PIC X.
  4372             88 AM-REF-RL-R78                 VALUE 'R'.
  4373             88 AM-REF-RL-PR                  VALUE 'P'.
  4374             88 AM-REF-RL-MEAN                VALUE 'M'.
  4375             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4376         16  AM-EARN-METHOD-L              PIC X.
  4377             88 AM-REF-LL-R78                 VALUE 'R'.
  4378             88 AM-REF-LL-PR                  VALUE 'P'.
  4379             88 AM-REF-LL-MEAN                VALUE 'M'.
  4380             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4381         16  AM-EARN-METHOD-A              PIC X.
  4382             88 AM-REF-AH-R78                 VALUE 'R'.
  4383             88 AM-REF-AH-PR                  VALUE 'P'.
  4384             88 AM-REF-AH-MEAN                VALUE 'M'.
  4385             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4386             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4387             88 AM-REF-AH-NET                 VALUE 'N'.
  4388
  4389     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4390     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4391     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4392
  4393     12  AM-RET-Y-N                        PIC X.
  4394     12  AM-RET-P-E                        PIC X.
  4395     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4396     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4397     12  AM-RET-GRP                        PIC X(6).
  4398     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4399         16  AM-POOL-PRIME                 PIC XXX.
  4400         16  AM-POOL-SUB                   PIC XXX.
  4401     12  AM-RETRO-EARNINGS.
  4402         16  AM-RET-EARN-R                 PIC X.
  4403         16  AM-RET-EARN-L                 PIC X.
  4404         16  AM-RET-EARN-A                 PIC X.
  4405     12  AM-RET-ST-TAX-USE                 PIC X.
  4406         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4407         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4408     12  AM-RETRO-BEG-EARNINGS.
  4409         16  AM-RET-BEG-EARN-R             PIC X.
  4410         16  AM-RET-BEG-EARN-L             PIC X.
  4411         16  AM-RET-BEG-EARN-A             PIC X.
  4412     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  87
* EL689.cbl
  4413     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4414
  4415     12  AM-USER-SELECT-OPTIONS.
  4416         16  AM-USER-SELECT-1              PIC X(10).
  4417         16  AM-USER-SELECT-2              PIC X(10).
  4418         16  AM-USER-SELECT-3              PIC X(10).
  4419         16  AM-USER-SELECT-4              PIC X(10).
  4420         16  AM-USER-SELECT-5              PIC X(10).
  4421
  4422     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4423
  4424     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4425
  4426     12  AM-RPT045A-SWITCH                 PIC X.
  4427         88  RPT045A-OFF                   VALUE 'N'.
  4428
  4429     12  AM-INSURANCE-LIMITS.
  4430         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4431         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4432
  4433     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4434         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4435
  4436     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4437         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4438         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4439
  4440     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4441
  4442     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4443     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4444     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4445     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4446     12  AM-DCC-UEF-STATE                  PIC XX.
  4447     12  FILLER                            PIC XXX.
  4448     12  AM-REPORT-CODE-3                  PIC X(10).
  4449*    12  FILLER                            PIC X(22).
  4450
  4451     12  AM-RESERVE-DATE.
  4452         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4453         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4454         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4455
  4456     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4457     12  AM-NOTIFICATION-TYPES.
  4458         16  AM-NOTIF-OF-LETTERS           PIC X.
  4459         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4460         16  AM-NOTIF-OF-REPORTS           PIC X.
  4461         16  AM-NOTIF-OF-STATUS            PIC X.
  4462
  4463     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4464         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4465         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4466         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4467         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4468
  4469     12  AM-BENEFIT-CONTROLS.
  4470         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  88
* EL689.cbl
  4471             20  AM-BENEFIT-CODE           PIC XX.
  4472             20  AM-BENEFIT-TYPE           PIC X.
  4473             20  AM-BENEFIT-REVISION       PIC XXX.
  4474             20  AM-BENEFIT-REM-TERM       PIC X.
  4475             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4476             20  FILLER                    PIC XX.
  4477         16  FILLER                        PIC X(80).
  4478
  4479     12  AM-TRANSFER-DATA.
  4480         16  AM-TRANSFERRED-FROM.
  4481             20  AM-TRNFROM-CARRIER        PIC X.
  4482             20  AM-TRNFROM-GROUPING.
  4483                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4484                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4485             20  AM-TRNFROM-STATE          PIC XX.
  4486             20  AM-TRNFROM-ACCOUNT.
  4487                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4488                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4489             20  AM-TRNFROM-DTE            PIC XX.
  4490         16  AM-TRANSFERRED-TO.
  4491             20  AM-TRNTO-CARRIER          PIC X.
  4492             20  AM-TRNTO-GROUPING.
  4493                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4494                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4495             20  AM-TRNTO-STATE            PIC XX.
  4496             20  AM-TRNTO-ACCOUNT.
  4497                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4498                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4499             20  AM-TRNTO-DTE              PIC XX.
  4500         16  FILLER                        PIC X(10).
  4501
  4502     12  AM-SAVED-REMIT-TO                 PIC 99.
  4503
  4504     12  AM-COMM-STRUCTURE-SAVED.
  4505         16  AM-DEFN-1-SAVED.
  4506             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4507                 24  AM-AGT-SV             PIC X(10).
  4508                 24  AM-COM-TYP-SV         PIC X.
  4509                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4510                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4511                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4512                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4513                 24  FILLER                PIC X.
  4514                 24  AM-GL-CODES-SV        PIC X.
  4515                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4516                 24  FILLER                PIC X.
  4517         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4518             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4519                 24  FILLER                PIC X(11).
  4520                 24  AM-L-COMA-SV          PIC XXX.
  4521                 24  AM-J-COMA-SV          PIC XXX.
  4522                 24  AM-A-COMA-SV          PIC XXX.
  4523                 24  FILLER                PIC X(6).
  4524
  4525     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4526         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4527            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4528            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  89
* EL689.cbl
  4529            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4530
  4531     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4532     12  FILLER                            PIC X(120).
  4533
  4534     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4535         16  AM-CONTROL-NAME               PIC X(30).
  4536         16  AM-EXECUTIVE-ONE.
  4537             20  AM-EXEC1-NAME             PIC X(15).
  4538             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4539                                                          COMP-3.
  4540             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4541                                                          COMP-3.
  4542         16  AM-EXECUTIVE-TWO.
  4543             20  AM-EXEC2-NAME             PIC X(15).
  4544             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4545                                                          COMP-3.
  4546             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4547                                                          COMP-3.
  4548
  4549     12  AM-RETRO-ADDITIONAL-DATA.
  4550         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4551         16  AM-RETRO-PREM-P-E             PIC X.
  4552         16  AM-RETRO-CLMS-P-I             PIC X.
  4553         16  AM-RETRO-RET-BRACKET-LF.
  4554             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4555                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4556                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4557             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4558                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4559                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4560             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4561                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4562                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4563         16  AM-RETRO-RET-BRACKET-AH.
  4564             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4565                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4566                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4567                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4568             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4569                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4570                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4571             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4572                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4573                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4574
  4575     12  AM-COMMENTS.
  4576         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4577
  4578     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4579         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4580         16  AM-FLI-BILLING-CODE           PIC X.
  4581         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4582         16  AM-FLI-UNITED-IDENT           PIC X.
  4583         16  AM-FLI-INTEREST-LOST-DATA.
  4584             20  AM-FLI-BANK-NO            PIC X(5).
  4585             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4586             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  90
* EL689.cbl
  4587             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4588         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4589             20  AM-FLI-AGT                PIC X(9).
  4590             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4591             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4592         16  FILLER                        PIC X(102).
  4593
  4594     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4595         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4596             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4597             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4598             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4599             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4600             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4601         16  FILLER                          PIC X(10).
  4602******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  91
* EL689.cbl
  4604*    COPY ERCARCH.
  4605******************************************************************
  4606*                                                                *
  4607*                            ERCARCH.                            *
  4608*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4609*                            VMOD=2.002                          *
  4610*                                                                *
  4611*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4612*                                                                *
  4613*   FILE TYPE = VSAM,KSDS                                        *
  4614*   RECORD SIZE = 250  RECFORM = FIXED                           *
  4615*                                                                *
  4616*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  4617*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  4618*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  4619*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  4620*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  4621*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  4622*                                                                *
  4623*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4624******************************************************************
  4625*                   C H A N G E   L O G
  4626*
  4627* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4628*-----------------------------------------------------------------
  4629*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4630* EFFECTIVE    NUMBER
  4631*-----------------------------------------------------------------
  4632* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  4633* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4634* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4635******************************************************************
  4636 01  LETTER-ARCHIVE.
  4637     12  LA-RECORD-ID                PIC  X(02).
  4638         88  LA-VALID-ID                VALUE 'LA'.
  4639
  4640     12  LA-CONTROL-PRIMARY.
  4641         16  LA-COMPANY-CD           PIC  X(01).
  4642         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  4643
  4644     12  LA-CONTROL-BY-CERT-RESP.
  4645         16  LA-COMPANY-CD-A2        PIC  X(01).
  4646         16  LA-CERT-NO-A2.
  4647             20  LA-CERT-PRIME-A2    PIC  X(10).
  4648             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  4649         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  4650             20  LA-RESP-PERSON-A2   PIC  X(10).
  4651             20  LA-TYPE-A2          PIC  X(01).
  4652         16  LA-CARRIER-A2           PIC  X(01).
  4653         16  LA-GROUPING-A2          PIC  X(06).
  4654         16  LA-STATE-A2             PIC  X(02).
  4655         16  LA-ACCOUNT-A2           PIC  X(10).
  4656         16  LA-EFFECT-DATE-A2       PIC  X(02).
  4657         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  4658
  4659     12  LA-CONTROL-BY-FORM.
  4660         16  LA-COMPANY-CD-A3        PIC  X(01).
  4661         16  LA-FORM-A3              PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  92
* EL689.cbl
  4662         16  LA-CARRIER-A3           PIC  X(01).
  4663         16  LA-GROUPING-A3          PIC  X(06).
  4664         16  LA-STATE-A3             PIC  X(02).
  4665         16  LA-ACCOUNT-A3           PIC  X(10).
  4666         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  4667
  4668     12  LA-CONTROL-BY-PROCESSOR.
  4669         16  LA-COMPANY-CD-A4        PIC  X(01).
  4670         16  LA-PROCESSOR-CD         PIC  X(04).
  4671         16  LA-CARRIER-A4           PIC  X(01).
  4672         16  LA-GROUPING-A4          PIC  X(06).
  4673         16  LA-STATE-A4             PIC  X(02).
  4674         16  LA-ACCOUNT-A4           PIC  X(10).
  4675         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  4676
  4677     12  LA-CONTROL-BY-KEY-FIELDS.
  4678         16  LA-COMPANY-CD-A5        PIC  X(01).
  4679         16  LA-CARRIER-A5           PIC  X(01).
  4680         16  LA-GROUPING-A5          PIC  X(06).
  4681         16  LA-STATE-A5             PIC  X(02).
  4682         16  LA-ACCOUNT-A5           PIC  X(10).
  4683         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  4684
  4685     12  LA-CONTROL-BY-GROUP-CODE.
  4686         16  LA-COMPANY-CD-A6        PIC  X(01).
  4687         16  LA-ENTRY-A6.
  4688             20  LA-FILLER           PIC  X(02).
  4689             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  4690         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  4691
  4692     12  FILLER                      PIC  X(09).
  4693
  4694     12  LA-HEADER-RECORD.
  4695         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  4696         16  LA-CREATION-DATE        PIC  X(02).
  4697         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  4698         16  LA-FINAL-ACT-DATE       REDEFINES
  4699               LA-FOLLOW-UP-DATE     PIC  X(02).
  4700         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  4701         16  LA-NO-OF-COPIES         PIC S9(01).
  4702         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  4703         16  LA-REPLY-DATE           PIC  X(02).
  4704         16  LA-RESEND-DATES.
  4705             20  LA-RESEND-DATE      PIC  X(02).
  4706             20  LA-SENT-DATE        PIC  X(02).
  4707             20  FILLER              PIC  X(08).
  4708         16  LA-SOURCE-INFORMATION.
  4709             20  LA-DATA-SOURCE      PIC  X(01).
  4710             20  LA-ADDR-SOURCE      PIC  X(01).
  4711         16  LA-STATUS               PIC  X(01).
  4712             88  LA-STATUS-ACTIVE         VALUE 'A'.
  4713             88  LA-STATUS-COMPLETED      VALUE 'C'.
  4714             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  4715             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  4716             88  LA-STATUS-PURGED         VALUE 'P'.
  4717             88  LA-STATUS-VOIDED         VALUE 'V'.
  4718         16  LA-LAST-RESENT-PRINT-DATE
  4719                                     PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  93
* EL689.cbl
  4720         16  LA-PRINT-RESTRICTION    PIC  X(01).
  4721             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4722                                          VALUE 'C'.
  4723             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4724                                          VALUE 'F'.
  4725             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4726                                          VALUE 'P'.
  4727         16  LA-PURGED-DATE          PIC  X(02).
  4728         16  LA-VOIDED-DATE          PIC  X(02).
  4729         16  LA-RESEND-LETR          PIC  X(4).
  4730         16  FILLER                  PIC  X(08).
  4731*        16  LA-RESEND-LETR-2        PIC  X(4).
  4732*        16  LA-RESEND-LETR-3        PIC  X(4).
  4733*        16  FILLER                  PIC  X(59).
  4734         16  LA-ARCHIVE-STATUS       PIC  X.
  4735             88  LA-TEMP                VALUE 'T'.
  4736             88  LA-QWS                 VALUE 'Q'.
  4737             88  LA-BATCH               VALUE 'B'.
  4738         16  LA-FINAL-ACT-IND        PIC  X(1).
  4739         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  4740         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  4741         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  4742                                     PIC X(4).
  4743         16  FILLER                  PIC  X(42).
  4744*        16  FILLER                  PIC  X(71).
  4745         16  LA-LAST-MAINT-DATE      PIC  X(2).
  4746         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  4747         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  4748                                     PIC  X(4).
  4749         16  LA-LAST-UPDATED-BY      PIC  X(4).
  4750
  4751******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  94
* EL689.cbl
  4753*    COPY ERCARCT.
  4754******************************************************************
  4755*                                                                *
  4756*                            ERCARCT.                            *
  4757*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4758*                            VMOD=2.002                          *
  4759*                                                                *
  4760*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  4761*                                                                *
  4762*   FILE TYPE = VSAM,KSDS                                        *
  4763*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  4764*                                                                *
  4765*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  4766*                                                                *
  4767*   LOG = NO                                                     *
  4768*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4769******************************************************************
  4770*                   C H A N G E   L O G
  4771*
  4772* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4773*-----------------------------------------------------------------
  4774*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4775* EFFECTIVE    NUMBER
  4776*-----------------------------------------------------------------
  4777* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4778******************************************************************
  4779 01  LETTER-ARCHIVE-TEXT.
  4780     12  LT-RECORD-ID                PIC  X(02).
  4781         88  LT-VALID-ID                VALUE 'LT'.
  4782
  4783     12  LT-CONTROL-PRIMARY.
  4784         16  LT-COMPANY-CD           PIC  X(01).
  4785         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  4786         16  LT-RECORD-TYPE          PIC  X(01).
  4787             88  LT-ADDRESS-DATA        VALUE '1'.
  4788             88  LT-TEXT-DATA           VALUE '2'.
  4789             88  LT-COMMENT-DATA        VALUE '3'.
  4790         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  4791
  4792     12  FILLER                      PIC  X(28).
  4793     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  4794
  4795     12  LT-TEXT-RECORD.
  4796         16  LT-LETTER-TEXT OCCURS 20 TIMES
  4797                            INDEXED BY LT-NDX.
  4798             20  LT-TEXT-LINE        PIC  X(70).
  4799             20  LT-SKIP-CONTROL     PIC  X(02).
  4800                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  4801                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  4802             20  FILLER              PIC  X(08).
  4803
  4804     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  4805         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  4806             20  LT-COMMENT-LINE     PIC X(69).
  4807             20  LT-COMMENT-CHG-DT   PIC X(02).
  4808             20  LT-COMMENT-CHG-BY   PIC X(04).
  4809             20  FILLER              PIC X(05).
  4810
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  95
* EL689.cbl
  4812*    COPY ELCCERT.
  4813******************************************************************
  4814*                                                                *
  4815*                            ELCCERT.                            *
  4816*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4817*                            VMOD=2.013                          *
  4818*                                                                *
  4819*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4820*                                                                *
  4821*   FILE TYPE = VSAM,KSDS                                        *
  4822*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4823*                                                                *
  4824*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4825*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4826*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4827*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4828*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4829*                                                                *
  4830*   LOG = YES                                                    *
  4831*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4832******************************************************************
  4833*                   C H A N G E   L O G
  4834*
  4835* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4836*-----------------------------------------------------------------
  4837*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4838* EFFECTIVE    NUMBER
  4839*-----------------------------------------------------------------
  4840* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4841* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4842* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4843* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4844* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4845* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4846* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4847* 032612  CR2011110200001  PEMA  AHL CHANGES
  4848* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4849* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4850* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4851******************************************************************
  4852
  4853 01  CERTIFICATE-MASTER.
  4854     12  CM-RECORD-ID                      PIC XX.
  4855         88  VALID-CM-ID                      VALUE 'CM'.
  4856
  4857     12  CM-CONTROL-PRIMARY.
  4858         16  CM-COMPANY-CD                 PIC X.
  4859         16  CM-CARRIER                    PIC X.
  4860         16  CM-GROUPING.
  4861             20  CM-GROUPING-PREFIX        PIC X(3).
  4862             20  CM-GROUPING-PRIME         PIC X(3).
  4863         16  CM-STATE                      PIC XX.
  4864         16  CM-ACCOUNT.
  4865             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4866             20  CM-ACCOUNT-PRIME          PIC X(6).
  4867         16  CM-CERT-EFF-DT                PIC XX.
  4868         16  CM-CERT-NO.
  4869             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  96
* EL689.cbl
  4870             20  CM-CERT-SFX               PIC X.
  4871
  4872     12  CM-CONTROL-BY-NAME.
  4873         16  CM-COMPANY-CD-A1              PIC X.
  4874         16  CM-INSURED-LAST-NAME          PIC X(15).
  4875         16  CM-INSURED-INITIALS.
  4876             20  CM-INSURED-INITIAL1       PIC X.
  4877             20  CM-INSURED-INITIAL2       PIC X.
  4878
  4879     12  CM-CONTROL-BY-SSN.
  4880         16  CM-COMPANY-CD-A2              PIC X.
  4881         16  CM-SOC-SEC-NO.
  4882             20  CM-SSN-STATE              PIC XX.
  4883             20  CM-SSN-ACCOUNT            PIC X(6).
  4884             20  CM-SSN-LN3.
  4885                 25  CM-INSURED-INITIALS-A2.
  4886                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4887                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4888                 25 CM-PART-LAST-NAME-A2         PIC X.
  4889
  4890     12  CM-CONTROL-BY-CERT-NO.
  4891         16  CM-COMPANY-CD-A4              PIC X.
  4892         16  CM-CERT-NO-A4                 PIC X(11).
  4893
  4894     12  CM-CONTROL-BY-MEMB.
  4895         16  CM-COMPANY-CD-A5              PIC X.
  4896         16  CM-MEMBER-NO.
  4897             20  CM-MEMB-STATE             PIC XX.
  4898             20  CM-MEMB-ACCOUNT           PIC X(6).
  4899             20  CM-MEMB-LN4.
  4900                 25  CM-INSURED-INITIALS-A5.
  4901                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4902                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4903                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4904
  4905     12  CM-INSURED-PROFILE-DATA.
  4906         16  CM-INSURED-FIRST-NAME.
  4907             20  CM-INSURED-1ST-INIT       PIC X.
  4908             20  FILLER                    PIC X(9).
  4909         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4910         16  CM-INSURED-SEX                PIC X.
  4911             88  CM-SEX-MALE                  VALUE 'M'.
  4912             88  CM-SEX-FEMAL                 VALUE 'F'.
  4913         16  CM-INSURED-JOINT-AGE          PIC 99.
  4914         16  CM-JOINT-INSURED-NAME.
  4915             20  CM-JT-LAST-NAME           PIC X(15).
  4916             20  CM-JT-FIRST-NAME.
  4917                 24  CM-JT-1ST-INIT        PIC X.
  4918                 24  FILLER                PIC X(9).
  4919             20  CM-JT-INITIAL             PIC X.
  4920
  4921     12  CM-LIFE-DATA.
  4922         16  CM-LF-BENEFIT-CD              PIC XX.
  4923         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4924         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4925         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4926         16  CM-LF-DEV-CODE                PIC XXX.
  4927         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  97
* EL689.cbl
  4928         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4929         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4930         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4931         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4932         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4933         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4934         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4935         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4936         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4937         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4938         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4939         16  cm-temp-epiq                  pic xx.
  4940             88  EPIQ-CLASS                  value 'EQ'.
  4941*        16  FILLER                        PIC XX.
  4942
  4943     12  CM-AH-DATA.
  4944         16  CM-AH-BENEFIT-CD              PIC XX.
  4945         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4946         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4947         16  CM-AH-DEV-CODE                PIC XXX.
  4948         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4949         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4950         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4951         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4952         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4953         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4954         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4955         16  CM-AH-PAID-THRU-DT            PIC XX.
  4956             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4957         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4958         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4959         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4960         16  FILLER                        PIC X.
  4961
  4962     12  CM-LOAN-INFORMATION.
  4963         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4964         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4965                                           PIC S9(5)V99  COMP-3.
  4966         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4967         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4968         16  CM-PAY-FREQUENCY              PIC S99.
  4969         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4970         16  CM-RATE-CLASS                 PIC XX.
  4971         16  CM-BENEFICIARY                PIC X(25).
  4972         16  CM-POLICY-FORM-NO             PIC X(12).
  4973         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4974         16  CM-LAST-ADD-ON-DT             PIC XX.
  4975         16  CM-DEDUCTIBLE-AMOUNTS.
  4976             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4977             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4978         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4979             20  CM-RESIDENT-STATE         PIC XX.
  4980             20  CM-RATE-CODE              PIC X(4).
  4981             20  FILLER                    PIC XX.
  4982         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4983             20  CM-LOAN-OFFICER           PIC X(5).
  4984             20  FILLER                    PIC XXX.
  4985         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  98
* EL689.cbl
  4986         16  CM-UNDERWRITING-CODE          PIC X.
  4987             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4988         16  CM-POST-CARD-IND              PIC X.
  4989         16  CM-REF-INTERFACE-SW           PIC X.
  4990         16  CM-PREMIUM-TYPE               PIC X.
  4991             88  CM-SING-PRM                  VALUE '1'.
  4992             88  CM-O-B-COVERAGE              VALUE '2'.
  4993             88  CM-OPEN-END                  VALUE '3'.
  4994         16  CM-IND-GRP-TYPE               PIC X.
  4995             88  CM-INDIVIDUAL                VALUE 'I'.
  4996             88  CM-GROUP                     VALUE 'G'.
  4997         16  CM-SKIP-CODE                  PIC X.
  4998             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4999             88  SKIP-JULY                    VALUE '1'.
  5000             88  SKIP-AUGUST                  VALUE '2'.
  5001             88  SKIP-SEPTEMBER               VALUE '3'.
  5002             88  SKIP-JULY-AUG                VALUE '4'.
  5003             88  SKIP-AUG-SEPT                VALUE '5'.
  5004             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5005             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5006             88  SKIP-JUNE                    VALUE '8'.
  5007             88  SKIP-JUNE-JULY               VALUE '9'.
  5008             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5009             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5010         16  CM-PAYMENT-MODE               PIC X.
  5011             88  PAY-MONTHLY                  VALUE SPACE.
  5012             88  PAY-WEEKLY                   VALUE '1'.
  5013             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5014             88  PAY-BI-WEEKLY                VALUE '3'.
  5015             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5016         16  CM-LOAN-NUMBER                PIC X(8).
  5017         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5018         16  CM-OLD-LOF                    PIC XXX.
  5019*        16  CM-LOAN-OFFICER               PIC XXX.
  5020         16  CM-REIN-TABLE                 PIC XXX.
  5021         16  CM-SPECIAL-REIN-CODE          PIC X.
  5022         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5023         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5024         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5025
  5026     12  CM-STATUS-DATA.
  5027         16  CM-ENTRY-STATUS               PIC X.
  5028         16  CM-ENTRY-DT                   PIC XX.
  5029
  5030         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5031         16  CM-LF-CANCEL-DT               PIC XX.
  5032         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5033
  5034         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5035         16  CM-LF-DEATH-DT                PIC XX.
  5036         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5037
  5038         16  CM-LF-CURRENT-STATUS          PIC X.
  5039             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5040                                                'M' '4' '5' '9'.
  5041             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5042             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5043             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  99
* EL689.cbl
  5044             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5045             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5046             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5047             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5048             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5049             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5050             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5051             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5052             88  CM-LF-DECLINED               VALUE 'D'.
  5053             88  CM-LF-VOIDED                 VALUE 'V'.
  5054
  5055         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5056         16  CM-AH-CANCEL-DT               PIC XX.
  5057         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5058
  5059         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5060         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5061         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5062
  5063         16  CM-AH-CURRENT-STATUS          PIC X.
  5064             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5065                                                'M' '4' '5' '9'.
  5066             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5067             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5068             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5069             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5070             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5071             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5072             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5073             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5074             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5075             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5076             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5077             88  CM-AH-DECLINED               VALUE 'D'.
  5078             88  CM-AH-VOIDED                 VALUE 'V'.
  5079
  5080         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5081             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5082             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5083             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5084         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5085
  5086         16  CM-ENTRY-BATCH                PIC X(6).
  5087         16  CM-LF-EXIT-BATCH              PIC X(6).
  5088         16  CM-AH-EXIT-BATCH              PIC X(6).
  5089         16  CM-LAST-MONTH-END             PIC XX.
  5090
  5091     12  CM-NOTE-SW                        PIC X.
  5092         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5093         88  CERT-NOTES-PRESENT               VALUE '1'.
  5094         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5095         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5096         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5097         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5098         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5099         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5100     12  CM-COMP-EXCP-SW                   PIC X.
  5101         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 100
* EL689.cbl
  5102         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5103     12  CM-INSURED-ADDRESS-SW             PIC X.
  5104         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5105         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5106
  5107*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5108     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5109     12  FILLER                            PIC X.
  5110
  5111*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5112     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5113     12  FILLER                            PIC X.
  5114*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5115     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  5116
  5117     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5118         88  CERT-ADDED-BATCH                 VALUE ' '.
  5119         88  CERT-ADDED-ONLINE                VALUE '1'.
  5120         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5121         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5122         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5123     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5124         88  CERT-AS-LOADED                   VALUE ' '.
  5125         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5126         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5127         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5128         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5129         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5130         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5131         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5132
  5133     12  CM-ACCOUNT-COMM-PCTS.
  5134         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5135         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5136
  5137     12  CM-USER-FIELD                     PIC X.
  5138     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5139     12  CM-CLP-STATE                      PIC XX.
  5140     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5141     12  CM-USER-RESERVED                  PIC XXX.
  5142     12  FILLER REDEFINES CM-USER-RESERVED.
  5143         16  CM-AH-CLASS-CD                PIC XX.
  5144         16  F                             PIC X.
  5145******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 101
* EL689.cbl
  5147*    COPY ERCCHEK.
  5148******************************************************************
  5149*                                                                *
  5150*                                                                *
  5151*                            ERCCHEK                             *
  5152*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5153*                            VMOD=2.008                          *
  5154*                                                                *
  5155*   FILE DESCRIPTION = CHECK RECORDS                             *
  5156*                                                                *
  5157*   FILE TYPE = VSAM,KSDS                                        *
  5158*   RECORD SIZE = 600    RECFORM = FIXED                         *
  5159*                                                                *
  5160*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  5161*       ALTERNATE INDEX = NONE                                   *
  5162*                                                                *
  5163*   LOG = YES                                                    *
  5164*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5165******************************************************************
  5166*                   C H A N G E   L O G
  5167*
  5168* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5169*-----------------------------------------------------------------
  5170*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5171* EFFECTIVE    NUMBER
  5172*-----------------------------------------------------------------
  5173* 021414    2003053000001  PEMA  changes for auto chk request
  5174******************************************************************
  5175 01  CHECK-RECORDS.
  5176     12  CH-RECORD-ID                      PIC XX.
  5177         88  VALID-CH-ID                      VALUE 'CH'.
  5178
  5179     12  CH-CONTROL-PRIMARY.
  5180         16  CH-COMPANY-CD                 PIC X.
  5181         16  CH-CARRIER                    PIC X.
  5182         16  CH-GROUPING                   PIC X(6).
  5183         16  CH-STATE                      PIC XX.
  5184         16  CH-ACCOUNT                    PIC X(10).
  5185         16  CH-CERT-EFF-DT                PIC XX.
  5186         16  CH-CERT-NO.
  5187             20  CH-CERT-PRIME             PIC X(10).
  5188             20  CH-CERT-SFX               PIC X.
  5189         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  5190
  5191     12  CH-RECORDED-DT                    PIC XX.
  5192     12  CH-RECORDED-BY                    PIC X(4).
  5193     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  5194
  5195     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  5196     12  CH-CHECK-NO                       PIC X(7).
  5197     12  CH-REASON-FOR-CHECK               PIC X(25).
  5198     12  CH-CHECK-WRITTEN-DT               PIC XX.
  5199     12  FILLER                            PIC X.
  5200
  5201     12  CH-PAYEE-INFO.
  5202         16  CH-PAYEE-NAME-1               PIC X(30).
  5203         16  CH-PAYEE-NAME-2               PIC X(30).
  5204         16  CH-PAYEE-ADDRESS-1            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 102
* EL689.cbl
  5205         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  5206         16  CH-PAYEE-CITY-ST.
  5207             20  CH-PAYEE-CITY             PIC X(28).
  5208             20  CH-PAYEE-STATE            PIC XX.
  5209         16  CH-PAYEE-ZIP-CODE.
  5210             20  CH-PAYEE-ZIP.
  5211                 24  CH-ZIP-PRI-1ST        PIC X.
  5212                     88  CH-CANADIAN-POST-CODE
  5213                                           VALUES 'A' THRU 'Z'.
  5214                 24  FILLER                PIC X(4).
  5215             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  5216         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  5217             20  CH-CAN-POSTAL-1           PIC XXX.
  5218             20  CH-CAN-POSTAL-2           PIC XXX.
  5219             20  FILLER                    PIC XXX.
  5220
  5221     12  CH-CHECK-STUB-TEXT.
  5222         16  CH-STUB-LINE-1                PIC X(30).
  5223         16  CH-TEXT-LINE-1                PIC X(50).
  5224         16  CH-TEXT-LINE-2                PIC X(50).
  5225         16  CH-TEXT-LINE-3                PIC X(40).
  5226     12  CH-RETURN-TO                      PIC X(30).
  5227
  5228     12  CH-COMPENSATION-CONTROL.
  5229         16  CH-COMP-CARRIER               PIC X.
  5230         16  CH-COMP-GROUPING              PIC X(6).
  5231         16  CH-COMP-FIN-RESP              PIC X(10).
  5232         16  CH-COMP-ACCOUNT               PIC X(10).
  5233
  5234     12  CH-CREDIT-SELECT-DT               PIC XX.
  5235     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  5236     12  CH-PAYEE-CODE                     PIC X(6).
  5237
  5238     12  CH-VOID-DATA.
  5239         20  CH-VOID-DT                    PIC XX.
  5240         20  CH-VOID-BY                    PIC X(4).
  5241         20  CH-VOID-REASON                PIC X(25).
  5242
  5243     12  CH-APPROVAL-DATA.
  5244         20  CH-APPROVAL-DT                PIC XX.
  5245         20  CH-APPROVAL-STATUS            PIC X.
  5246             88  CH-IN-LIMBO                  VALUE ' '.
  5247             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  5248             88  CH-APPROVED                  VALUE 'A'.
  5249             88  CH-DENIED                    VALUE 'D'.
  5250         20  CH-APPROVED-BY                PIC XXXX.
  5251     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  5252             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5253     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  5254
  5255     12  ch-released-dt                    pic xx.
  5256     12  ch-check-cashed-dt                pic xx.
  5257     12  FILLER                            PIC X.
  5258*    12  CH-CHECK-REFERENCE                PIC X(12).
  5259     12  CH-CHECK-ORIGIN-SW                PIC X.
  5260             88  CH-REFUND-CHECK              VALUE 'R'.
  5261             88  CH-MAINT-CHECK               VALUE 'M'.
  5262
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 103
* EL689.cbl
  5263     12  CH-CANC-DT                        PIC XX.
  5264     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  5265     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  5266
  5267     12  CH-INSURED-NAME                   PIC X(28).
  5268
  5269     12  ch-released-by                    pic x(4).
  5270     12  ch-csr                            pic x(4).
  5271     12  ch-deduct-commission              pic x.
  5272         88  ch-deduct-comm                  value 'Y'.
  5273         88  ch-do-not-deduct-comm           value 'N'.
  5274
  5275     12  FILLER                            PIC X(11).
  5276*    12  CH-LETTER-TABLE.
  5277*        16  CH-LETTERS OCCURS 3 TIMES
  5278*                       INDEXED BY CH-LT-NDX
  5279*                                          PIC X(04).
  5280
  5281     12  FILLER                            PIC X(07).
  5282
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 104
* EL689.cbl
  5284*    COPY ELCCNTL.
  5285******************************************************************
  5286*                                                                *
  5287*                                                                *
  5288*                            ELCCNTL.                            *
  5289*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5290*                            VMOD=2.059                          *
  5291*                                                                *
  5292*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5293*                                                                *
  5294*   FILE TYPE = VSAM,KSDS                                        *
  5295*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5296*                                                                *
  5297*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5298*       ALTERNATE INDEX = NONE                                   *
  5299*                                                                *
  5300*   LOG = YES                                                    *
  5301*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5302******************************************************************
  5303*                   C H A N G E   L O G
  5304*
  5305* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5306*-----------------------------------------------------------------
  5307*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5308* EFFECTIVE    NUMBER
  5309*-----------------------------------------------------------------
  5310* 082503                   PEMA  ADD BENEFIT GROUP
  5311* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5312* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5313* 092705    2005050300006  PEMA  ADD SPP LEASES
  5314* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5315* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5316* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5317* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5318* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5319* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5320* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5321* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5322* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5323* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5324* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5325******************************************************************
  5326*
  5327 01  CONTROL-FILE.
  5328     12  CF-RECORD-ID                       PIC XX.
  5329         88  VALID-CF-ID                        VALUE 'CF'.
  5330
  5331     12  CF-CONTROL-PRIMARY.
  5332         16  CF-COMPANY-ID                  PIC XXX.
  5333         16  CF-RECORD-TYPE                 PIC X.
  5334             88  CF-COMPANY-MASTER              VALUE '1'.
  5335             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5336             88  CF-STATE-MASTER                VALUE '3'.
  5337             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5338             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5339             88  CF-CARRIER-MASTER              VALUE '6'.
  5340             88  CF-MORTALITY-MASTER            VALUE '7'.
  5341             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 105
* EL689.cbl
  5342             88  CF-TERMINAL-MASTER             VALUE '9'.
  5343             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5344             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5345             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5346             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5347             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5348             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5349             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5350             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5351             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5352         16  CF-ACCESS-CD-GENL              PIC X(4).
  5353         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5354             20  CF-PROCESSOR               PIC X(4).
  5355         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5356             20  CF-STATE-CODE              PIC XX.
  5357             20  FILLER                     PIC XX.
  5358         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5359             20  FILLER                     PIC XX.
  5360             20  CF-HI-BEN-IN-REC           PIC XX.
  5361         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5362             20  FILLER                     PIC XXX.
  5363             20  CF-CARRIER-CNTL            PIC X.
  5364         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5365             20  FILLER                     PIC XX.
  5366             20  CF-HI-TYPE-IN-REC          PIC 99.
  5367         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5368             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5369                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5370             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5371             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5372         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5373             20  FILLER                     PIC X.
  5374             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5375         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5376             20  FILLER                     PIC XX.
  5377             20  CF-MORTGAGE-PLAN           PIC XX.
  5378         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5379
  5380     12  CF-LAST-MAINT-DT                   PIC XX.
  5381     12  CF-LAST-MAINT-BY                   PIC X(4).
  5382     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5383
  5384     12  CF-RECORD-BODY                     PIC X(728).
  5385
  5386
  5387****************************************************************
  5388*             COMPANY MASTER RECORD                            *
  5389****************************************************************
  5390
  5391     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5392         16  CF-COMPANY-ADDRESS.
  5393             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5394             20  CF-CL-IN-CARE-OF           PIC X(30).
  5395             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5396             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5397             20  CF-CL-CITY-STATE           PIC X(30).
  5398             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5399             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 106
* EL689.cbl
  5400         16  CF-COMPANY-CD                  PIC X.
  5401         16  CF-COMPANY-PASSWORD            PIC X(8).
  5402         16  CF-SECURITY-OPTION             PIC X.
  5403             88  ALL-SECURITY                   VALUE '1'.
  5404             88  COMPANY-VERIFY                 VALUE '2'.
  5405             88  PROCESSOR-VERIFY               VALUE '3'.
  5406             88  NO-SECURITY                    VALUE '4'.
  5407             88  ALL-BUT-TERM                   VALUE '5'.
  5408         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5409             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5410         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5411             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5412         16  CF-INFORCE-LOCATION            PIC X.
  5413             88  CERTS-ARE-ONLINE               VALUE '1'.
  5414             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5415             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5416         16  CF-LOWER-CASE-LETTERS          PIC X.
  5417         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5418             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5419             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5420             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5421             88  CF-ACCNT-CNTL                  VALUE '3'.
  5422             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5423
  5424         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5425         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5426
  5427         16  CF-LGX-CREDIT-USER             PIC X.
  5428             88  CO-IS-NOT-USER                 VALUE 'N'.
  5429             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5430
  5431         16 CF-CREDIT-CALC-CODES.
  5432             20  CF-CR-REM-TERM-CALC PIC X.
  5433               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5434               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5435               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5436               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5437               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5438               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5439               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5440             20  CF-CR-R78-METHOD           PIC X.
  5441               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5442               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5443
  5444         16  CF-CLAIM-CONTROL-COUNTS.
  5445             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5446                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5447
  5448             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5449                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5450
  5451             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5452                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5453
  5454             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5455                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5456
  5457         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 107
* EL689.cbl
  5458
  5459         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5460             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5461             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5462             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5463             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5464                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5465                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5466             20  CF-CO-PREM-REJECT-SW       PIC X.
  5467                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5468                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5469             20  CF-CO-REF-REJECT-SW        PIC X.
  5470                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5471                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5472
  5473         16  CF-CO-REPORTING-DT             PIC XX.
  5474         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5475         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5476           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5477           88  CF-CO-MONTH-END                  VALUE '1'.
  5478
  5479         16  CF-LGX-CLAIM-USER              PIC X.
  5480             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5481             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5482
  5483         16  CF-CREDIT-EDIT-CONTROLS.
  5484             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5485             20  CF-MIN-AGE                 PIC 99.
  5486             20  CF-DEFAULT-AGE             PIC 99.
  5487             20  CF-MIN-TERM                PIC S999      COMP-3.
  5488             20  CF-MAX-TERM                PIC S999      COMP-3.
  5489             20  CF-DEFAULT-SEX             PIC X.
  5490             20  CF-JOINT-AGE-INPUT         PIC X.
  5491                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5492             20  CF-BIRTH-DATE-INPUT        PIC X.
  5493                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5494             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5495                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5496                 88  CF-ZERO-CARRIER            VALUE '1'.
  5497                 88  CF-ZERO-GROUPING           VALUE '2'.
  5498                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5499             20  CF-EDIT-SW                 PIC X.
  5500                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5501             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5502             20  CF-CR-PR-METHOD            PIC X.
  5503               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5504               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5505             20  FILLER                     PIC X.
  5506
  5507         16  CF-CREDIT-MISC-CONTROLS.
  5508             20  CF-REIN-TABLE-SW           PIC X.
  5509                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5510             20  CF-COMP-TABLE-SW           PIC X.
  5511                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5512             20  CF-EXPERIENCE-RETENTION-AGE
  5513                                            PIC S9        COMP-3.
  5514             20  CF-CONVERSION-DT           PIC XX.
  5515             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 108
* EL689.cbl
  5516             20  CF-RUN-FREQUENCY-SW        PIC X.
  5517                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5518                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5519
  5520             20  CF-CR-CHECK-NO-CONTROL.
  5521                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5522                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5523                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5524                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5525                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5526                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5527
  5528                 24  CF-CR-CHECK-COUNT       REDEFINES
  5529                     CF-CR-CHECK-COUNTER      PIC X(4).
  5530
  5531                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5532                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5533
  5534                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5535                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5536                 24  CF-MAIL-PROCESSING       PIC X.
  5537                     88  MAIL-PROCESSING          VALUE 'Y'.
  5538
  5539         16  CF-MISC-SYSTEM-CONTROL.
  5540             20  CF-SYSTEM-C                 PIC X.
  5541                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5542             20  CF-SYSTEM-D                 PIC X.
  5543                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5544             20  CF-SOC-SEC-NO-SW            PIC X.
  5545                 88  SOC-SEC-NO-USED             VALUE '1'.
  5546             20  CF-MEMBER-NO-SW             PIC X.
  5547                 88  MEMBER-NO-USED              VALUE '1'.
  5548             20  CF-TAX-ID-NUMBER            PIC X(11).
  5549             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5550             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5551                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5552                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5553                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5554                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5555             20  CF-SYSTEM-E                 PIC X.
  5556                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5557
  5558         16  CF-LGX-LIFE-USER               PIC X.
  5559             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5560             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5561
  5562         16  CF-CR-MONTH-END-DT             PIC XX.
  5563
  5564         16  CF-FILE-MAINT-DATES.
  5565             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5566                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5567             20  CF-LAST-BATCH       REDEFINES
  5568                 CF-LAST-BATCH-NO               PIC X(4).
  5569             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5570             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5571             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5572             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5573             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 109
* EL689.cbl
  5574             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5575             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5576             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5577             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5578             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5579
  5580         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5581         16  FILLER                         PIC X.
  5582
  5583         16  CF-ALT-MORT-CODE               PIC X(4).
  5584         16  CF-MEMBER-CAPTION              PIC X(10).
  5585
  5586         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5587             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5588             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5589             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5590             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5591             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5592
  5593         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5594
  5595         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5596         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5597         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5598         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5599
  5600         16  CF-AH-OVERRIDE-L1              PIC X.
  5601         16  CF-AH-OVERRIDE-L2              PIC XX.
  5602         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5603         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5604
  5605         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5606         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5607
  5608         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5609         16  CF-AR-LAST-EL860-DT            PIC XX.
  5610         16  CF-MP-MONTH-END-DT             PIC XX.
  5611
  5612         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5613         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5614             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5615
  5616         16  CF-AR-MONTH-END-DT             PIC XX.
  5617
  5618         16  CF-CRDTCRD-USER                PIC X.
  5619             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5620             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5621
  5622         16  CF-CC-MONTH-END-DT             PIC XX.
  5623
  5624         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5625
  5626         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5627             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5628             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5629             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5630         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5631         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 110
* EL689.cbl
  5632         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5633         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5634             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5635             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5636         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5637         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5638         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5639             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5640         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5641
  5642         16  CF-CL-ZIP-CODE.
  5643             20  CF-CL-ZIP-PRIME.
  5644                 24  CF-CL-ZIP-1ST          PIC X.
  5645                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5646                 24  FILLER                 PIC X(4).
  5647             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5648         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5649             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5650             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5651             20  FILLER                     PIC XXX.
  5652
  5653         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5654         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5655         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5656         16  CF-CO-OPTION-START-DATE        PIC XX.
  5657         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5658           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5659                                                      '3' '4'.
  5660           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5661           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5662           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5663           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5664           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5665           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5666
  5667         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5668
  5669         16  CF-PAYMENT-APPROVAL-LEVELS.
  5670             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5671             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5672             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5673             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5674             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5675             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5676
  5677         16  CF-END-USER-REPORTING-USER     PIC X.
  5678             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5679             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5680
  5681         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5682             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5683             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5684
  5685         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5686
  5687         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5688         16  FILLER                         PIC X.
  5689
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 111
* EL689.cbl
  5690         16  CF-CREDIT-ARCHIVE-CNTL.
  5691             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5692             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5693             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5694
  5695         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5696
  5697         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5698             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5699             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5700
  5701         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5702             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5703             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5704
  5705         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5706
  5707         16  CF-CO-ACH-ID-CODE              PIC  X.
  5708             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5709             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5710             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5711         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5712         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5713         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5714         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5715         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5716         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5717         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5718         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5719         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5720                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5721         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5722                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5723
  5724         16  CF-CO-OVER-SHORT.
  5725             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5726             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5727
  5728*         16  FILLER                         PIC X(102).
  5729         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5730             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5731             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5732
  5733         16  CF-AH-APPROVAL-DAYS.
  5734             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5735             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5736             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5737             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5738
  5739         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5740
  5741         16  CF-APPROV-LEV-5.
  5742             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5743             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5744             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5745
  5746         16  FILLER                         PIC X(68).
  5747****************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 112
* EL689.cbl
  5748*             PROCESSOR/USER RECORD                            *
  5749****************************************************************
  5750
  5751     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5752         16  CF-PROCESSOR-NAME              PIC X(30).
  5753         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5754         16  CF-PROCESSOR-TITLE             PIC X(26).
  5755         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5756                 88  MESSAGE-YES                VALUE 'Y'.
  5757                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5758
  5759*****************************************************
  5760****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5761****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5762****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5763****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5764*****************************************************
  5765
  5766         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5767             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5768             20  CF-APPLICATION-FORCE       PIC X.
  5769             20  CF-INDIVIDUAL-APP.
  5770                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5771                     28  CF-BROWSE-APP      PIC X.
  5772                     28  CF-UPDATE-APP      PIC X.
  5773
  5774         16  CF-CURRENT-TERM-ON             PIC X(4).
  5775         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5776             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5777             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5778             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5779             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5780             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5781             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5782             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5783         16  CF-PROCESSOR-CARRIER           PIC X.
  5784             88  NO-CARRIER-SECURITY            VALUE ' '.
  5785         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5786             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5787         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5788             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5789         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5790             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5791
  5792         16  CF-PROC-SYS-ACCESS-SW.
  5793             20  CF-PROC-CREDIT-CLAIMS-SW.
  5794                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5795                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5796                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5797                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5798             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5799                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5800                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5801             20  CF-PROC-LIFE-GNRLDGR-SW.
  5802                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5803                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5804                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5805                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 113
* EL689.cbl
  5806             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5807                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5808                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5809         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5810             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5811             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5812         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5813
  5814         16  CF-APPROVAL-LEVEL                  PIC X.
  5815             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5816             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5817             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5818             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5819             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5820
  5821         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5822
  5823         16  CF-LANGUAGE-TYPE                   PIC X.
  5824             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5825             88  CF-LANG-IS-FR                      VALUE 'F'.
  5826
  5827         16  CF-CSR-IND                         PIC X.
  5828         16  FILLER                             PIC X(239).
  5829
  5830****************************************************************
  5831*             PROCESSOR/REMINDERS RECORD                       *
  5832****************************************************************
  5833
  5834     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5835         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5836             20  CF-START-REMIND-DT         PIC XX.
  5837             20  CF-END-REMIND-DT           PIC XX.
  5838             20  CF-REMINDER-TEXT           PIC X(50).
  5839         16  FILLER                         PIC X(296).
  5840
  5841
  5842****************************************************************
  5843*             STATE MASTER RECORD                              *
  5844****************************************************************
  5845
  5846     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5847         16  CF-STATE-ABBREVIATION          PIC XX.
  5848         16  CF-STATE-NAME                  PIC X(25).
  5849         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5850         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5851             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5852             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5853             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5854             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5855                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5856                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5857             20  CF-ST-PREM-REJECT-SW       PIC X.
  5858                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5859                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5860             20  CF-ST-REF-REJECT-SW        PIC X.
  5861                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5862                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5863         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 114
* EL689.cbl
  5864         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5865         16  CF-ST-REFUND-RULES.
  5866             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5867             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5868             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5869         16  CF-ST-FST-PMT-EXTENSION.
  5870             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5871             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5872                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5873                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5874                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5875                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5876         16  CF-ST-STATE-CALL.
  5877             20  CF-ST-CALL-UNEARNED        PIC X.
  5878             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5879             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5880         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5881             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5882             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5883         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5884         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5885         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5886         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5887         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5888         16  FILLER                         PIC X.
  5889         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5890             20  CF-ST-BENEFIT-CD           PIC XX.
  5891             20  CF-ST-BENEFIT-KIND         PIC X.
  5892                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5893                 88  CF-ST-AH-KIND              VALUE 'A'.
  5894             20  CF-ST-REM-TERM-CALC        PIC X.
  5895                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5896                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5897                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5898                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5899                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5900                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5901                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5902                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5903
  5904             20  CF-ST-REFUND-CALC          PIC X.
  5905                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5906                 88  ST-REFD-BY-R78             VALUE '1'.
  5907                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5908                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5909                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5910                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5911                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5912                 88  ST-REFD-UTAH               VALUE '7'.
  5913                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5914                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5915                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5916
  5917             20  CF-ST-EARNING-CALC         PIC X.
  5918                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5919                 88  ST-EARN-BY-R78             VALUE '1'.
  5920                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5921                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 115
* EL689.cbl
  5922                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5923                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5924                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5925                 88  ST-EARN-MEAN               VALUE '8'.
  5926                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5927
  5928             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5929                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5930                 88  ST-OVRD-BY-R78             VALUE '1'.
  5931                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5932                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5933                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5934                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5935                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5936                 88  ST-OVRD-MEAN               VALUE '8'.
  5937                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5938             20  cf-st-extra-periods        pic 9.
  5939*            20  FILLER                     PIC X.
  5940
  5941         16  CF-ST-COMMISSION-CAPS.
  5942             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5943             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5944             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5945             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5946         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5947                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5948                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5949                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5950
  5951         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5952
  5953         16  CF-ST-STATUTORY-INTEREST.
  5954             20  CF-ST-STAT-DATE-FROM       PIC X.
  5955                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5956                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5957             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5958             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5959             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5960             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5961             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5962
  5963         16  CF-ST-OVER-SHORT.
  5964             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5965             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5966
  5967         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5968
  5969         16  CF-ST-RT-CALC                  PIC X.
  5970
  5971         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5972         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5973         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5974         16  CF-ST-RF-LR-CALC               PIC X.
  5975         16  CF-ST-RF-LL-CALC               PIC X.
  5976         16  CF-ST-RF-LN-CALC               PIC X.
  5977         16  CF-ST-RF-AH-CALC               PIC X.
  5978         16  CF-ST-RF-CP-CALC               PIC X.
  5979*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 116
* EL689.cbl
  5980*CIDMOD         16  FILLER                         PIC X(192).
  5981         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5982             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5983         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5984         16  CF-ST-VFY-2ND-BENE             PIC X.
  5985         16  CF-ST-CAUSAL-STATE             PIC X.
  5986         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5987         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5988         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5989             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5990         16  CF-ST-NET-ONLY-STATE           PIC X.
  5991             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5992         16  cf-commission-cap-required     pic x.
  5993         16  CF-ST-GA-COMMISSION-CAPS.
  5994             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5995             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5996             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5997             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5998         16  CF-ST-TOT-COMMISSION-CAPS.
  5999             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  6000             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  6001             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  6002             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  6003         16  FILLER                         PIC X(156).
  6004
  6005****************************************************************
  6006*             BENEFIT MASTER RECORD                            *
  6007****************************************************************
  6008
  6009     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6010         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  6011             20  CF-BENEFIT-CODE            PIC XX.
  6012             20  CF-BENEFIT-NUMERIC  REDEFINES
  6013                 CF-BENEFIT-CODE            PIC XX.
  6014             20  CF-BENEFIT-ALPHA           PIC XXX.
  6015             20  CF-BENEFIT-DESCRIP         PIC X(10).
  6016             20  CF-BENEFIT-COMMENT         PIC X(10).
  6017
  6018             20  CF-LF-COVERAGE-TYPE        PIC X.
  6019                 88  CF-REDUCING                VALUE 'R'.
  6020                 88  CF-LEVEL                   VALUE 'L' 'P'.
  6021
  6022             20  CF-SPECIAL-CALC-CD         PIC X.
  6023                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  6024                 88  CF-NP-0-MO-INT             VALUE 'A'.
  6025                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  6026                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  6027                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  6028                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  6029                 88  CF-FARM-PLAN               VALUE 'F'.
  6030                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  6031                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  6032                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  6033                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  6034                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  6035                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  6036                 88  CF-PRUDENTIAL              VALUE 'P'.
  6037                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 117
* EL689.cbl
  6038                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  6039                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  6040                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  6041                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  6042                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  6043
  6044             20  CF-JOINT-INDICATOR         PIC X.
  6045                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  6046
  6047*            20  FILLER                     PIC X(12).
  6048             20  cf-maximum-benefits        pic s999 comp-3.
  6049             20  FILLER                     PIC X(09).
  6050             20  CF-BENEFIT-CATEGORY        PIC X.
  6051             20  CF-LOAN-TYPE               PIC X(8).
  6052
  6053             20  CF-CO-REM-TERM-CALC        PIC X.
  6054                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  6055                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  6056                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  6057                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  6058                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  6059
  6060             20  CF-CO-EARNINGS-CALC        PIC X.
  6061                 88  CO-EARN-BY-R78             VALUE '1'.
  6062                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  6063                 88  CO-EARN-AS-CALIF           VALUE '3'.
  6064                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  6065                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  6066                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  6067                 88  CO-EARN-AS-MEAN            VALUE '8'.
  6068                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  6069
  6070             20  CF-CO-REFUND-CALC          PIC X.
  6071                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  6072                 88  CO-REFD-BY-R78             VALUE '1'.
  6073                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  6074                 88  CO-REFD-AS-CALIF           VALUE '3'.
  6075                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  6076                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  6077                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  6078                 88  CO-REFD-MEAN               VALUE '8'.
  6079                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  6080                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  6081                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  6082
  6083             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  6084                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  6085                 88  CO-OVRD-BY-R78             VALUE '1'.
  6086                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  6087                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  6088                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  6089                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  6090                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  6091                 88  CO-OVRD-MEAN               VALUE '8'.
  6092                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  6093
  6094             20  CF-CO-BEN-I-G-CD           PIC X.
  6095                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 118
* EL689.cbl
  6096                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  6097                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  6098
  6099         16  FILLER                         PIC X(304).
  6100
  6101
  6102****************************************************************
  6103*             CARRIER MASTER RECORD                            *
  6104****************************************************************
  6105
  6106     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6107         16  CF-ADDRESS-DATA.
  6108             20  CF-MAIL-TO-NAME            PIC X(30).
  6109             20  CF-IN-CARE-OF              PIC X(30).
  6110             20  CF-ADDRESS-LINE-1          PIC X(30).
  6111             20  CF-ADDRESS-LINE-2          PIC X(30).
  6112             20  CF-CITY-STATE              PIC X(30).
  6113             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  6114             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  6115
  6116         16  CF-CLAIM-NO-CONTROL.
  6117             20  CF-CLAIM-NO-METHOD         PIC X.
  6118                 88  CLAIM-NO-MANUAL            VALUE '1'.
  6119                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  6120                 88  CLAIM-NO-SEQ               VALUE '3'.
  6121                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  6122             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  6123                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  6124                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  6125                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  6126
  6127         16  CF-CHECK-NO-CONTROL.
  6128             20  CF-CHECK-NO-METHOD         PIC X.
  6129                 88  CHECK-NO-MANUAL            VALUE '1'.
  6130                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  6131                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  6132                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  6133             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  6134                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  6135
  6136         16  CF-DOMICILE-STATE              PIC XX.
  6137
  6138         16  CF-EXPENSE-CONTROLS.
  6139             20  CF-EXPENSE-METHOD          PIC X.
  6140                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6141                 88  DOLLARS-PER-PMT            VALUE '2'.
  6142                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6143                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6144             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6145             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6146
  6147         16  CF-CORRESPONDENCE-CONTROL.
  6148             20  CF-LETTER-RESEND-OPT       PIC X.
  6149                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6150                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6151             20  FILLER                     PIC X(4).
  6152
  6153         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 119
* EL689.cbl
  6154             20  CF-MANUAL-SW               PIC X.
  6155                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6156             20  CF-FUTURE-SW               PIC X.
  6157                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6158             20  CF-PTC-SW                  PIC X.
  6159                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6160             20  CF-IBNR-SW                 PIC X.
  6161                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6162             20  CF-PTC-LF-SW               PIC X.
  6163                 88  CF-LF-PTC-USED             VALUE '1'.
  6164             20  CF-CDT-ACCESS-METHOD       PIC X.
  6165                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6166                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6167                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  6168             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6169
  6170         16  CF-CLAIM-CALC-METHOD           PIC X.
  6171             88  360-PLUS-MONTHS                VALUE '1'.
  6172             88  365-PLUS-MONTHS                VALUE '2'.
  6173             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6174             88  360-DAILY                      VALUE '4'.
  6175             88  365-DAILY                      VALUE '5'.
  6176
  6177         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6178         16  FILLER                         PIC X(11).
  6179
  6180         16  CF-LIMIT-AMOUNTS.
  6181             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6182             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6183             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6184             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6185             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6186             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6187             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6188             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6189             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6190             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6191
  6192         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6193         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6194         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6195
  6196         16  CF-ZIP-CODE.
  6197             20  CF-ZIP-PRIME.
  6198                 24  CF-ZIP-1ST             PIC X.
  6199                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6200                 24  FILLER                 PIC X(4).
  6201             20  CF-ZIP-PLUS4               PIC X(4).
  6202         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6203             20  CF-CAN-POSTAL-1            PIC XXX.
  6204             20  CF-CAN-POSTAL-2            PIC XXX.
  6205             20  FILLER                     PIC XXX.
  6206
  6207         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6208         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6209         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6210
  6211         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 120
* EL689.cbl
  6212             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6213             88  CF-NO-RATING                   VALUE 'N'.
  6214
  6215         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6216
  6217         16  CF-CARRIER-OVER-SHORT.
  6218             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6219             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6220
  6221         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6222         16  CF-SECPAY-SWITCH               PIC X.
  6223             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6224             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6225         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6226         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6227         16  FILLER                         PIC X(444).
  6228*        16  FILLER                         PIC X(452).
  6229
  6230
  6231****************************************************************
  6232*             MORTALITY MASTER RECORD                          *
  6233****************************************************************
  6234
  6235     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6236         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6237                                INDEXED BY CF-MORT-NDX.
  6238             20  CF-MORT-TABLE              PIC X(5).
  6239             20  CF-MORT-TABLE-TYPE         PIC X.
  6240                 88  CF-MORT-JOINT              VALUE 'J'.
  6241                 88  CF-MORT-SINGLE             VALUE 'S'.
  6242                 88  CF-MORT-COMBINED           VALUE 'C'.
  6243                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6244                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6245             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6246             20  CF-MORT-AGE-METHOD         PIC XX.
  6247                 88  CF-AGE-LAST                VALUE 'AL'.
  6248                 88  CF-AGE-NEAR                VALUE 'AN'.
  6249             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6250             20  CF-MORT-ADJUSTMENT-DIRECTION
  6251                                            PIC X.
  6252                 88  CF-MINUS                   VALUE '-'.
  6253                 88  CF-PLUS                    VALUE '+'.
  6254             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6255             20  CF-MORT-JOINT-CODE         PIC X.
  6256                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6257             20  CF-MORT-PC-Q               PIC X.
  6258                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6259             20  CF-MORT-TABLE-CODE         PIC X(4).
  6260             20  CF-MORT-COMMENTS           PIC X(15).
  6261             20  FILLER                     PIC X(14).
  6262
  6263         16  FILLER                         PIC X(251).
  6264
  6265
  6266****************************************************************
  6267*             BUSSINESS TYPE MASTER RECORD                     *
  6268****************************************************************
  6269
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 121
* EL689.cbl
  6270     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6271* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6272* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6273* AND RECORD 05 IS TYPES 81-99
  6274         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6275             20  CF-BUSINESS-TITLE          PIC  X(19).
  6276             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6277                                            PIC S9V9(4) COMP-3.
  6278             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6279             20  FILLER                     PIC  X.
  6280         16  FILLER                         PIC  X(248).
  6281
  6282
  6283****************************************************************
  6284*             TERMINAL MASTER RECORD                           *
  6285****************************************************************
  6286
  6287     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6288
  6289         16  CF-COMPANY-TERMINALS.
  6290             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6291                                  PIC X(4).
  6292         16  FILLER               PIC X(248).
  6293
  6294
  6295****************************************************************
  6296*             LIFE EDIT MASTER RECORD                          *
  6297****************************************************************
  6298
  6299     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6300         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6301             20  CF-LIFE-CODE-IN            PIC XX.
  6302             20  CF-LIFE-CODE-OUT           PIC XX.
  6303         16  FILLER                         PIC X(248).
  6304
  6305
  6306****************************************************************
  6307*             AH EDIT MASTER RECORD                            *
  6308****************************************************************
  6309
  6310     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6311         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6312             20  CF-AH-CODE-IN              PIC XXX.
  6313             20  CF-AH-CODE-OUT             PIC XX.
  6314         16  FILLER                         PIC X(248).
  6315
  6316
  6317****************************************************************
  6318*             CREDIBILITY TABLES                               *
  6319****************************************************************
  6320
  6321     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6322         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6323                             INDEXED BY CF-CRDB-NDX.
  6324             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6325             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6326             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6327         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 122
* EL689.cbl
  6328
  6329
  6330****************************************************************
  6331*             REPORT CUSTOMIZATION RECORD                      *
  6332****************************************************************
  6333
  6334     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6335         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6336             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6337             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6338             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6339**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6340****       A T-TRANSFER.                                   ****
  6341             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6342
  6343         16  FILLER                         PIC XX.
  6344
  6345         16  CF-CARRIER-CNTL-OPT.
  6346             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6347                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6348                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6349             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6350                                            PIC X.
  6351         16  CF-GROUP-CNTL-OPT.
  6352             20  CF-GROUP-OPT-SEQ           PIC 9.
  6353                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6354                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6355             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6356                                            PIC X(6).
  6357         16  CF-STATE-CNTL-OPT.
  6358             20  CF-STATE-OPT-SEQ           PIC 9.
  6359                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6360                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6361             20  CF-STATE-SELECT OCCURS 3 TIMES
  6362                                            PIC XX.
  6363         16  CF-ACCOUNT-CNTL-OPT.
  6364             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6365                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6366                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6367             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6368                                            PIC X(10).
  6369         16  CF-BUS-TYP-CNTL-OPT.
  6370             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6371                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6372                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6373             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6374                                            PIC XX.
  6375         16  CF-LF-TYP-CNTL-OPT.
  6376             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6377                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6378                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6379             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6380                                            PIC XX.
  6381         16  CF-AH-TYP-CNTL-OPT.
  6382             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6383                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6384                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6385             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 123
* EL689.cbl
  6386                                            PIC XX.
  6387         16  CF-REPTCD1-CNTL-OPT.
  6388             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6389                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6390                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6391             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6392                                            PIC X(10).
  6393         16  CF-REPTCD2-CNTL-OPT.
  6394             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6395                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6396                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6397             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6398                                            PIC X(10).
  6399         16  CF-USER1-CNTL-OPT.
  6400             20  CF-USER1-OPT-SEQ           PIC 9.
  6401                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6402                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6403             20  CF-USER1-SELECT OCCURS 3 TIMES
  6404                                            PIC X(10).
  6405         16  CF-USER2-CNTL-OPT.
  6406             20  CF-USER2-OPT-SEQ           PIC 9.
  6407                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6408                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6409             20  CF-USER2-SELECT OCCURS 3 TIMES
  6410                                            PIC X(10).
  6411         16  CF-USER3-CNTL-OPT.
  6412             20  CF-USER3-OPT-SEQ           PIC 9.
  6413                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6414                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6415             20  CF-USER3-SELECT OCCURS 3 TIMES
  6416                                            PIC X(10).
  6417         16  CF-USER4-CNTL-OPT.
  6418             20  CF-USER4-OPT-SEQ           PIC 9.
  6419                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6420                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6421             20  CF-USER4-SELECT OCCURS 3 TIMES
  6422                                            PIC X(10).
  6423         16  CF-USER5-CNTL-OPT.
  6424             20  CF-USER5-OPT-SEQ           PIC 9.
  6425                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6426                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6427             20  CF-USER5-SELECT OCCURS 3 TIMES
  6428                                            PIC X(10).
  6429         16  CF-REINS-CNTL-OPT.
  6430             20  CF-REINS-OPT-SEQ           PIC 9.
  6431                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6432                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6433             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6434                 24  CF-REINS-PRIME         PIC XXX.
  6435                 24  CF-REINS-SUB           PIC XXX.
  6436
  6437         16  CF-AGENT-CNTL-OPT.
  6438             20  CF-AGENT-OPT-SEQ           PIC 9.
  6439                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6440                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6441             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6442                                            PIC X(10).
  6443
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 124
* EL689.cbl
  6444         16  FILLER                         PIC X(43).
  6445
  6446         16  CF-LOSS-RATIO-SELECT.
  6447             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6448             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6449         16  CF-ENTRY-DATE-SELECT.
  6450             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6451             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6452         16  CF-EFFECTIVE-DATE-SELECT.
  6453             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6454             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6455
  6456         16  CF-EXCEPTION-LIST-IND          PIC X.
  6457             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6458
  6459         16  FILLER                         PIC X(318).
  6460
  6461****************************************************************
  6462*                  EXCEPTION REPORTING RECORD                  *
  6463****************************************************************
  6464
  6465     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6466         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6467             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6468
  6469         16  CF-COMBINED-LIFE-AH-OPT.
  6470             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6471             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6472             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6473             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6474
  6475         16  CF-LIFE-OPT.
  6476             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6477             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6478             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6479             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6480             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6481             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6482             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6483             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6484             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6485             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6486
  6487         16  CF-AH-OPT.
  6488             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6489             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6490             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6491             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6492             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6493             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6494             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6495             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6496             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6497             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6498
  6499         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6500             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6501             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 125
* EL689.cbl
  6502             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6503
  6504         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6505
  6506         16  FILLER                         PIC X(673).
  6507
  6508
  6509****************************************************************
  6510*             MORTGAGE SYSTEM PLAN RECORD                      *
  6511****************************************************************
  6512
  6513     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6514         16  CF-PLAN-TYPE                   PIC X.
  6515             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6516             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6517             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6518         16  CF-PLAN-ABBREV                 PIC XXX.
  6519         16  CF-PLAN-DESCRIPT               PIC X(10).
  6520         16  CF-PLAN-NOTES                  PIC X(20).
  6521         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6522         16  CF-PLAN-UNDERWRITING.
  6523             20  CF-PLAN-TERM-DATA.
  6524                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6525                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6526             20  CF-PLAN-AGE-DATA.
  6527                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6528                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6529                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6530             20  CF-PLAN-BENEFIT-DATA.
  6531                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6532                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6533                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6534                                            PIC S9(7)V99  COMP-3.
  6535         16  CF-PLAN-POLICY-FORMS.
  6536             20  CF-POLICY-FORM             PIC X(12).
  6537             20  CF-MASTER-APPLICATION      PIC X(12).
  6538             20  CF-MASTER-POLICY           PIC X(12).
  6539         16  CF-PLAN-RATING.
  6540             20  CF-RATE-CODE               PIC X(5).
  6541             20  CF-SEX-RATING              PIC X.
  6542                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6543                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6544             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6545             20  CF-SUB-STD-TYPE            PIC X.
  6546                 88  CF-PCT-OF-PREM            VALUE '1'.
  6547                 88  CF-PCT-OF-BENE            VALUE '2'.
  6548         16  CF-PLAN-PREM-TOLERANCES.
  6549             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6550             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6551         16  CF-PLAN-PYMT-TOLERANCES.
  6552             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6553             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6554         16  CF-PLAN-MISC-DATA.
  6555             20  FILLER                     PIC X.
  6556             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6557             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6558         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6559         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 126
* EL689.cbl
  6560             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6561                                                     '1'.
  6562             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6563                                                     '2'.
  6564         16  CF-MIB-SEARCH-SW               PIC X.
  6565             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6566             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6567             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6568             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6569         16  CF-ALPHA-SEARCH-SW             PIC X.
  6570             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6571             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6572             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6573             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6574             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6575             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6576             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6577             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6578             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6579             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6580                                                     'A' 'B' 'C'
  6581                                                     'X' 'Y' 'Z'.
  6582         16  CF-EFF-DT-RULE-SW              PIC X.
  6583             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6584             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6585             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6586             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6587             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6588         16  FILLER                         PIC X(4).
  6589         16  CF-HEALTH-QUESTIONS            PIC X.
  6590             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6591         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6592         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6593         16  CF-PLAN-SNGL-JNT               PIC X.
  6594             88  CF-COMBINED-PLAN              VALUE 'C'.
  6595             88  CF-JNT-PLAN                   VALUE 'J'.
  6596             88  CF-SNGL-PLAN                  VALUE 'S'.
  6597         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6598         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6599         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6600         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6601         16  CF-RERATE-CNTL                 PIC  X.
  6602             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6603             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6604             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6605             88  CF-AUTO-RECALC                 VALUE '4'.
  6606         16  CF-BENEFIT-TYPE                PIC  X.
  6607             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6608             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6609         16  CF-POLICY-FEE                  PIC S999V99
  6610                                                    COMP-3.
  6611         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6612         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6613         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6614         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6615         16  FILLER                         PIC  X(32).
  6616         16  CF-TERMINATION-FORM            PIC  X(04).
  6617         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 127
* EL689.cbl
  6618         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6619                                                       COMP-3.
  6620         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6621         16  CF-ISSUE-LETTER                PIC  X(4).
  6622         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6623         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6624             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6625             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6626         16  CF-MP-REFUND-CALC              PIC X.
  6627             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6628             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6629             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6630             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6631             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6632             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6633             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6634             88  CF-MP-REFD-MEAN                VALUE '8'.
  6635         16  CF-ALT-RATE-CODE               PIC  X(5).
  6636
  6637
  6638         16  FILLER                         PIC X(498).
  6639****************************************************************
  6640*             MORTGAGE COMPANY MASTER RECORD                   *
  6641****************************************************************
  6642
  6643     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6644         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6645         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6646             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6647             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6648             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6649             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6650             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6651
  6652         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6653         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6654         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6655         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6656         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6657
  6658         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6659             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6660         16  CF-MP-RECON-USE-IND            PIC X(1).
  6661             88  CF-MP-USE-RECON             VALUE 'Y'.
  6662         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6663             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6664         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6665             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6666             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6667         16  FILLER                         PIC X(1).
  6668         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6669             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6670         16  CF-MORTG-MIB-VERSION           PIC X.
  6671             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6672             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6673             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6674         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6675             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 128
* EL689.cbl
  6676                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6677             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6678                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6679             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6680                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6681             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6682                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6683             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6684                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6685             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6686                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6687         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6688         16  FILLER                         PIC X(7).
  6689         16  CF-MORTG-DESTINATION-SYMBOL.
  6690             20  CF-MORTG-MIB-COMM          PIC X(5).
  6691             20  CF-MORTG-MIB-TERM          PIC X(5).
  6692         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6693             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6694         16  FILLER                         PIC X(03).
  6695         16  CF-MP-CHECK-NO-CONTROL.
  6696             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6697                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6698                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6699                                                ' ' LOW-VALUES.
  6700                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6701                                               VALUE '3'.
  6702         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6703         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6704         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6705             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6706                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6707             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6708                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6709             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6710                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6711             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6712                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6713             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6714                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6715             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6716                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6717         16  CF-MORTG-BILLING-AREA.
  6718             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6719                                            PIC X.
  6720         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6721         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6722         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6723         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6724             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6725             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6726         16  FILLER                         PIC X.
  6727         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6728             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6729             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6730         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6731         16  FILLER                         PIC X(8).
  6732         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6733         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 129
* EL689.cbl
  6734         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6735         16  CF-ACH-COMPANY-ID.
  6736             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6737                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6738                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6739                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6740             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6741         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6742             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6743         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6744             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6745             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6746         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6747         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6748         16  FILLER                         PIC X(536).
  6749
  6750****************************************************************
  6751*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6752****************************************************************
  6753
  6754     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6755         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6756             20  CF-FEMALE-HEIGHT.
  6757                 24  CF-FEMALE-FT           PIC 99.
  6758                 24  CF-FEMALE-IN           PIC 99.
  6759             20  CF-FEMALE-MIN-WT           PIC 999.
  6760             20  CF-FEMALE-MAX-WT           PIC 999.
  6761         16  FILLER                         PIC X(428).
  6762
  6763     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6764         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6765             20  CF-MALE-HEIGHT.
  6766                 24  CF-MALE-FT             PIC 99.
  6767                 24  CF-MALE-IN             PIC 99.
  6768             20  CF-MALE-MIN-WT             PIC 999.
  6769             20  CF-MALE-MAX-WT             PIC 999.
  6770         16  FILLER                         PIC X(428).
  6771******************************************************************
  6772*             AUTOMATIC ACTIVITY RECORD                          *
  6773******************************************************************
  6774     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6775         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6776             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6777             20  CF-SYS-LETTER-ID           PIC X(04).
  6778             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6779             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6780             20  CF-SYS-RESET-SW            PIC X(01).
  6781             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6782             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6783
  6784         16  FILLER                         PIC X(50).
  6785
  6786         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6787             20  CF-USER-ACTIVE-SW          PIC X(01).
  6788             20  CF-USER-LETTER-ID          PIC X(04).
  6789             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6790             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6791             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 130
* EL689.cbl
  6792             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6793             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6794             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6795
  6796         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 131
* EL689.cbl
  6798*    COPY ERCCOMP.
  6799******************************************************************
  6800*                                                                *
  6801*                                                                *
  6802*                            ERCCOMP                             *
  6803*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6804*                            VMOD=2.019                          *
  6805*                                                                *
  6806*   ONLINE CREDIT SYSTEM                                         *
  6807*                                                                *
  6808*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6809*                                                                *
  6810*   FILE TYPE = VSAM,KSDS                                        *
  6811*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6812*                                                                *
  6813*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6814*       ALTERNATE PATH = NONE                                    *
  6815*                                                                *
  6816*   LOG = NO                                                     *
  6817*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6818*                                                                *
  6819******************************************************************
  6820*                   C H A N G E   L O G
  6821*
  6822* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6823*-----------------------------------------------------------------
  6824*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6825* EFFECTIVE    NUMBER
  6826*-----------------------------------------------------------------
  6827* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6828* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6829* 092205    2005050300006  PEMA  ADD LEASE FEE
  6830* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6831* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6832* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6833* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6834* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6835* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  6836******************************************************************
  6837
  6838 01  COMPENSATION-MASTER.
  6839     12  CO-RECORD-ID                          PIC XX.
  6840         88  VALID-CO-ID                          VALUE 'CO'.
  6841
  6842     12  CO-CONTROL-PRIMARY.
  6843         16  CO-COMPANY-CD                     PIC X.
  6844         16  CO-CONTROL.
  6845             20  CO-CTL-1.
  6846                 24  CO-CARR-GROUP.
  6847                     28  CO-CARRIER            PIC X.
  6848                     28  CO-GROUPING.
  6849                         32  CO-GROUP-PREFIX   PIC XXX.
  6850                         32  CO-GROUP-PRIME    PIC XXX.
  6851                 24  CO-RESP-NO.
  6852                     28  CO-RESP-PREFIX        PIC X(4).
  6853                     28  CO-RESP-PRIME         PIC X(6).
  6854             20  CO-CTL-2.
  6855                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 132
* EL689.cbl
  6856                     28  CO-ACCT-PREFIX        PIC X(4).
  6857                     28  CO-ACCT-PRIME         PIC X(6).
  6858         16  CO-TYPE                           PIC X.
  6859             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6860             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6861             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6862
  6863     12  CO-MAINT-INFORMATION.
  6864         16  CO-LAST-MAINT-DT                  PIC XX.
  6865         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6866         16  CO-LAST-MAINT-USER                PIC X(4).
  6867     12  FILLER                                PIC XX.
  6868     12  CO-STMT-TYPE                          PIC XXX.
  6869     12  CO-COMP-TYPE                          PIC X.
  6870         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6871     12  CO-STMT-OWNER                         PIC X(4).
  6872     12  CO-BALANCE-CONTROL                    PIC X.
  6873         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6874         88  CO-NO-BALANCE                        VALUE 'N'.
  6875
  6876     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6877         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6878         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6879         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6880
  6881     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6882         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6883         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6884
  6885     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6886     12  CO-GA-DIRECT-DEP                      PIC X.
  6887     12  CO-FUTURE-SPACE                       PIC X.
  6888         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6889
  6890     12  CO-ACCT-NAME                          PIC X(30).
  6891     12  CO-MAIL-NAME                          PIC X(30).
  6892     12  CO-ADDR-1                             PIC X(30).
  6893     12  CO-ADDR-2                             PIC X(30).
  6894     12  CO-ADDR-3.
  6895         16  CO-ADDR-CITY                      PIC X(27).
  6896         16  CO-ADDR-STATE                     PIC XX.
  6897     12  CO-CSO-1099                           PIC X.
  6898     12  CO-ZIP.
  6899         16  CO-ZIP-PRIME.
  6900             20  CO-ZIP-PRI-1ST                PIC X.
  6901                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6902             20  FILLER                        PIC X(4).
  6903         16  CO-ZIP-PLUS4                      PIC X(4).
  6904     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6905         16  CO-CAN-POSTAL-1                   PIC XXX.
  6906         16  CO-CAN-POSTAL-2                   PIC XXX.
  6907         16  FILLER                            PIC XXX.
  6908     12  CO-SOC-SEC                            PIC X(13).
  6909     12  CO-TELEPHONE.
  6910         16  CO-AREA-CODE                      PIC XXX.
  6911         16  CO-PREFIX                         PIC XXX.
  6912         16  CO-PHONE                          PIC X(4).
  6913
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 133
* EL689.cbl
  6914     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  6915
  6916     12  CO-AR-BAL-LEVEL                       PIC X.
  6917         88  CO-AR-REF-LVL                        VALUE '1'.
  6918         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6919         88  CO-AR-BILL-LVL                       VALUE '2'.
  6920         88  CO-AR-AGT-LVL                        VALUE '3'.
  6921         88  CO-AR-FR-LVL                         VALUE '4'.
  6922
  6923     12  CO-AR-NORMAL-PRINT                    PIC X.
  6924         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6925         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6926
  6927     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6928
  6929     12  CO-AR-REPORTING                       PIC X.
  6930         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6931         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6932
  6933     12  CO-AR-PULL-CHECK                      PIC X.
  6934         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6935         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6936
  6937     12  CO-AR-BALANCE-PRINT                   PIC X.
  6938         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6939
  6940     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6941         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6942         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6943         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6944
  6945     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6946
  6947     12  CO-USER-CODE                          PIC X.
  6948     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6949
  6950******************************************************************
  6951*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6952*    THE LAST MONTH END RUN.
  6953******************************************************************
  6954
  6955     12  CO-LAST-ACTIVITY-DATE.
  6956         16  CO-ACT-YEAR                       PIC 99.
  6957         16  CO-ACT-MONTH                      PIC 99.
  6958         16  CO-ACT-DAY                        PIC 99.
  6959
  6960     12  CO-LAST-STMT-DT.
  6961         16  CO-LAST-STMT-YEAR                 PIC 99.
  6962         16  CO-LAST-STMT-MONTH                PIC 99.
  6963         16  CO-LAST-STMT-DAY                  PIC 99.
  6964
  6965     12  CO-MO-END-TOTALS.
  6966         16  CO-MONTHLY-TOTALS.
  6967             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6968             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6969             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6970             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6971             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 134
* EL689.cbl
  6972
  6973         16  CO-AGING-TOTALS.
  6974             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6975             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6976             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6977             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6978
  6979         16  CO-YTD-TOTALS.
  6980             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6981             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6982
  6983         16  CO-OVER-UNDER-TOTALS.
  6984             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6985             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6986
  6987     12  CO-MISCELLANEOUS-TOTALS.
  6988         16  CO-FICA-TOTALS.
  6989             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6990             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6991
  6992         16  CO-CLAIM-TOTALS.
  6993             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6994             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6995
  6996******************************************************************
  6997*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6998*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6999******************************************************************
  7000
  7001     12  CO-CURRENT-TOTALS.
  7002         16  CO-CURRENT-LAST-STMT-DT.
  7003             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7004             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7005             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7006
  7007         16  CO-CURRENT-MONTHLY-TOTALS.
  7008             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7009             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7010             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7011             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7012             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7013
  7014         16  CO-CURRENT-AGING-TOTALS.
  7015             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7016             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7017             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7018             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7019
  7020         16  CO-CURRENT-YTD-TOTALS.
  7021             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7022             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7023
  7024     12  CO-PAID-COMM-TOTALS.
  7025         16  CO-YTD-PAID-COMMS.
  7026             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7027             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7028
  7029     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 135
* EL689.cbl
  7030         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7031         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7032
  7033     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7034         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7035         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7036         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7037         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7038         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7039         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7040         88  CO-FINAL-LETTER                  VALUE 'F'.
  7041         88  CO-RECONCILING                   VALUE 'R'.
  7042         88  CO-PHONE-CALL                    VALUE 'P'.
  7043         88  CO-LEGAL                         VALUE 'L'.
  7044         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7045         88  CO-WRITE-OFF                     VALUE 'W'.
  7046         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7047
  7048     12  CO-CSR-CODE                       PIC X(4).
  7049
  7050     12  CO-GA-STATUS-INFO.
  7051         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7052         16  CO-GA-TERMINATION-DT          PIC XX.
  7053         16  CO-GA-STATUS-CODE             PIC X.
  7054             88  CO-GA-ACTIVE                 VALUE 'A'.
  7055             88  CO-GA-INACTIVE               VALUE 'I'.
  7056             88  CO-GA-PENDING                VALUE 'P'.
  7057         16  CO-GA-COMMENTS.
  7058             20  CO-GA-COMMENT-1           PIC X(40).
  7059             20  CO-GA-COMMENT-2           PIC X(40).
  7060             20  CO-GA-COMMENT-3           PIC X(40).
  7061             20  CO-GA-COMMENT-4           PIC X(40).
  7062
  7063     12  CO-RPTCD2                         PIC X(10).
  7064     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7065         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7066         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7067
  7068     12  CO-TYPE-AGENT                     PIC X(01).
  7069         88  CO-CORPORATION                   VALUE 'C'.
  7070         88  CO-PARTNERSHIP                   VALUE 'P'.
  7071         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7072         88  CO-TRUST                         VALUE 'T'.
  7073         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7074
  7075     12  CO-FAXNO.
  7076         16  CO-FAX-AREA-CODE                  PIC XXX.
  7077         16  CO-FAX-PREFIX                     PIC XXX.
  7078         16  CO-FAX-PHONE                      PIC X(4).
  7079
  7080     12  CO-BANK-INFORMATION.
  7081         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7082         16  CO-BANK-TRANSIT-NON REDEFINES
  7083             CO-BANK-TRANSIT-NO                PIC 9(8).
  7084
  7085         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7086     12  CO-MISC-DEDUCT-INFO REDEFINES
  7087                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 136
* EL689.cbl
  7088         16  CO-MD-GL-ACCT                     PIC X(10).
  7089         16  CO-MD-DIV                         PIC XX.
  7090         16  CO-MD-CENTER                      PIC X(4).
  7091         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7092         16  CO-CREATE-AP-CHECK                PIC X.
  7093         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7094         16  FILLER                            PIC XXX.
  7095     12  CO-ACH-STATUS                         PIC X.
  7096         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7097         88  CO-ACH-PENDING                        VALUE 'P'.
  7098
  7099     12  CO-BILL-SW                            PIC X.
  7100     12  CO-CONTROL-NAME                       PIC X(30).
  7101     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7102     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7103     12  CO-CLP-STATE                          PIC XX.
  7104     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7105     12  CO-SPP-REFUND-EDIT                    PIC X.
  7106
  7107******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 137
* EL689.cbl
  7109*    COPY ERCMAIL.
  7110******************************************************************
  7111*                                                                *
  7112*                                                                *
  7113*                            ERCMAIL                             *
  7114*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7115*                            VMOD=2.003                          *
  7116*                                                                *
  7117*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7118*                                                                *
  7119*   FILE TYPE = VSAM,KSDS                                        *
  7120*   RECORD SIZE = 374   RECFORM = FIX                            *
  7121*                                                                *
  7122*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7123*   ALTERNATE PATH    = NOT USED                                 *
  7124*                                                                *
  7125*   LOG = YES                                                    *
  7126*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7127******************************************************************
  7128*                   C H A N G E   L O G
  7129*
  7130* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7131*-----------------------------------------------------------------
  7132*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7133* EFFECTIVE    NUMBER
  7134*-----------------------------------------------------------------
  7135* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7136* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7137* 111108                   PEMA  ADD CRED BENE ADDR2
  7138******************************************************************
  7139
  7140 01  MAILING-DATA.
  7141     12  MA-RECORD-ID                      PIC XX.
  7142         88  VALID-MA-ID                       VALUE 'MA'.
  7143
  7144     12  MA-CONTROL-PRIMARY.
  7145         16  MA-COMPANY-CD                 PIC X.
  7146         16  MA-CARRIER                    PIC X.
  7147         16  MA-GROUPING.
  7148             20  MA-GROUPING-PREFIX        PIC XXX.
  7149             20  MA-GROUPING-PRIME         PIC XXX.
  7150         16  MA-STATE                      PIC XX.
  7151         16  MA-ACCOUNT.
  7152             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7153             20  MA-ACCOUNT-PRIME          PIC X(6).
  7154         16  MA-CERT-EFF-DT                PIC XX.
  7155         16  MA-CERT-NO.
  7156             20  MA-CERT-PRIME             PIC X(10).
  7157             20  MA-CERT-SFX               PIC X.
  7158
  7159     12  FILLER                            PIC XX.
  7160
  7161     12  MA-ACCESS-CONTROL.
  7162         16  MA-SOURCE-SYSTEM              PIC XX.
  7163             88  MA-FROM-CREDIT                VALUE 'CR'.
  7164             88  MA-FROM-VSI                   VALUE 'VS'.
  7165             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7166             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 138
* EL689.cbl
  7167         16  MA-RECORD-ADD-DT              PIC XX.
  7168         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7169         16  MA-LAST-MAINT-DT              PIC XX.
  7170         16  MA-LAST-MAINT-BY              PIC XXXX.
  7171         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7172
  7173     12  MA-PROFILE-INFO.
  7174         16  MA-QUALIFY-CODE-1             PIC XX.
  7175         16  MA-QUALIFY-CODE-2             PIC XX.
  7176         16  MA-QUALIFY-CODE-3             PIC XX.
  7177         16  MA-QUALIFY-CODE-4             PIC XX.
  7178         16  MA-QUALIFY-CODE-5             PIC XX.
  7179
  7180         16  MA-INSURED-LAST-NAME          PIC X(15).
  7181         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7182         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7183         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7184         16  MA-INSURED-BIRTH-DT           PIC XX.
  7185         16  MA-INSURED-SEX                PIC X.
  7186             88  MA-SEX-MALE                   VALUE 'M'.
  7187             88  MA-SEX-FEMALE                 VALUE 'F'.
  7188         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7189
  7190         16  MA-ADDRESS-CORRECTED          PIC X.
  7191         16  MA-JOINT-BIRTH-DT             PIC XX.
  7192*        16  FILLER                        PIC X(12).
  7193
  7194         16  MA-ADDRESS-LINE-1             PIC X(30).
  7195         16  MA-ADDRESS-LINE-2             PIC X(30).
  7196         16  MA-CITY-STATE.
  7197             20  MA-CITY                   PIC X(28).
  7198             20  MA-ADDR-STATE             PIC XX.
  7199         16  MA-ZIP.
  7200             20  MA-ZIP-CODE.
  7201                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7202                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7203                 24  FILLER                PIC X(4).
  7204             20  MA-ZIP-PLUS4              PIC X(4).
  7205         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7206             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7207             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7208             20  FILLER                    PIC X(3).
  7209
  7210         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7211
  7212         16  FILLER                        PIC XXX.
  7213*        16  FILLER                        PIC X(10).
  7214
  7215     12  MA-CRED-BENE-INFO.
  7216         16  MA-CRED-BENE-NAME                 PIC X(25).
  7217         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7218         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7219         16  MA-CRED-BENE-CTYST.
  7220             20  MA-CRED-BENE-CITY             PIC X(28).
  7221             20  MA-CRED-BENE-STATE            PIC XX.
  7222         16  MA-CRED-BENE-ZIP.
  7223             20  MA-CB-ZIP-CODE.
  7224                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 139
* EL689.cbl
  7225                     88  MA-CB-CANADIAN-POST-CODE
  7226                                           VALUE 'A' THRU 'Z'.
  7227                 24  FILLER                    PIC X(4).
  7228             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7229         16  MA-CB-CANADIAN-POSTAL-CODE
  7230                            REDEFINES MA-CRED-BENE-ZIP.
  7231             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7232             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7233             20  FILLER                        PIC X(3).
  7234     12  MA-POST-CARD-MAIL-DATA.
  7235         16  MA-MAIL-DATA OCCURS 7.
  7236             20  MA-MAIL-TYPE              PIC X.
  7237                 88  MA-12MO-MAILING           VALUE '1'.
  7238                 88  MA-EXP-MAILING            VALUE '2'.
  7239             20  MA-MAIL-STATUS            PIC X.
  7240                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7241                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7242                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7243             20  MA-MAIL-DATE              PIC XX.
  7244     12  FILLER                            PIC XX.
  7245     12  FILLER                            PIC XX.
  7246*    12  FILLER                            PIC X(30).
  7247******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 140
* EL689.cbl
  7249*    COPY ERCPNDB.
  7250******************************************************************
  7251*                                                                *
  7252*                                                                *
  7253*                            ERCPNDB.                            *
  7254*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7255*                            VMOD=2.025                          *
  7256*                                                                *
  7257*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  7258*                                                                *
  7259******************************************************************
  7260*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  7261*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  7262******************************************************************
  7263*                                                                *
  7264*                                                                *
  7265*   FILE TYPE = VSAM,KSDS                                        *
  7266*   RECORD SIZE = 585  RECFORM = FIXED                           *
  7267*                                                                *
  7268*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  7269*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  7270*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  7271*                                                 RKP=13,LEN=36  *
  7272*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  7273*                                      AND CHG-SEQ.)             *
  7274*                                                RKP=49,LEN=11   *
  7275*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  7276*                                      AND CHG-SEQ.)             *
  7277*                                                RKP=60,LEN=15   *
  7278*                                                                *
  7279*   LOG = NO                                                     *
  7280*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7281******************************************************************
  7282******************************************************************
  7283*                   C H A N G E   L O G
  7284*
  7285* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7286*-----------------------------------------------------------------
  7287*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7288* EFFECTIVE    NUMBER
  7289*-----------------------------------------------------------------
  7290* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7291* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7292* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7293* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  7294* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  7295* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  7296* 032306                   PEMA  ADD BOW LOAN NUMBER
  7297* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  7298* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7299* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7300* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7301* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  7302* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7303* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7304* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  7305* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  7306* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 141
* EL689.cbl
  7307* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  7308* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  7309******************************************************************
  7310
  7311 01  PENDING-BUSINESS.
  7312     12  PB-RECORD-ID                     PIC XX.
  7313         88  VALID-PB-ID                        VALUE 'PB'.
  7314
  7315     12  PB-CONTROL-PRIMARY.
  7316         16  PB-COMPANY-CD                PIC X.
  7317         16  PB-ENTRY-BATCH               PIC X(6).
  7318         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  7319         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  7320
  7321     12  PB-CONTROL-BY-ACCOUNT.
  7322         16  PB-COMPANY-CD-A1             PIC X.
  7323         16  PB-CARRIER                   PIC X.
  7324         16  PB-GROUPING.
  7325             20  PB-GROUPING-PREFIX       PIC XXX.
  7326             20  PB-GROUPING-PRIME        PIC XXX.
  7327         16  PB-STATE                     PIC XX.
  7328         16  PB-ACCOUNT.
  7329             20  PB-ACCOUNT-PREFIX        PIC X(4).
  7330             20  PB-ACCOUNT-PRIME         PIC X(6).
  7331         16  PB-CERT-EFF-DT               PIC XX.
  7332         16  PB-CERT-NO.
  7333             20  PB-CERT-PRIME            PIC X(10).
  7334             20  PB-CERT-SFX              PIC X.
  7335         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  7336
  7337         16  PB-RECORD-TYPE               PIC X.
  7338             88  PB-MAILING-DATA                VALUE '0'.
  7339             88  PB-ISSUE                       VALUE '1'.
  7340             88  PB-CANCELLATION                VALUE '2'.
  7341             88  PB-BATCH-TRAILER               VALUE '9'.
  7342
  7343     12  PB-CONTROL-BY-ORIG-BATCH.
  7344         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  7345         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  7346         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  7347         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  7348
  7349     12  PB-CONTROL-BY-CSR.
  7350         16  PB-CSR-COMPANY-CD            PIC X.
  7351         16  PB-CSR-ID                    PIC X(4).
  7352         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  7353         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  7354         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  7355******************************************************************
  7356*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  7357******************************************************************
  7358
  7359     12  PB-LAST-MAINT-DT                 PIC XX.
  7360     12  PB-LAST-MAINT-BY                 PIC X(4).
  7361     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7362
  7363     12  PB-RECORD-BODY                   PIC X(375).
  7364
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 142
* EL689.cbl
  7365     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  7366         16  PB-CERT-ORIGIN               PIC X.
  7367             88  CLASIC-CREATED-CERT         VALUE '1'.
  7368         16  PB-I-NAME.
  7369             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  7370             20  PB-I-INSURED-FIRST-NAME.
  7371                 24  PB-I-INSURED-1ST-INIT PIC X.
  7372                 24  FILLER                PIC X(9).
  7373             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  7374         16  PB-I-AGE                     PIC S99   COMP-3.
  7375         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  7376         16  PB-I-BIRTHDAY                PIC XX.
  7377         16  PB-I-INSURED-SEX             PIC X.
  7378             88  PB-SEX-MALE     VALUE 'M'.
  7379             88  PB-SEX-FEMALE   VALUE 'F'.
  7380
  7381         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  7382         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  7383         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  7384         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  7385         16  PB-I-SKIP-CODE               PIC X.
  7386             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  7387             88  PB-SKIP-JULY              VALUE '1'.
  7388             88  PB-SKIP-AUGUST            VALUE '2'.
  7389             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  7390             88  PB-SKIP-JULY-AUG          VALUE '4'.
  7391             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  7392             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  7393             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  7394             88  PB-SKIP-JUNE              VALUE '8'.
  7395             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  7396             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  7397             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  7398         16  PB-I-TERM-TYPE               PIC X.
  7399             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  7400             88  PB-PAID-WEEKLY            VALUE 'W'.
  7401             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  7402             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  7403             88  PB-PAID-13-YEARLY         VALUE 'T'.
  7404         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  7405         16  PB-I-POLICY-FORM-NO          PIC X(12).
  7406         16  PB-I-DATA-ENTRY-SW           PIC X.
  7407             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  7408             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  7409             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  7410             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  7411         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  7412         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  7413*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  7414         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  7415         16  FILLER                       PIC X.
  7416
  7417         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  7418             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  7419             88  PB-INVALID-LIFE             VALUE '  ' '00'
  7420                                                   '90' THRU '99'.
  7421         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  7422                                          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 143
* EL689.cbl
  7423         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  7424         16  PB-I-AMOUNT-FINANCED REDEFINES
  7425                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  7426         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  7427         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  7428                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  7429         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7430         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  7431         16  PB-I-CLP-AMOUNT REDEFINES
  7432                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  7433         16  PB-I-LF-CALC-FLAG            PIC X.
  7434             88 PB-COMP-LF-PREM               VALUE '?'.
  7435         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  7436         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  7437         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  7438         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  7439         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7440         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  7441         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  7442         16  PB-I-LF-ABBR                 PIC XXX.
  7443         16  PB-I-LF-INPUT-CD             PIC XX.
  7444
  7445         16  PB-I-AH-BENEFIT-CD           PIC XX.
  7446             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  7447             88  PB-INVALID-AH               VALUE '  ' '00'
  7448                                                   '90' THRU '99'.
  7449         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  7450         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7451         16  PB-I-AH-CALC-FLAG            PIC X.
  7452             88 PB-COMP-AH-PREM                  VALUE '?'.
  7453         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  7454         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  7455         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  7456         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  7457         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  7458         16  PB-I-AH-ABBR                 PIC XXX.
  7459         16  PB-I-AH-INPUT-CD             PIC XXX.
  7460
  7461         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  7462         16  PB-I-REIN-TABLE              PIC XXX.
  7463         16  PB-I-BUSINESS-TYPE           PIC 99.
  7464         16  PB-I-INDV-GRP-CD             PIC X.
  7465         16  PB-I-MORT-CODE.
  7466             20  PB-I-TABLE               PIC X.
  7467             20  PB-I-INTEREST            PIC XX.
  7468             20  PB-I-MORT-TYP            PIC X.
  7469         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  7470         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  7471         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  7472         16  PB-I-INDV-GRP-OVRD           PIC X.
  7473         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  7474         16  PB-I-SIG-SW                  PIC X.
  7475             88  PB-POLICY-SIGNED             VALUE 'Y'.
  7476         16  PB-I-RATE-CLASS              PIC XX.
  7477         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  7478         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  7479         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  7480         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 144
* EL689.cbl
  7481         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  7482         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  7483         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  7484         16  PB-I-BENEFIT-TYPE            PIC XXX.
  7485         16  PB-I-OB-FLAG                 PIC X.
  7486             88  PB-I-OB                      VALUE 'B'.
  7487             88  PB-I-SUMMARY                 VALUE 'Z'.
  7488         16  PB-I-ENTRY-STATUS            PIC X.
  7489             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  7490                                              'M' '5' '9' '2'.
  7491             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  7492             88  PB-I-POLICY-PENDING          VALUE '2'.
  7493             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  7494             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  7495             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  7496             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  7497             88  PB-I-REIN-ONLY               VALUE '9'.
  7498             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  7499             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  7500             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  7501             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  7502         16  PB-I-INT-CODE                PIC X.
  7503             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  7504             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  7505         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  7506         16  PB-I-SOC-SEC-NO              PIC X(11).
  7507         16  PB-I-MEMBER-NO               PIC X(12).
  7508         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  7509*        16  PB-I-LOAN-OFFICER            PIC XXX.
  7510         16  PB-I-OLD-LOF                 PIC XXX.
  7511         16  PB-I-LF-EXPIRE-DT            PIC XX.
  7512         16  PB-I-AH-EXPIRE-DT            PIC XX.
  7513         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  7514         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  7515         16  PB-I-LIFE-INDICATOR          PIC X.
  7516             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  7517         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  7518         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  7519                                          PIC S9(5)V99    COMP-3.
  7520         16  PB-I-MAIL-ADDRS-SW           PIC X.
  7521             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  7522             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  7523         16  PB-I-1ST-PMT-DT              PIC XX.
  7524         16  PB-I-JOINT-INSURED.
  7525             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  7526             20 PB-I-JOINT-FIRST-NAME.
  7527                24  PB-I-JOINT-FIRST-INIT PIC X.
  7528                24  FILLER                PIC X(9).
  7529             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  7530*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  7531         16  PB-I-BENEFICIARY-NAME.
  7532             20  PB-I-BANK-NUMBER         PIC X(10).
  7533             20  FILLER                   PIC X(15).
  7534         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  7535         16  PB-I-REFERENCE               PIC X(12).
  7536         16  FILLER REDEFINES PB-I-REFERENCE.
  7537             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  7538             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 145
* EL689.cbl
  7539             20  PB-I-CLP-STATE           PIC XX.
  7540         16  PB-I-UNDERWRITING-STATUS     PIC X.
  7541             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  7542             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  7543             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  7544         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  7545         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  7546         16  PB-I-RESIDENT-STATE          PIC XX.
  7547         16  PB-I-RATE-CODE               PIC X(4).
  7548         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  7549         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7550         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7551         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  7552         16  PB-I-BANK-NOCHRGB            PIC 99.
  7553         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  7554         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  7555
  7556     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  7557         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  7558             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  7559         16  PB-C-CANCEL-ORIGIN           PIC X.
  7560             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  7561         16  PB-C-LF-CANCEL-DT            PIC XX.
  7562         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7563         16  PB-C-LF-CALC-REQ             PIC X.
  7564             88 PB-COMP-LF-CANCEL            VALUE '?'.
  7565         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  7566         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  7567         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  7568             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  7569         16  PB-C-AH-CANCEL-DT            PIC XX.
  7570         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7571         16  PB-C-AH-CALC-REQ             PIC X.
  7572             88 PB-COMP-AH-CANCEL            VALUE '?'.
  7573         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  7574         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  7575         16  PB-C-LAST-NAME               PIC X(15).
  7576         16  PB-C-REFUND-SW               PIC X.
  7577             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  7578             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  7579         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  7580         16  PB-C-PAYEE-CODE              PIC X(6).
  7581         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  7582         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  7583         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  7584         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  7585         16  PB-C-REFERENCE               PIC X(12).
  7586         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7587         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7588         16  PB-C-POST-CARD-IND           PIC X.
  7589         16  PB-C-CANCEL-REASON           PIC X.
  7590         16  PB-C-REF-INTERFACE-SW        PIC X.
  7591         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  7592         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  7593         16  FILLER                       PIC X(01).
  7594*        16  FILLER                       PIC X(18).
  7595         16  PB-C-POLICY-FORM-NO          PIC X(12).
  7596*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 146
* EL689.cbl
  7597         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  7598         16  PB-CANCELED-CERT-DATA.
  7599             20  PB-CI-INSURED-NAME.
  7600                 24  PB-CI-LAST-NAME      PIC X(15).
  7601                 24  PB-CI-INITIALS       PIC XX.
  7602             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  7603             20  PB-CI-INSURED-SEX        PIC X.
  7604             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  7605             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  7606             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  7607             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  7608             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7609             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  7610             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  7611             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  7612             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  7613             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7614             20  PB-CI-RATE-CLASS         PIC XX.
  7615             20  PB-CI-RATE-DEV-LF        PIC XXX.
  7616             20  PB-CI-RATE-DEV-AH        PIC XXX.
  7617             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  7618             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  7619             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  7620             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  7621             20  PB-CI-LF-ABBR            PIC X(3).
  7622             20  PB-CI-AH-ABBR            PIC X(3).
  7623             20  PB-CI-OB-FLAG            PIC X.
  7624                 88  PB-CI-OB                VALUE 'B'.
  7625             20  PB-CI-LF-POLICY-STATUS   PIC X.
  7626                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  7627                                           'M' '4' '5' '9' '2'.
  7628                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  7629                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  7630                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  7631                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  7632                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  7633                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  7634                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  7635                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  7636                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  7637                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  7638                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  7639                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  7640                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  7641             20  PB-CI-AH-POLICY-STATUS   PIC X.
  7642                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  7643                                           'M' '4' '5' '9' '2'.
  7644                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  7645                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  7646                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  7647                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  7648                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  7649                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  7650                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  7651                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  7652                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  7653                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  7654                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 147
* EL689.cbl
  7655                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  7656                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  7657             20  PB-CI-PAY-FREQUENCY      PIC 99.
  7658             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  7659             20  PB-CI-SOC-SEC-NO         PIC X(11).
  7660             20  PB-CI-MEMBER-NO          PIC X(12).
  7661             20  PB-CI-INT-CODE           PIC X.
  7662                 88  PB-CI-ADD-ON                  VALUE 'A'.
  7663                 88  PB-CI-SIMPLE                  VALUE 'S'.
  7664             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  7665             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  7666             20  PB-CI-COMP-EXCP-SW       PIC X.
  7667                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  7668                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  7669             20  PB-CI-ENTRY-STATUS       PIC X.
  7670             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  7671             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  7672             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  7673             20  PB-CI-DEATH-DT           PIC XX.
  7674             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  7675             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  7676             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7677             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7678             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  7679             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  7680             20  PB-CI-ENTRY-DT              PIC XX.
  7681             20  PB-CI-ENTRY-BATCH           PIC X(6).
  7682             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  7683             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  7684             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  7685             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  7686             20  PB-CI-OLD-LOF               PIC XXX.
  7687*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  7688             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  7689             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  7690             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  7691             20  PB-CI-INDV-GRP-CD           PIC X.
  7692             20  PB-CI-BENEFICIARY-NAME.
  7693                 24  PB-CI-BANK-NUMBER       PIC X(10).
  7694                 24  FILLER                  PIC X(15).
  7695             20  PB-CI-NOTE-SW               PIC X.
  7696             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  7697             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  7698             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  7699             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  7700             20  PB-CI-LOAN-OFFICER          PIC X(5).
  7701             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  7702             20  PB-CI-FIRST-NAME            PIC X(10).
  7703             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  7704
  7705         16  FILLER                       PIC X(13).
  7706*032306  16  FILLER                       PIC X(27).
  7707*        16  FILLER                       PIC X(46).
  7708
  7709     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  7710         16  FILLER                       PIC X(10).
  7711         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  7712         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 148
* EL689.cbl
  7713         16  PB-M-INSURED-MID-INIT        PIC X.
  7714         16  PB-M-INSURED-AGE             PIC 99.
  7715         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  7716         16  PB-M-INSURED-SEX             PIC X.
  7717         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  7718         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  7719         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  7720         16  PB-M-INSURED-CITY-STATE.
  7721             20  PB-M-INSURED-CITY        PIC X(28).
  7722             20  PB-M-INSURED-STATE       PIC XX.
  7723         16  PB-M-INSURED-ZIP-CODE.
  7724             20  PB-M-INSURED-ZIP-PRIME.
  7725                 24  PB-M-INSURED-ZIP-1   PIC X.
  7726                     88  PB-M-CANADIAN-POST-CODE
  7727                                             VALUE 'A' THRU 'Z'.
  7728                 24  FILLER               PIC X(4).
  7729             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  7730         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  7731                                        PB-M-INSURED-ZIP-CODE.
  7732             20  PM-M-INS-CAN-POST1       PIC XXX.
  7733             20  PM-M-INS-CAN-POST2       PIC XXX.
  7734             20  FILLER                   PIC XXX.
  7735         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  7736         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  7737         16  PB-M-CRED-BENE-NAME          PIC X(30).
  7738         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  7739         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  7740         16  PB-M-CRED-BENE-CITYST.
  7741             20  PB-M-CRED-BENE-CITY      PIC X(28).
  7742             20  PB-M-CRED-BENE-STATE     PIC XX.
  7743         16  FILLER                       PIC X(92).
  7744
  7745     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  7746         16  FILLER                       PIC X(10).
  7747         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7748         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7749         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7750         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7751         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7752         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7753         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7754         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7755         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7756         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7757         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7758         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7759         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  7760         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  7761         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  7762         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  7763         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  7764         16  PB-ACCOUNT-NAME              PIC X(30).
  7765         16  PB-PREM-REF-RPT-FLAG         PIC X.
  7766         16  PB-REFERENCE                 PIC X(12).
  7767         16  PB-B-RECEIVED-DT             PIC XX.
  7768         16  FILLER                       PIC X(234).
  7769
  7770     12  PB-RECORD-STATUS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 149
* EL689.cbl
  7771         16  PB-CREDIT-SELECT-DT          PIC XX.
  7772         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  7773         16  PB-BILLED-DT                 PIC XX.
  7774         16  PB-BILLING-STATUS            PIC X.
  7775             88  PB-ENTRY-REVERSED            VALUE 'R'.
  7776             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  7777             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  7778         16  PB-RECORD-BILL               PIC X.
  7779             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  7780             88  PB-RECORD-RETURNED           VALUE 'R'.
  7781             88  PB-RECORD-ENDORSED           VALUE 'E'.
  7782             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  7783             88  PB-OVERRIDE-AH               VALUE 'A'.
  7784             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  7785         16  PB-BATCH-ENTRY               PIC X.
  7786             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  7787             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  7788             88  PB-REISSUED-CERT             VALUE 'E'.
  7789             88  PB-CASH-CERT                 VALUE 'C'.
  7790             88  PB-MONTHLY-CERT              VALUE 'M'.
  7791             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  7792             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  7793             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  7794         16  PB-FORCE-CODE                PIC X.
  7795             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  7796             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  7797             88  PB-CANCEL-FORCE              VALUE '8'.
  7798             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  7799             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  7800             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  7801             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  7802             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  7803             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  7804             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  7805             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  7806         16  PB-FATAL-FLAG                PIC X.
  7807             88  PB-FATAL-ERRORS              VALUE 'X'.
  7808         16  PB-FORCE-ER-CD               PIC X.
  7809             88  PB-FORCE-ERRORS              VALUE 'F'.
  7810             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  7811         16  PB-WARN-ER-CD                PIC X.
  7812             88  PB-WARNING-ERRORS            VALUE 'W'.
  7813         16  FILLER                       PIC X.
  7814         16  PB-OUT-BAL-CD                PIC X.
  7815             88  PB-OUT-OF-BAL                VALUE 'O'.
  7816         16  PB-LIFE-OVERRIDE-L1          PIC X.
  7817         16  PB-AH-OVERRIDE-L1            PIC X.
  7818         16  PB-INPUT-DT                  PIC XX.
  7819         16  PB-INPUT-BY                  PIC X(4).
  7820         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  7821         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  7822         16  PB-TOLERANCE-REJECT-SW       PIC X.
  7823         16  PB-LF-EARNING-METHOD         PIC X.
  7824         16  PB-AH-EARNING-METHOD         PIC X.
  7825         16  PB-LF-TERM-CALC-METHOD       PIC X.
  7826         16  PB-AH-TERM-CALC-METHOD       PIC X.
  7827         16  PB-REIN-CD                   PIC XXX.
  7828         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 150
* EL689.cbl
  7829         16  PB-AH-REFUND-TYPE            PIC X.
  7830         16  PB-ACCT-EFF-DT               PIC XX.
  7831         16  PB-ACCT-EXP-DT               PIC XX.
  7832         16  PB-COMPANY-ID                PIC X(3).
  7833         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7834         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7835         16  PB-SV-CARRIER                PIC X.
  7836         16  PB-SV-GROUPING               PIC X(6).
  7837         16  PB-SV-STATE                  PIC XX.
  7838         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  7839         16  PB-GA-BILLING-INFO.
  7840             20  PB-GA-BILL-DT OCCURS 5 TIMES
  7841                                          PIC XX.
  7842         16  PB-SV-REMIT-TO  REDEFINES
  7843             PB-GA-BILLING-INFO           PIC X(10).
  7844         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  7845         16  PB-I-LOAN-OFFICER            PIC X(5).
  7846         16  PB-I-VIN                     PIC X(17).
  7847
  7848         16  FILLER                       PIC X(04).
  7849         16  IMNET-BYPASS-SW              PIC X.
  7850
  7851******************************************************************
  7852*                COMMON EDIT ERRORS                              *
  7853******************************************************************
  7854
  7855     12  PB-COMMON-ERRORS.
  7856         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  7857                                           PIC S9(4)     COMP.
  7858
  7859******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 151
* EL689.cbl
  7861*    COPY ERCPYAJ.
  7862******************************************************************
  7863*                                                                *
  7864*                            ERCPYAJ                             *
  7865*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7866*                            VMOD=2.015                          *
  7867*                                                                *
  7868*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7869*                                                                *
  7870*                                                                *
  7871*   FILE TYPE = VSAM,KSDS                                        *
  7872*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7873*                                                                *
  7874*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7875*       ALTERNATE PATHS = NONE                                   *
  7876*                                                                *
  7877*   LOG = YES                                                    *
  7878*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7879******************************************************************
  7880******************************************************************
  7881*                   C H A N G E   L O G
  7882*
  7883* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7884*-----------------------------------------------------------------
  7885*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7886* EFFECTIVE    NUMBER
  7887*-----------------------------------------------------------------
  7888* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7889* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7890******************************************************************
  7891
  7892 01  PENDING-PAY-ADJ.
  7893     12  PY-RECORD-ID                     PIC XX.
  7894         88  VALID-PY-ID                        VALUE 'PY'.
  7895
  7896     12  PY-CONTROL-PRIMARY.
  7897         16  PY-COMPANY-CD                PIC X.
  7898         16  PY-CARRIER                   PIC X.
  7899         16  PY-GROUPING                  PIC X(6).
  7900         16  PY-FIN-RESP                  PIC X(10).
  7901         16  PY-ACCOUNT                   PIC X(10).
  7902         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7903                                          PIC X(10).
  7904         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7905         16  PY-RECORD-TYPE               PIC X.
  7906             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7907             88  PY-DEPOSIT                   VALUE 'D'.
  7908             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7909             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7910             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7911             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7912             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7913             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7914             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7915             88  PY-FICA-ENTRY                VALUE 'F'.
  7916             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7917             88  PY-POLICY-FEE                VALUE 'W'.
  7918             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 152
* EL689.cbl
  7919
  7920     12  PY-PYMT-TYPE                     PIC X.
  7921             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7922             88  PY-REINS-PYMT                VALUE 'R'.
  7923             88  PY-EXP-PYMT                  VALUE 'E'.
  7924
  7925     12  PY-BIL-INV                       PIC X(6).
  7926     12  PY-REF-NO                        PIC X(12).
  7927
  7928     12  PY-LAST-MAINT-DT                 PIC XX.
  7929     12  PY-LAST-MAINT-BY                 PIC X(4).
  7930     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7931
  7932     12  PY-PYADJ-RECORD.
  7933         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7934         16  PY-ENTRY-COMMENT             PIC X(30).
  7935         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7936             20  PY-GL-ACCOUNT            PIC X(10).
  7937             20  PY-GL-STATE              PIC X(02).
  7938             20  PY-GL-CANC-SW            PIC X(01).
  7939                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7940                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7941             20  PY-GL-COMMENT            PIC X(10).
  7942             20  FILLER      REDEFINES PY-GL-COMMENT.
  7943                 24  PY-GL-CHECK-NO       PIC 9(06).
  7944                 24  FILLER               PIC X(04).
  7945             20  FILLER                   PIC X(07).
  7946         16  PY-SAVE-ACCOUNT              PIC X(10).
  7947         16  PY-SAVE-TYPE                 PIC X(01).
  7948
  7949         16  PY-LETTERS.
  7950             20  PY-LETTER OCCURS 3 TIMES
  7951                           INDEXED BY PY-LET-NDX
  7952                                          PIC X(04).
  7953
  7954         16  PY-ERCOMP-TYPE               PIC X.
  7955             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7956             88  PY-GA-TYPE                   VALUE 'G'.
  7957             88  PY-BANK-TYPE                 VALUE 'B'.
  7958         16  FILLER                       PIC X(05).
  7959
  7960     12  PY-RECORD-STATUS.
  7961         16  PY-CREDIT-SELECT-DT          PIC XX.
  7962         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7963         16  PY-BILLED-DATE               PIC XX.
  7964         16  PY-REPORTED-DT               PIC XX.
  7965         16  PY-PMT-APPLIED               PIC X.
  7966             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7967             88  PY-GA-PMT                    VALUE 'G'.
  7968             88  PY-OVWRITE-PMT               VALUE 'O'.
  7969             88  PY-NON-AR-PMT                VALUE 'N'.
  7970         16  FILLER                       PIC X(5).
  7971         16  PY-INPUT-DT                  PIC XX.
  7972         16  PY-CHECK-NUMBER              PIC X(6).
  7973         16  PY-VOID-SW                   PIC X.
  7974             88  PY-CHECK-VOIDED              VALUE 'V'.
  7975         16  PY-CHECK-ORIGIN-SW           PIC X.
  7976             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 153
* EL689.cbl
  7977             88  PY-REFUND-CHECK              VALUE 'R'.
  7978             88  PY-GA-CHECK                  VALUE 'G'.
  7979             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7980             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7981         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7982         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7983         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7984         16  PY-BILL-FLAG                 PIC X.
  7985             88  PY-BILLED                    VALUE 'B'.
  7986         16  PY-AR-FLAG                   PIC X.
  7987             88  PY-AR-CYCLE                  VALUE 'C'.
  7988             88  PY-AR-MONTH-END              VALUE 'M'.
  7989         16  PY-AR-DATE                   PIC XX.
  7990
  7991     12  PY-GL-CODES.
  7992         16  PY-GL-DB                     PIC X(14).
  7993         16  PY-GL-CR                     PIC X(14).
  7994         16  PY-GL-FLAG                   PIC X.
  7995         16  PY-GL-DATE                   PIC XX.
  7996
  7997     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7998     12  FILLER                           PIC X(3).
  7999******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 154
* EL689.cbl
  8001*    COPY ELCTEXT.
  8002******************************************************************
  8003*                                                                *
  8004*                                                                *
  8005*                            ELCTEXT.                            *
  8006*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8007*                            VMOD=2.008                          *
  8008*                                                                *
  8009*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  8010*                                     FORM LETTERS,              *
  8011*                                     CERT FORM DISPLAY.
  8012*                                                                *
  8013*   FILE TYPE = VSAM,KSDS                                        *
  8014*   RECORD SIZE = 100   RECFORM = FIXED                          *
  8015*                                                                *
  8016*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  8017*       ALTERNATE INDEX = NONE                                   *
  8018*                                                                *
  8019*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  8020*       ALTERNATE INDEX = NONE                                   *
  8021*                                                                *
  8022*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  8023*       ALTERNATE INDEX = NONE                                   *
  8024*                                                                *
  8025*   LOG = NO                                                     *
  8026*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8027******************************************************************
  8028 01  TEXT-FILES.
  8029     12  TEXT-FILE-ID                PIC XX.
  8030         88  FORMS-FILE-TEXT            VALUE 'TF'.
  8031         88  LETTER-FILE-TEXT           VALUE 'TL'.
  8032         88  HELP-FILE-TEXT             VALUE 'TH'.
  8033
  8034     12  TX-CONTROL-PRIMARY.
  8035         16  TX-COMPANY-CD           PIC X.
  8036             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  8037         16  TX-ACCESS-CD-GENL       PIC X(12).
  8038
  8039         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  8040             20  TX-LETTER-NO        PIC X(4).
  8041             20  FILLER              PIC X(8).
  8042
  8043         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  8044             20  TX-FORM-NO          PIC X(12).
  8045
  8046         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  8047             20  TX-HELP-TYPE        PIC X.
  8048                 88  HELP-FOR-GENERAL   VALUE ' '.
  8049                 88  HELP-BY-SCREEN     VALUE 'S'.
  8050                 88  HELP-BY-ERROR      VALUE 'E'.
  8051             20  TX-SCREEN-OR-ERROR  PIC X(4).
  8052                 88  GENERAL-INFO-HELP  VALUE '0000'.
  8053             20  TX-HELP-FOR-COMPANY  PIC XXX.
  8054                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  8055             20  FILLER              PIC X(4).
  8056
  8057         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  8058
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 155
* EL689.cbl
  8059     12  TX-PROCESS-CONTROL          PIC XX.
  8060         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  8061
  8062     12  TX-TEXT-LINE                PIC X(70).
  8063
  8064     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  8065         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  8066         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  8067         88  TX-VALID-FORM-SQUEEZE-VALUE
  8068                                        VALUE 'Y' ' '.
  8069
  8070     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  8071         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  8072         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  8073         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  8074         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  8075         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  8076         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  8077         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  8078                                              'K' 'N' ' '
  8079                                              'Z'.
  8080
  8081     12  TX-ARCHIVE-SW               PIC X.
  8082         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  8083         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  8084         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  8085
  8086     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  8087     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  8088
  8089     12  TX-BSR-CODE                 PIC X.
  8090         88  TX-BSR-LETTER              VALUE 'B'.
  8091         88  TX-NON-BSR-LETTER          VALUE ' '.
  8092
  8093     12  FILLER                      PIC X.
  8094*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 156
* EL689.cbl
  8096*    COPY ERCENDT.
  8097******************************************************************
  8098*                                                                *
  8099*                                                                *
  8100*                            ERCENDT.                            *
  8101*                            VMOD=2.001                          *
  8102*                                                                *
  8103*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  8104*                                                                *
  8105*   FILE TYPE = VSAM,KSDS                                        *
  8106*   RECORD SIZE = 579  RECFORM = FIXED                           *
  8107*                                                                *
  8108*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  8109*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  8110*                                                                *
  8111*   LOG = NO                                                     *
  8112*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8113******************************************************************
  8114*-----------------------------------------------------------------
  8115*                   C H A N G E   L O G
  8116*
  8117* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8118*-----------------------------------------------------------------
  8119*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8120* EFFECTIVE    NUMBER
  8121*-----------------------------------------------------------------
  8122* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  8123*                                WITH OPEN CLAIMS
  8124* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  8125* 110612    2012101700002  AJRA  ADD NEW FIELDS
  8126* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8127* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  8128*-----------------------------------------------------------------
  8129 01  ENDORSEMENT-RECORD.
  8130     12  EN-RECORD-ID                PIC XX.
  8131         88  VALID-EN-ID                VALUE 'EN'.
  8132     12  EN-CONTROL-PRIMARY.
  8133         16  EN-COMPANY-CD           PIC X.
  8134         16  EN-CARRIER              PIC X.
  8135         16  EN-GROUPING             PIC X(6).
  8136         16  EN-STATE                PIC XX.
  8137         16  EN-ACCOUNT              PIC X(10).
  8138         16  EN-CERT-EFF-DT          PIC XX.
  8139         16  EN-CERT-NO.
  8140             20  EN-CERT-PRIME       PIC X(10).
  8141             20  EN-CERT-SFX         PIC X.
  8142         16  EN-REC-TYPE             PIC X.
  8143             88  EN-ISSUE               VALUE 'I'.
  8144             88  EN-CANCELLATION        VALUE 'C'.
  8145         16  EN-SEQ-NO               PIC 9(04) BINARY.
  8146     12  EN-CONTROL-BY-ARCH-NO.
  8147         16  EN-COMPANY-CD-A1              PIC X.
  8148         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  8149     12  EN-LAST-MAINT-DT            PIC XX.
  8150     12  EN-LAST-MAINT-BY            PIC X(4).
  8151     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  8152     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  8153     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 157
* EL689.cbl
  8154         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  8155         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  8156         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  8157         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  8158         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  8159         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  8160         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  8161         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  8162         16  EN-LF-ORIG-BENCD        PIC XX.
  8163         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  8164         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  8165         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  8166         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  8167         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  8168         16  EN-LF-ORIG-EXP-DT       PIC XX.
  8169*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  8170         16  EN-ORIG-CRED-BENE       PIC X(25).
  8171         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  8172         16  FILLER                  PIC X.
  8173         16  EN-AH-ORIG-BENCD        PIC XX.
  8174         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  8175         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  8176         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  8177         16  EN-AH-ORIG-EXP-DT       PIC XX.
  8178*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  8179*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  8180         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  8181         16  F                       PIC X(09).
  8182         16  EN-AH-ORIG-CP           PIC 99.
  8183         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  8184         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  8185         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  8186         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  8187         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  8188         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  8189         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  8190         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  8191         16  EN-LF-NEW-BENCD         PIC XX.
  8192         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  8193         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8194         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8195         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  8196         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  8197         16  EN-LF-NEW-EXP-DT        PIC XX.
  8198         16  EN-NEW-CRED-BENE        PIC X(25).
  8199         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8200         16  FILLER                  PIC X.
  8201         16  EN-AH-NEW-BENCD         PIC XX.
  8202         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  8203         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8204         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8205         16  EN-AH-NEW-EXP-DT        PIC XX.
  8206*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  8207*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  8208*        16  F                       PIC X(12).
  8209         16  EN-AH-NEW-CP            PIC 99.
  8210         16  EN-SIG-SW               PIC X.
  8211         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 158
* EL689.cbl
  8212         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  8213         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  8214         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  8215         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  8216         16  FILLER                  PIC X(33).
  8217     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8218         16  EN-LF-ORIG-REF-DT       PIC XX.
  8219         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8220         16  EN-AH-ORIG-REF-DT       PIC XX.
  8221         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8222         16  EN-LF-NEW-REF-DT        PIC XX.
  8223         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8224         16  EN-AH-NEW-REF-DT        PIC XX.
  8225         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8226         16  EN-FLAG-CERT            PIC X.
  8227         16  EN-INS-LAST-NAME        PIC X(15).
  8228         16  EN-INS-FIRST-NAME       PIC X(10).
  8229         16  EN-INS-MIDDLE-INIT      PIC X.
  8230         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8231         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8232         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8233         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8234         16  FILLER                  PIC X(262).
  8235     12  EN-MONEY-SW             PIC X.
  8236     12  EN-HEALTH-APP           PIC X.
  8237     12  EN-VOUCHER-SW           PIC X.
  8238     12  EN-PAYEE                PIC X(14).
  8239     12  EN-INPUT-DT             PIC XX.
  8240     12  EN-PROCESS-DT           PIC XX.
  8241     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8242     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8243     12  EN-REASON-CODES.
  8244         16  F OCCURS 12.
  8245             20  EN-REASON-CODE  PIC X(4).
  8246     12  EN-TEMPLATE-USED        PIC X(8).
  8247     12  EN-DOCU-TYPE            PIC X.
  8248         88  EN-VERI-DOCU          VALUE 'V'.
  8249         88  EN-GCE-DOCU           VALUE 'G'.
  8250         88  EN-CANC-DOCU          VALUE 'C'.
  8251     12  EN-COMMENTS1            PIC X(13).
  8252     12  EN-COMMENTS2            PIC X(70).
  8253     12  EN-COMM-CHGBK           PIC X.
  8254         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8255         88  EN-CHG-ACCT           VALUE 'Y'.
  8256     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8257     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8258     12  EN-BATCH-NUMBER         PIC X(6).
  8259     12  EN-ACCT-SUMM            PIC X.
  8260     12  EN-CSO-SUMM             PIC X.
  8261     12  en-check-type           pic x.
  8262     12  FILLER                  PIC X(12).
  8263******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 159
* EL689.cbl
  8265*    COPY ERCNOTE.
  8266******************************************************************
  8267*                                                                *
  8268*                                                                *
  8269*                            ERCNOTE                             *
  8270*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8271*                            VMOD=2.003                          *
  8272*                                                                *
  8273*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  8274*                                                                *
  8275*        FILE TYPE= VSAM,KSDS                                    *
  8276*        RECORD SIZE = 825    RECFORM = FIXED                    *
  8277*                                                                *
  8278*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  8279*                                                                *
  8280*        LOG = YES                                               *
  8281*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  8282*                                                                *
  8283******************************************************************
  8284*                   C H A N G E   L O G
  8285*
  8286* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8287*-----------------------------------------------------------------
  8288*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8289* EFFECTIVE    NUMBER
  8290*-----------------------------------------------------------------
  8291* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  8292*                                FILE WILL CONTAIN BILLING NOTES O
  8293******************************************************************
  8294
  8295 01  CERTIFICATE-NOTE.
  8296     12  CN-RECORD-ID                PIC  XX.
  8297         88  VALID-CN-ID                  VALUE 'CN'.
  8298
  8299     12  CN-CONTROL-PRIMARY.
  8300         16  CN-COMPANY-CD           PIC X.
  8301         16  CN-CARRIER              PIC X.
  8302         16  CN-GROUPING.
  8303             20 CN-GROUPING-PREFIX   PIC XXX.
  8304             20 CN-GROUPING-PRIME    PIC XXX.
  8305         16  CN-STATE                PIC XX.
  8306         16  CN-ACCOUNT.
  8307             20 CN-ACCOUNT-PREFIX    PIC X(4).
  8308             20 CN-ACCOUNT-PRIME     PIC X(6).
  8309         16  CN-CERT-EFF-DT          PIC XX.
  8310         16  CN-CERT-NO.
  8311             20  CN-CERT-PRIME       PIC X(10).
  8312             20  CN-CERT-SFX         PIC X.
  8313
  8314     12  CN-BILLING-START-LINE-NO    PIC 99.
  8315     12  CN-BILLING-END-LINE-NO      PIC 99.
  8316
  8317     12  CN-LINES.
  8318         16  CN-LINE OCCURS 10       PIC X(77).
  8319
  8320     12  CN-LAST-MAINT-DT            PIC XX.
  8321     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8322     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 160
* EL689.cbl
  8323     12  FILLER                      PIC X(6).
  8324******************************************************************
  8325*    COPY ELCEOBC.
  8326******************************************************************
  8327*                                                                *
  8328*                                                                *
  8329*                            ELCEOBC                             *
  8330*                            VMOD=2.001                          *
  8331*                                                                *
  8332*   CLAIM SYSTEM EOB CODE TABLE                                  *
  8333*                                                                *
  8334*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  8335*   VSAM EOB CODE TABLE                                          *
  8336*                                                                *
  8337*   FILE DESCRIPTION = EOB CODE TABLE                            *
  8338*                                                                *
  8339*   FILE TYPE = VSAM,KSDS                                        *
  8340*   RECORD SIZE = 350   RECFORM = FIX                            *
  8341*                                                                *
  8342*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  8343*                                                                *
  8344*   LOG = NO                                                     *
  8345*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8346*                                                                *
  8347*                                                                *
  8348******************************************************************
  8349*                   C H A N G E   L O G
  8350*
  8351* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8352*-----------------------------------------------------------------
  8353*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8354* EFFECTIVE    NUMBER
  8355*-----------------------------------------------------------------
  8356* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  8357* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  8358* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  8359******************************************************************
  8360 01  EOB-CODES.
  8361     12  EO-RECORD-ID                      PIC XX.
  8362         88  VALID-DN-ID                      VALUE 'EO'.
  8363     12  EO-CONTROL-PRIMARY.
  8364         16  EO-COMPANY-CD                 PIC X.
  8365         16  EO-RECORD-TYPE                PIC X.
  8366             88  EO-EOB-RECS                  VALUE '1'.
  8367             88  EO-VERIF-RECS                VALUE '2'.
  8368             88  EO-GCE-RECS                  VALUE '3'.
  8369             88  EO-CANC-RECS                 VALUE '4'.
  8370             88  EO-BILL-NOTE-RECS            VALUE '5'.
  8371         16  EO-EOB-CODE                   PIC X(4).
  8372         16  FILLER                        PIC X(9).
  8373     12  EO-MAINT-INFORMATION.
  8374         16  EO-LAST-MAINT-DT              PIC XX.
  8375         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  8376         16  EO-LAST-MAINT-USER            PIC X(4).
  8377         16  FILLER                        PIC XX.
  8378     12  EO-DESCRIPTION                    PIC X(275).
  8379     12  FILLER                            PIC X(46).
  8380******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 161
* EL689.cbl
  8382*    COPY ELCENCC.
  8383******************************************************************
  8384*                                                                *
  8385*                                                                *
  8386*                            ELCENCC                             *
  8387*                            VMOD=2.001                          *
  8388*                                                                *
  8389*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  8390*                                                                *
  8391*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  8392*   A NAPERSOFT DOCUMENT                                         *
  8393*                                                                *
  8394*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  8395*                                                                *
  8396*   FILE TYPE = VSAM,KSDS                                        *
  8397*   RECORD SIZE = 400   RECFORM = FIX                            *
  8398*                                                                *
  8399*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  8400*                                                                *
  8401*   LOG = NO                                                     *
  8402*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8403*                                                                *
  8404*                                                                *
  8405******************************************************************
  8406*                   C H A N G E   L O G
  8407*
  8408* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8409*-----------------------------------------------------------------
  8410*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8411* EFFECTIVE    NUMBER
  8412*-----------------------------------------------------------------
  8413* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  8414* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  8415******************************************************************
  8416 01  ENCLOSURE-CODES.
  8417     12  NC-RECORD-ID                      PIC XX.
  8418         88  VALID-NC-ID                      VALUE 'NC'.
  8419     12  NC-CONTROL-PRIMARY.
  8420         16  NC-COMPANY-CD                 PIC X.
  8421         16  NC-REC-TYPE                   PIC X.
  8422             88  NC-CLAIMS                   VALUE '1'.
  8423             88  NC-ADMIN                    VALUE '2'.
  8424         16  NC-ENC-CODE                   PIC X(5).
  8425         16  FILLER                        PIC X(09).
  8426     12  NC-MAINT-INFORMATION.
  8427         16  NC-LAST-MAINT-DT              PIC XX.
  8428         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  8429         16  NC-LAST-MAINT-USER            PIC X(4).
  8430         16  FILLER                        PIC XX.
  8431     12  NC-OUTPUT-STACK                   PIC XXX.
  8432     12  NC-ENCLOSURE-LINE                 PIC X(100).
  8433     12  NC-ATTACHMENTS                    PIC X(255).
  8434     12  NC-FUTURE                         PIC X(12).
  8435******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 162
* EL689.cbl
  8437 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  8438                          ACCOUNT-MASTER LETTER-ARCHIVE
  8439                          LETTER-ARCHIVE-TEXT
  8440                          CERTIFICATE-MASTER CHECK-RECORDS
  8441                          CONTROL-FILE COMPENSATION-MASTER
  8442                          MAILING-DATA PENDING-BUSINESS
  8443                          PENDING-PAY-ADJ TEXT-FILES
  8444                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  8445                          EOB-CODES ENCLOSURE-CODES.
  8446 0000-DFHEXIT SECTION.
  8447     MOVE '9#                    $   ' TO DFHEIV0.
  8448     MOVE 'EL689' TO DFHEIV1.
  8449     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8450     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  8451
  8452     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8453     MOVE '5'                    TO DC-OPTION-CODE.
  8454     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  8455     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  8456     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  8457                                    W-CURRENT-SAVE.
  8458     MOVE DC-GREG-DATE-A-EDIT    TO W-SAVE-EDIT-A-DATE
  8459     MOVE DC-DAY-OF-WEEK         TO W-SAVE-CYCLE-DAY-OF-WEEK
  8460
  8461     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8462     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  8463                                 TO EMI-SAVE-AREA.
  8464
  8465     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8466                                    W-TS-TERM-SCREEN.
  8467
  8468     IF  EIBCALEN EQUAL 0
  8469         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  8470         GO TO 8300-SEND-TEXT
  8471     END-IF.
  8472     set P to address of KIXSYS
  8473     CALL "getenv" using by value P returning var-ptr
  8474     if var-ptr = null then
  8475        display ' kixsys not set '
  8476     else
  8477        set address of var to var-ptr
  8478        move 0 to env-var-len
  8479        inspect var tallying env-var-len
  8480          for characters before X'00'
  8481*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  8482        unstring var (1:env-var-len) delimited by '/'
  8483           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8484              WS-KIX-SYS
  8485        end-unstring
  8486*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  8487*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8488     end-if
  8489     set P to address of KIXHOST
  8490     CALL "getenv" using by value P returning var-ptr
  8491     if var-ptr = null then
  8492        display ' kixhost not set '
  8493     else
  8494        set address of var to var-ptr
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 163
* EL689.cbl
  8495        move 0 to env-var-len
  8496        inspect var tallying env-var-len
  8497          for characters before X'00'
  8498*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  8499        MOVE var(1:env-var-len)  to ws-kixhost
  8500*       unstring var (1:env-var-len) delimited by '/'
  8501*          into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8502*             WS-KIX-SYS
  8503*       end-unstring
  8504        DISPLAY ' WS KIX HOST ' WS-KIXSYS
  8505*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8506     end-if
  8507
  8508**** This routine will connect to the Logic Database on SQL Server
  8509**** and call a stored procedure to determine the next business da
  8510
  8511     PERFORM 4500-CONNECT-TO-DB  THRU 4500-EXIT
  8512     IF SQLCODE = 0
  8513        PERFORM 4600-GET-NEXT-BUS-DT  THRU 4600-EXIT
  8514        IF SQLCODE = 0
  8515            MOVE WS-NEXT-BUS-DT TO W-SAVE-NEXT-BUS-DT-EDIT-A
  8516                                   W-EDIT-A-DATE
  8517            MOVE W-EDIT-A-YY    TO DC-YMD-YEAR
  8518            MOVE W-EDIT-A-MM    TO DC-YMD-MONTH
  8519            MOVE W-EDIT-A-DD    TO DC-YMD-DAY
  8520            MOVE '3'            TO DC-OPTION-CODE
  8521            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8522            IF NO-CONVERSION-ERROR
  8523               MOVE DC-BIN-DATE-1 TO W-SAVE-BIN-NEXT-BUS-DT
  8524            ELSE
  8525               MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8526               MOVE '6'         TO DC-OPTION-CODE
  8527               MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8528               IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
  8529                  MOVE 3        TO DC-ELAPSED-DAYS
  8530               ELSE
  8531                 IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8532                    MOVE 2     TO DC-ELAPSED-DAYS
  8533                 ELSE
  8534                    MOVE 1     TO DC-ELAPSED-DAYS
  8535                 END-IF
  8536               END-IF
  8537               PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8538               IF NO-CONVERSION-ERROR
  8539                   MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8540                   MOVE DC-GREG-DATE-A-EDIT TO
  8541                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8542               ELSE
  8543                   MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8544                   MOVE W-SAVE-EDIT-A-DATE TO
  8545                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8546               END-IF
  8547            END-IF
  8548        ELSE
  8549            MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8550            MOVE '6'         TO DC-OPTION-CODE
  8551            MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8552            IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 164
* EL689.cbl
  8553               MOVE 3        TO DC-ELAPSED-DAYS
  8554            ELSE
  8555              IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8556                 MOVE 2     TO DC-ELAPSED-DAYS
  8557              ELSE
  8558                 MOVE 1     TO DC-ELAPSED-DAYS
  8559              END-IF
  8560            END-IF
  8561            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8562            IF NO-CONVERSION-ERROR
  8563                MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8564                MOVE DC-GREG-DATE-A-EDIT TO
  8565                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8566            ELSE
  8567                MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8568                MOVE W-SAVE-EDIT-A-DATE TO
  8569                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8570            END-IF
  8571        END-IF
  8572     ELSE
  8573        MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8574        MOVE '6'         TO DC-OPTION-CODE
  8575        MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8576        IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
  8577           MOVE 3        TO DC-ELAPSED-DAYS
  8578        ELSE
  8579          IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8580             MOVE 2     TO DC-ELAPSED-DAYS
  8581          ELSE
  8582             MOVE 1     TO DC-ELAPSED-DAYS
  8583          END-IF
  8584        END-IF
  8585        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8586        IF NO-CONVERSION-ERROR
  8587            MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8588            MOVE DC-GREG-DATE-A-EDIT TO
  8589                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8590        ELSE
  8591            MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8592            MOVE W-SAVE-EDIT-A-DATE TO
  8593                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8594        END-IF
  8595     END-IF
  8596     PERFORM 4700-DISCONNECT THRU 4700-EXIT
  8597
  8598     IF  PI-689-CREATE-NO-SCREENS
  8599         GO TO 0600-BYPASS-SCREEN-CNTL
  8600     END-IF.
  8601
  8602     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  8603         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  8604             MOVE PI-SAVED-PROGRAM-5
  8605                                 TO PI-SAVED-PROGRAM-6
  8606             MOVE PI-SAVED-PROGRAM-4
  8607                                 TO PI-SAVED-PROGRAM-5
  8608             MOVE PI-SAVED-PROGRAM-3
  8609                                 TO PI-SAVED-PROGRAM-4
  8610             MOVE PI-SAVED-PROGRAM-2
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 165
* EL689.cbl
  8611                                 TO PI-SAVED-PROGRAM-3
  8612             MOVE PI-SAVED-PROGRAM-1
  8613                                 TO PI-SAVED-PROGRAM-2
  8614             MOVE PI-RETURN-TO-PROGRAM
  8615                                 TO PI-SAVED-PROGRAM-1
  8616             MOVE PI-CALLING-PROGRAM
  8617                                 TO PI-RETURN-TO-PROGRAM
  8618             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  8619             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8620             MOVE LOW-VALUES     TO EL689AO
  8621             PERFORM 9905-INITIALIZE-SECURITY THRU 9905-EXIT
  8622             IF PI-689-ARCHIVE-NUMBER NOT NUMERIC
  8623                MOVE ZEROS       TO PI-689-ARCHIVE-NUMBEr
  8624             END-IF
  8625             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  8626                     AND
  8627                 PI-689-KEY-DATA-FIELDS GREATER THAN LOW-VALUES
  8628                 GO TO 0400-EL6311-INCOMING
  8629             ELSE
  8630                 MOVE PI-689-ARCHIVE-NUMBER
  8631                                 TO W-INCOMING-ARCHIVE
  8632                 MOVE LOW-VALUES TO PI-1042-WA
  8633                                    PI-689-WORK-AREA
  8634                 MOVE ZEROS      TO PI-CURRENT-LINE
  8635                                    PI-TEMP-STOR-ITEMS
  8636                                    PI-TOTAL-LINES
  8637                                    PI-UPDATE-SW
  8638                                    PI-689-NUMBER-LABEL-LINES
  8639                                    PI-689-NUMBER-TEXT-RECORDS
  8640                                    PI-689-ERROR
  8641                 MOVE SPACES     TO PI-689-PRINT-SW
  8642                                    PI-689-ALT-PRINTER-ID
  8643                                    PI-689-LBL-OVERRIDE
  8644                                    PI-COMM-CONTROL
  8645                                    PI-689-FORM-NUMBER
  8646                                    PI-689-TEMP-STOR-ID
  8647                                    PI-689-LABEL-SOURCE
  8648                                    PI-689-USE-SCREEN-IND
  8649                 MOVE '2'        TO PI-ACTION
  8650                 MOVE -1         TO MAINTL
  8651                 MOVE PI-LOWER-CASE-LETTERS
  8652                                 TO W-LC-CASE-IND
  8653                 IF  W-INCOMING-ARCHIVE NUMERIC
  8654                         AND
  8655                     W-INCOMING-ARCH-NO GREATER THAN ZEROS
  8656                     MOVE 'S'    TO MAINTI
  8657                     MOVE +1     TO MAINTL
  8658                     MOVE AL-UANON
  8659                                 TO MAINTA
  8660                     MOVE W-INCOMING-ARCH-NO
  8661                                 TO ARCHNUMI
  8662                     MOVE +8     TO ARCHNUML
  8663                     MOVE AL-UNNON
  8664                                 TO ARCHNUMA
  8665                     GO TO 1000-SHOW
  8666                 ELSE
  8667                     GO TO 0450-SPECIAL-INPUT-PROCESS
  8668                 END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 166
* EL689.cbl
  8669             END-IF
  8670         ELSE
  8671             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  8672             MOVE PI-RETURN-TO-PROGRAM
  8673                                     TO PI-CALLING-PROGRAM
  8674             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  8675             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  8676             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  8677             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  8678             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  8679             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  8680             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  8681             PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8682             MOVE LOW-VALUES         TO EL689AO
  8683             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8684             SET W-RG-NDX            TO PI-CURRENT-LINE
  8685             PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8686                 VARYING
  8687                     W-SC-NDX FROM 1 BY 1
  8688                 UNTIL
  8689                     W-SC-NDX GREATER THAN
  8690                     W-NUM-LINES-PER-SCREEN
  8691             MOVE PI-689-ALT-PRINTER-ID
  8692                                     TO PRINTERO
  8693             MOVE AL-UANON           TO PRINTERA
  8694             MOVE -1                 TO PRINTERL
  8695             GO TO 8100-SEND-INITIAL-MAP
  8696         END-IF
  8697     END-IF.
  8698
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 167
* EL689.cbl
  8700 0200-RECEIVE.
  8701
  8702     MOVE PI-689-FATAL-CTR       TO EMI-FATAL-CTR
  8703     MOVE PI-689-FORCABLE-CTR    TO EMI-FORCABLE-CTR
  8704     IF  EMI-FATAL-CTR GREATER THAN ZEROS
  8705             OR
  8706         EMI-FORCABLE-CTR GREATER THAN ZEROS
  8707         MOVE 'Y'                TO W-HOLD-IND.
  8708
  8709     MOVE W-TRANSACTION          TO EIBTRNID.
  8710     MOVE EMI-SAVE-AREA          TO ERROR-MESSAGE-INTERFACE-BLOCK.
  8711     MOVE ZEROS                  TO W-LAST-ERROR.
  8712     MOVE LOW-VALUES             TO EL689AI.
  8713     MOVE '104A'                 TO W-TS-ID-TEXT.
  8714     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8715                                    W-TS-TERM-SCREEN.
  8716
  8717
  8718* EXEC CICS HANDLE AID
  8719*        CLEAR    (9300-DFHCLEAR)
  8720*        PA1      (9200-PA)
  8721*        PA2      (9200-PA)
  8722*        PA3      (9200-PA)
  8723*    END-EXEC.
  8724*    MOVE '"&=!"#               V! " #00008620' TO DFHEIV0
  8725     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  8726     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  8727     MOVE X'2220233030303038363230' TO DFHEIV0(25:11)
  8728     CALL 'kxdfhei1' USING DFHEIV0
  8729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8730
  8731
  8732
  8733* EXEC CICS HANDLE CONDITION
  8734*        PGMIDERR (9700-PGMID-ERROR)
  8735*        ERROR    (9800-ABEND)
  8736*        MAPFAIL  (0325-MAPFAIL)
  8737*    END-EXEC.
  8738*    MOVE '"$L.?                 ! # #00008627' TO DFHEIV0
  8739     MOVE X'22244C2E3F20202020202020' TO DFHEIV0(1:12)
  8740     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8741     MOVE X'2320233030303038363237' TO DFHEIV0(25:11)
  8742     CALL 'kxdfhei1' USING DFHEIV0
  8743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8744
  8745
  8746
  8747* EXEC CICS SYNCPOINT
  8748*    END-EXEC.
  8749*    MOVE '6"                    !   #00008633' TO DFHEIV0
  8750     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  8751     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8752     MOVE X'2020233030303038363333' TO DFHEIV0(25:11)
  8753     CALL 'kxdfhei1' USING DFHEIV0
  8754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8755
  8756
  8757     IF PI-LOWER-CASE-LETTERS = 'Y'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 168
* EL689.cbl
  8758*    IF  W-LC-USE-BOTH-CASES
  8759
  8760* EXEC CICS RECEIVE
  8761*            MAP      (W-MAP)
  8762*            MAPSET   (W-MAPSET)
  8763*            INTO     (EL689AI)
  8764*            ASIS
  8765*        END-EXEC
  8766     MOVE LENGTH OF
  8767      EL689AI
  8768       TO DFHEIV11
  8769*    MOVE '8"TAI  L              ''   #00008638' TO DFHEIV0
  8770     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8771     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8772     MOVE X'2020233030303038363338' TO DFHEIV0(25:11)
  8773     CALL 'kxdfhei1' USING DFHEIV0,
  8774           W-MAP,
  8775           EL689AI,
  8776           DFHEIV11,
  8777           W-MAPSET,
  8778           DFHEIV99,
  8779           DFHEIV99
  8780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8781     ELSE
  8782
  8783* EXEC CICS RECEIVE
  8784*            MAP      (W-MAP)
  8785*            MAPSET   (W-MAPSET)
  8786*            INTO     (EL689AI)
  8787*        END-EXEC.
  8788     MOVE LENGTH OF
  8789      EL689AI
  8790       TO DFHEIV11
  8791*    MOVE '8"T I  L              ''   #00008645' TO DFHEIV0
  8792     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8793     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8794     MOVE X'2020233030303038363435' TO DFHEIV0(25:11)
  8795     CALL 'kxdfhei1' USING DFHEIV0,
  8796           W-MAP,
  8797           EL689AI,
  8798           DFHEIV11,
  8799           W-MAPSET,
  8800           DFHEIV99,
  8801           DFHEIV99
  8802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8803
  8804
  8805     IF  NOT DISPLAY-CAP
  8806         MOVE 'READ'             TO SM-READ
  8807         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8808         MOVE ER-9097            TO EMI-ERROR
  8809         MOVE -1                 TO MAINTL
  8810         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8811         GO TO 8100-SEND-INITIAL-MAP.
  8812
  8813     INSPECT MAINTI CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
  8814
  8815     IF  ENTERPFL EQUAL 0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 169
* EL689.cbl
  8816         GO TO 0300-CHECK-PFKEYS.
  8817
  8818     IF  EIBAID NOT EQUAL DFHENTER
  8819         MOVE ER-0004            TO EMI-ERROR
  8820         GO TO 0320-INPUT-ERROR.
  8821
  8822     IF  ENTERPFI NUMERIC
  8823             AND
  8824         ENTERPFI GREATER THAN 0
  8825             AND
  8826         ENTERPFI LESS THAN 25
  8827         MOVE PF-VALUES (ENTERPFI)
  8828                                 TO EIBAID
  8829     ELSE
  8830         MOVE ER-0029            TO EMI-ERROR
  8831         GO TO 0320-INPUT-ERROR.
  8832
  8833 0300-CHECK-PFKEYS.
  8834
  8835     IF  EIBAID EQUAL DFHPF23
  8836         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8837         MOVE ZEROS              TO PI-TOTAL-LINES
  8838                                    PI-CURRENT-LINE
  8839         MOVE EIBAID             TO PI-ENTRY-CD-1
  8840         MOVE W-XCTL-005         TO W-CALL-PGM
  8841         GO TO 9400-XCTL.
  8842
  8843     IF  EIBAID EQUAL DFHPF24
  8844         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8845         MOVE ZEROS              TO PI-TOTAL-LINES
  8846                                    PI-CURRENT-LINE
  8847         MOVE W-XCTL-626         TO W-CALL-PGM
  8848         GO TO 9400-XCTL.
  8849
  8850     MOVE SPACES                 TO W-KEY-FIELDS-CHANGED-IND
  8851                                    W-FORM-CHANGED-IND.
  8852
  8853     IF  PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8854             OR
  8855         PI-SHOW-MODE
  8856         NEXT SENTENCE
  8857     ELSE
  8858         IF  PI-689-FORM-NUMBER GREATER THAN SPACES
  8859                 AND
  8860             FORML NOT EQUAL ZEROS
  8861                 AND
  8862             PI-689-FORM-NUMBER NOT EQUAL FORMI
  8863             MOVE FORMI          TO PI-689-FORM-NUMBER
  8864             MOVE LOW-VALUES     TO EL689AI
  8865                                    PI-1042-WA
  8866                                    PI-689-FOLLOW-UP-DATE
  8867                                    PI-689-PRINT-RESTRICTION
  8868                                    PI-689-RESEND-DATE-1
  8869                                    PI-689-RESEND1-EDIT
  8870                                    PI-689-FOLLOW-UP-DATE
  8871                                    PI-689-FOLLOW-UP-EDIT
  8872                                    PI-689-ERROR-IND
  8873             MOVE ZEROS          TO PI-689-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 170
* EL689.cbl
  8874                                    PI-689-NUMBER-COPIES
  8875                                    PI-689-NUMBER-LABEL-LINES
  8876                                    PI-689-NUMBER-TEXT-RECORDS
  8877                                    PI-CURRENT-LINE
  8878                                    PI-TEMP-STOR-ITEMS
  8879                                    PI-TOTAL-LINES
  8880                                    PI-UPDATE-SW
  8881             MOVE SPACES         TO PI-689-PRINT-SW
  8882                                    PI-689-ALT-PRINTER-ID
  8883                                    PI-COMM-CONTROL
  8884                                    PI-689-TEMP-STOR-ID
  8885                                    PI-689-USE-SCREEN-IND
  8886                                    PI-689-RESEND-LETR-1
  8887                                    PI-CERT-FORM-ID
  8888                                    PI-CERT-REQ-IND
  8889                                    PI-REASON-REQ-IND
  8890             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8891             MOVE DFHENTER       TO EIBAID
  8892             MOVE 'Y'            TO W-FORM-CHANGED-IND
  8893             GO TO 0330-FUNCTION-CHECK
  8894         ELSE
  8895             IF  PI-689-DATA-SOURCE NOT EQUAL DATASORI
  8896                     OR
  8897                 (PI-689-LABEL-SOURCE NOT EQUAL ADDRSI
  8898                         AND
  8899                     (PI-689-LABEL-SOURCE NOT EQUAL SPACES
  8900                             OR
  8901                         ADDRSI NOT EQUAL LOW-VALUES))
  8902                     OR
  8903                 PI-689-CARRIER NOT EQUAL CARRIERI
  8904                     OR
  8905                 PI-689-GROUPING NOT EQUAL GROUPI
  8906                     OR
  8907                 PI-689-STATE NOT EQUAL STATEI
  8908                     OR
  8909                 PI-689-ACCOUNT NOT EQUAL ACCTI
  8910                     OR
  8911                 PI-689-CERT-PRIME NOT EQUAL CERTI
  8912                     OR
  8913                 PI-689-CERT-SFX NOT EQUAL SFXI
  8914                     OR
  8915                 PI-689-TYPE NOT EQUAL TYPEI
  8916                     OR
  8917                 PI-689-DATE-EDIT NOT EQUAL DATEI
  8918                     OR
  8919                 PI-689-RESP-PERSON NOT EQUAL RPERSONI
  8920                     OR
  8921                 PI-689-SEQ-EDIT NOT EQUAL SEQI
  8922                     OR
  8923                 PI-689-ENTRY-BATCH NOT EQUAL BENTRYI
  8924                     OR
  8925                 PI-689-BCSEQ-EDIT NOT EQUAL BCSEQI
  8926                 MOVE 'Y'        TO W-KEY-FIELDS-CHANGED-IND
  8927                 MOVE DFHENTER   TO EIBAID
  8928                 GO TO 0330-FUNCTION-CHECK.
  8929
  8930*    IF  EIBAID EQUAL DFHPF1
  8931*        MOVE +7                 TO W-ROLL-COUNTER
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 171
* EL689.cbl
  8932*        GO TO 4000-ROLL-PAGE.
  8933
  8934*    IF  EIBAID EQUAL DFHPF2
  8935*        MOVE -7                 TO W-ROLL-COUNTER
  8936*        GO TO 4000-ROLL-PAGE.
  8937
  8938*    IF  EIBAID EQUAL DFHPF3
  8939*        IF  W-HOLD-ON
  8940*            MOVE ER-7245        TO EMI-ERROR
  8941*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8942*            MOVE -1             TO MAINTL
  8943*            MOVE AL-UABON       TO MAINTA
  8944*            GO TO 8200-SEND-DATAONLY
  8945*        ELSE
  8946*            GO TO 0330-FUNCTION-CHECK.
  8947*    IF (EIBAID = DFHPF8)
  8948*       AND (PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR
  8949*         'CAGB' OR 'DLVA' OR 'ECCA' OR 'KRHA' OR 'ALWA')
  8950*       MOVE ER-0029             TO EMI-ERROR
  8951*       GO TO 0320-INPUT-ERROR
  8952*    END-IF
  8953*    IF EIBAID = DFHPF4 OR DFHPF8
  8954*        IF  W-HOLD-ON
  8955*            MOVE ER-7245        TO EMI-ERROR
  8956*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8957*            MOVE -1             TO MAINTL
  8958*            MOVE AL-UABON       TO MAINTA
  8959*            GO TO 8200-SEND-DATAONLY
  8960*        ELSE
  8961*            GO TO 0330-FUNCTION-CHECK.
  8962
  8963*    IF  EIBAID = DFHPF5
  8964*        COMPUTE W-ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  8965*        GO TO 4000-ROLL-PAGE.
  8966
  8967*    IF  EIBAID = DFHPF6
  8968*        MOVE PI-TOTAL-LINES     TO W-ROLL-COUNTER
  8969*        GO TO 4000-ROLL-PAGE.
  8970
  8971     IF  EIBAID EQUAL DFHPF7
  8972         IF PI-PROMPT-IND EQUAL 'Y'
  8973             MOVE ER-0894        TO EMI-ERROR
  8974             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8975             MOVE -1             TO MAINTL
  8976             MOVE AL-UABON       TO MAINTA
  8977             GO TO 8200-SEND-DATAONLY
  8978         END-IF
  8979     END-IF.
  8980
  8981     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8982         IF  W-HOLD-ON
  8983             MOVE ER-7245        TO EMI-ERROR
  8984             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8985             MOVE -1             TO MAINTL
  8986             MOVE AL-UABON       TO MAINTA
  8987             GO TO 8200-SEND-DATAONLY
  8988         ELSE
  8989             GO TO 0330-FUNCTION-CHECK.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 172
* EL689.cbl
  8990
  8991     IF  EIBAID EQUAL DFHENTER
  8992         GO TO 0330-FUNCTION-CHECK.
  8993
  8994     MOVE ER-0029                TO EMI-ERROR.
  8995
  8996 0320-INPUT-ERROR.
  8997
  8998     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8999
  9000     IF  ENTERPFL EQUAL 0
  9001         MOVE -1                 TO MAINTL
  9002         MOVE AL-UABON           TO MAINTA
  9003     ELSE
  9004         MOVE AL-UNBON           TO ENTERPFA
  9005         MOVE -1                 TO ENTERPFL.
  9006
  9007     GO TO 8200-SEND-DATAONLY.
  9008
  9009 0325-MAPFAIL.
  9010***********************************************************
  9011*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  9012*      LETTERS ON A 3275 PRINTER.                         *
  9013***********************************************************
  9014
  9015     PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  9016
  9017     SET W-RG-NDX                TO PI-CURRENT-LINE.
  9018     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  9019             VARYING
  9020         W-SC-NDX FROM 1 BY 1
  9021             UNTIL
  9022         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  9023
  9024     MOVE -1                     TO MAINTL.
  9025     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 173
* EL689.cbl
  9027 0330-FUNCTION-CHECK.
  9028
  9029     IF  MAINTI EQUAL 'S'
  9030*        IF EIBAID = DFHPF4 OR DFHPF8
  9031*            GO TO 7900-PRINT-LETTER-NOW
  9032*        ELSE
  9033             GO TO 1000-SHOW.
  9034
  9035     IF  NOT MODIFY-CAP
  9036         MOVE 'UPDATE'           TO SM-READ
  9037         PERFORM 9995-SECURITY-VIOLATION
  9038         MOVE ER-0070            TO EMI-ERROR
  9039         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9040         MOVE -1                 TO MAINTL
  9041         GO TO 8100-SEND-INITIAL-MAP.
  9042
  9043     IF  W-FORM-CHANGED
  9044             OR
  9045         W-KEY-FIELDS-CHANGED
  9046         GO TO 0330-EDIT.
  9047
  9048     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  9049
  9050
  9051*    IF  EIBAID EQUAL DFHPF3
  9052*        IF  PI-NO-CARRIER-SECURITY
  9053*                AND
  9054*            PI-NO-ACCOUNT-SECURITY
  9055*            GO TO 5000-EDIT-MODE.
  9056
  9057     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  9058         IF  PI-NO-CARRIER-SECURITY
  9059                 AND
  9060             PI-NO-ACCOUNT-SECURITY
  9061             GO TO 5400-LETTER-RELEASE
  9062         ELSE
  9063             IF  PI-689-PRINT-PERFORMED
  9064                 GO TO 5400-LETTER-RELEASE
  9065             ELSE
  9066                 MOVE AL-UNBON TO ENTERPFA
  9067                 MOVE -1       TO ENTERPFL
  9068                 MOVE ER-2398  TO EMI-ERROR
  9069                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9070                 GO TO 8200-SEND-DATAONLY.
  9071
  9072*    IF  EIBAID = DFHPF4 OR DFHPF8
  9073*        GO TO 7900-PRINT-LETTER-NOW.
  9074
  9075 0330-EDIT.
  9076
  9077     IF  W-SC-TEXTL (1) NOT EQUAL ZEROS
  9078             OR
  9079         W-SC-TEXTL (2) NOT EQUAL ZEROS
  9080             OR
  9081         W-SC-TEXTL (3) NOT EQUAL ZEROS
  9082             OR
  9083         W-SC-TEXTL (4) NOT EQUAL ZEROS
  9084             OR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 174
* EL689.cbl
  9085         W-SC-TEXTL (5) NOT EQUAL ZEROS
  9086             OR
  9087         W-SC-TEXTL (6) NOT EQUAL ZEROS
  9088             OR
  9089         W-SC-TEXTL (7) NOT EQUAL ZEROS
  9090             OR
  9091         W-SC-TEXTL (8) NOT EQUAL ZEROS
  9092             OR
  9093         W-SC-TEXTL (9) NOT EQUAL ZEROS
  9094             OR
  9095         W-SC-TEXTL (10) NOT EQUAL ZEROS
  9096             OR
  9097         W-SC-TEXTL (11) NOT EQUAL ZEROS
  9098         IF  W-KEY-FIELDS-CHANGED
  9099                 OR
  9100             W-FORM-CHANGED
  9101             MOVE ER-7250        TO EMI-ERROR
  9102             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9103             MOVE -1             TO MAINTL
  9104             MOVE AL-UABON       TO MAINTA
  9105         ELSE
  9106             PERFORM 4100-SET-NDX THRU 4100-EXIT
  9107             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
  9108                     VARYING
  9109                 W-SC-NDX FROM 1 BY 1
  9110                     UNTIL
  9111                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
  9112             MOVE ER-7398        TO EMI-ERROR
  9113             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9114             MOVE -1             TO MAINTL
  9115             MOVE AL-UABON       TO MAINTA
  9116             GO TO 8200-SEND-DATAONLY.
  9117
  9118     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  9119
  9120     IF  W-KEY-FIELDS-CHANGED
  9121             OR
  9122         PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  9123         PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  9124         IF  MAINTI EQUAL 'C'
  9125             GO TO 2000-CREATE
  9126         ELSE
  9127             NEXT SENTENCE
  9128     ELSE
  9129         IF  W-FORM-CHANGED
  9130             PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  9131             IF  MAINTI EQUAL 'C'
  9132                 GO TO 2000-CREATE
  9133             ELSE
  9134                 NEXT SENTENCE
  9135         ELSE
  9136             MOVE -1             TO MAINTL
  9137             GO TO 8200-SEND-DATAONLY.
  9138
  9139     MOVE ER-0023                TO EMI-ERROR.
  9140     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9141     MOVE -1                     TO MAINTL.
  9142     MOVE AL-UABON               TO MAINTA.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 175
* EL689.cbl
  9143     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 176
* EL689.cbl
  9145 0350-EDIT-ROUTINE.
  9146
  9147     IF  MAINTI EQUAL 'C'
  9148             AND
  9149         FORML EQUAL ZEROS
  9150         MOVE -1                 TO FORML
  9151         MOVE ER-0177            TO EMI-ERROR
  9152         MOVE AL-UABON           TO FORMA
  9153         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9154
  9155     IF PRTNOWL > ZEROS
  9156        IF PRTNOWI = 'Y' OR 'N' OR 'P' OR ' '
  9157           MOVE PRTNOWI          TO PI-PRINT-NOW
  9158           MOVE AL-UANON         TO PRTNOWA
  9159        END-IF
  9160     END-IF
  9161     IF ENDARCHL > ZEROS
  9162        IF ENDARCHI NUMERIC
  9163            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
  9164            MOVE AL-UNNON       TO ENDARCHA
  9165            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
  9166            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
  9167            MOVE 'N'            TO W-VALID-ENDT-SW
  9168            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
  9169            IF NOT W-VALID-ENDT
  9170                MOVE -1         TO ENDARCHL
  9171                MOVE ER-1565    TO EMI-ERROR
  9172                MOVE AL-UNBON   TO ENDARCHA
  9173                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9174            END-IF
  9175        END-IF
  9176     ELSE
  9177        MOVE ZEROS              TO PI-ENDT-ARCH-NO
  9178     END-IF
  9179     MOVE SPACES                 TO PI-689-PRINT-RESTRICTION
  9180*    IF  PRTRESTL NOT EQUAL ZEROS
  9181*        PERFORM 0360-EDIT-PRINT-RESTRICTIONS THRU 0360-EXIT.
  9182
  9183     IF  FOLLOWL NOT EQUAL ZEROS
  9184         MOVE FOLLOWI            TO W-DEEDIT-FIELD
  9185         PERFORM 8600-DEEDIT
  9186         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9187         MOVE '4'                TO DC-OPTION-CODE
  9188         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9189         IF  DATE-CONVERSION-ERROR
  9190             MOVE ER-0182        TO EMI-ERROR
  9191             MOVE -1             TO FOLLOWL
  9192             MOVE AL-UABON       TO FOLLOWA
  9193             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9194         ELSE
  9195             MOVE DC-GREG-DATE-1-EDIT
  9196                                 TO FOLLOWO
  9197                                    PI-689-FOLLOW-UP-EDIT
  9198             MOVE AL-UANON       TO FOLLOWA
  9199             MOVE DC-BIN-DATE-1  TO PI-689-FOLLOW-UP-DATE
  9200     ELSE
  9201         MOVE LOW-VALUES         TO PI-689-FOLLOW-UP-DATE.
  9202
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 177
* EL689.cbl
  9203     IF  PI-689-FOLLOW-UP-DATE NOT EQUAL LOW-VALUES
  9204         IF  PI-689-FOLLOW-UP-DATE LESS THAN
  9205                 W-SAVE-BIN-DATE
  9206             MOVE ER-0533        TO EMI-ERROR
  9207             MOVE AL-UABON       TO FOLLOWA
  9208             MOVE -1             TO FOLLOWL
  9209             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9210
  9211     IF  RESEND1L NOT EQUAL ZEROS
  9212         MOVE RESEND1I           TO W-DEEDIT-FIELD
  9213         PERFORM 8600-DEEDIT
  9214         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9215         MOVE '4'                TO DC-OPTION-CODE
  9216         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9217         IF  DATE-CONVERSION-ERROR
  9218             MOVE ER-0185        TO EMI-ERROR
  9219             MOVE -1             TO RESEND1L
  9220             MOVE AL-UABON       TO RESEND1A
  9221             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9222         ELSE
  9223             MOVE DC-GREG-DATE-1-EDIT
  9224                                 TO RESEND1O
  9225                                    PI-689-RESEND1-EDIT
  9226             MOVE AL-UANON       TO RESEND1A
  9227             MOVE DC-BIN-DATE-1  TO PI-689-RESEND-DATE-1
  9228     ELSE
  9229         MOVE LOW-VALUES         TO PI-689-RESEND-DATE-1.
  9230
  9231     IF  PI-689-RESEND-DATE-1 NOT EQUAL LOW-VALUES
  9232         IF  PI-689-RESEND-DATE-1 NOT GREATER THAN
  9233                 W-SAVE-BIN-DATE
  9234             MOVE ER-0537        TO EMI-ERROR
  9235             MOVE AL-UABON       TO RESEND1A
  9236             MOVE -1             TO RESEND1L
  9237             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9238
  9239     IF ENCL > ZEROS
  9240        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  9241                                          PI-ENCLOSURE-CD
  9242        MOVE SPACES             TO W-ELENCC-KEY
  9243        MOVE PI-COMPANY-CD      TO W-ENCC-COMPANY-CD
  9244        MOVE '2'                TO W-ENCC-REC-TYPE
  9245        MOVE ENCI               TO W-ENCC-ENC-CODE
  9246
  9247
  9248* EXEC CICS READ
  9249*           DATASET    (W-ENCC-FILE-ID)
  9250*           SET        (ADDRESS OF ENCLOSURE-CODES)
  9251*           RIDFLD     (W-ELENCC-KEY)
  9252*           RESP       (W-RESPONSE)
  9253*       END-EXEC
  9254*    MOVE '&"S        E          (  N#00009093' TO DFHEIV0
  9255     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9256     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9257     MOVE X'204E233030303039303933' TO DFHEIV0(25:11)
  9258     CALL 'kxdfhei1' USING DFHEIV0,
  9259           W-ENCC-FILE-ID,
  9260           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 178
* EL689.cbl
  9261           DFHEIV99,
  9262           W-ELENCC-KEY,
  9263           DFHEIV99,
  9264           DFHEIV99,
  9265           DFHEIV99
  9266     SET ADDRESS OF ENCLOSURE-CODES TO
  9267         DFHEIV20
  9268     MOVE EIBRESP  TO W-RESPONSE
  9269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9270
  9271        IF RESP-NORMAL
  9272           MOVE ENCI             TO PI-ENCLOSURE-CD
  9273                                    W-ENCLOSURE-CD
  9274           MOVE AL-UANON         TO ENCA
  9275        ELSE
  9276           MOVE ER-1560          TO EMI-ERROR
  9277           MOVE -1               TO ENCL
  9278           MOVE AL-UABON         TO ENCA
  9279           PERFORM 9900-ERROR-FORMAT
  9280                                 THRU 9900-EXIT
  9281        END-IF
  9282     END-IF
  9283
  9284
  9285     IF NOT PI-CREATE-LABELS
  9286         MOVE PI-LABEL-CONTROL   TO ADDRLBLI
  9287         MOVE AL-PANON           TO ADDRLBLA
  9288         GO TO 0350-BYPASS-OVERRIDE.
  9289
  9290     IF  ADDRLBLL GREATER THAN ZEROS
  9291          INSPECT ADDRLBLI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9292          IF ADDRLBLI = 'N' OR 'Y'
  9293              MOVE ADDRLBLI      TO PI-689-LBL-OVERRIDE
  9294              MOVE AL-UANON      TO ADDRLBLA
  9295          ELSE
  9296             MOVE ER-3783        TO EMI-ERROR
  9297             MOVE -1             TO ADDRLBLL
  9298             MOVE AL-UABON       TO ADDRLBLA
  9299             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9300
  9301 0350-BYPASS-OVERRIDE.
  9302
  9303     IF  PI-BYPASS-LABELS
  9304             OR
  9305         FORMI EQUAL '9999'
  9306             OR
  9307         PI-689-LABELS-OVERRIDEN
  9308         MOVE SPACES             TO PI-689-LABEL-SOURCE
  9309         MOVE LOW-VALUES         TO ADDRSI
  9310         MOVE AL-UANOF           TO ADDRSA
  9311         MOVE ZEROS              TO ADDRSL
  9312     ELSE
  9313         IF  ADDRSL GREATER THAN ZEROS
  9314             MOVE ADDRSI         TO W-LABEL-SOURCE
  9315             IF  W-LABEL-SOURCE-VALID
  9316                 MOVE ADDRSI     TO PI-689-LABEL-SOURCE
  9317             ELSE
  9318                 MOVE -1         TO ADDRSL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 179
* EL689.cbl
  9319                 MOVE ER-0176    TO EMI-ERROR
  9320                 MOVE AL-UABON   TO ADDRSA
  9321                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9322         ELSE
  9323             IF  MAINTI EQUAL 'C'
  9324                 MOVE -1         TO ADDRSL
  9325                 MOVE ER-0176    TO EMI-ERROR
  9326                 MOVE AL-UABON   TO ADDRSA
  9327                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9328
  9329     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  9330     IF  PRINTERL GREATER ZERO
  9331         INSPECT PRINTERI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9332         MOVE AL-UANON           TO PRINTERA
  9333         MOVE PRINTERI           TO PI-689-ALT-PRINTER-ID
  9334                                    PI-ALT-DMD-PRT-ID
  9335     ELSE
  9336         IF  PI-NO-CARRIER-SECURITY
  9337                 AND
  9338             PI-NO-ACCOUNT-SECURITY
  9339             IF  PI-PROCESSOR-PRINTER GREATER THAN SPACES
  9340                 MOVE PI-PROCESSOR-PRINTER
  9341                                 TO PI-689-ALT-PRINTER-ID
  9342                                    PRINTERI
  9343                 MOVE AL-UABON   TO PRINTERA
  9344             ELSE
  9345                 MOVE PI-COMPANY-ID
  9346                                 TO W-CNTL-COMPANY-ID
  9347                 MOVE '1'        TO W-CNTL-RECORD-TYPE
  9348                 MOVE SPACES     TO W-CNTL-GENL
  9349                 MOVE ZEROS      TO W-CNTL-SEQ-NO
  9350
  9351* EXEC CICS HANDLE CONDITION
  9352*                     NOTOPEN    (8040-CNTL-NOT-OPEN)
  9353*                     NOTFND     (7945-NOT-FOUND)
  9354*                END-EXEC
  9355*    MOVE '"$JI                  ! $ #00009179' TO DFHEIV0
  9356     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9357     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9358     MOVE X'2420233030303039313739' TO DFHEIV0(25:11)
  9359     CALL 'kxdfhei1' USING DFHEIV0
  9360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9361
  9362* EXEC CICS READ
  9363*                     DATASET    (W-CNTL-FILE-ID)
  9364*                     SET        (ADDRESS OF CONTROL-FILE)
  9365*                     RIDFLD     (W-CNTL-KEY)
  9366*                END-EXEC
  9367*    MOVE '&"S        E          (   #00009183' TO DFHEIV0
  9368     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9369     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9370     MOVE X'2020233030303039313833' TO DFHEIV0(25:11)
  9371     CALL 'kxdfhei1' USING DFHEIV0,
  9372           W-CNTL-FILE-ID,
  9373           DFHEIV20,
  9374           DFHEIV99,
  9375           W-CNTL-KEY,
  9376           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 180
* EL689.cbl
  9377           DFHEIV99,
  9378           DFHEIV99
  9379     SET ADDRESS OF CONTROL-FILE TO
  9380         DFHEIV20
  9381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9382                 MOVE CF-FORMS-PRINTER-ID
  9383                                 TO PI-689-ALT-PRINTER-ID
  9384                                    PRINTERI
  9385                                    W-TS-TERM-TEXT
  9386                 MOVE AL-UABON   TO PRINTERA
  9387         ELSE
  9388             MOVE AL-UABON       TO PRINTERA
  9389             MOVE -1             TO PRINTERL
  9390             MOVE ER-9283        TO EMI-ERROR
  9391             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9392
  9393     IF  COPIESL NOT EQUAL ZEROS
  9394         IF  COPIESI NOT NUMERIC
  9395                 OR
  9396             COPIESI EQUAL '0'
  9397             MOVE ER-0184        TO EMI-ERROR
  9398             MOVE -1             TO COPIESL
  9399             MOVE AL-UABON       TO COPIESA
  9400             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9401         ELSE
  9402             MOVE COPIESI        TO PI-689-NUMBER-COPIES
  9403             MOVE AL-UANON       TO COPIESA
  9404     ELSE
  9405         IF FORMI EQUAL '9999'
  9406             MOVE 1              TO PI-689-NUMBER-COPIES
  9407                                    COPIESL
  9408                                    COPIESO.
  9409
  9410     IF  FORML NOT EQUAL ZEROS
  9411         INSPECT FORMI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9412         MOVE FORMI              TO PI-689-FORM-NUMBER.
  9413
  9414     MOVE SPACES                 TO W-HOLD-IND.
  9415
  9416     IF PI-CERT-REQ-IND = 'Y'
  9417       IF  CERTIDL NOT EQUAL ZEROS
  9418         IF CERTIDI NUMERIC
  9419             MOVE AL-UANON      TO CERTIDA
  9420             MOVE CERTIDI       TO PI-CERT-FORM-ID
  9421         ELSE
  9422             MOVE ER-1778       TO EMI-ERROR
  9423             MOVE -1            TO CERTIDL
  9424             MOVE AL-UABON      TO CERTIDA
  9425             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9426         END-IF
  9427       ELSE
  9428          MOVE ER-0715       TO EMI-ERROR
  9429          MOVE -1            TO CERTIDL
  9430          MOVE AL-UABON      TO CERTIDA
  9431          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9432       END-IF
  9433     END-IF.
  9434
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 181
* EL689.cbl
  9435     IF PI-REASON-REQ-IND = 'Y'
  9436        IF PI-ENDT-ARCH-NO NOT > ZERO
  9437          MOVE ER-9840       TO EMI-ERROR
  9438          MOVE -1            TO FORML
  9439          MOVE AL-UABON      TO FORMA
  9440          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9441        END-IF
  9442     END-IF.
  9443
  9444     IF  NOT EMI-NO-ERRORS
  9445         IF  EMI-ERROR EQUAL ER-7250
  9446             GO TO 0350-EXIT
  9447         ELSE
  9448            MOVE -1             TO MAINTL
  9449            GO TO 8200-SEND-DATAONLY.
  9450
  9451 0350-EXIT.
  9452      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 182
* EL689.cbl
  9454 0355-CHECK-ERENDT.
  9455
  9456*     EXEC CICS GETMAIN
  9457*          SET      (ADDRESS OF ENDORSEMENT-RECORD)
  9458*          LENGTH   (W-ENDT-LENGTH)
  9459*     END-EXEC
  9460
  9461
  9462* EXEC CICS READ
  9463*         DATASET    ('ERENDT2')
  9464*         SET        (ADDRESS OF ENDORSEMENT-RECORD)
  9465*         RIDFLD     (W-ERENDT-KEY-BY-ARCH)
  9466*         RESP       (W-RESPONSE)
  9467*    END-EXEC
  9468     MOVE 'ERENDT2' TO DFHEIV1
  9469*    MOVE '&"S        E          (  N#00009267' TO DFHEIV0
  9470     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9471     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9472     MOVE X'204E233030303039323637' TO DFHEIV0(25:11)
  9473     CALL 'kxdfhei1' USING DFHEIV0,
  9474           DFHEIV1,
  9475           DFHEIV20,
  9476           DFHEIV99,
  9477           W-ERENDT-KEY-BY-ARCH,
  9478           DFHEIV99,
  9479           DFHEIV99,
  9480           DFHEIV99
  9481     SET ADDRESS OF ENDORSEMENT-RECORD TO
  9482         DFHEIV20
  9483     MOVE EIBRESP  TO W-RESPONSE
  9484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9485
  9486     IF (RESP-NORMAL)
  9487         IF PI-RETURN-TO-PROGRAM EQUAL 'EL6311'  AND
  9488            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  9489            EN-CARRIER     =  PI-689-CARRIER     AND
  9490            EN-GROUPING    =  PI-689-GROUPING    AND
  9491            EN-STATE       =  PI-689-STATE       AND
  9492            EN-ACCOUNT     =  PI-689-ACCOUNT     AND
  9493            EN-CERT-EFF-DT =  PI-689-EFF-DATE    AND
  9494            EN-CERT-NO     =  PI-689-CERT-NO
  9495               SET W-VALID-ENDT TO TRUE
  9496         END-IF
  9497         IF PI-RETURN-TO-PROGRAM EQUAL 'EL1273'  AND
  9498            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  9499            EN-CARRIER     =  PI-CARRIER         AND
  9500            EN-GROUPING    =  PI-GROUPING        AND
  9501            EN-STATE       =  PI-STATE           AND
  9502            EN-ACCOUNT     =  PI-ACCOUNT         AND
  9503            EN-CERT-EFF-DT =  PI-CERT-EFF-DT     AND
  9504            EN-CERT-NO     =  PI-CERT-NO
  9505               SET W-VALID-ENDT TO TRUE
  9506         END-IF
  9507     END-IF
  9508      .
  9509
  9510 0355-EXIT.
  9511      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 183
* EL689.cbl
  9513 0360-EDIT-PRINT-RESTRICTIONS.
  9514
  9515*    INSPECT PRTRESTI CONVERTING W-LOWER-CASE
  9516*                                TO W-UPPER-CASE.
  9517*
  9518*    IF  (PI-689-PRINT-RESTRICTION EQUAL ' ' OR 'F'
  9519*                                     OR 'P' OR LOW-VALUES)
  9520*            AND
  9521*        PRTRESTI EQUAL 'C'
  9522*            AND
  9523*        PI-689-CONTROL NOT GREATER THAN ZEROS
  9524*        MOVE ER-7243            TO EMI-ERROR
  9525*        MOVE -1                 TO PRTRESTL
  9526*        MOVE AL-UABON           TO PRTRESTA
  9527*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9528*        GO TO 0360-EXIT.
  9529*
  9530*    IF  PRTRESTL NOT EQUAL ZEROS
  9531*        IF PRTRESTI = 'C' OR 'F' OR 'P'
  9532*            MOVE PRTRESTI       TO PI-689-PRINT-RESTRICTION
  9533*            MOVE AL-UANON       TO PRTRESTA
  9534*        ELSE
  9535*            IF  PRTRESTI EQUAL ' '
  9536*                MOVE SPACES     TO PI-689-PRINT-RESTRICTION
  9537*                MOVE AL-UANON   TO PRTRESTA
  9538*            ELSE
  9539*                MOVE ER-7393    TO EMI-ERROR
  9540*                MOVE -1         TO PRTRESTL
  9541*                MOVE AL-UABON   TO PRTRESTA
  9542*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9543*
  9544*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
  9545*            AND
  9546*        W-HOLD-ON
  9547*            AND
  9548*        PI-689-CONTROL NOT GREATER THAN ZEROS
  9549*        MOVE ER-7243            TO EMI-ERROR
  9550*        MOVE -1                 TO PRTRESTL
  9551*        MOVE AL-UABON           TO PRTRESTA
  9552*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9553     .
  9554 0360-EXIT.
  9555      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 184
* EL689.cbl
  9557 0400-EL6311-INCOMING.
  9558
  9559     MOVE ZEROS                  TO PI-CURRENT-LINE
  9560                                    PI-TEMP-STOR-ITEMS
  9561                                    PI-TOTAL-LINES
  9562                                    PI-UPDATE-SW
  9563                                    PI-689-NUMBER-LABEL-LINES
  9564                                    PI-689-ERROR
  9565                                    PI-689-NUMBER-TEXT-RECORDS.
  9566     MOVE SPACES                 TO PI-689-PRINT-SW
  9567                                    PI-689-ALT-PRINTER-ID
  9568                                    PI-COMM-CONTROL
  9569                                    PI-689-FORM-NUMBER
  9570                                    PI-689-TEMP-STOR-ID
  9571                                    PI-689-LABEL-SOURCE
  9572                                    PI-689-USE-SCREEN-IND.
  9573
  9574     IF PI-CREATE-LABELS
  9575         MOVE  AL-UANON          TO ADDRLBLA
  9576         MOVE  +1                TO ADDRLBLL.
  9577
  9578     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9579                                    PI-689-LBL-OVERRIDE.
  9580
  9581     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  9582     MOVE '2'                    TO PI-ACTION.
  9583     MOVE -1                     TO MAINTL.
  9584
  9585     MOVE AL-UANON               TO PRTNOWA.
  9586     MOVE +1                     TO PRTNOWL.
  9587     MOVE 'N'                    TO PRTNOWI
  9588                                    PI-PRINT-NOW.
  9589
  9590     IF  PI-689-CARRIER NOT EQUAL LOW-VALUES
  9591         MOVE AL-UANON           TO CARRIERA
  9592         MOVE +1                 TO CARRIERL
  9593         MOVE PI-689-CARRIER     TO CARRIERI.
  9594
  9595     IF  PI-689-GROUPING NOT EQUAL LOW-VALUES
  9596         MOVE +6                 TO GROUPL
  9597         MOVE AL-UANON           TO GROUPA
  9598         MOVE PI-689-GROUPING    TO GROUPI.
  9599
  9600     IF  PI-689-STATE NOT EQUAL LOW-VALUES
  9601         MOVE +2                 TO STATEL
  9602         MOVE AL-UANON           TO STATEA
  9603         MOVE PI-689-STATE       TO STATEI.
  9604
  9605     IF  PI-689-ACCOUNT NOT EQUAL LOW-VALUES
  9606         MOVE +10                TO ACCTL
  9607         MOVE AL-UANON           TO ACCTA
  9608         MOVE PI-689-ACCOUNT     TO ACCTI.
  9609
  9610     IF  PI-689-CERT-PRIME NOT EQUAL LOW-VALUES
  9611         MOVE +10                TO CERTL
  9612         MOVE AL-UANON           TO CERTA
  9613         MOVE PI-689-CERT-PRIME  TO CERTI.
  9614
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 185
* EL689.cbl
  9615     IF  PI-689-CERT-SFX NOT EQUAL LOW-VALUES
  9616         MOVE +1                 TO SFXL
  9617         MOVE AL-UANON           TO SFXA
  9618         MOVE PI-689-CERT-SFX    TO SFXI.
  9619
  9620     IF  PI-689-ENTRY-BATCH NOT EQUAL LOW-VALUES
  9621         MOVE +6                 TO BENTRYL
  9622         MOVE AL-UANON           TO BENTRYA
  9623         MOVE PI-689-ENTRY-BATCH TO BENTRYI.
  9624
  9625     MOVE +4                     TO BCSEQL.
  9626     MOVE AL-UANON               TO BCSEQA.
  9627     MOVE PI-689-CHG-SEQ-NO      TO BCSEQI.
  9628
  9629     IF  PI-689-SEQ-NO NOT EQUAL ZEROS
  9630         MOVE +8                 TO SEQL
  9631         MOVE AL-UANON           TO SEQA
  9632         MOVE PI-689-SEQ-NO      TO SEQI.
  9633
  9634     IF  PI-689-EFF-DATE NOT EQUAL LOW-VALUES
  9635         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  9636         MOVE ' '                TO DC-OPTION-CODE
  9637         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9638         MOVE +8                 TO DATEL
  9639         MOVE DC-GREG-DATE-1-EDIT
  9640                                 TO DATEI
  9641         MOVE AL-UANON           TO DATEA.
  9642
  9643     MOVE -1                     TO MAINTL.
  9644     MOVE '4'                    TO DATASORI
  9645                                    PI-689-DATA-SOURCE.
  9646     MOVE +1                     TO DATASORL.
  9647     MOVE AL-UANON               TO DATASORA.
  9648
  9649     GO TO 8100-SEND-INITIAL-MAP.
  9650
  9651 0400-EXIT.
  9652      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 186
* EL689.cbl
  9654 0450-SPECIAL-INPUT-PROCESS.
  9655
  9656     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  9657             AND
  9658         PI-CARRIER GREATER THAN LOW-VALUES
  9659         MOVE '1'                TO DATASORI
  9660                                    PI-689-DATA-SOURCE
  9661         MOVE PI-CARRIER         TO CARRIERI
  9662         MOVE PI-GROUPING        TO GROUPI
  9663         MOVE PI-STATE           TO STATEI
  9664         MOVE PI-ACCOUNT         TO ACCTI
  9665         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  9666         MOVE ' '                TO DC-OPTION-CODE
  9667         PERFORM 9500-LINK-DATE-CONVERT
  9668             THRU 9500-EXIT
  9669         MOVE DC-GREG-DATE-1-EDIT
  9670                                 TO DATEI
  9671         MOVE 'N'                TO PRTNOWI
  9672                                    PI-PRINT-NOW
  9673         MOVE AL-UANON           TO ACCTA
  9674                                    CARRIERA
  9675                                    DATEA
  9676                                    DATASORA
  9677                                    GROUPA
  9678                                    STATEA
  9679                                    PRTNOWA
  9680         MOVE +1                 TO CARRIERL
  9681                                    DATASORL
  9682                                    PRTNOWL
  9683         MOVE -1                 TO MAINTL
  9684         MOVE +6                 TO GROUPL
  9685         MOVE +2                 TO STATEL
  9686         MOVE +8                 TO DATEL
  9687         MOVE +10                TO ACCTL
  9688     ELSE
  9689         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  9690                 AND
  9691             PI-CARRIER GREATER THAN LOW-VALUES
  9692             MOVE '3'            TO DATASORI
  9693                                    PI-689-DATA-SOURCE
  9694             MOVE PI-CR-CARRIER  TO CARRIERI
  9695             MOVE PI-CR-GROUPING TO GROUPI
  9696             MOVE PI-CR-ACCOUNT  TO ACCTI
  9697             MOVE PI-CR-FIN-RESP TO RPERSONI
  9698             MOVE PI-CR-TYPE     TO TYPEI
  9699             MOVE 'N'            TO PRTNOWI
  9700                                    PI-PRINT-NOW
  9701             MOVE AL-UANON       TO CARRIERA
  9702                                    GROUPA
  9703                                    ACCTA
  9704                                    DATASORA
  9705                                    RPERSONA
  9706                                    TYPEA
  9707                                    PRTNOWA
  9708             MOVE +1             TO CARRIERL
  9709                                    DATASORL
  9710                                    TYPEL
  9711                                    PRTNOWL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 187
* EL689.cbl
  9712             MOVE -1             TO MAINTL
  9713             MOVE +6             TO GROUPL
  9714             MOVE +10            TO ACCTL
  9715                                    RPERSONL
  9716         ELSE
  9717             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  9718                     AND
  9719                 PI-CARRIER GREATER THAN LOW-VALUES
  9720                 MOVE '2'        TO DATASORI
  9721                                    PI-689-DATA-SOURCE
  9722                 MOVE PI-CARRIER TO CARRIERI
  9723                 MOVE PI-GROUPING
  9724                                 TO GROUPI
  9725                 MOVE PI-STATE   TO STATEI
  9726                 MOVE PI-ACCOUNT TO ACCTI
  9727                 MOVE PI-CERT-PRIME
  9728                                 TO CERTI
  9729                 MOVE PI-CERT-SFX
  9730                                 TO SFXI
  9731                 MOVE PI-CERT-EFF-DT
  9732                                 TO DC-BIN-DATE-1
  9733                 MOVE ' '        TO DC-OPTION-CODE
  9734                 PERFORM 9500-LINK-DATE-CONVERT
  9735                     THRU 9500-EXIT
  9736                 MOVE DC-GREG-DATE-1-EDIT
  9737                                 TO DATEI
  9738                 MOVE 'N'        TO PRTNOWI
  9739                                    PI-PRINT-NOW
  9740                 MOVE AL-UANON   TO CARRIERA
  9741                                    GROUPA
  9742                                    STATEA
  9743                                    ACCTA
  9744                                    CERTA
  9745                                    SFXA
  9746                                    DATEA
  9747                                    ADDRSA
  9748                                    DATASORA
  9749                                    PRTNOWA
  9750                 MOVE +1         TO CARRIERL
  9751                                    SFXL
  9752                                    DATASORL
  9753                                    ADDRSL
  9754                                    PRTNOWL
  9755                 MOVE -1         TO MAINTL
  9756                 MOVE +6         TO GROUPL
  9757                 MOVE +2         TO STATEL
  9758                 MOVE +8         TO DATEL
  9759                 MOVE +10        TO ACCTL
  9760                                    CERTL.
  9761
  9762     IF PI-CREATE-LABELS
  9763         MOVE  AL-UANON          TO ADDRLBLA
  9764         MOVE  +1                TO ADDRLBLL.
  9765
  9766     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9767                                    PI-689-LBL-OVERRIDE.
  9768
  9769     MOVE LOW-VALUES             TO PI-689-KEY-DATA-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 188
* EL689.cbl
  9770     GO TO 8100-SEND-INITIAL-MAP.
  9771
  9772 0450-EXIT.
  9773      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 189
* EL689.cbl
  9775 0600-BYPASS-SCREEN-CNTL.
  9776***************************************************************
  9777*     THIS ROUTINE WILL PROCESS A NEW LETTER REQUIREMENT      *
  9778*     WITH THE INFORMATION FOUND IN THE PI AREA WITHOUT       *
  9779*     PERFORMING ANY SCREEN IO.                               *
  9780***************************************************************
  9781
  9782
  9783* EXEC CICS HANDLE CONDITION
  9784*        PGMIDERR (9700-PGMID-ERROR)
  9785*        MAPFAIL  (0325-MAPFAIL)
  9786*        ERROR    (9800-ABEND)
  9787*    END-EXEC.
  9788*    MOVE '"$L?.                 ! % #00009570' TO DFHEIV0
  9789     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  9790     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9791     MOVE X'2520233030303039353730' TO DFHEIV0(25:11)
  9792     CALL 'kxdfhei1' USING DFHEIV0
  9793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9794
  9795
  9796     MOVE LOW-VALUES             TO EL689AI.
  9797
  9798     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM
  9799
  9800     MOVE PI-689-FORM-NUMBER     TO FORMI.
  9801     MOVE +4                     TO FORML.
  9802
  9803     IF  PI-689-NUMBER-COPIES GREATER THAN ZERO
  9804         MOVE PI-689-NUMBER-COPIES
  9805                                 TO COPIESI
  9806         MOVE +1                 TO COPIESL.
  9807
  9808     MOVE PI-689-LABEL-SOURCE    TO ADDRSI.
  9809     MOVE +1                     TO ADDRSL.
  9810     MOVE PI-689-DATA-SOURCE     TO DATASORI.
  9811     MOVE +1                     TO DATASORL.
  9812
  9813*    IF  PI-689-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  9814*        MOVE PI-689-PRINT-RESTRICTION
  9815*                                TO PRTRESTI
  9816*        MOVE +1                 TO PRTRESTL.
  9817
  9818     MOVE SPACES                 TO PI-689-PRINT-SW
  9819                                    PI-689-LBL-OVERRIDE.
  9820     MOVE ZEROS                  TO PI-TOTAL-LINES
  9821                                    PI-CURRENT-LINE
  9822                                    PI-TEMP-STOR-ITEMS
  9823                                    PI-UPDATE-SW
  9824                                    PI-689-ERROR
  9825                                    PI-689-NUMBER-LABEL-LINES
  9826                                    PI-689-NUMBER-TEXT-RECORDS.
  9827
  9828     IF  PI-689-ALT-PRINTER-ID NOT EQUAL LOW-VALUES
  9829         MOVE +4                 TO PRINTERL
  9830         MOVE PI-689-ALT-PRINTER-ID
  9831                                 TO PRINTERI PI-ALT-DMD-PRT-ID.
  9832
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 190
* EL689.cbl
  9833     MOVE SPACES                 TO PI-689-ALT-PRINTER-ID.
  9834
  9835     IF  PI-689-SOURCE-VARIABLE
  9836         PERFORM 0700-GET-VARIABLE-LABEL THRU 0700-EXIT.
  9837
  9838     MOVE SPACES                 TO W-CNTL-KEY
  9839     MOVE LOW-VALUES             TO W-ACCT-KEY
  9840                                    W-CERT-KEY
  9841                                    W-CHEK-KEY
  9842                                    W-COMP-KEY
  9843                                    W-MAIL-KEY
  9844                                    W-PNDB-KEY
  9845                                    W-PNDB2-KEY
  9846                                    W-PYAJ-KEY.
  9847
  9848     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9849     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9850                                    W-CERT-COMPANY-CD
  9851                                    W-CHEK-COMPANY-CD
  9852                                    W-COMP-COMPANY-CD
  9853                                    W-MAIL-COMPANY-CD
  9854                                    W-PNDB-COMPANY-CD
  9855                                    W-PNDB2-COMPANY-CD
  9856                                    W-PYAJ-COMPANY-CD.
  9857
  9858     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
  9859         MOVE PI-689-CARRIER     TO W-ACCT-CARRIER
  9860                                    W-CERT-CARRIER
  9861                                    W-MAIL-CARRIER
  9862                                    W-CERT-CARRIER
  9863                                    W-COMP-CARRIER
  9864                                    W-CHEK-CARRIER
  9865                                    W-PNDB2-CARRIER
  9866                                    W-PYAJ-CARRIER.
  9867
  9868     IF  PI-689-GROUPING GREATER THAN LOW-VALUES
  9869         MOVE PI-689-GROUPING    TO W-ACCT-GROUPING
  9870                                    W-CERT-GROUPING
  9871                                    W-CHEK-GROUPING
  9872                                    W-COMP-GROUPING
  9873                                    W-MAIL-GROUPING
  9874                                    W-PNDB2-GROUPING
  9875                                    W-PYAJ-GROUPING.
  9876
  9877     IF  PI-689-STATE GREATER THAN LOW-VALUES
  9878         MOVE PI-689-STATE       TO W-ACCT-STATE
  9879                                    W-CERT-STATE
  9880                                    W-CHEK-STATE
  9881                                    W-MAIL-STATE
  9882                                    W-PNDB2-STATE.
  9883
  9884     IF  PI-689-ACCOUNT GREATER THAN LOW-VALUES
  9885         IF PI-689-DATA-SOURCE = '3' OR '6'
  9886             MOVE PI-689-ACCOUNT TO W-COMP-ACCOUNT
  9887                                    W-PYAJ-ACCOUNT
  9888         ELSE
  9889             MOVE PI-689-ACCOUNT TO W-ACCT-ACCOUNT
  9890                                    W-CERT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 191
* EL689.cbl
  9891                                    W-CHEK-ACCOUNT
  9892                                    W-MAIL-ACCOUNT
  9893                                    W-PNDB2-ACCOUNT.
  9894
  9895     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  9896         MOVE PI-689-EFF-DATE    TO W-CERT-EFF-DT
  9897                                    W-CHEK-EFF-DT
  9898                                    W-MAIL-EFF-DT
  9899                                    W-PNDB2-EFF-DT.
  9900
  9901     IF  PI-689-CERT-PRIME GREATER THAN LOW-VALUES
  9902         MOVE PI-689-CERT-PRIME  TO W-CERT-CERT-PRIME
  9903                                    W-CHEK-CERT-PRIME
  9904                                    W-MAIL-CERT-PRIME
  9905                                    W-PNDB2-CERT-PRIME
  9906
  9907         IF  PI-689-CERT-SFX GREATER THAN LOW-VALUES
  9908             MOVE PI-689-CERT-SFX
  9909                                 TO W-CERT-CERT-SFX
  9910                                    W-CHEK-CERT-SFX
  9911                                    W-MAIL-CERT-SFX
  9912                                    W-PNDB2-CERT-SFX
  9913         ELSE
  9914             MOVE SPACES         TO W-CERT-CERT-SFX
  9915                                    W-CHEK-CERT-SFX
  9916                                    W-MAIL-CERT-SFX
  9917                                    W-PNDB2-CERT-SFX.
  9918
  9919     IF  PI-689-RESP-PERSON GREATER THAN LOW-VALUES
  9920         IF PI-689-DATA-SOURCE = '3' OR '6'
  9921             MOVE PI-689-RESP-PERSON
  9922                                 TO W-COMP-RESP-PERSON
  9923                                    W-PYAJ-FIN-RESP.
  9924
  9925     IF  PI-689-TYPE GREATER THAN LOW-VALUES
  9926         IF PI-689-DATA-SOURCE = '3' OR '6'
  9927             MOVE PI-689-TYPE    TO W-COMP-TYPE
  9928                                    W-PYAJ-RECORD-TYPE
  9929         ELSE
  9930             MOVE PI-689-TYPE    TO W-PNDB2-TYPE.
  9931
  9932     IF  PI-689-SEQ-NO GREATER THAN ZEROS
  9933         MOVE PI-689-SEQ-NO      TO W-PNDB-SEQ-NO
  9934                                    W-PYAJ-FILE-SEQ-NO
  9935                                    W-CHEK-SEQ-NO.
  9936
  9937     IF  PI-689-CHG-SEQ-NO GREATER THAN ZEROS
  9938         MOVE PI-689-CHG-SEQ-NO  TO W-PNDB-CHG-SEQ-NO
  9939                                    W-PNDB2-ALT-CHG-SEQ-NO.
  9940
  9941     IF  PI-689-ENTRY-BATCH GREATER THAN LOW-VALUES
  9942         MOVE PI-689-ENTRY-BATCH TO W-PNDB-ENTRY.
  9943
  9944     IF  PI-689-NO-ERRORS-DETECTED
  9945         PERFORM 2000-CREATE THRU 2000-EXIT
  9946         IF  NOT PI-689-FATAL-ERROR
  9947                 AND
  9948             NOT PI-689-ERR-DETECTED-PREV
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 192
* EL689.cbl
  9949             IF  PI-689-PRINT-ONLY
  9950                 PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9951             ELSE
  9952                 IF  PI-689-PRINT-FIRST
  9953                     PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9954                     IF  NOT PI-689-FATAL-ERROR
  9955                         IF  PI-689-ARCHIVE-LETTER
  9956                             PERFORM 5400-LETTER-RELEASE
  9957                                 THRU 5400-EXIT
  9958                         ELSE
  9959                             MOVE ER-7390
  9960                                 TO PI-689-ERROR
  9961                     ELSE
  9962                         NEXT SENTENCE
  9963                 ELSE
  9964                     IF  NOT PI-689-ARCHIVE-LETTER
  9965                         MOVE ER-7390
  9966                                 TO PI-689-ERROR
  9967                     ELSE
  9968                         PERFORM 5400-LETTER-RELEASE
  9969                             THRU 5400-EXIT
  9970                         IF  NOT PI-689-FATAL-ERROR
  9971                             IF  PI-689-PRINT-SECOND
  9972                                 PERFORM 7900-PRINT-LETTER-NOW
  9973                                     THRU 7900-EXIT.
  9974
  9975 0600-EXIT.
  9976     EXIT.
  9977
  9978 0620-RETURN-TO-CALLER.
  9979
  9980     MOVE PROGRAM-INTERFACE-BLOCK
  9981                                 TO DFHCOMMAREA.
  9982
  9983* EXEC CICS RETURN
  9984*    END-EXEC.
  9985*    MOVE '.(                    ''   #00009762' TO DFHEIV0
  9986     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9987     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9988     MOVE X'2020233030303039373632' TO DFHEIV0(25:11)
  9989     CALL 'kxdfhei1' USING DFHEIV0,
  9990           DFHEIV99,
  9991           DFHEIV99,
  9992           DFHEIV99,
  9993           DFHEIV99,
  9994           DFHEIV99,
  9995           DFHEIV99
  9996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9997
  9998
  9999 0700-GET-VARIABLE-LABEL.
 10000
 10001     IF  PI-689-VARIABLE-DATA-1 NOT GREATER THAN SPACES
 10002         MOVE '(VARIABLE NOT PROVIDED)'
 10003                                 TO W-RC-TEXT (1)
 10004                                    W-VG-TEXT (48)
 10005         GO TO 0700-EXIT.
 10006
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 193
* EL689.cbl
 10007     MOVE PI-689-VARIABLE-DATA-1 TO W-RC-TEXT (1)
 10008                                    W-VG-TEXT (48).
 10009     MOVE PI-689-VARIABLE-DATA-2 TO W-RC-TEXT (2)
 10010                                    W-VG-TEXT (49).
 10011     MOVE PI-689-VARIABLE-DATA-3 TO W-RC-TEXT (3)
 10012                                    W-VG-TEXT (50).
 10013     MOVE PI-689-VARIABLE-DATA-4 TO W-RC-TEXT (4)
 10014                                    W-VG-TEXT (51).
 10015     SET W-RG-NDX                TO +5.
 10016
 10017 0700-EXIT.
 10018     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 194
* EL689.cbl
 10020 0800-EDIT-KEY-FIELDS.
 10021***************************************************************
 10022*     THIS ROUTINE WILL DECIDE WHAT FIELDS ARE NECESSARY      *
 10023*     FROM THE DATA SOURCE FIELD.  IF A NECESSARY FIELD       *
 10024*     IS NOT PROVIDED AN ERROR WILL PREVENT FURTHER           *
 10025*     PROCESSING.                                             *
 10026***************************************************************
 10027     MOVE SPACES                 TO W-CNTL-KEY
 10028     MOVE LOW-VALUES             TO W-ACCT-KEY
 10029                                    W-CERT-KEY
 10030                                    W-CHEK-KEY
 10031                                    W-COMP-KEY
 10032                                    W-MAIL-KEY
 10033                                    W-PNDB-KEY
 10034                                    W-PNDB2-KEY
 10035                                    W-PYAJ-KEY.
 10036
 10037     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10038     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
 10039                                    W-CERT-COMPANY-CD
 10040                                    W-CHEK-COMPANY-CD
 10041                                    W-COMP-COMPANY-CD
 10042                                    W-MAIL-COMPANY-CD
 10043                                    W-PNDB-COMPANY-CD
 10044                                    W-PNDB2-COMPANY-CD
 10045                                    W-PYAJ-COMPANY-CD.
 10046
 10047     PERFORM 0900-EDIT-CARRIER THRU 0900-EXIT.
 10048     PERFORM 0905-EDIT-GROUPING THRU 0905-EXIT.
 10049     PERFORM 0910-EDIT-STATE THRU 0910-EXIT.
 10050     PERFORM 0915-EDIT-ACCOUNT THRU 0915-EXIT.
 10051     PERFORM 0920-EDIT-EXP-DATE THRU 0920-EXIT.
 10052     PERFORM 0925-EDIT-EFF-DATE THRU 0925-EXIT.
 10053     PERFORM 0930-EDIT-CERTIFICATE THRU 0930-EXIT.
 10054     PERFORM 0935-EDIT-RESP-PERSON THRU 0935-EXIT.
 10055     PERFORM 0940-EDIT-ACCOUNT THRU 0940-EXIT.
 10056     PERFORM 0945-EDIT-TYPE THRU 0945-EXIT.
 10057     PERFORM 0950-EDIT-ENTRY THRU 0950-EXIT.
 10058     PERFORM 0955-EDIT-SEQUENCE THRU 0955-EXIT.
 10059     PERFORM 0960-EDIT-BATCH-SEQ THRU 0960-EXIT.
 10060     PERFORM 0965-EDIT-TYPE THRU 0965-EXIT.
 10061     PERFORM 0970-EDIT-CSO THRU 0970-EXIT.
 10062
 10063     IF  DATASORI NUMERIC
 10064         MOVE DATASORI           TO W-DATA-SOURCE
 10065                                    PI-689-DATA-SOURCE
 10066         GO TO 0800-SOURCE-ACCOUNT
 10067               0800-SOURCE-CERTIFICATE
 10068               0800-SOURCE-COMPENSATION
 10069               0800-SOURCE-PENDING
 10070               0800-SOURCE-CHEK
 10071               0800-SOURCE-PAYMENTS-ADJS
 10072                                 DEPENDING ON W-DATA-SOURCE.
 10073
 10074     IF  FORMI NOT EQUAL '9999'
 10075         MOVE ER-7365            TO EMI-ERROR
 10076         MOVE -1                 TO MAINTL
 10077         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 195
* EL689.cbl
 10078         GO TO 8200-SEND-DATAONLY
 10079
 10080     ELSE
 10081         GO TO 0800-EXIT.
 10082
 10083 0800-SOURCE-ACCOUNT.
 10084
 10085     IF  W-ACCT-COMPANY-CD EQUAL LOW-VALUES
 10086             OR
 10087         W-ACCT-CARRIER EQUAL LOW-VALUES
 10088             OR
 10089         W-ACCT-GROUPING EQUAL LOW-VALUES
 10090             OR
 10091         W-ACCT-STATE EQUAL LOW-VALUES
 10092             OR
 10093         W-ACCT-ACCOUNT EQUAL LOW-VALUES
 10094             OR
 10095         W-ACCT-EXP-DT EQUAL LOW-VALUES
 10096         MOVE ER-7376            TO EMI-ERROR
 10097         MOVE -1                 TO MAINTL
 10098         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10099
 10100     GO TO 0800-ERROR-TEST.
 10101
 10102 0800-SOURCE-CERTIFICATE.
 10103
 10104     IF  W-CERT-COMPANY-CD EQUAL LOW-VALUES
 10105             OR
 10106         W-CERT-CARRIER EQUAL LOW-VALUES
 10107             OR
 10108         W-CERT-GROUPING EQUAL LOW-VALUES
 10109             OR
 10110         W-CERT-STATE EQUAL LOW-VALUES
 10111             OR
 10112         W-CERT-ACCOUNT EQUAL LOW-VALUES
 10113             OR
 10114         W-CERT-EFF-DT EQUAL LOW-VALUES
 10115             OR
 10116         W-CERT-CERT-NO EQUAL LOW-VALUES
 10117         MOVE ER-7377            TO EMI-ERROR
 10118         MOVE -1                 TO MAINTL
 10119         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10120
 10121     GO TO 0800-ERROR-TEST.
 10122
 10123 0800-SOURCE-COMPENSATION.
 10124
 10125     IF  W-COMP-COMPANY-CD EQUAL LOW-VALUES
 10126             OR
 10127         W-COMP-CARRIER EQUAL LOW-VALUES
 10128             OR
 10129         W-COMP-GROUPING EQUAL LOW-VALUES
 10130             OR
 10131         W-COMP-RESP-PERSON EQUAL LOW-VALUES
 10132             OR
 10133         W-COMP-TYPE EQUAL LOW-VALUES
 10134             OR
 10135         (W-COMP-TYPE EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 196
* EL689.cbl
 10136                 AND
 10137             W-COMP-ACCOUNT EQUAL LOW-VALUES)
 10138         MOVE ER-7378            TO EMI-ERROR
 10139         MOVE -1                 TO MAINTL
 10140         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10141
 10142     GO TO 0800-ERROR-TEST.
 10143
 10144 0800-SOURCE-PENDING.
 10145
 10146     IF  BENTRYL EQUAL ZEROS
 10147         IF  W-PNDB2-COMPANY-CD EQUAL LOW-VALUES
 10148                 OR
 10149             W-PNDB2-CARRIER EQUAL LOW-VALUES
 10150                 OR
 10151             W-PNDB2-GROUPING EQUAL LOW-VALUES
 10152                 OR
 10153             W-PNDB2-STATE EQUAL LOW-VALUES
 10154                 OR
 10155             W-PNDB2-ACCOUNT EQUAL LOW-VALUES
 10156                 OR
 10157             W-PNDB2-EFF-DT EQUAL LOW-VALUES
 10158                 OR
 10159             W-PNDB2-CERT-NO EQUAL LOW-VALUES
 10160                 OR
 10161             W-PNDB2-TYPE EQUAL LOW-VALUES
 10162                 OR
 10163             W-PNDB2-ALT-CHG-SEQ-NO NOT = ZEROS
 10164             MOVE ER-7379        TO EMI-ERROR
 10165             MOVE -1             TO MAINTL
 10166             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10167         ELSE
 10168             NEXT SENTENCE
 10169     ELSE
 10170         IF  W-PNDB-COMPANY-CD EQUAL LOW-VALUES
 10171                 OR
 10172             W-PNDB-ENTRY EQUAL LOW-VALUES
 10173                 OR
 10174             W-PNDB-SEQ-NO EQUAL ZEROS
 10175             MOVE ER-7379        TO EMI-ERROR
 10176             MOVE -1             TO MAINTL
 10177             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10178
 10179     GO TO 0800-ERROR-TEST.
 10180
 10181 0800-SOURCE-CHEK.
 10182
 10183     IF  W-CHEK-COMPANY-CD EQUAL LOW-VALUES
 10184             OR
 10185         W-CHEK-CARRIER EQUAL LOW-VALUES
 10186             OR
 10187         W-CHEK-GROUPING EQUAL LOW-VALUES
 10188             OR
 10189         W-CHEK-STATE EQUAL LOW-VALUES
 10190             OR
 10191         W-CHEK-ACCOUNT EQUAL LOW-VALUES
 10192             OR
 10193         W-CHEK-EFF-DT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 197
* EL689.cbl
 10194             OR
 10195         W-CHEK-CERT-NO EQUAL LOW-VALUES
 10196         MOVE ER-7381            TO EMI-ERROR
 10197         MOVE -1                 TO MAINTL
 10198         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10199
 10200     GO TO 0800-ERROR-TEST.
 10201
 10202 0800-SOURCE-PAYMENTS-ADJS.
 10203
 10204     IF  W-PYAJ-COMPANY-CD EQUAL LOW-VALUES
 10205             OR
 10206         W-PYAJ-CARRIER EQUAL LOW-VALUES
 10207             OR
 10208         W-PYAJ-GROUPING EQUAL LOW-VALUES
 10209             OR
 10210         W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 10211             OR
 10212         W-PYAJ-ACCOUNT EQUAL LOW-VALUES
 10213             OR
 10214         W-PYAJ-RECORD-TYPE EQUAL LOW-VALUES
 10215         MOVE ER-7396            TO EMI-ERROR
 10216         MOVE -1                 TO MAINTL
 10217         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10218
 10219     GO TO 0800-ERROR-TEST.
 10220
 10221 0800-ERROR-TEST.
 10222
 10223     IF  NOT EMI-NO-ERRORS
 10224         IF  EMI-ERROR EQUAL ER-7250
 10225             GO TO 0800-EXIT
 10226         ELSE
 10227             GO TO 8200-SEND-DATAONLY.
 10228
 10229 0800-EXIT.
 10230     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 198
* EL689.cbl
 10232 0900-EDIT-CARRIER.
 10233
 10234     IF  CARRIERL EQUAL ZEROES
 10235         MOVE LOW-VALUES         TO PI-689-CARRIER
 10236                                    W-ACCT-CARRIER
 10237                                    W-CERT-CARRIER
 10238                                    W-COMP-CARRIER
 10239                                    W-CHEK-CARRIER
 10240                                    W-MAIL-CARRIER
 10241                                    W-PNDB2-CARRIER
 10242                                    W-PYAJ-CARRIER
 10243     ELSE
 10244         PERFORM 0990-CARRIER-VALIDITY-CHECK THRU 0990-EXIT.
 10245
 10246 0900-EXIT.
 10247     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 199
* EL689.cbl
 10249 0905-EDIT-GROUPING.
 10250
 10251     IF  GROUPL EQUAL ZEROES
 10252         MOVE LOW-VALUES         TO PI-689-GROUPING
 10253                                    W-ACCT-GROUPING
 10254                                    W-CERT-GROUPING
 10255                                    W-CHEK-GROUPING
 10256                                    W-COMP-GROUPING
 10257                                    W-MAIL-GROUPING
 10258                                    W-PNDB2-GROUPING
 10259                                    W-PYAJ-GROUPING
 10260     ELSE
 10261         MOVE AL-UANON           TO GROUPA
 10262         MOVE GROUPI             TO PI-689-GROUPING
 10263                                    W-ACCT-GROUPING
 10264                                    W-CERT-GROUPING
 10265                                    W-CHEK-GROUPING
 10266                                    W-COMP-GROUPING
 10267                                    W-MAIL-GROUPING
 10268                                    W-PNDB2-GROUPING
 10269                                    W-PYAJ-GROUPING.
 10270
 10271 0905-EXIT.
 10272     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 200
* EL689.cbl
 10274 0910-EDIT-STATE.
 10275
 10276     IF  STATEL EQUAL ZEROES
 10277         MOVE LOW-VALUES         TO PI-689-STATE
 10278                                    W-ACCT-STATE
 10279                                    W-CERT-STATE
 10280                                    W-CHEK-STATE
 10281                                    W-MAIL-STATE
 10282                                    W-PNDB2-STATE
 10283     ELSE
 10284         PERFORM 0994-STATE-VALIDITY-CHECK THRU 0994-EXIT.
 10285
 10286 0910-EXIT.
 10287     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 201
* EL689.cbl
 10289 0915-EDIT-ACCOUNT.
 10290
 10291     IF  ACCTL EQUAL ZEROES
 10292         MOVE LOW-VALUES         TO PI-689-ACCOUNT
 10293                                    W-ACCT-ACCOUNT
 10294                                    W-CERT-ACCOUNT
 10295                                    W-CHEK-ACCOUNT
 10296                                    W-COMP-ACCOUNT
 10297                                    W-MAIL-ACCOUNT
 10298                                    W-PNDB2-ACCOUNT
 10299                                    W-PYAJ-ACCOUNT
 10300     ELSE
 10301         MOVE AL-UANON           TO ACCTA
 10302         MOVE ACCTI              TO PI-689-ACCOUNT
 10303                                    W-ACCT-ACCOUNT
 10304                                    W-CERT-ACCOUNT
 10305                                    W-CHEK-ACCOUNT
 10306                                    W-COMP-ACCOUNT
 10307                                    W-MAIL-ACCOUNT
 10308                                    W-PYAJ-ACCOUNT
 10309                                    W-PNDB2-ACCOUNT.
 10310
 10311 0915-EXIT.
 10312     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 202
* EL689.cbl
 10314 0920-EDIT-EXP-DATE.
 10315
 10316     IF  DATEL NOT EQUAL ZEROS
 10317         IF  DATEI EQUAL '99/99/99' OR '999999'
 10318             MOVE '99/99/99'     TO DATEO
 10319                                    PI-689-DATE-EDIT
 10320             MOVE AL-UANON       TO DATEA
 10321             MOVE HIGH-VALUES    TO PI-689-EXP-DATE
 10322                                    W-ACCT-EXP-DT
 10323         ELSE
 10324             MOVE DATEI          TO W-DEEDIT-FIELD
 10325             PERFORM 8600-DEEDIT
 10326             MOVE W-DEEDIT-FIELD-V0
 10327                                 TO DC-GREG-DATE-1-MDY
 10328             MOVE '4'            TO DC-OPTION-CODE
 10329             PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10330             IF  DATE-CONVERSION-ERROR
 10331                 MOVE ER-0454    TO EMI-ERROR
 10332                 MOVE -1         TO DATEL
 10333                 MOVE AL-UABON   TO DATEA
 10334                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10335             ELSE
 10336                 MOVE DC-GREG-DATE-1-EDIT
 10337                                 TO DATEO
 10338                                    PI-689-DATE-EDIT
 10339                 MOVE AL-UANON   TO DATEA
 10340                 MOVE DC-BIN-DATE-1
 10341                                 TO PI-689-EXP-DATE
 10342                                    W-ACCT-EXP-DT
 10343     ELSE
 10344         MOVE LOW-VALUES         TO PI-689-EXP-DATE
 10345                                    W-ACCT-EXP-DT
 10346                                    PI-689-DATE-EDIT.
 10347
 10348 0920-EXIT.
 10349     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 203
* EL689.cbl
 10351 0925-EDIT-EFF-DATE.
 10352
 10353     IF  CERTL EQUAL ZERO
 10354             AND
 10355         DATASORI NOT EQUAL '2'
 10356         GO TO 0925-EXIT.
 10357
 10358     IF  DATEL NOT EQUAL ZEROS
 10359         MOVE DATEI              TO W-DEEDIT-FIELD
 10360         PERFORM 8600-DEEDIT
 10361         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 10362         MOVE '4'                TO DC-OPTION-CODE
 10363         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10364
 10365         IF  DATE-CONVERSION-ERROR
 10366             MOVE ER-0215        TO EMI-ERROR
 10367             MOVE -1             TO DATEL
 10368             MOVE AL-UABON       TO DATEA
 10369             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10370         ELSE
 10371             MOVE DC-GREG-DATE-1-EDIT
 10372                                 TO DATEO
 10373                                    PI-689-DATE-EDIT
 10374             MOVE AL-UANON       TO DATEA
 10375             MOVE DC-BIN-DATE-1  TO PI-689-EFF-DATE
 10376                                    W-CERT-EFF-DT
 10377                                    W-CHEK-EFF-DT
 10378                                    W-MAIL-EFF-DT
 10379                                    W-PNDB2-EFF-DT
 10380     ELSE
 10381         MOVE LOW-VALUES         TO PI-689-EFF-DATE
 10382                                    W-PNDB2-EFF-DT
 10383                                    W-CHEK-EFF-DT
 10384                                    W-MAIL-EFF-DT
 10385                                    W-CERT-EFF-DT
 10386                                    PI-689-DATE-EDIT.
 10387
 10388 0925-EXIT.
 10389     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 204
* EL689.cbl
 10391 0930-EDIT-CERTIFICATE.
 10392
 10393     IF  CERTL EQUAL ZEROES
 10394         MOVE LOW-VALUES         TO PI-689-CERT-PRIME
 10395                                    W-CERT-CERT-PRIME
 10396                                    W-CHEK-CERT-PRIME
 10397                                    W-MAIL-CERT-PRIME
 10398                                    W-PNDB2-CERT-PRIME
 10399                                    PI-689-CERT-SFX
 10400                                    W-CERT-CERT-SFX
 10401                                    W-CHEK-CERT-SFX
 10402                                    W-MAIL-CERT-SFX
 10403                                    W-PNDB2-CERT-SFX
 10404     ELSE
 10405         MOVE AL-UANON           TO CERTA
 10406         MOVE CERTI              TO PI-689-CERT-PRIME
 10407                                    W-CERT-CERT-PRIME
 10408                                    W-CHEK-CERT-PRIME
 10409                                    W-MAIL-CERT-PRIME
 10410                                    W-PNDB2-CERT-PRIME
 10411         IF  SFXL EQUAL ZEROES
 10412                 OR
 10413             SFXI EQUAL LOW-VALUES
 10414             MOVE SPACES         TO PI-689-CERT-SFX
 10415                                    W-CERT-CERT-SFX
 10416                                    W-CHEK-CERT-SFX
 10417                                    W-MAIL-CERT-SFX
 10418                                    W-PNDB2-CERT-SFX
 10419         ELSE
 10420             MOVE AL-UANON       TO SFXA
 10421             MOVE SFXI           TO PI-689-CERT-SFX
 10422                                    W-CERT-CERT-SFX
 10423                                    W-CHEK-CERT-SFX
 10424                                    W-MAIL-CERT-SFX
 10425                                    W-PNDB2-CERT-SFX.
 10426
 10427 0930-EXIT.
 10428     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 205
* EL689.cbl
 10430 0935-EDIT-RESP-PERSON.
 10431
 10432     IF  RPERSONL EQUAL ZEROES
 10433         MOVE LOW-VALUES         TO PI-689-RESP-PERSON
 10434                                    W-COMP-RESP-PERSON
 10435                                    W-PYAJ-FIN-RESP
 10436     ELSE
 10437         MOVE AL-UANON           TO RPERSONA
 10438         MOVE RPERSONI           TO PI-689-RESP-PERSON
 10439                                    W-PYAJ-FIN-RESP
 10440                                    W-COMP-RESP-PERSON.
 10441
 10442 0935-EXIT.
 10443     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 206
* EL689.cbl
 10445 0940-EDIT-ACCOUNT.
 10446
 10447     IF  ACCTL EQUAL ZEROES
 10448         MOVE LOW-VALUES         TO PI-689-ACCOUNT
 10449                                    W-COMP-ACCOUNT
 10450                                    W-PYAJ-ACCOUNT
 10451     ELSE
 10452         MOVE AL-UANON           TO ACCTA
 10453         MOVE ACCTI              TO PI-689-ACCOUNT
 10454                                    W-PYAJ-ACCOUNT
 10455                                    W-COMP-ACCOUNT.
 10456
 10457 0940-EXIT.
 10458     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 207
* EL689.cbl
 10460 0945-EDIT-TYPE.
 10461
 10462     IF  TYPEL EQUAL ZEROES
 10463         MOVE LOW-VALUES         TO PI-689-TYPE
 10464                                    W-COMP-TYPE
 10465                                    W-PYAJ-RECORD-TYPE
 10466     ELSE
 10467         INSPECT TYPEI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
 10468         IF TYPEI = 'C' OR 'G' OR 'A'
 10469             MOVE AL-UANON       TO TYPEA
 10470             MOVE TYPEI          TO PI-689-TYPE
 10471                                    W-COMP-TYPE
 10472                                    W-PYAJ-RECORD-TYPE
 10473         ELSE
 10474             MOVE ER-7368        TO EMI-ERROR
 10475             MOVE -1             TO TYPEL
 10476             MOVE AL-UABON       TO TYPEA
 10477             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10478
 10479 0945-EXIT.
 10480     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 208
* EL689.cbl
 10482 0950-EDIT-ENTRY.
 10483
 10484     IF  BENTRYL EQUAL ZEROES
 10485         MOVE LOW-VALUES         TO PI-689-ENTRY-BATCH
 10486                                    W-PNDB-ENTRY
 10487     ELSE
 10488         MOVE AL-UANON           TO BENTRYA
 10489         MOVE BENTRYI            TO PI-689-ENTRY-BATCH
 10490                                    W-PNDB-ENTRY.
 10491
 10492 0950-EXIT.
 10493     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 209
* EL689.cbl
 10495 0955-EDIT-SEQUENCE.
 10496
 10497     IF  SEQL NOT EQUAL ZEROS
 10498         IF  SEQI NOT NUMERIC
 10499                 OR
 10500             SEQI EQUAL '0'
 10501             MOVE ER-7367        TO EMI-ERROR
 10502             MOVE -1             TO SEQL
 10503             MOVE AL-UABON       TO SEQA
 10504             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10505         ELSE
 10506             MOVE AL-UANON       TO SEQA
 10507             MOVE SEQI           TO PI-689-SEQ-NO
 10508                                    W-CHEK-SEQ-NO
 10509                                    W-PYAJ-FILE-SEQ-NO
 10510                                    W-PNDB-SEQ-NO
 10511                                    PI-689-SEQ-EDIT
 10512     ELSE
 10513         MOVE LOW-VALUES         TO PI-689-SEQ-EDIT.
 10514
 10515 0955-EXIT.
 10516     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 210
* EL689.cbl
 10518 0960-EDIT-BATCH-SEQ.
 10519
 10520     IF  BCSEQL NOT EQUAL ZEROS
 10521         IF  BCSEQI NOT NUMERIC
 10522             MOVE ER-7368        TO EMI-ERROR
 10523             MOVE -1             TO BCSEQL
 10524             MOVE AL-UABON       TO BCSEQA
 10525             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10526         ELSE
 10527             MOVE AL-UANON       TO BCSEQA
 10528             MOVE BCSEQI         TO PI-689-CHG-SEQ-NO
 10529                                    W-PNDB-CHG-SEQ-NO
 10530                                    W-PNDB2-ALT-CHG-SEQ-NO
 10531                                    PI-689-BCSEQ-EDIT
 10532     ELSE
 10533         MOVE LOW-VALUES         TO PI-689-BCSEQ-EDIT.
 10534
 10535 0960-EXIT.
 10536     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 211
* EL689.cbl
 10538 0965-EDIT-TYPE.
 10539
 10540     IF  TYPEL EQUAL ZEROES
 10541         MOVE LOW-VALUES         TO PI-689-TYPE
 10542                                    W-PNDB2-TYPE
 10543     ELSE
 10544         IF  DATASORI NOT EQUAL '4'
 10545             GO TO 0965-EXIT
 10546         ELSE
 10547             IF TYPEI = '0' OR '1' OR '2' OR '3'
 10548                 MOVE AL-UANON   TO TYPEA
 10549                 MOVE TYPEI      TO PI-689-TYPE
 10550                                    W-PNDB2-TYPE
 10551             ELSE
 10552                 MOVE ER-7370    TO EMI-ERROR
 10553                 MOVE -1         TO TYPEL
 10554                 MOVE AL-UABON   TO TYPEA
 10555                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10556
 10557 0965-EXIT.
 10558     EXIT.
 10559
 10560 0970-EDIT-CSO.
 10561
 10562     IF ENDARCHL > ZEROS
 10563        IF ENDARCHI NUMERIC
 10564            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
 10565            MOVE AL-UNNON       TO ENDARCHA
 10566            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
 10567            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
 10568            MOVE 'N'            TO W-VALID-ENDT-SW
 10569            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
 10570            IF NOT W-VALID-ENDT
 10571                MOVE -1         TO ENDARCHL
 10572                MOVE ER-1565    TO EMI-ERROR
 10573                MOVE AL-UNBON   TO ENDARCHA
 10574                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10575            END-IF
 10576        END-IF
 10577     ELSE
 10578        MOVE ZEROS              TO PI-ENDT-ARCH-NO
 10579     END-IF
 10580
 10581     IF PI-CERT-REQ-IND = 'Y'
 10582       IF  CERTIDL NOT EQUAL ZEROS
 10583         IF CERTIDI NUMERIC
 10584             MOVE AL-UANON      TO CERTIDA
 10585             MOVE CERTIDI       TO PI-CERT-FORM-ID
 10586         ELSE
 10587             MOVE ER-1778       TO EMI-ERROR
 10588             MOVE -1            TO CERTIDL
 10589             MOVE AL-UABON      TO CERTIDA
 10590             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10591         END-IF
 10592       ELSE
 10593          MOVE ER-0715       TO EMI-ERROR
 10594          MOVE -1            TO CERTIDL
 10595          MOVE AL-UABON      TO CERTIDA
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 212
* EL689.cbl
 10596          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10597       END-IF
 10598     END-IF.
 10599
 10600 0970-EXIT.
 10601      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 213
* EL689.cbl
 10603 0990-CARRIER-VALIDITY-CHECK.
 10604
 10605     IF  CARRIERI EQUAL SPACES
 10606         GO TO 0990-EXIT.
 10607
 10608     MOVE SPACES                 TO W-CNTL-KEY.
 10609     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10610     MOVE '6'                    TO W-CNTL-RECORD-TYPE.
 10611     MOVE CARRIERI               TO W-CNTL-GEN4.
 10612     MOVE +0                     TO W-CNTL-SEQ-NO.
 10613
 10614
 10615* EXEC CICS HANDLE CONDITION
 10616*        NOTFND  (0990-CARRIER-NOT-FOUND)
 10617*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10618*    END-EXEC.
 10619*    MOVE '"$IJ                  ! & #00010380' TO DFHEIV0
 10620     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10622     MOVE X'2620233030303130333830' TO DFHEIV0(25:11)
 10623     CALL 'kxdfhei1' USING DFHEIV0
 10624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10625
 10626
 10627
 10628* EXEC CICS READ
 10629*        DATASET (W-CNTL-FILE-ID)
 10630*        SET     (ADDRESS OF CONTROL-FILE)
 10631*        RIDFLD  (W-CNTL-KEY)
 10632*    END-EXEC.
 10633*    MOVE '&"S        E          (   #00010385' TO DFHEIV0
 10634     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10635     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10636     MOVE X'2020233030303130333835' TO DFHEIV0(25:11)
 10637     CALL 'kxdfhei1' USING DFHEIV0,
 10638           W-CNTL-FILE-ID,
 10639           DFHEIV20,
 10640           DFHEIV99,
 10641           W-CNTL-KEY,
 10642           DFHEIV99,
 10643           DFHEIV99,
 10644           DFHEIV99
 10645     SET ADDRESS OF CONTROL-FILE TO
 10646         DFHEIV20
 10647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10648
 10649
 10650     IF  PI-NO-CARRIER-SECURITY
 10651             OR
 10652         PI-CARRIER-SECURITY EQUAL CARRIERI
 10653         MOVE AL-UANON           TO CARRIERA
 10654         MOVE CARRIERI           TO PI-689-CARRIER
 10655                                    W-ACCT-CARRIER
 10656                                    W-CERT-CARRIER
 10657                                    W-CHEK-CARRIER
 10658                                    W-COMP-CARRIER
 10659                                    W-MAIL-CARRIER
 10660                                    W-PNDB2-CARRIER
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 214
* EL689.cbl
 10661                                    W-PYAJ-CARRIER
 10662     ELSE
 10663         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
 10664         MOVE ER-9095            TO EMI-ERROR
 10665         MOVE -1                 TO MAINTL
 10666         MOVE AL-UANON           TO MAINTA
 10667         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10668
 10669     GO TO 0990-EXIT.
 10670
 10671 0990-CARRIER-NOT-FOUND.
 10672
 10673     MOVE -1                     TO CARRIERL.
 10674     MOVE AL-UABON               TO CARRIERA.
 10675     MOVE ER-2208                TO EMI-ERROR.
 10676     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10677
 10678 0990-EXIT.
 10679     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 215
* EL689.cbl
 10681 0994-STATE-VALIDITY-CHECK.
 10682
 10683     IF  STATEI EQUAL SPACES
 10684         GO TO 0994-EXIT.
 10685
 10686     MOVE SPACES                 TO W-CNTL-KEY.
 10687     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10688     MOVE '3'                    TO W-CNTL-RECORD-TYPE.
 10689     MOVE STATEI                 TO W-CNTL-GEN1.
 10690     MOVE +0                     TO W-CNTL-SEQ-NO.
 10691
 10692
 10693* EXEC CICS HANDLE CONDITION
 10694*        NOTFND  (0994-STATE-NOT-FOUND)
 10695*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10696*    END-EXEC.
 10697*    MOVE '"$IJ                  ! '' #00010433' TO DFHEIV0
 10698     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10700     MOVE X'2720233030303130343333' TO DFHEIV0(25:11)
 10701     CALL 'kxdfhei1' USING DFHEIV0
 10702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10703
 10704
 10705
 10706* EXEC CICS READ
 10707*        DATASET (W-CNTL-FILE-ID)
 10708*        SET     (ADDRESS OF CONTROL-FILE)
 10709*        RIDFLD  (W-CNTL-KEY)
 10710*    END-EXEC.
 10711*    MOVE '&"S        E          (   #00010438' TO DFHEIV0
 10712     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10713     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10714     MOVE X'2020233030303130343338' TO DFHEIV0(25:11)
 10715     CALL 'kxdfhei1' USING DFHEIV0,
 10716           W-CNTL-FILE-ID,
 10717           DFHEIV20,
 10718           DFHEIV99,
 10719           W-CNTL-KEY,
 10720           DFHEIV99,
 10721           DFHEIV99,
 10722           DFHEIV99
 10723     SET ADDRESS OF CONTROL-FILE TO
 10724         DFHEIV20
 10725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10726
 10727
 10728     MOVE AL-UANON               TO STATEA.
 10729     MOVE STATEI                 TO PI-689-STATE
 10730                                    W-ACCT-STATE
 10731                                    W-CERT-STATE
 10732                                    W-CHEK-STATE
 10733                                    W-MAIL-STATE
 10734                                    W-PNDB2-STATE.
 10735
 10736     GO TO 0994-EXIT.
 10737
 10738 0994-STATE-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 216
* EL689.cbl
 10739
 10740     MOVE -1                     TO STATEL.
 10741     MOVE AL-UABON               TO STATEA.
 10742     MOVE ER-2209                TO EMI-ERROR.
 10743     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10744
 10745 0994-EXIT.
 10746     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 217
* EL689.cbl
 10748 1000-SHOW.
 10749***************************************************************
 10750*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
 10751*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN.  IF THE       *
 10752*     HEADER RECORD IS FOUND THE TEXT IS THEN READ AND        *
 10753*     WILL BE INSERTED INTO THE W-TS-TABLE AND DISPLAYED.     *
 10754***************************************************************
 10755
 10756     MOVE SPACES                 TO W-RECORD-TABLE.
 10757
 10758     IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 10759          MOVE PI-689-LBL-OVERRIDE
 10760                                 TO ADDRLBLI
 10761          MOVE +1                TO ADDRLBLL
 10762          MOVE AL-UANON          TO ADDRLBLA
 10763     ELSE
 10764          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 10765          MOVE +1                TO ADDRLBLL
 10766          MOVE AL-UANON          TO ADDRLBLA.
 10767
 10768     IF  ARCHNUML EQUAL ZEROS
 10769         MOVE -1                 TO ARCHNUML
 10770         MOVE AL-UNBON           TO ARCHNUMA
 10771         MOVE ER-0174            TO EMI-ERROR
 10772         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10773         GO TO 8200-SEND-DATAONLY.
 10774
 10775     IF  ARCHNUMI NOT NUMERIC
 10776         MOVE -1                 TO ARCHNUML
 10777         MOVE AL-UNBON           TO ARCHNUMA
 10778         MOVE ER-0175            TO EMI-ERROR
 10779         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10780         GO TO 8200-SEND-DATAONLY.
 10781
 10782     IF  PI-SHOW-MODE
 10783
 10784         IF  PI-689-ARCHIVE-NUMBER EQUAL ARCHNUMI
 10785             MOVE -1             TO MAINTL
 10786             GO TO 8200-SEND-DATAONLY
 10787         ELSE
 10788             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT.
 10789
 10790     MOVE +0                     TO W-ARCH-SEQ-NO
 10791                                    W-ARCT-SEQ-NO.
 10792     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
 10793                                    W-ARCT-COMPANY-CD.
 10794     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 10795                                    W-ARCT-NUMBER
 10796                                    PI-689-ARCHIVE-NUMBER.
 10797     MOVE ' '                    TO W-ARCT-REC-TYPE.
 10798     MOVE '1'                    TO PI-ACTION.
 10799     MOVE SPACES                 TO PI-689-PRINT-SW
 10800                                    PI-689-FORM-NUMBER
 10801                                    W-DELETE-KEY.
 10802     SET W-RG-NDX                TO W-ZEROS.
 10803
 10804
 10805* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 218
* EL689.cbl
 10806*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 10807*         NOTFND     (1070-ARCH-NOT-FOUND)
 10808*         ENDFILE    (1070-ARCH-NOT-FOUND)
 10809*    END-EXEC.
 10810*    MOVE '"$JI''                 ! ( #00010520' TO DFHEIV0
 10811     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 10812     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10813     MOVE X'2820233030303130353230' TO DFHEIV0(25:11)
 10814     CALL 'kxdfhei1' USING DFHEIV0
 10815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10816
 10817
 10818
 10819* EXEC CICS READ
 10820*        DATASET (W-ARCH-FILE-ID)
 10821*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10822*        RIDFLD  (W-ARCH-KEY)
 10823*    END-EXEC.
 10824*    MOVE '&"S        E          (   #00010526' TO DFHEIV0
 10825     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10826     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10827     MOVE X'2020233030303130353236' TO DFHEIV0(25:11)
 10828     CALL 'kxdfhei1' USING DFHEIV0,
 10829           W-ARCH-FILE-ID,
 10830           DFHEIV20,
 10831           DFHEIV99,
 10832           W-ARCH-KEY,
 10833           DFHEIV99,
 10834           DFHEIV99,
 10835           DFHEIV99
 10836     SET ADDRESS OF LETTER-ARCHIVE TO
 10837         DFHEIV20
 10838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10839
 10840
 10841     PERFORM 1040-FORMAT-HEADER-DATA THRU 1040-EXIT.
 10842
 10843*    EXEC CICS HANDLE CONDITION
 10844*         NOTOPEN    (8015-ARCT-NOT-OPEN)
 10845*         NOTFND     (1020-ARCT-ENDBR)
 10846*         ENDFILE    (1020-ARCT-ENDBR)
 10847*    END-EXEC.
 10848*
 10849*1005-START-BROWSE.
 10850*
 10851*    EXEC CICS STARTBR
 10852*         DATASET    (W-ARCT-FILE-ID)
 10853*         RIDFLD     (W-ARCT-KEY)
 10854*         GTEQ
 10855*    END-EXEC.
 10856*
 10857*    MOVE 'Y'                    TO W-ARCT-BROWSE-STARTED.
 10858*
 10859*1010-READ-NEXT.
 10860*
 10861*    EXEC CICS READNEXT
 10862*         SET       (ADDRESS OF LETTER-ARCHIVE-TEXT)
 10863*         DATASET   (W-ARCT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 219
* EL689.cbl
 10864*         RIDFLD    (W-ARCT-KEY)
 10865*    END-EXEC.
 10866*
 10867*    IF  W-ARCH-PARTIAL-KEY EQUAL W-ARCT-PARTIAL-KEY
 10868*        IF  LT-ADDRESS-DATA
 10869*            IF  PI-CREATE-LABELS  AND
 10870*                NOT PI-689-LABELS-OVERRIDEN
 10871*                PERFORM 1050-MOVE-LABELS THRU 1050-EXIT
 10872*                        VARYING
 10873*                    LT-NDX FROM 1 BY 1
 10874*                        UNTIL
 10875*                    LT-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 10876*                GO TO 1010-READ-NEXT
 10877*            ELSE
 10878*                MOVE LT-CONTROL-PRIMARY
 10879*                                TO W-DELETE-KEY
 10880*                GO TO 1010-READ-NEXT
 10881*        ELSE
 10882*            PERFORM 1030-TEXT-BUILD THRU 1030-EXIT
 10883*                    VARYING
 10884*                LT-NDX FROM 1 BY 1
 10885*                    UNTIL
 10886*                LT-NDX GREATER THAN LT-NUM-LINES-ON-RECORD
 10887*                    OR
 10888*                LT-NDX GREATER THAN +20
 10889*            GO TO 1010-READ-NEXT.
 10890*
 10891*1020-ARCT-ENDBR.
 10892*
 10893*    IF  W-ARCT-BROWSE-STARTED EQUAL 'Y'
 10894*        EXEC CICS ENDBR
 10895*             DATASET   (W-ARCT-FILE-ID)
 10896*        END-EXEC.
 10897*
 10898*    IF  W-RG-NDX EQUAL ZEROS
 10899*        GO TO 1080-ARCHIVE-TEXT-NOT-FOUND.
 10900*
 10901*    IF  PI-689-NUMBER-LABEL-LINES GREATER THAN +0
 10902*            AND
 10903*        PI-BYPASS-LABELS
 10904*        MOVE W-DELETE-KEY       TO W-ARCT-KEY
 10905*        PERFORM 1060-DELETE-ADDRESS-RECORD THRU 1060-EXIT
 10906*        MOVE +0                 TO PI-689-NUMBER-LABEL-LINES.
 10907*
 10908*    SET PI-TOTAL-LINES          TO W-RG-NDX.
 10909*    MOVE 1                      TO PI-CURRENT-LINE.
 10910*    SET W-RG-NDX                TO +1.
 10911*
 10912*    PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10913*            VARYING
 10914*        W-SC-NDX FROM 1 BY 1
 10915*            UNTIL
 10916*        W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10917
 10918     MOVE -1                     TO MAINTL.
 10919     GO TO 8100-SEND-INITIAL-MAP.
 10920
 10921 1020-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 220
* EL689.cbl
 10922     EXIT.
 10923
 10924 1030-TEXT-BUILD.
 10925
 10926     SET W-RG-NDX UP BY 1.
 10927     MOVE LT-SKIP-CONTROL (LT-NDX)
 10928                                 TO W-PRINT-CONTROL.
 10929
 10930     IF  W-PRINT-CONTROL EQUAL 99
 10931         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 10932         SET W-RG-NDX UP BY 1
 10933     ELSE
 10934         SET W-RG-NDX UP BY W-PRINT-CONTROL.
 10935
 10936     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10937     MOVE LT-SKIP-CONTROL (LT-NDX)
 10938                                 TO W-RC-PC (W-RG-NDX).
 10939     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10940
 10941 1030-EXIT.
 10942     EXIT.
 10943
 10944 1040-FORMAT-HEADER-DATA.
 10945
 10946     MOVE LA-ACCOUNT-A2          TO ACCTO.
 10947     MOVE LA-ADDR-SOURCE         TO ADDRSO.
 10948     MOVE LA-CARRIER-A2          TO CARRIERO.
 10949     MOVE LA-CERT-NO-A2          TO CERTO.
 10950     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
 10951     MOVE LA-DATA-SOURCE         TO DATASORO.
 10952
 10953     IF  LA-EFFECT-DATE-A2 EQUAL LOW-VALUES
 10954         MOVE ZEROES             TO DATEO
 10955
 10956     ELSE
 10957         MOVE LA-EFFECT-DATE-A2  TO DC-BIN-DATE-1
 10958         MOVE ' '                TO DC-OPTION-CODE
 10959         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10960         MOVE DC-GREG-DATE-1-EDIT
 10961                                 TO DATEO.
 10962
 10963     IF  LA-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10964         MOVE ZEROES             TO FOLLOWO
 10965     ELSE
 10966         MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
 10967         MOVE ' '                TO DC-OPTION-CODE
 10968         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10969         MOVE DC-GREG-DATE-1-EDIT
 10970                                 TO FOLLOWO.
 10971
 10972     MOVE LA-FORM-A3             TO FORMO.
 10973     MOVE LA-GROUPING-A2         TO GROUPO.
 10974     MOVE LA-NO-OF-COPIES        TO COPIESO
 10975                                    PI-689-NUMBER-COPIES.
 10976
 10977*    IF LA-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
 10978*        MOVE LA-PRINT-RESTRICTION
 10979*                                TO PRTRESTO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 221
* EL689.cbl
 10980*    ELSE
 10981*        MOVE SPACES             TO PRTRESTO.
 10982
 10983     IF  LA-RESEND-DATE = LOW-VALUES
 10984         MOVE ZEROES             TO RESEND1O
 10985     ELSE
 10986         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
 10987         MOVE ' '                TO DC-OPTION-CODE
 10988         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10989         MOVE DC-GREG-DATE-1-EDIT
 10990                                 TO RESEND1O.
 10991
 10992     MOVE LA-STATE-A2            TO STATEO.
 10993
 10994     MOVE LA-NUMBER-LABEL-LINES  TO PI-689-NUMBER-LABEL-LINES.
 10995
 10996 1040-EXIT.
 10997     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 222
* EL689.cbl
 10999 1050-MOVE-LABELS.
 11000
 11001     SET W-RG-NDX                TO LT-NDX.
 11002     MOVE ZEROS                  TO W-RC-PC (W-RG-NDX).
 11003     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 11004     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 11005
 11006 1050-EXIT.
 11007     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 223
* EL689.cbl
 11009 1060-DELETE-ADDRESS-RECORD.
 11010
 11011
 11012* EXEC CICS DELETE
 11013*        DATASET (W-ARCT-FILE-ID)
 11014*        RIDFLD  (W-DELETE-KEY)
 11015*    END-EXEC.
 11016*    MOVE '&(  R                 &   #00010702' TO DFHEIV0
 11017     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 11018     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11019     MOVE X'2020233030303130373032' TO DFHEIV0(25:11)
 11020     CALL 'kxdfhei1' USING DFHEIV0,
 11021           W-ARCT-FILE-ID,
 11022           W-DELETE-KEY,
 11023           DFHEIV99,
 11024           DFHEIV99,
 11025           DFHEIV99
 11026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11027
 11028
 11029
 11030* EXEC CICS READ
 11031*        DATASET (W-ARCH-FILE-ID)
 11032*        SET     (ADDRESS OF LETTER-ARCHIVE)
 11033*        RIDFLD  (W-ARCH-KEY)
 11034*        UPDATE
 11035*    END-EXEC.
 11036*    MOVE '&"S        EU         (   #00010707' TO DFHEIV0
 11037     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11038     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11039     MOVE X'2020233030303130373037' TO DFHEIV0(25:11)
 11040     CALL 'kxdfhei1' USING DFHEIV0,
 11041           W-ARCH-FILE-ID,
 11042           DFHEIV20,
 11043           DFHEIV99,
 11044           W-ARCH-KEY,
 11045           DFHEIV99,
 11046           DFHEIV99,
 11047           DFHEIV99
 11048     SET ADDRESS OF LETTER-ARCHIVE TO
 11049         DFHEIV20
 11050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11051
 11052
 11053     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES.
 11054
 11055
 11056* EXEC CICS REWRITE
 11057*         FROM      (LETTER-ARCHIVE)
 11058*         DATASET   (W-ARCH-FILE-ID)
 11059*    END-EXEC.
 11060     MOVE LENGTH OF
 11061      LETTER-ARCHIVE
 11062       TO DFHEIV11
 11063*    MOVE '&& L                  %   #00010716' TO DFHEIV0
 11064     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11065     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11066     MOVE X'2020233030303130373136' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 224
* EL689.cbl
 11067     CALL 'kxdfhei1' USING DFHEIV0,
 11068           W-ARCH-FILE-ID,
 11069           LETTER-ARCHIVE,
 11070           DFHEIV11,
 11071           DFHEIV99
 11072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11073
 11074
 11075 1060-EXIT.
 11076     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 225
* EL689.cbl
 11078 1070-ARCH-NOT-FOUND.
 11079
 11080     MOVE ER-7371                TO EMI-ERROR.
 11081     MOVE -1                     TO ARCHNUML.
 11082     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11083     GO TO 8100-SEND-INITIAL-MAP.
 11084
 11085 1080-ARCHIVE-TEXT-NOT-FOUND.
 11086
 11087     MOVE ER-7372                TO EMI-ERROR.
 11088     MOVE -1                     TO ARCHNUML.
 11089     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11090     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 226
* EL689.cbl
 11092 2000-CREATE.
 11093***************************************************************
 11094*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
 11095*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
 11096*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
 11097*    WILL BE DISPLAYED ON THE SCREEN.                         *
 11098*                                                             *
 11099***************************************************************
 11100
 11101***************************************************************
 11102*    CHECK TO SEE IF IT IS THE SAME REQUEST OR NOT.           *
 11103*    IF IT IS A NEW REQUEST AND A LETTER WAS PRINTED          *
 11104*    THEN FORCE AN ERROR.                                     *
 11105***************************************************************
 11106
 11107     IF  PI-689-CREATE-NO-SCREENS
 11108         GO TO 2000-GET-TEXT.
 11109
 11110     IF  PI-CREATE-MODE
 11111         IF  PI-689-PRINT-PERFORMED
 11112                 AND
 11113             FORMI NOT EQUAL 9999
 11114             MOVE ER-0279    TO EMI-ERROR
 11115             MOVE -1         TO MAINTL
 11116             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11117             GO TO 8200-SEND-DATAONLY.
 11118
 11119     IF  ARCHNUML GREATER THAN ZEROS
 11120         MOVE ER-9320            TO EMI-ERROR
 11121         MOVE -1                 TO ARCHNUML
 11122         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11123         GO TO 8200-SEND-DATAONLY.
 11124
 11125***************************************************************
 11126*    IF  A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE     *
 11127*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
 11128***************************************************************
 11129
 11130     IF  FORMI EQUAL '9999'
 11131         MOVE 16                 TO PI-TOTAL-LINES
 11132         MOVE 1                  TO PI-CURRENT-LINE
 11133         MOVE SPACES             TO W-FILE-TABLE
 11134                                    W-LINE-CONTROL-RECORD
 11135                                    W-RECORD-TABLE
 11136                                    W-SINGLE-LINE
 11137                                    W-SQUEEZED-LINE
 11138                                    W-TS-WORK-AREA
 11139                                    W-TX-TABLE
 11140         PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 11141         MOVE '3'                TO PI-ACTION
 11142         MOVE FORMI              TO PI-689-FORM-NUMBER
 11143                                    PI-COMM-CONTROL
 11144         MOVE ZEROS              TO PI-UPDATE-SW
 11145         MOVE W-PGM-EL1042       TO W-CALL-PGM
 11146         GO TO 9400-XCTL.
 11147
 11148 2000-GET-TEXT.
 11149
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 227
* EL689.cbl
 11150     MOVE SPACES                 TO W-FILE-TABLE
 11151                                    W-LINE-CONTROL-RECORD
 11152                                    W-RECORD-TABLE
 11153                                    W-SINGLE-LINE
 11154                                    W-SQUEEZED-LINE
 11155                                    W-TS-WORK-AREA
 11156                                    W-TX-TABLE.
 11157     SET W-TG-NDX                TO +1
 11158     MOVE ZEROS                  TO W-INITIAL-COLUMN
 11159                                    W-LINE-COUNT
 11160                                    W-LINE-INDENT-1
 11161                                    W-LINE-INDENT-2
 11162                                    W-LINE-INDENT-3
 11163                                    W-LINE-INDENT-4
 11164                                    W-LINE-INDENT-5
 11165                                    W-PAGE
 11166                                    W-PARAGRAPH-INDENT
 11167                                    W-TOP-MARGIN
 11168                                    W-WORK-INDENT.
 11169     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
 11170     MOVE +70                    TO W-LAST-COLUMN.
 11171     MOVE +56                    TO W-MAX-LINES-PER-PAGE.
 11172     MOVE +1                     TO W-START-COLUMN.
 11173     MOVE +71                    TO W-TOO-FAR.
 11174
 11175     MOVE PI-COMPANY-CD          TO W-TEXT-COMPANY-CD.
 11176     MOVE FORMI                  TO W-TEXT-LETTER.
 11177     MOVE W-TEXT-PARTIAL-KEY     TO W-TEXT-SAVE-KEY.
 11178     MOVE 'N'                    TO W-TEXT-BROWSED-SW.
 11179
 11180
 11181* EXEC CICS HANDLE CONDITION
 11182*         NOTFND     (2001-NOT-FOUND)
 11183*         ENDFILE    (2001-NOT-FOUND)
 11184*         NOTOPEN    (8050-TEXT-NOT-OPEN)
 11185*    END-EXEC.
 11186*    MOVE '"$I''J                 ! ) #00010826' TO DFHEIV0
 11187     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 11188     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11189     MOVE X'2920233030303130383236' TO DFHEIV0(25:11)
 11190     CALL 'kxdfhei1' USING DFHEIV0
 11191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11192
 11193
 11194
 11195* EXEC CICS STARTBR
 11196*         DATASET    (W-TEXT-FILE-ID)
 11197*         RIDFLD     (W-TEXT-KEY)
 11198*         GTEQ
 11199*    END-EXEC.
 11200     MOVE 0
 11201       TO DFHEIV11
 11202*    MOVE '&,         G          &   #00010832' TO DFHEIV0
 11203     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11204     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11205     MOVE X'2020233030303130383332' TO DFHEIV0(25:11)
 11206     CALL 'kxdfhei1' USING DFHEIV0,
 11207           W-TEXT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 228
* EL689.cbl
 11208           W-TEXT-KEY,
 11209           DFHEIV99,
 11210           DFHEIV11,
 11211           DFHEIV99
 11212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11213
 11214
 11215
 11216* EXEC CICS HANDLE CONDITION
 11217*         ENDFILE    (2000-ENDBR)
 11218*    END-EXEC.
 11219*    MOVE '"$''                   ! * #00010838' TO DFHEIV0
 11220     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 11221     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11222     MOVE X'2A20233030303130383338' TO DFHEIV0(25:11)
 11223     CALL 'kxdfhei1' USING DFHEIV0
 11224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11225
 11226
 11227 2000-READ-NEXT.
 11228
 11229     IF  W-TG-NDX GREATER THAN W-MAX-LINES
 11230         MOVE ER-0051            TO EMI-ERROR
 11231         MOVE -1                 TO MAINTL
 11232         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11233         GO TO 2000-ENDBR.
 11234
 11235
 11236* EXEC CICS READNEXT
 11237*         DATASET    (W-TEXT-FILE-ID)
 11238*         SET        (ADDRESS OF TEXT-FILES)
 11239*         RIDFLD     (W-TEXT-KEY)
 11240*    END-EXEC.
 11241     MOVE 0
 11242       TO DFHEIV11
 11243*    MOVE '&.S                   )   #00010850' TO DFHEIV0
 11244     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11245     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11246     MOVE X'2020233030303130383530' TO DFHEIV0(25:11)
 11247     CALL 'kxdfhei1' USING DFHEIV0,
 11248           W-TEXT-FILE-ID,
 11249           DFHEIV20,
 11250           DFHEIV99,
 11251           W-TEXT-KEY,
 11252           DFHEIV99,
 11253           DFHEIV11,
 11254           DFHEIV99,
 11255           DFHEIV99
 11256     SET ADDRESS OF TEXT-FILES TO
 11257         DFHEIV20
 11258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11259
 11260
 11261     IF  W-TEXT-PARTIAL-KEY NOT EQUAL W-TEXT-SAVE-KEY
 11262         GO TO 2000-ENDBR.
 11263
 11264     MOVE 'Y'                    TO W-TEXT-BROWSED-SW.
 11265
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 229
* EL689.cbl
 11266     MOVE TX-FORM-SQUEEZE-CONTROL
 11267                                 TO W-FORM-SQUEEZE-IND.
 11268
 11269     IF  PI-689-ARCHIVE-SW NOT GREATER THAN SPACES
 11270         MOVE TX-ARCHIVE-SW      TO PI-689-ARCHIVE-SW.
 11271
 11272     IF  TX-FORM-CONTROL-LINE
 11273         PERFORM 2100-PROCESS-FORM-CONTROL-LINE THRU 2100-EXIT
 11274         GO TO 2000-READ-NEXT.
 11275
 11276     IF  TX-LINE-SQUEEZE-CONTROL EQUAL 'Z'
 11277         PERFORM 2150-PROCESS-Z-CONTROLS THRU 2150-EXIT
 11278         GO TO 2000-READ-NEXT.
 11279
 11280     MOVE TX-TEXT-LINE           TO W-TX-TEXT (W-TG-NDX).
 11281     MOVE TX-PROCESS-CONTROL     TO W-TX-PC (W-TG-NDX).
 11282     PERFORM 2200-CHECK-FOR-VARIABLE THRU 2200-EXIT.
 11283     MOVE TX-LINE-SQUEEZE-CONTROL
 11284                                 TO W-TX-SC (W-TG-NDX).
 11285
 11286     SET W-TG-NDX UP BY 1.
 11287     GO TO 2000-READ-NEXT.
 11288
 11289 2000-ENDBR.
 11290
 11291
 11292* EXEC CICS ENDBR
 11293*        DATASET     (W-TEXT-FILE-ID)
 11294*    END-EXEC.
 11295     MOVE 0
 11296       TO DFHEIV11
 11297*    MOVE '&2                    $   #00010886' TO DFHEIV0
 11298     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11299     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11300     MOVE X'2020233030303130383836' TO DFHEIV0(25:11)
 11301     CALL 'kxdfhei1' USING DFHEIV0,
 11302           W-TEXT-FILE-ID,
 11303           DFHEIV11,
 11304           DFHEIV99
 11305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11306
 11307
 11308     IF  W-TEXT-BROWSE-NOT-STARTED
 11309         MOVE ER-0006            TO EMI-ERROR
 11310         MOVE -1                 TO FORML
 11311         MOVE AL-UABON           TO FORMA
 11312         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11313         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 11314
 11315     SET  W-TOTAL-TX-LINES       TO W-TG-NDX.
 11316     SUBTRACT +1 FROM W-TOTAL-TX-LINES.
 11317     MOVE 1                      TO PI-CURRENT-LINE.
 11318
 11319     IF  COPIESL NOT GREATER THAN ZEROS
 11320         MOVE +1                 TO COPIESI
 11321                                    PI-689-NUMBER-COPIES
 11322         MOVE +1                 TO COPIESL
 11323         MOVE AL-UNNON           TO COPIESA.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 230
* EL689.cbl
 11324
 11325***************************************************************
 11326*    IF IT IS A FORM WITH VARIABLES, THEN RESOLVE ALL OF      *
 11327*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
 11328***************************************************************
 11329
 11330     PERFORM 6000-RESOLVE-VARIABLES THRU 6000-EXIT.
 11331
 11332*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
 11333*        IF  PI-689-CONTROL NOT GREATER THAN ZEROS
 11334*            MOVE ER-7243        TO EMI-ERROR
 11335*            MOVE -1             TO PRTRESTL
 11336*            MOVE AL-UABON       TO PRTRESTA
 11337*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11338
 11339     IF  PI-CREATE-LABELS AND
 11340         NOT  PI-689-LABELS-OVERRIDEN
 11341         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11342         SET W-RG-NDX UP BY +1
 11343     ELSE
 11344         SET W-RG-NDX            TO +1.
 11345
 11346     MOVE W-TOP-FORM             TO W-RC-TEXT (W-RG-NDX).
 11347     SET W-RG-NDX UP BY W-TOP-MARGIN.
 11348
 11349     PERFORM 7400-CREATE-LETTER THRU 7400-EXIT.
 11350
 11351     SET PI-TOTAL-LINES          TO W-RG-NDX.
 11352
 11353     IF  W-FIRST-BAD-VARIABLE-FOUND
 11354         SET W-RG-NDX            TO W-FIRST-BAD-VARIABLE
 11355         MOVE W-FIRST-BAD-VARIABLE
 11356                                 TO PI-CURRENT-LINE
 11357     ELSE
 11358         SET W-RG-NDX            TO 1.
 11359
 11360     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11361             VARYING
 11362         W-SC-NDX FROM 1 BY 1
 11363             UNTIL
 11364         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11365     IF  PI-689-CREATE-NO-SCREENS
 11366         GO TO 2000-EXIT
 11367     ELSE
 11368         IF  W-FORM-CHANGED
 11369             MOVE '3'            TO PI-ACTION
 11370             MOVE -1             TO MAINTL
 11371             GO TO 8100-SEND-INITIAL-MAP
 11372         ELSE
 11373             MOVE '3'            TO PI-ACTION
 11374             MOVE -1             TO MAINTL
 11375             GO TO 8350-SEND-DATAONLY-ERASEAUP.
 11376
 11377 2000-EXIT.
 11378     EXIT.
 11379
 11380 2001-NOT-FOUND.
 11381
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 231
* EL689.cbl
 11382     MOVE ER-0006                TO EMI-ERROR.
 11383     MOVE -1                     TO FORML.
 11384     MOVE AL-UABON               TO FORMA.
 11385     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11386     GO TO 8350-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 232
* EL689.cbl
 11388 2100-PROCESS-FORM-CONTROL-LINE.
 11389
 11390     MOVE TX-TEXT-LINE           TO W-LINE-CONTROL-RECORD.
 11391
 11392     IF  W-LC-LINE-WIDTH NUMERIC
 11393             AND
 11394         W-LC-LINE-WIDTH GREATER THAN ZEROS
 11395         COMPUTE W-INITIAL-COLUMN
 11396             = (70 - W-LC-LINE-WIDTH) / 2
 11397         COMPUTE W-START-COLUMN = W-INITIAL-COLUMN + 1
 11398         COMPUTE W-LAST-COLUMN ROUNDED
 11399             = W-INITIAL-COLUMN + W-LC-LINE-WIDTH
 11400         COMPUTE W-TOO-FAR = W-LAST-COLUMN + 1
 11401     ELSE
 11402         MOVE 70                 TO W-LC-LINE-WIDTH.
 11403
 11404     IF  W-LC-PARAGRAPH-INDENT NUMERIC
 11405             AND
 11406         W-LC-PARAGRAPH-INDENT GREATER THAN ZEROS
 11407         MOVE W-LC-PARAGRAPH-INDENT
 11408                                 TO W-PARAGRAPH-INDENT.
 11409
 11410     IF  W-LC-MAX-LINES-PER-PAGE NUMERIC
 11411             AND
 11412         W-LC-MAX-LINES-PER-PAGE GREATER THAN ZEROS
 11413         MOVE W-LC-MAX-LINES-PER-PAGE
 11414                                 TO W-MAX-LINES-PER-PAGE.
 11415
 11416     IF  W-LC-LINE-ADJUST NUMERIC
 11417             AND
 11418         W-LC-LINE-ADJUST GREATER THAN ZEROS
 11419         COMPUTE W-TOTAL-LINE-LENGTH
 11420             = W-LC-LINE-WIDTH + (W-LC-LINE-ADJUST * 2)
 11421         IF  W-TOTAL-LINE-LENGTH LESS THAN +71
 11422             ADD W-LC-LINE-ADJUST
 11423                                 TO W-INITIAL-COLUMN
 11424                                    W-LAST-COLUMN
 11425                                    W-START-COLUMN
 11426                                    W-TOO-FAR.
 11427
 11428     IF  W-LC-LINE-INDENT-1 NUMERIC
 11429             AND
 11430         W-LC-LINE-INDENT-1 LESS THAN W-LC-LINE-WIDTH
 11431         MOVE W-LC-LINE-INDENT-1 TO W-LINE-INDENT-1
 11432     ELSE
 11433         MOVE +0                 TO W-LINE-INDENT-1.
 11434
 11435     IF  W-LC-LINE-INDENT-2 NUMERIC
 11436             AND
 11437         W-LC-LINE-INDENT-2 LESS THAN W-LC-LINE-WIDTH
 11438         MOVE W-LC-LINE-INDENT-2 TO W-LINE-INDENT-2
 11439     ELSE
 11440         MOVE +0                 TO W-LINE-INDENT-2.
 11441
 11442     IF  W-LC-LINE-INDENT-3 NUMERIC
 11443             AND
 11444         W-LC-LINE-INDENT-3 LESS THAN W-LC-LINE-WIDTH
 11445         MOVE W-LC-LINE-INDENT-3 TO W-LINE-INDENT-3
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 233
* EL689.cbl
 11446     ELSE
 11447         MOVE +0                 TO W-LINE-INDENT-3.
 11448
 11449     IF  W-LC-LINE-INDENT-4 NUMERIC
 11450             AND
 11451         W-LC-LINE-INDENT-4 LESS THAN W-LC-LINE-WIDTH
 11452         MOVE W-LC-LINE-INDENT-4 TO W-LINE-INDENT-4
 11453     ELSE
 11454         MOVE +0                 TO W-LINE-INDENT-4.
 11455
 11456     IF  W-LC-LINE-INDENT-5 NUMERIC
 11457             AND
 11458         W-LC-LINE-INDENT-5 LESS THAN W-LC-LINE-WIDTH
 11459         MOVE W-LC-LINE-INDENT-5 TO W-LINE-INDENT-5
 11460
 11461     ELSE
 11462         MOVE +0                 TO W-LINE-INDENT-5.
 11463
 11464     IF  W-LC-TOP-MARGIN NUMERIC
 11465         MOVE W-LC-TOP-MARGIN    TO W-TOP-MARGIN
 11466     ELSE
 11467         MOVE +0                 TO W-TOP-MARGIN.
 11468
 11469     IF W-LC-CASE-IND = 'Y' OR 'N'
 11470         NEXT SENTENCE
 11471     ELSE
 11472         MOVE PI-LOWER-CASE-LETTERS
 11473                                 TO W-LC-CASE-IND.
 11474
 11475 2100-EXIT.
 11476     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 234
* EL689.cbl
 11478 2150-PROCESS-Z-CONTROLS.
 11479
 11480     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
 11481
 11482     IF PI-689-RESEND-DATE-1 = LOW-VALUES
 11483        IF W-DAYS-TO-RESEND NUMERIC
 11484           IF W-DAYS-TO-RESEND > ZEROS
 11485              MOVE '6'           TO DC-OPTION-CODE
 11486              MOVE W-SAVE-BIN-NEXT-BUS-DT
 11487                                 TO DC-BIN-DATE-1
 11488              MOVE ZEROS         TO DC-ELAPSED-MONTHS
 11489              MOVE W-DAYS-TO-RESEND
 11490                                 TO DC-ELAPSED-DAYS
 11491              PERFORM 9500-LINK-DATE-CONVERT
 11492                                 THRU 9500-EXIT
 11493              IF NO-CONVERSION-ERROR
 11494                 MOVE DC-BIN-DATE-2
 11495                                 TO PI-689-RESEND-DATE-1
 11496                 MOVE DC-GREG-DATE-1-EDIT
 11497                                 TO RESEND1O
 11498                                    PI-689-RESEND1-EDIT
 11499                 MOVE AL-UANON
 11500                                 TO RESEND1A
 11501                 MOVE +8         TO RESEND1L
 11502              ELSE
 11503                 MOVE ER-3770
 11504                                 TO EMI-ERROR
 11505                 MOVE -1         TO MAINTL
 11506                 PERFORM 9900-ERROR-FORMAT
 11507                                 THRU 9900-EXIT
 11508                 GO TO 8200-SEND-DATAONLY
 11509              END-IF
 11510           END-IF
 11511        END-IF
 11512     END-IF
 11513     IF W-FORM-TO-RESEND NOT = SPACES AND ZEROS
 11514        MOVE W-FORM-TO-RESEND    TO PI-689-RESEND-LETR-1
 11515     END-IF
 11516     IF  PI-689-FOLLOW-UP-DATE EQUAL LOW-VALUES
 11517         IF  W-DAYS-TO-FOLLOW-UP NUMERIC
 11518            IF  W-DAYS-TO-FOLLOW-UP >= ZEROS
 11519                 MOVE '6'        TO DC-OPTION-CODE
 11520                 MOVE W-SAVE-BIN-DATE
 11521                                 TO DC-BIN-DATE-1
 11522                 MOVE ZEROS      TO DC-ELAPSED-MONTHS
 11523                 MOVE W-DAYS-TO-FOLLOW-UP
 11524                                 TO DC-ELAPSED-DAYS
 11525                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 11526                 IF  NO-CONVERSION-ERROR
 11527                     MOVE DC-BIN-DATE-2
 11528                                 TO PI-689-FOLLOW-UP-DATE
 11529                     MOVE DC-GREG-DATE-1-EDIT
 11530                                 TO FOLLOWO
 11531                     MOVE AL-UANON
 11532                                 TO FOLLOWA
 11533                     MOVE +8     TO FOLLOWL
 11534                 ELSE
 11535                     MOVE ER-3771
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 235
* EL689.cbl
 11536                                 TO EMI-ERROR
 11537                     MOVE -1     TO MAINTL
 11538                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11539                     GO TO 8200-SEND-DATAONLY.
 11540
 11541     IF  COPIESI NOT NUMERIC
 11542             OR
 11543         COPIESI NOT GREATER THAN ZEROS
 11544         IF  W-NUMBER-OF-COPIES NUMERIC
 11545             IF  W-NUMBER-OF-COPIES GREATER THAN ZEROS
 11546                 MOVE W-NUMBER-OF-COPIES
 11547                                 TO COPIESI
 11548                                    PI-689-NUMBER-COPIES
 11549                 MOVE AL-UNNON   TO COPIESA
 11550                 MOVE +1         TO COPIESL
 11551             ELSE
 11552                 MOVE +1         TO COPIESI
 11553                                    PI-689-NUMBER-COPIES
 11554                 MOVE AL-UNNON   TO COPIESA
 11555                 MOVE +1         TO COPIESL
 11556         ELSE
 11557             MOVE +1             TO COPIESI
 11558                                    PI-689-NUMBER-COPIES
 11559             MOVE AL-UNNON       TO COPIESA
 11560             MOVE +1             TO COPIESL.
 11561
 11562     IF W-PROMPT-LETTER EQUAL 'Y'
 11563         MOVE 'Y'                TO PI-PROMPT-IND
 11564         MOVE ER-0894            TO EMI-ERROR
 11565         MOVE -1                 TO MAINTL
 11566         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11567     END-IF.
 11568
 11569     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
 11570                                           ENCO
 11571     MOVE AL-UANON                      TO ENCA
 11572     MOVE +3                            TO ENCL
 11573
 11574     IF W-PRINT-CERTIFICATE = 'Y'
 11575        MOVE 'Y' TO PI-CERT-REQ-IND
 11576        IF CERTIDL > ZEROS
 11577            IF CERTIDI NUMERIC
 11578              MOVE AL-UANON      TO CERTIDA
 11579              MOVE CERTIDI       TO PI-CERT-FORM-ID
 11580            ELSE
 11581              MOVE ER-1778       TO EMI-ERROR
 11582              MOVE -1            TO CERTIDL
 11583              MOVE AL-UABON      TO CERTIDA
 11584              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11585           END-IF
 11586        ELSE
 11587              MOVE ER-0715       TO EMI-ERROR
 11588              MOVE -1            TO CERTIDL
 11589              MOVE AL-UABON      TO CERTIDA
 11590              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11591        END-IF
 11592     END-IF.
 11593
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 236
* EL689.cbl
 11594     IF W-REASONS-REQUIRED = 'Y'
 11595        MOVE 'Y' TO PI-REASON-REQ-IND
 11596        IF PI-ENDT-ARCH-NO NOT > ZERO
 11597          MOVE ER-9840       TO EMI-ERROR
 11598          MOVE -1            TO FORML
 11599          MOVE AL-UABON      TO FORMA
 11600          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11601        END-IF
 11602     END-IF.
 11603
 11604*    IF  PI-689-PRINT-RESTRICTION NOT = 'C' AND 'F' AND 'P' AND
 11605*                                       SPACES
 11606*        IF  W-PRINT-RESTRICTED
 11607*            MOVE W-PRINT-RESTRICTED-IND
 11608*                                TO PRTRESTI
 11609*                                   PI-689-PRINT-RESTRICTION
 11610*            MOVE AL-UANON       TO PRTRESTA
 11611*            MOVE +1             TO PRTRESTL.
 11612     .
 11613 2150-EXIT.
 11614     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 237
* EL689.cbl
 11616 2200-CHECK-FOR-VARIABLE.
 11617
 11618     IF  W-TX-TEXT (W-TG-NDX) EQUAL SPACES
 11619         GO TO 2200-EXIT.
 11620
 11621     SET W-TX-NDX                TO +1.
 11622
 11623 2200-CONTINUE.
 11624
 11625     SEARCH W-TX-CHAR
 11626         VARYING
 11627             W-TX-NDX
 11628         AT END
 11629             GO TO 2200-EXIT
 11630         WHEN
 11631             W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11632             NEXT SENTENCE.
 11633
 11634     SET W-TX-NDX UP BY +1.
 11635
 11636     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11637         PERFORM 2220-BUILD-VARIABLE-NUMBER THRU 2220-EXIT
 11638         GO TO 2200-CONTINUE.
 11639
 11640 2200-EXIT.
 11641     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 238
* EL689.cbl
 11643 2220-BUILD-VARIABLE-NUMBER.
 11644
 11645     SET W-TX-NDX UP BY +1.
 11646     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V1.
 11647     SET W-TX-NDX UP BY +1.
 11648     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V2.
 11649     SET W-TX-NDX UP BY +1.
 11650     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V3.
 11651
 11652     IF  W-VAR-RELATIVE-NUM NUMERIC
 11653         SET W-FILE-NDX TO W-VARIABLE-SOURCE (W-VAR-RELATIVE-NUM)
 11654         MOVE 'Y' TO W-FILE-USE-IND (W-FILE-NDX).
 11655
 11656 2220-EXIT.
 11657     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 239
* EL689.cbl
 11659 4000-ROLL-PAGE.
 11660
 11661     IF  ENTERPFL NOT EQUAL ZEROS
 11662         MOVE -1                 TO ENTERPFL
 11663     ELSE
 11664         MOVE -1                 TO MAINTL.
 11665
 11666     IF  PI-TOTAL-LINES EQUAL 0
 11667         MOVE ER-0047            TO EMI-ERROR
 11668         MOVE -1                 TO MAINTL
 11669         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11670         GO TO 8200-SEND-DATAONLY.
 11671
 11672     COMPUTE W-TEMP-CURRENT-LINE EQUAL
 11673         PI-CURRENT-LINE + W-ROLL-COUNTER.
 11674
 11675     IF  W-TEMP-CURRENT-LINE NEGATIVE
 11676             OR
 11677         W-TEMP-CURRENT-LINE EQUAL ZEROS
 11678         MOVE ER-0067            TO EMI-ERROR
 11679         MOVE -1                 TO MAINTL
 11680         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11681         MOVE 1                  TO W-TEMP-CURRENT-LINE.
 11682
 11683*    IF  W-TEMP-CURRENT-LINE GREATER THAN PI-TOTAL-LINES
 11684*            AND
 11685*        (EIBAID EQUAL DFHPF1 OR DFHPF6)
 11686*        MOVE ER-0066            TO EMI-ERROR
 11687*        MOVE -1                 TO MAINTL
 11688*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11689*        COMPUTE W-TEMP-CURRENT-LINE
 11690*            = PI-TOTAL-LINES + 1 - W-NUM-LINES-PER-SCREEN
 11691*        IF  W-TEMP-CURRENT-LINE NEGATIVE
 11692*                OR
 11693*            W-TEMP-CURRENT-LINE = ZEROS
 11694*            MOVE 1 TO W-TEMP-CURRENT-LINE.
 11695
 11696     IF  EMI-ERROR NOT EQUAL ER-0191
 11697             AND
 11698         MAINTI NOT EQUAL 'S'
 11699         PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
 11700         PERFORM 4100-SET-NDX THRU 4100-EXIT
 11701         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11702                 VARYING
 11703             W-SC-NDX FROM 1 BY 1
 11704                 UNTIL
 11705             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11706
 11707     IF  EMI-ERROR EQUAL ER-0066 OR ER-0067 OR ER-0000 OR
 11708                         ER-0191
 11709         NEXT SENTENCE
 11710     ELSE
 11711         GO TO 8200-SEND-DATAONLY.
 11712
 11713     MOVE W-TEMP-CURRENT-LINE    TO PI-CURRENT-LINE
 11714     SET W-RG-NDX                TO PI-CURRENT-LINE
 11715     MOVE LOW-VALUES             TO EL689RI
 11716*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 240
* EL689.cbl
 11717     PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
 11718     SET W-RG-NDX                TO PI-CURRENT-LINE
 11719     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11720             VARYING
 11721         W-SC-NDX FROM 1 BY 1
 11722             UNTIL
 11723         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11724
 11725     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 241
* EL689.cbl
 11727 4100-SET-NDX.
 11728
 11729     IF  PI-CURRENT-LINE EQUAL 0
 11730         SET W-RG-NDX            TO 1
 11731     ELSE
 11732         SET W-RG-NDX            TO PI-CURRENT-LINE.
 11733
 11734 4100-EXIT.
 11735      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 242
* EL689.cbl
 11737 4200-UPDATE-TABLE-FROM-SCREEN.
 11738
 11739     IF  W-SC-TEXTL (W-SC-NDX) NOT EQUAL ZEROS
 11740         MOVE ZEROS              TO W-SC-TEXTL (W-SC-NDX)
 11741         IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11742             IF  PI-TOTAL-LINES EQUAL W-MAX-LINES
 11743                 MOVE ER-0051    TO EMI-ERROR
 11744                 MOVE -1         TO MAINTL
 11745                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11746                 GO TO 8200-SEND-DATAONLY
 11747             ELSE
 11748                 MOVE W-SC-TEXT (W-SC-NDX)
 11749                                 TO W-RC-TEXT (W-RG-NDX)
 11750                 ADD 1           TO PI-TOTAL-LINES
 11751         ELSE
 11752             MOVE W-SC-TEXT (W-SC-NDX)
 11753                                 TO W-RC-TEXT (W-RG-NDX).
 11754
 11755     SET W-RG-NDX UP BY 1.
 11756
 11757 4200-EXIT.
 11758      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 243
* EL689.cbl
 11760
 11761
 11762 4500-CONNECT-TO-DB.
 11763
 11764     MOVE 'NTCSO2_LOGIC'         TO SVR
 11765     MOVE 'sa'                   TO USR
 11766     MOVE 'ntcso2'               TO PASS
 11767
 11768     STRING
 11769         USR DELIMITED SPACE
 11770         "." DELIMITED SIZE
 11771         PASS DELIMITED SPACE INTO USR-PASS
 11772     END-STRING
 11773
 11774     EXEC SQL
 11775        CONNECT TO :SVR USER :USR-PASS
 11776     END-EXEC
 11777
 11778     IF SQLCODE NOT = 0
 11779        DISPLAY "ERROR: CANNOT CONNECT "
 11780        DISPLAY SQLCODE
 11781        DISPLAY SQLERRMC
 11782        GO TO 4500-EXIT
 11783     END-IF
 11784
 11785     .
 11786 4500-EXIT.
 11787     EXIT.
 11788
 11789
 11790
 11791 4600-GET-NEXT-BUS-DT.
 11792
 11793     MOVE W-SAVE-EDIT-A-DATE     TO WS-CYCLE-DATE
 11794     MOVE SPACES                 TO WS-NEXT-BUS-DT
 11795
 11796     IF WS-KIXHOST = 'logictest'
 11797        EXEC SQL
 11798          CALL NaperTestCalcNextBusDt
 11799                        @cycledate = :WS-CYCLE-DATE,
 11800                        @nextbusdate = :WS-NEXT-BUS-DT OUT
 11801        END-EXEC
 11802     ELSE
 11803        EXEC SQL
 11804          CALL NaperProdCalcNextBusDt
 11805                        @cycledate = :WS-CYCLE-DATE,
 11806                        @nextbusdate = :WS-NEXT-BUS-DT OUT
 11807        END-EXEC
 11808     END-IF
 11809
 11810     IF SQLCODE NOT = 0
 11811        DISPLAY "ERROR: DID NOT RETURN NEXT BUS DT "
 11812        DISPLAY ' SQL RETURN CODE ' SQLCODE
 11813        DISPLAY ' SQL ERR MESS    ' SQLERRMC
 11814        GO TO 4600-EXIT
 11815     END-IF
 11816
 11817     .
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 244
* EL689.cbl
 11818 4600-EXIT.
 11819     EXIT.
 11820
 11821
 11822
 11823 4700-DISCONNECT.
 11824
 11825     EXEC SQL
 11826        DISCONNECT
 11827     END-EXEC
 11828     .
 11829 4700-EXIT.
 11830     EXIT.
 11831
 11832 5000-EDIT-MODE.
 11833***************************************************************
 11834*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
 11835*    AND THE W-TS-TABLE OF LETTER TEXT.  IT WILL THEN         *
 11836*    TRANSFER TO THE W-TEXT-EDITOR PROGRAM.                   *
 11837***************************************************************
 11838
 11839     IF  PI-SHOW-MODE
 11840         MOVE ER-0188            TO EMI-ERROR
 11841         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11842         MOVE -1                 TO MAINTL
 11843         MOVE AL-UABON           TO MAINTA
 11844         GO TO 8200-SEND-DATAONLY.
 11845
 11846     IF  PI-CURRENT-LINE EQUAL ZEROS
 11847         MOVE ER-0187            TO EMI-ERROR
 11848         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11849         MOVE -1                 TO MAINTL
 11850         GO TO 8200-SEND-DATAONLY.
 11851
 11852     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11853     PERFORM 4100-SET-NDX THRU 4100-EXIT.
 11854     PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11855             VARYING
 11856         W-SC-NDX FROM 1 BY 1
 11857             UNTIL
 11858         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11859
 11860     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 11861
 11862     MOVE PI-689-FORM-NUMBER     TO PI-COMM-CONTROL.
 11863     MOVE ZEROS                  TO PI-UPDATE-SW.
 11864     MOVE '1'                    TO PI-ENTRY-CD-1.
 11865     MOVE W-PGM-EL1042           TO W-CALL-PGM.
 11866     GO TO 9400-XCTL.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 245
* EL689.cbl
 11868 5400-LETTER-RELEASE.
 11869***************************************************************
 11870*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
 11871*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS IN       *
 11872*    THE ARCHIVE FILE.                                        *
 11873*    THE FUNCTIONS BELOW WILL BE PERFORMED.                   *
 11874*        1. CHECK SECURITY.                                   *
 11875*        2. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS.        *
 11876*        3. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
 11877*        4. WRITE THE NEW ARCHIVE RECORDS FROM W-TS-TABLE.    *
 11878*        5. RESET INSURED'S CONTROL FIELDS AND RETURN THE     *
 11879*           ARCHIVE NUMBER USED  TO FILE THE RECORDS.         *
 11880***************************************************************
 11881
 11882     IF  NOT MODIFY-CAP
 11883         MOVE ER-0070            TO EMI-ERROR
 11884         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11885         MOVE -1                 TO MAINTL
 11886         GO TO 8200-SEND-DATAONLY.
 11887
 11888     IF  PI-SHOW-MODE
 11889         MOVE ER-0188            TO EMI-ERROR
 11890         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11891         MOVE -1                 TO MAINTL
 11892         MOVE AL-UABON           TO MAINTA
 11893         GO TO 8200-SEND-DATAONLY.
 11894
 11895      IF  ARCHNUML GREATER THAN ZEROS
 11896          MOVE ER-9320            TO EMI-ERROR
 11897          MOVE -1                 TO ARCHNUML
 11898          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11899          GO TO 8200-SEND-DATAONLY.
 11900
 11901*     IF  PI-CURRENT-LINE EQUAL ZEROS
 11902*        MOVE ER-0187            TO EMI-ERROR
 11903*        MOVE -1                 TO MAINTL
 11904*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11905*        GO TO 8200-SEND-DATAONLY.
 11906
 11907*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11908*
 11909*    IF  NOT PI-689-CREATE-NO-SCREENS
 11910*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 11911*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11912*                VARYING
 11913*            W-SC-NDX FROM 1 BY 1
 11914*                UNTIL
 11915*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 11916*        IF  EMI-FATAL-CTR GREATER THAN ZEROS
 11917*                OR
 11918*            PI-689-FATAL-ERROR
 11919*            GO TO 8200-SEND-DATAONLY.
 11920*
 11921*    MOVE SPACES                 TO W-REMAINING-VAR-SW.
 11922*    PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 11923*            VARYING
 11924*        W-RVS-NDX FROM +1 BY +1
 11925*            UNTIL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 246
* EL689.cbl
 11926*        W-RVS-NDX > +36500
 11927*            OR
 11928*        W-REMAINING-VAR-FOUND.
 11929*
 11930*    IF  NOT PI-689-CREATE-NO-SCREENS
 11931*        IF  W-REMAINING-VAR-FOUND
 11932*            GO TO 4000-ROLL-PAGE.
 11933
 11934*    MOVE SPACES                 TO W-CNTL-KEY.
 11935*    MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11936*    MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 11937*    MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 11938*
 11939*    EXEC CICS HANDLE CONDITION
 11940*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11941*         NOTFND     (5470-CNTL-NOT-FOUND)
 11942*    END-EXEC.
 11943*
 11944*    EXEC CICS READ
 11945*         DATASET    (W-CNTL-FILE-ID)
 11946*         SET        (ADDRESS OF CONTROL-FILE)
 11947*         RIDFLD     (W-CNTL-KEY)
 11948*         UPDATE
 11949*    END-EXEC.
 11950*
 11951*    IF  CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
 11952*        MOVE ZEROS              TO CF-CREDIT-LAST-ARCH-NUM
 11953*                                   CF-CREDIT-START-ARCH-NUM.
 11954*
 11955*    ADD 1                       TO CF-CREDIT-LAST-ARCH-NUM.
 11956*    MOVE CF-CREDIT-LAST-ARCH-NUM
 11957*                                TO W-ARCH-NUMBER
 11958*                                   W-ARCT-NUMBER.
 11959*
 11960*    EXEC CICS REWRITE
 11961*         FROM      (CONTROL-FILE)
 11962*         DATASET   (W-CNTL-FILE-ID)
 11963*    END-EXEC
 11964
 11965*    EXEC CICS HANDLE CONDITION
 11966*         NOTOPEN   (8010-ARCH-NOT-OPEN)
 11967*    END-EXEC.
 11968*
 11969*    EXEC CICS GETMAIN
 11970*       SET      (ADDRESS OF LETTER-ARCHIVE)
 11971*       LENGTH   (W-ARCH-LENGTH)
 11972*    END-EXEC
 11973*
 11974*    MOVE SPACES                 TO LETTER-ARCHIVE
 11975*    MOVE 'LA'                   TO LA-RECORD-ID.
 11976*    MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
 11977*                                   LA-ARCHIVE-NO-A2
 11978*                                   LA-ARCHIVE-NO-A3
 11979*                                   LA-ARCHIVE-NO-A4
 11980*                                   LA-ARCHIVE-NO-A5
 11981*                                   LA-ARCHIVE-NO-A6
 11982*                                   PI-689-ARCHIVE-NUMBER.
 11983*    MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 247
* EL689.cbl
 11984*                                   LA-COMPANY-CD-A2
 11985*                                   LA-COMPANY-CD-A3
 11986*                                   LA-COMPANY-CD-A4
 11987*                                   LA-COMPANY-CD-A5
 11988*                                   LA-COMPANY-CD-A6.
 11989*    MOVE PI-689-CARRIER         TO LA-CARRIER-A2
 11990*                                   LA-CARRIER-A3
 11991*                                   LA-CARRIER-A4
 11992*                                   LA-CARRIER-A5.
 11993*    MOVE PI-689-EFF-DATE        TO LA-EFFECT-DATE-A2.
 11994*    MOVE PI-689-GROUPING        TO LA-GROUPING-A2
 11995*                                   LA-GROUPING-A3
 11996*                                   LA-GROUPING-A4
 11997*                                   LA-GROUPING-A5.
 11998*    MOVE PI-689-ACCOUNT         TO LA-ACCOUNT-A2
 11999*                                   LA-ACCOUNT-A3
 12000*                                   LA-ACCOUNT-A4
 12001*                                   LA-ACCOUNT-A5.
 12002*    MOVE PI-689-STATE           TO LA-STATE-A2
 12003*                                   LA-STATE-A3
 12004*                                   LA-STATE-A4
 12005*                                   LA-STATE-A5.
 12006*
 12007*    IF  PI-689-DATA-SOURCE EQUAL '3'
 12008*            AND
 12009*        PI-689-RESP-PERSON GREATER THAN SPACES
 12010*        MOVE PI-689-RESP-PERSON
 12011*                                TO LA-RESP-PERSON-A2
 12012*        MOVE PI-689-TYPE        TO LA-TYPE-A2
 12013*    ELSE
 12014*        IF  PI-689-CERT-PRIME GREATER THAN SPACES
 12015*            MOVE PI-689-CERT-PRIME
 12016*                                TO LA-CERT-PRIME-A2
 12017*            MOVE PI-689-CERT-SFX
 12018*                                TO LA-CERT-SUFFIX-A2
 12019*        ELSE
 12020*            MOVE LOW-VALUE      TO LA-RESP-PERSON-A2
 12021*                                   LA-TYPE-A2.
 12022*
 12023*    IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 12024*        MOVE PI-689-ENTRY-BATCH TO LA-ENTRY-A6
 12025*        IF  PI-689-CONTROL GREATER THAN ZEROS
 12026*                AND
 12027*            PI-689-PRINT-RESTRICTION EQUAL 'C'
 12028*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 12029*            MOVE 'CK'           TO LA-FILLER
 12030*        ELSE
 12031*            NEXT SENTENCE
 12032*    ELSE
 12033*        IF  PI-689-CONTROL GREATER THAN ZEROS
 12034*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 12035*            MOVE 'CK'           TO LA-FILLER
 12036*        ELSE
 12037*            MOVE LOW-VALUES     TO LA-ENTRY-A6.
 12038*
 12039*    MOVE ZEROS                  TO W-SEQ-CTR.
 12040*
 12041*    MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 248
* EL689.cbl
 12042*
 12043*    MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
 12044*                                   LA-INITIAL-PRINT-DATE
 12045*                                   LA-SENT-DATE
 12046*                                   LA-REPLY-DATE.
 12047*    MOVE 'A'                    TO LA-STATUS.
 12048*
 12049*    IF  PI-689-NUMBER-COPIES NOT NUMERIC
 12050*            OR
 12051*        PI-689-NUMBER-COPIES EQUAL ZEROS
 12052*        MOVE  1                 TO LA-NO-OF-COPIES
 12053*    ELSE
 12054*        MOVE PI-689-NUMBER-COPIES
 12055*                                TO LA-NO-OF-COPIES.
 12056*
 12057*    MOVE PI-689-FORM-NUMBER     TO LA-FORM-A3.
 12058*    MOVE PI-689-FOLLOW-UP-DATE  TO LA-FOLLOW-UP-DATE.
 12059*    MOVE PI-689-PRINT-RESTRICTION
 12060*                                TO LA-PRINT-RESTRICTION
 12061*    MOVE PI-689-LABEL-SOURCE    TO LA-ADDR-SOURCE.
 12062*    MOVE PI-689-DATA-SOURCE     TO LA-DATA-SOURCE.
 12063*    MOVE PI-689-RESEND-DATE-1   TO LA-RESEND-DATE
 12064*    MOVE PI-689-RESEND-LETR-1   TO LA-RESEND-LETR
 12065*    MOVE W-CURRENT-SAVE         TO LA-CREATION-DATE.
 12066*
 12067*    IF  PI-689-PRINT-PERFORMED
 12068*        MOVE SPACES             TO PI-689-PRINT-SW
 12069*        MOVE W-CURRENT-SAVE     TO LA-INITIAL-PRINT-DATE
 12070*        IF  LA-RESEND-DATE = LOW-VALUES
 12071*            MOVE 'C'            TO LA-STATUS.
 12072*
 12073*    MOVE PI-689-NUMBER-LABEL-LINES
 12074*                                TO LA-NUMBER-LABEL-LINES.
 12075*    MOVE ZEROS                  TO PI-689-NUMBER-TEXT-RECORDS.
 12076*
 12077*    PERFORM 5410-CREATE-TEXT-RECORDS THRU 5410-EXIT.
 12078*
 12079*    MOVE PI-689-NUMBER-TEXT-RECORDS
 12080*    MOVE ZEROS                  TO LA-NO-OF-TEXT-RECORDS.
 12081*
 12082*    EXEC CICS HANDLE CONDITION
 12083*        DUPREC    (5460-DUPLICATE-ARCHIVE-RCD)
 12084*    END-EXEC.
 12085*
 12086*    PERFORM 5650-WRITE-ARCHIVE THRU 5650-EXIT.
 12087*    MOVE ER-0280                TO EMI-ERROR.
 12088*    MOVE -1                     TO MAINTL.
 12089*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12090*    MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 12091*    MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1).
 12092     .
 12093 5400-END.
 12094     DISPLAY ' MADE IT TO 5400 '
 12095     MOVE SPACES                 TO BL-INPUT
 12096     MOVE ZEROS                  TO BL-ARCHIVE-NO
 12097     MOVE PI-689-DATA-SOURCE     TO BL-DATA-SRCE
 12098     MOVE PI-689-CARRIER         TO BL-CARRIER
 12099     MOVE PI-689-GROUPING        TO BL-GROUP
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 249
* EL689.cbl
 12100     MOVE PI-689-STATE           TO BL-STATE
 12101     MOVE PI-689-ACCOUNT         TO BL-ACCOUNT
 12102     IF PI-689-EFF-DATE NOT = LOW-VALUES
 12103        MOVE PI-689-EFF-DATE     TO DC-BIN-DATE-1
 12104        MOVE ' '                 TO DC-OPTION-CODE
 12105        PERFORM 9500-LINK-DATE-CONVERT
 12106                                 THRU 9500-EXIT
 12107        IF NO-CONVERSION-ERROR
 12108           MOVE DC-GREG-DATE-1-EDIT
 12109                                 TO BL-EFF-DT
 12110        END-IF
 12111     END-IF
 12112     MOVE PI-689-CERT-NO         TO BL-CERT-NO
 12113     MOVE PI-689-ENTRY-BATCH     TO BL-BATCH-NO
 12114     MOVE PI-689-SEQ-NO          TO BL-BATCH-SEQ
 12115     MOVE PI-689-RESP-PERSON     TO BL-RESP-NO
 12116     MOVE PI-689-FORM-NUMBER     TO BL-LETTER-ID
 12117     MOVE PI-689-NUMBER-COPIES   TO BL-NO-OF-COPIES
 12118     IF PI-ENDT-ARCH-NO > ZERO
 12119         MOVE PI-ENDT-ARCH-NO    TO BL-ENDT-ARCH-NO
 12120     END-IF
 12121     MOVE 'LETTER  '             TO BL-SOURCE-SCREEN
 12122     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
 12123*    MOVE 'ALWA'                 TO BL-PROC-ID
 12124     MOVE PI-COMPANY-ID          TO BL-COMP-ID
 12125*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
 12126     MOVE PI-ENCLOSURE-CD        TO BL-ENC-CD
 12127     IF PI-689-RESEND-DATE-1 NOT = LOW-VALUES
 12128        MOVE PI-689-RESEND-DATE-1 TO DC-BIN-DATE-1
 12129        MOVE ' '                 TO DC-OPTION-CODE
 12130        PERFORM 9500-LINK-DATE-CONVERT
 12131                                 THRU 9500-EXIT
 12132        IF NO-CONVERSION-ERROR
 12133           MOVE DC-GREG-DATE-B-EDIT
 12134                                 TO BL-RESEND-DT
 12135        END-IF
 12136     END-IF
 12137     IF PI-689-FOLLOW-UP-DATE NOT = LOW-VALUES
 12138        MOVE PI-689-FOLLOW-UP-DATE TO DC-BIN-DATE-1
 12139        MOVE ' '                 TO DC-OPTION-CODE
 12140        PERFORM 9500-LINK-DATE-CONVERT
 12141                                 THRU 9500-EXIT
 12142        IF NO-CONVERSION-ERROR
 12143           MOVE DC-GREG-DATE-B-EDIT
 12144                                 TO BL-FOLLOW-UP-DT
 12145        END-IF
 12146     END-IF
 12147*    MOVE IFF-COMMENTS           TO BL-COMMENTS
 12148*    MOVE 'TEST COMMENTS'        TO BL-COMMENTS
 12149     MOVE PI-CERT-FORM-ID        TO BL-CERT-FORM-ID
 12150     if eibaid = dfhpf7
 12151        move 'B'                 TO BL-WRITE-ERARCH
 12152     else
 12153        move 'T'                 to bl-write-erarch
 12154     end-if
 12155    DISPLAY ' ABOUT TO LINK TO NSRASBL '
 12156*****************************************
 12157* Invoke the LETTER business logic
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 250
* EL689.cbl
 12158*****************************************
 12159
 12160* exec cics link
 12161*       program('NSRASBL')
 12162*       commarea(srch-commarea)
 12163*    end-exec.
 12164     MOVE LENGTH OF
 12165      srch-commarea
 12166       TO DFHEIV11
 12167     MOVE 'NSRASBL' TO DFHEIV1
 12168*    MOVE '."C                   (   #00011741' TO DFHEIV0
 12169     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12170     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12171     MOVE X'2020233030303131373431' TO DFHEIV0(25:11)
 12172     CALL 'kxdfhei1' USING DFHEIV0,
 12173           DFHEIV1,
 12174           srch-commarea,
 12175           DFHEIV11,
 12176           DFHEIV99,
 12177           DFHEIV99,
 12178           DFHEIV99,
 12179           DFHEIV99
 12180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12181
 12182     DISPLAY ' MADE IT BACK FROM NSRASBL ' bl-status ' '
 12183        bl-message ' ' bl-archive-no
 12184     move bl-archive-no to w-arch-number
 12185
 12186     if eibaid = dfhpf7
 12187        PERFORM 5440-ADD-BILLING-NOTE THRU 5440-EXIT
 12188        MOVE ER-0280                TO EMI-ERROR
 12189        MOVE -1                     TO MAINTL
 12190        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12191        MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 12192        MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1)
 12193        MOVE '2'                    TO PI-ACTION
 12194        MOVE ZEROS                  TO PI-TOTAL-LINES
 12195                                       PI-CURRENT-LINE
 12196        MOVE SPACES                 TO PI-689-PRINT-SW
 12197                                       PI-689-FORM-NUMBER
 12198        GO TO 9300-DFHCLEAR
 12199     else
 12200        move w-arch-number          to archnumo
 12201        MOVE ER-1818                TO EMI-ERROR
 12202        MOVE -1                     TO MAINTL
 12203        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12204     end-if
 12205     MOVE -1                     TO MAINTL
 12206     GO TO 8200-SEND-DATAONLY
 12207     .
 12208 5400-EXIT.
 12209     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 251
* EL689.cbl
 12211 5410-CREATE-TEXT-RECORDS.
 12212
 12213*    EXEC CICS HANDLE CONDITION
 12214*         NOTOPEN   (8015-ARCT-NOT-OPEN)
 12215*         DUPREC    (5465-DUPLICATE-ARCH-TEXT)
 12216*    END-EXEC.
 12217*
 12218*    IF  PI-689-CREATE-NO-SCREENS
 12219*        IF  PI-689-GET-ARCT-MAIN
 12220*            EXEC CICS GETMAIN
 12221*                 SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 12222*                 LENGTH   (W-ARCT-LENGTH)
 12223*            END-EXEC
 12224*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF
 12225*                                    LETTER-ARCHIVE-TEXT
 12226*            MOVE LCP-WS-ADDR-COMP
 12227*                                TO PI-689-ARCT-POINTER
 12228*        ELSE
 12229*            MOVE PI-689-ARCT-POINTER
 12230*                                TO LCP-WS-ADDR-COMP
 12231*            SET ADDRESS OF LETTER-ARCHIVE-TEXT
 12232*                                TO LCP-WS-ADDR-PNTR
 12233*    ELSE
 12234*        EXEC CICS GETMAIN
 12235*             SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 12236*             LENGTH   (W-ARCT-LENGTH)
 12237*        END-EXEC.
 12238*
 12239*    PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 12240*
 12241*    MOVE ZEROS                  TO W-SEQ-CTR
 12242*
 12243*    IF  PI-CREATE-LABELS AND
 12244*        NOT PI-689-LABELS-OVERRIDEN
 12245*        MOVE '1'                TO LT-RECORD-TYPE
 12246*        MOVE +0                 TO LT-LINE-SEQ-NO
 12247*        PERFORM 5600-FORMAT-ADDRESS-LINE THRU 5600-EXIT
 12248*                VARYING
 12249*            W-RG-NDX FROM 1 BY 1
 12250*                UNTIL
 12251*            W-RG-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 12252*        PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12253*        PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT
 12254*    ELSE
 12255*        SET W-RG-NDX            TO +1.
 12256*
 12257*    SET LT-NDX                  TO W-ZEROS.
 12258*
 12259*    PERFORM 5500-FORMAT-TEXT THRU 5500-EXIT
 12260*            VARYING
 12261*        W-RG-NDX FROM W-RG-NDX BY +1
 12262*            UNTIL
 12263*        W-RG-NDX GREATER THAN PI-TOTAL-LINES.
 12264
 12265 5410-EXIT.
 12266     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 252
* EL689.cbl
 12268 5415-INITIALIZE-TEXT.
 12269
 12270     MOVE SPACES                 TO LETTER-ARCHIVE-TEXT.
 12271     MOVE 'LT'                   TO LT-RECORD-ID.
 12272
 12273     MOVE LA-ARCHIVE-NO          TO LT-ARCHIVE-NO.
 12274     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
 12275
 12276     MOVE ZEROS                  TO LT-LINE-SEQ-NO
 12277                                    LT-NUM-LINES-ON-RECORD.
 12278
 12279 5415-EXIT.
 12280     EXIT.
 12281
 12282 5440-ADD-BILLING-NOTE.
 12283
 12284     MOVE LOW-VALUES             TO W-ELEOBC-KEY
 12285     MOVE PI-COMPANY-CD          TO W-EOBC-COMPANY-CD
 12286     MOVE '5'                    TO W-EOBC-REC-TYPE
 12287
 12288
 12289* EXEC CICS STARTBR
 12290*        DATASET   ('ELEOBC')
 12291*        RIDFLD    (W-ELEOBC-KEY)
 12292*        GTEQ
 12293*        RESP      (W-RESPONSE)
 12294*    END-EXEC
 12295     MOVE 'ELEOBC' TO DFHEIV1
 12296     MOVE 0
 12297       TO DFHEIV11
 12298*    MOVE '&,         G          &  N#00011851' TO DFHEIV0
 12299     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12300     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12301     MOVE X'204E233030303131383531' TO DFHEIV0(25:11)
 12302     CALL 'kxdfhei1' USING DFHEIV0,
 12303           DFHEIV1,
 12304           W-ELEOBC-KEY,
 12305           DFHEIV99,
 12306           DFHEIV11,
 12307           DFHEIV99
 12308     MOVE EIBRESP  TO W-RESPONSE
 12309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12310
 12311     IF NOT RESP-NORMAL
 12312        GO TO 5440-EXIT
 12313     END-IF
 12314      .
 12315 5440-READNEXT-ELEOBC.
 12316
 12317
 12318* EXEC CICS READNEXT
 12319*       INTO    (EOB-CODES)
 12320*       DATASET ('ELEOBC')
 12321*       RIDFLD  (W-ELEOBC-KEY)
 12322*       RESP    (W-RESPONSE)
 12323*    END-EXEC
 12324     MOVE LENGTH OF
 12325      EOB-CODES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 253
* EL689.cbl
 12326       TO DFHEIV12
 12327     MOVE 'ELEOBC' TO DFHEIV1
 12328     MOVE 0
 12329       TO DFHEIV11
 12330*    MOVE '&.IL                  )  N#00011864' TO DFHEIV0
 12331     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12332     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12333     MOVE X'204E233030303131383634' TO DFHEIV0(25:11)
 12334     CALL 'kxdfhei1' USING DFHEIV0,
 12335           DFHEIV1,
 12336           EOB-CODES,
 12337           DFHEIV12,
 12338           W-ELEOBC-KEY,
 12339           DFHEIV99,
 12340           DFHEIV11,
 12341           DFHEIV99,
 12342           DFHEIV99
 12343     MOVE EIBRESP  TO W-RESPONSE
 12344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12345
 12346     IF RESP-NORMAL
 12347         IF EO-RECORD-TYPE NOT = '5'
 12348             GO TO 5440-EXIT
 12349         END-IF
 12350     ELSE
 12351         GO TO 5440-EXIT
 12352     END-IF
 12353
 12354     IF EO-RECORD-TYPE = '5' AND
 12355        EO-EOB-CODE = PI-689-FORM-NUMBER
 12356           CONTINUE
 12357     ELSE
 12358         GO TO 5440-READNEXT-ELEOBC
 12359     END-IF
 12360
 12361     MOVE SPACES TO W-BILLING-NOTE
 12362     MOVE EO-DESCRIPTION TO W-BN-NOTE
 12363     MOVE PI-689-FORM-NUMBER TO W-BN-LTRID
 12364     MOVE W-SAVE-DATE TO W-BN-DATE
 12365     MOVE PI-PROCESSOR-ID TO W-BN-USERID
 12366     MOVE +25 TO W-LEN
 12367
 12368     PERFORM 5441-UPDATE-BILLING-NOTE THRU 5441-EXIT
 12369     .
 12370 5440-EXIT.
 12371     EXIT.
 12372
 12373 5441-UPDATE-BILLING-NOTE.
 12374
 12375     MOVE PI-COMPANY-CD          TO W-SV-COMPANY-CD
 12376     MOVE PI-689-CARRIER         TO W-SV-CARRIER
 12377     MOVE PI-689-GROUPING        TO W-SV-GROUPING
 12378     MOVE PI-689-STATE           TO W-SV-STATE
 12379     MOVE PI-689-ACCOUNT         TO W-SV-ACCOUNT
 12380     MOVE PI-689-EFF-DATE        TO W-SV-CERT-EFF-DT
 12381     MOVE PI-689-CERT-PRIME      TO W-SV-CERT-PRIME
 12382     MOVE PI-689-CERT-SFX        TO W-SV-CERT-SFX
 12383     MOVE W-SAVE-KEY             TO W-ERNOTE-KEY
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 254
* EL689.cbl
 12384
 12385
 12386* EXEC CICS READ
 12387*       DATASET    (W-NOTE-FILE-ID)
 12388*       RIDFLD     (W-ERNOTE-KEY)
 12389*       INTO       (CERTIFICATE-NOTE)
 12390*       RESP       (W-RESPONSE)
 12391*       UPDATE
 12392*    END-EXEC
 12393     MOVE LENGTH OF
 12394      CERTIFICATE-NOTE
 12395       TO DFHEIV11
 12396*    MOVE '&"IL       EU         (  N#00011910' TO DFHEIV0
 12397     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12398     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12399     MOVE X'204E233030303131393130' TO DFHEIV0(25:11)
 12400     CALL 'kxdfhei1' USING DFHEIV0,
 12401           W-NOTE-FILE-ID,
 12402           CERTIFICATE-NOTE,
 12403           DFHEIV11,
 12404           W-ERNOTE-KEY,
 12405           DFHEIV99,
 12406           DFHEIV99,
 12407           DFHEIV99
 12408     MOVE EIBRESP  TO W-RESPONSE
 12409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12410
 12411     IF RESP-NORMAL
 12412       IF CN-BILLING-START-LINE-NO NOT NUMERIC
 12413          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 12414       END-IF
 12415       IF CN-BILLING-END-LINE-NO NOT NUMERIC
 12416          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 12417       END-IF
 12418       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
 12419           (NOTE-SUB > +10) OR
 12420           (CN-LINE (NOTE-SUB) (1:W-LEN) =
 12421                             W-BILLING-NOTE (1:W-LEN))
 12422       END-PERFORM
 12423       IF CN-LINE (NOTE-SUB) (1:W-LEN) =
 12424                              W-BILLING-NOTE (1:W-LEN)
 12425
 12426* EXEC CICS UNLOCK
 12427*           DATASET    (W-NOTE-FILE-ID)
 12428*        END-EXEC
 12429*    MOVE '&*                    #   #00011932' TO DFHEIV0
 12430     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12431     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12432     MOVE X'2020233030303131393332' TO DFHEIV0(25:11)
 12433     CALL 'kxdfhei1' USING DFHEIV0,
 12434           W-NOTE-FILE-ID,
 12435           DFHEIV99
 12436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12437       ELSE
 12438         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
 12439           (NOTE-SUB > +10) OR
 12440           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
 12441         END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 255
* EL689.cbl
 12442         IF (NOTE-SUB < +11)
 12443           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
 12444              NOTE-SUB <= CN-BILLING-END-LINE-NO
 12445                MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB)
 12446           ELSE
 12447             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 12448              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
 12449                MOVE W-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
 12450                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
 12451             ELSE
 12452               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 12453                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
 12454                     MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB)
 12455                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
 12456               ELSE
 12457                 IF (CN-BILLING-END-LINE-NO = ZEROS)
 12458                   MOVE W-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
 12459                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
 12460                                       CN-BILLING-START-LINE-NO
 12461                 ELSE
 12462                    PERFORM 5442-SQUEEZE-IT-IN THRU 5442-EXIT
 12463                 END-IF
 12464               END-IF
 12465             END-IF
 12466           END-IF
 12467           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
 12468           MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
 12469           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12470
 12471* EXEC CICS REWRITE
 12472*             DATASET    (W-NOTE-FILE-ID)
 12473*             FROM       (CERTIFICATE-NOTE)
 12474*             RESP       (W-RESPONSE)
 12475*          END-EXEC
 12476     MOVE LENGTH OF
 12477      CERTIFICATE-NOTE
 12478       TO DFHEIV11
 12479*    MOVE '&& L                  %  N#00011968' TO DFHEIV0
 12480     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12481     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12482     MOVE X'204E233030303131393638' TO DFHEIV0(25:11)
 12483     CALL 'kxdfhei1' USING DFHEIV0,
 12484           W-NOTE-FILE-ID,
 12485           CERTIFICATE-NOTE,
 12486           DFHEIV11,
 12487           DFHEIV99
 12488     MOVE EIBRESP  TO W-RESPONSE
 12489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12490           PERFORM 5445-CERTIFICATE-UPDATE THRU 5445-EXIT
 12491         END-IF
 12492       END-IF
 12493     ELSE
 12494        MOVE SPACES              TO CERTIFICATE-NOTE
 12495        MOVE 'CN'                TO CN-RECORD-ID
 12496        MOVE W-SAVE-KEY          TO CN-CONTROL-PRIMARY
 12497                                    W-ERNOTE-KEY
 12498        MOVE 01                  TO CN-BILLING-START-LINE-NO
 12499                                    CN-BILLING-END-LINE-NO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 256
* EL689.cbl
 12500        MOVE W-BILLING-NOTE      TO CN-LINE (01)
 12501        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
 12502        MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
 12503        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12504
 12505* EXEC CICS WRITE
 12506*          DATASET    (W-NOTE-FILE-ID)
 12507*          FROM       (CERTIFICATE-NOTE)
 12508*          RIDFLD     (W-ERNOTE-KEY)
 12509*          RESP       (W-RESPONSE)
 12510*       END-EXEC
 12511     MOVE LENGTH OF
 12512      CERTIFICATE-NOTE
 12513       TO DFHEIV11
 12514*    MOVE '&$ L                  ''  N#00011987' TO DFHEIV0
 12515     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12516     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12517     MOVE X'204E233030303131393837' TO DFHEIV0(25:11)
 12518     CALL 'kxdfhei1' USING DFHEIV0,
 12519           W-NOTE-FILE-ID,
 12520           CERTIFICATE-NOTE,
 12521           DFHEIV11,
 12522           W-ERNOTE-KEY,
 12523           DFHEIV99,
 12524           DFHEIV99
 12525     MOVE EIBRESP  TO W-RESPONSE
 12526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12527
 12528        PERFORM 5445-CERTIFICATE-UPDATE THRU 5445-EXIT
 12529     END-IF
 12530
 12531     .
 12532 5441-EXIT.
 12533     EXIT.
 12534
 12535
 12536 5442-SQUEEZE-IT-IN.
 12537
 12538     IF NOTE-SUB < CN-BILLING-START-LINE-NO
 12539        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
 12540           NOTE-SUB = +10
 12541           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
 12542           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
 12543             MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
 12544             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
 12545             MOVE +9 TO NOTE-SUB
 12546           END-IF
 12547        END-PERFORM
 12548     ELSE
 12549        IF NOTE-SUB > CN-BILLING-END-LINE-NO
 12550           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
 12551             UNTIL NOTE-SUB = +1
 12552             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
 12553             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
 12554                MOVE W-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
 12555                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
 12556                MOVE +2          TO NOTE-SUB
 12557             END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 257
* EL689.cbl
 12558           END-PERFORM
 12559        END-IF
 12560     END-IF
 12561
 12562     .
 12563 5442-EXIT.
 12564     EXIT.
 12565
 12566 5445-CERTIFICATE-UPDATE.
 12567
 12568     MOVE W-SAVE-KEY         TO W-CERT-KEY
 12569
 12570
 12571* EXEC CICS READ
 12572*        DATASET  (W-CERT-FILE-ID)
 12573*        RIDFLD   (W-CERT-KEY)
 12574*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 12575*        RESP     (W-RESPONSE)
 12576*        UPDATE
 12577*    END-EXEC
 12578*    MOVE '&"S        EU         (  N#00012036' TO DFHEIV0
 12579     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12580     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12581     MOVE X'204E233030303132303336' TO DFHEIV0(25:11)
 12582     CALL 'kxdfhei1' USING DFHEIV0,
 12583           W-CERT-FILE-ID,
 12584           DFHEIV20,
 12585           DFHEIV99,
 12586           W-CERT-KEY,
 12587           DFHEIV99,
 12588           DFHEIV99,
 12589           DFHEIV99
 12590     SET ADDRESS OF CERTIFICATE-MASTER TO
 12591         DFHEIV20
 12592     MOVE EIBRESP  TO W-RESPONSE
 12593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12594
 12595     IF RESP-NORMAL
 12596        EVALUATE CM-NOTE-SW
 12597           WHEN '2'
 12598           WHEN '3'
 12599           WHEN '6'
 12600           WHEN '7'
 12601              SET NO-CERT-RW     TO TRUE
 12602           WHEN ' '
 12603              MOVE '2'           TO CM-NOTE-SW
 12604           WHEN '1'
 12605              MOVE '3'           TO CM-NOTE-SW
 12606           WHEN '4'
 12607              MOVE '6'           TO CM-NOTE-SW
 12608           WHEN '5'
 12609              MOVE '7'           TO CM-NOTE-SW
 12610        END-EVALUATE
 12611     END-IF
 12612     IF NOT NO-CERT-RW
 12613
 12614* EXEC CICS REWRITE
 12615*          FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 258
* EL689.cbl
 12616*          DATASET  (W-CERT-FILE-ID)
 12617*          RESP     (W-RESPONSE)
 12618*       END-EXEC
 12619     MOVE LENGTH OF
 12620      CERTIFICATE-MASTER
 12621       TO DFHEIV11
 12622*    MOVE '&& L                  %  N#00012062' TO DFHEIV0
 12623     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12624     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12625     MOVE X'204E233030303132303632' TO DFHEIV0(25:11)
 12626     CALL 'kxdfhei1' USING DFHEIV0,
 12627           W-CERT-FILE-ID,
 12628           CERTIFICATE-MASTER,
 12629           DFHEIV11,
 12630           DFHEIV99
 12631     MOVE EIBRESP  TO W-RESPONSE
 12632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12633     ELSE
 12634
 12635* EXEC CICS UNLOCK
 12636*          DATASET  (W-CERT-FILE-ID)
 12637*       END-EXEC
 12638*    MOVE '&*                    #   #00012068' TO DFHEIV0
 12639     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12640     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12641     MOVE X'2020233030303132303638' TO DFHEIV0(25:11)
 12642     CALL 'kxdfhei1' USING DFHEIV0,
 12643           W-CERT-FILE-ID,
 12644           DFHEIV99
 12645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12646     END-IF
 12647
 12648     .
 12649 5445-EXIT.
 12650     EXIT.
 12651
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 259
* EL689.cbl
 12653 5460-DUPLICATE-ARCHIVE-RCD.
 12654
 12655     IF  NOT PI-689-CREATE-NO-SCREENS
 12656
 12657* EXEC CICS SYNCPOINT ROLLBACK
 12658*        END-EXEC.
 12659*    MOVE '6"R                   !   #00012081' TO DFHEIV0
 12660     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12661     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12662     MOVE X'2020233030303132303831' TO DFHEIV0(25:11)
 12663     CALL 'kxdfhei1' USING DFHEIV0
 12664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12665
 12666
 12667     MOVE ER-9426                TO EMI-ERROR.
 12668     MOVE -1                     TO MAINTL.
 12669     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12670     GO TO 8200-SEND-DATAONLY.
 12671
 12672 5465-DUPLICATE-ARCH-TEXT.
 12673
 12674     IF  NOT PI-689-CREATE-NO-SCREENS
 12675
 12676* EXEC CICS SYNCPOINT ROLLBACK
 12677*        END-EXEC.
 12678*    MOVE '6"R                   !   #00012092' TO DFHEIV0
 12679     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12680     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12681     MOVE X'2020233030303132303932' TO DFHEIV0(25:11)
 12682     CALL 'kxdfhei1' USING DFHEIV0
 12683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12684
 12685
 12686     MOVE ER-7369                TO EMI-ERROR.
 12687     MOVE -1                     TO MAINTL.
 12688     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12689     GO TO 8200-SEND-DATAONLY.
 12690
 12691 5470-CNTL-NOT-FOUND.
 12692
 12693     MOVE ER-9299                TO EMI-ERROR.
 12694     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12695     MOVE -1                     TO MAINTL.
 12696     MOVE AL-UANON               TO MAINTA.
 12697     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 260
* EL689.cbl
 12699 5500-FORMAT-TEXT.
 12700
 12701     SET LT-NDX UP BY +1.
 12702
 12703     IF  W-RC-TEXT (W-RG-NDX) EQUAL W-TOP-FORM
 12704         SET W-RG-NDX UP BY 1
 12705         MOVE 99                 TO LT-SKIP-CONTROL (LT-NDX)
 12706         MOVE W-RC-TEXT (W-RG-NDX)
 12707                                 TO LT-TEXT-LINE (LT-NDX)
 12708     ELSE
 12709         IF  W-RC-TEXT (W-RG-NDX) EQUAL SPACES
 12710             MOVE ZEROS          TO W-PRINT-CONTROL
 12711             PERFORM 5505-FIND-USED-LINE THRU 5505-EXIT
 12712                     VARYING
 12713                 W-RG-NDX FROM W-RG-NDX BY 1
 12714                     UNTIL
 12715                 W-RG-NDX GREATER THAN PI-TOTAL-LINES
 12716                     OR
 12717                 W-RC-TEXT (W-RG-NDX) GREATER THAN SPACES
 12718             IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 12719                 GO TO 5500-WRITE-TEST
 12720             ELSE
 12721                 MOVE W-PRINT-CONTROL
 12722                                 TO LT-SKIP-CONTROL (LT-NDX)
 12723                 MOVE W-RC-TEXT (W-RG-NDX)
 12724                                 TO LT-TEXT-LINE (LT-NDX)
 12725         ELSE
 12726             MOVE W-RC-TEXT (W-RG-NDX)
 12727                                 TO LT-TEXT-LINE (LT-NDX)
 12728             MOVE ZEROS          TO W-PRINT-CONTROL.
 12729
 12730     ADD +1                      TO LT-NUM-LINES-ON-RECORD.
 12731
 12732 5500-WRITE-TEST.
 12733
 12734     IF  W-RG-NDX NOT LESS THAN PI-TOTAL-LINES
 12735         IF  LT-TEXT-RECORD NOT EQUAL SPACES
 12736             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 12737             MOVE '2'            TO LT-RECORD-TYPE
 12738             ADD +1              TO W-SEQ-CTR
 12739             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 12740             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12741         ELSE
 12742             NEXT SENTENCE
 12743     ELSE
 12744         IF  LT-NDX EQUAL +20
 12745             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 12746             MOVE '2'            TO LT-RECORD-TYPE
 12747             ADD +1              TO W-SEQ-CTR
 12748             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 12749             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12750             SET LT-NDX          TO W-ZEROS
 12751             PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 12752
 12753 5500-EXIT.
 12754      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 261
* EL689.cbl
 12756 5505-FIND-USED-LINE.
 12757
 12758     ADD +1                      TO W-PRINT-CONTROL.
 12759
 12760 5505-EXIT.
 12761      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 262
* EL689.cbl
 12763 5600-FORMAT-ADDRESS-LINE.
 12764
 12765     SET LT-NDX                  TO W-RG-NDX.
 12766     MOVE W-RC-TEXT (W-RG-NDX)   TO LT-TEXT-LINE (LT-NDX).
 12767
 12768 5600-EXIT.
 12769     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 263
* EL689.cbl
 12771 5650-WRITE-ARCHIVE.
 12772
 12773
 12774* EXEC CICS WRITE
 12775*         DATASET   (W-ARCH-FILE-ID)
 12776*         FROM      (LETTER-ARCHIVE)
 12777*         RIDFLD    (LA-CONTROL-PRIMARY)
 12778*    END-EXEC.
 12779     MOVE LENGTH OF
 12780      LETTER-ARCHIVE
 12781       TO DFHEIV11
 12782*    MOVE '&$ L                  ''   #00012182' TO DFHEIV0
 12783     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12784     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12785     MOVE X'2020233030303132313832' TO DFHEIV0(25:11)
 12786     CALL 'kxdfhei1' USING DFHEIV0,
 12787           W-ARCH-FILE-ID,
 12788           LETTER-ARCHIVE,
 12789           DFHEIV11,
 12790           LA-CONTROL-PRIMARY,
 12791           DFHEIV99,
 12792           DFHEIV99
 12793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12794
 12795
 12796 5650-EXIT.
 12797     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 264
* EL689.cbl
 12799 5655-WRITE-ARCHIVE-TEXT.
 12800
 12801
 12802* EXEC CICS WRITE
 12803*         DATASET   (W-ARCT-FILE-ID)
 12804*         FROM      (LETTER-ARCHIVE-TEXT)
 12805*         RIDFLD    (LT-CONTROL-PRIMARY)
 12806*    END-EXEC.
 12807     MOVE LENGTH OF
 12808      LETTER-ARCHIVE-TEXT
 12809       TO DFHEIV11
 12810*    MOVE '&$ L                  ''   #00012193' TO DFHEIV0
 12811     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12812     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12813     MOVE X'2020233030303132313933' TO DFHEIV0(25:11)
 12814     CALL 'kxdfhei1' USING DFHEIV0,
 12815           W-ARCT-FILE-ID,
 12816           LETTER-ARCHIVE-TEXT,
 12817           DFHEIV11,
 12818           LT-CONTROL-PRIMARY,
 12819           DFHEIV99,
 12820           DFHEIV99
 12821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12822
 12823
 12824 5655-EXIT.
 12825     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 265
* EL689.cbl
 12827 6000-RESOLVE-VARIABLES.
 12828***************************************************************
 12829*    THIS ROUTINE WILL FORMAT THE SYSTEM DEFINED SYMBOLS      *
 12830*    WITH DATA PERTAINING TO THE FORM WITH VARIABLES.         *
 12831*    THIS ROUTINE IS PERFORM THRU 6000-EXIT IN ORDER TO       *
 12832*    RESOLVE ALL OF THE SYMBOLS.                              *
 12833*                                                             *
 12834***************************************************************
 12835
 12836     PERFORM 6200-GET-COMPANY-DATA THRU 6200-EXIT.
 12837     PERFORM 6250-GET-CNTL2-DATA THRU 6250-EXIT.
 12838     PERFORM 6400-GET-PENDING-DATA THRU 6400-EXIT.
 12839     PERFORM 6450-GET-CERT-DATA THRU 6450-EXIT.
 12840     PERFORM 6500-GET-ACCOUNT-DATA THRU 6500-EXIT
 12841*    PERFORM 6350-GET-CSR-DATA   THRU 6350-EXIT
 12842     PERFORM 6600-GET-COMPENSATION-DATA THRU 6600-EXIT.
 12843     PERFORM 6700-GET-MAIL-DATA THRU 6700-EXIT.
 12844     PERFORM 6300-GET-CARRIER-DATA THRU 6300-EXIT.
 12845     PERFORM 6750-GET-LIFE-BENEFIT-DATA THRU 6750-EXIT.
 12846     PERFORM 6800-GET-A-H-BENEFIT-DATA THRU 6800-EXIT.
 12847     PERFORM 6850-GET-CHECK-DATA THRU 6850-EXIT.
 12848     PERFORM 6900-GET-PYAJ-DATA THRU 6900-EXIT.
 12849     PERFORM 6950-MOVE-SYSTEM-DATA THRU 6950-EXIT.
 12850
 12851     MOVE SPACES                 TO W-REVERSE-DATE-SW.
 12852
 12853 6000-EXIT.
 12854     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 266
* EL689.cbl
 12856 6200-GET-COMPANY-DATA.
 12857
 12858     IF  ADDRSI EQUAL '3'
 12859             AND
 12860         PI-CREATE-LABELS
 12861             AND
 12862         NOT PI-689-LABELS-OVERRIDEN
 12863         NEXT SENTENCE
 12864     ELSE
 12865         IF  W-FILE-NOT-USED (1)
 12866             GO TO 6200-EXIT.
 12867
 12868     MOVE SPACES                 TO W-CNTL-KEY.
 12869     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12870     MOVE +0                     TO W-CNTL-SEQ-NO.
 12871     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 12872
 12873
 12874* EXEC CICS HANDLE CONDITION
 12875*         NOTOPEN   (8040-CNTL-NOT-OPEN)
 12876*         NOTFND    (6200-CNTL1-NOT-FOUND)
 12877*    END-EXEC.
 12878*    MOVE '"$JI                  ! + #00012248' TO DFHEIV0
 12879     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12881     MOVE X'2B20233030303132323438' TO DFHEIV0(25:11)
 12882     CALL 'kxdfhei1' USING DFHEIV0
 12883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12884
 12885
 12886
 12887* EXEC CICS READ
 12888*         DATASET   (W-CNTL-FILE-ID)
 12889*         SET       (ADDRESS OF CONTROL-FILE)
 12890*         RIDFLD    (W-CNTL-KEY)
 12891*    END-EXEC.
 12892*    MOVE '&"S        E          (   #00012253' TO DFHEIV0
 12893     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12894     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12895     MOVE X'2020233030303132323533' TO DFHEIV0(25:11)
 12896     CALL 'kxdfhei1' USING DFHEIV0,
 12897           W-CNTL-FILE-ID,
 12898           DFHEIV20,
 12899           DFHEIV99,
 12900           W-CNTL-KEY,
 12901           DFHEIV99,
 12902           DFHEIV99,
 12903           DFHEIV99
 12904     SET ADDRESS OF CONTROL-FILE TO
 12905         DFHEIV20
 12906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12907
 12908
 12909     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12910     MOVE CF-CL-MAIL-TO-NAME     TO W-LABEL-LINES (1)
 12911                                    W-VG-TEXT (25).
 12912     MOVE CF-CL-IN-CARE-OF       TO W-LABEL-LINES (2).
 12913     MOVE CF-CL-ADDR-LINE-1      TO W-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 267
* EL689.cbl
 12914     MOVE CF-CL-ADDR-LINE-2      TO W-LABEL-LINES (4).
 12915     MOVE CF-CL-CITY-STATE       TO W-LABEL-LINES (5).
 12916
 12917     IF  CF-CL-CAN-POST-CODE
 12918         MOVE CF-CL-CANADIAN-POSTAL-CODE
 12919                                 TO W-CANADIAN-POSTAL-CODES
 12920         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12921         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12922         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12923                                    W-LAB-CAN-FILLER (6)
 12924         GO TO 6200-CONTINUE.
 12925
 12926     IF CF-CL-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 12927         MOVE CF-CL-ZIP-CODE     TO W-WORK-ZIP
 12928         MOVE SPACES             TO W-LABEL-ZIP (6)
 12929         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12930
 12931         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12932             MOVE '-'            TO W-LABEL-DASH (6)
 12933             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12934             GO TO 6200-CONTINUE
 12935         ELSE
 12936             MOVE SPACES         TO W-LABEL-DASH (6)
 12937                                    W-LABEL-2ND-ZIP (6)
 12938             GO TO 6200-CONTINUE.
 12939
 12940     IF  CF-CL-ZIP-CODE-NUM NOT NUMERIC
 12941         GO TO 6200-CONTINUE.
 12942
 12943     MOVE CF-CL-ZIP-CODE-NUM     TO W-WORK-ZIP-NUMERIC.
 12944
 12945     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 12946         COMPUTE W-WORK-ZIP-NUMERIC
 12947             = W-WORK-ZIP-NUMERIC * 10000.
 12948
 12949     MOVE SPACES                 TO W-LABEL-ZIP (6).
 12950     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 12951
 12952     IF  W-WORK-ZIP4 GREATER THAN '0000'
 12953         MOVE '-'                TO W-LABEL-DASH (6)
 12954         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 12955         GO TO 6200-CONTINUE
 12956     ELSE
 12957         MOVE SPACES             TO W-LABEL-DASH (6)
 12958                                    W-LABEL-2ND-ZIP (6)
 12959         GO TO 6200-CONTINUE.
 12960
 12961 6200-CONTINUE.
 12962
 12963     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12964
 12965     IF  ADDRSI EQUAL '3'
 12966             AND
 12967         PI-CREATE-LABELS
 12968             AND
 12969         NOT PI-689-LABELS-OVERRIDEN
 12970         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (1)
 12971         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (2)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 268
* EL689.cbl
 12972         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (3)
 12973         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (04)
 12974         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (5)
 12975         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (6)
 12976         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12977         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12978         SET W-RG-NDX UP BY +1
 12979     ELSE
 12980         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (1)
 12981         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (2)
 12982         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (3)
 12983         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (4)
 12984         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (5)
 12985         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (6).
 12986
 12987     GO TO 6200-EXIT.
 12988
 12989 6200-CNTL1-NOT-FOUND.
 12990
 12991     MOVE ER-9299                TO EMI-ERROR.
 12992     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12993     MOVE -1                     TO ADDRSL.
 12994     MOVE AL-UANON               TO ADDRSA.
 12995     GO TO 8200-SEND-DATAONLY.
 12996
 12997 6200-EXIT.
 12998     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 269
* EL689.cbl
 13000 6250-GET-CNTL2-DATA.
 13001
 13002     IF  PI-PROCESSOR-ID EQUAL W-LGXX-ID
 13003         GO TO 6250-EXIT.
 13004
 13005     IF  W-FILE-NOT-USED (11)
 13006         GO TO 6250-EXIT.
 13007
 13008     MOVE SPACES                 TO W-CNTL-KEY.
 13009     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 13010     MOVE +0                     TO W-CNTL-SEQ-NO.
 13011     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 13012     MOVE PI-PROCESSOR-ID        TO W-CNTL-GENL.
 13013
 13014
 13015* EXEC CICS HANDLE CONDITION
 13016*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13017*         NOTFND     (6250-CNTL2-NOT-FOUND)
 13018*    END-EXEC.
 13019*    MOVE '"$JI                  ! , #00012364' TO DFHEIV0
 13020     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13021     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13022     MOVE X'2C20233030303132333634' TO DFHEIV0(25:11)
 13023     CALL 'kxdfhei1' USING DFHEIV0
 13024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13025
 13026
 13027
 13028* EXEC CICS READ
 13029*         DATASET    (W-CNTL-FILE-ID)
 13030*         SET        (ADDRESS OF CONTROL-FILE)
 13031*         RIDFLD     (W-CNTL-KEY)
 13032*    END-EXEC.
 13033*    MOVE '&"S        E          (   #00012369' TO DFHEIV0
 13034     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13035     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13036     MOVE X'2020233030303132333639' TO DFHEIV0(25:11)
 13037     CALL 'kxdfhei1' USING DFHEIV0,
 13038           W-CNTL-FILE-ID,
 13039           DFHEIV20,
 13040           DFHEIV99,
 13041           W-CNTL-KEY,
 13042           DFHEIV99,
 13043           DFHEIV99,
 13044           DFHEIV99
 13045     SET ADDRESS OF CONTROL-FILE TO
 13046         DFHEIV20
 13047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13048
 13049
 13050     MOVE CF-PROCESSOR           TO W-VG-TEXT (153).
 13051     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (151).
 13052     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (152).
 13053     GO TO 6250-EXIT.
 13054
 13055 6250-CNTL2-NOT-FOUND.
 13056
 13057     MOVE ER-9299                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 270
* EL689.cbl
 13058     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13059     MOVE -1                     TO MAINTL.
 13060     MOVE AL-UANON               TO MAINTA.
 13061     GO TO 8200-SEND-DATAONLY.
 13062
 13063 6250-EXIT.
 13064     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 271
* EL689.cbl
 13066 6300-GET-CARRIER-DATA.
 13067
 13068     IF  ADDRSI EQUAL '2'
 13069             AND
 13070         PI-CREATE-LABELS
 13071             AND
 13072         NOT PI-689-LABELS-OVERRIDEN
 13073         NEXT SENTENCE
 13074     ELSE
 13075         IF  W-FILE-NOT-USED (4)
 13076             GO TO 6300-EXIT.
 13077
 13078     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
 13079         MOVE SPACES             TO W-CNTL-KEY
 13080         MOVE PI-COMPANY-ID      TO W-CNTL-COMPANY-ID
 13081         MOVE +0                 TO W-CNTL-SEQ-NO
 13082         MOVE '6'                TO W-CNTL-RECORD-TYPE
 13083         MOVE PI-689-CARRIER     TO W-CNTL-GEN4
 13084     ELSE
 13085         MOVE ER-9327            TO EMI-ERROR
 13086         MOVE -1                 TO CARRIERL
 13087         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13088         GO TO 6300-EXIT.
 13089
 13090
 13091* EXEC CICS HANDLE CONDITION
 13092*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13093*         NOTFND     (6300-CNTL6-NOT-FOUND)
 13094*    END-EXEC.
 13095*    MOVE '"$JI                  ! - #00012415' TO DFHEIV0
 13096     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13097     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13098     MOVE X'2D20233030303132343135' TO DFHEIV0(25:11)
 13099     CALL 'kxdfhei1' USING DFHEIV0
 13100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13101
 13102
 13103
 13104* EXEC CICS READ
 13105*         DATASET    (W-CNTL-FILE-ID)
 13106*         SET        (ADDRESS OF CONTROL-FILE)
 13107*         RIDFLD     (W-CNTL-KEY)
 13108*    END-EXEC.
 13109*    MOVE '&"S        E          (   #00012420' TO DFHEIV0
 13110     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13111     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13112     MOVE X'2020233030303132343230' TO DFHEIV0(25:11)
 13113     CALL 'kxdfhei1' USING DFHEIV0,
 13114           W-CNTL-FILE-ID,
 13115           DFHEIV20,
 13116           DFHEIV99,
 13117           W-CNTL-KEY,
 13118           DFHEIV99,
 13119           DFHEIV99,
 13120           DFHEIV99
 13121     SET ADDRESS OF CONTROL-FILE TO
 13122         DFHEIV20
 13123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 272
* EL689.cbl
 13124
 13125
 13126     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13127     MOVE CF-MAIL-TO-NAME        TO W-LABEL-LINES (1).
 13128     MOVE CF-IN-CARE-OF          TO W-LABEL-LINES (2).
 13129     MOVE CF-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 13130     MOVE CF-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 13131     MOVE CF-CITY-STATE          TO W-LABEL-LINES (5).
 13132
 13133     IF  CF-CANADIAN-POST-CODE
 13134         MOVE CF-CANADIAN-POSTAL-CODE
 13135                                 TO W-CANADIAN-POSTAL-CODES
 13136         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13137         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13138         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13139                                    W-LAB-CAN-FILLER (6)
 13140         GO TO 6300-CONTINUE.
 13141
 13142     IF CF-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 13143         MOVE CF-ZIP-CODE        TO W-WORK-ZIP
 13144         MOVE SPACES             TO W-LABEL-ZIP (6)
 13145         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13146         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13147             MOVE '-'            TO W-LABEL-DASH (6)
 13148             MOVE W-WORK-ZIP4
 13149                                 TO W-LABEL-2ND-ZIP (6)
 13150             GO TO 6300-CONTINUE
 13151         ELSE
 13152             MOVE SPACES         TO W-LABEL-DASH (6)
 13153                                    W-LABEL-2ND-ZIP (6)
 13154             GO TO 6300-CONTINUE.
 13155
 13156     IF  CF-ZIP-CODE-NUM NOT NUMERIC
 13157         GO TO 6300-CONTINUE.
 13158
 13159     MOVE CF-ZIP-CODE-NUM TO W-WORK-ZIP-NUMERIC.
 13160
 13161     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 13162         COMPUTE W-WORK-ZIP-NUMERIC
 13163             = W-WORK-ZIP-NUMERIC * 10000.
 13164
 13165     MOVE SPACES                 TO W-LABEL-ZIP (6).
 13166     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 13167
 13168     IF  W-WORK-ZIP4 GREATER THAN '0000'
 13169         MOVE '-'                TO W-LABEL-DASH (6)
 13170         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 13171         GO TO 6300-CONTINUE
 13172     ELSE
 13173         MOVE SPACES             TO W-LABEL-DASH (6)
 13174                                    W-LABEL-2ND-ZIP (6)
 13175         GO TO 6300-CONTINUE.
 13176
 13177 6300-CONTINUE.
 13178
 13179     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13180
 13181     IF  ADDRSI EQUAL '2'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 273
* EL689.cbl
 13182             AND
 13183         PI-CREATE-LABELS
 13184             AND
 13185         NOT PI-689-LABELS-OVERRIDEN
 13186         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (20)
 13187         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (21)
 13188         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (22)
 13189         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (23)
 13190         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (24)
 13191         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (25)
 13192         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13193         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13194         SET W-RG-NDX UP BY +1
 13195     ELSE
 13196         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (20)
 13197         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (21)
 13198         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (22)
 13199         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (23)
 13200         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (24)
 13201         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (25).
 13202
 13203     IF  W-FULL-DATA
 13204         MOVE ZEROS              TO W-PHONE-IN
 13205         MOVE CF-PHONE-NO        TO W-PHONE-IN
 13206         MOVE W-PHI-AREA         TO W-PO-AREA
 13207         MOVE W-PHI-PFX          TO W-PO-PFX
 13208         MOVE W-PHI-SFX          TO W-PO-SFX
 13209         MOVE W-PHONE-OUT        TO W-VG-TEXT (26).
 13210
 13211     GO TO 6300-EXIT.
 13212
 13213 6300-CNTL6-NOT-FOUND.
 13214
 13215     MOVE ER-9298                TO EMI-ERROR.
 13216     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13217     MOVE -1                     TO ADDRSL.
 13218     MOVE AL-UANON               TO ADDRSA.
 13219     GO TO 8200-SEND-DATAONLY.
 13220
 13221 6300-EXIT.
 13222     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 274
* EL689.cbl
 13224 6350-GET-CSR-DATA.
 13225     IF W-VG-TEXT (148) (1:4) = '****' OR SPACES
 13226        GO TO 6350-EXIT
 13227     END-IF
 13228*    IF W-FILE-NOT-USED (11)
 13229*       GO TO 6350-EXIT
 13230*    END-IF
 13231     MOVE SPACES                 TO W-CNTL-KEY
 13232     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
 13233     MOVE +0                     TO W-CNTL-SEQ-NO
 13234     MOVE '2'                    TO W-CNTL-RECORD-TYPE
 13235     MOVE CO-CSR-CODE            TO W-CNTL-GENL
 13236
 13237* EXEC CICS HANDLE CONDITION
 13238*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13239*         NOTFND     (6350-CNTL2-NOT-FOUND)
 13240*    END-EXEC
 13241*    MOVE '"$JI                  ! . #00012536' TO DFHEIV0
 13242     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13243     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13244     MOVE X'2E20233030303132353336' TO DFHEIV0(25:11)
 13245     CALL 'kxdfhei1' USING DFHEIV0
 13246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13247
 13248* EXEC CICS READ
 13249*         DATASET    (W-CNTL-FILE-ID)
 13250*         SET        (ADDRESS OF CONTROL-FILE)
 13251*         RIDFLD     (W-CNTL-KEY)
 13252*    END-EXEC
 13253*    MOVE '&"S        E          (   #00012540' TO DFHEIV0
 13254     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13255     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13256     MOVE X'2020233030303132353430' TO DFHEIV0(25:11)
 13257     CALL 'kxdfhei1' USING DFHEIV0,
 13258           W-CNTL-FILE-ID,
 13259           DFHEIV20,
 13260           DFHEIV99,
 13261           W-CNTL-KEY,
 13262           DFHEIV99,
 13263           DFHEIV99,
 13264           DFHEIV99
 13265     SET ADDRESS OF CONTROL-FILE TO
 13266         DFHEIV20
 13267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13268     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 13269     GO TO 6350-EXIT
 13270     .
 13271 6350-CNTL2-NOT-FOUND.
 13272     MOVE ER-9299                TO EMI-ERROR.
 13273     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13274     MOVE -1                     TO MAINTL.
 13275     MOVE AL-UANON               TO MAINTA.
 13276     GO TO 8200-SEND-DATAONLY.
 13277 6350-EXIT.
 13278     EXIT.
 13279 6400-GET-PENDING-DATA.
 13280
 13281     IF (ADDRSI EQUAL '7')
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 275
* EL689.cbl
 13282        AND (PI-CREATE-LABELS)
 13283        AND (NOT PI-689-LABELS-OVERRIDEN)
 13284        CONTINUE
 13285     ELSE
 13286        IF PI-689-DATA-SOURCE = '4'
 13287           CONTINUE
 13288        ELSE
 13289           IF W-FILE-NOT-USED (9)
 13290              GO TO 6400-EXIT
 13291           END-IF
 13292        END-IF
 13293     END-IF
 13294     IF  W-PNDB-ENTRY EQUAL LOW-VALUES
 13295         MOVE ER-9327            TO EMI-ERROR
 13296         MOVE -1                 TO MAINTL
 13297         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13298         GO TO 6400-EXIT.
 13299
 13300 6400-READ-PNDB-ONLY.
 13301
 13302
 13303* EXEC CICS HANDLE CONDITION
 13304*         NOTOPEN (8060-PNDB-NOT-OPEN)
 13305*         NOTFND  (8070-PNDB-NOT-FOUND)
 13306*    END-EXEC.
 13307*    MOVE '"$JI                  ! / #00012579' TO DFHEIV0
 13308     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13310     MOVE X'2F20233030303132353739' TO DFHEIV0(25:11)
 13311     CALL 'kxdfhei1' USING DFHEIV0
 13312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13313
 13314
 13315
 13316* EXEC CICS READ
 13317*         DATASET (W-PNDB-FILE-ID)
 13318*         SET     (ADDRESS OF PENDING-BUSINESS)
 13319*         RIDFLD  (W-PNDB-KEY)
 13320*    END-EXEC.
 13321*    MOVE '&"S        E          (   #00012584' TO DFHEIV0
 13322     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13323     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13324     MOVE X'2020233030303132353834' TO DFHEIV0(25:11)
 13325     CALL 'kxdfhei1' USING DFHEIV0,
 13326           W-PNDB-FILE-ID,
 13327           DFHEIV20,
 13328           DFHEIV99,
 13329           W-PNDB-KEY,
 13330           DFHEIV99,
 13331           DFHEIV99,
 13332           DFHEIV99
 13333     SET ADDRESS OF PENDING-BUSINESS TO
 13334         DFHEIV20
 13335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13336
 13337
 13338     MOVE 'Y'                    TO W-PNDB-FOUND-SW.
 13339
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 276
* EL689.cbl
 13340     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 13341         MOVE PB-SV-CARRIER      TO PB-CARRIER
 13342                                    PI-689-CARRIER
 13343         MOVE PB-SV-GROUPING     TO PB-GROUPING
 13344                                    PI-689-GROUPING
 13345         MOVE PB-SV-STATE        TO PB-STATE
 13346                                    PI-689-STATE
 13347         MOVE PB-CONTROL-BY-ACCOUNT
 13348                                 TO W-CERT-KEY
 13349                                    W-MAIL-KEY
 13350                                    W-ACCT-KEY
 13351         MOVE PB-ACCOUNT         TO PI-689-ACCOUNT
 13352         MOVE PB-CERT-EFF-DT     TO PI-689-EFF-DATE
 13353         MOVE PB-CERT-NO         TO PI-689-CERT-NO.
 13354
 13355 6400-ONLY-STOP.
 13356
 13357     MOVE PB-ENTRY-BATCH         TO W-VG-TEXT (130).
 13358
 13359     IF  NOT PB-ISSUE
 13360         GO TO 6400-CANCEL.
 13361
 13362     MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1.
 13363     MOVE SPACES                 TO DC-OPTION-CODE.
 13364     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13365
 13366     IF  NO-CONVERSION-ERROR
 13367         MOVE DC-GREG-DATE-1-EDIT
 13368                                 TO W-VG-TEXT (110).
 13369
 13370     MOVE PB-I-AGE               TO W-EDIT-3-0.
 13371     MOVE W-EDIT-3-0             TO W-VG-TEXT (124).
 13372     MOVE PB-I-LF-PREMIUM-AMT    TO W-EDIT-7-2.
 13373     MOVE W-EDIT-7-2             TO W-VG-TEXT (111).
 13374     MOVE PB-I-AH-PREMIUM-AMT    TO W-EDIT-7-2.
 13375     MOVE W-EDIT-7-2             TO W-VG-TEXT (112).
 13376     MOVE PB-I-LF-PREM-CALC      TO W-EDIT-7-2.
 13377     MOVE W-EDIT-7-2             TO W-VG-TEXT (113).
 13378     MOVE PB-I-AH-PREM-CALC      TO W-EDIT-7-2.
 13379     MOVE W-EDIT-7-2             TO W-VG-TEXT (114).
 13380     MOVE PB-I-LF-BENEFIT-AMT    TO W-EDIT-9-2.
 13381     MOVE W-EDIT-9-2             TO W-VG-TEXT (125).
 13382     MOVE PB-I-AH-BENEFIT-AMT    TO W-EDIT-7-2.
 13383     MOVE W-EDIT-7-2             TO W-VG-TEXT (126).
 13384     MOVE PB-I-LF-RATE           TO W-EDIT-2-5-S.
 13385     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (127).
 13386     MOVE PB-I-AH-RATE           TO W-EDIT-2-5-S.
 13387     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (128).
 13388     MOVE PB-I-LOAN-TERM         TO W-EDIT-3-0.
 13389     MOVE W-EDIT-3-0             TO W-VG-TEXT (129).
 13390
 13391     COMPUTE W-DIFFERENCE
 13392         = PB-I-LF-PREM-CALC - PB-I-LF-PREMIUM-AMT.
 13393
 13394     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13395     MOVE W-EDIT-7-2             TO W-VG-TEXT (115).
 13396
 13397     COMPUTE W-DIFFERENCE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 277
* EL689.cbl
 13398         = PB-I-AH-PREM-CALC - PB-I-AH-PREMIUM-AMT.
 13399
 13400     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13401     MOVE W-EDIT-7-2             TO W-VG-TEXT (116).
 13402
 13403 6400-CANCEL.
 13404
 13405     IF  NOT PB-CANCELLATION
 13406         GO TO 6400-EXIT.
 13407
 13408     MOVE PB-CI-AH-PRIOR-CANCEL-DT
 13409                                 TO DC-BIN-DATE-1.
 13410     MOVE SPACES                 TO DC-OPTION-CODE.
 13411     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13412
 13413     IF  NO-CONVERSION-ERROR
 13414         MOVE DC-GREG-DATE-1-EDIT
 13415                                 TO W-VG-TEXT (117).
 13416
 13417     MOVE PB-C-LF-CANCEL-AMT     TO W-EDIT-7-2.
 13418     MOVE W-EDIT-7-2             TO W-VG-TEXT (118).
 13419     MOVE PB-C-AH-CANCEL-AMT     TO W-EDIT-7-2.
 13420     MOVE W-EDIT-7-2             TO W-VG-TEXT (119).
 13421     MOVE PB-C-LF-REF-CALC       TO W-EDIT-7-2.
 13422     MOVE W-EDIT-7-2             TO W-VG-TEXT (120).
 13423     MOVE PB-C-AH-REF-CALC       TO W-EDIT-7-2.
 13424     MOVE W-EDIT-7-2             TO W-VG-TEXT (121).
 13425     COMPUTE W-EDIT-7-2 = PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT
 13426     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 13427
 13428     IF PB-C-INT-ON-REFS NOT NUMERIC
 13429        MOVE ZEROS               TO PB-C-INT-ON-REFS
 13430     END-IF
 13431     MOVE PB-C-INT-ON-REFS       TO W-EDIT-7-2
 13432     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 13433     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
 13434     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-1
 13435        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-1
 13436     END-IF
 13437     MOVE SPACES                 TO DC-OPTION-CODE
 13438     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 13439
 13440     IF NO-CONVERSION-ERROR
 13441        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 13442     END-IF
 13443
 13444     COMPUTE W-DIFFERENCE = PB-C-LF-REF-CALC
 13445                           - PB-C-LF-CANCEL-AMT.
 13446
 13447     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13448     MOVE W-EDIT-7-2             TO W-VG-TEXT (122).
 13449
 13450     COMPUTE W-DIFFERENCE = PB-C-AH-REF-CALC
 13451                           - PB-C-AH-CANCEL-AMT.
 13452
 13453     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13454     MOVE W-EDIT-7-2             TO W-VG-TEXT (123).
 13455
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 278
* EL689.cbl
 13456 6400-EXIT.
 13457     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 279
* EL689.cbl
 13459 6450-GET-CERT-DATA.
 13460     IF  W-FILE-NOT-USED (8)
 13461         GO TO 6450-EXIT.
 13462
 13463     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 13464         MOVE ER-9327            TO EMI-ERROR
 13465         MOVE -1                 TO MAINTL
 13466         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13467         GO TO 6450-EXIT.
 13468
 13469 6450-READ-CERT-ONLY.
 13470
 13471
 13472* EXEC CICS HANDLE CONDITION
 13473*         NOTOPEN (8030-CERT-NOT-OPEN)
 13474*         NOTFND  (8035-CERT-NOT-FOUND)
 13475*    END-EXEC.
 13476*    MOVE '"$JI                  ! 0 #00012723' TO DFHEIV0
 13477     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13478     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13479     MOVE X'3020233030303132373233' TO DFHEIV0(25:11)
 13480     CALL 'kxdfhei1' USING DFHEIV0
 13481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13482
 13483
 13484
 13485* EXEC CICS READ
 13486*         DATASET (W-CERT-FILE-ID)
 13487*         SET     (ADDRESS OF CERTIFICATE-MASTER)
 13488*         RIDFLD  (W-CERT-KEY)
 13489*    END-EXEC.
 13490*    MOVE '&"S        E          (   #00012728' TO DFHEIV0
 13491     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13492     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13493     MOVE X'2020233030303132373238' TO DFHEIV0(25:11)
 13494     CALL 'kxdfhei1' USING DFHEIV0,
 13495           W-CERT-FILE-ID,
 13496           DFHEIV20,
 13497           DFHEIV99,
 13498           W-CERT-KEY,
 13499           DFHEIV99,
 13500           DFHEIV99,
 13501           DFHEIV99
 13502     SET ADDRESS OF CERTIFICATE-MASTER TO
 13503         DFHEIV20
 13504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13505
 13506
 13507     MOVE 'Y'                    TO W-CERT-FOUND-SW.
 13508
 13509 6450-ONLY-STOP.
 13510
 13511     MOVE CM-INSURED-LAST-NAME   TO W-VG-TEXT (108).
 13512
 13513     MOVE CM-BENEFICIARY         TO W-VG-TEXT (109).
 13514
 13515     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13516     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 280
* EL689.cbl
 13517     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13518     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13519     MOVE WS-NAME-WORK           TO W-VG-TEXT (95).
 13520
 13521     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13522     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13523     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13524     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 13525     MOVE WS-NAME-WORK           TO W-VG-TEXT (94).
 13526
 13527     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13528     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13529     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 13530     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13531     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13532     MOVE WS-NAME-WORK           TO W-VG-TEXT (90).
 13533
 13534     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13535     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13536     MOVE SPACES                 TO W-NAME-MIDDLE.
 13537     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13538     MOVE WS-NAME-WORK           TO W-VG-TEXT (104).
 13539
 13540     MOVE CM-INSURED-FIRST-NAME  TO W-VG-TEXT (91).
 13541     MOVE CM-INSURED-INITIAL2    TO W-VG-TEXT (92).
 13542
 13543     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13544     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13545     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13546     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13547     MOVE WS-NAME-WORK           TO W-VG-TEXT (103)
 13548                                    W-LABEL-JOINT-NAME.
 13549
 13550     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13551     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13552     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13553     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 13554     MOVE WS-NAME-WORK           TO W-VG-TEXT (102).
 13555
 13556     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13557     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13558     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 13559     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13560     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13561     MOVE WS-NAME-WORK           TO W-VG-TEXT (99).
 13562
 13563     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13564     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13565     MOVE SPACES                 TO W-NAME-MIDDLE.
 13566     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13567     MOVE WS-NAME-WORK           TO W-VG-TEXT (105).
 13568
 13569     MOVE CM-JT-FIRST-NAME       TO W-VG-TEXT (100).
 13570     MOVE CM-JT-INITIAL          TO W-VG-TEXT (101).
 13571
 13572     COMPUTE W-WORK-AMOUNT
 13573         = CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT.
 13574     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 281
* EL689.cbl
 13575     MOVE W-EDIT-9-2             TO W-VG-TEXT (97).
 13576     MOVE CM-AH-PREMIUM-AMT      TO W-EDIT-7-2.
 13577     MOVE W-EDIT-7-2             TO W-VG-TEXT (98).
 13578
 13579     IF  CM-SEX-FEMAL
 13580         MOVE 'MS.'              TO W-VG-TEXT (96)
 13581
 13582     ELSE
 13583         MOVE 'MR.'              TO W-VG-TEXT (96).
 13584
 13585     MOVE CM-CARRIER OF CERTIFICATE-MASTER
 13586                                 TO W-VG-TEXT (70).
 13587     MOVE CM-GROUPING            TO W-VG-TEXT (71).
 13588     MOVE CM-ACCOUNT             TO W-VG-TEXT (72).
 13589     MOVE CM-CERT-NO             TO W-VG-TEXT (73).
 13590     MOVE CM-INSURED-ISSUE-AGE   TO W-DISPLAY-3.
 13591     MOVE W-DISPLAY-3            TO W-VG-TEXT (83).
 13592     MOVE CM-LOAN-NUMBER         TO W-VG-TEXT (86).
 13593     MOVE CM-LOAN-BALANCE        TO W-EDIT-7-2.
 13594     MOVE W-EDIT-7-2             TO W-VG-TEXT (87).
 13595     MOVE CM-MEMBER-NO           TO W-VG-TEXT (88).
 13596     MOVE CM-SOC-SEC-NO          TO W-VG-TEXT (89).
 13597     MOVE CM-POLICY-FORM-NO      TO W-VG-TEXT (83).
 13598     MOVE CM-LF-ORIG-TERM        TO W-EDIT-3-0.
 13599     MOVE W-EDIT-3-0             TO W-VG-TEXT (77).
 13600     MOVE CM-LF-BENEFIT-AMT      TO W-EDIT-9-2.
 13601     MOVE W-EDIT-9-2             TO W-VG-TEXT (79).
 13602     MOVE CM-AH-ORIG-TERM        TO W-EDIT-3-0.
 13603     MOVE W-EDIT-3-0             TO W-VG-TEXT (78).
 13604     MOVE CM-AH-BENEFIT-AMT      TO W-EDIT-7-2.
 13605     MOVE W-EDIT-7-2             TO W-VG-TEXT (80).
 13606     MOVE CM-AH-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 13607     MOVE W-EDIT-7-2             TO W-VG-TEXT (107).
 13608     MOVE CM-LF-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 13609     MOVE W-EDIT-7-2             TO W-VG-TEXT (106).
 13610     IF PI-689-DATA-SOURCE NOT = '4'
 13611     COMPUTE W-EDIT-7-2 = CM-LF-ITD-CANCEL-AMT
 13612        + CM-AH-ITD-CANCEL-AMT
 13613     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 13614     IF CM-INT-ON-REFS NOT NUMERIC
 13615        MOVE ZEROS               TO CM-INT-ON-REFS
 13616     END-IF
 13617     MOVE CM-INT-ON-REFS         TO W-EDIT-7-2
 13618     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 13619     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
 13620     IF CM-AH-CANCEL-DT > DC-BIN-DATE-1
 13621        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
 13622     END-IF
 13623     MOVE SPACES                 TO DC-OPTION-CODE
 13624     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 13625
 13626     IF NO-CONVERSION-ERROR
 13627        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 13628     END-IF
 13629     END-IF
 13630     COMPUTE W-WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 13631     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
 13632     MOVE W-EDIT-9-2             TO W-VG-TEXT (93).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 282
* EL689.cbl
 13633
 13634     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1.
 13635     MOVE SPACES                 TO DC-OPTION-CODE.
 13636     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13637
 13638     IF  NO-CONVERSION-ERROR
 13639         MOVE DC-GREG-DATE-1-EDIT
 13640                                 TO W-VG-TEXT (81).
 13641
 13642     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1.
 13643     MOVE SPACES                 TO DC-OPTION-CODE.
 13644     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13645
 13646     IF  NO-CONVERSION-ERROR
 13647         MOVE DC-GREG-DATE-1-EDIT
 13648                                 TO W-VG-TEXT (82).
 13649
 13650     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13651     MOVE SPACES                 TO DC-OPTION-CODE.
 13652     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13653
 13654     IF  NO-CONVERSION-ERROR
 13655         MOVE DC-GREG-DATE-1-EDIT
 13656                                 TO W-VG-TEXT (74).
 13657
 13658     MOVE CM-LF-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 13659
 13660     IF  CM-PMT-EXTENSION-DAYS NUMERIC
 13661         MOVE CM-PMT-EXTENSION-DAYS
 13662                                 TO DC-ELAPSED-DAYS
 13663     ELSE
 13664         MOVE ZEROS              TO DC-ELAPSED-DAYS.
 13665
 13666     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13667     MOVE '6'                    TO DC-OPTION-CODE.
 13668     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13669
 13670     IF  NO-CONVERSION-ERROR
 13671         MOVE DC-GREG-DATE-1-EDIT
 13672                                 TO W-VG-TEXT (75).
 13673
 13674     MOVE CM-AH-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 13675     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13676     MOVE '6'                    TO DC-OPTION-CODE.
 13677     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13678
 13679     IF  NO-CONVERSION-ERROR
 13680         MOVE DC-GREG-DATE-1-EDIT
 13681                                 TO W-VG-TEXT (76).
 13682
 13683 6450-EXIT.
 13684     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 283
* EL689.cbl
 13686 6500-GET-ACCOUNT-DATA.
 13687
 13688     IF  ADDRSI EQUAL '1'
 13689             AND
 13690         PI-CREATE-LABELS
 13691             AND
 13692         NOT PI-689-LABELS-OVERRIDEN
 13693         NEXT SENTENCE
 13694     ELSE
 13695         IF  W-FILE-NOT-USED (6)
 13696             GO TO 6500-EXIT
 13697         END-IF
 13698     END-IF.
 13699
 13700 6500-READ-ACCT-ONLY.
 13701
 13702     IF  W-ACCT-ACCOUNT EQUAL LOW-VALUES
 13703         MOVE ER-9327            TO EMI-ERROR
 13704         MOVE -1                 TO MAINTL
 13705         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13706         GO TO 6500-EXIT.
 13707
 13708
 13709* EXEC CICS HANDLE CONDITION
 13710*         NOTOPEN    (8020-ACCT-NOT-OPEN)
 13711*         NOTFND     (6500-ACCT-NOT-FOUND)
 13712*         ENDFILE    (6500-ONLY-STOP)
 13713*    END-EXEC.
 13714*    MOVE '"$JI''                 ! 1 #00012935' TO DFHEIV0
 13715     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 13716     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13717     MOVE X'3120233030303132393335' TO DFHEIV0(25:11)
 13718     CALL 'kxdfhei1' USING DFHEIV0
 13719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13720
 13721
 13722
 13723* EXEC CICS STARTBR
 13724*         RIDFLD     (W-ACCT-KEY)
 13725*         DATASET    (W-ACCT-FILE-ID)
 13726*         KEYLENGTH  (20)
 13727*         GENERIC
 13728*    END-EXEC.
 13729     MOVE 20
 13730       TO DFHEIV11
 13731     MOVE 0
 13732       TO DFHEIV12
 13733*    MOVE '&,   KG    G          &   #00012941' TO DFHEIV0
 13734     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 13735     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13736     MOVE X'2020233030303132393431' TO DFHEIV0(25:11)
 13737     CALL 'kxdfhei1' USING DFHEIV0,
 13738           W-ACCT-FILE-ID,
 13739           W-ACCT-KEY,
 13740           DFHEIV11,
 13741           DFHEIV12,
 13742           DFHEIV99
 13743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 284
* EL689.cbl
 13744
 13745
 13746     MOVE W-ACCT-PARTIAL-KEY     TO W-ACCT-SAVE-KEY.
 13747     MOVE 'Y'                    TO W-ACCT-BROWSE-STARTED-SW.
 13748
 13749 6500-READNEXT.
 13750
 13751
 13752* EXEC CICS READNEXT
 13753*         DATASET    (W-ACCT-FILE-ID)
 13754*         SET        (ADDRESS OF ACCOUNT-MASTER)
 13755*         RIDFLD     (W-ACCT-KEY)
 13756*    END-EXEC.
 13757     MOVE 0
 13758       TO DFHEIV11
 13759*    MOVE '&.S                   )   #00012953' TO DFHEIV0
 13760     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13761     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13762     MOVE X'2020233030303132393533' TO DFHEIV0(25:11)
 13763     CALL 'kxdfhei1' USING DFHEIV0,
 13764           W-ACCT-FILE-ID,
 13765           DFHEIV20,
 13766           DFHEIV99,
 13767           W-ACCT-KEY,
 13768           DFHEIV99,
 13769           DFHEIV11,
 13770           DFHEIV99,
 13771           DFHEIV99
 13772     SET ADDRESS OF ACCOUNT-MASTER TO
 13773         DFHEIV20
 13774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13775
 13776
 13777     IF  W-ACCT-PARTIAL-KEY NOT EQUAL W-ACCT-SAVE-KEY
 13778         IF  PRIOR-MATCH-ACCT-PKEY
 13779             CONTINUE
 13780*            GO TO 6500-ONLY-STOP
 13781         ELSE
 13782             IF  W-FILE-NOT-USED (6)
 13783                 PERFORM 6500-ENDBR
 13784                 GO TO 6500-EXIT
 13785             ELSE
 13786                 GO TO 6500-ACCT-NOT-FOUND
 13787             END-IF
 13788         END-IF
 13789     ELSE
 13790         SET PRIOR-MATCH-ACCT-PKEY TO TRUE
 13791         MOVE AM-CARRIER           TO WS-SAV-AM-CARRIER
 13792         MOVE AM-ACCOUNT           TO WS-SAV-AM-ACCOUNT
 13793         MOVE AM-DEFN-1            TO WS-SAV-AM-DEFN-1
 13794         MOVE AM-REMIT-TO          TO WS-SAV-AM-REMIT-TO
 13795         MOVE AM-NAME              TO WS-SAV-AM-NAME
 13796         MOVE AM-PERSON            TO WS-SAV-AM-PERSON
 13797         MOVE AM-ADDRS             TO WS-SAV-AM-ADDRS
 13798         MOVE SPACES               TO WS-SAV-AM-CITY
 13799*        MOVE AM-CITY              TO WS-SAV-AM-CITY
 13800         STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 13801            DELIMITED BY '  ' INTO WS-SAV-AM-CITY
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 285
* EL689.cbl
 13802         END-STRING
 13803         MOVE AM-ZIP               TO WS-SAV-AM-ZIP
 13804         MOVE AM-TEL-NO            TO WS-SAV-AM-TEL-NO
 13805         MOVE AM-CONTROL-NAME      TO WS-SAV-AM-CONTROL-NAME
 13806         MOVE AM-CSR-CODE          TO WS-SAV-AM-CSR-CODE
 13807         MOVE AM-ACCOUNT           TO WS-SAV-AM-ERACCT-ACCOUNT
 13808         GO TO 6500-READNEXT
 13809     END-IF
 13810     .
 13811 6500-ONLY-STOP.
 13812
 13813     IF  NOT PI-NO-CARRIER-SECURITY
 13814             AND
 13815         PI-CARRIER-SECURITY NOT = WS-SAV-AM-CARRIER
 13816         MOVE -1                 TO CARRIERL
 13817         MOVE AL-UANON           TO CARRIERA
 13818         MOVE ER-9095            TO EMI-ERROR
 13819         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13820         PERFORM 6500-ENDBR
 13821         GO TO 8200-SEND-DATAONLY.
 13822
 13823     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13824     MOVE WS-SAV-AM-NAME         TO W-LABEL-LINES (1).
 13825     MOVE WS-SAV-AM-PERSON       TO W-LABEL-LINES (2).
 13826     MOVE WS-SAV-AM-ADDRS        TO W-LABEL-LINES (3).
 13827     MOVE WS-SAV-AM-CITY         TO W-LABEL-LINES (4).
 13828
 13829     MOVE WS-SAV-AM-ZIP          TO W-WORK-ZIP.
 13830     MOVE SPACES                 TO W-LABEL-ZIP (5).
 13831
 13832     IF  SAVE-AM-CANADIAN-POST-CODE
 13833         MOVE WS-SAV-AM-CANADIAN-POSTAL-CODE
 13834                                 TO W-CANADIAN-POSTAL-CODES
 13835         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 13836         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 13837         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 13838                                    W-LAB-CAN-FILLER (5)
 13839     ELSE
 13840         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 13841
 13842         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13843             MOVE '-'            TO W-LABEL-DASH (5)
 13844             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 13845         ELSE
 13846             MOVE SPACES         TO W-LABEL-DASH (5)
 13847                                    W-LABEL-2ND-ZIP (5).
 13848
 13849     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13850
 13851     IF  ADDRSI EQUAL '1'
 13852             AND
 13853         PI-CREATE-LABELS
 13854             AND
 13855         NOT PI-689-LABELS-OVERRIDEN
 13856         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13857                                    W-VG-TEXT (40)
 13858         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13859                                    W-VG-TEXT (41)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 286
* EL689.cbl
 13860         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13861                                    W-VG-TEXT (42)
 13862         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13863                                    W-VG-TEXT (43)
 13864         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13865                                    W-VG-TEXT (44)
 13866         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13867                                    W-VG-TEXT (45)
 13868         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13869         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13870         SET W-RG-NDX UP BY +1
 13871     ELSE
 13872         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (40)
 13873         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (41)
 13874         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (42)
 13875         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (43)
 13876         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (44)
 13877         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (45).
 13878
 13879     IF  WS-SAV-AM-TEL-NO NOT NUMERIC
 13880             OR
 13881         WS-SAV-AM-TEL-NO EQUAL ZEROS
 13882         MOVE SPACES             TO W-VG-TEXT (46)
 13883     ELSE
 13884         MOVE ZEROS                  TO W-PHONE-IN
 13885         MOVE WS-SAV-AM-AREA-CODE    TO W-PO-AREA
 13886         MOVE WS-SAV-AM-TEL-PRE      TO W-PO-PFX
 13887         MOVE WS-SAV-AM-TEL-NBR      TO W-PO-SFX
 13888         MOVE W-PHONE-OUT            TO W-VG-TEXT (46).
 13889
 13890     IF WS-SAV-AM-CONTROL-NAME (1:1) NOT = LOW-VALUES
 13891        MOVE WS-SAV-AM-CONTROL-NAME  TO W-VG-TEXT (47)
 13892     ELSE
 13893        MOVE SPACES                   TO W-VG-TEXT (47)
 13894     END-IF.
 13895     MOVE WS-SAV-AM-CSR-CODE     TO W-VG-TEXT (48)
 13896     MOVE WS-SAV-AM-ERACCT-ACCOUNT
 13897                                 TO W-VG-TEXT (49)
 13898
 13899     MOVE WS-SAV-AM-ACCOUNT      TO W-VG-TEXT (72)
 13900     PERFORM 6500-ENDBR.
 13901
 13902     GO TO 6500-EXIT.
 13903
 13904 6500-ENDBR.
 13905
 13906     IF  W-ACCT-BROWSE-STARTED
 13907         MOVE 'N'                TO W-ACCT-BROWSE-STARTED-SW
 13908
 13909* EXEC CICS ENDBR
 13910*            DATASET (W-ACCT-FILE-ID)
 13911*        END-EXEC
 13912     MOVE 0
 13913       TO DFHEIV11
 13914*    MOVE '&2                    $   #00013090' TO DFHEIV0
 13915     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13916     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13917     MOVE X'2020233030303133303930' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 287
* EL689.cbl
 13918     CALL 'kxdfhei1' USING DFHEIV0,
 13919           W-ACCT-FILE-ID,
 13920           DFHEIV11,
 13921           DFHEIV99
 13922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13923     END-IF.
 13924
 13925 6500-ACCT-NOT-FOUND.
 13926
 13927     PERFORM 6500-ENDBR.
 13928
 13929     IF  DATASORI NOT EQUAL '1'
 13930         MOVE ER-0179            TO EMI-ERROR
 13931         GO TO 6500-EXIT.
 13932
 13933     MOVE ER-0179                TO EMI-ERROR.
 13934     MOVE -1                     TO MAINTL.
 13935     MOVE AL-UNBON               TO MAINTA.
 13936     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13937     GO TO 8200-SEND-DATAONLY.
 13938
 13939 6500-EXIT.
 13940     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 288
* EL689.cbl
 13942 6600-GET-COMPENSATION-DATA.
 13943
 13944     IF  ADDRSI EQUAL '4'
 13945             AND
 13946         PI-CREATE-LABELS
 13947             AND
 13948         NOT PI-689-LABELS-OVERRIDEN
 13949         NEXT SENTENCE
 13950     ELSE
 13951         IF  W-FILE-NOT-USED (10)
 13952             GO TO 6600-EXIT.
 13953
 13954     IF  W-COMP-RESP-PERSON GREATER THAN LOW-VALUES
 13955         MOVE W-COMP-KEY         TO W-COMP-SAVE-KEY
 13956         GO TO 6600-START.
 13957
 13958     IF  PI-ZERO-CARRIER
 13959             OR
 13960         PI-ZERO-CAR-GROUP
 13961         MOVE ZEROS              TO W-COMP-CARRIER.
 13962
 13963     IF  PI-ZERO-GROUPING
 13964             OR
 13965         PI-ZERO-CAR-GROUP
 13966         MOVE ZEROS              TO W-COMP-GROUPING.
 13967
 13968     IF  W-FILE-NOT-USED (6)
 13969         PERFORM 6500-READ-ACCT-ONLY THRU 6500-READNEXT
 13970         IF  EMI-ERROR EQUAL ER-0179
 13971             MOVE ER-9327        TO EMI-ERROR
 13972             MOVE -1             TO MAINTL
 13973             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13974             GO TO 6600-EXIT.
 13975
 13976     MOVE  'A'                   TO W-COMP-TYPE.
 13977
 13978     IF  WS-SAV-AM-REMIT-TO GREATER THAN ZEROS
 13979         MOVE WS-SAV-AM-AGT (WS-SAV-AM-REMIT-TO)
 13980                                 TO W-COMP-RESP-PERSON
 13981     ELSE
 13982         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 13983
 13984     PERFORM VARYING W-NDX FROM +1 BY +1 UNTIL
 13985        (W-NDX > +10)
 13986            OR
 13987         (WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'F')
 13988     END-PERFORM
 13989
 13990     IF  WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'F'
 13991         MOVE WS-SAV-AM-AGT (W-NDX)  TO W-COMP-ACCOUNT
 13992     ELSE
 13993         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 13994
 13995     PERFORM 6500-ENDBR.
 13996     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 13997
 13998     IF  W-COMP-RESP-PERSON EQUAL LOW-VALUES
 13999         MOVE ER-9327            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 289
* EL689.cbl
 14000         MOVE -1                 TO MAINTL
 14001         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14002         GO TO 6600-EXIT.
 14003
 14004 6600-START.
 14005
 14006
 14007* EXEC CICS HANDLE CONDITION
 14008*         NOTOPEN (8080-COMP-NOT-OPEN)
 14009*         NOTFND  (6600-COMP-NOT-FOUND)
 14010*    END-EXEC.
 14011*    MOVE '"$JI                  ! 2 #00013176' TO DFHEIV0
 14012     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14013     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14014     MOVE X'3220233030303133313736' TO DFHEIV0(25:11)
 14015     CALL 'kxdfhei1' USING DFHEIV0
 14016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14017
 14018
 14019
 14020* EXEC CICS STARTBR
 14021*         RIDFLD  (W-COMP-KEY)
 14022*         DATASET (W-COMP-FILE-ID)
 14023*    END-EXEC.
 14024     MOVE 0
 14025       TO DFHEIV11
 14026*    MOVE '&,         G          &   #00013181' TO DFHEIV0
 14027     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14028     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14029     MOVE X'2020233030303133313831' TO DFHEIV0(25:11)
 14030     CALL 'kxdfhei1' USING DFHEIV0,
 14031           W-COMP-FILE-ID,
 14032           W-COMP-KEY,
 14033           DFHEIV99,
 14034           DFHEIV11,
 14035           DFHEIV99
 14036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14037
 14038
 14039     MOVE 'Y'                    TO W-COMP-BROWSE-SW.
 14040
 14041 6600-READNEXT.
 14042
 14043
 14044* EXEC CICS READNEXT
 14045*         DATASET (W-COMP-FILE-ID)
 14046*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14047*         RIDFLD  (W-COMP-KEY)
 14048*    END-EXEC.
 14049     MOVE 0
 14050       TO DFHEIV11
 14051*    MOVE '&.S                   )   #00013190' TO DFHEIV0
 14052     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14053     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14054     MOVE X'2020233030303133313930' TO DFHEIV0(25:11)
 14055     CALL 'kxdfhei1' USING DFHEIV0,
 14056           W-COMP-FILE-ID,
 14057           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 290
* EL689.cbl
 14058           DFHEIV99,
 14059           W-COMP-KEY,
 14060           DFHEIV99,
 14061           DFHEIV11,
 14062           DFHEIV99,
 14063           DFHEIV99
 14064     SET ADDRESS OF COMPENSATION-MASTER TO
 14065         DFHEIV20
 14066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14067
 14068
 14069     IF CO-CONTROL-PRIMARY
 14070           NOT = W-COMP-SAVE-KEY
 14071        GO TO 6600-COMP-NOT-FOUND.
 14072
 14073     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14074     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1)
 14075                                    W-VG-TEXT (140).
 14076     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14077     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14078     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14079*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14080     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14081        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14082     END-STRING
 14083
 14084     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14085
 14086     IF  CO-CANADIAN-POST-CODE
 14087         MOVE CO-CANADIAN-POSTAL-CODE
 14088                                 TO W-CANADIAN-POSTAL-CODES
 14089         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14090         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14091         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14092                                    W-LAB-CAN-FILLER (6)
 14093     ELSE
 14094         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14095
 14096         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14097             MOVE '-'            TO W-LABEL-DASH (6)
 14098             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14099         ELSE
 14100             MOVE SPACES         TO W-LABEL-DASH (6)
 14101                                    W-LABEL-2ND-ZIP (6).
 14102
 14103     IF  CO-TELEPHONE NOT NUMERIC
 14104             OR
 14105         CO-TELEPHONE = ZEROS
 14106         MOVE SPACES             TO W-VG-TEXT (147)
 14107     ELSE
 14108         MOVE ZEROS              TO W-PHONE-IN
 14109         MOVE CO-AREA-CODE       TO W-PO-AREA
 14110         MOVE CO-PREFIX          TO W-PO-PFX
 14111         MOVE CO-PHONE           TO W-PO-SFX
 14112         MOVE W-PHONE-OUT        TO W-VG-TEXT (147).
 14113
 14114     IF (CO-FAXNO NOT NUMERIC)
 14115        OR (CO-FAXNO = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 291
* EL689.cbl
 14116        MOVE SPACES              TO W-VG-TEXT (182)
 14117     ELSE
 14118        MOVE ZEROS               TO W-PHONE-IN
 14119        MOVE CO-FAX-AREA-CODE    TO W-PO-AREA
 14120        MOVE CO-FAX-PREFIX       TO W-PO-PFX
 14121        MOVE CO-FAX-PHONE        TO W-PO-SFX
 14122        MOVE W-PHONE-OUT         TO W-VG-TEXT (182)
 14123     END-IF
 14124     IF CO-GA-STATUS-CODE NOT = 'A' AND 'I' AND 'P'
 14125        MOVE SPACES              TO W-VG-TEXT (183)
 14126     ELSE
 14127        EVALUATE CO-GA-STATUS-CODE
 14128           WHEN 'A'
 14129              MOVE 'ACTIVE'      TO W-VG-TEXT (183)
 14130           WHEN 'I'
 14131              MOVE 'INACTIVE'    TO W-VG-TEXT (183)
 14132           WHEN 'P'
 14133              MOVE 'PENDING'     TO W-VG-TEXT (183)
 14134        END-EVALUATE
 14135     END-IF
 14136     IF CO-BILL-SW NOT = 'B' AND 'R' AND 'T' AND 'S'
 14137        MOVE SPACES              TO W-VG-TEXT (181)
 14138     ELSE
 14139        EVALUATE CO-BILL-SW
 14140           WHEN 'B'
 14141              MOVE 'BILLED'      TO W-VG-TEXT (181)
 14142           WHEN 'R'
 14143              MOVE 'REMIT'       TO W-VG-TEXT (181)
 14144           WHEN 'T'
 14145              MOVE 'T'           TO W-VG-TEXT (181)
 14146           WHEN 'S'
 14147              MOVE 'S'           TO W-VG-TEXT (181)
 14148        END-EVALUATE
 14149     END-IF
 14150     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14151
 14152     IF  ADDRSI EQUAL '4'
 14153             AND
 14154         PI-CREATE-LABELS
 14155             AND
 14156         NOT PI-689-LABELS-OVERRIDEN
 14157         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14158                                    W-VG-TEXT (141)
 14159         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14160                                    W-VG-TEXT (142)
 14161         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14162                                    W-VG-TEXT (143)
 14163         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14164                                    W-VG-TEXT (144)
 14165         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14166                                    W-VG-TEXT (145)
 14167         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14168                                    W-VG-TEXT (146)
 14169         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14170         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14171         SET W-RG-NDX UP BY +1
 14172     ELSE
 14173         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (141)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 292
* EL689.cbl
 14174         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (142)
 14175         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (143)
 14176         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (144)
 14177         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (145)
 14178         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (146).
 14179
 14180     PERFORM 6630-GET-CSR-NAME THRU 6630-EXIT.
 14181
 14182     MOVE CO-RESP-NO             TO W-VG-TEXT (180).
 14183     MOVE CO-END-BAL             TO W-EDIT-7-2-NEGATIVE.
 14184     MOVE W-EDIT-7-2-NEGATIVE    TO W-VG-TEXT (150).
 14185
 14186     MOVE CO-LAST-STMT-DT        TO DC-GREG-DATE-1-YMD.
 14187     MOVE '3'                    TO DC-OPTION-CODE.
 14188     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 14189
 14190     IF  NO-CONVERSION-ERROR
 14191         MOVE DC-GREG-DATE-1-ALPHA
 14192                                 TO W-VG-TEXT (149).
 14193
 14194     PERFORM 6620-GET-G-DATA THRU 6620-EXIT.
 14195     PERFORM 6626-GET-B-DATA     THRU 6626-EXIT
 14196
 14197     PERFORM 6600-ENDBR.
 14198     GO TO 6600-EXIT.
 14199
 14200 6600-ENDBR.
 14201
 14202     IF  W-COMP-BROWSE-STARTED
 14203         MOVE 'N'                      TO W-COMP-BROWSE-SW
 14204
 14205* EXEC CICS ENDBR
 14206*             DATASET(W-COMP-FILE-ID)
 14207*        END-EXEC.
 14208     MOVE 0
 14209       TO DFHEIV11
 14210*    MOVE '&2                    $   #00013331' TO DFHEIV0
 14211     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14212     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14213     MOVE X'2020233030303133333331' TO DFHEIV0(25:11)
 14214     CALL 'kxdfhei1' USING DFHEIV0,
 14215           W-COMP-FILE-ID,
 14216           DFHEIV11,
 14217           DFHEIV99
 14218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14219
 14220
 14221 6600-COMP-NOT-FOUND.
 14222
 14223     PERFORM 6600-ENDBR.
 14224
 14225     IF ADDRSL GREATER ZERO
 14226         IF ADDRSI = '4'
 14227            IF PI-689-TYPE EQUAL LOW-VALUES OR SPACES
 14228                MOVE ER-7378                TO EMI-ERROR
 14229                MOVE -1                     TO TYPEL
 14230                MOVE AL-UNBON               TO TYPEA
 14231                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 293
* EL689.cbl
 14232                GO TO 8200-SEND-DATAONLY
 14233            ELSE
 14234                MOVE ER-2114                TO EMI-ERROR
 14235                MOVE -1                     TO ADDRSL
 14236                MOVE AL-UNBON               TO ADDRSA
 14237                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14238                GO TO 8200-SEND-DATAONLY.
 14239
 14240 6600-EXIT.
 14241     EXIT.
 14242 6620-GET-G-DATA.
 14243
 14244     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY.
 14245
 14246     IF  CO-RPTCD2 GREATER THAN SPACES
 14247         MOVE SPACES             TO W-COMP-RESP-PERSON
 14248         MOVE CO-RPTCD2          TO W-COMP-WORK-AREA
 14249         MOVE +10                TO W-CWA-NDX
 14250         PERFORM 6622-FIND-LAST-NON-SPACE
 14251         SET W-COMP-NDX          TO +10
 14252         PERFORM 6625-FILL-IN-RESP-PERSON.
 14253         INSPECT W-COMP-RESP-PERSON CONVERTING SPACES TO ZEROS.
 14254
 14255     MOVE LOW-VALUES             TO W-COMP-ACCOUNT.
 14256     MOVE 'G'                    TO W-COMP-TYPE.
 14257     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 14258
 14259
 14260* EXEC CICS RESETBR
 14261*         RIDFLD  (W-COMP-KEY)
 14262*         DATASET (W-COMP-FILE-ID)
 14263*    END-EXEC.
 14264     MOVE 0
 14265       TO DFHEIV11
 14266*    MOVE '&4         G          &   #00013373' TO DFHEIV0
 14267     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 14268     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14269     MOVE X'2020233030303133333733' TO DFHEIV0(25:11)
 14270     CALL 'kxdfhei1' USING DFHEIV0,
 14271           W-COMP-FILE-ID,
 14272           W-COMP-KEY,
 14273           DFHEIV99,
 14274           DFHEIV11,
 14275           DFHEIV99
 14276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14277
 14278
 14279
 14280* EXEC CICS READNEXT
 14281*         DATASET (W-COMP-FILE-ID)
 14282*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14283*         RIDFLD  (W-COMP-KEY)
 14284*    END-EXEC.
 14285     MOVE 0
 14286       TO DFHEIV11
 14287*    MOVE '&.S                   )   #00013378' TO DFHEIV0
 14288     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14289     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 294
* EL689.cbl
 14290     MOVE X'2020233030303133333738' TO DFHEIV0(25:11)
 14291     CALL 'kxdfhei1' USING DFHEIV0,
 14292           W-COMP-FILE-ID,
 14293           DFHEIV20,
 14294           DFHEIV99,
 14295           W-COMP-KEY,
 14296           DFHEIV99,
 14297           DFHEIV11,
 14298           DFHEIV99,
 14299           DFHEIV99
 14300     SET ADDRESS OF COMPENSATION-MASTER TO
 14301         DFHEIV20
 14302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14303
 14304
 14305     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 14306         GO TO 6620-EXIT.
 14307
 14308     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14309     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 14310     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14311     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14312     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14313*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14314     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14315        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14316     END-STRING
 14317
 14318     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14319
 14320     IF  CO-CANADIAN-POST-CODE
 14321         MOVE CO-CANADIAN-POSTAL-CODE
 14322                                 TO W-CANADIAN-POSTAL-CODES
 14323         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14324         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14325         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14326                                    W-LAB-CAN-FILLER (6)
 14327     ELSE
 14328         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14329         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14330             MOVE '-'            TO W-LABEL-DASH (6)
 14331             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14332         ELSE
 14333             MOVE SPACES         TO W-LABEL-DASH (6)
 14334                                    W-LABEL-2ND-ZIP (6).
 14335
 14336     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14337
 14338     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (174).
 14339     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (175).
 14340     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (176).
 14341     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (177).
 14342     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (178).
 14343     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (179).
 14344
 14345 6620-EXIT.
 14346     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 295
* EL689.cbl
 14348 6622-FIND-LAST-NON-SPACE.
 14349
 14350     IF  W-CWA-CHAR (W-CWA-NDX) EQUAL SPACES
 14351         SUBTRACT +1 FROM W-CWA-NDX
 14352         GO TO 6622-FIND-LAST-NON-SPACE.
 14353
 14354 6622-EXIT.
 14355     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 296
* EL689.cbl
 14357 6625-FILL-IN-RESP-PERSON.
 14358
 14359     MOVE W-CWA-CHAR (W-CWA-NDX) TO W-COMP-RP-CHAR (W-COMP-NDX)
 14360     SET W-COMP-NDX DOWN BY +1.
 14361     SUBTRACT +1 FROM W-CWA-NDX.
 14362
 14363     IF  W-CWA-NDX GREATER THAN ZEROS
 14364         GO TO 6625-FILL-IN-RESP-PERSON.
 14365
 14366 6625-EXIT.
 14367     EXIT.
 14368 6626-GET-B-DATA.
 14369     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY
 14370     IF W-FILE-USED (8)
 14371        PERFORM 6450-READ-CERT-ONLY
 14372        IF W-CERT-FOUND
 14373           MOVE CM-BENEFICIARY (1:10)
 14374                                 TO W-COMP-RESP-PERSON
 14375        ELSE
 14376           MOVE SPACES           TO W-COMP-RESP-PERSON
 14377           GO TO 6626-EXIT
 14378        END-IF
 14379     ELSE
 14380        MOVE CM-BENEFICIARY (1:10)
 14381                                 TO W-COMP-RESP-PERSON
 14382     END-IF
 14383     MOVE LOW-VALUES             TO W-COMP-ACCOUNT
 14384     MOVE 'B'                    TO W-COMP-TYPE
 14385     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY
 14386
 14387
 14388* EXEC CICS RESETBR
 14389*         RIDFLD  (W-COMP-KEY)
 14390*         DATASET (W-COMP-FILE-ID)
 14391*    END-EXEC.
 14392     MOVE 0
 14393       TO DFHEIV11
 14394*    MOVE '&4         G          &   #00013466' TO DFHEIV0
 14395     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 14396     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14397     MOVE X'2020233030303133343636' TO DFHEIV0(25:11)
 14398     CALL 'kxdfhei1' USING DFHEIV0,
 14399           W-COMP-FILE-ID,
 14400           W-COMP-KEY,
 14401           DFHEIV99,
 14402           DFHEIV11,
 14403           DFHEIV99
 14404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14405
 14406
 14407
 14408* EXEC CICS READNEXT
 14409*         DATASET (W-COMP-FILE-ID)
 14410*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14411*         RIDFLD  (W-COMP-KEY)
 14412*    END-EXEC.
 14413     MOVE 0
 14414       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 297
* EL689.cbl
 14415*    MOVE '&.S                   )   #00013471' TO DFHEIV0
 14416     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14417     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14418     MOVE X'2020233030303133343731' TO DFHEIV0(25:11)
 14419     CALL 'kxdfhei1' USING DFHEIV0,
 14420           W-COMP-FILE-ID,
 14421           DFHEIV20,
 14422           DFHEIV99,
 14423           W-COMP-KEY,
 14424           DFHEIV99,
 14425           DFHEIV11,
 14426           DFHEIV99,
 14427           DFHEIV99
 14428     SET ADDRESS OF COMPENSATION-MASTER TO
 14429         DFHEIV20
 14430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14431
 14432
 14433     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 14434         GO TO 6626-EXIT.
 14435
 14436     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14437     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 14438     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14439     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14440     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14441*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14442     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14443        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14444     END-STRING
 14445
 14446     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14447
 14448     IF  CO-CANADIAN-POST-CODE
 14449         MOVE CO-CANADIAN-POSTAL-CODE
 14450                                 TO W-CANADIAN-POSTAL-CODES
 14451         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14452         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14453         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14454                                    W-LAB-CAN-FILLER (6)
 14455     ELSE
 14456         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14457         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14458             MOVE '-'            TO W-LABEL-DASH (6)
 14459             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14460         ELSE
 14461             MOVE SPACES         TO W-LABEL-DASH (6)
 14462                                    W-LABEL-2ND-ZIP (6).
 14463
 14464     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14465
 14466     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (184).
 14467     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (185).
 14468     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (186).
 14469     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (187).
 14470     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (188).
 14471     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (189).
 14472
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 298
* EL689.cbl
 14473 6626-EXIT.
 14474     EXIT.
 14475 6630-GET-CSR-NAME.
 14476
 14477     MOVE SPACES                 TO W-CNTL-KEY.
 14478     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 14479     MOVE +0                     TO W-CNTL-SEQ-NO.
 14480     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 14481     MOVE CO-CSR-CODE            TO W-CNTL-GENL.
 14482
 14483
 14484* EXEC CICS HANDLE CONDITION
 14485*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 14486*         NOTFND     (6630-CNTL2-NOT-FOUND)
 14487*    END-EXEC.
 14488*    MOVE '"$JI                  ! 3 #00013527' TO DFHEIV0
 14489     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14490     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14491     MOVE X'3320233030303133353237' TO DFHEIV0(25:11)
 14492     CALL 'kxdfhei1' USING DFHEIV0
 14493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14494
 14495
 14496
 14497* EXEC CICS READ
 14498*         DATASET    (W-CNTL-FILE-ID)
 14499*         SET        (ADDRESS OF CONTROL-FILE)
 14500*         RIDFLD     (W-CNTL-KEY)
 14501*    END-EXEC.
 14502*    MOVE '&"S        E          (   #00013532' TO DFHEIV0
 14503     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14504     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14505     MOVE X'2020233030303133353332' TO DFHEIV0(25:11)
 14506     CALL 'kxdfhei1' USING DFHEIV0,
 14507           W-CNTL-FILE-ID,
 14508           DFHEIV20,
 14509           DFHEIV99,
 14510           W-CNTL-KEY,
 14511           DFHEIV99,
 14512           DFHEIV99,
 14513           DFHEIV99
 14514     SET ADDRESS OF CONTROL-FILE TO
 14515         DFHEIV20
 14516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14517
 14518
 14519     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (148).
 14520     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 14521     GO TO 6630-EXIT.
 14522
 14523 6630-CNTL2-NOT-FOUND.
 14524
 14525*    MOVE ER-8965                TO EMI-ERROR.
 14526*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14527*    MOVE -1                     TO MAINTL.
 14528*    MOVE AL-UANON               TO MAINTA.
 14529*    GO TO 8200-SEND-DATAONLY
 14530     .
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 299
* EL689.cbl
 14531 6630-EXIT.
 14532     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 300
* EL689.cbl
 14534 6700-GET-MAIL-DATA.
 14535
 14536     IF  ADDRSI EQUAL '5'
 14537             AND
 14538         PI-CREATE-LABELS
 14539             AND
 14540         NOT PI-689-LABELS-OVERRIDEN
 14541         NEXT SENTENCE
 14542     ELSE
 14543         IF  W-FILE-NOT-USED (5)
 14544             GO TO 6700-EXIT.
 14545
 14546     IF  W-MAIL-CERT-NO EQUAL LOW-VALUES
 14547         MOVE ER-9327            TO EMI-ERROR
 14548         MOVE -1                 TO MAINTL
 14549         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14550         GO TO 6700-EXIT.
 14551
 14552
 14553* EXEC CICS HANDLE CONDITION
 14554*         NOTOPEN (8090-MAIL-NOT-OPEN)
 14555*         NOTFND  (6700-MAIL-NOT-FOUND)
 14556*    END-EXEC.
 14557*    MOVE '"$JI                  ! 4 #00013571' TO DFHEIV0
 14558     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14559     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14560     MOVE X'3420233030303133353731' TO DFHEIV0(25:11)
 14561     CALL 'kxdfhei1' USING DFHEIV0
 14562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14563
 14564
 14565
 14566* EXEC CICS READ
 14567*         DATASET(W-MAIL-FILE-ID)
 14568*         SET    (ADDRESS OF MAILING-DATA)
 14569*         RIDFLD (W-MAIL-KEY)
 14570*    END-EXEC.
 14571*    MOVE '&"S        E          (   #00013576' TO DFHEIV0
 14572     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14573     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14574     MOVE X'2020233030303133353736' TO DFHEIV0(25:11)
 14575     CALL 'kxdfhei1' USING DFHEIV0,
 14576           W-MAIL-FILE-ID,
 14577           DFHEIV20,
 14578           DFHEIV99,
 14579           W-MAIL-KEY,
 14580           DFHEIV99,
 14581           DFHEIV99,
 14582           DFHEIV99
 14583     SET ADDRESS OF MAILING-DATA TO
 14584         DFHEIV20
 14585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14586
 14587
 14588     MOVE MA-INSURED-LAST-NAME   TO W-NAME-LAST.
 14589     MOVE MA-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 14590     MOVE MA-INSURED-MIDDLE-INIT TO W-NAME-MIDDLE.
 14591     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 301
* EL689.cbl
 14592
 14593     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14594     MOVE WS-NAME-WORK           TO W-LABEL-LINES (1).
 14595     MOVE W-LABEL-JOINT-NAME     TO W-LABEL-LINES (2).
 14596     MOVE MA-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 14597     MOVE MA-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 14598*    MOVE MA-CITY-STATE          TO W-LABEL-LINES (5).
 14599     STRING MA-CITY ' ' MA-ADDR-STATE
 14600        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14601     END-STRING
 14602
 14603     MOVE MA-ZIP                 TO W-WORK-ZIP.
 14604     MOVE SPACES                 TO W-LABEL-ZIP (6).
 14605
 14606     IF  MA-CANADIAN-POST-CODE
 14607         MOVE MA-CANADIAN-POSTAL-CODE
 14608                                 TO W-CANADIAN-POSTAL-CODES
 14609         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14610         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14611         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14612                                    W-LAB-CAN-FILLER (6)
 14613     ELSE
 14614         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14615         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14616             MOVE '-'            TO W-LABEL-DASH (6)
 14617             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14618         ELSE
 14619             MOVE SPACES         TO W-LABEL-DASH (6)
 14620                                    W-LABEL-2ND-ZIP (6).
 14621
 14622     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14623
 14624     IF  ADDRSI EQUAL '5'
 14625             AND
 14626         PI-CREATE-LABELS
 14627             AND
 14628         NOT PI-689-LABELS-OVERRIDEN
 14629         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14630                                    W-VG-TEXT (31)
 14631         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14632                                    W-VG-TEXT (32)
 14633         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14634                                    W-VG-TEXT (33)
 14635         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14636                                    W-VG-TEXT (34)
 14637         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14638                                    W-VG-TEXT (35)
 14639         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14640                                    W-VG-TEXT (36)
 14641         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14642         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14643         SET W-RG-NDX UP BY +1
 14644     ELSE
 14645         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (31)
 14646         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (32)
 14647         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (33)
 14648         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (34)
 14649         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (35)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 302
* EL689.cbl
 14650         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (36).
 14651     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14652     MOVE MA-CRED-BENE-NAME      TO W-LABEL-LINES (1)
 14653     MOVE MA-CRED-BENE-ADDR      TO W-LABEL-LINES (2)
 14654     MOVE MA-CRED-BENE-ADDR2     TO W-LABEL-LINES (3)
 14655     STRING MA-CRED-BENE-CITY ' ' MA-CRED-BENE-STATE
 14656        DELIMITED BY '  ' INTO W-LABEL-LINES (4)
 14657     END-STRING
 14658
 14659     MOVE MA-CRED-BENE-ZIP       TO W-WORK-ZIP
 14660     MOVE SPACES                 TO W-LABEL-ZIP (5)
 14661
 14662     IF  MA-CB-CANADIAN-POST-CODE
 14663         MOVE MA-CB-CANADIAN-POSTAL-CODE
 14664                                 TO W-CANADIAN-POSTAL-CODES
 14665         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 14666         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 14667         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 14668                                    W-LAB-CAN-FILLER (5)
 14669     ELSE
 14670         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 14671         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14672             MOVE '-'            TO W-LABEL-DASH (5)
 14673             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 14674         ELSE
 14675             MOVE SPACES         TO W-LABEL-DASH (5)
 14676                                    W-LABEL-2ND-ZIP (5)
 14677         END-IF
 14678     END-IF
 14679     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT
 14680     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (37)
 14681     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (50)
 14682     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (51)
 14683     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (52)
 14684     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (53)
 14685     GO TO 6700-EXIT.
 14686
 14687 6700-MAIL-NOT-FOUND.
 14688
 14689     IF  ADDRSL GREATER ZERO
 14690         IF ADDRSI = '5'
 14691            MOVE ER-3000         TO EMI-ERROR
 14692            MOVE -1              TO ADDRSL
 14693            MOVE AL-UNBON        TO ADDRSA
 14694            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14695            GO TO 8200-SEND-DATAONLY.
 14696
 14697 6700-EXIT.
 14698     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 303
* EL689.cbl
 14700 6750-GET-LIFE-BENEFIT-DATA.
 14701
 14702     IF  W-FILE-NOT-USED (2)
 14703         GO TO 6750-EXIT.
 14704
 14705     MOVE SPACES                 TO W-CNTL-GEN2.
 14706
 14707     IF  DATASORI EQUAL '2'
 14708         IF  W-FILE-NOT-USED (8)
 14709             PERFORM 6450-READ-CERT-ONLY
 14710             IF  W-CERT-FOUND
 14711                 MOVE CM-LF-BENEFIT-CD
 14712                                 TO W-BEN-HOLD
 14713                                    W-CNTL-GEN2
 14714             ELSE
 14715                 NEXT SENTENCE
 14716         ELSE
 14717             MOVE CM-LF-BENEFIT-CD
 14718                                 TO W-BEN-HOLD
 14719                                    W-CNTL-GEN2
 14720     ELSE
 14721         IF  DATASORI EQUAL '4'
 14722             IF  W-FILE-NOT-USED (9)
 14723                 PERFORM 6400-READ-PNDB-ONLY
 14724                 IF  W-PNDB-FOUND
 14725                     IF  PI-689-TYPE = '1'
 14726                         MOVE PB-I-LF-BENEFIT-CD
 14727                                 TO W-BEN-HOLD
 14728                                    W-CNTL-GEN2
 14729                     ELSE
 14730                         MOVE PB-CI-LF-BENEFIT-CD
 14731                                 TO W-BEN-HOLD
 14732                                    W-CNTL-GEN2
 14733             ELSE
 14734                 NEXT SENTENCE
 14735         ELSE
 14736             IF  W-FILE-USED (8)
 14737                 MOVE CM-LF-BENEFIT-CD
 14738                                 TO W-BEN-HOLD
 14739                                    W-CNTL-GEN2
 14740             ELSE
 14741                 IF  W-FILE-USED (9)
 14742                     IF  PI-689-TYPE = '1'
 14743                         MOVE PB-I-LF-BENEFIT-CD
 14744                                 TO W-BEN-HOLD
 14745                                    W-CNTL-GEN2
 14746                     ELSE
 14747                         MOVE PB-CI-LF-BENEFIT-CD
 14748                                 TO W-BEN-HOLD
 14749                                    W-CNTL-GEN2.
 14750
 14751     IF  W-CNTL-GEN2 EQUAL SPACES
 14752         MOVE ER-9327            TO EMI-ERROR
 14753         MOVE -1                 TO MAINTL
 14754         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14755         GO TO 6750-EXIT.
 14756
 14757     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 304
* EL689.cbl
 14758     MOVE '4'                    TO W-CNTL-RECORD-TYPE.
 14759     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 14760
 14761
 14762* EXEC CICS HANDLE CONDITION
 14763*         NOTOPEN (8040-CNTL-NOT-OPEN)
 14764*         NOTFND  (6750-EXIT)
 14765*    END-EXEC.
 14766*    MOVE '"$JI                  ! 5 #00013755' TO DFHEIV0
 14767     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14768     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14769     MOVE X'3520233030303133373535' TO DFHEIV0(25:11)
 14770     CALL 'kxdfhei1' USING DFHEIV0
 14771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14772
 14773
 14774
 14775* EXEC CICS READ
 14776*         DATASET (W-CNTL-FILE-ID)
 14777*         SET     (ADDRESS OF CONTROL-FILE)
 14778*         GTEQ
 14779*         RIDFLD  (W-CNTL-KEY)
 14780*    END-EXEC.
 14781*    MOVE '&"S        G          (   #00013760' TO DFHEIV0
 14782     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14783     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14784     MOVE X'2020233030303133373630' TO DFHEIV0(25:11)
 14785     CALL 'kxdfhei1' USING DFHEIV0,
 14786           W-CNTL-FILE-ID,
 14787           DFHEIV20,
 14788           DFHEIV99,
 14789           W-CNTL-KEY,
 14790           DFHEIV99,
 14791           DFHEIV99,
 14792           DFHEIV99
 14793     SET ADDRESS OF CONTROL-FILE TO
 14794         DFHEIV20
 14795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14796
 14797
 14798     MOVE 1                      TO W-NDX.
 14799
 14800 6750-LOOP.
 14801
 14802     IF  W-NDX = 9
 14803         GO TO 6750-EXIT.
 14804
 14805     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 14806         ADD 1                   TO W-NDX
 14807         GO TO 6750-LOOP.
 14808
 14809     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 14810         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 14811                                 TO W-VG-TEXT (11).
 14812
 14813 6750-EXIT.
 14814     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 305
* EL689.cbl
 14816 6800-GET-A-H-BENEFIT-DATA.
 14817
 14818     IF  W-FILE-NOT-USED (3)
 14819         GO TO 6800-EXIT.
 14820
 14821     MOVE SPACES                 TO W-CNTL-GEN2.
 14822
 14823     IF  DATASORI EQUAL '2'
 14824         IF  W-FILE-NOT-USED (8)
 14825             PERFORM 6450-READ-CERT-ONLY
 14826             IF  W-CERT-FOUND
 14827                 MOVE CM-AH-BENEFIT-CD
 14828                                 TO W-BEN-HOLD
 14829                                    W-CNTL-GEN2
 14830             ELSE
 14831                 NEXT SENTENCE
 14832         ELSE
 14833             MOVE CM-AH-BENEFIT-CD
 14834                                 TO W-BEN-HOLD
 14835                                    W-CNTL-GEN2
 14836     ELSE
 14837         IF  DATASORI EQUAL '4'
 14838             IF  W-FILE-NOT-USED (9)
 14839                 PERFORM 6400-READ-PNDB-ONLY
 14840                 IF  W-PNDB-FOUND
 14841                     IF  PI-689-TYPE = '1'
 14842                         MOVE PB-I-AH-BENEFIT-CD
 14843                                 TO W-BEN-HOLD
 14844                                    W-CNTL-GEN2
 14845                     ELSE
 14846                         MOVE PB-CI-AH-BENEFIT-CD
 14847                                 TO W-BEN-HOLD
 14848                                    W-CNTL-GEN2
 14849             ELSE
 14850                 NEXT SENTENCE
 14851         ELSE
 14852             IF  W-FILE-USED (8)
 14853                 MOVE CM-AH-BENEFIT-CD
 14854                                 TO W-BEN-HOLD
 14855                                    W-CNTL-GEN2
 14856             ELSE
 14857                 IF  W-FILE-USED (9)
 14858                     IF  PI-689-TYPE = '1'
 14859                         MOVE PB-I-AH-BENEFIT-CD
 14860                                 TO W-BEN-HOLD
 14861                                    W-CNTL-GEN2
 14862                     ELSE
 14863                         MOVE PB-CI-AH-BENEFIT-CD
 14864                                 TO W-BEN-HOLD
 14865                                    W-CNTL-GEN2.
 14866
 14867     IF  W-CNTL-GEN2 EQUAL SPACES
 14868         MOVE ER-9327            TO EMI-ERROR
 14869         MOVE -1                 TO MAINTL
 14870         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14871         GO TO 6800-EXIT.
 14872
 14873     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 306
* EL689.cbl
 14874     MOVE '5'                    TO W-CNTL-RECORD-TYPE.
 14875     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 14876
 14877
 14878* EXEC CICS HANDLE CONDITION
 14879*         NOTOPEN (8040-CNTL-NOT-OPEN)
 14880*         NOTFND  (6800-EXIT)
 14881*    END-EXEC.
 14882*    MOVE '"$JI                  ! 6 #00013846' TO DFHEIV0
 14883     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14884     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14885     MOVE X'3620233030303133383436' TO DFHEIV0(25:11)
 14886     CALL 'kxdfhei1' USING DFHEIV0
 14887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14888
 14889
 14890
 14891* EXEC CICS READ
 14892*         DATASET (W-CNTL-FILE-ID)
 14893*         SET     (ADDRESS OF CONTROL-FILE)
 14894*         RIDFLD  (W-CNTL-KEY)
 14895*         GTEQ
 14896*    END-EXEC.
 14897*    MOVE '&"S        G          (   #00013851' TO DFHEIV0
 14898     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14899     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14900     MOVE X'2020233030303133383531' TO DFHEIV0(25:11)
 14901     CALL 'kxdfhei1' USING DFHEIV0,
 14902           W-CNTL-FILE-ID,
 14903           DFHEIV20,
 14904           DFHEIV99,
 14905           W-CNTL-KEY,
 14906           DFHEIV99,
 14907           DFHEIV99,
 14908           DFHEIV99
 14909     SET ADDRESS OF CONTROL-FILE TO
 14910         DFHEIV20
 14911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14912
 14913
 14914     MOVE 1                      TO W-NDX.
 14915
 14916 6800-LOOP-AH.
 14917
 14918     IF  W-NDX = 9
 14919         GO TO 6800-EXIT.
 14920
 14921     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 14922         ADD 1                   TO W-NDX
 14923         GO TO 6800-LOOP-AH.
 14924
 14925     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 14926         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 14927                                 TO W-VG-TEXT (15)
 14928         MOVE CF-BENEFIT-ALPHA (W-NDX)
 14929                                 TO W-BENEFIT-WORK
 14930         MOVE W-ELIM-DAYS        TO W-VG-TEXT (16).
 14931
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 307
* EL689.cbl
 14932 6800-EXIT.
 14933     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 308
* EL689.cbl
 14935 6850-GET-CHECK-DATA.
 14936
 14937     IF  ADDRSI EQUAL '6'
 14938             AND
 14939         PI-CREATE-LABELS
 14940             AND
 14941         NOT PI-689-LABELS-OVERRIDEN
 14942         NEXT SENTENCE
 14943     ELSE
 14944         IF  W-FILE-NOT-USED (12)
 14945             GO TO 6850-EXIT.
 14946
 14947     IF  W-CHEK-CERT-NO EQUAL LOW-VALUES
 14948         MOVE ER-9327            TO EMI-ERROR
 14949         MOVE -1                 TO MAINTL
 14950         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14951         GO TO 6850-EXIT.
 14952
 14953
 14954* EXEC CICS HANDLE CONDITION
 14955*         NOTOPEN (8045-CHEK-NOT-OPEN)
 14956*         NOTFND  (6850-CHEK-NOT-FOUND)
 14957*    END-EXEC.
 14958*    MOVE '"$JI                  ! 7 #00013897' TO DFHEIV0
 14959     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14960     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14961     MOVE X'3720233030303133383937' TO DFHEIV0(25:11)
 14962     CALL 'kxdfhei1' USING DFHEIV0
 14963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14964
 14965
 14966
 14967* EXEC CICS READ
 14968*         DATASET (W-CHEK-FILE-ID)
 14969*         SET     (ADDRESS OF CHECK-RECORDS)
 14970*         RIDFLD  (W-CHEK-KEY)
 14971*    END-EXEC.
 14972*    MOVE '&"S        E          (   #00013902' TO DFHEIV0
 14973     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14974     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14975     MOVE X'2020233030303133393032' TO DFHEIV0(25:11)
 14976     CALL 'kxdfhei1' USING DFHEIV0,
 14977           W-CHEK-FILE-ID,
 14978           DFHEIV20,
 14979           DFHEIV99,
 14980           W-CHEK-KEY,
 14981           DFHEIV99,
 14982           DFHEIV99,
 14983           DFHEIV99
 14984     SET ADDRESS OF CHECK-RECORDS TO
 14985         DFHEIV20
 14986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14987
 14988
 14989     MOVE CH-CHECK-NO            TO W-VG-TEXT (158).
 14990     MOVE CH-AMOUNT-PAID         TO W-EDIT-7-2.
 14991     MOVE W-EDIT-7-2             TO W-VG-TEXT (157).
 14992     MOVE CH-CHECK-QUE-CONTROL   TO W-DISPLAY-8
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 309
* EL689.cbl
 14993                                    PI-689-CONTROL.
 14994     MOVE W-DISPLAY-8            TO W-VG-TEXT (165).
 14995     MOVE CH-REASON-FOR-CHECK    TO W-VG-TEXT (166).
 14996
 14997     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14998     MOVE CH-PAYEE-NAME-1        TO W-LABEL-LINES (1).
 14999     MOVE CH-PAYEE-NAME-2        TO W-LABEL-LINES (2).
 15000     MOVE CH-PAYEE-ADDRESS-1     TO W-LABEL-LINES (3).
 15001     MOVE CH-PAYEE-ADDRESS-2     TO W-LABEL-LINES (4).
 15002     MOVE CH-PAYEE-CITY-ST       TO W-LABEL-LINES (5).
 15003
 15004     MOVE CH-PAYEE-ZIP           TO W-WORK-ZIP.
 15005     MOVE SPACES                 TO W-LABEL-ZIP (6).
 15006
 15007     IF  CH-CANADIAN-POST-CODE
 15008         MOVE CH-CANADIAN-POSTAL-CODE
 15009                                 TO W-CANADIAN-POSTAL-CODES
 15010         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 15011         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 15012         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 15013                                    W-LAB-CAN-FILLER (6)
 15014     ELSE
 15015         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 15016         IF  W-WORK-ZIP4 GREATER THAN '0000'
 15017             MOVE '-'            TO W-LABEL-DASH (6)
 15018             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 15019         ELSE
 15020             MOVE SPACES         TO W-LABEL-DASH (6)
 15021                                    W-LABEL-2ND-ZIP (6).
 15022
 15023     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 15024
 15025     IF  ADDRSI EQUAL '6'
 15026             AND
 15027         PI-CREATE-LABELS
 15028             AND
 15029         NOT PI-689-LABELS-OVERRIDEN
 15030         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 15031                                    W-VG-TEXT (159)
 15032         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 15033                                    W-VG-TEXT (160)
 15034         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 15035                                    W-VG-TEXT (161)
 15036         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 15037                                    W-VG-TEXT (162)
 15038         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 15039                                    W-VG-TEXT (163)
 15040         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 15041                                    W-VG-TEXT (164)
 15042         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 15043         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 15044         SET W-RG-NDX UP BY +1
 15045     ELSE
 15046         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (159)
 15047         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (160)
 15048         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (161)
 15049         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (162)
 15050         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (163)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 310
* EL689.cbl
 15051         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (164).
 15052
 15053     GO TO 6850-EXIT.
 15054
 15055 6850-CHEK-NOT-FOUND.
 15056
 15057     IF  ADDRSL GREATER ZERO
 15058         IF ADDRSI = '6'
 15059            MOVE ER-2908         TO EMI-ERROR
 15060            MOVE -1              TO ADDRSL
 15061            MOVE AL-UNBON        TO ADDRSA
 15062            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15063            GO TO 8200-SEND-DATAONLY.
 15064
 15065 6850-EXIT.
 15066     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 311
* EL689.cbl
 15068 6900-GET-PYAJ-DATA.
 15069
 15070     IF  W-FILE-NOT-USED (13)
 15071         GO TO 6900-EXIT.
 15072
 15073     IF  W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 15074         MOVE ER-9327            TO EMI-ERROR
 15075         MOVE -1                 TO MAINTL
 15076         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15077         GO TO 6900-EXIT.
 15078
 15079
 15080* EXEC CICS HANDLE CONDITION
 15081*         NOTOPEN (8085-PYAJ-NOT-OPEN)
 15082*         NOTFND  (6900-PYAJ-NOT-FOUND)
 15083*    END-EXEC.
 15084*    MOVE '"$JI                  ! 8 #00013998' TO DFHEIV0
 15085     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 15086     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15087     MOVE X'3820233030303133393938' TO DFHEIV0(25:11)
 15088     CALL 'kxdfhei1' USING DFHEIV0
 15089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15090
 15091
 15092 6900-READ-NEXT.
 15093
 15094
 15095* EXEC CICS READ
 15096*         DATASET (W-PYAJ-FILE-ID)
 15097*         SET     (ADDRESS OF PENDING-PAY-ADJ)
 15098*         RIDFLD  (W-PYAJ-KEY)
 15099*         GTEQ
 15100*    END-EXEC.
 15101*    MOVE '&"S        G          (   #00014005' TO DFHEIV0
 15102     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15103     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15104     MOVE X'2020233030303134303035' TO DFHEIV0(25:11)
 15105     CALL 'kxdfhei1' USING DFHEIV0,
 15106           W-PYAJ-FILE-ID,
 15107           DFHEIV20,
 15108           DFHEIV99,
 15109           W-PYAJ-KEY,
 15110           DFHEIV99,
 15111           DFHEIV99,
 15112           DFHEIV99
 15113     SET ADDRESS OF PENDING-PAY-ADJ TO
 15114         DFHEIV20
 15115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15116
 15117
 15118     IF  PY-COMPANY-CD NOT EQUAL W-PYAJ-COMPANY-CD
 15119             OR
 15120         PY-CARRIER NOT EQUAL W-PYAJ-CARRIER
 15121             OR
 15122         PY-GROUPING NOT EQUAL W-PYAJ-GROUPING
 15123             OR
 15124         PY-FIN-RESP NOT EQUAL W-PYAJ-FIN-RESP
 15125             OR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 312
* EL689.cbl
 15126         PY-ACCOUNT NOT EQUAL W-PYAJ-ACCOUNT
 15127         GO TO 6900-PYAJ-NOT-FOUND.
 15128
 15129     IF  PI-689-SEQ-NO GREATER THAN ZEROS
 15130             AND
 15131         PY-FILE-SEQ-NO NOT EQUAL PI-689-SEQ-NO
 15132         GO TO 6900-PYAJ-NOT-FOUND.
 15133
 15134     IF  PY-RECORD-TYPE NOT EQUAL W-PYAJ-RECORD-TYPE
 15135         MOVE PY-CONTROL-PRIMARY TO W-PYAJ-KEY
 15136         ADD +1                  TO W-PYAJ-FILE-SEQ-NO
 15137         GO TO 6900-READ-NEXT.
 15138
 15139     MOVE PY-CHECK-NUMBER        TO W-DISPLAY-7.
 15140     MOVE W-DISPLAY-7            TO W-VG-TEXT (171).
 15141
 15142     MOVE PY-ENTRY-AMT           TO W-EDIT-7-2.
 15143     MOVE W-EDIT-7-2             TO W-VG-TEXT (170).
 15144
 15145     MOVE PY-CHECK-QUE-CONTROL   TO W-DISPLAY-8
 15146                                    PI-689-CONTROL.
 15147     MOVE W-DISPLAY-8            TO W-VG-TEXT (172).
 15148     MOVE PY-ENTRY-COMMENT       TO W-VG-TEXT (173).
 15149
 15150     GO TO 6900-EXIT.
 15151
 15152 6900-PYAJ-NOT-FOUND.
 15153
 15154     MOVE ER-7395                TO EMI-ERROR
 15155     MOVE -1                     TO DATASORL
 15156     MOVE AL-UNBON               TO DATASORA
 15157     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15158     GO TO 8200-SEND-DATAONLY.
 15159
 15160 6900-EXIT.
 15161     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 313
* EL689.cbl
 15163 6950-MOVE-SYSTEM-DATA.
 15164
 15165     IF  W-FILE-NOT-USED (7)
 15166         GO TO 6950-EXIT.
 15167
 15168     MOVE EIBDATE                TO W-DATE-WORK.
 15169     MOVE W-DT-WORK              TO DC-JULIAN-YYDDD.
 15170     MOVE '5'                    TO DC-OPTION-CODE.
 15171     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 15172     MOVE DC-GREG-DATE-1-EDIT    TO W-VG-TEXT (60).
 15173     MOVE DC-GREG-DATE-1-ALPHA   TO W-VG-TEXT (61).
 15174
 15175     MOVE FORMI                  TO W-VG-TEXT (62).
 15176
 15177     IF  PI-689-VARIABLE-DATA-1 GREATER THAN SPACES
 15178         MOVE PI-689-VARIABLE-DATA-1
 15179                                 TO W-VG-TEXT (63)
 15180         MOVE PI-689-VARIABLE-DATA-2
 15181                                 TO W-VG-TEXT (64)
 15182         MOVE PI-689-VARIABLE-DATA-3
 15183                                 TO W-VG-TEXT (65)
 15184         MOVE PI-689-VARIABLE-DATA-4
 15185                                 TO W-VG-TEXT (66)
 15186     ELSE
 15187         MOVE '(VARIABLE NOT PROVIDED)'
 15188                                 TO W-VG-TEXT (63).
 15189
 15190 6950-EXIT.
 15191     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 314
* EL689.cbl
 15193 7000-FORMAT-SCREEN.
 15194
 15195     IF  MAINTI EQUAL 'S'
 15196             OR
 15197         PI-SHOW-MODE
 15198         MOVE AL-PANOF           TO W-SC-TEXTA (W-SC-NDX)
 15199     ELSE
 15200         MOVE AL-UANOF           TO W-SC-TEXTA (W-SC-NDX).
 15201
 15202     IF  W-RG-NDX NOT GREATER THAN PI-689-NUMBER-LABEL-LINES
 15203         SET W-LINE23            TO W-RG-NDX
 15204         MOVE 'A'                TO W-LINE1
 15205     ELSE
 15206         SET W-LIN-NUM           TO W-RG-NDX
 15207         COMPUTE W-LIN-NUM
 15208             = W-LIN-NUM - PI-689-NUMBER-LABEL-LINES - 1.
 15209
 15210     MOVE W-LINE-NUM             TO W-SC-LINE (W-SC-NDX).
 15211     MOVE W-RC-TEXT (W-RG-NDX)   TO W-SC-TEXT (W-SC-NDX).
 15212     SET W-RG-NDX UP BY 1.
 15213
 15214 7000-EXIT.
 15215      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 315
* EL689.cbl
 15217 7100-FORMAT-LAST-NAME-1ST.
 15218*****************************************************************
 15219*             M O V E   N A M E   R O U T I N E                 *
 15220*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15221*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15222*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15223*                  FIELD                   VALUE                *
 15224*           W-NAME-LAST    (CL15)      SMITH                    *
 15225*           W-NAME-FIRST   (CL15)      JOHN                     *
 15226*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15227*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15228*     CONTAIN                                                   *
 15229*                SMITH, JOHN ALLEN                              *
 15230*     OR                                                        *
 15231*                SMITH, JOHN A.                                 *
 15232*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15233*     COPYBOOK, ELCNWA.                                         *
 15234*****************************************************************.
 15235
 15236     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15237     MOVE ZERO                   TO WS-NAME-SW.
 15238     SET NWA-INDEX               TO +1.
 15239
 15240     IF  W-NAME-LAST EQUAL SPACES
 15241             AND
 15242         W-NAME-MIDDLE EQUAL SPACES
 15243         MOVE +1                 TO WS-NAME-SW.
 15244
 15245     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15246     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15247
 15248     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15249     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15250
 15251     SET NWA-INDEX UP BY +1.
 15252
 15253     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 15254         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 15255             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15256             SET NWA-INDEX UP BY +1
 15257             MOVE '.'            TO WS-NW (NWA-INDEX)
 15258             SET NWA-INDEX UP BY +2
 15259         ELSE
 15260             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15261             PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15262
 15263 7100-EXIT.
 15264     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 316
* EL689.cbl
 15266 7110-MOVE-NAME.
 15267
 15268     IF  WS-NAME-SW GREATER THAN +1
 15269         GO TO 7110-EXIT.
 15270
 15271     IF  WS-NAME-WORK2 = SPACES
 15272         GO TO 7110-EXIT.
 15273
 15274     SET NWA-INDEX2            TO +1.
 15275     SET NWA-INDEX3            TO +2.
 15276
 15277 7110-MOVE-NAME-CYCLE.
 15278
 15279     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15280
 15281     IF  NWA-INDEX LESS THAN +30
 15282         SET NWA-INDEX UP BY +1
 15283     ELSE
 15284         ADD +2                TO WS-NAME-SW
 15285         GO TO 7110-EXIT.
 15286
 15287     IF  NWA-INDEX2 LESS THAN +20
 15288         SET NWA-INDEX3 UP BY +1
 15289         SET NWA-INDEX2 UP BY +1.
 15290
 15291     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 15292             AND
 15293         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 15294         IF  WS-NAME-SW EQUAL ZERO
 15295             MOVE ','            TO WS-NW (NWA-INDEX)
 15296             SET NWA-INDEX UP BY +2
 15297             MOVE +1             TO WS-NAME-SW
 15298             GO TO 7110-EXIT
 15299         ELSE
 15300             GO TO 7110-EXIT.
 15301
 15302     GO TO 7110-MOVE-NAME-CYCLE.
 15303
 15304 7110-EXIT.
 15305     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 317
* EL689.cbl
 15307 7200-FORMAT-NAME-STRAIGHT.
 15308*****************************************************************
 15309*           M O V E   N A M E   R O U T I N E                   *
 15310*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15311*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15312*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15313*                  FIELD                   VALUE                *
 15314*           W-NAME-LAST    (CL15)      SMITH                    *
 15315*           W-NAME-FIRST   (CL15)      JOHN                     *
 15316*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15317*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15318*     CONTAIN                                                   *
 15319*              JOHN A. SMITH                                    *
 15320*     OR                                                        *
 15321*              JOHN ALLEN SMITH                                 *
 15322*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15323*     COPYBOOK, ELCNWA.                                         *
 15324*****************************************************************
 15325
 15326     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15327     MOVE ZERO                   TO WS-NAME-SW.
 15328     SET NWA-INDEX               TO +1.
 15329
 15330     IF  W-NAME-FIRST EQUAL SPACES
 15331             AND
 15332         W-NAME-MIDDLE EQUAL SPACES
 15333         MOVE W-NAME-LAST        TO WS-NAME-WORK
 15334         GO TO 7200-EXIT.
 15335
 15336     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15337     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15338
 15339     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 15340         SET NWA-INDEX UP BY +1
 15341
 15342         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 15343             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15344             SET NWA-INDEX UP BY +1
 15345             MOVE '.'            TO WS-NW (NWA-INDEX)
 15346             SET NWA-INDEX UP BY +1
 15347
 15348         ELSE
 15349             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15350             PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15351
 15352     SET NWA-INDEX UP BY +1
 15353     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15354     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15355
 15356 7200-EXIT.
 15357     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 318
* EL689.cbl
 15359 7290-MOVE-NAME.
 15360
 15361     IF  WS-NAME-SW GREATER THAN +1
 15362         GO TO 7290-EXIT.
 15363
 15364     IF  WS-NAME-WORK2 EQUAL SPACES
 15365         GO TO 7290-EXIT.
 15366
 15367     SET NWA-INDEX2            TO +1.
 15368     SET NWA-INDEX3            TO +2.
 15369
 15370 7290-MOVE-NAME-CYCLE.
 15371
 15372     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15373
 15374     IF  NWA-INDEX LESS THAN +30
 15375         SET NWA-INDEX UP BY +1
 15376     ELSE
 15377         ADD +2                TO WS-NAME-SW
 15378         GO TO 7290-EXIT.
 15379
 15380     IF  NWA-INDEX2 LESS THAN +20
 15381         SET NWA-INDEX2 UP BY +1
 15382         SET NWA-INDEX3 UP BY +1.
 15383
 15384     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 15385             AND
 15386         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 15387         GO TO 7290-EXIT.
 15388
 15389     GO TO 7290-MOVE-NAME-CYCLE.
 15390
 15391 7290-EXIT.
 15392     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 319
* EL689.cbl
 15394 7300-LABEL-MOVE.
 15395
 15396     IF  W-LABEL-HOLD-AREA = SPACES
 15397         MOVE +0                 TO W-NUMB-LABEL-LINES
 15398         GO TO 7300-EXIT.
 15399
 15400     IF  W-LABEL-LINES (1) = SPACES
 15401         MOVE W-LABEL-LINES (2)  TO W-LABEL-LINES (1)
 15402         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 15403         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15404         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15405         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15406         MOVE SPACES             TO W-LABEL-LINES (6)
 15407         GO TO 7300-LABEL-MOVE.
 15408
 15409     IF  W-LABEL-LINES (2) = SPACES
 15410             AND
 15411         W-LABEL-LINES (3) = SPACES
 15412             AND
 15413         W-LABEL-LINES (4) = SPACES
 15414             AND
 15415         W-LABEL-LINES (5) = SPACES
 15416             AND
 15417         W-LABEL-LINES (6) = SPACES
 15418         MOVE 1                  TO W-NDX
 15419                                    W-NUMB-LABEL-LINES
 15420         GO TO 7300-EXIT.
 15421
 15422 7300-TRY-2.
 15423
 15424     IF  W-LABEL-LINES (2) = SPACES
 15425         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 15426         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15427         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15428         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15429         MOVE SPACES             TO W-LABEL-LINES (6)
 15430         GO TO 7300-TRY-2.
 15431
 15432     IF  W-LABEL-LINES (3) = SPACES
 15433             AND
 15434         W-LABEL-LINES (4) = SPACES
 15435             AND
 15436         W-LABEL-LINES (5) = SPACES
 15437             AND
 15438         W-LABEL-LINES (6) = SPACES
 15439         MOVE 2                  TO W-NDX
 15440         GO TO 7300-MOVE-ZIP.
 15441
 15442 7300-TRY-3.
 15443
 15444     IF  W-LABEL-LINES (3) = SPACES
 15445         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15446         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15447         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15448         MOVE SPACES             TO W-LABEL-LINES (6)
 15449         GO TO 7300-TRY-3.
 15450
 15451     IF  W-LABEL-LINES (4) = SPACES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 320
* EL689.cbl
 15452             AND
 15453         W-LABEL-LINES (5) = SPACES
 15454             AND
 15455         W-LABEL-LINES (6) = SPACES
 15456         MOVE 3                   TO W-NDX
 15457         GO TO 7300-MOVE-ZIP.
 15458
 15459 7300-TRY-4.
 15460
 15461     IF  W-LABEL-LINES (4) = SPACES
 15462         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15463         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15464         MOVE SPACES             TO W-LABEL-LINES (6)
 15465         GO TO 7300-TRY-4.
 15466
 15467     IF  W-LABEL-LINES (5) = SPACES
 15468             AND
 15469         W-LABEL-LINES (6) = SPACES
 15470         MOVE 4                  TO W-NDX
 15471         GO TO 7300-MOVE-ZIP.
 15472
 15473 7300-TRY-5.
 15474
 15475     IF  W-LABEL-LINES (5) = SPACES
 15476         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15477         MOVE SPACES             TO W-LABEL-LINES (6)
 15478         GO TO 7300-TRY-5
 15479     ELSE
 15480         IF  W-LABEL-LINES (6) = SPACES
 15481             MOVE 5              TO W-NDX
 15482             GO TO 7300-MOVE-ZIP
 15483         ELSE
 15484             MOVE 6              TO W-NDX.
 15485
 15486 7300-MOVE-ZIP.
 15487
 15488     COMPUTE W-NDX2 = W-NDX - 1.
 15489
 15490     IF  W-LAST-ZIP (W-NDX2) = SPACES
 15491*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 15492
 15493         IF  W-LABEL-1ST-ZIP (W-NDX) NUMERIC
 15494                 MOVE W-LABEL-ZIP (W-NDX)
 15495                                 TO W-LAST-ZIP (W-NDX2)
 15496                 MOVE SPACES     TO W-LABEL-LINES (W-NDX)
 15497                 MOVE W-NDX2     TO W-NUMB-LABEL-LINES
 15498                 GO TO 7300-EXIT.
 15499
 15500     MOVE W-NDX                  TO W-NUMB-LABEL-LINES.
 15501
 15502 7300-EXIT.
 15503     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 321
* EL689.cbl
 15505 7400-CREATE-LETTER.
 15506****************************************************************
 15507*    THIS AREA CONTROLS THE PROCESSING OF INDIVIDUAL INPUT     *
 15508*    RECORDS.                                                  *
 15509****************************************************************
 15510
 15511     SET W-SQ-NDX                TO W-START-COLUMN.
 15512     MOVE SPACES                 TO W-SQUEEZED-LINE
 15513                                    W-WORK-LINE.
 15514     MOVE W-START-COLUMN         TO W-LAST-SQUEEZED-SPACE
 15515     MOVE +1                     TO W-LAST-WC-SPACE.
 15516     MOVE HIGH-VALUES            TO W-LAST-SQ-CHAR.
 15517
 15518     SET W-TG-NDX                TO +1.
 15519
 15520     PERFORM 7410-TEXT-LINE-PROCESS THRU 7410-EXIT
 15521            VARYING
 15522         W-TG-NDX FROM W-TG-NDX BY +1
 15523            UNTIL
 15524         W-TG-NDX GREATER THAN W-TOTAL-TX-LINES.
 15525
 15526     IF  W-FORM-SQUEEZE-ON
 15527             AND
 15528         W-SQUEEZED-LINE GREATER THAN SPACES
 15529         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT.
 15530
 15531     PERFORM 7640-PAGING THRU 7640-EXIT.
 15532
 15533 7400-EXIT.
 15534     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 322
* EL689.cbl
 15536 7410-TEXT-LINE-PROCESS.
 15537***************************************************************
 15538*    THIS ROUTINE SEARCHES THE TEXT WORK AREA FOR ANY         *
 15539*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 15540*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 15541*    DATA THAT WAS GENERATED PREVIOUSLY.  WHILE PERFORMING    *
 15542*    THIS FUNCTION THE ROUTINE MOVES EACH CHARACTER OR ITS    *
 15543*    VARIABLE REPLACEMENT TO A WORK LINE.                     *
 15544***************************************************************
 15545
 15546
 15547     SET W-WC-NDX                TO W-ZEROS.
 15548     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 15549
 15550     MOVE W-TX-SC (W-TG-NDX)     TO W-LINE-SQUEEZE-IND.
 15551
 15552     PERFORM 7420-TEXT-CHAR-PROCESS THRU 7420-EXIT
 15553             VARYING
 15554         W-TX-NDX FROM +1 BY +1
 15555             UNTIL
 15556         W-TX-NDX GREATER THAN +70.
 15557
 15558****************************************************************
 15559*    IF SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS    *
 15560*    EACH LINE OF TEXT IS PROCESSED ACCORDING TO THE INDICATED *
 15561*    LINE SQUEEZE CONTROL.                                     *
 15562****************************************************************
 15563     IF  W-FORM-SQUEEZE-ON
 15564
 15565         IF  W-WORK-LINE GREATER THAN SPACES
 15566                 OR
 15567             W-AS-IS
 15568             PERFORM 7450-SQUEEZING THRU 7450-EXIT
 15569
 15570         ELSE
 15571             NEXT SENTENCE
 15572****************************************************************
 15573*    IF NO SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS *
 15574*    EACH LINE OF TEXT IS PRINT AS IS EXCEPT FOR VARIABLES     *
 15575****************************************************************
 15576     ELSE
 15577         IF  W-WORK-LINE GREATER THAN SPACES
 15578             MOVE W-TX-PC (W-TG-NDX)
 15579                                 TO W-PRINT-CONTROL
 15580             MOVE W-WORK-LINE    TO W-SQUEEZED-LINE
 15581             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15582             MOVE SPACES         TO W-WORK-LINE.
 15583
 15584 7410-EXIT.
 15585     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 323
* EL689.cbl
 15587 7420-TEXT-CHAR-PROCESS.
 15588****************************************************************
 15589*    LOOKING FOR VARIABLE INDICATORS (**XXX) THIS SECTION      *
 15590*    CONTROLS THE CONVERSION OF THESE INDICATORS INTO THEIR    *
 15591*    ACTUAL VALUES.  IT MOVES THESE REPLACEMENTS AND THE       *
 15592*    REMAINING CHARACTERS TO THE WORK LINE.                    *
 15593****************************************************************
 15594
 15595     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 15596             AND
 15597         W-LAST-CHAR EQUAL '@'
 15598         PERFORM 7430-PROCESS-VARIABLE THRU 7430-EXIT.
 15599
 15600     SET W-WC-NDX UP BY +1.
 15601
 15602     IF  W-WC-NDX GREATER THAN +70
 15603         IF  W-FORM-SQUEEZE-ON
 15604                 AND
 15605             NOT W-AS-IS
 15606             PERFORM 7440-BACK-TO-NEAREST-WORD THRU 7440-EXIT
 15607                     VARYING
 15608                 W-WC-NDX FROM W-LAST-WC-SPACE BY +1
 15609                     UNTIL
 15610                 W-WC-NDX EQUAL +71
 15611             SET W-TX-NDX        TO W-LAST-TX-SPACE
 15612
 15613             IF  W-WORK-LINE GREATER THAN SPACES
 15614                 PERFORM 7450-SQUEEZING THRU 7450-EXIT
 15615                 MOVE SPACES     TO W-WORK-LINE
 15616                                    W-LINE-SQUEEZE-IND
 15617                 SET W-WC-NDX    TO +1
 15618             ELSE
 15619                 SET W-WC-NDX    TO +1
 15620         ELSE
 15621             PERFORM 7460-REMAIN-CHAR-CHECK THRU 7460-EXIT.
 15622
 15623     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15624                                 TO W-CHARACTER-TYPE.
 15625
 15626     SET W-WC-NDX2               TO W-WC-NDX.
 15627     SET W-WC-NDX2 DOWN BY +1.
 15628
 15629     IF  W-PUNCTUATION
 15630             AND
 15631         W-WC-NDX2 GREATER THAN W-ZEROS
 15632             AND
 15633         W-WORK-CHAR (W-WC-NDX2) EQUAL SPACES
 15634         SET W-WC-NDX DOWN BY +1.
 15635
 15636     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15637                                 TO W-LAST-CHAR
 15638                                    W-WORK-CHAR (W-WC-NDX).
 15639
 15640     IF  W-LAST-CHAR EQUAL SPACES
 15641         SET W-LAST-WC-SPACE     TO W-WC-NDX
 15642         SET W-LAST-TX-SPACE     TO W-TX-NDX.
 15643
 15644 7420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 324
* EL689.cbl
 15645     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 325
* EL689.cbl
 15647 7430-PROCESS-VARIABLE.
 15648******************************************************************
 15649*    THIS SECTION CHECKS ON ALL '@@XXX' FORMATED CHARACTER       *
 15650*    GROUPS.  IF IN PROPER FORMAT, EACH GROUP IS REPLACED WITH   *
 15651*    ITS CORRESPONDING VALUES.                                   *
 15652******************************************************************
 15653
 15654     SET W-TX-NDX UP BY +1.
 15655
 15656     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15657         MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15658                                 TO W-V1
 15659         SET W-TX-NDX UP BY +1
 15660
 15661         IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15662             MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15663                                 TO W-V2
 15664             SET W-TX-NDX UP BY +1
 15665             IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15666                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15667                                 TO W-V3
 15668                 SET W-TX-NDX UP BY +1
 15669                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15670                                 TO W-FIELD-SQUEEZE-IND
 15671                 GO TO 7430-CONTINUE
 15672             ELSE
 15673                 SET W-TX-NDX DOWN BY +3
 15674                 MOVE ER-0180    TO EMI-ERROR
 15675                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15676                 MOVE -1         TO MAINTL
 15677                 MOVE HIGH-VALUES
 15678                                 TO W-LAST-CHAR
 15679         ELSE
 15680             SET W-TX-NDX DOWN BY +2
 15681             MOVE ER-0180        TO EMI-ERROR
 15682             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15683             MOVE -1             TO MAINTL
 15684             MOVE HIGH-VALUES    TO W-LAST-CHAR
 15685     ELSE
 15686         SET W-TX-NDX DOWN BY +1
 15687         MOVE ER-7246            TO EMI-ERROR
 15688         MOVE -1                 TO MAINTL
 15689         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15690         MOVE HIGH-VALUES        TO W-LAST-CHAR.
 15691
 15692****************************************************************
 15693*    WHEN THE PROPER FORM IS NOT FOUND THE CHARACTERS INVOLVED *
 15694*    ARE TRANSFERRED INTACT AND A NOTE MADE INDICATING THIS    *
 15695*    ACTION.                                                   *
 15696****************************************************************
 15697
 15698     IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15699         MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 15700         GO TO 7430-EXIT
 15701     ELSE
 15702         GO TO 7430-EXIT.
 15703
 15704 7430-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 326
* EL689.cbl
 15705
 15706     IF  W-VAR-RELATIVE-NUM LESS THAN 001
 15707             OR
 15708         W-VAR-RELATIVE-NUM GREATER THAN W-NUM-OF-VARIABLES
 15709         SET W-TX-NDX DOWN BY +4
 15710         MOVE ER-0180            TO EMI-ERROR
 15711         MOVE -1                 TO MAINTL
 15712         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15713         MOVE HIGH-VALUES        TO W-LAST-CHAR
 15714         IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15715             MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 15716             GO TO 7430-EXIT
 15717         ELSE
 15718             GO TO 7430-EXIT.
 15719
 15720     SET W-VG-NDX                TO W-VAR-RELATIVE-NUM.
 15721
 15722     SET W-WC-NDX DOWN BY +1.
 15723
 15724     IF  (W-FORM-SQUEEZE-OFF
 15725                 AND
 15726             NOT W-SQUEEZE-FIELD)
 15727             OR
 15728         (W-FORM-SQUEEZE-ON
 15729                 AND
 15730             W-AS-IS)
 15731         PERFORM 7435-MOVE-VARIABLE-DIRECT THRU 7435-EXIT
 15732                 VARYING
 15733             W-VC-NDX FROM +1 BY +1
 15734                 UNTIL
 15735             W-VC-NDX GREATER THAN
 15736                 W-VARIABLE-SIZE (W-VG-NDX)
 15737
 15738         IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +5
 15739             SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 15740             SET W-TX-NDX DOWN BY +5
 15741             IF  W-TX-NDX GREATER THAN +70
 15742                 SET W-TX-NDX    TO +70
 15743                 GO TO 7430-EXIT
 15744             ELSE
 15745                 GO TO 7430-EXIT
 15746         ELSE
 15747             COMPUTE W-ADJUST-SHORT
 15748                 = 5 - W-VARIABLE-SIZE (W-VG-NDX)
 15749             SET W-WC-NDX UP BY W-ADJUST-SHORT
 15750             GO TO 7430-EXIT.
 15751
 15752     IF  W-SQUEEZE-FIELD
 15753         SET W-TX-NDX UP BY +1.
 15754
 15755     MOVE SPACES                 TO W-FIRST-CHAR-FOUND-IND.
 15756
 15757     PERFORM 7470-MOVE-CHAR THRU 7470-EXIT
 15758             VARYING
 15759         W-VC-NDX FROM +1 BY +1
 15760             UNTIL
 15761         W-VC-NDX GREATER THAN
 15762             W-VARIABLE-SIZE (W-VG-NDX).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 327
* EL689.cbl
 15763
 15764     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 15765
 15766     IF  W-FORM-SQUEEZE-ON
 15767         GO TO 7430-EXIT.
 15768
 15769     IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +6
 15770         SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 15771         SET W-TX-NDX DOWN BY +6
 15772         IF  W-TX-NDX GREATER THAN +70
 15773             SET W-TX-NDX        TO +70.
 15774
 15775     IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 15776         SET W-WC-NDX DOWN BY +1.
 15777
 15778 7430-EXIT.
 15779     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 328
* EL689.cbl
 15781 7435-MOVE-VARIABLE-DIRECT.
 15782
 15783     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 15784             AND
 15785         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 15786             AND
 15787         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 15788             AND
 15789         (W-VC-NDX GREATER THAN +1
 15790                 AND
 15791             W-LAST-CHAR NOT EQUAL SPACE
 15792                 AND
 15793             NOT W-LAST-CHAR-PUNC)
 15794         IF  W-LC-USE-BOTH-CASES
 15795             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15796                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 15797         ELSE
 15798             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15799                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 15800
 15801     SET W-WC-NDX UP BY +1.
 15802     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15803                                 TO W-WORK-CHAR (W-WC-NDX)
 15804                                    W-LAST-CHAR.
 15805
 15806 7435-EXIT.
 15807     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 329
* EL689.cbl
 15809 7437-FIND-NEXT-CHARACTER.
 15810*DELIBERATELY LEFT BLANK.
 15811 7437-EXIT.
 15812     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 330
* EL689.cbl
 15814 7440-BACK-TO-NEAREST-WORD.
 15815
 15816     MOVE SPACES                 TO W-WORK-CHAR (W-WC-NDX).
 15817
 15818 7440-EXIT.
 15819     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 331
* EL689.cbl
 15821 7450-SQUEEZING.
 15822
 15823     IF  W-NEW-PARAGRAPH
 15824         PERFORM 7600-SET-PARA-INDENT THRU 7600-EXIT
 15825         MOVE SPACES             TO W-LINE-SQUEEZE-IND
 15826         IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15827             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15828             MOVE W-TX-PC (W-TG-NDX)
 15829                                 TO W-PRINT-CONTROL
 15830             MOVE SPACES         TO W-SQUEEZED-LINE
 15831             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 15832             SET W-SQ-NDX UP BY W-WORK-INDENT
 15833         ELSE
 15834             MOVE W-TX-PC (W-TG-NDX)
 15835                                 TO W-PRINT-CONTROL
 15836             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 15837             SET W-SQ-NDX UP BY W-WORK-INDENT
 15838     ELSE
 15839         IF  W-DO-NOT-ADJUST
 15840             MOVE SPACES         TO W-LINE-SQUEEZE-IND
 15841             IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15842                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15843                 MOVE W-WORK-LINE
 15844                                 TO W-SQUEEZED-LINE
 15845                 MOVE W-TX-PC (W-TG-NDX)
 15846                                 TO W-PRINT-CONTROL
 15847                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15848                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 15849                 MOVE SPACES     TO W-SQUEEZED-LINE
 15850                 GO TO 7450-EXIT
 15851             ELSE
 15852                 MOVE W-WORK-LINE
 15853                                 TO W-SQUEEZED-LINE
 15854                 MOVE W-TX-PC (W-TG-NDX)
 15855                                 TO W-PRINT-CONTROL
 15856                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15857                 MOVE SPACES     TO W-SQUEEZED-LINE
 15858                                    W-WORK-LINE
 15859                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 15860                 GO TO 7450-EXIT
 15861         ELSE
 15862             IF  W-ADJUST-TO-LINE-LENGTH
 15863                 MOVE SPACES     TO W-LINE-SQUEEZE-IND
 15864
 15865                 IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15866                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15867                     SET W-SQ-NDX
 15868                                 TO W-INITIAL-COLUMN
 15869                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 15870                             VARYING
 15871                         W-WC-NDX FROM 1 BY 1
 15872                             UNTIL
 15873                         W-SQ-NDX EQUAL W-TOO-FAR
 15874                     MOVE W-TX-PC (W-TG-NDX)
 15875                                 TO W-PRINT-CONTROL
 15876                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15877                     SET W-SQ-NDX
 15878                                 TO W-INITIAL-COLUMN
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 332
* EL689.cbl
 15879                     MOVE SPACES TO W-SQUEEZED-LINE
 15880                                    W-WORK-LINE
 15881                     GO TO 7450-EXIT
 15882                 ELSE
 15883                     SET W-SQ-NDX
 15884                                 TO W-INITIAL-COLUMN
 15885                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 15886                             VARYING
 15887                         W-WC-NDX FROM 1 BY 1
 15888                             UNTIL
 15889                         W-SQ-NDX EQUAL W-TOO-FAR
 15890                     MOVE W-TX-PC (W-TG-NDX)
 15891                                 TO W-PRINT-CONTROL
 15892                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15893                     MOVE SPACES TO W-SQUEEZED-LINE
 15894                                    W-WORK-LINE
 15895                     SET W-SQ-NDX
 15896                                 TO W-INITIAL-COLUMN
 15897                     GO TO 7450-EXIT
 15898             ELSE
 15899                 IF  W-CONTINUE-PARAGRAPH
 15900                     IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15901                         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15902                         PERFORM 7610-SET-CONP-INDENT
 15903                             THRU 7610-EXIT
 15904                         MOVE SPACES
 15905                                 TO W-LINE-SQUEEZE-IND
 15906                         MOVE W-TX-PC (W-TG-NDX)
 15907                                 TO W-PRINT-CONTROL
 15908                         MOVE SPACES
 15909                                 TO W-SQUEEZED-LINE
 15910                         SET W-SQ-NDX
 15911                                 TO W-INITIAL-COLUMN
 15912                         SET W-SQ-NDX UP BY W-WORK-INDENT
 15913                     ELSE
 15914                         PERFORM 7610-SET-CONP-INDENT
 15915                             THRU 7610-EXIT
 15916                         MOVE SPACES
 15917                                 TO W-LINE-SQUEEZE-IND
 15918                         MOVE W-TX-PC (W-TG-NDX)
 15919                                 TO W-PRINT-CONTROL
 15920                         MOVE SPACES
 15921                                 TO W-SQUEEZED-LINE
 15922                         SET W-SQ-NDX
 15923                                 TO W-INITIAL-COLUMN
 15924                         SET W-SQ-NDX UP BY W-WORK-INDENT.
 15925
 15926
 15927     PERFORM 7480-UPDATE-SQUEEZED-LINE THRU 7480-EXIT
 15928             VARYING
 15929         W-WC-NDX FROM +1 BY +1
 15930             UNTIL
 15931         W-WC-NDX GREATER THAN +70.
 15932
 15933 7450-EXIT.
 15934     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 333
* EL689.cbl
 15936 7460-REMAIN-CHAR-CHECK.
 15937
 15938     IF  W-TX-NDX EQUAL W-WC-NDX
 15939         MOVE W-TX-PC (W-TG-NDX)
 15940                                 TO W-PRINT-CONTROL
 15941         MOVE W-WORK-LINE        TO W-SQUEEZED-LINE
 15942         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15943         MOVE SPACES             TO W-WORK-LINE
 15944         SET W-WC-NDX            TO +1
 15945     ELSE
 15946         SET W-TX-NDX1           TO W-TX-NDX
 15947         SEARCH W-TX-CHAR
 15948             VARYING W-TX-NDX1
 15949             AT END
 15950                 MOVE W-TX-PC (W-TG-NDX)
 15951                                 TO W-PRINT-CONTROL
 15952                 MOVE W-WORK-LINE
 15953                                 TO W-SQUEEZED-LINE
 15954                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15955                 MOVE SPACES     TO W-WORK-LINE
 15956                 SET W-WC-NDX    TO +1
 15957                 SET W-TX-NDX    TO +1
 15958                 SET W-TG-NDX UP BY +1
 15959             WHEN
 15960                 W-TX-CHAR (W-TG-NDX W-TX-NDX1) NOT EQUAL SPACES
 15961                 MOVE ER-9427    TO EMI-ERROR
 15962                 MOVE -1         TO MAINTL
 15963                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15964                 MOVE W-TX-PC (W-TG-NDX)
 15965                                 TO W-PRINT-CONTROL
 15966                 MOVE W-WORK-LINE
 15967                                 TO W-SQUEEZED-LINE
 15968                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15969                 MOVE SPACES     TO W-WORK-LINE
 15970                 SET W-WC-NDX    TO +1.
 15971
 15972 7460-EXIT.
 15973     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 334
* EL689.cbl
 15975 7470-MOVE-CHAR.
 15976
 15977     IF  W-FIRST-CHAR-NOT-FOUND
 15978             AND
 15979         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 15980         MOVE SPACES             TO W-LAST-CHAR
 15981         GO TO 7470-EXIT.
 15982
 15983     MOVE 'Y'                    TO W-FIRST-CHAR-FOUND-IND.
 15984
 15985     IF  W-SQUEEZE-FIELD
 15986             AND
 15987         W-LAST-CHAR EQUAL SPACES
 15988             AND
 15989         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 15990         GO TO 7470-EXIT.
 15991
 15992     SET W-WC-NDX UP BY +1.
 15993
 15994     IF  W-WC-NDX GREATER THAN +70
 15995         IF  W-FORM-SQUEEZE-ON
 15996             GO TO 7470-EXIT
 15997         ELSE
 15998             MOVE ER-9427        TO EMI-ERROR
 15999             MOVE -1             TO MAINTL
 16000             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16001             GO TO 7470-EXIT.
 16002
 16003     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 16004             AND
 16005         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 16006             AND
 16007         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 16008             AND
 16009         (W-VC-NDX GREATER THAN +1
 16010                 AND
 16011             W-LAST-CHAR NOT EQUAL SPACE
 16012                 AND
 16013             NOT W-LAST-CHAR-PUNC)
 16014         IF  W-LC-USE-BOTH-CASES
 16015             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 16016                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 16017         ELSE
 16018             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 16019                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 16020
 16021     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 16022                                 TO W-WORK-CHAR (W-WC-NDX)
 16023                                    W-LAST-CHAR.
 16024
 16025     IF  W-LAST-CHAR EQUAL SPACES
 16026         SET W-LAST-WC-SPACE     TO W-WC-NDX.
 16027
 16028 7470-EXIT.
 16029     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 335
* EL689.cbl
 16031 7480-UPDATE-SQUEEZED-LINE.
 16032****************************************************************
 16033*    THIS SECTION CONTROLS THE MOVEMENT FROM THE WORK LINE TO *
 16034*    THE SQUEEZED LINE.  DURING THIS PROCESS ALL EXTRA SPACES  *
 16035*    (DEFINED AS TWO OR MORE SPACES NOT FOLLOWING A END OF     *
 16036*    SENTENCE INDICATOR) ARE REMOVED.  IF THE LAST CHARACTER   *
 16037*    IS NOT A SPACE OR PUNCTUATION MARK AN UNFINISHED WORD IS  *
 16038*    ASSUMED.  EVERYTHING TO THE PREVIOUS SPACE IS REMOVED     *
 16039****************************************************************
 16040
 16041     SET W-SQ-NDX UP BY +1.
 16042
 16043     IF  W-SQ-NDX GREATER THAN W-LAST-COLUMN
 16044         MOVE W-SQ-CHAR (W-LAST-COLUMN)
 16045                                 TO W-CHARACTER-TYPE
 16046         IF  W-PUNCTUATION
 16047                 OR
 16048             W-SPACE
 16049             PERFORM 7485-FIND-NEXT-CHARACTER THRU 7485-EXIT
 16050             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 16051             MOVE SPACES         TO W-SQUEEZED-LINE
 16052             SET W-SQ-NDX        TO W-START-COLUMN
 16053             SET W-SQ-NDX UP BY W-NEXT-INDENT
 16054             SET W-LAST-SQUEEZED-SPACE
 16055                                 TO W-SQ-NDX
 16056         ELSE
 16057             PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 16058             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 16059             MOVE SPACES         TO W-SQUEEZED-LINE
 16060             SET W-SQ-NDX        TO W-START-COLUMN
 16061             SET W-SQ-NDX UP BY W-NEXT-INDENT
 16062             SET W-LAST-SQUEEZED-SPACE
 16063                                 TO W-SQ-NDX.
 16064
 16065     IF  W-WC-NDX GREATER THAN +70
 16066         GO TO 7480-EXIT.
 16067
 16068     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 16069
 16070     IF  W-END-OF-SENTENCE
 16071         MOVE 'Y'                TO W-END-OF-SENTENCE-IND
 16072         SET W-WORK-NDX          TO W-SQ-NDX
 16073         COMPUTE W-DISPLAY-NDX = W-WORK-NDX - 1
 16074         IF  W-DISPLAY-NDX EQUAL W-LAST-SQUEEZED-SPACE
 16075             SET W-SQ-NDX        TO W-LAST-SQUEEZED-SPACE
 16076         ELSE
 16077             NEXT SENTENCE
 16078     ELSE
 16079         IF  W-PUNCTUATION
 16080                 AND
 16081             W-LAST-SQ-CHAR EQUAL SPACES
 16082             SET W-SQ-NDX DOWN BY +1
 16083             MOVE SPACES         TO W-END-OF-SENTENCE-IND
 16084         ELSE
 16085             IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 16086                 IF  W-LAST-SQ-CHAR EQUAL SPACES
 16087                     IF  W-END-OF-SENTENCE-WORKING
 16088                         MOVE SPACES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 336
* EL689.cbl
 16089                                 TO W-END-OF-SENTENCE-IND
 16090                         SET W-LAST-SQUEEZED-SPACE
 16091                                 TO W-SQ-NDX
 16092                     ELSE
 16093                         SET W-SQ-NDX DOWN BY +1
 16094                         GO TO 7480-EXIT
 16095                 ELSE
 16096                     SET W-LAST-SQUEEZED-SPACE
 16097                                 TO W-SQ-NDX
 16098             ELSE
 16099                 MOVE SPACES     TO W-END-OF-SENTENCE-IND.
 16100
 16101     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX)
 16102                                    W-LAST-SQ-CHAR.
 16103
 16104     IF  W-WC-NDX EQUAL +70
 16105             AND
 16106         W-WORK-CHAR (W-WC-NDX) GREATER THAN SPACES
 16107             AND
 16108         W-SQ-NDX NOT EQUAL W-LAST-COLUMN
 16109         SET W-SQ-NDX UP BY +1
 16110         SET W-LAST-SQUEEZED-SPACE
 16111                                 TO W-SQ-NDX
 16112         MOVE SPACES             TO W-SQ-CHAR (W-SQ-NDX)
 16113                                    W-LAST-SQ-CHAR.
 16114
 16115 7480-EXIT.
 16116     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 337
* EL689.cbl
 16118 7485-FIND-NEXT-CHARACTER.
 16119
 16120     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 16121
 16122     IF  W-PUNCTUATION
 16123         PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 16124     ELSE
 16125         SET W-WC-NDX            TO W-WC-NDX
 16126         SEARCH W-WORK-CHAR
 16127             VARYING W-WC-NDX
 16128             AT END
 16129                 GO TO 7485-EXIT
 16130             WHEN
 16131                 W-WORK-CHAR (W-WC-NDX) NOT EQUAL SPACES
 16132                 GO TO 7485-EXIT.
 16133
 16134 7485-EXIT.
 16135     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 338
* EL689.cbl
 16137 7490-REMOVE-LAST-WORD.
 16138
 16139*********  NOTE: W-WORK-LINE ALWAYS STARTS WITH A FULL WORD*******
 16140     IF  W-WC-NDX EQUAL +1
 16141         GO TO 7490-EXIT.
 16142
 16143     ADD +1                      TO W-LAST-SQUEEZED-SPACE.
 16144
 16145     PERFORM 7500-CLEAR-SQUEEZED-EXCESS THRU 7500-EXIT
 16146             VARYING
 16147         W-SQ-NDX FROM W-LAST-SQUEEZED-SPACE BY +1
 16148             UNTIL
 16149         W-SQ-NDX EQUAL W-TOO-FAR.
 16150
 16151     SET W-WORK-NDX              TO W-WC-NDX.
 16152     COMPUTE W-LAST-WC-SPACE
 16153         = W-WORK-NDX - W-TOO-FAR + W-LAST-SQUEEZED-SPACE.
 16154     SET W-WC-NDX                TO W-LAST-WC-SPACE.
 16155
 16156 7490-EXIT.
 16157     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 339
* EL689.cbl
 16159 7500-CLEAR-SQUEEZED-EXCESS.
 16160
 16161     MOVE SPACES                 TO W-SQ-CHAR (W-SQ-NDX).
 16162
 16163 7500-EXIT.
 16164     EXIT.
 16165
 16166 7505-MOVE-STRAIGHT.
 16167
 16168     SET W-SQ-NDX UP BY +1.
 16169
 16170     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX).
 16171
 16172 7505-EXIT.
 16173     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 340
* EL689.cbl
 16175 7510-MOVE-TO-TABLE.
 16176
 16177     IF  W-PRINT-CONTROL NOT NUMERIC
 16178         MOVE 00                 TO W-PRINT-CONTROL
 16179         ADD +1                  TO W-LINE-COUNT
 16180     ELSE
 16181         IF  W-PRINT-CONTROL EQUAL 99
 16182             PERFORM 7640-PAGING THRU 7640-EXIT
 16183             MOVE 00             TO W-PRINT-CONTROL
 16184             SET W-RG-NDX UP BY +1
 16185             MOVE W-TOP-FORM     TO W-RC-TEXT (W-RG-NDX)
 16186             MOVE +1             TO W-LINE-COUNT
 16187             SET W-RG-NDX UP BY W-TOP-MARGIN
 16188         ELSE
 16189           IF W-SQUEEZED-LINE (1:6) NOT EQUAL '&&&&&&'
 16190             COMPUTE W-LINE-COUNT
 16191                 = W-LINE-COUNT + W-PRINT-CONTROL + 1.
 16192
 16193     IF  W-LINE-COUNT GREATER THAN W-MAX-LINES-PER-PAGE
 16194         PERFORM 7640-PAGING THRU 7640-EXIT
 16195         MOVE 00                 TO W-PRINT-CONTROL
 16196         SET W-RG-NDX UP BY +1
 16197         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 16198         SET W-RG-NDX UP BY W-TOP-MARGIN
 16199         MOVE +1                 TO W-LINE-COUNT.
 16200
 16201     SET W-RG-NDX UP BY W-PRINT-CONTROL.
 16202     SET W-RG-NDX UP BY +1.
 16203     MOVE W-SQUEEZED-LINE        TO W-RC-TEXT (W-RG-NDX).
 16204     MOVE 00                     TO W-PRINT-CONTROL.
 16205
 16206     IF  W-FIRST-BAD-VARIABLE-FOUND
 16207             AND
 16208         W-FIRST-BAD-VARIABLE EQUAL ZEROS
 16209         SET W-FIRST-BAD-VARIABLE
 16210                                 TO W-RG-NDX.
 16211
 16212 7510-EXIT.
 16213     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 341
* EL689.cbl
 16215 7600-SET-PARA-INDENT.
 16216
 16217     IF  W-LINE-SQUEEZE-IND EQUAL 'P'
 16218         MOVE W-PARAGRAPH-INDENT TO W-WORK-INDENT
 16219     ELSE
 16220     IF  W-LINE-SQUEEZE-IND EQUAL 'Q'
 16221         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 16222         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16223     ELSE
 16224     IF  W-LINE-SQUEEZE-IND EQUAL 'R'
 16225         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 16226         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16227     ELSE
 16228     IF  W-LINE-SQUEEZE-IND EQUAL 'S'
 16229         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 16230         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16231     ELSE
 16232     IF  W-LINE-SQUEEZE-IND EQUAL 'T'
 16233         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 16234         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16235     ELSE
 16236     IF  W-LINE-SQUEEZE-IND EQUAL 'U'
 16237         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT
 16238         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT.
 16239
 16240     SET W-TG-NDX2               TO W-TG-NDX.
 16241     SET W-TG-NDX2 UP BY +1.
 16242
 16243     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 16244         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16245     ELSE
 16246         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 16247
 16248 7600-EXIT.
 16249     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 342
* EL689.cbl
 16251 7610-SET-CONP-INDENT.
 16252
 16253     IF  W-LINE-SQUEEZE-IND EQUAL 'C'
 16254         MOVE +0                 TO W-WORK-INDENT
 16255     ELSE
 16256     IF  W-LINE-SQUEEZE-IND EQUAL 'D'
 16257         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 16258     ELSE
 16259     IF  W-LINE-SQUEEZE-IND EQUAL 'E'
 16260         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 16261     ELSE
 16262     IF  W-LINE-SQUEEZE-IND EQUAL 'F'
 16263         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 16264     ELSE
 16265     IF  W-LINE-SQUEEZE-IND EQUAL 'G'
 16266         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 16267     ELSE
 16268     IF  W-LINE-SQUEEZE-IND EQUAL 'H'
 16269         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT.
 16270
 16271     SET W-TG-NDX2               TO W-TG-NDX.
 16272     SET W-TG-NDX2 UP BY +1.
 16273
 16274     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 16275         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16276     ELSE
 16277         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 16278
 16279 7610-EXIT.
 16280     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 343
* EL689.cbl
 16282 7630-NEXT-LINE.
 16283
 16284     IF  W-TX-SC (W-TG-NDX2) EQUAL ' '
 16285         MOVE ZEROS              TO W-NEXT-INDENT
 16286     ELSE
 16287     IF  W-TX-SC (W-TG-NDX2) EQUAL '1'
 16288         MOVE W-LINE-INDENT-1    TO W-NEXT-INDENT
 16289     ELSE
 16290     IF  W-TX-SC (W-TG-NDX2) EQUAL '2'
 16291         MOVE W-LINE-INDENT-2    TO W-NEXT-INDENT
 16292     ELSE
 16293     IF  W-TX-SC (W-TG-NDX2) EQUAL '3'
 16294         MOVE W-LINE-INDENT-3    TO W-NEXT-INDENT
 16295     ELSE
 16296     IF  W-TX-SC (W-TG-NDX2) EQUAL '4'
 16297         MOVE W-LINE-INDENT-4    TO W-NEXT-INDENT
 16298     ELSE
 16299     IF  W-TX-SC (W-TG-NDX2) EQUAL '5'
 16300         MOVE W-LINE-INDENT-5    TO W-NEXT-INDENT
 16301     ELSE
 16302         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16303         SUBTRACT W-PARAGRAPH-INDENT
 16304                                  FROM W-NEXT-INDENT.
 16305
 16306 7630-EXIT.
 16307     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 344
* EL689.cbl
 16309 7640-PAGING.
 16310
 16311     IF  NOT W-LC-CREATE-PAGES
 16312         GO TO 7640-EXIT.
 16313
 16314     IF  W-LINE-COUNT GREATER ZEROS
 16315             AND
 16316         W-RG-NDX GREATER THAN +1
 16317         ADD +1                  TO W-PAGE
 16318         MOVE W-PAGE             TO W-PAGE-NUMBER
 16319         COMPUTE W-PAGE-LINE
 16320             = W-MAX-LINES-PER-PAGE - W-LINE-COUNT + 3
 16321         IF  W-PAGE-LINE GREATER THAN +2
 16322             SET W-RG-NDX UP BY W-PAGE-LINE
 16323             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX)
 16324         ELSE
 16325             SET W-RG-NDX UP BY +2
 16326             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX).
 16327
 16328 7640-EXIT.
 16329     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 345
* EL689.cbl
 16331 7700-READ-TEXT-TS.
 16332**************************************************************
 16333*  THIS PARAGRAPH READS THE TEMPORARY STORAGE RECORDS THAT   *
 16334*  CONTAIN THE TEXT THAT IS PAST BETWEEN EL689, EL6892       *
 16335*  AND EL1042.                                               *
 16336**************************************************************
 16337
 16338
 16339* EXEC CICS HANDLE CONDITION
 16340*         QIDERR     (7700-TS-ERROR)
 16341*         ITEMERR    (7700-TS-ERROR)
 16342*    END-EXEC.
 16343*    MOVE '"$N<                  ! 9 #00015232' TO DFHEIV0
 16344     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 16345     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16346     MOVE X'3920233030303135323332' TO DFHEIV0(25:11)
 16347     CALL 'kxdfhei1' USING DFHEIV0
 16348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16349
 16350
 16351     SET W-TS-NDX                TO 1.
 16352     MOVE 1                      TO W-TS-ITEM.
 16353
 16354 7700-LOOP.
 16355
 16356     IF  W-TS-ITEM GREATER THAN PI-TEMP-STOR-ITEMS
 16357         IF  PI-TEMP-STOR-ITEMS GREATER THAN ZEROS
 16358             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 16359             GO TO 7700-EXIT
 16360         ELSE
 16361             GO TO 7700-EXIT.
 16362
 16363
 16364* EXEC CICS READQ TS
 16365*         INTO     (W-TS-WORK-AREA)
 16366*         QUEUE    (W-TS-NAME-TEXT)
 16367*         LENGTH   (W-TS-LENGTH)
 16368*         ITEM     (W-TS-ITEM)
 16369*    END-EXEC.
 16370*    MOVE '*$II   L              ''   #00015249' TO DFHEIV0
 16371     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 16372     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16373     MOVE X'2020233030303135323439' TO DFHEIV0(25:11)
 16374     CALL 'kxdfhei1' USING DFHEIV0,
 16375           W-TS-NAME-TEXT,
 16376           W-TS-WORK-AREA,
 16377           W-TS-LENGTH,
 16378           W-TS-ITEM,
 16379           DFHEIV99,
 16380           DFHEIV99
 16381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16382
 16383
 16384     MOVE W-TS-WORK-AREA         TO W-TS-GROUP (W-TS-NDX).
 16385     SET W-TS-NDX UP BY 1.
 16386     ADD 1                       TO W-TS-ITEM.
 16387     GO TO 7700-LOOP.
 16388
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 346
* EL689.cbl
 16389 7700-TS-ERROR.
 16390
 16391     IF  EIBTRNID = W-TRANSACTION OR 'EX14'
 16392         MOVE ER-0033            TO EMI-ERROR
 16393         MOVE -1                 TO MAINTL
 16394         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16395         GO TO 8200-SEND-DATAONLY.
 16396
 16397 7700-EXIT.
 16398      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 347
* EL689.cbl
 16400 7740-RESTORE-SCREEN.
 16401
 16402     MOVE 'C'                    TO MAINTI.
 16403     MOVE +1                     TO MAINTL.
 16404     MOVE AL-UANON               TO MAINTA.
 16405
 16406     MOVE PI-689-FORM-NUMBER     TO FORMI.
 16407     MOVE +4                     TO FORML.
 16408     MOVE AL-UANON               TO FORMA.
 16409
 16410*    IF  PI-689-PRINT-RESTRICTION GREATER THAN SPACES
 16411*        MOVE PI-689-PRINT-RESTRICTION
 16412*                                TO PRTRESTL
 16413*        MOVE +1                 TO PRTRESTL
 16414*        MOVE AL-UANON           TO PRTRESTA.
 16415
 16416     IF  PI-689-FOLLOW-UP-EDIT GREATER THAN SPACES
 16417         MOVE PI-689-FOLLOW-UP-EDIT
 16418                                 TO FOLLOWI
 16419         MOVE +8                 TO FOLLOWL
 16420         MOVE AL-UANON           TO FOLLOWA.
 16421
 16422     IF  PI-689-RESEND1-EDIT GREATER THAN SPACES
 16423         MOVE PI-689-RESEND1-EDIT
 16424                                 TO RESEND1I
 16425         MOVE +8                 TO RESEND1L
 16426         MOVE AL-UANON           TO RESEND1A.
 16427     IF  PI-689-ALT-PRINTER-ID GREATER THAN SPACES
 16428         MOVE PI-689-ALT-PRINTER-ID
 16429                                 TO PRINTERI
 16430         MOVE +1                 TO PRINTERL
 16431         MOVE AL-UANON           TO PRINTERA.
 16432
 16433     IF  PI-BYPASS-LABELS
 16434          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 16435          MOVE +1                TO ADDRLBLL
 16436          MOVE AL-UANON          TO ADDRLBLA
 16437     ELSE
 16438          IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 16439               MOVE PI-689-LBL-OVERRIDE
 16440                                 TO ADDRLBLI
 16441               MOVE +1           TO ADDRLBLL
 16442               MOVE AL-UANON     TO ADDRLBLA.
 16443
 16444     IF  PI-689-NUMBER-COPIES GREATER THAN ZEROS
 16445         MOVE PI-689-NUMBER-COPIES   TO COPIESI
 16446         MOVE +1                     TO COPIESL
 16447         MOVE AL-UNNON               TO COPIESA.
 16448
 16449     IF  PI-689-LABEL-SOURCE GREATER THAN SPACES
 16450         MOVE PI-689-LABEL-SOURCE
 16451                                 TO ADDRSI
 16452         MOVE +1                 TO ADDRSL
 16453         MOVE AL-UANON           TO ADDRSA.
 16454
 16455     MOVE PI-689-DATA-SOURCE     TO DATASORI.
 16456     MOVE +1                     TO DATASORL.
 16457     MOVE AL-UANON               TO DATASORA.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 348
* EL689.cbl
 16458
 16459     IF  PI-689-CARRIER GREATER THAN SPACES
 16460         MOVE PI-689-CARRIER     TO CARRIERI
 16461         MOVE +1                 TO CARRIERL
 16462         MOVE AL-UANON           TO CARRIERA.
 16463
 16464     IF  PI-689-GROUPING GREATER THAN SPACES
 16465         MOVE PI-689-GROUPING    TO GROUPI
 16466         MOVE +6                 TO GROUPL
 16467         MOVE AL-UANON           TO GROUPA.
 16468
 16469     IF  PI-689-STATE GREATER THAN SPACES
 16470         MOVE PI-689-STATE       TO STATEI
 16471         MOVE +2                 TO STATEL
 16472         MOVE AL-UANON           TO STATEA.
 16473
 16474     IF  PI-689-ACCOUNT GREATER THAN SPACES
 16475         MOVE PI-689-ACCOUNT     TO ACCTI
 16476         MOVE +10                TO ACCTL
 16477         MOVE AL-UANON           TO ACCTA.
 16478
 16479     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 16480         MOVE PI-689-CERT-PRIME  TO CERTI
 16481         MOVE +10                TO CERTL
 16482         MOVE AL-UANON           TO CERTA.
 16483
 16484     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 16485         MOVE PI-689-CERT-SFX    TO SFXI
 16486         MOVE +1                 TO SFXL
 16487         MOVE AL-UANON           TO SFXA.
 16488
 16489     IF  PI-689-TYPE GREATER THAN SPACES
 16490         MOVE PI-689-TYPE        TO TYPEI
 16491         MOVE +1                 TO TYPEL
 16492         MOVE AL-UANON           TO TYPEA.
 16493
 16494     IF  PI-689-RESP-PERSON GREATER THAN SPACES
 16495         MOVE PI-689-RESP-PERSON TO RPERSONI
 16496         MOVE +10                TO RPERSONL
 16497         MOVE AL-UANON           TO RPERSONA.
 16498
 16499     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 16500         MOVE PI-689-ENTRY-BATCH TO BENTRYI
 16501         MOVE +6                 TO BENTRYL
 16502         MOVE AL-UANON           TO BENTRYA.
 16503
 16504     IF  PI-689-SEQ-EDIT GREATER THAN SPACES
 16505         MOVE PI-689-SEQ-EDIT    TO SEQI
 16506         MOVE +8                 TO SEQL
 16507         MOVE AL-UNNON           TO SEQA.
 16508
 16509     IF  PI-689-BCSEQ-EDIT GREATER THAN SPACES
 16510         MOVE PI-689-BCSEQ-EDIT  TO BCSEQI
 16511         MOVE +4                 TO BCSEQL
 16512         MOVE AL-UNNON           TO BCSEQA.
 16513
 16514     IF  PI-689-DATE-EDIT GREATER THAN SPACES
 16515         MOVE PI-689-DATE-EDIT   TO DATEI
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 349
* EL689.cbl
 16516         MOVE +8                 TO DATEL
 16517         MOVE AL-UNNON           TO DATEA.
 16518
 16519     IF PI-CERT-FORM-ID GREATER THAN SPACES
 16520        MOVE PI-CERT-FORM-ID     TO CERTIDI
 16521        MOVE +5                  TO CERTIDL
 16522        MOVE AL-UNNON            TO CERTIDA
 16523     END-IF.
 16524
 16525     IF PI-PRINT-NOW GREATER THAN SPACES
 16526        MOVE PI-PRINT-NOW        TO PRTNOWI
 16527        MOVE +1                  TO PRTNOWL
 16528        MOVE AL-UNNON            TO PRTNOWA
 16529     END-IF.
 16530     IF PI-ENDT-ARCH-NO GREATER THAN ZERO
 16531        MOVE PI-ENDT-ARCH-NO     TO ENDARCHI
 16532        MOVE +8                  TO ENDARCHL
 16533        MOVE AL-UNNON            TO ENDARCHA
 16534     END-IF
 16535
 16536     MOVE PI-ENCLOSURE-CD        TO ENCI.
 16537     MOVE +3                     TO ENCL.
 16538     MOVE AL-UANON               TO ENCA.
 16539
 16540 7749-EXIT.
 16541     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 350
* EL689.cbl
 16543 7760-PUT-TEMP-STORAGE.
 16544**************************************************************
 16545*  THIS PARAGRAPH WRITES THE TEMPORARY STORAGE RECORDS THAT  *
 16546*  WILL CONTAIN THE CONTENTS OF THE TEXT TABLE FOR USE BY    *
 16547*  EL1042 AND EL6892.                                        *
 16548**************************************************************
 16549
 16550     SET W-TS-NDX                TO 1.
 16551     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 16552
 16553     MOVE -1                     TO MAINTL.
 16554     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 16555             VARYING
 16556         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 16557             UNTIL
 16558         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 16559
 16560 7760-EXIT.
 16561      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 351
* EL689.cbl
 16563 7780-DELETE-TEMP-STOR-TEXT.
 16564
 16565
 16566* EXEC CICS HANDLE CONDITION
 16567*         QIDERR      (7780-EXIT)
 16568*    END-EXEC.
 16569*    MOVE '"$N                   ! : #00015437' TO DFHEIV0
 16570     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 16571     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16572     MOVE X'3A20233030303135343337' TO DFHEIV0(25:11)
 16573     CALL 'kxdfhei1' USING DFHEIV0
 16574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16575
 16576
 16577
 16578* EXEC CICS DELETEQ TS
 16579*         QUEUE       (W-TS-NAME-TEXT)
 16580*    END-EXEC.
 16581*    MOVE '*&                    #   #00015441' TO DFHEIV0
 16582     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 16583     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16584     MOVE X'2020233030303135343431' TO DFHEIV0(25:11)
 16585     CALL 'kxdfhei1' USING DFHEIV0,
 16586           W-TS-NAME-TEXT,
 16587           DFHEIV99
 16588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16589
 16590
 16591 7780-EXIT.
 16592     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 352
* EL689.cbl
 16594 7840-WRITE-TS.
 16595
 16596     MOVE W-TS-GROUP (W-TS-NDX)  TO W-TS-WORK-AREA.
 16597     SET W-TS-NDX UP BY 1.
 16598     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 16599
 16600
 16601* EXEC CICS WRITEQ TS
 16602*         FROM    (W-TS-WORK-AREA)
 16603*         QUEUE   (W-TS-NAME-TEXT)
 16604*         LENGTH  (W-TS-LENGTH)
 16605*         ITEM    (PI-TEMP-STOR-ITEMS)
 16606*    END-EXEC.
 16607*    MOVE '*" I   L              ''   #00015454' TO DFHEIV0
 16608     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 16609     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16610     MOVE X'2020233030303135343534' TO DFHEIV0(25:11)
 16611     CALL 'kxdfhei1' USING DFHEIV0,
 16612           W-TS-NAME-TEXT,
 16613           W-TS-WORK-AREA,
 16614           W-TS-LENGTH,
 16615           PI-TEMP-STOR-ITEMS,
 16616           DFHEIV99,
 16617           DFHEIV99
 16618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16619
 16620
 16621 7840-EXIT.
 16622     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 353
* EL689.cbl
 16624 7900-PRINT-LETTER-NOW.
 16625***************************************************************
 16626*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 16627*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 16628*     THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS.          *
 16629*     THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE.       *
 16630*     THE LETTER IS SAVED IN TEMP-STORAGE AND A START IS      *
 16631*     ISSUED FOR THE PRINT TRANSACTION.                       *
 16632***************************************************************
 16633
 16634*    IF (EIBAID = DFHPF4 OR DFHPF8)
 16635*            AND
 16636*        PI-SHOW-MODE
 16637*        IF  PRINTERL GREATER ZERO
 16638*            INSPECT PRINTERI CONVERTING W-LOWER-CASE TO
 16639*                                                    W-UPPER-CASE
 16640*            MOVE PRINTERI       TO PI-689-ALT-PRINTER-ID
 16641*                                   PI-ALT-DMD-PRT-ID.
 16642*
 16643*    IF  EIBAID EQUAL DFHPF8
 16644*            AND
 16645*        PI-SHOW-MODE
 16646*            AND
 16647*        LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
 16648*        MOVE ER-7247            TO EMI-ERROR
 16649*        MOVE -1                 TO MAINTL
 16650*        MOVE AL-UABON           TO MAINTA
 16651*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16652*        GO TO 8200-SEND-DATAONLY.
 16653
 16654     IF  PI-TOTAL-LINES EQUAL 0
 16655         MOVE ER-0187            TO EMI-ERROR
 16656         MOVE -1                 TO MAINTL
 16657         MOVE AL-UABON           TO MAINTA
 16658         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16659         GO TO 8200-SEND-DATAONLY.
 16660
 16661     IF  EMI-ERROR NOT EQUAL ER-0191
 16662         IF  PI-689-CREATE-NO-SCREENS
 16663*                OR
 16664*            (EIBAID = DFHPF4 OR DFHPF8)
 16665             SET W-RG-NDX        TO +1
 16666         ELSE
 16667             PERFORM 4100-SET-NDX THRU 4100-EXIT
 16668             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 16669                     VARYING
 16670                 W-SC-NDX FROM 1 BY 1
 16671                     UNTIL
 16672                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 16673
 16674     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 16675
 16676     IF EIBAID NOT = DFHPF4 AND DFHPF8
 16677         PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 16678                 VARYING
 16679             W-RVS-NDX FROM +1 BY +1
 16680                 UNTIL
 16681             W-RVS-NDX GREATER THAN +36500
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 354
* EL689.cbl
 16682                 OR
 16683             W-REMAINING-VAR-FOUND
 16684         IF  W-REMAINING-VAR-FOUND
 16685             GO TO 4000-ROLL-PAGE.
 16686
 16687*    IF EIBAID = DFHPF4 OR DFHPF8
 16688*       PERFORM 7700-READ-TEXT-TS
 16689*                                THRU 7700-EXIT
 16690*
 16691*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 16692*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 16693*                VARYING
 16694*            W-SC-NDX FROM 1 BY 1
 16695*                UNTIL
 16696*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 16697*
 16698*       PERFORM 7760-PUT-TEMP-STORAGE
 16699*                                THRU 7760-EXIT
 16700*    END-IF
 16701     IF PI-689-ALT-PRINTER-ID NOT = SPACES AND LOW-VALUES
 16702         MOVE PI-689-ALT-PRINTER-ID
 16703                                 TO W-TS-TERM-TEXT
 16704     ELSE
 16705         IF PI-PROCESSOR-PRINTER NOT = SPACES AND LOW-VALUES
 16706             MOVE PI-PROCESSOR-PRINTER
 16707                                 TO W-TS-TERM-TEXT
 16708         ELSE
 16709             MOVE PI-COMPANY-ID  TO W-CNTL-COMPANY-ID
 16710             MOVE '1'            TO W-CNTL-RECORD-TYPE
 16711             MOVE SPACES         TO W-CNTL-GENL
 16712             MOVE ZEROS          TO W-CNTL-SEQ-NO
 16713
 16714* EXEC CICS HANDLE CONDITION
 16715*                 NOTOPEN    (8040-CNTL-NOT-OPEN)
 16716*                 NOTFND     (7945-NOT-FOUND)
 16717*            END-EXEC
 16718*    MOVE '"$JI                  ! ; #00015553' TO DFHEIV0
 16719     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 16720     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16721     MOVE X'3B20233030303135353533' TO DFHEIV0(25:11)
 16722     CALL 'kxdfhei1' USING DFHEIV0
 16723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16724
 16725* EXEC CICS READ
 16726*                 DATASET    (W-CNTL-FILE-ID)
 16727*                 SET        (ADDRESS OF CONTROL-FILE)
 16728*                 RIDFLD     (W-CNTL-KEY)
 16729*            END-EXEC
 16730*    MOVE '&"S        E          (   #00015557' TO DFHEIV0
 16731     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16732     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16733     MOVE X'2020233030303135353537' TO DFHEIV0(25:11)
 16734     CALL 'kxdfhei1' USING DFHEIV0,
 16735           W-CNTL-FILE-ID,
 16736           DFHEIV20,
 16737           DFHEIV99,
 16738           W-CNTL-KEY,
 16739           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 355
* EL689.cbl
 16740           DFHEIV99,
 16741           DFHEIV99
 16742     SET ADDRESS OF CONTROL-FILE TO
 16743         DFHEIV20
 16744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16745             MOVE CF-FORMS-PRINTER-ID
 16746                                 TO W-TS-TERM-TEXT.
 16747
 16748***********************************************************
 16749*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 16750*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 16751***********************************************************
 16752
 16753     SET W-TS-NDX                TO 1.
 16754     MOVE EIBTIME                TO W-TS-ID-TIME.
 16755     MOVE W-TS-NAME-TEXT         TO PI-689-TEMP-STOR-ID.
 16756     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 16757
 16758     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 16759             VARYING
 16760         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 16761             UNTIL
 16762         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 16763
 16764*    IF  EIBAID EQUAL DFHPF8
 16765*        MOVE '1'                TO PI-689-PRINT-SW
 16766*    ELSE
 16767         MOVE SPACES             TO PI-689-PRINT-SW.
 16768
 16769
 16770* EXEC CICS HANDLE CONDITION
 16771*         TERMIDERR  (7935-TERM-ERROR)
 16772*         TRANSIDERR (7940-TRAN-ERROR)
 16773*    END-EXEC.
 16774*    MOVE '"$[\                  ! < #00015586' TO DFHEIV0
 16775     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 16776     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16777     MOVE X'3C20233030303135353836' TO DFHEIV0(25:11)
 16778     CALL 'kxdfhei1' USING DFHEIV0
 16779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16780
 16781
 16782
 16783* EXEC CICS START
 16784*             INTERVAL    (0)
 16785*             TRANSID     (W-PRINT-TRANS)
 16786*             FROM        (PROGRAM-INTERFACE-BLOCK)
 16787*             LENGTH      (PI-COMM-LENGTH)
 16788*             TERMID      (W-TS-TERM-TEXT)
 16789*    END-EXEC.
 16790     MOVE 0 TO DFHEIV10
 16791*    MOVE '0(ILFT                1   #00015591' TO DFHEIV0
 16792     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 16793     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
 16794     MOVE X'2020233030303135353931' TO DFHEIV0(25:11)
 16795     CALL 'kxdfhei1' USING DFHEIV0,
 16796           DFHEIV10,
 16797           W-PRINT-TRANS,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 356
* EL689.cbl
 16798           DFHEIV99,
 16799           PROGRAM-INTERFACE-BLOCK,
 16800           PI-COMM-LENGTH,
 16801           W-TS-TERM-TEXT,
 16802           DFHEIV99,
 16803           DFHEIV99,
 16804           DFHEIV99,
 16805           DFHEIV99,
 16806           DFHEIV99,
 16807           DFHEIV99,
 16808           DFHEIV99,
 16809           DFHEIV99,
 16810           DFHEIV99,
 16811           DFHEIV99
 16812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16813
 16814
 16815
 16816* EXEC CICS SYNCPOINT
 16817*    END-EXEC.
 16818*    MOVE '6"                    !   #00015599' TO DFHEIV0
 16819     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
 16820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16821     MOVE X'2020233030303135353939' TO DFHEIV0(25:11)
 16822     CALL 'kxdfhei1' USING DFHEIV0
 16823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16824
 16825
 16826     IF  PI-689-CREATE-NO-SCREENS
 16827         GO TO 7900-EXIT.
 16828
 16829*    IF  EIBAID EQUAL DFHPF8
 16830*            AND
 16831*        PI-SHOW-MODE
 16832*            AND
 16833*        LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES
 16834*        PERFORM 7920-UPDATE-INITIAL-PRINT THRU 7920-EXIT.
 16835
 16836     MOVE ER-0189                TO EMI-ERROR.
 16837     MOVE -1                     TO MAINTL.
 16838
 16839     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16840     MOVE -1                     TO MAINTL
 16841     MOVE AL-UABON               TO MAINTA
 16842     MOVE '104A'                 TO W-TS-ID-TEXT
 16843     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 16844                                    W-TS-TERM-SCREEN
 16845     GO TO 8200-SEND-DATAONLY.
 16846
 16847 7900-EXIT.
 16848     EXIT.
 16849
 16850 7915-SEARCH-REMAINING-VARS.
 16851
 16852     IF  W-REC-CHAR (W-RVS-NDX) EQUAL '@'
 16853         SET W-RVS-NDX2          TO W-RVS-NDX
 16854         SET W-RVS-NDX2 UP BY +1
 16855         IF  W-REC-CHAR (W-RVS-NDX2) EQUAL '@'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 357
* EL689.cbl
 16856             SET W-RVS-NDX2 UP BY +1
 16857             IF  W-REC-CHAR (W-RVS-NDX2) NUMERIC
 16858                 SET PI-CURRENT-LINE  TO W-RVS-NDX
 16859                 COMPUTE PI-CURRENT-LINE
 16860                     = PI-CURRENT-LINE / 73
 16861                 MOVE 'Y'        TO W-REMAINING-VAR-SW
 16862                 MOVE +0         TO W-ROLL-COUNTER
 16863                 MOVE ER-0191    TO EMI-ERROR
 16864                 MOVE -1         TO MAINTL
 16865                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16866
 16867 7915-EXIT.
 16868     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 358
* EL689.cbl
 16870 7920-UPDATE-INITIAL-PRINT.
 16871
 16872
 16873* EXEC CICS HANDLE CONDITION
 16874*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 16875*         NOTFND     (1070-ARCH-NOT-FOUND)
 16876*         ENDFILE    (1070-ARCH-NOT-FOUND)
 16877*    END-EXEC.
 16878*    MOVE '"$JI''                 ! = #00015648' TO DFHEIV0
 16879     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 16880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16881     MOVE X'3D20233030303135363438' TO DFHEIV0(25:11)
 16882     CALL 'kxdfhei1' USING DFHEIV0
 16883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16884
 16885     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
 16886     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 16887
 16888* EXEC CICS READ
 16889*        DATASET (W-ARCH-FILE-ID)
 16890*        SET     (ADDRESS OF LETTER-ARCHIVE)
 16891*        RIDFLD  (W-ARCH-PARTIAL-KEY)
 16892*        UPDATE
 16893*    END-EXEC.
 16894*    MOVE '&"S        EU         (   #00015655' TO DFHEIV0
 16895     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16896     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16897     MOVE X'2020233030303135363535' TO DFHEIV0(25:11)
 16898     CALL 'kxdfhei1' USING DFHEIV0,
 16899           W-ARCH-FILE-ID,
 16900           DFHEIV20,
 16901           DFHEIV99,
 16902           W-ARCH-PARTIAL-KEY,
 16903           DFHEIV99,
 16904           DFHEIV99,
 16905           DFHEIV99
 16906     SET ADDRESS OF LETTER-ARCHIVE TO
 16907         DFHEIV20
 16908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16909
 16910
 16911     MOVE W-SAVE-BIN-DATE        TO LA-INITIAL-PRINT-DATE.
 16912
 16913     IF  LA-RESEND-DATE = LOW-VALUES
 16914         MOVE 'C'                TO LA-STATUS.
 16915
 16916
 16917* EXEC CICS REWRITE
 16918*         FROM      (LETTER-ARCHIVE)
 16919*         DATASET   (W-ARCH-FILE-ID)
 16920*    END-EXEC.
 16921     MOVE LENGTH OF
 16922      LETTER-ARCHIVE
 16923       TO DFHEIV11
 16924*    MOVE '&& L                  %   #00015667' TO DFHEIV0
 16925     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16926     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16927     MOVE X'2020233030303135363637' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 359
* EL689.cbl
 16928     CALL 'kxdfhei1' USING DFHEIV0,
 16929           W-ARCH-FILE-ID,
 16930           LETTER-ARCHIVE,
 16931           DFHEIV11,
 16932           DFHEIV99
 16933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16934
 16935
 16936 7920-EXIT.
 16937     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 360
* EL689.cbl
 16939 7935-TERM-ERROR.
 16940
 16941     MOVE ER-0412                TO EMI-ERROR.
 16942     MOVE SPACES                 TO PI-689-PRINT-SW.
 16943     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16944     MOVE -1                     TO MAINTL.
 16945     GO TO 8200-SEND-DATAONLY.
 16946
 16947 7940-TRAN-ERROR.
 16948
 16949     MOVE ER-0413                TO EMI-ERROR.
 16950     MOVE SPACES                 TO PI-689-PRINT-SW.
 16951     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16952     MOVE -1                     TO MAINTL.
 16953     GO TO 8200-SEND-DATAONLY.
 16954
 16955 7945-NOT-FOUND.
 16956
 16957     MOVE ER-0190                TO EMI-ERROR.
 16958     MOVE -1                     TO MAINTL.
 16959     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16960     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 361
* EL689.cbl
 16962 8010-ARCH-NOT-OPEN.
 16963
 16964     MOVE ER-7388                TO EMI-ERROR.
 16965     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16966     MOVE -1                     TO MAINTL.
 16967     GO TO 8200-SEND-DATAONLY.
 16968
 16969 8015-ARCT-NOT-OPEN.
 16970
 16971     MOVE ER-7373                TO EMI-ERROR.
 16972     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16973     MOVE -1                     TO MAINTL.
 16974     GO TO 8200-SEND-DATAONLY.
 16975
 16976 8020-ACCT-NOT-OPEN.
 16977
 16978     MOVE ER-0168 TO EMI-ERROR
 16979     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16980     MOVE -1                     TO MAINTL.
 16981     GO TO 8200-SEND-DATAONLY.
 16982
 16983 8030-CERT-NOT-OPEN.
 16984
 16985     MOVE ER-0169 TO EMI-ERROR.
 16986     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16987     MOVE -1                     TO MAINTL.
 16988     GO TO 8200-SEND-DATAONLY.
 16989
 16990 8035-CERT-NOT-FOUND.
 16991
 16992     MOVE ER-2369 TO EMI-ERROR.
 16993     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16994     MOVE -1                     TO MAINTL.
 16995     GO TO 8200-SEND-DATAONLY.
 16996
 16997 8040-CNTL-NOT-OPEN.
 16998
 16999     MOVE ER-0042                TO EMI-ERROR.
 17000     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17001     MOVE -1                     TO MAINTL.
 17002     GO TO 8200-SEND-DATAONLY.
 17003
 17004 8045-CHEK-NOT-OPEN.
 17005
 17006     MOVE ER-3775                TO EMI-ERROR.
 17007     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17008     MOVE -1                     TO MAINTL.
 17009     GO TO 8200-SEND-DATAONLY.
 17010
 17011 8050-TEXT-NOT-OPEN.
 17012
 17013     MOVE ER-0013                TO EMI-ERROR.
 17014     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17015     MOVE -1                     TO MAINTL.
 17016     GO TO 8200-SEND-DATAONLY.
 17017
 17018 8060-PNDB-NOT-OPEN.
 17019
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 362
* EL689.cbl
 17020     MOVE ER-2216 TO EMI-ERROR.
 17021     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17022     MOVE -1                     TO MAINTL.
 17023     GO TO 8200-SEND-DATAONLY.
 17024
 17025 8070-PNDB-NOT-FOUND.
 17026
 17027     MOVE ER-7374 TO EMI-ERROR.
 17028     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17029     MOVE -1                     TO MAINTL.
 17030     GO TO 8200-SEND-DATAONLY.
 17031
 17032 8080-COMP-NOT-OPEN.
 17033
 17034     MOVE ER-2055 TO EMI-ERROR
 17035     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17036     MOVE -1                     TO MAINTL.
 17037     GO TO 8200-SEND-DATAONLY.
 17038
 17039 8085-PYAJ-NOT-OPEN.
 17040
 17041     MOVE ER-2232 TO EMI-ERROR
 17042     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17043     MOVE -1                     TO MAINTL.
 17044     GO TO 8200-SEND-DATAONLY.
 17045
 17046 8090-MAIL-NOT-OPEN.
 17047
 17048     MOVE ER-2999                TO EMI-ERROR.
 17049     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17050     MOVE -1                     TO MAINTL.
 17051     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 363
* EL689.cbl
 17053 8100-SEND-INITIAL-MAP.
 17054
 17055     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 17056     IF  PI-689-CREATE-NO-SCREENS
 17057         MOVE '9999'             TO PI-689-ERROR
 17058         GO TO 0620-RETURN-TO-CALLER.
 17059
 17060     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 17061
 17062     IF  NOT EMI-NO-ERRORS
 17063         MOVE EMI-MESSAGE-AREA (1)
 17064                                 TO ERRMSGO
 17065     ELSE
 17066         MOVE SPACES             TO ERRMSGO.
 17067     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 17068                                 TO SYSO
 17069     MOVE WS-KIXHOST             TO HOSTO
 17070     IF PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR 'CAGB'
 17071        OR 'DLVA' OR 'ECCA' OR 'KRHA'
 17072        MOVE AL-SADOF            TO PF8HDA
 17073     END-IF
 17074     IF NOT PI-CREATE-LABELS
 17075         MOVE AL-PANON           TO ADDRLBLA.
 17076
 17077
 17078* EXEC CICS SEND
 17079*        MAP    (W-MAP)
 17080*        MAPSET (W-MAPSET)
 17081*        FROM   (EL689AO)
 17082*        ERASE
 17083*        CURSOR
 17084*    END-EXEC.
 17085     MOVE LENGTH OF
 17086      EL689AO
 17087       TO DFHEIV12
 17088     MOVE -1
 17089       TO DFHEIV11
 17090*    MOVE '8$     CT  E    H L F ,   #00015813' TO DFHEIV0
 17091     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 17092     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17093     MOVE X'2020233030303135383133' TO DFHEIV0(25:11)
 17094     CALL 'kxdfhei1' USING DFHEIV0,
 17095           W-MAP,
 17096           EL689AO,
 17097           DFHEIV12,
 17098           W-MAPSET,
 17099           DFHEIV99,
 17100           DFHEIV99,
 17101           DFHEIV99,
 17102           DFHEIV11,
 17103           DFHEIV99,
 17104           DFHEIV99,
 17105           DFHEIV99
 17106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17107
 17108
 17109     GO TO 9000-RETURN-TRANS.
 17110
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 364
* EL689.cbl
 17111 8100-EXIT.
 17112     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 365
* EL689.cbl
 17114 8200-SEND-DATAONLY.
 17115
 17116     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 17117     IF  PI-689-CREATE-NO-SCREENS
 17118         MOVE '9999'             TO PI-689-ERROR
 17119         GO TO 0620-RETURN-TO-CALLER.
 17120
 17121     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 17122
 17123     IF EMI-ERROR = ER-0715
 17124         DISPLAY 'ER 0715'
 17125         MOVE -1          TO CERTIDL
 17126         MOVE +0          TO MAINTL
 17127     END-IF
 17128
 17129     IF  NOT EMI-NO-ERRORS
 17130         MOVE EMI-MESSAGE-AREA (1)
 17131                                 TO ERRMSGO
 17132     ELSE
 17133         MOVE SPACES             TO ERRMSGO.
 17134
 17135
 17136* EXEC CICS SEND
 17137*        MAP    (W-MAP)
 17138*        MAPSET (W-MAPSET)
 17139*        FROM   (EL689AO)
 17140*        DATAONLY
 17141*        CURSOR
 17142*    END-EXEC.
 17143     MOVE LENGTH OF
 17144      EL689AO
 17145       TO DFHEIV12
 17146     MOVE -1
 17147       TO DFHEIV11
 17148*    MOVE '8$D    CT       H L F ,   #00015847' TO DFHEIV0
 17149     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 17150     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17151     MOVE X'2020233030303135383437' TO DFHEIV0(25:11)
 17152     CALL 'kxdfhei1' USING DFHEIV0,
 17153           W-MAP,
 17154           EL689AO,
 17155           DFHEIV12,
 17156           W-MAPSET,
 17157           DFHEIV99,
 17158           DFHEIV99,
 17159           DFHEIV99,
 17160           DFHEIV11,
 17161           DFHEIV99,
 17162           DFHEIV99,
 17163           DFHEIV99
 17164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17165
 17166
 17167     GO TO 9000-RETURN-TRANS.
 17168
 17169 8200-EXIT.
 17170     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 366
* EL689.cbl
 17172 8300-SEND-TEXT.
 17173
 17174     IF  PI-689-CREATE-NO-SCREENS
 17175         MOVE '9999'             TO PI-689-ERROR
 17176         GO TO 0620-RETURN-TO-CALLER.
 17177
 17178
 17179* EXEC CICS SEND TEXT
 17180*        FROM    (LOGOFF-TEXT)
 17181*        LENGTH  (LOGOFF-LENGTH)
 17182*        ERASE
 17183*        FREEKB
 17184*    END-EXEC.
 17185*    MOVE '8&      T  E F  H   F -   #00015866' TO DFHEIV0
 17186     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17187     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17188     MOVE X'2020233030303135383636' TO DFHEIV0(25:11)
 17189     CALL 'kxdfhei1' USING DFHEIV0,
 17190           LOGOFF-TEXT,
 17191           LOGOFF-LENGTH,
 17192           DFHEIV99,
 17193           DFHEIV99,
 17194           DFHEIV99,
 17195           DFHEIV99,
 17196           DFHEIV99,
 17197           DFHEIV99,
 17198           DFHEIV99,
 17199           DFHEIV99,
 17200           DFHEIV99,
 17201           DFHEIV99
 17202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17203
 17204
 17205     GO TO 9000-RETURN-TRANS.
 17206
 17207 8300-EXIT.
 17208     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 367
* EL689.cbl
 17210 8350-SEND-DATAONLY-ERASEAUP.
 17211
 17212     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 17213     PERFORM 7760-PUT-TEMP-STORAGE
 17214                                 THRU 7760-EXIT
 17215     IF  PI-689-CREATE-NO-SCREENS
 17216         MOVE '9999'             TO PI-689-ERROR
 17217         GO TO 0620-RETURN-TO-CALLER.
 17218
 17219     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 17220
 17221     IF EMI-ERROR = ER-0715
 17222         DISPLAY 'ER 0715'
 17223         MOVE -1          TO CERTIDL
 17224         MOVE +0          TO MAINTL
 17225     END-IF
 17226
 17227     IF  NOT EMI-NO-ERRORS
 17228         MOVE EMI-MESSAGE-AREA (1)
 17229                                 TO ERRMSGO
 17230     ELSE
 17231         MOVE SPACES             TO ERRMSGO.
 17232
 17233
 17234* EXEC CICS SEND
 17235*        MAP      (W-MAP)
 17236*        MAPSET   (W-MAPSET)
 17237*        FROM     (EL689AO)
 17238*        DATAONLY
 17239*        ERASEAUP
 17240*        CURSOR
 17241*    END-EXEC.
 17242     MOVE LENGTH OF
 17243      EL689AO
 17244       TO DFHEIV12
 17245     MOVE -1
 17246       TO DFHEIV11
 17247*    MOVE '8$D    CT  A    H L F ,   #00015901' TO DFHEIV0
 17248     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 17249     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17250     MOVE X'2020233030303135393031' TO DFHEIV0(25:11)
 17251     CALL 'kxdfhei1' USING DFHEIV0,
 17252           W-MAP,
 17253           EL689AO,
 17254           DFHEIV12,
 17255           W-MAPSET,
 17256           DFHEIV99,
 17257           DFHEIV99,
 17258           DFHEIV99,
 17259           DFHEIV11,
 17260           DFHEIV99,
 17261           DFHEIV99,
 17262           DFHEIV99
 17263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17264
 17265
 17266     GO TO 9000-RETURN-TRANS.
 17267
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 368
* EL689.cbl
 17268 8350-EXIT.
 17269     EXIT.
 17270
 17271 8600-DEEDIT.
 17272
 17273
 17274* EXEC CICS BIF DEEDIT
 17275*         FIELD    (W-DEEDIT-FIELD)
 17276*         LENGTH   (15)
 17277*    END-EXEC.
 17278     MOVE 15
 17279       TO DFHEIV11
 17280*    MOVE '@"L                   #   #00015917' TO DFHEIV0
 17281     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17282     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17283     MOVE X'2020233030303135393137' TO DFHEIV0(25:11)
 17284     CALL 'kxdfhei1' USING DFHEIV0,
 17285           W-DEEDIT-FIELD,
 17286           DFHEIV11
 17287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17288
 17289
 17290 8600-EXIT.
 17291     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 369
* EL689.cbl
 17293 9000-RETURN-TRANS.
 17294
 17295     MOVE EMI-FATAL-CTR      TO PI-689-FATAL-CTR
 17296     MOVE EMI-FORCABLE-CTR   TO PI-689-FORCABLE-CTR
 17297     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 17298     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
 17299
 17300* EXEC CICS RETURN
 17301*        TRANSID    (W-TRANSACTION)
 17302*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 17303*        LENGTH     (PI-COMM-LENGTH)
 17304*    END-EXEC.
 17305*    MOVE '.(CT                  ''   #00015931' TO DFHEIV0
 17306     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17307     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17308     MOVE X'2020233030303135393331' TO DFHEIV0(25:11)
 17309     CALL 'kxdfhei1' USING DFHEIV0,
 17310           W-TRANSACTION,
 17311           PROGRAM-INTERFACE-BLOCK,
 17312           PI-COMM-LENGTH,
 17313           DFHEIV99,
 17314           DFHEIV99,
 17315           DFHEIV99
 17316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17317
 17318*    MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 17319*    MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 17320*    GO TO 0200-RECEIVE.
 17321
 17322 9000-EXIT.
 17323     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 370
* EL689.cbl
 17325 9200-PA.
 17326
 17327     MOVE ER-0008                TO EMI-ERROR.
 17328     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17329     MOVE -1                     TO MAINTL.
 17330     GO TO 8200-SEND-DATAONLY.
 17331
 17332 9200-EXIT.
 17333     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 371
* EL689.cbl
 17335 9300-DFHCLEAR.
 17336
 17337     IF PI-RETURN-TO-PROGRAM = 'EL689' OR 'EL690'
 17338         MOVE '2'                TO PI-ACTION.
 17339
 17340     IF  PI-CLEAR-MODE
 17341         MOVE PI-RETURN-TO-PROGRAM
 17342                                 TO W-CALL-PGM
 17343         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 17344         GO TO 9400-XCTL
 17345     ELSE
 17346         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 17347         MOVE LOW-VALUES         TO EL689AO
 17348                                    PI-1042-WA
 17349                                    PI-689-WORK-AREA
 17350         MOVE ZEROS              TO PI-CURRENT-LINE
 17351                                    PI-TEMP-STOR-ITEMS
 17352                                    PI-TOTAL-LINES
 17353                                    PI-UPDATE-SW
 17354                                    PI-689-NUMBER-LABEL-LINES
 17355         MOVE SPACES             TO PI-689-PRINT-SW
 17356                                    PI-689-ALT-PRINTER-ID
 17357                                    PI-COMM-CONTROL
 17358                                    PI-689-FORM-NUMBER
 17359                                    PI-689-TEMP-STOR-ID
 17360                                    PI-689-LABEL-SOURCE
 17361                                    PI-689-USE-SCREEN-IND
 17362         MOVE '2'                TO PI-ACTION
 17363         MOVE -1                 TO MAINTL
 17364         GO TO 8100-SEND-INITIAL-MAP.
 17365
 17366 9300-EXIT.
 17367     EXIT.
 17368
 17369 9400-XCTL.
 17370
 17371
 17372* EXEC CICS XCTL
 17373*        PROGRAM  (W-CALL-PGM)
 17374*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 17375*        LENGTH   (PI-COMM-LENGTH)
 17376*    END-EXEC.
 17377*    MOVE '.$C                   %   #00015989' TO DFHEIV0
 17378     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17379     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17380     MOVE X'2020233030303135393839' TO DFHEIV0(25:11)
 17381     CALL 'kxdfhei1' USING DFHEIV0,
 17382           W-CALL-PGM,
 17383           PROGRAM-INTERFACE-BLOCK,
 17384           PI-COMM-LENGTH,
 17385           DFHEIV99
 17386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17387
 17388
 17389 9400-EXIT.
 17390     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 372
* EL689.cbl
 17392 9500-LINK-DATE-CONVERT.
 17393
 17394     IF  DC-BIN-DATE-1 EQUAL HIGH-VALUES
 17395             AND
 17396         DC-OPTION-CODE EQUAL ' '
 17397         MOVE '99/99/99'         TO DC-GREG-DATE-1-EDIT
 17398         GO TO 9500-EXIT.
 17399
 17400
 17401* EXEC CICS LINK
 17402*        PROGRAM    ('ELDATCV')
 17403*        COMMAREA   (DATE-CONVERSION-DATA)
 17404*        LENGTH     (DC-COMM-LENGTH)
 17405*    END-EXEC.
 17406     MOVE 'ELDATCV' TO DFHEIV1
 17407*    MOVE '."C                   (   #00016006' TO DFHEIV0
 17408     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17409     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17410     MOVE X'2020233030303136303036' TO DFHEIV0(25:11)
 17411     CALL 'kxdfhei1' USING DFHEIV0,
 17412           DFHEIV1,
 17413           DATE-CONVERSION-DATA,
 17414           DC-COMM-LENGTH,
 17415           DFHEIV99,
 17416           DFHEIV99,
 17417           DFHEIV99,
 17418           DFHEIV99
 17419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17420
 17421
 17422     IF  NO-CONVERSION-ERROR
 17423             AND
 17424         PI-COMPANY-ID EQUAL 'AUK'
 17425             AND
 17426         W-REVERSE-DATE
 17427         MOVE DC-GREG-DATE-1-EDIT
 17428                                 TO W-EDIT-DATE-1
 17429         MOVE W-ED1-MM           TO W-ED2-MM
 17430         MOVE W-ED1-DD           TO W-ED2-DD
 17431         MOVE W-ED1-YY           TO W-ED2-YY
 17432         MOVE W-EDIT-DATE-2      TO DC-GREG-DATE-1-EDIT.
 17433
 17434 9500-EXIT.
 17435     EXIT.
 17436
 17437 9600-FORMAT-DATE-TIME.
 17438
 17439     MOVE W-SAVE-DATE            TO RUNDTEO.
 17440     MOVE EIBTIME                TO W-TIME-IN.
 17441     MOVE W-TIME-OUT             TO RUNTIMEO.
 17442     MOVE PI-COMPANY-ID          TO COMPANYO.
 17443     MOVE PI-PROCESSOR-ID        TO USERIDO.
 17444     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 17445
 17446 9600-EXIT.
 17447     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 373
* EL689.cbl
 17449 9700-PGMID-ERROR.
 17450
 17451     IF  PI-689-CREATE-NO-SCREENS
 17452         MOVE '9999'             TO PI-689-ERROR
 17453         GO TO 0620-RETURN-TO-CALLER.
 17454
 17455
 17456* EXEC CICS  HANDLE CONDITION
 17457*        PGMIDERR  (8300-SEND-TEXT)
 17458*    END-EXEC.
 17459*    MOVE '"$L                   ! > #00016045' TO DFHEIV0
 17460     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17462     MOVE X'3E20233030303136303435' TO DFHEIV0(25:11)
 17463     CALL 'kxdfhei1' USING DFHEIV0
 17464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17465
 17466
 17467     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
 17468     MOVE ' '                    TO PI-ENTRY-CD-1.
 17469     MOVE W-XCTL-005             TO W-CALL-PGM
 17470                                    LOGOFF-PGM.
 17471     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 17472
 17473     PERFORM 9400-XCTL THRU 9400-EXIT.
 17474
 17475 9700-EXIT.
 17476     EXIT.
 17477
 17478 9800-ABEND.
 17479
 17480     IF  PI-689-CREATE-NO-SCREENS
 17481         MOVE '9999'             TO PI-689-ERROR
 17482         GO TO 0620-RETURN-TO-CALLER.
 17483
 17484     MOVE W-LINK-004             TO W-CALL-PGM.
 17485     MOVE DFHEIBLK               TO EMI-LINE1
 17486
 17487
 17488* EXEC CICS  LINK
 17489*        PROGRAM   (W-CALL-PGM)
 17490*        COMMAREA  (EMI-LINE1)
 17491*        LENGTH    (72)
 17492*    END-EXEC.
 17493     MOVE 72
 17494       TO DFHEIV11
 17495*    MOVE '."C                   (   #00016069' TO DFHEIV0
 17496     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17497     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17498     MOVE X'2020233030303136303639' TO DFHEIV0(25:11)
 17499     CALL 'kxdfhei1' USING DFHEIV0,
 17500           W-CALL-PGM,
 17501           EMI-LINE1,
 17502           DFHEIV11,
 17503           DFHEIV99,
 17504           DFHEIV99,
 17505           DFHEIV99,
 17506           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 374
* EL689.cbl
 17507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17508
 17509
 17510     GO TO 8200-SEND-DATAONLY.
 17511
 17512 9800-EXIT.
 17513     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 375
* EL689.cbl
 17515 9900-ERROR-FORMAT.
 17516
 17517     IF  PI-689-CREATE-NO-SCREENS
 17518         MOVE EMI-ERROR          TO PI-689-ERROR
 17519         IF  PI-689-FATAL-ERROR
 17520             GO TO 0620-RETURN-TO-CALLER
 17521         ELSE
 17522             GO TO 9900-EXIT.
 17523
 17524     IF  EMI-ERROR EQUAL ER-9097
 17525         NEXT SENTENCE
 17526     ELSE
 17527         IF  EMI-ERRORS-COMPLETE
 17528                 OR
 17529             EMI-ERROR EQUAL W-LAST-ERROR
 17530             GO TO 9900-EXIT.
 17531
 17532     MOVE W-LINK-001             TO W-CALL-PGM.
 17533
 17534
 17535* EXEC CICS LINK
 17536*        PROGRAM    (W-CALL-PGM)
 17537*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17538*        LENGTH     (EMI-COMM-LENGTH)
 17539*    END-EXEC.
 17540*    MOVE '."C                   (   #00016099' TO DFHEIV0
 17541     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17542     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17543     MOVE X'2020233030303136303939' TO DFHEIV0(25:11)
 17544     CALL 'kxdfhei1' USING DFHEIV0,
 17545           W-CALL-PGM,
 17546           ERROR-MESSAGE-INTERFACE-BLOCK,
 17547           EMI-COMM-LENGTH,
 17548           DFHEIV99,
 17549           DFHEIV99,
 17550           DFHEIV99,
 17551           DFHEIV99
 17552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17553
 17554
 17555     IF  EMI-SEVERITY (2) EQUAL 'X'
 17556             AND
 17557         EMI-SEVERITY (1) NOT EQUAL 'X'
 17558         MOVE EMI-MESSAGE-AREA (2)
 17559                                 TO EMI-MESSAGE-AREA (1).
 17560
 17561     MOVE EMI-ERROR              TO W-LAST-ERROR.
 17562
 17563 9900-EXIT.
 17564     EXIT.
 17565
 17566 9905-INITIALIZE-SECURITY.
 17567******************************************************************
 17568*                                                                *
 17569*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
 17570*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
 17571*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
 17572*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 376
* EL689.cbl
 17573*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
 17574*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
 17575*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
 17576*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
 17577*                                                                *
 17578*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
 17579*       IS ALSO PROVIDED BY THIS LOGIC.                          *
 17580*                                                                *
 17581******************************************************************
 17582
 17583     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
 17584         MOVE 'Y'                TO PI-DISPLAY-CAP
 17585                                    PI-MODIFY-CAP
 17586     ELSE
 17587
 17588* EXEC CICS READQ TS
 17589*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
 17590*            INTO   (SECURITY-CONTROL)
 17591*            LENGTH (SC-COMM-LENGTH)
 17592*            ITEM   (1)
 17593*        END-EXEC
 17594     MOVE 1
 17595       TO DFHEIV11
 17596*    MOVE '*$II   L              ''   #00016137' TO DFHEIV0
 17597     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 17598     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17599     MOVE X'2020233030303136313337' TO DFHEIV0(25:11)
 17600     CALL 'kxdfhei1' USING DFHEIV0,
 17601           PI-SECURITY-TEMP-STORE-ID,
 17602           SECURITY-CONTROL,
 17603           SC-COMM-LENGTH,
 17604           DFHEIV11,
 17605           DFHEIV99,
 17606           DFHEIV99
 17607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17608         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
 17609                                 TO PI-DISPLAY-CAP
 17610         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
 17611                                 TO PI-MODIFY-CAP.
 17612
 17613 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 377
* EL689.cbl
 17615 9995-SECURITY-VIOLATION.
 17616
 17617     MOVE EIBDATE                TO SM-JUL-DATE.
 17618     MOVE EIBTRMID               TO SM-TERMID.
 17619     MOVE W-THIS-PGM             TO SM-PGM.
 17620     MOVE EIBTIME                TO W-TIME-IN.
 17621     MOVE W-TIME-OUT             TO SM-TIME.
 17622     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
 17623
 17624
 17625* EXEC CICS LINK
 17626*         PROGRAM  ('EL003')
 17627*         COMMAREA (SECURITY-MESSAGE)
 17628*         LENGTH   (80)
 17629*    END-EXEC.
 17630     MOVE 'EL003' TO DFHEIV1
 17631     MOVE 80
 17632       TO DFHEIV11
 17633*    MOVE '."C                   (   #00016159' TO DFHEIV0
 17634     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17635     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17636     MOVE X'2020233030303136313539' TO DFHEIV0(25:11)
 17637     CALL 'kxdfhei1' USING DFHEIV0,
 17638           DFHEIV1,
 17639           SECURITY-MESSAGE,
 17640           DFHEIV11,
 17641           DFHEIV99,
 17642           DFHEIV99,
 17643           DFHEIV99,
 17644           DFHEIV99
 17645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17646
 17647
 17648 9995-EXIT.
 17649     EXIT.
 17650
 17651 9999-GOBACK.
 17652
 17653
 17654* GOBACK.
 17655     MOVE '9%                    "   ' TO DFHEIV0
 17656     MOVE 'EL689' TO DFHEIV1
 17657     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17658     GOBACK.
 17659
 17660 9999-EXIT.
 17661     EXIT.
 17662
 17663 9999-DFHBACK SECTION.
 17664     MOVE '9%                    "   ' TO DFHEIV0
 17665     MOVE 'EL689' TO DFHEIV1
 17666     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17667     GOBACK.
 17668 9999-DFHEXIT.
 17669     IF DFHEIGDJ EQUAL 0001
 17670         NEXT SENTENCE
 17671     ELSE IF DFHEIGDJ EQUAL 2
 17672         GO TO 9300-DFHCLEAR,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 378
* EL689.cbl
 17673               9200-PA,
 17674               9200-PA,
 17675               9200-PA
 17676         DEPENDING ON DFHEIGDI
 17677     ELSE IF DFHEIGDJ EQUAL 3
 17678         GO TO 9700-PGMID-ERROR,
 17679               9800-ABEND,
 17680               0325-MAPFAIL
 17681         DEPENDING ON DFHEIGDI
 17682     ELSE IF DFHEIGDJ EQUAL 4
 17683         GO TO 8040-CNTL-NOT-OPEN,
 17684               7945-NOT-FOUND
 17685         DEPENDING ON DFHEIGDI
 17686     ELSE IF DFHEIGDJ EQUAL 5
 17687         GO TO 9700-PGMID-ERROR,
 17688               0325-MAPFAIL,
 17689               9800-ABEND
 17690         DEPENDING ON DFHEIGDI
 17691     ELSE IF DFHEIGDJ EQUAL 6
 17692         GO TO 0990-CARRIER-NOT-FOUND,
 17693               8040-CNTL-NOT-OPEN
 17694         DEPENDING ON DFHEIGDI
 17695     ELSE IF DFHEIGDJ EQUAL 7
 17696         GO TO 0994-STATE-NOT-FOUND,
 17697               8040-CNTL-NOT-OPEN
 17698         DEPENDING ON DFHEIGDI
 17699     ELSE IF DFHEIGDJ EQUAL 8
 17700         GO TO 8010-ARCH-NOT-OPEN,
 17701               1070-ARCH-NOT-FOUND,
 17702               1070-ARCH-NOT-FOUND
 17703         DEPENDING ON DFHEIGDI
 17704     ELSE IF DFHEIGDJ EQUAL 9
 17705         GO TO 2001-NOT-FOUND,
 17706               2001-NOT-FOUND,
 17707               8050-TEXT-NOT-OPEN
 17708         DEPENDING ON DFHEIGDI
 17709     ELSE IF DFHEIGDJ EQUAL 10
 17710         GO TO 2000-ENDBR
 17711         DEPENDING ON DFHEIGDI
 17712     ELSE IF DFHEIGDJ EQUAL 11
 17713         GO TO 8040-CNTL-NOT-OPEN,
 17714               6200-CNTL1-NOT-FOUND
 17715         DEPENDING ON DFHEIGDI
 17716     ELSE IF DFHEIGDJ EQUAL 12
 17717         GO TO 8040-CNTL-NOT-OPEN,
 17718               6250-CNTL2-NOT-FOUND
 17719         DEPENDING ON DFHEIGDI
 17720     ELSE IF DFHEIGDJ EQUAL 13
 17721         GO TO 8040-CNTL-NOT-OPEN,
 17722               6300-CNTL6-NOT-FOUND
 17723         DEPENDING ON DFHEIGDI
 17724     ELSE IF DFHEIGDJ EQUAL 14
 17725         GO TO 8040-CNTL-NOT-OPEN,
 17726               6350-CNTL2-NOT-FOUND
 17727         DEPENDING ON DFHEIGDI
 17728     ELSE IF DFHEIGDJ EQUAL 15
 17729         GO TO 8060-PNDB-NOT-OPEN,
 17730               8070-PNDB-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 379
* EL689.cbl
 17731         DEPENDING ON DFHEIGDI
 17732     ELSE IF DFHEIGDJ EQUAL 16
 17733         GO TO 8030-CERT-NOT-OPEN,
 17734               8035-CERT-NOT-FOUND
 17735         DEPENDING ON DFHEIGDI
 17736     ELSE IF DFHEIGDJ EQUAL 17
 17737         GO TO 8020-ACCT-NOT-OPEN,
 17738               6500-ACCT-NOT-FOUND,
 17739               6500-ONLY-STOP
 17740         DEPENDING ON DFHEIGDI
 17741     ELSE IF DFHEIGDJ EQUAL 18
 17742         GO TO 8080-COMP-NOT-OPEN,
 17743               6600-COMP-NOT-FOUND
 17744         DEPENDING ON DFHEIGDI
 17745     ELSE IF DFHEIGDJ EQUAL 19
 17746         GO TO 8040-CNTL-NOT-OPEN,
 17747               6630-CNTL2-NOT-FOUND
 17748         DEPENDING ON DFHEIGDI
 17749     ELSE IF DFHEIGDJ EQUAL 20
 17750         GO TO 8090-MAIL-NOT-OPEN,
 17751               6700-MAIL-NOT-FOUND
 17752         DEPENDING ON DFHEIGDI
 17753     ELSE IF DFHEIGDJ EQUAL 21
 17754         GO TO 8040-CNTL-NOT-OPEN,
 17755               6750-EXIT
 17756         DEPENDING ON DFHEIGDI
 17757     ELSE IF DFHEIGDJ EQUAL 22
 17758         GO TO 8040-CNTL-NOT-OPEN,
 17759               6800-EXIT
 17760         DEPENDING ON DFHEIGDI
 17761     ELSE IF DFHEIGDJ EQUAL 23
 17762         GO TO 8045-CHEK-NOT-OPEN,
 17763               6850-CHEK-NOT-FOUND
 17764         DEPENDING ON DFHEIGDI
 17765     ELSE IF DFHEIGDJ EQUAL 24
 17766         GO TO 8085-PYAJ-NOT-OPEN,
 17767               6900-PYAJ-NOT-FOUND
 17768         DEPENDING ON DFHEIGDI
 17769     ELSE IF DFHEIGDJ EQUAL 25
 17770         GO TO 7700-TS-ERROR,
 17771               7700-TS-ERROR
 17772         DEPENDING ON DFHEIGDI
 17773     ELSE IF DFHEIGDJ EQUAL 26
 17774         GO TO 7780-EXIT
 17775         DEPENDING ON DFHEIGDI
 17776     ELSE IF DFHEIGDJ EQUAL 27
 17777         GO TO 8040-CNTL-NOT-OPEN,
 17778               7945-NOT-FOUND
 17779         DEPENDING ON DFHEIGDI
 17780     ELSE IF DFHEIGDJ EQUAL 28
 17781         GO TO 7935-TERM-ERROR,
 17782               7940-TRAN-ERROR
 17783         DEPENDING ON DFHEIGDI
 17784     ELSE IF DFHEIGDJ EQUAL 29
 17785         GO TO 8010-ARCH-NOT-OPEN,
 17786               1070-ARCH-NOT-FOUND,
 17787               1070-ARCH-NOT-FOUND
 17788         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 380
* EL689.cbl
 17789     ELSE IF DFHEIGDJ EQUAL 30
 17790         GO TO 8300-SEND-TEXT
 17791         DEPENDING ON DFHEIGDI.
 17792     MOVE '9%                    "   ' TO DFHEIV0
 17793     MOVE 'EL689' TO DFHEIV1
 17794     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17795     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      232716     Code:       60334
