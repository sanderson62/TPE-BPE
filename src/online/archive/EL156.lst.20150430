* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 030515  IR2015030300002  PEMA  FIX CRIT PERIOD EDITS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59******************************************************************
    60
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page   3
* EL156.cbl
    62 ENVIRONMENT DIVISION.
    63
    64 DATA DIVISION.
    65
    66 WORKING-STORAGE SECTION.
    67 01  DFH-START PIC X(04).
    68
    69 77  FILLER  PIC X(32)  VALUE '********************************'.
    70 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    71 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    72 77  WS-SSN  PIC X(9) VALUE ZEROS.
    73 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    74 77  C0                          PIC S999 COMP-3 VALUE +0.
    75 77  C1                          PIC S999 COMP-3 VALUE +0.
    76 77  C2                          PIC S999 COMP-3 VALUE +0.
    77 77  C3                          PIC S999 COMP-3 VALUE +0.
    78 77  s1                          PIC S999 COMP-3 VALUE +0.
    79 77  s2                          pic s999 comp-3 value +0.
    80 77  P1                          PIC S999 COMP-3 VALUE +0.
    81 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    82 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    83 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    84 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    85 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    86 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    87 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    88 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    89 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    90 77  ws-max-bens                 pic s999 comp-3 value +0.
    91 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    92 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    93 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    94 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    95 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    96 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
    97
    98*    COPY ELCSCTM.
    99******************************************************************
   100*                                                                *
   101*                                                                *
   102*                            ELCSCTM                             *
   103*                            VMOD=2.001                          *
   104*                                                                *
   105*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   106*                                                                *
   107******************************************************************
   108 01  SECURITY-MESSAGE.
   109     12  FILLER                          PIC X(30)
   110            VALUE '** LOGIC SECURITY VIOLATION -'.
   111     12  SM-READ                         PIC X(6).
   112     12  FILLER                          PIC X(5)
   113            VALUE ' PGM='.
   114     12  SM-PGM                          PIC X(6).
   115     12  FILLER                          PIC X(5)
   116            VALUE ' OPR='.
   117     12  SM-PROCESSOR-ID                 PIC X(4).
   118     12  FILLER                          PIC X(6)
   119            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page   4
* EL156.cbl
   120     12  SM-TERMID                       PIC X(4).
   121     12  FILLER                          PIC XX   VALUE SPACE.
   122     12  SM-JUL-DATE                     PIC 9(5).
   123     12  FILLER                          PIC X    VALUE SPACE.
   124     12  SM-TIME                         PIC 99.99.
   125
   126
   127*    COPY ELCSCRTY.
   128******************************************************************
   129*                                                                *
   130*                                                                *
   131*                            ELCSCRTY                            *
   132*                            VMOD=2.001                          *
   133*                                                                *
   134*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   135*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   136*        SAVED IN PI-SECURITY-ADDRESS.                           *
   137*                                                                *
   138******************************************************************
   139 01  SECURITY-CONTROL.
   140     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   141     12  FILLER                       PIC XX    VALUE 'SC'.
   142     12  SC-CREDIT-CODES.
   143         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   144             20  SC-CREDIT-DISPLAY    PIC X.
   145             20  SC-CREDIT-UPDATE     PIC X.
   146     12  SC-CLAIMS-CODES.
   147         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   148             20  SC-CLAIMS-DISPLAY    PIC X.
   149             20  SC-CLAIMS-UPDATE     PIC X.
   150
   151 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   152 01  WS-DATE-AREA.
   153     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   154     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   155     12  SAVE-DATE-CCYYMMDD.
   156         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   157         16  SAVE-DATE-YMD.
   158             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   159             20  FILLER              PIC X(04)   VALUE SPACES.
   160
   161 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   162 01  STANDARD-AREAS.
   163     12  WS-RESPONSE         PIC S9(8)   COMP.
   164         88  WS-RESP-NORMAL              VALUE +00.
   165         88  WS-RESP-ERROR               VALUE +01.
   166         88  WS-RESP-NOTFND              VALUE +13.
   167         88  WS-RESP-DUPREC              VALUE +14.
   168         88  WS-RESP-ENDFILE             VALUE +20.
   169     12  PMT-HEAD-A.
   170         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   171         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   172         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   173-        '     RESERVES  TYPE    AMOUNT'.
   174     12  PMT-HEAD-B.
   175         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   176         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   177         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page   5
* EL156.cbl
   178     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   179     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   180     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   181     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   182     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   183     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   184     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   185     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   186     12  PGM-NAME            PIC X(8).
   187     12  TIME-IN             PIC S9(7).
   188     12  TIME-OUT-R  REDEFINES TIME-IN.
   189         16  FILLER          PIC X.
   190         16  TIME-OUT        PIC 99V99.
   191         16  FILLER          PIC XX.
   192     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   193     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   194     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   195     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   196     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   197     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   198     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   199     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   200     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   201     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   202     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   203     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   204     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   205     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   206     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   207     12  WS-BLANK            PIC X       VALUE ' '.
   208
   209 01  MISC-WORK-AREAS.
   210     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   211     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   212     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   213     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   214     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   215     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   216     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   217     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   218     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   219     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   220     12  W-CALLED-NAME           PIC X(08).
   221     12  W-EOB-CODES.
   222         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   223             20  W-EOB-CODE      PIC XXX.
   224             20  W-EOB-FILLER    PIC X.
   225     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   226     12  W-NAME-LAST             PIC X(15).
   227     12  W-NAME-FIRST            PIC X(15).
   228     12  W-NAME-MIDDLE.
   229         16  FILLER              PIC X.
   230         16  W-NAME-MIDDLE-2     PIC X.
   231         16  FILLER              PIC X(13).
   232     12  W-DMD-CHECK-NO.
   233         16  W-DMD-CHECK-NO-1    PIC X(4).
   234         16  W-DMD-CHECK-NO-2    PIC X.
   235         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page   6
* EL156.cbl
   236
   237     12  WS-COMPUTE-FROM-DT  PIC XX.
   238     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   239     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   240     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   241     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   242     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   243     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   244         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   245         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   246     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   247         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   248     12  WS-UPDATE-SW        PIC X VALUE ' '.
   249     12  WS-GROUPING.
   250         16  WS-GROUP-1      PIC X VALUE SPACES.
   251         16  FILLER          PIC X(05) VALUE SPACES.
   252     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   253     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   254     12  WS-WORK-STATE-ACCT.
   255         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   256         16  FILLER          PIC X       VALUE '/'.
   257         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   258     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   259     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   260     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   261     12  QID.
   262         16  QID-TERM        PIC X(4)    VALUE SPACES.
   263         16  FILLER          PIC X(4)    VALUE '156A'.
   264     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   265     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   266     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   267     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   268     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   269     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   270     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   271     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   272     12  WS-STATUS           PIC X       VALUE SPACES.
   273     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   274     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   275     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   276     12  ws-extended-exp-dt  pic xx      value low-values.
   277     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   278     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   279     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   280     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   281     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   282     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   283     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   284     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   285     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   286     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   287     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   288     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   289     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   290     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   291     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   292     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   293     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page   7
* EL156.cbl
   294     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   295     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   296     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   297     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   298     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   299     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   300     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   301     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   302     12  WORK-DATE-FROM.
   303         16  WDF-MONTH       PIC 99        VALUE ZERO.
   304         16  WDF-DAY         PIC 99        VALUE ZERO.
   305         16  WDF-YEAR        PIC 99        VALUE ZERO.
   306     12  WORK-DATE-THRU.
   307         16  WDT-MONTH       PIC 99        VALUE ZERO.
   308         16  WDT-DAY         PIC 99        VALUE ZERO.
   309         16  WDT-YEAR        PIC 99        VALUE ZERO.
   310     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   311     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   312     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   313     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   314     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   315     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   316     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   317     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   318     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   319     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   320     12  WS-PY-WK REDEFINES WS-PY-WORK.
   321         16  WS-PY-NUM       PIC S9(7)V99.
   322         16  WS-PY-SIGN      PIC X.
   323     12  WS-DY-WORK          PIC S9(5).
   324     12  WS-DY-WK REDEFINES WS-DY-WORK.
   325         16  WS-DY-NUM       PIC S9(4).
   326         16  WS-DY-SIGN      PIC X.
   327     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   328         88  COMP-REC-FOUND              VALUE 'Y'.
   329     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   330         88  BENEFIT-FOUND       VALUE 'Y'.
   331         88  NO-BENEFIT-FOUND    VALUE 'N'.
   332     12  WS-TERMS.
   333         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   334         16  FILLER          PIC X       VALUE '/'.
   335         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   336         16  WST-REM-DAYS-GRP.
   337             20  WST-SLASH   PIC X       VALUE '/'.
   338             20  WST-REM-DAYS
   339                             PIC --9.
   340     12  WS-ACCESS.
   341         16  FILLER          PIC XX      VALUE SPACES.
   342         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   343     12  WS-STATE-ACCESS.
   344         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   345         16  FILLER          PIC XX      VALUE SPACES.
   346     12  WS-CARR-ACCESS.
   347         16  FILLER          PIC X(3)    VALUE SPACES.
   348         16  WS-CARR         PIC X       VALUE SPACES.
   349     12  DATE-WORK.
   350         16  FILLER          PIC XX      VALUE SPACES.
   351         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page   8
* EL156.cbl
   352     12  WS-SAVE-INPUT.
   353         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   354         16  WS-PAYEE        PIC XX      VALUE SPACE.
   355         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   356         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   357         16  WS-OFFLINE      PIC X       VALUE SPACE.
   358         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   359         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   360         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   361         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   362         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   363         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   364         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   365         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   366         16  WS-ETYPE        PIC X       VALUE SPACE.
   367         16  WS-CASH         PIC X       VALUE SPACE.
   368         16  WS-GROUPED      PIC X       VALUE SPACE.
   369         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   370         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   371         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   372         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   373         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   374         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   375         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   376         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   377     12  LAST-ERROR-LINE.
   378         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   379         16  FILLER              PIC X(30)
   380             VALUE ' FATAL ERRORS ENCOUNTERED'.
   381         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   382         16  FILLER              PIC X(28)
   383             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   384     12  WS-CHECK-AREA.
   385         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   386         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   387     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   388     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   389         16  FILLER              PIC XX.
   390         16  WS-A-CHECK-NUM-5    PIC 9(5).
   391     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   392         16  FILLER              PIC X.
   393         16  WS-A-CHECK-NUM-6    PIC 9(6).
   394     12  OPTION-1-SAVE-AREA.
   395         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   396         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   397     12  WS-WORK-ZIP.
   398         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   399         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   400     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   401                                 PIC 9(9).
   402     12  WS-FLI-PMTNOTE.
   403         16  WS-PMTOPTION        PIC XX.
   404         16  WS-DOCNAME          PIC X(28).
   405         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   406             20  WS-AMOUNT       PIC X(8).
   407             20  FILLER          PIC X(20).
   408         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   409             20  WS-NUM-AMT      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page   9
* EL156.cbl
   410             20  FILLER          PIC X(20).
   411
   412     12  WS-HAN-PMTNOTE.
   413         16  WS-HAN-PMT-CODE     PIC X.
   414         16  WS-HAN-PMT-NOTE     PIC X(39).
   415
   416     12  WS-NCL-PMT-OPTION       PIC XX.
   417         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   418
   419     12  WS-CLAIM-SEQUENCE.
   420         16  FILLER              PIC X VALUE '('.
   421         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   422         16  FILLER              PIC X(04) VALUE ' OF '.
   423         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   424         16  FILLER              PIC X VALUE ')'.
   425
   426     12  WS-REFUND-AMT           PIC Z(7).99.
   427     12  WS-CALC-INT             PIC S9(7)V99.
   428     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   429
   430     12  SUB                     PIC 99 VALUE ZEROS.
   431
   432     12  WS-BOANOTE1.
   433         16  WS-BOANOTE1-DESC    PIC X(11).
   434         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   435         16  FILLER              PIC X(17).
   436     12  WS-BOANOTE2.
   437         16  WS-BOANOTE2-DESC    PIC X(11).
   438         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   439         16  FILLER              PIC X(17).
   440
   441     12  WS-NCLNOTE1.
   442         16  WS-NCLNOTE1-DESC    PIC X(11).
   443         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   444         16  FILLER              PIC X(17).
   445     12  WS-NCLNOTE2.
   446         16  WS-NCLNOTE2-DESC    PIC X(11).
   447         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   448         16  FILLER              PIC X(17).
   449
   450     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   451     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   452     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   453     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   454     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   455     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   456     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   457     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   458     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   459     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   460
   461     12  WS-AIG-WORK-AREAS.
   462         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   463             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   464         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   465             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   466         16  WS-FROM-DATE-MDY.
   467             20  WS-FROM-MO      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  10
* EL156.cbl
   468             20  WS-FROM-DA      PIC 99.
   469             20  WS-FROM-YR      PIC 99.
   470         16  WS-TEMP-DATE-MDY.
   471             20  WS-TEMP-MO      PIC 99.
   472             20  WS-TEMP-DA      PIC 99.
   473             20  WS-TEMP-YR      PIC 99.
   474         16  WS-BIN-FROM-DT      PIC XX.
   475         16  WS-TEMP-INC-MDY.
   476             20  WS-TEMP-INC-MO  PIC 99.
   477             20  WS-TEMP-INC-DA  PIC 99.
   478             20  WS-TEMP-INC-YR  PIC 99.
   479         16  WS-PMT-DUE-MDY.
   480             20  WS-PMT-DUE-MO   PIC 99.
   481             20  WS-PMT-DUE-DA   PIC 99.
   482             20  WS-PMT-DUE-YR   PIC 99.
   483         16  WS-PMT-DUE-DT       PIC XX.
   484         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   485         16  WS-RETRO-ELIM-DT    PIC XX.
   486         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   487             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   488         16  WS-SAVE-DUE-DA      PIC 99.
   489         16  WS-CDAYS            PIC S9(05).
   490         16  WS-DAYS-OFF         PIC S9(05).
   491         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   492             88  ELIM-SATISFIED            VALUE 'Y'.
   493         16  WS-AIG-CHECKNO.
   494             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   495             20  WS-A-CHECKNO-3-7.
   496                 24  FILLER              PIC X(3)    VALUE SPACES.
   497                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   498                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   499         16  WS-AIG-GROUPING.
   500             20  WS-A-BENE               PIC XXX.
   501             20  FILLER                  PIC XXX.
   502         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   503             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   504             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   505         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   506                 VALUE 'UNEMPLOYMENT PAYMENT'.
   507         16  WS-CHK-THRU-DT              PIC XX.
   508         16  WS-HOLD-BIN-DATE-1          PIC XX.
   509
   510 01  MISC-CSO-AREA.
   511     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   512     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   513     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   514         88  APPROVAL-NEEDED                        VALUE 'Y'.
   515     12  WS-APPROV-NOTE                  PIC X(43)
   516         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   517     12  WS-3550-APPROV-NOTE             PIC X(43)
   518         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   519     12  WS-REAUDIT-NOTE                 PIC X(43)
   520         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   521     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   522     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   523     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   524     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   525     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  11
* EL156.cbl
   526     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   527     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   528         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   529     12  WS-PAYEE-CITY-STATE     PIC X(30).
   530     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   531         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   532     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   533     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   534     12  WS-WORK-NAME            PIC X(30).
   535     12  FILLER  REDEFINES WS-WORK-NAME.
   536         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   537     12  WS-INSURED-NAME         PIC X(30).
   538     12  FILLER  REDEFINES WS-INSURED-NAME.
   539         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   540     12  WS-PAYEE-NAME           PIC X(30).
   541     12  FILLER  REDEFINES WS-PAYEE-NAME.
   542         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   543
   544 01  ERROR-MESSAGES.
   545     12  ER-0000                 PIC X(4)  VALUE '0000'.
   546     12  ER-0004                 PIC X(4)  VALUE '0004'.
   547     12  ER-0008                 PIC X(4)  VALUE '0008'.
   548     12  ER-0019                 PIC X(4)  VALUE '0019'.
   549     12  ER-0029                 PIC X(4)  VALUE '0029'.
   550     12  ER-0042                 PIC X(4)  VALUE '0042'.
   551     12  ER-0070                 PIC X(4)  VALUE '0070'.
   552     12  ER-0130                 PIC X(4)  VALUE '0130'.
   553     12  ER-0149                 PIC X(4)  VALUE '0149'.
   554     12  ER-0154                 PIC X(4)  VALUE '0154'.
   555     12  ER-0168                 PIC X(4)  VALUE '0168'.
   556     12  ER-0169                 PIC X(4)  VALUE '0169'.
   557     12  ER-0172                 PIC X(4)  VALUE '0174'.
   558     12  ER-0198                 PIC X(4)  VALUE '0198'.
   559     12  ER-0204                 PIC X(4)  VALUE '0204'.
   560     12  ER-0206                 PIC X(4)  VALUE '0206'.
   561     12  ER-0252                 PIC X(4)  VALUE '0252'.
   562     12  ER-0254                 PIC X(4)  VALUE '0254'.
   563     12  ER-0282                 PIC X(4)  VALUE '0282'.
   564     12  ER-0283                 PIC X(4)  VALUE '0283'.
   565     12  ER-0294                 PIC X(4)  VALUE '0294'.
   566     12  ER-0338                 PIC X(4)  VALUE '0338'.
   567     12  ER-0419                 PIC X(4)  VALUE '0419'.
   568     12  ER-0420                 PIC X(4)  VALUE '0420'.
   569     12  ER-0421                 PIC X(4)  VALUE '0421'.
   570     12  ER-0422                 PIC X(4)  VALUE '0422'.
   571     12  ER-0433                 PIC X(4)  VALUE '0433'.
   572     12  ER-0436                 PIC X(4)  VALUE '0436'.
   573     12  ER-0437                 PIC X(4)  VALUE '0437'.
   574     12  ER-0438                 PIC X(4)  VALUE '0438'.
   575     12  ER-0439                 PIC X(4)  VALUE '0439'.
   576     12  ER-0440                 PIC X(4)  VALUE '0440'.
   577     12  ER-0441                 PIC X(4)  VALUE '0441'.
   578     12  ER-0442                 PIC X(4)  VALUE '0442'.
   579     12  ER-0443                 PIC X(4)  VALUE '0443'.
   580     12  ER-0444                 PIC X(4)  VALUE '0444'.
   581     12  ER-0445                 PIC X(4)  VALUE '0445'.
   582     12  ER-0446                 PIC X(4)  VALUE '0446'.
   583     12  ER-0447                 PIC X(4)  VALUE '0447'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  12
* EL156.cbl
   584     12  ER-0448                 PIC X(4)  VALUE '0448'.
   585     12  ER-0449                 PIC X(4)  VALUE '0449'.
   586     12  ER-0452                 PIC X(4)  VALUE '0452'.
   587     12  ER-0458                 PIC X(4)  VALUE '0458'.
   588     12  ER-0459                 PIC X(4)  VALUE '0459'.
   589     12  ER-0460                 PIC X(4)  VALUE '0460'.
   590     12  ER-0461                 PIC X(4)  VALUE '0461'.
   591     12  ER-0462                 PIC X(4)  VALUE '0462'.
   592     12  ER-0463                 PIC X(4)  VALUE '0463'.
   593     12  ER-0464                 PIC X(4)  VALUE '0464'.
   594     12  ER-0465                 PIC X(4)  VALUE '0465'.
   595     12  ER-0466                 PIC X(4)  VALUE '0466'.
   596     12  ER-0467                 PIC X(4)  VALUE '0467'.
   597     12  ER-0468                 PIC X(4)  VALUE '0468'.
   598     12  ER-0469                 PIC X(4)  VALUE '0469'.
   599     12  ER-0473                 PIC X(4)  VALUE '0473'.
   600     12  ER-0474                 PIC X(4)  VALUE '0474'.
   601     12  ER-0475                 PIC X(4)  VALUE '0475'.
   602     12  ER-0476                 PIC X(4)  VALUE '0476'.
   603     12  ER-0477                 PIC X(4)  VALUE '0477'.
   604     12  ER-0478                 PIC X(4)  VALUE '0478'.
   605     12  ER-0479                 PIC X(4)  VALUE '0479'.
   606     12  ER-0481                 PIC X(4)  VALUE '0481'.
   607     12  ER-0491                 PIC X(4)  VALUE '0491'.
   608     12  ER-0492                 PIC X(4)  VALUE '0492'.
   609     12  ER-0493                 PIC X(4)  VALUE '0493'.
   610     12  ER-0494                 PIC X(4)  VALUE '0494'.
   611     12  ER-0495                 PIC X(4)  VALUE '0495'.
   612     12  ER-0499                 PIC X(4)  VALUE '0499'.
   613     12  ER-0500                 PIC X(4)  VALUE '0500'.
   614     12  ER-0501                 PIC X(4)  VALUE '0501'.
   615     12  ER-0502                 PIC X(4)  VALUE '0502'.
   616     12  ER-0508                 PIC X(4)  VALUE '0508'.
   617     12  ER-0513                 PIC X(4)  VALUE '0513'.
   618     12  ER-0518                 PIC X(4)  VALUE '0518'.
   619     12  ER-0524                 PIC X(4)  VALUE '0524'.
   620     12  ER-0525                 PIC X(4)  VALUE '0525'.
   621     12  ER-0526                 PIC X(4)  VALUE '0526'.
   622     12  ER-0530                 PIC X(4)  VALUE '0530'.
   623     12  ER-0540                 PIC X(4)  VALUE '0540'.
   624     12  ER-0541                 PIC X(4)  VALUE '0541'.
   625     12  ER-0542                 PIC X(4)  VALUE '0542'.
   626     12  ER-0543                 PIC X(4)  VALUE '0543'.
   627     12  ER-0545                 PIC X(4)  VALUE '0545'.
   628     12  ER-0552                 PIC X(4)  VALUE '0552'.
   629     12  ER-0555                 PIC X(4)  VALUE '0555'.
   630     12  ER-0556                 PIC X(4)  VALUE '0556'.
   631     12  ER-0557                 PIC X(4)  VALUE '0557'.
   632     12  ER-0572                 PIC X(4)  VALUE '0572'.
   633     12  ER-0573                 PIC X(4)  VALUE '0573'.
   634     12  ER-0594                 PIC X(4)  VALUE '0594'.
   635     12  ER-0616                 PIC X(4)  VALUE '0616'.
   636     12  ER-0617                 PIC X(4)  VALUE '0617'.
   637     12  ER-0618                 PIC X(4)  VALUE '0618'.
   638     12  ER-0657                 PIC X(4)  VALUE '0657'.
   639     12  ER-0658                 PIC X(4)  VALUE '0658'.
   640     12  ER-0699                 PIC X(4)  VALUE '0699'.
   641     12  ER-0730                 PIC X(4)  VALUE '0730'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  13
* EL156.cbl
   642     12  ER-0737                 PIC X(4)  VALUE '0737'.
   643     12  ER-0760                 PIC X(4)  VALUE '0760'.
   644     12  ER-0768                 PIC X(4)  VALUE '0768'.
   645     12  ER-0769                 PIC X(4)  VALUE '0769'.
   646     12  ER-0770                 PIC X(4)  VALUE '0770'.
   647     12  ER-0802                 PIC X(4)  VALUE '0802'.
   648     12  ER-0803                 PIC X(4)  VALUE '0803'.
   649     12  ER-0819                 PIC X(4)  VALUE '0819'.
   650     12  ER-0834                 PIC X(4)  VALUE '0834'.
   651     12  ER-0836                 PIC X(4)  VALUE '0836'.
   652     12  ER-0844                 PIC X(4)  VALUE '0844'.
   653     12  ER-0845                 PIC X(4)  VALUE '0845'.
   654     12  ER-0846                 PIC X(4)  VALUE '0846'.
   655     12  ER-0849                 PIC X(4)  VALUE '0849'.
   656     12  ER-0851                 PIC X(4)  VALUE '0851'.
   657     12  ER-0872                 PIC X(4)  VALUE '0872'.
   658     12  ER-0873                 PIC X(4)  VALUE '0873'.
   659     12  ER-0874                 PIC X(4)  VALUE '0874'.
   660     12  ER-0879                 PIC X(4)  VALUE '0879'.
   661     12  ER-0919                 PIC X(4)  VALUE '0919'.
   662     12  ER-0921                 PIC X(4)  VALUE '0921'.
   663     12  ER-0923                 PIC X(4)  VALUE '0923'.
   664     12  ER-0925                 PIC X(4)  VALUE '0925'.
   665     12  ER-0944                 PIC X(4)  VALUE '0944'.
   666     12  ER-0945                 PIC X(4)  VALUE '0945'.
   667     12  ER-0946                 PIC X(4)  VALUE '0946'.
   668     12  ER-0947                 PIC X(4)  VALUE '0947'.
   669     12  ER-0948                 PIC X(4)  VALUE '0948'.
   670     12  ER-0949                 PIC X(4)  VALUE '0949'.
   671     12  ER-0950                 PIC X(4)  VALUE '0950'.
   672     12  ER-0951                 PIC X(4)  VALUE '0951'.
   673     12  ER-0954                 PIC X(4)  VALUE '0954'.
   674     12  ER-0956                 PIC X(4)  VALUE '0956'.
   675     12  ER-0967                 PIC X(4)  VALUE '0967'.
   676     12  ER-0968                 PIC X(4)  VALUE '0968'.
   677     12  ER-0974                 PIC X(4)  VALUE '0974'.
   678     12  ER-0975                 PIC X(4)  VALUE '0975'.
   679     12  ER-1561                 PIC X(4)  VALUE '1561'.
   680     12  ER-1566                 PIC X(4)  VALUE '1566'.
   681     12  ER-1567                 PIC X(4)  VALUE '1567'.
   682     12  ER-1569                 PIC X(4)  VALUE '1569'.
   683     12  er-1657                 pic x(4)  value '1657'.
   684     12  er-1658                 pic x(4)  value '1658'.
   685     12  er-1667                 pic x(4)  value '1667'.
   686     12  er-1670                 pic x(4)  value '1670'.
   687     12  er-1671                 pic x(4)  value '1671'.
   688     12  er-1672                 pic x(4)  value '1672'.
   689     12  er-1673                 pic x(4)  value '1673'.
   690     12  er-1674                 pic x(4)  value '1674'.
   691     12  er-1677                 pic x(4)  value '1677'.
   692     12  ER-1775                 PIC X(4)  VALUE '1775'.
   693     12  ER-1880                 PIC X(4)  VALUE '1880'.
   694     12  ER-2044                 PIC X(4)  VALUE '2044'.
   695     12  ER-3140                 PIC X(4)  VALUE '3140'.
   696     12  ER-3141                 PIC X(4)  VALUE '3141'.
   697     12  ER-3255                 PIC X(4)  VALUE '3255'.
   698     12  ER-3516                 PIC X(4)  VALUE '3516'.
   699     12  ER-3527                 PIC X(4)  VALUE '3527'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  14
* EL156.cbl
   700     12  ER-3528                 PIC X(4)  VALUE '3528'.
   701     12  ER-3529                 PIC X(4)  VALUE '3529'.
   702     12  ER-3530                 PIC X(4)  VALUE '3530'.
   703     12  ER-3531                 PIC X(4)  VALUE '3531'.
   704     12  ER-3532                 PIC X(4)  VALUE '3532'.
   705     12  ER-3533                 PIC X(4)  VALUE '3533'.
   706     12  ER-3534                 PIC X(4)  VALUE '3534'.
   707     12  ER-3535                 PIC X(4)  VALUE '3535'.
   708     12  ER-3536                 PIC X(4)  VALUE '3536'.
   709     12  ER-3537                 PIC X(4)  VALUE '3537'.
   710     12  ER-3538                 PIC X(4)  VALUE '3538'.
   711     12  ER-3539                 PIC X(4)  VALUE '3539'.
   712     12  ER-3540                 PIC X(4)  VALUE '3540'.
   713     12  ER-3541                 PIC X(4)  VALUE '3541'.
   714     12  ER-3542                 PIC X(4)  VALUE '3542'.
   715     12  ER-3543                 PIC X(4)  VALUE '3543'.
   716     12  ER-3546                 PIC X(4)  VALUE '3546'.
   717     12  ER-3549                 PIC X(4)  VALUE '3549'.
   718     12  ER-3818                 PIC X(4)  VALUE '3818'.
   719     12  ER-7540                 PIC X(4)  VALUE '7540'.
   720     12  ER-7576                 PIC X(4)  VALUE '7576'.
   721     12  ER-7579                 PIC X(4)  VALUE '7579'.
   722     12  ER-7580                 PIC X(4)  VALUE '7580'.
   723     12  ER-7583                 PIC X(4)  VALUE '7583'.
   724     12  ER-7830                 PIC X(4)  VALUE '7830'.
   725     12  ER-7831                 PIC X(4)  VALUE '7831'.
   726     12  ER-7832                 PIC X(4)  VALUE '7832'.
   727     12  ER-7833                 PIC X(4)  VALUE '7833'.
   728     12  ER-7834                 PIC X(4)  VALUE '7834'.
   729     12  ER-7835                 PIC X(4)  VALUE '7835'.
   730     12  ER-7836                 PIC X(4)  VALUE '7836'.
   731     12  ER-7837                 PIC X(4)  VALUE '7837'.
   732     12  ER-7838                 PIC X(4)  VALUE '7838'.
   733     12  ER-7841                 PIC X(4)  VALUE '7841'.
   734     12  ER-7844                 PIC X(4)  VALUE '7844'.
   735     12  ER-7845                 PIC X(4)  VALUE '7845'.
   736     12  ER-8000                 PIC X(4)  VALUE '8000'.
   737     12  ER-8051                 PIC X(4)  VALUE '8051'.
   738     12  ER-8052                 PIC X(4)  VALUE '8052'.
   739     12  ER-8053                 PIC X(4)  VALUE '8053'.
   740     12  ER-8054                 PIC X(4)  VALUE '8054'.
   741     12  ER-8055                 PIC X(4)  VALUE '8055'.
   742     12  ER-8056                 PIC X(4)  VALUE '8056'.
   743     12  ER-8057                 PIC X(4)  VALUE '8057'.
   744     12  ER-8058                 PIC X(4)  VALUE '8058'.
   745     12  ER-8059                 PIC X(4)  VALUE '8059'.
   746     12  ER-8060                 PIC X(4)  VALUE '8060'.
   747     12  ER-8061                 PIC X(4)  VALUE '8061'.
   748     12  ER-8062                 PIC X(4)  VALUE '8062'.
   749     12  ER-8063                 PIC X(4)  VALUE '8063'.
   750     12  ER-8064                 PIC X(4)  VALUE '8064'.
   751     12  ER-8065                 PIC X(4)  VALUE '8065'.
   752     12  ER-8066                 PIC X(4)  VALUE '8066'.
   753     12  ER-8146                 PIC X(4)  VALUE '8146'.
   754     12  ER-8147                 PIC X(4)  VALUE '8147'.
   755     12  ER-8152                 PIC X(4)  VALUE '8152'.
   756     12  ER-8153                 PIC X(4)  VALUE '8153'.
   757     12  ER-8154                 PIC X(4)  VALUE '8154'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  15
* EL156.cbl
   758     12  ER-8155                 PIC X(4)  VALUE '8155'.
   759     12  ER-8310                 PIC X(4)  VALUE '8310'.
   760     12  ER-8311                 PIC X(4)  VALUE '8311'.
   761     12  ER-8312                 PIC X(4)  VALUE '8312'.
   762     12  ER-8313                 PIC X(4)  VALUE '8313'.
   763     12  ER-8314                 PIC X(4)  VALUE '8314'.
   764     12  ER-8315                 PIC X(4)  VALUE '8315'.
   765     12  ER-8316                 PIC X(4)  VALUE '8316'.
   766     12  ER-8317                 PIC X(4)  VALUE '8317'.
   767
   768 01  CSO-WORK-FIELDS.
   769     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   770       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   771
   772     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   773     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   774         88  CERT-NOTE-ADDED           VALUE 'Y'.
   775     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   776         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   777     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   778
   779     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   780
   781 01  SC-NP6-CERT-NOTE.
   782     12  FILLER                  PIC X(12)
   783               VALUE 'REM BENEFIT '.
   784     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   785     12  SC-NP6-COMM             PIC X(8)
   786               VALUE ' + 6 MO '.
   787     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   788     12  FILLER                  PIC X(12)
   789               VALUE ' = AMT PAID '.
   790     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   791
   792 01  SC-NP6-ORIG-NOTE.
   793     12  FILLER                  PIC X(63)  VALUE
   794         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   795 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   796     88  PDEF-FOUND                   VALUE 'Y'.
   797 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   798     88  ACCT-FOUND                   VALUE 'Y'.
   799 01  CTBL-KEY-SAVE               PIC X(5).
   800 01  CTBL-KEY.
   801     05  CTBL-COMPANY-CD         PIC X.
   802     05  CTBL-TABLE              PIC XXX.
   803     05  CTBL-BEN-TYPE           PIC X.
   804     05  CTBL-BEN-CODE           PIC XX.
   805 01  ERPDEF-KEY-SAVE             PIC X(18).
   806 01  ERPDEF-KEY.
   807     12  ERPDEF-COMPANY-CD       PIC X.
   808     12  ERPDEF-STATE            PIC XX.
   809     12  ERPDEF-PROD-CD          PIC XXX.
   810     12  F                       PIC X(7).
   811     12  ERPDEF-BEN-TYPE         PIC X.
   812     12  ERPDEF-BEN-CODE         PIC XX.
   813     12  ERPDEF-EXP-DT           PIC XX.
   814 01  ELCRTT-KEY.
   815     05  CTRLR-COMP-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  16
* EL156.cbl
   816     05  CTRLR-CARRIER       PIC X.
   817     05  CTRLR-GROUPING      PIC X(6).
   818     05  CTRLR-STATE         PIC X(2).
   819     05  CTRLR-ACCOUNT       PIC X(10).
   820     05  CTRLR-EFF-DT        PIC XX.
   821     05  CTRLR-CERT-NO       PIC X(11).
   822     05  CTRLR-REC-TYPE      PIC X.
   823 01  ACCESS-KEYS.
   824     12  ELARCH-KEY.
   825         16  ARCH-CO             PIC X.
   826         16  ARCH-NUMBER         PIC S9(08) COMP.
   827         16  ARCH-REC-TYPE       PIC X.
   828         16  ARCH-SEQ            PIC S9(04) COMP.
   829     12  ELMSTR-KEY.
   830         16  MSTR-COMP-CD        PIC X.
   831         16  MSTR-CARRIER        PIC X.
   832         16  MSTR-CLAIM-NO       PIC X(7).
   833         16  MSTR-CERT-NO        PIC X(11).
   834     12  ELCNTL-KEY.
   835         16  CNTL-COMP-ID        PIC X(3).
   836         16  CNTL-REC-TYPE       PIC X.
   837         16  CNTL-ACCESS         PIC X(4).
   838         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   839     12  ELCERT-KEY.
   840         16  CERT-COMP-CD        PIC X.
   841         16  CERT-CARRIER        PIC X.
   842         16  CERT-GROUPING       PIC X(6).
   843         16  CERT-STATE          PIC XX.
   844         16  CERT-ACCOUNT        PIC X(10).
   845         16  CERT-EFF-DT         PIC XX.
   846         16  CERT-CERT-NO        PIC X(11).
   847     12  ELTRLR-KEY.
   848         16  TRLR-COMP-CD        PIC X.
   849         16  TRLR-CARRIER        PIC X.
   850         16  TRLR-CLAIM-NO       PIC X(7).
   851         16  TRLR-CERT-NO        PIC X(11).
   852         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   853     12  ELACTQ-KEY.
   854         16  ACTQ-COMP-CD        PIC X.
   855         16  ACTQ-CARRIER        PIC X.
   856         16  ACTQ-CLAIM-NO       PIC X(7).
   857         16  ACTQ-CERT-NO        PIC X(11).
   858     12  W-NOTE-KEY.
   859         16  W-NOTE-COMP-CD      PIC X.
   860         16  W-NOTE-CERT-KEY.
   861             20  W-NOTE-CARRIER  PIC X.
   862             20  W-NOTE-GROUPING PIC X(6).
   863             20  W-NOTE-STATE    PIC XX.
   864             20  W-NOTE-ACCOUNT  PIC X(10).
   865             20  W-NOTE-EFF-DT   PIC XX.
   866             20  W-NOTE-CERT-NO  PIC X(11).
   867     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   868     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   869     12  ERACCT-KEY.
   870         16  ERACCT-PARTIAL-KEY.
   871             20  ACCT-COMP-CD    PIC X.
   872             20  ACCT-CARRIER    PIC X.
   873             20  ACCT-GROUPING   PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  17
* EL156.cbl
   874             20  ACCT-STATE      PIC XX.
   875             20  ACCT-ACCOUNT    PIC X(10).
   876         16  ACCT-EXP-DT         PIC XX.
   877         16  FILLER              PIC X(4) VALUE SPACES.
   878     12  ELCHKQ-KEY.
   879         16  CHKQ-COMP-CD        PIC X.
   880         16  CHKQ-CONTROL        PIC S9(8) COMP.
   881         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   882     12  ELBENE-KEY.
   883         16  BENE-COMP-CD         PIC X.
   884         16  BENE-RECORD-TYPE     PIC X.
   885         16  BENE-NUMBER          PIC X(10).
   886     12  ERCOMP-KEY.
   887         16  COMP-COMP-CD        PIC X.
   888         16  COMP-CARRIER        PIC X.
   889         16  COMP-GROUP          PIC X(06).
   890         16  COMP-FIN-RESP       PIC X(10).
   891         16  COMP-ACCOUNT        PIC X(10).
   892         16  COMP-TYPE           PIC X.
   893
   894     12  DLO035-KEY.
   895         16  DL35-PROCESS-TYPE   PIC X.
   896         16  DL35-CREDIT-CARD    PIC X(20).
   897         16  DL35-BEN-TYPE       PIC XX.
   898         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   899         16  DL35-RETURN-CODE    PIC XX.
   900
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  18
* EL156.cbl
   902*    COPY ELCDATE.
   903******************************************************************
   904*                                                                *
   905*                                                                *
   906*                            ELCDATE.                            *
   907*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   908*                            VMOD=2.003
   909*                                                                *
   910*                                                                *
   911*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   912*                 LENGTH = 200                                   *
   913******************************************************************
   914
   915 01  DATE-CONVERSION-DATA.
   916     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   917     12  DC-OPTION-CODE                PIC X.
   918         88  BIN-TO-GREG                VALUE ' '.
   919         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   920         88  EDIT-GREG-TO-BIN           VALUE '2'.
   921         88  YMD-GREG-TO-BIN            VALUE '3'.
   922         88  MDY-GREG-TO-BIN            VALUE '4'.
   923         88  JULIAN-TO-BIN              VALUE '5'.
   924         88  BIN-PLUS-ELAPSED           VALUE '6'.
   925         88  FIND-CENTURY               VALUE '7'.
   926         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   927         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   928         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   929         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   930         88  JULIAN-TO-BIN-3            VALUE 'C'.
   931         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   932         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   933         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   934         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   935         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   936         88  CHECK-LEAP-YEAR            VALUE 'H'.
   937         88  BIN-3-TO-GREG              VALUE 'I'.
   938         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   939         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   940         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   941         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   942         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   943         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   944         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   945         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   946         88  THREE-CHARACTER-BIN
   947                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   948         88  GREGORIAN-TO-BIN
   949                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   950         88  BIN-TO-GREGORIAN
   951                  VALUES ' ' '1' 'I' '8' 'G'.
   952         88  JULIAN-TO-BINARY
   953                  VALUES '5' 'C' 'E' 'F'.
   954     12  DC-ERROR-CODE                 PIC X.
   955         88  NO-CONVERSION-ERROR        VALUE ' '.
   956         88  DATE-CONVERSION-ERROR
   957                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   958         88  DATE-IS-ZERO               VALUE '1'.
   959         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  19
* EL156.cbl
   960         88  DATE-IS-INVALID            VALUE '3'.
   961         88  DATE1-GREATER-DATE2        VALUE '4'.
   962         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   963         88  DATE-INVALID-OPTION        VALUE '9'.
   964         88  INVALID-CENTURY            VALUE 'A'.
   965         88  ONLY-CENTURY               VALUE 'B'.
   966         88  ONLY-LEAP-YEAR             VALUE 'C'.
   967         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   968     12  DC-END-OF-MONTH               PIC X.
   969         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   970     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   971         88  USE-NORMAL-PROCESS         VALUE ' '.
   972         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   973         88  ADJUST-UP-100-YRS          VALUE '2'.
   974     12  FILLER                        PIC X.
   975     12  DC-CONVERSION-DATES.
   976         16  DC-BIN-DATE-1             PIC XX.
   977         16  DC-BIN-DATE-2             PIC XX.
   978         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   979         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   980                       DC-GREG-DATE-1-EDIT.
   981             20  DC-EDIT1-MONTH        PIC 99.
   982             20  SLASH1-1              PIC X.
   983             20  DC-EDIT1-DAY          PIC 99.
   984             20  SLASH1-2              PIC X.
   985             20  DC-EDIT1-YEAR         PIC 99.
   986         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   987         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   988                     DC-GREG-DATE-2-EDIT.
   989             20  DC-EDIT2-MONTH        PIC 99.
   990             20  SLASH2-1              PIC X.
   991             20  DC-EDIT2-DAY          PIC 99.
   992             20  SLASH2-2              PIC X.
   993             20  DC-EDIT2-YEAR         PIC 99.
   994         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   995         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   996                     DC-GREG-DATE-1-YMD.
   997             20  DC-YMD-YEAR           PIC 99.
   998             20  DC-YMD-MONTH          PIC 99.
   999             20  DC-YMD-DAY            PIC 99.
  1000         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1001         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1002                      DC-GREG-DATE-1-MDY.
  1003             20  DC-MDY-MONTH          PIC 99.
  1004             20  DC-MDY-DAY            PIC 99.
  1005             20  DC-MDY-YEAR           PIC 99.
  1006         16  DC-GREG-DATE-1-ALPHA.
  1007             20  DC-ALPHA-MONTH        PIC X(10).
  1008             20  DC-ALPHA-DAY          PIC 99.
  1009             20  FILLER                PIC XX.
  1010             20  DC-ALPHA-CENTURY.
  1011                 24 DC-ALPHA-CEN-N     PIC 99.
  1012             20  DC-ALPHA-YEAR         PIC 99.
  1013         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1014         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1015         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1016         16  DC-JULIAN-DATE            PIC 9(05).
  1017         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  20
* EL156.cbl
  1018                                       PIC 9(05).
  1019         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1020             20  DC-JULIAN-YEAR        PIC 99.
  1021             20  DC-JULIAN-DAYS        PIC 999.
  1022         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1023         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1024         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1025     12  DATE-CONVERSION-VARIBLES.
  1026         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1027         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1028             20  FILLER                PIC 9(3).
  1029             20  HOLD-CEN-1-CCYY.
  1030                 24  HOLD-CEN-1-CC     PIC 99.
  1031                 24  HOLD-CEN-1-YY     PIC 99.
  1032             20  HOLD-CEN-1-MO         PIC 99.
  1033             20  HOLD-CEN-1-DA         PIC 99.
  1034         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1035             20  HOLD-CEN-1-R-MO       PIC 99.
  1036             20  HOLD-CEN-1-R-DA       PIC 99.
  1037             20  HOLD-CEN-1-R-CCYY.
  1038                 24  HOLD-CEN-1-R-CC   PIC 99.
  1039                 24  HOLD-CEN-1-R-YY   PIC 99.
  1040             20  FILLER                PIC 9(3).
  1041         16  HOLD-CENTURY-1-X.
  1042             20  FILLER                PIC X(3)  VALUE SPACES.
  1043             20  HOLD-CEN-1-X-CCYY.
  1044                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1045                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1046             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1047             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1048         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1049             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1050             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1051             20  HOLD-CEN-1-R-X-CCYY.
  1052                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1053                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1054             20  FILLER                PIC XXX.
  1055         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1056         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1057         16  DC-JULIAN-DATE-1          PIC 9(07).
  1058         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1059             20  DC-JULIAN-1-CCYY.
  1060                 24  DC-JULIAN-1-CC    PIC 99.
  1061                 24  DC-JULIAN-1-YR    PIC 99.
  1062             20  DC-JULIAN-DA-1        PIC 999.
  1063         16  DC-JULIAN-DATE-2          PIC 9(07).
  1064         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1065             20  DC-JULIAN-2-CCYY.
  1066                 24  DC-JULIAN-2-CC    PIC 99.
  1067                 24  DC-JULIAN-2-YR    PIC 99.
  1068             20  DC-JULIAN-DA-2        PIC 999.
  1069         16  DC-GREG-DATE-A-EDIT.
  1070             20  DC-EDITA-MONTH        PIC 99.
  1071             20  SLASHA-1              PIC X VALUE '/'.
  1072             20  DC-EDITA-DAY          PIC 99.
  1073             20  SLASHA-2              PIC X VALUE '/'.
  1074             20  DC-EDITA-CCYY.
  1075                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  21
* EL156.cbl
  1076                 24  DC-EDITA-YEAR     PIC 99.
  1077         16  DC-GREG-DATE-B-EDIT.
  1078             20  DC-EDITB-MONTH        PIC 99.
  1079             20  SLASHB-1              PIC X VALUE '/'.
  1080             20  DC-EDITB-DAY          PIC 99.
  1081             20  SLASHB-2              PIC X VALUE '/'.
  1082             20  DC-EDITB-CCYY.
  1083                 24  DC-EDITB-CENT     PIC 99.
  1084                 24  DC-EDITB-YEAR     PIC 99.
  1085         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1086         16  DC-GREG-DATE-CYMD-R REDEFINES
  1087                              DC-GREG-DATE-CYMD.
  1088             20  DC-CYMD-CEN           PIC 99.
  1089             20  DC-CYMD-YEAR          PIC 99.
  1090             20  DC-CYMD-MONTH         PIC 99.
  1091             20  DC-CYMD-DAY           PIC 99.
  1092         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1093         16  DC-GREG-DATE-MDCY-R REDEFINES
  1094                              DC-GREG-DATE-MDCY.
  1095             20  DC-MDCY-MONTH         PIC 99.
  1096             20  DC-MDCY-DAY           PIC 99.
  1097             20  DC-MDCY-CEN           PIC 99.
  1098             20  DC-MDCY-YEAR          PIC 99.
  1099    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1100        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1101    12  DC-EL310-DATE                  PIC X(21).
  1102    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  22
* EL156.cbl
  1104*    COPY ELCLOGOF.
  1105******************************************************************
  1106*                                                                *
  1107*                                                                *
  1108*                            ELCLOGOF.                           *
  1109*                            VMOD=2.001                          *
  1110*                                                                *
  1111*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1112*                                                                *
  1113******************************************************************
  1114 01  CLASIC-LOGOFF.
  1115     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1116     12  LOGOFF-TEXT.
  1117         16  FILLER          PIC X(5)    VALUE SPACES.
  1118         16  LOGOFF-MSG.
  1119             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1120             20  FILLER      PIC X       VALUE SPACES.
  1121             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1122         16  FILLER          PIC X(80)
  1123           VALUE '* YOU ARE NOW LOGGED OFF'.
  1124         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1125         16  FILLER          PIC X       VALUE QUOTE.
  1126         16  LOGOFF-SYS-MSG  PIC X(17)
  1127           VALUE 'S CLAS-IC SYSTEM '.
  1128     12  TEXT-MESSAGES.
  1129         16  UNACCESS-MSG    PIC X(29)
  1130             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1131         16  PGMIDERR-MSG    PIC X(17)
  1132             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  23
* EL156.cbl
  1134*    COPY ELCCALC.
  1135******************************************************************
  1136*                                                                *
  1137*                           ELCCALC.                            *
  1138*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1139*                            VMOD=2.025                          *
  1140*                                                                *
  1141*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1142*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1143*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1144*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1145*                                                                *
  1146*  PASSED TO ELRTRM                                              *
  1147*  -----------------                                             *
  1148*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1149*  ORIGINAL TERM                                                 *
  1150*  BEGINNING DATE                                                *
  1151*  ENDING DATE                                                   *
  1152*  COMPANY I.D.                                                  *
  1153*  ACCOUNT MASTER USER FIELD                                     *
  1154*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1155*  FREE LOOK DAYS                                                *
  1156*                                                                *
  1157*  RETURNED FROM ELRTRM                                          *
  1158*  ---------------------                                         *
  1159*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1160*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1161*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1162*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1163*----------------------------------------------------------------*
  1164*  PASSED TO ELRAMT                                              *
  1165*  ----------------                                              *
  1166*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1167*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1168*  ORIGINAL AMOUNT                                               *
  1169*  ALTERNATE BENEFIT (BALLON)                                    *
  1170*  A.P.R. - NET PAY ONLY                                         *
  1171*  METHOD
  1172*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1173*  COMPANY I.D.                                                  *
  1174*  BENEFIT TYPE                                                  *
  1175*                                                                *
  1176*  RETURNED FROM ELRAMT                                          *
  1177*  --------------------                                          *
  1178*  REMAINING AMOUNT 1 - CURRENT                                  *
  1179*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1180*  REMAINING AMOUNT FACTOR
  1181*----------------------------------------------------------------*
  1182*  PASSED TO ELRESV                                              *
  1183*  -----------------                                             *
  1184*  CERTIFICATE EFFECTIVE DATE                                    *
  1185*  VALUATION DATE                                                *
  1186*  PAID THRU DATE                                                *
  1187*  BENEFIT                                                       *
  1188*  INCURRED DATE                                                 *
  1189*  REPORTED DATE                                                 *
  1190*  ISSUE AGE                                                     *
  1191*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  24
* EL156.cbl
  1192*  CDT PERCENT                                                   *
  1193*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1194* *CLAIM TYPE (LIFE, A/H)                                        *
  1195* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1196* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1197*                                                                *
  1198*  RETURNED FROM ELRESV                                          *
  1199*  --------------------                                          *
  1200*  CDT TABLE USED                                                *
  1201*  CDT FACTOR USED                                               *
  1202*  PAY TO CURRENT RESERVE                                        *
  1203*  I.B.N.R. - A/H ONLY                                           *
  1204*  FUTURE (ACCRUED) AH ONLY                                      *
  1205*----------------------------------------------------------------*
  1206*  PASSED TO ELRATE                                              *
  1207*  ----------------                                              *
  1208*  CERT ISSUE DATE                                               *
  1209*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1210*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1211*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1212*  STATE CODE (CLIENT DEFINED)                                   *
  1213*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1214*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1215*  DEVIATION CODE                                                *
  1216*  ISSUE AGE                                                     *
  1217*  ORIGINAL BENEFIT AMOUNT                                       *
  1218*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1219*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1220*  BENEFIT KIND (LIFE OR A/H)                                    *
  1221*  A.P.R.                                                        *
  1222*  METHOD
  1223*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1224*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1225*  COMPANY I.D. (3 CHARACTER)                                    *
  1226*  BENEFIT CODE                                                  *
  1227*  BENEFIT OVERRIDE CODE                                         *
  1228*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1229*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1230*  JOINT INDICATOR (CSL ONLY)                                    *
  1231*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1232*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1233*                                                                *
  1234*  RETURNED FROM ELRATE                                          *
  1235*  --------------------                                          *
  1236*  CALCULATED PREMIUM                                            *
  1237*  PREMIUM RATE                                                  *
  1238*  MORTALITY CODE                                                *
  1239*  MAX ATTAINED AGE                                              *
  1240*  MAX AGE                                                       *
  1241*  MAX TERM                                                      *
  1242*  MAX MONTHLY BENEFIT                                           *
  1243*  MAX TOTAL BENIFIT                                             *
  1244*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1245*----------------------------------------------------------------*
  1246*  PASSED TO ELRFND                                              *
  1247*  ----------------                                              *
  1248*  CERT ISSUE DATE                                               *
  1249*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  25
* EL156.cbl
  1250*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1251*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1252*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1253*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1254*  STATE CODE (CLIENT DEFINED)                                   *
  1255*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1256*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1257*  DEVIATION CODE                                                *
  1258*  ISSUE AGE                                                     *
  1259*  ORIGINAL BENEFIT AMOUNT                                       *
  1260*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1261*  PROCESS TYPE (CANCEL)                                         *
  1262*  BENEFIT KIND (LIFE OR A/H)                                    *
  1263*  A.P.R.                                                        *
  1264*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1265*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1266*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1267*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1268*  COMPANY I.D. (3 CHARACTER)                                    *
  1269*  BENEFIT CODE                                                  *
  1270*  BENEFIT OVERRIDE CODE                                         *
  1271*                                                                *
  1272*  RETURNED FROM ELRFND                                          *
  1273*  --------------------                                          *
  1274*  CALCULATED REFUND                                             *
  1275*----------------------------------------------------------------*
  1276*  PASSED TO ELEARN                                              *
  1277*  ----------------                                              *
  1278*  CERT ISSUE DATE                                               *
  1279*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1280*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1281*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1282*  STATE CODE (CLIENT DEFINED)                                   *
  1283*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1284*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1285*  DEVIATION CODE                                                *
  1286*  ISSUE AGE                                                     *
  1287*  ORIGINAL BENEFIT AMOUNT                                       *
  1288*  BENEFIT KIND (LIFE OR A/H)                                    *
  1289*  A.P.R.                                                        *
  1290*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1291*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1292*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1293*  COMPANY I.D. (3 CHARACTER)                                    *
  1294*  BENEFIT CODE                                                  *
  1295*  BENEFIT OVERRIDE CODE                                         *
  1296*                                                                *
  1297*  RETURNED FROM ELEARN                                          *
  1298*  --------------------                                          *
  1299*  INDICATED  EARNINGS                                           *
  1300*----------------------------------------------------------------*
  1301*                 LENGTH = 450                                   *
  1302*                                                                *
  1303******************************************************************
  1304******************************************************************
  1305*                   C H A N G E   L O G
  1306*
  1307* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  26
* EL156.cbl
  1308*-----------------------------------------------------------------
  1309*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1310* EFFECTIVE    NUMBER
  1311*-----------------------------------------------------------------
  1312* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1313* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1314* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1315* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1316* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1317* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1318* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1319* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1320* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1321******************************************************************
  1322
  1323 01  CALCULATION-PASS-AREA.
  1324     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1325                                     COMP.
  1326
  1327     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1328       88  NO-CP-ERROR                             VALUE ZERO.
  1329       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1330                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1331       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1332       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1333       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1334       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1335       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1336       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1337       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1338       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1339       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1340       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1341       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1342       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1343       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1344       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1345       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1346       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1347       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1348
  1349     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1350       88  NO-CP-ERROR-2                           VALUE ZERO.
  1351***********************  INPUT AREAS ****************************
  1352
  1353     12  CP-CALCULATION-AREA.
  1354         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1355         16  CP-CERT-EFF-DT        PIC XX.
  1356         16  CP-VALUATION-DT       PIC XX.
  1357         16  CP-PAID-THRU-DT       PIC XX.
  1358         16  CP-BENEFIT-TYPE       PIC X.
  1359           88  CP-AH                               VALUE 'A' 'D'
  1360                                                   'I' 'U'.
  1361           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1362           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1363         16  CP-INCURRED-DT        PIC XX.
  1364         16  CP-REPORTED-DT        PIC XX.
  1365         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  27
* EL156.cbl
  1366         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1367         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1368                                     COMP-3.
  1369         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1370                                     COMP-3.
  1371         16  CP-CDT-METHOD         PIC X.
  1372           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1373           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1374           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1375         16  CP-CLAIM-TYPE         PIC X.
  1376           88  CP-AH-CLAIM                         VALUE 'A'.
  1377           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1378         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1379                                     COMP-3.
  1380         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1381                                     COMP-3.
  1382         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1383                                     COMP-3.
  1384         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1385                                     COMP-3.
  1386         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1387                                     COMP-3.
  1388         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1389                                     COMP-3.
  1390         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1391                                     COMP-3.
  1392         16  CP-REM-TERM-METHOD    PIC X.
  1393           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1394           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1395           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1396           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1397           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1398           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1399           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1400         16  CP-EARNING-METHOD     PIC X.
  1401           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1402           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1403           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1404           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1405           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1406           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1407           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1408           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1409           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1410           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1411           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1412           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1413           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1414           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1415         16  CP-PROCESS-TYPE       PIC X.
  1416           88  CP-CLAIM                            VALUE '1'.
  1417           88  CP-CANCEL                           VALUE '2'.
  1418           88  CP-ISSUE                            VALUE '3'.
  1419         16  CP-SPECIAL-CALC-CD    PIC X.
  1420           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1421           88  CP-1-MTH-INTEREST               VALUE ' '.
  1422           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1423           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  28
* EL156.cbl
  1424           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1425           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1426           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1427           88  CP-FARM-PLAN                    VALUE 'F'.
  1428           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1429           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1430           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1431           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1432           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1433           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1434           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1435           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1436           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1437           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1438                                                     'W' 'X'.
  1439           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1440           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1441           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1442           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1443           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1444           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1445           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1446           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1447           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1448           88  CP-CSL-METH-1                   VALUE '5'.
  1449           88  CP-CSL-METH-2                   VALUE '6'.
  1450           88  CP-CSL-METH-3                   VALUE '7'.
  1451           88  CP-CSL-METH-4                   VALUE '8'.
  1452
  1453         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1454                                     COMP-3.
  1455         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1456         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1457         16  CP-STATE              PIC XX          VALUE SPACE.
  1458         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1459         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1460           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1461               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1462         16  CP-R78-OPTION         PIC X.
  1463           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1464           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1465
  1466         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1467         16  CP-IBNR-RESERVE-SW    PIC X.
  1468         16  CP-CLAIM-STATUS       PIC X.
  1469         16  CP-RATE-FILE          PIC X.
  1470         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1471                                     COMP-3.
  1472
  1473         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1474         16  CP-AH-OVERRIDE-CODE   PIC X.
  1475
  1476         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1477                                     COMP-3.
  1478         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1479                                   PIC S9(5)V99 COMP-3.
  1480         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1481                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  29
* EL156.cbl
  1482         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1483                                     COMP-3.
  1484         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1485                                     COMP-3.
  1486         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1487                                  PIC S9(7)V99 COMP-3.
  1488
  1489         16  CP-PAID-FROM-DATE     PIC X(02).
  1490         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1491         16  CP-EXT-DAYS-CALC      PIC X.
  1492           88  CP-EXT-NO-CHG                   VALUE ' '.
  1493           88  CP-EXT-CHG-LF                   VALUE '1'.
  1494           88  CP-EXT-CHG-AH                   VALUE '2'.
  1495           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1496         16  CP-DOMICILE-STATE     PIC XX.
  1497         16  CP-CARRIER            PIC X.
  1498         16  CP-REIN-FLAG          PIC X.
  1499         16  CP-REM-TRM-CALC-OPTION PIC X.
  1500           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1501                      '2' '3' '4' '5'.
  1502           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1503           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1504           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1505           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1506           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1507           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1508           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1509           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1510         16  CP-SIG-SWITCH         PIC X.
  1511         16  CP-RATING-METHOD      PIC X.
  1512           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1513           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1514           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1515           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1516           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1517           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1518           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1519           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1520           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1521         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1522                                     COMP-3.
  1523         16  CP-BEN-CATEGORY       PIC X.
  1524         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1525         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1526                                   PIC S99V9(5) COMP-3.
  1527         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1528         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1529                                   PIC S99V9(5) COMP-3.
  1530         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1531         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1532         16  CP-EXPIRE-DT          PIC XX.
  1533         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1534         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1535         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1536         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1537         16  CP-DDF-SPEC-CALC      PIC X.
  1538             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1539             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  30
* EL156.cbl
  1540         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1541         16  CP-CANCEL-REASON      PIC X.
  1542         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1543         16  CP-PMT-MODE           PIC X.
  1544         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1545         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1546         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1547         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1548         16  FILLER                PIC X.
  1549
  1550***************    OUTPUT FROM ELRESV   ************************
  1551
  1552         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1553
  1554         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1555                                     COMP-3.
  1556         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1557                                     COMP-3.
  1558         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1559                                     COMP-3.
  1560         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1561                                     COMP-3.
  1562         16  FILLER                PIC X(09).
  1563***************    OUTPUT FROM ELRTRM   *************************
  1564
  1565         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1566                                     COMP-3.
  1567         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1568                                     COMP-3.
  1569         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1570                                     COMP-3.
  1571         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1572                                     COMP-3.
  1573         16  FILLER                PIC X(12).
  1574
  1575***************    OUTPUT FROM ELRAMT   *************************
  1576
  1577         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1578                                     COMP-3.
  1579         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1580                                     COMP-3.
  1581         16  FILLER                PIC X(12).
  1582
  1583***************    OUTPUT FROM ELRATE   *************************
  1584
  1585         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1586                                     COMP-3.
  1587         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1588                                     COMP-3.
  1589         16  CP-MORTALITY-CODE     PIC X(4).
  1590         16  CP-RATE-EDIT-FLAG     PIC X.
  1591             88  CP-RATES-NEED-APR                  VALUE '1'.
  1592         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1593                                     COMP-3.
  1594         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1595         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1596         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1597                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  31
* EL156.cbl
  1598         16  FILLER                PIC X(07).
  1599
  1600***************    OUTPUT FROM ELRFND   *************************
  1601
  1602         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1603                                     COMP-3.
  1604         16  CP-REFUND-TYPE-USED   PIC X.
  1605           88  CP-R-AS-R78                         VALUE '1'.
  1606           88  CP-R-AS-PRORATA                     VALUE '2'.
  1607           88  CP-R-AS-CALIF                       VALUE '3'.
  1608           88  CP-R-AS-TEXAS                       VALUE '4'.
  1609           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1610           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1611           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1612           88  CP-R-AS-MEAN                        VALUE '8'.
  1613           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1614           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1615           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1616           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1617           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1618           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1619         16  FILLER                PIC X(12).
  1620
  1621***************    OUTPUT FROM ELEARN   *************************
  1622
  1623         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1624                                     COMP-3.
  1625         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1626                                     COMP-3.
  1627         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1628                                     COMP-3.
  1629         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1630                                     COMP-3.
  1631         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1632                                     COMP-3.
  1633         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1634                                     COMP-3.
  1635         16  CP-EARNING-TYPE-USED  PIC X.
  1636           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1637           88  CP-E-AS-R78                         VALUE '1'.
  1638           88  CP-E-AS-PRORATA                     VALUE '2'.
  1639           88  CP-E-AS-TEXAS                       VALUE '4'.
  1640           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1641           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1642           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1643           88  CP-E-AS-MEAN                        VALUE '8'.
  1644           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1645         16  FILLER                PIC X(12).
  1646
  1647***************    OUTPUT FROM ELPMNT   *************************
  1648
  1649         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1650                                     COMP-3.
  1651         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1652                                     COMP-3.
  1653         16  FILLER                PIC X(12).
  1654
  1655***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  32
* EL156.cbl
  1656         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1657                                     COMP-3.
  1658         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1659                                     COMP-3.
  1660         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1661                                     COMP-3.
  1662         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1663                                     COMP-3.
  1664         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1665                                     COMP-3.
  1666         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1667                                     COMP-3.
  1668         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1669             88  OPEN-RATE-FILE                   VALUE 'O'.
  1670             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1671             88  IO-ERROR                         VALUE 'E'.
  1672
  1673         16  CP-FIRST-PAY-DATE     PIC XX.
  1674
  1675         16  CP-JOINT-INDICATOR    PIC X.
  1676
  1677         16  CP-RESERVE-REMAINING-TERM
  1678                                   PIC S9(4)V9    VALUE ZERO
  1679                                     COMP-3.
  1680
  1681         16  CP-INSURED-BIRTH-DT   PIC XX.
  1682
  1683         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1684                                     COMP-3.
  1685
  1686         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1687                                     COMP-3.
  1688
  1689         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1690                                     COMP-3.
  1691
  1692         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1693                                     COMP-3.
  1694
  1695         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1696                                     COMP-3.
  1697
  1698         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1699                                     COMP-3.
  1700
  1701         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1702                                     COMP-3.
  1703
  1704         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1705             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1706
  1707         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1708                                     COMP-3.
  1709         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1710                                     COMP-3.
  1711         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1712         16  FILLER                PIC X(15).
  1713******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  33
* EL156.cbl
  1714*    COPY ELCICALC.
  1715******************************************************************
  1716*                                                                *
  1717*                           ELCCICALC.                           *
  1718*                            VMOD=2.001                          *
  1719*                                                                *
  1720*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1721*                 CALCULATION MODULE                             *
  1722*                                                                *
  1723*  PASSED TO ELCLMI                                              *
  1724*  -----------------                                             *
  1725*  STATE                                                         *
  1726*  PRODUCT                                                       *
  1727*  COVERAGE                                                      *
  1728*  EFFECTIVE DATE                                                *
  1729*  INCURRED DATE                                                 *
  1730*  ESTABLISHED DATE                                              *
  1731*  LAST PAID DATE                                                *
  1732*  REPORTED DATE                                                 *
  1733*  CLAIM PAYMENT AMOUNT                                          *
  1734*                                                                *
  1735*  RETURNED FROM ELRTRM                                          *
  1736*  ---------------------                                         *
  1737*  RETURN CODE                                                   *
  1738*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1739*  CLAIM INTEREST AMOUNT                                         *
  1740*----------------------------------------------------------------*
  1741*----------------------------------------------------------------*
  1742*                 LENGTH = 100                                   *
  1743*                                                                *
  1744******************************************************************
  1745******************************************************************
  1746*                   C H A N G E   L O G
  1747*
  1748* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1749*-----------------------------------------------------------------
  1750*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1751* EFFECTIVE    NUMBER
  1752*-----------------------------------------------------------------
  1753* 120905    2004040700004  PEMA  NEW COPYBOOK
  1754* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1755******************************************************************
  1756
  1757 01  CLAIM-INT-PASS-AREA.
  1758     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1759                                     COMP.
  1760
  1761     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1762       88  NO-CI-ERROR                             VALUE ZERO.
  1763       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1764       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1765       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1766       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1767       88  CP-AMT-LT-5000                          VALUE '4'.
  1768       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1769       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1770       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1771       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  34
* EL156.cbl
  1772***********************  INPUT AREAS ****************************
  1773
  1774     12  CP-CALCULATION-AREA.
  1775         16  CP-COMPANY-CD         PIC X.
  1776         16  CP-STATE              PIC XX.
  1777         16  CP-PRODUCT            PIC XX.
  1778         16  CP-COVERAGE           PIC XX.
  1779         16  CP-INC-DT             PIC XX.
  1780         16  CP-EST-DT             PIC XX.
  1781         16  CP-LSTPD-DT           PIC XX.
  1782         16  CP-RPT-DT             PIC XX.
  1783         16  CP-PRF-DT             PIC XX.
  1784         16  CP-EFF-DT             PIC XX.
  1785         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1786         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1787         16  FILLER                PIC X(37).
  1788
  1789***************    OUTPUT FROM ELCLMI   ************************
  1790
  1791         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1792
  1793         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1794         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1795         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1796         16  FILLER                PIC X(19).
  1797******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  35
* EL156.cbl
  1799*    COPY ELCATTR.
  1800******************************************************************
  1801*                                                                *
  1802*                            ELCATTR.                            *
  1803*                            VMOD=2.001                          *
  1804*                                                                *
  1805*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1806*                                                                *
  1807*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1808*                                                                *
  1809*                   POS 1   P=PROTECTED                          *
  1810*                           U=UNPROTECTED                        *
  1811*                           S=ASKIP                              *
  1812*                   POS 2   A=ALPHA/NUMERIC                      *
  1813*                           N=NUMERIC                            *
  1814*                   POS 3   N=NORMAL                             *
  1815*                           B=BRIGHT                             *
  1816*                           D=DARK                               *
  1817*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1818*                           OF=MODIFIED DATA TAG OFF             *
  1819*                                                                *
  1820*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1821******************************************************************
  1822 01  ATTRIBUTE-LIST.
  1823     12  AL-PABOF            PIC X       VALUE 'Y'.
  1824     12  AL-PABON            PIC X       VALUE 'Z'.
  1825     12  AL-PADOF            PIC X       VALUE '%'.
  1826     12  AL-PADON            PIC X       VALUE '_'.
  1827     12  AL-PANOF            PIC X       VALUE '-'.
  1828     12  AL-PANON            PIC X       VALUE '/'.
  1829     12  AL-SABOF            PIC X       VALUE '8'.
  1830     12  AL-SABON            PIC X       VALUE '9'.
  1831     12  AL-SADOF            PIC X       VALUE '@'.
  1832     12  AL-SADON            PIC X       VALUE QUOTE.
  1833     12  AL-SANOF            PIC X       VALUE '0'.
  1834     12  AL-SANON            PIC X       VALUE '1'.
  1835     12  AL-UABOF            PIC X       VALUE 'H'.
  1836     12  AL-UABON            PIC X       VALUE 'I'.
  1837     12  AL-UADOF            PIC X       VALUE '<'.
  1838     12  AL-UADON            PIC X       VALUE '('.
  1839     12  AL-UANOF            PIC X       VALUE ' '.
  1840     12  AL-UANON            PIC X       VALUE 'A'.
  1841     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1842     12  AL-UNBON            PIC X       VALUE 'R'.
  1843     12  AL-UNDOF            PIC X       VALUE '*'.
  1844     12  AL-UNDON            PIC X       VALUE ')'.
  1845     12  AL-UNNOF            PIC X       VALUE '&'.
  1846     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  36
* EL156.cbl
  1848*    COPY ELCEMIB.
  1849******************************************************************
  1850*                                                                *
  1851*                                                                *
  1852*                            ELCEMIB.                            *
  1853*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1854*                            VMOD=2.005                          *
  1855*                                                                *
  1856*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1857*                                                                *
  1858******************************************************************
  1859 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1860     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1861     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1862     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1863     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1864     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1865     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1866     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1867     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1868     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1869         88  EMI-NO-ERRORS                    VALUE '1'.
  1870         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1871         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1872     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1873         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1874     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1875         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1876         88  EMI-AREA1-FULL                   VALUE '2'.
  1877     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1878         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1879         88  EMI-AREA2-FULL                   VALUE '2'.
  1880     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1881         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1882         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1883         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1884         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1885         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1886     12  EMI-ERROR-LINES.
  1887         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1888         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1889         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1890         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1891             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1892                 24  EMI-ERR-NUM         PIC X(4).
  1893                 24  EMI-FILLER          PIC X.
  1894                 24  EMI-SEV             PIC X.
  1895                 24  FILLER              PIC X.
  1896             20  FILLER                  PIC X(02).
  1897     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1898         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1899             20  EMI-ERROR-NUMBER    PIC X(4).
  1900             20  EMI-FILL            PIC X.
  1901             20  EMI-SEVERITY        PIC X.
  1902             20  FILLER              PIC X.
  1903             20  EMI-ERROR-TEXT.
  1904                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1905                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  37
* EL156.cbl
  1906     12  EMI-SEVERITY-SAVE           PIC X.
  1907         88  EMI-NOTE                    VALUE 'N'.
  1908         88  EMI-WARNING                 VALUE 'W'.
  1909         88  EMI-FORCABLE                VALUE 'F'.
  1910         88  EMI-FATAL                   VALUE 'X'.
  1911     12  EMI-MESSAGE-FLAG            PIC X.
  1912         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1913         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1914     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1915     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1916         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1917         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1918         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1919     12  emi-claim-no                pic x(7).
  1920     12  emi-claim-type              pic x(6).
  1921     12  FILLER                      PIC X(124)  VALUE SPACES.
  1922     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1923     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1924     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1925     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  38
* EL156.cbl
  1927*    COPY ELCLNKLT.
  1928******************************************************************
  1929*                                                                *
  1930*                                                                *
  1931*                           ELCLNKLT                             *
  1932*                            VMOD=2.003                          *
  1933*                                                                *
  1934*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1935*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1936*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1937*                                                                *
  1938*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1939*   COMPLETING THE REQUIRED FIELDS.                              *
  1940*                                                                *
  1941*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1942*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1943*                              9999 INDICATES AN UNKNOWN ABEND   *
  1944*                                   WAS DETECTED.                *
  1945*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1946*                              CODES FOUND IN THE ERROR FILE.    *
  1947******************************************************************
  1948 01  W-1523-LINKDATA.
  1949     12  W-1523-COMMON-PI-DATA.
  1950         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1951         16  FILLER              PIC  X(67).
  1952         16  W-1523-COMPANY-CD   PIC  X(01).
  1953         16  FILLER              PIC  X(10).
  1954         16  W-1523-CONTROL-IN-PROGRESS.
  1955             20  W-1523-CARRIER  PIC  X(01).
  1956             20  W-1523-GROUPING PIC  X(06).
  1957             20  W-1523-STATE    PIC  X(02).
  1958             20  W-1523-ACCOUNT  PIC  X(10).
  1959             20  W-1523-CLAIM-CERT-GRP.
  1960                 24  W-1523-CLAIM-NO
  1961                                 PIC  X(07).
  1962                 24  W-1523-CERT-NO.
  1963                     28  W-1523-CERT-PRIME
  1964                                 PIC  X(10).
  1965                     28  W-1523-CERT-SFX
  1966                                 PIC  X(01).
  1967                 24  W-1523-CERT-EFF-DT
  1968                                 PIC  X(02).
  1969         16  FILLER              PIC X(265).
  1970
  1971     12  W-1523-WORK-AREA.
  1972         16  W-1523-FORM-NUMBER  PIC  X(04).
  1973         16  W-1523-NUMBER-COPIES
  1974                                 PIC  9(01).
  1975         16  W-1523-ADDR-TYPE    PIC  X(02).
  1976         16  W-1523-FOLLOW-UP-DATE
  1977                                 PIC  X(02).
  1978         16  W-1523-RESEND-DATE  PIC  X(02).
  1979         16  W-1523-ERROR-CODE   PIC  9(04).
  1980             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1981             88  W-1523-FATAL-ERROR
  1982                                    VALUES  0006 0013 0042
  1983                                            0154 0168 0169
  1984                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  39
* EL156.cbl
  1985                                            0179 0186 0281
  1986                                            0332 2055 3697
  1987                                            3698 3699 3770
  1988                                            3771 3772 7675
  1989                                            9106 9808 9883
  1990                                            9887.
  1991             88  W-1523-STOP-ERRORS
  1992                                    VALUES  0013 0042 0154
  1993                                            0168 0169 0172
  1994                                            0281 0332 2055
  1995                                            3698 3699 7675
  1996                                            9106 9808 9883
  1997                                            9999.
  1998         16  W-1523-REASON       PIC  X(70).
  1999         16  W-1523-ARCHIVE-NUMBER
  2000                                 PIC  9(08).
  2001     12  W-1523-POINTER-AREA.
  2002         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2003         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2004         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2005         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2006         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  40
* EL156.cbl
  2008*    COPY ELCNWA.
  2009*****************************************************************
  2010*                                                               *
  2011*                                                               *
  2012*                            ELCNWA.                            *
  2013*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2014*                            VMOD=2.003                         *
  2015*                                                               *
  2016*            M O V E   N A M E   W O R K   A R E A.             *
  2017*                                                               *
  2018*****************************************************************.
  2019
  2020 01  WS-NAME-WORK-AREA.
  2021     05  WS-INSURED-LAST-NAME        PIC X(15).
  2022     05  WS-INSURED-1ST-NAME         PIC X(12).
  2023     05  WS-INSURED-MID-INIT         PIC X.
  2024
  2025     05  WS-NAME-WORK.
  2026         10  WS-NW                   PIC X
  2027             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2028
  2029     05  WS-NAME-WORK2.
  2030         10  WS-NW2                  PIC X
  2031             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2032                                        NWA-INDEX0.
  2033
  2034     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2035                                     COMP-3.
  2036
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  41
* EL156.cbl
  2038*    COPY ELCDMO.
  2039******************************************************************
  2040*                                                                *
  2041*                                                                *
  2042*                            ELCDMO.                             *
  2043*                            VMOD=2.004                          *
  2044*                                                                *
  2045*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2046*        COMMUNICATION AREA                                      *
  2047*   FILE TYPE = NA                                               *
  2048*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2049*                                                                *
  2050******************************************************************
  2051 01  DMO-COMMUNICATION-AREA.
  2052     12  DM-RECORD-TYPE                  PIC  X(02).
  2053             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2054             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2055             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2056     12  DM-DIST-CODE                    PIC  X(04).
  2057     12  DM-MAIL-CODE                    PIC  X(05).
  2058     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2059     12  DM-INSURED-NAME                 PIC  X(30).
  2060     12  DM-CLAIM-NO                     PIC  X(07).
  2061     12  DM-CLAIM-TYPE                   PIC  X.
  2062
  2063     12  DM-STATUS-DATA-AREA.
  2064         16  DM-CLAIM-STATUS             PIC  X.
  2065             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2066             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2067             88  DM-CLOSED                        VALUE '3'.
  2068             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2069             88  DM-DEFAULT                       VALUE '9'.
  2070         16  DM-STATUS-DATE              PIC  X(08).
  2071******YYYYMMDD
  2072         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2073             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2074             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2075             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2076             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2077             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2078             88  DM-RE-OPENED                     VALUE 'R'.
  2079             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2080             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2081             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2082         16  DM-STAT-CARRIER             PIC X.
  2083
  2084     12  DM-DRAFT-DATA-AREA.
  2085         16  DM-PAYMENT-TYPE             PIC  X.
  2086             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2087         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2088         16  DM-PAYMENT-DATE             PIC  X(08).
  2089******YYYYMMDD
  2090         16  DM-CERT-NO                  PIC  X(11).
  2091         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2092         16  DM-CARRIER                  PIC  X.
  2093
  2094     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  42
* EL156.cbl
  2096*    COPY ELCDMDCD.
  2097******************************************************************
  2098*                                                                *
  2099*                                                                *
  2100*                            ELCDMDCD.                           *
  2101*                            VMOD=2.001                          *
  2102*                                                                *
  2103*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2104*       COMMUNICATIONS AREA                                      *
  2105*                                                                *
  2106******************************************************************
  2107 01  CD-COMMUNICATION-AREA.
  2108     12  CD-SYSTEM-ID            PIC  X(02).
  2109         88 CD-CLAIMS                      VALUE 'CL'.
  2110         88 CD-CREDIT                      VALUE 'CR'.
  2111     12  CD-RECORD-TYPE          PIC  X(02).
  2112         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2113         88 CD-EOB-CODE                    VALUE 'EO'.
  2114         88 CD-ICD9-CODE                   VALUE 'I9'.
  2115         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2116         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2117         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2118         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2119         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2120     12  CD-RECORD-KEY           PIC  X(06).
  2121         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2122     12  CD-RETURN-CODE          PIC  X(02).
  2123     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2124     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2125     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2126     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  43
* EL156.cbl
  2128*    COPY ELCDCTB.
  2129******************************************************************
  2130*                                                                *
  2131*                                                                *
  2132*                            ELCDCTB.                            *
  2133*                            VMOD=2.002                          *
  2134*                                                                *
  2135*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2136*       COMMUNICATIONS AREA                                      *
  2137*                                                                *
  2138******************************************************************
  2139 01  DCT-COMMUNICATION-AREA.
  2140     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2141     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2142     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2143     12  DCT-PRODUCT-CODE         PIC  X(02).
  2144     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2145     12  DCT-RETURN-CODE          PIC  X(02).
  2146     12  DCT-MAIL-CODE            PIC  X(05).
  2147     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2148     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  44
* EL156.cbl
  2150 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2151 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2152 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2153 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  45
* EL156.cbl
  2155*    COPY ELCINTF.
  2156******************************************************************
  2157*                                                                *
  2158*                                                                *
  2159*                            ELCINTF.                            *
  2160*                            VMOD=2.017                          *
  2161*                                                                *
  2162*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2163*                                                                *
  2164*       LENGTH = 1024                                            *
  2165*                                                                *
  2166******************************************************************
  2167*                   C H A N G E   L O G
  2168*
  2169* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2170*-----------------------------------------------------------------
  2171*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2172* EFFECTIVE    NUMBER
  2173*-----------------------------------------------------------------
  2174* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2175******************************************************************
  2176 01  PROGRAM-INTERFACE-BLOCK.
  2177     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2178     12  PI-CALLING-PROGRAM              PIC X(8).
  2179     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2180     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2181     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2182     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2183     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2184     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2185     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2186     12  PI-COMPANY-ID                   PIC XXX.
  2187     12  PI-COMPANY-CD                   PIC X.
  2188
  2189     12  PI-COMPANY-PASSWORD             PIC X(8).
  2190
  2191     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2192
  2193     12  PI-CONTROL-IN-PROGRESS.
  2194         16  PI-CARRIER                  PIC X.
  2195         16  PI-GROUPING                 PIC X(6).
  2196         16  PI-STATE                    PIC XX.
  2197         16  PI-ACCOUNT                  PIC X(10).
  2198         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2199                                         PIC X(10).
  2200         16  PI-CLAIM-CERT-GRP.
  2201             20  PI-CLAIM-NO             PIC X(7).
  2202             20  PI-CERT-NO.
  2203                 25  PI-CERT-PRIME       PIC X(10).
  2204                 25  PI-CERT-SFX         PIC X.
  2205             20  PI-CERT-EFF-DT          PIC XX.
  2206         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2207             20  PI-PLAN-CODE            PIC X(2).
  2208             20  PI-REVISION-NUMBER      PIC X(3).
  2209             20  PI-PLAN-EFF-DT          PIC X(2).
  2210             20  PI-PLAN-EXP-DT          PIC X(2).
  2211             20  FILLER                  PIC X(11).
  2212         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  46
* EL156.cbl
  2213             20  PI-OE-REFERENCE-1.
  2214                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2215                 25  PI-OE-REF-1-SUFF    PIC XX.
  2216
  2217     12  PI-SESSION-IN-PROGRESS          PIC X.
  2218         88  CLAIM-SESSION                   VALUE '1'.
  2219         88  CREDIT-SESSION                  VALUE '2'.
  2220         88  WARRANTY-SESSION                VALUE '3'.
  2221         88  MORTGAGE-SESSION                VALUE '4'.
  2222         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2223
  2224
  2225*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2226
  2227     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2228     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2229
  2230     12  PI-CREDIT-USER                  PIC X.
  2231         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2232         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2233
  2234     12  PI-CLAIM-USER                   PIC X.
  2235         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2236         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2237
  2238     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2239         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2240         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2241         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2242         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2243         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2244
  2245     12  PI-PROCESSOR-ID                 PIC X(4).
  2246
  2247     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2248
  2249     12  PI-MEMBER-CAPTION               PIC X(10).
  2250
  2251     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2252         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2253
  2254     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2255     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2256     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2257     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2258
  2259     12  PI-AH-OVERRIDE-L1               PIC X.
  2260     12  PI-AH-OVERRIDE-L2               PIC XX.
  2261     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2262     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2263
  2264     12  PI-NEW-SYSTEM                   PIC X(2).
  2265
  2266     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2267     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2268         88  PI-USES-PAID-TO                 VALUE '1'.
  2269     12  PI-CRDTCRD-SYSTEM.
  2270         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  47
* EL156.cbl
  2271             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2272             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2273         16  PI-CC-MONTH-END-DT          PIC XX.
  2274     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2275
  2276     12  PI-OE-REFERENCE-2.
  2277         16  PI-OE-REF-2-PRIME           PIC X(10).
  2278         16  PI-OE-REF-2-SUFF            PIC X.
  2279
  2280     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2281
  2282     12  PI-LANGUAGE-TYPE                PIC X.
  2283             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2284             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2285             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2286
  2287     12  PI-POLICY-LINKAGE-IND           PIC X.
  2288         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2289         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2290                                                   LOW-VALUES.
  2291
  2292     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2293     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2294         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2295         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2296
  2297     12  PI-PROCESSOR-CSR-IND            PIC X.
  2298         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2299         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2300
  2301     12  FILLER                          PIC X(3).
  2302
  2303     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2304
  2305     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2306         PI-SYSTEM-LEVEL.
  2307
  2308         16  PI-ENTRY-CODES.
  2309             20  PI-ENTRY-CD-1           PIC X.
  2310             20  PI-ENTRY-CD-2           PIC X.
  2311
  2312         16  PI-RETURN-CODES.
  2313             20  PI-RETURN-CD-1          PIC X.
  2314             20  PI-RETURN-CD-2          PIC X.
  2315
  2316         16  PI-UPDATE-STATUS-SAVE.
  2317             20  PI-UPDATE-BY            PIC X(4).
  2318             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2319
  2320         16  PI-LOWER-CASE-LETTERS       PIC X.
  2321             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2322
  2323*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2324*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2325*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2326
  2327         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2328             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  48
* EL156.cbl
  2329             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2330             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2331             88  ACCNT-CNTL                  VALUE '3'.
  2332             88  CARR-ACCNT-CNTL             VALUE '4'.
  2333
  2334         16  PI-PROCESSOR-CAP-LIST.
  2335             20  PI-SYSTEM-CONTROLS.
  2336                24 PI-SYSTEM-DISPLAY     PIC X.
  2337                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2338                24 PI-SYSTEM-MODIFY      PIC X.
  2339                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2340             20  FILLER                  PIC XX.
  2341             20  PI-DISPLAY-CAP          PIC X.
  2342                 88  DISPLAY-CAP             VALUE 'Y'.
  2343             20  PI-MODIFY-CAP           PIC X.
  2344                 88  MODIFY-CAP              VALUE 'Y'.
  2345             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2346                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2347             20  PI-FORCE-CAP            PIC X.
  2348                 88  FORCE-CAP               VALUE 'Y'.
  2349
  2350         16  PI-PROGRAM-CONTROLS.
  2351             20  PI-PGM-PRINT-OPT        PIC X.
  2352             20  PI-PGM-FORMAT-OPT       PIC X.
  2353             20  PI-PGM-PROCESS-OPT      PIC X.
  2354             20  PI-PGM-TOTALS-OPT       PIC X.
  2355
  2356         16  PI-HELP-INTERFACE.
  2357             20  PI-LAST-ERROR-NO        PIC X(4).
  2358             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2359
  2360         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2361             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2362
  2363         16  PI-CR-CONTROL-IN-PROGRESS.
  2364             20  PI-CR-CARRIER           PIC X.
  2365             20  PI-CR-GROUPING          PIC X(6).
  2366             20  PI-CR-STATE             PIC XX.
  2367             20  PI-CR-ACCOUNT           PIC X(10).
  2368             20  PI-CR-FIN-RESP          PIC X(10).
  2369             20  PI-CR-TYPE              PIC X.
  2370
  2371         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2372
  2373         16  PI-CR-MONTH-END-DT          PIC XX.
  2374
  2375         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2376             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2377             88  PI-ZERO-CARRIER             VALUE '1'.
  2378             88  PI-ZERO-GROUPING            VALUE '2'.
  2379             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2380
  2381         16  PI-CARRIER-SECURITY         PIC X.
  2382             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2383
  2384         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2385             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2386             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  49
* EL156.cbl
  2387
  2388         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2389             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2390                                         INDEXED BY PI-ACCESS-NDX
  2391                                         PIC X.
  2392
  2393         16  PI-GA-BILLING-CONTROL       PIC X.
  2394             88  PI-GA-BILLING               VALUE '1'.
  2395
  2396         16  PI-MAIL-PROCESSING          PIC X.
  2397             88  PI-MAIL-YES                 VALUE 'Y'.
  2398
  2399         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2400
  2401         16  PI-AR-SYSTEM.
  2402             20  PI-AR-PROCESSING-CNTL   PIC X.
  2403                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2404             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2405             20  PI-AR-MONTH-END-DT      PIC XX.
  2406
  2407         16  PI-MP-SYSTEM.
  2408             20  PI-MORTGAGE-USER            PIC X.
  2409                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2410                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2411             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2412                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2413                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2414                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2415                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2416                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2417             20  PI-MP-MONTH-END-DT          PIC XX.
  2418             20  PI-MP-REFERENCE-NO.
  2419                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2420                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2421
  2422         16  PI-LABEL-CONTROL            PIC X(01).
  2423             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2424             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2425
  2426         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2427             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2428
  2429         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2430             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2431             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2432
  2433         16  FILLER                      PIC X(14).
  2434
  2435     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2436******************************************************************
  2437     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2438         16  PI-SAVE-FORM        PIC X(12).
  2439         16  PI-ACCT-KEY         PIC X(26).
  2440         16  PI-PAYEE-NAME       PIC X(30).
  2441         16  PI-DAILY-RATE       PIC S9(3)V99.
  2442         16  PI-MONTH-END-SAVE   PIC XX.
  2443         16  PI-BENEFIT-SAVE.
  2444             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  50
* EL156.cbl
  2445             20  PI-BEN-TYPE     PIC X.
  2446         16  PI-MANUAL-SW        PIC 9.
  2447         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2448         16  PI-PASS-SW          PIC X.
  2449         16  PI-PFKEY-USED       PIC X.
  2450         16  PI-CK-ASSIGN        PIC X.
  2451         16  PI-FATAL-COUNT      PIC 99.
  2452         16  PI-FORCE-COUNT      PIC 99.
  2453         16  PI-SAVE-INPUT.
  2454             20  PI-PMTTYPE      PIC X.
  2455             20  PI-PAYEE.
  2456                 24  PI-PAYEE-TYPE PIC X.
  2457                 24  PI-PAYEE-SEQ  PIC X.
  2458                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2459                   PI-PAYEE-SEQ    PIC S9.
  2460             20  PI-PMTNOTE1     PIC X(60).
  2461             20  PI-PMTNOTE2     PIC X(60).
  2462             20  PI-OFFLINE      PIC X.
  2463             20  PI-ECHECKNO     PIC X(7).
  2464             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2465                 28  PI-ECHECKNO-N     PIC X.
  2466                 28  PI-ECHECKNO-6     PIC X(6).
  2467             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2468                 24  PI-ECHECKNO-CR    PIC XX.
  2469                 24  PI-ECHECKNO-5     PIC X(5).
  2470             20  PI-HOLDTIL      PIC 9(6).
  2471             20  PI-EPYFROM      PIC 9(6).
  2472             20  PI-EPYTHRU      PIC 9(6).
  2473             20  PI-EDAYS        PIC S9(5).
  2474             20  PI-EPYAMT       PIC S9(7)V99.
  2475             20  PI-ERESV        PIC S9(7)V99.
  2476             20  PI-EEXPENS      PIC 9(6)V99.
  2477             20  PI-ETYPE        PIC X.
  2478             20  PI-CASH         PIC X.
  2479             20  PI-GROUPED      PIC X.
  2480             20  PI-INT-RATE     PIC S99V9(5).
  2481             20  PI-AIGFROM      PIC 9(6).
  2482             20  PI-LOAN-NO      PIC X(20).
  2483             20  PI-PROOF-DATE   PIC 9(6).
  2484             20  PI-PRINT-EOB-YN PIC X.
  2485             20  PI-PRINT-CLM-FRM-YN PIC X.
  2486             20  PI-PRINT-SURVEY-YN PIC X.
  2487             20  PI-SPECIAL-RELEASE-YN PIC X.
  2488         16  PI-SAVE-COMPUTED.
  2489             20  PI-CCHECKNO     PIC X(7).
  2490             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2491                 28  PI-CCHECKNO-N     PIC X.
  2492                 28  PI-CCHECKNO-6     PIC X(6).
  2493             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2494                 24  PI-CCHECKNO-CR    PIC XX.
  2495                 24  PI-CCHECKNO-5     PIC X(5).
  2496             20  PI-CPYFROM      PIC XX.
  2497             20  PI-CPYTHRU      PIC XX.
  2498             20  PI-CDAYS        PIC S9(5).
  2499             20  PI-CPYAMT       PIC S9(7)V99.
  2500             20  PI-CRESV        PIC 9(6)V99.
  2501             20  PI-CEXPENS      PIC 9(6)V99.
  2502             20  PI-PMT-APPR-SW  PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  51
* EL156.cbl
  2503                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2504                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2505                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2506         16  PI-PREV-CLMNO       PIC X(7).
  2507         16  PI-LF-COVERAGE-TYPE PIC X.
  2508         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2509         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2510         16  PI-PROVISIONAL-IND  PIC X.
  2511             88 PI-PROV-PMT      VALUE 'P'.
  2512         16  PI-PREV-TRLR-KEY    PIC X(22).
  2513         16  PI-SPLIT-PMT-SW     PIC X.
  2514         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2515         16  PI-ACTIVITY-CODE    PIC 99.
  2516         16  PI-RESET-SW         PIC X.
  2517         16  PI-SPECIAL-BEN-SW   PIC X.
  2518             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2519         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2520         16  PI-EXP-DT           PIC XX.
  2521         16  PI-LOAN-DUE-DAY     PIC 99.
  2522         16  PI-3RD-PARTY-SW     PIC X.
  2523         16  PI-LOAN-UPDATE-SW   PIC X.
  2524
  2525         16  PI-DMD-DATA.
  2526             20  PI-SV-CERT-KEY       PIC X(21).
  2527             20  PI-SV-CERT-NO        PIC X(11).
  2528             20  PI-SV-BEN            PIC X(10).
  2529             20  PI-SV-CCN            PIC X(16).
  2530             20  PI-INTEREST-PAID-IND PIC X.
  2531                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2532             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2533             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2534             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2535             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2536         16  PI-AT-EOB-CODES.
  2537             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2538         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2539         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2540         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2541         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2542         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2543         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2544         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2545         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2546         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2547         16  PI-LF-BENEFIT-CD         PIC X(2).
  2548         16  PI-EOB-CODES-EXIST PIC X.
  2549         16  PI-SET-NOTE2-MDT   PIC X.
  2550         16  PI-VFY-2ND-BENE          PIC X.
  2551         16  PI-CLM-TYPE              PIC X.
  2552         16  PI-APPROVAL-LEVEL        PIC X.
  2553         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2554         16  PI-REAUDIT-NEEDED        PIC X.
  2555         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2556         16  PI-AH-BENEFIT-CD         PIC XX.
  2557         16  pi-ah-term               pic s999 comp-3.
  2558         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2559         16  pi-max-ext               pic 999.
  2560         16  pi-max-ext-used          pic x.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  52
* EL156.cbl
  2561         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2562         16  PI-JOINT-COV-IND         PIC X.
  2563             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2564             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2565         16  PI-JOINT-INSURED-IND     PIC X.
  2566             88  PI-JOINT-INSURED        VALUE 'Y'.
  2567             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2568*00781          16  FILLER                   PIC X(176).
  2569*052506         16  FILLER                   PIC X(161).
  2570*031808         16  FILLER                   PIC X(154).
  2571*091808         16  FILLER                   PIC X(152).
  2572*041710         16  FILLER                   PIC X(94).
  2573         16  FILLER                   PIC X(67).
  2574
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  53
* EL156.cbl
  2576*    COPY ELCJPFX.
  2577******************************************************************
  2578*                                                                *
  2579*                                                                *
  2580*                            ELCJPFX.                            *
  2581*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2582*                            VMOD=2.002                          *
  2583*                                                                *
  2584*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2585*                                                                *
  2586*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2587*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2588*        ELCNTL - CONTROL FILE                                   *
  2589*        ELMSTR - CLAIM MASTERS                                  *
  2590*        ELTRLR - ACTIVITY TRAILERS                              *
  2591*        ELCHKQ - CHECK QUE                                      *
  2592******************************************************************
  2593 01  JOURNAL-RECORD.
  2594     12  jp-date                     pic s9(5) comp-3.
  2595     12  jp-time                     pic s9(7) comp-3.
  2596     12  JP-USER-ID                  PIC X(4).
  2597     12  JP-FILE-ID                  PIC X(8).
  2598     12  JP-PROGRAM-ID               PIC X(8).
  2599     12  JP-RECORD-TYPE              PIC X.
  2600         88 JP-ADD              VALUE 'A'.
  2601         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2602         88 JP-AFTER-CHANGE     VALUE 'C'.
  2603         88 JP-DELETE           VALUE 'D'.
  2604         88 JP-GENERIC-DELETE   VALUE 'G'.
  2605         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2606         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2607     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2608     12  JP-RECORD-AREA
  2609
  2610
  2611                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  54
* EL156.cbl
  2613*    COPY ELCAID.
  2614******************************************************************
  2615*                                                                *
  2616*                            ELCAID.                             *
  2617*                            VMOD=2.001                          *
  2618*                                                                *
  2619*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2620*                                                                *
  2621*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2622*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2623******************************************************************
  2624
  2625 01  DFHAID.
  2626   02  DFHNULL   PIC  X  VALUE  ' '.
  2627   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2628   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2629   02  DFHPEN    PIC  X  VALUE  '='.
  2630   02  DFHOPID   PIC  X  VALUE  'W'.
  2631   02  DFHPA1    PIC  X  VALUE  '%'.
  2632   02  DFHPA2    PIC  X  VALUE  '>'.
  2633   02  DFHPA3    PIC  X  VALUE  ','.
  2634   02  DFHPF1    PIC  X  VALUE  '1'.
  2635   02  DFHPF2    PIC  X  VALUE  '2'.
  2636   02  DFHPF3    PIC  X  VALUE  '3'.
  2637   02  DFHPF4    PIC  X  VALUE  '4'.
  2638   02  DFHPF5    PIC  X  VALUE  '5'.
  2639   02  DFHPF6    PIC  X  VALUE  '6'.
  2640   02  DFHPF7    PIC  X  VALUE  '7'.
  2641   02  DFHPF8    PIC  X  VALUE  '8'.
  2642   02  DFHPF9    PIC  X  VALUE  '9'.
  2643   02  DFHPF10   PIC  X  VALUE  ':'.
  2644   02  DFHPF11   PIC  X  VALUE  '#'.
  2645   02  DFHPF12   PIC  X  VALUE  '@'.
  2646   02  DFHPF13   PIC  X  VALUE  'A'.
  2647   02  DFHPF14   PIC  X  VALUE  'B'.
  2648   02  DFHPF15   PIC  X  VALUE  'C'.
  2649   02  DFHPF16   PIC  X  VALUE  'D'.
  2650   02  DFHPF17   PIC  X  VALUE  'E'.
  2651   02  DFHPF18   PIC  X  VALUE  'F'.
  2652   02  DFHPF19   PIC  X  VALUE  'G'.
  2653   02  DFHPF20   PIC  X  VALUE  'H'.
  2654   02  DFHPF21   PIC  X  VALUE  'I'.
  2655*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2656   02  DFHPF22   PIC  X  VALUE  '['.
  2657   02  DFHPF23   PIC  X  VALUE  '.'.
  2658   02  DFHPF24   PIC  X  VALUE  '<'.
  2659   02  DFHMSRE   PIC  X  VALUE  'X'.
  2660   02  DFHSTRF   PIC  X  VALUE  'h'.
  2661   02  DFHTRIG   PIC  X  VALUE  '"'.
  2662 01  FILLER    REDEFINES DFHAID.
  2663     12  FILLER              PIC X(8).
  2664     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  55
* EL156.cbl
  2666*    COPY EL156S.
  2667 01  EL156AI.
  2668     05  FILLER            PIC  X(0012).
  2669*    -------------------------------
  2670     05  RUNDTEAL PIC S9(0004) COMP.
  2671     05  RUNDTEAF PIC  X(0001).
  2672     05  FILLER REDEFINES RUNDTEAF.
  2673         10  RUNDTEAA PIC  X(0001).
  2674     05  RUNDTEAI PIC  X(0008).
  2675*    -------------------------------
  2676     05  RUNTIMAL PIC S9(0004) COMP.
  2677     05  RUNTIMAF PIC  X(0001).
  2678     05  FILLER REDEFINES RUNTIMAF.
  2679         10  RUNTIMAA PIC  X(0001).
  2680     05  RUNTIMAI PIC  X(0005).
  2681*    -------------------------------
  2682     05  SEQUL PIC S9(0004) COMP.
  2683     05  SEQUF PIC  X(0001).
  2684     05  FILLER REDEFINES SEQUF.
  2685         10  SEQUA PIC  X(0001).
  2686     05  SEQUI PIC  X(0010).
  2687*    -------------------------------
  2688     05  CLMNOL PIC S9(0004) COMP.
  2689     05  CLMNOF PIC  X(0001).
  2690     05  FILLER REDEFINES CLMNOF.
  2691         10  CLMNOA PIC  X(0001).
  2692     05  CLMNOI PIC  X(0007).
  2693*    -------------------------------
  2694     05  CARRL PIC S9(0004) COMP.
  2695     05  CARRF PIC  X(0001).
  2696     05  FILLER REDEFINES CARRF.
  2697         10  CARRA PIC  X(0001).
  2698     05  CARRI PIC  X(0001).
  2699*    -------------------------------
  2700     05  CERTNOL PIC S9(0004) COMP.
  2701     05  CERTNOF PIC  X(0001).
  2702     05  FILLER REDEFINES CERTNOF.
  2703         10  CERTNOA PIC  X(0001).
  2704     05  CERTNOI PIC  X(0010).
  2705*    -------------------------------
  2706     05  SUFXL PIC S9(0004) COMP.
  2707     05  SUFXF PIC  X(0001).
  2708     05  FILLER REDEFINES SUFXF.
  2709         10  SUFXA PIC  X(0001).
  2710     05  SUFXI PIC  X(0001).
  2711*    -------------------------------
  2712     05  CLMTYPL PIC S9(0004) COMP.
  2713     05  CLMTYPF PIC  X(0001).
  2714     05  FILLER REDEFINES CLMTYPF.
  2715         10  CLMTYPA PIC  X(0001).
  2716     05  CLMTYPI PIC  X(0006).
  2717*    -------------------------------
  2718     05  CLMSTATL PIC S9(0004) COMP.
  2719     05  CLMSTATF PIC  X(0001).
  2720     05  FILLER REDEFINES CLMSTATF.
  2721         10  CLMSTATA PIC  X(0001).
  2722     05  CLMSTATI PIC  X(0006).
  2723*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  56
* EL156.cbl
  2724     05  LSTNMEL PIC S9(0004) COMP.
  2725     05  LSTNMEF PIC  X(0001).
  2726     05  FILLER REDEFINES LSTNMEF.
  2727         10  LSTNMEA PIC  X(0001).
  2728     05  LSTNMEI PIC  X(0015).
  2729*    -------------------------------
  2730     05  FSTNMEL PIC S9(0004) COMP.
  2731     05  FSTNMEF PIC  X(0001).
  2732     05  FILLER REDEFINES FSTNMEF.
  2733         10  FSTNMEA PIC  X(0001).
  2734     05  FSTNMEI PIC  X(0012).
  2735*    -------------------------------
  2736     05  MINITL PIC S9(0004) COMP.
  2737     05  MINITF PIC  X(0001).
  2738     05  FILLER REDEFINES MINITF.
  2739         10  MINITA PIC  X(0001).
  2740     05  MINITI PIC  X(0001).
  2741*    -------------------------------
  2742     05  PRIMHDGL PIC S9(0004) COMP.
  2743     05  PRIMHDGF PIC  X(0001).
  2744     05  FILLER REDEFINES PRIMHDGF.
  2745         10  PRIMHDGA PIC  X(0001).
  2746     05  PRIMHDGI PIC  X(0012).
  2747*    -------------------------------
  2748     05  PCERTNOL PIC S9(0004) COMP.
  2749     05  PCERTNOF PIC  X(0001).
  2750     05  FILLER REDEFINES PCERTNOF.
  2751         10  PCERTNOA PIC  X(0001).
  2752     05  PCERTNOI PIC  X(0010).
  2753*    -------------------------------
  2754     05  PSUFXL PIC S9(0004) COMP.
  2755     05  PSUFXF PIC  X(0001).
  2756     05  FILLER REDEFINES PSUFXF.
  2757         10  PSUFXA PIC  X(0001).
  2758     05  PSUFXI PIC  X(0001).
  2759*    -------------------------------
  2760     05  STATUSL PIC S9(0004) COMP.
  2761     05  STATUSF PIC  X(0001).
  2762     05  FILLER REDEFINES STATUSF.
  2763         10  STATUSA PIC  X(0001).
  2764     05  STATUSI PIC  X(0010).
  2765*    -------------------------------
  2766     05  LOANHL PIC S9(0004) COMP.
  2767     05  LOANHF PIC  X(0001).
  2768     05  FILLER REDEFINES LOANHF.
  2769         10  LOANHA PIC  X(0001).
  2770     05  LOANHI PIC  X(0014).
  2771*    -------------------------------
  2772     05  LOANNOL PIC S9(0004) COMP.
  2773     05  LOANNOF PIC  X(0001).
  2774     05  FILLER REDEFINES LOANNOF.
  2775         10  LOANNOA PIC  X(0001).
  2776     05  LOANNOI PIC  X(0025).
  2777*    -------------------------------
  2778     05  DUEDAYHL PIC S9(0004) COMP.
  2779     05  DUEDAYHF PIC  X(0001).
  2780     05  FILLER REDEFINES DUEDAYHF.
  2781         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  57
* EL156.cbl
  2782     05  DUEDAYHI PIC  X(0008).
  2783*    -------------------------------
  2784     05  DUEDAYL PIC S9(0004) COMP.
  2785     05  DUEDAYF PIC  X(0001).
  2786     05  FILLER REDEFINES DUEDAYF.
  2787         10  DUEDAYA PIC  X(0001).
  2788     05  DUEDAYI PIC  X(0002).
  2789*    -------------------------------
  2790     05  ZINTHL PIC S9(0004) COMP.
  2791     05  ZINTHF PIC  X(0001).
  2792     05  FILLER REDEFINES ZINTHF.
  2793         10  ZINTHA PIC  X(0001).
  2794     05  ZINTHI PIC  X(0009).
  2795*    -------------------------------
  2796     05  ZINTL PIC S9(0004) COMP.
  2797     05  ZINTF PIC  X(0001).
  2798     05  FILLER REDEFINES ZINTF.
  2799         10  ZINTA PIC  X(0001).
  2800     05  ZINTI PIC  99V99999.
  2801*    -------------------------------
  2802     05  PTHRHDGL PIC S9(0004) COMP.
  2803     05  PTHRHDGF PIC  X(0001).
  2804     05  FILLER REDEFINES PTHRHDGF.
  2805         10  PTHRHDGA PIC  X(0001).
  2806     05  PTHRHDGI PIC  X(0014).
  2807*    -------------------------------
  2808     05  PDTHRUL PIC S9(0004) COMP.
  2809     05  PDTHRUF PIC  X(0001).
  2810     05  FILLER REDEFINES PDTHRUF.
  2811         10  PDTHRUA PIC  X(0001).
  2812     05  PDTHRUI PIC  X(0008).
  2813*    -------------------------------
  2814     05  TOTPAIDL PIC S9(0004) COMP.
  2815     05  TOTPAIDF PIC  X(0001).
  2816     05  FILLER REDEFINES TOTPAIDF.
  2817         10  TOTPAIDA PIC  X(0001).
  2818     05  TOTPAIDI PIC  X(0010).
  2819*    -------------------------------
  2820     05  COVERL PIC S9(0004) COMP.
  2821     05  COVERF PIC  X(0001).
  2822     05  FILLER REDEFINES COVERF.
  2823         10  COVERA PIC  X(0001).
  2824     05  COVERI PIC  X(0010).
  2825*    -------------------------------
  2826     05  INCURL PIC S9(0004) COMP.
  2827     05  INCURF PIC  X(0001).
  2828     05  FILLER REDEFINES INCURF.
  2829         10  INCURA PIC  X(0001).
  2830     05  INCURI PIC  X(0008).
  2831*    -------------------------------
  2832     05  LSTDTEL PIC S9(0004) COMP.
  2833     05  LSTDTEF PIC  X(0001).
  2834     05  FILLER REDEFINES LSTDTEF.
  2835         10  LSTDTEA PIC  X(0001).
  2836     05  LSTDTEI PIC  X(0008).
  2837*    -------------------------------
  2838     05  CRTSTATL PIC S9(0004) COMP.
  2839     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  58
* EL156.cbl
  2840     05  FILLER REDEFINES CRTSTATF.
  2841         10  CRTSTATA PIC  X(0001).
  2842     05  CRTSTATI PIC  X(0010).
  2843*    -------------------------------
  2844     05  EFFECTL PIC S9(0004) COMP.
  2845     05  EFFECTF PIC  X(0001).
  2846     05  FILLER REDEFINES EFFECTF.
  2847         10  EFFECTA PIC  X(0001).
  2848     05  EFFECTI PIC  X(0008).
  2849*    -------------------------------
  2850     05  TERMSL PIC S9(0004) COMP.
  2851     05  TERMSF PIC  X(0001).
  2852     05  FILLER REDEFINES TERMSF.
  2853         10  TERMSA PIC  X(0001).
  2854     05  TERMSI PIC  X(0011).
  2855*    -------------------------------
  2856     05  STACCTL PIC S9(0004) COMP.
  2857     05  STACCTF PIC  X(0001).
  2858     05  FILLER REDEFINES STACCTF.
  2859         10  STACCTA PIC  X(0001).
  2860     05  STACCTI PIC  X(0013).
  2861*    -------------------------------
  2862     05  EXPDTEHL PIC S9(0004) COMP.
  2863     05  EXPDTEHF PIC  X(0001).
  2864     05  FILLER REDEFINES EXPDTEHF.
  2865         10  EXPDTEHA PIC  X(0001).
  2866     05  EXPDTEHI PIC  X(0014).
  2867*    -------------------------------
  2868     05  EXPDTEL PIC S9(0004) COMP.
  2869     05  EXPDTEF PIC  X(0001).
  2870     05  FILLER REDEFINES EXPDTEF.
  2871         10  EXPDTEA PIC  X(0001).
  2872     05  EXPDTEI PIC  X(0008).
  2873*    -------------------------------
  2874     05  BENECAPL PIC S9(0004) COMP.
  2875     05  BENECAPF PIC  X(0001).
  2876     05  FILLER REDEFINES BENECAPF.
  2877         10  BENECAPA PIC  X(0001).
  2878     05  BENECAPI PIC  X(0013).
  2879*    -------------------------------
  2880     05  BENEL PIC S9(0004) COMP.
  2881     05  BENEF PIC  X(0001).
  2882     05  FILLER REDEFINES BENEF.
  2883         10  BENEA PIC  X(0001).
  2884     05  BENEI PIC  X(0009).
  2885*    -------------------------------
  2886     05  FORMTYPL PIC S9(0004) COMP.
  2887     05  FORMTYPF PIC  X(0001).
  2888     05  FILLER REDEFINES FORMTYPF.
  2889         10  FORMTYPA PIC  X(0001).
  2890     05  FORMTYPI PIC  X(0001).
  2891*    -------------------------------
  2892     05  PMTTYPEL PIC S9(0004) COMP.
  2893     05  PMTTYPEF PIC  X(0001).
  2894     05  FILLER REDEFINES PMTTYPEF.
  2895         10  PMTTYPEA PIC  X(0001).
  2896     05  PMTTYPEI PIC  X(0001).
  2897*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  59
* EL156.cbl
  2898     05  PAYEEL PIC S9(0004) COMP.
  2899     05  PAYEEF PIC  X(0001).
  2900     05  FILLER REDEFINES PAYEEF.
  2901         10  PAYEEA PIC  X(0001).
  2902     05  PAYEEI PIC  X(0002).
  2903*    -------------------------------
  2904     05  CHECKNOL PIC S9(0004) COMP.
  2905     05  CHECKNOF PIC  X(0001).
  2906     05  FILLER REDEFINES CHECKNOF.
  2907         10  CHECKNOA PIC  X(0001).
  2908     05  CHECKNOI PIC  X(0007).
  2909*    -------------------------------
  2910     05  OFFLINEL PIC S9(0004) COMP.
  2911     05  OFFLINEF PIC  X(0001).
  2912     05  FILLER REDEFINES OFFLINEF.
  2913         10  OFFLINEA PIC  X(0001).
  2914     05  OFFLINEI PIC  X(0001).
  2915*    -------------------------------
  2916     05  HOLDTILL PIC S9(0004) COMP.
  2917     05  HOLDTILF PIC  X(0001).
  2918     05  FILLER REDEFINES HOLDTILF.
  2919         10  HOLDTILA PIC  X(0001).
  2920     05  HOLDTILI PIC  X(0008).
  2921*    -------------------------------
  2922     05  NOTE1L PIC S9(0004) COMP.
  2923     05  NOTE1F PIC  X(0001).
  2924     05  FILLER REDEFINES NOTE1F.
  2925         10  NOTE1A PIC  X(0001).
  2926     05  NOTE1I PIC  X(0060).
  2927*    -------------------------------
  2928     05  NOTE2L PIC S9(0004) COMP.
  2929     05  NOTE2F PIC  X(0001).
  2930     05  FILLER REDEFINES NOTE2F.
  2931         10  NOTE2A PIC  X(0001).
  2932     05  NOTE2I PIC  X(0060).
  2933*    -------------------------------
  2934     05  EOBYNL PIC S9(0004) COMP.
  2935     05  EOBYNF PIC  X(0001).
  2936     05  FILLER REDEFINES EOBYNF.
  2937         10  EOBYNA PIC  X(0001).
  2938     05  EOBYNI PIC  X(0001).
  2939*    -------------------------------
  2940     05  CLMFMYNL PIC S9(0004) COMP.
  2941     05  CLMFMYNF PIC  X(0001).
  2942     05  FILLER REDEFINES CLMFMYNF.
  2943         10  CLMFMYNA PIC  X(0001).
  2944     05  CLMFMYNI PIC  X(0001).
  2945*    -------------------------------
  2946     05  SURVYYNL PIC S9(0004) COMP.
  2947     05  SURVYYNF PIC  X(0001).
  2948     05  FILLER REDEFINES SURVYYNF.
  2949         10  SURVYYNA PIC  X(0001).
  2950     05  SURVYYNI PIC  X(0001).
  2951*    -------------------------------
  2952     05  SPRELYNL PIC S9(0004) COMP.
  2953     05  SPRELYNF PIC  X(0001).
  2954     05  FILLER REDEFINES SPRELYNF.
  2955         10  SPRELYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  60
* EL156.cbl
  2956     05  SPRELYNI PIC  X(0001).
  2957*    -------------------------------
  2958     05  PINTHL PIC S9(0004) COMP.
  2959     05  PINTHF PIC  X(0001).
  2960     05  FILLER REDEFINES PINTHF.
  2961         10  PINTHA PIC  X(0001).
  2962     05  PINTHI PIC  X(0004).
  2963*    -------------------------------
  2964     05  PINTL PIC S9(0004) COMP.
  2965     05  PINTF PIC  X(0001).
  2966     05  FILLER REDEFINES PINTF.
  2967         10  PINTA PIC  X(0001).
  2968     05  PINTI PIC  X(0008).
  2969*    -------------------------------
  2970     05  PROOFDTL PIC S9(0004) COMP.
  2971     05  PROOFDTF PIC  X(0001).
  2972     05  FILLER REDEFINES PROOFDTF.
  2973         10  PROOFDTA PIC  X(0001).
  2974     05  PROOFDTI PIC  X(0008).
  2975*    -------------------------------
  2976     05  AIGFRMHL PIC S9(0004) COMP.
  2977     05  AIGFRMHF PIC  X(0001).
  2978     05  FILLER REDEFINES AIGFRMHF.
  2979         10  AIGFRMHA PIC  X(0001).
  2980     05  AIGFRMHI PIC  X(0012).
  2981*    -------------------------------
  2982     05  AIGFROML PIC S9(0004) COMP.
  2983     05  AIGFROMF PIC  X(0001).
  2984     05  FILLER REDEFINES AIGFROMF.
  2985         10  AIGFROMA PIC  X(0001).
  2986     05  AIGFROMI PIC  X(0008).
  2987*    -------------------------------
  2988     05  PMTHDGAL PIC S9(0004) COMP.
  2989     05  PMTHDGAF PIC  X(0001).
  2990     05  FILLER REDEFINES PMTHDGAF.
  2991         10  PMTHDGAA PIC  X(0001).
  2992     05  PMTHDGAI PIC  X(0066).
  2993*    -------------------------------
  2994     05  EPYFROML PIC S9(0004) COMP.
  2995     05  EPYFROMF PIC  X(0001).
  2996     05  FILLER REDEFINES EPYFROMF.
  2997         10  EPYFROMA PIC  X(0001).
  2998     05  EPYFROMI PIC  X(0008).
  2999*    -------------------------------
  3000     05  EPYTHRUL PIC S9(0004) COMP.
  3001     05  EPYTHRUF PIC  X(0001).
  3002     05  FILLER REDEFINES EPYTHRUF.
  3003         10  EPYTHRUA PIC  X(0001).
  3004     05  EPYTHRUI PIC  X(0008).
  3005*    -------------------------------
  3006     05  EDAYSL PIC S9(0004) COMP.
  3007     05  EDAYSF PIC  X(0001).
  3008     05  FILLER REDEFINES EDAYSF.
  3009         10  EDAYSA PIC  X(0001).
  3010     05  EDAYSI PIC  S9(6).
  3011*    -------------------------------
  3012     05  EPYAMTL PIC S9(0004) COMP.
  3013     05  EPYAMTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  61
* EL156.cbl
  3014     05  FILLER REDEFINES EPYAMTF.
  3015         10  EPYAMTA PIC  X(0001).
  3016     05  EPYAMTI PIC  S9(8)V99.
  3017*    -------------------------------
  3018     05  ERESVL PIC S9(0004) COMP.
  3019     05  ERESVF PIC  X(0001).
  3020     05  FILLER REDEFINES ERESVF.
  3021         10  ERESVA PIC  X(0001).
  3022     05  ERESVI PIC  S9(7)V99.
  3023*    -------------------------------
  3024     05  ETYPEL PIC S9(0004) COMP.
  3025     05  ETYPEF PIC  X(0001).
  3026     05  FILLER REDEFINES ETYPEF.
  3027         10  ETYPEA PIC  X(0001).
  3028     05  ETYPEI PIC  X(0001).
  3029*    -------------------------------
  3030     05  EEXPENSL PIC S9(0004) COMP.
  3031     05  EEXPENSF PIC  X(0001).
  3032     05  FILLER REDEFINES EEXPENSF.
  3033         10  EEXPENSA PIC  X(0001).
  3034     05  EEXPENSI PIC  9(6)V99.
  3035*    -------------------------------
  3036     05  CPYFROML PIC S9(0004) COMP.
  3037     05  CPYFROMF PIC  X(0001).
  3038     05  FILLER REDEFINES CPYFROMF.
  3039         10  CPYFROMA PIC  X(0001).
  3040     05  CPYFROMI PIC  X(0008).
  3041*    -------------------------------
  3042     05  CPYTHRUL PIC S9(0004) COMP.
  3043     05  CPYTHRUF PIC  X(0001).
  3044     05  FILLER REDEFINES CPYTHRUF.
  3045         10  CPYTHRUA PIC  X(0001).
  3046     05  CPYTHRUI PIC  X(0008).
  3047*    -------------------------------
  3048     05  CDAYSL PIC S9(0004) COMP.
  3049     05  CDAYSF PIC  X(0001).
  3050     05  FILLER REDEFINES CDAYSF.
  3051         10  CDAYSA PIC  X(0001).
  3052     05  CDAYSI PIC  9(6).
  3053*    -------------------------------
  3054     05  CPYAMTL PIC S9(0004) COMP.
  3055     05  CPYAMTF PIC  X(0001).
  3056     05  FILLER REDEFINES CPYAMTF.
  3057         10  CPYAMTA PIC  X(0001).
  3058     05  CPYAMTI PIC  S9(8)V99.
  3059*    -------------------------------
  3060     05  CRESVL PIC S9(0004) COMP.
  3061     05  CRESVF PIC  X(0001).
  3062     05  FILLER REDEFINES CRESVF.
  3063         10  CRESVA PIC  X(0001).
  3064     05  CRESVI PIC  9(6)V99.
  3065*    -------------------------------
  3066     05  CEXPENSL PIC S9(0004) COMP.
  3067     05  CEXPENSF PIC  X(0001).
  3068     05  FILLER REDEFINES CEXPENSF.
  3069         10  CEXPENSA PIC  X(0001).
  3070     05  CEXPENSI PIC  9(6)V99.
  3071*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  62
* EL156.cbl
  3072     05  ERRMSG0L PIC S9(0004) COMP.
  3073     05  ERRMSG0F PIC  X(0001).
  3074     05  FILLER REDEFINES ERRMSG0F.
  3075         10  ERRMSG0A PIC  X(0001).
  3076     05  ERRMSG0I PIC  X(0072).
  3077*    -------------------------------
  3078     05  ERRMSG1L PIC S9(0004) COMP.
  3079     05  ERRMSG1F PIC  X(0001).
  3080     05  FILLER REDEFINES ERRMSG1F.
  3081         10  ERRMSG1A PIC  X(0001).
  3082     05  ERRMSG1I PIC  X(0072).
  3083*    -------------------------------
  3084     05  ERRMSG2L PIC S9(0004) COMP.
  3085     05  ERRMSG2F PIC  X(0001).
  3086     05  FILLER REDEFINES ERRMSG2F.
  3087         10  ERRMSG2A PIC  X(0001).
  3088     05  ERRMSG2I PIC  X(0072).
  3089*    -------------------------------
  3090     05  ENTERPFL PIC S9(0004) COMP.
  3091     05  ENTERPFF PIC  X(0001).
  3092     05  FILLER REDEFINES ENTERPFF.
  3093         10  ENTERPFA PIC  X(0001).
  3094     05  ENTERPFI PIC  99.
  3095*    -------------------------------
  3096     05  PF6TITL PIC S9(0004) COMP.
  3097     05  PF6TITF PIC  X(0001).
  3098     05  FILLER REDEFINES PF6TITF.
  3099         10  PF6TITA PIC  X(0001).
  3100     05  PF6TITI PIC  X(0016).
  3101 01  EL156AO REDEFINES EL156AI.
  3102     05  FILLER            PIC  X(0012).
  3103*    -------------------------------
  3104     05  FILLER            PIC  X(0003).
  3105     05  RUNDTEAO PIC  X(0008).
  3106*    -------------------------------
  3107     05  FILLER            PIC  X(0003).
  3108     05  RUNTIMAO PIC  99.99.
  3109*    -------------------------------
  3110     05  FILLER            PIC  X(0003).
  3111     05  SEQUO PIC  X(0010).
  3112*    -------------------------------
  3113     05  FILLER            PIC  X(0003).
  3114     05  CLMNOO PIC  X(0007).
  3115*    -------------------------------
  3116     05  FILLER            PIC  X(0003).
  3117     05  CARRO PIC  X(0001).
  3118*    -------------------------------
  3119     05  FILLER            PIC  X(0003).
  3120     05  CERTNOO PIC  X(0010).
  3121*    -------------------------------
  3122     05  FILLER            PIC  X(0003).
  3123     05  SUFXO PIC  X(0001).
  3124*    -------------------------------
  3125     05  FILLER            PIC  X(0003).
  3126     05  CLMTYPO PIC  X(0006).
  3127*    -------------------------------
  3128     05  FILLER            PIC  X(0003).
  3129     05  CLMSTATO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  63
* EL156.cbl
  3130*    -------------------------------
  3131     05  FILLER            PIC  X(0003).
  3132     05  LSTNMEO PIC  X(0015).
  3133*    -------------------------------
  3134     05  FILLER            PIC  X(0003).
  3135     05  FSTNMEO PIC  X(0012).
  3136*    -------------------------------
  3137     05  FILLER            PIC  X(0003).
  3138     05  MINITO PIC  X(0001).
  3139*    -------------------------------
  3140     05  FILLER            PIC  X(0003).
  3141     05  PRIMHDGO PIC  X(0012).
  3142*    -------------------------------
  3143     05  FILLER            PIC  X(0003).
  3144     05  PCERTNOO PIC  X(0010).
  3145*    -------------------------------
  3146     05  FILLER            PIC  X(0003).
  3147     05  PSUFXO PIC  X(0001).
  3148*    -------------------------------
  3149     05  FILLER            PIC  X(0003).
  3150     05  STATUSO PIC  X(0010).
  3151*    -------------------------------
  3152     05  FILLER            PIC  X(0003).
  3153     05  LOANHO PIC  X(0014).
  3154*    -------------------------------
  3155     05  FILLER            PIC  X(0003).
  3156     05  LOANNOO PIC  X(0025).
  3157*    -------------------------------
  3158     05  FILLER            PIC  X(0003).
  3159     05  DUEDAYHO PIC  X(0008).
  3160*    -------------------------------
  3161     05  FILLER            PIC  X(0003).
  3162     05  DUEDAYO PIC  X(0002).
  3163*    -------------------------------
  3164     05  FILLER            PIC  X(0003).
  3165     05  ZINTHO PIC  X(0009).
  3166*    -------------------------------
  3167     05  FILLER            PIC  X(0003).
  3168     05  ZINTO PIC  9.99999.
  3169*    -------------------------------
  3170     05  FILLER            PIC  X(0003).
  3171     05  PTHRHDGO PIC  X(0014).
  3172*    -------------------------------
  3173     05  FILLER            PIC  X(0003).
  3174     05  PDTHRUO PIC  X(0008).
  3175*    -------------------------------
  3176     05  FILLER            PIC  X(0003).
  3177     05  TOTPAIDO PIC  Z(6).99-.
  3178*    -------------------------------
  3179     05  FILLER            PIC  X(0003).
  3180     05  COVERO PIC  X(0010).
  3181*    -------------------------------
  3182     05  FILLER            PIC  X(0003).
  3183     05  INCURO PIC  X(0008).
  3184*    -------------------------------
  3185     05  FILLER            PIC  X(0003).
  3186     05  LSTDTEO PIC  X(0008).
  3187*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  64
* EL156.cbl
  3188     05  FILLER            PIC  X(0003).
  3189     05  CRTSTATO PIC  X(0010).
  3190*    -------------------------------
  3191     05  FILLER            PIC  X(0003).
  3192     05  EFFECTO PIC  X(0008).
  3193*    -------------------------------
  3194     05  FILLER            PIC  X(0003).
  3195     05  TERMSO PIC  X(0011).
  3196*    -------------------------------
  3197     05  FILLER            PIC  X(0003).
  3198     05  STACCTO PIC  X(0013).
  3199*    -------------------------------
  3200     05  FILLER            PIC  X(0003).
  3201     05  EXPDTEHO PIC  X(0014).
  3202*    -------------------------------
  3203     05  FILLER            PIC  X(0003).
  3204     05  EXPDTEO PIC  X(0008).
  3205*    -------------------------------
  3206     05  FILLER            PIC  X(0003).
  3207     05  BENECAPO PIC  X(0013).
  3208*    -------------------------------
  3209     05  FILLER            PIC  X(0003).
  3210     05  BENEO PIC  Z(6).99.
  3211*    -------------------------------
  3212     05  FILLER            PIC  X(0003).
  3213     05  FORMTYPO PIC  X(0001).
  3214*    -------------------------------
  3215     05  FILLER            PIC  X(0003).
  3216     05  PMTTYPEO PIC  X(0001).
  3217*    -------------------------------
  3218     05  FILLER            PIC  X(0003).
  3219     05  PAYEEO PIC  X(0002).
  3220*    -------------------------------
  3221     05  FILLER            PIC  X(0003).
  3222     05  CHECKNOO PIC  X(0007).
  3223*    -------------------------------
  3224     05  FILLER            PIC  X(0003).
  3225     05  OFFLINEO PIC  X(0001).
  3226*    -------------------------------
  3227     05  FILLER            PIC  X(0003).
  3228     05  HOLDTILO PIC  99B99B99.
  3229*    -------------------------------
  3230     05  FILLER            PIC  X(0003).
  3231     05  NOTE1O PIC  X(0060).
  3232*    -------------------------------
  3233     05  FILLER            PIC  X(0003).
  3234     05  NOTE2O PIC  X(0060).
  3235*    -------------------------------
  3236     05  FILLER            PIC  X(0003).
  3237     05  EOBYNO PIC  X(0001).
  3238*    -------------------------------
  3239     05  FILLER            PIC  X(0003).
  3240     05  CLMFMYNO PIC  X(0001).
  3241*    -------------------------------
  3242     05  FILLER            PIC  X(0003).
  3243     05  SURVYYNO PIC  X(0001).
  3244*    -------------------------------
  3245     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  65
* EL156.cbl
  3246     05  SPRELYNO PIC  X(0001).
  3247*    -------------------------------
  3248     05  FILLER            PIC  X(0003).
  3249     05  PINTHO PIC  X(0004).
  3250*    -------------------------------
  3251     05  FILLER            PIC  X(0003).
  3252     05  PINTO PIC  Z,ZZ9.99.
  3253*    -------------------------------
  3254     05  FILLER            PIC  X(0003).
  3255     05  PROOFDTO PIC  99B99B99.
  3256*    -------------------------------
  3257     05  FILLER            PIC  X(0003).
  3258     05  AIGFRMHO PIC  X(0012).
  3259*    -------------------------------
  3260     05  FILLER            PIC  X(0003).
  3261     05  AIGFROMO PIC  99B99B99.
  3262*    -------------------------------
  3263     05  FILLER            PIC  X(0003).
  3264     05  PMTHDGAO PIC  X(0066).
  3265*    -------------------------------
  3266     05  FILLER            PIC  X(0003).
  3267     05  EPYFROMO PIC  99B99B99.
  3268*    -------------------------------
  3269     05  FILLER            PIC  X(0003).
  3270     05  EPYTHRUO PIC  99B99B99.
  3271*    -------------------------------
  3272     05  FILLER            PIC  X(0003).
  3273     05  EDAYSO PIC  Z(4)9-.
  3274*    -------------------------------
  3275     05  FILLER            PIC  X(0003).
  3276     05  EPYAMTO PIC  Z(6).99-.
  3277*    -------------------------------
  3278     05  FILLER            PIC  X(0003).
  3279     05  ERESVO PIC  Z(5).99-.
  3280*    -------------------------------
  3281     05  FILLER            PIC  X(0003).
  3282     05  ETYPEO PIC  X(0001).
  3283*    -------------------------------
  3284     05  FILLER            PIC  X(0003).
  3285     05  EEXPENSO PIC  Z(5).99.
  3286*    -------------------------------
  3287     05  FILLER            PIC  X(0003).
  3288     05  CPYFROMO PIC  99B99B99.
  3289*    -------------------------------
  3290     05  FILLER            PIC  X(0003).
  3291     05  CPYTHRUO PIC  99B99B99.
  3292*    -------------------------------
  3293     05  FILLER            PIC  X(0003).
  3294     05  CDAYSO PIC  Z(4)9-.
  3295*    -------------------------------
  3296     05  FILLER            PIC  X(0003).
  3297     05  CPYAMTO PIC  Z(6).99-.
  3298*    -------------------------------
  3299     05  FILLER            PIC  X(0003).
  3300     05  CRESVO PIC  Z(5).99.
  3301*    -------------------------------
  3302     05  FILLER            PIC  X(0003).
  3303     05  CEXPENSO PIC  Z(5).99.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  66
* EL156.cbl
  3304*    -------------------------------
  3305     05  FILLER            PIC  X(0003).
  3306     05  ERRMSG0O PIC  X(0072).
  3307*    -------------------------------
  3308     05  FILLER            PIC  X(0003).
  3309     05  ERRMSG1O PIC  X(0072).
  3310*    -------------------------------
  3311     05  FILLER            PIC  X(0003).
  3312     05  ERRMSG2O PIC  X(0072).
  3313*    -------------------------------
  3314     05  FILLER            PIC  X(0003).
  3315     05  ENTERPFO PIC  X(0002).
  3316*    -------------------------------
  3317     05  FILLER            PIC  X(0003).
  3318     05  PF6TITO PIC  X(0016).
  3319*    -------------------------------
  3320 01  EL156BI REDEFINES EL156AI.
  3321     05  FILLER            PIC  X(0012).
  3322*    -------------------------------
  3323     05  RUNDTEBL PIC S9(0004) COMP.
  3324     05  RUNDTEBF PIC  X(0001).
  3325     05  FILLER REDEFINES RUNDTEBF.
  3326         10  RUNDTEBA PIC  X(0001).
  3327     05  RUNDTEBI PIC  X(0008).
  3328*    -------------------------------
  3329     05  RUNTIMBL PIC S9(0004) COMP.
  3330     05  RUNTIMBF PIC  X(0001).
  3331     05  FILLER REDEFINES RUNTIMBF.
  3332         10  RUNTIMBA PIC  X(0001).
  3333     05  RUNTIMBI PIC  X(0005).
  3334*    -------------------------------
  3335     05  PAYDTBL PIC S9(0004) COMP.
  3336     05  PAYDTBF PIC  X(0001).
  3337     05  FILLER REDEFINES PAYDTBF.
  3338         10  PAYDTBA PIC  X(0001).
  3339     05  PAYDTBI PIC  X(0008).
  3340*    -------------------------------
  3341     05  PAYTYPBL PIC S9(0004) COMP.
  3342     05  PAYTYPBF PIC  X(0001).
  3343     05  FILLER REDEFINES PAYTYPBF.
  3344         10  PAYTYPBA PIC  X(0001).
  3345     05  PAYTYPBI PIC  X(0015).
  3346*    -------------------------------
  3347     05  PAYAMTBL PIC S9(0004) COMP.
  3348     05  PAYAMTBF PIC  X(0001).
  3349     05  FILLER REDEFINES PAYAMTBF.
  3350         10  PAYAMTBA PIC  X(0001).
  3351     05  PAYAMTBI PIC  X(0011).
  3352*    -------------------------------
  3353     05  LOANHBL PIC S9(0004) COMP.
  3354     05  LOANHBF PIC  X(0001).
  3355     05  FILLER REDEFINES LOANHBF.
  3356         10  LOANHBA PIC  X(0001).
  3357     05  LOANHBI PIC  X(0012).
  3358*    -------------------------------
  3359     05  LOANNBL PIC S9(0004) COMP.
  3360     05  LOANNBF PIC  X(0001).
  3361     05  FILLER REDEFINES LOANNBF.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  67
* EL156.cbl
  3362         10  LOANNBA PIC  X(0001).
  3363     05  LOANNBI PIC  X(0025).
  3364*    -------------------------------
  3365     05  CKNUMHDL PIC S9(0004) COMP.
  3366     05  CKNUMHDF PIC  X(0001).
  3367     05  FILLER REDEFINES CKNUMHDF.
  3368         10  CKNUMHDA PIC  X(0001).
  3369     05  CKNUMHDI PIC  X(0012).
  3370*    -------------------------------
  3371     05  CKNUMBL PIC S9(0004) COMP.
  3372     05  CKNUMBF PIC  X(0001).
  3373     05  FILLER REDEFINES CKNUMBF.
  3374         10  CKNUMBA PIC  X(0001).
  3375     05  CKNUMBI PIC  X(0007).
  3376*    -------------------------------
  3377     05  AGTHDGL PIC S9(0004) COMP.
  3378     05  AGTHDGF PIC  X(0001).
  3379     05  FILLER REDEFINES AGTHDGF.
  3380         10  AGTHDGA PIC  X(0001).
  3381     05  AGTHDGI PIC  X(0016).
  3382*    -------------------------------
  3383     05  NAMEBL PIC S9(0004) COMP.
  3384     05  NAMEBF PIC  X(0001).
  3385     05  FILLER REDEFINES NAMEBF.
  3386         10  NAMEBA PIC  X(0001).
  3387     05  NAMEBI PIC  X(0030).
  3388*    -------------------------------
  3389     05  NAMEB2L PIC S9(0004) COMP.
  3390     05  NAMEB2F PIC  X(0001).
  3391     05  FILLER REDEFINES NAMEB2F.
  3392         10  NAMEB2A PIC  X(0001).
  3393     05  NAMEB2I PIC  X(0030).
  3394*    -------------------------------
  3395     05  ADDR1BL PIC S9(0004) COMP.
  3396     05  ADDR1BF PIC  X(0001).
  3397     05  FILLER REDEFINES ADDR1BF.
  3398         10  ADDR1BA PIC  X(0001).
  3399     05  ADDR1BI PIC  X(0030).
  3400*    -------------------------------
  3401     05  ADDR1B2L PIC S9(0004) COMP.
  3402     05  ADDR1B2F PIC  X(0001).
  3403     05  FILLER REDEFINES ADDR1B2F.
  3404         10  ADDR1B2A PIC  X(0001).
  3405     05  ADDR1B2I PIC  X(0030).
  3406*    -------------------------------
  3407     05  ADDR2BL PIC S9(0004) COMP.
  3408     05  ADDR2BF PIC  X(0001).
  3409     05  FILLER REDEFINES ADDR2BF.
  3410         10  ADDR2BA PIC  X(0001).
  3411     05  ADDR2BI PIC  X(0030).
  3412*    -------------------------------
  3413     05  ADDR2B2L PIC S9(0004) COMP.
  3414     05  ADDR2B2F PIC  X(0001).
  3415     05  FILLER REDEFINES ADDR2B2F.
  3416         10  ADDR2B2A PIC  X(0001).
  3417     05  ADDR2B2I PIC  X(0030).
  3418*    -------------------------------
  3419     05  CITYSTBL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  68
* EL156.cbl
  3420     05  CITYSTBF PIC  X(0001).
  3421     05  FILLER REDEFINES CITYSTBF.
  3422         10  CITYSTBA PIC  X(0001).
  3423     05  CITYSTBI PIC  X(0030).
  3424*    -------------------------------
  3425     05  CITYST2L PIC S9(0004) COMP.
  3426     05  CITYST2F PIC  X(0001).
  3427     05  FILLER REDEFINES CITYST2F.
  3428         10  CITYST2A PIC  X(0001).
  3429     05  CITYST2I PIC  X(0030).
  3430*    -------------------------------
  3431     05  ZIPBL PIC S9(0004) COMP.
  3432     05  ZIPBF PIC  X(0001).
  3433     05  FILLER REDEFINES ZIPBF.
  3434         10  ZIPBA PIC  X(0001).
  3435     05  ZIPBI PIC  X(0009).
  3436*    -------------------------------
  3437     05  ZIPB2L PIC S9(0004) COMP.
  3438     05  ZIPB2F PIC  X(0001).
  3439     05  FILLER REDEFINES ZIPB2F.
  3440         10  ZIPB2A PIC  X(0001).
  3441     05  ZIPB2I PIC  X(0009).
  3442*    -------------------------------
  3443     05  INTHDBL PIC S9(0004) COMP.
  3444     05  INTHDBF PIC  X(0001).
  3445     05  FILLER REDEFINES INTHDBF.
  3446         10  INTHDBA PIC  X(0001).
  3447     05  INTHDBI PIC  X(0012).
  3448*    -------------------------------
  3449     05  INTAMTBL PIC S9(0004) COMP.
  3450     05  INTAMTBF PIC  X(0001).
  3451     05  FILLER REDEFINES INTAMTBF.
  3452         10  INTAMTBA PIC  X(0001).
  3453     05  INTAMTBI PIC  X(0011).
  3454*    -------------------------------
  3455     05  PMTHDGBL PIC S9(0004) COMP.
  3456     05  PMTHDGBF PIC  X(0001).
  3457     05  FILLER REDEFINES PMTHDGBF.
  3458         10  PMTHDGBA PIC  X(0001).
  3459     05  PMTHDGBI PIC  X(0034).
  3460*    -------------------------------
  3461     05  CLMNOBL PIC S9(0004) COMP.
  3462     05  CLMNOBF PIC  X(0001).
  3463     05  FILLER REDEFINES CLMNOBF.
  3464         10  CLMNOBA PIC  X(0001).
  3465     05  CLMNOBI PIC  X(0007).
  3466*    -------------------------------
  3467     05  CARRBL PIC S9(0004) COMP.
  3468     05  CARRBF PIC  X(0001).
  3469     05  FILLER REDEFINES CARRBF.
  3470         10  CARRBA PIC  X(0001).
  3471     05  CARRBI PIC  X(0001).
  3472*    -------------------------------
  3473     05  CERTNOBL PIC S9(0004) COMP.
  3474     05  CERTNOBF PIC  X(0001).
  3475     05  FILLER REDEFINES CERTNOBF.
  3476         10  CERTNOBA PIC  X(0001).
  3477     05  CERTNOBI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  69
* EL156.cbl
  3478*    -------------------------------
  3479     05  SUFXBL PIC S9(0004) COMP.
  3480     05  SUFXBF PIC  X(0001).
  3481     05  FILLER REDEFINES SUFXBF.
  3482         10  SUFXBA PIC  X(0001).
  3483     05  SUFXBI PIC  X(0001).
  3484*    -------------------------------
  3485     05  CLMTYPBL PIC S9(0004) COMP.
  3486     05  CLMTYPBF PIC  X(0001).
  3487     05  FILLER REDEFINES CLMTYPBF.
  3488         10  CLMTYPBA PIC  X(0001).
  3489     05  CLMTYPBI PIC  X(0006).
  3490*    -------------------------------
  3491     05  INCURBL PIC S9(0004) COMP.
  3492     05  INCURBF PIC  X(0001).
  3493     05  FILLER REDEFINES INCURBF.
  3494         10  INCURBA PIC  X(0001).
  3495     05  INCURBI PIC  X(0008).
  3496*    -------------------------------
  3497     05  PYFROMBL PIC S9(0004) COMP.
  3498     05  PYFROMBF PIC  X(0001).
  3499     05  FILLER REDEFINES PYFROMBF.
  3500         10  PYFROMBA PIC  X(0001).
  3501     05  PYFROMBI PIC  X(0008).
  3502*    -------------------------------
  3503     05  PYTHRUBL PIC S9(0004) COMP.
  3504     05  PYTHRUBF PIC  X(0001).
  3505     05  FILLER REDEFINES PYTHRUBF.
  3506         10  PYTHRUBA PIC  X(0001).
  3507     05  PYTHRUBI PIC  X(0008).
  3508*    -------------------------------
  3509     05  DAYSBL PIC S9(0004) COMP.
  3510     05  DAYSBF PIC  X(0001).
  3511     05  FILLER REDEFINES DAYSBF.
  3512         10  DAYSBA PIC  X(0001).
  3513     05  DAYSBI PIC  X(0005).
  3514*    -------------------------------
  3515     05  BYBL PIC S9(0004) COMP.
  3516     05  BYBF PIC  X(0001).
  3517     05  FILLER REDEFINES BYBF.
  3518         10  BYBA PIC  X(0001).
  3519     05  BYBI PIC  X(0004).
  3520*    -------------------------------
  3521     05  PROOFDBL PIC S9(0004) COMP.
  3522     05  PROOFDBF PIC  X(0001).
  3523     05  FILLER REDEFINES PROOFDBF.
  3524         10  PROOFDBA PIC  X(0001).
  3525     05  PROOFDBI PIC  X(0008).
  3526*    -------------------------------
  3527     05  ACCTBL PIC S9(0004) COMP.
  3528     05  ACCTBF PIC  X(0001).
  3529     05  FILLER REDEFINES ACCTBF.
  3530         10  ACCTBA PIC  X(0001).
  3531     05  ACCTBI PIC  X(0010).
  3532*    -------------------------------
  3533     05  STATEBL PIC S9(0004) COMP.
  3534     05  STATEBF PIC  X(0001).
  3535     05  FILLER REDEFINES STATEBF.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  70
* EL156.cbl
  3536         10  STATEBA PIC  X(0001).
  3537     05  STATEBI PIC  X(0002).
  3538*    -------------------------------
  3539     05  GROUPBL PIC S9(0004) COMP.
  3540     05  GROUPBF PIC  X(0001).
  3541     05  FILLER REDEFINES GROUPBF.
  3542         10  GROUPBA PIC  X(0001).
  3543     05  GROUPBI PIC  X(0006).
  3544*    -------------------------------
  3545     05  ACARRBL PIC S9(0004) COMP.
  3546     05  ACARRBF PIC  X(0001).
  3547     05  FILLER REDEFINES ACARRBF.
  3548         10  ACARRBA PIC  X(0001).
  3549     05  ACARRBI PIC  X(0001).
  3550*    -------------------------------
  3551     05  ACCTNMBL PIC S9(0004) COMP.
  3552     05  ACCTNMBF PIC  X(0001).
  3553     05  FILLER REDEFINES ACCTNMBF.
  3554         10  ACCTNMBA PIC  X(0001).
  3555     05  ACCTNMBI PIC  X(0030).
  3556*    -------------------------------
  3557     05  UNDISBL PIC S9(0004) COMP.
  3558     05  UNDISBF PIC  X(0001).
  3559     05  FILLER REDEFINES UNDISBF.
  3560         10  UNDISBA PIC  X(0001).
  3561     05  UNDISBI PIC  X(0010).
  3562*    -------------------------------
  3563     05  RATEBL PIC S9(0004) COMP.
  3564     05  RATEBF PIC  X(0001).
  3565     05  FILLER REDEFINES RATEBF.
  3566         10  RATEBA PIC  X(0001).
  3567     05  RATEBI PIC  X(0006).
  3568*    -------------------------------
  3569     05  ERMSG1BL PIC S9(0004) COMP.
  3570     05  ERMSG1BF PIC  X(0001).
  3571     05  FILLER REDEFINES ERMSG1BF.
  3572         10  ERMSG1BA PIC  X(0001).
  3573     05  ERMSG1BI PIC  X(0072).
  3574*    -------------------------------
  3575     05  ENTPFBL PIC S9(0004) COMP.
  3576     05  ENTPFBF PIC  X(0001).
  3577     05  FILLER REDEFINES ENTPFBF.
  3578         10  ENTPFBA PIC  X(0001).
  3579     05  ENTPFBI PIC  99.
  3580 01  EL156BO REDEFINES EL156AI.
  3581     05  FILLER            PIC  X(0012).
  3582*    -------------------------------
  3583     05  FILLER            PIC  X(0003).
  3584     05  RUNDTEBO PIC  X(0008).
  3585*    -------------------------------
  3586     05  FILLER            PIC  X(0003).
  3587     05  RUNTIMBO PIC  99.99.
  3588*    -------------------------------
  3589     05  FILLER            PIC  X(0003).
  3590     05  PAYDTBO PIC  99B99B99.
  3591*    -------------------------------
  3592     05  FILLER            PIC  X(0003).
  3593     05  PAYTYPBO PIC  X(0015).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  71
* EL156.cbl
  3594*    -------------------------------
  3595     05  FILLER            PIC  X(0003).
  3596     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3597*    -------------------------------
  3598     05  FILLER            PIC  X(0003).
  3599     05  LOANHBO PIC  X(0012).
  3600*    -------------------------------
  3601     05  FILLER            PIC  X(0003).
  3602     05  LOANNBO PIC  X(0025).
  3603*    -------------------------------
  3604     05  FILLER            PIC  X(0003).
  3605     05  CKNUMHDO PIC  X(0012).
  3606*    -------------------------------
  3607     05  FILLER            PIC  X(0003).
  3608     05  CKNUMBO PIC  X(0007).
  3609*    -------------------------------
  3610     05  FILLER            PIC  X(0003).
  3611     05  AGTHDGO PIC  X(0016).
  3612*    -------------------------------
  3613     05  FILLER            PIC  X(0003).
  3614     05  NAMEBO PIC  X(0030).
  3615*    -------------------------------
  3616     05  FILLER            PIC  X(0003).
  3617     05  NAMEB2O PIC  X(0030).
  3618*    -------------------------------
  3619     05  FILLER            PIC  X(0003).
  3620     05  ADDR1BO PIC  X(0030).
  3621*    -------------------------------
  3622     05  FILLER            PIC  X(0003).
  3623     05  ADDR1B2O PIC  X(0030).
  3624*    -------------------------------
  3625     05  FILLER            PIC  X(0003).
  3626     05  ADDR2BO PIC  X(0030).
  3627*    -------------------------------
  3628     05  FILLER            PIC  X(0003).
  3629     05  ADDR2B2O PIC  X(0030).
  3630*    -------------------------------
  3631     05  FILLER            PIC  X(0003).
  3632     05  CITYSTBO PIC  X(0030).
  3633*    -------------------------------
  3634     05  FILLER            PIC  X(0003).
  3635     05  CITYST2O PIC  X(0030).
  3636*    -------------------------------
  3637     05  FILLER            PIC  X(0003).
  3638     05  ZIPBO PIC  ZZZZ99999.
  3639*    -------------------------------
  3640     05  FILLER            PIC  X(0003).
  3641     05  ZIPB2O PIC  ZZZZZZZZZ.
  3642*    -------------------------------
  3643     05  FILLER            PIC  X(0003).
  3644     05  INTHDBO PIC  X(0012).
  3645*    -------------------------------
  3646     05  FILLER            PIC  X(0003).
  3647     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3648*    -------------------------------
  3649     05  FILLER            PIC  X(0003).
  3650     05  PMTHDGBO PIC  X(0034).
  3651*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  72
* EL156.cbl
  3652     05  FILLER            PIC  X(0003).
  3653     05  CLMNOBO PIC  X(0007).
  3654*    -------------------------------
  3655     05  FILLER            PIC  X(0003).
  3656     05  CARRBO PIC  X(0001).
  3657*    -------------------------------
  3658     05  FILLER            PIC  X(0003).
  3659     05  CERTNOBO PIC  X(0010).
  3660*    -------------------------------
  3661     05  FILLER            PIC  X(0003).
  3662     05  SUFXBO PIC  X(0001).
  3663*    -------------------------------
  3664     05  FILLER            PIC  X(0003).
  3665     05  CLMTYPBO PIC  X(0006).
  3666*    -------------------------------
  3667     05  FILLER            PIC  X(0003).
  3668     05  INCURBO PIC  X(0008).
  3669*    -------------------------------
  3670     05  FILLER            PIC  X(0003).
  3671     05  PYFROMBO PIC  99B99B99.
  3672*    -------------------------------
  3673     05  FILLER            PIC  X(0003).
  3674     05  PYTHRUBO PIC  99B99B99.
  3675*    -------------------------------
  3676     05  FILLER            PIC  X(0003).
  3677     05  DAYSBO PIC  X(0005).
  3678*    -------------------------------
  3679     05  FILLER            PIC  X(0003).
  3680     05  BYBO PIC  X(0004).
  3681*    -------------------------------
  3682     05  FILLER            PIC  X(0003).
  3683     05  PROOFDBO PIC  99B99B99.
  3684*    -------------------------------
  3685     05  FILLER            PIC  X(0003).
  3686     05  ACCTBO PIC  X(0010).
  3687*    -------------------------------
  3688     05  FILLER            PIC  X(0003).
  3689     05  STATEBO PIC  X(0002).
  3690*    -------------------------------
  3691     05  FILLER            PIC  X(0003).
  3692     05  GROUPBO PIC  X(0006).
  3693*    -------------------------------
  3694     05  FILLER            PIC  X(0003).
  3695     05  ACARRBO PIC  X(0001).
  3696*    -------------------------------
  3697     05  FILLER            PIC  X(0003).
  3698     05  ACCTNMBO PIC  X(0030).
  3699*    -------------------------------
  3700     05  FILLER            PIC  X(0003).
  3701     05  UNDISBO PIC  ZZZ,Z99.99.
  3702*    -------------------------------
  3703     05  FILLER            PIC  X(0003).
  3704     05  RATEBO PIC  ZZZ.99.
  3705*    -------------------------------
  3706     05  FILLER            PIC  X(0003).
  3707     05  ERMSG1BO PIC  X(0072).
  3708*    -------------------------------
  3709     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  73
* EL156.cbl
  3710     05  ENTPFBO PIC  X(0002).
  3711*    -------------------------------
  3712****************************************************************
  3713*
  3714* Copyright (c) 2007 by Clerity Solutions, Inc.
  3715* All rights reserved.
  3716*
  3717****************************************************************
  3718 01  DFHEIV.
  3719   02  DFHEIV0               PIC X(35).
  3720   02  DFHEIV1               PIC X(08).
  3721   02  DFHEIV2               PIC X(08).
  3722   02  DFHEIV3               PIC X(08).
  3723   02  DFHEIV4               PIC X(06).
  3724   02  DFHEIV5               PIC X(04).
  3725   02  DFHEIV6               PIC X(04).
  3726   02  DFHEIV7               PIC X(02).
  3727   02  DFHEIV8               PIC X(02).
  3728   02  DFHEIV9               PIC X(01).
  3729   02  DFHEIV10              PIC S9(7) COMP-3.
  3730   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3731   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3732   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3733   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3734   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3735   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3736   02  DFHEIV17              PIC X(04).
  3737   02  DFHEIV18              PIC X(04).
  3738   02  DFHEIV19              PIC X(04).
  3739   02  DFHEIV20              USAGE IS POINTER.
  3740   02  DFHEIV21              USAGE IS POINTER.
  3741   02  DFHEIV22              USAGE IS POINTER.
  3742   02  DFHEIV23              USAGE IS POINTER.
  3743   02  DFHEIV24              USAGE IS POINTER.
  3744   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3745   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3746   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3747   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3748   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3749   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3750   02  FILLER                PIC X(02).
  3751   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3752   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3753   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3754   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3755   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3756 LINKAGE  SECTION.
  3757*****************************************************************
  3758*                                                               *
  3759* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3760* All rights reserved.                                          *
  3761*                                                               *
  3762*****************************************************************
  3763 01  dfheiblk.
  3764     02  eibtime          pic s9(7) comp-3.
  3765     02  eibdate          pic s9(7) comp-3.
  3766     02  eibtrnid         pic x(4).
  3767     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  74
* EL156.cbl
  3768     02  eibtrmid         pic x(4).
  3769     02  dfheigdi         pic s9(4) comp.
  3770     02  eibcposn         pic s9(4) comp.
  3771     02  eibcalen         pic s9(4) comp.
  3772     02  eibaid           pic x(1).
  3773     02  eibfiller1       pic x(1).
  3774     02  eibfn            pic x(2).
  3775     02  eibfiller2       pic x(2).
  3776     02  eibrcode         pic x(6).
  3777     02  eibfiller3       pic x(2).
  3778     02  eibds            pic x(8).
  3779     02  eibreqid         pic x(8).
  3780     02  eibrsrce         pic x(8).
  3781     02  eibsync          pic x(1).
  3782     02  eibfree          pic x(1).
  3783     02  eibrecv          pic x(1).
  3784     02  eibsend          pic x(1).
  3785     02  eibatt           pic x(1).
  3786     02  eibeoc           pic x(1).
  3787     02  eibfmh           pic x(1).
  3788     02  eibcompl         pic x(1).
  3789     02  eibsig           pic x(1).
  3790     02  eibconf          pic x(1).
  3791     02  eiberr           pic x(1).
  3792     02  eibrldbk         pic x(1).
  3793     02  eiberrcd         pic x(4).
  3794     02  eibsynrb         pic x(1).
  3795     02  eibnodat         pic x(1).
  3796     02  eibfiller5       pic x(2).
  3797     02  eibresp          pic 9(09) comp.
  3798     02  eibresp2         pic 9(09) comp.
  3799     02  dfheigdj         pic s9(4) comp.
  3800     02  dfheigdk         pic s9(4) comp.
  3801 01  DFHCOMMAREA             PIC X(1024).
  3802
  3803*    COPY ELCMSTR.
  3804******************************************************************
  3805*                                                                *
  3806*                            ELCMSTR.                            *
  3807*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3808*                            VMOD=2.012                          *
  3809*                                                                *
  3810*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3811*                                                                *
  3812*   FILE TYPE = VSAM,KSDS                                        *
  3813*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3814*                                                                *
  3815*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3816*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3817*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3818*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3819*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3820*                                                 RKP=75,LEN=21  *
  3821*                                                                *
  3822*   **** NOTE ****                                               *
  3823*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3824*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3825*                                                                *
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  75
* EL156.cbl
  3826*   LOG = YES                                                    *
  3827*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3828******************************************************************
  3829*                   C H A N G E   L O G
  3830*
  3831* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3832*-----------------------------------------------------------------
  3833*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3834* EFFECTIVE    NUMBER
  3835*-----------------------------------------------------------------
  3836* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3837* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3838* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3839* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3840* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3841******************************************************************
  3842 01  CLAIM-MASTER.
  3843     12  CL-RECORD-ID                PIC XX.
  3844         88  VALID-CL-ID         VALUE 'CL'.
  3845
  3846     12  CL-CONTROL-PRIMARY.
  3847         16  CL-COMPANY-CD           PIC X.
  3848         16  CL-CARRIER              PIC X.
  3849         16  CL-CLAIM-NO             PIC X(7).
  3850         16  CL-CERT-NO.
  3851             20  CL-CERT-PRIME       PIC X(10).
  3852             20  CL-CERT-SFX         PIC X.
  3853
  3854     12  CL-CONTROL-BY-NAME.
  3855         16  CL-COMPANY-CD-A1        PIC X.
  3856         16  CL-INSURED-LAST-NAME    PIC X(15).
  3857         16  CL-INSURED-NAME.
  3858             20  CL-INSURED-1ST-NAME PIC X(12).
  3859             20  CL-INSURED-MID-INIT PIC X.
  3860
  3861     12  CL-CONTROL-BY-SSN.
  3862         16  CL-COMPANY-CD-A2        PIC X.
  3863         16  CL-SOC-SEC-NO.
  3864             20  CL-SSN-STATE        PIC XX.
  3865             20  CL-SSN-ACCOUNT      PIC X(6).
  3866             20  CL-SSN-LN3          PIC X(3).
  3867
  3868     12  CL-CONTROL-BY-CERT-NO.
  3869         16  CL-COMPANY-CD-A4        PIC X.
  3870         16  CL-CERT-NO-A4.
  3871             20  CL-CERT-A4-PRIME    PIC X(10).
  3872             20  CL-CERT-A4-SFX      PIC X.
  3873
  3874     12  CL-CONTROL-BY-CCN.
  3875         16  CL-COMPANY-CD-A5        PIC X.
  3876         16  CL-CCN-A5.
  3877             20  CL-CCN.
  3878                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3879                 24  CL-CCN-PRIME-A5 PIC X(12).
  3880             20  CL-CCN-FILLER-A5    PIC X(4).
  3881
  3882     12  CL-INSURED-PROFILE-DATA.
  3883         16  CL-INSURED-BIRTH-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  76
* EL156.cbl
  3884         16  CL-INSURED-SEX-CD       PIC X.
  3885             88  INSURED-IS-MALE        VALUE 'M'.
  3886             88  INSURED-IS-FEMALE      VALUE 'F'.
  3887             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3888         16  CL-INSURED-OCC-CD       PIC X(6).
  3889         16  FILLER                  PIC X(5).
  3890
  3891     12  CL-PROCESSING-INFO.
  3892         16  CL-PROCESSOR-ID         PIC X(4).
  3893         16  CL-CLAIM-STATUS         PIC X.
  3894             88  CLAIM-IS-OPEN          VALUE 'O'.
  3895             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3896         16  CL-CLAIM-TYPE           PIC X.
  3897*            88  AH-CLAIM               VALUE 'A'.
  3898*            88  LIFE-CLAIM             VALUE 'L'.
  3899*            88  PROPERTY-CLAIM         VALUE 'P'.
  3900*            88  IUI-CLAIM              VALUE 'I'.
  3901*            88  GAP-CLAIM              VALUE 'G'.
  3902*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3903         16  CL-CLAIM-PREM-TYPE      PIC X.
  3904             88  SINGLE-PREMIUM         VALUE '1'.
  3905             88  O-B-COVERAGE           VALUE '2'.
  3906             88  OPEN-END-COVERAGE      VALUE '3'.
  3907         16  CL-INCURRED-DT          PIC XX.
  3908         16  CL-REPORTED-DT          PIC XX.
  3909         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3910         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3911         16  CL-LAST-PMT-DT          PIC XX.
  3912         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3913         16  CL-PAID-THRU-DT         PIC XX.
  3914         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3915         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3916         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3917         16  CL-PMT-CALC-METHOD      PIC X.
  3918             88  CL-360-DAY-YR          VALUE '1'.
  3919             88  CL-365-DAY-YR          VALUE '2'.
  3920             88  CL-FULL-MONTHS         VALUE '3'.
  3921         16  CL-CAUSE-CD             PIC X(6).
  3922
  3923         16  CL-PRIME-CERT-NO.
  3924             20  CL-PRIME-CERT-PRIME PIC X(10).
  3925             20  CL-PRIME-CERT-SFX   PIC X.
  3926
  3927         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3928             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3929             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3930
  3931         16  CL-MICROFILM-NO         PIC X(10).
  3932         16  FILLER REDEFINES CL-MICROFILM-NO.
  3933             20  CL-BENEFIT-PERIOD   PIC 99.
  3934             20  FILLER              PIC X(8).
  3935         16  CL-PROG-FORM-TYPE       PIC X.
  3936         16  CL-LAST-ADD-ON-DT       PIC XX.
  3937
  3938         16  CL-LAST-REOPEN-DT       PIC XX.
  3939         16  CL-LAST-CLOSE-DT        PIC XX.
  3940         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3941             88  FINAL-PAID             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  77
* EL156.cbl
  3942             88  CLAIM-DENIED           VALUE '2'.
  3943             88  AUTO-CLOSE             VALUE '3'.
  3944             88  MANUAL-CLOSE           VALUE '4'.
  3945             88  BENEFITS-CHANGED       VALUE 'C'.
  3946             88  SETUP-ERRORS           VALUE 'E'.
  3947         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3948         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3949         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3950             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3951         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3952         16  FILLER                  PIC X.
  3953
  3954     12  CL-CERTIFICATE-DATA.
  3955         16  CL-CERT-ORIGIN          PIC X.
  3956             88  CERT-WAS-ONLINE        VALUE '1'.
  3957             88  CERT-WAS-CREATED       VALUE '2'.
  3958             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3959         16  CL-CERT-KEY-DATA.
  3960             20  CL-CERT-CARRIER     PIC X.
  3961             20  CL-CERT-GROUPING    PIC X(6).
  3962             20  CL-CERT-STATE       PIC XX.
  3963             20  CL-CERT-ACCOUNT.
  3964                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3965                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3966             20  CL-CERT-EFF-DT      PIC XX.
  3967
  3968     12  CL-STATUS-CONTROLS.
  3969         16  CL-PRIORITY-CD          PIC X.
  3970             88  CONFIDENTIAL-DATA      VALUE '8'.
  3971             88  HIGHEST-PRIORITY       VALUE '9'.
  3972         16  CL-SUPV-ATTN-CD         PIC X.
  3973             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3974             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3975         16  CL-PURGED-DT            PIC XX.
  3976         16  CL-RESTORED-DT          PIC XX.
  3977         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3978         16  CL-NEXT-RESEND-DT       PIC XX.
  3979         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3980         16  CL-CRITICAL-PERIOD      PIC 99.
  3981*        16  FILLER                  PIC XX.
  3982         16  CL-LAST-MAINT-DT        PIC XX.
  3983         16  CL-LAST-MAINT-USER      PIC X(4).
  3984         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3985         16  CL-LAST-MAINT-TYPE      PIC X.
  3986             88  CLAIM-SET-UP           VALUE ' '.
  3987             88  PAYMENT-MADE           VALUE '1'.
  3988             88  LETTER-SENT            VALUE '2'.
  3989             88  MASTER-WAS-ALTERED     VALUE '3'.
  3990             88  MASTER-WAS-RESTORED    VALUE '4'.
  3991             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3992             88  FILE-CONVERTED         VALUE '6'.
  3993             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3994             88  ERROR-CORRECTION       VALUE 'E'.
  3995         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3996         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3997         16  CL-BENEFICIARY          PIC X(10).
  3998         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3999         16  CL-DENIAL-TYPE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  78
* EL156.cbl
  4000             88  CL-TYPE-DENIAL          VALUE '1'.
  4001             88  CL-TYPE-RESCISSION      VALUE '2'.
  4002             88  CL-TYPE-REFORMATION     VALUE '3'.
  4003             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4004             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4005         16  filler                  pic x(5).
  4006*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4007*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4008*        16  CL-RTW-DT               PIC XX.
  4009
  4010     12  CL-TRAILER-CONTROLS.
  4011         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4012             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4013             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4014             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4015         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4016         16  FILLER                  PIC XX.
  4017         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4018         16  CL-ADDRESS-TRAILER-CNT.
  4019             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4020                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4021             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4022                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4023             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4024                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4025             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4026                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4027             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4028                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4029             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4030                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4031             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4032                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4033
  4034     12  CL-CV-REFERENCE-NO.
  4035         16  CL-CV-REFNO-PRIME       PIC X(18).
  4036         16  CL-CV-REFNO-SFX         PIC XX.
  4037
  4038     12  CL-FILE-LOCATION            PIC X(4).
  4039
  4040     12  CL-PROCESS-ERRORS.
  4041         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4042             88  NO-FATAL-ERRORS        VALUE ZERO.
  4043         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4044             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4045
  4046     12  CL-PRODUCT-CD               PIC X.
  4047
  4048     12  CL-CURRENT-KEY-DATA.
  4049         16  CL-CURRENT-CARRIER      PIC X.
  4050         16  CL-CURRENT-GROUPING     PIC X(6).
  4051         16  CL-CURRENT-STATE        PIC XX.
  4052         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4053
  4054     12  CL-ASSOCIATES               PIC X.
  4055         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4056         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4057         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  79
* EL156.cbl
  4058         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4059
  4060     12  CL-ACTIVITY-CODE            PIC 99.
  4061     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4062     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4063
  4064     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4065     12  CL-LAG-REPORT-CODE          PIC 9.
  4066     12  CL-LOAN-TYPE                PIC XX.
  4067     12  CL-LEGAL-STATE              PIC XX.
  4068
  4069     12  CL-YESNOSW                  PIC X.
  4070     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4071         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4072         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4073         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4074     12  cl-insured-type             pic x.
  4075         88  cl-claim-on-primary         value 'P'.
  4076         88  cl-claim-on-co-borrower     value 'C'.
  4077     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  80
* EL156.cbl
  4079*    COPY ELCCNTL.
  4080******************************************************************
  4081*                                                                *
  4082*                                                                *
  4083*                            ELCCNTL.                            *
  4084*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4085*                            VMOD=2.059                          *
  4086*                                                                *
  4087*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4088*                                                                *
  4089*   FILE TYPE = VSAM,KSDS                                        *
  4090*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4091*                                                                *
  4092*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4093*       ALTERNATE INDEX = NONE                                   *
  4094*                                                                *
  4095*   LOG = YES                                                    *
  4096*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4097******************************************************************
  4098*                   C H A N G E   L O G
  4099*
  4100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4101*-----------------------------------------------------------------
  4102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4103* EFFECTIVE    NUMBER
  4104*-----------------------------------------------------------------
  4105* 082503                   PEMA  ADD BENEFIT GROUP
  4106* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4107* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4108* 092705    2005050300006  PEMA  ADD SPP LEASES
  4109* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4110* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4111* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4112* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4113* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4114* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4115* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4116* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4117* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4118* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4119******************************************************************
  4120*
  4121 01  CONTROL-FILE.
  4122     12  CF-RECORD-ID                       PIC XX.
  4123         88  VALID-CF-ID                        VALUE 'CF'.
  4124
  4125     12  CF-CONTROL-PRIMARY.
  4126         16  CF-COMPANY-ID                  PIC XXX.
  4127         16  CF-RECORD-TYPE                 PIC X.
  4128             88  CF-COMPANY-MASTER              VALUE '1'.
  4129             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4130             88  CF-STATE-MASTER                VALUE '3'.
  4131             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4132             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4133             88  CF-CARRIER-MASTER              VALUE '6'.
  4134             88  CF-MORTALITY-MASTER            VALUE '7'.
  4135             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4136             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  81
* EL156.cbl
  4137             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4138             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4139             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4140             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4141             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4142             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4143             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4144             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4145             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4146         16  CF-ACCESS-CD-GENL              PIC X(4).
  4147         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4148             20  CF-PROCESSOR               PIC X(4).
  4149         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4150             20  CF-STATE-CODE              PIC XX.
  4151             20  FILLER                     PIC XX.
  4152         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4153             20  FILLER                     PIC XX.
  4154             20  CF-HI-BEN-IN-REC           PIC XX.
  4155         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4156             20  FILLER                     PIC XXX.
  4157             20  CF-CARRIER-CNTL            PIC X.
  4158         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4159             20  FILLER                     PIC XX.
  4160             20  CF-HI-TYPE-IN-REC          PIC 99.
  4161         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4162             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4163                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4164             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4165             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4166         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4167             20  FILLER                     PIC X.
  4168             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4169         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4170             20  FILLER                     PIC XX.
  4171             20  CF-MORTGAGE-PLAN           PIC XX.
  4172         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4173
  4174     12  CF-LAST-MAINT-DT                   PIC XX.
  4175     12  CF-LAST-MAINT-BY                   PIC X(4).
  4176     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4177
  4178     12  CF-RECORD-BODY                     PIC X(728).
  4179
  4180
  4181****************************************************************
  4182*             COMPANY MASTER RECORD                            *
  4183****************************************************************
  4184
  4185     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4186         16  CF-COMPANY-ADDRESS.
  4187             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4188             20  CF-CL-IN-CARE-OF           PIC X(30).
  4189             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4190             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4191             20  CF-CL-CITY-STATE           PIC X(30).
  4192             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4193             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4194         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  82
* EL156.cbl
  4195         16  CF-COMPANY-PASSWORD            PIC X(8).
  4196         16  CF-SECURITY-OPTION             PIC X.
  4197             88  ALL-SECURITY                   VALUE '1'.
  4198             88  COMPANY-VERIFY                 VALUE '2'.
  4199             88  PROCESSOR-VERIFY               VALUE '3'.
  4200             88  NO-SECURITY                    VALUE '4'.
  4201             88  ALL-BUT-TERM                   VALUE '5'.
  4202         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4203             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4204         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4205             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4206         16  CF-INFORCE-LOCATION            PIC X.
  4207             88  CERTS-ARE-ONLINE               VALUE '1'.
  4208             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4209             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4210         16  CF-LOWER-CASE-LETTERS          PIC X.
  4211         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4212             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4213             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4214             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4215             88  CF-ACCNT-CNTL                  VALUE '3'.
  4216             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4217
  4218         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4219         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4220
  4221         16  CF-LGX-CREDIT-USER             PIC X.
  4222             88  CO-IS-NOT-USER                 VALUE 'N'.
  4223             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4224
  4225         16 CF-CREDIT-CALC-CODES.
  4226             20  CF-CR-REM-TERM-CALC PIC X.
  4227               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4228               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4229               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4230               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4231               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4232               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4233               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4234             20  CF-CR-R78-METHOD           PIC X.
  4235               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4236               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4237
  4238         16  CF-CLAIM-CONTROL-COUNTS.
  4239             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4240                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4241
  4242             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4243                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4244
  4245             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4246                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4247
  4248             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4249                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4250
  4251         16  CF-CURRENT-MONTH-END           PIC XX.
  4252
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  83
* EL156.cbl
  4253         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4254             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4255             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4256             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4257             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4258                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4259                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4260             20  CF-CO-PREM-REJECT-SW       PIC X.
  4261                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4262                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4263             20  CF-CO-REF-REJECT-SW        PIC X.
  4264                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4265                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4266
  4267         16  CF-CO-REPORTING-DT             PIC XX.
  4268         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4269         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4270           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4271           88  CF-CO-MONTH-END                  VALUE '1'.
  4272
  4273         16  CF-LGX-CLAIM-USER              PIC X.
  4274             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4275             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4276
  4277         16  CF-CREDIT-EDIT-CONTROLS.
  4278             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4279             20  CF-MIN-AGE                 PIC 99.
  4280             20  CF-DEFAULT-AGE             PIC 99.
  4281             20  CF-MIN-TERM                PIC S999      COMP-3.
  4282             20  CF-MAX-TERM                PIC S999      COMP-3.
  4283             20  CF-DEFAULT-SEX             PIC X.
  4284             20  CF-JOINT-AGE-INPUT         PIC X.
  4285                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4286             20  CF-BIRTH-DATE-INPUT        PIC X.
  4287                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4288             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4289                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4290                 88  CF-ZERO-CARRIER            VALUE '1'.
  4291                 88  CF-ZERO-GROUPING           VALUE '2'.
  4292                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4293             20  CF-EDIT-SW                 PIC X.
  4294                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4295             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4296             20  CF-CR-PR-METHOD            PIC X.
  4297               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4298               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4299             20  FILLER                     PIC X.
  4300
  4301         16  CF-CREDIT-MISC-CONTROLS.
  4302             20  CF-REIN-TABLE-SW           PIC X.
  4303                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4304             20  CF-COMP-TABLE-SW           PIC X.
  4305                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4306             20  CF-EXPERIENCE-RETENTION-AGE
  4307                                            PIC S9        COMP-3.
  4308             20  CF-CONVERSION-DT           PIC XX.
  4309             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4310             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  84
* EL156.cbl
  4311                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4312                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4313
  4314             20  CF-CR-CHECK-NO-CONTROL.
  4315                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4316                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4317                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4318                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4319                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4320                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4321
  4322                 24  CF-CR-CHECK-COUNT       REDEFINES
  4323                     CF-CR-CHECK-COUNTER      PIC X(4).
  4324
  4325                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4326                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4327
  4328                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4329                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4330                 24  CF-MAIL-PROCESSING       PIC X.
  4331                     88  MAIL-PROCESSING          VALUE 'Y'.
  4332
  4333         16  CF-MISC-SYSTEM-CONTROL.
  4334             20  CF-SYSTEM-C                 PIC X.
  4335                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4336             20  CF-SYSTEM-D                 PIC X.
  4337                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4338             20  CF-SOC-SEC-NO-SW            PIC X.
  4339                 88  SOC-SEC-NO-USED             VALUE '1'.
  4340             20  CF-MEMBER-NO-SW             PIC X.
  4341                 88  MEMBER-NO-USED              VALUE '1'.
  4342             20  CF-TAX-ID-NUMBER            PIC X(11).
  4343             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4344             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4345                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4346                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4347                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4348                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4349             20  CF-SYSTEM-E                 PIC X.
  4350                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4351
  4352         16  CF-LGX-LIFE-USER               PIC X.
  4353             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4354             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4355
  4356         16  CF-CR-MONTH-END-DT             PIC XX.
  4357
  4358         16  CF-FILE-MAINT-DATES.
  4359             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4360                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4361             20  CF-LAST-BATCH       REDEFINES
  4362                 CF-LAST-BATCH-NO               PIC X(4).
  4363             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4364             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4365             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4366             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4367             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4368             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  85
* EL156.cbl
  4369             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4370             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4371             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4372             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4373
  4374         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4375         16  FILLER                         PIC X.
  4376
  4377         16  CF-ALT-MORT-CODE               PIC X(4).
  4378         16  CF-MEMBER-CAPTION              PIC X(10).
  4379
  4380         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4381             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4382             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4383             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4384             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4385             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4386
  4387         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4388
  4389         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4390         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4391         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4392         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4393
  4394         16  CF-AH-OVERRIDE-L1              PIC X.
  4395         16  CF-AH-OVERRIDE-L2              PIC XX.
  4396         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4397         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4398
  4399         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4400         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4401
  4402         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4403         16  CF-AR-LAST-EL860-DT            PIC XX.
  4404         16  CF-MP-MONTH-END-DT             PIC XX.
  4405
  4406         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4407         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4408             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4409
  4410         16  CF-AR-MONTH-END-DT             PIC XX.
  4411
  4412         16  CF-CRDTCRD-USER                PIC X.
  4413             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4414             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4415
  4416         16  CF-CC-MONTH-END-DT             PIC XX.
  4417
  4418         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4419
  4420         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4421             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4422             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4423             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4424         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4425         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4426         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  86
* EL156.cbl
  4427         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4428             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4429             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4430         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4431         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4432         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4433             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4434         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4435
  4436         16  CF-CL-ZIP-CODE.
  4437             20  CF-CL-ZIP-PRIME.
  4438                 24  CF-CL-ZIP-1ST          PIC X.
  4439                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4440                 24  FILLER                 PIC X(4).
  4441             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4442         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4443             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4444             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4445             20  FILLER                     PIC XXX.
  4446
  4447         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4448         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4449         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4450         16  CF-CO-OPTION-START-DATE        PIC XX.
  4451         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4452           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4453                                                      '3' '4'.
  4454           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4455           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4456           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4457           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4458           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4459           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4460
  4461         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4462
  4463         16  CF-PAYMENT-APPROVAL-LEVELS.
  4464             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4465             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4466             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4467             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4468             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4469             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4470
  4471         16  CF-END-USER-REPORTING-USER     PIC X.
  4472             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4473             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4474
  4475         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4476             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4477             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4478
  4479         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4480
  4481         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4482         16  FILLER                         PIC X.
  4483
  4484         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  87
* EL156.cbl
  4485             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4486             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4487             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4488
  4489         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4490
  4491         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4492             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4493             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4494
  4495         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4496             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4497             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4498
  4499         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4500
  4501         16  CF-CO-ACH-ID-CODE              PIC  X.
  4502             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4503             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4504             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4505         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4506         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4507         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4508         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4509         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4510         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4511         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4512         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4513         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4514                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4515         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4516                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4517
  4518         16  CF-CO-OVER-SHORT.
  4519             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4520             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4521
  4522*         16  FILLER                         PIC X(102).
  4523         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4524             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4525             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4526
  4527         16  CF-AH-APPROVAL-DAYS.
  4528             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4529             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4530             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4531             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4532
  4533         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4534
  4535         16  CF-APPROV-LEV-5.
  4536             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4537             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4538             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4539
  4540         16  FILLER                         PIC X(68).
  4541****************************************************************
  4542*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  88
* EL156.cbl
  4543****************************************************************
  4544
  4545     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4546         16  CF-PROCESSOR-NAME              PIC X(30).
  4547         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4548         16  CF-PROCESSOR-TITLE             PIC X(26).
  4549         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4550                 88  MESSAGE-YES                VALUE 'Y'.
  4551                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4552
  4553*****************************************************
  4554****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4555****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4556****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4557****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4558*****************************************************
  4559
  4560         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4561             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4562             20  CF-APPLICATION-FORCE       PIC X.
  4563             20  CF-INDIVIDUAL-APP.
  4564                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4565                     28  CF-BROWSE-APP      PIC X.
  4566                     28  CF-UPDATE-APP      PIC X.
  4567
  4568         16  CF-CURRENT-TERM-ON             PIC X(4).
  4569         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4570             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4571             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4572             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4573             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4574             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4575             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4576             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4577         16  CF-PROCESSOR-CARRIER           PIC X.
  4578             88  NO-CARRIER-SECURITY            VALUE ' '.
  4579         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4580             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4581         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4582             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4583         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4584             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4585
  4586         16  CF-PROC-SYS-ACCESS-SW.
  4587             20  CF-PROC-CREDIT-CLAIMS-SW.
  4588                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4589                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4590                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4591                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4592             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4593                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4594                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4595             20  CF-PROC-LIFE-GNRLDGR-SW.
  4596                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4597                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4598                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4599                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4600             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  89
* EL156.cbl
  4601                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4602                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4603         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4604             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4605             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4606         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4607
  4608         16  CF-APPROVAL-LEVEL                  PIC X.
  4609             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4610             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4611             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4612             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4613             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4614
  4615         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4616
  4617         16  CF-LANGUAGE-TYPE                   PIC X.
  4618             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4619             88  CF-LANG-IS-FR                      VALUE 'F'.
  4620
  4621         16  CF-CSR-IND                         PIC X.
  4622         16  FILLER                             PIC X(239).
  4623
  4624****************************************************************
  4625*             PROCESSOR/REMINDERS RECORD                       *
  4626****************************************************************
  4627
  4628     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4629         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4630             20  CF-START-REMIND-DT         PIC XX.
  4631             20  CF-END-REMIND-DT           PIC XX.
  4632             20  CF-REMINDER-TEXT           PIC X(50).
  4633         16  FILLER                         PIC X(296).
  4634
  4635
  4636****************************************************************
  4637*             STATE MASTER RECORD                              *
  4638****************************************************************
  4639
  4640     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4641         16  CF-STATE-ABBREVIATION          PIC XX.
  4642         16  CF-STATE-NAME                  PIC X(25).
  4643         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4644         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4645             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4646             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4647             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4648             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4649                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4650                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4651             20  CF-ST-PREM-REJECT-SW       PIC X.
  4652                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4653                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4654             20  CF-ST-REF-REJECT-SW        PIC X.
  4655                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4656                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4657         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4658         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  90
* EL156.cbl
  4659         16  CF-ST-REFUND-RULES.
  4660             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4661             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4662             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4663         16  CF-ST-FST-PMT-EXTENSION.
  4664             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4665             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4666                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4667                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4668                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4669                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4670         16  CF-ST-STATE-CALL.
  4671             20  CF-ST-CALL-UNEARNED        PIC X.
  4672             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4673             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4674         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4675             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4676             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4677         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4678         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4679         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4680         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4681         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4682         16  FILLER                         PIC X.
  4683         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4684             20  CF-ST-BENEFIT-CD           PIC XX.
  4685             20  CF-ST-BENEFIT-KIND         PIC X.
  4686                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4687                 88  CF-ST-AH-KIND              VALUE 'A'.
  4688             20  CF-ST-REM-TERM-CALC        PIC X.
  4689                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4690                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4691                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4692                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4693                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4694                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4695                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4696                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4697
  4698             20  CF-ST-REFUND-CALC          PIC X.
  4699                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4700                 88  ST-REFD-BY-R78             VALUE '1'.
  4701                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4702                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4703                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4704                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4705                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4706                 88  ST-REFD-UTAH               VALUE '7'.
  4707                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4708                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4709                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4710
  4711             20  CF-ST-EARNING-CALC         PIC X.
  4712                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4713                 88  ST-EARN-BY-R78             VALUE '1'.
  4714                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4715                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4716                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  91
* EL156.cbl
  4717                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4718                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4719                 88  ST-EARN-MEAN               VALUE '8'.
  4720                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4721
  4722             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4723                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4724                 88  ST-OVRD-BY-R78             VALUE '1'.
  4725                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4726                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4727                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4728                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4729                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4730                 88  ST-OVRD-MEAN               VALUE '8'.
  4731                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4732             20  FILLER                     PIC X.
  4733
  4734         16  CF-ST-COMMISSION-CAPS.
  4735             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4736             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4737             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4738             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4739         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4740                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4741
  4742         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4743
  4744         16  CF-ST-STATUTORY-INTEREST.
  4745             20  CF-ST-STAT-DATE-FROM       PIC X.
  4746                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4747                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4748             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4749             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4750             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4751             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4752             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4753
  4754         16  CF-ST-OVER-SHORT.
  4755             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4756             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4757
  4758         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4759
  4760         16  CF-ST-RT-CALC                  PIC X.
  4761
  4762         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4763         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4764         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4765         16  CF-ST-RF-LR-CALC               PIC X.
  4766         16  CF-ST-RF-LL-CALC               PIC X.
  4767         16  CF-ST-RF-LN-CALC               PIC X.
  4768         16  CF-ST-RF-AH-CALC               PIC X.
  4769         16  CF-ST-RF-CP-CALC               PIC X.
  4770*        16  FILLER                         PIC X(206).
  4771*CIDMOD         16  FILLER                         PIC X(192).
  4772         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4773             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4774         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  92
* EL156.cbl
  4775         16  CF-ST-VFY-2ND-BENE             PIC X.
  4776         16  CF-ST-CAUSAL-STATE             PIC X.
  4777         16  FILLER                         PIC X(185).
  4778
  4779****************************************************************
  4780*             BENEFIT MASTER RECORD                            *
  4781****************************************************************
  4782
  4783     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4784         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4785             20  CF-BENEFIT-CODE            PIC XX.
  4786             20  CF-BENEFIT-NUMERIC  REDEFINES
  4787                 CF-BENEFIT-CODE            PIC XX.
  4788             20  CF-BENEFIT-ALPHA           PIC XXX.
  4789             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4790             20  CF-BENEFIT-COMMENT         PIC X(10).
  4791
  4792             20  CF-LF-COVERAGE-TYPE        PIC X.
  4793                 88  CF-REDUCING                VALUE 'R'.
  4794                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4795
  4796             20  CF-SPECIAL-CALC-CD         PIC X.
  4797                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4798                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4799                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4800                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4801                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4802                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4803                 88  CF-FARM-PLAN               VALUE 'F'.
  4804                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4805                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4806                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4807                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4808                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4809                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4810                 88  CF-PRUDENTIAL              VALUE 'P'.
  4811                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4812                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4813                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4814                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4815                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4816                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4817
  4818             20  CF-JOINT-INDICATOR         PIC X.
  4819                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4820
  4821*            20  FILLER                     PIC X(12).
  4822             20  cf-maximum-benefits        pic s999 comp-3.
  4823             20  FILLER                     PIC X(09).
  4824             20  CF-BENEFIT-CATEGORY        PIC X.
  4825             20  CF-LOAN-TYPE               PIC X(8).
  4826
  4827             20  CF-CO-REM-TERM-CALC        PIC X.
  4828                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4829                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4830                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4831                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4832                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  93
* EL156.cbl
  4833
  4834             20  CF-CO-EARNINGS-CALC        PIC X.
  4835                 88  CO-EARN-BY-R78             VALUE '1'.
  4836                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4837                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4838                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4839                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4840                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4841                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4842                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4843
  4844             20  CF-CO-REFUND-CALC          PIC X.
  4845                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4846                 88  CO-REFD-BY-R78             VALUE '1'.
  4847                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4848                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4849                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4850                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4851                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4852                 88  CO-REFD-MEAN               VALUE '8'.
  4853                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4854                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4855                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4856
  4857             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4858                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4859                 88  CO-OVRD-BY-R78             VALUE '1'.
  4860                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4861                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4862                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4863                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4864                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4865                 88  CO-OVRD-MEAN               VALUE '8'.
  4866                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4867
  4868             20  CF-CO-BEN-I-G-CD           PIC X.
  4869                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4870                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4871                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4872
  4873         16  FILLER                         PIC X(304).
  4874
  4875
  4876****************************************************************
  4877*             CARRIER MASTER RECORD                            *
  4878****************************************************************
  4879
  4880     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4881         16  CF-ADDRESS-DATA.
  4882             20  CF-MAIL-TO-NAME            PIC X(30).
  4883             20  CF-IN-CARE-OF              PIC X(30).
  4884             20  CF-ADDRESS-LINE-1          PIC X(30).
  4885             20  CF-ADDRESS-LINE-2          PIC X(30).
  4886             20  CF-CITY-STATE              PIC X(30).
  4887             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4888             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4889
  4890         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  94
* EL156.cbl
  4891             20  CF-CLAIM-NO-METHOD         PIC X.
  4892                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4893                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4894                 88  CLAIM-NO-SEQ               VALUE '3'.
  4895                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4896             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4897                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4898                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4899                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4900
  4901         16  CF-CHECK-NO-CONTROL.
  4902             20  CF-CHECK-NO-METHOD         PIC X.
  4903                 88  CHECK-NO-MANUAL            VALUE '1'.
  4904                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4905                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4906                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4907             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4908                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4909
  4910         16  CF-DOMICILE-STATE              PIC XX.
  4911
  4912         16  CF-EXPENSE-CONTROLS.
  4913             20  CF-EXPENSE-METHOD          PIC X.
  4914                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4915                 88  DOLLARS-PER-PMT            VALUE '2'.
  4916                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4917                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4918             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4919             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4920
  4921         16  CF-CORRESPONDENCE-CONTROL.
  4922             20  CF-LETTER-RESEND-OPT       PIC X.
  4923                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4924                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4925             20  FILLER                     PIC X(4).
  4926
  4927         16  CF-RESERVE-CONTROLS.
  4928             20  CF-MANUAL-SW               PIC X.
  4929                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4930             20  CF-FUTURE-SW               PIC X.
  4931                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4932             20  CF-PTC-SW                  PIC X.
  4933                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4934             20  CF-IBNR-SW                 PIC X.
  4935                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4936             20  CF-PTC-LF-SW               PIC X.
  4937                 88  CF-LF-PTC-USED             VALUE '1'.
  4938             20  CF-CDT-ACCESS-METHOD       PIC X.
  4939                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4940                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4941                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4942             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4943
  4944         16  CF-CLAIM-CALC-METHOD           PIC X.
  4945             88  360-PLUS-MONTHS                VALUE '1'.
  4946             88  365-PLUS-MONTHS                VALUE '2'.
  4947             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4948             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  95
* EL156.cbl
  4949             88  365-DAILY                      VALUE '5'.
  4950
  4951         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4952         16  FILLER                         PIC X(11).
  4953
  4954         16  CF-LIMIT-AMOUNTS.
  4955             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4956             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4957             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4958             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4959             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4960             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4961             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4962             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4963             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4964             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4965
  4966         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4967         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4968         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4969
  4970         16  CF-ZIP-CODE.
  4971             20  CF-ZIP-PRIME.
  4972                 24  CF-ZIP-1ST             PIC X.
  4973                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4974                 24  FILLER                 PIC X(4).
  4975             20  CF-ZIP-PLUS4               PIC X(4).
  4976         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4977             20  CF-CAN-POSTAL-1            PIC XXX.
  4978             20  CF-CAN-POSTAL-2            PIC XXX.
  4979             20  FILLER                     PIC XXX.
  4980
  4981         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4982         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4983         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4984
  4985         16  CF-RATING-SWITCH               PIC X.
  4986             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4987             88  CF-NO-RATING                   VALUE 'N'.
  4988
  4989         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4990
  4991         16  CF-CARRIER-OVER-SHORT.
  4992             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4993             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4994
  4995         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4996         16  CF-SECPAY-SWITCH               PIC X.
  4997             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4998             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4999         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5000         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5001         16  FILLER                         PIC X(444).
  5002*        16  FILLER                         PIC X(452).
  5003
  5004
  5005****************************************************************
  5006*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  96
* EL156.cbl
  5007****************************************************************
  5008
  5009     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5010         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5011                                INDEXED BY CF-MORT-NDX.
  5012             20  CF-MORT-TABLE              PIC X(5).
  5013             20  CF-MORT-TABLE-TYPE         PIC X.
  5014                 88  CF-MORT-JOINT              VALUE 'J'.
  5015                 88  CF-MORT-SINGLE             VALUE 'S'.
  5016                 88  CF-MORT-COMBINED           VALUE 'C'.
  5017                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5018                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5019             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5020             20  CF-MORT-AGE-METHOD         PIC XX.
  5021                 88  CF-AGE-LAST                VALUE 'AL'.
  5022                 88  CF-AGE-NEAR                VALUE 'AN'.
  5023             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5024             20  CF-MORT-ADJUSTMENT-DIRECTION
  5025                                            PIC X.
  5026                 88  CF-MINUS                   VALUE '-'.
  5027                 88  CF-PLUS                    VALUE '+'.
  5028             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5029             20  CF-MORT-JOINT-CODE         PIC X.
  5030                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5031             20  CF-MORT-PC-Q               PIC X.
  5032                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5033             20  CF-MORT-TABLE-CODE         PIC X(4).
  5034             20  CF-MORT-COMMENTS           PIC X(15).
  5035             20  FILLER                     PIC X(14).
  5036
  5037         16  FILLER                         PIC X(251).
  5038
  5039
  5040****************************************************************
  5041*             BUSSINESS TYPE MASTER RECORD                     *
  5042****************************************************************
  5043
  5044     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5045* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5046* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5047* AND RECORD 05 IS TYPES 81-99
  5048         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5049             20  CF-BUSINESS-TITLE          PIC  X(19).
  5050             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5051                                            PIC S9V9(4) COMP-3.
  5052             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5053             20  FILLER                     PIC  X.
  5054         16  FILLER                         PIC  X(248).
  5055
  5056
  5057****************************************************************
  5058*             TERMINAL MASTER RECORD                           *
  5059****************************************************************
  5060
  5061     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5062
  5063         16  CF-COMPANY-TERMINALS.
  5064             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  97
* EL156.cbl
  5065                                  PIC X(4).
  5066         16  FILLER               PIC X(248).
  5067
  5068
  5069****************************************************************
  5070*             LIFE EDIT MASTER RECORD                          *
  5071****************************************************************
  5072
  5073     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5074         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5075             20  CF-LIFE-CODE-IN            PIC XX.
  5076             20  CF-LIFE-CODE-OUT           PIC XX.
  5077         16  FILLER                         PIC X(248).
  5078
  5079
  5080****************************************************************
  5081*             AH EDIT MASTER RECORD                            *
  5082****************************************************************
  5083
  5084     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5085         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5086             20  CF-AH-CODE-IN              PIC XXX.
  5087             20  CF-AH-CODE-OUT             PIC XX.
  5088         16  FILLER                         PIC X(248).
  5089
  5090
  5091****************************************************************
  5092*             CREDIBILITY TABLES                               *
  5093****************************************************************
  5094
  5095     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5096         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5097                             INDEXED BY CF-CRDB-NDX.
  5098             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5099             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5100             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5101         16  FILLER                         PIC  X(332).
  5102
  5103
  5104****************************************************************
  5105*             REPORT CUSTOMIZATION RECORD                      *
  5106****************************************************************
  5107
  5108     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5109         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5110             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5111             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5112             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5113**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5114****       A T-TRANSFER.                                   ****
  5115             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5116
  5117         16  FILLER                         PIC XX.
  5118
  5119         16  CF-CARRIER-CNTL-OPT.
  5120             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5121                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5122                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  98
* EL156.cbl
  5123             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5124                                            PIC X.
  5125         16  CF-GROUP-CNTL-OPT.
  5126             20  CF-GROUP-OPT-SEQ           PIC 9.
  5127                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5128                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5129             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5130                                            PIC X(6).
  5131         16  CF-STATE-CNTL-OPT.
  5132             20  CF-STATE-OPT-SEQ           PIC 9.
  5133                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5134                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5135             20  CF-STATE-SELECT OCCURS 3 TIMES
  5136                                            PIC XX.
  5137         16  CF-ACCOUNT-CNTL-OPT.
  5138             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5139                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5140                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5141             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5142                                            PIC X(10).
  5143         16  CF-BUS-TYP-CNTL-OPT.
  5144             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5145                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5146                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5147             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5148                                            PIC XX.
  5149         16  CF-LF-TYP-CNTL-OPT.
  5150             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5151                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5152                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5153             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5154                                            PIC XX.
  5155         16  CF-AH-TYP-CNTL-OPT.
  5156             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5157                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5158                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5159             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5160                                            PIC XX.
  5161         16  CF-REPTCD1-CNTL-OPT.
  5162             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5163                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5164                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5165             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5166                                            PIC X(10).
  5167         16  CF-REPTCD2-CNTL-OPT.
  5168             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5169                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5170                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5171             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5172                                            PIC X(10).
  5173         16  CF-USER1-CNTL-OPT.
  5174             20  CF-USER1-OPT-SEQ           PIC 9.
  5175                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5176                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5177             20  CF-USER1-SELECT OCCURS 3 TIMES
  5178                                            PIC X(10).
  5179         16  CF-USER2-CNTL-OPT.
  5180             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page  99
* EL156.cbl
  5181                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5182                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5183             20  CF-USER2-SELECT OCCURS 3 TIMES
  5184                                            PIC X(10).
  5185         16  CF-USER3-CNTL-OPT.
  5186             20  CF-USER3-OPT-SEQ           PIC 9.
  5187                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5188                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5189             20  CF-USER3-SELECT OCCURS 3 TIMES
  5190                                            PIC X(10).
  5191         16  CF-USER4-CNTL-OPT.
  5192             20  CF-USER4-OPT-SEQ           PIC 9.
  5193                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5194                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5195             20  CF-USER4-SELECT OCCURS 3 TIMES
  5196                                            PIC X(10).
  5197         16  CF-USER5-CNTL-OPT.
  5198             20  CF-USER5-OPT-SEQ           PIC 9.
  5199                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5200                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5201             20  CF-USER5-SELECT OCCURS 3 TIMES
  5202                                            PIC X(10).
  5203         16  CF-REINS-CNTL-OPT.
  5204             20  CF-REINS-OPT-SEQ           PIC 9.
  5205                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5206                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5207             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5208                 24  CF-REINS-PRIME         PIC XXX.
  5209                 24  CF-REINS-SUB           PIC XXX.
  5210
  5211         16  CF-AGENT-CNTL-OPT.
  5212             20  CF-AGENT-OPT-SEQ           PIC 9.
  5213                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5214                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5215             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5216                                            PIC X(10).
  5217
  5218         16  FILLER                         PIC X(43).
  5219
  5220         16  CF-LOSS-RATIO-SELECT.
  5221             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5222             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5223         16  CF-ENTRY-DATE-SELECT.
  5224             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5225             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5226         16  CF-EFFECTIVE-DATE-SELECT.
  5227             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5228             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5229
  5230         16  CF-EXCEPTION-LIST-IND          PIC X.
  5231             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5232
  5233         16  FILLER                         PIC X(318).
  5234
  5235****************************************************************
  5236*                  EXCEPTION REPORTING RECORD                  *
  5237****************************************************************
  5238
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 100
* EL156.cbl
  5239     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5240         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5241             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5242
  5243         16  CF-COMBINED-LIFE-AH-OPT.
  5244             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5245             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5246             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5247             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5248
  5249         16  CF-LIFE-OPT.
  5250             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5251             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5252             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5253             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5254             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5255             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5256             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5257             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5258             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5259             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5260
  5261         16  CF-AH-OPT.
  5262             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5263             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5264             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5265             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5266             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5267             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5268             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5269             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5270             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5271             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5272
  5273         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5274             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5275             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5276             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5277
  5278         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5279
  5280         16  FILLER                         PIC X(673).
  5281
  5282
  5283****************************************************************
  5284*             MORTGAGE SYSTEM PLAN RECORD                      *
  5285****************************************************************
  5286
  5287     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5288         16  CF-PLAN-TYPE                   PIC X.
  5289             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5290             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5291             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5292         16  CF-PLAN-ABBREV                 PIC XXX.
  5293         16  CF-PLAN-DESCRIPT               PIC X(10).
  5294         16  CF-PLAN-NOTES                  PIC X(20).
  5295         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5296         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 101
* EL156.cbl
  5297             20  CF-PLAN-TERM-DATA.
  5298                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5299                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5300             20  CF-PLAN-AGE-DATA.
  5301                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5302                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5303                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5304             20  CF-PLAN-BENEFIT-DATA.
  5305                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5306                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5307                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5308                                            PIC S9(7)V99  COMP-3.
  5309         16  CF-PLAN-POLICY-FORMS.
  5310             20  CF-POLICY-FORM             PIC X(12).
  5311             20  CF-MASTER-APPLICATION      PIC X(12).
  5312             20  CF-MASTER-POLICY           PIC X(12).
  5313         16  CF-PLAN-RATING.
  5314             20  CF-RATE-CODE               PIC X(5).
  5315             20  CF-SEX-RATING              PIC X.
  5316                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5317                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5318             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5319             20  CF-SUB-STD-TYPE            PIC X.
  5320                 88  CF-PCT-OF-PREM            VALUE '1'.
  5321                 88  CF-PCT-OF-BENE            VALUE '2'.
  5322         16  CF-PLAN-PREM-TOLERANCES.
  5323             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5324             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5325         16  CF-PLAN-PYMT-TOLERANCES.
  5326             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5327             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5328         16  CF-PLAN-MISC-DATA.
  5329             20  FILLER                     PIC X.
  5330             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5331             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5332         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5333         16  CF-PLAN-IND-GRP                PIC X.
  5334             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5335                                                     '1'.
  5336             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5337                                                     '2'.
  5338         16  CF-MIB-SEARCH-SW               PIC X.
  5339             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5340             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5341             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5342             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5343         16  CF-ALPHA-SEARCH-SW             PIC X.
  5344             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5345             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5346             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5347             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5348             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5349             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5350             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5351             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5352             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5353             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5354                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 102
* EL156.cbl
  5355                                                     'X' 'Y' 'Z'.
  5356         16  CF-EFF-DT-RULE-SW              PIC X.
  5357             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5358             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5359             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5360             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5361             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5362         16  FILLER                         PIC X(4).
  5363         16  CF-HEALTH-QUESTIONS            PIC X.
  5364             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5365         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5366         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5367         16  CF-PLAN-SNGL-JNT               PIC X.
  5368             88  CF-COMBINED-PLAN              VALUE 'C'.
  5369             88  CF-JNT-PLAN                   VALUE 'J'.
  5370             88  CF-SNGL-PLAN                  VALUE 'S'.
  5371         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5372         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5373         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5374         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5375         16  CF-RERATE-CNTL                 PIC  X.
  5376             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5377             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5378             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5379             88  CF-AUTO-RECALC                 VALUE '4'.
  5380         16  CF-BENEFIT-TYPE                PIC  X.
  5381             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5382             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5383         16  CF-POLICY-FEE                  PIC S999V99
  5384                                                    COMP-3.
  5385         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5386         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5387         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5388         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5389         16  FILLER                         PIC  X(32).
  5390         16  CF-TERMINATION-FORM            PIC  X(04).
  5391         16  FILLER                         PIC  X(08).
  5392         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5393                                                       COMP-3.
  5394         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5395         16  CF-ISSUE-LETTER                PIC  X(4).
  5396         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5397         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5398             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5399             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5400         16  CF-MP-REFUND-CALC              PIC X.
  5401             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5402             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5403             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5404             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5405             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5406             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5407             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5408             88  CF-MP-REFD-MEAN                VALUE '8'.
  5409         16  CF-ALT-RATE-CODE               PIC  X(5).
  5410
  5411
  5412         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 103
* EL156.cbl
  5413****************************************************************
  5414*             MORTGAGE COMPANY MASTER RECORD                   *
  5415****************************************************************
  5416
  5417     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5418         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5419         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5420             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5421             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5422             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5423             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5424             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5425
  5426         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5427         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5428         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5429         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5430         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5431
  5432         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5433             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5434         16  CF-MP-RECON-USE-IND            PIC X(1).
  5435             88  CF-MP-USE-RECON             VALUE 'Y'.
  5436         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5437             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5438         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5439             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5440             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5441         16  FILLER                         PIC X(1).
  5442         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5443             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5444         16  CF-MORTG-MIB-VERSION           PIC X.
  5445             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5446             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5447             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5448         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5449             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5450                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5451             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5452                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5453             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5454                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5455             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5456                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5457             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5458                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5459             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5460                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5461         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5462         16  FILLER                         PIC X(7).
  5463         16  CF-MORTG-DESTINATION-SYMBOL.
  5464             20  CF-MORTG-MIB-COMM          PIC X(5).
  5465             20  CF-MORTG-MIB-TERM          PIC X(5).
  5466         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5467             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5468         16  FILLER                         PIC X(03).
  5469         16  CF-MP-CHECK-NO-CONTROL.
  5470             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 104
* EL156.cbl
  5471                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5472                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5473                                                ' ' LOW-VALUES.
  5474                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5475                                               VALUE '3'.
  5476         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5477         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5478         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5479             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5480                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5481             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5482                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5483             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5484                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5485             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5486                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5487             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5488                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5489             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5490                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5491         16  CF-MORTG-BILLING-AREA.
  5492             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5493                                            PIC X.
  5494         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5495         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5496         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5497         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5498             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5499             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5500         16  FILLER                         PIC X.
  5501         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5502             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5503             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5504         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5505         16  FILLER                         PIC X(8).
  5506         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5507         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5508         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5509         16  CF-ACH-COMPANY-ID.
  5510             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5511                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5512                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5513                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5514             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5515         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5516             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5517         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5518             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5519             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5520         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5521         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5522         16  FILLER                         PIC X(536).
  5523
  5524****************************************************************
  5525*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5526****************************************************************
  5527
  5528     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 105
* EL156.cbl
  5529         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5530             20  CF-FEMALE-HEIGHT.
  5531                 24  CF-FEMALE-FT           PIC 99.
  5532                 24  CF-FEMALE-IN           PIC 99.
  5533             20  CF-FEMALE-MIN-WT           PIC 999.
  5534             20  CF-FEMALE-MAX-WT           PIC 999.
  5535         16  FILLER                         PIC X(428).
  5536
  5537     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5538         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5539             20  CF-MALE-HEIGHT.
  5540                 24  CF-MALE-FT             PIC 99.
  5541                 24  CF-MALE-IN             PIC 99.
  5542             20  CF-MALE-MIN-WT             PIC 999.
  5543             20  CF-MALE-MAX-WT             PIC 999.
  5544         16  FILLER                         PIC X(428).
  5545******************************************************************
  5546*             AUTOMATIC ACTIVITY RECORD                          *
  5547******************************************************************
  5548     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5549         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5550             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5551             20  CF-SYS-LETTER-ID           PIC X(04).
  5552             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5553             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5554             20  CF-SYS-RESET-SW            PIC X(01).
  5555             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5556             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5557
  5558         16  FILLER                         PIC X(50).
  5559
  5560         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5561             20  CF-USER-ACTIVE-SW          PIC X(01).
  5562             20  CF-USER-LETTER-ID          PIC X(04).
  5563             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5564             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5565             20  CF-USER-RESET-SW           PIC X(01).
  5566             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5567             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5568             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5569
  5570         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 106
* EL156.cbl
  5572*    COPY ELCCERT.
  5573******************************************************************
  5574*                                                                *
  5575*                            ELCCERT.                            *
  5576*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5577*                            VMOD=2.013                          *
  5578*                                                                *
  5579*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5580*                                                                *
  5581*   FILE TYPE = VSAM,KSDS                                        *
  5582*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5583*                                                                *
  5584*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5585*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5586*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5587*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5588*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5589*                                                                *
  5590*   LOG = YES                                                    *
  5591*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5592******************************************************************
  5593*                   C H A N G E   L O G
  5594*
  5595* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5596*-----------------------------------------------------------------
  5597*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5598* EFFECTIVE    NUMBER
  5599*-----------------------------------------------------------------
  5600* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5601* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5602* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5603* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5604* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5605* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5606* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5607* 032612  CR2011110200001  PEMA  AHL CHANGES
  5608* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5609******************************************************************
  5610
  5611 01  CERTIFICATE-MASTER.
  5612     12  CM-RECORD-ID                      PIC XX.
  5613         88  VALID-CM-ID                      VALUE 'CM'.
  5614
  5615     12  CM-CONTROL-PRIMARY.
  5616         16  CM-COMPANY-CD                 PIC X.
  5617         16  CM-CARRIER                    PIC X.
  5618         16  CM-GROUPING.
  5619             20  CM-GROUPING-PREFIX        PIC X(3).
  5620             20  CM-GROUPING-PRIME         PIC X(3).
  5621         16  CM-STATE                      PIC XX.
  5622         16  CM-ACCOUNT.
  5623             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5624             20  CM-ACCOUNT-PRIME          PIC X(6).
  5625         16  CM-CERT-EFF-DT                PIC XX.
  5626         16  CM-CERT-NO.
  5627             20  CM-CERT-PRIME             PIC X(10).
  5628             20  CM-CERT-SFX               PIC X.
  5629
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 107
* EL156.cbl
  5630     12  CM-CONTROL-BY-NAME.
  5631         16  CM-COMPANY-CD-A1              PIC X.
  5632         16  CM-INSURED-LAST-NAME          PIC X(15).
  5633         16  CM-INSURED-INITIALS.
  5634             20  CM-INSURED-INITIAL1       PIC X.
  5635             20  CM-INSURED-INITIAL2       PIC X.
  5636
  5637     12  CM-CONTROL-BY-SSN.
  5638         16  CM-COMPANY-CD-A2              PIC X.
  5639         16  CM-SOC-SEC-NO.
  5640             20  CM-SSN-STATE              PIC XX.
  5641             20  CM-SSN-ACCOUNT            PIC X(6).
  5642             20  CM-SSN-LN3.
  5643                 25  CM-INSURED-INITIALS-A2.
  5644                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5645                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5646                 25 CM-PART-LAST-NAME-A2         PIC X.
  5647
  5648     12  CM-CONTROL-BY-CERT-NO.
  5649         16  CM-COMPANY-CD-A4              PIC X.
  5650         16  CM-CERT-NO-A4                 PIC X(11).
  5651
  5652     12  CM-CONTROL-BY-MEMB.
  5653         16  CM-COMPANY-CD-A5              PIC X.
  5654         16  CM-MEMBER-NO.
  5655             20  CM-MEMB-STATE             PIC XX.
  5656             20  CM-MEMB-ACCOUNT           PIC X(6).
  5657             20  CM-MEMB-LN4.
  5658                 25  CM-INSURED-INITIALS-A5.
  5659                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5660                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5661                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5662
  5663     12  CM-INSURED-PROFILE-DATA.
  5664         16  CM-INSURED-FIRST-NAME.
  5665             20  CM-INSURED-1ST-INIT       PIC X.
  5666             20  FILLER                    PIC X(9).
  5667         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5668         16  CM-INSURED-SEX                PIC X.
  5669             88  CM-SEX-MALE                  VALUE 'M'.
  5670             88  CM-SEX-FEMAL                 VALUE 'F'.
  5671         16  CM-INSURED-JOINT-AGE          PIC 99.
  5672         16  CM-JOINT-INSURED-NAME.
  5673             20  CM-JT-LAST-NAME           PIC X(15).
  5674             20  CM-JT-FIRST-NAME.
  5675                 24  CM-JT-1ST-INIT        PIC X.
  5676                 24  FILLER                PIC X(9).
  5677             20  CM-JT-INITIAL             PIC X.
  5678
  5679     12  CM-LIFE-DATA.
  5680         16  CM-LF-BENEFIT-CD              PIC XX.
  5681         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5682         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5683         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5684         16  CM-LF-DEV-CODE                PIC XXX.
  5685         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5686         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5687         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 108
* EL156.cbl
  5688         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5689         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5690         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5691         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5692         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5693         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5694         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5695         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5696         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5697         16  cm-temp-epiq                  pic xx.
  5698             88  EPIQ-CLASS                  value 'EQ'.
  5699*        16  FILLER                        PIC XX.
  5700
  5701     12  CM-AH-DATA.
  5702         16  CM-AH-BENEFIT-CD              PIC XX.
  5703         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5704         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5705         16  CM-AH-DEV-CODE                PIC XXX.
  5706         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5707         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5708         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5709         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5710         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5711         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5712         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5713         16  CM-AH-PAID-THRU-DT            PIC XX.
  5714             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5715         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5716         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5717         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5718         16  FILLER                        PIC X.
  5719
  5720     12  CM-LOAN-INFORMATION.
  5721         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5722         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5723                                           PIC S9(5)V99  COMP-3.
  5724         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5725         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5726         16  CM-PAY-FREQUENCY              PIC S99.
  5727         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5728         16  CM-RATE-CLASS                 PIC XX.
  5729         16  CM-BENEFICIARY                PIC X(25).
  5730         16  CM-POLICY-FORM-NO             PIC X(12).
  5731         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5732         16  CM-LAST-ADD-ON-DT             PIC XX.
  5733         16  CM-DEDUCTIBLE-AMOUNTS.
  5734             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5735             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5736         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5737             20  CM-RESIDENT-STATE         PIC XX.
  5738             20  CM-RATE-CODE              PIC X(4).
  5739             20  FILLER                    PIC XX.
  5740         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5741             20  CM-LOAN-OFFICER           PIC X(5).
  5742             20  FILLER                    PIC XXX.
  5743         16  CM-CSR-CODE                   PIC XXX.
  5744         16  CM-UNDERWRITING-CODE          PIC X.
  5745             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 109
* EL156.cbl
  5746         16  CM-POST-CARD-IND              PIC X.
  5747         16  CM-NH-INTERFACE-SW            PIC X.
  5748         16  CM-PREMIUM-TYPE               PIC X.
  5749             88  CM-SING-PRM                  VALUE '1'.
  5750             88  CM-O-B-COVERAGE              VALUE '2'.
  5751             88  CM-OPEN-END                  VALUE '3'.
  5752         16  CM-IND-GRP-TYPE               PIC X.
  5753             88  CM-INDIVIDUAL                VALUE 'I'.
  5754             88  CM-GROUP                     VALUE 'G'.
  5755         16  CM-SKIP-CODE                  PIC X.
  5756             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5757             88  SKIP-JULY                    VALUE '1'.
  5758             88  SKIP-AUGUST                  VALUE '2'.
  5759             88  SKIP-SEPTEMBER               VALUE '3'.
  5760             88  SKIP-JULY-AUG                VALUE '4'.
  5761             88  SKIP-AUG-SEPT                VALUE '5'.
  5762             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5763             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5764             88  SKIP-JUNE                    VALUE '8'.
  5765             88  SKIP-JUNE-JULY               VALUE '9'.
  5766             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5767             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5768         16  CM-PAYMENT-MODE               PIC X.
  5769             88  PAY-MONTHLY                  VALUE SPACE.
  5770             88  PAY-WEEKLY                   VALUE '1'.
  5771             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5772             88  PAY-BI-WEEKLY                VALUE '3'.
  5773             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5774         16  CM-LOAN-NUMBER                PIC X(8).
  5775         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5776         16  CM-OLD-LOF                    PIC XXX.
  5777*        16  CM-LOAN-OFFICER               PIC XXX.
  5778         16  CM-REIN-TABLE                 PIC XXX.
  5779         16  CM-SPECIAL-REIN-CODE          PIC X.
  5780         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5781         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5782         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5783
  5784     12  CM-STATUS-DATA.
  5785         16  CM-ENTRY-STATUS               PIC X.
  5786         16  CM-ENTRY-DT                   PIC XX.
  5787
  5788         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5789         16  CM-LF-CANCEL-DT               PIC XX.
  5790         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5791
  5792         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5793         16  CM-LF-DEATH-DT                PIC XX.
  5794         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5795
  5796         16  CM-LF-CURRENT-STATUS          PIC X.
  5797             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5798                                                'M' '4' '5' '9'.
  5799             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5800             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5801             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5802             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5803             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 110
* EL156.cbl
  5804             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5805             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5806             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5807             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5808             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5809             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5810             88  CM-LF-DECLINED               VALUE 'D'.
  5811             88  CM-LF-VOIDED                 VALUE 'V'.
  5812
  5813         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5814         16  CM-AH-CANCEL-DT               PIC XX.
  5815         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5816
  5817         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5818         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5819         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5820
  5821         16  CM-AH-CURRENT-STATUS          PIC X.
  5822             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5823                                                'M' '4' '5' '9'.
  5824             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5825             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5826             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5827             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5828             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5829             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5830             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5831             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5832             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5833             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5834             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5835             88  CM-AH-DECLINED               VALUE 'D'.
  5836             88  CM-AH-VOIDED                 VALUE 'V'.
  5837
  5838         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5839             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5840             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5841             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5842         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5843
  5844         16  CM-ENTRY-BATCH                PIC X(6).
  5845         16  CM-LF-EXIT-BATCH              PIC X(6).
  5846         16  CM-AH-EXIT-BATCH              PIC X(6).
  5847         16  CM-LAST-MONTH-END             PIC XX.
  5848
  5849     12  CM-NOTE-SW                        PIC X.
  5850         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5851         88  CERT-NOTES-PRESENT               VALUE '1'.
  5852         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5853         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5854         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5855         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5856         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5857         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5858     12  CM-COMP-EXCP-SW                   PIC X.
  5859         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5860         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5861     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 111
* EL156.cbl
  5862         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5863         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5864
  5865*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5866     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5867     12  FILLER                            PIC X.
  5868
  5869*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5870     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5871     12  FILLER                            PIC X.
  5872*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5873     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5874
  5875     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5876         88  CERT-ADDED-BATCH                 VALUE ' '.
  5877         88  CERT-ADDED-ONLINE                VALUE '1'.
  5878         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5879         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5880         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5881     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5882         88  CERT-AS-LOADED                   VALUE ' '.
  5883         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5884         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5885         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5886         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5887         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5888         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5889         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5890
  5891     12  CM-ACCOUNT-COMM-PCTS.
  5892         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5893         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5894
  5895     12  CM-USER-FIELD                     PIC X.
  5896     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5897     12  CM-CLP-STATE                      PIC XX.
  5898     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5899     12  CM-USER-RESERVED                  PIC XXX.
  5900     12  FILLER REDEFINES CM-USER-RESERVED.
  5901         16  CM-AH-CLASS-CD                PIC XX.
  5902         16  F                             PIC X.
  5903******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 112
* EL156.cbl
  5905*    COPY ELCTRLR.
  5906******************************************************************
  5907*                                                                *
  5908*                            ELCTRLR.                            *
  5909*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5910*                            VMOD=2.014                          *
  5911*                                                                *
  5912*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5913*                                                                *
  5914*   FILE TYPE = VSAM,KSDS                                        *
  5915*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5916*                                                                *
  5917*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5918*       ALTERNATE INDEX = NONE                                   *
  5919*                                                                *
  5920*   LOG = YES                                                    *
  5921*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5922******************************************************************
  5923*                   C H A N G E   L O G
  5924*
  5925* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5926*-----------------------------------------------------------------
  5927*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5928* EFFECTIVE    NUMBER
  5929*-----------------------------------------------------------------
  5930* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5931* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5932* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5933* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5934* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5935* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5936* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5937* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5938* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5939* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5940* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5941* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5942* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5943* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5944* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5945* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5946* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5947* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5948* 040814    2014030500002  AJRA  ADD ICD CODES
  5949* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5950******************************************************************
  5951 01  ACTIVITY-TRAILERS.
  5952     12  AT-RECORD-ID                    PIC XX.
  5953         88  VALID-AT-ID                       VALUE 'AT'.
  5954
  5955     12  AT-CONTROL-PRIMARY.
  5956         16  AT-COMPANY-CD               PIC X.
  5957         16  AT-CARRIER                  PIC X.
  5958         16  AT-CLAIM-NO                 PIC X(7).
  5959         16  AT-CERT-NO.
  5960             20  AT-CERT-PRIME           PIC X(10).
  5961             20  AT-CERT-SFX             PIC X.
  5962         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 113
* EL156.cbl
  5963             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5964             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5965             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5966             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5967             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5968             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5969             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5970             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5971             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5972             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5973             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5974             88  AT-BENEFICIARY-TRL           VALUE +91.
  5975             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5976             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5977             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5978             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5979
  5980     12  AT-TRAILER-TYPE                 PIC X.
  5981         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5982         88  PAYMENT-TR                       VALUE '2'.
  5983         88  AUTO-PAY-TR                      VALUE '3'.
  5984         88  CORRESPONDENCE-TR                VALUE '4'.
  5985         88  ADDRESS-TR                       VALUE '5'.
  5986         88  GENERAL-INFO-TR                  VALUE '6'.
  5987         88  AUTO-PROMPT-TR                   VALUE '7'.
  5988         88  DENIAL-TR                        VALUE '8'.
  5989         88  INCURRED-CHG-TR                  VALUE '9'.
  5990         88  FORM-CONTROL-TR                  VALUE 'A'.
  5991
  5992     12  AT-RECORDED-DT                  PIC XX.
  5993     12  AT-RECORDED-BY                  PIC X(4).
  5994     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5995
  5996     12  AT-TRAILER-BODY                 PIC X(165).
  5997
  5998     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5999         16  AT-RESERVE-CONTROLS.
  6000             20  AT-MANUAL-SW            PIC X.
  6001                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6002             20  AT-FUTURE-SW            PIC X.
  6003                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6004             20  AT-PTC-SW               PIC X.
  6005                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6006             20  AT-IBNR-SW              PIC X.
  6007                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6008             20  AT-PTC-LF-SW            PIC X.
  6009                 88  AT-LF-PTC-USED          VALUE '1'.
  6010             20  AT-CDT-ACCESS-METHOD    PIC X.
  6011                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6012                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6013                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6014             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6015         16  AT-LAST-COMPUTED-DT         PIC XX.
  6016         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6017         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6018         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6019         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6020         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 114
* EL156.cbl
  6021         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6022         16  AT-EXPENSE-CONTROLS.
  6023             20  AT-EXPENSE-METHOD       PIC X.
  6024                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6025                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6026                 88  PERCENT-OF-PMT           VALUE '3'.
  6027                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6028             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6029             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6030         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6031         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6032
  6033         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6034         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6035
  6036*        16  FILLER                      PIC X(53).
  6037         16  FILLER                      PIC X(47).
  6038
  6039         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6040         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6041
  6042         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6043             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6044             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6045*                    C = CLOSED
  6046*                    O = OPEN
  6047             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6048*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6049
  6050     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6051         16  AT-PAYMENT-TYPE             PIC X.
  6052             88  PARTIAL-PAYMENT                VALUE '1'.
  6053             88  FINAL-PAYMENT                  VALUE '2'.
  6054             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6055             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6056             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6057             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6058             88  VOIDED-PAYMENT                 VALUE '9'.
  6059             88  TRANSFER                       VALUE 'T'.
  6060             88  LIFE-INTEREST                  VALUE 'I'.
  6061
  6062         16  AT-CLAIM-TYPE               PIC X.
  6063             88  PAID-FOR-AH                    VALUE 'A'.
  6064             88  PAID-FOR-LIFE                  VALUE 'L'.
  6065             88  PAID-FOR-IUI                   VALUE 'I'.
  6066             88  PAID-FOR-GAP                   VALUE 'G'.
  6067             88  PAID-FOR-FAM                   VALUE 'F'.
  6068         16  AT-CLAIM-PREM-TYPE          PIC X.
  6069             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6070             88  AT-O-B-COVERAGE                VALUE '2'.
  6071             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6072         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6073         16  AT-CHECK-NO                 PIC X(7).
  6074         16  AT-PAID-FROM-DT             PIC XX.
  6075         16  AT-PAID-THRU-DT             PIC XX.
  6076         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6077         16  FILLER                      PIC X.
  6078         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 115
* EL156.cbl
  6079         16  AT-PAYMENT-ORIGIN           PIC X.
  6080             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6081             88  ONLINE-AUTO-PMT                VALUE '2'.
  6082             88  OFFLINE-PMT                    VALUE '3'.
  6083         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6084         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6085         16  AT-VOID-DATA.
  6086             20  AT-VOID-DT              PIC XX.
  6087*00144       20  AT-VOID-REASON          PIC X(30).
  6088             20  AT-VOID-REASON          PIC X(26).
  6089         16  AT-PMT-APPROVED-BY          PIC X(04).
  6090         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6091         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6092         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6093                                         PIC S99V9(5)  COMP-3.
  6094         16  AT-CREDIT-INTERFACE.
  6095             20  AT-PMT-SELECT-DT        PIC XX.
  6096                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6097             20  AT-PMT-ACCEPT-DT        PIC XX.
  6098                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6099             20  AT-VOID-SELECT-DT       PIC XX.
  6100                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6101             20  AT-VOID-ACCEPT-DT       PIC XX.
  6102                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6103
  6104         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6105                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6106                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6107         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6108
  6109         16  AT-FORCE-CONTROL            PIC X.
  6110             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6111         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6112         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6113         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6114         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6115         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6116         16  AT-BENEFIT-TYPE             PIC X.
  6117
  6118         16  AT-EXPENSE-TYPE             PIC X.
  6119         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6120
  6121         16  AT-PAYEE-TYPE-CD.
  6122             20  AT-PAYEE-TYPE           PIC X.
  6123                 88  INSURED-PAID           VALUE 'I'.
  6124                 88  BENEFICIARY-PAID       VALUE 'B'.
  6125                 88  ACCOUNT-PAID           VALUE 'A'.
  6126                 88  OTHER-1-PAID           VALUE 'O'.
  6127                 88  OTHER-2-PAID           VALUE 'Q'.
  6128                 88  DOCTOR-PAID            VALUE 'P'.
  6129                 88  EMPLOYER-PAID          VALUE 'E'.
  6130             20  AT-PAYEE-SEQ            PIC X.
  6131
  6132         16  AT-CASH-PAYMENT             PIC X.
  6133         16  AT-GROUPED-PAYMENT          PIC X.
  6134         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6135         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6136         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 116
* EL156.cbl
  6137         16  AT-VOID-TYPE                PIC X.
  6138             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6139             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6140         16  AT-AIG-UNEMP-IND            PIC X.
  6141             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6142         16  AT-ASSOCIATES               PIC X.
  6143             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6144             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6145
  6146         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6147         16  AT-CV-PMT-CODE              PIC X.
  6148             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6149             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6150             88  FULL-ADD-PAYMENT           VALUE '3'.
  6151             88  HALF-ADD-PAYMENT           VALUE '4'.
  6152             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6153             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6154             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6155             88  ADDL-PAYMENT               VALUE '8'.
  6156
  6157         16  AT-EOB-CODE1                PIC XXX.
  6158         16  AT-EOB-CODE2                PIC XXX.
  6159         16  AT-EOB-CODE3                PIC XXX.
  6160         16  FILLER REDEFINES AT-EOB-CODE3.
  6161             20  AT-PRINT-CLM-FORM       PIC X.
  6162             20  AT-PRINT-SURVEY         PIC X.
  6163             20  AT-SPECIAL-RELEASE      PIC X.
  6164         16  AT-EOB-CODE4                PIC XXX.
  6165         16  FILLER REDEFINES AT-EOB-CODE4.
  6166             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6167             20  FILLER                  PIC X.
  6168         16  AT-EOB-CODE5                PIC XXX.
  6169         16  FILLER REDEFINES AT-EOB-CODE5.
  6170             20  AT-PMT-PROOF-DT         PIC XX.
  6171             20  FILLER                  PIC X.
  6172
  6173         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6174             88  AT-PRINT-EOB            VALUE 'Y'.
  6175
  6176         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6177         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6178
  6179     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6180         16  AT-SCHEDULE-START-DT        PIC XX.
  6181         16  AT-SCHEDULE-END-DT          PIC XX.
  6182         16  AT-TERMINATED-DT            PIC XX.
  6183         16  AT-LAST-PMT-TYPE            PIC X.
  6184             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6185             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6186         16  AT-FIRST-PMT-DATA.
  6187             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6188             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6189             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6190         16  AT-REGULAR-PMT-DATA.
  6191             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6192             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6193             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6194         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 117
* EL156.cbl
  6195             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6196                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6197                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6198                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6199                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6200                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6201             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6202         16  AT-AUTO-PAY-DAY             PIC 99.
  6203         16  AT-AUTO-CASH                PIC X.
  6204             88  AT-CASH                      VALUE 'Y'.
  6205             88  AT-NON-CASH                  VALUE 'N'.
  6206*        16  FILLER                      PIC X(129).
  6207         16  AT-AUTO-END-LETTER          PIC X(4).
  6208         16  FILLER                      PIC X(125).
  6209
  6210         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6211         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6212
  6213     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6214         16  AT-LETTER-SENT-DT           PIC XX.
  6215         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6216         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6217         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6218         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6219         16  AT-LETTER-ORIGIN            PIC X.
  6220             88  ONLINE-CREATION              VALUE '1' '3'.
  6221             88  OFFLINE-CREATION             VALUE '2' '4'.
  6222             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6223             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6224         16  AT-STD-LETTER-FORM          PIC X(4).
  6225         16  AT-REASON-TEXT              PIC X(70).
  6226         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6227         16  AT-ADDRESEE-TYPE            PIC X.
  6228              88  INSURED-ADDRESEE            VALUE 'I'.
  6229              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6230              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6231              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6232              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6233              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6234              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6235         16  AT-ADDRESSEE-NAME           PIC X(30).
  6236         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6237         16  AT-RESEND-PRINT-DATE        PIC XX.
  6238         16  AT-CORR-SOL-UNSOL           PIC X.
  6239         16  AT-LETTER-PURGED-DT         PIC XX.
  6240*
  6241*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6242*
  6243         16  AT-CSO-REDEFINITION.
  6244             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6245             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6246             20  AT-LETTER-TO-BENE       PIC X(1).
  6247             20  AT-STOP-LETTER-DT       PIC X(2).
  6248             20  FILLER                  PIC X(19).
  6249*             20  FILLER                  PIC X(27).
  6250             20  AT-CSO-LETTER-STATUS    PIC X.
  6251                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6252                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 118
* EL156.cbl
  6253                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6254             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6255             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6256*
  6257*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6258*
  6259*        16  FILLER                      PIC X(26).
  6260*
  6261*        16  AT-DMD-BSR-CODE             PIC X.
  6262*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6263*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6264*
  6265*        16  AT-DMD-LETTER-STATUS        PIC X.
  6266*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6267*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6268*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6269*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6270*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6271
  6272         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6273         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6274
  6275     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6276         16  AT-ADDRESS-TYPE             PIC X.
  6277             88  INSURED-ADDRESS               VALUE 'I'.
  6278             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6279             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6280             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6281             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6282             88  OTHER-ADDRESS-1               VALUE 'O'.
  6283             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6284         16  AT-MAIL-TO-NAME             PIC X(30).
  6285         16  AT-ADDRESS-LINE-1           PIC X(30).
  6286         16  AT-ADDRESS-LINE-2           PIC X(30).
  6287         16  AT-CITY-STATE.
  6288             20  AT-CITY                 PIC X(28).
  6289             20  AT-STATE                PIC XX.
  6290         16  AT-ZIP.
  6291             20  AT-ZIP-CODE.
  6292                 24  AT-ZIP-1ST          PIC X.
  6293                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6294                 24  FILLER              PIC X(4).
  6295             20  AT-ZIP-PLUS4            PIC X(4).
  6296         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6297             20  AT-CAN-POSTAL-1         PIC XXX.
  6298             20  AT-CAN-POSTAL-2         PIC XXX.
  6299             20  FILLER                  PIC XXX.
  6300         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6301*         16  FILLER                      PIC X(23).
  6302         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6303         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6304         16  FILLER                      PIC X(13).
  6305         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6306         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6307
  6308     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6309         16  AT-INFO-LINE-1              PIC X(60).
  6310         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 119
* EL156.cbl
  6311             20  AT-NOTE-ERROR-NO OCCURS 15
  6312                                         PIC X(4).
  6313         16  AT-INFO-LINE-2              PIC X(60).
  6314         16  FILLER REDEFINES AT-INFO-LINE-2.
  6315             20  AT-ICD-CODE-1           PIC X(8).
  6316             20  AT-ICD-CODE-2           PIC X(8).
  6317             20  FILLER                  PIC X(44).
  6318         16  AT-INFO-TRAILER-TYPE        PIC X.
  6319             88  AT-ERRORS-NOTE          VALUE 'E'.
  6320             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6321             88  AT-CALL-NOTE            VALUE 'C'.
  6322             88  AT-MAINT-NOTE           VALUE 'M'.
  6323             88  AT-CERT-CHANGE          VALUE 'X'.
  6324             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6325             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6326             88  AT-CERT-CANCELLED       VALUE 'T'.
  6327         16  AT-CALL-TYPE                PIC X.
  6328             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6329             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6330         16  AT-NOTE-CONTINUATION        PIC X.
  6331             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6332         16  AT-EOB-CODES-EXIST          PIC X.
  6333             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6334         16  FILLER                      PIC X(35).
  6335         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6336         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6337
  6338     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6339         16  AT-PROMPT-LINE-1            PIC X(60).
  6340         16  AT-PROMPT-LINE-2            PIC X(60).
  6341         16  AT-PROMPT-START-DT          PIC XX.
  6342         16  AT-PROMPT-END-DT            PIC XX.
  6343         16  FILLER                      PIC X(35).
  6344         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6345         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6346
  6347     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6348         16  AT-DENIAL-INFO-1            PIC X(60).
  6349         16  AT-DENIAL-INFO-2            PIC X(60).
  6350         16  AT-DENIAL-DT                PIC XX.
  6351         16  AT-RETRACTION-DT            PIC XX.
  6352         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6353*         16  FILLER                      PIC X(31).
  6354         16  AT-DENIAL-PROOF-DT          PIC XX.
  6355         16  FILLER                      PIC X(29).
  6356         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6357         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6358
  6359     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6360         16  AT-OLD-INCURRED-DT          PIC XX.
  6361         16  AT-OLD-REPORTED-DT          PIC XX.
  6362         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6363         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6364         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6365         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6366         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6367         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6368         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 120
* EL156.cbl
  6369         16  AT-OLD-DIAG-CODE            PIC X(6).
  6370         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6371         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6372         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6373         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6374         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6375         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6376         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6377         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6378         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6379         16  FILLER                      PIC X(9).
  6380         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6381
  6382     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6383         16  AT-FORM-SEND-ON-DT          PIC XX.
  6384         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6385         16  AT-FORM-RE-SEND-DT          PIC XX.
  6386         16  AT-FORM-ANSWERED-DT         PIC XX.
  6387         16  AT-FORM-PRINTED-DT          PIC XX.
  6388         16  AT-FORM-REPRINT-DT          PIC XX.
  6389         16  AT-FORM-TYPE                PIC X.
  6390             88  INITIAL-FORM                  VALUE '1'.
  6391             88  PROGRESS-FORM                 VALUE '2'.
  6392         16  AT-INSTRUCT-LN-1            PIC X(28).
  6393         16  AT-INSTRUCT-LN-2            PIC X(28).
  6394         16  AT-INSTRUCT-LN-3            PIC X(28).
  6395         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6396         16  AT-FORM-ADDRESS             PIC X.
  6397             88  FORM-TO-INSURED              VALUE 'I'.
  6398             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6399             88  FORM-TO-OTHER-1              VALUE 'O'.
  6400             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6401         16  AT-RELATED-1.
  6402             20 AT-REL-CARR-1            PIC X.
  6403             20 AT-REL-CLAIM-1           PIC X(7).
  6404             20 AT-REL-CERT-1            PIC X(11).
  6405         16  AT-RELATED-2.
  6406             20 AT-REL-CARR-2            PIC X.
  6407             20 AT-REL-CLAIM-2           PIC X(7).
  6408             20 AT-REL-CERT-2            PIC X(11).
  6409         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6410         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6411         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6412         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6413         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6414         16  AT-STOP-FORM-DT             PIC X(2).
  6415
  6416         16  FILLER                      PIC X(09).
  6417         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6418         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6419******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 121
* EL156.cbl
  6421*    COPY ELCACTQ.
  6422******************************************************************
  6423*                                                                *
  6424*                            ELCACTQ.                            *
  6425*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6426*                            VMOD=2.004                          *
  6427*                                                                *
  6428*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6429*                                                                *
  6430*   FILE TYPE = VSAM,KSDS                                        *
  6431*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6432*                                                                *
  6433*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6434*       ALTERNATE INDEX = NONE                                   *
  6435*                                                                *
  6436*   LOG = YES                                                    *
  6437*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6438*                                                                *
  6439*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6440******************************************************************
  6441
  6442 01  ACTIVITY-QUE.
  6443     12  AQ-RECORD-ID                PIC XX.
  6444         88  VALID-AQ-ID                VALUE 'AQ'.
  6445
  6446     12  AQ-CONTROL-PRIMARY.
  6447         16  AQ-COMPANY-CD           PIC X.
  6448         16  AQ-CARRIER              PIC X.
  6449         16  AQ-CLAIM-NO             PIC X(7).
  6450         16  AQ-CERT-NO.
  6451             20  AQ-CERT-PRIME       PIC X(10).
  6452             20  AQ-CERT-SFX         PIC X.
  6453
  6454     12  AQ-PENDING-ACTIVITY-FLAGS.
  6455         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6456         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6457             88  PENDING-PAYMENTS       VALUE '1'.
  6458         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6459             88  PENDING-FULL-PRINT     VALUE '1'.
  6460             88  PENDING-PART-PRINT     VALUE '2'.
  6461         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6462             88  PENDING-LETTERS        VALUE '1'.
  6463         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6464             88  PENDING-RESTORE        VALUE 'C'.
  6465             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6466
  6467     12  FILLER                      PIC X(20).
  6468
  6469     12  AQ-RESEND-DATE              PIC XX.
  6470     12  AQ-FOLLOWUP-DATE            PIC XX.
  6471     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6472     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6473     12  AQ-AUTO-LETTER              PIC X(4).
  6474     12  FILLER                      PIC XX.
  6475     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6476*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 122
* EL156.cbl
  6478*    COPY ERCACCT.
  6479******************************************************************
  6480*                                                                *
  6481*                                                                *
  6482*                            ERCACCT                             *
  6483*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6484*                            VMOD=2.031                          *
  6485*                                                                *
  6486*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6487*                                                                *
  6488*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6489*   VSAM ACCOUNT MASTER FILES.                                   *
  6490*                                                                *
  6491*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6492*                                                                *
  6493*   FILE TYPE = VSAM,KSDS                                        *
  6494*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6495*                                                                *
  6496*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6497*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6498*                                                                *
  6499*   LOG = NO                                                     *
  6500*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6501*                                                                *
  6502*                                                                *
  6503******************************************************************
  6504*                   C H A N G E   L O G
  6505*
  6506* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6507*-----------------------------------------------------------------
  6508*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6509* EFFECTIVE    NUMBER
  6510*-----------------------------------------------------------------
  6511* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6512* 092705    2005050300006  PEMA  ADD SPP LEASES
  6513* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6514* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6515* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6516* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6517* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6518******************************************************************
  6519
  6520 01  ACCOUNT-MASTER.
  6521     12  AM-RECORD-ID                      PIC XX.
  6522         88  VALID-AM-ID                      VALUE 'AM'.
  6523
  6524     12  AM-CONTROL-PRIMARY.
  6525         16  AM-COMPANY-CD                 PIC X.
  6526         16  AM-MSTR-CNTRL.
  6527             20  AM-CONTROL-A.
  6528                 24  AM-CARRIER            PIC X.
  6529                 24  AM-GROUPING.
  6530                     28 AM-GROUPING-PREFIX PIC XXX.
  6531                     28 AM-GROUPING-PRIME  PIC XXX.
  6532                 24  AM-STATE              PIC XX.
  6533                 24  AM-ACCOUNT.
  6534                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6535                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 123
* EL156.cbl
  6536             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6537                                           PIC X(19).
  6538             20  AM-CNTRL-B.
  6539                 24  AM-EXPIRATION-DT      PIC XX.
  6540                 24  FILLER                PIC X(4).
  6541             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6542                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6543
  6544     12  AM-CONTROL-BY-VAR-GRP.
  6545         16  AM-COMPANY-CD-A1              PIC X.
  6546         16  AM-VG-CARRIER                 PIC X.
  6547         16  AM-VG-GROUPING                PIC X(6).
  6548         16  AM-VG-STATE                   PIC XX.
  6549         16  AM-VG-ACCOUNT                 PIC X(10).
  6550         16  AM-VG-DATE.
  6551             20  AM-VG-EXPIRATION-DT       PIC XX.
  6552             20  FILLER                    PIC X(4).
  6553         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6554                                           PIC 9(11)      COMP-3.
  6555     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6556         16  FILLER                        PIC X(10).
  6557         16  AM-VG-KEY3.
  6558             20  AM-VG3-ACCOUNT            PIC X(10).
  6559             20  AM-VG3-EXP-DT             PIC XX.
  6560         16  FILLER                        PIC X(4).
  6561     12  AM-MAINT-INFORMATION.
  6562         16  AM-LAST-MAINT-DT              PIC XX.
  6563         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6564         16  AM-LAST-MAINT-USER            PIC X(4).
  6565         16  FILLER                        PIC XX.
  6566
  6567     12  AM-EFFECTIVE-DT                   PIC XX.
  6568     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6569
  6570     12  AM-PREV-DATES  COMP-3.
  6571         16  AM-PREV-EXP-DT                PIC 9(11).
  6572         16  AM-PREV-EFF-DT                PIC 9(11).
  6573
  6574     12  AM-REPORT-CODE-1                  PIC X(10).
  6575     12  AM-REPORT-CODE-2                  PIC X(10).
  6576
  6577     12  AM-CITY-CODE                      PIC X(4).
  6578     12  AM-COUNTY-PARISH                  PIC X(6).
  6579
  6580     12  AM-NAME                           PIC X(30).
  6581     12  AM-PERSON                         PIC X(30).
  6582     12  AM-ADDRS                          PIC X(30).
  6583     12  AM-CITY.
  6584         16  AM-ADDR-CITY                  PIC X(28).
  6585         16  AM-ADDR-STATE                 PIC XX.
  6586     12  AM-ZIP.
  6587         16  AM-ZIP-PRIME.
  6588             20  AM-ZIP-PRI-1ST            PIC X.
  6589                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6590             20  FILLER                    PIC X(4).
  6591         16  AM-ZIP-PLUS4                  PIC X(4).
  6592     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6593         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 124
* EL156.cbl
  6594         16  AM-CAN-POSTAL-2               PIC XXX.
  6595         16  FILLER                        PIC XXX.
  6596     12  AM-TEL-NO.
  6597         16  AM-AREA-CODE                  PIC 999.
  6598         16  AM-TEL-PRE                    PIC 999.
  6599         16  AM-TEL-NBR                    PIC 9(4).
  6600     12  AM-TEL-LOC                        PIC X.
  6601         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6602         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6603
  6604     12  AM-COMM-STRUCTURE.
  6605         16  AM-DEFN-1.
  6606             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6607                 24  AM-AGT.
  6608                     28  AM-AGT-PREFIX     PIC X(4).
  6609                     28  AM-AGT-PRIME      PIC X(6).
  6610                 24  AM-COM-TYP            PIC X.
  6611                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6612                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6613                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6614                 24  AM-RECALC-LV-INDIC    PIC X.
  6615                 24  AM-RETRO-LV-INDIC     PIC X.
  6616                 24  AM-GL-CODES           PIC X.
  6617                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6618                 24  FILLER                PIC X(01).
  6619         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6620             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6621                 24  FILLER                PIC X(11).
  6622                 24  AM-L-COMA             PIC XXX.
  6623                 24  AM-J-COMA             PIC XXX.
  6624                 24  AM-A-COMA             PIC XXX.
  6625                 24  FILLER                PIC X(6).
  6626
  6627     12  AM-COMM-CHANGE-STATUS             PIC X.
  6628         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6629
  6630     12  AM-CSR-CODE                       PIC X(4).
  6631
  6632     12  AM-BILLING-STATUS                 PIC X.
  6633         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6634         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6635     12  AM-AUTO-REFUND-SW                 PIC X.
  6636         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6637         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6638     12  AM-GPCD                           PIC 99.
  6639     12  AM-IG                             PIC X.
  6640         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6641         88  AM-HAS-GROUP                     VALUE '2'.
  6642     12  AM-STATUS                         PIC X.
  6643         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6644         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6645         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6646         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6647         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6648         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6649     12  AM-REMIT-TO                       PIC 99.
  6650     12  AM-ID-NO                          PIC X(11).
  6651
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 125
* EL156.cbl
  6652     12  AM-CAL-TABLE                      PIC XX.
  6653     12  AM-LF-DEVIATION                   PIC XXX.
  6654     12  AM-AH-DEVIATION                   PIC XXX.
  6655     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6656     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6657     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6658     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6659     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6660     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6661
  6662     12  AM-USER-FIELDS.
  6663         16  AM-FLD-1                      PIC XX.
  6664         16  AM-FLD-2                      PIC XX.
  6665         16  AM-FLD-3                      PIC XX.
  6666         16  AM-FLD-4                      PIC XX.
  6667         16  AM-FLD-5                      PIC XX.
  6668
  6669     12  AM-1ST-PROD-DATE.
  6670         16  AM-1ST-PROD-YR                PIC XX.
  6671         16  AM-1ST-PROD-MO                PIC XX.
  6672         16  AM-1ST-PROD-DA                PIC XX.
  6673     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6674     12  AM-CERTS-PURGED-DATE.
  6675         16  AM-PUR-YR                     PIC XX.
  6676         16  AM-PUR-MO                     PIC XX.
  6677         16  AM-PUR-DA                     PIC XX.
  6678     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6679     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6680     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6681     12  AM-INACTIVE-DATE.
  6682         16  AM-INA-MO                     PIC 99.
  6683         16  AM-INA-DA                     PIC 99.
  6684         16  AM-INA-YR                     PIC 99.
  6685     12  AM-AR-HI-CERT-DATE                PIC XX.
  6686
  6687     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6688     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6689
  6690     12  AM-OB-PAYMENT-MODE                PIC X.
  6691         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6692         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6693         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6694         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6695
  6696     12  AM-AH-ONLY-INDICATOR              PIC X.
  6697         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6698         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6699
  6700     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6701
  6702     12  AM-OVER-SHORT.
  6703         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6704         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6705
  6706     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6707     12  AM-DCC-CLP-STATE                  PIC XX.
  6708
  6709     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 126
* EL156.cbl
  6710     12  AM-RECALC-REIN                    PIC X.
  6711
  6712     12  AM-REI-TABLE                      PIC XXX.
  6713     12  AM-REI-ET-LF                      PIC X.
  6714     12  AM-REI-ET-AH                      PIC X.
  6715     12  AM-REI-PE-LF                      PIC X.
  6716     12  AM-REI-PE-AH                      PIC X.
  6717     12  AM-REI-PRT-ST                     PIC X.
  6718     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6719     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6720     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6721     12  AM-REI-GROUP-A                    PIC X(6).
  6722     12  AM-REI-MORT                       PIC X(4).
  6723     12  AM-REI-PRT-OW                     PIC X.
  6724     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6725     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6726     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6727     12  AM-REI-GROUP-B                    PIC X(6).
  6728
  6729     12  AM-TRUST-TYPE                     PIC X(2).
  6730
  6731     12  AM-EMPLOYER-STMT-USED             PIC X.
  6732     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6733
  6734     12  AM-STD-AH-TYPE                    PIC XX.
  6735     12  AM-EARN-METHODS.
  6736         16  AM-EARN-METHOD-R              PIC X.
  6737             88 AM-REF-RL-R78                 VALUE 'R'.
  6738             88 AM-REF-RL-PR                  VALUE 'P'.
  6739             88 AM-REF-RL-MEAN                VALUE 'M'.
  6740             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6741         16  AM-EARN-METHOD-L              PIC X.
  6742             88 AM-REF-LL-R78                 VALUE 'R'.
  6743             88 AM-REF-LL-PR                  VALUE 'P'.
  6744             88 AM-REF-LL-MEAN                VALUE 'M'.
  6745             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6746         16  AM-EARN-METHOD-A              PIC X.
  6747             88 AM-REF-AH-R78                 VALUE 'R'.
  6748             88 AM-REF-AH-PR                  VALUE 'P'.
  6749             88 AM-REF-AH-MEAN                VALUE 'M'.
  6750             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6751             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6752             88 AM-REF-AH-NET                 VALUE 'N'.
  6753
  6754     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6755     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6756     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6757
  6758     12  AM-RET-Y-N                        PIC X.
  6759     12  AM-RET-P-E                        PIC X.
  6760     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6761     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6762     12  AM-RET-GRP                        PIC X(6).
  6763     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6764         16  AM-POOL-PRIME                 PIC XXX.
  6765         16  AM-POOL-SUB                   PIC XXX.
  6766     12  AM-RETRO-EARNINGS.
  6767         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 127
* EL156.cbl
  6768         16  AM-RET-EARN-L                 PIC X.
  6769         16  AM-RET-EARN-A                 PIC X.
  6770     12  AM-RET-ST-TAX-USE                 PIC X.
  6771         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6772         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6773     12  AM-RETRO-BEG-EARNINGS.
  6774         16  AM-RET-BEG-EARN-R             PIC X.
  6775         16  AM-RET-BEG-EARN-L             PIC X.
  6776         16  AM-RET-BEG-EARN-A             PIC X.
  6777     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6778     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6779
  6780     12  AM-USER-SELECT-OPTIONS.
  6781         16  AM-USER-SELECT-1              PIC X(10).
  6782         16  AM-USER-SELECT-2              PIC X(10).
  6783         16  AM-USER-SELECT-3              PIC X(10).
  6784         16  AM-USER-SELECT-4              PIC X(10).
  6785         16  AM-USER-SELECT-5              PIC X(10).
  6786
  6787     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6788
  6789     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6790
  6791     12  AM-RPT045A-SWITCH                 PIC X.
  6792         88  RPT045A-OFF                   VALUE 'N'.
  6793
  6794     12  AM-INSURANCE-LIMITS.
  6795         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6796         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6797
  6798     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6799         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6800
  6801     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6802         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6803         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6804
  6805     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6806
  6807     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6808     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6809     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6810     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6811     12  AM-DCC-UEF-STATE                  PIC XX.
  6812     12  FILLER                            PIC XXX.
  6813     12  AM-REPORT-CODE-3                  PIC X(10).
  6814*    12  FILLER                            PIC X(22).
  6815
  6816     12  AM-RESERVE-DATE.
  6817         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6818         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6819         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6820
  6821     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6822     12  AM-NOTIFICATION-TYPES.
  6823         16  AM-NOTIF-OF-LETTERS           PIC X.
  6824         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6825         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 128
* EL156.cbl
  6826         16  AM-NOTIF-OF-STATUS            PIC X.
  6827
  6828     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6829         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6830         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6831         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6832         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6833
  6834     12  AM-BENEFIT-CONTROLS.
  6835         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6836             20  AM-BENEFIT-CODE           PIC XX.
  6837             20  AM-BENEFIT-TYPE           PIC X.
  6838             20  AM-BENEFIT-REVISION       PIC XXX.
  6839             20  AM-BENEFIT-REM-TERM       PIC X.
  6840             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6841             20  FILLER                    PIC XX.
  6842         16  FILLER                        PIC X(80).
  6843
  6844     12  AM-TRANSFER-DATA.
  6845         16  AM-TRANSFERRED-FROM.
  6846             20  AM-TRNFROM-CARRIER        PIC X.
  6847             20  AM-TRNFROM-GROUPING.
  6848                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6849                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6850             20  AM-TRNFROM-STATE          PIC XX.
  6851             20  AM-TRNFROM-ACCOUNT.
  6852                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6853                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6854             20  AM-TRNFROM-DTE            PIC XX.
  6855         16  AM-TRANSFERRED-TO.
  6856             20  AM-TRNTO-CARRIER          PIC X.
  6857             20  AM-TRNTO-GROUPING.
  6858                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6859                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6860             20  AM-TRNTO-STATE            PIC XX.
  6861             20  AM-TRNTO-ACCOUNT.
  6862                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6863                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6864             20  AM-TRNTO-DTE              PIC XX.
  6865         16  FILLER                        PIC X(10).
  6866
  6867     12  AM-SAVED-REMIT-TO                 PIC 99.
  6868
  6869     12  AM-COMM-STRUCTURE-SAVED.
  6870         16  AM-DEFN-1-SAVED.
  6871             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6872                 24  AM-AGT-SV             PIC X(10).
  6873                 24  AM-COM-TYP-SV         PIC X.
  6874                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6875                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6876                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6877                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6878                 24  FILLER                PIC X.
  6879                 24  AM-GL-CODES-SV        PIC X.
  6880                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6881                 24  FILLER                PIC X.
  6882         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6883             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 129
* EL156.cbl
  6884                 24  FILLER                PIC X(11).
  6885                 24  AM-L-COMA-SV          PIC XXX.
  6886                 24  AM-J-COMA-SV          PIC XXX.
  6887                 24  AM-A-COMA-SV          PIC XXX.
  6888                 24  FILLER                PIC X(6).
  6889
  6890     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6891         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6892            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6893            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6894            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6895
  6896     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6897     12  FILLER                            PIC X(120).
  6898
  6899     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6900         16  AM-CONTROL-NAME               PIC X(30).
  6901         16  AM-EXECUTIVE-ONE.
  6902             20  AM-EXEC1-NAME             PIC X(15).
  6903             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6904                                                          COMP-3.
  6905             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6906                                                          COMP-3.
  6907         16  AM-EXECUTIVE-TWO.
  6908             20  AM-EXEC2-NAME             PIC X(15).
  6909             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6910                                                          COMP-3.
  6911             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6912                                                          COMP-3.
  6913
  6914     12  AM-RETRO-ADDITIONAL-DATA.
  6915         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6916         16  AM-RETRO-PREM-P-E             PIC X.
  6917         16  AM-RETRO-CLMS-P-I             PIC X.
  6918         16  AM-RETRO-RET-BRACKET-LF.
  6919             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6920                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6921                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6922             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6923                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6924                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6925             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6926                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6927                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6928         16  AM-RETRO-RET-BRACKET-AH.
  6929             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6930                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6931                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6932                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6933             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6934                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6935                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6936             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6937                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6938                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6939
  6940     12  AM-COMMENTS.
  6941         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 130
* EL156.cbl
  6942
  6943     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6944         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6945         16  AM-FLI-BILLING-CODE           PIC X.
  6946         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6947         16  AM-FLI-UNITED-IDENT           PIC X.
  6948         16  AM-FLI-INTEREST-LOST-DATA.
  6949             20  AM-FLI-BANK-NO            PIC X(5).
  6950             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6951             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6952             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6953         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6954             20  AM-FLI-AGT                PIC X(9).
  6955             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6956             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6957         16  FILLER                        PIC X(102).
  6958
  6959     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6960         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6961             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6962             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6963             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6964             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6965             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6966         16  FILLER                          PIC X(10).
  6967******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 131
* EL156.cbl
  6969*    COPY ELCCHKQ.
  6970******************************************************************
  6971*                                                                *
  6972*                                                                *
  6973*                            ELCCHKQ.                            *
  6974*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6975*                            VMOD=2.007                          *
  6976*                                                                *
  6977*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6978*                                                                *
  6979*   FILE TYPE = VSAM,KSDS                                        *
  6980*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6981*                                                                *
  6982*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6983*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6984*                                                                *
  6985*   LOG = YES                                                    *
  6986*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6987******************************************************************
  6988 01  CHECK-QUE.
  6989     12  CQ-RECORD-ID                PIC XX.
  6990         88  VALID-CQ-ID         VALUE 'CQ'.
  6991
  6992     12  CQ-CONTROL-PRIMARY.
  6993         16  CQ-COMPANY-CD           PIC X.
  6994         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6995         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6996
  6997     12  CQ-CONTROL-BY-PAYEE.
  6998         16  CQ-CONTROL-BY-NUMBER.
  6999             20  CQ-COMPANY-CD-A1     PIC X.
  7000             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7001         16  CQ-PAYEE-CARRIER        PIC X.
  7002         16  CQ-PAYEE-GROUPING       PIC X(6).
  7003         16  CQ-PAYEE-STATE          PIC XX.
  7004         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7005         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7006
  7007     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7008         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7009         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7010         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7011         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7012         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7013         16  FILLER                  PIC X(3).
  7014
  7015     12  CQ-ENTRY-TYPE               PIC X.
  7016             88  CHECK-ON-QUE           VALUE 'Q'.
  7017             88  ALIGNMENT-CHECK        VALUE 'A'.
  7018             88  SPOILED-CHECK          VALUE 'S'.
  7019             88  PAYMENT-ABORTED        VALUE 'X'.
  7020
  7021     12  CQ-CLAIM-MAST-CNTL.
  7022         16  CQ-CARRIER              PIC X.
  7023         16  CQ-CLAIM-NO             PIC X(7).
  7024         16  CQ-CERT-NO.
  7025             20  CQ-CERT-PRIME       PIC X(10).
  7026             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 132
* EL156.cbl
  7027         16  CQ-CLAIM-TYPE           PIC X.
  7028             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7029             88  CQ-AH-CLAIM            VALUE 'A'.
  7030         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7031             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7032             88  CQ-O-B-COVERAGE        VALUE '2'.
  7033             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7034
  7035     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7036     12  CQ-CHECK-NUMBER             PIC X(7).
  7037     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7038     12  CQ-PAYMENT-TYPE             PIC X.
  7039             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7040             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7041             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7042             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7043             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7044             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7045             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7046             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7047     12  CQ-VOID-INDICATOR           PIC X.
  7048             88  CHECK-IS-STOPPED          VALUE 'S'.
  7049             88  CHECK-IS-VOID             VALUE 'V'.
  7050     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7051     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7052     12  CQ-CHECK-BY-USER            PIC X(4).
  7053     12  CQ-PRE-NUMBERING-SW         PIC X.
  7054       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7055       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7056
  7057     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7058     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7059     12  CQ-LEDGER-FLAG              PIC X(01).
  7060     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7061     12  CQ-LAST-UPDATED-DT          PIC XX.
  7062     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7063     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7064
  7065     12  FILLER                      PIC X(04).
  7066
  7067******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 133
* EL156.cbl
  7069*    COPY ELCBENE.
  7070******************************************************************
  7071*                                                                *
  7072*                            ELCBENE.                            *
  7073*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7074*                            VMOD=2.006                          *
  7075*                                                                *
  7076*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7077*                                                                *
  7078*   FILE TYPE = VSAM,KSDS                                        *
  7079*   RECORD SIZE = 500   RECFORM = FIX                            *
  7080*                                                                *
  7081*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7082*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7083*                                                                *
  7084*   LOG = YES                                                    *
  7085*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7086*                                                                *
  7087*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7088******************************************************************
  7089
  7090 01  BENEFICIARY-MASTER.
  7091     12  BE-RECORD-ID                PIC XX.
  7092         88  VALID-BE-ID                VALUE 'BE'.
  7093
  7094     12  BE-CONTROL-PRIMARY.
  7095         16  BE-COMPANY-CD           PIC X.
  7096         16  BE-RECORD-TYPE          PIC X.
  7097             88  BENEFICIARY-RECORD  VALUE 'B'.
  7098             88  ADJUSTOR-RECORD     VALUE 'A'.
  7099         16  BE-BENEFICIARY          PIC X(10).
  7100     12  BE-CONTROL-BY-NAME.
  7101         16  BE-COMPANY-CD-A1        PIC X.
  7102         16  BE-RECORD-TYPE-A1       PIC X.
  7103         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7104         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7105
  7106     12  BE-LAST-MAINT-DT            PIC XX.
  7107     12  BE-LAST-MAINT-BY            PIC X(4).
  7108     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7109
  7110     12  BE-ADDRESS-DATA.
  7111         16  BE-MAIL-TO-NAME         PIC X(30).
  7112         16  BE-ADDRESS-LINE-1       PIC X(30).
  7113         16  BE-ADDRESS-LINE-2       PIC X(30).
  7114         16  BE-ADDRESS-LINE-3       PIC X(30).
  7115         16  BE-CITY-STATE.
  7116             20  BE-CITY             PIC X(28).
  7117             20  BE-STATE            PIC XX.
  7118         16  BE-ZIP-CODE.
  7119             20  BE-ZIP-PRIME.
  7120                 24  BE-ZIP-1ST      PIC X.
  7121                     88  BE-CANADIAN-POST-CODE
  7122                                         VALUE 'A' THRU 'Z'.
  7123                 24  FILLER          PIC X(4).
  7124             20  BE-ZIP-PLUS4        PIC X(4).
  7125         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7126             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 134
* EL156.cbl
  7127             20  BE-CAN-POSTAL-2     PIC XXX.
  7128             20  FILLER              PIC XXX.
  7129         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7130         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7131
  7132******************************************************************
  7133*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7134*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7135******************************************************************
  7136     12  BE-CARRIER                  PIC X.
  7137
  7138     12  BE-ADDRESS-DATA2.
  7139         16  BE-MAIL-TO-NAME2        PIC X(30).
  7140         16  BE-ADDRESS-LINE-12      PIC X(30).
  7141         16  BE-ADDRESS-LINE-22      PIC X(30).
  7142         16  BE-ADDRESS-LINE-32      PIC X(30).
  7143         16  BE-CITY-STATE2.
  7144             20  BE-CITY2            PIC X(28).
  7145             20  BE-STATE2           PIC XX.
  7146         16  BE-ZIP-CODE2.
  7147             20  BE-ZIP-PRIME2.
  7148                 24  BE-ZIP-1ST2     PIC X.
  7149                     88  BE-CANADIAN-POST-CODE2
  7150                                         VALUE 'A' THRU 'Z'.
  7151                 24  FILLER          PIC X(4).
  7152             20  BE-ZIP-PLUS42       PIC X(4).
  7153         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7154             20  BE-CAN-POSTAL-12    PIC XXX.
  7155             20  BE-CAN-POSTAL-22    PIC XXX.
  7156             20  FILLER              PIC XXX.
  7157         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7158         16  BE-BILLING-STMT-DATA.
  7159             20  BE-BSR              PIC X.
  7160                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7161                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7162             20  BE-BSR-FROM         PIC X(30).
  7163             20  BE-BSR-DEPT         PIC X(30).
  7164             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7165             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7166             20  BE-OUTPUT-TYPE      PIC X.
  7167                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7168                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7169
  7170     12  FILLER                      PIC X(28).
  7171******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 135
* EL156.cbl
  7173*    COPY ELCARCH.
  7174******************************************************************
  7175*                                                                *
  7176*                            ELCARCH.                            *
  7177*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7178*                            VMOD=2.007                          *
  7179*                                                                *
  7180*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7181*                                                                *
  7182*   FILE TYPE = VSAM,KSDS                                        *
  7183*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7184*                                                                *
  7185*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7186*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7187*                                                                *
  7188*   LOG = NO                                                     *
  7189*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7190*                                                                *
  7191*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7192******************************************************************
  7193 01  LETTER-ARCHIVE.
  7194     12  LA-RECORD-ID                PIC XX.
  7195         88  VALID-LA-ID                VALUE 'LA'.
  7196
  7197     12  LA-CONTROL-PRIMARY.
  7198         16  LA-COMPANY-CD           PIC X.
  7199         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7200         16  LA-RECORD-TYPE          PIC X.
  7201             88  LA-HEADER-DATA         VALUE '1'.
  7202             88  LA-ADDRESS-DATA        VALUE '2'.
  7203             88  LA-TEXT-DATA           VALUE '3'.
  7204             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7205         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7206
  7207     12  LA-CONTROL-BY-TYPE.
  7208         16  LA-COMPANY-CD-A1        PIC X.
  7209         16  LA-RECORD-TYPE-A1       PIC X.
  7210         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7211         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7212
  7213     12  LA-TEXT-RECORD.
  7214         16  LA-SKIP-CONTROL         PIC XX.
  7215             88  NO-LINES-SKIPPED       VALUE SPACES.
  7216             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7217         16  LA-TEXT-LINE            PIC X(70).
  7218
  7219     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7220         16  FILLER                  PIC XX.
  7221         16  LA-ADDRESS-LINE         PIC X(30).
  7222         16  FILLER                  PIC X(40).
  7223
  7224     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7225         16  FILLER                  PIC XX.
  7226         16  LA-CARRIER              PIC X.
  7227         16  LA-CLAIM-NO             PIC X(7).
  7228         16  LA-CERT-NO.
  7229             20  LA-CERT-PRIME       PIC X(10).
  7230             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 136
* EL156.cbl
  7231         16  LA-NO-OF-COPIES         PIC S9.
  7232         16  LA-RESEND-DATE          PIC XX.
  7233         16  LA-PROCESSOR-CD         PIC X(4).
  7234         16  LA-CREATION-DT          PIC XX.
  7235         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7236         16  LA-RESEND-PRINT-DATE    PIC XX.
  7237         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7238         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7239*
  7240* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7241*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7242*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7243*   I        20  LA-DMD-RES-ST           PIC XX.
  7244*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7245*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7246*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7247*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7248*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7249*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7250*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7251*   I        20  LA-DMD-UND-CODE         PIC XX.
  7252*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7253*   V    16  FILLER                  PIC X(15).
  7254* -----
  7255*
  7256* REINSERTED  CSO  MODS
  7257*
  7258         16  FILLER.
  7259             20  FILLER                  PIC X(29).
  7260             20  LA-CSO-LETTER-STATUS    PIC X.
  7261                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7262                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7263                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7264             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7265             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7266*
  7267
  7268     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7269         16  FILLER                  PIC XX.
  7270         16  LA4-CARRIER             PIC X.
  7271         16  LA4-CLAIM-NO            PIC X(7).
  7272         16  LA4-CERT-NO.
  7273             20  LA4-CERT-PRIME      PIC X(10).
  7274             20  LA4-CERT-SFX        PIC X.
  7275         16  LA4-NO-OF-COPIES        PIC S9.
  7276         16  LA4-RESEND-DATE         PIC XX.
  7277         16  LA4-PROCESSOR-CD        PIC X(4).
  7278         16  LA4-CREATION-DT         PIC XX.
  7279         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7280         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7281         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7282         16  LA4-FORM-TYPE           PIC X.
  7283             88  LA4-INITIAL-FORM    VALUE '1'.
  7284             88  LA4-PROGRESS-FORM   VALUE '2'.
  7285         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7286         16  LA4-STATE               PIC X(02).
  7287         16  FILLER                  PIC X(31).
  7288******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 137
* EL156.cbl
  7290*    COPY ELCDAR.
  7291******************************************************************
  7292*                                                                *
  7293*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7294*   FILE TYPE = VSAM,KSDS                                        *
  7295*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7296*   BASE CLUSTER = DLYACTV                                       *
  7297*   LOG = YES                                                    *
  7298*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7299*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7300*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7301*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7302*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7303*               BY PROGRAM "LGINFCE".                            *
  7304*                                                                *
  7305******************************************************************
  7306 01  DAILY-ACTIVITY-RECORD.
  7307     05  DA-KEY.
  7308         10  DA-COMP-CD          PIC X.
  7309         10  DA-CARRIER          PIC X.
  7310         10  DA-CLAIM-NO         PIC X(7).
  7311         10  DA-CERT-NO.
  7312             15  DA-CERT-PRIME   PIC X(10).
  7313             15  DA-CERT-SFX     PIC X.
  7314     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7315     05  DA-RECORD-TYPE          PIC X.
  7316     05  FILLER                  PIC X(2).
  7317******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 138
* EL156.cbl
  7319*    COPY ERCCOMP.
  7320******************************************************************
  7321*                                                                *
  7322*                                                                *
  7323*                            ERCCOMP                             *
  7324*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7325*                            VMOD=2.019                          *
  7326*                                                                *
  7327*   ONLINE CREDIT SYSTEM                                         *
  7328*                                                                *
  7329*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7330*                                                                *
  7331*   FILE TYPE = VSAM,KSDS                                        *
  7332*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7333*                                                                *
  7334*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7335*       ALTERNATE PATH = NONE                                    *
  7336*                                                                *
  7337*   LOG = NO                                                     *
  7338*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7339*                                                                *
  7340******************************************************************
  7341*                   C H A N G E   L O G
  7342*
  7343* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7344*-----------------------------------------------------------------
  7345*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7346* EFFECTIVE    NUMBER
  7347*-----------------------------------------------------------------
  7348* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7349* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7350* 092205    2005050300006  PEMA  ADD LEASE FEE
  7351* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7352* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7353* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7354* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7355* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7356* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7357******************************************************************
  7358
  7359 01  COMPENSATION-MASTER.
  7360     12  CO-RECORD-ID                          PIC XX.
  7361         88  VALID-CO-ID                          VALUE 'CO'.
  7362
  7363     12  CO-CONTROL-PRIMARY.
  7364         16  CO-COMPANY-CD                     PIC X.
  7365         16  CO-CONTROL.
  7366             20  CO-CTL-1.
  7367                 24  CO-CARR-GROUP.
  7368                     28  CO-CARRIER            PIC X.
  7369                     28  CO-GROUPING.
  7370                         32  CO-GROUP-PREFIX   PIC XXX.
  7371                         32  CO-GROUP-PRIME    PIC XXX.
  7372                 24  CO-RESP-NO.
  7373                     28  CO-RESP-PREFIX        PIC X(4).
  7374                     28  CO-RESP-PRIME         PIC X(6).
  7375             20  CO-CTL-2.
  7376                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 139
* EL156.cbl
  7377                     28  CO-ACCT-PREFIX        PIC X(4).
  7378                     28  CO-ACCT-PRIME         PIC X(6).
  7379         16  CO-TYPE                           PIC X.
  7380             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7381             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7382             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7383
  7384     12  CO-MAINT-INFORMATION.
  7385         16  CO-LAST-MAINT-DT                  PIC XX.
  7386         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7387         16  CO-LAST-MAINT-USER                PIC X(4).
  7388     12  FILLER                                PIC XX.
  7389     12  CO-STMT-TYPE                          PIC XXX.
  7390     12  CO-COMP-TYPE                          PIC X.
  7391         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7392     12  CO-STMT-OWNER                         PIC X(4).
  7393     12  CO-BALANCE-CONTROL                    PIC X.
  7394         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7395         88  CO-NO-BALANCE                        VALUE 'N'.
  7396
  7397     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7398         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7399         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7400         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7401
  7402     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7403         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7404         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7405
  7406     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7407     12  CO-GA-DIRECT-DEP                      PIC X.
  7408     12  CO-FUTURE-SPACE                       PIC X.
  7409         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7410
  7411     12  CO-ACCT-NAME                          PIC X(30).
  7412     12  CO-MAIL-NAME                          PIC X(30).
  7413     12  CO-ADDR-1                             PIC X(30).
  7414     12  CO-ADDR-2                             PIC X(30).
  7415     12  CO-ADDR-3.
  7416         16  CO-ADDR-CITY                      PIC X(27).
  7417         16  CO-ADDR-STATE                     PIC XX.
  7418     12  CO-CSO-1099                           PIC X.
  7419     12  CO-ZIP.
  7420         16  CO-ZIP-PRIME.
  7421             20  CO-ZIP-PRI-1ST                PIC X.
  7422                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7423             20  FILLER                        PIC X(4).
  7424         16  CO-ZIP-PLUS4                      PIC X(4).
  7425     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7426         16  CO-CAN-POSTAL-1                   PIC XXX.
  7427         16  CO-CAN-POSTAL-2                   PIC XXX.
  7428         16  FILLER                            PIC XXX.
  7429     12  CO-SOC-SEC                            PIC X(13).
  7430     12  CO-TELEPHONE.
  7431         16  CO-AREA-CODE                      PIC XXX.
  7432         16  CO-PREFIX                         PIC XXX.
  7433         16  CO-PHONE                          PIC X(4).
  7434
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 140
* EL156.cbl
  7435     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7436
  7437     12  CO-AR-BAL-LEVEL                       PIC X.
  7438         88  CO-AR-REF-LVL                        VALUE '1'.
  7439         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7440         88  CO-AR-BILL-LVL                       VALUE '2'.
  7441         88  CO-AR-AGT-LVL                        VALUE '3'.
  7442         88  CO-AR-FR-LVL                         VALUE '4'.
  7443
  7444     12  CO-AR-NORMAL-PRINT                    PIC X.
  7445         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7446         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7447
  7448     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7449
  7450     12  CO-AR-REPORTING                       PIC X.
  7451         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7452         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7453
  7454     12  CO-AR-PULL-CHECK                      PIC X.
  7455         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7456         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7457
  7458     12  CO-AR-BALANCE-PRINT                   PIC X.
  7459         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7460
  7461     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7462         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7463         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7464         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7465
  7466     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7467
  7468     12  CO-USER-CODE                          PIC X.
  7469     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7470
  7471******************************************************************
  7472*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7473*    THE LAST MONTH END RUN.
  7474******************************************************************
  7475
  7476     12  CO-LAST-ACTIVITY-DATE.
  7477         16  CO-ACT-YEAR                       PIC 99.
  7478         16  CO-ACT-MONTH                      PIC 99.
  7479         16  CO-ACT-DAY                        PIC 99.
  7480
  7481     12  CO-LAST-STMT-DT.
  7482         16  CO-LAST-STMT-YEAR                 PIC 99.
  7483         16  CO-LAST-STMT-MONTH                PIC 99.
  7484         16  CO-LAST-STMT-DAY                  PIC 99.
  7485
  7486     12  CO-MO-END-TOTALS.
  7487         16  CO-MONTHLY-TOTALS.
  7488             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7489             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7490             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7491             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7492             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 141
* EL156.cbl
  7493
  7494         16  CO-AGING-TOTALS.
  7495             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7496             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7497             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7498             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7499
  7500         16  CO-YTD-TOTALS.
  7501             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7502             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7503
  7504         16  CO-OVER-UNDER-TOTALS.
  7505             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7506             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7507
  7508     12  CO-MISCELLANEOUS-TOTALS.
  7509         16  CO-FICA-TOTALS.
  7510             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7511             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7512
  7513         16  CO-CLAIM-TOTALS.
  7514             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7515             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7516
  7517******************************************************************
  7518*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7519*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7520******************************************************************
  7521
  7522     12  CO-CURRENT-TOTALS.
  7523         16  CO-CURRENT-LAST-STMT-DT.
  7524             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7525             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7526             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7527
  7528         16  CO-CURRENT-MONTHLY-TOTALS.
  7529             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7530             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7531             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7532             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7533             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7534
  7535         16  CO-CURRENT-AGING-TOTALS.
  7536             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7537             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7538             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7539             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7540
  7541         16  CO-CURRENT-YTD-TOTALS.
  7542             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7543             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7544
  7545     12  CO-PAID-COMM-TOTALS.
  7546         16  CO-YTD-PAID-COMMS.
  7547             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7548             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7549
  7550     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 142
* EL156.cbl
  7551         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7552         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7553
  7554     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7555         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7556         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7557         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7558         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7559         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7560         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7561         88  CO-FINAL-LETTER                  VALUE 'F'.
  7562         88  CO-RECONCILING                   VALUE 'R'.
  7563         88  CO-PHONE-CALL                    VALUE 'P'.
  7564         88  CO-LEGAL                         VALUE 'L'.
  7565         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7566         88  CO-WRITE-OFF                     VALUE 'W'.
  7567         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7568
  7569     12  CO-CSR-CODE                       PIC X(4).
  7570
  7571     12  CO-GA-STATUS-INFO.
  7572         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7573         16  CO-GA-TERMINATION-DT          PIC XX.
  7574         16  CO-GA-STATUS-CODE             PIC X.
  7575             88  CO-GA-ACTIVE                 VALUE 'A'.
  7576             88  CO-GA-INACTIVE               VALUE 'I'.
  7577             88  CO-GA-PENDING                VALUE 'P'.
  7578         16  CO-GA-COMMENTS.
  7579             20  CO-GA-COMMENT-1           PIC X(40).
  7580             20  CO-GA-COMMENT-2           PIC X(40).
  7581             20  CO-GA-COMMENT-3           PIC X(40).
  7582             20  CO-GA-COMMENT-4           PIC X(40).
  7583
  7584     12  CO-RPTCD2                         PIC X(10).
  7585     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7586         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7587         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7588
  7589     12  CO-TYPE-AGENT                     PIC X(01).
  7590         88  CO-CORPORATION                   VALUE 'C'.
  7591         88  CO-PARTNERSHIP                   VALUE 'P'.
  7592         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7593         88  CO-TRUST                         VALUE 'T'.
  7594         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7595
  7596     12  CO-FAXNO.
  7597         16  CO-FAX-AREA-CODE                  PIC XXX.
  7598         16  CO-FAX-PREFIX                     PIC XXX.
  7599         16  CO-FAX-PHONE                      PIC X(4).
  7600
  7601     12  CO-BANK-INFORMATION.
  7602         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7603         16  CO-BANK-TRANSIT-NON REDEFINES
  7604             CO-BANK-TRANSIT-NO                PIC 9(8).
  7605
  7606         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7607     12  CO-MISC-DEDUCT-INFO REDEFINES
  7608                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 143
* EL156.cbl
  7609         16  CO-MD-GL-ACCT                     PIC X(10).
  7610         16  CO-MD-DIV                         PIC XX.
  7611         16  CO-MD-CENTER                      PIC X(4).
  7612         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7613         16  CO-CREATE-AP-CHECK                PIC X.
  7614         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7615         16  FILLER                            PIC XXX.
  7616     12  CO-ACH-STATUS                         PIC X.
  7617         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7618         88  CO-ACH-PENDING                        VALUE 'P'.
  7619
  7620     12  CO-BILL-SW                            PIC X.
  7621     12  CO-CONTROL-NAME                       PIC X(30).
  7622     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7623     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7624     12  CO-CLP-STATE                          PIC XX.
  7625     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7626     12  CO-SPP-REFUND-EDIT                    PIC X.
  7627
  7628******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 144
* EL156.cbl
  7630*    COPY ERCDMDNT.
  7631******************************************************************
  7632*                                                                *
  7633*                            ERCDMDNT                            *
  7634*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7635*                            VMOD=2.005                          *
  7636*                                                                *
  7637*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7638*                                                                *
  7639*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7640*                                                                *
  7641*        FILE TYPE= VSAM,KSDS                                    *
  7642*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7643*                                                                *
  7644*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7645*                                                                *
  7646*        LOG = YES                                               *
  7647*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7648*                                                                *
  7649******************************************************************
  7650
  7651 01  CERTIFICATE-NOTE.
  7652     12  CN-RECORD-ID                     PIC  XX.
  7653         88  VALID-CN-ID                      VALUE 'CN'.
  7654
  7655     12  CN-CONTROL-PRIMARY.
  7656         16  CN-COMPANY-CD                PIC X.
  7657         16  CN-CERT-KEY.
  7658             20  CN-CARRIER               PIC X.
  7659             20  CN-GROUPING.
  7660                 24  CN-GROUPING-PREFIX   PIC XXX.
  7661                 24  CN-GROUPING-PRIME    PIC XXX.
  7662             20  CN-STATE                 PIC XX.
  7663             20  CN-ACCOUNT.
  7664                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7665                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7666             20  CN-CERT-EFF-DT           PIC XX.
  7667             20  CN-CERT-NO.
  7668                 24  CN-CERT-PRIME        PIC X(10).
  7669                 24  CN-CERT-SFX          PIC X.
  7670
  7671     12  CN-BILLING-START-LINE-NO         PIC 99.
  7672     12  CN-BILLING-END-LINE-NO           PIC 99.
  7673
  7674     12  CN-LINES.
  7675         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7676
  7677     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7678         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7679         16  CN-CSI-GENERAL-DATA-AREA.
  7680             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7681
  7682         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7683             CN-CSI-GENERAL-DATA-AREA.
  7684             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7685             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7686             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7687             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 145
* EL156.cbl
  7688             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7689             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7690             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7691             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7692             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7693             20  FILLER                       PIC XX.
  7694             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7695             20  FILLER                       PIC X(38).
  7696
  7697         16  CN-CSI-PRODUCT-DATA-AREA.
  7698             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7699
  7700         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7701             CN-CSI-PRODUCT-DATA-AREA.
  7702             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7703             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7704             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7705             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7706             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7707             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7708             20  FILLER                   PIC XX.
  7709             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7710             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7711             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7712             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7713             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7714             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7715             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7716             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7717             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7718             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7719             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7720             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7721             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7722             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7723             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7724             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7725             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7726             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7727             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7728             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7729             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7730             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7731             20  FILLER                   PIC X(25).
  7732
  7733         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7734             CN-CSI-CREDIT-CARD-DATA.
  7735             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7736             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7737             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7738             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7739             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7740             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7741             20  FILLER                   PIC XX.
  7742             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7743             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7744             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7745             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 146
* EL156.cbl
  7746             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7747             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7748             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7749             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7750             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7751             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7752             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7753             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7754             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7755             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7756             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7757             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7758             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7759             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7760             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7761             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7762             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7763             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7764             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7765             20  FILLER                   PIC X(17).
  7766
  7767         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7768             CN-CSI-FAMILY-LEAVE-DATA.
  7769             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7770             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7771             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7772             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7773             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7774             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7775             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7776             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7777             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7778             20  CN-CSI-SL-INT-ON-PROCEEDS
  7779                                          PIC S9(5)V99  COMP-3.
  7780             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7781             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7782             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7783             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7784             20  CN-CSI-SL-POLICY-BENEFITS
  7785                                          PIC S9(5)V99  COMP-3.
  7786             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7787             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7788             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7789             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7790             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7791             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7792             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7793             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7794             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7795             20  CN-CSI-SL-STATE-NOT      PIC X.
  7796             20  FILLER                   PIC XX.
  7797
  7798         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7799             CN-CSI-SENIOR-LIFE-DATA.
  7800             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7801             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7802             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7803                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 147
* EL156.cbl
  7804             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7805             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7806             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7807             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7808             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7809             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7810             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7811             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7812             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7813             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7814             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7815             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7816             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7817             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7818             20  CN-CSI-PP-REPAIR         PIC X.
  7819             20  CN-CSI-PP-REPLACE        PIC X.
  7820             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7821             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7822             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7823             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7824             20  FILLER                   PIC X(5).
  7825
  7826         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7827             CN-CSI-PURCH-PROP-DATA.
  7828             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7829             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7830             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7831             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7832             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7833             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7834             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7835             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7836             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7837             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7838             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7839             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7840             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7841             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7842             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7843             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7844             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7845             20  CN-CSI-EW-REPLACE        PIC X.
  7846             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7847             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7848             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7849             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7850             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7851             20  FILLER                   PIC X(4).
  7852
  7853     12  CN-LAST-MAINT-DT                 PIC XX.
  7854     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7855     12  CN-LAST-MAINT-USER               PIC X(4).
  7856     12  FILLER                           PIC X(6).
  7857
  7858******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 148
* EL156.cbl
  7860*    COPY ERCCNOT.
  7861******************************************************************
  7862*                                                                *
  7863*                            ERCCNOT                             *
  7864*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7865*                            VMOD=2.003                          *
  7866*                                                                *
  7867*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7868*                                                                *
  7869*        FILE TYPE= VSAM,KSDS                                    *
  7870*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7871*                                                                *
  7872*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7873*                                                                *
  7874*        LOG = YES                                               *
  7875*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7876*                                                                *
  7877******************************************************************
  7878*                   C H A N G E   L O G
  7879*
  7880* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7881*-----------------------------------------------------------------
  7882*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7883* EFFECTIVE    NUMBER
  7884*-----------------------------------------------------------------
  7885* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7886******************************************************************
  7887
  7888 01  CERT-NOTE-FILE.
  7889     12  CZ-RECORD-ID                PIC  XX.
  7890         88  VALID-CZ-ID                  VALUE 'CZ'.
  7891
  7892     12  CZ-CONTROL-PRIMARY.
  7893         16  CZ-COMPANY-CD           PIC X.
  7894         16  CZ-CARRIER              PIC X.
  7895         16  CZ-GROUPING.
  7896             20 CZ-GROUPING-PREFIX   PIC XXX.
  7897             20 CZ-GROUPING-PRIME    PIC XXX.
  7898         16  CZ-STATE                PIC XX.
  7899         16  CZ-ACCOUNT.
  7900             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7901             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7902         16  CZ-CERT-EFF-DT          PIC XX.
  7903         16  CZ-CERT-NO.
  7904             20  CZ-CERT-PRIME       PIC X(10).
  7905             20  CZ-CERT-SFX         PIC X.
  7906         16  CZ-RECORD-TYPE          PIC X.
  7907             88  CERT-NOTE           VALUE '1'.
  7908             88  CLAIM-CERT-NOTE     VALUE '2'.
  7909         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7910
  7911     12  CZ-LAST-MAINT-DT            PIC XX.
  7912     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7913     12  CZ-LAST-MAINT-USER          PIC X(4).
  7914
  7915     12  CZ-NOTE-INFORMATION.
  7916         16  CZ-NOTE                 PIC X(63).
  7917         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 149
* EL156.cbl
  7918******************************************************************
  7919*                            COPY ERCPDEF.
  7920******************************************************************
  7921*                                                                *
  7922*                                                                *
  7923*                            ERCPDEF.                            *
  7924*                                                                *
  7925*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7926*                                                                *
  7927*    FILE TYPE = VSAM,KSDS                                       *
  7928*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7929*                                                                *
  7930*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7931*                                                                *
  7932*    LOG = YES                                                   *
  7933*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7934******************************************************************
  7935*                   C H A N G E   L O G
  7936*
  7937* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7938*-----------------------------------------------------------------
  7939*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7940* EFFECTIVE    NUMBER
  7941*-----------------------------------------------------------------
  7942* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7943* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7944* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  7945******************************************************************
  7946 01  PRODUCT-MASTER.
  7947    12  PD-RECORD-ID                 PIC X(02).
  7948        88  VALID-PD-ID                  VALUE 'PD'.
  7949    12  PD-CONTROL-PRIMARY.
  7950        16  PD-COMPANY-CD            PIC X.
  7951        16  PD-STATE                 PIC XX.
  7952        16  PD-PRODUCT-CD            PIC XXX.
  7953        16  PD-FILLER                PIC X(7).
  7954        16  PD-BEN-TYPE              PIC X.
  7955        16  PD-BEN-CODE              PIC XX.
  7956        16  PD-PROD-EXP-DT           PIC XX.
  7957    12  FILLER                       PIC X(50).
  7958    12  PD-PRODUCT-DATA OCCURS 8.
  7959        16  PD-PROD-CODE             PIC X.
  7960            88  PD-PROD-LIFE           VALUE 'L'.
  7961            88  PD-PROD-PROP           VALUE 'P'.
  7962            88  PD-PROD-AH             VALUE 'A'.
  7963            88  PD-PROD-IU             VALUE 'I'.
  7964            88  PD-PROD-GAP            VALUE 'G'.
  7965            88  PD-PROD-FAML           VALUE 'F'.
  7966        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  7967        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  7968        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  7969        16  PD-MAX-TERM              PIC S999        COMP-3.
  7970        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  7971        16  FILLER                   PIC X.
  7972        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  7973        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  7974        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  7975        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 150
* EL156.cbl
  7976        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  7977        16  PD-REC-CRIT-PERIOD       PIC 99.
  7978        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  7979            20  PD-RECURRING-YN      PIC X.
  7980            20  FILLER               PIC X.
  7981        16  PD-RTW-MOS               PIC 99.
  7982        16  PD-MAX-EXTENSION         PIC 99.
  7983        16  pd-ben-pct               pic sv999 comp-3.
  7984*       16  FILLER                   PIC XX.
  7985    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  7986    12  PD-TERM-LIMITS OCCURS 15.
  7987        16  PD-LOW-TERM              PIC S999        COMP-3.
  7988        16  PD-HI-TERM               PIC S999        COMP-3.
  7989*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  7990    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  7991        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  7992        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  7993    12  PD-EARN-FACTORS.
  7994        16  FILLER OCCURS 15.
  7995            20  FILLER OCCURS 15.
  7996                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  7997    12  PD-PRODUCT-DESC              PIC X(80).
  7998    12  PD-TRUNCATED                 PIC X.
  7999    12  FILLER                       PIC X(59).
  8000    12  PD-MAINT-INFORMATION.
  8001        16  PD-LAST-MAINT-DT         PIC X(02).
  8002        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8003        16  PD-LAST-MAINT-BY         PIC X(04).
  8004*                            COPY ELCCRTT.
  8005******************************************************************
  8006*                                                                *
  8007*                            ELCCRTT.                            *
  8008*                                                                *
  8009*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8010*                                                                *
  8011*   FILE TYPE = VSAM,KSDS                                        *
  8012*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8013*                                                                *
  8014*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8015*                                                                *
  8016*   LOG = YES                                                    *
  8017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8018******************************************************************
  8019*                   C H A N G E   L O G
  8020*
  8021* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8022*-----------------------------------------------------------------
  8023*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8024* EFFECTIVE    NUMBER
  8025*-----------------------------------------------------------------
  8026* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8027* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8028* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8029* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8030* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8031* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8032* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8033******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 151
* EL156.cbl
  8034
  8035 01  CERTIFICATE-TRAILERS.
  8036     12  CS-RECORD-ID                      PIC XX.
  8037         88  VALID-CS-ID                      VALUE 'CS'.
  8038
  8039     12  CS-CONTROL-PRIMARY.
  8040         16  CS-COMPANY-CD                 PIC X.
  8041         16  CS-CARRIER                    PIC X.
  8042         16  CS-GROUPING                   PIC X(6).
  8043         16  CS-STATE                      PIC XX.
  8044         16  CS-ACCOUNT                    PIC X(10).
  8045         16  CS-CERT-EFF-DT                PIC XX.
  8046         16  CS-CERT-NO.
  8047             20  CS-CERT-PRIME             PIC X(10).
  8048             20  CS-CERT-SFX               PIC X.
  8049         16  CS-TRAILER-TYPE               PIC X.
  8050             88  COMM-TRLR           VALUE 'A'.
  8051             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8052             88  CERT-DATA-TRLR      VALUE 'C'.
  8053
  8054     12  CS-DATA-AREA                      PIC X(516).
  8055
  8056     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8057         16  CS-BANK-COMMISSION-AREA.
  8058             20  CS-BANK-COMMS       OCCURS 10.
  8059                 24  CS-AGT                PIC X(10).
  8060                 24  CS-COM-TYP            PIC X.
  8061                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8062                 24  CS-RECALC-LV-INDIC    PIC X.
  8063                 24  FILLER                PIC X(10).
  8064         16  FILLER                        PIC X(256).
  8065
  8066     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8067****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8068         16  CS-MB-CLAIM-DATA OCCURS 24.
  8069             20  CS-CLAIM-NO               PIC X(7).
  8070             20  CS-CLAIM-TYPE             PIC X.
  8071                 88  CS-AH-CLM               VALUE 'A'.
  8072                 88  CS-IU-CLM               VALUE 'I'.
  8073                 88  CS-GP-CLM               VALUE 'G'.
  8074                 88  CS-LF-CLM               VALUE 'L'.
  8075                 88  CS-PR-CLM               VALUE 'P'.
  8076                 88  CS-FL-CLM               VALUE 'F'.
  8077             20  CS-INSURED-TYPE           PIC X.
  8078                 88  CS-PRIM-INSURED          VALUE 'P'.
  8079                 88  CS-CO-BORROWER           VALUE 'C'.
  8080             20  CS-BENEFIT-PERIOD         PIC 99.
  8081             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8082             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8083             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8084         16  FILLER                        PIC X(12).
  8085     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8086         16  CS-VIN-NUMBER                 PIC X(17).
  8087         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8088         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8089         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8090         16  FILLER                        PIC X(496).
  8091 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 152
* EL156.cbl
  8092                          CONTROL-FILE CERTIFICATE-MASTER
  8093                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8094                          ACCOUNT-MASTER CHECK-QUE
  8095                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8096                          DAILY-ACTIVITY-RECORD
  8097                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8098                          CERT-NOTE-FILE PRODUCT-MASTER
  8099                          CERTIFICATE-TRAILERS.
  8100 0000-DFHEXIT SECTION.
  8101     MOVE '9#                    $   ' TO DFHEIV0.
  8102     MOVE 'EL156' TO DFHEIV1.
  8103     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8104
  8105     IF EIBCALEN = 0
  8106         GO TO 8800-UNAUTHORIZED-ACCESS.
  8107
  8108     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8109     MOVE EIBTRMID               TO QID-TERM.
  8110     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8111     MOVE '2'                    TO EMI-SWITCH2.
  8112     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8113     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8114
  8115     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8116     MOVE '5'                    TO DC-OPTION-CODE.
  8117     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8118     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8119                                    SAVE-BIN-DATE.
  8120     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8121     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8122
  8123     IF SAVE-DATE-YY > 70
  8124         MOVE 19                 TO SAVE-DATE-CC
  8125     ELSE
  8126         MOVE 20                 TO SAVE-DATE-CC.
  8127
  8128     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8129         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8130     END-IF.
  8131
  8132     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8133        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8134     ELSE
  8135        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8136     END-IF
  8137
  8138     IF PI-PRINT-CLM-FRM-YN = 'N'
  8139         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8140     ELSE
  8141         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8142     END-IF
  8143
  8144     IF PI-PRINT-SURVEY-YN = 'N'
  8145         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8146     ELSE
  8147         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8148     END-IF
  8149
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 153
* EL156.cbl
  8150     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8151         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8152     ELSE
  8153         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8154     END-IF
  8155
  8156* EXEC CICS HANDLE CONDITION
  8157*        NOTOPEN   (9990-ABEND)
  8158*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8159*        MAPFAIL   (0400-FIRST-TIME)
  8160*        DUPREC    (6180-DUPREC)
  8161*        ERROR     (9990-ABEND)
  8162*    END-EXEC.
  8163*    MOVE '"$JL?%.               ! " #00008151' TO DFHEIV0
  8164     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8165     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8166     MOVE X'2220233030303038313531' TO DFHEIV0(25:11)
  8167     CALL 'kxdfhei1' USING DFHEIV0
  8168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8169
  8170
  8171     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8172         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8173
  8174     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8175         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8176             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8177             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8178             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8179             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8180             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8181             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8182             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8183             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8184             MOVE LOW-VALUES           TO EL156AI
  8185             MOVE 'Y'                  TO FIRST-ENTRY
  8186         ELSE
  8187             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8188             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8189             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8190             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8191             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8192             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8193             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8194             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8195
  8196     IF RETURNED-FROM NOT = SPACES
  8197        IF (RETURNED-FROM = 'EL614')
  8198           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8199           IF WS-SAVED-EOB-CODES NOT = SPACES
  8200              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8201           ELSE
  8202              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8203           END-IF
  8204        END-IF
  8205         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8206            MOVE 'Y'             TO FIRST-ENTRY
  8207            IF RETURNED-FROM = 'EL614'
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 154
* EL156.cbl
  8208               AND (PI-PASS-SW NOT = 'C')
  8209               IF WS-SAVED-EOB-CODES NOT = SPACES
  8210                  MOVE WS-SAVED-EOB-CODES
  8211                                 TO PI-PMTNOTE2
  8212                                    WS-PMTNOTE2
  8213                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8214               ELSE
  8215                  MOVE SPACES    TO PI-PMTNOTE2
  8216                                    WS-PMTNOTE2
  8217                                    PI-EOB-CODES-EXIST
  8218               END-IF
  8219            END-IF
  8220            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8221            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8222            IF RETURNED-FROM = 'EL614'
  8223               GO TO 1000-EDIT-DATA
  8224            END-IF
  8225            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8226               (PAYEEI   = LOW-VALUES OR SPACES)
  8227               GO TO 8100-SEND-INITIAL-MAP
  8228            ELSE
  8229               GO TO 1000-EDIT-DATA.
  8230
  8231     IF EIBTRNID NOT = TRANS-ID
  8232         GO TO 0400-FIRST-TIME.
  8233
  8234     IF EIBAID = DFHCLEAR
  8235        IF PI-PASS-SW = 'C'
  8236           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8237           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8238           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8239           MOVE 'Y'            TO RETURNED-FROM-B
  8240           GO TO 1000-EDIT-DATA
  8241        ELSE
  8242           GO TO 9400-CLEAR.
  8243
  8244     IF PI-PASS-SW = 'C'
  8245         MOVE MAP-NAMEB          TO MAP-NAME
  8246         IF EIBAID = DFHPF1 OR DFHPF13
  8247             GO TO 5000-UPDATE
  8248           ELSE
  8249             IF EIBAID NOT = DFHENTER
  8250                 MOVE LOW-VALUES TO EL156BI
  8251                 MOVE MAP-NAMEB  TO MAP-NAME
  8252                 MOVE ER-0029    TO EMI-ERROR
  8253                 MOVE -1         TO  ENTPFBL
  8254                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8255                 GO TO 8200-SEND-DATAONLY.
  8256
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 155
* EL156.cbl
  8258 0200-RECEIVE.
  8259     MOVE LOW-VALUES             TO EL156AI.
  8260     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8261         MOVE ER-0008            TO EMI-ERROR
  8262         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8263         IF PI-PASS-SW = 'C'
  8264             MOVE -1             TO ENTPFBL
  8265             GO TO 8200-SEND-DATAONLY
  8266         ELSE
  8267             MOVE -1             TO PMTTYPEL
  8268             GO TO 8200-SEND-DATAONLY.
  8269
  8270     IF PI-COMPANY-ID = 'DMD'
  8271         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8272
  8273     IF PI-PASS-SW = 'C'
  8274         MOVE MAP-NAMEB          TO MAP-NAME.
  8275
  8276
  8277* EXEC CICS RECEIVE
  8278*        MAP   (MAP-NAME)
  8279*        MAPSET(MAPSET-NAME)
  8280*        ASIS
  8281*        INTO  (EL156AI)
  8282*    END-EXEC.
  8283     MOVE LENGTH OF
  8284      EL156AI
  8285       TO DFHEIV11
  8286*    MOVE '8"TAI  L              ''   #00008264' TO DFHEIV0
  8287     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8288     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8289     MOVE X'2020233030303038323634' TO DFHEIV0(25:11)
  8290     CALL 'kxdfhei1' USING DFHEIV0,
  8291           MAP-NAME,
  8292           EL156AI,
  8293           DFHEIV11,
  8294           MAPSET-NAME,
  8295           DFHEIV99,
  8296           DFHEIV99
  8297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8298
  8299
  8300     IF PI-PASS-SW NOT = 'C'
  8301         GO TO 0250-MAPA.
  8302
  8303     IF ENTPFBL NOT > ZERO
  8304         MOVE MAP-NAMEB          TO MAP-NAME
  8305         MOVE ER-0029            TO EMI-ERROR
  8306         MOVE -1                 TO  ENTPFBL
  8307         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8308         GO TO 8200-SEND-DATAONLY.
  8309
  8310     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8311         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8312       ELSE
  8313         MOVE MAP-NAMEB           TO MAP-NAME
  8314         MOVE ER-0029             TO EMI-ERROR
  8315         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 156
* EL156.cbl
  8316         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8317         GO TO 8200-SEND-DATAONLY.
  8318
  8319     IF EIBAID = DFHPF1 OR DFHPF13
  8320         IF MODIFY-CAP
  8321            GO TO 5000-UPDATE
  8322          ELSE
  8323            MOVE 'UPDATE'           TO SM-READ
  8324            PERFORM 9995-SECURITY-VIOLATION
  8325            MOVE MAP-NAMEB          TO MAP-NAME
  8326            MOVE ER-0070            TO EMI-ERROR
  8327            MOVE -1                 TO  ENTPFBL
  8328            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8329            GO TO 8200-SEND-DATAONLY.
  8330
  8331 0250-MAPA.
  8332     IF ENTERPFL = 0
  8333         GO TO 0300-CHECK-PFKEYS.
  8334
  8335     IF EIBAID NOT = DFHENTER
  8336         MOVE ER-0004            TO EMI-ERROR
  8337         GO TO 0320-INPUT-ERROR.
  8338
  8339     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8340         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8341     ELSE
  8342         MOVE ER-0029            TO EMI-ERROR
  8343         GO TO 0320-INPUT-ERROR.
  8344
  8345 0300-CHECK-PFKEYS.
  8346     IF EIBAID = DFHPF7 OR DFHPF8
  8347         GO TO 8820-PF7-8.
  8348
  8349     IF EIBAID = DFHPF23
  8350         GO TO 8810-PF23.
  8351
  8352     IF EIBAID = DFHPF24
  8353         GO TO 9200-RETURN-MAIN-MENU.
  8354
  8355     IF EIBAID = DFHPF12
  8356         GO TO 9500-PF12.
  8357
  8358     IF EIBAID = DFHPF1
  8359        IF PI-PASS-SW = 'A' OR 'B'
  8360          GO TO 0330-BROWSE-FORWARD.
  8361
  8362     IF EIBAID = DFHPF2
  8363        IF PI-PASS-SW = 'A' OR 'B'
  8364          GO TO 0350-BROWSE-BACKWARD.
  8365
  8366     IF EIBAID = DFHPF6
  8367        IF PI-EOB-CODES-EXIST = 'Y'
  8368           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8369        ELSE
  8370           MOVE SPACES              TO WS-PMTNOTE2
  8371        END-IF
  8372         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8373         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 157
* EL156.cbl
  8374            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8375         END-IF
  8376         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8377         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8378             MOVE 'EL614'        TO PGM-NAME
  8379             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8380             GO TO 9300-XCTL
  8381         ELSE
  8382             MOVE XCTL-157       TO PGM-NAME
  8383             GO TO 9300-XCTL.
  8384
  8385     IF EIBAID = DFHPF9
  8386        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8387        MOVE XCTL-141            TO PGM-NAME
  8388        GO TO 9300-XCTL.
  8389
  8390     IF EIBAID = DFHPF10
  8391        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8392        MOVE XCTL-155            TO PGM-NAME
  8393        GO TO 9300-XCTL.
  8394
  8395     MOVE SPACES                 TO ERRMSG0O
  8396                                    ERRMSG1O
  8397                                    ERRMSG2O.
  8398
  8399     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8400         IF PI-PASS-SW NOT = 'B'
  8401             MOVE ER-0422        TO EMI-ERROR
  8402             GO TO 0320-INPUT-ERROR
  8403           ELSE
  8404             GO TO 0700-TEST-FOR-CHANGES.
  8405
  8406     IF EIBAID = DFHPF11
  8407        IF PI-PASS-SW = 'C'
  8408           MOVE ER-0029          TO EMI-ERROR
  8409           GO TO 0320-INPUT-ERROR.
  8410
  8411     IF EIBAID = DFHENTER OR DFHPF11
  8412        NEXT SENTENCE
  8413     ELSE
  8414        MOVE ER-0029             TO EMI-ERROR
  8415        GO TO 0320-INPUT-ERROR.
  8416
  8417     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8418
  8419     if pi-epyfrom not = zeros
  8420        if pi-epyfrom not = ws-epyfrom
  8421           move zeros        to ws-edays
  8422        end-if
  8423     end-if
  8424
  8425     if pi-epythru not = zeros
  8426        if pi-epythru not = ws-epythru
  8427           move zeros        to ws-edays
  8428        end-if
  8429     end-if
  8430
  8431     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 158
* EL156.cbl
  8432         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8433         GO TO 1000-EDIT-DATA
  8434     ELSE
  8435         IF PI-FATAL-COUNT NOT = 0 OR
  8436            PI-FORCE-COUNT NOT = 0
  8437             GO TO 1000-EDIT-DATA
  8438         ELSE
  8439             GO TO 2000-EDIT-DONE.
  8440
  8441 0320-INPUT-ERROR.
  8442     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8443
  8444     IF ENTERPFL = 0
  8445         MOVE -1                 TO PMTTYPEL
  8446     ELSE
  8447         MOVE AL-UNBON           TO ENTERPFA
  8448         MOVE -1                 TO ENTERPFL.
  8449
  8450     GO TO 8200-SEND-DATAONLY.
  8451
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 159
* EL156.cbl
  8453 0330-BROWSE-FORWARD.
  8454
  8455     MOVE CLMNOI            TO PI-CLAIM-NO.
  8456     MOVE CARRI             TO PI-CARRIER.
  8457     MOVE CERTNOI           TO PI-CERT-PRIME.
  8458     MOVE SUFXI             TO PI-CERT-SFX.
  8459
  8460     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8461     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8462     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8463     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8464
  8465     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8466
  8467
  8468* EXEC CICS HANDLE CONDITION
  8469*         NOTFND   (0380-CLAIM-END-FILE)
  8470*         ENDFILE  (0380-CLAIM-END-FILE)
  8471*    END-EXEC.
  8472*    MOVE '"$I''                  ! # #00008438' TO DFHEIV0
  8473     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8474     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8475     MOVE X'2320233030303038343338' TO DFHEIV0(25:11)
  8476     CALL 'kxdfhei1' USING DFHEIV0
  8477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8478
  8479
  8480
  8481* EXEC CICS STARTBR
  8482*         DATASET    ('ELMSTR')
  8483*         RIDFLD     (ELMSTR-KEY)
  8484*         GTEQ
  8485*    END-EXEC.
  8486     MOVE 'ELMSTR' TO DFHEIV1
  8487     MOVE 0
  8488       TO DFHEIV11
  8489*    MOVE '&,         G          &   #00008443' TO DFHEIV0
  8490     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8491     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8492     MOVE X'2020233030303038343433' TO DFHEIV0(25:11)
  8493     CALL 'kxdfhei1' USING DFHEIV0,
  8494           DFHEIV1,
  8495           ELMSTR-KEY,
  8496           DFHEIV99,
  8497           DFHEIV11,
  8498           DFHEIV99
  8499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8500
  8501
  8502     MOVE 'Y' TO WS-BROWSE-START-SW.
  8503
  8504 0335-READNEXT.
  8505
  8506
  8507* EXEC CICS READNEXT
  8508*         DATASET    ('ELMSTR')
  8509*         RIDFLD     (ELMSTR-KEY)
  8510*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 160
* EL156.cbl
  8511*    END-EXEC.
  8512     MOVE 'ELMSTR' TO DFHEIV1
  8513     MOVE 0
  8514       TO DFHEIV11
  8515*    MOVE '&.S                   )   #00008453' TO DFHEIV0
  8516     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8517     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8518     MOVE X'2020233030303038343533' TO DFHEIV0(25:11)
  8519     CALL 'kxdfhei1' USING DFHEIV0,
  8520           DFHEIV1,
  8521           DFHEIV20,
  8522           DFHEIV99,
  8523           ELMSTR-KEY,
  8524           DFHEIV99,
  8525           DFHEIV11,
  8526           DFHEIV99,
  8527           DFHEIV99
  8528     SET ADDRESS OF CLAIM-MASTER TO
  8529         DFHEIV20
  8530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8531
  8532
  8533     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8534        GO TO 0380-CLAIM-END-FILE.
  8535
  8536     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8537        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8538        GO TO 0335-READNEXT.
  8539
  8540     IF PI-COMPANY-ID = 'CRI'
  8541         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8542            GO TO 0380-CLAIM-END-FILE.
  8543
  8544     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8545         GO TO 0335-READNEXT.
  8546
  8547     IF PI-CARRIER-SECURITY > SPACES
  8548         IF CL-CARRIER = PI-CARRIER-SECURITY
  8549             NEXT SENTENCE
  8550         ELSE
  8551             GO TO 0335-READNEXT.
  8552
  8553     IF PI-ACCOUNT-SECURITY > SPACES
  8554         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8555             NEXT SENTENCE
  8556         ELSE
  8557             GO TO 0335-READNEXT.
  8558
  8559     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8560     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8561     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8562
  8563     GO TO 0400-FIRST-TIME.
  8564
  8565 0350-BROWSE-BACKWARD.
  8566
  8567     MOVE CLMNOI            TO PI-CLAIM-NO
  8568                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 161
* EL156.cbl
  8569     MOVE CARRI             TO PI-CARRIER.
  8570     MOVE CERTNOI           TO PI-CERT-PRIME.
  8571     MOVE SUFXI             TO PI-CERT-SFX.
  8572
  8573     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8574
  8575     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8576     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8577     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8578
  8579
  8580* EXEC CICS HANDLE CONDITION
  8581*         NOTFND   (0380-CLAIM-END-FILE)
  8582*         ENDFILE  (0380-CLAIM-END-FILE)
  8583*    END-EXEC.
  8584*    MOVE '"$I''                  ! $ #00008505' TO DFHEIV0
  8585     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8586     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8587     MOVE X'2420233030303038353035' TO DFHEIV0(25:11)
  8588     CALL 'kxdfhei1' USING DFHEIV0
  8589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8590
  8591
  8592
  8593* EXEC CICS STARTBR
  8594*         DATASET    ('ELMSTR')
  8595*         RIDFLD     (ELMSTR-KEY)
  8596*         GTEQ
  8597*    END-EXEC.
  8598     MOVE 'ELMSTR' TO DFHEIV1
  8599     MOVE 0
  8600       TO DFHEIV11
  8601*    MOVE '&,         G          &   #00008510' TO DFHEIV0
  8602     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8603     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8604     MOVE X'2020233030303038353130' TO DFHEIV0(25:11)
  8605     CALL 'kxdfhei1' USING DFHEIV0,
  8606           DFHEIV1,
  8607           ELMSTR-KEY,
  8608           DFHEIV99,
  8609           DFHEIV11,
  8610           DFHEIV99
  8611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8612
  8613
  8614     MOVE 'Y' TO WS-BROWSE-START-SW.
  8615
  8616
  8617* EXEC CICS READNEXT
  8618*         DATASET    ('ELMSTR')
  8619*         RIDFLD     (ELMSTR-KEY)
  8620*         SET        (ADDRESS OF CLAIM-MASTER)
  8621*    END-EXEC.
  8622     MOVE 'ELMSTR' TO DFHEIV1
  8623     MOVE 0
  8624       TO DFHEIV11
  8625*    MOVE '&.S                   )   #00008518' TO DFHEIV0
  8626     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 162
* EL156.cbl
  8627     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8628     MOVE X'2020233030303038353138' TO DFHEIV0(25:11)
  8629     CALL 'kxdfhei1' USING DFHEIV0,
  8630           DFHEIV1,
  8631           DFHEIV20,
  8632           DFHEIV99,
  8633           ELMSTR-KEY,
  8634           DFHEIV99,
  8635           DFHEIV11,
  8636           DFHEIV99,
  8637           DFHEIV99
  8638     SET ADDRESS OF CLAIM-MASTER TO
  8639         DFHEIV20
  8640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8641
  8642
  8643
  8644* EXEC CICS READPREV
  8645*         DATASET    ('ELMSTR')
  8646*         RIDFLD     (ELMSTR-KEY)
  8647*         SET        (ADDRESS OF CLAIM-MASTER)
  8648*    END-EXEC.
  8649     MOVE 'ELMSTR' TO DFHEIV1
  8650     MOVE 0
  8651       TO DFHEIV11
  8652*    MOVE '&0S                   )   #00008524' TO DFHEIV0
  8653     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8654     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8655     MOVE X'2020233030303038353234' TO DFHEIV0(25:11)
  8656     CALL 'kxdfhei1' USING DFHEIV0,
  8657           DFHEIV1,
  8658           DFHEIV20,
  8659           DFHEIV99,
  8660           ELMSTR-KEY,
  8661           DFHEIV99,
  8662           DFHEIV11,
  8663           DFHEIV99,
  8664           DFHEIV99
  8665     SET ADDRESS OF CLAIM-MASTER TO
  8666         DFHEIV20
  8667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8668
  8669
  8670 0360-BROWSE-BACKWARD.
  8671
  8672
  8673* EXEC CICS READPREV
  8674*         DATASET    ('ELMSTR')
  8675*         RIDFLD     (ELMSTR-KEY)
  8676*         SET        (ADDRESS OF CLAIM-MASTER)
  8677*    END-EXEC.
  8678     MOVE 'ELMSTR' TO DFHEIV1
  8679     MOVE 0
  8680       TO DFHEIV11
  8681*    MOVE '&0S                   )   #00008532' TO DFHEIV0
  8682     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8683     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8684     MOVE X'2020233030303038353332' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 163
* EL156.cbl
  8685     CALL 'kxdfhei1' USING DFHEIV0,
  8686           DFHEIV1,
  8687           DFHEIV20,
  8688           DFHEIV99,
  8689           ELMSTR-KEY,
  8690           DFHEIV99,
  8691           DFHEIV11,
  8692           DFHEIV99,
  8693           DFHEIV99
  8694     SET ADDRESS OF CLAIM-MASTER TO
  8695         DFHEIV20
  8696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8697
  8698
  8699     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8700        GO TO 0380-CLAIM-END-FILE.
  8701
  8702     IF PI-COMPANY-ID = 'CRI'
  8703         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8704            GO TO 0380-CLAIM-END-FILE.
  8705
  8706     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8707         GO TO 0360-BROWSE-BACKWARD.
  8708
  8709     IF PI-CARRIER-SECURITY > SPACES
  8710         IF CL-CARRIER = PI-CARRIER-SECURITY
  8711             NEXT SENTENCE
  8712         ELSE
  8713             GO TO 0360-BROWSE-BACKWARD.
  8714
  8715     IF PI-ACCOUNT-SECURITY > SPACES
  8716         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8717             NEXT SENTENCE
  8718         ELSE
  8719             GO TO 0360-BROWSE-BACKWARD.
  8720
  8721     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8722     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8723     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8724
  8725     GO TO 0400-FIRST-TIME.
  8726
  8727 0380-CLAIM-END-FILE.
  8728
  8729     MOVE ER-0130     TO EMI-ERROR.
  8730     MOVE -1          TO CLMNOL.
  8731     MOVE AL-UABON    TO CARRA
  8732                         CLMNOA
  8733                         CERTNOA
  8734                         SUFXA.
  8735
  8736     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8737
  8738     GO TO 8200-SEND-DATAONLY.
  8739
  8740 0400-FIRST-TIME.
  8741
  8742     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 164
* EL156.cbl
  8743        MOVE 'N'         TO WS-BROWSE-START-SW
  8744
  8745* EXEC CICS ENDBR
  8746*            DATASET    ('ELMSTR')
  8747*       END-EXEC.
  8748     MOVE 'ELMSTR' TO DFHEIV1
  8749     MOVE 0
  8750       TO DFHEIV11
  8751*    MOVE '&2                    $   #00008583' TO DFHEIV0
  8752     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8753     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8754     MOVE X'2020233030303038353833' TO DFHEIV0(25:11)
  8755     CALL 'kxdfhei1' USING DFHEIV0,
  8756           DFHEIV1,
  8757           DFHEIV11,
  8758           DFHEIV99
  8759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8760
  8761
  8762     IF PI-PROCESSOR-ID = 'LGXX'
  8763         NEXT SENTENCE
  8764     ELSE
  8765
  8766* EXEC CICS READQ TS
  8767*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8768*            INTO    (SECURITY-CONTROL)
  8769*            LENGTH  (SC-COMM-LENGTH)
  8770*            ITEM    (SC-ITEM)
  8771*        END-EXEC
  8772*    MOVE '*$II   L              ''   #00008590' TO DFHEIV0
  8773     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8774     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8775     MOVE X'2020233030303038353930' TO DFHEIV0(25:11)
  8776     CALL 'kxdfhei1' USING DFHEIV0,
  8777           PI-SECURITY-TEMP-STORE-ID,
  8778           SECURITY-CONTROL,
  8779           SC-COMM-LENGTH,
  8780           SC-ITEM,
  8781           DFHEIV99,
  8782           DFHEIV99
  8783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8784         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8785         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8786
  8787     MOVE LOW-VALUES             TO EL156AI.
  8788     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8789     MOVE 'Y'                    TO FIRST-ENTRY.
  8790     GO TO 7000-SHOW-CLAIM.
  8791
  8792 0500-CREATE-TEMP-STORAGE.
  8793     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8794
  8795
  8796* EXEC CICS WRITEQ TS
  8797*        QUEUE (QID)
  8798*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8799*        LENGTH(PI-COMM-LENGTH)
  8800*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 165
* EL156.cbl
  8801*    MOVE '*"                    ''   #00008607' TO DFHEIV0
  8802     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8803     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8804     MOVE X'2020233030303038363037' TO DFHEIV0(25:11)
  8805     CALL 'kxdfhei1' USING DFHEIV0,
  8806           QID,
  8807           PROGRAM-INTERFACE-BLOCK,
  8808           PI-COMM-LENGTH,
  8809           DFHEIV99,
  8810           DFHEIV99,
  8811           DFHEIV99
  8812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8813
  8814
  8815
  8816* EXEC CICS WRITEQ TS
  8817*        QUEUE (QID)
  8818*        FROM  (EL156AI)
  8819*        LENGTH(MAP-LENGTH)
  8820*    END-EXEC.
  8821*    MOVE '*"                    ''   #00008613' TO DFHEIV0
  8822     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8823     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8824     MOVE X'2020233030303038363133' TO DFHEIV0(25:11)
  8825     CALL 'kxdfhei1' USING DFHEIV0,
  8826           QID,
  8827           EL156AI,
  8828           MAP-LENGTH,
  8829           DFHEIV99,
  8830           DFHEIV99,
  8831           DFHEIV99
  8832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8833
  8834
  8835 0599-EXIT.
  8836      EXIT.
  8837
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 166
* EL156.cbl
  8839 0600-RECOVER-TEMP-STORAGE.
  8840
  8841* EXEC CICS READQ TS
  8842*        QUEUE (QID)
  8843*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8844*        LENGTH(PI-COMM-LENGTH)
  8845*    END-EXEC.
  8846*    MOVE '*$I    L              ''   #00008624' TO DFHEIV0
  8847     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8848     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8849     MOVE X'2020233030303038363234' TO DFHEIV0(25:11)
  8850     CALL 'kxdfhei1' USING DFHEIV0,
  8851           QID,
  8852           PROGRAM-INTERFACE-BLOCK,
  8853           PI-COMM-LENGTH,
  8854           DFHEIV99,
  8855           DFHEIV99,
  8856           DFHEIV99
  8857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8858
  8859
  8860
  8861* EXEC CICS READQ TS
  8862*        QUEUE (QID)
  8863*        INTO  (EL156AI)
  8864*        LENGTH(MAP-LENGTH)
  8865*    END-EXEC.
  8866*    MOVE '*$I    L              ''   #00008630' TO DFHEIV0
  8867     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8868     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8869     MOVE X'2020233030303038363330' TO DFHEIV0(25:11)
  8870     CALL 'kxdfhei1' USING DFHEIV0,
  8871           QID,
  8872           EL156AI,
  8873           MAP-LENGTH,
  8874           DFHEIV99,
  8875           DFHEIV99,
  8876           DFHEIV99
  8877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8878
  8879
  8880     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8881
  8882     IF PMTTYPEI NOT = LOW-VALUES
  8883         MOVE AL-UANON           TO PMTTYPEA.
  8884
  8885     IF PAYEEI NOT = LOW-VALUES
  8886         MOVE AL-UANON           TO PAYEEA.
  8887
  8888     IF NOTE1I NOT = LOW-VALUES
  8889         MOVE AL-UANON           TO NOTE1A.
  8890
  8891     IF (RETURNED-FROM = 'EL614')
  8892        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8893     END-IF
  8894*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8895*       AND (PI-EOB-CODES-EXIST = 'Y')
  8896*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 167
* EL156.cbl
  8897*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8898     IF PI-SET-NOTE2-MDT = 'Y'
  8899         MOVE AL-SANON           TO NOTE2A
  8900     END-IF
  8901
  8902     IF OFFLINEI NOT = LOW-VALUES
  8903         MOVE AL-UANON           TO OFFLINEA.
  8904
  8905*    IF GROUPEDI NOT = LOW-VALUES
  8906*        MOVE AL-UANON           TO GROUPEDA.
  8907
  8908*    IF CASHI NOT = LOW-VALUES
  8909*        MOVE AL-UANON           TO CASHA.
  8910
  8911     IF CHECKNOI NOT = LOW-VALUES
  8912         MOVE AL-UANON           TO CHECKNOA.
  8913
  8914     IF HOLDTILI NOT = LOW-VALUES
  8915         MOVE AL-UANON           TO HOLDTILA.
  8916
  8917     IF EPYFROMI NOT = LOW-VALUES
  8918         MOVE AL-UANON           TO EPYFROMA.
  8919
  8920     IF AIGFROMI NOT = LOW-VALUES
  8921         MOVE AL-UANON           TO AIGFROMA.
  8922
  8923     IF EPYTHRUI NOT = LOW-VALUES
  8924         MOVE AL-UANON           TO EPYTHRUA.
  8925
  8926     IF EDAYSI NOT = LOW-VALUES
  8927         MOVE AL-UNNON           TO EDAYSA.
  8928
  8929     IF EPYAMTL NOT = +0
  8930         MOVE AL-UNNON           TO EPYAMTA.
  8931
  8932     IF ERESVL NOT = +0
  8933         MOVE AL-UNNON           TO ERESVA.
  8934
  8935     IF EEXPENSL NOT = +0
  8936         MOVE AL-UNNON           TO EEXPENSA.
  8937
  8938     IF ETYPEI NOT = LOW-VALUES
  8939         MOVE AL-UNNON           TO ETYPEA.
  8940
  8941     IF PROOFDTI NOT = 0
  8942         MOVE AL-UNNON           TO PROOFDTA.
  8943
  8944     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8945        MOVE AL-UANON            TO EOBYNA
  8946     END-IF
  8947     IF CLMFMYNI = 'Y' OR 'N'
  8948        MOVE AL-UANON            TO CLMFMYNA
  8949     END-IF
  8950
  8951     IF SURVYYNI = 'Y' OR 'N'
  8952        IF PI-APPROVAL-LEVEL = '4' OR '5'
  8953           MOVE AL-UANON         TO SURVYYNA
  8954        END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 168
* EL156.cbl
  8955     END-IF
  8956
  8957     IF SPRELYNI = 'Y' OR 'N'
  8958        MOVE AL-UANON            TO SPRELYNA
  8959     END-IF
  8960
  8961     .
  8962 0699-EXIT.
  8963      EXIT.
  8964
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 169
* EL156.cbl
  8966 0700-TEST-FOR-CHANGES.
  8967     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8968         MOVE ER-0433            TO EMI-ERROR
  8969         GO TO 0750-FUNCTION-ERROR.
  8970
  8971     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8972
  8973     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8974         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8975         MOVE 'A'                TO PI-PASS-SW
  8976         GO TO 1000-EDIT-DATA.
  8977
  8978     IF PI-FATAL-COUNT NOT = 0
  8979         MOVE ER-0499            TO EMI-ERROR
  8980         GO TO 0750-FUNCTION-ERROR.
  8981
  8982     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8983         MOVE ER-0500            TO EMI-ERROR
  8984         GO TO 0750-FUNCTION-ERROR.
  8985
  8986     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8987        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8988           MOVE ER-0542          TO EMI-ERROR
  8989           MOVE -1               TO EPYAMTL
  8990           GO TO 0750-FUNCTION-ERROR.
  8991
  8992     IF PI-OFFLINE = 'Y'  OR
  8993        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8994        MOVE EIBAID              TO PI-PFKEY-USED
  8995        GO TO 5000-UPDATE.
  8996
  8997     GO TO 6000-BUILD-SCREEN-B.
  8998
  8999 0750-FUNCTION-ERROR.
  9000     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9001
  9002     IF ENTERPFL > 0
  9003         MOVE -1                 TO ENTERPFL
  9004         MOVE AL-UNBON           TO ENTERPFA
  9005         GO TO 8200-SEND-DATAONLY
  9006     ELSE
  9007         MOVE -1                 TO ENTERPFL
  9008         MOVE AL-UNNOF           TO ENTERPFA
  9009         GO TO 8200-SEND-DATAONLY.
  9010
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 170
* EL156.cbl
  9012 0800-DELETE-TS.
  9013
  9014* EXEC CICS HANDLE CONDITION
  9015*        QIDERR(0800-EXIT)
  9016*    END-EXEC.
  9017*    MOVE '"$N                   ! % #00008769' TO DFHEIV0
  9018     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9019     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9020     MOVE X'2520233030303038373639' TO DFHEIV0(25:11)
  9021     CALL 'kxdfhei1' USING DFHEIV0
  9022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9023
  9024
  9025
  9026* EXEC CICS DELETEQ TS
  9027*        QUEUE(QID)
  9028*    END-EXEC.
  9029*    MOVE '*&                    #   #00008773' TO DFHEIV0
  9030     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9031     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9032     MOVE X'2020233030303038373733' TO DFHEIV0(25:11)
  9033     CALL 'kxdfhei1' USING DFHEIV0,
  9034           QID,
  9035           DFHEIV99
  9036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9037
  9038
  9039 0800-EXIT.
  9040      EXIT.
  9041 0900-GET-DDF-LIMITS.
  9042
  9043     if cm-clp-state = zeros or spaces or low-values
  9044        move cm-state            to cm-clp-state
  9045     end-if
  9046     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9047     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9048     MOVE cm-clp-state           TO ERPDEF-STATE
  9049     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9050     evaluate true
  9051        when (cl-claim-type = 'L' or 'P')
  9052           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9053             and 'CU')
  9054           move 'L'              to erpdef-ben-type
  9055           move pi-lf-benefit-cd to erpdef-ben-code
  9056        when (cl-claim-type not = 'L' and 'P')
  9057           and (pi-ah-benefit-cd not = '00' and '  ')
  9058           move 'A'              to erpdef-ben-type
  9059           move pi-ah-benefit-cd to erpdef-ben-code
  9060        when (cl-claim-type not = 'L' and 'P')
  9061           and (pi-ah-benefit-cd = '00' or '  ')
  9062           move 'L'              to erpdef-ben-type
  9063           move pi-lf-benefit-cd to erpdef-ben-code
  9064        when (cl-claim-type = 'L' or 'P')
  9065           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9066           move 'A'              to erpdef-ben-type
  9067           move pi-ah-benefit-cd to erpdef-ben-code
  9068        when other
  9069           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 171
* EL156.cbl
  9070           move pi-ah-benefit-cd to erpdef-ben-code
  9071     end-evaluate
  9072*    if (cl-claim-type = 'L' or 'P')
  9073*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9074*          and 'CU')
  9075*       move 'L'                 to erpdef-ben-type
  9076*       move pi-lf-benefit-cd    to erpdef-ben-code
  9077*    else
  9078*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9079*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9080*    end-if
  9081     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9082
  9083     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9084
  9085
  9086* EXEC CICS STARTBR
  9087*        DATASET  ('ERPDEF')
  9088*        RIDFLD   (ERPDEF-KEY)
  9089*        GTEQ
  9090*        RESP     (WS-RESPONSE)
  9091*    END-EXEC
  9092     MOVE 'ERPDEF' TO DFHEIV1
  9093     MOVE 0
  9094       TO DFHEIV11
  9095*    MOVE '&,         G          &  N#00008823' TO DFHEIV0
  9096     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9097     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9098     MOVE X'204E233030303038383233' TO DFHEIV0(25:11)
  9099     CALL 'kxdfhei1' USING DFHEIV0,
  9100           DFHEIV1,
  9101           ERPDEF-KEY,
  9102           DFHEIV99,
  9103           DFHEIV11,
  9104           DFHEIV99
  9105     MOVE EIBRESP  TO WS-RESPONSE
  9106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9107
  9108     IF NOT WS-RESP-NORMAL
  9109        GO TO 0900-EXIT
  9110     END-IF
  9111
  9112     .
  9113 0900-READNEXT.
  9114
  9115
  9116* EXEC CICS READNEXT
  9117*       DATASET  ('ERPDEF')
  9118*       SET      (ADDRESS OF PRODUCT-MASTER)
  9119*       RIDFLD   (ERPDEF-KEY)
  9120*       RESP     (WS-RESPONSE)
  9121*    END-EXEC
  9122     MOVE 'ERPDEF' TO DFHEIV1
  9123     MOVE 0
  9124       TO DFHEIV11
  9125*    MOVE '&.S                   )  N#00008837' TO DFHEIV0
  9126     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9127     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 172
* EL156.cbl
  9128     MOVE X'204E233030303038383337' TO DFHEIV0(25:11)
  9129     CALL 'kxdfhei1' USING DFHEIV0,
  9130           DFHEIV1,
  9131           DFHEIV20,
  9132           DFHEIV99,
  9133           ERPDEF-KEY,
  9134           DFHEIV99,
  9135           DFHEIV11,
  9136           DFHEIV99,
  9137           DFHEIV99
  9138     SET ADDRESS OF PRODUCT-MASTER TO
  9139         DFHEIV20
  9140     MOVE EIBRESP  TO WS-RESPONSE
  9141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9142
  9143     IF NOT WS-RESP-NORMAL
  9144        GO TO 0900-ENDBR
  9145     END-IF
  9146
  9147     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9148        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9149           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9150        ELSE
  9151           GO TO 0900-READNEXT
  9152        END-IF
  9153     ELSE
  9154        GO TO 0900-ENDBR
  9155     END-IF
  9156
  9157     IF CM-LOAN-TERM = ZEROS
  9158        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9159     END-IF
  9160
  9161     .
  9162 0900-ENDBR.
  9163
  9164
  9165* EXEC CICS ENDBR
  9166*       DATASET  ('ERPDEF')
  9167*    END-EXEC
  9168     MOVE 'ERPDEF' TO DFHEIV1
  9169     MOVE 0
  9170       TO DFHEIV11
  9171*    MOVE '&2                    $   #00008865' TO DFHEIV0
  9172     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9173     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9174     MOVE X'2020233030303038383635' TO DFHEIV0(25:11)
  9175     CALL 'kxdfhei1' USING DFHEIV0,
  9176           DFHEIV1,
  9177           DFHEIV11,
  9178           DFHEIV99
  9179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9180
  9181     .
  9182 0900-EXIT.
  9183     EXIT.
  9184 1000-EDIT-DATA.
  9185
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 173
* EL156.cbl
  9186     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9187         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9188         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9189
  9190     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9191
  9192     IF NOT MODIFY-CAP
  9193         MOVE ER-0070            TO EMI-ERROR
  9194         MOVE -1                 TO PMTTYPEL
  9195         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9196         GO TO 2000-EDIT-DONE.
  9197
  9198     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9199                         '5' AND '6'
  9200         MOVE ER-0420            TO EMI-ERROR
  9201         MOVE -1                 TO PMTTYPEL
  9202         MOVE AL-UABON           TO PMTTYPEA
  9203         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9204     ELSE
  9205         MOVE AL-UANON           TO PMTTYPEA.
  9206
  9207*    IF PI-OFFLINE = 'Y'
  9208*       IF PI-GROUPED = 'Y'
  9209*          MOVE ER-1880         TO EMI-ERROR
  9210*          MOVE -1              TO GROUPEDL
  9211*          MOVE AL-UABON        TO GROUPEDA
  9212*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9213*
  9214*    IF GROUPEDL > +0
  9215*       IF PI-GROUPED = 'Y' OR 'N'
  9216*          MOVE AL-UANON TO GROUPEDA
  9217*       ELSE
  9218*          MOVE ER-3140            TO EMI-ERROR
  9219*          MOVE -1                 TO GROUPEDL
  9220*          MOVE AL-UABON           TO GROUPEDA
  9221*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9222*
  9223*    IF CASHL > +0
  9224*       IF PI-CASH = 'Y' OR 'N'
  9225*          MOVE AL-UANON           TO CASHA
  9226*       ELSE
  9227*          MOVE ER-3141            TO EMI-ERROR
  9228*          MOVE -1                 TO CASHL
  9229*          MOVE AL-UABON           TO CASHA
  9230*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9231
  9232     IF LOANNOL > +0
  9233         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9234
  9235 1000-EDIT-PAYEE.
  9236
  9237     IF PI-PAYEE-SEQ NOT NUMERIC
  9238         MOVE ER-0294            TO  EMI-ERROR
  9239         MOVE -1                 TO  PAYEEL
  9240         MOVE AL-UABON           TO  PAYEEA
  9241         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9242         GO TO 1000-CONT-EDIT.
  9243
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 174
* EL156.cbl
  9244     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9245                         'E' OR 'O' OR 'Q'
  9246         NEXT SENTENCE
  9247     ELSE
  9248         MOVE ER-0294            TO  EMI-ERROR
  9249         MOVE -1                 TO  PAYEEL
  9250         MOVE AL-UABON           TO  PAYEEA
  9251         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9252         GO TO 1000-CONT-EDIT.
  9253
  9254     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9255        (PI-PAYEE-SEQ NOT < '1' AND
  9256         PI-PAYEE-SEQ NOT > '9'))
  9257      OR
  9258        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9259         (PI-PAYEE-SEQ NOT > '9'))
  9260         MOVE AL-UANON            TO PAYEEA
  9261     ELSE
  9262         MOVE ER-0294            TO EMI-ERROR
  9263         MOVE -1                 TO PAYEEL
  9264         MOVE AL-UABON           TO PAYEEA
  9265         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9266
  9267     IF PI-COMPANY-ID = 'DMD'
  9268         IF PI-PAYEE-TYPE = 'B' AND
  9269            PI-PAYEE-SEQ NOT = '0'
  9270               MOVE ER-7841            TO EMI-ERROR
  9271               MOVE -1                 TO PAYEEL
  9272               MOVE AL-UABON           TO PAYEEA
  9273               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9274
  9275     IF PI-COMPANY-ID = 'JHL'
  9276         IF PI-PAYEE = 'B0'
  9277             NEXT SENTENCE
  9278           ELSE
  9279
  9280* EXEC CICS HANDLE CONDITION
  9281*            ENDFILE(1950-NOT-FOUND)
  9282*            NOTFND (1950-NOT-FOUND)
  9283*        END-EXEC
  9284*    MOVE '"$''I                  ! & #00008967' TO DFHEIV0
  9285     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9286     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9287     MOVE X'2620233030303038393637' TO DFHEIV0(25:11)
  9288     CALL 'kxdfhei1' USING DFHEIV0
  9289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9290         MOVE 'N'                    TO FOUND-TOL-SW
  9291         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9292         MOVE '2'                    TO CNTL-REC-TYPE
  9293         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9294         MOVE +0                     TO CNTL-SEQ-NO
  9295         MOVE 'PROC'                 TO FILE-SWITCH
  9296         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9297         IF PI-PAYEE = 'I1' AND
  9298            APPROVAL-LEVEL-2
  9299             NEXT SENTENCE
  9300           ELSE
  9301         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 175
* EL156.cbl
  9302             MOVE ER-3546        TO EMI-ERROR
  9303             MOVE -1             TO PAYEEL
  9304             MOVE AL-UABON       TO PAYEEA
  9305             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9306
  9307     IF PI-PAYEE-TYPE = 'E'
  9308        IF PI-PMTTYPE = '5' OR '6'
  9309            NEXT SENTENCE
  9310        ELSE
  9311            MOVE ER-3539            TO EMI-ERROR
  9312            MOVE -1                 TO PAYEEL
  9313            MOVE AL-UABON           TO PAYEEA
  9314            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9315
  9316 1000-CONT-EDIT.
  9317
  9318     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9319        IF PI-EPYAMT NOT NEGATIVE
  9320            MOVE ER-0421         TO EMI-ERROR
  9321            MOVE -1              TO OFFLINEL
  9322            MOVE AL-UABON        TO OFFLINEA
  9323            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9324        ELSE
  9325            MOVE AL-UANON        TO OFFLINEA.
  9326
  9327     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9328        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9329           CONTINUE
  9330        ELSE
  9331           IF PI-PRINT-EOB-YN = 'S' AND
  9332              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9333                CONTINUE
  9334           ELSE
  9335              MOVE ER-1561       TO EMI-ERROR
  9336              MOVE -1            TO EOBYNL
  9337              MOVE AL-UABON      TO EOBYNA
  9338              PERFORM 9900-ERROR-FORMAT
  9339                                 THRU 9900-EXIT
  9340           END-IF
  9341        END-IF
  9342
  9343        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9344            MOVE ER-1566        TO EMI-ERROR
  9345            MOVE -1             TO CLMFMYNL
  9346            MOVE AL-UABON       TO CLMFMYNA
  9347            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9348        END-IF
  9349
  9350        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9351            MOVE ER-1567        TO EMI-ERROR
  9352            MOVE -1             TO SURVYYNL
  9353            MOVE AL-UABON       TO SURVYYNA
  9354            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9355        END-IF
  9356
  9357        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9358            MOVE ER-1569        TO EMI-ERROR
  9359            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 176
* EL156.cbl
  9360            MOVE AL-UABON       TO SPRELYNA
  9361            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9362        END-IF
  9363
  9364     END-IF
  9365     IF PI-EPYAMT IS NEGATIVE
  9366         IF PI-OFFLINE NOT = 'Y'
  9367             MOVE ER-0836        TO  EMI-ERROR
  9368             MOVE -1             TO  OFFLINEL
  9369             MOVE AL-UABON       TO  OFFLINEA
  9370             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9371
  9372     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9373        MOVE ER-0872             TO EMI-ERROR
  9374        MOVE -1                  TO PROOFDTL
  9375        MOVE AL-UABON            TO PROOFDTA
  9376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9377     ELSE
  9378        MOVE '4'                TO DC-OPTION-CODE
  9379        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9380        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9381        IF DATE-CONVERSION-ERROR
  9382            MOVE ER-0873        TO EMI-ERROR
  9383            MOVE -1                  TO PROOFDTL
  9384            MOVE AL-UABON            TO PROOFDTA
  9385            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9386        ELSE
  9387            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9388            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9389                MOVE ER-0873    TO EMI-ERROR
  9390                MOVE -1                  TO PROOFDTL
  9391                MOVE AL-UABON            TO PROOFDTA
  9392                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9393            END-IF
  9394        END-IF
  9395     END-IF.
  9396
  9397     IF PI-COMPANY-ID = 'DMD'
  9398        IF NOTE1L NOT = ZEROS
  9399            MOVE ER-7844        TO  EMI-ERROR
  9400            MOVE -1             TO  NOTE1L
  9401            MOVE AL-UABON       TO  NOTE1A
  9402            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9403
  9404     IF PI-COMPANY-ID = 'DMD'
  9405        IF NOTE2L NOT = ZEROS
  9406          GO TO 1004-DMD-EOB-CHECKS.
  9407
  9408     IF NOTE1L NOT > +0
  9409         GO TO 1005-CHECK-ERRORS.
  9410
  9411     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9412         GO TO 1005-CHECK-ERRORS.
  9413
  9414     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9415         GO TO 1003-HAN-PMT-NOTES.
  9416
  9417     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 177
* EL156.cbl
  9418
  9419     IF WS-PMTOPTION NUMERIC
  9420        IF WS-PMTOPTION > '00' AND < '17'
  9421           NEXT SENTENCE
  9422        ELSE
  9423           MOVE ER-0618          TO EMI-ERROR
  9424           MOVE -1               TO NOTE1L
  9425           MOVE AL-UABON         TO NOTE1A
  9426           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9427     ELSE
  9428        GO TO 1005-CHECK-ERRORS.
  9429
  9430     IF WS-PMTOPTION = '05' AND
  9431        WS-DOCNAME = SPACES
  9432          MOVE ER-0616             TO EMI-ERROR
  9433          MOVE -1                  TO NOTE1L
  9434          MOVE AL-UABON            TO NOTE1A
  9435          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9436
  9437     IF WS-PMTOPTION = '15' OR '16'
  9438
  9439* EXEC CICS BIF DEEDIT
  9440*            FIELD (WS-AMOUNT)
  9441*            LENGTH(08)
  9442*        END-EXEC
  9443     MOVE 08
  9444       TO DFHEIV11
  9445*    MOVE '@"L                   #   #00009119' TO DFHEIV0
  9446     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9447     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9448     MOVE X'2020233030303039313139' TO DFHEIV0(25:11)
  9449     CALL 'kxdfhei1' USING DFHEIV0,
  9450           WS-AMOUNT,
  9451           DFHEIV11
  9452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9453        IF (WS-NUM-AMT = ZEROS) OR
  9454           (WS-AMOUNT NOT NUMERIC)
  9455           MOVE ER-0617          TO EMI-ERROR
  9456           MOVE -1               TO NOTE1L
  9457           MOVE AL-UABON         TO NOTE1A
  9458           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9459
  9460     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9461
  9462     GO TO 1005-CHECK-ERRORS.
  9463
  9464 1003-HAN-PMT-NOTES.
  9465
  9466     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9467
  9468     IF WS-HAN-PMT-CODE = SPACE
  9469         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9470     ELSE
  9471     IF WS-HAN-PMT-CODE = 'A'
  9472         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9473                                 TO WS-HAN-PMT-NOTE
  9474     ELSE
  9475     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 178
* EL156.cbl
  9476         MOVE ':FINAL PAYMENT / DECEASED'
  9477                                 TO WS-HAN-PMT-NOTE
  9478     ELSE
  9479     IF WS-HAN-PMT-CODE = 'C'
  9480         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9481                                 TO WS-HAN-PMT-NOTE
  9482     ELSE
  9483     IF WS-HAN-PMT-CODE = 'D'
  9484         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9485                                 TO WS-HAN-PMT-NOTE
  9486     ELSE
  9487     IF WS-HAN-PMT-CODE = 'E'
  9488         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9489                                 TO WS-HAN-PMT-NOTE
  9490     ELSE
  9491     IF WS-HAN-PMT-CODE = 'F'
  9492         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9493                                 TO WS-HAN-PMT-NOTE
  9494     ELSE
  9495     IF WS-HAN-PMT-CODE = 'P'
  9496         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9497
  9498     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9499     GO TO 1005-CHECK-ERRORS.
  9500
  9501 1004-DMD-EOB-CHECKS.
  9502
  9503     INITIALIZE PI-AT-EOB-CODES.
  9504
  9505     IF NOTE2I (20:21) > SPACES
  9506         MOVE ER-7845          TO EMI-ERROR
  9507         MOVE -1               TO NOTE2L
  9508         MOVE AL-UABON         TO NOTE2A
  9509         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9510         GO TO 1005-CHECK-ERRORS
  9511      ELSE
  9512         MOVE NOTE2I             TO W-EOB-CODES.
  9513
  9514     MOVE +1                     TO W-EOB-NDX.
  9515
  9516 1004-CHECK-EACH-EOB.
  9517
  9518     IF W-EOB-NDX > +5
  9519             OR
  9520        W-EOB-CODE (W-EOB-NDX) = SPACES
  9521         GO TO 1004-CHECK-DUP-EOB.
  9522
  9523     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9524         MOVE ER-0956            TO EMI-ERROR
  9525         MOVE -1                 TO NOTE2L
  9526         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9527         GO TO 1005-CHECK-ERRORS.
  9528
  9529     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9530     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9531     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9532     MOVE 'DLO023'               TO PGM-NAME.
  9533
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 179
* EL156.cbl
  9534
  9535* EXEC CICS LINK
  9536*        PROGRAM    (PGM-NAME)
  9537*        COMMAREA   (CD-COMMUNICATION-AREA)
  9538*        LENGTH     (CD-RCRD-LENGTH)
  9539*    END-EXEC.
  9540*    MOVE '."C                   (   #00009204' TO DFHEIV0
  9541     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9542     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9543     MOVE X'2020233030303039323034' TO DFHEIV0(25:11)
  9544     CALL 'kxdfhei1' USING DFHEIV0,
  9545           PGM-NAME,
  9546           CD-COMMUNICATION-AREA,
  9547           CD-RCRD-LENGTH,
  9548           DFHEIV99,
  9549           DFHEIV99,
  9550           DFHEIV99,
  9551           DFHEIV99
  9552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9553
  9554
  9555     IF CD-RETURN-CODE = 'OK'
  9556         GO TO 1004-CONT.
  9557
  9558     MOVE -1                     TO NOTE2L.
  9559
  9560     IF CD-RETURN-CODE = '01'
  9561         MOVE ER-8310            TO EMI-ERROR
  9562         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9563         GO TO 1005-CHECK-ERRORS.
  9564
  9565     IF CD-RETURN-CODE = '02'
  9566         MOVE ER-8311            TO EMI-ERROR
  9567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9568         GO TO 1005-CHECK-ERRORS.
  9569
  9570     IF CD-RETURN-CODE = '03'
  9571         MOVE ER-8312            TO EMI-ERROR
  9572         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9573         GO TO 1005-CHECK-ERRORS.
  9574
  9575     IF CD-RETURN-CODE = '04'
  9576         MOVE ER-8313            TO EMI-ERROR
  9577         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9578         GO TO 1005-CHECK-ERRORS.
  9579
  9580     IF CD-RETURN-CODE = '05'
  9581         MOVE ER-8314            TO EMI-ERROR
  9582         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9583         GO TO 1005-CHECK-ERRORS.
  9584
  9585     IF CD-RETURN-CODE = '06'
  9586         MOVE ER-8315            TO EMI-ERROR
  9587         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9588         GO TO 1005-CHECK-ERRORS.
  9589
  9590     IF CD-RETURN-CODE = 'E1'
  9591         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 180
* EL156.cbl
  9592         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9593         GO TO 1005-CHECK-ERRORS.
  9594
  9595     IF CD-RETURN-CODE = 'N1'
  9596         MOVE ER-8317            TO EMI-ERROR
  9597         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9598         GO TO 1005-CHECK-ERRORS.
  9599
  9600 1004-CONT.
  9601     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9602
  9603     ADD +1 TO W-EOB-NDX.
  9604     GO TO 1004-CHECK-EACH-EOB.
  9605
  9606 1004-CHECK-DUP-EOB.
  9607     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9608         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9609                               PI-AT-EOB-CODE (3) OR
  9610                               PI-AT-EOB-CODE (4) OR
  9611                               PI-AT-EOB-CODE (5)))
  9612                  OR
  9613        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9614         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9615                               PI-AT-EOB-CODE (4) OR
  9616                               PI-AT-EOB-CODE (5)))
  9617                  OR
  9618        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9619         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9620                               PI-AT-EOB-CODE (5)))
  9621                  OR
  9622        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9623         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9624            MOVE ER-8000            TO EMI-ERROR
  9625            MOVE AL-UABON           TO NOTE2A
  9626            MOVE -1                 TO NOTE2L
  9627            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9628            GO TO 1005-CHECK-ERRORS.
  9629
  9630 1005-CHECK-ERRORS.
  9631*    IF PI-COMPANY-ID NOT = 'DMD'
  9632        GO TO 1006-CHECK-ERRORS.
  9633
  9634*********  DMD CODE START ******************
  9635*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9636*       GO TO 1006-CHECK-ERRORS.
  9637*
  9638*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9639*
  9640*    COMPUTE W-PAYMENT-TOTAL
  9641*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9642*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9643*               AND
  9644*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9645*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9646*          MOVE ER-0967    TO EMI-ERROR
  9647*          MOVE -1         TO PMTTYPEL
  9648*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9649*
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 181
* EL156.cbl
  9650*    GO TO 1006-CHECK-ERRORS.
  9651*********  DMD CODE END ******************
  9652
  9653 1006-CHECK-ERRORS.
  9654     IF NOT EMI-NO-ERRORS
  9655        GO TO 2000-EDIT-DONE.
  9656
  9657
  9658* EXEC CICS HANDLE CONDITION
  9659*        NOTFND(1950-NOT-FOUND)
  9660*    END-EXEC.
  9661*    MOVE '"$I                   ! '' #00009312' TO DFHEIV0
  9662     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9664     MOVE X'2720233030303039333132' TO DFHEIV0(25:11)
  9665     CALL 'kxdfhei1' USING DFHEIV0
  9666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9667
  9668
  9669     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9670     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9671     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9672     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9673     MOVE 'MSTR'                 TO FILE-SWITCH.
  9674
  9675     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9676
  9677     IF PI-COMPANY-ID = 'DMD'
  9678         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9679
  9680     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9681        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9682           MOVE ER-0873    TO EMI-ERROR
  9683           MOVE -1                  TO PROOFDTL
  9684           MOVE AL-UABON            TO PROOFDTA
  9685           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9686        END-IF
  9687     END-IF
  9688     if cl-benefit-period = zeros
  9689        move er-1667             to emi-error
  9690        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9691     end-if
  9692     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9693     MOVE +95                    TO TRLR-SEQ-NO
  9694
  9695* EXEC CICS READ
  9696*       DATASET  ('ELTRLR')
  9697*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9698*       RIDFLD   (ELTRLR-KEY)
  9699*       RESP     (WS-RESPONSE)
  9700*    END-EXEC
  9701     MOVE 'ELTRLR' TO DFHEIV1
  9702*    MOVE '&"S        E          (  N#00009341' TO DFHEIV0
  9703     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9704     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9705     MOVE X'204E233030303039333431' TO DFHEIV0(25:11)
  9706     CALL 'kxdfhei1' USING DFHEIV0,
  9707           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 182
* EL156.cbl
  9708           DFHEIV20,
  9709           DFHEIV99,
  9710           ELTRLR-KEY,
  9711           DFHEIV99,
  9712           DFHEIV99,
  9713           DFHEIV99
  9714     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9715         DFHEIV20
  9716     MOVE EIBRESP  TO WS-RESPONSE
  9717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9718
  9719     if ws-resp-normal
  9720        perform varying s1 from +1 by +1 until
  9721           at-note-error-no (s1) = spaces
  9722           if at-note-error-no (s1) = '1662'
  9723              continue
  9724           else
  9725              move at-note-error-no (s1)
  9726                                 to emi-error
  9727              if at-note-error-no (s1) = '1653'
  9728                 evaluate true
  9729                    when cl-claim-type = 'L'
  9730                       move '  LF  '
  9731                                 to emi-claim-type
  9732                    when cl-claim-type = 'I'
  9733                       move '  IU  '
  9734                                 to emi-claim-type
  9735                    when cl-claim-type = 'A'
  9736                       move '  AH  '
  9737                                 to emi-claim-type
  9738                    when other
  9739                       move ' FMLA '
  9740                                 to emi-claim-type
  9741                 end-evaluate
  9742              end-if
  9743              PERFORM 9900-ERROR-FORMAT
  9744                                 THRU 9900-EXIT
  9745           end-if
  9746        end-perform
  9747     end-if
  9748     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9749         IF PI-PMTTYPE = '5' OR '6'
  9750             NEXT SENTENCE
  9751         ELSE
  9752             MOVE ER-0555             TO EMI-ERROR
  9753             MOVE -1                  TO PMTTYPEL
  9754             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9755
  9756     IF CL-LAST-CLOSE-REASON = '2'
  9757         IF CL-CLAIM-STATUS = 'C'
  9758             MOVE ER-0760        TO  EMI-ERROR
  9759             MOVE -1             TO  PMTTYPEL
  9760             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9761
  9762     IF PI-ACTIVITY-CODE = 9
  9763         MOVE ER-3538            TO  EMI-ERROR
  9764         MOVE -1                 TO  PMTTYPEL
  9765         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 183
* EL156.cbl
  9766
  9767     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9768         GO TO 1008-READ-CERT.
  9769**********************AIG LOGIC STARTS *********************
  9770     IF CL-CERT-PRIME = 'INCOMPLETE'
  9771         MOVE ER-3540            TO  EMI-ERROR
  9772         MOVE -1                 TO  PMTTYPEL
  9773         MOVE AL-UABON           TO  PMTTYPEA
  9774         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9775         GO TO 2000-EDIT-DONE.
  9776
  9777     IF PI-PMTTYPE = '4'
  9778         IF PI-EPYAMT IS NEGATIVE
  9779             IF PI-ECHECKNO-CR = 'CR'
  9780                 NEXT SENTENCE
  9781             ELSE
  9782                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9783
  9784     IF PI-PMTTYPE = '4'
  9785         IF PI-ECHECKNO-CR = 'CR'
  9786             IF PI-EPYAMT IS NEGATIVE
  9787                 NEXT SENTENCE
  9788             ELSE
  9789                 MOVE ER-0834    TO  EMI-ERROR
  9790                 MOVE -1         TO  EPYAMTL
  9791                 MOVE AL-UNBON   TO  EPYAMTA
  9792                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9793
  9794     IF PI-PMTTYPE = '4'
  9795         IF PI-EPYAMT IS NEGATIVE
  9796             IF PI-OFFLINE = 'Y'
  9797                 NEXT SENTENCE
  9798             ELSE
  9799                 MOVE 'Y'        TO  PI-OFFLINE
  9800                                     WS-OFFLINE
  9801                                     OFFLINEO
  9802                 MOVE AL-UANON   TO  OFFLINEA.
  9803
  9804*    IF PI-PMTTYPE = '4'
  9805*        IF PI-EPYAMT IS NEGATIVE
  9806*            IF PI-CASH = 'Y'
  9807*                NEXT SENTENCE
  9808*            ELSE
  9809*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9810*                MOVE AL-UANON   TO  CASHA
  9811*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9812*
  9813*    IF PI-CASH NOT = 'Y' AND 'N'
  9814*         IF PI-OFFLINE = 'Y'  AND
  9815*            PI-ECHECKNO-CR = 'CR'
  9816*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9817*              MOVE AL-UANON     TO  CASHA
  9818*              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9819*
  9820*    IF PI-CASH NOT = 'Y' AND 'N'
  9821*        IF PI-PMTTYPE = '5' OR '6'
  9822*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9823*            MOVE AL-UANON       TO  CASHA
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 184
* EL156.cbl
  9824*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9825*
  9826*    IF PI-CASH NOT = 'Y' AND 'N'
  9827*       IF CL-ASSOCIATES = 'N' OR 'A'
  9828*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9829*           MOVE AL-UANON        TO  CASHA
  9830*       ELSE
  9831*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9832*           MOVE AL-UANON        TO  CASHA.
  9833*
  9834*    IF PI-PMTTYPE = '5' OR '6'
  9835*        IF PI-CASH = 'N'
  9836*            MOVE ER-0819        TO  EMI-ERROR
  9837*            MOVE AL-UANON       TO  CASHA
  9838*            MOVE -1             TO  CASHL
  9839*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9840*
  9841*    IF CL-ASSOCIATES = 'N' OR 'A'
  9842*       IF CASHI = 'N'
  9843*        MOVE ER-3537            TO  EMI-ERROR
  9844*        MOVE AL-UANON           TO  CASHA
  9845*        MOVE -1                 TO  CASHL
  9846*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9847
  9848 1007-DEFAULT-AIG-CHECKNO.
  9849
  9850     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9851         MOVE ER-3532            TO  EMI-ERROR
  9852         MOVE -1                 TO  PMTTYPEL
  9853         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9854**********************AIG LOGIC ENDS ***********************
  9855
  9856 1008-READ-CERT.
  9857
  9858     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9859     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9860     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9861     MOVE CL-CERT-STATE          TO CERT-STATE.
  9862     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9863     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9864     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9865     MOVE 'CERT'                 TO FILE-SWITCH.
  9866
  9867     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9868
  9869     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9870        MOVE CM-LF-LOAN-EXPIRE-DT
  9871                                 TO WS-EXP-DT PI-EXP-DT
  9872                                    ws-extended-exp-dt
  9873     ELSE
  9874        MOVE CM-AH-LOAN-EXPIRE-DT
  9875                                 TO WS-EXP-DT PI-EXP-DT
  9876                                    ws-extended-exp-dt
  9877     end-if
  9878     if pi-dcc-product-code not = spaces
  9879        move cm-ah-benefit-cd    to pi-ah-benefit-cd
  9880        move cm-lf-benefit-cd    to pi-lf-benefit-cd
  9881        PERFORM 0900-GET-DDF-limits
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 185
* EL156.cbl
  9882                                 THRU 0900-EXIT
  9883        IF PDEF-FOUND
  9884           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  9885              (P1 > +8)
  9886              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
  9887           END-PERFORM
  9888           IF P1 < +9
  9889              MOVE '6'           TO DC-OPTION-CODE
  9890              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
  9891              MOVE PD-MAX-EXTENSION (P1)
  9892                                 TO DC-ELAPSED-MONTHS
  9893              PERFORM 9700-LINK-DATE-CONVERT
  9894                                 THRU 9700-EXIT
  9895              if no-conversion-error
  9896                 move dc-bin-date-2 to ws-extended-exp-dt
  9897              end-if
  9898           else
  9899              move er-1674       to emi-error
  9900              PERFORM 9900-ERROR-FORMAT
  9901                                 THRU 9900-EXIT
  9902           end-if
  9903        end-if
  9904     end-if
  9905*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9906*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9907
  9908     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9909         MOVE ER-0458            TO EMI-ERROR
  9910         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9911
  9912     IF (CL-INCURRED-DT > WS-EXP-DT)
  9913        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
  9914        MOVE ER-1677             TO EMI-ERROR
  9915        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
  9916     END-IF
  9917     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
  9918     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
  9919         MOVE ER-0459            TO EMI-ERROR
  9920         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9921
  9922     IF CL-REPORTED-DT = LOW-VALUES
  9923        MOVE ER-0530             TO EMI-ERROR
  9924        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9925
  9926     IF PI-COMPANY-ID = 'NCL'
  9927        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9928            MOVE ER-0770            TO EMI-ERROR
  9929            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9930
  9931     IF PI-COMPANY-ID = 'NCL'
  9932        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9933            MOVE ER-0737            TO EMI-ERROR
  9934            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9935
  9936     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9937         MOVE ER-0768            TO  EMI-ERROR
  9938         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9939
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 186
* EL156.cbl
  9940     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9941         MOVE ER-0769            TO  EMI-ERROR
  9942         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9943
  9944     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9945         GO TO 1020-DO-LIFE-EDITS
  9946     ELSE
  9947         GO TO 1030-DO-AH-EDITS.
  9948
  9949 1010-GENERAL-ERROR.
  9950     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9951
  9952     IF EMI-MESSAGE-FORMATTED
  9953         MOVE -1                 TO PMTTYPEL.
  9954
  9955 1010-EXIT.
  9956     EXIT.
  9957
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 187
* EL156.cbl
  9959 1020-DO-LIFE-EDITS.
  9960     IF CM-LF-BENEFIT-CD = '00'
  9961         IF PI-PMTTYPE = '5' OR '6'
  9962             MOVE ER-0658        TO EMI-ERROR
  9963             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9964         ELSE
  9965            if (pi-company-id = 'DCC')
  9966               and (pi-dcc-product-code not = spaces)
  9967               continue
  9968            else
  9969               MOVE ER-1775      TO EMI-ERROR
  9970               PERFORM 1040-PMTTYPE-ERROR
  9971                                 THRU 1040-EXIT
  9972            end-if
  9973         end-if
  9974     end-if
  9975
  9976     move cm-ah-benefit-cd to pi-ah-benefit-cd
  9977     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9978         MOVE ER-0460            TO EMI-ERROR
  9979         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9980
  9981     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9982     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9983     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9984     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9985     MOVE '4'                    TO  CNTL-REC-TYPE.
  9986     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9987     MOVE 'BENE'                 TO  FILE-SWITCH.
  9988     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9989     IF NO-BENEFIT-FOUND
  9990         GO TO 1950-NOT-FOUND.
  9991
  9992     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9993
  9994     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9995         IF PI-PMTTYPE = '4'
  9996             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9997                PI-LF-COVERAGE-TYPE = 'P'
  9998                 NEXT SENTENCE
  9999             ELSE
 10000                 MOVE ER-0461        TO EMI-ERROR
 10001                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10002         ELSE
 10003            NEXT SENTENCE
 10004     ELSE
 10005         IF PI-PMTTYPE = '2'
 10006            IF NOT CM-O-B-COVERAGE
 10007              AND CM-LF-CURRENT-STATUS = '7'
 10008                MOVE ER-0462     TO EMI-ERROR
 10009                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10010
 10011     IF PI-PMTTYPE = '2'
 10012         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10013            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10014             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
 10015             MOVE ER-0730            TO  EMI-ERROR
 10016             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 188
* EL156.cbl
 10017             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10018
 10019     IF PI-PMTTYPE = '2'
 10020         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10021            PI-LF-COVERAGE-TYPE = 'P'
 10022             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10023                 MOVE ER-0462    TO  EMI-ERROR
 10024                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10025
 10026     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10027       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10028         MOVE ER-0466            TO EMI-ERROR
 10029         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10030
 10031     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10032         IF PI-PMTTYPE = '3'
 10033             MOVE 0436           TO EMI-ERROR
 10034             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10035             GO TO 1045-EDIT-PAYEE-ADDR
 10036         ELSE
 10037             GO TO 1045-EDIT-PAYEE-ADDR.
 10038
 10039     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10040        PI-LF-COVERAGE-TYPE = 'P'
 10041         IF PI-PMTTYPE = '3'
 10042             MOVE ER-0436          TO  EMI-ERROR
 10043             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10044         ELSE
 10045             NEXT SENTENCE
 10046     ELSE
 10047         IF PI-PMTTYPE = '1' OR '3'
 10048             MOVE ER-0436            TO EMI-ERROR
 10049             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10050*
 10051     IF PI-COMPANY-ID = 'CID' AND
 10052        CL-CERT-STATE = 'SC'  AND
 10053        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10054           MOVE ER-0879    TO  EMI-ERROR
 10055           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10056           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10057     END-IF.
 10058     IF PI-COMPANY-ID = 'AHL'
 10059        evaluate true
 10060           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10061              MOVE ER-0879       TO  EMI-ERROR
 10062              PERFORM 1040-PMTTYPE-ERROR
 10063                                 THRU 1040-EXIT
 10064              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10065           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10066                 '6D' OR '6H' OR '6R'
 10067              MOVE ER-0879       TO  EMI-ERROR
 10068              PERFORM 1040-PMTTYPE-ERROR
 10069                                 THRU 1040-EXIT
 10070              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10071           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10072              MOVE ER-0879       TO  EMI-ERROR
 10073              PERFORM 1040-PMTTYPE-ERROR
 10074                                 THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 189
* EL156.cbl
 10075              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10076        end-evaluate
 10077     END-IF
 10078     GO TO 1045-EDIT-PAYEE-ADDR.
 10079
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 190
* EL156.cbl
 10081 1030-DO-AH-EDITS.
 10082     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10083     IF CM-AH-BENEFIT-CD = '00'
 10084         IF PI-PMTTYPE = '5' OR '6'
 10085             MOVE ER-0658        TO EMI-ERROR
 10086             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10087         ELSE
 10088             MOVE ER-1775        TO EMI-ERROR
 10089             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10090
 10091     IF CL-TOTAL-PAID-AMT = ZEROS
 10092         IF PI-PMTTYPE = '4'
 10093             MOVE ER-0438        TO EMI-ERROR
 10094             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10095
 10096     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10097         IF PI-PMTTYPE = '3'
 10098             MOVE ER-0463        TO EMI-ERROR
 10099             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10100         ELSE
 10101             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10102              AND CM-LF-CURRENT-STATUS = '7'
 10103                 MOVE ER-0465    TO EMI-ERROR
 10104                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10105
 10106     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10107         IF PI-PMTTYPE = '3'
 10108             MOVE ER-0464        TO EMI-ERROR
 10109             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10110         ELSE
 10111             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10112                 MOVE ER-0469    TO EMI-ERROR
 10113                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10114
 10115     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10116         IF PI-PMTTYPE = '3'
 10117             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10118                 MOVE ER-0467    TO EMI-ERROR
 10119                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10120             ELSE
 10121                 NEXT SENTENCE
 10122         ELSE
 10123             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10124                 MOVE ER-0468    TO EMI-ERROR
 10125                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10126
 10127     GO TO 1045-EDIT-PAYEE-ADDR.
 10128
 10129 1040-PMTTYPE-ERROR.
 10130     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10131
 10132     IF EMI-MESSAGE-FORMATTED
 10133         MOVE -1                 TO PMTTYPEL
 10134         MOVE AL-UABON           TO PMTTYPEA.
 10135
 10136 1040-EXIT.
 10137     EXIT.
 10138
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 191
* EL156.cbl
 10140 1045-EDIT-PAYEE-ADDR.
 10141
 10142     IF PI-OFFLINE = 'N' AND
 10143        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10144           < PI-PAYEE-SEQ-NUM)
 10145        OR
 10146         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10147         (PI-PAYEE-TYPE = 'B')                 AND
 10148         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10149        OR
 10150         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10151           < PI-PAYEE-SEQ-NUM)
 10152        OR
 10153         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10154           < PI-PAYEE-SEQ-NUM)
 10155        OR
 10156         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10157           < PI-PAYEE-SEQ-NUM)
 10158        OR
 10159         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10160           < PI-PAYEE-SEQ-NUM)
 10161        OR
 10162         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10163           < PI-PAYEE-SEQ-NUM))
 10164             MOVE ER-0437        TO EMI-ERROR
 10165             MOVE -1             TO PAYEEL
 10166             MOVE AL-UABON       TO PAYEEA
 10167             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10168
 10169     IF PI-OFFLINE    = 'N' AND
 10170        PI-PAYEE-TYPE = 'B' AND
 10171        PI-PAYEE-SEQ  = '0'
 10172         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10173         IF BENE-FOUND-SW = 'N'
 10174             MOVE ER-0437        TO EMI-ERROR
 10175             MOVE -1             TO PAYEEL
 10176             MOVE AL-UABON       TO PAYEEA
 10177             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10178
 10179     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10180        IF PI-OFFLINE    = 'N'  AND
 10181           PI-PAYEE-TYPE = 'B'  AND
 10182           PI-PAYEE-SEQ  = '9'
 10183             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10184             IF BENE-FOUND-SW = 'N'
 10185                MOVE ER-0437        TO EMI-ERROR
 10186                MOVE -1             TO PAYEEL
 10187                MOVE AL-UABON       TO PAYEEA
 10188                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10189
 10190*    IF PI-COMPANY-ID = 'CRI'
 10191*        IF CL-CLAIM-TYPE = 'L'
 10192*            MOVE 'N'                TO  WS-GROUPED
 10193*                                        PI-GROUPED
 10194*                                        GROUPEDI
 10195*            MOVE AL-UANON           TO  GROUPEDA
 10196*            GO TO 1050-EDIT-CHECK-NO
 10197*        ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 192
* EL156.cbl
 10198*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10199*            IF WS-GROUP-1 = 'C'
 10200*                NEXT SENTENCE
 10201*            ELSE
 10202*                MOVE 'N'            TO  WS-GROUPED
 10203*                                        PI-GROUPED
 10204*                                        GROUPEDI
 10205*                MOVE AL-UANON       TO  GROUPEDA
 10206*                GO TO 1050-EDIT-CHECK-NO.
 10207
 10208*     IF PI-GROUPED = 'Y'
 10209*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10210*           NEXT SENTENCE
 10211*        ELSE
 10212*           MOVE ER-0437        TO EMI-ERROR
 10213*           MOVE -1             TO PAYEEL
 10214**02180            MOVE AL-UABON       TO PAYEEA
 10215*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10216*
 10217*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10218*        (PI-GROUPED    = ' ')
 10219*        NEXT SENTENCE
 10220*     ELSE
 10221*
 10222     GO TO 1050-EDIT-CHECK-NO.
 10223*     IF PI-COMPANY-ID = 'CRI'
 10224*        MOVE 'N'           TO GROUPEDI
 10225*                              PI-GROUPED
 10226*                              WS-GROUPED
 10227*        MOVE AL-UANON      TO GROUPEDA.
 10228*
 10229*     IF PI-COMPANY-ID = 'CRI'
 10230*        IF PI-PAYEE-TYPE = 'B'
 10231*           IF BENE-FOUND-SW = 'Y'
 10232*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10233*                 MOVE 'Y'           TO GROUPEDI
 10234*                                       PI-GROUPED
 10235*                                       WS-GROUPED
 10236*                 MOVE AL-UANON      TO GROUPEDA
 10237*              ELSE
 10238*                 NEXT SENTENCE
 10239*           ELSE
 10240*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10241*              IF BENE-FOUND-SW = 'Y'
 10242*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10243*                    MOVE 'Y'      TO GROUPEDI
 10244*                                     PI-GROUPED
 10245*                                     WS-GROUPED
 10246*                    MOVE AL-UANON TO GROUPEDA.
 10247*
 10248
 10249     IF PI-COMPANY-ID NOT = 'CRI'
 10250        GO TO 1050-EDIT-CHECK-NO.
 10251
 10252*************** CRI CODE START ******************
 10253     IF PI-PAYEE-TYPE NOT = 'A'
 10254        GO TO 1050-EDIT-CHECK-NO.
 10255
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 193
* EL156.cbl
 10256     MOVE LOW-VALUES             TO ERACCT-KEY.
 10257     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10258     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10259     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10260     MOVE PI-STATE               TO ACCT-STATE.
 10261     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10262     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10263     MOVE 'ACCT'                 TO FILE-SWITCH.
 10264
 10265     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10266     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10267
 10268
 10269* EXEC CICS HANDLE CONDITION
 10270*         NOTFND   (1950-NOT-FOUND)
 10271*         ENDFILE  (1950-NOT-FOUND)
 10272*    END-EXEC.
 10273*    MOVE '"$I''                  ! ( #00009897' TO DFHEIV0
 10274     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10275     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10276     MOVE X'2820233030303039383937' TO DFHEIV0(25:11)
 10277     CALL 'kxdfhei1' USING DFHEIV0
 10278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10279
 10280
 10281
 10282* EXEC CICS STARTBR
 10283*         DATASET   ('ERACCT')
 10284*         RIDFLD    (ERACCT-KEY)
 10285*         GTEQ
 10286*    END-EXEC.
 10287     MOVE 'ERACCT' TO DFHEIV1
 10288     MOVE 0
 10289       TO DFHEIV11
 10290*    MOVE '&,         G          &   #00009902' TO DFHEIV0
 10291     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10292     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10293     MOVE X'2020233030303039393032' TO DFHEIV0(25:11)
 10294     CALL 'kxdfhei1' USING DFHEIV0,
 10295           DFHEIV1,
 10296           ERACCT-KEY,
 10297           DFHEIV99,
 10298           DFHEIV11,
 10299           DFHEIV99
 10300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10301
 10302
 10303 1046-READNEXT-ERACCT.
 10304
 10305
 10306* EXEC CICS READNEXT
 10307*         DATASET   ('ERACCT')
 10308*         RIDFLD    (ERACCT-KEY)
 10309*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10310*    END-EXEC.
 10311     MOVE 'ERACCT' TO DFHEIV1
 10312     MOVE 0
 10313       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 194
* EL156.cbl
 10314*    MOVE '&.S                   )   #00009910' TO DFHEIV0
 10315     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10316     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10317     MOVE X'2020233030303039393130' TO DFHEIV0(25:11)
 10318     CALL 'kxdfhei1' USING DFHEIV0,
 10319           DFHEIV1,
 10320           DFHEIV20,
 10321           DFHEIV99,
 10322           ERACCT-KEY,
 10323           DFHEIV99,
 10324           DFHEIV11,
 10325           DFHEIV99,
 10326           DFHEIV99
 10327     SET ADDRESS OF ACCOUNT-MASTER TO
 10328         DFHEIV20
 10329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10330
 10331
 10332     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10333        IF WS-ERACCT-HOLD-RECORD = SPACES
 10334           GO TO 1950-NOT-FOUND
 10335        ELSE
 10336           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10337           GO TO 1048-CONTINUE.
 10338
 10339     IF ACCT-EXP-DT = HIGH-VALUES
 10340        NEXT SENTENCE
 10341     ELSE
 10342        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10343        GO TO 1046-READNEXT-ERACCT.
 10344
 10345 1048-CONTINUE.
 10346
 10347*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10348*       MOVE 'Y'                 TO GROUPEDI
 10349*                                   PI-GROUPED
 10350*                                   WS-GROUPED
 10351*       MOVE AL-UANON            TO GROUPEDA.
 10352*************** CRI CODE END ******************
 10353
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 195
* EL156.cbl
 10355 1050-EDIT-CHECK-NO.
 10356
 10357     IF PI-OFFLINE = 'Y'
 10358         IF PI-ECHECKNO = SPACES
 10359              MOVE ER-0439        TO EMI-ERROR
 10360              GO TO 1090-CHECK-NO-ERROR
 10361           ELSE
 10362*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10363*           IF PI-ECHECKNO-N = 'N' AND
 10364*              PI-CASH       = 'Y'
 10365*                MOVE ER-3535        TO EMI-ERROR
 10366*                GO TO 1090-CHECK-NO-ERROR
 10367*             ELSE
 10368*                MOVE AL-UANON    TO CHECKNOA
 10369*                GO TO 1100-EDIT-HOLDTIL
 10370*         ELSE
 10371            MOVE AL-UANON    TO CHECKNOA
 10372            GO TO 1100-EDIT-HOLDTIL.
 10373
 10374     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10375     MOVE '6'                    TO CNTL-REC-TYPE.
 10376
 10377     IF CONTROL-IS-ACTUAL-CARRIER
 10378         MOVE PI-CARRIER         TO WS-CARR
 10379     ELSE
 10380         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10381
 10382     IF PI-COMPANY-ID = 'FIA'
 10383         MOVE PI-CARRIER         TO WS-CARR.
 10384
 10385     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10386     MOVE 0                      TO CNTL-SEQ-NO.
 10387     MOVE 'CARR'                 TO FILE-SWITCH.
 10388
 10389     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10390
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 196
* EL156.cbl
 10392     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10393         GO TO 1051-EDIT-CHECKNO-CONT.
 10394
 10395**********************AIG LOGIC STARTS**********************
 10396     IF PI-ECHECKNO = SPACES
 10397         IF CHECK-NO-MANUAL
 10398             MOVE ER-0441        TO EMI-ERROR
 10399             GO TO 1090-CHECK-NO-ERROR
 10400         ELSE
 10401             MOVE AL-UANOF       TO CHECKNOA
 10402             GO TO 1100-EDIT-HOLDTIL.
 10403
 10404     IF PI-ECHECKNO NOT = SPACES
 10405         IF CHECK-NO-MANUAL
 10406             MOVE AL-UANON       TO CHECKNOA
 10407             GO TO 1100-EDIT-HOLDTIL.
 10408
 10409     IF PI-ECHECKNO-CR = 'CR'
 10410        IF PI-OFFLINE = 'Y'
 10411            MOVE AL-UANON       TO CHECKNOA
 10412            GO TO 1100-EDIT-HOLDTIL
 10413        ELSE
 10414            MOVE ER-3534        TO EMI-ERROR
 10415            GO TO 1090-CHECK-NO-ERROR.
 10416
 10417     IF PI-ECHECKNO-N = 'N'
 10418        IF PI-CASH = 'N'
 10419            MOVE AL-UANON       TO CHECKNOA
 10420            GO TO 1100-EDIT-HOLDTIL
 10421        ELSE
 10422            MOVE ER-3535          TO EMI-ERROR
 10423            GO TO 1090-CHECK-NO-ERROR.
 10424
 10425     MOVE ER-0442        TO EMI-ERROR
 10426     GO TO 1090-CHECK-NO-ERROR.
 10427**********************AIG LOGIC ENDS************************
 10428
 10429 1051-EDIT-CHECKNO-CONT.
 10430
 10431     IF PI-COMPANY-ID = 'DMD'
 10432        IF PI-ECHECKNO NOT = SPACES
 10433           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10434              MOVE ER-0442        TO EMI-ERROR
 10435              GO TO 1090-CHECK-NO-ERROR
 10436            ELSE
 10437              GO TO 1100-EDIT-HOLDTIL
 10438          ELSE
 10439           GO TO 1100-EDIT-HOLDTIL.
 10440
 10441     IF PI-ECHECKNO = SPACES
 10442         IF CHECK-NO-MANUAL
 10443             MOVE ER-0441        TO EMI-ERROR
 10444             GO TO 1090-CHECK-NO-ERROR
 10445         ELSE
 10446             MOVE AL-UANOF       TO CHECKNOA
 10447             GO TO 1100-EDIT-HOLDTIL
 10448     ELSE
 10449         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 197
* EL156.cbl
 10450             MOVE AL-UANON       TO CHECKNOA
 10451             GO TO 1100-EDIT-HOLDTIL
 10452         ELSE
 10453             MOVE ER-0442        TO EMI-ERROR
 10454             GO TO 1090-CHECK-NO-ERROR.
 10455
 10456 1090-CHECK-NO-ERROR.
 10457     MOVE -1                     TO CHECKNOL.
 10458     MOVE AL-UABON               TO CHECKNOA.
 10459     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10460
 10461     GO TO 2000-EDIT-DONE.
 10462
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 198
* EL156.cbl
 10464 1100-EDIT-HOLDTIL.
 10465     MOVE AL-UANON               TO HOLDTILA.
 10466
 10467     IF PI-HOLDTIL = ZEROS
 10468        IF PI-OFFLINE = 'Y'
 10469           MOVE ER-0572          TO EMI-ERROR
 10470           GO TO 1105-HOLDTIL-ERROR
 10471        ELSE
 10472           GO TO 1110-EDIT-PAID-FROM.
 10473
 10474     MOVE '4'                    TO DC-OPTION-CODE.
 10475     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10476     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10477
 10478     IF DATE-CONVERSION-ERROR
 10479         MOVE ER-0446            TO EMI-ERROR
 10480         GO TO 1105-HOLDTIL-ERROR
 10481     END-IF
 10482     IF PI-OFFLINE = 'Y'
 10483        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10484           MOVE ER-0446            TO EMI-ERROR
 10485           GO TO 1105-HOLDTIL-ERROR
 10486        END-IF
 10487     END-IF
 10488
 10489     IF PI-OFFLINE = 'Y'
 10490        GO TO 1110-EDIT-PAID-FROM.
 10491
 10492     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10493     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10494     MOVE '1'                    TO DC-OPTION-CODE.
 10495     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10496
 10497     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10498         MOVE ER-0447            TO EMI-ERROR
 10499         GO TO 1105-HOLDTIL-ERROR.
 10500
 10501     GO TO 1110-EDIT-PAID-FROM.
 10502
 10503 1105-HOLDTIL-ERROR.
 10504     MOVE -1                     TO HOLDTILL.
 10505     MOVE AL-UNBON               TO HOLDTILA.
 10506     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10507
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 199
* EL156.cbl
 10509 1110-EDIT-PAID-FROM.
 10510     MOVE AL-UANON               TO EPYFROMA.
 10511
 10512     IF PI-EPYFROM = ZEROS
 10513         GO TO 1120-CALCULATE-PAID-FROM.
 10514
 10515     IF PI-PMTTYPE = '5' OR '6'
 10516         MOVE ER-0448            TO EMI-ERROR
 10517         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10518         MOVE AL-UNBON           TO EPYFROMA
 10519         MOVE -1                 TO EPYFROML
 10520         GO TO 1150-EDIT-PAID-THRU.
 10521
 10522     MOVE '4'                    TO DC-OPTION-CODE.
 10523     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10524     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10525
 10526     IF DATE-CONVERSION-ERROR
 10527         MOVE ER-0449            TO EMI-ERROR
 10528         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10529         MOVE AL-UNBON           TO EPYFROMA
 10530         MOVE -1                 TO EPYFROML
 10531     ELSE
 10532         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10533
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 200
* EL156.cbl
 10535 1120-CALCULATE-PAID-FROM.
 10536     IF PI-PMTTYPE = '5' OR '6'
 10537         GO TO 1150-EDIT-PAID-THRU.
 10538
 10539*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10540*       IF PI-PMTTYPE = '4'
 10541*         GO TO 1150-EDIT-PAID-THRU.
 10542
 10543     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10544         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10545         MOVE ' '                TO DC-OPTION-CODE
 10546         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10547         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10548         GO TO 1145-TEST-PAID-FROM.
 10549
 10550     IF PI-PMTTYPE = '4'
 10551        GO TO 1150-EDIT-PAID-THRU.
 10552
 10553     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10554     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10555     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10556     MOVE '5'                    TO CNTL-REC-TYPE.
 10557     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10558     MOVE 'BENE'                 TO FILE-SWITCH.
 10559
 10560     IF WS-BEN-CD = ZEROS
 10561         GO TO 1950-NOT-FOUND.
 10562
 10563     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10564
 10565     IF NO-BENEFIT-FOUND
 10566         GO TO 1950-NOT-FOUND.
 10567
 10568     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10569     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10570
 10571     IF PI-BEN-DAYS NOT NUMERIC
 10572        MOVE ZEROS               TO PI-BEN-DAYS.
 10573
 10574     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10575
 10576     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10577        (CL-TOTAL-PAID-AMT > ZEROS)
 10578         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10579         MOVE '6'                 TO DC-OPTION-CODE
 10580         MOVE +0                  TO DC-ELAPSED-MONTHS
 10581         MOVE +1                  TO DC-ELAPSED-DAYS
 10582         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10583         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10584         GO TO 1145-TEST-PAID-FROM.
 10585
 10586******************************************************************
 10587****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10588****** SPECIAL ENTERED DATE.
 10589******************************************************************
 10590
 10591     IF PI-AIGFROM = ZEROS
 10592         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 201
* EL156.cbl
 10593
 10594     MOVE AL-UANON TO AIGFROMA.
 10595
 10596     MOVE '4'                    TO DC-OPTION-CODE.
 10597     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10598     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10599
 10600     IF DATE-CONVERSION-ERROR
 10601         MOVE ER-0449            TO EMI-ERROR
 10602         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10603         MOVE AL-UNBON           TO AIGFROMA
 10604         MOVE -1                 TO AIGFROML
 10605         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10606     ELSE
 10607         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10608         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10609
 10610     GO TO 1140-CONTINUE-PAID-FROM.
 10611
 10612 1130-CONTINUE-PAID-FROM.
 10613
 10614     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10615        (CL-TOTAL-PAID-AMT = ZEROS)
 10616           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10617
 10618 1140-CONTINUE-PAID-FROM.
 10619
 10620     IF PI-BEN-TYPE = 'R'
 10621         IF PI-BEN-DAYS = ZEROS
 10622             NEXT SENTENCE
 10623         ELSE
 10624         IF PI-COMPANY-ID NOT = 'DMD'
 10625             SUBTRACT 1 FROM PI-BEN-DAYS.
 10626
 10627     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10628
 10629     IF PI-COMPANY-ID = 'DMD'
 10630         MOVE -1                 TO DC-ELAPSED-DAYS
 10631         MOVE +0                 TO DC-ELAPSED-MONTHS
 10632         MOVE '6'                TO DC-OPTION-CODE
 10633         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10634         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10635         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10636                               REMAINDER DC-ELAPSED-DAYS
 10637      ELSE
 10638         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10639         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10640
 10641     MOVE '6'                    TO DC-OPTION-CODE.
 10642     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10643     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10644
 10645     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10646
 10647     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10648         MOVE ER-0541            TO EMI-ERROR
 10649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10650         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 202
* EL156.cbl
 10651         MOVE AL-UNBON           TO EPYFROMA.
 10652
 10653     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10654        (PI-BENEFIT-SAVE = '60E')
 10655        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10656           (CL-TOTAL-PAID-AMT = ZEROS)
 10657             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10658             MOVE 30                  TO DC-ELAPSED-DAYS
 10659             MOVE +0                  TO DC-ELAPSED-MONTHS
 10660             MOVE '6'                 TO DC-OPTION-CODE
 10661             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10662
 10663     IF PI-BEN-TYPE = 'R'
 10664         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10665     ELSE
 10666         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10667         IF WS-SV-EPYFROM = LOW-VALUES
 10668            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10669
 10670     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10671         IF WS-USE-AIG-PAYFROM   OR
 10672            WS-AIG-RECALC-PAYFROM
 10673              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10674                                      DC-BIN-DATE-1
 10675              MOVE ' '            TO  DC-OPTION-CODE
 10676              MOVE +0             TO  DC-ELAPSED-MONTHS
 10677                                      DC-ELAPSED-DAYS
 10678              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10679              IF NO-CONVERSION-ERROR
 10680                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10681
 10682     IF PI-CPYFROM < CL-INCURRED-DT
 10683        MOVE -1                  TO EPYFROML
 10684        MOVE ER-3542             TO EMI-ERROR
 10685        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10686
 10687     IF CM-ENTRY-DT < CL-INCURRED-DT
 10688        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10689        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10690        MOVE +0                     TO DC-ELAPSED-DAYS
 10691        MOVE +0                     TO DC-ELAPSED-MONTHS
 10692        MOVE '1'                    TO DC-OPTION-CODE
 10693        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10694        ELSE
 10695        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10696
 10697     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10698         NEXT SENTENCE
 10699     ELSE
 10700         IF DC-ELAPSED-MONTHS < 2
 10701             MOVE ER-3255        TO EMI-ERROR
 10702             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10703
 10704 1145-TEST-PAID-FROM.
 10705     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10706         GO TO 1150-EDIT-PAID-THRU.
 10707
 10708     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 203
* EL156.cbl
 10709         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10710         MOVE ' '                TO DC-OPTION-CODE
 10711         MOVE +0                 TO DC-ELAPSED-MONTHS
 10712                                    DC-ELAPSED-DAYS
 10713         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10714         IF NO-CONVERSION-ERROR
 10715             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10716         ELSE
 10717             MOVE SPACES             TO EMI-DATE-FIELD.
 10718
 10719     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10720         IF CL-TOTAL-PAID-AMT = ZEROS
 10721             MOVE ER-3543            TO EMI-ERROR
 10722             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10723             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10724             IF EMI-MESSAGE-FORMATTED
 10725                MOVE -1             TO EPYFROML
 10726                MOVE AL-UNBON       TO EPYFROMA
 10727             ELSE
 10728                NEXT SENTENCE
 10729         ELSE
 10730             MOVE ER-0452            TO EMI-ERROR
 10731             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10732             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10733             IF EMI-MESSAGE-FORMATTED
 10734                MOVE -1             TO EPYFROML
 10735                MOVE AL-UNBON       TO EPYFROMA.
 10736
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 204
* EL156.cbl
 10738 1150-EDIT-PAID-THRU.
 10739
 10740     MOVE AL-UANON               TO EPYTHRUA.
 10741
 10742     IF PI-EPYTHRU = ZEROS
 10743         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10744             GO TO 1200-EDIT-FIND-TOLERANCES
 10745         ELSE
 10746            IF (PI-PMTTYPE = '3') OR
 10747               (PI-PMTTYPE = '2' AND
 10748                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10749               GO TO 1152-CHECK-TYPE
 10750            ELSE
 10751               MOVE ER-0473      TO EMI-ERROR
 10752               GO TO 1170-PAID-THRU-FATAL-ERROR
 10753     ELSE
 10754         IF PI-PMTTYPE = '5' OR '6'
 10755             MOVE ER-0474        TO EMI-ERROR
 10756             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10757
 10758     MOVE '4'                    TO DC-OPTION-CODE.
 10759     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10760     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10761
 10762     IF DATE-CONVERSION-ERROR
 10763         MOVE ER-0475            TO EMI-ERROR
 10764         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10765
 10766     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10767
 10768     IF PI-COMPANY-ID = 'DMD'
 10769         IF PI-PMTTYPE NOT = '2'
 10770                 AND
 10771            WS-EXP-DT > WS-SV-EPYTHRU
 10772             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10773             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10774             MOVE '1'              TO DC-OPTION-CODE
 10775             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10776             IF DATE-CONVERSION-ERROR
 10777                 MOVE ER-0944      TO EMI-ERROR
 10778                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10779             ELSE
 10780                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10781                    DC-ELAPSED-DAYS   = 1
 10782                     MOVE ER-0945  TO EMI-ERROR
 10783                     MOVE -1       TO EPYTHRUL
 10784                     MOVE AL-UABON TO EPYTHRUA
 10785                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10786
 10787     IF PI-PMTTYPE = '4'
 10788         NEXT SENTENCE
 10789     ELSE
 10790         IF WS-SV-EPYTHRU = WS-EXP-DT
 10791             IF PI-PMTTYPE NOT = '2' AND '3'
 10792                 MOVE ER-3541    TO EMI-ERROR
 10793                 MOVE -1         TO PMTTYPEL
 10794                 MOVE AL-UABON   TO PMTTYPEA
 10795                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 205
* EL156.cbl
 10796
 10797     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10798         MOVE ER-0501            TO EMI-ERROR
 10799         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10800
 10801     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10802        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 10803*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10804*              MOVE ER-0540         TO EMI-ERROR
 10805*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10806*              MOVE -1              TO EPYTHRUL
 10807*              MOVE AL-UNBON        TO EPYTHRUA
 10808*          ELSE
 10809*          IF PI-COMPANY-ID = 'DMD'
 10810*              MOVE ER-7540         TO EMI-ERROR
 10811*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10812*              MOVE -1              TO EPYTHRUL
 10813*              MOVE AL-UNBON        TO EPYTHRUA
 10814*          ELSE
 10815               IF PI-PMTTYPE NOT = '2' AND '3'
 10816                  IF PI-COMPANY-ID = '???'
 10817                      MOVE ER-7540  TO EMI-ERROR
 10818                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10819                      MOVE -1       TO EPYTHRUL
 10820                      MOVE AL-UNBON TO EPYTHRUA
 10821                  ELSE
 10822                      MOVE ER-0540  TO EMI-ERROR
 10823                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10824                      MOVE -1       TO EPYTHRUL
 10825                      MOVE AL-UNBON TO EPYTHRUA.
 10826
 10827     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10828            OR
 10829        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10830         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10831            OR
 10832        (PI-CPYFROM NOT = LOW-VALUES AND
 10833         PI-CPYFROM < CL-PAID-THRU-DT)
 10834        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10835
 10836 1152-CHECK-TYPE.
 10837     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 10838        OR (PI-PMTTYPE = '5' OR '6')
 10839         GO TO 1160-EDIT-PAID-THRU-AH.
 10840
 10841 1155-EDIT-PAID-THRU-LIFE.
 10842     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10843     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10844     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10845     MOVE '4'                    TO CNTL-REC-TYPE.
 10846     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10847     MOVE 'BENE'                 TO FILE-SWITCH.
 10848
 10849     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10850
 10851     IF NO-BENEFIT-FOUND
 10852         GO TO 1950-NOT-FOUND.
 10853
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 206
* EL156.cbl
 10854     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10855
 10856     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10857
 10858     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10859        PI-LF-COVERAGE-TYPE = 'P'
 10860         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10861         GO TO 1200-EDIT-FIND-TOLERANCES.
 10862
 10863     IF PI-EPYTHRU = ZEROS
 10864        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10865
 10866     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10867         MOVE ER-0476            TO EMI-ERROR
 10868         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10869
 10870     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10871*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10872     move cl-critical-period    to dc-elapsed-months
 10873     MOVE +0                    TO DC-ELAPSED-DAYS.
 10874     MOVE '6'                   TO DC-OPTION-CODE.
 10875     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10876
 10877     IF (NO-CONVERSION-ERROR AND
 10878         WS-SPECIAL-CALC-CD = 'C')
 10879        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10880            MOVE ER-0657 TO EMI-ERROR
 10881            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10882
 10883     IF PI-COMPANY-ID = 'NCL'
 10884         IF WS-SPECIAL-CALC-CD = 'C' AND
 10885            cl-critical-period = zeros
 10886*           CM-LF-CRITICAL-PERIOD = +0
 10887             MOVE ER-0844       TO EMI-ERROR
 10888             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10889
 10890     GO TO 1200-EDIT-FIND-TOLERANCES.
 10891
 10892 1160-EDIT-PAID-THRU-AH.
 10893     IF PI-EPYTHRU = ZEROS
 10894        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10895                                    WS-SV-EPYTHRU
 10896     ELSE
 10897        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10898
 10899     IF WS-SV-EPYTHRU < PI-CPYFROM
 10900         MOVE ER-0508            TO EMI-ERROR
 10901         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10902
 10903     perform 7975-read-acct      thru 7975-exit
 10904     move zeros                  to pi-max-ext
 10905     if PI-DCC-PRODUCT-CODE NOT = SPACES
 10906        PERFORM 0900-GET-DDF-LIMITS
 10907                                 THRU 0900-EXIT
 10908        IF PDEF-FOUND
 10909           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10910              (P1 > +8)
 10911              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 207
* EL156.cbl
 10912           END-PERFORM
 10913           IF P1 < +9
 10914              MOVE PD-MAX-extension (P1)
 10915                                 TO pi-max-ext
 10916           else
 10917              move er-1674       to emi-error
 10918              PERFORM 9900-ERROR-FORMAT
 10919                                 THRU 9900-EXIT
 10920           END-IF
 10921        else
 10922           move er-1672          to emi-error
 10923           PERFORM 9900-ERROR-FORMAT
 10924                                 THRU 9900-EXIT
 10925        END-IF
 10926     end-if
 10927     move spaces                 to pi-max-ext-used
 10928     IF PI-PMTTYPE = '3'
 10929        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10930        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10931           MOVE ER-0477          TO EMI-ERROR
 10932           PERFORM 1165-PAID-THRU-ERROR
 10933                                 THRU 1165-EXIT
 10934        ELSE
 10935           continue
 10936        end-if
 10937     ELSE
 10938        IF WS-SV-EPYTHRU > WS-EXP-DT
 10939           move ws-exp-dt        to dc-bin-date-1
 10940           move ws-sv-epythru    to dc-bin-date-2
 10941           MOVE '1'              TO DC-OPTION-CODE
 10942           MOVE +0               TO DC-ELAPSED-DAYS
 10943                                    DC-ELAPSED-MONTHS
 10944           PERFORM 9700-LINK-DATE-CONVERT
 10945                                 THRU 9700-EXIT
 10946           if no-conversion-error
 10947              if dc-elapsed-days > zeros
 10948                 add +1 to dc-elapsed-months
 10949              end-if
 10950              if dc-elapsed-months > pi-max-ext
 10951                 MOVE ER-0557    TO EMI-ERROR
 10952                 PERFORM 1165-PAID-THRU-ERROR
 10953                                 THRU 1165-EXIT
 10954              else
 10955                 move 'Y'        to pi-max-ext-used
 10956                 move er-1670    to emi-error
 10957                 perform 9900-error-format
 10958                                 thru 9900-exit
 10959              end-if
 10960           end-if
 10961        end-if
 10962     end-if
 10963
 10964     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10965         PI-PMTTYPE NOT = '3'
 10966         MOVE ER-0541        TO EMI-ERROR
 10967         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10968
 10969     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 208
* EL156.cbl
 10970        (PI-PMTTYPE NOT = '3')
 10971         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10972             MOVE ER-0478        TO EMI-ERROR
 10973             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10974
 10975     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10976        (PI-PMTTYPE NOT = '4')
 10977         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10978             MOVE ER-0479        TO EMI-ERROR
 10979             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10980
 10981     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10982         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10983             MOVE ER-0545        TO EMI-ERROR
 10984             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10985
 10986     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10987         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10988             MOVE ER-0481        TO EMI-ERROR
 10989             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10990
 10991*    IF PI-COMPANY-ID = 'NCL'
 10992*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10993*           CM-AH-CRITICAL-PERIOD = +0
 10994*            MOVE ER-0844        TO  EMI-ERROR
 10995*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10996
 10997*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10998     if (cl-critical-period = zeros)
 10999        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11000          GO TO 1200-EDIT-FIND-TOLERANCES.
 11001
 11002     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11003     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 11004     MOVE '1'        TO DC-OPTION-CODE.
 11005     MOVE +0         TO DC-ELAPSED-DAYS
 11006                        DC-ELAPSED-MONTHS.
 11007     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11008
 11009*    IF NO-CONVERSION-ERROR
 11010*       COMPUTE ws-benefits-paid =
 11011*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11012*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11013*           MOVE ER-0657 TO EMI-ERROR
 11014*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11015
 11016     GO TO 1200-EDIT-FIND-TOLERANCES.
 11017
 11018 1165-PAID-THRU-ERROR.
 11019     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11020
 11021     IF EMI-MESSAGE-FORMATTED
 11022         MOVE -1                 TO EPYTHRUL
 11023         MOVE AL-UNBON           TO EPYTHRUA.
 11024
 11025 1165-EXIT.
 11026     EXIT.
 11027
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 209
* EL156.cbl
 11028 1166-CHECK-ALL-TRLRS.
 11029
 11030     IF PI-PMTTYPE = '4'
 11031        GO TO 1166-TRLR-EXIT.
 11032
 11033     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11034
 11035     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11036        WS-SV-EPYFROM = LOW-VALUES
 11037          GO TO 1166-END-CHECK.
 11038
 11039
 11040* EXEC CICS HANDLE CONDITION
 11041*        ENDFILE   (1166-END-CHECK)
 11042*        NOTFND    (1166-END-CHECK)
 11043*    END-EXEC.
 11044*    MOVE '"$''I                  ! ) #00010623' TO DFHEIV0
 11045     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11046     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11047     MOVE X'2920233030303130363233' TO DFHEIV0(25:11)
 11048     CALL 'kxdfhei1' USING DFHEIV0
 11049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11050
 11051
 11052     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11053     MOVE +100                   TO TRLR-SEQ-NO.
 11054
 11055
 11056* EXEC CICS STARTBR
 11057*         DATASET    ('ELTRLR')
 11058*         RIDFLD     (ELTRLR-KEY)
 11059*         GTEQ
 11060*    END-EXEC.
 11061     MOVE 'ELTRLR' TO DFHEIV1
 11062     MOVE 0
 11063       TO DFHEIV11
 11064*    MOVE '&,         G          &   #00010631' TO DFHEIV0
 11065     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11066     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11067     MOVE X'2020233030303130363331' TO DFHEIV0(25:11)
 11068     CALL 'kxdfhei1' USING DFHEIV0,
 11069           DFHEIV1,
 11070           ELTRLR-KEY,
 11071           DFHEIV99,
 11072           DFHEIV11,
 11073           DFHEIV99
 11074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11075
 11076
 11077     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11078
 11079 1166-READ-TRLR-NEXT.
 11080
 11081
 11082* EXEC CICS READNEXT
 11083*         DATASET    ('ELTRLR')
 11084*         RIDFLD     (ELTRLR-KEY)
 11085*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 210
* EL156.cbl
 11086*    END-EXEC.
 11087     MOVE 'ELTRLR' TO DFHEIV1
 11088     MOVE 0
 11089       TO DFHEIV11
 11090*    MOVE '&.S                   )   #00010641' TO DFHEIV0
 11091     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11092     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11093     MOVE X'2020233030303130363431' TO DFHEIV0(25:11)
 11094     CALL 'kxdfhei1' USING DFHEIV0,
 11095           DFHEIV1,
 11096           DFHEIV20,
 11097           DFHEIV99,
 11098           ELTRLR-KEY,
 11099           DFHEIV99,
 11100           DFHEIV11,
 11101           DFHEIV99,
 11102           DFHEIV99
 11103     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11104         DFHEIV20
 11105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11106
 11107
 11108     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11109        TRLR-CARRIER  = MSTR-CARRIER  AND
 11110        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11111        TRLR-CERT-NO  = MSTR-CERT-NO
 11112          NEXT SENTENCE
 11113      ELSE
 11114          GO TO 1166-END-CHECK.
 11115
 11116* **  BYPASS ALL NON-PAYMENT TRAILERS
 11117
 11118     IF AT-TRAILER-TYPE = '2'
 11119        NEXT SENTENCE
 11120     ELSE
 11121        GO TO 1166-READ-TRLR-NEXT.
 11122
 11123* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11124
 11125     IF AT-PAYMENT-TYPE = '1' OR '2'
 11126        NEXT SENTENCE
 11127     ELSE
 11128        GO TO 1166-READ-TRLR-NEXT.
 11129
 11130* **  BYPASS ALL VOID PAYMENTS
 11131
 11132     IF AT-VOID-DT NOT = LOW-VALUES
 11133        GO TO 1166-READ-TRLR-NEXT.
 11134
 11135     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11136        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11137          GO TO 1166-READ-TRLR-NEXT.
 11138
 11139     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11140         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11141            OR
 11142        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11143         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 211
* EL156.cbl
 11144        NEXT SENTENCE
 11145     ELSE
 11146         IF CL-TOTAL-PAID-AMT > ZEROS
 11147             MOVE ER-0502            TO EMI-ERROR
 11148             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11149             MOVE -1                 TO EPYTHRUL
 11150             MOVE AL-UNBON           TO EPYTHRUA.
 11151
 11152     GO TO 1166-READ-TRLR-NEXT.
 11153
 11154 1166-END-CHECK.
 11155
 11156     IF WS-BROWSE-TRLR-SW = 'Y'
 11157
 11158* EXEC CICS ENDBR
 11159*            DATASET   ('ELTRLR')
 11160*       END-EXEC.
 11161     MOVE 'ELTRLR' TO DFHEIV1
 11162     MOVE 0
 11163       TO DFHEIV11
 11164*    MOVE '&2                    $   #00010696' TO DFHEIV0
 11165     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11166     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11167     MOVE X'2020233030303130363936' TO DFHEIV0(25:11)
 11168     CALL 'kxdfhei1' USING DFHEIV0,
 11169           DFHEIV1,
 11170           DFHEIV11,
 11171           DFHEIV99
 11172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11173
 11174
 11175     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11176
 11177 1166-TRLR-EXIT.
 11178     EXIT.
 11179
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 212
* EL156.cbl
 11181 1170-PAID-THRU-FATAL-ERROR.
 11182     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11183
 11184     MOVE -1                     TO EPYTHRUL.
 11185     MOVE AL-UNBON               TO EPYTHRUA.
 11186
 11187 1200-EDIT-FIND-TOLERANCES.
 11188
 11189* EXEC CICS HANDLE CONDITION
 11190*        ENDFILE(1950-NOT-FOUND)
 11191*        NOTFND (1950-NOT-FOUND)
 11192*    END-EXEC.
 11193*    MOVE '"$''I                  ! * #00010713' TO DFHEIV0
 11194     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11195     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11196     MOVE X'2A20233030303130373133' TO DFHEIV0(25:11)
 11197     CALL 'kxdfhei1' USING DFHEIV0
 11198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11199
 11200
 11201     IF PI-PROCESSOR-ID = 'LGXX'
 11202        GO TO 1240-FIND-ACCT-TOLERANCES.
 11203
 11204     MOVE 'N'                    TO FOUND-TOL-SW.
 11205     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11206     MOVE '2'                    TO CNTL-REC-TYPE.
 11207     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11208     MOVE +0                     TO CNTL-SEQ-NO.
 11209     MOVE 'PROC'                 TO FILE-SWITCH.
 11210
 11211     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11212
 11213     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11214     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11215                                    PI-MAX-PMT-TOL.
 11216     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11217
 11218     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11219         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11220
 11221     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11222     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11223                                    PI-MAX-LF-PMT-TOL.
 11224
 11225     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11226         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11227
 11228     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11229                                    PI-MAX-EXP-PMT.
 11230
 11231 1240-FIND-ACCT-TOLERANCES.
 11232
 11233     IF WS-PMT-TOL NOT = +0
 11234         MOVE 'Y'                TO FOUND-TOL-SW.
 11235
 11236     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11237         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11238         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 213
* EL156.cbl
 11239         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11240         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11241         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11242         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11243     ELSE
 11244         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11245         MOVE PI-CARRIER             TO ACCT-CARRIER
 11246         MOVE PI-GROUPING            TO ACCT-GROUPING
 11247         MOVE PI-STATE               TO ACCT-STATE
 11248         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11249         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11250
 11251     MOVE 'ACCT'                 TO FILE-SWITCH.
 11252
 11253     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11254     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11255
 11256
 11257* EXEC CICS HANDLE CONDITION
 11258*         NOTFND   (1950-NOT-FOUND)
 11259*         ENDFILE  (1950-NOT-FOUND)
 11260*    END-EXEC.
 11261*    MOVE '"$I''                  ! + #00010773' TO DFHEIV0
 11262     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11263     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11264     MOVE X'2B20233030303130373733' TO DFHEIV0(25:11)
 11265     CALL 'kxdfhei1' USING DFHEIV0
 11266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11267
 11268
 11269
 11270* EXEC CICS STARTBR
 11271*        DATASET('ERACCT')
 11272*        RIDFLD (ERACCT-KEY)
 11273*        GTEQ
 11274*    END-EXEC.
 11275     MOVE 'ERACCT' TO DFHEIV1
 11276     MOVE 0
 11277       TO DFHEIV11
 11278*    MOVE '&,         G          &   #00010778' TO DFHEIV0
 11279     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11280     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11281     MOVE X'2020233030303130373738' TO DFHEIV0(25:11)
 11282     CALL 'kxdfhei1' USING DFHEIV0,
 11283           DFHEIV1,
 11284           ERACCT-KEY,
 11285           DFHEIV99,
 11286           DFHEIV11,
 11287           DFHEIV99
 11288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11289
 11290
 11291 1245-FIND-ACCT-TOLERANCES-LOOP.
 11292
 11293
 11294* EXEC CICS READNEXT
 11295*        DATASET('ERACCT')
 11296*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 214
* EL156.cbl
 11297*        RIDFLD (ERACCT-KEY)
 11298*    END-EXEC.
 11299     MOVE 'ERACCT' TO DFHEIV1
 11300     MOVE 0
 11301       TO DFHEIV11
 11302*    MOVE '&.S                   )   #00010786' TO DFHEIV0
 11303     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11304     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11305     MOVE X'2020233030303130373836' TO DFHEIV0(25:11)
 11306     CALL 'kxdfhei1' USING DFHEIV0,
 11307           DFHEIV1,
 11308           DFHEIV20,
 11309           DFHEIV99,
 11310           ERACCT-KEY,
 11311           DFHEIV99,
 11312           DFHEIV11,
 11313           DFHEIV99,
 11314           DFHEIV99
 11315     SET ADDRESS OF ACCOUNT-MASTER TO
 11316         DFHEIV20
 11317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11318
 11319
 11320     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11321        IF WS-ERACCT-HOLD-RECORD = SPACES
 11322           GO TO 1950-NOT-FOUND
 11323        ELSE
 11324           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11325           GO TO 1250-CONTINUE.
 11326
 11327     IF ACCT-EXP-DT = HIGH-VALUES
 11328        NEXT SENTENCE
 11329     ELSE
 11330        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11331        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11332
 11333 1250-CONTINUE.
 11334
 11335     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11336
 11337     IF FOUND-TOL-SW = 'N'
 11338         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11339
 11340********* 1260-FIND-STATE-TOLERANCES.
 11341
 11342     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11343     MOVE PI-STATE               TO WS-ST-ACCESS.
 11344     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11345     MOVE '3'                    TO CNTL-REC-TYPE.
 11346     MOVE +0                     TO CNTL-SEQ-NO.
 11347     MOVE 'STAT'                 TO FILE-SWITCH.
 11348
 11349     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11350
 11351     IF WS-PMT-TOL = +0
 11352         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11353
 11354     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 215
* EL156.cbl
 11355     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11356     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11357     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11358     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11359
 11360****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11361****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11362     IF PI-PAYEE-TYPE <> 'B'
 11363           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11364     END-IF.
 11365
 11366     IF PI-PMTTYPE      = '2'  AND
 11367        PI-SPLIT-PMT-SW = 'Y'  AND
 11368        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11369          MOVE ER-3530                TO EMI-ERROR
 11370          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11371
 11372********* 1280-FIND-BENEFIT-TOLERANCES.
 11373
 11374     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11375        OR (PI-PMTTYPE = '5' OR '6')
 11376         GO TO 1300-FIND-CARR-TOLERANCES.
 11377
 11378     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11379     MOVE '4'                    TO CNTL-REC-TYPE.
 11380     MOVE +0                     TO CNTL-SEQ-NO.
 11381     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11382     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11383     MOVE 'BENE'                 TO FILE-SWITCH.
 11384
 11385     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11386
 11387     IF NO-BENEFIT-FOUND
 11388         GO TO 1950-NOT-FOUND.
 11389
 11390     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11391     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11392     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11393
 11394
 11395* EXEC CICS HANDLE CONDITION
 11396*        NOTFND(1950-NOT-FOUND)
 11397*    END-EXEC.
 11398*    MOVE '"$I                   ! , #00010866' TO DFHEIV0
 11399     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11401     MOVE X'2C20233030303130383636' TO DFHEIV0(25:11)
 11402     CALL 'kxdfhei1' USING DFHEIV0
 11403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11404
 11405
 11406 1300-FIND-CARR-TOLERANCES.
 11407     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11408     MOVE '6'                    TO CNTL-REC-TYPE.
 11409
 11410     IF CONTROL-IS-ACTUAL-CARRIER
 11411         MOVE PI-CARRIER               TO WS-CARR
 11412     ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 216
* EL156.cbl
 11413         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11414
 11415     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11416     MOVE +0                     TO CNTL-SEQ-NO.
 11417     MOVE 'CARR'                 TO FILE-SWITCH.
 11418
 11419     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11420
 11421     IF WS-DAYS-TOL = +0
 11422         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11423
 11424     IF WS-PMT-TOL = +0
 11425         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11426
 11427     IF WS-MAX-DAYS-TOL = +0
 11428         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11429
 11430     IF WS-MAX-PMT-TOL = +0
 11431         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11432                                    PI-MAX-PMT-TOL.
 11433
 11434     IF WS-MAX-LF-PMT-TOL = +0
 11435        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11436                                    PI-MAX-LF-PMT-TOL.
 11437
 11438     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11439
 11440********* 1320-FIND-COMP-TOLERANCES.
 11441
 11442     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11443     MOVE '1'                    TO CNTL-REC-TYPE.
 11444     MOVE SPACES                 TO CNTL-ACCESS.
 11445     MOVE +0                     TO CNTL-SEQ-NO.
 11446     MOVE 'COMP'                 TO FILE-SWITCH.
 11447
 11448     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11449
 11450     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11451     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11452
 11453     IF WS-PMT-TOL NOT = +0
 11454        IF WS-TOL-SEVERITY NOT = ' '
 11455         GO TO 1360-EDIT-DAYS.
 11456
 11457     IF WS-PMT-TOL = +0
 11458         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11459
 11460     IF WS-TOL-SEVERITY = ' '
 11461         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11462
 11463 1360-EDIT-DAYS.
 11464     IF PI-PMTTYPE NOT = '4'
 11465        IF PI-EDAYS NEGATIVE OR
 11466           PI-EPYAMT NEGATIVE
 11467          MOVE ER-0513             TO EMI-ERROR
 11468          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11469          MOVE -1                  TO PMTTYPEL.
 11470
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 217
* EL156.cbl
 11471     IF PI-PMTTYPE = '5' OR '6'
 11472        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11473
 11474     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11475        IF PI-PMTTYPE = '4'
 11476          MOVE PI-EDAYS          TO PI-CDAYS.
 11477
 11478     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11479         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11480
 11481     IF PI-PMTTYPE = '4'
 11482        MOVE PI-EDAYS            TO PI-CDAYS
 11483        GO TO 1400-EDIT-PAYMENT.
 11484
 11485     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11486        GO TO 1500-EDIT-EXPENSES.
 11487
 11488*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11489*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11490*          CM-AH-BENEFIT-CD = '23'              AND
 11491*          CL-CERT-STATE    = '04'              AND
 11492*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11493*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11494*            GO TO 1362-CHECK-MAX-DAYS.
 11495
 11496     IF PI-EDAYS = ZEROS
 11497*        IF PI-COMPANY-ID = 'DMD'
 11498*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11499*            MOVE -1             TO DC-ELAPSED-DAYS
 11500*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11501*            MOVE '6'            TO DC-OPTION-CODE
 11502*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11503*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11504*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11505*            MOVE '1'            TO DC-OPTION-CODE
 11506*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11507*            IF NO-CONVERSION-ERROR
 11508*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11509*                                 + DC-ODD-DAYS-OVER
 11510*               MOVE 6           TO EDAYSL
 11511*               MOVE AL-UNNON    TO EDAYSA
 11512*            ELSE
 11513*                NEXT SENTENCE
 11514*       ELSE
 11515            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11516            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11517            MOVE '1'             TO DC-OPTION-CODE
 11518            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11519            IF NO-CONVERSION-ERROR
 11520                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11521                ADD 1                 TO PI-EDAYS
 11522                MOVE AL-UNNON         TO EDAYSA.
 11523
 11524*    IF PI-COMPANY-ID = 'DMD'
 11525*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11526*        MOVE -1                 TO DC-ELAPSED-DAYS
 11527*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11528*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 218
* EL156.cbl
 11529*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11530*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11531*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11532*        MOVE '1'                TO DC-OPTION-CODE
 11533*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11534*    ELSE
 11535         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11536         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11537         MOVE '1'                TO DC-OPTION-CODE.
 11538         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11539
 11540     IF NO-CONVERSION-ERROR
 11541        IF PI-COMPANY-ID = 'DMD'
 11542            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11543                             + DC-ODD-DAYS-OVER
 11544        ELSE
 11545            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11546            ADD 1                TO PI-CDAYS.
 11547
 11548     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11549        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11550        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11551
 11552     IF PI-EDAYS NOT NUMERIC
 11553         MOVE ER-0491            TO EMI-ERROR
 11554         GO TO 1370-DAYS-ERROR.
 11555
 11556     IF CL-NO-OF-PMTS-MADE = 0
 11557        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11558        AND CL-CERT-STATE = 'MI'
 11559        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11560            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11561     END-IF.
 11562
 11563 1362-CHECK-MAX-DAYS.
 11564
 11565     IF WS-MAX-DAYS-TOL = +999
 11566         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11567
 11568     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11569         IF PI-EDAYS = ZEROS
 11570             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11571         ELSE
 11572             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11573
 11574     IF WS-MAX-DAYS-TOL NOT = ZERO
 11575        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11576           PI-CDAYS > WS-MAX-DAYS-TOL
 11577             MOVE ER-0492          TO EMI-ERROR
 11578             GO TO 1370-DAYS-ERROR.
 11579
 11580 1365-SKIP-MAX-DAYS-EDIT.
 11581     IF PI-EDAYS = ZEROS
 11582        GO TO 1400-EDIT-PAYMENT.
 11583
 11584     IF WS-DAYS-TOL NOT = ZERO
 11585        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11586           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 219
* EL156.cbl
 11587                MOVE ER-0493     TO EMI-ERROR
 11588                GO TO 1370-DAYS-ERROR.
 11589
 11590     GO TO 1400-EDIT-PAYMENT.
 11591
 11592 1370-DAYS-ERROR.
 11593     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11594
 11595     IF EMI-MESSAGE-FORMATTED
 11596         MOVE -1                 TO EDAYSL
 11597         MOVE AL-UABON           TO EDAYSA.
 11598
 11599     GO TO 1400-EDIT-PAYMENT.
 11600
 11601 1380-EDIT-EXPENSE-PMT-AMT.
 11602     IF PI-PMTTYPE = '5' OR '6'
 11603         NEXT SENTENCE
 11604     ELSE
 11605         GO TO 1400-EDIT-PAYMENT.
 11606
 11607     IF WS-MAX-EXP-PMT NOT = ZEROS
 11608        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11609            MOVE ER-3529            TO EMI-ERROR
 11610            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11611
 11612     GO TO 1500-EDIT-EXPENSES.
 11613
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 220
* EL156.cbl
 11615
 11616 1390-CHECK-PAYMENT-DAYS.
 11617
 11618     IF PI-EDAYS = 0
 11619         MOVE PI-CDAYS TO WS-PD-DAYS
 11620     ELSE
 11621         MOVE PI-EDAYS TO WS-PD-DAYS
 11622     END-IF.
 11623
 11624     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11625         IF WS-PD-DAYS = 14
 11626            GO TO 1390-EXIT
 11627         END-IF
 11628     END-IF.
 11629
 11630     IF PI-COMPANY-ID = 'AHL'  AND
 11631        CM-AH-BENEFIT-CD = '1K'
 11632         IF WS-PD-DAYS = 14
 11633            GO TO 1390-EXIT
 11634         END-IF
 11635     END-IF.
 11636
 11637     IF WS-PD-DAYS < 30
 11638         MOVE ER-3549              TO EMI-ERROR
 11639         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11640     END-IF.
 11641
 11642 1390-EXIT.
 11643      EXIT.
 11644
 11645 1400-EDIT-PAYMENT.
 11646*    IF PI-COMPANY-ID = 'DMD'
 11647*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11648*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11649
 11650     IF PI-COMPANY-ID = 'DCC'
 11651        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11652        MOVE PI-CARRIER          TO ACCT-CARRIER
 11653        MOVE PI-GROUPING         TO ACCT-GROUPING
 11654        MOVE PI-STATE            TO ACCT-STATE
 11655        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11656        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11657        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11658        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11659
 11660
 11661* EXEC CICS READ
 11662*          DATASET ('ERACCT')
 11663*          RIDFLD  (ERACCT-KEY)
 11664*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11665*          GTEQ
 11666*          resp    (WS-RESPONSE)
 11667*       END-EXEC
 11668     MOVE 'ERACCT' TO DFHEIV1
 11669*    MOVE '&"S        G          (  N#00011124' TO DFHEIV0
 11670     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11671     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11672     MOVE X'204E233030303131313234' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 221
* EL156.cbl
 11673     CALL 'kxdfhei1' USING DFHEIV0,
 11674           DFHEIV1,
 11675           DFHEIV20,
 11676           DFHEIV99,
 11677           ERACCT-KEY,
 11678           DFHEIV99,
 11679           DFHEIV99,
 11680           DFHEIV99
 11681     SET ADDRESS OF ACCOUNT-MASTER TO
 11682         DFHEIV20
 11683     MOVE EIBRESP  TO WS-RESPONSE
 11684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11685        IF WS-RESP-NORMAL
 11686           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11687           and pi-cert-eff-dt < am-expiration-dt
 11688           and pi-cert-eff-dt >= am-effective-dt
 11689           move am-dcc-product-code to pi-dcc-product-code
 11690        else
 11691           move spaces           to pi-dcc-product-code
 11692        end-if
 11693        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11694           PERFORM 0900-GET-DDF-LIMITS
 11695                                 THRU 0900-EXIT
 11696           IF PDEF-FOUND
 11697              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11698                 (P1 > +8)
 11699                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11700              END-PERFORM
 11701              IF P1 < +9
 11702                 if pd-ben-pct (p1) not numeric
 11703                    move zeros   to pd-ben-pct (p1)
 11704                 end-if
 11705                 if pd-ben-pct (p1) = zeros
 11706                    move +1      to ws-work-ben-pct
 11707                 else
 11708                    move pd-ben-pct (p1)
 11709                                 to ws-work-ben-pct
 11710                 end-if
 11711                 compute cm-ah-benefit-amt =
 11712                    cm-ah-benefit-amt * ws-work-ben-pct
 11713                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11714                    move pd-max-amt (p1) to cm-ah-benefit-amt
 11715                 end-if
 11716              else
 11717                 move er-1674    to emi-error
 11718                 PERFORM 9900-ERROR-FORMAT
 11719                                 THRU 9900-EXIT
 11720              END-IF
 11721           else
 11722              move er-1672       to emi-error
 11723              PERFORM 9900-ERROR-FORMAT
 11724                                 THRU 9900-EXIT
 11725           END-IF
 11726        end-if
 11727     END-IF
 11728     IF PI-PMTTYPE NOT = '4'
 11729        GO TO 1405-CALC-PAYMENT.
 11730
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 222
* EL156.cbl
 11731     IF PI-EDAYS NOT NUMERIC
 11732         MOVE PI-EPYAMT           TO PI-CPYAMT
 11733         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11734         GO TO 1430-CHECK-AH-TOLERANCE.
 11735
 11736*    IF PI-COMPANY-ID = 'FIA'
 11737*       IF CERT-ACCOUNT = '0000011043'
 11738*        COMPUTE PI-DAILY-RATE ROUNDED =
 11739*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11740*        COMPUTE PI-CPYAMT ROUNDED =
 11741*                          PI-DAILY-RATE * PI-EDAYS
 11742*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11743*        GO TO 1430-CHECK-AH-TOLERANCE.
 11744
 11745     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11746         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11747         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11748         GO TO 1420-CHECK-AIG-BENEFIT.
 11749
 11750     IF WS-CALC-METHOD = '2' OR  '5'
 11751         COMPUTE PI-DAILY-RATE ROUNDED =
 11752                        (CM-AH-BENEFIT-AMT * 12) / 365
 11753         COMPUTE PI-CPYAMT ROUNDED =
 11754                           PI-DAILY-RATE * PI-EDAYS
 11755        GO TO 1420-CHECK-AIG-BENEFIT.
 11756
 11757     IF WS-CALC-METHOD = '3'
 11758         COMPUTE PI-DAILY-RATE =
 11759                         (CM-AH-BENEFIT-AMT * 12) / 365
 11760         COMPUTE PI-CPYAMT ROUNDED =
 11761                           PI-DAILY-RATE * PI-EDAYS
 11762        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 223
* EL156.cbl
 11764*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11765
 11766****************************************************************
 11767****************************************************************
 11768*                  CALCULATED FROM      PAYMENT      PAYMENT
 11769*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11770* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11771*1-01-83  1-15-83    0    15     15        15           15
 11772*1-01-83  1-30-83    0    30     30        30           30
 11773*1-01-83  1-31-83    1     0     31        30           30
 11774*1-01-83  2-01-83    1     1     32        31           31
 11775*1-01-83  2-15-83    1    15     46        45           45
 11776*1-01-83  2-28-83    2     0     59        60           60
 11777*1-01-83  3-01-83    2     1     60        61           61
 11778*1-01-83  3-31-83    3     0     90        90           90
 11779*1-15-83  1-31-83    0    17     17        17           16
 11780*1-15-83  2-01-83    0    18     18        18           17
 11781*1-15-83  2-28-83    1    14     45        44           46
 11782*1-21-83  3-09-83    1    20     48        50           49
 11783*2-05-83  3-06-83    1     2     30        32           32
 11784*2-05-83  3-23-83    1    19     47        49           49
 11785*2-15-83  2-28-83    0    14     14        14           16
 11786*2-15-83  3-01-83    0    15     15        15           17
 11787*2-21-83  3-19-83    0    27     27        27           29
 11788*2-21-83  3-20-83    1     0     28        30           30
 11789*2-21-83  4-10-83    1    18     49        30           50
 11790*2-21-83  5-19-83    2    27     88        87           89
 11791*2-21-83  5-22-83    3     2     91        92           92
 11792*3-21-83  5-19-83    1    30     60        60           59
 11793****************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 224
* EL156.cbl
 11795 1405-CALC-PAYMENT.
 11796     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11797     MOVE ' '                    TO DC-OPTION-CODE.
 11798     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11799     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11800     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11801
 11802     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11803     MOVE ' '                    TO DC-OPTION-CODE.
 11804     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11805     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11806     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11807
 11808     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11809     MOVE -1                     TO DC-ELAPSED-DAYS.
 11810     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11811     MOVE '6'                    TO DC-OPTION-CODE.
 11812     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11813     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11814
 11815     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11816     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11817     MOVE '1'                    TO DC-OPTION-CODE.
 11818     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11819
 11820     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11821     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11822     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11823
 11824******************************************************************
 11825*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11826*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11827*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11828******************************************************************
 11829
 11830     IF WS-CALC-METHOD = '1'           AND
 11831        DC-ELAPSED-MONTHS > ZERO AND
 11832        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11833        WDF-DAY > WDT-DAY
 11834          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11835          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11836          MOVE -1                  TO DC-ELAPSED-MONTHS
 11837          MOVE '6'                 TO DC-OPTION-CODE
 11838          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11839          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11840          COMPUTE WS-SAVE-ODD-DAYS =
 11841          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11842          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11843
 11844     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11845     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11846     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11847
 11848     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11849     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11850
 11851*    IF PI-COMPANY-ID = 'FIA'
 11852*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 225
* EL156.cbl
 11853*        COMPUTE PI-DAILY-RATE ROUNDED =
 11854*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11855*        COMPUTE PI-CPYAMT ROUNDED =
 11856*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11857*        GO TO 1420-CHECK-AIG-BENEFIT.
 11858
 11859*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11860*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11861*          CM-AH-BENEFIT-CD = '23'               AND
 11862*          CL-CERT-STATE    = '04'               AND
 11863*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11864*            COMPUTE WS-DAILY-RATE ROUNDED =
 11865*                               CM-AH-BENEFIT-AMT / 30
 11866*            COMPUTE PI-CPYAMT ROUNDED =
 11867*                               (WS-DAILY-RATE * PI-CDAYS)
 11868*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11869*            GO TO 1420-CHECK-AIG-BENEFIT.
 11870
 11871     IF WS-CALC-METHOD = '1'
 11872         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11873         COMPUTE PI-CPYAMT ROUNDED =
 11874             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11875             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11876         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11877         GO TO 1420-CHECK-AIG-BENEFIT.
 11878
 11879     IF WS-CALC-METHOD = '2'
 11880         COMPUTE PI-DAILY-RATE ROUNDED =
 11881                          (CM-AH-BENEFIT-AMT * 12) / 365
 11882         COMPUTE PI-CPYAMT ROUNDED =
 11883             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11884             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11885         GO TO 1420-CHECK-AIG-BENEFIT.
 11886
 11887     IF WS-CALC-METHOD = '4'
 11888         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11889         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11890         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11891         COMPUTE PI-CPYAMT ROUNDED =
 11892                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11893         GO TO 1420-CHECK-AIG-BENEFIT.
 11894
 11895     IF WS-CALC-METHOD = '5'
 11896         COMPUTE PI-DAILY-RATE ROUNDED =
 11897                            (CM-AH-BENEFIT-AMT * 12) / 365
 11898         COMPUTE PI-CPYAMT ROUNDED =
 11899                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11900         GO TO 1420-CHECK-AIG-BENEFIT.
 11901
 11902     IF WS-CALC-METHOD NOT = '3'
 11903        GO TO 1410-CHECK-PAYMENT.
 11904
 11905******   CALCULATION METHOD  3  ROUTINE
 11906     COMPUTE PI-DAILY-RATE =
 11907                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11908
 11909******CHECK TO SEE IF WITHIN SAME MONTH
 11910     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 226
* EL156.cbl
 11911        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11912                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11913         GO TO 1420-CHECK-AIG-BENEFIT.
 11914
 11915******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11916     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11917             SAVE-ODD-DAYS-OVER = ZEROS
 11918      COMPUTE PI-CPYAMT  ROUNDED =
 11919                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11920      GO TO 1420-CHECK-AIG-BENEFIT.
 11921
 11922******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11923******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11924     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11925        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11926        IF WDF-MONTH > 12
 11927           ADD 1                 TO WDF-YEAR
 11928           SUBTRACT 12         FROM WDF-MONTH.
 11929
 11930******CONVERT THE NEW FROM MONTH TO BINARY
 11931     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11932        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11933        MOVE '4'              TO DC-OPTION-CODE
 11934        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11935        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11936
 11937     IF WDF-MONTH = WDT-MONTH AND
 11938        WDF-YEAR  = WDT-YEAR
 11939          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11940                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11941                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11942        ELSE
 11943          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11944          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11945          COMPUTE PI-CPYAMT ROUNDED =
 11946       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11947       +
 11948       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11949       +
 11950       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11951
 11952     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 227
* EL156.cbl
 11954 1410-CHECK-PAYMENT.
 11955******PAYMENT OPTION 6
 11956******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11957     IF SAVE-ELAPSED-MONTHS > ZERO
 11958        IF SAVE-ODD-DAYS-OVER = ZEROS
 11959           GO TO 1412-CHECK-TO-DAY
 11960        ELSE
 11961           IF WDF-DAY > WDT-DAY
 11962              IF WDF-MONTH = 02
 11963                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11964                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11965                  GO TO 1412-CHECK-TO-DAY
 11966              ELSE
 11967                  IF FROM-DAYS-IN-MONTH = 31
 11968                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11969                     GO TO 1412-CHECK-TO-DAY
 11970                  ELSE
 11971                     GO TO 1412-CHECK-TO-DAY
 11972           ELSE
 11973               GO TO 1412-CHECK-TO-DAY.
 11974
 11975     IF WDF-MONTH NOT = WDT-MONTH
 11976        IF WDF-MONTH = 02
 11977           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11978           IF WDF-DAY = 29
 11979              ADD 1              TO SAVE-ODD-DAYS-OVER
 11980           ELSE
 11981              ADD 2              TO SAVE-ODD-DAYS-OVER
 11982        ELSE
 11983           IF FROM-DAYS-IN-MONTH = 31
 11984              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11985
 11986 1412-CHECK-TO-DAY.
 11987        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11988           IF WDT-DAY = 28
 11989              ADD 2              TO SAVE-ODD-DAYS-OVER
 11990           ELSE
 11991              IF WDT-DAY = 29
 11992                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11993              ELSE
 11994                 NEXT SENTENCE
 11995        ELSE
 11996           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11997              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11998
 11999     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12000     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12001     COMPUTE PI-CPYAMT ROUNDED =
 12002         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12003         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12004
 12005     GO TO 1420-CHECK-AIG-BENEFIT.
 12006
 12007 1415-CHECK-LEAP-YEAR.
 12008     IF FROM-DAYS-IN-MONTH = 29
 12009        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12010
 12011 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 228
* EL156.cbl
 12012     EXIT.
 12013
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 229
* EL156.cbl
 12015 1420-CHECK-AIG-BENEFIT.
 12016
 12017     IF WS-SPECIAL-CALC-CD = 'Q'
 12018         GO TO 1425-CHECK-WHOLE-MONTH.
 12019
 12020*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12021*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12022*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12023*       (PI-PMTTYPE = '1' OR '2')
 12024*        NEXT SENTENCE
 12025*    ELSE
 12026         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12027         GO TO 1430-CHECK-AH-TOLERANCE.
 12028
 12029******************AIG LOGIC STARTS**********************
 12030*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12031*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12032*    MOVE ER-3533      TO EMI-ERROR.
 12033*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12034*    GO TO 1430-CHECK-AH-TOLERANCE.
 12035******************AIG LOGIC ENDS************************
 12036
 12037 1425-CHECK-WHOLE-MONTH.
 12038******************************************************************
 12039****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12040****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12041****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12042****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12043****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12044****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12045****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12046****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12047****          PAID * MONTHLY BENEFIT.                         ****
 12048******************************************************************
 12049
 12050     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12051
 12052     IF CL-NO-OF-PMTS-MADE > +0
 12053         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12054
 12055     IF PI-CDAYS < WS-BEN-DAYS
 12056         GO TO 1430-CHECK-AH-TOLERANCE.
 12057
 12058     IF PI-CDAYS = WS-BEN-DAYS
 12059         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12060         GO TO 1430-CHECK-AH-TOLERANCE.
 12061
 12062*    IF PI-COMPANY-ID = 'ACM'
 12063*       NEXT SENTENCE
 12064*    ELSE
 12065        GO TO 1425-NOT-ACM-W15C.
 12066
 12067*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12068*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12069*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12070*    MOVE '6'                    TO  DC-OPTION-CODE.
 12071*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12072*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 230
* EL156.cbl
 12073*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12074*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12075*       MOVE '1'                 TO  DC-OPTION-CODE
 12076*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12077*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12078*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12079*       IF NO-CONVERSION-ERROR
 12080*          IF (DC-ELAPSED-MONTHS > +0) OR
 12081*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12082*             NEXT SENTENCE
 12083*          ELSE
 12084*             MOVE +0            TO  PI-CPYAMT
 12085*             MOVE ER-0846       TO  EMI-ERROR
 12086*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12087*             GO TO 1430-CHECK-AH-TOLERANCE
 12088*       ELSE
 12089*           MOVE ER-0846         TO  EMI-ERROR
 12090*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12091*           GO TO 1430-CHECK-AH-TOLERANCE.
 12092*
 12093*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12094*       ADD +1 TO DC-ELAPSED-MONTHS.
 12095*
 12096*    COMPUTE PI-CPYAMT ROUNDED =
 12097*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12098*
 12099*    GO TO 1430-CHECK-AH-TOLERANCE.
 12100
 12101 1425-NOT-ACM-W15C.
 12102
 12103     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12104     MOVE '6'                        TO  DC-OPTION-CODE.
 12105     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12106     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12107
 12108     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12109     IF NO-CONVERSION-ERROR
 12110         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12111     ELSE
 12112         MOVE ER-0846                TO  EMI-ERROR
 12113         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12114         GO TO 1430-CHECK-AH-TOLERANCE.
 12115
 12116     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12117     MOVE '1'                        TO  DC-OPTION-CODE.
 12118     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12119     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12120     IF NO-CONVERSION-ERROR
 12121         IF DC-ODD-DAYS-OVER = +0
 12122             NEXT SENTENCE
 12123         ELSE
 12124             MOVE ER-0846            TO  EMI-ERROR
 12125             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12126             GO TO 1430-CHECK-AH-TOLERANCE
 12127     ELSE
 12128         MOVE ER-0846                TO  EMI-ERROR
 12129         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12130         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 231
* EL156.cbl
 12131
 12132     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12133         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12134
 12135     GO TO 1430-CHECK-AH-TOLERANCE.
 12136
 12137 1425-CONT-WHOLE-MONTH-PMTS.
 12138******************************************************************
 12139****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12140****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12141****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12142******************************************************************
 12143
 12144     IF PI-COMPANY-ID = 'ACM'
 12145        NEXT SENTENCE
 12146     ELSE
 12147        IF DC-ODD-DAYS-OVER = +0
 12148            NEXT SENTENCE
 12149        ELSE
 12150            MOVE ER-0845            TO  EMI-ERROR
 12151            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12152            GO TO 1430-CHECK-AH-TOLERANCE.
 12153
 12154     COMPUTE PI-CPYAMT ROUNDED =
 12155                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12156
 12157 1430-CHECK-AH-TOLERANCE.
 12158     IF PI-PMT-APPR-SW = 'G'
 12159         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12160
 12161*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12162*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12163*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12164*
 12165*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12166*      IF WDF-MONTH = 02
 12167*        IF SAVE-ELAPSED-MONTHS = 0
 12168*          NEXT SENTENCE
 12169*        ELSE
 12170*          IF SAVE-ODD-DAYS-OVER > 0
 12171*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12172*            COMPUTE WS-PMT-MOS ROUNDED =
 12173*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12174*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12175*                                     WS-PMT-MOS
 12176*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12177*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12178*          ELSE
 12179*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12180*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12181*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12182*                                     WS-PMT-MOS.
 12183
 12184     IF WS-MAX-PMT-TOL NOT = ZERO
 12185        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12186           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12187            MOVE ER-0494         TO  EMI-ERROR
 12188            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 232
* EL156.cbl
 12189            GO TO 1500-EDIT-EXPENSES.
 12190
 12191 1430-CONT-CHECK-AH-TOLERANCE.
 12192
 12193     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12194        GO TO 1500-EDIT-EXPENSES.
 12195
 12196     IF CM-O-B-COVERAGE
 12197        GO TO 1500-EDIT-EXPENSES.
 12198
 12199     IF PI-COMPANY-ID = 'NCL'
 12200       IF FOUND-TOL-SW = 'Y'
 12201         IF WS-PMT-TOL NOT = ZERO
 12202           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12203              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12204                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12205                  IF WS-NCL-PMT-OPTION = SPACES
 12206                      MOVE ER-0699 TO EMI-ERROR
 12207                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12208                  ELSE
 12209                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12210                      NEXT SENTENCE
 12211                  ELSE
 12212                  IF NOT WS-VALID-NCL-OPTION
 12213                      MOVE ER-0699 TO EMI-ERROR
 12214                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12215
 12216     IF WS-PMT-TOL NOT = ZERO
 12217        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12218           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12219           MOVE ER-0495          TO EMI-ERROR
 12220           PERFORM 1490-PAYMENT-ERROR
 12221                                 THRU 1490-EXIT
 12222        end-if
 12223     end-if
 12224
 12225     GO TO 1500-EDIT-EXPENSES.
 12226
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 233
* EL156.cbl
 12228 1440-COMPUTE-LIFE-REMAINING.
 12229
 12230     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12231        IF PI-PMTTYPE = '4'
 12232          MOVE PI-EPYAMT TO PI-CPYAMT
 12233          GO TO 1460-TEST-TYPE.
 12234
 12235     IF WS-LF-COVERAGE-TYPE = 'L'
 12236        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12237                          - CL-TOTAL-PAID-AMT
 12238        GO TO 1450-CHECK-MAX.
 12239
 12240     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12241        PI-LF-COVERAGE-TYPE = 'P'
 12242          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12243                              CM-LF-ITD-DEATH-AMT
 12244          GO TO 1450-CHECK-MAX.
 12245
 12246     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12247     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12248     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12249     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12250     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12251     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12252     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12253     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12254     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12255
 12256     PERFORM 9800-LINK-REM-TERM.
 12257
 12258     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12259     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12260     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12261     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12262     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12263     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12264     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12265     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12266     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12267     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12268     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12269     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12270     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12271     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12272     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12273     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12274     IF PI-COMPANY-ID = 'DCC'
 12275        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12276        MOVE PI-CARRIER          TO ACCT-CARRIER
 12277        MOVE PI-GROUPING         TO ACCT-GROUPING
 12278        MOVE PI-STATE            TO ACCT-STATE
 12279        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12280        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12281        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12282        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12283
 12284
 12285* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 234
* EL156.cbl
 12286*          DATASET ('ERACCT')
 12287*          RIDFLD  (ERACCT-KEY)
 12288*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12289*          GTEQ
 12290*          resp    (WS-RESPONSE)
 12291*       END-EXEC
 12292     MOVE 'ERACCT' TO DFHEIV1
 12293*    MOVE '&"S        G          (  N#00011730' TO DFHEIV0
 12294     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12295     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12296     MOVE X'204E233030303131373330' TO DFHEIV0(25:11)
 12297     CALL 'kxdfhei1' USING DFHEIV0,
 12298           DFHEIV1,
 12299           DFHEIV20,
 12300           DFHEIV99,
 12301           ERACCT-KEY,
 12302           DFHEIV99,
 12303           DFHEIV99,
 12304           DFHEIV99
 12305     SET ADDRESS OF ACCOUNT-MASTER TO
 12306         DFHEIV20
 12307     MOVE EIBRESP  TO WS-RESPONSE
 12308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12309        IF WS-RESP-NORMAL
 12310           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12311           and (pi-cert-eff-dt < am-expiration-dt)
 12312           and (pi-cert-eff-dt >= am-effective-dt)
 12313           move am-dcc-product-code to pi-dcc-product-code
 12314        else
 12315           move spaces           to pi-dcc-product-code
 12316        end-if
 12317        if pi-dcc-product-code not = spaces
 12318           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12319           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12320           PERFORM 0900-GET-DDF-limits
 12321                                 THRU 0900-EXIT
 12322           IF PDEF-FOUND
 12323              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12324                 (P1 > +8)
 12325                 OR (PD-PROD-CODE (P1) = 'L')
 12326              END-PERFORM
 12327              IF P1 < +9
 12328                 MOVE PD-MAX-AMT (P1)
 12329                                 TO CP-R-MAX-TOT-BEN
 12330              else
 12331                 move er-1674    to emi-error
 12332                 PERFORM 9900-ERROR-FORMAT
 12333                                 THRU 9900-EXIT
 12334              END-IF
 12335           else
 12336              move er-1672       to emi-error
 12337              PERFORM 9900-ERROR-FORMAT
 12338                                 THRU 9900-EXIT
 12339           END-IF
 12340        end-if
 12341     END-IF
 12342
 12343* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 235
* EL156.cbl
 12344*       PROGRAM  (LINK-REMAMT)
 12345*       COMMAREA (CALCULATION-PASS-AREA)
 12346*       LENGTH   (CP-COMM-LENGTH)
 12347*    END-EXEC.
 12348*    MOVE '."C                   (   #00011770' TO DFHEIV0
 12349     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12350     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12351     MOVE X'2020233030303131373730' TO DFHEIV0(25:11)
 12352     CALL 'kxdfhei1' USING DFHEIV0,
 12353           LINK-REMAMT,
 12354           CALCULATION-PASS-AREA,
 12355           CP-COMM-LENGTH,
 12356           DFHEIV99,
 12357           DFHEIV99,
 12358           DFHEIV99,
 12359           DFHEIV99
 12360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12361
 12362
 12363     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12364
 12365     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12366     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12367
 12368     IF PI-COMPANY-ID = 'BOA' AND
 12369        PI-PMTTYPE    = '2'   AND
 12370        PI-OFFLINE    = 'N'
 12371           GO TO 1441-COMPUTE-BOA-INTEREST.
 12372
 12373     IF PI-COMPANY-ID = 'NCL' AND
 12374        PI-PMTTYPE    = '2'   AND
 12375        PI-OFFLINE    = 'N'
 12376          GO TO 1442-COMPUTE-NCL-INTEREST
 12377       ELSE
 12378          GO TO 1445-CONTINUE.
 12379
 12380 1441-COMPUTE-BOA-INTEREST.
 12381     MOVE +0             TO WS-CALC-INT.
 12382
 12383     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12384     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12385     MOVE +0             TO DC-ELAPSED-MONTHS
 12386                            DC-ELAPSED-DAYS.
 12387     MOVE '1'            TO DC-OPTION-CODE.
 12388     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12389     IF NO-CONVERSION-ERROR
 12390         NEXT SENTENCE
 12391     ELSE
 12392         GO TO 1445-CONTINUE.
 12393
 12394     IF (PI-INT-RATE NOT > ZEROS)  AND
 12395        (DC-ELAPSED-DAYS > +30)
 12396         MOVE ER-3531            TO EMI-ERROR
 12397         MOVE -1                 TO PINTL
 12398         MOVE AL-UNBON           TO PINTA
 12399         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12400
 12401     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 236
* EL156.cbl
 12402         GO TO 1445-CONTINUE.
 12403
 12404     IF (PI-INT-RATE NOT > ZEROS)  OR
 12405        (DC-ELAPSED-DAYS NOT > +30)
 12406         MOVE PI-EPYAMT TO PI-CPYAMT
 12407         GO TO 1441-FORMAT-NOTE.
 12408
 12409     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12410                                 *  PI-INT-RATE
 12411                                 *  DC-ELAPSED-DAYS
 12412                                 /  365
 12413                                 /  100.
 12414
 12415     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12416
 12417 1441-FORMAT-NOTE.
 12418
 12419     MOVE SPACES        TO WS-BOANOTE1.
 12420     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12421     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12422     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12423     MOVE AL-UANON      TO NOTE1A.
 12424
 12425     IF WS-CALC-INT > ZEROS
 12426         MOVE SPACES        TO WS-BOANOTE2
 12427         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12428         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12429         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12430         MOVE AL-UANON      TO NOTE2A.
 12431
 12432     GO TO 1445-CONTINUE.
 12433
 12434 1442-COMPUTE-NCL-INTEREST.
 12435     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12436     MOVE PI-STATE               TO WS-ST-ACCESS.
 12437     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12438     MOVE '3'                    TO CNTL-REC-TYPE.
 12439     MOVE +0                     TO CNTL-SEQ-NO.
 12440     MOVE 'STAT'                 TO FILE-SWITCH.
 12441
 12442     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12443
 12444     MOVE +0                 TO WS-CALC-INT.
 12445
 12446     IF ST-STAT-FROM-INCURRED
 12447         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12448       ELSE
 12449     IF ST-STAT-FROM-REPORTED
 12450         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12451       ELSE
 12452         GO TO 1445-CONTINUE.
 12453
 12454     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12455     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12456     MOVE +0                 TO DC-ELAPSED-MONTHS
 12457                                DC-ELAPSED-DAYS.
 12458     MOVE '1'                TO DC-OPTION-CODE.
 12459     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 237
* EL156.cbl
 12460     IF NO-CONVERSION-ERROR
 12461         NEXT SENTENCE
 12462     ELSE
 12463         GO TO 1445-CONTINUE.
 12464
 12465     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12466        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12467         GO TO 1445-CONTINUE.
 12468
 12469     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12470                                 *  CF-ST-STAT-INTEREST.
 12471
 12472     MOVE SPACES              TO WS-NCLNOTE1.
 12473     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12474     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12475     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12476                                 PI-PMTNOTE1
 12477                                 NOTE1I.
 12478     MOVE AL-UANON            TO NOTE1A.
 12479
 12480     IF WS-CALC-INT > ZEROS
 12481         MOVE SPACES          TO WS-NCLNOTE2
 12482         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12483         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12484         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12485                                 PI-PMTNOTE2
 12486                                 NOTE2I
 12487         MOVE AL-UANON        TO NOTE2A.
 12488
 12489     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12490
 12491 1445-CONTINUE.
 12492
 12493     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12494        GO TO 1460-TEST-TYPE.
 12495
 12496     IF CM-O-B-COVERAGE
 12497        GO TO 1460-TEST-TYPE.
 12498
 12499     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12500         GO TO 1450-CHECK-MAX.
 12501
 12502     if (pi-company-id = 'DCC')
 12503        and (pdef-found)
 12504        if pi-epyamt > pd-max-amt (p1)
 12505           move er-1657          to emi-error
 12506           perform 1490-payment-error
 12507                                 thru 1490-exit
 12508           go to 1460-test-type
 12509        end-if
 12510     else
 12511        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12512           > PI-EPYAMT)
 12513                         OR
 12514           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12515           < PI-EPYAMT)
 12516           MOVE ER-0594          TO EMI-ERROR
 12517           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 238
* EL156.cbl
 12518                                 THRU 1490-EXIT
 12519           GO TO 1460-TEST-TYPE
 12520        end-if
 12521     end-if
 12522     .
 12523 1450-CHECK-MAX.
 12524
 12525     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12526        PI-LF-COVERAGE-TYPE = 'P'
 12527         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12528                                   CM-LF-ITD-DEATH-AMT
 12529     ELSE
 12530         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12531                                   CL-TOTAL-PAID-AMT.
 12532
 12533     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12534          MOVE ER-0543           TO EMI-ERROR
 12535          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12536
 12537 1460-TEST-TYPE.
 12538
 12539     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12540        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12541           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12542                                   CM-LF-ALT-BENEFIT-AMT -
 12543                                   CL-TOTAL-PAID-AMT
 12544           IF PI-EPYAMT > WS-LF-BEN-AMT
 12545               MOVE ER-0543      TO EMI-ERROR
 12546               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12547           END-IF
 12548        END-IF
 12549     END-IF
 12550
 12551     IF PI-PMT-APPR-SW = 'G'
 12552       NEXT SENTENCE
 12553     ELSE
 12554       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12555         IF PI-EPYAMT = ZERO
 12556             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12557                 MOVE ER-0494    TO  EMI-ERROR
 12558                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12559                 GO TO 1500-EDIT-EXPENSES
 12560             ELSE
 12561                 NEXT SENTENCE
 12562         ELSE
 12563             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12564                 MOVE ER-0494    TO  EMI-ERROR
 12565                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12566                 GO TO 1500-EDIT-EXPENSES.
 12567
 12568     IF PI-PMTTYPE NOT = '2' OR
 12569        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12570         GO TO 1500-EDIT-EXPENSES.
 12571
 12572     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12573     MOVE ER-0526                TO EMI-ERROR.
 12574     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12575
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 239
* EL156.cbl
 12576     IF EMI-ERROR-NUMBER (1) = '0526'
 12577        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12578
 12579     IF EMI-ERROR-NUMBER (2) = '0526'
 12580        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12581
 12582     GO TO 1500-EDIT-EXPENSES.
 12583
 12584 1490-PAYMENT-ERROR.
 12585     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12586
 12587     IF EMI-MESSAGE-FORMATTED
 12588         MOVE -1                 TO EPYAMTL
 12589         MOVE AL-UNBON           TO EPYAMTA.
 12590
 12591 1490-EXIT.
 12592      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 240
* EL156.cbl
 12594 1500-EDIT-EXPENSES.
 12595     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12596         GO TO 1500-SKIP-ERROR-0556.
 12597
 12598 1500-CONTINUE-ON.
 12599
 12600     IF CM-O-B-COVERAGE
 12601        MOVE ER-0556             TO EMI-ERROR
 12602        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12603
 12604 1500-SKIP-ERROR-0556.
 12605     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12606        IF PI-EEXPENS NOT = ZEROS
 12607           MOVE ER-0524          TO EMI-ERROR
 12608           GO TO 1590-EXPENSE-ERROR
 12609        ELSE
 12610           GO TO 1600-EDIT-RESERVES.
 12611
 12612     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12613     MOVE '6'                    TO CNTL-REC-TYPE.
 12614
 12615     IF CONTROL-IS-ACTUAL-CARRIER
 12616         MOVE PI-CARRIER         TO WS-CARR
 12617     ELSE
 12618         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12619
 12620     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12621     MOVE +0                     TO CNTL-SEQ-NO.
 12622     MOVE 'CARR'                 TO FILE-SWITCH.
 12623
 12624     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12625
 12626     IF EXPENSE-CALC-MANUAL
 12627        GO TO 1600-EDIT-RESERVES.
 12628
 12629     IF DOLLARS-PER-PMT
 12630        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12631        GO TO 1600-EDIT-RESERVES.
 12632
 12633     IF DOLLARS-PER-MONTH AND
 12634        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12635       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12636       GO TO 1600-EDIT-RESERVES.
 12637
 12638     IF PERCENT-OF-PAYMENT
 12639        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12640
 12641     GO TO 1600-EDIT-RESERVES.
 12642
 12643 1590-EXPENSE-ERROR.
 12644     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12645
 12646     IF EMI-MESSAGE-FORMATTED
 12647        MOVE -1                  TO EEXPENSL
 12648        MOVE AL-UNBON            TO EEXPENSA.
 12649
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 241
* EL156.cbl
 12651 1600-EDIT-RESERVES.
 12652     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12653        IF PI-ERESV = ZEROS
 12654           GO TO 1700-EDIT-EXPENSE-TYPE
 12655        ELSE
 12656           MOVE ER-0525          TO EMI-ERROR
 12657           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12658           GO TO 1700-EDIT-EXPENSE-TYPE.
 12659
 12660     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12661     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12662     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12663
 12664     IF NOT AT-MANUAL-RESERVES-USED
 12665        IF PI-ERESV NOT = ZEROS
 12666           MOVE ER-0518          TO EMI-ERROR
 12667           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12668
 12669     IF AT-MANUAL-RESERVES-USED
 12670        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12671        GO TO 1700-EDIT-EXPENSE-TYPE.
 12672
 12673     IF AT-FUTURE-RESERVES-USED
 12674        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12675
 12676     IF AT-FUTURE-RESERVES-USED
 12677        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12678
 12679     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12680        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12681
 12682     IF AT-IBNR-RESERVES-USED
 12683        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12684
 12685     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12686     GO TO 1700-EDIT-EXPENSE-TYPE.
 12687
 12688 1690-RESERVE-ERROR.
 12689     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12690
 12691     IF EMI-MESSAGE-FORMATTED
 12692        MOVE AL-UNBON            TO ERESVA
 12693        MOVE -1                  TO ERESVL.
 12694
 12695 1690-EXIT.
 12696      EXIT.
 12697
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 242
* EL156.cbl
 12699 1700-EDIT-EXPENSE-TYPE.
 12700     IF PI-PMTTYPE NOT = '5' AND '6'
 12701        GO TO 2000-EDIT-DONE.
 12702
 12703     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12704                   '6' OR '7' OR '8' OR '9'
 12705        GO TO 2000-EDIT-DONE.
 12706
 12707 1705-EXPENSE-ERROR.
 12708     MOVE ER-0573                TO EMI-ERROR.
 12709     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12710
 12711     IF EMI-MESSAGE-FORMATTED
 12712        MOVE AL-UABON            TO ETYPEA
 12713        MOVE -1                  TO ETYPEL.
 12714
 12715     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 243
* EL156.cbl
 12717 1950-NOT-FOUND.
 12718     IF FILE-SWITCH = 'MSTR'
 12719        MOVE ER-0204             TO EMI-ERROR.
 12720
 12721     IF FILE-SWITCH = 'CARR'
 12722        MOVE ER-0252             TO EMI-ERROR.
 12723
 12724     IF FILE-SWITCH = 'COMP'
 12725        MOVE ER-0254             TO EMI-ERROR.
 12726
 12727     IF FILE-SWITCH = 'STAT'
 12728        MOVE ER-0149             TO EMI-ERROR.
 12729
 12730     IF FILE-SWITCH = 'PROC'
 12731        MOVE ER-0019             TO EMI-ERROR.
 12732
 12733     IF FILE-SWITCH = 'ACCT'
 12734        MOVE ER-0198             TO EMI-ERROR.
 12735
 12736     IF FILE-SWITCH = 'BENE'
 12737        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12738           MOVE ER-0282          TO EMI-ERROR
 12739        ELSE
 12740           MOVE ER-0283          TO EMI-ERROR.
 12741
 12742     MOVE -1                     TO PMTTYPEL.
 12743     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12744
 12745     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12746                                     WS-FORCE-CTR.
 12747
 12748     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12749                                     WS-FATAL-CTR.
 12750
 12751     GO TO 8200-SEND-DATAONLY.
 12752
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 244
* EL156.cbl
 12754 2000-EDIT-DONE.
 12755*********************
 12756     perform 2210-dcc-max-benes thru 2210-exit
 12757     if pi-company-id not = 'DCC'
 12758        IF (WS-SPECIAL-CALC-CD = 'C')
 12759           and (cl-critical-period > 0)
 12760           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12761              IF PI-EPYAMT > ZEROS
 12762                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12763                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12764              ELSE
 12765                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12766                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12767              END-IF
 12768              if ws-benefits-paid > cl-critical-period
 12769                 MOVE ER-0657          TO EMI-ERROR
 12770                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12771              END-IF
 12772           END-IF
 12773        END-IF
 12774     end-if
 12775     IF PI-HOLDTIL NOT = ZEROS
 12776        MOVE PI-HOLDTIL          TO HOLDTILO
 12777        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12778
 12779     IF PI-EPYFROM NOT = ZEROS
 12780        MOVE PI-EPYFROM          TO EPYFROMO
 12781        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12782
 12783     IF PI-EPYTHRU NOT = ZEROS
 12784        MOVE PI-EPYTHRU            TO EPYTHRUO
 12785        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12786        IF PI-USES-PAID-TO
 12787           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12788           MOVE '4'                TO DC-OPTION-CODE
 12789           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12790           IF NO-CONVERSION-ERROR
 12791              MOVE +1              TO DC-ELAPSED-DAYS
 12792              MOVE +0              TO DC-ELAPSED-MONTHS
 12793              MOVE '6'             TO DC-OPTION-CODE
 12794              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12795              IF NO-CONVERSION-ERROR
 12796                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12797
 12798     MOVE PI-EDAYS               TO EDAYSO.
 12799
 12800     IF PI-AIGFROM NOT = ZEROS
 12801        MOVE PI-AIGFROM          TO AIGFROMO
 12802        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12803
 12804     MOVE PI-EPYAMT              TO EPYAMTO.
 12805     MOVE PI-ERESV               TO ERESVO.
 12806     MOVE PI-EEXPENS             TO EEXPENSO.
 12807
 12808     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12809     MOVE SPACES                 TO DC-OPTION-CODE.
 12810     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12811
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 245
* EL156.cbl
 12812     IF DATE-CONVERSION-ERROR
 12813        MOVE SPACES              TO CPYFROMI
 12814     ELSE
 12815        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12816        IF PI-EPYFROM = ZEROS
 12817           MOVE AL-UANON             TO EPYFROMA
 12818           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12819           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12820
 12821     IF PI-USES-PAID-TO
 12822        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12823        MOVE +1                            TO DC-ELAPSED-DAYS
 12824        MOVE +0                            TO DC-ELAPSED-MONTHS
 12825        MOVE '6'                           TO DC-OPTION-CODE
 12826        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12827        IF NO-CONVERSION-ERROR
 12828           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12829           IF PI-EPYTHRU = ZEROS
 12830              MOVE AL-UANON                TO EPYTHRUA
 12831              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12832              MOVE ' '                     TO DC-OPTION-CODE
 12833              MOVE +0                      TO DC-ELAPSED-DAYS
 12834                                              DC-ELAPSED-MONTHS
 12835              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12836              IF NO-CONVERSION-ERROR
 12837                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12838                  GO TO 2001-CONTINUE
 12839              ELSE
 12840                  GO TO 2001-CONTINUE
 12841           ELSE
 12842              GO TO 2001-CONTINUE.
 12843
 12844     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12845     MOVE SPACES                 TO DC-OPTION-CODE.
 12846     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12847
 12848     IF DATE-CONVERSION-ERROR
 12849        MOVE SPACES              TO CPYTHRUI
 12850     ELSE
 12851        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12852        IF PI-EPYTHRU = ZEROS
 12853           MOVE AL-UANON TO EPYTHRUA
 12854           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12855           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12856
 12857 2001-CONTINUE.
 12858
 12859     MOVE PI-CDAYS               TO CDAYSO.
 12860
 12861     IF PI-EDAYS = ZEROS
 12862        MOVE AL-UNNON TO EDAYSA
 12863        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12864
 12865     MOVE PI-CPYAMT              TO CPYAMTO.
 12866
 12867     IF PI-EPYAMT = ZEROS
 12868        MOVE AL-UNNON            TO EPYAMTA
 12869        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 246
* EL156.cbl
 12870
 12871     MOVE PI-CRESV               TO CRESVO.
 12872     MOVE PI-CEXPENS             TO CEXPENSO.
 12873
 12874     IF PI-EEXPENS = ZEROS
 12875        MOVE AL-UNNON TO EEXPENSA
 12876        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12877
 12878     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12879        AND (CL-CLAIM-TYPE = 'L')
 12880        AND (PI-OFFLINE NOT EQUAL 'Y')
 12881        IF PI-PMTTYPE = '2' OR '4'
 12882           PERFORM 2200-CALC-INTEREST
 12883                                 THRU 2200-EXIT
 12884        END-IF
 12885     END-IF
 12886     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12887     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12888     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12889
 12890     IF EMI-FATAL-CTR = ZEROS
 12891        MOVE 'B'                 TO PI-PASS-SW.
 12892
 12893     IF NOT EMI-MESSAGE-FORMATTED
 12894         MOVE -1                 TO EPYFROML
 12895     ELSE
 12896         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12897            EMI-ERROR-NUMBER (2) = SPACES
 12898             MOVE -1             TO EPYFROML.
 12899
 12900     GO TO 8200-SEND-DATAONLY.
 12901
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 247
* EL156.cbl
 12903 2200-CALC-INTEREST.
 12904     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12905        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12906        MOVE '4'                 TO DC-OPTION-CODE
 12907        PERFORM 9700-LINK-DATE-CONVERT
 12908        IF DATE-CONVERSION-ERROR
 12909            MOVE LOW-VALUES      TO CP-PRF-DT
 12910        ELSE
 12911           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12912        END-IF
 12913     END-IF
 12914     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12915        IN CLAIM-INT-PASS-AREA
 12916     MOVE CL-CERT-STATE          TO CP-STATE
 12917        IN CLAIM-INT-PASS-AREA
 12918     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12919     MOVE 'LF'                   TO CP-COVERAGE
 12920     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12921     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12922     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12923     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12924     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12925     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12926
 12927* EXEC CICS LINK
 12928*       PROGRAM   ('ELCLMI')
 12929*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12930*       LENGTH    (CP-CLAIM-LENGTH)
 12931*    END-EXEC
 12932     MOVE 'ELCLMI' TO DFHEIV1
 12933*    MOVE '."C                   (   #00012339' TO DFHEIV0
 12934     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12935     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12936     MOVE X'2020233030303132333339' TO DFHEIV0(25:11)
 12937     CALL 'kxdfhei1' USING DFHEIV0,
 12938           DFHEIV1,
 12939           CLAIM-INT-PASS-AREA,
 12940           CP-CLAIM-LENGTH,
 12941           DFHEIV99,
 12942           DFHEIV99,
 12943           DFHEIV99,
 12944           DFHEIV99
 12945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12946     MOVE AL-PANOF               TO PINTHA
 12947                                    PINTA
 12948     IF NO-CI-ERROR
 12949        MOVE CP-CLM-INT-AMT      TO PINTO
 12950                                    PI-INT-AMT
 12951        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12952        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12953        MOVE AL-PANOF            TO PINTHA
 12954                                    PINTA
 12955     ELSE
 12956        IF CI-RETURN-CODE = '8'
 12957           MOVE ER-3818          TO EMI-ERROR
 12958           MOVE -1               TO ZINTL
 12959           PERFORM 9900-ERROR-FORMAT
 12960                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 248
* EL156.cbl
 12961           GO TO 2200-EXIT
 12962        ELSE
 12963           MOVE ZEROS            TO PINTO
 12964                                    PI-INT-AMT
 12965                                    PI-INT-DAYS
 12966                                    PI-INT-RATE-USED
 12967        END-IF
 12968     END-IF
 12969     IF PI-INT-AMT NOT = ZEROS
 12970        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12971           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12972           CONTINUE
 12973        ELSE
 12974           MOVE CL-SOC-SEC-NO (1:3)
 12975                                 TO WS-SSN (1:3)
 12976           MOVE CL-SOC-SEC-NO (5:2)
 12977                                 TO WS-SSN (4:2)
 12978           MOVE CL-SOC-SEC-NO (8:4)
 12979                                 TO WS-SSN (6:4)
 12980           IF (WS-SSN NUMERIC)
 12981              AND (WS-SSN NOT = ZEROS)
 12982              CONTINUE
 12983           ELSE
 12984              MOVE ER-2044       TO EMI-ERROR
 12985              PERFORM 9900-ERROR-FORMAT
 12986                                 THRU 9900-EXIT
 12987           END-IF
 12988        END-IF
 12989        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12990        MOVE +51                 TO TRLR-SEQ-NO
 12991
 12992* EXEC CICS READ
 12993*          DATASET  ('ELTRLR')
 12994*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12995*          RIDFLD   (ELTRLR-KEY)
 12996*          RESP     (WS-RESPONSE)
 12997*       END-EXEC
 12998     MOVE 'ELTRLR' TO DFHEIV1
 12999*    MOVE '&"S        E          (  N#00012389' TO DFHEIV0
 13000     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13001     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13002     MOVE X'204E233030303132333839' TO DFHEIV0(25:11)
 13003     CALL 'kxdfhei1' USING DFHEIV0,
 13004           DFHEIV1,
 13005           DFHEIV20,
 13006           DFHEIV99,
 13007           ELTRLR-KEY,
 13008           DFHEIV99,
 13009           DFHEIV99,
 13010           DFHEIV99
 13011     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13012         DFHEIV20
 13013     MOVE EIBRESP  TO WS-RESPONSE
 13014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13015        IF (NOT WS-RESP-NORMAL)
 13016                    OR
 13017           ((WS-RESP-NORMAL)
 13018           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 249
* EL156.cbl
 13019           OR (AT-CITY-STATE = SPACES)))
 13020           MOVE ER-0874          TO EMI-ERROR
 13021           PERFORM 9900-ERROR-FORMAT
 13022                                 THRU 9900-EXIT
 13023        END-IF
 13024     END-IF
 13025     .
 13026 2200-EXIT.
 13027     EXIT.
 13028 2210-dcc-max-benes.
 13029
 13030     move pi-ah-term             to ws-max-bens
 13031     if cl-critical-period not = zeros and spaces
 13032        move cl-critical-period  to ws-max-bens
 13033     end-if
 13034     move cm-ah-benefit-amt      to ws-monthly-benefit
 13035     if pdef-found
 13036        and (pd-max-amt (p1) not = zeros)
 13037        if pd-ben-pct (p1) not numeric
 13038           move zeros            to pd-ben-pct (p1)
 13039        end-if
 13040        if pd-ben-pct (p1) = zeros
 13041           move +1               to ws-work-ben-pct
 13042        else
 13043           move pd-ben-pct (p1)  to ws-work-ben-pct
 13044        end-if
 13045*       compute ws-monthly-benefit =
 13046*          ws-monthly-benefit * ws-work-ben-pct
 13047*       if ws-monthly-benefit > pd-max-amt (p1)
 13048*          move pd-max-amt (p1) to ws-monthly-benefit
 13049*       end-if
 13050     end-if
 13051
 13052     move cl-cert-key-data       to elcrtt-key (2:21)
 13053     move cl-company-cd          to ctrlr-comp-cd
 13054     move cl-cert-no             to ctrlr-cert-no
 13055     move 'B'                    to ctrlr-rec-type
 13056
 13057
 13058* EXEC CICS READ
 13059*       DATASET  ('ELCRTT')
 13060*       set      (address of CERTIFICATE-TRAILERS)
 13061*       RIDFLD   (ELCRTT-KEY)
 13062*       RESP     (WS-RESPONSE)
 13063*    END-EXEC
 13064     MOVE 'ELCRTT' TO DFHEIV1
 13065*    MOVE '&"S        E          (  N#00012437' TO DFHEIV0
 13066     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13067     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13068     MOVE X'204E233030303132343337' TO DFHEIV0(25:11)
 13069     CALL 'kxdfhei1' USING DFHEIV0,
 13070           DFHEIV1,
 13071           DFHEIV20,
 13072           DFHEIV99,
 13073           ELCRTT-KEY,
 13074           DFHEIV99,
 13075           DFHEIV99,
 13076           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 250
* EL156.cbl
 13077     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13078         DFHEIV20
 13079     MOVE EIBRESP  TO WS-RESPONSE
 13080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13081     IF not WS-RESP-NORMAL
 13082        go to 2210-exit
 13083     end-if
 13084
 13085*    if instypei = 'P'
 13086*       move +1 to s1
 13087*    else
 13088*       MOVE +2 to s1
 13089*    end-if
 13090
 13091*    move +1 to s1
 13092*    evaluate cl-claim-type
 13093*       when 'A'
 13094*          move +1 to s2
 13095*       when 'I'
 13096*          move +2 to s2
 13097*       when 'G'
 13098*          move +3 to s2
 13099*       when 'L'
 13100*          move +4 to s2
 13101*       when 'P'
 13102*          move +5 to s2
 13103*    end-evaluate
 13104
 13105     move zeros                  to ws-prev-days-paid
 13106                                    ws-benefits-paid
 13107                                    ws-prev-amt-paid
 13108     perform varying s1 from +1 by +1 until
 13109        (s1 > +24)
 13110        or (cs-claim-type (s1) = spaces)
 13111        if pi-company-id not = 'DCC'
 13112           if cs-claim-type (s1) = cl-claim-type
 13113              compute ws-prev-days-paid =
 13114                 ws-prev-days-paid + cs-days-paid (s1)
 13115              compute ws-prev-amt-paid =
 13116                 ws-prev-amt-paid + cs-total-paid (s1)
 13117           end-if
 13118        else
 13119           if (cs-claim-type (s1) = cl-claim-type)
 13120              and (cs-benefit-period (s1) = cl-benefit-period)
 13121              and (cs-insured-type (s1) = cl-insured-type)
 13122              compute ws-prev-days-paid =
 13123                 ws-prev-days-paid + cs-days-paid (s1)
 13124              compute ws-prev-amt-paid =
 13125                 ws-prev-amt-paid + cs-total-paid (s1)
 13126           end-if
 13127        end-if
 13128     end-perform
 13129     if pi-epyamt > zeros
 13130        compute ws-benefits-paid =
 13131           (ws-prev-amt-paid + pi-epyamt)
 13132           / ws-monthly-benefit
 13133     else
 13134        compute ws-benefits-paid =
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 251
* EL156.cbl
 13135           (ws-prev-amt-paid + pi-cpyamt)
 13136           / ws-monthly-benefit
 13137     end-if
 13138*    if pi-company-id = 'DCC'
 13139     if cl-claim-type not = 'L' and 'P'
 13140        if ws-benefits-paid > ws-max-bens
 13141           move er-1658          to emi-error
 13142           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13143        end-if
 13144     end-if
 13145*    end-if
 13146*     if s1 < +25
 13147*        if pi-epyamt > zeros
 13148*           compute ws-benefits-paid =
 13149*              (cs-total-paid (s1) + PI-EPYAMT)
 13150*              / ws-monthly-benefit
 13151*        else
 13152*           compute ws-benefits-paid =
 13153*              (cs-total-paid (s1) + PI-CPYAMT)
 13154*              / ws-monthly-benefit
 13155*        end-if
 13156
 13157*       if ws-benefits-paid > pd-crit-period (p1)
 13158*        if ws-benefits-paid > ws-max-bens
 13159*           move er-1658          to emi-error
 13160*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13161*        end-if
 13162*     end-if
 13163     .
 13164 2210-exit.
 13165     exit.
 13166
 13167 2220-update-elcrtt.
 13168
 13169
 13170* EXEC CICS GETMAIN
 13171*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13172*       LENGTH   (ELCRTT-LENGTH)
 13173*       INITIMG  (GETMAIN-SPACE)
 13174*    END-EXEC
 13175*    MOVE ',"IL                  $   #00012531' TO DFHEIV0
 13176     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13177     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13178     MOVE X'2020233030303132353331' TO DFHEIV0(25:11)
 13179     CALL 'kxdfhei1' USING DFHEIV0,
 13180           DFHEIV20,
 13181           ELCRTT-LENGTH,
 13182           GETMAIN-SPACE
 13183     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13184         DFHEIV20
 13185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13186
 13187     move cl-cert-key-data       to elcrtt-key (2:21)
 13188     move cl-company-cd          to ctrlr-comp-cd
 13189     move cl-cert-no             to ctrlr-cert-no
 13190     move 'B'                    to ctrlr-rec-type
 13191
 13192
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 252
* EL156.cbl
 13193* EXEC CICS READ
 13194*       UPDATE
 13195*       DATASET  (ELCRTT-DSID)
 13196*       into     (CERTIFICATE-TRAILERS)
 13197*       RIDFLD   (ELCRTT-KEY)
 13198*       RESP     (WS-RESPONSE)
 13199*    END-EXEC
 13200     MOVE LENGTH OF
 13201      CERTIFICATE-TRAILERS
 13202       TO DFHEIV11
 13203*    MOVE '&"IL       EU         (  N#00012542' TO DFHEIV0
 13204     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13205     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13206     MOVE X'204E233030303132353432' TO DFHEIV0(25:11)
 13207     CALL 'kxdfhei1' USING DFHEIV0,
 13208           ELCRTT-DSID,
 13209           CERTIFICATE-TRAILERS,
 13210           DFHEIV11,
 13211           ELCRTT-KEY,
 13212           DFHEIV99,
 13213           DFHEIV99,
 13214           DFHEIV99
 13215     MOVE EIBRESP  TO WS-RESPONSE
 13216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13217
 13218     IF WS-RESP-NORMAL
 13219        perform 2225-upd-crt-trlr thru 2225-exit
 13220
 13221* EXEC CICS REWRITE
 13222*          DATASET  (ELCRTT-DSID)
 13223*          from     (CERTIFICATE-TRAILERS)
 13224*          RESP     (WS-RESPONSE)
 13225*       END-EXEC
 13226     MOVE LENGTH OF
 13227      CERTIFICATE-TRAILERS
 13228       TO DFHEIV11
 13229*    MOVE '&& L                  %  N#00012552' TO DFHEIV0
 13230     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13231     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13232     MOVE X'204E233030303132353532' TO DFHEIV0(25:11)
 13233     CALL 'kxdfhei1' USING DFHEIV0,
 13234           ELCRTT-DSID,
 13235           CERTIFICATE-TRAILERS,
 13236           DFHEIV11,
 13237           DFHEIV99
 13238     MOVE EIBRESP  TO WS-RESPONSE
 13239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13240     else
 13241        if ws-resp-notfnd
 13242           move 'CS'             to certificate-trailers
 13243           move cl-company-cd    to cs-company-cd
 13244           move cl-cert-key-data to cs-control-primary (2:21)
 13245           move cl-cert-no       to cs-cert-no
 13246           move 'B'              to cs-trailer-type
 13247           perform varying s1 from +1 by +1 until s1 > +24
 13248              move zeros         to cs-benefit-period (s1)
 13249                                    cs-days-paid (s1)
 13250                                    cs-total-paid (s1)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 253
* EL156.cbl
 13251                                    cs-remaining-bens (s1)
 13252           end-perform
 13253           perform 2225-upd-crt-trlr
 13254                                 thru 2225-exit
 13255
 13256* EXEC CICS WRITE
 13257*             DATASET  (ELCRTT-DSID)
 13258*             from     (CERTIFICATE-TRAILERS)
 13259*             RIDFLD   (cs-control-primary)
 13260*             RESP     (WS-RESPONSE)
 13261*          END-EXEC
 13262     MOVE LENGTH OF
 13263      CERTIFICATE-TRAILERS
 13264       TO DFHEIV11
 13265*    MOVE '&$ L                  ''  N#00012572' TO DFHEIV0
 13266     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13267     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13268     MOVE X'204E233030303132353732' TO DFHEIV0(25:11)
 13269     CALL 'kxdfhei1' USING DFHEIV0,
 13270           ELCRTT-DSID,
 13271           CERTIFICATE-TRAILERS,
 13272           DFHEIV11,
 13273           cs-control-primary,
 13274           DFHEIV99,
 13275           DFHEIV99
 13276     MOVE EIBRESP  TO WS-RESPONSE
 13277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13278        end-if
 13279     END-IF
 13280
 13281     .
 13282 2220-exit.
 13283     exit.
 13284
 13285 2225-upd-crt-trlr.
 13286
 13287*    if instypei = 'P'
 13288*       move +1 to s1
 13289*    else
 13290*       MOVE +2 to s1
 13291*    end-if
 13292
 13293*    move +1 to s1
 13294*    evaluate cl-claim-type
 13295*       when 'A'
 13296*          move +1 to s2
 13297*       when 'I'
 13298*          move +2 to s2
 13299*       when 'G'
 13300*          move +3 to s2
 13301*       when 'L'
 13302*          move +4 to s2
 13303*       when 'P'
 13304*          move +5 to s2
 13305*    end-evaluate
 13306     perform varying s1 from +1 by +1 until
 13307        (s1 > +24)
 13308        or (cl-claim-no = cs-claim-no (s1))
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 254
* EL156.cbl
 13309     end-perform
 13310     if s1 < +25
 13311        compute cs-total-paid (s1) =
 13312           cs-total-paid (s1) + at-amount-paid
 13313        compute cs-days-paid (s1) =
 13314           cs-days-paid (s1) +  at-days-in-period
 13315*       compute cs-remaining-bens (s1) =
 13316*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13317        perform 2230-accum-bens-paid thru 2230-exit
 13318     end-if
 13319
 13320     .
 13321 2225-exit.
 13322     exit.
 13323 2230-accum-bens-paid.
 13324     if cl-claim-type not = 'L' and 'P'
 13325        move pi-ah-term          to ws-max-bens
 13326        if cl-critical-period not = zeros and spaces
 13327           move cl-critical-period
 13328                                 to ws-max-bens
 13329        end-if
 13330     else
 13331        move 01                  to ws-max-bens
 13332     end-if
 13333     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13334     perform varying s2 from +1 by +1 until
 13335        (s2 > +24)
 13336        or (cs-claim-no (s2) = spaces)
 13337        if pi-company-id not = 'DCC'
 13338           if cs-claim-type (s2) = cl-claim-type
 13339              compute ws-tot-days-paid =
 13340                 ws-tot-days-paid + cs-days-paid (s2)
 13341              compute ws-tot-amt-paid =
 13342                 ws-tot-amt-paid + cs-total-paid (s2)
 13343           end-if
 13344        else
 13345           if (cs-benefit-period (s2) = cl-benefit-period)
 13346              and (cs-claim-type (s2) = cl-claim-type)
 13347              and (cs-insured-type (s2) = cl-insured-type)
 13348              compute ws-tot-days-paid =
 13349                 ws-tot-days-paid + cs-days-paid (s2)
 13350              compute ws-tot-amt-paid =
 13351                 ws-tot-amt-paid + cs-total-paid (s2)
 13352           end-if
 13353        end-if
 13354     end-perform
 13355     if cl-claim-type = 'L' and 'P'
 13356        if ws-tot-amt-paid > zeros
 13357           move zeros            to cs-remaining-bens (s1)
 13358        else
 13359           move 01               to cs-remaining-bens (s1)
 13360        end-if
 13361     else
 13362        compute ws-pd-bens rounded =
 13363           ws-tot-amt-paid / pi-ah-benefit-amt
 13364        compute cs-remaining-bens (s1) =
 13365           ws-max-bens - ws-pd-bens
 13366        if cs-remaining-bens (s1) < zeros
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 255
* EL156.cbl
 13367           move zeros            to cs-remaining-bens (s1)
 13368        end-if
 13369     end-if
 13370     .
 13371 2230-exit.
 13372     exit.
 13373 3000-MOVE-INPUT-TO-SAVE-AREA.
 13374     IF PMTTYPEL > 0
 13375         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13376
 13377     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13378
 13379     IF WS-PMTTYPE = '9'
 13380         MOVE 'P'                TO PI-PROVISIONAL-IND
 13381         MOVE '1'                TO WS-PMTTYPE.
 13382
 13383     IF PAYEEL > 0
 13384         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13385         MOVE PAYEEI             TO WS-PAYEE.
 13386
 13387     IF NOTE1L > +0
 13388         MOVE NOTE1I             TO WS-PMTNOTE1
 13389                                    WS-FLI-PMTNOTE
 13390                                    WS-HAN-PMTNOTE.
 13391
 13392     IF NOTE2L > +0
 13393         MOVE NOTE2I             TO WS-PMTNOTE2.
 13394
 13395     IF OFFLINEL > 0
 13396         MOVE OFFLINEI           TO WS-OFFLINE.
 13397
 13398     IF PROOFDTL > 0
 13399         MOVE PROOFDTI            TO DATE-WORK
 13400         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13401         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13402         MOVE '4'                 TO DC-OPTION-CODE
 13403         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13404         IF NO-CONVERSION-ERROR
 13405            MOVE NUM-WORK         TO PROOFDTO
 13406            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13407            MOVE NUM-WORK         TO WS-PROOF-DATE
 13408         ELSE
 13409            MOVE ZEROS            TO WS-PROOF-DATE
 13410         END-IF
 13411     END-IF.
 13412
 13413     IF EOBYNL > +0
 13414         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13415         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13416     END-IF
 13417
 13418     IF CLMFMYNL > +0
 13419         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13420         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13421     END-IF
 13422
 13423     IF SURVYYNL > +0
 13424         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 256
* EL156.cbl
 13425         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13426     END-IF
 13427
 13428     IF SPRELYNL > +0
 13429         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13430         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13431     END-IF
 13432*    IF GROUPEDL > +0
 13433*        MOVE GROUPEDI           TO WS-GROUPED.
 13434*
 13435*    IF CASHL > +0
 13436*       MOVE CASHI               TO WS-CASH.
 13437     IF LOANNOL > +0
 13438         MOVE LOANNOI            TO WS-LOAN-NO.
 13439
 13440     IF CHECKNOL > 0
 13441         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13442
 13443     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13444         IF WS-AIG-CREDIT-ENTERED
 13445             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13446             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13447             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13448             MOVE AL-UANON         TO CHECKNOA.
 13449
 13450     IF HOLDTILL > 0
 13451         MOVE HOLDTILI           TO DATE-WORK
 13452         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13453         MOVE NUM-WORK           TO WS-HOLDTIL.
 13454
 13455     IF ZINTL > +0
 13456
 13457* EXEC CICS BIF DEEDIT
 13458*           FIELD   (ZINTI)
 13459*           LENGTH  (07)
 13460*       END-EXEC
 13461     MOVE 07
 13462       TO DFHEIV11
 13463*    MOVE '@"L                   #   #00012756' TO DFHEIV0
 13464     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13465     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13466     MOVE X'2020233030303132373536' TO DFHEIV0(25:11)
 13467     CALL 'kxdfhei1' USING DFHEIV0,
 13468           ZINTI,
 13469           DFHEIV11
 13470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13471        IF ZINTI NOT NUMERIC
 13472           MOVE ER-0419          TO EMI-ERROR
 13473           PERFORM 9900-ERROR-FORMAT
 13474           MOVE AL-UABON         TO ZINTA
 13475           MOVE -1               TO ZINTL
 13476        ELSE
 13477           MOVE ZINTI            TO CP-INT-RATE
 13478                                    WS-INT-RATE
 13479           MOVE CP-INT-RATE      TO ZINTO
 13480           MOVE AL-UNNON         TO ZINTA
 13481        END-IF
 13482     ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 257
* EL156.cbl
 13483        MOVE ZEROS               TO CP-INT-RATE
 13484     END-IF
 13485     IF EPYFROML > 0
 13486         MOVE EPYFROMI           TO DATE-WORK
 13487         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13488         MOVE NUM-WORK           TO WS-EPYFROM.
 13489
 13490     IF AIGFROML > 0
 13491         MOVE AIGFROMI           TO DATE-WORK
 13492         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13493         MOVE NUM-WORK           TO WS-AIGFROM
 13494     ELSE
 13495         IF (AIGFROMI = LOW-VALUES) AND
 13496            (PI-AIGFROM NOT = ZEROS)
 13497              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13498
 13499     IF EPYTHRUL > +0
 13500        MOVE EPYTHRUI           TO DATE-WORK
 13501        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13502        MOVE NUM-WORK           TO WS-EPYTHRU
 13503        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13504        MOVE '4'                TO DC-OPTION-CODE
 13505        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13506        IF NO-CONVERSION-ERROR
 13507           IF PI-USES-PAID-TO
 13508              MOVE '6'                TO DC-OPTION-CODE
 13509              MOVE -1                 TO DC-ELAPSED-DAYS
 13510              MOVE +0                 TO DC-ELAPSED-MONTHS
 13511              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13512              IF NO-CONVERSION-ERROR
 13513                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13514                 MOVE ' '             TO DC-OPTION-CODE
 13515                 MOVE +0              TO DC-ELAPSED-DAYS
 13516                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13517              IF NO-CONVERSION-ERROR
 13518                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13519
 13520*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13521*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13522     IF EDAYSL > 0
 13523
 13524* EXEC CICS BIF DEEDIT
 13525*            FIELD(EDAYSI)
 13526*            LENGTH(6)
 13527*        END-EXEC
 13528     MOVE 6
 13529       TO DFHEIV11
 13530*    MOVE '@"L                   #   #00012812' TO DFHEIV0
 13531     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13532     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13533     MOVE X'2020233030303132383132' TO DFHEIV0(25:11)
 13534     CALL 'kxdfhei1' USING DFHEIV0,
 13535           EDAYSI,
 13536           DFHEIV11
 13537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13538         MOVE EDAYSI             TO WS-DY-WORK
 13539         IF WS-DY-SIGN = SPACES
 13540            MOVE WS-DY-NUM       TO WS-EDAYS
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 258
* EL156.cbl
 13541            ADD 0                TO WS-EDAYS
 13542         ELSE
 13543            MOVE EDAYSI          TO WS-EDAYS
 13544            ADD 0                TO WS-EDAYS.
 13545
 13546*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13547*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13548     IF EPYAMTL > 0
 13549
 13550* EXEC CICS BIF DEEDIT
 13551*            FIELD(EPYAMTI)
 13552*            LENGTH(10)
 13553*        END-EXEC
 13554     MOVE 10
 13555       TO DFHEIV11
 13556*    MOVE '@"L                   #   #00012827' TO DFHEIV0
 13557     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13558     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13559     MOVE X'2020233030303132383237' TO DFHEIV0(25:11)
 13560     CALL 'kxdfhei1' USING DFHEIV0,
 13561           EPYAMTI,
 13562           DFHEIV11
 13563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13564         MOVE EPYAMTI            TO WS-PY-WORK
 13565         IF WS-PY-SIGN = SPACES
 13566            MOVE WS-PY-NUM       TO WS-EPYAMT
 13567            ADD 0                TO WS-EPYAMT
 13568         ELSE
 13569            MOVE EPYAMTI         TO WS-EPYAMT
 13570            ADD 0                TO WS-EPYAMT.
 13571
 13572     IF ERESVL > 0
 13573
 13574* EXEC CICS BIF DEEDIT
 13575*            FIELD(ERESVI)
 13576*            LENGTH(9)
 13577*        END-EXEC
 13578     MOVE 9
 13579       TO DFHEIV11
 13580*    MOVE '@"L                   #   #00012840' TO DFHEIV0
 13581     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13582     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13583     MOVE X'2020233030303132383430' TO DFHEIV0(25:11)
 13584     CALL 'kxdfhei1' USING DFHEIV0,
 13585           ERESVI,
 13586           DFHEIV11
 13587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13588         MOVE ERESVI TO WS-ERESV.
 13589
 13590     IF EEXPENSL > 0
 13591
 13592* EXEC CICS BIF DEEDIT
 13593*            FIELD(EEXPENSI)
 13594*            LENGTH(8)
 13595*        END-EXEC
 13596     MOVE 8
 13597       TO DFHEIV11
 13598*    MOVE '@"L                   #   #00012847' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 259
* EL156.cbl
 13599     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13600     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13601     MOVE X'2020233030303132383437' TO DFHEIV0(25:11)
 13602     CALL 'kxdfhei1' USING DFHEIV0,
 13603           EEXPENSI,
 13604           DFHEIV11
 13605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13606         MOVE EEXPENSI           TO WS-EEXPENS.
 13607
 13608     IF ETYPEL > ZEROS
 13609         MOVE ETYPEI             TO WS-ETYPE.
 13610
 13611     IF PI-COMPANY-ID = 'BOA'
 13612        IF PINTL > ZEROS
 13613
 13614* EXEC CICS BIF DEEDIT
 13615*            FIELD (PINTI)
 13616*            LENGTH(05)
 13617*          END-EXEC
 13618     MOVE 05
 13619       TO DFHEIV11
 13620*    MOVE '@"L                   #   #00012858' TO DFHEIV0
 13621     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13622     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13623     MOVE X'2020233030303132383538' TO DFHEIV0(25:11)
 13624     CALL 'kxdfhei1' USING DFHEIV0,
 13625           PINTI,
 13626           DFHEIV11
 13627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13628           IF PINTI NUMERIC
 13629               MOVE AL-UNNON     TO PINTA
 13630               MOVE PINTI        TO WS-INT-RATE
 13631               MOVE WS-INT-RATE  TO PINTO.
 13632
 13633 3000-EXIT.
 13634     EXIT.
 13635
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 260
* EL156.cbl
 13637 3050-REBUILD-ENTERED.
 13638
 13639     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13640
 13641     IF PI-PROV-PMT
 13642         MOVE '9'           TO PMTTYPEO
 13643     ELSE
 13644         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13645
 13646     MOVE PI-PAYEE          TO PAYEEO.
 13647     MOVE PI-PMTNOTE1       TO NOTE1O.
 13648     MOVE PI-PMTNOTE2       TO NOTE2O.
 13649     MOVE PI-OFFLINE        TO OFFLINEO.
 13650     IF PI-PROOF-DATE NOT = ZEROS
 13651         MOVE PI-PROOF-DATE TO PROOFDTO
 13652         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13653     END-IF.
 13654*    MOVE PI-GROUPED        TO GROUPEDO.
 13655
 13656*    MOVE PI-CASH           TO CASHO.
 13657
 13658     IF PI-INT-RATE > ZEROS
 13659         MOVE PI-INT-RATE   TO PINTO.
 13660
 13661     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13662        IF PI-INT-AMT > ZEROS
 13663           MOVE PI-INT-AMT       TO PINTO
 13664           MOVE AL-PANOF         TO PINTA
 13665                                    PINTHA
 13666        END-IF
 13667     END-IF
 13668     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13669     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13670     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13671     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13672     IF PI-HOLDTIL NOT = ZEROS
 13673        MOVE PI-HOLDTIL          TO HOLDTILO
 13674        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13675
 13676     IF PI-EPYFROM NOT = ZEROS
 13677        MOVE PI-EPYFROM          TO EPYFROMO
 13678        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13679
 13680     IF PI-AIGFROM NOT = ZEROS
 13681        MOVE PI-AIGFROM          TO AIGFROMO
 13682        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13683
 13684     IF PI-EPYTHRU NOT = ZEROS
 13685        MOVE PI-EPYTHRU          TO EPYTHRUO
 13686        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13687        IF PI-USES-PAID-TO
 13688           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13689           MOVE '4'                TO DC-OPTION-CODE
 13690           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13691           IF NO-CONVERSION-ERROR
 13692              MOVE +1 TO DC-ELAPSED-DAYS
 13693              MOVE +0 TO DC-ELAPSED-MONTHS
 13694              MOVE '6' TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 261
* EL156.cbl
 13695              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13696              IF NO-CONVERSION-ERROR
 13697                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13698
 13699     IF PI-EDAYS NOT = ZEROS
 13700        MOVE PI-EDAYS TO EDAYSO.
 13701
 13702     IF PI-EPYAMT NOT = ZEROS
 13703        MOVE PI-EPYAMT TO EPYAMTO.
 13704
 13705     IF PI-ERESV NOT = ZEROS
 13706        MOVE PI-ERESV TO ERESVO.
 13707
 13708     IF PI-EEXPENS NOT = ZEROS
 13709        MOVE PI-EEXPENS TO EEXPENSO.
 13710
 13711     MOVE PI-ETYPE TO ETYPEO.
 13712
 13713     IF PI-ECHECKNO NOT = SPACES
 13714        MOVE PI-ECHECKNO         TO CHECKNOO
 13715     ELSE
 13716        MOVE PI-CCHECKNO         TO CHECKNOO.
 13717
 13718     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13719     MOVE SPACES                 TO DC-OPTION-CODE.
 13720     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13721
 13722     IF DATE-CONVERSION-ERROR
 13723        MOVE SPACES              TO CPYFROMI
 13724     ELSE
 13725        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13726
 13727     IF PI-USES-PAID-TO
 13728        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13729        MOVE +1                  TO DC-ELAPSED-DAYS
 13730        MOVE +0                  TO DC-ELAPSED-MONTHS
 13731        MOVE '6'                 TO DC-OPTION-CODE
 13732        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13733        IF NO-CONVERSION-ERROR
 13734           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13735           GO TO 3051-CONTINUE.
 13736
 13737     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13738     MOVE SPACES                 TO DC-OPTION-CODE.
 13739     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13740
 13741     IF DATE-CONVERSION-ERROR
 13742        MOVE SPACES              TO CPYTHRUI
 13743     ELSE
 13744        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13745
 13746 3051-CONTINUE.
 13747
 13748     IF PI-CDAYS NOT = ZEROS
 13749        MOVE PI-CDAYS TO CDAYSO.
 13750
 13751     IF PI-CPYAMT NOT = ZEROS
 13752        MOVE PI-CPYAMT TO CPYAMTO.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 262
* EL156.cbl
 13753
 13754     IF PI-CRESV NOT = ZEROS
 13755        MOVE PI-CRESV TO CRESVO.
 13756
 13757     IF PI-CEXPENS NOT = ZEROS
 13758        MOVE PI-CEXPENS TO CEXPENSO.
 13759
 13760 3059-EXIT.
 13761     EXIT.
 13762
 13763 3100-DEEDIT-DATE.
 13764
 13765* EXEC CICS BIF DEEDIT
 13766*        FIELD(DATE-WORK)
 13767*        LENGTH(8)
 13768*    END-EXEC.
 13769     MOVE 8
 13770       TO DFHEIV11
 13771*    MOVE '@"L                   #   #00012998' TO DFHEIV0
 13772     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13773     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13774     MOVE X'2020233030303132393938' TO DFHEIV0(25:11)
 13775     CALL 'kxdfhei1' USING DFHEIV0,
 13776           DATE-WORK,
 13777           DFHEIV11
 13778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13779
 13780
 13781 3100-EXIT.
 13782     EXIT.
 13783
 13784 3200-CALC-AIG-DAYS.
 13785
 13786     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13787
 13788     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13789     MOVE ' '                    TO DC-OPTION-CODE.
 13790     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13791     IF NO-CONVERSION-ERROR
 13792         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13793     ELSE
 13794         GO TO 3290-ERROR.
 13795
 13796     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13797         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13798                                WS-BIN-FROM-DT
 13799     ELSE
 13800         IF CL-TOTAL-PAID-AMT > ZEROS
 13801             IF WS-SV-EPYFROM = LOW-VALUES
 13802                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13803                                        WS-BIN-FROM-DT
 13804             ELSE
 13805                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13806                                        WS-BIN-FROM-DT
 13807         ELSE
 13808             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13809                                        WS-BIN-FROM-DT.
 13810
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 263
* EL156.cbl
 13811 3210-CONTINUE.
 13812
 13813     MOVE ' '                    TO DC-OPTION-CODE.
 13814     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13815     IF DATE-CONVERSION-ERROR
 13816         GO TO 3290-ERROR.
 13817
 13818     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13819
 13820     IF PI-LOAN-DUE-DAY = 31
 13821         MOVE 30              TO WS-PMT-DUE-DA
 13822                                 WS-SAVE-DUE-DA
 13823     ELSE
 13824         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13825                                 WS-SAVE-DUE-DA.
 13826
 13827     IF (PI-LOAN-DUE-DAY > 28) AND
 13828        (WS-PMT-DUE-MO = 2)
 13829         MOVE 'Y'                TO WS-DUE-DAY-SW
 13830         MOVE 28                 TO WS-PMT-DUE-DA.
 13831
 13832     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13833     MOVE '4'                    TO DC-OPTION-CODE.
 13834     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13835     IF NO-CONVERSION-ERROR
 13836         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13837     ELSE
 13838         GO TO 3290-ERROR.
 13839
 13840*--------------------------------------------------------------*
 13841*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13842*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13843*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13844*                                                              *
 13845*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13846*             INCURRED DATE      - 04/15/91                    *
 13847*             PMT DUE DATE       - 04/03/91                    *
 13848*             PMT DUE DATE       - 05/03/91                    *
 13849*--------------------------------------------------------------*
 13850
 13851     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13852        (WS-SV-AIGFROM = LOW-VALUES)
 13853         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13854            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13855             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13856             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13857             IF NO-CONVERSION-ERROR
 13858                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13859                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13860             ELSE
 13861                 GO TO 3290-ERROR.
 13862
 13863     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13864        (WS-SV-AIGFROM = LOW-VALUES)
 13865         GO TO 3205-CONT-CALC-PMT.
 13866
 13867     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13868     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 264
* EL156.cbl
 13869     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13870     IF NO-CONVERSION-ERROR
 13871         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13872     ELSE
 13873         GO TO 3290-ERROR.
 13874
 13875     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13876        (WS-PMT-DUE-DA < WS-FROM-DA)
 13877          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13878          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13879          IF NO-CONVERSION-ERROR
 13880              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13881              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13882          ELSE
 13883              GO TO 3290-ERROR.
 13884
 13885 3205-CONT-CALC-PMT.
 13886
 13887*--------------------------------------------------------------*
 13888*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 13889*    BETWEEN THE PAY FROM / THRU DATES.                        *
 13890*--------------------------------------------------------------*
 13891
 13892     IF CL-TOTAL-PAID-AMT = ZEROS AND
 13893        PI-PMTTYPE = '2'
 13894          NEXT SENTENCE
 13895     ELSE
 13896        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 13897           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 13898             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 13899             MOVE ER-3527            TO EMI-ERROR
 13900             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13901             MOVE -1                 TO EPYTHRUL
 13902             MOVE AL-UNBON           TO EPYTHRUA
 13903                                        EPYFROMA
 13904             GO TO 3299-EXIT.
 13905
 13906*--------------------------------------------------------------*
 13907*    CALCULATE RETRO ELIMINATION DATE                          *
 13908*--------------------------------------------------------------*
 13909
 13910     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13911         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13912     ELSE
 13913         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 13914
 13915     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 13916     MOVE +0             TO DC-ELAPSED-MONTHS.
 13917     MOVE '6'            TO DC-OPTION-CODE.
 13918     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13919     IF NO-CONVERSION-ERROR
 13920         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 13921     ELSE
 13922         GO TO 3290-ERROR.
 13923
 13924 3210-CHECK-PMT-DATE.
 13925
 13926*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 265
* EL156.cbl
 13927*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 13928*    THE ENTERED PAY FROM DATE                                 *
 13929*--------------------------------------------------------------*
 13930
 13931     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 13932         NEXT SENTENCE
 13933     ELSE
 13934         GO TO 3220-COMPUTE-DAYS.
 13935
 13936     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 13937     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13938     IF NO-CONVERSION-ERROR
 13939         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13940         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13941         GO TO 3210-CHECK-PMT-DATE
 13942     ELSE
 13943         GO TO 3290-ERROR.
 13944
 13945 3220-COMPUTE-DAYS.
 13946
 13947     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 13948     MOVE ZEROS         TO WS-CDAYS.
 13949     MOVE 'N'           TO WS-ELIMINATION-SW.
 13950
 13951*--------------------------------------------------------------*
 13952*    COMPUTE CALIFORNIA DUE DAYS                               *
 13953*--------------------------------------------------------------*
 13954
 13955     IF CL-TOTAL-PAID-AMT > ZEROS
 13956         MOVE 'Y' TO WS-ELIMINATION-SW
 13957         GO TO 3240-FIRST-PMT-DUE
 13958     ELSE
 13959        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 13960            NEXT SENTENCE
 13961        ELSE
 13962            GO TO 3240-FIRST-PMT-DUE.
 13963
 13964 3230-NEXT-PMT-DUE.
 13965
 13966     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 13967     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13968     IF NO-CONVERSION-ERROR
 13969         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 13970         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13971     ELSE
 13972         GO TO 3290-ERROR.
 13973
 13974 3240-FIRST-PMT-DUE.
 13975
 13976     IF CL-TOTAL-PAID-AMT > ZEROS
 13977         NEXT SENTENCE
 13978     ELSE
 13979        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 13980            GO TO 3230-NEXT-PMT-DUE.
 13981
 13982     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 13983         GO TO 3250-VERIFY-ELIMINATION.
 13984
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 266
* EL156.cbl
 13985     ADD +30 TO WS-CDAYS.
 13986     MOVE 'Y' TO WS-ELIMINATION-SW.
 13987     GO TO 3230-NEXT-PMT-DUE.
 13988
 13989 3250-VERIFY-ELIMINATION.
 13990
 13991     IF ELIM-SATISFIED
 13992         GO TO 3260-END-CALC.
 13993
 13994     IF PI-PMTTYPE = '1'
 13995         MOVE ZEROS TO WS-CDAYS
 13996         GO TO 3260-END-CALC.
 13997
 13998     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13999         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14000     ELSE
 14001         IF CL-TOTAL-PAID-AMT > ZEROS
 14002             IF WS-SV-EPYFROM = LOW-VALUES
 14003                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14004             ELSE
 14005                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14006         ELSE
 14007             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14008
 14009     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14010     MOVE '1'                    TO DC-OPTION-CODE.
 14011     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14012     IF NO-CONVERSION-ERROR
 14013         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14014     ELSE
 14015         GO TO 3290-ERROR.
 14016
 14017     IF CL-TOTAL-PAID-AMT > ZEROS
 14018         MOVE WS-DAYS-OFF TO WS-CDAYS
 14019     ELSE
 14020         IF PI-BEN-DAYS > WS-DAYS-OFF
 14021             MOVE ZEROS TO WS-CDAYS
 14022         ELSE
 14023             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14024
 14025 3260-END-CALC.
 14026
 14027     MOVE WS-CDAYS TO PI-CDAYS.
 14028
 14029     IF PI-EDAYS = ZEROS
 14030         MOVE PI-CDAYS TO PI-EDAYS
 14031         MOVE AL-UNNON TO EDAYSA.
 14032
 14033     GO TO 3299-EXIT.
 14034
 14035 3290-ERROR.
 14036
 14037     MOVE ER-3528            TO EMI-ERROR.
 14038     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14039     MOVE -1                 TO CDAYSL.
 14040     MOVE AL-UNBON           TO CDAYSA.
 14041
 14042 3299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 267
* EL156.cbl
 14043     EXIT.
 14044
 14045 3300-BUMP-DATE.
 14046
 14047     IF WS-RESTORE-DUE-DAY
 14048         MOVE 'N'              TO WS-DUE-DAY-SW
 14049         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14050         ADD 1                 TO WS-PMT-DUE-MO
 14051         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14052         MOVE '4'              TO DC-OPTION-CODE
 14053         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14054         IF NO-CONVERSION-ERROR
 14055             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14056             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14057             GO TO 3399-EXIT
 14058         ELSE
 14059             MOVE '9'          TO DC-ERROR-CODE
 14060             GO TO 3399-EXIT.
 14061
 14062     IF (WS-PMT-DUE-MO = 1) AND
 14063        (WS-SAVE-DUE-DA > 28)
 14064           MOVE 'Y' TO WS-DUE-DAY-SW.
 14065
 14066     MOVE +0                 TO DC-ELAPSED-DAYS.
 14067     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14068     MOVE '6'                TO DC-OPTION-CODE.
 14069     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14070
 14071 3399-EXIT.
 14072     EXIT.
 14073
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 268
* EL156.cbl
 14075 3400-COMPUTE-EXPIRY.
 14076
 14077     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14078     MOVE +0                    TO DC-ELAPSED-DAYS
 14079                                   DC-ODD-DAYS-OVER.
 14080     MOVE '1'                   TO DC-END-OF-MONTH.
 14081     MOVE '6'                   TO DC-OPTION-CODE.
 14082
 14083     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14084         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14085     ELSE
 14086         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14087
 14088     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14089     IF NO-CONVERSION-ERROR
 14090         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14091     ELSE
 14092         GO TO 3390-CONTINUE.
 14093
 14094     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14095         GO TO 3390-CONTINUE.
 14096
 14097     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14098     MOVE '4'                    TO CNTL-REC-TYPE.
 14099     MOVE +0                     TO CNTL-SEQ-NO.
 14100     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14101     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14102     MOVE 'BENE'                 TO FILE-SWITCH.
 14103
 14104     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14105
 14106     IF NO-BENEFIT-FOUND
 14107         GO TO 3390-CONTINUE.
 14108
 14109     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 14110        IF (PI-OFFLINE = 'Y') OR
 14111           (PI-PMTTYPE = '7')
 14112           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14113                                     THRU 9870-EXIT
 14114           IF ERROR-ON-OUTPUT
 14115             MOVE -1                 TO ENTERPFL
 14116             MOVE AL-UANON           TO ENTERPFA
 14117             MOVE MAP-NAMEA          TO MAP-NAME
 14118             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14119             GO TO 8200-SEND-DATAONLY.
 14120
 14121     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 14122        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14123        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14124          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14125          MOVE +0        TO DC-ELAPSED-DAYS
 14126          MOVE +1        TO DC-ELAPSED-MONTHS
 14127          MOVE 6         TO DC-OPTION-CODE
 14128          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14129          IF NO-CONVERSION-ERROR
 14130              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14131
 14132 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 269
* EL156.cbl
 14133
 14134      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14135         MOVE CM-AH-LOAN-EXPIRE-DT
 14136                                 TO DC-BIN-DATE-1
 14137      ELSE
 14138         MOVE CM-LF-LOAN-EXPIRE-DT
 14139                                 TO DC-BIN-DATE-1
 14140      END-IF
 14141
 14142      MOVE ' '                    TO DC-OPTION-CODE.
 14143      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14144      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14145      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14146
 14147 3499-EXIT.
 14148     EXIT.
 14149
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 270
* EL156.cbl
 14151
 14152 3600-CHECK-VERIFICATION.
 14153
 14154     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14155
 14156     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14157
 14158     IF PI-PAYEE-TYPE = 'I'
 14159        GO TO 3600-READ-TRAILER.
 14160
 14161     IF PI-PAYEE-TYPE = 'B'
 14162        ADD +10                  TO TRLR-SEQ-NO
 14163        GO TO 3600-READ-TRAILER.
 14164
 14165     IF PI-PAYEE-TYPE = 'A'
 14166        ADD +20                  TO TRLR-SEQ-NO
 14167        GO TO 3600-READ-TRAILER.
 14168
 14169     IF PI-PAYEE-TYPE = 'O'
 14170        ADD +50                  TO TRLR-SEQ-NO
 14171        GO TO 3600-READ-TRAILER.
 14172
 14173     IF PI-PAYEE-TYPE = 'Q'
 14174        ADD +60                  TO TRLR-SEQ-NO
 14175        GO TO 3600-READ-TRAILER.
 14176
 14177     IF PI-PAYEE-TYPE = 'P'
 14178        ADD +30                  TO TRLR-SEQ-NO
 14179        GO TO 3600-READ-TRAILER.
 14180
 14181     IF PI-PAYEE-TYPE = 'E'
 14182        ADD +40                  TO TRLR-SEQ-NO.
 14183
 14184 3600-READ-TRAILER.
 14185
 14186
 14187* EXEC CICS HANDLE CONDITION
 14188*         NOTFND(3600-CONTINUE)
 14189*    END-EXEC.
 14190*    MOVE '"$I                   ! - #00013408' TO DFHEIV0
 14191     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14193     MOVE X'2D20233030303133343038' TO DFHEIV0(25:11)
 14194     CALL 'kxdfhei1' USING DFHEIV0
 14195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14196
 14197
 14198     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14199
 14200 3600-CONTINUE.
 14201
 14202     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14203         GO TO 3600-AH-VERIFY
 14204     END-IF.
 14205
 14206     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14207       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14208         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 271
* EL156.cbl
 14209           MOVE ER-7576            TO EMI-ERROR
 14210           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14211           MOVE -1                 TO PAYEEL
 14212           MOVE AL-UABON           TO PAYEEA
 14213           GO TO 3600-EXIT
 14214         END-IF
 14215       END-IF
 14216     END-IF.
 14217
 14218     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14219     MOVE 1 TO WS-SUB2
 14220     MOVE SPACES TO WS-PAYEE-NAME
 14221     PERFORM VARYING WS-SUB FROM 1 BY 1
 14222             UNTIL WS-SUB > 30
 14223         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14224            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14225                 WS-PAYEE-NAME-X (WS-SUB2)
 14226            ADD +1 TO WS-SUB2
 14227         END-IF
 14228     END-PERFORM.
 14229
 14230     STRING CL-INSURED-1ST-NAME
 14231            CL-INSURED-MID-INIT
 14232            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14233     MOVE 1 TO WS-SUB2
 14234     MOVE SPACES TO WS-INSURED-NAME
 14235     PERFORM VARYING WS-SUB FROM 1 BY 1
 14236             UNTIL WS-SUB > 30
 14237         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14238            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14239                 WS-INSURED-NAME-X (WS-SUB2)
 14240            ADD +1 TO WS-SUB2
 14241         END-IF
 14242     END-PERFORM.
 14243
 14244     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14245        MOVE ER-7579            TO EMI-ERROR
 14246        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14247        MOVE -1                 TO PAYEEL
 14248        MOVE AL-UABON           TO PAYEEA
 14249     END-IF.
 14250
 14251     IF PI-PMTTYPE = '4'  AND
 14252        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14253        PI-PAYEE-TYPE <> 'I'
 14254          MOVE ER-7580          TO EMI-ERROR
 14255          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14256          MOVE -1               TO PAYEEL
 14257          MOVE AL-UABON         TO PAYEEA
 14258     END-IF.
 14259
 14260     GO TO 3600-EXIT.
 14261
 14262 3600-AH-VERIFY.
 14263
 14264     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14265        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14266           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 272
* EL156.cbl
 14267           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14268           MOVE -1                 TO PAYEEL
 14269           MOVE AL-UABON           TO PAYEEA
 14270        END-IF
 14271     END-IF.
 14272
 14273
 14274 3600-EXIT.
 14275     EXIT.
 14276
 14277 5000-UPDATE.
 14278
 14279     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14280
 14281     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14282
 14283     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14284        PI-OFFLINE = 'Y'
 14285        NEXT SENTENCE
 14286     ELSE
 14287        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14288
 14289*    IF PI-COMPANY-ID = 'CRI'
 14290*       IF PI-PMTTYPE = '1' OR  '2'
 14291*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14292*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14293*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14294
 14295*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14296*       IF PI-PMTTYPE = '1'
 14297*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14298*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14299
 14300     IF PI-PMTTYPE      = '2' AND
 14301        PI-SPLIT-PMT-SW = 'Y' AND
 14302        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14303          MOVE ER-3530                TO EMI-ERROR
 14304          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14305
 14306     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14307        AND (CL-CLAIM-TYPE = 'L')
 14308        IF PI-PMTTYPE = '2' OR '4'
 14309           IF PI-INT-AMT NOT = ZEROS
 14310              PERFORM 7110-BUILD-PMT-TRLR
 14311                                 THRU 7130-EXIT
 14312           ELSE
 14313              IF PI-PMTTYPE = '2'
 14314                 PERFORM 7140-BUILD-NOTE-TRLR
 14315                                 THRU 7170-EXIT
 14316              END-IF
 14317           END-IF
 14318        END-IF
 14319     END-IF
 14320*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14321*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14322*            MOVE 'N'                 TO  WS-LETTER-SW.
 14323
 14324*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 273
* EL156.cbl
 14325*        IF CL-NO-OF-PMTS-MADE = +1
 14326*                OR
 14327*           PI-PMTTYPE = '2'
 14328*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14329
 14330     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14331
 14332*    IF PI-COMPANY-ID = 'DMD'
 14333*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14334*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14335
 14336
 14337* EXEC CICS REWRITE
 14338*         DATASET('ELMSTR')
 14339*         FROM(CLAIM-MASTER)
 14340*     END-EXEC.
 14341     MOVE LENGTH OF
 14342      CLAIM-MASTER
 14343       TO DFHEIV11
 14344     MOVE 'ELMSTR' TO DFHEIV1
 14345*    MOVE '&& L                  %   #00013550' TO DFHEIV0
 14346     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14347     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14348     MOVE X'2020233030303133353530' TO DFHEIV0(25:11)
 14349     CALL 'kxdfhei1' USING DFHEIV0,
 14350           DFHEIV1,
 14351           CLAIM-MASTER,
 14352           DFHEIV11,
 14353           DFHEIV99
 14354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14355
 14356
 14357     IF WS-LETTER-SW = 'N'
 14358         GO TO 5000-END-UPDATE.
 14359
 14360 5000-GENERATE-AUTO-LETTER.
 14361
 14362
 14363* EXEC CICS LINK
 14364*        PROGRAM    (LINK-1523)
 14365*        COMMAREA   (W-1523-LINKDATA)
 14366*        LENGTH     (W-1523-COMM-LENGTH)
 14367*    END-EXEC.
 14368*    MOVE '."C                   (   #00013560' TO DFHEIV0
 14369     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14370     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14371     MOVE X'2020233030303133353630' TO DFHEIV0(25:11)
 14372     CALL 'kxdfhei1' USING DFHEIV0,
 14373           LINK-1523,
 14374           W-1523-LINKDATA,
 14375           W-1523-COMM-LENGTH,
 14376           DFHEIV99,
 14377           DFHEIV99,
 14378           DFHEIV99,
 14379           DFHEIV99
 14380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14381
 14382
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 274
* EL156.cbl
 14383     IF W-1523-FATAL-ERROR
 14384         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14385         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14386         MOVE ER-0802                TO  EMI-ERROR
 14387         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14388
 14389     IF W-1523-ERROR-CODE = 0191
 14390         MOVE ER-0803                TO  EMI-ERROR
 14391         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14392
 14393     IF PI-COMPANY-ID      = 'HAN' AND
 14394        PI-PMTTYPE         = '1'   AND
 14395        PI-3RD-PARTY-SW    = 'Y'   AND
 14396        W-1523-FORM-NUMBER = 'EOB1'
 14397           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14398           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14399           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14400           GO TO 5000-GENERATE-AUTO-LETTER.
 14401
 14402 5000-END-UPDATE.
 14403
 14404     MOVE ER-0000                TO EMI-ERROR.
 14405     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14406     GO TO 7000-SHOW-CLAIM.
 14407
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 275
* EL156.cbl
 14409 5000-MOVE-NAME.
 14410     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14411     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14412     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14413
 14414 5000-EXIT.
 14415     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 276
* EL156.cbl
 14417 5300-CREATE-DMO.
 14418
 14419     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14420     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14421     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14422
 14423
 14424* EXEC CICS HANDLE CONDITION
 14425*         NOTFND   (5300-NOTE-NOT-FOUND)
 14426*    END-EXEC.
 14427*    MOVE '"$I                   ! . #00013606' TO DFHEIV0
 14428     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14430     MOVE X'2E20233030303133363036' TO DFHEIV0(25:11)
 14431     CALL 'kxdfhei1' USING DFHEIV0
 14432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14433
 14434
 14435
 14436* EXEC CICS READ
 14437*         DATASET('ERNOTE')
 14438*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14439*         RIDFLD (W-NOTE-KEY)
 14440*    END-EXEC.
 14441     MOVE 'ERNOTE' TO DFHEIV1
 14442*    MOVE '&"S        E          (   #00013610' TO DFHEIV0
 14443     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14444     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14445     MOVE X'2020233030303133363130' TO DFHEIV0(25:11)
 14446     CALL 'kxdfhei1' USING DFHEIV0,
 14447           DFHEIV1,
 14448           DFHEIV20,
 14449           DFHEIV99,
 14450           W-NOTE-KEY,
 14451           DFHEIV99,
 14452           DFHEIV99,
 14453           DFHEIV99
 14454     SET ADDRESS OF CERTIFICATE-NOTE TO
 14455         DFHEIV20
 14456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14457
 14458
 14459     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14460     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14461     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14462
 14463     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14464         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14465     ELSE
 14466         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14467
 14468     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14469     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14470     MOVE 'DLO006'               TO PGM-NAME.
 14471
 14472
 14473* EXEC CICS LINK
 14474*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 277
* EL156.cbl
 14475*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14476*        LENGTH     (DCT-RCRD-LENGTH)
 14477*    END-EXEC.
 14478*    MOVE '."C                   (   #00013629' TO DFHEIV0
 14479     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14480     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14481     MOVE X'2020233030303133363239' TO DFHEIV0(25:11)
 14482     CALL 'kxdfhei1' USING DFHEIV0,
 14483           PGM-NAME,
 14484           DCT-COMMUNICATION-AREA,
 14485           DCT-RCRD-LENGTH,
 14486           DFHEIV99,
 14487           DFHEIV99,
 14488           DFHEIV99,
 14489           DFHEIV99
 14490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14491
 14492
 14493     IF DCT-RETURN-CODE = 'OK'
 14494         GO TO 5300-CONT.
 14495
 14496     IF DCT-RETURN-CODE = '01' OR '02'
 14497         GO TO 5300-EXIT.
 14498
 14499     IF DCT-RETURN-CODE = '03'
 14500         MOVE ER-0951            TO EMI-ERROR
 14501         GO TO 5300-BAD-EXIT.
 14502
 14503     IF DCT-RETURN-CODE = '04'
 14504         MOVE ER-0946            TO EMI-ERROR
 14505         GO TO 5300-BAD-EXIT.
 14506
 14507     IF DCT-RETURN-CODE = '05'
 14508         MOVE ER-0947            TO EMI-ERROR
 14509         GO TO 5300-BAD-EXIT.
 14510
 14511     IF DCT-RETURN-CODE = '06'
 14512         MOVE ER-0921            TO EMI-ERROR
 14513         GO TO 5300-BAD-EXIT.
 14514
 14515     IF DCT-RETURN-CODE = '07'
 14516         MOVE ER-0849            TO EMI-ERROR
 14517         GO TO 5300-BAD-EXIT.
 14518
 14519     IF DCT-RETURN-CODE = '08'
 14520         MOVE ER-0948            TO EMI-ERROR
 14521         GO TO 5300-BAD-EXIT.
 14522
 14523     IF DCT-RETURN-CODE = 'N1'
 14524         MOVE ER-0950            TO EMI-ERROR
 14525         GO TO 5300-BAD-EXIT.
 14526
 14527     IF DCT-RETURN-CODE = 'E1'
 14528         MOVE ER-0974            TO EMI-ERROR
 14529         GO TO 5300-BAD-EXIT.
 14530
 14531     IF DCT-RETURN-CODE = 'E2'
 14532         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 278
* EL156.cbl
 14533         GO TO 5300-BAD-EXIT.
 14534
 14535     IF DCT-RETURN-CODE NOT = 'OK'
 14536         MOVE ER-0949            TO EMI-ERROR
 14537         GO TO 5300-BAD-EXIT.
 14538
 14539 5300-CONT.
 14540
 14541     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14542     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14543     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14544     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14545     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14546     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14547     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14548     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14549
 14550     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14551     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14552     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14553     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14554     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14555
 14556     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14557
 14558     IF PI-PMTTYPE = '2'
 14559         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14560         MOVE '4'                TO DM-CLAIM-STATUS
 14561     ELSE
 14562         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14563         MOVE '2'                TO DM-CLAIM-STATUS.
 14564
 14565     MOVE 'DLO025'               TO PGM-NAME.
 14566
 14567
 14568* EXEC CICS LINK
 14569*        PROGRAM    (PGM-NAME)
 14570*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14571*        LENGTH     (DM-DMO-LENGTH)
 14572*    END-EXEC.
 14573*    MOVE '."C                   (   #00013709' TO DFHEIV0
 14574     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14575     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14576     MOVE X'2020233030303133373039' TO DFHEIV0(25:11)
 14577     CALL 'kxdfhei1' USING DFHEIV0,
 14578           PGM-NAME,
 14579           DMO-COMMUNICATION-AREA,
 14580           DM-DMO-LENGTH,
 14581           DFHEIV99,
 14582           DFHEIV99,
 14583           DFHEIV99,
 14584           DFHEIV99
 14585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14586
 14587
 14588     IF DM-RETURN-CODE = 'OK'
 14589         GO TO 5300-EXIT.
 14590
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 279
* EL156.cbl
 14591     IF DM-RETURN-CODE = '01'
 14592         MOVE ER-8051            TO EMI-ERROR
 14593         GO TO 5300-BAD-EXIT.
 14594
 14595     IF DM-RETURN-CODE = '02'
 14596         MOVE ER-8052            TO EMI-ERROR
 14597         GO TO 5300-BAD-EXIT.
 14598
 14599     IF DM-RETURN-CODE = '03'
 14600         MOVE ER-8053            TO EMI-ERROR
 14601         GO TO 5300-BAD-EXIT.
 14602
 14603     IF DM-RETURN-CODE = '04'
 14604         MOVE ER-8054            TO EMI-ERROR
 14605         GO TO 5300-BAD-EXIT.
 14606
 14607     IF DM-RETURN-CODE = '05'
 14608         MOVE ER-8055            TO EMI-ERROR
 14609         GO TO 5300-BAD-EXIT.
 14610
 14611     IF DM-RETURN-CODE = '06'
 14612         MOVE ER-8056            TO EMI-ERROR
 14613         GO TO 5300-BAD-EXIT.
 14614
 14615     IF DM-RETURN-CODE = '07'
 14616         MOVE ER-8057            TO EMI-ERROR
 14617         GO TO 5300-BAD-EXIT.
 14618
 14619     IF DM-RETURN-CODE = '08'
 14620         MOVE ER-8058            TO EMI-ERROR
 14621         GO TO 5300-BAD-EXIT.
 14622
 14623     IF DM-RETURN-CODE = '09'
 14624         MOVE ER-8059            TO EMI-ERROR
 14625         GO TO 5300-BAD-EXIT.
 14626
 14627     IF DM-RETURN-CODE = '10'
 14628         MOVE ER-8060            TO EMI-ERROR
 14629         GO TO 5300-BAD-EXIT.
 14630
 14631     IF DM-RETURN-CODE = '11'
 14632         MOVE ER-8061            TO EMI-ERROR
 14633         GO TO 5300-BAD-EXIT.
 14634
 14635     IF DM-RETURN-CODE = '12'
 14636         MOVE ER-8062            TO EMI-ERROR
 14637         GO TO 5300-BAD-EXIT.
 14638
 14639     IF DM-RETURN-CODE = '13'
 14640         MOVE ER-8063            TO EMI-ERROR
 14641         GO TO 5300-BAD-EXIT.
 14642
 14643     IF DM-RETURN-CODE = '14'
 14644         MOVE ER-8064            TO EMI-ERROR
 14645         GO TO 5300-BAD-EXIT.
 14646
 14647     IF DM-RETURN-CODE = '15'
 14648         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 280
* EL156.cbl
 14649         GO TO 5300-BAD-EXIT.
 14650
 14651     IF DM-RETURN-CODE = '16'
 14652         MOVE ER-8154            TO EMI-ERROR
 14653         GO TO 5300-BAD-EXIT.
 14654
 14655     IF DM-RETURN-CODE = '17'
 14656         MOVE ER-8155            TO EMI-ERROR
 14657         GO TO 5300-BAD-EXIT.
 14658
 14659     IF DM-RETURN-CODE = 'N1'
 14660         MOVE ER-8152            TO EMI-ERROR
 14661         GO TO 5300-BAD-EXIT.
 14662
 14663     IF DM-RETURN-CODE = 'E1'
 14664         MOVE ER-8153            TO EMI-ERROR
 14665         GO TO 5300-BAD-EXIT.
 14666
 14667     MOVE ER-8066            TO EMI-ERROR.
 14668     GO TO 5300-BAD-EXIT.
 14669
 14670 5300-NOTE-NOT-FOUND.
 14671
 14672     MOVE ER-0954                TO EMI-ERROR.
 14673     GO TO 5300-BAD-EXIT.
 14674
 14675 5300-BAD-EXIT.
 14676
 14677* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14678*    MOVE '6"R                   !   #00013803' TO DFHEIV0
 14679     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14680     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14681     MOVE X'2020233030303133383033' TO DFHEIV0(25:11)
 14682     CALL 'kxdfhei1' USING DFHEIV0
 14683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14684
 14685     IF MAP-NAME = 'EL156A'
 14686         MOVE -1             TO ENTERPFL
 14687       ELSE
 14688         MOVE LOW-VALUES     TO EL156BI
 14689         MOVE -1             TO ENTPFBL.
 14690
 14691     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14692     GO TO 8200-SEND-DATAONLY.
 14693
 14694 5300-EXIT.
 14695     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 281
* EL156.cbl
 14697 5350-FORMAT-LAST-NAME-1ST.
 14698*****************************************************************
 14699*             M O V E   N A M E   R O U T I N E                 *
 14700*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14701*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14702*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14703*                  FIELD                   VALUE                *
 14704*           W-NAME-LAST    (CL15)      SMITH                    *
 14705*           W-NAME-FIRST   (CL15)      JOHN                     *
 14706*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14707*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14708*     CONTAIN                                                   *
 14709*                SMITH, JOHN ALLEN                              *
 14710*     OR                                                        *
 14711*                SMITH, JOHN A.                                 *
 14712*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14713*     COPYBOOK, ELCNWA.                                         *
 14714*****************************************************************.
 14715
 14716     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14717     MOVE ZERO                   TO  WS-NAME-SW.
 14718     SET NWA-INDEX               TO +1.
 14719
 14720     IF W-NAME-LAST   = SPACES AND
 14721        W-NAME-MIDDLE = SPACES
 14722         MOVE +1                 TO WS-NAME-SW.
 14723
 14724     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14725     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14726
 14727     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14728     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14729
 14730     SET NWA-INDEX UP BY +1.
 14731
 14732     IF W-NAME-MIDDLE NOT = SPACES
 14733         IF W-NAME-MIDDLE-2 = SPACES
 14734             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14735             SET NWA-INDEX UP BY +1
 14736             MOVE '.'            TO WS-NW (NWA-INDEX)
 14737             SET NWA-INDEX UP BY +2
 14738         ELSE
 14739             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14740             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14741
 14742 5350-EXIT.
 14743     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 282
* EL156.cbl
 14745 5360-MOVE-NAME.
 14746
 14747     IF WS-NAME-SW > +1
 14748         GO TO 5360-EXIT.
 14749
 14750     IF WS-NAME-WORK2 = SPACES
 14751         GO TO 5360-EXIT.
 14752
 14753     SET NWA-INDEX2            TO +1.
 14754     SET NWA-INDEX3            TO +2.
 14755
 14756 5360-MOVE-NAME-CYCLE.
 14757
 14758     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14759
 14760     IF NWA-INDEX < +30
 14761         SET NWA-INDEX UP BY +1
 14762     ELSE
 14763         ADD +2                TO  WS-NAME-SW
 14764         GO TO 5360-EXIT.
 14765
 14766     IF NWA-INDEX2 < +20
 14767         SET NWA-INDEX3 UP BY +1
 14768         SET NWA-INDEX2 UP BY +1.
 14769
 14770     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14771        WS-NW2 (NWA-INDEX3) = SPACES
 14772         IF WS-NAME-SW = ZERO
 14773             MOVE ','            TO  WS-NW (NWA-INDEX)
 14774             SET NWA-INDEX UP BY +2
 14775             MOVE +1             TO  WS-NAME-SW
 14776             GO TO 5360-EXIT
 14777         ELSE
 14778             GO TO 5360-EXIT.
 14779
 14780     GO TO 5360-MOVE-NAME-CYCLE.
 14781
 14782 5360-EXIT.
 14783     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 283
* EL156.cbl
 14785 6000-BUILD-SCREEN-B.
 14786     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14787     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14788     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14789     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14790
 14791     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14792
 14793 6050-BUILD-SCREEN.
 14794     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14795     MOVE LOW-VALUES             TO EL156BI.
 14796     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14797
 14798     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14799
 14800     IF PI-PAYEE-TYPE = 'I'
 14801        GO TO 6060-READ-TRAILER.
 14802
 14803     IF PI-PAYEE-TYPE = 'B'
 14804        ADD +10                  TO TRLR-SEQ-NO
 14805        GO TO 6060-READ-TRAILER.
 14806
 14807     IF PI-PAYEE-TYPE = 'A'
 14808        ADD +20                  TO TRLR-SEQ-NO
 14809        GO TO 6060-READ-TRAILER.
 14810
 14811     IF PI-PAYEE-TYPE = 'O'
 14812        ADD +50                  TO TRLR-SEQ-NO
 14813        GO TO 6060-READ-TRAILER.
 14814
 14815     IF PI-PAYEE-TYPE = 'Q'
 14816        ADD +60                  TO TRLR-SEQ-NO
 14817        GO TO 6060-READ-TRAILER.
 14818
 14819     IF PI-PAYEE-TYPE = 'P'
 14820        ADD +30                  TO TRLR-SEQ-NO
 14821        GO TO 6060-READ-TRAILER.
 14822
 14823     IF PI-PAYEE-TYPE = 'E'
 14824        ADD +40                  TO TRLR-SEQ-NO.
 14825
 14826 6060-READ-TRAILER.
 14827
 14828     IF PI-PAYEE-TYPE    = 'A' AND
 14829        PI-PAYEE-SEQ-NUM = 0
 14830          GO TO 6061-READ-ACCOUNT.
 14831
 14832     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14833        (PI-PAYEE-TYPE    = 'B')             AND
 14834        (PI-PAYEE-SEQ-NUM = 9)
 14835          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14836          IF BENE-FOUND-SW = 'N'
 14837            GO TO 6065-NOT-FOUND
 14838          ELSE
 14839            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14840            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14841            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14842*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 284
* EL156.cbl
 14843            STRING BE-CITY ' ' BE-STATE
 14844               DELIMITED BY '  ' INTO CITYSTBO
 14845            END-STRING
 14846            MOVE BE-ZIP-CODE       TO ZIPBO
 14847            GO TO 6061-READ-ACCOUNT.
 14848
 14849     IF PI-PAYEE-TYPE    = 'B' AND
 14850        PI-PAYEE-SEQ-NUM = 0
 14851          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14852          IF BENE-FOUND-SW = 'N'
 14853            GO TO 6065-NOT-FOUND
 14854          ELSE
 14855            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14856            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14857            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14858*           MOVE BE-CITY-STATE     TO CITYSTBO
 14859            STRING BE-CITY ' ' BE-STATE
 14860               DELIMITED BY '  ' INTO CITYSTBO
 14861            END-STRING
 14862            MOVE BE-ZIP-CODE       TO ZIPBO
 14863            GO TO 6061-READ-ACCOUNT.
 14864
 14865
 14866* EXEC CICS HANDLE CONDITION
 14867*         NOTFND(6065-NOT-FOUND)
 14868*     END-EXEC.
 14869*    MOVE '"$I                   ! / #00013984' TO DFHEIV0
 14870     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14871     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14872     MOVE X'2F20233030303133393834' TO DFHEIV0(25:11)
 14873     CALL 'kxdfhei1' USING DFHEIV0
 14874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14875
 14876
 14877     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14878
 14879     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14880     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 14881     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 14882     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 14883*    MOVE AT-CITY-STATE          TO CITYSTBO.
 14884     STRING AT-CITY ' ' AT-STATE
 14885        DELIMITED BY '  ' INTO CITYSTBO
 14886     END-STRING
 14887     MOVE AT-ZIP-CODE            TO ZIPBO.
 14888
 14889 6061-READ-ACCOUNT.
 14890
 14891* EXEC CICS HANDLE CONDITION
 14892*         NOTFND(6068-ACCT-NOT-FND)
 14893*     END-EXEC.
 14894*    MOVE '"$I                   ! 0 #00014001' TO DFHEIV0
 14895     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14896     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14897     MOVE X'3020233030303134303031' TO DFHEIV0(25:11)
 14898     CALL 'kxdfhei1' USING DFHEIV0
 14899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14900
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 285
* EL156.cbl
 14901
 14902
 14903* EXEC CICS READ
 14904*         DATASET('ERACCT')
 14905*         SET    (ADDRESS OF ACCOUNT-MASTER)
 14906*         RIDFLD (PI-ACCT-KEY)
 14907*     END-EXEC.
 14908     MOVE 'ERACCT' TO DFHEIV1
 14909*    MOVE '&"S        E          (   #00014005' TO DFHEIV0
 14910     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14911     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14912     MOVE X'2020233030303134303035' TO DFHEIV0(25:11)
 14913     CALL 'kxdfhei1' USING DFHEIV0,
 14914           DFHEIV1,
 14915           DFHEIV20,
 14916           DFHEIV99,
 14917           PI-ACCT-KEY,
 14918           DFHEIV99,
 14919           DFHEIV99,
 14920           DFHEIV99
 14921     SET ADDRESS OF ACCOUNT-MASTER TO
 14922         DFHEIV20
 14923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14924
 14925
 14926     MOVE AM-CARRIER             TO ACARRBO.
 14927     MOVE AM-GROUPING            TO GROUPBO.
 14928     MOVE AM-STATE               TO STATEBO.
 14929     MOVE AM-ACCOUNT             TO ACCTBO.
 14930     MOVE AM-NAME                TO ACCTNMBO.
 14931
 14932     IF PI-PAYEE-TYPE = 'A' AND
 14933        PI-PAYEE-SEQ-NUM = 0
 14934          MOVE AM-NAME             TO NAMEBO
 14935                                      PI-PAYEE-NAME
 14936          MOVE AM-ADDRS            TO ADDR1BO
 14937          MOVE SPACES              TO ADDR2BO
 14938*         MOVE AM-CITY             TO CITYSTBO
 14939          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 14940             DELIMITED BY '  ' INTO CITYSTBO
 14941          END-STRING
 14942          MOVE AM-ZIP-PRIME        TO WS-ZIP
 14943          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 14944          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 14945          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 14946
 14947     IF CITYSTBO EQUAL SPACES
 14948         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14949         GO TO 6070-FORMAT-DATA
 14950     END-IF.
 14951
 14952     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 14953     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 14954     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 14955     PERFORM VARYING WS-SUB FROM 30 BY -1
 14956          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 14957        IF WS-END-SUB = 0  AND
 14958           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 286
* EL156.cbl
 14959              OR LOW-VALUES  OR '.')
 14960            CONTINUE
 14961        ELSE
 14962            IF WS-END-SUB = 0
 14963                MOVE WS-SUB TO WS-END-SUB
 14964            ELSE
 14965                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 14966                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 14967                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14968                END-IF
 14969            END-IF
 14970        END-IF
 14971        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 14972            COMPUTE WS-BEG-SUB = WS-SUB + 1
 14973            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14974        END-IF
 14975     END-PERFORM.
 14976
 14977     IF WS-BEG-SUB > 0
 14978         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 14979         IF WS-STATE-LENGTH = 2
 14980             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 14981                  TO PI-CHECK-STATE-FOR-AK
 14982         ELSE
 14983             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 14984                'ALASKA'
 14985                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 14986             ELSE
 14987                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14988             END-IF
 14989         END-IF
 14990     ELSE
 14991         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14992     END-IF.
 14993
 14994     GO TO 6070-FORMAT-DATA.
 14995
 14996 6065-NOT-FOUND.
 14997     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 14998     GO TO 6061-READ-ACCOUNT.
 14999
 15000 6068-ACCT-NOT-FND.
 15001     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15002
 15003 6070-FORMAT-DATA.
 15004     IF PI-HOLDTIL = ZEROS
 15005        MOVE SAVE-DATE           TO PAYDTBI
 15006       ELSE
 15007        MOVE PI-HOLDTIL          TO PAYDTBO
 15008        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 15009
 15010     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15011     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15012
 15013     IF EIBAID = DFHPF3 OR DFHPF4
 15014        NEXT SENTENCE
 15015     ELSE
 15016       GO TO 6071-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 287
* EL156.cbl
 15017
 15018     MOVE PI-EPYFROM          TO PYFROMBO.
 15019     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15020
 15021     IF NOT PI-USES-PAID-TO
 15022        MOVE PI-EPYTHRU          TO PYTHRUBO
 15023        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15024     ELSE
 15025        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15026        MOVE '4'              TO DC-OPTION-CODE
 15027        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15028        IF NO-CONVERSION-ERROR
 15029           MOVE +1            TO DC-ELAPSED-DAYS
 15030           MOVE +0            TO DC-ELAPSED-MONTHS
 15031           MOVE '6'           TO DC-OPTION-CODE
 15032           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15033           IF NO-CONVERSION-ERROR
 15034              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15035
 15036     MOVE PI-EDAYS            TO DAYSBO.
 15037     MOVE PI-EPYAMT           TO PAYAMTBO.
 15038     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15039        IF PI-INT-AMT > ZEROS
 15040           MOVE PI-INT-AMT       TO INTAMTBO
 15041        END-IF
 15042     END-IF
 15043     GO TO 6072-SET-TYPE.
 15044
 15045 6071-CONTINUE.
 15046
 15047     IF PI-CPYFROM NOT = LOW-VALUES
 15048        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15049        MOVE SPACES              TO DC-OPTION-CODE
 15050        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15051        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15052
 15053     IF PI-CPYTHRU NOT = LOW-VALUES
 15054        IF NOT PI-USES-PAID-TO
 15055           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15056           MOVE SPACES             TO DC-OPTION-CODE
 15057           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15058           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15059        ELSE
 15060           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15061           MOVE '6'                TO DC-OPTION-CODE
 15062           MOVE +1                 TO DC-ELAPSED-DAYS
 15063           MOVE +0                 TO DC-ELAPSED-MONTHS
 15064           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15065           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15066
 15067     MOVE PI-CDAYS               TO DAYSBO.
 15068     MOVE PI-CPYAMT              TO PAYAMTBO.
 15069     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15070        IF PI-INT-AMT > ZEROS
 15071           MOVE PI-INT-AMT       TO INTAMTBO
 15072        END-IF
 15073     END-IF
 15074     .
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 288
* EL156.cbl
 15075 6072-SET-TYPE.
 15076     IF PI-PMTTYPE = '1'
 15077        MOVE 'PARTIAL'           TO PAYTYPBO.
 15078
 15079     IF PI-PMTTYPE = '2'
 15080        MOVE 'FINAL'             TO PAYTYPBO.
 15081
 15082     IF PI-PMTTYPE = '3'
 15083        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15084
 15085     IF PI-PMTTYPE = '4'
 15086        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15087
 15088     IF PI-PMTTYPE = '5'
 15089        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15090
 15091     IF PI-PMTTYPE = '6'
 15092        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15093
 15094     IF PI-PROV-PMT
 15095        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15096
 15097     IF PI-ECHECKNO NOT = SPACES
 15098        MOVE PI-ECHECKNO         TO CKNUMBO
 15099     ELSE
 15100        MOVE PI-CCHECKNO         TO CKNUMBO.
 15101
 15102     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 15103        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15104        MOVE +91                 TO  TRLR-SEQ-NO
 15105
 15106* EXEC CICS READ
 15107*           DATASET  ('ELTRLR')
 15108*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15109*           RIDFLD   (ELTRLR-KEY)
 15110*           RESP     (WS-RESPONSE)
 15111*       END-EXEC
 15112     MOVE 'ELTRLR' TO DFHEIV1
 15113*    MOVE '&"S        E          (  N#00014190' TO DFHEIV0
 15114     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15115     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15116     MOVE X'204E233030303134313930' TO DFHEIV0(25:11)
 15117     CALL 'kxdfhei1' USING DFHEIV0,
 15118           DFHEIV1,
 15119           DFHEIV20,
 15120           DFHEIV99,
 15121           ELTRLR-KEY,
 15122           DFHEIV99,
 15123           DFHEIV99,
 15124           DFHEIV99
 15125     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15126         DFHEIV20
 15127     MOVE EIBRESP  TO WS-RESPONSE
 15128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15129
 15130        IF WS-RESP-NORMAL
 15131           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15132        ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 289
* EL156.cbl
 15133           MOVE SPACES           TO  LOANNBO
 15134        END-IF
 15135     END-IF
 15136
 15137*       MOVE PI-LOAN-NO          TO LOANNBO
 15138
 15139     IF CKNUMBO = SPACES
 15140         MOVE SPACES             TO CKNUMHDO.
 15141
 15142     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15143     MOVE CL-CARRIER             TO CARRBO.
 15144     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15145     MOVE CL-CERT-SFX            TO SUFXBO.
 15146
 15147     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15148        EVALUATE CL-CLAIM-TYPE
 15149           WHEN 'I'
 15150              MOVE '  IU  '      TO CLMTYPBO
 15151           WHEN 'G'
 15152              MOVE ' GAP  '      TO CLMTYPBO
 15153           WHEN 'F'
 15154              MOVE ' FMLA '      TO CLMTYPBO
 15155           WHEN OTHER
 15156              MOVE PI-AH-OVERRIDE-L6
 15157                                 TO CLMTYPBO
 15158        END-EVALUATE
 15159        MOVE ZEROS               TO UNDISBO
 15160*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15161        IF PI-PMTTYPE = '5' OR '6'
 15162           GO TO 6073-GET-NOTIFY-DATA
 15163        ELSE
 15164           MOVE PI-DAILY-RATE    TO RATEBO
 15165           GO TO 6073-GET-NOTIFY-DATA.
 15166
 15167     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15168
 15169     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15170        MOVE ZEROS               TO UNDISBO
 15171     ELSE
 15172        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15173
 15174 6073-GET-NOTIFY-DATA.
 15175
 15176     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15177
 15178     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15179         MOVE SPACES             TO  NAMEB2O
 15180                                     ADDR1B2O
 15181                                     ADDR2B2O
 15182                                     CITYST2O
 15183                                     AGTHDGO
 15184         MOVE ZEROS              TO  ZIPB2O
 15185         GO TO 6080-SET-INCURRED.
 15186
 15187     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15188     MOVE +29                    TO  TRLR-SEQ-NO.
 15189
 15190
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 290
* EL156.cbl
 15191* EXEC CICS HANDLE CONDITION
 15192*        NOTFND   (6074-GET-COMP-DATA)
 15193*    END-EXEC.
 15194*    MOVE '"$I                   ! 1 #00014257' TO DFHEIV0
 15195     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15197     MOVE X'3120233030303134323537' TO DFHEIV0(25:11)
 15198     CALL 'kxdfhei1' USING DFHEIV0
 15199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15200
 15201
 15202     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15203
 15204     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15205     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15206     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15207*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15208     STRING AT-CITY ' ' AT-STATE
 15209        DELIMITED BY '  ' INTO CITYST2O
 15210     END-STRING
 15211     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15212     GO TO 6080-SET-INCURRED.
 15213
 15214 6074-GET-COMP-DATA.
 15215
 15216     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15217         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15218
 15219     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15220         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15221                                         ADDR1B2O
 15222                                         ADDR2B2O
 15223                                         CITYST2O
 15224         MOVE ZEROS                  TO  ZIPB2O
 15225         GO TO 6080-SET-INCURRED.
 15226
 15227     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15228     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15229     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15230     MOVE AM-GROUPING            TO  COMP-GROUP.
 15231     MOVE 'A'                    TO  COMP-TYPE.
 15232     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15233                                 TO  COMP-FIN-RESP.
 15234
 15235     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15236         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15237                                       'G' OR 'B' or 'S'
 15238             MOVE 'G'            TO  COMP-TYPE
 15239             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15240         ELSE
 15241             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15242                                 TO  COMP-ACCOUNT
 15243     ELSE
 15244         MOVE 'G'                TO  COMP-TYPE
 15245         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15246
 15247     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15248
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 291
* EL156.cbl
 15249     IF COMP-REC-FOUND
 15250         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15251         MOVE CO-ADDR-1          TO  ADDR1B2O
 15252         MOVE CO-ADDR-2          TO  ADDR2B2O
 15253*        MOVE CO-ADDR-3          TO  CITYST2O
 15254         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15255            DELIMITED BY '  ' INTO CITYST2O
 15256         END-STRING
 15257         MOVE CO-ZIP             TO  ZIPB2O
 15258     ELSE
 15259         MOVE 'NO COMP ADDRESS AVAILABLE'
 15260                                 TO  NAMEB2O
 15261                                     ADDR1B2O
 15262                                     ADDR2B2O
 15263                                     CITYST2O
 15264         MOVE ZEROS               TO ZIPB2O.
 15265
 15266 6080-SET-INCURRED.
 15267     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15268     MOVE SPACES                 TO DC-OPTION-CODE.
 15269     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15270     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15271     MOVE PI-PROCESSOR-ID        TO BYBO.
 15272     MOVE MAP-NAMEB              TO MAP-NAME.
 15273     MOVE 'C'                    TO PI-PASS-SW.
 15274     MOVE EIBAID                 TO PI-PFKEY-USED.
 15275     MOVE -1                     TO ENTPFBL.
 15276     GO TO 8100-SEND-INITIAL-MAP.
 15277
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 292
* EL156.cbl
 15279 6100-BUILD-PAYMENT-TRAILER.
 15280
 15281     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 15282       (PI-COMPANY-ID = 'CID' OR 'AHL')
 15283         GO TO 6105-STATE-CHECK-NUMBER
 15284     END-IF.
 15285
 15286     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15287     MOVE '6'                    TO CNTL-REC-TYPE.
 15288
 15289     IF CONTROL-IS-ACTUAL-CARRIER
 15290         MOVE PI-CARRIER         TO WS-CARR
 15291     ELSE
 15292         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15293
 15294     IF PI-COMPANY-ID = 'FIA'
 15295         MOVE PI-CARRIER         TO  WS-CARR.
 15296
 15297     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15298     MOVE 0                      TO CNTL-SEQ-NO.
 15299     MOVE 'CARR'                 TO FILE-SWITCH.
 15300
 15301     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15302
 15303     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15304         IF PI-OFFLINE     = 'Y' AND
 15305            PI-ECHECKNO-CR = 'CR'
 15306              GO TO 6110-READ-CONTROL
 15307         ELSE
 15308            IF PI-CASH = 'N'
 15309                GO TO 6110-READ-CONTROL.
 15310
 15311     IF CHECK-NO-MANUAL    OR
 15312        CHECK-NO-AT-PRINT  OR
 15313        PI-OFFLINE = 'Y'
 15314          GO TO 6130-BUILD-TRAILER.
 15315
 15316     IF PI-COMPANY-ID = 'FIA'
 15317         NEXT SENTENCE
 15318     ELSE
 15319         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15320             GO TO 6110-READ-CONTROL.
 15321
 15322     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15323
 15324     IF CHECK-CNT-RESET-VALUE
 15325        MOVE +1                  TO CF-CHECK-COUNTER
 15326     ELSE
 15327        ADD +1                   TO CF-CHECK-COUNTER.
 15328
 15329     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15330
 15331     IF CHECK-NO-CARR-SEQ
 15332        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15333
 15334     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15335
 15336     MOVE 'N' TO PI-REAUDIT-NEEDED.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 293
* EL156.cbl
 15337     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15338        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15339         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15340         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15341            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15342         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 15343                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15344     END-IF.
 15345
 15346     GO TO 6120-REWRITE.
 15347
 15348 6105-STATE-CHECK-NUMBER.
 15349     IF CHECK-NO-MANUAL    OR
 15350        CHECK-NO-AT-PRINT  OR
 15351        PI-OFFLINE = 'Y'
 15352           GO TO 6130-BUILD-TRAILER
 15353     END-IF.
 15354
 15355     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15356     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15357     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15358     MOVE '3'                TO CNTL-REC-TYPE.
 15359     MOVE +0                 TO CNTL-SEQ-NO.
 15360     MOVE 'STAT'             TO FILE-SWITCH.
 15361     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15362
 15363     IF CF-ST-CHECK-CNT-RESET
 15364         MOVE +1             TO CF-ST-CHECK-COUNTER
 15365     ELSE
 15366         ADD +1              TO CF-ST-CHECK-COUNTER
 15367     END-IF.
 15368
 15369     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15370     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15371     GO TO 6120-REWRITE.
 15372
 15373 6110-READ-CONTROL.
 15374     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15375     MOVE '1'                    TO CNTL-REC-TYPE.
 15376     MOVE SPACES                 TO CNTL-ACCESS.
 15377     MOVE 0                      TO CNTL-SEQ-NO.
 15378
 15379     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15380
 15381     IF CO-CHECK-COUNT-RESET
 15382        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15383     ELSE
 15384        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15385
 15386     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15387
 15388     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15389         IF PI-OFFLINE     = 'Y'  AND
 15390            PI-ECHECKNO-CR = 'CR'
 15391              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15392              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15393              MOVE AL-UANON           TO CHECKNOA
 15394              GO TO 6120-REWRITE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 294
* EL156.cbl
 15395         ELSE
 15396         IF PI-CASH = 'N'
 15397             MOVE 'N'                TO PI-ECHECKNO-N
 15398             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15399             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15400             MOVE AL-UANON           TO CHECKNOA
 15401             GO TO 6120-REWRITE.
 15402
 15403     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15404
 15405 6120-REWRITE.
 15406
 15407* EXEC CICS REWRITE
 15408*         DATASET('ELCNTL')
 15409*         FROM(CONTROL-FILE)
 15410*     END-EXEC.
 15411     MOVE LENGTH OF
 15412      CONTROL-FILE
 15413       TO DFHEIV11
 15414     MOVE 'ELCNTL' TO DFHEIV1
 15415*    MOVE '&& L                  %   #00014465' TO DFHEIV0
 15416     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15417     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15418     MOVE X'2020233030303134343635' TO DFHEIV0(25:11)
 15419     CALL 'kxdfhei1' USING DFHEIV0,
 15420           DFHEIV1,
 15421           CONTROL-FILE,
 15422           DFHEIV11,
 15423           DFHEIV99
 15424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15425
 15426
 15427     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15428
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 295
* EL156.cbl
 15430 6130-BUILD-TRAILER.
 15431
 15432
 15433* EXEC CICS GETMAIN
 15434*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15435*         LENGTH    (200)
 15436*         INITIMG   (GETMAIN-SPACE)
 15437*     END-EXEC.
 15438     MOVE 200
 15439       TO DFHEIV11
 15440*    MOVE ',"IL                  $   #00014475' TO DFHEIV0
 15441     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15442     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15443     MOVE X'2020233030303134343735' TO DFHEIV0(25:11)
 15444     CALL 'kxdfhei1' USING DFHEIV0,
 15445           DFHEIV20,
 15446           DFHEIV11,
 15447           GETMAIN-SPACE
 15448     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15449         DFHEIV20
 15450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15451
 15452
 15453     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15454                                    AT-PREV-PAID-THRU-DT.
 15455     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15456     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15457     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15458     MOVE 'AT'                   TO AT-RECORD-ID.
 15459     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15460
 15461     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15462        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15463           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15464     ELSE
 15465           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15466           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15467
 15468     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15469         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15470             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15471             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15472           ELSE
 15473             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15474             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15475
 15476     MOVE '2'                    TO AT-TRAILER-TYPE.
 15477     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15478                                    AT-PAYMENT-LAST-MAINT-DT.
 15479     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15480                                    AT-PAYMENT-LAST-UPDATED-BY.
 15481     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15482     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15483     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15484     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15485
 15486     IF PI-PMT-APPROVED
 15487        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 296
* EL156.cbl
 15488           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15489
 15490     IF PI-PFKEY-USED = DFHPF5
 15491        GO TO 6140-PF5-ENTERED.
 15492
 15493     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15494     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15495
 15496     IF PI-AIG-SPECIAL-BENEFIT
 15497         IF WS-1ST-SPECIAL-PMT
 15498             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15499             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15500                                        AT-AMOUNT-PAID
 15501         ELSE
 15502             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15503
 15504     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15505
 15506     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15507     MOVE '4'                    TO DC-OPTION-CODE.
 15508     PERFORM 9700-LINK-DATE-CONVERT.
 15509
 15510     IF DATE-CONVERSION-ERROR
 15511        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15512     ELSE
 15513        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15514
 15515     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15516     MOVE '4'                    TO DC-OPTION-CODE.
 15517     PERFORM 9700-LINK-DATE-CONVERT.
 15518
 15519     IF DATE-CONVERSION-ERROR
 15520        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15521     ELSE
 15522        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15523
 15524     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15525     GO TO 6150-FINISH-MOVE.
 15526
 15527 6140-PF5-ENTERED.
 15528     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15529     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15530
 15531     IF PI-AIG-SPECIAL-BENEFIT
 15532         IF WS-1ST-SPECIAL-PMT
 15533             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15534             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15535                                        AT-AMOUNT-PAID
 15536         ELSE
 15537             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15538
 15539     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15540     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15541     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15542
 15543 6150-FINISH-MOVE.
 15544
 15545     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 297
* EL156.cbl
 15546         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15547     ELSE
 15548         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15549
 15550     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15551     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15552
 15553*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15554*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15555
 15556     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15557         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15558
 15559     IF PI-OFFLINE = 'N'
 15560        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15561        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15562     ELSE
 15563        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15564        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15565
 15566     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15567
 15568     IF WS-2ND-SPECIAL-PMT
 15569         MOVE 'Y'                TO AT-CASH-PAYMENT
 15570         MOVE SPACES             TO AT-CHECK-NO
 15571         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15572         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15573         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15574         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15575
 15576     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15577                                    AT-TO-BE-WRITTEN-DT.
 15578
 15579     IF PI-HOLDTIL NOT = ZEROS
 15580        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15581        MOVE '4'                 TO DC-OPTION-CODE
 15582        PERFORM 9700-LINK-DATE-CONVERT
 15583        IF PI-OFFLINE = 'N'
 15584           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15585        ELSE
 15586           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15587
 15588     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15589     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15590                                    AT-CHECK-QUE-SEQUENCE.
 15591
 15592     IF PI-PFKEY-USED = DFHPF4
 15593        MOVE '1'                 TO AT-FORCE-CONTROL.
 15594
 15595     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15596        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15597        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15598        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15599
 15600     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15601                                    AT-VOID-SELECT-DT
 15602                                    AT-VOID-ACCEPT-DT
 15603                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 298
* EL156.cbl
 15604     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 15605        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15606        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15607        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15608        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15609     ELSE
 15610        MOVE ZEROS               TO AT-DAILY-RATE
 15611                                    AT-ELIMINATION-DAYS
 15612        MOVE SPACES              TO AT-BENEFIT-TYPE
 15613     END-IF
 15614     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15615     MOVE '4'                    TO DC-OPTION-CODE.
 15616     PERFORM 9700-LINK-DATE-CONVERT.
 15617     IF DATE-CONVERSION-ERROR
 15618         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15619     ELSE
 15620         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15621     END-IF.
 15622     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15623     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15624     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15625     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15626     IF (PI-REAUDIT-NEEDED = 'Y')
 15627        or (pi-max-ext-used = 'Y')
 15628        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15629         MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15630         MOVE 'Y' TO WS-NEED-APPROVAL
 15631         GO TO 6170-WRITE
 15632     END-IF.
 15633*******************************************************
 15634     IF NOT PI-PMT-GRADUATED
 15635         GO TO 6170-WRITE.
 15636
 15637     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15638     MOVE '1'                    TO CNTL-REC-TYPE.
 15639     MOVE SPACES                 TO CNTL-ACCESS.
 15640     MOVE +0                     TO CNTL-SEQ-NO.
 15641     MOVE 'COMP'                 TO FILE-SWITCH.
 15642
 15643     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15644
 15645     IF PAID-FOR-LIFE
 15646         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15647             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15648                                     WS-PMT-APPROVAL-SW
 15649             GO TO 6170-WRITE.
 15650
 15651*05999      IF PAID-FOR-AH
 15652     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15653         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15654             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15655                                     WS-PMT-APPROVAL-SW
 15656             GO TO 6170-WRITE.
 15657
 15658     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15659
 15660******A&H Limits are set as a monthly payment.  Calculate the mont
 15661******equivalent of the amount paid today
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 299
* EL156.cbl
 15662     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15663        PI-SAVE-ODD-DAYS-OVER > 0
 15664           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15665                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15666           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15667                                  WS-CALC-PMT-MONTHS
 15668     ELSE
 15669           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15670     END-IF.
 15671*06007      IF ((PAID-FOR-AH) AND
 15672     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15673*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15674        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15675              OR
 15676        ((PAID-FOR-LIFE) AND
 15677        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15678            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15679       ELSE
 15680*06014      IF ((PAID-FOR-AH)  AND
 15681         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15682*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15683           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15684              OR
 15685        ((PAID-FOR-LIFE) AND
 15686        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15687            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15688         ELSE
 15689*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15690           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15691               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15692              OR
 15693          ((PAID-FOR-LIFE) AND
 15694          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15695            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15696       ELSE
 15697           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15698               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15699              OR
 15700          ((PAID-FOR-LIFE) AND
 15701          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15702            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15703       ELSE
 15704            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15705
 15706     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15707        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15708        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15709            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15710        END-IF
 15711     ELSE
 15712     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15713        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15714        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15715            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15716        END-IF
 15717     ELSE
 15718     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15719        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 300
* EL156.cbl
 15720        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15721            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15722        END-IF
 15723     ELSE
 15724     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15725        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15726        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15727            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15728        END-IF
 15729     ELSE
 15730     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15731            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15732
 15733     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15734
 15735     IF NOT PI-PMT-GRADUATED
 15736         GO TO 6170-WRITE.
 15737
 15738
 15739* EXEC CICS HANDLE CONDITION
 15740*        NOTFND   (6170-WRITE)
 15741*    END-EXEC.
 15742*    MOVE '"$I                   ! 2 #00014766' TO DFHEIV0
 15743     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15744     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15745     MOVE X'3220233030303134373636' TO DFHEIV0(25:11)
 15746     CALL 'kxdfhei1' USING DFHEIV0
 15747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15748
 15749
 15750     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15751     MOVE '2'                    TO CNTL-REC-TYPE.
 15752     MOVE +0                     TO CNTL-SEQ-NO.
 15753     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15754
 15755
 15756* EXEC CICS READ
 15757*         DATASET  ('ELCNTL')
 15758*         SET      (ADDRESS OF CONTROL-FILE)
 15759*         RIDFLD   (ELCNTL-KEY)
 15760*    END-EXEC.
 15761     MOVE 'ELCNTL' TO DFHEIV1
 15762*    MOVE '&"S        E          (   #00014775' TO DFHEIV0
 15763     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15764     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15765     MOVE X'2020233030303134373735' TO DFHEIV0(25:11)
 15766     CALL 'kxdfhei1' USING DFHEIV0,
 15767           DFHEIV1,
 15768           DFHEIV20,
 15769           DFHEIV99,
 15770           ELCNTL-KEY,
 15771           DFHEIV99,
 15772           DFHEIV99,
 15773           DFHEIV99
 15774     SET ADDRESS OF CONTROL-FILE TO
 15775         DFHEIV20
 15776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15777
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 301
* EL156.cbl
 15778
 15779     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15780
 15781     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15782                         OR '4' OR '5'
 15783         NEXT SENTENCE
 15784     ELSE
 15785         MOVE 'Y' TO WS-NEED-APPROVAL
 15786         GO TO 6170-WRITE.
 15787
 15788     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15789         MOVE 'Y' TO WS-NEED-APPROVAL
 15790         IF WS-APPROVAL-LEVEL = '1'
 15791             MOVE '2'        TO  AT-APPROVED-LEVEL
 15792                            WS-SAVE-APPROVED-LEVEL
 15793             GO TO 6170-WRITE
 15794         ELSE
 15795             IF WS-APPROVAL-LEVEL = '2'
 15796                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15797                                WS-SAVE-APPROVED-LEVEL
 15798                 GO TO 6170-WRITE
 15799             ELSE IF WS-APPROVAL-LEVEL = '3'
 15800                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15801                                WS-SAVE-APPROVED-LEVEL
 15802                 GO TO 6170-WRITE
 15803             ELSE IF WS-APPROVAL-LEVEL = '4'
 15804                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15805                                WS-SAVE-APPROVED-LEVEL
 15806                 GO TO 6170-WRITE.
 15807
 15808     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15809                             WS-PMT-APPROVAL-SW.
 15810     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15811                             AT-APPROVAL-LEVEL-REQD.
 15812
 15813*******************************************************
 15814
 15815 6170-WRITE.
 15816
 15817     if pi-company-id = 'DCC'
 15818        PERFORM 0900-GET-DDF-limits
 15819                                 THRU 0900-EXIT
 15820     end-if
 15821     perform 2220-update-elcrtt  thru 2220-exit
 15822     IF PI-COMPANY-ID = 'DMD'
 15823        IF PI-AT-EOB-CODES NOT = SPACES
 15824           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15825           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15826           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15827           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15828           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15829
 15830
 15831* EXEC CICS HANDLE CONDITION
 15832*        DUPREC    (6180-DUPREC)
 15833*    END-EXEC.
 15834*    MOVE '"$%                   ! 3 #00014832' TO DFHEIV0
 15835     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 302
* EL156.cbl
 15836     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15837     MOVE X'3320233030303134383332' TO DFHEIV0(25:11)
 15838     CALL 'kxdfhei1' USING DFHEIV0
 15839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15840
 15841
 15842
 15843* EXEC CICS WRITE
 15844*         DATASET       ('ELTRLR')
 15845*         FROM          (ACTIVITY-TRAILERS)
 15846*         RIDFLD        (AT-CONTROL-PRIMARY)
 15847*     END-EXEC.
 15848     MOVE LENGTH OF
 15849      ACTIVITY-TRAILERS
 15850       TO DFHEIV11
 15851     MOVE 'ELTRLR' TO DFHEIV1
 15852*    MOVE '&$ L                  ''   #00014836' TO DFHEIV0
 15853     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15854     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15855     MOVE X'2020233030303134383336' TO DFHEIV0(25:11)
 15856     CALL 'kxdfhei1' USING DFHEIV0,
 15857           DFHEIV1,
 15858           ACTIVITY-TRAILERS,
 15859           DFHEIV11,
 15860           AT-CONTROL-PRIMARY,
 15861           DFHEIV99,
 15862           DFHEIV99
 15863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15864
 15865
 15866     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15867        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15868*06088           GO TO 6199-EXIT.
 15869           GO TO 6176-APPROVAL-NOTE.
 15870
 15871
 15872* EXEC CICS GETMAIN
 15873*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15874*         LENGTH    (200)
 15875*         INITIMG   (GETMAIN-SPACE)
 15876*     END-EXEC.
 15877     MOVE 200
 15878       TO DFHEIV11
 15879*    MOVE ',"IL                  $   #00014847' TO DFHEIV0
 15880     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15881     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15882     MOVE X'2020233030303134383437' TO DFHEIV0(25:11)
 15883     CALL 'kxdfhei1' USING DFHEIV0,
 15884           DFHEIV20,
 15885           DFHEIV11,
 15886           GETMAIN-SPACE
 15887     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15888         DFHEIV20
 15889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15890
 15891
 15892     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15893
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 303
* EL156.cbl
 15894     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15895     MOVE 'AT'                   TO AT-RECORD-ID.
 15896     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15897     MOVE '6'                    TO AT-TRAILER-TYPE.
 15898     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15899                                    AT-GEN-INFO-LAST-MAINT-DT
 15900     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15901                                    AT-GEN-INFO-LAST-UPDATED-BY
 15902     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15903
 15904     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 15905     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 15906     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 15907
 15908     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 15909
 15910 6175-WRITE.
 15911
 15912
 15913* EXEC CICS HANDLE CONDITION
 15914*        DUPREC    (6190-DUPREC)
 15915*    END-EXEC.
 15916*    MOVE '"$%                   ! 4 #00014873' TO DFHEIV0
 15917     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15918     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15919     MOVE X'3420233030303134383733' TO DFHEIV0(25:11)
 15920     CALL 'kxdfhei1' USING DFHEIV0
 15921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15922
 15923
 15924
 15925* EXEC CICS WRITE
 15926*         DATASET     ('ELTRLR')
 15927*         FROM        (ACTIVITY-TRAILERS)
 15928*         RIDFLD      (AT-CONTROL-PRIMARY)
 15929*     END-EXEC.
 15930     MOVE LENGTH OF
 15931      ACTIVITY-TRAILERS
 15932       TO DFHEIV11
 15933     MOVE 'ELTRLR' TO DFHEIV1
 15934*    MOVE '&$ L                  ''   #00014877' TO DFHEIV0
 15935     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15936     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15937     MOVE X'2020233030303134383737' TO DFHEIV0(25:11)
 15938     CALL 'kxdfhei1' USING DFHEIV0,
 15939           DFHEIV1,
 15940           ACTIVITY-TRAILERS,
 15941           DFHEIV11,
 15942           AT-CONTROL-PRIMARY,
 15943           DFHEIV99,
 15944           DFHEIV99
 15945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15946
 15947
 15948 6176-APPROVAL-NOTE.
 15949
 15950     IF NOT APPROVAL-NEEDED
 15951         GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 304
* EL156.cbl
 15952
 15953
 15954* EXEC CICS GETMAIN
 15955*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15956*        LENGTH    (200)
 15957*        INITIMG   (GETMAIN-SPACE)
 15958*    END-EXEC.
 15959     MOVE 200
 15960       TO DFHEIV11
 15961*    MOVE ',"IL                  $   #00014888' TO DFHEIV0
 15962     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15963     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15964     MOVE X'2020233030303134383838' TO DFHEIV0(25:11)
 15965     CALL 'kxdfhei1' USING DFHEIV0,
 15966           DFHEIV20,
 15967           DFHEIV11,
 15968           GETMAIN-SPACE
 15969     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15970         DFHEIV20
 15971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15972
 15973
 15974     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 15975
 15976     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 15977     MOVE 'AT'               TO AT-RECORD-ID
 15978     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 15979     MOVE '6'                TO AT-TRAILER-TYPE
 15980     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 15981                                AT-GEN-INFO-LAST-MAINT-DT
 15982     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 15983                                AT-GEN-INFO-LAST-UPDATED-BY
 15984     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 15985
 15986     IF PI-REAUDIT-NEEDED = 'Y'
 15987         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 15988     ELSE
 15989         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 15990     END-IF
 15991     IF PI-APPROVAL-3550-NEEDED = 'Y'
 15992         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 15993     END-IF
 15994     MOVE SPACES             TO AT-INFO-LINE-2
 15995
 15996     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 15997 6177-WRITE.
 15998
 15999
 16000* EXEC CICS HANDLE CONDITION
 16001*        DUPREC    (6185-DUPREC)
 16002*    END-EXEC.
 16003*    MOVE '"$%                   ! 5 #00014919' TO DFHEIV0
 16004     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16005     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16006     MOVE X'3520233030303134393139' TO DFHEIV0(25:11)
 16007     CALL 'kxdfhei1' USING DFHEIV0
 16008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16009
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 305
* EL156.cbl
 16010
 16011
 16012* EXEC CICS WRITE
 16013*         DATASET     ('ELTRLR')
 16014*         FROM        (ACTIVITY-TRAILERS)
 16015*         RIDFLD      (AT-CONTROL-PRIMARY)
 16016*     END-EXEC.
 16017     MOVE LENGTH OF
 16018      ACTIVITY-TRAILERS
 16019       TO DFHEIV11
 16020     MOVE 'ELTRLR' TO DFHEIV1
 16021*    MOVE '&$ L                  ''   #00014923' TO DFHEIV0
 16022     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16023     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16024     MOVE X'2020233030303134393233' TO DFHEIV0(25:11)
 16025     CALL 'kxdfhei1' USING DFHEIV0,
 16026           DFHEIV1,
 16027           ACTIVITY-TRAILERS,
 16028           DFHEIV11,
 16029           AT-CONTROL-PRIMARY,
 16030           DFHEIV99,
 16031           DFHEIV99
 16032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16033
 16034
 16035
 16036     GO TO 6199-EXIT.
 16037
 16038 6180-DUPREC.
 16039
 16040     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16041     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16042     GO TO 6170-WRITE.
 16043
 16044 6185-DUPREC.
 16045     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16046     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16047     GO TO 6177-WRITE.
 16048
 16049 6190-DUPREC.
 16050     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16051     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16052     GO TO 6175-WRITE.
 16053
 16054 6199-EXIT.
 16055      EXIT.
 16056
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 306
* EL156.cbl
 16058 6200-UPDATE-CLAIM-MSTR.
 16059     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16060     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16061     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16062     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16063
 16064     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16065
 16066     MOVE ZEROS                  TO W-INTEREST.
 16067
 16068     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 16069        IF (PI-OFFLINE = 'Y') OR
 16070           (PI-PMTTYPE = '7')
 16071           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16072                                 THRU 9870-EXIT
 16073        END-IF
 16074     END-IF
 16075     IF NOT ERROR-ON-OUTPUT
 16076        CONTINUE
 16077     ELSE
 16078
 16079* EXEC CICS REWRITE
 16080*          DATASET('ELMSTR')
 16081*          FROM(CLAIM-MASTER)
 16082*       END-EXEC
 16083     MOVE LENGTH OF
 16084      CLAIM-MASTER
 16085       TO DFHEIV11
 16086     MOVE 'ELMSTR' TO DFHEIV1
 16087*    MOVE '&& L                  %   #00014972' TO DFHEIV0
 16088     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16089     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16090     MOVE X'2020233030303134393732' TO DFHEIV0(25:11)
 16091     CALL 'kxdfhei1' USING DFHEIV0,
 16092           DFHEIV1,
 16093           CLAIM-MASTER,
 16094           DFHEIV11,
 16095           DFHEIV99
 16096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16097
 16098        MOVE -1                  TO ENTPFBL
 16099        MOVE AL-UANON            TO ENTPFBA
 16100        MOVE MAP-NAMEB           TO MAP-NAME
 16101        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16102        GO TO 8200-SEND-DATAONLY
 16103     END-IF
 16104
 16105     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16106
 16107     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16108
 16109     IF PI-AIG-SPECIAL-BENEFIT
 16110         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16111
 16112     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16113
 16114     IF PI-SPECIAL-BEN-SW = 'Y'
 16115         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 307
* EL156.cbl
 16116         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16117
 16118     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16119         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16120     ELSE
 16121         IF PI-PMTTYPE NOT = '4'
 16122            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16123
 16124     IF PI-PMTTYPE = '5' OR '6'
 16125        GO TO  6250-SET-MAINT.
 16126
 16127     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16128                                         CL-LAG-REPORT-CODE.
 16129
 16130     IF CL-ACTIVITY-CODE = 09
 16131         GO TO 6200-CONT-UPDATE.
 16132
 16133     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16134         IF CL-ACTIVITY-CODE = 11
 16135             GO TO 6200-CONT-UPDATE.
 16136
 16137     IF WS-ACT-REC-FOUND-SW = 'N'
 16138         GO TO 6200-CONT-UPDATE.
 16139
 16140     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16141         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16142         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16143         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16144
 16145     IF WS-UPDATE-SW = 'Y'
 16146         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16147                                         CL-NEXT-FOLLOWUP-DT.
 16148
 16149 6200-CONT-UPDATE.
 16150
 16151     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16152       IF CLAIM-IS-CLOSED
 16153         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16154           IF WS-OPEN-CLOSE-SW = '2'
 16155             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16156                                        CL-LAST-CLOSE-DT.
 16157
 16158     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16159        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16160        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16161
 16162     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16163        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16164        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16165        MOVE 'C'                 TO CL-CLAIM-STATUS
 16166        IF PI-PMTTYPE = '2'
 16167           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16168              or 'F')
 16169           CONTINUE
 16170        ELSE
 16171           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16172        END-IF
 16173     ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 308
* EL156.cbl
 16174        IF PI-PMTTYPE = '2' OR '3'
 16175           IF PI-PMTTYPE = '2' AND
 16176              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16177                 or 'F')
 16178              CONTINUE
 16179           ELSE
 16180              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16181           END-IF
 16182        END-IF
 16183     END-IF
 16184
 16185     IF PI-PMTTYPE = '4'
 16186        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16187
 16188     IF PI-COMPANY-ID = 'CVL'
 16189         IF PI-LOAN-UPDATE-SW = 'Y'
 16190             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16191             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16192             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16193             MOVE CL-CERT-STATE      TO  CERT-STATE
 16194             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16195             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16196             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16197             MOVE 'CERT'             TO  FILE-SWITCH
 16198             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16199             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16200             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16201
 16202     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16203        GO TO 6220-USE-COMPUTED.
 16204
 16205     IF (PI-PMTTYPE = '4')  AND
 16206        (PI-EPYAMT < ZEROS)
 16207          COMPUTE CL-NO-OF-DAYS-PAID =
 16208                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16209          IF CL-NO-OF-DAYS-PAID < +0
 16210              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16211          ELSE
 16212              NEXT SENTENCE
 16213     ELSE
 16214          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16215
 16216     IF PI-PROCESSOR-ID = 'FIX '
 16217        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16218           NEXT SENTENCE
 16219        ELSE
 16220           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16221     ELSE
 16222        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16223
 16224     IF PI-PMTTYPE = '4'
 16225        GO TO 6250-SET-MAINT.
 16226
 16227     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16228
 16229     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16230     MOVE '4'                    TO DC-OPTION-CODE.
 16231     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 309
* EL156.cbl
 16232     IF DATE-CONVERSION-ERROR
 16233        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16234     ELSE
 16235        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16236           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16237           IF PI-AIG-SPECIAL-BENEFIT
 16238               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16239           ELSE
 16240               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16241
 16242     GO TO 6250-SET-MAINT.
 16243
 16244 6220-USE-COMPUTED.
 16245
 16246     IF (PI-PMTTYPE = '4')  AND
 16247        (PI-CPYAMT < ZEROS)
 16248          COMPUTE CL-NO-OF-DAYS-PAID =
 16249                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16250          IF CL-NO-OF-DAYS-PAID < +0
 16251              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16252          ELSE
 16253              NEXT SENTENCE
 16254     ELSE
 16255          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16256
 16257     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 16258
 16259     IF PI-PMTTYPE = '4'
 16260        GO TO 6250-SET-MAINT.
 16261
 16262     IF PI-AIG-SPECIAL-BENEFIT
 16263         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16264     ELSE
 16265         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16266
 16267     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16268
 16269     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16270        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16271
 16272 6250-SET-MAINT.
 16273     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16274
 16275     IF PI-PROCESSOR-ID = 'FIX '
 16276        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16277           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16278        ELSE
 16279           NEXT SENTENCE
 16280     ELSE
 16281        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16282
 16283     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 16284     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16285     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16286
 16287 6299-EXIT.
 16288      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 310
* EL156.cbl
 16290 6300-UPDATE-CERT.
 16291
 16292*  ADD CERTNOTE FOR SC NP+6
 16293     IF PI-COMPANY-ID = 'CID' AND
 16294       (PI-PMTTYPE = '2' OR '3') AND
 16295        CL-CERT-STATE = 'SC'  AND
 16296        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16297           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16298     END-IF.
 16299
 16300     IF PI-COMPANY-ID = 'AHL' AND
 16301       (PI-PMTTYPE = '2' OR '3') AND
 16302        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16303           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16304           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16305     END-IF.
 16306
 16307     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16308     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16309     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16310     MOVE CL-CERT-STATE    TO CERT-STATE.
 16311     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16312     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16313     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16314     MOVE 'CERT'           TO FILE-SWITCH.
 16315
 16316     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16317
 16318     IF CERT-NOTE-ADDED
 16319        IF CM-NOTE-SW = ' '
 16320           MOVE '4'             TO CM-NOTE-SW
 16321        ELSE
 16322           IF CM-NOTE-SW = '1'
 16323               MOVE '5'           TO CM-NOTE-SW
 16324           ELSE
 16325              IF CM-NOTE-SW = '2'
 16326                 MOVE '6'         TO CM-NOTE-SW
 16327              ELSE
 16328                 IF CM-NOTE-SW = '3'
 16329                    MOVE '7'      TO CM-NOTE-SW
 16330                 END-IF
 16331              END-IF
 16332           END-IF
 16333        END-IF
 16334     END-IF.
 16335
 16336     IF PI-COMPANY-ID = 'CVL'
 16337         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16338         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16339
 16340     IF PI-PMTTYPE NOT = '4'
 16341        GO TO 6340-UPDATE-CERT.
 16342
 16343     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16344        IF PI-PFKEY-USED = DFHPF5
 16345           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16346        ELSE
 16347           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 311
* EL156.cbl
 16348
 16349*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16350*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16351*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16352*               PI-LF-COVERAGE-TYPE = 'P'
 16353*                GO TO 6350-REWRITE-CERT.
 16354
 16355     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16356       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16357          PI-LF-COVERAGE-TYPE = 'P'
 16358           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16359                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16360                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16361                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16362                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16363                GO TO 6350-REWRITE-CERT
 16364            ELSE
 16365                GO TO 6350-REWRITE-CERT.
 16366
 16367     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16368         GO TO 6350-REWRITE-CERT.
 16369
 16370     IF NOT CM-AH-LUMP-SUM-DISAB
 16371        GO TO 6380-UNLOCK-CERT.
 16372
 16373     IF PI-PFKEY-USED = DFHPF5
 16374        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16375                                    CM-AH-ITD-AH-PMT
 16376        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16377        GO TO 6350-REWRITE-CERT
 16378     ELSE
 16379        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16380                                    CM-AH-ITD-AH-PMT
 16381        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16382        GO TO 6350-REWRITE-CERT.
 16383
 16384 6340-UPDATE-CERT.
 16385
 16386     IF CL-CLAIM-TYPE = 'L'
 16387         IF PI-PFKEY-USED = DFHPF5
 16388             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16389         ELSE
 16390             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16391
 16392     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16393         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16394             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16395                PI-LF-COVERAGE-TYPE = 'P'
 16396                 GO TO 6350-REWRITE-CERT.
 16397
 16398     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16399       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16400          PI-LF-COVERAGE-TYPE = 'P'
 16401           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16402                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16403                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16404                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16405                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 312
* EL156.cbl
 16406                GO TO 6350-REWRITE-CERT.
 16407
 16408     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16409         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16410            PI-LF-COVERAGE-TYPE NOT = 'P'
 16411             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16412             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16413             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16414             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16415             GO TO 6350-REWRITE-CERT.
 16416
 16417     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16418         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16419         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16420         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16421         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16422         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16423         IF PI-PFKEY-USED = DFHPF5
 16424             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16425                                        CM-AH-ITD-AH-PMT
 16426             GO TO 6350-REWRITE-CERT
 16427         ELSE
 16428             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16429                                        CM-AH-ITD-AH-PMT
 16430             GO TO 6350-REWRITE-CERT.
 16431
 16432 6350-REWRITE-CERT.
 16433
 16434
 16435* EXEC CICS REWRITE
 16436*         DATASET  ('ELCERT')
 16437*         FROM(CERTIFICATE-MASTER)
 16438*     END-EXEC.
 16439     MOVE LENGTH OF
 16440      CERTIFICATE-MASTER
 16441       TO DFHEIV11
 16442     MOVE 'ELCERT' TO DFHEIV1
 16443*    MOVE '&& L                  %   #00015313' TO DFHEIV0
 16444     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16445     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16446     MOVE X'2020233030303135333133' TO DFHEIV0(25:11)
 16447     CALL 'kxdfhei1' USING DFHEIV0,
 16448           DFHEIV1,
 16449           CERTIFICATE-MASTER,
 16450           DFHEIV11,
 16451           DFHEIV99
 16452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16453
 16454
 16455     GO TO 6399-EXIT.
 16456
 16457 6380-UNLOCK-CERT.
 16458
 16459* EXEC CICS UNLOCK
 16460*         DATASET  ('ELCERT')
 16461*     END-EXEC.
 16462     MOVE 'ELCERT' TO DFHEIV1
 16463*    MOVE '&*                    #   #00015321' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 313
* EL156.cbl
 16464     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16465     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16466     MOVE X'2020233030303135333231' TO DFHEIV0(25:11)
 16467     CALL 'kxdfhei1' USING DFHEIV0,
 16468           DFHEIV1,
 16469           DFHEIV99
 16470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16471
 16472
 16473 6399-EXIT.
 16474      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 314
* EL156.cbl
 16476 6400-UPDATE-ZERO-TRAILER.
 16477     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16478     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16479
 16480     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16481
 16482     IF PI-EPYAMT NOT = ZEROS
 16483         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16484     ELSE
 16485         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16486
 16487     IF PI-ERESV NOT = ZEROS
 16488        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16489
 16490     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16491        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16492
 16493     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16494        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16495     ELSE
 16496        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16497
 16498     IF PI-PMTTYPE = '5'
 16499        IF PI-EPYAMT = ZEROS
 16500           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16501        ELSE
 16502           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16503
 16504     IF PI-PMTTYPE = '6'
 16505        IF PI-EPYAMT = ZEROS
 16506           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16507        ELSE
 16508           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16509
 16510 6420-CHECK-OPEN-CLOSE.
 16511     IF PI-PMTTYPE = '5' OR '6'
 16512        GO TO 6450-REWRITE.
 16513
 16514     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16515         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16516             IF CLAIM-IS-CLOSED
 16517                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16518                 MOVE 1          TO  SUB-1
 16519                 GO TO 6440-AIG-LOOP.
 16520
 16521     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16522        GO TO 6450-REWRITE.
 16523
 16524     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16525        GO TO 6450-REWRITE.
 16526
 16527     MOVE 1                      TO SUB-1.
 16528
 16529 6430-LOOP.
 16530     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16531        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16532        IF PI-PMTTYPE = '1' OR '4'
 16533           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 315
* EL156.cbl
 16534           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16535           GO TO 6450-REWRITE
 16536        ELSE
 16537           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16538           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16539           GO TO 6450-REWRITE.
 16540
 16541     IF SUB-1 = 6
 16542      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16543      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16544      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16545      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16546      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16547      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16548      GO TO 6430-LOOP.
 16549
 16550     ADD 1                       TO SUB-1.
 16551     GO TO 6430-LOOP.
 16552
 16553
 16554 6440-AIG-LOOP.
 16555
 16556     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16557       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16558       IF WS-OPEN-CLOSE-SW = '1'
 16559         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16560         IF PI-PMTTYPE = '2'
 16561           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16562           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16563         ELSE
 16564           IF PI-PMTTYPE = '3'
 16565             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16566             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16567           ELSE
 16568             IF PI-PMTTYPE = '4'
 16569               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16570               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16571             ELSE
 16572               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16573               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16574       ELSE
 16575         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16576         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16577         GO TO 6450-REWRITE.
 16578
 16579     IF SUB-1 = 6
 16580      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16581      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16582      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16583      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16584      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16585      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16586      GO TO 6440-AIG-LOOP.
 16587
 16588     ADD 1                       TO SUB-1.
 16589     GO TO 6440-AIG-LOOP.
 16590
 16591 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 316
* EL156.cbl
 16592     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16593     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16594     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16595
 16596     IF PI-COMPANY-ID = 'DMD'
 16597         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16598         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16599         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16600         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16601         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16602
 16603
 16604* EXEC CICS REWRITE
 16605*         DATASET  ('ELTRLR')
 16606*         FROM     (ACTIVITY-TRAILERS)
 16607*     END-EXEC.
 16608     MOVE LENGTH OF
 16609      ACTIVITY-TRAILERS
 16610       TO DFHEIV11
 16611     MOVE 'ELTRLR' TO DFHEIV1
 16612*    MOVE '&& L                  %   #00015455' TO DFHEIV0
 16613     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16614     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16615     MOVE X'2020233030303135343535' TO DFHEIV0(25:11)
 16616     CALL 'kxdfhei1' USING DFHEIV0,
 16617           DFHEIV1,
 16618           ACTIVITY-TRAILERS,
 16619           DFHEIV11,
 16620           DFHEIV99
 16621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16622
 16623
 16624 6499-EXIT.
 16625      EXIT.
 16626
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 317
* EL156.cbl
 16628 6500-READ-DLO035.
 16629     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16630     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16631     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16632     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16633
 16634
 16635* EXEC CICS LINK
 16636*        PROGRAM    ('DLO035')
 16637*        COMMAREA   (DLO035-KEY)
 16638*        LENGTH     (DL35-LENGTH)
 16639*    END-EXEC.
 16640     MOVE 'DLO035' TO DFHEIV1
 16641*    MOVE '."C                   (   #00015470' TO DFHEIV0
 16642     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16643     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16644     MOVE X'2020233030303135343730' TO DFHEIV0(25:11)
 16645     CALL 'kxdfhei1' USING DFHEIV0,
 16646           DFHEIV1,
 16647           DLO035-KEY,
 16648           DL35-LENGTH,
 16649           DFHEIV99,
 16650           DFHEIV99,
 16651           DFHEIV99,
 16652           DFHEIV99
 16653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16654
 16655
 16656     IF DL35-RETURN-CODE = 'OK'
 16657         GO TO 6500-EXIT.
 16658
 16659     IF DL35-RETURN-CODE = '01'
 16660         MOVE ER-7830            TO EMI-ERROR
 16661         GO TO 6500-BAD-EXIT.
 16662
 16663     IF DL35-RETURN-CODE = '02'
 16664         MOVE ER-7831            TO EMI-ERROR
 16665         GO TO 6500-BAD-EXIT.
 16666
 16667     IF DL35-RETURN-CODE = '03'
 16668         MOVE ER-7832            TO EMI-ERROR
 16669         GO TO 6500-BAD-EXIT.
 16670
 16671     IF DL35-RETURN-CODE = '04'
 16672         MOVE ER-7833            TO EMI-ERROR
 16673         GO TO 6500-BAD-EXIT.
 16674
 16675     IF DL35-RETURN-CODE = '05'
 16676         MOVE ER-7834            TO EMI-ERROR
 16677         GO TO 6500-BAD-EXIT.
 16678
 16679     IF DL35-RETURN-CODE = '06'
 16680         MOVE ER-7835            TO EMI-ERROR
 16681         GO TO 6500-BAD-EXIT.
 16682
 16683     IF DL35-RETURN-CODE = '07'
 16684         MOVE ER-7836            TO EMI-ERROR
 16685         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 318
* EL156.cbl
 16686
 16687     IF DL35-RETURN-CODE = 'E1'
 16688         MOVE ER-7837            TO EMI-ERROR
 16689         GO TO 6500-BAD-EXIT.
 16690
 16691     IF DL35-RETURN-CODE NOT = 'OK'
 16692         MOVE ER-7838            TO EMI-ERROR
 16693         GO TO 6500-BAD-EXIT.
 16694
 16695 6500-EXIT.
 16696      EXIT.
 16697
 16698 6500-BAD-EXIT.
 16699
 16700* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16701*    MOVE '6"R                   !   #00015519' TO DFHEIV0
 16702     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16703     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16704     MOVE X'2020233030303135353139' TO DFHEIV0(25:11)
 16705     CALL 'kxdfhei1' USING DFHEIV0
 16706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16707
 16708     MOVE -1                 TO PMTTYPEL.
 16709     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16710     GO TO 8200-SEND-DATAONLY.
 16711
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 319
* EL156.cbl
 16713 6600-UPDATE-DLO035.
 16714     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16715     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16716     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16717     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16718
 16719
 16720* EXEC CICS LINK
 16721*        PROGRAM    ('DLO035')
 16722*        COMMAREA   (DLO035-KEY)
 16723*        LENGTH     (DL35-LENGTH)
 16724*    END-EXEC.
 16725     MOVE 'DLO035' TO DFHEIV1
 16726*    MOVE '."C                   (   #00015531' TO DFHEIV0
 16727     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16728     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16729     MOVE X'2020233030303135353331' TO DFHEIV0(25:11)
 16730     CALL 'kxdfhei1' USING DFHEIV0,
 16731           DFHEIV1,
 16732           DLO035-KEY,
 16733           DL35-LENGTH,
 16734           DFHEIV99,
 16735           DFHEIV99,
 16736           DFHEIV99,
 16737           DFHEIV99
 16738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16739
 16740
 16741     IF DL35-RETURN-CODE = 'OK'
 16742         GO TO 6600-EXIT.
 16743
 16744     IF DL35-RETURN-CODE = '01'
 16745         MOVE ER-7830            TO EMI-ERROR
 16746         GO TO 6500-BAD-EXIT.
 16747
 16748     IF DL35-RETURN-CODE = '02'
 16749         MOVE ER-7831            TO EMI-ERROR
 16750         GO TO 6500-BAD-EXIT.
 16751
 16752     IF DL35-RETURN-CODE = '03'
 16753         MOVE ER-7832            TO EMI-ERROR
 16754         GO TO 6500-BAD-EXIT.
 16755
 16756     IF DL35-RETURN-CODE = '04'
 16757         MOVE ER-7833            TO EMI-ERROR
 16758         GO TO 6500-BAD-EXIT.
 16759
 16760     IF DL35-RETURN-CODE = '05'
 16761         MOVE ER-7834            TO EMI-ERROR
 16762         GO TO 6500-BAD-EXIT.
 16763
 16764     IF DL35-RETURN-CODE = '06'
 16765         MOVE ER-7835            TO EMI-ERROR
 16766         GO TO 6500-BAD-EXIT.
 16767
 16768     IF DL35-RETURN-CODE = '07'
 16769         MOVE ER-7836            TO EMI-ERROR
 16770         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 320
* EL156.cbl
 16771
 16772     IF DL35-RETURN-CODE = 'E1'
 16773         MOVE ER-7837            TO EMI-ERROR
 16774         GO TO 6500-BAD-EXIT.
 16775
 16776     IF DL35-RETURN-CODE NOT = 'OK'
 16777         MOVE ER-7838            TO EMI-ERROR
 16778         GO TO 6500-BAD-EXIT.
 16779
 16780 6600-EXIT.
 16781      EXIT.
 16782
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 321
* EL156.cbl
 16784 6700-UPDATE-ACTQ.
 16785***************************************************************
 16786*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16787*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16788*    ONE ALREADY THERE.                                       *
 16789***************************************************************
 16790
 16791
 16792* EXEC CICS HANDLE CONDITION
 16793*         NOTFND(6720-BUILD-NEW-RECORD)
 16794*     END-EXEC.
 16795*    MOVE '"$I                   ! 6 #00015587' TO DFHEIV0
 16796     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16797     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16798     MOVE X'3620233030303135353837' TO DFHEIV0(25:11)
 16799     CALL 'kxdfhei1' USING DFHEIV0
 16800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16801
 16802
 16803
 16804* EXEC CICS READ
 16805*         DATASET('ELACTQ')
 16806*         RIDFLD (ELMSTR-KEY)
 16807*         SET    (ADDRESS OF ACTIVITY-QUE)
 16808*         UPDATE
 16809*     END-EXEC.
 16810     MOVE 'ELACTQ' TO DFHEIV1
 16811*    MOVE '&"S        EU         (   #00015591' TO DFHEIV0
 16812     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16813     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16814     MOVE X'2020233030303135353931' TO DFHEIV0(25:11)
 16815     CALL 'kxdfhei1' USING DFHEIV0,
 16816           DFHEIV1,
 16817           DFHEIV20,
 16818           DFHEIV99,
 16819           ELMSTR-KEY,
 16820           DFHEIV99,
 16821           DFHEIV99,
 16822           DFHEIV99
 16823     SET ADDRESS OF ACTIVITY-QUE TO
 16824         DFHEIV20
 16825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16826
 16827
 16828     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16829
 16830     IF PI-AIG-SPECIAL-BENEFIT AND
 16831        PI-CASH = 'Y'
 16832         ADD 2                   TO AQ-PAYMENT-COUNTER
 16833     ELSE
 16834         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16835
 16836     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16837         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16838
 16839     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16840
 16841     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 322
* EL156.cbl
 16842         IF WS-PMT-APPROVAL-SW = 'A'
 16843             NEXT SENTENCE
 16844         ELSE
 16845            IF PI-AIG-SPECIAL-BENEFIT AND
 16846               PI-CASH = 'Y'
 16847                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16848                                     WS-PMT-UNAPPROVED-CNT
 16849            ELSE
 16850                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16851                                     WS-PMT-UNAPPROVED-CNT
 16852     ELSE
 16853         IF PI-PMT-APPR-SW = 'Y'
 16854            IF PI-AIG-SPECIAL-BENEFIT AND
 16855               PI-CASH = 'Y'
 16856                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16857                                     WS-PMT-UNAPPROVED-CNT
 16858            ELSE
 16859                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16860                                     WS-PMT-UNAPPROVED-CNT.
 16861
 16862     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16863         MOVE ER-3536 TO EMI-ERROR
 16864         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16865
 16866     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16867
 16868
 16869* EXEC CICS REWRITE
 16870*         DATASET('ELACTQ')
 16871*         FROM   (ACTIVITY-QUE)
 16872*     END-EXEC.
 16873     MOVE LENGTH OF
 16874      ACTIVITY-QUE
 16875       TO DFHEIV11
 16876     MOVE 'ELACTQ' TO DFHEIV1
 16877*    MOVE '&& L                  %   #00015638' TO DFHEIV0
 16878     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16879     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16880     MOVE X'2020233030303135363338' TO DFHEIV0(25:11)
 16881     CALL 'kxdfhei1' USING DFHEIV0,
 16882           DFHEIV1,
 16883           ACTIVITY-QUE,
 16884           DFHEIV11,
 16885           DFHEIV99
 16886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16887
 16888
 16889     GO TO 6799-EXIT.
 16890
 16891 6720-BUILD-NEW-RECORD.
 16892
 16893* EXEC CICS GETMAIN
 16894*         SET    (ADDRESS OF ACTIVITY-QUE)
 16895*         LENGTH (60)
 16896*         INITIMG(GETMAIN-SPACE)
 16897*     END-EXEC.
 16898     MOVE 60
 16899       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 323
* EL156.cbl
 16900*    MOVE ',"IL                  $   #00015646' TO DFHEIV0
 16901     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16902     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16903     MOVE X'2020233030303135363436' TO DFHEIV0(25:11)
 16904     CALL 'kxdfhei1' USING DFHEIV0,
 16905           DFHEIV20,
 16906           DFHEIV11,
 16907           GETMAIN-SPACE
 16908     SET ADDRESS OF ACTIVITY-QUE TO
 16909         DFHEIV20
 16910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16911
 16912
 16913     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 16914
 16915     IF PI-AIG-SPECIAL-BENEFIT AND
 16916        PI-CASH = 'Y'
 16917         MOVE 2                  TO AQ-PAYMENT-COUNTER
 16918     ELSE
 16919         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 16920
 16921     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 16922     MOVE 'AQ'                   TO AQ-RECORD-ID.
 16923     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 16924     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 16925                                    AQ-FOLLOWUP-DATE.
 16926     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 16927     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16928
 16929     IF PI-PMT-GRADUATED
 16930         IF WS-PMT-APPROVAL-SW = 'A'
 16931             NEXT SENTENCE
 16932         ELSE
 16933            IF PI-AIG-SPECIAL-BENEFIT AND
 16934               PI-CASH = 'Y'
 16935                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16936            ELSE
 16937                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16938     ELSE
 16939         IF PI-PMT-APPR-SW = 'Y'
 16940            IF PI-AIG-SPECIAL-BENEFIT AND
 16941               PI-CASH = 'Y'
 16942                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16943            ELSE
 16944                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 16945
 16946     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 16947         MOVE ER-3536 TO EMI-ERROR
 16948         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16949
 16950
 16951* EXEC CICS WRITE
 16952*         DATASET('ELACTQ')
 16953*         RIDFLD (ELMSTR-KEY)
 16954*         FROM   (ACTIVITY-QUE)
 16955*     END-EXEC.
 16956     MOVE LENGTH OF
 16957      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 324
* EL156.cbl
 16958       TO DFHEIV11
 16959     MOVE 'ELACTQ' TO DFHEIV1
 16960*    MOVE '&$ L                  ''   #00015689' TO DFHEIV0
 16961     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16962     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16963     MOVE X'2020233030303135363839' TO DFHEIV0(25:11)
 16964     CALL 'kxdfhei1' USING DFHEIV0,
 16965           DFHEIV1,
 16966           ACTIVITY-QUE,
 16967           DFHEIV11,
 16968           ELMSTR-KEY,
 16969           DFHEIV99,
 16970           DFHEIV99
 16971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16972
 16973
 16974 6799-EXIT.
 16975      EXIT.
 16976
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 325
* EL156.cbl
 16978 6800-BUILD-FORM-TRAILER.
 16979
 16980
 16981* EXEC CICS GETMAIN
 16982*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16983*         LENGTH   (200)
 16984*         INITIMG  (GETMAIN-SPACE)
 16985*    END-EXEC.
 16986     MOVE 200
 16987       TO DFHEIV11
 16988*    MOVE ',"IL                  $   #00015701' TO DFHEIV0
 16989     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16990     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16991     MOVE X'2020233030303135373031' TO DFHEIV0(25:11)
 16992     CALL 'kxdfhei1' USING DFHEIV0,
 16993           DFHEIV20,
 16994           DFHEIV11,
 16995           GETMAIN-SPACE
 16996     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16997         DFHEIV20
 16998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16999
 17000
 17001     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17002
 17003     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17004     MOVE 'AT'                   TO AT-RECORD-ID.
 17005     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17006
 17007     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17008     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17009                                    AT-FORM-LAST-MAINT-DT
 17010                                    AT-FORM-SEND-ON-DT.
 17011     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17012                                    AT-FORM-LAST-UPDATED-BY.
 17013     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17014     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17015     MOVE '6'                    TO DC-OPTION-CODE.
 17016     MOVE +29                    TO DC-ELAPSED-DAYS.
 17017     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17018     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17019     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17020
 17021     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17022         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17023
 17024     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17025                                    AT-FORM-RE-SEND-DT
 17026                                    AT-EMP-FORM-ANSWERED-DT
 17027                                    AT-PHY-FORM-ANSWERED-DT
 17028                                    AT-EMP-FORM-SEND-ON-DT
 17029                                    AT-PHY-FORM-SEND-ON-DT
 17030                                    AT-FORM-PRINTED-DT
 17031                                    AT-FORM-REPRINT-DT.
 17032     MOVE '2'                    TO AT-FORM-TYPE.
 17033
 17034     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17035     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 326
* EL156.cbl
 17036
 17037     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17038         NEXT SENTENCE
 17039     ELSE
 17040         IF CL-PROG-FORM-TYPE NOT = 'S'
 17041            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17042
 17043
 17044* EXEC CICS WRITE
 17045*         DATASET  ('ELTRLR')
 17046*         FROM     (ACTIVITY-TRAILERS)
 17047*         RIDFLD   (AT-CONTROL-PRIMARY)
 17048*     END-EXEC.
 17049     MOVE LENGTH OF
 17050      ACTIVITY-TRAILERS
 17051       TO DFHEIV11
 17052     MOVE 'ELTRLR' TO DFHEIV1
 17053*    MOVE '&$ L                  ''   #00015749' TO DFHEIV0
 17054     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17055     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17056     MOVE X'2020233030303135373439' TO DFHEIV0(25:11)
 17057     CALL 'kxdfhei1' USING DFHEIV0,
 17058           DFHEIV1,
 17059           ACTIVITY-TRAILERS,
 17060           DFHEIV11,
 17061           AT-CONTROL-PRIMARY,
 17062           DFHEIV99,
 17063           DFHEIV99
 17064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17065
 17066
 17067 6899-EXIT.
 17068      EXIT.
 17069
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 327
* EL156.cbl
 17071 6900-BUILD-ARCHIVE-HEADER.
 17072
 17073     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17074     MOVE '1'                    TO CNTL-REC-TYPE.
 17075     MOVE +0                     TO CNTL-SEQ-NO.
 17076     MOVE SPACES                 TO CNTL-ACCESS.
 17077
 17078
 17079* EXEC CICS READ
 17080*         DATASET  ('ELCNTL')
 17081*         SET      (ADDRESS OF CONTROL-FILE)
 17082*         RIDFLD   (ELCNTL-KEY)
 17083*         UPDATE
 17084*    END-EXEC.
 17085     MOVE 'ELCNTL' TO DFHEIV1
 17086*    MOVE '&"S        EU         (   #00015766' TO DFHEIV0
 17087     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17088     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17089     MOVE X'2020233030303135373636' TO DFHEIV0(25:11)
 17090     CALL 'kxdfhei1' USING DFHEIV0,
 17091           DFHEIV1,
 17092           DFHEIV20,
 17093           DFHEIV99,
 17094           ELCNTL-KEY,
 17095           DFHEIV99,
 17096           DFHEIV99,
 17097           DFHEIV99
 17098     SET ADDRESS OF CONTROL-FILE TO
 17099         DFHEIV20
 17100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17101
 17102
 17103     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17104     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17105
 17106
 17107* EXEC CICS REWRITE
 17108*         FROM     (CONTROL-FILE)
 17109*         DATASET  ('ELCNTL')
 17110*    END-EXEC.
 17111     MOVE LENGTH OF
 17112      CONTROL-FILE
 17113       TO DFHEIV11
 17114     MOVE 'ELCNTL' TO DFHEIV1
 17115*    MOVE '&& L                  %   #00015776' TO DFHEIV0
 17116     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17117     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17118     MOVE X'2020233030303135373736' TO DFHEIV0(25:11)
 17119     CALL 'kxdfhei1' USING DFHEIV0,
 17120           DFHEIV1,
 17121           CONTROL-FILE,
 17122           DFHEIV11,
 17123           DFHEIV99
 17124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17125
 17126
 17127
 17128* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 328
* EL156.cbl
 17129*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17130*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17131*    END-EXEC.
 17132*    MOVE '"$$%                  ! 7 #00015781' TO DFHEIV0
 17133     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17134     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17135     MOVE X'3720233030303135373831' TO DFHEIV0(25:11)
 17136     CALL 'kxdfhei1' USING DFHEIV0
 17137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17138
 17139
 17140
 17141* EXEC CICS GETMAIN
 17142*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17143*         LENGTH  (ELARCH-LENGTH)
 17144*         INITIMG (GETMAIN-SPACE)
 17145*    END-EXEC.
 17146*    MOVE ',"IL                  $   #00015786' TO DFHEIV0
 17147     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17148     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17149     MOVE X'2020233030303135373836' TO DFHEIV0(25:11)
 17150     CALL 'kxdfhei1' USING DFHEIV0,
 17151           DFHEIV20,
 17152           ELARCH-LENGTH,
 17153           GETMAIN-SPACE
 17154     SET ADDRESS OF LETTER-ARCHIVE TO
 17155         DFHEIV20
 17156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17157
 17158
 17159     MOVE 'LA'                   TO LA-RECORD-ID.
 17160     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17161                                    LA-ARCHIVE-NO-A1.
 17162     MOVE '4'                    TO LA-RECORD-TYPE
 17163                                    LA-RECORD-TYPE-A1.
 17164     MOVE +0                     TO LA-LINE-SEQ-NO
 17165                                    LA-LINE-SEQ-NO-A1.
 17166     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17167                                    LA-COMPANY-CD-A1.
 17168     MOVE CL-CARRIER             TO LA4-CARRIER.
 17169     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17170     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17171     MOVE CL-CERT-STATE          TO LA4-STATE.
 17172     MOVE +0                     TO LA4-NO-OF-COPIES.
 17173     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17174     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17175     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17176                                    LA4-INITIAL-PRINT-DATE
 17177                                    LA4-RESEND-PRINT-DATE
 17178                                    LA4-FORM-REM-PRINT-DT.
 17179     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17180     MOVE '2'                    TO LA4-FORM-TYPE.
 17181
 17182
 17183* EXEC CICS WRITE
 17184*         DATASET  ('ELARCH')
 17185*         FROM     (LETTER-ARCHIVE)
 17186*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 329
* EL156.cbl
 17187*    END-EXEC.
 17188     MOVE LENGTH OF
 17189      LETTER-ARCHIVE
 17190       TO DFHEIV11
 17191     MOVE 'ELARCH' TO DFHEIV1
 17192*    MOVE '&$ L                  ''   #00015815' TO DFHEIV0
 17193     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17194     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17195     MOVE X'2020233030303135383135' TO DFHEIV0(25:11)
 17196     CALL 'kxdfhei1' USING DFHEIV0,
 17197           DFHEIV1,
 17198           LETTER-ARCHIVE,
 17199           DFHEIV11,
 17200           LA-CONTROL-PRIMARY,
 17201           DFHEIV99,
 17202           DFHEIV99
 17203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17204
 17205
 17206 6999-EXIT.
 17207      EXIT.
 17208
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 330
* EL156.cbl
 17210 7000-SHOW-CLAIM.
 17211     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17212     MOVE 'A'                    TO PI-PASS-SW.
 17213     MOVE LOW-VALUES             TO PI-CPYFROM
 17214                                    PI-MONTH-END-SAVE
 17215                                    PI-CPYTHRU.
 17216
 17217     MOVE ZEROS                  TO PI-FATAL-COUNT
 17218                                    PI-DAILY-RATE
 17219                                    PI-BEN-DAYS
 17220                                    PI-MANUAL-SW
 17221                                    PI-SAVE-CURSOR
 17222                                    PI-FORCE-COUNT
 17223                                    PI-HOLDTIL
 17224                                    PI-EPYFROM
 17225                                    PI-EPYTHRU
 17226                                    PI-EDAYS
 17227                                    PI-EPYAMT
 17228                                    PI-ERESV
 17229                                    PI-EEXPENS
 17230                                    PI-CDAYS
 17231                                    PI-CPYAMT
 17232                                    PI-CRESV
 17233                                    PI-CEXPENS
 17234                                    PI-INT-RATE
 17235                                    PI-AIGFROM.
 17236     MOVE ZEROS                  TO PI-PROOF-DATE.
 17237     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17238                                    PI-REM-BEN-AMT
 17239                                    PI-MO-BEN-AMT
 17240                                    pi-ah-term.
 17241
 17242     MOVE LOW-VALUES             TO EL156AI.
 17243     MOVE MAP-NAMEA              TO MAP-NAME.
 17244
 17245* EXEC CICS HANDLE CONDITION
 17246*        NOTFND   (7010-BUILD-MAP)
 17247*    END-EXEC.
 17248*    MOVE '"$I                   ! 8 #00015859' TO DFHEIV0
 17249     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17250     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17251     MOVE X'3820233030303135383539' TO DFHEIV0(25:11)
 17252     CALL 'kxdfhei1' USING DFHEIV0
 17253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17254
 17255
 17256     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17257     MOVE '2'                    TO CNTL-REC-TYPE.
 17258     MOVE +0                     TO CNTL-SEQ-NO.
 17259     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17260
 17261
 17262* EXEC CICS READ
 17263*         DATASET  ('ELCNTL')
 17264*         SET      (ADDRESS OF CONTROL-FILE)
 17265*         RIDFLD   (ELCNTL-KEY)
 17266*    END-EXEC.
 17267     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 331
* EL156.cbl
 17268*    MOVE '&"S        E          (   #00015868' TO DFHEIV0
 17269     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17270     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17271     MOVE X'2020233030303135383638' TO DFHEIV0(25:11)
 17272     CALL 'kxdfhei1' USING DFHEIV0,
 17273           DFHEIV1,
 17274           DFHEIV20,
 17275           DFHEIV99,
 17276           ELCNTL-KEY,
 17277           DFHEIV99,
 17278           DFHEIV99,
 17279           DFHEIV99
 17280     SET ADDRESS OF CONTROL-FILE TO
 17281         DFHEIV20
 17282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17283
 17284
 17285     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17286
 17287     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17288         MOVE AL-UANON      TO SURVYYNA
 17289     END-IF.
 17290
 17291
 17292     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17293     MOVE '1'                    TO CNTL-REC-TYPE.
 17294     MOVE SPACES                 TO CNTL-ACCESS.
 17295     MOVE +0                     TO CNTL-SEQ-NO.
 17296
 17297
 17298* EXEC CICS READ
 17299*         DATASET  ('ELCNTL')
 17300*         SET      (ADDRESS OF CONTROL-FILE)
 17301*         RIDFLD   (ELCNTL-KEY)
 17302*    END-EXEC.
 17303     MOVE 'ELCNTL' TO DFHEIV1
 17304*    MOVE '&"S        E          (   #00015886' TO DFHEIV0
 17305     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17306     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17307     MOVE X'2020233030303135383836' TO DFHEIV0(25:11)
 17308     CALL 'kxdfhei1' USING DFHEIV0,
 17309           DFHEIV1,
 17310           DFHEIV20,
 17311           DFHEIV99,
 17312           ELCNTL-KEY,
 17313           DFHEIV99,
 17314           DFHEIV99,
 17315           DFHEIV99
 17316     SET ADDRESS OF CONTROL-FILE TO
 17317         DFHEIV20
 17318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17319
 17320
 17321     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17322
 17323 7010-BUILD-MAP.
 17324
 17325
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 332
* EL156.cbl
 17326* EXEC CICS HANDLE CONDITION
 17327*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17328*    END-EXEC.
 17329*    MOVE '"$I                   ! 9 #00015896' TO DFHEIV0
 17330     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17332     MOVE X'3920233030303135383936' TO DFHEIV0(25:11)
 17333     CALL 'kxdfhei1' USING DFHEIV0
 17334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17335
 17336
 17337     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17338     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17339     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17340     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17341     MOVE 'MSTR'                 TO FILE-SWITCH.
 17342
 17343     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17344
 17345     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17346     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17347     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17348     MOVE CL-CCN                 TO PI-SV-CCN.
 17349
 17350     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17351     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17352     MOVE CL-CLAIM-NO            TO CLMNOO.
 17353     MOVE CL-CARRIER             TO CARRO.
 17354     MOVE CL-CERT-PRIME          TO CERTNOO.
 17355     MOVE CL-CERT-SFX            TO SUFXO.
 17356
 17357     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17358        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17359        CONTINUE
 17360     ELSE
 17361        MOVE AL-SADOF            TO ZINTHA
 17362                                    ZINTA
 17363                                    PINTHA
 17364                                    PINTA
 17365     END-IF
 17366     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17367     EVALUATE TRUE
 17368     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17369         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17370     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17371         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17372
 17373     WHEN CL-CLAIM-TYPE = 'I'
 17374         MOVE '  IU  '           TO CLMTYPO
 17375     WHEN CL-CLAIM-TYPE = 'G'
 17376         MOVE ' GAP  '           TO CLMTYPO
 17377     WHEN CL-CLAIM-TYPE = 'F'
 17378         MOVE ' FMLA '           TO CLMTYPO
 17379     END-EVALUATE.
 17380     IF CLAIM-IS-OPEN
 17381         MOVE ' OPEN'            TO CLMSTATO
 17382     ELSE
 17383         MOVE 'CLOSED'           TO CLMSTATO.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 333
* EL156.cbl
 17384
 17385     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17386
 17387     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17388         MOVE SPACES             TO  PCERTNOO
 17389                                     PSUFXO
 17390                                     PRIMHDGO
 17391                                     SEQUO
 17392         MOVE AL-SADOF           TO  PCERTNOA
 17393                                     PSUFXA
 17394                                     PRIMHDGA
 17395                                     SEQUA
 17396     ELSE
 17397         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17398         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17399         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17400         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17401         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17402         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17403         MOVE AL-SANON               TO  PCERTNOA
 17404                                         PSUFXA
 17405                                         PRIMHDGA
 17406         MOVE AL-SABON               TO  SEQUA.
 17407
 17408     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17409
 17410     IF CL-NO-OF-PMTS-MADE = 0 AND
 17411        CL-TOTAL-PAID-AMT = 0
 17412         NEXT SENTENCE
 17413     ELSE
 17414         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17415             IF NOT PI-USES-PAID-TO
 17416                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17417                 MOVE ' '                 TO DC-OPTION-CODE
 17418                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17419                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17420             ELSE
 17421                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17422                 MOVE '6'                 TO DC-OPTION-CODE
 17423                 MOVE +1                  TO DC-ELAPSED-DAYS
 17424                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17425                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17426                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17427
 17428     IF MAP-NAME = 'EL156A'
 17429        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17430           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17431             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17432           end-if
 17433        end-if
 17434     end-if
 17435     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17436         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17437         MOVE ' '                TO DC-OPTION-CODE
 17438         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17439         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17440
 17441     IF CL-INCURRED-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 334
* EL156.cbl
 17442         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17443         MOVE ' '                TO DC-OPTION-CODE
 17444         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17445         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17446
 17447     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17448
 17449     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17450         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17451         MOVE ' '                TO DC-OPTION-CODE
 17452         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17453         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17454
 17455     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17456         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17457         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17458     ELSE
 17459         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17460         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17461
 17462     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17463     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17464     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17465     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17466                                    PI-GROUPING.
 17467     MOVE CL-CERT-STATE          TO CERT-STATE
 17468                                    PI-STATE.
 17469     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17470                                    PI-ACCOUNT.
 17471     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17472     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17473     MOVE 'CERT'                 TO FILE-SWITCH.
 17474
 17475     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17476     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17477        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17478        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17479            MOVE 'N' TO PI-JOINT-INSURED-IND
 17480     ELSE
 17481            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17482     END-IF.
 17483
 17484     perform 7975-read-acct      thru 7975-exit
 17485     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17486     MOVE PI-STATE               TO WS-ST-ACCESS.
 17487     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17488     MOVE '3'                    TO CNTL-REC-TYPE.
 17489     MOVE +0                     TO CNTL-SEQ-NO.
 17490     MOVE 'STAT'                 TO FILE-SWITCH.
 17491
 17492     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17493
 17494     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17495     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17496
 17497     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17498        GO TO 7020-BYPASS-BENEFIT.
 17499
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 335
* EL156.cbl
 17500     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17501     MOVE '4'                    TO CNTL-REC-TYPE.
 17502     MOVE +0                     TO CNTL-SEQ-NO.
 17503     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17504     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17505     MOVE 'BENE'                 TO FILE-SWITCH.
 17506
 17507     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17508
 17509     IF NO-BENEFIT-FOUND
 17510        GO TO 7020-BYPASS-BENEFIT.
 17511
 17512     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17513     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17514     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17515
 17516 7020-BYPASS-BENEFIT.
 17517
 17518*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17519*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17520*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17521
 17522     move zeros                  to PI-MAX-BENEFIT-AMT
 17523     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17524     move cm-ah-orig-term        to pi-ah-term
 17525     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17526     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17527          'G' and 'F'
 17528         GO TO 7021-GO-TO-LIFE.
 17529
 17530     IF (PI-COMPANY-ID = 'DCC')
 17531        and (acct-found)
 17532        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17533        PERFORM 0900-GET-DDF-limits
 17534                                 THRU 0900-EXIT
 17535        IF PDEF-FOUND
 17536           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17537              (P1 > +8)
 17538              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17539           END-PERFORM
 17540           IF P1 < +9
 17541              if pd-ben-pct (p1) not numeric
 17542                 move zeros      to pd-ben-pct (p1)
 17543              end-if
 17544              if pd-ben-pct (p1) = zeros
 17545                 move +1         to ws-work-ben-pct
 17546              else
 17547                 move pd-ben-pct (p1)
 17548                                 to ws-work-ben-pct
 17549              end-if
 17550              compute cm-ah-benefit-amt =
 17551                 cm-ah-benefit-amt * ws-work-ben-pct
 17552              move pd-max-amt (p1) to pi-max-benefit-amt
 17553           END-IF
 17554        END-IF
 17555     end-if
 17556     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17557     MOVE 'MO. BENEFIT :'        TO BENECAPO.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 336
* EL156.cbl
 17558     if (pi-max-benefit-amt not = zeros)
 17559        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17560        move pi-max-benefit-amt  to beneo
 17561     else
 17562        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17563     end-if
 17564     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17565     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17566                                    CP-ORIGINAL-TERM.
 17567     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17568
 17569*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17570*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17571*    ELSE
 17572         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17573
 17574     MOVE ' '                    TO DC-OPTION-CODE.
 17575     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17576     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17577
 17578     IF PI-COMPANY-ID = 'DMD'
 17579         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17580         GO TO 7023-BYPASS-REMAINING-TERM.
 17581
 17582     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17583     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17584     GO TO 7022-AROUND-LIFE.
 17585
 17586 7021-GO-TO-LIFE.
 17587
 17588     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17589     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17590     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17591                                    CP-ORIGINAL-TERM.
 17592     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17593     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17594     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17595     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17596
 17597     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17598         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17599     ELSE
 17600         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17601
 17602     MOVE ' '                    TO DC-OPTION-CODE.
 17603     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17604     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17605
 17606 7022-AROUND-LIFE.
 17607
 17608     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17609     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17610     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17611     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17612     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17613     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17614     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17615
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 337
* EL156.cbl
 17616     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17617
 17618     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17619        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17620           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17621
 17622     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17623        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17624           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17625
 17626 7023-BYPASS-REMAINING-TERM.
 17627     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17628       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17629          MOVE ZEROS                  TO BENEO
 17630       ELSE
 17631          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17632          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17633          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17634          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17635          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17636          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17637          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17638          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17639          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17640          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17641          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17642          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17643          IF (PI-COMPANY-ID = 'DCC')
 17644             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17645             PERFORM 0900-GET-DDF-limits
 17646                                 THRU 0900-EXIT
 17647             IF PDEF-FOUND
 17648                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17649                   (P1 > +8)
 17650                   OR (PD-PROD-CODE (P1) = 'L')
 17651                END-PERFORM
 17652                IF P1 < +9
 17653                   MOVE PD-MAX-AMT (P1)
 17654                                 TO CP-R-MAX-TOT-BEN
 17655                END-IF
 17656             END-IF
 17657          END-IF
 17658
 17659* EXEC CICS LINK
 17660*            PROGRAM  (LINK-REMAMT)
 17661*            COMMAREA (CALCULATION-PASS-AREA)
 17662*            LENGTH   (CP-COMM-LENGTH)
 17663*         END-EXEC
 17664*    MOVE '."C                   (   #00016221' TO DFHEIV0
 17665     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17666     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17667     MOVE X'2020233030303136323231' TO DFHEIV0(25:11)
 17668     CALL 'kxdfhei1' USING DFHEIV0,
 17669           LINK-REMAMT,
 17670           CALCULATION-PASS-AREA,
 17671           CP-COMM-LENGTH,
 17672           DFHEIV99,
 17673           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 338
* EL156.cbl
 17674           DFHEIV99,
 17675           DFHEIV99
 17676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17677          MOVE CP-REMAINING-AMT       TO BENEO
 17678       end-if
 17679     end-if
 17680     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17681     MOVE +95                    TO TRLR-SEQ-NO
 17682
 17683* EXEC CICS READ
 17684*       DATASET  ('ELTRLR')
 17685*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17686*       RIDFLD   (ELTRLR-KEY)
 17687*       RESP     (WS-RESPONSE)
 17688*    END-EXEC
 17689     MOVE 'ELTRLR' TO DFHEIV1
 17690*    MOVE '&"S        E          (  N#00016231' TO DFHEIV0
 17691     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17692     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17693     MOVE X'204E233030303136323331' TO DFHEIV0(25:11)
 17694     CALL 'kxdfhei1' USING DFHEIV0,
 17695           DFHEIV1,
 17696           DFHEIV20,
 17697           DFHEIV99,
 17698           ELTRLR-KEY,
 17699           DFHEIV99,
 17700           DFHEIV99,
 17701           DFHEIV99
 17702     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17703         DFHEIV20
 17704     MOVE EIBRESP  TO WS-RESPONSE
 17705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17706
 17707     if ws-resp-normal
 17708        perform varying s1 from +1 by +1 until
 17709           at-note-error-no (s1) = spaces
 17710           move at-note-error-no (s1)
 17711                                 to emi-error
 17712           if at-note-error-no (s1) = '1653'
 17713              evaluate true
 17714                 when cl-claim-type = 'L'
 17715                    move '  LF  '
 17716                                 to emi-claim-type
 17717                 when cl-claim-type = 'I'
 17718                    move '  IU  '
 17719                                 to emi-claim-type
 17720                 when cl-claim-type = 'F'
 17721                    move ' FMLA '
 17722                                 to emi-claim-type
 17723                 when other
 17724                    move '  AH  '
 17725                                 to emi-claim-type
 17726              end-evaluate
 17727           end-if
 17728           PERFORM 9900-ERROR-FORMAT
 17729                                 THRU 9900-EXIT
 17730        end-perform
 17731     end-if
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 339
* EL156.cbl
 17732     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17733         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17734            WS-LF-COVERAGE-TYPE = 'P'
 17735             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17736                                        CM-LF-ITD-DEATH-AMT
 17737             MOVE WS-REMAINING-AMT  TO  BENEO.
 17738
 17739     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17740     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17741     MOVE WS-TERMS               TO TERMSO.
 17742
 17743     IF WS-STATUS = '6' OR '7' OR '8'
 17744         MOVE AL-SABOF           TO CRTSTATA.
 17745
 17746     IF WS-STATUS = '1' OR '4'
 17747        IF CP-REMAINING-TERM-3 = ZEROS
 17748           MOVE 'EXPIRED'        TO CRTSTATO
 17749        ELSE
 17750           MOVE 'ACTIVE  '       TO CRTSTATO.
 17751
 17752     IF WS-STATUS = '2'
 17753         MOVE 'PEND    '         TO CRTSTATO.
 17754
 17755     IF WS-STATUS = '3'
 17756         MOVE 'RESTORE '         TO CRTSTATO.
 17757
 17758     IF WS-STATUS = '5'
 17759         MOVE 'REISSUE '         TO CRTSTATO.
 17760
 17761     IF WS-STATUS = '6'
 17762         MOVE 'LMP DIS'          TO CRTSTATO.
 17763
 17764     IF WS-STATUS = '7'
 17765         MOVE 'DEATH'            TO CRTSTATO.
 17766
 17767     IF WS-STATUS = '8'
 17768         MOVE 'CANCEL'           TO CRTSTATO.
 17769
 17770     IF WS-STATUS = '9'
 17771         MOVE 'RE-ONLY '         TO CRTSTATO.
 17772
 17773     IF WS-STATUS = 'V'
 17774         MOVE 'VOID  '           TO CRTSTATO.
 17775
 17776     IF WS-STATUS = 'D'
 17777         MOVE 'DECLINE '         TO CRTSTATO.
 17778
 17779     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17780         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17781         MOVE '5'                TO CNTL-REC-TYPE
 17782     ELSE
 17783         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17784         MOVE '4'                TO CNTL-REC-TYPE.
 17785
 17786     MOVE '** NONE **'           TO COVERO.
 17787     MOVE AL-SABON               TO COVERA.
 17788
 17789     IF PI-COMPANY-ID = 'CVL'
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 340
* EL156.cbl
 17790         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17791             MOVE CM-BENEFICIARY TO LOANNOO
 17792             MOVE AL-UANON       TO LOANNOA.
 17793
 17794     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17795        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17796        MOVE +91                 TO  TRLR-SEQ-NO
 17797
 17798* EXEC CICS READ
 17799*           DATASET  ('ELTRLR')
 17800*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17801*           RIDFLD   (ELTRLR-KEY)
 17802*           RESP     (WS-RESPONSE)
 17803*       END-EXEC
 17804     MOVE 'ELTRLR' TO DFHEIV1
 17805*    MOVE '&"S        E          (  N#00016328' TO DFHEIV0
 17806     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17808     MOVE X'204E233030303136333238' TO DFHEIV0(25:11)
 17809     CALL 'kxdfhei1' USING DFHEIV0,
 17810           DFHEIV1,
 17811           DFHEIV20,
 17812           DFHEIV99,
 17813           ELTRLR-KEY,
 17814           DFHEIV99,
 17815           DFHEIV99,
 17816           DFHEIV99
 17817     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17818         DFHEIV20
 17819     MOVE EIBRESP  TO WS-RESPONSE
 17820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17821
 17822        IF WS-RESP-NORMAL
 17823           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17824        ELSE
 17825           MOVE SPACES           TO  LOANNOO
 17826        END-IF
 17827*052506
 17828*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17829*052506
 17830     END-IF
 17831
 17832     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17833        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17834
 17835     IF WS-BEN-CD = ZEROS
 17836         GO TO 7050-SHOW-CONTINUE.
 17837
 17838     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17839     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17840     MOVE +0                     TO CNTL-SEQ-NO.
 17841     MOVE 'BENE'                 TO FILE-SWITCH.
 17842
 17843     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17844
 17845     IF BENEFIT-FOUND
 17846         MOVE CF-JOINT-INDICATOR (SUB-1)  TO PI-JOINT-COV-IND
 17847         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 341
* EL156.cbl
 17848         MOVE AL-SANON                    TO COVERA.
 17849
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 342
* EL156.cbl
 17851 7050-SHOW-CONTINUE.
 17852
 17853     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 17854        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 17855            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 17856     END-IF
 17857
 17858     IF PI-COMPANY-ID = 'DMD'
 17859         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 17860
 17861     MOVE -1                     TO PMTTYPEL.
 17862     GO TO 8100-SEND-INITIAL-MAP.
 17863
 17864 7100-SHOW-RECORD-NOT-FOUND.
 17865     IF FILE-SWITCH = 'MSTR'
 17866         MOVE ER-0204            TO EMI-ERROR.
 17867
 17868     IF FILE-SWITCH = 'CERT'
 17869         MOVE ER-0206            TO EMI-ERROR.
 17870
 17871     IF FILE-SWITCH = 'STAT'
 17872         MOVE ER-0149            TO EMI-ERROR.
 17873
 17874     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17875
 17876     MOVE -1                     TO PMTTYPEL.
 17877     GO TO 8100-SEND-INITIAL-MAP
 17878
 17879     .
 17880 7110-BUILD-PMT-TRLR.
 17881     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17882     MOVE +51                    TO TRLR-SEQ-NO
 17883
 17884* EXEC CICS READ
 17885*        DATASET  ('ELTRLR')
 17886*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17887*        RIDFLD   (ELTRLR-KEY)
 17888*        RESP     (WS-RESPONSE)
 17889*    END-EXEC
 17890     MOVE 'ELTRLR' TO DFHEIV1
 17891*    MOVE '&"S        E          (  N#00016396' TO DFHEIV0
 17892     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17893     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17894     MOVE X'204E233030303136333936' TO DFHEIV0(25:11)
 17895     CALL 'kxdfhei1' USING DFHEIV0,
 17896           DFHEIV1,
 17897           DFHEIV20,
 17898           DFHEIV99,
 17899           ELTRLR-KEY,
 17900           DFHEIV99,
 17901           DFHEIV99,
 17902           DFHEIV99
 17903     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17904         DFHEIV20
 17905     MOVE EIBRESP  TO WS-RESPONSE
 17906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17907     IF WS-RESP-NORMAL
 17908        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 343
* EL156.cbl
 17909     END-IF
 17910     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 17911
 17912* EXEC CICS GETMAIN
 17913*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17914*         LENGTH    (200)
 17915*         INITIMG   (GETMAIN-SPACE)
 17916*     END-EXEC
 17917     MOVE 200
 17918       TO DFHEIV11
 17919*    MOVE ',"IL                  $   #00016406' TO DFHEIV0
 17920     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17921     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17922     MOVE X'2020233030303136343036' TO DFHEIV0(25:11)
 17923     CALL 'kxdfhei1' USING DFHEIV0,
 17924           DFHEIV20,
 17925           DFHEIV11,
 17926           GETMAIN-SPACE
 17927     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17928         DFHEIV20
 17929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17930     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 17931                                    AT-PREV-PAID-THRU-DT
 17932     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 17933     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17934     MOVE 'AT'                   TO AT-RECORD-ID
 17935     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17936     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 17937     MOVE '2'                    TO AT-TRAILER-TYPE
 17938     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17939                                    AT-PAYMENT-LAST-MAINT-DT
 17940     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17941                                    AT-PAYMENT-LAST-UPDATED-BY
 17942     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17943     MOVE 'I'                    TO AT-PAYMENT-TYPE
 17944     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 17945     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 17946     MOVE +0                     TO AT-EXPENSE-PER-PMT
 17947     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 17948     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 17949     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 17950     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 17951     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 17952     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 17953     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 17954     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 17955     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 17956     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 17957     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 17958                                    AT-TO-BE-WRITTEN-DT
 17959     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 17960                                    AT-CHECK-QUE-SEQUENCE
 17961                                    AT-ADDL-RESERVE
 17962     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 17963                                    AT-VOID-SELECT-DT
 17964                                    AT-VOID-ACCEPT-DT
 17965                                    AT-VOID-DT
 17966                                    AT-PMT-PROOF-DT
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 344
* EL156.cbl
 17967                                    AT-INT-PMT-SELECT-DT
 17968     MOVE ZEROS                  TO AT-DAILY-RATE
 17969                                    AT-ELIMINATION-DAYS
 17970     MOVE SPACES                 TO AT-BENEFIT-TYPE
 17971*    EXEC CICS HANDLE CONDITION
 17972*        DUPREC    (7120-DUPREC)
 17973*    END-EXEC
 17974     .
 17975 7115-WRITE-INT-TRLR.
 17976
 17977* EXEC CICS WRITE
 17978*         DATASET       ('ELTRLR')
 17979*         FROM          (ACTIVITY-TRAILERS)
 17980*         RIDFLD        (AT-CONTROL-PRIMARY)
 17981*         RESP          (WS-RESPONSE)
 17982*     END-EXEC
 17983     MOVE LENGTH OF
 17984      ACTIVITY-TRAILERS
 17985       TO DFHEIV11
 17986     MOVE 'ELTRLR' TO DFHEIV1
 17987*    MOVE '&$ L                  ''  N#00016457' TO DFHEIV0
 17988     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17989     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17990     MOVE X'204E233030303136343537' TO DFHEIV0(25:11)
 17991     CALL 'kxdfhei1' USING DFHEIV0,
 17992           DFHEIV1,
 17993           ACTIVITY-TRAILERS,
 17994           DFHEIV11,
 17995           AT-CONTROL-PRIMARY,
 17996           DFHEIV99,
 17997           DFHEIV99
 17998     MOVE EIBRESP  TO WS-RESPONSE
 17999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18000      IF WS-RESP-DUPREC
 18001         GO TO 7120-DUPREC
 18002      END-IF
 18003     GO TO 7130-EXIT
 18004     .
 18005 7120-DUPREC.
 18006     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18007     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18008     GO TO 7115-WRITE-INT-TRLR
 18009     .
 18010 7130-EXIT.
 18011      EXIT.
 18012 7140-BUILD-NOTE-TRLR.
 18013
 18014
 18015* EXEC CICS GETMAIN
 18016*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18017*         LENGTH    (200)
 18018*         INITIMG   (GETMAIN-SPACE)
 18019*     END-EXEC
 18020     MOVE 200
 18021       TO DFHEIV11
 18022*    MOVE ',"IL                  $   #00016477' TO DFHEIV0
 18023     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18024     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 345
* EL156.cbl
 18025     MOVE X'2020233030303136343737' TO DFHEIV0(25:11)
 18026     CALL 'kxdfhei1' USING DFHEIV0,
 18027           DFHEIV20,
 18028           DFHEIV11,
 18029           GETMAIN-SPACE
 18030     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18031         DFHEIV20
 18032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18033     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18034     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18035     MOVE 'AT'                   TO AT-RECORD-ID
 18036     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18037     MOVE '6'                    TO AT-TRAILER-TYPE
 18038     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18039                                    AT-GEN-INFO-LAST-MAINT-DT
 18040     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18041                                    AT-GEN-INFO-LAST-UPDATED-BY
 18042     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18043     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18044     .
 18045 7150-WRITE.
 18046
 18047* EXEC CICS HANDLE CONDITION
 18048*        DUPREC    (7160-DUPREC)
 18049*    END-EXEC
 18050*    MOVE '"$%                   ! : #00016495' TO DFHEIV0
 18051     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18052     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18053     MOVE X'3A20233030303136343935' TO DFHEIV0(25:11)
 18054     CALL 'kxdfhei1' USING DFHEIV0
 18055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18056
 18057* EXEC CICS WRITE
 18058*         DATASET     ('ELTRLR')
 18059*         FROM        (ACTIVITY-TRAILERS)
 18060*         RIDFLD      (AT-CONTROL-PRIMARY)
 18061*         RESP        (WS-RESPONSE)
 18062*     END-EXEC
 18063     MOVE LENGTH OF
 18064      ACTIVITY-TRAILERS
 18065       TO DFHEIV11
 18066     MOVE 'ELTRLR' TO DFHEIV1
 18067*    MOVE '&$ L                  ''  N#00016498' TO DFHEIV0
 18068     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18069     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18070     MOVE X'204E233030303136343938' TO DFHEIV0(25:11)
 18071     CALL 'kxdfhei1' USING DFHEIV0,
 18072           DFHEIV1,
 18073           ACTIVITY-TRAILERS,
 18074           DFHEIV11,
 18075           AT-CONTROL-PRIMARY,
 18076           DFHEIV99,
 18077           DFHEIV99
 18078     MOVE EIBRESP  TO WS-RESPONSE
 18079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18080      IF WS-RESP-DUPREC
 18081         GO TO 7160-DUPREC
 18082      END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 346
* EL156.cbl
 18083     GO TO 7170-EXIT
 18084     .
 18085 7160-DUPREC.
 18086     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18087     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18088     GO TO 7150-WRITE
 18089     .
 18090 7170-EXIT.
 18091      EXIT.
 18092
 18093 7180-ADD-CERT-NOTE.
 18094*ADD CERT NOTE FOR SC NP+6
 18095
 18096
 18097* EXEC CICS GETMAIN
 18098*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18099*         LENGTH    (150)
 18100*         INITIMG   (GETMAIN-SPACE)
 18101*     END-EXEC.
 18102     MOVE 150
 18103       TO DFHEIV11
 18104*    MOVE ',"IL                  $   #00016520' TO DFHEIV0
 18105     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18106     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18107     MOVE X'2020233030303136353230' TO DFHEIV0(25:11)
 18108     CALL 'kxdfhei1' USING DFHEIV0,
 18109           DFHEIV20,
 18110           DFHEIV11,
 18111           GETMAIN-SPACE
 18112     SET ADDRESS OF CERT-NOTE-FILE TO
 18113         DFHEIV20
 18114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18115
 18116
 18117     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18118     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18119     MOVE +1                     TO WRK-NOTE-SEQ.
 18120     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18121     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18122     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18123     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18124     MOVE CL-CERT-STATE          TO CZ-STATE.
 18125     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18126     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18127     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18128     MOVE '2'                    TO CZ-RECORD-TYPE.
 18129     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18130     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18131     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18132     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18133     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18134     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18135     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18136     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18137     IF PI-COMPANY-ID = 'AHL'
 18138        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18139           CONTINUE
 18140        ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 347
* EL156.cbl
 18141           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18142              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18143           ELSE
 18144              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18145           END-IF
 18146        END-IF
 18147     END-IF
 18148     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18149     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18150
 18151 7181-WRITE.
 18152
 18153
 18154* EXEC CICS WRITE
 18155*         DATASET     ('ERCNOT')
 18156*         FROM        (CERT-NOTE-FILE)
 18157*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18158*         RESP        (WS-RESPONSE)
 18159*    END-EXEC.
 18160     MOVE LENGTH OF
 18161      CERT-NOTE-FILE
 18162       TO DFHEIV11
 18163     MOVE 'ERCNOT' TO DFHEIV1
 18164*    MOVE '&$ L                  ''  N#00016562' TO DFHEIV0
 18165     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18166     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18167     MOVE X'204E233030303136353632' TO DFHEIV0(25:11)
 18168     CALL 'kxdfhei1' USING DFHEIV0,
 18169           DFHEIV1,
 18170           CERT-NOTE-FILE,
 18171           DFHEIV11,
 18172           CZ-CONTROL-PRIMARY,
 18173           DFHEIV99,
 18174           DFHEIV99
 18175     MOVE EIBRESP  TO WS-RESPONSE
 18176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18177
 18178
 18179     IF WS-RESP-DUPREC
 18180         GO TO 7182-DUPREC
 18181     END-IF.
 18182
 18183     SET CERT-NOTE-ADDED TO TRUE.
 18184
 18185     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18186         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18187     END-IF.
 18188
 18189     GO TO 7189-EXIT.
 18190
 18191 7182-DUPREC.
 18192
 18193     ADD +1                      TO  WRK-NOTE-SEQ.
 18194     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18195     GO TO 7181-WRITE.
 18196
 18197 7189-EXIT.
 18198      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 348
* EL156.cbl
 18199
 18200 7190-ADD-ORIG-NOTE.
 18201
 18202
 18203* EXEC CICS GETMAIN
 18204*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18205*         LENGTH    (150)
 18206*         INITIMG   (GETMAIN-SPACE)
 18207*     END-EXEC.
 18208     MOVE 150
 18209       TO DFHEIV11
 18210*    MOVE ',"IL                  $   #00016592' TO DFHEIV0
 18211     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18212     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18213     MOVE X'2020233030303136353932' TO DFHEIV0(25:11)
 18214     CALL 'kxdfhei1' USING DFHEIV0,
 18215           DFHEIV20,
 18216           DFHEIV11,
 18217           GETMAIN-SPACE
 18218     SET ADDRESS OF CERT-NOTE-FILE TO
 18219         DFHEIV20
 18220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18221
 18222
 18223     ADD +1                      TO WRK-NOTE-SEQ.
 18224     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18225     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18226     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18227     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18228     MOVE CL-CERT-STATE          TO CZ-STATE.
 18229     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18230     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18231     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18232     MOVE '2'                    TO CZ-RECORD-TYPE.
 18233     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18234     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18235     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18236     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18237     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18238     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18239
 18240 7191-WRITE.
 18241
 18242
 18243* EXEC CICS WRITE
 18244*         DATASET     ('ERCNOT')
 18245*         FROM        (CERT-NOTE-FILE)
 18246*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18247*         RESP        (WS-RESPONSE)
 18248*    END-EXEC.
 18249     MOVE LENGTH OF
 18250      CERT-NOTE-FILE
 18251       TO DFHEIV11
 18252     MOVE 'ERCNOT' TO DFHEIV1
 18253*    MOVE '&$ L                  ''  N#00016617' TO DFHEIV0
 18254     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18255     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18256     MOVE X'204E233030303136363137' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 349
* EL156.cbl
 18257     CALL 'kxdfhei1' USING DFHEIV0,
 18258           DFHEIV1,
 18259           CERT-NOTE-FILE,
 18260           DFHEIV11,
 18261           CZ-CONTROL-PRIMARY,
 18262           DFHEIV99,
 18263           DFHEIV99
 18264     MOVE EIBRESP  TO WS-RESPONSE
 18265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18266
 18267
 18268     IF WS-RESP-DUPREC
 18269         GO TO 7192-DUPREC
 18270     END-IF.
 18271
 18272     GO TO 7199-EXIT.
 18273
 18274 7192-DUPREC.
 18275
 18276     ADD +1                      TO  WRK-NOTE-SEQ.
 18277     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18278     GO TO 7191-WRITE.
 18279
 18280 7199-EXIT.
 18281      EXIT.
 18282 7200-FIND-BENEFIT.
 18283     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18284
 18285
 18286* EXEC CICS HANDLE CONDITION
 18287*        ENDFILE(7200-EXIT)
 18288*        NOTFND(7200-EXIT)
 18289*    END-EXEC.
 18290*    MOVE '"$''I                  ! ; #00016641' TO DFHEIV0
 18291     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18292     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18293     MOVE X'3B20233030303136363431' TO DFHEIV0(25:11)
 18294     CALL 'kxdfhei1' USING DFHEIV0
 18295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18296
 18297
 18298
 18299* EXEC CICS READ
 18300*        DATASET('ELCNTL')
 18301*        SET(ADDRESS OF CONTROL-FILE)
 18302*        RIDFLD(ELCNTL-KEY)
 18303*        GTEQ
 18304*    END-EXEC.
 18305     MOVE 'ELCNTL' TO DFHEIV1
 18306*    MOVE '&"S        G          (   #00016646' TO DFHEIV0
 18307     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18308     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18309     MOVE X'2020233030303136363436' TO DFHEIV0(25:11)
 18310     CALL 'kxdfhei1' USING DFHEIV0,
 18311           DFHEIV1,
 18312           DFHEIV20,
 18313           DFHEIV99,
 18314           ELCNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 350
* EL156.cbl
 18315           DFHEIV99,
 18316           DFHEIV99,
 18317           DFHEIV99
 18318     SET ADDRESS OF CONTROL-FILE TO
 18319         DFHEIV20
 18320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18321
 18322
 18323     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18324        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18325           GO TO 7200-EXIT.
 18326
 18327     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18328         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18329            ((SUB-1 > 8) OR
 18330            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18331
 18332     IF SUB-1 NOT = 9
 18333         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18334
 18335     GO TO 7200-EXIT.
 18336
 18337 7200-BENEFIT-DUMMY.
 18338
 18339 7200-DUMMY-EXIT.
 18340     EXIT.
 18341
 18342 7200-EXIT.
 18343     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 351
* EL156.cbl
 18345*052506
 18346*052506 7250-FIND-LETTER-TRLR.
 18347*052506     EXEC CICS HANDLE CONDITION
 18348*052506         ENDFILE  (7250-END)
 18349*052506         NOTFND   (7250-END)
 18350*052506     END-EXEC.
 18351*052506
 18352*052506     EXEC CICS STARTBR
 18353*052506         DATASET   ('ELTRLR')
 18354*052506         RIDFLD    (ELTRLR-KEY)
 18355*052506         GTEQ
 18356*052506     END-EXEC.
 18357*052506
 18358*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18359*052506
 18360*052506 7250-FIND-LOOP.
 18361*052506     EXEC CICS READNEXT
 18362*052506         DATASET   ('ELTRLR')
 18363*052506         RIDFLD    (ELTRLR-KEY)
 18364*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18365*052506     END-EXEC.
 18366*052506
 18367*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18368*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18369*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18370*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18371*052506        GO TO 7250-END
 18372*052506     END-IF.
 18373*052506
 18374*052506     IF AT-TRAILER-TYPE NOT = '4'
 18375*052506         GO TO 7250-FIND-LOOP
 18376*052506     END-IF.
 18377*052506
 18378*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18379*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18380*052506     END-IF.
 18381*052506
 18382*052506     GO TO 7250-FIND-LOOP.
 18383*052506
 18384*052506 7250-END.
 18385*052506
 18386*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18387*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18388*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18389*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18390*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18391*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18392*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18393*052506     END-IF.
 18394*052506
 18395*052506     EXEC CICS ENDBR
 18396*052506          DATASET    ('ELTRLR')
 18397*052506     END-EXEC.
 18398*052506
 18399*052506 7250-EXIT.
 18400*052506     EXIT.
 18401*052506     EJECT
 18402*052506
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 352
* EL156.cbl
 18403 7300-CHECK-AUTO-ACTIVITY.
 18404
 18405     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18406         NEXT SENTENCE
 18407     ELSE
 18408         GO TO 7399-EXIT.
 18409
 18410     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18411
 18412     IF WS-ACT-REC-FOUND-SW = 'N'
 18413         GO TO 7399-EXIT.
 18414
 18415     IF PI-ACTIVITY-CODE = 09
 18416         GO TO 7300-CONT-AUTO-ACTIVITY.
 18417
 18418     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18419        (PI-ACTIVITY-CODE = 11)
 18420         GO TO 7300-CONT-AUTO-ACTIVITY.
 18421
 18422     IF PI-PROVISIONAL-IND = 'P'
 18423         IF PI-PMTTYPE = '1'
 18424             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18425                 MOVE 'N'    TO  PI-RESET-SW
 18426                 GO TO 7399-EXIT.
 18427
 18428     IF PI-PMTTYPE = '1'
 18429         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18430             MOVE 'N'        TO  PI-RESET-SW
 18431             GO TO 7399-EXIT.
 18432
 18433     IF PI-PMTTYPE = '2' OR '3'
 18434         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18435             MOVE 'N'        TO  PI-RESET-SW
 18436             GO TO 7399-EXIT.
 18437
 18438     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18439         IF PI-PROVISIONAL-IND = 'P'
 18440             NEXT SENTENCE
 18441         ELSE
 18442             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18443
 18444 7300-CONT-AUTO-ACTIVITY.
 18445
 18446     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18447         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18448         MOVE '4'            TO DC-OPTION-CODE
 18449         MOVE +0             TO DC-ELAPSED-DAYS
 18450                                DC-ELAPSED-MONTHS
 18451         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18452         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18453         IF PI-USES-PAID-TO
 18454             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18455             IF NO-CONVERSION-ERROR
 18456                 MOVE +1     TO DC-ELAPSED-DAYS
 18457                 MOVE +0     TO DC-ELAPSED-MONTHS
 18458                 MOVE '6'    TO DC-OPTION-CODE
 18459                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18460                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 353
* EL156.cbl
 18461                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18462
 18463     IF PI-PFKEY-USED = DFHPF5
 18464         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18465         IF PI-USES-PAID-TO
 18466             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18467             MOVE +1                  TO DC-ELAPSED-DAYS
 18468             MOVE +0                  TO DC-ELAPSED-MONTHS
 18469             MOVE '6'                 TO DC-OPTION-CODE
 18470             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18471             IF NO-CONVERSION-ERROR
 18472                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18473
 18474     IF WS-CHK-THRU-DT < PI-EXP-DT
 18475         NEXT SENTENCE
 18476     ELSE
 18477         MOVE 03                     TO  WS-ACTIVITY-CODE
 18478         GO TO 7390-PROCESS-ACTIVITY.
 18479
 18480     IF PI-PROV-PMT
 18481         MOVE 09                     TO  WS-ACTIVITY-CODE
 18482     ELSE
 18483        IF PI-PMTTYPE = '1'
 18484            MOVE 02                  TO  WS-ACTIVITY-CODE
 18485        ELSE
 18486        IF PI-PMTTYPE = '2' OR '3'
 18487            MOVE 07                  TO  WS-ACTIVITY-CODE
 18488        ELSE
 18489        IF PI-PMTTYPE = '4'
 18490            MOVE 00                  TO  WS-ACTIVITY-CODE
 18491        ELSE
 18492            MOVE 'N'                 TO  PI-RESET-SW
 18493            GO TO 7399-EXIT.
 18494
 18495 7390-PROCESS-ACTIVITY.
 18496
 18497     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18498
 18499 7399-EXIT.
 18500     EXIT.
 18501
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 354
* EL156.cbl
 18503 7400-CHECK-AUTO-ACTIVITY.
 18504
 18505
 18506* EXEC CICS HANDLE CONDITION
 18507*        NOTFND   (7400-NOT-FOUND)
 18508*    END-EXEC.
 18509*    MOVE '"$I                   ! < #00016835' TO DFHEIV0
 18510     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18511     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18512     MOVE X'3C20233030303136383335' TO DFHEIV0(25:11)
 18513     CALL 'kxdfhei1' USING DFHEIV0
 18514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18515
 18516
 18517     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18518     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18519     MOVE SPACES                 TO  CNTL-ACCESS.
 18520     MOVE +0                     TO  CNTL-SEQ-NO.
 18521
 18522
 18523* EXEC CICS READ
 18524*        DATASET   ('ELCNTL')
 18525*        RIDFLD    (ELCNTL-KEY)
 18526*        SET       (ADDRESS OF CONTROL-FILE)
 18527*    END-EXEC.
 18528     MOVE 'ELCNTL' TO DFHEIV1
 18529*    MOVE '&"S        E          (   #00016844' TO DFHEIV0
 18530     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18531     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18532     MOVE X'2020233030303136383434' TO DFHEIV0(25:11)
 18533     CALL 'kxdfhei1' USING DFHEIV0,
 18534           DFHEIV1,
 18535           DFHEIV20,
 18536           DFHEIV99,
 18537           ELCNTL-KEY,
 18538           DFHEIV99,
 18539           DFHEIV99,
 18540           DFHEIV99
 18541     SET ADDRESS OF CONTROL-FILE TO
 18542         DFHEIV20
 18543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18544
 18545
 18546     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18547     GO TO 7400-EXIT.
 18548
 18549 7400-NOT-FOUND.
 18550     MOVE 'N'                        TO  PI-RESET-SW
 18551                                         WS-LETTER-SW
 18552                                         WS-ACT-REC-FOUND-SW.
 18553
 18554     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18555
 18556 7400-EXIT.
 18557     EXIT.
 18558
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 355
* EL156.cbl
 18560 7450-FORMAT-AUTO-LETTER.
 18561
 18562     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18563         MOVE 'Y'                    TO PI-RESET-SW
 18564         GO TO 7450-CONTINUE-PROCESS.
 18565
 18566     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18567
 18568     IF SUB > 9
 18569         SUBTRACT 9 FROM SUB
 18570         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18571     ELSE
 18572         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18573
 18574 7450-CONTINUE-PROCESS.
 18575
 18576     IF WS-ACTIVITY-CODE = ZEROS
 18577         MOVE 'N'                    TO  WS-LETTER-SW
 18578         GO TO 7450-EXIT.
 18579
 18580     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18581
 18582     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18583         MOVE 'N'                    TO  PI-RESET-SW
 18584                                         WS-LETTER-SW
 18585         GO TO 7450-EXIT.
 18586
 18587     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18588         MOVE 'N'                    TO  WS-LETTER-SW
 18589         GO TO 7450-EXIT.
 18590
 18591     MOVE 'Y'                        TO  WS-LETTER-SW.
 18592     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18593     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18594
 18595     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18596
 18597     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18598         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18599         MOVE '6'                    TO  DC-OPTION-CODE
 18600         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18601         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18602         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18603         IF NO-CONVERSION-ERROR
 18604             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18605         ELSE
 18606              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18607
 18608     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18609         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18610         MOVE '6'                    TO  DC-OPTION-CODE
 18611         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18612         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18613         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18614         IF NO-CONVERSION-ERROR
 18615             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18616         ELSE
 18617             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 356
* EL156.cbl
 18618
 18619 7450-EXIT.
 18620     EXIT.
 18621
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 357
* EL156.cbl
 18623 7500-RESET-AUTO-ACTIVITY.
 18624
 18625     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18626     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18627     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18628     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18629     MOVE +100                   TO  TRLR-SEQ-NO.
 18630
 18631 7500-STARTBR-TRLR.
 18632
 18633
 18634* EXEC CICS HANDLE CONDITION
 18635*        ENDFILE  (7590-END)
 18636*        NOTFND   (7590-END)
 18637*    END-EXEC.
 18638*    MOVE '"$''I                  ! = #00016937' TO DFHEIV0
 18639     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18640     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18641     MOVE X'3D20233030303136393337' TO DFHEIV0(25:11)
 18642     CALL 'kxdfhei1' USING DFHEIV0
 18643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18644
 18645
 18646
 18647* EXEC CICS STARTBR
 18648*        DATASET   ('ELTRLR')
 18649*        RIDFLD    (ELTRLR-KEY)
 18650*        GTEQ
 18651*    END-EXEC.
 18652     MOVE 'ELTRLR' TO DFHEIV1
 18653     MOVE 0
 18654       TO DFHEIV11
 18655*    MOVE '&,         G          &   #00016942' TO DFHEIV0
 18656     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18657     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18658     MOVE X'2020233030303136393432' TO DFHEIV0(25:11)
 18659     CALL 'kxdfhei1' USING DFHEIV0,
 18660           DFHEIV1,
 18661           ELTRLR-KEY,
 18662           DFHEIV99,
 18663           DFHEIV11,
 18664           DFHEIV99
 18665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18666
 18667
 18668     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18669
 18670 7500-READ-NEXT.
 18671
 18672
 18673* EXEC CICS READNEXT
 18674*        DATASET   ('ELTRLR')
 18675*        RIDFLD    (ELTRLR-KEY)
 18676*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18677*    END-EXEC.
 18678     MOVE 'ELTRLR' TO DFHEIV1
 18679     MOVE 0
 18680       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 358
* EL156.cbl
 18681*    MOVE '&.S                   )   #00016952' TO DFHEIV0
 18682     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18683     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18684     MOVE X'2020233030303136393532' TO DFHEIV0(25:11)
 18685     CALL 'kxdfhei1' USING DFHEIV0,
 18686           DFHEIV1,
 18687           DFHEIV20,
 18688           DFHEIV99,
 18689           ELTRLR-KEY,
 18690           DFHEIV99,
 18691           DFHEIV11,
 18692           DFHEIV99,
 18693           DFHEIV99
 18694     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18695         DFHEIV20
 18696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18697
 18698
 18699     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18700        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18701        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18702        PI-CERT-NO    NOT = TRLR-CERT-NO
 18703         GO TO 7590-END.
 18704
 18705     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18706         GO TO 7500-READ-NEXT.
 18707
 18708     IF AT-TRAILER-TYPE NOT = '4'
 18709         GO TO 7500-READ-NEXT.
 18710
 18711     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18712         GO TO 7500-READ-NEXT.
 18713
 18714     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18715        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18716         GO TO 7500-READ-NEXT.
 18717
 18718     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18719        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18720        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18721         GO TO 7500-READ-NEXT.
 18722
 18723     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18724                         AND
 18725        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18726                         AND
 18727        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18728            GO TO 7500-READ-NEXT.
 18729
 18730     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18731
 18732
 18733* EXEC CICS ENDBR
 18734*        DATASET   ('ELTRLR')
 18735*    END-EXEC.
 18736     MOVE 'ELTRLR' TO DFHEIV1
 18737     MOVE 0
 18738       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 359
* EL156.cbl
 18739*    MOVE '&2                    $   #00016991' TO DFHEIV0
 18740     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18741     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18742     MOVE X'2020233030303136393931' TO DFHEIV0(25:11)
 18743     CALL 'kxdfhei1' USING DFHEIV0,
 18744           DFHEIV1,
 18745           DFHEIV11,
 18746           DFHEIV99
 18747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18748
 18749
 18750     MOVE 'N'                        TO  WS-BROWSE-SW.
 18751
 18752
 18753* EXEC CICS READ
 18754*        DATASET   ('ELTRLR')
 18755*        RIDFLD    (ELTRLR-KEY)
 18756*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18757*        UPDATE
 18758*    END-EXEC.
 18759     MOVE 'ELTRLR' TO DFHEIV1
 18760*    MOVE '&"S        EU         (   #00016997' TO DFHEIV0
 18761     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18762     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18763     MOVE X'2020233030303136393937' TO DFHEIV0(25:11)
 18764     CALL 'kxdfhei1' USING DFHEIV0,
 18765           DFHEIV1,
 18766           DFHEIV20,
 18767           DFHEIV99,
 18768           ELTRLR-KEY,
 18769           DFHEIV99,
 18770           DFHEIV99,
 18771           DFHEIV99
 18772     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18773         DFHEIV20
 18774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18775
 18776
 18777     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18778
 18779     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18780         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18781     ELSE
 18782         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18783             NEXT SENTENCE
 18784         ELSE
 18785             GO TO 7500-REWRITE-TRLR.
 18786
 18787     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18788
 18789     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18790     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18791     MOVE '1'                        TO  ARCH-REC-TYPE.
 18792     MOVE +0                         TO  ARCH-SEQ.
 18793
 18794     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18795
 18796 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 360
* EL156.cbl
 18797
 18798
 18799* EXEC CICS REWRITE
 18800*        DATASET   ('ELTRLR')
 18801*        FROM      (ACTIVITY-TRAILERS)
 18802*    END-EXEC.
 18803     MOVE LENGTH OF
 18804      ACTIVITY-TRAILERS
 18805       TO DFHEIV11
 18806     MOVE 'ELTRLR' TO DFHEIV1
 18807*    MOVE '&& L                  %   #00017025' TO DFHEIV0
 18808     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18809     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18810     MOVE X'2020233030303137303235' TO DFHEIV0(25:11)
 18811     CALL 'kxdfhei1' USING DFHEIV0,
 18812           DFHEIV1,
 18813           ACTIVITY-TRAILERS,
 18814           DFHEIV11,
 18815           DFHEIV99
 18816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18817
 18818
 18819     GO TO 7500-STARTBR-TRLR.
 18820
 18821 7590-END.
 18822
 18823     IF WS-BROWSE-SW = 'Y'
 18824         MOVE 'N'                    TO  WS-BROWSE-SW
 18825
 18826* EXEC CICS ENDBR
 18827*            DATASET   ('ELTRLR')
 18828*        END-EXEC.
 18829     MOVE 'ELTRLR' TO DFHEIV1
 18830     MOVE 0
 18831       TO DFHEIV11
 18832*    MOVE '&2                    $   #00017036' TO DFHEIV0
 18833     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18834     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18835     MOVE X'2020233030303137303336' TO DFHEIV0(25:11)
 18836     CALL 'kxdfhei1' USING DFHEIV0,
 18837           DFHEIV1,
 18838           DFHEIV11,
 18839           DFHEIV99
 18840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18841
 18842
 18843 7599-EXIT.
 18844     EXIT.
 18845
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 361
* EL156.cbl
 18847 7600-READ-ARCH-UPDATE.
 18848
 18849
 18850* EXEC CICS HANDLE CONDITION
 18851*        NOTFND   (7699-EXIT)
 18852*    END-EXEC.
 18853*    MOVE '"$I                   ! > #00017046' TO DFHEIV0
 18854     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18855     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18856     MOVE X'3E20233030303137303436' TO DFHEIV0(25:11)
 18857     CALL 'kxdfhei1' USING DFHEIV0
 18858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18859
 18860
 18861
 18862* EXEC CICS READ
 18863*        DATASET   ('ELARCH')
 18864*        RIDFLD    (ELARCH-KEY)
 18865*        SET       (ADDRESS OF LETTER-ARCHIVE)
 18866*        UPDATE
 18867*    END-EXEC.
 18868     MOVE 'ELARCH' TO DFHEIV1
 18869*    MOVE '&"S        EU         (   #00017050' TO DFHEIV0
 18870     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18871     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18872     MOVE X'2020233030303137303530' TO DFHEIV0(25:11)
 18873     CALL 'kxdfhei1' USING DFHEIV0,
 18874           DFHEIV1,
 18875           DFHEIV20,
 18876           DFHEIV99,
 18877           ELARCH-KEY,
 18878           DFHEIV99,
 18879           DFHEIV99,
 18880           DFHEIV99
 18881     SET ADDRESS OF LETTER-ARCHIVE TO
 18882         DFHEIV20
 18883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18884
 18885
 18886     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 18887
 18888
 18889* EXEC CICS REWRITE
 18890*        DATASET   ('ELARCH')
 18891*        FROM      (LETTER-ARCHIVE)
 18892*    END-EXEC.
 18893     MOVE LENGTH OF
 18894      LETTER-ARCHIVE
 18895       TO DFHEIV11
 18896     MOVE 'ELARCH' TO DFHEIV1
 18897*    MOVE '&& L                  %   #00017059' TO DFHEIV0
 18898     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18899     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18900     MOVE X'2020233030303137303539' TO DFHEIV0(25:11)
 18901     CALL 'kxdfhei1' USING DFHEIV0,
 18902           DFHEIV1,
 18903           LETTER-ARCHIVE,
 18904           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 362
* EL156.cbl
 18905           DFHEIV99
 18906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18907
 18908
 18909 7699-EXIT.
 18910     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 363
* EL156.cbl
 18912 7700-GET-DCT.
 18913
 18914     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 18915     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 18916     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 18917     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 18918                                    PI-MAX-BENEFIT-AMT
 18919                                    PI-MAX-BENEFIT-PYMT
 18920                                    PI-MIN-PAYMENT-AMT
 18921                                    PI-TIME-OF-LOSS-BAL.
 18922
 18923
 18924* EXEC CICS HANDLE CONDITION
 18925*         NOTFND (5300-NOTE-NOT-FOUND)
 18926*     END-EXEC.
 18927*    MOVE '"$I                   ! ? #00017078' TO DFHEIV0
 18928     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18929     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18930     MOVE X'3F20233030303137303738' TO DFHEIV0(25:11)
 18931     CALL 'kxdfhei1' USING DFHEIV0
 18932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18933
 18934
 18935
 18936* EXEC CICS READ
 18937*         DATASET('ERNOTE')
 18938*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 18939*         RIDFLD (W-NOTE-KEY)
 18940*     END-EXEC.
 18941     MOVE 'ERNOTE' TO DFHEIV1
 18942*    MOVE '&"S        E          (   #00017082' TO DFHEIV0
 18943     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18944     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18945     MOVE X'2020233030303137303832' TO DFHEIV0(25:11)
 18946     CALL 'kxdfhei1' USING DFHEIV0,
 18947           DFHEIV1,
 18948           DFHEIV20,
 18949           DFHEIV99,
 18950           W-NOTE-KEY,
 18951           DFHEIV99,
 18952           DFHEIV99,
 18953           DFHEIV99
 18954     SET ADDRESS OF CERTIFICATE-NOTE TO
 18955         DFHEIV20
 18956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18957
 18958
 18959     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 18960     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 18961     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 18962     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 18963     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 18964
 18965     IF PI-PAYEE-TYPE NOT = 'B'
 18966         GO TO 7700-EXIT.
 18967
 18968     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 18969     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 364
* EL156.cbl
 18970     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 18971
 18972     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 18973         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 18974     ELSE
 18975         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 18976
 18977     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 18978     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 18979     MOVE 'DLO006'               TO PGM-NAME.
 18980
 18981
 18982* EXEC CICS LINK
 18983*        PROGRAM    (PGM-NAME)
 18984*        COMMAREA   (DCT-COMMUNICATION-AREA)
 18985*        LENGTH     (DCT-RCRD-LENGTH)
 18986*    END-EXEC.
 18987*    MOVE '."C                   (   #00017110' TO DFHEIV0
 18988     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18989     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18990     MOVE X'2020233030303137313130' TO DFHEIV0(25:11)
 18991     CALL 'kxdfhei1' USING DFHEIV0,
 18992           PGM-NAME,
 18993           DCT-COMMUNICATION-AREA,
 18994           DCT-RCRD-LENGTH,
 18995           DFHEIV99,
 18996           DFHEIV99,
 18997           DFHEIV99,
 18998           DFHEIV99
 18999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19000
 19001
 19002     IF DCT-RETURN-CODE = 'OK'
 19003         GO TO 7700-CONT.
 19004
 19005     IF DCT-RETURN-CODE = '01' OR '02'
 19006         GO TO 7700-SET-TO-YES.
 19007
 19008     IF DCT-RETURN-CODE = '03'
 19009
 19010* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19011*    MOVE '6"R                   !   #00017123' TO DFHEIV0
 19012     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19013     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19014     MOVE X'2020233030303137313233' TO DFHEIV0(25:11)
 19015     CALL 'kxdfhei1' USING DFHEIV0
 19016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19017         MOVE ER-0951            TO EMI-ERROR
 19018         MOVE -1                 TO PMTTYPEL
 19019         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19020         GO TO 8200-SEND-DATAONLY.
 19021
 19022     IF DCT-RETURN-CODE = '04'
 19023
 19024* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19025*    MOVE '6"R                   !   #00017130' TO DFHEIV0
 19026     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19027     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 365
* EL156.cbl
 19028     MOVE X'2020233030303137313330' TO DFHEIV0(25:11)
 19029     CALL 'kxdfhei1' USING DFHEIV0
 19030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19031         MOVE ER-0946            TO EMI-ERROR
 19032         MOVE -1                 TO PMTTYPEL
 19033         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19034         GO TO 8200-SEND-DATAONLY.
 19035
 19036     IF DCT-RETURN-CODE = '05'
 19037
 19038* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19039*    MOVE '6"R                   !   #00017137' TO DFHEIV0
 19040     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19042     MOVE X'2020233030303137313337' TO DFHEIV0(25:11)
 19043     CALL 'kxdfhei1' USING DFHEIV0
 19044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19045         MOVE ER-0947            TO EMI-ERROR
 19046         MOVE -1                 TO PMTTYPEL
 19047         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19048         GO TO 8200-SEND-DATAONLY.
 19049
 19050     IF DCT-RETURN-CODE = '06'
 19051
 19052* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19053*    MOVE '6"R                   !   #00017144' TO DFHEIV0
 19054     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19055     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19056     MOVE X'2020233030303137313434' TO DFHEIV0(25:11)
 19057     CALL 'kxdfhei1' USING DFHEIV0
 19058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19059         MOVE ER-0921            TO EMI-ERROR
 19060         MOVE -1                 TO PMTTYPEL
 19061         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19062         GO TO 8200-SEND-DATAONLY.
 19063
 19064     IF DCT-RETURN-CODE = '07'
 19065
 19066* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19067*    MOVE '6"R                   !   #00017151' TO DFHEIV0
 19068     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19069     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19070     MOVE X'2020233030303137313531' TO DFHEIV0(25:11)
 19071     CALL 'kxdfhei1' USING DFHEIV0
 19072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19073         MOVE ER-0919            TO EMI-ERROR
 19074         MOVE -1                 TO PMTTYPEL
 19075         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19076         GO TO 8200-SEND-DATAONLY.
 19077
 19078     IF DCT-RETURN-CODE = '08'
 19079
 19080* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19081*    MOVE '6"R                   !   #00017158' TO DFHEIV0
 19082     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19083     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19084     MOVE X'2020233030303137313538' TO DFHEIV0(25:11)
 19085     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 366
* EL156.cbl
 19086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19087         MOVE ER-0948            TO EMI-ERROR
 19088         MOVE -1                 TO PMTTYPEL
 19089         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19090         GO TO 8200-SEND-DATAONLY.
 19091
 19092     IF DCT-RETURN-CODE = 'N1'
 19093
 19094* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19095*    MOVE '6"R                   !   #00017165' TO DFHEIV0
 19096     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19097     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19098     MOVE X'2020233030303137313635' TO DFHEIV0(25:11)
 19099     CALL 'kxdfhei1' USING DFHEIV0
 19100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19101         MOVE ER-0950            TO EMI-ERROR
 19102         MOVE -1                 TO PMTTYPEL
 19103         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19104         GO TO 8200-SEND-DATAONLY.
 19105
 19106     IF DCT-RETURN-CODE = 'E1'
 19107
 19108* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19109*    MOVE '6"R                   !   #00017172' TO DFHEIV0
 19110     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19111     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19112     MOVE X'2020233030303137313732' TO DFHEIV0(25:11)
 19113     CALL 'kxdfhei1' USING DFHEIV0
 19114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19115         MOVE ER-0974            TO EMI-ERROR
 19116         MOVE -1                 TO PMTTYPEL
 19117         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19118         GO TO 8200-SEND-DATAONLY.
 19119
 19120     IF DCT-RETURN-CODE = 'E2'
 19121
 19122* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19123*    MOVE '6"R                   !   #00017179' TO DFHEIV0
 19124     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19125     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19126     MOVE X'2020233030303137313739' TO DFHEIV0(25:11)
 19127     CALL 'kxdfhei1' USING DFHEIV0
 19128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19129         MOVE ER-0975            TO EMI-ERROR
 19130         MOVE -1                 TO PMTTYPEL
 19131         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19132         GO TO 8200-SEND-DATAONLY.
 19133
 19134     IF DCT-RETURN-CODE NOT = 'OK'
 19135
 19136* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19137*    MOVE '6"R                   !   #00017186' TO DFHEIV0
 19138     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19140     MOVE X'2020233030303137313836' TO DFHEIV0(25:11)
 19141     CALL 'kxdfhei1' USING DFHEIV0
 19142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19143         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 367
* EL156.cbl
 19144         MOVE -1                 TO PMTTYPEL
 19145         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19146         GO TO 8200-SEND-DATAONLY.
 19147
 19148 7700-CONT.
 19149
 19150*    MOVE 'N'                    TO CASHO.
 19151*    MOVE +1                     TO CASHL.
 19152*    MOVE AL-UANON               TO CASHA.
 19153
 19154     IF PI-OFFLINE = 'Y'
 19155         GO TO 7700-EXIT.
 19156
 19157     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19158     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19159     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19160     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19161     MOVE +7                     TO CHECKNOL.
 19162     MOVE AL-UANON               TO CHECKNOA.
 19163     GO TO 7700-EXIT.
 19164
 19165 7700-SET-TO-YES.
 19166
 19167*    MOVE 'Y'                    TO CASHO.
 19168*    MOVE +1                     TO CASHL.
 19169*    MOVE AL-UANON               TO CASHA.
 19170
 19171 7700-EXIT.
 19172     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 368
* EL156.cbl
 19174 7800-READ-COMP-MSTR.
 19175
 19176
 19177* EXEC CICS HANDLE CONDITION
 19178*        NOTFND   (7800-COMP-NOTFND)
 19179*    END-EXEC.
 19180*    MOVE '"$I                   ! @ #00017220' TO DFHEIV0
 19181     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19183     MOVE X'4020233030303137323230' TO DFHEIV0(25:11)
 19184     CALL 'kxdfhei1' USING DFHEIV0
 19185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19186
 19187
 19188
 19189* EXEC CICS READ
 19190*        DATASET   ('ERCOMP')
 19191*        RIDFLD    (ERCOMP-KEY)
 19192*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19193*    END-EXEC.
 19194     MOVE 'ERCOMP' TO DFHEIV1
 19195*    MOVE '&"S        E          (   #00017224' TO DFHEIV0
 19196     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19197     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19198     MOVE X'2020233030303137323234' TO DFHEIV0(25:11)
 19199     CALL 'kxdfhei1' USING DFHEIV0,
 19200           DFHEIV1,
 19201           DFHEIV20,
 19202           DFHEIV99,
 19203           ERCOMP-KEY,
 19204           DFHEIV99,
 19205           DFHEIV99,
 19206           DFHEIV99
 19207     SET ADDRESS OF COMPENSATION-MASTER TO
 19208         DFHEIV20
 19209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19210
 19211
 19212     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19213     GO TO 7800-COMP-EXIT.
 19214
 19215 7800-COMP-NOTFND.
 19216     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19217
 19218 7800-COMP-EXIT.
 19219     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 369
* EL156.cbl
 19221 7900-READ-CLAIM.
 19222
 19223* EXEC CICS READ
 19224*        DATASET  ('ELMSTR')
 19225*        SET      (ADDRESS OF CLAIM-MASTER)
 19226*        RIDFLD   (ELMSTR-KEY)
 19227*    END-EXEC.
 19228     MOVE 'ELMSTR' TO DFHEIV1
 19229*    MOVE '&"S        E          (   #00017240' TO DFHEIV0
 19230     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19231     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19232     MOVE X'2020233030303137323430' TO DFHEIV0(25:11)
 19233     CALL 'kxdfhei1' USING DFHEIV0,
 19234           DFHEIV1,
 19235           DFHEIV20,
 19236           DFHEIV99,
 19237           ELMSTR-KEY,
 19238           DFHEIV99,
 19239           DFHEIV99,
 19240           DFHEIV99
 19241     SET ADDRESS OF CLAIM-MASTER TO
 19242         DFHEIV20
 19243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19244
 19245
 19246 7900-EXIT.
 19247      EXIT.
 19248
 19249 7910-READ-CLAIM-UPDATE.
 19250
 19251* EXEC CICS READ
 19252*        DATASET  ('ELMSTR')
 19253*        SET      (ADDRESS OF CLAIM-MASTER)
 19254*        RIDFLD   (ELMSTR-KEY)
 19255*        UPDATE
 19256*    END-EXEC.
 19257     MOVE 'ELMSTR' TO DFHEIV1
 19258*    MOVE '&"S        EU         (   #00017250' TO DFHEIV0
 19259     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19260     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19261     MOVE X'2020233030303137323530' TO DFHEIV0(25:11)
 19262     CALL 'kxdfhei1' USING DFHEIV0,
 19263           DFHEIV1,
 19264           DFHEIV20,
 19265           DFHEIV99,
 19266           ELMSTR-KEY,
 19267           DFHEIV99,
 19268           DFHEIV99,
 19269           DFHEIV99
 19270     SET ADDRESS OF CLAIM-MASTER TO
 19271         DFHEIV20
 19272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19273
 19274
 19275 7910-EXIT.
 19276      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 370
* EL156.cbl
 19278 7920-READ-BENE.
 19279     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19280     MOVE 'B'                TO BENE-RECORD-TYPE.
 19281     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19282
 19283     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19284        IF PI-PAYEE-TYPE    = 'B' AND
 19285           PI-PAYEE-SEQ-NUM = 9
 19286             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19287             MOVE WS-A-BENE           TO BENE-NUMBER.
 19288
 19289
 19290* EXEC CICS HANDLE CONDITION
 19291*        NOTFND   (7920-NOT-FOUND)
 19292*    END-EXEC.
 19293*    MOVE '"$I                   ! A #00017271' TO DFHEIV0
 19294     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19295     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19296     MOVE X'4120233030303137323731' TO DFHEIV0(25:11)
 19297     CALL 'kxdfhei1' USING DFHEIV0
 19298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19299
 19300
 19301
 19302* EXEC CICS READ
 19303*        DATASET  ('ELBENE')
 19304*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19305*        RIDFLD   (ELBENE-KEY)
 19306*    END-EXEC.
 19307     MOVE 'ELBENE' TO DFHEIV1
 19308*    MOVE '&"S        E          (   #00017275' TO DFHEIV0
 19309     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19310     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19311     MOVE X'2020233030303137323735' TO DFHEIV0(25:11)
 19312     CALL 'kxdfhei1' USING DFHEIV0,
 19313           DFHEIV1,
 19314           DFHEIV20,
 19315           DFHEIV99,
 19316           ELBENE-KEY,
 19317           DFHEIV99,
 19318           DFHEIV99,
 19319           DFHEIV99
 19320     SET ADDRESS OF BENEFICIARY-MASTER TO
 19321         DFHEIV20
 19322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19323
 19324
 19325     MOVE 'Y' TO BENE-FOUND-SW.
 19326     GO TO 7920-EXIT.
 19327
 19328 7920-NOT-FOUND.
 19329     MOVE 'N'                    TO BENE-FOUND-SW.
 19330
 19331 7920-EXIT.
 19332      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 371
* EL156.cbl
 19334 7930-READ-CONTROL.
 19335
 19336* EXEC CICS READ
 19337*        DATASET  ('ELCNTL')
 19338*        SET      (ADDRESS OF CONTROL-FILE)
 19339*        RIDFLD   (ELCNTL-KEY)
 19340*    END-EXEC.
 19341     MOVE 'ELCNTL' TO DFHEIV1
 19342*    MOVE '&"S        E          (   #00017291' TO DFHEIV0
 19343     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19344     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19345     MOVE X'2020233030303137323931' TO DFHEIV0(25:11)
 19346     CALL 'kxdfhei1' USING DFHEIV0,
 19347           DFHEIV1,
 19348           DFHEIV20,
 19349           DFHEIV99,
 19350           ELCNTL-KEY,
 19351           DFHEIV99,
 19352           DFHEIV99,
 19353           DFHEIV99
 19354     SET ADDRESS OF CONTROL-FILE TO
 19355         DFHEIV20
 19356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19357
 19358
 19359 7930-EXIT.
 19360      EXIT.
 19361
 19362 7940-READ-CONTROL-UPDATE.
 19363
 19364* EXEC CICS READ
 19365*        DATASET  ('ELCNTL')
 19366*        SET      (ADDRESS OF CONTROL-FILE)
 19367*        RIDFLD   (ELCNTL-KEY)
 19368*        UPDATE
 19369*    END-EXEC.
 19370     MOVE 'ELCNTL' TO DFHEIV1
 19371*    MOVE '&"S        EU         (   #00017301' TO DFHEIV0
 19372     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19373     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19374     MOVE X'2020233030303137333031' TO DFHEIV0(25:11)
 19375     CALL 'kxdfhei1' USING DFHEIV0,
 19376           DFHEIV1,
 19377           DFHEIV20,
 19378           DFHEIV99,
 19379           ELCNTL-KEY,
 19380           DFHEIV99,
 19381           DFHEIV99,
 19382           DFHEIV99
 19383     SET ADDRESS OF CONTROL-FILE TO
 19384         DFHEIV20
 19385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19386
 19387
 19388 7940-EXIT.
 19389      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 372
* EL156.cbl
 19391 7950-READ-TRAILER.
 19392
 19393* EXEC CICS READ
 19394*        DATASET  ('ELTRLR')
 19395*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19396*        RIDFLD   (ELTRLR-KEY)
 19397*    END-EXEC.
 19398     MOVE 'ELTRLR' TO DFHEIV1
 19399*    MOVE '&"S        E          (   #00017312' TO DFHEIV0
 19400     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19401     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19402     MOVE X'2020233030303137333132' TO DFHEIV0(25:11)
 19403     CALL 'kxdfhei1' USING DFHEIV0,
 19404           DFHEIV1,
 19405           DFHEIV20,
 19406           DFHEIV99,
 19407           ELTRLR-KEY,
 19408           DFHEIV99,
 19409           DFHEIV99,
 19410           DFHEIV99
 19411     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19412         DFHEIV20
 19413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19414
 19415
 19416 7950-EXIT.
 19417      EXIT.
 19418
 19419 7960-READ-TRAILER-UPDATE.
 19420
 19421* EXEC CICS READ
 19422*        DATASET  ('ELTRLR')
 19423*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19424*        RIDFLD   (ELTRLR-KEY)
 19425*        UPDATE
 19426*    END-EXEC.
 19427     MOVE 'ELTRLR' TO DFHEIV1
 19428*    MOVE '&"S        EU         (   #00017322' TO DFHEIV0
 19429     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19430     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19431     MOVE X'2020233030303137333232' TO DFHEIV0(25:11)
 19432     CALL 'kxdfhei1' USING DFHEIV0,
 19433           DFHEIV1,
 19434           DFHEIV20,
 19435           DFHEIV99,
 19436           ELTRLR-KEY,
 19437           DFHEIV99,
 19438           DFHEIV99,
 19439           DFHEIV99
 19440     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19441         DFHEIV20
 19442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19443
 19444
 19445 7960-EXIT.
 19446      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 373
* EL156.cbl
 19448 7970-READ-CERT.
 19449
 19450* EXEC CICS READ
 19451*        DATASET  ('ELCERT')
 19452*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19453*        RIDFLD   (ELCERT-KEY)
 19454*    END-EXEC.
 19455     MOVE 'ELCERT' TO DFHEIV1
 19456*    MOVE '&"S        E          (   #00017333' TO DFHEIV0
 19457     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19458     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19459     MOVE X'2020233030303137333333' TO DFHEIV0(25:11)
 19460     CALL 'kxdfhei1' USING DFHEIV0,
 19461           DFHEIV1,
 19462           DFHEIV20,
 19463           DFHEIV99,
 19464           ELCERT-KEY,
 19465           DFHEIV99,
 19466           DFHEIV99,
 19467           DFHEIV99
 19468     SET ADDRESS OF CERTIFICATE-MASTER TO
 19469         DFHEIV20
 19470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19471
 19472
 19473 7970-EXIT.
 19474      EXIT.
 19475 7975-read-acct.
 19476
 19477     move spaces              to WS-ACCT-RECORD-SW
 19478                                 pi-dcc-product-code
 19479
 19480     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19481     MOVE PI-CARRIER          TO ACCT-CARRIER
 19482     MOVE PI-GROUPING         TO ACCT-GROUPING
 19483     MOVE PI-STATE            TO ACCT-STATE
 19484     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19485     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19486     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19487     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19488
 19489
 19490* EXEC CICS READ
 19491*       DATASET ('ERACCT')
 19492*       RIDFLD  (ERACCT-KEY)
 19493*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19494*       GTEQ
 19495*       resp    (WS-RESPONSE)
 19496*    END-EXEC
 19497     MOVE 'ERACCT' TO DFHEIV1
 19498*    MOVE '&"S        G          (  N#00017355' TO DFHEIV0
 19499     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19500     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19501     MOVE X'204E233030303137333535' TO DFHEIV0(25:11)
 19502     CALL 'kxdfhei1' USING DFHEIV0,
 19503           DFHEIV1,
 19504           DFHEIV20,
 19505           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 374
* EL156.cbl
 19506           ERACCT-KEY,
 19507           DFHEIV99,
 19508           DFHEIV99,
 19509           DFHEIV99
 19510     SET ADDRESS OF ACCOUNT-MASTER TO
 19511         DFHEIV20
 19512     MOVE EIBRESP  TO WS-RESPONSE
 19513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19514     IF WS-RESP-NORMAL
 19515        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19516        and pi-cert-eff-dt < am-expiration-dt
 19517        and pi-cert-eff-dt >= am-effective-dt
 19518        move am-dcc-product-code to pi-dcc-product-code
 19519        set acct-found to true
 19520     end-if
 19521
 19522     .
 19523 7975-exit.
 19524     exit.
 19525 7980-READ-CERT-UPDATE.
 19526
 19527* EXEC CICS READ
 19528*        DATASET  ('ELCERT')
 19529*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19530*        RIDFLD   (ELCERT-KEY)
 19531*        UPDATE
 19532*    END-EXEC.
 19533     MOVE 'ELCERT' TO DFHEIV1
 19534*    MOVE '&"S        EU         (   #00017374' TO DFHEIV0
 19535     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19536     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19537     MOVE X'2020233030303137333734' TO DFHEIV0(25:11)
 19538     CALL 'kxdfhei1' USING DFHEIV0,
 19539           DFHEIV1,
 19540           DFHEIV20,
 19541           DFHEIV99,
 19542           ELCERT-KEY,
 19543           DFHEIV99,
 19544           DFHEIV99,
 19545           DFHEIV99
 19546     SET ADDRESS OF CERTIFICATE-MASTER TO
 19547         DFHEIV20
 19548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19549
 19550
 19551 7980-EXIT.
 19552      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 375
* EL156.cbl
 19554 8000-LOAD-ERROR-MESSAGES.
 19555     IF PI-PASS-SW = 'C'
 19556        MOVE EMI-LINE1           TO ERMSG1BO
 19557     ELSE
 19558        MOVE EMI-LINE1           TO ERRMSG1O
 19559        MOVE EMI-LINE2           TO ERRMSG2O.
 19560
 19561 8000-EXIT.
 19562     EXIT.
 19563
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 376
* EL156.cbl
 19565
 19566 8010-DMD-ERROR-CHECKS.
 19567     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19568
 19569     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19570         GO TO 8051-ISSUE-ERROR.
 19571
 19572     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19573     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19574     MOVE '3'                    TO DC-OPTION-CODE.
 19575     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19576     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19577         GO TO 8051-ISSUE-ERROR.
 19578
 19579     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19580       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19581                           OR
 19582          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19583           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19584             MOVE ER-0851         TO EMI-ERROR
 19585             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19586       END-IF
 19587       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19588             MOVE ER-8147         TO EMI-ERROR
 19589             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19590
 19591     GO TO 8090-EXIT.
 19592
 19593 8051-ISSUE-ERROR.
 19594     MOVE ER-8146            TO EMI-ERROR.
 19595     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19596     GO TO 8090-EXIT.
 19597
 19598 8090-EXIT.
 19599      EXIT.
 19600
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 377
* EL156.cbl
 19602 8100-SEND-INITIAL-MAP.
 19603
 19604     MOVE SAVE-DATE              TO RUNDTEAO.
 19605     MOVE EIBTIME                TO TIME-IN.
 19606     MOVE TIME-OUT               TO RUNTIMAO.
 19607     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19608
 19609     IF MAP-NAME = 'EL156A'
 19610        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19611           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19612        END-IF
 19613        IF PI-COMPANY-ID = 'DCC'
 19614           MOVE 'N'     TO SURVYYNO
 19615        END-IF
 19616     END-IF
 19617*    IF MAP-NAME = 'EL156A'
 19618*       IF PI-COMPANY-ID = 'CRI'
 19619*          NEXT SENTENCE
 19620*       ELSE
 19621*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19622
 19623     IF MAP-NAME = 'EL156A'
 19624        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19625           NEXT SENTENCE
 19626        ELSE
 19627           MOVE AL-SADOF TO  PINTA    PINTHA.
 19628
 19629     IF MAP-NAME = 'EL156A'
 19630        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19631            NEXT SENTENCE
 19632        ELSE
 19633           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19634
 19635*    IF MAP-NAME = 'EL156A'
 19636*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19637*          NEXT SENTENCE
 19638*       ELSE
 19639*          MOVE AL-SADOF TO CASHHA CASHA.
 19640
 19641     IF MAP-NAME = 'EL156A'
 19642        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19643           NEXT SENTENCE
 19644        ELSE
 19645           MOVE AL-SADOF        TO  LOANHA
 19646                                    LOANNOA.
 19647
 19648     IF MAP-NAME = 'EL156A'
 19649        MOVE -1                 TO  ENTERPFL
 19650        IF PI-USES-PAID-TO
 19651           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19652           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19653           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19654        ELSE
 19655           NEXT SENTENCE
 19656     ELSE
 19657        IF MAP-NAME = 'EL156B'
 19658           IF PI-USES-PAID-TO
 19659              MOVE ' PAYS TO    ' TO HDGB-VRBLE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 378
* EL156.cbl
 19660              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19661
 19662
 19663* EXEC CICS SEND
 19664*        MAP   (MAP-NAME)
 19665*        MAPSET(MAPSET-NAME)
 19666*        FROM  (EL156AI)
 19667*        ERASE
 19668*        CURSOR
 19669*    END-EXEC.
 19670     MOVE LENGTH OF
 19671      EL156AI
 19672       TO DFHEIV12
 19673     MOVE -1
 19674       TO DFHEIV11
 19675*    MOVE '8$     CT  E    H L F ,   #00017492' TO DFHEIV0
 19676     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19677     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19678     MOVE X'2020233030303137343932' TO DFHEIV0(25:11)
 19679     CALL 'kxdfhei1' USING DFHEIV0,
 19680           MAP-NAME,
 19681           EL156AI,
 19682           DFHEIV12,
 19683           MAPSET-NAME,
 19684           DFHEIV99,
 19685           DFHEIV99,
 19686           DFHEIV99,
 19687           DFHEIV11,
 19688           DFHEIV99,
 19689           DFHEIV99,
 19690           DFHEIV99
 19691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19692
 19693
 19694     GO TO 9100-RETURN-TRAN.
 19695
 19696 8200-SEND-DATAONLY.
 19697
 19698     IF FIRST-ENTRY = 'Y'
 19699         GO TO 8100-SEND-INITIAL-MAP.
 19700
 19701     IF RETURNED-FROM-B = 'Y'
 19702         GO TO 8100-SEND-INITIAL-MAP.
 19703
 19704     MOVE SAVE-DATE              TO RUNDTEAO.
 19705     MOVE EIBTIME                TO TIME-IN.
 19706     MOVE TIME-OUT               TO RUNTIMAO.
 19707
 19708     IF EIBAID = DFHPF11
 19709        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19710        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19711        MOVE 'EL001   '          TO RETURNED-FROM
 19712        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19713        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19714        GO TO 8100-SEND-INITIAL-MAP.
 19715
 19716     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19717
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 379
* EL156.cbl
 19718     IF MAP-NAME =  'EL156A'
 19719        MOVE -1                 TO  ENTERPFL
 19720        IF PI-USES-PAID-TO
 19721           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19722           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19723           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19724        ELSE
 19725           NEXT SENTENCE
 19726     ELSE
 19727        IF MAP-NAME = 'EL156B'
 19728           IF PI-USES-PAID-TO
 19729              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19730              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19731
 19732     IF MAP-NAME =  'EL156A'
 19733        IF PI-COMPANY-ID = 'BOA'
 19734            IF PI-INT-RATE NUMERIC
 19735                MOVE PI-INT-RATE TO PINTO.
 19736     IF MAP-NAME = 'EL156A'
 19737        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19738           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19739*          MOVE 'Y'              TO EOBYNO
 19740        END-IF
 19741     END-IF
 19742
 19743
 19744* EXEC CICS SEND
 19745*        MAP   (MAP-NAME)
 19746*        MAPSET(MAPSET-NAME)
 19747*        FROM  (EL156AI)
 19748*        DATAONLY
 19749*        CURSOR
 19750*    END-EXEC.
 19751     MOVE LENGTH OF
 19752      EL156AI
 19753       TO DFHEIV12
 19754     MOVE -1
 19755       TO DFHEIV11
 19756*    MOVE '8$D    CT       H L F ,   #00017549' TO DFHEIV0
 19757     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19758     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19759     MOVE X'2020233030303137353439' TO DFHEIV0(25:11)
 19760     CALL 'kxdfhei1' USING DFHEIV0,
 19761           MAP-NAME,
 19762           EL156AI,
 19763           DFHEIV12,
 19764           MAPSET-NAME,
 19765           DFHEIV99,
 19766           DFHEIV99,
 19767           DFHEIV99,
 19768           DFHEIV11,
 19769           DFHEIV99,
 19770           DFHEIV99,
 19771           DFHEIV99
 19772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19773
 19774
 19775     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 380
* EL156.cbl
 19776
 19777 8300-SEND-TEXT.
 19778
 19779* EXEC CICS SEND TEXT
 19780*        FROM(LOGOFF-TEXT)
 19781*        LENGTH(LOGOFF-LENGTH)
 19782*        ERASE
 19783*        FREEKB
 19784*    END-EXEC.
 19785*    MOVE '8&      T  E F  H   F -   #00017560' TO DFHEIV0
 19786     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19787     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19788     MOVE X'2020233030303137353630' TO DFHEIV0(25:11)
 19789     CALL 'kxdfhei1' USING DFHEIV0,
 19790           LOGOFF-TEXT,
 19791           LOGOFF-LENGTH,
 19792           DFHEIV99,
 19793           DFHEIV99,
 19794           DFHEIV99,
 19795           DFHEIV99,
 19796           DFHEIV99,
 19797           DFHEIV99,
 19798           DFHEIV99,
 19799           DFHEIV99,
 19800           DFHEIV99,
 19801           DFHEIV99
 19802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19803
 19804
 19805
 19806* EXEC CICS RETURN
 19807*    END-EXEC.
 19808*    MOVE '.(                    ''   #00017567' TO DFHEIV0
 19809     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19810     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19811     MOVE X'2020233030303137353637' TO DFHEIV0(25:11)
 19812     CALL 'kxdfhei1' USING DFHEIV0,
 19813           DFHEIV99,
 19814           DFHEIV99,
 19815           DFHEIV99,
 19816           DFHEIV99,
 19817           DFHEIV99,
 19818           DFHEIV99
 19819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19820
 19821
 19822 8500-FILE-NOTOPEN.
 19823     IF FILE-SWITCH = 'MSTR'
 19824         MOVE ER-0154            TO EMI-ERROR.
 19825     IF FILE-SWITCH = 'TRLR'
 19826         MOVE ER-0172            TO EMI-ERROR.
 19827     IF FILE-SWITCH = 'CERT'
 19828         MOVE ER-0169            TO EMI-ERROR.
 19829     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19830                      'PROC' OR 'STAT'
 19831         MOVE ER-0042            TO EMI-ERROR.
 19832     IF FILE-SWITCH = 'ACTQ'
 19833         MOVE ER-0338            TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 381
* EL156.cbl
 19834     IF FILE-SWITCH = 'ACCT'
 19835         MOVE ER-0168            TO EMI-ERROR.
 19836
 19837     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19838     MOVE -1                     TO PMTTYPEL.
 19839
 19840     IF FIRST-ENTRY = 'Y'
 19841         GO TO 8100-SEND-INITIAL-MAP.
 19842
 19843     GO TO 8200-SEND-DATAONLY.
 19844
 19845 8600-PGRM-NOT-FOUND.
 19846
 19847     MOVE ER-0923                TO EMI-ERROR.
 19848     MOVE -1                     TO ENTPFBL.
 19849     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19850
 19851     IF FIRST-ENTRY = 'Y'
 19852         GO TO 8100-SEND-INITIAL-MAP
 19853     ELSE
 19854         GO TO 8200-SEND-DATAONLY.
 19855
 19856 8800-UNAUTHORIZED-ACCESS.
 19857     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 19858     GO TO 8300-SEND-TEXT.
 19859
 19860 8810-PF23.
 19861     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 19862     MOVE XCTL-005               TO PGM-NAME.
 19863     GO TO 9300-XCTL.
 19864
 19865 8820-PF7-8.
 19866     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 19867     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 19868                                    PI-SAVED-PROGRAM-2
 19869                                    PI-SAVED-PROGRAM-3
 19870                                    PI-SAVED-PROGRAM-4
 19871                                    PI-SAVED-PROGRAM-5
 19872                                    PI-SAVED-PROGRAM-6
 19873                                    PI-RETURN-TO-PROGRAM.
 19874     IF EIBAID = DFHPF8
 19875        MOVE XCTL-132            TO PGM-NAME
 19876     ELSE
 19877        MOVE XCTL-130            TO PGM-NAME.
 19878
 19879     GO TO 9300-XCTL.
 19880
 19881 9100-RETURN-TRAN.
 19882     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 19883     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 19884
 19885
 19886* EXEC CICS RETURN
 19887*        TRANSID(TRANS-ID)
 19888*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19889*        LENGTH(PI-COMM-LENGTH)
 19890*    END-EXEC.
 19891*    MOVE '.(CT                  ''   #00017633' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 382
* EL156.cbl
 19892     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 19893     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19894     MOVE X'2020233030303137363333' TO DFHEIV0(25:11)
 19895     CALL 'kxdfhei1' USING DFHEIV0,
 19896           TRANS-ID,
 19897           PROGRAM-INTERFACE-BLOCK,
 19898           PI-COMM-LENGTH,
 19899           DFHEIV99,
 19900           DFHEIV99,
 19901           DFHEIV99
 19902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19903
 19904
 19905 9200-RETURN-MAIN-MENU.
 19906     MOVE XCTL-126               TO PGM-NAME.
 19907     GO TO 9300-XCTL.
 19908
 19909 9300-XCTL.
 19910
 19911* EXEC CICS XCTL
 19912*        PROGRAM(PGM-NAME)
 19913*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19914*        LENGTH(PI-COMM-LENGTH)
 19915*    END-EXEC.
 19916*    MOVE '.$C                   %   #00017644' TO DFHEIV0
 19917     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 19918     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19919     MOVE X'2020233030303137363434' TO DFHEIV0(25:11)
 19920     CALL 'kxdfhei1' USING DFHEIV0,
 19921           PGM-NAME,
 19922           PROGRAM-INTERFACE-BLOCK,
 19923           PI-COMM-LENGTH,
 19924           DFHEIV99
 19925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19926
 19927
 19928 9400-CLEAR.
 19929     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 19930     GO TO 9300-XCTL.
 19931
 19932 9500-PF12.
 19933     MOVE XCTL-010               TO PGM-NAME.
 19934     GO TO 9300-XCTL.
 19935
 19936 9700-LINK-DATE-CONVERT.
 19937     MOVE LINK-ELDATCV           TO PGM-NAME.
 19938
 19939* EXEC CICS LINK
 19940*        PROGRAM   (PGM-NAME)
 19941*        COMMAREA  (DATE-CONVERSION-DATA)
 19942*        LENGTH    (DC-COMM-LENGTH)
 19943*    END-EXEC.
 19944*    MOVE '."C                   (   #00017660' TO DFHEIV0
 19945     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19946     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19947     MOVE X'2020233030303137363630' TO DFHEIV0(25:11)
 19948     CALL 'kxdfhei1' USING DFHEIV0,
 19949           PGM-NAME,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 383
* EL156.cbl
 19950           DATE-CONVERSION-DATA,
 19951           DC-COMM-LENGTH,
 19952           DFHEIV99,
 19953           DFHEIV99,
 19954           DFHEIV99,
 19955           DFHEIV99
 19956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19957
 19958
 19959 9700-EXIT.
 19960     EXIT.
 19961
 19962 9800-LINK-REM-TERM.
 19963     MOVE LINK-REMTERM TO PGM-NAME.
 19964
 19965
 19966* EXEC CICS LINK
 19967*        PROGRAM   (PGM-NAME)
 19968*        COMMAREA  (CALCULATION-PASS-AREA)
 19969*        LENGTH    (CP-COMM-LENGTH)
 19970*    END-EXEC.
 19971*    MOVE '."C                   (   #00017672' TO DFHEIV0
 19972     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19973     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19974     MOVE X'2020233030303137363732' TO DFHEIV0(25:11)
 19975     CALL 'kxdfhei1' USING DFHEIV0,
 19976           PGM-NAME,
 19977           CALCULATION-PASS-AREA,
 19978           CP-COMM-LENGTH,
 19979           DFHEIV99,
 19980           DFHEIV99,
 19981           DFHEIV99,
 19982           DFHEIV99
 19983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19984
 19985
 19986 9800-EXIT.
 19987     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 384
* EL156.cbl
 19989 9830-DMD-REMAINING-TERM.
 19990
 19991     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 19992         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 19993
 19994     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 19995                              CM-PMT-EXTENSION-DAYS.
 19996
 19997     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 19998                                  CL-NO-OF-DAYS-PAID.
 19999
 20000     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20001         GIVING W-REM REMAINDER W-REM-DAYS.
 20002
 20003     MOVE W-REM                  TO WST-REM.
 20004
 20005     IF W-REM-DAYS > ZEROS
 20006         MOVE '/'                TO WST-SLASH
 20007         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20008     ELSE
 20009         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20010
 20011 9830-EXIT.
 20012     EXIT.
 20013
 20014 9870-OUTPUT-ACTIVITY-RECORD.
 20015
 20016
 20017* EXEC CICS GETMAIN
 20018*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20019*         LENGTH(25)
 20020*         INITIMG(WS-BLANK)
 20021*    END-EXEC.
 20022     MOVE 25
 20023       TO DFHEIV11
 20024*    MOVE ',"IL                  $   #00017708' TO DFHEIV0
 20025     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20026     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20027     MOVE X'2020233030303137373038' TO DFHEIV0(25:11)
 20028     CALL 'kxdfhei1' USING DFHEIV0,
 20029           DFHEIV20,
 20030           DFHEIV11,
 20031           WS-BLANK
 20032     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20033         DFHEIV20
 20034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20035
 20036
 20037     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20038     MOVE ELMSTR-KEY             TO DA-KEY.
 20039     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20040
 20041     IF PI-PMTTYPE EQUAL '7'
 20042         MOVE 'V'                TO DA-RECORD-TYPE
 20043     ELSE
 20044         MOVE 'P'                TO DA-RECORD-TYPE.
 20045
 20046
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 385
* EL156.cbl
 20047* EXEC CICS HANDLE CONDITION
 20048*         NOTOPEN(9870-NOTOPEN)
 20049*         DUPREC(9870-EXIT)
 20050*    END-EXEC.
 20051*    MOVE '"$J%                  ! B #00017723' TO DFHEIV0
 20052     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20053     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20054     MOVE X'4220233030303137373233' TO DFHEIV0(25:11)
 20055     CALL 'kxdfhei1' USING DFHEIV0
 20056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20057
 20058
 20059
 20060* EXEC CICS WRITE
 20061*         DATASET('DLYACTV')
 20062*         RIDFLD(DA-KEY)
 20063*         FROM(DAILY-ACTIVITY-RECORD)
 20064*         LENGTH(25)
 20065*    END-EXEC.
 20066     MOVE 'DLYACTV' TO DFHEIV1
 20067     MOVE 25
 20068       TO DFHEIV11
 20069*    MOVE '&$ L                  ''   #00017728' TO DFHEIV0
 20070     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20071     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20072     MOVE X'2020233030303137373238' TO DFHEIV0(25:11)
 20073     CALL 'kxdfhei1' USING DFHEIV0,
 20074           DFHEIV1,
 20075           DAILY-ACTIVITY-RECORD,
 20076           DFHEIV11,
 20077           DA-KEY,
 20078           DFHEIV99,
 20079           DFHEIV99
 20080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20081
 20082     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20083     GO TO 9870-EXIT.
 20084
 20085 9870-NOTOPEN.
 20086
 20087     MOVE '2955'                 TO EMI-ERROR.
 20088     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20089
 20090 9870-EXIT.
 20091     EXIT.
 20092
 20093 9900-ERROR-FORMAT.
 20094
 20095     IF EMI-ERROR = ER-0923
 20096         MOVE PGM-NAME           TO W-CALLED-NAME.
 20097
 20098     MOVE LINK-001      TO PGM-NAME.
 20099     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20100
 20101
 20102* EXEC CICS LINK
 20103*        PROGRAM (PGM-NAME)
 20104*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 386
* EL156.cbl
 20105*        LENGTH  (EMI-COMM-LENGTH)
 20106*    END-EXEC.
 20107*    MOVE '."C                   (   #00017753' TO DFHEIV0
 20108     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20109     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20110     MOVE X'2020233030303137373533' TO DFHEIV0(25:11)
 20111     CALL 'kxdfhei1' USING DFHEIV0,
 20112           PGM-NAME,
 20113           ERROR-MESSAGE-INTERFACE-BLOCK,
 20114           EMI-COMM-LENGTH,
 20115           DFHEIV99,
 20116           DFHEIV99,
 20117           DFHEIV99,
 20118           DFHEIV99
 20119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20120
 20121
 20122     IF EMI-ERROR = ER-0923
 20123         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20124
 20125 9900-EXIT.
 20126     EXIT.
 20127
 20128 9990-ABEND.
 20129     MOVE LINK-004               TO PGM-NAME.
 20130     MOVE DFHEIBLK               TO EMI-LINE1.
 20131
 20132* EXEC CICS LINK
 20133*        PROGRAM   (PGM-NAME)
 20134*        COMMAREA  (EMI-LINE1)
 20135*        LENGTH    (64)
 20136*    END-EXEC.
 20137     MOVE 64
 20138       TO DFHEIV11
 20139*    MOVE '."C                   (   #00017768' TO DFHEIV0
 20140     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20141     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20142     MOVE X'2020233030303137373638' TO DFHEIV0(25:11)
 20143     CALL 'kxdfhei1' USING DFHEIV0,
 20144           PGM-NAME,
 20145           EMI-LINE1,
 20146           DFHEIV11,
 20147           DFHEIV99,
 20148           DFHEIV99,
 20149           DFHEIV99,
 20150           DFHEIV99
 20151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20152
 20153
 20154     MOVE 'EL156A'               TO  MAP-NAME.
 20155     MOVE LOW-VALUES             TO  EL156AO.
 20156     GO TO 8100-SEND-INITIAL-MAP.
 20157
 20158 9995-SECURITY-VIOLATION.
 20159*    COPY ELCSCTP.
 20160******************************************************************
 20161*                                                                *
 20162*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 387
* EL156.cbl
 20163*                            VMOD=2.001                          *
 20164*                                                                *
 20165*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20166******************************************************************
 20167
 20168
 20169     MOVE EIBDATE          TO SM-JUL-DATE.
 20170     MOVE EIBTRMID         TO SM-TERMID.
 20171     MOVE THIS-PGM         TO SM-PGM.
 20172     MOVE EIBTIME          TO TIME-IN.
 20173     MOVE TIME-OUT         TO SM-TIME.
 20174     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20175
 20176
 20177* EXEC CICS LINK
 20178*         PROGRAM  ('EL003')
 20179*         COMMAREA (SECURITY-MESSAGE)
 20180*         LENGTH   (80)
 20181*    END-EXEC.
 20182     MOVE 'EL003' TO DFHEIV1
 20183     MOVE 80
 20184       TO DFHEIV11
 20185*    MOVE '."C                   (   #00017796' TO DFHEIV0
 20186     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20187     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20188     MOVE X'2020233030303137373936' TO DFHEIV0(25:11)
 20189     CALL 'kxdfhei1' USING DFHEIV0,
 20190           DFHEIV1,
 20191           SECURITY-MESSAGE,
 20192           DFHEIV11,
 20193           DFHEIV99,
 20194           DFHEIV99,
 20195           DFHEIV99,
 20196           DFHEIV99
 20197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20198
 20199
 20200******************************************************************
 20201
 20202
 20203
 20204 9999-DFHBACK SECTION.
 20205     MOVE '9%                    "   ' TO DFHEIV0
 20206     MOVE 'EL156' TO DFHEIV1
 20207     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20208     GOBACK.
 20209 9999-DFHEXIT.
 20210     IF DFHEIGDJ EQUAL 0001
 20211         NEXT SENTENCE
 20212     ELSE IF DFHEIGDJ EQUAL 2
 20213         GO TO 9990-ABEND,
 20214               8600-PGRM-NOT-FOUND,
 20215               0400-FIRST-TIME,
 20216               6180-DUPREC,
 20217               9990-ABEND
 20218         DEPENDING ON DFHEIGDI
 20219     ELSE IF DFHEIGDJ EQUAL 3
 20220         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 388
* EL156.cbl
 20221               0380-CLAIM-END-FILE
 20222         DEPENDING ON DFHEIGDI
 20223     ELSE IF DFHEIGDJ EQUAL 4
 20224         GO TO 0380-CLAIM-END-FILE,
 20225               0380-CLAIM-END-FILE
 20226         DEPENDING ON DFHEIGDI
 20227     ELSE IF DFHEIGDJ EQUAL 5
 20228         GO TO 0800-EXIT
 20229         DEPENDING ON DFHEIGDI
 20230     ELSE IF DFHEIGDJ EQUAL 6
 20231         GO TO 1950-NOT-FOUND,
 20232               1950-NOT-FOUND
 20233         DEPENDING ON DFHEIGDI
 20234     ELSE IF DFHEIGDJ EQUAL 7
 20235         GO TO 1950-NOT-FOUND
 20236         DEPENDING ON DFHEIGDI
 20237     ELSE IF DFHEIGDJ EQUAL 8
 20238         GO TO 1950-NOT-FOUND,
 20239               1950-NOT-FOUND
 20240         DEPENDING ON DFHEIGDI
 20241     ELSE IF DFHEIGDJ EQUAL 9
 20242         GO TO 1166-END-CHECK,
 20243               1166-END-CHECK
 20244         DEPENDING ON DFHEIGDI
 20245     ELSE IF DFHEIGDJ EQUAL 10
 20246         GO TO 1950-NOT-FOUND,
 20247               1950-NOT-FOUND
 20248         DEPENDING ON DFHEIGDI
 20249     ELSE IF DFHEIGDJ EQUAL 11
 20250         GO TO 1950-NOT-FOUND,
 20251               1950-NOT-FOUND
 20252         DEPENDING ON DFHEIGDI
 20253     ELSE IF DFHEIGDJ EQUAL 12
 20254         GO TO 1950-NOT-FOUND
 20255         DEPENDING ON DFHEIGDI
 20256     ELSE IF DFHEIGDJ EQUAL 13
 20257         GO TO 3600-CONTINUE
 20258         DEPENDING ON DFHEIGDI
 20259     ELSE IF DFHEIGDJ EQUAL 14
 20260         GO TO 5300-NOTE-NOT-FOUND
 20261         DEPENDING ON DFHEIGDI
 20262     ELSE IF DFHEIGDJ EQUAL 15
 20263         GO TO 6065-NOT-FOUND
 20264         DEPENDING ON DFHEIGDI
 20265     ELSE IF DFHEIGDJ EQUAL 16
 20266         GO TO 6068-ACCT-NOT-FND
 20267         DEPENDING ON DFHEIGDI
 20268     ELSE IF DFHEIGDJ EQUAL 17
 20269         GO TO 6074-GET-COMP-DATA
 20270         DEPENDING ON DFHEIGDI
 20271     ELSE IF DFHEIGDJ EQUAL 18
 20272         GO TO 6170-WRITE
 20273         DEPENDING ON DFHEIGDI
 20274     ELSE IF DFHEIGDJ EQUAL 19
 20275         GO TO 6180-DUPREC
 20276         DEPENDING ON DFHEIGDI
 20277     ELSE IF DFHEIGDJ EQUAL 20
 20278         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 12:34 Page 389
* EL156.cbl
 20279         DEPENDING ON DFHEIGDI
 20280     ELSE IF DFHEIGDJ EQUAL 21
 20281         GO TO 6185-DUPREC
 20282         DEPENDING ON DFHEIGDI
 20283     ELSE IF DFHEIGDJ EQUAL 22
 20284         GO TO 6720-BUILD-NEW-RECORD
 20285         DEPENDING ON DFHEIGDI
 20286     ELSE IF DFHEIGDJ EQUAL 23
 20287         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20288               6900-BUILD-ARCHIVE-HEADER
 20289         DEPENDING ON DFHEIGDI
 20290     ELSE IF DFHEIGDJ EQUAL 24
 20291         GO TO 7010-BUILD-MAP
 20292         DEPENDING ON DFHEIGDI
 20293     ELSE IF DFHEIGDJ EQUAL 25
 20294         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20295         DEPENDING ON DFHEIGDI
 20296     ELSE IF DFHEIGDJ EQUAL 26
 20297         GO TO 7160-DUPREC
 20298         DEPENDING ON DFHEIGDI
 20299     ELSE IF DFHEIGDJ EQUAL 27
 20300         GO TO 7200-EXIT,
 20301               7200-EXIT
 20302         DEPENDING ON DFHEIGDI
 20303     ELSE IF DFHEIGDJ EQUAL 28
 20304         GO TO 7400-NOT-FOUND
 20305         DEPENDING ON DFHEIGDI
 20306     ELSE IF DFHEIGDJ EQUAL 29
 20307         GO TO 7590-END,
 20308               7590-END
 20309         DEPENDING ON DFHEIGDI
 20310     ELSE IF DFHEIGDJ EQUAL 30
 20311         GO TO 7699-EXIT
 20312         DEPENDING ON DFHEIGDI
 20313     ELSE IF DFHEIGDJ EQUAL 31
 20314         GO TO 5300-NOTE-NOT-FOUND
 20315         DEPENDING ON DFHEIGDI
 20316     ELSE IF DFHEIGDJ EQUAL 32
 20317         GO TO 7800-COMP-NOTFND
 20318         DEPENDING ON DFHEIGDI
 20319     ELSE IF DFHEIGDJ EQUAL 33
 20320         GO TO 7920-NOT-FOUND
 20321         DEPENDING ON DFHEIGDI
 20322     ELSE IF DFHEIGDJ EQUAL 34
 20323         GO TO 9870-NOTOPEN,
 20324               9870-EXIT
 20325         DEPENDING ON DFHEIGDI.
 20326     MOVE '9%                    "   ' TO DFHEIV0
 20327     MOVE 'EL156' TO DFHEIV1
 20328     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20329     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12188     Code:       75476
