* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page   1
* EL156.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL156.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page   2
* EL156.cbl
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39******************************************************************
    40
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page   3
* EL156.cbl
    42 ENVIRONMENT DIVISION.
    43
    44 DATA DIVISION.
    45
    46 WORKING-STORAGE SECTION.
    47 01  DFH-START PIC X(04).
    48
    49 77  FILLER  PIC X(32)  VALUE '********************************'.
    50 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    51 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    52 77  WS-SSN  PIC X(9) VALUE ZEROS.
    53 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    54
    55*    COPY ELCSCTM.
    56******************************************************************
    57*                                                                *
    58*                                                                *
    59*                            ELCSCTM                             *
    60*                            VMOD=2.001                          *
    61*                                                                *
    62*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    63*                                                                *
    64******************************************************************
    65 01  SECURITY-MESSAGE.
    66     12  FILLER                          PIC X(30)
    67            VALUE '** LOGIC SECURITY VIOLATION -'.
    68     12  SM-READ                         PIC X(6).
    69     12  FILLER                          PIC X(5)
    70            VALUE ' PGM='.
    71     12  SM-PGM                          PIC X(6).
    72     12  FILLER                          PIC X(5)
    73            VALUE ' OPR='.
    74     12  SM-PROCESSOR-ID                 PIC X(4).
    75     12  FILLER                          PIC X(6)
    76            VALUE ' TERM='.
    77     12  SM-TERMID                       PIC X(4).
    78     12  FILLER                          PIC XX   VALUE SPACE.
    79     12  SM-JUL-DATE                     PIC 9(5).
    80     12  FILLER                          PIC X    VALUE SPACE.
    81     12  SM-TIME                         PIC 99.99.
    82
    83
    84*    COPY ELCSCRTY.
    85******************************************************************
    86*                                                                *
    87*                                                                *
    88*                            ELCSCRTY                            *
    89*                            VMOD=2.001                          *
    90*                                                                *
    91*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    92*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    93*        SAVED IN PI-SECURITY-ADDRESS.                           *
    94*                                                                *
    95******************************************************************
    96 01  SECURITY-CONTROL.
    97     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    98     12  FILLER                       PIC XX    VALUE 'SC'.
    99     12  SC-CREDIT-CODES.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page   4
* EL156.cbl
   100         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   101             20  SC-CREDIT-DISPLAY    PIC X.
   102             20  SC-CREDIT-UPDATE     PIC X.
   103     12  SC-CLAIMS-CODES.
   104         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   105             20  SC-CLAIMS-DISPLAY    PIC X.
   106             20  SC-CLAIMS-UPDATE     PIC X.
   107
   108 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   109 01  WS-DATE-AREA.
   110     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   111     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   112     12  SAVE-DATE-CCYYMMDD.
   113         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   114         16  SAVE-DATE-YMD.
   115             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   116             20  FILLER              PIC X(04)   VALUE SPACES.
   117
   118 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   119 01  STANDARD-AREAS.
   120     12  WS-RESPONSE         PIC S9(8)   COMP.
   121         88  WS-RESP-NORMAL              VALUE +00.
   122         88  WS-RESP-ERROR               VALUE +01.
   123         88  WS-RESP-NOTFND              VALUE +13.
   124         88  WS-RESP-DUPREC              VALUE +14.
   125         88  WS-RESP-ENDFILE             VALUE +20.
   126     12  PMT-HEAD-A.
   127         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   128         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   129         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   130-        '     RESERVES  TYPE    AMOUNT'.
   131     12  PMT-HEAD-B.
   132         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   133         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   134         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   135     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   136     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   137     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   138     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   139     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   140     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   141     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   142     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   143     12  PGM-NAME            PIC X(8).
   144     12  TIME-IN             PIC S9(7).
   145     12  TIME-OUT-R  REDEFINES TIME-IN.
   146         16  FILLER          PIC X.
   147         16  TIME-OUT        PIC 99V99.
   148         16  FILLER          PIC XX.
   149     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   150     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   151     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   152     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   153     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   154     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   155     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   156     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   157     12  LINK-001            PIC X(8)    VALUE 'EL001'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page   5
* EL156.cbl
   158     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   159     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   160     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   161     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   162     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   163     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   164     12  WS-BLANK            PIC X       VALUE ' '.
   165
   166 01  MISC-WORK-AREAS.
   167     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   168     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   169     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   170     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   171     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   172     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   173     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   174     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   175     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   176     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   177     12  W-CALLED-NAME           PIC X(08).
   178     12  W-EOB-CODES.
   179         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   180             20  W-EOB-CODE      PIC XXX.
   181             20  W-EOB-FILLER    PIC X.
   182     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   183     12  W-NAME-LAST             PIC X(15).
   184     12  W-NAME-FIRST            PIC X(15).
   185     12  W-NAME-MIDDLE.
   186         16  FILLER              PIC X.
   187         16  W-NAME-MIDDLE-2     PIC X.
   188         16  FILLER              PIC X(13).
   189     12  W-DMD-CHECK-NO.
   190         16  W-DMD-CHECK-NO-1    PIC X(4).
   191         16  W-DMD-CHECK-NO-2    PIC X.
   192         16  W-DMD-CHECK-NO-3    PIC XX.
   193
   194     12  WS-COMPUTE-FROM-DT  PIC XX.
   195     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   196     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   197     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   198     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   199     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   200     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   201         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   202         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   203     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   204         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   205     12  WS-UPDATE-SW        PIC X VALUE ' '.
   206     12  WS-GROUPING.
   207         16  WS-GROUP-1      PIC X VALUE SPACES.
   208         16  FILLER          PIC X(05) VALUE SPACES.
   209     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   210     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   211     12  WS-WORK-STATE-ACCT.
   212         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   213         16  FILLER          PIC X       VALUE '/'.
   214         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   215     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page   6
* EL156.cbl
   216     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   217     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   218     12  QID.
   219         16  QID-TERM        PIC X(4)    VALUE SPACES.
   220         16  FILLER          PIC X(4)    VALUE '156A'.
   221     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   222     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   223     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   224     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   225     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   226     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   227     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   228     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   229     12  WS-STATUS           PIC X       VALUE SPACES.
   230     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   231     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   232     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   233     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   234     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   235     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   236     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   237     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   238     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   239     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   240     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   241     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   242     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   243     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   244     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   245     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   246     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   247     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   248     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   249     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   250     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   251     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   252     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   253     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   254     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   255     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   256     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   257     12  WORK-DATE-FROM.
   258         16  WDF-MONTH       PIC 99        VALUE ZERO.
   259         16  WDF-DAY         PIC 99        VALUE ZERO.
   260         16  WDF-YEAR        PIC 99        VALUE ZERO.
   261     12  WORK-DATE-THRU.
   262         16  WDT-MONTH       PIC 99        VALUE ZERO.
   263         16  WDT-DAY         PIC 99        VALUE ZERO.
   264         16  WDT-YEAR        PIC 99        VALUE ZERO.
   265     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   266     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   267     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   268     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   269     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   270     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   271     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   272     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   273     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page   7
* EL156.cbl
   274     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   275     12  WS-PY-WK REDEFINES WS-PY-WORK.
   276         16  WS-PY-NUM       PIC S9(7)V99.
   277         16  WS-PY-SIGN      PIC X.
   278     12  WS-DY-WORK          PIC S9(5).
   279     12  WS-DY-WK REDEFINES WS-DY-WORK.
   280         16  WS-DY-NUM       PIC S9(4).
   281         16  WS-DY-SIGN      PIC X.
   282     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   283         88  COMP-REC-FOUND              VALUE 'Y'.
   284     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   285         88  BENEFIT-FOUND       VALUE 'Y'.
   286         88  NO-BENEFIT-FOUND    VALUE 'N'.
   287     12  WS-TERMS.
   288         16  WST-ORIG        PIC --9     VALUE ZEROS.
   289         16  FILLER          PIC X       VALUE '/'.
   290         16  WST-REM         PIC --9     VALUE ZEROS.
   291         16  WST-REM-DAYS-GRP.
   292             20  WST-SLASH   PIC X       VALUE '/'.
   293             20  WST-REM-DAYS
   294                             PIC --9.
   295     12  WS-ACCESS.
   296         16  FILLER          PIC XX      VALUE SPACES.
   297         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   298     12  WS-STATE-ACCESS.
   299         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   300         16  FILLER          PIC XX      VALUE SPACES.
   301     12  WS-CARR-ACCESS.
   302         16  FILLER          PIC X(3)    VALUE SPACES.
   303         16  WS-CARR         PIC X       VALUE SPACES.
   304     12  DATE-WORK.
   305         16  FILLER          PIC XX      VALUE SPACES.
   306         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   307     12  WS-SAVE-INPUT.
   308         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   309         16  WS-PAYEE        PIC XX      VALUE SPACE.
   310         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   311         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   312         16  WS-OFFLINE      PIC X       VALUE SPACE.
   313         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   314         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   315         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   316         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   317         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   318         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   319         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   320         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   321         16  WS-ETYPE        PIC X       VALUE SPACE.
   322         16  WS-CASH         PIC X       VALUE SPACE.
   323         16  WS-GROUPED      PIC X       VALUE SPACE.
   324         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   325         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   326         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   327         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   328         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   329     12  LAST-ERROR-LINE.
   330         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   331         16  FILLER              PIC X(30)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page   8
* EL156.cbl
   332             VALUE ' FATAL ERRORS ENCOUNTERED'.
   333         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   334         16  FILLER              PIC X(28)
   335             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   336     12  WS-CHECK-AREA.
   337         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   338         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   339     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   340     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   341         16  FILLER              PIC XX.
   342         16  WS-A-CHECK-NUM-5    PIC 9(5).
   343     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   344         16  FILLER              PIC X.
   345         16  WS-A-CHECK-NUM-6    PIC 9(6).
   346     12  OPTION-1-SAVE-AREA.
   347         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   348         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   349     12  WS-WORK-ZIP.
   350         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   351         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   352     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   353                                 PIC 9(9).
   354     12  WS-FLI-PMTNOTE.
   355         16  WS-PMTOPTION        PIC XX.
   356         16  WS-DOCNAME          PIC X(28).
   357         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   358             20  WS-AMOUNT       PIC X(8).
   359             20  FILLER          PIC X(20).
   360         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   361             20  WS-NUM-AMT      PIC 9(6)V99.
   362             20  FILLER          PIC X(20).
   363
   364     12  WS-HAN-PMTNOTE.
   365         16  WS-HAN-PMT-CODE     PIC X.
   366         16  WS-HAN-PMT-NOTE     PIC X(39).
   367
   368     12  WS-NCL-PMT-OPTION       PIC XX.
   369         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   370
   371     12  WS-CLAIM-SEQUENCE.
   372         16  FILLER              PIC X VALUE '('.
   373         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   374         16  FILLER              PIC X(04) VALUE ' OF '.
   375         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   376         16  FILLER              PIC X VALUE ')'.
   377
   378     12  WS-REFUND-AMT           PIC Z(7).99.
   379     12  WS-CALC-INT             PIC S9(7)V99.
   380     12  WS-CRIT-PERIOD-DAYS     PIC S9(4)V999 VALUE +0  COMP-3.
   381
   382     12  SUB                     PIC 99 VALUE ZEROS.
   383
   384     12  WS-BOANOTE1.
   385         16  WS-BOANOTE1-DESC    PIC X(11).
   386         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   387         16  FILLER              PIC X(17).
   388     12  WS-BOANOTE2.
   389         16  WS-BOANOTE2-DESC    PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page   9
* EL156.cbl
   390         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   391         16  FILLER              PIC X(17).
   392
   393     12  WS-NCLNOTE1.
   394         16  WS-NCLNOTE1-DESC    PIC X(11).
   395         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   396         16  FILLER              PIC X(17).
   397     12  WS-NCLNOTE2.
   398         16  WS-NCLNOTE2-DESC    PIC X(11).
   399         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   400         16  FILLER              PIC X(17).
   401
   402     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   403     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   404     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   405     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   406     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   407     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   408     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   409     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   410     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   411     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   412
   413     12  WS-AIG-WORK-AREAS.
   414         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   415             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   416         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   417             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   418         16  WS-FROM-DATE-MDY.
   419             20  WS-FROM-MO      PIC 99.
   420             20  WS-FROM-DA      PIC 99.
   421             20  WS-FROM-YR      PIC 99.
   422         16  WS-TEMP-DATE-MDY.
   423             20  WS-TEMP-MO      PIC 99.
   424             20  WS-TEMP-DA      PIC 99.
   425             20  WS-TEMP-YR      PIC 99.
   426         16  WS-BIN-FROM-DT      PIC XX.
   427         16  WS-TEMP-INC-MDY.
   428             20  WS-TEMP-INC-MO  PIC 99.
   429             20  WS-TEMP-INC-DA  PIC 99.
   430             20  WS-TEMP-INC-YR  PIC 99.
   431         16  WS-PMT-DUE-MDY.
   432             20  WS-PMT-DUE-MO   PIC 99.
   433             20  WS-PMT-DUE-DA   PIC 99.
   434             20  WS-PMT-DUE-YR   PIC 99.
   435         16  WS-PMT-DUE-DT       PIC XX.
   436         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   437         16  WS-RETRO-ELIM-DT    PIC XX.
   438         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   439             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   440         16  WS-SAVE-DUE-DA      PIC 99.
   441         16  WS-CDAYS            PIC S9(05).
   442         16  WS-DAYS-OFF         PIC S9(05).
   443         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   444             88  ELIM-SATISFIED            VALUE 'Y'.
   445         16  WS-AIG-CHECKNO.
   446             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   447             20  WS-A-CHECKNO-3-7.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  10
* EL156.cbl
   448                 24  FILLER              PIC X(3)    VALUE SPACES.
   449                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   450                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   451         16  WS-AIG-GROUPING.
   452             20  WS-A-BENE               PIC XXX.
   453             20  FILLER                  PIC XXX.
   454         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   455             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   456             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   457         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   458                 VALUE 'UNEMPLOYMENT PAYMENT'.
   459         16  WS-CHK-THRU-DT              PIC XX.
   460         16  WS-HOLD-BIN-DATE-1          PIC XX.
   461
   462 01  MISC-CSO-AREA.
   463     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   464         88  APPROVAL-NEEDED                        VALUE 'Y'.
   465     12  WS-APPROV-NOTE                  PIC X(43)
   466         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   467     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   468     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   469     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   470     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   471     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   472     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   473     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   474         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   475     12  WS-PAYEE-CITY-STATE     PIC X(30).
   476     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   477         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   478     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   479
   480 01  ERROR-MESSAGES.
   481     12  ER-0000                 PIC X(4)  VALUE '0000'.
   482     12  ER-0004                 PIC X(4)  VALUE '0004'.
   483     12  ER-0008                 PIC X(4)  VALUE '0008'.
   484     12  ER-0019                 PIC X(4)  VALUE '0019'.
   485     12  ER-0029                 PIC X(4)  VALUE '0029'.
   486     12  ER-0042                 PIC X(4)  VALUE '0042'.
   487     12  ER-0070                 PIC X(4)  VALUE '0070'.
   488     12  ER-0130                 PIC X(4)  VALUE '0130'.
   489     12  ER-0149                 PIC X(4)  VALUE '0149'.
   490     12  ER-0154                 PIC X(4)  VALUE '0154'.
   491     12  ER-0168                 PIC X(4)  VALUE '0168'.
   492     12  ER-0169                 PIC X(4)  VALUE '0169'.
   493     12  ER-0172                 PIC X(4)  VALUE '0174'.
   494     12  ER-0198                 PIC X(4)  VALUE '0198'.
   495     12  ER-0204                 PIC X(4)  VALUE '0204'.
   496     12  ER-0206                 PIC X(4)  VALUE '0206'.
   497     12  ER-0252                 PIC X(4)  VALUE '0252'.
   498     12  ER-0254                 PIC X(4)  VALUE '0254'.
   499     12  ER-0282                 PIC X(4)  VALUE '0282'.
   500     12  ER-0283                 PIC X(4)  VALUE '0283'.
   501     12  ER-0294                 PIC X(4)  VALUE '0294'.
   502     12  ER-0338                 PIC X(4)  VALUE '0338'.
   503     12  ER-0419                 PIC X(4)  VALUE '0419'.
   504     12  ER-0420                 PIC X(4)  VALUE '0420'.
   505     12  ER-0421                 PIC X(4)  VALUE '0421'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  11
* EL156.cbl
   506     12  ER-0422                 PIC X(4)  VALUE '0422'.
   507     12  ER-0433                 PIC X(4)  VALUE '0433'.
   508     12  ER-0436                 PIC X(4)  VALUE '0436'.
   509     12  ER-0437                 PIC X(4)  VALUE '0437'.
   510     12  ER-0438                 PIC X(4)  VALUE '0438'.
   511     12  ER-0439                 PIC X(4)  VALUE '0439'.
   512     12  ER-0440                 PIC X(4)  VALUE '0440'.
   513     12  ER-0441                 PIC X(4)  VALUE '0441'.
   514     12  ER-0442                 PIC X(4)  VALUE '0442'.
   515     12  ER-0443                 PIC X(4)  VALUE '0443'.
   516     12  ER-0444                 PIC X(4)  VALUE '0444'.
   517     12  ER-0445                 PIC X(4)  VALUE '0445'.
   518     12  ER-0446                 PIC X(4)  VALUE '0446'.
   519     12  ER-0447                 PIC X(4)  VALUE '0447'.
   520     12  ER-0448                 PIC X(4)  VALUE '0448'.
   521     12  ER-0449                 PIC X(4)  VALUE '0449'.
   522     12  ER-0452                 PIC X(4)  VALUE '0452'.
   523     12  ER-0458                 PIC X(4)  VALUE '0458'.
   524     12  ER-0459                 PIC X(4)  VALUE '0459'.
   525     12  ER-0460                 PIC X(4)  VALUE '0460'.
   526     12  ER-0461                 PIC X(4)  VALUE '0461'.
   527     12  ER-0462                 PIC X(4)  VALUE '0462'.
   528     12  ER-0463                 PIC X(4)  VALUE '0463'.
   529     12  ER-0464                 PIC X(4)  VALUE '0464'.
   530     12  ER-0465                 PIC X(4)  VALUE '0465'.
   531     12  ER-0466                 PIC X(4)  VALUE '0466'.
   532     12  ER-0467                 PIC X(4)  VALUE '0467'.
   533     12  ER-0468                 PIC X(4)  VALUE '0468'.
   534     12  ER-0469                 PIC X(4)  VALUE '0469'.
   535     12  ER-0473                 PIC X(4)  VALUE '0473'.
   536     12  ER-0474                 PIC X(4)  VALUE '0474'.
   537     12  ER-0475                 PIC X(4)  VALUE '0475'.
   538     12  ER-0476                 PIC X(4)  VALUE '0476'.
   539     12  ER-0477                 PIC X(4)  VALUE '0477'.
   540     12  ER-0478                 PIC X(4)  VALUE '0478'.
   541     12  ER-0479                 PIC X(4)  VALUE '0479'.
   542     12  ER-0481                 PIC X(4)  VALUE '0481'.
   543     12  ER-0491                 PIC X(4)  VALUE '0491'.
   544     12  ER-0492                 PIC X(4)  VALUE '0492'.
   545     12  ER-0493                 PIC X(4)  VALUE '0493'.
   546     12  ER-0494                 PIC X(4)  VALUE '0494'.
   547     12  ER-0495                 PIC X(4)  VALUE '0495'.
   548     12  ER-0499                 PIC X(4)  VALUE '0499'.
   549     12  ER-0500                 PIC X(4)  VALUE '0500'.
   550     12  ER-0501                 PIC X(4)  VALUE '0501'.
   551     12  ER-0502                 PIC X(4)  VALUE '0502'.
   552     12  ER-0508                 PIC X(4)  VALUE '0508'.
   553     12  ER-0513                 PIC X(4)  VALUE '0513'.
   554     12  ER-0518                 PIC X(4)  VALUE '0518'.
   555     12  ER-0524                 PIC X(4)  VALUE '0524'.
   556     12  ER-0525                 PIC X(4)  VALUE '0525'.
   557     12  ER-0526                 PIC X(4)  VALUE '0526'.
   558     12  ER-0530                 PIC X(4)  VALUE '0530'.
   559     12  ER-0540                 PIC X(4)  VALUE '0540'.
   560     12  ER-0541                 PIC X(4)  VALUE '0541'.
   561     12  ER-0542                 PIC X(4)  VALUE '0542'.
   562     12  ER-0543                 PIC X(4)  VALUE '0543'.
   563     12  ER-0545                 PIC X(4)  VALUE '0545'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  12
* EL156.cbl
   564     12  ER-0552                 PIC X(4)  VALUE '0552'.
   565     12  ER-0555                 PIC X(4)  VALUE '0555'.
   566     12  ER-0556                 PIC X(4)  VALUE '0556'.
   567     12  ER-0557                 PIC X(4)  VALUE '0557'.
   568     12  ER-0572                 PIC X(4)  VALUE '0572'.
   569     12  ER-0573                 PIC X(4)  VALUE '0573'.
   570     12  ER-0594                 PIC X(4)  VALUE '0594'.
   571     12  ER-0616                 PIC X(4)  VALUE '0616'.
   572     12  ER-0617                 PIC X(4)  VALUE '0617'.
   573     12  ER-0618                 PIC X(4)  VALUE '0618'.
   574     12  ER-0657                 PIC X(4)  VALUE '0657'.
   575     12  ER-0658                 PIC X(4)  VALUE '0658'.
   576     12  ER-0699                 PIC X(4)  VALUE '0699'.
   577     12  ER-0730                 PIC X(4)  VALUE '0730'.
   578     12  ER-0737                 PIC X(4)  VALUE '0737'.
   579     12  ER-0760                 PIC X(4)  VALUE '0760'.
   580     12  ER-0768                 PIC X(4)  VALUE '0768'.
   581     12  ER-0769                 PIC X(4)  VALUE '0769'.
   582     12  ER-0770                 PIC X(4)  VALUE '0770'.
   583     12  ER-0802                 PIC X(4)  VALUE '0802'.
   584     12  ER-0803                 PIC X(4)  VALUE '0803'.
   585     12  ER-0819                 PIC X(4)  VALUE '0819'.
   586     12  ER-0834                 PIC X(4)  VALUE '0834'.
   587     12  ER-0836                 PIC X(4)  VALUE '0836'.
   588     12  ER-0844                 PIC X(4)  VALUE '0844'.
   589     12  ER-0845                 PIC X(4)  VALUE '0845'.
   590     12  ER-0846                 PIC X(4)  VALUE '0846'.
   591     12  ER-0849                 PIC X(4)  VALUE '0849'.
   592     12  ER-0851                 PIC X(4)  VALUE '0851'.
   593     12  ER-0872                 PIC X(4)  VALUE '0872'.
   594     12  ER-0873                 PIC X(4)  VALUE '0873'.
   595     12  ER-0874                 PIC X(4)  VALUE '0874'.
   596     12  ER-0879                 PIC X(4)  VALUE '0879'.
   597     12  ER-0919                 PIC X(4)  VALUE '0919'.
   598     12  ER-0921                 PIC X(4)  VALUE '0921'.
   599     12  ER-0923                 PIC X(4)  VALUE '0923'.
   600     12  ER-0925                 PIC X(4)  VALUE '0925'.
   601     12  ER-0944                 PIC X(4)  VALUE '0944'.
   602     12  ER-0945                 PIC X(4)  VALUE '0945'.
   603     12  ER-0946                 PIC X(4)  VALUE '0946'.
   604     12  ER-0947                 PIC X(4)  VALUE '0947'.
   605     12  ER-0948                 PIC X(4)  VALUE '0948'.
   606     12  ER-0949                 PIC X(4)  VALUE '0949'.
   607     12  ER-0950                 PIC X(4)  VALUE '0950'.
   608     12  ER-0951                 PIC X(4)  VALUE '0951'.
   609     12  ER-0954                 PIC X(4)  VALUE '0954'.
   610     12  ER-0956                 PIC X(4)  VALUE '0956'.
   611     12  ER-0967                 PIC X(4)  VALUE '0967'.
   612     12  ER-0968                 PIC X(4)  VALUE '0968'.
   613     12  ER-0974                 PIC X(4)  VALUE '0974'.
   614     12  ER-0975                 PIC X(4)  VALUE '0975'.
   615     12  ER-1561                 PIC X(4)  VALUE '1561'.
   616     12  ER-1775                 PIC X(4)  VALUE '1775'.
   617     12  ER-1880                 PIC X(4)  VALUE '1880'.
   618     12  ER-2044                 PIC X(4)  VALUE '2044'.
   619     12  ER-3140                 PIC X(4)  VALUE '3140'.
   620     12  ER-3141                 PIC X(4)  VALUE '3141'.
   621     12  ER-3255                 PIC X(4)  VALUE '3255'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  13
* EL156.cbl
   622     12  ER-3516                 PIC X(4)  VALUE '3516'.
   623     12  ER-3527                 PIC X(4)  VALUE '3527'.
   624     12  ER-3528                 PIC X(4)  VALUE '3528'.
   625     12  ER-3529                 PIC X(4)  VALUE '3529'.
   626     12  ER-3530                 PIC X(4)  VALUE '3530'.
   627     12  ER-3531                 PIC X(4)  VALUE '3531'.
   628     12  ER-3532                 PIC X(4)  VALUE '3532'.
   629     12  ER-3533                 PIC X(4)  VALUE '3533'.
   630     12  ER-3534                 PIC X(4)  VALUE '3534'.
   631     12  ER-3535                 PIC X(4)  VALUE '3535'.
   632     12  ER-3536                 PIC X(4)  VALUE '3536'.
   633     12  ER-3537                 PIC X(4)  VALUE '3537'.
   634     12  ER-3538                 PIC X(4)  VALUE '3538'.
   635     12  ER-3539                 PIC X(4)  VALUE '3539'.
   636     12  ER-3540                 PIC X(4)  VALUE '3540'.
   637     12  ER-3541                 PIC X(4)  VALUE '3541'.
   638     12  ER-3542                 PIC X(4)  VALUE '3542'.
   639     12  ER-3543                 PIC X(4)  VALUE '3543'.
   640     12  ER-3546                 PIC X(4)  VALUE '3546'.
   641     12  ER-3549                 PIC X(4)  VALUE '3549'.
   642     12  ER-3818                 PIC X(4)  VALUE '3818'.
   643     12  ER-7540                 PIC X(4)  VALUE '7540'.
   644     12  ER-7576                 PIC X(4)  VALUE '7576'.
   645     12  ER-7830                 PIC X(4)  VALUE '7830'.
   646     12  ER-7831                 PIC X(4)  VALUE '7831'.
   647     12  ER-7832                 PIC X(4)  VALUE '7832'.
   648     12  ER-7833                 PIC X(4)  VALUE '7833'.
   649     12  ER-7834                 PIC X(4)  VALUE '7834'.
   650     12  ER-7835                 PIC X(4)  VALUE '7835'.
   651     12  ER-7836                 PIC X(4)  VALUE '7836'.
   652     12  ER-7837                 PIC X(4)  VALUE '7837'.
   653     12  ER-7838                 PIC X(4)  VALUE '7838'.
   654     12  ER-7841                 PIC X(4)  VALUE '7841'.
   655     12  ER-7844                 PIC X(4)  VALUE '7844'.
   656     12  ER-7845                 PIC X(4)  VALUE '7845'.
   657     12  ER-8000                 PIC X(4)  VALUE '8000'.
   658     12  ER-8051                 PIC X(4)  VALUE '8051'.
   659     12  ER-8052                 PIC X(4)  VALUE '8052'.
   660     12  ER-8053                 PIC X(4)  VALUE '8053'.
   661     12  ER-8054                 PIC X(4)  VALUE '8054'.
   662     12  ER-8055                 PIC X(4)  VALUE '8055'.
   663     12  ER-8056                 PIC X(4)  VALUE '8056'.
   664     12  ER-8057                 PIC X(4)  VALUE '8057'.
   665     12  ER-8058                 PIC X(4)  VALUE '8058'.
   666     12  ER-8059                 PIC X(4)  VALUE '8059'.
   667     12  ER-8060                 PIC X(4)  VALUE '8060'.
   668     12  ER-8061                 PIC X(4)  VALUE '8061'.
   669     12  ER-8062                 PIC X(4)  VALUE '8062'.
   670     12  ER-8063                 PIC X(4)  VALUE '8063'.
   671     12  ER-8064                 PIC X(4)  VALUE '8064'.
   672     12  ER-8065                 PIC X(4)  VALUE '8065'.
   673     12  ER-8066                 PIC X(4)  VALUE '8066'.
   674     12  ER-8146                 PIC X(4)  VALUE '8146'.
   675     12  ER-8147                 PIC X(4)  VALUE '8147'.
   676     12  ER-8152                 PIC X(4)  VALUE '8152'.
   677     12  ER-8153                 PIC X(4)  VALUE '8153'.
   678     12  ER-8154                 PIC X(4)  VALUE '8154'.
   679     12  ER-8155                 PIC X(4)  VALUE '8155'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  14
* EL156.cbl
   680     12  ER-8310                 PIC X(4)  VALUE '8310'.
   681     12  ER-8311                 PIC X(4)  VALUE '8311'.
   682     12  ER-8312                 PIC X(4)  VALUE '8312'.
   683     12  ER-8313                 PIC X(4)  VALUE '8313'.
   684     12  ER-8314                 PIC X(4)  VALUE '8314'.
   685     12  ER-8315                 PIC X(4)  VALUE '8315'.
   686     12  ER-8316                 PIC X(4)  VALUE '8316'.
   687     12  ER-8317                 PIC X(4)  VALUE '8317'.
   688
   689 01  CSO-WORK-FIELDS.
   690     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   691       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   692
   693     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   694     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   695         88  CERT-NOTE-ADDED           VALUE 'Y'.
   696     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   697         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   698     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   699
   700 01  SC-NP6-CERT-NOTE.
   701     12  FILLER                  PIC X(12)
   702               VALUE 'REM BENEFIT '.
   703     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   704     12  FILLER                  PIC X(8)
   705               VALUE ' + 6 MO '.
   706     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   707     12  FILLER                  PIC X(12)
   708               VALUE ' = AMT PAID '.
   709     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   710
   711 01  SC-NP6-ORIG-NOTE.
   712     12  FILLER                  PIC X(63)  VALUE
   713         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   714
   715 01  ACCESS-KEYS.
   716     12  ELARCH-KEY.
   717         16  ARCH-CO             PIC X.
   718         16  ARCH-NUMBER         PIC S9(08) COMP.
   719         16  ARCH-REC-TYPE       PIC X.
   720         16  ARCH-SEQ            PIC S9(04) COMP.
   721     12  ELMSTR-KEY.
   722         16  MSTR-COMP-CD        PIC X.
   723         16  MSTR-CARRIER        PIC X.
   724         16  MSTR-CLAIM-NO       PIC X(7).
   725         16  MSTR-CERT-NO        PIC X(11).
   726     12  ELCNTL-KEY.
   727         16  CNTL-COMP-ID        PIC X(3).
   728         16  CNTL-REC-TYPE       PIC X.
   729         16  CNTL-ACCESS         PIC X(4).
   730         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   731     12  ELCERT-KEY.
   732         16  CERT-COMP-CD        PIC X.
   733         16  CERT-CARRIER        PIC X.
   734         16  CERT-GROUPING       PIC X(6).
   735         16  CERT-STATE          PIC XX.
   736         16  CERT-ACCOUNT        PIC X(10).
   737         16  CERT-EFF-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  15
* EL156.cbl
   738         16  CERT-CERT-NO        PIC X(11).
   739     12  ELTRLR-KEY.
   740         16  TRLR-COMP-CD        PIC X.
   741         16  TRLR-CARRIER        PIC X.
   742         16  TRLR-CLAIM-NO       PIC X(7).
   743         16  TRLR-CERT-NO        PIC X(11).
   744         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   745     12  ELACTQ-KEY.
   746         16  ACTQ-COMP-CD        PIC X.
   747         16  ACTQ-CARRIER        PIC X.
   748         16  ACTQ-CLAIM-NO       PIC X(7).
   749         16  ACTQ-CERT-NO        PIC X(11).
   750     12  W-NOTE-KEY.
   751         16  W-NOTE-COMP-CD      PIC X.
   752         16  W-NOTE-CERT-KEY.
   753             20  W-NOTE-CARRIER  PIC X.
   754             20  W-NOTE-GROUPING PIC X(6).
   755             20  W-NOTE-STATE    PIC XX.
   756             20  W-NOTE-ACCOUNT  PIC X(10).
   757             20  W-NOTE-EFF-DT   PIC XX.
   758             20  W-NOTE-CERT-NO  PIC X(11).
   759     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   760     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   761     12  ERACCT-KEY.
   762         16  ERACCT-PARTIAL-KEY.
   763             20  ACCT-COMP-CD    PIC X.
   764             20  ACCT-CARRIER    PIC X.
   765             20  ACCT-GROUPING   PIC X(6).
   766             20  ACCT-STATE      PIC XX.
   767             20  ACCT-ACCOUNT    PIC X(10).
   768         16  ACCT-EXP-DT         PIC XX.
   769         16  FILLER              PIC X(4) VALUE SPACES.
   770     12  ELCHKQ-KEY.
   771         16  CHKQ-COMP-CD        PIC X.
   772         16  CHKQ-CONTROL        PIC S9(8) COMP.
   773         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   774     12  ELBENE-KEY.
   775         16  BENE-COMP-CD         PIC X.
   776         16  BENE-RECORD-TYPE     PIC X.
   777         16  BENE-NUMBER          PIC X(10).
   778     12  ERCOMP-KEY.
   779         16  COMP-COMP-CD        PIC X.
   780         16  COMP-CARRIER        PIC X.
   781         16  COMP-GROUP          PIC X(06).
   782         16  COMP-FIN-RESP       PIC X(10).
   783         16  COMP-ACCOUNT        PIC X(10).
   784         16  COMP-TYPE           PIC X.
   785
   786     12  DLO035-KEY.
   787         16  DL35-PROCESS-TYPE   PIC X.
   788         16  DL35-CREDIT-CARD    PIC X(20).
   789         16  DL35-BEN-TYPE       PIC XX.
   790         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   791         16  DL35-RETURN-CODE    PIC XX.
   792
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  16
* EL156.cbl
   794*    COPY ELCDATE.
   795******************************************************************
   796*                                                                *
   797*                                                                *
   798*                            ELCDATE.                            *
   799*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   800*                            VMOD=2.003
   801*                                                                *
   802*                                                                *
   803*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   804*                 LENGTH = 200                                   *
   805******************************************************************
   806
   807 01  DATE-CONVERSION-DATA.
   808     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   809     12  DC-OPTION-CODE                PIC X.
   810         88  BIN-TO-GREG                VALUE ' '.
   811         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   812         88  EDIT-GREG-TO-BIN           VALUE '2'.
   813         88  YMD-GREG-TO-BIN            VALUE '3'.
   814         88  MDY-GREG-TO-BIN            VALUE '4'.
   815         88  JULIAN-TO-BIN              VALUE '5'.
   816         88  BIN-PLUS-ELAPSED           VALUE '6'.
   817         88  FIND-CENTURY               VALUE '7'.
   818         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   819         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   820         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   821         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   822         88  JULIAN-TO-BIN-3            VALUE 'C'.
   823         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   824         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   825         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   826         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   827         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   828         88  CHECK-LEAP-YEAR            VALUE 'H'.
   829         88  BIN-3-TO-GREG              VALUE 'I'.
   830         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   831         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   832         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   833         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   834         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   835         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   836         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   837         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   838         88  THREE-CHARACTER-BIN
   839                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   840         88  GREGORIAN-TO-BIN
   841                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   842         88  BIN-TO-GREGORIAN
   843                  VALUES ' ' '1' 'I' '8' 'G'.
   844         88  JULIAN-TO-BINARY
   845                  VALUES '5' 'C' 'E' 'F'.
   846     12  DC-ERROR-CODE                 PIC X.
   847         88  NO-CONVERSION-ERROR        VALUE ' '.
   848         88  DATE-CONVERSION-ERROR
   849                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   850         88  DATE-IS-ZERO               VALUE '1'.
   851         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  17
* EL156.cbl
   852         88  DATE-IS-INVALID            VALUE '3'.
   853         88  DATE1-GREATER-DATE2        VALUE '4'.
   854         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   855         88  DATE-INVALID-OPTION        VALUE '9'.
   856         88  INVALID-CENTURY            VALUE 'A'.
   857         88  ONLY-CENTURY               VALUE 'B'.
   858         88  ONLY-LEAP-YEAR             VALUE 'C'.
   859         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   860     12  DC-END-OF-MONTH               PIC X.
   861         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   862     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   863         88  USE-NORMAL-PROCESS         VALUE ' '.
   864         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   865         88  ADJUST-UP-100-YRS          VALUE '2'.
   866     12  FILLER                        PIC X.
   867     12  DC-CONVERSION-DATES.
   868         16  DC-BIN-DATE-1             PIC XX.
   869         16  DC-BIN-DATE-2             PIC XX.
   870         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   871         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   872                       DC-GREG-DATE-1-EDIT.
   873             20  DC-EDIT1-MONTH        PIC 99.
   874             20  SLASH1-1              PIC X.
   875             20  DC-EDIT1-DAY          PIC 99.
   876             20  SLASH1-2              PIC X.
   877             20  DC-EDIT1-YEAR         PIC 99.
   878         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   879         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   880                     DC-GREG-DATE-2-EDIT.
   881             20  DC-EDIT2-MONTH        PIC 99.
   882             20  SLASH2-1              PIC X.
   883             20  DC-EDIT2-DAY          PIC 99.
   884             20  SLASH2-2              PIC X.
   885             20  DC-EDIT2-YEAR         PIC 99.
   886         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   887         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   888                     DC-GREG-DATE-1-YMD.
   889             20  DC-YMD-YEAR           PIC 99.
   890             20  DC-YMD-MONTH          PIC 99.
   891             20  DC-YMD-DAY            PIC 99.
   892         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   893         16  DC-GREG-DATE-1-MDY-R REDEFINES
   894                      DC-GREG-DATE-1-MDY.
   895             20  DC-MDY-MONTH          PIC 99.
   896             20  DC-MDY-DAY            PIC 99.
   897             20  DC-MDY-YEAR           PIC 99.
   898         16  DC-GREG-DATE-1-ALPHA.
   899             20  DC-ALPHA-MONTH        PIC X(10).
   900             20  DC-ALPHA-DAY          PIC 99.
   901             20  FILLER                PIC XX.
   902             20  DC-ALPHA-CENTURY.
   903                 24 DC-ALPHA-CEN-N     PIC 99.
   904             20  DC-ALPHA-YEAR         PIC 99.
   905         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   906         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   907         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   908         16  DC-JULIAN-DATE            PIC 9(05).
   909         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  18
* EL156.cbl
   910                                       PIC 9(05).
   911         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   912             20  DC-JULIAN-YEAR        PIC 99.
   913             20  DC-JULIAN-DAYS        PIC 999.
   914         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   915         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   916         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   917     12  DATE-CONVERSION-VARIBLES.
   918         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   919         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   920             20  FILLER                PIC 9(3).
   921             20  HOLD-CEN-1-CCYY.
   922                 24  HOLD-CEN-1-CC     PIC 99.
   923                 24  HOLD-CEN-1-YY     PIC 99.
   924             20  HOLD-CEN-1-MO         PIC 99.
   925             20  HOLD-CEN-1-DA         PIC 99.
   926         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   927             20  HOLD-CEN-1-R-MO       PIC 99.
   928             20  HOLD-CEN-1-R-DA       PIC 99.
   929             20  HOLD-CEN-1-R-CCYY.
   930                 24  HOLD-CEN-1-R-CC   PIC 99.
   931                 24  HOLD-CEN-1-R-YY   PIC 99.
   932             20  FILLER                PIC 9(3).
   933         16  HOLD-CENTURY-1-X.
   934             20  FILLER                PIC X(3)  VALUE SPACES.
   935             20  HOLD-CEN-1-X-CCYY.
   936                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   937                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   938             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   939             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   940         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   941             20  HOLD-CEN-1-R-X-MO     PIC XX.
   942             20  HOLD-CEN-1-R-X-DA     PIC XX.
   943             20  HOLD-CEN-1-R-X-CCYY.
   944                 24  HOLD-CEN-1-R-X-CC PIC XX.
   945                 24  HOLD-CEN-1-R-X-YY PIC XX.
   946             20  FILLER                PIC XXX.
   947         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   948         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   949         16  DC-JULIAN-DATE-1          PIC 9(07).
   950         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   951             20  DC-JULIAN-1-CCYY.
   952                 24  DC-JULIAN-1-CC    PIC 99.
   953                 24  DC-JULIAN-1-YR    PIC 99.
   954             20  DC-JULIAN-DA-1        PIC 999.
   955         16  DC-JULIAN-DATE-2          PIC 9(07).
   956         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   957             20  DC-JULIAN-2-CCYY.
   958                 24  DC-JULIAN-2-CC    PIC 99.
   959                 24  DC-JULIAN-2-YR    PIC 99.
   960             20  DC-JULIAN-DA-2        PIC 999.
   961         16  DC-GREG-DATE-A-EDIT.
   962             20  DC-EDITA-MONTH        PIC 99.
   963             20  SLASHA-1              PIC X VALUE '/'.
   964             20  DC-EDITA-DAY          PIC 99.
   965             20  SLASHA-2              PIC X VALUE '/'.
   966             20  DC-EDITA-CCYY.
   967                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  19
* EL156.cbl
   968                 24  DC-EDITA-YEAR     PIC 99.
   969         16  DC-GREG-DATE-B-EDIT.
   970             20  DC-EDITB-MONTH        PIC 99.
   971             20  SLASHB-1              PIC X VALUE '/'.
   972             20  DC-EDITB-DAY          PIC 99.
   973             20  SLASHB-2              PIC X VALUE '/'.
   974             20  DC-EDITB-CCYY.
   975                 24  DC-EDITB-CENT     PIC 99.
   976                 24  DC-EDITB-YEAR     PIC 99.
   977         16  DC-GREG-DATE-CYMD         PIC 9(08).
   978         16  DC-GREG-DATE-CYMD-R REDEFINES
   979                              DC-GREG-DATE-CYMD.
   980             20  DC-CYMD-CEN           PIC 99.
   981             20  DC-CYMD-YEAR          PIC 99.
   982             20  DC-CYMD-MONTH         PIC 99.
   983             20  DC-CYMD-DAY           PIC 99.
   984         16  DC-GREG-DATE-MDCY         PIC 9(08).
   985         16  DC-GREG-DATE-MDCY-R REDEFINES
   986                              DC-GREG-DATE-MDCY.
   987             20  DC-MDCY-MONTH         PIC 99.
   988             20  DC-MDCY-DAY           PIC 99.
   989             20  DC-MDCY-CEN           PIC 99.
   990             20  DC-MDCY-YEAR          PIC 99.
   991    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   992        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   993    12  DC-EL310-DATE                  PIC X(21).
   994    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  20
* EL156.cbl
   996*    COPY ELCLOGOF.
   997******************************************************************
   998*                                                                *
   999*                                                                *
  1000*                            ELCLOGOF.                           *
  1001*                            VMOD=2.001                          *
  1002*                                                                *
  1003*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1004*                                                                *
  1005******************************************************************
  1006 01  CLASIC-LOGOFF.
  1007     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1008     12  LOGOFF-TEXT.
  1009         16  FILLER          PIC X(5)    VALUE SPACES.
  1010         16  LOGOFF-MSG.
  1011             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1012             20  FILLER      PIC X       VALUE SPACES.
  1013             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1014         16  FILLER          PIC X(80)
  1015           VALUE '* YOU ARE NOW LOGGED OFF'.
  1016         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1017         16  FILLER          PIC X       VALUE QUOTE.
  1018         16  LOGOFF-SYS-MSG  PIC X(17)
  1019           VALUE 'S CLAS-IC SYSTEM '.
  1020     12  TEXT-MESSAGES.
  1021         16  UNACCESS-MSG    PIC X(29)
  1022             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1023         16  PGMIDERR-MSG    PIC X(17)
  1024             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  21
* EL156.cbl
  1026*    COPY ELCCALC.
  1027******************************************************************
  1028*                                                                *
  1029*                           ELCCALC.                            *
  1030*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1031*                            VMOD=2.025                          *
  1032*                                                                *
  1033*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1034*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1035*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1036*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1037*                                                                *
  1038*  PASSED TO ELRTRM                                              *
  1039*  -----------------                                             *
  1040*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1041*  ORIGINAL TERM                                                 *
  1042*  BEGINNING DATE                                                *
  1043*  ENDING DATE                                                   *
  1044*  COMPANY I.D.                                                  *
  1045*  ACCOUNT MASTER USER FIELD                                     *
  1046*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1047*  FREE LOOK DAYS                                                *
  1048*                                                                *
  1049*  RETURNED FROM ELRTRM                                          *
  1050*  ---------------------                                         *
  1051*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1052*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1053*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1054*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1055*----------------------------------------------------------------*
  1056*  PASSED TO ELRAMT                                              *
  1057*  ----------------                                              *
  1058*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1059*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1060*  ORIGINAL AMOUNT                                               *
  1061*  ALTERNATE BENEFIT (BALLON)                                    *
  1062*  A.P.R. - NET PAY ONLY                                         *
  1063*  METHOD
  1064*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1065*  COMPANY I.D.                                                  *
  1066*  BENEFIT TYPE                                                  *
  1067*                                                                *
  1068*  RETURNED FROM ELRAMT                                          *
  1069*  --------------------                                          *
  1070*  REMAINING AMOUNT 1 - CURRENT                                  *
  1071*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1072*  REMAINING AMOUNT FACTOR
  1073*----------------------------------------------------------------*
  1074*  PASSED TO ELRESV                                              *
  1075*  -----------------                                             *
  1076*  CERTIFICATE EFFECTIVE DATE                                    *
  1077*  VALUATION DATE                                                *
  1078*  PAID THRU DATE                                                *
  1079*  BENEFIT                                                       *
  1080*  INCURRED DATE                                                 *
  1081*  REPORTED DATE                                                 *
  1082*  ISSUE AGE                                                     *
  1083*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  22
* EL156.cbl
  1084*  CDT PERCENT                                                   *
  1085*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1086* *CLAIM TYPE (LIFE, A/H)                                        *
  1087* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1088* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1089*                                                                *
  1090*  RETURNED FROM ELRESV                                          *
  1091*  --------------------                                          *
  1092*  CDT TABLE USED                                                *
  1093*  CDT FACTOR USED                                               *
  1094*  PAY TO CURRENT RESERVE                                        *
  1095*  I.B.N.R. - A/H ONLY                                           *
  1096*  FUTURE (ACCRUED) AH ONLY                                      *
  1097*----------------------------------------------------------------*
  1098*  PASSED TO ELRATE                                              *
  1099*  ----------------                                              *
  1100*  CERT ISSUE DATE                                               *
  1101*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1102*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1103*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1104*  STATE CODE (CLIENT DEFINED)                                   *
  1105*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1106*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1107*  DEVIATION CODE                                                *
  1108*  ISSUE AGE                                                     *
  1109*  ORIGINAL BENEFIT AMOUNT                                       *
  1110*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1111*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1112*  BENEFIT KIND (LIFE OR A/H)                                    *
  1113*  A.P.R.                                                        *
  1114*  METHOD
  1115*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1116*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1117*  COMPANY I.D. (3 CHARACTER)                                    *
  1118*  BENEFIT CODE                                                  *
  1119*  BENEFIT OVERRIDE CODE                                         *
  1120*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1121*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1122*  JOINT INDICATOR (CSL ONLY)                                    *
  1123*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1124*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1125*                                                                *
  1126*  RETURNED FROM ELRATE                                          *
  1127*  --------------------                                          *
  1128*  CALCULATED PREMIUM                                            *
  1129*  PREMIUM RATE                                                  *
  1130*  MORTALITY CODE                                                *
  1131*  MAX ATTAINED AGE                                              *
  1132*  MAX AGE                                                       *
  1133*  MAX TERM                                                      *
  1134*  MAX MONTHLY BENEFIT                                           *
  1135*  MAX TOTAL BENIFIT                                             *
  1136*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1137*----------------------------------------------------------------*
  1138*  PASSED TO ELRFND                                              *
  1139*  ----------------                                              *
  1140*  CERT ISSUE DATE                                               *
  1141*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  23
* EL156.cbl
  1142*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1143*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1144*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1145*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1146*  STATE CODE (CLIENT DEFINED)                                   *
  1147*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1148*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1149*  DEVIATION CODE                                                *
  1150*  ISSUE AGE                                                     *
  1151*  ORIGINAL BENEFIT AMOUNT                                       *
  1152*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1153*  PROCESS TYPE (CANCEL)                                         *
  1154*  BENEFIT KIND (LIFE OR A/H)                                    *
  1155*  A.P.R.                                                        *
  1156*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1157*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1158*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1159*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1160*  COMPANY I.D. (3 CHARACTER)                                    *
  1161*  BENEFIT CODE                                                  *
  1162*  BENEFIT OVERRIDE CODE                                         *
  1163*                                                                *
  1164*  RETURNED FROM ELRFND                                          *
  1165*  --------------------                                          *
  1166*  CALCULATED REFUND                                             *
  1167*----------------------------------------------------------------*
  1168*  PASSED TO ELEARN                                              *
  1169*  ----------------                                              *
  1170*  CERT ISSUE DATE                                               *
  1171*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1172*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1173*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1174*  STATE CODE (CLIENT DEFINED)                                   *
  1175*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1176*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1177*  DEVIATION CODE                                                *
  1178*  ISSUE AGE                                                     *
  1179*  ORIGINAL BENEFIT AMOUNT                                       *
  1180*  BENEFIT KIND (LIFE OR A/H)                                    *
  1181*  A.P.R.                                                        *
  1182*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1183*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1184*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1185*  COMPANY I.D. (3 CHARACTER)                                    *
  1186*  BENEFIT CODE                                                  *
  1187*  BENEFIT OVERRIDE CODE                                         *
  1188*                                                                *
  1189*  RETURNED FROM ELEARN                                          *
  1190*  --------------------                                          *
  1191*  INDICATED  EARNINGS                                           *
  1192*----------------------------------------------------------------*
  1193*                 LENGTH = 450                                   *
  1194*                                                                *
  1195******************************************************************
  1196******************************************************************
  1197*                   C H A N G E   L O G
  1198*
  1199* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  24
* EL156.cbl
  1200*-----------------------------------------------------------------
  1201*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1202* EFFECTIVE    NUMBER
  1203*-----------------------------------------------------------------
  1204* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1205* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1206* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1207* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1208* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1209* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1210* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1211* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1212* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1213******************************************************************
  1214
  1215 01  CALCULATION-PASS-AREA.
  1216     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1217                                     COMP.
  1218
  1219     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1220       88  NO-CP-ERROR                             VALUE ZERO.
  1221       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1222                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1223       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1224       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1225       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1226       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1227       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1228       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1229       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1230       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1231       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1232       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1233       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1234       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1235       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1236       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1237       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1238       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1239       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1240
  1241     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1242       88  NO-CP-ERROR-2                           VALUE ZERO.
  1243***********************  INPUT AREAS ****************************
  1244
  1245     12  CP-CALCULATION-AREA.
  1246         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1247         16  CP-CERT-EFF-DT        PIC XX.
  1248         16  CP-VALUATION-DT       PIC XX.
  1249         16  CP-PAID-THRU-DT       PIC XX.
  1250         16  CP-BENEFIT-TYPE       PIC X.
  1251           88  CP-AH                               VALUE 'A' 'D'
  1252                                                   'I' 'U'.
  1253           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1254           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1255         16  CP-INCURRED-DT        PIC XX.
  1256         16  CP-REPORTED-DT        PIC XX.
  1257         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  25
* EL156.cbl
  1258         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1259         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1260                                     COMP-3.
  1261         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1262                                     COMP-3.
  1263         16  CP-CDT-METHOD         PIC X.
  1264           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1265           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1266           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1267         16  CP-CLAIM-TYPE         PIC X.
  1268           88  CP-AH-CLAIM                         VALUE 'A'.
  1269           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1270         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1271                                     COMP-3.
  1272         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1273                                     COMP-3.
  1274         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1275                                     COMP-3.
  1276         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1277                                     COMP-3.
  1278         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1279                                     COMP-3.
  1280         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1281                                     COMP-3.
  1282         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1283                                     COMP-3.
  1284         16  CP-REM-TERM-METHOD    PIC X.
  1285           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1286           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1287           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1288           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1289           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1290           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1291           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1292         16  CP-EARNING-METHOD     PIC X.
  1293           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1294           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1295           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1296           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1297           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1298           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1299           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1300           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1301           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1302           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1303           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1304           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1305           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1306           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1307         16  CP-PROCESS-TYPE       PIC X.
  1308           88  CP-CLAIM                            VALUE '1'.
  1309           88  CP-CANCEL                           VALUE '2'.
  1310           88  CP-ISSUE                            VALUE '3'.
  1311         16  CP-SPECIAL-CALC-CD    PIC X.
  1312           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1313           88  CP-1-MTH-INTEREST               VALUE ' '.
  1314           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1315           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  26
* EL156.cbl
  1316           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1317           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1318           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1319           88  CP-FARM-PLAN                    VALUE 'F'.
  1320           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1321           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1322           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1323           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1324           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1325           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1326           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1327           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1328           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1329           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1330                                                     'W' 'X'.
  1331           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1332           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1333           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1334           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1335           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1336           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1337           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1338           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1339           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1340           88  CP-CSL-METH-1                   VALUE '5'.
  1341           88  CP-CSL-METH-2                   VALUE '6'.
  1342           88  CP-CSL-METH-3                   VALUE '7'.
  1343           88  CP-CSL-METH-4                   VALUE '8'.
  1344
  1345         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1346                                     COMP-3.
  1347         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1348         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1349         16  CP-STATE              PIC XX          VALUE SPACE.
  1350         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1351         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1352           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1353               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1354         16  CP-R78-OPTION         PIC X.
  1355           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1356           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1357
  1358         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1359         16  CP-IBNR-RESERVE-SW    PIC X.
  1360         16  CP-CLAIM-STATUS       PIC X.
  1361         16  CP-RATE-FILE          PIC X.
  1362         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1363                                     COMP-3.
  1364
  1365         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1366         16  CP-AH-OVERRIDE-CODE   PIC X.
  1367
  1368         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1369                                     COMP-3.
  1370         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1371                                   PIC S9(5)V99 COMP-3.
  1372         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1373                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  27
* EL156.cbl
  1374         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1375                                     COMP-3.
  1376         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1377                                     COMP-3.
  1378         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1379                                  PIC S9(7)V99 COMP-3.
  1380
  1381         16  CP-PAID-FROM-DATE     PIC X(02).
  1382         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1383         16  CP-EXT-DAYS-CALC      PIC X.
  1384           88  CP-EXT-NO-CHG                   VALUE ' '.
  1385           88  CP-EXT-CHG-LF                   VALUE '1'.
  1386           88  CP-EXT-CHG-AH                   VALUE '2'.
  1387           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1388         16  CP-DOMICILE-STATE     PIC XX.
  1389         16  CP-CARRIER            PIC X.
  1390         16  CP-REIN-FLAG          PIC X.
  1391         16  CP-REM-TRM-CALC-OPTION PIC X.
  1392           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1393                      '2' '3' '4' '5'.
  1394           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1395           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1396           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1397           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1398           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1399           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1400           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1401           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1402         16  CP-SIG-SWITCH         PIC X.
  1403         16  CP-RATING-METHOD      PIC X.
  1404           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1405           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1406           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1407           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1408           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1409           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1410           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1411           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1412           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1413         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1414                                     COMP-3.
  1415         16  CP-BEN-CATEGORY       PIC X.
  1416         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1417         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1418                                   PIC S99V9(5) COMP-3.
  1419         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1420         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1421                                   PIC S99V9(5) COMP-3.
  1422         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1423         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1424         16  CP-EXPIRE-DT          PIC XX.
  1425         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1426         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1427         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1428         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1429         16  CP-DDF-SPEC-CALC      PIC X.
  1430             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1431             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  28
* EL156.cbl
  1432         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1433         16  CP-CANCEL-REASON      PIC X.
  1434         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1435         16  CP-PMT-MODE           PIC X.
  1436         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1437         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1438         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1439         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1440         16  FILLER                PIC X.
  1441
  1442***************    OUTPUT FROM ELRESV   ************************
  1443
  1444         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1445
  1446         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1447                                     COMP-3.
  1448         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1449                                     COMP-3.
  1450         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1451                                     COMP-3.
  1452         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1453                                     COMP-3.
  1454         16  FILLER                PIC X(09).
  1455***************    OUTPUT FROM ELRTRM   *************************
  1456
  1457         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1458                                     COMP-3.
  1459         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1460                                     COMP-3.
  1461         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1462                                     COMP-3.
  1463         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1464                                     COMP-3.
  1465         16  FILLER                PIC X(12).
  1466
  1467***************    OUTPUT FROM ELRAMT   *************************
  1468
  1469         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1470                                     COMP-3.
  1471         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1472                                     COMP-3.
  1473         16  FILLER                PIC X(12).
  1474
  1475***************    OUTPUT FROM ELRATE   *************************
  1476
  1477         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1478                                     COMP-3.
  1479         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1480                                     COMP-3.
  1481         16  CP-MORTALITY-CODE     PIC X(4).
  1482         16  CP-RATE-EDIT-FLAG     PIC X.
  1483             88  CP-RATES-NEED-APR                  VALUE '1'.
  1484         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1485                                     COMP-3.
  1486         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1487         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1488         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1489                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  29
* EL156.cbl
  1490         16  FILLER                PIC X(07).
  1491
  1492***************    OUTPUT FROM ELRFND   *************************
  1493
  1494         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1495                                     COMP-3.
  1496         16  CP-REFUND-TYPE-USED   PIC X.
  1497           88  CP-R-AS-R78                         VALUE '1'.
  1498           88  CP-R-AS-PRORATA                     VALUE '2'.
  1499           88  CP-R-AS-CALIF                       VALUE '3'.
  1500           88  CP-R-AS-TEXAS                       VALUE '4'.
  1501           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1502           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1503           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1504           88  CP-R-AS-MEAN                        VALUE '8'.
  1505           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1506           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1507           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1508           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1509           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1510           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1511         16  FILLER                PIC X(12).
  1512
  1513***************    OUTPUT FROM ELEARN   *************************
  1514
  1515         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1516                                     COMP-3.
  1517         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1518                                     COMP-3.
  1519         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1520                                     COMP-3.
  1521         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1522                                     COMP-3.
  1523         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1524                                     COMP-3.
  1525         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1526                                     COMP-3.
  1527         16  CP-EARNING-TYPE-USED  PIC X.
  1528           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1529           88  CP-E-AS-R78                         VALUE '1'.
  1530           88  CP-E-AS-PRORATA                     VALUE '2'.
  1531           88  CP-E-AS-TEXAS                       VALUE '4'.
  1532           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1533           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1534           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1535           88  CP-E-AS-MEAN                        VALUE '8'.
  1536           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1537         16  FILLER                PIC X(12).
  1538
  1539***************    OUTPUT FROM ELPMNT   *************************
  1540
  1541         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1542                                     COMP-3.
  1543         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1544                                     COMP-3.
  1545         16  FILLER                PIC X(12).
  1546
  1547***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  30
* EL156.cbl
  1548         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1549                                     COMP-3.
  1550         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1551                                     COMP-3.
  1552         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1553                                     COMP-3.
  1554         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1555                                     COMP-3.
  1556         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1557                                     COMP-3.
  1558         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1559                                     COMP-3.
  1560         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1561             88  OPEN-RATE-FILE                   VALUE 'O'.
  1562             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1563             88  IO-ERROR                         VALUE 'E'.
  1564
  1565         16  CP-FIRST-PAY-DATE     PIC XX.
  1566
  1567         16  CP-JOINT-INDICATOR    PIC X.
  1568
  1569         16  CP-RESERVE-REMAINING-TERM
  1570                                   PIC S9(4)V9    VALUE ZERO
  1571                                     COMP-3.
  1572
  1573         16  CP-INSURED-BIRTH-DT   PIC XX.
  1574
  1575         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1576                                     COMP-3.
  1577
  1578         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1579                                     COMP-3.
  1580
  1581         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1582                                     COMP-3.
  1583
  1584         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1585                                     COMP-3.
  1586
  1587         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1588                                     COMP-3.
  1589
  1590         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1591                                     COMP-3.
  1592
  1593         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1594                                     COMP-3.
  1595
  1596         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1597             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1598
  1599         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1600                                     COMP-3.
  1601         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1602                                     COMP-3.
  1603         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1604         16  FILLER                PIC X(15).
  1605******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  31
* EL156.cbl
  1606*    COPY ELCICALC.
  1607******************************************************************
  1608*                                                                *
  1609*                           ELCCICALC.                           *
  1610*                            VMOD=2.001                          *
  1611*                                                                *
  1612*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1613*                 CALCULATION MODULE                             *
  1614*                                                                *
  1615*  PASSED TO ELCLMI                                              *
  1616*  -----------------                                             *
  1617*  STATE                                                         *
  1618*  PRODUCT                                                       *
  1619*  COVERAGE                                                      *
  1620*  EFFECTIVE DATE                                                *
  1621*  INCURRED DATE                                                 *
  1622*  ESTABLISHED DATE                                              *
  1623*  LAST PAID DATE                                                *
  1624*  REPORTED DATE                                                 *
  1625*  CLAIM PAYMENT AMOUNT                                          *
  1626*                                                                *
  1627*  RETURNED FROM ELRTRM                                          *
  1628*  ---------------------                                         *
  1629*  RETURN CODE                                                   *
  1630*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1631*  CLAIM INTEREST AMOUNT                                         *
  1632*----------------------------------------------------------------*
  1633*----------------------------------------------------------------*
  1634*                 LENGTH = 100                                   *
  1635*                                                                *
  1636******************************************************************
  1637******************************************************************
  1638*                   C H A N G E   L O G
  1639*
  1640* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1641*-----------------------------------------------------------------
  1642*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1643* EFFECTIVE    NUMBER
  1644*-----------------------------------------------------------------
  1645* 120905    2004040700004  PEMA  NEW COPYBOOK
  1646* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1647******************************************************************
  1648
  1649 01  CLAIM-INT-PASS-AREA.
  1650     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1651                                     COMP.
  1652
  1653     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1654       88  NO-CI-ERROR                             VALUE ZERO.
  1655       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1656       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1657       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1658       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1659       88  CP-AMT-LT-5000                          VALUE '4'.
  1660       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1661       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1662       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1663       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  32
* EL156.cbl
  1664***********************  INPUT AREAS ****************************
  1665
  1666     12  CP-CALCULATION-AREA.
  1667         16  CP-COMPANY-CD         PIC X.
  1668         16  CP-STATE              PIC XX.
  1669         16  CP-PRODUCT            PIC XX.
  1670         16  CP-COVERAGE           PIC XX.
  1671         16  CP-INC-DT             PIC XX.
  1672         16  CP-EST-DT             PIC XX.
  1673         16  CP-LSTPD-DT           PIC XX.
  1674         16  CP-RPT-DT             PIC XX.
  1675         16  CP-PRF-DT             PIC XX.
  1676         16  CP-EFF-DT             PIC XX.
  1677         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1678         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1679         16  FILLER                PIC X(37).
  1680
  1681***************    OUTPUT FROM ELCLMI   ************************
  1682
  1683         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1684
  1685         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1686         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1687         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1688         16  FILLER                PIC X(19).
  1689******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  33
* EL156.cbl
  1691*    COPY ELCATTR.
  1692******************************************************************
  1693*                                                                *
  1694*                            ELCATTR.                            *
  1695*                            VMOD=2.001                          *
  1696*                                                                *
  1697*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1698*                                                                *
  1699*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1700*                                                                *
  1701*                   POS 1   P=PROTECTED                          *
  1702*                           U=UNPROTECTED                        *
  1703*                           S=ASKIP                              *
  1704*                   POS 2   A=ALPHA/NUMERIC                      *
  1705*                           N=NUMERIC                            *
  1706*                   POS 3   N=NORMAL                             *
  1707*                           B=BRIGHT                             *
  1708*                           D=DARK                               *
  1709*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1710*                           OF=MODIFIED DATA TAG OFF             *
  1711*                                                                *
  1712*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1713******************************************************************
  1714 01  ATTRIBUTE-LIST.
  1715     12  AL-PABOF            PIC X       VALUE 'Y'.
  1716     12  AL-PABON            PIC X       VALUE 'Z'.
  1717     12  AL-PADOF            PIC X       VALUE '%'.
  1718     12  AL-PADON            PIC X       VALUE '_'.
  1719     12  AL-PANOF            PIC X       VALUE '-'.
  1720     12  AL-PANON            PIC X       VALUE '/'.
  1721     12  AL-SABOF            PIC X       VALUE '8'.
  1722     12  AL-SABON            PIC X       VALUE '9'.
  1723     12  AL-SADOF            PIC X       VALUE '@'.
  1724     12  AL-SADON            PIC X       VALUE QUOTE.
  1725     12  AL-SANOF            PIC X       VALUE '0'.
  1726     12  AL-SANON            PIC X       VALUE '1'.
  1727     12  AL-UABOF            PIC X       VALUE 'H'.
  1728     12  AL-UABON            PIC X       VALUE 'I'.
  1729     12  AL-UADOF            PIC X       VALUE '<'.
  1730     12  AL-UADON            PIC X       VALUE '('.
  1731     12  AL-UANOF            PIC X       VALUE ' '.
  1732     12  AL-UANON            PIC X       VALUE 'A'.
  1733     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1734     12  AL-UNBON            PIC X       VALUE 'R'.
  1735     12  AL-UNDOF            PIC X       VALUE '*'.
  1736     12  AL-UNDON            PIC X       VALUE ')'.
  1737     12  AL-UNNOF            PIC X       VALUE '&'.
  1738     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  34
* EL156.cbl
  1740*    COPY ELCEMIB.
  1741******************************************************************
  1742*                                                                *
  1743*                                                                *
  1744*                            ELCEMIB.                            *
  1745*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1746*                            VMOD=2.005                          *
  1747*                                                                *
  1748*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1749*                                                                *
  1750******************************************************************
  1751 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1752     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1753     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1754     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1755     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1756     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1757     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1758     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1759     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1760     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1761         88  EMI-NO-ERRORS                    VALUE '1'.
  1762         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1763         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1764     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1765         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1766     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1767         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1768         88  EMI-AREA1-FULL                   VALUE '2'.
  1769     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1770         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1771         88  EMI-AREA2-FULL                   VALUE '2'.
  1772     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1773         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1774         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1775         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1776         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1777         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1778     12  EMI-ERROR-LINES.
  1779         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1780         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1781         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1782         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1783             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1784                 24  EMI-ERR-NUM         PIC X(4).
  1785                 24  EMI-FILLER          PIC X.
  1786                 24  EMI-SEV             PIC X.
  1787                 24  FILLER              PIC X.
  1788             20  FILLER                  PIC X(02).
  1789     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1790         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1791             20  EMI-ERROR-NUMBER    PIC X(4).
  1792             20  EMI-FILL            PIC X.
  1793             20  EMI-SEVERITY        PIC X.
  1794             20  FILLER              PIC X.
  1795             20  EMI-ERROR-TEXT.
  1796                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1797                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  35
* EL156.cbl
  1798     12  EMI-SEVERITY-SAVE           PIC X.
  1799         88  EMI-NOTE                    VALUE 'N'.
  1800         88  EMI-WARNING                 VALUE 'W'.
  1801         88  EMI-FORCABLE                VALUE 'F'.
  1802         88  EMI-FATAL                   VALUE 'X'.
  1803     12  EMI-MESSAGE-FLAG            PIC X.
  1804         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1805         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1806     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1807     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1808         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1809         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1810         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1811     12  FILLER                      PIC X(137)  VALUE SPACES.
  1812     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1813     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1814     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1815     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  36
* EL156.cbl
  1817*    COPY ELCLNKLT.
  1818******************************************************************
  1819*                                                                *
  1820*                                                                *
  1821*                           ELCLNKLT                             *
  1822*                            VMOD=2.003                          *
  1823*                                                                *
  1824*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1825*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1826*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1827*                                                                *
  1828*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1829*   COMPLETING THE REQUIRED FIELDS.                              *
  1830*                                                                *
  1831*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1832*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1833*                              9999 INDICATES AN UNKNOWN ABEND   *
  1834*                                   WAS DETECTED.                *
  1835*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1836*                              CODES FOUND IN THE ERROR FILE.    *
  1837******************************************************************
  1838 01  W-1523-LINKDATA.
  1839     12  W-1523-COMMON-PI-DATA.
  1840         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1841         16  FILLER              PIC  X(67).
  1842         16  W-1523-COMPANY-CD   PIC  X(01).
  1843         16  FILLER              PIC  X(10).
  1844         16  W-1523-CONTROL-IN-PROGRESS.
  1845             20  W-1523-CARRIER  PIC  X(01).
  1846             20  W-1523-GROUPING PIC  X(06).
  1847             20  W-1523-STATE    PIC  X(02).
  1848             20  W-1523-ACCOUNT  PIC  X(10).
  1849             20  W-1523-CLAIM-CERT-GRP.
  1850                 24  W-1523-CLAIM-NO
  1851                                 PIC  X(07).
  1852                 24  W-1523-CERT-NO.
  1853                     28  W-1523-CERT-PRIME
  1854                                 PIC  X(10).
  1855                     28  W-1523-CERT-SFX
  1856                                 PIC  X(01).
  1857                 24  W-1523-CERT-EFF-DT
  1858                                 PIC  X(02).
  1859         16  FILLER              PIC X(265).
  1860
  1861     12  W-1523-WORK-AREA.
  1862         16  W-1523-FORM-NUMBER  PIC  X(04).
  1863         16  W-1523-NUMBER-COPIES
  1864                                 PIC  9(01).
  1865         16  W-1523-ADDR-TYPE    PIC  X(02).
  1866         16  W-1523-FOLLOW-UP-DATE
  1867                                 PIC  X(02).
  1868         16  W-1523-RESEND-DATE  PIC  X(02).
  1869         16  W-1523-ERROR-CODE   PIC  9(04).
  1870             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1871             88  W-1523-FATAL-ERROR
  1872                                    VALUES  0006 0013 0042
  1873                                            0154 0168 0169
  1874                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  37
* EL156.cbl
  1875                                            0179 0186 0281
  1876                                            0332 2055 3697
  1877                                            3698 3699 3770
  1878                                            3771 3772 7675
  1879                                            9106 9808 9883
  1880                                            9887.
  1881             88  W-1523-STOP-ERRORS
  1882                                    VALUES  0013 0042 0154
  1883                                            0168 0169 0172
  1884                                            0281 0332 2055
  1885                                            3698 3699 7675
  1886                                            9106 9808 9883
  1887                                            9999.
  1888         16  W-1523-REASON       PIC  X(70).
  1889         16  W-1523-ARCHIVE-NUMBER
  1890                                 PIC  9(08).
  1891     12  W-1523-POINTER-AREA.
  1892         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1893         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1894         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1895         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1896         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  38
* EL156.cbl
  1898*    COPY ELCNWA.
  1899*****************************************************************
  1900*                                                               *
  1901*                                                               *
  1902*                            ELCNWA.                            *
  1903*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1904*                            VMOD=2.003                         *
  1905*                                                               *
  1906*            M O V E   N A M E   W O R K   A R E A.             *
  1907*                                                               *
  1908*****************************************************************.
  1909
  1910 01  WS-NAME-WORK-AREA.
  1911     05  WS-INSURED-LAST-NAME        PIC X(15).
  1912     05  WS-INSURED-1ST-NAME         PIC X(12).
  1913     05  WS-INSURED-MID-INIT         PIC X.
  1914
  1915     05  WS-NAME-WORK.
  1916         10  WS-NW                   PIC X
  1917             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1918
  1919     05  WS-NAME-WORK2.
  1920         10  WS-NW2                  PIC X
  1921             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1922                                        NWA-INDEX0.
  1923
  1924     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1925                                     COMP-3.
  1926
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  39
* EL156.cbl
  1928*    COPY ELCDMO.
  1929******************************************************************
  1930*                                                                *
  1931*                                                                *
  1932*                            ELCDMO.                             *
  1933*                            VMOD=2.004                          *
  1934*                                                                *
  1935*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  1936*        COMMUNICATION AREA                                      *
  1937*   FILE TYPE = NA                                               *
  1938*   RECORD SIZE = 110    RECFORM = FIXED                         *
  1939*                                                                *
  1940******************************************************************
  1941 01  DMO-COMMUNICATION-AREA.
  1942     12  DM-RECORD-TYPE                  PIC  X(02).
  1943             88  DM-ISSUE-TRAN                VALUE 'CC'.
  1944             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  1945             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  1946     12  DM-DIST-CODE                    PIC  X(04).
  1947     12  DM-MAIL-CODE                    PIC  X(05).
  1948     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  1949     12  DM-INSURED-NAME                 PIC  X(30).
  1950     12  DM-CLAIM-NO                     PIC  X(07).
  1951     12  DM-CLAIM-TYPE                   PIC  X.
  1952
  1953     12  DM-STATUS-DATA-AREA.
  1954         16  DM-CLAIM-STATUS             PIC  X.
  1955             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  1956             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  1957             88  DM-CLOSED                        VALUE '3'.
  1958             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  1959             88  DM-DEFAULT                       VALUE '9'.
  1960         16  DM-STATUS-DATE              PIC  X(08).
  1961******YYYYMMDD
  1962         16  DM-STAT-CHANGE-TYPE         PIC  X.
  1963             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  1964             88  DM-CLAIM-DENIED                  VALUE 'D'.
  1965             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  1966             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  1967             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  1968             88  DM-RE-OPENED                     VALUE 'R'.
  1969             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  1970             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  1971             88  DM-CLAIM-DELETED                 VALUE 'X'.
  1972         16  DM-STAT-CARRIER             PIC X.
  1973
  1974     12  DM-DRAFT-DATA-AREA.
  1975         16  DM-PAYMENT-TYPE             PIC  X.
  1976             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  1977         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  1978         16  DM-PAYMENT-DATE             PIC  X(08).
  1979******YYYYMMDD
  1980         16  DM-CERT-NO                  PIC  X(11).
  1981         16  DM-TRLR-SEQ-NO              PIC  9(04).
  1982         16  DM-CARRIER                  PIC  X.
  1983
  1984     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  40
* EL156.cbl
  1986*    COPY ELCDMDCD.
  1987******************************************************************
  1988*                                                                *
  1989*                                                                *
  1990*                            ELCDMDCD.                           *
  1991*                            VMOD=2.001                          *
  1992*                                                                *
  1993*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  1994*       COMMUNICATIONS AREA                                      *
  1995*                                                                *
  1996******************************************************************
  1997 01  CD-COMMUNICATION-AREA.
  1998     12  CD-SYSTEM-ID            PIC  X(02).
  1999         88 CD-CLAIMS                      VALUE 'CL'.
  2000         88 CD-CREDIT                      VALUE 'CR'.
  2001     12  CD-RECORD-TYPE          PIC  X(02).
  2002         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2003         88 CD-EOB-CODE                    VALUE 'EO'.
  2004         88 CD-ICD9-CODE                   VALUE 'I9'.
  2005         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2006         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2007         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2008         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2009         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2010     12  CD-RECORD-KEY           PIC  X(06).
  2011         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2012     12  CD-RETURN-CODE          PIC  X(02).
  2013     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2014     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2015     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2016     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  41
* EL156.cbl
  2018*    COPY ELCDCTB.
  2019******************************************************************
  2020*                                                                *
  2021*                                                                *
  2022*                            ELCDCTB.                            *
  2023*                            VMOD=2.002                          *
  2024*                                                                *
  2025*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2026*       COMMUNICATIONS AREA                                      *
  2027*                                                                *
  2028******************************************************************
  2029 01  DCT-COMMUNICATION-AREA.
  2030     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2031     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2032     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2033     12  DCT-PRODUCT-CODE         PIC  X(02).
  2034     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2035     12  DCT-RETURN-CODE          PIC  X(02).
  2036     12  DCT-MAIL-CODE            PIC  X(05).
  2037     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2038     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  42
* EL156.cbl
  2040 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2041 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2042 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2043 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  43
* EL156.cbl
  2045*    COPY ELCINTF.
  2046******************************************************************
  2047*                                                                *
  2048*                                                                *
  2049*                            ELCINTF.                            *
  2050*                            VMOD=2.017                          *
  2051*                                                                *
  2052*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2053*                                                                *
  2054*       LENGTH = 1024                                            *
  2055*                                                                *
  2056******************************************************************
  2057 01  PROGRAM-INTERFACE-BLOCK.
  2058     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2059     12  PI-CALLING-PROGRAM              PIC X(8).
  2060     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2061     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2062     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2063     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2064     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2065     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2066     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2067     12  PI-COMPANY-ID                   PIC XXX.
  2068     12  PI-COMPANY-CD                   PIC X.
  2069
  2070     12  PI-COMPANY-PASSWORD             PIC X(8).
  2071
  2072     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2073
  2074     12  PI-CONTROL-IN-PROGRESS.
  2075         16  PI-CARRIER                  PIC X.
  2076         16  PI-GROUPING                 PIC X(6).
  2077         16  PI-STATE                    PIC XX.
  2078         16  PI-ACCOUNT                  PIC X(10).
  2079         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2080                                         PIC X(10).
  2081         16  PI-CLAIM-CERT-GRP.
  2082             20  PI-CLAIM-NO             PIC X(7).
  2083             20  PI-CERT-NO.
  2084                 25  PI-CERT-PRIME       PIC X(10).
  2085                 25  PI-CERT-SFX         PIC X.
  2086             20  PI-CERT-EFF-DT          PIC XX.
  2087         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2088             20  PI-PLAN-CODE            PIC X(2).
  2089             20  PI-REVISION-NUMBER      PIC X(3).
  2090             20  PI-PLAN-EFF-DT          PIC X(2).
  2091             20  PI-PLAN-EXP-DT          PIC X(2).
  2092             20  FILLER                  PIC X(11).
  2093         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  2094             20  PI-OE-REFERENCE-1.
  2095                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2096                 25  PI-OE-REF-1-SUFF    PIC XX.
  2097
  2098     12  PI-SESSION-IN-PROGRESS          PIC X.
  2099         88  CLAIM-SESSION                   VALUE '1'.
  2100         88  CREDIT-SESSION                  VALUE '2'.
  2101         88  WARRANTY-SESSION                VALUE '3'.
  2102         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  44
* EL156.cbl
  2103         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2104
  2105
  2106*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2107
  2108     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2109     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2110
  2111     12  PI-CREDIT-USER                  PIC X.
  2112         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2113         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2114
  2115     12  PI-CLAIM-USER                   PIC X.
  2116         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2117         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2118
  2119     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2120         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2121         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2122         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2123         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2124         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2125
  2126     12  PI-PROCESSOR-ID                 PIC X(4).
  2127
  2128     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2129
  2130     12  PI-MEMBER-CAPTION               PIC X(10).
  2131
  2132     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2133         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2134
  2135     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2136     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2137     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2138     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2139
  2140     12  PI-AH-OVERRIDE-L1               PIC X.
  2141     12  PI-AH-OVERRIDE-L2               PIC XX.
  2142     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2143     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2144
  2145     12  PI-NEW-SYSTEM                   PIC X(2).
  2146
  2147     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2148     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2149         88  PI-USES-PAID-TO                 VALUE '1'.
  2150     12  PI-CRDTCRD-SYSTEM.
  2151         16  PI-CRDTCRD-USER             PIC X.
  2152             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2153             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2154         16  PI-CC-MONTH-END-DT          PIC XX.
  2155     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2156
  2157     12  PI-OE-REFERENCE-2.
  2158         16  PI-OE-REF-2-PRIME           PIC X(10).
  2159         16  PI-OE-REF-2-SUFF            PIC X.
  2160
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  45
* EL156.cbl
  2161     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2162
  2163     12  PI-LANGUAGE-TYPE                PIC X.
  2164             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2165             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2166             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2167
  2168     12  PI-POLICY-LINKAGE-IND           PIC X.
  2169         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2170         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2171                                                   LOW-VALUES.
  2172
  2173     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2174     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2175         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2176         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2177     12  FILLER                          PIC X(4).
  2178
  2179     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2180
  2181     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2182         PI-SYSTEM-LEVEL.
  2183
  2184         16  PI-ENTRY-CODES.
  2185             20  PI-ENTRY-CD-1           PIC X.
  2186             20  PI-ENTRY-CD-2           PIC X.
  2187
  2188         16  PI-RETURN-CODES.
  2189             20  PI-RETURN-CD-1          PIC X.
  2190             20  PI-RETURN-CD-2          PIC X.
  2191
  2192         16  PI-UPDATE-STATUS-SAVE.
  2193             20  PI-UPDATE-BY            PIC X(4).
  2194             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2195
  2196         16  PI-LOWER-CASE-LETTERS       PIC X.
  2197             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2198
  2199*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2200*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2201*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2202
  2203         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2204             88  ST-ACCNT-CNTL               VALUE ' '.
  2205             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2206             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2207             88  ACCNT-CNTL                  VALUE '3'.
  2208             88  CARR-ACCNT-CNTL             VALUE '4'.
  2209
  2210         16  PI-PROCESSOR-CAP-LIST.
  2211             20  PI-SYSTEM-CONTROLS.
  2212                24 PI-SYSTEM-DISPLAY     PIC X.
  2213                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2214                24 PI-SYSTEM-MODIFY      PIC X.
  2215                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2216             20  FILLER                  PIC XX.
  2217             20  PI-DISPLAY-CAP          PIC X.
  2218                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  46
* EL156.cbl
  2219             20  PI-MODIFY-CAP           PIC X.
  2220                 88  MODIFY-CAP              VALUE 'Y'.
  2221             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2222                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2223             20  PI-FORCE-CAP            PIC X.
  2224                 88  FORCE-CAP               VALUE 'Y'.
  2225
  2226         16  PI-PROGRAM-CONTROLS.
  2227             20  PI-PGM-PRINT-OPT        PIC X.
  2228             20  PI-PGM-FORMAT-OPT       PIC X.
  2229             20  PI-PGM-PROCESS-OPT      PIC X.
  2230             20  PI-PGM-TOTALS-OPT       PIC X.
  2231
  2232         16  PI-HELP-INTERFACE.
  2233             20  PI-LAST-ERROR-NO        PIC X(4).
  2234             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2235
  2236         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2237             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2238
  2239         16  PI-CR-CONTROL-IN-PROGRESS.
  2240             20  PI-CR-CARRIER           PIC X.
  2241             20  PI-CR-GROUPING          PIC X(6).
  2242             20  PI-CR-STATE             PIC XX.
  2243             20  PI-CR-ACCOUNT           PIC X(10).
  2244             20  PI-CR-FIN-RESP          PIC X(10).
  2245             20  PI-CR-TYPE              PIC X.
  2246
  2247         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2248
  2249         16  PI-CR-MONTH-END-DT          PIC XX.
  2250
  2251         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2252             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2253             88  PI-ZERO-CARRIER             VALUE '1'.
  2254             88  PI-ZERO-GROUPING            VALUE '2'.
  2255             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2256
  2257         16  PI-CARRIER-SECURITY         PIC X.
  2258             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2259
  2260         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2261             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2262             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  2263
  2264         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2265             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2266                                         INDEXED BY PI-ACCESS-NDX
  2267                                         PIC X.
  2268
  2269         16  PI-GA-BILLING-CONTROL       PIC X.
  2270             88  PI-GA-BILLING               VALUE '1'.
  2271
  2272         16  PI-MAIL-PROCESSING          PIC X.
  2273             88  PI-MAIL-YES                 VALUE 'Y'.
  2274
  2275         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2276
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  47
* EL156.cbl
  2277         16  PI-AR-SYSTEM.
  2278             20  PI-AR-PROCESSING-CNTL   PIC X.
  2279                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2280             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2281             20  PI-AR-MONTH-END-DT      PIC XX.
  2282
  2283         16  PI-MP-SYSTEM.
  2284             20  PI-MORTGAGE-USER            PIC X.
  2285                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2286                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2287             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2288                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2289                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2290                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2291                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2292                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2293             20  PI-MP-MONTH-END-DT          PIC XX.
  2294             20  PI-MP-REFERENCE-NO.
  2295                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2296                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2297
  2298         16  PI-LABEL-CONTROL            PIC X(01).
  2299             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2300             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2301
  2302         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2303             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2304
  2305         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2306             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2307             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2308
  2309         16  FILLER                      PIC X(14).
  2310
  2311     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2312******************************************************************
  2313     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2314         16  PI-SAVE-FORM        PIC X(12).
  2315         16  PI-ACCT-KEY         PIC X(26).
  2316         16  PI-PAYEE-NAME       PIC X(30).
  2317         16  PI-DAILY-RATE       PIC S9(3)V99.
  2318         16  PI-MONTH-END-SAVE   PIC XX.
  2319         16  PI-BENEFIT-SAVE.
  2320             20  PI-BEN-DAYS     PIC 99.
  2321             20  PI-BEN-TYPE     PIC X.
  2322         16  PI-MANUAL-SW        PIC 9.
  2323         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2324         16  PI-PASS-SW          PIC X.
  2325         16  PI-PFKEY-USED       PIC X.
  2326         16  PI-CK-ASSIGN        PIC X.
  2327         16  PI-FATAL-COUNT      PIC 99.
  2328         16  PI-FORCE-COUNT      PIC 99.
  2329         16  PI-SAVE-INPUT.
  2330             20  PI-PMTTYPE      PIC X.
  2331             20  PI-PAYEE.
  2332                 24  PI-PAYEE-TYPE PIC X.
  2333                 24  PI-PAYEE-SEQ  PIC X.
  2334                 24  PI-PAYEE-SEQ-NUM REDEFINES
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  48
* EL156.cbl
  2335                   PI-PAYEE-SEQ    PIC S9.
  2336             20  PI-PMTNOTE1     PIC X(60).
  2337             20  PI-PMTNOTE2     PIC X(60).
  2338             20  PI-OFFLINE      PIC X.
  2339             20  PI-ECHECKNO     PIC X(7).
  2340             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2341                 28  PI-ECHECKNO-N     PIC X.
  2342                 28  PI-ECHECKNO-6     PIC X(6).
  2343             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2344                 24  PI-ECHECKNO-CR    PIC XX.
  2345                 24  PI-ECHECKNO-5     PIC X(5).
  2346             20  PI-HOLDTIL      PIC 9(6).
  2347             20  PI-EPYFROM      PIC 9(6).
  2348             20  PI-EPYTHRU      PIC 9(6).
  2349             20  PI-EDAYS        PIC S9(5).
  2350             20  PI-EPYAMT       PIC S9(7)V99.
  2351             20  PI-ERESV        PIC S9(7)V99.
  2352             20  PI-EEXPENS      PIC 9(6)V99.
  2353             20  PI-ETYPE        PIC X.
  2354             20  PI-CASH         PIC X.
  2355             20  PI-GROUPED      PIC X.
  2356             20  PI-INT-RATE     PIC S99V9(5).
  2357             20  PI-AIGFROM      PIC 9(6).
  2358             20  PI-LOAN-NO      PIC X(20).
  2359             20  PI-PROOF-DATE   PIC 9(6).
  2360             20  PI-PRINT-EOB-YN PIC X.
  2361         16  PI-SAVE-COMPUTED.
  2362             20  PI-CCHECKNO     PIC X(7).
  2363             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2364                 28  PI-CCHECKNO-N     PIC X.
  2365                 28  PI-CCHECKNO-6     PIC X(6).
  2366             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2367                 24  PI-CCHECKNO-CR    PIC XX.
  2368                 24  PI-CCHECKNO-5     PIC X(5).
  2369             20  PI-CPYFROM      PIC XX.
  2370             20  PI-CPYTHRU      PIC XX.
  2371             20  PI-CDAYS        PIC S9(5).
  2372             20  PI-CPYAMT       PIC S9(7)V99.
  2373             20  PI-CRESV        PIC 9(6)V99.
  2374             20  PI-CEXPENS      PIC 9(6)V99.
  2375             20  PI-PMT-APPR-SW  PIC X.
  2376                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2377                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2378                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2379         16  PI-PREV-CLMNO       PIC X(7).
  2380         16  PI-LF-COVERAGE-TYPE PIC X.
  2381         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2382         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2383         16  PI-PROVISIONAL-IND  PIC X.
  2384             88 PI-PROV-PMT      VALUE 'P'.
  2385         16  PI-PREV-TRLR-KEY    PIC X(22).
  2386         16  PI-SPLIT-PMT-SW     PIC X.
  2387         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2388         16  PI-ACTIVITY-CODE    PIC 99.
  2389         16  PI-RESET-SW         PIC X.
  2390         16  PI-SPECIAL-BEN-SW   PIC X.
  2391             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2392         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  49
* EL156.cbl
  2393         16  PI-EXP-DT           PIC XX.
  2394         16  PI-LOAN-DUE-DAY     PIC 99.
  2395         16  PI-3RD-PARTY-SW     PIC X.
  2396         16  PI-LOAN-UPDATE-SW   PIC X.
  2397
  2398         16  PI-DMD-DATA.
  2399             20  PI-SV-CERT-KEY       PIC X(21).
  2400             20  PI-SV-CERT-NO        PIC X(11).
  2401             20  PI-SV-BEN            PIC X(10).
  2402             20  PI-SV-CCN            PIC X(16).
  2403             20  PI-INTEREST-PAID-IND PIC X.
  2404                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2405             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2406             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2407             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2408             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2409         16  PI-AT-EOB-CODES.
  2410             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2411         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2412         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2413         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2414         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2415         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2416         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2417         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2418         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2419         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2420         16  PI-LF-BENEFIT-CD         PIC X(2).
  2421         16  PI-EOB-CODES-EXIST PIC X.
  2422         16  PI-SET-NOTE2-MDT   PIC X.
  2423         16  PI-VFY-2ND-BENE          PIC X.
  2424*00781          16  FILLER                   PIC X(176).
  2425*052506         16  FILLER                   PIC X(161).
  2426*031808         16  FILLER                   PIC X(154).
  2427*091808         16  FILLER                   PIC X(152).
  2428*041710         16  FILLER                   PIC X(94).
  2429         16  FILLER                   PIC X(93).
  2430
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  50
* EL156.cbl
  2432*    COPY ELCJPFX.
  2433******************************************************************
  2434*                                                                *
  2435*                                                                *
  2436*                            ELCJPFX.                            *
  2437*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2438*                            VMOD=2.002                          *
  2439*                                                                *
  2440*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2441*                                                                *
  2442*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2443*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2444*        ELCNTL - CONTROL FILE                                   *
  2445*        ELMSTR - CLAIM MASTERS                                  *
  2446*        ELTRLR - ACTIVITY TRAILERS                              *
  2447*        ELCHKQ - CHECK QUE                                      *
  2448******************************************************************
  2449 01  JOURNAL-RECORD.
  2450     12  JP-USER-ID                  PIC X(4).
  2451     12  JP-FILE-ID                  PIC X(8).
  2452     12  JP-PROGRAM-ID               PIC X(8).
  2453     12  JP-RECORD-TYPE              PIC X.
  2454         88 JP-ADD              VALUE 'A'.
  2455         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2456         88 JP-AFTER-CHANGE     VALUE 'C'.
  2457         88 JP-DELETE           VALUE 'D'.
  2458         88 JP-GENERIC-DELETE   VALUE 'G'.
  2459         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2460         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2461     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2462     12  JP-RECORD-AREA
  2463
  2464
  2465                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  51
* EL156.cbl
  2467*    COPY ELCAID.
  2468******************************************************************
  2469*                                                                *
  2470*                            ELCAID.                             *
  2471*                            VMOD=2.001                          *
  2472*                                                                *
  2473*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2474*                                                                *
  2475*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2476*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2477******************************************************************
  2478
  2479 01  DFHAID.
  2480   02  DFHNULL   PIC  X  VALUE  ' '.
  2481   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2482   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2483   02  DFHPEN    PIC  X  VALUE  '='.
  2484   02  DFHOPID   PIC  X  VALUE  'W'.
  2485   02  DFHPA1    PIC  X  VALUE  '%'.
  2486   02  DFHPA2    PIC  X  VALUE  '>'.
  2487   02  DFHPA3    PIC  X  VALUE  ','.
  2488   02  DFHPF1    PIC  X  VALUE  '1'.
  2489   02  DFHPF2    PIC  X  VALUE  '2'.
  2490   02  DFHPF3    PIC  X  VALUE  '3'.
  2491   02  DFHPF4    PIC  X  VALUE  '4'.
  2492   02  DFHPF5    PIC  X  VALUE  '5'.
  2493   02  DFHPF6    PIC  X  VALUE  '6'.
  2494   02  DFHPF7    PIC  X  VALUE  '7'.
  2495   02  DFHPF8    PIC  X  VALUE  '8'.
  2496   02  DFHPF9    PIC  X  VALUE  '9'.
  2497   02  DFHPF10   PIC  X  VALUE  ':'.
  2498   02  DFHPF11   PIC  X  VALUE  '#'.
  2499   02  DFHPF12   PIC  X  VALUE  '@'.
  2500   02  DFHPF13   PIC  X  VALUE  'A'.
  2501   02  DFHPF14   PIC  X  VALUE  'B'.
  2502   02  DFHPF15   PIC  X  VALUE  'C'.
  2503   02  DFHPF16   PIC  X  VALUE  'D'.
  2504   02  DFHPF17   PIC  X  VALUE  'E'.
  2505   02  DFHPF18   PIC  X  VALUE  'F'.
  2506   02  DFHPF19   PIC  X  VALUE  'G'.
  2507   02  DFHPF20   PIC  X  VALUE  'H'.
  2508   02  DFHPF21   PIC  X  VALUE  'I'.
  2509*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2510   02  DFHPF22   PIC  X  VALUE  '['.
  2511   02  DFHPF23   PIC  X  VALUE  '.'.
  2512   02  DFHPF24   PIC  X  VALUE  '<'.
  2513   02  DFHMSRE   PIC  X  VALUE  'X'.
  2514   02  DFHSTRF   PIC  X  VALUE  'h'.
  2515   02  DFHTRIG   PIC  X  VALUE  '"'.
  2516 01  FILLER    REDEFINES DFHAID.
  2517     12  FILLER              PIC X(8).
  2518     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  52
* EL156.cbl
  2520*    COPY EL156S.
  2521 01  EL156AI.
  2522     05  FILLER            PIC  X(0012).
  2523*    -------------------------------
  2524     05  RUNDTEAL PIC S9(0004) COMP.
  2525     05  RUNDTEAF PIC  X(0001).
  2526     05  FILLER REDEFINES RUNDTEAF.
  2527         10  RUNDTEAA PIC  X(0001).
  2528     05  RUNDTEAI PIC  X(0008).
  2529*    -------------------------------
  2530     05  RUNTIMAL PIC S9(0004) COMP.
  2531     05  RUNTIMAF PIC  X(0001).
  2532     05  FILLER REDEFINES RUNTIMAF.
  2533         10  RUNTIMAA PIC  X(0001).
  2534     05  RUNTIMAI PIC  X(0005).
  2535*    -------------------------------
  2536     05  SEQUL PIC S9(0004) COMP.
  2537     05  SEQUF PIC  X(0001).
  2538     05  FILLER REDEFINES SEQUF.
  2539         10  SEQUA PIC  X(0001).
  2540     05  SEQUI PIC  X(0010).
  2541*    -------------------------------
  2542     05  CLMNOL PIC S9(0004) COMP.
  2543     05  CLMNOF PIC  X(0001).
  2544     05  FILLER REDEFINES CLMNOF.
  2545         10  CLMNOA PIC  X(0001).
  2546     05  CLMNOI PIC  X(0007).
  2547*    -------------------------------
  2548     05  CARRL PIC S9(0004) COMP.
  2549     05  CARRF PIC  X(0001).
  2550     05  FILLER REDEFINES CARRF.
  2551         10  CARRA PIC  X(0001).
  2552     05  CARRI PIC  X(0001).
  2553*    -------------------------------
  2554     05  CERTNOL PIC S9(0004) COMP.
  2555     05  CERTNOF PIC  X(0001).
  2556     05  FILLER REDEFINES CERTNOF.
  2557         10  CERTNOA PIC  X(0001).
  2558     05  CERTNOI PIC  X(0010).
  2559*    -------------------------------
  2560     05  SUFXL PIC S9(0004) COMP.
  2561     05  SUFXF PIC  X(0001).
  2562     05  FILLER REDEFINES SUFXF.
  2563         10  SUFXA PIC  X(0001).
  2564     05  SUFXI PIC  X(0001).
  2565*    -------------------------------
  2566     05  CLMTYPL PIC S9(0004) COMP.
  2567     05  CLMTYPF PIC  X(0001).
  2568     05  FILLER REDEFINES CLMTYPF.
  2569         10  CLMTYPA PIC  X(0001).
  2570     05  CLMTYPI PIC  X(0006).
  2571*    -------------------------------
  2572     05  CLMSTATL PIC S9(0004) COMP.
  2573     05  CLMSTATF PIC  X(0001).
  2574     05  FILLER REDEFINES CLMSTATF.
  2575         10  CLMSTATA PIC  X(0001).
  2576     05  CLMSTATI PIC  X(0006).
  2577*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  53
* EL156.cbl
  2578     05  LSTNMEL PIC S9(0004) COMP.
  2579     05  LSTNMEF PIC  X(0001).
  2580     05  FILLER REDEFINES LSTNMEF.
  2581         10  LSTNMEA PIC  X(0001).
  2582     05  LSTNMEI PIC  X(0015).
  2583*    -------------------------------
  2584     05  FSTNMEL PIC S9(0004) COMP.
  2585     05  FSTNMEF PIC  X(0001).
  2586     05  FILLER REDEFINES FSTNMEF.
  2587         10  FSTNMEA PIC  X(0001).
  2588     05  FSTNMEI PIC  X(0012).
  2589*    -------------------------------
  2590     05  MINITL PIC S9(0004) COMP.
  2591     05  MINITF PIC  X(0001).
  2592     05  FILLER REDEFINES MINITF.
  2593         10  MINITA PIC  X(0001).
  2594     05  MINITI PIC  X(0001).
  2595*    -------------------------------
  2596     05  PRIMHDGL PIC S9(0004) COMP.
  2597     05  PRIMHDGF PIC  X(0001).
  2598     05  FILLER REDEFINES PRIMHDGF.
  2599         10  PRIMHDGA PIC  X(0001).
  2600     05  PRIMHDGI PIC  X(0012).
  2601*    -------------------------------
  2602     05  PCERTNOL PIC S9(0004) COMP.
  2603     05  PCERTNOF PIC  X(0001).
  2604     05  FILLER REDEFINES PCERTNOF.
  2605         10  PCERTNOA PIC  X(0001).
  2606     05  PCERTNOI PIC  X(0010).
  2607*    -------------------------------
  2608     05  PSUFXL PIC S9(0004) COMP.
  2609     05  PSUFXF PIC  X(0001).
  2610     05  FILLER REDEFINES PSUFXF.
  2611         10  PSUFXA PIC  X(0001).
  2612     05  PSUFXI PIC  X(0001).
  2613*    -------------------------------
  2614     05  STATUSL PIC S9(0004) COMP.
  2615     05  STATUSF PIC  X(0001).
  2616     05  FILLER REDEFINES STATUSF.
  2617         10  STATUSA PIC  X(0001).
  2618     05  STATUSI PIC  X(0010).
  2619*    -------------------------------
  2620     05  LOANHL PIC S9(0004) COMP.
  2621     05  LOANHF PIC  X(0001).
  2622     05  FILLER REDEFINES LOANHF.
  2623         10  LOANHA PIC  X(0001).
  2624     05  LOANHI PIC  X(0014).
  2625*    -------------------------------
  2626     05  LOANNOL PIC S9(0004) COMP.
  2627     05  LOANNOF PIC  X(0001).
  2628     05  FILLER REDEFINES LOANNOF.
  2629         10  LOANNOA PIC  X(0001).
  2630     05  LOANNOI PIC  X(0025).
  2631*    -------------------------------
  2632     05  DUEDAYHL PIC S9(0004) COMP.
  2633     05  DUEDAYHF PIC  X(0001).
  2634     05  FILLER REDEFINES DUEDAYHF.
  2635         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  54
* EL156.cbl
  2636     05  DUEDAYHI PIC  X(0008).
  2637*    -------------------------------
  2638     05  DUEDAYL PIC S9(0004) COMP.
  2639     05  DUEDAYF PIC  X(0001).
  2640     05  FILLER REDEFINES DUEDAYF.
  2641         10  DUEDAYA PIC  X(0001).
  2642     05  DUEDAYI PIC  X(0002).
  2643*    -------------------------------
  2644     05  ZINTHL PIC S9(0004) COMP.
  2645     05  ZINTHF PIC  X(0001).
  2646     05  FILLER REDEFINES ZINTHF.
  2647         10  ZINTHA PIC  X(0001).
  2648     05  ZINTHI PIC  X(0009).
  2649*    -------------------------------
  2650     05  ZINTL PIC S9(0004) COMP.
  2651     05  ZINTF PIC  X(0001).
  2652     05  FILLER REDEFINES ZINTF.
  2653         10  ZINTA PIC  X(0001).
  2654     05  ZINTI PIC  99V99999.
  2655*    -------------------------------
  2656     05  PTHRHDGL PIC S9(0004) COMP.
  2657     05  PTHRHDGF PIC  X(0001).
  2658     05  FILLER REDEFINES PTHRHDGF.
  2659         10  PTHRHDGA PIC  X(0001).
  2660     05  PTHRHDGI PIC  X(0014).
  2661*    -------------------------------
  2662     05  PDTHRUL PIC S9(0004) COMP.
  2663     05  PDTHRUF PIC  X(0001).
  2664     05  FILLER REDEFINES PDTHRUF.
  2665         10  PDTHRUA PIC  X(0001).
  2666     05  PDTHRUI PIC  X(0008).
  2667*    -------------------------------
  2668     05  TOTPAIDL PIC S9(0004) COMP.
  2669     05  TOTPAIDF PIC  X(0001).
  2670     05  FILLER REDEFINES TOTPAIDF.
  2671         10  TOTPAIDA PIC  X(0001).
  2672     05  TOTPAIDI PIC  X(0010).
  2673*    -------------------------------
  2674     05  COVERL PIC S9(0004) COMP.
  2675     05  COVERF PIC  X(0001).
  2676     05  FILLER REDEFINES COVERF.
  2677         10  COVERA PIC  X(0001).
  2678     05  COVERI PIC  X(0010).
  2679*    -------------------------------
  2680     05  INCURL PIC S9(0004) COMP.
  2681     05  INCURF PIC  X(0001).
  2682     05  FILLER REDEFINES INCURF.
  2683         10  INCURA PIC  X(0001).
  2684     05  INCURI PIC  X(0008).
  2685*    -------------------------------
  2686     05  LSTDTEL PIC S9(0004) COMP.
  2687     05  LSTDTEF PIC  X(0001).
  2688     05  FILLER REDEFINES LSTDTEF.
  2689         10  LSTDTEA PIC  X(0001).
  2690     05  LSTDTEI PIC  X(0008).
  2691*    -------------------------------
  2692     05  CRTSTATL PIC S9(0004) COMP.
  2693     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  55
* EL156.cbl
  2694     05  FILLER REDEFINES CRTSTATF.
  2695         10  CRTSTATA PIC  X(0001).
  2696     05  CRTSTATI PIC  X(0010).
  2697*    -------------------------------
  2698     05  EFFECTL PIC S9(0004) COMP.
  2699     05  EFFECTF PIC  X(0001).
  2700     05  FILLER REDEFINES EFFECTF.
  2701         10  EFFECTA PIC  X(0001).
  2702     05  EFFECTI PIC  X(0008).
  2703*    -------------------------------
  2704     05  TERMSL PIC S9(0004) COMP.
  2705     05  TERMSF PIC  X(0001).
  2706     05  FILLER REDEFINES TERMSF.
  2707         10  TERMSA PIC  X(0001).
  2708     05  TERMSI PIC  X(0011).
  2709*    -------------------------------
  2710     05  STACCTL PIC S9(0004) COMP.
  2711     05  STACCTF PIC  X(0001).
  2712     05  FILLER REDEFINES STACCTF.
  2713         10  STACCTA PIC  X(0001).
  2714     05  STACCTI PIC  X(0013).
  2715*    -------------------------------
  2716     05  EXPDTEHL PIC S9(0004) COMP.
  2717     05  EXPDTEHF PIC  X(0001).
  2718     05  FILLER REDEFINES EXPDTEHF.
  2719         10  EXPDTEHA PIC  X(0001).
  2720     05  EXPDTEHI PIC  X(0014).
  2721*    -------------------------------
  2722     05  EXPDTEL PIC S9(0004) COMP.
  2723     05  EXPDTEF PIC  X(0001).
  2724     05  FILLER REDEFINES EXPDTEF.
  2725         10  EXPDTEA PIC  X(0001).
  2726     05  EXPDTEI PIC  X(0008).
  2727*    -------------------------------
  2728     05  BENECAPL PIC S9(0004) COMP.
  2729     05  BENECAPF PIC  X(0001).
  2730     05  FILLER REDEFINES BENECAPF.
  2731         10  BENECAPA PIC  X(0001).
  2732     05  BENECAPI PIC  X(0013).
  2733*    -------------------------------
  2734     05  BENEL PIC S9(0004) COMP.
  2735     05  BENEF PIC  X(0001).
  2736     05  FILLER REDEFINES BENEF.
  2737         10  BENEA PIC  X(0001).
  2738     05  BENEI PIC  X(0009).
  2739*    -------------------------------
  2740     05  FORMTYPL PIC S9(0004) COMP.
  2741     05  FORMTYPF PIC  X(0001).
  2742     05  FILLER REDEFINES FORMTYPF.
  2743         10  FORMTYPA PIC  X(0001).
  2744     05  FORMTYPI PIC  X(0001).
  2745*    -------------------------------
  2746     05  PMTTYPEL PIC S9(0004) COMP.
  2747     05  PMTTYPEF PIC  X(0001).
  2748     05  FILLER REDEFINES PMTTYPEF.
  2749         10  PMTTYPEA PIC  X(0001).
  2750     05  PMTTYPEI PIC  X(0001).
  2751*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  56
* EL156.cbl
  2752     05  PAYEEL PIC S9(0004) COMP.
  2753     05  PAYEEF PIC  X(0001).
  2754     05  FILLER REDEFINES PAYEEF.
  2755         10  PAYEEA PIC  X(0001).
  2756     05  PAYEEI PIC  X(0002).
  2757*    -------------------------------
  2758     05  CHECKNOL PIC S9(0004) COMP.
  2759     05  CHECKNOF PIC  X(0001).
  2760     05  FILLER REDEFINES CHECKNOF.
  2761         10  CHECKNOA PIC  X(0001).
  2762     05  CHECKNOI PIC  X(0007).
  2763*    -------------------------------
  2764     05  OFFLINEL PIC S9(0004) COMP.
  2765     05  OFFLINEF PIC  X(0001).
  2766     05  FILLER REDEFINES OFFLINEF.
  2767         10  OFFLINEA PIC  X(0001).
  2768     05  OFFLINEI PIC  X(0001).
  2769*    -------------------------------
  2770     05  HOLDTILL PIC S9(0004) COMP.
  2771     05  HOLDTILF PIC  X(0001).
  2772     05  FILLER REDEFINES HOLDTILF.
  2773         10  HOLDTILA PIC  X(0001).
  2774     05  HOLDTILI PIC  X(0008).
  2775*    -------------------------------
  2776     05  NOTE1L PIC S9(0004) COMP.
  2777     05  NOTE1F PIC  X(0001).
  2778     05  FILLER REDEFINES NOTE1F.
  2779         10  NOTE1A PIC  X(0001).
  2780     05  NOTE1I PIC  X(0060).
  2781*    -------------------------------
  2782     05  NOTE2L PIC S9(0004) COMP.
  2783     05  NOTE2F PIC  X(0001).
  2784     05  FILLER REDEFINES NOTE2F.
  2785         10  NOTE2A PIC  X(0001).
  2786     05  NOTE2I PIC  X(0060).
  2787*    -------------------------------
  2788     05  EOBYNL PIC S9(0004) COMP.
  2789     05  EOBYNF PIC  X(0001).
  2790     05  FILLER REDEFINES EOBYNF.
  2791         10  EOBYNA PIC  X(0001).
  2792     05  EOBYNI PIC  X(0001).
  2793*    -------------------------------
  2794     05  CASHHL PIC S9(0004) COMP.
  2795     05  CASHHF PIC  X(0001).
  2796     05  FILLER REDEFINES CASHHF.
  2797         10  CASHHA PIC  X(0001).
  2798     05  CASHHI PIC  X(0011).
  2799*    -------------------------------
  2800     05  CASHL PIC S9(0004) COMP.
  2801     05  CASHF PIC  X(0001).
  2802     05  FILLER REDEFINES CASHF.
  2803         10  CASHA PIC  X(0001).
  2804     05  CASHI PIC  X(0001).
  2805*    -------------------------------
  2806     05  GROUPHL PIC S9(0004) COMP.
  2807     05  GROUPHF PIC  X(0001).
  2808     05  FILLER REDEFINES GROUPHF.
  2809         10  GROUPHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  57
* EL156.cbl
  2810     05  GROUPHI PIC  X(0010).
  2811*    -------------------------------
  2812     05  GROUPEDL PIC S9(0004) COMP.
  2813     05  GROUPEDF PIC  X(0001).
  2814     05  FILLER REDEFINES GROUPEDF.
  2815         10  GROUPEDA PIC  X(0001).
  2816     05  GROUPEDI PIC  X(0001).
  2817*    -------------------------------
  2818     05  PINTHL PIC S9(0004) COMP.
  2819     05  PINTHF PIC  X(0001).
  2820     05  FILLER REDEFINES PINTHF.
  2821         10  PINTHA PIC  X(0001).
  2822     05  PINTHI PIC  X(0004).
  2823*    -------------------------------
  2824     05  PINTL PIC S9(0004) COMP.
  2825     05  PINTF PIC  X(0001).
  2826     05  FILLER REDEFINES PINTF.
  2827         10  PINTA PIC  X(0001).
  2828     05  PINTI PIC  X(0008).
  2829*    -------------------------------
  2830     05  PROOFDTL PIC S9(0004) COMP.
  2831     05  PROOFDTF PIC  X(0001).
  2832     05  FILLER REDEFINES PROOFDTF.
  2833         10  PROOFDTA PIC  X(0001).
  2834     05  PROOFDTI PIC  X(0008).
  2835*    -------------------------------
  2836     05  AIGFRMHL PIC S9(0004) COMP.
  2837     05  AIGFRMHF PIC  X(0001).
  2838     05  FILLER REDEFINES AIGFRMHF.
  2839         10  AIGFRMHA PIC  X(0001).
  2840     05  AIGFRMHI PIC  X(0012).
  2841*    -------------------------------
  2842     05  AIGFROML PIC S9(0004) COMP.
  2843     05  AIGFROMF PIC  X(0001).
  2844     05  FILLER REDEFINES AIGFROMF.
  2845         10  AIGFROMA PIC  X(0001).
  2846     05  AIGFROMI PIC  X(0008).
  2847*    -------------------------------
  2848     05  PMTHDGAL PIC S9(0004) COMP.
  2849     05  PMTHDGAF PIC  X(0001).
  2850     05  FILLER REDEFINES PMTHDGAF.
  2851         10  PMTHDGAA PIC  X(0001).
  2852     05  PMTHDGAI PIC  X(0066).
  2853*    -------------------------------
  2854     05  EPYFROML PIC S9(0004) COMP.
  2855     05  EPYFROMF PIC  X(0001).
  2856     05  FILLER REDEFINES EPYFROMF.
  2857         10  EPYFROMA PIC  X(0001).
  2858     05  EPYFROMI PIC  X(0008).
  2859*    -------------------------------
  2860     05  EPYTHRUL PIC S9(0004) COMP.
  2861     05  EPYTHRUF PIC  X(0001).
  2862     05  FILLER REDEFINES EPYTHRUF.
  2863         10  EPYTHRUA PIC  X(0001).
  2864     05  EPYTHRUI PIC  X(0008).
  2865*    -------------------------------
  2866     05  EDAYSL PIC S9(0004) COMP.
  2867     05  EDAYSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  58
* EL156.cbl
  2868     05  FILLER REDEFINES EDAYSF.
  2869         10  EDAYSA PIC  X(0001).
  2870     05  EDAYSI PIC  S9(6).
  2871*    -------------------------------
  2872     05  EPYAMTL PIC S9(0004) COMP.
  2873     05  EPYAMTF PIC  X(0001).
  2874     05  FILLER REDEFINES EPYAMTF.
  2875         10  EPYAMTA PIC  X(0001).
  2876     05  EPYAMTI PIC  S9(8)V99.
  2877*    -------------------------------
  2878     05  ERESVL PIC S9(0004) COMP.
  2879     05  ERESVF PIC  X(0001).
  2880     05  FILLER REDEFINES ERESVF.
  2881         10  ERESVA PIC  X(0001).
  2882     05  ERESVI PIC  S9(7)V99.
  2883*    -------------------------------
  2884     05  ETYPEL PIC S9(0004) COMP.
  2885     05  ETYPEF PIC  X(0001).
  2886     05  FILLER REDEFINES ETYPEF.
  2887         10  ETYPEA PIC  X(0001).
  2888     05  ETYPEI PIC  X(0001).
  2889*    -------------------------------
  2890     05  EEXPENSL PIC S9(0004) COMP.
  2891     05  EEXPENSF PIC  X(0001).
  2892     05  FILLER REDEFINES EEXPENSF.
  2893         10  EEXPENSA PIC  X(0001).
  2894     05  EEXPENSI PIC  9(6)V99.
  2895*    -------------------------------
  2896     05  CPYFROML PIC S9(0004) COMP.
  2897     05  CPYFROMF PIC  X(0001).
  2898     05  FILLER REDEFINES CPYFROMF.
  2899         10  CPYFROMA PIC  X(0001).
  2900     05  CPYFROMI PIC  X(0008).
  2901*    -------------------------------
  2902     05  CPYTHRUL PIC S9(0004) COMP.
  2903     05  CPYTHRUF PIC  X(0001).
  2904     05  FILLER REDEFINES CPYTHRUF.
  2905         10  CPYTHRUA PIC  X(0001).
  2906     05  CPYTHRUI PIC  X(0008).
  2907*    -------------------------------
  2908     05  CDAYSL PIC S9(0004) COMP.
  2909     05  CDAYSF PIC  X(0001).
  2910     05  FILLER REDEFINES CDAYSF.
  2911         10  CDAYSA PIC  X(0001).
  2912     05  CDAYSI PIC  9(6).
  2913*    -------------------------------
  2914     05  CPYAMTL PIC S9(0004) COMP.
  2915     05  CPYAMTF PIC  X(0001).
  2916     05  FILLER REDEFINES CPYAMTF.
  2917         10  CPYAMTA PIC  X(0001).
  2918     05  CPYAMTI PIC  S9(8)V99.
  2919*    -------------------------------
  2920     05  CRESVL PIC S9(0004) COMP.
  2921     05  CRESVF PIC  X(0001).
  2922     05  FILLER REDEFINES CRESVF.
  2923         10  CRESVA PIC  X(0001).
  2924     05  CRESVI PIC  9(6)V99.
  2925*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  59
* EL156.cbl
  2926     05  CEXPENSL PIC S9(0004) COMP.
  2927     05  CEXPENSF PIC  X(0001).
  2928     05  FILLER REDEFINES CEXPENSF.
  2929         10  CEXPENSA PIC  X(0001).
  2930     05  CEXPENSI PIC  9(6)V99.
  2931*    -------------------------------
  2932     05  ERRMSG0L PIC S9(0004) COMP.
  2933     05  ERRMSG0F PIC  X(0001).
  2934     05  FILLER REDEFINES ERRMSG0F.
  2935         10  ERRMSG0A PIC  X(0001).
  2936     05  ERRMSG0I PIC  X(0072).
  2937*    -------------------------------
  2938     05  ERRMSG1L PIC S9(0004) COMP.
  2939     05  ERRMSG1F PIC  X(0001).
  2940     05  FILLER REDEFINES ERRMSG1F.
  2941         10  ERRMSG1A PIC  X(0001).
  2942     05  ERRMSG1I PIC  X(0072).
  2943*    -------------------------------
  2944     05  ERRMSG2L PIC S9(0004) COMP.
  2945     05  ERRMSG2F PIC  X(0001).
  2946     05  FILLER REDEFINES ERRMSG2F.
  2947         10  ERRMSG2A PIC  X(0001).
  2948     05  ERRMSG2I PIC  X(0072).
  2949*    -------------------------------
  2950     05  ENTERPFL PIC S9(0004) COMP.
  2951     05  ENTERPFF PIC  X(0001).
  2952     05  FILLER REDEFINES ENTERPFF.
  2953         10  ENTERPFA PIC  X(0001).
  2954     05  ENTERPFI PIC  99.
  2955*    -------------------------------
  2956     05  PF6TITL PIC S9(0004) COMP.
  2957     05  PF6TITF PIC  X(0001).
  2958     05  FILLER REDEFINES PF6TITF.
  2959         10  PF6TITA PIC  X(0001).
  2960     05  PF6TITI PIC  X(0016).
  2961 01  EL156AO REDEFINES EL156AI.
  2962     05  FILLER            PIC  X(0012).
  2963*    -------------------------------
  2964     05  FILLER            PIC  X(0003).
  2965     05  RUNDTEAO PIC  X(0008).
  2966*    -------------------------------
  2967     05  FILLER            PIC  X(0003).
  2968     05  RUNTIMAO PIC  99.99.
  2969*    -------------------------------
  2970     05  FILLER            PIC  X(0003).
  2971     05  SEQUO PIC  X(0010).
  2972*    -------------------------------
  2973     05  FILLER            PIC  X(0003).
  2974     05  CLMNOO PIC  X(0007).
  2975*    -------------------------------
  2976     05  FILLER            PIC  X(0003).
  2977     05  CARRO PIC  X(0001).
  2978*    -------------------------------
  2979     05  FILLER            PIC  X(0003).
  2980     05  CERTNOO PIC  X(0010).
  2981*    -------------------------------
  2982     05  FILLER            PIC  X(0003).
  2983     05  SUFXO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  60
* EL156.cbl
  2984*    -------------------------------
  2985     05  FILLER            PIC  X(0003).
  2986     05  CLMTYPO PIC  X(0006).
  2987*    -------------------------------
  2988     05  FILLER            PIC  X(0003).
  2989     05  CLMSTATO PIC  X(0006).
  2990*    -------------------------------
  2991     05  FILLER            PIC  X(0003).
  2992     05  LSTNMEO PIC  X(0015).
  2993*    -------------------------------
  2994     05  FILLER            PIC  X(0003).
  2995     05  FSTNMEO PIC  X(0012).
  2996*    -------------------------------
  2997     05  FILLER            PIC  X(0003).
  2998     05  MINITO PIC  X(0001).
  2999*    -------------------------------
  3000     05  FILLER            PIC  X(0003).
  3001     05  PRIMHDGO PIC  X(0012).
  3002*    -------------------------------
  3003     05  FILLER            PIC  X(0003).
  3004     05  PCERTNOO PIC  X(0010).
  3005*    -------------------------------
  3006     05  FILLER            PIC  X(0003).
  3007     05  PSUFXO PIC  X(0001).
  3008*    -------------------------------
  3009     05  FILLER            PIC  X(0003).
  3010     05  STATUSO PIC  X(0010).
  3011*    -------------------------------
  3012     05  FILLER            PIC  X(0003).
  3013     05  LOANHO PIC  X(0014).
  3014*    -------------------------------
  3015     05  FILLER            PIC  X(0003).
  3016     05  LOANNOO PIC  X(0025).
  3017*    -------------------------------
  3018     05  FILLER            PIC  X(0003).
  3019     05  DUEDAYHO PIC  X(0008).
  3020*    -------------------------------
  3021     05  FILLER            PIC  X(0003).
  3022     05  DUEDAYO PIC  X(0002).
  3023*    -------------------------------
  3024     05  FILLER            PIC  X(0003).
  3025     05  ZINTHO PIC  X(0009).
  3026*    -------------------------------
  3027     05  FILLER            PIC  X(0003).
  3028     05  ZINTO PIC  9.99999.
  3029*    -------------------------------
  3030     05  FILLER            PIC  X(0003).
  3031     05  PTHRHDGO PIC  X(0014).
  3032*    -------------------------------
  3033     05  FILLER            PIC  X(0003).
  3034     05  PDTHRUO PIC  X(0008).
  3035*    -------------------------------
  3036     05  FILLER            PIC  X(0003).
  3037     05  TOTPAIDO PIC  Z(6).99-.
  3038*    -------------------------------
  3039     05  FILLER            PIC  X(0003).
  3040     05  COVERO PIC  X(0010).
  3041*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  61
* EL156.cbl
  3042     05  FILLER            PIC  X(0003).
  3043     05  INCURO PIC  X(0008).
  3044*    -------------------------------
  3045     05  FILLER            PIC  X(0003).
  3046     05  LSTDTEO PIC  X(0008).
  3047*    -------------------------------
  3048     05  FILLER            PIC  X(0003).
  3049     05  CRTSTATO PIC  X(0010).
  3050*    -------------------------------
  3051     05  FILLER            PIC  X(0003).
  3052     05  EFFECTO PIC  X(0008).
  3053*    -------------------------------
  3054     05  FILLER            PIC  X(0003).
  3055     05  TERMSO PIC  X(0011).
  3056*    -------------------------------
  3057     05  FILLER            PIC  X(0003).
  3058     05  STACCTO PIC  X(0013).
  3059*    -------------------------------
  3060     05  FILLER            PIC  X(0003).
  3061     05  EXPDTEHO PIC  X(0014).
  3062*    -------------------------------
  3063     05  FILLER            PIC  X(0003).
  3064     05  EXPDTEO PIC  X(0008).
  3065*    -------------------------------
  3066     05  FILLER            PIC  X(0003).
  3067     05  BENECAPO PIC  X(0013).
  3068*    -------------------------------
  3069     05  FILLER            PIC  X(0003).
  3070     05  BENEO PIC  Z(6).99.
  3071*    -------------------------------
  3072     05  FILLER            PIC  X(0003).
  3073     05  FORMTYPO PIC  X(0001).
  3074*    -------------------------------
  3075     05  FILLER            PIC  X(0003).
  3076     05  PMTTYPEO PIC  X(0001).
  3077*    -------------------------------
  3078     05  FILLER            PIC  X(0003).
  3079     05  PAYEEO PIC  X(0002).
  3080*    -------------------------------
  3081     05  FILLER            PIC  X(0003).
  3082     05  CHECKNOO PIC  X(0007).
  3083*    -------------------------------
  3084     05  FILLER            PIC  X(0003).
  3085     05  OFFLINEO PIC  X(0001).
  3086*    -------------------------------
  3087     05  FILLER            PIC  X(0003).
  3088     05  HOLDTILO PIC  99B99B99.
  3089*    -------------------------------
  3090     05  FILLER            PIC  X(0003).
  3091     05  NOTE1O PIC  X(0060).
  3092*    -------------------------------
  3093     05  FILLER            PIC  X(0003).
  3094     05  NOTE2O PIC  X(0060).
  3095*    -------------------------------
  3096     05  FILLER            PIC  X(0003).
  3097     05  EOBYNO PIC  X(0001).
  3098*    -------------------------------
  3099     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  62
* EL156.cbl
  3100     05  CASHHO PIC  X(0011).
  3101*    -------------------------------
  3102     05  FILLER            PIC  X(0003).
  3103     05  CASHO PIC  X(0001).
  3104*    -------------------------------
  3105     05  FILLER            PIC  X(0003).
  3106     05  GROUPHO PIC  X(0010).
  3107*    -------------------------------
  3108     05  FILLER            PIC  X(0003).
  3109     05  GROUPEDO PIC  X(0001).
  3110*    -------------------------------
  3111     05  FILLER            PIC  X(0003).
  3112     05  PINTHO PIC  X(0004).
  3113*    -------------------------------
  3114     05  FILLER            PIC  X(0003).
  3115     05  PINTO PIC  Z,ZZ9.99.
  3116*    -------------------------------
  3117     05  FILLER            PIC  X(0003).
  3118     05  PROOFDTO PIC  99B99B99.
  3119*    -------------------------------
  3120     05  FILLER            PIC  X(0003).
  3121     05  AIGFRMHO PIC  X(0012).
  3122*    -------------------------------
  3123     05  FILLER            PIC  X(0003).
  3124     05  AIGFROMO PIC  99B99B99.
  3125*    -------------------------------
  3126     05  FILLER            PIC  X(0003).
  3127     05  PMTHDGAO PIC  X(0066).
  3128*    -------------------------------
  3129     05  FILLER            PIC  X(0003).
  3130     05  EPYFROMO PIC  99B99B99.
  3131*    -------------------------------
  3132     05  FILLER            PIC  X(0003).
  3133     05  EPYTHRUO PIC  99B99B99.
  3134*    -------------------------------
  3135     05  FILLER            PIC  X(0003).
  3136     05  EDAYSO PIC  Z(4)9-.
  3137*    -------------------------------
  3138     05  FILLER            PIC  X(0003).
  3139     05  EPYAMTO PIC  Z(6).99-.
  3140*    -------------------------------
  3141     05  FILLER            PIC  X(0003).
  3142     05  ERESVO PIC  Z(5).99-.
  3143*    -------------------------------
  3144     05  FILLER            PIC  X(0003).
  3145     05  ETYPEO PIC  X(0001).
  3146*    -------------------------------
  3147     05  FILLER            PIC  X(0003).
  3148     05  EEXPENSO PIC  Z(5).99.
  3149*    -------------------------------
  3150     05  FILLER            PIC  X(0003).
  3151     05  CPYFROMO PIC  99B99B99.
  3152*    -------------------------------
  3153     05  FILLER            PIC  X(0003).
  3154     05  CPYTHRUO PIC  99B99B99.
  3155*    -------------------------------
  3156     05  FILLER            PIC  X(0003).
  3157     05  CDAYSO PIC  Z(4)9-.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  63
* EL156.cbl
  3158*    -------------------------------
  3159     05  FILLER            PIC  X(0003).
  3160     05  CPYAMTO PIC  Z(6).99-.
  3161*    -------------------------------
  3162     05  FILLER            PIC  X(0003).
  3163     05  CRESVO PIC  Z(5).99.
  3164*    -------------------------------
  3165     05  FILLER            PIC  X(0003).
  3166     05  CEXPENSO PIC  Z(5).99.
  3167*    -------------------------------
  3168     05  FILLER            PIC  X(0003).
  3169     05  ERRMSG0O PIC  X(0072).
  3170*    -------------------------------
  3171     05  FILLER            PIC  X(0003).
  3172     05  ERRMSG1O PIC  X(0072).
  3173*    -------------------------------
  3174     05  FILLER            PIC  X(0003).
  3175     05  ERRMSG2O PIC  X(0072).
  3176*    -------------------------------
  3177     05  FILLER            PIC  X(0003).
  3178     05  ENTERPFO PIC  X(0002).
  3179*    -------------------------------
  3180     05  FILLER            PIC  X(0003).
  3181     05  PF6TITO PIC  X(0016).
  3182*    -------------------------------
  3183 01  EL156BI REDEFINES EL156AI.
  3184     05  FILLER            PIC  X(0012).
  3185*    -------------------------------
  3186     05  RUNDTEBL PIC S9(0004) COMP.
  3187     05  RUNDTEBF PIC  X(0001).
  3188     05  FILLER REDEFINES RUNDTEBF.
  3189         10  RUNDTEBA PIC  X(0001).
  3190     05  RUNDTEBI PIC  X(0008).
  3191*    -------------------------------
  3192     05  RUNTIMBL PIC S9(0004) COMP.
  3193     05  RUNTIMBF PIC  X(0001).
  3194     05  FILLER REDEFINES RUNTIMBF.
  3195         10  RUNTIMBA PIC  X(0001).
  3196     05  RUNTIMBI PIC  X(0005).
  3197*    -------------------------------
  3198     05  PAYDTBL PIC S9(0004) COMP.
  3199     05  PAYDTBF PIC  X(0001).
  3200     05  FILLER REDEFINES PAYDTBF.
  3201         10  PAYDTBA PIC  X(0001).
  3202     05  PAYDTBI PIC  X(0008).
  3203*    -------------------------------
  3204     05  PAYTYPBL PIC S9(0004) COMP.
  3205     05  PAYTYPBF PIC  X(0001).
  3206     05  FILLER REDEFINES PAYTYPBF.
  3207         10  PAYTYPBA PIC  X(0001).
  3208     05  PAYTYPBI PIC  X(0015).
  3209*    -------------------------------
  3210     05  PAYAMTBL PIC S9(0004) COMP.
  3211     05  PAYAMTBF PIC  X(0001).
  3212     05  FILLER REDEFINES PAYAMTBF.
  3213         10  PAYAMTBA PIC  X(0001).
  3214     05  PAYAMTBI PIC  X(0011).
  3215*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  64
* EL156.cbl
  3216     05  LOANHBL PIC S9(0004) COMP.
  3217     05  LOANHBF PIC  X(0001).
  3218     05  FILLER REDEFINES LOANHBF.
  3219         10  LOANHBA PIC  X(0001).
  3220     05  LOANHBI PIC  X(0012).
  3221*    -------------------------------
  3222     05  LOANNBL PIC S9(0004) COMP.
  3223     05  LOANNBF PIC  X(0001).
  3224     05  FILLER REDEFINES LOANNBF.
  3225         10  LOANNBA PIC  X(0001).
  3226     05  LOANNBI PIC  X(0025).
  3227*    -------------------------------
  3228     05  CKNUMHDL PIC S9(0004) COMP.
  3229     05  CKNUMHDF PIC  X(0001).
  3230     05  FILLER REDEFINES CKNUMHDF.
  3231         10  CKNUMHDA PIC  X(0001).
  3232     05  CKNUMHDI PIC  X(0012).
  3233*    -------------------------------
  3234     05  CKNUMBL PIC S9(0004) COMP.
  3235     05  CKNUMBF PIC  X(0001).
  3236     05  FILLER REDEFINES CKNUMBF.
  3237         10  CKNUMBA PIC  X(0001).
  3238     05  CKNUMBI PIC  X(0007).
  3239*    -------------------------------
  3240     05  AGTHDGL PIC S9(0004) COMP.
  3241     05  AGTHDGF PIC  X(0001).
  3242     05  FILLER REDEFINES AGTHDGF.
  3243         10  AGTHDGA PIC  X(0001).
  3244     05  AGTHDGI PIC  X(0016).
  3245*    -------------------------------
  3246     05  NAMEBL PIC S9(0004) COMP.
  3247     05  NAMEBF PIC  X(0001).
  3248     05  FILLER REDEFINES NAMEBF.
  3249         10  NAMEBA PIC  X(0001).
  3250     05  NAMEBI PIC  X(0030).
  3251*    -------------------------------
  3252     05  NAMEB2L PIC S9(0004) COMP.
  3253     05  NAMEB2F PIC  X(0001).
  3254     05  FILLER REDEFINES NAMEB2F.
  3255         10  NAMEB2A PIC  X(0001).
  3256     05  NAMEB2I PIC  X(0030).
  3257*    -------------------------------
  3258     05  ADDR1BL PIC S9(0004) COMP.
  3259     05  ADDR1BF PIC  X(0001).
  3260     05  FILLER REDEFINES ADDR1BF.
  3261         10  ADDR1BA PIC  X(0001).
  3262     05  ADDR1BI PIC  X(0030).
  3263*    -------------------------------
  3264     05  ADDR1B2L PIC S9(0004) COMP.
  3265     05  ADDR1B2F PIC  X(0001).
  3266     05  FILLER REDEFINES ADDR1B2F.
  3267         10  ADDR1B2A PIC  X(0001).
  3268     05  ADDR1B2I PIC  X(0030).
  3269*    -------------------------------
  3270     05  ADDR2BL PIC S9(0004) COMP.
  3271     05  ADDR2BF PIC  X(0001).
  3272     05  FILLER REDEFINES ADDR2BF.
  3273         10  ADDR2BA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  65
* EL156.cbl
  3274     05  ADDR2BI PIC  X(0030).
  3275*    -------------------------------
  3276     05  ADDR2B2L PIC S9(0004) COMP.
  3277     05  ADDR2B2F PIC  X(0001).
  3278     05  FILLER REDEFINES ADDR2B2F.
  3279         10  ADDR2B2A PIC  X(0001).
  3280     05  ADDR2B2I PIC  X(0030).
  3281*    -------------------------------
  3282     05  CITYSTBL PIC S9(0004) COMP.
  3283     05  CITYSTBF PIC  X(0001).
  3284     05  FILLER REDEFINES CITYSTBF.
  3285         10  CITYSTBA PIC  X(0001).
  3286     05  CITYSTBI PIC  X(0030).
  3287*    -------------------------------
  3288     05  CITYST2L PIC S9(0004) COMP.
  3289     05  CITYST2F PIC  X(0001).
  3290     05  FILLER REDEFINES CITYST2F.
  3291         10  CITYST2A PIC  X(0001).
  3292     05  CITYST2I PIC  X(0030).
  3293*    -------------------------------
  3294     05  ZIPBL PIC S9(0004) COMP.
  3295     05  ZIPBF PIC  X(0001).
  3296     05  FILLER REDEFINES ZIPBF.
  3297         10  ZIPBA PIC  X(0001).
  3298     05  ZIPBI PIC  X(0009).
  3299*    -------------------------------
  3300     05  ZIPB2L PIC S9(0004) COMP.
  3301     05  ZIPB2F PIC  X(0001).
  3302     05  FILLER REDEFINES ZIPB2F.
  3303         10  ZIPB2A PIC  X(0001).
  3304     05  ZIPB2I PIC  X(0009).
  3305*    -------------------------------
  3306     05  INTHDBL PIC S9(0004) COMP.
  3307     05  INTHDBF PIC  X(0001).
  3308     05  FILLER REDEFINES INTHDBF.
  3309         10  INTHDBA PIC  X(0001).
  3310     05  INTHDBI PIC  X(0012).
  3311*    -------------------------------
  3312     05  INTAMTBL PIC S9(0004) COMP.
  3313     05  INTAMTBF PIC  X(0001).
  3314     05  FILLER REDEFINES INTAMTBF.
  3315         10  INTAMTBA PIC  X(0001).
  3316     05  INTAMTBI PIC  X(0011).
  3317*    -------------------------------
  3318     05  PMTHDGBL PIC S9(0004) COMP.
  3319     05  PMTHDGBF PIC  X(0001).
  3320     05  FILLER REDEFINES PMTHDGBF.
  3321         10  PMTHDGBA PIC  X(0001).
  3322     05  PMTHDGBI PIC  X(0034).
  3323*    -------------------------------
  3324     05  CLMNOBL PIC S9(0004) COMP.
  3325     05  CLMNOBF PIC  X(0001).
  3326     05  FILLER REDEFINES CLMNOBF.
  3327         10  CLMNOBA PIC  X(0001).
  3328     05  CLMNOBI PIC  X(0007).
  3329*    -------------------------------
  3330     05  CARRBL PIC S9(0004) COMP.
  3331     05  CARRBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  66
* EL156.cbl
  3332     05  FILLER REDEFINES CARRBF.
  3333         10  CARRBA PIC  X(0001).
  3334     05  CARRBI PIC  X(0001).
  3335*    -------------------------------
  3336     05  CERTNOBL PIC S9(0004) COMP.
  3337     05  CERTNOBF PIC  X(0001).
  3338     05  FILLER REDEFINES CERTNOBF.
  3339         10  CERTNOBA PIC  X(0001).
  3340     05  CERTNOBI PIC  X(0010).
  3341*    -------------------------------
  3342     05  SUFXBL PIC S9(0004) COMP.
  3343     05  SUFXBF PIC  X(0001).
  3344     05  FILLER REDEFINES SUFXBF.
  3345         10  SUFXBA PIC  X(0001).
  3346     05  SUFXBI PIC  X(0001).
  3347*    -------------------------------
  3348     05  CLMTYPBL PIC S9(0004) COMP.
  3349     05  CLMTYPBF PIC  X(0001).
  3350     05  FILLER REDEFINES CLMTYPBF.
  3351         10  CLMTYPBA PIC  X(0001).
  3352     05  CLMTYPBI PIC  X(0006).
  3353*    -------------------------------
  3354     05  INCURBL PIC S9(0004) COMP.
  3355     05  INCURBF PIC  X(0001).
  3356     05  FILLER REDEFINES INCURBF.
  3357         10  INCURBA PIC  X(0001).
  3358     05  INCURBI PIC  X(0008).
  3359*    -------------------------------
  3360     05  PYFROMBL PIC S9(0004) COMP.
  3361     05  PYFROMBF PIC  X(0001).
  3362     05  FILLER REDEFINES PYFROMBF.
  3363         10  PYFROMBA PIC  X(0001).
  3364     05  PYFROMBI PIC  X(0008).
  3365*    -------------------------------
  3366     05  PYTHRUBL PIC S9(0004) COMP.
  3367     05  PYTHRUBF PIC  X(0001).
  3368     05  FILLER REDEFINES PYTHRUBF.
  3369         10  PYTHRUBA PIC  X(0001).
  3370     05  PYTHRUBI PIC  X(0008).
  3371*    -------------------------------
  3372     05  DAYSBL PIC S9(0004) COMP.
  3373     05  DAYSBF PIC  X(0001).
  3374     05  FILLER REDEFINES DAYSBF.
  3375         10  DAYSBA PIC  X(0001).
  3376     05  DAYSBI PIC  X(0005).
  3377*    -------------------------------
  3378     05  BYBL PIC S9(0004) COMP.
  3379     05  BYBF PIC  X(0001).
  3380     05  FILLER REDEFINES BYBF.
  3381         10  BYBA PIC  X(0001).
  3382     05  BYBI PIC  X(0004).
  3383*    -------------------------------
  3384     05  PROOFDBL PIC S9(0004) COMP.
  3385     05  PROOFDBF PIC  X(0001).
  3386     05  FILLER REDEFINES PROOFDBF.
  3387         10  PROOFDBA PIC  X(0001).
  3388     05  PROOFDBI PIC  X(0008).
  3389*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  67
* EL156.cbl
  3390     05  ACCTBL PIC S9(0004) COMP.
  3391     05  ACCTBF PIC  X(0001).
  3392     05  FILLER REDEFINES ACCTBF.
  3393         10  ACCTBA PIC  X(0001).
  3394     05  ACCTBI PIC  X(0010).
  3395*    -------------------------------
  3396     05  STATEBL PIC S9(0004) COMP.
  3397     05  STATEBF PIC  X(0001).
  3398     05  FILLER REDEFINES STATEBF.
  3399         10  STATEBA PIC  X(0001).
  3400     05  STATEBI PIC  X(0002).
  3401*    -------------------------------
  3402     05  GROUPBL PIC S9(0004) COMP.
  3403     05  GROUPBF PIC  X(0001).
  3404     05  FILLER REDEFINES GROUPBF.
  3405         10  GROUPBA PIC  X(0001).
  3406     05  GROUPBI PIC  X(0006).
  3407*    -------------------------------
  3408     05  ACARRBL PIC S9(0004) COMP.
  3409     05  ACARRBF PIC  X(0001).
  3410     05  FILLER REDEFINES ACARRBF.
  3411         10  ACARRBA PIC  X(0001).
  3412     05  ACARRBI PIC  X(0001).
  3413*    -------------------------------
  3414     05  ACCTNMBL PIC S9(0004) COMP.
  3415     05  ACCTNMBF PIC  X(0001).
  3416     05  FILLER REDEFINES ACCTNMBF.
  3417         10  ACCTNMBA PIC  X(0001).
  3418     05  ACCTNMBI PIC  X(0030).
  3419*    -------------------------------
  3420     05  UNDISBL PIC S9(0004) COMP.
  3421     05  UNDISBF PIC  X(0001).
  3422     05  FILLER REDEFINES UNDISBF.
  3423         10  UNDISBA PIC  X(0001).
  3424     05  UNDISBI PIC  X(0010).
  3425*    -------------------------------
  3426     05  RATEBL PIC S9(0004) COMP.
  3427     05  RATEBF PIC  X(0001).
  3428     05  FILLER REDEFINES RATEBF.
  3429         10  RATEBA PIC  X(0001).
  3430     05  RATEBI PIC  X(0006).
  3431*    -------------------------------
  3432     05  ERMSG1BL PIC S9(0004) COMP.
  3433     05  ERMSG1BF PIC  X(0001).
  3434     05  FILLER REDEFINES ERMSG1BF.
  3435         10  ERMSG1BA PIC  X(0001).
  3436     05  ERMSG1BI PIC  X(0072).
  3437*    -------------------------------
  3438     05  ENTPFBL PIC S9(0004) COMP.
  3439     05  ENTPFBF PIC  X(0001).
  3440     05  FILLER REDEFINES ENTPFBF.
  3441         10  ENTPFBA PIC  X(0001).
  3442     05  ENTPFBI PIC  99.
  3443 01  EL156BO REDEFINES EL156AI.
  3444     05  FILLER            PIC  X(0012).
  3445*    -------------------------------
  3446     05  FILLER            PIC  X(0003).
  3447     05  RUNDTEBO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  68
* EL156.cbl
  3448*    -------------------------------
  3449     05  FILLER            PIC  X(0003).
  3450     05  RUNTIMBO PIC  99.99.
  3451*    -------------------------------
  3452     05  FILLER            PIC  X(0003).
  3453     05  PAYDTBO PIC  99B99B99.
  3454*    -------------------------------
  3455     05  FILLER            PIC  X(0003).
  3456     05  PAYTYPBO PIC  X(0015).
  3457*    -------------------------------
  3458     05  FILLER            PIC  X(0003).
  3459     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3460*    -------------------------------
  3461     05  FILLER            PIC  X(0003).
  3462     05  LOANHBO PIC  X(0012).
  3463*    -------------------------------
  3464     05  FILLER            PIC  X(0003).
  3465     05  LOANNBO PIC  X(0025).
  3466*    -------------------------------
  3467     05  FILLER            PIC  X(0003).
  3468     05  CKNUMHDO PIC  X(0012).
  3469*    -------------------------------
  3470     05  FILLER            PIC  X(0003).
  3471     05  CKNUMBO PIC  X(0007).
  3472*    -------------------------------
  3473     05  FILLER            PIC  X(0003).
  3474     05  AGTHDGO PIC  X(0016).
  3475*    -------------------------------
  3476     05  FILLER            PIC  X(0003).
  3477     05  NAMEBO PIC  X(0030).
  3478*    -------------------------------
  3479     05  FILLER            PIC  X(0003).
  3480     05  NAMEB2O PIC  X(0030).
  3481*    -------------------------------
  3482     05  FILLER            PIC  X(0003).
  3483     05  ADDR1BO PIC  X(0030).
  3484*    -------------------------------
  3485     05  FILLER            PIC  X(0003).
  3486     05  ADDR1B2O PIC  X(0030).
  3487*    -------------------------------
  3488     05  FILLER            PIC  X(0003).
  3489     05  ADDR2BO PIC  X(0030).
  3490*    -------------------------------
  3491     05  FILLER            PIC  X(0003).
  3492     05  ADDR2B2O PIC  X(0030).
  3493*    -------------------------------
  3494     05  FILLER            PIC  X(0003).
  3495     05  CITYSTBO PIC  X(0030).
  3496*    -------------------------------
  3497     05  FILLER            PIC  X(0003).
  3498     05  CITYST2O PIC  X(0030).
  3499*    -------------------------------
  3500     05  FILLER            PIC  X(0003).
  3501     05  ZIPBO PIC  ZZZZ99999.
  3502*    -------------------------------
  3503     05  FILLER            PIC  X(0003).
  3504     05  ZIPB2O PIC  ZZZZZZZZZ.
  3505*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  69
* EL156.cbl
  3506     05  FILLER            PIC  X(0003).
  3507     05  INTHDBO PIC  X(0012).
  3508*    -------------------------------
  3509     05  FILLER            PIC  X(0003).
  3510     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3511*    -------------------------------
  3512     05  FILLER            PIC  X(0003).
  3513     05  PMTHDGBO PIC  X(0034).
  3514*    -------------------------------
  3515     05  FILLER            PIC  X(0003).
  3516     05  CLMNOBO PIC  X(0007).
  3517*    -------------------------------
  3518     05  FILLER            PIC  X(0003).
  3519     05  CARRBO PIC  X(0001).
  3520*    -------------------------------
  3521     05  FILLER            PIC  X(0003).
  3522     05  CERTNOBO PIC  X(0010).
  3523*    -------------------------------
  3524     05  FILLER            PIC  X(0003).
  3525     05  SUFXBO PIC  X(0001).
  3526*    -------------------------------
  3527     05  FILLER            PIC  X(0003).
  3528     05  CLMTYPBO PIC  X(0006).
  3529*    -------------------------------
  3530     05  FILLER            PIC  X(0003).
  3531     05  INCURBO PIC  X(0008).
  3532*    -------------------------------
  3533     05  FILLER            PIC  X(0003).
  3534     05  PYFROMBO PIC  99B99B99.
  3535*    -------------------------------
  3536     05  FILLER            PIC  X(0003).
  3537     05  PYTHRUBO PIC  99B99B99.
  3538*    -------------------------------
  3539     05  FILLER            PIC  X(0003).
  3540     05  DAYSBO PIC  X(0005).
  3541*    -------------------------------
  3542     05  FILLER            PIC  X(0003).
  3543     05  BYBO PIC  X(0004).
  3544*    -------------------------------
  3545     05  FILLER            PIC  X(0003).
  3546     05  PROOFDBO PIC  99B99B99.
  3547*    -------------------------------
  3548     05  FILLER            PIC  X(0003).
  3549     05  ACCTBO PIC  X(0010).
  3550*    -------------------------------
  3551     05  FILLER            PIC  X(0003).
  3552     05  STATEBO PIC  X(0002).
  3553*    -------------------------------
  3554     05  FILLER            PIC  X(0003).
  3555     05  GROUPBO PIC  X(0006).
  3556*    -------------------------------
  3557     05  FILLER            PIC  X(0003).
  3558     05  ACARRBO PIC  X(0001).
  3559*    -------------------------------
  3560     05  FILLER            PIC  X(0003).
  3561     05  ACCTNMBO PIC  X(0030).
  3562*    -------------------------------
  3563     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  70
* EL156.cbl
  3564     05  UNDISBO PIC  ZZZ,Z99.99.
  3565*    -------------------------------
  3566     05  FILLER            PIC  X(0003).
  3567     05  RATEBO PIC  ZZZ.99.
  3568*    -------------------------------
  3569     05  FILLER            PIC  X(0003).
  3570     05  ERMSG1BO PIC  X(0072).
  3571*    -------------------------------
  3572     05  FILLER            PIC  X(0003).
  3573     05  ENTPFBO PIC  X(0002).
  3574*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  71
* EL156.cbl
  3576****************************************************************
  3577*
  3578* Copyright (c) 2007 by Clerity Solutions, Inc.
  3579* All rights reserved.
  3580*
  3581****************************************************************
  3582 01  DFHEIV.
  3583   02  DFHEIV0               PIC X(35).
  3584   02  DFHEIV1               PIC X(08).
  3585   02  DFHEIV2               PIC X(08).
  3586   02  DFHEIV3               PIC X(08).
  3587   02  DFHEIV4               PIC X(06).
  3588   02  DFHEIV5               PIC X(04).
  3589   02  DFHEIV6               PIC X(04).
  3590   02  DFHEIV7               PIC X(02).
  3591   02  DFHEIV8               PIC X(02).
  3592   02  DFHEIV9               PIC X(01).
  3593   02  DFHEIV10              PIC S9(7) COMP-3.
  3594   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3595   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3596   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3597   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3598   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3599   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3600   02  DFHEIV17              PIC X(04).
  3601   02  DFHEIV18              PIC X(04).
  3602   02  DFHEIV19              PIC X(04).
  3603   02  DFHEIV20              USAGE IS POINTER.
  3604   02  DFHEIV21              USAGE IS POINTER.
  3605   02  DFHEIV22              USAGE IS POINTER.
  3606   02  DFHEIV23              USAGE IS POINTER.
  3607   02  DFHEIV24              USAGE IS POINTER.
  3608   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3609   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3610   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3611   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3612   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3613   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3614   02  FILLER                PIC X(02).
  3615   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3616   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3617   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3618   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3619   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3620 LINKAGE  SECTION.
  3621*****************************************************************
  3622*                                                               *
  3623* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3624* All rights reserved.                                          *
  3625*                                                               *
  3626*****************************************************************
  3627 01  dfheiblk.
  3628     02  eibtime          pic s9(7) comp-3.
  3629     02  eibdate          pic s9(7) comp-3.
  3630     02  eibtrnid         pic x(4).
  3631     02  eibtaskn         pic s9(7) comp-3.
  3632     02  eibtrmid         pic x(4).
  3633     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  72
* EL156.cbl
  3634     02  eibcposn         pic s9(4) comp.
  3635     02  eibcalen         pic s9(4) comp.
  3636     02  eibaid           pic x(1).
  3637     02  eibfiller1       pic x(1).
  3638     02  eibfn            pic x(2).
  3639     02  eibfiller2       pic x(2).
  3640     02  eibrcode         pic x(6).
  3641     02  eibfiller3       pic x(2).
  3642     02  eibds            pic x(8).
  3643     02  eibreqid         pic x(8).
  3644     02  eibrsrce         pic x(8).
  3645     02  eibsync          pic x(1).
  3646     02  eibfree          pic x(1).
  3647     02  eibrecv          pic x(1).
  3648     02  eibsend          pic x(1).
  3649     02  eibatt           pic x(1).
  3650     02  eibeoc           pic x(1).
  3651     02  eibfmh           pic x(1).
  3652     02  eibcompl         pic x(1).
  3653     02  eibsig           pic x(1).
  3654     02  eibconf          pic x(1).
  3655     02  eiberr           pic x(1).
  3656     02  eibrldbk         pic x(1).
  3657     02  eiberrcd         pic x(4).
  3658     02  eibsynrb         pic x(1).
  3659     02  eibnodat         pic x(1).
  3660     02  eibfiller5       pic x(2).
  3661     02  eibresp          pic 9(09) comp.
  3662     02  eibresp2         pic 9(09) comp.
  3663     02  dfheigdj         pic s9(4) comp.
  3664     02  dfheigdk         pic s9(4) comp.
  3665 01  DFHCOMMAREA             PIC X(1024).
  3666
  3667*    COPY ELCMSTR.
  3668******************************************************************
  3669*                                                                *
  3670*                            ELCMSTR.                            *
  3671*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3672*                            VMOD=2.012                          *
  3673*                                                                *
  3674*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3675*                                                                *
  3676*   FILE TYPE = VSAM,KSDS                                        *
  3677*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3678*                                                                *
  3679*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3680*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3681*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3682*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3683*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3684*                                                 RKP=75,LEN=21  *
  3685*                                                                *
  3686*   **** NOTE ****                                               *
  3687*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3688*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3689*                                                                *
  3690*   LOG = YES                                                    *
  3691*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  73
* EL156.cbl
  3692******************************************************************
  3693*                   C H A N G E   L O G
  3694*
  3695* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3696*-----------------------------------------------------------------
  3697*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3698* EFFECTIVE    NUMBER
  3699*-----------------------------------------------------------------
  3700* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3701* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3702******************************************************************
  3703 01  CLAIM-MASTER.
  3704     12  CL-RECORD-ID                PIC XX.
  3705         88  VALID-CL-ID         VALUE 'CL'.
  3706
  3707     12  CL-CONTROL-PRIMARY.
  3708         16  CL-COMPANY-CD           PIC X.
  3709         16  CL-CARRIER              PIC X.
  3710         16  CL-CLAIM-NO             PIC X(7).
  3711         16  CL-CERT-NO.
  3712             20  CL-CERT-PRIME       PIC X(10).
  3713             20  CL-CERT-SFX         PIC X.
  3714
  3715     12  CL-CONTROL-BY-NAME.
  3716         16  CL-COMPANY-CD-A1        PIC X.
  3717         16  CL-INSURED-LAST-NAME    PIC X(15).
  3718         16  CL-INSURED-NAME.
  3719             20  CL-INSURED-1ST-NAME PIC X(12).
  3720             20  CL-INSURED-MID-INIT PIC X.
  3721
  3722     12  CL-CONTROL-BY-SSN.
  3723         16  CL-COMPANY-CD-A2        PIC X.
  3724         16  CL-SOC-SEC-NO.
  3725             20  CL-SSN-STATE        PIC XX.
  3726             20  CL-SSN-ACCOUNT      PIC X(6).
  3727             20  CL-SSN-LN3          PIC X(3).
  3728
  3729     12  CL-CONTROL-BY-CERT-NO.
  3730         16  CL-COMPANY-CD-A4        PIC X.
  3731         16  CL-CERT-NO-A4.
  3732             20  CL-CERT-A4-PRIME    PIC X(10).
  3733             20  CL-CERT-A4-SFX      PIC X.
  3734
  3735     12  CL-CONTROL-BY-CCN.
  3736         16  CL-COMPANY-CD-A5        PIC X.
  3737         16  CL-CCN-A5.
  3738             20  CL-CCN.
  3739                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3740                 24  CL-CCN-PRIME-A5 PIC X(12).
  3741             20  CL-CCN-FILLER-A5    PIC X(4).
  3742
  3743     12  CL-INSURED-PROFILE-DATA.
  3744         16  CL-INSURED-BIRTH-DT     PIC XX.
  3745         16  CL-INSURED-SEX-CD       PIC X.
  3746             88  INSURED-IS-MALE        VALUE 'M'.
  3747             88  INSURED-IS-FEMALE      VALUE 'F'.
  3748             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3749         16  CL-INSURED-OCC-CD       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  74
* EL156.cbl
  3750         16  FILLER                  PIC X(5).
  3751
  3752     12  CL-PROCESSING-INFO.
  3753         16  CL-PROCESSOR-ID         PIC X(4).
  3754         16  CL-CLAIM-STATUS         PIC X.
  3755             88  CLAIM-IS-OPEN          VALUE 'O'.
  3756             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3757         16  CL-CLAIM-TYPE           PIC X.
  3758*            88  AH-CLAIM               VALUE 'A'.
  3759*            88  LIFE-CLAIM             VALUE 'L'.
  3760*            88  PROPERTY-CLAIM         VALUE 'P'.
  3761*            88  IUI-CLAIM              VALUE 'I'.
  3762*            88  GAP-CLAIM              VALUE 'G'.
  3763         16  CL-CLAIM-PREM-TYPE      PIC X.
  3764             88  SINGLE-PREMIUM         VALUE '1'.
  3765             88  O-B-COVERAGE           VALUE '2'.
  3766             88  OPEN-END-COVERAGE      VALUE '3'.
  3767         16  CL-INCURRED-DT          PIC XX.
  3768         16  CL-REPORTED-DT          PIC XX.
  3769         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3770         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3771         16  CL-LAST-PMT-DT          PIC XX.
  3772         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3773         16  CL-PAID-THRU-DT         PIC XX.
  3774         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3775         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3776         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3777         16  CL-PMT-CALC-METHOD      PIC X.
  3778             88  CL-360-DAY-YR          VALUE '1'.
  3779             88  CL-365-DAY-YR          VALUE '2'.
  3780             88  CL-FULL-MONTHS         VALUE '3'.
  3781         16  CL-CAUSE-CD             PIC X(6).
  3782
  3783         16  CL-PRIME-CERT-NO.
  3784             20  CL-PRIME-CERT-PRIME PIC X(10).
  3785             20  CL-PRIME-CERT-SFX   PIC X.
  3786
  3787         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3788             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3789             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3790
  3791         16  CL-MICROFILM-NO         PIC X(10).
  3792         16  CL-PROG-FORM-TYPE       PIC X.
  3793         16  CL-LAST-ADD-ON-DT       PIC XX.
  3794
  3795         16  CL-LAST-REOPEN-DT       PIC XX.
  3796         16  CL-LAST-CLOSE-DT        PIC XX.
  3797         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3798             88  FINAL-PAID             VALUE '1'.
  3799             88  CLAIM-DENIED           VALUE '2'.
  3800             88  AUTO-CLOSE             VALUE '3'.
  3801             88  MANUAL-CLOSE           VALUE '4'.
  3802             88  BENEFITS-CHANGED       VALUE 'C'.
  3803             88  SETUP-ERRORS           VALUE 'E'.
  3804         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3805         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3806         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3807             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  75
* EL156.cbl
  3808         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3809         16  FILLER                  PIC X.
  3810
  3811     12  CL-CERTIFICATE-DATA.
  3812         16  CL-CERT-ORIGIN          PIC X.
  3813             88  CERT-WAS-ONLINE        VALUE '1'.
  3814             88  CERT-WAS-CREATED       VALUE '2'.
  3815             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3816         16  CL-CERT-KEY-DATA.
  3817             20  CL-CERT-CARRIER     PIC X.
  3818             20  CL-CERT-GROUPING    PIC X(6).
  3819             20  CL-CERT-STATE       PIC XX.
  3820             20  CL-CERT-ACCOUNT.
  3821                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3822                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3823             20  CL-CERT-EFF-DT      PIC XX.
  3824
  3825     12  CL-STATUS-CONTROLS.
  3826         16  CL-PRIORITY-CD          PIC X.
  3827             88  CONFIDENTIAL-DATA      VALUE '8'.
  3828             88  HIGHEST-PRIORITY       VALUE '9'.
  3829         16  CL-SUPV-ATTN-CD         PIC X.
  3830             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3831             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3832         16  CL-PURGED-DT            PIC XX.
  3833         16  CL-RESTORED-DT          PIC XX.
  3834         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3835         16  CL-NEXT-RESEND-DT       PIC XX.
  3836         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3837         16  FILLER                  PIC XX.
  3838         16  CL-LAST-MAINT-DT        PIC XX.
  3839         16  CL-LAST-MAINT-USER      PIC X(4).
  3840         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3841         16  CL-LAST-MAINT-TYPE      PIC X.
  3842             88  CLAIM-SET-UP           VALUE ' '.
  3843             88  PAYMENT-MADE           VALUE '1'.
  3844             88  LETTER-SENT            VALUE '2'.
  3845             88  MASTER-WAS-ALTERED     VALUE '3'.
  3846             88  MASTER-WAS-RESTORED    VALUE '4'.
  3847             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3848             88  FILE-CONVERTED         VALUE '6'.
  3849             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3850             88  ERROR-CORRECTION       VALUE 'E'.
  3851         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3852         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3853         16  CL-BENEFICIARY          PIC X(10).
  3854         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3855         16  CL-DENIAL-TYPE          PIC X.
  3856             88  CL-TYPE-DENIAL          VALUE '1'.
  3857             88  CL-TYPE-RESCISSION      VALUE '2'.
  3858             88  CL-TYPE-REFORMATION     VALUE '3'.
  3859             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3860             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3861         16  FILLER                  PIC X(5).
  3862
  3863     12  CL-TRAILER-CONTROLS.
  3864         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3865             88  CL-1ST-TRL-AVAIL       VALUE +4095.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  76
* EL156.cbl
  3866             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3867             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3868         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3869         16  FILLER                  PIC XX.
  3870         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3871         16  CL-ADDRESS-TRAILER-CNT.
  3872             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3873                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3874             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3875                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3876             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3877                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3878             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3879                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3880             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3881                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3882             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3883                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3884             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3885                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3886
  3887     12  CL-CV-REFERENCE-NO.
  3888         16  CL-CV-REFNO-PRIME       PIC X(18).
  3889         16  CL-CV-REFNO-SFX         PIC XX.
  3890
  3891     12  CL-FILE-LOCATION            PIC X(4).
  3892
  3893     12  CL-PROCESS-ERRORS.
  3894         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3895             88  NO-FATAL-ERRORS        VALUE ZERO.
  3896         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3897             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3898
  3899     12  CL-PRODUCT-CD               PIC X.
  3900
  3901     12  CL-CURRENT-KEY-DATA.
  3902         16  CL-CURRENT-CARRIER      PIC X.
  3903         16  CL-CURRENT-GROUPING     PIC X(6).
  3904         16  CL-CURRENT-STATE        PIC XX.
  3905         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3906
  3907     12  CL-ASSOCIATES               PIC X.
  3908         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3909         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3910         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3911         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3912
  3913     12  CL-ACTIVITY-CODE            PIC 99.
  3914     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3915     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3916
  3917     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3918     12  CL-LAG-REPORT-CODE          PIC 9.
  3919     12  CL-LOAN-TYPE                PIC XX.
  3920     12  CL-LEGAL-STATE              PIC XX.
  3921
  3922*    12  FILLER                      PIC X(5).
  3923     12  CL-YESNOSW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  77
* EL156.cbl
  3924     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  78
* EL156.cbl
  3926*    COPY ELCCNTL.
  3927******************************************************************
  3928*                                                                *
  3929*                                                                *
  3930*                            ELCCNTL.                            *
  3931*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3932*                            VMOD=2.059                          *
  3933*                                                                *
  3934*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3935*                                                                *
  3936*   FILE TYPE = VSAM,KSDS                                        *
  3937*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3938*                                                                *
  3939*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3940*       ALTERNATE INDEX = NONE                                   *
  3941*                                                                *
  3942*   LOG = YES                                                    *
  3943*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3944******************************************************************
  3945*                   C H A N G E   L O G
  3946*
  3947* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3948*-----------------------------------------------------------------
  3949*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3950* EFFECTIVE    NUMBER
  3951*-----------------------------------------------------------------
  3952* 082503                   PEMA  ADD BENEFIT GROUP
  3953* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3954* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3955* 092705    2005050300006  PEMA  ADD SPP LEASES
  3956* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3957* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3958* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3959* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3960* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3961******************************************************************
  3962*
  3963 01  CONTROL-FILE.
  3964     12  CF-RECORD-ID                       PIC XX.
  3965         88  VALID-CF-ID                        VALUE 'CF'.
  3966
  3967     12  CF-CONTROL-PRIMARY.
  3968         16  CF-COMPANY-ID                  PIC XXX.
  3969         16  CF-RECORD-TYPE                 PIC X.
  3970             88  CF-COMPANY-MASTER              VALUE '1'.
  3971             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3972             88  CF-STATE-MASTER                VALUE '3'.
  3973             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3974             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3975             88  CF-CARRIER-MASTER              VALUE '6'.
  3976             88  CF-MORTALITY-MASTER            VALUE '7'.
  3977             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3978             88  CF-TERMINAL-MASTER             VALUE '9'.
  3979             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3980             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3981             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3982             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3983             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  79
* EL156.cbl
  3984             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3985             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3986             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3987             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3988         16  CF-ACCESS-CD-GENL              PIC X(4).
  3989         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3990             20  CF-PROCESSOR               PIC X(4).
  3991         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3992             20  CF-STATE-CODE              PIC XX.
  3993             20  FILLER                     PIC XX.
  3994         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3995             20  FILLER                     PIC XX.
  3996             20  CF-HI-BEN-IN-REC           PIC XX.
  3997         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3998             20  FILLER                     PIC XXX.
  3999             20  CF-CARRIER-CNTL            PIC X.
  4000         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4001             20  FILLER                     PIC XX.
  4002             20  CF-HI-TYPE-IN-REC          PIC 99.
  4003         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4004             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4005                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4006             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4007             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4008         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4009             20  FILLER                     PIC X.
  4010             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4011         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4012             20  FILLER                     PIC XX.
  4013             20  CF-MORTGAGE-PLAN           PIC XX.
  4014         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4015
  4016     12  CF-LAST-MAINT-DT                   PIC XX.
  4017     12  CF-LAST-MAINT-BY                   PIC X(4).
  4018     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4019
  4020     12  CF-RECORD-BODY                     PIC X(728).
  4021
  4022
  4023****************************************************************
  4024*             COMPANY MASTER RECORD                            *
  4025****************************************************************
  4026
  4027     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4028         16  CF-COMPANY-ADDRESS.
  4029             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4030             20  CF-CL-IN-CARE-OF           PIC X(30).
  4031             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4032             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4033             20  CF-CL-CITY-STATE           PIC X(30).
  4034             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4035             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4036         16  CF-COMPANY-CD                  PIC X.
  4037         16  CF-COMPANY-PASSWORD            PIC X(8).
  4038         16  CF-SECURITY-OPTION             PIC X.
  4039             88  ALL-SECURITY                   VALUE '1'.
  4040             88  COMPANY-VERIFY                 VALUE '2'.
  4041             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  80
* EL156.cbl
  4042             88  NO-SECURITY                    VALUE '4'.
  4043             88  ALL-BUT-TERM                   VALUE '5'.
  4044         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4045             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4046         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4047             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4048         16  CF-INFORCE-LOCATION            PIC X.
  4049             88  CERTS-ARE-ONLINE               VALUE '1'.
  4050             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4051             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4052         16  CF-LOWER-CASE-LETTERS          PIC X.
  4053         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4054             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4055             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4056             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4057             88  CF-ACCNT-CNTL                  VALUE '3'.
  4058             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4059
  4060         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4061         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4062
  4063         16  CF-LGX-CREDIT-USER             PIC X.
  4064             88  CO-IS-NOT-USER                 VALUE 'N'.
  4065             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4066
  4067         16 CF-CREDIT-CALC-CODES.
  4068             20  CF-CR-REM-TERM-CALC PIC X.
  4069               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4070               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4071               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4072               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4073               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4074               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4075               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4076             20  CF-CR-R78-METHOD           PIC X.
  4077               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4078               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4079
  4080         16  CF-CLAIM-CONTROL-COUNTS.
  4081             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4082                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4083
  4084             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4085                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4086
  4087             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4088                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4089
  4090             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4091                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4092
  4093         16  CF-CURRENT-MONTH-END           PIC XX.
  4094
  4095         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4096             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4097             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4098             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4099             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  81
* EL156.cbl
  4100                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4101                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4102             20  CF-CO-PREM-REJECT-SW       PIC X.
  4103                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4104                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4105             20  CF-CO-REF-REJECT-SW        PIC X.
  4106                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4107                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4108
  4109         16  CF-CO-REPORTING-DT             PIC XX.
  4110         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4111         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4112           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4113           88  CF-CO-MONTH-END                  VALUE '1'.
  4114
  4115         16  CF-LGX-CLAIM-USER              PIC X.
  4116             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4117             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4118
  4119         16  CF-CREDIT-EDIT-CONTROLS.
  4120             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4121             20  CF-MIN-AGE                 PIC 99.
  4122             20  CF-DEFAULT-AGE             PIC 99.
  4123             20  CF-MIN-TERM                PIC S999      COMP-3.
  4124             20  CF-MAX-TERM                PIC S999      COMP-3.
  4125             20  CF-DEFAULT-SEX             PIC X.
  4126             20  CF-JOINT-AGE-INPUT         PIC X.
  4127                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4128             20  CF-BIRTH-DATE-INPUT        PIC X.
  4129                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4130             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4131                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4132                 88  CF-ZERO-CARRIER            VALUE '1'.
  4133                 88  CF-ZERO-GROUPING           VALUE '2'.
  4134                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4135             20  CF-EDIT-SW                 PIC X.
  4136                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4137             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4138             20  CF-CR-PR-METHOD            PIC X.
  4139               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4140               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4141             20  FILLER                     PIC X.
  4142
  4143         16  CF-CREDIT-MISC-CONTROLS.
  4144             20  CF-REIN-TABLE-SW           PIC X.
  4145                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4146             20  CF-COMP-TABLE-SW           PIC X.
  4147                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4148             20  CF-EXPERIENCE-RETENTION-AGE
  4149                                            PIC S9        COMP-3.
  4150             20  CF-CONVERSION-DT           PIC XX.
  4151             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4152             20  CF-RUN-FREQUENCY-SW        PIC X.
  4153                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4154                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4155
  4156             20  CF-CR-CHECK-NO-CONTROL.
  4157                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  82
* EL156.cbl
  4158                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4159                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4160                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4161                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4162                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4163
  4164                 24  CF-CR-CHECK-COUNT       REDEFINES
  4165                     CF-CR-CHECK-COUNTER      PIC X(4).
  4166
  4167                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4168                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4169
  4170                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4171                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4172                 24  CF-MAIL-PROCESSING       PIC X.
  4173                     88  MAIL-PROCESSING          VALUE 'Y'.
  4174
  4175         16  CF-MISC-SYSTEM-CONTROL.
  4176             20  CF-SYSTEM-C                 PIC X.
  4177                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4178             20  CF-SYSTEM-D                 PIC X.
  4179                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4180             20  CF-SOC-SEC-NO-SW            PIC X.
  4181                 88  SOC-SEC-NO-USED             VALUE '1'.
  4182             20  CF-MEMBER-NO-SW             PIC X.
  4183                 88  MEMBER-NO-USED              VALUE '1'.
  4184             20  CF-TAX-ID-NUMBER            PIC X(11).
  4185             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4186             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4187                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4188                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4189                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4190                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4191             20  CF-SYSTEM-E                 PIC X.
  4192                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4193
  4194         16  CF-LGX-LIFE-USER               PIC X.
  4195             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4196             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4197
  4198         16  CF-CR-MONTH-END-DT             PIC XX.
  4199
  4200         16  CF-FILE-MAINT-DATES.
  4201             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4202                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4203             20  CF-LAST-BATCH       REDEFINES
  4204                 CF-LAST-BATCH-NO               PIC X(4).
  4205             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4206             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4207             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4208             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4209             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4210             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4211             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4212             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4213             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4214             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4215
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  83
* EL156.cbl
  4216         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4217         16  FILLER                         PIC X.
  4218
  4219         16  CF-ALT-MORT-CODE               PIC X(4).
  4220         16  CF-MEMBER-CAPTION              PIC X(10).
  4221
  4222         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4223             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4224             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4225             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4226             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4227             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4228
  4229         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4230
  4231         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4232         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4233         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4234         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4235
  4236         16  CF-AH-OVERRIDE-L1              PIC X.
  4237         16  CF-AH-OVERRIDE-L2              PIC XX.
  4238         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4239         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4240
  4241         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4242         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4243
  4244         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4245         16  CF-AR-LAST-EL860-DT            PIC XX.
  4246         16  CF-MP-MONTH-END-DT             PIC XX.
  4247
  4248         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4249         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4250             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4251
  4252         16  CF-AR-MONTH-END-DT             PIC XX.
  4253
  4254         16  CF-CRDTCRD-USER                PIC X.
  4255             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4256             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4257
  4258         16  CF-CC-MONTH-END-DT             PIC XX.
  4259
  4260         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4261
  4262         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4263             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4264             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4265             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4266         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4267         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4268         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4269         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4270             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4271             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4272         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4273         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  84
* EL156.cbl
  4274         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4275             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4276         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4277
  4278         16  CF-CL-ZIP-CODE.
  4279             20  CF-CL-ZIP-PRIME.
  4280                 24  CF-CL-ZIP-1ST          PIC X.
  4281                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4282                 24  FILLER                 PIC X(4).
  4283             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4284         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4285             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4286             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4287             20  FILLER                     PIC XXX.
  4288
  4289         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4290         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4291         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4292         16  CF-CO-OPTION-START-DATE        PIC XX.
  4293         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4294           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4295                                                      '3' '4'.
  4296           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4297           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4298           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4299           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4300           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4301           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4302
  4303         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4304
  4305         16  CF-PAYMENT-APPROVAL-LEVELS.
  4306             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4307             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4308             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4309             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4310             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4311             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4312
  4313         16  CF-END-USER-REPORTING-USER     PIC X.
  4314             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4315             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4316
  4317         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4318             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4319             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4320
  4321         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4322
  4323         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4324         16  FILLER                         PIC X.
  4325
  4326         16  CF-CREDIT-ARCHIVE-CNTL.
  4327             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4328             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4329             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4330
  4331         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  85
* EL156.cbl
  4332
  4333         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4334             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4335             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4336
  4337         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4338             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4339             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4340
  4341         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4342
  4343         16  CF-CO-ACH-ID-CODE              PIC  X.
  4344             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4345             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4346             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4347         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4348         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4349         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4350         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4351         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4352         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4353         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4354         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4355         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4356                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4357         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4358                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4359
  4360         16  CF-CO-OVER-SHORT.
  4361             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4362             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4363
  4364*         16  FILLER                         PIC X(102).
  4365         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4366             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4367             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4368
  4369         16  CF-AH-APPROVAL-DAYS.
  4370             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4371             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4372             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4373             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4374
  4375         16  FILLER                         PIC X(82).
  4376****************************************************************
  4377*             PROCESSOR/USER RECORD                            *
  4378****************************************************************
  4379
  4380     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4381         16  CF-PROCESSOR-NAME              PIC X(30).
  4382         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4383         16  CF-PROCESSOR-TITLE             PIC X(26).
  4384         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4385                 88  MESSAGE-YES                VALUE 'Y'.
  4386                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4387
  4388*****************************************************
  4389****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  86
* EL156.cbl
  4390****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4391****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4392****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4393*****************************************************
  4394
  4395         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4396             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4397             20  CF-APPLICATION-FORCE       PIC X.
  4398             20  CF-INDIVIDUAL-APP.
  4399                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4400                     28  CF-BROWSE-APP      PIC X.
  4401                     28  CF-UPDATE-APP      PIC X.
  4402
  4403         16  CF-CURRENT-TERM-ON             PIC X(4).
  4404         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4405             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4406             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4407             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4408             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4409             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4410             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4411             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4412         16  CF-PROCESSOR-CARRIER           PIC X.
  4413             88  NO-CARRIER-SECURITY            VALUE ' '.
  4414         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4415             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4416         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4417             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4418         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4419             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4420
  4421         16  CF-PROC-SYS-ACCESS-SW.
  4422             20  CF-PROC-CREDIT-CLAIMS-SW.
  4423                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4424                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4425                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4426                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4427             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4428                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4429                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4430             20  CF-PROC-LIFE-GNRLDGR-SW.
  4431                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4432                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4433                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4434                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4435             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4436                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4437                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4438         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4439             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4440             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4441         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4442
  4443         16  CF-APPROVAL-LEVEL                  PIC X.
  4444             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4445             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4446             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4447             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  87
* EL156.cbl
  4448
  4449         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4450
  4451         16  CF-LANGUAGE-TYPE                   PIC X.
  4452             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4453             88  CF-LANG-IS-FR                      VALUE 'F'.
  4454         16  FILLER                             PIC  X(240).
  4455
  4456****************************************************************
  4457*             PROCESSOR/REMINDERS RECORD                       *
  4458****************************************************************
  4459
  4460     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4461         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4462             20  CF-START-REMIND-DT         PIC XX.
  4463             20  CF-END-REMIND-DT           PIC XX.
  4464             20  CF-REMINDER-TEXT           PIC X(50).
  4465         16  FILLER                         PIC X(296).
  4466
  4467
  4468****************************************************************
  4469*             STATE MASTER RECORD                              *
  4470****************************************************************
  4471
  4472     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4473         16  CF-STATE-ABBREVIATION          PIC XX.
  4474         16  CF-STATE-NAME                  PIC X(25).
  4475         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4476         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4477             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4478             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4479             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4480             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4481                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4482                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4483             20  CF-ST-PREM-REJECT-SW       PIC X.
  4484                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4485                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4486             20  CF-ST-REF-REJECT-SW        PIC X.
  4487                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4488                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4489         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4490         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4491         16  CF-ST-REFUND-RULES.
  4492             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4493             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4494             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4495         16  CF-ST-FST-PMT-EXTENSION.
  4496             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4497             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4498                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4499                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4500                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4501                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4502         16  CF-ST-STATE-CALL.
  4503             20  CF-ST-CALL-UNEARNED        PIC X.
  4504             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4505             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  88
* EL156.cbl
  4506         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4507             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4508             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4509         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4510         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4511         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4512         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4513         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4514         16  FILLER                         PIC X.
  4515         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4516             20  CF-ST-BENEFIT-CD           PIC XX.
  4517             20  CF-ST-BENEFIT-KIND         PIC X.
  4518                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4519                 88  CF-ST-AH-KIND              VALUE 'A'.
  4520             20  CF-ST-REM-TERM-CALC        PIC X.
  4521                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4522                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4523                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4524                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4525                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4526                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4527                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4528                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4529
  4530             20  CF-ST-REFUND-CALC          PIC X.
  4531                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4532                 88  ST-REFD-BY-R78             VALUE '1'.
  4533                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4534                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4535                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4536                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4537                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4538                 88  ST-REFD-UTAH               VALUE '7'.
  4539                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4540                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4541                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4542
  4543             20  CF-ST-EARNING-CALC         PIC X.
  4544                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4545                 88  ST-EARN-BY-R78             VALUE '1'.
  4546                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4547                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4548                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4549                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4550                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4551                 88  ST-EARN-MEAN               VALUE '8'.
  4552                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4553
  4554             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4555                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4556                 88  ST-OVRD-BY-R78             VALUE '1'.
  4557                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4558                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4559                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4560                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4561                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4562                 88  ST-OVRD-MEAN               VALUE '8'.
  4563                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  89
* EL156.cbl
  4564             20  FILLER                     PIC X.
  4565
  4566         16  CF-ST-COMMISSION-CAPS.
  4567             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4568             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4569             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4570             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4571         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4572                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4573
  4574         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4575
  4576         16  CF-ST-STATUTORY-INTEREST.
  4577             20  CF-ST-STAT-DATE-FROM       PIC X.
  4578                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4579                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4580             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4581             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4582             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4583             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4584             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4585
  4586         16  CF-ST-OVER-SHORT.
  4587             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4588             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4589
  4590         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4591
  4592         16  CF-ST-RT-CALC                  PIC X.
  4593
  4594         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4595         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4596         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4597         16  CF-ST-RF-LR-CALC               PIC X.
  4598         16  CF-ST-RF-LL-CALC               PIC X.
  4599         16  CF-ST-RF-LN-CALC               PIC X.
  4600         16  CF-ST-RF-AH-CALC               PIC X.
  4601         16  CF-ST-RF-CP-CALC               PIC X.
  4602*        16  FILLER                         PIC X(206).
  4603*CIDMOD         16  FILLER                         PIC X(192).
  4604         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4605             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4606         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4607         16  CF-ST-VFY-2ND-BENE             PIC X.
  4608         16  FILLER                         PIC X(186).
  4609
  4610****************************************************************
  4611*             BENEFIT MASTER RECORD                            *
  4612****************************************************************
  4613
  4614     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4615         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4616             20  CF-BENEFIT-CODE            PIC XX.
  4617             20  CF-BENEFIT-NUMERIC  REDEFINES
  4618                 CF-BENEFIT-CODE            PIC XX.
  4619             20  CF-BENEFIT-ALPHA           PIC XXX.
  4620             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4621             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  90
* EL156.cbl
  4622
  4623             20  CF-LF-COVERAGE-TYPE        PIC X.
  4624                 88  CF-REDUCING                VALUE 'R'.
  4625                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4626
  4627             20  CF-SPECIAL-CALC-CD         PIC X.
  4628                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4629                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4630                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4631                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4632                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4633                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4634                 88  CF-FARM-PLAN               VALUE 'F'.
  4635                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4636                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4637                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4638                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4639                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4640                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4641                 88  CF-PRUDENTIAL              VALUE 'P'.
  4642                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4643                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4644                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4645                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4646                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4647                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4648
  4649             20  CF-JOINT-INDICATOR         PIC X.
  4650                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4651
  4652*            20  FILLER                     PIC X(12).
  4653             20  FILLER                     PIC X(11).
  4654             20  CF-BENEFIT-CATEGORY        PIC X.
  4655             20  CF-LOAN-TYPE               PIC X(8).
  4656
  4657             20  CF-CO-REM-TERM-CALC        PIC X.
  4658                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4659                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4660                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4661                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4662                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4663
  4664             20  CF-CO-EARNINGS-CALC        PIC X.
  4665                 88  CO-EARN-BY-R78             VALUE '1'.
  4666                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4667                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4668                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4669                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4670                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4671                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4672                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4673
  4674             20  CF-CO-REFUND-CALC          PIC X.
  4675                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4676                 88  CO-REFD-BY-R78             VALUE '1'.
  4677                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4678                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4679                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  91
* EL156.cbl
  4680                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4681                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4682                 88  CO-REFD-MEAN               VALUE '8'.
  4683                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4684                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4685                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4686
  4687             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4688                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4689                 88  CO-OVRD-BY-R78             VALUE '1'.
  4690                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4691                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4692                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4693                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4694                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4695                 88  CO-OVRD-MEAN               VALUE '8'.
  4696                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4697
  4698             20  CF-CO-BEN-I-G-CD           PIC X.
  4699                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4700                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4701                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4702
  4703         16  FILLER                         PIC X(304).
  4704
  4705
  4706****************************************************************
  4707*             CARRIER MASTER RECORD                            *
  4708****************************************************************
  4709
  4710     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4711         16  CF-ADDRESS-DATA.
  4712             20  CF-MAIL-TO-NAME            PIC X(30).
  4713             20  CF-IN-CARE-OF              PIC X(30).
  4714             20  CF-ADDRESS-LINE-1          PIC X(30).
  4715             20  CF-ADDRESS-LINE-2          PIC X(30).
  4716             20  CF-CITY-STATE              PIC X(30).
  4717             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4718             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4719
  4720         16  CF-CLAIM-NO-CONTROL.
  4721             20  CF-CLAIM-NO-METHOD         PIC X.
  4722                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4723                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4724                 88  CLAIM-NO-SEQ               VALUE '3'.
  4725                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4726             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4727                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4728                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4729                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4730
  4731         16  CF-CHECK-NO-CONTROL.
  4732             20  CF-CHECK-NO-METHOD         PIC X.
  4733                 88  CHECK-NO-MANUAL            VALUE '1'.
  4734                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4735                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4736                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4737             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  92
* EL156.cbl
  4738                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4739
  4740         16  CF-DOMICILE-STATE              PIC XX.
  4741
  4742         16  CF-EXPENSE-CONTROLS.
  4743             20  CF-EXPENSE-METHOD          PIC X.
  4744                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4745                 88  DOLLARS-PER-PMT            VALUE '2'.
  4746                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4747                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4748             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4749             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4750
  4751         16  CF-CORRESPONDENCE-CONTROL.
  4752             20  CF-LETTER-RESEND-OPT       PIC X.
  4753                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4754                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4755             20  FILLER                     PIC X(4).
  4756
  4757         16  CF-RESERVE-CONTROLS.
  4758             20  CF-MANUAL-SW               PIC X.
  4759                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4760             20  CF-FUTURE-SW               PIC X.
  4761                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4762             20  CF-PTC-SW                  PIC X.
  4763                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4764             20  CF-IBNR-SW                 PIC X.
  4765                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4766             20  CF-PTC-LF-SW               PIC X.
  4767                 88  CF-LF-PTC-USED             VALUE '1'.
  4768             20  CF-CDT-ACCESS-METHOD       PIC X.
  4769                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4770                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4771                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4772             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4773
  4774         16  CF-CLAIM-CALC-METHOD           PIC X.
  4775             88  360-PLUS-MONTHS                VALUE '1'.
  4776             88  365-PLUS-MONTHS                VALUE '2'.
  4777             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4778             88  360-DAILY                      VALUE '4'.
  4779             88  365-DAILY                      VALUE '5'.
  4780
  4781         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4782         16  FILLER                         PIC X(11).
  4783
  4784         16  CF-LIMIT-AMOUNTS.
  4785             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4786             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4787             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4788             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4789             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4790             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4791             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4792             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4793             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4794             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4795
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  93
* EL156.cbl
  4796         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4797         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4798         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4799
  4800         16  CF-ZIP-CODE.
  4801             20  CF-ZIP-PRIME.
  4802                 24  CF-ZIP-1ST             PIC X.
  4803                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4804                 24  FILLER                 PIC X(4).
  4805             20  CF-ZIP-PLUS4               PIC X(4).
  4806         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4807             20  CF-CAN-POSTAL-1            PIC XXX.
  4808             20  CF-CAN-POSTAL-2            PIC XXX.
  4809             20  FILLER                     PIC XXX.
  4810
  4811         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4812         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4813         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4814
  4815         16  CF-RATING-SWITCH               PIC X.
  4816             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4817             88  CF-NO-RATING                   VALUE 'N'.
  4818
  4819         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4820
  4821         16  CF-CARRIER-OVER-SHORT.
  4822             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4823             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4824
  4825         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4826         16  CF-SECPAY-SWITCH               PIC X.
  4827             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4828             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4829         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4830         16  FILLER                         PIC X(448).
  4831*        16  FILLER                         PIC X(452).
  4832
  4833
  4834****************************************************************
  4835*             MORTALITY MASTER RECORD                          *
  4836****************************************************************
  4837
  4838     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4839         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4840                                INDEXED BY CF-MORT-NDX.
  4841             20  CF-MORT-TABLE              PIC X(5).
  4842             20  CF-MORT-TABLE-TYPE         PIC X.
  4843                 88  CF-MORT-JOINT              VALUE 'J'.
  4844                 88  CF-MORT-SINGLE             VALUE 'S'.
  4845                 88  CF-MORT-COMBINED           VALUE 'C'.
  4846                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4847                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4848             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4849             20  CF-MORT-AGE-METHOD         PIC XX.
  4850                 88  CF-AGE-LAST                VALUE 'AL'.
  4851                 88  CF-AGE-NEAR                VALUE 'AN'.
  4852             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4853             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  94
* EL156.cbl
  4854                                            PIC X.
  4855                 88  CF-MINUS                   VALUE '-'.
  4856                 88  CF-PLUS                    VALUE '+'.
  4857             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4858             20  CF-MORT-JOINT-CODE         PIC X.
  4859                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4860             20  CF-MORT-PC-Q               PIC X.
  4861                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4862             20  CF-MORT-TABLE-CODE         PIC X(4).
  4863             20  CF-MORT-COMMENTS           PIC X(15).
  4864             20  FILLER                     PIC X(14).
  4865
  4866         16  FILLER                         PIC X(251).
  4867
  4868
  4869****************************************************************
  4870*             BUSSINESS TYPE MASTER RECORD                     *
  4871****************************************************************
  4872
  4873     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4874* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4875* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4876* AND RECORD 05 IS TYPES 81-99
  4877         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4878             20  CF-BUSINESS-TITLE          PIC  X(19).
  4879             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4880                                            PIC S9V9(4) COMP-3.
  4881             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4882             20  FILLER                     PIC  X.
  4883         16  FILLER                         PIC  X(248).
  4884
  4885
  4886****************************************************************
  4887*             TERMINAL MASTER RECORD                           *
  4888****************************************************************
  4889
  4890     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4891
  4892         16  CF-COMPANY-TERMINALS.
  4893             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4894                                  PIC X(4).
  4895         16  FILLER               PIC X(248).
  4896
  4897
  4898****************************************************************
  4899*             LIFE EDIT MASTER RECORD                          *
  4900****************************************************************
  4901
  4902     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4903         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4904             20  CF-LIFE-CODE-IN            PIC XX.
  4905             20  CF-LIFE-CODE-OUT           PIC XX.
  4906         16  FILLER                         PIC X(248).
  4907
  4908
  4909****************************************************************
  4910*             AH EDIT MASTER RECORD                            *
  4911****************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  95
* EL156.cbl
  4912
  4913     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4914         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4915             20  CF-AH-CODE-IN              PIC XXX.
  4916             20  CF-AH-CODE-OUT             PIC XX.
  4917         16  FILLER                         PIC X(248).
  4918
  4919
  4920****************************************************************
  4921*             CREDIBILITY TABLES                               *
  4922****************************************************************
  4923
  4924     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4925         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4926                             INDEXED BY CF-CRDB-NDX.
  4927             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4928             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4929             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4930         16  FILLER                         PIC  X(332).
  4931
  4932
  4933****************************************************************
  4934*             REPORT CUSTOMIZATION RECORD                      *
  4935****************************************************************
  4936
  4937     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4938         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4939             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4940             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4941             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4942**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4943****       A T-TRANSFER.                                   ****
  4944             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4945
  4946         16  FILLER                         PIC XX.
  4947
  4948         16  CF-CARRIER-CNTL-OPT.
  4949             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4950                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4951                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4952             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4953                                            PIC X.
  4954         16  CF-GROUP-CNTL-OPT.
  4955             20  CF-GROUP-OPT-SEQ           PIC 9.
  4956                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4957                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4958             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4959                                            PIC X(6).
  4960         16  CF-STATE-CNTL-OPT.
  4961             20  CF-STATE-OPT-SEQ           PIC 9.
  4962                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4963                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4964             20  CF-STATE-SELECT OCCURS 3 TIMES
  4965                                            PIC XX.
  4966         16  CF-ACCOUNT-CNTL-OPT.
  4967             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4968                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4969                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  96
* EL156.cbl
  4970             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4971                                            PIC X(10).
  4972         16  CF-BUS-TYP-CNTL-OPT.
  4973             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4974                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4975                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4976             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4977                                            PIC XX.
  4978         16  CF-LF-TYP-CNTL-OPT.
  4979             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4980                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4981                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4982             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4983                                            PIC XX.
  4984         16  CF-AH-TYP-CNTL-OPT.
  4985             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4986                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4987                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4988             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4989                                            PIC XX.
  4990         16  CF-REPTCD1-CNTL-OPT.
  4991             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4992                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4993                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4994             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4995                                            PIC X(10).
  4996         16  CF-REPTCD2-CNTL-OPT.
  4997             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4998                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4999                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5000             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5001                                            PIC X(10).
  5002         16  CF-USER1-CNTL-OPT.
  5003             20  CF-USER1-OPT-SEQ           PIC 9.
  5004                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5005                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5006             20  CF-USER1-SELECT OCCURS 3 TIMES
  5007                                            PIC X(10).
  5008         16  CF-USER2-CNTL-OPT.
  5009             20  CF-USER2-OPT-SEQ           PIC 9.
  5010                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5011                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5012             20  CF-USER2-SELECT OCCURS 3 TIMES
  5013                                            PIC X(10).
  5014         16  CF-USER3-CNTL-OPT.
  5015             20  CF-USER3-OPT-SEQ           PIC 9.
  5016                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5017                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5018             20  CF-USER3-SELECT OCCURS 3 TIMES
  5019                                            PIC X(10).
  5020         16  CF-USER4-CNTL-OPT.
  5021             20  CF-USER4-OPT-SEQ           PIC 9.
  5022                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5023                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5024             20  CF-USER4-SELECT OCCURS 3 TIMES
  5025                                            PIC X(10).
  5026         16  CF-USER5-CNTL-OPT.
  5027             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  97
* EL156.cbl
  5028                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5029                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5030             20  CF-USER5-SELECT OCCURS 3 TIMES
  5031                                            PIC X(10).
  5032         16  CF-REINS-CNTL-OPT.
  5033             20  CF-REINS-OPT-SEQ           PIC 9.
  5034                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5035                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5036             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5037                 24  CF-REINS-PRIME         PIC XXX.
  5038                 24  CF-REINS-SUB           PIC XXX.
  5039
  5040         16  CF-AGENT-CNTL-OPT.
  5041             20  CF-AGENT-OPT-SEQ           PIC 9.
  5042                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5043                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5044             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5045                                            PIC X(10).
  5046
  5047         16  FILLER                         PIC X(43).
  5048
  5049         16  CF-LOSS-RATIO-SELECT.
  5050             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5051             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5052         16  CF-ENTRY-DATE-SELECT.
  5053             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5054             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5055         16  CF-EFFECTIVE-DATE-SELECT.
  5056             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5057             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5058
  5059         16  CF-EXCEPTION-LIST-IND          PIC X.
  5060             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5061
  5062         16  FILLER                         PIC X(318).
  5063
  5064****************************************************************
  5065*                  EXCEPTION REPORTING RECORD                  *
  5066****************************************************************
  5067
  5068     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5069         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5070             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5071
  5072         16  CF-COMBINED-LIFE-AH-OPT.
  5073             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5074             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5075             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5076             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5077
  5078         16  CF-LIFE-OPT.
  5079             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5080             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5081             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5082             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5083             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5084             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5085             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  98
* EL156.cbl
  5086             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5087             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5088             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5089
  5090         16  CF-AH-OPT.
  5091             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5092             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5093             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5094             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5095             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5096             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5097             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5098             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5099             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5100             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5101
  5102         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5103             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5104             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5105             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5106
  5107         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5108
  5109         16  FILLER                         PIC X(673).
  5110
  5111
  5112****************************************************************
  5113*             MORTGAGE SYSTEM PLAN RECORD                      *
  5114****************************************************************
  5115
  5116     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5117         16  CF-PLAN-TYPE                   PIC X.
  5118             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5119             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5120             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5121         16  CF-PLAN-ABBREV                 PIC XXX.
  5122         16  CF-PLAN-DESCRIPT               PIC X(10).
  5123         16  CF-PLAN-NOTES                  PIC X(20).
  5124         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5125         16  CF-PLAN-UNDERWRITING.
  5126             20  CF-PLAN-TERM-DATA.
  5127                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5128                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5129             20  CF-PLAN-AGE-DATA.
  5130                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5131                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5132                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5133             20  CF-PLAN-BENEFIT-DATA.
  5134                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5135                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5136                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5137                                            PIC S9(7)V99  COMP-3.
  5138         16  CF-PLAN-POLICY-FORMS.
  5139             20  CF-POLICY-FORM             PIC X(12).
  5140             20  CF-MASTER-APPLICATION      PIC X(12).
  5141             20  CF-MASTER-POLICY           PIC X(12).
  5142         16  CF-PLAN-RATING.
  5143             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page  99
* EL156.cbl
  5144             20  CF-SEX-RATING              PIC X.
  5145                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5146                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5147             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5148             20  CF-SUB-STD-TYPE            PIC X.
  5149                 88  CF-PCT-OF-PREM            VALUE '1'.
  5150                 88  CF-PCT-OF-BENE            VALUE '2'.
  5151         16  CF-PLAN-PREM-TOLERANCES.
  5152             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5153             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5154         16  CF-PLAN-PYMT-TOLERANCES.
  5155             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5156             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5157         16  CF-PLAN-MISC-DATA.
  5158             20  FILLER                     PIC X.
  5159             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5160             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5161         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5162         16  CF-PLAN-IND-GRP                PIC X.
  5163             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5164                                                     '1'.
  5165             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5166                                                     '2'.
  5167         16  CF-MIB-SEARCH-SW               PIC X.
  5168             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5169             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5170             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5171             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5172         16  CF-ALPHA-SEARCH-SW             PIC X.
  5173             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5174             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5175             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5176             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5177             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5178             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5179             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5180             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5181             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5182             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5183                                                     'A' 'B' 'C'
  5184                                                     'X' 'Y' 'Z'.
  5185         16  CF-EFF-DT-RULE-SW              PIC X.
  5186             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5187             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5188             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5189             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5190             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5191         16  FILLER                         PIC X(4).
  5192         16  CF-HEALTH-QUESTIONS            PIC X.
  5193             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5194         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5195         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5196         16  CF-PLAN-SNGL-JNT               PIC X.
  5197             88  CF-COMBINED-PLAN              VALUE 'C'.
  5198             88  CF-JNT-PLAN                   VALUE 'J'.
  5199             88  CF-SNGL-PLAN                  VALUE 'S'.
  5200         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5201         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 100
* EL156.cbl
  5202         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5203         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5204         16  CF-RERATE-CNTL                 PIC  X.
  5205             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5206             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5207             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5208             88  CF-AUTO-RECALC                 VALUE '4'.
  5209         16  CF-BENEFIT-TYPE                PIC  X.
  5210             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5211             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5212         16  CF-POLICY-FEE                  PIC S999V99
  5213                                                    COMP-3.
  5214         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5215         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5216         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5217         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5218         16  FILLER                         PIC  X(32).
  5219         16  CF-TERMINATION-FORM            PIC  X(04).
  5220         16  FILLER                         PIC  X(08).
  5221         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5222                                                       COMP-3.
  5223         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5224         16  CF-ISSUE-LETTER                PIC  X(4).
  5225         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5226         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5227             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5228             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5229         16  CF-MP-REFUND-CALC              PIC X.
  5230             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5231             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5232             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5233             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5234             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5235             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5236             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5237             88  CF-MP-REFD-MEAN                VALUE '8'.
  5238         16  CF-ALT-RATE-CODE               PIC  X(5).
  5239
  5240
  5241         16  FILLER                         PIC X(498).
  5242****************************************************************
  5243*             MORTGAGE COMPANY MASTER RECORD                   *
  5244****************************************************************
  5245
  5246     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5247         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5248         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5249             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5250             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5251             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5252             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5253             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5254
  5255         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5256         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5257         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5258         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5259         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 101
* EL156.cbl
  5260
  5261         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5262             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5263         16  CF-MP-RECON-USE-IND            PIC X(1).
  5264             88  CF-MP-USE-RECON             VALUE 'Y'.
  5265         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5266             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5267         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5268             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5269             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5270         16  FILLER                         PIC X(1).
  5271         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5272             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5273         16  CF-MORTG-MIB-VERSION           PIC X.
  5274             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5275             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5276             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5277         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5278             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5279                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5280             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5281                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5282             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5283                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5284             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5285                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5286             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5287                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5288             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5289                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5290         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5291         16  FILLER                         PIC X(7).
  5292         16  CF-MORTG-DESTINATION-SYMBOL.
  5293             20  CF-MORTG-MIB-COMM          PIC X(5).
  5294             20  CF-MORTG-MIB-TERM          PIC X(5).
  5295         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5296             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5297         16  FILLER                         PIC X(03).
  5298         16  CF-MP-CHECK-NO-CONTROL.
  5299             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5300                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5301                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5302                                                ' ' LOW-VALUES.
  5303                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5304                                               VALUE '3'.
  5305         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5306         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5307         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5308             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5309                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5310             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5311                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5312             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5313                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5314             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5315                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5316             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5317                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 102
* EL156.cbl
  5318             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5319                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5320         16  CF-MORTG-BILLING-AREA.
  5321             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5322                                            PIC X.
  5323         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5324         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5325         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5326         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5327             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5328             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5329         16  FILLER                         PIC X.
  5330         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5331             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5332             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5333         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5334         16  FILLER                         PIC X(8).
  5335         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5336         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5337         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5338         16  CF-ACH-COMPANY-ID.
  5339             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5340                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5341                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5342                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5343             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5344         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5345             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5346         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5347             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5348             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5349         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5350         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5351         16  FILLER                         PIC X(536).
  5352
  5353****************************************************************
  5354*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5355****************************************************************
  5356
  5357     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5358         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5359             20  CF-FEMALE-HEIGHT.
  5360                 24  CF-FEMALE-FT           PIC 99.
  5361                 24  CF-FEMALE-IN           PIC 99.
  5362             20  CF-FEMALE-MIN-WT           PIC 999.
  5363             20  CF-FEMALE-MAX-WT           PIC 999.
  5364         16  FILLER                         PIC X(428).
  5365
  5366     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5367         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5368             20  CF-MALE-HEIGHT.
  5369                 24  CF-MALE-FT             PIC 99.
  5370                 24  CF-MALE-IN             PIC 99.
  5371             20  CF-MALE-MIN-WT             PIC 999.
  5372             20  CF-MALE-MAX-WT             PIC 999.
  5373         16  FILLER                         PIC X(428).
  5374******************************************************************
  5375*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 103
* EL156.cbl
  5376******************************************************************
  5377     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5378         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5379             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5380             20  CF-SYS-LETTER-ID           PIC X(04).
  5381             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5382             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5383             20  CF-SYS-RESET-SW            PIC X(01).
  5384             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5385             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5386
  5387         16  FILLER                         PIC X(50).
  5388
  5389         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5390             20  CF-USER-ACTIVE-SW          PIC X(01).
  5391             20  CF-USER-LETTER-ID          PIC X(04).
  5392             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5393             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5394             20  CF-USER-RESET-SW           PIC X(01).
  5395             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5396             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5397             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5398
  5399         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 104
* EL156.cbl
  5401*    COPY ELCCERT.
  5402******************************************************************
  5403*                                                                *
  5404*                            ELCCERT.                            *
  5405*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5406*                            VMOD=2.013                          *
  5407*                                                                *
  5408*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5409*                                                                *
  5410*   FILE TYPE = VSAM,KSDS                                        *
  5411*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5412*                                                                *
  5413*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5414*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5415*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5416*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5417*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5418*                                                                *
  5419*   LOG = YES                                                    *
  5420*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5421******************************************************************
  5422*                   C H A N G E   L O G
  5423*
  5424* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5425*-----------------------------------------------------------------
  5426*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5427* EFFECTIVE    NUMBER
  5428*-----------------------------------------------------------------
  5429* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5430* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5431* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5432* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5433* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5434* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5435* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5436* 032612  CR2011110200001  PEMA  AHL CHANGES
  5437******************************************************************
  5438
  5439 01  CERTIFICATE-MASTER.
  5440     12  CM-RECORD-ID                      PIC XX.
  5441         88  VALID-CM-ID                      VALUE 'CM'.
  5442
  5443     12  CM-CONTROL-PRIMARY.
  5444         16  CM-COMPANY-CD                 PIC X.
  5445         16  CM-CARRIER                    PIC X.
  5446         16  CM-GROUPING.
  5447             20  CM-GROUPING-PREFIX        PIC X(3).
  5448             20  CM-GROUPING-PRIME         PIC X(3).
  5449         16  CM-STATE                      PIC XX.
  5450         16  CM-ACCOUNT.
  5451             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5452             20  CM-ACCOUNT-PRIME          PIC X(6).
  5453         16  CM-CERT-EFF-DT                PIC XX.
  5454         16  CM-CERT-NO.
  5455             20  CM-CERT-PRIME             PIC X(10).
  5456             20  CM-CERT-SFX               PIC X.
  5457
  5458     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 105
* EL156.cbl
  5459         16  CM-COMPANY-CD-A1              PIC X.
  5460         16  CM-INSURED-LAST-NAME          PIC X(15).
  5461         16  CM-INSURED-INITIALS.
  5462             20  CM-INSURED-INITIAL1       PIC X.
  5463             20  CM-INSURED-INITIAL2       PIC X.
  5464
  5465     12  CM-CONTROL-BY-SSN.
  5466         16  CM-COMPANY-CD-A2              PIC X.
  5467         16  CM-SOC-SEC-NO.
  5468             20  CM-SSN-STATE              PIC XX.
  5469             20  CM-SSN-ACCOUNT            PIC X(6).
  5470             20  CM-SSN-LN3.
  5471                 25  CM-INSURED-INITIALS-A2.
  5472                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5473                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5474                 25 CM-PART-LAST-NAME-A2         PIC X.
  5475
  5476     12  CM-CONTROL-BY-CERT-NO.
  5477         16  CM-COMPANY-CD-A4              PIC X.
  5478         16  CM-CERT-NO-A4                 PIC X(11).
  5479
  5480     12  CM-CONTROL-BY-MEMB.
  5481         16  CM-COMPANY-CD-A5              PIC X.
  5482         16  CM-MEMBER-NO.
  5483             20  CM-MEMB-STATE             PIC XX.
  5484             20  CM-MEMB-ACCOUNT           PIC X(6).
  5485             20  CM-MEMB-LN4.
  5486                 25  CM-INSURED-INITIALS-A5.
  5487                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5488                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5489                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5490
  5491     12  CM-INSURED-PROFILE-DATA.
  5492         16  CM-INSURED-FIRST-NAME.
  5493             20  CM-INSURED-1ST-INIT       PIC X.
  5494             20  FILLER                    PIC X(9).
  5495         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5496         16  CM-INSURED-SEX                PIC X.
  5497             88  CM-SEX-MALE                  VALUE 'M'.
  5498             88  CM-SEX-FEMAL                 VALUE 'F'.
  5499         16  CM-INSURED-JOINT-AGE          PIC 99.
  5500         16  CM-JOINT-INSURED-NAME.
  5501             20  CM-JT-LAST-NAME           PIC X(15).
  5502             20  CM-JT-FIRST-NAME.
  5503                 24  CM-JT-1ST-INIT        PIC X.
  5504                 24  FILLER                PIC X(9).
  5505             20  CM-JT-INITIAL             PIC X.
  5506
  5507     12  CM-LIFE-DATA.
  5508         16  CM-LF-BENEFIT-CD              PIC XX.
  5509         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5510         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5511         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5512         16  CM-LF-DEV-CODE                PIC XXX.
  5513         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5514         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5515         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5516         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 106
* EL156.cbl
  5517         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5518         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5519         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5520         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5521         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5522         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5523         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5524         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5525         16  FILLER                        PIC XX.
  5526
  5527     12  CM-AH-DATA.
  5528         16  CM-AH-BENEFIT-CD              PIC XX.
  5529         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5530         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5531         16  CM-AH-DEV-CODE                PIC XXX.
  5532         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5533         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5534         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5535         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5536         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5537         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5538         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5539         16  CM-AH-PAID-THRU-DT            PIC XX.
  5540             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5541         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5542         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5543         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5544         16  FILLER                        PIC X.
  5545
  5546     12  CM-LOAN-INFORMATION.
  5547         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5548         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5549                                           PIC S9(5)V99  COMP-3.
  5550         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5551         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5552         16  CM-PAY-FREQUENCY              PIC S99.
  5553         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5554         16  CM-RATE-CLASS                 PIC XX.
  5555         16  CM-BENEFICIARY                PIC X(25).
  5556         16  CM-POLICY-FORM-NO             PIC X(12).
  5557         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5558         16  CM-LAST-ADD-ON-DT             PIC XX.
  5559         16  CM-DEDUCTIBLE-AMOUNTS.
  5560             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5561             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5562         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5563             20  CM-RESIDENT-STATE         PIC XX.
  5564             20  CM-RATE-CODE              PIC X(4).
  5565             20  FILLER                    PIC XX.
  5566         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5567             20  CM-LOAN-OFFICER           PIC X(5).
  5568             20  FILLER                    PIC XXX.
  5569         16  CM-CSR-CODE                   PIC XXX.
  5570         16  CM-UNDERWRITING-CODE          PIC X.
  5571             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5572         16  CM-POST-CARD-IND              PIC X.
  5573         16  CM-NH-INTERFACE-SW            PIC X.
  5574         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 107
* EL156.cbl
  5575             88  CM-SING-PRM                  VALUE '1'.
  5576             88  CM-O-B-COVERAGE              VALUE '2'.
  5577             88  CM-OPEN-END                  VALUE '3'.
  5578         16  CM-IND-GRP-TYPE               PIC X.
  5579             88  CM-INDIVIDUAL                VALUE 'I'.
  5580             88  CM-GROUP                     VALUE 'G'.
  5581         16  CM-SKIP-CODE                  PIC X.
  5582             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5583             88  SKIP-JULY                    VALUE '1'.
  5584             88  SKIP-AUGUST                  VALUE '2'.
  5585             88  SKIP-SEPTEMBER               VALUE '3'.
  5586             88  SKIP-JULY-AUG                VALUE '4'.
  5587             88  SKIP-AUG-SEPT                VALUE '5'.
  5588             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5589             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5590             88  SKIP-JUNE                    VALUE '8'.
  5591             88  SKIP-JUNE-JULY               VALUE '9'.
  5592             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5593             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5594         16  CM-PAYMENT-MODE               PIC X.
  5595             88  PAY-MONTHLY                  VALUE SPACE.
  5596             88  PAY-WEEKLY                   VALUE '1'.
  5597             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5598             88  PAY-BI-WEEKLY                VALUE '3'.
  5599             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5600         16  CM-LOAN-NUMBER                PIC X(8).
  5601         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5602         16  CM-OLD-LOF                    PIC XXX.
  5603*        16  CM-LOAN-OFFICER               PIC XXX.
  5604         16  CM-REIN-TABLE                 PIC XXX.
  5605         16  CM-SPECIAL-REIN-CODE          PIC X.
  5606         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5607         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5608         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5609
  5610     12  CM-STATUS-DATA.
  5611         16  CM-ENTRY-STATUS               PIC X.
  5612         16  CM-ENTRY-DT                   PIC XX.
  5613
  5614         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5615         16  CM-LF-CANCEL-DT               PIC XX.
  5616         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5617
  5618         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5619         16  CM-LF-DEATH-DT                PIC XX.
  5620         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5621
  5622         16  CM-LF-CURRENT-STATUS          PIC X.
  5623             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5624                                                'M' '4' '5' '9'.
  5625             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5626             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5627             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5628             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5629             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5630             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5631             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5632             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 108
* EL156.cbl
  5633             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5634             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5635             88  CM-LF-DECLINED               VALUE 'D'.
  5636             88  CM-LF-VOIDED                 VALUE 'V'.
  5637
  5638         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5639         16  CM-AH-CANCEL-DT               PIC XX.
  5640         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5641
  5642         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5643         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5644         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5645
  5646         16  CM-AH-CURRENT-STATUS          PIC X.
  5647             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5648                                                'M' '4' '5' '9'.
  5649             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5650             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5651             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5652             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5653             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5654             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5655             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5656             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5657             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5658             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5659             88  CM-AH-DECLINED               VALUE 'D'.
  5660             88  CM-AH-VOIDED                 VALUE 'V'.
  5661
  5662         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5663             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5664             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5665             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5666         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5667
  5668         16  CM-ENTRY-BATCH                PIC X(6).
  5669         16  CM-LF-EXIT-BATCH              PIC X(6).
  5670         16  CM-AH-EXIT-BATCH              PIC X(6).
  5671         16  CM-LAST-MONTH-END             PIC XX.
  5672
  5673     12  CM-NOTE-SW                        PIC X.
  5674         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5675         88  CERT-NOTES-PRESENT               VALUE '1'.
  5676         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5677         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5678         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5679         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5680         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5681         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5682     12  CM-COMP-EXCP-SW                   PIC X.
  5683         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5684         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5685     12  CM-INSURED-ADDRESS-SW             PIC X.
  5686         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5687         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5688
  5689*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5690     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 109
* EL156.cbl
  5691     12  FILLER                            PIC X.
  5692
  5693*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5694     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5695     12  FILLER                            PIC X.
  5696*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5697     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5698
  5699     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5700         88  CERT-ADDED-BATCH                 VALUE ' '.
  5701         88  CERT-ADDED-ONLINE                VALUE '1'.
  5702         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5703         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5704         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5705     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5706         88  CERT-AS-LOADED                   VALUE ' '.
  5707         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5708         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5709         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5710         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5711         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5712         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5713         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5714
  5715     12  CM-ACCOUNT-COMM-PCTS.
  5716         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5717         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5718
  5719     12  CM-USER-FIELD                     PIC X.
  5720     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5721     12  CM-CLP-STATE                      PIC XX.
  5722     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5723     12  CM-USER-RESERVED                  PIC XXX.
  5724     12  FILLER REDEFINES CM-USER-RESERVED.
  5725         16  CM-AH-CLASS-CD                PIC XX.
  5726         16  F                             PIC X.
  5727******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 110
* EL156.cbl
  5729*    COPY ELCTRLR.
  5730******************************************************************
  5731*                                                                *
  5732*                            ELCTRLR.                            *
  5733*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5734*                            VMOD=2.014                          *
  5735*                                                                *
  5736*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5737*                                                                *
  5738*   FILE TYPE = VSAM,KSDS                                        *
  5739*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5740*                                                                *
  5741*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5742*       ALTERNATE INDEX = NONE                                   *
  5743*                                                                *
  5744*   LOG = YES                                                    *
  5745*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5746******************************************************************
  5747*                   C H A N G E   L O G
  5748*
  5749* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5750*-----------------------------------------------------------------
  5751*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5752* EFFECTIVE    NUMBER
  5753*-----------------------------------------------------------------
  5754* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5755* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5756* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5757* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5758* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5759* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5760* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5761* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5762* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5763* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5764* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5765* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5766* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5767******************************************************************
  5768 01  ACTIVITY-TRAILERS.
  5769     12  AT-RECORD-ID                    PIC XX.
  5770         88  VALID-AT-ID                       VALUE 'AT'.
  5771
  5772     12  AT-CONTROL-PRIMARY.
  5773         16  AT-COMPANY-CD               PIC X.
  5774         16  AT-CARRIER                  PIC X.
  5775         16  AT-CLAIM-NO                 PIC X(7).
  5776         16  AT-CERT-NO.
  5777             20  AT-CERT-PRIME           PIC X(10).
  5778             20  AT-CERT-SFX             PIC X.
  5779         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5780             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5781             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5782             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5783             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5784             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5785             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5786             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 111
* EL156.cbl
  5787             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5788             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5789             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5790             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5791             88  AT-BENEFICIARY-TRL           VALUE +91.
  5792             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5793             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5794
  5795     12  AT-TRAILER-TYPE                 PIC X.
  5796         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5797         88  PAYMENT-TR                       VALUE '2'.
  5798         88  AUTO-PAY-TR                      VALUE '3'.
  5799         88  CORRESPONDENCE-TR                VALUE '4'.
  5800         88  ADDRESS-TR                       VALUE '5'.
  5801         88  GENERAL-INFO-TR                  VALUE '6'.
  5802         88  AUTO-PROMPT-TR                   VALUE '7'.
  5803         88  DENIAL-TR                        VALUE '8'.
  5804         88  INCURRED-CHG-TR                  VALUE '9'.
  5805         88  FORM-CONTROL-TR                  VALUE 'A'.
  5806
  5807     12  AT-RECORDED-DT                  PIC XX.
  5808     12  AT-RECORDED-BY                  PIC X(4).
  5809     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5810
  5811     12  AT-TRAILER-BODY                 PIC X(165).
  5812
  5813     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5814         16  AT-RESERVE-CONTROLS.
  5815             20  AT-MANUAL-SW            PIC X.
  5816                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5817             20  AT-FUTURE-SW            PIC X.
  5818                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5819             20  AT-PTC-SW               PIC X.
  5820                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5821             20  AT-IBNR-SW              PIC X.
  5822                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5823             20  AT-PTC-LF-SW            PIC X.
  5824                 88  AT-LF-PTC-USED          VALUE '1'.
  5825             20  AT-CDT-ACCESS-METHOD    PIC X.
  5826                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5827                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5828                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5829             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5830         16  AT-LAST-COMPUTED-DT         PIC XX.
  5831         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5832         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5833         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5834         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5835         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5836         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5837         16  AT-EXPENSE-CONTROLS.
  5838             20  AT-EXPENSE-METHOD       PIC X.
  5839                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5840                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5841                 88  PERCENT-OF-PMT           VALUE '3'.
  5842                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5843             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5844             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 112
* EL156.cbl
  5845         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5846         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5847
  5848         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5849         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5850
  5851*        16  FILLER                      PIC X(53).
  5852         16  FILLER                      PIC X(47).
  5853
  5854         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5855         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5856
  5857         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5858             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5859             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5860*                    C = CLOSED
  5861*                    O = OPEN
  5862             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5863*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5864
  5865     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5866         16  AT-PAYMENT-TYPE             PIC X.
  5867             88  PARTIAL-PAYMENT                VALUE '1'.
  5868             88  FINAL-PAYMENT                  VALUE '2'.
  5869             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5870             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5871             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5872             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5873             88  VOIDED-PAYMENT                 VALUE '9'.
  5874             88  TRANSFER                       VALUE 'T'.
  5875             88  LIFE-INTEREST                  VALUE 'I'.
  5876
  5877         16  AT-CLAIM-TYPE               PIC X.
  5878             88  PAID-FOR-AH                    VALUE 'A'.
  5879             88  PAID-FOR-LIFE                  VALUE 'L'.
  5880             88  PAID-FOR-IUI                   VALUE 'I'.
  5881             88  PAID-FOR-GAP                   VALUE 'G'.
  5882         16  AT-CLAIM-PREM-TYPE          PIC X.
  5883             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5884             88  AT-O-B-COVERAGE                VALUE '2'.
  5885             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5886         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5887         16  AT-CHECK-NO                 PIC X(7).
  5888         16  AT-PAID-FROM-DT             PIC XX.
  5889         16  AT-PAID-THRU-DT             PIC XX.
  5890         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5891         16  FILLER                      PIC X.
  5892         16  AT-PAYEES-NAME              PIC X(30).
  5893         16  AT-PAYMENT-ORIGIN           PIC X.
  5894             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5895             88  ONLINE-AUTO-PMT                VALUE '2'.
  5896             88  OFFLINE-PMT                    VALUE '3'.
  5897         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5898         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5899         16  AT-VOID-DATA.
  5900             20  AT-VOID-DT              PIC XX.
  5901*00144       20  AT-VOID-REASON          PIC X(30).
  5902             20  AT-VOID-REASON          PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 113
* EL156.cbl
  5903         16  AT-PMT-APPROVED-BY          PIC X(04).
  5904         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5905         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5906         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5907                                         PIC S99V9(5)  COMP-3.
  5908         16  AT-CREDIT-INTERFACE.
  5909             20  AT-PMT-SELECT-DT        PIC XX.
  5910                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5911             20  AT-PMT-ACCEPT-DT        PIC XX.
  5912                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5913             20  AT-VOID-SELECT-DT       PIC XX.
  5914                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5915             20  AT-VOID-ACCEPT-DT       PIC XX.
  5916                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5917
  5918         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5919                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5920                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5921         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5922
  5923         16  AT-FORCE-CONTROL            PIC X.
  5924             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5925         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5926         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5927         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5928         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5929         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5930         16  AT-BENEFIT-TYPE             PIC X.
  5931
  5932         16  AT-EXPENSE-TYPE             PIC X.
  5933         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5934
  5935         16  AT-PAYEE-TYPE-CD.
  5936             20  AT-PAYEE-TYPE           PIC X.
  5937                 88  INSURED-PAID           VALUE 'I'.
  5938                 88  BENEFICIARY-PAID       VALUE 'B'.
  5939                 88  ACCOUNT-PAID           VALUE 'A'.
  5940                 88  OTHER-1-PAID           VALUE 'O'.
  5941                 88  OTHER-2-PAID           VALUE 'Q'.
  5942                 88  DOCTOR-PAID            VALUE 'P'.
  5943                 88  EMPLOYER-PAID          VALUE 'E'.
  5944             20  AT-PAYEE-SEQ            PIC X.
  5945
  5946         16  AT-CASH-PAYMENT             PIC X.
  5947         16  AT-GROUPED-PAYMENT          PIC X.
  5948         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5949         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5950         16  AT-APPROVED-LEVEL           PIC X.
  5951         16  AT-VOID-TYPE                PIC X.
  5952             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5953             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5954         16  AT-AIG-UNEMP-IND            PIC X.
  5955             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5956         16  AT-ASSOCIATES               PIC X.
  5957             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5958             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5959
  5960         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 114
* EL156.cbl
  5961         16  AT-CV-PMT-CODE              PIC X.
  5962             88  FULL-DEATH-PAYMENT         VALUE '1'.
  5963             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5964             88  FULL-ADD-PAYMENT           VALUE '3'.
  5965             88  HALF-ADD-PAYMENT           VALUE '4'.
  5966             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5967             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5968             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5969             88  ADDL-PAYMENT               VALUE '8'.
  5970
  5971         16  AT-EOB-CODE1                PIC XXX.
  5972         16  AT-EOB-CODE2                PIC XXX.
  5973         16  AT-EOB-CODE3                PIC XXX.
  5974         16  AT-EOB-CODE4                PIC XXX.
  5975         16  FILLER REDEFINES AT-EOB-CODE4.
  5976             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5977             20  FILLER                  PIC X.
  5978         16  AT-EOB-CODE5                PIC XXX.
  5979         16  FILLER REDEFINES AT-EOB-CODE5.
  5980             20  AT-PMT-PROOF-DT         PIC XX.
  5981             20  FILLER                  PIC X.
  5982
  5983         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5984             88  AT-PRINT-EOB            VALUE 'Y'.
  5985
  5986         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5987         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5988
  5989     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5990         16  AT-SCHEDULE-START-DT        PIC XX.
  5991         16  AT-SCHEDULE-END-DT          PIC XX.
  5992         16  AT-TERMINATED-DT            PIC XX.
  5993         16  AT-LAST-PMT-TYPE            PIC X.
  5994             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5995             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5996         16  AT-FIRST-PMT-DATA.
  5997             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5998             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  5999             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6000         16  AT-REGULAR-PMT-DATA.
  6001             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6002             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6003             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6004         16  AT-AUTO-PAYEE-CD.
  6005             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6006                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6007                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6008                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6009                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6010                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6011             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6012         16  AT-AUTO-PAY-DAY             PIC 99.
  6013         16  AT-AUTO-CASH                PIC X.
  6014             88  AT-CASH                      VALUE 'Y'.
  6015             88  AT-NON-CASH                  VALUE 'N'.
  6016*        16  FILLER                      PIC X(129).
  6017         16  AT-AUTO-END-LETTER          PIC X(4).
  6018         16  FILLER                      PIC X(125).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 115
* EL156.cbl
  6019
  6020         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6021         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6022
  6023     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6024         16  AT-LETTER-SENT-DT           PIC XX.
  6025         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6026         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6027         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6028         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6029         16  AT-LETTER-ORIGIN            PIC X.
  6030             88  ONLINE-CREATION              VALUE '1' '3'.
  6031             88  OFFLINE-CREATION             VALUE '2' '4'.
  6032             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6033             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6034         16  AT-STD-LETTER-FORM          PIC X(4).
  6035         16  AT-REASON-TEXT              PIC X(70).
  6036         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6037         16  AT-ADDRESEE-TYPE            PIC X.
  6038              88  INSURED-ADDRESEE            VALUE 'I'.
  6039              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6040              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6041              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6042              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6043              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6044              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6045         16  AT-ADDRESSEE-NAME           PIC X(30).
  6046         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6047         16  AT-RESEND-PRINT-DATE        PIC XX.
  6048         16  AT-CORR-SOL-UNSOL           PIC X.
  6049         16  AT-LETTER-PURGED-DT         PIC XX.
  6050*
  6051*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6052*
  6053         16  AT-CSO-REDEFINITION.
  6054             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6055             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6056             20  AT-LETTER-TO-BENE       PIC X(1).
  6057             20  AT-STOP-LETTER-DT       PIC X(2).
  6058             20  FILLER                  PIC X(19).
  6059*             20  FILLER                  PIC X(27).
  6060             20  AT-CSO-LETTER-STATUS    PIC X.
  6061                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6062                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6063                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6064             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6065             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6066*
  6067*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6068*
  6069*        16  FILLER                      PIC X(26).
  6070*
  6071*        16  AT-DMD-BSR-CODE             PIC X.
  6072*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6073*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6074*
  6075*        16  AT-DMD-LETTER-STATUS        PIC X.
  6076*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 116
* EL156.cbl
  6077*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6078*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6079*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6080*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6081
  6082         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6083         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6084
  6085     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6086         16  AT-ADDRESS-TYPE             PIC X.
  6087             88  INSURED-ADDRESS               VALUE 'I'.
  6088             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6089             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6090             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6091             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6092             88  OTHER-ADDRESS-1               VALUE 'O'.
  6093             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6094         16  AT-MAIL-TO-NAME             PIC X(30).
  6095         16  AT-ADDRESS-LINE-1           PIC X(30).
  6096         16  AT-ADDRESS-LINE-2           PIC X(30).
  6097         16  AT-CITY-STATE.
  6098             20  AT-CITY                 PIC X(28).
  6099             20  AT-STATE                PIC XX.
  6100         16  AT-ZIP.
  6101             20  AT-ZIP-CODE.
  6102                 24  AT-ZIP-1ST          PIC X.
  6103                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6104                 24  FILLER              PIC X(4).
  6105             20  AT-ZIP-PLUS4            PIC X(4).
  6106         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6107             20  AT-CAN-POSTAL-1         PIC XXX.
  6108             20  AT-CAN-POSTAL-2         PIC XXX.
  6109             20  FILLER                  PIC XXX.
  6110         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6111*         16  FILLER                      PIC X(23).
  6112         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6113         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6114         16  FILLER                      PIC X(13).
  6115         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6116         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6117
  6118     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6119         16  AT-INFO-LINE-1              PIC X(60).
  6120         16  AT-INFO-LINE-2              PIC X(60).
  6121         16  AT-INFO-TRAILER-TYPE        PIC X.
  6122             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6123             88  AT-CALL-NOTE            VALUE 'C'.
  6124             88  AT-MAINT-NOTE           VALUE 'M'.
  6125             88  AT-CERT-CHANGE          VALUE 'X'.
  6126             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6127             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6128         16  AT-CALL-TYPE                PIC X.
  6129             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6130             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6131         16  AT-NOTE-CONTINUATION        PIC X.
  6132             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6133         16  AT-EOB-CODES-EXIST          PIC X.
  6134             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 117
* EL156.cbl
  6135         16  FILLER                      PIC X(35).
  6136         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6137         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6138
  6139     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6140         16  AT-PROMPT-LINE-1            PIC X(60).
  6141         16  AT-PROMPT-LINE-2            PIC X(60).
  6142         16  AT-PROMPT-START-DT          PIC XX.
  6143         16  AT-PROMPT-END-DT            PIC XX.
  6144         16  FILLER                      PIC X(35).
  6145         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6146         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6147
  6148     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6149         16  AT-DENIAL-INFO-1            PIC X(60).
  6150         16  AT-DENIAL-INFO-2            PIC X(60).
  6151         16  AT-DENIAL-DT                PIC XX.
  6152         16  AT-RETRACTION-DT            PIC XX.
  6153         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6154*         16  FILLER                      PIC X(31).
  6155         16  AT-DENIAL-PROOF-DT          PIC XX.
  6156         16  FILLER                      PIC X(29).
  6157         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6158         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6159
  6160     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6161         16  AT-OLD-INCURRED-DT          PIC XX.
  6162         16  AT-OLD-REPORTED-DT          PIC XX.
  6163         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6164         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6165         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6166         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6167         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6168         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6169         16  FILLER                      PIC X(26).
  6170         16  AT-OLD-DIAG-CODE            PIC X(6).
  6171         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6172         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6173         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6174         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6175         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6176         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6177         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6178         16  FILLER                      PIC X(25).
  6179         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6180
  6181     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6182         16  AT-FORM-SEND-ON-DT          PIC XX.
  6183         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6184         16  AT-FORM-RE-SEND-DT          PIC XX.
  6185         16  AT-FORM-ANSWERED-DT         PIC XX.
  6186         16  AT-FORM-PRINTED-DT          PIC XX.
  6187         16  AT-FORM-REPRINT-DT          PIC XX.
  6188         16  AT-FORM-TYPE                PIC X.
  6189             88  INITIAL-FORM                  VALUE '1'.
  6190             88  PROGRESS-FORM                 VALUE '2'.
  6191         16  AT-INSTRUCT-LN-1            PIC X(28).
  6192         16  AT-INSTRUCT-LN-2            PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 118
* EL156.cbl
  6193         16  AT-INSTRUCT-LN-3            PIC X(28).
  6194         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6195         16  AT-FORM-ADDRESS             PIC X.
  6196             88  FORM-TO-INSURED              VALUE 'I'.
  6197             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6198             88  FORM-TO-OTHER-1              VALUE 'O'.
  6199             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6200         16  AT-RELATED-1.
  6201             20 AT-REL-CARR-1            PIC X.
  6202             20 AT-REL-CLAIM-1           PIC X(7).
  6203             20 AT-REL-CERT-1            PIC X(11).
  6204         16  AT-RELATED-2.
  6205             20 AT-REL-CARR-2            PIC X.
  6206             20 AT-REL-CLAIM-2           PIC X(7).
  6207             20 AT-REL-CERT-2            PIC X(11).
  6208         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6209         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6210         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6211         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6212         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6213         16  AT-STOP-FORM-DT             PIC X(2).
  6214
  6215         16  FILLER                      PIC X(09).
  6216         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6217         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6218******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 119
* EL156.cbl
  6220*    COPY ELCACTQ.
  6221******************************************************************
  6222*                                                                *
  6223*                            ELCACTQ.                            *
  6224*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6225*                            VMOD=2.004                          *
  6226*                                                                *
  6227*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6228*                                                                *
  6229*   FILE TYPE = VSAM,KSDS                                        *
  6230*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6231*                                                                *
  6232*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6233*       ALTERNATE INDEX = NONE                                   *
  6234*                                                                *
  6235*   LOG = YES                                                    *
  6236*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6237*                                                                *
  6238*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6239******************************************************************
  6240
  6241 01  ACTIVITY-QUE.
  6242     12  AQ-RECORD-ID                PIC XX.
  6243         88  VALID-AQ-ID                VALUE 'AQ'.
  6244
  6245     12  AQ-CONTROL-PRIMARY.
  6246         16  AQ-COMPANY-CD           PIC X.
  6247         16  AQ-CARRIER              PIC X.
  6248         16  AQ-CLAIM-NO             PIC X(7).
  6249         16  AQ-CERT-NO.
  6250             20  AQ-CERT-PRIME       PIC X(10).
  6251             20  AQ-CERT-SFX         PIC X.
  6252
  6253     12  AQ-PENDING-ACTIVITY-FLAGS.
  6254         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6255         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6256             88  PENDING-PAYMENTS       VALUE '1'.
  6257         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6258             88  PENDING-FULL-PRINT     VALUE '1'.
  6259             88  PENDING-PART-PRINT     VALUE '2'.
  6260         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6261             88  PENDING-LETTERS        VALUE '1'.
  6262         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6263             88  PENDING-RESTORE        VALUE 'C'.
  6264             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6265
  6266     12  FILLER                      PIC X(20).
  6267
  6268     12  AQ-RESEND-DATE              PIC XX.
  6269     12  AQ-FOLLOWUP-DATE            PIC XX.
  6270     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6271     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6272     12  AQ-AUTO-LETTER              PIC X(4).
  6273     12  FILLER                      PIC XX.
  6274     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6275*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 120
* EL156.cbl
  6277*    COPY ERCACCT.
  6278******************************************************************
  6279*                                                                *
  6280*                                                                *
  6281*                            ERCACCT                             *
  6282*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6283*                            VMOD=2.031                          *
  6284*                                                                *
  6285*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6286*                                                                *
  6287*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6288*   VSAM ACCOUNT MASTER FILES.                                   *
  6289*                                                                *
  6290*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6291*                                                                *
  6292*   FILE TYPE = VSAM,KSDS                                        *
  6293*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6294*                                                                *
  6295*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6296*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6297*                                                                *
  6298*   LOG = NO                                                     *
  6299*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6300*                                                                *
  6301*                                                                *
  6302******************************************************************
  6303*                   C H A N G E   L O G
  6304*
  6305* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6306*-----------------------------------------------------------------
  6307*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6308* EFFECTIVE    NUMBER
  6309*-----------------------------------------------------------------
  6310* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6311* 092705    2005050300006  PEMA  ADD SPP LEASES
  6312* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6313* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6314* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6315* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6316* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6317******************************************************************
  6318
  6319 01  ACCOUNT-MASTER.
  6320     12  AM-RECORD-ID                      PIC XX.
  6321         88  VALID-AM-ID                      VALUE 'AM'.
  6322
  6323     12  AM-CONTROL-PRIMARY.
  6324         16  AM-COMPANY-CD                 PIC X.
  6325         16  AM-MSTR-CNTRL.
  6326             20  AM-CONTROL-A.
  6327                 24  AM-CARRIER            PIC X.
  6328                 24  AM-GROUPING.
  6329                     28 AM-GROUPING-PREFIX PIC XXX.
  6330                     28 AM-GROUPING-PRIME  PIC XXX.
  6331                 24  AM-STATE              PIC XX.
  6332                 24  AM-ACCOUNT.
  6333                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6334                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 121
* EL156.cbl
  6335             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6336                                           PIC X(19).
  6337             20  AM-CNTRL-B.
  6338                 24  AM-EXPIRATION-DT      PIC XX.
  6339                 24  FILLER                PIC X(4).
  6340             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6341                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6342
  6343     12  AM-CONTROL-BY-VAR-GRP.
  6344         16  AM-COMPANY-CD-A1              PIC X.
  6345         16  AM-VG-CARRIER                 PIC X.
  6346         16  AM-VG-GROUPING                PIC X(6).
  6347         16  AM-VG-STATE                   PIC XX.
  6348         16  AM-VG-ACCOUNT                 PIC X(10).
  6349         16  AM-VG-DATE.
  6350             20  AM-VG-EXPIRATION-DT       PIC XX.
  6351             20  FILLER                    PIC X(4).
  6352         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6353                                           PIC 9(11)      COMP-3.
  6354     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6355         16  FILLER                        PIC X(10).
  6356         16  AM-VG-KEY3.
  6357             20  AM-VG3-ACCOUNT            PIC X(10).
  6358             20  AM-VG3-EXP-DT             PIC XX.
  6359         16  FILLER                        PIC X(4).
  6360     12  AM-MAINT-INFORMATION.
  6361         16  AM-LAST-MAINT-DT              PIC XX.
  6362         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6363         16  AM-LAST-MAINT-USER            PIC X(4).
  6364         16  FILLER                        PIC XX.
  6365
  6366     12  AM-EFFECTIVE-DT                   PIC XX.
  6367     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6368
  6369     12  AM-PREV-DATES  COMP-3.
  6370         16  AM-PREV-EXP-DT                PIC 9(11).
  6371         16  AM-PREV-EFF-DT                PIC 9(11).
  6372
  6373     12  AM-REPORT-CODE-1                  PIC X(10).
  6374     12  AM-REPORT-CODE-2                  PIC X(10).
  6375
  6376     12  AM-CITY-CODE                      PIC X(4).
  6377     12  AM-COUNTY-PARISH                  PIC X(6).
  6378
  6379     12  AM-NAME                           PIC X(30).
  6380     12  AM-PERSON                         PIC X(30).
  6381     12  AM-ADDRS                          PIC X(30).
  6382     12  AM-CITY.
  6383         16  AM-ADDR-CITY                  PIC X(28).
  6384         16  AM-ADDR-STATE                 PIC XX.
  6385     12  AM-ZIP.
  6386         16  AM-ZIP-PRIME.
  6387             20  AM-ZIP-PRI-1ST            PIC X.
  6388                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6389             20  FILLER                    PIC X(4).
  6390         16  AM-ZIP-PLUS4                  PIC X(4).
  6391     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6392         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 122
* EL156.cbl
  6393         16  AM-CAN-POSTAL-2               PIC XXX.
  6394         16  FILLER                        PIC XXX.
  6395     12  AM-TEL-NO.
  6396         16  AM-AREA-CODE                  PIC 999.
  6397         16  AM-TEL-PRE                    PIC 999.
  6398         16  AM-TEL-NBR                    PIC 9(4).
  6399     12  AM-TEL-LOC                        PIC X.
  6400         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6401         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6402
  6403     12  AM-COMM-STRUCTURE.
  6404         16  AM-DEFN-1.
  6405             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6406                 24  AM-AGT.
  6407                     28  AM-AGT-PREFIX     PIC X(4).
  6408                     28  AM-AGT-PRIME      PIC X(6).
  6409                 24  AM-COM-TYP            PIC X.
  6410                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6411                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6412                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6413                 24  AM-RECALC-LV-INDIC    PIC X.
  6414                 24  AM-RETRO-LV-INDIC     PIC X.
  6415                 24  AM-GL-CODES           PIC X.
  6416                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6417                 24  FILLER                PIC X(01).
  6418         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6419             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6420                 24  FILLER                PIC X(11).
  6421                 24  AM-L-COMA             PIC XXX.
  6422                 24  AM-J-COMA             PIC XXX.
  6423                 24  AM-A-COMA             PIC XXX.
  6424                 24  FILLER                PIC X(6).
  6425
  6426     12  AM-COMM-CHANGE-STATUS             PIC X.
  6427         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6428
  6429     12  AM-CSR-CODE                       PIC X(4).
  6430
  6431     12  AM-BILLING-STATUS                 PIC X.
  6432         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6433         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6434     12  AM-AUTO-REFUND-SW                 PIC X.
  6435         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6436         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6437     12  AM-GPCD                           PIC 99.
  6438     12  AM-IG                             PIC X.
  6439         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6440         88  AM-HAS-GROUP                     VALUE '2'.
  6441     12  AM-STATUS                         PIC X.
  6442         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6443         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6444         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6445         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6446         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6447         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6448     12  AM-REMIT-TO                       PIC 99.
  6449     12  AM-ID-NO                          PIC X(11).
  6450
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 123
* EL156.cbl
  6451     12  AM-CAL-TABLE                      PIC XX.
  6452     12  AM-LF-DEVIATION                   PIC XXX.
  6453     12  AM-AH-DEVIATION                   PIC XXX.
  6454     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6455     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6456     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6457     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6458     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6459     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6460
  6461     12  AM-USER-FIELDS.
  6462         16  AM-FLD-1                      PIC XX.
  6463         16  AM-FLD-2                      PIC XX.
  6464         16  AM-FLD-3                      PIC XX.
  6465         16  AM-FLD-4                      PIC XX.
  6466         16  AM-FLD-5                      PIC XX.
  6467
  6468     12  AM-1ST-PROD-DATE.
  6469         16  AM-1ST-PROD-YR                PIC XX.
  6470         16  AM-1ST-PROD-MO                PIC XX.
  6471         16  AM-1ST-PROD-DA                PIC XX.
  6472     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6473     12  AM-CERTS-PURGED-DATE.
  6474         16  AM-PUR-YR                     PIC XX.
  6475         16  AM-PUR-MO                     PIC XX.
  6476         16  AM-PUR-DA                     PIC XX.
  6477     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6478     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6479     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6480     12  AM-INACTIVE-DATE.
  6481         16  AM-INA-MO                     PIC 99.
  6482         16  AM-INA-DA                     PIC 99.
  6483         16  AM-INA-YR                     PIC 99.
  6484     12  AM-AR-HI-CERT-DATE                PIC XX.
  6485
  6486     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6487     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6488
  6489     12  AM-OB-PAYMENT-MODE                PIC X.
  6490         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6491         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6492         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6493         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6494
  6495     12  AM-AH-ONLY-INDICATOR              PIC X.
  6496         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6497         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6498
  6499     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6500
  6501     12  AM-OVER-SHORT.
  6502         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6503         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6504
  6505     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6506     12  AM-DCC-CLP-STATE                  PIC XX.
  6507
  6508     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 124
* EL156.cbl
  6509     12  AM-RECALC-REIN                    PIC X.
  6510
  6511     12  AM-REI-TABLE                      PIC XXX.
  6512     12  AM-REI-ET-LF                      PIC X.
  6513     12  AM-REI-ET-AH                      PIC X.
  6514     12  AM-REI-PE-LF                      PIC X.
  6515     12  AM-REI-PE-AH                      PIC X.
  6516     12  AM-REI-PRT-ST                     PIC X.
  6517     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6518     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6519     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6520     12  AM-REI-GROUP-A                    PIC X(6).
  6521     12  AM-REI-MORT                       PIC X(4).
  6522     12  AM-REI-PRT-OW                     PIC X.
  6523     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6524     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6525     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6526     12  AM-REI-GROUP-B                    PIC X(6).
  6527
  6528     12  AM-TRUST-TYPE                     PIC X(2).
  6529
  6530     12  AM-EMPLOYER-STMT-USED             PIC X.
  6531     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6532
  6533     12  AM-STD-AH-TYPE                    PIC XX.
  6534     12  AM-EARN-METHODS.
  6535         16  AM-EARN-METHOD-R              PIC X.
  6536             88 AM-REF-RL-R78                 VALUE 'R'.
  6537             88 AM-REF-RL-PR                  VALUE 'P'.
  6538             88 AM-REF-RL-MEAN                VALUE 'M'.
  6539             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6540         16  AM-EARN-METHOD-L              PIC X.
  6541             88 AM-REF-LL-R78                 VALUE 'R'.
  6542             88 AM-REF-LL-PR                  VALUE 'P'.
  6543             88 AM-REF-LL-MEAN                VALUE 'M'.
  6544             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6545         16  AM-EARN-METHOD-A              PIC X.
  6546             88 AM-REF-AH-R78                 VALUE 'R'.
  6547             88 AM-REF-AH-PR                  VALUE 'P'.
  6548             88 AM-REF-AH-MEAN                VALUE 'M'.
  6549             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6550             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6551             88 AM-REF-AH-NET                 VALUE 'N'.
  6552
  6553     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6554     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6555     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6556
  6557     12  AM-RET-Y-N                        PIC X.
  6558     12  AM-RET-P-E                        PIC X.
  6559     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6560     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6561     12  AM-RET-GRP                        PIC X(6).
  6562     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6563         16  AM-POOL-PRIME                 PIC XXX.
  6564         16  AM-POOL-SUB                   PIC XXX.
  6565     12  AM-RETRO-EARNINGS.
  6566         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 125
* EL156.cbl
  6567         16  AM-RET-EARN-L                 PIC X.
  6568         16  AM-RET-EARN-A                 PIC X.
  6569     12  AM-RET-ST-TAX-USE                 PIC X.
  6570         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6571         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6572     12  AM-RETRO-BEG-EARNINGS.
  6573         16  AM-RET-BEG-EARN-R             PIC X.
  6574         16  AM-RET-BEG-EARN-L             PIC X.
  6575         16  AM-RET-BEG-EARN-A             PIC X.
  6576     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6577     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6578
  6579     12  AM-USER-SELECT-OPTIONS.
  6580         16  AM-USER-SELECT-1              PIC X(10).
  6581         16  AM-USER-SELECT-2              PIC X(10).
  6582         16  AM-USER-SELECT-3              PIC X(10).
  6583         16  AM-USER-SELECT-4              PIC X(10).
  6584         16  AM-USER-SELECT-5              PIC X(10).
  6585
  6586     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6587
  6588     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6589
  6590     12  AM-RPT045A-SWITCH                 PIC X.
  6591         88  RPT045A-OFF                   VALUE 'N'.
  6592
  6593     12  AM-INSURANCE-LIMITS.
  6594         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6595         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6596
  6597     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6598         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6599
  6600     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6601         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6602         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6603
  6604     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6605
  6606     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6607     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6608     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6609     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6610     12  AM-DCC-UEF-STATE                  PIC XX.
  6611     12  FILLER                            PIC XXX.
  6612     12  AM-REPORT-CODE-3                  PIC X(10).
  6613*    12  FILLER                            PIC X(22).
  6614
  6615     12  AM-RESERVE-DATE.
  6616         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6617         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6618         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6619
  6620     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6621     12  AM-NOTIFICATION-TYPES.
  6622         16  AM-NOTIF-OF-LETTERS           PIC X.
  6623         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6624         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 126
* EL156.cbl
  6625         16  AM-NOTIF-OF-STATUS            PIC X.
  6626
  6627     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6628         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6629         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6630         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6631         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6632
  6633     12  AM-BENEFIT-CONTROLS.
  6634         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6635             20  AM-BENEFIT-CODE           PIC XX.
  6636             20  AM-BENEFIT-TYPE           PIC X.
  6637             20  AM-BENEFIT-REVISION       PIC XXX.
  6638             20  AM-BENEFIT-REM-TERM       PIC X.
  6639             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6640             20  FILLER                    PIC XX.
  6641         16  FILLER                        PIC X(80).
  6642
  6643     12  AM-TRANSFER-DATA.
  6644         16  AM-TRANSFERRED-FROM.
  6645             20  AM-TRNFROM-CARRIER        PIC X.
  6646             20  AM-TRNFROM-GROUPING.
  6647                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6648                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6649             20  AM-TRNFROM-STATE          PIC XX.
  6650             20  AM-TRNFROM-ACCOUNT.
  6651                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6652                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6653             20  AM-TRNFROM-DTE            PIC XX.
  6654         16  AM-TRANSFERRED-TO.
  6655             20  AM-TRNTO-CARRIER          PIC X.
  6656             20  AM-TRNTO-GROUPING.
  6657                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6658                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6659             20  AM-TRNTO-STATE            PIC XX.
  6660             20  AM-TRNTO-ACCOUNT.
  6661                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6662                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6663             20  AM-TRNTO-DTE              PIC XX.
  6664         16  FILLER                        PIC X(10).
  6665
  6666     12  AM-SAVED-REMIT-TO                 PIC 99.
  6667
  6668     12  AM-COMM-STRUCTURE-SAVED.
  6669         16  AM-DEFN-1-SAVED.
  6670             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6671                 24  AM-AGT-SV             PIC X(10).
  6672                 24  AM-COM-TYP-SV         PIC X.
  6673                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6674                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6675                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6676                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6677                 24  FILLER                PIC X.
  6678                 24  AM-GL-CODES-SV        PIC X.
  6679                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6680                 24  FILLER                PIC X.
  6681         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6682             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 127
* EL156.cbl
  6683                 24  FILLER                PIC X(11).
  6684                 24  AM-L-COMA-SV          PIC XXX.
  6685                 24  AM-J-COMA-SV          PIC XXX.
  6686                 24  AM-A-COMA-SV          PIC XXX.
  6687                 24  FILLER                PIC X(6).
  6688
  6689     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6690         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6691            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6692            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6693            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6694
  6695     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6696     12  FILLER                            PIC X(120).
  6697
  6698     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6699         16  AM-CONTROL-NAME               PIC X(30).
  6700         16  AM-EXECUTIVE-ONE.
  6701             20  AM-EXEC1-NAME             PIC X(15).
  6702             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6703                                                          COMP-3.
  6704             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6705                                                          COMP-3.
  6706         16  AM-EXECUTIVE-TWO.
  6707             20  AM-EXEC2-NAME             PIC X(15).
  6708             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6709                                                          COMP-3.
  6710             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6711                                                          COMP-3.
  6712
  6713     12  AM-RETRO-ADDITIONAL-DATA.
  6714         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6715         16  AM-RETRO-PREM-P-E             PIC X.
  6716         16  AM-RETRO-CLMS-P-I             PIC X.
  6717         16  AM-RETRO-RET-BRACKET-LF.
  6718             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6719                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6720                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6721             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6722                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6723                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6724             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6725                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6726                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6727         16  AM-RETRO-RET-BRACKET-AH.
  6728             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6729                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6730                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6731                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6732             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6733                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6734                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6735             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6736                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6737                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6738
  6739     12  AM-COMMENTS.
  6740         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 128
* EL156.cbl
  6741
  6742     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6743         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6744         16  AM-FLI-BILLING-CODE           PIC X.
  6745         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6746         16  AM-FLI-UNITED-IDENT           PIC X.
  6747         16  AM-FLI-INTEREST-LOST-DATA.
  6748             20  AM-FLI-BANK-NO            PIC X(5).
  6749             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6750             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6751             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6752         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6753             20  AM-FLI-AGT                PIC X(9).
  6754             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6755             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6756         16  FILLER                        PIC X(102).
  6757
  6758     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6759         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6760             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6761             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6762             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6763             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6764             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6765         16  FILLER                          PIC X(10).
  6766******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 129
* EL156.cbl
  6768*    COPY ELCCHKQ.
  6769******************************************************************
  6770*                                                                *
  6771*                                                                *
  6772*                            ELCCHKQ.                            *
  6773*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6774*                            VMOD=2.007                          *
  6775*                                                                *
  6776*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6777*                                                                *
  6778*   FILE TYPE = VSAM,KSDS                                        *
  6779*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6780*                                                                *
  6781*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6782*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6783*                                                                *
  6784*   LOG = YES                                                    *
  6785*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6786******************************************************************
  6787 01  CHECK-QUE.
  6788     12  CQ-RECORD-ID                PIC XX.
  6789         88  VALID-CQ-ID         VALUE 'CQ'.
  6790
  6791     12  CQ-CONTROL-PRIMARY.
  6792         16  CQ-COMPANY-CD           PIC X.
  6793         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6794         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6795
  6796     12  CQ-CONTROL-BY-PAYEE.
  6797         16  CQ-CONTROL-BY-NUMBER.
  6798             20  CQ-COMPANY-CD-A1     PIC X.
  6799             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6800         16  CQ-PAYEE-CARRIER        PIC X.
  6801         16  CQ-PAYEE-GROUPING       PIC X(6).
  6802         16  CQ-PAYEE-STATE          PIC XX.
  6803         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6804         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6805
  6806     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6807         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6808         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6809         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6810         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6811         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6812         16  FILLER                  PIC X(3).
  6813
  6814     12  CQ-ENTRY-TYPE               PIC X.
  6815             88  CHECK-ON-QUE           VALUE 'Q'.
  6816             88  ALIGNMENT-CHECK        VALUE 'A'.
  6817             88  SPOILED-CHECK          VALUE 'S'.
  6818             88  PAYMENT-ABORTED        VALUE 'X'.
  6819
  6820     12  CQ-CLAIM-MAST-CNTL.
  6821         16  CQ-CARRIER              PIC X.
  6822         16  CQ-CLAIM-NO             PIC X(7).
  6823         16  CQ-CERT-NO.
  6824             20  CQ-CERT-PRIME       PIC X(10).
  6825             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 130
* EL156.cbl
  6826         16  CQ-CLAIM-TYPE           PIC X.
  6827             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6828             88  CQ-AH-CLAIM            VALUE 'A'.
  6829         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6830             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6831             88  CQ-O-B-COVERAGE        VALUE '2'.
  6832             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6833
  6834     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6835     12  CQ-CHECK-NUMBER             PIC X(7).
  6836     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6837     12  CQ-PAYMENT-TYPE             PIC X.
  6838             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6839             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6840             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6841             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6842             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6843             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6844             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6845             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6846     12  CQ-VOID-INDICATOR           PIC X.
  6847             88  CHECK-IS-STOPPED          VALUE 'S'.
  6848             88  CHECK-IS-VOID             VALUE 'V'.
  6849     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6850     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6851     12  CQ-CHECK-BY-USER            PIC X(4).
  6852     12  CQ-PRE-NUMBERING-SW         PIC X.
  6853       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6854       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6855
  6856     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6857     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6858     12  CQ-LEDGER-FLAG              PIC X(01).
  6859     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6860     12  CQ-LAST-UPDATED-DT          PIC XX.
  6861     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6862     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6863
  6864     12  FILLER                      PIC X(04).
  6865
  6866******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 131
* EL156.cbl
  6868*    COPY ELCBENE.
  6869******************************************************************
  6870*                                                                *
  6871*                            ELCBENE.                            *
  6872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6873*                            VMOD=2.006                          *
  6874*                                                                *
  6875*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6876*                                                                *
  6877*   FILE TYPE = VSAM,KSDS                                        *
  6878*   RECORD SIZE = 500   RECFORM = FIX                            *
  6879*                                                                *
  6880*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6881*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6882*                                                                *
  6883*   LOG = YES                                                    *
  6884*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6885*                                                                *
  6886*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6887******************************************************************
  6888
  6889 01  BENEFICIARY-MASTER.
  6890     12  BE-RECORD-ID                PIC XX.
  6891         88  VALID-BE-ID                VALUE 'BE'.
  6892
  6893     12  BE-CONTROL-PRIMARY.
  6894         16  BE-COMPANY-CD           PIC X.
  6895         16  BE-RECORD-TYPE          PIC X.
  6896             88  BENEFICIARY-RECORD  VALUE 'B'.
  6897             88  ADJUSTOR-RECORD     VALUE 'A'.
  6898         16  BE-BENEFICIARY          PIC X(10).
  6899     12  BE-CONTROL-BY-NAME.
  6900         16  BE-COMPANY-CD-A1        PIC X.
  6901         16  BE-RECORD-TYPE-A1       PIC X.
  6902         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6903         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6904
  6905     12  BE-LAST-MAINT-DT            PIC XX.
  6906     12  BE-LAST-MAINT-BY            PIC X(4).
  6907     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6908
  6909     12  BE-ADDRESS-DATA.
  6910         16  BE-MAIL-TO-NAME         PIC X(30).
  6911         16  BE-ADDRESS-LINE-1       PIC X(30).
  6912         16  BE-ADDRESS-LINE-2       PIC X(30).
  6913         16  BE-ADDRESS-LINE-3       PIC X(30).
  6914         16  BE-CITY-STATE.
  6915             20  BE-CITY             PIC X(28).
  6916             20  BE-STATE            PIC XX.
  6917         16  BE-ZIP-CODE.
  6918             20  BE-ZIP-PRIME.
  6919                 24  BE-ZIP-1ST      PIC X.
  6920                     88  BE-CANADIAN-POST-CODE
  6921                                         VALUE 'A' THRU 'Z'.
  6922                 24  FILLER          PIC X(4).
  6923             20  BE-ZIP-PLUS4        PIC X(4).
  6924         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6925             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 132
* EL156.cbl
  6926             20  BE-CAN-POSTAL-2     PIC XXX.
  6927             20  FILLER              PIC XXX.
  6928         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6929         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6930
  6931******************************************************************
  6932*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6933*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6934******************************************************************
  6935     12  BE-CARRIER                  PIC X.
  6936
  6937     12  BE-ADDRESS-DATA2.
  6938         16  BE-MAIL-TO-NAME2        PIC X(30).
  6939         16  BE-ADDRESS-LINE-12      PIC X(30).
  6940         16  BE-ADDRESS-LINE-22      PIC X(30).
  6941         16  BE-ADDRESS-LINE-32      PIC X(30).
  6942         16  BE-CITY-STATE2.
  6943             20  BE-CITY2            PIC X(28).
  6944             20  BE-STATE2           PIC XX.
  6945         16  BE-ZIP-CODE2.
  6946             20  BE-ZIP-PRIME2.
  6947                 24  BE-ZIP-1ST2     PIC X.
  6948                     88  BE-CANADIAN-POST-CODE2
  6949                                         VALUE 'A' THRU 'Z'.
  6950                 24  FILLER          PIC X(4).
  6951             20  BE-ZIP-PLUS42       PIC X(4).
  6952         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6953             20  BE-CAN-POSTAL-12    PIC XXX.
  6954             20  BE-CAN-POSTAL-22    PIC XXX.
  6955             20  FILLER              PIC XXX.
  6956         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6957         16  BE-BILLING-STMT-DATA.
  6958             20  BE-BSR              PIC X.
  6959                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6960                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6961             20  BE-BSR-FROM         PIC X(30).
  6962             20  BE-BSR-DEPT         PIC X(30).
  6963             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6964             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6965             20  BE-OUTPUT-TYPE      PIC X.
  6966                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6967                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6968
  6969     12  FILLER                      PIC X(28).
  6970******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 133
* EL156.cbl
  6972*    COPY ELCARCH.
  6973******************************************************************
  6974*                                                                *
  6975*                            ELCARCH.                            *
  6976*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6977*                            VMOD=2.007                          *
  6978*                                                                *
  6979*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6980*                                                                *
  6981*   FILE TYPE = VSAM,KSDS                                        *
  6982*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6983*                                                                *
  6984*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6985*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6986*                                                                *
  6987*   LOG = NO                                                     *
  6988*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6989*                                                                *
  6990*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6991******************************************************************
  6992 01  LETTER-ARCHIVE.
  6993     12  LA-RECORD-ID                PIC XX.
  6994         88  VALID-LA-ID                VALUE 'LA'.
  6995
  6996     12  LA-CONTROL-PRIMARY.
  6997         16  LA-COMPANY-CD           PIC X.
  6998         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6999         16  LA-RECORD-TYPE          PIC X.
  7000             88  LA-HEADER-DATA         VALUE '1'.
  7001             88  LA-ADDRESS-DATA        VALUE '2'.
  7002             88  LA-TEXT-DATA           VALUE '3'.
  7003             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7004         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7005
  7006     12  LA-CONTROL-BY-TYPE.
  7007         16  LA-COMPANY-CD-A1        PIC X.
  7008         16  LA-RECORD-TYPE-A1       PIC X.
  7009         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7010         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7011
  7012     12  LA-TEXT-RECORD.
  7013         16  LA-SKIP-CONTROL         PIC XX.
  7014             88  NO-LINES-SKIPPED       VALUE SPACES.
  7015             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7016         16  LA-TEXT-LINE            PIC X(70).
  7017
  7018     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7019         16  FILLER                  PIC XX.
  7020         16  LA-ADDRESS-LINE         PIC X(30).
  7021         16  FILLER                  PIC X(40).
  7022
  7023     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7024         16  FILLER                  PIC XX.
  7025         16  LA-CARRIER              PIC X.
  7026         16  LA-CLAIM-NO             PIC X(7).
  7027         16  LA-CERT-NO.
  7028             20  LA-CERT-PRIME       PIC X(10).
  7029             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 134
* EL156.cbl
  7030         16  LA-NO-OF-COPIES         PIC S9.
  7031         16  LA-RESEND-DATE          PIC XX.
  7032         16  LA-PROCESSOR-CD         PIC X(4).
  7033         16  LA-CREATION-DT          PIC XX.
  7034         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7035         16  LA-RESEND-PRINT-DATE    PIC XX.
  7036         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7037         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7038*
  7039* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7040*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7041*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7042*   I        20  LA-DMD-RES-ST           PIC XX.
  7043*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7044*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7045*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7046*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7047*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7048*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7049*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7050*   I        20  LA-DMD-UND-CODE         PIC XX.
  7051*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7052*   V    16  FILLER                  PIC X(15).
  7053* -----
  7054*
  7055* REINSERTED  CSO  MODS
  7056*
  7057         16  FILLER.
  7058             20  FILLER                  PIC X(29).
  7059             20  LA-CSO-LETTER-STATUS    PIC X.
  7060                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7061                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7062                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7063             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7064             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7065*
  7066
  7067     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7068         16  FILLER                  PIC XX.
  7069         16  LA4-CARRIER             PIC X.
  7070         16  LA4-CLAIM-NO            PIC X(7).
  7071         16  LA4-CERT-NO.
  7072             20  LA4-CERT-PRIME      PIC X(10).
  7073             20  LA4-CERT-SFX        PIC X.
  7074         16  LA4-NO-OF-COPIES        PIC S9.
  7075         16  LA4-RESEND-DATE         PIC XX.
  7076         16  LA4-PROCESSOR-CD        PIC X(4).
  7077         16  LA4-CREATION-DT         PIC XX.
  7078         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7079         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7080         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7081         16  LA4-FORM-TYPE           PIC X.
  7082             88  LA4-INITIAL-FORM    VALUE '1'.
  7083             88  LA4-PROGRESS-FORM   VALUE '2'.
  7084         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7085         16  LA4-STATE               PIC X(02).
  7086         16  FILLER                  PIC X(31).
  7087******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 135
* EL156.cbl
  7089*    COPY ELCDAR.
  7090******************************************************************
  7091*                                                                *
  7092*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7093*   FILE TYPE = VSAM,KSDS                                        *
  7094*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7095*   BASE CLUSTER = DLYACTV                                       *
  7096*   LOG = YES                                                    *
  7097*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7098*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7099*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7100*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7101*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7102*               BY PROGRAM "LGINFCE".                            *
  7103*                                                                *
  7104******************************************************************
  7105 01  DAILY-ACTIVITY-RECORD.
  7106     05  DA-KEY.
  7107         10  DA-COMP-CD          PIC X.
  7108         10  DA-CARRIER          PIC X.
  7109         10  DA-CLAIM-NO         PIC X(7).
  7110         10  DA-CERT-NO.
  7111             15  DA-CERT-PRIME   PIC X(10).
  7112             15  DA-CERT-SFX     PIC X.
  7113     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7114     05  DA-RECORD-TYPE          PIC X.
  7115     05  FILLER                  PIC X(2).
  7116******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 136
* EL156.cbl
  7118*    COPY ERCCOMP.
  7119******************************************************************
  7120*                                                                *
  7121*                                                                *
  7122*                            ERCCOMP                             *
  7123*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7124*                            VMOD=2.019                          *
  7125*                                                                *
  7126*   ONLINE CREDIT SYSTEM                                         *
  7127*                                                                *
  7128*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7129*                                                                *
  7130*   FILE TYPE = VSAM,KSDS                                        *
  7131*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7132*                                                                *
  7133*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7134*       ALTERNATE PATH = NONE                                    *
  7135*                                                                *
  7136*   LOG = NO                                                     *
  7137*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7138*                                                                *
  7139******************************************************************
  7140*                   C H A N G E   L O G
  7141*
  7142* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7143*-----------------------------------------------------------------
  7144*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7145* EFFECTIVE    NUMBER
  7146*-----------------------------------------------------------------
  7147* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7148* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7149* 092205    2005050300006  PEMA  ADD LEASE FEE
  7150* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7151* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7152* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7153* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7154* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7155******************************************************************
  7156
  7157 01  COMPENSATION-MASTER.
  7158     12  CO-RECORD-ID                          PIC XX.
  7159         88  VALID-CO-ID                          VALUE 'CO'.
  7160
  7161     12  CO-CONTROL-PRIMARY.
  7162         16  CO-COMPANY-CD                     PIC X.
  7163         16  CO-CONTROL.
  7164             20  CO-CTL-1.
  7165                 24  CO-CARR-GROUP.
  7166                     28  CO-CARRIER            PIC X.
  7167                     28  CO-GROUPING.
  7168                         32  CO-GROUP-PREFIX   PIC XXX.
  7169                         32  CO-GROUP-PRIME    PIC XXX.
  7170                 24  CO-RESP-NO.
  7171                     28  CO-RESP-PREFIX        PIC X(4).
  7172                     28  CO-RESP-PRIME         PIC X(6).
  7173             20  CO-CTL-2.
  7174                 24  CO-ACCOUNT.
  7175                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 137
* EL156.cbl
  7176                     28  CO-ACCT-PRIME         PIC X(6).
  7177         16  CO-TYPE                           PIC X.
  7178             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7179             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7180             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7181
  7182     12  CO-MAINT-INFORMATION.
  7183         16  CO-LAST-MAINT-DT                  PIC XX.
  7184         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7185         16  CO-LAST-MAINT-USER                PIC X(4).
  7186     12  FILLER                                PIC XX.
  7187     12  CO-STMT-TYPE                          PIC XXX.
  7188     12  CO-COMP-TYPE                          PIC X.
  7189         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7190     12  CO-STMT-OWNER                         PIC X(4).
  7191     12  CO-BALANCE-CONTROL                    PIC X.
  7192         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7193         88  CO-NO-BALANCE                        VALUE 'N'.
  7194
  7195     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7196         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7197         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7198         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7199
  7200     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7201         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7202         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7203
  7204     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7205     12  CO-GA-DIRECT-DEP                      PIC X.
  7206     12  CO-FUTURE-SPACE                       PIC X.
  7207         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7208
  7209     12  CO-ACCT-NAME                          PIC X(30).
  7210     12  CO-MAIL-NAME                          PIC X(30).
  7211     12  CO-ADDR-1                             PIC X(30).
  7212     12  CO-ADDR-2                             PIC X(30).
  7213     12  CO-ADDR-3.
  7214         16  CO-ADDR-CITY                      PIC X(27).
  7215         16  CO-ADDR-STATE                     PIC XX.
  7216     12  CO-CSO-1099                           PIC X.
  7217     12  CO-ZIP.
  7218         16  CO-ZIP-PRIME.
  7219             20  CO-ZIP-PRI-1ST                PIC X.
  7220                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7221             20  FILLER                        PIC X(4).
  7222         16  CO-ZIP-PLUS4                      PIC X(4).
  7223     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7224         16  CO-CAN-POSTAL-1                   PIC XXX.
  7225         16  CO-CAN-POSTAL-2                   PIC XXX.
  7226         16  FILLER                            PIC XXX.
  7227     12  CO-SOC-SEC                            PIC X(13).
  7228     12  CO-TELEPHONE.
  7229         16  CO-AREA-CODE                      PIC XXX.
  7230         16  CO-PREFIX                         PIC XXX.
  7231         16  CO-PHONE                          PIC X(4).
  7232
  7233     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 138
* EL156.cbl
  7234
  7235     12  CO-AR-BAL-LEVEL                       PIC X.
  7236         88  CO-AR-REF-LVL                        VALUE '1'.
  7237         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7238         88  CO-AR-BILL-LVL                       VALUE '2'.
  7239         88  CO-AR-AGT-LVL                        VALUE '3'.
  7240         88  CO-AR-FR-LVL                         VALUE '4'.
  7241
  7242     12  CO-AR-NORMAL-PRINT                    PIC X.
  7243         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7244         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7245
  7246     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7247
  7248     12  CO-AR-REPORTING                       PIC X.
  7249         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7250         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7251
  7252     12  CO-AR-PULL-CHECK                      PIC X.
  7253         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7254         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7255
  7256     12  CO-AR-BALANCE-PRINT                   PIC X.
  7257         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7258
  7259     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7260         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7261         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7262         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7263
  7264     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7265
  7266     12  CO-USER-CODE                          PIC X.
  7267     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7268
  7269******************************************************************
  7270*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7271*    THE LAST MONTH END RUN.
  7272******************************************************************
  7273
  7274     12  CO-LAST-ACTIVITY-DATE.
  7275         16  CO-ACT-YEAR                       PIC 99.
  7276         16  CO-ACT-MONTH                      PIC 99.
  7277         16  CO-ACT-DAY                        PIC 99.
  7278
  7279     12  CO-LAST-STMT-DT.
  7280         16  CO-LAST-STMT-YEAR                 PIC 99.
  7281         16  CO-LAST-STMT-MONTH                PIC 99.
  7282         16  CO-LAST-STMT-DAY                  PIC 99.
  7283
  7284     12  CO-MO-END-TOTALS.
  7285         16  CO-MONTHLY-TOTALS.
  7286             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7287             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7288             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7289             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7290             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  7291
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 139
* EL156.cbl
  7292         16  CO-AGING-TOTALS.
  7293             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7294             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7295             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7296             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7297
  7298         16  CO-YTD-TOTALS.
  7299             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7300             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7301
  7302         16  CO-OVER-UNDER-TOTALS.
  7303             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7304             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7305
  7306     12  CO-MISCELLANEOUS-TOTALS.
  7307         16  CO-FICA-TOTALS.
  7308             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7309             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7310
  7311         16  CO-CLAIM-TOTALS.
  7312             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7313             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7314
  7315******************************************************************
  7316*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7317*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7318******************************************************************
  7319
  7320     12  CO-CURRENT-TOTALS.
  7321         16  CO-CURRENT-LAST-STMT-DT.
  7322             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7323             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7324             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7325
  7326         16  CO-CURRENT-MONTHLY-TOTALS.
  7327             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7328             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7329             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7330             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7331             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7332
  7333         16  CO-CURRENT-AGING-TOTALS.
  7334             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7335             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7336             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7337             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7338
  7339         16  CO-CURRENT-YTD-TOTALS.
  7340             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7341             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7342
  7343     12  CO-PAID-COMM-TOTALS.
  7344         16  CO-YTD-PAID-COMMS.
  7345             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7346             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7347
  7348     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  7349         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 140
* EL156.cbl
  7350         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7351
  7352     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7353         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7354         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7355         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7356         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7357         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7358         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7359         88  CO-FINAL-LETTER                  VALUE 'F'.
  7360         88  CO-RECONCILING                   VALUE 'R'.
  7361         88  CO-PHONE-CALL                    VALUE 'P'.
  7362         88  CO-LEGAL                         VALUE 'L'.
  7363         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7364         88  CO-WRITE-OFF                     VALUE 'W'.
  7365         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7366
  7367     12  CO-CSR-CODE                       PIC X(4).
  7368
  7369     12  CO-GA-STATUS-INFO.
  7370         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7371         16  CO-GA-TERMINATION-DT          PIC XX.
  7372         16  CO-GA-STATUS-CODE             PIC X.
  7373             88  CO-GA-ACTIVE                 VALUE 'A'.
  7374             88  CO-GA-INACTIVE               VALUE 'I'.
  7375             88  CO-GA-PENDING                VALUE 'P'.
  7376         16  CO-GA-COMMENTS.
  7377             20  CO-GA-COMMENT-1           PIC X(40).
  7378             20  CO-GA-COMMENT-2           PIC X(40).
  7379             20  CO-GA-COMMENT-3           PIC X(40).
  7380             20  CO-GA-COMMENT-4           PIC X(40).
  7381
  7382     12  CO-RPTCD2                         PIC X(10).
  7383
  7384     12  CO-TYPE-AGENT                     PIC X(01).
  7385         88  CO-CORPORATION                   VALUE 'C'.
  7386         88  CO-PARTNERSHIP                   VALUE 'P'.
  7387         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7388         88  CO-TRUST                         VALUE 'T'.
  7389         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7390
  7391     12  CO-FAXNO.
  7392         16  CO-FAX-AREA-CODE                  PIC XXX.
  7393         16  CO-FAX-PREFIX                     PIC XXX.
  7394         16  CO-FAX-PHONE                      PIC X(4).
  7395
  7396     12  CO-BANK-INFORMATION.
  7397         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7398         16  CO-BANK-TRANSIT-NON REDEFINES
  7399             CO-BANK-TRANSIT-NO                PIC 9(8).
  7400
  7401         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7402     12  CO-MISC-DEDUCT-INFO REDEFINES
  7403                  CO-BANK-INFORMATION.
  7404         16  CO-MD-GL-ACCT                     PIC X(10).
  7405         16  CO-MD-DIV                         PIC XX.
  7406         16  CO-MD-CENTER                      PIC X(4).
  7407         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 141
* EL156.cbl
  7408         16  CO-CREATE-AP-CHECK                PIC X.
  7409         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7410         16  FILLER                            PIC XXX.
  7411     12  CO-ACH-STATUS                         PIC X.
  7412         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7413         88  CO-ACH-PENDING                        VALUE 'P'.
  7414
  7415     12  CO-BILL-SW                            PIC X.
  7416     12  CO-CONTROL-NAME                       PIC X(30).
  7417     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7418     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7419     12  CO-CLP-STATE                          PIC XX.
  7420     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7421     12  CO-SPP-REFUND-EDIT                    PIC X.
  7422
  7423******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 142
* EL156.cbl
  7425*    COPY ERCDMDNT.
  7426******************************************************************
  7427*                                                                *
  7428*                            ERCDMDNT                            *
  7429*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7430*                            VMOD=2.005                          *
  7431*                                                                *
  7432*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7433*                                                                *
  7434*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7435*                                                                *
  7436*        FILE TYPE= VSAM,KSDS                                    *
  7437*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7438*                                                                *
  7439*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7440*                                                                *
  7441*        LOG = YES                                               *
  7442*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7443*                                                                *
  7444******************************************************************
  7445
  7446 01  CERTIFICATE-NOTE.
  7447     12  CN-RECORD-ID                     PIC  XX.
  7448         88  VALID-CN-ID                      VALUE 'CN'.
  7449
  7450     12  CN-CONTROL-PRIMARY.
  7451         16  CN-COMPANY-CD                PIC X.
  7452         16  CN-CERT-KEY.
  7453             20  CN-CARRIER               PIC X.
  7454             20  CN-GROUPING.
  7455                 24  CN-GROUPING-PREFIX   PIC XXX.
  7456                 24  CN-GROUPING-PRIME    PIC XXX.
  7457             20  CN-STATE                 PIC XX.
  7458             20  CN-ACCOUNT.
  7459                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7460                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7461             20  CN-CERT-EFF-DT           PIC XX.
  7462             20  CN-CERT-NO.
  7463                 24  CN-CERT-PRIME        PIC X(10).
  7464                 24  CN-CERT-SFX          PIC X.
  7465
  7466     12  CN-BILLING-START-LINE-NO         PIC 99.
  7467     12  CN-BILLING-END-LINE-NO           PIC 99.
  7468
  7469     12  CN-LINES.
  7470         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7471
  7472     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7473         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7474         16  CN-CSI-GENERAL-DATA-AREA.
  7475             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7476
  7477         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7478             CN-CSI-GENERAL-DATA-AREA.
  7479             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7480             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7481             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7482             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 143
* EL156.cbl
  7483             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7484             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7485             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7486             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7487             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7488             20  FILLER                       PIC XX.
  7489             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7490             20  FILLER                       PIC X(38).
  7491
  7492         16  CN-CSI-PRODUCT-DATA-AREA.
  7493             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7494
  7495         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7496             CN-CSI-PRODUCT-DATA-AREA.
  7497             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7498             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7499             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7500             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7501             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7502             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7503             20  FILLER                   PIC XX.
  7504             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7505             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7506             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7507             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7508             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7509             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7510             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7511             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7512             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7513             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7514             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7515             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7516             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7517             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7518             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7519             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7520             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7521             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7522             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7523             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7524             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7525             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7526             20  FILLER                   PIC X(25).
  7527
  7528         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7529             CN-CSI-CREDIT-CARD-DATA.
  7530             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7531             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7532             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7533             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7534             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7535             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7536             20  FILLER                   PIC XX.
  7537             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7538             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7539             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7540             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 144
* EL156.cbl
  7541             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7542             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7543             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7544             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7545             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7546             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7547             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7548             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7549             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7550             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7551             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7552             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7553             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7554             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7555             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7556             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7557             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7558             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7559             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7560             20  FILLER                   PIC X(17).
  7561
  7562         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7563             CN-CSI-FAMILY-LEAVE-DATA.
  7564             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7565             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7566             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7567             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7568             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7569             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7570             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7571             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7572             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7573             20  CN-CSI-SL-INT-ON-PROCEEDS
  7574                                          PIC S9(5)V99  COMP-3.
  7575             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7576             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7577             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7578             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7579             20  CN-CSI-SL-POLICY-BENEFITS
  7580                                          PIC S9(5)V99  COMP-3.
  7581             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7582             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7583             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7584             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7585             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7586             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7587             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7588             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7589             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7590             20  CN-CSI-SL-STATE-NOT      PIC X.
  7591             20  FILLER                   PIC XX.
  7592
  7593         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7594             CN-CSI-SENIOR-LIFE-DATA.
  7595             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7596             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7597             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7598                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 145
* EL156.cbl
  7599             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7600             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7601             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7602             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7603             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7604             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7605             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7606             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7607             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7608             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7609             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7610             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7611             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7612             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7613             20  CN-CSI-PP-REPAIR         PIC X.
  7614             20  CN-CSI-PP-REPLACE        PIC X.
  7615             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7616             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7617             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7618             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7619             20  FILLER                   PIC X(5).
  7620
  7621         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7622             CN-CSI-PURCH-PROP-DATA.
  7623             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7624             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7625             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7626             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7627             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7628             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7629             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7630             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7631             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7632             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7633             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7634             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7635             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7636             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7637             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7638             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7639             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7640             20  CN-CSI-EW-REPLACE        PIC X.
  7641             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7642             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7643             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7644             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7645             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7646             20  FILLER                   PIC X(4).
  7647
  7648     12  CN-LAST-MAINT-DT                 PIC XX.
  7649     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7650     12  CN-LAST-MAINT-USER               PIC X(4).
  7651     12  FILLER                           PIC X(6).
  7652
  7653******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 146
* EL156.cbl
  7655*    COPY ERCCNOT.
  7656******************************************************************
  7657*                                                                *
  7658*                            ERCCNOT                             *
  7659*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7660*                            VMOD=2.003                          *
  7661*                                                                *
  7662*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7663*                                                                *
  7664*        FILE TYPE= VSAM,KSDS                                    *
  7665*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7666*                                                                *
  7667*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7668*                                                                *
  7669*        LOG = YES                                               *
  7670*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7671*                                                                *
  7672******************************************************************
  7673*                   C H A N G E   L O G
  7674*
  7675* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7676*-----------------------------------------------------------------
  7677*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7678* EFFECTIVE    NUMBER
  7679*-----------------------------------------------------------------
  7680* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7681******************************************************************
  7682
  7683 01  CERT-NOTE-FILE.
  7684     12  CZ-RECORD-ID                PIC  XX.
  7685         88  VALID-CZ-ID                  VALUE 'CZ'.
  7686
  7687     12  CZ-CONTROL-PRIMARY.
  7688         16  CZ-COMPANY-CD           PIC X.
  7689         16  CZ-CARRIER              PIC X.
  7690         16  CZ-GROUPING.
  7691             20 CZ-GROUPING-PREFIX   PIC XXX.
  7692             20 CZ-GROUPING-PRIME    PIC XXX.
  7693         16  CZ-STATE                PIC XX.
  7694         16  CZ-ACCOUNT.
  7695             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7696             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7697         16  CZ-CERT-EFF-DT          PIC XX.
  7698         16  CZ-CERT-NO.
  7699             20  CZ-CERT-PRIME       PIC X(10).
  7700             20  CZ-CERT-SFX         PIC X.
  7701         16  CZ-RECORD-TYPE          PIC X.
  7702             88  CERT-NOTE           VALUE '1'.
  7703             88  CLAIM-CERT-NOTE     VALUE '2'.
  7704         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7705
  7706     12  CZ-LAST-MAINT-DT            PIC XX.
  7707     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7708     12  CZ-LAST-MAINT-USER          PIC X(4).
  7709
  7710     12  CZ-NOTE-INFORMATION.
  7711         16  CZ-NOTE                 PIC X(63).
  7712         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 147
* EL156.cbl
  7713******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 148
* EL156.cbl
  7715 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7716                          CONTROL-FILE CERTIFICATE-MASTER
  7717                          ACTIVITY-TRAILERS ACTIVITY-QUE
  7718                          ACCOUNT-MASTER CHECK-QUE
  7719                          BENEFICIARY-MASTER LETTER-ARCHIVE
  7720                          DAILY-ACTIVITY-RECORD
  7721                          COMPENSATION-MASTER CERTIFICATE-NOTE
  7722                          CERT-NOTE-FILE.
  7723 0000-DFHEXIT SECTION.
  7724     MOVE '9#                    $   ' TO DFHEIV0.
  7725     MOVE 'EL156' TO DFHEIV1.
  7726     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7727
  7728     IF EIBCALEN = 0
  7729         GO TO 8800-UNAUTHORIZED-ACCESS.
  7730
  7731     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7732     MOVE EIBTRMID               TO QID-TERM.
  7733     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7734     MOVE '2'                    TO EMI-SWITCH2.
  7735     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7736     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7737
  7738     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7739     MOVE '5'                    TO DC-OPTION-CODE.
  7740     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7741     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  7742                                    SAVE-BIN-DATE.
  7743     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  7744     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  7745
  7746     IF SAVE-DATE-YY > 70
  7747         MOVE 19                 TO SAVE-DATE-CC
  7748     ELSE
  7749         MOVE 20                 TO SAVE-DATE-CC.
  7750
  7751     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  7752         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  7753     END-IF.
  7754
  7755     IF PI-PRINT-EOB-YN = 'Y'
  7756        MOVE 'Y'                 TO WS-PRINT-EOB-YN
  7757     ELSE
  7758        MOVE 'N'                 TO WS-PRINT-EOB-YN
  7759     END-IF
  7760
  7761* EXEC CICS HANDLE CONDITION
  7762*        NOTOPEN   (9990-ABEND)
  7763*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  7764*        MAPFAIL   (0400-FIRST-TIME)
  7765*        DUPREC    (6180-DUPREC)
  7766*        ERROR     (9990-ABEND)
  7767*    END-EXEC.
  7768*    MOVE '"$JL?%.               ! " #00007756' TO DFHEIV0
  7769     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  7770     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7771     MOVE X'2220233030303037373536' TO DFHEIV0(25:11)
  7772     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 149
* EL156.cbl
  7773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7774
  7775
  7776     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7777         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  7778
  7779     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7780         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7781             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7782             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7783             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7784             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7785             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7786             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7787             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7788             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7789             MOVE LOW-VALUES           TO EL156AI
  7790             MOVE 'Y'                  TO FIRST-ENTRY
  7791         ELSE
  7792             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7793             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7794             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7795             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7796             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7797             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7798             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7799             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  7800
  7801     IF RETURNED-FROM NOT = SPACES
  7802        IF (RETURNED-FROM = 'EL614')
  7803           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  7804           IF WS-SAVED-EOB-CODES NOT = SPACES
  7805              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  7806           ELSE
  7807              MOVE 'N'                TO WS-SET-NOTE2-MDT
  7808           END-IF
  7809        END-IF
  7810         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  7811            MOVE 'Y'             TO FIRST-ENTRY
  7812            IF RETURNED-FROM = 'EL614'
  7813               AND (PI-PASS-SW NOT = 'C')
  7814               IF WS-SAVED-EOB-CODES NOT = SPACES
  7815                  MOVE WS-SAVED-EOB-CODES
  7816                                 TO PI-PMTNOTE2
  7817                                    WS-PMTNOTE2
  7818                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  7819               ELSE
  7820                  MOVE SPACES    TO PI-PMTNOTE2
  7821                                    WS-PMTNOTE2
  7822                                    PI-EOB-CODES-EXIST
  7823               END-IF
  7824            END-IF
  7825            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  7826            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  7827            IF RETURNED-FROM = 'EL614'
  7828               GO TO 1000-EDIT-DATA
  7829            END-IF
  7830            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 150
* EL156.cbl
  7831               (PAYEEI   = LOW-VALUES OR SPACES)
  7832               GO TO 8100-SEND-INITIAL-MAP
  7833            ELSE
  7834               GO TO 1000-EDIT-DATA.
  7835
  7836     IF EIBTRNID NOT = TRANS-ID
  7837         GO TO 0400-FIRST-TIME.
  7838
  7839     IF EIBAID = DFHCLEAR
  7840        IF PI-PASS-SW = 'C'
  7841           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  7842           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  7843           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  7844           MOVE 'Y'            TO RETURNED-FROM-B
  7845           GO TO 1000-EDIT-DATA
  7846        ELSE
  7847           GO TO 9400-CLEAR.
  7848
  7849     IF PI-PASS-SW = 'C'
  7850         MOVE MAP-NAMEB          TO MAP-NAME
  7851         IF EIBAID = DFHPF1 OR DFHPF13
  7852             GO TO 5000-UPDATE
  7853           ELSE
  7854             IF EIBAID NOT = DFHENTER
  7855                 MOVE LOW-VALUES TO EL156BI
  7856                 MOVE MAP-NAMEB  TO MAP-NAME
  7857                 MOVE ER-0029    TO EMI-ERROR
  7858                 MOVE -1         TO  ENTPFBL
  7859                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7860                 GO TO 8200-SEND-DATAONLY.
  7861
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 151
* EL156.cbl
  7863 0200-RECEIVE.
  7864     MOVE LOW-VALUES             TO EL156AI.
  7865     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7866         MOVE ER-0008            TO EMI-ERROR
  7867         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7868         IF PI-PASS-SW = 'C'
  7869             MOVE -1             TO ENTPFBL
  7870             GO TO 8200-SEND-DATAONLY
  7871         ELSE
  7872             MOVE -1             TO PMTTYPEL
  7873             GO TO 8200-SEND-DATAONLY.
  7874
  7875     IF PI-COMPANY-ID = 'DMD'
  7876         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  7877
  7878     IF PI-PASS-SW = 'C'
  7879         MOVE MAP-NAMEB          TO MAP-NAME.
  7880
  7881
  7882* EXEC CICS RECEIVE
  7883*        MAP   (MAP-NAME)
  7884*        MAPSET(MAPSET-NAME)
  7885*        ASIS
  7886*        INTO  (EL156AI)
  7887*    END-EXEC.
  7888     MOVE LENGTH OF
  7889      EL156AI
  7890       TO DFHEIV11
  7891*    MOVE '8"TAI  L              ''   #00007869' TO DFHEIV0
  7892     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  7893     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7894     MOVE X'2020233030303037383639' TO DFHEIV0(25:11)
  7895     CALL 'kxdfhei1' USING DFHEIV0,
  7896           MAP-NAME,
  7897           EL156AI,
  7898           DFHEIV11,
  7899           MAPSET-NAME,
  7900           DFHEIV99,
  7901           DFHEIV99
  7902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7903
  7904
  7905     IF PI-PASS-SW NOT = 'C'
  7906         GO TO 0250-MAPA.
  7907
  7908     IF ENTPFBL NOT > ZERO
  7909         MOVE MAP-NAMEB          TO MAP-NAME
  7910         MOVE ER-0029            TO EMI-ERROR
  7911         MOVE -1                 TO  ENTPFBL
  7912         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7913         GO TO 8200-SEND-DATAONLY.
  7914
  7915     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  7916         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  7917       ELSE
  7918         MOVE MAP-NAMEB           TO MAP-NAME
  7919         MOVE ER-0029             TO EMI-ERROR
  7920         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 152
* EL156.cbl
  7921         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7922         GO TO 8200-SEND-DATAONLY.
  7923
  7924     IF EIBAID = DFHPF1 OR DFHPF13
  7925         IF MODIFY-CAP
  7926            GO TO 5000-UPDATE
  7927          ELSE
  7928            MOVE 'UPDATE'           TO SM-READ
  7929            PERFORM 9995-SECURITY-VIOLATION
  7930            MOVE MAP-NAMEB          TO MAP-NAME
  7931            MOVE ER-0070            TO EMI-ERROR
  7932            MOVE -1                 TO  ENTPFBL
  7933            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7934            GO TO 8200-SEND-DATAONLY.
  7935
  7936 0250-MAPA.
  7937     IF ENTERPFL = 0
  7938         GO TO 0300-CHECK-PFKEYS.
  7939
  7940     IF EIBAID NOT = DFHENTER
  7941         MOVE ER-0004            TO EMI-ERROR
  7942         GO TO 0320-INPUT-ERROR.
  7943
  7944     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  7945         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7946     ELSE
  7947         MOVE ER-0029            TO EMI-ERROR
  7948         GO TO 0320-INPUT-ERROR.
  7949
  7950 0300-CHECK-PFKEYS.
  7951     IF EIBAID = DFHPF7 OR DFHPF8
  7952         GO TO 8820-PF7-8.
  7953
  7954     IF EIBAID = DFHPF23
  7955         GO TO 8810-PF23.
  7956
  7957     IF EIBAID = DFHPF24
  7958         GO TO 9200-RETURN-MAIN-MENU.
  7959
  7960     IF EIBAID = DFHPF12
  7961         GO TO 9500-PF12.
  7962
  7963     IF EIBAID = DFHPF1
  7964        IF PI-PASS-SW = 'A' OR 'B'
  7965          GO TO 0330-BROWSE-FORWARD.
  7966
  7967     IF EIBAID = DFHPF2
  7968        IF PI-PASS-SW = 'A' OR 'B'
  7969          GO TO 0350-BROWSE-BACKWARD.
  7970
  7971     IF EIBAID = DFHPF6
  7972        IF PI-EOB-CODES-EXIST = 'Y'
  7973           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  7974        ELSE
  7975           MOVE SPACES              TO WS-PMTNOTE2
  7976        END-IF
  7977         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  7978         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 153
* EL156.cbl
  7979            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  7980         END-IF
  7981         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7982         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  7983             MOVE 'EL614'        TO PGM-NAME
  7984             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  7985             GO TO 9300-XCTL
  7986         ELSE
  7987             MOVE XCTL-157       TO PGM-NAME
  7988             GO TO 9300-XCTL.
  7989
  7990     IF EIBAID = DFHPF9
  7991        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  7992        MOVE XCTL-141            TO PGM-NAME
  7993        GO TO 9300-XCTL.
  7994
  7995     IF EIBAID = DFHPF10
  7996        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  7997        MOVE XCTL-155            TO PGM-NAME
  7998        GO TO 9300-XCTL.
  7999
  8000     MOVE SPACES                 TO ERRMSG0O
  8001                                    ERRMSG1O
  8002                                    ERRMSG2O.
  8003
  8004     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8005         IF PI-PASS-SW NOT = 'B'
  8006             MOVE ER-0422        TO EMI-ERROR
  8007             GO TO 0320-INPUT-ERROR
  8008           ELSE
  8009             GO TO 0700-TEST-FOR-CHANGES.
  8010
  8011     IF EIBAID = DFHPF11
  8012        IF PI-PASS-SW = 'C'
  8013           MOVE ER-0029          TO EMI-ERROR
  8014           GO TO 0320-INPUT-ERROR.
  8015
  8016     IF EIBAID = DFHENTER OR DFHPF11
  8017        NEXT SENTENCE
  8018     ELSE
  8019        MOVE ER-0029             TO EMI-ERROR
  8020        GO TO 0320-INPUT-ERROR.
  8021
  8022     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8023
  8024     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8025         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8026         GO TO 1000-EDIT-DATA
  8027     ELSE
  8028         IF PI-FATAL-COUNT NOT = 0 OR
  8029            PI-FORCE-COUNT NOT = 0
  8030             GO TO 1000-EDIT-DATA
  8031         ELSE
  8032             GO TO 2000-EDIT-DONE.
  8033
  8034 0320-INPUT-ERROR.
  8035     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8036
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 154
* EL156.cbl
  8037     IF ENTERPFL = 0
  8038         MOVE -1                 TO PMTTYPEL
  8039     ELSE
  8040         MOVE AL-UNBON           TO ENTERPFA
  8041         MOVE -1                 TO ENTERPFL.
  8042
  8043     GO TO 8200-SEND-DATAONLY.
  8044
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 155
* EL156.cbl
  8046 0330-BROWSE-FORWARD.
  8047
  8048     MOVE CLMNOI            TO PI-CLAIM-NO.
  8049     MOVE CARRI             TO PI-CARRIER.
  8050     MOVE CERTNOI           TO PI-CERT-PRIME.
  8051     MOVE SUFXI             TO PI-CERT-SFX.
  8052
  8053     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8054     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8055     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8056     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8057
  8058     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8059
  8060
  8061* EXEC CICS HANDLE CONDITION
  8062*         NOTFND   (0380-CLAIM-END-FILE)
  8063*         ENDFILE  (0380-CLAIM-END-FILE)
  8064*    END-EXEC.
  8065*    MOVE '"$I''                  ! # #00008031' TO DFHEIV0
  8066     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8067     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8068     MOVE X'2320233030303038303331' TO DFHEIV0(25:11)
  8069     CALL 'kxdfhei1' USING DFHEIV0
  8070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8071
  8072
  8073
  8074* EXEC CICS STARTBR
  8075*         DATASET    ('ELMSTR')
  8076*         RIDFLD     (ELMSTR-KEY)
  8077*         GTEQ
  8078*    END-EXEC.
  8079     MOVE 'ELMSTR' TO DFHEIV1
  8080     MOVE 0
  8081       TO DFHEIV11
  8082*    MOVE '&,         G          &   #00008036' TO DFHEIV0
  8083     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8084     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8085     MOVE X'2020233030303038303336' TO DFHEIV0(25:11)
  8086     CALL 'kxdfhei1' USING DFHEIV0,
  8087           DFHEIV1,
  8088           ELMSTR-KEY,
  8089           DFHEIV99,
  8090           DFHEIV11,
  8091           DFHEIV99
  8092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8093
  8094
  8095     MOVE 'Y' TO WS-BROWSE-START-SW.
  8096
  8097 0335-READNEXT.
  8098
  8099
  8100* EXEC CICS READNEXT
  8101*         DATASET    ('ELMSTR')
  8102*         RIDFLD     (ELMSTR-KEY)
  8103*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 156
* EL156.cbl
  8104*    END-EXEC.
  8105     MOVE 'ELMSTR' TO DFHEIV1
  8106     MOVE 0
  8107       TO DFHEIV11
  8108*    MOVE '&.S                   )   #00008046' TO DFHEIV0
  8109     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8110     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8111     MOVE X'2020233030303038303436' TO DFHEIV0(25:11)
  8112     CALL 'kxdfhei1' USING DFHEIV0,
  8113           DFHEIV1,
  8114           DFHEIV20,
  8115           DFHEIV99,
  8116           ELMSTR-KEY,
  8117           DFHEIV99,
  8118           DFHEIV11,
  8119           DFHEIV99,
  8120           DFHEIV99
  8121     SET ADDRESS OF CLAIM-MASTER TO
  8122         DFHEIV20
  8123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8124
  8125
  8126     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8127        GO TO 0380-CLAIM-END-FILE.
  8128
  8129     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8130        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8131        GO TO 0335-READNEXT.
  8132
  8133     IF PI-COMPANY-ID = 'CRI'
  8134         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8135            GO TO 0380-CLAIM-END-FILE.
  8136
  8137     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8138         GO TO 0335-READNEXT.
  8139
  8140     IF PI-CARRIER-SECURITY > SPACES
  8141         IF CL-CARRIER = PI-CARRIER-SECURITY
  8142             NEXT SENTENCE
  8143         ELSE
  8144             GO TO 0335-READNEXT.
  8145
  8146     IF PI-ACCOUNT-SECURITY > SPACES
  8147         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8148             NEXT SENTENCE
  8149         ELSE
  8150             GO TO 0335-READNEXT.
  8151
  8152     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8153     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8154     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8155
  8156     GO TO 0400-FIRST-TIME.
  8157
  8158 0350-BROWSE-BACKWARD.
  8159
  8160     MOVE CLMNOI            TO PI-CLAIM-NO
  8161                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 157
* EL156.cbl
  8162     MOVE CARRI             TO PI-CARRIER.
  8163     MOVE CERTNOI           TO PI-CERT-PRIME.
  8164     MOVE SUFXI             TO PI-CERT-SFX.
  8165
  8166     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8167
  8168     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8169     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8170     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8171
  8172
  8173* EXEC CICS HANDLE CONDITION
  8174*         NOTFND   (0380-CLAIM-END-FILE)
  8175*         ENDFILE  (0380-CLAIM-END-FILE)
  8176*    END-EXEC.
  8177*    MOVE '"$I''                  ! $ #00008098' TO DFHEIV0
  8178     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8180     MOVE X'2420233030303038303938' TO DFHEIV0(25:11)
  8181     CALL 'kxdfhei1' USING DFHEIV0
  8182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8183
  8184
  8185
  8186* EXEC CICS STARTBR
  8187*         DATASET    ('ELMSTR')
  8188*         RIDFLD     (ELMSTR-KEY)
  8189*         GTEQ
  8190*    END-EXEC.
  8191     MOVE 'ELMSTR' TO DFHEIV1
  8192     MOVE 0
  8193       TO DFHEIV11
  8194*    MOVE '&,         G          &   #00008103' TO DFHEIV0
  8195     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8196     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8197     MOVE X'2020233030303038313033' TO DFHEIV0(25:11)
  8198     CALL 'kxdfhei1' USING DFHEIV0,
  8199           DFHEIV1,
  8200           ELMSTR-KEY,
  8201           DFHEIV99,
  8202           DFHEIV11,
  8203           DFHEIV99
  8204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8205
  8206
  8207     MOVE 'Y' TO WS-BROWSE-START-SW.
  8208
  8209
  8210* EXEC CICS READNEXT
  8211*         DATASET    ('ELMSTR')
  8212*         RIDFLD     (ELMSTR-KEY)
  8213*         SET        (ADDRESS OF CLAIM-MASTER)
  8214*    END-EXEC.
  8215     MOVE 'ELMSTR' TO DFHEIV1
  8216     MOVE 0
  8217       TO DFHEIV11
  8218*    MOVE '&.S                   )   #00008111' TO DFHEIV0
  8219     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 158
* EL156.cbl
  8220     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8221     MOVE X'2020233030303038313131' TO DFHEIV0(25:11)
  8222     CALL 'kxdfhei1' USING DFHEIV0,
  8223           DFHEIV1,
  8224           DFHEIV20,
  8225           DFHEIV99,
  8226           ELMSTR-KEY,
  8227           DFHEIV99,
  8228           DFHEIV11,
  8229           DFHEIV99,
  8230           DFHEIV99
  8231     SET ADDRESS OF CLAIM-MASTER TO
  8232         DFHEIV20
  8233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8234
  8235
  8236
  8237* EXEC CICS READPREV
  8238*         DATASET    ('ELMSTR')
  8239*         RIDFLD     (ELMSTR-KEY)
  8240*         SET        (ADDRESS OF CLAIM-MASTER)
  8241*    END-EXEC.
  8242     MOVE 'ELMSTR' TO DFHEIV1
  8243     MOVE 0
  8244       TO DFHEIV11
  8245*    MOVE '&0S                   )   #00008117' TO DFHEIV0
  8246     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8247     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8248     MOVE X'2020233030303038313137' TO DFHEIV0(25:11)
  8249     CALL 'kxdfhei1' USING DFHEIV0,
  8250           DFHEIV1,
  8251           DFHEIV20,
  8252           DFHEIV99,
  8253           ELMSTR-KEY,
  8254           DFHEIV99,
  8255           DFHEIV11,
  8256           DFHEIV99,
  8257           DFHEIV99
  8258     SET ADDRESS OF CLAIM-MASTER TO
  8259         DFHEIV20
  8260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8261
  8262
  8263 0360-BROWSE-BACKWARD.
  8264
  8265
  8266* EXEC CICS READPREV
  8267*         DATASET    ('ELMSTR')
  8268*         RIDFLD     (ELMSTR-KEY)
  8269*         SET        (ADDRESS OF CLAIM-MASTER)
  8270*    END-EXEC.
  8271     MOVE 'ELMSTR' TO DFHEIV1
  8272     MOVE 0
  8273       TO DFHEIV11
  8274*    MOVE '&0S                   )   #00008125' TO DFHEIV0
  8275     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8276     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8277     MOVE X'2020233030303038313235' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 159
* EL156.cbl
  8278     CALL 'kxdfhei1' USING DFHEIV0,
  8279           DFHEIV1,
  8280           DFHEIV20,
  8281           DFHEIV99,
  8282           ELMSTR-KEY,
  8283           DFHEIV99,
  8284           DFHEIV11,
  8285           DFHEIV99,
  8286           DFHEIV99
  8287     SET ADDRESS OF CLAIM-MASTER TO
  8288         DFHEIV20
  8289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8290
  8291
  8292     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8293        GO TO 0380-CLAIM-END-FILE.
  8294
  8295     IF PI-COMPANY-ID = 'CRI'
  8296         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8297            GO TO 0380-CLAIM-END-FILE.
  8298
  8299     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8300         GO TO 0360-BROWSE-BACKWARD.
  8301
  8302     IF PI-CARRIER-SECURITY > SPACES
  8303         IF CL-CARRIER = PI-CARRIER-SECURITY
  8304             NEXT SENTENCE
  8305         ELSE
  8306             GO TO 0360-BROWSE-BACKWARD.
  8307
  8308     IF PI-ACCOUNT-SECURITY > SPACES
  8309         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8310             NEXT SENTENCE
  8311         ELSE
  8312             GO TO 0360-BROWSE-BACKWARD.
  8313
  8314     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8315     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8316     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8317
  8318     GO TO 0400-FIRST-TIME.
  8319
  8320 0380-CLAIM-END-FILE.
  8321
  8322     MOVE ER-0130     TO EMI-ERROR.
  8323     MOVE -1          TO CLMNOL.
  8324     MOVE AL-UABON    TO CARRA
  8325                         CLMNOA
  8326                         CERTNOA
  8327                         SUFXA.
  8328
  8329     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8330
  8331     GO TO 8200-SEND-DATAONLY.
  8332
  8333 0400-FIRST-TIME.
  8334
  8335     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 160
* EL156.cbl
  8336        MOVE 'N'         TO WS-BROWSE-START-SW
  8337
  8338* EXEC CICS ENDBR
  8339*            DATASET    ('ELMSTR')
  8340*       END-EXEC.
  8341     MOVE 'ELMSTR' TO DFHEIV1
  8342     MOVE 0
  8343       TO DFHEIV11
  8344*    MOVE '&2                    $   #00008176' TO DFHEIV0
  8345     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8346     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8347     MOVE X'2020233030303038313736' TO DFHEIV0(25:11)
  8348     CALL 'kxdfhei1' USING DFHEIV0,
  8349           DFHEIV1,
  8350           DFHEIV11,
  8351           DFHEIV99
  8352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8353
  8354
  8355     IF PI-PROCESSOR-ID = 'LGXX'
  8356         NEXT SENTENCE
  8357     ELSE
  8358
  8359* EXEC CICS READQ TS
  8360*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8361*            INTO    (SECURITY-CONTROL)
  8362*            LENGTH  (SC-COMM-LENGTH)
  8363*            ITEM    (SC-ITEM)
  8364*        END-EXEC
  8365*    MOVE '*$II   L              ''   #00008183' TO DFHEIV0
  8366     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8367     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8368     MOVE X'2020233030303038313833' TO DFHEIV0(25:11)
  8369     CALL 'kxdfhei1' USING DFHEIV0,
  8370           PI-SECURITY-TEMP-STORE-ID,
  8371           SECURITY-CONTROL,
  8372           SC-COMM-LENGTH,
  8373           SC-ITEM,
  8374           DFHEIV99,
  8375           DFHEIV99
  8376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8377         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8378         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8379
  8380     MOVE LOW-VALUES             TO EL156AI.
  8381     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8382     MOVE 'Y'                    TO FIRST-ENTRY.
  8383     GO TO 7000-SHOW-CLAIM.
  8384
  8385 0500-CREATE-TEMP-STORAGE.
  8386     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8387
  8388
  8389* EXEC CICS WRITEQ TS
  8390*        QUEUE (QID)
  8391*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8392*        LENGTH(PI-COMM-LENGTH)
  8393*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 161
* EL156.cbl
  8394*    MOVE '*"                    ''   #00008200' TO DFHEIV0
  8395     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8396     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8397     MOVE X'2020233030303038323030' TO DFHEIV0(25:11)
  8398     CALL 'kxdfhei1' USING DFHEIV0,
  8399           QID,
  8400           PROGRAM-INTERFACE-BLOCK,
  8401           PI-COMM-LENGTH,
  8402           DFHEIV99,
  8403           DFHEIV99,
  8404           DFHEIV99
  8405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8406
  8407
  8408
  8409* EXEC CICS WRITEQ TS
  8410*        QUEUE (QID)
  8411*        FROM  (EL156AI)
  8412*        LENGTH(MAP-LENGTH)
  8413*    END-EXEC.
  8414*    MOVE '*"                    ''   #00008206' TO DFHEIV0
  8415     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8416     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8417     MOVE X'2020233030303038323036' TO DFHEIV0(25:11)
  8418     CALL 'kxdfhei1' USING DFHEIV0,
  8419           QID,
  8420           EL156AI,
  8421           MAP-LENGTH,
  8422           DFHEIV99,
  8423           DFHEIV99,
  8424           DFHEIV99
  8425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8426
  8427
  8428 0599-EXIT.
  8429      EXIT.
  8430
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 162
* EL156.cbl
  8432 0600-RECOVER-TEMP-STORAGE.
  8433
  8434* EXEC CICS READQ TS
  8435*        QUEUE (QID)
  8436*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8437*        LENGTH(PI-COMM-LENGTH)
  8438*    END-EXEC.
  8439*    MOVE '*$I    L              ''   #00008217' TO DFHEIV0
  8440     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8441     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8442     MOVE X'2020233030303038323137' TO DFHEIV0(25:11)
  8443     CALL 'kxdfhei1' USING DFHEIV0,
  8444           QID,
  8445           PROGRAM-INTERFACE-BLOCK,
  8446           PI-COMM-LENGTH,
  8447           DFHEIV99,
  8448           DFHEIV99,
  8449           DFHEIV99
  8450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8451
  8452
  8453
  8454* EXEC CICS READQ TS
  8455*        QUEUE (QID)
  8456*        INTO  (EL156AI)
  8457*        LENGTH(MAP-LENGTH)
  8458*    END-EXEC.
  8459*    MOVE '*$I    L              ''   #00008223' TO DFHEIV0
  8460     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8461     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8462     MOVE X'2020233030303038323233' TO DFHEIV0(25:11)
  8463     CALL 'kxdfhei1' USING DFHEIV0,
  8464           QID,
  8465           EL156AI,
  8466           MAP-LENGTH,
  8467           DFHEIV99,
  8468           DFHEIV99,
  8469           DFHEIV99
  8470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8471
  8472
  8473     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8474
  8475     IF PMTTYPEI NOT = LOW-VALUES
  8476         MOVE AL-UANON           TO PMTTYPEA.
  8477
  8478     IF PAYEEI NOT = LOW-VALUES
  8479         MOVE AL-UANON           TO PAYEEA.
  8480
  8481     IF NOTE1I NOT = LOW-VALUES
  8482         MOVE AL-UANON           TO NOTE1A.
  8483
  8484     IF (RETURNED-FROM = 'EL614')
  8485        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8486     END-IF
  8487*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8488*       AND (PI-EOB-CODES-EXIST = 'Y')
  8489*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 163
* EL156.cbl
  8490*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8491     IF PI-SET-NOTE2-MDT = 'Y'
  8492         MOVE AL-SANON           TO NOTE2A
  8493     END-IF
  8494
  8495     IF OFFLINEI NOT = LOW-VALUES
  8496         MOVE AL-UANON           TO OFFLINEA.
  8497
  8498     IF GROUPEDI NOT = LOW-VALUES
  8499         MOVE AL-UANON           TO GROUPEDA.
  8500
  8501     IF CASHI NOT = LOW-VALUES
  8502         MOVE AL-UANON           TO CASHA.
  8503
  8504     IF CHECKNOI NOT = LOW-VALUES
  8505         MOVE AL-UANON           TO CHECKNOA.
  8506
  8507     IF HOLDTILI NOT = LOW-VALUES
  8508         MOVE AL-UANON           TO HOLDTILA.
  8509
  8510     IF EPYFROMI NOT = LOW-VALUES
  8511         MOVE AL-UANON           TO EPYFROMA.
  8512
  8513     IF AIGFROMI NOT = LOW-VALUES
  8514         MOVE AL-UANON           TO AIGFROMA.
  8515
  8516     IF EPYTHRUI NOT = LOW-VALUES
  8517         MOVE AL-UANON           TO EPYTHRUA.
  8518
  8519     IF EDAYSI NOT = LOW-VALUES
  8520         MOVE AL-UNNON           TO EDAYSA.
  8521
  8522     IF EPYAMTL NOT = +0
  8523         MOVE AL-UNNON           TO EPYAMTA.
  8524
  8525     IF ERESVL NOT = +0
  8526         MOVE AL-UNNON           TO ERESVA.
  8527
  8528     IF EEXPENSL NOT = +0
  8529         MOVE AL-UNNON           TO EEXPENSA.
  8530
  8531     IF ETYPEI NOT = LOW-VALUES
  8532         MOVE AL-UNNON           TO ETYPEA.
  8533
  8534     IF PROOFDTI NOT = 0
  8535         MOVE AL-UNNON           TO PROOFDTA.
  8536
  8537     IF EOBYNI = 'Y' OR 'N'
  8538        MOVE AL-UANON            TO EOBYNA
  8539     END-IF
  8540     .
  8541 0699-EXIT.
  8542      EXIT.
  8543
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 164
* EL156.cbl
  8545 0700-TEST-FOR-CHANGES.
  8546     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8547         MOVE ER-0433            TO EMI-ERROR
  8548         GO TO 0750-FUNCTION-ERROR.
  8549
  8550     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8551
  8552     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8553         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8554         MOVE 'A'                TO PI-PASS-SW
  8555         GO TO 1000-EDIT-DATA.
  8556
  8557     IF PI-FATAL-COUNT NOT = 0
  8558         MOVE ER-0499            TO EMI-ERROR
  8559         GO TO 0750-FUNCTION-ERROR.
  8560
  8561     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8562         MOVE ER-0500            TO EMI-ERROR
  8563         GO TO 0750-FUNCTION-ERROR.
  8564
  8565     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8566        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8567           MOVE ER-0542          TO EMI-ERROR
  8568           MOVE -1               TO EPYAMTL
  8569           GO TO 0750-FUNCTION-ERROR.
  8570
  8571     IF PI-OFFLINE = 'Y'  OR
  8572        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8573        MOVE EIBAID              TO PI-PFKEY-USED
  8574        GO TO 5000-UPDATE.
  8575
  8576     GO TO 6000-BUILD-SCREEN-B.
  8577
  8578 0750-FUNCTION-ERROR.
  8579     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8580
  8581     IF ENTERPFL > 0
  8582         MOVE -1                 TO ENTERPFL
  8583         MOVE AL-UNBON           TO ENTERPFA
  8584         GO TO 8200-SEND-DATAONLY
  8585     ELSE
  8586         MOVE -1                 TO ENTERPFL
  8587         MOVE AL-UNNOF           TO ENTERPFA
  8588         GO TO 8200-SEND-DATAONLY.
  8589
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 165
* EL156.cbl
  8591 0800-DELETE-TS.
  8592
  8593* EXEC CICS HANDLE CONDITION
  8594*        QIDERR(0800-EXIT)
  8595*    END-EXEC.
  8596*    MOVE '"$N                   ! % #00008348' TO DFHEIV0
  8597     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8599     MOVE X'2520233030303038333438' TO DFHEIV0(25:11)
  8600     CALL 'kxdfhei1' USING DFHEIV0
  8601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8602
  8603
  8604
  8605* EXEC CICS DELETEQ TS
  8606*        QUEUE(QID)
  8607*    END-EXEC.
  8608*    MOVE '*&                    #   #00008352' TO DFHEIV0
  8609     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8610     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8611     MOVE X'2020233030303038333532' TO DFHEIV0(25:11)
  8612     CALL 'kxdfhei1' USING DFHEIV0,
  8613           QID,
  8614           DFHEIV99
  8615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8616
  8617
  8618 0800-EXIT.
  8619      EXIT.
  8620
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 166
* EL156.cbl
  8622 1000-EDIT-DATA.
  8623
  8624     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  8625         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  8626         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  8627
  8628     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  8629
  8630     IF NOT MODIFY-CAP
  8631         MOVE ER-0070            TO EMI-ERROR
  8632         MOVE -1                 TO PMTTYPEL
  8633         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8634         GO TO 2000-EDIT-DONE.
  8635
  8636     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  8637                         '5' AND '6'
  8638         MOVE ER-0420            TO EMI-ERROR
  8639         MOVE -1                 TO PMTTYPEL
  8640         MOVE AL-UABON           TO PMTTYPEA
  8641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8642     ELSE
  8643         MOVE AL-UANON           TO PMTTYPEA.
  8644
  8645     IF PI-OFFLINE = 'Y'
  8646        IF PI-GROUPED = 'Y'
  8647           MOVE ER-1880         TO EMI-ERROR
  8648           MOVE -1              TO GROUPEDL
  8649           MOVE AL-UABON        TO GROUPEDA
  8650           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8651
  8652     IF GROUPEDL > +0
  8653        IF PI-GROUPED = 'Y' OR 'N'
  8654           MOVE AL-UANON TO GROUPEDA
  8655        ELSE
  8656           MOVE ER-3140            TO EMI-ERROR
  8657           MOVE -1                 TO GROUPEDL
  8658           MOVE AL-UABON           TO GROUPEDA
  8659           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8660
  8661     IF CASHL > +0
  8662        IF PI-CASH = 'Y' OR 'N'
  8663           MOVE AL-UANON           TO CASHA
  8664        ELSE
  8665           MOVE ER-3141            TO EMI-ERROR
  8666           MOVE -1                 TO CASHL
  8667           MOVE AL-UABON           TO CASHA
  8668           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8669
  8670     IF LOANNOL > +0
  8671         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  8672
  8673 1000-EDIT-PAYEE.
  8674
  8675     IF PI-PAYEE-SEQ NOT NUMERIC
  8676         MOVE ER-0294            TO  EMI-ERROR
  8677         MOVE -1                 TO  PAYEEL
  8678         MOVE AL-UABON           TO  PAYEEA
  8679         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 167
* EL156.cbl
  8680         GO TO 1000-CONT-EDIT.
  8681
  8682     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  8683                         'E' OR 'O' OR 'Q'
  8684         NEXT SENTENCE
  8685     ELSE
  8686         MOVE ER-0294            TO  EMI-ERROR
  8687         MOVE -1                 TO  PAYEEL
  8688         MOVE AL-UABON           TO  PAYEEA
  8689         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8690         GO TO 1000-CONT-EDIT.
  8691
  8692     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  8693        (PI-PAYEE-SEQ NOT < '1' AND
  8694         PI-PAYEE-SEQ NOT > '9'))
  8695      OR
  8696        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  8697         (PI-PAYEE-SEQ NOT > '9'))
  8698         MOVE AL-UANON            TO PAYEEA
  8699     ELSE
  8700         MOVE ER-0294            TO EMI-ERROR
  8701         MOVE -1                 TO PAYEEL
  8702         MOVE AL-UABON           TO PAYEEA
  8703         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8704
  8705     IF PI-COMPANY-ID = 'DMD'
  8706         IF PI-PAYEE-TYPE = 'B' AND
  8707            PI-PAYEE-SEQ NOT = '0'
  8708               MOVE ER-7841            TO EMI-ERROR
  8709               MOVE -1                 TO PAYEEL
  8710               MOVE AL-UABON           TO PAYEEA
  8711               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8712
  8713     IF PI-COMPANY-ID = 'JHL'
  8714         IF PI-PAYEE = 'B0'
  8715             NEXT SENTENCE
  8716           ELSE
  8717
  8718* EXEC CICS HANDLE CONDITION
  8719*            ENDFILE(1950-NOT-FOUND)
  8720*            NOTFND (1950-NOT-FOUND)
  8721*        END-EXEC
  8722*    MOVE '"$''I                  ! & #00008455' TO DFHEIV0
  8723     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8724     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8725     MOVE X'2620233030303038343535' TO DFHEIV0(25:11)
  8726     CALL 'kxdfhei1' USING DFHEIV0
  8727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8728         MOVE 'N'                    TO FOUND-TOL-SW
  8729         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  8730         MOVE '2'                    TO CNTL-REC-TYPE
  8731         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  8732         MOVE +0                     TO CNTL-SEQ-NO
  8733         MOVE 'PROC'                 TO FILE-SWITCH
  8734         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  8735         IF PI-PAYEE = 'I1' AND
  8736            APPROVAL-LEVEL-2
  8737             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 168
* EL156.cbl
  8738           ELSE
  8739         IF NOT PI-USER-ALMIGHTY-YES
  8740             MOVE ER-3546        TO EMI-ERROR
  8741             MOVE -1             TO PAYEEL
  8742             MOVE AL-UABON       TO PAYEEA
  8743             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8744
  8745     IF PI-PAYEE-TYPE = 'E'
  8746        IF PI-PMTTYPE = '5' OR '6'
  8747            NEXT SENTENCE
  8748        ELSE
  8749            MOVE ER-3539            TO EMI-ERROR
  8750            MOVE -1                 TO PAYEEL
  8751            MOVE AL-UABON           TO PAYEEA
  8752            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8753
  8754 1000-CONT-EDIT.
  8755
  8756     IF PI-OFFLINE NOT = 'Y' AND 'N'
  8757        IF PI-EPYAMT NOT NEGATIVE
  8758            MOVE ER-0421         TO EMI-ERROR
  8759            MOVE -1              TO OFFLINEL
  8760            MOVE AL-UABON        TO OFFLINEA
  8761            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8762        ELSE
  8763            MOVE AL-UANON        TO OFFLINEA.
  8764
  8765     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8766        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  8767           CONTINUE
  8768        ELSE
  8769           MOVE ER-1561          TO EMI-ERROR
  8770           MOVE -1               TO EOBYNL
  8771           MOVE AL-UABON         TO EOBYNA
  8772           PERFORM 9900-ERROR-FORMAT
  8773                                 THRU 9900-EXIT
  8774        END-IF
  8775     END-IF
  8776     IF PI-EPYAMT IS NEGATIVE
  8777         IF PI-OFFLINE NOT = 'Y'
  8778             MOVE ER-0836        TO  EMI-ERROR
  8779             MOVE -1             TO  OFFLINEL
  8780             MOVE AL-UABON       TO  OFFLINEA
  8781             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8782
  8783     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  8784        MOVE ER-0872             TO EMI-ERROR
  8785        MOVE -1                  TO PROOFDTL
  8786        MOVE AL-UABON            TO PROOFDTA
  8787        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8788     ELSE
  8789        MOVE '4'                TO DC-OPTION-CODE
  8790        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  8791        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  8792        IF DATE-CONVERSION-ERROR
  8793            MOVE ER-0873        TO EMI-ERROR
  8794            MOVE -1                  TO PROOFDTL
  8795            MOVE AL-UABON            TO PROOFDTA
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 169
* EL156.cbl
  8796            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8797        ELSE
  8798            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  8799            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  8800                MOVE ER-0873    TO EMI-ERROR
  8801                MOVE -1                  TO PROOFDTL
  8802                MOVE AL-UABON            TO PROOFDTA
  8803                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8804            END-IF
  8805        END-IF
  8806     END-IF.
  8807
  8808     IF PI-COMPANY-ID = 'DMD'
  8809        IF NOTE1L NOT = ZEROS
  8810            MOVE ER-7844        TO  EMI-ERROR
  8811            MOVE -1             TO  NOTE1L
  8812            MOVE AL-UABON       TO  NOTE1A
  8813            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8814
  8815     IF PI-COMPANY-ID = 'DMD'
  8816        IF NOTE2L NOT = ZEROS
  8817          GO TO 1004-DMD-EOB-CHECKS.
  8818
  8819     IF NOTE1L NOT > +0
  8820         GO TO 1005-CHECK-ERRORS.
  8821
  8822     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  8823         GO TO 1005-CHECK-ERRORS.
  8824
  8825     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  8826         GO TO 1003-HAN-PMT-NOTES.
  8827
  8828     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
  8829
  8830     IF WS-PMTOPTION NUMERIC
  8831        IF WS-PMTOPTION > '00' AND < '17'
  8832           NEXT SENTENCE
  8833        ELSE
  8834           MOVE ER-0618          TO EMI-ERROR
  8835           MOVE -1               TO NOTE1L
  8836           MOVE AL-UABON         TO NOTE1A
  8837           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8838     ELSE
  8839        GO TO 1005-CHECK-ERRORS.
  8840
  8841     IF WS-PMTOPTION = '05' AND
  8842        WS-DOCNAME = SPACES
  8843          MOVE ER-0616             TO EMI-ERROR
  8844          MOVE -1                  TO NOTE1L
  8845          MOVE AL-UABON            TO NOTE1A
  8846          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8847
  8848     IF WS-PMTOPTION = '15' OR '16'
  8849
  8850* EXEC CICS BIF DEEDIT
  8851*            FIELD (WS-AMOUNT)
  8852*            LENGTH(08)
  8853*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 170
* EL156.cbl
  8854     MOVE 08
  8855       TO DFHEIV11
  8856*    MOVE '@"L                   #   #00008580' TO DFHEIV0
  8857     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8858     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8859     MOVE X'2020233030303038353830' TO DFHEIV0(25:11)
  8860     CALL 'kxdfhei1' USING DFHEIV0,
  8861           WS-AMOUNT,
  8862           DFHEIV11
  8863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8864        IF (WS-NUM-AMT = ZEROS) OR
  8865           (WS-AMOUNT NOT NUMERIC)
  8866           MOVE ER-0617          TO EMI-ERROR
  8867           MOVE -1               TO NOTE1L
  8868           MOVE AL-UABON         TO NOTE1A
  8869           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8870
  8871     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  8872
  8873     GO TO 1005-CHECK-ERRORS.
  8874
  8875 1003-HAN-PMT-NOTES.
  8876
  8877     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  8878
  8879     IF WS-HAN-PMT-CODE = SPACE
  8880         MOVE SPACES             TO WS-HAN-PMT-NOTE
  8881     ELSE
  8882     IF WS-HAN-PMT-CODE = 'A'
  8883         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  8884                                 TO WS-HAN-PMT-NOTE
  8885     ELSE
  8886     IF WS-HAN-PMT-CODE = 'B'
  8887         MOVE ':FINAL PAYMENT / DECEASED'
  8888                                 TO WS-HAN-PMT-NOTE
  8889     ELSE
  8890     IF WS-HAN-PMT-CODE = 'C'
  8891         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  8892                                 TO WS-HAN-PMT-NOTE
  8893     ELSE
  8894     IF WS-HAN-PMT-CODE = 'D'
  8895         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  8896                                 TO WS-HAN-PMT-NOTE
  8897     ELSE
  8898     IF WS-HAN-PMT-CODE = 'E'
  8899         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  8900                                 TO WS-HAN-PMT-NOTE
  8901     ELSE
  8902     IF WS-HAN-PMT-CODE = 'F'
  8903         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  8904                                 TO WS-HAN-PMT-NOTE
  8905     ELSE
  8906     IF WS-HAN-PMT-CODE = 'P'
  8907         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  8908
  8909     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  8910     GO TO 1005-CHECK-ERRORS.
  8911
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 171
* EL156.cbl
  8912 1004-DMD-EOB-CHECKS.
  8913
  8914     INITIALIZE PI-AT-EOB-CODES.
  8915
  8916     IF NOTE2I (20:21) > SPACES
  8917         MOVE ER-7845          TO EMI-ERROR
  8918         MOVE -1               TO NOTE2L
  8919         MOVE AL-UABON         TO NOTE2A
  8920         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8921         GO TO 1005-CHECK-ERRORS
  8922      ELSE
  8923         MOVE NOTE2I             TO W-EOB-CODES.
  8924
  8925     MOVE +1                     TO W-EOB-NDX.
  8926
  8927 1004-CHECK-EACH-EOB.
  8928
  8929     IF W-EOB-NDX > +5
  8930             OR
  8931        W-EOB-CODE (W-EOB-NDX) = SPACES
  8932         GO TO 1004-CHECK-DUP-EOB.
  8933
  8934     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  8935         MOVE ER-0956            TO EMI-ERROR
  8936         MOVE -1                 TO NOTE2L
  8937         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8938         GO TO 1005-CHECK-ERRORS.
  8939
  8940     MOVE 'CL'                   TO CD-SYSTEM-ID.
  8941     MOVE 'EO'                   TO CD-RECORD-TYPE.
  8942     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  8943     MOVE 'DLO023'               TO PGM-NAME.
  8944
  8945
  8946* EXEC CICS LINK
  8947*        PROGRAM    (PGM-NAME)
  8948*        COMMAREA   (CD-COMMUNICATION-AREA)
  8949*        LENGTH     (CD-RCRD-LENGTH)
  8950*    END-EXEC.
  8951*    MOVE '."C                   ''   #00008665' TO DFHEIV0
  8952     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8953     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8954     MOVE X'2020233030303038363635' TO DFHEIV0(25:11)
  8955     CALL 'kxdfhei1' USING DFHEIV0,
  8956           PGM-NAME,
  8957           CD-COMMUNICATION-AREA,
  8958           CD-RCRD-LENGTH,
  8959           DFHEIV99,
  8960           DFHEIV99,
  8961           DFHEIV99
  8962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8963
  8964
  8965     IF CD-RETURN-CODE = 'OK'
  8966         GO TO 1004-CONT.
  8967
  8968     MOVE -1                     TO NOTE2L.
  8969
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 172
* EL156.cbl
  8970     IF CD-RETURN-CODE = '01'
  8971         MOVE ER-8310            TO EMI-ERROR
  8972         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8973         GO TO 1005-CHECK-ERRORS.
  8974
  8975     IF CD-RETURN-CODE = '02'
  8976         MOVE ER-8311            TO EMI-ERROR
  8977         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8978         GO TO 1005-CHECK-ERRORS.
  8979
  8980     IF CD-RETURN-CODE = '03'
  8981         MOVE ER-8312            TO EMI-ERROR
  8982         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8983         GO TO 1005-CHECK-ERRORS.
  8984
  8985     IF CD-RETURN-CODE = '04'
  8986         MOVE ER-8313            TO EMI-ERROR
  8987         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8988         GO TO 1005-CHECK-ERRORS.
  8989
  8990     IF CD-RETURN-CODE = '05'
  8991         MOVE ER-8314            TO EMI-ERROR
  8992         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8993         GO TO 1005-CHECK-ERRORS.
  8994
  8995     IF CD-RETURN-CODE = '06'
  8996         MOVE ER-8315            TO EMI-ERROR
  8997         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8998         GO TO 1005-CHECK-ERRORS.
  8999
  9000     IF CD-RETURN-CODE = 'E1'
  9001         MOVE ER-8316            TO EMI-ERROR
  9002         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9003         GO TO 1005-CHECK-ERRORS.
  9004
  9005     IF CD-RETURN-CODE = 'N1'
  9006         MOVE ER-8317            TO EMI-ERROR
  9007         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9008         GO TO 1005-CHECK-ERRORS.
  9009
  9010 1004-CONT.
  9011     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9012
  9013     ADD +1 TO W-EOB-NDX.
  9014     GO TO 1004-CHECK-EACH-EOB.
  9015
  9016 1004-CHECK-DUP-EOB.
  9017     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9018         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9019                               PI-AT-EOB-CODE (3) OR
  9020                               PI-AT-EOB-CODE (4) OR
  9021                               PI-AT-EOB-CODE (5)))
  9022                  OR
  9023        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9024         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9025                               PI-AT-EOB-CODE (4) OR
  9026                               PI-AT-EOB-CODE (5)))
  9027                  OR
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 173
* EL156.cbl
  9028        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9029         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9030                               PI-AT-EOB-CODE (5)))
  9031                  OR
  9032        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9033         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9034            MOVE ER-8000            TO EMI-ERROR
  9035            MOVE AL-UABON           TO NOTE2A
  9036            MOVE -1                 TO NOTE2L
  9037            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9038            GO TO 1005-CHECK-ERRORS.
  9039
  9040 1005-CHECK-ERRORS.
  9041*    IF PI-COMPANY-ID NOT = 'DMD'
  9042        GO TO 1006-CHECK-ERRORS.
  9043
  9044*********  DMD CODE START ******************
  9045*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9046*       GO TO 1006-CHECK-ERRORS.
  9047*
  9048*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9049*
  9050*    COMPUTE W-PAYMENT-TOTAL
  9051*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9052*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9053*               AND
  9054*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9055*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9056*          MOVE ER-0967    TO EMI-ERROR
  9057*          MOVE -1         TO PMTTYPEL
  9058*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9059*
  9060*    GO TO 1006-CHECK-ERRORS.
  9061*********  DMD CODE END ******************
  9062
  9063 1006-CHECK-ERRORS.
  9064     IF NOT EMI-NO-ERRORS
  9065        GO TO 2000-EDIT-DONE.
  9066
  9067
  9068* EXEC CICS HANDLE CONDITION
  9069*        NOTFND(1950-NOT-FOUND)
  9070*    END-EXEC.
  9071*    MOVE '"$I                   ! '' #00008773' TO DFHEIV0
  9072     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9074     MOVE X'2720233030303038373733' TO DFHEIV0(25:11)
  9075     CALL 'kxdfhei1' USING DFHEIV0
  9076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9077
  9078
  9079     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9080     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9081     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9082     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9083     MOVE 'MSTR'                 TO FILE-SWITCH.
  9084
  9085     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 174
* EL156.cbl
  9086
  9087     IF PI-COMPANY-ID = 'DMD'
  9088         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9089
  9090     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9091        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9092           MOVE ER-0873    TO EMI-ERROR
  9093           MOVE -1                  TO PROOFDTL
  9094           MOVE AL-UABON            TO PROOFDTA
  9095           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9096        END-IF
  9097     END-IF
  9098     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9099         IF PI-PMTTYPE = '5' OR '6'
  9100             NEXT SENTENCE
  9101         ELSE
  9102             MOVE ER-0555             TO EMI-ERROR
  9103             MOVE -1                  TO PMTTYPEL
  9104             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9105
  9106     IF CL-LAST-CLOSE-REASON = '2'
  9107         IF CL-CLAIM-STATUS = 'C'
  9108             MOVE ER-0760        TO  EMI-ERROR
  9109             MOVE -1             TO  PMTTYPEL
  9110             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9111
  9112     IF PI-ACTIVITY-CODE = 9
  9113         MOVE ER-3538            TO  EMI-ERROR
  9114         MOVE -1                 TO  PMTTYPEL
  9115         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9116
  9117     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9118         GO TO 1008-READ-CERT.
  9119**********************AIG LOGIC STARTS *********************
  9120     IF CL-CERT-PRIME = 'INCOMPLETE'
  9121         MOVE ER-3540            TO  EMI-ERROR
  9122         MOVE -1                 TO  PMTTYPEL
  9123         MOVE AL-UABON           TO  PMTTYPEA
  9124         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9125         GO TO 2000-EDIT-DONE.
  9126
  9127     IF PI-PMTTYPE = '4'
  9128         IF PI-EPYAMT IS NEGATIVE
  9129             IF PI-ECHECKNO-CR = 'CR'
  9130                 NEXT SENTENCE
  9131             ELSE
  9132                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9133
  9134     IF PI-PMTTYPE = '4'
  9135         IF PI-ECHECKNO-CR = 'CR'
  9136             IF PI-EPYAMT IS NEGATIVE
  9137                 NEXT SENTENCE
  9138             ELSE
  9139                 MOVE ER-0834    TO  EMI-ERROR
  9140                 MOVE -1         TO  EPYAMTL
  9141                 MOVE AL-UNBON   TO  EPYAMTA
  9142                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9143
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 175
* EL156.cbl
  9144     IF PI-PMTTYPE = '4'
  9145         IF PI-EPYAMT IS NEGATIVE
  9146             IF PI-OFFLINE = 'Y'
  9147                 NEXT SENTENCE
  9148             ELSE
  9149                 MOVE 'Y'        TO  PI-OFFLINE
  9150                                     WS-OFFLINE
  9151                                     OFFLINEO
  9152                 MOVE AL-UANON   TO  OFFLINEA.
  9153
  9154     IF PI-PMTTYPE = '4'
  9155         IF PI-EPYAMT IS NEGATIVE
  9156             IF PI-CASH = 'Y'
  9157                 NEXT SENTENCE
  9158             ELSE
  9159                 MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9160                 MOVE AL-UANON   TO  CASHA
  9161                 GO TO 1007-DEFAULT-AIG-CHECKNO.
  9162
  9163     IF PI-CASH NOT = 'Y' AND 'N'
  9164          IF PI-OFFLINE = 'Y'  AND
  9165             PI-ECHECKNO-CR = 'CR'
  9166               MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9167               MOVE AL-UANON     TO  CASHA
  9168               GO TO 1007-DEFAULT-AIG-CHECKNO.
  9169
  9170     IF PI-CASH NOT = 'Y' AND 'N'
  9171         IF PI-PMTTYPE = '5' OR '6'
  9172             MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9173             MOVE AL-UANON       TO  CASHA
  9174             GO TO 1007-DEFAULT-AIG-CHECKNO.
  9175
  9176     IF PI-CASH NOT = 'Y' AND 'N'
  9177        IF CL-ASSOCIATES = 'N' OR 'A'
  9178            MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9179            MOVE AL-UANON        TO  CASHA
  9180        ELSE
  9181            MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9182            MOVE AL-UANON        TO  CASHA.
  9183
  9184     IF PI-PMTTYPE = '5' OR '6'
  9185         IF PI-CASH = 'N'
  9186             MOVE ER-0819        TO  EMI-ERROR
  9187             MOVE AL-UANON       TO  CASHA
  9188             MOVE -1             TO  CASHL
  9189             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9190
  9191     IF CL-ASSOCIATES = 'N' OR 'A'
  9192        IF CASHI = 'N'
  9193         MOVE ER-3537            TO  EMI-ERROR
  9194         MOVE AL-UANON           TO  CASHA
  9195         MOVE -1                 TO  CASHL
  9196         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9197
  9198 1007-DEFAULT-AIG-CHECKNO.
  9199
  9200     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9201         MOVE ER-3532            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 176
* EL156.cbl
  9202         MOVE -1                 TO  PMTTYPEL
  9203         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9204**********************AIG LOGIC ENDS ***********************
  9205
  9206 1008-READ-CERT.
  9207
  9208     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9209     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9210     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9211     MOVE CL-CERT-STATE          TO CERT-STATE.
  9212     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9213     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9214     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9215     MOVE 'CERT'                 TO FILE-SWITCH.
  9216
  9217     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9218
  9219     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9220         MOVE CM-LF-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT
  9221     ELSE
  9222         MOVE CM-AH-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT.
  9223
  9224*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9225*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9226
  9227     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9228         MOVE ER-0458            TO EMI-ERROR
  9229         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9230
  9231     IF CL-INCURRED-DT NOT < WS-EXP-DT
  9232         MOVE ER-0459            TO EMI-ERROR
  9233         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9234
  9235     IF CL-REPORTED-DT = LOW-VALUES
  9236        MOVE ER-0530             TO EMI-ERROR
  9237        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9238
  9239     IF PI-COMPANY-ID = 'NCL'
  9240        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9241            MOVE ER-0770            TO EMI-ERROR
  9242            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9243
  9244     IF PI-COMPANY-ID = 'NCL'
  9245        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9246            MOVE ER-0737            TO EMI-ERROR
  9247            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9248
  9249     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9250         MOVE ER-0768            TO  EMI-ERROR
  9251         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9252
  9253     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9254         MOVE ER-0769            TO  EMI-ERROR
  9255         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9256
  9257     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9258         GO TO 1020-DO-LIFE-EDITS
  9259     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 177
* EL156.cbl
  9260         GO TO 1030-DO-AH-EDITS.
  9261
  9262 1010-GENERAL-ERROR.
  9263     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9264
  9265     IF EMI-MESSAGE-FORMATTED
  9266         MOVE -1                 TO PMTTYPEL.
  9267
  9268 1010-EXIT.
  9269     EXIT.
  9270
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 178
* EL156.cbl
  9272 1020-DO-LIFE-EDITS.
  9273     IF CM-LF-BENEFIT-CD = '00'
  9274         IF PI-PMTTYPE = '5' OR '6'
  9275             MOVE ER-0658        TO EMI-ERROR
  9276             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9277         ELSE
  9278             MOVE ER-1775        TO EMI-ERROR
  9279             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9280
  9281     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9282         MOVE ER-0460            TO EMI-ERROR
  9283         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9284
  9285     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9286     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9287     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9288     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9289     MOVE '4'                    TO  CNTL-REC-TYPE.
  9290     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9291     MOVE 'BENE'                 TO  FILE-SWITCH.
  9292     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9293     IF NO-BENEFIT-FOUND
  9294         GO TO 1950-NOT-FOUND.
  9295
  9296     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9297
  9298     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9299         IF PI-PMTTYPE = '4'
  9300             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9301                PI-LF-COVERAGE-TYPE = 'P'
  9302                 NEXT SENTENCE
  9303             ELSE
  9304                 MOVE ER-0461        TO EMI-ERROR
  9305                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9306         ELSE
  9307            NEXT SENTENCE
  9308     ELSE
  9309         IF PI-PMTTYPE = '2'
  9310            IF NOT CM-O-B-COVERAGE
  9311              AND CM-LF-CURRENT-STATUS = '7'
  9312                MOVE ER-0462     TO EMI-ERROR
  9313                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9314
  9315     IF PI-PMTTYPE = '2'
  9316         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9317            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9318             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9319             MOVE ER-0730            TO  EMI-ERROR
  9320             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9321             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
  9322
  9323     IF PI-PMTTYPE = '2'
  9324         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9325            PI-LF-COVERAGE-TYPE = 'P'
  9326             IF CL-PAID-THRU-DT = CL-INCURRED-DT
  9327                 MOVE ER-0462    TO  EMI-ERROR
  9328                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9329
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 179
* EL156.cbl
  9330     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  9331       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
  9332         MOVE ER-0466            TO EMI-ERROR
  9333         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9334
  9335     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
  9336         IF PI-PMTTYPE = '3'
  9337             MOVE 0436           TO EMI-ERROR
  9338             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9339             GO TO 1045-EDIT-PAYEE-ADDR
  9340         ELSE
  9341             GO TO 1045-EDIT-PAYEE-ADDR.
  9342
  9343     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9344        PI-LF-COVERAGE-TYPE = 'P'
  9345         IF PI-PMTTYPE = '3'
  9346             MOVE ER-0436          TO  EMI-ERROR
  9347             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9348         ELSE
  9349             NEXT SENTENCE
  9350     ELSE
  9351         IF PI-PMTTYPE = '1' OR '3'
  9352             MOVE ER-0436            TO EMI-ERROR
  9353             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9354*
  9355     IF PI-COMPANY-ID = 'CID' AND
  9356        CL-CERT-STATE = 'SC'  AND
  9357        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  9358           MOVE ER-0879    TO  EMI-ERROR
  9359           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9360     END-IF.
  9361     IF PI-COMPANY-ID = 'AHL' AND
  9362        CL-CERT-STATE = 'SC'  AND
  9363        (CM-LF-BENEFIT-CD = '5I' OR '6J')
  9364           MOVE ER-0879    TO  EMI-ERROR
  9365           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9366     END-IF.
  9367
  9368     GO TO 1045-EDIT-PAYEE-ADDR.
  9369
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 180
* EL156.cbl
  9371 1030-DO-AH-EDITS.
  9372     IF CM-AH-BENEFIT-CD = '00'
  9373         IF PI-PMTTYPE = '5' OR '6'
  9374             MOVE ER-0658        TO EMI-ERROR
  9375             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9376         ELSE
  9377             MOVE ER-1775        TO EMI-ERROR
  9378             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9379
  9380     IF CL-TOTAL-PAID-AMT = ZEROS
  9381         IF PI-PMTTYPE = '4'
  9382             MOVE ER-0438        TO EMI-ERROR
  9383             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9384
  9385     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
  9386         IF PI-PMTTYPE = '3'
  9387             MOVE ER-0463        TO EMI-ERROR
  9388             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9389         ELSE
  9390             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
  9391              AND CM-LF-CURRENT-STATUS = '7'
  9392                 MOVE ER-0465    TO EMI-ERROR
  9393                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9394
  9395     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9396         IF PI-PMTTYPE = '3'
  9397             MOVE ER-0464        TO EMI-ERROR
  9398             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9399         ELSE
  9400             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
  9401                 MOVE ER-0469    TO EMI-ERROR
  9402                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9403
  9404     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9405         IF PI-PMTTYPE = '3'
  9406             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
  9407                 MOVE ER-0467    TO EMI-ERROR
  9408                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9409             ELSE
  9410                 NEXT SENTENCE
  9411         ELSE
  9412             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
  9413                 MOVE ER-0468    TO EMI-ERROR
  9414                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9415
  9416     GO TO 1045-EDIT-PAYEE-ADDR.
  9417
  9418 1040-PMTTYPE-ERROR.
  9419     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9420
  9421     IF EMI-MESSAGE-FORMATTED
  9422         MOVE -1                 TO PMTTYPEL
  9423         MOVE AL-UABON           TO PMTTYPEA.
  9424
  9425 1040-EXIT.
  9426     EXIT.
  9427
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 181
* EL156.cbl
  9429 1045-EDIT-PAYEE-ADDR.
  9430
  9431     IF PI-OFFLINE = 'N' AND
  9432        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
  9433           < PI-PAYEE-SEQ-NUM)
  9434        OR
  9435         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
  9436         (PI-PAYEE-TYPE = 'B')                 AND
  9437         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
  9438        OR
  9439         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
  9440           < PI-PAYEE-SEQ-NUM)
  9441        OR
  9442         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
  9443           < PI-PAYEE-SEQ-NUM)
  9444        OR
  9445         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
  9446           < PI-PAYEE-SEQ-NUM)
  9447        OR
  9448         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
  9449           < PI-PAYEE-SEQ-NUM)
  9450        OR
  9451         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
  9452           < PI-PAYEE-SEQ-NUM))
  9453             MOVE ER-0437        TO EMI-ERROR
  9454             MOVE -1             TO PAYEEL
  9455             MOVE AL-UABON       TO PAYEEA
  9456             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9457
  9458     IF PI-OFFLINE    = 'N' AND
  9459        PI-PAYEE-TYPE = 'B' AND
  9460        PI-PAYEE-SEQ  = '0'
  9461         PERFORM 7920-READ-BENE THRU 7920-EXIT
  9462         IF BENE-FOUND-SW = 'N'
  9463             MOVE ER-0437        TO EMI-ERROR
  9464             MOVE -1             TO PAYEEL
  9465             MOVE AL-UABON       TO PAYEEA
  9466             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9467
  9468     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9469        IF PI-OFFLINE    = 'N'  AND
  9470           PI-PAYEE-TYPE = 'B'  AND
  9471           PI-PAYEE-SEQ  = '9'
  9472             PERFORM 7920-READ-BENE THRU 7920-EXIT
  9473             IF BENE-FOUND-SW = 'N'
  9474                MOVE ER-0437        TO EMI-ERROR
  9475                MOVE -1             TO PAYEEL
  9476                MOVE AL-UABON       TO PAYEEA
  9477                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9478
  9479*    IF PI-COMPANY-ID = 'CRI'
  9480*        IF CL-CLAIM-TYPE = 'L'
  9481*            MOVE 'N'                TO  WS-GROUPED
  9482*                                        PI-GROUPED
  9483*                                        GROUPEDI
  9484*            MOVE AL-UANON           TO  GROUPEDA
  9485*            GO TO 1050-EDIT-CHECK-NO
  9486*        ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 182
* EL156.cbl
  9487*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
  9488*            IF WS-GROUP-1 = 'C'
  9489*                NEXT SENTENCE
  9490*            ELSE
  9491*                MOVE 'N'            TO  WS-GROUPED
  9492*                                        PI-GROUPED
  9493*                                        GROUPEDI
  9494*                MOVE AL-UANON       TO  GROUPEDA
  9495*                GO TO 1050-EDIT-CHECK-NO.
  9496
  9497     IF PI-GROUPED = 'Y'
  9498        IF PI-PAYEE-TYPE = 'B' OR 'A'
  9499           NEXT SENTENCE
  9500        ELSE
  9501           MOVE ER-0437        TO EMI-ERROR
  9502           MOVE -1             TO PAYEEL
  9503           MOVE AL-UABON       TO PAYEEA
  9504           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9505
  9506     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
  9507        (PI-GROUPED    = ' ')
  9508        NEXT SENTENCE
  9509     ELSE
  9510        GO TO 1050-EDIT-CHECK-NO.
  9511
  9512     IF PI-COMPANY-ID = 'CRI'
  9513        MOVE 'N'           TO GROUPEDI
  9514                              PI-GROUPED
  9515                              WS-GROUPED
  9516        MOVE AL-UANON      TO GROUPEDA.
  9517
  9518     IF PI-COMPANY-ID = 'CRI'
  9519        IF PI-PAYEE-TYPE = 'B'
  9520           IF BENE-FOUND-SW = 'Y'
  9521              IF BE-GROUP-CHECKS-Y-N = 'Y'
  9522                 MOVE 'Y'           TO GROUPEDI
  9523                                       PI-GROUPED
  9524                                       WS-GROUPED
  9525                 MOVE AL-UANON      TO GROUPEDA
  9526              ELSE
  9527                 NEXT SENTENCE
  9528           ELSE
  9529              PERFORM 7920-READ-BENE THRU 7920-EXIT
  9530              IF BENE-FOUND-SW = 'Y'
  9531                 IF BE-GROUP-CHECKS-Y-N = 'Y'
  9532                    MOVE 'Y'      TO GROUPEDI
  9533                                     PI-GROUPED
  9534                                     WS-GROUPED
  9535                    MOVE AL-UANON TO GROUPEDA.
  9536
  9537     IF PI-COMPANY-ID NOT = 'CRI'
  9538        GO TO 1050-EDIT-CHECK-NO.
  9539
  9540*************** CRI CODE START ******************
  9541     IF PI-PAYEE-TYPE NOT = 'A'
  9542        GO TO 1050-EDIT-CHECK-NO.
  9543
  9544     MOVE LOW-VALUES             TO ERACCT-KEY.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 183
* EL156.cbl
  9545     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9546     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9547     MOVE PI-GROUPING            TO ACCT-GROUPING.
  9548     MOVE PI-STATE               TO ACCT-STATE.
  9549     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9550     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
  9551     MOVE 'ACCT'                 TO FILE-SWITCH.
  9552
  9553     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
  9554     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
  9555
  9556
  9557* EXEC CICS HANDLE CONDITION
  9558*         NOTFND   (1950-NOT-FOUND)
  9559*         ENDFILE  (1950-NOT-FOUND)
  9560*    END-EXEC.
  9561*    MOVE '"$I''                  ! ( #00009254' TO DFHEIV0
  9562     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9563     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9564     MOVE X'2820233030303039323534' TO DFHEIV0(25:11)
  9565     CALL 'kxdfhei1' USING DFHEIV0
  9566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9567
  9568
  9569
  9570* EXEC CICS STARTBR
  9571*         DATASET   ('ERACCT')
  9572*         RIDFLD    (ERACCT-KEY)
  9573*         GTEQ
  9574*    END-EXEC.
  9575     MOVE 'ERACCT' TO DFHEIV1
  9576     MOVE 0
  9577       TO DFHEIV11
  9578*    MOVE '&,         G          &   #00009259' TO DFHEIV0
  9579     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9580     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9581     MOVE X'2020233030303039323539' TO DFHEIV0(25:11)
  9582     CALL 'kxdfhei1' USING DFHEIV0,
  9583           DFHEIV1,
  9584           ERACCT-KEY,
  9585           DFHEIV99,
  9586           DFHEIV11,
  9587           DFHEIV99
  9588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9589
  9590
  9591 1046-READNEXT-ERACCT.
  9592
  9593
  9594* EXEC CICS READNEXT
  9595*         DATASET   ('ERACCT')
  9596*         RIDFLD    (ERACCT-KEY)
  9597*         SET       (ADDRESS OF ACCOUNT-MASTER)
  9598*    END-EXEC.
  9599     MOVE 'ERACCT' TO DFHEIV1
  9600     MOVE 0
  9601       TO DFHEIV11
  9602*    MOVE '&.S                   )   #00009267' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 184
* EL156.cbl
  9603     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9604     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9605     MOVE X'2020233030303039323637' TO DFHEIV0(25:11)
  9606     CALL 'kxdfhei1' USING DFHEIV0,
  9607           DFHEIV1,
  9608           DFHEIV20,
  9609           DFHEIV99,
  9610           ERACCT-KEY,
  9611           DFHEIV99,
  9612           DFHEIV11,
  9613           DFHEIV99,
  9614           DFHEIV99
  9615     SET ADDRESS OF ACCOUNT-MASTER TO
  9616         DFHEIV20
  9617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9618
  9619
  9620     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
  9621        IF WS-ERACCT-HOLD-RECORD = SPACES
  9622           GO TO 1950-NOT-FOUND
  9623        ELSE
  9624           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
  9625           GO TO 1048-CONTINUE.
  9626
  9627     IF ACCT-EXP-DT = HIGH-VALUES
  9628        NEXT SENTENCE
  9629     ELSE
  9630        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
  9631        GO TO 1046-READNEXT-ERACCT.
  9632
  9633 1048-CONTINUE.
  9634
  9635     IF AM-GROUPED-CHECKS-Y-N = 'Y'
  9636        MOVE 'Y'                 TO GROUPEDI
  9637                                    PI-GROUPED
  9638                                    WS-GROUPED
  9639        MOVE AL-UANON            TO GROUPEDA.
  9640*************** CRI CODE END ******************
  9641
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 185
* EL156.cbl
  9643 1050-EDIT-CHECK-NO.
  9644
  9645     IF PI-OFFLINE = 'Y'
  9646         IF PI-ECHECKNO = SPACES
  9647              MOVE ER-0439        TO EMI-ERROR
  9648              GO TO 1090-CHECK-NO-ERROR
  9649           ELSE
  9650         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9651            IF PI-ECHECKNO-N = 'N' AND
  9652               PI-CASH       = 'Y'
  9653                 MOVE ER-3535        TO EMI-ERROR
  9654                 GO TO 1090-CHECK-NO-ERROR
  9655              ELSE
  9656                 MOVE AL-UANON    TO CHECKNOA
  9657                 GO TO 1100-EDIT-HOLDTIL
  9658          ELSE
  9659            MOVE AL-UANON    TO CHECKNOA
  9660            GO TO 1100-EDIT-HOLDTIL.
  9661
  9662     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9663     MOVE '6'                    TO CNTL-REC-TYPE.
  9664
  9665     IF CONTROL-IS-ACTUAL-CARRIER
  9666         MOVE PI-CARRIER         TO WS-CARR
  9667     ELSE
  9668         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
  9669
  9670     IF PI-COMPANY-ID = 'FIA'
  9671         MOVE PI-CARRIER         TO WS-CARR.
  9672
  9673     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9674     MOVE 0                      TO CNTL-SEQ-NO.
  9675     MOVE 'CARR'                 TO FILE-SWITCH.
  9676
  9677     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
  9678
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 186
* EL156.cbl
  9680     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9681         GO TO 1051-EDIT-CHECKNO-CONT.
  9682
  9683**********************AIG LOGIC STARTS**********************
  9684     IF PI-ECHECKNO = SPACES
  9685         IF CHECK-NO-MANUAL
  9686             MOVE ER-0441        TO EMI-ERROR
  9687             GO TO 1090-CHECK-NO-ERROR
  9688         ELSE
  9689             MOVE AL-UANOF       TO CHECKNOA
  9690             GO TO 1100-EDIT-HOLDTIL.
  9691
  9692     IF PI-ECHECKNO NOT = SPACES
  9693         IF CHECK-NO-MANUAL
  9694             MOVE AL-UANON       TO CHECKNOA
  9695             GO TO 1100-EDIT-HOLDTIL.
  9696
  9697     IF PI-ECHECKNO-CR = 'CR'
  9698        IF PI-OFFLINE = 'Y'
  9699            MOVE AL-UANON       TO CHECKNOA
  9700            GO TO 1100-EDIT-HOLDTIL
  9701        ELSE
  9702            MOVE ER-3534        TO EMI-ERROR
  9703            GO TO 1090-CHECK-NO-ERROR.
  9704
  9705     IF PI-ECHECKNO-N = 'N'
  9706        IF PI-CASH = 'N'
  9707            MOVE AL-UANON       TO CHECKNOA
  9708            GO TO 1100-EDIT-HOLDTIL
  9709        ELSE
  9710            MOVE ER-3535          TO EMI-ERROR
  9711            GO TO 1090-CHECK-NO-ERROR.
  9712
  9713     MOVE ER-0442        TO EMI-ERROR
  9714     GO TO 1090-CHECK-NO-ERROR.
  9715**********************AIG LOGIC ENDS************************
  9716
  9717 1051-EDIT-CHECKNO-CONT.
  9718
  9719     IF PI-COMPANY-ID = 'DMD'
  9720        IF PI-ECHECKNO NOT = SPACES
  9721           IF PI-ECHECKNO (6:2) NOT = 'TP'
  9722              MOVE ER-0442        TO EMI-ERROR
  9723              GO TO 1090-CHECK-NO-ERROR
  9724            ELSE
  9725              GO TO 1100-EDIT-HOLDTIL
  9726          ELSE
  9727           GO TO 1100-EDIT-HOLDTIL.
  9728
  9729     IF PI-ECHECKNO = SPACES
  9730         IF CHECK-NO-MANUAL
  9731             MOVE ER-0441        TO EMI-ERROR
  9732             GO TO 1090-CHECK-NO-ERROR
  9733         ELSE
  9734             MOVE AL-UANOF       TO CHECKNOA
  9735             GO TO 1100-EDIT-HOLDTIL
  9736     ELSE
  9737         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 187
* EL156.cbl
  9738             MOVE AL-UANON       TO CHECKNOA
  9739             GO TO 1100-EDIT-HOLDTIL
  9740         ELSE
  9741             MOVE ER-0442        TO EMI-ERROR
  9742             GO TO 1090-CHECK-NO-ERROR.
  9743
  9744 1090-CHECK-NO-ERROR.
  9745     MOVE -1                     TO CHECKNOL.
  9746     MOVE AL-UABON               TO CHECKNOA.
  9747     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9748
  9749     GO TO 2000-EDIT-DONE.
  9750
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 188
* EL156.cbl
  9752 1100-EDIT-HOLDTIL.
  9753     MOVE AL-UANON               TO HOLDTILA.
  9754
  9755     IF PI-HOLDTIL = ZEROS
  9756        IF PI-OFFLINE = 'Y'
  9757           MOVE ER-0572          TO EMI-ERROR
  9758           GO TO 1105-HOLDTIL-ERROR
  9759        ELSE
  9760           GO TO 1110-EDIT-PAID-FROM.
  9761
  9762     MOVE '4'                    TO DC-OPTION-CODE.
  9763     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
  9764     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9765
  9766     IF DATE-CONVERSION-ERROR
  9767         MOVE ER-0446            TO EMI-ERROR
  9768         GO TO 1105-HOLDTIL-ERROR
  9769     END-IF
  9770     IF PI-OFFLINE = 'Y'
  9771        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
  9772           MOVE ER-0446            TO EMI-ERROR
  9773           GO TO 1105-HOLDTIL-ERROR
  9774        END-IF
  9775     END-IF
  9776
  9777     IF PI-OFFLINE = 'Y'
  9778        GO TO 1110-EDIT-PAID-FROM.
  9779
  9780     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
  9781     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
  9782     MOVE '1'                    TO DC-OPTION-CODE.
  9783     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9784
  9785     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
  9786         MOVE ER-0447            TO EMI-ERROR
  9787         GO TO 1105-HOLDTIL-ERROR.
  9788
  9789     GO TO 1110-EDIT-PAID-FROM.
  9790
  9791 1105-HOLDTIL-ERROR.
  9792     MOVE -1                     TO HOLDTILL.
  9793     MOVE AL-UNBON               TO HOLDTILA.
  9794     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9795
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 189
* EL156.cbl
  9797 1110-EDIT-PAID-FROM.
  9798     MOVE AL-UANON               TO EPYFROMA.
  9799
  9800     IF PI-EPYFROM = ZEROS
  9801         GO TO 1120-CALCULATE-PAID-FROM.
  9802
  9803     IF PI-PMTTYPE = '5' OR '6'
  9804         MOVE ER-0448            TO EMI-ERROR
  9805         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9806         MOVE AL-UNBON           TO EPYFROMA
  9807         MOVE -1                 TO EPYFROML
  9808         GO TO 1150-EDIT-PAID-THRU.
  9809
  9810     MOVE '4'                    TO DC-OPTION-CODE.
  9811     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
  9812     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9813
  9814     IF DATE-CONVERSION-ERROR
  9815         MOVE ER-0449            TO EMI-ERROR
  9816         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9817         MOVE AL-UNBON           TO EPYFROMA
  9818         MOVE -1                 TO EPYFROML
  9819     ELSE
  9820         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
  9821
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 190
* EL156.cbl
  9823 1120-CALCULATE-PAID-FROM.
  9824     IF PI-PMTTYPE = '5' OR '6'
  9825         GO TO 1150-EDIT-PAID-THRU.
  9826
  9827*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9828*       IF PI-PMTTYPE = '4'
  9829*         GO TO 1150-EDIT-PAID-THRU.
  9830
  9831     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9832         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
  9833         MOVE ' '                TO DC-OPTION-CODE
  9834         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9835         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
  9836         GO TO 1145-TEST-PAID-FROM.
  9837
  9838     IF PI-PMTTYPE = '4'
  9839        GO TO 1150-EDIT-PAID-THRU.
  9840
  9841     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
  9842     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9843     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9844     MOVE '5'                    TO CNTL-REC-TYPE.
  9845     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9846     MOVE 'BENE'                 TO FILE-SWITCH.
  9847
  9848     IF WS-BEN-CD = ZEROS
  9849         GO TO 1950-NOT-FOUND.
  9850
  9851     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9852
  9853     IF NO-BENEFIT-FOUND
  9854         GO TO 1950-NOT-FOUND.
  9855
  9856     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
  9857     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
  9858
  9859     IF PI-BEN-DAYS NOT NUMERIC
  9860        MOVE ZEROS               TO PI-BEN-DAYS.
  9861
  9862     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
  9863
  9864     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
  9865        (CL-TOTAL-PAID-AMT > ZEROS)
  9866         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  9867         MOVE '6'                 TO DC-OPTION-CODE
  9868         MOVE +0                  TO DC-ELAPSED-MONTHS
  9869         MOVE +1                  TO DC-ELAPSED-DAYS
  9870         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9871         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
  9872         GO TO 1145-TEST-PAID-FROM.
  9873
  9874******************************************************************
  9875****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
  9876****** SPECIAL ENTERED DATE.
  9877******************************************************************
  9878
  9879     IF PI-AIGFROM = ZEROS
  9880         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 191
* EL156.cbl
  9881
  9882     MOVE AL-UANON TO AIGFROMA.
  9883
  9884     MOVE '4'                    TO DC-OPTION-CODE.
  9885     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
  9886     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9887
  9888     IF DATE-CONVERSION-ERROR
  9889         MOVE ER-0449            TO EMI-ERROR
  9890         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9891         MOVE AL-UNBON           TO AIGFROMA
  9892         MOVE -1                 TO AIGFROML
  9893         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
  9894     ELSE
  9895         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
  9896         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
  9897
  9898     GO TO 1140-CONTINUE-PAID-FROM.
  9899
  9900 1130-CONTINUE-PAID-FROM.
  9901
  9902     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
  9903        (CL-TOTAL-PAID-AMT = ZEROS)
  9904           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
  9905
  9906 1140-CONTINUE-PAID-FROM.
  9907
  9908     IF PI-BEN-TYPE = 'R'
  9909         IF PI-BEN-DAYS = ZEROS
  9910             NEXT SENTENCE
  9911         ELSE
  9912         IF PI-COMPANY-ID NOT = 'DMD'
  9913             SUBTRACT 1 FROM PI-BEN-DAYS.
  9914
  9915     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
  9916
  9917     IF PI-COMPANY-ID = 'DMD'
  9918         MOVE -1                 TO DC-ELAPSED-DAYS
  9919         MOVE +0                 TO DC-ELAPSED-MONTHS
  9920         MOVE '6'                TO DC-OPTION-CODE
  9921         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9922         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
  9923         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
  9924                               REMAINDER DC-ELAPSED-DAYS
  9925      ELSE
  9926         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
  9927         MOVE +0                 TO DC-ELAPSED-MONTHS.
  9928
  9929     MOVE '6'                    TO DC-OPTION-CODE.
  9930     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9931     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
  9932
  9933     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
  9934
  9935     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
  9936         MOVE ER-0541            TO EMI-ERROR
  9937         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9938         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 192
* EL156.cbl
  9939         MOVE AL-UNBON           TO EPYFROMA.
  9940
  9941     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
  9942        (PI-BENEFIT-SAVE = '60E')
  9943        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
  9944           (CL-TOTAL-PAID-AMT = ZEROS)
  9945             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
  9946             MOVE 30                  TO DC-ELAPSED-DAYS
  9947             MOVE +0                  TO DC-ELAPSED-MONTHS
  9948             MOVE '6'                 TO DC-OPTION-CODE
  9949             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9950
  9951     IF PI-BEN-TYPE = 'R'
  9952         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
  9953     ELSE
  9954         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
  9955         IF WS-SV-EPYFROM = LOW-VALUES
  9956            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
  9957
  9958     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
  9959         IF WS-USE-AIG-PAYFROM   OR
  9960            WS-AIG-RECALC-PAYFROM
  9961              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
  9962                                      DC-BIN-DATE-1
  9963              MOVE ' '            TO  DC-OPTION-CODE
  9964              MOVE +0             TO  DC-ELAPSED-MONTHS
  9965                                      DC-ELAPSED-DAYS
  9966              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9967              IF NO-CONVERSION-ERROR
  9968                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
  9969
  9970     IF PI-CPYFROM < CL-INCURRED-DT
  9971        MOVE -1                  TO EPYFROML
  9972        MOVE ER-3542             TO EMI-ERROR
  9973        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9974
  9975     IF CM-ENTRY-DT < CL-INCURRED-DT
  9976        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  9977        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
  9978        MOVE +0                     TO DC-ELAPSED-DAYS
  9979        MOVE +0                     TO DC-ELAPSED-MONTHS
  9980        MOVE '1'                    TO DC-OPTION-CODE
  9981        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9982        ELSE
  9983        MOVE ZEROS TO DC-ELAPSED-MONTHS.
  9984
  9985     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
  9986         NEXT SENTENCE
  9987     ELSE
  9988         IF DC-ELAPSED-MONTHS < 2
  9989             MOVE ER-3255        TO EMI-ERROR
  9990             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9991
  9992 1145-TEST-PAID-FROM.
  9993     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
  9994         GO TO 1150-EDIT-PAID-THRU.
  9995
  9996     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 193
* EL156.cbl
  9997         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
  9998         MOVE ' '                TO DC-OPTION-CODE
  9999         MOVE +0                 TO DC-ELAPSED-MONTHS
 10000                                    DC-ELAPSED-DAYS
 10001         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10002         IF NO-CONVERSION-ERROR
 10003             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10004         ELSE
 10005             MOVE SPACES             TO EMI-DATE-FIELD.
 10006
 10007     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10008         IF CL-TOTAL-PAID-AMT = ZEROS
 10009             MOVE ER-3543            TO EMI-ERROR
 10010             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10011             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10012             IF EMI-MESSAGE-FORMATTED
 10013                MOVE -1             TO EPYFROML
 10014                MOVE AL-UNBON       TO EPYFROMA
 10015             ELSE
 10016                NEXT SENTENCE
 10017         ELSE
 10018             MOVE ER-0452            TO EMI-ERROR
 10019             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10020             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10021             IF EMI-MESSAGE-FORMATTED
 10022                MOVE -1             TO EPYFROML
 10023                MOVE AL-UNBON       TO EPYFROMA.
 10024
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 194
* EL156.cbl
 10026 1150-EDIT-PAID-THRU.
 10027
 10028     MOVE AL-UANON               TO EPYTHRUA.
 10029
 10030     IF PI-EPYTHRU = ZEROS
 10031         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10032             GO TO 1200-EDIT-FIND-TOLERANCES
 10033         ELSE
 10034            IF (PI-PMTTYPE = '3') OR
 10035               (PI-PMTTYPE = '2' AND
 10036                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10037               GO TO 1152-CHECK-TYPE
 10038            ELSE
 10039               MOVE ER-0473      TO EMI-ERROR
 10040               GO TO 1170-PAID-THRU-FATAL-ERROR
 10041     ELSE
 10042         IF PI-PMTTYPE = '5' OR '6'
 10043             MOVE ER-0474        TO EMI-ERROR
 10044             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10045
 10046     MOVE '4'                    TO DC-OPTION-CODE.
 10047     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10048     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10049
 10050     IF DATE-CONVERSION-ERROR
 10051         MOVE ER-0475            TO EMI-ERROR
 10052         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10053
 10054     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10055
 10056     IF PI-COMPANY-ID = 'DMD'
 10057         IF PI-PMTTYPE NOT = '2'
 10058                 AND
 10059            WS-EXP-DT > WS-SV-EPYTHRU
 10060             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10061             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10062             MOVE '1'              TO DC-OPTION-CODE
 10063             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10064             IF DATE-CONVERSION-ERROR
 10065                 MOVE ER-0944      TO EMI-ERROR
 10066                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10067             ELSE
 10068                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10069                    DC-ELAPSED-DAYS   = 1
 10070                     MOVE ER-0945  TO EMI-ERROR
 10071                     MOVE -1       TO EPYTHRUL
 10072                     MOVE AL-UABON TO EPYTHRUA
 10073                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10074
 10075     IF PI-PMTTYPE = '4'
 10076         NEXT SENTENCE
 10077     ELSE
 10078         IF WS-SV-EPYTHRU = WS-EXP-DT
 10079             IF PI-PMTTYPE NOT = '2' AND '3'
 10080                 MOVE ER-3541    TO EMI-ERROR
 10081                 MOVE -1         TO PMTTYPEL
 10082                 MOVE AL-UABON   TO PMTTYPEA
 10083                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 195
* EL156.cbl
 10084
 10085     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10086         MOVE ER-0501            TO EMI-ERROR
 10087         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10088
 10089     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10090        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 10091*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10092*              MOVE ER-0540         TO EMI-ERROR
 10093*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10094*              MOVE -1              TO EPYTHRUL
 10095*              MOVE AL-UNBON        TO EPYTHRUA
 10096*          ELSE
 10097*          IF PI-COMPANY-ID = 'DMD'
 10098*              MOVE ER-7540         TO EMI-ERROR
 10099*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10100*              MOVE -1              TO EPYTHRUL
 10101*              MOVE AL-UNBON        TO EPYTHRUA
 10102*          ELSE
 10103               IF PI-PMTTYPE NOT = '2' AND '3'
 10104                  IF PI-COMPANY-ID = '???'
 10105                      MOVE ER-7540  TO EMI-ERROR
 10106                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10107                      MOVE -1       TO EPYTHRUL
 10108                      MOVE AL-UNBON TO EPYTHRUA
 10109                  ELSE
 10110                      MOVE ER-0540  TO EMI-ERROR
 10111                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10112                      MOVE -1       TO EPYTHRUL
 10113                      MOVE AL-UNBON TO EPYTHRUA.
 10114
 10115     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10116            OR
 10117        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10118         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10119            OR
 10120        (PI-CPYFROM NOT = LOW-VALUES AND
 10121         PI-CPYFROM < CL-PAID-THRU-DT)
 10122        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10123
 10124 1152-CHECK-TYPE.
 10125     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10126        OR (PI-PMTTYPE = '5' OR '6')
 10127         GO TO 1160-EDIT-PAID-THRU-AH.
 10128
 10129 1155-EDIT-PAID-THRU-LIFE.
 10130     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10131     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10132     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10133     MOVE '4'                    TO CNTL-REC-TYPE.
 10134     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10135     MOVE 'BENE'                 TO FILE-SWITCH.
 10136
 10137     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10138
 10139     IF NO-BENEFIT-FOUND
 10140         GO TO 1950-NOT-FOUND.
 10141
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 196
* EL156.cbl
 10142     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10143
 10144     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10145
 10146     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10147        PI-LF-COVERAGE-TYPE = 'P'
 10148         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10149         GO TO 1200-EDIT-FIND-TOLERANCES.
 10150
 10151     IF PI-EPYTHRU = ZEROS
 10152        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10153
 10154     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10155         MOVE ER-0476            TO EMI-ERROR
 10156         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10157
 10158     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10159     MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10160     MOVE +0                    TO DC-ELAPSED-DAYS.
 10161     MOVE '6'                   TO DC-OPTION-CODE.
 10162     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10163
 10164     IF (NO-CONVERSION-ERROR AND
 10165         WS-SPECIAL-CALC-CD = 'C')
 10166        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10167            MOVE ER-0657 TO EMI-ERROR
 10168            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10169
 10170     IF PI-COMPANY-ID = 'NCL'
 10171         IF WS-SPECIAL-CALC-CD = 'C' AND
 10172            CM-LF-CRITICAL-PERIOD = +0
 10173             MOVE ER-0844       TO EMI-ERROR
 10174             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10175
 10176     GO TO 1200-EDIT-FIND-TOLERANCES.
 10177
 10178 1160-EDIT-PAID-THRU-AH.
 10179     IF PI-EPYTHRU = ZEROS
 10180        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10181                                    WS-SV-EPYTHRU
 10182     ELSE
 10183        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10184
 10185     IF WS-SV-EPYTHRU < PI-CPYFROM
 10186         MOVE ER-0508            TO EMI-ERROR
 10187         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10188
 10189     IF PI-PMTTYPE = '3'
 10190        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10191         IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10192             MOVE ER-0477        TO EMI-ERROR
 10193             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 10194         ELSE
 10195             NEXT SENTENCE
 10196     ELSE
 10197         IF WS-SV-EPYTHRU > WS-EXP-DT
 10198             MOVE ER-0557        TO EMI-ERROR
 10199             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 197
* EL156.cbl
 10200
 10201     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10202         PI-PMTTYPE NOT = '3'
 10203         MOVE ER-0541        TO EMI-ERROR
 10204         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10205
 10206     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 10207        (PI-PMTTYPE NOT = '3')
 10208         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10209             MOVE ER-0478        TO EMI-ERROR
 10210             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10211
 10212     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10213        (PI-PMTTYPE NOT = '4')
 10214         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10215             MOVE ER-0479        TO EMI-ERROR
 10216             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10217
 10218     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10219         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10220             MOVE ER-0545        TO EMI-ERROR
 10221             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10222
 10223     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10224         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10225             MOVE ER-0481        TO EMI-ERROR
 10226             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10227
 10228*    IF PI-COMPANY-ID = 'NCL'
 10229*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10230*           CM-AH-CRITICAL-PERIOD = +0
 10231*            MOVE ER-0844        TO  EMI-ERROR
 10232*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10233
 10234     IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10235        (WS-SPECIAL-CALC-CD NOT = 'C')
 10236          GO TO 1200-EDIT-FIND-TOLERANCES.
 10237
 10238     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10239     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10240     MOVE '1'        TO DC-OPTION-CODE.
 10241     MOVE +0         TO DC-ELAPSED-DAYS
 10242                        DC-ELAPSED-MONTHS.
 10243     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10244
 10245*    IF NO-CONVERSION-ERROR
 10246*       COMPUTE WS-CRIT-PERIOD-DAYS =
 10247*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10248*       IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 10249*           MOVE ER-0657 TO EMI-ERROR
 10250*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10251
 10252     GO TO 1200-EDIT-FIND-TOLERANCES.
 10253
 10254 1165-PAID-THRU-ERROR.
 10255     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10256
 10257     IF EMI-MESSAGE-FORMATTED
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 198
* EL156.cbl
 10258         MOVE -1                 TO EPYTHRUL
 10259         MOVE AL-UNBON           TO EPYTHRUA.
 10260
 10261 1165-EXIT.
 10262     EXIT.
 10263
 10264 1166-CHECK-ALL-TRLRS.
 10265
 10266     IF PI-PMTTYPE = '4'
 10267        GO TO 1166-TRLR-EXIT.
 10268
 10269     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 10270
 10271     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 10272        WS-SV-EPYFROM = LOW-VALUES
 10273          GO TO 1166-END-CHECK.
 10274
 10275
 10276* EXEC CICS HANDLE CONDITION
 10277*        ENDFILE   (1166-END-CHECK)
 10278*        NOTFND    (1166-END-CHECK)
 10279*    END-EXEC.
 10280*    MOVE '"$''I                  ! ) #00009928' TO DFHEIV0
 10281     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10283     MOVE X'2920233030303039393238' TO DFHEIV0(25:11)
 10284     CALL 'kxdfhei1' USING DFHEIV0
 10285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10286
 10287
 10288     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 10289     MOVE +100                   TO TRLR-SEQ-NO.
 10290
 10291
 10292* EXEC CICS STARTBR
 10293*         DATASET    ('ELTRLR')
 10294*         RIDFLD     (ELTRLR-KEY)
 10295*         GTEQ
 10296*    END-EXEC.
 10297     MOVE 'ELTRLR' TO DFHEIV1
 10298     MOVE 0
 10299       TO DFHEIV11
 10300*    MOVE '&,         G          &   #00009936' TO DFHEIV0
 10301     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10302     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10303     MOVE X'2020233030303039393336' TO DFHEIV0(25:11)
 10304     CALL 'kxdfhei1' USING DFHEIV0,
 10305           DFHEIV1,
 10306           ELTRLR-KEY,
 10307           DFHEIV99,
 10308           DFHEIV11,
 10309           DFHEIV99
 10310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10311
 10312
 10313     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10314
 10315 1166-READ-TRLR-NEXT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 199
* EL156.cbl
 10316
 10317
 10318* EXEC CICS READNEXT
 10319*         DATASET    ('ELTRLR')
 10320*         RIDFLD     (ELTRLR-KEY)
 10321*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10322*    END-EXEC.
 10323     MOVE 'ELTRLR' TO DFHEIV1
 10324     MOVE 0
 10325       TO DFHEIV11
 10326*    MOVE '&.S                   )   #00009946' TO DFHEIV0
 10327     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10328     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10329     MOVE X'2020233030303039393436' TO DFHEIV0(25:11)
 10330     CALL 'kxdfhei1' USING DFHEIV0,
 10331           DFHEIV1,
 10332           DFHEIV20,
 10333           DFHEIV99,
 10334           ELTRLR-KEY,
 10335           DFHEIV99,
 10336           DFHEIV11,
 10337           DFHEIV99,
 10338           DFHEIV99
 10339     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10340         DFHEIV20
 10341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10342
 10343
 10344     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 10345        TRLR-CARRIER  = MSTR-CARRIER  AND
 10346        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 10347        TRLR-CERT-NO  = MSTR-CERT-NO
 10348          NEXT SENTENCE
 10349      ELSE
 10350          GO TO 1166-END-CHECK.
 10351
 10352* **  BYPASS ALL NON-PAYMENT TRAILERS
 10353
 10354     IF AT-TRAILER-TYPE = '2'
 10355        NEXT SENTENCE
 10356     ELSE
 10357        GO TO 1166-READ-TRLR-NEXT.
 10358
 10359* **  BYPASS ALL NON-PARTIAL PAYMENTS
 10360
 10361     IF AT-PAYMENT-TYPE = '1' OR '2'
 10362        NEXT SENTENCE
 10363     ELSE
 10364        GO TO 1166-READ-TRLR-NEXT.
 10365
 10366* **  BYPASS ALL VOID PAYMENTS
 10367
 10368     IF AT-VOID-DT NOT = LOW-VALUES
 10369        GO TO 1166-READ-TRLR-NEXT.
 10370
 10371     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 10372        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 10373          GO TO 1166-READ-TRLR-NEXT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 200
* EL156.cbl
 10374
 10375     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 10376         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 10377            OR
 10378        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 10379         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 10380        NEXT SENTENCE
 10381     ELSE
 10382         IF CL-TOTAL-PAID-AMT > ZEROS
 10383             MOVE ER-0502            TO EMI-ERROR
 10384             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10385             MOVE -1                 TO EPYTHRUL
 10386             MOVE AL-UNBON           TO EPYTHRUA.
 10387
 10388     GO TO 1166-READ-TRLR-NEXT.
 10389
 10390 1166-END-CHECK.
 10391
 10392     IF WS-BROWSE-TRLR-SW = 'Y'
 10393
 10394* EXEC CICS ENDBR
 10395*            DATASET   ('ELTRLR')
 10396*       END-EXEC.
 10397     MOVE 'ELTRLR' TO DFHEIV1
 10398     MOVE 0
 10399       TO DFHEIV11
 10400*    MOVE '&2                    $   #00010001' TO DFHEIV0
 10401     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10402     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10403     MOVE X'2020233030303130303031' TO DFHEIV0(25:11)
 10404     CALL 'kxdfhei1' USING DFHEIV0,
 10405           DFHEIV1,
 10406           DFHEIV11,
 10407           DFHEIV99
 10408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10409
 10410
 10411     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10412
 10413 1166-TRLR-EXIT.
 10414     EXIT.
 10415
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 201
* EL156.cbl
 10417 1170-PAID-THRU-FATAL-ERROR.
 10418     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10419
 10420     MOVE -1                     TO EPYTHRUL.
 10421     MOVE AL-UNBON               TO EPYTHRUA.
 10422
 10423 1200-EDIT-FIND-TOLERANCES.
 10424
 10425* EXEC CICS HANDLE CONDITION
 10426*        ENDFILE(1950-NOT-FOUND)
 10427*        NOTFND (1950-NOT-FOUND)
 10428*    END-EXEC.
 10429*    MOVE '"$''I                  ! * #00010018' TO DFHEIV0
 10430     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10431     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10432     MOVE X'2A20233030303130303138' TO DFHEIV0(25:11)
 10433     CALL 'kxdfhei1' USING DFHEIV0
 10434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10435
 10436
 10437     IF PI-PROCESSOR-ID = 'LGXX'
 10438        GO TO 1240-FIND-ACCT-TOLERANCES.
 10439
 10440     MOVE 'N'                    TO FOUND-TOL-SW.
 10441     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10442     MOVE '2'                    TO CNTL-REC-TYPE.
 10443     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 10444     MOVE +0                     TO CNTL-SEQ-NO.
 10445     MOVE 'PROC'                 TO FILE-SWITCH.
 10446
 10447     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10448
 10449     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 10450     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 10451                                    PI-MAX-PMT-TOL.
 10452     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 10453
 10454     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 10455         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 10456
 10457     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 10458     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 10459                                    PI-MAX-LF-PMT-TOL.
 10460
 10461     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 10462         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 10463
 10464     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 10465                                    PI-MAX-EXP-PMT.
 10466
 10467 1240-FIND-ACCT-TOLERANCES.
 10468
 10469     IF WS-PMT-TOL NOT = +0
 10470         MOVE 'Y'                TO FOUND-TOL-SW.
 10471
 10472     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10473         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 10474         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 202
* EL156.cbl
 10475         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 10476         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 10477         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 10478         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 10479     ELSE
 10480         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 10481         MOVE PI-CARRIER             TO ACCT-CARRIER
 10482         MOVE PI-GROUPING            TO ACCT-GROUPING
 10483         MOVE PI-STATE               TO ACCT-STATE
 10484         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 10485         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10486
 10487     MOVE 'ACCT'                 TO FILE-SWITCH.
 10488
 10489     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10490     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10491
 10492
 10493* EXEC CICS HANDLE CONDITION
 10494*         NOTFND   (1950-NOT-FOUND)
 10495*         ENDFILE  (1950-NOT-FOUND)
 10496*    END-EXEC.
 10497*    MOVE '"$I''                  ! + #00010078' TO DFHEIV0
 10498     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10499     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10500     MOVE X'2B20233030303130303738' TO DFHEIV0(25:11)
 10501     CALL 'kxdfhei1' USING DFHEIV0
 10502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10503
 10504
 10505
 10506* EXEC CICS STARTBR
 10507*        DATASET('ERACCT')
 10508*        RIDFLD (ERACCT-KEY)
 10509*        GTEQ
 10510*    END-EXEC.
 10511     MOVE 'ERACCT' TO DFHEIV1
 10512     MOVE 0
 10513       TO DFHEIV11
 10514*    MOVE '&,         G          &   #00010083' TO DFHEIV0
 10515     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10516     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10517     MOVE X'2020233030303130303833' TO DFHEIV0(25:11)
 10518     CALL 'kxdfhei1' USING DFHEIV0,
 10519           DFHEIV1,
 10520           ERACCT-KEY,
 10521           DFHEIV99,
 10522           DFHEIV11,
 10523           DFHEIV99
 10524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10525
 10526
 10527 1245-FIND-ACCT-TOLERANCES-LOOP.
 10528
 10529
 10530* EXEC CICS READNEXT
 10531*        DATASET('ERACCT')
 10532*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 203
* EL156.cbl
 10533*        RIDFLD (ERACCT-KEY)
 10534*    END-EXEC.
 10535     MOVE 'ERACCT' TO DFHEIV1
 10536     MOVE 0
 10537       TO DFHEIV11
 10538*    MOVE '&.S                   )   #00010091' TO DFHEIV0
 10539     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10540     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10541     MOVE X'2020233030303130303931' TO DFHEIV0(25:11)
 10542     CALL 'kxdfhei1' USING DFHEIV0,
 10543           DFHEIV1,
 10544           DFHEIV20,
 10545           DFHEIV99,
 10546           ERACCT-KEY,
 10547           DFHEIV99,
 10548           DFHEIV11,
 10549           DFHEIV99,
 10550           DFHEIV99
 10551     SET ADDRESS OF ACCOUNT-MASTER TO
 10552         DFHEIV20
 10553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10554
 10555
 10556     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10557        IF WS-ERACCT-HOLD-RECORD = SPACES
 10558           GO TO 1950-NOT-FOUND
 10559        ELSE
 10560           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10561           GO TO 1250-CONTINUE.
 10562
 10563     IF ACCT-EXP-DT = HIGH-VALUES
 10564        NEXT SENTENCE
 10565     ELSE
 10566        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10567        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 10568
 10569 1250-CONTINUE.
 10570
 10571     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 10572
 10573     IF FOUND-TOL-SW = 'N'
 10574         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 10575
 10576********* 1260-FIND-STATE-TOLERANCES.
 10577
 10578     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10579     MOVE PI-STATE               TO WS-ST-ACCESS.
 10580     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 10581     MOVE '3'                    TO CNTL-REC-TYPE.
 10582     MOVE +0                     TO CNTL-SEQ-NO.
 10583     MOVE 'STAT'                 TO FILE-SWITCH.
 10584
 10585     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10586
 10587     IF WS-PMT-TOL = +0
 10588         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 10589
 10590     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 204
* EL156.cbl
 10591     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 10592     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 10593     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 10594     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 10595
 10596     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 AND
 10597        PI-VFY-2ND-BENE = 'Y' AND
 10598        PI-PAYEE-TYPE <> 'B'
 10599           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 10600     END-IF.
 10601
 10602     IF PI-PMTTYPE      = '2'  AND
 10603        PI-SPLIT-PMT-SW = 'Y'  AND
 10604        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 10605          MOVE ER-3530                TO EMI-ERROR
 10606          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10607
 10608********* 1280-FIND-BENEFIT-TOLERANCES.
 10609
 10610     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10611        OR (PI-PMTTYPE = '5' OR '6')
 10612         GO TO 1300-FIND-CARR-TOLERANCES.
 10613
 10614     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10615     MOVE '4'                    TO CNTL-REC-TYPE.
 10616     MOVE +0                     TO CNTL-SEQ-NO.
 10617     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10618     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10619     MOVE 'BENE'                 TO FILE-SWITCH.
 10620
 10621     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10622
 10623     IF NO-BENEFIT-FOUND
 10624         GO TO 1950-NOT-FOUND.
 10625
 10626     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 10627     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 10628     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 10629
 10630
 10631* EXEC CICS HANDLE CONDITION
 10632*        NOTFND(1950-NOT-FOUND)
 10633*    END-EXEC.
 10634*    MOVE '"$I                   ! , #00010171' TO DFHEIV0
 10635     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10636     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10637     MOVE X'2C20233030303130313731' TO DFHEIV0(25:11)
 10638     CALL 'kxdfhei1' USING DFHEIV0
 10639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10640
 10641
 10642 1300-FIND-CARR-TOLERANCES.
 10643     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10644     MOVE '6'                    TO CNTL-REC-TYPE.
 10645
 10646     IF CONTROL-IS-ACTUAL-CARRIER
 10647         MOVE PI-CARRIER               TO WS-CARR
 10648     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 205
* EL156.cbl
 10649         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10650
 10651     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10652     MOVE +0                     TO CNTL-SEQ-NO.
 10653     MOVE 'CARR'                 TO FILE-SWITCH.
 10654
 10655     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 10656
 10657     IF WS-DAYS-TOL = +0
 10658         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 10659
 10660     IF WS-PMT-TOL = +0
 10661         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 10662
 10663     IF WS-MAX-DAYS-TOL = +0
 10664         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 10665
 10666     IF WS-MAX-PMT-TOL = +0
 10667         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 10668                                    PI-MAX-PMT-TOL.
 10669
 10670     IF WS-MAX-LF-PMT-TOL = +0
 10671        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 10672                                    PI-MAX-LF-PMT-TOL.
 10673
 10674     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 10675
 10676********* 1320-FIND-COMP-TOLERANCES.
 10677
 10678     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10679     MOVE '1'                    TO CNTL-REC-TYPE.
 10680     MOVE SPACES                 TO CNTL-ACCESS.
 10681     MOVE +0                     TO CNTL-SEQ-NO.
 10682     MOVE 'COMP'                 TO FILE-SWITCH.
 10683
 10684     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10685
 10686     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 10687     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 10688
 10689     IF WS-PMT-TOL NOT = +0
 10690        IF WS-TOL-SEVERITY NOT = ' '
 10691         GO TO 1360-EDIT-DAYS.
 10692
 10693     IF WS-PMT-TOL = +0
 10694         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 10695
 10696     IF WS-TOL-SEVERITY = ' '
 10697         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 10698
 10699 1360-EDIT-DAYS.
 10700     IF PI-PMTTYPE NOT = '4'
 10701        IF PI-EDAYS NEGATIVE OR
 10702           PI-EPYAMT NEGATIVE
 10703          MOVE ER-0513             TO EMI-ERROR
 10704          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10705          MOVE -1                  TO PMTTYPEL.
 10706
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 206
* EL156.cbl
 10707     IF PI-PMTTYPE = '5' OR '6'
 10708        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 10709
 10710     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10711        IF PI-PMTTYPE = '4'
 10712          MOVE PI-EDAYS          TO PI-CDAYS.
 10713
 10714     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10715         GO TO 1440-COMPUTE-LIFE-REMAINING.
 10716
 10717     IF PI-PMTTYPE = '4'
 10718        MOVE PI-EDAYS            TO PI-CDAYS
 10719        GO TO 1400-EDIT-PAYMENT.
 10720
 10721     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 10722        GO TO 1500-EDIT-EXPENSES.
 10723
 10724*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10725*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 10726*          CM-AH-BENEFIT-CD = '23'              AND
 10727*          CL-CERT-STATE    = '04'              AND
 10728*         (PI-PMTTYPE = '1' OR '2' OR '3')
 10729*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 10730*            GO TO 1362-CHECK-MAX-DAYS.
 10731
 10732     IF PI-EDAYS = ZEROS
 10733*        IF PI-COMPANY-ID = 'DMD'
 10734*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 10735*            MOVE -1             TO DC-ELAPSED-DAYS
 10736*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 10737*            MOVE '6'            TO DC-OPTION-CODE
 10738*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10739*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 10740*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 10741*            MOVE '1'            TO DC-OPTION-CODE
 10742*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10743*            IF NO-CONVERSION-ERROR
 10744*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 10745*                                 + DC-ODD-DAYS-OVER
 10746*               MOVE 6           TO EDAYSL
 10747*               MOVE AL-UNNON    TO EDAYSA
 10748*            ELSE
 10749*                NEXT SENTENCE
 10750*       ELSE
 10751            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 10752            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 10753            MOVE '1'             TO DC-OPTION-CODE
 10754            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10755            IF NO-CONVERSION-ERROR
 10756                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 10757                ADD 1                 TO PI-EDAYS
 10758                MOVE AL-UNNON         TO EDAYSA.
 10759
 10760*    IF PI-COMPANY-ID = 'DMD'
 10761*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10762*        MOVE -1                 TO DC-ELAPSED-DAYS
 10763*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 10764*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 207
* EL156.cbl
 10765*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10766*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10767*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 10768*        MOVE '1'                TO DC-OPTION-CODE
 10769*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10770*    ELSE
 10771         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 10772         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 10773         MOVE '1'                TO DC-OPTION-CODE.
 10774         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10775
 10776     IF NO-CONVERSION-ERROR
 10777        IF PI-COMPANY-ID = 'DMD'
 10778            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 10779                             + DC-ODD-DAYS-OVER
 10780        ELSE
 10781            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 10782            ADD 1                TO PI-CDAYS.
 10783
 10784     IF DC-ODD-DAYS-OVER NOT = ZEROS
 10785        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 10786        ADD 1                    TO EXPENSE-MONTH-SAVE.
 10787
 10788     IF PI-EDAYS NOT NUMERIC
 10789         MOVE ER-0491            TO EMI-ERROR
 10790         GO TO 1370-DAYS-ERROR.
 10791
 10792     IF CL-NO-OF-PMTS-MADE = 0
 10793        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 10794        AND CL-CERT-STATE = 'MI'
 10795        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 10796            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 10797     END-IF.
 10798
 10799 1362-CHECK-MAX-DAYS.
 10800
 10801     IF WS-MAX-DAYS-TOL = +999
 10802         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 10803
 10804     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 10805         IF PI-EDAYS = ZEROS
 10806             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 10807         ELSE
 10808             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 10809
 10810     IF WS-MAX-DAYS-TOL NOT = ZERO
 10811        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 10812           PI-CDAYS > WS-MAX-DAYS-TOL
 10813             MOVE ER-0492          TO EMI-ERROR
 10814             GO TO 1370-DAYS-ERROR.
 10815
 10816 1365-SKIP-MAX-DAYS-EDIT.
 10817     IF PI-EDAYS = ZEROS
 10818        GO TO 1400-EDIT-PAYMENT.
 10819
 10820     IF WS-DAYS-TOL NOT = ZERO
 10821        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 10822           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 208
* EL156.cbl
 10823                MOVE ER-0493     TO EMI-ERROR
 10824                GO TO 1370-DAYS-ERROR.
 10825
 10826     GO TO 1400-EDIT-PAYMENT.
 10827
 10828 1370-DAYS-ERROR.
 10829     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10830
 10831     IF EMI-MESSAGE-FORMATTED
 10832         MOVE -1                 TO EDAYSL
 10833         MOVE AL-UABON           TO EDAYSA.
 10834
 10835     GO TO 1400-EDIT-PAYMENT.
 10836
 10837 1380-EDIT-EXPENSE-PMT-AMT.
 10838     IF PI-PMTTYPE = '5' OR '6'
 10839         NEXT SENTENCE
 10840     ELSE
 10841         GO TO 1400-EDIT-PAYMENT.
 10842
 10843     IF WS-MAX-EXP-PMT NOT = ZEROS
 10844        IF PI-EPYAMT > WS-MAX-EXP-PMT
 10845            MOVE ER-3529            TO EMI-ERROR
 10846            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 10847
 10848     GO TO 1500-EDIT-EXPENSES.
 10849
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 209
* EL156.cbl
 10851
 10852 1390-CHECK-PAYMENT-DAYS.
 10853
 10854     IF PI-EDAYS = 0
 10855         MOVE PI-CDAYS TO WS-PD-DAYS
 10856     ELSE
 10857         MOVE PI-EDAYS TO WS-PD-DAYS
 10858     END-IF.
 10859
 10860     IF CM-AH-BENEFIT-CD = '20' OR '21'
 10861         IF WS-PD-DAYS = 14
 10862            GO TO 1390-EXIT
 10863         END-IF
 10864     END-IF.
 10865
 10866     IF PI-COMPANY-ID = 'AHL'  AND
 10867        CM-AH-BENEFIT-CD = '1K'
 10868         IF WS-PD-DAYS = 14
 10869            GO TO 1390-EXIT
 10870         END-IF
 10871     END-IF.
 10872
 10873     IF WS-PD-DAYS < 30
 10874         MOVE ER-3549              TO EMI-ERROR
 10875         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 10876     END-IF.
 10877
 10878 1390-EXIT.
 10879      EXIT.
 10880
 10881 1400-EDIT-PAYMENT.
 10882*    IF PI-COMPANY-ID = 'DMD'
 10883*       IF CL-CERT-NO (5:2) = '69' OR '70'
 10884*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 10885
 10886     IF PI-PMTTYPE NOT = '4'
 10887        GO TO 1405-CALC-PAYMENT.
 10888
 10889     IF PI-EDAYS NOT NUMERIC
 10890         MOVE PI-EPYAMT           TO PI-CPYAMT
 10891         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 10892         GO TO 1430-CHECK-AH-TOLERANCE.
 10893
 10894*    IF PI-COMPANY-ID = 'FIA'
 10895*       IF CERT-ACCOUNT = '0000011043'
 10896*        COMPUTE PI-DAILY-RATE ROUNDED =
 10897*                      (CM-AH-BENEFIT-AMT * 13) / 365
 10898*        COMPUTE PI-CPYAMT ROUNDED =
 10899*                          PI-DAILY-RATE * PI-EDAYS
 10900*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 10901*        GO TO 1430-CHECK-AH-TOLERANCE.
 10902
 10903     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 10904         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 10905         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 10906         GO TO 1420-CHECK-AIG-BENEFIT.
 10907
 10908     IF WS-CALC-METHOD = '2' OR  '5'
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 210
* EL156.cbl
 10909         COMPUTE PI-DAILY-RATE ROUNDED =
 10910                        (CM-AH-BENEFIT-AMT * 12) / 365
 10911         COMPUTE PI-CPYAMT ROUNDED =
 10912                           PI-DAILY-RATE * PI-EDAYS
 10913        GO TO 1420-CHECK-AIG-BENEFIT.
 10914
 10915     IF WS-CALC-METHOD = '3'
 10916         COMPUTE PI-DAILY-RATE =
 10917                         (CM-AH-BENEFIT-AMT * 12) / 365
 10918         COMPUTE PI-CPYAMT ROUNDED =
 10919                           PI-DAILY-RATE * PI-EDAYS
 10920        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 211
* EL156.cbl
 10922*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 10923
 10924****************************************************************
 10925****************************************************************
 10926*                  CALCULATED FROM      PAYMENT      PAYMENT
 10927*   DATES           DATE ROUTINE        OPT  1       OPT  6
 10928* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 10929*1-01-83  1-15-83    0    15     15        15           15
 10930*1-01-83  1-30-83    0    30     30        30           30
 10931*1-01-83  1-31-83    1     0     31        30           30
 10932*1-01-83  2-01-83    1     1     32        31           31
 10933*1-01-83  2-15-83    1    15     46        45           45
 10934*1-01-83  2-28-83    2     0     59        60           60
 10935*1-01-83  3-01-83    2     1     60        61           61
 10936*1-01-83  3-31-83    3     0     90        90           90
 10937*1-15-83  1-31-83    0    17     17        17           16
 10938*1-15-83  2-01-83    0    18     18        18           17
 10939*1-15-83  2-28-83    1    14     45        44           46
 10940*1-21-83  3-09-83    1    20     48        50           49
 10941*2-05-83  3-06-83    1     2     30        32           32
 10942*2-05-83  3-23-83    1    19     47        49           49
 10943*2-15-83  2-28-83    0    14     14        14           16
 10944*2-15-83  3-01-83    0    15     15        15           17
 10945*2-21-83  3-19-83    0    27     27        27           29
 10946*2-21-83  3-20-83    1     0     28        30           30
 10947*2-21-83  4-10-83    1    18     49        30           50
 10948*2-21-83  5-19-83    2    27     88        87           89
 10949*2-21-83  5-22-83    3     2     91        92           92
 10950*3-21-83  5-19-83    1    30     60        60           59
 10951****************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 212
* EL156.cbl
 10953 1405-CALC-PAYMENT.
 10954     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 10955     MOVE ' '                    TO DC-OPTION-CODE.
 10956     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10957     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 10958     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 10959
 10960     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 10961     MOVE ' '                    TO DC-OPTION-CODE.
 10962     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10963     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 10964     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 10965
 10966     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 10967     MOVE -1                     TO DC-ELAPSED-DAYS.
 10968     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 10969     MOVE '6'                    TO DC-OPTION-CODE.
 10970     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10971     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 10972
 10973     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 10974     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 10975     MOVE '1'                    TO DC-OPTION-CODE.
 10976     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10977
 10978     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 10979     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 10980     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 10981
 10982******************************************************************
 10983*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 10984*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 10985*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 10986******************************************************************
 10987
 10988     IF WS-CALC-METHOD = '1'           AND
 10989        DC-ELAPSED-MONTHS > ZERO AND
 10990        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 10991        WDF-DAY > WDT-DAY
 10992          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 10993          MOVE ZEROS               TO DC-ELAPSED-DAYS
 10994          MOVE -1                  TO DC-ELAPSED-MONTHS
 10995          MOVE '6'                 TO DC-OPTION-CODE
 10996          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10997          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 10998          COMPUTE WS-SAVE-ODD-DAYS =
 10999          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11000          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11001
 11002     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11003     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11004     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11005
 11006     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11007     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11008
 11009*    IF PI-COMPANY-ID = 'FIA'
 11010*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 213
* EL156.cbl
 11011*        COMPUTE PI-DAILY-RATE ROUNDED =
 11012*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11013*        COMPUTE PI-CPYAMT ROUNDED =
 11014*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11015*        GO TO 1420-CHECK-AIG-BENEFIT.
 11016
 11017*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11018*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11019*          CM-AH-BENEFIT-CD = '23'               AND
 11020*          CL-CERT-STATE    = '04'               AND
 11021*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11022*            COMPUTE WS-DAILY-RATE ROUNDED =
 11023*                               CM-AH-BENEFIT-AMT / 30
 11024*            COMPUTE PI-CPYAMT ROUNDED =
 11025*                               (WS-DAILY-RATE * PI-CDAYS)
 11026*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11027*            GO TO 1420-CHECK-AIG-BENEFIT.
 11028
 11029     IF WS-CALC-METHOD = '1'
 11030         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11031         COMPUTE PI-CPYAMT ROUNDED =
 11032             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11033             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11034         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11035         GO TO 1420-CHECK-AIG-BENEFIT.
 11036
 11037     IF WS-CALC-METHOD = '2'
 11038         COMPUTE PI-DAILY-RATE ROUNDED =
 11039                          (CM-AH-BENEFIT-AMT * 12) / 365
 11040         COMPUTE PI-CPYAMT ROUNDED =
 11041             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11042             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11043         GO TO 1420-CHECK-AIG-BENEFIT.
 11044
 11045     IF WS-CALC-METHOD = '4'
 11046         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11047         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11048         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11049         COMPUTE PI-CPYAMT ROUNDED =
 11050                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11051         GO TO 1420-CHECK-AIG-BENEFIT.
 11052
 11053     IF WS-CALC-METHOD = '5'
 11054         COMPUTE PI-DAILY-RATE ROUNDED =
 11055                            (CM-AH-BENEFIT-AMT * 12) / 365
 11056         COMPUTE PI-CPYAMT ROUNDED =
 11057                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11058         GO TO 1420-CHECK-AIG-BENEFIT.
 11059
 11060     IF WS-CALC-METHOD NOT = '3'
 11061        GO TO 1410-CHECK-PAYMENT.
 11062
 11063******   CALCULATION METHOD  3  ROUTINE
 11064     COMPUTE PI-DAILY-RATE =
 11065                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11066
 11067******CHECK TO SEE IF WITHIN SAME MONTH
 11068     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 214
* EL156.cbl
 11069        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11070                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11071         GO TO 1420-CHECK-AIG-BENEFIT.
 11072
 11073******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11074     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11075             SAVE-ODD-DAYS-OVER = ZEROS
 11076      COMPUTE PI-CPYAMT  ROUNDED =
 11077                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11078      GO TO 1420-CHECK-AIG-BENEFIT.
 11079
 11080******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11081******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11082     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11083        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11084        IF WDF-MONTH > 12
 11085           ADD 1                 TO WDF-YEAR
 11086           SUBTRACT 12         FROM WDF-MONTH.
 11087
 11088******CONVERT THE NEW FROM MONTH TO BINARY
 11089     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11090        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11091        MOVE '4'              TO DC-OPTION-CODE
 11092        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11093        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11094
 11095     IF WDF-MONTH = WDT-MONTH AND
 11096        WDF-YEAR  = WDT-YEAR
 11097          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11098                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11099                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11100        ELSE
 11101          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11102          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11103          COMPUTE PI-CPYAMT ROUNDED =
 11104       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11105       +
 11106       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11107       +
 11108       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11109
 11110     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 215
* EL156.cbl
 11112 1410-CHECK-PAYMENT.
 11113******PAYMENT OPTION 6
 11114******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11115     IF SAVE-ELAPSED-MONTHS > ZERO
 11116        IF SAVE-ODD-DAYS-OVER = ZEROS
 11117           GO TO 1412-CHECK-TO-DAY
 11118        ELSE
 11119           IF WDF-DAY > WDT-DAY
 11120              IF WDF-MONTH = 02
 11121                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11122                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11123                  GO TO 1412-CHECK-TO-DAY
 11124              ELSE
 11125                  IF FROM-DAYS-IN-MONTH = 31
 11126                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11127                     GO TO 1412-CHECK-TO-DAY
 11128                  ELSE
 11129                     GO TO 1412-CHECK-TO-DAY
 11130           ELSE
 11131               GO TO 1412-CHECK-TO-DAY.
 11132
 11133     IF WDF-MONTH NOT = WDT-MONTH
 11134        IF WDF-MONTH = 02
 11135           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11136           IF WDF-DAY = 29
 11137              ADD 1              TO SAVE-ODD-DAYS-OVER
 11138           ELSE
 11139              ADD 2              TO SAVE-ODD-DAYS-OVER
 11140        ELSE
 11141           IF FROM-DAYS-IN-MONTH = 31
 11142              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11143
 11144 1412-CHECK-TO-DAY.
 11145        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11146           IF WDT-DAY = 28
 11147              ADD 2              TO SAVE-ODD-DAYS-OVER
 11148           ELSE
 11149              IF WDT-DAY = 29
 11150                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11151              ELSE
 11152                 NEXT SENTENCE
 11153        ELSE
 11154           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11155              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11156
 11157     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11158     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11159     COMPUTE PI-CPYAMT ROUNDED =
 11160         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11161         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11162
 11163     GO TO 1420-CHECK-AIG-BENEFIT.
 11164
 11165 1415-CHECK-LEAP-YEAR.
 11166     IF FROM-DAYS-IN-MONTH = 29
 11167        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11168
 11169 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 216
* EL156.cbl
 11170     EXIT.
 11171
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 217
* EL156.cbl
 11173 1420-CHECK-AIG-BENEFIT.
 11174
 11175     IF WS-SPECIAL-CALC-CD = 'Q'
 11176         GO TO 1425-CHECK-WHOLE-MONTH.
 11177
 11178*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11179*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11180*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11181*       (PI-PMTTYPE = '1' OR '2')
 11182*        NEXT SENTENCE
 11183*    ELSE
 11184         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11185         GO TO 1430-CHECK-AH-TOLERANCE.
 11186
 11187******************AIG LOGIC STARTS**********************
 11188*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 11189*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 11190*    MOVE ER-3533      TO EMI-ERROR.
 11191*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11192*    GO TO 1430-CHECK-AH-TOLERANCE.
 11193******************AIG LOGIC ENDS************************
 11194
 11195 1425-CHECK-WHOLE-MONTH.
 11196******************************************************************
 11197****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 11198****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 11199****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 11200****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 11201****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 11202****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 11203****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 11204****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 11205****          PAID * MONTHLY BENEFIT.                         ****
 11206******************************************************************
 11207
 11208     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 11209
 11210     IF CL-NO-OF-PMTS-MADE > +0
 11211         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 11212
 11213     IF PI-CDAYS < WS-BEN-DAYS
 11214         GO TO 1430-CHECK-AH-TOLERANCE.
 11215
 11216     IF PI-CDAYS = WS-BEN-DAYS
 11217         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 11218         GO TO 1430-CHECK-AH-TOLERANCE.
 11219
 11220*    IF PI-COMPANY-ID = 'ACM'
 11221*       NEXT SENTENCE
 11222*    ELSE
 11223        GO TO 1425-NOT-ACM-W15C.
 11224
 11225*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 11226*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 11227*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 11228*    MOVE '6'                    TO  DC-OPTION-CODE.
 11229*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11230*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 218
* EL156.cbl
 11231*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 11232*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 11233*       MOVE '1'                 TO  DC-OPTION-CODE
 11234*       MOVE +0                  TO  DC-ELAPSED-DAYS
 11235*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 11236*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11237*       IF NO-CONVERSION-ERROR
 11238*          IF (DC-ELAPSED-MONTHS > +0) OR
 11239*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 11240*             NEXT SENTENCE
 11241*          ELSE
 11242*             MOVE +0            TO  PI-CPYAMT
 11243*             MOVE ER-0846       TO  EMI-ERROR
 11244*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11245*             GO TO 1430-CHECK-AH-TOLERANCE
 11246*       ELSE
 11247*           MOVE ER-0846         TO  EMI-ERROR
 11248*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11249*           GO TO 1430-CHECK-AH-TOLERANCE.
 11250*
 11251*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 11252*       ADD +1 TO DC-ELAPSED-MONTHS.
 11253*
 11254*    COMPUTE PI-CPYAMT ROUNDED =
 11255*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11256*
 11257*    GO TO 1430-CHECK-AH-TOLERANCE.
 11258
 11259 1425-NOT-ACM-W15C.
 11260
 11261     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 11262     MOVE '6'                        TO  DC-OPTION-CODE.
 11263     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11264     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 11265
 11266     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11267     IF NO-CONVERSION-ERROR
 11268         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 11269     ELSE
 11270         MOVE ER-0846                TO  EMI-ERROR
 11271         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11272         GO TO 1430-CHECK-AH-TOLERANCE.
 11273
 11274     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 11275     MOVE '1'                        TO  DC-OPTION-CODE.
 11276     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11277     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11278     IF NO-CONVERSION-ERROR
 11279         IF DC-ODD-DAYS-OVER = +0
 11280             NEXT SENTENCE
 11281         ELSE
 11282             MOVE ER-0846            TO  EMI-ERROR
 11283             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11284             GO TO 1430-CHECK-AH-TOLERANCE
 11285     ELSE
 11286         MOVE ER-0846                TO  EMI-ERROR
 11287         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11288         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 219
* EL156.cbl
 11289
 11290     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 11291         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 11292
 11293     GO TO 1430-CHECK-AH-TOLERANCE.
 11294
 11295 1425-CONT-WHOLE-MONTH-PMTS.
 11296******************************************************************
 11297****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 11298****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 11299****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 11300******************************************************************
 11301
 11302     IF PI-COMPANY-ID = 'ACM'
 11303        NEXT SENTENCE
 11304     ELSE
 11305        IF DC-ODD-DAYS-OVER = +0
 11306            NEXT SENTENCE
 11307        ELSE
 11308            MOVE ER-0845            TO  EMI-ERROR
 11309            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11310            GO TO 1430-CHECK-AH-TOLERANCE.
 11311
 11312     COMPUTE PI-CPYAMT ROUNDED =
 11313                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11314
 11315 1430-CHECK-AH-TOLERANCE.
 11316     IF PI-PMT-APPR-SW = 'G'
 11317         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 11318
 11319*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11320*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 11321*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 11322*
 11323*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11324*      IF WDF-MONTH = 02
 11325*        IF SAVE-ELAPSED-MONTHS = 0
 11326*          NEXT SENTENCE
 11327*        ELSE
 11328*          IF SAVE-ODD-DAYS-OVER > 0
 11329*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11330*            COMPUTE WS-PMT-MOS ROUNDED =
 11331*                (SAVE-ODD-DAYS-OVER / +30) + .005
 11332*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11333*                                     WS-PMT-MOS
 11334*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 11335*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 11336*          ELSE
 11337*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11338*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 11339*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11340*                                     WS-PMT-MOS.
 11341
 11342     IF WS-MAX-PMT-TOL NOT = ZERO
 11343        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 11344           (PI-CPYAMT > WS-MAX-PMT-TOL)
 11345            MOVE ER-0494         TO  EMI-ERROR
 11346            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 220
* EL156.cbl
 11347            GO TO 1500-EDIT-EXPENSES.
 11348
 11349 1430-CONT-CHECK-AH-TOLERANCE.
 11350
 11351     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 11352        GO TO 1500-EDIT-EXPENSES.
 11353
 11354     IF CM-O-B-COVERAGE
 11355        GO TO 1500-EDIT-EXPENSES.
 11356
 11357     IF PI-COMPANY-ID = 'NCL'
 11358       IF FOUND-TOL-SW = 'Y'
 11359         IF WS-PMT-TOL NOT = ZERO
 11360           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11361              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11362                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 11363                  IF WS-NCL-PMT-OPTION = SPACES
 11364                      MOVE ER-0699 TO EMI-ERROR
 11365                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11366                  ELSE
 11367                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 11368                      NEXT SENTENCE
 11369                  ELSE
 11370                  IF NOT WS-VALID-NCL-OPTION
 11371                      MOVE ER-0699 TO EMI-ERROR
 11372                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11373
 11374     IF WS-PMT-TOL NOT = ZERO
 11375        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11376           ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11377                MOVE ER-0495     TO EMI-ERROR
 11378                PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11379
 11380     GO TO 1500-EDIT-EXPENSES.
 11381
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 221
* EL156.cbl
 11383 1440-COMPUTE-LIFE-REMAINING.
 11384
 11385     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11386        IF PI-PMTTYPE = '4'
 11387          MOVE PI-EPYAMT TO PI-CPYAMT
 11388          GO TO 1460-TEST-TYPE.
 11389
 11390     IF WS-LF-COVERAGE-TYPE = 'L'
 11391        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 11392                          - CL-TOTAL-PAID-AMT
 11393        GO TO 1450-CHECK-MAX.
 11394
 11395     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11396        PI-LF-COVERAGE-TYPE = 'P'
 11397          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 11398                              CM-LF-ITD-DEATH-AMT
 11399          GO TO 1450-CHECK-MAX.
 11400
 11401     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 11402     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 11403     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 11404     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 11405     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 11406     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 11407     MOVE '4'                    TO CP-REM-TERM-METHOD.
 11408     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 11409     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 11410
 11411     PERFORM 9800-LINK-REM-TERM.
 11412
 11413     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 11414     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 11415     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 11416     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 11417     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 11418     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 11419     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 11420     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 11421     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 11422     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 11423     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 11424     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 11425     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 11426     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 11427     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 11428     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 11429
 11430
 11431* EXEC CICS LINK
 11432*       PROGRAM  (LINK-REMAMT)
 11433*       COMMAREA (CALCULATION-PASS-AREA)
 11434*       LENGTH   (CP-COMM-LENGTH)
 11435*    END-EXEC.
 11436*    MOVE '."C                   ''   #00010963' TO DFHEIV0
 11437     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11438     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11439     MOVE X'2020233030303130393633' TO DFHEIV0(25:11)
 11440     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 222
* EL156.cbl
 11441           LINK-REMAMT,
 11442           CALCULATION-PASS-AREA,
 11443           CP-COMM-LENGTH,
 11444           DFHEIV99,
 11445           DFHEIV99,
 11446           DFHEIV99
 11447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11448
 11449
 11450     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 11451
 11452     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 11453     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 11454
 11455     IF PI-COMPANY-ID = 'BOA' AND
 11456        PI-PMTTYPE    = '2'   AND
 11457        PI-OFFLINE    = 'N'
 11458           GO TO 1441-COMPUTE-BOA-INTEREST.
 11459
 11460     IF PI-COMPANY-ID = 'NCL' AND
 11461        PI-PMTTYPE    = '2'   AND
 11462        PI-OFFLINE    = 'N'
 11463          GO TO 1442-COMPUTE-NCL-INTEREST
 11464       ELSE
 11465          GO TO 1445-CONTINUE.
 11466
 11467 1441-COMPUTE-BOA-INTEREST.
 11468     MOVE +0             TO WS-CALC-INT.
 11469
 11470     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 11471     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 11472     MOVE +0             TO DC-ELAPSED-MONTHS
 11473                            DC-ELAPSED-DAYS.
 11474     MOVE '1'            TO DC-OPTION-CODE.
 11475     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11476     IF NO-CONVERSION-ERROR
 11477         NEXT SENTENCE
 11478     ELSE
 11479         GO TO 1445-CONTINUE.
 11480
 11481     IF (PI-INT-RATE NOT > ZEROS)  AND
 11482        (DC-ELAPSED-DAYS > +30)
 11483         MOVE ER-3531            TO EMI-ERROR
 11484         MOVE -1                 TO PINTL
 11485         MOVE AL-UNBON           TO PINTA
 11486         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11487
 11488     IF PI-EPYAMT NOT > ZEROS
 11489         GO TO 1445-CONTINUE.
 11490
 11491     IF (PI-INT-RATE NOT > ZEROS)  OR
 11492        (DC-ELAPSED-DAYS NOT > +30)
 11493         MOVE PI-EPYAMT TO PI-CPYAMT
 11494         GO TO 1441-FORMAT-NOTE.
 11495
 11496     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 11497                                 *  PI-INT-RATE
 11498                                 *  DC-ELAPSED-DAYS
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 223
* EL156.cbl
 11499                                 /  365
 11500                                 /  100.
 11501
 11502     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 11503
 11504 1441-FORMAT-NOTE.
 11505
 11506     MOVE SPACES        TO WS-BOANOTE1.
 11507     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 11508     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 11509     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 11510     MOVE AL-UANON      TO NOTE1A.
 11511
 11512     IF WS-CALC-INT > ZEROS
 11513         MOVE SPACES        TO WS-BOANOTE2
 11514         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 11515         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 11516         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 11517         MOVE AL-UANON      TO NOTE2A.
 11518
 11519     GO TO 1445-CONTINUE.
 11520
 11521 1442-COMPUTE-NCL-INTEREST.
 11522     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11523     MOVE PI-STATE               TO WS-ST-ACCESS.
 11524     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11525     MOVE '3'                    TO CNTL-REC-TYPE.
 11526     MOVE +0                     TO CNTL-SEQ-NO.
 11527     MOVE 'STAT'                 TO FILE-SWITCH.
 11528
 11529     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11530
 11531     MOVE +0                 TO WS-CALC-INT.
 11532
 11533     IF ST-STAT-FROM-INCURRED
 11534         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 11535       ELSE
 11536     IF ST-STAT-FROM-REPORTED
 11537         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 11538       ELSE
 11539         GO TO 1445-CONTINUE.
 11540
 11541     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 11542     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 11543     MOVE +0                 TO DC-ELAPSED-MONTHS
 11544                                DC-ELAPSED-DAYS.
 11545     MOVE '1'                TO DC-OPTION-CODE.
 11546     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11547     IF NO-CONVERSION-ERROR
 11548         NEXT SENTENCE
 11549     ELSE
 11550         GO TO 1445-CONTINUE.
 11551
 11552     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 11553        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 11554         GO TO 1445-CONTINUE.
 11555
 11556     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 224
* EL156.cbl
 11557                                 *  CF-ST-STAT-INTEREST.
 11558
 11559     MOVE SPACES              TO WS-NCLNOTE1.
 11560     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 11561     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 11562     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 11563                                 PI-PMTNOTE1
 11564                                 NOTE1I.
 11565     MOVE AL-UANON            TO NOTE1A.
 11566
 11567     IF WS-CALC-INT > ZEROS
 11568         MOVE SPACES          TO WS-NCLNOTE2
 11569         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 11570         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 11571         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 11572                                 PI-PMTNOTE2
 11573                                 NOTE2I
 11574         MOVE AL-UANON        TO NOTE2A.
 11575
 11576     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 11577
 11578 1445-CONTINUE.
 11579
 11580     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 11581        GO TO 1460-TEST-TYPE.
 11582
 11583     IF CM-O-B-COVERAGE
 11584        GO TO 1460-TEST-TYPE.
 11585
 11586     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 11587         GO TO 1450-CHECK-MAX.
 11588
 11589     IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 11590                      > PI-EPYAMT)
 11591                      OR
 11592        (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 11593                      < PI-EPYAMT)
 11594         MOVE ER-0594            TO EMI-ERROR
 11595         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11596         GO TO 1460-TEST-TYPE.
 11597
 11598 1450-CHECK-MAX.
 11599
 11600     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11601        PI-LF-COVERAGE-TYPE = 'P'
 11602         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 11603                                   CM-LF-ITD-DEATH-AMT
 11604     ELSE
 11605         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 11606                                   CL-TOTAL-PAID-AMT.
 11607
 11608     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 11609          MOVE ER-0543           TO EMI-ERROR
 11610          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11611
 11612 1460-TEST-TYPE.
 11613
 11614     IF PI-PMT-APPR-SW = 'G'
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 225
* EL156.cbl
 11615       NEXT SENTENCE
 11616     ELSE
 11617       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 11618         IF PI-EPYAMT = ZERO
 11619             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 11620                 MOVE ER-0494    TO  EMI-ERROR
 11621                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11622                 GO TO 1500-EDIT-EXPENSES
 11623             ELSE
 11624                 NEXT SENTENCE
 11625         ELSE
 11626             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 11627                 MOVE ER-0494    TO  EMI-ERROR
 11628                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11629                 GO TO 1500-EDIT-EXPENSES.
 11630
 11631     IF PI-PMTTYPE NOT = '2' OR
 11632        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 11633         GO TO 1500-EDIT-EXPENSES.
 11634
 11635     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 11636     MOVE ER-0526                TO EMI-ERROR.
 11637     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11638
 11639     IF EMI-ERROR-NUMBER (1) = '0526'
 11640        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 11641
 11642     IF EMI-ERROR-NUMBER (2) = '0526'
 11643        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 11644
 11645     GO TO 1500-EDIT-EXPENSES.
 11646
 11647 1490-PAYMENT-ERROR.
 11648     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11649
 11650     IF EMI-MESSAGE-FORMATTED
 11651         MOVE -1                 TO EPYAMTL
 11652         MOVE AL-UNBON           TO EPYAMTA.
 11653
 11654 1490-EXIT.
 11655      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 226
* EL156.cbl
 11657 1500-EDIT-EXPENSES.
 11658     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 11659         GO TO 1500-SKIP-ERROR-0556.
 11660
 11661 1500-CONTINUE-ON.
 11662
 11663     IF CM-O-B-COVERAGE
 11664        MOVE ER-0556             TO EMI-ERROR
 11665        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11666
 11667 1500-SKIP-ERROR-0556.
 11668     IF PI-PMTTYPE = '4' OR '5' OR '6'
 11669        IF PI-EEXPENS NOT = ZEROS
 11670           MOVE ER-0524          TO EMI-ERROR
 11671           GO TO 1590-EXPENSE-ERROR
 11672        ELSE
 11673           GO TO 1600-EDIT-RESERVES.
 11674
 11675     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11676     MOVE '6'                    TO CNTL-REC-TYPE.
 11677
 11678     IF CONTROL-IS-ACTUAL-CARRIER
 11679         MOVE PI-CARRIER         TO WS-CARR
 11680     ELSE
 11681         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11682
 11683     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11684     MOVE +0                     TO CNTL-SEQ-NO.
 11685     MOVE 'CARR'                 TO FILE-SWITCH.
 11686
 11687     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11688
 11689     IF EXPENSE-CALC-MANUAL
 11690        GO TO 1600-EDIT-RESERVES.
 11691
 11692     IF DOLLARS-PER-PMT
 11693        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 11694        GO TO 1600-EDIT-RESERVES.
 11695
 11696     IF DOLLARS-PER-MONTH AND
 11697        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 11698       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 11699       GO TO 1600-EDIT-RESERVES.
 11700
 11701     IF PERCENT-OF-PAYMENT
 11702        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 11703
 11704     GO TO 1600-EDIT-RESERVES.
 11705
 11706 1590-EXPENSE-ERROR.
 11707     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11708
 11709     IF EMI-MESSAGE-FORMATTED
 11710        MOVE -1                  TO EEXPENSL
 11711        MOVE AL-UNBON            TO EEXPENSA.
 11712
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 227
* EL156.cbl
 11714 1600-EDIT-RESERVES.
 11715     IF PI-PMTTYPE = '4' OR '5' OR '6'
 11716        IF PI-ERESV = ZEROS
 11717           GO TO 1700-EDIT-EXPENSE-TYPE
 11718        ELSE
 11719           MOVE ER-0525          TO EMI-ERROR
 11720           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 11721           GO TO 1700-EDIT-EXPENSE-TYPE.
 11722
 11723     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11724     MOVE ZEROS                  TO TRLR-SEQ-NO.
 11725     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 11726
 11727     IF NOT AT-MANUAL-RESERVES-USED
 11728        IF PI-ERESV NOT = ZEROS
 11729           MOVE ER-0518          TO EMI-ERROR
 11730           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 11731
 11732     IF AT-MANUAL-RESERVES-USED
 11733        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 11734        GO TO 1700-EDIT-EXPENSE-TYPE.
 11735
 11736     IF AT-FUTURE-RESERVES-USED
 11737        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 11738
 11739     IF AT-FUTURE-RESERVES-USED
 11740        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 11741
 11742     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 11743        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 11744
 11745     IF AT-IBNR-RESERVES-USED
 11746        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 11747
 11748     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 11749     GO TO 1700-EDIT-EXPENSE-TYPE.
 11750
 11751 1690-RESERVE-ERROR.
 11752     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11753
 11754     IF EMI-MESSAGE-FORMATTED
 11755        MOVE AL-UNBON            TO ERESVA
 11756        MOVE -1                  TO ERESVL.
 11757
 11758 1690-EXIT.
 11759      EXIT.
 11760
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 228
* EL156.cbl
 11762 1700-EDIT-EXPENSE-TYPE.
 11763     IF PI-PMTTYPE NOT = '5' AND '6'
 11764        GO TO 2000-EDIT-DONE.
 11765
 11766     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 11767                   '6' OR '7' OR '8' OR '9'
 11768        GO TO 2000-EDIT-DONE.
 11769
 11770 1705-EXPENSE-ERROR.
 11771     MOVE ER-0573                TO EMI-ERROR.
 11772     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11773
 11774     IF EMI-MESSAGE-FORMATTED
 11775        MOVE AL-UABON            TO ETYPEA
 11776        MOVE -1                  TO ETYPEL.
 11777
 11778     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 229
* EL156.cbl
 11780 1950-NOT-FOUND.
 11781     IF FILE-SWITCH = 'MSTR'
 11782        MOVE ER-0204             TO EMI-ERROR.
 11783
 11784     IF FILE-SWITCH = 'CARR'
 11785        MOVE ER-0252             TO EMI-ERROR.
 11786
 11787     IF FILE-SWITCH = 'COMP'
 11788        MOVE ER-0254             TO EMI-ERROR.
 11789
 11790     IF FILE-SWITCH = 'STAT'
 11791        MOVE ER-0149             TO EMI-ERROR.
 11792
 11793     IF FILE-SWITCH = 'PROC'
 11794        MOVE ER-0019             TO EMI-ERROR.
 11795
 11796     IF FILE-SWITCH = 'ACCT'
 11797        MOVE ER-0198             TO EMI-ERROR.
 11798
 11799     IF FILE-SWITCH = 'BENE'
 11800        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11801           MOVE ER-0282          TO EMI-ERROR
 11802        ELSE
 11803           MOVE ER-0283          TO EMI-ERROR.
 11804
 11805     MOVE -1                     TO PMTTYPEL.
 11806     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11807
 11808     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 11809                                     WS-FORCE-CTR.
 11810
 11811     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 11812                                     WS-FATAL-CTR.
 11813
 11814     GO TO 8200-SEND-DATAONLY.
 11815
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 230
* EL156.cbl
 11817 2000-EDIT-DONE.
 11818     IF (WS-SPECIAL-CALC-CD = 'C')
 11819        AND (CM-AH-CRITICAL-PERIOD) > 0
 11820        IF CM-AH-BENEFIT-AMT NOT = ZERO
 11821           IF PI-EPYAMT > ZEROS
 11822              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 11823                 PI-EPYAMT) / CM-AH-BENEFIT-AMT
 11824           ELSE
 11825              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 11826                 PI-CPYAMT) / CM-AH-BENEFIT-AMT
 11827           END-IF
 11828           IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 11829              MOVE ER-0657          TO EMI-ERROR
 11830              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11831           END-IF
 11832        END-IF
 11833     END-IF
 11834     IF PI-HOLDTIL NOT = ZEROS
 11835        MOVE PI-HOLDTIL          TO HOLDTILO
 11836        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 11837
 11838     IF PI-EPYFROM NOT = ZEROS
 11839        MOVE PI-EPYFROM          TO EPYFROMO
 11840        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 11841
 11842     IF PI-EPYTHRU NOT = ZEROS
 11843        MOVE PI-EPYTHRU            TO EPYTHRUO
 11844        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 11845        IF PI-USES-PAID-TO
 11846           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 11847           MOVE '4'                TO DC-OPTION-CODE
 11848           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11849           IF NO-CONVERSION-ERROR
 11850              MOVE +1              TO DC-ELAPSED-DAYS
 11851              MOVE +0              TO DC-ELAPSED-MONTHS
 11852              MOVE '6'             TO DC-OPTION-CODE
 11853              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11854              IF NO-CONVERSION-ERROR
 11855                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 11856
 11857     MOVE PI-EDAYS               TO EDAYSO.
 11858
 11859     IF PI-AIGFROM NOT = ZEROS
 11860        MOVE PI-AIGFROM          TO AIGFROMO
 11861        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 11862
 11863     MOVE PI-EPYAMT              TO EPYAMTO.
 11864     MOVE PI-ERESV               TO ERESVO.
 11865     MOVE PI-EEXPENS             TO EEXPENSO.
 11866
 11867     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11868     MOVE SPACES                 TO DC-OPTION-CODE.
 11869     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11870
 11871     IF DATE-CONVERSION-ERROR
 11872        MOVE SPACES              TO CPYFROMI
 11873     ELSE
 11874        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 231
* EL156.cbl
 11875        IF PI-EPYFROM = ZEROS
 11876           MOVE AL-UANON             TO EPYFROMA
 11877           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 11878           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 11879
 11880     IF PI-USES-PAID-TO
 11881        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 11882        MOVE +1                            TO DC-ELAPSED-DAYS
 11883        MOVE +0                            TO DC-ELAPSED-MONTHS
 11884        MOVE '6'                           TO DC-OPTION-CODE
 11885        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11886        IF NO-CONVERSION-ERROR
 11887           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 11888           IF PI-EPYTHRU = ZEROS
 11889              MOVE AL-UANON                TO EPYTHRUA
 11890              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 11891              MOVE ' '                     TO DC-OPTION-CODE
 11892              MOVE +0                      TO DC-ELAPSED-DAYS
 11893                                              DC-ELAPSED-MONTHS
 11894              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11895              IF NO-CONVERSION-ERROR
 11896                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 11897                  GO TO 2001-CONTINUE
 11898              ELSE
 11899                  GO TO 2001-CONTINUE
 11900           ELSE
 11901              GO TO 2001-CONTINUE.
 11902
 11903     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11904     MOVE SPACES                 TO DC-OPTION-CODE.
 11905     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11906
 11907     IF DATE-CONVERSION-ERROR
 11908        MOVE SPACES              TO CPYTHRUI
 11909     ELSE
 11910        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 11911        IF PI-EPYTHRU = ZEROS
 11912           MOVE AL-UANON TO EPYTHRUA
 11913           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 11914           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 11915
 11916 2001-CONTINUE.
 11917
 11918     MOVE PI-CDAYS               TO CDAYSO.
 11919
 11920     IF PI-EDAYS = ZEROS
 11921        MOVE AL-UNNON TO EDAYSA
 11922        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 11923
 11924     MOVE PI-CPYAMT              TO CPYAMTO.
 11925
 11926     IF PI-EPYAMT = ZEROS
 11927        MOVE AL-UNNON            TO EPYAMTA
 11928        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 11929
 11930     MOVE PI-CRESV               TO CRESVO.
 11931     MOVE PI-CEXPENS             TO CEXPENSO.
 11932
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 232
* EL156.cbl
 11933     IF PI-EEXPENS = ZEROS
 11934        MOVE AL-UNNON TO EEXPENSA
 11935        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 11936
 11937     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 11938        AND (CL-CLAIM-TYPE = 'L')
 11939        AND (PI-OFFLINE NOT EQUAL 'Y')
 11940        IF PI-PMTTYPE = '2' OR '4'
 11941           PERFORM 2200-CALC-INTEREST
 11942                                 THRU 2200-EXIT
 11943        END-IF
 11944     END-IF
 11945     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 11946     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 11947     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 11948
 11949     IF EMI-FATAL-CTR = ZEROS
 11950        MOVE 'B'                 TO PI-PASS-SW.
 11951
 11952     IF NOT EMI-MESSAGE-FORMATTED
 11953         MOVE -1                 TO EPYFROML
 11954     ELSE
 11955         IF EMI-ERROR-NUMBER (1) = '0526' AND
 11956            EMI-ERROR-NUMBER (2) = SPACES
 11957             MOVE -1             TO EPYFROML.
 11958
 11959     GO TO 8200-SEND-DATAONLY.
 11960
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 233
* EL156.cbl
 11962 2200-CALC-INTEREST.
 11963     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 11964        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 11965        MOVE '4'                 TO DC-OPTION-CODE
 11966        PERFORM 9700-LINK-DATE-CONVERT
 11967        IF DATE-CONVERSION-ERROR
 11968            MOVE LOW-VALUES      TO CP-PRF-DT
 11969        ELSE
 11970           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 11971        END-IF
 11972     END-IF
 11973     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 11974        IN CLAIM-INT-PASS-AREA
 11975     MOVE CL-CERT-STATE          TO CP-STATE
 11976        IN CLAIM-INT-PASS-AREA
 11977     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 11978     MOVE 'LF'                   TO CP-COVERAGE
 11979     MOVE CL-INCURRED-DT         TO CP-INC-DT
 11980     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 11981     MOVE LOW-VALUES             TO CP-LSTPD-DT
 11982     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 11983     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 11984     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 11985
 11986* EXEC CICS LINK
 11987*       PROGRAM   ('ELCLMI')
 11988*       COMMAREA  (CLAIM-INT-PASS-AREA)
 11989*       LENGTH    (CP-CLAIM-LENGTH)
 11990*    END-EXEC
 11991     MOVE 'ELCLMI' TO DFHEIV1
 11992*    MOVE '."C                   ''   #00011504' TO DFHEIV0
 11993     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11994     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11995     MOVE X'2020233030303131353034' TO DFHEIV0(25:11)
 11996     CALL 'kxdfhei1' USING DFHEIV0,
 11997           DFHEIV1,
 11998           CLAIM-INT-PASS-AREA,
 11999           CP-CLAIM-LENGTH,
 12000           DFHEIV99,
 12001           DFHEIV99,
 12002           DFHEIV99
 12003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12004     MOVE AL-PANOF               TO PINTHA
 12005                                    PINTA
 12006     IF NO-CI-ERROR
 12007        MOVE CP-CLM-INT-AMT      TO PINTO
 12008                                    PI-INT-AMT
 12009        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12010        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12011        MOVE AL-PANOF            TO PINTHA
 12012                                    PINTA
 12013     ELSE
 12014        IF CI-RETURN-CODE = '8'
 12015           MOVE ER-3818          TO EMI-ERROR
 12016           MOVE -1               TO ZINTL
 12017           PERFORM 9900-ERROR-FORMAT
 12018                                 THRU 9900-EXIT
 12019           GO TO 2200-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 234
* EL156.cbl
 12020        ELSE
 12021           MOVE ZEROS            TO PINTO
 12022                                    PI-INT-AMT
 12023                                    PI-INT-DAYS
 12024                                    PI-INT-RATE-USED
 12025        END-IF
 12026     END-IF
 12027     IF PI-INT-AMT NOT = ZEROS
 12028        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12029           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12030           CONTINUE
 12031        ELSE
 12032           MOVE CL-SOC-SEC-NO (1:3)
 12033                                 TO WS-SSN (1:3)
 12034           MOVE CL-SOC-SEC-NO (5:2)
 12035                                 TO WS-SSN (4:2)
 12036           MOVE CL-SOC-SEC-NO (8:4)
 12037                                 TO WS-SSN (6:4)
 12038           IF (WS-SSN NUMERIC)
 12039              AND (WS-SSN NOT = ZEROS)
 12040              CONTINUE
 12041           ELSE
 12042              MOVE ER-2044       TO EMI-ERROR
 12043              PERFORM 9900-ERROR-FORMAT
 12044                                 THRU 9900-EXIT
 12045           END-IF
 12046        END-IF
 12047        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12048        MOVE +51                 TO TRLR-SEQ-NO
 12049
 12050* EXEC CICS READ
 12051*          DATASET  ('ELTRLR')
 12052*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12053*          RIDFLD   (ELTRLR-KEY)
 12054*          RESP     (WS-RESPONSE)
 12055*       END-EXEC
 12056     MOVE 'ELTRLR' TO DFHEIV1
 12057*    MOVE '&"S        E          (  N#00011554' TO DFHEIV0
 12058     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12059     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12060     MOVE X'204E233030303131353534' TO DFHEIV0(25:11)
 12061     CALL 'kxdfhei1' USING DFHEIV0,
 12062           DFHEIV1,
 12063           DFHEIV20,
 12064           DFHEIV99,
 12065           ELTRLR-KEY,
 12066           DFHEIV99,
 12067           DFHEIV99,
 12068           DFHEIV99
 12069     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12070         DFHEIV20
 12071     MOVE EIBRESP  TO WS-RESPONSE
 12072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12073        IF (NOT WS-RESP-NORMAL)
 12074                    OR
 12075           ((WS-RESP-NORMAL)
 12076           AND ((AT-ADDRESS-LINE-1 = SPACES)
 12077           OR (AT-CITY-STATE = SPACES)))
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 235
* EL156.cbl
 12078           MOVE ER-0874          TO EMI-ERROR
 12079           PERFORM 9900-ERROR-FORMAT
 12080                                 THRU 9900-EXIT
 12081        END-IF
 12082     END-IF
 12083     .
 12084 2200-EXIT.
 12085     EXIT.
 12086 3000-MOVE-INPUT-TO-SAVE-AREA.
 12087     IF PMTTYPEL > 0
 12088         MOVE PMTTYPEI           TO WS-PMTTYPE.
 12089
 12090     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 12091
 12092     IF WS-PMTTYPE = '9'
 12093         MOVE 'P'                TO PI-PROVISIONAL-IND
 12094         MOVE '1'                TO WS-PMTTYPE.
 12095
 12096     IF PAYEEL > 0
 12097         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 12098         MOVE PAYEEI             TO WS-PAYEE.
 12099
 12100     IF NOTE1L > +0
 12101         MOVE NOTE1I             TO WS-PMTNOTE1
 12102                                    WS-FLI-PMTNOTE
 12103                                    WS-HAN-PMTNOTE.
 12104
 12105     IF NOTE2L > +0
 12106         MOVE NOTE2I             TO WS-PMTNOTE2.
 12107
 12108     IF OFFLINEL > 0
 12109         MOVE OFFLINEI           TO WS-OFFLINE.
 12110
 12111     IF PROOFDTL > 0
 12112         MOVE PROOFDTI            TO DATE-WORK
 12113         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12114         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 12115         MOVE '4'                 TO DC-OPTION-CODE
 12116         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 12117         IF NO-CONVERSION-ERROR
 12118            MOVE NUM-WORK         TO PROOFDTO
 12119            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 12120            MOVE NUM-WORK         TO WS-PROOF-DATE
 12121         ELSE
 12122            MOVE ZEROS            TO WS-PROOF-DATE
 12123         END-IF
 12124     END-IF.
 12125
 12126     IF EOBYNL > +0
 12127        MOVE EOBYNI              TO WS-PRINT-EOB-YN
 12128     END-IF
 12129     IF GROUPEDL > +0
 12130         MOVE GROUPEDI           TO WS-GROUPED.
 12131
 12132     IF CASHL > +0
 12133        MOVE CASHI               TO WS-CASH.
 12134
 12135     IF LOANNOL > +0
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 236
* EL156.cbl
 12136         MOVE LOANNOI            TO WS-LOAN-NO.
 12137
 12138     IF CHECKNOL > 0
 12139         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 12140
 12141     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12142         IF WS-AIG-CREDIT-ENTERED
 12143             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 12144             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 12145             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 12146             MOVE AL-UANON         TO CHECKNOA.
 12147
 12148     IF HOLDTILL > 0
 12149         MOVE HOLDTILI           TO DATE-WORK
 12150         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12151         MOVE NUM-WORK           TO WS-HOLDTIL.
 12152
 12153     IF ZINTL > +0
 12154
 12155* EXEC CICS BIF DEEDIT
 12156*           FIELD   (ZINTI)
 12157*           LENGTH  (07)
 12158*       END-EXEC
 12159     MOVE 07
 12160       TO DFHEIV11
 12161*    MOVE '@"L                   #   #00011641' TO DFHEIV0
 12162     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12163     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12164     MOVE X'2020233030303131363431' TO DFHEIV0(25:11)
 12165     CALL 'kxdfhei1' USING DFHEIV0,
 12166           ZINTI,
 12167           DFHEIV11
 12168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12169        IF ZINTI NOT NUMERIC
 12170           MOVE ER-0419          TO EMI-ERROR
 12171           PERFORM 9900-ERROR-FORMAT
 12172           MOVE AL-UABON         TO ZINTA
 12173           MOVE -1               TO ZINTL
 12174        ELSE
 12175           MOVE ZINTI            TO CP-INT-RATE
 12176                                    WS-INT-RATE
 12177           MOVE CP-INT-RATE      TO ZINTO
 12178           MOVE AL-UNNON         TO ZINTA
 12179        END-IF
 12180     ELSE
 12181        MOVE ZEROS               TO CP-INT-RATE
 12182     END-IF
 12183     IF EPYFROML > 0
 12184         MOVE EPYFROMI           TO DATE-WORK
 12185         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12186         MOVE NUM-WORK           TO WS-EPYFROM.
 12187
 12188     IF AIGFROML > 0
 12189         MOVE AIGFROMI           TO DATE-WORK
 12190         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12191         MOVE NUM-WORK           TO WS-AIGFROM
 12192     ELSE
 12193         IF (AIGFROMI = LOW-VALUES) AND
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 237
* EL156.cbl
 12194            (PI-AIGFROM NOT = ZEROS)
 12195              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 12196
 12197     IF EPYTHRUL > +0
 12198        MOVE EPYTHRUI           TO DATE-WORK
 12199        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12200        MOVE NUM-WORK           TO WS-EPYTHRU
 12201        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12202        MOVE '4'                TO DC-OPTION-CODE
 12203        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12204        IF NO-CONVERSION-ERROR
 12205           IF PI-USES-PAID-TO
 12206              MOVE '6'                TO DC-OPTION-CODE
 12207              MOVE -1                 TO DC-ELAPSED-DAYS
 12208              MOVE +0                 TO DC-ELAPSED-MONTHS
 12209              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12210              IF NO-CONVERSION-ERROR
 12211                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 12212                 MOVE ' '             TO DC-OPTION-CODE
 12213                 MOVE +0              TO DC-ELAPSED-DAYS
 12214                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12215              IF NO-CONVERSION-ERROR
 12216                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 12217
 12218*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 12219*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 12220     IF EDAYSL > 0
 12221
 12222* EXEC CICS BIF DEEDIT
 12223*            FIELD(EDAYSI)
 12224*            LENGTH(6)
 12225*        END-EXEC
 12226     MOVE 6
 12227       TO DFHEIV11
 12228*    MOVE '@"L                   #   #00011697' TO DFHEIV0
 12229     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12230     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12231     MOVE X'2020233030303131363937' TO DFHEIV0(25:11)
 12232     CALL 'kxdfhei1' USING DFHEIV0,
 12233           EDAYSI,
 12234           DFHEIV11
 12235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12236         MOVE EDAYSI             TO WS-DY-WORK
 12237         IF WS-DY-SIGN = SPACES
 12238            MOVE WS-DY-NUM       TO WS-EDAYS
 12239            ADD 0                TO WS-EDAYS
 12240         ELSE
 12241            MOVE EDAYSI          TO WS-EDAYS
 12242            ADD 0                TO WS-EDAYS.
 12243
 12244*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 12245*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 12246     IF EPYAMTL > 0
 12247
 12248* EXEC CICS BIF DEEDIT
 12249*            FIELD(EPYAMTI)
 12250*            LENGTH(10)
 12251*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 238
* EL156.cbl
 12252     MOVE 10
 12253       TO DFHEIV11
 12254*    MOVE '@"L                   #   #00011712' TO DFHEIV0
 12255     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12256     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12257     MOVE X'2020233030303131373132' TO DFHEIV0(25:11)
 12258     CALL 'kxdfhei1' USING DFHEIV0,
 12259           EPYAMTI,
 12260           DFHEIV11
 12261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12262         MOVE EPYAMTI            TO WS-PY-WORK
 12263         IF WS-PY-SIGN = SPACES
 12264            MOVE WS-PY-NUM       TO WS-EPYAMT
 12265            ADD 0                TO WS-EPYAMT
 12266         ELSE
 12267            MOVE EPYAMTI         TO WS-EPYAMT
 12268            ADD 0                TO WS-EPYAMT.
 12269
 12270     IF ERESVL > 0
 12271
 12272* EXEC CICS BIF DEEDIT
 12273*            FIELD(ERESVI)
 12274*            LENGTH(9)
 12275*        END-EXEC
 12276     MOVE 9
 12277       TO DFHEIV11
 12278*    MOVE '@"L                   #   #00011725' TO DFHEIV0
 12279     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12280     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12281     MOVE X'2020233030303131373235' TO DFHEIV0(25:11)
 12282     CALL 'kxdfhei1' USING DFHEIV0,
 12283           ERESVI,
 12284           DFHEIV11
 12285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12286         MOVE ERESVI TO WS-ERESV.
 12287
 12288     IF EEXPENSL > 0
 12289
 12290* EXEC CICS BIF DEEDIT
 12291*            FIELD(EEXPENSI)
 12292*            LENGTH(8)
 12293*        END-EXEC
 12294     MOVE 8
 12295       TO DFHEIV11
 12296*    MOVE '@"L                   #   #00011732' TO DFHEIV0
 12297     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12298     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12299     MOVE X'2020233030303131373332' TO DFHEIV0(25:11)
 12300     CALL 'kxdfhei1' USING DFHEIV0,
 12301           EEXPENSI,
 12302           DFHEIV11
 12303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12304         MOVE EEXPENSI           TO WS-EEXPENS.
 12305
 12306     IF ETYPEL > ZEROS
 12307         MOVE ETYPEI             TO WS-ETYPE.
 12308
 12309     IF PI-COMPANY-ID = 'BOA'
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 239
* EL156.cbl
 12310        IF PINTL > ZEROS
 12311
 12312* EXEC CICS BIF DEEDIT
 12313*            FIELD (PINTI)
 12314*            LENGTH(05)
 12315*          END-EXEC
 12316     MOVE 05
 12317       TO DFHEIV11
 12318*    MOVE '@"L                   #   #00011743' TO DFHEIV0
 12319     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12320     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12321     MOVE X'2020233030303131373433' TO DFHEIV0(25:11)
 12322     CALL 'kxdfhei1' USING DFHEIV0,
 12323           PINTI,
 12324           DFHEIV11
 12325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12326           IF PINTI NUMERIC
 12327               MOVE AL-UNNON     TO PINTA
 12328               MOVE PINTI        TO WS-INT-RATE
 12329               MOVE WS-INT-RATE  TO PINTO.
 12330
 12331 3000-EXIT.
 12332     EXIT.
 12333
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 240
* EL156.cbl
 12335 3050-REBUILD-ENTERED.
 12336
 12337     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 12338
 12339     IF PI-PROV-PMT
 12340         MOVE '9'           TO PMTTYPEO
 12341     ELSE
 12342         MOVE PI-PMTTYPE    TO PMTTYPEO.
 12343
 12344     MOVE PI-PAYEE          TO PAYEEO.
 12345     MOVE PI-PMTNOTE1       TO NOTE1O.
 12346     MOVE PI-PMTNOTE2       TO NOTE2O.
 12347     MOVE PI-OFFLINE        TO OFFLINEO.
 12348     IF PI-PROOF-DATE NOT = ZEROS
 12349         MOVE PI-PROOF-DATE TO PROOFDTO
 12350         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 12351     END-IF.
 12352     MOVE PI-GROUPED        TO GROUPEDO.
 12353
 12354     MOVE PI-CASH           TO CASHO.
 12355
 12356     IF PI-INT-RATE > ZEROS
 12357         MOVE PI-INT-RATE   TO PINTO.
 12358
 12359     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12360        IF PI-INT-AMT > ZEROS
 12361           MOVE PI-INT-AMT       TO PINTO
 12362           MOVE AL-PANOF         TO PINTA
 12363                                    PINTHA
 12364        END-IF
 12365     END-IF
 12366     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 12367     IF PI-HOLDTIL NOT = ZEROS
 12368        MOVE PI-HOLDTIL          TO HOLDTILO
 12369        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12370
 12371     IF PI-EPYFROM NOT = ZEROS
 12372        MOVE PI-EPYFROM          TO EPYFROMO
 12373        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 12374
 12375     IF PI-AIGFROM NOT = ZEROS
 12376        MOVE PI-AIGFROM          TO AIGFROMO
 12377        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12378
 12379     IF PI-EPYTHRU NOT = ZEROS
 12380        MOVE PI-EPYTHRU          TO EPYTHRUO
 12381        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 12382        IF PI-USES-PAID-TO
 12383           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12384           MOVE '4'                TO DC-OPTION-CODE
 12385           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12386           IF NO-CONVERSION-ERROR
 12387              MOVE +1 TO DC-ELAPSED-DAYS
 12388              MOVE +0 TO DC-ELAPSED-MONTHS
 12389              MOVE '6' TO DC-OPTION-CODE
 12390              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12391              IF NO-CONVERSION-ERROR
 12392                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 241
* EL156.cbl
 12393
 12394     IF PI-EDAYS NOT = ZEROS
 12395        MOVE PI-EDAYS TO EDAYSO.
 12396
 12397     IF PI-EPYAMT NOT = ZEROS
 12398        MOVE PI-EPYAMT TO EPYAMTO.
 12399
 12400     IF PI-ERESV NOT = ZEROS
 12401        MOVE PI-ERESV TO ERESVO.
 12402
 12403     IF PI-EEXPENS NOT = ZEROS
 12404        MOVE PI-EEXPENS TO EEXPENSO.
 12405
 12406     MOVE PI-ETYPE TO ETYPEO.
 12407
 12408     IF PI-ECHECKNO NOT = SPACES
 12409        MOVE PI-ECHECKNO         TO CHECKNOO
 12410     ELSE
 12411        MOVE PI-CCHECKNO         TO CHECKNOO.
 12412
 12413     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12414     MOVE SPACES                 TO DC-OPTION-CODE.
 12415     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12416
 12417     IF DATE-CONVERSION-ERROR
 12418        MOVE SPACES              TO CPYFROMI
 12419     ELSE
 12420        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 12421
 12422     IF PI-USES-PAID-TO
 12423        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 12424        MOVE +1                  TO DC-ELAPSED-DAYS
 12425        MOVE +0                  TO DC-ELAPSED-MONTHS
 12426        MOVE '6'                 TO DC-OPTION-CODE
 12427        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12428        IF NO-CONVERSION-ERROR
 12429           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12430           GO TO 3051-CONTINUE.
 12431
 12432     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12433     MOVE SPACES                 TO DC-OPTION-CODE.
 12434     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12435
 12436     IF DATE-CONVERSION-ERROR
 12437        MOVE SPACES              TO CPYTHRUI
 12438     ELSE
 12439        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 12440
 12441 3051-CONTINUE.
 12442
 12443     IF PI-CDAYS NOT = ZEROS
 12444        MOVE PI-CDAYS TO CDAYSO.
 12445
 12446     IF PI-CPYAMT NOT = ZEROS
 12447        MOVE PI-CPYAMT TO CPYAMTO.
 12448
 12449     IF PI-CRESV NOT = ZEROS
 12450        MOVE PI-CRESV TO CRESVO.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 242
* EL156.cbl
 12451
 12452     IF PI-CEXPENS NOT = ZEROS
 12453        MOVE PI-CEXPENS TO CEXPENSO.
 12454
 12455 3059-EXIT.
 12456     EXIT.
 12457
 12458 3100-DEEDIT-DATE.
 12459
 12460* EXEC CICS BIF DEEDIT
 12461*        FIELD(DATE-WORK)
 12462*        LENGTH(8)
 12463*    END-EXEC.
 12464     MOVE 8
 12465       TO DFHEIV11
 12466*    MOVE '@"L                   #   #00011880' TO DFHEIV0
 12467     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12468     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12469     MOVE X'2020233030303131383830' TO DFHEIV0(25:11)
 12470     CALL 'kxdfhei1' USING DFHEIV0,
 12471           DATE-WORK,
 12472           DFHEIV11
 12473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12474
 12475
 12476 3100-EXIT.
 12477     EXIT.
 12478
 12479 3200-CALC-AIG-DAYS.
 12480
 12481     MOVE 'N'                    TO WS-DUE-DAY-SW.
 12482
 12483     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 12484     MOVE ' '                    TO DC-OPTION-CODE.
 12485     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12486     IF NO-CONVERSION-ERROR
 12487         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 12488     ELSE
 12489         GO TO 3290-ERROR.
 12490
 12491     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12492         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12493                                WS-BIN-FROM-DT
 12494     ELSE
 12495         IF CL-TOTAL-PAID-AMT > ZEROS
 12496             IF WS-SV-EPYFROM = LOW-VALUES
 12497                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 12498                                        WS-BIN-FROM-DT
 12499             ELSE
 12500                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 12501                                        WS-BIN-FROM-DT
 12502         ELSE
 12503             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 12504                                        WS-BIN-FROM-DT.
 12505
 12506 3210-CONTINUE.
 12507
 12508     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 243
* EL156.cbl
 12509     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12510     IF DATE-CONVERSION-ERROR
 12511         GO TO 3290-ERROR.
 12512
 12513     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 12514
 12515     IF PI-LOAN-DUE-DAY = 31
 12516         MOVE 30              TO WS-PMT-DUE-DA
 12517                                 WS-SAVE-DUE-DA
 12518     ELSE
 12519         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 12520                                 WS-SAVE-DUE-DA.
 12521
 12522     IF (PI-LOAN-DUE-DAY > 28) AND
 12523        (WS-PMT-DUE-MO = 2)
 12524         MOVE 'Y'                TO WS-DUE-DAY-SW
 12525         MOVE 28                 TO WS-PMT-DUE-DA.
 12526
 12527     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 12528     MOVE '4'                    TO DC-OPTION-CODE.
 12529     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12530     IF NO-CONVERSION-ERROR
 12531         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 12532     ELSE
 12533         GO TO 3290-ERROR.
 12534
 12535*--------------------------------------------------------------*
 12536*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 12537*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 12538*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 12539*                                                              *
 12540*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 12541*             INCURRED DATE      - 04/15/91                    *
 12542*             PMT DUE DATE       - 04/03/91                    *
 12543*             PMT DUE DATE       - 05/03/91                    *
 12544*--------------------------------------------------------------*
 12545
 12546     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 12547        (WS-SV-AIGFROM = LOW-VALUES)
 12548         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 12549            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 12550             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 12551             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 12552             IF NO-CONVERSION-ERROR
 12553                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12554                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12555             ELSE
 12556                 GO TO 3290-ERROR.
 12557
 12558     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 12559        (WS-SV-AIGFROM = LOW-VALUES)
 12560         GO TO 3205-CONT-CALC-PMT.
 12561
 12562     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 12563     MOVE ' '                    TO DC-OPTION-CODE.
 12564     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12565     IF NO-CONVERSION-ERROR
 12566         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 244
* EL156.cbl
 12567     ELSE
 12568         GO TO 3290-ERROR.
 12569
 12570     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 12571        (WS-PMT-DUE-DA < WS-FROM-DA)
 12572          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 12573          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 12574          IF NO-CONVERSION-ERROR
 12575              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12576              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12577          ELSE
 12578              GO TO 3290-ERROR.
 12579
 12580 3205-CONT-CALC-PMT.
 12581
 12582*--------------------------------------------------------------*
 12583*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 12584*    BETWEEN THE PAY FROM / THRU DATES.                        *
 12585*--------------------------------------------------------------*
 12586
 12587     IF CL-TOTAL-PAID-AMT = ZEROS AND
 12588        PI-PMTTYPE = '2'
 12589          NEXT SENTENCE
 12590     ELSE
 12591        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 12592           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 12593             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 12594             MOVE ER-3527            TO EMI-ERROR
 12595             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12596             MOVE -1                 TO EPYTHRUL
 12597             MOVE AL-UNBON           TO EPYTHRUA
 12598                                        EPYFROMA
 12599             GO TO 3299-EXIT.
 12600
 12601*--------------------------------------------------------------*
 12602*    CALCULATE RETRO ELIMINATION DATE                          *
 12603*--------------------------------------------------------------*
 12604
 12605     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12606         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12607     ELSE
 12608         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12609
 12610     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 12611     MOVE +0             TO DC-ELAPSED-MONTHS.
 12612     MOVE '6'            TO DC-OPTION-CODE.
 12613     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12614     IF NO-CONVERSION-ERROR
 12615         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 12616     ELSE
 12617         GO TO 3290-ERROR.
 12618
 12619 3210-CHECK-PMT-DATE.
 12620
 12621*--------------------------------------------------------------*
 12622*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 12623*    THE ENTERED PAY FROM DATE                                 *
 12624*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 245
* EL156.cbl
 12625
 12626     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 12627         NEXT SENTENCE
 12628     ELSE
 12629         GO TO 3220-COMPUTE-DAYS.
 12630
 12631     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 12632     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 12633     IF NO-CONVERSION-ERROR
 12634         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12635         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12636         GO TO 3210-CHECK-PMT-DATE
 12637     ELSE
 12638         GO TO 3290-ERROR.
 12639
 12640 3220-COMPUTE-DAYS.
 12641
 12642     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 12643     MOVE ZEROS         TO WS-CDAYS.
 12644     MOVE 'N'           TO WS-ELIMINATION-SW.
 12645
 12646*--------------------------------------------------------------*
 12647*    COMPUTE CALIFORNIA DUE DAYS                               *
 12648*--------------------------------------------------------------*
 12649
 12650     IF CL-TOTAL-PAID-AMT > ZEROS
 12651         MOVE 'Y' TO WS-ELIMINATION-SW
 12652         GO TO 3240-FIRST-PMT-DUE
 12653     ELSE
 12654        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 12655            NEXT SENTENCE
 12656        ELSE
 12657            GO TO 3240-FIRST-PMT-DUE.
 12658
 12659 3230-NEXT-PMT-DUE.
 12660
 12661     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 12662     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 12663     IF NO-CONVERSION-ERROR
 12664         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 12665         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12666     ELSE
 12667         GO TO 3290-ERROR.
 12668
 12669 3240-FIRST-PMT-DUE.
 12670
 12671     IF CL-TOTAL-PAID-AMT > ZEROS
 12672         NEXT SENTENCE
 12673     ELSE
 12674        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 12675            GO TO 3230-NEXT-PMT-DUE.
 12676
 12677     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 12678         GO TO 3250-VERIFY-ELIMINATION.
 12679
 12680     ADD +30 TO WS-CDAYS.
 12681     MOVE 'Y' TO WS-ELIMINATION-SW.
 12682     GO TO 3230-NEXT-PMT-DUE.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 246
* EL156.cbl
 12683
 12684 3250-VERIFY-ELIMINATION.
 12685
 12686     IF ELIM-SATISFIED
 12687         GO TO 3260-END-CALC.
 12688
 12689     IF PI-PMTTYPE = '1'
 12690         MOVE ZEROS TO WS-CDAYS
 12691         GO TO 3260-END-CALC.
 12692
 12693     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12694         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12695     ELSE
 12696         IF CL-TOTAL-PAID-AMT > ZEROS
 12697             IF WS-SV-EPYFROM = LOW-VALUES
 12698                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 12699             ELSE
 12700                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 12701         ELSE
 12702             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 12703
 12704     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 12705     MOVE '1'                    TO DC-OPTION-CODE.
 12706     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12707     IF NO-CONVERSION-ERROR
 12708         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 12709     ELSE
 12710         GO TO 3290-ERROR.
 12711
 12712     IF CL-TOTAL-PAID-AMT > ZEROS
 12713         MOVE WS-DAYS-OFF TO WS-CDAYS
 12714     ELSE
 12715         IF PI-BEN-DAYS > WS-DAYS-OFF
 12716             MOVE ZEROS TO WS-CDAYS
 12717         ELSE
 12718             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 12719
 12720 3260-END-CALC.
 12721
 12722     MOVE WS-CDAYS TO PI-CDAYS.
 12723
 12724     IF PI-EDAYS = ZEROS
 12725         MOVE PI-CDAYS TO PI-EDAYS
 12726         MOVE AL-UNNON TO EDAYSA.
 12727
 12728     GO TO 3299-EXIT.
 12729
 12730 3290-ERROR.
 12731
 12732     MOVE ER-3528            TO EMI-ERROR.
 12733     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12734     MOVE -1                 TO CDAYSL.
 12735     MOVE AL-UNBON           TO CDAYSA.
 12736
 12737 3299-EXIT.
 12738     EXIT.
 12739
 12740 3300-BUMP-DATE.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 247
* EL156.cbl
 12741
 12742     IF WS-RESTORE-DUE-DAY
 12743         MOVE 'N'              TO WS-DUE-DAY-SW
 12744         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 12745         ADD 1                 TO WS-PMT-DUE-MO
 12746         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 12747         MOVE '4'              TO DC-OPTION-CODE
 12748         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12749         IF NO-CONVERSION-ERROR
 12750             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12751             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 12752             GO TO 3399-EXIT
 12753         ELSE
 12754             MOVE '9'          TO DC-ERROR-CODE
 12755             GO TO 3399-EXIT.
 12756
 12757     IF (WS-PMT-DUE-MO = 1) AND
 12758        (WS-SAVE-DUE-DA > 28)
 12759           MOVE 'Y' TO WS-DUE-DAY-SW.
 12760
 12761     MOVE +0                 TO DC-ELAPSED-DAYS.
 12762     MOVE +1                 TO DC-ELAPSED-MONTHS.
 12763     MOVE '6'                TO DC-OPTION-CODE.
 12764     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12765
 12766 3399-EXIT.
 12767     EXIT.
 12768
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 248
* EL156.cbl
 12770 3400-COMPUTE-EXPIRY.
 12771
 12772     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 12773     MOVE +0                    TO DC-ELAPSED-DAYS
 12774                                   DC-ODD-DAYS-OVER.
 12775     MOVE '1'                   TO DC-END-OF-MONTH.
 12776     MOVE '6'                   TO DC-OPTION-CODE.
 12777
 12778     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12779         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 12780     ELSE
 12781         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 12782
 12783     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12784     IF NO-CONVERSION-ERROR
 12785         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 12786     ELSE
 12787         GO TO 3390-CONTINUE.
 12788
 12789     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 12790         GO TO 3390-CONTINUE.
 12791
 12792     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12793     MOVE '4'                    TO CNTL-REC-TYPE.
 12794     MOVE +0                     TO CNTL-SEQ-NO.
 12795     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 12796     MOVE WS-ACCESS              TO CNTL-ACCESS.
 12797     MOVE 'BENE'                 TO FILE-SWITCH.
 12798
 12799     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 12800
 12801     IF NO-BENEFIT-FOUND
 12802         GO TO 3390-CONTINUE.
 12803
 12804     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 12805        IF (PI-OFFLINE = 'Y') OR
 12806           (PI-PMTTYPE = '7')
 12807           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 12808                                     THRU 9870-EXIT
 12809           IF ERROR-ON-OUTPUT
 12810             MOVE -1                 TO ENTERPFL
 12811             MOVE AL-UANON           TO ENTERPFA
 12812             MOVE MAP-NAMEA          TO MAP-NAME
 12813             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12814             GO TO 8200-SEND-DATAONLY.
 12815
 12816     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 12817        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 12818        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 12819          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 12820          MOVE +0        TO DC-ELAPSED-DAYS
 12821          MOVE +1        TO DC-ELAPSED-MONTHS
 12822          MOVE 6         TO DC-OPTION-CODE
 12823          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12824          IF NO-CONVERSION-ERROR
 12825              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 12826
 12827 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 249
* EL156.cbl
 12828
 12829      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12830         MOVE CM-AH-LOAN-EXPIRE-DT
 12831                                 TO DC-BIN-DATE-1
 12832      ELSE
 12833         MOVE CM-LF-LOAN-EXPIRE-DT
 12834                                 TO DC-BIN-DATE-1
 12835      END-IF
 12836
 12837      MOVE ' '                    TO DC-OPTION-CODE.
 12838      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12839      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 12840      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 12841
 12842 3499-EXIT.
 12843     EXIT.
 12844
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 250
* EL156.cbl
 12846
 12847 3600-CHECK-VERIFICATION.
 12848
 12849     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12850
 12851     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 12852
 12853     IF PI-PAYEE-TYPE = 'I'
 12854        GO TO 3600-READ-TRAILER.
 12855
 12856     IF PI-PAYEE-TYPE = 'B'
 12857        ADD +10                  TO TRLR-SEQ-NO
 12858        GO TO 3600-READ-TRAILER.
 12859
 12860     IF PI-PAYEE-TYPE = 'A'
 12861        ADD +20                  TO TRLR-SEQ-NO
 12862        GO TO 3600-READ-TRAILER.
 12863
 12864     IF PI-PAYEE-TYPE = 'O'
 12865        ADD +50                  TO TRLR-SEQ-NO
 12866        GO TO 3600-READ-TRAILER.
 12867
 12868     IF PI-PAYEE-TYPE = 'Q'
 12869        ADD +60                  TO TRLR-SEQ-NO
 12870        GO TO 3600-READ-TRAILER.
 12871
 12872     IF PI-PAYEE-TYPE = 'P'
 12873        ADD +30                  TO TRLR-SEQ-NO
 12874        GO TO 3600-READ-TRAILER.
 12875
 12876     IF PI-PAYEE-TYPE = 'E'
 12877        ADD +40                  TO TRLR-SEQ-NO.
 12878
 12879 3600-READ-TRAILER.
 12880
 12881
 12882* EXEC CICS HANDLE CONDITION
 12883*         NOTFND(3600-CONTINUE)
 12884*    END-EXEC.
 12885*    MOVE '"$I                   ! - #00012290' TO DFHEIV0
 12886     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12887     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12888     MOVE X'2D20233030303132323930' TO DFHEIV0(25:11)
 12889     CALL 'kxdfhei1' USING DFHEIV0
 12890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12891
 12892
 12893     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12894
 12895 3600-CONTINUE.
 12896
 12897     IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 12898       IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 12899         MOVE ER-7576            TO EMI-ERROR
 12900         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12901         MOVE -1                 TO PAYEEL
 12902         MOVE AL-UABON           TO PAYEEA
 12903       END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 251
* EL156.cbl
 12904     END-IF.
 12905
 12906 3600-EXIT.
 12907     EXIT.
 12908
 12909 5000-UPDATE.
 12910
 12911     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 12912
 12913     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 12914
 12915     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 12916        PI-OFFLINE = 'Y'
 12917        NEXT SENTENCE
 12918     ELSE
 12919        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 12920
 12921*    IF PI-COMPANY-ID = 'CRI'
 12922*       IF PI-PMTTYPE = '1' OR  '2'
 12923*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12924*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 12925*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 12926
 12927*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 12928*       IF PI-PMTTYPE = '1'
 12929*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12930*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 12931
 12932     IF PI-PMTTYPE      = '2' AND
 12933        PI-SPLIT-PMT-SW = 'Y' AND
 12934        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 12935          MOVE ER-3530                TO EMI-ERROR
 12936          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12937
 12938     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12939        AND (CL-CLAIM-TYPE = 'L')
 12940        IF PI-PMTTYPE = '2' OR '4'
 12941           IF PI-INT-AMT NOT = ZEROS
 12942              PERFORM 7110-BUILD-PMT-TRLR
 12943                                 THRU 7130-EXIT
 12944           ELSE
 12945              IF PI-PMTTYPE = '2'
 12946                 PERFORM 7140-BUILD-NOTE-TRLR
 12947                                 THRU 7170-EXIT
 12948              END-IF
 12949           END-IF
 12950        END-IF
 12951     END-IF
 12952*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12953*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12954*            MOVE 'N'                 TO  WS-LETTER-SW.
 12955
 12956*    IF PI-COMPANY-ID = 'DMD'
 12957*        IF CL-NO-OF-PMTS-MADE = +1
 12958*                OR
 12959*           PI-PMTTYPE = '2'
 12960*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 12961
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 252
* EL156.cbl
 12962     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 12963
 12964*    IF PI-COMPANY-ID = 'DMD'
 12965*       IF CL-CERT-NO (5:2) = '69' OR '70'
 12966*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 12967
 12968
 12969* EXEC CICS REWRITE
 12970*         DATASET('ELMSTR')
 12971*         FROM(CLAIM-MASTER)
 12972*     END-EXEC.
 12973     MOVE LENGTH OF
 12974      CLAIM-MASTER
 12975       TO DFHEIV11
 12976     MOVE 'ELMSTR' TO DFHEIV1
 12977*    MOVE '&& L                  %   #00012369' TO DFHEIV0
 12978     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12979     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12980     MOVE X'2020233030303132333639' TO DFHEIV0(25:11)
 12981     CALL 'kxdfhei1' USING DFHEIV0,
 12982           DFHEIV1,
 12983           CLAIM-MASTER,
 12984           DFHEIV11,
 12985           DFHEIV99
 12986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12987
 12988
 12989     IF WS-LETTER-SW = 'N'
 12990         GO TO 5000-END-UPDATE.
 12991
 12992 5000-GENERATE-AUTO-LETTER.
 12993
 12994
 12995* EXEC CICS LINK
 12996*        PROGRAM    (LINK-1523)
 12997*        COMMAREA   (W-1523-LINKDATA)
 12998*        LENGTH     (W-1523-COMM-LENGTH)
 12999*    END-EXEC.
 13000*    MOVE '."C                   ''   #00012379' TO DFHEIV0
 13001     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13002     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13003     MOVE X'2020233030303132333739' TO DFHEIV0(25:11)
 13004     CALL 'kxdfhei1' USING DFHEIV0,
 13005           LINK-1523,
 13006           W-1523-LINKDATA,
 13007           W-1523-COMM-LENGTH,
 13008           DFHEIV99,
 13009           DFHEIV99,
 13010           DFHEIV99
 13011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13012
 13013
 13014     IF W-1523-FATAL-ERROR
 13015         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 13016         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13017         MOVE ER-0802                TO  EMI-ERROR
 13018         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13019
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 253
* EL156.cbl
 13020     IF W-1523-ERROR-CODE = 0191
 13021         MOVE ER-0803                TO  EMI-ERROR
 13022         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13023
 13024     IF PI-COMPANY-ID      = 'HAN' AND
 13025        PI-PMTTYPE         = '1'   AND
 13026        PI-3RD-PARTY-SW    = 'Y'   AND
 13027        W-1523-FORM-NUMBER = 'EOB1'
 13028           MOVE LOW-VALUES              TO W-1523-LINKDATA
 13029           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 13030           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 13031           GO TO 5000-GENERATE-AUTO-LETTER.
 13032
 13033 5000-END-UPDATE.
 13034
 13035     MOVE ER-0000                TO EMI-ERROR.
 13036     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13037     GO TO 7000-SHOW-CLAIM.
 13038
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 254
* EL156.cbl
 13040 5000-MOVE-NAME.
 13041     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 13042     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 13043     MOVE CL-INSURED-MID-INIT    TO MINITO.
 13044
 13045 5000-EXIT.
 13046     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 255
* EL156.cbl
 13048 5300-CREATE-DMO.
 13049
 13050     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 13051     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 13052     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 13053
 13054
 13055* EXEC CICS HANDLE CONDITION
 13056*         NOTFND   (5300-NOTE-NOT-FOUND)
 13057*    END-EXEC.
 13058*    MOVE '"$I                   ! . #00012425' TO DFHEIV0
 13059     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13060     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13061     MOVE X'2E20233030303132343235' TO DFHEIV0(25:11)
 13062     CALL 'kxdfhei1' USING DFHEIV0
 13063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13064
 13065
 13066
 13067* EXEC CICS READ
 13068*         DATASET('ERNOTE')
 13069*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 13070*         RIDFLD (W-NOTE-KEY)
 13071*    END-EXEC.
 13072     MOVE 'ERNOTE' TO DFHEIV1
 13073*    MOVE '&"S        E          (   #00012429' TO DFHEIV0
 13074     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13075     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13076     MOVE X'2020233030303132343239' TO DFHEIV0(25:11)
 13077     CALL 'kxdfhei1' USING DFHEIV0,
 13078           DFHEIV1,
 13079           DFHEIV20,
 13080           DFHEIV99,
 13081           W-NOTE-KEY,
 13082           DFHEIV99,
 13083           DFHEIV99,
 13084           DFHEIV99
 13085     SET ADDRESS OF CERTIFICATE-NOTE TO
 13086         DFHEIV20
 13087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13088
 13089
 13090     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 13091     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 13092     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 13093
 13094     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 13095         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 13096     ELSE
 13097         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 13098
 13099     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 13100     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 13101     MOVE 'DLO006'               TO PGM-NAME.
 13102
 13103
 13104* EXEC CICS LINK
 13105*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 256
* EL156.cbl
 13106*        COMMAREA   (DCT-COMMUNICATION-AREA)
 13107*        LENGTH     (DCT-RCRD-LENGTH)
 13108*    END-EXEC.
 13109*    MOVE '."C                   ''   #00012448' TO DFHEIV0
 13110     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13111     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13112     MOVE X'2020233030303132343438' TO DFHEIV0(25:11)
 13113     CALL 'kxdfhei1' USING DFHEIV0,
 13114           PGM-NAME,
 13115           DCT-COMMUNICATION-AREA,
 13116           DCT-RCRD-LENGTH,
 13117           DFHEIV99,
 13118           DFHEIV99,
 13119           DFHEIV99
 13120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13121
 13122
 13123     IF DCT-RETURN-CODE = 'OK'
 13124         GO TO 5300-CONT.
 13125
 13126     IF DCT-RETURN-CODE = '01' OR '02'
 13127         GO TO 5300-EXIT.
 13128
 13129     IF DCT-RETURN-CODE = '03'
 13130         MOVE ER-0951            TO EMI-ERROR
 13131         GO TO 5300-BAD-EXIT.
 13132
 13133     IF DCT-RETURN-CODE = '04'
 13134         MOVE ER-0946            TO EMI-ERROR
 13135         GO TO 5300-BAD-EXIT.
 13136
 13137     IF DCT-RETURN-CODE = '05'
 13138         MOVE ER-0947            TO EMI-ERROR
 13139         GO TO 5300-BAD-EXIT.
 13140
 13141     IF DCT-RETURN-CODE = '06'
 13142         MOVE ER-0921            TO EMI-ERROR
 13143         GO TO 5300-BAD-EXIT.
 13144
 13145     IF DCT-RETURN-CODE = '07'
 13146         MOVE ER-0849            TO EMI-ERROR
 13147         GO TO 5300-BAD-EXIT.
 13148
 13149     IF DCT-RETURN-CODE = '08'
 13150         MOVE ER-0948            TO EMI-ERROR
 13151         GO TO 5300-BAD-EXIT.
 13152
 13153     IF DCT-RETURN-CODE = 'N1'
 13154         MOVE ER-0950            TO EMI-ERROR
 13155         GO TO 5300-BAD-EXIT.
 13156
 13157     IF DCT-RETURN-CODE = 'E1'
 13158         MOVE ER-0974            TO EMI-ERROR
 13159         GO TO 5300-BAD-EXIT.
 13160
 13161     IF DCT-RETURN-CODE = 'E2'
 13162         MOVE ER-0975            TO EMI-ERROR
 13163         GO TO 5300-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 257
* EL156.cbl
 13164
 13165     IF DCT-RETURN-CODE NOT = 'OK'
 13166         MOVE ER-0949            TO EMI-ERROR
 13167         GO TO 5300-BAD-EXIT.
 13168
 13169 5300-CONT.
 13170
 13171     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 13172     MOVE 'CS'                   TO DM-RECORD-TYPE.
 13173     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 13174     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 13175     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 13176     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 13177     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 13178     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 13179
 13180     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 13181     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 13182     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 13183     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 13184     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 13185
 13186     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 13187
 13188     IF PI-PMTTYPE = '2'
 13189         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 13190         MOVE '4'                TO DM-CLAIM-STATUS
 13191     ELSE
 13192         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 13193         MOVE '2'                TO DM-CLAIM-STATUS.
 13194
 13195     MOVE 'DLO025'               TO PGM-NAME.
 13196
 13197
 13198* EXEC CICS LINK
 13199*        PROGRAM    (PGM-NAME)
 13200*        COMMAREA   (DMO-COMMUNICATION-AREA)
 13201*        LENGTH     (DM-DMO-LENGTH)
 13202*    END-EXEC.
 13203*    MOVE '."C                   ''   #00012528' TO DFHEIV0
 13204     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13205     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13206     MOVE X'2020233030303132353238' TO DFHEIV0(25:11)
 13207     CALL 'kxdfhei1' USING DFHEIV0,
 13208           PGM-NAME,
 13209           DMO-COMMUNICATION-AREA,
 13210           DM-DMO-LENGTH,
 13211           DFHEIV99,
 13212           DFHEIV99,
 13213           DFHEIV99
 13214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13215
 13216
 13217     IF DM-RETURN-CODE = 'OK'
 13218         GO TO 5300-EXIT.
 13219
 13220     IF DM-RETURN-CODE = '01'
 13221         MOVE ER-8051            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 258
* EL156.cbl
 13222         GO TO 5300-BAD-EXIT.
 13223
 13224     IF DM-RETURN-CODE = '02'
 13225         MOVE ER-8052            TO EMI-ERROR
 13226         GO TO 5300-BAD-EXIT.
 13227
 13228     IF DM-RETURN-CODE = '03'
 13229         MOVE ER-8053            TO EMI-ERROR
 13230         GO TO 5300-BAD-EXIT.
 13231
 13232     IF DM-RETURN-CODE = '04'
 13233         MOVE ER-8054            TO EMI-ERROR
 13234         GO TO 5300-BAD-EXIT.
 13235
 13236     IF DM-RETURN-CODE = '05'
 13237         MOVE ER-8055            TO EMI-ERROR
 13238         GO TO 5300-BAD-EXIT.
 13239
 13240     IF DM-RETURN-CODE = '06'
 13241         MOVE ER-8056            TO EMI-ERROR
 13242         GO TO 5300-BAD-EXIT.
 13243
 13244     IF DM-RETURN-CODE = '07'
 13245         MOVE ER-8057            TO EMI-ERROR
 13246         GO TO 5300-BAD-EXIT.
 13247
 13248     IF DM-RETURN-CODE = '08'
 13249         MOVE ER-8058            TO EMI-ERROR
 13250         GO TO 5300-BAD-EXIT.
 13251
 13252     IF DM-RETURN-CODE = '09'
 13253         MOVE ER-8059            TO EMI-ERROR
 13254         GO TO 5300-BAD-EXIT.
 13255
 13256     IF DM-RETURN-CODE = '10'
 13257         MOVE ER-8060            TO EMI-ERROR
 13258         GO TO 5300-BAD-EXIT.
 13259
 13260     IF DM-RETURN-CODE = '11'
 13261         MOVE ER-8061            TO EMI-ERROR
 13262         GO TO 5300-BAD-EXIT.
 13263
 13264     IF DM-RETURN-CODE = '12'
 13265         MOVE ER-8062            TO EMI-ERROR
 13266         GO TO 5300-BAD-EXIT.
 13267
 13268     IF DM-RETURN-CODE = '13'
 13269         MOVE ER-8063            TO EMI-ERROR
 13270         GO TO 5300-BAD-EXIT.
 13271
 13272     IF DM-RETURN-CODE = '14'
 13273         MOVE ER-8064            TO EMI-ERROR
 13274         GO TO 5300-BAD-EXIT.
 13275
 13276     IF DM-RETURN-CODE = '15'
 13277         MOVE ER-8065            TO EMI-ERROR
 13278         GO TO 5300-BAD-EXIT.
 13279
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 259
* EL156.cbl
 13280     IF DM-RETURN-CODE = '16'
 13281         MOVE ER-8154            TO EMI-ERROR
 13282         GO TO 5300-BAD-EXIT.
 13283
 13284     IF DM-RETURN-CODE = '17'
 13285         MOVE ER-8155            TO EMI-ERROR
 13286         GO TO 5300-BAD-EXIT.
 13287
 13288     IF DM-RETURN-CODE = 'N1'
 13289         MOVE ER-8152            TO EMI-ERROR
 13290         GO TO 5300-BAD-EXIT.
 13291
 13292     IF DM-RETURN-CODE = 'E1'
 13293         MOVE ER-8153            TO EMI-ERROR
 13294         GO TO 5300-BAD-EXIT.
 13295
 13296     MOVE ER-8066            TO EMI-ERROR.
 13297     GO TO 5300-BAD-EXIT.
 13298
 13299 5300-NOTE-NOT-FOUND.
 13300
 13301     MOVE ER-0954                TO EMI-ERROR.
 13302     GO TO 5300-BAD-EXIT.
 13303
 13304 5300-BAD-EXIT.
 13305
 13306* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 13307*    MOVE '6"R                   !   #00012622' TO DFHEIV0
 13308     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 13309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13310     MOVE X'2020233030303132363232' TO DFHEIV0(25:11)
 13311     CALL 'kxdfhei1' USING DFHEIV0
 13312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13313
 13314     IF MAP-NAME = 'EL156A'
 13315         MOVE -1             TO ENTERPFL
 13316       ELSE
 13317         MOVE LOW-VALUES     TO EL156BI
 13318         MOVE -1             TO ENTPFBL.
 13319
 13320     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13321     GO TO 8200-SEND-DATAONLY.
 13322
 13323 5300-EXIT.
 13324     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 260
* EL156.cbl
 13326 5350-FORMAT-LAST-NAME-1ST.
 13327*****************************************************************
 13328*             M O V E   N A M E   R O U T I N E                 *
 13329*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 13330*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 13331*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 13332*                  FIELD                   VALUE                *
 13333*           W-NAME-LAST    (CL15)      SMITH                    *
 13334*           W-NAME-FIRST   (CL15)      JOHN                     *
 13335*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 13336*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 13337*     CONTAIN                                                   *
 13338*                SMITH, JOHN ALLEN                              *
 13339*     OR                                                        *
 13340*                SMITH, JOHN A.                                 *
 13341*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 13342*     COPYBOOK, ELCNWA.                                         *
 13343*****************************************************************.
 13344
 13345     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 13346     MOVE ZERO                   TO  WS-NAME-SW.
 13347     SET NWA-INDEX               TO +1.
 13348
 13349     IF W-NAME-LAST   = SPACES AND
 13350        W-NAME-MIDDLE = SPACES
 13351         MOVE +1                 TO WS-NAME-SW.
 13352
 13353     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 13354     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13355
 13356     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 13357     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13358
 13359     SET NWA-INDEX UP BY +1.
 13360
 13361     IF W-NAME-MIDDLE NOT = SPACES
 13362         IF W-NAME-MIDDLE-2 = SPACES
 13363             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 13364             SET NWA-INDEX UP BY +1
 13365             MOVE '.'            TO WS-NW (NWA-INDEX)
 13366             SET NWA-INDEX UP BY +2
 13367         ELSE
 13368             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 13369             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13370
 13371 5350-EXIT.
 13372     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 261
* EL156.cbl
 13374 5360-MOVE-NAME.
 13375
 13376     IF WS-NAME-SW > +1
 13377         GO TO 5360-EXIT.
 13378
 13379     IF WS-NAME-WORK2 = SPACES
 13380         GO TO 5360-EXIT.
 13381
 13382     SET NWA-INDEX2            TO +1.
 13383     SET NWA-INDEX3            TO +2.
 13384
 13385 5360-MOVE-NAME-CYCLE.
 13386
 13387     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 13388
 13389     IF NWA-INDEX < +30
 13390         SET NWA-INDEX UP BY +1
 13391     ELSE
 13392         ADD +2                TO  WS-NAME-SW
 13393         GO TO 5360-EXIT.
 13394
 13395     IF NWA-INDEX2 < +20
 13396         SET NWA-INDEX3 UP BY +1
 13397         SET NWA-INDEX2 UP BY +1.
 13398
 13399     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 13400        WS-NW2 (NWA-INDEX3) = SPACES
 13401         IF WS-NAME-SW = ZERO
 13402             MOVE ','            TO  WS-NW (NWA-INDEX)
 13403             SET NWA-INDEX UP BY +2
 13404             MOVE +1             TO  WS-NAME-SW
 13405             GO TO 5360-EXIT
 13406         ELSE
 13407             GO TO 5360-EXIT.
 13408
 13409     GO TO 5360-MOVE-NAME-CYCLE.
 13410
 13411 5360-EXIT.
 13412     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 262
* EL156.cbl
 13414 6000-BUILD-SCREEN-B.
 13415     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 13416     MOVE PI-CARRIER             TO MSTR-CARRIER.
 13417     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 13418     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 13419
 13420     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 13421
 13422 6050-BUILD-SCREEN.
 13423     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 13424     MOVE LOW-VALUES             TO EL156BI.
 13425     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 13426
 13427     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 13428
 13429     IF PI-PAYEE-TYPE = 'I'
 13430        GO TO 6060-READ-TRAILER.
 13431
 13432     IF PI-PAYEE-TYPE = 'B'
 13433        ADD +10                  TO TRLR-SEQ-NO
 13434        GO TO 6060-READ-TRAILER.
 13435
 13436     IF PI-PAYEE-TYPE = 'A'
 13437        ADD +20                  TO TRLR-SEQ-NO
 13438        GO TO 6060-READ-TRAILER.
 13439
 13440     IF PI-PAYEE-TYPE = 'O'
 13441        ADD +50                  TO TRLR-SEQ-NO
 13442        GO TO 6060-READ-TRAILER.
 13443
 13444     IF PI-PAYEE-TYPE = 'Q'
 13445        ADD +60                  TO TRLR-SEQ-NO
 13446        GO TO 6060-READ-TRAILER.
 13447
 13448     IF PI-PAYEE-TYPE = 'P'
 13449        ADD +30                  TO TRLR-SEQ-NO
 13450        GO TO 6060-READ-TRAILER.
 13451
 13452     IF PI-PAYEE-TYPE = 'E'
 13453        ADD +40                  TO TRLR-SEQ-NO.
 13454
 13455 6060-READ-TRAILER.
 13456
 13457     IF PI-PAYEE-TYPE    = 'A' AND
 13458        PI-PAYEE-SEQ-NUM = 0
 13459          GO TO 6061-READ-ACCOUNT.
 13460
 13461     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 13462        (PI-PAYEE-TYPE    = 'B')             AND
 13463        (PI-PAYEE-SEQ-NUM = 9)
 13464          PERFORM 7920-READ-BENE THRU 7920-EXIT
 13465          IF BENE-FOUND-SW = 'N'
 13466            GO TO 6065-NOT-FOUND
 13467          ELSE
 13468            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 13469            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 13470            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 13471*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 263
* EL156.cbl
 13472            STRING BE-CITY ' ' BE-STATE
 13473               DELIMITED BY '  ' INTO CITYSTBO
 13474            END-STRING
 13475            MOVE BE-ZIP-CODE       TO ZIPBO
 13476            GO TO 6061-READ-ACCOUNT.
 13477
 13478     IF PI-PAYEE-TYPE    = 'B' AND
 13479        PI-PAYEE-SEQ-NUM = 0
 13480          PERFORM 7920-READ-BENE THRU 7920-EXIT
 13481          IF BENE-FOUND-SW = 'N'
 13482            GO TO 6065-NOT-FOUND
 13483          ELSE
 13484            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 13485            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 13486            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 13487*           MOVE BE-CITY-STATE     TO CITYSTBO
 13488            STRING BE-CITY ' ' BE-STATE
 13489               DELIMITED BY '  ' INTO CITYSTBO
 13490            END-STRING
 13491            MOVE BE-ZIP-CODE       TO ZIPBO
 13492            GO TO 6061-READ-ACCOUNT.
 13493
 13494
 13495* EXEC CICS HANDLE CONDITION
 13496*         NOTFND(6065-NOT-FOUND)
 13497*     END-EXEC.
 13498*    MOVE '"$I                   ! / #00012803' TO DFHEIV0
 13499     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13500     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13501     MOVE X'2F20233030303132383033' TO DFHEIV0(25:11)
 13502     CALL 'kxdfhei1' USING DFHEIV0
 13503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13504
 13505
 13506     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13507
 13508     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 13509     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 13510     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 13511     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 13512*    MOVE AT-CITY-STATE          TO CITYSTBO.
 13513     STRING AT-CITY ' ' AT-STATE
 13514        DELIMITED BY '  ' INTO CITYSTBO
 13515     END-STRING
 13516     MOVE AT-ZIP-CODE            TO ZIPBO.
 13517
 13518 6061-READ-ACCOUNT.
 13519
 13520* EXEC CICS HANDLE CONDITION
 13521*         NOTFND(6068-ACCT-NOT-FND)
 13522*     END-EXEC.
 13523*    MOVE '"$I                   ! 0 #00012820' TO DFHEIV0
 13524     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13525     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13526     MOVE X'3020233030303132383230' TO DFHEIV0(25:11)
 13527     CALL 'kxdfhei1' USING DFHEIV0
 13528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13529
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 264
* EL156.cbl
 13530
 13531
 13532* EXEC CICS READ
 13533*         DATASET('ERACCT')
 13534*         SET    (ADDRESS OF ACCOUNT-MASTER)
 13535*         RIDFLD (PI-ACCT-KEY)
 13536*     END-EXEC.
 13537     MOVE 'ERACCT' TO DFHEIV1
 13538*    MOVE '&"S        E          (   #00012824' TO DFHEIV0
 13539     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13540     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13541     MOVE X'2020233030303132383234' TO DFHEIV0(25:11)
 13542     CALL 'kxdfhei1' USING DFHEIV0,
 13543           DFHEIV1,
 13544           DFHEIV20,
 13545           DFHEIV99,
 13546           PI-ACCT-KEY,
 13547           DFHEIV99,
 13548           DFHEIV99,
 13549           DFHEIV99
 13550     SET ADDRESS OF ACCOUNT-MASTER TO
 13551         DFHEIV20
 13552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13553
 13554
 13555     MOVE AM-CARRIER             TO ACARRBO.
 13556     MOVE AM-GROUPING            TO GROUPBO.
 13557     MOVE AM-STATE               TO STATEBO.
 13558     MOVE AM-ACCOUNT             TO ACCTBO.
 13559     MOVE AM-NAME                TO ACCTNMBO.
 13560
 13561     IF PI-PAYEE-TYPE = 'A' AND
 13562        PI-PAYEE-SEQ-NUM = 0
 13563          MOVE AM-NAME             TO NAMEBO
 13564                                      PI-PAYEE-NAME
 13565          MOVE AM-ADDRS            TO ADDR1BO
 13566          MOVE SPACES              TO ADDR2BO
 13567*         MOVE AM-CITY             TO CITYSTBO
 13568          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 13569             DELIMITED BY '  ' INTO CITYSTBO
 13570          END-STRING
 13571          MOVE AM-ZIP-PRIME        TO WS-ZIP
 13572          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 13573          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 13574          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 13575
 13576     IF CITYSTBO EQUAL SPACES
 13577         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13578         GO TO 6070-FORMAT-DATA
 13579     END-IF.
 13580
 13581     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 13582     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 13583     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 13584     PERFORM VARYING WS-SUB FROM 30 BY -1
 13585          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 13586        IF WS-END-SUB = 0  AND
 13587           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES OR '.')
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 265
* EL156.cbl
 13588            CONTINUE
 13589        ELSE
 13590            IF WS-END-SUB = 0
 13591                MOVE WS-SUB TO WS-END-SUB
 13592            ELSE
 13593                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 13594                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 13595                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 13596                END-IF
 13597            END-IF
 13598        END-IF
 13599        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 13600            COMPUTE WS-BEG-SUB = WS-SUB + 1
 13601            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 13602        END-IF
 13603     END-PERFORM.
 13604
 13605     IF WS-BEG-SUB > 0
 13606         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 13607         IF WS-STATE-LENGTH = 2
 13608             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 13609                  TO PI-CHECK-STATE-FOR-AK
 13610         ELSE
 13611             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 13612                'ALASKA'
 13613                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 13614             ELSE
 13615                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13616             END-IF
 13617         END-IF
 13618     ELSE
 13619         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13620     END-IF.
 13621
 13622     GO TO 6070-FORMAT-DATA.
 13623
 13624 6065-NOT-FOUND.
 13625     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 13626     GO TO 6061-READ-ACCOUNT.
 13627
 13628 6068-ACCT-NOT-FND.
 13629     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 13630
 13631 6070-FORMAT-DATA.
 13632     IF PI-HOLDTIL = ZEROS
 13633        MOVE SAVE-DATE           TO PAYDTBI
 13634       ELSE
 13635        MOVE PI-HOLDTIL          TO PAYDTBO
 13636        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 13637
 13638     MOVE PI-PROOF-DATE          TO PROOFDBO.
 13639     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 13640
 13641     IF EIBAID = DFHPF3 OR DFHPF4
 13642        NEXT SENTENCE
 13643     ELSE
 13644       GO TO 6071-CONTINUE.
 13645
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 266
* EL156.cbl
 13646     MOVE PI-EPYFROM          TO PYFROMBO.
 13647     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 13648
 13649     IF NOT PI-USES-PAID-TO
 13650        MOVE PI-EPYTHRU          TO PYTHRUBO
 13651        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 13652     ELSE
 13653        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 13654        MOVE '4'              TO DC-OPTION-CODE
 13655        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13656        IF NO-CONVERSION-ERROR
 13657           MOVE +1            TO DC-ELAPSED-DAYS
 13658           MOVE +0            TO DC-ELAPSED-MONTHS
 13659           MOVE '6'           TO DC-OPTION-CODE
 13660           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13661           IF NO-CONVERSION-ERROR
 13662              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 13663
 13664     MOVE PI-EDAYS            TO DAYSBO.
 13665     MOVE PI-EPYAMT           TO PAYAMTBO.
 13666     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13667        IF PI-INT-AMT > ZEROS
 13668           MOVE PI-INT-AMT       TO INTAMTBO
 13669        END-IF
 13670     END-IF
 13671     GO TO 6072-SET-TYPE.
 13672
 13673 6071-CONTINUE.
 13674
 13675     IF PI-CPYFROM NOT = LOW-VALUES
 13676        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 13677        MOVE SPACES              TO DC-OPTION-CODE
 13678        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13679        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 13680
 13681     IF PI-CPYTHRU NOT = LOW-VALUES
 13682        IF NOT PI-USES-PAID-TO
 13683           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 13684           MOVE SPACES             TO DC-OPTION-CODE
 13685           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13686           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 13687        ELSE
 13688           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 13689           MOVE '6'                TO DC-OPTION-CODE
 13690           MOVE +1                 TO DC-ELAPSED-DAYS
 13691           MOVE +0                 TO DC-ELAPSED-MONTHS
 13692           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13693           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 13694
 13695     MOVE PI-CDAYS               TO DAYSBO.
 13696     MOVE PI-CPYAMT              TO PAYAMTBO.
 13697     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13698        IF PI-INT-AMT > ZEROS
 13699           MOVE PI-INT-AMT       TO INTAMTBO
 13700        END-IF
 13701     END-IF
 13702     .
 13703 6072-SET-TYPE.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 267
* EL156.cbl
 13704     IF PI-PMTTYPE = '1'
 13705        MOVE 'PARTIAL'           TO PAYTYPBO.
 13706
 13707     IF PI-PMTTYPE = '2'
 13708        MOVE 'FINAL'             TO PAYTYPBO.
 13709
 13710     IF PI-PMTTYPE = '3'
 13711        MOVE 'LUMP SUM'          TO PAYTYPBO.
 13712
 13713     IF PI-PMTTYPE = '4'
 13714        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 13715
 13716     IF PI-PMTTYPE = '5'
 13717        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 13718
 13719     IF PI-PMTTYPE = '6'
 13720        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 13721
 13722     IF PI-PROV-PMT
 13723        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 13724
 13725     IF PI-ECHECKNO NOT = SPACES
 13726        MOVE PI-ECHECKNO         TO CKNUMBO
 13727     ELSE
 13728        MOVE PI-CCHECKNO         TO CKNUMBO.
 13729
 13730     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 13731        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 13732        MOVE +91                 TO  TRLR-SEQ-NO
 13733
 13734* EXEC CICS READ
 13735*           DATASET  ('ELTRLR')
 13736*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13737*           RIDFLD   (ELTRLR-KEY)
 13738*           RESP     (WS-RESPONSE)
 13739*       END-EXEC
 13740     MOVE 'ELTRLR' TO DFHEIV1
 13741*    MOVE '&"S        E          (  N#00013008' TO DFHEIV0
 13742     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13743     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13744     MOVE X'204E233030303133303038' TO DFHEIV0(25:11)
 13745     CALL 'kxdfhei1' USING DFHEIV0,
 13746           DFHEIV1,
 13747           DFHEIV20,
 13748           DFHEIV99,
 13749           ELTRLR-KEY,
 13750           DFHEIV99,
 13751           DFHEIV99,
 13752           DFHEIV99
 13753     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13754         DFHEIV20
 13755     MOVE EIBRESP  TO WS-RESPONSE
 13756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13757
 13758        IF WS-RESP-NORMAL
 13759           MOVE AT-INFO-LINE-1   TO  LOANNBO
 13760        ELSE
 13761           MOVE SPACES           TO  LOANNBO
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 268
* EL156.cbl
 13762        END-IF
 13763     END-IF
 13764
 13765*       MOVE PI-LOAN-NO          TO LOANNBO
 13766
 13767     IF CKNUMBO = SPACES
 13768         MOVE SPACES             TO CKNUMHDO.
 13769
 13770     MOVE CL-CLAIM-NO            TO CLMNOBO.
 13771     MOVE CL-CARRIER             TO CARRBO.
 13772     MOVE CL-CERT-PRIME          TO CERTNOBO.
 13773     MOVE CL-CERT-SFX            TO SUFXBO.
 13774
 13775     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13776        EVALUATE CL-CLAIM-TYPE
 13777           WHEN 'I'
 13778              MOVE '  IU  '      TO CLMTYPBO
 13779           WHEN 'G'
 13780              MOVE ' GAP  '      TO CLMTYPBO
 13781           WHEN OTHER
 13782              MOVE PI-AH-OVERRIDE-L6
 13783                                 TO CLMTYPBO
 13784        END-EVALUATE
 13785        MOVE ZEROS               TO UNDISBO
 13786*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 13787        IF PI-PMTTYPE = '5' OR '6'
 13788           GO TO 6073-GET-NOTIFY-DATA
 13789        ELSE
 13790           MOVE PI-DAILY-RATE    TO RATEBO
 13791           GO TO 6073-GET-NOTIFY-DATA.
 13792
 13793     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 13794
 13795     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 13796        MOVE ZEROS               TO UNDISBO
 13797     ELSE
 13798        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 13799
 13800 6073-GET-NOTIFY-DATA.
 13801
 13802     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 13803
 13804     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 13805         MOVE SPACES             TO  NAMEB2O
 13806                                     ADDR1B2O
 13807                                     ADDR2B2O
 13808                                     CITYST2O
 13809                                     AGTHDGO
 13810         MOVE ZEROS              TO  ZIPB2O
 13811         GO TO 6080-SET-INCURRED.
 13812
 13813     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 13814     MOVE +29                    TO  TRLR-SEQ-NO.
 13815
 13816
 13817* EXEC CICS HANDLE CONDITION
 13818*        NOTFND   (6074-GET-COMP-DATA)
 13819*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 269
* EL156.cbl
 13820*    MOVE '"$I                   ! 1 #00013073' TO DFHEIV0
 13821     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13822     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13823     MOVE X'3120233030303133303733' TO DFHEIV0(25:11)
 13824     CALL 'kxdfhei1' USING DFHEIV0
 13825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13826
 13827
 13828     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13829
 13830     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 13831     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 13832     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 13833*    MOVE AT-CITY-STATE          TO  CITYST2O.
 13834     STRING AT-CITY ' ' AT-STATE
 13835        DELIMITED BY '  ' INTO CITYST2O
 13836     END-STRING
 13837     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 13838     GO TO 6080-SET-INCURRED.
 13839
 13840 6074-GET-COMP-DATA.
 13841
 13842     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 13843         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 13844
 13845     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 13846         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 13847                                         ADDR1B2O
 13848                                         ADDR2B2O
 13849                                         CITYST2O
 13850         MOVE ZEROS                  TO  ZIPB2O
 13851         GO TO 6080-SET-INCURRED.
 13852
 13853     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 13854     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 13855     MOVE AM-CARRIER             TO  COMP-CARRIER.
 13856     MOVE AM-GROUPING            TO  COMP-GROUP.
 13857     MOVE 'A'                    TO  COMP-TYPE.
 13858     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 13859                                 TO  COMP-FIN-RESP.
 13860
 13861     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 13862         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 13863                                       'G' OR 'B'
 13864             MOVE 'G'            TO  COMP-TYPE
 13865             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 13866         ELSE
 13867             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 13868                                 TO  COMP-ACCOUNT
 13869     ELSE
 13870         MOVE 'G'                TO  COMP-TYPE
 13871         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 13872
 13873     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 13874
 13875     IF COMP-REC-FOUND
 13876         MOVE CO-ACCT-NAME       TO  NAMEB2O
 13877         MOVE CO-ADDR-1          TO  ADDR1B2O
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 270
* EL156.cbl
 13878         MOVE CO-ADDR-2          TO  ADDR2B2O
 13879*        MOVE CO-ADDR-3          TO  CITYST2O
 13880         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 13881            DELIMITED BY '  ' INTO CITYST2O
 13882         END-STRING
 13883         MOVE CO-ZIP             TO  ZIPB2O
 13884     ELSE
 13885         MOVE 'NO COMP ADDRESS AVAILABLE'
 13886                                 TO  NAMEB2O
 13887                                     ADDR1B2O
 13888                                     ADDR2B2O
 13889                                     CITYST2O
 13890         MOVE ZEROS               TO ZIPB2O.
 13891
 13892 6080-SET-INCURRED.
 13893     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13894     MOVE SPACES                 TO DC-OPTION-CODE.
 13895     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13896     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 13897     MOVE PI-PROCESSOR-ID        TO BYBO.
 13898     MOVE MAP-NAMEB              TO MAP-NAME.
 13899     MOVE 'C'                    TO PI-PASS-SW.
 13900     MOVE EIBAID                 TO PI-PFKEY-USED.
 13901     MOVE -1                     TO ENTPFBL.
 13902     GO TO 8100-SEND-INITIAL-MAP.
 13903
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 271
* EL156.cbl
 13905 6100-BUILD-PAYMENT-TRAILER.
 13906
 13907     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 13908       (PI-COMPANY-ID = 'CID' OR 'AHL')
 13909         GO TO 6105-STATE-CHECK-NUMBER
 13910     END-IF.
 13911
 13912     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13913     MOVE '6'                    TO CNTL-REC-TYPE.
 13914
 13915     IF CONTROL-IS-ACTUAL-CARRIER
 13916         MOVE PI-CARRIER         TO WS-CARR
 13917     ELSE
 13918         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 13919
 13920     IF PI-COMPANY-ID = 'FIA'
 13921         MOVE PI-CARRIER         TO  WS-CARR.
 13922
 13923     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 13924     MOVE 0                      TO CNTL-SEQ-NO.
 13925     MOVE 'CARR'                 TO FILE-SWITCH.
 13926
 13927     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 13928
 13929     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13930         IF PI-OFFLINE     = 'Y' AND
 13931            PI-ECHECKNO-CR = 'CR'
 13932              GO TO 6110-READ-CONTROL
 13933         ELSE
 13934            IF PI-CASH = 'N'
 13935                GO TO 6110-READ-CONTROL.
 13936
 13937     IF CHECK-NO-MANUAL    OR
 13938        CHECK-NO-AT-PRINT  OR
 13939        PI-OFFLINE = 'Y'
 13940          GO TO 6130-BUILD-TRAILER.
 13941
 13942     IF PI-COMPANY-ID = 'FIA'
 13943         NEXT SENTENCE
 13944     ELSE
 13945         IF NOT CONTROL-IS-ACTUAL-CARRIER
 13946             GO TO 6110-READ-CONTROL.
 13947
 13948     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 13949
 13950     IF CHECK-CNT-RESET-VALUE
 13951        MOVE +1                  TO CF-CHECK-COUNTER
 13952     ELSE
 13953        ADD +1                   TO CF-CHECK-COUNTER.
 13954
 13955     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 13956
 13957     IF CHECK-NO-CARR-SEQ
 13958        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 13959
 13960     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 13961     GO TO 6120-REWRITE.
 13962
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 272
* EL156.cbl
 13963 6105-STATE-CHECK-NUMBER.
 13964     IF CHECK-NO-MANUAL    OR
 13965        CHECK-NO-AT-PRINT  OR
 13966        PI-OFFLINE = 'Y'
 13967           GO TO 6130-BUILD-TRAILER
 13968     END-IF.
 13969
 13970     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 13971     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 13972     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 13973     MOVE '3'                TO CNTL-REC-TYPE.
 13974     MOVE +0                 TO CNTL-SEQ-NO.
 13975     MOVE 'STAT'             TO FILE-SWITCH.
 13976     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 13977
 13978     IF CF-ST-CHECK-CNT-RESET
 13979         MOVE +1             TO CF-ST-CHECK-COUNTER
 13980     ELSE
 13981         ADD +1              TO CF-ST-CHECK-COUNTER
 13982     END-IF.
 13983
 13984     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 13985     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 13986     GO TO 6120-REWRITE.
 13987
 13988 6110-READ-CONTROL.
 13989     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13990     MOVE '1'                    TO CNTL-REC-TYPE.
 13991     MOVE SPACES                 TO CNTL-ACCESS.
 13992     MOVE 0                      TO CNTL-SEQ-NO.
 13993
 13994     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 13995
 13996     IF CO-CHECK-COUNT-RESET
 13997        MOVE +1                  TO CF-CO-CHECK-COUNTER
 13998     ELSE
 13999        ADD +1                   TO CF-CO-CHECK-COUNTER.
 14000
 14001     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 14002
 14003     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14004         IF PI-OFFLINE     = 'Y'  AND
 14005            PI-ECHECKNO-CR = 'CR'
 14006              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 14007              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 14008              MOVE AL-UANON           TO CHECKNOA
 14009              GO TO 6120-REWRITE
 14010         ELSE
 14011         IF PI-CASH = 'N'
 14012             MOVE 'N'                TO PI-ECHECKNO-N
 14013             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 14014             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 14015             MOVE AL-UANON           TO CHECKNOA
 14016             GO TO 6120-REWRITE.
 14017
 14018     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 14019
 14020 6120-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 273
* EL156.cbl
 14021
 14022* EXEC CICS REWRITE
 14023*         DATASET('ELCNTL')
 14024*         FROM(CONTROL-FILE)
 14025*     END-EXEC.
 14026     MOVE LENGTH OF
 14027      CONTROL-FILE
 14028       TO DFHEIV11
 14029     MOVE 'ELCNTL' TO DFHEIV1
 14030*    MOVE '&& L                  %   #00013270' TO DFHEIV0
 14031     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14032     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14033     MOVE X'2020233030303133323730' TO DFHEIV0(25:11)
 14034     CALL 'kxdfhei1' USING DFHEIV0,
 14035           DFHEIV1,
 14036           CONTROL-FILE,
 14037           DFHEIV11,
 14038           DFHEIV99
 14039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14040
 14041
 14042     MOVE 'Y'                    TO PI-CK-ASSIGN.
 14043
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 274
* EL156.cbl
 14045 6130-BUILD-TRAILER.
 14046
 14047
 14048* EXEC CICS GETMAIN
 14049*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14050*         LENGTH    (200)
 14051*         INITIMG   (GETMAIN-SPACE)
 14052*     END-EXEC.
 14053     MOVE 200
 14054       TO DFHEIV11
 14055*    MOVE ',"IL                  $   #00013280' TO DFHEIV0
 14056     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14057     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14058     MOVE X'2020233030303133323830' TO DFHEIV0(25:11)
 14059     CALL 'kxdfhei1' USING DFHEIV0,
 14060           DFHEIV20,
 14061           DFHEIV11,
 14062           GETMAIN-SPACE
 14063     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14064         DFHEIV20
 14065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14066
 14067
 14068     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 14069                                    AT-PREV-PAID-THRU-DT.
 14070     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 14071     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 14072     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 14073     MOVE 'AT'                   TO AT-RECORD-ID.
 14074     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 14075
 14076     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 14077        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 14078           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 14079     ELSE
 14080           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 14081           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 14082
 14083     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 14084         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 14085             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 14086             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 14087           ELSE
 14088             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 14089             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 14090
 14091     MOVE '2'                    TO AT-TRAILER-TYPE.
 14092     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 14093                                    AT-PAYMENT-LAST-MAINT-DT.
 14094     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 14095                                    AT-PAYMENT-LAST-UPDATED-BY.
 14096     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 14097     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 14098     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 14099     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 14100
 14101     IF PI-PMT-APPROVED
 14102        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 275
* EL156.cbl
 14103           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 14104
 14105     IF PI-PFKEY-USED = DFHPF5
 14106        GO TO 6140-PF5-ENTERED.
 14107
 14108     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 14109     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 14110
 14111     IF PI-AIG-SPECIAL-BENEFIT
 14112         IF WS-1ST-SPECIAL-PMT
 14113             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 14114             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 14115                                        AT-AMOUNT-PAID
 14116         ELSE
 14117             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 14118
 14119     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 14120
 14121     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 14122     MOVE '4'                    TO DC-OPTION-CODE.
 14123     PERFORM 9700-LINK-DATE-CONVERT.
 14124
 14125     IF DATE-CONVERSION-ERROR
 14126        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 14127     ELSE
 14128        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 14129
 14130     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 14131     MOVE '4'                    TO DC-OPTION-CODE.
 14132     PERFORM 9700-LINK-DATE-CONVERT.
 14133
 14134     IF DATE-CONVERSION-ERROR
 14135        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 14136     ELSE
 14137        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 14138
 14139     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 14140     GO TO 6150-FINISH-MOVE.
 14141
 14142 6140-PF5-ENTERED.
 14143     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 14144     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 14145
 14146     IF PI-AIG-SPECIAL-BENEFIT
 14147         IF WS-1ST-SPECIAL-PMT
 14148             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 14149             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 14150                                        AT-AMOUNT-PAID
 14151         ELSE
 14152             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 14153
 14154     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 14155     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 14156     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 14157
 14158 6150-FINISH-MOVE.
 14159
 14160     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 276
* EL156.cbl
 14161         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 14162     ELSE
 14163         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 14164
 14165     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 14166     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 14167
 14168     MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 14169     MOVE PI-CASH                TO AT-CASH-PAYMENT.
 14170
 14171     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14172         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 14173
 14174     IF PI-OFFLINE = 'N'
 14175        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 14176        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 14177     ELSE
 14178        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 14179        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 14180
 14181     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 14182
 14183     IF WS-2ND-SPECIAL-PMT
 14184         MOVE 'Y'                TO AT-CASH-PAYMENT
 14185         MOVE SPACES             TO AT-CHECK-NO
 14186         MOVE '3'                TO AT-PAYMENT-ORIGIN
 14187         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 14188         MOVE 'U'                TO AT-AIG-UNEMP-IND
 14189         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 14190
 14191     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 14192                                    AT-TO-BE-WRITTEN-DT.
 14193
 14194     IF PI-HOLDTIL NOT = ZEROS
 14195        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 14196        MOVE '4'                 TO DC-OPTION-CODE
 14197        PERFORM 9700-LINK-DATE-CONVERT
 14198        IF PI-OFFLINE = 'N'
 14199           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 14200        ELSE
 14201           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 14202
 14203     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 14204     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 14205                                    AT-CHECK-QUE-SEQUENCE.
 14206
 14207     IF PI-PFKEY-USED = DFHPF4
 14208        MOVE '1'                 TO AT-FORCE-CONTROL.
 14209
 14210     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 14211        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 14212        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 14213        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 14214
 14215     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 14216                                    AT-VOID-SELECT-DT
 14217                                    AT-VOID-ACCEPT-DT
 14218                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 277
* EL156.cbl
 14219     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14220        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 14221        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 14222        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 14223        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 14224     ELSE
 14225        MOVE ZEROS               TO AT-DAILY-RATE
 14226                                    AT-ELIMINATION-DAYS
 14227        MOVE SPACES              TO AT-BENEFIT-TYPE
 14228     END-IF
 14229     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 14230     MOVE '4'                    TO DC-OPTION-CODE.
 14231     PERFORM 9700-LINK-DATE-CONVERT.
 14232     IF DATE-CONVERSION-ERROR
 14233         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 14234     ELSE
 14235         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 14236     END-IF.
 14237     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 14238*******************************************************
 14239     IF NOT PI-PMT-GRADUATED
 14240         GO TO 6170-WRITE.
 14241
 14242     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14243     MOVE '1'                    TO CNTL-REC-TYPE.
 14244     MOVE SPACES                 TO CNTL-ACCESS.
 14245     MOVE +0                     TO CNTL-SEQ-NO.
 14246     MOVE 'COMP'                 TO FILE-SWITCH.
 14247
 14248     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 14249
 14250     IF PAID-FOR-LIFE
 14251         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 14252             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14253                                     WS-PMT-APPROVAL-SW
 14254             GO TO 6170-WRITE.
 14255
 14256*05999      IF PAID-FOR-AH
 14257     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 14258         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 14259             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14260                                     WS-PMT-APPROVAL-SW
 14261             GO TO 6170-WRITE.
 14262
 14263     MOVE '1'                    TO AT-APPROVED-LEVEL.
 14264
 14265******A&H Limits are set as a monthly payment.  Calculate the mont
 14266******equivalent of the amount paid today
 14267     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 14268        PI-SAVE-ODD-DAYS-OVER > 0
 14269           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 14270                               / 30) + PI-SAVE-ELAPSED-MONTHS
 14271           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 14272                                  WS-CALC-PMT-MONTHS
 14273     ELSE
 14274           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 14275     END-IF.
 14276*06007      IF ((PAID-FOR-AH) AND
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 278
* EL156.cbl
 14277     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14278*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 14279        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 14280              OR
 14281        ((PAID-FOR-LIFE) AND
 14282        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 14283            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 14284       ELSE
 14285*06014      IF ((PAID-FOR-AH)  AND
 14286         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14287*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 14288           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 14289              OR
 14290        ((PAID-FOR-LIFE) AND
 14291        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 14292            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 14293         ELSE
 14294*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 14295           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14296               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 14297              OR
 14298          ((PAID-FOR-LIFE) AND
 14299          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 14300            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 14301       ELSE
 14302            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD.
 14303
 14304     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14305        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 14306        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 14307            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 14308        END-IF
 14309     ELSE
 14310     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14311        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 14312        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 14313            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 14314        END-IF
 14315     ELSE
 14316     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14317        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 14318        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 14319            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 14320        END-IF
 14321     ELSE
 14322     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 14323            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD.
 14324
 14325     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 14326
 14327     IF NOT PI-PMT-GRADUATED
 14328         GO TO 6170-WRITE.
 14329
 14330
 14331* EXEC CICS HANDLE CONDITION
 14332*        NOTFND   (6170-WRITE)
 14333*    END-EXEC.
 14334*    MOVE '"$I                   ! 2 #00013548' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 279
* EL156.cbl
 14335     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14336     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14337     MOVE X'3220233030303133353438' TO DFHEIV0(25:11)
 14338     CALL 'kxdfhei1' USING DFHEIV0
 14339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14340
 14341
 14342     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14343     MOVE '2'                    TO CNTL-REC-TYPE.
 14344     MOVE +0                     TO CNTL-SEQ-NO.
 14345     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 14346
 14347
 14348* EXEC CICS READ
 14349*         DATASET  ('ELCNTL')
 14350*         SET      (ADDRESS OF CONTROL-FILE)
 14351*         RIDFLD   (ELCNTL-KEY)
 14352*    END-EXEC.
 14353     MOVE 'ELCNTL' TO DFHEIV1
 14354*    MOVE '&"S        E          (   #00013557' TO DFHEIV0
 14355     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14356     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14357     MOVE X'2020233030303133353537' TO DFHEIV0(25:11)
 14358     CALL 'kxdfhei1' USING DFHEIV0,
 14359           DFHEIV1,
 14360           DFHEIV20,
 14361           DFHEIV99,
 14362           ELCNTL-KEY,
 14363           DFHEIV99,
 14364           DFHEIV99,
 14365           DFHEIV99
 14366     SET ADDRESS OF CONTROL-FILE TO
 14367         DFHEIV20
 14368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14369
 14370
 14371     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 14372
 14373     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 14374                         OR '4'
 14375         NEXT SENTENCE
 14376     ELSE
 14377         MOVE 'Y' TO WS-NEED-APPROVAL
 14378         GO TO 6170-WRITE.
 14379
 14380     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 14381         MOVE 'Y' TO WS-NEED-APPROVAL
 14382         IF WS-APPROVAL-LEVEL = '1'
 14383             MOVE '2'        TO  AT-APPROVED-LEVEL
 14384                            WS-SAVE-APPROVED-LEVEL
 14385             GO TO 6170-WRITE
 14386         ELSE
 14387             IF WS-APPROVAL-LEVEL = '2'
 14388                 MOVE '3'        TO  AT-APPROVED-LEVEL
 14389                                WS-SAVE-APPROVED-LEVEL
 14390                 GO TO 6170-WRITE
 14391             ELSE IF WS-APPROVAL-LEVEL = '3'
 14392                 MOVE '4'        TO  AT-APPROVED-LEVEL
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 280
* EL156.cbl
 14393                                WS-SAVE-APPROVED-LEVEL
 14394                 GO TO 6170-WRITE.
 14395
 14396     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14397                             WS-PMT-APPROVAL-SW.
 14398     MOVE SPACES         TO  AT-APPROVED-LEVEL
 14399                             AT-APPROVAL-LEVEL-REQD.
 14400
 14401*******************************************************
 14402
 14403 6170-WRITE.
 14404
 14405     IF PI-COMPANY-ID = 'DMD'
 14406        IF PI-AT-EOB-CODES NOT = SPACES
 14407           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 14408           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 14409           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 14410           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 14411           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 14412
 14413
 14414* EXEC CICS HANDLE CONDITION
 14415*        DUPREC    (6180-DUPREC)
 14416*    END-EXEC.
 14417*    MOVE '"$%                   ! 3 #00013605' TO DFHEIV0
 14418     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14419     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14420     MOVE X'3320233030303133363035' TO DFHEIV0(25:11)
 14421     CALL 'kxdfhei1' USING DFHEIV0
 14422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14423
 14424
 14425
 14426* EXEC CICS WRITE
 14427*         DATASET       ('ELTRLR')
 14428*         FROM          (ACTIVITY-TRAILERS)
 14429*         RIDFLD        (AT-CONTROL-PRIMARY)
 14430*     END-EXEC.
 14431     MOVE LENGTH OF
 14432      ACTIVITY-TRAILERS
 14433       TO DFHEIV11
 14434     MOVE 'ELTRLR' TO DFHEIV1
 14435*    MOVE '&$ L                  ''   #00013609' TO DFHEIV0
 14436     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14437     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14438     MOVE X'2020233030303133363039' TO DFHEIV0(25:11)
 14439     CALL 'kxdfhei1' USING DFHEIV0,
 14440           DFHEIV1,
 14441           ACTIVITY-TRAILERS,
 14442           DFHEIV11,
 14443           AT-CONTROL-PRIMARY,
 14444           DFHEIV99,
 14445           DFHEIV99
 14446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14447
 14448
 14449     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 14450        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 281
* EL156.cbl
 14451*06088           GO TO 6199-EXIT.
 14452           GO TO 6176-APPROVAL-NOTE.
 14453
 14454
 14455* EXEC CICS GETMAIN
 14456*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14457*         LENGTH    (200)
 14458*         INITIMG   (GETMAIN-SPACE)
 14459*     END-EXEC.
 14460     MOVE 200
 14461       TO DFHEIV11
 14462*    MOVE ',"IL                  $   #00013620' TO DFHEIV0
 14463     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14464     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14465     MOVE X'2020233030303133363230' TO DFHEIV0(25:11)
 14466     CALL 'kxdfhei1' USING DFHEIV0,
 14467           DFHEIV20,
 14468           DFHEIV11,
 14469           GETMAIN-SPACE
 14470     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14471         DFHEIV20
 14472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14473
 14474
 14475     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14476
 14477     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 14478     MOVE 'AT'                   TO AT-RECORD-ID.
 14479     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 14480     MOVE '6'                    TO AT-TRAILER-TYPE.
 14481     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 14482                                    AT-GEN-INFO-LAST-MAINT-DT
 14483     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 14484                                    AT-GEN-INFO-LAST-UPDATED-BY
 14485     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 14486
 14487     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 14488     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 14489     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 14490
 14491     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 14492
 14493 6175-WRITE.
 14494
 14495
 14496* EXEC CICS HANDLE CONDITION
 14497*        DUPREC    (6190-DUPREC)
 14498*    END-EXEC.
 14499*    MOVE '"$%                   ! 4 #00013646' TO DFHEIV0
 14500     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14502     MOVE X'3420233030303133363436' TO DFHEIV0(25:11)
 14503     CALL 'kxdfhei1' USING DFHEIV0
 14504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14505
 14506
 14507
 14508* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 282
* EL156.cbl
 14509*         DATASET     ('ELTRLR')
 14510*         FROM        (ACTIVITY-TRAILERS)
 14511*         RIDFLD      (AT-CONTROL-PRIMARY)
 14512*     END-EXEC.
 14513     MOVE LENGTH OF
 14514      ACTIVITY-TRAILERS
 14515       TO DFHEIV11
 14516     MOVE 'ELTRLR' TO DFHEIV1
 14517*    MOVE '&$ L                  ''   #00013650' TO DFHEIV0
 14518     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14519     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14520     MOVE X'2020233030303133363530' TO DFHEIV0(25:11)
 14521     CALL 'kxdfhei1' USING DFHEIV0,
 14522           DFHEIV1,
 14523           ACTIVITY-TRAILERS,
 14524           DFHEIV11,
 14525           AT-CONTROL-PRIMARY,
 14526           DFHEIV99,
 14527           DFHEIV99
 14528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14529
 14530
 14531 6176-APPROVAL-NOTE.
 14532
 14533     IF NOT APPROVAL-NEEDED
 14534         GO TO 6199-EXIT.
 14535
 14536
 14537* EXEC CICS GETMAIN
 14538*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14539*        LENGTH    (200)
 14540*        INITIMG   (GETMAIN-SPACE)
 14541*    END-EXEC.
 14542     MOVE 200
 14543       TO DFHEIV11
 14544*    MOVE ',"IL                  $   #00013661' TO DFHEIV0
 14545     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14546     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14547     MOVE X'2020233030303133363631' TO DFHEIV0(25:11)
 14548     CALL 'kxdfhei1' USING DFHEIV0,
 14549           DFHEIV20,
 14550           DFHEIV11,
 14551           GETMAIN-SPACE
 14552     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14553         DFHEIV20
 14554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14555
 14556
 14557     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 14558
 14559     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 14560     MOVE 'AT'               TO AT-RECORD-ID
 14561     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 14562     MOVE '6'                TO AT-TRAILER-TYPE
 14563     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 14564                                AT-GEN-INFO-LAST-MAINT-DT
 14565     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 14566                                AT-GEN-INFO-LAST-UPDATED-BY
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 283
* EL156.cbl
 14567     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 14568
 14569     MOVE WS-APPROV-NOTE     TO AT-INFO-LINE-1
 14570     MOVE SPACES             TO AT-INFO-LINE-2
 14571
 14572     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 14573 6177-WRITE.
 14574
 14575
 14576* EXEC CICS HANDLE CONDITION
 14577*        DUPREC    (6185-DUPREC)
 14578*    END-EXEC.
 14579*    MOVE '"$%                   ! 5 #00013685' TO DFHEIV0
 14580     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14581     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14582     MOVE X'3520233030303133363835' TO DFHEIV0(25:11)
 14583     CALL 'kxdfhei1' USING DFHEIV0
 14584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14585
 14586
 14587
 14588* EXEC CICS WRITE
 14589*         DATASET     ('ELTRLR')
 14590*         FROM        (ACTIVITY-TRAILERS)
 14591*         RIDFLD      (AT-CONTROL-PRIMARY)
 14592*     END-EXEC.
 14593     MOVE LENGTH OF
 14594      ACTIVITY-TRAILERS
 14595       TO DFHEIV11
 14596     MOVE 'ELTRLR' TO DFHEIV1
 14597*    MOVE '&$ L                  ''   #00013689' TO DFHEIV0
 14598     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14599     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14600     MOVE X'2020233030303133363839' TO DFHEIV0(25:11)
 14601     CALL 'kxdfhei1' USING DFHEIV0,
 14602           DFHEIV1,
 14603           ACTIVITY-TRAILERS,
 14604           DFHEIV11,
 14605           AT-CONTROL-PRIMARY,
 14606           DFHEIV99,
 14607           DFHEIV99
 14608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14609
 14610
 14611
 14612     GO TO 6199-EXIT.
 14613
 14614 6180-DUPREC.
 14615
 14616     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14617     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14618     GO TO 6170-WRITE.
 14619
 14620 6185-DUPREC.
 14621     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14622     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14623     GO TO 6177-WRITE.
 14624
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 284
* EL156.cbl
 14625 6190-DUPREC.
 14626     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14627     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14628     GO TO 6175-WRITE.
 14629
 14630 6199-EXIT.
 14631      EXIT.
 14632
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 285
* EL156.cbl
 14634 6200-UPDATE-CLAIM-MSTR.
 14635     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14636     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14637     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14638     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14639
 14640     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 14641
 14642     MOVE ZEROS                  TO W-INTEREST.
 14643
 14644     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 14645        IF (PI-OFFLINE = 'Y') OR
 14646           (PI-PMTTYPE = '7')
 14647           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14648                                 THRU 9870-EXIT
 14649        END-IF
 14650     END-IF
 14651     IF NOT ERROR-ON-OUTPUT
 14652        CONTINUE
 14653     ELSE
 14654
 14655* EXEC CICS REWRITE
 14656*          DATASET('ELMSTR')
 14657*          FROM(CLAIM-MASTER)
 14658*       END-EXEC
 14659     MOVE LENGTH OF
 14660      CLAIM-MASTER
 14661       TO DFHEIV11
 14662     MOVE 'ELMSTR' TO DFHEIV1
 14663*    MOVE '&& L                  %   #00013738' TO DFHEIV0
 14664     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14665     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14666     MOVE X'2020233030303133373338' TO DFHEIV0(25:11)
 14667     CALL 'kxdfhei1' USING DFHEIV0,
 14668           DFHEIV1,
 14669           CLAIM-MASTER,
 14670           DFHEIV11,
 14671           DFHEIV99
 14672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14673
 14674        MOVE -1                  TO ENTPFBL
 14675        MOVE AL-UANON            TO ENTPFBA
 14676        MOVE MAP-NAMEB           TO MAP-NAME
 14677        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14678        GO TO 8200-SEND-DATAONLY
 14679     END-IF
 14680
 14681     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 14682
 14683     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 14684
 14685     IF PI-AIG-SPECIAL-BENEFIT
 14686         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 14687
 14688     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 14689
 14690     IF PI-SPECIAL-BEN-SW = 'Y'
 14691         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 286
* EL156.cbl
 14692         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 14693
 14694     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14695         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 14696     ELSE
 14697         IF PI-PMTTYPE NOT = '4'
 14698            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 14699
 14700     IF PI-PMTTYPE = '5' OR '6'
 14701        GO TO  6250-SET-MAINT.
 14702
 14703     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 14704                                         CL-LAG-REPORT-CODE.
 14705
 14706     IF CL-ACTIVITY-CODE = 09
 14707         GO TO 6200-CONT-UPDATE.
 14708
 14709     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14710         IF CL-ACTIVITY-CODE = 11
 14711             GO TO 6200-CONT-UPDATE.
 14712
 14713     IF WS-ACT-REC-FOUND-SW = 'N'
 14714         GO TO 6200-CONT-UPDATE.
 14715
 14716     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 14717         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 14718         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 14719         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 14720
 14721     IF WS-UPDATE-SW = 'Y'
 14722         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 14723                                         CL-NEXT-FOLLOWUP-DT.
 14724
 14725 6200-CONT-UPDATE.
 14726
 14727     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14728       IF CLAIM-IS-CLOSED
 14729         IF PI-PMTTYPE = '2' OR '3' OR '4'
 14730           IF WS-OPEN-CLOSE-SW = '2'
 14731             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 14732                                        CL-LAST-CLOSE-DT.
 14733
 14734     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 14735        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 14736        MOVE 'O'                 TO CL-CLAIM-STATUS.
 14737
 14738     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 14739        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 14740        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 14741        MOVE 'C'                 TO CL-CLAIM-STATUS
 14742        IF PI-PMTTYPE = '2'
 14743           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14744           CONTINUE
 14745        ELSE
 14746           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 14747        END-IF
 14748     ELSE
 14749        IF PI-PMTTYPE = '2' OR '3'
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 287
* EL156.cbl
 14750           IF PI-PMTTYPE = '2' AND
 14751              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14752              CONTINUE
 14753           ELSE
 14754              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 14755           END-IF
 14756        END-IF
 14757     END-IF
 14758
 14759     IF PI-PMTTYPE = '4'
 14760        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 14761
 14762     IF PI-COMPANY-ID = 'CVL'
 14763         IF PI-LOAN-UPDATE-SW = 'Y'
 14764             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 14765             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 14766             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 14767             MOVE CL-CERT-STATE      TO  CERT-STATE
 14768             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 14769             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 14770             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 14771             MOVE 'CERT'             TO  FILE-SWITCH
 14772             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 14773             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 14774             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 14775
 14776     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 14777        GO TO 6220-USE-COMPUTED.
 14778
 14779     IF (PI-PMTTYPE = '4')  AND
 14780        (PI-EPYAMT < ZEROS)
 14781          COMPUTE CL-NO-OF-DAYS-PAID =
 14782                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 14783          IF CL-NO-OF-DAYS-PAID < +0
 14784              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 14785          ELSE
 14786              NEXT SENTENCE
 14787     ELSE
 14788          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 14789
 14790     IF PI-PROCESSOR-ID = 'FIX '
 14791        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 14792           NEXT SENTENCE
 14793        ELSE
 14794           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 14795     ELSE
 14796        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 14797
 14798     IF PI-PMTTYPE = '4'
 14799        GO TO 6250-SET-MAINT.
 14800
 14801     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 14802
 14803     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 14804     MOVE '4'                    TO DC-OPTION-CODE.
 14805     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14806     IF DATE-CONVERSION-ERROR
 14807        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 288
* EL156.cbl
 14808     ELSE
 14809        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 14810           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 14811           IF PI-AIG-SPECIAL-BENEFIT
 14812               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 14813           ELSE
 14814               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 14815
 14816     GO TO 6250-SET-MAINT.
 14817
 14818 6220-USE-COMPUTED.
 14819
 14820     IF (PI-PMTTYPE = '4')  AND
 14821        (PI-CPYAMT < ZEROS)
 14822          COMPUTE CL-NO-OF-DAYS-PAID =
 14823                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 14824          IF CL-NO-OF-DAYS-PAID < +0
 14825              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 14826          ELSE
 14827              NEXT SENTENCE
 14828     ELSE
 14829          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 14830
 14831     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 14832
 14833     IF PI-PMTTYPE = '4'
 14834        GO TO 6250-SET-MAINT.
 14835
 14836     IF PI-AIG-SPECIAL-BENEFIT
 14837         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 14838     ELSE
 14839         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 14840
 14841     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 14842
 14843     IF PI-CPYTHRU > CL-PAID-THRU-DT
 14844        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 14845
 14846 6250-SET-MAINT.
 14847     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 14848
 14849     IF PI-PROCESSOR-ID = 'FIX '
 14850        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 14851           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 14852        ELSE
 14853           NEXT SENTENCE
 14854     ELSE
 14855        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 14856
 14857     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 14858     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 14859     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 14860
 14861 6299-EXIT.
 14862      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 289
* EL156.cbl
 14864 6300-UPDATE-CERT.
 14865
 14866*  ADD CERTNOTE FOR SC NP+6
 14867     IF PI-COMPANY-ID = 'CID' AND
 14868       (PI-PMTTYPE = '2' OR '3') AND
 14869        CL-CERT-STATE = 'SC'  AND
 14870        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 14871           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 14872     END-IF.
 14873
 14874     IF PI-COMPANY-ID = 'AHL' AND
 14875       (PI-PMTTYPE = '2' OR '3') AND
 14876        CL-CERT-STATE = 'SC'  AND
 14877        (PI-LF-BENEFIT-CD = '5I' OR '6J')
 14878           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 14879     END-IF.
 14880
 14881     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 14882     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 14883     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 14884     MOVE CL-CERT-STATE    TO CERT-STATE.
 14885     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 14886     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 14887     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 14888     MOVE 'CERT'           TO FILE-SWITCH.
 14889
 14890     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 14891
 14892     IF CERT-NOTE-ADDED
 14893        IF CM-NOTE-SW = ' '
 14894           MOVE '4'             TO CM-NOTE-SW
 14895        ELSE
 14896           IF CM-NOTE-SW = '1'
 14897               MOVE '5'           TO CM-NOTE-SW
 14898           ELSE
 14899              IF CM-NOTE-SW = '2'
 14900                 MOVE '6'         TO CM-NOTE-SW
 14901              ELSE
 14902                 IF CM-NOTE-SW = '3'
 14903                    MOVE '7'      TO CM-NOTE-SW
 14904                 END-IF
 14905              END-IF
 14906           END-IF
 14907        END-IF
 14908     END-IF.
 14909
 14910     IF PI-COMPANY-ID = 'CVL'
 14911         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 14912         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 14913
 14914     IF PI-PMTTYPE NOT = '4'
 14915        GO TO 6340-UPDATE-CERT.
 14916
 14917     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14918        IF PI-PFKEY-USED = DFHPF5
 14919           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 14920        ELSE
 14921           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 290
* EL156.cbl
 14922
 14923*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14924*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 14925*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 14926*               PI-LF-COVERAGE-TYPE = 'P'
 14927*                GO TO 6350-REWRITE-CERT.
 14928
 14929     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14930       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 14931          PI-LF-COVERAGE-TYPE = 'P'
 14932           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 14933                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 14934                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 14935                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 14936                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 14937                GO TO 6350-REWRITE-CERT
 14938            ELSE
 14939                GO TO 6350-REWRITE-CERT.
 14940
 14941     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14942         GO TO 6350-REWRITE-CERT.
 14943
 14944     IF NOT CM-AH-LUMP-SUM-DISAB
 14945        GO TO 6380-UNLOCK-CERT.
 14946
 14947     IF PI-PFKEY-USED = DFHPF5
 14948        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 14949                                    CM-AH-ITD-AH-PMT
 14950        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 14951        GO TO 6350-REWRITE-CERT
 14952     ELSE
 14953        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 14954                                    CM-AH-ITD-AH-PMT
 14955        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 14956        GO TO 6350-REWRITE-CERT.
 14957
 14958 6340-UPDATE-CERT.
 14959
 14960     IF CL-CLAIM-TYPE = 'L'
 14961         IF PI-PFKEY-USED = DFHPF5
 14962             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 14963         ELSE
 14964             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 14965
 14966     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14967         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 14968             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 14969                PI-LF-COVERAGE-TYPE = 'P'
 14970                 GO TO 6350-REWRITE-CERT.
 14971
 14972     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14973       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 14974          PI-LF-COVERAGE-TYPE = 'P'
 14975           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 14976                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 14977                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 14978                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 14979                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 291
* EL156.cbl
 14980                GO TO 6350-REWRITE-CERT.
 14981
 14982     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14983         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 14984            PI-LF-COVERAGE-TYPE NOT = 'P'
 14985             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 14986             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 14987             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 14988             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 14989             GO TO 6350-REWRITE-CERT.
 14990
 14991     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14992         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 14993         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 14994         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 14995         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 14996         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 14997         IF PI-PFKEY-USED = DFHPF5
 14998             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 14999                                        CM-AH-ITD-AH-PMT
 15000             GO TO 6350-REWRITE-CERT
 15001         ELSE
 15002             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 15003                                        CM-AH-ITD-AH-PMT
 15004             GO TO 6350-REWRITE-CERT.
 15005
 15006 6350-REWRITE-CERT.
 15007
 15008
 15009* EXEC CICS REWRITE
 15010*         DATASET  ('ELCERT')
 15011*         FROM(CERTIFICATE-MASTER)
 15012*     END-EXEC.
 15013     MOVE LENGTH OF
 15014      CERTIFICATE-MASTER
 15015       TO DFHEIV11
 15016     MOVE 'ELCERT' TO DFHEIV1
 15017*    MOVE '&& L                  %   #00014077' TO DFHEIV0
 15018     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15019     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15020     MOVE X'2020233030303134303737' TO DFHEIV0(25:11)
 15021     CALL 'kxdfhei1' USING DFHEIV0,
 15022           DFHEIV1,
 15023           CERTIFICATE-MASTER,
 15024           DFHEIV11,
 15025           DFHEIV99
 15026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15027
 15028
 15029     GO TO 6399-EXIT.
 15030
 15031 6380-UNLOCK-CERT.
 15032
 15033* EXEC CICS UNLOCK
 15034*         DATASET  ('ELCERT')
 15035*     END-EXEC.
 15036     MOVE 'ELCERT' TO DFHEIV1
 15037*    MOVE '&*                    #   #00014085' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 292
* EL156.cbl
 15038     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 15039     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15040     MOVE X'2020233030303134303835' TO DFHEIV0(25:11)
 15041     CALL 'kxdfhei1' USING DFHEIV0,
 15042           DFHEIV1,
 15043           DFHEIV99
 15044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15045
 15046
 15047 6399-EXIT.
 15048      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 293
* EL156.cbl
 15050 6400-UPDATE-ZERO-TRAILER.
 15051     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 15052     MOVE ZEROS                  TO TRLR-SEQ-NO.
 15053
 15054     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 15055
 15056     IF PI-EPYAMT NOT = ZEROS
 15057         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 15058     ELSE
 15059         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 15060
 15061     IF PI-ERESV NOT = ZEROS
 15062        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 15063
 15064     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 15065        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 15066
 15067     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 15068        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 15069     ELSE
 15070        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 15071
 15072     IF PI-PMTTYPE = '5'
 15073        IF PI-EPYAMT = ZEROS
 15074           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 15075        ELSE
 15076           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 15077
 15078     IF PI-PMTTYPE = '6'
 15079        IF PI-EPYAMT = ZEROS
 15080           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 15081        ELSE
 15082           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 15083
 15084 6420-CHECK-OPEN-CLOSE.
 15085     IF PI-PMTTYPE = '5' OR '6'
 15086        GO TO 6450-REWRITE.
 15087
 15088     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15089         IF PI-PMTTYPE = '2' OR '3' OR '4'
 15090             IF CLAIM-IS-CLOSED
 15091                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 15092                 MOVE 1          TO  SUB-1
 15093                 GO TO 6440-AIG-LOOP.
 15094
 15095     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 15096        GO TO 6450-REWRITE.
 15097
 15098     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 15099        GO TO 6450-REWRITE.
 15100
 15101     MOVE 1                      TO SUB-1.
 15102
 15103 6430-LOOP.
 15104     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 15105        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 15106        IF PI-PMTTYPE = '1' OR '4'
 15107           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 294
* EL156.cbl
 15108           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 15109           GO TO 6450-REWRITE
 15110        ELSE
 15111           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 15112           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 15113           GO TO 6450-REWRITE.
 15114
 15115     IF SUB-1 = 6
 15116      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 15117      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 15118      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 15119      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 15120      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 15121      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 15122      GO TO 6430-LOOP.
 15123
 15124     ADD 1                       TO SUB-1.
 15125     GO TO 6430-LOOP.
 15126
 15127
 15128 6440-AIG-LOOP.
 15129
 15130     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 15131       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 15132       IF WS-OPEN-CLOSE-SW = '1'
 15133         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 15134         IF PI-PMTTYPE = '2'
 15135           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15136           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 15137         ELSE
 15138           IF PI-PMTTYPE = '3'
 15139             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15140             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 15141           ELSE
 15142             IF PI-PMTTYPE = '4'
 15143               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15144               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 15145             ELSE
 15146               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15147               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 15148       ELSE
 15149         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 15150         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15151         GO TO 6450-REWRITE.
 15152
 15153     IF SUB-1 = 6
 15154      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 15155      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 15156      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 15157      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 15158      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 15159      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 15160      GO TO 6440-AIG-LOOP.
 15161
 15162     ADD 1                       TO SUB-1.
 15163     GO TO 6440-AIG-LOOP.
 15164
 15165 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 295
* EL156.cbl
 15166     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 15167     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 15168     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 15169
 15170     IF PI-COMPANY-ID = 'DMD'
 15171         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15172         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15173         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15174         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15175         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15176
 15177
 15178* EXEC CICS REWRITE
 15179*         DATASET  ('ELTRLR')
 15180*         FROM     (ACTIVITY-TRAILERS)
 15181*     END-EXEC.
 15182     MOVE LENGTH OF
 15183      ACTIVITY-TRAILERS
 15184       TO DFHEIV11
 15185     MOVE 'ELTRLR' TO DFHEIV1
 15186*    MOVE '&& L                  %   #00014219' TO DFHEIV0
 15187     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15188     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15189     MOVE X'2020233030303134323139' TO DFHEIV0(25:11)
 15190     CALL 'kxdfhei1' USING DFHEIV0,
 15191           DFHEIV1,
 15192           ACTIVITY-TRAILERS,
 15193           DFHEIV11,
 15194           DFHEIV99
 15195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15196
 15197
 15198 6499-EXIT.
 15199      EXIT.
 15200
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 296
* EL156.cbl
 15202 6500-READ-DLO035.
 15203     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 15204     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 15205     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 15206     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 15207
 15208
 15209* EXEC CICS LINK
 15210*        PROGRAM    ('DLO035')
 15211*        COMMAREA   (DLO035-KEY)
 15212*        LENGTH     (DL35-LENGTH)
 15213*    END-EXEC.
 15214     MOVE 'DLO035' TO DFHEIV1
 15215*    MOVE '."C                   ''   #00014234' TO DFHEIV0
 15216     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15217     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15218     MOVE X'2020233030303134323334' TO DFHEIV0(25:11)
 15219     CALL 'kxdfhei1' USING DFHEIV0,
 15220           DFHEIV1,
 15221           DLO035-KEY,
 15222           DL35-LENGTH,
 15223           DFHEIV99,
 15224           DFHEIV99,
 15225           DFHEIV99
 15226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15227
 15228
 15229     IF DL35-RETURN-CODE = 'OK'
 15230         GO TO 6500-EXIT.
 15231
 15232     IF DL35-RETURN-CODE = '01'
 15233         MOVE ER-7830            TO EMI-ERROR
 15234         GO TO 6500-BAD-EXIT.
 15235
 15236     IF DL35-RETURN-CODE = '02'
 15237         MOVE ER-7831            TO EMI-ERROR
 15238         GO TO 6500-BAD-EXIT.
 15239
 15240     IF DL35-RETURN-CODE = '03'
 15241         MOVE ER-7832            TO EMI-ERROR
 15242         GO TO 6500-BAD-EXIT.
 15243
 15244     IF DL35-RETURN-CODE = '04'
 15245         MOVE ER-7833            TO EMI-ERROR
 15246         GO TO 6500-BAD-EXIT.
 15247
 15248     IF DL35-RETURN-CODE = '05'
 15249         MOVE ER-7834            TO EMI-ERROR
 15250         GO TO 6500-BAD-EXIT.
 15251
 15252     IF DL35-RETURN-CODE = '06'
 15253         MOVE ER-7835            TO EMI-ERROR
 15254         GO TO 6500-BAD-EXIT.
 15255
 15256     IF DL35-RETURN-CODE = '07'
 15257         MOVE ER-7836            TO EMI-ERROR
 15258         GO TO 6500-BAD-EXIT.
 15259
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 297
* EL156.cbl
 15260     IF DL35-RETURN-CODE = 'E1'
 15261         MOVE ER-7837            TO EMI-ERROR
 15262         GO TO 6500-BAD-EXIT.
 15263
 15264     IF DL35-RETURN-CODE NOT = 'OK'
 15265         MOVE ER-7838            TO EMI-ERROR
 15266         GO TO 6500-BAD-EXIT.
 15267
 15268 6500-EXIT.
 15269      EXIT.
 15270
 15271 6500-BAD-EXIT.
 15272
 15273* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15274*    MOVE '6"R                   !   #00014283' TO DFHEIV0
 15275     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15276     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15277     MOVE X'2020233030303134323833' TO DFHEIV0(25:11)
 15278     CALL 'kxdfhei1' USING DFHEIV0
 15279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15280
 15281     MOVE -1                 TO PMTTYPEL.
 15282     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15283     GO TO 8200-SEND-DATAONLY.
 15284
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 298
* EL156.cbl
 15286 6600-UPDATE-DLO035.
 15287     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 15288     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 15289     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 15290     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 15291
 15292
 15293* EXEC CICS LINK
 15294*        PROGRAM    ('DLO035')
 15295*        COMMAREA   (DLO035-KEY)
 15296*        LENGTH     (DL35-LENGTH)
 15297*    END-EXEC.
 15298     MOVE 'DLO035' TO DFHEIV1
 15299*    MOVE '."C                   ''   #00014295' TO DFHEIV0
 15300     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15301     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15302     MOVE X'2020233030303134323935' TO DFHEIV0(25:11)
 15303     CALL 'kxdfhei1' USING DFHEIV0,
 15304           DFHEIV1,
 15305           DLO035-KEY,
 15306           DL35-LENGTH,
 15307           DFHEIV99,
 15308           DFHEIV99,
 15309           DFHEIV99
 15310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15311
 15312
 15313     IF DL35-RETURN-CODE = 'OK'
 15314         GO TO 6600-EXIT.
 15315
 15316     IF DL35-RETURN-CODE = '01'
 15317         MOVE ER-7830            TO EMI-ERROR
 15318         GO TO 6500-BAD-EXIT.
 15319
 15320     IF DL35-RETURN-CODE = '02'
 15321         MOVE ER-7831            TO EMI-ERROR
 15322         GO TO 6500-BAD-EXIT.
 15323
 15324     IF DL35-RETURN-CODE = '03'
 15325         MOVE ER-7832            TO EMI-ERROR
 15326         GO TO 6500-BAD-EXIT.
 15327
 15328     IF DL35-RETURN-CODE = '04'
 15329         MOVE ER-7833            TO EMI-ERROR
 15330         GO TO 6500-BAD-EXIT.
 15331
 15332     IF DL35-RETURN-CODE = '05'
 15333         MOVE ER-7834            TO EMI-ERROR
 15334         GO TO 6500-BAD-EXIT.
 15335
 15336     IF DL35-RETURN-CODE = '06'
 15337         MOVE ER-7835            TO EMI-ERROR
 15338         GO TO 6500-BAD-EXIT.
 15339
 15340     IF DL35-RETURN-CODE = '07'
 15341         MOVE ER-7836            TO EMI-ERROR
 15342         GO TO 6500-BAD-EXIT.
 15343
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 299
* EL156.cbl
 15344     IF DL35-RETURN-CODE = 'E1'
 15345         MOVE ER-7837            TO EMI-ERROR
 15346         GO TO 6500-BAD-EXIT.
 15347
 15348     IF DL35-RETURN-CODE NOT = 'OK'
 15349         MOVE ER-7838            TO EMI-ERROR
 15350         GO TO 6500-BAD-EXIT.
 15351
 15352 6600-EXIT.
 15353      EXIT.
 15354
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 300
* EL156.cbl
 15356 6700-UPDATE-ACTQ.
 15357***************************************************************
 15358*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 15359*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 15360*    ONE ALREADY THERE.                                       *
 15361***************************************************************
 15362
 15363
 15364* EXEC CICS HANDLE CONDITION
 15365*         NOTFND(6720-BUILD-NEW-RECORD)
 15366*     END-EXEC.
 15367*    MOVE '"$I                   ! 6 #00014351' TO DFHEIV0
 15368     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15369     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15370     MOVE X'3620233030303134333531' TO DFHEIV0(25:11)
 15371     CALL 'kxdfhei1' USING DFHEIV0
 15372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15373
 15374
 15375
 15376* EXEC CICS READ
 15377*         DATASET('ELACTQ')
 15378*         RIDFLD (ELMSTR-KEY)
 15379*         SET    (ADDRESS OF ACTIVITY-QUE)
 15380*         UPDATE
 15381*     END-EXEC.
 15382     MOVE 'ELACTQ' TO DFHEIV1
 15383*    MOVE '&"S        EU         (   #00014355' TO DFHEIV0
 15384     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15385     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15386     MOVE X'2020233030303134333535' TO DFHEIV0(25:11)
 15387     CALL 'kxdfhei1' USING DFHEIV0,
 15388           DFHEIV1,
 15389           DFHEIV20,
 15390           DFHEIV99,
 15391           ELMSTR-KEY,
 15392           DFHEIV99,
 15393           DFHEIV99,
 15394           DFHEIV99
 15395     SET ADDRESS OF ACTIVITY-QUE TO
 15396         DFHEIV20
 15397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15398
 15399
 15400     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 15401
 15402     IF PI-AIG-SPECIAL-BENEFIT AND
 15403        PI-CASH = 'Y'
 15404         ADD 2                   TO AQ-PAYMENT-COUNTER
 15405     ELSE
 15406         ADD 1                   TO AQ-PAYMENT-COUNTER.
 15407
 15408     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 15409         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 15410
 15411     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 15412
 15413     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 301
* EL156.cbl
 15414         IF WS-PMT-APPROVAL-SW = 'A'
 15415             NEXT SENTENCE
 15416         ELSE
 15417            IF PI-AIG-SPECIAL-BENEFIT AND
 15418               PI-CASH = 'Y'
 15419                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15420                                     WS-PMT-UNAPPROVED-CNT
 15421            ELSE
 15422                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15423                                     WS-PMT-UNAPPROVED-CNT
 15424     ELSE
 15425         IF PI-PMT-APPR-SW = 'Y'
 15426            IF PI-AIG-SPECIAL-BENEFIT AND
 15427               PI-CASH = 'Y'
 15428                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15429                                     WS-PMT-UNAPPROVED-CNT
 15430            ELSE
 15431                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15432                                     WS-PMT-UNAPPROVED-CNT.
 15433
 15434     IF WS-PMT-UNAPPROVED-CNT > ZERO
 15435         MOVE ER-3536 TO EMI-ERROR
 15436         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15437
 15438     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 15439
 15440
 15441* EXEC CICS REWRITE
 15442*         DATASET('ELACTQ')
 15443*         FROM   (ACTIVITY-QUE)
 15444*     END-EXEC.
 15445     MOVE LENGTH OF
 15446      ACTIVITY-QUE
 15447       TO DFHEIV11
 15448     MOVE 'ELACTQ' TO DFHEIV1
 15449*    MOVE '&& L                  %   #00014402' TO DFHEIV0
 15450     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15451     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15452     MOVE X'2020233030303134343032' TO DFHEIV0(25:11)
 15453     CALL 'kxdfhei1' USING DFHEIV0,
 15454           DFHEIV1,
 15455           ACTIVITY-QUE,
 15456           DFHEIV11,
 15457           DFHEIV99
 15458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15459
 15460
 15461     GO TO 6799-EXIT.
 15462
 15463 6720-BUILD-NEW-RECORD.
 15464
 15465* EXEC CICS GETMAIN
 15466*         SET    (ADDRESS OF ACTIVITY-QUE)
 15467*         LENGTH (60)
 15468*         INITIMG(GETMAIN-SPACE)
 15469*     END-EXEC.
 15470     MOVE 60
 15471       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 302
* EL156.cbl
 15472*    MOVE ',"IL                  $   #00014410' TO DFHEIV0
 15473     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15474     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15475     MOVE X'2020233030303134343130' TO DFHEIV0(25:11)
 15476     CALL 'kxdfhei1' USING DFHEIV0,
 15477           DFHEIV20,
 15478           DFHEIV11,
 15479           GETMAIN-SPACE
 15480     SET ADDRESS OF ACTIVITY-QUE TO
 15481         DFHEIV20
 15482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15483
 15484
 15485     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 15486
 15487     IF PI-AIG-SPECIAL-BENEFIT AND
 15488        PI-CASH = 'Y'
 15489         MOVE 2                  TO AQ-PAYMENT-COUNTER
 15490     ELSE
 15491         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 15492
 15493     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 15494     MOVE 'AQ'                   TO AQ-RECORD-ID.
 15495     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 15496     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 15497                                    AQ-FOLLOWUP-DATE.
 15498     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 15499     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 15500
 15501     IF PI-PMT-GRADUATED
 15502         IF WS-PMT-APPROVAL-SW = 'A'
 15503             NEXT SENTENCE
 15504         ELSE
 15505            IF PI-AIG-SPECIAL-BENEFIT AND
 15506               PI-CASH = 'Y'
 15507                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15508            ELSE
 15509                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15510     ELSE
 15511         IF PI-PMT-APPR-SW = 'Y'
 15512            IF PI-AIG-SPECIAL-BENEFIT AND
 15513               PI-CASH = 'Y'
 15514                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15515            ELSE
 15516                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 15517
 15518     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 15519         MOVE ER-3536 TO EMI-ERROR
 15520         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15521
 15522
 15523* EXEC CICS WRITE
 15524*         DATASET('ELACTQ')
 15525*         RIDFLD (ELMSTR-KEY)
 15526*         FROM   (ACTIVITY-QUE)
 15527*     END-EXEC.
 15528     MOVE LENGTH OF
 15529      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 303
* EL156.cbl
 15530       TO DFHEIV11
 15531     MOVE 'ELACTQ' TO DFHEIV1
 15532*    MOVE '&$ L                  ''   #00014453' TO DFHEIV0
 15533     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15534     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15535     MOVE X'2020233030303134343533' TO DFHEIV0(25:11)
 15536     CALL 'kxdfhei1' USING DFHEIV0,
 15537           DFHEIV1,
 15538           ACTIVITY-QUE,
 15539           DFHEIV11,
 15540           ELMSTR-KEY,
 15541           DFHEIV99,
 15542           DFHEIV99
 15543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15544
 15545
 15546 6799-EXIT.
 15547      EXIT.
 15548
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 304
* EL156.cbl
 15550 6800-BUILD-FORM-TRAILER.
 15551
 15552
 15553* EXEC CICS GETMAIN
 15554*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15555*         LENGTH   (200)
 15556*         INITIMG  (GETMAIN-SPACE)
 15557*    END-EXEC.
 15558     MOVE 200
 15559       TO DFHEIV11
 15560*    MOVE ',"IL                  $   #00014465' TO DFHEIV0
 15561     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15562     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15563     MOVE X'2020233030303134343635' TO DFHEIV0(25:11)
 15564     CALL 'kxdfhei1' USING DFHEIV0,
 15565           DFHEIV20,
 15566           DFHEIV11,
 15567           GETMAIN-SPACE
 15568     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15569         DFHEIV20
 15570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15571
 15572
 15573     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 15574
 15575     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 15576     MOVE 'AT'                   TO AT-RECORD-ID.
 15577     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15578
 15579     MOVE 'A'                    TO AT-TRAILER-TYPE.
 15580     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15581                                    AT-FORM-LAST-MAINT-DT
 15582                                    AT-FORM-SEND-ON-DT.
 15583     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15584                                    AT-FORM-LAST-UPDATED-BY.
 15585     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15586     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 15587     MOVE '6'                    TO DC-OPTION-CODE.
 15588     MOVE +29                    TO DC-ELAPSED-DAYS.
 15589     MOVE +0                     TO DC-ELAPSED-MONTHS.
 15590     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15591     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 15592
 15593     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 15594         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 15595
 15596     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 15597                                    AT-FORM-RE-SEND-DT
 15598                                    AT-EMP-FORM-ANSWERED-DT
 15599                                    AT-PHY-FORM-ANSWERED-DT
 15600                                    AT-EMP-FORM-SEND-ON-DT
 15601                                    AT-PHY-FORM-SEND-ON-DT
 15602                                    AT-FORM-PRINTED-DT
 15603                                    AT-FORM-REPRINT-DT.
 15604     MOVE '2'                    TO AT-FORM-TYPE.
 15605
 15606     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 15607     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 305
* EL156.cbl
 15608
 15609     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 15610         NEXT SENTENCE
 15611     ELSE
 15612         IF CL-PROG-FORM-TYPE NOT = 'S'
 15613            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 15614
 15615
 15616* EXEC CICS WRITE
 15617*         DATASET  ('ELTRLR')
 15618*         FROM     (ACTIVITY-TRAILERS)
 15619*         RIDFLD   (AT-CONTROL-PRIMARY)
 15620*     END-EXEC.
 15621     MOVE LENGTH OF
 15622      ACTIVITY-TRAILERS
 15623       TO DFHEIV11
 15624     MOVE 'ELTRLR' TO DFHEIV1
 15625*    MOVE '&$ L                  ''   #00014513' TO DFHEIV0
 15626     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15627     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15628     MOVE X'2020233030303134353133' TO DFHEIV0(25:11)
 15629     CALL 'kxdfhei1' USING DFHEIV0,
 15630           DFHEIV1,
 15631           ACTIVITY-TRAILERS,
 15632           DFHEIV11,
 15633           AT-CONTROL-PRIMARY,
 15634           DFHEIV99,
 15635           DFHEIV99
 15636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15637
 15638
 15639 6899-EXIT.
 15640      EXIT.
 15641
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 306
* EL156.cbl
 15643 6900-BUILD-ARCHIVE-HEADER.
 15644
 15645     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15646     MOVE '1'                    TO CNTL-REC-TYPE.
 15647     MOVE +0                     TO CNTL-SEQ-NO.
 15648     MOVE SPACES                 TO CNTL-ACCESS.
 15649
 15650
 15651* EXEC CICS READ
 15652*         DATASET  ('ELCNTL')
 15653*         SET      (ADDRESS OF CONTROL-FILE)
 15654*         RIDFLD   (ELCNTL-KEY)
 15655*         UPDATE
 15656*    END-EXEC.
 15657     MOVE 'ELCNTL' TO DFHEIV1
 15658*    MOVE '&"S        EU         (   #00014530' TO DFHEIV0
 15659     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15660     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15661     MOVE X'2020233030303134353330' TO DFHEIV0(25:11)
 15662     CALL 'kxdfhei1' USING DFHEIV0,
 15663           DFHEIV1,
 15664           DFHEIV20,
 15665           DFHEIV99,
 15666           ELCNTL-KEY,
 15667           DFHEIV99,
 15668           DFHEIV99,
 15669           DFHEIV99
 15670     SET ADDRESS OF CONTROL-FILE TO
 15671         DFHEIV20
 15672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15673
 15674
 15675     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 15676     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 15677
 15678
 15679* EXEC CICS REWRITE
 15680*         FROM     (CONTROL-FILE)
 15681*         DATASET  ('ELCNTL')
 15682*    END-EXEC.
 15683     MOVE LENGTH OF
 15684      CONTROL-FILE
 15685       TO DFHEIV11
 15686     MOVE 'ELCNTL' TO DFHEIV1
 15687*    MOVE '&& L                  %   #00014540' TO DFHEIV0
 15688     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15689     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15690     MOVE X'2020233030303134353430' TO DFHEIV0(25:11)
 15691     CALL 'kxdfhei1' USING DFHEIV0,
 15692           DFHEIV1,
 15693           CONTROL-FILE,
 15694           DFHEIV11,
 15695           DFHEIV99
 15696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15697
 15698
 15699
 15700* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 307
* EL156.cbl
 15701*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 15702*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 15703*    END-EXEC.
 15704*    MOVE '"$$%                  ! 7 #00014545' TO DFHEIV0
 15705     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 15706     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15707     MOVE X'3720233030303134353435' TO DFHEIV0(25:11)
 15708     CALL 'kxdfhei1' USING DFHEIV0
 15709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15710
 15711
 15712
 15713* EXEC CICS GETMAIN
 15714*         SET     (ADDRESS OF LETTER-ARCHIVE)
 15715*         LENGTH  (ELARCH-LENGTH)
 15716*         INITIMG (GETMAIN-SPACE)
 15717*    END-EXEC.
 15718*    MOVE ',"IL                  $   #00014550' TO DFHEIV0
 15719     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15720     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15721     MOVE X'2020233030303134353530' TO DFHEIV0(25:11)
 15722     CALL 'kxdfhei1' USING DFHEIV0,
 15723           DFHEIV20,
 15724           ELARCH-LENGTH,
 15725           GETMAIN-SPACE
 15726     SET ADDRESS OF LETTER-ARCHIVE TO
 15727         DFHEIV20
 15728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15729
 15730
 15731     MOVE 'LA'                   TO LA-RECORD-ID.
 15732     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 15733                                    LA-ARCHIVE-NO-A1.
 15734     MOVE '4'                    TO LA-RECORD-TYPE
 15735                                    LA-RECORD-TYPE-A1.
 15736     MOVE +0                     TO LA-LINE-SEQ-NO
 15737                                    LA-LINE-SEQ-NO-A1.
 15738     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 15739                                    LA-COMPANY-CD-A1.
 15740     MOVE CL-CARRIER             TO LA4-CARRIER.
 15741     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 15742     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 15743     MOVE CL-CERT-STATE          TO LA4-STATE.
 15744     MOVE +0                     TO LA4-NO-OF-COPIES.
 15745     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 15746     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 15747     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 15748                                    LA4-INITIAL-PRINT-DATE
 15749                                    LA4-RESEND-PRINT-DATE
 15750                                    LA4-FORM-REM-PRINT-DT.
 15751     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 15752     MOVE '2'                    TO LA4-FORM-TYPE.
 15753
 15754
 15755* EXEC CICS WRITE
 15756*         DATASET  ('ELARCH')
 15757*         FROM     (LETTER-ARCHIVE)
 15758*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 308
* EL156.cbl
 15759*    END-EXEC.
 15760     MOVE LENGTH OF
 15761      LETTER-ARCHIVE
 15762       TO DFHEIV11
 15763     MOVE 'ELARCH' TO DFHEIV1
 15764*    MOVE '&$ L                  ''   #00014579' TO DFHEIV0
 15765     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15766     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15767     MOVE X'2020233030303134353739' TO DFHEIV0(25:11)
 15768     CALL 'kxdfhei1' USING DFHEIV0,
 15769           DFHEIV1,
 15770           LETTER-ARCHIVE,
 15771           DFHEIV11,
 15772           LA-CONTROL-PRIMARY,
 15773           DFHEIV99,
 15774           DFHEIV99
 15775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15776
 15777
 15778 6999-EXIT.
 15779      EXIT.
 15780
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 309
* EL156.cbl
 15782 7000-SHOW-CLAIM.
 15783     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 15784     MOVE 'A'                    TO PI-PASS-SW.
 15785     MOVE LOW-VALUES             TO PI-CPYFROM
 15786                                    PI-MONTH-END-SAVE
 15787                                    PI-CPYTHRU.
 15788
 15789     MOVE ZEROS                  TO PI-FATAL-COUNT
 15790                                    PI-DAILY-RATE
 15791                                    PI-BEN-DAYS
 15792                                    PI-MANUAL-SW
 15793                                    PI-SAVE-CURSOR
 15794                                    PI-FORCE-COUNT
 15795                                    PI-HOLDTIL
 15796                                    PI-EPYFROM
 15797                                    PI-EPYTHRU
 15798                                    PI-EDAYS
 15799                                    PI-EPYAMT
 15800                                    PI-ERESV
 15801                                    PI-EEXPENS
 15802                                    PI-CDAYS
 15803                                    PI-CPYAMT
 15804                                    PI-CRESV
 15805                                    PI-CEXPENS
 15806                                    PI-INT-RATE
 15807                                    PI-AIGFROM.
 15808     MOVE ZEROS                  TO PI-PROOF-DATE.
 15809     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 15810                                    PI-REM-BEN-AMT
 15811                                    PI-MO-BEN-AMT.
 15812
 15813     MOVE LOW-VALUES             TO EL156AI.
 15814     MOVE MAP-NAMEA              TO MAP-NAME.
 15815
 15816 7010-BUILD-MAP.
 15817
 15818
 15819* EXEC CICS HANDLE CONDITION
 15820*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 15821*    END-EXEC.
 15822*    MOVE '"$I                   ! 8 #00014625' TO DFHEIV0
 15823     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15824     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15825     MOVE X'3820233030303134363235' TO DFHEIV0(25:11)
 15826     CALL 'kxdfhei1' USING DFHEIV0
 15827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15828
 15829
 15830     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15831     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15832     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15833     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15834     MOVE 'MSTR'                 TO FILE-SWITCH.
 15835
 15836     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 15837
 15838     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 15839     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 310
* EL156.cbl
 15840     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 15841     MOVE CL-CCN                 TO PI-SV-CCN.
 15842
 15843     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 15844     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 15845     MOVE CL-CLAIM-NO            TO CLMNOO.
 15846     MOVE CL-CARRIER             TO CARRO.
 15847     MOVE CL-CERT-PRIME          TO CERTNOO.
 15848     MOVE CL-CERT-SFX            TO SUFXO.
 15849
 15850     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 15851        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 15852        CONTINUE
 15853     ELSE
 15854        MOVE AL-SADOF            TO ZINTHA
 15855                                    ZINTA
 15856                                    PINTHA
 15857                                    PINTA
 15858     END-IF
 15859     EVALUATE TRUE
 15860     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 15861         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 15862     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15863         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 15864
 15865     WHEN CL-CLAIM-TYPE = 'I'
 15866         MOVE '  IU  '           TO CLMTYPO
 15867     WHEN CL-CLAIM-TYPE = 'G'
 15868         MOVE ' GAP  '           TO CLMTYPO
 15869     END-EVALUATE.
 15870     IF CLAIM-IS-OPEN
 15871         MOVE ' OPEN'            TO CLMSTATO
 15872     ELSE
 15873         MOVE 'CLOSED'           TO CLMSTATO.
 15874
 15875     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 15876
 15877     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 15878         MOVE SPACES             TO  PCERTNOO
 15879                                     PSUFXO
 15880                                     PRIMHDGO
 15881                                     SEQUO
 15882         MOVE AL-SADOF           TO  PCERTNOA
 15883                                     PSUFXA
 15884                                     PRIMHDGA
 15885                                     SEQUA
 15886     ELSE
 15887         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 15888         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 15889         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 15890         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 15891         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 15892         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 15893         MOVE AL-SANON               TO  PCERTNOA
 15894                                         PSUFXA
 15895                                         PRIMHDGA
 15896         MOVE AL-SABON               TO  SEQUA.
 15897
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 311
* EL156.cbl
 15898     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 15899
 15900     IF CL-NO-OF-PMTS-MADE = 0 AND
 15901        CL-TOTAL-PAID-AMT = 0
 15902         NEXT SENTENCE
 15903     ELSE
 15904         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 15905             IF NOT PI-USES-PAID-TO
 15906                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 15907                 MOVE ' '                 TO DC-OPTION-CODE
 15908                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15909                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15910             ELSE
 15911                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 15912                 MOVE '6'                 TO DC-OPTION-CODE
 15913                 MOVE +1                  TO DC-ELAPSED-DAYS
 15914                 MOVE +0                  TO DC-ELAPSED-MONTHS
 15915                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15916                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 15917
 15918     IF MAP-NAME = 'EL156A'
 15919     IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 15920        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 15921          MOVE AL-SADOF TO    AIGFRMHA AIGFROMA.
 15922
 15923     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 15924         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 15925         MOVE ' '                TO DC-OPTION-CODE
 15926         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15927         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 15928
 15929     IF CL-INCURRED-DT NOT = LOW-VALUES
 15930         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 15931         MOVE ' '                TO DC-OPTION-CODE
 15932         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15933         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 15934
 15935     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 15936
 15937     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 15938         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 15939         MOVE ' '                TO DC-OPTION-CODE
 15940         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15941         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 15942
 15943     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15944         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 15945         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 15946     ELSE
 15947         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 15948         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 15949
 15950     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 15951     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 15952     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 15953     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 15954                                    PI-GROUPING.
 15955     MOVE CL-CERT-STATE          TO CERT-STATE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 312
* EL156.cbl
 15956                                    PI-STATE.
 15957     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 15958                                    PI-ACCOUNT.
 15959     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 15960     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 15961     MOVE 'CERT'                 TO FILE-SWITCH.
 15962
 15963     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 15964
 15965     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15966     MOVE PI-STATE               TO WS-ST-ACCESS.
 15967     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 15968     MOVE '3'                    TO CNTL-REC-TYPE.
 15969     MOVE +0                     TO CNTL-SEQ-NO.
 15970     MOVE 'STAT'                 TO FILE-SWITCH.
 15971
 15972     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15973
 15974     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 15975     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 15976
 15977     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 15978        GO TO 7020-BYPASS-BENEFIT.
 15979
 15980     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15981     MOVE '4'                    TO CNTL-REC-TYPE.
 15982     MOVE +0                     TO CNTL-SEQ-NO.
 15983     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 15984     MOVE WS-ACCESS              TO CNTL-ACCESS.
 15985     MOVE 'BENE'                 TO FILE-SWITCH.
 15986
 15987     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 15988
 15989     IF NO-BENEFIT-FOUND
 15990        GO TO 7020-BYPASS-BENEFIT.
 15991
 15992     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 15993     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 15994     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 15995
 15996 7020-BYPASS-BENEFIT.
 15997
 15998*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15999*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 16000*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 16001
 16002     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 16003         GO TO 7021-GO-TO-LIFE.
 16004
 16005     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 16006     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 16007     MOVE CM-AH-BENEFIT-AMT      TO BENEO.
 16008     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 16009     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 16010                                    CP-ORIGINAL-TERM.
 16011     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 16012
 16013*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 313
* EL156.cbl
 16014*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 16015*    ELSE
 16016         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 16017
 16018     MOVE ' '                    TO DC-OPTION-CODE.
 16019     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16020     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 16021
 16022     IF PI-COMPANY-ID = 'DMD'
 16023         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 16024         GO TO 7023-BYPASS-REMAINING-TERM.
 16025
 16026     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 16027     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 16028     GO TO 7022-AROUND-LIFE.
 16029
 16030 7021-GO-TO-LIFE.
 16031
 16032     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16033     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 16034     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 16035                                    CP-ORIGINAL-TERM.
 16036     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 16037     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 16038     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 16039     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 16040
 16041     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16042         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 16043     ELSE
 16044         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 16045
 16046     MOVE ' '                    TO DC-OPTION-CODE.
 16047     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16048     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 16049
 16050 7022-AROUND-LIFE.
 16051
 16052     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 16053     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16054     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 16055     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 16056     MOVE '4'                    TO CP-REM-TERM-METHOD.
 16057     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 16058     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 16059
 16060     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 16061
 16062     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16063        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 16064           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 16065
 16066     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16067        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 16068           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 16069
 16070 7023-BYPASS-REMAINING-TERM.
 16071
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 314
* EL156.cbl
 16072     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16073       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 16074          MOVE ZEROS                  TO BENEO
 16075       ELSE
 16076          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 16077          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 16078          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 16079          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 16080          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 16081          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 16082          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 16083          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 16084          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 16085          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 16086          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 16087          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 16088
 16089* EXEC CICS LINK
 16090*            PROGRAM  (LINK-REMAMT)
 16091*            COMMAREA (CALCULATION-PASS-AREA)
 16092*            LENGTH   (CP-COMM-LENGTH)
 16093*         END-EXEC
 16094*    MOVE '."C                   ''   #00014887' TO DFHEIV0
 16095     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16096     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16097     MOVE X'2020233030303134383837' TO DFHEIV0(25:11)
 16098     CALL 'kxdfhei1' USING DFHEIV0,
 16099           LINK-REMAMT,
 16100           CALCULATION-PASS-AREA,
 16101           CP-COMM-LENGTH,
 16102           DFHEIV99,
 16103           DFHEIV99,
 16104           DFHEIV99
 16105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16106          MOVE CP-REMAINING-AMT       TO BENEO.
 16107
 16108     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16109         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16110            WS-LF-COVERAGE-TYPE = 'P'
 16111             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 16112                                        CM-LF-ITD-DEATH-AMT
 16113             MOVE WS-REMAINING-AMT  TO  BENEO.
 16114
 16115     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 16116     MOVE BENEO                  TO PI-REM-BEN-AMT.
 16117     MOVE WS-TERMS               TO TERMSO.
 16118
 16119     IF WS-STATUS = '6' OR '7' OR '8'
 16120         MOVE AL-SABOF           TO CRTSTATA.
 16121
 16122     IF WS-STATUS = '1' OR '4'
 16123        IF CP-REMAINING-TERM-3 = ZEROS
 16124           MOVE 'EXPIRED'        TO CRTSTATO
 16125        ELSE
 16126           MOVE 'ACTIVE  '       TO CRTSTATO.
 16127
 16128     IF WS-STATUS = '2'
 16129         MOVE 'PEND    '         TO CRTSTATO.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 315
* EL156.cbl
 16130
 16131     IF WS-STATUS = '3'
 16132         MOVE 'RESTORE '         TO CRTSTATO.
 16133
 16134     IF WS-STATUS = '5'
 16135         MOVE 'REISSUE '         TO CRTSTATO.
 16136
 16137     IF WS-STATUS = '6'
 16138         MOVE 'LMP DIS'          TO CRTSTATO.
 16139
 16140     IF WS-STATUS = '7'
 16141         MOVE 'DEATH'            TO CRTSTATO.
 16142
 16143     IF WS-STATUS = '8'
 16144         MOVE 'CANCEL'           TO CRTSTATO.
 16145
 16146     IF WS-STATUS = '9'
 16147         MOVE 'RE-ONLY '         TO CRTSTATO.
 16148
 16149     IF WS-STATUS = 'V'
 16150         MOVE 'VOID  '           TO CRTSTATO.
 16151
 16152     IF WS-STATUS = 'D'
 16153         MOVE 'DECLINE '         TO CRTSTATO.
 16154
 16155     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16156         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 16157         MOVE '5'                TO CNTL-REC-TYPE
 16158     ELSE
 16159         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 16160         MOVE '4'                TO CNTL-REC-TYPE.
 16161
 16162     MOVE '** NONE **'           TO COVERO.
 16163     MOVE AL-SABON               TO COVERA.
 16164
 16165     IF PI-COMPANY-ID = 'CVL'
 16166         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 16167             MOVE CM-BENEFICIARY TO LOANNOO
 16168             MOVE AL-UANON       TO LOANNOA.
 16169
 16170     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 16171        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 16172        MOVE +91                 TO  TRLR-SEQ-NO
 16173
 16174* EXEC CICS READ
 16175*           DATASET  ('ELTRLR')
 16176*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16177*           RIDFLD   (ELTRLR-KEY)
 16178*           RESP     (WS-RESPONSE)
 16179*       END-EXEC
 16180     MOVE 'ELTRLR' TO DFHEIV1
 16181*    MOVE '&"S        E          (  N#00014959' TO DFHEIV0
 16182     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16183     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16184     MOVE X'204E233030303134393539' TO DFHEIV0(25:11)
 16185     CALL 'kxdfhei1' USING DFHEIV0,
 16186           DFHEIV1,
 16187           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 316
* EL156.cbl
 16188           DFHEIV99,
 16189           ELTRLR-KEY,
 16190           DFHEIV99,
 16191           DFHEIV99,
 16192           DFHEIV99
 16193     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16194         DFHEIV20
 16195     MOVE EIBRESP  TO WS-RESPONSE
 16196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16197
 16198        IF WS-RESP-NORMAL
 16199           MOVE AT-INFO-LINE-1   TO  LOANNOO
 16200        ELSE
 16201           MOVE SPACES           TO  LOANNOO
 16202        END-IF
 16203*052506
 16204*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 16205*052506
 16206     END-IF
 16207
 16208     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 16209        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 16210
 16211     IF WS-BEN-CD = ZEROS
 16212         GO TO 7050-SHOW-CONTINUE.
 16213
 16214     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16215     MOVE WS-ACCESS              TO CNTL-ACCESS.
 16216     MOVE +0                     TO CNTL-SEQ-NO.
 16217     MOVE 'BENE'                 TO FILE-SWITCH.
 16218
 16219     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 16220
 16221     IF BENEFIT-FOUND
 16222         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
 16223         MOVE AL-SANON                    TO COVERA.
 16224
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 317
* EL156.cbl
 16226 7050-SHOW-CONTINUE.
 16227
 16228     IF PI-COMPANY-ID = 'DMD'
 16229         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 16230
 16231     MOVE -1                     TO PMTTYPEL.
 16232     GO TO 8100-SEND-INITIAL-MAP.
 16233
 16234 7100-SHOW-RECORD-NOT-FOUND.
 16235     IF FILE-SWITCH = 'MSTR'
 16236         MOVE ER-0204            TO EMI-ERROR.
 16237
 16238     IF FILE-SWITCH = 'CERT'
 16239         MOVE ER-0206            TO EMI-ERROR.
 16240
 16241     IF FILE-SWITCH = 'STAT'
 16242         MOVE ER-0149            TO EMI-ERROR.
 16243
 16244     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16245
 16246     MOVE -1                     TO PMTTYPEL.
 16247     GO TO 8100-SEND-INITIAL-MAP
 16248
 16249     .
 16250 7110-BUILD-PMT-TRLR.
 16251     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 16252     MOVE +51                    TO TRLR-SEQ-NO
 16253
 16254* EXEC CICS READ
 16255*        DATASET  ('ELTRLR')
 16256*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16257*        RIDFLD   (ELTRLR-KEY)
 16258*        RESP     (WS-RESPONSE)
 16259*    END-EXEC
 16260     MOVE 'ELTRLR' TO DFHEIV1
 16261*    MOVE '&"S        E          (  N#00015021' TO DFHEIV0
 16262     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16263     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16264     MOVE X'204E233030303135303231' TO DFHEIV0(25:11)
 16265     CALL 'kxdfhei1' USING DFHEIV0,
 16266           DFHEIV1,
 16267           DFHEIV20,
 16268           DFHEIV99,
 16269           ELTRLR-KEY,
 16270           DFHEIV99,
 16271           DFHEIV99,
 16272           DFHEIV99
 16273     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16274         DFHEIV20
 16275     MOVE EIBRESP  TO WS-RESPONSE
 16276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16277     IF WS-RESP-NORMAL
 16278        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 16279     END-IF
 16280     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 16281
 16282* EXEC CICS GETMAIN
 16283*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 318
* EL156.cbl
 16284*         LENGTH    (200)
 16285*         INITIMG   (GETMAIN-SPACE)
 16286*     END-EXEC
 16287     MOVE 200
 16288       TO DFHEIV11
 16289*    MOVE ',"IL                  $   #00015031' TO DFHEIV0
 16290     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16291     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16292     MOVE X'2020233030303135303331' TO DFHEIV0(25:11)
 16293     CALL 'kxdfhei1' USING DFHEIV0,
 16294           DFHEIV20,
 16295           DFHEIV11,
 16296           GETMAIN-SPACE
 16297     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16298         DFHEIV20
 16299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16300     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 16301                                    AT-PREV-PAID-THRU-DT
 16302     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 16303     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 16304     MOVE 'AT'                   TO AT-RECORD-ID
 16305     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 16306     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 16307     MOVE '2'                    TO AT-TRAILER-TYPE
 16308     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16309                                    AT-PAYMENT-LAST-MAINT-DT
 16310     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16311                                    AT-PAYMENT-LAST-UPDATED-BY
 16312     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 16313     MOVE 'I'                    TO AT-PAYMENT-TYPE
 16314     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 16315     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 16316     MOVE +0                     TO AT-EXPENSE-PER-PMT
 16317     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 16318     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 16319     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 16320     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 16321     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 16322     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 16323     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 16324     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 16325     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 16326     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 16327     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 16328                                    AT-TO-BE-WRITTEN-DT
 16329     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 16330                                    AT-CHECK-QUE-SEQUENCE
 16331                                    AT-ADDL-RESERVE
 16332     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 16333                                    AT-VOID-SELECT-DT
 16334                                    AT-VOID-ACCEPT-DT
 16335                                    AT-VOID-DT
 16336                                    AT-PMT-PROOF-DT
 16337                                    AT-INT-PMT-SELECT-DT
 16338     MOVE ZEROS                  TO AT-DAILY-RATE
 16339                                    AT-ELIMINATION-DAYS
 16340     MOVE SPACES                 TO AT-BENEFIT-TYPE
 16341*    EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 319
* EL156.cbl
 16342*        DUPREC    (7120-DUPREC)
 16343*    END-EXEC
 16344     .
 16345 7115-WRITE-INT-TRLR.
 16346
 16347* EXEC CICS WRITE
 16348*         DATASET       ('ELTRLR')
 16349*         FROM          (ACTIVITY-TRAILERS)
 16350*         RIDFLD        (AT-CONTROL-PRIMARY)
 16351*         RESP          (WS-RESPONSE)
 16352*     END-EXEC
 16353     MOVE LENGTH OF
 16354      ACTIVITY-TRAILERS
 16355       TO DFHEIV11
 16356     MOVE 'ELTRLR' TO DFHEIV1
 16357*    MOVE '&$ L                  ''  N#00015082' TO DFHEIV0
 16358     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16359     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16360     MOVE X'204E233030303135303832' TO DFHEIV0(25:11)
 16361     CALL 'kxdfhei1' USING DFHEIV0,
 16362           DFHEIV1,
 16363           ACTIVITY-TRAILERS,
 16364           DFHEIV11,
 16365           AT-CONTROL-PRIMARY,
 16366           DFHEIV99,
 16367           DFHEIV99
 16368     MOVE EIBRESP  TO WS-RESPONSE
 16369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16370      IF WS-RESP-DUPREC
 16371         GO TO 7120-DUPREC
 16372      END-IF
 16373     GO TO 7130-EXIT
 16374     .
 16375 7120-DUPREC.
 16376     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16377     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 16378     GO TO 7115-WRITE-INT-TRLR
 16379     .
 16380 7130-EXIT.
 16381      EXIT.
 16382 7140-BUILD-NOTE-TRLR.
 16383
 16384
 16385* EXEC CICS GETMAIN
 16386*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16387*         LENGTH    (200)
 16388*         INITIMG   (GETMAIN-SPACE)
 16389*     END-EXEC
 16390     MOVE 200
 16391       TO DFHEIV11
 16392*    MOVE ',"IL                  $   #00015102' TO DFHEIV0
 16393     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16394     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16395     MOVE X'2020233030303135313032' TO DFHEIV0(25:11)
 16396     CALL 'kxdfhei1' USING DFHEIV0,
 16397           DFHEIV20,
 16398           DFHEIV11,
 16399           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 320
* EL156.cbl
 16400     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16401         DFHEIV20
 16402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16403     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16404     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 16405     MOVE 'AT'                   TO AT-RECORD-ID
 16406     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 16407     MOVE '6'                    TO AT-TRAILER-TYPE
 16408     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16409                                    AT-GEN-INFO-LAST-MAINT-DT
 16410     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16411                                    AT-GEN-INFO-LAST-UPDATED-BY
 16412     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 16413     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 16414     .
 16415 7150-WRITE.
 16416
 16417* EXEC CICS HANDLE CONDITION
 16418*        DUPREC    (7160-DUPREC)
 16419*    END-EXEC
 16420*    MOVE '"$%                   ! 9 #00015120' TO DFHEIV0
 16421     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16422     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16423     MOVE X'3920233030303135313230' TO DFHEIV0(25:11)
 16424     CALL 'kxdfhei1' USING DFHEIV0
 16425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16426
 16427* EXEC CICS WRITE
 16428*         DATASET     ('ELTRLR')
 16429*         FROM        (ACTIVITY-TRAILERS)
 16430*         RIDFLD      (AT-CONTROL-PRIMARY)
 16431*         RESP        (WS-RESPONSE)
 16432*     END-EXEC
 16433     MOVE LENGTH OF
 16434      ACTIVITY-TRAILERS
 16435       TO DFHEIV11
 16436     MOVE 'ELTRLR' TO DFHEIV1
 16437*    MOVE '&$ L                  ''  N#00015123' TO DFHEIV0
 16438     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16439     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16440     MOVE X'204E233030303135313233' TO DFHEIV0(25:11)
 16441     CALL 'kxdfhei1' USING DFHEIV0,
 16442           DFHEIV1,
 16443           ACTIVITY-TRAILERS,
 16444           DFHEIV11,
 16445           AT-CONTROL-PRIMARY,
 16446           DFHEIV99,
 16447           DFHEIV99
 16448     MOVE EIBRESP  TO WS-RESPONSE
 16449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16450      IF WS-RESP-DUPREC
 16451         GO TO 7160-DUPREC
 16452      END-IF
 16453     GO TO 7170-EXIT
 16454     .
 16455 7160-DUPREC.
 16456     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16457     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 321
* EL156.cbl
 16458     GO TO 7150-WRITE
 16459     .
 16460 7170-EXIT.
 16461      EXIT.
 16462
 16463 7180-ADD-CERT-NOTE.
 16464*ADD CERT NOTE FOR SC NP+6
 16465
 16466
 16467* EXEC CICS GETMAIN
 16468*         SET       (ADDRESS OF CERT-NOTE-FILE)
 16469*         LENGTH    (150)
 16470*         INITIMG   (GETMAIN-SPACE)
 16471*     END-EXEC.
 16472     MOVE 150
 16473       TO DFHEIV11
 16474*    MOVE ',"IL                  $   #00015145' TO DFHEIV0
 16475     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16476     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16477     MOVE X'2020233030303135313435' TO DFHEIV0(25:11)
 16478     CALL 'kxdfhei1' USING DFHEIV0,
 16479           DFHEIV20,
 16480           DFHEIV11,
 16481           GETMAIN-SPACE
 16482     SET ADDRESS OF CERT-NOTE-FILE TO
 16483         DFHEIV20
 16484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16485
 16486
 16487     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 16488     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 16489     MOVE +1                     TO WRK-NOTE-SEQ.
 16490     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 16491     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 16492     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 16493     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 16494     MOVE CL-CERT-STATE          TO CZ-STATE.
 16495     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 16496     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 16497     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 16498     MOVE '2'                    TO CZ-RECORD-TYPE.
 16499     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 16500     MOVE 'CZ'                   TO CZ-RECORD-ID.
 16501     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 16502     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 16503     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 16504     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 16505     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 16506     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 16507     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 16508
 16509 7181-WRITE.
 16510
 16511
 16512* EXEC CICS WRITE
 16513*         DATASET     ('ERCNOT')
 16514*         FROM        (CERT-NOTE-FILE)
 16515*         RIDFLD      (CZ-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 322
* EL156.cbl
 16516*         RESP        (WS-RESPONSE)
 16517*    END-EXEC.
 16518     MOVE LENGTH OF
 16519      CERT-NOTE-FILE
 16520       TO DFHEIV11
 16521     MOVE 'ERCNOT' TO DFHEIV1
 16522*    MOVE '&$ L                  ''  N#00015175' TO DFHEIV0
 16523     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16524     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16525     MOVE X'204E233030303135313735' TO DFHEIV0(25:11)
 16526     CALL 'kxdfhei1' USING DFHEIV0,
 16527           DFHEIV1,
 16528           CERT-NOTE-FILE,
 16529           DFHEIV11,
 16530           CZ-CONTROL-PRIMARY,
 16531           DFHEIV99,
 16532           DFHEIV99
 16533     MOVE EIBRESP  TO WS-RESPONSE
 16534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16535
 16536
 16537     IF WS-RESP-DUPREC
 16538         GO TO 7182-DUPREC
 16539     END-IF.
 16540
 16541     SET CERT-NOTE-ADDED TO TRUE.
 16542
 16543     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 16544         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 16545     END-IF.
 16546
 16547     GO TO 7189-EXIT.
 16548
 16549 7182-DUPREC.
 16550
 16551     ADD +1                      TO  WRK-NOTE-SEQ.
 16552     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 16553     GO TO 7181-WRITE.
 16554
 16555 7189-EXIT.
 16556      EXIT.
 16557
 16558 7190-ADD-ORIG-NOTE.
 16559
 16560
 16561* EXEC CICS GETMAIN
 16562*         SET       (ADDRESS OF CERT-NOTE-FILE)
 16563*         LENGTH    (150)
 16564*         INITIMG   (GETMAIN-SPACE)
 16565*     END-EXEC.
 16566     MOVE 150
 16567       TO DFHEIV11
 16568*    MOVE ',"IL                  $   #00015205' TO DFHEIV0
 16569     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16570     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16571     MOVE X'2020233030303135323035' TO DFHEIV0(25:11)
 16572     CALL 'kxdfhei1' USING DFHEIV0,
 16573           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 323
* EL156.cbl
 16574           DFHEIV11,
 16575           GETMAIN-SPACE
 16576     SET ADDRESS OF CERT-NOTE-FILE TO
 16577         DFHEIV20
 16578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16579
 16580
 16581     ADD +1                      TO WRK-NOTE-SEQ.
 16582     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 16583     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 16584     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 16585     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 16586     MOVE CL-CERT-STATE          TO CZ-STATE.
 16587     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 16588     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 16589     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 16590     MOVE '2'                    TO CZ-RECORD-TYPE.
 16591     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 16592     MOVE 'CZ'                   TO CZ-RECORD-ID.
 16593     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 16594     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 16595     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 16596     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 16597
 16598 7191-WRITE.
 16599
 16600
 16601* EXEC CICS WRITE
 16602*         DATASET     ('ERCNOT')
 16603*         FROM        (CERT-NOTE-FILE)
 16604*         RIDFLD      (CZ-CONTROL-PRIMARY)
 16605*         RESP        (WS-RESPONSE)
 16606*    END-EXEC.
 16607     MOVE LENGTH OF
 16608      CERT-NOTE-FILE
 16609       TO DFHEIV11
 16610     MOVE 'ERCNOT' TO DFHEIV1
 16611*    MOVE '&$ L                  ''  N#00015230' TO DFHEIV0
 16612     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16613     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16614     MOVE X'204E233030303135323330' TO DFHEIV0(25:11)
 16615     CALL 'kxdfhei1' USING DFHEIV0,
 16616           DFHEIV1,
 16617           CERT-NOTE-FILE,
 16618           DFHEIV11,
 16619           CZ-CONTROL-PRIMARY,
 16620           DFHEIV99,
 16621           DFHEIV99
 16622     MOVE EIBRESP  TO WS-RESPONSE
 16623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16624
 16625
 16626     IF WS-RESP-DUPREC
 16627         GO TO 7192-DUPREC
 16628     END-IF.
 16629
 16630     GO TO 7199-EXIT.
 16631
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 324
* EL156.cbl
 16632 7192-DUPREC.
 16633
 16634     ADD +1                      TO  WRK-NOTE-SEQ.
 16635     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 16636     GO TO 7191-WRITE.
 16637
 16638 7199-EXIT.
 16639      EXIT.
 16640 7200-FIND-BENEFIT.
 16641     MOVE 'N' TO WS-BEN-SEARCH-SW.
 16642
 16643
 16644* EXEC CICS HANDLE CONDITION
 16645*        ENDFILE(7200-EXIT)
 16646*        NOTFND(7200-EXIT)
 16647*    END-EXEC.
 16648*    MOVE '"$''I                  ! : #00015254' TO DFHEIV0
 16649     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16650     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16651     MOVE X'3A20233030303135323534' TO DFHEIV0(25:11)
 16652     CALL 'kxdfhei1' USING DFHEIV0
 16653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16654
 16655
 16656
 16657* EXEC CICS READ
 16658*        DATASET('ELCNTL')
 16659*        SET(ADDRESS OF CONTROL-FILE)
 16660*        RIDFLD(ELCNTL-KEY)
 16661*        GTEQ
 16662*    END-EXEC.
 16663     MOVE 'ELCNTL' TO DFHEIV1
 16664*    MOVE '&"S        G          (   #00015259' TO DFHEIV0
 16665     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16666     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16667     MOVE X'2020233030303135323539' TO DFHEIV0(25:11)
 16668     CALL 'kxdfhei1' USING DFHEIV0,
 16669           DFHEIV1,
 16670           DFHEIV20,
 16671           DFHEIV99,
 16672           ELCNTL-KEY,
 16673           DFHEIV99,
 16674           DFHEIV99,
 16675           DFHEIV99
 16676     SET ADDRESS OF CONTROL-FILE TO
 16677         DFHEIV20
 16678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16679
 16680
 16681     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 16682        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 16683           GO TO 7200-EXIT.
 16684
 16685     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 16686         VARYING SUB-1 FROM 1 BY 1 UNTIL
 16687            ((SUB-1 > 8) OR
 16688            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 16689
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 325
* EL156.cbl
 16690     IF SUB-1 NOT = 9
 16691         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 16692
 16693     GO TO 7200-EXIT.
 16694
 16695 7200-BENEFIT-DUMMY.
 16696
 16697 7200-DUMMY-EXIT.
 16698     EXIT.
 16699
 16700 7200-EXIT.
 16701     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 326
* EL156.cbl
 16703*052506
 16704*052506 7250-FIND-LETTER-TRLR.
 16705*052506     EXEC CICS HANDLE CONDITION
 16706*052506         ENDFILE  (7250-END)
 16707*052506         NOTFND   (7250-END)
 16708*052506     END-EXEC.
 16709*052506
 16710*052506     EXEC CICS STARTBR
 16711*052506         DATASET   ('ELTRLR')
 16712*052506         RIDFLD    (ELTRLR-KEY)
 16713*052506         GTEQ
 16714*052506     END-EXEC.
 16715*052506
 16716*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 16717*052506
 16718*052506 7250-FIND-LOOP.
 16719*052506     EXEC CICS READNEXT
 16720*052506         DATASET   ('ELTRLR')
 16721*052506         RIDFLD    (ELTRLR-KEY)
 16722*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16723*052506     END-EXEC.
 16724*052506
 16725*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 16726*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 16727*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 16728*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 16729*052506        GO TO 7250-END
 16730*052506     END-IF.
 16731*052506
 16732*052506     IF AT-TRAILER-TYPE NOT = '4'
 16733*052506         GO TO 7250-FIND-LOOP
 16734*052506     END-IF.
 16735*052506
 16736*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 16737*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 16738*052506     END-IF.
 16739*052506
 16740*052506     GO TO 7250-FIND-LOOP.
 16741*052506
 16742*052506 7250-END.
 16743*052506
 16744*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 16745*051506         MOVE SPACES             TO  DC-OPTION-CODE
 16746*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 16747*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16748*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 16749*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 16750*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 16751*052506     END-IF.
 16752*052506
 16753*052506     EXEC CICS ENDBR
 16754*052506          DATASET    ('ELTRLR')
 16755*052506     END-EXEC.
 16756*052506
 16757*052506 7250-EXIT.
 16758*052506     EXIT.
 16759*052506     EJECT
 16760*052506
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 327
* EL156.cbl
 16761 7300-CHECK-AUTO-ACTIVITY.
 16762
 16763     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 16764         NEXT SENTENCE
 16765     ELSE
 16766         GO TO 7399-EXIT.
 16767
 16768     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 16769
 16770     IF WS-ACT-REC-FOUND-SW = 'N'
 16771         GO TO 7399-EXIT.
 16772
 16773     IF PI-ACTIVITY-CODE = 09
 16774         GO TO 7300-CONT-AUTO-ACTIVITY.
 16775
 16776     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 16777        (PI-ACTIVITY-CODE = 11)
 16778         GO TO 7300-CONT-AUTO-ACTIVITY.
 16779
 16780     IF PI-PROVISIONAL-IND = 'P'
 16781         IF PI-PMTTYPE = '1'
 16782             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 16783                 MOVE 'N'    TO  PI-RESET-SW
 16784                 GO TO 7399-EXIT.
 16785
 16786     IF PI-PMTTYPE = '1'
 16787         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 16788             MOVE 'N'        TO  PI-RESET-SW
 16789             GO TO 7399-EXIT.
 16790
 16791     IF PI-PMTTYPE = '2' OR '3'
 16792         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 16793             MOVE 'N'        TO  PI-RESET-SW
 16794             GO TO 7399-EXIT.
 16795
 16796     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16797         IF PI-PROVISIONAL-IND = 'P'
 16798             NEXT SENTENCE
 16799         ELSE
 16800             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 16801
 16802 7300-CONT-AUTO-ACTIVITY.
 16803
 16804     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16805         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 16806         MOVE '4'            TO DC-OPTION-CODE
 16807         MOVE +0             TO DC-ELAPSED-DAYS
 16808                                DC-ELAPSED-MONTHS
 16809         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16810         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 16811         IF PI-USES-PAID-TO
 16812             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16813             IF NO-CONVERSION-ERROR
 16814                 MOVE +1     TO DC-ELAPSED-DAYS
 16815                 MOVE +0     TO DC-ELAPSED-MONTHS
 16816                 MOVE '6'    TO DC-OPTION-CODE
 16817                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16818                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 328
* EL156.cbl
 16819                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 16820
 16821     IF PI-PFKEY-USED = DFHPF5
 16822         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 16823         IF PI-USES-PAID-TO
 16824             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 16825             MOVE +1                  TO DC-ELAPSED-DAYS
 16826             MOVE +0                  TO DC-ELAPSED-MONTHS
 16827             MOVE '6'                 TO DC-OPTION-CODE
 16828             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16829             IF NO-CONVERSION-ERROR
 16830                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 16831
 16832     IF WS-CHK-THRU-DT < PI-EXP-DT
 16833         NEXT SENTENCE
 16834     ELSE
 16835         MOVE 03                     TO  WS-ACTIVITY-CODE
 16836         GO TO 7390-PROCESS-ACTIVITY.
 16837
 16838     IF PI-PROV-PMT
 16839         MOVE 09                     TO  WS-ACTIVITY-CODE
 16840     ELSE
 16841        IF PI-PMTTYPE = '1'
 16842            MOVE 02                  TO  WS-ACTIVITY-CODE
 16843        ELSE
 16844        IF PI-PMTTYPE = '2' OR '3'
 16845            MOVE 07                  TO  WS-ACTIVITY-CODE
 16846        ELSE
 16847        IF PI-PMTTYPE = '4'
 16848            MOVE 00                  TO  WS-ACTIVITY-CODE
 16849        ELSE
 16850            MOVE 'N'                 TO  PI-RESET-SW
 16851            GO TO 7399-EXIT.
 16852
 16853 7390-PROCESS-ACTIVITY.
 16854
 16855     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7499-EXIT.
 16856
 16857 7399-EXIT.
 16858     EXIT.
 16859
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 329
* EL156.cbl
 16861 7400-CHECK-AUTO-ACTIVITY.
 16862
 16863
 16864* EXEC CICS HANDLE CONDITION
 16865*        NOTFND   (7400-NOT-FOUND)
 16866*    END-EXEC.
 16867*    MOVE '"$I                   ! ; #00015448' TO DFHEIV0
 16868     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16869     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16870     MOVE X'3B20233030303135343438' TO DFHEIV0(25:11)
 16871     CALL 'kxdfhei1' USING DFHEIV0
 16872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16873
 16874
 16875     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 16876     MOVE 'T'                    TO  CNTL-REC-TYPE.
 16877     MOVE SPACES                 TO  CNTL-ACCESS.
 16878     MOVE +0                     TO  CNTL-SEQ-NO.
 16879
 16880
 16881* EXEC CICS READ
 16882*        DATASET   ('ELCNTL')
 16883*        RIDFLD    (ELCNTL-KEY)
 16884*        SET       (ADDRESS OF CONTROL-FILE)
 16885*    END-EXEC.
 16886     MOVE 'ELCNTL' TO DFHEIV1
 16887*    MOVE '&"S        E          (   #00015457' TO DFHEIV0
 16888     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16889     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16890     MOVE X'2020233030303135343537' TO DFHEIV0(25:11)
 16891     CALL 'kxdfhei1' USING DFHEIV0,
 16892           DFHEIV1,
 16893           DFHEIV20,
 16894           DFHEIV99,
 16895           ELCNTL-KEY,
 16896           DFHEIV99,
 16897           DFHEIV99,
 16898           DFHEIV99
 16899     SET ADDRESS OF CONTROL-FILE TO
 16900         DFHEIV20
 16901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16902
 16903
 16904     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 16905     GO TO 7400-EXIT.
 16906
 16907 7400-NOT-FOUND.
 16908     MOVE 'N'                        TO  PI-RESET-SW
 16909                                         WS-LETTER-SW
 16910                                         WS-ACT-REC-FOUND-SW.
 16911
 16912     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16913
 16914 7400-EXIT.
 16915     EXIT.
 16916
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 330
* EL156.cbl
 16918 7450-FORMAT-AUTO-LETTER.
 16919
 16920     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 16921         MOVE 'Y'                    TO PI-RESET-SW
 16922         GO TO 7450-CONTINUE-PROCESS.
 16923
 16924     MOVE PI-ACTIVITY-CODE           TO  SUB.
 16925
 16926     IF SUB > 9
 16927         SUBTRACT 9 FROM SUB
 16928         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 16929     ELSE
 16930         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 16931
 16932 7450-CONTINUE-PROCESS.
 16933
 16934     IF WS-ACTIVITY-CODE = ZEROS
 16935         MOVE 'N'                    TO  WS-LETTER-SW
 16936         GO TO 7499-EXIT.
 16937
 16938     MOVE WS-ACTIVITY-CODE           TO  SUB.
 16939
 16940     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 16941         MOVE 'N'                    TO  PI-RESET-SW
 16942                                         WS-LETTER-SW
 16943         GO TO 7499-EXIT.
 16944
 16945     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 16946         MOVE 'N'                    TO  WS-LETTER-SW
 16947         GO TO 7499-EXIT.
 16948
 16949     MOVE 'Y'                        TO  WS-LETTER-SW.
 16950     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 16951     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 16952
 16953     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 16954
 16955     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 16956         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 16957         MOVE '6'                    TO  DC-OPTION-CODE
 16958         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 16959         MOVE +0                     TO  DC-ELAPSED-MONTHS
 16960         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16961         IF NO-CONVERSION-ERROR
 16962             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 16963         ELSE
 16964              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 16965
 16966     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 16967         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 16968         MOVE '6'                    TO  DC-OPTION-CODE
 16969         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 16970         MOVE +0                     TO  DC-ELAPSED-MONTHS
 16971         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16972         IF NO-CONVERSION-ERROR
 16973             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 16974         ELSE
 16975             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 331
* EL156.cbl
 16976
 16977 7499-EXIT.
 16978     EXIT.
 16979
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 332
* EL156.cbl
 16981 7500-RESET-AUTO-ACTIVITY.
 16982
 16983     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 16984     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 16985     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 16986     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 16987     MOVE +100                   TO  TRLR-SEQ-NO.
 16988
 16989 7500-STARTBR-TRLR.
 16990
 16991
 16992* EXEC CICS HANDLE CONDITION
 16993*        ENDFILE  (7590-END)
 16994*        NOTFND   (7590-END)
 16995*    END-EXEC.
 16996*    MOVE '"$''I                  ! < #00015550' TO DFHEIV0
 16997     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16998     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16999     MOVE X'3C20233030303135353530' TO DFHEIV0(25:11)
 17000     CALL 'kxdfhei1' USING DFHEIV0
 17001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17002
 17003
 17004
 17005* EXEC CICS STARTBR
 17006*        DATASET   ('ELTRLR')
 17007*        RIDFLD    (ELTRLR-KEY)
 17008*        GTEQ
 17009*    END-EXEC.
 17010     MOVE 'ELTRLR' TO DFHEIV1
 17011     MOVE 0
 17012       TO DFHEIV11
 17013*    MOVE '&,         G          &   #00015555' TO DFHEIV0
 17014     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17015     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17016     MOVE X'2020233030303135353535' TO DFHEIV0(25:11)
 17017     CALL 'kxdfhei1' USING DFHEIV0,
 17018           DFHEIV1,
 17019           ELTRLR-KEY,
 17020           DFHEIV99,
 17021           DFHEIV11,
 17022           DFHEIV99
 17023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17024
 17025
 17026     MOVE 'Y'                        TO  WS-BROWSE-SW.
 17027
 17028 7500-READ-NEXT.
 17029
 17030
 17031* EXEC CICS READNEXT
 17032*        DATASET   ('ELTRLR')
 17033*        RIDFLD    (ELTRLR-KEY)
 17034*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17035*    END-EXEC.
 17036     MOVE 'ELTRLR' TO DFHEIV1
 17037     MOVE 0
 17038       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 333
* EL156.cbl
 17039*    MOVE '&.S                   )   #00015565' TO DFHEIV0
 17040     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17041     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17042     MOVE X'2020233030303135353635' TO DFHEIV0(25:11)
 17043     CALL 'kxdfhei1' USING DFHEIV0,
 17044           DFHEIV1,
 17045           DFHEIV20,
 17046           DFHEIV99,
 17047           ELTRLR-KEY,
 17048           DFHEIV99,
 17049           DFHEIV11,
 17050           DFHEIV99,
 17051           DFHEIV99
 17052     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17053         DFHEIV20
 17054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17055
 17056
 17057     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 17058        PI-CARRIER    NOT = TRLR-CARRIER  OR
 17059        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 17060        PI-CERT-NO    NOT = TRLR-CERT-NO
 17061         GO TO 7590-END.
 17062
 17063     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 17064         GO TO 7500-READ-NEXT.
 17065
 17066     IF AT-TRAILER-TYPE NOT = '4'
 17067         GO TO 7500-READ-NEXT.
 17068
 17069     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 17070         GO TO 7500-READ-NEXT.
 17071
 17072     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 17073        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 17074         GO TO 7500-READ-NEXT.
 17075
 17076     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 17077        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 17078        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 17079         GO TO 7500-READ-NEXT.
 17080
 17081     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 17082                         AND
 17083        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 17084                         AND
 17085        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 17086            GO TO 7500-READ-NEXT.
 17087
 17088     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 17089
 17090
 17091* EXEC CICS ENDBR
 17092*        DATASET   ('ELTRLR')
 17093*    END-EXEC.
 17094     MOVE 'ELTRLR' TO DFHEIV1
 17095     MOVE 0
 17096       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 334
* EL156.cbl
 17097*    MOVE '&2                    $   #00015604' TO DFHEIV0
 17098     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17099     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17100     MOVE X'2020233030303135363034' TO DFHEIV0(25:11)
 17101     CALL 'kxdfhei1' USING DFHEIV0,
 17102           DFHEIV1,
 17103           DFHEIV11,
 17104           DFHEIV99
 17105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17106
 17107
 17108     MOVE 'N'                        TO  WS-BROWSE-SW.
 17109
 17110
 17111* EXEC CICS READ
 17112*        DATASET   ('ELTRLR')
 17113*        RIDFLD    (ELTRLR-KEY)
 17114*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17115*        UPDATE
 17116*    END-EXEC.
 17117     MOVE 'ELTRLR' TO DFHEIV1
 17118*    MOVE '&"S        EU         (   #00015610' TO DFHEIV0
 17119     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17120     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17121     MOVE X'2020233030303135363130' TO DFHEIV0(25:11)
 17122     CALL 'kxdfhei1' USING DFHEIV0,
 17123           DFHEIV1,
 17124           DFHEIV20,
 17125           DFHEIV99,
 17126           ELTRLR-KEY,
 17127           DFHEIV99,
 17128           DFHEIV99,
 17129           DFHEIV99
 17130     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17131         DFHEIV20
 17132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17133
 17134
 17135     MOVE 'Y'                        TO  WS-UPDATE-SW.
 17136
 17137     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 17138         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 17139     ELSE
 17140         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 17141             NEXT SENTENCE
 17142         ELSE
 17143             GO TO 7500-REWRITE-TRLR.
 17144
 17145     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 17146
 17147     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 17148     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 17149     MOVE '1'                        TO  ARCH-REC-TYPE.
 17150     MOVE +0                         TO  ARCH-SEQ.
 17151
 17152     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 17153
 17154 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 335
* EL156.cbl
 17155
 17156
 17157* EXEC CICS REWRITE
 17158*        DATASET   ('ELTRLR')
 17159*        FROM      (ACTIVITY-TRAILERS)
 17160*    END-EXEC.
 17161     MOVE LENGTH OF
 17162      ACTIVITY-TRAILERS
 17163       TO DFHEIV11
 17164     MOVE 'ELTRLR' TO DFHEIV1
 17165*    MOVE '&& L                  %   #00015638' TO DFHEIV0
 17166     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17167     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17168     MOVE X'2020233030303135363338' TO DFHEIV0(25:11)
 17169     CALL 'kxdfhei1' USING DFHEIV0,
 17170           DFHEIV1,
 17171           ACTIVITY-TRAILERS,
 17172           DFHEIV11,
 17173           DFHEIV99
 17174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17175
 17176
 17177     GO TO 7500-STARTBR-TRLR.
 17178
 17179 7590-END.
 17180
 17181     IF WS-BROWSE-SW = 'Y'
 17182         MOVE 'N'                    TO  WS-BROWSE-SW
 17183
 17184* EXEC CICS ENDBR
 17185*            DATASET   ('ELTRLR')
 17186*        END-EXEC.
 17187     MOVE 'ELTRLR' TO DFHEIV1
 17188     MOVE 0
 17189       TO DFHEIV11
 17190*    MOVE '&2                    $   #00015649' TO DFHEIV0
 17191     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17192     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17193     MOVE X'2020233030303135363439' TO DFHEIV0(25:11)
 17194     CALL 'kxdfhei1' USING DFHEIV0,
 17195           DFHEIV1,
 17196           DFHEIV11,
 17197           DFHEIV99
 17198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17199
 17200
 17201 7599-EXIT.
 17202     EXIT.
 17203
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 336
* EL156.cbl
 17205 7600-READ-ARCH-UPDATE.
 17206
 17207
 17208* EXEC CICS HANDLE CONDITION
 17209*        NOTFND   (7699-EXIT)
 17210*    END-EXEC.
 17211*    MOVE '"$I                   ! = #00015659' TO DFHEIV0
 17212     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17213     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17214     MOVE X'3D20233030303135363539' TO DFHEIV0(25:11)
 17215     CALL 'kxdfhei1' USING DFHEIV0
 17216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17217
 17218
 17219
 17220* EXEC CICS READ
 17221*        DATASET   ('ELARCH')
 17222*        RIDFLD    (ELARCH-KEY)
 17223*        SET       (ADDRESS OF LETTER-ARCHIVE)
 17224*        UPDATE
 17225*    END-EXEC.
 17226     MOVE 'ELARCH' TO DFHEIV1
 17227*    MOVE '&"S        EU         (   #00015663' TO DFHEIV0
 17228     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17229     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17230     MOVE X'2020233030303135363633' TO DFHEIV0(25:11)
 17231     CALL 'kxdfhei1' USING DFHEIV0,
 17232           DFHEIV1,
 17233           DFHEIV20,
 17234           DFHEIV99,
 17235           ELARCH-KEY,
 17236           DFHEIV99,
 17237           DFHEIV99,
 17238           DFHEIV99
 17239     SET ADDRESS OF LETTER-ARCHIVE TO
 17240         DFHEIV20
 17241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17242
 17243
 17244     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 17245
 17246
 17247* EXEC CICS REWRITE
 17248*        DATASET   ('ELARCH')
 17249*        FROM      (LETTER-ARCHIVE)
 17250*    END-EXEC.
 17251     MOVE LENGTH OF
 17252      LETTER-ARCHIVE
 17253       TO DFHEIV11
 17254     MOVE 'ELARCH' TO DFHEIV1
 17255*    MOVE '&& L                  %   #00015672' TO DFHEIV0
 17256     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17257     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17258     MOVE X'2020233030303135363732' TO DFHEIV0(25:11)
 17259     CALL 'kxdfhei1' USING DFHEIV0,
 17260           DFHEIV1,
 17261           LETTER-ARCHIVE,
 17262           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 337
* EL156.cbl
 17263           DFHEIV99
 17264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17265
 17266
 17267 7699-EXIT.
 17268     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 338
* EL156.cbl
 17270 7700-GET-DCT.
 17271
 17272     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 17273     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 17274     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 17275     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 17276                                    PI-MAX-BENEFIT-AMT
 17277                                    PI-MAX-BENEFIT-PYMT
 17278                                    PI-MIN-PAYMENT-AMT
 17279                                    PI-TIME-OF-LOSS-BAL.
 17280
 17281
 17282* EXEC CICS HANDLE CONDITION
 17283*         NOTFND (5300-NOTE-NOT-FOUND)
 17284*     END-EXEC.
 17285*    MOVE '"$I                   ! > #00015691' TO DFHEIV0
 17286     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17288     MOVE X'3E20233030303135363931' TO DFHEIV0(25:11)
 17289     CALL 'kxdfhei1' USING DFHEIV0
 17290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17291
 17292
 17293
 17294* EXEC CICS READ
 17295*         DATASET('ERNOTE')
 17296*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 17297*         RIDFLD (W-NOTE-KEY)
 17298*     END-EXEC.
 17299     MOVE 'ERNOTE' TO DFHEIV1
 17300*    MOVE '&"S        E          (   #00015695' TO DFHEIV0
 17301     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17302     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17303     MOVE X'2020233030303135363935' TO DFHEIV0(25:11)
 17304     CALL 'kxdfhei1' USING DFHEIV0,
 17305           DFHEIV1,
 17306           DFHEIV20,
 17307           DFHEIV99,
 17308           W-NOTE-KEY,
 17309           DFHEIV99,
 17310           DFHEIV99,
 17311           DFHEIV99
 17312     SET ADDRESS OF CERTIFICATE-NOTE TO
 17313         DFHEIV20
 17314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17315
 17316
 17317     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 17318     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 17319     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 17320     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 17321     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 17322
 17323     IF PI-PAYEE-TYPE NOT = 'B'
 17324         GO TO 7700-EXIT.
 17325
 17326     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 17327     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 339
* EL156.cbl
 17328     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 17329
 17330     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 17331         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 17332     ELSE
 17333         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 17334
 17335     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 17336     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 17337     MOVE 'DLO006'               TO PGM-NAME.
 17338
 17339
 17340* EXEC CICS LINK
 17341*        PROGRAM    (PGM-NAME)
 17342*        COMMAREA   (DCT-COMMUNICATION-AREA)
 17343*        LENGTH     (DCT-RCRD-LENGTH)
 17344*    END-EXEC.
 17345*    MOVE '."C                   ''   #00015723' TO DFHEIV0
 17346     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17347     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17348     MOVE X'2020233030303135373233' TO DFHEIV0(25:11)
 17349     CALL 'kxdfhei1' USING DFHEIV0,
 17350           PGM-NAME,
 17351           DCT-COMMUNICATION-AREA,
 17352           DCT-RCRD-LENGTH,
 17353           DFHEIV99,
 17354           DFHEIV99,
 17355           DFHEIV99
 17356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17357
 17358
 17359     IF DCT-RETURN-CODE = 'OK'
 17360         GO TO 7700-CONT.
 17361
 17362     IF DCT-RETURN-CODE = '01' OR '02'
 17363         GO TO 7700-SET-TO-YES.
 17364
 17365     IF DCT-RETURN-CODE = '03'
 17366
 17367* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17368*    MOVE '6"R                   !   #00015736' TO DFHEIV0
 17369     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17370     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17371     MOVE X'2020233030303135373336' TO DFHEIV0(25:11)
 17372     CALL 'kxdfhei1' USING DFHEIV0
 17373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17374         MOVE ER-0951            TO EMI-ERROR
 17375         MOVE -1                 TO PMTTYPEL
 17376         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17377         GO TO 8200-SEND-DATAONLY.
 17378
 17379     IF DCT-RETURN-CODE = '04'
 17380
 17381* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17382*    MOVE '6"R                   !   #00015743' TO DFHEIV0
 17383     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17384     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17385     MOVE X'2020233030303135373433' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 340
* EL156.cbl
 17386     CALL 'kxdfhei1' USING DFHEIV0
 17387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17388         MOVE ER-0946            TO EMI-ERROR
 17389         MOVE -1                 TO PMTTYPEL
 17390         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17391         GO TO 8200-SEND-DATAONLY.
 17392
 17393     IF DCT-RETURN-CODE = '05'
 17394
 17395* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17396*    MOVE '6"R                   !   #00015750' TO DFHEIV0
 17397     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17398     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17399     MOVE X'2020233030303135373530' TO DFHEIV0(25:11)
 17400     CALL 'kxdfhei1' USING DFHEIV0
 17401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17402         MOVE ER-0947            TO EMI-ERROR
 17403         MOVE -1                 TO PMTTYPEL
 17404         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17405         GO TO 8200-SEND-DATAONLY.
 17406
 17407     IF DCT-RETURN-CODE = '06'
 17408
 17409* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17410*    MOVE '6"R                   !   #00015757' TO DFHEIV0
 17411     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17412     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17413     MOVE X'2020233030303135373537' TO DFHEIV0(25:11)
 17414     CALL 'kxdfhei1' USING DFHEIV0
 17415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17416         MOVE ER-0921            TO EMI-ERROR
 17417         MOVE -1                 TO PMTTYPEL
 17418         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17419         GO TO 8200-SEND-DATAONLY.
 17420
 17421     IF DCT-RETURN-CODE = '07'
 17422
 17423* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17424*    MOVE '6"R                   !   #00015764' TO DFHEIV0
 17425     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17426     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17427     MOVE X'2020233030303135373634' TO DFHEIV0(25:11)
 17428     CALL 'kxdfhei1' USING DFHEIV0
 17429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17430         MOVE ER-0919            TO EMI-ERROR
 17431         MOVE -1                 TO PMTTYPEL
 17432         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17433         GO TO 8200-SEND-DATAONLY.
 17434
 17435     IF DCT-RETURN-CODE = '08'
 17436
 17437* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17438*    MOVE '6"R                   !   #00015771' TO DFHEIV0
 17439     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17440     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17441     MOVE X'2020233030303135373731' TO DFHEIV0(25:11)
 17442     CALL 'kxdfhei1' USING DFHEIV0
 17443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 341
* EL156.cbl
 17444         MOVE ER-0948            TO EMI-ERROR
 17445         MOVE -1                 TO PMTTYPEL
 17446         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17447         GO TO 8200-SEND-DATAONLY.
 17448
 17449     IF DCT-RETURN-CODE = 'N1'
 17450
 17451* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17452*    MOVE '6"R                   !   #00015778' TO DFHEIV0
 17453     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17454     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17455     MOVE X'2020233030303135373738' TO DFHEIV0(25:11)
 17456     CALL 'kxdfhei1' USING DFHEIV0
 17457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17458         MOVE ER-0950            TO EMI-ERROR
 17459         MOVE -1                 TO PMTTYPEL
 17460         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17461         GO TO 8200-SEND-DATAONLY.
 17462
 17463     IF DCT-RETURN-CODE = 'E1'
 17464
 17465* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17466*    MOVE '6"R                   !   #00015785' TO DFHEIV0
 17467     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17468     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17469     MOVE X'2020233030303135373835' TO DFHEIV0(25:11)
 17470     CALL 'kxdfhei1' USING DFHEIV0
 17471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17472         MOVE ER-0974            TO EMI-ERROR
 17473         MOVE -1                 TO PMTTYPEL
 17474         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17475         GO TO 8200-SEND-DATAONLY.
 17476
 17477     IF DCT-RETURN-CODE = 'E2'
 17478
 17479* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17480*    MOVE '6"R                   !   #00015792' TO DFHEIV0
 17481     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17482     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17483     MOVE X'2020233030303135373932' TO DFHEIV0(25:11)
 17484     CALL 'kxdfhei1' USING DFHEIV0
 17485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17486         MOVE ER-0975            TO EMI-ERROR
 17487         MOVE -1                 TO PMTTYPEL
 17488         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17489         GO TO 8200-SEND-DATAONLY.
 17490
 17491     IF DCT-RETURN-CODE NOT = 'OK'
 17492
 17493* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17494*    MOVE '6"R                   !   #00015799' TO DFHEIV0
 17495     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17496     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17497     MOVE X'2020233030303135373939' TO DFHEIV0(25:11)
 17498     CALL 'kxdfhei1' USING DFHEIV0
 17499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17500         MOVE ER-0949            TO EMI-ERROR
 17501         MOVE -1                 TO PMTTYPEL
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 342
* EL156.cbl
 17502         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17503         GO TO 8200-SEND-DATAONLY.
 17504
 17505 7700-CONT.
 17506
 17507     MOVE 'N'                    TO CASHO.
 17508     MOVE +1                     TO CASHL.
 17509     MOVE AL-UANON               TO CASHA.
 17510
 17511     IF PI-OFFLINE = 'Y'
 17512         GO TO 7700-EXIT.
 17513
 17514     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 17515     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 17516     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 17517     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 17518     MOVE +7                     TO CHECKNOL.
 17519     MOVE AL-UANON               TO CHECKNOA.
 17520     GO TO 7700-EXIT.
 17521
 17522 7700-SET-TO-YES.
 17523
 17524     MOVE 'Y'                    TO CASHO.
 17525     MOVE +1                     TO CASHL.
 17526     MOVE AL-UANON               TO CASHA.
 17527
 17528 7700-EXIT.
 17529     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 343
* EL156.cbl
 17531 7800-READ-COMP-MSTR.
 17532
 17533
 17534* EXEC CICS HANDLE CONDITION
 17535*        NOTFND   (7800-COMP-NOTFND)
 17536*    END-EXEC.
 17537*    MOVE '"$I                   ! ? #00015833' TO DFHEIV0
 17538     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17539     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17540     MOVE X'3F20233030303135383333' TO DFHEIV0(25:11)
 17541     CALL 'kxdfhei1' USING DFHEIV0
 17542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17543
 17544
 17545
 17546* EXEC CICS READ
 17547*        DATASET   ('ERCOMP')
 17548*        RIDFLD    (ERCOMP-KEY)
 17549*        SET       (ADDRESS OF COMPENSATION-MASTER)
 17550*    END-EXEC.
 17551     MOVE 'ERCOMP' TO DFHEIV1
 17552*    MOVE '&"S        E          (   #00015837' TO DFHEIV0
 17553     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17555     MOVE X'2020233030303135383337' TO DFHEIV0(25:11)
 17556     CALL 'kxdfhei1' USING DFHEIV0,
 17557           DFHEIV1,
 17558           DFHEIV20,
 17559           DFHEIV99,
 17560           ERCOMP-KEY,
 17561           DFHEIV99,
 17562           DFHEIV99,
 17563           DFHEIV99
 17564     SET ADDRESS OF COMPENSATION-MASTER TO
 17565         DFHEIV20
 17566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17567
 17568
 17569     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 17570     GO TO 7800-COMP-EXIT.
 17571
 17572 7800-COMP-NOTFND.
 17573     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 17574
 17575 7800-COMP-EXIT.
 17576     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 344
* EL156.cbl
 17578 7900-READ-CLAIM.
 17579
 17580* EXEC CICS READ
 17581*        DATASET  ('ELMSTR')
 17582*        SET      (ADDRESS OF CLAIM-MASTER)
 17583*        RIDFLD   (ELMSTR-KEY)
 17584*    END-EXEC.
 17585     MOVE 'ELMSTR' TO DFHEIV1
 17586*    MOVE '&"S        E          (   #00015853' TO DFHEIV0
 17587     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17588     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17589     MOVE X'2020233030303135383533' TO DFHEIV0(25:11)
 17590     CALL 'kxdfhei1' USING DFHEIV0,
 17591           DFHEIV1,
 17592           DFHEIV20,
 17593           DFHEIV99,
 17594           ELMSTR-KEY,
 17595           DFHEIV99,
 17596           DFHEIV99,
 17597           DFHEIV99
 17598     SET ADDRESS OF CLAIM-MASTER TO
 17599         DFHEIV20
 17600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17601
 17602
 17603 7900-EXIT.
 17604      EXIT.
 17605
 17606 7910-READ-CLAIM-UPDATE.
 17607
 17608* EXEC CICS READ
 17609*        DATASET  ('ELMSTR')
 17610*        SET      (ADDRESS OF CLAIM-MASTER)
 17611*        RIDFLD   (ELMSTR-KEY)
 17612*        UPDATE
 17613*    END-EXEC.
 17614     MOVE 'ELMSTR' TO DFHEIV1
 17615*    MOVE '&"S        EU         (   #00015863' TO DFHEIV0
 17616     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17617     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17618     MOVE X'2020233030303135383633' TO DFHEIV0(25:11)
 17619     CALL 'kxdfhei1' USING DFHEIV0,
 17620           DFHEIV1,
 17621           DFHEIV20,
 17622           DFHEIV99,
 17623           ELMSTR-KEY,
 17624           DFHEIV99,
 17625           DFHEIV99,
 17626           DFHEIV99
 17627     SET ADDRESS OF CLAIM-MASTER TO
 17628         DFHEIV20
 17629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17630
 17631
 17632 7910-EXIT.
 17633      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 345
* EL156.cbl
 17635 7920-READ-BENE.
 17636     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 17637     MOVE 'B'                TO BENE-RECORD-TYPE.
 17638     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 17639
 17640     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17641        IF PI-PAYEE-TYPE    = 'B' AND
 17642           PI-PAYEE-SEQ-NUM = 9
 17643             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 17644             MOVE WS-A-BENE           TO BENE-NUMBER.
 17645
 17646
 17647* EXEC CICS HANDLE CONDITION
 17648*        NOTFND   (7920-NOT-FOUND)
 17649*    END-EXEC.
 17650*    MOVE '"$I                   ! @ #00015884' TO DFHEIV0
 17651     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17652     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17653     MOVE X'4020233030303135383834' TO DFHEIV0(25:11)
 17654     CALL 'kxdfhei1' USING DFHEIV0
 17655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17656
 17657
 17658
 17659* EXEC CICS READ
 17660*        DATASET  ('ELBENE')
 17661*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 17662*        RIDFLD   (ELBENE-KEY)
 17663*    END-EXEC.
 17664     MOVE 'ELBENE' TO DFHEIV1
 17665*    MOVE '&"S        E          (   #00015888' TO DFHEIV0
 17666     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17667     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17668     MOVE X'2020233030303135383838' TO DFHEIV0(25:11)
 17669     CALL 'kxdfhei1' USING DFHEIV0,
 17670           DFHEIV1,
 17671           DFHEIV20,
 17672           DFHEIV99,
 17673           ELBENE-KEY,
 17674           DFHEIV99,
 17675           DFHEIV99,
 17676           DFHEIV99
 17677     SET ADDRESS OF BENEFICIARY-MASTER TO
 17678         DFHEIV20
 17679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17680
 17681
 17682     MOVE 'Y' TO BENE-FOUND-SW.
 17683     GO TO 7920-EXIT.
 17684
 17685 7920-NOT-FOUND.
 17686     MOVE 'N'                    TO BENE-FOUND-SW.
 17687
 17688 7920-EXIT.
 17689      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 346
* EL156.cbl
 17691 7930-READ-CONTROL.
 17692
 17693* EXEC CICS READ
 17694*        DATASET  ('ELCNTL')
 17695*        SET      (ADDRESS OF CONTROL-FILE)
 17696*        RIDFLD   (ELCNTL-KEY)
 17697*    END-EXEC.
 17698     MOVE 'ELCNTL' TO DFHEIV1
 17699*    MOVE '&"S        E          (   #00015904' TO DFHEIV0
 17700     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17701     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17702     MOVE X'2020233030303135393034' TO DFHEIV0(25:11)
 17703     CALL 'kxdfhei1' USING DFHEIV0,
 17704           DFHEIV1,
 17705           DFHEIV20,
 17706           DFHEIV99,
 17707           ELCNTL-KEY,
 17708           DFHEIV99,
 17709           DFHEIV99,
 17710           DFHEIV99
 17711     SET ADDRESS OF CONTROL-FILE TO
 17712         DFHEIV20
 17713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17714
 17715
 17716 7930-EXIT.
 17717      EXIT.
 17718
 17719 7940-READ-CONTROL-UPDATE.
 17720
 17721* EXEC CICS READ
 17722*        DATASET  ('ELCNTL')
 17723*        SET      (ADDRESS OF CONTROL-FILE)
 17724*        RIDFLD   (ELCNTL-KEY)
 17725*        UPDATE
 17726*    END-EXEC.
 17727     MOVE 'ELCNTL' TO DFHEIV1
 17728*    MOVE '&"S        EU         (   #00015914' TO DFHEIV0
 17729     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17730     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17731     MOVE X'2020233030303135393134' TO DFHEIV0(25:11)
 17732     CALL 'kxdfhei1' USING DFHEIV0,
 17733           DFHEIV1,
 17734           DFHEIV20,
 17735           DFHEIV99,
 17736           ELCNTL-KEY,
 17737           DFHEIV99,
 17738           DFHEIV99,
 17739           DFHEIV99
 17740     SET ADDRESS OF CONTROL-FILE TO
 17741         DFHEIV20
 17742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17743
 17744
 17745 7940-EXIT.
 17746      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 347
* EL156.cbl
 17748 7950-READ-TRAILER.
 17749
 17750* EXEC CICS READ
 17751*        DATASET  ('ELTRLR')
 17752*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17753*        RIDFLD   (ELTRLR-KEY)
 17754*    END-EXEC.
 17755     MOVE 'ELTRLR' TO DFHEIV1
 17756*    MOVE '&"S        E          (   #00015925' TO DFHEIV0
 17757     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17758     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17759     MOVE X'2020233030303135393235' TO DFHEIV0(25:11)
 17760     CALL 'kxdfhei1' USING DFHEIV0,
 17761           DFHEIV1,
 17762           DFHEIV20,
 17763           DFHEIV99,
 17764           ELTRLR-KEY,
 17765           DFHEIV99,
 17766           DFHEIV99,
 17767           DFHEIV99
 17768     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17769         DFHEIV20
 17770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17771
 17772
 17773 7950-EXIT.
 17774      EXIT.
 17775
 17776 7960-READ-TRAILER-UPDATE.
 17777
 17778* EXEC CICS READ
 17779*        DATASET  ('ELTRLR')
 17780*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17781*        RIDFLD   (ELTRLR-KEY)
 17782*        UPDATE
 17783*    END-EXEC.
 17784     MOVE 'ELTRLR' TO DFHEIV1
 17785*    MOVE '&"S        EU         (   #00015935' TO DFHEIV0
 17786     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17787     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17788     MOVE X'2020233030303135393335' TO DFHEIV0(25:11)
 17789     CALL 'kxdfhei1' USING DFHEIV0,
 17790           DFHEIV1,
 17791           DFHEIV20,
 17792           DFHEIV99,
 17793           ELTRLR-KEY,
 17794           DFHEIV99,
 17795           DFHEIV99,
 17796           DFHEIV99
 17797     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17798         DFHEIV20
 17799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17800
 17801
 17802 7960-EXIT.
 17803      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 348
* EL156.cbl
 17805 7970-READ-CERT.
 17806
 17807* EXEC CICS READ
 17808*        DATASET  ('ELCERT')
 17809*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 17810*        RIDFLD   (ELCERT-KEY)
 17811*    END-EXEC.
 17812     MOVE 'ELCERT' TO DFHEIV1
 17813*    MOVE '&"S        E          (   #00015946' TO DFHEIV0
 17814     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17815     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17816     MOVE X'2020233030303135393436' TO DFHEIV0(25:11)
 17817     CALL 'kxdfhei1' USING DFHEIV0,
 17818           DFHEIV1,
 17819           DFHEIV20,
 17820           DFHEIV99,
 17821           ELCERT-KEY,
 17822           DFHEIV99,
 17823           DFHEIV99,
 17824           DFHEIV99
 17825     SET ADDRESS OF CERTIFICATE-MASTER TO
 17826         DFHEIV20
 17827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17828
 17829
 17830 7970-EXIT.
 17831      EXIT.
 17832
 17833 7980-READ-CERT-UPDATE.
 17834
 17835* EXEC CICS READ
 17836*        DATASET  ('ELCERT')
 17837*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 17838*        RIDFLD   (ELCERT-KEY)
 17839*        UPDATE
 17840*    END-EXEC.
 17841     MOVE 'ELCERT' TO DFHEIV1
 17842*    MOVE '&"S        EU         (   #00015956' TO DFHEIV0
 17843     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17844     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17845     MOVE X'2020233030303135393536' TO DFHEIV0(25:11)
 17846     CALL 'kxdfhei1' USING DFHEIV0,
 17847           DFHEIV1,
 17848           DFHEIV20,
 17849           DFHEIV99,
 17850           ELCERT-KEY,
 17851           DFHEIV99,
 17852           DFHEIV99,
 17853           DFHEIV99
 17854     SET ADDRESS OF CERTIFICATE-MASTER TO
 17855         DFHEIV20
 17856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17857
 17858
 17859 7980-EXIT.
 17860      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 349
* EL156.cbl
 17862 8000-LOAD-ERROR-MESSAGES.
 17863     IF PI-PASS-SW = 'C'
 17864        MOVE EMI-LINE1           TO ERMSG1BO
 17865     ELSE
 17866        MOVE EMI-LINE1           TO ERRMSG1O
 17867        MOVE EMI-LINE2           TO ERRMSG2O.
 17868
 17869 8000-EXIT.
 17870     EXIT.
 17871
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 350
* EL156.cbl
 17873
 17874 8010-DMD-ERROR-CHECKS.
 17875     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 17876
 17877     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 17878         GO TO 8051-ISSUE-ERROR.
 17879
 17880     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 17881     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 17882     MOVE '3'                    TO DC-OPTION-CODE.
 17883     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17884     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 17885         GO TO 8051-ISSUE-ERROR.
 17886
 17887     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 17888       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 17889                           OR
 17890          (CL-SSN-STATE   = CL-CERT-STATE  AND
 17891           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 17892             MOVE ER-0851         TO EMI-ERROR
 17893             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17894       END-IF
 17895       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 17896             MOVE ER-8147         TO EMI-ERROR
 17897             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17898
 17899     GO TO 8090-EXIT.
 17900
 17901 8051-ISSUE-ERROR.
 17902     MOVE ER-8146            TO EMI-ERROR.
 17903     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17904     GO TO 8090-EXIT.
 17905
 17906 8090-EXIT.
 17907      EXIT.
 17908
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 351
* EL156.cbl
 17910 8100-SEND-INITIAL-MAP.
 17911
 17912     MOVE SAVE-DATE              TO RUNDTEAO.
 17913     MOVE EIBTIME                TO TIME-IN.
 17914     MOVE TIME-OUT               TO RUNTIMAO.
 17915     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 17916
 17917     IF MAP-NAME = 'EL156A'
 17918        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17919           MOVE 'PF6=EOB CODES'  TO PF6TITO
 17920        END-IF
 17921     END-IF
 17922     IF MAP-NAME = 'EL156A'
 17923        IF PI-COMPANY-ID = 'CRI'
 17924           NEXT SENTENCE
 17925        ELSE
 17926           MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 17927
 17928     IF MAP-NAME = 'EL156A'
 17929        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 17930           NEXT SENTENCE
 17931        ELSE
 17932           MOVE AL-SADOF TO  PINTA    PINTHA.
 17933
 17934     IF MAP-NAME = 'EL156A'
 17935        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17936            NEXT SENTENCE
 17937        ELSE
 17938           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 17939
 17940     IF MAP-NAME = 'EL156A'
 17941        IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 17942           NEXT SENTENCE
 17943        ELSE
 17944           MOVE AL-SADOF TO CASHHA CASHA.
 17945
 17946     IF MAP-NAME = 'EL156A'
 17947        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 17948           NEXT SENTENCE
 17949        ELSE
 17950           MOVE AL-SADOF        TO  LOANHA
 17951                                    LOANNOA.
 17952
 17953     IF MAP-NAME = 'EL156A'
 17954        MOVE -1                 TO  ENTERPFL
 17955        IF PI-USES-PAID-TO
 17956           MOVE 'PAID TO DATE :' TO PTHRHDGO
 17957           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 17958           MOVE PMT-HEAD-A      TO  PMTHDGAO
 17959        ELSE
 17960           NEXT SENTENCE
 17961     ELSE
 17962        IF MAP-NAME = 'EL156B'
 17963           IF PI-USES-PAID-TO
 17964              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 17965              MOVE PMT-HEAD-B     TO PMTHDGBO.
 17966
 17967
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 352
* EL156.cbl
 17968* EXEC CICS SEND
 17969*        MAP   (MAP-NAME)
 17970*        MAPSET(MAPSET-NAME)
 17971*        FROM  (EL156AI)
 17972*        ERASE
 17973*        CURSOR
 17974*    END-EXEC.
 17975     MOVE LENGTH OF
 17976      EL156AI
 17977       TO DFHEIV12
 17978     MOVE -1
 17979       TO DFHEIV11
 17980*    MOVE '8$     CT  E    H L F ,   #00016071' TO DFHEIV0
 17981     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 17982     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17983     MOVE X'2020233030303136303731' TO DFHEIV0(25:11)
 17984     CALL 'kxdfhei1' USING DFHEIV0,
 17985           MAP-NAME,
 17986           EL156AI,
 17987           DFHEIV12,
 17988           MAPSET-NAME,
 17989           DFHEIV99,
 17990           DFHEIV99,
 17991           DFHEIV99,
 17992           DFHEIV11,
 17993           DFHEIV99,
 17994           DFHEIV99,
 17995           DFHEIV99
 17996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17997
 17998
 17999     GO TO 9100-RETURN-TRAN.
 18000
 18001 8200-SEND-DATAONLY.
 18002
 18003     IF FIRST-ENTRY = 'Y'
 18004         GO TO 8100-SEND-INITIAL-MAP.
 18005
 18006     IF RETURNED-FROM-B = 'Y'
 18007         GO TO 8100-SEND-INITIAL-MAP.
 18008
 18009     MOVE SAVE-DATE              TO RUNDTEAO.
 18010     MOVE EIBTIME                TO TIME-IN.
 18011     MOVE TIME-OUT               TO RUNTIMAO.
 18012
 18013     IF EIBAID = DFHPF11
 18014        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 18015        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18016        MOVE 'EL001   '          TO RETURNED-FROM
 18017        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 18018        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 18019        GO TO 8100-SEND-INITIAL-MAP.
 18020
 18021     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 18022
 18023     IF MAP-NAME =  'EL156A'
 18024        MOVE -1                 TO  ENTERPFL
 18025        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 353
* EL156.cbl
 18026           MOVE 'PAID TO DATE :' TO PTHRHDGO
 18027           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 18028           MOVE PMT-HEAD-A      TO  PMTHDGAO
 18029        ELSE
 18030           NEXT SENTENCE
 18031     ELSE
 18032        IF MAP-NAME = 'EL156B'
 18033           IF PI-USES-PAID-TO
 18034              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 18035              MOVE PMT-HEAD-B     TO PMTHDGBO.
 18036
 18037     IF MAP-NAME =  'EL156A'
 18038        IF PI-COMPANY-ID = 'BOA'
 18039            IF PI-INT-RATE NUMERIC
 18040                MOVE PI-INT-RATE TO PINTO.
 18041     IF MAP-NAME = 'EL156A'
 18042        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 18043           MOVE 'PF6=EOB CODES'  TO PF6TITO
 18044*          MOVE 'Y'              TO EOBYNO
 18045        END-IF
 18046     END-IF
 18047
 18048
 18049* EXEC CICS SEND
 18050*        MAP   (MAP-NAME)
 18051*        MAPSET(MAPSET-NAME)
 18052*        FROM  (EL156AI)
 18053*        DATAONLY
 18054*        CURSOR
 18055*    END-EXEC.
 18056     MOVE LENGTH OF
 18057      EL156AI
 18058       TO DFHEIV12
 18059     MOVE -1
 18060       TO DFHEIV11
 18061*    MOVE '8$D    CT       H L F ,   #00016128' TO DFHEIV0
 18062     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 18063     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 18064     MOVE X'2020233030303136313238' TO DFHEIV0(25:11)
 18065     CALL 'kxdfhei1' USING DFHEIV0,
 18066           MAP-NAME,
 18067           EL156AI,
 18068           DFHEIV12,
 18069           MAPSET-NAME,
 18070           DFHEIV99,
 18071           DFHEIV99,
 18072           DFHEIV99,
 18073           DFHEIV11,
 18074           DFHEIV99,
 18075           DFHEIV99,
 18076           DFHEIV99
 18077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18078
 18079
 18080     GO TO 9100-RETURN-TRAN.
 18081
 18082 8300-SEND-TEXT.
 18083
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 354
* EL156.cbl
 18084* EXEC CICS SEND TEXT
 18085*        FROM(LOGOFF-TEXT)
 18086*        LENGTH(LOGOFF-LENGTH)
 18087*        ERASE
 18088*        FREEKB
 18089*    END-EXEC.
 18090*    MOVE '8&      T  E F  H   F -   #00016139' TO DFHEIV0
 18091     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 18092     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 18093     MOVE X'2020233030303136313339' TO DFHEIV0(25:11)
 18094     CALL 'kxdfhei1' USING DFHEIV0,
 18095           LOGOFF-TEXT,
 18096           LOGOFF-LENGTH,
 18097           DFHEIV99,
 18098           DFHEIV99,
 18099           DFHEIV99,
 18100           DFHEIV99,
 18101           DFHEIV99,
 18102           DFHEIV99,
 18103           DFHEIV99,
 18104           DFHEIV99,
 18105           DFHEIV99,
 18106           DFHEIV99
 18107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18108
 18109
 18110
 18111* EXEC CICS RETURN
 18112*    END-EXEC.
 18113*    MOVE '.(                    &   #00016146' TO DFHEIV0
 18114     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 18115     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18116     MOVE X'2020233030303136313436' TO DFHEIV0(25:11)
 18117     CALL 'kxdfhei1' USING DFHEIV0,
 18118           DFHEIV99,
 18119           DFHEIV99,
 18120           DFHEIV99,
 18121           DFHEIV99,
 18122           DFHEIV99
 18123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18124
 18125
 18126 8500-FILE-NOTOPEN.
 18127     IF FILE-SWITCH = 'MSTR'
 18128         MOVE ER-0154            TO EMI-ERROR.
 18129     IF FILE-SWITCH = 'TRLR'
 18130         MOVE ER-0172            TO EMI-ERROR.
 18131     IF FILE-SWITCH = 'CERT'
 18132         MOVE ER-0169            TO EMI-ERROR.
 18133     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 18134                      'PROC' OR 'STAT'
 18135         MOVE ER-0042            TO EMI-ERROR.
 18136     IF FILE-SWITCH = 'ACTQ'
 18137         MOVE ER-0338            TO EMI-ERROR.
 18138     IF FILE-SWITCH = 'ACCT'
 18139         MOVE ER-0168            TO EMI-ERROR.
 18140
 18141     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 355
* EL156.cbl
 18142     MOVE -1                     TO PMTTYPEL.
 18143
 18144     IF FIRST-ENTRY = 'Y'
 18145         GO TO 8100-SEND-INITIAL-MAP.
 18146
 18147     GO TO 8200-SEND-DATAONLY.
 18148
 18149 8600-PGRM-NOT-FOUND.
 18150
 18151     MOVE ER-0923                TO EMI-ERROR.
 18152     MOVE -1                     TO ENTPFBL.
 18153     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18154
 18155     IF FIRST-ENTRY = 'Y'
 18156         GO TO 8100-SEND-INITIAL-MAP
 18157     ELSE
 18158         GO TO 8200-SEND-DATAONLY.
 18159
 18160 8800-UNAUTHORIZED-ACCESS.
 18161     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 18162     GO TO 8300-SEND-TEXT.
 18163
 18164 8810-PF23.
 18165     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 18166     MOVE XCTL-005               TO PGM-NAME.
 18167     GO TO 9300-XCTL.
 18168
 18169 8820-PF7-8.
 18170     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 18171     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 18172                                    PI-SAVED-PROGRAM-2
 18173                                    PI-SAVED-PROGRAM-3
 18174                                    PI-SAVED-PROGRAM-4
 18175                                    PI-SAVED-PROGRAM-5
 18176                                    PI-SAVED-PROGRAM-6
 18177                                    PI-RETURN-TO-PROGRAM.
 18178     IF EIBAID = DFHPF8
 18179        MOVE XCTL-132            TO PGM-NAME
 18180     ELSE
 18181        MOVE XCTL-130            TO PGM-NAME.
 18182
 18183     GO TO 9300-XCTL.
 18184
 18185 9100-RETURN-TRAN.
 18186     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 18187     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 18188
 18189
 18190* EXEC CICS RETURN
 18191*        TRANSID(TRANS-ID)
 18192*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 18193*        LENGTH(PI-COMM-LENGTH)
 18194*    END-EXEC.
 18195*    MOVE '.(CT                  &   #00016212' TO DFHEIV0
 18196     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 18197     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18198     MOVE X'2020233030303136323132' TO DFHEIV0(25:11)
 18199     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 356
* EL156.cbl
 18200           TRANS-ID,
 18201           PROGRAM-INTERFACE-BLOCK,
 18202           PI-COMM-LENGTH,
 18203           DFHEIV99,
 18204           DFHEIV99
 18205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18206
 18207
 18208 9200-RETURN-MAIN-MENU.
 18209     MOVE XCTL-126               TO PGM-NAME.
 18210     GO TO 9300-XCTL.
 18211
 18212 9300-XCTL.
 18213
 18214* EXEC CICS XCTL
 18215*        PROGRAM(PGM-NAME)
 18216*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 18217*        LENGTH(PI-COMM-LENGTH)
 18218*    END-EXEC.
 18219*    MOVE '.$C                   $   #00016223' TO DFHEIV0
 18220     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 18221     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18222     MOVE X'2020233030303136323233' TO DFHEIV0(25:11)
 18223     CALL 'kxdfhei1' USING DFHEIV0,
 18224           PGM-NAME,
 18225           PROGRAM-INTERFACE-BLOCK,
 18226           PI-COMM-LENGTH
 18227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18228
 18229
 18230 9400-CLEAR.
 18231     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 18232     GO TO 9300-XCTL.
 18233
 18234 9500-PF12.
 18235     MOVE XCTL-010               TO PGM-NAME.
 18236     GO TO 9300-XCTL.
 18237
 18238 9700-LINK-DATE-CONVERT.
 18239     MOVE LINK-ELDATCV           TO PGM-NAME.
 18240
 18241* EXEC CICS LINK
 18242*        PROGRAM   (PGM-NAME)
 18243*        COMMAREA  (DATE-CONVERSION-DATA)
 18244*        LENGTH    (DC-COMM-LENGTH)
 18245*    END-EXEC.
 18246*    MOVE '."C                   ''   #00016239' TO DFHEIV0
 18247     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18248     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18249     MOVE X'2020233030303136323339' TO DFHEIV0(25:11)
 18250     CALL 'kxdfhei1' USING DFHEIV0,
 18251           PGM-NAME,
 18252           DATE-CONVERSION-DATA,
 18253           DC-COMM-LENGTH,
 18254           DFHEIV99,
 18255           DFHEIV99,
 18256           DFHEIV99
 18257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 357
* EL156.cbl
 18258
 18259
 18260 9700-EXIT.
 18261     EXIT.
 18262
 18263 9800-LINK-REM-TERM.
 18264     MOVE LINK-REMTERM TO PGM-NAME.
 18265
 18266
 18267* EXEC CICS LINK
 18268*        PROGRAM   (PGM-NAME)
 18269*        COMMAREA  (CALCULATION-PASS-AREA)
 18270*        LENGTH    (CP-COMM-LENGTH)
 18271*    END-EXEC.
 18272*    MOVE '."C                   ''   #00016251' TO DFHEIV0
 18273     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18274     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18275     MOVE X'2020233030303136323531' TO DFHEIV0(25:11)
 18276     CALL 'kxdfhei1' USING DFHEIV0,
 18277           PGM-NAME,
 18278           CALCULATION-PASS-AREA,
 18279           CP-COMM-LENGTH,
 18280           DFHEIV99,
 18281           DFHEIV99,
 18282           DFHEIV99
 18283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18284
 18285
 18286 9800-EXIT.
 18287     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 358
* EL156.cbl
 18289 9830-DMD-REMAINING-TERM.
 18290
 18291     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 18292         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 18293
 18294     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 18295                              CM-PMT-EXTENSION-DAYS.
 18296
 18297     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 18298                                  CL-NO-OF-DAYS-PAID.
 18299
 18300     DIVIDE W-REM-TERM-IN-DAYS BY +30
 18301         GIVING W-REM REMAINDER W-REM-DAYS.
 18302
 18303     MOVE W-REM                  TO WST-REM.
 18304
 18305     IF W-REM-DAYS > ZEROS
 18306         MOVE '/'                TO WST-SLASH
 18307         MOVE W-REM-DAYS         TO WST-REM-DAYS
 18308     ELSE
 18309         MOVE SPACES             TO WST-REM-DAYS-GRP.
 18310
 18311 9830-EXIT.
 18312     EXIT.
 18313
 18314 9870-OUTPUT-ACTIVITY-RECORD.
 18315
 18316
 18317* EXEC CICS GETMAIN
 18318*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 18319*         LENGTH(25)
 18320*         INITIMG(WS-BLANK)
 18321*    END-EXEC.
 18322     MOVE 25
 18323       TO DFHEIV11
 18324*    MOVE ',"IL                  $   #00016287' TO DFHEIV0
 18325     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18326     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18327     MOVE X'2020233030303136323837' TO DFHEIV0(25:11)
 18328     CALL 'kxdfhei1' USING DFHEIV0,
 18329           DFHEIV20,
 18330           DFHEIV11,
 18331           WS-BLANK
 18332     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 18333         DFHEIV20
 18334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18335
 18336
 18337     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 18338     MOVE ELMSTR-KEY             TO DA-KEY.
 18339     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 18340
 18341     IF PI-PMTTYPE EQUAL '7'
 18342         MOVE 'V'                TO DA-RECORD-TYPE
 18343     ELSE
 18344         MOVE 'P'                TO DA-RECORD-TYPE.
 18345
 18346
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 359
* EL156.cbl
 18347* EXEC CICS HANDLE CONDITION
 18348*         NOTOPEN(9870-NOTOPEN)
 18349*         DUPREC(9870-EXIT)
 18350*    END-EXEC.
 18351*    MOVE '"$J%                  ! A #00016302' TO DFHEIV0
 18352     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 18353     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18354     MOVE X'4120233030303136333032' TO DFHEIV0(25:11)
 18355     CALL 'kxdfhei1' USING DFHEIV0
 18356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18357
 18358
 18359
 18360* EXEC CICS WRITE
 18361*         DATASET('DLYACTV')
 18362*         RIDFLD(DA-KEY)
 18363*         FROM(DAILY-ACTIVITY-RECORD)
 18364*         LENGTH(25)
 18365*    END-EXEC.
 18366     MOVE 'DLYACTV' TO DFHEIV1
 18367     MOVE 25
 18368       TO DFHEIV11
 18369*    MOVE '&$ L                  ''   #00016307' TO DFHEIV0
 18370     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18371     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18372     MOVE X'2020233030303136333037' TO DFHEIV0(25:11)
 18373     CALL 'kxdfhei1' USING DFHEIV0,
 18374           DFHEIV1,
 18375           DAILY-ACTIVITY-RECORD,
 18376           DFHEIV11,
 18377           DA-KEY,
 18378           DFHEIV99,
 18379           DFHEIV99
 18380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18381
 18382     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 18383     GO TO 9870-EXIT.
 18384
 18385 9870-NOTOPEN.
 18386
 18387     MOVE '2955'                 TO EMI-ERROR.
 18388     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 18389
 18390 9870-EXIT.
 18391     EXIT.
 18392
 18393 9900-ERROR-FORMAT.
 18394
 18395     IF EMI-ERROR = ER-0923
 18396         MOVE PGM-NAME           TO W-CALLED-NAME.
 18397
 18398     MOVE LINK-001      TO PGM-NAME.
 18399     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 18400
 18401
 18402* EXEC CICS LINK
 18403*        PROGRAM (PGM-NAME)
 18404*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 360
* EL156.cbl
 18405*        LENGTH  (EMI-COMM-LENGTH)
 18406*    END-EXEC.
 18407*    MOVE '."C                   ''   #00016332' TO DFHEIV0
 18408     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18409     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18410     MOVE X'2020233030303136333332' TO DFHEIV0(25:11)
 18411     CALL 'kxdfhei1' USING DFHEIV0,
 18412           PGM-NAME,
 18413           ERROR-MESSAGE-INTERFACE-BLOCK,
 18414           EMI-COMM-LENGTH,
 18415           DFHEIV99,
 18416           DFHEIV99,
 18417           DFHEIV99
 18418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18419
 18420
 18421     IF EMI-ERROR = ER-0923
 18422         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 18423
 18424 9900-EXIT.
 18425     EXIT.
 18426
 18427 9990-ABEND.
 18428     MOVE LINK-004               TO PGM-NAME.
 18429     MOVE DFHEIBLK               TO EMI-LINE1.
 18430
 18431* EXEC CICS LINK
 18432*        PROGRAM   (PGM-NAME)
 18433*        COMMAREA  (EMI-LINE1)
 18434*        LENGTH    (64)
 18435*    END-EXEC.
 18436     MOVE 64
 18437       TO DFHEIV11
 18438*    MOVE '."C                   ''   #00016347' TO DFHEIV0
 18439     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18440     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18441     MOVE X'2020233030303136333437' TO DFHEIV0(25:11)
 18442     CALL 'kxdfhei1' USING DFHEIV0,
 18443           PGM-NAME,
 18444           EMI-LINE1,
 18445           DFHEIV11,
 18446           DFHEIV99,
 18447           DFHEIV99,
 18448           DFHEIV99
 18449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18450
 18451
 18452     MOVE 'EL156A'               TO  MAP-NAME.
 18453     MOVE LOW-VALUES             TO  EL156AO.
 18454     GO TO 8100-SEND-INITIAL-MAP.
 18455
 18456 9995-SECURITY-VIOLATION.
 18457*    COPY ELCSCTP.
 18458******************************************************************
 18459*                                                                *
 18460*                            ELCSCTP                             *
 18461*                            VMOD=2.001                          *
 18462*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 361
* EL156.cbl
 18463*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 18464******************************************************************
 18465
 18466
 18467     MOVE EIBDATE          TO SM-JUL-DATE.
 18468     MOVE EIBTRMID         TO SM-TERMID.
 18469     MOVE THIS-PGM         TO SM-PGM.
 18470     MOVE EIBTIME          TO TIME-IN.
 18471     MOVE TIME-OUT         TO SM-TIME.
 18472     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 18473
 18474
 18475* EXEC CICS LINK
 18476*         PROGRAM  ('EL003')
 18477*         COMMAREA (SECURITY-MESSAGE)
 18478*         LENGTH   (80)
 18479*    END-EXEC.
 18480     MOVE 'EL003' TO DFHEIV1
 18481     MOVE 80
 18482       TO DFHEIV11
 18483*    MOVE '."C                   ''   #00016375' TO DFHEIV0
 18484     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18485     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18486     MOVE X'2020233030303136333735' TO DFHEIV0(25:11)
 18487     CALL 'kxdfhei1' USING DFHEIV0,
 18488           DFHEIV1,
 18489           SECURITY-MESSAGE,
 18490           DFHEIV11,
 18491           DFHEIV99,
 18492           DFHEIV99,
 18493           DFHEIV99
 18494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18495
 18496
 18497******************************************************************
 18498
 18499
 18500
 18501 9999-DFHBACK SECTION.
 18502     MOVE '9%                    "   ' TO DFHEIV0
 18503     MOVE 'EL156' TO DFHEIV1
 18504     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18505     GOBACK.
 18506 9999-DFHEXIT.
 18507     IF DFHEIGDJ EQUAL 0001
 18508         NEXT SENTENCE
 18509     ELSE IF DFHEIGDJ EQUAL 2
 18510         GO TO 9990-ABEND,
 18511               8600-PGRM-NOT-FOUND,
 18512               0400-FIRST-TIME,
 18513               6180-DUPREC,
 18514               9990-ABEND
 18515         DEPENDING ON DFHEIGDI
 18516     ELSE IF DFHEIGDJ EQUAL 3
 18517         GO TO 0380-CLAIM-END-FILE,
 18518               0380-CLAIM-END-FILE
 18519         DEPENDING ON DFHEIGDI
 18520     ELSE IF DFHEIGDJ EQUAL 4
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 362
* EL156.cbl
 18521         GO TO 0380-CLAIM-END-FILE,
 18522               0380-CLAIM-END-FILE
 18523         DEPENDING ON DFHEIGDI
 18524     ELSE IF DFHEIGDJ EQUAL 5
 18525         GO TO 0800-EXIT
 18526         DEPENDING ON DFHEIGDI
 18527     ELSE IF DFHEIGDJ EQUAL 6
 18528         GO TO 1950-NOT-FOUND,
 18529               1950-NOT-FOUND
 18530         DEPENDING ON DFHEIGDI
 18531     ELSE IF DFHEIGDJ EQUAL 7
 18532         GO TO 1950-NOT-FOUND
 18533         DEPENDING ON DFHEIGDI
 18534     ELSE IF DFHEIGDJ EQUAL 8
 18535         GO TO 1950-NOT-FOUND,
 18536               1950-NOT-FOUND
 18537         DEPENDING ON DFHEIGDI
 18538     ELSE IF DFHEIGDJ EQUAL 9
 18539         GO TO 1166-END-CHECK,
 18540               1166-END-CHECK
 18541         DEPENDING ON DFHEIGDI
 18542     ELSE IF DFHEIGDJ EQUAL 10
 18543         GO TO 1950-NOT-FOUND,
 18544               1950-NOT-FOUND
 18545         DEPENDING ON DFHEIGDI
 18546     ELSE IF DFHEIGDJ EQUAL 11
 18547         GO TO 1950-NOT-FOUND,
 18548               1950-NOT-FOUND
 18549         DEPENDING ON DFHEIGDI
 18550     ELSE IF DFHEIGDJ EQUAL 12
 18551         GO TO 1950-NOT-FOUND
 18552         DEPENDING ON DFHEIGDI
 18553     ELSE IF DFHEIGDJ EQUAL 13
 18554         GO TO 3600-CONTINUE
 18555         DEPENDING ON DFHEIGDI
 18556     ELSE IF DFHEIGDJ EQUAL 14
 18557         GO TO 5300-NOTE-NOT-FOUND
 18558         DEPENDING ON DFHEIGDI
 18559     ELSE IF DFHEIGDJ EQUAL 15
 18560         GO TO 6065-NOT-FOUND
 18561         DEPENDING ON DFHEIGDI
 18562     ELSE IF DFHEIGDJ EQUAL 16
 18563         GO TO 6068-ACCT-NOT-FND
 18564         DEPENDING ON DFHEIGDI
 18565     ELSE IF DFHEIGDJ EQUAL 17
 18566         GO TO 6074-GET-COMP-DATA
 18567         DEPENDING ON DFHEIGDI
 18568     ELSE IF DFHEIGDJ EQUAL 18
 18569         GO TO 6170-WRITE
 18570         DEPENDING ON DFHEIGDI
 18571     ELSE IF DFHEIGDJ EQUAL 19
 18572         GO TO 6180-DUPREC
 18573         DEPENDING ON DFHEIGDI
 18574     ELSE IF DFHEIGDJ EQUAL 20
 18575         GO TO 6190-DUPREC
 18576         DEPENDING ON DFHEIGDI
 18577     ELSE IF DFHEIGDJ EQUAL 21
 18578         GO TO 6185-DUPREC
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:16 Page 363
* EL156.cbl
 18579         DEPENDING ON DFHEIGDI
 18580     ELSE IF DFHEIGDJ EQUAL 22
 18581         GO TO 6720-BUILD-NEW-RECORD
 18582         DEPENDING ON DFHEIGDI
 18583     ELSE IF DFHEIGDJ EQUAL 23
 18584         GO TO 6900-BUILD-ARCHIVE-HEADER,
 18585               6900-BUILD-ARCHIVE-HEADER
 18586         DEPENDING ON DFHEIGDI
 18587     ELSE IF DFHEIGDJ EQUAL 24
 18588         GO TO 7100-SHOW-RECORD-NOT-FOUND
 18589         DEPENDING ON DFHEIGDI
 18590     ELSE IF DFHEIGDJ EQUAL 25
 18591         GO TO 7160-DUPREC
 18592         DEPENDING ON DFHEIGDI
 18593     ELSE IF DFHEIGDJ EQUAL 26
 18594         GO TO 7200-EXIT,
 18595               7200-EXIT
 18596         DEPENDING ON DFHEIGDI
 18597     ELSE IF DFHEIGDJ EQUAL 27
 18598         GO TO 7400-NOT-FOUND
 18599         DEPENDING ON DFHEIGDI
 18600     ELSE IF DFHEIGDJ EQUAL 28
 18601         GO TO 7590-END,
 18602               7590-END
 18603         DEPENDING ON DFHEIGDI
 18604     ELSE IF DFHEIGDJ EQUAL 29
 18605         GO TO 7699-EXIT
 18606         DEPENDING ON DFHEIGDI
 18607     ELSE IF DFHEIGDJ EQUAL 30
 18608         GO TO 5300-NOTE-NOT-FOUND
 18609         DEPENDING ON DFHEIGDI
 18610     ELSE IF DFHEIGDJ EQUAL 31
 18611         GO TO 7800-COMP-NOTFND
 18612         DEPENDING ON DFHEIGDI
 18613     ELSE IF DFHEIGDJ EQUAL 32
 18614         GO TO 7920-NOT-FOUND
 18615         DEPENDING ON DFHEIGDI
 18616     ELSE IF DFHEIGDJ EQUAL 33
 18617         GO TO 9870-NOTOPEN,
 18618               9870-EXIT
 18619         DEPENDING ON DFHEIGDI.
 18620     MOVE '9%                    "   ' TO DFHEIV0
 18621     MOVE 'EL156' TO DFHEIV1
 18622     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18623     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       11628     Code:       69176
