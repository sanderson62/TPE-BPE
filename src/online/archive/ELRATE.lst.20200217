* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page   1
* ELRATE.cbl
* Options: int("ELRATE.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRATE.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRATE.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRATE.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRATE.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:20:51.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.012
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page   2
* ELRATE.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25******************************************************************
    26*  REMARKS   *                                                   *
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    28*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    29*            *    AND RATES.                                     *
    30******************************************************************
    31
    32
    33******************************************************************
    34*                                                                *
    35*              INPUT FIELDS USED                                 *
    36*                                                                *
    37******************************************************************
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    39*  CLASS CODE       - CP-CLASS-CODE                              *
    40*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    41*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    42*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    43*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    44*  STATE CODE (NUM) - CP-STATE                                   *
    45*  STATE CODE       - CP-STATE-STD-ABBV                          *
    46*  COMPANY I.D.     - CP-COMPANY-ID                              *
    47*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    48*  INSURED AGE      - CP-ISSUE-AGE                               *
    49*  RATING METHOD    - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  A.P.R.           - CP-LOAN-APR                                *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page   3
* ELRATE.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRATE  WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '***********VMOD 2.012 **********'.
    65
    66***  Y2K PROJ 7744
    67 01  WS-HOLD-RATE-EXP.
    68     05  WS-HOLD-RATE-EXP-AL PIC X(11).
    69     05  WS-HOLD-RATE-EXP-DT REDEFINES
    70         WS-HOLD-RATE-EXP-AL PIC 9(11).
    71***  Y2K PROJ 7744
    72
    73*                            COPY ELCRATWS.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCRATWS.                           *
    78*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    79*                            VMOD=2.010                          *
    80*                                                                *
    81******************************************************************
    82
    83 01  STANDARD-AREAS.
    84     12  ER-STATUS               PIC XX.
    85     12  WS-BROWSE-SW            PIC X       VALUE SPACE.
    86         88 WS-BROWSE-STARTED                VALUE 'Y'.
    87     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.
    88     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.
    89     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.
    90     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.
    91     12  ERRATE-KEY.
    92         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.
    93         16  RATE-STATE-CODE.
    94             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.
    95             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.
    96             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.
    97         16  RATE-L-AH-CODE.
    98             20  RATE-L-AH       PIC  X       VALUE SPACE.
    99             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.
   100         16  RATE-LIMITS.
   101             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.
   102             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   103             20  RATE-FUTURE     PIC  XX      VALUE SPACES.
   104             20  RATE-SEX        PIC  X       VALUE '9'.
   105         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.
   106
   107     12  SAVE-ERRATE-KEY.
   108         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.
   109         16  SVRT-STATE-CODE.
   110             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.
   111             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.
   112             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.
   113         16  SVRT-L-AH-CODE.
   114             20  SVRT-L-AH       PIC  X       VALUE SPACE.
   115             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.
   116         16  SVRT-LIMITS.
   117             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page   4
* ELRATE.cbl
   118             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   119             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.
   120             20  SVRT-SEX        PIC  X       VALUE '9'.
   121         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.
   122
   123     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.
   124     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.
   125
   126 01  CSL-WORK-AREAS          COMP-3.
   127     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.
   128     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.
   129     12  WK-J                PIC S999           VALUE ZEROS.
   130     12  WK-K                PIC S999           VALUE ZEROS.
   131     12  WK-L                PIC S99V9(9)       VALUE ZEROS.
   132     12  WK-S                PIC S999V9(4)      VALUE ZEROS.
   133     12  WK-T                PIC S999           VALUE ZEROS.
   134     12  WK-T1               PIC S999           VALUE ZEROS.
   135     12  WK-U                PIC S99V9(9)       VALUE ZEROS.
   136     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.
   137     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.
   138     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.
   139     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.
   140     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.
   141     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.
   142     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.
   143     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.
   144     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.
   145     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.
   146     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.
   147     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.
   148
   149 01  TEXAS-REG-WORK-AREAS.
   150     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
   151     12  TEX-FACT-2          PIC S9(3)       COMP-3.
   152     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   153     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   154     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   155     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   156     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   157     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   158     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   159
   160 01  NET-PAY-INTERFACE.
   161     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   162     12  N-P-ORIG            PIC S9(3)       COMP-3.
   163     12  N-P-REM             PIC S9(3)       COMP-3.
   164     12  N-P-OPT             PIC X.
   165     12  N-P-LOAN            PIC S9(3)       COMP-3.
   166     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   167
   168
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page   5
* ELRATE.cbl
   170*                            COPY ERCNETWS.
   171*****************************************************************
   172*                                                               *
   173*                                                               *
   174*                            ERCNETWS                           *
   175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   176*                            VMOD=2.014                         *
   177*                                                               *
   178*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   179*                                                               *
   180*****************************************************************.
   181*                   C H A N G E   L O G
   182*
   183* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   184*-----------------------------------------------------------------
   185*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   186* EFFECTIVE    NUMBER
   187*-----------------------------------------------------------------
   188* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   189* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   190* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   191* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   192* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   193******************************************************************
   194
   195 01  NET-PAY-WORK-AREA.
   196     12  OPTION-SW               PIC X   VALUE 'X'.
   197        88  NPO-STD         VALUE SPACE.
   198        88  NPO-ALT         VALUE 'A'.
   199        88  NPO-SIMPLE      VALUE 'S'.
   200        88  NPO-2MO         VALUE 'I'.
   201        88  NPO-3MO         VALUE 'J'.
   202        88  NPO-4MO         VALUE 'K'.
   203        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   204        88  NPO-TRUNC-0     VALUE 'T'.
   205        88  NPO-TRUNC-1     VALUE 'U'.
   206        88  NPO-TRUNC-2     VALUE 'V'.
   207        88  NPO-TRUNC-3     VALUE 'W'.
   208        88  NPO-TRUNC-4     VALUE 'X'.
   209        88  NPO-REFUND      VALUE 'R'.
   210        88  NPO-PRUDENTIAL  VALUE 'P'.
   211
   212     12  TYPE-SW             PIC X   VALUE 'N'.
   213        88  NET-STD             VALUE 'N'.
   214        88  NET-SMP             VALUE 'S'.
   215
   216     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   217        88  NP-RATING           VALUE '1'.
   218        88  NP-REFUND           VALUE '2'.
   219        88  NP-REMAIN-AMT       VALUE '3'.
   220
   221     12  COMP-3-WORK-AREA         COMP-3.
   222         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   223         16  V               PIC SV9(13)       VALUE +.0.
   224         16  J               PIC SV9(9)        VALUE +0.
   225         16  K               PIC SV9(9)        VALUE +0.
   226         16  I               PIC SV9(10)       VALUE +.0.
   227         16  D               PIC S9(5)         VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page   6
* ELRATE.cbl
   228         16  APR100          PIC SV9(9)        VALUE +.0.
   229         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   230         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   231         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   232         16  pema            pic s9(2)v9(15)   value +0.
   233         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   234         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   235         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   236         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   237         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   238         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   239         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   240         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   241         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   242         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   243         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   244         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   245         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   246         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   247         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   248         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   249         16  ANGLEMY         PIC S9(5)V9(13)   VALUE +.0.
   250         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   251         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   252         16  ANGLENY         PIC S9(5)V9(13)   VALUE +.0.
   253         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   254         16  ANGLEN-MP1      PIC S9(5)V9(13)   VALUE +.0.
   255         16  ANGLEN-MP1Y     PIC S9(5)V9(13)   VALUE +.0.
   256         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   257         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   258         16  ANGLEM-1Y       PIC S9(7)V9(10)   VALUE +.0.
   259         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   260         16  PVBALLOON       PIC S9(7)V99      VALUE +.0.
   261         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   262         16  K1              PIC S999          VALUE +1.
   263         16  K12             PIC S999          VALUE +12.
   264         16  K100            PIC S999          VALUE +100.
   265         16  K1000           PIC S9(7)         VALUE +1000.
   266         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   267         16  Y REDEFINES NC-LR
   268                             PIC S99V9(5).
   269         16  TI              PIC S999V9(5)     VALUE +0.
   270         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   271         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   272         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   273         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   274         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   275         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   276         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   277         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   278
   279         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   280         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   281         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   282         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   283         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   284         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   285         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page   7
* ELRATE.cbl
   286         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   287         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   288         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   289         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   290         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   291         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   292
   293         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
   294
   295         16  ORIGINAL-TERM   PIC S999.
   296         16  M              REDEFINES ORIGINAL-TERM
   297                             PIC S999.
   298
   299         16  REMAINING-TERM  PIC S999.
   300         16  R              REDEFINES REMAINING-TERM
   301                             PIC S999.
   302
   303         16  LOAN-TERM       PIC S999.
   304         16  N              REDEFINES LOAN-TERM
   305                             PIC S999.
   306
   307         16  EXPIRED-TERM    PIC S999.
   308         16  E              REDEFINES EXPIRED-TERM
   309                             PIC S999.
   310
   311         16  PRUDENTIAL-WORK-AMT
   312                             PIC S9(7)V9(8).
   313         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   314                             PIC S9(7)V9(8).
   315
   316         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   317         16  VX              PIC S9V9(13)      VALUE +0.0.
   318         16  SV              PIC S9V9(13)      VALUE +0.0.
   319         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   320         16  SX              PIC S9V9(13)      VALUE +0.0.
   321         16  SE              PIC S9V9(10)      VALUE +0.0.
   322         16  N2              PIC S9(7)         VALUE +0.
   323         16  N3              PIC S9(7)         VALUE +0.
   324         16  K-I             PIC S9V9(8)       VALUE +0.0.
   325
   326     12  BINARY-WORK-AREA        COMP.
   327         16  X1              PIC S999        VALUE +0.
   328         16  X2              PIC S999        VALUE +0.
   329         16  MAX-X           PIC S9(5)       VALUE +0.
   330         16  B1              PIC S9(5)       VALUE +1.
   331         16  LINDX           PIC S999        VALUE ZEROS.
   332         16  AHNDX           PIC S999        VALUE ZEROS.
   333
   334     12  CSO-RATE-WORK-AREAS.
   335         16  C-PMTS-PER-YEAR     PIC S999V99 COMP-3 VALUE ZEROS.
   336         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   337         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   338     12  WS-WORK-MISC.
   339         16  ws-extra-pmts       pic s999         comp-3.
   340         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   341         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   342*        16  WS-AGE              PIC 99           VALUE ZEROS.
   343         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page   8
* ELRATE.cbl
   344         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   345         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   346         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   347         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   348         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   349         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   350         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   351         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   352         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
   353         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   354         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   355******************************************************************
   356
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page   9
* ELRATE.cbl
   358*                            COPY ELCDATE.
   359******************************************************************
   360*                                                                *
   361*                                                                *
   362*                            ELCDATE.                            *
   363*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   364*                            VMOD=2.003
   365*                                                                *
   366*                                                                *
   367*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   368*                 LENGTH = 200                                   *
   369******************************************************************
   370
   371 01  DATE-CONVERSION-DATA.
   372     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   373     12  DC-OPTION-CODE                PIC X.
   374         88  BIN-TO-GREG                VALUE ' '.
   375         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   376         88  EDIT-GREG-TO-BIN           VALUE '2'.
   377         88  YMD-GREG-TO-BIN            VALUE '3'.
   378         88  MDY-GREG-TO-BIN            VALUE '4'.
   379         88  JULIAN-TO-BIN              VALUE '5'.
   380         88  BIN-PLUS-ELAPSED           VALUE '6'.
   381         88  FIND-CENTURY               VALUE '7'.
   382         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   383         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   384         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   385         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   386         88  JULIAN-TO-BIN-3            VALUE 'C'.
   387         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   388         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   389         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   390         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   391         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   392         88  CHECK-LEAP-YEAR            VALUE 'H'.
   393         88  BIN-3-TO-GREG              VALUE 'I'.
   394         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   395         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   396         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   397         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   398         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   399         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   400         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   401         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   402         88  THREE-CHARACTER-BIN
   403                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   404         88  GREGORIAN-TO-BIN
   405                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   406         88  BIN-TO-GREGORIAN
   407                  VALUES ' ' '1' 'I' '8' 'G'.
   408         88  JULIAN-TO-BINARY
   409                  VALUES '5' 'C' 'E' 'F'.
   410     12  DC-ERROR-CODE                 PIC X.
   411         88  NO-CONVERSION-ERROR        VALUE ' '.
   412         88  DATE-CONVERSION-ERROR
   413                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   414         88  DATE-IS-ZERO               VALUE '1'.
   415         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  10
* ELRATE.cbl
   416         88  DATE-IS-INVALID            VALUE '3'.
   417         88  DATE1-GREATER-DATE2        VALUE '4'.
   418         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   419         88  DATE-INVALID-OPTION        VALUE '9'.
   420         88  INVALID-CENTURY            VALUE 'A'.
   421         88  ONLY-CENTURY               VALUE 'B'.
   422         88  ONLY-LEAP-YEAR             VALUE 'C'.
   423         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   424     12  DC-END-OF-MONTH               PIC X.
   425         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   426     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   427         88  USE-NORMAL-PROCESS         VALUE ' '.
   428         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   429         88  ADJUST-UP-100-YRS          VALUE '2'.
   430     12  FILLER                        PIC X.
   431     12  DC-CONVERSION-DATES.
   432         16  DC-BIN-DATE-1             PIC XX.
   433         16  DC-BIN-DATE-2             PIC XX.
   434         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   435         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   436                       DC-GREG-DATE-1-EDIT.
   437             20  DC-EDIT1-MONTH        PIC 99.
   438             20  SLASH1-1              PIC X.
   439             20  DC-EDIT1-DAY          PIC 99.
   440             20  SLASH1-2              PIC X.
   441             20  DC-EDIT1-YEAR         PIC 99.
   442         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   443         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   444                     DC-GREG-DATE-2-EDIT.
   445             20  DC-EDIT2-MONTH        PIC 99.
   446             20  SLASH2-1              PIC X.
   447             20  DC-EDIT2-DAY          PIC 99.
   448             20  SLASH2-2              PIC X.
   449             20  DC-EDIT2-YEAR         PIC 99.
   450         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   451         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   452                     DC-GREG-DATE-1-YMD.
   453             20  DC-YMD-YEAR           PIC 99.
   454             20  DC-YMD-MONTH          PIC 99.
   455             20  DC-YMD-DAY            PIC 99.
   456         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   457         16  DC-GREG-DATE-1-MDY-R REDEFINES
   458                      DC-GREG-DATE-1-MDY.
   459             20  DC-MDY-MONTH          PIC 99.
   460             20  DC-MDY-DAY            PIC 99.
   461             20  DC-MDY-YEAR           PIC 99.
   462         16  DC-GREG-DATE-1-ALPHA.
   463             20  DC-ALPHA-MONTH        PIC X(10).
   464             20  DC-ALPHA-DAY          PIC 99.
   465             20  FILLER                PIC XX.
   466             20  DC-ALPHA-CENTURY.
   467                 24 DC-ALPHA-CEN-N     PIC 99.
   468             20  DC-ALPHA-YEAR         PIC 99.
   469         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   470         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   471         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   472         16  DC-JULIAN-DATE            PIC 9(05).
   473         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  11
* ELRATE.cbl
   474                                       PIC 9(05).
   475         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   476             20  DC-JULIAN-YEAR        PIC 99.
   477             20  DC-JULIAN-DAYS        PIC 999.
   478         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   479         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   480         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   481     12  DATE-CONVERSION-VARIBLES.
   482         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   483         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   484             20  FILLER                PIC 9(3).
   485             20  HOLD-CEN-1-CCYY.
   486                 24  HOLD-CEN-1-CC     PIC 99.
   487                 24  HOLD-CEN-1-YY     PIC 99.
   488             20  HOLD-CEN-1-MO         PIC 99.
   489             20  HOLD-CEN-1-DA         PIC 99.
   490         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   491             20  HOLD-CEN-1-R-MO       PIC 99.
   492             20  HOLD-CEN-1-R-DA       PIC 99.
   493             20  HOLD-CEN-1-R-CCYY.
   494                 24  HOLD-CEN-1-R-CC   PIC 99.
   495                 24  HOLD-CEN-1-R-YY   PIC 99.
   496             20  FILLER                PIC 9(3).
   497         16  HOLD-CENTURY-1-X.
   498             20  FILLER                PIC X(3)  VALUE SPACES.
   499             20  HOLD-CEN-1-X-CCYY.
   500                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   501                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   502             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   503             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   504         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   505             20  HOLD-CEN-1-R-X-MO     PIC XX.
   506             20  HOLD-CEN-1-R-X-DA     PIC XX.
   507             20  HOLD-CEN-1-R-X-CCYY.
   508                 24  HOLD-CEN-1-R-X-CC PIC XX.
   509                 24  HOLD-CEN-1-R-X-YY PIC XX.
   510             20  FILLER                PIC XXX.
   511         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   512         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   513         16  DC-JULIAN-DATE-1          PIC 9(07).
   514         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   515             20  DC-JULIAN-1-CCYY.
   516                 24  DC-JULIAN-1-CC    PIC 99.
   517                 24  DC-JULIAN-1-YR    PIC 99.
   518             20  DC-JULIAN-DA-1        PIC 999.
   519         16  DC-JULIAN-DATE-2          PIC 9(07).
   520         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   521             20  DC-JULIAN-2-CCYY.
   522                 24  DC-JULIAN-2-CC    PIC 99.
   523                 24  DC-JULIAN-2-YR    PIC 99.
   524             20  DC-JULIAN-DA-2        PIC 999.
   525         16  DC-GREG-DATE-A-EDIT.
   526             20  DC-EDITA-MONTH        PIC 99.
   527             20  SLASHA-1              PIC X VALUE '/'.
   528             20  DC-EDITA-DAY          PIC 99.
   529             20  SLASHA-2              PIC X VALUE '/'.
   530             20  DC-EDITA-CCYY.
   531                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  12
* ELRATE.cbl
   532                 24  DC-EDITA-YEAR     PIC 99.
   533         16  DC-GREG-DATE-B-EDIT.
   534             20  DC-EDITB-MONTH        PIC 99.
   535             20  SLASHB-1              PIC X VALUE '/'.
   536             20  DC-EDITB-DAY          PIC 99.
   537             20  SLASHB-2              PIC X VALUE '/'.
   538             20  DC-EDITB-CCYY.
   539                 24  DC-EDITB-CENT     PIC 99.
   540                 24  DC-EDITB-YEAR     PIC 99.
   541         16  DC-GREG-DATE-CYMD         PIC 9(08).
   542         16  DC-GREG-DATE-CYMD-R REDEFINES
   543                              DC-GREG-DATE-CYMD.
   544             20  DC-CYMD-CEN           PIC 99.
   545             20  DC-CYMD-YEAR          PIC 99.
   546             20  DC-CYMD-MONTH         PIC 99.
   547             20  DC-CYMD-DAY           PIC 99.
   548         16  DC-GREG-DATE-MDCY         PIC 9(08).
   549         16  DC-GREG-DATE-MDCY-R REDEFINES
   550                              DC-GREG-DATE-MDCY.
   551             20  DC-MDCY-MONTH         PIC 99.
   552             20  DC-MDCY-DAY           PIC 99.
   553             20  DC-MDCY-CEN           PIC 99.
   554             20  DC-MDCY-YEAR          PIC 99.
   555    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   556        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   557    12  DC-EL310-DATE                  PIC X(21).
   558    12  FILLER                         PIC X(28).
   559
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  13
* ELRATE.cbl
   561*                            COPY ELCCALC.
   562******************************************************************
   563*                                                                *
   564*                           ELCCALC.                            *
   565*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   566*                            VMOD=2.025                          *
   567*                                                                *
   568*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   569*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   570*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   571*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   572*                                                                *
   573*  PASSED TO ELRTRM                                              *
   574*  -----------------                                             *
   575*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   576*  ORIGINAL TERM                                                 *
   577*  BEGINNING DATE                                                *
   578*  ENDING DATE                                                   *
   579*  COMPANY I.D.                                                  *
   580*  ACCOUNT MASTER USER FIELD                                     *
   581*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   582*  FREE LOOK DAYS                                                *
   583*                                                                *
   584*  RETURNED FROM ELRTRM                                          *
   585*  ---------------------                                         *
   586*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   587*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   588*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   589*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   590*----------------------------------------------------------------*
   591*  PASSED TO ELRAMT                                              *
   592*  ----------------                                              *
   593*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   594*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   595*  ORIGINAL AMOUNT                                               *
   596*  ALTERNATE BENEFIT (BALLON)                                    *
   597*  A.P.R. - NET PAY ONLY                                         *
   598*  METHOD
   599*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   600*  COMPANY I.D.                                                  *
   601*  BENEFIT TYPE                                                  *
   602*                                                                *
   603*  RETURNED FROM ELRAMT                                          *
   604*  --------------------                                          *
   605*  REMAINING AMOUNT 1 - CURRENT                                  *
   606*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   607*  REMAINING AMOUNT FACTOR
   608*----------------------------------------------------------------*
   609*  PASSED TO ELRESV                                              *
   610*  -----------------                                             *
   611*  CERTIFICATE EFFECTIVE DATE                                    *
   612*  VALUATION DATE                                                *
   613*  PAID THRU DATE                                                *
   614*  BENEFIT                                                       *
   615*  INCURRED DATE                                                 *
   616*  REPORTED DATE                                                 *
   617*  ISSUE AGE                                                     *
   618*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  14
* ELRATE.cbl
   619*  CDT PERCENT                                                   *
   620*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   621* *CLAIM TYPE (LIFE, A/H)                                        *
   622* *REMAINING BENEFIT (FROM ELRAMT)                               *
   623* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   624*                                                                *
   625*  RETURNED FROM ELRESV                                          *
   626*  --------------------                                          *
   627*  CDT TABLE USED                                                *
   628*  CDT FACTOR USED                                               *
   629*  PAY TO CURRENT RESERVE                                        *
   630*  I.B.N.R. - A/H ONLY                                           *
   631*  FUTURE (ACCRUED) AH ONLY                                      *
   632*----------------------------------------------------------------*
   633*  PASSED TO ELRATE                                              *
   634*  ----------------                                              *
   635*  CERT ISSUE DATE                                               *
   636*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   637*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   638*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   639*  STATE CODE (CLIENT DEFINED)                                   *
   640*  STATE CODE (STANDARD P.O. ABBRV)                              *
   641*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   642*  DEVIATION CODE                                                *
   643*  ISSUE AGE                                                     *
   644*  ORIGINAL BENEFIT AMOUNT                                       *
   645*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   646*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   647*  BENEFIT KIND (LIFE OR A/H)                                    *
   648*  A.P.R.                                                        *
   649*  METHOD
   650*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   651*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   652*  COMPANY I.D. (3 CHARACTER)                                    *
   653*  BENEFIT CODE                                                  *
   654*  BENEFIT OVERRIDE CODE                                         *
   655*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   656*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   657*  JOINT INDICATOR (CSL ONLY)                                    *
   658*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   659*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   660*                                                                *
   661*  RETURNED FROM ELRATE                                          *
   662*  --------------------                                          *
   663*  CALCULATED PREMIUM                                            *
   664*  PREMIUM RATE                                                  *
   665*  MORTALITY CODE                                                *
   666*  MAX ATTAINED AGE                                              *
   667*  MAX AGE                                                       *
   668*  MAX TERM                                                      *
   669*  MAX MONTHLY BENEFIT                                           *
   670*  MAX TOTAL BENIFIT                                             *
   671*  COMPOSITE RATE (OPEN-END ONLY)                                *
   672*----------------------------------------------------------------*
   673*  PASSED TO ELRFND                                              *
   674*  ----------------                                              *
   675*  CERT ISSUE DATE                                               *
   676*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  15
* ELRATE.cbl
   677*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   678*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   679*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   680*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   681*  STATE CODE (CLIENT DEFINED)                                   *
   682*  STATE CODE (STANDARD P.O. ABBRV)                              *
   683*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   684*  DEVIATION CODE                                                *
   685*  ISSUE AGE                                                     *
   686*  ORIGINAL BENEFIT AMOUNT                                       *
   687*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   688*  PROCESS TYPE (CANCEL)                                         *
   689*  BENEFIT KIND (LIFE OR A/H)                                    *
   690*  A.P.R.                                                        *
   691*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   692*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   693*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   694*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   695*  COMPANY I.D. (3 CHARACTER)                                    *
   696*  BENEFIT CODE                                                  *
   697*  BENEFIT OVERRIDE CODE                                         *
   698*                                                                *
   699*  RETURNED FROM ELRFND                                          *
   700*  --------------------                                          *
   701*  CALCULATED REFUND                                             *
   702*----------------------------------------------------------------*
   703*  PASSED TO ELEARN                                              *
   704*  ----------------                                              *
   705*  CERT ISSUE DATE                                               *
   706*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   707*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   708*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   709*  STATE CODE (CLIENT DEFINED)                                   *
   710*  STATE CODE (STANDARD P.O. ABBRV)                              *
   711*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   712*  DEVIATION CODE                                                *
   713*  ISSUE AGE                                                     *
   714*  ORIGINAL BENEFIT AMOUNT                                       *
   715*  BENEFIT KIND (LIFE OR A/H)                                    *
   716*  A.P.R.                                                        *
   717*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   718*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   719*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   720*  COMPANY I.D. (3 CHARACTER)                                    *
   721*  BENEFIT CODE                                                  *
   722*  BENEFIT OVERRIDE CODE                                         *
   723*                                                                *
   724*  RETURNED FROM ELEARN                                          *
   725*  --------------------                                          *
   726*  INDICATED  EARNINGS                                           *
   727*----------------------------------------------------------------*
   728*                 LENGTH = 450                                   *
   729*                                                                *
   730******************************************************************
   731******************************************************************
   732*                   C H A N G E   L O G
   733*
   734* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  16
* ELRATE.cbl
   735*-----------------------------------------------------------------
   736*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   737* EFFECTIVE    NUMBER
   738*-----------------------------------------------------------------
   739* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   740* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   741* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   742* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   743* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   744* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   745* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   746* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   747* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   748* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   749* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   750******************************************************************
   751
   752 01  CALCULATION-PASS-AREA.
   753     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   754                                     COMP.
   755
   756     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   757       88  NO-CP-ERROR                             VALUE ZERO.
   758       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   759                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   760       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   761       88  CP-ERROR-IN-DATES                       VALUE '2'.
   762       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   763       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   764       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   765       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   766       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   767       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   768       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   769       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   770       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   771       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   772       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   773       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   774       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   775       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   776       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   777
   778     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   779       88  NO-CP-ERROR-2                           VALUE ZERO.
   780***********************  INPUT AREAS ****************************
   781
   782     12  CP-CALCULATION-AREA.
   783         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   784         16  CP-CERT-EFF-DT        PIC XX.
   785         16  CP-VALUATION-DT       PIC XX.
   786         16  CP-PAID-THRU-DT       PIC XX.
   787         16  CP-BENEFIT-TYPE       PIC X.
   788           88  CP-AH                               VALUE 'A' 'D'
   789                                                   'I' 'U'.
   790           88  CP-REDUCING-LIFE                    VALUE 'R'.
   791           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   792         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  17
* ELRATE.cbl
   793         16  CP-REPORTED-DT        PIC XX.
   794         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   795         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   796         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   797                                     COMP-3.
   798         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   799                                     COMP-3.
   800         16  CP-CDT-METHOD         PIC X.
   801           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   802           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   803           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   804         16  CP-CLAIM-TYPE         PIC X.
   805           88  CP-AH-CLAIM                         VALUE 'A'.
   806           88  CP-LIFE-CLAIM                       VALUE 'L'.
   807         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   808                                     COMP-3.
   809         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   810                                     COMP-3.
   811         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   812                                     COMP-3.
   813         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   814                                     COMP-3.
   815         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   816                                     COMP-3.
   817         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   818                                     COMP-3.
   819         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   820                                     COMP-3.
   821         16  CP-REM-TERM-METHOD    PIC X.
   822           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   823           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   824           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   825           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   826           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   827           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   828           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   829         16  CP-EARNING-METHOD     PIC X.
   830           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   831           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   832           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   833           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   834           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   835           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   836           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   837           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   838           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   839           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   840           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   841           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   842           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   843           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   844         16  CP-PROCESS-TYPE       PIC X.
   845           88  CP-CLAIM                            VALUE '1'.
   846           88  CP-CANCEL                           VALUE '2'.
   847           88  CP-ISSUE                            VALUE '3'.
   848         16  CP-SPECIAL-CALC-CD    PIC X.
   849           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   850           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  18
* ELRATE.cbl
   851           88  CP-0-MTH-INTEREST               VALUE 'A'.
   852           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   853           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   854           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   855           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   856           88  CP-FARM-PLAN                    VALUE 'F'.
   857           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   858           88  CP-2-MTH-INTEREST               VALUE 'I'.
   859           88  CP-3-MTH-INTEREST               VALUE 'J'.
   860           88  CP-4-MTH-INTEREST               VALUE 'K'.
   861           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   862           88  CP-MORTGAGE-REC                 VALUE 'M'.
   863           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   864           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   865           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   866           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   867                                                     'W' 'X'.
   868           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   869           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   870           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   871           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   872           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   873           88  CP-SUMMARY-REC                  VALUE 'Z'.
   874           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   875           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   876           88  CP-AD-D-BENEFIT                 VALUE '4'.
   877           88  CP-CSL-METH-1                   VALUE '5'.
   878           88  CP-CSL-METH-2                   VALUE '6'.
   879           88  CP-CSL-METH-3                   VALUE '7'.
   880           88  CP-CSL-METH-4                   VALUE '8'.
   881
   882         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   883                                     COMP-3.
   884         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   885         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   886         16  CP-STATE              PIC XX          VALUE SPACE.
   887         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   888         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   889           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   890               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   891         16  CP-R78-OPTION         PIC X.
   892           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   893           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   894
   895         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   896         16  CP-IBNR-RESERVE-SW    PIC X.
   897         16  CP-CLAIM-STATUS       PIC X.
   898         16  CP-RATE-FILE          PIC X.
   899         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   900                                     COMP-3.
   901
   902         16  CP-LIFE-OVERRIDE-CODE PIC X.
   903         16  CP-AH-OVERRIDE-CODE   PIC X.
   904
   905         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   906                                     COMP-3.
   907         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   908                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  19
* ELRATE.cbl
   909         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   910                                     COMP-3.
   911         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   912                                     COMP-3.
   913         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   914                                     COMP-3.
   915         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   916                                  PIC S9(7)V99 COMP-3.
   917
   918         16  CP-PAID-FROM-DATE     PIC X(02).
   919         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   920         16  CP-EXT-DAYS-CALC      PIC X.
   921           88  CP-EXT-NO-CHG                   VALUE ' '.
   922           88  CP-EXT-CHG-LF                   VALUE '1'.
   923           88  CP-EXT-CHG-AH                   VALUE '2'.
   924           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   925         16  CP-DOMICILE-STATE     PIC XX.
   926         16  CP-CARRIER            PIC X.
   927         16  CP-REIN-FLAG          PIC X.
   928         16  CP-REM-TRM-CALC-OPTION PIC X.
   929           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   930                      '2' '3' '4' '5'.
   931           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   932           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   933           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   934           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   935           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   936           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   937           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   938           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   939         16  CP-SIG-SWITCH         PIC X.
   940         16  CP-RATING-METHOD      PIC X.
   941           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   942           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   943           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   944           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   945           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   946           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   947           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   948           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   949           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   950         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   951                                     COMP-3.
   952         16  CP-BEN-CATEGORY       PIC X.
   953         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   954         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   955                                   PIC S99V9(5) COMP-3.
   956         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   957         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   958                                   PIC S99V9(5) COMP-3.
   959         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   960         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   961         16  CP-EXPIRE-DT          PIC XX.
   962         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   963         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   964         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   965         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   966         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  20
* ELRATE.cbl
   967             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   968             88  CP-CALC-CLP              VALUE 'C'.
   969         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   970         16  CP-CANCEL-REASON      PIC X.
   971         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   972         16  CP-PMT-MODE           PIC X.
   973         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   974         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   975         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   976         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   977         16  FILLER                PIC X.
   978
   979***************    OUTPUT FROM ELRESV   ************************
   980
   981         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   982
   983         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   984                                     COMP-3.
   985         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   986                                     COMP-3.
   987         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   988                                     COMP-3.
   989         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   990                                     COMP-3.
   991         16  FILLER                PIC X(09).
   992***************    OUTPUT FROM ELRTRM   *************************
   993
   994         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   995                                     COMP-3.
   996         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   997                                     COMP-3.
   998         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   999                                     COMP-3.
  1000         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1001                                     COMP-3.
  1002         16  FILLER                PIC X(12).
  1003
  1004***************    OUTPUT FROM ELRAMT   *************************
  1005
  1006         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1007                                     COMP-3.
  1008         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1009                                     COMP-3.
  1010         16  FILLER                PIC X(12).
  1011
  1012***************    OUTPUT FROM ELRATE   *************************
  1013
  1014         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1015                                     COMP-3.
  1016         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1017                                     COMP-3.
  1018         16  CP-MORTALITY-CODE     PIC X(4).
  1019         16  CP-RATE-EDIT-FLAG     PIC X.
  1020             88  CP-RATES-NEED-APR                  VALUE '1'.
  1021         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1022                                     COMP-3.
  1023         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1024         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  21
* ELRATE.cbl
  1025         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1026                                   PIC S9(7)V99 COMP-3.
  1027         16  FILLER                PIC X(07).
  1028
  1029***************    OUTPUT FROM ELRFND   *************************
  1030
  1031         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1032                                     COMP-3.
  1033         16  CP-REFUND-TYPE-USED   PIC X.
  1034           88  CP-R-AS-R78                         VALUE '1'.
  1035           88  CP-R-AS-PRORATA                     VALUE '2'.
  1036           88  CP-R-AS-CALIF                       VALUE '3'.
  1037           88  CP-R-AS-TEXAS                       VALUE '4'.
  1038           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1039           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1040           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1041           88  CP-R-AS-MEAN                        VALUE '8'.
  1042           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1043           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1044           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1045           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1046           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1047           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1048         16  FILLER                PIC X(12).
  1049
  1050***************    OUTPUT FROM ELEARN   *************************
  1051
  1052         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1053                                     COMP-3.
  1054         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1055                                     COMP-3.
  1056         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1057                                     COMP-3.
  1058         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1059                                     COMP-3.
  1060         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1061                                     COMP-3.
  1062         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1063                                     COMP-3.
  1064         16  CP-EARNING-TYPE-USED  PIC X.
  1065           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1066           88  CP-E-AS-R78                         VALUE '1'.
  1067           88  CP-E-AS-PRORATA                     VALUE '2'.
  1068           88  CP-E-AS-TEXAS                       VALUE '4'.
  1069           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1070           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1071           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1072           88  CP-E-AS-MEAN                        VALUE '8'.
  1073           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1074         16  FILLER                PIC X(12).
  1075
  1076***************    OUTPUT FROM ELPMNT   *************************
  1077
  1078         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1079                                     COMP-3.
  1080         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1081                                     COMP-3.
  1082         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  22
* ELRATE.cbl
  1083
  1084***************   MISC WORK AREAS    *****************************
  1085         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1086                                     COMP-3.
  1087         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1088                                     COMP-3.
  1089         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1090                                     COMP-3.
  1091         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1092                                     COMP-3.
  1093         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1094                                     COMP-3.
  1095         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1096                                     COMP-3.
  1097         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1098             88  OPEN-RATE-FILE                   VALUE 'O'.
  1099             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1100             88  IO-ERROR                         VALUE 'E'.
  1101
  1102         16  CP-FIRST-PAY-DATE     PIC XX.
  1103
  1104         16  CP-JOINT-INDICATOR    PIC X.
  1105
  1106         16  CP-RESERVE-REMAINING-TERM
  1107                                   PIC S9(4)V9    VALUE ZERO
  1108                                     COMP-3.
  1109
  1110         16  CP-INSURED-BIRTH-DT   PIC XX.
  1111
  1112         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1113                                     COMP-3.
  1114
  1115         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1116                                     COMP-3.
  1117
  1118         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1119                                     COMP-3.
  1120
  1121         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1122                                     COMP-3.
  1123
  1124         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1125                                     COMP-3.
  1126
  1127         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1128                                     COMP-3.
  1129
  1130         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1131                                     COMP-3.
  1132
  1133         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1134             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1135
  1136         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1137                                     COMP-3.
  1138         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1139                                     COMP-3.
  1140         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  23
* ELRATE.cbl
  1141         16  cp-extra-periods      pic 9 value zeros.
  1142         16  cp-net-only-state     pic x value spaces.
  1143         16  FILLER                PIC X(13).
  1144******************************************************************
  1145
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  24
* ELRATE.cbl
  1147****************************************************************
  1148*
  1149* Copyright (c) 2007-2013 Dell Inc.
  1150* All rights reserved.
  1151*
  1152****************************************************************
  1153 01  DFHEIV.
  1154   02  DFHEIV0               PIC X(35).
  1155   02  DFHEIV1               PIC X(08).
  1156   02  DFHEIV2               PIC X(08).
  1157   02  DFHEIV3               PIC X(08).
  1158   02  DFHEIV4               PIC X(06).
  1159   02  DFHEIV5               PIC X(04).
  1160   02  DFHEIV6               PIC X(04).
  1161   02  DFHEIV7               PIC X(02).
  1162   02  DFHEIV8               PIC X(02).
  1163   02  DFHEIV9               PIC X(01).
  1164   02  DFHEIV10              PIC S9(7) COMP-3.
  1165   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1166   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1167   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1168   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1169   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1170   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1171   02  DFHEIV17              PIC X(04).
  1172   02  DFHEIV18              PIC X(04).
  1173   02  DFHEIV19              PIC X(04).
  1174   02  DFHEIV20              USAGE IS POINTER.
  1175   02  DFHEIV21              USAGE IS POINTER.
  1176   02  DFHEIV22              USAGE IS POINTER.
  1177   02  DFHEIV23              USAGE IS POINTER.
  1178   02  DFHEIV24              USAGE IS POINTER.
  1179   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1180   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1181   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1182   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1183   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1184   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1185   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1186   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1187   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1188   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1189   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1190   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1191   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1192   02  FILLER                PIC X(02).
  1193   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1194   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1195   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1196   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1197   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1198   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1199   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1200 LINKAGE  SECTION.
  1201*****************************************************************
  1202*                                                               *
  1203* Copyright (c) 2007-2013 Dell Inc.                             *
  1204* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  25
* ELRATE.cbl
  1205*                                                               *
  1206*****************************************************************
  1207 01  dfheiblk.
  1208     02  eibtime          pic s9(7) comp-3.
  1209     02  eibdate          pic s9(7) comp-3.
  1210     02  eibtrnid         pic x(4).
  1211     02  eibtaskn         pic s9(7) comp-3.
  1212     02  eibtrmid         pic x(4).
  1213     02  dfheigdi         pic s9(4) comp.
  1214     02  eibcposn         pic s9(4) comp.
  1215     02  eibcalen         pic s9(4) comp.
  1216     02  eibaid           pic x(1).
  1217     02  eibfiller1       pic x(1).
  1218     02  eibfn            pic x(2).
  1219     02  eibfiller2       pic x(2).
  1220     02  eibrcode         pic x(6).
  1221     02  eibfiller3       pic x(2).
  1222     02  eibds            pic x(8).
  1223     02  eibreqid         pic x(8).
  1224     02  eibrsrce         pic x(8).
  1225     02  eibsync          pic x(1).
  1226     02  eibfree          pic x(1).
  1227     02  eibrecv          pic x(1).
  1228     02  eibsend          pic x(1).
  1229     02  eibatt           pic x(1).
  1230     02  eibeoc           pic x(1).
  1231     02  eibfmh           pic x(1).
  1232     02  eibcompl         pic x(1).
  1233     02  eibsig           pic x(1).
  1234     02  eibconf          pic x(1).
  1235     02  eiberr           pic x(1).
  1236     02  eibrldbk         pic x(1).
  1237     02  eiberrcd         pic x(4).
  1238     02  eibsynrb         pic x(1).
  1239     02  eibnodat         pic x(1).
  1240     02  eibfiller5       pic x(2).
  1241     02  eibresp          pic s9(8) comp.
  1242     02  eibresp2         pic s9(8) comp.
  1243     02  dfheigdj         pic s9(4) comp.
  1244     02  dfheigdk         pic s9(4) comp.
  1245 01  DFHCOMMAREA             PIC X(450).
  1246
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  26
* ELRATE.cbl
  1248*01 PARMLIST              COMP.
  1249*    02  FILLER              PIC S9(8).
  1250*    02  ERRATE-POINTER      PIC S9(8).
  1251
  1252*                                COPY ERCRATE.
  1253******************************************************************
  1254*                                                                *
  1255*                                                                *
  1256*                            ERCRATE                             *
  1257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1258*                            VMOD=2.008                          *
  1259*                                                                *
  1260*   ONLINE CREDIT SYSTEM                                         *
  1261*                                                                *
  1262*   FILE DESCRIPTION = RATES MASTER FILE                         *
  1263*                                                                *
  1264*   FILE TYPE = VSAM,KSDS                                        *
  1265*   RECORD SIZE = 1765  RECFORM = FIXED                          *
  1266*                                                                *
  1267*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
  1268*       ALTERNATE PATH = NONE                                    *
  1269*                                                                *
  1270*   LOG = NO                                                     *
  1271*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1272*                                                                *
  1273******************************************************************
  1274******************************************************************
  1275*                   C H A N G E   L O G
  1276*
  1277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1278*-----------------------------------------------------------------
  1279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1280* EFFECTIVE    NUMBER
  1281*-----------------------------------------------------------------
  1282* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1283******************************************************************
  1284
  1285 01  RATE-RECORD.
  1286     12  RT-RECORD-ID                      PIC XX.
  1287         88  VALID-RT-ID                      VALUE 'RT'.
  1288
  1289     12  RT-CONTROL-PRIMARY.
  1290         16  RT-COMPANY-CD                 PIC X.
  1291         16  RT-STATE-CODE.
  1292             20  RT-ST-CODE                PIC XX.
  1293             20  RT-ST-CLASS               PIC XX.
  1294             20  RT-ST-DEV                 PIC XXX.
  1295         16  RT-L-AH-CODE.
  1296             20  RT-L-AH                   PIC X.
  1297             20  RT-LAH-NUM                PIC XX.
  1298         16  RT-LIMITS.
  1299             20  RT-HIGH-AGE               PIC 99.
  1300             20  RT-HIGH-AMT               PIC 9(6).
  1301             20  RT-FUTURE                 PIC XX.
  1302             20  RT-SEX                    PIC X.
  1303         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
  1304
  1305     12  RT-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  27
* ELRATE.cbl
  1306         16  RT-LAST-MAINT-DT              PIC XX.
  1307         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1308         16  RT-LAST-MAINT-USER            PIC X(4).
  1309         16  FILLER                        PIC X(10).
  1310
  1311     12  RT-STRUCTURE-COMMENT              PIC X(50).
  1312     12  RT-RATE-COMMENT                   PIC X(50).
  1313
  1314     12  CSL-RESERVED                      PIC X(10).
  1315     12  FILLER                            PIC X(12).
  1316
  1317     12  RT-MAX-AGE                        PIC 99.
  1318
  1319     12  RT-LIFE-LIMS-FLDS.
  1320         16  RT-LIFE-MORT-CODE             PIC X(4).
  1321         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
  1322             20  RT-L-EX-AGE               PIC 99.
  1323             20  RT-L-EX-TERM              PIC S999       COMP-3.
  1324             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
  1325         16  FILLER                        PIC X(20).
  1326
  1327     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
  1328         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
  1329             20  RT-AH-AGE                 PIC 99.
  1330             20  RT-AH-TERM                PIC S999       COMP-3.
  1331             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
  1332             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
  1333
  1334     12  RT-LIFE-RATES.
  1335         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
  1336
  1337     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
  1338         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
  1339
  1340     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
  1341
  1342     12  RT-DISCOUNT-OPTION                PIC X.
  1343         88  RT-DO-NOT-USE                     VALUE ' '.
  1344         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
  1345         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
  1346
  1347     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
  1348     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
  1349
  1350     12  RT-COMPOSITE-OPTION               PIC X.
  1351         88  RT-NO-COMPOSITE                   VALUE ' '.
  1352         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
  1353
  1354     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
  1355
  1356     12  RT-CANCEL-FEE                     PIC S9(3)V99   COMP-3.
  1357     12  FILLER                            PIC X(13).
  1358
  1359     12  RT-TYPE-RATE                      PIC X.
  1360         88  RT-IS-STND                        VALUE ' ' 'S'.
  1361         88  RT-IS-OB                          VALUE 'O'.
  1362
  1363     12  RT-SRT-ALPHA                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  28
* ELRATE.cbl
  1364
  1365     12  RT-CONTROL-2.
  1366         16  RTC-1                         PIC X(7).
  1367         16  RTC-3                         PIC X(11).
  1368         16  RTC-4                         PIC 9(11) COMP-3.
  1369         16  RTC-2                         PIC X(3).
  1370******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  29
* ELRATE.cbl
  1372 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA RATE-RECORD.
  1373 0000-DFHEXIT SECTION.
  1374     MOVE '9#                    $   ' TO DFHEIV0.
  1375     MOVE 'ELRATE' TO DFHEIV1.
  1376     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1377
  1378     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
  1379
  1380 000-START-PREMIUM-CALC.
  1381     MOVE ZERO                   TO CP-RETURN-CODE
  1382                                    CP-CALC-PREMIUM
  1383                                    CP-PREMIUM-RATE
  1384                                    CP-cancel-FEE.
  1385
  1386     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1387     MOVE ALL '9'                TO ERRATE-KEY.
  1388
  1389*    IF CP-RATE-FILE = 'O'
  1390*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1391
  1392     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1393     MOVE CP-STATE               TO RATE-ST-CODE.
  1394     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1395     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1396     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1397
  1398     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1399        CP-RATING-BENEFIT-AMT = ZEROS
  1400         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1401     ELSE
  1402         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1403
  1404     IF CP-AH
  1405         MOVE CP-AH-OVERRIDE-CODE     TO RATE-L-AH
  1406     ELSE
  1407         MOVE CP-LIFE-OVERRIDE-CODE   TO RATE-L-AH.
  1408
  1409     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1410     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1411     MOVE SPACE                  TO DC-OPTION-CODE.
  1412
  1413     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1414
  1415*** Y2K, PROJ 7744
  1416     IF NO-CONVERSION-ERROR
  1417         MOVE ZEROS                 TO RATE-EXPIRY-DATE
  1418                                       WS-HOLD-RATE-EXP-DT
  1419         MOVE DC-GREG-DATE-CYMD     TO WS-HOLD-RATE-EXP-AL(4:8)
  1420         MOVE WS-HOLD-RATE-EXP-DT   TO RATE-EXPIRY-DATE
  1421         MOVE ERRATE-KEY            TO SAVE-ERRATE-KEY
  1422     ELSE
  1423         MOVE '2'                   TO CP-RETURN-CODE
  1424         GO TO 9999-CALC-RATE-PREM-X
  1425     END-IF.
  1426*** Y2K, PROJ 7744
  1427
  1428
  1429* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  30
* ELRATE.cbl
  1430*        NOTFND   (9999-RATE-NOTFND)
  1431*        NOTOPEN  (9999-RATE-NOTOPEN)
  1432*        ENDFILE  (9999-RATE-NOTFND)
  1433*    END-EXEC.
  1434*    MOVE '"$IJ''                 ! " #00001424' TO DFHEIV0
  1435     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  1436     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1437     MOVE X'2220233030303031343234' TO DFHEIV0(25:11)
  1438     CALL 'kxdfhei1' USING DFHEIV0
  1439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1440
  1441
  1442 0050-RATE-START-BROWSE.
  1443
  1444* EXEC CICS STARTBR
  1445*        DATASET  (ERRATE-FILE-ID)
  1446*        RIDFLD   (ERRATE-KEY)
  1447*        GTEQ
  1448*    END-EXEC.
  1449     MOVE 0
  1450       TO DFHEIV11
  1451*    MOVE '&,         G          &   #00001431' TO DFHEIV0
  1452     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1453     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1454     MOVE X'2020233030303031343331' TO DFHEIV0(25:11)
  1455     CALL 'kxdfhei1' USING DFHEIV0,
  1456           ERRATE-FILE-ID,
  1457           ERRATE-KEY,
  1458           DFHEIV99,
  1459           DFHEIV11,
  1460           DFHEIV99
  1461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1462
  1463
  1464     MOVE 'Y'                  TO WS-BROWSE-SW.
  1465
  1466 0100-READ-RATE-LOOP.
  1467
  1468* EXEC CICS READNEXT
  1469*        DATASET  (ERRATE-FILE-ID)
  1470*        SET      (ADDRESS OF RATE-RECORD)
  1471*        RIDFLD   (ERRATE-KEY)
  1472*    END-EXEC.
  1473     MOVE 0
  1474       TO DFHEIV11
  1475*    MOVE '&.S                   )   #00001440' TO DFHEIV0
  1476     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1477     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1478     MOVE X'2020233030303031343430' TO DFHEIV0(25:11)
  1479     CALL 'kxdfhei1' USING DFHEIV0,
  1480           ERRATE-FILE-ID,
  1481           DFHEIV20,
  1482           DFHEIV99,
  1483           ERRATE-KEY,
  1484           DFHEIV99,
  1485           DFHEIV11,
  1486           DFHEIV99,
  1487           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  31
* ELRATE.cbl
  1488     SET ADDRESS OF RATE-RECORD TO
  1489         DFHEIV20
  1490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1491
  1492
  1493 0110-CHECK-KEYS.
  1494*                            COPY ELCRATPD.
  1495******************************************************************
  1496*                                                                *
  1497*                                                                *
  1498*                            ELCRATPD                            *
  1499*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1500*                            VMOD=2.061                          *
  1501*                                                                *
  1502******************************************************************
  1503******************************************************************
  1504*                   C H A N G E   L O G
  1505*
  1506* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1507*-----------------------------------------------------------------
  1508*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1509* EFFECTIVE    NUMBER
  1510*-----------------------------------------------------------------
  1511* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1512* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1513* 032603                   PEMA  ADD SPECIAL AZ CALC
  1514* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1515* 120403                   PEMA  ADD SPECIAL TX CALC
  1516* 092205                   PEMA  FIX CRIT PER FOR DCC
  1517* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1518* 021207                   PEMA  ADD PA NP
  1519* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1520* 032807                   PEMA  ADD VT NP PLUS 2
  1521* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1522* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1523* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1524* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1525* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1526* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1527* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1528* 071211    2010012700001  PEMA  ADD SPPDD
  1529* 071511    2011021500001  PEMA  ADD CODE FOR DCC 10C
  1530* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  1531* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1532* 032612  CR2011110200001  PEMA  AHL CHANGES
  1533* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  1534* 122613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  1535* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  1536* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1537* 021519  CR2019021100001  PEMA  non-monthly al calcs
  1538* 072419  IR2019072400001  PEMA  Initialize pmt mode(AL)
  1539******************************************************************
  1540
  1541 0110-CHECK-KEY.
  1542     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1543        SVRT-ST-CODE    = RT-ST-CODE     AND
  1544        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1545        SVRT-ST-DEV     = RT-ST-DEV      AND
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  32
* ELRATE.cbl
  1546        SVRT-L-AH       = RT-L-AH        AND
  1547        SVRT-LAH-NUM    = RT-LAH-NUM
  1548         NEXT SENTENCE
  1549     ELSE
  1550         GO TO 9999-RATE-NOTFND.
  1551
  1552     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
  1553         GO TO 9999-RATE-NOTFND.
  1554
  1555     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1556        GO TO 0100-READ-RATE-LOOP.
  1557
  1558     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1559         GO TO 0100-READ-RATE-LOOP.
  1560
  1561     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1562         GO TO 0100-READ-RATE-LOOP.
  1563
  1564     IF RT-MAX-AGE = ZEROS
  1565         NEXT SENTENCE
  1566     ELSE
  1567         COMPUTE WS-AGE =
  1568             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1569         IF WS-AGE >= RT-MAX-AGE
  1570             MOVE 'B'               TO CP-RETURN-CODE.
  1571
  1572     IF CP-LOAN-TERM NOT NUMERIC
  1573         MOVE +0                    TO CP-LOAN-TERM.
  1574
  1575     IF CP-LOAN-TERM = ZERO
  1576         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1577
  1578     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1579         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1580
  1581     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1582     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1583
  1584     IF CP-AH
  1585         GO TO 2000-TYPE-IS-AH.
  1586
  1587*    display ' ben type           ' cp-benefit-type
  1588*    display ' earn meth          ' cp-earning-method
  1589*    display ' process type       ' cp-process-type
  1590*    display ' special            ' cp-special-calc-cd
  1591*    display ' ben code           ' cp-benefit-cd
  1592*    display ' ext days calc      ' cp-ext-days-calc
  1593*    display ' rating meth        ' cp-rating-method
  1594*    display ' orig ben           ' cp-original-benefit
  1595     evaluate true
  1596        when (rt-is-ob)
  1597           and (cp-company-id not = 'CID')
  1598              move cp-loan-term  to ws-rate-term
  1599        when (cp-company-id = 'DCC' OR 'VPP')
  1600           and (cp-benefit-cd (1:1) = 'P')
  1601           move cp-loan-term     to ws-rate-term
  1602        when other
  1603           move cp-original-term to ws-rate-term
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  33
* ELRATE.cbl
  1604     end-evaluate
  1605
  1606*    IF ((RT-IS-OB)
  1607*       AND (CP-COMPANY-ID NOT EQUAL 'CID'))
  1608*                     OR
  1609*       ((CP-COMPANY-ID = 'DCC')
  1610*       AND (CP-BENEFIT-CD (1:1) = 'P'))
  1611*       MOVE CP-LOAN-TERM        TO WS-RATE-TERM
  1612*    ELSE
  1613*       MOVE CP-ORIGINAL-TERM TO WS-RATE-TERM
  1614*    END-IF
  1615
  1616     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
  1617     MOVE SPACE                     TO DC-OPTION-CODE.
  1618
  1619     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1620
  1621 1000-TYPE-IS-LIFE.
  1622     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1623
  1624     MOVE ZERO                      TO CP-R-MAX-AGE
  1625                                       CP-R-MAX-TERM
  1626                                       CP-R-MAX-MON-BEN
  1627                                       CP-R-MAX-TOT-BEN.
  1628
  1629     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
  1630
  1631     IF RT-CANCEL-FEE NUMERIC
  1632        MOVE RT-CANCEL-FEE          TO CP-CANCEL-FEE.
  1633
  1634     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1635
  1636     if rt-discount-ob-rate not numeric
  1637        move zeros               to rt-discount-ob-rate
  1638     end-if
  1639     IF (RT-DISCOUNT-OPTION EQUAL
  1640                     '1' OR '2' OR '3' OR '4' OR '5') AND
  1641        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1642        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1643         NEXT SENTENCE
  1644     ELSE
  1645         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1646            (CP-STATE-STD-ABBRV EQUAL 'CA')
  1647             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1648                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1649                 GO TO 1050-REGULAR-RATES
  1650             ELSE
  1651                 GO TO 1050-REGULAR-RATES
  1652         ELSE
  1653             GO TO 1050-REGULAR-RATES.
  1654
  1655*    display ' discount option ' rt-discount-option
  1656     IF RT-DISCOUNT-RATE NOT NUMERIC
  1657        MOVE +0                  TO RT-DISCOUNT-RATE.
  1658
  1659     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1660        NEXT SENTENCE
  1661     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  34
* ELRATE.cbl
  1662        MOVE +0                  TO CP-PREMIUM-RATE
  1663                                    CP-COMPOSITE-RATE
  1664                                    CP-CALC-PREMIUM
  1665         MOVE '4'                TO CP-RETURN-CODE
  1666         GO TO 9999-CALC-RATE-PREM-X.
  1667
  1668     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1669        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1670     ELSE
  1671        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
  1672
  1673*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1674*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1675*       GO TO 1075-BYPASS-REGULAR-RATE.
  1676
  1677     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  1678        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1679        COMPUTE WS-WORK-DIS-RATE EQUAL
  1680                WS-WORK-DIS-RATE / +100
  1681        GO TO 1075-BYPASS-REGULAR-RATE.
  1682
  1683     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1684        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1685        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1686        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1687        GO TO 1075-BYPASS-REGULAR-RATE.
  1688
  1689     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1690        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  1691        (CP-TRUNCATED-LIFE)
  1692        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1693        GO TO 1075-BYPASS-REGULAR-RATE.
  1694
  1695     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1696        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1697        (CP-EARN-AS-NET-PAY)
  1698*       (CP-TRUNCATED-LIFE)
  1699        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1700        GO TO 1075-BYPASS-REGULAR-RATE.
  1701
  1702     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1703        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1704                   AND
  1705        ((CP-EARN-AS-NET-PAY)
  1706               OR
  1707        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1708        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1709        GO TO 1075-BYPASS-REGULAR-RATE.
  1710
  1711     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1712        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1713        (CP-EARN-AS-NET-PAY) AND
  1714        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1715        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1716        GO TO 1075-BYPASS-REGULAR-RATE.
  1717
  1718     if (cp-company-id = 'CID')
  1719        and (cp-state-std-abbrv = 'WA' or 'AL')
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  35
* ELRATE.cbl
  1720        and (rt-discount-option = '1')
  1721        and (cp-earn-as-farm-plan)
  1722        move rt-discount-ob-rate to cp-premium-rate
  1723        go to 1075-bypass-regular-rate
  1724     end-if
  1725     IF (CP-COMPANY-ID = 'CID')
  1726        AND (CP-STATE-STD-ABBRV = 'MN')
  1727        AND (RT-DISCOUNT-OPTION = '1')
  1728        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1729                     OR
  1730            (CP-LEVEL-LIFE OR CP-EARN-AS-FARM-PLAN)
  1731            AND (CP-CERT-EFF-DT > X'A4FF'))
  1732        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1733*       display ' made it to MN 1 ' cp-premium-rate
  1734        GO TO 1075-BYPASS-REGULAR-RATE
  1735     END-IF
  1736     if (cp-company-id = 'CID')
  1737        and (cp-earn-as-reg-balloon)
  1738        and (cp-ben-category = 'P' or 'I')
  1739        and (rt-discount-ob-rate not = zeros)
  1740        go to 1075-bypass-regular-rate
  1741     end-if
  1742     IF (CP-COMPANY-ID EQUAL 'CID')
  1743        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1744                      OR
  1745            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1746        AND (CP-EARN-AS-NET-PAY)
  1747        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1748        GO TO 1075-BYPASS-REGULAR-RATE
  1749     END-IF
  1750     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1751        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1752        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1753         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1754         GO TO 1075-BYPASS-REGULAR-RATE.
  1755
  1756     IF CP-COMPANY-ID = 'CID' or 'AHL'
  1757        CONTINUE
  1758     ELSE
  1759        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1760           (CP-EARN-AS-NET-PAY ) AND
  1761           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  1762            GO TO 1075-BYPASS-REGULAR-RATE
  1763        END-IF
  1764     END-IF
  1765     IF (CP-COMPANY-ID = 'CID') AND
  1766        (CP-EARN-AS-NET-PAY) AND
  1767        (CP-LEVEL-LIFE) AND
  1768        (CP-STATE-STD-ABBRV = 'CA') AND
  1769        (CP-STATE-STD-ABBRV = CP-STATE)
  1770        COMPUTE WS-WORK-DIS-RATE =
  1771             RT-DISCOUNT-RATE / +100
  1772        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1773        GO TO 1075-BYPASS-REGULAR-RATE
  1774     END-IF
  1775
  1776     IF (CP-COMPANY-ID = 'CID')
  1777        AND (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  36
* ELRATE.cbl
  1778        AND (CP-STATE-STD-ABBRV = 'ME')
  1779        COMPUTE WS-WORK-DIS-RATE =
  1780             RT-DISCOUNT-RATE / +100
  1781        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1782        GO TO 1075-BYPASS-REGULAR-RATE
  1783     END-IF
  1784     IF (CP-COMPANY-ID = 'CID')
  1785        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1786           OR 'IN' OR 'AZ')
  1787        AND (CP-FARM-PLAN)
  1788        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1789        GO TO 1075-BYPASS-REGULAR-RATE
  1790     END-IF
  1791     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  1792        AND (CP-BEN-CATEGORY = 'D')
  1793        AND (CP-EARN-AS-NET-PAY)
  1794        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1795        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1796           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1797*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1798*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1799*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1800*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1801        GO TO 1075-BYPASS-REGULAR-RATE
  1802     END-IF
  1803     IF (CP-COMPANY-ID = 'CID') AND
  1804        (CP-EARN-AS-NET-PAY) AND
  1805        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  1806                            OR 'VT')
  1807                   OR
  1808        ((CP-STATE-STD-ABBRV = 'IN') AND
  1809        (CP-CERT-EFF-DT > X'9A7F'))
  1810                   OR
  1811        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1812        (CP-CERT-EFF-DT > X'9ADF'))) AND
  1813        (CP-STATE-STD-ABBRV = CP-STATE)
  1814        COMPUTE WS-WORK-DIS-RATE =
  1815             RT-DISCOUNT-RATE / +100
  1816        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1817        GO TO 1075-BYPASS-REGULAR-RATE
  1818     END-IF
  1819
  1820     IF (CP-COMPANY-ID = 'CID') AND
  1821        (CP-EARN-AS-NET-PAY) AND
  1822        (CP-STATE-STD-ABBRV = 'TX') AND
  1823        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1824        (WS-DISCOUNT-OPTION NOT = ' ')
  1825        COMPUTE WS-WORK-DIS-RATE =
  1826             RT-DISCOUNT-RATE / +100
  1827        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1828        GO TO 1075-BYPASS-REGULAR-RATE
  1829     END-IF
  1830
  1831     IF (CP-COMPANY-ID = 'CID') AND
  1832        (CP-EARN-AS-NET-PAY) AND
  1833        (CP-TRUNCATED-LIFE) AND
  1834        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  1835        (CP-STATE-STD-ABBRV = CP-STATE) AND
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  37
* ELRATE.cbl
  1836        (WS-DISCOUNT-OPTION NOT = ' ')
  1837        COMPUTE WS-WORK-DIS-RATE =
  1838             RT-DISCOUNT-RATE / +100
  1839        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1840        GO TO 1075-BYPASS-REGULAR-RATE
  1841     END-IF
  1842
  1843     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1844        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1845           COMPUTE WS-WORK-DIS-RATE EQUAL
  1846                   WS-WORK-DIS-RATE / +100.
  1847
  1848     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1849        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1850           IF CP-MONTHLY-PAYMENT EQUAL +0
  1851            IF CP-LOAN-APR GREATER THAN +2
  1852              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1853              CP-ORIGINAL-BENEFIT /
  1854               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1855               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1856            ELSE
  1857             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1858               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1859
  1860     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1861        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1862          IF WS-WORK-DIS-RATE GREATER THAN +0
  1863           COMPUTE WK1 ROUNDED EQUAL
  1864           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1865                              (WS-RATE-TERM - +1)) /
  1866                        (WS-WORK-DIS-RATE / +12)
  1867           COMPUTE WK2 ROUNDED EQUAL
  1868           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1869                              (WS-RATE-TERM)) /
  1870                        (WS-WORK-DIS-RATE / +12)
  1871           COMPUTE WK3 EQUAL
  1872                RT-DISCOUNT-OB-RATE *
  1873                (1 + WS-WORK-DIS-RATE / +12)
  1874                MOVE WK3 TO CP-PREMIUM-RATE
  1875                COMPUTE WK5 EQUAL WK3 / +1000
  1876           GO TO 1075-BYPASS-REGULAR-RATE.
  1877*               (RT-DISCOUNT-OB-RATE / +1000) *
  1878*               (1 + WS-WORK-DIS-RATE / +12)
  1879*          GO TO 1075-BYPASS-REGULAR-RATE.
  1880
  1881     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1882        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1883           COMPUTE WK3 EQUAL
  1884           RT-DISCOUNT-OB-RATE *
  1885           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1886           MOVE WK3 TO CP-PREMIUM-RATE
  1887           COMPUTE WK5 EQUAL WK3 / +1000
  1888           GO TO 1075-BYPASS-REGULAR-RATE.
  1889
  1890     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1891        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1892        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1893        GO TO 1075-BYPASS-REGULAR-RATE.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  38
* ELRATE.cbl
  1894
  1895     COMPUTE WS-SIN-PREM-RATE =
  1896             (RT-DISCOUNT-OB-RATE / +1000) *
  1897             ((WS-RATE-TERM + +1) / +2).
  1898
  1899     COMPUTE CP-PREMIUM-RATE =
  1900             WS-SIN-PREM-RATE /
  1901             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1902             WS-RATE-TERM) / +24)).
  1903
  1904     IF CP-PREMIUM-RATE NOT = +0
  1905        MULTIPLY +100 BY CP-PREMIUM-RATE
  1906        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1907        GO TO 1075-BYPASS-REGULAR-RATE.
  1908
  1909 1050-REGULAR-RATES.
  1910
  1911     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1912        COMPUTE WK5 EQUAL
  1913        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1914        (6 * (WS-RATE-TERM + 1))
  1915        MOVE WK5 TO CP-PREMIUM-RATE
  1916        GO TO 1075-BYPASS-REGULAR-RATE.
  1917
  1918     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1919        (CP-CSL-VALID-NP-BENEFIT-CD)
  1920        IF CP-JOINT-INDICATOR EQUAL 'J'
  1921           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
  1922           GO TO 1075-BYPASS-REGULAR-RATE
  1923        ELSE
  1924           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1925           GO TO 1075-BYPASS-REGULAR-RATE.
  1926
  1927     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1928        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  1929        (CP-EARN-AS-NET-PAY )
  1930        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1931        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1932        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1933        MOVE '1'                 TO DC-OPTION-CODE
  1934        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  1935        IF DATE-CONVERSION-ERROR
  1936            MOVE '2'                TO CP-RETURN-CODE
  1937            GO TO 9999-CALC-RATE-PREM-X
  1938        ELSE
  1939            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1940                                         DC-ODD-DAYS-OVER
  1941            GO TO 1075-BYPASS-REGULAR-RATE.
  1942
  1943     IF RT-COMPOSITE-RATE NOT NUMERIC
  1944         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
  1945
  1946*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1947     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1948         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1949                                              WS-PREMIUM-RATE
  1950         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
  1951     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  39
* ELRATE.cbl
  1952         MOVE +0                           TO CP-PREMIUM-RATE
  1953                                              CP-COMPOSITE-RATE
  1954                                              CP-CALC-PREMIUM
  1955         GO TO 9999-CALC-RATE-PREM-X.
  1956     IF (CP-COMPANY-ID EQUAL 'CID')
  1957        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1958        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1959        AND (CP-EARN-AS-NET-PAY)
  1960        GO TO 1075-BYPASS-REGULAR-RATE
  1961     END-IF
  1962******************************************************
  1963*    IF CP-COMPANY-ID NOT = 'LBL'
  1964     IF (CP-COMPANY-ID NOT = 'LBL' AND 'CID')
  1965                   or
  1966        ((cp-company-id = 'CID')
  1967        and (cp-earn-as-reg-balloon)
  1968        and (cp-ben-category = 'P' or 'I'))
  1969         GO TO 1075-BYPASS-REGULAR-RATE.
  1970
  1971     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1972     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1973     MOVE '1'                    TO DC-OPTION-CODE.
  1974     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1975     IF DATE-CONVERSION-ERROR
  1976         MOVE '2'                TO CP-RETURN-CODE
  1977         GO TO 9999-CALC-RATE-PREM-X
  1978       ELSE
  1979         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1980         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1981
  1982     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1983        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
  1984        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
  1985
  1986     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1987        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1988           NEXT SENTENCE
  1989         ELSE
  1990           GO TO 1075-BYPASS-REGULAR-RATE
  1991       ELSE
  1992        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  1993           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1994           NEXT SENTENCE
  1995         ELSE
  1996           GO TO 1075-BYPASS-REGULAR-RATE.
  1997
  1998     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
  1999        COMPUTE CP-PREMIUM-RATE =
  2000        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  2001         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  2002         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2003
  2004     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  2005        COMPUTE CP-PREMIUM-RATE =
  2006        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2007        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  2008        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2009        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  40
* ELRATE.cbl
  2010         * (CP-ORIGINAL-TERM - 1)).
  2011******************************************************
  2012
  2013 1075-BYPASS-REGULAR-RATE.
  2014
  2015     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  2016
  2017     MOVE +1 TO LINDX.
  2018
  2019     IF CP-COMPANY-ID EQUAL 'CRI'
  2020        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2021           MOVE +5               TO LINDX
  2022           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  2023              MOVE 'F'           TO CP-RETURN-CODE
  2024              GO TO 1200-CALCULATE-PREMIUMS.
  2025
  2026     IF RT-L-EX-AGE (LINDX) = ZERO
  2027          GO TO 1200-CALCULATE-PREMIUMS.
  2028
  2029 1100-SEARCH-LIFE-LIMITS.
  2030
  2031     IF CP-COMPANY-ID EQUAL 'CRI'
  2032        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2033           IF LINDX GREATER THAN +4
  2034              MOVE 'A'           TO CP-RETURN-CODE
  2035              GO TO 1200-CALCULATE-PREMIUMS.
  2036
  2037     IF LINDX GREATER +8
  2038         MOVE 'A'                TO CP-RETURN-CODE
  2039         GO TO 1200-CALCULATE-PREMIUMS.
  2040
  2041     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
  2042         IF RT-L-EX-AGE (LINDX) = ZEROS
  2043             ADD +1              TO LINDX
  2044             GO TO 1100-SEARCH-LIFE-LIMITS
  2045         ELSE
  2046             MOVE RT-L-EX-AGE (LINDX)
  2047                                 TO CP-R-MAX-AGE
  2048             MOVE RT-L-EX-TERM (LINDX)
  2049                                 TO CP-R-MAX-TERM
  2050             MOVE RT-L-EX-FACE (LINDX)
  2051                                 TO CP-R-MAX-TOT-BEN
  2052             ADD +1              TO LINDX
  2053             GO TO 1100-SEARCH-LIFE-LIMITS
  2054     ELSE
  2055         MOVE RT-L-EX-AGE (LINDX)
  2056                                 TO CP-R-MAX-AGE
  2057         MOVE RT-L-EX-TERM (LINDX)
  2058                                 TO CP-R-MAX-TERM
  2059         MOVE RT-L-EX-FACE (LINDX)
  2060                                 TO CP-R-MAX-TOT-BEN.
  2061
  2062     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  2063         MOVE '9'                TO CP-RETURN-CODE.
  2064
  2065     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  2066         MOVE '8'                TO CP-RETURN-CODE.
  2067
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  41
* ELRATE.cbl
  2068 1200-CALCULATE-PREMIUMS.
  2069
  2070     IF CP-COMPANY-ID = 'CSL'
  2071        IF CP-CSL-VALID-NP-BENEFIT-CD
  2072           GO TO 1240-NET-PAY-CONT
  2073        ELSE
  2074           GO TO 1250-CSL-CALC.
  2075
  2076     IF CP-COMPANY-ID = 'WDS'
  2077        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
  2078           IF CP-EARN-AS-REG-BALLOON
  2079              GO TO 1240-NET-PAY-CONT.
  2080
  2081     IF (CP-COMPANY-ID = 'CID')
  2082        AND (CP-STATE-STD-ABBRV = 'MN')
  2083        AND (CP-EARN-AS-REG-BALLOON OR CP-EARN-AS-FARM-PLAN)
  2084        AND (CP-CERT-EFF-DT > X'A4FF')
  2085        GO TO 1240-NET-PAY-CONT
  2086     END-IF
  2087     IF (CP-COMPANY-ID = 'CID')
  2088        AND (CP-STATE-STD-ABBRV = 'WA' or 'AL')
  2089        AND (CP-FARM-PLAN)
  2090        GO TO 1240-NET-PAY-CONT
  2091     END-IF
  2092     if (cp-company-id = 'CID')
  2093        and (cp-earn-as-reg-balloon)
  2094        and (cp-ben-category = 'P' or 'I')
  2095        display ' found balloon p or i ' rt-discount-ob-rate
  2096        evaluate true
  2097           when (cp-net-only-state = 'Y')
  2098              and (rt-discount-ob-rate > zeros)
  2099              compute cp-premium-rate = rt-discount-ob-rate / 10
  2100           when (cp-net-only-state = 'Y')
  2101              and (rt-discount-ob-rate = zeros)
  2102              display ' not ob rate     ' cp-premium-rate
  2103              compute cp-premium-rate =
  2104                 cp-premium-rate / cp-original-term * 12
  2105              display ' new rate ' cp-premium-rate
  2106              display ' net only state ' cp-premium-rate
  2107              compute cp-premium-rate rounded =
  2108                (cp-premium-rate *
  2109                   (cp-original-term + 1) / 12) /
  2110                ((cp-original-term + 2) / 2)
  2111              display ' new OB rate ' cp-premium-rate
  2112           when (cp-net-only-state <> 'Y')
  2113              and (rt-discount-ob-rate = zeros)
  2114              display ' not net only st ' cp-premium-rate
  2115              compute cp-premium-rate =
  2116                 cp-premium-rate / cp-original-term * 12
  2117              display ' new rate ' cp-premium-rate
  2118        end-evaluate
  2119        go to 1240-net-pay-cont
  2120     end-if
  2121     IF (CP-COMPANY-ID = 'CID')
  2122        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2123           OR 'IN' OR 'AZ')
  2124        AND (CP-FARM-PLAN)
  2125***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  42
* ELRATE.cbl
  2126***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
  2127        MOVE +1.0                TO CP-LOAN-APR
  2128        GO TO 1240-NET-PAY-CONT
  2129     END-IF
  2130     IF CP-RATE-AS-STANDARD
  2131         GO TO 1210-REGULAR-RATE.
  2132
  2133     IF CP-CRITICAL-PERIOD
  2134         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
  2135
  2136     IF CP-EARN-AS-TEXAS
  2137         GO TO 1230-TEXAS-CONT.
  2138
  2139     IF CP-EARN-AS-NET-PAY
  2140        IF CP-STATE-STD-ABBRV = 'MD'
  2141          IF CP-COMPANY-ID = 'MON'
  2142            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
  2143                               '14' OR '26' OR '47'
  2144              GO TO 1210-REGULAR-RATE.
  2145
  2146     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2147        IF CP-MONTHLY-PAYMENT EQUAL +0
  2148           COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2149                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2150
  2151     IF CP-COMPANY-ID EQUAL 'GTL'
  2152        NEXT SENTENCE
  2153     ELSE
  2154     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2155        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2156           COMPUTE WK3 ROUNDED EQUAL
  2157           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2158           CP-MONTHLY-PAYMENT
  2159           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2160           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2161           CP-ALTERNATE-BENEFIT)
  2162           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2163           WK3 * WK5
  2164           GO TO 9999-CALC-RATE-PREM-X
  2165        ELSE
  2166           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2167           (CP-ORIGINAL-TERM - 1 - WK1)) /
  2168           (WS-WORK-DIS-RATE / +12)
  2169           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2170           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2171                               WK5
  2172           GO TO 9999-CALC-RATE-PREM-X.
  2173
  2174     IF CP-COMPANY-ID EQUAL 'GTL' AND
  2175        CP-STATE-STD-ABBRV EQUAL 'RI' AND
  2176        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  2177        CP-ORIGINAL-TERM LESS THAN +61
  2178        COMPUTE CP-CALC-PREMIUM EQUAL
  2179                        (CP-ORIGINAL-BENEFIT *
  2180           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  2181           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  2182        COMPUTE CP-CALC-PREMIUM EQUAL
  2183                CP-CALC-PREMIUM +
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  43
* ELRATE.cbl
  2184              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
  2185        (CP-ORIGINAL-TERM + 1)) /
  2186        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
  2187        GO TO 9999-CALC-RATE-PREM-X.
  2188
  2189     IF CP-COMPANY-ID = 'GTL'     AND
  2190        CP-STATE-STD-ABBRV = 'PA' AND
  2191        CP-SPECIAL-CALC-CD = 'H'
  2192         GO TO 1260-GTL-PA-LEASE.
  2193
  2194     IF (CP-EARN-AS-NET-PAY)
  2195*       AND (CP-LOAN-APR > ZEROS)
  2196        GO TO 1240-NET-PAY-CONT
  2197     END-IF
  2198
  2199     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  2200         GO TO 1210-REGULAR-RATE.
  2201
  2202**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  2203**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  2204****
  2205     IF CP-DEVIATION-CODE = 'LEV' AND
  2206        CP-LOAN-APR = ZEROS
  2207         GO TO 1210-REGULAR-RATE.
  2208
  2209     IF (CP-STATE-STD-ABBRV = 'OH')
  2210        AND (CP-CLASS-CODE NOT = 'L ')
  2211        AND (CP-ORIGINAL-TERM > 60)
  2212        AND (DC-GREG-DATE-CYMD > 19831031)
  2213        AND (CP-LOAN-APR > ZEROS)
  2214        GO TO 1240-NET-PAY-CONT
  2215     END-IF
  2216
  2217     IF (CP-STATE-STD-ABBRV = 'UT')
  2218        AND (CP-ORIGINAL-TERM > 62)
  2219        AND (DC-GREG-DATE-CYMD > 19810831)
  2220        AND (DC-GREG-DATE-CYMD < 19830901)
  2221        AND (CP-LOAN-APR > ZEROS)
  2222        GO TO 1240-NET-PAY-CONT
  2223     END-IF
  2224
  2225     IF (CP-STATE-STD-ABBRV = 'RI')
  2226        AND (CP-ORIGINAL-TERM > 60)
  2227        AND (DC-GREG-DATE-CYMD > 19831231)
  2228        AND (CP-LOAN-APR > ZEROS)
  2229        GO TO 1240-NET-PAY-CONT
  2230     END-IF
  2231     .
  2232 1210-REGULAR-RATE.
  2233
  2234     IF (CP-COMPANY-ID = 'CID')
  2235        AND (CP-EARN-AS-NET-PAY)
  2236        AND (CP-LOAN-APR = 0)
  2237        IF RT-L-RATE (WS-RATE-TERM) = 0
  2238           COMPUTE WS-SIN-PREM-RATE =
  2239              (RT-DISCOUNT-OB-RATE / +1000) *
  2240              ((WS-RATE-TERM + +1) / +2)
  2241           COMPUTE CP-PREMIUM-RATE =
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  44
* ELRATE.cbl
  2242              WS-SIN-PREM-RATE /
  2243              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2244              WS-RATE-TERM) / +24))
  2245        ELSE
  2246           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2247        END-IF
  2248     END-IF
  2249*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2250*       IF CP-MONTHLY-PAYMENT EQUAL +0
  2251*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2252*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2253*
  2254*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2255*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2256*          COMPUTE WK3 ROUNDED EQUAL
  2257*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2258*          CP-MONTHLY-PAYMENT
  2259*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2260*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2261*          CP-ALTERNATE-BENEFIT)
  2262*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2263*          WK3 * WK5
  2264*          GO TO 9999-CALC-RATE-PREM-X
  2265*       ELSE
  2266*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2267*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2268*          (WS-WORK-DIS-RATE / +12)
  2269*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2270*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2271*                              WK5
  2272*          GO TO 9999-CALC-RATE-PREM-X.
  2273
  2274     IF CP-TERM-IS-DAYS
  2275         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2276             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2277         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2278             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2279                          * CP-TERM-OR-EXT-DAYS
  2280           GO TO 9999-CALC-RATE-PREM-X.
  2281
  2282     if (cp-company-id = 'AHL')
  2283        and (cp-loan-term > cp-original-term)
  2284        continue
  2285     else
  2286        IF NOT CP-TRUNCATED-LIFE
  2287           GO TO 1212-GROSS-NOT-TRUNCATED
  2288        end-if
  2289     end-if
  2290
  2291****  GROSS TRUNCATED CALCULATION
  2292
  2293     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2294         MOVE 'H'                TO  CP-RETURN-CODE
  2295         GO TO 9999-CALC-RATE-PREM-X.
  2296     if cp-company-id = 'AHL'
  2297        if (cp-state = 'AZ' OR 'GA' OR 'IN' OR 'MT' OR 'NH'
  2298           OR 'NJ' OR 'OH' OR 'PA' OR 'TX' OR 'VA')
  2299           compute cp-calc-premium rounded = (1 - (cp-loan-term -
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  45
* ELRATE.cbl
  2300           cp-original-term) * (cp-loan-term - cp-original-term
  2301            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2302            cp-premium-rate / 100 * cp-original-term /
  2303            cp-loan-term * cp-original-benefit
  2304        else
  2305           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2306           cp-original-term) * (cp-loan-term - cp-original-term
  2307            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2308            cp-premium-rate * cp-original-benefit / 100
  2309        end-if
  2310        go to 9999-calc-rate-prem-x
  2311     end-if
  2312
  2313     IF CP-COMPANY-ID = 'NCL'
  2314         COMPUTE WK-MONTHLY-RATE =
  2315               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
  2316                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2317                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2318                                 /
  2319                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
  2320                                 *
  2321                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2322         COMPUTE CP-CALC-PREMIUM =
  2323                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2324     ELSE
  2325         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2326                                 CP-ORIGINAL-TERM
  2327         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2328                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2329                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2330                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2331     END-IF
  2332     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2333        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2334           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2335           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2336     END-IF
  2337     GO TO 9999-CALC-RATE-PREM-X
  2338     .
  2339 1212-GROSS-NOT-TRUNCATED.
  2340*    display ' premium rate ' cp-premium-rate
  2341
  2342     IF (CP-COMPANY-ID = 'CID')
  2343        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2344           OR 'IN')
  2345        AND (CP-BENEFIT-CD = '55' OR '56')
  2346        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2347          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2348          (CP-ORIGINAL-TERM) *
  2349          ((CP-ORIGINAL-TERM) / 12) *
  2350          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2351          GO TO 9999-CALC-RATE-PREM-X
  2352     END-IF
  2353     IF (CP-COMPANY-ID = 'CID')
  2354        AND (CP-STATE-STD-ABBRV = 'GA')
  2355        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2356        COMPUTE WK3 ROUNDED =
  2357          CP-ORIGINAL-BENEFIT *
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  46
* ELRATE.cbl
  2358          ((CP-ORIGINAL-TERM + 1) / 2) *
  2359          (RT-DISCOUNT-OB-RATE / 1000)
  2360          MOVE WK3 TO CP-CALC-PREMIUM
  2361          GO TO 9999-CALC-RATE-PREM-X
  2362     END-IF
  2363     IF (CP-COMPANY-ID EQUAL 'CID')
  2364        AND (CP-STATE-STD-ABBRV = 'MN')
  2365        AND (CP-LEVEL-LIFE)
  2366        AND (CP-CERT-EFF-DT > X'A4FF')
  2367        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2368        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2369        MOVE '1'                 TO DC-OPTION-CODE
  2370        PERFORM 9100-CONVERT-DATE
  2371                                 THRU 9100-EXIT
  2372        IF DATE-CONVERSION-ERROR
  2373           MOVE '2'              TO CP-RETURN-CODE
  2374           MOVE ZEROS            TO FACTOR
  2375                                 CP-CALC-PREMIUM
  2376           GO TO 9999-CALC-RATE-PREM-X
  2377        END-IF
  2378        MOVE DC-ELAPSED-DAYS     TO D
  2379        COMPUTE CP-MONTHLY-PAYMENT = CP-ORIGINAL-BENEFIT /
  2380           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2381           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2382        COMPUTE CP-CALC-PREMIUM = CP-MONTHLY-PAYMENT *
  2383           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2384        GO TO 9999-CALC-RATE-PREM-X
  2385     END-IF
  2386     IF (CP-COMPANY-ID = 'CID')
  2387        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2388        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2389           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2390     ELSE
  2391        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2392                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2393     END-IF
  2394*    display ' calc premium ' cp-calc-premium
  2395
  2396*    IF CP-COMPANY-ID = 'LBL'
  2397     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2398        AND (NOT CP-EARN-AS-NET-PAY)
  2399        GO TO 9999-CALC-RATE-PREM-X
  2400     END-IF
  2401
  2402     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2403         GO TO 9999-CALC-RATE-PREM-X.
  2404
  2405     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2406         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2407            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2408               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2409
  2410     GO TO 9999-CALC-RATE-PREM-X.
  2411
  2412 1220-CRITICAL-PERIOD-LF-CONT.
  2413     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2414               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2415
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  47
* ELRATE.cbl
  2416     GO TO 9999-CALC-RATE-PREM-X.
  2417
  2418 1230-TEXAS-CONT.
  2419     IF CP-FARM-PLAN
  2420         GO TO 1235-TEXAS-FARM-CONT.
  2421
  2422     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2423               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2424
  2425     COMPUTE TEX-FACT-9 =
  2426                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2427                 (CP-ORIGINAL-TERM + 1).
  2428
  2429     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2430                 CP-CALC-PREMIUM * TEX-FACT-9.
  2431
  2432     GO TO 9999-CALC-RATE-PREM-X.
  2433
  2434 1235-TEXAS-FARM-CONT.
  2435     COMPUTE WS-FARM-TERM =
  2436               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2437
  2438     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2439     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2440
  2441
  2442     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2443              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2444
  2445     GO TO 9999-CALC-RATE-PREM-X.
  2446
  2447 1240-NET-PAY-CONT.
  2448
  2449     MOVE CP-LOAN-APR             TO N-P-APR.
  2450     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2451                                     N-P-REM
  2452                                     N-P-LOAN.
  2453
  2454     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2455
  2456     IF CP-TRUNCATED-LIFE
  2457         MOVE CP-LOAN-TERM        TO N-P-LOAN.
  2458
  2459     IF CP-COMPANY-ID EQUAL 'NCL'
  2460        NEXT SENTENCE
  2461     ELSE
  2462        GO TO 1241-NET-PAY-CONT.
  2463
  2464     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  2465     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
  2466     MOVE '1'                    TO DC-OPTION-CODE
  2467     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2468     IF DATE-CONVERSION-ERROR
  2469         MOVE '2'                TO CP-RETURN-CODE
  2470         GO TO 9999-CALC-RATE-PREM-X
  2471     ELSE
  2472        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2473        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  48
* ELRATE.cbl
  2474
  2475     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2476        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
  2477        NEXT SENTENCE
  2478     ELSE
  2479        MOVE +1                  TO ODF
  2480        GO TO 1241-NET-PAY-CONT.
  2481
  2482     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2483        COMPUTE CP-PREMIUM-RATE EQUAL
  2484        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2485        CP-PREMIUM-RATE) *
  2486        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2487
  2488     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2489        COMPUTE CP-PREMIUM-RATE EQUAL
  2490        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2491        N-P-LOAN * (N-P-LOAN - 1))) *
  2492        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2493        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2494
  2495     COMPUTE ODF EQUAL
  2496     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2497     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2498
  2499 1241-NET-PAY-CONT.
  2500
  2501     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2502
  2503*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2504     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2505        NEXT SENTENCE
  2506     ELSE
  2507        GO TO 9999-CALC-RATE-PREM-X.
  2508
  2509     IF RT-DISCOUNT-OPTION EQUAL '6'
  2510         GO TO 9999-CALC-RATE-PREM-X.
  2511
  2512     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2513        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2514        GO TO 9999-CALC-RATE-PREM-X.
  2515
  2516     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2517
  2518     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2519        GO TO 9999-CALC-RATE-PREM-X.
  2520
  2521     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2522        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2523        (CP-TRUNCATED-LIFE)
  2524        GO TO 9999-CALC-RATE-PREM-X.
  2525
  2526     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2527        (CP-CSL-VALID-NP-BENEFIT-CD)
  2528        GO TO 9999-CALC-RATE-PREM-X.
  2529
  2530     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2531        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  49
* ELRATE.cbl
  2532        (CP-EARN-AS-NET-PAY)
  2533        GO TO 9999-CALC-RATE-PREM-X.
  2534
  2535*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2536*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
  2537*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  2538*       GO TO 9999-CALC-RATE-PREM-X.
  2539
  2540     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2541        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2542        (CP-EARN-AS-NET-PAY)
  2543        GO TO 9999-CALC-RATE-PREM-X.
  2544
  2545     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2546        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2547        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2548        GO TO 9999-CALC-RATE-PREM-X.
  2549
  2550     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2551        (CP-EARN-AS-NET-PAY)
  2552        GO TO 9999-CALC-RATE-PREM-X.
  2553
  2554     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2555        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2556        (CP-TRUNCATED-LIFE)
  2557        GO TO 9999-CALC-RATE-PREM-X.
  2558
  2559     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2560        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2561        (CP-EARN-AS-NET-PAY)
  2562*       (CP-TRUNCATED-LIFE)
  2563        GO TO 9999-CALC-RATE-PREM-X.
  2564
  2565     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2566        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2567                   AND
  2568        ((CP-EARN-AS-NET-PAY)
  2569               OR
  2570        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2571        GO TO 9999-CALC-RATE-PREM-X.
  2572
  2573     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2574        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2575        (CP-EARN-AS-NET-PAY) AND
  2576        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2577        GO TO 9999-CALC-RATE-PREM-X.
  2578
  2579     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2580        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  2581        (CP-EARN-AS-NET-PAY)
  2582        GO TO 9999-CALC-RATE-PREM-X.
  2583
  2584     IF CP-COMPANY-ID = 'CID' or 'AHL'
  2585        CONTINUE
  2586     ELSE
  2587        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2588           (CP-EARN-AS-NET-PAY) AND
  2589           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  50
* ELRATE.cbl
  2590           GO TO 9999-CALC-RATE-PREM-X
  2591        END-IF
  2592     END-IF
  2593
  2594     IF (CP-COMPANY-ID = 'CID')
  2595        AND (CP-EARN-AS-NET-PAY)
  2596        AND (CP-STATE-STD-ABBRV = 'ME')
  2597        GO TO 9999-CALC-RATE-PREM-X
  2598     END-IF
  2599     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2600        AND (CP-BEN-CATEGORY = 'D')
  2601        AND (CP-EARN-AS-NET-PAY)
  2602        GO TO 9999-CALC-RATE-PREM-X
  2603     END-IF
  2604     IF (CP-COMPANY-ID = 'CID')
  2605        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2606           OR 'IN' OR 'AZ')
  2607        AND (CP-FARM-PLAN)
  2608        GO TO 9999-CALC-RATE-PREM-X
  2609     END-IF
  2610     IF (CP-COMPANY-ID = 'CID') AND
  2611        (CP-EARN-AS-NET-PAY) AND
  2612        (CP-LEVEL-LIFE) AND
  2613        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2614        (CP-STATE-STD-ABBRV = CP-STATE)
  2615        GO TO 9999-CALC-RATE-PREM-X
  2616     END-IF
  2617
  2618     IF (CP-COMPANY-ID = 'CID') AND
  2619        (CP-EARN-AS-NET-PAY) AND
  2620        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2621                            OR 'VT')
  2622                   OR
  2623        ((CP-STATE-STD-ABBRV = 'IN') AND
  2624        (CP-CERT-EFF-DT > X'9A7F'))
  2625                   OR
  2626        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2627        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2628        (CP-STATE-STD-ABBRV = CP-STATE)
  2629        GO TO 9999-CALC-RATE-PREM-X
  2630     END-IF
  2631
  2632     IF (CP-COMPANY-ID = 'CID') AND
  2633        (CP-EARN-AS-NET-PAY) AND
  2634        (CP-STATE-STD-ABBRV = 'TX') AND
  2635        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2636        (WS-DISCOUNT-OPTION NOT = ' ')
  2637        GO TO 9999-CALC-RATE-PREM-X
  2638     END-IF
  2639
  2640     if (cp-company-id = 'CID')
  2641        and (cp-state-std-abbrv = 'WA' or 'AL')
  2642        and (rt-discount-option = '1')
  2643        and (cp-earn-as-farm-plan)
  2644        go to 9999-calc-rate-prem-x
  2645     end-if
  2646     if (cp-company-id = 'CID')
  2647        and (cp-earn-as-reg-balloon)
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  51
* ELRATE.cbl
  2648        and (cp-ben-category = 'P' or 'I')
  2649        GO TO 9999-CALC-RATE-PREM-X
  2650     end-if
  2651     IF (CP-COMPANY-ID = 'CID')
  2652        AND (CP-STATE-STD-ABBRV = 'MN')
  2653        AND (RT-DISCOUNT-OPTION = '1')
  2654        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON OR
  2655           CP-EARN-AS-FARM-PLAN)
  2656        GO TO 9999-CALC-RATE-PREM-X
  2657     END-IF
  2658     IF (CP-COMPANY-ID = 'CID')
  2659        AND (CP-EARN-AS-NET-PAY)
  2660        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2661                      OR
  2662            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2663        GO TO 9999-CALC-RATE-PREM-X
  2664     END-IF
  2665     IF (CP-COMPANY-ID = 'CID')
  2666        AND (CP-EARN-AS-NET-PAY)
  2667        AND (CP-STATE-STD-ABBRV = 'SC')
  2668        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2669        GO TO 9999-CALC-RATE-PREM-X
  2670     END-IF
  2671     IF (CP-COMPANY-ID = 'CID') AND
  2672        (CP-EARN-AS-NET-PAY) AND
  2673        (CP-TRUNCATED-LIFE) AND
  2674        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2675        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2676        (WS-DISCOUNT-OPTION NOT = ' ')
  2677        GO TO 9999-CALC-RATE-PREM-X
  2678     END-IF
  2679
  2680     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP') AND
  2681        (CP-EARN-AS-NET-PAY)
  2682        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2683        GO TO 9999-CALC-RATE-PREM-X
  2684     END-IF
  2685
  2686     IF (CP-COMPANY-ID EQUAL 'CID')
  2687        AND (CP-EARN-AS-NET-PAY)
  2688        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2689        GO TO 9999-CALC-RATE-PREM-X
  2690     END-IF
  2691
  2692     IF (RT-IS-OB) AND
  2693        (CP-COMPANY-ID NOT EQUAL 'CID')
  2694        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2695               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2696      ELSE
  2697         IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2698            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2699            COMPUTE CP-CALC-PREMIUM ROUNDED =
  2700*           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2701             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
  2702               CP-ORIGINAL-TERM
  2703             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2704             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2705        ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  52
* ELRATE.cbl
  2706           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2707               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2708        END-IF
  2709     END-IF
  2710
  2711     IF CP-ROA-PREM-AT-REFUND
  2712         COMPUTE NET-BEN ROUNDED =
  2713             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2714     ELSE
  2715         COMPUTE NET-BEN ROUNDED =
  2716              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
  2717
  2718     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2719        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2720          COMPUTE NET-BEN ROUNDED =
  2721              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2722                         (CP-TERM-OR-EXT-DAYS / 30)).
  2723
  2724     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2725*       OR 'DCC'
  2726*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2727     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2728       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2729       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
  2730                        * CP-ORIGINAL-TERM / 1200))
  2731     ELSE
  2732     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2733       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2734       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
  2735
  2736****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2737****** INTEREST IS CHARGED ON PREMIUM.
  2738
  2739*    IF CP-STATE-STD-ABBRV = 'MI'
  2740*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2741*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2742
  2743     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2744
  2745     GO TO 9999-CALC-RATE-PREM-X.
  2746
  2747******
  2748****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2749******
  2750
  2751 1250-CSL-CALC.
  2752     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2753     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2754     MOVE '1' TO DC-OPTION-CODE.
  2755     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2756
  2757     IF DATE-CONVERSION-ERROR
  2758         MOVE '2' TO CP-RETURN-CODE
  2759         GO TO 9999-CALC-RATE-PREM-X.
  2760
  2761     IF CP-JOINT-INDICATOR = 'J'
  2762         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2763     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  53
* ELRATE.cbl
  2764         MOVE RT-L-RATE (1) TO WK-RED-RATE.
  2765
  2766     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
  2767     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2768
  2769     IF CP-PAY-FREQUENCY = 12
  2770         MOVE 01               TO WS-PAY-SCH.
  2771     IF CP-PAY-FREQUENCY = 04
  2772         MOVE 03               TO WS-PAY-SCH.
  2773     IF CP-PAY-FREQUENCY = 02
  2774         MOVE 06               TO WS-PAY-SCH.
  2775     IF CP-PAY-FREQUENCY = 01
  2776         MOVE 12               TO WS-PAY-SCH.
  2777
  2778     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2779     IF CP-PAY-FREQUENCY NOT = 12
  2780         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
  2781                                WS-NUM-PAYMTS.
  2782
  2783     IF CP-STATE = 'SC'  AND
  2784       (CP-BENEFIT-CD = '07'  OR  '08')
  2785         GO TO 1250-CSL-CALC-LIFE-6.
  2786
  2787     IF CP-CSL-METH-1
  2788         GO TO 1250-CSL-CALC-LIFE-1.
  2789
  2790     IF CP-CSL-METH-2
  2791         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2792                          WS-MAX-TOT-BEN
  2793             GO TO 1250-CSL-CALC-LIFE-2
  2794         ELSE
  2795             GO TO 1250-CSL-CALC-LIFE-1.
  2796
  2797     IF CP-CSL-METH-3
  2798         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2799             GO TO 1250-CSL-CALC-LIFE-2
  2800         ELSE
  2801             GO TO 1250-CSL-CALC-LIFE-3.
  2802
  2803     IF CP-CSL-METH-4
  2804         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2805                          WS-MAX-TOT-BEN
  2806             GO TO 1250-CSL-CALC-LIFE-5
  2807         ELSE
  2808             GO TO 1250-CSL-CALC-LIFE-4.
  2809
  2810 1250-CSL-CALC-LIFE-1.
  2811     IF CP-JOINT-INDICATOR = 'J'
  2812         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2813     ELSE
  2814         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2815
  2816     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
  2817                    365) - 1) * 365 / 12.
  2818     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2819                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2820                    4380.
  2821     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  54
* ELRATE.cbl
  2822                    WS-NUM-PAYMTS * WK-S.
  2823
  2824     GO TO 9999-CALC-RATE-PREM-X.
  2825
  2826 1250-CSL-CALC-LIFE-2.
  2827     IF CP-JOINT-INDICATOR = 'J'
  2828         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2829     ELSE
  2830         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2831
  2832     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2833     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2834     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2835                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2836                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2837     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2838                    WK-S) + WK-D.
  2839
  2840     GO TO 9999-CALC-RATE-PREM-X.
  2841
  2842 1250-CSL-CALC-LIFE-3.
  2843     IF CP-JOINT-INDICATOR = 'J'
  2844         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2845     ELSE
  2846         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2847
  2848     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2849     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2850     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2851                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2852                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2853     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2854                    WK-S) + WK-D.
  2855
  2856     GO TO 9999-CALC-RATE-PREM-X.
  2857
  2858 1250-CSL-CALC-LIFE-4.
  2859     IF CP-JOINT-INDICATOR = 'J'
  2860         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2861     ELSE
  2862         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2863
  2864     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2865     COMPUTE WK-S ROUNDED =
  2866                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2867                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2868                    CP-PAY-FREQUENCY.
  2869     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2870                    WS-NUM-PAYMTS * WK-S.
  2871
  2872     GO TO 9999-CALC-RATE-PREM-X.
  2873
  2874 1250-CSL-CALC-LIFE-5.
  2875     IF CP-JOINT-INDICATOR = 'J'
  2876         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2877     ELSE
  2878         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2879
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  55
* ELRATE.cbl
  2880     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2881     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2882                    CP-PAY-FREQUENCY.
  2883     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2884                    - 1) + WS-NUM-PAYMTS) * 12) /
  2885                    CP-PAY-FREQUENCY.
  2886     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2887     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2888                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2889
  2890     GO TO 9999-CALC-RATE-PREM-X.
  2891
  2892 1250-CSL-CALC-LIFE-6.
  2893
  2894     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2895                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2896
  2897     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2898                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2899
  2900     GO TO 9999-CALC-RATE-PREM-X.
  2901
  2902******
  2903****** END OF PREMIUM CALCULATIONS FOR CSL
  2904******
  2905
  2906 1260-GTL-PA-LEASE.
  2907
  2908     IF CP-REDUCING-LIFE
  2909         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2910                                 TO  CP-PREMIUM-RATE
  2911         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2912                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2913     ELSE
  2914         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2915                                 TO  CP-PREMIUM-RATE
  2916         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2917                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2918                 (+1 + CP-SALES-TAX) / +100.
  2919
  2920     GO TO 9999-CALC-RATE-PREM-X.
  2921
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  56
* ELRATE.cbl
  2923******************************************************************
  2924 2000-TYPE-IS-AH.
  2925     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2926
  2927     MOVE ZERO                      TO CP-R-MAX-AGE
  2928                                       CP-R-MAX-TERM
  2929                                       CP-R-MAX-MON-BEN
  2930                                       CP-R-MAX-TOT-BEN.
  2931
  2932     IF RT-CANCEL-FEE NUMERIC
  2933        MOVE RT-CANCEL-FEE          TO CP-CANCEL-FEE.
  2934
  2935     IF RT-COMPOSITE-RATE NOT NUMERIC
  2936        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2937
  2938     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2939        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2940                                 TO CP-PREMIUM-RATE
  2941                                    WS-PREMIUM-RATE
  2942        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2943     ELSE
  2944         MOVE +0                 TO CP-PREMIUM-RATE
  2945                                    CP-CALC-PREMIUM
  2946         GO TO 9999-CALC-RATE-PREM-X
  2947     END-IF
  2948
  2949     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2950        AND (CP-DDF-SPEC-CALC = 'T')
  2951        AND (CP-LOAN-TERM > ZERO AND < 361)
  2952        MOVE RT-AH-RATE (CP-LOAN-TERM)
  2953                                 TO CP-PREMIUM-RATE
  2954                                    WS-PREMIUM-RATE
  2955     END-IF
  2956*    IF (CP-COMPANY-ID = 'DCC')
  2957*       AND ((CP-BENEFIT-CD (1:1) = 'P')
  2958*       OR (CP-DDF-SPEC-CALC = 'T'))
  2959*       AND (CP-LOAN-TERM > ZERO AND < 361)
  2960*       MOVE RT-AH-RATE (CP-LOAN-TERM)
  2961*                                TO CP-PREMIUM-RATE
  2962*                                   WS-PREMIUM-RATE
  2963*    END-IF
  2964     MOVE +1 TO AHNDX.
  2965
  2966     IF CP-COMPANY-ID EQUAL 'CRI'
  2967        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2968           MOVE +5               TO AHNDX
  2969           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2970              MOVE 'F'           TO CP-RETURN-CODE
  2971              GO TO 2200-CALCULATE-PREMIUMS.
  2972
  2973     IF RT-AH-AGE (AHNDX) = ZERO
  2974          GO TO 2200-CALCULATE-PREMIUMS.
  2975
  2976 2100-SEARCH-AH-LIMITS.
  2977
  2978     IF CP-COMPANY-ID EQUAL 'CRI'
  2979        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2980           IF AHNDX GREATER THAN +4
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  57
* ELRATE.cbl
  2981              MOVE 'A'             TO CP-RETURN-CODE
  2982              GO TO 2200-CALCULATE-PREMIUMS.
  2983
  2984     IF AHNDX GREATER +8
  2985         MOVE 'A'                TO CP-RETURN-CODE
  2986         GO TO 2200-CALCULATE-PREMIUMS.
  2987
  2988     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
  2989         IF RT-AH-AGE (AHNDX) = ZEROS
  2990             ADD +1               TO AHNDX
  2991             GO TO 2100-SEARCH-AH-LIMITS
  2992         ELSE
  2993             MOVE RT-AH-AGE (AHNDX)
  2994                                 TO CP-R-MAX-AGE
  2995             MOVE RT-AH-TERM (AHNDX)
  2996                                 TO CP-R-MAX-TERM
  2997             MOVE RT-AH-BEN-M (AHNDX)
  2998                                 TO CP-R-MAX-MON-BEN
  2999             ADD +1               TO AHNDX
  3000             GO TO 2100-SEARCH-AH-LIMITS
  3001     ELSE
  3002         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  3003         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  3004         MOVE RT-AH-BEN-M (AHNDX)
  3005                                 TO CP-R-MAX-MON-BEN.
  3006
  3007     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  3008         MOVE '9'                 TO CP-RETURN-CODE.
  3009
  3010     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  3011         MOVE '8'                 TO CP-RETURN-CODE.
  3012
  3013     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  3014         GIVING WS-AH-FACE-BENEFIT.
  3015
  3016     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  3017         MOVE 'C'                 TO CP-RETURN-CODE.
  3018
  3019 2200-CALCULATE-PREMIUMS.
  3020
  3021     IF CP-COMPANY-ID = 'CSL'
  3022         GO TO 2250-CSL-CALC.
  3023
  3024*    IF CP-CRITICAL-PERIOD
  3025*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  3026
  3027     IF CP-CRITICAL-PERIOD
  3028        IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3029           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H'
  3030               OR 'S' OR 'P')
  3031                          OR
  3032                (CP-BEN-CATEGORY = 'G' OR 'L'))
  3033           CONTINUE
  3034        ELSE
  3035           GO TO 2200-CRITICAL-PERIOD-AH-CONT
  3036        END-IF
  3037     END-IF
  3038
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  58
* ELRATE.cbl
  3039     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3040        AND (CP-BEN-CATEGORY = 'D')
  3041        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  3042           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  3043     END-IF
  3044     IF (CP-COMPANY-ID = 'CID')
  3045        AND (CP-STATE-STD-ABBRV = 'AL')
  3046        and (cp-pmt-mode <> spaces and low-values)
  3047        continue
  3048     else
  3049        go to 2200-continue
  3050     end-if
  3051
  3052     evaluate true
  3053        when cp-pmt-mode = 'B' *> Bi-Weekly
  3054           move 26               to c-pmts-per-year
  3055           move 14               to c-days-in-pmt-per
  3056        when cp-pmt-mode = 'W' *> Weekly
  3057           move 52               to c-pmts-per-year
  3058           move 07               to c-days-in-pmt-per
  3059        when cp-pmt-mode = 'S' *> Semi-Monthly
  3060           move 24               to c-pmts-per-year
  3061           move 15               to c-days-in-pmt-per
  3062        when cp-pmt-mode = 'A' *> Annual
  3063           move 1                to c-pmts-per-year
  3064           move 360              to c-days-in-pmt-per
  3065        when cp-pmt-mode = 'T' *> Semi-Annual
  3066           move 2                to c-pmts-per-year
  3067           move 180              to c-days-in-pmt-per
  3068        when cp-pmt-mode = 'Q' *> Quarterly
  3069           move 4                to c-pmts-per-year
  3070           move 90               to c-days-in-pmt-per
  3071        when cp-pmt-mode = 'N' *> Bi-Monthly ??
  3072           move 6                to c-pmts-per-year
  3073           move 60               to c-days-in-pmt-per
  3074        when other             *> Assume Monthly
  3075           move 12               to c-pmts-per-year
  3076           move 30               to c-days-in-pmt-per
  3077     end-evaluate
  3078
  3079     compute c-tot-pmts =
  3080        cp-original-term / 12 * c-pmts-per-year
  3081
  3082     compute wk7 rounded =    *> tv3
  3083        (cp-original-benefit * +12) / c-pmts-per-year
  3084
  3085     compute wk6 rounded =
  3086        (wk7 * c-tot-pmts / 100) * cp-premium-rate
  3087
  3088     move wk6                    to cp-calc-premium
  3089
  3090     GO TO 9999-CALC-RATE-PREM-X
  3091
  3092     .
  3093 2200-continue.
  3094     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  3095        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
  3096        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  59
* ELRATE.cbl
  3097                                     CP-PREMIUM-RATE
  3098        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  3099        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  3100        CP-PREMIUM-RATE) / +100
  3101     ELSE
  3102        IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3103           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  3104           MOVE CP-PREMIUM-RATE  TO WK-S
  3105*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  3106           IF CP-RATE-DEV-PCT NOT = ZEROS
  3107              COMPUTE WK-S ROUNDED =
  3108                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  3109           END-IF
  3110           IF CP-BENEFIT-CD (1:1) = 'M'
  3111              COMPUTE CP-CALC-PREMIUM ROUNDED =
  3112              CP-ORIGINAL-BENEFIT * WK-S / 100
  3113           ELSE
  3114              IF CP-BENEFIT-CD (1:1) = 'H'
  3115                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  3116                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  3117                    WK-S) / 1000
  3118              ELSE
  3119                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  3120                    GO TO 2300-CALC-DCC-MOB-NET-AH
  3121                 ELSE
  3122                    IF CP-BEN-CATEGORY = 'D'
  3123                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  3124                        CP-ORIGINAL-BENEFIT *
  3125                        CP-ORIGINAL-TERM * WK-S / 100
  3126                    ELSE
  3127                      IF CP-BENEFIT-CD (1:1) = 'P'
  3128                         GO TO 2300-CALC-DCC-BEN-P-AH
  3129                      ELSE
  3130                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  3131                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  3132                        WK-S) / 100
  3133                      END-IF
  3134                    END-IF
  3135                 END-IF
  3136              END-IF
  3137           END-IF
  3138           MOVE ZEROS            TO CP-RATE-DEV-PCT
  3139        ELSE
  3140           IF CP-BENEFIT-CD (1:1) = 'M'
  3141              COMPUTE CP-CALC-PREMIUM ROUNDED =
  3142                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
  3143           ELSE
  3144              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  3145                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  3146                    (CP-NET-BENEFIT-AMT *
  3147                    CP-PREMIUM-RATE) / 1000
  3148              ELSE
  3149                 IF CP-AH-BALLOON-SW = 'Y'
  3150                    COMPUTE CP-CALC-PREMIUM ROUNDED =
  3151                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  3152                      CP-PREMIUM-RATE) / 100
  3153                 ELSE
  3154                   COMPUTE CP-CALC-PREMIUM ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  60
* ELRATE.cbl
  3155                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  3156                    CP-PREMIUM-RATE) / 100
  3157                 END-IF
  3158              END-IF
  3159           END-IF
  3160        END-IF
  3161     END-IF
  3162
  3163     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3164        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  3165        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  3166     END-IF
  3167     IF CP-TERM-OR-EXT-DAYS = ZEROS
  3168         GO TO 9999-CALC-RATE-PREM-X.
  3169
  3170     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  3171         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3172             CP-CALC-PREMIUM +
  3173                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  3174                                       * CP-TERM-OR-EXT-DAYS).
  3175
  3176     GO TO 9999-CALC-RATE-PREM-X.
  3177
  3178 2200-CRITICAL-PERIOD-AH-CONT.
  3179
  3180     IF CP-COMPANY-ID = 'WDS'
  3181         IF CP-ORIGINAL-TERM GREATER THAN 60
  3182             MOVE 60              TO CP-LOAN-TERM.
  3183
  3184     IF CP-COMPANY-ID EQUAL 'CVL'
  3185         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3186           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  3187                                       * CP-PREMIUM-RATE
  3188         GO TO 9999-CALC-RATE-PREM-X.
  3189
  3190     COMPUTE CP-CALC-PREMIUM ROUNDED =
  3191           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  3192                                       * CP-PREMIUM-RATE.
  3193
  3194     GO TO 9999-CALC-RATE-PREM-X.
  3195
  3196 2250-CSL-CALC.
  3197
  3198     IF RT-DAILY-RATE NOT NUMERIC OR
  3199        RT-DAILY-RATE = ZEROS
  3200            MOVE ZEROS TO CP-CALC-PREMIUM
  3201            MOVE '7' TO CP-RETURN-CODE
  3202            GO TO 9999-CALC-RATE-PREM-X.
  3203
  3204     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
  3205     COMPUTE WK-MONTHLY-RATE =
  3206          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
  3207
  3208     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3209     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  3210     MOVE '1' TO DC-OPTION-CODE.
  3211     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3212     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  61
* ELRATE.cbl
  3213         MOVE '2' TO CP-RETURN-CODE
  3214         GO TO 9999-CALC-RATE-PREM-X.
  3215
  3216     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  3217     IF CP-CSL-METH-1
  3218         GO TO 2250-CSL-CALC-AH-1.
  3219     IF CP-CSL-METH-2
  3220         GO TO 2250-CSL-CALC-AH-2.
  3221     IF CP-CSL-METH-3
  3222         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  3223             GO TO 2250-CSL-CALC-AH-4
  3224         ELSE
  3225             GO TO 2250-CSL-CALC-AH-3.
  3226
  3227 2250-CSL-CALC-AH-1.
  3228
  3229     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3230     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3231                    + WK-MONTHLY-RATE.
  3232     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  3233                    CP-ORIGINAL-TERM * WK-D.
  3234
  3235     GO TO 9999-CALC-RATE-PREM-X.
  3236
  3237
  3238 2250-CSL-CALC-AH-2.
  3239     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3240     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3241                    + WK-MONTHLY-RATE.
  3242     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  3243                    CP-ORIGINAL-TERM * WK-D.
  3244
  3245     GO TO 9999-CALC-RATE-PREM-X.
  3246
  3247 2250-CSL-CALC-AH-3.
  3248
  3249     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3250     COMPUTE WK-T = WK-K + 1.
  3251     COMPUTE WK-MONTHLY-RATE-T =
  3252          RT-AH-RATE (WK-T) / 100.
  3253     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3254
  3255     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  3256     IF WK-T1 EQUAL ZEROS
  3257         MOVE ZEROS TO CP-CALC-PREMIUM
  3258         MOVE 'G' TO CP-RETURN-CODE
  3259         GO TO 9999-CALC-RATE-PREM-X.
  3260
  3261     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3262                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
  3263                    - WK-T)).
  3264     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3265     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
  3266                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  3267                       WS-MAX-TOT-BEN).
  3268     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  3269                    WK-MONTHLY-RATE-T) + WK-PREM.
  3270
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  62
* ELRATE.cbl
  3271     GO TO 9999-CALC-RATE-PREM-X.
  3272
  3273 2250-CSL-CALC-AH-4.
  3274     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3275     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3276     COMPUTE WK-MONTHLY-RATE-J =
  3277          RT-AH-RATE (WK-J) / 100.
  3278     COMPUTE WK-T = WK-J + 1.
  3279     COMPUTE WK-MONTHLY-RATE-T =
  3280          RT-AH-RATE (WK-T) / 100.
  3281     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3282     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3283                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3284                    (CP-ORIGINAL-TERM - WK-T)).
  3285     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3286     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3287                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3288                       WS-MAX-TOT-BEN).
  3289     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3290                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3291
  3292     GO TO 9999-CALC-RATE-PREM-X.
  3293
  3294 2300-CALC-DCC-BEN-P-AH.
  3295     IF CP-NO-OF-PMTS NOT NUMERIC
  3296        MOVE +0                  TO CP-NO-OF-PMTS
  3297     END-IF
  3298     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  3299        AND ' ' AND 'M'
  3300        MOVE ' '                 TO CP-PMT-MODE
  3301     END-IF
  3302******************************************************************
  3303***   Default is monthly, use loan term for rate and amort     ***
  3304******************************************************************
  3305     move cp-loan-term         to c-tot-pmts
  3306     MOVE +30                  TO C-DAYS-IN-PMT-PER
  3307     MOVE +12                  TO C-PMTS-PER-YEAR
  3308******************************************************************
  3309
  3310     evaluate true
  3311        when cp-pmt-mode = 'W'
  3312           MOVE +52              TO C-PMTS-PER-YEAR
  3313           compute c-tot-pmts = cp-loan-term /
  3314              12 * c-pmts-per-year
  3315           MOVE +7               TO C-DAYS-IN-PMT-PER
  3316        when cp-pmt-mode = 'B'
  3317           MOVE +26              TO C-PMTS-PER-YEAR
  3318           compute c-tot-pmts = cp-loan-term /
  3319              12 * c-pmts-per-year
  3320           MOVE +14              TO C-DAYS-IN-PMT-PER
  3321     end-evaluate
  3322     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3323     if i = zeros
  3324        move .0000000001         to i
  3325     end-if
  3326     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3327        C-DAYS-IN-PMT-PER)) / (1 + I)
  3328     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  63
* ELRATE.cbl
  3329     COMPUTE ANGLEN-1 = ANGLEN / Y
  3330     COMPUTE WK3 = (CP-NET-BENEFIT-AMT - CP-ORIGINAL-PREMIUM)
  3331        / ANGLEN-1
  3332     if cp-net-benefit-amt = zeros
  3333        compute wk3 = cp-original-benefit - cp-original-premium
  3334     end-if
  3335     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * WK-S
  3336     GO TO 9999-CALC-RATE-PREM-X
  3337     .
  3338 2300-CALC-DCC-MOB-NET-AH.
  3339     IF CP-ALTERNATE-BENEFIT = ZEROS
  3340        CONTINUE
  3341     ELSE
  3342        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3343     END-IF
  3344     MOVE CP-ORIGINAL-TERM       TO M
  3345     MOVE CP-LOAN-TERM           TO N
  3346     IF N = ZEROS
  3347        MOVE M                   TO N
  3348     END-IF
  3349     COMPUTE I = CP-LOAN-APR / +1200
  3350     if i = zeros
  3351        move .0000000001         to i
  3352     end-if
  3353     IF CP-BENEFIT-CD (1:1) = 'S'
  3354        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3355        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3356        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3357          (WK-S / 1000)
  3358          * 1
  3359        MOVE WK3                 TO CP-CALC-PREMIUM
  3360        GO TO 9999-CALC-RATE-PREM-X
  3361     END-IF
  3362     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3363        / (1 + I)
  3364     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3365          ** ((N - M) * -1))) / I)
  3366     COMPUTE ANGLEN-M = ANGLEN-M / OD
  3367     COMPUTE J = I + (WK-S / +1000)
  3368     COMPUTE WK2 = (1 + J) ** (M * -1)
  3369     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3370     COMPUTE ANGLEM = ((1 - ((1 + J)
  3371          ** (M * -1))) / J) / OD
  3372     IF CP-NET-BENEFIT-AMT = ZEROS
  3373        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3374           * ANGLEM
  3375     END-IF
  3376     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3377     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3378          ** ((N - M) * -1))) / I)
  3379     MOVE +0                     TO WK3
  3380     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3381        (WS-COUNTER > M)
  3382        COMPUTE ANGLEM = (1 - ((1 + J)
  3383          ** ((M - WS-COUNTER + 1) * -1))) / J
  3384        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  3385        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3386        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  64
* ELRATE.cbl
  3387     END-PERFORM
  3388     MOVE WK3                    TO CP-CALC-PREMIUM
  3389     GO TO 9999-CALC-RATE-PREM-X
  3390     .
  3391 2300-CALC-DCC-MOB-BAL-AH.
  3392     IF CP-BENEFIT-CD (1:1) = 'S'
  3393        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3394     END-IF
  3395     MOVE CP-ORIGINAL-TERM       TO M
  3396     MOVE CP-LOAN-TERM           TO N
  3397     IF N = ZEROS
  3398        MOVE M                   TO N
  3399     END-IF
  3400     COMPUTE I = CP-LOAN-APR / +1200
  3401     if i = zeros
  3402        move .0000000001         to i
  3403     end-if
  3404     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3405        / (1 + I)
  3406     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3407     COMPUTE J = I + (WK-S / +1000)
  3408     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3409     MOVE I TO K
  3410     COMPUTE WK2 = (1 + J) ** (M * -1)
  3411     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3412     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3413          ** ((M - 1) * -1))) / J)
  3414     COMPUTE ANGLEM = ((1 - ((1 + J)
  3415          ** (M * -1))) / J) / OD
  3416     IF CP-NET-BENEFIT-AMT = ZEROS
  3417        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3418           * ANGLEM
  3419     END-IF
  3420     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3421        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3422        / ANGLEM-1
  3423     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3424          ** ((N - M) * -1))) / I)
  3425     MOVE +0                     TO WK3
  3426     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3427        (WS-COUNTER > M)
  3428        COMPUTE ANGLEM = (1 - ((1 + J)
  3429          ** ((M - WS-COUNTER) * -1))) / J
  3430        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3431        COMPUTE WK5-CSL = (RA * ANGLEM)
  3432        + (CP-ALTERNATE-BENEFIT * WK2)
  3433        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3434          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3435          (WK-S / 1000)
  3436     END-PERFORM
  3437     MOVE WK3                    TO CP-CALC-PREMIUM
  3438     GO TO 9999-CALC-RATE-PREM-X
  3439     .
  3440 2300-CALC-DCC-MOB-BAL-AHSUM.
  3441     MOVE CP-ORIGINAL-TERM       TO M
  3442     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3443        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3444        * WK-S / 1000
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  65
* ELRATE.cbl
  3445*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3446*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3447*       * WK-S / 1000
  3448     MOVE WK3                    TO CP-CALC-PREMIUM
  3449     GO TO 9999-CALC-RATE-PREM-X
  3450     .
  3451 9999-RATE-NOTFND.
  3452     MOVE '6'                    TO CP-RETURN-CODE.
  3453     GO TO 9999-CALC-RATE-PREM-X.
  3454
  3455 9999-RATE-NOTOPEN.
  3456     MOVE 'D'                    TO CP-RETURN-CODE.
  3457     GO TO 9999-CALC-RATE-PREM-X.
  3458
  3459 9999-CALC-RATE-PREM-X.
  3460     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3461        AND (CP-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
  3462        CONTINUE
  3463     ELSE
  3464        IF CP-RATE-DEV-PCT NOT = ZERO
  3465           COMPUTE CP-CALC-PREMIUM =
  3466              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3467
  3468
  3469     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  3470
  3471     IF WS-BROWSE-STARTED
  3472
  3473* EXEC CICS ENDBR
  3474*            DATASET  (ERRATE-FILE-ID)
  3475*       END-EXEC.
  3476     MOVE 0
  3477       TO DFHEIV11
  3478*    MOVE '&2                    $   #00003431' TO DFHEIV0
  3479     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3480     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3481     MOVE X'2020233030303033343331' TO DFHEIV0(25:11)
  3482     CALL 'kxdfhei1' USING DFHEIV0,
  3483           ERRATE-FILE-ID,
  3484           DFHEIV11,
  3485           DFHEIV99
  3486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3487
  3488
  3489
  3490* EXEC CICS RETURN
  3491*    END-EXEC.
  3492*    MOVE '.(                    ''   #00003435' TO DFHEIV0
  3493     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3494     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3495     MOVE X'2020233030303033343335' TO DFHEIV0(25:11)
  3496     CALL 'kxdfhei1' USING DFHEIV0,
  3497           DFHEIV99,
  3498           DFHEIV99,
  3499           DFHEIV99,
  3500           DFHEIV99,
  3501           DFHEIV99,
  3502           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  66
* ELRATE.cbl
  3503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3504
  3505
  3506 9100-CONVERT-DATE.
  3507
  3508* EXEC CICS LINK
  3509*        PROGRAM  ('ELDATCV')
  3510*        COMMAREA (DATE-CONVERSION-DATA)
  3511*        LENGTH   (DC-COMM-LENGTH)
  3512*    END-EXEC.
  3513     MOVE 'ELDATCV' TO DFHEIV1
  3514*    MOVE '."C                   (   #00003439' TO DFHEIV0
  3515     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3516     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3517     MOVE X'2020233030303033343339' TO DFHEIV0(25:11)
  3518     CALL 'kxdfhei1' USING DFHEIV0,
  3519           DFHEIV1,
  3520           DATE-CONVERSION-DATA,
  3521           DC-COMM-LENGTH,
  3522           DFHEIV99,
  3523           DFHEIV99,
  3524           DFHEIV99,
  3525           DFHEIV99
  3526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3527
  3528
  3529 9100-EXIT.
  3530     EXIT.
  3531
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  67
* ELRATE.cbl
  3533 10000-NET-TERM SECTION.
  3534*                         COPY ERCNETP.
  3535*****************************************************************
  3536*                                                               *
  3537*                            ERCNETP                            *
  3538*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3539*                            VMOD=2.029                         *
  3540*                                                               *
  3541*****************************************************************.
  3542*
  3543*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  3544*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  3545*                                   ORIGINAL TERM (S999)
  3546*                                   REMAINING TERM (S999)
  3547*                                   NET PAY OPTION (X)
  3548*                                   LOAN TERM (S999)
  3549*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  3550*
  3551*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  3552*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  3553*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  3554*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  3555*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  3556*    CHARGED.
  3557*
  3558*    OPTIONS - S = NET SIMPLE
  3559*          SPACE = NET PAY  (1 MO. INTEREST)
  3560*              A = NET PAY  (0 MO. INTEREST)
  3561*              I = NET PAY  (2 MO. INTEREST)
  3562*              J = NET PAY  (3 MO. INTEREST)
  3563*              K = NET PAY  (4 MO. INTEREST)
  3564*              T = TRUNCATED  (0 MO. INTEREST)
  3565*              U = TRUNCATED  (1 MO. INTEREST)
  3566*              V = TRUNCATED  (2 MO. INTEREST)
  3567*              W = TRUNCATED  (3 MO. INTEREST)
  3568*              X = TRUNCATED  (4 MO. INTEREST)
  3569*              R = REFUNDS (REGULAR OR TRUNCATED)
  3570******************************************************************
  3571*                   C H A N G E   L O G
  3572*
  3573* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3574*-----------------------------------------------------------------
  3575*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3576* EFFECTIVE    NUMBER
  3577*-----------------------------------------------------------------
  3578* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3579* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3580* 120403                   PEMA  ADD SPECIAL TX CALC
  3581* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3582* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3583* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3584* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3585* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3586* 021207                   PEMA  ADD PA NP
  3587* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3588* 032807                   PEMA  ADD VT NP PLUS 2
  3589* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3590* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  68
* ELRATE.cbl
  3591* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3592* 110207      TO 'AL' NET PAY CALC
  3593* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3594* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3595* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3596* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3597* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3598* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3599* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3600* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3601* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3602* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3603* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  3604* 032612  CR2011110200001  PEMA  AHL CHANGES
  3605* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  3606* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  3607* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  3608* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  3609* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS FOR NET BALLOON
  3610* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3611* 021519  CR2019021100001  PEMA  non-monthly AL calcs
  3612******************************************************************
  3613
  3614     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  3615     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  3616     MOVE N-P-LOAN    TO LOAN-TERM.
  3617     MOVE N-P-REM     TO REMAINING-TERM.
  3618     MOVE N-P-OPT     TO OPTION-SW.
  3619
  3620     MOVE +0 TO FACTOR.
  3621     if cp-company-id = 'CID'
  3622        if annual-int-rate = +99.9999
  3623           go to 99000-error
  3624        end-if
  3625     else
  3626        if annual-int-rate = zero
  3627           go to 99000-error
  3628        end-if
  3629     end-if
  3630     IF ORIGINAL-TERM = ZERO
  3631         GO TO 99999-RETURN.
  3632     IF REMAINING-TERM = ZERO
  3633         GO TO 99999-RETURN.
  3634     IF REMAINING-TERM GREATER ORIGINAL-TERM
  3635         GO TO 99000-ERROR.
  3636     IF LOAN-TERM = ZERO
  3637         GO TO 99999-RETURN.
  3638     IF LOAN-TERM LESS ORIGINAL-TERM
  3639         GO TO 99000-ERROR.
  3640
  3641*    IF ANNUAL-INT-RATE LESS +2
  3642*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3643*    IF ANNUAL-INT-RATE LESS +2
  3644*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3645*    IF ANNUAL-INT-RATE LESS +2
  3646*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3647
  3648     IF NPO-REFUND
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  69
* ELRATE.cbl
  3649         MOVE '2' TO NP-PROCESS-SW
  3650       ELSE
  3651         IF ORIGINAL-TERM = REMAINING-TERM
  3652            MOVE '1'   TO NP-PROCESS-SW
  3653           ELSE
  3654            MOVE '3'   TO NP-PROCESS-SW.
  3655
  3656     IF NPO-SIMPLE
  3657         MOVE 'S' TO TYPE-SW
  3658     ELSE
  3659         MOVE 'N' TO TYPE-SW.
  3660
  3661     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  3662     if i = zeros
  3663        move .0000000001         to i
  3664     end-if
  3665
  3666     COMPUTE V ROUNDED = K1 / (K1 + I).
  3667
  3668     MOVE V     TO VX
  3669                   SV.
  3670
  3671     MOVE +1    TO X1
  3672                   SX.
  3673
  3674     MOVE LOAN-TERM TO MAX-X.
  3675
  3676     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  3677
  3678     IF MAX-X = +1
  3679        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  3680
  3681     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  3682
  3683     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  3684         OR 'DCC' or 'VPP' OR 'NCL') AND
  3685        (NOT NP-REFUND)
  3686        NEXT SENTENCE
  3687     ELSE
  3688     IF LOAN-TERM NOT = ORIGINAL-TERM
  3689        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  3690
  3691     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  3692
  3693 10500-VX-LOOP.
  3694
  3695***  VX = AMORT. LOAN TERM.
  3696***  SV = AMORT. INSURANCE TERM.
  3697***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  3698***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  3699***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  3700
  3701     IF X2 = 1
  3702        MOVE V         TO SX
  3703     END-IF
  3704     COMPUTE VX ROUNDED = VX * V.
  3705
  3706     ADD B1 TO X1.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  70
* ELRATE.cbl
  3707
  3708     IF X1 = REMAINING-TERM
  3709          MOVE VX    TO SV.
  3710
  3711     IF X1 EQUAL SV-MINUS-ONE
  3712        MOVE VX      TO SV-MINUS-ONE.
  3713
  3714     IF X1 = X2
  3715          MOVE VX    TO SX.
  3716
  3717     IF X1 NOT = MAX-X
  3718          GO TO 10500-VX-LOOP.
  3719
  3720 10700-COMPUTE-REMAINING-FACTOR.
  3721*****  WK1 = LOAN TERM AMORT
  3722     COMPUTE WK1 = K1 - VX.
  3723*****  WK2 = INS TERM AMORT
  3724     COMPUTE WK2 = K1 - SV.
  3725*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  3726     COMPUTE WK5 = K1 - SX.
  3727*****  WK6 = INS TERM - 1
  3728     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  3729
  3730     IF NP-RATING
  3731         GO TO 12000-PREMIUM-RATE.
  3732
  3733     IF NP-REFUND
  3734         GO TO 11000-REFUND-CALC.
  3735
  3736     IF NET-STD
  3737         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  3738
  3739     IF NET-SMP
  3740         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  3741         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  3742         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  3743         COMPUTE WK3 ROUNDED = WK3 * 1000.
  3744
  3745     IF REMAINING-TERM LESS THAN X2
  3746         MOVE +0 TO WK3.
  3747
  3748     MOVE WK3 TO FACTOR.
  3749
  3750     GO TO 99999-RETURN.
  3751
  3752 11000-REFUND-CALC.
  3753     IF REMAINING-TERM NOT LESS MAX-X
  3754        MOVE +1 TO FACTOR
  3755        GO TO 99999-RETURN.
  3756
  3757     IF REMAINING-TERM LESS +1
  3758        MOVE 0 TO FACTOR
  3759        GO TO 99999-RETURN.
  3760
  3761     COMPUTE WK2 ROUNDED = WK2 / I.
  3762     COMPUTE WK5 ROUNDED = WK5 / I.
  3763     COMPUTE WK1 ROUNDED = WK1 / I.
  3764
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  71
* ELRATE.cbl
  3765     IF (CP-COMPANY-ID EQUAL 'CID')
  3766        AND (CP-STATE-STD-ABBRV = 'MN')
  3767        AND (CP-CERT-EFF-DT > X'A4FF')
  3768        AND (CP-RATE-AS-REG-BALLOON)
  3769        AND (CP-EARN-AS-NET-PAY)
  3770        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3771        CONTINUE
  3772     ELSE
  3773        GO TO 11000-CHECK-MN-LEV-BALLOON
  3774     END-IF
  3775
  3776     COMPUTE R = M - E
  3777     COMPUTE FACTOR = (R - WK2 + WK5) /
  3778        (M - WK1 + WK5)
  3779
  3780     GO TO 99999-RETURN
  3781
  3782      .
  3783 11000-CHECK-MN-LEV-BALLOON.
  3784
  3785     IF (CP-COMPANY-ID EQUAL 'CID')
  3786        AND (CP-STATE-STD-ABBRV = 'MN')
  3787        AND (CP-CERT-EFF-DT > X'A4FF')
  3788        AND (CP-RATE-AS-REG-BALLOON)
  3789        AND (CP-EARN-AS-NET-PAY)
  3790        AND (CP-DEVIATION-CODE = 'LEV')
  3791        CONTINUE
  3792     ELSE
  3793        GO TO 11000-CONTINUE-REFUND
  3794     END-IF
  3795
  3796     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3797     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3798        ** (M - E)) / I
  3799
  3800     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3801
  3802     GO TO 99999-RETURN
  3803
  3804     .
  3805 11000-CONTINUE-REFUND.
  3806*    IF CP-GAP-ACTUARIAL
  3807*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3808*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3809*       COMPUTE WK3 = WK2 / ANGLEN
  3810*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3811     IF CP-GAP-ACTUARIAL
  3812        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3813           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3814        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3815     ELSE
  3816        COMPUTE WK3 ROUNDED =
  3817          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3818     END-IF
  3819
  3820     MOVE WK3  TO FACTOR.
  3821
  3822     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  72
* ELRATE.cbl
  3823
  3824 12000-PREMIUM-RATE.
  3825*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  3826*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  3827*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  3828*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  3829*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  3830*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  3831
  3832     COMPUTE K-I = K1 + I.
  3833     MOVE K-I TO ONE-PLUS-I.
  3834
  3835     IF NPO-ALT OR NPO-TRUNC-0
  3836         MOVE K1 TO K-I.
  3837
  3838     IF NPO-2MO OR NPO-TRUNC-2
  3839         COMPUTE K-I = K1 + (2 * I).
  3840
  3841     IF NPO-3MO OR NPO-TRUNC-3
  3842         COMPUTE K-I = K1 + (3 * I).
  3843
  3844     IF NPO-4MO OR NPO-TRUNC-4
  3845         COMPUTE K-I = K1 + (4 * I).
  3846
  3847     COMPUTE RA ROUNDED = 1 -
  3848             ((X2 * (X2 + 1)) /
  3849              (N *  (N  + 1))).
  3850
  3851     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  3852        (CP-CSL-VALID-NP-BENEFIT-CD)
  3853        NEXT SENTENCE
  3854     ELSE
  3855        GO TO XXXX-CHECK-DISCOUNT-5.
  3856
  3857     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3858     MOVE ' ' TO DC-OPTION-CODE.
  3859     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3860
  3861     IF DATE-CONVERSION-ERROR
  3862        MOVE '2'                 TO CP-RETURN-CODE
  3863        MOVE ZEROS               TO FACTOR
  3864                                    CP-CALC-PREMIUM
  3865         GO TO 99999-RETURN.
  3866
  3867     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  3868     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  3869     MOVE ' ' TO DC-OPTION-CODE
  3870     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3871
  3872     IF DATE-CONVERSION-ERROR
  3873        MOVE '2'                 TO CP-RETURN-CODE
  3874        MOVE ZEROS               TO FACTOR
  3875                                    CP-CALC-PREMIUM
  3876         GO TO 99999-RETURN.
  3877
  3878     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
  3879
  3880     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  73
* ELRATE.cbl
  3881
  3882     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  3883        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  3884        CP-PAY-FREQUENCY / 365) * I
  3885     ELSE
  3886        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  3887        CP-PAY-FREQUENCY / 365) * I.
  3888
  3889     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  3890     13).
  3891
  3892     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  3893     (N - ( ANGLEN-1 / WK3)).
  3894
  3895     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  3896
  3897     COMPUTE WS-CALC-FREQ-RATE EQUAL
  3898       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  3899
  3900     COMPUTE WS-Y-X-FACTOR EQUAL
  3901       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  3902       WS-CALC-FREQ-RATE).
  3903
  3904     COMPUTE WS-ODD-DAY-UNITS EQUAL
  3905       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  3906
  3907     COMPUTE WS-X-Y-FACTOR EQUAL
  3908       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  3909
  3910     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  3911       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  3912       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  3913
  3914     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  3915
  3916     GO TO 99999-RETURN.
  3917
  3918 XXXX-CHECK-DISCOUNT-5.
  3919
  3920     IF WS-DISCOUNT-OPTION EQUAL '5'
  3921        NEXT SENTENCE
  3922     ELSE
  3923        GO TO 12000-CHECK-CLIENT.
  3924
  3925      COMPUTE ANGLEN EQUAL WK1 / I.
  3926
  3927      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3928
  3929      COMPUTE WK3 EQUAL
  3930        (12 *
  3931        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  3932        CP-ORIGINAL-BENEFIT)) /
  3933        APR100.
  3934
  3935     COMPUTE WK3 EQUAL
  3936        (WK3 * CP-PREMIUM-RATE) / +1000.
  3937
  3938     COMPUTE WK3 EQUAL
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  74
* ELRATE.cbl
  3939        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  3940
  3941      MOVE WK3 TO CP-CALC-PREMIUM.
  3942
  3943     GO TO 99999-RETURN.
  3944
  3945 12000-CHECK-CLIENT.
  3946
  3947     IF (CP-COMPANY-ID EQUAL 'MON') AND
  3948        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3949        (CP-TRUNCATED-LIFE)
  3950        NEXT SENTENCE
  3951     ELSE
  3952        GO TO 12000-CHECK-NEXT.
  3953
  3954     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3955
  3956     COMPUTE ANGLEN EQUAL WK1 / I.
  3957     COMPUTE ANGLEM EQUAL WK2 / I.
  3958
  3959     COMPUTE FM EQUAL
  3960                    (((ONE-PLUS-I ** M) * I * M) /
  3961                    ((ONE-PLUS-I ** M) - 1))
  3962                    - 1.
  3963
  3964     COMPUTE FN EQUAL
  3965                    (((ONE-PLUS-I ** N) * I * N) /
  3966                    ((ONE-PLUS-I ** N) - 1))
  3967                    - 1.
  3968
  3969     COMPUTE FNM EQUAL
  3970                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  3971                    ((ONE-PLUS-I ** (N - M)) - 1))
  3972                    - 1.
  3973
  3974     COMPUTE GR EQUAL
  3975                    (WS-WORK-RATE * ANGLEM * I) /
  3976                    (M - ANGLEM).
  3977
  3978     COMPUTE ODF EQUAL
  3979                     (1 +
  3980                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  3981                     360)) /
  3982                     ONE-PLUS-I.
  3983
  3984     COMPUTE OD EQUAL
  3985                    (1 + (ODF * (FN / I - 1))) +
  3986                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  3987
  3988     COMPUTE WK3 EQUAL
  3989*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  3990                    ((1 + FN) * ODF *
  3991                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  3992                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  3993                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  3994
  3995     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  3996     COMPUTE WK3 EQUAL TRUNC-PMT * N.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  75
* ELRATE.cbl
  3997
  3998     COMPUTE WK3 EQUAL
  3999                    (WK3 / (ODF * (1 + FN))) -
  4000*                   CP-ORIGINAL-BENEFIT.
  4001                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  4002
  4003      MOVE WK3 TO CP-CALC-PREMIUM.
  4004
  4005     GO TO 99999-RETURN.
  4006
  4007 12000-CHECK-NEXT.
  4008
  4009     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  4010        NEXT SENTENCE
  4011     ELSE
  4012        GO TO 12000-CHECK-PA-TRUNC.
  4013
  4014      IF WS-WORK-DIS-RATE EQUAL +0
  4015         MOVE '7'                TO CP-RETURN-CODE
  4016         MOVE ZEROS              TO FACTOR
  4017                                    CP-CALC-PREMIUM
  4018         GO TO 99999-RETURN.
  4019
  4020      COMPUTE ANGLEN EQUAL WK1 / I.
  4021
  4022      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  4023
  4024      IF WS-WORK-DIS-RATE EQUAL APR100
  4025         ADD .00001 TO APR100.
  4026
  4027      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  4028      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  4029
  4030     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4031        / (1 + I)
  4032     COMPUTE ANGLEN-1 = ANGLEN / Y
  4033      IF CP-COMPANY-ID EQUAL 'CDL'
  4034         COMPUTE WK3 EQUAL
  4035
  4036          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  4037          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  4038
  4039          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  4040
  4041          ((WK8 ** N) /
  4042          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  4043
  4044          ((WK9 ** N) /
  4045          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  4046
  4047      ELSE
  4048         COMPUTE WK3 EQUAL
  4049
  4050          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  4051          (12 + WS-WORK-DIS-RATE) * 12) *
  4052
  4053          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  4054
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  76
* ELRATE.cbl
  4055          ((WK8 ** N) /
  4056          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  4057
  4058          ((WK9 ** N) /
  4059          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  4060
  4061      COMPUTE WK3 EQUAL
  4062          (WK3 * CP-PREMIUM-RATE) / +1000.
  4063
  4064      MOVE WK3 TO CP-CALC-PREMIUM.
  4065
  4066     GO TO 99999-RETURN.
  4067
  4068 12000-CHECK-PA-TRUNC.
  4069
  4070     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4071        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  4072        (CP-EARN-AS-NET-PAY) AND
  4073        (CP-TRUNCATED-LIFE)
  4074        NEXT SENTENCE
  4075     ELSE
  4076        GO TO 12000-CHECK-MD-TRUNC.
  4077
  4078     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4079
  4080     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4081     COMPUTE ANGLEN EQUAL WK1 / I.
  4082
  4083     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4084
  4085     COMPUTE WK3 EQUAL
  4086        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  4087        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  4088
  4089     MOVE WK3 TO CP-CALC-PREMIUM.
  4090
  4091     GO TO 99999-RETURN.
  4092
  4093 12000-CHECK-MD-TRUNC.
  4094
  4095     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4096        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  4097        (CP-EARN-AS-NET-PAY) AND
  4098        (CP-TRUNCATED-LIFE)
  4099        NEXT SENTENCE
  4100     ELSE
  4101        GO TO 12000-CHECK-MD.
  4102
  4103     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4104
  4105     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4106     COMPUTE ANGLEM EQUAL WK2 / I.
  4107     COMPUTE ANGLEN EQUAL WK1 / I.
  4108
  4109     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4110
  4111     COMPUTE WK3 EQUAL
  4112        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  77
* ELRATE.cbl
  4113        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  4114        (ANGLEN-1 * (M - ANGLEM))).
  4115
  4116     MOVE WK3 TO CP-CALC-PREMIUM.
  4117
  4118     GO TO 99999-RETURN.
  4119
  4120 12000-CHECK-MD.
  4121
  4122     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4123        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  4124        (CP-EARN-AS-NET-PAY)
  4125        NEXT SENTENCE
  4126     ELSE
  4127        GO TO 12000-CHECK-ME-TRUNC.
  4128
  4129     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4130
  4131     COMPUTE WK3 EQUAL
  4132        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  4133
  4134     MOVE WK3 TO CP-CALC-PREMIUM.
  4135
  4136     GO TO 99999-RETURN.
  4137
  4138 12000-CHECK-ME-TRUNC.
  4139
  4140     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  4141        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4142        AND (CP-EARN-AS-NET-PAY)
  4143        AND (CP-TRUNCATED-LIFE)
  4144        CONTINUE
  4145     ELSE
  4146        GO TO 12000-CHECK-CID-WA-FARMPLAN
  4147     END-IF
  4148
  4149     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4150     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4151     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4152     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4153     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4154     COMPUTE ANGLEN-1 = ANGLEN / Y
  4155     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4156     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4157     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  4158     COMPUTE WK3
  4159        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  4160        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  4161            * (1 / (1.0635 ** (M / 12))))
  4162*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  4163*    COMPUTE WK9 EQUAL
  4164*       1 / (1 + (.045 * (N - M) / 24))
  4165*    COMPUTE WK7 EQUAL
  4166*       WS-WORK-RATE * 20 / (M + 1).
  4167*    COMPUTE WK3 EQUAL
  4168*       ((( N - ANGLEN) * WK7 * WK8) /
  4169*       (10 * ANGLEN-1 * I)) -
  4170*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  78
* ELRATE.cbl
  4171*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  4172*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  4173*
  4174     MOVE WK3 TO CP-CALC-PREMIUM.
  4175
  4176     GO TO 99999-RETURN
  4177      .
  4178 12000-CHECK-CID-WA-FARMPLAN.
  4179
  4180     IF (CP-COMPANY-ID EQUAL 'CID')
  4181        AND (CP-STATE-STD-ABBRV = 'WA')
  4182        AND (CP-FARM-PLAN)
  4183        CONTINUE
  4184     ELSE
  4185        GO TO 12000-CHECK-CID-FARMPLAN
  4186     END-IF
  4187**  This was removed due to IR 2015022300001
  4188    GO TO 12000-CHECK-CID-FARMPLAN
  4189
  4190     move cp-original-term       to n
  4191     move cp-no-of-pmts          TO C-TOT-PMTS
  4192     compute c-pmts-per-year = 12 / cp-pay-frequency
  4193     move cp-pay-frequency       to m
  4194     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  4195     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4196     if i = zeros
  4197        move .0000000001         to i
  4198     end-if
  4199     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  4200
  4201     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  4202        (m * 30))) / (1 + I)
  4203     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4204        ** CP-PAY-FREQUENCY) - 1
  4205     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  4206     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4207        ** TI) / WS-WORK-DIS-RATE
  4208     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  4209     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  4210     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4211        ** m) / WS-WORK-DIS-RATE
  4212     COMPUTE WK2 = WK2 * (1 + J)
  4213     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4214     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4215     COMPUTE WK3 = WK3 * (1 + J)
  4216     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  4217        ** (c-tot-pmts - 1))) / J
  4218     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4219        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  4220        (CP-PREMIUM-RATE / 1000)
  4221     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  4222     COMPUTE WK6 = (WK7 * GR)
  4223
  4224     MOVE WK6 TO CP-CALC-PREMIUM
  4225
  4226     GO TO 99999-RETURN
  4227
  4228     .
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  79
* ELRATE.cbl
  4229 12000-CHECK-CID-FARMPLAN.
  4230     IF (CP-COMPANY-ID EQUAL 'CID')
  4231        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  4232           OR 'IN' OR 'AZ')
  4233        AND (CP-FARM-PLAN)
  4234        CONTINUE
  4235     ELSE
  4236        GO TO 12000-CHECK-CID-AL-FARMPLAN
  4237     END-IF
  4238     COMPUTE N = M / CP-PAY-FREQUENCY
  4239     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4240     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4241        ** CP-PAY-FREQUENCY) - 1
  4242     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  4243     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4244        ** TI) / WS-WORK-DIS-RATE
  4245     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  4246     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  4247     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4248        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  4249     COMPUTE WK2 = WK2 * (1 + J)
  4250     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4251     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4252     COMPUTE WK3 = WK3 * (1 + J)
  4253     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  4254        ** (N - 1))) / J
  4255     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4256        ((N * WK2) - WK5)) + (N * WK1)) *
  4257        (CP-PREMIUM-RATE / 1000)
  4258     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  4259     COMPUTE WK6 = (WK7 * GR)
  4260     MOVE WK6 TO CP-CALC-PREMIUM
  4261     GO TO 99999-RETURN
  4262     .
  4263 12000-CHECK-CID-AL-FARMPLAN.
  4264
  4265     IF (CP-COMPANY-ID EQUAL 'CID')
  4266        AND (CP-STATE-STD-ABBRV = 'AL')
  4267        AND (CP-FARM-PLAN)
  4268        CONTINUE
  4269     ELSE
  4270        GO TO 12000-CHECK-SC-CID
  4271     END-IF
  4272
  4273     display ' made AL Farm Plan calc '
  4274
  4275     evaluate true
  4276        when cp-pmt-mode = 'B'
  4277           move 26               to c-pmts-per-year
  4278           move 14               to c-days-in-pmt-per
  4279        when cp-pmt-mode = 'W'
  4280           move 52               to c-pmts-per-year
  4281           move 07               to c-days-in-pmt-per
  4282        when cp-pmt-mode = 'S'
  4283           move 24               to c-pmts-per-year
  4284           move 15               to c-days-in-pmt-per
  4285        when cp-pmt-mode = 'A'
  4286           move 1                to c-pmts-per-year
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  80
* ELRATE.cbl
  4287           move 360              to c-days-in-pmt-per
  4288        when cp-pmt-mode = 'T'
  4289           move 2                to c-pmts-per-year
  4290           move 180              to c-days-in-pmt-per
  4291        when cp-pmt-mode = 'Q'
  4292           move 4                to c-pmts-per-year
  4293           move 90               to c-days-in-pmt-per
  4294        when cp-pmt-mode = 'N' *> Bi-Monthly ??
  4295           move 6                to c-pmts-per-year
  4296           move 60               to c-days-in-pmt-per
  4297        when other
  4298           move 12               to c-pmts-per-year
  4299           move 30               to c-days-in-pmt-per
  4300     end-evaluate
  4301
  4302     compute c-tot-pmts = n / 12 * c-pmts-per-year
  4303     compute i = cp-loan-apr / c-pmts-per-year / 100
  4304     if i = zeros
  4305        move .0000000001         to i
  4306     end-if
  4307     compute anglen  =
  4308        (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  4309
  4310     compute y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  4311        c-days-in-pmt-per)) / (1 + I)
  4312
  4313     compute angleny = anglen / y
  4314
  4315     compute wk3 rounded =   *> tv1
  4316        ((c-tot-pmts - anglen + (i * c-tot-pmts))) / i
  4317
  4318     compute wk6 =           *> tv2
  4319        cp-premium-rate / 10 * 12 / c-pmts-per-year / 100
  4320
  4321     compute wk7 =    *> tv3
  4322        (cp-original-benefit / anglen)
  4323
  4324     compute wk5 rounded = wk7 *wk3 * wk6
  4325
  4326     move wk5                    to cp-calc-premium
  4327     GO TO 99999-RETURN
  4328     .
  4329 12000-CHECK-SC-CID.
  4330     IF (CP-COMPANY-ID = 'CID')
  4331        AND (CP-STATE-STD-ABBRV = 'SC')
  4332        AND (CP-EARN-AS-NET-PAY)
  4333        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  4334        move 6                   to ws-extra-pmts
  4335     ELSE
  4336        GO TO 12000-CHECK-AL-CID
  4337     END-IF
  4338     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4339     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4340     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4341        / 12)) / ((M + 1) / 2)
  4342
  4343     if i = .0000000001
  4344        compute wk4 = cp-original-benefit / n
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  81
* ELRATE.cbl
  4345        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  4346            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  4347        display ' hit sc wo apr - wk2 ' wk2
  4348     else
  4349        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  4350        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4351        COMPUTE ANGLEN-1 = ANGLEN / Y
  4352        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4353        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4354           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4355     end-if
  4356*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4357*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4358*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4359*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4360*    COMPUTE ANGLEN-1 = ANGLEN / Y
  4361*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4362*       / 12)) / ((M + 1) / 2)
  4363*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4364*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4365*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4366     MOVE WK3 TO CP-CALC-PREMIUM
  4367     GO TO 99999-RETURN
  4368     .
  4369 12000-CHECK-AL-CID.
  4370     IF (CP-COMPANY-ID EQUAL 'CID')
  4371        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  4372        AND (CP-EARN-AS-NET-PAY)
  4373        CONTINUE
  4374     ELSE
  4375        GO TO 12000-CHECK-NH-CID
  4376     END-IF
  4377     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4378     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4379     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4380     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4381                   / (1 + I)
  4382     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4383     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4384     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  4385        (CP-PREMIUM-RATE / 1000)
  4386     MOVE WK3 TO CP-CALC-PREMIUM
  4387     GO TO 99999-RETURN
  4388     .
  4389 12000-CHECK-NH-CID.
  4390     IF (CP-COMPANY-ID EQUAL 'CID')
  4391        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  4392        AND (CP-EARN-AS-NET-PAY)
  4393        CONTINUE
  4394     ELSE
  4395        GO TO 12000-CHECK-PA-CID
  4396     END-IF
  4397     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4398     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4399     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4400                   / (1 + I)
  4401     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4402     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  82
* ELRATE.cbl
  4403     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4404        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  4405     MOVE WK3 TO CP-CALC-PREMIUM
  4406     GO TO 99999-RETURN
  4407     .
  4408 12000-CHECK-PA-CID.
  4409     IF (CP-COMPANY-ID EQUAL 'CID')
  4410        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  4411        AND (CP-EARN-AS-NET-PAY)
  4412        CONTINUE
  4413     ELSE
  4414        GO TO 12000-CHECK-ME-CID
  4415     END-IF
  4416
  4417     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4418     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4419     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4420     COMPUTE ANGLEN-1 = ANGLEN / Y
  4421     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  4422     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4423     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  4424     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4425        * WK5
  4426     MOVE WK3 TO CP-CALC-PREMIUM
  4427     GO TO 99999-RETURN
  4428     .
  4429 12000-CHECK-ME-CID.
  4430     IF (CP-COMPANY-ID EQUAL 'CID')
  4431        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4432        AND (CP-EARN-AS-NET-PAY)
  4433        CONTINUE
  4434     ELSE
  4435        GO TO 12000-CHECK-VT-TRUNC
  4436     END-IF
  4437     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4438     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4439     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4440     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4441     COMPUTE ANGLEN-1 = ANGLEN / Y
  4442     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4443     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4444     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4445        * WK5
  4446     MOVE WK3 TO CP-CALC-PREMIUM
  4447     GO TO 99999-RETURN
  4448     .
  4449 12000-CHECK-VT-TRUNC.
  4450
  4451     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4452        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4453        (CP-EARN-AS-NET-PAY) AND
  4454        (CP-TRUNCATED-LIFE)
  4455        NEXT SENTENCE
  4456     ELSE
  4457        GO TO 12000-CHECK-VT.
  4458
  4459      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4460
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  83
* ELRATE.cbl
  4461      COMPUTE ANGLEN EQUAL WK1 / I.
  4462
  4463      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4464
  4465      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  4466      COMPUTE WK9 EQUAL
  4467        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  4468        ((.0054 - I) / (1 + I)).
  4469      COMPUTE WK7 EQUAL
  4470        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  4471      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4472        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  4473
  4474      MOVE WK3 TO CP-CALC-PREMIUM.
  4475
  4476     GO TO 99999-RETURN.
  4477
  4478 12000-CHECK-VT.
  4479
  4480     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4481        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4482        (CP-EARN-AS-NET-PAY)
  4483        NEXT SENTENCE
  4484     ELSE
  4485        GO TO 12000-CHECK-MINN-WDS.
  4486
  4487      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4488
  4489      COMPUTE ANGLEN EQUAL WK1 / I.
  4490
  4491      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4492
  4493      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  4494                        (ANGLEN-1 * I)) *
  4495
  4496                        (((1.0054 ** N - 1) /
  4497                        (1.0054 ** (N - 1) * .0054)) -
  4498
  4499                        ((V * (1 - 1.0054 ** N * VX)) /
  4500                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  4501
  4502      MOVE WK3 TO CP-CALC-PREMIUM.
  4503
  4504     GO TO 99999-RETURN.
  4505
  4506 12000-CHECK-MINN-WDS.
  4507
  4508     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4509        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4510        (CP-EARN-AS-NET-PAY)
  4511        NEXT SENTENCE
  4512     ELSE
  4513        GO TO 12000-CHECK-MINN-BALL-LEV.
  4514
  4515     COMPUTE ANGLEN EQUAL WK1 / I.
  4516     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
  4517              (N / +12) * (2 / (N + 1)).
  4518     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  84
* ELRATE.cbl
  4519         WK3 * ((N - ANGLEN) / I).
  4520
  4521      MOVE WK3 TO CP-CALC-PREMIUM.
  4522
  4523     GO TO 99999-RETURN.
  4524
  4525 12000-CHECK-MINN-BALL-LEV.
  4526
  4527     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4528        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4529        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4530        (CP-EARN-AS-REG-BALLOON)
  4531        NEXT SENTENCE
  4532     ELSE
  4533        GO TO 12000-CHECK-MINN-BALL.
  4534
  4535     COMPUTE ANGLEN EQUAL WK1 / I.
  4536
  4537     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  4538
  4539     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4540        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  4541
  4542     MOVE WK3 TO CP-CALC-PREMIUM.
  4543
  4544     GO TO 99999-RETURN.
  4545
  4546 12000-CHECK-MINN-BALL.
  4547
  4548     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4549        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4550        (CP-EARN-AS-REG-BALLOON)
  4551        NEXT SENTENCE
  4552     ELSE
  4553        GO TO 12000-CHECK-CID-MN-BALL.
  4554
  4555     COMPUTE ANGLEN EQUAL WK1 / I.
  4556     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4557
  4558     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4559     / +100 * (N - 1) / 12 * 2 / N *
  4560     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  4561
  4562      MOVE WK3 TO CP-CALC-PREMIUM.
  4563
  4564     GO TO 99999-RETURN.
  4565
  4566 12000-CHECK-CID-MN-BALL.
  4567     IF (CP-COMPANY-ID EQUAL 'CID')
  4568        AND (CP-STATE-STD-ABBRV = 'MN')
  4569        AND (CP-CERT-EFF-DT > X'A4FF')
  4570        AND (CP-EARN-AS-REG-BALLOON)
  4571        CONTINUE
  4572     ELSE
  4573        GO TO 12000-CHECK-CID-MN-FARM
  4574     END-IF
  4575     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4576     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  85
* ELRATE.cbl
  4577     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4578     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4579     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4580     COMPUTE V = 1 / (1 + I)
  4581     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4582     COMPUTE Y = (1 + (D * I) / +30)
  4583        / (1 + I)
  4584     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4585        * CP-PREMIUM-RATE / 1000
  4586*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  4587*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4588*    ELSE
  4589*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  4590*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4591*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4592*       DISPLAY ' BALLOON TOP ' WK6
  4593*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4594*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4595*          / 100
  4596*       DISPLAY ' BALLOON BOTTOM ' WK7
  4597*       COMPUTE GR = WK6 / WK7
  4598*       DISPLAY ' BALLOON PAYMENT ' GR
  4599*    END-IF
  4600     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4601     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4602        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4603     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  4604     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4605        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4606           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4607           * CP-PREMIUM-RATE / 1000
  4608     MOVE WK3                    TO CP-CALC-PREMIUM
  4609     GO TO 99999-RETURN.
  4610     .
  4611 12000-CHECK-CID-MN-FARM.
  4612
  4613     IF (CP-COMPANY-ID EQUAL 'CID')
  4614        AND (CP-STATE-STD-ABBRV = 'MN' or 'WA')
  4615        AND (CP-CERT-EFF-DT > X'A4FF')
  4616        AND (CP-EARN-AS-FARM-PLAN)
  4617        CONTINUE
  4618     ELSE
  4619        GO TO 12000-CHECK-CID-NET-BALLoons
  4620     END-IF
  4621
  4622     EVALUATE CP-PMT-MODE
  4623        WHEN 'B'
  4624           MOVE +14              TO C-DAYS-IN-PMT-PER
  4625           MOVE +26              TO C-PMTS-PER-YEAR
  4626           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4627        WHEN 'S'
  4628           MOVE +15              TO C-DAYS-IN-PMT-PER
  4629           MOVE +24              TO C-PMTS-PER-YEAR
  4630           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4631        WHEN 'T'
  4632           MOVE +360             TO C-DAYS-IN-PMT-PER
  4633           MOVE +1               TO C-PMTS-PER-YEAR
  4634           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  86
* ELRATE.cbl
  4635        WHEN 'W'
  4636           MOVE +7               TO C-DAYS-IN-PMT-PER
  4637           MOVE +52              TO C-PMTS-PER-YEAR
  4638           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4639        WHEN OTHER
  4640           move cp-no-of-pmts    to c-tot-pmts
  4641           if cp-pay-frequency > zeros
  4642              compute c-pmts-per-year =
  4643                 12 / cp-pay-frequency
  4644              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  4645           else
  4646              MOVE +30           TO C-DAYS-IN-PMT-PER
  4647              MOVE +12           TO C-PMTS-PER-YEAR
  4648              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  4649           end-if
  4650     END-EVALUATE
  4651
  4652     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4653     if i = zeros
  4654        move .0000000001         to i
  4655     end-if
  4656
  4657     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4658        C-DAYS-IN-PMT-PER)) / (1 + I)
  4659
  4660     compute cp-premium-rate =
  4661        cp-premium-rate * 12 / c-pmts-per-year / 10
  4662     move c-tot-pmts to n m
  4663     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4664     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4665     COMPUTE ANGLEN-1 = ANGLEN / Y
  4666     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4667
  4668     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  4669        (cp-premium-rate / 100)
  4670
  4671
  4672     MOVE WK3                    TO CP-CALC-PREMIUM
  4673
  4674     GO TO 99999-RETURN.
  4675
  4676     .
  4677 12000-check-cid-net-balloons.
  4678     IF (CP-COMPANY-ID EQUAL 'CID')
  4679        AND (CP-EARN-AS-REG-BALLOON)
  4680        and (CP-NET-ONLY-STATE not = 'Y')
  4681        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  4682        CONTINUE
  4683     ELSE
  4684        GO TO 12000-check-cid-net-only-balls
  4685     END-IF
  4686     display ' *** NOT NET ONLY STATE BALLOONS *** '
  4687     COMPUTE Y =
  4688        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  4689     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4690     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  4691     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4692     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  87
* ELRATE.cbl
  4693     COMPUTE ANGLEMY = ANGLEM / Y
  4694     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  4695     COMPUTE ANGLENY = ANGLEN / Y
  4696     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  4697     compute cp-original-benefit =
  4698        cp-original-benefit + cp-alternate-benefit
  4699     COMPUTE PVBALLOON rounded =
  4700        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  4701     compute wk4 rounded =
  4702        cp-original-benefit - pvballoon
  4703     compute wk6 rounded =
  4704        (cp-original-benefit - cp-alternate-benefit)
  4705***  compute ra = wk4 / anglem-1y
  4706     compute ra = wk4 / anglemy
  4707     compute wk6 rounded = wk6 / anglemy
  4708     display ' rate before ' cp-premium-rate
  4709     compute cp-premium-rate =
  4710        (cp-premium-rate * ((m + (cp-days-to-1st-pmt - 30)
  4711            / 30) / 12))     /
  4712           ((m + 1) / 2)
  4713     display '************************************'
  4714     display ' orign ben    ' cp-original-benefit
  4715     display ' balloon      ' cp-alternate-benefit
  4716     display ' ra           ' ra
  4717     display ' wk6          ' wk6
  4718     display ' m            ' m
  4719     display ' anglemy      ' anglemy
  4720     display ' anglem-1     ' anglem-1y
  4721     display ' i            ' i
  4722     display ' extra per    ' cp-extra-periods
  4723     display ' prem rate    ' cp-premium-rate
  4724***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  4725***     (cp-extra-periods * i)) * cp-premium-rate / 100
  4726     compute wk3 = wk6 * (m - anglem) / i * (1 +
  4727        (cp-extra-periods * i)) * cp-premium-rate / 100
  4728     move wk3                    to cp-calc-premium
  4729     display ' wk3          ' wk3
  4730     display '************************************'
  4731*    compute wk3 rounded =
  4732*       cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  4733*    move wk3                    to cp-lf-balloon-prem
  4734     GO TO 99999-RETURN.
  4735     .
  4736 12000-check-cid-net-only-balls.
  4737     IF (CP-COMPANY-ID EQUAL 'CID')
  4738        AND (CP-EARN-AS-REG-BALLOON)
  4739        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  4740        CONTINUE
  4741     ELSE
  4742        GO TO 12000-CHECK-NC-WDS
  4743     END-IF
  4744     display ' *** NET ONLY STATE BALLOONS *** '
  4745     COMPUTE Y =
  4746        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  4747     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4748     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  4749     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4750     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  88
* ELRATE.cbl
  4751     COMPUTE ANGLEMY = ANGLEM / Y
  4752     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  4753     COMPUTE ANGLENY = ANGLEN / Y
  4754     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  4755     COMPUTE PVBALLOON rounded =
  4756        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  4757     compute wk4 rounded =
  4758        cp-original-benefit - pvballoon
  4759*    compute cp-premium-rate =
  4760*       (cp-premium-rate * (m + 1) / 12)  /
  4761*          ((m + 2) / 2)
  4762***  compute ra = wk4 / anglem-1y
  4763     compute ra = (cp-original-benefit + cp-alternate-benefit -
  4764        pvballoon) / anglemy
  4765     display '************************************'
  4766     display ' ra           ' ra
  4767     display ' m            ' m
  4768     display ' anglemy      ' anglemy
  4769     display ' anglem-1     ' anglem-1y
  4770     display ' i            ' i
  4771     display ' extra per    ' cp-extra-periods
  4772     display ' prem rate    ' cp-premium-rate
  4773     display '************************************'
  4774***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  4775***     (cp-extra-periods * i)) * cp-premium-rate / 100
  4776     compute wk3 = ra * (m - anglemy) / i * (1 +
  4777        (cp-extra-periods * i)) * cp-premium-rate / 100
  4778     move wk3                    to cp-calc-premium
  4779     compute wk3 rounded =
  4780        cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  4781     move wk3                    to cp-lf-balloon-prem
  4782     GO TO 99999-RETURN.
  4783     .
  4784 12000-CHECK-NC-WDS.
  4785
  4786     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4787        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4788        (CP-EARN-AS-NET-PAY)
  4789        NEXT SENTENCE
  4790     ELSE
  4791        GO TO 12000-CHECK-NC-BALL-LEV.
  4792
  4793     COMPUTE WK4 EQUAL N * (1 + I * 2).
  4794     COMPUTE ANGLEN EQUAL WK1 / I.
  4795     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4796              CP-PREMIUM-RATE / +100 *
  4797              N / +12 * 2 / (N + 1) *
  4798              (WK4 - ANGLEN) / (I * ANGLEN).
  4799
  4800      MOVE WK3 TO CP-CALC-PREMIUM.
  4801
  4802     GO TO 99999-RETURN.
  4803
  4804 12000-CHECK-NC-BALL-LEV.
  4805
  4806     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4807        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4808        (CP-DEVIATION-CODE EQUAL 'LEV') AND
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  89
* ELRATE.cbl
  4809        (CP-EARN-AS-REG-BALLOON)
  4810        NEXT SENTENCE
  4811     ELSE
  4812        GO TO 12000-CHECK-NC-BALL.
  4813
  4814     COMPUTE ANGLEN EQUAL WK1 / I.
  4815
  4816**** VX = 1 / (1 + I)**N.
  4817
  4818     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4819        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  4820
  4821     MOVE WK3 TO CP-CALC-PREMIUM.
  4822
  4823     GO TO 99999-RETURN.
  4824
  4825 12000-CHECK-NC-BALL.
  4826
  4827     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4828        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4829        (CP-EARN-AS-REG-BALLOON)
  4830        NEXT SENTENCE
  4831     ELSE
  4832        GO TO 12000-CHECK-MINN-TRUNC.
  4833
  4834     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  4835     COMPUTE ANGLEN EQUAL WK1 / I.
  4836     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4837**** VX = 1 / (1 + I)**N.
  4838
  4839     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4840     / +100 * (N - 1) / 12 * 2 / N *
  4841     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  4842
  4843      MOVE WK3 TO CP-CALC-PREMIUM.
  4844
  4845     GO TO 99999-RETURN.
  4846
  4847 12000-CHECK-MINN-TRUNC.
  4848
  4849     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4850        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4851        (M GREATER THAN +63) AND
  4852        (CP-EARN-AS-NET-PAY) AND
  4853        (CP-TRUNCATED-LIFE)
  4854        NEXT SENTENCE
  4855     ELSE
  4856        GO TO 12000-CHECK-MINN.
  4857
  4858      COMPUTE ANGLEN EQUAL WK1 / I.
  4859      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4860
  4861      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4862
  4863      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4864       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4865       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  4866
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  90
* ELRATE.cbl
  4867      MOVE WK3 TO CP-CALC-PREMIUM.
  4868
  4869     GO TO 99999-RETURN.
  4870
  4871 12000-CHECK-MINN.
  4872
  4873     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4874        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4875        (M GREATER THAN +63) AND
  4876        (CP-EARN-AS-NET-PAY)
  4877        NEXT SENTENCE
  4878     ELSE
  4879        GO TO 12000-CHECK-MONTANA-TRUNC.
  4880
  4881      COMPUTE ANGLEN EQUAL WK1 / I.
  4882
  4883      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4884
  4885      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4886       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4887       (((N - ANGLEN) / I) + (2 * N)).
  4888
  4889      MOVE WK3 TO CP-CALC-PREMIUM.
  4890
  4891     GO TO 99999-RETURN.
  4892
  4893 12000-CHECK-MONTANA-TRUNC.
  4894
  4895     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4896        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4897        (M GREATER THAN +63) AND
  4898        (CP-EARN-AS-NET-PAY) AND
  4899        (CP-TRUNCATED-LIFE)
  4900        NEXT SENTENCE
  4901     ELSE
  4902        GO TO 12000-CHECK-MONTANA.
  4903
  4904      COMPUTE ANGLEN EQUAL WK1 / I.
  4905      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4906
  4907      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4908
  4909      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4910      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4911       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  4912
  4913      MOVE WK3 TO CP-CALC-PREMIUM.
  4914
  4915     GO TO 99999-RETURN.
  4916
  4917 12000-CHECK-MONTANA.
  4918
  4919     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4920        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4921        (M GREATER THAN +63) AND
  4922        (CP-EARN-AS-NET-PAY)
  4923        NEXT SENTENCE
  4924     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  91
* ELRATE.cbl
  4925        GO TO 12001-CONTINUE-NCL-TRUNC.
  4926
  4927      COMPUTE ANGLEN EQUAL WK1 / I.
  4928
  4929      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4930
  4931      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4932       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4933       (((N - ANGLEN) / I) + (4 * N)).
  4934
  4935      MOVE WK3 TO CP-CALC-PREMIUM.
  4936
  4937     GO TO 99999-RETURN.
  4938
  4939 12001-CONTINUE-NCL-TRUNC.
  4940
  4941     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4942        (CP-EARN-AS-NET-PAY) AND
  4943        (CP-TRUNCATED-LIFE)
  4944        NEXT SENTENCE
  4945     ELSE
  4946        GO TO 12001-CONTINUE-NCL.
  4947
  4948      COMPUTE ANGLEN EQUAL WK1 / I.
  4949      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4950
  4951      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4952
  4953      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  4954      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  4955      (ANGLEN-1 * (N + 1) * I).
  4956
  4957      MOVE WK3 TO CP-CALC-PREMIUM.
  4958
  4959     GO TO 99999-RETURN.
  4960
  4961 12001-CONTINUE-NCL.
  4962
  4963     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4964        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4965        (CP-EARN-AS-NET-PAY)
  4966        GO TO 12001-CHECK-NC-NET-PLUS3.
  4967
  4968     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4969        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4970        (CP-EARN-AS-NET-PAY)
  4971        GO TO 12001-CHECK-CA.
  4972
  4973     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4974        (CP-EARN-AS-NET-PAY)
  4975        NEXT SENTENCE
  4976     ELSE
  4977        GO TO 12000-CONTINUE-NET.
  4978
  4979      COMPUTE ANGLEN EQUAL WK1 / I.
  4980      MOVE ANGLEN                TO ANGLEN-1.
  4981
  4982      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  92
* ELRATE.cbl
  4983
  4984      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4985       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4986       ((N - ANGLEN) / I).
  4987
  4988      MOVE WK3 TO CP-CALC-PREMIUM.
  4989
  4990     GO TO 99999-RETURN.
  4991
  4992 12000-CONTINUE-NET.
  4993
  4994     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  4995        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  4996        (CP-EARN-AS-NET-PAY)
  4997        NEXT SENTENCE
  4998     ELSE
  4999        GO TO 12001-CONTINUE-MINN.
  5000
  5001      COMPUTE ANGLEN EQUAL WK6 / I.
  5002      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  5003
  5004      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  5005      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  5006      COMPUTE WK3 EQUAL (WK3 / I) *
  5007       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  5008
  5009      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  5010         MOVE +0 TO CP-R-MAX-TOT-BEN.
  5011
  5012      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  5013
  5014      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  5015         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  5016         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  5017
  5018      MOVE WK3 TO CP-CALC-PREMIUM.
  5019
  5020     GO TO 99999-RETURN.
  5021
  5022 12001-CONTINUE-MINN.
  5023
  5024     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  5025        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  5026        (CP-TRUNCATED-LIFE)
  5027        NEXT SENTENCE
  5028     ELSE
  5029        GO TO 12001-CHECK-RI-GTL.
  5030
  5031      COMPUTE ANGLEN EQUAL WK1 / I.
  5032      COMPUTE ANGLEM EQUAL WK2 / I.
  5033
  5034      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  5035       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  5036       * M / 2400) * 1000 + .5) / 1000000.
  5037
  5038      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
  5039       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  5040
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  93
* ELRATE.cbl
  5041     GO TO 99999-RETURN.
  5042
  5043 12001-CHECK-RI-GTL.
  5044
  5045     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  5046        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  5047        (CP-EARN-AS-NET-PAY)
  5048        NEXT SENTENCE
  5049     ELSE
  5050        GO TO 12001-CHECK-RI-LEASE-GTL.
  5051
  5052      COMPUTE ANGLEN EQUAL WK1 / I.
  5053*     COMPUTE ANGLEM EQUAL WK2 / I.
  5054
  5055      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  5056               (1 + WS-WORK-DIS-RATE * N).
  5057      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  5058         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  5059
  5060
  5061     GO TO 99999-RETURN.
  5062
  5063 12001-CHECK-RI-LEASE-GTL.
  5064
  5065     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  5066        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  5067        (CP-SPECIAL-CALC-CD EQUAL 'H')
  5068        NEXT SENTENCE
  5069     ELSE
  5070        GO TO 12001-CHECK-OR-GTL.
  5071
  5072     COMPUTE ANGLEN EQUAL WK1 / I.
  5073
  5074     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  5075        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
  5076                        /
  5077        (1000 * I * (1 + .0021 * N)).
  5078     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  5079       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  5080                            /
  5081       (1000 * (1 + .0027 * (N + 1))).
  5082
  5083     GO TO 99999-RETURN.
  5084
  5085 12001-CHECK-OR-GTL.
  5086
  5087     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  5088        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  5089        (CP-EARN-AS-NET-PAY)
  5090        NEXT SENTENCE
  5091     ELSE
  5092        GO TO 12001-CHECK-GA-GTL.
  5093
  5094     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5095     COMPUTE ANGLEN EQUAL WK1 / I.
  5096
  5097     IF M LESS THAN +64
  5098        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  94
* ELRATE.cbl
  5099         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  5100                   /
  5101         (I * ANGLEN * (N - (N - M) + 1) * 600)
  5102        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  5103     ELSE
  5104        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  5105        CP-PREMIUM-RATE * (1 + I))
  5106                  /
  5107        (+1000 * I * ANGLEN)
  5108        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  5109*    MOVE WK3 TO CP-CALC-PREMIUM.
  5110     GO TO 99999-RETURN.
  5111
  5112 12001-CHECK-GA-GTL.
  5113
  5114     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  5115        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  5116        (CP-EARN-AS-NET-PAY)
  5117*       (CP-TRUNCATED-LIFE)
  5118        NEXT SENTENCE
  5119     ELSE
  5120        GO TO 12001-CHECK-MA-GTL.
  5121
  5122     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5123     COMPUTE ANGLEN EQUAL WK1 / I.
  5124
  5125     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  5126     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  5127      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  5128     MOVE WK3 TO CP-CALC-PREMIUM.
  5129
  5130     GO TO 99999-RETURN.
  5131
  5132 12001-CHECK-MA-GTL.
  5133
  5134     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  5135        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  5136        (CP-EARN-AS-NET-PAY) AND
  5137        (CP-SPECIAL-CALC-CD EQUAL 'H')
  5138        NEXT SENTENCE
  5139     ELSE
  5140        GO TO 12001-CHECK-NV-NET.
  5141
  5142     COMPUTE ANGLEN EQUAL WK1 / I.
  5143
  5144     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  5145      CP-ALTERNATE-BENEFIT * N.
  5146
  5147     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  5148     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  5149
  5150     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  5151     WK7 * (N - ANGLEN) / I.
  5152     MOVE WK3 TO CP-CALC-PREMIUM.
  5153
  5154     GO TO 99999-RETURN.
  5155
  5156 12001-CHECK-NV-NET.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  95
* ELRATE.cbl
  5157     IF (CP-COMPANY-ID EQUAL 'CID')
  5158        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  5159        AND (CP-EARN-AS-NET-PAY)
  5160        CONTINUE
  5161     ELSE
  5162        GO TO 12001-CHECK-MN-NET
  5163     END-IF
  5164     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  5165     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  5166     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  5167                   / (1 + I)
  5168     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5169     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5170     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5171        (CP-PREMIUM-RATE * K-I / 1000)
  5172     MOVE WK3                    TO CP-CALC-PREMIUM
  5173     GO TO 99999-RETURN
  5174      .
  5175 12001-CHECK-MN-NET.
  5176     IF (CP-COMPANY-ID EQUAL 'CID')
  5177        AND (CP-STATE-STD-ABBRV = 'MN')
  5178        AND (CP-EARN-AS-NET-PAY)
  5179        AND (NOT CP-LEVEL-LIFE)
  5180        AND (WS-DISCOUNT-OPTION = '1')
  5181        CONTINUE
  5182     ELSE
  5183        GO TO 12001-CHECK-NC-NET
  5184     END-IF
  5185     if i = .0000000001
  5186        compute wk4 = cp-original-benefit / n
  5187        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  5188           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  5189        move wk3 to cp-calc-premium
  5190        go to 99999-return
  5191     end-if
  5192     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  5193     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  5194     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  5195                   / (1 + I)
  5196     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5197     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5198     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5199        (CP-PREMIUM-RATE / 1000) * (1 + I)
  5200     MOVE WK3                    TO CP-CALC-PREMIUM
  5201     GO TO 99999-RETURN
  5202      .
  5203 12001-CHECK-NC-NET.
  5204
  5205     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  5206        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  5207        (CP-EARN-AS-NET-PAY)
  5208        NEXT SENTENCE
  5209     ELSE
  5210        GO TO 12001-CHECK-NC-NET-PLUS3.
  5211
  5212      COMPUTE ANGLEN EQUAL WK1 / I.
  5213      COMPUTE ANGLEN-M EQUAL WK5 / I.
  5214
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  96
* ELRATE.cbl
  5215      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  5216          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  5217          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  5218          N * (CP-PREMIUM-RATE / 1000)).
  5219
  5220      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  5221          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  5222
  5223      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  5224          ((N - ANGLEN) / I + 3) / ANGLEN) /
  5225          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  5226          (ANGLEN * 2))
  5227
  5228      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  5229
  5230      IF ANGLEN IS NOT LESS THAN WK7
  5231          COMPUTE CP-PREMIUM-RATE ROUNDED =
  5232              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  5233          COMPUTE WK3 ROUNDED =
  5234              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  5235
  5236     MOVE WK3 TO CP-CALC-PREMIUM.
  5237
  5238     GO TO 99999-RETURN.
  5239
  5240 12001-CHECK-NC-NET-PLUS3.
  5241
  5242     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  5243        (CP-EARN-AS-NET-PAY) AND
  5244        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL' AND 'VPP')
  5245        NEXT SENTENCE
  5246     ELSE
  5247        GO TO 12001-CHECK-CA.
  5248
  5249     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  5250     MOVE ' ' TO DC-OPTION-CODE.
  5251     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  5252
  5253     IF DATE-CONVERSION-ERROR
  5254        MOVE '2'                 TO CP-RETURN-CODE
  5255        MOVE ZEROS               TO FACTOR
  5256                                    CP-CALC-PREMIUM
  5257         GO TO 99999-RETURN.
  5258
  5259     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  5260        NEXT SENTENCE
  5261     ELSE
  5262        GO TO 12001-CONTINUE-NET.
  5263
  5264     COMPUTE ANGLEN EQUAL WK1 / I.
  5265     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5266
  5267     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  5268
  5269     COMPUTE NC-R = 20 *
  5270                    ((NC-LR * ORIGINAL-TERM) / 12)
  5271                          / (ORIGINAL-TERM + 1).
  5272
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  97
* ELRATE.cbl
  5273     COMPUTE NC-OB = NC-R / 1000.
  5274
  5275     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  5276                    (NC-OB * ORIGINAL-TERM * 3).
  5277
  5278     IF CP-EXT-CHG-LF
  5279         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  5280     ELSE
  5281         MOVE 30                 TO  NC-BIG-D.
  5282
  5283     COMPUTE NC-LITTLE-D = (1 + I) /
  5284             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  5285
  5286     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  5287             (ANGLEN * NC-LITTLE-D ).
  5288
  5289     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  5290
  5291     GO TO 99999-RETURN.
  5292
  5293 12001-CHECK-CA.
  5294
  5295     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5296        (WS-DISCOUNT-OPTION = '6')
  5297        NEXT SENTENCE
  5298     ELSE
  5299        GO TO 12001-CHECK-GTL-IA.
  5300
  5301     COMPUTE CA-J = CA-DISCOUNT / 12.
  5302     COMPUTE ANGLEN EQUAL WK1 / I.
  5303     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  5304     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  5305     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  5306     COMPUTE CA-VI = (1 + I)** -1.
  5307     COMPUTE CP-CALC-PREMIUM =
  5308         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  5309         ((1 + CA-J) / I) *
  5310         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  5311         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  5312         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  5313
  5314     GO TO 99999-RETURN.
  5315
  5316 12001-CHECK-GTL-IA.
  5317
  5318     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  5319        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  5320        (CP-EARN-AS-NET-PAY)
  5321        NEXT SENTENCE
  5322     ELSE
  5323        GO TO 12001-CHECK-CID-TRN-VA.
  5324
  5325***************************************************************
  5326
  5327     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  5328
  5329     IF GTL-IA-ODD-DAYS = ZEROS
  5330         MOVE ZERO               TO  GTL-IA-SGN
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  98
* ELRATE.cbl
  5331     ELSE
  5332         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  5333             MOVE +1             TO  GTL-IA-SGN
  5334         ELSE
  5335             MOVE -1             TO  GTL-IA-SGN.
  5336
  5337     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  5338     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  5339
  5340     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  5341                          GTL-IA-SGN.
  5342
  5343     COMPUTE ANGLEN EQUAL WK1 / I.
  5344     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5345
  5346     IF GTL-IA-ODF NOT = ZERO
  5347         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  5348         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  5349
  5350     COMPUTE GTL-IA-DIVIDEND =
  5351           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  5352                             (ANGLEN - ANGLEN-M))) *
  5353           ((K1 + I) * CP-PREMIUM-RATE *
  5354                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  5355
  5356     COMPUTE GTL-IA-DIVISOR =
  5357      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  5358
  5359     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  5360
  5361     COMPUTE CP-CALC-PREMIUM =
  5362                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  5363     GO TO 99999-RETURN.
  5364
  5365
  5366 12001-CHECK-CID-TRN-VA.
  5367
  5368     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5369        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  5370        (CP-EARN-AS-NET-PAY) AND
  5371        (CP-TRUNCATED-LIFE) AND
  5372        (CP-STATE-STD-ABBRV = CP-STATE)
  5373        CONTINUE
  5374     ELSE
  5375        GO TO 12001-CHECK-CID-TX
  5376     END-IF
  5377
  5378     COMPUTE ANGLEN EQUAL WK1 / I
  5379     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5380     IF WS-WORK-DIS-RATE = ZEROS
  5381        CONTINUE
  5382     ELSE
  5383        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5384        COMPUTE WK7 = (1 / I) *
  5385              (((WK4 ** M - 1) / (WK4 - 1)) -
  5386              ((WK4 ** M * SX - VX) /
  5387              (WK4 * (1 + I) - 1))) *
  5388              (CP-PREMIUM-RATE / 1000)
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page  99
* ELRATE.cbl
  5389        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5390        COMPUTE WK8 = WK7 * 100 / ANGLEN
  5391        COMPUTE CP-CALC-PREMIUM =
  5392           WK8 *  ((WK4 * ANGLEN) / 100)
  5393     END-IF
  5394
  5395     GO TO 99999-RETURN
  5396
  5397     .
  5398
  5399 12001-CHECK-CID-TX.
  5400     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5401        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  5402        (CP-EARN-AS-NET-PAY) AND
  5403        (WS-WORK-DIS-RATE > ZEROS) AND
  5404        (CP-STATE-STD-ABBRV = CP-STATE)
  5405        CONTINUE
  5406     ELSE
  5407        GO TO 12001-CHECK-CID-LEV-MN-NEW
  5408     END-IF
  5409* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  5410     COMPUTE K-I = 1 + (1 * I)
  5411     COMPUTE ANGLEN EQUAL WK1 / I
  5412     COMPUTE ANGLEM EQUAL WK2 / I
  5413     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5414     IF WS-WORK-DIS-RATE = ZEROS
  5415        CONTINUE
  5416     ELSE
  5417        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5418        COMPUTE WK7 = (K-I / I) *
  5419              (((WK4 ** M - 1) / (WK4 - 1)) -
  5420*             ((WK4 ** M * SX - VX) /
  5421              ((WK4 ** M * SX) - VX) /
  5422*             (WK4 * (1 + I) - 1))) *
  5423              (WK4 * (1 + I) - 1)) *
  5424              (CP-PREMIUM-RATE / 1000)
  5425        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5426        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  5427        COMPUTE CP-CALC-PREMIUM =
  5428           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  5429     END-IF
  5430
  5431     GO TO 99999-RETURN
  5432     .
  5433 12001-CHECK-CID-LEV-MN-NEW.
  5434*    IF (CP-COMPANY-ID EQUAL 'CID')
  5435*       AND (CP-STATE-STD-ABBRV = 'MN')
  5436*       AND (CP-EARN-AS-NET-PAY)
  5437*       AND (CP-LEVEL-LIFE)
  5438*       AND (CP-CERT-EFF-DT > X'A4FF')
  5439*       CONTINUE
  5440*    ELSE
  5441*       GO TO 12001-CHECK-CID-LEV-MN
  5442*    END-IF
  5443*
  5444*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5445*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  5446*    MOVE '1'                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page 100
* ELRATE.cbl
  5447*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  5448*
  5449*    IF DATE-CONVERSION-ERROR
  5450*       MOVE '2'                 TO CP-RETURN-CODE
  5451*       MOVE ZEROS               TO FACTOR
  5452*                                   CP-CALC-PREMIUM
  5453*       GO TO 99999-RETURN
  5454*    END-IF
  5455*
  5456*    COMPUTE I = CP-LOAN-APR / 100
  5457*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  5458*
  5459*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  5460*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  5461*      * 12 / 360 * D)
  5462*
  5463*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  5464*       * 12 / 360 * D
  5465*
  5466*    GO TO 99999-RETURN
  5467      .
  5468 12001-CHECK-CID-LEV-MN.
  5469
  5470     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5471        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  5472        (CP-EARN-AS-NET-PAY) AND
  5473        (CP-LEVEL-LIFE) AND
  5474        (CP-STATE-STD-ABBRV = CP-STATE)
  5475        CONTINUE
  5476     ELSE
  5477        GO TO 12001-CHECK-CID-LEV-CA
  5478     END-IF
  5479
  5480     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  5481         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  5482         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  5483
  5484     GO TO 99999-RETURN
  5485
  5486      .
  5487 12001-CHECK-CID-LEV-CA.
  5488
  5489     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5490        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5491        (CP-EARN-AS-NET-PAY) AND
  5492        (CP-LEVEL-LIFE) AND
  5493        (CP-STATE-STD-ABBRV = CP-STATE)
  5494        CONTINUE
  5495     ELSE
  5496        GO TO 12001-CHECK-CID-TRN-CA
  5497     END-IF
  5498
  5499     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  5500     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  5501     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  5502     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  5503     COMPUTE CP-CALC-PREMIUM =
  5504          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page 101
* ELRATE.cbl
  5505          (CP-PREMIUM-RATE / 1000)) /
  5506          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  5507
  5508     GO TO 99999-RETURN
  5509
  5510      .
  5511 12001-CHECK-CID-TRN-CA.
  5512
  5513     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5514        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5515        (CP-EARN-AS-NET-PAY) AND
  5516        (CP-TRUNCATED-LIFE) AND
  5517        (CP-STATE-STD-ABBRV = CP-STATE) AND
  5518        (WS-DISCOUNT-OPTION NOT = ' ')
  5519        CONTINUE
  5520     ELSE
  5521        GO TO 12001-CHECK-CID-TRN-MT
  5522     END-IF
  5523
  5524     COMPUTE ANGLEN EQUAL WK1 / I
  5525     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5526     IF WS-WORK-DIS-RATE = ZEROS
  5527        CONTINUE
  5528     ELSE
  5529        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5530        COMPUTE WK7 = (1 / I) *
  5531              (((WK4 ** M - 1) / (WK4 - 1)) -
  5532              ((WK4 ** M * SX - VX) /
  5533              (WK4 * (1 + I) - 1))) *
  5534              (CP-PREMIUM-RATE / 1000)
  5535        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5536        COMPUTE CP-CALC-PREMIUM =
  5537           WK4 *  WK7
  5538     END-IF
  5539
  5540     GO TO 99999-RETURN
  5541
  5542      .
  5543 12001-CHECK-CID-TRN-MT.
  5544
  5545     IF (CP-COMPANY-ID EQUAL 'CID') AND
  5546        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  5547                   OR
  5548        ((CP-STATE-STD-ABBRV = 'IN') AND
  5549        (CP-CERT-EFF-DT > X'9A7F'))
  5550                   OR
  5551        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5552        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5553        (CP-EARN-AS-NET-PAY) AND
  5554        (CP-TRUNCATED-LIFE) AND
  5555        (CP-STATE-STD-ABBRV = CP-STATE)
  5556        CONTINUE
  5557     ELSE
  5558        GO TO 12001-CHECK-CID-MT
  5559     END-IF
  5560
  5561* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5562     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page 102
* ELRATE.cbl
  5563        MOVE 0                   TO K-I
  5564     ELSE
  5565        MOVE 2                   TO K-I
  5566     END-IF
  5567     COMPUTE CP-TERM-OR-EXT-DAYS =
  5568           CP-TERM-OR-EXT-DAYS + 30
  5569
  5570     COMPUTE ANGLEN EQUAL WK1 / I
  5571     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5572     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5573                   / (1 + I)
  5574     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5575     IF WS-WORK-DIS-RATE = ZEROS
  5576        CONTINUE
  5577     ELSE
  5578        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5579*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5580        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5581              (((WK4 ** M - 1) / (WK4 - 1)) -
  5582              ((WK4 ** M * SX - VX) /
  5583              (WK4 * (1 + I) - 1))) *
  5584              (CP-PREMIUM-RATE / 1000)
  5585        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5586*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5587        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5588        COMPUTE CP-CALC-PREMIUM =
  5589           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5590*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5591     END-IF
  5592
  5593     GO TO 99999-RETURN
  5594
  5595     .
  5596 12001-CHECK-CID-MT.
  5597
  5598     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5599        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  5600                                OR 'VT')
  5601                   OR
  5602        ((CP-STATE-STD-ABBRV = 'IN') AND
  5603        (CP-CERT-EFF-DT > X'9A7F'))
  5604                   OR
  5605        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5606        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5607        (CP-EARN-AS-NET-PAY) AND
  5608        (CP-STATE-STD-ABBRV = CP-STATE)
  5609        CONTINUE
  5610     ELSE
  5611        GO TO 12001-CHECK-DCC-DD
  5612     END-IF
  5613
  5614     COMPUTE CP-TERM-OR-EXT-DAYS =
  5615           CP-TERM-OR-EXT-DAYS + 30
  5616
  5617* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5618     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5619        MOVE 0                   TO K-I
  5620     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page 103
* ELRATE.cbl
  5621        IF CP-STATE-STD-ABBRV = 'NJ'
  5622           MOVE 1                TO K-I
  5623        ELSE
  5624           MOVE 2                TO K-I
  5625        END-IF
  5626     END-IF
  5627     COMPUTE ANGLEN EQUAL WK1 / I
  5628     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5629     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5630                   / (1 + I)
  5631     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5632     IF WS-WORK-DIS-RATE = ZEROS
  5633        CONTINUE
  5634     ELSE
  5635        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5636*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5637        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5638              (((WK4 ** N - 1) / (WK4 - 1)) -
  5639              ((WK4 ** N - SV) /
  5640              (WK4 * (1 + I) - 1))) *
  5641              (CP-PREMIUM-RATE / 1000)
  5642        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5643*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5644        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5645        COMPUTE CP-CALC-PREMIUM =
  5646           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5647*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5648     END-IF
  5649
  5650     GO TO 99999-RETURN
  5651
  5652     .
  5653 12001-CHECK-DCC-DD.
  5654     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5655        AND (CP-EARN-AS-NET-PAY)
  5656        AND (CP-BEN-CATEGORY = 'D')
  5657        CONTINUE
  5658     ELSE
  5659        GO TO 12001-CHECK-DCC-NET
  5660     END-IF
  5661
  5662     COMPUTE CP-TERM-OR-EXT-DAYS =
  5663           CP-TERM-OR-EXT-DAYS + 30
  5664
  5665     COMPUTE ANGLEN EQUAL WK1 / I.
  5666     COMPUTE ANGLEM EQUAL WK2 / I.
  5667     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5668
  5669     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5670           / (1 + I)
  5671     COMPUTE GR     = ANGLEN / ODF
  5672*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  5673*      CP-RATE-DEV-PCT
  5674     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5675     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5676       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5677     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5678     MOVE WK3                    TO CP-CALC-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page 104
* ELRATE.cbl
  5679
  5680     GO TO 99999-RETURN
  5681
  5682     .
  5683 12001-CHECK-DCC-NET.
  5684
  5685     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5686        AND (CP-EARN-AS-NET-PAY)
  5687        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  5688             AND 'H' AND 'S' AND 'P')
  5689        CONTINUE
  5690     ELSE
  5691        GO TO 12001-CHECK-DCC-PNET
  5692     END-IF
  5693
  5694     COMPUTE CP-TERM-OR-EXT-DAYS =
  5695           CP-TERM-OR-EXT-DAYS + 30
  5696
  5697     COMPUTE ANGLEN EQUAL WK1 / I.
  5698     COMPUTE ANGLEM EQUAL WK2 / I.
  5699     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5700
  5701     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5702           / (1 + I)
  5703     COMPUTE GR     = ANGLEN / ODF
  5704     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5705     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5706       CP-RATE-DEV-PCT
  5707     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5708*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5709
  5710     COMPUTE WK8 = CP-PREMIUM-RATE *
  5711        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  5712     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5713     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5714     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5715       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5716     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5717     MOVE WK3                    TO CP-CALC-PREMIUM
  5718
  5719     GO TO 99999-RETURN
  5720
  5721     .
  5722 12001-CHECK-DCC-PNET.
  5723     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5724        AND (CP-EARN-AS-NET-PAY)
  5725        AND (CP-BENEFIT-CD (1:1) = 'P')
  5726        CONTINUE
  5727     ELSE
  5728        GO TO 12001-CHECK-DCC-MNET
  5729     END-IF
  5730     IF CP-NO-OF-PMTS NOT NUMERIC
  5731        MOVE +0                  TO CP-NO-OF-PMTS
  5732     END-IF
  5733     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  5734        AND ' ' AND 'M'
  5735        MOVE ' '                 TO CP-PMT-MODE
  5736     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page 105
* ELRATE.cbl
  5737******************************************************************
  5738***   Default is monthly, use loan term for rate and amort     ***
  5739******************************************************************
  5740     move cp-loan-term         to c-tot-pmts
  5741     MOVE +30                  TO C-DAYS-IN-PMT-PER
  5742     MOVE +12                  TO C-PMTS-PER-YEAR
  5743******************************************************************
  5744
  5745     evaluate true
  5746        when cp-pmt-mode = 'W'
  5747           MOVE +52              TO C-PMTS-PER-YEAR
  5748           compute c-tot-pmts = cp-loan-term /
  5749              12 * c-pmts-per-year
  5750           MOVE +7               TO C-DAYS-IN-PMT-PER
  5751        when cp-pmt-mode = 'B'
  5752           MOVE +26              TO C-PMTS-PER-YEAR
  5753           compute c-tot-pmts = cp-loan-term /
  5754              12 * c-pmts-per-year
  5755           MOVE +14              TO C-DAYS-IN-PMT-PER
  5756     end-evaluate
  5757     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  5758     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  5759        C-DAYS-IN-PMT-PER)) / (1 + I)
  5760     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  5761*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  5762     COMPUTE ANGLEN-1 = ANGLEN / Y
  5763     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5764     IF CP-RATE-DEV-PCT NOT = ZEROS
  5765        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5766           CP-PREMIUM-RATE
  5767     END-IF
  5768     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  5769     GO TO 99999-RETURN
  5770     .
  5771 12001-CHECK-DCC-MNET.
  5772
  5773     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5774        AND (CP-EARN-AS-NET-PAY)
  5775        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5776        CONTINUE
  5777     ELSE
  5778        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  5779     END-IF
  5780
  5781*    COMPUTE ANGLEN EQUAL WK1 / I.
  5782*    COMPUTE ANGLEM EQUAL WK2 / I.
  5783*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  5784
  5785     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  5786     MOVE WK3                    TO CP-CALC-PREMIUM
  5787
  5788     GO TO 99999-RETURN
  5789
  5790     .
  5791 12001-CHECK-DCC-MNET-LF-BAL.
  5792
  5793     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5794        AND (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page 106
* ELRATE.cbl
  5795        AND (CP-BENEFIT-CD (1:1) = 'N')
  5796        AND (CP-BEN-CATEGORY NOT = 'N')
  5797        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5798        CONTINUE
  5799     ELSE
  5800        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5801     END-IF
  5802
  5803     IF CP-RATE-DEV-PCT NOT = ZEROS
  5804        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5805           CP-PREMIUM-RATE
  5806     END-IF
  5807*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5808     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5809        / (1 + I)
  5810     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5811     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5812     COMPUTE WK2 = (1 + J) ** (M * -1)
  5813     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5814     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5815          ** ((M - 1) * -1))) / J)
  5816     COMPUTE ANGLEM = ((1 - ((1 + J)
  5817          ** (M * -1))) / J) / OD
  5818     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5819        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5820        / ANGLEM-1
  5821     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5822          ** ((N - M) * -1))) / I)
  5823     MOVE +0                     TO WK3
  5824     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5825        (WS-COUNTER > M)
  5826        COMPUTE ANGLEM = (1 - ((1 + J)
  5827          ** ((M - WS-COUNTER) * -1))) / J
  5828        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5829        COMPUTE WK5-CSL = (RA * ANGLEM)
  5830        + (CP-ALTERNATE-BENEFIT * WK2)
  5831        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5832     END-PERFORM
  5833     MOVE WK3                    TO CP-CALC-PREMIUM
  5834
  5835     GO TO 99999-RETURN
  5836
  5837     .
  5838 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5839
  5840     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5841        AND (CP-EARN-AS-NET-PAY)
  5842        AND (CP-BENEFIT-CD (1:1) = 'S')
  5843        AND (CP-BEN-CATEGORY NOT = 'N')
  5844        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5845        CONTINUE
  5846     ELSE
  5847        GO TO 12001-CHECK-DCC-MNET-LF
  5848     END-IF
  5849
  5850     IF CP-RATE-DEV-PCT NOT = ZEROS
  5851        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5852           CP-PREMIUM-RATE
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page 107
* ELRATE.cbl
  5853     END-IF
  5854     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5855     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5856          ** ((M - 1) * -1))) / K)
  5857     COMPUTE ANGLEM = ((1 - ((1 + K)
  5858          ** (M * -1))) / K)
  5859     MOVE CP-MONTHLY-PAYMENT     TO RA
  5860     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5861        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  5862        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5863        CP-PREMIUM-RATE / 1000
  5864     MOVE WK3                    TO CP-CALC-PREMIUM
  5865
  5866     GO TO 99999-RETURN
  5867
  5868     .
  5869 12001-CHECK-DCC-MNET-LF.
  5870
  5871     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5872        AND (CP-EARN-AS-NET-PAY)
  5873        AND (CP-BENEFIT-CD (1:1) = 'N')
  5874        AND (CP-BEN-CATEGORY NOT = 'N')
  5875        CONTINUE
  5876     ELSE
  5877        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5878     END-IF
  5879
  5880     IF CP-RATE-DEV-PCT NOT = ZEROS
  5881        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5882           CP-PREMIUM-RATE
  5883     END-IF
  5884*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5885     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5886        / (1 + I)
  5887     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5888     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5889     COMPUTE WK2 = (1 + J) ** (M * -1)
  5890     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5891     COMPUTE ANGLEM = ((1 - ((1 + J)
  5892          ** (M * -1))) / J) / OD
  5893     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5894     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5895          ** ((N - M) * -1))) / I)
  5896     MOVE +0                     TO WK3
  5897     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5898        (WS-COUNTER > M)
  5899        COMPUTE ANGLEM = (1 - ((1 + J)
  5900          ** ((M - WS-COUNTER + 1) * -1))) / J
  5901        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5902        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5903        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5904     END-PERFORM
  5905     MOVE WK3                    TO CP-CALC-PREMIUM
  5906
  5907     GO TO 99999-RETURN
  5908
  5909     .
  5910 12001-CHECK-DCC-MNET-SUMLF.
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page 108
* ELRATE.cbl
  5911
  5912     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5913        AND (CP-EARN-AS-NET-PAY)
  5914        AND (CP-BENEFIT-CD (1:1) = 'S')
  5915        AND (CP-BEN-CATEGORY NOT = 'N')
  5916        CONTINUE
  5917     ELSE
  5918        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  5919     END-IF
  5920
  5921     IF CP-RATE-DEV-PCT NOT = ZEROS
  5922        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5923           CP-PREMIUM-RATE
  5924     END-IF
  5925     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5926     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5927        / (1 + K)
  5928     COMPUTE ANGLEN-M = (WK5 / I)
  5929     COMPUTE WK2 = (1 + K) ** (M * -1)
  5930     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5931     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5932     COMPUTE ANGLEM = ((1 - ((1 + K)
  5933          ** (M * -1))) / K) / Y
  5934     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5935     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  5936        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5937        - 1)) / K) * RA
  5938     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5939        + (CP-DAYS-TO-1ST-PMT - +30)
  5940        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5941        +0 / 1000 * 12 / 12)
  5942     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  5943        * (12 / 12)
  5944     MOVE WK3                    TO CP-CALC-PREMIUM
  5945
  5946     GO TO 99999-RETURN
  5947
  5948     .
  5949 12001-CHECK-DCC-MNET-TOT-BAL-N.
  5950
  5951     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5952        AND (CP-EARN-AS-NET-PAY)
  5953        AND (CP-BENEFIT-CD (1:1) = 'N')
  5954        AND (CP-BEN-CATEGORY = 'N')
  5955        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5956        CONTINUE
  5957     ELSE
  5958        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5959     END-IF
  5960
  5961*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5962     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5963        / (1 + I)
  5964     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5965     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5966     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5967     COMPUTE WK2 = (1 + J) ** (M * -1)
  5968     COMPUTE ANGLEN-M = ANGLEN-M * WK2
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page 109
* ELRATE.cbl
  5969     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5970          ** ((M - 1) * -1))) / J)
  5971     COMPUTE ANGLEM = ((1 - ((1 + J)
  5972          ** (M * -1))) / J) / OD
  5973     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5974        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5975        / ANGLEM-1
  5976     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5977          ** ((N - M) * -1))) / I)
  5978     MOVE +0                     TO WK3
  5979     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5980        (WS-COUNTER > M)
  5981        COMPUTE ANGLEM = (1 - ((1 + J)
  5982          ** ((M - WS-COUNTER) * -1))) / J
  5983        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  5984        COMPUTE WK5-CSL = (RA * ANGLEM)
  5985        + (CP-ALTERNATE-BENEFIT * WK2)
  5986        COMPUTE WK3 = WK3 +
  5987         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  5988        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  5989          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  5990          (CP-DCC-AH-RATE / 1000)
  5991     END-PERFORM
  5992     MOVE WK3                    TO CP-CALC-PREMIUM
  5993
  5994     GO TO 99999-RETURN
  5995
  5996     .
  5997 12001-CHECK-DCC-MNET-TOT-BAL-S.
  5998
  5999     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  6000        AND (CP-EARN-AS-NET-PAY)
  6001        AND (CP-BENEFIT-CD (1:1) = 'S')
  6002        AND (CP-BEN-CATEGORY = 'N')
  6003        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  6004        CONTINUE
  6005     ELSE
  6006        GO TO 12001-CHECK-DCC-MNET-TOT-N
  6007     END-IF
  6008
  6009     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  6010     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  6011          ** ((M - 1) * -1))) / K)
  6012     COMPUTE ANGLEM = ((1 - ((1 + K)
  6013          ** (M * -1))) / K)
  6014     MOVE CP-MONTHLY-PAYMENT     TO RA
  6015     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  6016        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  6017        * CP-DCC-AH-RATE / 1000))
  6018        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  6019        CP-DCC-LF-RATE / 1000
  6020     MOVE WK3                    TO CP-LF-PREM
  6021     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  6022        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  6023        * CP-DCC-AH-RATE / 1000
  6024     COMPUTE WK3 = WK3 + WK5-CSL
  6025     MOVE WK3                    TO CP-CALC-PREMIUM
  6026
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page 110
* ELRATE.cbl
  6027     GO TO 99999-RETURN
  6028      .
  6029 12001-CHECK-DCC-MNET-TOT-N.
  6030
  6031     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  6032        AND (CP-EARN-AS-NET-PAY)
  6033        AND (CP-BENEFIT-CD (1:1) = 'N')
  6034        AND (CP-BEN-CATEGORY = 'N')
  6035        CONTINUE
  6036     ELSE
  6037        GO TO 12001-CHECK-DCC-MNET-TOT-S
  6038     END-IF
  6039
  6040*    I = APR/1200
  6041*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  6042*    RA = PAYMENT AMOUNT
  6043*    WK5-CSL = THE BALANCE (PAY OFF )
  6044*    WK3 = THE ACCUMULATED PREMIUM
  6045*    WK2 = (1 + I) ^ (m * -1)
  6046*    OD  = GAMMA
  6047*
  6048*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  6049     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  6050        / (1 + I)
  6051     COMPUTE ANGLEN-M = (WK5 / I) / OD
  6052     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  6053        (CP-DCC-AH-RATE / +1000)
  6054     COMPUTE WK2 = (1 + J) ** (M * -1)
  6055     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  6056     COMPUTE ANGLEM = ((1 - ((1 + J)
  6057          ** (M * -1))) / J) / OD
  6058     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  6059     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6060          ** ((N - M) * -1))) / I)
  6061     MOVE +0                     TO WK3
  6062     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  6063        (WS-COUNTER > M)
  6064        COMPUTE ANGLEM = (1 - ((1 + J)
  6065          ** ((M - WS-COUNTER + 1) * -1))) / J
  6066        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  6067        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  6068        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  6069           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  6070     END-PERFORM
  6071     MOVE WK3                    TO CP-CALC-PREMIUM
  6072
  6073     GO TO 99999-RETURN
  6074
  6075     .
  6076 12001-CHECK-DCC-MNET-TOT-S.
  6077
  6078     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  6079        AND (CP-EARN-AS-NET-PAY)
  6080        AND (CP-BENEFIT-CD (1:1) = 'S')
  6081        AND (CP-BEN-CATEGORY = 'N')
  6082        CONTINUE
  6083     ELSE
  6084        GO TO 12001-CONTINUE-NET
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page 111
* ELRATE.cbl
  6085     END-IF
  6086
  6087*    I = APR/1200
  6088*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  6089*    RA = PAYMENT AMOUNT
  6090*    WK5-CSL = THE BALANCE (PAY OFF )
  6091*    WK3 = THE ACCUMULATED PREMIUM
  6092*    WK2 = (1 + I) ^ (m * -1)
  6093*    OD  = GAMMA
  6094*
  6095     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  6096     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  6097        / (1 + J)
  6098     COMPUTE ANGLEM = ((1 - ((1 + J)
  6099          ** (M * -1))) / J) / OD
  6100     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6101          ** ((N - M) * -1))) / I)
  6102          * (1 + J) ** (-1 * M)
  6103     COMPUTE ANGLEN-M = ANGLEN-M / OD
  6104     MOVE CP-MONTHLY-PAYMENT     TO RA
  6105     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  6106        / +30)
  6107     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  6108        ** (WK1) - 1)) / J) * RA
  6109     COMPUTE WK5 = (((((M * (M + 1) / 2)
  6110        + (CP-DAYS-TO-1ST-PMT - +30)
  6111        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  6112        CP-DCC-AH-RATE / +1000 * 12 / 12)
  6113     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  6114        (12 / 12)
  6115     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  6116        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  6117        (CP-DCC-AH-RATE / +1000) * 12 / 12
  6118     COMPUTE WK3 = WK3 + WK5-CSL
  6119     MOVE WK3                    TO CP-CALC-PREMIUM
  6120     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  6121     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  6122        / (1 + K)
  6123     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6124          ** ((N - M) * -1))) / I)
  6125     COMPUTE WK2 = (1 + K) ** (M * -1)
  6126     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  6127     COMPUTE ANGLEN-M = ANGLEN-M / Y
  6128     COMPUTE ANGLEM = ((1 - ((1 + K)
  6129          ** (M * -1))) / K) / Y
  6130*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  6131     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  6132        ((1 + K) ** (M + 1 / Y
  6133        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  6134        - 1)) / K) * RA
  6135     COMPUTE WK7 = (((((M * (M + 1) / 2)
  6136        + (CP-DAYS-TO-1ST-PMT - +30)
  6137        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  6138        CP-DCC-AH-RATE / 1000 * 12 / 12)
  6139     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  6140        * (12 / 12)
  6141     MOVE WK3                    TO CP-LF-PREM
  6142
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page 112
* ELRATE.cbl
  6143     GO TO 99999-RETURN
  6144
  6145     .
  6146 12001-CONTINUE-NET.
  6147
  6148     IF NET-STD
  6149        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  6150*          OR 'DCC'
  6151         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  6152         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  6153         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  6154         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  6155                               * ((1 + N) / (1 + M))
  6156         if (i = .0000000001)
  6157            and (wk3 = zeros)
  6158            move 1               to wk3
  6159         end-if
  6160        ELSE
  6161         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  6162         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  6163         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  6164         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  6165
  6166     IF NET-SMP
  6167         COMPUTE N2 = N * N
  6168         COMPUTE N3 = N2 * N
  6169         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  6170         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  6171         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  6172         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  6173         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  6174
  6175     IF NPO-PRUDENTIAL
  6176       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  6177           VARYING WS-COUNTER FROM 1 BY 1
  6178               UNTIL WS-COUNTER = N
  6179       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  6180       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  6181
  6182     MOVE WK3 TO FACTOR.
  6183
  6184     GO TO 99999-RETURN.
  6185
  6186 12100-PRU-CALC.
  6187     IF WS-COUNTER = 1
  6188         COMPUTE PWK = (I + 1)
  6189     ELSE
  6190         COMPUTE PWK = PWK * (I + 1).
  6191
  6192 12199-EXIT.
  6193      EXIT.
  6194
  6195 99000-ERROR.
  6196     MOVE +9999.999999999 TO N-P-FACTOR.
  6197     MOVE '4'             TO CP-RETURN-CODE.
  6198
  6199     GO TO 99999-EXIT.
  6200
* Micro Focus Server Express         V5.1 revision 000 16-Aug-19 13:37 Page 113
* ELRATE.cbl
  6201 99999-RETURN.
  6202     MOVE FACTOR          TO N-P-FACTOR.
  6203
  6204 99999-EXIT.
  6205      EXIT.
  6206 99999-DUMMY-STOP-RUN.
  6207
  6208* GOBACK.
  6209     MOVE '9%                    "   ' TO DFHEIV0
  6210     MOVE 'ELRATE' TO DFHEIV1
  6211     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6212     GOBACK.
  6213
  6214
  6215 9999-DFHBACK SECTION.
  6216     MOVE '9%                    "   ' TO DFHEIV0
  6217     MOVE 'ELRATE' TO DFHEIV1
  6218     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6219     GOBACK.
  6220 9999-DFHEXIT.
  6221     IF DFHEIGDJ EQUAL 0001
  6222         NEXT SENTENCE
  6223     ELSE IF DFHEIGDJ EQUAL 2
  6224         GO TO 9999-RATE-NOTFND,
  6225               9999-RATE-NOTOPEN,
  6226               9999-RATE-NOTFND
  6227         DEPENDING ON DFHEIGDI.
  6228     MOVE '9%                    "   ' TO DFHEIV0
  6229     MOVE 'ELRATE' TO DFHEIV1
  6230     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6231     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3152     Code:       57317
