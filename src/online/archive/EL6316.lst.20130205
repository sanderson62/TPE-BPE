* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page   1
* EL6316.cbl
* Options: int("EL6316.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6316.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6316.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6316.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6316.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page   2
* EL6316.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24* 110410   2007070900001  PEMA  ADD REFORMATIONS AND RESCISSIONS
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    27* 072312   2011022800001  AJRA  NAPERSOFT MISC
    28* 091812 IR2012091400003  AJRA  CHANGE MSG 9999
    29* 101512   2011022800001  AJRA  FIX CLM RESC DEFAULT
    30* 102212   2012101700002  AJRA  SCREEN ID
    31* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    32* 110612   2012101700002  AJRA  ADD NEW FIELDS
    33* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    34* 121212   2012101700002  AJRA  ADD BILLING NOTE ENTRY
    35* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    36*-----------------------------------------------------------------
    37*REMARKS.
    38*        TRANSACTION - EXBC - CANCEL CHANGES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page   3
* EL6316.cbl
    40 ENVIRONMENT DIVISION.
    41 DATA DIVISION.
    42 WORKING-STORAGE SECTION.
    43 01  DFH-START PIC X(04).
    44 77  FILLER  PIC X(32)  VALUE '********************************'.
    45 77  FILLER  PIC X(32)  VALUE '*    EL6316 WORKING STORAGE    *'.
    46 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    47 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    48 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    49 77  W-ARCH-NUMBER               PIC 9(8) BINARY  VALUE ZEROS.
    50 77  w-prtsw                     pic x  value spaces.
    51 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    52 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    53     88  ACCT-FOUND                 VALUE 'Y'.
    54 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
    55 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    56 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    57 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    58 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    59 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    60 77  s1                          pic s999 comp-3 value +0.
    61 77  s2                          pic s999 comp-3 value +0.
    62 77  WS-REASON-SW                PIC X  VALUE ' '.
    63     88  REASONS-FOUND                  VALUE 'Y'.
    64     88  REASONS-NOT-FOUND              VALUE 'N'.
    65 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    66     88  NO-CERT-RW                 VALUE 'N'.
    67     88  CERT-RW                    VALUE 'Y'.
    68 77  WS-COMM-LENGTH              PIC 9(4) BINARY.
    69 01  P pointer.
    70 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    71 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    72 01  var-ptr pointer.
    73 01  env-var-len                 pic 9(4)  binary.
    74 01  rc                          pic 9(9)  binary.
    75 01  WS-KIXHOST                  PIC X(10).
    76 01  WS-KIXSYS.
    77     05  WS-KIX-FIL1             PIC X(10).
    78     05  WS-KIX-APPS             PIC X(10).
    79     05  WS-KIX-ENV              PIC X(10).
    80     05  WS-KIX-MYENV            PIC X(10).
    81     05  WS-KIX-SYS              PIC X(10).
    82*    COPY ELCSCTM.
    83******************************************************************
    84*                                                                *
    85*                                                                *
    86*                            ELCSCTM                             *
    87*                            VMOD=2.001                          *
    88*                                                                *
    89*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    90*                                                                *
    91******************************************************************
    92 01  SECURITY-MESSAGE.
    93     12  FILLER                          PIC X(30)
    94            VALUE '** LOGIC SECURITY VIOLATION -'.
    95     12  SM-READ                         PIC X(6).
    96     12  FILLER                          PIC X(5)
    97            VALUE ' PGM='.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page   4
* EL6316.cbl
    98     12  SM-PGM                          PIC X(6).
    99     12  FILLER                          PIC X(5)
   100            VALUE ' OPR='.
   101     12  SM-PROCESSOR-ID                 PIC X(4).
   102     12  FILLER                          PIC X(6)
   103            VALUE ' TERM='.
   104     12  SM-TERMID                       PIC X(4).
   105     12  FILLER                          PIC XX   VALUE SPACE.
   106     12  SM-JUL-DATE                     PIC 9(5).
   107     12  FILLER                          PIC X    VALUE SPACE.
   108     12  SM-TIME                         PIC 99.99.
   109
   110*    COPY ELCSCRTY.
   111******************************************************************
   112*                                                                *
   113*                                                                *
   114*                            ELCSCRTY                            *
   115*                            VMOD=2.001                          *
   116*                                                                *
   117*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   118*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   119*        SAVED IN PI-SECURITY-ADDRESS.                           *
   120*                                                                *
   121******************************************************************
   122 01  SECURITY-CONTROL.
   123     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   124     12  FILLER                       PIC XX    VALUE 'SC'.
   125     12  SC-CREDIT-CODES.
   126         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   127             20  SC-CREDIT-DISPLAY    PIC X.
   128             20  SC-CREDIT-UPDATE     PIC X.
   129     12  SC-CLAIMS-CODES.
   130         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   131             20  SC-CLAIMS-DISPLAY    PIC X.
   132             20  SC-CLAIMS-UPDATE     PIC X.
   133 01 srch-commarea.
   134*                                copy ELCADLTRSPI.
   135******************************************************************
   136*                   C H A N G E   L O G
   137*
   138* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   139*-----------------------------------------------------------------
   140*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   141* EFFECTIVE    NUMBER
   142*-----------------------------------------------------------------
   143* 060611    2011022800001  PEMA  NEW COPYBOOK
   144* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   145* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   146******************************************************************
   147****************************************
   148*  commarea for NaperSoft On Demand Admin services letters
   149*  (business logic input & output)
   150****************************************
   151     03  BL-INPUT.
   152         05  BL-DATA-SRCE        PIC X.
   153         05  BL-LETTER-ID        PIC XXXX.
   154         05  BL-CARRIER          PIC X.
   155         05  BL-GROUP            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page   5
* EL6316.cbl
   156         05  BL-STATE            PIC XX.
   157         05  BL-ACCOUNT          PIC X(10).
   158         05  BL-EFF-DT           PIC X(10).
   159         05  BL-CERT-NO          PIC X(11).
   160         05  BL-BATCH-NO         PIC X(6).
   161         05  BL-BATCH-SEQ        PIC 9(8).
   162         05  BL-RESP-NO          PIC X(10).
   163         05  BL-NO-OF-COPIES     PIC 99.
   164         05  BL-PROC-ID          PIC XXXX.
   165         05  BL-COMP-ID          PIC XXX.
   166         05  BL-PRINT-NOW-SW     PIC X.
   167         05  BL-ENC-CD           PIC XXX.
   168         05  BL-RESEND-DT        PIC X(10).
   169         05  BL-FOLLOW-UP-DT     PIC X(10).
   170         05  BL-ARCHIVE-NO       PIC 9(8).
   171         05  BL-FUNC             PIC X(8).
   172         05  BL-COMMENTS         PIC X(100).
   173         05  FILLER REDEFINES BL-COMMENTS.
   174             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   175             10  BL-LETTER-TO-ACCT PIC X.
   176             10  BL-LETTER-TO-BENE PIC X.
   177             10  BL-WRITE-ERARCH   PIC X.
   178                 88  ERARCH-QWS      VALUE 'Q'.
   179                 88  ERARCH-BATCH    VALUE 'B'.
   180                 88  ERARCH-TEMP     VALUE 'T'.
   181             10  BL-PROCESS-TYPE PIC X(07).
   182             10  BL-CERT-FORM-ID PIC X(05).
   183             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   184             10  BL-SOURCE-SCREEN PIC X(8).
   185             10  FILLER          PIC X(25).
   186     03  BL-OUTPUT.
   187         05  BL-STATUS                   PIC X.
   188             88  BL-OK                      VALUE "P".
   189             88  BL-FAIL                  VALUE "F".
   190         05  BL-MESSAGE          PIC X(50).
   191     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   192     03  FILLER                  PIC X(31).
   193
   194*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   195*                                COPY ELCZREC.
   196******************************************************************
   197*                                                                *
   198*                                                                *
   199*                            ELCZREC.                            *
   200*                                                                *
   201*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   202*                                                                *
   203******************************************************************
   204*-----------------------------------------------------------------
   205*                   C H A N G E   L O G
   206*
   207* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   208*-----------------------------------------------------------------
   209*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   210* EFFECTIVE    NUMBER
   211*-----------------------------------------------------------------
   212* 122011    2011022800001  AJRA  NEW FILE
   213* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page   6
* EL6316.cbl
   214* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   215*-----------------------------------------------------------------
   216 01  W-Z-CONTROL-DATA.
   217     05  W-NUMBER-OF-COPIES      PIC  9.
   218     05  FILLER                  PIC  X.
   219     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   220     05  FILLER                  PIC  X.
   221     05  W-DAYS-TO-RESEND        PIC  999.
   222     05  FILLER                  PIC  X.
   223     05  W-FORM-TO-RESEND        PIC  X(4).
   224     05  FILLER                  PIC  X.
   225     05  W-PROMPT-LETTER         PIC  X.
   226     05  FILLER                  PIC  X.
   227     05  W-ENCLOSURE-CD          PIC  XXX.
   228     05  FILLER                  PIC  X.
   229     05  W-AUTO-CLOSE-IND        PIC  X.
   230     05  FILLER                  PIC  X.
   231     05  W-LETTER-TO-BENE        PIC  X.
   232     05  FILLER                  PIC  X.
   233     05  W-LETTER-TO-ACCT        PIC  X.
   234     05  FILLER                  PIC  X.
   235     05  W-LETTER-TYPE           PIC  X.
   236     05  FILLER                  PIC  X.
   237     05  W-PRINT-CERTIFICATE     PIC  X.
   238     05  FILLER                  PIC  X.
   239     05  W-REFUND-REQUIRED       PIC  X.
   240     05  FILLER                  PIC  X.
   241     05  W-ONBASE-CODE           PIC  XX.
   242     05  FILLER                  PIC  X.
   243     05  W-ACCT-SUMM             PIC  X.
   244     05  FILLER                  PIC  X.
   245     05  W-CSO-SUMM              PIC  X.
   246     05  FILLER                  PIC  X.
   247     05  W-REASONS-REQUIRED      PIC  X.
   248     05  FILLER                  PIC  X(29).
   249 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   250 01  STANDARD-AREAS.
   251     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   252     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   253                                 PIC  X(08).
   254     12  QID.
   255         16  QID-TERM        PIC X(4)    VALUE SPACES.
   256         16  FILLER          PIC X(4)    VALUE '631I'.
   257     12  TIME-MT                 PIC S9(7).
   258     12  TIME-MT-R  REDEFINES TIME-MT.
   259         16  FILLER              PIC X.
   260         16  TIME-LMT            PIC 99V99.
   261         16  FILLER              PIC X(2).
   262     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   263     12  MAP-LENGTH              PIC 9(4)   VALUE 359 BINARY.
   264     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   265     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   266     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   267     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   268     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   269     12  WS-ELCERT-KEY.
   270         16  W-CERT-COMPANY-CD   PIC X.
   271         16  W-CERT-CARRIER      PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page   7
* EL6316.cbl
   272         16  W-CERT-GROUPING     PIC X(6).
   273         16  W-CERT-STATE        PIC XX.
   274         16  W-CERT-ACCOUNT      PIC X(10).
   275         16  W-CERT-CERT-EFF-DT  PIC XX.
   276         16  W-CERT-CERT-PRIME   PIC X(10).
   277         16  W-CERT-CERT-SFX     PIC X.
   278     12  WS-ELEOBC-KEY.
   279         16  WS-EOBC-COMPANY-CD  PIC X.
   280         16  WS-EOBC-REC-TYPE    PIC X.
   281         16  WS-EOBC-CODE        PIC X(4).
   282         16  FILLER              PIC X(9).
   283     12  WS-ERNOTE-KEY.
   284         16  W-NOTE-COMPANY-CD   PIC X.
   285         16  W-NOTE-CARRIER      PIC X.
   286         16  W-NOTE-GROUPING     PIC X(6).
   287         16  W-NOTE-STATE        PIC XX.
   288         16  W-NOTE-ACCOUNT      PIC X(10).
   289         16  W-NOTE-CERT-EFF-DT  PIC XX.
   290         16  W-NOTE-CERT-PRIME   PIC X(10).
   291         16  W-NOTE-CERT-SFX     PIC X.
   292     12  ELLETR-KEY.
   293         16  LETR-PART-KEY.
   294             20  LETR-COMPANY-CD PIC X.
   295             20  LETR-LETTER-ID  PIC X(4).
   296         16  LETR-FILLER         PIC X(8).
   297         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   298     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   299     12  ERPNDB2-KEY.
   300         16  PNDB2-COMPANY-CD    PIC X.
   301         16  PNDB2-CARRIER       PIC X.
   302         16  PNDB2-GROUPING      PIC X(6).
   303         16  PNDB2-STATE         PIC XX.
   304         16  PNDB2-ACCOUNT       PIC X(10).
   305         16  PNDB2-CERT-EFF-DT   PIC XX.
   306         16  PNDB2-CERT-PRIME    PIC X(10).
   307         16  PNDB2-CERT-SFX      PIC X.
   308         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   309         16  PNDB2-RECORD-TYPE   PIC X.
   310     12  ERENDT-KEY.
   311         16  ENDT-COMPANY-CD       PIC X.
   312         16  ENDT-CARRIER          PIC X.
   313         16  ENDT-GROUPING         PIC X(6).
   314         16  ENDT-STATE            PIC XX.
   315         16  ENDT-ACCOUNT          PIC X(10).
   316         16  ENDT-CERT-EFF-DT      PIC XX.
   317         16  ENDT-CERT-PRIME       PIC X(10).
   318         16  ENDT-CERT-SFX         PIC X.
   319         16  ENDT-RECORD-TYPE      PIC X.
   320         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   321     12  ELCRTO-KEY.
   322         16  CRTO-COMPANY-CD     PIC X.
   323         16  CRTO-CARRIER        PIC X.
   324         16  CRTO-GROUPING       PIC X(6).
   325         16  CRTO-STATE          PIC XX.
   326         16  CRTO-ACCOUNT        PIC X(10).
   327         16  CRTO-CERT-EFF-DT    PIC XX.
   328         16  CRTO-CERT-PRIME     PIC X(10).
   329         16  CRTO-CERT-SFX       PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page   8
* EL6316.cbl
   330         16  CRTO-RECORD-TYPE    PIC X.
   331         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   332     12  WS-ERMAIL-KEY.
   333         16  MAIL-COMPANY-CD     PIC X.
   334         16  MAIL-CARRIER        PIC X.
   335         16  MAIL-GROUPING       PIC X(6).
   336         16  MAIL-STATE          PIC XX.
   337         16  MAIL-ACCOUNT        PIC X(10).
   338         16  MAIL-CERT-EFF-DT    PIC XX.
   339         16  MAIL-CERT-PRIME     PIC X(10).
   340         16  MAIL-CERT-SFX       PIC X.
   341     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   342     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   343     12  WS-CURRENT-DT.
   344         16  FILLER              PIC X(6)    VALUE SPACES.
   345         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   346     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   347     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   348         88  CANCEL-REC            VALUE 'C'.
   349         88  ISSUE-REC             VALUE 'I'.
   350     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   351     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   352     12  ELCNTL-KEY.
   353         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   354         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   355         16  CNTL-ACCESS.
   356             20  CNTL-STATE      PIC XX    VALUE SPACES.
   357             20  FILLER          PIC X     VALUE SPACES.
   358             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   359         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   360     12  WS-ERACCT-KEY.
   361         16  ACCT-COMPANY-CD     PIC X.
   362         16  ACCT-CARRIER        PIC X.
   363         16  ACCT-GROUPING       PIC X(6).
   364         16  ACCT-STATE          PIC XX.
   365         16  ACCT-ACCOUNT        PIC X(10).
   366         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   367         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   368     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   369     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   370     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   371     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   372     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   373     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   374     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   375     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   376     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   377     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   378     12  WS-RESPONSE             PIC S9(8)   COMP.
   379         88  RESP-NORMAL                  VALUE +00.
   380         88  RESP-NOTFND                  VALUE +13.
   381         88  RESP-DUPREC                  VALUE +14.
   382         88  RESP-DUPKEY                  VALUE +15.
   383         88  RESP-NOTOPEN                 VALUE +19.
   384         88  RESP-ENDFILE                 VALUE +20.
   385     12  MAP-NAME            PIC X(8)    VALUE 'EL631I'.
   386     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6316S'.
   387     12  SCREEN-NUMBER       PIC X(4)    VALUE '631I'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page   9
* EL6316.cbl
   388     12  TRANS-ID            PIC X(4)    VALUE 'EXBC'.
   389     12  THIS-PGM            PIC X(8)    VALUE 'EL6316'.
   390     12  PGM-NAME            PIC X(8).
   391     12  TIME-IN             PIC S9(7).
   392     12  TIME-OUT-R  REDEFINES TIME-IN.
   393         16  FILLER          PIC X.
   394         16  TIME-OUT        PIC 99V99.
   395         16  FILLER          PIC X(2).
   396     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   397     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   398     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   399     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   400     12  XCTL-6317           PIC X(8)    VALUE 'EL6317'.
   401     12  XCTL-6318           PIC X(8)    VALUE 'EL6318'.
   402     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   403     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   404     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   405     12  WS-PHONE.
   406         16  WS-PH1              PIC XXX.
   407         16  WS-PH2              PIC XXX.
   408         16  WS-PH3              PIC XXXX.
   409     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   410     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   411
   412     12  WS-BILLING-NOTE.
   413         16  WS-BN-NOTE          PIC X(25).
   414         16  WS-BN-LTRID         PIC X(4).
   415         16  FILLER              PIC X(3).
   416         16  WS-BN-DATE          PIC X(8).
   417         16  FILLER              PIC X(3).
   418         16  WS-BN-USERID        PIC X(4).
   419         16  FILLER              PIC X(30).
   420     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   421         16  WS-MAN-BN-NOTE      PIC X(63).
   422         16  FILLER              PIC X(14).
   423     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   424     12  NEW-ORIG-REC.
   425         16  NEW-INS-LAST-NAME             PIC X(15).
   426         16  NEW-INS-FIRST-NAME            PIC X(10).
   427         16  NEW-INS-MIDDLE-INIT           PIC X.
   428         16  NEW-INS-AGE                   PIC S999     COMP-3.
   429         16  NEW-JNT-LAST-NAME             PIC X(15).
   430         16  NEW-JNT-FIRST-NAME            PIC X(10).
   431         16  NEW-JNT-MIDDLE-INIT           PIC X.
   432         16  NEW-JNT-AGE                   PIC S999     COMP-3.
   433         16  NEW-LF-BENCD                  PIC XX.
   434         16  NEW-LF-TERM                   PIC S999      COMP-3.
   435         16  NEW-LF-BEN-AMT                PIC S9(9)V99  COMP-3.
   436         16  NEW-LF-PRM-AMT                PIC S9(7)V99  COMP-3.
   437         16  NEW-LF-ALT-BEN-AMT            PIC S9(9)V99  COMP-3.
   438         16  NEW-LF-ALT-PRM-AMT            PIC S9(7)V99  COMP-3.
   439         16  NEW-LF-EXP-DT                 PIC XX.
   440         16  NEW-LF-COMM-PCT               PIC SV9(5)    COMP-3.
   441         16  NEW-LF-CANCEL-DT              PIC XX.
   442         16  NEW-LF-CANCEL-AMT             PIC S9(7)V99  COMP-3.
   443         16  NEW-LF-ITD-CANCEL-AMT         PIC S9(7)V99  COMP-3.
   444         16  NEW-AH-BENCD                  PIC XX.
   445         16  NEW-AH-TERM                   PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  10
* EL6316.cbl
   446         16  NEW-AH-BEN-AMT                PIC S9(9)V99  COMP-3.
   447         16  NEW-AH-PRM-AMT                PIC S9(7)V99  COMP-3.
   448         16  NEW-AH-EXP-DT                 PIC XX.
   449         16  NEW-AH-COMM-PCT               PIC SV9(5)    COMP-3.
   450         16  NEW-AH-CP                     PIC 99.
   451         16  NEW-AH-CANCEL-DT              PIC XX.
   452         16  NEW-AH-CANCEL-AMT             PIC S9(7)V99  COMP-3.
   453         16  NEW-AH-ITD-CANCEL-AMT         PIC S9(7)V99  COMP-3.
   454         16  NEW-CRED-BENE-NAME            PIC X(25).
   455         16  NEW-1ST-PMT-DT                PIC XX.
   456         16  NEW-INS-AGE-DEFAULT-FLAG      PIC X.
   457         16  NEW-JNT-AGE-DEFAULT-FLAG      PIC X.
   458         16  FILLER                        PIC X(237).
   459
   460 01  CERT-NOTE-ENTRIES.
   461     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   462         16  CERT-NT-TEXT                PIC X(63).
   463         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   464         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   465         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   466
   467 01  ERCNOT-AREA.
   468     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   469     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   470     12  ERCNOT-KEY.
   471         16  ERCNOT-PARTIAL-KEY.
   472             20 ERCNOT-COMPANY-CD    PIC X.
   473             20 ERCNOT-CARRIER       PIC X.
   474             20 ERCNOT-GROUPING      PIC X(06).
   475             20 ERCNOT-STATE         PIC XX.
   476             20 ERCNOT-ACCOUNT       PIC X(10).
   477             20 ERCNOT-EFF-DT        PIC XX.
   478             20 ERCNOT-CERT-NO.
   479                25 ERCNOT-CERT-PRIME PIC X(10).
   480                25 ERCNOT-CERT-SFX   PIC X.
   481             20 ERCNOT-REC-TYP       PIC X.
   482         16 ERCNOT-SEQ           PIC S9(4) COMP.
   483     12  SV-PARTIAL-KEY.
   484         20 SV-COMPANY-CD            PIC X.
   485         20 SV-CARRIER               PIC X.
   486         20 SV-GROUPING              PIC X(06).
   487         20 SV-STATE                 PIC XX.
   488         20 SV-ACCOUNT               PIC X(10).
   489         20 SV-EFF-DT                PIC XX.
   490         20 SV-CERT-NO.
   491            25 SV-CERT-PRIME         PIC X(10).
   492            25 SV-CERT-SFX           PIC X(1).
   493         20 SV-REC-TYP               PIC X.
   494 01  ERROR-MESSAGES.
   495     12  ER-0000                 PIC X(4)  VALUE '0000'.
   496     12  ER-0004                 PIC X(4)  VALUE '0004'.
   497     12  ER-0008                 PIC X(4)  VALUE '0008'.
   498     12  ER-0023                 PIC X(4)  VALUE '0023'.
   499     12  ER-0029                 PIC X(4)  VALUE '0029'.
   500     12  ER-0068                 PIC X(4)  VALUE '0068'.
   501     12  ER-0132                 PIC X(4)  VALUE '0132'.
   502     12  ER-0142                 PIC X(4)  VALUE '0142'.
   503     12  ER-0148                 PIC X(4)  VALUE '0148'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  11
* EL6316.cbl
   504     12  ER-0215                 PIC X(4)  VALUE '0215'.
   505     12  ER-0280                 PIC X(4)  VALUE '0280'.
   506     12  ER-0348                 PIC X(4)  VALUE '0348'.
   507     12  ER-0419                 PIC X(4)  VALUE '0419'.
   508     12  ER-0894                 PIC X(4)  VALUE '0894'.
   509     12  ER-1101                 PIC X(4)  VALUE '1101'.
   510     12  ER-1236                 PIC X(4)  VALUE '1236'.
   511     12  ER-1818                 PIC X(4)  VALUE '1818'.
   512     12  ER-1820                 PIC X(4)  VALUE '1820'.
   513     12  ER-2056                 PIC X(4)  VALUE '2056'.
   514     12  ER-2079                 PIC X(4)  VALUE '2079'.
   515     12  ER-2208                 PIC X(4)  VALUE '2208'.
   516     12  ER-2209                 PIC X(4)  VALUE '2209'.
   517     12  ER-2237                 PIC X(4)  VALUE '2237'.
   518     12  ER-2238                 PIC X(4)  VALUE '2238'.
   519     12  ER-2253                 PIC X(4)  VALUE '2253'.
   520     12  ER-2619                 PIC X(4)  VALUE '2619'.
   521     12  ER-2651                 PIC X(4)  VALUE '2651'.
   522     12  ER-2784                 PIC X(4)  VALUE '2784'.
   523     12  ER-2785                 PIC X(4)  VALUE '2785'.
   524     12  ER-2786                 PIC X(4)  VALUE '2786'.
   525     12  ER-2791                 PIC X(4)  VALUE '2791'.
   526     12  ER-2845                 PIC X(4)  VALUE '2845'.
   527     12  ER-2848                 PIC X(4)  VALUE '2848'.
   528     12  ER-2851                 PIC X(4)  VALUE '2851'.
   529     12  ER-3829                 PIC X(4)  VALUE '3829'.
   530     12  ER-3830                 PIC X(4)  VALUE '3830'.
   531     12  ER-3833                 PIC X(4)  VALUE '3833'.
   532     12  ER-7638                 PIC X(4)  VALUE '7638'.
   533     12  ER-8888                 PIC X(4)  VALUE '8888'.
   534     12  ER-9999                 PIC X(4)  VALUE '9999'.
   535*    COPY ELCDATE.
   536******************************************************************
   537*                                                                *
   538*                                                                *
   539*                            ELCDATE.                            *
   540*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   541*                            VMOD=2.003
   542*                                                                *
   543*                                                                *
   544*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   545*                 LENGTH = 200                                   *
   546******************************************************************
   547
   548 01  DATE-CONVERSION-DATA.
   549     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   550     12  DC-OPTION-CODE                PIC X.
   551         88  BIN-TO-GREG                VALUE ' '.
   552         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   553         88  EDIT-GREG-TO-BIN           VALUE '2'.
   554         88  YMD-GREG-TO-BIN            VALUE '3'.
   555         88  MDY-GREG-TO-BIN            VALUE '4'.
   556         88  JULIAN-TO-BIN              VALUE '5'.
   557         88  BIN-PLUS-ELAPSED           VALUE '6'.
   558         88  FIND-CENTURY               VALUE '7'.
   559         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   560         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   561         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  12
* EL6316.cbl
   562         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   563         88  JULIAN-TO-BIN-3            VALUE 'C'.
   564         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   565         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   566         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   567         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   568         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   569         88  CHECK-LEAP-YEAR            VALUE 'H'.
   570         88  BIN-3-TO-GREG              VALUE 'I'.
   571         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   572         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   573         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   574         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   575         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   576         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   577         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   578         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   579         88  THREE-CHARACTER-BIN
   580                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   581         88  GREGORIAN-TO-BIN
   582                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   583         88  BIN-TO-GREGORIAN
   584                  VALUES ' ' '1' 'I' '8' 'G'.
   585         88  JULIAN-TO-BINARY
   586                  VALUES '5' 'C' 'E' 'F'.
   587     12  DC-ERROR-CODE                 PIC X.
   588         88  NO-CONVERSION-ERROR        VALUE ' '.
   589         88  DATE-CONVERSION-ERROR
   590                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   591         88  DATE-IS-ZERO               VALUE '1'.
   592         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   593         88  DATE-IS-INVALID            VALUE '3'.
   594         88  DATE1-GREATER-DATE2        VALUE '4'.
   595         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   596         88  DATE-INVALID-OPTION        VALUE '9'.
   597         88  INVALID-CENTURY            VALUE 'A'.
   598         88  ONLY-CENTURY               VALUE 'B'.
   599         88  ONLY-LEAP-YEAR             VALUE 'C'.
   600         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   601     12  DC-END-OF-MONTH               PIC X.
   602         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   603     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   604         88  USE-NORMAL-PROCESS         VALUE ' '.
   605         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   606         88  ADJUST-UP-100-YRS          VALUE '2'.
   607     12  FILLER                        PIC X.
   608     12  DC-CONVERSION-DATES.
   609         16  DC-BIN-DATE-1             PIC XX.
   610         16  DC-BIN-DATE-2             PIC XX.
   611         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   612         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   613                       DC-GREG-DATE-1-EDIT.
   614             20  DC-EDIT1-MONTH        PIC 99.
   615             20  SLASH1-1              PIC X.
   616             20  DC-EDIT1-DAY          PIC 99.
   617             20  SLASH1-2              PIC X.
   618             20  DC-EDIT1-YEAR         PIC 99.
   619         16  DC-GREG-DATE-2-EDIT       PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  13
* EL6316.cbl
   620         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   621                     DC-GREG-DATE-2-EDIT.
   622             20  DC-EDIT2-MONTH        PIC 99.
   623             20  SLASH2-1              PIC X.
   624             20  DC-EDIT2-DAY          PIC 99.
   625             20  SLASH2-2              PIC X.
   626             20  DC-EDIT2-YEAR         PIC 99.
   627         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   628         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   629                     DC-GREG-DATE-1-YMD.
   630             20  DC-YMD-YEAR           PIC 99.
   631             20  DC-YMD-MONTH          PIC 99.
   632             20  DC-YMD-DAY            PIC 99.
   633         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   634         16  DC-GREG-DATE-1-MDY-R REDEFINES
   635                      DC-GREG-DATE-1-MDY.
   636             20  DC-MDY-MONTH          PIC 99.
   637             20  DC-MDY-DAY            PIC 99.
   638             20  DC-MDY-YEAR           PIC 99.
   639         16  DC-GREG-DATE-1-ALPHA.
   640             20  DC-ALPHA-MONTH        PIC X(10).
   641             20  DC-ALPHA-DAY          PIC 99.
   642             20  FILLER                PIC XX.
   643             20  DC-ALPHA-CENTURY.
   644                 24 DC-ALPHA-CEN-N     PIC 99.
   645             20  DC-ALPHA-YEAR         PIC 99.
   646         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   647         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   648         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   649         16  DC-JULIAN-DATE            PIC 9(05).
   650         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   651                                       PIC 9(05).
   652         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   653             20  DC-JULIAN-YEAR        PIC 99.
   654             20  DC-JULIAN-DAYS        PIC 999.
   655         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   656         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   657         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   658     12  DATE-CONVERSION-VARIBLES.
   659         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   660         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   661             20  FILLER                PIC 9(3).
   662             20  HOLD-CEN-1-CCYY.
   663                 24  HOLD-CEN-1-CC     PIC 99.
   664                 24  HOLD-CEN-1-YY     PIC 99.
   665             20  HOLD-CEN-1-MO         PIC 99.
   666             20  HOLD-CEN-1-DA         PIC 99.
   667         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   668             20  HOLD-CEN-1-R-MO       PIC 99.
   669             20  HOLD-CEN-1-R-DA       PIC 99.
   670             20  HOLD-CEN-1-R-CCYY.
   671                 24  HOLD-CEN-1-R-CC   PIC 99.
   672                 24  HOLD-CEN-1-R-YY   PIC 99.
   673             20  FILLER                PIC 9(3).
   674         16  HOLD-CENTURY-1-X.
   675             20  FILLER                PIC X(3)  VALUE SPACES.
   676             20  HOLD-CEN-1-X-CCYY.
   677                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  14
* EL6316.cbl
   678                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   679             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   680             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   681         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   682             20  HOLD-CEN-1-R-X-MO     PIC XX.
   683             20  HOLD-CEN-1-R-X-DA     PIC XX.
   684             20  HOLD-CEN-1-R-X-CCYY.
   685                 24  HOLD-CEN-1-R-X-CC PIC XX.
   686                 24  HOLD-CEN-1-R-X-YY PIC XX.
   687             20  FILLER                PIC XXX.
   688         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   689         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   690         16  DC-JULIAN-DATE-1          PIC 9(07).
   691         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   692             20  DC-JULIAN-1-CCYY.
   693                 24  DC-JULIAN-1-CC    PIC 99.
   694                 24  DC-JULIAN-1-YR    PIC 99.
   695             20  DC-JULIAN-DA-1        PIC 999.
   696         16  DC-JULIAN-DATE-2          PIC 9(07).
   697         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   698             20  DC-JULIAN-2-CCYY.
   699                 24  DC-JULIAN-2-CC    PIC 99.
   700                 24  DC-JULIAN-2-YR    PIC 99.
   701             20  DC-JULIAN-DA-2        PIC 999.
   702         16  DC-GREG-DATE-A-EDIT.
   703             20  DC-EDITA-MONTH        PIC 99.
   704             20  SLASHA-1              PIC X VALUE '/'.
   705             20  DC-EDITA-DAY          PIC 99.
   706             20  SLASHA-2              PIC X VALUE '/'.
   707             20  DC-EDITA-CCYY.
   708                 24  DC-EDITA-CENT     PIC 99.
   709                 24  DC-EDITA-YEAR     PIC 99.
   710         16  DC-GREG-DATE-B-EDIT.
   711             20  DC-EDITB-MONTH        PIC 99.
   712             20  SLASHB-1              PIC X VALUE '/'.
   713             20  DC-EDITB-DAY          PIC 99.
   714             20  SLASHB-2              PIC X VALUE '/'.
   715             20  DC-EDITB-CCYY.
   716                 24  DC-EDITB-CENT     PIC 99.
   717                 24  DC-EDITB-YEAR     PIC 99.
   718         16  DC-GREG-DATE-CYMD         PIC 9(08).
   719         16  DC-GREG-DATE-CYMD-R REDEFINES
   720                              DC-GREG-DATE-CYMD.
   721             20  DC-CYMD-CEN           PIC 99.
   722             20  DC-CYMD-YEAR          PIC 99.
   723             20  DC-CYMD-MONTH         PIC 99.
   724             20  DC-CYMD-DAY           PIC 99.
   725         16  DC-GREG-DATE-MDCY         PIC 9(08).
   726         16  DC-GREG-DATE-MDCY-R REDEFINES
   727                              DC-GREG-DATE-MDCY.
   728             20  DC-MDCY-MONTH         PIC 99.
   729             20  DC-MDCY-DAY           PIC 99.
   730             20  DC-MDCY-CEN           PIC 99.
   731             20  DC-MDCY-YEAR          PIC 99.
   732    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   733        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   734    12  DC-EL310-DATE                  PIC X(21).
   735    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  15
* EL6316.cbl
   736*    COPY ELCLOGOF.
   737******************************************************************
   738*                                                                *
   739*                                                                *
   740*                            ELCLOGOF.                           *
   741*                            VMOD=2.001                          *
   742*                                                                *
   743*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   744*                                                                *
   745******************************************************************
   746 01  CLASIC-LOGOFF.
   747     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   748     12  LOGOFF-TEXT.
   749         16  FILLER          PIC X(5)    VALUE SPACES.
   750         16  LOGOFF-MSG.
   751             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   752             20  FILLER      PIC X       VALUE SPACES.
   753             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   754         16  FILLER          PIC X(80)
   755           VALUE '* YOU ARE NOW LOGGED OFF'.
   756         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   757         16  FILLER          PIC X       VALUE QUOTE.
   758         16  LOGOFF-SYS-MSG  PIC X(17)
   759           VALUE 'S CLAS-IC SYSTEM '.
   760     12  TEXT-MESSAGES.
   761         16  UNACCESS-MSG    PIC X(29)
   762             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   763         16  PGMIDERR-MSG    PIC X(17)
   764             VALUE 'PROGRAM NOT FOUND'.
   765*    COPY ELCATTR.
   766******************************************************************
   767*                                                                *
   768*                            ELCATTR.                            *
   769*                            VMOD=2.001                          *
   770*                                                                *
   771*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   772*                                                                *
   773*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   774*                                                                *
   775*                   POS 1   P=PROTECTED                          *
   776*                           U=UNPROTECTED                        *
   777*                           S=ASKIP                              *
   778*                   POS 2   A=ALPHA/NUMERIC                      *
   779*                           N=NUMERIC                            *
   780*                   POS 3   N=NORMAL                             *
   781*                           B=BRIGHT                             *
   782*                           D=DARK                               *
   783*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   784*                           OF=MODIFIED DATA TAG OFF             *
   785*                                                                *
   786*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   787******************************************************************
   788 01  ATTRIBUTE-LIST.
   789     12  AL-PABOF            PIC X       VALUE 'Y'.
   790     12  AL-PABON            PIC X       VALUE 'Z'.
   791     12  AL-PADOF            PIC X       VALUE '%'.
   792     12  AL-PADON            PIC X       VALUE '_'.
   793     12  AL-PANOF            PIC X       VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  16
* EL6316.cbl
   794     12  AL-PANON            PIC X       VALUE '/'.
   795     12  AL-SABOF            PIC X       VALUE '8'.
   796     12  AL-SABON            PIC X       VALUE '9'.
   797     12  AL-SADOF            PIC X       VALUE '@'.
   798     12  AL-SADON            PIC X       VALUE QUOTE.
   799     12  AL-SANOF            PIC X       VALUE '0'.
   800     12  AL-SANON            PIC X       VALUE '1'.
   801     12  AL-UABOF            PIC X       VALUE 'H'.
   802     12  AL-UABON            PIC X       VALUE 'I'.
   803     12  AL-UADOF            PIC X       VALUE '<'.
   804     12  AL-UADON            PIC X       VALUE '('.
   805     12  AL-UANOF            PIC X       VALUE ' '.
   806     12  AL-UANON            PIC X       VALUE 'A'.
   807     12  AL-UNBOF            PIC X       VALUE 'Q'.
   808     12  AL-UNBON            PIC X       VALUE 'R'.
   809     12  AL-UNDOF            PIC X       VALUE '*'.
   810     12  AL-UNDON            PIC X       VALUE ')'.
   811     12  AL-UNNOF            PIC X       VALUE '&'.
   812     12  AL-UNNON            PIC X       VALUE 'J'.
   813*    COPY ELCEMIB.
   814******************************************************************
   815*                                                                *
   816*                                                                *
   817*                            ELCEMIB.                            *
   818*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   819*                            VMOD=2.005                          *
   820*                                                                *
   821*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   822*                                                                *
   823******************************************************************
   824 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   825     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   826     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   827     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   828     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   829     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   830     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   831     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   832     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   833     12  EMI-SWITCH1             PIC X        VALUE '1'.
   834         88  EMI-NO-ERRORS                    VALUE '1'.
   835         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   836         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   837     12  EMI-SWITCH2             PIC X        VALUE '1'.
   838         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   839     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   840         88  EMI-AREA1-EMPTY                  VALUE '1'.
   841         88  EMI-AREA1-FULL                   VALUE '2'.
   842     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   843         88  EMI-AREA2-EMPTY                  VALUE '1'.
   844         88  EMI-AREA2-FULL                   VALUE '2'.
   845     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   846         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   847         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   848         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   849         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   850         88  EMI-BYPASS-FATALS                VALUE 'X'.
   851     12  EMI-ERROR-LINES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  17
* EL6316.cbl
   852         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   853         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   854         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   855         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   856             20  EMI-ERR-CODES OCCURS 10 TIMES.
   857                 24  EMI-ERR-NUM         PIC X(4).
   858                 24  EMI-FILLER          PIC X.
   859                 24  EMI-SEV             PIC X.
   860                 24  FILLER              PIC X.
   861             20  FILLER                  PIC X(02).
   862     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   863         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   864             20  EMI-ERROR-NUMBER    PIC X(4).
   865             20  EMI-FILL            PIC X.
   866             20  EMI-SEVERITY        PIC X.
   867             20  FILLER              PIC X.
   868             20  EMI-ERROR-TEXT.
   869                 24  EMI-TEXT-VARIABLE   PIC X(10).
   870                 24  FILLER          PIC X(55).
   871     12  EMI-SEVERITY-SAVE           PIC X.
   872         88  EMI-NOTE                    VALUE 'N'.
   873         88  EMI-WARNING                 VALUE 'W'.
   874         88  EMI-FORCABLE                VALUE 'F'.
   875         88  EMI-FATAL                   VALUE 'X'.
   876     12  EMI-MESSAGE-FLAG            PIC X.
   877         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   878         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   879     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   880     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   881         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   882         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   883         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   884     12  FILLER                      PIC X(137)  VALUE SPACES.
   885     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   886     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   887     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   888     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   889*    COPY ELCTEXT.
   890******************************************************************
   891*                                                                *
   892*                                                                *
   893*                            ELCTEXT.                            *
   894*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   895*                            VMOD=2.008                          *
   896*                                                                *
   897*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   898*                                     FORM LETTERS,              *
   899*                                     CERT FORM DISPLAY.
   900*                                                                *
   901*   FILE TYPE = VSAM,KSDS                                        *
   902*   RECORD SIZE = 100   RECFORM = FIXED                          *
   903*                                                                *
   904*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   905*       ALTERNATE INDEX = NONE                                   *
   906*                                                                *
   907*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   908*       ALTERNATE INDEX = NONE                                   *
   909*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  18
* EL6316.cbl
   910*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   911*       ALTERNATE INDEX = NONE                                   *
   912*                                                                *
   913*   LOG = NO                                                     *
   914*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   915******************************************************************
   916 01  TEXT-FILES.
   917     12  TEXT-FILE-ID                PIC XX.
   918         88  FORMS-FILE-TEXT            VALUE 'TF'.
   919         88  LETTER-FILE-TEXT           VALUE 'TL'.
   920         88  HELP-FILE-TEXT             VALUE 'TH'.
   921
   922     12  TX-CONTROL-PRIMARY.
   923         16  TX-COMPANY-CD           PIC X.
   924             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   925         16  TX-ACCESS-CD-GENL       PIC X(12).
   926
   927         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   928             20  TX-LETTER-NO        PIC X(4).
   929             20  FILLER              PIC X(8).
   930
   931         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   932             20  TX-FORM-NO          PIC X(12).
   933
   934         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   935             20  TX-HELP-TYPE        PIC X.
   936                 88  HELP-FOR-GENERAL   VALUE ' '.
   937                 88  HELP-BY-SCREEN     VALUE 'S'.
   938                 88  HELP-BY-ERROR      VALUE 'E'.
   939             20  TX-SCREEN-OR-ERROR  PIC X(4).
   940                 88  GENERAL-INFO-HELP  VALUE '0000'.
   941             20  TX-HELP-FOR-COMPANY  PIC XXX.
   942                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   943             20  FILLER              PIC X(4).
   944
   945         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   946
   947     12  TX-PROCESS-CONTROL          PIC XX.
   948         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   949
   950     12  TX-TEXT-LINE                PIC X(70).
   951
   952     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   953         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   954         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   955         88  TX-VALID-FORM-SQUEEZE-VALUE
   956                                        VALUE 'Y' ' '.
   957
   958     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   959         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   960         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   961         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   962         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   963         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   964         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   965         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   966                                              'K' 'N' ' '
   967                                              'Z'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  19
* EL6316.cbl
   968
   969     12  TX-ARCHIVE-SW               PIC X.
   970         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   971         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   972         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   973
   974     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   975     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   976
   977     12  TX-BSR-CODE                 PIC X.
   978         88  TX-BSR-LETTER              VALUE 'B'.
   979         88  TX-NON-BSR-LETTER          VALUE ' '.
   980
   981     12  FILLER                      PIC X.
   982*****************************************************************
   983*    COPY ELCINTF.
   984******************************************************************
   985*                                                                *
   986*                                                                *
   987*                            ELCINTF.                            *
   988*                            VMOD=2.017                          *
   989*                                                                *
   990*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   991*                                                                *
   992*       LENGTH = 1024                                            *
   993*                                                                *
   994******************************************************************
   995*                   C H A N G E   L O G
   996*
   997* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   998*-----------------------------------------------------------------
   999*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1000* EFFECTIVE    NUMBER
  1001*-----------------------------------------------------------------
  1002* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1003******************************************************************
  1004 01  PROGRAM-INTERFACE-BLOCK.
  1005     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1006     12  PI-CALLING-PROGRAM              PIC X(8).
  1007     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1008     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1009     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1010     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1011     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1012     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1013     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1014     12  PI-COMPANY-ID                   PIC XXX.
  1015     12  PI-COMPANY-CD                   PIC X.
  1016
  1017     12  PI-COMPANY-PASSWORD             PIC X(8).
  1018
  1019     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1020
  1021     12  PI-CONTROL-IN-PROGRESS.
  1022         16  PI-CARRIER                  PIC X.
  1023         16  PI-GROUPING                 PIC X(6).
  1024         16  PI-STATE                    PIC XX.
  1025         16  PI-ACCOUNT                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  20
* EL6316.cbl
  1026         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1027                                         PIC X(10).
  1028         16  PI-CLAIM-CERT-GRP.
  1029             20  PI-CLAIM-NO             PIC X(7).
  1030             20  PI-CERT-NO.
  1031                 25  PI-CERT-PRIME       PIC X(10).
  1032                 25  PI-CERT-SFX         PIC X.
  1033             20  PI-CERT-EFF-DT          PIC XX.
  1034         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1035             20  PI-PLAN-CODE            PIC X(2).
  1036             20  PI-REVISION-NUMBER      PIC X(3).
  1037             20  PI-PLAN-EFF-DT          PIC X(2).
  1038             20  PI-PLAN-EXP-DT          PIC X(2).
  1039             20  FILLER                  PIC X(11).
  1040         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1041             20  PI-OE-REFERENCE-1.
  1042                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1043                 25  PI-OE-REF-1-SUFF    PIC XX.
  1044
  1045     12  PI-SESSION-IN-PROGRESS          PIC X.
  1046         88  CLAIM-SESSION                   VALUE '1'.
  1047         88  CREDIT-SESSION                  VALUE '2'.
  1048         88  WARRANTY-SESSION                VALUE '3'.
  1049         88  MORTGAGE-SESSION                VALUE '4'.
  1050         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1051
  1052
  1053*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1054
  1055     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1056     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1057
  1058     12  PI-CREDIT-USER                  PIC X.
  1059         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1060         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1061
  1062     12  PI-CLAIM-USER                   PIC X.
  1063         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1064         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1065
  1066     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1067         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1068         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1069         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1070         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1071         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1072
  1073     12  PI-PROCESSOR-ID                 PIC X(4).
  1074
  1075     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1076
  1077     12  PI-MEMBER-CAPTION               PIC X(10).
  1078
  1079     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1080         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1081
  1082     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1083     12  PI-LIFE-OVERRIDE-L2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  21
* EL6316.cbl
  1084     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1085     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1086
  1087     12  PI-AH-OVERRIDE-L1               PIC X.
  1088     12  PI-AH-OVERRIDE-L2               PIC XX.
  1089     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1090     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1091
  1092     12  PI-NEW-SYSTEM                   PIC X(2).
  1093
  1094     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1095     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1096         88  PI-USES-PAID-TO                 VALUE '1'.
  1097     12  PI-CRDTCRD-SYSTEM.
  1098         16  PI-CRDTCRD-USER             PIC X.
  1099             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1100             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1101         16  PI-CC-MONTH-END-DT          PIC XX.
  1102     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1103
  1104     12  PI-OE-REFERENCE-2.
  1105         16  PI-OE-REF-2-PRIME           PIC X(10).
  1106         16  PI-OE-REF-2-SUFF            PIC X.
  1107
  1108     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1109
  1110     12  PI-LANGUAGE-TYPE                PIC X.
  1111             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1112             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1113             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1114
  1115     12  PI-POLICY-LINKAGE-IND           PIC X.
  1116         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1117         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1118                                                   LOW-VALUES.
  1119
  1120     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1121     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1122         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1123         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1124
  1125     12  PI-PROCESSOR-CSR-IND            PIC X.
  1126         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1127         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1128
  1129     12  FILLER                          PIC X(3).
  1130
  1131     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1132
  1133     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1134         PI-SYSTEM-LEVEL.
  1135
  1136         16  PI-ENTRY-CODES.
  1137             20  PI-ENTRY-CD-1           PIC X.
  1138             20  PI-ENTRY-CD-2           PIC X.
  1139
  1140         16  PI-RETURN-CODES.
  1141             20  PI-RETURN-CD-1          PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  22
* EL6316.cbl
  1142             20  PI-RETURN-CD-2          PIC X.
  1143
  1144         16  PI-UPDATE-STATUS-SAVE.
  1145             20  PI-UPDATE-BY            PIC X(4).
  1146             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1147
  1148         16  PI-LOWER-CASE-LETTERS       PIC X.
  1149             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1150
  1151*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1152*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1153*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1154
  1155         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1156             88  ST-ACCNT-CNTL               VALUE ' '.
  1157             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1158             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1159             88  ACCNT-CNTL                  VALUE '3'.
  1160             88  CARR-ACCNT-CNTL             VALUE '4'.
  1161
  1162         16  PI-PROCESSOR-CAP-LIST.
  1163             20  PI-SYSTEM-CONTROLS.
  1164                24 PI-SYSTEM-DISPLAY     PIC X.
  1165                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1166                24 PI-SYSTEM-MODIFY      PIC X.
  1167                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1168             20  FILLER                  PIC XX.
  1169             20  PI-DISPLAY-CAP          PIC X.
  1170                 88  DISPLAY-CAP             VALUE 'Y'.
  1171             20  PI-MODIFY-CAP           PIC X.
  1172                 88  MODIFY-CAP              VALUE 'Y'.
  1173             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1174                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1175             20  PI-FORCE-CAP            PIC X.
  1176                 88  FORCE-CAP               VALUE 'Y'.
  1177
  1178         16  PI-PROGRAM-CONTROLS.
  1179             20  PI-PGM-PRINT-OPT        PIC X.
  1180             20  PI-PGM-FORMAT-OPT       PIC X.
  1181             20  PI-PGM-PROCESS-OPT      PIC X.
  1182             20  PI-PGM-TOTALS-OPT       PIC X.
  1183
  1184         16  PI-HELP-INTERFACE.
  1185             20  PI-LAST-ERROR-NO        PIC X(4).
  1186             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1187
  1188         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1189             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1190
  1191         16  PI-CR-CONTROL-IN-PROGRESS.
  1192             20  PI-CR-CARRIER           PIC X.
  1193             20  PI-CR-GROUPING          PIC X(6).
  1194             20  PI-CR-STATE             PIC XX.
  1195             20  PI-CR-ACCOUNT           PIC X(10).
  1196             20  PI-CR-FIN-RESP          PIC X(10).
  1197             20  PI-CR-TYPE              PIC X.
  1198
  1199         16  PI-CR-BATCH-NUMBER          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  23
* EL6316.cbl
  1200
  1201         16  PI-CR-MONTH-END-DT          PIC XX.
  1202
  1203         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1204             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1205             88  PI-ZERO-CARRIER             VALUE '1'.
  1206             88  PI-ZERO-GROUPING            VALUE '2'.
  1207             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1208
  1209         16  PI-CARRIER-SECURITY         PIC X.
  1210             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1211
  1212         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1213             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1214             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1215
  1216         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1217             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1218                                         INDEXED BY PI-ACCESS-NDX
  1219                                         PIC X.
  1220
  1221         16  PI-GA-BILLING-CONTROL       PIC X.
  1222             88  PI-GA-BILLING               VALUE '1'.
  1223
  1224         16  PI-MAIL-PROCESSING          PIC X.
  1225             88  PI-MAIL-YES                 VALUE 'Y'.
  1226
  1227         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1228
  1229         16  PI-AR-SYSTEM.
  1230             20  PI-AR-PROCESSING-CNTL   PIC X.
  1231                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1232             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1233             20  PI-AR-MONTH-END-DT      PIC XX.
  1234
  1235         16  PI-MP-SYSTEM.
  1236             20  PI-MORTGAGE-USER            PIC X.
  1237                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1238                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1239             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1240                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1241                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1242                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1243                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1244                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1245             20  PI-MP-MONTH-END-DT          PIC XX.
  1246             20  PI-MP-REFERENCE-NO.
  1247                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1248                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1249
  1250         16  PI-LABEL-CONTROL            PIC X(01).
  1251             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1252             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1253
  1254         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1255             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1256
  1257         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  24
* EL6316.cbl
  1258             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1259             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1260
  1261         16  FILLER                      PIC X(14).
  1262
  1263     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1264******************************************************************
  1265     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1266        16  PI-ISS-CAN-SW           PIC X.
  1267        16  PI-ERENDT-KEY.
  1268            20  PI-ENDT-COMPANY-CD  PIC X.
  1269            20  PI-ENDT-CARRIER     PIC X.
  1270            20  PI-ENDT-GROUPING    PIC X(6).
  1271            20  PI-ENDT-STATE       PIC XX.
  1272            20  PI-ENDT-ACCOUNT     PIC X(10).
  1273            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1274            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1275            20  PI-ENDT-CERT-SFX    PIC X.
  1276            20  PI-ENDT-RECORD-TYPE PIC X.
  1277            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1278        16  PI-ELCRTO-KEY.
  1279            20  PI-CRTO-COMPANY-CD  PIC X.
  1280            20  PI-CRTO-CARRIER     PIC X.
  1281            20  PI-CRTO-GROUPING    PIC X(6).
  1282            20  PI-CRTO-STATE       PIC XX.
  1283            20  PI-CRTO-ACCOUNT     PIC X(10).
  1284            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1285            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1286            20  PI-CRTO-CERT-SFX    PIC X.
  1287            20  PI-CRTO-RECORD-TYPE PIC X.
  1288            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1289        16  PI-ERPNDB-KEY           PIC X(11).
  1290        16  PI-DOCUMENT-PROCESSED   PIC X.
  1291            88  PI-VERI-PROCESSED      VALUE 'V'.
  1292            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1293        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1294        16  PI-RES-REF-CLM-TYPE     PIC X.
  1295        16  PI-CLM-RESC-IND         PIC X.
  1296            88  PI-CLM-RESCISSION      VALUE 'Y'.
  1297        16  PI-CLEAR-ERROR-SW       PIC X.
  1298            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1299        16  PI-PRTSW-ENTERED        PIC X.
  1300        16  PI-LTRID-ENTERED        PIC X(4).
  1301        16  PI-REASONS-ENTERED      PIC X(84).
  1302        16  PI-CERTNT1-ENTERED      PIC X(63).
  1303        16  PI-CERTNT2-ENTERED      PIC X(63).
  1304        16  FILLER                  PIC X(20).
  1305        16  PI-FINALIZED-IND        PIC X.
  1306        16  PI-BILLNT1-ENTERED      PIC X(63).
  1307        16  FILLER                  PIC X(217).
  1308    12  FILLER                      PIC X(276).
  1309*    COPY ELCAID.
  1310******************************************************************
  1311*                                                                *
  1312*                            ELCAID.                             *
  1313*                            VMOD=2.001                          *
  1314*                                                                *
  1315*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  25
* EL6316.cbl
  1316*                                                                *
  1317*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1318*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1319******************************************************************
  1320
  1321 01  DFHAID.
  1322   02  DFHNULL   PIC  X  VALUE  ' '.
  1323   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1324   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1325   02  DFHPEN    PIC  X  VALUE  '='.
  1326   02  DFHOPID   PIC  X  VALUE  'W'.
  1327   02  DFHPA1    PIC  X  VALUE  '%'.
  1328   02  DFHPA2    PIC  X  VALUE  '>'.
  1329   02  DFHPA3    PIC  X  VALUE  ','.
  1330   02  DFHPF1    PIC  X  VALUE  '1'.
  1331   02  DFHPF2    PIC  X  VALUE  '2'.
  1332   02  DFHPF3    PIC  X  VALUE  '3'.
  1333   02  DFHPF4    PIC  X  VALUE  '4'.
  1334   02  DFHPF5    PIC  X  VALUE  '5'.
  1335   02  DFHPF6    PIC  X  VALUE  '6'.
  1336   02  DFHPF7    PIC  X  VALUE  '7'.
  1337   02  DFHPF8    PIC  X  VALUE  '8'.
  1338   02  DFHPF9    PIC  X  VALUE  '9'.
  1339   02  DFHPF10   PIC  X  VALUE  ':'.
  1340   02  DFHPF11   PIC  X  VALUE  '#'.
  1341   02  DFHPF12   PIC  X  VALUE  '@'.
  1342   02  DFHPF13   PIC  X  VALUE  'A'.
  1343   02  DFHPF14   PIC  X  VALUE  'B'.
  1344   02  DFHPF15   PIC  X  VALUE  'C'.
  1345   02  DFHPF16   PIC  X  VALUE  'D'.
  1346   02  DFHPF17   PIC  X  VALUE  'E'.
  1347   02  DFHPF18   PIC  X  VALUE  'F'.
  1348   02  DFHPF19   PIC  X  VALUE  'G'.
  1349   02  DFHPF20   PIC  X  VALUE  'H'.
  1350   02  DFHPF21   PIC  X  VALUE  'I'.
  1351*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1352   02  DFHPF22   PIC  X  VALUE  '['.
  1353   02  DFHPF23   PIC  X  VALUE  '.'.
  1354   02  DFHPF24   PIC  X  VALUE  '<'.
  1355   02  DFHMSRE   PIC  X  VALUE  'X'.
  1356   02  DFHSTRF   PIC  X  VALUE  'h'.
  1357   02  DFHTRIG   PIC  X  VALUE  '"'.
  1358 01  FILLER    REDEFINES DFHAID.
  1359     12  FILLER              PIC X(8).
  1360     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1361*   COPY EL6316S.
  1362 01  EL631II.
  1363     05  FILLER            PIC  X(0012).
  1364*    -------------------------------
  1365     05  DATEL PIC S9(0004) COMP.
  1366     05  DATEF PIC  X(0001).
  1367     05  FILLER REDEFINES DATEF.
  1368         10  DATEA PIC  X(0001).
  1369     05  DATEI PIC  X(0008).
  1370*    -------------------------------
  1371     05  TIMEL PIC S9(0004) COMP.
  1372     05  TIMEF PIC  X(0001).
  1373     05  FILLER REDEFINES TIMEF.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  26
* EL6316.cbl
  1374         10  TIMEA PIC  X(0001).
  1375     05  TIMEI PIC  X(0005).
  1376*    -------------------------------
  1377     05  PROCIDL PIC S9(0004) COMP.
  1378     05  PROCIDF PIC  X(0001).
  1379     05  FILLER REDEFINES PROCIDF.
  1380         10  PROCIDA PIC  X(0001).
  1381     05  PROCIDI PIC  X(0004).
  1382*    -------------------------------
  1383     05  HOSTL PIC S9(0004) COMP.
  1384     05  HOSTF PIC  X(0001).
  1385     05  FILLER REDEFINES HOSTF.
  1386         10  HOSTA PIC  X(0001).
  1387     05  HOSTI PIC  X(0009).
  1388*    -------------------------------
  1389     05  SYSL PIC S9(0004) COMP.
  1390     05  SYSF PIC  X(0001).
  1391     05  FILLER REDEFINES SYSF.
  1392         10  SYSA PIC  X(0001).
  1393     05  SYSI PIC  X(0005).
  1394*    -------------------------------
  1395     05  COMPANYL PIC S9(0004) COMP.
  1396     05  COMPANYF PIC  X(0001).
  1397     05  FILLER REDEFINES COMPANYF.
  1398         10  COMPANYA PIC  X(0001).
  1399     05  COMPANYI PIC  X(0003).
  1400*    -------------------------------
  1401     05  DATASORL PIC S9(0004) COMP.
  1402     05  DATASORF PIC  X(0001).
  1403     05  FILLER REDEFINES DATASORF.
  1404         10  DATASORA PIC  X(0001).
  1405     05  DATASORI PIC  X(0001).
  1406*    -------------------------------
  1407     05  BATCHNOL PIC S9(0004) COMP.
  1408     05  BATCHNOF PIC  X(0001).
  1409     05  FILLER REDEFINES BATCHNOF.
  1410         10  BATCHNOA PIC  X(0001).
  1411     05  BATCHNOI PIC  X(0006).
  1412*    -------------------------------
  1413     05  BSEQNOL PIC S9(0004) COMP.
  1414     05  BSEQNOF PIC  X(0001).
  1415     05  FILLER REDEFINES BSEQNOF.
  1416         10  BSEQNOA PIC  X(0001).
  1417     05  BSEQNOI PIC  X(0008).
  1418*    -------------------------------
  1419     05  ARCHNOL PIC S9(0004) COMP.
  1420     05  ARCHNOF PIC  X(0001).
  1421     05  FILLER REDEFINES ARCHNOF.
  1422         10  ARCHNOA PIC  X(0001).
  1423     05  ARCHNOI PIC  X(0008).
  1424*    -------------------------------
  1425     05  PRTSWL PIC S9(0004) COMP.
  1426     05  PRTSWF PIC  X(0001).
  1427     05  FILLER REDEFINES PRTSWF.
  1428         10  PRTSWA PIC  X(0001).
  1429     05  PRTSWI PIC  X(0001).
  1430*    -------------------------------
  1431     05  CARRL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  27
* EL6316.cbl
  1432     05  CARRF PIC  X(0001).
  1433     05  FILLER REDEFINES CARRF.
  1434         10  CARRA PIC  X(0001).
  1435     05  CARRI PIC  X(0001).
  1436*    -------------------------------
  1437     05  GROUPL PIC S9(0004) COMP.
  1438     05  GROUPF PIC  X(0001).
  1439     05  FILLER REDEFINES GROUPF.
  1440         10  GROUPA PIC  X(0001).
  1441     05  GROUPI PIC  X(0006).
  1442*    -------------------------------
  1443     05  STATEL PIC S9(0004) COMP.
  1444     05  STATEF PIC  X(0001).
  1445     05  FILLER REDEFINES STATEF.
  1446         10  STATEA PIC  X(0001).
  1447     05  STATEI PIC  X(0002).
  1448*    -------------------------------
  1449     05  ACCTL PIC S9(0004) COMP.
  1450     05  ACCTF PIC  X(0001).
  1451     05  FILLER REDEFINES ACCTF.
  1452         10  ACCTA PIC  X(0001).
  1453     05  ACCTI PIC  X(0010).
  1454*    -------------------------------
  1455     05  EFFDTL PIC S9(0004) COMP.
  1456     05  EFFDTF PIC  X(0001).
  1457     05  FILLER REDEFINES EFFDTF.
  1458         10  EFFDTA PIC  X(0001).
  1459     05  EFFDTI PIC  X(0008).
  1460*    -------------------------------
  1461     05  CERTNOL PIC S9(0004) COMP.
  1462     05  CERTNOF PIC  X(0001).
  1463     05  FILLER REDEFINES CERTNOF.
  1464         10  CERTNOA PIC  X(0001).
  1465     05  CERTNOI PIC  X(0010).
  1466*    -------------------------------
  1467     05  CRTSFXL PIC S9(0004) COMP.
  1468     05  CRTSFXF PIC  X(0001).
  1469     05  FILLER REDEFINES CRTSFXF.
  1470         10  CRTSFXA PIC  X(0001).
  1471     05  CRTSFXI PIC  X(0001).
  1472*    -------------------------------
  1473     05  LTRIDL PIC S9(0004) COMP.
  1474     05  LTRIDF PIC  X(0001).
  1475     05  FILLER REDEFINES LTRIDF.
  1476         10  LTRIDA PIC  X(0001).
  1477     05  LTRIDI PIC  X(0004).
  1478*    -------------------------------
  1479     05  SEQNOL PIC S9(0004) COMP.
  1480     05  SEQNOF PIC  X(0001).
  1481     05  FILLER REDEFINES SEQNOF.
  1482         10  SEQNOA PIC  X(0001).
  1483     05  SEQNOI PIC  X(0006).
  1484*    -------------------------------
  1485     05  FNAMEL PIC S9(0004) COMP.
  1486     05  FNAMEF PIC  X(0001).
  1487     05  FILLER REDEFINES FNAMEF.
  1488         10  FNAMEA PIC  X(0001).
  1489     05  FNAMEI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  28
* EL6316.cbl
  1490*    -------------------------------
  1491     05  MINITL PIC S9(0004) COMP.
  1492     05  MINITF PIC  X(0001).
  1493     05  FILLER REDEFINES MINITF.
  1494         10  MINITA PIC  X(0001).
  1495     05  MINITI PIC  X(0001).
  1496*    -------------------------------
  1497     05  LNAMEL PIC S9(0004) COMP.
  1498     05  LNAMEF PIC  X(0001).
  1499     05  FILLER REDEFINES LNAMEF.
  1500         10  LNAMEA PIC  X(0001).
  1501     05  LNAMEI PIC  X(0015).
  1502*    -------------------------------
  1503     05  OLFDTL PIC S9(0004) COMP.
  1504     05  OLFDTF PIC  X(0001).
  1505     05  FILLER REDEFINES OLFDTF.
  1506         10  OLFDTA PIC  X(0001).
  1507     05  OLFDTI PIC  X(0008).
  1508*    -------------------------------
  1509     05  OLFAMTL PIC S9(0004) COMP.
  1510     05  OLFAMTF PIC  X(0001).
  1511     05  FILLER REDEFINES OLFAMTF.
  1512         10  OLFAMTA PIC  X(0001).
  1513     05  OLFAMTI PIC  X(0012).
  1514*    -------------------------------
  1515     05  OAHDTL PIC S9(0004) COMP.
  1516     05  OAHDTF PIC  X(0001).
  1517     05  FILLER REDEFINES OAHDTF.
  1518         10  OAHDTA PIC  X(0001).
  1519     05  OAHDTI PIC  X(0008).
  1520*    -------------------------------
  1521     05  OAHAMTL PIC S9(0004) COMP.
  1522     05  OAHAMTF PIC  X(0001).
  1523     05  FILLER REDEFINES OAHAMTF.
  1524         10  OAHAMTA PIC  X(0001).
  1525     05  OAHAMTI PIC  X(0012).
  1526*    -------------------------------
  1527     05  NLFDTL PIC S9(0004) COMP.
  1528     05  NLFDTF PIC  X(0001).
  1529     05  FILLER REDEFINES NLFDTF.
  1530         10  NLFDTA PIC  X(0001).
  1531     05  NLFDTI PIC  X(0008).
  1532*    -------------------------------
  1533     05  NLFAMTL PIC S9(0004) COMP.
  1534     05  NLFAMTF PIC  X(0001).
  1535     05  FILLER REDEFINES NLFAMTF.
  1536         10  NLFAMTA PIC  X(0001).
  1537     05  NLFAMTI PIC  X(0012).
  1538*    -------------------------------
  1539     05  NAHDTL PIC S9(0004) COMP.
  1540     05  NAHDTF PIC  X(0001).
  1541     05  FILLER REDEFINES NAHDTF.
  1542         10  NAHDTA PIC  X(0001).
  1543     05  NAHDTI PIC  X(0008).
  1544*    -------------------------------
  1545     05  NAHAMTL PIC S9(0004) COMP.
  1546     05  NAHAMTF PIC  X(0001).
  1547     05  FILLER REDEFINES NAHAMTF.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  29
* EL6316.cbl
  1548         10  NAHAMTA PIC  X(0001).
  1549     05  NAHAMTI PIC  X(0012).
  1550*    -------------------------------
  1551     05  INPDTL PIC S9(0004) COMP.
  1552     05  INPDTF PIC  X(0001).
  1553     05  FILLER REDEFINES INPDTF.
  1554         10  INPDTA PIC  X(0001).
  1555     05  INPDTI PIC  X(0008).
  1556*    -------------------------------
  1557     05  PROCDTL PIC S9(0004) COMP.
  1558     05  PROCDTF PIC  X(0001).
  1559     05  FILLER REDEFINES PROCDTF.
  1560         10  PROCDTA PIC  X(0001).
  1561     05  PROCDTI PIC  X(0008).
  1562*    -------------------------------
  1563     05  LFCOMML PIC S9(0004) COMP.
  1564     05  LFCOMMF PIC  X(0001).
  1565     05  FILLER REDEFINES LFCOMMF.
  1566         10  LFCOMMA PIC  X(0001).
  1567     05  LFCOMMI PIC  X(0006).
  1568*    -------------------------------
  1569     05  AHCOMML PIC S9(0004) COMP.
  1570     05  AHCOMMF PIC  X(0001).
  1571     05  FILLER REDEFINES AHCOMMF.
  1572         10  AHCOMMA PIC  X(0001).
  1573     05  AHCOMMI PIC  X(0006).
  1574*    -------------------------------
  1575     05  RCD01L PIC S9(0004) COMP.
  1576     05  RCD01F PIC  X(0001).
  1577     05  FILLER REDEFINES RCD01F.
  1578         10  RCD01A PIC  X(0001).
  1579     05  RCD01I PIC  X(0004).
  1580*    -------------------------------
  1581     05  RCD02L PIC S9(0004) COMP.
  1582     05  RCD02F PIC  X(0001).
  1583     05  FILLER REDEFINES RCD02F.
  1584         10  RCD02A PIC  X(0001).
  1585     05  RCD02I PIC  X(0004).
  1586*    -------------------------------
  1587     05  RCD03L PIC S9(0004) COMP.
  1588     05  RCD03F PIC  X(0001).
  1589     05  FILLER REDEFINES RCD03F.
  1590         10  RCD03A PIC  X(0001).
  1591     05  RCD03I PIC  X(0004).
  1592*    -------------------------------
  1593     05  RCD04L PIC S9(0004) COMP.
  1594     05  RCD04F PIC  X(0001).
  1595     05  FILLER REDEFINES RCD04F.
  1596         10  RCD04A PIC  X(0001).
  1597     05  RCD04I PIC  X(0004).
  1598*    -------------------------------
  1599     05  RCD05L PIC S9(0004) COMP.
  1600     05  RCD05F PIC  X(0001).
  1601     05  FILLER REDEFINES RCD05F.
  1602         10  RCD05A PIC  X(0001).
  1603     05  RCD05I PIC  X(0004).
  1604*    -------------------------------
  1605     05  RCD06L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  30
* EL6316.cbl
  1606     05  RCD06F PIC  X(0001).
  1607     05  FILLER REDEFINES RCD06F.
  1608         10  RCD06A PIC  X(0001).
  1609     05  RCD06I PIC  X(0004).
  1610*    -------------------------------
  1611     05  RCD07L PIC S9(0004) COMP.
  1612     05  RCD07F PIC  X(0001).
  1613     05  FILLER REDEFINES RCD07F.
  1614         10  RCD07A PIC  X(0001).
  1615     05  RCD07I PIC  X(0004).
  1616*    -------------------------------
  1617     05  RCD08L PIC S9(0004) COMP.
  1618     05  RCD08F PIC  X(0001).
  1619     05  FILLER REDEFINES RCD08F.
  1620         10  RCD08A PIC  X(0001).
  1621     05  RCD08I PIC  X(0004).
  1622*    -------------------------------
  1623     05  RCD09L PIC S9(0004) COMP.
  1624     05  RCD09F PIC  X(0001).
  1625     05  FILLER REDEFINES RCD09F.
  1626         10  RCD09A PIC  X(0001).
  1627     05  RCD09I PIC  X(0004).
  1628*    -------------------------------
  1629     05  RCD10L PIC S9(0004) COMP.
  1630     05  RCD10F PIC  X(0001).
  1631     05  FILLER REDEFINES RCD10F.
  1632         10  RCD10A PIC  X(0001).
  1633     05  RCD10I PIC  X(0004).
  1634*    -------------------------------
  1635     05  RCD11L PIC S9(0004) COMP.
  1636     05  RCD11F PIC  X(0001).
  1637     05  FILLER REDEFINES RCD11F.
  1638         10  RCD11A PIC  X(0001).
  1639     05  RCD11I PIC  X(0004).
  1640*    -------------------------------
  1641     05  RCD12L PIC S9(0004) COMP.
  1642     05  RCD12F PIC  X(0001).
  1643     05  FILLER REDEFINES RCD12F.
  1644         10  RCD12A PIC  X(0001).
  1645     05  RCD12I PIC  X(0004).
  1646*    -------------------------------
  1647     05  CRTNT1L PIC S9(0004) COMP.
  1648     05  CRTNT1F PIC  X(0001).
  1649     05  FILLER REDEFINES CRTNT1F.
  1650         10  CRTNT1A PIC  X(0001).
  1651     05  CRTNT1I PIC  X(0063).
  1652*    -------------------------------
  1653     05  CRTNT2L PIC S9(0004) COMP.
  1654     05  CRTNT2F PIC  X(0001).
  1655     05  FILLER REDEFINES CRTNT2F.
  1656         10  CRTNT2A PIC  X(0001).
  1657     05  CRTNT2I PIC  X(0063).
  1658*    -------------------------------
  1659     05  BILNT1L PIC S9(0004) COMP.
  1660     05  BILNT1F PIC  X(0001).
  1661     05  FILLER REDEFINES BILNT1F.
  1662         10  BILNT1A PIC  X(0001).
  1663     05  BILNT1I PIC  X(0063).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  31
* EL6316.cbl
  1664*    -------------------------------
  1665     05  ERRMSGL PIC S9(0004) COMP.
  1666     05  ERRMSGF PIC  X(0001).
  1667     05  FILLER REDEFINES ERRMSGF.
  1668         10  ERRMSGA PIC  X(0001).
  1669     05  ERRMSGI PIC  X(0075).
  1670*    -------------------------------
  1671     05  PFENTRL PIC S9(0004) COMP.
  1672     05  PFENTRF PIC  X(0001).
  1673     05  FILLER REDEFINES PFENTRF.
  1674         10  PFENTRA PIC  X(0001).
  1675     05  PFENTRI PIC  9(2).
  1676 01  EL631IO REDEFINES EL631II.
  1677     05  FILLER            PIC  X(0012).
  1678*    -------------------------------
  1679     05  FILLER            PIC  X(0003).
  1680     05  DATEO PIC  X(0008).
  1681*    -------------------------------
  1682     05  FILLER            PIC  X(0003).
  1683     05  TIMEO PIC  99.99.
  1684*    -------------------------------
  1685     05  FILLER            PIC  X(0003).
  1686     05  PROCIDO PIC  X(0004).
  1687*    -------------------------------
  1688     05  FILLER            PIC  X(0003).
  1689     05  HOSTO PIC  X(0009).
  1690*    -------------------------------
  1691     05  FILLER            PIC  X(0003).
  1692     05  SYSO PIC  X(0005).
  1693*    -------------------------------
  1694     05  FILLER            PIC  X(0003).
  1695     05  COMPANYO PIC  X(0003).
  1696*    -------------------------------
  1697     05  FILLER            PIC  X(0003).
  1698     05  DATASORO PIC  X(0001).
  1699*    -------------------------------
  1700     05  FILLER            PIC  X(0003).
  1701     05  BATCHNOO PIC  X(0006).
  1702*    -------------------------------
  1703     05  FILLER            PIC  X(0003).
  1704     05  BSEQNOO PIC  X(0008).
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  ARCHNOO PIC  X(0008).
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  PRTSWO PIC  X(0001).
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  CARRO PIC  X(0001).
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  GROUPO PIC  X(0006).
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  STATEO PIC  X(0002).
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  32
* EL6316.cbl
  1722     05  ACCTO PIC  X(0010).
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  EFFDTO PIC  X(0008).
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
  1728     05  CERTNOO PIC  X(0010).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  CRTSFXO PIC  X(0001).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  LTRIDO PIC  X(0004).
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  SEQNOO PIC  999999.
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  FNAMEO PIC  X(0010).
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  MINITO PIC  X(0001).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  LNAMEO PIC  X(0015).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  OLFDTO PIC  X(0008).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  OLFAMTO PIC  Z,ZZZ,999.99.
  1753*    -------------------------------
  1754     05  FILLER            PIC  X(0003).
  1755     05  OAHDTO PIC  X(0008).
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  OAHAMTO PIC  Z,ZZZ,999.99.
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
  1761     05  NLFDTO PIC  X(0008).
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  NLFAMTO PIC  Z,ZZZ,999.99.
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  NAHDTO PIC  X(0008).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  NAHAMTO PIC  Z,ZZZ,999.99.
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  INPDTO PIC  X(0008).
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  PROCDTO PIC  X(0008).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  LFCOMMO PIC  .99999.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  33
* EL6316.cbl
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  AHCOMMO PIC  .99999.
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  RCD01O PIC  X(0004).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  RCD02O PIC  X(0004).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  RCD03O PIC  X(0004).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  RCD04O PIC  X(0004).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  RCD05O PIC  X(0004).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  RCD06O PIC  X(0004).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  RCD07O PIC  X(0004).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  RCD08O PIC  X(0004).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  RCD09O PIC  X(0004).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  RCD10O PIC  X(0004).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  RCD11O PIC  X(0004).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  RCD12O PIC  X(0004).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  CRTNT1O PIC  X(0063).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  CRTNT2O PIC  X(0063).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  BILNT1O PIC  X(0063).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  ERRMSGO PIC  X(0075).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  PFENTRO PIC  X(0002).
  1834*    -------------------------------
  1835 01  FILLER REDEFINES EL631II.
  1836     12  FILLER                   PIC X(357).
  1837     12  REASONCDS.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  34
* EL6316.cbl
  1838         16  FILLER OCCURS 12.
  1839             20  REACDL       PIC S9(4) COMP.
  1840             20  REACDA       PIC X.
  1841             20  REACD-IN     PIC X(4).
  1842     12  FILLER               PIC X(215).
  1843****************************************************************
  1844*
  1845* Copyright (c) 2007 by Clerity Solutions, Inc.
  1846* All rights reserved.
  1847*
  1848****************************************************************
  1849 01  DFHEIV.
  1850   02  DFHEIV0               PIC X(35).
  1851   02  DFHEIV1               PIC X(08).
  1852   02  DFHEIV2               PIC X(08).
  1853   02  DFHEIV3               PIC X(08).
  1854   02  DFHEIV4               PIC X(06).
  1855   02  DFHEIV5               PIC X(04).
  1856   02  DFHEIV6               PIC X(04).
  1857   02  DFHEIV7               PIC X(02).
  1858   02  DFHEIV8               PIC X(02).
  1859   02  DFHEIV9               PIC X(01).
  1860   02  DFHEIV10              PIC S9(7) COMP-3.
  1861   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1862   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1863   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1864   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1865   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1866   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1867   02  DFHEIV17              PIC X(04).
  1868   02  DFHEIV18              PIC X(04).
  1869   02  DFHEIV19              PIC X(04).
  1870   02  DFHEIV20              USAGE IS POINTER.
  1871   02  DFHEIV21              USAGE IS POINTER.
  1872   02  DFHEIV22              USAGE IS POINTER.
  1873   02  DFHEIV23              USAGE IS POINTER.
  1874   02  DFHEIV24              USAGE IS POINTER.
  1875   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1876   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1877   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1878   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1879   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1880   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1881   02  FILLER                PIC X(02).
  1882   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1883   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1884   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1885   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1886   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1887 LINKAGE  SECTION.
  1888*****************************************************************
  1889*                                                               *
  1890* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1891* All rights reserved.                                          *
  1892*                                                               *
  1893*****************************************************************
  1894 01  dfheiblk.
  1895     02  eibtime          pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  35
* EL6316.cbl
  1896     02  eibdate          pic s9(7) comp-3.
  1897     02  eibtrnid         pic x(4).
  1898     02  eibtaskn         pic s9(7) comp-3.
  1899     02  eibtrmid         pic x(4).
  1900     02  dfheigdi         pic s9(4) comp.
  1901     02  eibcposn         pic s9(4) comp.
  1902     02  eibcalen         pic s9(4) comp.
  1903     02  eibaid           pic x(1).
  1904     02  eibfiller1       pic x(1).
  1905     02  eibfn            pic x(2).
  1906     02  eibfiller2       pic x(2).
  1907     02  eibrcode         pic x(6).
  1908     02  eibfiller3       pic x(2).
  1909     02  eibds            pic x(8).
  1910     02  eibreqid         pic x(8).
  1911     02  eibrsrce         pic x(8).
  1912     02  eibsync          pic x(1).
  1913     02  eibfree          pic x(1).
  1914     02  eibrecv          pic x(1).
  1915     02  eibsend          pic x(1).
  1916     02  eibatt           pic x(1).
  1917     02  eibeoc           pic x(1).
  1918     02  eibfmh           pic x(1).
  1919     02  eibcompl         pic x(1).
  1920     02  eibsig           pic x(1).
  1921     02  eibconf          pic x(1).
  1922     02  eiberr           pic x(1).
  1923     02  eibrldbk         pic x(1).
  1924     02  eiberrcd         pic x(4).
  1925     02  eibsynrb         pic x(1).
  1926     02  eibnodat         pic x(1).
  1927     02  eibfiller5       pic x(2).
  1928     02  eibresp          pic 9(09) comp.
  1929     02  eibresp2         pic 9(09) comp.
  1930     02  dfheigdj         pic s9(4) comp.
  1931     02  dfheigdk         pic s9(4) comp.
  1932 01  DFHCOMMAREA                 PIC X(1300).
  1933 01  var  pic x(30).
  1934*                                COPY ERCACCT.
  1935******************************************************************
  1936*                                                                *
  1937*                                                                *
  1938*                            ERCACCT                             *
  1939*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1940*                            VMOD=2.031                          *
  1941*                                                                *
  1942*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1943*                                                                *
  1944*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1945*   VSAM ACCOUNT MASTER FILES.                                   *
  1946*                                                                *
  1947*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1948*                                                                *
  1949*   FILE TYPE = VSAM,KSDS                                        *
  1950*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1951*                                                                *
  1952*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1953*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  36
* EL6316.cbl
  1954*                                                                *
  1955*   LOG = NO                                                     *
  1956*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1957*                                                                *
  1958*                                                                *
  1959******************************************************************
  1960*                   C H A N G E   L O G
  1961*
  1962* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1963*-----------------------------------------------------------------
  1964*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1965* EFFECTIVE    NUMBER
  1966*-----------------------------------------------------------------
  1967* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1968* 092705    2005050300006  PEMA  ADD SPP LEASES
  1969* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1970* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1971* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1972* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1973* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1974******************************************************************
  1975
  1976 01  ACCOUNT-MASTER.
  1977     12  AM-RECORD-ID                      PIC XX.
  1978         88  VALID-AM-ID                      VALUE 'AM'.
  1979
  1980     12  AM-CONTROL-PRIMARY.
  1981         16  AM-COMPANY-CD                 PIC X.
  1982         16  AM-MSTR-CNTRL.
  1983             20  AM-CONTROL-A.
  1984                 24  AM-CARRIER            PIC X.
  1985                 24  AM-GROUPING.
  1986                     28 AM-GROUPING-PREFIX PIC XXX.
  1987                     28 AM-GROUPING-PRIME  PIC XXX.
  1988                 24  AM-STATE              PIC XX.
  1989                 24  AM-ACCOUNT.
  1990                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1991                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1992             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1993                                           PIC X(19).
  1994             20  AM-CNTRL-B.
  1995                 24  AM-EXPIRATION-DT      PIC XX.
  1996                 24  FILLER                PIC X(4).
  1997             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1998                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1999
  2000     12  AM-CONTROL-BY-VAR-GRP.
  2001         16  AM-COMPANY-CD-A1              PIC X.
  2002         16  AM-VG-CARRIER                 PIC X.
  2003         16  AM-VG-GROUPING                PIC X(6).
  2004         16  AM-VG-STATE                   PIC XX.
  2005         16  AM-VG-ACCOUNT                 PIC X(10).
  2006         16  AM-VG-DATE.
  2007             20  AM-VG-EXPIRATION-DT       PIC XX.
  2008             20  FILLER                    PIC X(4).
  2009         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2010                                           PIC 9(11)      COMP-3.
  2011     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  37
* EL6316.cbl
  2012         16  FILLER                        PIC X(10).
  2013         16  AM-VG-KEY3.
  2014             20  AM-VG3-ACCOUNT            PIC X(10).
  2015             20  AM-VG3-EXP-DT             PIC XX.
  2016         16  FILLER                        PIC X(4).
  2017     12  AM-MAINT-INFORMATION.
  2018         16  AM-LAST-MAINT-DT              PIC XX.
  2019         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2020         16  AM-LAST-MAINT-USER            PIC X(4).
  2021         16  FILLER                        PIC XX.
  2022
  2023     12  AM-EFFECTIVE-DT                   PIC XX.
  2024     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2025
  2026     12  AM-PREV-DATES  COMP-3.
  2027         16  AM-PREV-EXP-DT                PIC 9(11).
  2028         16  AM-PREV-EFF-DT                PIC 9(11).
  2029
  2030     12  AM-REPORT-CODE-1                  PIC X(10).
  2031     12  AM-REPORT-CODE-2                  PIC X(10).
  2032
  2033     12  AM-CITY-CODE                      PIC X(4).
  2034     12  AM-COUNTY-PARISH                  PIC X(6).
  2035
  2036     12  AM-NAME                           PIC X(30).
  2037     12  AM-PERSON                         PIC X(30).
  2038     12  AM-ADDRS                          PIC X(30).
  2039     12  AM-CITY.
  2040         16  AM-ADDR-CITY                  PIC X(28).
  2041         16  AM-ADDR-STATE                 PIC XX.
  2042     12  AM-ZIP.
  2043         16  AM-ZIP-PRIME.
  2044             20  AM-ZIP-PRI-1ST            PIC X.
  2045                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2046             20  FILLER                    PIC X(4).
  2047         16  AM-ZIP-PLUS4                  PIC X(4).
  2048     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2049         16  AM-CAN-POSTAL-1               PIC XXX.
  2050         16  AM-CAN-POSTAL-2               PIC XXX.
  2051         16  FILLER                        PIC XXX.
  2052     12  AM-TEL-NO.
  2053         16  AM-AREA-CODE                  PIC 999.
  2054         16  AM-TEL-PRE                    PIC 999.
  2055         16  AM-TEL-NBR                    PIC 9(4).
  2056     12  AM-TEL-LOC                        PIC X.
  2057         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2058         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2059
  2060     12  AM-COMM-STRUCTURE.
  2061         16  AM-DEFN-1.
  2062             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2063                 24  AM-AGT.
  2064                     28  AM-AGT-PREFIX     PIC X(4).
  2065                     28  AM-AGT-PRIME      PIC X(6).
  2066                 24  AM-COM-TYP            PIC X.
  2067                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2068                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2069                 24  AM-A-COM              PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  38
* EL6316.cbl
  2070                 24  AM-RECALC-LV-INDIC    PIC X.
  2071                 24  AM-RETRO-LV-INDIC     PIC X.
  2072                 24  AM-GL-CODES           PIC X.
  2073                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2074                 24  FILLER                PIC X(01).
  2075         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2076             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2077                 24  FILLER                PIC X(11).
  2078                 24  AM-L-COMA             PIC XXX.
  2079                 24  AM-J-COMA             PIC XXX.
  2080                 24  AM-A-COMA             PIC XXX.
  2081                 24  FILLER                PIC X(6).
  2082
  2083     12  AM-COMM-CHANGE-STATUS             PIC X.
  2084         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2085
  2086     12  AM-CSR-CODE                       PIC X(4).
  2087
  2088     12  AM-BILLING-STATUS                 PIC X.
  2089         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2090         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2091     12  AM-AUTO-REFUND-SW                 PIC X.
  2092         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2093         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2094     12  AM-GPCD                           PIC 99.
  2095     12  AM-IG                             PIC X.
  2096         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2097         88  AM-HAS-GROUP                     VALUE '2'.
  2098     12  AM-STATUS                         PIC X.
  2099         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2100         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2101         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2102         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2103         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2104         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2105     12  AM-REMIT-TO                       PIC 99.
  2106     12  AM-ID-NO                          PIC X(11).
  2107
  2108     12  AM-CAL-TABLE                      PIC XX.
  2109     12  AM-LF-DEVIATION                   PIC XXX.
  2110     12  AM-AH-DEVIATION                   PIC XXX.
  2111     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2112     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2113     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2114     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2115     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2116     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2117
  2118     12  AM-USER-FIELDS.
  2119         16  AM-FLD-1                      PIC XX.
  2120         16  AM-FLD-2                      PIC XX.
  2121         16  AM-FLD-3                      PIC XX.
  2122         16  AM-FLD-4                      PIC XX.
  2123         16  AM-FLD-5                      PIC XX.
  2124
  2125     12  AM-1ST-PROD-DATE.
  2126         16  AM-1ST-PROD-YR                PIC XX.
  2127         16  AM-1ST-PROD-MO                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  39
* EL6316.cbl
  2128         16  AM-1ST-PROD-DA                PIC XX.
  2129     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2130     12  AM-CERTS-PURGED-DATE.
  2131         16  AM-PUR-YR                     PIC XX.
  2132         16  AM-PUR-MO                     PIC XX.
  2133         16  AM-PUR-DA                     PIC XX.
  2134     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2135     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2136     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2137     12  AM-INACTIVE-DATE.
  2138         16  AM-INA-MO                     PIC 99.
  2139         16  AM-INA-DA                     PIC 99.
  2140         16  AM-INA-YR                     PIC 99.
  2141     12  AM-AR-HI-CERT-DATE                PIC XX.
  2142
  2143     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2144     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2145
  2146     12  AM-OB-PAYMENT-MODE                PIC X.
  2147         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2148         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2149         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2150         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2151
  2152     12  AM-AH-ONLY-INDICATOR              PIC X.
  2153         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2154         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2155
  2156     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2157
  2158     12  AM-OVER-SHORT.
  2159         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2160         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2161
  2162     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2163     12  AM-DCC-CLP-STATE                  PIC XX.
  2164
  2165     12  AM-RECALC-COMM                    PIC X.
  2166     12  AM-RECALC-REIN                    PIC X.
  2167
  2168     12  AM-REI-TABLE                      PIC XXX.
  2169     12  AM-REI-ET-LF                      PIC X.
  2170     12  AM-REI-ET-AH                      PIC X.
  2171     12  AM-REI-PE-LF                      PIC X.
  2172     12  AM-REI-PE-AH                      PIC X.
  2173     12  AM-REI-PRT-ST                     PIC X.
  2174     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2175     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2176     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2177     12  AM-REI-GROUP-A                    PIC X(6).
  2178     12  AM-REI-MORT                       PIC X(4).
  2179     12  AM-REI-PRT-OW                     PIC X.
  2180     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2181     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2182     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2183     12  AM-REI-GROUP-B                    PIC X(6).
  2184
  2185     12  AM-TRUST-TYPE                     PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  40
* EL6316.cbl
  2186
  2187     12  AM-EMPLOYER-STMT-USED             PIC X.
  2188     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2189
  2190     12  AM-STD-AH-TYPE                    PIC XX.
  2191     12  AM-EARN-METHODS.
  2192         16  AM-EARN-METHOD-R              PIC X.
  2193             88 AM-REF-RL-R78                 VALUE 'R'.
  2194             88 AM-REF-RL-PR                  VALUE 'P'.
  2195             88 AM-REF-RL-MEAN                VALUE 'M'.
  2196             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2197         16  AM-EARN-METHOD-L              PIC X.
  2198             88 AM-REF-LL-R78                 VALUE 'R'.
  2199             88 AM-REF-LL-PR                  VALUE 'P'.
  2200             88 AM-REF-LL-MEAN                VALUE 'M'.
  2201             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2202         16  AM-EARN-METHOD-A              PIC X.
  2203             88 AM-REF-AH-R78                 VALUE 'R'.
  2204             88 AM-REF-AH-PR                  VALUE 'P'.
  2205             88 AM-REF-AH-MEAN                VALUE 'M'.
  2206             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2207             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2208             88 AM-REF-AH-NET                 VALUE 'N'.
  2209
  2210     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2211     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2212     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2213
  2214     12  AM-RET-Y-N                        PIC X.
  2215     12  AM-RET-P-E                        PIC X.
  2216     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2217     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2218     12  AM-RET-GRP                        PIC X(6).
  2219     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2220         16  AM-POOL-PRIME                 PIC XXX.
  2221         16  AM-POOL-SUB                   PIC XXX.
  2222     12  AM-RETRO-EARNINGS.
  2223         16  AM-RET-EARN-R                 PIC X.
  2224         16  AM-RET-EARN-L                 PIC X.
  2225         16  AM-RET-EARN-A                 PIC X.
  2226     12  AM-RET-ST-TAX-USE                 PIC X.
  2227         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2228         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2229     12  AM-RETRO-BEG-EARNINGS.
  2230         16  AM-RET-BEG-EARN-R             PIC X.
  2231         16  AM-RET-BEG-EARN-L             PIC X.
  2232         16  AM-RET-BEG-EARN-A             PIC X.
  2233     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2234     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2235
  2236     12  AM-USER-SELECT-OPTIONS.
  2237         16  AM-USER-SELECT-1              PIC X(10).
  2238         16  AM-USER-SELECT-2              PIC X(10).
  2239         16  AM-USER-SELECT-3              PIC X(10).
  2240         16  AM-USER-SELECT-4              PIC X(10).
  2241         16  AM-USER-SELECT-5              PIC X(10).
  2242
  2243     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  41
* EL6316.cbl
  2244
  2245     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2246
  2247     12  AM-RPT045A-SWITCH                 PIC X.
  2248         88  RPT045A-OFF                   VALUE 'N'.
  2249
  2250     12  AM-INSURANCE-LIMITS.
  2251         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2252         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2253
  2254     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2255         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2256
  2257     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2258         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2259         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2260
  2261     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2262
  2263     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2264     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2265     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2266     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2267     12  AM-DCC-UEF-STATE                  PIC XX.
  2268     12  FILLER                            PIC XXX.
  2269     12  AM-REPORT-CODE-3                  PIC X(10).
  2270*    12  FILLER                            PIC X(22).
  2271
  2272     12  AM-RESERVE-DATE.
  2273         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2274         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2275         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2276
  2277     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2278     12  AM-NOTIFICATION-TYPES.
  2279         16  AM-NOTIF-OF-LETTERS           PIC X.
  2280         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2281         16  AM-NOTIF-OF-REPORTS           PIC X.
  2282         16  AM-NOTIF-OF-STATUS            PIC X.
  2283
  2284     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2285         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2286         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2287         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2288         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2289
  2290     12  AM-BENEFIT-CONTROLS.
  2291         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2292             20  AM-BENEFIT-CODE           PIC XX.
  2293             20  AM-BENEFIT-TYPE           PIC X.
  2294             20  AM-BENEFIT-REVISION       PIC XXX.
  2295             20  AM-BENEFIT-REM-TERM       PIC X.
  2296             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2297             20  FILLER                    PIC XX.
  2298         16  FILLER                        PIC X(80).
  2299
  2300     12  AM-TRANSFER-DATA.
  2301         16  AM-TRANSFERRED-FROM.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  42
* EL6316.cbl
  2302             20  AM-TRNFROM-CARRIER        PIC X.
  2303             20  AM-TRNFROM-GROUPING.
  2304                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2305                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2306             20  AM-TRNFROM-STATE          PIC XX.
  2307             20  AM-TRNFROM-ACCOUNT.
  2308                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2309                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2310             20  AM-TRNFROM-DTE            PIC XX.
  2311         16  AM-TRANSFERRED-TO.
  2312             20  AM-TRNTO-CARRIER          PIC X.
  2313             20  AM-TRNTO-GROUPING.
  2314                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2315                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2316             20  AM-TRNTO-STATE            PIC XX.
  2317             20  AM-TRNTO-ACCOUNT.
  2318                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2319                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2320             20  AM-TRNTO-DTE              PIC XX.
  2321         16  FILLER                        PIC X(10).
  2322
  2323     12  AM-SAVED-REMIT-TO                 PIC 99.
  2324
  2325     12  AM-COMM-STRUCTURE-SAVED.
  2326         16  AM-DEFN-1-SAVED.
  2327             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2328                 24  AM-AGT-SV             PIC X(10).
  2329                 24  AM-COM-TYP-SV         PIC X.
  2330                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2331                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2332                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2333                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2334                 24  FILLER                PIC X.
  2335                 24  AM-GL-CODES-SV        PIC X.
  2336                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2337                 24  FILLER                PIC X.
  2338         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2339             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2340                 24  FILLER                PIC X(11).
  2341                 24  AM-L-COMA-SV          PIC XXX.
  2342                 24  AM-J-COMA-SV          PIC XXX.
  2343                 24  AM-A-COMA-SV          PIC XXX.
  2344                 24  FILLER                PIC X(6).
  2345
  2346     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2347         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2348            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2349            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2350            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2351
  2352     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2353     12  FILLER                            PIC X(120).
  2354
  2355     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2356         16  AM-CONTROL-NAME               PIC X(30).
  2357         16  AM-EXECUTIVE-ONE.
  2358             20  AM-EXEC1-NAME             PIC X(15).
  2359             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  43
* EL6316.cbl
  2360                                                          COMP-3.
  2361             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2362                                                          COMP-3.
  2363         16  AM-EXECUTIVE-TWO.
  2364             20  AM-EXEC2-NAME             PIC X(15).
  2365             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2366                                                          COMP-3.
  2367             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2368                                                          COMP-3.
  2369
  2370     12  AM-RETRO-ADDITIONAL-DATA.
  2371         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2372         16  AM-RETRO-PREM-P-E             PIC X.
  2373         16  AM-RETRO-CLMS-P-I             PIC X.
  2374         16  AM-RETRO-RET-BRACKET-LF.
  2375             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2376                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2377                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2378             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2379                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2380                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2381             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2382                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2383                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2384         16  AM-RETRO-RET-BRACKET-AH.
  2385             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2386                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2387                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2388                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2389             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2390                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2391                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2392             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2393                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2394                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2395
  2396     12  AM-COMMENTS.
  2397         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2398
  2399     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2400         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2401         16  AM-FLI-BILLING-CODE           PIC X.
  2402         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2403         16  AM-FLI-UNITED-IDENT           PIC X.
  2404         16  AM-FLI-INTEREST-LOST-DATA.
  2405             20  AM-FLI-BANK-NO            PIC X(5).
  2406             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2407             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2408             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2409         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2410             20  AM-FLI-AGT                PIC X(9).
  2411             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2412             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2413         16  FILLER                        PIC X(102).
  2414
  2415     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2416         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2417             20  AM-BENEFIT-DMD-CODE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  44
* EL6316.cbl
  2418             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2419             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2420             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2421             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2422         16  FILLER                          PIC X(10).
  2423******************************************************************
  2424*                                COPY ELCCNTL.
  2425******************************************************************
  2426*                                                                *
  2427*                                                                *
  2428*                            ELCCNTL.                            *
  2429*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2430*                            VMOD=2.059                          *
  2431*                                                                *
  2432*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2433*                                                                *
  2434*   FILE TYPE = VSAM,KSDS                                        *
  2435*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2436*                                                                *
  2437*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2438*       ALTERNATE INDEX = NONE                                   *
  2439*                                                                *
  2440*   LOG = YES                                                    *
  2441*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2442******************************************************************
  2443*                   C H A N G E   L O G
  2444*
  2445* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2446*-----------------------------------------------------------------
  2447*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2448* EFFECTIVE    NUMBER
  2449*-----------------------------------------------------------------
  2450* 082503                   PEMA  ADD BENEFIT GROUP
  2451* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2452* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2453* 092705    2005050300006  PEMA  ADD SPP LEASES
  2454* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2455* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2456* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2457* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2458* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2459* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2460******************************************************************
  2461*
  2462 01  CONTROL-FILE.
  2463     12  CF-RECORD-ID                       PIC XX.
  2464         88  VALID-CF-ID                        VALUE 'CF'.
  2465
  2466     12  CF-CONTROL-PRIMARY.
  2467         16  CF-COMPANY-ID                  PIC XXX.
  2468         16  CF-RECORD-TYPE                 PIC X.
  2469             88  CF-COMPANY-MASTER              VALUE '1'.
  2470             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2471             88  CF-STATE-MASTER                VALUE '3'.
  2472             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2473             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2474             88  CF-CARRIER-MASTER              VALUE '6'.
  2475             88  CF-MORTALITY-MASTER            VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  45
* EL6316.cbl
  2476             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2477             88  CF-TERMINAL-MASTER             VALUE '9'.
  2478             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2479             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2480             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2481             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2482             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2483             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2484             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2485             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2486             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2487         16  CF-ACCESS-CD-GENL              PIC X(4).
  2488         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2489             20  CF-PROCESSOR               PIC X(4).
  2490         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2491             20  CF-STATE-CODE              PIC XX.
  2492             20  FILLER                     PIC XX.
  2493         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2494             20  FILLER                     PIC XX.
  2495             20  CF-HI-BEN-IN-REC           PIC XX.
  2496         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2497             20  FILLER                     PIC XXX.
  2498             20  CF-CARRIER-CNTL            PIC X.
  2499         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2500             20  FILLER                     PIC XX.
  2501             20  CF-HI-TYPE-IN-REC          PIC 99.
  2502         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2503             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2504                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2505             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2506             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2507         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2508             20  FILLER                     PIC X.
  2509             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2510         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2511             20  FILLER                     PIC XX.
  2512             20  CF-MORTGAGE-PLAN           PIC XX.
  2513         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2514
  2515     12  CF-LAST-MAINT-DT                   PIC XX.
  2516     12  CF-LAST-MAINT-BY                   PIC X(4).
  2517     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2518
  2519     12  CF-RECORD-BODY                     PIC X(728).
  2520
  2521
  2522****************************************************************
  2523*             COMPANY MASTER RECORD                            *
  2524****************************************************************
  2525
  2526     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2527         16  CF-COMPANY-ADDRESS.
  2528             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2529             20  CF-CL-IN-CARE-OF           PIC X(30).
  2530             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2531             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2532             20  CF-CL-CITY-STATE           PIC X(30).
  2533             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  46
* EL6316.cbl
  2534             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2535         16  CF-COMPANY-CD                  PIC X.
  2536         16  CF-COMPANY-PASSWORD            PIC X(8).
  2537         16  CF-SECURITY-OPTION             PIC X.
  2538             88  ALL-SECURITY                   VALUE '1'.
  2539             88  COMPANY-VERIFY                 VALUE '2'.
  2540             88  PROCESSOR-VERIFY               VALUE '3'.
  2541             88  NO-SECURITY                    VALUE '4'.
  2542             88  ALL-BUT-TERM                   VALUE '5'.
  2543         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2544             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2545         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2546             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2547         16  CF-INFORCE-LOCATION            PIC X.
  2548             88  CERTS-ARE-ONLINE               VALUE '1'.
  2549             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2550             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2551         16  CF-LOWER-CASE-LETTERS          PIC X.
  2552         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2553             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2554             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2555             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2556             88  CF-ACCNT-CNTL                  VALUE '3'.
  2557             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2558
  2559         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2560         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2561
  2562         16  CF-LGX-CREDIT-USER             PIC X.
  2563             88  CO-IS-NOT-USER                 VALUE 'N'.
  2564             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2565
  2566         16 CF-CREDIT-CALC-CODES.
  2567             20  CF-CR-REM-TERM-CALC PIC X.
  2568               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2569               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2570               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2571               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2572               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2573               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2574               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2575             20  CF-CR-R78-METHOD           PIC X.
  2576               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2577               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2578
  2579         16  CF-CLAIM-CONTROL-COUNTS.
  2580             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2581                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2582
  2583             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2584                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2585
  2586             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2587                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2588
  2589             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2590                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2591
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  47
* EL6316.cbl
  2592         16  CF-CURRENT-MONTH-END           PIC XX.
  2593
  2594         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2595             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2596             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2597             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2598             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2599                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2600                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2601             20  CF-CO-PREM-REJECT-SW       PIC X.
  2602                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2603                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2604             20  CF-CO-REF-REJECT-SW        PIC X.
  2605                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2606                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2607
  2608         16  CF-CO-REPORTING-DT             PIC XX.
  2609         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2610         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2611           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2612           88  CF-CO-MONTH-END                  VALUE '1'.
  2613
  2614         16  CF-LGX-CLAIM-USER              PIC X.
  2615             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2616             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2617
  2618         16  CF-CREDIT-EDIT-CONTROLS.
  2619             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2620             20  CF-MIN-AGE                 PIC 99.
  2621             20  CF-DEFAULT-AGE             PIC 99.
  2622             20  CF-MIN-TERM                PIC S999      COMP-3.
  2623             20  CF-MAX-TERM                PIC S999      COMP-3.
  2624             20  CF-DEFAULT-SEX             PIC X.
  2625             20  CF-JOINT-AGE-INPUT         PIC X.
  2626                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2627             20  CF-BIRTH-DATE-INPUT        PIC X.
  2628                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2629             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2630                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2631                 88  CF-ZERO-CARRIER            VALUE '1'.
  2632                 88  CF-ZERO-GROUPING           VALUE '2'.
  2633                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2634             20  CF-EDIT-SW                 PIC X.
  2635                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2636             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2637             20  CF-CR-PR-METHOD            PIC X.
  2638               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2639               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2640             20  FILLER                     PIC X.
  2641
  2642         16  CF-CREDIT-MISC-CONTROLS.
  2643             20  CF-REIN-TABLE-SW           PIC X.
  2644                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2645             20  CF-COMP-TABLE-SW           PIC X.
  2646                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2647             20  CF-EXPERIENCE-RETENTION-AGE
  2648                                            PIC S9        COMP-3.
  2649             20  CF-CONVERSION-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  48
* EL6316.cbl
  2650             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2651             20  CF-RUN-FREQUENCY-SW        PIC X.
  2652                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2653                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2654
  2655             20  CF-CR-CHECK-NO-CONTROL.
  2656                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2657                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2658                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2659                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2660                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2661                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2662
  2663                 24  CF-CR-CHECK-COUNT       REDEFINES
  2664                     CF-CR-CHECK-COUNTER      PIC X(4).
  2665
  2666                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2667                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2668
  2669                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2670                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2671                 24  CF-MAIL-PROCESSING       PIC X.
  2672                     88  MAIL-PROCESSING          VALUE 'Y'.
  2673
  2674         16  CF-MISC-SYSTEM-CONTROL.
  2675             20  CF-SYSTEM-C                 PIC X.
  2676                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2677             20  CF-SYSTEM-D                 PIC X.
  2678                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2679             20  CF-SOC-SEC-NO-SW            PIC X.
  2680                 88  SOC-SEC-NO-USED             VALUE '1'.
  2681             20  CF-MEMBER-NO-SW             PIC X.
  2682                 88  MEMBER-NO-USED              VALUE '1'.
  2683             20  CF-TAX-ID-NUMBER            PIC X(11).
  2684             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2685             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2686                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2687                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2688                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2689                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2690             20  CF-SYSTEM-E                 PIC X.
  2691                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2692
  2693         16  CF-LGX-LIFE-USER               PIC X.
  2694             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2695             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2696
  2697         16  CF-CR-MONTH-END-DT             PIC XX.
  2698
  2699         16  CF-FILE-MAINT-DATES.
  2700             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2701                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2702             20  CF-LAST-BATCH       REDEFINES
  2703                 CF-LAST-BATCH-NO               PIC X(4).
  2704             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2705             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2706             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2707             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  49
* EL6316.cbl
  2708             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2709             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2710             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2711             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2712             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2713             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2714
  2715         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2716         16  FILLER                         PIC X.
  2717
  2718         16  CF-ALT-MORT-CODE               PIC X(4).
  2719         16  CF-MEMBER-CAPTION              PIC X(10).
  2720
  2721         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2722             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2723             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2724             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2725             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2726             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2727
  2728         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2729
  2730         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2731         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2732         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2733         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2734
  2735         16  CF-AH-OVERRIDE-L1              PIC X.
  2736         16  CF-AH-OVERRIDE-L2              PIC XX.
  2737         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2738         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2739
  2740         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2741         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2742
  2743         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2744         16  CF-AR-LAST-EL860-DT            PIC XX.
  2745         16  CF-MP-MONTH-END-DT             PIC XX.
  2746
  2747         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2748         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2749             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2750
  2751         16  CF-AR-MONTH-END-DT             PIC XX.
  2752
  2753         16  CF-CRDTCRD-USER                PIC X.
  2754             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2755             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2756
  2757         16  CF-CC-MONTH-END-DT             PIC XX.
  2758
  2759         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2760
  2761         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2762             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2763             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2764             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2765         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  50
* EL6316.cbl
  2766         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2767         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2768         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2769             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2770             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2771         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2772         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2773         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2774             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2775         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2776
  2777         16  CF-CL-ZIP-CODE.
  2778             20  CF-CL-ZIP-PRIME.
  2779                 24  CF-CL-ZIP-1ST          PIC X.
  2780                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2781                 24  FILLER                 PIC X(4).
  2782             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2783         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2784             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2785             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2786             20  FILLER                     PIC XXX.
  2787
  2788         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2789         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2790         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2791         16  CF-CO-OPTION-START-DATE        PIC XX.
  2792         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2793           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2794                                                      '3' '4'.
  2795           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2796           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2797           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2798           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2799           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2800           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2801
  2802         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2803
  2804         16  CF-PAYMENT-APPROVAL-LEVELS.
  2805             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2806             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2807             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2808             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2809             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2810             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2811
  2812         16  CF-END-USER-REPORTING-USER     PIC X.
  2813             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2814             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2815
  2816         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2817             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2818             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2819
  2820         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2821
  2822         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2823         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  51
* EL6316.cbl
  2824
  2825         16  CF-CREDIT-ARCHIVE-CNTL.
  2826             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2827             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2828             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2829
  2830         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2831
  2832         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2833             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2834             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2835
  2836         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2837             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2838             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2839
  2840         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2841
  2842         16  CF-CO-ACH-ID-CODE              PIC  X.
  2843             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2844             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2845             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2846         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2847         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2848         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2849         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2850         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2851         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2852         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2853         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2854         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2855                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2856         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2857                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2858
  2859         16  CF-CO-OVER-SHORT.
  2860             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2861             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2862
  2863*         16  FILLER                         PIC X(102).
  2864         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2865             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2866             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2867
  2868         16  CF-AH-APPROVAL-DAYS.
  2869             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2870             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2871             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2872             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2873
  2874         16  FILLER                         PIC X(82).
  2875****************************************************************
  2876*             PROCESSOR/USER RECORD                            *
  2877****************************************************************
  2878
  2879     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2880         16  CF-PROCESSOR-NAME              PIC X(30).
  2881         16  CF-PROCESSOR-PASSWORD          PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  52
* EL6316.cbl
  2882         16  CF-PROCESSOR-TITLE             PIC X(26).
  2883         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2884                 88  MESSAGE-YES                VALUE 'Y'.
  2885                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2886
  2887*****************************************************
  2888****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2889****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2890****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2891****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2892*****************************************************
  2893
  2894         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2895             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2896             20  CF-APPLICATION-FORCE       PIC X.
  2897             20  CF-INDIVIDUAL-APP.
  2898                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2899                     28  CF-BROWSE-APP      PIC X.
  2900                     28  CF-UPDATE-APP      PIC X.
  2901
  2902         16  CF-CURRENT-TERM-ON             PIC X(4).
  2903         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2904             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2905             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2906             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2907             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2908             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2909             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2910             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2911         16  CF-PROCESSOR-CARRIER           PIC X.
  2912             88  NO-CARRIER-SECURITY            VALUE ' '.
  2913         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2914             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2915         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2916             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2917         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2918             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2919
  2920         16  CF-PROC-SYS-ACCESS-SW.
  2921             20  CF-PROC-CREDIT-CLAIMS-SW.
  2922                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2923                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2924                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2925                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2926             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2927                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2928                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2929             20  CF-PROC-LIFE-GNRLDGR-SW.
  2930                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2931                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2932                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2933                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2934             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2935                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2936                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2937         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2938             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2939             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  53
* EL6316.cbl
  2940         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2941
  2942         16  CF-APPROVAL-LEVEL                  PIC X.
  2943             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2944             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2945             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2946             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2947
  2948         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2949
  2950         16  CF-LANGUAGE-TYPE                   PIC X.
  2951             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2952             88  CF-LANG-IS-FR                      VALUE 'F'.
  2953
  2954         16  CF-CSR-IND                         PIC X.
  2955         16  FILLER                             PIC X(239).
  2956
  2957****************************************************************
  2958*             PROCESSOR/REMINDERS RECORD                       *
  2959****************************************************************
  2960
  2961     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2962         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2963             20  CF-START-REMIND-DT         PIC XX.
  2964             20  CF-END-REMIND-DT           PIC XX.
  2965             20  CF-REMINDER-TEXT           PIC X(50).
  2966         16  FILLER                         PIC X(296).
  2967
  2968
  2969****************************************************************
  2970*             STATE MASTER RECORD                              *
  2971****************************************************************
  2972
  2973     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2974         16  CF-STATE-ABBREVIATION          PIC XX.
  2975         16  CF-STATE-NAME                  PIC X(25).
  2976         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2977         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2978             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2979             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2980             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2981             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2982                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2983                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2984             20  CF-ST-PREM-REJECT-SW       PIC X.
  2985                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2986                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2987             20  CF-ST-REF-REJECT-SW        PIC X.
  2988                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2989                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2990         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2991         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2992         16  CF-ST-REFUND-RULES.
  2993             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2994             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2995             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2996         16  CF-ST-FST-PMT-EXTENSION.
  2997             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  54
* EL6316.cbl
  2998             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2999                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3000                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3001                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3002                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3003         16  CF-ST-STATE-CALL.
  3004             20  CF-ST-CALL-UNEARNED        PIC X.
  3005             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3006             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3007         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3008             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3009             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3010         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3011         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3012         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3013         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3014         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3015         16  FILLER                         PIC X.
  3016         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3017             20  CF-ST-BENEFIT-CD           PIC XX.
  3018             20  CF-ST-BENEFIT-KIND         PIC X.
  3019                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3020                 88  CF-ST-AH-KIND              VALUE 'A'.
  3021             20  CF-ST-REM-TERM-CALC        PIC X.
  3022                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3023                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3024                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3025                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3026                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3027                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3028                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3029                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3030
  3031             20  CF-ST-REFUND-CALC          PIC X.
  3032                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3033                 88  ST-REFD-BY-R78             VALUE '1'.
  3034                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3035                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3036                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3037                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3038                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3039                 88  ST-REFD-UTAH               VALUE '7'.
  3040                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3041                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3042                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3043
  3044             20  CF-ST-EARNING-CALC         PIC X.
  3045                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3046                 88  ST-EARN-BY-R78             VALUE '1'.
  3047                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3048                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3049                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3050                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3051                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3052                 88  ST-EARN-MEAN               VALUE '8'.
  3053                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3054
  3055             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  55
* EL6316.cbl
  3056                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3057                 88  ST-OVRD-BY-R78             VALUE '1'.
  3058                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3059                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3060                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3061                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3062                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3063                 88  ST-OVRD-MEAN               VALUE '8'.
  3064                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3065             20  FILLER                     PIC X.
  3066
  3067         16  CF-ST-COMMISSION-CAPS.
  3068             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3069             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3070             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3071             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3072         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3073                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3074
  3075         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3076
  3077         16  CF-ST-STATUTORY-INTEREST.
  3078             20  CF-ST-STAT-DATE-FROM       PIC X.
  3079                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3080                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3081             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3082             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3083             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3084             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3085             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3086
  3087         16  CF-ST-OVER-SHORT.
  3088             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3089             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3090
  3091         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3092
  3093         16  CF-ST-RT-CALC                  PIC X.
  3094
  3095         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3096         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3097         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3098         16  CF-ST-RF-LR-CALC               PIC X.
  3099         16  CF-ST-RF-LL-CALC               PIC X.
  3100         16  CF-ST-RF-LN-CALC               PIC X.
  3101         16  CF-ST-RF-AH-CALC               PIC X.
  3102         16  CF-ST-RF-CP-CALC               PIC X.
  3103*        16  FILLER                         PIC X(206).
  3104*CIDMOD         16  FILLER                         PIC X(192).
  3105         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3106             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3107         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3108         16  CF-ST-VFY-2ND-BENE             PIC X.
  3109         16  FILLER                         PIC X(186).
  3110
  3111****************************************************************
  3112*             BENEFIT MASTER RECORD                            *
  3113****************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  56
* EL6316.cbl
  3114
  3115     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3116         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3117             20  CF-BENEFIT-CODE            PIC XX.
  3118             20  CF-BENEFIT-NUMERIC  REDEFINES
  3119                 CF-BENEFIT-CODE            PIC XX.
  3120             20  CF-BENEFIT-ALPHA           PIC XXX.
  3121             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3122             20  CF-BENEFIT-COMMENT         PIC X(10).
  3123
  3124             20  CF-LF-COVERAGE-TYPE        PIC X.
  3125                 88  CF-REDUCING                VALUE 'R'.
  3126                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3127
  3128             20  CF-SPECIAL-CALC-CD         PIC X.
  3129                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3130                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3131                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3132                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3133                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3134                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3135                 88  CF-FARM-PLAN               VALUE 'F'.
  3136                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3137                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3138                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3139                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3140                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3141                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3142                 88  CF-PRUDENTIAL              VALUE 'P'.
  3143                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3144                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3145                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3146                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3147                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3148                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3149
  3150             20  CF-JOINT-INDICATOR         PIC X.
  3151                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3152
  3153*            20  FILLER                     PIC X(12).
  3154             20  FILLER                     PIC X(11).
  3155             20  CF-BENEFIT-CATEGORY        PIC X.
  3156             20  CF-LOAN-TYPE               PIC X(8).
  3157
  3158             20  CF-CO-REM-TERM-CALC        PIC X.
  3159                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3160                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3161                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3162                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3163                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3164
  3165             20  CF-CO-EARNINGS-CALC        PIC X.
  3166                 88  CO-EARN-BY-R78             VALUE '1'.
  3167                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3168                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3169                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3170                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3171                 88  CO-EARN-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  57
* EL6316.cbl
  3172                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3173                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3174
  3175             20  CF-CO-REFUND-CALC          PIC X.
  3176                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3177                 88  CO-REFD-BY-R78             VALUE '1'.
  3178                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3179                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3180                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3181                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3182                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3183                 88  CO-REFD-MEAN               VALUE '8'.
  3184                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3185                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3186                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3187
  3188             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3189                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3190                 88  CO-OVRD-BY-R78             VALUE '1'.
  3191                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3192                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3193                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3194                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3195                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3196                 88  CO-OVRD-MEAN               VALUE '8'.
  3197                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3198
  3199             20  CF-CO-BEN-I-G-CD           PIC X.
  3200                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3201                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3202                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3203
  3204         16  FILLER                         PIC X(304).
  3205
  3206
  3207****************************************************************
  3208*             CARRIER MASTER RECORD                            *
  3209****************************************************************
  3210
  3211     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3212         16  CF-ADDRESS-DATA.
  3213             20  CF-MAIL-TO-NAME            PIC X(30).
  3214             20  CF-IN-CARE-OF              PIC X(30).
  3215             20  CF-ADDRESS-LINE-1          PIC X(30).
  3216             20  CF-ADDRESS-LINE-2          PIC X(30).
  3217             20  CF-CITY-STATE              PIC X(30).
  3218             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3219             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3220
  3221         16  CF-CLAIM-NO-CONTROL.
  3222             20  CF-CLAIM-NO-METHOD         PIC X.
  3223                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3224                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3225                 88  CLAIM-NO-SEQ               VALUE '3'.
  3226                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3227             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3228                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3229                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  58
* EL6316.cbl
  3230                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3231
  3232         16  CF-CHECK-NO-CONTROL.
  3233             20  CF-CHECK-NO-METHOD         PIC X.
  3234                 88  CHECK-NO-MANUAL            VALUE '1'.
  3235                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3236                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3237                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3238             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3239                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3240
  3241         16  CF-DOMICILE-STATE              PIC XX.
  3242
  3243         16  CF-EXPENSE-CONTROLS.
  3244             20  CF-EXPENSE-METHOD          PIC X.
  3245                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3246                 88  DOLLARS-PER-PMT            VALUE '2'.
  3247                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3248                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3249             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3250             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3251
  3252         16  CF-CORRESPONDENCE-CONTROL.
  3253             20  CF-LETTER-RESEND-OPT       PIC X.
  3254                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3255                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3256             20  FILLER                     PIC X(4).
  3257
  3258         16  CF-RESERVE-CONTROLS.
  3259             20  CF-MANUAL-SW               PIC X.
  3260                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3261             20  CF-FUTURE-SW               PIC X.
  3262                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3263             20  CF-PTC-SW                  PIC X.
  3264                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3265             20  CF-IBNR-SW                 PIC X.
  3266                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3267             20  CF-PTC-LF-SW               PIC X.
  3268                 88  CF-LF-PTC-USED             VALUE '1'.
  3269             20  CF-CDT-ACCESS-METHOD       PIC X.
  3270                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3271                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3272                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3273             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3274
  3275         16  CF-CLAIM-CALC-METHOD           PIC X.
  3276             88  360-PLUS-MONTHS                VALUE '1'.
  3277             88  365-PLUS-MONTHS                VALUE '2'.
  3278             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3279             88  360-DAILY                      VALUE '4'.
  3280             88  365-DAILY                      VALUE '5'.
  3281
  3282         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3283         16  FILLER                         PIC X(11).
  3284
  3285         16  CF-LIMIT-AMOUNTS.
  3286             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3287             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  59
* EL6316.cbl
  3288             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3289             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3290             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3291             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3292             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3293             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3294             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3295             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3296
  3297         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3298         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3299         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3300
  3301         16  CF-ZIP-CODE.
  3302             20  CF-ZIP-PRIME.
  3303                 24  CF-ZIP-1ST             PIC X.
  3304                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3305                 24  FILLER                 PIC X(4).
  3306             20  CF-ZIP-PLUS4               PIC X(4).
  3307         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3308             20  CF-CAN-POSTAL-1            PIC XXX.
  3309             20  CF-CAN-POSTAL-2            PIC XXX.
  3310             20  FILLER                     PIC XXX.
  3311
  3312         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3313         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3314         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3315
  3316         16  CF-RATING-SWITCH               PIC X.
  3317             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3318             88  CF-NO-RATING                   VALUE 'N'.
  3319
  3320         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3321
  3322         16  CF-CARRIER-OVER-SHORT.
  3323             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3324             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3325
  3326         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3327         16  CF-SECPAY-SWITCH               PIC X.
  3328             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3329             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3330         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3331         16  FILLER                         PIC X(448).
  3332*        16  FILLER                         PIC X(452).
  3333
  3334
  3335****************************************************************
  3336*             MORTALITY MASTER RECORD                          *
  3337****************************************************************
  3338
  3339     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3340         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3341                                INDEXED BY CF-MORT-NDX.
  3342             20  CF-MORT-TABLE              PIC X(5).
  3343             20  CF-MORT-TABLE-TYPE         PIC X.
  3344                 88  CF-MORT-JOINT              VALUE 'J'.
  3345                 88  CF-MORT-SINGLE             VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  60
* EL6316.cbl
  3346                 88  CF-MORT-COMBINED           VALUE 'C'.
  3347                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3348                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3349             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3350             20  CF-MORT-AGE-METHOD         PIC XX.
  3351                 88  CF-AGE-LAST                VALUE 'AL'.
  3352                 88  CF-AGE-NEAR                VALUE 'AN'.
  3353             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3354             20  CF-MORT-ADJUSTMENT-DIRECTION
  3355                                            PIC X.
  3356                 88  CF-MINUS                   VALUE '-'.
  3357                 88  CF-PLUS                    VALUE '+'.
  3358             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3359             20  CF-MORT-JOINT-CODE         PIC X.
  3360                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3361             20  CF-MORT-PC-Q               PIC X.
  3362                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3363             20  CF-MORT-TABLE-CODE         PIC X(4).
  3364             20  CF-MORT-COMMENTS           PIC X(15).
  3365             20  FILLER                     PIC X(14).
  3366
  3367         16  FILLER                         PIC X(251).
  3368
  3369
  3370****************************************************************
  3371*             BUSSINESS TYPE MASTER RECORD                     *
  3372****************************************************************
  3373
  3374     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3375* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3376* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3377* AND RECORD 05 IS TYPES 81-99
  3378         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3379             20  CF-BUSINESS-TITLE          PIC  X(19).
  3380             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3381                                            PIC S9V9(4) COMP-3.
  3382             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3383             20  FILLER                     PIC  X.
  3384         16  FILLER                         PIC  X(248).
  3385
  3386
  3387****************************************************************
  3388*             TERMINAL MASTER RECORD                           *
  3389****************************************************************
  3390
  3391     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3392
  3393         16  CF-COMPANY-TERMINALS.
  3394             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3395                                  PIC X(4).
  3396         16  FILLER               PIC X(248).
  3397
  3398
  3399****************************************************************
  3400*             LIFE EDIT MASTER RECORD                          *
  3401****************************************************************
  3402
  3403     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  61
* EL6316.cbl
  3404         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3405             20  CF-LIFE-CODE-IN            PIC XX.
  3406             20  CF-LIFE-CODE-OUT           PIC XX.
  3407         16  FILLER                         PIC X(248).
  3408
  3409
  3410****************************************************************
  3411*             AH EDIT MASTER RECORD                            *
  3412****************************************************************
  3413
  3414     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3415         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3416             20  CF-AH-CODE-IN              PIC XXX.
  3417             20  CF-AH-CODE-OUT             PIC XX.
  3418         16  FILLER                         PIC X(248).
  3419
  3420
  3421****************************************************************
  3422*             CREDIBILITY TABLES                               *
  3423****************************************************************
  3424
  3425     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3426         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3427                             INDEXED BY CF-CRDB-NDX.
  3428             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3429             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3430             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3431         16  FILLER                         PIC  X(332).
  3432
  3433
  3434****************************************************************
  3435*             REPORT CUSTOMIZATION RECORD                      *
  3436****************************************************************
  3437
  3438     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3439         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3440             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3441             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3442             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3443**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3444****       A T-TRANSFER.                                   ****
  3445             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3446
  3447         16  FILLER                         PIC XX.
  3448
  3449         16  CF-CARRIER-CNTL-OPT.
  3450             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3451                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3452                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3453             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3454                                            PIC X.
  3455         16  CF-GROUP-CNTL-OPT.
  3456             20  CF-GROUP-OPT-SEQ           PIC 9.
  3457                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3458                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3459             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3460                                            PIC X(6).
  3461         16  CF-STATE-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  62
* EL6316.cbl
  3462             20  CF-STATE-OPT-SEQ           PIC 9.
  3463                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3464                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3465             20  CF-STATE-SELECT OCCURS 3 TIMES
  3466                                            PIC XX.
  3467         16  CF-ACCOUNT-CNTL-OPT.
  3468             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3469                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3470                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3471             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3472                                            PIC X(10).
  3473         16  CF-BUS-TYP-CNTL-OPT.
  3474             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3475                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3476                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3477             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3478                                            PIC XX.
  3479         16  CF-LF-TYP-CNTL-OPT.
  3480             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3481                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3482                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3483             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3484                                            PIC XX.
  3485         16  CF-AH-TYP-CNTL-OPT.
  3486             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3487                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3488                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3489             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3490                                            PIC XX.
  3491         16  CF-REPTCD1-CNTL-OPT.
  3492             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3493                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3494                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3495             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3496                                            PIC X(10).
  3497         16  CF-REPTCD2-CNTL-OPT.
  3498             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3499                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3500                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3501             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3502                                            PIC X(10).
  3503         16  CF-USER1-CNTL-OPT.
  3504             20  CF-USER1-OPT-SEQ           PIC 9.
  3505                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3506                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3507             20  CF-USER1-SELECT OCCURS 3 TIMES
  3508                                            PIC X(10).
  3509         16  CF-USER2-CNTL-OPT.
  3510             20  CF-USER2-OPT-SEQ           PIC 9.
  3511                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3512                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3513             20  CF-USER2-SELECT OCCURS 3 TIMES
  3514                                            PIC X(10).
  3515         16  CF-USER3-CNTL-OPT.
  3516             20  CF-USER3-OPT-SEQ           PIC 9.
  3517                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3518                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3519             20  CF-USER3-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  63
* EL6316.cbl
  3520                                            PIC X(10).
  3521         16  CF-USER4-CNTL-OPT.
  3522             20  CF-USER4-OPT-SEQ           PIC 9.
  3523                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3524                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3525             20  CF-USER4-SELECT OCCURS 3 TIMES
  3526                                            PIC X(10).
  3527         16  CF-USER5-CNTL-OPT.
  3528             20  CF-USER5-OPT-SEQ           PIC 9.
  3529                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3530                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3531             20  CF-USER5-SELECT OCCURS 3 TIMES
  3532                                            PIC X(10).
  3533         16  CF-REINS-CNTL-OPT.
  3534             20  CF-REINS-OPT-SEQ           PIC 9.
  3535                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3536                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3537             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3538                 24  CF-REINS-PRIME         PIC XXX.
  3539                 24  CF-REINS-SUB           PIC XXX.
  3540
  3541         16  CF-AGENT-CNTL-OPT.
  3542             20  CF-AGENT-OPT-SEQ           PIC 9.
  3543                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3544                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3545             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3546                                            PIC X(10).
  3547
  3548         16  FILLER                         PIC X(43).
  3549
  3550         16  CF-LOSS-RATIO-SELECT.
  3551             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3552             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3553         16  CF-ENTRY-DATE-SELECT.
  3554             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3555             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3556         16  CF-EFFECTIVE-DATE-SELECT.
  3557             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3558             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3559
  3560         16  CF-EXCEPTION-LIST-IND          PIC X.
  3561             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3562
  3563         16  FILLER                         PIC X(318).
  3564
  3565****************************************************************
  3566*                  EXCEPTION REPORTING RECORD                  *
  3567****************************************************************
  3568
  3569     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3570         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3571             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3572
  3573         16  CF-COMBINED-LIFE-AH-OPT.
  3574             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3575             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3576             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3577             20  CF-CANCELLATION-RATIO      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  64
* EL6316.cbl
  3578
  3579         16  CF-LIFE-OPT.
  3580             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3581             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3582             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3583             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3584             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3585             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3586             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3587             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3588             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3589             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3590
  3591         16  CF-AH-OPT.
  3592             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3593             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3594             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3595             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3596             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3597             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3598             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3599             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3600             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3601             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3602
  3603         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3604             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3605             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3606             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3607
  3608         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3609
  3610         16  FILLER                         PIC X(673).
  3611
  3612
  3613****************************************************************
  3614*             MORTGAGE SYSTEM PLAN RECORD                      *
  3615****************************************************************
  3616
  3617     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3618         16  CF-PLAN-TYPE                   PIC X.
  3619             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3620             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3621             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3622         16  CF-PLAN-ABBREV                 PIC XXX.
  3623         16  CF-PLAN-DESCRIPT               PIC X(10).
  3624         16  CF-PLAN-NOTES                  PIC X(20).
  3625         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3626         16  CF-PLAN-UNDERWRITING.
  3627             20  CF-PLAN-TERM-DATA.
  3628                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3629                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3630             20  CF-PLAN-AGE-DATA.
  3631                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3632                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3633                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3634             20  CF-PLAN-BENEFIT-DATA.
  3635                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  65
* EL6316.cbl
  3636                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3637                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3638                                            PIC S9(7)V99  COMP-3.
  3639         16  CF-PLAN-POLICY-FORMS.
  3640             20  CF-POLICY-FORM             PIC X(12).
  3641             20  CF-MASTER-APPLICATION      PIC X(12).
  3642             20  CF-MASTER-POLICY           PIC X(12).
  3643         16  CF-PLAN-RATING.
  3644             20  CF-RATE-CODE               PIC X(5).
  3645             20  CF-SEX-RATING              PIC X.
  3646                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3647                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3648             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3649             20  CF-SUB-STD-TYPE            PIC X.
  3650                 88  CF-PCT-OF-PREM            VALUE '1'.
  3651                 88  CF-PCT-OF-BENE            VALUE '2'.
  3652         16  CF-PLAN-PREM-TOLERANCES.
  3653             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3654             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3655         16  CF-PLAN-PYMT-TOLERANCES.
  3656             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3657             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3658         16  CF-PLAN-MISC-DATA.
  3659             20  FILLER                     PIC X.
  3660             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3661             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3662         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3663         16  CF-PLAN-IND-GRP                PIC X.
  3664             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3665                                                     '1'.
  3666             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3667                                                     '2'.
  3668         16  CF-MIB-SEARCH-SW               PIC X.
  3669             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3670             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3671             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3672             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3673         16  CF-ALPHA-SEARCH-SW             PIC X.
  3674             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3675             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3676             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3677             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3678             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3679             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3680             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3681             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3682             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3683             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3684                                                     'A' 'B' 'C'
  3685                                                     'X' 'Y' 'Z'.
  3686         16  CF-EFF-DT-RULE-SW              PIC X.
  3687             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3688             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3689             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3690             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3691             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3692         16  FILLER                         PIC X(4).
  3693         16  CF-HEALTH-QUESTIONS            PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  66
* EL6316.cbl
  3694             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3695         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3696         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3697         16  CF-PLAN-SNGL-JNT               PIC X.
  3698             88  CF-COMBINED-PLAN              VALUE 'C'.
  3699             88  CF-JNT-PLAN                   VALUE 'J'.
  3700             88  CF-SNGL-PLAN                  VALUE 'S'.
  3701         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3702         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3703         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3704         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3705         16  CF-RERATE-CNTL                 PIC  X.
  3706             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3707             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3708             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3709             88  CF-AUTO-RECALC                 VALUE '4'.
  3710         16  CF-BENEFIT-TYPE                PIC  X.
  3711             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3712             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3713         16  CF-POLICY-FEE                  PIC S999V99
  3714                                                    COMP-3.
  3715         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3716         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3717         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3718         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3719         16  FILLER                         PIC  X(32).
  3720         16  CF-TERMINATION-FORM            PIC  X(04).
  3721         16  FILLER                         PIC  X(08).
  3722         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3723                                                       COMP-3.
  3724         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3725         16  CF-ISSUE-LETTER                PIC  X(4).
  3726         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3727         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3728             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3729             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3730         16  CF-MP-REFUND-CALC              PIC X.
  3731             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3732             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3733             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3734             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3735             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3736             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3737             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3738             88  CF-MP-REFD-MEAN                VALUE '8'.
  3739         16  CF-ALT-RATE-CODE               PIC  X(5).
  3740
  3741
  3742         16  FILLER                         PIC X(498).
  3743****************************************************************
  3744*             MORTGAGE COMPANY MASTER RECORD                   *
  3745****************************************************************
  3746
  3747     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3748         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3749         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3750             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3751             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  67
* EL6316.cbl
  3752             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3753             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3754             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3755
  3756         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3757         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3758         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3759         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3760         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3761
  3762         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3763             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3764         16  CF-MP-RECON-USE-IND            PIC X(1).
  3765             88  CF-MP-USE-RECON             VALUE 'Y'.
  3766         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3767             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3768         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3769             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3770             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3771         16  FILLER                         PIC X(1).
  3772         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3773             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3774         16  CF-MORTG-MIB-VERSION           PIC X.
  3775             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3776             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3777             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3778         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3779             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3780                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3781             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3782                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3783             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3784                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3785             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3786                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3787             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3788                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3789             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3790                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3791         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3792         16  FILLER                         PIC X(7).
  3793         16  CF-MORTG-DESTINATION-SYMBOL.
  3794             20  CF-MORTG-MIB-COMM          PIC X(5).
  3795             20  CF-MORTG-MIB-TERM          PIC X(5).
  3796         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3797             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3798         16  FILLER                         PIC X(03).
  3799         16  CF-MP-CHECK-NO-CONTROL.
  3800             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3801                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3802                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3803                                                ' ' LOW-VALUES.
  3804                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3805                                               VALUE '3'.
  3806         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3807         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3808         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3809             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  68
* EL6316.cbl
  3810                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3811             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3812                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3813             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3814                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3815             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3816                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3817             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3818                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3819             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3820                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3821         16  CF-MORTG-BILLING-AREA.
  3822             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3823                                            PIC X.
  3824         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3825         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3826         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3827         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3828             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3829             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3830         16  FILLER                         PIC X.
  3831         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3832             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3833             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3834         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3835         16  FILLER                         PIC X(8).
  3836         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3837         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3838         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3839         16  CF-ACH-COMPANY-ID.
  3840             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3841                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3842                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3843                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3844             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3845         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3846             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3847         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3848             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3849             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3850         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3851         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3852         16  FILLER                         PIC X(536).
  3853
  3854****************************************************************
  3855*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3856****************************************************************
  3857
  3858     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3859         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3860             20  CF-FEMALE-HEIGHT.
  3861                 24  CF-FEMALE-FT           PIC 99.
  3862                 24  CF-FEMALE-IN           PIC 99.
  3863             20  CF-FEMALE-MIN-WT           PIC 999.
  3864             20  CF-FEMALE-MAX-WT           PIC 999.
  3865         16  FILLER                         PIC X(428).
  3866
  3867     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  69
* EL6316.cbl
  3868         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3869             20  CF-MALE-HEIGHT.
  3870                 24  CF-MALE-FT             PIC 99.
  3871                 24  CF-MALE-IN             PIC 99.
  3872             20  CF-MALE-MIN-WT             PIC 999.
  3873             20  CF-MALE-MAX-WT             PIC 999.
  3874         16  FILLER                         PIC X(428).
  3875******************************************************************
  3876*             AUTOMATIC ACTIVITY RECORD                          *
  3877******************************************************************
  3878     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3879         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3880             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3881             20  CF-SYS-LETTER-ID           PIC X(04).
  3882             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3883             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3884             20  CF-SYS-RESET-SW            PIC X(01).
  3885             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3886             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3887
  3888         16  FILLER                         PIC X(50).
  3889
  3890         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3891             20  CF-USER-ACTIVE-SW          PIC X(01).
  3892             20  CF-USER-LETTER-ID          PIC X(04).
  3893             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3894             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3895             20  CF-USER-RESET-SW           PIC X(01).
  3896             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3897             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3898             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3899
  3900         16  FILLER                         PIC X(246).
  3901*                                COPY ERCPNDB.
  3902******************************************************************
  3903*                                                                *
  3904*                                                                *
  3905*                            ERCPNDB.                            *
  3906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3907*                            VMOD=2.025                          *
  3908*                                                                *
  3909*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3910*                                                                *
  3911******************************************************************
  3912*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3913*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3914******************************************************************
  3915*                                                                *
  3916*                                                                *
  3917*   FILE TYPE = VSAM,KSDS                                        *
  3918*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3919*                                                                *
  3920*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3921*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3922*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3923*                                                 RKP=13,LEN=36  *
  3924*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3925*                                      AND CHG-SEQ.)             *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  70
* EL6316.cbl
  3926*                                                RKP=49,LEN=11   *
  3927*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3928*                                      AND CHG-SEQ.)             *
  3929*                                                RKP=60,LEN=15   *
  3930*                                                                *
  3931*   LOG = NO                                                     *
  3932*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3933******************************************************************
  3934******************************************************************
  3935*                   C H A N G E   L O G
  3936*
  3937* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3938*-----------------------------------------------------------------
  3939*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3940* EFFECTIVE    NUMBER
  3941*-----------------------------------------------------------------
  3942* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3943* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3944* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3945* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3946* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3947* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3948* 032306                   PEMA  ADD BOW LOAN NUMBER
  3949* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3950* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3951* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3952* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3953* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3954* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3955* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3956* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3957******************************************************************
  3958
  3959 01  PENDING-BUSINESS.
  3960     12  PB-RECORD-ID                     PIC XX.
  3961         88  VALID-PB-ID                        VALUE 'PB'.
  3962
  3963     12  PB-CONTROL-PRIMARY.
  3964         16  PB-COMPANY-CD                PIC X.
  3965         16  PB-ENTRY-BATCH               PIC X(6).
  3966         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3967         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3968
  3969     12  PB-CONTROL-BY-ACCOUNT.
  3970         16  PB-COMPANY-CD-A1             PIC X.
  3971         16  PB-CARRIER                   PIC X.
  3972         16  PB-GROUPING.
  3973             20  PB-GROUPING-PREFIX       PIC XXX.
  3974             20  PB-GROUPING-PRIME        PIC XXX.
  3975         16  PB-STATE                     PIC XX.
  3976         16  PB-ACCOUNT.
  3977             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3978             20  PB-ACCOUNT-PRIME         PIC X(6).
  3979         16  PB-CERT-EFF-DT               PIC XX.
  3980         16  PB-CERT-NO.
  3981             20  PB-CERT-PRIME            PIC X(10).
  3982             20  PB-CERT-SFX              PIC X.
  3983         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  71
* EL6316.cbl
  3984
  3985         16  PB-RECORD-TYPE               PIC X.
  3986             88  PB-MAILING-DATA                VALUE '0'.
  3987             88  PB-ISSUE                       VALUE '1'.
  3988             88  PB-CANCELLATION                VALUE '2'.
  3989             88  PB-BATCH-TRAILER               VALUE '9'.
  3990
  3991     12  PB-CONTROL-BY-ORIG-BATCH.
  3992         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3993         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3994         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3995         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3996
  3997     12  PB-CONTROL-BY-CSR.
  3998         16  PB-CSR-COMPANY-CD            PIC X.
  3999         16  PB-CSR-ID                    PIC X(4).
  4000         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4001         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4002         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4003******************************************************************
  4004*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4005******************************************************************
  4006
  4007     12  PB-LAST-MAINT-DT                 PIC XX.
  4008     12  PB-LAST-MAINT-BY                 PIC X(4).
  4009     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4010
  4011     12  PB-RECORD-BODY                   PIC X(375).
  4012
  4013     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4014         16  PB-CERT-ORIGIN               PIC X.
  4015             88  CLASIC-CREATED-CERT         VALUE '1'.
  4016         16  PB-I-NAME.
  4017             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4018             20  PB-I-INSURED-FIRST-NAME.
  4019                 24  PB-I-INSURED-1ST-INIT PIC X.
  4020                 24  FILLER                PIC X(9).
  4021             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4022         16  PB-I-AGE                     PIC S99   COMP-3.
  4023         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4024         16  PB-I-BIRTHDAY                PIC XX.
  4025         16  PB-I-INSURED-SEX             PIC X.
  4026             88  PB-SEX-MALE     VALUE 'M'.
  4027             88  PB-SEX-FEMALE   VALUE 'F'.
  4028
  4029         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4030         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4031         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4032         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4033         16  PB-I-SKIP-CODE               PIC X.
  4034             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4035             88  PB-SKIP-JULY              VALUE '1'.
  4036             88  PB-SKIP-AUGUST            VALUE '2'.
  4037             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4038             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4039             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4040             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4041             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  72
* EL6316.cbl
  4042             88  PB-SKIP-JUNE              VALUE '8'.
  4043             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4044             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4045             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4046         16  PB-I-TERM-TYPE               PIC X.
  4047             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4048             88  PB-PAID-WEEKLY            VALUE 'W'.
  4049             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4050             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4051             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4052         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4053         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4054         16  PB-I-DATA-ENTRY-SW           PIC X.
  4055             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4056             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4057             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4058             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4059         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4060         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4061*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4062         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4063         16  FILLER                       PIC X.
  4064
  4065         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4066             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4067             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4068                                                   '90' THRU '99'.
  4069         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4070                                          PIC XX.
  4071         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4072         16  PB-I-AMOUNT-FINANCED REDEFINES
  4073                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4074         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4075         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4076                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4077         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4078         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4079         16  PB-I-CLP-AMOUNT REDEFINES
  4080                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4081         16  PB-I-LF-CALC-FLAG            PIC X.
  4082             88 PB-COMP-LF-PREM               VALUE '?'.
  4083         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4084         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4085         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4086         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4087         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4088         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4089         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4090         16  PB-I-LF-ABBR                 PIC XXX.
  4091         16  PB-I-LF-INPUT-CD             PIC XX.
  4092
  4093         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4094             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4095             88  PB-INVALID-AH               VALUE '  ' '00'
  4096                                                   '90' THRU '99'.
  4097         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4098         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4099         16  PB-I-AH-CALC-FLAG            PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  73
* EL6316.cbl
  4100             88 PB-COMP-AH-PREM                  VALUE '?'.
  4101         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4102         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4103         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4104         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4105         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4106         16  PB-I-AH-ABBR                 PIC XXX.
  4107         16  PB-I-AH-INPUT-CD             PIC XXX.
  4108
  4109         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4110         16  PB-I-REIN-TABLE              PIC XXX.
  4111         16  PB-I-BUSINESS-TYPE           PIC 99.
  4112         16  PB-I-INDV-GRP-CD             PIC X.
  4113         16  PB-I-MORT-CODE.
  4114             20  PB-I-TABLE               PIC X.
  4115             20  PB-I-INTEREST            PIC XX.
  4116             20  PB-I-MORT-TYP            PIC X.
  4117         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4118         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4119         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4120         16  PB-I-INDV-GRP-OVRD           PIC X.
  4121         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4122         16  PB-I-SIG-SW                  PIC X.
  4123             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4124         16  PB-I-RATE-CLASS              PIC XX.
  4125         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4126         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4127         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4128         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4129         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4130         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4131         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4132         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4133         16  PB-I-OB-FLAG                 PIC X.
  4134             88  PB-I-OB                      VALUE 'B'.
  4135             88  PB-I-SUMMARY                 VALUE 'Z'.
  4136         16  PB-I-ENTRY-STATUS            PIC X.
  4137             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4138                                              'M' '5' '9' '2'.
  4139             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4140             88  PB-I-POLICY-PENDING          VALUE '2'.
  4141             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4142             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4143             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4144             88  PB-I-REIN-ONLY               VALUE '9'.
  4145             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4146             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4147             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4148             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4149         16  PB-I-INT-CODE                PIC X.
  4150             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4151             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4152         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4153         16  PB-I-SOC-SEC-NO              PIC X(11).
  4154         16  PB-I-MEMBER-NO               PIC X(12).
  4155         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4156*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4157         16  PB-I-OLD-LOF                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  74
* EL6316.cbl
  4158         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4159         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4160         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4161         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4162         16  PB-I-LIFE-INDICATOR          PIC X.
  4163             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4164         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4165         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4166                                          PIC S9(5)V99    COMP-3.
  4167         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4168             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4169             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4170         16  PB-I-1ST-PMT-DT              PIC XX.
  4171         16  PB-I-JOINT-INSURED.
  4172             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4173             20 PB-I-JOINT-FIRST-NAME.
  4174                24  PB-I-JOINT-FIRST-INIT PIC X.
  4175                24  FILLER                PIC X(9).
  4176             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4177*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4178         16  PB-I-BENEFICIARY-NAME.
  4179             20  PB-I-BANK-NUMBER         PIC X(10).
  4180             20  FILLER                   PIC X(15).
  4181         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4182         16  PB-I-REFERENCE               PIC X(12).
  4183         16  FILLER REDEFINES PB-I-REFERENCE.
  4184             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4185             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4186             20  PB-I-CLP-STATE           PIC XX.
  4187         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4188             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4189             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4190             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4191         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4192         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4193         16  PB-I-RESIDENT-STATE          PIC XX.
  4194         16  PB-I-RATE-CODE               PIC X(4).
  4195         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4196         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4197         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4198         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4199         16  PB-I-BANK-NOCHRGB            PIC 99.
  4200         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4201         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4202
  4203     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4204         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4205             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4206         16  PB-C-CANCEL-ORIGIN           PIC X.
  4207             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4208         16  PB-C-LF-CANCEL-DT            PIC XX.
  4209         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4210         16  PB-C-LF-CALC-REQ             PIC X.
  4211             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4212         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4213         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4214         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4215             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  75
* EL6316.cbl
  4216         16  PB-C-AH-CANCEL-DT            PIC XX.
  4217         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4218         16  PB-C-AH-CALC-REQ             PIC X.
  4219             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4220         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4221         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4222         16  PB-C-LAST-NAME               PIC X(15).
  4223         16  PB-C-REFUND-SW               PIC X.
  4224             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4225             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4226         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4227         16  PB-C-PAYEE-CODE              PIC X(6).
  4228         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4229         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4230         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4231         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4232         16  PB-C-REFERENCE               PIC X(12).
  4233         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4234         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4235         16  PB-C-POST-CARD-IND           PIC X.
  4236         16  PB-C-CANCEL-REASON           PIC X.
  4237         16  PB-C-REF-INTERFACE-SW        PIC X.
  4238         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4239         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4240         16  FILLER                       PIC X(01).
  4241*        16  FILLER                       PIC X(18).
  4242         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4243*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4244         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4245         16  PB-CANCELED-CERT-DATA.
  4246             20  PB-CI-INSURED-NAME.
  4247                 24  PB-CI-LAST-NAME      PIC X(15).
  4248                 24  PB-CI-INITIALS       PIC XX.
  4249             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4250             20  PB-CI-INSURED-SEX        PIC X.
  4251             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4252             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4253             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4254             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4255             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4256             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4257             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4258             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4259             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4260             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4261             20  PB-CI-RATE-CLASS         PIC XX.
  4262             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4263             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4264             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4265             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4266             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4267             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4268             20  PB-CI-LF-ABBR            PIC X(3).
  4269             20  PB-CI-AH-ABBR            PIC X(3).
  4270             20  PB-CI-OB-FLAG            PIC X.
  4271                 88  PB-CI-OB                VALUE 'B'.
  4272             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4273                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  76
* EL6316.cbl
  4274                                           'M' '4' '5' '9' '2'.
  4275                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4276                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4277                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4278                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4279                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4280                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4281                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4282                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4283                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4284                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4285                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4286                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4287             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4288                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4289                                           'M' '4' '5' '9' '2'.
  4290                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4291                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4292                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4293                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4294                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4295                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4296                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4297                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4298                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4299                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4300                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4301                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4302             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4303             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4304             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4305             20  PB-CI-MEMBER-NO          PIC X(12).
  4306             20  PB-CI-INT-CODE           PIC X.
  4307                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4308                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4309             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4310             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4311             20  PB-CI-COMP-EXCP-SW       PIC X.
  4312                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4313                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4314             20  PB-CI-ENTRY-STATUS       PIC X.
  4315             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4316             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4317             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4318             20  PB-CI-DEATH-DT           PIC XX.
  4319             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4320             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4321             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4322             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4323             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4324             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4325             20  PB-CI-ENTRY-DT              PIC XX.
  4326             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4327             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4328             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4329             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4330             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4331             20  PB-CI-OLD-LOF               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  77
* EL6316.cbl
  4332*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4333             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4334             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4335             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4336             20  PB-CI-INDV-GRP-CD           PIC X.
  4337             20  PB-CI-BENEFICIARY-NAME.
  4338                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4339                 24  FILLER                  PIC X(15).
  4340             20  PB-CI-NOTE-SW               PIC X.
  4341             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4342             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4343             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4344             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4345             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4346             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4347             20  PB-CI-FIRST-NAME            PIC X(10).
  4348             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4349
  4350         16  FILLER                       PIC X(13).
  4351*032306  16  FILLER                       PIC X(27).
  4352*        16  FILLER                       PIC X(46).
  4353
  4354     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4355         16  FILLER                       PIC X(10).
  4356         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4357         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4358         16  PB-M-INSURED-MID-INIT        PIC X.
  4359         16  PB-M-INSURED-AGE             PIC 99.
  4360         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4361         16  PB-M-INSURED-SEX             PIC X.
  4362         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4363         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4364         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4365         16  PB-M-INSURED-CITY-STATE.
  4366             20  PB-M-INSURED-CITY        PIC X(28).
  4367             20  PB-M-INSURED-STATE       PIC XX.
  4368         16  PB-M-INSURED-ZIP-CODE.
  4369             20  PB-M-INSURED-ZIP-PRIME.
  4370                 24  PB-M-INSURED-ZIP-1   PIC X.
  4371                     88  PB-M-CANADIAN-POST-CODE
  4372                                             VALUE 'A' THRU 'Z'.
  4373                 24  FILLER               PIC X(4).
  4374             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4375         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4376                                        PB-M-INSURED-ZIP-CODE.
  4377             20  PM-M-INS-CAN-POST1       PIC XXX.
  4378             20  PM-M-INS-CAN-POST2       PIC XXX.
  4379             20  FILLER                   PIC XXX.
  4380         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4381         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4382         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4383         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4384         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4385         16  PB-M-CRED-BENE-CITYST.
  4386             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4387             20  PB-M-CRED-BENE-STATE     PIC XX.
  4388         16  FILLER                       PIC X(92).
  4389
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  78
* EL6316.cbl
  4390     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4391         16  FILLER                       PIC X(10).
  4392         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4393         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4394         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4395         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4396         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4397         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4398         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4399         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4400         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4401         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4402         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4403         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4404         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4405         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4406         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4407         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4408         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4409         16  PB-ACCOUNT-NAME              PIC X(30).
  4410         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4411         16  PB-REFERENCE                 PIC X(12).
  4412         16  PB-B-RECEIVED-DT             PIC XX.
  4413         16  FILLER                       PIC X(234).
  4414
  4415     12  PB-RECORD-STATUS.
  4416         16  PB-CREDIT-SELECT-DT          PIC XX.
  4417         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4418         16  PB-BILLED-DT                 PIC XX.
  4419         16  PB-BILLING-STATUS            PIC X.
  4420             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4421             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4422             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4423         16  PB-RECORD-BILL               PIC X.
  4424             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4425             88  PB-RECORD-RETURNED           VALUE 'R'.
  4426             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4427             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4428             88  PB-OVERRIDE-AH               VALUE 'A'.
  4429             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4430         16  PB-BATCH-ENTRY               PIC X.
  4431             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4432             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4433             88  PB-REISSUED-CERT             VALUE 'E'.
  4434             88  PB-MONTHLY-CERT              VALUE 'M'.
  4435             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4436             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4437             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4438         16  PB-FORCE-CODE                PIC X.
  4439             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4440             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4441             88  PB-CANCEL-FORCE              VALUE '8'.
  4442             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4443             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4444             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4445             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4446             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4447             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  79
* EL6316.cbl
  4448             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4449         16  PB-FATAL-FLAG                PIC X.
  4450             88  PB-FATAL-ERRORS              VALUE 'X'.
  4451         16  PB-FORCE-ER-CD               PIC X.
  4452             88  PB-FORCE-ERRORS              VALUE 'F'.
  4453             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4454         16  PB-WARN-ER-CD                PIC X.
  4455             88  PB-WARNING-ERRORS            VALUE 'W'.
  4456         16  FILLER                       PIC X.
  4457         16  PB-OUT-BAL-CD                PIC X.
  4458             88  PB-OUT-OF-BAL                VALUE 'O'.
  4459         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4460         16  PB-AH-OVERRIDE-L1            PIC X.
  4461         16  PB-INPUT-DT                  PIC XX.
  4462         16  PB-INPUT-BY                  PIC X(4).
  4463         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4464         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4465         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4466         16  PB-LF-EARNING-METHOD         PIC X.
  4467         16  PB-AH-EARNING-METHOD         PIC X.
  4468         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4469         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4470         16  PB-REIN-CD                   PIC XXX.
  4471         16  PB-LF-REFUND-TYPE            PIC X.
  4472         16  PB-AH-REFUND-TYPE            PIC X.
  4473         16  PB-ACCT-EFF-DT               PIC XX.
  4474         16  PB-ACCT-EXP-DT               PIC XX.
  4475         16  PB-COMPANY-ID                PIC X(3).
  4476         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4477         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4478         16  PB-SV-CARRIER                PIC X.
  4479         16  PB-SV-GROUPING               PIC X(6).
  4480         16  PB-SV-STATE                  PIC XX.
  4481         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4482         16  PB-GA-BILLING-INFO.
  4483             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4484                                          PIC XX.
  4485         16  PB-SV-REMIT-TO  REDEFINES
  4486             PB-GA-BILLING-INFO           PIC X(10).
  4487         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4488         16  PB-I-LOAN-OFFICER            PIC X(5).
  4489         16  PB-I-VIN                     PIC X(17).
  4490
  4491         16  FILLER                       PIC X(04).
  4492         16  IMNET-BYPASS-SW              PIC X.
  4493
  4494******************************************************************
  4495*                COMMON EDIT ERRORS                              *
  4496******************************************************************
  4497
  4498     12  PB-COMMON-ERRORS.
  4499         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4500                                           PIC S9(4)     COMP.
  4501
  4502******************************************************************
  4503*                                COPY ELCCERT.
  4504******************************************************************
  4505*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  80
* EL6316.cbl
  4506*                            ELCCERT.                            *
  4507*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4508*                            VMOD=2.013                          *
  4509*                                                                *
  4510*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4511*                                                                *
  4512*   FILE TYPE = VSAM,KSDS                                        *
  4513*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4514*                                                                *
  4515*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4516*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4517*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4518*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4519*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4520*                                                                *
  4521*   LOG = YES                                                    *
  4522*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4523******************************************************************
  4524*                   C H A N G E   L O G
  4525*
  4526* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4527*-----------------------------------------------------------------
  4528*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4529* EFFECTIVE    NUMBER
  4530*-----------------------------------------------------------------
  4531* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4532* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4533* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4534* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4535* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4536* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4537* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4538* 032612  CR2011110200001  PEMA  AHL CHANGES
  4539******************************************************************
  4540
  4541 01  CERTIFICATE-MASTER.
  4542     12  CM-RECORD-ID                      PIC XX.
  4543         88  VALID-CM-ID                      VALUE 'CM'.
  4544
  4545     12  CM-CONTROL-PRIMARY.
  4546         16  CM-COMPANY-CD                 PIC X.
  4547         16  CM-CARRIER                    PIC X.
  4548         16  CM-GROUPING.
  4549             20  CM-GROUPING-PREFIX        PIC X(3).
  4550             20  CM-GROUPING-PRIME         PIC X(3).
  4551         16  CM-STATE                      PIC XX.
  4552         16  CM-ACCOUNT.
  4553             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4554             20  CM-ACCOUNT-PRIME          PIC X(6).
  4555         16  CM-CERT-EFF-DT                PIC XX.
  4556         16  CM-CERT-NO.
  4557             20  CM-CERT-PRIME             PIC X(10).
  4558             20  CM-CERT-SFX               PIC X.
  4559
  4560     12  CM-CONTROL-BY-NAME.
  4561         16  CM-COMPANY-CD-A1              PIC X.
  4562         16  CM-INSURED-LAST-NAME          PIC X(15).
  4563         16  CM-INSURED-INITIALS.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  81
* EL6316.cbl
  4564             20  CM-INSURED-INITIAL1       PIC X.
  4565             20  CM-INSURED-INITIAL2       PIC X.
  4566
  4567     12  CM-CONTROL-BY-SSN.
  4568         16  CM-COMPANY-CD-A2              PIC X.
  4569         16  CM-SOC-SEC-NO.
  4570             20  CM-SSN-STATE              PIC XX.
  4571             20  CM-SSN-ACCOUNT            PIC X(6).
  4572             20  CM-SSN-LN3.
  4573                 25  CM-INSURED-INITIALS-A2.
  4574                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4575                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4576                 25 CM-PART-LAST-NAME-A2         PIC X.
  4577
  4578     12  CM-CONTROL-BY-CERT-NO.
  4579         16  CM-COMPANY-CD-A4              PIC X.
  4580         16  CM-CERT-NO-A4                 PIC X(11).
  4581
  4582     12  CM-CONTROL-BY-MEMB.
  4583         16  CM-COMPANY-CD-A5              PIC X.
  4584         16  CM-MEMBER-NO.
  4585             20  CM-MEMB-STATE             PIC XX.
  4586             20  CM-MEMB-ACCOUNT           PIC X(6).
  4587             20  CM-MEMB-LN4.
  4588                 25  CM-INSURED-INITIALS-A5.
  4589                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4590                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4591                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4592
  4593     12  CM-INSURED-PROFILE-DATA.
  4594         16  CM-INSURED-FIRST-NAME.
  4595             20  CM-INSURED-1ST-INIT       PIC X.
  4596             20  FILLER                    PIC X(9).
  4597         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4598         16  CM-INSURED-SEX                PIC X.
  4599             88  CM-SEX-MALE                  VALUE 'M'.
  4600             88  CM-SEX-FEMAL                 VALUE 'F'.
  4601         16  CM-INSURED-JOINT-AGE          PIC 99.
  4602         16  CM-JOINT-INSURED-NAME.
  4603             20  CM-JT-LAST-NAME           PIC X(15).
  4604             20  CM-JT-FIRST-NAME.
  4605                 24  CM-JT-1ST-INIT        PIC X.
  4606                 24  FILLER                PIC X(9).
  4607             20  CM-JT-INITIAL             PIC X.
  4608
  4609     12  CM-LIFE-DATA.
  4610         16  CM-LF-BENEFIT-CD              PIC XX.
  4611         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4612         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4613         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4614         16  CM-LF-DEV-CODE                PIC XXX.
  4615         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4616         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4617         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4618         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4619         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4620         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4621         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  82
* EL6316.cbl
  4622         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4623         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4624         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4625         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4626         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4627         16  FILLER                        PIC XX.
  4628
  4629     12  CM-AH-DATA.
  4630         16  CM-AH-BENEFIT-CD              PIC XX.
  4631         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4632         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4633         16  CM-AH-DEV-CODE                PIC XXX.
  4634         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4635         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4636         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4637         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4638         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4639         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4640         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4641         16  CM-AH-PAID-THRU-DT            PIC XX.
  4642             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4643         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4644         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4645         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4646         16  FILLER                        PIC X.
  4647
  4648     12  CM-LOAN-INFORMATION.
  4649         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4650         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4651                                           PIC S9(5)V99  COMP-3.
  4652         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4653         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4654         16  CM-PAY-FREQUENCY              PIC S99.
  4655         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4656         16  CM-RATE-CLASS                 PIC XX.
  4657         16  CM-BENEFICIARY                PIC X(25).
  4658         16  CM-POLICY-FORM-NO             PIC X(12).
  4659         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4660         16  CM-LAST-ADD-ON-DT             PIC XX.
  4661         16  CM-DEDUCTIBLE-AMOUNTS.
  4662             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4663             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4664         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4665             20  CM-RESIDENT-STATE         PIC XX.
  4666             20  CM-RATE-CODE              PIC X(4).
  4667             20  FILLER                    PIC XX.
  4668         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4669             20  CM-LOAN-OFFICER           PIC X(5).
  4670             20  FILLER                    PIC XXX.
  4671         16  CM-CSR-CODE                   PIC XXX.
  4672         16  CM-UNDERWRITING-CODE          PIC X.
  4673             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4674         16  CM-POST-CARD-IND              PIC X.
  4675         16  CM-NH-INTERFACE-SW            PIC X.
  4676         16  CM-PREMIUM-TYPE               PIC X.
  4677             88  CM-SING-PRM                  VALUE '1'.
  4678             88  CM-O-B-COVERAGE              VALUE '2'.
  4679             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  83
* EL6316.cbl
  4680         16  CM-IND-GRP-TYPE               PIC X.
  4681             88  CM-INDIVIDUAL                VALUE 'I'.
  4682             88  CM-GROUP                     VALUE 'G'.
  4683         16  CM-SKIP-CODE                  PIC X.
  4684             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4685             88  SKIP-JULY                    VALUE '1'.
  4686             88  SKIP-AUGUST                  VALUE '2'.
  4687             88  SKIP-SEPTEMBER               VALUE '3'.
  4688             88  SKIP-JULY-AUG                VALUE '4'.
  4689             88  SKIP-AUG-SEPT                VALUE '5'.
  4690             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4691             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4692             88  SKIP-JUNE                    VALUE '8'.
  4693             88  SKIP-JUNE-JULY               VALUE '9'.
  4694             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4695             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4696         16  CM-PAYMENT-MODE               PIC X.
  4697             88  PAY-MONTHLY                  VALUE SPACE.
  4698             88  PAY-WEEKLY                   VALUE '1'.
  4699             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4700             88  PAY-BI-WEEKLY                VALUE '3'.
  4701             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4702         16  CM-LOAN-NUMBER                PIC X(8).
  4703         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4704         16  CM-OLD-LOF                    PIC XXX.
  4705*        16  CM-LOAN-OFFICER               PIC XXX.
  4706         16  CM-REIN-TABLE                 PIC XXX.
  4707         16  CM-SPECIAL-REIN-CODE          PIC X.
  4708         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4709         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4710         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4711
  4712     12  CM-STATUS-DATA.
  4713         16  CM-ENTRY-STATUS               PIC X.
  4714         16  CM-ENTRY-DT                   PIC XX.
  4715
  4716         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4717         16  CM-LF-CANCEL-DT               PIC XX.
  4718         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4719
  4720         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4721         16  CM-LF-DEATH-DT                PIC XX.
  4722         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4723
  4724         16  CM-LF-CURRENT-STATUS          PIC X.
  4725             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4726                                                'M' '4' '5' '9'.
  4727             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4728             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4729             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4730             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4731             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4732             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4733             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4734             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4735             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4736             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4737             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  84
* EL6316.cbl
  4738             88  CM-LF-VOIDED                 VALUE 'V'.
  4739
  4740         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4741         16  CM-AH-CANCEL-DT               PIC XX.
  4742         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4743
  4744         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4745         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4746         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4747
  4748         16  CM-AH-CURRENT-STATUS          PIC X.
  4749             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4750                                                'M' '4' '5' '9'.
  4751             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4752             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4753             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4754             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4755             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4756             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4757             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4758             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4759             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4760             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4761             88  CM-AH-DECLINED               VALUE 'D'.
  4762             88  CM-AH-VOIDED                 VALUE 'V'.
  4763
  4764         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4765             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4766             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4767             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4768         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4769
  4770         16  CM-ENTRY-BATCH                PIC X(6).
  4771         16  CM-LF-EXIT-BATCH              PIC X(6).
  4772         16  CM-AH-EXIT-BATCH              PIC X(6).
  4773         16  CM-LAST-MONTH-END             PIC XX.
  4774
  4775     12  CM-NOTE-SW                        PIC X.
  4776         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4777         88  CERT-NOTES-PRESENT               VALUE '1'.
  4778         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4779         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4780         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4781         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4782         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4783         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4784     12  CM-COMP-EXCP-SW                   PIC X.
  4785         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4786         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4787     12  CM-INSURED-ADDRESS-SW             PIC X.
  4788         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4789         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4790
  4791*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4792     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4793     12  FILLER                            PIC X.
  4794
  4795*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  85
* EL6316.cbl
  4796     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4797     12  FILLER                            PIC X.
  4798*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4799     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4800
  4801     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4802         88  CERT-ADDED-BATCH                 VALUE ' '.
  4803         88  CERT-ADDED-ONLINE                VALUE '1'.
  4804         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4805         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4806         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4807     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4808         88  CERT-AS-LOADED                   VALUE ' '.
  4809         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4810         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4811         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4812         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4813         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4814         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4815         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4816
  4817     12  CM-ACCOUNT-COMM-PCTS.
  4818         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4819         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4820
  4821     12  CM-USER-FIELD                     PIC X.
  4822     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4823     12  CM-CLP-STATE                      PIC XX.
  4824     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4825     12  CM-USER-RESERVED                  PIC XXX.
  4826     12  FILLER REDEFINES CM-USER-RESERVED.
  4827         16  CM-AH-CLASS-CD                PIC XX.
  4828         16  F                             PIC X.
  4829******************************************************************
  4830*                                COPY ELCCRTO.
  4831******************************************************************
  4832*                                                                *
  4833*                            ELCCRTO.                            *
  4834*                                                                *
  4835*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4836*                                                                *
  4837*   FILE TYPE = VSAM,KSDS                                        *
  4838*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4839*                                                                *
  4840*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4841*                                                                *
  4842*   LOG = YES                                                    *
  4843*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4844******************************************************************
  4845*                   C H A N G E   L O G
  4846*
  4847* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4848*-----------------------------------------------------------------
  4849*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4850* EFFECTIVE    NUMBER
  4851*-----------------------------------------------------------------
  4852* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4853* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  86
* EL6316.cbl
  4854* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4855* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4856******************************************************************
  4857 01  ORIGINAL-CERTIFICATE.
  4858     12  OC-RECORD-ID                      PIC XX.
  4859         88  VALID-OC-ID                      VALUE 'OC'.
  4860     12  OC-CONTROL-PRIMARY.
  4861         16  OC-COMPANY-CD                 PIC X.
  4862         16  OC-CARRIER                    PIC X.
  4863         16  OC-GROUPING                   PIC X(6).
  4864         16  OC-STATE                      PIC XX.
  4865         16  OC-ACCOUNT                    PIC X(10).
  4866         16  OC-CERT-EFF-DT                PIC XX.
  4867         16  OC-CERT-NO.
  4868             20  OC-CERT-PRIME             PIC X(10).
  4869             20  OC-CERT-SFX               PIC X.
  4870         16  OC-RECORD-TYPE                PIC X.
  4871         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4872     12  OC-LAST-MAINT-DT                  PIC XX.
  4873     12  OC-LAST-MAINT-BY                  PIC X(4).
  4874     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4875     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4876     12  FILLER                            PIC X(49).
  4877     12  OC-ORIG-REC.
  4878         16  OC-INS-LAST-NAME              PIC X(15).
  4879         16  OC-INS-FIRST-NAME             PIC X(10).
  4880         16  OC-INS-MIDDLE-INIT            PIC X.
  4881         16  OC-INS-AGE                    PIC S999     COMP-3.
  4882         16  OC-JNT-LAST-NAME              PIC X(15).
  4883         16  OC-JNT-FIRST-NAME             PIC X(10).
  4884         16  OC-JNT-MIDDLE-INIT            PIC X.
  4885         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4886         16  OC-LF-BENCD                   PIC XX.
  4887         16  OC-LF-TERM                    PIC S999      COMP-3.
  4888         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4889         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4890         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4891         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4892         16  OC-LF-EXP-DT                  PIC XX.
  4893         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4894         16  OC-LF-CANCEL-DT               PIC XX.
  4895         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4896         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4897         16  OC-AH-BENCD                   PIC XX.
  4898         16  OC-AH-TERM                    PIC S999      COMP-3.
  4899         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4900         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4901         16  OC-AH-EXP-DT                  PIC XX.
  4902         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4903         16  OC-AH-CP                      PIC 99.
  4904         16  OC-AH-CANCEL-DT               PIC XX.
  4905         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4906         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4907         16  OC-CRED-BENE-NAME             PIC X(25).
  4908         16  OC-1ST-PMT-DT                 PIC XX.
  4909         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  4910         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  4911         16  FILLER                        PIC X(213).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  87
* EL6316.cbl
  4912
  4913     12  FILLER                            PIC X(50).
  4914******************************************************************
  4915*                                COPY ERCENDT.
  4916******************************************************************
  4917*                                                                *
  4918*                                                                *
  4919*                            ERCENDT.                            *
  4920*                            VMOD=2.001                          *
  4921*                                                                *
  4922*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4923*                                                                *
  4924*   FILE TYPE = VSAM,KSDS                                        *
  4925*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4926*                                                                *
  4927*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4928*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4929*                                                                *
  4930*   LOG = NO                                                     *
  4931*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4932******************************************************************
  4933*-----------------------------------------------------------------
  4934*                   C H A N G E   L O G
  4935*
  4936* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4937*-----------------------------------------------------------------
  4938*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4939* EFFECTIVE    NUMBER
  4940*-----------------------------------------------------------------
  4941* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4942*                                WITH OPEN CLAIMS
  4943* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4944* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4945* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4946*-----------------------------------------------------------------
  4947 01  ENDORSEMENT-RECORD.
  4948     12  EN-RECORD-ID                PIC XX.
  4949         88  VALID-EN-ID                VALUE 'EN'.
  4950     12  EN-CONTROL-PRIMARY.
  4951         16  EN-COMPANY-CD           PIC X.
  4952         16  EN-CARRIER              PIC X.
  4953         16  EN-GROUPING             PIC X(6).
  4954         16  EN-STATE                PIC XX.
  4955         16  EN-ACCOUNT              PIC X(10).
  4956         16  EN-CERT-EFF-DT          PIC XX.
  4957         16  EN-CERT-NO.
  4958             20  EN-CERT-PRIME       PIC X(10).
  4959             20  EN-CERT-SFX         PIC X.
  4960         16  EN-REC-TYPE             PIC X.
  4961             88  EN-ISSUE               VALUE 'I'.
  4962             88  EN-CANCELLATION        VALUE 'C'.
  4963         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4964     12  EN-CONTROL-BY-ARCH-NO.
  4965         16  EN-COMPANY-CD-A1              PIC X.
  4966         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4967     12  EN-LAST-MAINT-DT            PIC XX.
  4968     12  EN-LAST-MAINT-BY            PIC X(4).
  4969     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  88
* EL6316.cbl
  4970     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4971     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4972         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4973         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4974         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4975         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4976         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4977         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4978         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4979         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4980         16  EN-LF-ORIG-BENCD        PIC XX.
  4981         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4982         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4983         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4984         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  4985         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4986         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4987*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4988         16  EN-ORIG-CRED-BENE       PIC X(25).
  4989         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4990         16  FILLER                  PIC X.
  4991         16  EN-AH-ORIG-BENCD        PIC XX.
  4992         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  4993         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4994         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4995         16  EN-AH-ORIG-EXP-DT       PIC XX.
  4996*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  4997*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  4998         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4999         16  F                       PIC X(09).
  5000         16  EN-AH-ORIG-CP           PIC 99.
  5001         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  5002         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  5003         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  5004         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  5005         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  5006         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  5007         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  5008         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  5009         16  EN-LF-NEW-BENCD         PIC XX.
  5010         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  5011         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5012         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5013         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  5014         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  5015         16  EN-LF-NEW-EXP-DT        PIC XX.
  5016         16  EN-NEW-CRED-BENE        PIC X(25).
  5017         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5018         16  FILLER                  PIC X.
  5019         16  EN-AH-NEW-BENCD         PIC XX.
  5020         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5021         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5022         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5023         16  EN-AH-NEW-EXP-DT        PIC XX.
  5024*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5025*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5026*        16  F                       PIC X(12).
  5027         16  EN-AH-NEW-CP            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  89
* EL6316.cbl
  5028         16  EN-SIG-SW               PIC X.
  5029         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5030         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  5031         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  5032         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  5033         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  5034         16  FILLER                  PIC X(33).
  5035     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5036         16  EN-LF-ORIG-REF-DT       PIC XX.
  5037         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5038         16  EN-AH-ORIG-REF-DT       PIC XX.
  5039         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5040         16  EN-LF-NEW-REF-DT        PIC XX.
  5041         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5042         16  EN-AH-NEW-REF-DT        PIC XX.
  5043         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5044         16  EN-FLAG-CERT            PIC X.
  5045         16  EN-INS-LAST-NAME        PIC X(15).
  5046         16  EN-INS-FIRST-NAME       PIC X(10).
  5047         16  EN-INS-MIDDLE-INIT      PIC X.
  5048         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5049         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5050         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5051         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5052         16  FILLER                  PIC X(262).
  5053     12  EN-MONEY-SW             PIC X.
  5054     12  EN-HEALTH-APP           PIC X.
  5055     12  EN-VOUCHER-SW           PIC X.
  5056     12  EN-PAYEE                PIC X(14).
  5057     12  EN-INPUT-DT             PIC XX.
  5058     12  EN-PROCESS-DT           PIC XX.
  5059     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5060     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5061     12  EN-REASON-CODES.
  5062         16  F OCCURS 12.
  5063             20  EN-REASON-CODE  PIC X(4).
  5064     12  EN-TEMPLATE-USED        PIC X(8).
  5065     12  EN-DOCU-TYPE            PIC X.
  5066         88  EN-VERI-DOCU          VALUE 'V'.
  5067         88  EN-GCE-DOCU           VALUE 'G'.
  5068         88  EN-CANC-DOCU          VALUE 'C'.
  5069     12  EN-COMMENTS1            PIC X(13).
  5070     12  EN-COMMENTS2            PIC X(70).
  5071     12  EN-COMM-CHGBK           PIC X.
  5072         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5073         88  EN-CHG-ACCT           VALUE 'Y'.
  5074     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5075     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5076     12  EN-BATCH-NUMBER         PIC X(6).
  5077     12  EN-ACCT-SUMM            PIC X.
  5078     12  EN-CSO-SUMM             PIC X.
  5079     12  FILLER                  PIC X(13).
  5080******************************************************************
  5081*                                COPY ERCNOTE.
  5082******************************************************************
  5083*                                                                *
  5084*                                                                *
  5085*                            ERCNOTE                             *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  90
* EL6316.cbl
  5086*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5087*                            VMOD=2.003                          *
  5088*                                                                *
  5089*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5090*                                                                *
  5091*        FILE TYPE= VSAM,KSDS                                    *
  5092*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5093*                                                                *
  5094*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5095*                                                                *
  5096*        LOG = YES                                               *
  5097*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5098*                                                                *
  5099******************************************************************
  5100*                   C H A N G E   L O G
  5101*
  5102* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5103*-----------------------------------------------------------------
  5104*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5105* EFFECTIVE    NUMBER
  5106*-----------------------------------------------------------------
  5107* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5108*                                FILE WILL CONTAIN BILLING NOTES O
  5109******************************************************************
  5110
  5111 01  CERTIFICATE-NOTE.
  5112     12  CN-RECORD-ID                PIC  XX.
  5113         88  VALID-CN-ID                  VALUE 'CN'.
  5114
  5115     12  CN-CONTROL-PRIMARY.
  5116         16  CN-COMPANY-CD           PIC X.
  5117         16  CN-CARRIER              PIC X.
  5118         16  CN-GROUPING.
  5119             20 CN-GROUPING-PREFIX   PIC XXX.
  5120             20 CN-GROUPING-PRIME    PIC XXX.
  5121         16  CN-STATE                PIC XX.
  5122         16  CN-ACCOUNT.
  5123             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5124             20 CN-ACCOUNT-PRIME     PIC X(6).
  5125         16  CN-CERT-EFF-DT          PIC XX.
  5126         16  CN-CERT-NO.
  5127             20  CN-CERT-PRIME       PIC X(10).
  5128             20  CN-CERT-SFX         PIC X.
  5129
  5130     12  CN-BILLING-START-LINE-NO    PIC 99.
  5131     12  CN-BILLING-END-LINE-NO      PIC 99.
  5132
  5133     12  CN-LINES.
  5134         16  CN-LINE OCCURS 10       PIC X(77).
  5135
  5136     12  CN-LAST-MAINT-DT            PIC XX.
  5137     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5138     12  CN-LAST-MAINT-USER          PIC X(4).
  5139     12  FILLER                      PIC X(6).
  5140******************************************************************
  5141*                                COPY ERCMAIL.
  5142******************************************************************
  5143*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  91
* EL6316.cbl
  5144*                                                                *
  5145*                            ERCMAIL                             *
  5146*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5147*                            VMOD=2.003                          *
  5148*                                                                *
  5149*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5150*                                                                *
  5151*   FILE TYPE = VSAM,KSDS                                        *
  5152*   RECORD SIZE = 374   RECFORM = FIX                            *
  5153*                                                                *
  5154*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5155*   ALTERNATE PATH    = NOT USED                                 *
  5156*                                                                *
  5157*   LOG = YES                                                    *
  5158*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5159******************************************************************
  5160*                   C H A N G E   L O G
  5161*
  5162* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5163*-----------------------------------------------------------------
  5164*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5165* EFFECTIVE    NUMBER
  5166*-----------------------------------------------------------------
  5167* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5168* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5169* 111108                   PEMA  ADD CRED BENE ADDR2
  5170******************************************************************
  5171
  5172 01  MAILING-DATA.
  5173     12  MA-RECORD-ID                      PIC XX.
  5174         88  VALID-MA-ID                       VALUE 'MA'.
  5175
  5176     12  MA-CONTROL-PRIMARY.
  5177         16  MA-COMPANY-CD                 PIC X.
  5178         16  MA-CARRIER                    PIC X.
  5179         16  MA-GROUPING.
  5180             20  MA-GROUPING-PREFIX        PIC XXX.
  5181             20  MA-GROUPING-PRIME         PIC XXX.
  5182         16  MA-STATE                      PIC XX.
  5183         16  MA-ACCOUNT.
  5184             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5185             20  MA-ACCOUNT-PRIME          PIC X(6).
  5186         16  MA-CERT-EFF-DT                PIC XX.
  5187         16  MA-CERT-NO.
  5188             20  MA-CERT-PRIME             PIC X(10).
  5189             20  MA-CERT-SFX               PIC X.
  5190
  5191     12  FILLER                            PIC XX.
  5192
  5193     12  MA-ACCESS-CONTROL.
  5194         16  MA-SOURCE-SYSTEM              PIC XX.
  5195             88  MA-FROM-CREDIT                VALUE 'CR'.
  5196             88  MA-FROM-VSI                   VALUE 'VS'.
  5197             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5198             88  MA-FROM-OTHER                 VALUE 'OT'.
  5199         16  MA-RECORD-ADD-DT              PIC XX.
  5200         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5201         16  MA-LAST-MAINT-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  92
* EL6316.cbl
  5202         16  MA-LAST-MAINT-BY              PIC XXXX.
  5203         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5204
  5205     12  MA-PROFILE-INFO.
  5206         16  MA-QUALIFY-CODE-1             PIC XX.
  5207         16  MA-QUALIFY-CODE-2             PIC XX.
  5208         16  MA-QUALIFY-CODE-3             PIC XX.
  5209         16  MA-QUALIFY-CODE-4             PIC XX.
  5210         16  MA-QUALIFY-CODE-5             PIC XX.
  5211
  5212         16  MA-INSURED-LAST-NAME          PIC X(15).
  5213         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5214         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5215         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5216         16  MA-INSURED-BIRTH-DT           PIC XX.
  5217         16  MA-INSURED-SEX                PIC X.
  5218             88  MA-SEX-MALE                   VALUE 'M'.
  5219             88  MA-SEX-FEMALE                 VALUE 'F'.
  5220         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5221
  5222         16  MA-ADDRESS-CORRECTED          PIC X.
  5223         16  MA-JOINT-BIRTH-DT             PIC XX.
  5224*        16  FILLER                        PIC X(12).
  5225
  5226         16  MA-ADDRESS-LINE-1             PIC X(30).
  5227         16  MA-ADDRESS-LINE-2             PIC X(30).
  5228         16  MA-CITY-STATE.
  5229             20  MA-CITY                   PIC X(28).
  5230             20  MA-ADDR-STATE             PIC XX.
  5231         16  MA-ZIP.
  5232             20  MA-ZIP-CODE.
  5233                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5234                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5235                 24  FILLER                PIC X(4).
  5236             20  MA-ZIP-PLUS4              PIC X(4).
  5237         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5238             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5239             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5240             20  FILLER                    PIC X(3).
  5241
  5242         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5243
  5244         16  FILLER                        PIC XXX.
  5245*        16  FILLER                        PIC X(10).
  5246
  5247     12  MA-CRED-BENE-INFO.
  5248         16  MA-CRED-BENE-NAME                 PIC X(25).
  5249         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5250         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5251         16  MA-CRED-BENE-CTYST.
  5252             20  MA-CRED-BENE-CITY             PIC X(28).
  5253             20  MA-CRED-BENE-STATE            PIC XX.
  5254         16  MA-CRED-BENE-ZIP.
  5255             20  MA-CB-ZIP-CODE.
  5256                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5257                     88  MA-CB-CANADIAN-POST-CODE
  5258                                           VALUE 'A' THRU 'Z'.
  5259                 24  FILLER                    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  93
* EL6316.cbl
  5260             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5261         16  MA-CB-CANADIAN-POSTAL-CODE
  5262                            REDEFINES MA-CRED-BENE-ZIP.
  5263             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5264             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5265             20  FILLER                        PIC X(3).
  5266     12  MA-POST-CARD-MAIL-DATA.
  5267         16  MA-MAIL-DATA OCCURS 7.
  5268             20  MA-MAIL-TYPE              PIC X.
  5269                 88  MA-12MO-MAILING           VALUE '1'.
  5270                 88  MA-EXP-MAILING            VALUE '2'.
  5271             20  MA-MAIL-STATUS            PIC X.
  5272                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5273                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5274                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5275             20  MA-MAIL-DATE              PIC XX.
  5276     12  FILLER                            PIC XX.
  5277     12  FILLER                            PIC XX.
  5278*    12  FILLER                            PIC X(30).
  5279******************************************************************
  5280*                                COPY ERCCNOT.
  5281******************************************************************
  5282*                                                                *
  5283*                            ERCCNOT                             *
  5284*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5285*                            VMOD=2.003                          *
  5286*                                                                *
  5287*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5288*                                                                *
  5289*        FILE TYPE= VSAM,KSDS                                    *
  5290*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5291*                                                                *
  5292*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5293*                                                                *
  5294*        LOG = YES                                               *
  5295*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5296*                                                                *
  5297******************************************************************
  5298*                   C H A N G E   L O G
  5299*
  5300* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5301*-----------------------------------------------------------------
  5302*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5303* EFFECTIVE    NUMBER
  5304*-----------------------------------------------------------------
  5305* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5306******************************************************************
  5307
  5308 01  CERT-NOTE-FILE.
  5309     12  CZ-RECORD-ID                PIC  XX.
  5310         88  VALID-CZ-ID                  VALUE 'CZ'.
  5311
  5312     12  CZ-CONTROL-PRIMARY.
  5313         16  CZ-COMPANY-CD           PIC X.
  5314         16  CZ-CARRIER              PIC X.
  5315         16  CZ-GROUPING.
  5316             20 CZ-GROUPING-PREFIX   PIC XXX.
  5317             20 CZ-GROUPING-PRIME    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  94
* EL6316.cbl
  5318         16  CZ-STATE                PIC XX.
  5319         16  CZ-ACCOUNT.
  5320             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5321             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5322         16  CZ-CERT-EFF-DT          PIC XX.
  5323         16  CZ-CERT-NO.
  5324             20  CZ-CERT-PRIME       PIC X(10).
  5325             20  CZ-CERT-SFX         PIC X.
  5326         16  CZ-RECORD-TYPE          PIC X.
  5327             88  CERT-NOTE           VALUE '1'.
  5328             88  CLAIM-CERT-NOTE     VALUE '2'.
  5329         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5330
  5331     12  CZ-LAST-MAINT-DT            PIC XX.
  5332     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5333     12  CZ-LAST-MAINT-USER          PIC X(4).
  5334
  5335     12  CZ-NOTE-INFORMATION.
  5336         16  CZ-NOTE                 PIC X(63).
  5337         16  FILLER                  PIC X(39).
  5338******************************************************************
  5339*                                COPY ELCEOBC.
  5340******************************************************************
  5341*                                                                *
  5342*                                                                *
  5343*                            ELCEOBC                             *
  5344*                            VMOD=2.001                          *
  5345*                                                                *
  5346*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5347*                                                                *
  5348*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5349*   VSAM EOB CODE TABLE                                          *
  5350*                                                                *
  5351*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5352*                                                                *
  5353*   FILE TYPE = VSAM,KSDS                                        *
  5354*   RECORD SIZE = 350   RECFORM = FIX                            *
  5355*                                                                *
  5356*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5357*                                                                *
  5358*   LOG = NO                                                     *
  5359*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5360*                                                                *
  5361*                                                                *
  5362******************************************************************
  5363*                   C H A N G E   L O G
  5364*
  5365* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5366*-----------------------------------------------------------------
  5367*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5368* EFFECTIVE    NUMBER
  5369*-----------------------------------------------------------------
  5370* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5371* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5372******************************************************************
  5373 01  EOB-CODES.
  5374     12  EO-RECORD-ID                      PIC XX.
  5375         88  VALID-DN-ID                      VALUE 'EO'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  95
* EL6316.cbl
  5376     12  EO-CONTROL-PRIMARY.
  5377         16  EO-COMPANY-CD                 PIC X.
  5378         16  EO-RECORD-TYPE                PIC X.
  5379             88  EO-EOB-RECS                  VALUE '1'.
  5380             88  EO-VERIF-RECS                VALUE '2'.
  5381             88  EO-GCE-RECS                  VALUE '3'.
  5382         16  EO-EOB-CODE                   PIC X(4).
  5383         16  FILLER                        PIC X(9).
  5384     12  EO-MAINT-INFORMATION.
  5385         16  EO-LAST-MAINT-DT              PIC XX.
  5386         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5387         16  EO-LAST-MAINT-USER            PIC X(4).
  5388         16  FILLER                        PIC XX.
  5389     12  EO-DESCRIPTION                    PIC X(275).
  5390     12  FILLER                            PIC X(46).
  5391******************************************************************
  5392 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5393                          ACCOUNT-MASTER CONTROL-FILE
  5394                          PENDING-BUSINESS CERTIFICATE-MASTER
  5395                          ORIGINAL-CERTIFICATE
  5396                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5397                          MAILING-DATA CERT-NOTE-FILE EOB-CODES.
  5398 0000-DFHEXIT SECTION.
  5399     MOVE '9#                    $   ' TO DFHEIV0.
  5400     MOVE 'EL6316' TO DFHEIV1.
  5401     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5402     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5403     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5404     MOVE '5'                    TO DC-OPTION-CODE
  5405     PERFORM 9700-DATE-LINK
  5406     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT
  5407     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT
  5408     MOVE EIBTRMID               TO QID-TERM
  5409     IF EIBCALEN = 0
  5410        GO TO 8800-UNAUTHORIZED-ACCESS
  5411     END-IF
  5412     DISPLAY ' ENDORSE LENGTH  '
  5413                FUNCTION LENGTH(ENDORSEMENT-RECORD)
  5414     move function length(EL631II) TO MAP-LENGTH
  5415     DISPLAY ' MAP LENGTH      ' MAP-LENGTH
  5416     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5417        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5418           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5419           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5420           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5421           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5422           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5423           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5424           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5425           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5426           MOVE LOW-VALUES             TO EL631II
  5427           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5428           GO TO 0350-DISPLAY-COMMON-DATA
  5429        END-IF
  5430     END-IF
  5431     IF PI-CALLING-PROGRAM = 'EL614'
  5432        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5433                                 TO WS-PASSED-REASON-CODES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  96
* EL6316.cbl
  5434        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5435        IF WS-PASSED-REASON-CODES NOT = SPACES
  5436           MOVE 'Y'                TO WS-SET-CODES-MDT
  5437        ELSE
  5438           MOVE 'N'                TO WS-SET-CODES-MDT
  5439        END-IF
  5440        PERFORM 0610-RECOVER-TEMP-STORAGE
  5441                                 THRU 0610-EXIT
  5442        GO TO 0350-DISPLAY-COMMON-DATA
  5443     END-IF
  5444     IF EIBAID = DFHCLEAR
  5445        IF PI-CLEAR-ERROR
  5446           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5447           MOVE ER-3833           TO EMI-ERROR
  5448           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5449           GO TO 0350-DISPLAY-COMMON-DATA
  5450        ELSE
  5451           GO TO 9400-CLEAR
  5452        END-IF
  5453     END-IF
  5454     .
  5455 0200-RECEIVE.
  5456     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5457        MOVE ER-0008             TO EMI-ERROR
  5458        PERFORM 9900-ERROR-FORMAT
  5459                                 THRU 9900-EXIT
  5460        MOVE -1                  TO PFENTRL
  5461        GO TO 8100-SEND-INITIAL-MAP
  5462     END-IF
  5463
  5464* EXEC CICS RECEIVE
  5465*        MAP      (MAP-NAME)
  5466*        MAPSET   (MAPSET-NAME)
  5467*        INTO     (EL631II)
  5468*    END-EXEC
  5469     MOVE LENGTH OF
  5470      EL631II
  5471       TO DFHEIV11
  5472*    MOVE '8"T I  L              ''   #00005459' TO DFHEIV0
  5473     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5474     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5475     MOVE X'2020233030303035343539' TO DFHEIV0(25:11)
  5476     CALL 'kxdfhei1' USING DFHEIV0,
  5477           MAP-NAME,
  5478           EL631II,
  5479           DFHEIV11,
  5480           MAPSET-NAME,
  5481           DFHEIV99,
  5482           DFHEIV99
  5483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5484     IF PFENTRL = 0
  5485         GO TO 0300-CHECK-PFKEYS
  5486     END-IF
  5487     IF EIBAID NOT = DFHENTER
  5488         MOVE ER-0004            TO EMI-ERROR
  5489         GO TO 0320-INPUT-ERROR
  5490     END-IF
  5491     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  97
* EL6316.cbl
  5492        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5493     ELSE
  5494        MOVE ER-0029            TO EMI-ERROR
  5495        GO TO 0320-INPUT-ERROR
  5496     END-IF
  5497     .
  5498 0300-CHECK-PFKEYS.
  5499     IF EIBAID = DFHPF1
  5500        MOVE PI-ERENDT-KEY       TO ERENDT-KEY
  5501        PERFORM 0520-ERENDT-STARTBR
  5502                                 THRU 0520-EXIT
  5503        PERFORM 0510-ERENDT-READNEXT
  5504                                 THRU 0510-EXIT
  5505        IF ERENDT-KEY = PI-PREV-ERENDT-KEY
  5506            PERFORM 0510-ERENDT-READNEXT
  5507                                 THRU 0510-EXIT
  5508        END-IF
  5509        IF (RESP-NORMAL) AND
  5510         (PI-ERENDT-KEY (1:34) = EN-CONTROL-PRIMARY (1:34))
  5511           PERFORM 0390-BUILD-FROM-ERENDT
  5512                                 THRU 0390-EXIT
  5513           MOVE ER-0000          TO EMI-ERROR
  5514           PERFORM 9900-ERROR-FORMAT
  5515                                 THRU 9900-EXIT
  5516           GO TO 8100-SEND-INITIAL-MAP
  5517        ELSE
  5518           MOVE ER-2237          TO EMI-ERROR
  5519           MOVE -1               TO CARRL
  5520           PERFORM 9900-ERROR-FORMAT
  5521                                 THRU 9900-EXIT
  5522           GO TO 8200-SEND-DATAONLY
  5523        END-IF
  5524     END-IF
  5525     IF EIBAID = DFHPF2
  5526        MOVE PI-ERENDT-KEY       TO ERENDT-KEY
  5527        PERFORM 0520-ERENDT-STARTBR
  5528                                 THRU 0520-EXIT
  5529        PERFORM 0510-ERENDT-READNEXT
  5530                                 THRU 0510-EXIT
  5531        PERFORM 0530-ERENDT-READPREV
  5532                                 THRU 0530-EXIT
  5533        PERFORM 0530-ERENDT-READPREV
  5534                                 THRU 0530-EXIT
  5535        IF (RESP-NORMAL) AND
  5536         (PI-ERENDT-KEY (1:34) = EN-CONTROL-PRIMARY (1:34))
  5537           PERFORM 0390-BUILD-FROM-ERENDT
  5538                                 THRU 0390-EXIT
  5539           MOVE ER-0000          TO EMI-ERROR
  5540           PERFORM 9900-ERROR-FORMAT
  5541                                 THRU 9900-EXIT
  5542           GO TO 8100-SEND-INITIAL-MAP
  5543        ELSE
  5544           GO TO 0350-DISPLAY-COMMON-DATA
  5545           MOVE ER-2238          TO EMI-ERROR
  5546           PERFORM 9900-ERROR-FORMAT
  5547                                 THRU 9900-EXIT
  5548           MOVE -1               TO CARRL
  5549           GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  98
* EL6316.cbl
  5550        END-IF
  5551     END-IF
  5552     IF EIBAID = DFHPF3
  5553        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5554        PERFORM 0600-CREATE-TEMP-STORAGE
  5555                                 THRU 0600-EXIT
  5556        MOVE 'EL614'             TO PGM-NAME
  5557        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5558        MOVE +1                  TO S2
  5559        PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5560           IF REACD-IN (S1) NOT = SPACES AND LOW-VALUES
  5561              MOVE REACD-IN (S1) TO PI-PROGRAM-WORK-AREA (S2:4)
  5562              ADD +5 TO S2
  5563           END-IF
  5564        END-PERFORM
  5565        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5566        GO TO 9300-XCTL
  5567     END-IF
  5568     IF EIBAID = DFHPF4 OR DFHPF8
  5569        GO TO 1000-FINALIZE
  5570     END-IF
  5571     IF EIBAID = DFHPF23
  5572        IF PI-CLEAR-ERROR
  5573           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5574           MOVE ER-3833           TO EMI-ERROR
  5575           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5576           GO TO 0350-DISPLAY-COMMON-DATA
  5577        ELSE
  5578           GO TO 8810-PF23
  5579        END-IF
  5580     END-IF
  5581     IF EIBAID = DFHPF24
  5582        IF PI-CLEAR-ERROR
  5583           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5584           MOVE ER-3833           TO EMI-ERROR
  5585           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5586           GO TO 0350-DISPLAY-COMMON-DATA
  5587        ELSE
  5588           GO TO 9200-RETURN-MAIN-MENU
  5589        END-IF
  5590     END-IF
  5591     IF EIBAID = DFHPF12
  5592        GO TO 9500-PF12
  5593     END-IF
  5594     IF EIBAID = DFHENTER
  5595        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5596        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5597        IF EMI-NO-ERRORS
  5598           GO TO 0350-DISPLAY-COMMON-DATA
  5599        ELSE
  5600           GO TO 8200-SEND-DATAONLY
  5601        END-IF
  5602     END-IF
  5603     MOVE ER-0029                TO EMI-ERROR
  5604     .
  5605 0320-INPUT-ERROR.
  5606     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5607     MOVE AL-UNBON               TO PFENTRA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page  99
* EL6316.cbl
  5608     MOVE -1                     TO PFENTRL
  5609     GO TO 8200-SEND-DATAONLY
  5610     .
  5611 0325-EDIT-SCREEN.
  5612     IF PRTSWL > ZEROS
  5613        IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5614*          move prtswi to w-prtsw
  5615*          MOVE AL-UANON         TO PRTSWA
  5616*          IF PRTSWI = ' '
  5617              MOVE 'P'         TO PRTSWI
  5618*          END-IF
  5619*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5620        END-IF
  5621     END-IF
  5622     IF LTRIDL > ZEROS
  5623        AND LTRIDI > SPACES
  5624        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5625        MOVE LTRIDI              TO LETR-LETTER-ID
  5626                                    PI-LTRID-ENTERED
  5627        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5628        MOVE SPACES              TO LETR-FILLER
  5629        MOVE 0                   TO LETR-SEQ-NO
  5630        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5631     ELSE
  5632        MOVE ER-1236          TO EMI-ERROR
  5633        MOVE -1               TO LTRIDL
  5634        MOVE AL-UABON         TO LTRIDA
  5635        PERFORM 9900-ERROR-FORMAT
  5636                                 THRU 9900-EXIT
  5637     END-IF
  5638
  5639     IF W-PROMPT-LETTER EQUAL 'Y'
  5640         MOVE ER-0894            TO EMI-ERROR
  5641         MOVE -1                 TO LTRIDL
  5642         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5643     END-IF
  5644     SET REASONS-NOT-FOUND TO TRUE
  5645     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5646        IF REACDL (S1) = +4 OR
  5647          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5648              MOVE AL-SANON     TO REACDA (S1)
  5649              SET REASONS-FOUND TO TRUE
  5650        END-IF
  5651     END-PERFORM
  5652
  5653     IF REASONS-NOT-FOUND
  5654        MOVE ER-1820             TO EMI-ERROR
  5655        MOVE -1                  TO PFENTRL
  5656        PERFORM 9900-ERROR-FORMAT
  5657                                 THRU 9900-EXIT
  5658     ELSE
  5659        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5660     END-IF
  5661
  5662     IF CRTNT1L > ZEROS
  5663        IF CRTNT1I > SPACES
  5664           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5665        END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 100
* EL6316.cbl
  5666     END-IF
  5667
  5668     IF CRTNT2L > ZEROS
  5669        IF CRTNT2I > SPACES
  5670           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5671        END-IF
  5672     END-IF
  5673
  5674     IF BILNT1L > ZEROS
  5675        IF BILNT1I > SPACES
  5676           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  5677        END-IF
  5678     END-IF
  5679
  5680     .
  5681 0325-EXIT.
  5682     EXIT.
  5683
  5684 0326-GET-Z-RECORD.
  5685
  5686     MOVE SPACES  TO W-Z-CONTROL-DATA
  5687
  5688
  5689* EXEC CICS STARTBR
  5690*         DATASET    ('ELLETR')
  5691*         RIDFLD     (ELLETR-KEY)
  5692*         GTEQ
  5693*         RESP      (WS-RESPONSE)
  5694*    END-EXEC.
  5695     MOVE 'ELLETR' TO DFHEIV1
  5696     MOVE 0
  5697       TO DFHEIV11
  5698*    MOVE '&,         G          &  N#00005668' TO DFHEIV0
  5699     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5700     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5701     MOVE X'204E233030303035363638' TO DFHEIV0(25:11)
  5702     CALL 'kxdfhei1' USING DFHEIV0,
  5703           DFHEIV1,
  5704           ELLETR-KEY,
  5705           DFHEIV99,
  5706           DFHEIV11,
  5707           DFHEIV99
  5708     MOVE EIBRESP  TO WS-RESPONSE
  5709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5710
  5711     IF NOT RESP-NORMAL
  5712         MOVE ER-1236          TO EMI-ERROR
  5713         MOVE -1               TO LTRIDL
  5714         MOVE AL-UABON         TO LTRIDA
  5715         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5716         GO TO 0326-ENDBR
  5717     END-IF.
  5718
  5719 0326-READNEXT.
  5720
  5721
  5722* EXEC CICS READNEXT
  5723*        DATASET   ('ELLETR')
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 101
* EL6316.cbl
  5724*        INTO      (TEXT-FILES)
  5725*        RIDFLD    (ELLETR-KEY)
  5726*        RESP      (WS-RESPONSE)
  5727*    END-EXEC
  5728     MOVE LENGTH OF
  5729      TEXT-FILES
  5730       TO DFHEIV12
  5731     MOVE 'ELLETR' TO DFHEIV1
  5732     MOVE 0
  5733       TO DFHEIV11
  5734*    MOVE '&.IL                  )  N#00005684' TO DFHEIV0
  5735     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5736     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5737     MOVE X'204E233030303035363834' TO DFHEIV0(25:11)
  5738     CALL 'kxdfhei1' USING DFHEIV0,
  5739           DFHEIV1,
  5740           TEXT-FILES,
  5741           DFHEIV12,
  5742           ELLETR-KEY,
  5743           DFHEIV99,
  5744           DFHEIV11,
  5745           DFHEIV99,
  5746           DFHEIV99
  5747     MOVE EIBRESP  TO WS-RESPONSE
  5748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5749     IF RESP-NORMAL
  5750        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  5751           MOVE ER-1236          TO EMI-ERROR
  5752           MOVE -1               TO LTRIDL
  5753           MOVE AL-UABON         TO LTRIDA
  5754           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5755           GO TO 0326-ENDBR
  5756        END-IF
  5757
  5758        MOVE AL-UANON         TO LTRIDA
  5759        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  5760           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  5761        ELSE
  5762           GO TO 0326-READNEXT
  5763        END-IF
  5764     ELSE
  5765        MOVE ER-1236          TO EMI-ERROR
  5766        MOVE -1               TO LTRIDL
  5767        MOVE AL-UABON         TO LTRIDA
  5768        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5769        GO TO 0326-ENDBR
  5770     END-IF.
  5771
  5772 0326-ENDBR.
  5773
  5774
  5775* EXEC CICS ENDBR
  5776*        DATASET     ('ELLETR')
  5777*    END-EXEC.
  5778     MOVE 'ELLETR' TO DFHEIV1
  5779     MOVE 0
  5780       TO DFHEIV11
  5781*    MOVE '&2                    $   #00005715' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 102
* EL6316.cbl
  5782     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5783     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5784     MOVE X'2020233030303035373135' TO DFHEIV0(25:11)
  5785     CALL 'kxdfhei1' USING DFHEIV0,
  5786           DFHEIV1,
  5787           DFHEIV11,
  5788           DFHEIV99
  5789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5790
  5791
  5792 0326-EXIT.
  5793      EXIT.
  5794 0350-DISPLAY-COMMON-DATA.
  5795     display ' made it to 0350 '
  5796     PERFORM 0360-CHECK-PENDING THRU 0360-EXIT
  5797     IF PI-LTRID-ENTERED > SPACES
  5798        MOVE PI-LTRID-ENTERED    TO LTRIDI
  5799        MOVE AL-UANON            TO LTRIDA
  5800        MOVE +4                  TO LTRIDL
  5801     ELSE
  5802        IF PI-CLM-RESCISSION
  5803            MOVE 'CLRC'          TO LTRIDI
  5804                                    PI-LTRID-ENTERED
  5805            MOVE +4              TO LTRIDL
  5806            MOVE AL-UANON        TO LTRIDA
  5807        END-IF
  5808     END-IF
  5809
  5810     SET REASONS-NOT-FOUND TO TRUE
  5811     MOVE PI-REASONS-ENTERED     TO REASONCDS
  5812     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5813        IF REACDL (S1) = +4 OR
  5814          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5815              MOVE AL-SANON      TO REACDA (S1)
  5816              MOVE +4            TO REACDL (S1)
  5817              SET REASONS-FOUND  TO TRUE
  5818        END-IF
  5819     END-PERFORM
  5820
  5821     IF REASONS-NOT-FOUND
  5822         IF PI-CLM-RESCISSION
  5823            MOVE 'CRNA'          TO REACD-IN (1)
  5824            MOVE AL-SANON        TO REACDA (1)
  5825            MOVE +4              TO REACDL (1)
  5826            SET REASONS-FOUND    TO TRUE
  5827        END-IF
  5828     END-IF
  5829
  5830     IF PI-CERTNT1-ENTERED > SPACES
  5831        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  5832        MOVE AL-UANON            TO CRTNT1A
  5833        MOVE +63                 TO CRTNT1L
  5834     END-IF
  5835
  5836     IF PI-CERTNT2-ENTERED > SPACES
  5837        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  5838        MOVE AL-UANON            TO CRTNT2A
  5839        MOVE +63                 TO CRTNT2L
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 103
* EL6316.cbl
  5840     END-IF
  5841
  5842     IF PI-BILLNT1-ENTERED > SPACES
  5843        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  5844        MOVE AL-UANON            TO BILNT1A
  5845        MOVE +63                 TO BILNT1L
  5846     END-IF
  5847     GO TO 8100-SEND-INITIAL-MAP
  5848     .
  5849 0350-EXIT.
  5850     EXIT.
  5851 0360-CHECK-PENDING.
  5852     display ' made it to 0360 '
  5853     MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  5854     MOVE PI-CARRIER             TO CRTO-CARRIER
  5855     MOVE PI-GROUPING            TO CRTO-GROUPING
  5856     MOVE PI-STATE               TO CRTO-STATE
  5857     MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  5858     MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  5859     MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  5860     MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  5861     MOVE 'I'                    TO CRTO-RECORD-TYPE
  5862     MOVE ZEROS                  TO CRTO-SEQ-NO
  5863     MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  5864     MOVE ELCRTO-KEY (1:33)      TO PI-ERENDT-KEY (1:33)
  5865     MOVE 'C'                    TO PI-ENDT-RECORD-TYPE
  5866     MOVE ZEROS                  TO PI-ENDT-SEQ-NO
  5867     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  5868     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  5869      display 'response ' ws-response
  5870      display 'pi-elcrto-key ' pi-elcrto-key
  5871      display 'oc key ' oc-control-primary
  5872     IF RESP-NORMAL
  5873       IF (PI-ELCRTO-KEY (1:33) =
  5874              OC-CONTROL-PRIMARY (1:33))
  5875          DISPLAY 'CRTO RESP NORMAL '
  5876          MOVE OC-CONTROL-PRIMARY  TO PI-ELCRTO-KEY
  5877          PERFORM 0361-MOVE-CRTO-TO-SCREEN THRU 0361-EXIT
  5878          PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
  5879          IF RESP-NORMAL
  5880             MOVE PB-CONTROL-PRIMARY TO PI-ERPNDB-KEY
  5881             PERFORM 0380-BUILD-FROM-ERPNDB THRU 0380-EXIT
  5882          END-IF
  5883       ELSE
  5884          MOVE ER-3829           TO EMI-ERROR
  5885          PERFORM 9900-ERROR-FORMAT
  5886                                 THRU 9900-EXIT
  5887          MOVE -1                TO CARRL
  5888          GO TO 8100-SEND-INITIAL-MAP
  5889       END-IF
  5890     ELSE
  5891        MOVE ER-3829             TO EMI-ERROR
  5892        PERFORM 9900-ERROR-FORMAT
  5893                                 THRU 9900-EXIT
  5894        MOVE -1                  TO CARRL
  5895        GO TO 8100-SEND-INITIAL-MAP
  5896     END-IF
  5897     .
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 104
* EL6316.cbl
  5898 0360-EXIT.
  5899     EXIT.
  5900 0361-MOVE-CRTO-TO-SCREEN.
  5901     display ' made it to 0361 '
  5902     MOVE OC-LF-CANCEL-DT          TO DC-BIN-DATE-1
  5903     MOVE ' '                      TO DC-OPTION-CODE
  5904     PERFORM 9700-DATE-LINK
  5905     IF NO-CONVERSION-ERROR
  5906        MOVE DC-GREG-DATE-1-EDIT   TO OLFDTO
  5907     END-IF
  5908     MOVE OC-AH-CANCEL-DT          TO DC-BIN-DATE-1
  5909     MOVE ' '                      TO DC-OPTION-CODE
  5910     PERFORM 9700-DATE-LINK
  5911     IF NO-CONVERSION-ERROR
  5912        MOVE DC-GREG-DATE-1-EDIT   TO OAHDTO
  5913     END-IF
  5914     MOVE OC-LF-CANCEL-AMT         TO OLFAMTO
  5915     MOVE OC-AH-CANCEL-AMT         TO OAHAMTO
  5916     .
  5917 0361-EXIT.
  5918     EXIT.
  5919 0362-READ-ELCRTO.
  5920     display ' made it to 0362 '
  5921
  5922* EXEC CICS READ
  5923*        DATASET   (WS-ELCRTO-FILE-ID)
  5924*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  5925*        RIDFLD    (ELCRTO-KEY)
  5926*        GTEQ
  5927*        RESP      (WS-RESPONSE)
  5928*    END-EXEC
  5929*    MOVE '&"S        G          (  N#00005848' TO DFHEIV0
  5930     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  5931     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5932     MOVE X'204E233030303035383438' TO DFHEIV0(25:11)
  5933     CALL 'kxdfhei1' USING DFHEIV0,
  5934           WS-ELCRTO-FILE-ID,
  5935           DFHEIV20,
  5936           DFHEIV99,
  5937           ELCRTO-KEY,
  5938           DFHEIV99,
  5939           DFHEIV99,
  5940           DFHEIV99
  5941     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  5942         DFHEIV20
  5943     MOVE EIBRESP  TO WS-RESPONSE
  5944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5945     .
  5946 0362-EXIT.
  5947     EXIT.
  5948 0363-READ-ELCRTO-UPD.
  5949     display ' made it to 0363 '
  5950
  5951* EXEC CICS READ
  5952*        DATASET   (WS-ELCRTO-FILE-ID)
  5953*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  5954*        RIDFLD    (ELCRTO-KEY)
  5955*        UPDATE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 105
* EL6316.cbl
  5956*        RESP      (WS-RESPONSE)
  5957*    END-EXEC
  5958*    MOVE '&"S        EU         (  N#00005860' TO DFHEIV0
  5959     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5960     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5961     MOVE X'204E233030303035383630' TO DFHEIV0(25:11)
  5962     CALL 'kxdfhei1' USING DFHEIV0,
  5963           WS-ELCRTO-FILE-ID,
  5964           DFHEIV20,
  5965           DFHEIV99,
  5966           ELCRTO-KEY,
  5967           DFHEIV99,
  5968           DFHEIV99,
  5969           DFHEIV99
  5970     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  5971         DFHEIV20
  5972     MOVE EIBRESP  TO WS-RESPONSE
  5973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5974     .
  5975 0363-EXIT.
  5976     EXIT.
  5977
  5978 0364-MOVE-ZERO-TO-SCREEN.
  5979
  5980     MOVE ZEROS    TO OLFDTO
  5981                      OAHDTO
  5982                      OLFAMTO
  5983                      OAHAMTO.
  5984
  5985 0364-EXIT.
  5986     EXIT.
  5987
  5988 0365-READ-ERENDT.
  5989
  5990* EXEC CICS READ
  5991*        DATASET   (WS-ERENDT-FILE-ID)
  5992*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  5993*        RIDFLD    (ERENDT-KEY)
  5994*        RESP      (WS-RESPONSE)
  5995*    END-EXEC
  5996*    MOVE '&"S        E          (  N#00005882' TO DFHEIV0
  5997     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5998     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5999     MOVE X'204E233030303035383832' TO DFHEIV0(25:11)
  6000     CALL 'kxdfhei1' USING DFHEIV0,
  6001           WS-ERENDT-FILE-ID,
  6002           DFHEIV20,
  6003           DFHEIV99,
  6004           ERENDT-KEY,
  6005           DFHEIV99,
  6006           DFHEIV99,
  6007           DFHEIV99
  6008     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6009         DFHEIV20
  6010     MOVE EIBRESP  TO WS-RESPONSE
  6011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6012     .
  6013 0365-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 106
* EL6316.cbl
  6014     EXIT.
  6015 0370-READ-ERPNDB.
  6016     display ' made it to 0370 '
  6017     MOVE PI-COMPANY-CD          TO PNDB2-COMPANY-CD
  6018     MOVE PI-CRTO-CARRIER        TO PNDB2-CARRIER
  6019     MOVE PI-CRTO-GROUPING       TO PNDB2-GROUPING
  6020     MOVE PI-CRTO-STATE          TO PNDB2-STATE
  6021     MOVE PI-CRTO-ACCOUNT        TO PNDB2-ACCOUNT
  6022     MOVE PI-CRTO-CERT-PRIME     TO PNDB2-CERT-PRIME
  6023     MOVE PI-CRTO-CERT-SFX       TO PNDB2-CERT-SFX
  6024     MOVE PI-CRTO-CERT-EFF-DT    TO PNDB2-CERT-EFF-DT
  6025     MOVE +0                     TO PNDB2-CHG-SEQ-NO
  6026     MOVE '2'                    TO PNDB2-RECORD-TYPE
  6027
  6028* EXEC CICS READ
  6029*        DATASET   (WS-ERPNDB2-FILE-ID)
  6030*        SET       (ADDRESS OF PENDING-BUSINESS)
  6031*        RIDFLD    (ERPNDB2-KEY)
  6032*        RESP      (WS-RESPONSE)
  6033*    END-EXEC
  6034*    MOVE '&"S        E          (  N#00005903' TO DFHEIV0
  6035     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6036     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6037     MOVE X'204E233030303035393033' TO DFHEIV0(25:11)
  6038     CALL 'kxdfhei1' USING DFHEIV0,
  6039           WS-ERPNDB2-FILE-ID,
  6040           DFHEIV20,
  6041           DFHEIV99,
  6042           ERPNDB2-KEY,
  6043           DFHEIV99,
  6044           DFHEIV99,
  6045           DFHEIV99
  6046     SET ADDRESS OF PENDING-BUSINESS TO
  6047         DFHEIV20
  6048     MOVE EIBRESP  TO WS-RESPONSE
  6049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6050     .
  6051 0370-EXIT.
  6052     EXIT.
  6053 0380-BUILD-FROM-ERPNDB.
  6054     display ' made it to 0380 '
  6055     MOVE PB-CARRIER             TO CARRO
  6056     MOVE PB-GROUPING            TO GROUPO
  6057     MOVE PB-STATE               TO STATEO
  6058     MOVE PB-ACCOUNT             TO ACCTO
  6059     MOVE PB-CERT-PRIME          TO CERTNOO
  6060     MOVE PB-CERT-SFX            TO CRTSFXO
  6061     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  6062     MOVE ' '                    TO DC-OPTION-CODE
  6063     PERFORM 9700-DATE-LINK
  6064     IF NO-CONVERSION-ERROR
  6065        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6066     END-IF
  6067     MOVE PB-CI-LAST-NAME        TO LNAMEO
  6068     MOVE PB-CI-FIRST-NAME       TO FNAMEO
  6069     MOVE PB-CI-INITIALS (2:1)   TO MINITO
  6070     MOVE PB-C-LF-CANCEL-DT        TO DC-BIN-DATE-1
  6071     MOVE ' '                      TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 107
* EL6316.cbl
  6072     PERFORM 9700-DATE-LINK
  6073     IF NO-CONVERSION-ERROR
  6074        MOVE DC-GREG-DATE-1-EDIT   TO NLFDTO
  6075     END-IF
  6076     MOVE PB-C-AH-CANCEL-DT        TO DC-BIN-DATE-1
  6077     MOVE ' '                      TO DC-OPTION-CODE
  6078     PERFORM 9700-DATE-LINK
  6079     IF NO-CONVERSION-ERROR
  6080        MOVE DC-GREG-DATE-1-EDIT   TO NAHDTO
  6081     END-IF
  6082     MOVE PB-C-LF-CANCEL-AMT       TO NLFAMTO
  6083     MOVE PB-C-AH-CANCEL-AMT       TO NAHAMTO
  6084     IF PB-CI-LIFE-COMMISSION NOT = ZEROS
  6085        MOVE PB-CI-LIFE-COMMISSION
  6086                              TO LFCOMMO
  6087*       MOVE AL-UNNON         TO LFCOMMA
  6088     END-IF
  6089     IF PB-CI-AH-COMMISSION NOT = ZEROS
  6090        MOVE PB-CI-AH-COMMISSION
  6091                              TO AHCOMMO
  6092*       MOVE AL-UNNON         TO AHCOMMA
  6093     END-IF
  6094     MOVE ER-2785                TO EMI-ERROR
  6095     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  6096     .
  6097 0380-EXIT.
  6098     EXIT.
  6099 0390-BUILD-FROM-ERENDT.
  6100     MOVE LOW-VALUES             TO EL631II
  6101*    move PI-PRTSW-ENTERED       to prtswo
  6102     IF PI-CERTNT1-ENTERED > SPACES
  6103        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6104        MOVE AL-UANON            TO CRTNT1A
  6105        MOVE +63                 TO CRTNT1L
  6106     END-IF
  6107
  6108     IF PI-CERTNT2-ENTERED > SPACES
  6109        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6110        MOVE AL-UANON            TO CRTNT2A
  6111        MOVE +63                 TO CRTNT2L
  6112     END-IF
  6113
  6114     IF PI-BILLNT1-ENTERED > SPACES
  6115        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6116        MOVE AL-UANON            TO BILNT1A
  6117        MOVE +63                 TO BILNT1L
  6118     END-IF
  6119
  6120     MOVE PI-COMPANY-CD          TO PI-ENDT-COMPANY-CD
  6121     MOVE EN-CARRIER             TO PI-ENDT-CARRIER
  6122     MOVE EN-GROUPING            TO PI-ENDT-GROUPING
  6123     MOVE EN-STATE               TO PI-ENDT-STATE
  6124     MOVE EN-ACCOUNT             TO PI-ENDT-ACCOUNT
  6125     MOVE EN-CERT-PRIME          TO PI-ENDT-CERT-PRIME
  6126     MOVE EN-CERT-SFX            TO PI-ENDT-CERT-SFX
  6127     MOVE EN-CERT-EFF-DT         TO PI-ENDT-CERT-EFF-DT
  6128     MOVE EN-REC-TYPE            TO PI-ENDT-RECORD-TYPE
  6129     MOVE EN-SEQ-NO              TO PI-ENDT-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 108
* EL6316.cbl
  6130     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  6131     MOVE EN-CARRIER             TO CARRO
  6132     MOVE EN-GROUPING            TO GROUPO
  6133     MOVE EN-STATE               TO STATEO
  6134     MOVE EN-ACCOUNT             TO ACCTO
  6135     MOVE EN-CERT-PRIME          TO CERTNOO
  6136     MOVE EN-CERT-SFX            TO CRTSFXO
  6137     MOVE EN-SEQ-NO              TO SEQNOO
  6138     MOVE EN-TEMPLATE-USED       TO LTRIDO
  6139     PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
  6140     MOVE PB-CI-LAST-NAME        TO LNAMEO
  6141     MOVE PB-CI-FIRST-NAME       TO FNAMEO
  6142     MOVE PB-CI-INITIALS (2:1)   TO MINITO
  6143     IF PB-CI-LIFE-COMMISSION NOT = ZEROS
  6144        MOVE PB-CI-LIFE-COMMISSION TO LFCOMMO
  6145     END-IF
  6146     IF PB-CI-AH-COMMISSION NOT = ZEROS
  6147        MOVE PB-CI-AH-COMMISSION TO AHCOMMO
  6148     END-IF
  6149     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6150        IF EN-REASON-CODE (S1) NOT = SPACES
  6151           MOVE EN-REASON-CODE (S1) TO REACD-IN (S1)
  6152           MOVE AL-SANON         TO REACDA (S1)
  6153           MOVE +4               TO REACDL (S1)
  6154        END-IF
  6155     END-PERFORM
  6156     MOVE EN-CERT-EFF-DT         TO DC-BIN-DATE-1
  6157     MOVE ' '                    TO DC-OPTION-CODE
  6158     PERFORM 9700-DATE-LINK
  6159     IF NO-CONVERSION-ERROR
  6160        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6161     END-IF
  6162     IF EN-PROCESS-DT NOT = SPACES AND LOW-VALUES
  6163        MOVE EN-PROCESS-DT       TO DC-BIN-DATE-1
  6164        MOVE ' '                 TO DC-OPTION-CODE
  6165        PERFORM 9700-DATE-LINK
  6166        IF NO-CONVERSION-ERROR
  6167           MOVE DC-GREG-DATE-1-EDIT
  6168                                 TO PROCDTO
  6169        END-IF
  6170     END-IF
  6171     IF EN-INPUT-DT NOT = SPACES AND LOW-VALUES
  6172        MOVE EN-INPUT-DT         TO DC-BIN-DATE-1
  6173        MOVE ' '                 TO DC-OPTION-CODE
  6174        PERFORM 9700-DATE-LINK
  6175        IF NO-CONVERSION-ERROR
  6176           MOVE DC-GREG-DATE-1-EDIT
  6177                                 TO INPDTO
  6178        END-IF
  6179     END-IF
  6180     MOVE EN-LF-ORIG-REF-DT        TO DC-BIN-DATE-1
  6181     MOVE ' '                      TO DC-OPTION-CODE
  6182     PERFORM 9700-DATE-LINK
  6183     IF NO-CONVERSION-ERROR
  6184        MOVE DC-GREG-DATE-1-EDIT   TO OLFDTO
  6185     END-IF
  6186     MOVE EN-LF-ORIG-REF-AMT       TO OLFAMTO
  6187     MOVE EN-AH-ORIG-REF-DT        TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 109
* EL6316.cbl
  6188     MOVE ' '                      TO DC-OPTION-CODE
  6189     PERFORM 9700-DATE-LINK
  6190     IF NO-CONVERSION-ERROR
  6191        MOVE DC-GREG-DATE-1-EDIT   TO OAHDTO
  6192     END-IF
  6193     MOVE EN-AH-ORIG-REF-AMT       TO OAHAMTO
  6194     MOVE EN-LF-NEW-REF-DT         TO DC-BIN-DATE-1
  6195     MOVE ' '                      TO DC-OPTION-CODE
  6196     PERFORM 9700-DATE-LINK
  6197     IF NO-CONVERSION-ERROR
  6198        MOVE DC-GREG-DATE-1-EDIT   TO NLFDTO
  6199     END-IF
  6200     MOVE EN-LF-NEW-REF-AMT        TO NLFAMTO
  6201     MOVE EN-AH-NEW-REF-DT         TO DC-BIN-DATE-1
  6202     MOVE ' '                      TO DC-OPTION-CODE
  6203     PERFORM 9700-DATE-LINK
  6204     IF NO-CONVERSION-ERROR
  6205        MOVE DC-GREG-DATE-1-EDIT   TO NAHDTO
  6206     END-IF
  6207     MOVE EN-AH-NEW-REF-AMT        TO NAHAMTO
  6208     MOVE EN-ARCHIVE-NO            TO ARCHNOO
  6209     .
  6210 0390-EXIT.
  6211     EXIT.
  6212 0400-ADD-ERENDT.
  6213     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6214
  6215* EXEC CICS GETMAIN
  6216*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6217*         LENGTH   (ERENDT-LENGTH)
  6218*         INITIMG  (GETMAIN-SPACE)
  6219*    END-EXEC
  6220*    MOVE ',"IL                  $   #00006073' TO DFHEIV0
  6221     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6222     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6223     MOVE X'2020233030303036303733' TO DFHEIV0(25:11)
  6224     CALL 'kxdfhei1' USING DFHEIV0,
  6225           DFHEIV20,
  6226           ERENDT-LENGTH,
  6227           GETMAIN-SPACE
  6228     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6229         DFHEIV20
  6230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6231     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6232     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6233     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6234     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6235                                    EN-INPUT-DT
  6236     MOVE OC-LF-CANCEL-DT        TO EN-LF-ORIG-REF-DT
  6237     MOVE OC-AH-CANCEL-DT        TO EN-AH-ORIG-REF-DT
  6238     MOVE OC-LF-CANCEL-AMT       TO EN-LF-ORIG-REF-AMT
  6239     MOVE OC-AH-CANCEL-AMT       TO EN-AH-ORIG-REF-AMT
  6240
  6241     MOVE OC-LF-ITD-CANCEL-AMT   TO NEW-LF-ITD-CANCEL-AMT
  6242     MOVE OC-AH-ITD-CANCEL-AMT   TO NEW-AH-ITD-CANCEL-AMT
  6243
  6244     MOVE OC-INS-LAST-NAME       TO EN-INS-LAST-NAME
  6245     MOVE OC-INS-FIRST-NAME      TO EN-INS-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 110
* EL6316.cbl
  6246     MOVE OC-INS-MIDDLE-INIT     TO EN-INS-MIDDLE-INIT
  6247
  6248     MOVE OC-LF-COMM-PCT         TO EN-LF-ORIG-REF-COMM-PCT
  6249     MOVE OC-AH-COMM-PCT         TO EN-AH-ORIG-REF-COMM-PCT
  6250
  6251* EXEC CICS READ
  6252*        DATASET   (WS-ERPNDB-FILE-ID)
  6253*        SET       (ADDRESS OF PENDING-BUSINESS)
  6254*        RIDFLD    (PI-ERPNDB-KEY)
  6255*        RESP      (WS-RESPONSE)
  6256*    END-EXEC
  6257*    MOVE '&"S        E          (  N#00006097' TO DFHEIV0
  6258     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6259     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6260     MOVE X'204E233030303036303937' TO DFHEIV0(25:11)
  6261     CALL 'kxdfhei1' USING DFHEIV0,
  6262           WS-ERPNDB-FILE-ID,
  6263           DFHEIV20,
  6264           DFHEIV99,
  6265           PI-ERPNDB-KEY,
  6266           DFHEIV99,
  6267           DFHEIV99,
  6268           DFHEIV99
  6269     SET ADDRESS OF PENDING-BUSINESS TO
  6270         DFHEIV20
  6271     MOVE EIBRESP  TO WS-RESPONSE
  6272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6273     IF NOT RESP-NORMAL
  6274        GO TO 0400-EXIT
  6275     END-IF
  6276     MOVE PB-C-LF-CANCEL-DT      TO EN-LF-NEW-REF-DT
  6277                                    NEW-LF-CANCEL-DT
  6278     MOVE PB-C-AH-CANCEL-DT      TO EN-AH-NEW-REF-DT
  6279                                    NEW-AH-CANCEL-DT
  6280     MOVE PB-C-LF-CANCEL-AMT     TO EN-LF-NEW-REF-AMT
  6281                                    NEW-LF-CANCEL-AMT
  6282     MOVE PB-C-AH-CANCEL-AMT     TO EN-AH-NEW-REF-AMT
  6283                                    NEW-AH-CANCEL-AMT
  6284     MOVE PB-CI-LIFE-COMMISSION  TO EN-LF-COMMISSION
  6285                                    EN-LF-NEW-REF-COMM-PCT
  6286                                    NEW-LF-COMM-PCT
  6287     MOVE PB-CI-AH-COMMISSION    TO EN-AH-COMMISSION
  6288                                    EN-AH-NEW-REF-COMM-PCT
  6289                                    NEW-AH-COMM-PCT
  6290     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6291     MOVE 'C'                    TO EN-DOCU-TYPE
  6292     MOVE 'Y'                    TO EN-MONEY-SW
  6293     MOVE PB-ENTRY-BATCH         TO EN-BATCH-NUMBER
  6294     MOVE W-ACCT-SUMM            TO EN-ACCT-SUMM
  6295     MOVE W-CSO-SUMM             TO EN-CSO-SUMM
  6296     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6297        IF REACD-IN (S1) NOT = LOW-VALUES
  6298           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6299        END-IF
  6300     END-PERFORM
  6301     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6302
  6303     IF ACCT-FOUND
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 111
* EL6316.cbl
  6304        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  6305        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
  6306        IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  6307           MOVE PB-C-LF-CANCEL-DT
  6308                                 TO DC-BIN-DATE-2
  6309        END-IF
  6310        MOVE '1'                 TO DC-OPTION-CODE
  6311        PERFORM 9700-DATE-LINK
  6312        IF NO-CONVERSION-ERROR
  6313           MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  6314           IF DC-ODD-DAYS-OVER > +1
  6315              ADD +1          TO WS-DIFF
  6316           END-IF
  6317        ELSE
  6318            MOVE +0           TO WS-DIFF
  6319        END-IF
  6320     ELSE
  6321        MOVE +0           TO WS-DIFF
  6322     END-IF
  6323
  6324     COMPUTE WS-DUE-BORROWER = (EN-LF-NEW-REF-AMT
  6325         + EN-AH-NEW-REF-AMT)
  6326
  6327     IF (WS-CHGBACK = 99)
  6328         OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  6329          MOVE WS-DUE-BORROWER TO EN-CSO-PORTION
  6330          MOVE ZEROS           TO EN-ACCT-PORTION
  6331          MOVE 'N'             TO EN-COMM-CHGBK
  6332     ELSE
  6333         COMPUTE EN-ACCT-PORTION = (EN-LF-NEW-REF-AMT
  6334                 * EN-LF-COMMISSION) +
  6335                (EN-AH-NEW-REF-AMT * EN-AH-COMMISSION)
  6336         COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER
  6337                 - EN-ACCT-PORTION
  6338         MOVE 'Y'                TO EN-COMM-CHGBK
  6339     END-IF
  6340     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6341     .
  6342 0400-EXIT.
  6343     EXIT.
  6344 0410-INIT-ERENDT.
  6345     MOVE OC-CONTROL-PRIMARY (1:33) TO ERENDT-KEY (1:33)
  6346     MOVE 'C'                    TO ENDT-RECORD-TYPE
  6347     MOVE ZEROS                  TO ENDT-SEQ-NO
  6348
  6349* EXEC CICS READ
  6350*        DATASET    (WS-ERENDT-FILE-ID)
  6351*        RIDFLD     (ERENDT-KEY)
  6352*        SET        (ADDRESS OF ENDORSEMENT-RECORD)
  6353*        RESP       (WS-RESPONSE)
  6354*        GTEQ
  6355*    END-EXEC
  6356*    MOVE '&"S        G          (  N#00006178' TO DFHEIV0
  6357     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6358     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6359     MOVE X'204E233030303036313738' TO DFHEIV0(25:11)
  6360     CALL 'kxdfhei1' USING DFHEIV0,
  6361           WS-ERENDT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 112
* EL6316.cbl
  6362           DFHEIV20,
  6363           DFHEIV99,
  6364           ERENDT-KEY,
  6365           DFHEIV99,
  6366           DFHEIV99,
  6367           DFHEIV99
  6368     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6369         DFHEIV20
  6370     MOVE EIBRESP  TO WS-RESPONSE
  6371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6372     IF RESP-NORMAL
  6373        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
  6374        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6375     ELSE
  6376        MOVE +4096               TO WS-SEQ-NO
  6377     END-IF
  6378     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6379     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6380     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6381     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6382     MOVE WS-CURRENT-BIN-DT      TO EN-PROCESS-DT
  6383     MOVE 'C'                    TO EN-REC-TYPE
  6384     INITIALIZE EN-CANCEL-RECORD
  6385     MOVE ZEROS TO EN-CSO-PORTION EN-ACCT-PORTION
  6386     MOVE LOW-VALUES             TO EN-LF-ORIG-REF-DT
  6387                                    EN-AH-ORIG-REF-DT
  6388                                    EN-LF-NEW-REF-DT
  6389                                    EN-AH-NEW-REF-DT
  6390     .
  6391 0410-EXIT.
  6392     EXIT.
  6393 0420-UPDATE-ELCRTO.
  6394     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6395     IF RESP-NORMAL
  6396        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6397                                    OC-LAST-MAINT-DT
  6398        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6399        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6400
  6401* EXEC CICS REWRITE
  6402*          FROM     (ORIGINAL-CERTIFICATE)
  6403*          DATASET  ('ELCRTO')
  6404*       END-EXEC
  6405     MOVE LENGTH OF
  6406      ORIGINAL-CERTIFICATE
  6407       TO DFHEIV11
  6408     MOVE 'ELCRTO' TO DFHEIV1
  6409*    MOVE '&& L                  %   #00006213' TO DFHEIV0
  6410     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6411     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6412     MOVE X'2020233030303036323133' TO DFHEIV0(25:11)
  6413     CALL 'kxdfhei1' USING DFHEIV0,
  6414           DFHEIV1,
  6415           ORIGINAL-CERTIFICATE,
  6416           DFHEIV11,
  6417           DFHEIV99
  6418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6419     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 113
* EL6316.cbl
  6420     .
  6421 0420-EXIT.
  6422     EXIT.
  6423
  6424 0425-ADD-NEW-ELCRTO.
  6425     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6426     MOVE 'OC'                   TO OC-RECORD-ID
  6427     MOVE PI-ELCRTO-KEY          TO OC-CONTROL-PRIMARY
  6428     SUBTRACT +1                 FROM OC-KEY-SEQ-NO
  6429     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6430     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6431     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6432     MOVE NEW-INS-FIRST-NAME     TO OC-INS-FIRST-NAME
  6433     MOVE NEW-INS-MIDDLE-INIT    TO OC-INS-MIDDLE-INIT
  6434     MOVE NEW-INS-LAST-NAME      TO OC-INS-LAST-NAME
  6435     MOVE NEW-INS-AGE            TO OC-INS-AGE
  6436     MOVE NEW-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  6437     MOVE NEW-JNT-FIRST-NAME     TO OC-JNT-FIRST-NAME
  6438     MOVE NEW-JNT-MIDDLE-INIT    TO OC-JNT-MIDDLE-INIT
  6439     MOVE NEW-JNT-LAST-NAME      TO OC-JNT-LAST-NAME
  6440     MOVE NEW-JNT-AGE            TO OC-JNT-AGE
  6441     MOVE NEW-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  6442     MOVE NEW-LF-BENCD           TO OC-LF-BENCD
  6443     MOVE NEW-LF-BEN-AMT         TO OC-LF-BEN-AMT
  6444     MOVE NEW-LF-PRM-AMT         TO OC-LF-PRM-AMT
  6445     MOVE NEW-LF-ALT-BEN-AMT     TO OC-LF-ALT-BEN-AMT
  6446     MOVE NEW-LF-ALT-PRM-AMT     TO OC-LF-ALT-PRM-AMT
  6447     MOVE NEW-LF-TERM            TO OC-LF-TERM
  6448     MOVE NEW-LF-EXP-DT          TO OC-LF-EXP-DT
  6449     MOVE NEW-LF-COMM-PCT        TO OC-LF-COMM-PCT
  6450     MOVE NEW-LF-CANCEL-DT       TO OC-LF-CANCEL-DT
  6451     MOVE NEW-LF-CANCEL-AMT      TO OC-LF-CANCEL-AMT
  6452     MOVE NEW-AH-BENCD           TO OC-AH-BENCD
  6453     MOVE NEW-AH-BEN-AMT         TO OC-AH-BEN-AMT
  6454     MOVE NEW-AH-PRM-AMT         TO OC-AH-PRM-AMT
  6455     MOVE NEW-AH-TERM            TO OC-AH-TERM
  6456     MOVE NEW-AH-EXP-DT          TO OC-AH-EXP-DT
  6457     MOVE NEW-AH-CP              TO OC-AH-CP
  6458     MOVE NEW-AH-COMM-PCT        TO OC-AH-COMM-PCT
  6459     MOVE NEW-AH-CANCEL-DT       TO OC-AH-CANCEL-DT
  6460     MOVE NEW-AH-CANCEL-AMT      TO OC-AH-CANCEL-AMT
  6461     MOVE NEW-CRED-BENE-NAME     TO OC-CRED-BENE-NAME
  6462     MOVE NEW-1ST-PMT-DT         TO OC-1ST-PMT-DT
  6463     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6464     .
  6465 0425-WRITE-ELCRTO.
  6466
  6467
  6468* EXEC CICS WRITE
  6469*       DATASET   ('ELCRTO')
  6470*       FROM      (ORIGINAL-CERTIFICATE)
  6471*       RIDFLD    (OC-CONTROL-PRIMARY)
  6472*       RESP      (WS-RESPONSE)
  6473*    END-EXEC
  6474     MOVE LENGTH OF
  6475      ORIGINAL-CERTIFICATE
  6476       TO DFHEIV11
  6477     MOVE 'ELCRTO' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 114
* EL6316.cbl
  6478*    MOVE '&$ L                  ''  N#00006265' TO DFHEIV0
  6479     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6480     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6481     MOVE X'204E233030303036323635' TO DFHEIV0(25:11)
  6482     CALL 'kxdfhei1' USING DFHEIV0,
  6483           DFHEIV1,
  6484           ORIGINAL-CERTIFICATE,
  6485           DFHEIV11,
  6486           OC-CONTROL-PRIMARY,
  6487           DFHEIV99,
  6488           DFHEIV99
  6489     MOVE EIBRESP  TO WS-RESPONSE
  6490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6491
  6492     display ' just wrote new crto ' ws-response
  6493     IF RESP-DUPKEY
  6494        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6495        GO TO 0425-WRITE-ELCRTO
  6496     ELSE
  6497        IF NOT RESP-NORMAL
  6498           MOVE -1               TO LTRIDL
  6499           MOVE ER-3830          TO EMI-ERROR
  6500           PERFORM 9900-ERROR-FORMAT
  6501                                 THRU 9900-EXIT
  6502        ELSE
  6503           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6504        END-IF
  6505     END-IF
  6506
  6507     .
  6508 0425-EXIT.
  6509     EXIT.
  6510
  6511 0426-ADD-CERT-NOTES.
  6512
  6513     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6514     SET TB-INDX TO 1
  6515
  6516     IF PI-CERTNT1-ENTERED > SPACES
  6517         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6518         MOVE PI-PROCESSOR-ID    TO
  6519                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6520         MOVE EIBTIME            TO
  6521                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6522         MOVE WS-CURRENT-BIN-DT  TO
  6523                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6524         SET TB-INDX UP BY +1
  6525     END-IF
  6526
  6527     IF PI-CERTNT2-ENTERED > SPACES
  6528         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6529         MOVE PI-PROCESSOR-ID    TO
  6530                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6531         MOVE EIBTIME            TO
  6532                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6533         MOVE WS-CURRENT-BIN-DT  TO
  6534                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6535         SET TB-INDX UP BY +1
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 115
* EL6316.cbl
  6536     END-IF
  6537
  6538     IF CERT-NOTE-ENTRIES > SPACES
  6539         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6540         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6541     END-IF
  6542
  6543     IF PI-BILLNT1-ENTERED > SPACES
  6544         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6545         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  6546         MOVE +63 TO WS-LEN
  6547         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6548     END-IF
  6549
  6550     .
  6551 0426-EXIT.
  6552     EXIT.
  6553
  6554 0427-LOAD-CURRENT-CERT-NOTES.
  6555
  6556     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6557     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6558     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6559     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6560     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  6561     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6562     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6563     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6564     MOVE '1'                 TO ERCNOT-REC-TYP
  6565     MOVE +0                  TO ERCNOT-SEQ
  6566     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6567
  6568
  6569* EXEC CICS STARTBR
  6570*         DATASET(WS-ERCNOT-FILE-ID)
  6571*         RIDFLD(ERCNOT-KEY)
  6572*         KEYLENGTH(ERCNOT-START-LENGTH)
  6573*         RESP      (WS-RESPONSE)
  6574*         GENERIC
  6575*         GTEQ
  6576*    END-EXEC.
  6577     MOVE 0
  6578       TO DFHEIV11
  6579*    MOVE '&,   KG    G          &  N#00006348' TO DFHEIV0
  6580     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  6581     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6582     MOVE X'204E233030303036333438' TO DFHEIV0(25:11)
  6583     CALL 'kxdfhei1' USING DFHEIV0,
  6584           WS-ERCNOT-FILE-ID,
  6585           ERCNOT-KEY,
  6586           ERCNOT-START-LENGTH,
  6587           DFHEIV11,
  6588           DFHEIV99
  6589     MOVE EIBRESP  TO WS-RESPONSE
  6590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6591
  6592
  6593     IF NOT RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 116
* EL6316.cbl
  6594        GO TO 0427-ENDBR
  6595     END-IF.
  6596
  6597 0427-LOOP.
  6598
  6599* EXEC CICS READNEXT
  6600*         SET(ADDRESS OF CERT-NOTE-FILE)
  6601*         DATASET(WS-ERCNOT-FILE-ID)
  6602*         RIDFLD(ERCNOT-KEY)
  6603*    END-EXEC.
  6604     MOVE 0
  6605       TO DFHEIV11
  6606*    MOVE '&.S                   )   #00006362' TO DFHEIV0
  6607     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6608     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6609     MOVE X'2020233030303036333632' TO DFHEIV0(25:11)
  6610     CALL 'kxdfhei1' USING DFHEIV0,
  6611           WS-ERCNOT-FILE-ID,
  6612           DFHEIV20,
  6613           DFHEIV99,
  6614           ERCNOT-KEY,
  6615           DFHEIV99,
  6616           DFHEIV11,
  6617           DFHEIV99,
  6618           DFHEIV99
  6619     SET ADDRESS OF CERT-NOTE-FILE TO
  6620         DFHEIV20
  6621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6622
  6623
  6624     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  6625         GO TO 0427-ENDBR
  6626     END-IF.
  6627
  6628     IF (CZ-CARRIER = SV-CARRIER)
  6629        AND (CZ-GROUPING = SV-GROUPING)
  6630        AND (CZ-STATE = SV-STATE)
  6631        AND (CZ-ACCOUNT = SV-ACCOUNT)
  6632        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  6633        AND (CZ-CERT-NO = SV-CERT-NO)
  6634        AND (CZ-RECORD-TYPE = '1')
  6635          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  6636          MOVE CZ-LAST-MAINT-USER TO
  6637                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6638          MOVE CZ-LAST-MAINT-DT TO
  6639                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6640          MOVE CZ-LAST-MAINT-HHMMSS TO
  6641                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6642          SET TB-INDX UP BY 1
  6643          GO TO 0427-LOOP
  6644     END-IF.
  6645
  6646 0427-ENDBR.
  6647
  6648
  6649* EXEC CICS ENDBR
  6650*         DATASET(WS-ERCNOT-FILE-ID)
  6651*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 117
* EL6316.cbl
  6652     MOVE 0
  6653       TO DFHEIV11
  6654*    MOVE '&2                    $   #00006392' TO DFHEIV0
  6655     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6656     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6657     MOVE X'2020233030303036333932' TO DFHEIV0(25:11)
  6658     CALL 'kxdfhei1' USING DFHEIV0,
  6659           WS-ERCNOT-FILE-ID,
  6660           DFHEIV11,
  6661           DFHEIV99
  6662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6663
  6664
  6665     .
  6666 0427-EXIT.
  6667     EXIT.
  6668
  6669 0430-WRITE-ERENDT.
  6670     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  6671     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  6672     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  6673
  6674* EXEC CICS WRITE
  6675*         DATASET   (WS-ERENDT-FILE-ID)
  6676*         FROM      (ENDORSEMENT-RECORD)
  6677*         RIDFLD    (EN-CONTROL-PRIMARY)
  6678*         RESP      (WS-RESPONSE)
  6679*    END-EXEC
  6680     MOVE LENGTH OF
  6681      ENDORSEMENT-RECORD
  6682       TO DFHEIV11
  6683*    MOVE '&$ L                  ''  N#00006404' TO DFHEIV0
  6684     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6685     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6686     MOVE X'204E233030303036343034' TO DFHEIV0(25:11)
  6687     CALL 'kxdfhei1' USING DFHEIV0,
  6688           WS-ERENDT-FILE-ID,
  6689           ENDORSEMENT-RECORD,
  6690           DFHEIV11,
  6691           EN-CONTROL-PRIMARY,
  6692           DFHEIV99,
  6693           DFHEIV99
  6694     MOVE EIBRESP  TO WS-RESPONSE
  6695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6696     IF RESP-NORMAL
  6697        MOVE 'C'                 TO PI-DOCUMENT-PROCESSED
  6698        display ' good write erendt '
  6699        IF EIBAID = DFHPF4
  6700           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  6701           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  6702           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  6703           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  6704        END-IF
  6705     ELSE
  6706        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  6707        MOVE -1                  TO LTRIDL
  6708        MOVE ER-0132             TO EMI-ERROR
  6709        MOVE AL-UABON            TO LTRIDA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 118
* EL6316.cbl
  6710        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6711     END-IF
  6712     .
  6713 0430-EXIT.
  6714     EXIT.
  6715 0440-ADD-BILLING-NOTE.
  6716
  6717* EXEC CICS GETMAIN
  6718*         SET      (ADDRESS OF EOB-CODES)
  6719*         LENGTH   (ELEOBC-LENGTH)
  6720*         INITIMG  (GETMAIN-SPACE)
  6721*    END-EXEC
  6722*    MOVE ',"IL                  $   #00006430' TO DFHEIV0
  6723     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6724     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6725     MOVE X'2020233030303036343330' TO DFHEIV0(25:11)
  6726     CALL 'kxdfhei1' USING DFHEIV0,
  6727           DFHEIV20,
  6728           ELEOBC-LENGTH,
  6729           GETMAIN-SPACE
  6730     SET ADDRESS OF EOB-CODES TO
  6731         DFHEIV20
  6732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6733
  6734     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  6735     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  6736     MOVE '5'                    TO WS-EOBC-REC-TYPE
  6737
  6738
  6739* EXEC CICS STARTBR
  6740*        DATASET   ('ELEOBC')
  6741*        RIDFLD    (WS-ELEOBC-KEY)
  6742*        GTEQ
  6743*        RESP      (WS-RESPONSE)
  6744*    END-EXEC
  6745     MOVE 'ELEOBC' TO DFHEIV1
  6746     MOVE 0
  6747       TO DFHEIV11
  6748*    MOVE '&,         G          &  N#00006440' TO DFHEIV0
  6749     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6750     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6751     MOVE X'204E233030303036343430' TO DFHEIV0(25:11)
  6752     CALL 'kxdfhei1' USING DFHEIV0,
  6753           DFHEIV1,
  6754           WS-ELEOBC-KEY,
  6755           DFHEIV99,
  6756           DFHEIV11,
  6757           DFHEIV99
  6758     MOVE EIBRESP  TO WS-RESPONSE
  6759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6760
  6761     IF NOT RESP-NORMAL
  6762        GO TO 0440-EXIT
  6763     END-IF
  6764      .
  6765 0440-READNEXT-ELEOBC.
  6766
  6767
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 119
* EL6316.cbl
  6768* EXEC CICS READNEXT
  6769*       INTO    (EOB-CODES)
  6770*       DATASET ('ELEOBC')
  6771*       RIDFLD  (WS-ELEOBC-KEY)
  6772*       RESP    (WS-RESPONSE)
  6773*    END-EXEC
  6774     MOVE LENGTH OF
  6775      EOB-CODES
  6776       TO DFHEIV12
  6777     MOVE 'ELEOBC' TO DFHEIV1
  6778     MOVE 0
  6779       TO DFHEIV11
  6780*    MOVE '&.IL                  )  N#00006453' TO DFHEIV0
  6781     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6782     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6783     MOVE X'204E233030303036343533' TO DFHEIV0(25:11)
  6784     CALL 'kxdfhei1' USING DFHEIV0,
  6785           DFHEIV1,
  6786           EOB-CODES,
  6787           DFHEIV12,
  6788           WS-ELEOBC-KEY,
  6789           DFHEIV99,
  6790           DFHEIV11,
  6791           DFHEIV99,
  6792           DFHEIV99
  6793     MOVE EIBRESP  TO WS-RESPONSE
  6794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6795
  6796     IF RESP-NORMAL
  6797         IF EO-RECORD-TYPE NOT = '5'
  6798             GO TO 0440-EXIT
  6799         END-IF
  6800     ELSE
  6801         GO TO 0440-EXIT
  6802     END-IF
  6803
  6804     IF EO-RECORD-TYPE = '5' AND
  6805        EO-EOB-CODE = PI-LTRID-ENTERED
  6806           CONTINUE
  6807     ELSE
  6808         GO TO 0440-READNEXT-ELEOBC
  6809     END-IF
  6810
  6811     MOVE SPACES TO WS-BILLING-NOTE
  6812     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  6813     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  6814     MOVE WS-CURRENT-DT TO WS-BN-DATE
  6815     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  6816     MOVE +25 TO WS-LEN
  6817
  6818     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6819     .
  6820 0440-EXIT.
  6821     EXIT.
  6822
  6823 0441-UPDATE-BILLING-NOTE.
  6824
  6825* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 120
* EL6316.cbl
  6826*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  6827*         LENGTH   (ERNOTE-LENGTH)
  6828*         INITIMG  (GETMAIN-SPACE)
  6829*    END-EXEC
  6830*    MOVE ',"IL                  $   #00006488' TO DFHEIV0
  6831     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6832     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6833     MOVE X'2020233030303036343838' TO DFHEIV0(25:11)
  6834     CALL 'kxdfhei1' USING DFHEIV0,
  6835           DFHEIV20,
  6836           ERNOTE-LENGTH,
  6837           GETMAIN-SPACE
  6838     SET ADDRESS OF CERTIFICATE-NOTE TO
  6839         DFHEIV20
  6840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6841
  6842     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  6843
  6844
  6845* EXEC CICS READ
  6846*       DATASET    (WS-ERNOTE-FILE-ID)
  6847*       RIDFLD     (WS-ERNOTE-KEY)
  6848*       INTO       (CERTIFICATE-NOTE)
  6849*       RESP       (WS-RESPONSE)
  6850*       UPDATE
  6851*    END-EXEC
  6852     MOVE LENGTH OF
  6853      CERTIFICATE-NOTE
  6854       TO DFHEIV11
  6855*    MOVE '&"IL       EU         (  N#00006496' TO DFHEIV0
  6856     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6857     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6858     MOVE X'204E233030303036343936' TO DFHEIV0(25:11)
  6859     CALL 'kxdfhei1' USING DFHEIV0,
  6860           WS-ERNOTE-FILE-ID,
  6861           CERTIFICATE-NOTE,
  6862           DFHEIV11,
  6863           WS-ERNOTE-KEY,
  6864           DFHEIV99,
  6865           DFHEIV99,
  6866           DFHEIV99
  6867     MOVE EIBRESP  TO WS-RESPONSE
  6868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6869
  6870     IF RESP-NORMAL
  6871       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  6872          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  6873       END-IF
  6874       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  6875          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  6876       END-IF
  6877       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  6878           (NOTE-SUB > +10) OR
  6879           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  6880                             WS-BILLING-NOTE (1:WS-LEN))
  6881       END-PERFORM
  6882       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  6883                              WS-BILLING-NOTE (1:WS-LEN)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 121
* EL6316.cbl
  6884
  6885* EXEC CICS UNLOCK
  6886*           DATASET    (WS-ERNOTE-FILE-ID)
  6887*        END-EXEC
  6888*    MOVE '&*                    #   #00006518' TO DFHEIV0
  6889     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  6890     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6891     MOVE X'2020233030303036353138' TO DFHEIV0(25:11)
  6892     CALL 'kxdfhei1' USING DFHEIV0,
  6893           WS-ERNOTE-FILE-ID,
  6894           DFHEIV99
  6895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6896       ELSE
  6897         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  6898           (NOTE-SUB > +10) OR
  6899           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  6900         END-PERFORM
  6901         IF (NOTE-SUB < +11)
  6902           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  6903              NOTE-SUB <= CN-BILLING-END-LINE-NO
  6904                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  6905           ELSE
  6906             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  6907              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  6908                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  6909                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  6910             ELSE
  6911               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  6912                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  6913                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  6914                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  6915               ELSE
  6916                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  6917                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  6918                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  6919                                       CN-BILLING-START-LINE-NO
  6920                 ELSE
  6921                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  6922                 END-IF
  6923               END-IF
  6924             END-IF
  6925           END-IF
  6926           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  6927           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6928           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6929
  6930* EXEC CICS REWRITE
  6931*             DATASET    (WS-ERNOTE-FILE-ID)
  6932*             FROM       (CERTIFICATE-NOTE)
  6933*             RESP       (WS-RESPONSE)
  6934*          END-EXEC
  6935     MOVE LENGTH OF
  6936      CERTIFICATE-NOTE
  6937       TO DFHEIV11
  6938*    MOVE '&& L                  %  N#00006554' TO DFHEIV0
  6939     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6940     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6941     MOVE X'204E233030303036353534' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 122
* EL6316.cbl
  6942     CALL 'kxdfhei1' USING DFHEIV0,
  6943           WS-ERNOTE-FILE-ID,
  6944           CERTIFICATE-NOTE,
  6945           DFHEIV11,
  6946           DFHEIV99
  6947     MOVE EIBRESP  TO WS-RESPONSE
  6948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6949           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  6950         END-IF
  6951       END-IF
  6952     ELSE
  6953        MOVE SPACES              TO CERTIFICATE-NOTE
  6954        MOVE 'CN'                TO CN-RECORD-ID
  6955        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  6956                                     WS-ERNOTE-KEY
  6957        MOVE 01                  TO CN-BILLING-START-LINE-NO
  6958                                    CN-BILLING-END-LINE-NO
  6959        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  6960        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  6961        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6962        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6963
  6964* EXEC CICS WRITE
  6965*          DATASET    (WS-ERNOTE-FILE-ID)
  6966*          FROM       (CERTIFICATE-NOTE)
  6967*          RIDFLD     (WS-ERNOTE-KEY)
  6968*          RESP       (WS-RESPONSE)
  6969*       END-EXEC
  6970     MOVE LENGTH OF
  6971      CERTIFICATE-NOTE
  6972       TO DFHEIV11
  6973*    MOVE '&$ L                  ''  N#00006573' TO DFHEIV0
  6974     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6975     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6976     MOVE X'204E233030303036353733' TO DFHEIV0(25:11)
  6977     CALL 'kxdfhei1' USING DFHEIV0,
  6978           WS-ERNOTE-FILE-ID,
  6979           CERTIFICATE-NOTE,
  6980           DFHEIV11,
  6981           WS-ERNOTE-KEY,
  6982           DFHEIV99,
  6983           DFHEIV99
  6984     MOVE EIBRESP  TO WS-RESPONSE
  6985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6986
  6987        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  6988     END-IF
  6989
  6990     .
  6991 0441-EXIT.
  6992     EXIT.
  6993
  6994
  6995 0442-SQUEEZE-IT-IN.
  6996
  6997     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  6998        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  6999           NOTE-SUB = +10
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 123
* EL6316.cbl
  7000           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7001           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7002             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7003             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7004             MOVE +9 TO NOTE-SUB
  7005           END-IF
  7006        END-PERFORM
  7007     ELSE
  7008        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7009           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7010             UNTIL NOTE-SUB = +1
  7011             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7012             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7013                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7014                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7015                MOVE +2          TO NOTE-SUB
  7016             END-IF
  7017           END-PERFORM
  7018        END-IF
  7019     END-IF
  7020
  7021     .
  7022 0442-EXIT.
  7023     EXIT.
  7024
  7025 0445-CERTIFICATE-UPDATE.
  7026    display 'billing note written, updating cert'
  7027     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7028     IF RESP-NORMAL
  7029        EVALUATE CM-NOTE-SW
  7030           WHEN '2'
  7031           WHEN '3'
  7032           WHEN '6'
  7033           WHEN '7'
  7034              SET NO-CERT-RW     TO TRUE
  7035           WHEN ' '
  7036              MOVE '2'           TO CM-NOTE-SW
  7037           WHEN '1'
  7038              MOVE '3'           TO CM-NOTE-SW
  7039           WHEN '4'
  7040              MOVE '6'           TO CM-NOTE-SW
  7041           WHEN '5'
  7042              MOVE '7'           TO CM-NOTE-SW
  7043        END-EVALUATE
  7044     END-IF
  7045     IF NOT NO-CERT-RW
  7046        PERFORM 1810-REWRITE-ELCERT
  7047                                 THRU 1810-EXIT
  7048     ELSE
  7049
  7050* EXEC CICS UNLOCK
  7051*          DATASET    (WS-ELCERT-FILE-ID)
  7052*       END-EXEC
  7053*    MOVE '&*                    #   #00006642' TO DFHEIV0
  7054     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7055     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7056     MOVE X'2020233030303036363432' TO DFHEIV0(25:11)
  7057     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 124
* EL6316.cbl
  7058           WS-ELCERT-FILE-ID,
  7059           DFHEIV99
  7060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7061     END-IF
  7062
  7063     .
  7064 0445-EXIT.
  7065     EXIT.
  7066
  7067 0450-GET-ERACCT.
  7068     DISPLAY ' MADE IT TO 0450 '
  7069     MOVE ' '                    TO WS-ERACCT-SW
  7070     MOVE ZEROS                  TO WS-CHGBACK
  7071                                    WS-CSO-PORTION
  7072                                    WS-ACCT-PORTION
  7073                                    WS-DIFF
  7074     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7075     IF RESP-NORMAL
  7076        DISPLAY ' GOOD STARTBR '
  7077        PERFORM 0470-READNEXT-ERACCT
  7078                                 THRU 0470-EXIT
  7079     END-IF
  7080     IF RESP-NORMAL
  7081        DISPLAY ' GOOD READNEXT '
  7082        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7083           IF (EN-CERT-EFF-DT < AM-EXPIRATION-DT)
  7084              AND (EN-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  7085              DISPLAY ' SETTING ACCT FOUND TO TRUE '
  7086              SET ACCT-FOUND TO TRUE
  7087           ELSE
  7088              PERFORM 0470-READNEXT-ERACCT
  7089                                 THRU 0470-EXIT
  7090              IF RESP-NORMAL
  7091                 IF AM-CONTROL-PRIMARY (1:20)
  7092                    = EN-CONTROL-PRIMARY (1:20)
  7093                    IF (EN-CERT-EFF-DT < AM-EXPIRATION-DT)
  7094                       AND (EN-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  7095                       DISPLAY ' SETTING ACCT FOUND TO TRUE '
  7096                       SET ACCT-FOUND TO TRUE
  7097                    END-IF
  7098                 END-IF
  7099              END-IF
  7100           END-IF
  7101        END-IF
  7102     END-IF
  7103     IF ACCT-FOUND
  7104        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7105           (AM-COM-TYP (S1) = 'C' OR 'D')
  7106           OR (S1 > +10)
  7107        END-PERFORM
  7108        IF S1 < +11
  7109           MOVE AM-COMM-CHARGEBACK (S1)
  7110                                 TO WS-CHGBACK
  7111        END-IF
  7112     END-IF
  7113
  7114* EXEC CICS ENDBR
  7115*        DATASET     ('ERACCT')
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 125
* EL6316.cbl
  7116*    END-EXEC.
  7117     MOVE 'ERACCT' TO DFHEIV1
  7118     MOVE 0
  7119       TO DFHEIV11
  7120*    MOVE '&2                    $   #00006697' TO DFHEIV0
  7121     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7122     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7123     MOVE X'2020233030303036363937' TO DFHEIV0(25:11)
  7124     CALL 'kxdfhei1' USING DFHEIV0,
  7125           DFHEIV1,
  7126           DFHEIV11,
  7127           DFHEIV99
  7128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7129
  7130    .
  7131 0450-EXIT.
  7132     EXIT.
  7133 0460-STARTBR-ERACCT.
  7134     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7135     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7136     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7137
  7138* EXEC CICS STARTBR
  7139*        DATASET   ('ERACCT')
  7140*        RIDFLD    (WS-ERACCT-KEY)
  7141*        GTEQ
  7142*        RESP      (WS-RESPONSE)
  7143*    END-EXEC
  7144     MOVE 'ERACCT' TO DFHEIV1
  7145     MOVE 0
  7146       TO DFHEIV11
  7147*    MOVE '&,         G          &  N#00006707' TO DFHEIV0
  7148     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7149     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7150     MOVE X'204E233030303036373037' TO DFHEIV0(25:11)
  7151     CALL 'kxdfhei1' USING DFHEIV0,
  7152           DFHEIV1,
  7153           WS-ERACCT-KEY,
  7154           DFHEIV99,
  7155           DFHEIV11,
  7156           DFHEIV99
  7157     MOVE EIBRESP  TO WS-RESPONSE
  7158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7159     .
  7160 0460-EXIT.
  7161     EXIT.
  7162 0470-READNEXT-ERACCT.
  7163
  7164* EXEC CICS READNEXT
  7165*       SET      (ADDRESS OF ACCOUNT-MASTER)
  7166*       DATASET ('ERACCT')
  7167*       RIDFLD  (WS-ERACCT-KEY)
  7168*       RESP    (WS-RESPONSE)
  7169*    END-EXEC
  7170     MOVE 'ERACCT' TO DFHEIV1
  7171     MOVE 0
  7172       TO DFHEIV11
  7173*    MOVE '&.S                   )  N#00006717' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 126
* EL6316.cbl
  7174     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7175     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7176     MOVE X'204E233030303036373137' TO DFHEIV0(25:11)
  7177     CALL 'kxdfhei1' USING DFHEIV0,
  7178           DFHEIV1,
  7179           DFHEIV20,
  7180           DFHEIV99,
  7181           WS-ERACCT-KEY,
  7182           DFHEIV99,
  7183           DFHEIV11,
  7184           DFHEIV99,
  7185           DFHEIV99
  7186     SET ADDRESS OF ACCOUNT-MASTER TO
  7187         DFHEIV20
  7188     MOVE EIBRESP  TO WS-RESPONSE
  7189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7190     .
  7191 0470-EXIT.
  7192     EXIT.
  7193 0491-ERNOTE-READ-UPDATE.
  7194
  7195* EXEC CICS READ
  7196*       UPDATE
  7197*       DATASET    (WS-ERNOTE-FILE-ID)
  7198*       RIDFLD     (WS-ERNOTE-KEY)
  7199*       SET        (ADDRESS OF CERTIFICATE-NOTE)
  7200*       RESP       (WS-RESPONSE)
  7201*    END-EXEC
  7202*    MOVE '&"S        EU         (  N#00006727' TO DFHEIV0
  7203     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7204     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7205     MOVE X'204E233030303036373237' TO DFHEIV0(25:11)
  7206     CALL 'kxdfhei1' USING DFHEIV0,
  7207           WS-ERNOTE-FILE-ID,
  7208           DFHEIV20,
  7209           DFHEIV99,
  7210           WS-ERNOTE-KEY,
  7211           DFHEIV99,
  7212           DFHEIV99,
  7213           DFHEIV99
  7214     SET ADDRESS OF CERTIFICATE-NOTE TO
  7215         DFHEIV20
  7216     MOVE EIBRESP  TO WS-RESPONSE
  7217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7218     .
  7219 0491-EXIT.
  7220     EXIT.
  7221 0492-REWRITE-ERNOTE.
  7222     MOVE 'E631'              TO CN-LAST-MAINT-USER
  7223     MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7224     MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7225
  7226* EXEC CICS REWRITE
  7227*       DATASET    (WS-ERNOTE-FILE-ID)
  7228*       FROM       (CERTIFICATE-NOTE)
  7229*       RESP       (WS-RESPONSE)
  7230*    END-EXEC
  7231     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 127
* EL6316.cbl
  7232      CERTIFICATE-NOTE
  7233       TO DFHEIV11
  7234*    MOVE '&& L                  %  N#00006741' TO DFHEIV0
  7235     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7236     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7237     MOVE X'204E233030303036373431' TO DFHEIV0(25:11)
  7238     CALL 'kxdfhei1' USING DFHEIV0,
  7239           WS-ERNOTE-FILE-ID,
  7240           CERTIFICATE-NOTE,
  7241           DFHEIV11,
  7242           DFHEIV99
  7243     MOVE EIBRESP  TO WS-RESPONSE
  7244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7245     .
  7246 0492-EXIT.
  7247     EXIT.
  7248 0493-SQUEEZE-ERNOTE.
  7249     IF CN-BILLING-START-LINE-NO > 0
  7250         MOVE CN-BILLING-START-LINE-NO TO NOTE-SUB
  7251     ELSE
  7252         MOVE +1                 TO NOTE-SUB
  7253     END-IF.
  7254
  7255     PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7256        (NOTE-SUB > +9)
  7257        IF CN-LINE (NOTE-SUB) = SPACES
  7258           MOVE CN-LINE (NOTE-SUB + +1)
  7259                                 TO CN-LINE (NOTE-SUB)
  7260           MOVE SPACES           TO CN-LINE (NOTE-SUB + +1)
  7261        END-IF
  7262     END-PERFORM
  7263     .
  7264 0493-EXIT.
  7265     EXIT.
  7266 0500-ERENDT-READ-GTEQ.
  7267
  7268* EXEC CICS READ
  7269*        DATASET    (WS-ERENDT-FILE-ID)
  7270*        RIDFLD     (ERENDT-KEY)
  7271*        SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7272*        RESP       (WS-RESPONSE)
  7273*        GTEQ
  7274*    END-EXEC
  7275*    MOVE '&"S        G          (  N#00006768' TO DFHEIV0
  7276     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7277     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7278     MOVE X'204E233030303036373638' TO DFHEIV0(25:11)
  7279     CALL 'kxdfhei1' USING DFHEIV0,
  7280           WS-ERENDT-FILE-ID,
  7281           DFHEIV20,
  7282           DFHEIV99,
  7283           ERENDT-KEY,
  7284           DFHEIV99,
  7285           DFHEIV99,
  7286           DFHEIV99
  7287     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7288         DFHEIV20
  7289     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 128
* EL6316.cbl
  7290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7291     IF NOT RESP-NORMAL
  7292        MOVE ER-2237             TO EMI-ERROR
  7293        PERFORM 9900-ERROR-FORMAT
  7294                                 THRU 9900-EXIT
  7295        MOVE -1                  TO CARRL
  7296        GO TO 8200-SEND-DATAONLY
  7297     END-IF
  7298     .
  7299 0500-EXIT.
  7300     EXIT.
  7301 0510-ERENDT-READNEXT.
  7302
  7303* EXEC CICS READNEXT
  7304*       DATASET    (WS-ERENDT-FILE-ID)
  7305*       RIDFLD     (ERENDT-KEY)
  7306*       SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7307*       RESP       (WS-RESPONSE)
  7308*    END-EXEC
  7309     MOVE 0
  7310       TO DFHEIV11
  7311*    MOVE '&.S                   )  N#00006786' TO DFHEIV0
  7312     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7313     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7314     MOVE X'204E233030303036373836' TO DFHEIV0(25:11)
  7315     CALL 'kxdfhei1' USING DFHEIV0,
  7316           WS-ERENDT-FILE-ID,
  7317           DFHEIV20,
  7318           DFHEIV99,
  7319           ERENDT-KEY,
  7320           DFHEIV99,
  7321           DFHEIV11,
  7322           DFHEIV99,
  7323           DFHEIV99
  7324     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7325         DFHEIV20
  7326     MOVE EIBRESP  TO WS-RESPONSE
  7327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7328     IF NOT RESP-NORMAL
  7329        MOVE ER-2237             TO EMI-ERROR
  7330        PERFORM 9900-ERROR-FORMAT
  7331                                 THRU 9900-EXIT
  7332        MOVE -1                  TO CARRL
  7333        GO TO 8200-SEND-DATAONLY
  7334     END-IF
  7335     .
  7336 0510-EXIT.
  7337     EXIT.
  7338 0520-ERENDT-STARTBR.
  7339
  7340* EXEC CICS STARTBR
  7341*       DATASET    (WS-ERENDT-FILE-ID)
  7342*       RIDFLD     (ERENDT-KEY)
  7343*       RESP       (WS-RESPONSE)
  7344*    END-EXEC
  7345     MOVE 0
  7346       TO DFHEIV11
  7347*    MOVE '&,         G          &  N#00006803' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 129
* EL6316.cbl
  7348     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7349     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7350     MOVE X'204E233030303036383033' TO DFHEIV0(25:11)
  7351     CALL 'kxdfhei1' USING DFHEIV0,
  7352           WS-ERENDT-FILE-ID,
  7353           ERENDT-KEY,
  7354           DFHEIV99,
  7355           DFHEIV11,
  7356           DFHEIV99
  7357     MOVE EIBRESP  TO WS-RESPONSE
  7358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7359     IF NOT RESP-NORMAL
  7360        MOVE ER-2237             TO EMI-ERROR
  7361        PERFORM 9900-ERROR-FORMAT
  7362                                 THRU 9900-EXIT
  7363        MOVE -1                  TO CARRL
  7364        GO TO 8200-SEND-DATAONLY
  7365     END-IF
  7366     .
  7367 0520-EXIT.
  7368     EXIT.
  7369 0530-ERENDT-READPREV.
  7370
  7371* EXEC CICS READPREV
  7372*       DATASET    (WS-ERENDT-FILE-ID)
  7373*       RIDFLD     (ERENDT-KEY)
  7374*       SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7375*       RESP       (WS-RESPONSE)
  7376*    END-EXEC
  7377     MOVE 0
  7378       TO DFHEIV11
  7379*    MOVE '&0S                   )  N#00006819' TO DFHEIV0
  7380     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  7381     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7382     MOVE X'204E233030303036383139' TO DFHEIV0(25:11)
  7383     CALL 'kxdfhei1' USING DFHEIV0,
  7384           WS-ERENDT-FILE-ID,
  7385           DFHEIV20,
  7386           DFHEIV99,
  7387           ERENDT-KEY,
  7388           DFHEIV99,
  7389           DFHEIV11,
  7390           DFHEIV99,
  7391           DFHEIV99
  7392     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7393         DFHEIV20
  7394     MOVE EIBRESP  TO WS-RESPONSE
  7395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7396     IF NOT RESP-NORMAL
  7397        MOVE ER-2238             TO EMI-ERROR
  7398        PERFORM 9900-ERROR-FORMAT
  7399                                 THRU 9900-EXIT
  7400        MOVE -1                  TO CARRL
  7401        GO TO 8200-SEND-DATAONLY
  7402     END-IF
  7403     .
  7404 0530-EXIT.
  7405     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 130
* EL6316.cbl
  7406 0600-CREATE-TEMP-STORAGE.
  7407
  7408* EXEC CICS WRITEQ TS
  7409*        QUEUE (QID)
  7410*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7411*        LENGTH(PI-COMM-LENGTH)
  7412*    END-EXEC
  7413*    MOVE '*"                    ''   #00006836' TO DFHEIV0
  7414     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7415     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7416     MOVE X'2020233030303036383336' TO DFHEIV0(25:11)
  7417     CALL 'kxdfhei1' USING DFHEIV0,
  7418           QID,
  7419           PROGRAM-INTERFACE-BLOCK,
  7420           PI-COMM-LENGTH,
  7421           DFHEIV99,
  7422           DFHEIV99,
  7423           DFHEIV99
  7424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7425     display ' about to write map ' el631ii
  7426
  7427* EXEC CICS WRITEQ TS
  7428*        QUEUE (QID)
  7429*        FROM  (EL631II)
  7430*        LENGTH(MAP-LENGTH)
  7431*    END-EXEC.
  7432*    MOVE '*"                    ''   #00006842' TO DFHEIV0
  7433     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7434     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7435     MOVE X'2020233030303036383432' TO DFHEIV0(25:11)
  7436     CALL 'kxdfhei1' USING DFHEIV0,
  7437           QID,
  7438           EL631II,
  7439           MAP-LENGTH,
  7440           DFHEIV99,
  7441           DFHEIV99,
  7442           DFHEIV99
  7443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7444
  7445 0600-EXIT.
  7446      EXIT.
  7447 0610-RECOVER-TEMP-STORAGE.
  7448
  7449* EXEC CICS READQ TS
  7450*        QUEUE (QID)
  7451*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7452*        LENGTH(PI-COMM-LENGTH)
  7453*    END-EXEC
  7454*    MOVE '*$I    L              ''   #00006850' TO DFHEIV0
  7455     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7456     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7457     MOVE X'2020233030303036383530' TO DFHEIV0(25:11)
  7458     CALL 'kxdfhei1' USING DFHEIV0,
  7459           QID,
  7460           PROGRAM-INTERFACE-BLOCK,
  7461           PI-COMM-LENGTH,
  7462           DFHEIV99,
  7463           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 131
* EL6316.cbl
  7464           DFHEIV99
  7465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7466
  7467* EXEC CICS READQ TS
  7468*        QUEUE (QID)
  7469*        INTO  (EL631II)
  7470*        LENGTH(MAP-LENGTH)
  7471*    END-EXEC
  7472*    MOVE '*$I    L              ''   #00006855' TO DFHEIV0
  7473     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7474     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7475     MOVE X'2020233030303036383535' TO DFHEIV0(25:11)
  7476     CALL 'kxdfhei1' USING DFHEIV0,
  7477           QID,
  7478           EL631II,
  7479           MAP-LENGTH,
  7480           DFHEIV99,
  7481           DFHEIV99,
  7482           DFHEIV99
  7483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7484     display ' map ' EL631II
  7485     PERFORM 0620-DELETE-TS THRU 0620-EXIT
  7486     MOVE AL-UANON            TO LTRIDA
  7487     IF WS-SET-CODES-MDT = 'Y'
  7488        move +1                  to s2
  7489        perform varying s1 from +1 by +5 until s1 > +60
  7490           MOVE WS-PASSED-REASON-CODES (s1:4)
  7491                                 TO reacd-in (s2)
  7492           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7493               MOVE AL-SANON     TO REACDA (S2)
  7494               MOVE +4           TO REACDL (S2)
  7495           END-IF
  7496           add +1                to s2
  7497        end-perform
  7498        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7499     END-IF
  7500
  7501     IF CRTNT1I > SPACES
  7502         MOVE AL-UANON       TO CRTNT1A
  7503     END-IF
  7504
  7505     IF CRTNT2I > SPACES
  7506         MOVE AL-UANON       TO CRTNT2A
  7507     END-IF
  7508
  7509     IF BILNT1I > SPACES
  7510         MOVE AL-UANON       TO BILNT1A
  7511     END-IF
  7512     .
  7513 0610-EXIT.
  7514      EXIT.
  7515 0620-DELETE-TS.
  7516
  7517* EXEC CICS DELETEQ TS
  7518*        QUEUE(QID)
  7519*    END-EXEC
  7520*    MOVE '*&                    #   #00006892' TO DFHEIV0
  7521     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 132
* EL6316.cbl
  7522     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7523     MOVE X'2020233030303036383932' TO DFHEIV0(25:11)
  7524     CALL 'kxdfhei1' USING DFHEIV0,
  7525           QID,
  7526           DFHEIV99
  7527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7528     .
  7529 0620-EXIT.
  7530      EXIT.
  7531 1000-FINALIZE.
  7532     PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  7533     IF NOT EMI-NO-ERRORS
  7534      AND EIBAID = DFHPF4
  7535        GO TO 8200-SEND-DATAONLY
  7536     END-IF
  7537     display ' made it to 1000 '
  7538     set P to address of KIXSYS
  7539     CALL "getenv" using by value P returning var-ptr
  7540     if var-ptr = null then
  7541        display ' kixsys not set '
  7542     else
  7543        set address of var to var-ptr
  7544        move 0 to env-var-len
  7545        inspect var tallying env-var-len
  7546          for characters before X'00'
  7547*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  7548        unstring var (1:env-var-len) delimited by '/'
  7549           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  7550              WS-KIX-SYS
  7551        end-unstring
  7552*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  7553*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  7554     end-if
  7555     set P to address of KIXHOST
  7556     CALL "getenv" using by value P returning var-ptr
  7557     if var-ptr = null then
  7558        display ' kixhost not set '
  7559     else
  7560        set address of var to var-ptr
  7561        move 0 to env-var-len
  7562        inspect var tallying env-var-len
  7563          for characters before X'00'
  7564*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  7565        MOVE var(1:env-var-len)  to ws-kixhost
  7566        DISPLAY ' WS KIX HOST ' WS-KIXhost
  7567     end-if
  7568     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  7569     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  7570     IF RESP-NORMAL
  7571        AND (PI-ELCRTO-KEY (1:33) =
  7572              OC-CONTROL-PRIMARY (1:33))
  7573           DISPLAY ' RESP NORMAL AND = '
  7574           MOVE OC-ORIG-REC         TO NEW-ORIG-REC
  7575           PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  7576           PERFORM 1100-CALL-NS-BUS-LOGIC
  7577                                    THRU 1100-EXIT
  7578           IF BL-OK
  7579              CONTINUE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 133
* EL6316.cbl
  7580           ELSE
  7581              MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  7582              MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  7583              MOVE -1               TO CARRL
  7584           END-IF
  7585     ELSE
  7586        MOVE ER-3829             TO EMI-ERROR
  7587        PERFORM 9900-ERROR-FORMAT
  7588                                 THRU 9900-EXIT
  7589        MOVE -1                  TO CARRL
  7590        GO TO 8100-SEND-INITIAL-MAP
  7591     END-IF
  7592     PERFORM 0390-BUILD-FROM-ERENDT THRU 0390-EXIT
  7593     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  7594                                 TO SYSO
  7595     MOVE WS-KIXHOST             TO HOSTO
  7596     MOVE PI-COMPANY-ID          TO COMPANYO
  7597     MOVE PI-PROCESSOR-ID        TO PROCIDO
  7598     MOVE '4'                    TO DATASORO
  7599     MOVE BL-BATCH-NO            TO BATCHNOO
  7600     MOVE BL-BATCH-SEQ           TO BSEQNOO
  7601     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  7602*    MOVE -1                     TO PRTSWL
  7603*    MOVE AL-UANON               TO PRTSWA
  7604     IF EIBAID = DFHPF4
  7605        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  7606        MOVE ER-0280             TO EMI-ERROR
  7607        PERFORM 9900-ERROR-FORMAT
  7608                                 THRU 9900-EXIT
  7609        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  7610        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7611        MOVE 'Y'                 TO PI-FINALIZED-IND
  7612        GO TO 9400-CLEAR
  7613     ELSE
  7614        MOVE ER-1818             TO EMI-ERROR
  7615        PERFORM 9900-ERROR-FORMAT
  7616                                 THRU 9900-EXIT
  7617     END-IF
  7618     GO TO 8100-SEND-INITIAL-MAP
  7619     .
  7620 1000-EXIT.
  7621     EXIT.
  7622 1100-CALL-NS-BUS-LOGIC.
  7623     DISPLAY ' MADE IT TO 1100 ' w-arch-number
  7624     MOVE SPACES                 TO BL-INPUT
  7625     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7626     MOVE '4'                    TO BL-DATA-SRCE
  7627     MOVE PB-CARRIER             TO BL-CARRIER
  7628     MOVE PB-GROUPING            TO BL-GROUP
  7629     MOVE PB-STATE               TO BL-STATE
  7630     MOVE PB-ACCOUNT             TO BL-ACCOUNT
  7631     IF PB-CERT-EFF-DT NOT = LOW-VALUES
  7632        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  7633        MOVE ' '                 TO DC-OPTION-CODE
  7634        PERFORM 9700-date-link
  7635        IF NO-CONVERSION-ERROR
  7636           MOVE DC-GREG-DATE-B-EDIT
  7637                                 TO BL-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 134
* EL6316.cbl
  7638        END-IF
  7639     END-IF
  7640     MOVE PB-CERT-NO             TO BL-CERT-NO
  7641     MOVE PB-ENTRY-BATCH         TO BL-BATCH-NO
  7642     MOVE PB-BATCH-SEQ-NO        TO BL-BATCH-SEQ
  7643     MOVE SPACES                 TO BL-RESP-NO
  7644     MOVE LTRIDI                 TO BL-LETTER-ID
  7645     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7646     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7647*    MOVE 'ALWA'                 TO BL-PROC-ID
  7648     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7649     IF EIBAID = DFHPF4
  7650        MOVE 'B'                 TO BL-WRITE-ERARCH
  7651     ELSE
  7652        MOVE 'T'                 TO BL-WRITE-ERARCH
  7653     END-IF
  7654     MOVE SPACES                 TO BL-CERT-FORM-ID
  7655     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7656     MOVE 'CAN ENDT'             TO BL-SOURCE-SCREEN
  7657     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7658        IF REACD-IN (S1) NOT = LOW-VALUES
  7659           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  7660        END-IF
  7661     END-PERFORM
  7662    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7663     DISPLAY ' BL INPUT ' BL-INPUT
  7664*****************************************
  7665* Invoke the LETTER business logic
  7666*****************************************
  7667     MOVE FUNCTION LENGTH(SRCH-COMMAREA) TO WS-COMM-LENGTH
  7668     display ' srch commarea ' srch-commarea
  7669     display ' length ' ws-comm-length
  7670
  7671* exec cics link
  7672*       program('NSRASBL')
  7673*       commarea(srch-commarea)
  7674*       LENGTH  (WS-COMM-LENGTH)
  7675*    end-exec.
  7676     MOVE 'NSRASBL' TO DFHEIV1
  7677*    MOVE '."C                   (   #00007037' TO DFHEIV0
  7678     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7679     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7680     MOVE X'2020233030303037303337' TO DFHEIV0(25:11)
  7681     CALL 'kxdfhei1' USING DFHEIV0,
  7682           DFHEIV1,
  7683           srch-commarea,
  7684           WS-COMM-LENGTH,
  7685           DFHEIV99,
  7686           DFHEIV99,
  7687           DFHEIV99,
  7688           DFHEIV99
  7689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7690
  7691     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7692        BL-MESSAGE
  7693     .
  7694 1100-EXIT.
  7695     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 135
* EL6316.cbl
  7696 1500-GET-ARCH-NO.
  7697     display ' made it to 1500 '
  7698     MOVE SPACES                 TO ELCNTL-KEY
  7699     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7700     MOVE '1'                    TO CNTL-REC-TYPE
  7701     MOVE ZEROS                  TO CNTL-SEQ
  7702
  7703* EXEC CICS READ
  7704*         DATASET    (WS-ELCNTL-FILE-ID)
  7705*         SET        (ADDRESS OF CONTROL-FILE)
  7706*         RIDFLD     (ELCNTL-KEY)
  7707*         UPDATE
  7708*         RESP       (WS-RESPONSE)
  7709*    END-EXEC
  7710*    MOVE '&"S        EU         (  N#00007053' TO DFHEIV0
  7711     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7712     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7713     MOVE X'204E233030303037303533' TO DFHEIV0(25:11)
  7714     CALL 'kxdfhei1' USING DFHEIV0,
  7715           WS-ELCNTL-FILE-ID,
  7716           DFHEIV20,
  7717           DFHEIV99,
  7718           ELCNTL-KEY,
  7719           DFHEIV99,
  7720           DFHEIV99,
  7721           DFHEIV99
  7722     SET ADDRESS OF CONTROL-FILE TO
  7723         DFHEIV20
  7724     MOVE EIBRESP  TO WS-RESPONSE
  7725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7726     IF RESP-NORMAL
  7727        display ' good read elcntl '
  7728        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7729           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7730        END-IF
  7731        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7732        MOVE CF-CREDIT-LAST-ARCH-NUM
  7733                                 TO W-ARCH-NUMBER
  7734        display ' new arch number ' w-arch-number
  7735
  7736* EXEC CICS REWRITE
  7737*          FROM      (CONTROL-FILE)
  7738*          DATASET   (WS-ELCNTL-FILE-ID)
  7739*       END-EXEC
  7740     MOVE LENGTH OF
  7741      CONTROL-FILE
  7742       TO DFHEIV11
  7743*    MOVE '&& L                  %   #00007069' TO DFHEIV0
  7744     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7745     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7746     MOVE X'2020233030303037303639' TO DFHEIV0(25:11)
  7747     CALL 'kxdfhei1' USING DFHEIV0,
  7748           WS-ELCNTL-FILE-ID,
  7749           CONTROL-FILE,
  7750           DFHEIV11,
  7751           DFHEIV99
  7752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7753     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 136
* EL6316.cbl
  7754     .
  7755 1500-EXIT.
  7756     EXIT.
  7757
  7758
  7759 1700-WRITE-CERT-NOTE      SECTION.
  7760
  7761     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7762     MOVE ZERO           TO ERCNOT-SEQ.
  7763     SET TB-INDX         DOWN BY 1.
  7764     SET TB-INDX1        TO TB-INDX.
  7765
  7766****DELETE CURRENT CERT NOTES
  7767 1700-LOOP.
  7768
  7769* EXEC CICS READ
  7770*        DATASET (WS-ERCNOT-FILE-ID)
  7771*        RIDFLD  (ERCNOT-KEY)
  7772*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7773*        RESP    (WS-RESPONSE)
  7774*        GTEQ
  7775*    END-EXEC.
  7776*    MOVE '&"S        G          (  N#00007088' TO DFHEIV0
  7777     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7778     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7779     MOVE X'204E233030303037303838' TO DFHEIV0(25:11)
  7780     CALL 'kxdfhei1' USING DFHEIV0,
  7781           WS-ERCNOT-FILE-ID,
  7782           DFHEIV20,
  7783           DFHEIV99,
  7784           ERCNOT-KEY,
  7785           DFHEIV99,
  7786           DFHEIV99,
  7787           DFHEIV99
  7788     SET ADDRESS OF CERT-NOTE-FILE TO
  7789         DFHEIV20
  7790     MOVE EIBRESP  TO WS-RESPONSE
  7791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7792
  7793
  7794     IF NOT RESP-NORMAL
  7795        GO TO 1700-ENDDEL
  7796     END-IF
  7797
  7798     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  7799
  7800     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  7801         GO TO 1700-ENDDEL
  7802     END-IF.
  7803
  7804
  7805* EXEC CICS DELETE
  7806*        DATASET (WS-ERCNOT-FILE-ID)
  7807*        RIDFLD  (ERCNOT-KEY)
  7808*    END-EXEC.
  7809*    MOVE '&(  R                 &   #00007106' TO DFHEIV0
  7810     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7811     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 137
* EL6316.cbl
  7812     MOVE X'2020233030303037313036' TO DFHEIV0(25:11)
  7813     CALL 'kxdfhei1' USING DFHEIV0,
  7814           WS-ERCNOT-FILE-ID,
  7815           ERCNOT-KEY,
  7816           DFHEIV99,
  7817           DFHEIV99,
  7818           DFHEIV99
  7819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7820
  7821
  7822     GO TO 1700-LOOP.
  7823
  7824 1700-ENDDEL.
  7825
  7826
  7827* EXEC CICS GETMAIN
  7828*         LENGTH(ERCNOT-LENGTH)
  7829*         SET(ADDRESS OF CERT-NOTE-FILE)
  7830*         INITIMG(GETMAIN-SPACE)
  7831*    END-EXEC.
  7832*    MOVE ',"IL                  $   #00007115' TO DFHEIV0
  7833     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7834     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7835     MOVE X'2020233030303037313135' TO DFHEIV0(25:11)
  7836     CALL 'kxdfhei1' USING DFHEIV0,
  7837           DFHEIV20,
  7838           ERCNOT-LENGTH,
  7839           GETMAIN-SPACE
  7840     SET ADDRESS OF CERT-NOTE-FILE TO
  7841         DFHEIV20
  7842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7843
  7844
  7845     SET TB-INDX TO 1.
  7846     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  7847     MOVE +0             TO ERCNOT-SEQ
  7848
  7849     PERFORM VARYING TB-INDX FROM 1 BY 1
  7850             UNTIL TB-INDX > TB-INDX1
  7851        MOVE SPACES                 TO  CERT-NOTE-FILE
  7852        ADD 1                       TO  ERCNOT-SEQ
  7853        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  7854        MOVE  'CZ'                  TO  CZ-RECORD-ID
  7855        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  7856        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  7857                                    TO  CZ-LAST-MAINT-USER
  7858        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7859                                    TO  CZ-LAST-MAINT-HHMMSS
  7860        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  7861                                    TO  CZ-LAST-MAINT-DT
  7862
  7863
  7864* EXEC CICS WRITE
  7865*            DATASET(WS-ERCNOT-FILE-ID)
  7866*            FROM(CERT-NOTE-FILE)
  7867*            RIDFLD(ERCNOT-KEY)
  7868*       END-EXEC
  7869     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 138
* EL6316.cbl
  7870      CERT-NOTE-FILE
  7871       TO DFHEIV11
  7872*    MOVE '&$ L                  ''   #00007139' TO DFHEIV0
  7873     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7874     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7875     MOVE X'2020233030303037313339' TO DFHEIV0(25:11)
  7876     CALL 'kxdfhei1' USING DFHEIV0,
  7877           WS-ERCNOT-FILE-ID,
  7878           CERT-NOTE-FILE,
  7879           DFHEIV11,
  7880           ERCNOT-KEY,
  7881           DFHEIV99,
  7882           DFHEIV99
  7883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7884     END-PERFORM
  7885
  7886     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7887     IF RESP-NORMAL
  7888        EVALUATE CM-NOTE-SW
  7889           WHEN '1'
  7890           WHEN '3'
  7891           WHEN '5'
  7892           WHEN '7'
  7893              SET NO-CERT-RW     TO TRUE
  7894           WHEN ' '
  7895              MOVE '1'           TO CM-NOTE-SW
  7896           WHEN '2'
  7897              MOVE '3'           TO CM-NOTE-SW
  7898           WHEN '4'
  7899              MOVE '5'           TO CM-NOTE-SW
  7900           WHEN '6'
  7901              MOVE '7'           TO CM-NOTE-SW
  7902        END-EVALUATE
  7903     END-IF
  7904     IF NOT NO-CERT-RW
  7905        PERFORM 1810-REWRITE-ELCERT
  7906                                 THRU 1810-EXIT
  7907     ELSE
  7908
  7909* EXEC CICS UNLOCK
  7910*          DATASET    (WS-ELCERT-FILE-ID)
  7911*       END-EXEC
  7912*    MOVE '&*                    #   #00007168' TO DFHEIV0
  7913     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7914     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7915     MOVE X'2020233030303037313638' TO DFHEIV0(25:11)
  7916     CALL 'kxdfhei1' USING DFHEIV0,
  7917           WS-ELCERT-FILE-ID,
  7918           DFHEIV99
  7919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7920     END-IF
  7921
  7922     .
  7923 1799-EXIT.
  7924     EXIT.
  7925
  7926 1800-READ-ELCERT-UPDATE.
  7927
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 139
* EL6316.cbl
  7928     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  7929     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  7930     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  7931     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  7932     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  7933     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  7934     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  7935     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  7936
  7937
  7938* EXEC CICS READ
  7939*        UPDATE
  7940*        DATASET  (WS-ELCERT-FILE-ID)
  7941*        RIDFLD   (WS-ELCERT-KEY)
  7942*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  7943*        RESP     (WS-RESPONSE)
  7944*    END-EXEC
  7945*    MOVE '&"S        EU         (  N#00007188' TO DFHEIV0
  7946     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7947     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7948     MOVE X'204E233030303037313838' TO DFHEIV0(25:11)
  7949     CALL 'kxdfhei1' USING DFHEIV0,
  7950           WS-ELCERT-FILE-ID,
  7951           DFHEIV20,
  7952           DFHEIV99,
  7953           WS-ELCERT-KEY,
  7954           DFHEIV99,
  7955           DFHEIV99,
  7956           DFHEIV99
  7957     SET ADDRESS OF CERTIFICATE-MASTER TO
  7958         DFHEIV20
  7959     MOVE EIBRESP  TO WS-RESPONSE
  7960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7961
  7962     .
  7963 1800-EXIT.
  7964     EXIT.
  7965
  7966 1810-REWRITE-ELCERT.
  7967
  7968
  7969* EXEC CICS REWRITE
  7970*        FROM     (CERTIFICATE-MASTER)
  7971*        DATASET  (WS-ELCERT-FILE-ID)
  7972*        RESP     (WS-RESPONSE)
  7973*    END-EXEC.
  7974     MOVE LENGTH OF
  7975      CERTIFICATE-MASTER
  7976       TO DFHEIV11
  7977*    MOVE '&& L                  %  N#00007202' TO DFHEIV0
  7978     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7979     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7980     MOVE X'204E233030303037323032' TO DFHEIV0(25:11)
  7981     CALL 'kxdfhei1' USING DFHEIV0,
  7982           WS-ELCERT-FILE-ID,
  7983           CERTIFICATE-MASTER,
  7984           DFHEIV11,
  7985           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 140
* EL6316.cbl
  7986     MOVE EIBRESP  TO WS-RESPONSE
  7987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7988
  7989
  7990     .
  7991 1810-EXIT.
  7992     EXIT.
  7993
  7994 8100-SEND-INITIAL-MAP.
  7995     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7996     MOVE '5'                    TO DC-OPTION-CODE.
  7997     PERFORM 9700-DATE-LINK.
  7998     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  7999     MOVE EIBTIME                TO TIME-IN.
  8000     MOVE TIME-OUT               TO TIMEO.
  8001     MOVE -1                     TO LTRIDL
  8002*    MOVE AL-UANON               TO PRTSWA
  8003     IF PI-PROCESSOR-IS-CSR-SUPER
  8004        perform varying s1 from +1 by +1 until
  8005           s1 > +12
  8006           MOVE AL-UANON            TO reacda (s1)
  8007        end-perform
  8008     END-IF
  8009     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  8010
  8011* EXEC CICS SEND
  8012*        MAP      (MAP-NAME)
  8013*        MAPSET   (MAPSET-NAME)
  8014*        FROM     (EL631IO)
  8015*        ERASE
  8016*        CURSOR
  8017*    END-EXEC.
  8018     MOVE LENGTH OF
  8019      EL631IO
  8020       TO DFHEIV12
  8021     MOVE -1
  8022       TO DFHEIV11
  8023*    MOVE '8$     CT  E    H L F ,   #00007228' TO DFHEIV0
  8024     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8025     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8026     MOVE X'2020233030303037323238' TO DFHEIV0(25:11)
  8027     CALL 'kxdfhei1' USING DFHEIV0,
  8028           MAP-NAME,
  8029           EL631IO,
  8030           DFHEIV12,
  8031           MAPSET-NAME,
  8032           DFHEIV99,
  8033           DFHEIV99,
  8034           DFHEIV99,
  8035           DFHEIV11,
  8036           DFHEIV99,
  8037           DFHEIV99,
  8038           DFHEIV99
  8039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8040
  8041     GO TO 9100-RETURN-TRAN.
  8042 8200-SEND-DATAONLY.
  8043     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 141
* EL6316.cbl
  8044     MOVE '5'                    TO DC-OPTION-CODE.
  8045     PERFORM 9700-DATE-LINK.
  8046     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8047     MOVE EIBTIME                TO TIME-IN.
  8048     MOVE TIME-OUT               TO TIMEO.
  8049     MOVE -1                     TO PFENTRL
  8050     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
  8051
  8052* EXEC CICS SEND
  8053*        MAP      (MAP-NAME)
  8054*        MAPSET   (MAPSET-NAME)
  8055*        FROM     (EL631IO)
  8056*        DATAONLY
  8057*        ERASEAUP
  8058*        CURSOR
  8059*    END-EXEC.
  8060     MOVE LENGTH OF
  8061      EL631IO
  8062       TO DFHEIV12
  8063     MOVE -1
  8064       TO DFHEIV11
  8065*    MOVE '8$D    CT  A    H L F ,   #00007245' TO DFHEIV0
  8066     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8067     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8068     MOVE X'2020233030303037323435' TO DFHEIV0(25:11)
  8069     CALL 'kxdfhei1' USING DFHEIV0,
  8070           MAP-NAME,
  8071           EL631IO,
  8072           DFHEIV12,
  8073           MAPSET-NAME,
  8074           DFHEIV99,
  8075           DFHEIV99,
  8076           DFHEIV99,
  8077           DFHEIV11,
  8078           DFHEIV99,
  8079           DFHEIV99,
  8080           DFHEIV99
  8081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8082
  8083     GO TO 9100-RETURN-TRAN.
  8084 8300-SEND-TEXT.
  8085
  8086* EXEC CICS SEND TEXT
  8087*        FROM     (LOGOFF-TEXT)
  8088*        LENGTH   (LOGOFF-LENGTH)
  8089*        ERASE
  8090*        FREEKB
  8091*    END-EXEC.
  8092*    MOVE '8&      T  E F  H   F -   #00007255' TO DFHEIV0
  8093     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8094     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8095     MOVE X'2020233030303037323535' TO DFHEIV0(25:11)
  8096     CALL 'kxdfhei1' USING DFHEIV0,
  8097           LOGOFF-TEXT,
  8098           LOGOFF-LENGTH,
  8099           DFHEIV99,
  8100           DFHEIV99,
  8101           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 142
* EL6316.cbl
  8102           DFHEIV99,
  8103           DFHEIV99,
  8104           DFHEIV99,
  8105           DFHEIV99,
  8106           DFHEIV99,
  8107           DFHEIV99,
  8108           DFHEIV99
  8109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8110
  8111
  8112* EXEC CICS RETURN
  8113*    END-EXEC.
  8114*    MOVE '.(                    ''   #00007261' TO DFHEIV0
  8115     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8116     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8117     MOVE X'2020233030303037323631' TO DFHEIV0(25:11)
  8118     CALL 'kxdfhei1' USING DFHEIV0,
  8119           DFHEIV99,
  8120           DFHEIV99,
  8121           DFHEIV99,
  8122           DFHEIV99,
  8123           DFHEIV99,
  8124           DFHEIV99
  8125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8126
  8127 8800-UNAUTHORIZED-ACCESS.
  8128     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8129     GO TO 8300-SEND-TEXT.
  8130 8810-PF23.
  8131     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8132     MOVE XCTL-005               TO PGM-NAME.
  8133     GO TO 9300-XCTL.
  8134 9000-RETURN-CICS.
  8135
  8136* EXEC CICS RETURN
  8137*    END-EXEC.
  8138*    MOVE '.(                    ''   #00007271' TO DFHEIV0
  8139     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8140     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8141     MOVE X'2020233030303037323731' TO DFHEIV0(25:11)
  8142     CALL 'kxdfhei1' USING DFHEIV0,
  8143           DFHEIV99,
  8144           DFHEIV99,
  8145           DFHEIV99,
  8146           DFHEIV99,
  8147           DFHEIV99,
  8148           DFHEIV99
  8149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8150
  8151 9100-RETURN-TRAN.
  8152     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8153     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8154
  8155* EXEC CICS RETURN
  8156*        TRANSID    (TRANS-ID)
  8157*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8158*        LENGTH     (1300)
  8159*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 143
* EL6316.cbl
  8160     MOVE 1300
  8161       TO DFHEIV11
  8162*    MOVE '.(CT                  ''   #00007276' TO DFHEIV0
  8163     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8164     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8165     MOVE X'2020233030303037323736' TO DFHEIV0(25:11)
  8166     CALL 'kxdfhei1' USING DFHEIV0,
  8167           TRANS-ID,
  8168           PROGRAM-INTERFACE-BLOCK,
  8169           DFHEIV11,
  8170           DFHEIV99,
  8171           DFHEIV99,
  8172           DFHEIV99
  8173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8174
  8175 9200-RETURN-MAIN-MENU.
  8176     MOVE XCTL-626               TO PGM-NAME.
  8177     GO TO 9300-XCTL.
  8178 9300-XCTL.
  8179
  8180* EXEC CICS XCTL
  8181*        PROGRAM    (PGM-NAME)
  8182*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8183*        LENGTH     (1300)
  8184*    END-EXEC.
  8185     MOVE 1300
  8186       TO DFHEIV11
  8187*    MOVE '.$C                   %   #00007285' TO DFHEIV0
  8188     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8189     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8190     MOVE X'2020233030303037323835' TO DFHEIV0(25:11)
  8191     CALL 'kxdfhei1' USING DFHEIV0,
  8192           PGM-NAME,
  8193           PROGRAM-INTERFACE-BLOCK,
  8194           DFHEIV11,
  8195           DFHEIV99
  8196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8197
  8198 9400-CLEAR.
  8199     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8200
  8201* EXEC CICS XCTL
  8202*        PROGRAM    (PGM-NAME)
  8203*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8204*        LENGTH     (1300)
  8205*    END-EXEC.
  8206     MOVE 1300
  8207       TO DFHEIV11
  8208*    MOVE '.$C                   %   #00007292' TO DFHEIV0
  8209     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8210     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8211     MOVE X'2020233030303037323932' TO DFHEIV0(25:11)
  8212     CALL 'kxdfhei1' USING DFHEIV0,
  8213           PGM-NAME,
  8214           PROGRAM-INTERFACE-BLOCK,
  8215           DFHEIV11,
  8216           DFHEIV99
  8217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 144
* EL6316.cbl
  8218
  8219 9500-PF12.
  8220     MOVE XCTL-010               TO PGM-NAME.
  8221     GO TO 9300-XCTL.
  8222 9600-PGMID-ERROR.
  8223
  8224* EXEC CICS HANDLE CONDITION
  8225*        PGMIDERR    (8300-SEND-TEXT)
  8226*    END-EXEC.
  8227*    MOVE '"$L                   ! " #00007301' TO DFHEIV0
  8228     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8229     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8230     MOVE X'2220233030303037333031' TO DFHEIV0(25:11)
  8231     CALL 'kxdfhei1' USING DFHEIV0
  8232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8233
  8234     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8235     MOVE ' '                    TO PI-ENTRY-CD-1.
  8236     MOVE XCTL-005               TO PGM-NAME.
  8237     MOVE PGM-NAME               TO LOGOFF-PGM.
  8238     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8239     GO TO 9300-XCTL.
  8240 9700-DATE-LINK.
  8241     MOVE LINK-ELDATCV           TO PGM-NAME.
  8242
  8243* EXEC CICS LINK
  8244*        PROGRAM    (PGM-NAME)
  8245*        COMMAREA   (DATE-CONVERSION-DATA)
  8246*        LENGTH     (DC-COMM-LENGTH)
  8247*    END-EXEC.
  8248*    MOVE '."C                   (   #00007312' TO DFHEIV0
  8249     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8250     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8251     MOVE X'2020233030303037333132' TO DFHEIV0(25:11)
  8252     CALL 'kxdfhei1' USING DFHEIV0,
  8253           PGM-NAME,
  8254           DATE-CONVERSION-DATA,
  8255           DC-COMM-LENGTH,
  8256           DFHEIV99,
  8257           DFHEIV99,
  8258           DFHEIV99,
  8259           DFHEIV99
  8260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8261
  8262 9900-ERROR-FORMAT.
  8263     IF NOT EMI-ERRORS-COMPLETE
  8264        MOVE LINK-001            TO PGM-NAME
  8265
  8266* EXEC CICS LINK
  8267*           PROGRAM    (PGM-NAME)
  8268*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8269*           LENGTH     (EMI-COMM-LENGTH)
  8270*       END-EXEC
  8271*    MOVE '."C                   (   #00007320' TO DFHEIV0
  8272     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8273     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8274     MOVE X'2020233030303037333230' TO DFHEIV0(25:11)
  8275     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 145
* EL6316.cbl
  8276           PGM-NAME,
  8277           ERROR-MESSAGE-INTERFACE-BLOCK,
  8278           EMI-COMM-LENGTH,
  8279           DFHEIV99,
  8280           DFHEIV99,
  8281           DFHEIV99,
  8282           DFHEIV99
  8283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8284     END-IF
  8285     .
  8286 9900-EXIT.
  8287     EXIT.
  8288 9990-ABEND.
  8289     MOVE LINK-004               TO PGM-NAME.
  8290     MOVE DFHEIBLK               TO EMI-LINE1.
  8291
  8292* EXEC CICS LINK
  8293*        PROGRAM   (PGM-NAME)
  8294*        COMMAREA  (EMI-LINE1)
  8295*        LENGTH    (72)
  8296*    END-EXEC.
  8297     MOVE 72
  8298       TO DFHEIV11
  8299*    MOVE '."C                   (   #00007332' TO DFHEIV0
  8300     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8301     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8302     MOVE X'2020233030303037333332' TO DFHEIV0(25:11)
  8303     CALL 'kxdfhei1' USING DFHEIV0,
  8304           PGM-NAME,
  8305           EMI-LINE1,
  8306           DFHEIV11,
  8307           DFHEIV99,
  8308           DFHEIV99,
  8309           DFHEIV99,
  8310           DFHEIV99
  8311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8312
  8313     GO TO 8200-SEND-DATAONLY.
  8314
  8315* GOBACK.
  8316     MOVE '9%                    "   ' TO DFHEIV0
  8317     MOVE 'EL6316' TO DFHEIV1
  8318     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8319     GOBACK.
  8320 9995-SECURITY-VIOLATION.
  8321*                            COPY ELCSCTP.
  8322******************************************************************
  8323*                                                                *
  8324*                            ELCSCTP                             *
  8325*                            VMOD=2.001                          *
  8326*                                                                *
  8327*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8328******************************************************************
  8329
  8330
  8331     MOVE EIBDATE          TO SM-JUL-DATE.
  8332     MOVE EIBTRMID         TO SM-TERMID.
  8333     MOVE THIS-PGM         TO SM-PGM.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:08 Page 146
* EL6316.cbl
  8334     MOVE EIBTIME          TO TIME-IN.
  8335     MOVE TIME-OUT         TO SM-TIME.
  8336     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8337
  8338
  8339* EXEC CICS LINK
  8340*         PROGRAM  ('EL003')
  8341*         COMMAREA (SECURITY-MESSAGE)
  8342*         LENGTH   (80)
  8343*    END-EXEC.
  8344     MOVE 'EL003' TO DFHEIV1
  8345     MOVE 80
  8346       TO DFHEIV11
  8347*    MOVE '."C                   (   #00007357' TO DFHEIV0
  8348     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8349     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8350     MOVE X'2020233030303037333537' TO DFHEIV0(25:11)
  8351     CALL 'kxdfhei1' USING DFHEIV0,
  8352           DFHEIV1,
  8353           SECURITY-MESSAGE,
  8354           DFHEIV11,
  8355           DFHEIV99,
  8356           DFHEIV99,
  8357           DFHEIV99,
  8358           DFHEIV99
  8359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8360
  8361
  8362******************************************************************
  8363
  8364 9995-EXIT.
  8365     EXIT.
  8366
  8367 9999-DFHBACK SECTION.
  8368     MOVE '9%                    "   ' TO DFHEIV0
  8369     MOVE 'EL6316' TO DFHEIV1
  8370     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8371     GOBACK.
  8372 9999-DFHEXIT.
  8373     IF DFHEIGDJ EQUAL 0001
  8374         NEXT SENTENCE
  8375     ELSE IF DFHEIGDJ EQUAL 2
  8376         GO TO 8300-SEND-TEXT
  8377         DEPENDING ON DFHEIGDI.
  8378     MOVE '9%                    "   ' TO DFHEIV0
  8379     MOVE 'EL6316' TO DFHEIV1
  8380     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8381     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34536     Code:       19276
