* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   1
* NSAASBL.cbl
* Options: int("NSAASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSAASBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSAASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSAASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSAASBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSAASLTR.cl2
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   2
* NSAASBL.cbl
    14* 071111    2011022800001  PEMA  NEW PROGRAM
    15* 102212    2012101700002  AJRA  EXPAND PASSED AREA
    16* 012413    2013012100001  AJRA  ADD AUTO BILLING NOTE
    17* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    18******************************************************************
    19 ENVIRONMENT DIVISION.
    20 DATA DIVISION.
    21 working-storage section.
    22 01  DFH-START PIC X(04).
    23 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    24 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    25 77  S1                          PIC S999 COMP-3 VALUE +0.
    26 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    27 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    28 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    29 77  NOTE-SUB                    PIC S9(5) COMP-3 VALUE +0.
    30 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    31     88  NO-CERT-RW                 VALUE 'N'.
    32     88  CERT-RW                    VALUE 'Y'.
    33 01 response-code         pic s9(8) comp.
    34 01 display-response      pic 9(8).
    35 01 bl-index              pic 9(8) comp.
    36 01 max-last-name         pic x(18).
    37 01 first-initial         pic x.
    38 01 name-in-range-flag    pic 9.
    39 01 max-entries           pic s9(8) comp value 100.
    40 01 lower-case    pic x(26) value
    41            "abcdefghijklmnopqrstuvwxyz".
    42 01 upper-case    pic x(26) value
    43            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
    44 01  MISC.
    45     12  WS-RESPONSE             PIC S9(8)   COMP.
    46         88  RESP-NORMAL                  VALUE +00.
    47         88  RESP-NOTFND                  VALUE +13.
    48         88  RESP-DUPREC                  VALUE +14.
    49         88  RESP-DUPKEY                  VALUE +15.
    50         88  RESP-NOTOPEN                 VALUE +19.
    51         88  RESP-ENDFILE                 VALUE +20.
    52*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
    53*                         COPY ELCZREC.
    54******************************************************************
    55*                                                                *
    56*                                                                *
    57*                            ELCZREC.                            *
    58*                                                                *
    59*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
    60*                                                                *
    61******************************************************************
    62*-----------------------------------------------------------------
    63*                   C H A N G E   L O G
    64*
    65* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    66*-----------------------------------------------------------------
    67*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    68* EFFECTIVE    NUMBER
    69*-----------------------------------------------------------------
    70* 122011    2011022800001  AJRA  NEW FILE
    71* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   3
* NSAASBL.cbl
    72* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
    73* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
    74* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
    75*-----------------------------------------------------------------
    76 01  W-Z-CONTROL-DATA.
    77     05  W-NUMBER-OF-COPIES      PIC  9.
    78     05  FILLER                  PIC  X.
    79     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
    80     05  FILLER                  PIC  X.
    81     05  W-DAYS-TO-RESEND        PIC  999.
    82     05  FILLER                  PIC  X.
    83     05  W-FORM-TO-RESEND        PIC  X(4).
    84     05  W-ADD-BAR-CODE          PIC  X.
    85     05  W-PROMPT-LETTER         PIC  X.
    86     05  W-HAS-RETURN-ENV        PIC  X.
    87     05  W-ENCLOSURE-CD          PIC  XXX.
    88     05  W-SIG-FLAG-DEFAULT      PIC  X.
    89     05  W-AUTO-CLOSE-IND        PIC  X.
    90     05  FILLER                  PIC  X.
    91     05  W-LETTER-TO-BENE        PIC  X.
    92     05  FILLER                  PIC  X.
    93     05  W-LETTER-TO-ACCT        PIC  X.
    94     05  FILLER                  PIC  X.
    95     05  W-LETTER-TYPE           PIC  X.
    96     05  FILLER                  PIC  X.
    97     05  W-PRINT-CERTIFICATE     PIC  X.
    98     05  FILLER                  PIC  X.
    99     05  W-REFUND-REQUIRED       PIC  X.
   100     05  FILLER                  PIC  X.
   101     05  W-ONBASE-CODE           PIC  XX.
   102     05  FILLER                  PIC  X.
   103     05  W-ACCT-SUMM             PIC  X.
   104     05  FILLER                  PIC  X.
   105     05  W-CSO-SUMM              PIC  X.
   106     05  FILLER                  PIC  X.
   107     05  W-REASONS-REQUIRED      PIC  X.
   108     05  FILLER                  PIC  X(29).
   109 01  WS-ERARCH-KEY.
   110     05  WS-ERARCH-COMPANY-CD    PIC X.
   111     05  WS-ERARCH-ARCH-NO       PIC S9(8) BINARY.
   112 01  WS-ERENDT2-KEY.
   113     05  WS-ERENDT-COMPANY-CD    PIC X.
   114     05  WS-ERENDT-ARCH-NO       PIC 9(8) BINARY.
   115 01  WS-NSASEXTR-KEY.
   116     05  WS-EXTR-COMPANY-CD    PIC X.
   117     05  WS-EXTR-ARCH-NO       PIC 9(8) BINARY.
   118     05  WS-EXTR-SEQ-NO        PIC 9(4) BINARY.
   119 01  WS-ELLETR-KEY.
   120     05  WS-ELLETR-COMPANY-CD    PIC X.
   121     05  WS-ELLETR-LETTER-ID     PIC X(12).
   122     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   123
   124 01  BILL-NOTE-AREA.
   125     12  WS-ELEOBC-KEY.
   126         16  WS-EOBC-COMPANY-CD  PIC X.
   127         16  WS-EOBC-REC-TYPE    PIC X.
   128         16  WS-EOBC-CODE        PIC X(4).
   129         16  FILLER              PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   4
* NSAASBL.cbl
   130     12  WS-ERNOTE-KEY.
   131         16  WS-NOTE-COMPANY-CD  PIC X.
   132         16  WS-NOTE-CARRIER     PIC X.
   133         16  WS-NOTE-GROUPING    PIC X(6).
   134         16  WS-NOTE-STATE       PIC XX.
   135         16  WS-NOTE-ACCOUNT     PIC X(10).
   136         16  WS-NOTE-CERT-EFF-DT PIC XX.
   137         16  WS-NOTE-CERT-PRIME  PIC X(10).
   138         16  WS-NOTE-CERT-SFX    PIC X.
   139     12  WS-BILLING-NOTE.
   140         16  WS-BN-NOTE          PIC X(25).
   141         16  WS-BN-LTRID         PIC X(4).
   142         16  FILLER              PIC X(3).
   143         16  WS-BN-DATE          PIC X(8).
   144         16  FILLER              PIC X(3).
   145         16  WS-BN-USERID        PIC X(4).
   146         16  FILLER              PIC X(30).
   147     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   148     12  WS-ELCERT-KEY.
   149         16  WS-CERT-COMPANY-CD  PIC X.
   150         16  WS-CERT-CARRIER     PIC X.
   151         16  WS-CERT-GROUPING    PIC X(6).
   152         16  WS-CERT-STATE       PIC XX.
   153         16  WS-CERT-ACCOUNT     PIC X(10).
   154         16  WS-CERT-CERT-EFF-DT PIC XX.
   155         16  WS-CERT-CERT-PRIME  PIC X(10).
   156         16  WS-CERT-CERT-SFX    PIC X.
   157     12  WS-SAVE-KEY.
   158         16  WS-SV-COMPANY-CD    PIC X.
   159         16  WS-SV-CARRIER       PIC X.
   160         16  WS-SV-GROUPING      PIC X(6).
   161         16  WS-SV-STATE         PIC XX.
   162         16  WS-SV-ACCOUNT       PIC X(10).
   163         16  WS-SV-CERT-EFF-DT   PIC XX.
   164         16  WS-SV-CERT-PRIME    PIC X(10).
   165         16  WS-SV-CERT-SFX      PIC X.
   166     12  WS-SAVE-DATA.
   167         16  WS-SV-LETTER-ID     PIC X(4).
   168         16  WS-SV-PROC-ID       PIC X(4).
   169 01 srch-commarea.
   170*                                copy ELCADLTRSPI.
   171******************************************************************
   172*                   C H A N G E   L O G
   173*
   174* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   175*-----------------------------------------------------------------
   176*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   177* EFFECTIVE    NUMBER
   178*-----------------------------------------------------------------
   179* 060611    2011022800001  PEMA  NEW COPYBOOK
   180* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   181* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   182******************************************************************
   183****************************************
   184*  commarea for NaperSoft On Demand Admin services letters
   185*  (business logic input & output)
   186****************************************
   187     03  BL-INPUT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   5
* NSAASBL.cbl
   188         05  BL-DATA-SRCE        PIC X.
   189         05  BL-LETTER-ID        PIC XXXX.
   190         05  BL-CARRIER          PIC X.
   191         05  BL-GROUP            PIC X(6).
   192         05  BL-STATE            PIC XX.
   193         05  BL-ACCOUNT          PIC X(10).
   194         05  BL-EFF-DT           PIC X(10).
   195         05  BL-CERT-NO          PIC X(11).
   196         05  BL-BATCH-NO         PIC X(6).
   197         05  BL-BATCH-SEQ        PIC 9(8).
   198         05  BL-RESP-NO          PIC X(10).
   199         05  BL-NO-OF-COPIES     PIC 99.
   200         05  BL-PROC-ID          PIC XXXX.
   201         05  BL-COMP-ID          PIC XXX.
   202         05  BL-PRINT-NOW-SW     PIC X.
   203         05  BL-ENC-CD           PIC XXX.
   204         05  BL-RESEND-DT        PIC X(10).
   205         05  BL-FOLLOW-UP-DT     PIC X(10).
   206         05  BL-ARCHIVE-NO       PIC 9(8).
   207         05  BL-FUNC             PIC X(8).
   208         05  BL-COMMENTS         PIC X(100).
   209         05  FILLER REDEFINES BL-COMMENTS.
   210             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   211             10  BL-LETTER-TO-ACCT PIC X.
   212             10  BL-LETTER-TO-BENE PIC X.
   213             10  BL-WRITE-ERARCH   PIC X.
   214                 88  ERARCH-QWS      VALUE 'Q'.
   215                 88  ERARCH-BATCH    VALUE 'B'.
   216                 88  ERARCH-TEMP     VALUE 'T'.
   217             10  BL-PROCESS-TYPE PIC X(07).
   218             10  BL-CERT-FORM-ID PIC X(05).
   219             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   220             10  BL-SOURCE-SCREEN PIC X(8).
   221             10  FILLER          PIC X(25).
   222     03  BL-OUTPUT.
   223         05  BL-STATUS                   PIC X.
   224             88  BL-OK                      VALUE "P".
   225             88  BL-FAIL                  VALUE "F".
   226         05  BL-MESSAGE          PIC X(50).
   227     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   228     03  FILLER                  PIC X(31).
   229*                                COPY ELCDATE.
   230******************************************************************
   231*                                                                *
   232*                                                                *
   233*                            ELCDATE.                            *
   234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   235*                            VMOD=2.003
   236*                                                                *
   237*                                                                *
   238*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   239*                 LENGTH = 200                                   *
   240******************************************************************
   241
   242 01  DATE-CONVERSION-DATA.
   243     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   244     12  DC-OPTION-CODE                PIC X.
   245         88  BIN-TO-GREG                VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   6
* NSAASBL.cbl
   246         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   247         88  EDIT-GREG-TO-BIN           VALUE '2'.
   248         88  YMD-GREG-TO-BIN            VALUE '3'.
   249         88  MDY-GREG-TO-BIN            VALUE '4'.
   250         88  JULIAN-TO-BIN              VALUE '5'.
   251         88  BIN-PLUS-ELAPSED           VALUE '6'.
   252         88  FIND-CENTURY               VALUE '7'.
   253         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   254         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   255         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   256         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   257         88  JULIAN-TO-BIN-3            VALUE 'C'.
   258         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   259         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   260         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   261         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   262         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   263         88  CHECK-LEAP-YEAR            VALUE 'H'.
   264         88  BIN-3-TO-GREG              VALUE 'I'.
   265         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   266         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   267         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   268         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   269         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   270         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   271         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   272         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   273         88  THREE-CHARACTER-BIN
   274                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   275         88  GREGORIAN-TO-BIN
   276                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   277         88  BIN-TO-GREGORIAN
   278                  VALUES ' ' '1' 'I' '8' 'G'.
   279         88  JULIAN-TO-BINARY
   280                  VALUES '5' 'C' 'E' 'F'.
   281     12  DC-ERROR-CODE                 PIC X.
   282         88  NO-CONVERSION-ERROR        VALUE ' '.
   283         88  DATE-CONVERSION-ERROR
   284                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   285         88  DATE-IS-ZERO               VALUE '1'.
   286         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   287         88  DATE-IS-INVALID            VALUE '3'.
   288         88  DATE1-GREATER-DATE2        VALUE '4'.
   289         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   290         88  DATE-INVALID-OPTION        VALUE '9'.
   291         88  INVALID-CENTURY            VALUE 'A'.
   292         88  ONLY-CENTURY               VALUE 'B'.
   293         88  ONLY-LEAP-YEAR             VALUE 'C'.
   294         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   295     12  DC-END-OF-MONTH               PIC X.
   296         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   297     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   298         88  USE-NORMAL-PROCESS         VALUE ' '.
   299         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   300         88  ADJUST-UP-100-YRS          VALUE '2'.
   301     12  FILLER                        PIC X.
   302     12  DC-CONVERSION-DATES.
   303         16  DC-BIN-DATE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   7
* NSAASBL.cbl
   304         16  DC-BIN-DATE-2             PIC XX.
   305         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   306         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   307                       DC-GREG-DATE-1-EDIT.
   308             20  DC-EDIT1-MONTH        PIC 99.
   309             20  SLASH1-1              PIC X.
   310             20  DC-EDIT1-DAY          PIC 99.
   311             20  SLASH1-2              PIC X.
   312             20  DC-EDIT1-YEAR         PIC 99.
   313         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   314         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   315                     DC-GREG-DATE-2-EDIT.
   316             20  DC-EDIT2-MONTH        PIC 99.
   317             20  SLASH2-1              PIC X.
   318             20  DC-EDIT2-DAY          PIC 99.
   319             20  SLASH2-2              PIC X.
   320             20  DC-EDIT2-YEAR         PIC 99.
   321         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   322         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   323                     DC-GREG-DATE-1-YMD.
   324             20  DC-YMD-YEAR           PIC 99.
   325             20  DC-YMD-MONTH          PIC 99.
   326             20  DC-YMD-DAY            PIC 99.
   327         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   328         16  DC-GREG-DATE-1-MDY-R REDEFINES
   329                      DC-GREG-DATE-1-MDY.
   330             20  DC-MDY-MONTH          PIC 99.
   331             20  DC-MDY-DAY            PIC 99.
   332             20  DC-MDY-YEAR           PIC 99.
   333         16  DC-GREG-DATE-1-ALPHA.
   334             20  DC-ALPHA-MONTH        PIC X(10).
   335             20  DC-ALPHA-DAY          PIC 99.
   336             20  FILLER                PIC XX.
   337             20  DC-ALPHA-CENTURY.
   338                 24 DC-ALPHA-CEN-N     PIC 99.
   339             20  DC-ALPHA-YEAR         PIC 99.
   340         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   341         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   342         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   343         16  DC-JULIAN-DATE            PIC 9(05).
   344         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   345                                       PIC 9(05).
   346         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   347             20  DC-JULIAN-YEAR        PIC 99.
   348             20  DC-JULIAN-DAYS        PIC 999.
   349         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   350         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   351         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   352     12  DATE-CONVERSION-VARIBLES.
   353         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   354         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   355             20  FILLER                PIC 9(3).
   356             20  HOLD-CEN-1-CCYY.
   357                 24  HOLD-CEN-1-CC     PIC 99.
   358                 24  HOLD-CEN-1-YY     PIC 99.
   359             20  HOLD-CEN-1-MO         PIC 99.
   360             20  HOLD-CEN-1-DA         PIC 99.
   361         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   8
* NSAASBL.cbl
   362             20  HOLD-CEN-1-R-MO       PIC 99.
   363             20  HOLD-CEN-1-R-DA       PIC 99.
   364             20  HOLD-CEN-1-R-CCYY.
   365                 24  HOLD-CEN-1-R-CC   PIC 99.
   366                 24  HOLD-CEN-1-R-YY   PIC 99.
   367             20  FILLER                PIC 9(3).
   368         16  HOLD-CENTURY-1-X.
   369             20  FILLER                PIC X(3)  VALUE SPACES.
   370             20  HOLD-CEN-1-X-CCYY.
   371                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   372                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   373             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   374             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   375         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   376             20  HOLD-CEN-1-R-X-MO     PIC XX.
   377             20  HOLD-CEN-1-R-X-DA     PIC XX.
   378             20  HOLD-CEN-1-R-X-CCYY.
   379                 24  HOLD-CEN-1-R-X-CC PIC XX.
   380                 24  HOLD-CEN-1-R-X-YY PIC XX.
   381             20  FILLER                PIC XXX.
   382         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   383         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   384         16  DC-JULIAN-DATE-1          PIC 9(07).
   385         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   386             20  DC-JULIAN-1-CCYY.
   387                 24  DC-JULIAN-1-CC    PIC 99.
   388                 24  DC-JULIAN-1-YR    PIC 99.
   389             20  DC-JULIAN-DA-1        PIC 999.
   390         16  DC-JULIAN-DATE-2          PIC 9(07).
   391         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   392             20  DC-JULIAN-2-CCYY.
   393                 24  DC-JULIAN-2-CC    PIC 99.
   394                 24  DC-JULIAN-2-YR    PIC 99.
   395             20  DC-JULIAN-DA-2        PIC 999.
   396         16  DC-GREG-DATE-A-EDIT.
   397             20  DC-EDITA-MONTH        PIC 99.
   398             20  SLASHA-1              PIC X VALUE '/'.
   399             20  DC-EDITA-DAY          PIC 99.
   400             20  SLASHA-2              PIC X VALUE '/'.
   401             20  DC-EDITA-CCYY.
   402                 24  DC-EDITA-CENT     PIC 99.
   403                 24  DC-EDITA-YEAR     PIC 99.
   404         16  DC-GREG-DATE-B-EDIT.
   405             20  DC-EDITB-MONTH        PIC 99.
   406             20  SLASHB-1              PIC X VALUE '/'.
   407             20  DC-EDITB-DAY          PIC 99.
   408             20  SLASHB-2              PIC X VALUE '/'.
   409             20  DC-EDITB-CCYY.
   410                 24  DC-EDITB-CENT     PIC 99.
   411                 24  DC-EDITB-YEAR     PIC 99.
   412         16  DC-GREG-DATE-CYMD         PIC 9(08).
   413         16  DC-GREG-DATE-CYMD-R REDEFINES
   414                              DC-GREG-DATE-CYMD.
   415             20  DC-CYMD-CEN           PIC 99.
   416             20  DC-CYMD-YEAR          PIC 99.
   417             20  DC-CYMD-MONTH         PIC 99.
   418             20  DC-CYMD-DAY           PIC 99.
   419         16  DC-GREG-DATE-MDCY         PIC 9(08).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   9
* NSAASBL.cbl
   420         16  DC-GREG-DATE-MDCY-R REDEFINES
   421                              DC-GREG-DATE-MDCY.
   422             20  DC-MDCY-MONTH         PIC 99.
   423             20  DC-MDCY-DAY           PIC 99.
   424             20  DC-MDCY-CEN           PIC 99.
   425             20  DC-MDCY-YEAR          PIC 99.
   426    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   427        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   428    12  DC-EL310-DATE                  PIC X(21).
   429    12  FILLER                         PIC X(28).
   430*                                COPY ERCARCH.
   431******************************************************************
   432*                                                                *
   433*                            ERCARCH.                            *
   434*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   435*                            VMOD=2.002                          *
   436*                                                                *
   437*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
   438*                                                                *
   439*   FILE TYPE = VSAM,KSDS                                        *
   440*   RECORD SIZE = 250  RECFORM = FIXED                           *
   441*                                                                *
   442*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
   443*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
   444*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
   445*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
   446*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
   447*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
   448*                                                                *
   449*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   450******************************************************************
   451*                   C H A N G E   L O G
   452*
   453* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   454*-----------------------------------------------------------------
   455*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   456* EFFECTIVE    NUMBER
   457*-----------------------------------------------------------------
   458* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   459* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
   460* 110612    2012101700002  AJRA  ADD NEW FIELDS
   461******************************************************************
   462 01  LETTER-ARCHIVE.
   463     12  LA-RECORD-ID                PIC  X(02).
   464         88  LA-VALID-ID                VALUE 'LA'.
   465
   466     12  LA-CONTROL-PRIMARY.
   467         16  LA-COMPANY-CD           PIC  X(01).
   468         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
   469
   470     12  LA-CONTROL-BY-CERT-RESP.
   471         16  LA-COMPANY-CD-A2        PIC  X(01).
   472         16  LA-CERT-NO-A2.
   473             20  LA-CERT-PRIME-A2    PIC  X(10).
   474             20  LA-CERT-SUFFIX-A2   PIC  X(01).
   475         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
   476             20  LA-RESP-PERSON-A2   PIC  X(10).
   477             20  LA-TYPE-A2          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  10
* NSAASBL.cbl
   478         16  LA-CARRIER-A2           PIC  X(01).
   479         16  LA-GROUPING-A2          PIC  X(06).
   480         16  LA-STATE-A2             PIC  X(02).
   481         16  LA-ACCOUNT-A2           PIC  X(10).
   482         16  LA-EFFECT-DATE-A2       PIC  X(02).
   483         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
   484
   485     12  LA-CONTROL-BY-FORM.
   486         16  LA-COMPANY-CD-A3        PIC  X(01).
   487         16  LA-FORM-A3              PIC  X(04).
   488         16  LA-CARRIER-A3           PIC  X(01).
   489         16  LA-GROUPING-A3          PIC  X(06).
   490         16  LA-STATE-A3             PIC  X(02).
   491         16  LA-ACCOUNT-A3           PIC  X(10).
   492         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
   493
   494     12  LA-CONTROL-BY-PROCESSOR.
   495         16  LA-COMPANY-CD-A4        PIC  X(01).
   496         16  LA-PROCESSOR-CD         PIC  X(04).
   497         16  LA-CARRIER-A4           PIC  X(01).
   498         16  LA-GROUPING-A4          PIC  X(06).
   499         16  LA-STATE-A4             PIC  X(02).
   500         16  LA-ACCOUNT-A4           PIC  X(10).
   501         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
   502
   503     12  LA-CONTROL-BY-KEY-FIELDS.
   504         16  LA-COMPANY-CD-A5        PIC  X(01).
   505         16  LA-CARRIER-A5           PIC  X(01).
   506         16  LA-GROUPING-A5          PIC  X(06).
   507         16  LA-STATE-A5             PIC  X(02).
   508         16  LA-ACCOUNT-A5           PIC  X(10).
   509         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
   510
   511     12  LA-CONTROL-BY-GROUP-CODE.
   512         16  LA-COMPANY-CD-A6        PIC  X(01).
   513         16  LA-ENTRY-A6.
   514             20  LA-FILLER           PIC  X(02).
   515             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
   516         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
   517
   518     12  FILLER                      PIC  X(09).
   519
   520     12  LA-HEADER-RECORD.
   521         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
   522         16  LA-CREATION-DATE        PIC  X(02).
   523         16  LA-FOLLOW-UP-DATE       PIC  X(02).
   524         16  LA-FINAL-ACT-DATE       REDEFINES
   525               LA-FOLLOW-UP-DATE     PIC  X(02).
   526         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
   527         16  LA-NO-OF-COPIES         PIC S9(01).
   528         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
   529         16  LA-REPLY-DATE           PIC  X(02).
   530         16  LA-RESEND-DATES.
   531             20  LA-RESEND-DATE      PIC  X(02).
   532             20  LA-SENT-DATE        PIC  X(02).
   533             20  FILLER              PIC  X(08).
   534         16  LA-SOURCE-INFORMATION.
   535             20  LA-DATA-SOURCE      PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  11
* NSAASBL.cbl
   536             20  LA-ADDR-SOURCE      PIC  X(01).
   537         16  LA-STATUS               PIC  X(01).
   538             88  LA-STATUS-ACTIVE         VALUE 'A'.
   539             88  LA-STATUS-COMPLETED      VALUE 'C'.
   540             88  LA-STATUS-ON-HOLD        VALUE 'H'.
   541             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
   542             88  LA-STATUS-PURGED         VALUE 'P'.
   543             88  LA-STATUS-VOIDED         VALUE 'V'.
   544         16  LA-LAST-RESENT-PRINT-DATE
   545                                     PIC  X(02).
   546         16  LA-PRINT-RESTRICTION    PIC  X(01).
   547             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
   548                                          VALUE 'C'.
   549             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
   550                                          VALUE 'F'.
   551             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
   552                                          VALUE 'P'.
   553         16  LA-PURGED-DATE          PIC  X(02).
   554         16  LA-VOIDED-DATE          PIC  X(02).
   555         16  LA-RESEND-LETR          PIC  X(4).
   556         16  FILLER                  PIC  X(08).
   557*        16  LA-RESEND-LETR-2        PIC  X(4).
   558*        16  LA-RESEND-LETR-3        PIC  X(4).
   559*        16  FILLER                  PIC  X(59).
   560         16  LA-ARCHIVE-STATUS       PIC  X.
   561             88  LA-TEMP                VALUE 'T'.
   562             88  LA-QWS                 VALUE 'Q'.
   563             88  LA-BATCH               VALUE 'B'.
   564         16  LA-FINAL-ACT-IND        PIC  X(1).
   565         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
   566         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
   567         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
   568                                     PIC X(4).
   569         16  FILLER                  PIC  X(42).
   570*        16  FILLER                  PIC  X(71).
   571         16  LA-LAST-MAINT-DATE      PIC  X(2).
   572         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
   573         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
   574                                     PIC  X(4).
   575         16  LA-LAST-UPDATED-BY      PIC  X(4).
   576
   577******************************************************************
   578*                                COPY ERCENDT.
   579******************************************************************
   580*                                                                *
   581*                                                                *
   582*                            ERCENDT.                            *
   583*                            VMOD=2.001                          *
   584*                                                                *
   585*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
   586*                                                                *
   587*   FILE TYPE = VSAM,KSDS                                        *
   588*   RECORD SIZE = 579  RECFORM = FIXED                           *
   589*                                                                *
   590*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
   591*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
   592*                                                                *
   593*   LOG = NO                                                     *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  12
* NSAASBL.cbl
   594*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   595******************************************************************
   596*-----------------------------------------------------------------
   597*                   C H A N G E   L O G
   598*
   599* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   600*-----------------------------------------------------------------
   601*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   602* EFFECTIVE    NUMBER
   603*-----------------------------------------------------------------
   604* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
   605*                                WITH OPEN CLAIMS
   606* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
   607* 110612    2012101700002  AJRA  ADD NEW FIELDS
   608* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   609* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
   610*-----------------------------------------------------------------
   611 01  ENDORSEMENT-RECORD.
   612     12  EN-RECORD-ID                PIC XX.
   613         88  VALID-EN-ID                VALUE 'EN'.
   614     12  EN-CONTROL-PRIMARY.
   615         16  EN-COMPANY-CD           PIC X.
   616         16  EN-CARRIER              PIC X.
   617         16  EN-GROUPING             PIC X(6).
   618         16  EN-STATE                PIC XX.
   619         16  EN-ACCOUNT              PIC X(10).
   620         16  EN-CERT-EFF-DT          PIC XX.
   621         16  EN-CERT-NO.
   622             20  EN-CERT-PRIME       PIC X(10).
   623             20  EN-CERT-SFX         PIC X.
   624         16  EN-REC-TYPE             PIC X.
   625             88  EN-ISSUE               VALUE 'I'.
   626             88  EN-CANCELLATION        VALUE 'C'.
   627         16  EN-SEQ-NO               PIC 9(04) BINARY.
   628     12  EN-CONTROL-BY-ARCH-NO.
   629         16  EN-COMPANY-CD-A1              PIC X.
   630         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
   631     12  EN-LAST-MAINT-DT            PIC XX.
   632     12  EN-LAST-MAINT-BY            PIC X(4).
   633     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
   634     12  EN-ENDORSEMENT-RECORD       PIC X(329).
   635     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
   636         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
   637         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
   638         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
   639         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
   640         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
   641         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
   642         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
   643         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
   644         16  EN-LF-ORIG-BENCD        PIC XX.
   645         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
   646         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
   647         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
   648         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   649         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   650         16  EN-LF-ORIG-EXP-DT       PIC XX.
   651*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  13
* NSAASBL.cbl
   652         16  EN-ORIG-CRED-BENE       PIC X(25).
   653         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
   654         16  FILLER                  PIC X.
   655         16  EN-AH-ORIG-BENCD        PIC XX.
   656         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
   657         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
   658         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
   659         16  EN-AH-ORIG-EXP-DT       PIC XX.
   660*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
   661*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
   662         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
   663         16  F                       PIC X(09).
   664         16  EN-AH-ORIG-CP           PIC 99.
   665         16  EN-INS-NEW-LAST-NAME    PIC X(15).
   666         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
   667         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
   668         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
   669         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
   670         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
   671         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
   672         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
   673         16  EN-LF-NEW-BENCD         PIC XX.
   674         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
   675         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
   676         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
   677         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
   678         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
   679         16  EN-LF-NEW-EXP-DT        PIC XX.
   680         16  EN-NEW-CRED-BENE        PIC X(25).
   681         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
   682         16  FILLER                  PIC X.
   683         16  EN-AH-NEW-BENCD         PIC XX.
   684         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
   685         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
   686         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
   687         16  EN-AH-NEW-EXP-DT        PIC XX.
   688*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
   689*        16  EN-AH-NEW-WAIT-PER      PIC 99.
   690*        16  F                       PIC X(12).
   691         16  EN-AH-NEW-CP            PIC 99.
   692         16  EN-SIG-SW               PIC X.
   693         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
   694         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
   695         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
   696         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
   697         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
   698         16  FILLER                  PIC X(33).
   699     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
   700         16  EN-LF-ORIG-REF-DT       PIC XX.
   701         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
   702         16  EN-AH-ORIG-REF-DT       PIC XX.
   703         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
   704         16  EN-LF-NEW-REF-DT        PIC XX.
   705         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
   706         16  EN-AH-NEW-REF-DT        PIC XX.
   707         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
   708         16  EN-FLAG-CERT            PIC X.
   709         16  EN-INS-LAST-NAME        PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  14
* NSAASBL.cbl
   710         16  EN-INS-FIRST-NAME       PIC X(10).
   711         16  EN-INS-MIDDLE-INIT      PIC X.
   712         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
   713         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
   714         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
   715         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
   716         16  FILLER                  PIC X(262).
   717     12  EN-MONEY-SW             PIC X.
   718     12  EN-HEALTH-APP           PIC X.
   719     12  EN-VOUCHER-SW           PIC X.
   720     12  EN-PAYEE                PIC X(14).
   721     12  EN-INPUT-DT             PIC XX.
   722     12  EN-PROCESS-DT           PIC XX.
   723     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
   724     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
   725     12  EN-REASON-CODES.
   726         16  F OCCURS 12.
   727             20  EN-REASON-CODE  PIC X(4).
   728     12  EN-TEMPLATE-USED        PIC X(8).
   729     12  EN-DOCU-TYPE            PIC X.
   730         88  EN-VERI-DOCU          VALUE 'V'.
   731         88  EN-GCE-DOCU           VALUE 'G'.
   732         88  EN-CANC-DOCU          VALUE 'C'.
   733     12  EN-COMMENTS1            PIC X(13).
   734     12  EN-COMMENTS2            PIC X(70).
   735     12  EN-COMM-CHGBK           PIC X.
   736         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
   737         88  EN-CHG-ACCT           VALUE 'Y'.
   738     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
   739     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
   740     12  EN-BATCH-NUMBER         PIC X(6).
   741     12  EN-ACCT-SUMM            PIC X.
   742     12  EN-CSO-SUMM             PIC X.
   743     12  en-check-type           pic x.
   744     12  FILLER                  PIC X(12).
   745******************************************************************
   746*                                COPY NSCASEXTR.
   747******************************************************************
   748*                                                                *
   749*                                                                *
   750*                            NSCASEXTR.                          *
   751*                            VMOD=2.001                          *
   752*                                                                *
   753*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   754*                                                                *
   755*   FILE TYPE = VSAM,KSDS                                        *
   756*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   757*                                                                *
   758*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   759*                                                                *
   760*   LOG = NO                                                     *
   761*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   762******************************************************************
   763*-----------------------------------------------------------------
   764*                   C H A N G E   L O G
   765*
   766* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   767*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  15
* NSAASBL.cbl
   768*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   769* EFFECTIVE    NUMBER
   770*-----------------------------------------------------------------
   771* 072211    2011022800001  PEMA  NEW FILE
   772*-----------------------------------------------------------------
   773 01 NSAS-EXTRACT-RECORD.
   774    05  NSAS-CONTROL-PRIMARY.
   775        10  NSAS-COMPANY-CD      PIC X.
   776        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   777        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   778    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   779    05  FILLER                   PIC X(143).
   780*                                COPY ERCNOTE.
   781******************************************************************
   782*                                                                *
   783*                                                                *
   784*                            ERCNOTE                             *
   785*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   786*                            VMOD=2.003                          *
   787*                                                                *
   788*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
   789*                                                                *
   790*        FILE TYPE= VSAM,KSDS                                    *
   791*        RECORD SIZE = 825    RECFORM = FIXED                    *
   792*                                                                *
   793*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
   794*                                                                *
   795*        LOG = YES                                               *
   796*        SERVREQ = DELETE,UPDATE,NEWREC                          *
   797*                                                                *
   798******************************************************************
   799*                   C H A N G E   L O G
   800*
   801* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   802*-----------------------------------------------------------------
   803*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   804* EFFECTIVE    NUMBER
   805*-----------------------------------------------------------------
   806* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
   807*                                FILE WILL CONTAIN BILLING NOTES O
   808******************************************************************
   809
   810 01  CERTIFICATE-NOTE.
   811     12  CN-RECORD-ID                PIC  XX.
   812         88  VALID-CN-ID                  VALUE 'CN'.
   813
   814     12  CN-CONTROL-PRIMARY.
   815         16  CN-COMPANY-CD           PIC X.
   816         16  CN-CARRIER              PIC X.
   817         16  CN-GROUPING.
   818             20 CN-GROUPING-PREFIX   PIC XXX.
   819             20 CN-GROUPING-PRIME    PIC XXX.
   820         16  CN-STATE                PIC XX.
   821         16  CN-ACCOUNT.
   822             20 CN-ACCOUNT-PREFIX    PIC X(4).
   823             20 CN-ACCOUNT-PRIME     PIC X(6).
   824         16  CN-CERT-EFF-DT          PIC XX.
   825         16  CN-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  16
* NSAASBL.cbl
   826             20  CN-CERT-PRIME       PIC X(10).
   827             20  CN-CERT-SFX         PIC X.
   828
   829     12  CN-BILLING-START-LINE-NO    PIC 99.
   830     12  CN-BILLING-END-LINE-NO      PIC 99.
   831
   832     12  CN-LINES.
   833         16  CN-LINE OCCURS 10       PIC X(77).
   834
   835     12  CN-LAST-MAINT-DT            PIC XX.
   836     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
   837     12  CN-LAST-MAINT-USER          PIC X(4).
   838     12  FILLER                      PIC X(6).
   839******************************************************************
   840*                                COPY ELCEOBC.
   841******************************************************************
   842*                                                                *
   843*                                                                *
   844*                            ELCEOBC                             *
   845*                            VMOD=2.001                          *
   846*                                                                *
   847*   CLAIM SYSTEM EOB CODE TABLE                                  *
   848*                                                                *
   849*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   850*   VSAM EOB CODE TABLE                                          *
   851*                                                                *
   852*   FILE DESCRIPTION = EOB CODE TABLE                            *
   853*                                                                *
   854*   FILE TYPE = VSAM,KSDS                                        *
   855*   RECORD SIZE = 350   RECFORM = FIX                            *
   856*                                                                *
   857*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
   858*                                                                *
   859*   LOG = NO                                                     *
   860*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   861*                                                                *
   862*                                                                *
   863******************************************************************
   864*                   C H A N G E   L O G
   865*
   866* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   867*-----------------------------------------------------------------
   868*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   869* EFFECTIVE    NUMBER
   870*-----------------------------------------------------------------
   871* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
   872* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
   873* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
   874******************************************************************
   875 01  EOB-CODES.
   876     12  EO-RECORD-ID                      PIC XX.
   877         88  VALID-DN-ID                      VALUE 'EO'.
   878     12  EO-CONTROL-PRIMARY.
   879         16  EO-COMPANY-CD                 PIC X.
   880         16  EO-RECORD-TYPE                PIC X.
   881             88  EO-EOB-RECS                  VALUE '1'.
   882             88  EO-VERIF-RECS                VALUE '2'.
   883             88  EO-GCE-RECS                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  17
* NSAASBL.cbl
   884             88  EO-CANC-RECS                 VALUE '4'.
   885             88  EO-BILL-NOTE-RECS            VALUE '5'.
   886         16  EO-EOB-CODE                   PIC X(4).
   887         16  FILLER                        PIC X(9).
   888     12  EO-MAINT-INFORMATION.
   889         16  EO-LAST-MAINT-DT              PIC XX.
   890         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   891         16  EO-LAST-MAINT-USER            PIC X(4).
   892         16  FILLER                        PIC XX.
   893     12  EO-DESCRIPTION                    PIC X(275).
   894     12  FILLER                            PIC X(46).
   895******************************************************************
   896*                                COPY ELCCERT.
   897******************************************************************
   898*                                                                *
   899*                            ELCCERT.                            *
   900*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   901*                            VMOD=2.013                          *
   902*                                                                *
   903*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   904*                                                                *
   905*   FILE TYPE = VSAM,KSDS                                        *
   906*   RECORD SIZE = 450  RECFORM = FIXED                           *
   907*                                                                *
   908*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   909*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   910*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   911*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   912*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   913*                                                                *
   914*   LOG = YES                                                    *
   915*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   916******************************************************************
   917*                   C H A N G E   L O G
   918*
   919* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   920*-----------------------------------------------------------------
   921*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   922* EFFECTIVE    NUMBER
   923*-----------------------------------------------------------------
   924* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   925* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   926* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   927* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   928* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   929* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   930* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   931* 032612  CR2011110200001  PEMA  AHL CHANGES
   932* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   933* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   934******************************************************************
   935
   936 01  CERTIFICATE-MASTER.
   937     12  CM-RECORD-ID                      PIC XX.
   938         88  VALID-CM-ID                      VALUE 'CM'.
   939
   940     12  CM-CONTROL-PRIMARY.
   941         16  CM-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  18
* NSAASBL.cbl
   942         16  CM-CARRIER                    PIC X.
   943         16  CM-GROUPING.
   944             20  CM-GROUPING-PREFIX        PIC X(3).
   945             20  CM-GROUPING-PRIME         PIC X(3).
   946         16  CM-STATE                      PIC XX.
   947         16  CM-ACCOUNT.
   948             20  CM-ACCOUNT-PREFIX         PIC X(4).
   949             20  CM-ACCOUNT-PRIME          PIC X(6).
   950         16  CM-CERT-EFF-DT                PIC XX.
   951         16  CM-CERT-NO.
   952             20  CM-CERT-PRIME             PIC X(10).
   953             20  CM-CERT-SFX               PIC X.
   954
   955     12  CM-CONTROL-BY-NAME.
   956         16  CM-COMPANY-CD-A1              PIC X.
   957         16  CM-INSURED-LAST-NAME          PIC X(15).
   958         16  CM-INSURED-INITIALS.
   959             20  CM-INSURED-INITIAL1       PIC X.
   960             20  CM-INSURED-INITIAL2       PIC X.
   961
   962     12  CM-CONTROL-BY-SSN.
   963         16  CM-COMPANY-CD-A2              PIC X.
   964         16  CM-SOC-SEC-NO.
   965             20  CM-SSN-STATE              PIC XX.
   966             20  CM-SSN-ACCOUNT            PIC X(6).
   967             20  CM-SSN-LN3.
   968                 25  CM-INSURED-INITIALS-A2.
   969                     30 CM-INSURED-INITIAL1-A2   PIC X.
   970                     30 CM-INSURED-INITIAL2-A2   PIC X.
   971                 25 CM-PART-LAST-NAME-A2         PIC X.
   972
   973     12  CM-CONTROL-BY-CERT-NO.
   974         16  CM-COMPANY-CD-A4              PIC X.
   975         16  CM-CERT-NO-A4                 PIC X(11).
   976
   977     12  CM-CONTROL-BY-MEMB.
   978         16  CM-COMPANY-CD-A5              PIC X.
   979         16  CM-MEMBER-NO.
   980             20  CM-MEMB-STATE             PIC XX.
   981             20  CM-MEMB-ACCOUNT           PIC X(6).
   982             20  CM-MEMB-LN4.
   983                 25  CM-INSURED-INITIALS-A5.
   984                     30 CM-INSURED-INITIAL1-A5   PIC X.
   985                     30 CM-INSURED-INITIAL2-A5   PIC X.
   986                 25 CM-PART-LAST-NAME-A5         PIC XX.
   987
   988     12  CM-INSURED-PROFILE-DATA.
   989         16  CM-INSURED-FIRST-NAME.
   990             20  CM-INSURED-1ST-INIT       PIC X.
   991             20  FILLER                    PIC X(9).
   992         16  CM-INSURED-ISSUE-AGE          PIC 99.
   993         16  CM-INSURED-SEX                PIC X.
   994             88  CM-SEX-MALE                  VALUE 'M'.
   995             88  CM-SEX-FEMAL                 VALUE 'F'.
   996         16  CM-INSURED-JOINT-AGE          PIC 99.
   997         16  CM-JOINT-INSURED-NAME.
   998             20  CM-JT-LAST-NAME           PIC X(15).
   999             20  CM-JT-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  19
* NSAASBL.cbl
  1000                 24  CM-JT-1ST-INIT        PIC X.
  1001                 24  FILLER                PIC X(9).
  1002             20  CM-JT-INITIAL             PIC X.
  1003
  1004     12  CM-LIFE-DATA.
  1005         16  CM-LF-BENEFIT-CD              PIC XX.
  1006         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1007         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1008         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1009         16  CM-LF-DEV-CODE                PIC XXX.
  1010         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1011         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1012         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1013         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1014         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1015         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1016         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1017         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1018         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1019         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1020         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1021         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1022         16  cm-temp-epiq                  pic xx.
  1023             88  EPIQ-CLASS                  value 'EQ'.
  1024*        16  FILLER                        PIC XX.
  1025
  1026     12  CM-AH-DATA.
  1027         16  CM-AH-BENEFIT-CD              PIC XX.
  1028         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1029         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1030         16  CM-AH-DEV-CODE                PIC XXX.
  1031         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1032         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1033         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1034         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1035         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1036         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1037         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1038         16  CM-AH-PAID-THRU-DT            PIC XX.
  1039             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1040         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1041         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1042         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1043         16  FILLER                        PIC X.
  1044
  1045     12  CM-LOAN-INFORMATION.
  1046         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1047         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1048                                           PIC S9(5)V99  COMP-3.
  1049         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1050         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1051         16  CM-PAY-FREQUENCY              PIC S99.
  1052         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1053         16  CM-RATE-CLASS                 PIC XX.
  1054         16  CM-BENEFICIARY                PIC X(25).
  1055         16  CM-POLICY-FORM-NO             PIC X(12).
  1056         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1057         16  CM-LAST-ADD-ON-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  20
* NSAASBL.cbl
  1058         16  CM-DEDUCTIBLE-AMOUNTS.
  1059             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1060             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1061         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1062             20  CM-RESIDENT-STATE         PIC XX.
  1063             20  CM-RATE-CODE              PIC X(4).
  1064             20  FILLER                    PIC XX.
  1065         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1066             20  CM-LOAN-OFFICER           PIC X(5).
  1067             20  FILLER                    PIC XXX.
  1068         16  CM-CSR-CODE                   PIC XXX.
  1069         16  CM-UNDERWRITING-CODE          PIC X.
  1070             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1071         16  CM-POST-CARD-IND              PIC X.
  1072         16  CM-NH-INTERFACE-SW            PIC X.
  1073         16  CM-PREMIUM-TYPE               PIC X.
  1074             88  CM-SING-PRM                  VALUE '1'.
  1075             88  CM-O-B-COVERAGE              VALUE '2'.
  1076             88  CM-OPEN-END                  VALUE '3'.
  1077         16  CM-IND-GRP-TYPE               PIC X.
  1078             88  CM-INDIVIDUAL                VALUE 'I'.
  1079             88  CM-GROUP                     VALUE 'G'.
  1080         16  CM-SKIP-CODE                  PIC X.
  1081             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1082             88  SKIP-JULY                    VALUE '1'.
  1083             88  SKIP-AUGUST                  VALUE '2'.
  1084             88  SKIP-SEPTEMBER               VALUE '3'.
  1085             88  SKIP-JULY-AUG                VALUE '4'.
  1086             88  SKIP-AUG-SEPT                VALUE '5'.
  1087             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1088             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1089             88  SKIP-JUNE                    VALUE '8'.
  1090             88  SKIP-JUNE-JULY               VALUE '9'.
  1091             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1092             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1093         16  CM-PAYMENT-MODE               PIC X.
  1094             88  PAY-MONTHLY                  VALUE SPACE.
  1095             88  PAY-WEEKLY                   VALUE '1'.
  1096             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1097             88  PAY-BI-WEEKLY                VALUE '3'.
  1098             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1099         16  CM-LOAN-NUMBER                PIC X(8).
  1100         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1101         16  CM-OLD-LOF                    PIC XXX.
  1102*        16  CM-LOAN-OFFICER               PIC XXX.
  1103         16  CM-REIN-TABLE                 PIC XXX.
  1104         16  CM-SPECIAL-REIN-CODE          PIC X.
  1105         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1106         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1107         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1108
  1109     12  CM-STATUS-DATA.
  1110         16  CM-ENTRY-STATUS               PIC X.
  1111         16  CM-ENTRY-DT                   PIC XX.
  1112
  1113         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1114         16  CM-LF-CANCEL-DT               PIC XX.
  1115         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  21
* NSAASBL.cbl
  1116
  1117         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1118         16  CM-LF-DEATH-DT                PIC XX.
  1119         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1120
  1121         16  CM-LF-CURRENT-STATUS          PIC X.
  1122             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1123                                                'M' '4' '5' '9'.
  1124             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1125             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1126             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1127             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1128             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1129             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1130             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1131             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1132             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1133             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1134             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1135             88  CM-LF-DECLINED               VALUE 'D'.
  1136             88  CM-LF-VOIDED                 VALUE 'V'.
  1137
  1138         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1139         16  CM-AH-CANCEL-DT               PIC XX.
  1140         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1141
  1142         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1143         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1144         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1145
  1146         16  CM-AH-CURRENT-STATUS          PIC X.
  1147             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1148                                                'M' '4' '5' '9'.
  1149             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1150             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1151             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1152             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1153             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1154             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1155             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1156             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1157             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1158             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1159             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1160             88  CM-AH-DECLINED               VALUE 'D'.
  1161             88  CM-AH-VOIDED                 VALUE 'V'.
  1162
  1163         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1164             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1165             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1166             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1167         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1168
  1169         16  CM-ENTRY-BATCH                PIC X(6).
  1170         16  CM-LF-EXIT-BATCH              PIC X(6).
  1171         16  CM-AH-EXIT-BATCH              PIC X(6).
  1172         16  CM-LAST-MONTH-END             PIC XX.
  1173
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  22
* NSAASBL.cbl
  1174     12  CM-NOTE-SW                        PIC X.
  1175         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1176         88  CERT-NOTES-PRESENT               VALUE '1'.
  1177         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1178         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1179         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1180         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1181         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1182         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1183     12  CM-COMP-EXCP-SW                   PIC X.
  1184         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1185         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1186     12  CM-INSURED-ADDRESS-SW             PIC X.
  1187         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1188         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1189
  1190*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1191     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1192     12  FILLER                            PIC X.
  1193
  1194*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1195     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1196     12  FILLER                            PIC X.
  1197*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1198     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  1199
  1200     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1201         88  CERT-ADDED-BATCH                 VALUE ' '.
  1202         88  CERT-ADDED-ONLINE                VALUE '1'.
  1203         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1204         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1205         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1206     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1207         88  CERT-AS-LOADED                   VALUE ' '.
  1208         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1209         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1210         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1211         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1212         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1213         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1214         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1215
  1216     12  CM-ACCOUNT-COMM-PCTS.
  1217         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1218         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1219
  1220     12  CM-USER-FIELD                     PIC X.
  1221     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1222     12  CM-CLP-STATE                      PIC XX.
  1223     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1224     12  CM-USER-RESERVED                  PIC XXX.
  1225     12  FILLER REDEFINES CM-USER-RESERVED.
  1226         16  CM-AH-CLASS-CD                PIC XX.
  1227         16  F                             PIC X.
  1228******************************************************************
  1229****************************************************************
  1230*
  1231* Copyright (c) 2007 by Clerity Solutions, Inc.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  23
* NSAASBL.cbl
  1232* All rights reserved.
  1233*
  1234****************************************************************
  1235 01  DFHEIV.
  1236   02  DFHEIV0               PIC X(35).
  1237   02  DFHEIV1               PIC X(08).
  1238   02  DFHEIV2               PIC X(08).
  1239   02  DFHEIV3               PIC X(08).
  1240   02  DFHEIV4               PIC X(06).
  1241   02  DFHEIV5               PIC X(04).
  1242   02  DFHEIV6               PIC X(04).
  1243   02  DFHEIV7               PIC X(02).
  1244   02  DFHEIV8               PIC X(02).
  1245   02  DFHEIV9               PIC X(01).
  1246   02  DFHEIV10              PIC S9(7) COMP-3.
  1247   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1248   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1249   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1250   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1251   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1252   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1253   02  DFHEIV17              PIC X(04).
  1254   02  DFHEIV18              PIC X(04).
  1255   02  DFHEIV19              PIC X(04).
  1256   02  DFHEIV20              USAGE IS POINTER.
  1257   02  DFHEIV21              USAGE IS POINTER.
  1258   02  DFHEIV22              USAGE IS POINTER.
  1259   02  DFHEIV23              USAGE IS POINTER.
  1260   02  DFHEIV24              USAGE IS POINTER.
  1261   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1262   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1263   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1264   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1265   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1266   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1267   02  FILLER                PIC X(02).
  1268   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1269   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1270   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1271   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1272   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1273 LINKAGE  SECTION.
  1274*****************************************************************
  1275*                                                               *
  1276* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1277* All rights reserved.                                          *
  1278*                                                               *
  1279*****************************************************************
  1280 01  dfheiblk.
  1281     02  eibtime          pic s9(7) comp-3.
  1282     02  eibdate          pic s9(7) comp-3.
  1283     02  eibtrnid         pic x(4).
  1284     02  eibtaskn         pic s9(7) comp-3.
  1285     02  eibtrmid         pic x(4).
  1286     02  dfheigdi         pic s9(4) comp.
  1287     02  eibcposn         pic s9(4) comp.
  1288     02  eibcalen         pic s9(4) comp.
  1289     02  eibaid           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  24
* NSAASBL.cbl
  1290     02  eibfiller1       pic x(1).
  1291     02  eibfn            pic x(2).
  1292     02  eibfiller2       pic x(2).
  1293     02  eibrcode         pic x(6).
  1294     02  eibfiller3       pic x(2).
  1295     02  eibds            pic x(8).
  1296     02  eibreqid         pic x(8).
  1297     02  eibrsrce         pic x(8).
  1298     02  eibsync          pic x(1).
  1299     02  eibfree          pic x(1).
  1300     02  eibrecv          pic x(1).
  1301     02  eibsend          pic x(1).
  1302     02  eibatt           pic x(1).
  1303     02  eibeoc           pic x(1).
  1304     02  eibfmh           pic x(1).
  1305     02  eibcompl         pic x(1).
  1306     02  eibsig           pic x(1).
  1307     02  eibconf          pic x(1).
  1308     02  eiberr           pic x(1).
  1309     02  eibrldbk         pic x(1).
  1310     02  eiberrcd         pic x(4).
  1311     02  eibsynrb         pic x(1).
  1312     02  eibnodat         pic x(1).
  1313     02  eibfiller5       pic x(2).
  1314     02  eibresp          pic 9(09) comp.
  1315     02  eibresp2         pic 9(09) comp.
  1316     02  dfheigdj         pic s9(4) comp.
  1317     02  dfheigdk         pic s9(4) comp.
  1318 01 dfhcommarea                  pic x(218).
  1319 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1320 0000-DFHEXIT SECTION.
  1321     MOVE '9#                    $   ' TO DFHEIV0.
  1322     MOVE 'NSAASBL' TO DFHEIV1.
  1323     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1324     display ' entering nsaasbl '
  1325     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1326     MOVE '5'                    TO DC-OPTION-CODE
  1327     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  1328     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE
  1329     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE
  1330     MOVE DFHCOMMAREA            TO BL-INPUT
  1331*****************************************************
  1332* Using the information passed to this program,
  1333* it will update the erarch record with a "Q"
  1334* in the status field
  1335*****************************************************
  1336*    DISPLAY ' BL INPUT ' BL-INPUT
  1337     evaluate bl-comp-id
  1338        when 'DCC'
  1339           move X'05'            to ws-erarch-company-cd
  1340        when 'AHL'
  1341           move X'06'            to ws-erarch-company-cd
  1342        when 'VPP'
  1343           move X'07'            to ws-erarch-company-cd
  1344        when other
  1345           move X'04'            to ws-erarch-company-cd
  1346     end-evaluate
  1347     MOVE WS-ERARCH-COMPANY-CD   TO WS-ERENDT-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  25
* NSAASBL.cbl
  1348                                    WS-EXTR-COMPANY-CD
  1349     MOVE BL-ARCHIVE-NO          TO WS-ERARCH-ARCH-NO
  1350                                    WS-ERENDT-ARCH-NO
  1351                                    WS-EXTR-ARCH-NO
  1352     SET BL-FAIL TO TRUE
  1353
  1354* EXEC CICS READ
  1355*         DATASET    ('ERARCH')
  1356*         INTO       (LETTER-ARCHIVE)
  1357*         RIDFLD     (WS-ERARCH-KEY)
  1358*         UPDATE
  1359*         RESP       (WS-RESPONSE)
  1360*    END-EXEC
  1361     MOVE LENGTH OF
  1362      LETTER-ARCHIVE
  1363       TO DFHEIV11
  1364     MOVE 'ERARCH' TO DFHEIV1
  1365*    MOVE '&"IL       EU         (  N#00001349' TO DFHEIV0
  1366     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1367     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1368     MOVE X'204E233030303031333439' TO DFHEIV0(25:11)
  1369     CALL 'kxdfhei1' USING DFHEIV0,
  1370           DFHEIV1,
  1371           LETTER-ARCHIVE,
  1372           DFHEIV11,
  1373           WS-ERARCH-KEY,
  1374           DFHEIV99,
  1375           DFHEIV99,
  1376           DFHEIV99
  1377     MOVE EIBRESP  TO WS-RESPONSE
  1378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1379     IF RESP-NORMAL
  1380        SET BL-OK TO TRUE
  1381        IF (BL-PRINT-NOW-SW = 'P')
  1382           or (bl-process-type = 'cancel')
  1383           PERFORM 0050-DELETE-RECORDS
  1384                                 THRU 0050-EXIT
  1385        ELSE
  1386           IF BL-PROCESS-TYPE = 'process'
  1387              MOVE LA-COMPANY-CD-A2 TO WS-SV-COMPANY-CD
  1388              MOVE LA-CARRIER-A2    TO WS-SV-CARRIER
  1389              MOVE LA-GROUPING-A2   TO WS-SV-GROUPING
  1390              MOVE LA-STATE-A2      TO WS-SV-STATE
  1391              MOVE LA-ACCOUNT-A2    TO WS-SV-ACCOUNT
  1392              MOVE LA-EFFECT-DATE-A2 TO WS-SV-CERT-EFF-DT
  1393              MOVE LA-CERT-PRIME-A2 TO WS-SV-CERT-PRIME
  1394              MOVE LA-CERT-SUFFIX-A2 TO WS-SV-CERT-SFX
  1395              MOVE LA-FORM-A3       TO WS-SV-LETTER-ID
  1396              MOVE LA-PROCESSOR-CD  TO WS-SV-PROC-ID
  1397              MOVE 'Q'           TO LA-ARCHIVE-STATUS
  1398              IF BL-PRINT-NOW-SW = 'Y'
  1399                 MOVE SAVE-BIN-DATE TO LA-INITIAL-PRINT-DATE
  1400                 IF (LA-RESEND-DATE EQUAL LOW-VALUES OR SPACES)
  1401                  AND (LA-FOLLOW-UP-DATE EQUAL
  1402                                 LOW-VALUES OR SPACES)
  1403                    MOVE 'C'             TO LA-STATUS
  1404                 END-IF
  1405              END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  26
* NSAASBL.cbl
  1406           ELSE
  1407              MOVE 'T'           TO LA-ARCHIVE-STATUS
  1408           END-IF
  1409        END-IF
  1410
  1411* EXEC CICS REWRITE
  1412*          FROM      (LETTER-ARCHIVE)
  1413*          DATASET   ('ERARCH')
  1414*          RESP       (WS-RESPONSE)
  1415*       END-EXEC
  1416     MOVE LENGTH OF
  1417      LETTER-ARCHIVE
  1418       TO DFHEIV11
  1419     MOVE 'ERARCH' TO DFHEIV1
  1420*    MOVE '&& L                  %  N#00001387' TO DFHEIV0
  1421     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1422     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1423     MOVE X'204E233030303031333837' TO DFHEIV0(25:11)
  1424     CALL 'kxdfhei1' USING DFHEIV0,
  1425           DFHEIV1,
  1426           LETTER-ARCHIVE,
  1427           DFHEIV11,
  1428           DFHEIV99
  1429     MOVE EIBRESP  TO WS-RESPONSE
  1430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1431        IF BL-PROCESS-TYPE = 'process'
  1432           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  1433        END-IF
  1434     ELSE
  1435        MOVE ' BAD READ UPDATE ON ERARCH '
  1436                                 TO BL-MESSAGE
  1437        display ' bad read on erarch ' ws-response
  1438          ' ' bl-archive-no
  1439     END-IF
  1440     MOVE BL-INPUT               TO DFHCOMMAREA
  1441
  1442* exec cics return end-exec.
  1443*    MOVE '.(                    ''   #00001402' TO DFHEIV0
  1444     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1445     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1446     MOVE X'2020233030303031343032' TO DFHEIV0(25:11)
  1447     CALL 'kxdfhei1' USING DFHEIV0,
  1448           DFHEIV99,
  1449           DFHEIV99,
  1450           DFHEIV99,
  1451           DFHEIV99,
  1452           DFHEIV99,
  1453           DFHEIV99
  1454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1455
  1456 0050-DELETE-RECORDS.
  1457     DISPLAY ' ABOUT TO DELETE RECS ' BL-ARCHIVE-NO ' ' BL-FUNC
  1458     IF BL-FUNC = 'ClmResc' or 'ClmRefo'
  1459        display ' bypass delete ' bl-func
  1460        go to 0050-exit
  1461     end-if
  1462
  1463* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  27
* NSAASBL.cbl
  1464*       DATASET    ('ERARCH')
  1465*       RESP       (WS-RESPONSE)
  1466*    END-EXEC
  1467     MOVE 'ERARCH' TO DFHEIV1
  1468*    MOVE '&(                    &  N#00001409' TO DFHEIV0
  1469     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1470     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1471     MOVE X'204E233030303031343039' TO DFHEIV0(25:11)
  1472     CALL 'kxdfhei1' USING DFHEIV0,
  1473           DFHEIV1,
  1474           DFHEIV99,
  1475           DFHEIV99,
  1476           DFHEIV99,
  1477           DFHEIV99
  1478     MOVE EIBRESP  TO WS-RESPONSE
  1479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1480     IF NOT RESP-NORMAL
  1481        DISPLAY ' BAD DELETE ERARCH ' WS-RESPONSE
  1482        GO TO 0050-EXIT
  1483     END-IF
  1484
  1485* EXEC CICS READ
  1486*         DATASET    ('ERENDT2')
  1487*         INTO       (ENDORSEMENT-RECORD)
  1488*         RIDFLD     (WS-ERENDT2-KEY)
  1489*         UPDATE
  1490*         RESP       (WS-RESPONSE)
  1491*    END-EXEC
  1492     MOVE LENGTH OF
  1493      ENDORSEMENT-RECORD
  1494       TO DFHEIV11
  1495     MOVE 'ERENDT2' TO DFHEIV1
  1496*    MOVE '&"IL       EU         (  N#00001417' TO DFHEIV0
  1497     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1498     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1499     MOVE X'204E233030303031343137' TO DFHEIV0(25:11)
  1500     CALL 'kxdfhei1' USING DFHEIV0,
  1501           DFHEIV1,
  1502           ENDORSEMENT-RECORD,
  1503           DFHEIV11,
  1504           WS-ERENDT2-KEY,
  1505           DFHEIV99,
  1506           DFHEIV99,
  1507           DFHEIV99
  1508     MOVE EIBRESP  TO WS-RESPONSE
  1509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1510     IF NOT RESP-NORMAL
  1511        DISPLAY ' BAD READ ON ERENDT2 ' WS-RESPONSE
  1512     ELSE
  1513
  1514* EXEC CICS DELETE
  1515*          DATASET    ('ERENDT2')
  1516*          RESP       (WS-RESPONSE)
  1517*       END-EXEC
  1518     MOVE 'ERENDT2' TO DFHEIV1
  1519*    MOVE '&(                    &  N#00001427' TO DFHEIV0
  1520     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1521     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  28
* NSAASBL.cbl
  1522     MOVE X'204E233030303031343237' TO DFHEIV0(25:11)
  1523     CALL 'kxdfhei1' USING DFHEIV0,
  1524           DFHEIV1,
  1525           DFHEIV99,
  1526           DFHEIV99,
  1527           DFHEIV99,
  1528           DFHEIV99
  1529     MOVE EIBRESP  TO WS-RESPONSE
  1530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1531        IF NOT RESP-NORMAL
  1532           DISPLAY ' BAD DELETE ON ERENDT2 ' WS-RESPONSE
  1533        END-IF
  1534     END-IF
  1535     MOVE 0                      TO WS-EXTR-SEQ-NO
  1536
  1537* EXEC CICS READ
  1538*         DATASET    ('NSASEXTR')
  1539*         INTO       (NSAS-EXTRACT-RECORD)
  1540*         RIDFLD     (WS-NSASEXTR-KEY)
  1541*         UPDATE
  1542*         RESP       (WS-RESPONSE)
  1543*    END-EXEC
  1544     MOVE LENGTH OF
  1545      NSAS-EXTRACT-RECORD
  1546       TO DFHEIV11
  1547     MOVE 'NSASEXTR' TO DFHEIV1
  1548*    MOVE '&"IL       EU         (  N#00001436' TO DFHEIV0
  1549     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1550     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1551     MOVE X'204E233030303031343336' TO DFHEIV0(25:11)
  1552     CALL 'kxdfhei1' USING DFHEIV0,
  1553           DFHEIV1,
  1554           NSAS-EXTRACT-RECORD,
  1555           DFHEIV11,
  1556           WS-NSASEXTR-KEY,
  1557           DFHEIV99,
  1558           DFHEIV99,
  1559           DFHEIV99
  1560     MOVE EIBRESP  TO WS-RESPONSE
  1561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1562     IF NOT RESP-NORMAL
  1563        DISPLAY ' BAD READ ON 0 NSASEXTR ' WS-RESPONSE
  1564        GO TO 0050-EXIT
  1565     ELSE
  1566
  1567* EXEC CICS DELETE
  1568*          DATASET    ('NSASEXTR')
  1569*          RESP       (WS-RESPONSE)
  1570*       END-EXEC
  1571     MOVE 'NSASEXTR' TO DFHEIV1
  1572*    MOVE '&(                    &  N#00001447' TO DFHEIV0
  1573     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1574     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1575     MOVE X'204E233030303031343437' TO DFHEIV0(25:11)
  1576     CALL 'kxdfhei1' USING DFHEIV0,
  1577           DFHEIV1,
  1578           DFHEIV99,
  1579           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  29
* NSAASBL.cbl
  1580           DFHEIV99,
  1581           DFHEIV99
  1582     MOVE EIBRESP  TO WS-RESPONSE
  1583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1584        IF NOT RESP-NORMAL
  1585           DISPLAY ' BAD DELETE ON 0 NSASEXTR ' WS-RESPONSE
  1586           GO TO 0050-EXIT
  1587        END-IF
  1588     END-IF
  1589     MOVE 1                      TO WS-EXTR-SEQ-NO
  1590
  1591* EXEC CICS READ
  1592*         DATASET    ('NSASEXTR')
  1593*         INTO       (NSAS-EXTRACT-RECORD)
  1594*         RIDFLD     (WS-NSASEXTR-KEY)
  1595*         UPDATE
  1596*         RESP       (WS-RESPONSE)
  1597*    END-EXEC
  1598     MOVE LENGTH OF
  1599      NSAS-EXTRACT-RECORD
  1600       TO DFHEIV11
  1601     MOVE 'NSASEXTR' TO DFHEIV1
  1602*    MOVE '&"IL       EU         (  N#00001457' TO DFHEIV0
  1603     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1604     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1605     MOVE X'204E233030303031343537' TO DFHEIV0(25:11)
  1606     CALL 'kxdfhei1' USING DFHEIV0,
  1607           DFHEIV1,
  1608           NSAS-EXTRACT-RECORD,
  1609           DFHEIV11,
  1610           WS-NSASEXTR-KEY,
  1611           DFHEIV99,
  1612           DFHEIV99,
  1613           DFHEIV99
  1614     MOVE EIBRESP  TO WS-RESPONSE
  1615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1616     IF NOT RESP-NORMAL
  1617        DISPLAY ' BAD READ ON 1 NSASEXTR ' WS-RESPONSE
  1618     ELSE
  1619
  1620* EXEC CICS DELETE
  1621*          DATASET    ('NSASEXTR')
  1622*          RESP       (WS-RESPONSE)
  1623*       END-EXEC
  1624     MOVE 'NSASEXTR' TO DFHEIV1
  1625*    MOVE '&(                    &  N#00001467' TO DFHEIV0
  1626     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1627     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1628     MOVE X'204E233030303031343637' TO DFHEIV0(25:11)
  1629     CALL 'kxdfhei1' USING DFHEIV0,
  1630           DFHEIV1,
  1631           DFHEIV99,
  1632           DFHEIV99,
  1633           DFHEIV99,
  1634           DFHEIV99
  1635     MOVE EIBRESP  TO WS-RESPONSE
  1636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1637        IF NOT RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  30
* NSAASBL.cbl
  1638           DISPLAY ' BAD DELETE ON 1 NSASEXTR ' WS-RESPONSE
  1639        END-IF
  1640     END-IF
  1641     MOVE 2                      TO WS-EXTR-SEQ-NO
  1642
  1643* EXEC CICS READ
  1644*         DATASET    ('NSASEXTR')
  1645*         INTO       (NSAS-EXTRACT-RECORD)
  1646*         RIDFLD     (WS-NSASEXTR-KEY)
  1647*         UPDATE
  1648*         RESP       (WS-RESPONSE)
  1649*    END-EXEC
  1650     MOVE LENGTH OF
  1651      NSAS-EXTRACT-RECORD
  1652       TO DFHEIV11
  1653     MOVE 'NSASEXTR' TO DFHEIV1
  1654*    MOVE '&"IL       EU         (  N#00001476' TO DFHEIV0
  1655     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1656     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1657     MOVE X'204E233030303031343736' TO DFHEIV0(25:11)
  1658     CALL 'kxdfhei1' USING DFHEIV0,
  1659           DFHEIV1,
  1660           NSAS-EXTRACT-RECORD,
  1661           DFHEIV11,
  1662           WS-NSASEXTR-KEY,
  1663           DFHEIV99,
  1664           DFHEIV99,
  1665           DFHEIV99
  1666     MOVE EIBRESP  TO WS-RESPONSE
  1667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1668     IF NOT RESP-NORMAL
  1669        DISPLAY ' BAD READ ON 2 NSASEXTR ' WS-RESPONSE
  1670     ELSE
  1671
  1672* EXEC CICS DELETE
  1673*          DATASET    ('NSASEXTR')
  1674*          RESP       (WS-RESPONSE)
  1675*       END-EXEC
  1676     MOVE 'NSASEXTR' TO DFHEIV1
  1677*    MOVE '&(                    &  N#00001486' TO DFHEIV0
  1678     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1679     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1680     MOVE X'204E233030303031343836' TO DFHEIV0(25:11)
  1681     CALL 'kxdfhei1' USING DFHEIV0,
  1682           DFHEIV1,
  1683           DFHEIV99,
  1684           DFHEIV99,
  1685           DFHEIV99,
  1686           DFHEIV99
  1687     MOVE EIBRESP  TO WS-RESPONSE
  1688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1689        IF NOT RESP-NORMAL
  1690           DISPLAY ' BAD DELETE ON 2 NSASEXTR ' WS-RESPONSE
  1691        END-IF
  1692     END-IF
  1693     .
  1694 0050-EXIT.
  1695     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  31
* NSAASBL.cbl
  1696
  1697
  1698 0440-ADD-BILLING-NOTE.
  1699
  1700     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  1701     MOVE WS-ERARCH-COMPANY-CD   TO WS-EOBC-COMPANY-CD
  1702     MOVE '5'                    TO WS-EOBC-REC-TYPE
  1703
  1704
  1705* EXEC CICS STARTBR
  1706*        DATASET   ('ELEOBC')
  1707*        RIDFLD    (WS-ELEOBC-KEY)
  1708*        GTEQ
  1709*        RESP      (WS-RESPONSE)
  1710*    END-EXEC
  1711     MOVE 'ELEOBC' TO DFHEIV1
  1712     MOVE 0
  1713       TO DFHEIV11
  1714*    MOVE '&,         G          &  N#00001505' TO DFHEIV0
  1715     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1716     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1717     MOVE X'204E233030303031353035' TO DFHEIV0(25:11)
  1718     CALL 'kxdfhei1' USING DFHEIV0,
  1719           DFHEIV1,
  1720           WS-ELEOBC-KEY,
  1721           DFHEIV99,
  1722           DFHEIV11,
  1723           DFHEIV99
  1724     MOVE EIBRESP  TO WS-RESPONSE
  1725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1726
  1727     IF NOT RESP-NORMAL
  1728        GO TO 0440-EXIT
  1729     END-IF
  1730      .
  1731 0440-READNEXT-ELEOBC.
  1732
  1733
  1734* EXEC CICS READNEXT
  1735*       INTO    (EOB-CODES)
  1736*       DATASET ('ELEOBC')
  1737*       RIDFLD  (WS-ELEOBC-KEY)
  1738*       RESP    (WS-RESPONSE)
  1739*    END-EXEC
  1740     MOVE LENGTH OF
  1741      EOB-CODES
  1742       TO DFHEIV12
  1743     MOVE 'ELEOBC' TO DFHEIV1
  1744     MOVE 0
  1745       TO DFHEIV11
  1746*    MOVE '&.IL                  )  N#00001518' TO DFHEIV0
  1747     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1748     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1749     MOVE X'204E233030303031353138' TO DFHEIV0(25:11)
  1750     CALL 'kxdfhei1' USING DFHEIV0,
  1751           DFHEIV1,
  1752           EOB-CODES,
  1753           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  32
* NSAASBL.cbl
  1754           WS-ELEOBC-KEY,
  1755           DFHEIV99,
  1756           DFHEIV11,
  1757           DFHEIV99,
  1758           DFHEIV99
  1759     MOVE EIBRESP  TO WS-RESPONSE
  1760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1761
  1762     IF RESP-NORMAL
  1763         IF EO-RECORD-TYPE NOT = '5'
  1764             GO TO 0440-EXIT
  1765         END-IF
  1766     ELSE
  1767         GO TO 0440-EXIT
  1768     END-IF
  1769
  1770     IF EO-RECORD-TYPE = '5' AND
  1771        EO-EOB-CODE = WS-SV-LETTER-ID
  1772           CONTINUE
  1773     ELSE
  1774         GO TO 0440-READNEXT-ELEOBC
  1775     END-IF
  1776
  1777     MOVE SPACES         TO WS-BILLING-NOTE
  1778     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  1779     MOVE WS-SV-LETTER-ID TO WS-BN-LTRID
  1780     MOVE SAVE-DATE      TO WS-BN-DATE
  1781     MOVE WS-SV-PROC-ID  TO WS-BN-USERID
  1782     MOVE +25            TO WS-LEN
  1783
  1784     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  1785     .
  1786 0440-EXIT.
  1787     EXIT.
  1788
  1789 0441-UPDATE-BILLING-NOTE.
  1790
  1791     MOVE WS-SAVE-KEY TO WS-ERNOTE-KEY
  1792
  1793
  1794* EXEC CICS READ
  1795*       DATASET    ('ERNOTE')
  1796*       RIDFLD     (WS-ERNOTE-KEY)
  1797*       INTO       (CERTIFICATE-NOTE)
  1798*       RESP       (WS-RESPONSE)
  1799*       UPDATE
  1800*    END-EXEC
  1801     MOVE LENGTH OF
  1802      CERTIFICATE-NOTE
  1803       TO DFHEIV11
  1804     MOVE 'ERNOTE' TO DFHEIV1
  1805*    MOVE '&"IL       EU         (  N#00001556' TO DFHEIV0
  1806     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1807     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1808     MOVE X'204E233030303031353536' TO DFHEIV0(25:11)
  1809     CALL 'kxdfhei1' USING DFHEIV0,
  1810           DFHEIV1,
  1811           CERTIFICATE-NOTE,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  33
* NSAASBL.cbl
  1812           DFHEIV11,
  1813           WS-ERNOTE-KEY,
  1814           DFHEIV99,
  1815           DFHEIV99,
  1816           DFHEIV99
  1817     MOVE EIBRESP  TO WS-RESPONSE
  1818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1819
  1820     IF RESP-NORMAL
  1821       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  1822          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  1823       END-IF
  1824       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  1825          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  1826       END-IF
  1827       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  1828           (NOTE-SUB > +10) OR
  1829           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  1830                             WS-BILLING-NOTE (1:WS-LEN))
  1831       END-PERFORM
  1832       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  1833                              WS-BILLING-NOTE (1:WS-LEN)
  1834
  1835* EXEC CICS UNLOCK
  1836*           DATASET    ('ERNOTE')
  1837*        END-EXEC
  1838     MOVE 'ERNOTE' TO DFHEIV1
  1839*    MOVE '&*                    #   #00001578' TO DFHEIV0
  1840     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  1841     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1842     MOVE X'2020233030303031353738' TO DFHEIV0(25:11)
  1843     CALL 'kxdfhei1' USING DFHEIV0,
  1844           DFHEIV1,
  1845           DFHEIV99
  1846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1847       ELSE
  1848         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  1849           (NOTE-SUB > +10) OR
  1850           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  1851         END-PERFORM
  1852         IF (NOTE-SUB < +11)
  1853           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  1854              NOTE-SUB <= CN-BILLING-END-LINE-NO
  1855                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  1856           ELSE
  1857             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  1858              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  1859                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  1860                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  1861             ELSE
  1862               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  1863                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  1864                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  1865                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  1866               ELSE
  1867                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  1868                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  1869                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  34
* NSAASBL.cbl
  1870                                       CN-BILLING-START-LINE-NO
  1871                 ELSE
  1872                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  1873                 END-IF
  1874               END-IF
  1875             END-IF
  1876           END-IF
  1877           MOVE WS-SV-PROC-ID       TO CN-LAST-MAINT-USER
  1878           MOVE SAVE-BIN-DATE       TO CN-LAST-MAINT-DT
  1879           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  1880
  1881* EXEC CICS REWRITE
  1882*             DATASET    ('ERNOTE')
  1883*             FROM       (CERTIFICATE-NOTE)
  1884*             RESP       (WS-RESPONSE)
  1885*          END-EXEC
  1886     MOVE LENGTH OF
  1887      CERTIFICATE-NOTE
  1888       TO DFHEIV11
  1889     MOVE 'ERNOTE' TO DFHEIV1
  1890*    MOVE '&& L                  %  N#00001614' TO DFHEIV0
  1891     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1892     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1893     MOVE X'204E233030303031363134' TO DFHEIV0(25:11)
  1894     CALL 'kxdfhei1' USING DFHEIV0,
  1895           DFHEIV1,
  1896           CERTIFICATE-NOTE,
  1897           DFHEIV11,
  1898           DFHEIV99
  1899     MOVE EIBRESP  TO WS-RESPONSE
  1900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1901           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  1902         END-IF
  1903       END-IF
  1904     ELSE
  1905        MOVE SPACES              TO CERTIFICATE-NOTE
  1906        MOVE 'CN'                TO CN-RECORD-ID
  1907        MOVE WS-SAVE-KEY         TO CN-CONTROL-PRIMARY
  1908                                    WS-ERNOTE-KEY
  1909        MOVE 01                  TO CN-BILLING-START-LINE-NO
  1910                                    CN-BILLING-END-LINE-NO
  1911        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  1912        MOVE WS-SV-PROC-ID       TO CN-LAST-MAINT-USER
  1913        MOVE SAVE-BIN-DATE       TO CN-LAST-MAINT-DT
  1914        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  1915
  1916* EXEC CICS WRITE
  1917*          DATASET    ('ERNOTE')
  1918*          FROM       (CERTIFICATE-NOTE)
  1919*          RIDFLD     (WS-ERNOTE-KEY)
  1920*          RESP       (WS-RESPONSE)
  1921*       END-EXEC
  1922     MOVE LENGTH OF
  1923      CERTIFICATE-NOTE
  1924       TO DFHEIV11
  1925     MOVE 'ERNOTE' TO DFHEIV1
  1926*    MOVE '&$ L                  ''  N#00001633' TO DFHEIV0
  1927     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  35
* NSAASBL.cbl
  1928     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1929     MOVE X'204E233030303031363333' TO DFHEIV0(25:11)
  1930     CALL 'kxdfhei1' USING DFHEIV0,
  1931           DFHEIV1,
  1932           CERTIFICATE-NOTE,
  1933           DFHEIV11,
  1934           WS-ERNOTE-KEY,
  1935           DFHEIV99,
  1936           DFHEIV99
  1937     MOVE EIBRESP  TO WS-RESPONSE
  1938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1939
  1940        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  1941     END-IF
  1942
  1943     .
  1944 0441-EXIT.
  1945     EXIT.
  1946
  1947
  1948 0442-SQUEEZE-IT-IN.
  1949
  1950     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  1951        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  1952           NOTE-SUB = +10
  1953           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  1954           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  1955             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  1956             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  1957             MOVE +9 TO NOTE-SUB
  1958           END-IF
  1959        END-PERFORM
  1960     ELSE
  1961        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  1962           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  1963             UNTIL NOTE-SUB = +1
  1964             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  1965             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  1966                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  1967                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  1968                MOVE +2          TO NOTE-SUB
  1969             END-IF
  1970           END-PERFORM
  1971        END-IF
  1972     END-IF
  1973
  1974     .
  1975 0442-EXIT.
  1976     EXIT.
  1977
  1978 0445-CERTIFICATE-UPDATE.
  1979
  1980     MOVE WS-SAVE-KEY     TO WS-ELCERT-KEY
  1981
  1982* EXEC CICS READ
  1983*        DATASET  ('ELCERT')
  1984*        RIDFLD   (WS-ELCERT-KEY)
  1985*        INTO     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  36
* NSAASBL.cbl
  1986*        RESP     (WS-RESPONSE)
  1987*        UPDATE
  1988*    END-EXEC
  1989     MOVE LENGTH OF
  1990      CERTIFICATE-MASTER
  1991       TO DFHEIV11
  1992     MOVE 'ELCERT' TO DFHEIV1
  1993*    MOVE '&"IL       EU         (  N#00001681' TO DFHEIV0
  1994     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1995     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1996     MOVE X'204E233030303031363831' TO DFHEIV0(25:11)
  1997     CALL 'kxdfhei1' USING DFHEIV0,
  1998           DFHEIV1,
  1999           CERTIFICATE-MASTER,
  2000           DFHEIV11,
  2001           WS-ELCERT-KEY,
  2002           DFHEIV99,
  2003           DFHEIV99,
  2004           DFHEIV99
  2005     MOVE EIBRESP  TO WS-RESPONSE
  2006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2007
  2008     IF RESP-NORMAL
  2009        EVALUATE CM-NOTE-SW
  2010           WHEN '2'
  2011           WHEN '3'
  2012           WHEN '6'
  2013           WHEN '7'
  2014              SET NO-CERT-RW     TO TRUE
  2015           WHEN ' '
  2016              MOVE '2'           TO CM-NOTE-SW
  2017           WHEN '1'
  2018              MOVE '3'           TO CM-NOTE-SW
  2019           WHEN '4'
  2020              MOVE '6'           TO CM-NOTE-SW
  2021           WHEN '5'
  2022              MOVE '7'           TO CM-NOTE-SW
  2023        END-EVALUATE
  2024     END-IF
  2025
  2026     IF NOT NO-CERT-RW
  2027
  2028* EXEC CICS REWRITE
  2029*          FROM     (CERTIFICATE-MASTER)
  2030*          DATASET  ('ELCERT')
  2031*          RESP     (WS-RESPONSE)
  2032*       END-EXEC
  2033     MOVE LENGTH OF
  2034      CERTIFICATE-MASTER
  2035       TO DFHEIV11
  2036     MOVE 'ELCERT' TO DFHEIV1
  2037*    MOVE '&& L                  %  N#00001708' TO DFHEIV0
  2038     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2039     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2040     MOVE X'204E233030303031373038' TO DFHEIV0(25:11)
  2041     CALL 'kxdfhei1' USING DFHEIV0,
  2042           DFHEIV1,
  2043           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  37
* NSAASBL.cbl
  2044           DFHEIV11,
  2045           DFHEIV99
  2046     MOVE EIBRESP  TO WS-RESPONSE
  2047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2048     ELSE
  2049
  2050* EXEC CICS UNLOCK
  2051*          DATASET  ('ELCERT')
  2052*       END-EXEC
  2053     MOVE 'ELCERT' TO DFHEIV1
  2054*    MOVE '&*                    #   #00001714' TO DFHEIV0
  2055     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  2056     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2057     MOVE X'2020233030303031373134' TO DFHEIV0(25:11)
  2058     CALL 'kxdfhei1' USING DFHEIV0,
  2059           DFHEIV1,
  2060           DFHEIV99
  2061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2062     END-IF
  2063
  2064     .
  2065 0445-EXIT.
  2066     EXIT.
  2067
  2068 9700-DATE-LINK.
  2069
  2070* EXEC CICS LINK
  2071*        PROGRAM   ('ELDATCV')
  2072*        COMMAREA  (DATE-CONVERSION-DATA)
  2073*        LENGTH    (DC-COMM-LENGTH)
  2074*    END-EXEC.
  2075     MOVE 'ELDATCV' TO DFHEIV1
  2076*    MOVE '."C                   (   #00001724' TO DFHEIV0
  2077     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2078     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2079     MOVE X'2020233030303031373234' TO DFHEIV0(25:11)
  2080     CALL 'kxdfhei1' USING DFHEIV0,
  2081           DFHEIV1,
  2082           DATE-CONVERSION-DATA,
  2083           DC-COMM-LENGTH,
  2084           DFHEIV99,
  2085           DFHEIV99,
  2086           DFHEIV99,
  2087           DFHEIV99
  2088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2089
  2090 9700-EXIT.
  2091      EXIT.
  2092
  2093 9999-DFHBACK SECTION.
  2094     MOVE '9%                    "   ' TO DFHEIV0
  2095     MOVE 'NSAASBL' TO DFHEIV1
  2096     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2097     GOBACK.
  2098 9999-DFHEXIT.
  2099     IF DFHEIGDJ EQUAL 0001
  2100         NEXT SENTENCE.
  2101     MOVE '9%                    "   ' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  38
* NSAASBL.cbl
  2102     MOVE 'NSAASBL' TO DFHEIV1
  2103     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2104     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15160     Code:        5648
