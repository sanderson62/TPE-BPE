* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   1
* EL640.cbl
* Options: int("EL640.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL640.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL640.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL640.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL640.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 15:38:12.
     7*                            VMOD=2.040
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   2
* EL640.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22*
    23*REMARKS.    TRANSACTION - EXC1 - ACCOUNT BILLING.
    24*
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    34*                              ADJUSTED REDEFINES EL640AO FILLER
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 083104    2004083000002  PEMA PREVENT ONLINE BILLING
    37* 072105    2004120100002  PEMA FIX ONLINE BILLING FOR DCC SPP
    38* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    39* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    40* 032113  CR2012110800003  PEMA  CORRECT SPP AH REF COMMISSION
    41* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    42* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    43******************************************************************
    44 ENVIRONMENT DIVISION.
    45
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   3
* EL640.cbl
    47 DATA DIVISION.
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50 77  FILLER  PIC X(32)  VALUE '********************************'.
    51 77  FILLER  PIC X(32)  VALUE '*    EL640 WORKING STORAGE     *'.
    52 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.040 ************'.
    53 77  CNC-FACT                    PIC S999V9(7) COMP-3 VALUE +0.
    54 77  S1                          PIC S999 COMP-3 VALUE +0.
    55*    COPY ELCSCTM.
    56******************************************************************
    57*                                                                *
    58*                                                                *
    59*                            ELCSCTM                             *
    60*                            VMOD=2.001                          *
    61*                                                                *
    62*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    63*                                                                *
    64******************************************************************
    65 01  SECURITY-MESSAGE.
    66     12  FILLER                          PIC X(30)
    67            VALUE '** LOGIC SECURITY VIOLATION -'.
    68     12  SM-READ                         PIC X(6).
    69     12  FILLER                          PIC X(5)
    70            VALUE ' PGM='.
    71     12  SM-PGM                          PIC X(6).
    72     12  FILLER                          PIC X(5)
    73            VALUE ' OPR='.
    74     12  SM-PROCESSOR-ID                 PIC X(4).
    75     12  FILLER                          PIC X(6)
    76            VALUE ' TERM='.
    77     12  SM-TERMID                       PIC X(4).
    78     12  FILLER                          PIC XX   VALUE SPACE.
    79     12  SM-JUL-DATE                     PIC 9(5).
    80     12  FILLER                          PIC X    VALUE SPACE.
    81     12  SM-TIME                         PIC 99.99.
    82
    83*    COPY ELCSCRTY.
    84******************************************************************
    85*                                                                *
    86*                                                                *
    87*                            ELCSCRTY                            *
    88*                            VMOD=2.001                          *
    89*                                                                *
    90*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    91*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    92*        SAVED IN PI-SECURITY-ADDRESS.                           *
    93*                                                                *
    94******************************************************************
    95 01  SECURITY-CONTROL.
    96     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    97     12  FILLER                       PIC XX    VALUE 'SC'.
    98     12  SC-CREDIT-CODES.
    99         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   100             20  SC-CREDIT-DISPLAY    PIC X.
   101             20  SC-CREDIT-UPDATE     PIC X.
   102     12  SC-CLAIMS-CODES.
   103         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   104             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   4
* EL640.cbl
   105             20  SC-CLAIMS-UPDATE     PIC X.
   106     12  WS-RESPONSE             PIC S9(8)       COMP.
   107         88  WS-RESP-NORMAL                      VALUE +00.
   108         88  WS-RESP-NOTFND                      VALUE +13.
   109         88  WS-RESP-DUPREC                      VALUE +14.
   110         88  WS-RESP-DUPKEY                      VALUE +15.
   111         88  WS-RESP-NOTOPEN                     VALUE +19.
   112         88  WS-RESP-ENDFILE                     VALUE +20.
   113 01  STANDARD-AREAS.
   114     12  WS-AH-CATEGORY              PIC X       VALUE ' '.
   115     12  CLAS-LOOK                   PIC XX      VALUE '  '.
   116     12  SC-ITEM             PIC S9(4) COMP VALUE +1.
   117
   118     12  W-TRANSFER-CONTROL.
   119         16  WT-CR-CARRIER           PIC X     VALUE SPACES.
   120         16  WT-CR-GROUPING          PIC X(6)  VALUE SPACES.
   121         16  WT-CR-STATE             PIC XX    VALUE SPACES.
   122         16  WT-CR-ACCOUNT           PIC X(10) VALUE SPACES.
   123         16  WT-CR-FIN-RESP          PIC X(10) VALUE SPACES.
   124         16  WT-CR-TYPE              PIC X     VALUE SPACES.
   125
   126     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   127     12  MAP-NAME            PIC X(8)    VALUE 'EL640A'.
   128     12  MAPSET-NAME         PIC X(8)    VALUE 'EL640S'.
   129     12  SCREEN-NUMBER       PIC X(4)    VALUE '640A'.
   130     12  TRANS-ID            PIC X(4)    VALUE 'EXC1'.
   131     12  EL6311-TRANS-ID     PIC X(4)    VALUE 'EXB1'.
   132     12  EL633-TRANS-ID      PIC X(4)    VALUE 'EXB7'.
   133     12  EL633DMD-TRANS-ID   PIC X(4)    VALUE 'EX1F'.
   134     12  EL635-TRANS-ID      PIC X(4)    VALUE 'EXJ4'.
   135     12  EL650-TRANS-ID      PIC X(4)    VALUE 'EXC4'.
   136     12  EL652-TRANS-ID      PIC X(4)    VALUE 'EXD4'.
   137     12  EL658-TRANS-ID      PIC X(4)    VALUE 'EXJ3'.
   138     12  THIS-PGM            PIC X(8)    VALUE 'EL640'.
   139     12  EL640A              PIC X(8)    VALUE 'EL640A'.
   140     12  EL640B              PIC X(8)    VALUE 'EL640B'.
   141     12  PGM-NAME            PIC X(8).
   142     12  TIME-IN             PIC S9(7).
   143     12  TIME-OUT-R  REDEFINES TIME-IN.
   144         16  FILLER          PIC X.
   145         16  TIME-OUT        PIC 99V99.
   146         16  FILLER          PIC XX.
   147
   148     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   149     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   150     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   151     12  XCTL-633            PIC X(8)    VALUE 'EL633'.
   152     12  XCTL-633DMD         PIC X(8)    VALUE 'EL633DMD'.
   153     12  XCTL-635            PIC X(8)    VALUE 'EL635'.
   154     12  XCTL-PYAJ           PIC X(8)    VALUE 'EL633'.
   155     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   156     12  XCTL-652            PIC X(8)    VALUE 'EL652'.
   157     12  XCTL-658            PIC X(8)    VALUE 'EL658'.
   158     12  XCTL-6401           PIC X(8)    VALUE 'EL6401'.
   159     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   160     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   161     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   162     12  ERPNDB-ALT-FILE-ID  PIC X(8)    VALUE 'ERPNDB2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   5
* EL640.cbl
   163     12  ERPNDB-FILE-ID      PIC X(8)    VALUE 'ERPNDB'.
   164     12  ELCNTL-FILE-ID      PIC X(8)    VALUE 'ELCNTL'.
   165     12  ELLETR-FILE-ID      PIC X(8)    VALUE 'ELLETR'.
   166     12  ERCOMP-FILE-ID      PIC X(8)    VALUE 'ERCOMP'.
   167     12  ERPYAJ-FILE-ID      PIC X(8)    VALUE 'ERPYAJ'.
   168     12  ERACCT-ALT-FILE-ID  PIC X(8)    VALUE 'ERACCT2'.
   169     12  ERACCT-FILE-ID      PIC X(8)    VALUE 'ERACCT'.
   170     12  ERBILL-FILE-ID      PIC X(8)    VALUE 'ERBILL'.
   171     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   172     12  QID.
   173         16  QID-TERM        PIC X(4).
   174         16  FILLER          PIC X(4)    VALUE '640A'.
   175     12  CLIENT-ITY          PIC XXX     VALUE 'ITY'.
   176
   177 01  WORK-AREA.
   178     12  W-LETTER-IND            PIC X     VALUE SPACE.
   179         88  W-LETTER-NOT-FOUND    VALUE 'Y'.
   180     12  FIRST-TIME-SW           PIC X     VALUE 'Y'.
   181         88  FIRST-TIME            VALUE 'Y'.
   182     12  C-RECORD-FOUND-SW       PIC X     VALUE 'Y'.
   183         88  C-RECORD-FOUND        VALUE 'Y'.
   184     12  ACCOUNT-FIN-RESP-SW     PIC X     VALUE ' '.
   185         88  ACCOUNT-FIN-RESP      VALUE 'Y'.
   186         88  ACCOUNT-NOT-FIN-RESP  VALUE 'N'.
   187     12  VALID-BILL-TYPE-VALUES  PIC X     VALUE SPACE.
   188         88  VALID-BILL-TYPE       VALUE  '1' '2'.
   189*        88  VALID-BILL-TYPE       VALUE  '1' '2' '3' '4' '5'.
   190     12  BILL-BATCH-TRAILER-SW   PIC X     VALUE SPACE.
   191         88  BILL-BATCH-TRAILER    VALUE 'Y'.
   192     12  PNDB-EOF-SW             PIC X     VALUE SPACE.
   193         88  PNDB-EOF              VALUE 'Y'.
   194     12  PYAJ-EOF-SW             PIC X     VALUE SPACE.
   195         88  PYAJ-EOF              VALUE 'Y'.
   196     12  COMP-UPDATE-SW          PIC X     VALUE SPACE.
   197         88  UPDATE-COMP-TOTALS    VALUE 'Y'.
   198     12  LIMIT-BILLING-SW        PIC X     VALUE SPACE.
   199         88  LIMIT-BILLING         VALUE 'Y'.
   200     12  WS-PROCESS-SW           PIC X     VALUE SPACE.
   201         88  DO-NOT-BILL-THIS-ACCT VALUE 'Y'.
   202     12  WS-CHARGEBACK-LF-SW     PIC X     VALUE SPACE.
   203         88  CHARGEBACK-CAN-LF     VALUE 'Y'.
   204         88  NO-CHARGEBACK-LF      VALUE 'N'.
   205     12  WS-CHARGEBACK-AH-SW     PIC X     VALUE SPACE.
   206         88  CHARGEBACK-CAN-AH     VALUE 'Y'.
   207         88  NO-CHARGEBACK-AH      VALUE 'N'.
   208     12  NO-BILL-REC-SW          PIC X     VALUE SPACE.
   209         88  NO-BILL-RECS          VALUE 'Y'.
   210     12  DATA-VOIDED-SW          PIC X     VALUE SPACE.
   211         88  DATA-VOIDED           VALUE 'Y'.
   212     12  BATCHES-PROCESSED-SW    PIC X     VALUE SPACE.
   213         88  MORE-THAN-6-BATCHES   VALUE 'Y'.
   214     12  BILLING-DETAIL-TYPE     PIC XX    VALUE SPACES.
   215         88  TOTAL-STATEMENT       VALUE 'TS'.
   216         88  BILLING-DETAIL        VALUE 'BD'.
   217         88  CARRIER-ADDRESS       VALUE 'CA'.
   218         88  GEN-AGT-ADDRESS       VALUE 'GA'.
   219     12  ELCNTL-UPDATE-SW        PIC X     VALUE SPACE.
   220         88  ELCNTL-UPDATE         VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   6
* EL640.cbl
   221     12  WS-ENTERED-FROM-MAP     PIC X     VALUE 'A'.
   222         88  WS-ENTERED-FROM-A     VALUE 'A'.
   223
   224     12  ACCOM-SUB               PIC 99    VALUE ZEROS.
   225     12  SUB                     PIC S999  COMP-3  VALUE ZEROS.
   226
   227     12  WORK-ZIP                PIC 9(9)  VALUE ZEROS.
   228     12  WORK-ZIPR1 REDEFINES WORK-ZIP.
   229         16  WORK-ZIPR1-4        PIC 9(4).
   230         16  WORK-ZIPR1-5        PIC 9(5).
   231     12  WORK-ZIPR2 REDEFINES WORK-ZIP.
   232         16  WORK-ZIPR2-5        PIC 9(5).
   233         16  WORK-ZIPR2-4        PIC 9(4).
   234     12  WS-AM-ZIP.
   235         16  WS-AM-ZIP-PRIME     PIC X(5).
   236         16  WS-AM-ZIP-DASH      PIC X.
   237         16  WS-AM-ZIP-PLUS4     PIC X(4).
   238     12  WS-AM-CANADIAN-ZIP  REDEFINES  WS-AM-ZIP.
   239         16  WS-AM-CAN-POST-1    PIC XXX.
   240         16  FILLER              PIC X.
   241         16  WS-AM-CAN-POST-2    PIC XXX.
   242         16  FILLER              PIC XXX.
   243     12  WS-CF-ZIP.
   244         16  WS-CF-ZIP-PRIME     PIC X(5) VALUE SPACES.
   245         16  WS-CF-ZIP-DASH      PIC X    VALUE SPACES.
   246         16  WS-CF-ZIP-PLUS4     PIC X(4) VALUE SPACES.
   247     12  WS-CF-CANADIAN-ZIP  REDEFINES  WS-CF-ZIP.
   248         16  WS-CF-CAN-POST-1    PIC XXX.
   249         16  FILLER              PIC X.
   250         16  WS-CF-CAN-POST-2    PIC XXX.
   251         16  FILLER              PIC XXX.
   252     12  WS-CO-ZIP.
   253         16  WS-CO-ZIP-PRIME     PIC X(5) VALUE SPACES.
   254         16  WS-CO-ZIP-DASH      PIC X    VALUE SPACES.
   255         16  WS-CO-ZIP-PLUS4     PIC X(4) VALUE SPACES.
   256     12  WS-CO-CANADIAN-ZIP  REDEFINES  WS-CO-ZIP.
   257         16  WS-CO-CAN-POST-1    PIC XXX.
   258         16  FILLER              PIC X.
   259         16  WS-CO-CAN-POST-2    PIC XXX.
   260         16  FILLER              PIC XXX.
   261
   262     12  WORK-SEQ-NO             PIC S9(9)   COMP-3 VALUE +0.
   263     12  WS-ERROR-MSG.
   264         16  WS-ERROR-TEXT       PIC X(35) VALUE SPACES.
   265         16  WS-ERROR-BATCH      PIC X(6)  VALUE SPACES.
   266         16  FILLER              PIC X(24) VALUE SPACES.
   267     12  WS-WORK-DATE.
   268         16  WS-MONTH            PIC 99    VALUE ZEROS.
   269         16  WS-DAY              PIC 99    VALUE ZEROS.
   270         16  WS-YEAR             PIC 99    VALUE ZEROS.
   271     12  WS-MONTH-END-DATE.
   272         16  WS-ME-YEAR          PIC 99    VALUE ZEROS.
   273         16  WS-ME-MONTH         PIC 99    VALUE ZEROS.
   274         16  WS-ME-DAY           PIC 99    VALUE ZEROS.
   275     12  WS-CURRENT-DATE         PIC XX    VALUE SPACES.
   276     12  WS-CURRENT-DATE-MDY     PIC X(6)  VALUE SPACES.
   277     12  WS-CURRENT-DATE-EDIT    PIC X(8)  VALUE SPACES.
   278     12  WS-PREV-BILL-DATE       PIC XX    VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   7
* EL640.cbl
   279     12  WS-BEGIN-DATE.
   280         16  FILLER              PIC X(3)  VALUE SPACES.
   281         16  WS-BEGIN-DAY        PIC XX    VALUE SPACES.
   282         16  FILLER              PIC X(3)  VALUE SPACES.
   283     12  PRINT-CONTROL.
   284         16  SINGLE-SPACE        PIC X     VALUE SPACE.
   285         16  DOUBLE-SPACE        PIC X     VALUE ZERO.
   286         16  TRIPLE-SPACE        PIC X     VALUE '-'.
   287         16  SUPPRESS-SPACE      PIC X     VALUE '+'.
   288         16  TOP-OF-PAGE         PIC X     VALUE '1'.
   289     12  WS-EXP-DATE.
   290         16  WS-SAV-EXP-DT     OCCURS 10 TIMES
   291                               INDEXED BY DTNDX  PIC XX.
   292     12  WS-REMIT-TO.
   293         16  WS-SAV-REMIT-TO   OCCURS 10 TIMES
   294                               INDEXED BY RTNDX  PIC X(10).
   295     12  WORK-REMIT-TO           PIC X(10) VALUE SPACES.
   296     12  WS-REMITTED             PIC S9(6)V99 VALUE ZEROS.
   297     12  WS-LINECTR              PIC 99    VALUE ZEROS.
   298     12  WS-PGECTR               PIC 999   VALUE 1.
   299     12  WS-LINE-SEQ-NO          PIC S9(4) COMP VALUE +1.
   300     12  WS-CARR-COMP.
   301         16  WS-CARRIER          PIC X     VALUE SPACE.
   302         16  WS-COMP             PIC X(6)  VALUE SPACES.
   303
   304     12  REPORT-TOTALS.
   305         16  TOT-REPT-LF-PREM    PIC S9(7)V99   VALUE ZEROS.
   306         16  TOT-REPT-LF-REF     PIC S9(7)V99   VALUE ZEROS.
   307         16  TOT-REPT-LF-COMP    PIC S9(7)V99   VALUE ZEROS.
   308         16  TOT-REPT-LF-COMP-R  PIC S9(7)V99   VALUE ZEROS.
   309         16  TOT-REPT-AH-PREM    PIC S9(7)V99   VALUE ZEROS.
   310         16  TOT-REPT-AH-REF     PIC S9(7)V99   VALUE ZEROS.
   311         16  TOT-REPT-AH-COMP    PIC S9(7)V99   VALUE ZEROS.
   312         16  TOT-REPT-AH-COMP-R  PIC S9(7)V99   VALUE ZEROS.
   313         16  TOT-LF-REPT-FACE-AMT   PIC S9(7)V99   VALUE ZEROS.
   314         16  TOT-AH-REPT-FACE-AMT   PIC S9(7)V99   VALUE ZEROS.
   315         16  TOT-REPT-PREM       PIC S9(7)V99   VALUE ZEROS.
   316         16  TOT-REPT-CANCEL-FEE PIC S9(7)V99   VALUE ZEROS.
   317     12  WORK-AMT                PIC S9(7)V99   VALUE ZEROS.
   318     12  WORK-CHECK-AMT          PIC S9(7)V99   VALUE ZEROS.
   319     12  WORK-CANCEL-FEE         PIC S9(7)V99   VALUE ZEROS.
   320     12  WS-I-LF-PREMIUM-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   321     12  WS-I-LF-BENEFIT-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   322     12  WS-I-AH-PREMIUM-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   323     12  WS-I-AH-BENEFIT-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   324     12  WS-C-LF-CANCEL-AMT      PIC S9(5)V99   COMP-3 VALUE +0.
   325     12  WS-C-AH-CANCEL-AMT      PIC S9(5)V99   COMP-3 VALUE +0.
   326     12  WS-C-CANCEL-FEE         PIC S9(5)V99   COMP-3 VALUE +0.
   327     12  WS-LF-CAN-COMP          PIC S9(6)V99   COMP-3 VALUE +0.
   328     12  WS-AH-CAN-COMP          PIC S9(6)V99   COMP-3 VALUE +0.
   329     12  WS-PAY-ADJ              PIC S9(6)V99   COMP-3 VALUE +0.
   330     12  WS-CI-LIFE-BENEFIT      PIC S9(7)V99   COMP-3 VALUE +0.
   331     12  LF-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   332     12  JT-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   333     12  AH-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   334     12  AGENT-OWES              PIC X(18)
   335                         VALUE 'AGENT OWES       ='.
   336     12  OWED-TO-AGENT           PIC X(18)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   8
* EL640.cbl
   337                         VALUE 'OWED TO AGENT    ='.
   338     12  WS-PY-ENTRY-COMMENT.
   339         16  WS-PY-CURRENT-DATE      PIC X(6) VALUE SPACES.
   340         16  FILLER                  PIC X(14) VALUE
   341             ' CHK TO AGENT'.
   342
   343     12  WS-ITY-COMMENT.
   344         16  WS-PY-BEGIN-DT          PIC X(8) VALUE SPACES.
   345         16  FILLER                  PIC X(06) VALUE
   346             ' THRU '.
   347         16  WS-PY-END-DT            PIC X(8) VALUE SPACES.
   348
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   9
* EL640.cbl
   350     12  WS-ACCT-ADDR-AREA.
   351         16  WS-ACCT-LINES OCCURS 6 TIMES INDEXED BY A-INDX.
   352           18  WS-ACCT-ZIP           PIC X(10) VALUE SPACES.
   353           18  FILLER                PIC X(10) VALUE SPACES.
   354           18  WS-A-LAST-ZIP         PIC X(10) VALUE SPACES.
   355
   356     12  WS-REMIT-ADDR-AREA.
   357         16  WS-REMIT-ACCT           PIC X(10) VALUE SPACES.
   358         16  WS-REMIT-LINES OCCURS 6 TIMES INDEXED BY R-INDX.
   359           18  WS-REMIT-ZIP          PIC X(10) VALUE SPACES.
   360           18  FILLER                PIC X(10) VALUE SPACES.
   361           18  WS-R-LAST-ZIP         PIC X(10) VALUE SPACES.
   362
   363     12  WS-EFFECT-DATE.
   364         16  WS-EFFECT-YR            PIC 99 VALUE ZEROS.
   365         16  WS-EFFECT-MO            PIC 99 VALUE ZEROS.
   366         16  WS-EFFECT-DA            PIC 99 VALUE ZEROS.
   367
   368     12  WS-LIFE-CANCEL-DT.
   369         16  WS-LF-CANCEL-YR         PIC 99 VALUE ZEROS.
   370         16  WS-LF-CANCEL-MO         PIC 99 VALUE ZEROS.
   371         16  WS-LF-CANCEL-DA         PIC 99 VALUE ZEROS.
   372
   373     12  WS-AH-CANCEL-DT.
   374         16  WS-AH-CANCEL-YR         PIC 99 VALUE ZEROS.
   375         16  WS-AH-CANCEL-MO         PIC 99 VALUE ZEROS.
   376         16  WS-AH-CANCEL-DA         PIC 99 VALUE ZEROS.
   377
   378     12  MONTHS-DIFF-LF            PIC S9(05)  VALUE ZEROS.
   379     12  MONTHS-DIFF-AH            PIC S9(05)  VALUE ZEROS.
   380
   381     12  WS-BENEFIT.
   382         16  FILLER                PIC X   VALUE SPACES.
   383         16  WS-BENE-CD            PIC XX  VALUE SPACES.
   384
   385     12  WS-DESC.
   386         16 WS-BATCH-DESC        PIC X(10) VALUE SPACES.
   387         16 WS-BATCH-NBR         PIC X(6)  VALUE SPACES.
   388         16 FILLER               PIC X(4)  VALUE SPACES.
   389     12  WS-NON-PREM             PIC S9(7)V99   COMP-3.
   390     12  WS-NON-COMM             PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  10
* EL640.cbl
   392 01  ACCESS-KEYS.
   393     12  ERPNDB-PRIME-KEY.
   394         16  ERPNDB-CO-CD        PIC X     VALUE SPACES.
   395         16  ERPNDB-BATCH        PIC X(6)  VALUE SPACES.
   396         16  ERPNDB-SEQ-NO       PIC S9(4) COMP VALUE +0.
   397         16  ERPNDB-CHG-SEQ-NO   PIC S9(4) COMP VALUE +0.
   398
   399     12  ERPNDB-LENGTH           PIC S9(4) COMP VALUE +585.
   400
   401     12  ERPNDB-ALT-KEY.
   402         16  ERPNDB-CO-CD-A1     PIC X     VALUE SPACES.
   403         16  ERPNDB-CARR         PIC X     VALUE SPACES.
   404         16  ERPNDB-GROUP        PIC X(6)  VALUE SPACES.
   405         16  ERPNDB-STATE        PIC XX    VALUE SPACES.
   406         16  ERPNDB-ACCT         PIC X(10) VALUE SPACES.
   407         16  ERPNDB-EFF-DT       PIC XX    VALUE SPACES.
   408         16  ERPNDB-CERT.
   409             20  ERPNDB-CERT-PRM PIC X(10) VALUE SPACES.
   410             20  ERPNDB-CERTSFX  PIC X     VALUE SPACES.
   411         16  ERPNDB-ACHG-SEQ-NO  PIC S9(4) COMP.
   412         16  ERPNDB-REC-TYPE     PIC X     VALUE SPACES.
   413
   414     12  ELCNTL-KEY.
   415         16  ELCNTL-COMPANY-ID   PIC XXX   VALUE SPACES.
   416         16  ELCNTL-REC-TYPE     PIC X     VALUE SPACES.
   417         16  ELCNTL-ACCESS.
   418             20  ELCNTL-FILLER   PIC X(3)  VALUE SPACES.
   419             20  ELCNTL-CARRIER  PIC X     VALUE SPACES.
   420         16  ELCNTL-SEQ-NO       PIC S9(4) COMP VALUE ZEROS.
   421
   422     12  ELCNTL-LENGTH           PIC S9(4) COMP VALUE +504.
   423
   424     12  ERCOMP-KEY.
   425         16  ERCOMP-COMP-CD      PIC X     VALUE SPACE.
   426         16  ERCOMP-CARRIER      PIC X     VALUE SPACES.
   427         16  ERCOMP-GROUPING     PIC X(6)  VALUE SPACES.
   428         16  ERCOMP-FIN-RESP     PIC X(10) VALUE SPACES.
   429         16  ERCOMP-ACCT         PIC X(10) VALUE SPACES.
   430         16  ERCOMP-RECORD-TYPE  PIC X     VALUE SPACES.
   431
   432     12  ERPYAJ-BROWSE-COMP-KEY.
   433         16  ERPYAJ-BR-COMP-CD   PIC X     VALUE SPACE.
   434         16  ERPYAJ-BR-CARRIER   PIC X     VALUE SPACES.
   435         16  ERPYAJ-BR-GROUPING  PIC X(6)  VALUE SPACES.
   436         16  ERPYAJ-BR-FIN-RESP  PIC X(10) VALUE SPACES.
   437         16  ERPYAJ-BR-ACCOUNT   PIC X(10) VALUE SPACES.
   438
   439     12  ERCOMP-LENGTH           PIC S9(4) COMP VALUE +700.
   440
   441     12  ERPYAJ-KEY.
   442         16  ERPYAJ-COMP-CD      PIC X     VALUE SPACE.
   443         16  ERPYAJ-CARRIER      PIC X     VALUE SPACES.
   444         16  ERPYAJ-GROUPING     PIC X(6)  VALUE SPACES.
   445         16  ERPYAJ-FIN-RESP     PIC X(10) VALUE SPACES.
   446         16  ERPYAJ-ACCOUNT      PIC X(10) VALUE SPACES.
   447         16  ERPYAJ-FILE-SEQ-NO  PIC S9(8) VALUE +0 COMP.
   448         16  ERPYAJ-RECORD-TYPE  PIC X     VALUE SPACES.
   449
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  11
* EL640.cbl
   450     12  ERPYAJ-LENGTH           PIC S9(4) COMP VALUE +200.
   451
   452     12  ERACCT-PRIME-KEY.
   453         16  ERACCT-P-CO-CD      PIC X     VALUE SPACES.
   454         16  ERACCT-P-CARRIER    PIC X     VALUE SPACES.
   455         16  ERACCT-P-GROUPING   PIC X(6)  VALUE SPACES.
   456         16  ERACCT-P-STATE      PIC XX    VALUE SPACES.
   457         16  ERACCT-P-ACCOUNT    PIC X(10) VALUE SPACES.
   458         16  ERACCT-P-EXP-DATE   PIC XX    VALUE SPACES.
   459         16  FILLER              PIC X(4)  VALUE SPACES.
   460
   461     12  ERACCT-LENGTH           PIC S9(4) COMP VALUE +2000.
   462
   463     12  ERACCT-ALT-KEY.
   464         16  ERACCT-A-CO-CD      PIC X     VALUE SPACES.
   465         16  ERACCT-A-CARRIER    PIC X     VALUE SPACES.
   466         16  ERACCT-A-GROUPING   PIC X(6)  VALUE SPACES.
   467         16  ERACCT-A-STATE      PIC XX    VALUE SPACES.
   468         16  ERACCT-A-ACCOUNT    PIC X(10) VALUE SPACES.
   469         16  ERACCT-A-EXP-DATE   PIC XX    VALUE SPACES.
   470         16  FILLER              PIC X(4)  VALUE SPACES.
   471
   472     12  ERBILL-KEY.
   473         16  ERBILL-CO-CD        PIC X.
   474         16  ERBILL-CARRIER      PIC X.
   475         16  ERBILL-GROUP        PIC X(6).
   476         16  ERBILL-ACCT         PIC X(10).
   477         16  ERBILL-FIN-RESP     PIC X(10).
   478         16  ERBILL-REC-TYPE     PIC X.
   479         16  ERBILL-LINE-SEQ-NO  PIC S9(4) COMP.
   480
   481     12  ERBILL-LENGTH           PIC S9(4) COMP VALUE +210.
   482
   483     12  ELLETR-KEY.
   484         16  ELLETR-COMPANY-CD   PIC  X      VALUE SPACE.
   485         16  ELLETR-FORM-NO      PIC  X(12)  VALUE SPACES.
   486         16  ELLETR-LINE-SEQ     PIC S9(04)  VALUE +0 COMP.
   487
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  12
* EL640.cbl
   489
   490 01  ERROR-NUMBERS.
   491     12  ER-0004                 PIC X(4)  VALUE '0004'.
   492     12  ER-0008                 PIC X(4)  VALUE '0008'.
   493     12  ER-0013                 PIC X(4)  VALUE '0013'.
   494     12  ER-0022                 PIC X(4)  VALUE '0022'.
   495     12  ER-0029                 PIC X(4)  VALUE '0029'.
   496     12  ER-0070                 PIC X(4)  VALUE '0070'.
   497     12  ER-0194                 PIC X(4)  VALUE '0194'.
   498     12  ER-0195                 PIC X(4)  VALUE '0195'.
   499     12  ER-0196                 PIC X(4)  VALUE '0196'.
   500     12  ER-0197                 PIC X(4)  VALUE '0197'.
   501     12  ER-2208                 PIC X(4)  VALUE '2208'.
   502     12  ER-2210                 PIC X(4)  VALUE '2210'.
   503     12  ER-2212                 PIC X(4)  VALUE '2212'.
   504     12  ER-2215                 PIC X(4)  VALUE '2215'.
   505     12  ER-2230                 PIC X(4)  VALUE '2230'.
   506     12  ER-2233                 PIC X(4)  VALUE '2233'.
   507     12  ER-2249                 PIC X(4)  VALUE '2249'.
   508     12  ER-2250                 PIC X(4)  VALUE '2250'.
   509     12  ER-2370                 PIC X(4)  VALUE '2370'.
   510     12  ER-2371                 PIC X(4)  VALUE '2371'.
   511     12  ER-2383                 PIC X(4)  VALUE '2383'.
   512     12  ER-2385                 PIC X(4)  VALUE '2385'.
   513     12  ER-2401                 PIC X(4)  VALUE '2401'.
   514     12  ER-2403                 PIC X(4)  VALUE '2403'.
   515     12  ER-2404                 PIC X(4)  VALUE '2404'.
   516     12  ER-2405                 PIC X(4)  VALUE '2405'.
   517     12  ER-2406                 PIC X(4)  VALUE '2406'.
   518     12  ER-2407                 PIC X(4)  VALUE '2407'.
   519     12  ER-2408                 PIC X(4)  VALUE '2408'.
   520     12  ER-2409                 PIC X(4)  VALUE '2409'.
   521     12  ER-2411                 PIC X(4)  VALUE '2411'.
   522     12  ER-2421                 PIC X(4)  VALUE '2421'.
   523     12  ER-2434                 PIC X(4)  VALUE '2434'.
   524     12  ER-2435                 PIC X(4)  VALUE '2435'.
   525     12  ER-2436                 PIC X(4)  VALUE '2436'.
   526     12  ER-2438                 PIC X(4)  VALUE '2438'.
   527     12  ER-2439                 PIC X(4)  VALUE '2439'.
   528     12  ER-2443                 PIC X(4)  VALUE '2443'.
   529     12  ER-2472                 PIC X(4)  VALUE '2472'.
   530     12  ER-2539                 PIC X(4)  VALUE '2539'.
   531     12  ER-2564                 PIC X(4)  VALUE '2564'.
   532     12  ER-2570                 PIC X(4)  VALUE '2570'.
   533     12  ER-2571                 PIC X(4)  VALUE '2571'.
   534     12  ER-2597                 PIC X(4)  VALUE '2597'.
   535     12  ER-3145                 PIC X(4)  VALUE '3145'.
   536     12  ER-3165                 PIC X(4)  VALUE '3165'.
   537     12  ER-3188                 PIC X(4)  VALUE '3188'.
   538     12  ER-7389                 PIC X(4)  VALUE '7389'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  13
* EL640.cbl
   540 01  BI-REPORT-HEADINGS.
   541     12  BI-PREVIEW-HD.
   542         16  FILLER          PIC X(42)           VALUE SPACES.
   543         16  FILLER          PIC X(47)           VALUE
   544                '**** STATEMENT IS FOR REVIEW PURPOSES ONLY ****'.
   545         16  FILLER          PIC X(43)           VALUE SPACES.
   546
   547     12  BI-HD1.
   548         16  FILLER          PIC X(44)           VALUE SPACES.
   549         16  FILLER          PIC X(44)           VALUE
   550                 '  CREDIT LIFE, ACCIDENT & HEALTH STATEMENT  '.
   551         16  FILLER          PIC X(36)           VALUE SPACES.
   552         16  FILLER          PIC X(8)            VALUE ' EL640 '.
   553
   554     12  BI-HD2.
   555         16  FILLER          PIC X(51)           VALUE SPACES.
   556         16  BI-HD-CO        PIC X(30).
   557         16  FILLER          PIC X(43)           VALUE SPACES.
   558         16  BI-HD-RUN-DT    PIC X(8)            VALUE SPACES.
   559
   560     12  BI-HD3.
   561         16  FILLER          PIC X(57)           VALUE SPACES.
   562         16  BI-HD-BILL-DT   PIC X(18).
   563         16  FILLER          PIC X(37)           VALUE SPACES.
   564         16  FILLER          PIC X(5)            VALUE 'PAGE'.
   565         16  BI-HD-PG        PIC ZZ,ZZ9.
   566
   567     12  BI-HD4.
   568         16  FILLER          PIC  X(44)      VALUE
   569             '                               CERTIFICATE  '.
   570         16  FILLER          PIC  X(44)      VALUE
   571             'EFFECTIVE   CANCEL       BEN.      WRITTEN  '.
   572         12  FILLER          PIC  X(44)      VALUE
   573             '    COMP.                    FACE AMOUNT /  '.
   574
   575     12  BI-HD5.
   576         16  FILLER          PIC  X(44)      VALUE
   577             '       NAME OF INSURED            NUMBER    '.
   578         16  FILLER          PIC  X(44)      VALUE
   579             '  DATE       DATE   TERM TYPE      PREMIUM  '.
   580         16  FILLER          PIC  X(44)      VALUE
   581             '     PCT.    COMPENSATION        BENEFIT    '.
   582
   583     12  BI-HD6.
   584         16  FILLER          PIC  X(44)      VALUE SPACES.
   585         16  FILLER          PIC  X(37)      VALUE SPACES.
   586         16  FILLER          PIC  X(45)      VALUE
   587             '     PROCESSED                  NON-PROCESSED'.
   588         16  FILLER          PIC  X(07)      VALUE SPACES.
   589     12  BI-HD7.
   590         16  FILLER          PIC  X(44)      VALUE SPACES.
   591         16  FILLER          PIC  X(35)      VALUE SPACES.
   592         16  FILLER          PIC  X(45)      VALUE
   593             ' PREMIUM     COMMISSION        PREMIUM     CO'.
   594         16  FILLER          PIC  X(09)      VALUE
   595             'MMISSION'.
   596
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  14
* EL640.cbl
   598
   599*                            COPY ELCDATE.
   600******************************************************************
   601*                                                                *
   602*                                                                *
   603*                            ELCDATE.                            *
   604*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   605*                            VMOD=2.003
   606*                                                                *
   607*                                                                *
   608*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   609*                 LENGTH = 200                                   *
   610******************************************************************
   611
   612 01  DATE-CONVERSION-DATA.
   613     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   614     12  DC-OPTION-CODE                PIC X.
   615         88  BIN-TO-GREG                VALUE ' '.
   616         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   617         88  EDIT-GREG-TO-BIN           VALUE '2'.
   618         88  YMD-GREG-TO-BIN            VALUE '3'.
   619         88  MDY-GREG-TO-BIN            VALUE '4'.
   620         88  JULIAN-TO-BIN              VALUE '5'.
   621         88  BIN-PLUS-ELAPSED           VALUE '6'.
   622         88  FIND-CENTURY               VALUE '7'.
   623         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   624         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   625         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   626         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   627         88  JULIAN-TO-BIN-3            VALUE 'C'.
   628         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   629         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   630         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   631         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   632         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   633         88  CHECK-LEAP-YEAR            VALUE 'H'.
   634         88  BIN-3-TO-GREG              VALUE 'I'.
   635         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   636         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   637         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   638         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   639         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   640         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   641         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   642         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   643         88  THREE-CHARACTER-BIN
   644                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   645         88  GREGORIAN-TO-BIN
   646                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   647         88  BIN-TO-GREGORIAN
   648                  VALUES ' ' '1' 'I' '8' 'G'.
   649         88  JULIAN-TO-BINARY
   650                  VALUES '5' 'C' 'E' 'F'.
   651     12  DC-ERROR-CODE                 PIC X.
   652         88  NO-CONVERSION-ERROR        VALUE ' '.
   653         88  DATE-CONVERSION-ERROR
   654                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   655         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  15
* EL640.cbl
   656         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   657         88  DATE-IS-INVALID            VALUE '3'.
   658         88  DATE1-GREATER-DATE2        VALUE '4'.
   659         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   660         88  DATE-INVALID-OPTION        VALUE '9'.
   661         88  INVALID-CENTURY            VALUE 'A'.
   662         88  ONLY-CENTURY               VALUE 'B'.
   663         88  ONLY-LEAP-YEAR             VALUE 'C'.
   664         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   665     12  DC-END-OF-MONTH               PIC X.
   666         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   667     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   668         88  USE-NORMAL-PROCESS         VALUE ' '.
   669         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   670         88  ADJUST-UP-100-YRS          VALUE '2'.
   671     12  FILLER                        PIC X.
   672     12  DC-CONVERSION-DATES.
   673         16  DC-BIN-DATE-1             PIC XX.
   674         16  DC-BIN-DATE-2             PIC XX.
   675         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   676         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   677                       DC-GREG-DATE-1-EDIT.
   678             20  DC-EDIT1-MONTH        PIC 99.
   679             20  SLASH1-1              PIC X.
   680             20  DC-EDIT1-DAY          PIC 99.
   681             20  SLASH1-2              PIC X.
   682             20  DC-EDIT1-YEAR         PIC 99.
   683         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   684         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   685                     DC-GREG-DATE-2-EDIT.
   686             20  DC-EDIT2-MONTH        PIC 99.
   687             20  SLASH2-1              PIC X.
   688             20  DC-EDIT2-DAY          PIC 99.
   689             20  SLASH2-2              PIC X.
   690             20  DC-EDIT2-YEAR         PIC 99.
   691         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   692         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   693                     DC-GREG-DATE-1-YMD.
   694             20  DC-YMD-YEAR           PIC 99.
   695             20  DC-YMD-MONTH          PIC 99.
   696             20  DC-YMD-DAY            PIC 99.
   697         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   698         16  DC-GREG-DATE-1-MDY-R REDEFINES
   699                      DC-GREG-DATE-1-MDY.
   700             20  DC-MDY-MONTH          PIC 99.
   701             20  DC-MDY-DAY            PIC 99.
   702             20  DC-MDY-YEAR           PIC 99.
   703         16  DC-GREG-DATE-1-ALPHA.
   704             20  DC-ALPHA-MONTH        PIC X(10).
   705             20  DC-ALPHA-DAY          PIC 99.
   706             20  FILLER                PIC XX.
   707             20  DC-ALPHA-CENTURY.
   708                 24 DC-ALPHA-CEN-N     PIC 99.
   709             20  DC-ALPHA-YEAR         PIC 99.
   710         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   711         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   712         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   713         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  16
* EL640.cbl
   714         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   715                                       PIC 9(05).
   716         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   717             20  DC-JULIAN-YEAR        PIC 99.
   718             20  DC-JULIAN-DAYS        PIC 999.
   719         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   720         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   721         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   722     12  DATE-CONVERSION-VARIBLES.
   723         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   724         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   725             20  FILLER                PIC 9(3).
   726             20  HOLD-CEN-1-CCYY.
   727                 24  HOLD-CEN-1-CC     PIC 99.
   728                 24  HOLD-CEN-1-YY     PIC 99.
   729             20  HOLD-CEN-1-MO         PIC 99.
   730             20  HOLD-CEN-1-DA         PIC 99.
   731         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   732             20  HOLD-CEN-1-R-MO       PIC 99.
   733             20  HOLD-CEN-1-R-DA       PIC 99.
   734             20  HOLD-CEN-1-R-CCYY.
   735                 24  HOLD-CEN-1-R-CC   PIC 99.
   736                 24  HOLD-CEN-1-R-YY   PIC 99.
   737             20  FILLER                PIC 9(3).
   738         16  HOLD-CENTURY-1-X.
   739             20  FILLER                PIC X(3)  VALUE SPACES.
   740             20  HOLD-CEN-1-X-CCYY.
   741                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   742                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   743             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   744             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   745         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   746             20  HOLD-CEN-1-R-X-MO     PIC XX.
   747             20  HOLD-CEN-1-R-X-DA     PIC XX.
   748             20  HOLD-CEN-1-R-X-CCYY.
   749                 24  HOLD-CEN-1-R-X-CC PIC XX.
   750                 24  HOLD-CEN-1-R-X-YY PIC XX.
   751             20  FILLER                PIC XXX.
   752         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   753         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   754         16  DC-JULIAN-DATE-1          PIC 9(07).
   755         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   756             20  DC-JULIAN-1-CCYY.
   757                 24  DC-JULIAN-1-CC    PIC 99.
   758                 24  DC-JULIAN-1-YR    PIC 99.
   759             20  DC-JULIAN-DA-1        PIC 999.
   760         16  DC-JULIAN-DATE-2          PIC 9(07).
   761         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   762             20  DC-JULIAN-2-CCYY.
   763                 24  DC-JULIAN-2-CC    PIC 99.
   764                 24  DC-JULIAN-2-YR    PIC 99.
   765             20  DC-JULIAN-DA-2        PIC 999.
   766         16  DC-GREG-DATE-A-EDIT.
   767             20  DC-EDITA-MONTH        PIC 99.
   768             20  SLASHA-1              PIC X VALUE '/'.
   769             20  DC-EDITA-DAY          PIC 99.
   770             20  SLASHA-2              PIC X VALUE '/'.
   771             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  17
* EL640.cbl
   772                 24  DC-EDITA-CENT     PIC 99.
   773                 24  DC-EDITA-YEAR     PIC 99.
   774         16  DC-GREG-DATE-B-EDIT.
   775             20  DC-EDITB-MONTH        PIC 99.
   776             20  SLASHB-1              PIC X VALUE '/'.
   777             20  DC-EDITB-DAY          PIC 99.
   778             20  SLASHB-2              PIC X VALUE '/'.
   779             20  DC-EDITB-CCYY.
   780                 24  DC-EDITB-CENT     PIC 99.
   781                 24  DC-EDITB-YEAR     PIC 99.
   782         16  DC-GREG-DATE-CYMD         PIC 9(08).
   783         16  DC-GREG-DATE-CYMD-R REDEFINES
   784                              DC-GREG-DATE-CYMD.
   785             20  DC-CYMD-CEN           PIC 99.
   786             20  DC-CYMD-YEAR          PIC 99.
   787             20  DC-CYMD-MONTH         PIC 99.
   788             20  DC-CYMD-DAY           PIC 99.
   789         16  DC-GREG-DATE-MDCY         PIC 9(08).
   790         16  DC-GREG-DATE-MDCY-R REDEFINES
   791                              DC-GREG-DATE-MDCY.
   792             20  DC-MDCY-MONTH         PIC 99.
   793             20  DC-MDCY-DAY           PIC 99.
   794             20  DC-MDCY-CEN           PIC 99.
   795             20  DC-MDCY-YEAR          PIC 99.
   796    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   797        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   798    12  DC-EL310-DATE                  PIC X(21).
   799    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  18
* EL640.cbl
   801*                            COPY ELCLOGOF.
   802******************************************************************
   803*                                                                *
   804*                                                                *
   805*                            ELCLOGOF.                           *
   806*                            VMOD=2.001                          *
   807*                                                                *
   808*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   809*                                                                *
   810******************************************************************
   811 01  CLASIC-LOGOFF.
   812     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   813     12  LOGOFF-TEXT.
   814         16  FILLER          PIC X(5)    VALUE SPACES.
   815         16  LOGOFF-MSG.
   816             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   817             20  FILLER      PIC X       VALUE SPACES.
   818             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   819         16  FILLER          PIC X(80)
   820           VALUE '* YOU ARE NOW LOGGED OFF'.
   821         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   822         16  FILLER          PIC X       VALUE QUOTE.
   823         16  LOGOFF-SYS-MSG  PIC X(17)
   824           VALUE 'S CLAS-IC SYSTEM '.
   825     12  TEXT-MESSAGES.
   826         16  UNACCESS-MSG    PIC X(29)
   827             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   828         16  PGMIDERR-MSG    PIC X(17)
   829             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  19
* EL640.cbl
   831*                            COPY ELCATTR.
   832******************************************************************
   833*                                                                *
   834*                            ELCATTR.                            *
   835*                            VMOD=2.001                          *
   836*                                                                *
   837*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   838*                                                                *
   839*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   840*                                                                *
   841*                   POS 1   P=PROTECTED                          *
   842*                           U=UNPROTECTED                        *
   843*                           S=ASKIP                              *
   844*                   POS 2   A=ALPHA/NUMERIC                      *
   845*                           N=NUMERIC                            *
   846*                   POS 3   N=NORMAL                             *
   847*                           B=BRIGHT                             *
   848*                           D=DARK                               *
   849*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   850*                           OF=MODIFIED DATA TAG OFF             *
   851*                                                                *
   852*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   853******************************************************************
   854 01  ATTRIBUTE-LIST.
   855     12  AL-PABOF            PIC X       VALUE 'Y'.
   856     12  AL-PABON            PIC X       VALUE 'Z'.
   857     12  AL-PADOF            PIC X       VALUE '%'.
   858     12  AL-PADON            PIC X       VALUE '_'.
   859     12  AL-PANOF            PIC X       VALUE '-'.
   860     12  AL-PANON            PIC X       VALUE '/'.
   861     12  AL-SABOF            PIC X       VALUE '8'.
   862     12  AL-SABON            PIC X       VALUE '9'.
   863     12  AL-SADOF            PIC X       VALUE '@'.
   864     12  AL-SADON            PIC X       VALUE QUOTE.
   865     12  AL-SANOF            PIC X       VALUE '0'.
   866     12  AL-SANON            PIC X       VALUE '1'.
   867     12  AL-UABOF            PIC X       VALUE 'H'.
   868     12  AL-UABON            PIC X       VALUE 'I'.
   869     12  AL-UADOF            PIC X       VALUE '<'.
   870     12  AL-UADON            PIC X       VALUE '('.
   871     12  AL-UANOF            PIC X       VALUE ' '.
   872     12  AL-UANON            PIC X       VALUE 'A'.
   873     12  AL-UNBOF            PIC X       VALUE 'Q'.
   874     12  AL-UNBON            PIC X       VALUE 'R'.
   875     12  AL-UNDOF            PIC X       VALUE '*'.
   876     12  AL-UNDON            PIC X       VALUE ')'.
   877     12  AL-UNNOF            PIC X       VALUE '&'.
   878     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  20
* EL640.cbl
   880*                            COPY ELCEMIB.
   881******************************************************************
   882*                                                                *
   883*                                                                *
   884*                            ELCEMIB.                            *
   885*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   886*                            VMOD=2.005                          *
   887*                                                                *
   888*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   889*                                                                *
   890******************************************************************
   891 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   892     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   893     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   894     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   895     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   896     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   897     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   898     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   899     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   900     12  EMI-SWITCH1             PIC X        VALUE '1'.
   901         88  EMI-NO-ERRORS                    VALUE '1'.
   902         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   903         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   904     12  EMI-SWITCH2             PIC X        VALUE '1'.
   905         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   906     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   907         88  EMI-AREA1-EMPTY                  VALUE '1'.
   908         88  EMI-AREA1-FULL                   VALUE '2'.
   909     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   910         88  EMI-AREA2-EMPTY                  VALUE '1'.
   911         88  EMI-AREA2-FULL                   VALUE '2'.
   912     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   913         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   914         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   915         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   916         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   917         88  EMI-BYPASS-FATALS                VALUE 'X'.
   918     12  EMI-ERROR-LINES.
   919         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   920         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   921         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   922         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   923             20  EMI-ERR-CODES OCCURS 10 TIMES.
   924                 24  EMI-ERR-NUM         PIC X(4).
   925                 24  EMI-FILLER          PIC X.
   926                 24  EMI-SEV             PIC X.
   927                 24  FILLER              PIC X.
   928             20  FILLER                  PIC X(02).
   929     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   930         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   931             20  EMI-ERROR-NUMBER    PIC X(4).
   932             20  EMI-FILL            PIC X.
   933             20  EMI-SEVERITY        PIC X.
   934             20  FILLER              PIC X.
   935             20  EMI-ERROR-TEXT.
   936                 24  EMI-TEXT-VARIABLE   PIC X(10).
   937                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  21
* EL640.cbl
   938     12  EMI-SEVERITY-SAVE           PIC X.
   939         88  EMI-NOTE                    VALUE 'N'.
   940         88  EMI-WARNING                 VALUE 'W'.
   941         88  EMI-FORCABLE                VALUE 'F'.
   942         88  EMI-FATAL                   VALUE 'X'.
   943     12  EMI-MESSAGE-FLAG            PIC X.
   944         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   945         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   946     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   947     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   948         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   949         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   950         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   951     12  emi-claim-no                pic x(7).
   952     12  emi-claim-type              pic x(6).
   953     12  FILLER                      PIC X(124)  VALUE SPACES.
   954     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   955     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   956     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   957     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  22
* EL640.cbl
   959*                            COPY ELCINTF.
   960******************************************************************
   961*                                                                *
   962*                                                                *
   963*                            ELCINTF.                            *
   964*                            VMOD=2.017                          *
   965*                                                                *
   966*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   967*                                                                *
   968*       LENGTH = 1024                                            *
   969*                                                                *
   970******************************************************************
   971*                   C H A N G E   L O G
   972*
   973* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   974*-----------------------------------------------------------------
   975*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   976* EFFECTIVE    NUMBER
   977*-----------------------------------------------------------------
   978* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   979******************************************************************
   980 01  PROGRAM-INTERFACE-BLOCK.
   981     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   982     12  PI-CALLING-PROGRAM              PIC X(8).
   983     12  PI-SAVED-PROGRAM-1              PIC X(8).
   984     12  PI-SAVED-PROGRAM-2              PIC X(8).
   985     12  PI-SAVED-PROGRAM-3              PIC X(8).
   986     12  PI-SAVED-PROGRAM-4              PIC X(8).
   987     12  PI-SAVED-PROGRAM-5              PIC X(8).
   988     12  PI-SAVED-PROGRAM-6              PIC X(8).
   989     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   990     12  PI-COMPANY-ID                   PIC XXX.
   991     12  PI-COMPANY-CD                   PIC X.
   992
   993     12  PI-COMPANY-PASSWORD             PIC X(8).
   994
   995     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   996
   997     12  PI-CONTROL-IN-PROGRESS.
   998         16  PI-CARRIER                  PIC X.
   999         16  PI-GROUPING                 PIC X(6).
  1000         16  PI-STATE                    PIC XX.
  1001         16  PI-ACCOUNT                  PIC X(10).
  1002         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1003                                         PIC X(10).
  1004         16  PI-CLAIM-CERT-GRP.
  1005             20  PI-CLAIM-NO             PIC X(7).
  1006             20  PI-CERT-NO.
  1007                 25  PI-CERT-PRIME       PIC X(10).
  1008                 25  PI-CERT-SFX         PIC X.
  1009             20  PI-CERT-EFF-DT          PIC XX.
  1010         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1011             20  PI-PLAN-CODE            PIC X(2).
  1012             20  PI-REVISION-NUMBER      PIC X(3).
  1013             20  PI-PLAN-EFF-DT          PIC X(2).
  1014             20  PI-PLAN-EXP-DT          PIC X(2).
  1015             20  FILLER                  PIC X(11).
  1016         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  23
* EL640.cbl
  1017             20  PI-OE-REFERENCE-1.
  1018                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1019                 25  PI-OE-REF-1-SUFF    PIC XX.
  1020
  1021     12  PI-SESSION-IN-PROGRESS          PIC X.
  1022         88  CLAIM-SESSION                   VALUE '1'.
  1023         88  CREDIT-SESSION                  VALUE '2'.
  1024         88  WARRANTY-SESSION                VALUE '3'.
  1025         88  MORTGAGE-SESSION                VALUE '4'.
  1026         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1027
  1028
  1029*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1030
  1031     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1032     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1033
  1034     12  PI-CREDIT-USER                  PIC X.
  1035         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1036         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1037
  1038     12  PI-CLAIM-USER                   PIC X.
  1039         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1040         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1041
  1042     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1043         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1044         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1045         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1046         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1047         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1048
  1049     12  PI-PROCESSOR-ID                 PIC X(4).
  1050
  1051     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1052
  1053     12  PI-MEMBER-CAPTION               PIC X(10).
  1054
  1055     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1056         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1057
  1058     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1059     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1060     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1061     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1062
  1063     12  PI-AH-OVERRIDE-L1               PIC X.
  1064     12  PI-AH-OVERRIDE-L2               PIC XX.
  1065     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1066     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1067
  1068     12  PI-NEW-SYSTEM                   PIC X(2).
  1069
  1070     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1071     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1072         88  PI-USES-PAID-TO                 VALUE '1'.
  1073     12  PI-CRDTCRD-SYSTEM.
  1074         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  24
* EL640.cbl
  1075             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1076             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1077         16  PI-CC-MONTH-END-DT          PIC XX.
  1078     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1079
  1080     12  PI-OE-REFERENCE-2.
  1081         16  PI-OE-REF-2-PRIME           PIC X(10).
  1082         16  PI-OE-REF-2-SUFF            PIC X.
  1083
  1084     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1085
  1086     12  PI-LANGUAGE-TYPE                PIC X.
  1087             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1088             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1089             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1090
  1091     12  PI-POLICY-LINKAGE-IND           PIC X.
  1092         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1093         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1094                                                   LOW-VALUES.
  1095
  1096     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1097     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1098         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1099         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1100
  1101     12  PI-PROCESSOR-CSR-IND            PIC X.
  1102         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1103         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1104
  1105     12  FILLER                          PIC X(3).
  1106
  1107     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1108
  1109     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1110         PI-SYSTEM-LEVEL.
  1111
  1112         16  PI-ENTRY-CODES.
  1113             20  PI-ENTRY-CD-1           PIC X.
  1114             20  PI-ENTRY-CD-2           PIC X.
  1115
  1116         16  PI-RETURN-CODES.
  1117             20  PI-RETURN-CD-1          PIC X.
  1118             20  PI-RETURN-CD-2          PIC X.
  1119
  1120         16  PI-UPDATE-STATUS-SAVE.
  1121             20  PI-UPDATE-BY            PIC X(4).
  1122             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1123
  1124         16  PI-LOWER-CASE-LETTERS       PIC X.
  1125             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1126
  1127*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1128*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1129*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1130
  1131         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1132             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  25
* EL640.cbl
  1133             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1134             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1135             88  ACCNT-CNTL                  VALUE '3'.
  1136             88  CARR-ACCNT-CNTL             VALUE '4'.
  1137
  1138         16  PI-PROCESSOR-CAP-LIST.
  1139             20  PI-SYSTEM-CONTROLS.
  1140                24 PI-SYSTEM-DISPLAY     PIC X.
  1141                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1142                24 PI-SYSTEM-MODIFY      PIC X.
  1143                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1144             20  FILLER                  PIC XX.
  1145             20  PI-DISPLAY-CAP          PIC X.
  1146                 88  DISPLAY-CAP             VALUE 'Y'.
  1147             20  PI-MODIFY-CAP           PIC X.
  1148                 88  MODIFY-CAP              VALUE 'Y'.
  1149             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1150                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1151             20  PI-FORCE-CAP            PIC X.
  1152                 88  FORCE-CAP               VALUE 'Y'.
  1153
  1154         16  PI-PROGRAM-CONTROLS.
  1155             20  PI-PGM-PRINT-OPT        PIC X.
  1156             20  PI-PGM-FORMAT-OPT       PIC X.
  1157             20  PI-PGM-PROCESS-OPT      PIC X.
  1158             20  PI-PGM-TOTALS-OPT       PIC X.
  1159
  1160         16  PI-HELP-INTERFACE.
  1161             20  PI-LAST-ERROR-NO        PIC X(4).
  1162             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1163
  1164         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1165             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1166
  1167         16  PI-CR-CONTROL-IN-PROGRESS.
  1168             20  PI-CR-CARRIER           PIC X.
  1169             20  PI-CR-GROUPING          PIC X(6).
  1170             20  PI-CR-STATE             PIC XX.
  1171             20  PI-CR-ACCOUNT           PIC X(10).
  1172             20  PI-CR-FIN-RESP          PIC X(10).
  1173             20  PI-CR-TYPE              PIC X.
  1174
  1175         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1176
  1177         16  PI-CR-MONTH-END-DT          PIC XX.
  1178
  1179         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1180             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1181             88  PI-ZERO-CARRIER             VALUE '1'.
  1182             88  PI-ZERO-GROUPING            VALUE '2'.
  1183             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1184
  1185         16  PI-CARRIER-SECURITY         PIC X.
  1186             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1187
  1188         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1189             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1190             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  26
* EL640.cbl
  1191
  1192         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1193             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1194                                         INDEXED BY PI-ACCESS-NDX
  1195                                         PIC X.
  1196
  1197         16  PI-GA-BILLING-CONTROL       PIC X.
  1198             88  PI-GA-BILLING               VALUE '1'.
  1199
  1200         16  PI-MAIL-PROCESSING          PIC X.
  1201             88  PI-MAIL-YES                 VALUE 'Y'.
  1202
  1203         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1204
  1205         16  PI-AR-SYSTEM.
  1206             20  PI-AR-PROCESSING-CNTL   PIC X.
  1207                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1208             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1209             20  PI-AR-MONTH-END-DT      PIC XX.
  1210
  1211         16  PI-MP-SYSTEM.
  1212             20  PI-MORTGAGE-USER            PIC X.
  1213                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1214                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1215             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1216                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1217                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1218                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1219                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1220                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1221             20  PI-MP-MONTH-END-DT          PIC XX.
  1222             20  PI-MP-REFERENCE-NO.
  1223                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1224                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1225
  1226         16  PI-LABEL-CONTROL            PIC X(01).
  1227             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1228             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1229
  1230         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1231             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1232
  1233         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1234             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1235             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1236
  1237         16  FILLER                      PIC X(14).
  1238
  1239     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1240******************************************************************
  1241     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1242         16  PI-MAP-NAME         PIC X(8).
  1243         16  PI-ACCT-NAME        PIC X(30).
  1244         16  PI-SAV-REMIT-TO     PIC X(10).
  1245         16  PI-SAV-ACCT         PIC X(10).
  1246         16  PI-SAV-CARR         PIC X.
  1247         16  PI-SAV-GROUP        PIC X(6).
  1248         16  PI-SAV-STATE        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  27
* EL640.cbl
  1249         16  PI-SAV-EXP-DT       PIC XX.
  1250         16  PI-BAL-FRWD-GA      PIC S9(7)V99   COMP-3.
  1251         16  PI-BAL-FRWD         PIC S9(7)V99   COMP-3.
  1252         16  PI-PREMIUM          PIC S9(7)V99   COMP-3.
  1253         16  PI-REMITTED         PIC S9(7)V99   COMP-3.
  1254         16  PI-TOT-ISS-COMP     PIC S9(7)V99   COMP-3.
  1255         16  PI-TOT-CAN-COMP     PIC S9(7)V99   COMP-3.
  1256         16  PI-ADJUSTMENTS      PIC S9(7)V99   COMP-3.
  1257         16  PI-DISBURSED        PIC S9(7)V99   COMP-3.
  1258         16  PI-END-BAL          PIC S9(7)V99   COMP-3.
  1259         16  PI-LF-ISS-COMP      PIC S9(7)V99   COMP-3.
  1260         16  PI-AH-ISS-COMP      PIC S9(7)V99   COMP-3.
  1261         16  PI-LF-CAN-COMP      PIC S9(7)V99   COMP-3.
  1262         16  PI-AH-CAN-COMP      PIC S9(7)V99   COMP-3.
  1263         16  PI-LIMIT-BILLING-BTCHS.
  1264             20  PI-BILLING-BATCHES   OCCURS 3 TIMES
  1265                                 PIC X(6).
  1266         16  PI-BILL-TYPE        PIC X.
  1267             88  PI-PREV-BILL        VALUE '1'.
  1268             88  PI-PREV-REBILL      VALUE '2'.
  1269             88  PI-PREVIEW          VALUE '1' '2'.
  1270             88  PI-BILL             VALUE '3'.
  1271             88  PI-REBILLING        VALUE '4'.
  1272             88  PI-VOID-BILL        VALUE '5'.
  1273             88  PI-TOT-REBILL       VALUE '2' '4'.
  1274             88  PI-UPDATE-FILES     VALUE '3' '4' '5'.
  1275             88  PI-BILLING-FUNCTION VALUE '1' '2' '3' '4'.
  1276         16  PI-BILL-ERRS        PIC X.
  1277         16  PI-CHECK-SW         PIC X.
  1278             88  PI-CHECK-PRODUCED   VALUE 'Y'.
  1279         16  PI-DATA-BILLED-SW   PIC X.
  1280             88  PI-DATA-BILLED      VALUE 'Y'.
  1281         16  PI-MONTH-END-DATE.
  1282             20  PI-ME-MONTH     PIC 99.
  1283             20  FILLER          PIC X.
  1284             20  PI-ME-DAY       PIC 99.
  1285             20  FILLER          PIC X.
  1286             20  PI-ME-YEAR      PIC 99.
  1287         16  PI-BILLING-COUNTS.
  1288             20  FILLER OCCURS 6 TIMES INDEXED BY PINDX.
  1289                 24  PI-BATCH    PIC X(6).
  1290                 24  PI-BILLED   PIC 9(6)  COMP-3.
  1291                 24  PI-PREV     PIC 9(6)  COMP-3.
  1292                 24  PI-NOBILL   PIC 9(6)  COMP-3.
  1293                 24  PI-PREM     PIC S9(7)V99   COMP-3.
  1294                 24  PI-COMM     PIC S9(7)V99   COMP-3.
  1295                 24  PI-NON-PREM PIC S9(7)V99   COMP-3.
  1296                 24  PI-NON-COMM PIC S9(7)V99   COMP-3.
  1297         16  PI-COMP-CONTROL.
  1298             20  PI-COMP-CARRIER     PIC X.
  1299             20  PI-COMP-GROUPING    PIC X(6).
  1300             20  PI-COMP-FIN-RESP    PIC X(10).
  1301         16  PI-SCRN-CONTROL.
  1302             20  PI-SCR-CARRIER      PIC X.
  1303             20  PI-SCR-GROUPING     PIC X(6).
  1304             20  PI-SCR-STATE        PIC X(02).
  1305             20  PI-SCR-ACCOUNT      PIC X(10).
  1306             20  PI-SCR-FIN-RESP     PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  28
* EL640.cbl
  1307             20  PI-SCR-TYPE         PIC X.
  1308         16  PI-TRANSFER-SW          PIC X.
  1309             88  PI-TRANSFER-BEFORE-ACT   VALUE 'Y'.
  1310         16  FILLER                  PIC X(200).
  1311
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  29
* EL640.cbl
  1313*                            COPY ELCJPFX.
  1314******************************************************************
  1315*                                                                *
  1316*                                                                *
  1317*                            ELCJPFX.                            *
  1318*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1319*                            VMOD=2.002                          *
  1320*                                                                *
  1321*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1322*                                                                *
  1323*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1324*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1325*        ELCNTL - CONTROL FILE                                   *
  1326*        ELMSTR - CLAIM MASTERS                                  *
  1327*        ELTRLR - ACTIVITY TRAILERS                              *
  1328*        ELCHKQ - CHECK QUE                                      *
  1329******************************************************************
  1330 01  JOURNAL-RECORD.
  1331     12  jp-date                     pic s9(5) comp-3.
  1332     12  jp-time                     pic s9(7) comp-3.
  1333     12  JP-USER-ID                  PIC X(4).
  1334     12  JP-FILE-ID                  PIC X(8).
  1335     12  JP-PROGRAM-ID               PIC X(8).
  1336     12  JP-RECORD-TYPE              PIC X.
  1337         88 JP-ADD              VALUE 'A'.
  1338         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1339         88 JP-AFTER-CHANGE     VALUE 'C'.
  1340         88 JP-DELETE           VALUE 'D'.
  1341         88 JP-GENERIC-DELETE   VALUE 'G'.
  1342         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1343         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1344     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1345     12  JP-RECORD-AREA
  1346
  1347
  1348                             PIC X(1464).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  30
* EL640.cbl
  1350*                            COPY ELCAID.
  1351******************************************************************
  1352*                                                                *
  1353*                            ELCAID.                             *
  1354*                            VMOD=2.001                          *
  1355*                                                                *
  1356*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1357*                                                                *
  1358*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1359*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1360******************************************************************
  1361
  1362 01  DFHAID.
  1363   02  DFHNULL   PIC  X  VALUE  ' '.
  1364   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1365   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1366   02  DFHPEN    PIC  X  VALUE  '='.
  1367   02  DFHOPID   PIC  X  VALUE  'W'.
  1368   02  DFHPA1    PIC  X  VALUE  '%'.
  1369   02  DFHPA2    PIC  X  VALUE  '>'.
  1370   02  DFHPA3    PIC  X  VALUE  ','.
  1371   02  DFHPF1    PIC  X  VALUE  '1'.
  1372   02  DFHPF2    PIC  X  VALUE  '2'.
  1373   02  DFHPF3    PIC  X  VALUE  '3'.
  1374   02  DFHPF4    PIC  X  VALUE  '4'.
  1375   02  DFHPF5    PIC  X  VALUE  '5'.
  1376   02  DFHPF6    PIC  X  VALUE  '6'.
  1377   02  DFHPF7    PIC  X  VALUE  '7'.
  1378   02  DFHPF8    PIC  X  VALUE  '8'.
  1379   02  DFHPF9    PIC  X  VALUE  '9'.
  1380   02  DFHPF10   PIC  X  VALUE  ':'.
  1381   02  DFHPF11   PIC  X  VALUE  '#'.
  1382   02  DFHPF12   PIC  X  VALUE  '@'.
  1383   02  DFHPF13   PIC  X  VALUE  'A'.
  1384   02  DFHPF14   PIC  X  VALUE  'B'.
  1385   02  DFHPF15   PIC  X  VALUE  'C'.
  1386   02  DFHPF16   PIC  X  VALUE  'D'.
  1387   02  DFHPF17   PIC  X  VALUE  'E'.
  1388   02  DFHPF18   PIC  X  VALUE  'F'.
  1389   02  DFHPF19   PIC  X  VALUE  'G'.
  1390   02  DFHPF20   PIC  X  VALUE  'H'.
  1391   02  DFHPF21   PIC  X  VALUE  'I'.
  1392*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1393   02  DFHPF22   PIC  X  VALUE  '['.
  1394   02  DFHPF23   PIC  X  VALUE  '.'.
  1395   02  DFHPF24   PIC  X  VALUE  '<'.
  1396   02  DFHMSRE   PIC  X  VALUE  'X'.
  1397   02  DFHSTRF   PIC  X  VALUE  'h'.
  1398   02  DFHTRIG   PIC  X  VALUE  '"'.
  1399 01  FILLER    REDEFINES DFHAID.
  1400     12  FILLER              PIC X(8).
  1401     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  31
* EL640.cbl
  1403*                                         COPY EL640S.
  1404 01  EL640AI.
  1405     05  FILLER            PIC  X(0012).
  1406*    -------------------------------
  1407     05  ADATEL PIC S9(0004) COMP.
  1408     05  ADATEF PIC  X(0001).
  1409     05  FILLER REDEFINES ADATEF.
  1410         10  ADATEA PIC  X(0001).
  1411     05  ADATEI PIC  X(0008).
  1412*    -------------------------------
  1413     05  ATIMEL PIC S9(0004) COMP.
  1414     05  ATIMEF PIC  X(0001).
  1415     05  FILLER REDEFINES ATIMEF.
  1416         10  ATIMEA PIC  X(0001).
  1417     05  ATIMEI PIC  X(0005).
  1418*    -------------------------------
  1419     05  CMPNYIDL PIC S9(0004) COMP.
  1420     05  CMPNYIDF PIC  X(0001).
  1421     05  FILLER REDEFINES CMPNYIDF.
  1422         10  CMPNYIDA PIC  X(0001).
  1423     05  CMPNYIDI PIC  X(0003).
  1424*    -------------------------------
  1425     05  USERIDL PIC S9(0004) COMP.
  1426     05  USERIDF PIC  X(0001).
  1427     05  FILLER REDEFINES USERIDF.
  1428         10  USERIDA PIC  X(0001).
  1429     05  USERIDI PIC  X(0004).
  1430*    -------------------------------
  1431     05  AACTNAML PIC S9(0004) COMP.
  1432     05  AACTNAMF PIC  X(0001).
  1433     05  FILLER REDEFINES AACTNAMF.
  1434         10  AACTNAMA PIC  X(0001).
  1435     05  AACTNAMI PIC  X(0030).
  1436*    -------------------------------
  1437     05  ACARHDGL PIC S9(0004) COMP.
  1438     05  ACARHDGF PIC  X(0001).
  1439     05  FILLER REDEFINES ACARHDGF.
  1440         10  ACARHDGA PIC  X(0001).
  1441     05  ACARHDGI PIC  X(0007).
  1442*    -------------------------------
  1443     05  AGRPHDGL PIC S9(0004) COMP.
  1444     05  AGRPHDGF PIC  X(0001).
  1445     05  FILLER REDEFINES AGRPHDGF.
  1446         10  AGRPHDGA PIC  X(0001).
  1447     05  AGRPHDGI PIC  X(0005).
  1448*    -------------------------------
  1449     05  ASTHDGL PIC S9(0004) COMP.
  1450     05  ASTHDGF PIC  X(0001).
  1451     05  FILLER REDEFINES ASTHDGF.
  1452         10  ASTHDGA PIC  X(0001).
  1453     05  ASTHDGI PIC  X(0005).
  1454*    -------------------------------
  1455     05  AACCTL PIC S9(0004) COMP.
  1456     05  AACCTF PIC  X(0001).
  1457     05  FILLER REDEFINES AACCTF.
  1458         10  AACCTA PIC  X(0001).
  1459     05  AACCTI PIC  X(0010).
  1460*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  32
* EL640.cbl
  1461     05  ACARIERL PIC S9(0004) COMP.
  1462     05  ACARIERF PIC  X(0001).
  1463     05  FILLER REDEFINES ACARIERF.
  1464         10  ACARIERA PIC  X(0001).
  1465     05  ACARIERI PIC  X(0001).
  1466*    -------------------------------
  1467     05  AGROUPL PIC S9(0004) COMP.
  1468     05  AGROUPF PIC  X(0001).
  1469     05  FILLER REDEFINES AGROUPF.
  1470         10  AGROUPA PIC  X(0001).
  1471     05  AGROUPI PIC  X(0006).
  1472*    -------------------------------
  1473     05  ASTATEL PIC S9(0004) COMP.
  1474     05  ASTATEF PIC  X(0001).
  1475     05  FILLER REDEFINES ASTATEF.
  1476         10  ASTATEA PIC  X(0001).
  1477     05  ASTATEI PIC  X(0002).
  1478*    -------------------------------
  1479     05  ABALFWDL PIC S9(0004) COMP.
  1480     05  ABALFWDF PIC  X(0001).
  1481     05  FILLER REDEFINES ABALFWDF.
  1482         10  ABALFWDA PIC  X(0001).
  1483     05  ABALFWDI PIC  X(0011).
  1484*    -------------------------------
  1485     05  APREMUML PIC S9(0004) COMP.
  1486     05  APREMUMF PIC  X(0001).
  1487     05  FILLER REDEFINES APREMUMF.
  1488         10  APREMUMA PIC  X(0001).
  1489     05  APREMUMI PIC  X(0011).
  1490*    -------------------------------
  1491     05  AHD1L PIC S9(0004) COMP.
  1492     05  AHD1F PIC  X(0001).
  1493     05  FILLER REDEFINES AHD1F.
  1494         10  AHD1A PIC  X(0001).
  1495     05  AHD1I PIC  X(0018).
  1496*    -------------------------------
  1497     05  AREMITL PIC S9(0004) COMP.
  1498     05  AREMITF PIC  X(0001).
  1499     05  FILLER REDEFINES AREMITF.
  1500         10  AREMITA PIC  X(0001).
  1501     05  AREMITI PIC  X(0011).
  1502*    -------------------------------
  1503     05  ABATCH1L PIC S9(0004) COMP.
  1504     05  ABATCH1F PIC  X(0001).
  1505     05  FILLER REDEFINES ABATCH1F.
  1506         10  ABATCH1A PIC  X(0001).
  1507     05  ABATCH1I PIC  X(0006).
  1508*    -------------------------------
  1509     05  ABILL1L PIC S9(0004) COMP.
  1510     05  ABILL1F PIC  X(0001).
  1511     05  FILLER REDEFINES ABILL1F.
  1512         10  ABILL1A PIC  X(0001).
  1513     05  ABILL1I PIC  X(0006).
  1514*    -------------------------------
  1515     05  APREV1L PIC S9(0004) COMP.
  1516     05  APREV1F PIC  X(0001).
  1517     05  FILLER REDEFINES APREV1F.
  1518         10  APREV1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  33
* EL640.cbl
  1519     05  APREV1I PIC  X(0006).
  1520*    -------------------------------
  1521     05  ANOBIL1L PIC S9(0004) COMP.
  1522     05  ANOBIL1F PIC  X(0001).
  1523     05  FILLER REDEFINES ANOBIL1F.
  1524         10  ANOBIL1A PIC  X(0001).
  1525     05  ANOBIL1I PIC  X(0006).
  1526*    -------------------------------
  1527     05  AHD2L PIC S9(0004) COMP.
  1528     05  AHD2F PIC  X(0001).
  1529     05  FILLER REDEFINES AHD2F.
  1530         10  AHD2A PIC  X(0001).
  1531     05  AHD2I PIC  X(0018).
  1532*    -------------------------------
  1533     05  ACOMPISL PIC S9(0004) COMP.
  1534     05  ACOMPISF PIC  X(0001).
  1535     05  FILLER REDEFINES ACOMPISF.
  1536         10  ACOMPISA PIC  X(0001).
  1537     05  ACOMPISI PIC  X(0011).
  1538*    -------------------------------
  1539     05  ABATCH2L PIC S9(0004) COMP.
  1540     05  ABATCH2F PIC  X(0001).
  1541     05  FILLER REDEFINES ABATCH2F.
  1542         10  ABATCH2A PIC  X(0001).
  1543     05  ABATCH2I PIC  X(0006).
  1544*    -------------------------------
  1545     05  ABILL2L PIC S9(0004) COMP.
  1546     05  ABILL2F PIC  X(0001).
  1547     05  FILLER REDEFINES ABILL2F.
  1548         10  ABILL2A PIC  X(0001).
  1549     05  ABILL2I PIC  X(0006).
  1550*    -------------------------------
  1551     05  APREV2L PIC S9(0004) COMP.
  1552     05  APREV2F PIC  X(0001).
  1553     05  FILLER REDEFINES APREV2F.
  1554         10  APREV2A PIC  X(0001).
  1555     05  APREV2I PIC  X(0006).
  1556*    -------------------------------
  1557     05  ANOBIL2L PIC S9(0004) COMP.
  1558     05  ANOBIL2F PIC  X(0001).
  1559     05  FILLER REDEFINES ANOBIL2F.
  1560         10  ANOBIL2A PIC  X(0001).
  1561     05  ANOBIL2I PIC  X(0006).
  1562*    -------------------------------
  1563     05  AHD3L PIC S9(0004) COMP.
  1564     05  AHD3F PIC  X(0001).
  1565     05  FILLER REDEFINES AHD3F.
  1566         10  AHD3A PIC  X(0001).
  1567     05  AHD3I PIC  X(0018).
  1568*    -------------------------------
  1569     05  ACOMCANL PIC S9(0004) COMP.
  1570     05  ACOMCANF PIC  X(0001).
  1571     05  FILLER REDEFINES ACOMCANF.
  1572         10  ACOMCANA PIC  X(0001).
  1573     05  ACOMCANI PIC  X(0011).
  1574*    -------------------------------
  1575     05  ABATCH3L PIC S9(0004) COMP.
  1576     05  ABATCH3F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  34
* EL640.cbl
  1577     05  FILLER REDEFINES ABATCH3F.
  1578         10  ABATCH3A PIC  X(0001).
  1579     05  ABATCH3I PIC  X(0006).
  1580*    -------------------------------
  1581     05  ABILL3L PIC S9(0004) COMP.
  1582     05  ABILL3F PIC  X(0001).
  1583     05  FILLER REDEFINES ABILL3F.
  1584         10  ABILL3A PIC  X(0001).
  1585     05  ABILL3I PIC  X(0006).
  1586*    -------------------------------
  1587     05  APREV3L PIC S9(0004) COMP.
  1588     05  APREV3F PIC  X(0001).
  1589     05  FILLER REDEFINES APREV3F.
  1590         10  APREV3A PIC  X(0001).
  1591     05  APREV3I PIC  X(0006).
  1592*    -------------------------------
  1593     05  ANOBIL3L PIC S9(0004) COMP.
  1594     05  ANOBIL3F PIC  X(0001).
  1595     05  FILLER REDEFINES ANOBIL3F.
  1596         10  ANOBIL3A PIC  X(0001).
  1597     05  ANOBIL3I PIC  X(0006).
  1598*    -------------------------------
  1599     05  AHD4L PIC S9(0004) COMP.
  1600     05  AHD4F PIC  X(0001).
  1601     05  FILLER REDEFINES AHD4F.
  1602         10  AHD4A PIC  X(0001).
  1603     05  AHD4I PIC  X(0018).
  1604*    -------------------------------
  1605     05  AADJUSTL PIC S9(0004) COMP.
  1606     05  AADJUSTF PIC  X(0001).
  1607     05  FILLER REDEFINES AADJUSTF.
  1608         10  AADJUSTA PIC  X(0001).
  1609     05  AADJUSTI PIC  X(0011).
  1610*    -------------------------------
  1611     05  ABATCH4L PIC S9(0004) COMP.
  1612     05  ABATCH4F PIC  X(0001).
  1613     05  FILLER REDEFINES ABATCH4F.
  1614         10  ABATCH4A PIC  X(0001).
  1615     05  ABATCH4I PIC  X(0006).
  1616*    -------------------------------
  1617     05  ABILL4L PIC S9(0004) COMP.
  1618     05  ABILL4F PIC  X(0001).
  1619     05  FILLER REDEFINES ABILL4F.
  1620         10  ABILL4A PIC  X(0001).
  1621     05  ABILL4I PIC  X(0006).
  1622*    -------------------------------
  1623     05  APREV4L PIC S9(0004) COMP.
  1624     05  APREV4F PIC  X(0001).
  1625     05  FILLER REDEFINES APREV4F.
  1626         10  APREV4A PIC  X(0001).
  1627     05  APREV4I PIC  X(0006).
  1628*    -------------------------------
  1629     05  ANOBIL4L PIC S9(0004) COMP.
  1630     05  ANOBIL4F PIC  X(0001).
  1631     05  FILLER REDEFINES ANOBIL4F.
  1632         10  ANOBIL4A PIC  X(0001).
  1633     05  ANOBIL4I PIC  X(0006).
  1634*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  35
* EL640.cbl
  1635     05  AHD5L PIC S9(0004) COMP.
  1636     05  AHD5F PIC  X(0001).
  1637     05  FILLER REDEFINES AHD5F.
  1638         10  AHD5A PIC  X(0001).
  1639     05  AHD5I PIC  X(0018).
  1640*    -------------------------------
  1641     05  ADISBURL PIC S9(0004) COMP.
  1642     05  ADISBURF PIC  X(0001).
  1643     05  FILLER REDEFINES ADISBURF.
  1644         10  ADISBURA PIC  X(0001).
  1645     05  ADISBURI PIC  X(0011).
  1646*    -------------------------------
  1647     05  ABATCH5L PIC S9(0004) COMP.
  1648     05  ABATCH5F PIC  X(0001).
  1649     05  FILLER REDEFINES ABATCH5F.
  1650         10  ABATCH5A PIC  X(0001).
  1651     05  ABATCH5I PIC  X(0006).
  1652*    -------------------------------
  1653     05  ABILL5L PIC S9(0004) COMP.
  1654     05  ABILL5F PIC  X(0001).
  1655     05  FILLER REDEFINES ABILL5F.
  1656         10  ABILL5A PIC  X(0001).
  1657     05  ABILL5I PIC  X(0006).
  1658*    -------------------------------
  1659     05  APREV5L PIC S9(0004) COMP.
  1660     05  APREV5F PIC  X(0001).
  1661     05  FILLER REDEFINES APREV5F.
  1662         10  APREV5A PIC  X(0001).
  1663     05  APREV5I PIC  X(0006).
  1664*    -------------------------------
  1665     05  ANOBIL5L PIC S9(0004) COMP.
  1666     05  ANOBIL5F PIC  X(0001).
  1667     05  FILLER REDEFINES ANOBIL5F.
  1668         10  ANOBIL5A PIC  X(0001).
  1669     05  ANOBIL5I PIC  X(0006).
  1670*    -------------------------------
  1671     05  AENDHDGL PIC S9(0004) COMP.
  1672     05  AENDHDGF PIC  X(0001).
  1673     05  FILLER REDEFINES AENDHDGF.
  1674         10  AENDHDGA PIC  X(0001).
  1675     05  AENDHDGI PIC  X(0018).
  1676*    -------------------------------
  1677     05  ANETDUEL PIC S9(0004) COMP.
  1678     05  ANETDUEF PIC  X(0001).
  1679     05  FILLER REDEFINES ANETDUEF.
  1680         10  ANETDUEA PIC  X(0001).
  1681     05  ANETDUEI PIC  X(0011).
  1682*    -------------------------------
  1683     05  ABATCH6L PIC S9(0004) COMP.
  1684     05  ABATCH6F PIC  X(0001).
  1685     05  FILLER REDEFINES ABATCH6F.
  1686         10  ABATCH6A PIC  X(0001).
  1687     05  ABATCH6I PIC  X(0006).
  1688*    -------------------------------
  1689     05  ABILL6L PIC S9(0004) COMP.
  1690     05  ABILL6F PIC  X(0001).
  1691     05  FILLER REDEFINES ABILL6F.
  1692         10  ABILL6A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  36
* EL640.cbl
  1693     05  ABILL6I PIC  X(0006).
  1694*    -------------------------------
  1695     05  APREV6L PIC S9(0004) COMP.
  1696     05  APREV6F PIC  X(0001).
  1697     05  FILLER REDEFINES APREV6F.
  1698         10  APREV6A PIC  X(0001).
  1699     05  APREV6I PIC  X(0006).
  1700*    -------------------------------
  1701     05  ANOBIL6L PIC S9(0004) COMP.
  1702     05  ANOBIL6F PIC  X(0001).
  1703     05  FILLER REDEFINES ANOBIL6F.
  1704         10  ANOBIL6A PIC  X(0001).
  1705     05  ANOBIL6I PIC  X(0006).
  1706*    -------------------------------
  1707     05  ABILTYPL PIC S9(0004) COMP.
  1708     05  ABILTYPF PIC  X(0001).
  1709     05  FILLER REDEFINES ABILTYPF.
  1710         10  ABILTYPA PIC  X(0001).
  1711     05  ABILTYPI PIC  X(0001).
  1712*    -------------------------------
  1713     05  APRODSWL PIC S9(0004) COMP.
  1714     05  APRODSWF PIC  X(0001).
  1715     05  FILLER REDEFINES APRODSWF.
  1716         10  APRODSWA PIC  X(0001).
  1717     05  APRODSWI PIC  X(0001).
  1718*    -------------------------------
  1719     05  ABILERRL PIC S9(0004) COMP.
  1720     05  ABILERRF PIC  X(0001).
  1721     05  FILLER REDEFINES ABILERRF.
  1722         10  ABILERRA PIC  X(0001).
  1723     05  ABILERRI PIC  X(0001).
  1724*    -------------------------------
  1725     05  ABTCH1L PIC S9(0004) COMP.
  1726     05  ABTCH1F PIC  X(0001).
  1727     05  FILLER REDEFINES ABTCH1F.
  1728         10  ABTCH1A PIC  X(0001).
  1729     05  ABTCH1I PIC  X(0006).
  1730*    -------------------------------
  1731     05  ABTCH2L PIC S9(0004) COMP.
  1732     05  ABTCH2F PIC  X(0001).
  1733     05  FILLER REDEFINES ABTCH2F.
  1734         10  ABTCH2A PIC  X(0001).
  1735     05  ABTCH2I PIC  X(0006).
  1736*    -------------------------------
  1737     05  ABTCH3L PIC S9(0004) COMP.
  1738     05  ABTCH3F PIC  X(0001).
  1739     05  FILLER REDEFINES ABTCH3F.
  1740         10  ABTCH3A PIC  X(0001).
  1741     05  ABTCH3I PIC  X(0006).
  1742*    -------------------------------
  1743     05  AERMSG1L PIC S9(0004) COMP.
  1744     05  AERMSG1F PIC  X(0001).
  1745     05  FILLER REDEFINES AERMSG1F.
  1746         10  AERMSG1A PIC  X(0001).
  1747     05  AERMSG1I PIC  X(0076).
  1748*    -------------------------------
  1749     05  AERMSG2L PIC S9(0004) COMP.
  1750     05  AERMSG2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  37
* EL640.cbl
  1751     05  FILLER REDEFINES AERMSG2F.
  1752         10  AERMSG2A PIC  X(0001).
  1753     05  AERMSG2I PIC  X(0076).
  1754*    -------------------------------
  1755     05  APFNTERL PIC S9(0004) COMP.
  1756     05  APFNTERF PIC  X(0001).
  1757     05  FILLER REDEFINES APFNTERF.
  1758         10  APFNTERA PIC  X(0001).
  1759     05  APFNTERI PIC  9(2).
  1760*    -------------------------------
  1761     05  APF5HDGL PIC S9(0004) COMP.
  1762     05  APF5HDGF PIC  X(0001).
  1763     05  FILLER REDEFINES APF5HDGF.
  1764         10  APF5HDGA PIC  X(0001).
  1765     05  APF5HDGI PIC  X(0020).
  1766*    -------------------------------
  1767     05  AGAHDGL PIC S9(0004) COMP.
  1768     05  AGAHDGF PIC  X(0001).
  1769     05  FILLER REDEFINES AGAHDGF.
  1770         10  AGAHDGA PIC  X(0001).
  1771     05  AGAHDGI PIC  X(0025).
  1772 01  EL640AO REDEFINES EL640AI.
  1773     05  FILLER            PIC  X(0012).
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  ADATEO PIC  X(0008).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  ATIMEO PIC  99.99.
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  CMPNYIDO PIC  X(0003).
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  USERIDO PIC  X(0004).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  AACTNAMO PIC  X(0030).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  ACARHDGO PIC  X(0007).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  AGRPHDGO PIC  X(0005).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  ASTHDGO PIC  X(0005).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  AACCTO PIC  X(0010).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  ACARIERO PIC  X(0001).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  AGROUPO PIC  X(0006).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  38
* EL640.cbl
  1809     05  ASTATEO PIC  X(0002).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  ABALFWDO PIC  ZZZZZZ9.99-.
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  APREMUMO PIC  ZZZZZZ9.99-.
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  AHD1O PIC  X(0018).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  AREMITO PIC  ZZZZZZ9.99-.
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  ABATCH1O PIC  X(0006).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  ABILL1O PIC  Z(5)9.
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  APREV1O PIC  Z(5)9.
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  ANOBIL1O PIC  Z(5)9.
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  AHD2O PIC  X(0018).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  ACOMPISO PIC  ZZZZZZ9.99-.
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  ABATCH2O PIC  X(0006).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  ABILL2O PIC  Z(5)9.
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  APREV2O PIC  Z(5)9.
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  ANOBIL2O PIC  Z(5)9.
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  AHD3O PIC  X(0018).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  ACOMCANO PIC  ZZZZZZ9.99-.
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  ABATCH3O PIC  X(0006).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  ABILL3O PIC  Z(5)9.
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  APREV3O PIC  Z(5)9.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  39
* EL640.cbl
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  ANOBIL3O PIC  Z(5)9.
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  AHD4O PIC  X(0018).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  AADJUSTO PIC  ZZZZZZ9.99-.
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  ABATCH4O PIC  X(0006).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  ABILL4O PIC  Z(5)9.
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  APREV4O PIC  Z(5)9.
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  ANOBIL4O PIC  Z(5)9.
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  AHD5O PIC  X(0018).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  ADISBURO PIC  ZZZZZZ9.99-.
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  ABATCH5O PIC  X(0006).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  ABILL5O PIC  Z(5)9.
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  APREV5O PIC  Z(5)9.
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  ANOBIL5O PIC  Z(5)9.
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  AENDHDGO PIC  X(0018).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  ANETDUEO PIC  ZZZZZZ9.99-.
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  ABATCH6O PIC  X(0006).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  ABILL6O PIC  Z(5)9.
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  APREV6O PIC  Z(5)9.
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  ANOBIL6O PIC  Z(5)9.
  1924*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  40
* EL640.cbl
  1925     05  FILLER            PIC  X(0003).
  1926     05  ABILTYPO PIC  X(0001).
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  APRODSWO PIC  X(0001).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  ABILERRO PIC  X(0001).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  ABTCH1O PIC  X(0006).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  ABTCH2O PIC  X(0006).
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  ABTCH3O PIC  X(0006).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  AERMSG1O PIC  X(0076).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  AERMSG2O PIC  X(0076).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  APFNTERO PIC  99.
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  APF5HDGO PIC  X(0020).
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  AGAHDGO PIC  X(0025).
  1957*    -------------------------------
  1958 01  EL640BI REDEFINES EL640AI.
  1959     05  FILLER            PIC  X(0012).
  1960*    -------------------------------
  1961     05  BDATEL PIC S9(0004) COMP.
  1962     05  BDATEF PIC  X(0001).
  1963     05  FILLER REDEFINES BDATEF.
  1964         10  BDATEA PIC  X(0001).
  1965     05  BDATEI PIC  X(0008).
  1966*    -------------------------------
  1967     05  BTIMEL PIC S9(0004) COMP.
  1968     05  BTIMEF PIC  X(0001).
  1969     05  FILLER REDEFINES BTIMEF.
  1970         10  BTIMEA PIC  X(0001).
  1971     05  BTIMEI PIC  X(0005).
  1972*    -------------------------------
  1973     05  BCMPNYL PIC S9(0004) COMP.
  1974     05  BCMPNYF PIC  X(0001).
  1975     05  FILLER REDEFINES BCMPNYF.
  1976         10  BCMPNYA PIC  X(0001).
  1977     05  BCMPNYI PIC  X(0003).
  1978*    -------------------------------
  1979     05  BUSERIDL PIC S9(0004) COMP.
  1980     05  BUSERIDF PIC  X(0001).
  1981     05  FILLER REDEFINES BUSERIDF.
  1982         10  BUSERIDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  41
* EL640.cbl
  1983     05  BUSERIDI PIC  X(0004).
  1984*    -------------------------------
  1985     05  BCHKNOL PIC S9(0004) COMP.
  1986     05  BCHKNOF PIC  X(0001).
  1987     05  FILLER REDEFINES BCHKNOF.
  1988         10  BCHKNOA PIC  X(0001).
  1989     05  BCHKNOI PIC  9(6).
  1990*    -------------------------------
  1991     05  BNAMEL PIC S9(0004) COMP.
  1992     05  BNAMEF PIC  X(0001).
  1993     05  FILLER REDEFINES BNAMEF.
  1994         10  BNAMEA PIC  X(0001).
  1995     05  BNAMEI PIC  X(0029).
  1996*    -------------------------------
  1997     05  BCHKAMTL PIC S9(0004) COMP.
  1998     05  BCHKAMTF PIC  X(0001).
  1999     05  FILLER REDEFINES BCHKAMTF.
  2000         10  BCHKAMTA PIC  X(0001).
  2001     05  BCHKAMTI PIC  S9(9)V99.
  2002*    -------------------------------
  2003     05  BADDR1L PIC S9(0004) COMP.
  2004     05  BADDR1F PIC  X(0001).
  2005     05  FILLER REDEFINES BADDR1F.
  2006         10  BADDR1A PIC  X(0001).
  2007     05  BADDR1I PIC  X(0029).
  2008*    -------------------------------
  2009     05  BADDR2L PIC S9(0004) COMP.
  2010     05  BADDR2F PIC  X(0001).
  2011     05  FILLER REDEFINES BADDR2F.
  2012         10  BADDR2A PIC  X(0001).
  2013     05  BADDR2I PIC  X(0029).
  2014*    -------------------------------
  2015     05  BPAYDT1L PIC S9(0004) COMP.
  2016     05  BPAYDT1F PIC  X(0001).
  2017     05  FILLER REDEFINES BPAYDT1F.
  2018         10  BPAYDT1A PIC  X(0001).
  2019     05  BPAYDT1I PIC  X(0008).
  2020*    -------------------------------
  2021     05  BCITYSTL PIC S9(0004) COMP.
  2022     05  BCITYSTF PIC  X(0001).
  2023     05  FILLER REDEFINES BCITYSTF.
  2024         10  BCITYSTA PIC  X(0001).
  2025     05  BCITYSTI PIC  X(0029).
  2026*    -------------------------------
  2027     05  BPAYDT2L PIC S9(0004) COMP.
  2028     05  BPAYDT2F PIC  X(0001).
  2029     05  FILLER REDEFINES BPAYDT2F.
  2030         10  BPAYDT2A PIC  X(0001).
  2031     05  BPAYDT2I PIC  X(0008).
  2032*    -------------------------------
  2033     05  BZIPL PIC S9(0004) COMP.
  2034     05  BZIPF PIC  X(0001).
  2035     05  FILLER REDEFINES BZIPF.
  2036         10  BZIPA PIC  X(0001).
  2037     05  BZIPI PIC  X(0010).
  2038*    -------------------------------
  2039     05  BACCNAML PIC S9(0004) COMP.
  2040     05  BACCNAMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  42
* EL640.cbl
  2041     05  FILLER REDEFINES BACCNAMF.
  2042         10  BACCNAMA PIC  X(0001).
  2043     05  BACCNAMI PIC  X(0030).
  2044*    -------------------------------
  2045     05  BACCTL PIC S9(0004) COMP.
  2046     05  BACCTF PIC  X(0001).
  2047     05  FILLER REDEFINES BACCTF.
  2048         10  BACCTA PIC  X(0001).
  2049     05  BACCTI PIC  X(0010).
  2050*    -------------------------------
  2051     05  BCARIERL PIC S9(0004) COMP.
  2052     05  BCARIERF PIC  X(0001).
  2053     05  FILLER REDEFINES BCARIERF.
  2054         10  BCARIERA PIC  X(0001).
  2055     05  BCARIERI PIC  X(0001).
  2056*    -------------------------------
  2057     05  BGROUPL PIC S9(0004) COMP.
  2058     05  BGROUPF PIC  X(0001).
  2059     05  FILLER REDEFINES BGROUPF.
  2060         10  BGROUPA PIC  X(0001).
  2061     05  BGROUPI PIC  X(0006).
  2062*    -------------------------------
  2063     05  BSTATEL PIC S9(0004) COMP.
  2064     05  BSTATEF PIC  X(0001).
  2065     05  FILLER REDEFINES BSTATEF.
  2066         10  BSTATEA PIC  X(0001).
  2067     05  BSTATEI PIC  X(0002).
  2068*    -------------------------------
  2069     05  BFORM1L PIC S9(0004) COMP.
  2070     05  BFORM1F PIC  X(0001).
  2071     05  FILLER REDEFINES BFORM1F.
  2072         10  BFORM1A PIC  X(0001).
  2073     05  BFORM1I PIC  X(0004).
  2074*    -------------------------------
  2075     05  BFORM2L PIC S9(0004) COMP.
  2076     05  BFORM2F PIC  X(0001).
  2077     05  FILLER REDEFINES BFORM2F.
  2078         10  BFORM2A PIC  X(0001).
  2079     05  BFORM2I PIC  X(0004).
  2080*    -------------------------------
  2081     05  BFORM3L PIC S9(0004) COMP.
  2082     05  BFORM3F PIC  X(0001).
  2083     05  FILLER REDEFINES BFORM3F.
  2084         10  BFORM3A PIC  X(0001).
  2085     05  BFORM3I PIC  X(0004).
  2086*    -------------------------------
  2087     05  BALAMTL PIC S9(0004) COMP.
  2088     05  BALAMTF PIC  X(0001).
  2089     05  FILLER REDEFINES BALAMTF.
  2090         10  BALAMTA PIC  X(0001).
  2091     05  BALAMTI PIC  X(0011).
  2092*    -------------------------------
  2093     05  BERMSGL PIC S9(0004) COMP.
  2094     05  BERMSGF PIC  X(0001).
  2095     05  FILLER REDEFINES BERMSGF.
  2096         10  BERMSGA PIC  X(0001).
  2097     05  BERMSGI PIC  X(0078).
  2098*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  43
* EL640.cbl
  2099     05  BPFNTERL PIC S9(0004) COMP.
  2100     05  BPFNTERF PIC  X(0001).
  2101     05  FILLER REDEFINES BPFNTERF.
  2102         10  BPFNTERA PIC  X(0001).
  2103     05  BPFNTERI PIC  9(2).
  2104 01  EL640BO REDEFINES EL640AI.
  2105     05  FILLER            PIC  X(0012).
  2106*    -------------------------------
  2107     05  FILLER            PIC  X(0003).
  2108     05  BDATEO PIC  X(0008).
  2109*    -------------------------------
  2110     05  FILLER            PIC  X(0003).
  2111     05  BTIMEO PIC  99.99.
  2112*    -------------------------------
  2113     05  FILLER            PIC  X(0003).
  2114     05  BCMPNYO PIC  X(0003).
  2115*    -------------------------------
  2116     05  FILLER            PIC  X(0003).
  2117     05  BUSERIDO PIC  X(0004).
  2118*    -------------------------------
  2119     05  FILLER            PIC  X(0003).
  2120     05  BCHKNOO PIC  X(0006).
  2121*    -------------------------------
  2122     05  FILLER            PIC  X(0003).
  2123     05  BNAMEO PIC  X(0029).
  2124*    -------------------------------
  2125     05  FILLER            PIC  X(0003).
  2126     05  BCHKAMTO PIC  Z(7).ZZ-.
  2127*    -------------------------------
  2128     05  FILLER            PIC  X(0003).
  2129     05  BADDR1O PIC  X(0029).
  2130*    -------------------------------
  2131     05  FILLER            PIC  X(0003).
  2132     05  BADDR2O PIC  X(0029).
  2133*    -------------------------------
  2134     05  FILLER            PIC  X(0003).
  2135     05  BPAYDT1O PIC  X(0008).
  2136*    -------------------------------
  2137     05  FILLER            PIC  X(0003).
  2138     05  BCITYSTO PIC  X(0029).
  2139*    -------------------------------
  2140     05  FILLER            PIC  X(0003).
  2141     05  BPAYDT2O PIC  X(0008).
  2142*    -------------------------------
  2143     05  FILLER            PIC  X(0003).
  2144     05  BZIPO PIC  X(0010).
  2145*    -------------------------------
  2146     05  FILLER            PIC  X(0003).
  2147     05  BACCNAMO PIC  X(0030).
  2148*    -------------------------------
  2149     05  FILLER            PIC  X(0003).
  2150     05  BACCTO PIC  X(0010).
  2151*    -------------------------------
  2152     05  FILLER            PIC  X(0003).
  2153     05  BCARIERO PIC  X(0001).
  2154*    -------------------------------
  2155     05  FILLER            PIC  X(0003).
  2156     05  BGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  44
* EL640.cbl
  2157*    -------------------------------
  2158     05  FILLER            PIC  X(0003).
  2159     05  BSTATEO PIC  X(0002).
  2160*    -------------------------------
  2161     05  FILLER            PIC  X(0003).
  2162     05  BFORM1O PIC  X(0004).
  2163*    -------------------------------
  2164     05  FILLER            PIC  X(0003).
  2165     05  BFORM2O PIC  X(0004).
  2166*    -------------------------------
  2167     05  FILLER            PIC  X(0003).
  2168     05  BFORM3O PIC  X(0004).
  2169*    -------------------------------
  2170     05  FILLER            PIC  X(0003).
  2171     05  BALAMTO PIC  Z(7).99-.
  2172*    -------------------------------
  2173     05  FILLER            PIC  X(0003).
  2174     05  BERMSGO PIC  X(0078).
  2175*    -------------------------------
  2176     05  FILLER            PIC  X(0003).
  2177     05  BPFNTERO PIC  9(2).
  2178*    -------------------------------
  2179 01  MAP-A REDEFINES EL640AO.
  2180     12  FILLER                  PIC X(162).
  2181     12  FILLER OCCURS 6 TIMES INDEXED BY ANDX.
  2182         16  FILLER              PIC X(35).
  2183         16  BATCH-LEN           PIC S9(4)   COMP.
  2184         16  BATCH-ATTRB         PIC X.
  2185         16  BATCH               PIC X(6).
  2186         16  BILL-LEN            PIC S9(4)   COMP.
  2187         16  BILL-ATTRB          PIC X.
  2188         16  BILL                PIC Z(6).
  2189         16  PREV-LEN            PIC S9(4)   COMP.
  2190         16  PREV-ATTRB          PIC X.
  2191         16  PREV                PIC Z(6).
  2192         16  NOBILL-LEN          PIC S9(4)   COMP.
  2193         16  NOBILL-ATTRB        PIC X.
  2194         16  NOBILL              PIC Z(6).
  2195****************************************************************
  2196*
  2197* Copyright (c) 2007 by Clerity Solutions, Inc.
  2198* All rights reserved.
  2199*
  2200****************************************************************
  2201 01  DFHEIV.
  2202   02  DFHEIV0               PIC X(35).
  2203   02  DFHEIV1               PIC X(08).
  2204   02  DFHEIV2               PIC X(08).
  2205   02  DFHEIV3               PIC X(08).
  2206   02  DFHEIV4               PIC X(06).
  2207   02  DFHEIV5               PIC X(04).
  2208   02  DFHEIV6               PIC X(04).
  2209   02  DFHEIV7               PIC X(02).
  2210   02  DFHEIV8               PIC X(02).
  2211   02  DFHEIV9               PIC X(01).
  2212   02  DFHEIV10              PIC S9(7) COMP-3.
  2213   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2214   02  DFHEIV12              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  45
* EL640.cbl
  2215   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2216   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2217   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2218   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2219   02  DFHEIV17              PIC X(04).
  2220   02  DFHEIV18              PIC X(04).
  2221   02  DFHEIV19              PIC X(04).
  2222   02  DFHEIV20              USAGE IS POINTER.
  2223   02  DFHEIV21              USAGE IS POINTER.
  2224   02  DFHEIV22              USAGE IS POINTER.
  2225   02  DFHEIV23              USAGE IS POINTER.
  2226   02  DFHEIV24              USAGE IS POINTER.
  2227   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2228   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2229   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2230   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2231   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2232   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2233   02  FILLER                PIC X(02).
  2234   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2235   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2236   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2237   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2238   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2239 LINKAGE  SECTION.
  2240*****************************************************************
  2241*                                                               *
  2242* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2243* All rights reserved.                                          *
  2244*                                                               *
  2245*****************************************************************
  2246 01  dfheiblk.
  2247     02  eibtime          pic s9(7) comp-3.
  2248     02  eibdate          pic s9(7) comp-3.
  2249     02  eibtrnid         pic x(4).
  2250     02  eibtaskn         pic s9(7) comp-3.
  2251     02  eibtrmid         pic x(4).
  2252     02  dfheigdi         pic s9(4) comp.
  2253     02  eibcposn         pic s9(4) comp.
  2254     02  eibcalen         pic s9(4) comp.
  2255     02  eibaid           pic x(1).
  2256     02  eibfiller1       pic x(1).
  2257     02  eibfn            pic x(2).
  2258     02  eibfiller2       pic x(2).
  2259     02  eibrcode         pic x(6).
  2260     02  eibfiller3       pic x(2).
  2261     02  eibds            pic x(8).
  2262     02  eibreqid         pic x(8).
  2263     02  eibrsrce         pic x(8).
  2264     02  eibsync          pic x(1).
  2265     02  eibfree          pic x(1).
  2266     02  eibrecv          pic x(1).
  2267     02  eibsend          pic x(1).
  2268     02  eibatt           pic x(1).
  2269     02  eibeoc           pic x(1).
  2270     02  eibfmh           pic x(1).
  2271     02  eibcompl         pic x(1).
  2272     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  46
* EL640.cbl
  2273     02  eibconf          pic x(1).
  2274     02  eiberr           pic x(1).
  2275     02  eibrldbk         pic x(1).
  2276     02  eiberrcd         pic x(4).
  2277     02  eibsynrb         pic x(1).
  2278     02  eibnodat         pic x(1).
  2279     02  eibfiller5       pic x(2).
  2280     02  eibresp          pic 9(09) comp.
  2281     02  eibresp2         pic 9(09) comp.
  2282     02  dfheigdj         pic s9(4) comp.
  2283     02  dfheigdk         pic s9(4) comp.
  2284 01  DFHCOMMAREA             PIC X(1024).
  2285
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  47
* EL640.cbl
  2288*                            COPY ERCPNDB.
  2289******************************************************************
  2290*                                                                *
  2291*                                                                *
  2292*                            ERCPNDB.                            *
  2293*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2294*                            VMOD=2.025                          *
  2295*                                                                *
  2296*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2297*                                                                *
  2298******************************************************************
  2299*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2300*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2301******************************************************************
  2302*                                                                *
  2303*                                                                *
  2304*   FILE TYPE = VSAM,KSDS                                        *
  2305*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2306*                                                                *
  2307*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2308*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2309*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2310*                                                 RKP=13,LEN=36  *
  2311*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2312*                                      AND CHG-SEQ.)             *
  2313*                                                RKP=49,LEN=11   *
  2314*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2315*                                      AND CHG-SEQ.)             *
  2316*                                                RKP=60,LEN=15   *
  2317*                                                                *
  2318*   LOG = NO                                                     *
  2319*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2320******************************************************************
  2321******************************************************************
  2322*                   C H A N G E   L O G
  2323*
  2324* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2325*-----------------------------------------------------------------
  2326*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2327* EFFECTIVE    NUMBER
  2328*-----------------------------------------------------------------
  2329* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2330* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2331* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2332* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2333* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2334* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2335* 032306                   PEMA  ADD BOW LOAN NUMBER
  2336* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2337* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2338* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2339* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2340* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2341* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2342* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2343* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2344* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  2345* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  48
* EL640.cbl
  2346******************************************************************
  2347
  2348 01  PENDING-BUSINESS.
  2349     12  PB-RECORD-ID                     PIC XX.
  2350         88  VALID-PB-ID                        VALUE 'PB'.
  2351
  2352     12  PB-CONTROL-PRIMARY.
  2353         16  PB-COMPANY-CD                PIC X.
  2354         16  PB-ENTRY-BATCH               PIC X(6).
  2355         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  2356         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  2357
  2358     12  PB-CONTROL-BY-ACCOUNT.
  2359         16  PB-COMPANY-CD-A1             PIC X.
  2360         16  PB-CARRIER                   PIC X.
  2361         16  PB-GROUPING.
  2362             20  PB-GROUPING-PREFIX       PIC XXX.
  2363             20  PB-GROUPING-PRIME        PIC XXX.
  2364         16  PB-STATE                     PIC XX.
  2365         16  PB-ACCOUNT.
  2366             20  PB-ACCOUNT-PREFIX        PIC X(4).
  2367             20  PB-ACCOUNT-PRIME         PIC X(6).
  2368         16  PB-CERT-EFF-DT               PIC XX.
  2369         16  PB-CERT-NO.
  2370             20  PB-CERT-PRIME            PIC X(10).
  2371             20  PB-CERT-SFX              PIC X.
  2372         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  2373
  2374         16  PB-RECORD-TYPE               PIC X.
  2375             88  PB-MAILING-DATA                VALUE '0'.
  2376             88  PB-ISSUE                       VALUE '1'.
  2377             88  PB-CANCELLATION                VALUE '2'.
  2378             88  PB-BATCH-TRAILER               VALUE '9'.
  2379
  2380     12  PB-CONTROL-BY-ORIG-BATCH.
  2381         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  2382         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  2383         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  2384         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  2385
  2386     12  PB-CONTROL-BY-CSR.
  2387         16  PB-CSR-COMPANY-CD            PIC X.
  2388         16  PB-CSR-ID                    PIC X(4).
  2389         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  2390         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  2391         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  2392******************************************************************
  2393*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  2394******************************************************************
  2395
  2396     12  PB-LAST-MAINT-DT                 PIC XX.
  2397     12  PB-LAST-MAINT-BY                 PIC X(4).
  2398     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2399
  2400     12  PB-RECORD-BODY                   PIC X(375).
  2401
  2402     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  2403         16  PB-CERT-ORIGIN               PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  49
* EL640.cbl
  2404             88  CLASIC-CREATED-CERT         VALUE '1'.
  2405         16  PB-I-NAME.
  2406             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  2407             20  PB-I-INSURED-FIRST-NAME.
  2408                 24  PB-I-INSURED-1ST-INIT PIC X.
  2409                 24  FILLER                PIC X(9).
  2410             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  2411         16  PB-I-AGE                     PIC S99   COMP-3.
  2412         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  2413         16  PB-I-BIRTHDAY                PIC XX.
  2414         16  PB-I-INSURED-SEX             PIC X.
  2415             88  PB-SEX-MALE     VALUE 'M'.
  2416             88  PB-SEX-FEMALE   VALUE 'F'.
  2417
  2418         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  2419         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  2420         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  2421         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  2422         16  PB-I-SKIP-CODE               PIC X.
  2423             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  2424             88  PB-SKIP-JULY              VALUE '1'.
  2425             88  PB-SKIP-AUGUST            VALUE '2'.
  2426             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  2427             88  PB-SKIP-JULY-AUG          VALUE '4'.
  2428             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  2429             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  2430             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  2431             88  PB-SKIP-JUNE              VALUE '8'.
  2432             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  2433             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  2434             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  2435         16  PB-I-TERM-TYPE               PIC X.
  2436             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  2437             88  PB-PAID-WEEKLY            VALUE 'W'.
  2438             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  2439             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  2440             88  PB-PAID-13-YEARLY         VALUE 'T'.
  2441         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  2442         16  PB-I-POLICY-FORM-NO          PIC X(12).
  2443         16  PB-I-DATA-ENTRY-SW           PIC X.
  2444             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  2445             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  2446             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  2447             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  2448         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  2449         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  2450*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  2451         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  2452         16  FILLER                       PIC X.
  2453
  2454         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  2455             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  2456             88  PB-INVALID-LIFE             VALUE '  ' '00'
  2457                                                   '90' THRU '99'.
  2458         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  2459                                          PIC XX.
  2460         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2461         16  PB-I-AMOUNT-FINANCED REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  50
* EL640.cbl
  2462                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  2463         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  2464         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  2465                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  2466         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2467         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  2468         16  PB-I-CLP-AMOUNT REDEFINES
  2469                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2470         16  PB-I-LF-CALC-FLAG            PIC X.
  2471             88 PB-COMP-LF-PREM               VALUE '?'.
  2472         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2473         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2474         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2475         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2476         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2477         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2478         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2479         16  PB-I-LF-ABBR                 PIC XXX.
  2480         16  PB-I-LF-INPUT-CD             PIC XX.
  2481
  2482         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2483             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2484             88  PB-INVALID-AH               VALUE '  ' '00'
  2485                                                   '90' THRU '99'.
  2486         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2487         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2488         16  PB-I-AH-CALC-FLAG            PIC X.
  2489             88 PB-COMP-AH-PREM                  VALUE '?'.
  2490         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2491         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2492         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  2493         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2494         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2495         16  PB-I-AH-ABBR                 PIC XXX.
  2496         16  PB-I-AH-INPUT-CD             PIC XXX.
  2497
  2498         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2499         16  PB-I-REIN-TABLE              PIC XXX.
  2500         16  PB-I-BUSINESS-TYPE           PIC 99.
  2501         16  PB-I-INDV-GRP-CD             PIC X.
  2502         16  PB-I-MORT-CODE.
  2503             20  PB-I-TABLE               PIC X.
  2504             20  PB-I-INTEREST            PIC XX.
  2505             20  PB-I-MORT-TYP            PIC X.
  2506         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2507         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2508         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2509         16  PB-I-INDV-GRP-OVRD           PIC X.
  2510         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2511         16  PB-I-SIG-SW                  PIC X.
  2512             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2513         16  PB-I-RATE-CLASS              PIC XX.
  2514         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2515         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2516         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2517         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2518         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2519         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  51
* EL640.cbl
  2520         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  2521         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2522         16  PB-I-OB-FLAG                 PIC X.
  2523             88  PB-I-OB                      VALUE 'B'.
  2524             88  PB-I-SUMMARY                 VALUE 'Z'.
  2525         16  PB-I-ENTRY-STATUS            PIC X.
  2526             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2527                                              'M' '5' '9' '2'.
  2528             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2529             88  PB-I-POLICY-PENDING          VALUE '2'.
  2530             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2531             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2532             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  2533             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2534             88  PB-I-REIN-ONLY               VALUE '9'.
  2535             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2536             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2537             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2538             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2539         16  PB-I-INT-CODE                PIC X.
  2540             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2541             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2542         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2543         16  PB-I-SOC-SEC-NO              PIC X(11).
  2544         16  PB-I-MEMBER-NO               PIC X(12).
  2545         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2546*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2547         16  PB-I-OLD-LOF                 PIC XXX.
  2548         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2549         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2550         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2551         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2552         16  PB-I-LIFE-INDICATOR          PIC X.
  2553             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2554         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2555         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2556                                          PIC S9(5)V99    COMP-3.
  2557         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2558             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2559             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2560         16  PB-I-1ST-PMT-DT              PIC XX.
  2561         16  PB-I-JOINT-INSURED.
  2562             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2563             20 PB-I-JOINT-FIRST-NAME.
  2564                24  PB-I-JOINT-FIRST-INIT PIC X.
  2565                24  FILLER                PIC X(9).
  2566             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2567*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2568         16  PB-I-BENEFICIARY-NAME.
  2569             20  PB-I-BANK-NUMBER         PIC X(10).
  2570             20  FILLER                   PIC X(15).
  2571         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2572         16  PB-I-REFERENCE               PIC X(12).
  2573         16  FILLER REDEFINES PB-I-REFERENCE.
  2574             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2575             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2576             20  PB-I-CLP-STATE           PIC XX.
  2577         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  52
* EL640.cbl
  2578             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2579             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  2580             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2581         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2582         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2583         16  PB-I-RESIDENT-STATE          PIC XX.
  2584         16  PB-I-RATE-CODE               PIC X(4).
  2585         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2586         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2587         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2588         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2589         16  PB-I-BANK-NOCHRGB            PIC 99.
  2590         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2591         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2592
  2593     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2594         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2595             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2596         16  PB-C-CANCEL-ORIGIN           PIC X.
  2597             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2598         16  PB-C-LF-CANCEL-DT            PIC XX.
  2599         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2600         16  PB-C-LF-CALC-REQ             PIC X.
  2601             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2602         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2603         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2604         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2605             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2606         16  PB-C-AH-CANCEL-DT            PIC XX.
  2607         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2608         16  PB-C-AH-CALC-REQ             PIC X.
  2609             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2610         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2611         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2612         16  PB-C-LAST-NAME               PIC X(15).
  2613         16  PB-C-REFUND-SW               PIC X.
  2614             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2615             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2616         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2617         16  PB-C-PAYEE-CODE              PIC X(6).
  2618         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2619         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2620         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2621         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2622         16  PB-C-REFERENCE               PIC X(12).
  2623         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2624         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2625         16  PB-C-POST-CARD-IND           PIC X.
  2626         16  PB-C-CANCEL-REASON           PIC X.
  2627         16  PB-C-REF-INTERFACE-SW        PIC X.
  2628         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2629         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2630         16  FILLER                       PIC X(01).
  2631*        16  FILLER                       PIC X(18).
  2632         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2633*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2634         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2635         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  53
* EL640.cbl
  2636             20  PB-CI-INSURED-NAME.
  2637                 24  PB-CI-LAST-NAME      PIC X(15).
  2638                 24  PB-CI-INITIALS       PIC XX.
  2639             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2640             20  PB-CI-INSURED-SEX        PIC X.
  2641             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2642             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2643             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2644             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2645             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2646             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2647             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2648             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2649             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2650             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2651             20  PB-CI-RATE-CLASS         PIC XX.
  2652             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2653             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2654             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2655             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2656             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2657             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2658             20  PB-CI-LF-ABBR            PIC X(3).
  2659             20  PB-CI-AH-ABBR            PIC X(3).
  2660             20  PB-CI-OB-FLAG            PIC X.
  2661                 88  PB-CI-OB                VALUE 'B'.
  2662             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2663                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2664                                           'M' '4' '5' '9' '2'.
  2665                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2666                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2667                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2668                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2669                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2670                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  2671                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2672                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2673                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2674                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2675                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2676                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2677                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2678             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2679                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2680                                           'M' '4' '5' '9' '2'.
  2681                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2682                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2683                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2684                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2685                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2686                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  2687                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2688                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2689                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2690                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2691                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2692                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2693                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  54
* EL640.cbl
  2694             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2695             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2696             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2697             20  PB-CI-MEMBER-NO          PIC X(12).
  2698             20  PB-CI-INT-CODE           PIC X.
  2699                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2700                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2701             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2702             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2703             20  PB-CI-COMP-EXCP-SW       PIC X.
  2704                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2705                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2706             20  PB-CI-ENTRY-STATUS       PIC X.
  2707             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2708             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2709             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2710             20  PB-CI-DEATH-DT           PIC XX.
  2711             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2712             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2713             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2714             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2715             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2716             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2717             20  PB-CI-ENTRY-DT              PIC XX.
  2718             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2719             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2720             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2721             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2722             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2723             20  PB-CI-OLD-LOF               PIC XXX.
  2724*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2725             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2726             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2727             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2728             20  PB-CI-INDV-GRP-CD           PIC X.
  2729             20  PB-CI-BENEFICIARY-NAME.
  2730                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2731                 24  FILLER                  PIC X(15).
  2732             20  PB-CI-NOTE-SW               PIC X.
  2733             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2734             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2735             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2736             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2737             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2738             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2739             20  PB-CI-FIRST-NAME            PIC X(10).
  2740             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2741
  2742         16  FILLER                       PIC X(13).
  2743*032306  16  FILLER                       PIC X(27).
  2744*        16  FILLER                       PIC X(46).
  2745
  2746     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2747         16  FILLER                       PIC X(10).
  2748         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2749         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2750         16  PB-M-INSURED-MID-INIT        PIC X.
  2751         16  PB-M-INSURED-AGE             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  55
* EL640.cbl
  2752         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2753         16  PB-M-INSURED-SEX             PIC X.
  2754         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2755         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  2756         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2757         16  PB-M-INSURED-CITY-STATE.
  2758             20  PB-M-INSURED-CITY        PIC X(28).
  2759             20  PB-M-INSURED-STATE       PIC XX.
  2760         16  PB-M-INSURED-ZIP-CODE.
  2761             20  PB-M-INSURED-ZIP-PRIME.
  2762                 24  PB-M-INSURED-ZIP-1   PIC X.
  2763                     88  PB-M-CANADIAN-POST-CODE
  2764                                             VALUE 'A' THRU 'Z'.
  2765                 24  FILLER               PIC X(4).
  2766             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2767         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2768                                        PB-M-INSURED-ZIP-CODE.
  2769             20  PM-M-INS-CAN-POST1       PIC XXX.
  2770             20  PM-M-INS-CAN-POST2       PIC XXX.
  2771             20  FILLER                   PIC XXX.
  2772         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2773         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2774         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2775         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2776         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2777         16  PB-M-CRED-BENE-CITYST.
  2778             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2779             20  PB-M-CRED-BENE-STATE     PIC XX.
  2780         16  FILLER                       PIC X(92).
  2781
  2782     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2783         16  FILLER                       PIC X(10).
  2784         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2785         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2786         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2787         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2788         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2789         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2790         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2791         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2792         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2793         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2794         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2795         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2796         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2797         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2798         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2799         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2800         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2801         16  PB-ACCOUNT-NAME              PIC X(30).
  2802         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2803         16  PB-REFERENCE                 PIC X(12).
  2804         16  PB-B-RECEIVED-DT             PIC XX.
  2805         16  FILLER                       PIC X(234).
  2806
  2807     12  PB-RECORD-STATUS.
  2808         16  PB-CREDIT-SELECT-DT          PIC XX.
  2809         16  PB-CREDIT-ACCEPT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  56
* EL640.cbl
  2810         16  PB-BILLED-DT                 PIC XX.
  2811         16  PB-BILLING-STATUS            PIC X.
  2812             88  PB-ENTRY-REVERSED            VALUE 'R'.
  2813             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2814             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2815         16  PB-RECORD-BILL               PIC X.
  2816             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2817             88  PB-RECORD-RETURNED           VALUE 'R'.
  2818             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2819             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2820             88  PB-OVERRIDE-AH               VALUE 'A'.
  2821             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2822         16  PB-BATCH-ENTRY               PIC X.
  2823             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2824             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2825             88  PB-REISSUED-CERT             VALUE 'E'.
  2826             88  PB-CASH-CERT                 VALUE 'C'.
  2827             88  PB-MONTHLY-CERT              VALUE 'M'.
  2828             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2829             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2830             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2831         16  PB-FORCE-CODE                PIC X.
  2832             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2833             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2834             88  PB-CANCEL-FORCE              VALUE '8'.
  2835             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2836             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2837             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2838             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2839             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2840             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2841             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2842         16  PB-FATAL-FLAG                PIC X.
  2843             88  PB-FATAL-ERRORS              VALUE 'X'.
  2844         16  PB-FORCE-ER-CD               PIC X.
  2845             88  PB-FORCE-ERRORS              VALUE 'F'.
  2846             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2847         16  PB-WARN-ER-CD                PIC X.
  2848             88  PB-WARNING-ERRORS            VALUE 'W'.
  2849         16  FILLER                       PIC X.
  2850         16  PB-OUT-BAL-CD                PIC X.
  2851             88  PB-OUT-OF-BAL                VALUE 'O'.
  2852         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2853         16  PB-AH-OVERRIDE-L1            PIC X.
  2854         16  PB-INPUT-DT                  PIC XX.
  2855         16  PB-INPUT-BY                  PIC X(4).
  2856         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2857         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2858         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2859         16  PB-LF-EARNING-METHOD         PIC X.
  2860         16  PB-AH-EARNING-METHOD         PIC X.
  2861         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2862         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2863         16  PB-REIN-CD                   PIC XXX.
  2864         16  PB-LF-REFUND-TYPE            PIC X.
  2865         16  PB-AH-REFUND-TYPE            PIC X.
  2866         16  PB-ACCT-EFF-DT               PIC XX.
  2867         16  PB-ACCT-EXP-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  57
* EL640.cbl
  2868         16  PB-COMPANY-ID                PIC X(3).
  2869         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2870         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2871         16  PB-SV-CARRIER                PIC X.
  2872         16  PB-SV-GROUPING               PIC X(6).
  2873         16  PB-SV-STATE                  PIC XX.
  2874         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2875         16  PB-GA-BILLING-INFO.
  2876             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2877                                          PIC XX.
  2878         16  PB-SV-REMIT-TO  REDEFINES
  2879             PB-GA-BILLING-INFO           PIC X(10).
  2880         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2881         16  PB-I-LOAN-OFFICER            PIC X(5).
  2882         16  PB-I-VIN                     PIC X(17).
  2883
  2884         16  FILLER                       PIC X(04).
  2885         16  IMNET-BYPASS-SW              PIC X.
  2886
  2887******************************************************************
  2888*                COMMON EDIT ERRORS                              *
  2889******************************************************************
  2890
  2891     12  PB-COMMON-ERRORS.
  2892         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2893                                           PIC S9(4)     COMP.
  2894
  2895******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  58
* EL640.cbl
  2897*                            COPY ELCCNTL.
  2898******************************************************************
  2899*                                                                *
  2900*                                                                *
  2901*                            ELCCNTL.                            *
  2902*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2903*                            VMOD=2.059                          *
  2904*                                                                *
  2905*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2906*                                                                *
  2907*   FILE TYPE = VSAM,KSDS                                        *
  2908*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2909*                                                                *
  2910*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2911*       ALTERNATE INDEX = NONE                                   *
  2912*                                                                *
  2913*   LOG = YES                                                    *
  2914*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2915******************************************************************
  2916*                   C H A N G E   L O G
  2917*
  2918* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2919*-----------------------------------------------------------------
  2920*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2921* EFFECTIVE    NUMBER
  2922*-----------------------------------------------------------------
  2923* 082503                   PEMA  ADD BENEFIT GROUP
  2924* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2925* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2926* 092705    2005050300006  PEMA  ADD SPP LEASES
  2927* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2928* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2929* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2930* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2931* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2932* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2933* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2934* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2935* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2936* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2937******************************************************************
  2938*
  2939 01  CONTROL-FILE.
  2940     12  CF-RECORD-ID                       PIC XX.
  2941         88  VALID-CF-ID                        VALUE 'CF'.
  2942
  2943     12  CF-CONTROL-PRIMARY.
  2944         16  CF-COMPANY-ID                  PIC XXX.
  2945         16  CF-RECORD-TYPE                 PIC X.
  2946             88  CF-COMPANY-MASTER              VALUE '1'.
  2947             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2948             88  CF-STATE-MASTER                VALUE '3'.
  2949             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2950             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2951             88  CF-CARRIER-MASTER              VALUE '6'.
  2952             88  CF-MORTALITY-MASTER            VALUE '7'.
  2953             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2954             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  59
* EL640.cbl
  2955             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2956             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2957             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2958             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2959             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2960             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2961             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2962             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2963             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2964         16  CF-ACCESS-CD-GENL              PIC X(4).
  2965         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2966             20  CF-PROCESSOR               PIC X(4).
  2967         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2968             20  CF-STATE-CODE              PIC XX.
  2969             20  FILLER                     PIC XX.
  2970         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2971             20  FILLER                     PIC XX.
  2972             20  CF-HI-BEN-IN-REC           PIC XX.
  2973         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2974             20  FILLER                     PIC XXX.
  2975             20  CF-CARRIER-CNTL            PIC X.
  2976         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2977             20  FILLER                     PIC XX.
  2978             20  CF-HI-TYPE-IN-REC          PIC 99.
  2979         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2980             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2981                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2982             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2983             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2984         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2985             20  FILLER                     PIC X.
  2986             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2987         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2988             20  FILLER                     PIC XX.
  2989             20  CF-MORTGAGE-PLAN           PIC XX.
  2990         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2991
  2992     12  CF-LAST-MAINT-DT                   PIC XX.
  2993     12  CF-LAST-MAINT-BY                   PIC X(4).
  2994     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2995
  2996     12  CF-RECORD-BODY                     PIC X(728).
  2997
  2998
  2999****************************************************************
  3000*             COMPANY MASTER RECORD                            *
  3001****************************************************************
  3002
  3003     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3004         16  CF-COMPANY-ADDRESS.
  3005             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3006             20  CF-CL-IN-CARE-OF           PIC X(30).
  3007             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3008             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3009             20  CF-CL-CITY-STATE           PIC X(30).
  3010             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3011             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3012         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  60
* EL640.cbl
  3013         16  CF-COMPANY-PASSWORD            PIC X(8).
  3014         16  CF-SECURITY-OPTION             PIC X.
  3015             88  ALL-SECURITY                   VALUE '1'.
  3016             88  COMPANY-VERIFY                 VALUE '2'.
  3017             88  PROCESSOR-VERIFY               VALUE '3'.
  3018             88  NO-SECURITY                    VALUE '4'.
  3019             88  ALL-BUT-TERM                   VALUE '5'.
  3020         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3021             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3022         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3023             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3024         16  CF-INFORCE-LOCATION            PIC X.
  3025             88  CERTS-ARE-ONLINE               VALUE '1'.
  3026             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3027             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3028         16  CF-LOWER-CASE-LETTERS          PIC X.
  3029         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3030             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3031             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3032             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3033             88  CF-ACCNT-CNTL                  VALUE '3'.
  3034             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3035
  3036         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3037         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3038
  3039         16  CF-LGX-CREDIT-USER             PIC X.
  3040             88  CO-IS-NOT-USER                 VALUE 'N'.
  3041             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3042
  3043         16 CF-CREDIT-CALC-CODES.
  3044             20  CF-CR-REM-TERM-CALC PIC X.
  3045               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3046               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3047               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3048               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3049               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3050               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3051               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3052             20  CF-CR-R78-METHOD           PIC X.
  3053               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3054               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3055
  3056         16  CF-CLAIM-CONTROL-COUNTS.
  3057             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3058                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3059
  3060             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3061                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3062
  3063             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3064                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3065
  3066             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3067                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3068
  3069         16  CF-CURRENT-MONTH-END           PIC XX.
  3070
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  61
* EL640.cbl
  3071         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3072             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3073             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3074             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3075             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3076                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3077                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3078             20  CF-CO-PREM-REJECT-SW       PIC X.
  3079                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3080                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3081             20  CF-CO-REF-REJECT-SW        PIC X.
  3082                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3083                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3084
  3085         16  CF-CO-REPORTING-DT             PIC XX.
  3086         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3087         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3088           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3089           88  CF-CO-MONTH-END                  VALUE '1'.
  3090
  3091         16  CF-LGX-CLAIM-USER              PIC X.
  3092             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3093             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3094
  3095         16  CF-CREDIT-EDIT-CONTROLS.
  3096             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3097             20  CF-MIN-AGE                 PIC 99.
  3098             20  CF-DEFAULT-AGE             PIC 99.
  3099             20  CF-MIN-TERM                PIC S999      COMP-3.
  3100             20  CF-MAX-TERM                PIC S999      COMP-3.
  3101             20  CF-DEFAULT-SEX             PIC X.
  3102             20  CF-JOINT-AGE-INPUT         PIC X.
  3103                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3104             20  CF-BIRTH-DATE-INPUT        PIC X.
  3105                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3106             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3107                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3108                 88  CF-ZERO-CARRIER            VALUE '1'.
  3109                 88  CF-ZERO-GROUPING           VALUE '2'.
  3110                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3111             20  CF-EDIT-SW                 PIC X.
  3112                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3113             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3114             20  CF-CR-PR-METHOD            PIC X.
  3115               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3116               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3117             20  FILLER                     PIC X.
  3118
  3119         16  CF-CREDIT-MISC-CONTROLS.
  3120             20  CF-REIN-TABLE-SW           PIC X.
  3121                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3122             20  CF-COMP-TABLE-SW           PIC X.
  3123                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3124             20  CF-EXPERIENCE-RETENTION-AGE
  3125                                            PIC S9        COMP-3.
  3126             20  CF-CONVERSION-DT           PIC XX.
  3127             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3128             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  62
* EL640.cbl
  3129                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3130                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3131
  3132             20  CF-CR-CHECK-NO-CONTROL.
  3133                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3134                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3135                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3136                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3137                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3138                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3139
  3140                 24  CF-CR-CHECK-COUNT       REDEFINES
  3141                     CF-CR-CHECK-COUNTER      PIC X(4).
  3142
  3143                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3144                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3145
  3146                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3147                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3148                 24  CF-MAIL-PROCESSING       PIC X.
  3149                     88  MAIL-PROCESSING          VALUE 'Y'.
  3150
  3151         16  CF-MISC-SYSTEM-CONTROL.
  3152             20  CF-SYSTEM-C                 PIC X.
  3153                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3154             20  CF-SYSTEM-D                 PIC X.
  3155                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3156             20  CF-SOC-SEC-NO-SW            PIC X.
  3157                 88  SOC-SEC-NO-USED             VALUE '1'.
  3158             20  CF-MEMBER-NO-SW             PIC X.
  3159                 88  MEMBER-NO-USED              VALUE '1'.
  3160             20  CF-TAX-ID-NUMBER            PIC X(11).
  3161             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3162             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3163                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3164                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3165                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3166                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3167             20  CF-SYSTEM-E                 PIC X.
  3168                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3169
  3170         16  CF-LGX-LIFE-USER               PIC X.
  3171             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3172             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3173
  3174         16  CF-CR-MONTH-END-DT             PIC XX.
  3175
  3176         16  CF-FILE-MAINT-DATES.
  3177             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3178                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3179             20  CF-LAST-BATCH       REDEFINES
  3180                 CF-LAST-BATCH-NO               PIC X(4).
  3181             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3182             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3183             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3184             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3185             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3186             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  63
* EL640.cbl
  3187             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3188             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3189             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3190             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3191
  3192         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3193         16  FILLER                         PIC X.
  3194
  3195         16  CF-ALT-MORT-CODE               PIC X(4).
  3196         16  CF-MEMBER-CAPTION              PIC X(10).
  3197
  3198         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3199             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3200             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3201             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3202             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3203             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3204
  3205         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3206
  3207         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3208         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3209         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3210         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3211
  3212         16  CF-AH-OVERRIDE-L1              PIC X.
  3213         16  CF-AH-OVERRIDE-L2              PIC XX.
  3214         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3215         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3216
  3217         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3218         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3219
  3220         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3221         16  CF-AR-LAST-EL860-DT            PIC XX.
  3222         16  CF-MP-MONTH-END-DT             PIC XX.
  3223
  3224         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3225         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3226             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3227
  3228         16  CF-AR-MONTH-END-DT             PIC XX.
  3229
  3230         16  CF-CRDTCRD-USER                PIC X.
  3231             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3232             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3233
  3234         16  CF-CC-MONTH-END-DT             PIC XX.
  3235
  3236         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3237
  3238         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3239             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3240             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3241             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3242         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3243         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3244         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  64
* EL640.cbl
  3245         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3246             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3247             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3248         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3249         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3250         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3251             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3252         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3253
  3254         16  CF-CL-ZIP-CODE.
  3255             20  CF-CL-ZIP-PRIME.
  3256                 24  CF-CL-ZIP-1ST          PIC X.
  3257                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3258                 24  FILLER                 PIC X(4).
  3259             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3260         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3261             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3262             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3263             20  FILLER                     PIC XXX.
  3264
  3265         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3266         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3267         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3268         16  CF-CO-OPTION-START-DATE        PIC XX.
  3269         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3270           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3271                                                      '3' '4'.
  3272           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3273           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3274           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3275           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3276           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3277           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3278
  3279         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3280
  3281         16  CF-PAYMENT-APPROVAL-LEVELS.
  3282             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3283             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3284             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3285             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3286             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3287             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3288
  3289         16  CF-END-USER-REPORTING-USER     PIC X.
  3290             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3291             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3292
  3293         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3294             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3295             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3296
  3297         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3298
  3299         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3300         16  FILLER                         PIC X.
  3301
  3302         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  65
* EL640.cbl
  3303             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3304             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3305             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3306
  3307         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3308
  3309         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3310             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3311             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3312
  3313         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3314             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3315             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3316
  3317         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3318
  3319         16  CF-CO-ACH-ID-CODE              PIC  X.
  3320             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3321             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3322             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3323         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3324         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3325         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3326         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3327         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3328         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3329         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3330         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3331         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3332                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3333         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3334                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3335
  3336         16  CF-CO-OVER-SHORT.
  3337             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3338             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3339
  3340*         16  FILLER                         PIC X(102).
  3341         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3342             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3343             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3344
  3345         16  CF-AH-APPROVAL-DAYS.
  3346             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3347             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3348             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3349             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3350
  3351         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3352
  3353         16  CF-APPROV-LEV-5.
  3354             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3355             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3356             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3357
  3358         16  FILLER                         PIC X(68).
  3359****************************************************************
  3360*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  66
* EL640.cbl
  3361****************************************************************
  3362
  3363     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3364         16  CF-PROCESSOR-NAME              PIC X(30).
  3365         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3366         16  CF-PROCESSOR-TITLE             PIC X(26).
  3367         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3368                 88  MESSAGE-YES                VALUE 'Y'.
  3369                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3370
  3371*****************************************************
  3372****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3373****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3374****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3375****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3376*****************************************************
  3377
  3378         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3379             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3380             20  CF-APPLICATION-FORCE       PIC X.
  3381             20  CF-INDIVIDUAL-APP.
  3382                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3383                     28  CF-BROWSE-APP      PIC X.
  3384                     28  CF-UPDATE-APP      PIC X.
  3385
  3386         16  CF-CURRENT-TERM-ON             PIC X(4).
  3387         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3388             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3389             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3390             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3391             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3392             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3393             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3394             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3395         16  CF-PROCESSOR-CARRIER           PIC X.
  3396             88  NO-CARRIER-SECURITY            VALUE ' '.
  3397         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3398             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3399         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3400             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3401         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3402             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3403
  3404         16  CF-PROC-SYS-ACCESS-SW.
  3405             20  CF-PROC-CREDIT-CLAIMS-SW.
  3406                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3407                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3408                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3409                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3410             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3411                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3412                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3413             20  CF-PROC-LIFE-GNRLDGR-SW.
  3414                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3415                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3416                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3417                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3418             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  67
* EL640.cbl
  3419                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3420                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3421         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3422             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3423             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3424         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3425
  3426         16  CF-APPROVAL-LEVEL                  PIC X.
  3427             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3428             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3429             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3430             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3431             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3432
  3433         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3434
  3435         16  CF-LANGUAGE-TYPE                   PIC X.
  3436             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3437             88  CF-LANG-IS-FR                      VALUE 'F'.
  3438
  3439         16  CF-CSR-IND                         PIC X.
  3440         16  FILLER                             PIC X(239).
  3441
  3442****************************************************************
  3443*             PROCESSOR/REMINDERS RECORD                       *
  3444****************************************************************
  3445
  3446     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3447         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3448             20  CF-START-REMIND-DT         PIC XX.
  3449             20  CF-END-REMIND-DT           PIC XX.
  3450             20  CF-REMINDER-TEXT           PIC X(50).
  3451         16  FILLER                         PIC X(296).
  3452
  3453
  3454****************************************************************
  3455*             STATE MASTER RECORD                              *
  3456****************************************************************
  3457
  3458     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3459         16  CF-STATE-ABBREVIATION          PIC XX.
  3460         16  CF-STATE-NAME                  PIC X(25).
  3461         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3462         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3463             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3464             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3465             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3466             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3467                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3468                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3469             20  CF-ST-PREM-REJECT-SW       PIC X.
  3470                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3471                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3472             20  CF-ST-REF-REJECT-SW        PIC X.
  3473                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3474                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3475         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3476         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  68
* EL640.cbl
  3477         16  CF-ST-REFUND-RULES.
  3478             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3479             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3480             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3481         16  CF-ST-FST-PMT-EXTENSION.
  3482             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3483             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3484                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3485                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3486                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3487                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3488         16  CF-ST-STATE-CALL.
  3489             20  CF-ST-CALL-UNEARNED        PIC X.
  3490             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3491             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3492         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3493             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3494             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3495         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3496         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3497         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3498         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3499         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3500         16  FILLER                         PIC X.
  3501         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3502             20  CF-ST-BENEFIT-CD           PIC XX.
  3503             20  CF-ST-BENEFIT-KIND         PIC X.
  3504                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3505                 88  CF-ST-AH-KIND              VALUE 'A'.
  3506             20  CF-ST-REM-TERM-CALC        PIC X.
  3507                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3508                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3509                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3510                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3511                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3512                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3513                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3514                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3515
  3516             20  CF-ST-REFUND-CALC          PIC X.
  3517                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3518                 88  ST-REFD-BY-R78             VALUE '1'.
  3519                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3520                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3521                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3522                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3523                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3524                 88  ST-REFD-UTAH               VALUE '7'.
  3525                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3526                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3527                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3528
  3529             20  CF-ST-EARNING-CALC         PIC X.
  3530                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3531                 88  ST-EARN-BY-R78             VALUE '1'.
  3532                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3533                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3534                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  69
* EL640.cbl
  3535                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3536                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3537                 88  ST-EARN-MEAN               VALUE '8'.
  3538                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3539
  3540             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3541                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3542                 88  ST-OVRD-BY-R78             VALUE '1'.
  3543                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3544                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3545                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3546                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3547                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3548                 88  ST-OVRD-MEAN               VALUE '8'.
  3549                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3550             20  cf-st-extra-periods        pic 9.
  3551*            20  FILLER                     PIC X.
  3552
  3553         16  CF-ST-COMMISSION-CAPS.
  3554             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3555             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3556             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3557             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3558         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3559                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3560
  3561         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3562
  3563         16  CF-ST-STATUTORY-INTEREST.
  3564             20  CF-ST-STAT-DATE-FROM       PIC X.
  3565                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3566                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3567             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3568             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3569             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3570             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3571             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3572
  3573         16  CF-ST-OVER-SHORT.
  3574             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3575             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3576
  3577         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3578
  3579         16  CF-ST-RT-CALC                  PIC X.
  3580
  3581         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3582         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3583         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3584         16  CF-ST-RF-LR-CALC               PIC X.
  3585         16  CF-ST-RF-LL-CALC               PIC X.
  3586         16  CF-ST-RF-LN-CALC               PIC X.
  3587         16  CF-ST-RF-AH-CALC               PIC X.
  3588         16  CF-ST-RF-CP-CALC               PIC X.
  3589*        16  FILLER                         PIC X(206).
  3590*CIDMOD         16  FILLER                         PIC X(192).
  3591         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3592             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  70
* EL640.cbl
  3593         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3594         16  CF-ST-VFY-2ND-BENE             PIC X.
  3595         16  CF-ST-CAUSAL-STATE             PIC X.
  3596         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3597         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3598         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3599             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3600         16  CF-ST-NET-ONLY-STATE           PIC X.
  3601             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3602         16  FILLER                         PIC X(181).
  3603
  3604****************************************************************
  3605*             BENEFIT MASTER RECORD                            *
  3606****************************************************************
  3607
  3608     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3609         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3610             20  CF-BENEFIT-CODE            PIC XX.
  3611             20  CF-BENEFIT-NUMERIC  REDEFINES
  3612                 CF-BENEFIT-CODE            PIC XX.
  3613             20  CF-BENEFIT-ALPHA           PIC XXX.
  3614             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3615             20  CF-BENEFIT-COMMENT         PIC X(10).
  3616
  3617             20  CF-LF-COVERAGE-TYPE        PIC X.
  3618                 88  CF-REDUCING                VALUE 'R'.
  3619                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3620
  3621             20  CF-SPECIAL-CALC-CD         PIC X.
  3622                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3623                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3624                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3625                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3626                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3627                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3628                 88  CF-FARM-PLAN               VALUE 'F'.
  3629                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3630                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3631                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3632                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3633                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3634                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3635                 88  CF-PRUDENTIAL              VALUE 'P'.
  3636                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3637                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3638                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3639                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3640                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3641                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3642
  3643             20  CF-JOINT-INDICATOR         PIC X.
  3644                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3645
  3646*            20  FILLER                     PIC X(12).
  3647             20  cf-maximum-benefits        pic s999 comp-3.
  3648             20  FILLER                     PIC X(09).
  3649             20  CF-BENEFIT-CATEGORY        PIC X.
  3650             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  71
* EL640.cbl
  3651
  3652             20  CF-CO-REM-TERM-CALC        PIC X.
  3653                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3654                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3655                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3656                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3657                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3658
  3659             20  CF-CO-EARNINGS-CALC        PIC X.
  3660                 88  CO-EARN-BY-R78             VALUE '1'.
  3661                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3662                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3663                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3664                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3665                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3666                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3667                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3668
  3669             20  CF-CO-REFUND-CALC          PIC X.
  3670                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3671                 88  CO-REFD-BY-R78             VALUE '1'.
  3672                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3673                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3674                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3675                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3676                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3677                 88  CO-REFD-MEAN               VALUE '8'.
  3678                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3679                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3680                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3681
  3682             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3683                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3684                 88  CO-OVRD-BY-R78             VALUE '1'.
  3685                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3686                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3687                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3688                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3689                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3690                 88  CO-OVRD-MEAN               VALUE '8'.
  3691                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3692
  3693             20  CF-CO-BEN-I-G-CD           PIC X.
  3694                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3695                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3696                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3697
  3698         16  FILLER                         PIC X(304).
  3699
  3700
  3701****************************************************************
  3702*             CARRIER MASTER RECORD                            *
  3703****************************************************************
  3704
  3705     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3706         16  CF-ADDRESS-DATA.
  3707             20  CF-MAIL-TO-NAME            PIC X(30).
  3708             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  72
* EL640.cbl
  3709             20  CF-ADDRESS-LINE-1          PIC X(30).
  3710             20  CF-ADDRESS-LINE-2          PIC X(30).
  3711             20  CF-CITY-STATE              PIC X(30).
  3712             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3713             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3714
  3715         16  CF-CLAIM-NO-CONTROL.
  3716             20  CF-CLAIM-NO-METHOD         PIC X.
  3717                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3718                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3719                 88  CLAIM-NO-SEQ               VALUE '3'.
  3720                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3721             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3722                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3723                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3724                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3725
  3726         16  CF-CHECK-NO-CONTROL.
  3727             20  CF-CHECK-NO-METHOD         PIC X.
  3728                 88  CHECK-NO-MANUAL            VALUE '1'.
  3729                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3730                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3731                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3732             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3733                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3734
  3735         16  CF-DOMICILE-STATE              PIC XX.
  3736
  3737         16  CF-EXPENSE-CONTROLS.
  3738             20  CF-EXPENSE-METHOD          PIC X.
  3739                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3740                 88  DOLLARS-PER-PMT            VALUE '2'.
  3741                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3742                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3743             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3744             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3745
  3746         16  CF-CORRESPONDENCE-CONTROL.
  3747             20  CF-LETTER-RESEND-OPT       PIC X.
  3748                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3749                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3750             20  FILLER                     PIC X(4).
  3751
  3752         16  CF-RESERVE-CONTROLS.
  3753             20  CF-MANUAL-SW               PIC X.
  3754                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3755             20  CF-FUTURE-SW               PIC X.
  3756                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3757             20  CF-PTC-SW                  PIC X.
  3758                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3759             20  CF-IBNR-SW                 PIC X.
  3760                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3761             20  CF-PTC-LF-SW               PIC X.
  3762                 88  CF-LF-PTC-USED             VALUE '1'.
  3763             20  CF-CDT-ACCESS-METHOD       PIC X.
  3764                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3765                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3766                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  73
* EL640.cbl
  3767             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3768
  3769         16  CF-CLAIM-CALC-METHOD           PIC X.
  3770             88  360-PLUS-MONTHS                VALUE '1'.
  3771             88  365-PLUS-MONTHS                VALUE '2'.
  3772             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3773             88  360-DAILY                      VALUE '4'.
  3774             88  365-DAILY                      VALUE '5'.
  3775
  3776         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3777         16  FILLER                         PIC X(11).
  3778
  3779         16  CF-LIMIT-AMOUNTS.
  3780             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3781             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3782             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3783             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3784             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3785             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3786             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3787             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3788             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3789             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3790
  3791         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3792         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3793         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3794
  3795         16  CF-ZIP-CODE.
  3796             20  CF-ZIP-PRIME.
  3797                 24  CF-ZIP-1ST             PIC X.
  3798                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3799                 24  FILLER                 PIC X(4).
  3800             20  CF-ZIP-PLUS4               PIC X(4).
  3801         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3802             20  CF-CAN-POSTAL-1            PIC XXX.
  3803             20  CF-CAN-POSTAL-2            PIC XXX.
  3804             20  FILLER                     PIC XXX.
  3805
  3806         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3807         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3808         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3809
  3810         16  CF-RATING-SWITCH               PIC X.
  3811             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3812             88  CF-NO-RATING                   VALUE 'N'.
  3813
  3814         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3815
  3816         16  CF-CARRIER-OVER-SHORT.
  3817             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3818             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3819
  3820         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3821         16  CF-SECPAY-SWITCH               PIC X.
  3822             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3823             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3824         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  74
* EL640.cbl
  3825         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3826         16  FILLER                         PIC X(444).
  3827*        16  FILLER                         PIC X(452).
  3828
  3829
  3830****************************************************************
  3831*             MORTALITY MASTER RECORD                          *
  3832****************************************************************
  3833
  3834     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3835         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3836                                INDEXED BY CF-MORT-NDX.
  3837             20  CF-MORT-TABLE              PIC X(5).
  3838             20  CF-MORT-TABLE-TYPE         PIC X.
  3839                 88  CF-MORT-JOINT              VALUE 'J'.
  3840                 88  CF-MORT-SINGLE             VALUE 'S'.
  3841                 88  CF-MORT-COMBINED           VALUE 'C'.
  3842                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3843                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3844             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3845             20  CF-MORT-AGE-METHOD         PIC XX.
  3846                 88  CF-AGE-LAST                VALUE 'AL'.
  3847                 88  CF-AGE-NEAR                VALUE 'AN'.
  3848             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3849             20  CF-MORT-ADJUSTMENT-DIRECTION
  3850                                            PIC X.
  3851                 88  CF-MINUS                   VALUE '-'.
  3852                 88  CF-PLUS                    VALUE '+'.
  3853             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3854             20  CF-MORT-JOINT-CODE         PIC X.
  3855                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3856             20  CF-MORT-PC-Q               PIC X.
  3857                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3858             20  CF-MORT-TABLE-CODE         PIC X(4).
  3859             20  CF-MORT-COMMENTS           PIC X(15).
  3860             20  FILLER                     PIC X(14).
  3861
  3862         16  FILLER                         PIC X(251).
  3863
  3864
  3865****************************************************************
  3866*             BUSSINESS TYPE MASTER RECORD                     *
  3867****************************************************************
  3868
  3869     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3870* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3871* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3872* AND RECORD 05 IS TYPES 81-99
  3873         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3874             20  CF-BUSINESS-TITLE          PIC  X(19).
  3875             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3876                                            PIC S9V9(4) COMP-3.
  3877             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3878             20  FILLER                     PIC  X.
  3879         16  FILLER                         PIC  X(248).
  3880
  3881
  3882****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  75
* EL640.cbl
  3883*             TERMINAL MASTER RECORD                           *
  3884****************************************************************
  3885
  3886     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3887
  3888         16  CF-COMPANY-TERMINALS.
  3889             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3890                                  PIC X(4).
  3891         16  FILLER               PIC X(248).
  3892
  3893
  3894****************************************************************
  3895*             LIFE EDIT MASTER RECORD                          *
  3896****************************************************************
  3897
  3898     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3899         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3900             20  CF-LIFE-CODE-IN            PIC XX.
  3901             20  CF-LIFE-CODE-OUT           PIC XX.
  3902         16  FILLER                         PIC X(248).
  3903
  3904
  3905****************************************************************
  3906*             AH EDIT MASTER RECORD                            *
  3907****************************************************************
  3908
  3909     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3910         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3911             20  CF-AH-CODE-IN              PIC XXX.
  3912             20  CF-AH-CODE-OUT             PIC XX.
  3913         16  FILLER                         PIC X(248).
  3914
  3915
  3916****************************************************************
  3917*             CREDIBILITY TABLES                               *
  3918****************************************************************
  3919
  3920     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3921         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3922                             INDEXED BY CF-CRDB-NDX.
  3923             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3924             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3925             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3926         16  FILLER                         PIC  X(332).
  3927
  3928
  3929****************************************************************
  3930*             REPORT CUSTOMIZATION RECORD                      *
  3931****************************************************************
  3932
  3933     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3934         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3935             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3936             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3937             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3938**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3939****       A T-TRANSFER.                                   ****
  3940             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  76
* EL640.cbl
  3941
  3942         16  FILLER                         PIC XX.
  3943
  3944         16  CF-CARRIER-CNTL-OPT.
  3945             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3946                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3947                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3948             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3949                                            PIC X.
  3950         16  CF-GROUP-CNTL-OPT.
  3951             20  CF-GROUP-OPT-SEQ           PIC 9.
  3952                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3953                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3954             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3955                                            PIC X(6).
  3956         16  CF-STATE-CNTL-OPT.
  3957             20  CF-STATE-OPT-SEQ           PIC 9.
  3958                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3959                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3960             20  CF-STATE-SELECT OCCURS 3 TIMES
  3961                                            PIC XX.
  3962         16  CF-ACCOUNT-CNTL-OPT.
  3963             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3964                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3965                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3966             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3967                                            PIC X(10).
  3968         16  CF-BUS-TYP-CNTL-OPT.
  3969             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3970                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3971                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3972             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3973                                            PIC XX.
  3974         16  CF-LF-TYP-CNTL-OPT.
  3975             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3976                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3977                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3978             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3979                                            PIC XX.
  3980         16  CF-AH-TYP-CNTL-OPT.
  3981             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3982                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3983                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3984             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3985                                            PIC XX.
  3986         16  CF-REPTCD1-CNTL-OPT.
  3987             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3988                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3989                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3990             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3991                                            PIC X(10).
  3992         16  CF-REPTCD2-CNTL-OPT.
  3993             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3994                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3995                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3996             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3997                                            PIC X(10).
  3998         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  77
* EL640.cbl
  3999             20  CF-USER1-OPT-SEQ           PIC 9.
  4000                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4001                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4002             20  CF-USER1-SELECT OCCURS 3 TIMES
  4003                                            PIC X(10).
  4004         16  CF-USER2-CNTL-OPT.
  4005             20  CF-USER2-OPT-SEQ           PIC 9.
  4006                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4007                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4008             20  CF-USER2-SELECT OCCURS 3 TIMES
  4009                                            PIC X(10).
  4010         16  CF-USER3-CNTL-OPT.
  4011             20  CF-USER3-OPT-SEQ           PIC 9.
  4012                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4013                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4014             20  CF-USER3-SELECT OCCURS 3 TIMES
  4015                                            PIC X(10).
  4016         16  CF-USER4-CNTL-OPT.
  4017             20  CF-USER4-OPT-SEQ           PIC 9.
  4018                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4019                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4020             20  CF-USER4-SELECT OCCURS 3 TIMES
  4021                                            PIC X(10).
  4022         16  CF-USER5-CNTL-OPT.
  4023             20  CF-USER5-OPT-SEQ           PIC 9.
  4024                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4025                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4026             20  CF-USER5-SELECT OCCURS 3 TIMES
  4027                                            PIC X(10).
  4028         16  CF-REINS-CNTL-OPT.
  4029             20  CF-REINS-OPT-SEQ           PIC 9.
  4030                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4031                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4032             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4033                 24  CF-REINS-PRIME         PIC XXX.
  4034                 24  CF-REINS-SUB           PIC XXX.
  4035
  4036         16  CF-AGENT-CNTL-OPT.
  4037             20  CF-AGENT-OPT-SEQ           PIC 9.
  4038                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4039                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4040             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4041                                            PIC X(10).
  4042
  4043         16  FILLER                         PIC X(43).
  4044
  4045         16  CF-LOSS-RATIO-SELECT.
  4046             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4047             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4048         16  CF-ENTRY-DATE-SELECT.
  4049             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4050             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4051         16  CF-EFFECTIVE-DATE-SELECT.
  4052             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4053             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4054
  4055         16  CF-EXCEPTION-LIST-IND          PIC X.
  4056             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  78
* EL640.cbl
  4057
  4058         16  FILLER                         PIC X(318).
  4059
  4060****************************************************************
  4061*                  EXCEPTION REPORTING RECORD                  *
  4062****************************************************************
  4063
  4064     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4065         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4066             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4067
  4068         16  CF-COMBINED-LIFE-AH-OPT.
  4069             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4070             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4071             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4072             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4073
  4074         16  CF-LIFE-OPT.
  4075             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4076             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4077             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4078             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4079             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4080             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4081             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4082             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4083             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4084             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4085
  4086         16  CF-AH-OPT.
  4087             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4088             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4089             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4090             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4091             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4092             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4093             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4094             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4095             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4096             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4097
  4098         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4099             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4100             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4101             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4102
  4103         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4104
  4105         16  FILLER                         PIC X(673).
  4106
  4107
  4108****************************************************************
  4109*             MORTGAGE SYSTEM PLAN RECORD                      *
  4110****************************************************************
  4111
  4112     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4113         16  CF-PLAN-TYPE                   PIC X.
  4114             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  79
* EL640.cbl
  4115             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4116             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4117         16  CF-PLAN-ABBREV                 PIC XXX.
  4118         16  CF-PLAN-DESCRIPT               PIC X(10).
  4119         16  CF-PLAN-NOTES                  PIC X(20).
  4120         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4121         16  CF-PLAN-UNDERWRITING.
  4122             20  CF-PLAN-TERM-DATA.
  4123                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4124                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4125             20  CF-PLAN-AGE-DATA.
  4126                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4127                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4128                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4129             20  CF-PLAN-BENEFIT-DATA.
  4130                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4131                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4132                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4133                                            PIC S9(7)V99  COMP-3.
  4134         16  CF-PLAN-POLICY-FORMS.
  4135             20  CF-POLICY-FORM             PIC X(12).
  4136             20  CF-MASTER-APPLICATION      PIC X(12).
  4137             20  CF-MASTER-POLICY           PIC X(12).
  4138         16  CF-PLAN-RATING.
  4139             20  CF-RATE-CODE               PIC X(5).
  4140             20  CF-SEX-RATING              PIC X.
  4141                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4142                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4143             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4144             20  CF-SUB-STD-TYPE            PIC X.
  4145                 88  CF-PCT-OF-PREM            VALUE '1'.
  4146                 88  CF-PCT-OF-BENE            VALUE '2'.
  4147         16  CF-PLAN-PREM-TOLERANCES.
  4148             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4149             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4150         16  CF-PLAN-PYMT-TOLERANCES.
  4151             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4152             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4153         16  CF-PLAN-MISC-DATA.
  4154             20  FILLER                     PIC X.
  4155             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4156             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4157         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4158         16  CF-PLAN-IND-GRP                PIC X.
  4159             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4160                                                     '1'.
  4161             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4162                                                     '2'.
  4163         16  CF-MIB-SEARCH-SW               PIC X.
  4164             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4165             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4166             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4167             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4168         16  CF-ALPHA-SEARCH-SW             PIC X.
  4169             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4170             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4171             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4172             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  80
* EL640.cbl
  4173             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4174             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4175             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4176             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4177             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4178             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4179                                                     'A' 'B' 'C'
  4180                                                     'X' 'Y' 'Z'.
  4181         16  CF-EFF-DT-RULE-SW              PIC X.
  4182             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4183             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4184             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4185             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4186             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4187         16  FILLER                         PIC X(4).
  4188         16  CF-HEALTH-QUESTIONS            PIC X.
  4189             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4190         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4191         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4192         16  CF-PLAN-SNGL-JNT               PIC X.
  4193             88  CF-COMBINED-PLAN              VALUE 'C'.
  4194             88  CF-JNT-PLAN                   VALUE 'J'.
  4195             88  CF-SNGL-PLAN                  VALUE 'S'.
  4196         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4197         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4198         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4199         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4200         16  CF-RERATE-CNTL                 PIC  X.
  4201             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4202             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4203             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4204             88  CF-AUTO-RECALC                 VALUE '4'.
  4205         16  CF-BENEFIT-TYPE                PIC  X.
  4206             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4207             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4208         16  CF-POLICY-FEE                  PIC S999V99
  4209                                                    COMP-3.
  4210         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4211         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4212         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4213         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4214         16  FILLER                         PIC  X(32).
  4215         16  CF-TERMINATION-FORM            PIC  X(04).
  4216         16  FILLER                         PIC  X(08).
  4217         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4218                                                       COMP-3.
  4219         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4220         16  CF-ISSUE-LETTER                PIC  X(4).
  4221         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4222         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4223             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4224             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4225         16  CF-MP-REFUND-CALC              PIC X.
  4226             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4227             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4228             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4229             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4230             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  81
* EL640.cbl
  4231             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4232             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4233             88  CF-MP-REFD-MEAN                VALUE '8'.
  4234         16  CF-ALT-RATE-CODE               PIC  X(5).
  4235
  4236
  4237         16  FILLER                         PIC X(498).
  4238****************************************************************
  4239*             MORTGAGE COMPANY MASTER RECORD                   *
  4240****************************************************************
  4241
  4242     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4243         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4244         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4245             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4246             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4247             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4248             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4249             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4250
  4251         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4252         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4253         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4254         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4255         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4256
  4257         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4258             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4259         16  CF-MP-RECON-USE-IND            PIC X(1).
  4260             88  CF-MP-USE-RECON             VALUE 'Y'.
  4261         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4262             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4263         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4264             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4265             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4266         16  FILLER                         PIC X(1).
  4267         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4268             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4269         16  CF-MORTG-MIB-VERSION           PIC X.
  4270             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4271             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4272             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4273         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4274             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4275                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4276             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4277                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4278             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4279                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4280             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4281                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4282             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4283                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4284             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4285                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4286         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4287         16  FILLER                         PIC X(7).
  4288         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  82
* EL640.cbl
  4289             20  CF-MORTG-MIB-COMM          PIC X(5).
  4290             20  CF-MORTG-MIB-TERM          PIC X(5).
  4291         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4292             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4293         16  FILLER                         PIC X(03).
  4294         16  CF-MP-CHECK-NO-CONTROL.
  4295             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4296                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4297                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4298                                                ' ' LOW-VALUES.
  4299                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4300                                               VALUE '3'.
  4301         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4302         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4303         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4304             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4305                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4306             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4307                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4308             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4309                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4310             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4311                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4312             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4313                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4314             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4315                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4316         16  CF-MORTG-BILLING-AREA.
  4317             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4318                                            PIC X.
  4319         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4320         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4321         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4322         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4323             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4324             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4325         16  FILLER                         PIC X.
  4326         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4327             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4328             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4329         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4330         16  FILLER                         PIC X(8).
  4331         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4332         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4333         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4334         16  CF-ACH-COMPANY-ID.
  4335             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4336                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4337                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4338                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4339             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4340         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4341             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4342         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4343             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4344             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4345         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4346         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  83
* EL640.cbl
  4347         16  FILLER                         PIC X(536).
  4348
  4349****************************************************************
  4350*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4351****************************************************************
  4352
  4353     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4354         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4355             20  CF-FEMALE-HEIGHT.
  4356                 24  CF-FEMALE-FT           PIC 99.
  4357                 24  CF-FEMALE-IN           PIC 99.
  4358             20  CF-FEMALE-MIN-WT           PIC 999.
  4359             20  CF-FEMALE-MAX-WT           PIC 999.
  4360         16  FILLER                         PIC X(428).
  4361
  4362     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4363         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4364             20  CF-MALE-HEIGHT.
  4365                 24  CF-MALE-FT             PIC 99.
  4366                 24  CF-MALE-IN             PIC 99.
  4367             20  CF-MALE-MIN-WT             PIC 999.
  4368             20  CF-MALE-MAX-WT             PIC 999.
  4369         16  FILLER                         PIC X(428).
  4370******************************************************************
  4371*             AUTOMATIC ACTIVITY RECORD                          *
  4372******************************************************************
  4373     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4374         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4375             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4376             20  CF-SYS-LETTER-ID           PIC X(04).
  4377             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4378             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4379             20  CF-SYS-RESET-SW            PIC X(01).
  4380             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4381             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4382
  4383         16  FILLER                         PIC X(50).
  4384
  4385         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4386             20  CF-USER-ACTIVE-SW          PIC X(01).
  4387             20  CF-USER-LETTER-ID          PIC X(04).
  4388             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4389             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4390             20  CF-USER-RESET-SW           PIC X(01).
  4391             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4392             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4393             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4394
  4395         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  84
* EL640.cbl
  4397*                            COPY ERCCOMP.
  4398******************************************************************
  4399*                                                                *
  4400*                                                                *
  4401*                            ERCCOMP                             *
  4402*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4403*                            VMOD=2.019                          *
  4404*                                                                *
  4405*   ONLINE CREDIT SYSTEM                                         *
  4406*                                                                *
  4407*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4408*                                                                *
  4409*   FILE TYPE = VSAM,KSDS                                        *
  4410*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4411*                                                                *
  4412*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4413*       ALTERNATE PATH = NONE                                    *
  4414*                                                                *
  4415*   LOG = NO                                                     *
  4416*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4417*                                                                *
  4418******************************************************************
  4419*                   C H A N G E   L O G
  4420*
  4421* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4422*-----------------------------------------------------------------
  4423*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4424* EFFECTIVE    NUMBER
  4425*-----------------------------------------------------------------
  4426* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4427* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4428* 092205    2005050300006  PEMA  ADD LEASE FEE
  4429* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4430* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4431* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4432* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4433* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4434* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4435******************************************************************
  4436
  4437 01  COMPENSATION-MASTER.
  4438     12  CO-RECORD-ID                          PIC XX.
  4439         88  VALID-CO-ID                          VALUE 'CO'.
  4440
  4441     12  CO-CONTROL-PRIMARY.
  4442         16  CO-COMPANY-CD                     PIC X.
  4443         16  CO-CONTROL.
  4444             20  CO-CTL-1.
  4445                 24  CO-CARR-GROUP.
  4446                     28  CO-CARRIER            PIC X.
  4447                     28  CO-GROUPING.
  4448                         32  CO-GROUP-PREFIX   PIC XXX.
  4449                         32  CO-GROUP-PRIME    PIC XXX.
  4450                 24  CO-RESP-NO.
  4451                     28  CO-RESP-PREFIX        PIC X(4).
  4452                     28  CO-RESP-PRIME         PIC X(6).
  4453             20  CO-CTL-2.
  4454                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  85
* EL640.cbl
  4455                     28  CO-ACCT-PREFIX        PIC X(4).
  4456                     28  CO-ACCT-PRIME         PIC X(6).
  4457         16  CO-TYPE                           PIC X.
  4458             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4459             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4460             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4461
  4462     12  CO-MAINT-INFORMATION.
  4463         16  CO-LAST-MAINT-DT                  PIC XX.
  4464         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4465         16  CO-LAST-MAINT-USER                PIC X(4).
  4466     12  FILLER                                PIC XX.
  4467     12  CO-STMT-TYPE                          PIC XXX.
  4468     12  CO-COMP-TYPE                          PIC X.
  4469         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4470     12  CO-STMT-OWNER                         PIC X(4).
  4471     12  CO-BALANCE-CONTROL                    PIC X.
  4472         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4473         88  CO-NO-BALANCE                        VALUE 'N'.
  4474
  4475     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4476         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4477         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4478         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4479
  4480     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4481         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4482         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4483
  4484     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4485     12  CO-GA-DIRECT-DEP                      PIC X.
  4486     12  CO-FUTURE-SPACE                       PIC X.
  4487         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4488
  4489     12  CO-ACCT-NAME                          PIC X(30).
  4490     12  CO-MAIL-NAME                          PIC X(30).
  4491     12  CO-ADDR-1                             PIC X(30).
  4492     12  CO-ADDR-2                             PIC X(30).
  4493     12  CO-ADDR-3.
  4494         16  CO-ADDR-CITY                      PIC X(27).
  4495         16  CO-ADDR-STATE                     PIC XX.
  4496     12  CO-CSO-1099                           PIC X.
  4497     12  CO-ZIP.
  4498         16  CO-ZIP-PRIME.
  4499             20  CO-ZIP-PRI-1ST                PIC X.
  4500                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4501             20  FILLER                        PIC X(4).
  4502         16  CO-ZIP-PLUS4                      PIC X(4).
  4503     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4504         16  CO-CAN-POSTAL-1                   PIC XXX.
  4505         16  CO-CAN-POSTAL-2                   PIC XXX.
  4506         16  FILLER                            PIC XXX.
  4507     12  CO-SOC-SEC                            PIC X(13).
  4508     12  CO-TELEPHONE.
  4509         16  CO-AREA-CODE                      PIC XXX.
  4510         16  CO-PREFIX                         PIC XXX.
  4511         16  CO-PHONE                          PIC X(4).
  4512
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  86
* EL640.cbl
  4513     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4514
  4515     12  CO-AR-BAL-LEVEL                       PIC X.
  4516         88  CO-AR-REF-LVL                        VALUE '1'.
  4517         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4518         88  CO-AR-BILL-LVL                       VALUE '2'.
  4519         88  CO-AR-AGT-LVL                        VALUE '3'.
  4520         88  CO-AR-FR-LVL                         VALUE '4'.
  4521
  4522     12  CO-AR-NORMAL-PRINT                    PIC X.
  4523         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4524         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4525
  4526     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4527
  4528     12  CO-AR-REPORTING                       PIC X.
  4529         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4530         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4531
  4532     12  CO-AR-PULL-CHECK                      PIC X.
  4533         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4534         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4535
  4536     12  CO-AR-BALANCE-PRINT                   PIC X.
  4537         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4538
  4539     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4540         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4541         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4542         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4543
  4544     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4545
  4546     12  CO-USER-CODE                          PIC X.
  4547     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4548
  4549******************************************************************
  4550*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4551*    THE LAST MONTH END RUN.
  4552******************************************************************
  4553
  4554     12  CO-LAST-ACTIVITY-DATE.
  4555         16  CO-ACT-YEAR                       PIC 99.
  4556         16  CO-ACT-MONTH                      PIC 99.
  4557         16  CO-ACT-DAY                        PIC 99.
  4558
  4559     12  CO-LAST-STMT-DT.
  4560         16  CO-LAST-STMT-YEAR                 PIC 99.
  4561         16  CO-LAST-STMT-MONTH                PIC 99.
  4562         16  CO-LAST-STMT-DAY                  PIC 99.
  4563
  4564     12  CO-MO-END-TOTALS.
  4565         16  CO-MONTHLY-TOTALS.
  4566             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4567             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4568             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4569             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4570             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  87
* EL640.cbl
  4571
  4572         16  CO-AGING-TOTALS.
  4573             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4574             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4575             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4576             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4577
  4578         16  CO-YTD-TOTALS.
  4579             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4580             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4581
  4582         16  CO-OVER-UNDER-TOTALS.
  4583             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4584             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4585
  4586     12  CO-MISCELLANEOUS-TOTALS.
  4587         16  CO-FICA-TOTALS.
  4588             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4589             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4590
  4591         16  CO-CLAIM-TOTALS.
  4592             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4593             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4594
  4595******************************************************************
  4596*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4597*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4598******************************************************************
  4599
  4600     12  CO-CURRENT-TOTALS.
  4601         16  CO-CURRENT-LAST-STMT-DT.
  4602             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4603             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4604             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4605
  4606         16  CO-CURRENT-MONTHLY-TOTALS.
  4607             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4608             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4609             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4610             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4611             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4612
  4613         16  CO-CURRENT-AGING-TOTALS.
  4614             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4615             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4616             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4617             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4618
  4619         16  CO-CURRENT-YTD-TOTALS.
  4620             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4621             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4622
  4623     12  CO-PAID-COMM-TOTALS.
  4624         16  CO-YTD-PAID-COMMS.
  4625             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4626             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4627
  4628     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  88
* EL640.cbl
  4629         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4630         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4631
  4632     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4633         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4634         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4635         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4636         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4637         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4638         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4639         88  CO-FINAL-LETTER                  VALUE 'F'.
  4640         88  CO-RECONCILING                   VALUE 'R'.
  4641         88  CO-PHONE-CALL                    VALUE 'P'.
  4642         88  CO-LEGAL                         VALUE 'L'.
  4643         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4644         88  CO-WRITE-OFF                     VALUE 'W'.
  4645         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4646
  4647     12  CO-CSR-CODE                       PIC X(4).
  4648
  4649     12  CO-GA-STATUS-INFO.
  4650         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4651         16  CO-GA-TERMINATION-DT          PIC XX.
  4652         16  CO-GA-STATUS-CODE             PIC X.
  4653             88  CO-GA-ACTIVE                 VALUE 'A'.
  4654             88  CO-GA-INACTIVE               VALUE 'I'.
  4655             88  CO-GA-PENDING                VALUE 'P'.
  4656         16  CO-GA-COMMENTS.
  4657             20  CO-GA-COMMENT-1           PIC X(40).
  4658             20  CO-GA-COMMENT-2           PIC X(40).
  4659             20  CO-GA-COMMENT-3           PIC X(40).
  4660             20  CO-GA-COMMENT-4           PIC X(40).
  4661
  4662     12  CO-RPTCD2                         PIC X(10).
  4663     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4664         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4665         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4666
  4667     12  CO-TYPE-AGENT                     PIC X(01).
  4668         88  CO-CORPORATION                   VALUE 'C'.
  4669         88  CO-PARTNERSHIP                   VALUE 'P'.
  4670         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4671         88  CO-TRUST                         VALUE 'T'.
  4672         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4673
  4674     12  CO-FAXNO.
  4675         16  CO-FAX-AREA-CODE                  PIC XXX.
  4676         16  CO-FAX-PREFIX                     PIC XXX.
  4677         16  CO-FAX-PHONE                      PIC X(4).
  4678
  4679     12  CO-BANK-INFORMATION.
  4680         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4681         16  CO-BANK-TRANSIT-NON REDEFINES
  4682             CO-BANK-TRANSIT-NO                PIC 9(8).
  4683
  4684         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4685     12  CO-MISC-DEDUCT-INFO REDEFINES
  4686                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  89
* EL640.cbl
  4687         16  CO-MD-GL-ACCT                     PIC X(10).
  4688         16  CO-MD-DIV                         PIC XX.
  4689         16  CO-MD-CENTER                      PIC X(4).
  4690         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4691         16  CO-CREATE-AP-CHECK                PIC X.
  4692         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4693         16  FILLER                            PIC XXX.
  4694     12  CO-ACH-STATUS                         PIC X.
  4695         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4696         88  CO-ACH-PENDING                        VALUE 'P'.
  4697
  4698     12  CO-BILL-SW                            PIC X.
  4699     12  CO-CONTROL-NAME                       PIC X(30).
  4700     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4701     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4702     12  CO-CLP-STATE                          PIC XX.
  4703     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4704     12  CO-SPP-REFUND-EDIT                    PIC X.
  4705
  4706******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  90
* EL640.cbl
  4708*                            COPY ERCPYAJ.
  4709******************************************************************
  4710*                                                                *
  4711*                            ERCPYAJ                             *
  4712*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4713*                            VMOD=2.015                          *
  4714*                                                                *
  4715*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  4716*                                                                *
  4717*                                                                *
  4718*   FILE TYPE = VSAM,KSDS                                        *
  4719*   RECORD SIZE = 200  RECFORM = FIXED                           *
  4720*                                                                *
  4721*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  4722*       ALTERNATE PATHS = NONE                                   *
  4723*                                                                *
  4724*   LOG = YES                                                    *
  4725*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4726******************************************************************
  4727******************************************************************
  4728*                   C H A N G E   L O G
  4729*
  4730* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4731*-----------------------------------------------------------------
  4732*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4733* EFFECTIVE    NUMBER
  4734*-----------------------------------------------------------------
  4735* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  4736* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  4737******************************************************************
  4738
  4739 01  PENDING-PAY-ADJ.
  4740     12  PY-RECORD-ID                     PIC XX.
  4741         88  VALID-PY-ID                        VALUE 'PY'.
  4742
  4743     12  PY-CONTROL-PRIMARY.
  4744         16  PY-COMPANY-CD                PIC X.
  4745         16  PY-CARRIER                   PIC X.
  4746         16  PY-GROUPING                  PIC X(6).
  4747         16  PY-FIN-RESP                  PIC X(10).
  4748         16  PY-ACCOUNT                   PIC X(10).
  4749         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  4750                                          PIC X(10).
  4751         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  4752         16  PY-RECORD-TYPE               PIC X.
  4753             88  PY-REMIT-RECEIVED            VALUE 'R'.
  4754             88  PY-DEPOSIT                   VALUE 'D'.
  4755             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  4756             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  4757             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  4758             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  4759             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  4760             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  4761             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  4762             88  PY-FICA-ENTRY                VALUE 'F'.
  4763             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  4764             88  PY-POLICY-FEE                VALUE 'W'.
  4765             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  91
* EL640.cbl
  4766
  4767     12  PY-PYMT-TYPE                     PIC X.
  4768             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  4769             88  PY-REINS-PYMT                VALUE 'R'.
  4770             88  PY-EXP-PYMT                  VALUE 'E'.
  4771
  4772     12  PY-BIL-INV                       PIC X(6).
  4773     12  PY-REF-NO                        PIC X(12).
  4774
  4775     12  PY-LAST-MAINT-DT                 PIC XX.
  4776     12  PY-LAST-MAINT-BY                 PIC X(4).
  4777     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4778
  4779     12  PY-PYADJ-RECORD.
  4780         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  4781         16  PY-ENTRY-COMMENT             PIC X(30).
  4782         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  4783             20  PY-GL-ACCOUNT            PIC X(10).
  4784             20  PY-GL-STATE              PIC X(02).
  4785             20  PY-GL-CANC-SW            PIC X(01).
  4786                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  4787                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  4788             20  PY-GL-COMMENT            PIC X(10).
  4789             20  FILLER      REDEFINES PY-GL-COMMENT.
  4790                 24  PY-GL-CHECK-NO       PIC 9(06).
  4791                 24  FILLER               PIC X(04).
  4792             20  FILLER                   PIC X(07).
  4793         16  PY-SAVE-ACCOUNT              PIC X(10).
  4794         16  PY-SAVE-TYPE                 PIC X(01).
  4795
  4796         16  PY-LETTERS.
  4797             20  PY-LETTER OCCURS 3 TIMES
  4798                           INDEXED BY PY-LET-NDX
  4799                                          PIC X(04).
  4800
  4801         16  PY-ERCOMP-TYPE               PIC X.
  4802             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  4803             88  PY-GA-TYPE                   VALUE 'G'.
  4804             88  PY-BANK-TYPE                 VALUE 'B'.
  4805         16  FILLER                       PIC X(05).
  4806
  4807     12  PY-RECORD-STATUS.
  4808         16  PY-CREDIT-SELECT-DT          PIC XX.
  4809         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  4810         16  PY-BILLED-DATE               PIC XX.
  4811         16  PY-REPORTED-DT               PIC XX.
  4812         16  PY-PMT-APPLIED               PIC X.
  4813             88  PY-ACCOUNT-PMT               VALUE 'A'.
  4814             88  PY-GA-PMT                    VALUE 'G'.
  4815             88  PY-OVWRITE-PMT               VALUE 'O'.
  4816             88  PY-NON-AR-PMT                VALUE 'N'.
  4817         16  FILLER                       PIC X(5).
  4818         16  PY-INPUT-DT                  PIC XX.
  4819         16  PY-CHECK-NUMBER              PIC X(6).
  4820         16  PY-VOID-SW                   PIC X.
  4821             88  PY-CHECK-VOIDED              VALUE 'V'.
  4822         16  PY-CHECK-ORIGIN-SW           PIC X.
  4823             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  92
* EL640.cbl
  4824             88  PY-REFUND-CHECK              VALUE 'R'.
  4825             88  PY-GA-CHECK                  VALUE 'G'.
  4826             88  PY-CHECK-WRITTEN             VALUE 'W'.
  4827             88  PY-CHECK-REVERSAL            VALUE 'V'.
  4828         16  PY-CHECK-WRITTEN-DT          PIC XX.
  4829         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  4830         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  4831         16  PY-BILL-FLAG                 PIC X.
  4832             88  PY-BILLED                    VALUE 'B'.
  4833         16  PY-AR-FLAG                   PIC X.
  4834             88  PY-AR-CYCLE                  VALUE 'C'.
  4835             88  PY-AR-MONTH-END              VALUE 'M'.
  4836         16  PY-AR-DATE                   PIC XX.
  4837
  4838     12  PY-GL-CODES.
  4839         16  PY-GL-DB                     PIC X(14).
  4840         16  PY-GL-CR                     PIC X(14).
  4841         16  PY-GL-FLAG                   PIC X.
  4842         16  PY-GL-DATE                   PIC XX.
  4843
  4844     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  4845     12  FILLER                           PIC X(3).
  4846******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  93
* EL640.cbl
  4848*                            COPY ERCACCT.
  4849******************************************************************
  4850*                                                                *
  4851*                                                                *
  4852*                            ERCACCT                             *
  4853*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4854*                            VMOD=2.031                          *
  4855*                                                                *
  4856*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4857*                                                                *
  4858*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4859*   VSAM ACCOUNT MASTER FILES.                                   *
  4860*                                                                *
  4861*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4862*                                                                *
  4863*   FILE TYPE = VSAM,KSDS                                        *
  4864*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4865*                                                                *
  4866*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4867*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4868*                                                                *
  4869*   LOG = NO                                                     *
  4870*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4871*                                                                *
  4872*                                                                *
  4873******************************************************************
  4874*                   C H A N G E   L O G
  4875*
  4876* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4877*-----------------------------------------------------------------
  4878*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4879* EFFECTIVE    NUMBER
  4880*-----------------------------------------------------------------
  4881* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4882* 092705    2005050300006  PEMA  ADD SPP LEASES
  4883* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4884* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4885* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4886* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4887* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4888******************************************************************
  4889
  4890 01  ACCOUNT-MASTER.
  4891     12  AM-RECORD-ID                      PIC XX.
  4892         88  VALID-AM-ID                      VALUE 'AM'.
  4893
  4894     12  AM-CONTROL-PRIMARY.
  4895         16  AM-COMPANY-CD                 PIC X.
  4896         16  AM-MSTR-CNTRL.
  4897             20  AM-CONTROL-A.
  4898                 24  AM-CARRIER            PIC X.
  4899                 24  AM-GROUPING.
  4900                     28 AM-GROUPING-PREFIX PIC XXX.
  4901                     28 AM-GROUPING-PRIME  PIC XXX.
  4902                 24  AM-STATE              PIC XX.
  4903                 24  AM-ACCOUNT.
  4904                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4905                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  94
* EL640.cbl
  4906             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4907                                           PIC X(19).
  4908             20  AM-CNTRL-B.
  4909                 24  AM-EXPIRATION-DT      PIC XX.
  4910                 24  FILLER                PIC X(4).
  4911             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4912                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4913
  4914     12  AM-CONTROL-BY-VAR-GRP.
  4915         16  AM-COMPANY-CD-A1              PIC X.
  4916         16  AM-VG-CARRIER                 PIC X.
  4917         16  AM-VG-GROUPING                PIC X(6).
  4918         16  AM-VG-STATE                   PIC XX.
  4919         16  AM-VG-ACCOUNT                 PIC X(10).
  4920         16  AM-VG-DATE.
  4921             20  AM-VG-EXPIRATION-DT       PIC XX.
  4922             20  FILLER                    PIC X(4).
  4923         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4924                                           PIC 9(11)      COMP-3.
  4925     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4926         16  FILLER                        PIC X(10).
  4927         16  AM-VG-KEY3.
  4928             20  AM-VG3-ACCOUNT            PIC X(10).
  4929             20  AM-VG3-EXP-DT             PIC XX.
  4930         16  FILLER                        PIC X(4).
  4931     12  AM-MAINT-INFORMATION.
  4932         16  AM-LAST-MAINT-DT              PIC XX.
  4933         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4934         16  AM-LAST-MAINT-USER            PIC X(4).
  4935         16  FILLER                        PIC XX.
  4936
  4937     12  AM-EFFECTIVE-DT                   PIC XX.
  4938     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4939
  4940     12  AM-PREV-DATES  COMP-3.
  4941         16  AM-PREV-EXP-DT                PIC 9(11).
  4942         16  AM-PREV-EFF-DT                PIC 9(11).
  4943
  4944     12  AM-REPORT-CODE-1                  PIC X(10).
  4945     12  AM-REPORT-CODE-2                  PIC X(10).
  4946
  4947     12  AM-CITY-CODE                      PIC X(4).
  4948     12  AM-COUNTY-PARISH                  PIC X(6).
  4949
  4950     12  AM-NAME                           PIC X(30).
  4951     12  AM-PERSON                         PIC X(30).
  4952     12  AM-ADDRS                          PIC X(30).
  4953     12  AM-CITY.
  4954         16  AM-ADDR-CITY                  PIC X(28).
  4955         16  AM-ADDR-STATE                 PIC XX.
  4956     12  AM-ZIP.
  4957         16  AM-ZIP-PRIME.
  4958             20  AM-ZIP-PRI-1ST            PIC X.
  4959                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4960             20  FILLER                    PIC X(4).
  4961         16  AM-ZIP-PLUS4                  PIC X(4).
  4962     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4963         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  95
* EL640.cbl
  4964         16  AM-CAN-POSTAL-2               PIC XXX.
  4965         16  FILLER                        PIC XXX.
  4966     12  AM-TEL-NO.
  4967         16  AM-AREA-CODE                  PIC 999.
  4968         16  AM-TEL-PRE                    PIC 999.
  4969         16  AM-TEL-NBR                    PIC 9(4).
  4970     12  AM-TEL-LOC                        PIC X.
  4971         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4972         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4973
  4974     12  AM-COMM-STRUCTURE.
  4975         16  AM-DEFN-1.
  4976             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4977                 24  AM-AGT.
  4978                     28  AM-AGT-PREFIX     PIC X(4).
  4979                     28  AM-AGT-PRIME      PIC X(6).
  4980                 24  AM-COM-TYP            PIC X.
  4981                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4982                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4983                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4984                 24  AM-RECALC-LV-INDIC    PIC X.
  4985                 24  AM-RETRO-LV-INDIC     PIC X.
  4986                 24  AM-GL-CODES           PIC X.
  4987                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4988                 24  FILLER                PIC X(01).
  4989         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4990             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4991                 24  FILLER                PIC X(11).
  4992                 24  AM-L-COMA             PIC XXX.
  4993                 24  AM-J-COMA             PIC XXX.
  4994                 24  AM-A-COMA             PIC XXX.
  4995                 24  FILLER                PIC X(6).
  4996
  4997     12  AM-COMM-CHANGE-STATUS             PIC X.
  4998         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4999
  5000     12  AM-CSR-CODE                       PIC X(4).
  5001
  5002     12  AM-BILLING-STATUS                 PIC X.
  5003         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5004         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5005     12  AM-AUTO-REFUND-SW                 PIC X.
  5006         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5007         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5008     12  AM-GPCD                           PIC 99.
  5009     12  AM-IG                             PIC X.
  5010         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5011         88  AM-HAS-GROUP                     VALUE '2'.
  5012     12  AM-STATUS                         PIC X.
  5013         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5014         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5015         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5016         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5017         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5018         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5019     12  AM-REMIT-TO                       PIC 99.
  5020     12  AM-ID-NO                          PIC X(11).
  5021
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  96
* EL640.cbl
  5022     12  AM-CAL-TABLE                      PIC XX.
  5023     12  AM-LF-DEVIATION                   PIC XXX.
  5024     12  AM-AH-DEVIATION                   PIC XXX.
  5025     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5026     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5027     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5028     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5029     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5030     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5031
  5032     12  AM-USER-FIELDS.
  5033         16  AM-FLD-1                      PIC XX.
  5034         16  AM-FLD-2                      PIC XX.
  5035         16  AM-FLD-3                      PIC XX.
  5036         16  AM-FLD-4                      PIC XX.
  5037         16  AM-FLD-5                      PIC XX.
  5038
  5039     12  AM-1ST-PROD-DATE.
  5040         16  AM-1ST-PROD-YR                PIC XX.
  5041         16  AM-1ST-PROD-MO                PIC XX.
  5042         16  AM-1ST-PROD-DA                PIC XX.
  5043     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5044     12  AM-CERTS-PURGED-DATE.
  5045         16  AM-PUR-YR                     PIC XX.
  5046         16  AM-PUR-MO                     PIC XX.
  5047         16  AM-PUR-DA                     PIC XX.
  5048     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5049     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5050     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5051     12  AM-INACTIVE-DATE.
  5052         16  AM-INA-MO                     PIC 99.
  5053         16  AM-INA-DA                     PIC 99.
  5054         16  AM-INA-YR                     PIC 99.
  5055     12  AM-AR-HI-CERT-DATE                PIC XX.
  5056
  5057     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5058     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5059
  5060     12  AM-OB-PAYMENT-MODE                PIC X.
  5061         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5062         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5063         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5064         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5065
  5066     12  AM-AH-ONLY-INDICATOR              PIC X.
  5067         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5068         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5069
  5070     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5071
  5072     12  AM-OVER-SHORT.
  5073         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5074         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5075
  5076     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5077     12  AM-DCC-CLP-STATE                  PIC XX.
  5078
  5079     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  97
* EL640.cbl
  5080     12  AM-RECALC-REIN                    PIC X.
  5081
  5082     12  AM-REI-TABLE                      PIC XXX.
  5083     12  AM-REI-ET-LF                      PIC X.
  5084     12  AM-REI-ET-AH                      PIC X.
  5085     12  AM-REI-PE-LF                      PIC X.
  5086     12  AM-REI-PE-AH                      PIC X.
  5087     12  AM-REI-PRT-ST                     PIC X.
  5088     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5089     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5090     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5091     12  AM-REI-GROUP-A                    PIC X(6).
  5092     12  AM-REI-MORT                       PIC X(4).
  5093     12  AM-REI-PRT-OW                     PIC X.
  5094     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5095     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5096     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5097     12  AM-REI-GROUP-B                    PIC X(6).
  5098
  5099     12  AM-TRUST-TYPE                     PIC X(2).
  5100
  5101     12  AM-EMPLOYER-STMT-USED             PIC X.
  5102     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5103
  5104     12  AM-STD-AH-TYPE                    PIC XX.
  5105     12  AM-EARN-METHODS.
  5106         16  AM-EARN-METHOD-R              PIC X.
  5107             88 AM-REF-RL-R78                 VALUE 'R'.
  5108             88 AM-REF-RL-PR                  VALUE 'P'.
  5109             88 AM-REF-RL-MEAN                VALUE 'M'.
  5110             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5111         16  AM-EARN-METHOD-L              PIC X.
  5112             88 AM-REF-LL-R78                 VALUE 'R'.
  5113             88 AM-REF-LL-PR                  VALUE 'P'.
  5114             88 AM-REF-LL-MEAN                VALUE 'M'.
  5115             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5116         16  AM-EARN-METHOD-A              PIC X.
  5117             88 AM-REF-AH-R78                 VALUE 'R'.
  5118             88 AM-REF-AH-PR                  VALUE 'P'.
  5119             88 AM-REF-AH-MEAN                VALUE 'M'.
  5120             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5121             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5122             88 AM-REF-AH-NET                 VALUE 'N'.
  5123
  5124     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5125     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5126     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5127
  5128     12  AM-RET-Y-N                        PIC X.
  5129     12  AM-RET-P-E                        PIC X.
  5130     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5131     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5132     12  AM-RET-GRP                        PIC X(6).
  5133     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5134         16  AM-POOL-PRIME                 PIC XXX.
  5135         16  AM-POOL-SUB                   PIC XXX.
  5136     12  AM-RETRO-EARNINGS.
  5137         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  98
* EL640.cbl
  5138         16  AM-RET-EARN-L                 PIC X.
  5139         16  AM-RET-EARN-A                 PIC X.
  5140     12  AM-RET-ST-TAX-USE                 PIC X.
  5141         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5142         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5143     12  AM-RETRO-BEG-EARNINGS.
  5144         16  AM-RET-BEG-EARN-R             PIC X.
  5145         16  AM-RET-BEG-EARN-L             PIC X.
  5146         16  AM-RET-BEG-EARN-A             PIC X.
  5147     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5148     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5149
  5150     12  AM-USER-SELECT-OPTIONS.
  5151         16  AM-USER-SELECT-1              PIC X(10).
  5152         16  AM-USER-SELECT-2              PIC X(10).
  5153         16  AM-USER-SELECT-3              PIC X(10).
  5154         16  AM-USER-SELECT-4              PIC X(10).
  5155         16  AM-USER-SELECT-5              PIC X(10).
  5156
  5157     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5158
  5159     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5160
  5161     12  AM-RPT045A-SWITCH                 PIC X.
  5162         88  RPT045A-OFF                   VALUE 'N'.
  5163
  5164     12  AM-INSURANCE-LIMITS.
  5165         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5166         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5167
  5168     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5169         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5170
  5171     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5172         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5173         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5174
  5175     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5176
  5177     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5178     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5179     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5180     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5181     12  AM-DCC-UEF-STATE                  PIC XX.
  5182     12  FILLER                            PIC XXX.
  5183     12  AM-REPORT-CODE-3                  PIC X(10).
  5184*    12  FILLER                            PIC X(22).
  5185
  5186     12  AM-RESERVE-DATE.
  5187         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5188         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5189         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5190
  5191     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5192     12  AM-NOTIFICATION-TYPES.
  5193         16  AM-NOTIF-OF-LETTERS           PIC X.
  5194         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5195         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  99
* EL640.cbl
  5196         16  AM-NOTIF-OF-STATUS            PIC X.
  5197
  5198     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5199         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5200         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5201         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5202         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5203
  5204     12  AM-BENEFIT-CONTROLS.
  5205         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5206             20  AM-BENEFIT-CODE           PIC XX.
  5207             20  AM-BENEFIT-TYPE           PIC X.
  5208             20  AM-BENEFIT-REVISION       PIC XXX.
  5209             20  AM-BENEFIT-REM-TERM       PIC X.
  5210             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5211             20  FILLER                    PIC XX.
  5212         16  FILLER                        PIC X(80).
  5213
  5214     12  AM-TRANSFER-DATA.
  5215         16  AM-TRANSFERRED-FROM.
  5216             20  AM-TRNFROM-CARRIER        PIC X.
  5217             20  AM-TRNFROM-GROUPING.
  5218                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5219                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5220             20  AM-TRNFROM-STATE          PIC XX.
  5221             20  AM-TRNFROM-ACCOUNT.
  5222                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5223                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5224             20  AM-TRNFROM-DTE            PIC XX.
  5225         16  AM-TRANSFERRED-TO.
  5226             20  AM-TRNTO-CARRIER          PIC X.
  5227             20  AM-TRNTO-GROUPING.
  5228                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5229                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5230             20  AM-TRNTO-STATE            PIC XX.
  5231             20  AM-TRNTO-ACCOUNT.
  5232                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5233                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5234             20  AM-TRNTO-DTE              PIC XX.
  5235         16  FILLER                        PIC X(10).
  5236
  5237     12  AM-SAVED-REMIT-TO                 PIC 99.
  5238
  5239     12  AM-COMM-STRUCTURE-SAVED.
  5240         16  AM-DEFN-1-SAVED.
  5241             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5242                 24  AM-AGT-SV             PIC X(10).
  5243                 24  AM-COM-TYP-SV         PIC X.
  5244                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5245                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5246                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5247                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5248                 24  FILLER                PIC X.
  5249                 24  AM-GL-CODES-SV        PIC X.
  5250                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5251                 24  FILLER                PIC X.
  5252         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5253             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 100
* EL640.cbl
  5254                 24  FILLER                PIC X(11).
  5255                 24  AM-L-COMA-SV          PIC XXX.
  5256                 24  AM-J-COMA-SV          PIC XXX.
  5257                 24  AM-A-COMA-SV          PIC XXX.
  5258                 24  FILLER                PIC X(6).
  5259
  5260     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5261         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5262            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5263            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5264            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5265
  5266     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5267     12  FILLER                            PIC X(120).
  5268
  5269     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5270         16  AM-CONTROL-NAME               PIC X(30).
  5271         16  AM-EXECUTIVE-ONE.
  5272             20  AM-EXEC1-NAME             PIC X(15).
  5273             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5274                                                          COMP-3.
  5275             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5276                                                          COMP-3.
  5277         16  AM-EXECUTIVE-TWO.
  5278             20  AM-EXEC2-NAME             PIC X(15).
  5279             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5280                                                          COMP-3.
  5281             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5282                                                          COMP-3.
  5283
  5284     12  AM-RETRO-ADDITIONAL-DATA.
  5285         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5286         16  AM-RETRO-PREM-P-E             PIC X.
  5287         16  AM-RETRO-CLMS-P-I             PIC X.
  5288         16  AM-RETRO-RET-BRACKET-LF.
  5289             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5290                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5291                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5292             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5293                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5294                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5295             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5296                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5297                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5298         16  AM-RETRO-RET-BRACKET-AH.
  5299             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5300                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5301                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5302                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5303             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5304                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5305                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5306             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5307                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5308                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5309
  5310     12  AM-COMMENTS.
  5311         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 101
* EL640.cbl
  5312
  5313     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5314         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5315         16  AM-FLI-BILLING-CODE           PIC X.
  5316         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5317         16  AM-FLI-UNITED-IDENT           PIC X.
  5318         16  AM-FLI-INTEREST-LOST-DATA.
  5319             20  AM-FLI-BANK-NO            PIC X(5).
  5320             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5321             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5322             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5323         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5324             20  AM-FLI-AGT                PIC X(9).
  5325             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5326             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5327         16  FILLER                        PIC X(102).
  5328
  5329     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5330         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5331             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5332             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5333             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5334             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5335             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5336         16  FILLER                          PIC X(10).
  5337******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 102
* EL640.cbl
  5339*                            COPY ERCBILL.
  5340******************************************************************
  5341*                                                                *
  5342*                                                                *
  5343*                            ERCBILL                             *
  5344*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5345*                            VMOD=2.007                          *
  5346*                                                                *
  5347*   FILE DESCRIPTION = BILLING STATEMENTS FOR PRINTING           *
  5348*                                                                *
  5349*   FILE TYPE = VSAM,KSDS                                        *
  5350*   RECORD SIZE = 210  RECFORM = FIXED                           *
  5351*                                                                *
  5352*   BASE CLUSTER = ERBILL                        RKP=2,LEN=31    *
  5353*                                                                *
  5354*   LOG = NO                                                     *
  5355*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5356******************************************************************
  5357 01  BILLING-STATEMENT.
  5358     02 BILLING-STATEMENT-FILE.
  5359     12  BI-RECORD-ID                PIC XX.
  5360         88  VALID-BI-ID                VALUE 'BI'.
  5361
  5362     12  BI-CONTROL-PRIMARY.
  5363         16  BI-COMPANY-CD           PIC X.
  5364         16  BI-CARRIER              PIC X.
  5365         16  BI-GROUPING             PIC X(6).
  5366         16  BI-ACCOUNT              PIC X(10).
  5367         16  BI-FIN-RESP             PIC X(10).
  5368         16  BI-RECORD-TYPE          PIC X.
  5369             88  BI-HEADER-DATA         VALUE '1'.
  5370             88  BI-ADDRESS-DATA        VALUE '2'.
  5371             88  BI-TEXT-DATA           VALUE '3'.
  5372         16  BI-LINE-SEQ-NO          PIC S9(4)     COMP.
  5373
  5374     12  BI-TEXT-RECORD.
  5375         16  BI-SKIP-CONTROL         PIC X.
  5376         16  BI-TEXT-LINE            PIC X(157).
  5377         16  BI-TEXT-LINE-1 REDEFINES BI-TEXT-LINE.
  5378             20  BI-ADDR-LIT         PIC X(14).
  5379             20  BI-CO               PIC X(7).
  5380             20  BI-DASH             PIC X.
  5381             20  BI-ACCT             PIC X(10).
  5382             20  FILLER              PIC XX.
  5383             20  BI-ACCT-ADDR        PIC X(30).
  5384             20  FILLER              PIC X.
  5385             20  BI-REMIT-LIT        PIC X(11).
  5386             20  FILLER              PIC XX.
  5387             20  BI-REMIT-ADDR       PIC X(30).
  5388             20  FILLER              PIC X(49).
  5389         16  BI-TEXT-LINE-2 REDEFINES BI-TEXT-LINE.
  5390             20  BI-INS-LAST-NAME    PIC X(15).
  5391             20  FILLER              PIC X.
  5392             20  BI-INS-1ST-NAME     PIC X(10).
  5393             20  FILLER REDEFINES BI-INS-1ST-NAME.
  5394                 24  BI-INS-INITS    PIC XX.
  5395                 24  FILLER          PIC X(8).
  5396             20  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 103
* EL640.cbl
  5397             20  BI-UNDRWRTR.
  5398                 24  BI-INS-INIT     PIC X.
  5399                 24  FILLER          PIC XXX.
  5400             20  BI-CERT             PIC X(11).
  5401             20  FILLER              PIC XX.
  5402             20  BI-EFF-DT           PIC X(8).
  5403             20  FILLER              PIC XX.
  5404             20  BI-CAN-DT           PIC X(8).
  5405             20  FILLER              PIC XX.
  5406             20  BI-ED-TERM          PIC ZZZ.
  5407             20  FILLER              PIC XX.
  5408             20  BI-TYPE             PIC XXXX.
  5409             20  FILLER              PIC X.
  5410             20  BI-PREM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5411             20  FILLER              PIC X(3).
  5412             20  BI-ED-RATE          PIC ZZZ.ZZZ.
  5413             20  FILLER              PIC XX.
  5414             20  BI-COMM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5415             20  FILLER              PIC XX.
  5416             20  BI-FACE-AMT         PIC ZZZ,ZZZ,ZZZ.ZZ-.
  5417             20  FILLER              PIC X(26).
  5418         16  BI-TEXT-LINE-3 REDEFINES BI-TEXT-LINE.
  5419             20  FILLER              PIC X(42).
  5420             20  BI-TOT-DESC         PIC X(20).
  5421             20  FILLER REDEFINES BI-TOT-DESC.
  5422                 24  BI-TOT-LIT      PIC X(6).
  5423                 24  BI-OVERRIDE-L6  PIC X(14).
  5424             20  FILLER              PIC X(11).
  5425             20  BI-TOT-PREM         PIC ZZZ,ZZZ,ZZZ.99-.
  5426             20  BI-TOT-DASH REDEFINES
  5427                 BI-TOT-PREM         PIC X(15).
  5428             20  FILLER              PIC X(11).
  5429             20  BI-COM-TOT          PIC ZZZ,ZZZ,ZZZ.99-.
  5430             20  FILLER              PIC XX.
  5431             20  BI-FACE-TOT         PIC ZZZ,ZZZ,ZZZ.99-.
  5432             20  FILLER              PIC X(26).
  5433         16  BI-TEXT-LINE-4 REDEFINES BI-TEXT-LINE.
  5434             20  BI-ENTRY-DESC       PIC X(30).
  5435             20  FILLER              PIC X(11).
  5436             20  BI-ENTRY-AMT        PIC ZZZZ,ZZZ,ZZZ.99-.
  5437             20  FILLER              PIC X(31).
  5438             20  BI-ACCTG-COMMENT    PIC X(30).
  5439             20  FILLER              PIC X(39).
  5440         16  BI-TEXT-LINE-5 REDEFINES BI-TEXT-LINE.
  5441             20  FILLER              PIC X(42).
  5442             20  BI-TOT-DESC5        PIC X(20).
  5443             20  FILLER              PIC X(11).
  5444             20  BI-TOT-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5445             20  BI-COM-TOT5         PIC ZZZ,ZZZ,ZZZ.99-.
  5446             20  BI-NON-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5447             20  BI-NON-COMM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5448             20  FILLER              PIC X(24).
  5449         16  BI-TEXT-FIRST REDEFINES BI-TEXT-LINE.
  5450             20  BI-TEXT-2-81        PIC X(80).
  5451             20  FILLER              PIC X(77).
  5452         16  BI-TEXT-LAST REDEFINES BI-TEXT-LINE.
  5453             20  FILLER              PIC X(53).
  5454             20  BI-TEXT-55-133      PIC X(79).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 104
* EL640.cbl
  5455             20  FILLER              PIC X(25).
  5456         16  BI-TEXT-TYPE            PIC X.
  5457             88 DETAIL-LINE              VALUE 'D'.
  5458         16  BI-TERM                 PIC S999.
  5459         16  BI-BENEFIT-AMT          PIC S9(9)V99 COMP-3.
  5460         16  BI-PREMIUM-AMT          PIC S9(7)V99 COMP-3.
  5461         16  BI-RATE                 PIC S99V9(5) COMP-3.
  5462
  5463     12  BI-ADDRESS-RECORD  REDEFINES  BI-TEXT-RECORD.
  5464         16  FILLER                  PIC X.
  5465         16  BI-ACCT-ADDRESS-LINE    PIC X(30).
  5466         16  FILLER                  PIC X(10).
  5467         16  BI-REMIT-ADDRESS-LINE   PIC X(30).
  5468         16  FILLER                  PIC X(106).
  5469
  5470     12  BI-HEADER-RECORD  REDEFINES  BI-TEXT-RECORD.
  5471         16  BI-PROCESSOR-CD         PIC X(4).
  5472         16  BI-STATEMENT-TYPE       PIC X.
  5473             88  BI-PREVIEW-ONLY         VALUE 'P'.
  5474         16  BI-NO-OF-COPIES         PIC S9.
  5475         16  BI-CREATION-DT          PIC XX.
  5476         16  BI-INITIAL-PRINT-DATE   PIC XX.
  5477         16  BI-ACCOUNT-TOTALS.
  5478             20  BI-BAL-FRWD         PIC S9(9)V99     COMP-3.
  5479             20  BI-PREMIUM          PIC S9(9)V99     COMP-3.
  5480             20  BI-REMITTED         PIC S9(9)V99     COMP-3.
  5481             20  BI-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5482             20  BI-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5483             20  BI-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5484             20  BI-DISBURSED        PIC S9(9)V99     COMP-3.
  5485             20  BI-END-BAL          PIC S9(9)V99     COMP-3.
  5486         16  BI-FIN-RESP-ACCT        PIC X(10).
  5487         16  BI-FIN-RESP-NAME        PIC X(30).
  5488         16  FILLER                  PIC X(79).
  5489
  5490
  5491     02 GA-BILLING-STATEMENT REDEFINES BILLING-STATEMENT-FILE.
  5492     12  FILLER                      PIC XX.
  5493
  5494     12  GA-CONTROL-PRIMARY.
  5495         16  FILLER                  PIC X(31).
  5496
  5497     12  GA-TEXT-RECORD.
  5498         16  GA-SKIP-CONTROL         PIC X.
  5499         16  GA-TEXT-LINE            PIC X(132).
  5500         16  GA-TEXT-LINE-1 REDEFINES GA-TEXT-LINE.
  5501             20  FILLER              PIC X.
  5502             20  GA-CARRIER          PIC X.
  5503             20  GA-GROUPING         PIC X(6).
  5504             20  GA-DASH             PIC X.
  5505             20  GA-AGENT            PIC X(10).
  5506             20  FILLER              PIC X.
  5507             20  GA-AGENT-ADDR       PIC X(30).
  5508             20  FILLER              PIC X(82).
  5509         16  GA-TEXT-LINE-2 REDEFINES GA-TEXT-LINE.
  5510             20  GA-ACCT             PIC X(10).
  5511             20  FILLER              PIC X.
  5512             20  GA-ACCT-NAME        PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 105
* EL640.cbl
  5513             20  GA-BEG-BAL          PIC ZZZZ,ZZZ.99-.
  5514             20  GA-NET-PREM         PIC ZZZZ,ZZZ.ZZ-.
  5515             20  GA-ACCT-COMP        PIC ZZZZ,ZZZ.ZZ-.
  5516             20  GA-PMTS-ADJS        PIC ZZZZ,ZZZ.ZZ-.
  5517             20  GA-UNPAID-NET-PREM  PIC ZZZZ,ZZZ.ZZ-.
  5518             20  GA-BEN-OVERRIDE-L6  PIC X(6).
  5519             20  FILLER              PIC X.
  5520             20  GA-OVERWRITE        PIC ZZZZ,ZZZ.ZZ-.
  5521             20  GA-AMT-DUE          PIC ZZZ,ZZZ.99-.
  5522             20  FILLER              PIC X.
  5523         16  GA-TEXT-LINE-3 REDEFINES GA-TEXT-LINE.
  5524             20  FILLER              PIC X(11).
  5525             20  GA-ENTRY-DESC       PIC X(30).
  5526             20  FILLER              PIC X(60).
  5527             20  GA-ENTRY-COMMENT    PIC X(30).
  5528             20  FILLER              PIC X.
  5529         16  FILLER.
  5530             20  GA-BENEFIT-CD       PIC XX.
  5531             20  GA-BEG-BAL-AMT      PIC S9(7)V99 COMP-3.
  5532             20  GA-END-BAL-AMT      PIC S9(7)V99 COMP-3.
  5533             20  GA-NET-PREM-AMT     PIC S9(7)V99 COMP-3.
  5534             20  GA-ACCT-COMP-AMT    PIC S9(7)V99 COMP-3.
  5535             20  GA-PMTS-ADJS-AMT    PIC S9(7)V99 COMP-3.
  5536             20  GA-UNPAID-NET-AMT   PIC S9(7)V99 COMP-3.
  5537             20  GA-OVERWRITE-AMT    PIC S9(7)V99 COMP-3.
  5538             20  GA-AMT-DUE-AMT      PIC S9(7)V99 COMP-3.
  5539
  5540     12  GA-ADDRESS-RECORD  REDEFINES  GA-TEXT-RECORD.
  5541         16  FILLER                  PIC X.
  5542         16  GA-ACCT-ADDRESS-LINE    PIC X(30).
  5543         16  FILLER                  PIC X(144).
  5544
  5545     12  GA-HEADER-RECORD  REDEFINES  GA-TEXT-RECORD.
  5546         16  GA-PROCESSOR-CD         PIC X(4).
  5547         16  GA-STATEMENT-TYPE       PIC X.
  5548             88  GA-PREVIEW-ONLY         VALUE 'P'.
  5549         16  GA-NO-OF-COPIES         PIC S9.
  5550         16  GA-CREATION-DT          PIC XX.
  5551         16  GA-INITIAL-PRINT-DATE   PIC XX.
  5552         16  GA-AGENT-TOTALS.
  5553             20  GA-NET-UNPD         PIC S9(9)V99     COMP-3.
  5554             20  GA-COMP-UNPD-PREM   PIC S9(9)V99     COMP-3.
  5555             20  GA-PREMIUM          PIC S9(9)V99     COMP-3.
  5556             20  GA-REMITTED         PIC S9(9)V99     COMP-3.
  5557             20  GA-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5558             20  GA-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5559             20  GA-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5560             20  GA-DISBURSED        PIC S9(9)V99     COMP-3.
  5561             20  GA-END-BALANCE      PIC S9(9)V99     COMP-3.
  5562         16  GA-AGENTS-NAME          PIC X(30).
  5563         16  FILLER                  PIC X(81).
  5564     12  FILLER                      PIC XX.
  5565
  5566
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 106
* EL640.cbl
  5568*                            COPY ELCTEXT.
  5569******************************************************************
  5570*                                                                *
  5571*                                                                *
  5572*                            ELCTEXT.                            *
  5573*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5574*                            VMOD=2.008                          *
  5575*                                                                *
  5576*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  5577*                                     FORM LETTERS,              *
  5578*                                     CERT FORM DISPLAY.
  5579*                                                                *
  5580*   FILE TYPE = VSAM,KSDS                                        *
  5581*   RECORD SIZE = 100   RECFORM = FIXED                          *
  5582*                                                                *
  5583*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  5584*       ALTERNATE INDEX = NONE                                   *
  5585*                                                                *
  5586*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  5587*       ALTERNATE INDEX = NONE                                   *
  5588*                                                                *
  5589*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  5590*       ALTERNATE INDEX = NONE                                   *
  5591*                                                                *
  5592*   LOG = NO                                                     *
  5593*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5594******************************************************************
  5595 01  TEXT-FILES.
  5596     12  TEXT-FILE-ID                PIC XX.
  5597         88  FORMS-FILE-TEXT            VALUE 'TF'.
  5598         88  LETTER-FILE-TEXT           VALUE 'TL'.
  5599         88  HELP-FILE-TEXT             VALUE 'TH'.
  5600
  5601     12  TX-CONTROL-PRIMARY.
  5602         16  TX-COMPANY-CD           PIC X.
  5603             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  5604         16  TX-ACCESS-CD-GENL       PIC X(12).
  5605
  5606         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5607             20  TX-LETTER-NO        PIC X(4).
  5608             20  FILLER              PIC X(8).
  5609
  5610         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5611             20  TX-FORM-NO          PIC X(12).
  5612
  5613         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5614             20  TX-HELP-TYPE        PIC X.
  5615                 88  HELP-FOR-GENERAL   VALUE ' '.
  5616                 88  HELP-BY-SCREEN     VALUE 'S'.
  5617                 88  HELP-BY-ERROR      VALUE 'E'.
  5618             20  TX-SCREEN-OR-ERROR  PIC X(4).
  5619                 88  GENERAL-INFO-HELP  VALUE '0000'.
  5620             20  TX-HELP-FOR-COMPANY  PIC XXX.
  5621                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  5622             20  FILLER              PIC X(4).
  5623
  5624         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  5625
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 107
* EL640.cbl
  5626     12  TX-PROCESS-CONTROL          PIC XX.
  5627         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  5628
  5629     12  TX-TEXT-LINE                PIC X(70).
  5630
  5631     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  5632         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  5633         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  5634         88  TX-VALID-FORM-SQUEEZE-VALUE
  5635                                        VALUE 'Y' ' '.
  5636
  5637     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  5638         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  5639         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  5640         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  5641         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  5642         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  5643         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  5644         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  5645                                              'K' 'N' ' '
  5646                                              'Z'.
  5647
  5648     12  TX-ARCHIVE-SW               PIC X.
  5649         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  5650         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  5651         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  5652
  5653     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  5654     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  5655
  5656     12  TX-BSR-CODE                 PIC X.
  5657         88  TX-BSR-LETTER              VALUE 'B'.
  5658         88  TX-NON-BSR-LETTER          VALUE ' '.
  5659
  5660     12  FILLER                      PIC X.
  5661*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 108
* EL640.cbl
  5663
  5664 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  5665                          CONTROL-FILE COMPENSATION-MASTER
  5666                          PENDING-PAY-ADJ ACCOUNT-MASTER
  5667                          BILLING-STATEMENT TEXT-FILES.
  5668 0000-DFHEXIT SECTION.
  5669     MOVE '9#                    $   ' TO DFHEIV0.
  5670     MOVE 'EL640' TO DFHEIV1.
  5671     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5672
  5673     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5674     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  5675     MOVE EIBTRMID               TO QID-TERM.
  5676     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  5677     MOVE '5'                    TO DC-OPTION-CODE.
  5678     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  5679     MOVE DC-BIN-DATE-1          TO WS-CURRENT-DATE.
  5680     MOVE DC-GREG-DATE-1-MDY     TO WS-CURRENT-DATE-MDY.
  5681     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DATE-EDIT.
  5682
  5683     IF EIBCALEN = 0
  5684         GO TO 8800-UNAUTHORIZED-ACCESS.
  5685
  5686     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5687         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  5688
  5689     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5690         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5691             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5692             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5693             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5694             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5695             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5696             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5697             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5698             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5699             MOVE PI-CR-CONTROL-IN-PROGRESS TO W-TRANSFER-CONTROL
  5700             MOVE SPACES          TO PI-CR-CONTROL-IN-PROGRESS
  5701         ELSE
  5702             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  5703             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  5704             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  5705             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  5706             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  5707             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  5708             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  5709             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  5710
  5711     MOVE LOW-VALUES             TO EL640AI.
  5712
  5713     IF PI-AR-PROCESSING
  5714        MOVE XCTL-635            TO XCTL-PYAJ.
  5715
  5716     IF PI-COMPANY-ID = 'DMD'
  5717        MOVE XCTL-633DMD         TO XCTL-PYAJ.
  5718
  5719     IF RETURNED-FROM NOT = SPACES
  5720         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 109
* EL640.cbl
  5721         IF RETURNED-FROM = XCTL-PYAJ AND NOT PI-VOID-BILL
  5722             MOVE ZEROS          TO PI-ADJUSTMENTS
  5723                                    PI-DISBURSED
  5724                                    PI-REMITTED
  5725             GO TO 1100-PYAJ-BILLING-PROCESS
  5726         ELSE
  5727             MOVE -1             TO APFNTERL
  5728             PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT
  5729             GO TO 8100-SEND-INITIAL-MAP.
  5730
  5731     IF EIBTRNID NOT = TRANS-ID
  5732         PERFORM 0400-CLEAR-PI  THRU  0499-EXIT
  5733         MOVE EL640A             TO PI-MAP-NAME
  5734         MOVE -1                 TO APFNTERL
  5735         GO TO 8100-SEND-INITIAL-MAP.
  5736
  5737
  5738* EXEC CICS HANDLE CONDITION
  5739*        PGMIDERR  (9600-PGMID-ERROR)
  5740*        ERROR     (9990-ABEND)
  5741*    END-EXEC.
  5742*    MOVE '"$L.                  ! " #00005733' TO DFHEIV0
  5743     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5744     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5745     MOVE X'2220233030303035373333' TO DFHEIV0(25:11)
  5746     CALL 'kxdfhei1' USING DFHEIV0
  5747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5748
  5749
  5750     IF EIBAID = DFHCLEAR
  5751         IF PI-MAP-NAME = EL640B
  5752             PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT
  5753             MOVE EL640A         TO PI-MAP-NAME
  5754             MOVE -1             TO APFNTERL
  5755             GO TO 8100-SEND-INITIAL-MAP
  5756         ELSE
  5757             GO TO 9400-CLEAR.
  5758
  5759     IF PI-PROCESSOR-ID = 'LGXX'
  5760         GO TO 0200-RECEIVE.
  5761
  5762
  5763* EXEC CICS READQ TS
  5764*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5765*        INTO   (SECURITY-CONTROL)
  5766*        LENGTH (SC-COMM-LENGTH)
  5767*        ITEM   (SC-ITEM)
  5768*    END-EXEC.
  5769*    MOVE '*$II   L              ''   #00005750' TO DFHEIV0
  5770     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5771     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5772     MOVE X'2020233030303035373530' TO DFHEIV0(25:11)
  5773     CALL 'kxdfhei1' USING DFHEIV0,
  5774           PI-SECURITY-TEMP-STORE-ID,
  5775           SECURITY-CONTROL,
  5776           SC-COMM-LENGTH,
  5777           SC-ITEM,
  5778           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 110
* EL640.cbl
  5779           DFHEIV99
  5780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5781
  5782
  5783     MOVE SC-CREDIT-DISPLAY (18)  TO PI-DISPLAY-CAP.
  5784     MOVE SC-CREDIT-UPDATE  (18)  TO PI-MODIFY-CAP.
  5785
  5786     IF NOT DISPLAY-CAP
  5787         MOVE 'READ'          TO SM-READ
  5788         PERFORM 9995-SECURITY-VIOLATION
  5789         MOVE ER-0070         TO  EMI-ERROR
  5790         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5791         GO TO 8100-SEND-INITIAL-MAP.
  5792
  5793 0200-RECEIVE.
  5794     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5795         MOVE ER-0008            TO EMI-ERROR
  5796         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5797         IF PI-MAP-NAME = EL640A
  5798             MOVE -1             TO APFNTERL
  5799             GO TO 8200-SEND-DATAONLY
  5800         ELSE
  5801             MOVE -1             TO BPFNTERL
  5802             GO TO 8200-SEND-DATAONLY.
  5803
  5804
  5805* EXEC CICS RECEIVE
  5806*        MAP      (PI-MAP-NAME)
  5807*        MAPSET   (MAPSET-NAME)
  5808*        INTO     (EL640AI)
  5809*    END-EXEC.
  5810     MOVE LENGTH OF
  5811      EL640AI
  5812       TO DFHEIV11
  5813*    MOVE '8"T I  L              ''   #00005778' TO DFHEIV0
  5814     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5815     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5816     MOVE X'2020233030303035373738' TO DFHEIV0(25:11)
  5817     CALL 'kxdfhei1' USING DFHEIV0,
  5818           PI-MAP-NAME,
  5819           EL640AI,
  5820           DFHEIV11,
  5821           MAPSET-NAME,
  5822           DFHEIV99,
  5823           DFHEIV99
  5824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5825
  5826
  5827     IF PI-END-BAL NOT NUMERIC
  5828         MOVE ZEROS              TO PI-END-BAL.
  5829
  5830     IF PI-MAP-NAME = EL640A
  5831         IF APFNTERL > ZERO
  5832             IF EIBAID NOT = DFHENTER
  5833                 MOVE ER-0004    TO EMI-ERROR
  5834                 MOVE AL-UNBOF   TO APFNTERA
  5835                 MOVE -1         TO APFNTERL
  5836                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 111
* EL640.cbl
  5837                 GO TO 8200-SEND-DATAONLY
  5838             ELSE
  5839                 IF APFNTERI NUMERIC AND
  5840                   (APFNTERI > 0 AND < 25)
  5841                     MOVE PF-VALUES (APFNTERI) TO EIBAID
  5842                 ELSE
  5843                     MOVE ER-0029  TO EMI-ERROR
  5844                     MOVE AL-UNBOF TO APFNTERA
  5845                     MOVE -1       TO APFNTERL
  5846                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5847                     GO TO 8200-SEND-DATAONLY
  5848         ELSE
  5849             NEXT SENTENCE
  5850     ELSE
  5851     IF PI-MAP-NAME = EL640B
  5852         IF BPFNTERL > ZERO
  5853             IF EIBAID NOT = DFHENTER
  5854                 MOVE ER-0004    TO EMI-ERROR
  5855                 MOVE AL-UNBOF   TO BPFNTERA
  5856                 MOVE -1         TO BPFNTERL
  5857                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5858                 GO TO 8200-SEND-DATAONLY
  5859             ELSE
  5860                 IF BPFNTERI NUMERIC AND
  5861                   (BPFNTERI > 0 AND < 25)
  5862                     MOVE PF-VALUES (BPFNTERI) TO EIBAID
  5863                 ELSE
  5864                     MOVE ER-0029  TO EMI-ERROR
  5865                     MOVE AL-UNBOF TO BPFNTERA
  5866                     MOVE -1       TO BPFNTERL
  5867                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5868                     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 112
* EL640.cbl
  5870 0300-CHECK-PFKEYS.
  5871     IF EIBAID = DFHPF23
  5872         GO TO 8810-PF23.
  5873
  5874     IF EIBAID = DFHPF24
  5875         GO TO 9200-RETURN-MAIN-MENU.
  5876
  5877     IF EIBAID = DFHPF12
  5878         GO TO 9500-PF12.
  5879
  5880******************************************************************
  5881*       IF CARRIER OR ACCOUNT SECURITY ALLOW ONLY                *
  5882*            BILLING TYPE OPTION ONE OR TWO.                     *
  5883*                        04/27/84                                *
  5884******************************************************************
  5885
  5886     IF PI-NO-CARRIER-SECURITY OR
  5887        PI-NO-ACCOUNT-SECURITY
  5888          GO TO 0305-CHECK-PFKEYS.
  5889
  5890     IF EIBAID = DFHENTER OR DFHPF6
  5891        NEXT SENTENCE
  5892       ELSE
  5893        GO TO 0320-INPUT-ERROR.
  5894
  5895 0305-CHECK-PFKEYS.
  5896     IF EIBAID = DFHPF3
  5897       AND PI-MAP-NAME = EL640A
  5898         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5899         MOVE PI-CARRIER         TO PI-CR-CARRIER
  5900         MOVE PI-GROUPING        TO PI-CR-GROUPING
  5901         MOVE PI-STATE           TO PI-CR-STATE
  5902         MOVE PI-ACCOUNT         TO PI-CR-ACCOUNT
  5903         MOVE XCTL-650           TO PGM-NAME
  5904         GO TO 9300-XCTL.
  5905
  5906     IF EIBAID = DFHPF4
  5907       AND PI-MAP-NAME = EL640A
  5908        NEXT SENTENCE
  5909     ELSE
  5910        GO TO 0320-CONT-PFKEYS.
  5911
  5912     IF PI-CR-FIN-RESP NOT = SPACES
  5913         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5914         MOVE PI-COMP-CARRIER    TO PI-CR-CARRIER
  5915         MOVE PI-COMP-GROUPING   TO PI-CR-GROUPING
  5916         MOVE PI-COMP-FIN-RESP   TO PI-CR-FIN-RESP
  5917         MOVE XCTL-652           TO PGM-NAME
  5918         GO TO 9300-XCTL.
  5919
  5920     IF PI-SCR-FIN-RESP = SPACES OR LOW-VALUES
  5921         GO TO 0315-PF4-ERROR.
  5922
  5923     PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT.
  5924
  5925     MOVE PI-SCR-CARRIER    TO PI-CR-CARRIER.
  5926     MOVE PI-SCR-GROUPING   TO PI-CR-GROUPING.
  5927     MOVE PI-SCR-FIN-RESP   TO PI-CR-FIN-RESP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 113
* EL640.cbl
  5928     MOVE PI-SCR-ACCOUNT    TO PI-CR-ACCOUNT.
  5929     MOVE PI-SCR-TYPE       TO PI-CR-TYPE.
  5930     MOVE 'Y'               TO PI-TRANSFER-SW.
  5931
  5932     IF PI-ZERO-CARRIER  OR
  5933        PI-ZERO-CAR-GROUP
  5934         MOVE ZEROS              TO PI-CR-CARRIER.
  5935
  5936     IF PI-ZERO-GROUPING  OR
  5937        PI-ZERO-CAR-GROUP
  5938         MOVE ZEROS              TO PI-CR-GROUPING.
  5939
  5940     MOVE XCTL-652               TO PGM-NAME.
  5941
  5942     GO TO 9300-XCTL.
  5943
  5944 0315-PF4-ERROR.
  5945
  5946     MOVE ER-2407                TO EMI-ERROR.
  5947     MOVE -1                     TO APFNTERL.
  5948     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5949     GO TO 8200-SEND-DATAONLY.
  5950
  5951 0320-CONT-PFKEYS.
  5952     IF EIBAID = DFHPF6
  5953       AND PI-MAP-NAME = EL640A
  5954         MOVE LOW-VALUES         TO EL640AO
  5955         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5956         MOVE XCTL-6401          TO PGM-NAME
  5957         GO TO 9300-XCTL.
  5958
  5959     IF EIBAID = DFHPF7
  5960       AND PI-MAP-NAME = EL640A
  5961         IF PI-CR-FIN-RESP NOT = SPACES
  5962             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5963             MOVE PI-COMP-CARRIER    TO PI-CR-CARRIER
  5964             MOVE PI-COMP-GROUPING   TO PI-CR-GROUPING
  5965             MOVE PI-COMP-FIN-RESP   TO PI-CR-FIN-RESP
  5966             MOVE XCTL-PYAJ          TO PGM-NAME
  5967             GO TO 9300-XCTL
  5968         ELSE
  5969             IF PI-RETURN-TO-PROGRAM = XCTL-633 OR XCTL-635 OR
  5970                                       XCTL-633DMD
  5971                 GO TO 9400-CLEAR
  5972             ELSE
  5973                 MOVE ER-2411        TO EMI-ERROR
  5974                 MOVE -1             TO APFNTERL
  5975                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5976                 GO TO 8200-SEND-DATAONLY.
  5977
  5978     IF EIBAID = DFHPF8
  5979       AND PI-MAP-NAME = EL640A
  5980           PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5981           MOVE SPACES         TO PI-CR-CONTROL-IN-PROGRESS
  5982           MOVE XCTL-658       TO PGM-NAME
  5983           GO TO 9300-XCTL.
  5984
  5985     IF EIBAID = DFHPF1
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 114
* EL640.cbl
  5986       AND PI-MAP-NAME = EL640B
  5987         GO TO 7500-PRODUCE-CHECK.
  5988
  5989     IF EIBAID = DFHPF5
  5990       AND PI-AR-PROCESSING
  5991         MOVE ER-3188            TO EMI-ERROR
  5992         MOVE -1                 TO APFNTERL
  5993         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5994         GO TO 8200-SEND-DATAONLY.
  5995
  5996     IF PI-COMPANY-ID = 'DMD'
  5997       IF EIBAID = DFHPF5
  5998         GO TO 0320-INPUT-ERROR.
  5999
  6000     IF EIBAID = DFHPF5
  6001       AND PI-MAP-NAME = EL640A
  6002            MOVE EL640B     TO PI-MAP-NAME
  6003            GO TO 7000-PROCESS-CHECK.
  6004
  6005     IF PI-MAP-NAME = EL640A
  6006         IF EIBAID = DFHENTER OR DFHPF3
  6007             GO TO 0330-EDIT-DATA
  6008         ELSE
  6009             GO TO 0320-INPUT-ERROR
  6010     ELSE
  6011         IF PI-MAP-NAME = EL640B
  6012             IF EIBAID = DFHENTER
  6013
  6014* EXEC CICS BIF DEEDIT
  6015*                    FIELD  (BCHKAMTI)
  6016*                    LENGTH (11)
  6017*                END-EXEC
  6018     MOVE 11
  6019       TO DFHEIV11
  6020*    MOVE '@"L                   #   #00005970' TO DFHEIV0
  6021     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6022     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6023     MOVE X'2020233030303035393730' TO DFHEIV0(25:11)
  6024     CALL 'kxdfhei1' USING DFHEIV0,
  6025           BCHKAMTI,
  6026           DFHEIV11
  6027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6028                 MOVE BCHKAMTI   TO  WORK-CHECK-AMT
  6029                 MOVE 'B'        TO  WS-ENTERED-FROM-MAP
  6030                 GO TO 7000-PROCESS-CHECK.
  6031
  6032 0320-INPUT-ERROR.
  6033     MOVE ER-0029                TO EMI-ERROR.
  6034     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6035
  6036     IF PI-MAP-NAME = EL640A
  6037         MOVE AL-UNBON           TO APFNTERA
  6038         MOVE -1                 TO APFNTERL
  6039     ELSE
  6040         MOVE AL-UNBON           TO BPFNTERA
  6041         MOVE -1                 TO BPFNTERL.
  6042
  6043     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 115
* EL640.cbl
  6044
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 116
* EL640.cbl
  6046 0330-EDIT-DATA.
  6047     MOVE ABILTYPI               TO VALID-BILL-TYPE-VALUES.
  6048
  6049     IF VALID-BILL-TYPE
  6050        IF NOT MODIFY-CAP
  6051           IF ABILTYPI = '1' OR '2'
  6052              NEXT SENTENCE
  6053           ELSE
  6054              MOVE 'UPDATE'         TO SM-READ
  6055              PERFORM 9995-SECURITY-VIOLATION
  6056              MOVE ER-0070          TO EMI-ERROR
  6057              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6058              GO TO 8100-SEND-INITIAL-MAP.
  6059
  6060     MOVE SPACES                 TO PI-BILLING-COUNTS
  6061                                    PI-LIMIT-BILLING-BTCHS.
  6062
  6063******************************************************************
  6064*         SECURITY CHECK FOR CARRIER AND ACCOUNT.                *
  6065*                     04/12/84                                   *
  6066******************************************************************
  6067
  6068     IF PI-CARRIER-SECURITY > SPACES
  6069        IF ACARIERL > ZEROS
  6070            IF PI-CARRIER-SECURITY = ACARIERI
  6071                MOVE AL-UANON    TO ACARIERA
  6072            ELSE
  6073                MOVE -1          TO ACARIERL
  6074                MOVE AL-UABON    TO ACARIERA
  6075                MOVE ER-2370     TO EMI-ERROR
  6076                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6077
  6078 350-ERROR-CHECK.
  6079     IF EMI-ERROR = ZEROS
  6080         NEXT SENTENCE
  6081     ELSE
  6082         GO TO 8200-SEND-DATAONLY.
  6083
  6084     IF AACCTL > ZEROS
  6085         MOVE AL-UANON           TO AACCTA
  6086         MOVE AACCTI             TO PI-SAV-ACCT
  6087                                    PI-CR-ACCOUNT
  6088     ELSE
  6089         MOVE -1                 TO AACCTL
  6090         MOVE AL-UABON           TO AACCTA
  6091         MOVE ER-0197            TO EMI-ERROR
  6092         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6093
  6094     IF ACARIERL > ZEROS
  6095         MOVE AL-UANON           TO ACARIERA
  6096         MOVE ACARIERI           TO PI-SAV-CARR
  6097                                    WS-CARRIER
  6098     ELSE
  6099         IF NOT ST-ACCNT-CNTL AND NOT ACCNT-CNTL
  6100             MOVE -1             TO ACARIERL
  6101             MOVE AL-UABON       TO ACARIERA
  6102             MOVE ER-0194        TO EMI-ERROR
  6103             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 117
* EL640.cbl
  6104
  6105     IF AGROUPL > ZEROS
  6106         MOVE AL-UANON           TO AGROUPA
  6107         MOVE AGROUPI            TO PI-SAV-GROUP
  6108                                    WS-COMP
  6109     ELSE
  6110         IF CARR-GROUP-ST-ACCNT-CNTL
  6111             MOVE -1             TO AGROUPL
  6112             MOVE AL-UABON       TO AGROUPA
  6113             MOVE ER-0195        TO EMI-ERROR
  6114             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6115
  6116     IF ASTATEL > ZEROS
  6117         MOVE AL-UANON           TO ASTATEA
  6118         MOVE ASTATEI            TO PI-SAV-STATE
  6119     ELSE
  6120         IF NOT ACCNT-CNTL AND NOT CARR-ACCNT-CNTL
  6121             MOVE -1             TO ASTATEL
  6122             MOVE AL-UABON       TO ASTATEA
  6123             MOVE ER-0196        TO EMI-ERROR
  6124             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6125
  6126     MOVE ABILTYPI               TO VALID-BILL-TYPE-VALUES.
  6127
  6128     IF VALID-BILL-TYPE
  6129         MOVE AL-UANON           TO ABILTYPA
  6130         MOVE ABILTYPI           TO PI-BILL-TYPE
  6131     ELSE
  6132         MOVE -1                 TO ABILTYPL
  6133         MOVE ER-2249            TO EMI-ERROR
  6134         MOVE AL-UABON           TO ABILTYPA
  6135         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6136
  6137     IF PI-AR-PROCESSING
  6138        IF PI-PREVIEW
  6139           NEXT SENTENCE
  6140        ELSE
  6141           MOVE -1               TO ABILTYPL
  6142           MOVE ER-3145          TO EMI-ERROR
  6143           MOVE AL-UABON         TO ABILTYPA
  6144           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6145
  6146     IF APRODSWL NOT = ZEROS
  6147         IF PI-PREVIEW
  6148             IF APRODSWI = 'Y' OR 'N'
  6149                 MOVE AL-UANON   TO APRODSWA
  6150             ELSE
  6151                 MOVE -1         TO APRODSWL
  6152                 MOVE ER-2436    TO EMI-ERROR
  6153                 MOVE AL-UABON   TO APRODSWA
  6154                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6155         ELSE
  6156             MOVE -1             TO APRODSWL
  6157             MOVE ER-2434        TO EMI-ERROR
  6158             MOVE AL-UABON       TO APRODSWA
  6159             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6160     ELSE
  6161         IF PI-PREVIEW
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 118
* EL640.cbl
  6162             MOVE -1             TO APRODSWL
  6163             MOVE ER-2435        TO EMI-ERROR
  6164             MOVE AL-UABON       TO APRODSWA
  6165             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6166
  6167     IF ABILERRI = 'Y' OR 'N'
  6168         MOVE ABILERRI           TO PI-BILL-ERRS
  6169         MOVE AL-UANON           TO ABILERRA
  6170     ELSE
  6171         IF NOT PI-VOID-BILL
  6172             MOVE -1             TO ABILERRL
  6173             MOVE ER-2250        TO EMI-ERROR
  6174             MOVE AL-UABON       TO ABILERRA
  6175             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6176
  6177     IF ABTCH1L NOT = ZEROS
  6178         MOVE AL-UANON           TO ABTCH1A
  6179         MOVE 'Y'                TO LIMIT-BILLING-SW
  6180         MOVE ABTCH1I            TO PI-BILLING-BATCHES (1).
  6181
  6182     IF ABTCH2L NOT = ZEROS
  6183         MOVE AL-UANON           TO ABTCH2A
  6184         MOVE 'Y'                TO LIMIT-BILLING-SW
  6185         MOVE ABTCH2I            TO PI-BILLING-BATCHES (2).
  6186
  6187     IF ABTCH3L NOT = ZEROS
  6188         MOVE AL-UANON           TO ABTCH3A
  6189         MOVE 'Y'                TO LIMIT-BILLING-SW
  6190         MOVE ABTCH3I            TO PI-BILLING-BATCHES (3).
  6191
  6192     IF EMI-ERROR = ZEROS
  6193         GO TO 1000-BILLING-PROCESS.
  6194
  6195     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 119
* EL640.cbl
  6197 0400-CLEAR-PI.
  6198     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  6199
  6200     MOVE ZEROS                  TO PI-BAL-FRWD-GA  PI-BAL-FRWD
  6201                                    PI-PREMIUM      PI-REMITTED
  6202                                    PI-TOT-ISS-COMP
  6203                                    PI-TOT-CAN-COMP
  6204                                    PI-ADJUSTMENTS  PI-DISBURSED
  6205                                    PI-END-BAL      PI-LF-ISS-COMP
  6206                                    PI-AH-ISS-COMP  PI-LF-CAN-COMP
  6207                                    PI-AH-CAN-COMP.
  6208
  6209     MOVE SPACES                 TO PI-BATCH (1)
  6210                                    PI-BATCH (2)
  6211                                    PI-BATCH (3)
  6212                                    PI-BATCH (4)
  6213                                    PI-BATCH (5)
  6214                                    PI-BATCH (6).
  6215
  6216     MOVE SPACES                 TO PI-BILLING-BATCHES (1)
  6217                                    PI-BILLING-BATCHES (2)
  6218                                    PI-BILLING-BATCHES (3).
  6219
  6220     MOVE ZEROS                  TO PI-BILLED (1) PI-PREV (1)
  6221                                    PI-NOBILL (1)
  6222                                    PI-PREM (1)   PI-COMM (1)
  6223                                    PI-NON-PREM (1)
  6224                                    PI-NON-COMM (1)
  6225                                    PI-BILLED (2) PI-PREV (2)
  6226                                    PI-NOBILL (2)
  6227                                    PI-PREM (2)   PI-COMM (2)
  6228                                    PI-NON-PREM (2)
  6229                                    PI-NON-COMM (2)
  6230                                    PI-BILLED (3) PI-PREV (3)
  6231                                    PI-NOBILL (3)
  6232                                    PI-PREM (3)   PI-COMM (3)
  6233                                    PI-NON-PREM (3)
  6234                                    PI-NON-COMM (3)
  6235                                    PI-BILLED (4) PI-PREV (4)
  6236                                    PI-NOBILL (4)
  6237                                    PI-PREM (4)   PI-COMM (4)
  6238                                    PI-NON-PREM (4)
  6239                                    PI-NON-COMM (4)
  6240                                    PI-BILLED (5) PI-PREV (5)
  6241                                    PI-NOBILL (5)
  6242                                    PI-PREM (5)   PI-COMM (5)
  6243                                    PI-NON-PREM (5)
  6244                                    PI-NON-COMM (5)
  6245                                    PI-BILLED (6) PI-PREV (6)
  6246                                    PI-NOBILL (6)
  6247                                    PI-PREM (6)   PI-COMM (6)
  6248                                    PI-NON-PREM (6)
  6249                                    PI-NON-COMM (6).
  6250
  6251 0499-EXIT.
  6252      EXIT.
  6253
  6254 0500-CREATE-TEMP-STORAGE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 120
* EL640.cbl
  6255
  6256     IF PI-BAL-FRWD NOT NUMERIC
  6257         MOVE ZEROS              TO PI-BAL-FRWD
  6258                                    PI-PREMIUM
  6259                                    PI-REMITTED
  6260                                    PI-TOT-ISS-COMP
  6261                                    PI-TOT-CAN-COMP
  6262                                    PI-ADJUSTMENTS
  6263                                    PI-DISBURSED
  6264                                    PI-END-BAL.
  6265
  6266
  6267* EXEC CICS WRITEQ TS
  6268*        QUEUE  (QID)
  6269*        FROM   (PROGRAM-INTERFACE-BLOCK)
  6270*        LENGTH (PI-COMM-LENGTH)
  6271*    END-EXEC.
  6272*    MOVE '*"                    ''   #00006212' TO DFHEIV0
  6273     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  6274     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6275     MOVE X'2020233030303036323132' TO DFHEIV0(25:11)
  6276     CALL 'kxdfhei1' USING DFHEIV0,
  6277           QID,
  6278           PROGRAM-INTERFACE-BLOCK,
  6279           PI-COMM-LENGTH,
  6280           DFHEIV99,
  6281           DFHEIV99,
  6282           DFHEIV99
  6283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6284
  6285
  6286 0590-EXIT.
  6287      EXIT.
  6288
  6289 0600-RECOVER-TEMP-STORAGE.
  6290
  6291* EXEC CICS READQ TS
  6292*        QUEUE  (QID)
  6293*        INTO   (PROGRAM-INTERFACE-BLOCK)
  6294*        LENGTH (PI-COMM-LENGTH)
  6295*    END-EXEC.
  6296*    MOVE '*$I    L              ''   #00006222' TO DFHEIV0
  6297     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  6298     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6299     MOVE X'2020233030303036323232' TO DFHEIV0(25:11)
  6300     CALL 'kxdfhei1' USING DFHEIV0,
  6301           QID,
  6302           PROGRAM-INTERFACE-BLOCK,
  6303           PI-COMM-LENGTH,
  6304           DFHEIV99,
  6305           DFHEIV99,
  6306           DFHEIV99
  6307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6308
  6309
  6310     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  6311
  6312     MOVE PI-CR-CARRIER    TO PI-SCR-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 121
* EL640.cbl
  6313     MOVE PI-CR-GROUPING   TO PI-SCR-GROUPING.
  6314     MOVE PI-CR-FIN-RESP   TO PI-SCR-FIN-RESP.
  6315     MOVE PI-CR-ACCOUNT    TO PI-SCR-ACCOUNT.
  6316     MOVE PI-CR-TYPE       TO PI-SCR-TYPE.
  6317
  6318     MOVE PI-SCRN-CONTROL TO W-TRANSFER-CONTROL.
  6319
  6320 0690-EXIT.
  6321      EXIT.
  6322
  6323 0800-DELETE-TS.
  6324
  6325* EXEC CICS HANDLE CONDITION
  6326*        QIDERR (0890-EXIT)
  6327*    END-EXEC.
  6328*    MOVE '"$N                   ! # #00006242' TO DFHEIV0
  6329     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  6330     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6331     MOVE X'2320233030303036323432' TO DFHEIV0(25:11)
  6332     CALL 'kxdfhei1' USING DFHEIV0
  6333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6334
  6335
  6336
  6337* EXEC CICS DELETEQ TS
  6338*        QUEUE  (QID)
  6339*    END-EXEC.
  6340*    MOVE '*&                    #   #00006246' TO DFHEIV0
  6341     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  6342     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6343     MOVE X'2020233030303036323436' TO DFHEIV0(25:11)
  6344     CALL 'kxdfhei1' USING DFHEIV0,
  6345           QID,
  6346           DFHEIV99
  6347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6348
  6349
  6350 0890-EXIT.
  6351      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 122
* EL640.cbl
  6353 1000-BILLING-PROCESS.
  6354*                *******************************************
  6355*                *  THIS SECTION PROCESSES THE PENDING     *
  6356*                *  BUSINESS AND PAYMNTS/ADJMNTS FILES.    *
  6357*                *  THE PREMIUM AMT WRITTEN IS EXTRACTED   *
  6358*                *  FROM THE PENDING BUSINESS FILE.        *
  6359*                *******************************************
  6360
  6361     MOVE PI-COMPANY-CD          TO ERPNDB-CO-CD
  6362                                    ERPNDB-CO-CD-A1
  6363                                    ERCOMP-COMP-CD
  6364                                    ERPYAJ-COMP-CD
  6365                                    ERACCT-P-CO-CD
  6366                                    ERACCT-A-CO-CD.
  6367
  6368     MOVE WS-CURRENT-DATE-EDIT   TO BI-HD-RUN-DT.
  6369
  6370     MOVE ZEROS                  TO PI-BAL-FRWD
  6371                                    PI-PREMIUM
  6372                                    PI-REMITTED
  6373                                    PI-TOT-ISS-COMP
  6374                                    PI-TOT-CAN-COMP
  6375                                    PI-ADJUSTMENTS
  6376                                    PI-DISBURSED
  6377                                    PI-END-BAL.
  6378
  6379     IF PI-VOID-BILL
  6380         GO TO 2000-VOID-BILLING.
  6381
  6382     MOVE SPACES                 TO ELCNTL-KEY.
  6383     MOVE '1'                    TO ELCNTL-REC-TYPE.
  6384     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  6385
  6386     IF EMI-ERROR NOT = ZEROS
  6387         GO TO 8200-SEND-DATAONLY.
  6388
  6389     IF CF-ACCOUNT-MSTR-MAINT-DT      = LOW-VALUES  OR
  6390        CF-COMPENSATION-MSTR-MAINT-DT = LOW-VALUES
  6391         MOVE ER-2571            TO EMI-ERROR
  6392         MOVE -1                 TO APFNTERL
  6393         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6394         GO TO 8200-SEND-DATAONLY.
  6395
  6396     IF CF-FORMS-PRINTER-ID = SPACES
  6397        IF ABILTYPI = '3' OR '4'
  6398          MOVE 2590               TO EMI-ERROR
  6399          MOVE -1                 TO ABILTYPL
  6400          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6401          GO TO 8200-SEND-DATAONLY.
  6402
  6403     MOVE CF-CL-MAIL-TO-NAME     TO BI-HD-CO.
  6404     MOVE CF-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  6405     MOVE SPACE                  TO DC-OPTION-CODE.
  6406     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6407     MOVE DC-GREG-DATE-1-EDIT    TO PI-MONTH-END-DATE.
  6408     MOVE DC-GREG-DATE-1-ALPHA   TO BI-HD-BILL-DT.
  6409     MOVE SPACE                  TO PI-DATA-BILLED-SW.
  6410
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 123
* EL640.cbl
  6411     PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT.
  6412
  6413     IF PNDB-EOF
  6414         GO TO 1100-PYAJ-BILLING-PROCESS.
  6415
  6416 1010-PNDB-BILLING-PROCESS-LOOP.
  6417     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  6418
  6419     IF PNDB-EOF
  6420         PERFORM 3500-TOTAL-OUT-DETAIL THRU 3599-EXIT
  6421         GO TO 1100-PYAJ-BILLING-PROCESS.
  6422
  6423     IF PB-COMPANY-CD-A1 = PI-COMPANY-CD  AND
  6424        PB-CARRIER       = PI-SAV-CARR    AND
  6425        PB-GROUPING      = PI-SAV-GROUP   AND
  6426        PB-STATE         = PI-SAV-STATE   AND
  6427        PB-ACCOUNT       = PI-SAV-ACCT
  6428         NEXT SENTENCE
  6429     ELSE
  6430         PERFORM 3500-TOTAL-OUT-DETAIL THRU 3599-EXIT
  6431         GO TO 1100-PYAJ-BILLING-PROCESS.
  6432
  6433     IF (PB-ISSUE) AND
  6434        (PB-I-POLICY-IS-REISSUE OR PB-I-REIN-ONLY OR
  6435         PB-I-POLICY-IS-MONTHLY OR
  6436         PB-I-POLICY-IS-DECLINED OR PB-I-POLICY-IS-VOIDED OR
  6437         PB-I-UNDERWRITE-POLICY)
  6438          GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6439     ELSE
  6440        IF (PB-CANCELLATION)
  6441           AND  (PB-CI-LF-POLICY-IS-REISSUE
  6442             OR  PB-CI-AH-POLICY-IS-REISSUE
  6443             OR  PB-CI-LF-POLICY-IS-MONTHLY
  6444             OR  PB-CI-AH-POLICY-IS-MONTHLY
  6445             OR  PB-CI-LF-POLICY-IS-DECLINED
  6446             OR  PB-CI-AH-POLICY-IS-VOID
  6447             OR  PB-CI-LF-REIN-ONLY
  6448             OR  PB-CI-AH-REIN-ONLY)
  6449             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6450
  6451     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  6452         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6453
  6454     IF PB-RECORD-ON-HOLD OR
  6455        PB-RECORD-RETURNED
  6456         PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6457         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6458
  6459     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  6460         IF PB-ENTRY-REVERSED
  6461             GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6462         ELSE
  6463             IF PI-REBILLING
  6464                 PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT
  6465                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6466
  6467     IF PB-BILLED-DT = LOW-VALUES
  6468       OR PI-TOT-REBILL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 124
* EL640.cbl
  6469       OR PB-ALT-CHG-SEQ-NO NOT = ZEROS
  6470         NEXT SENTENCE
  6471     ELSE
  6472         IF NOT PB-BATCH-TRAILER
  6473             PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6474             GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6475         ELSE
  6476             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6477
  6478     IF LIMIT-BILLING
  6479         IF PB-ENTRY-BATCH = ABTCH1I OR
  6480                             ABTCH2I OR
  6481                             ABTCH3I
  6482             NEXT SENTENCE
  6483         ELSE
  6484             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6485
  6486     IF PB-FATAL-ERRORS  OR
  6487        PB-UNFORCED-ERRORS
  6488         IF ABILERRI = 'N'
  6489             PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6490             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  6491             MOVE ER-2570        TO EMI-ERROR
  6492             MOVE -1             TO ABILERRL
  6493             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6494             SET EMI-INDX TO 1
  6495             IF EMI-ERROR-NUMBER (EMI-INDX) = ER-2570
  6496                 MOVE EMI-ERROR-TEXT (EMI-INDX) TO WS-ERROR-TEXT
  6497                 MOVE PB-ENTRY-BATCH            TO WS-ERROR-BATCH
  6498                 MOVE WS-ERROR-MSG TO EMI-ERROR-TEXT (EMI-INDX)
  6499                 GO TO 8200-SEND-DATAONLY
  6500             ELSE
  6501                 SET EMI-INDX    TO 2
  6502                 MOVE EMI-ERROR-TEXT (EMI-INDX) TO WS-ERROR-TEXT
  6503                 MOVE PB-ENTRY-BATCH            TO WS-ERROR-BATCH
  6504                 MOVE WS-ERROR-MSG TO EMI-ERROR-TEXT (EMI-INDX)
  6505                 GO TO 8200-SEND-DATAONLY
  6506         ELSE
  6507             PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6508             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6509
  6510     IF PB-BATCH-TRAILER
  6511         IF PI-UPDATE-FILES
  6512             PERFORM 1050-BILL-BATCH-TRAILER-CHK THRU 1059-EXIT
  6513             IF BILL-BATCH-TRAILER
  6514                 MOVE SPACE           TO BILL-BATCH-TRAILER-SW
  6515                 MOVE WS-CURRENT-DATE TO PB-BILLED-DT
  6516                 PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT
  6517                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6518             ELSE
  6519                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6520         ELSE
  6521             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6522
  6523     MOVE 'Y'                    TO PI-DATA-BILLED-SW.
  6524
  6525     PERFORM 1300-CHECK-OVERRIDE-PREM THRU 1399-EXIT.
  6526
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 125
* EL640.cbl
  6527     IF PB-CERT-EFF-DT > ERACCT-A-EXP-DATE
  6528         MOVE SPACE              TO WS-PROCESS-SW
  6529         MOVE PB-CERT-EFF-DT     TO PI-SAV-EXP-DT
  6530         PERFORM 4300-READ-ACCOUNT-MASTER  THRU 4390-EXIT
  6531         PERFORM 1020-CHK-IF-AGENT-IS-SAME THRU 1029-EXIT
  6532         IF EMI-ERROR NOT = ZEROS
  6533             IF PI-UPDATE-FILES
  6534               OR (PI-PREVIEW AND APRODSWI = 'Y')
  6535                 PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6536                 IF EMI-ERROR NOT = '2403'
  6537                     PERFORM 3940-BILL-GENERIC-DELETE
  6538                             THRU 3940-EXIT
  6539                     GO TO 8200-SEND-DATAONLY
  6540                 ELSE
  6541                     GO TO 8200-SEND-DATAONLY
  6542             ELSE
  6543                 GO TO 8200-SEND-DATAONLY.
  6544
  6545     PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT.
  6546
  6547     IF DO-NOT-BILL-THIS-ACCT
  6548         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6549
  6550     PERFORM 1030-COMPUTE-COMMISSION-TOTALS THRU 1039-EXIT.
  6551
  6552     IF EMI-ERROR NOT = ZEROS
  6553         IF PI-UPDATE-FILES
  6554           OR (PI-PREVIEW AND APRODSWI = 'Y')
  6555             PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6556             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  6557             GO TO 8200-SEND-DATAONLY
  6558         ELSE
  6559             GO TO 8200-SEND-DATAONLY.
  6560
  6561     IF PI-UPDATE-FILES
  6562       OR (PI-PREVIEW AND APRODSWI = 'Y')
  6563         MOVE 'BD'               TO BILLING-DETAIL-TYPE
  6564         PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  6565
  6566     IF PI-BILL OR PI-REBILLING
  6567         PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT.
  6568
  6569     GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 126
* EL640.cbl
  6571 1020-CHK-IF-AGENT-IS-SAME.
  6572     MOVE +1 TO ACCOM-SUB.
  6573
  6574 1025-FIND-AGENT-LOOP.
  6575     IF AM-COM-TYP (ACCOM-SUB) = 'C' OR 'D' OR 'F'
  6576         NEXT SENTENCE
  6577     ELSE
  6578         ADD +1 TO ACCOM-SUB
  6579         IF ACCOM-SUB > 10
  6580             MOVE -1             TO AACCTL
  6581             MOVE ER-2404        TO EMI-ERROR
  6582             MOVE AL-UABON       TO AACCTA
  6583             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6584         ELSE
  6585             GO TO 1025-FIND-AGENT-LOOP.
  6586
  6587     IF AM-AGT (ACCOM-SUB) NOT = PI-SAV-ACCT
  6588         IF FIRST-TIME
  6589             MOVE -1             TO AACCTL
  6590             MOVE ER-2405        TO EMI-ERROR
  6591             MOVE AL-UABON       TO AACCTA
  6592             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6593             GO TO 1029-EXIT
  6594         ELSE
  6595             MOVE 'Y'            TO WS-PROCESS-SW
  6596             GO TO 1029-EXIT.
  6597
  6598     IF FIRST-TIME
  6599         MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO
  6600                                      PI-CR-FIN-RESP
  6601         MOVE 'A'                  TO PI-CR-TYPE
  6602         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  6603         MOVE SPACE                TO FIRST-TIME-SW
  6604         IF EMI-ERROR NOT = ZEROS
  6605             GO TO 1029-EXIT.
  6606
  6607     IF AM-AGT (AM-REMIT-TO) = PI-SAV-REMIT-TO
  6608         NEXT SENTENCE
  6609     ELSE
  6610         MOVE 'Y'                TO WS-PROCESS-SW
  6611         MOVE ER-2408            TO EMI-ERROR
  6612         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6613         PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6614         PERFORM 3940-BILL-GENERIC-DELETE  THRU  3940-EXIT
  6615         MOVE -1                 TO AACCTL
  6616         GO TO 8200-SEND-DATAONLY.
  6617
  6618     MOVE AM-NAME                TO PI-ACCT-NAME.
  6619
  6620     IF PI-BILL OR PI-REBILLING
  6621         PERFORM 4400-ERACCT-REWRITE THRU 4490-EXIT.
  6622
  6623 1029-EXIT.
  6624     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 127
* EL640.cbl
  6626 1030-COMPUTE-COMMISSION-TOTALS.
  6627     IF PB-CANCELLATION
  6628         GO TO 1035-COMPUTE-CANCEL-COMM.
  6629
  6630     MOVE SPACES                 TO WS-AH-CATEGORY
  6631     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
  6632        AND (NOT PB-INVALID-AH)
  6633        MOVE SPACES              TO ELCNTL-KEY
  6634        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6635        MOVE '5'                 TO ELCNTL-REC-TYPE
  6636        MOVE PB-I-AH-BENEFIT-CD  TO ELCNTL-ACCESS (3:2)
  6637                                    CLAS-LOOK
  6638        MOVE +0                  TO ELCNTL-SEQ-NO
  6639        PERFORM 6130-FIND-BENEFIT-CD
  6640                                 THRU 6140-EXIT
  6641     END-IF
  6642     if (pi-company-id = 'DCC' or 'VPP')
  6643        and (ws-ah-category = 'G' or 'L')
  6644        compute pi-premium = ws-i-ah-premium-amt + pi-premium
  6645        move zeros               to ws-i-lf-premium-amt
  6646     else
  6647        COMPUTE PI-PREMIUM = (WS-I-LF-PREMIUM-AMT +
  6648           WS-I-AH-PREMIUM-AMT) + PI-PREMIUM
  6649     end-if
  6650     COMPUTE PI-LF-ISS-COMP ROUNDED =
  6651         (WS-I-LF-PREMIUM-AMT * PB-I-LIFE-COMMISSION).
  6652     IF WS-AH-CATEGORY = 'G' OR 'L'
  6653        COMPUTE PI-AH-ISS-COMP ROUNDED =
  6654           WS-I-AH-PREMIUM-AMT - PB-I-LF-ALT-PREMIUM-AMT
  6655              - PB-I-ADDL-CLP
  6656     ELSE
  6657        COMPUTE PI-AH-ISS-COMP ROUNDED =
  6658            (WS-I-AH-PREMIUM-AMT * PB-I-AH-COMMISSION)
  6659     END-IF
  6660     COMPUTE PI-TOT-ISS-COMP = PI-TOT-ISS-COMP +
  6661                               PI-LF-ISS-COMP +
  6662                               PI-AH-ISS-COMP.
  6663     GO TO 1039-EXIT.
  6664
  6665 1035-COMPUTE-CANCEL-COMM.
  6666
  6667     MOVE SPACES                 TO WS-AH-CATEGORY
  6668     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
  6669        AND (PB-CI-AH-BENEFIT-CD NOT = SPACES AND ZEROS)
  6670        MOVE SPACES              TO ELCNTL-KEY
  6671        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6672        MOVE '5'                 TO ELCNTL-REC-TYPE
  6673        MOVE PB-CI-AH-BENEFIT-CD TO ELCNTL-ACCESS (3:2)
  6674                                    CLAS-LOOK
  6675        MOVE +0                  TO ELCNTL-SEQ-NO
  6676        PERFORM 6130-FIND-BENEFIT-CD
  6677                                 THRU 6140-EXIT
  6678     END-IF
  6679     IF WS-AH-CATEGORY = 'G' OR 'L'
  6680        COMPUTE PI-PREMIUM = PI-PREMIUM -
  6681          WS-C-AH-CANCEL-AMT
  6682     ELSE
  6683        COMPUTE PI-PREMIUM = PI-PREMIUM -
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 128
* EL640.cbl
  6684         (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT)
  6685     END-IF
  6686
  6687     COMPUTE PI-LF-CAN-COMP   ROUNDED =
  6688         (WS-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION) * -1.
  6689     IF WS-AH-CATEGORY = 'G' OR 'L'
  6690        IF AM-DCC-PRODUCT-CODE = 'DDF'
  6691           COMPUTE CNC-FACT = PB-C-AH-RFND-CLP /
  6692              pb-ci-lf-alt-premium-amt
  6693        else
  6694           COMPUTE CNC-FACT = PB-C-AH-CANCEL-AMT /
  6695              PB-CI-AH-PREMIUM-AMT
  6696        end-if
  6697        COMPUTE PI-AH-CAN-COMP ROUNDED =
  6698           (CNC-FACT * (PB-CI-AH-PREMIUM-AMT -
  6699           PB-CI-LF-ALT-PREMIUM-AMT - PB-CI-ADDL-CLP))
  6700     ELSE
  6701        COMPUTE PI-AH-CAN-COMP   ROUNDED =
  6702         (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION) * -1
  6703     END-IF
  6704     MOVE PB-CERT-EFF-DT           TO  DC-BIN-DATE-1.
  6705     MOVE PB-C-LF-CANCEL-DT        TO  DC-BIN-DATE-2.
  6706     MOVE '1'                      TO  DC-OPTION-CODE.
  6707     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6708     MOVE DC-ELAPSED-MONTHS        TO  MONTHS-DIFF-LF.
  6709
  6710     IF DC-ODD-DAYS-OVER > ZEROS
  6711         ADD +1 TO MONTHS-DIFF-LF.
  6712
  6713     MOVE PB-CERT-EFF-DT           TO  DC-BIN-DATE-1.
  6714     MOVE PB-C-AH-CANCEL-DT        TO  DC-BIN-DATE-2.
  6715     MOVE '1'                      TO  DC-OPTION-CODE.
  6716     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6717     MOVE DC-ELAPSED-MONTHS        TO  MONTHS-DIFF-AH.
  6718
  6719     IF DC-ODD-DAYS-OVER > ZEROS
  6720         ADD +1 TO MONTHS-DIFF-AH.
  6721
  6722     PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT.
  6723
  6724     MOVE  +0                       TO  SUB.
  6725     MOVE  'Y'                      TO  WS-CHARGEBACK-LF-SW
  6726                                        WS-CHARGEBACK-AH-SW.
  6727
  6728     MOVE ZEROS                     TO  WS-LF-CAN-COMP
  6729                                        WS-AH-CAN-COMP.
  6730 1035-ACCT-COMM-LOOP.
  6731
  6732     ADD +1 TO SUB.
  6733
  6734     IF SUB > +10
  6735         GO TO 1035-COMPUTE-TOT-CAN.
  6736
  6737     IF AM-COM-TYP (SUB) NOT = 'C' AND 'D' AND 'F'
  6738         GO TO 1035-ACCT-COMM-LOOP.
  6739
  6740     IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  6741         MOVE  ZEROS            TO  AM-COMM-CHARGEBACK (SUB).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 129
* EL640.cbl
  6742
  6743     IF AM-COMM-CHARGEBACK (SUB) = '99'
  6744         MOVE  'N'               TO  WS-CHARGEBACK-LF-SW
  6745         GO TO 1035-CHECK-AH-CHARGEBACK.
  6746
  6747     IF (MONTHS-DIFF-LF > AM-COMM-CHARGEBACK (SUB))
  6748                            AND
  6749        (AM-COMM-CHARGEBACK (SUB) NOT = ZEROS)
  6750         MOVE  'N'               TO  WS-CHARGEBACK-LF-SW
  6751     ELSE
  6752         COMPUTE WS-LF-CAN-COMP   ROUNDED =  WS-LF-CAN-COMP +
  6753            (WS-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION).
  6754
  6755 1035-CHECK-AH-CHARGEBACK.
  6756
  6757     IF AM-COMM-CHARGEBACK (SUB) = '99'
  6758         MOVE  'N'                TO  WS-CHARGEBACK-AH-SW
  6759         GO TO  1035-ACCT-COMM-LOOP.
  6760
  6761     IF (MONTHS-DIFF-AH > AM-COMM-CHARGEBACK (SUB))
  6762                            AND
  6763        (AM-COMM-CHARGEBACK (SUB) NOT = ZEROS)
  6764         MOVE  'N'                TO  WS-CHARGEBACK-AH-SW
  6765     ELSE
  6766        IF WS-AH-CATEGORY = 'G' OR 'L'
  6767           MOVE PI-AH-CAN-COMP   TO WS-AH-CAN-COMP
  6768        ELSE
  6769         COMPUTE WS-AH-CAN-COMP ROUNDED = WS-AH-CAN-COMP +
  6770            (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION)
  6771        END-IF
  6772     END-IF
  6773
  6774     GO TO 1035-ACCT-COMM-LOOP.
  6775
  6776 1035-COMPUTE-TOT-CAN.
  6777
  6778     COMPUTE PI-TOT-CAN-COMP = PI-TOT-CAN-COMP +
  6779                               WS-LF-CAN-COMP +
  6780                               WS-AH-CAN-COMP.
  6781
  6782 1039-EXIT.
  6783     EXIT.
  6784
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 130
* EL640.cbl
  6786 1040-UPDATE-BILLING-STATISTICS.
  6787     SET PINDX                   TO 1.
  6788
  6789 1041-SEARCH-LOOP.
  6790     IF PI-NON-PREM (PINDX) NOT NUMERIC
  6791        MOVE ZEROS               TO PI-NON-PREM (PINDX).
  6792     IF WS-NON-PREM  NOT NUMERIC
  6793        MOVE ZEROS               TO WS-NON-PREM.
  6794     IF PI-NON-COMM (PINDX) NOT NUMERIC
  6795        MOVE ZEROS               TO PI-NON-COMM (PINDX).
  6796     IF WS-NON-COMM  NOT NUMERIC
  6797        MOVE ZEROS               TO WS-NON-COMM.
  6798
  6799     IF PI-BATCH (PINDX) NOT = SPACES
  6800         GO TO 1042-CHECK-FOR-MATCH.
  6801
  6802     MOVE PB-ENTRY-BATCH         TO PI-BATCH (PINDX).
  6803
  6804     IF PI-COMPANY-ID = 'DMD'
  6805         PERFORM 1060-DMD-ERROR-ROUTINE THRU 1060-EXIT.
  6806
  6807     IF DO-NOT-BILL-THIS-ACCT OR
  6808        PB-FATAL-ERRORS       OR
  6809        PB-UNFORCED-ERRORS    OR
  6810        PB-RECORD-ON-HOLD     OR
  6811        PB-RECORD-RETURNED    OR
  6812        PI-VOID-BILL
  6813         MOVE +1                 TO PI-NOBILL (PINDX)
  6814         MOVE ZEROS              TO PI-BILLED (PINDX)
  6815                                    PI-PREV   (PINDX)
  6816     ELSE
  6817         IF PB-BILLED-DT = LOW-VALUES
  6818           OR PI-TOT-REBILL
  6819             MOVE +1             TO PI-BILLED (PINDX)
  6820             MOVE ZEROS          TO PI-NOBILL (PINDX)
  6821                                    PI-PREV   (PINDX)
  6822         ELSE
  6823             MOVE +1             TO PI-PREV   (PINDX)
  6824             MOVE ZEROS          TO PI-BILLED (PINDX)
  6825                                    PI-NOBILL (PINDX).
  6826
  6827     GO TO 1049-EXIT.
  6828
  6829 1042-CHECK-FOR-MATCH.
  6830     IF PI-BATCH (PINDX) = PB-ENTRY-BATCH
  6831         NEXT SENTENCE
  6832     ELSE
  6833         GO TO 1043-SET-INDEX-UP.
  6834
  6835     IF PI-COMPANY-ID = 'DMD'
  6836         PERFORM 1060-DMD-ERROR-ROUTINE THRU 1060-EXIT.
  6837
  6838     IF DO-NOT-BILL-THIS-ACCT OR
  6839        PB-FATAL-ERRORS       OR
  6840        PB-UNFORCED-ERRORS    OR
  6841        PB-RECORD-ON-HOLD     OR
  6842        PB-RECORD-RETURNED    OR
  6843        PI-VOID-BILL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 131
* EL640.cbl
  6844         ADD +1 TO PI-NOBILL (PINDX)
  6845     ELSE
  6846         IF PB-BILLED-DT = LOW-VALUES
  6847           OR PI-TOT-REBILL
  6848             ADD +1          TO PI-BILLED (PINDX)
  6849         ELSE
  6850             ADD +1          TO PI-PREV   (PINDX).
  6851
  6852     GO TO 1049-EXIT.
  6853
  6854 1043-SET-INDEX-UP.
  6855     SET PINDX UP BY 1.
  6856
  6857     IF PINDX > +6
  6858         MOVE 'Y'                TO BATCHES-PROCESSED-SW
  6859         GO TO 1049-EXIT
  6860     ELSE
  6861         GO TO 1041-SEARCH-LOOP.
  6862
  6863 1049-EXIT.
  6864     EXIT.
  6865
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 132
* EL640.cbl
  6867 1050-BILL-BATCH-TRAILER-CHK.
  6868     SET PINDX                   TO 1.
  6869
  6870 1052-LOOP.
  6871     IF PI-BATCH (PINDX) = SPACES
  6872         GO TO 1059-EXIT.
  6873
  6874     IF PB-ENTRY-BATCH = PI-BATCH (PINDX)
  6875       AND PI-BILLED (PINDX) NOT = ZEROS
  6876         MOVE 'Y'                TO BILL-BATCH-TRAILER-SW
  6877         GO TO 1059-EXIT.
  6878
  6879     SET PINDX UP BY 1.
  6880     IF PINDX NOT > 6
  6881         GO TO 1052-LOOP.
  6882
  6883 1059-EXIT.
  6884     EXIT.
  6885
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 133
* EL640.cbl
  6887 1060-DMD-ERROR-ROUTINE.
  6888     IF PB-FATAL-ERRORS OR PB-UNFORCED-ERRORS
  6889        IF ABILERRI = 'Y'
  6890           IF PB-ISSUE
  6891              COMPUTE WS-NON-PREM = PB-I-LF-PREMIUM-AMT
  6892                 + PB-I-LF-ALT-PREMIUM-AMT
  6893                 + PB-I-AH-PREMIUM-AMT
  6894              ADD WS-NON-PREM TO PI-NON-PREM (PINDX)
  6895              COMPUTE WS-NON-COMM ROUNDED =
  6896              ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
  6897                                    * PB-I-LIFE-COMMISSION)
  6898                                    +
  6899               (PB-I-AH-PREMIUM-AMT * PB-I-AH-COMMISSION)
  6900              ADD WS-NON-COMM TO PI-NON-COMM (PINDX)
  6901           ELSE
  6902           IF PB-CANCELLATION
  6903              COMPUTE WS-NON-PREM =
  6904              (PB-C-LF-CANCEL-AMT +  PB-C-AH-CANCEL-AMT) * -1
  6905              ADD WS-NON-PREM TO PI-NON-PREM (PINDX)
  6906              COMPUTE WS-NON-COMM ROUNDED =
  6907              ((PB-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION)
  6908                                   +
  6909               (PB-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION))
  6910                                   * -1
  6911              ADD WS-NON-COMM TO PI-NON-COMM (PINDX).
  6912
  6913 1060-EXIT.
  6914     EXIT.
  6915
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 134
* EL640.cbl
  6917 1100-PYAJ-BILLING-PROCESS.
  6918*                *******************************************
  6919*                *  PROCESS THE PAYMENTS/ADJUSTMENTS FILE    *
  6920*                *******************************************
  6921
  6922     IF LIMIT-BILLING AND NOT PI-DATA-BILLED
  6923         MOVE ER-2443            TO EMI-ERROR
  6924         MOVE -1                 TO ABTCH1L
  6925         MOVE AL-UABON           TO ABTCH1A
  6926         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6927         GO TO 8200-SEND-DATAONLY.
  6928
  6929     IF NOT PI-DATA-BILLED
  6930         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  6931         IF EMI-ERROR = ZEROS
  6932             MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO
  6933                                          PI-CR-FIN-RESP
  6934             MOVE AM-REMIT-TO            TO ACCOM-SUB
  6935             MOVE 'A'                    TO PI-CR-TYPE
  6936             PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  6937             IF EMI-ERROR NOT = ZEROS
  6938                 GO TO 8200-SEND-DATAONLY
  6939             ELSE
  6940                 NEXT SENTENCE
  6941         ELSE
  6942             GO TO 8200-SEND-DATAONLY.
  6943
  6944 1105-PYAJ-BILLING-STARTBR-LOOP.
  6945     PERFORM 4500-PYAJ-START-BROWSE THRU 4590-EXIT.
  6946
  6947     IF PYAJ-EOF
  6948         GO TO 1200-PYAJ-BILLING-COMPLETE.
  6949
  6950 1110-PYAJ-BILLING-READ-LOOP.
  6951     PERFORM 4600-PYAJ-READ-NEXT THRU 4690-EXIT.
  6952
  6953     IF PYAJ-EOF
  6954         GO TO 1200-PYAJ-BILLING-COMPLETE.
  6955
  6956     IF PY-COMPANY-CD = PI-COMPANY-CD      AND
  6957        PY-CARRIER    = ERPYAJ-BR-CARRIER  AND
  6958        PY-GROUPING   = ERPYAJ-BR-GROUPING AND
  6959        PY-FIN-RESP   = PI-SAV-REMIT-TO    AND
  6960        PY-ACCOUNT    = PI-SAV-ACCT
  6961         NEXT SENTENCE
  6962     ELSE
  6963         GO TO 1200-PYAJ-BILLING-COMPLETE.
  6964
  6965     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  6966         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6967
  6968     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'C' OR 'S' OR 'T' OR 'U'
  6969                         OR 'Z'
  6970         NEXT SENTENCE
  6971     ELSE
  6972         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6973
  6974     IF PY-VOID-SW NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 135
* EL640.cbl
  6975         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6976
  6977     IF PI-AR-PROCESSING
  6978        IF PY-AR-DATE = LOW-VALUES
  6979           OR PI-TOT-REBILL
  6980           OR RETURNED-FROM = XCTL-PYAJ
  6981           NEXT SENTENCE
  6982        ELSE
  6983           GO TO 1110-PYAJ-BILLING-READ-LOOP
  6984     ELSE
  6985        IF (PY-BILLED-DATE = LOW-VALUES AND
  6986            PY-AR-DATE = LOW-VALUES)
  6987           OR PI-TOT-REBILL
  6988           OR RETURNED-FROM = XCTL-PYAJ
  6989           NEXT SENTENCE
  6990        ELSE
  6991           GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6992
  6993     MOVE 'Y'                    TO PI-DATA-BILLED-SW.
  6994
  6995     IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  6996         PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  6997         PY-ADD-TO-BALANCE
  6998         ADD PY-ENTRY-AMT  TO  PI-REMITTED
  6999     ELSE
  7000         IF (PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT)
  7001            AND PY-BILLING-CHECK
  7002             ADD PY-ENTRY-AMT TO PI-DISBURSED
  7003         ELSE
  7004             ADD PY-ENTRY-AMT TO PI-ADJUSTMENTS.
  7005
  7006     IF RETURNED-FROM = SPACES
  7007         IF PI-UPDATE-FILES
  7008           OR (PI-PREVIEW AND APRODSWI = 'Y')
  7009             MOVE 'BP'           TO BILLING-DETAIL-TYPE
  7010             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  7011
  7012     IF RETURNED-FROM = SPACES
  7013       AND (PI-BILL OR PI-REBILLING)
  7014         PERFORM 4800-PYAJ-END-BROWSE
  7015         PERFORM 4700-PYAJ-REWRITE THRU 4790-EXIT
  7016         ADD +1 TO ERPYAJ-FILE-SEQ-NO
  7017         GO TO 1105-PYAJ-BILLING-STARTBR-LOOP.
  7018
  7019     GO TO 1110-PYAJ-BILLING-READ-LOOP.
  7020
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 136
* EL640.cbl
  7022 1200-PYAJ-BILLING-COMPLETE.
  7023     IF PI-DATA-BILLED
  7024       IF RETURNED-FROM = SPACES
  7025         IF PI-UPDATE-FILES
  7026            OR (PI-PREVIEW AND APRODSWI = 'Y')
  7027               MOVE 'TS'           TO BILLING-DETAIL-TYPE
  7028               PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  7029
  7030     PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT.
  7031
  7032     GO TO 8100-SEND-INITIAL-MAP.
  7033
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 137
* EL640.cbl
  7035 1300-CHECK-OVERRIDE-PREM.
  7036     IF PB-CANCELLATION
  7037        IF PB-CI-CANCEL-FEE NOT NUMERIC
  7038           MOVE ZEROS  TO  PB-CI-CANCEL-FEE
  7039        END-IF
  7040     END-IF
  7041
  7042     MOVE ZEROS                  TO WS-I-LF-PREMIUM-AMT
  7043                                    WS-I-LF-BENEFIT-AMT
  7044     IF PB-OVERRIDE-LIFE  OR
  7045        PB-OVERRIDE-BOTH
  7046         GO TO 1310-LIFE-OVERRIDE.
  7047
  7048     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7049         IF PB-ISSUE
  7050           IF NOT PB-INVALID-LIFE
  7051            COMPUTE  WS-I-LF-PREMIUM-AMT =
  7052                    (PB-I-LF-PREMIUM-AMT +
  7053                     PB-I-LF-ALT-PREMIUM-AMT) * -1
  7054            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7055                    (PB-I-LF-BENEFIT-AMT +
  7056                     PB-I-LF-ALT-BENEFIT-AMT) * -1
  7057           END-IF
  7058         ELSE
  7059             MULTIPLY PB-C-LF-CANCEL-AMT BY -1
  7060                            GIVING WS-C-LF-CANCEL-AMT
  7061             MULTIPLY PB-CI-LF-BENEFIT-AMT BY -1
  7062                            GIVING WS-CI-LIFE-BENEFIT
  7063         END-IF
  7064     ELSE
  7065         IF PB-ISSUE
  7066           IF NOT PB-INVALID-LIFE
  7067            ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
  7068                GIVING WS-I-LF-PREMIUM-AMT
  7069            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7070                     PB-I-LF-BENEFIT-AMT +
  7071                     PB-I-LF-ALT-BENEFIT-AMT
  7072           END-IF
  7073         ELSE
  7074            MOVE PB-C-LF-CANCEL-AMT   TO WS-C-LF-CANCEL-AMT
  7075            MOVE PB-CI-LF-BENEFIT-AMT TO WS-CI-LIFE-BENEFIT
  7076         END-IF
  7077     END-IF
  7078
  7079     GO TO 1320-CHECK-AH
  7080
  7081     .
  7082 1310-LIFE-OVERRIDE.
  7083     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7084         IF PB-ISSUE
  7085           IF NOT PB-INVALID-LIFE
  7086            COMPUTE WS-I-LF-PREMIUM-AMT =
  7087                   (PB-I-LF-PREM-CALC +
  7088                      PB-I-LF-ALT-PREM-CALC) * -1
  7089            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7090                     (PB-I-LF-BENEFIT-AMT +
  7091                      PB-I-LF-ALT-BENEFIT-AMT) * -1
  7092           END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 138
* EL640.cbl
  7093         ELSE
  7094             MULTIPLY PB-C-LF-REF-CALC BY -1
  7095                            GIVING WS-C-LF-CANCEL-AMT
  7096             MULTIPLY PB-CI-LF-BENEFIT-AMT BY -1
  7097                            GIVING WS-CI-LIFE-BENEFIT
  7098         END-IF
  7099     ELSE
  7100         IF PB-ISSUE
  7101           IF NOT PB-INVALID-LIFE
  7102            ADD PB-I-LF-PREM-CALC   PB-I-LF-ALT-PREM-CALC
  7103                GIVING WS-I-LF-PREMIUM-AMT
  7104            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7105                     PB-I-LF-BENEFIT-AMT +
  7106                     PB-I-LF-ALT-BENEFIT-AMT
  7107           END-IF
  7108         ELSE
  7109            MOVE PB-C-LF-REF-CALC     TO WS-C-LF-CANCEL-AMT
  7110            MOVE PB-CI-LF-BENEFIT-AMT TO WS-CI-LIFE-BENEFIT
  7111         END-IF
  7112     END-IF
  7113     .
  7114 1320-CHECK-AH.
  7115     IF PB-OVERRIDE-AH  OR
  7116        PB-OVERRIDE-BOTH
  7117         GO TO 1330-AH-OVERRIDE.
  7118
  7119     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7120         IF PB-ISSUE
  7121            MULTIPLY PB-I-AH-BENEFIT-AMT BY -1
  7122                            GIVING WS-I-AH-BENEFIT-AMT
  7123            MULTIPLY PB-I-AH-PREMIUM-AMT BY -1
  7124                            GIVING WS-I-AH-PREMIUM-AMT
  7125         ELSE
  7126             MULTIPLY PB-C-AH-CANCEL-AMT BY -1
  7127                            GIVING WS-C-AH-CANCEL-AMT
  7128     ELSE
  7129         IF PB-ISSUE
  7130            MOVE PB-I-AH-BENEFIT-AMT TO WS-I-AH-BENEFIT-AMT
  7131            MOVE PB-I-AH-PREMIUM-AMT TO WS-I-AH-PREMIUM-AMT
  7132         ELSE
  7133            MOVE PB-C-AH-CANCEL-AMT TO WS-C-AH-CANCEL-AMT
  7134            IF  PB-CI-CANCEL-FEE > ZEROS
  7135                MOVE PB-CI-CANCEL-FEE     TO WS-C-CANCEL-FEE
  7136                MULTIPLY WS-C-CANCEL-FEE BY -1
  7137                                          GIVING WORK-CANCEL-FEE
  7138                ADD WORK-CANCEL-FEE       TO TOT-REPT-CANCEL-FEE.
  7139
  7140     GO TO 1399-EXIT.
  7141
  7142 1330-AH-OVERRIDE.
  7143     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7144         IF PB-ISSUE
  7145            MULTIPLY PB-I-AH-BENEFIT-AMT BY -1
  7146                            GIVING WS-I-AH-BENEFIT-AMT
  7147            MULTIPLY PB-I-AH-PREM-CALC BY -1
  7148                            GIVING WS-I-AH-PREMIUM-AMT
  7149         ELSE
  7150             MULTIPLY PB-C-AH-REF-CALC BY -1
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 139
* EL640.cbl
  7151                            GIVING WS-C-AH-CANCEL-AMT
  7152     ELSE
  7153         IF PB-ISSUE
  7154            MOVE PB-I-AH-BENEFIT-AMT TO WS-I-AH-BENEFIT-AMT
  7155            MOVE PB-I-AH-PREM-CALC   TO WS-I-AH-PREMIUM-AMT
  7156         ELSE
  7157            MOVE PB-C-AH-REF-CALC    TO WS-C-AH-CANCEL-AMT
  7158            IF PB-CI-CANCEL-FEE > ZEROS
  7159                MOVE PB-CI-CANCEL-FEE     TO WS-C-CANCEL-FEE
  7160                MULTIPLY WS-C-CANCEL-FEE BY -1
  7161                                          GIVING WORK-CANCEL-FEE
  7162                ADD WORK-CANCEL-FEE       TO TOT-REPT-CANCEL-FEE.
  7163
  7164 1399-EXIT.
  7165     EXIT.
  7166
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 140
* EL640.cbl
  7168 2000-VOID-BILLING.
  7169
  7170*                *******************************************
  7171*                *  PROCESS VOID BILLING.  THIS SECTION    *
  7172*                *  WILL RESET THE FILES TO THE STATUS     *
  7173*                *  THEY WERE IN PRIOR TO THE LAST BILLING *
  7174*                *******************************************
  7175
  7176     MOVE SPACES                 TO WS-EXP-DATE
  7177                                    WS-REMIT-TO.
  7178     SET DTNDX  RTNDX            TO 1.
  7179     MOVE SPACES                 TO ELCNTL-KEY.
  7180     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7181
  7182     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  7183
  7184     IF EMI-ERROR NOT = ZEROS
  7185         GO TO 8200-SEND-DATAONLY.
  7186
  7187     MOVE CF-CURRENT-MONTH-END   TO DC-BIN-DATE-1.
  7188     MOVE SPACE                  TO DC-OPTION-CODE.
  7189     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7190     MOVE DC-GREG-DATE-1-EDIT    TO PI-MONTH-END-DATE.
  7191
  7192     PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT.
  7193
  7194     IF PNDB-EOF
  7195         GO TO 2100-VOID-PNDB-COMPLETE.
  7196
  7197 2010-VOID-PNDB-LOOP.
  7198     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  7199
  7200     IF PNDB-EOF
  7201         GO TO 2100-VOID-PNDB-COMPLETE.
  7202
  7203     IF PB-COMPANY-CD-A1 = PI-COMPANY-CD  AND
  7204        PB-CARRIER       = PI-SAV-CARR    AND
  7205        PB-GROUPING      = PI-SAV-GROUP   AND
  7206        PB-STATE         = PI-SAV-STATE   AND
  7207        PB-ACCOUNT       = PI-SAV-ACCT
  7208         NEXT SENTENCE
  7209     ELSE
  7210         GO TO 2100-VOID-PNDB-COMPLETE.
  7211
  7212     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  7213         GO TO 2010-VOID-PNDB-LOOP.
  7214
  7215     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7216         MOVE PB-CONTROL-PRIMARY TO ERPNDB-PRIME-KEY
  7217
  7218* EXEC CICS ENDBR
  7219*             DATASET (ERPNDB-ALT-FILE-ID)
  7220*        END-EXEC
  7221     MOVE 0
  7222       TO DFHEIV11
  7223*    MOVE '&2                    $   #00007117' TO DFHEIV0
  7224     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7225     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 141
* EL640.cbl
  7226     MOVE X'2020233030303037313137' TO DFHEIV0(25:11)
  7227     CALL 'kxdfhei1' USING DFHEIV0,
  7228           ERPNDB-ALT-FILE-ID,
  7229           DFHEIV11,
  7230           DFHEIV99
  7231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7232
  7233* EXEC CICS DELETE
  7234*            DATASET (ERPNDB-FILE-ID)
  7235*            RIDFLD  (ERPNDB-PRIME-KEY)
  7236*        END-EXEC
  7237*    MOVE '&(  R                 &   #00007120' TO DFHEIV0
  7238     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7239     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7240     MOVE X'2020233030303037313230' TO DFHEIV0(25:11)
  7241     CALL 'kxdfhei1' USING DFHEIV0,
  7242           ERPNDB-FILE-ID,
  7243           ERPNDB-PRIME-KEY,
  7244           DFHEIV99,
  7245           DFHEIV99,
  7246           DFHEIV99
  7247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7248         PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT
  7249         IF PNDB-EOF
  7250            GO TO 2100-VOID-PNDB-COMPLETE
  7251         ELSE
  7252            GO TO 2010-VOID-PNDB-LOOP.
  7253
  7254     IF PB-BILLED-DT = LOW-VALUES  AND
  7255        PB-CHG-COUNT = ZEROS
  7256         GO TO 2010-VOID-PNDB-LOOP.
  7257
  7258     IF PB-BATCH-TRAILER
  7259         GO TO 2115-CONT.
  7260
  7261     IF PB-CERT-EFF-DT > ERACCT-A-EXP-DATE
  7262         MOVE PB-CERT-EFF-DT     TO PI-SAV-EXP-DT
  7263         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  7264         IF AM-AGT (AM-REMIT-TO) NOT = WORK-REMIT-TO
  7265             MOVE AM-AGT (AM-REMIT-TO) TO WORK-REMIT-TO
  7266                                          WS-SAV-REMIT-TO (RTNDX)
  7267             IF RTNDX < 10
  7268                 SET RTNDX UP BY 1.
  7269
  7270 2115-CONT.
  7271     IF NOT PB-BATCH-TRAILER
  7272         PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  7273         PERFORM 1300-CHECK-OVERRIDE-PREM       THRU 1399-EXIT
  7274         PERFORM 1030-COMPUTE-COMMISSION-TOTALS THRU 1039-EXIT.
  7275
  7276     PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT.
  7277
  7278     MOVE 'Y'                    TO DATA-VOIDED-SW.
  7279     GO TO 2010-VOID-PNDB-LOOP.
  7280
  7281 2100-VOID-PNDB-COMPLETE.
  7282     SET RTNDX                   TO 1.
  7283
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 142
* EL640.cbl
  7284     IF NOT DATA-VOIDED
  7285         SET DTNDX TO RTNDX
  7286         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  7287         MOVE AM-AGT (AM-REMIT-TO) TO WS-SAV-REMIT-TO (RTNDX).
  7288
  7289 2105-PYAJ-LOOP.
  7290     IF RTNDX > 10
  7291       OR WS-SAV-REMIT-TO (RTNDX) = SPACES
  7292         GO TO 2105-VOID-CONTINUE.
  7293
  7294     MOVE WS-SAV-REMIT-TO (RTNDX) TO PI-SAV-REMIT-TO.
  7295     PERFORM 2200-VOID-PYAJ THRU 2290-EXIT.
  7296
  7297     SET RTNDX UP BY 1.
  7298     GO TO 2105-PYAJ-LOOP.
  7299
  7300 2105-VOID-CONTINUE.
  7301     IF DATA-VOIDED
  7302         NEXT SENTENCE
  7303     ELSE
  7304         MOVE -1                 TO APFNTERL
  7305         MOVE ER-2401            TO EMI-ERROR
  7306         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7307         GO TO 8100-SEND-INITIAL-MAP.
  7308
  7309     SET DTNDX                   TO 1.
  7310
  7311 2105-VOID-MASTERS-LOOP.
  7312     IF WS-SAV-EXP-DT (DTNDX) = SPACES
  7313       OR DTNDX > 10
  7314         GO TO 2105-VOID-COMPLETE.
  7315
  7316     MOVE WS-SAV-EXP-DT (DTNDX) TO PI-SAV-EXP-DT.
  7317
  7318     PERFORM 4400-ERACCT-REWRITE THRU 4490-EXIT.
  7319
  7320     IF PI-SAV-REMIT-TO NOT = ERCOMP-FIN-RESP
  7321         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  7322         PERFORM 3930-BILL-READ        THRU 3930-EXIT
  7323         IF NOT NO-BILL-RECS
  7324             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT.
  7325
  7326     SET DTNDX UP BY 1.
  7327
  7328     GO TO 2105-VOID-MASTERS-LOOP.
  7329
  7330 2105-VOID-COMPLETE.
  7331     MOVE 0000                   TO EMI-ERROR.
  7332     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7333     SET PINDX ANDX TO 1.
  7334
  7335 2110-FORMAT-LOOP.
  7336     IF PI-BATCH (PINDX) NOT = SPACES
  7337         MOVE PI-BATCH  (PINDX)  TO BATCH  (ANDX)
  7338         MOVE PI-NOBILL (PINDX)  TO NOBILL (ANDX)
  7339         MOVE PI-BILLED (PINDX)  TO BILL   (ANDX)
  7340         SET ANDX PINDX UP BY 1
  7341         IF PINDX > 6
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 143
* EL640.cbl
  7342             NEXT SENTENCE
  7343         ELSE
  7344             GO TO 2110-FORMAT-LOOP.
  7345
  7346     MOVE -1                     TO AACCTL.
  7347
  7348     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 144
* EL640.cbl
  7350 2200-VOID-PYAJ.
  7351     PERFORM 4500-PYAJ-START-BROWSE THRU 4590-EXIT.
  7352
  7353     IF PYAJ-EOF
  7354         GO TO 2290-EXIT.
  7355
  7356 2210-VOID-PYAJ-LOOP.
  7357     PERFORM 4600-PYAJ-READ-NEXT THRU 4690-EXIT.
  7358
  7359     IF PYAJ-EOF
  7360         PERFORM 4800-PYAJ-END-BROWSE
  7361         GO TO 2290-EXIT.
  7362
  7363     IF PY-COMPANY-CD = PI-COMPANY-CD      AND
  7364        PY-CARRIER    = ERPYAJ-BR-CARRIER  AND
  7365        PY-GROUPING   = ERPYAJ-BR-GROUPING AND
  7366        PY-FIN-RESP   = PI-SAV-REMIT-TO    AND
  7367        PY-ACCOUNT    = PI-SAV-ACCT
  7368         NEXT SENTENCE
  7369     ELSE
  7370         PERFORM 4800-PYAJ-END-BROWSE
  7371         GO TO 2290-EXIT.
  7372
  7373     IF (PY-BILLED-DATE = LOW-VALUES AND
  7374            PY-AR-DATE = LOW-VALUES)
  7375       OR PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  7376         GO TO 2210-VOID-PYAJ-LOOP.
  7377
  7378     PERFORM 4800-PYAJ-END-BROWSE.
  7379
  7380     PERFORM 4700-PYAJ-REWRITE THRU 4790-EXIT.
  7381
  7382     MOVE 'Y'                    TO DATA-VOIDED-SW.
  7383     ADD +1 TO ERPYAJ-FILE-SEQ-NO.
  7384
  7385     GO TO 2200-VOID-PYAJ.
  7386
  7387 2290-EXIT.
  7388     EXIT.
  7389
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 145
* EL640.cbl
  7391
  7392 3000-WRITE-BILLING-DETAIL.
  7393
  7394*                *******************************************
  7395*                *  FORMATS THE BILLING DETAIL RECORDS.    *
  7396*                *  THESE RECORDS ARE CREATED IN THE       *
  7397*                *  SAME FORMAT THAT THEY WILL APPEAR      *
  7398*                *  WHEN PRINTED.                          *
  7399*                *******************************************
  7400
  7401     IF CARRIER-ADDRESS  OR
  7402        GEN-AGT-ADDRESS
  7403          PERFORM 3930-BILL-READ THRU 3930-EXIT
  7404         IF NO-BILL-RECS
  7405             GO TO 3200-FORMAT-HDR-ADDR-RECS
  7406         ELSE
  7407             IF BI-PREVIEW-ONLY
  7408               OR BI-INITIAL-PRINT-DATE NOT = LOW-VALUES
  7409               OR PI-TOT-REBILL
  7410                 PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  7411                 GO TO 3200-FORMAT-HDR-ADDR-RECS
  7412             ELSE
  7413                 MOVE ER-2403    TO EMI-ERROR
  7414                 MOVE -1         TO ABILTYPL
  7415                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7416                 GO TO 3990-EXIT.
  7417
  7418     IF TOTAL-STATEMENT
  7419         GO TO 3400-FORMAT-TOTAL-LINES.
  7420
  7421 3100-FORMAT-DETAIL-LINES.
  7422     IF PI-PREM (PINDX) NOT NUMERIC
  7423        MOVE ZEROS               TO PI-PREM (PINDX).
  7424     IF PI-COMM (PINDX) NOT NUMERIC
  7425        MOVE ZEROS               TO PI-COMM (PINDX).
  7426
  7427     IF WS-LINECTR > 23
  7428         MOVE ZEROS              TO WS-LINECTR
  7429         MOVE '3'                TO BI-RECORD-TYPE
  7430         MOVE TRIPLE-SPACE       TO BI-SKIP-CONTROL
  7431         MOVE '          CONTINUED ON NEXT PAGE'
  7432                                 TO BI-TEXT-LINE
  7433         PERFORM 3920-BILL-WRITE
  7434         PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7435
  7436     IF WS-LINECTR = ZEROS
  7437         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7438     ELSE
  7439         MOVE SINGLE-SPACE       TO BI-SKIP-CONTROL
  7440     END-IF.
  7441
  7442     MOVE '3'                    TO BI-RECORD-TYPE.
  7443
  7444     IF BILLING-DETAIL-TYPE = 'BP'
  7445        IF PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT
  7446             MOVE PY-ENTRY-COMMENT   TO BI-TEXT-LINE
  7447             MULTIPLY PY-ENTRY-AMT   BY -1
  7448                              GIVING BI-TOT-PREM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 146
* EL640.cbl
  7449             MOVE '* ACCOUNTING ENTRY *'  TO BI-TOT-DESC
  7450             ADD +1 TO WS-LINECTR
  7451             PERFORM 3920-BILL-WRITE
  7452             GO TO 3990-EXIT.
  7453
  7454     IF BILLING-DETAIL-TYPE = 'BP'
  7455         MOVE PY-ENTRY-COMMENT   TO BI-TEXT-LINE
  7456         MOVE PY-ENTRY-AMT       TO BI-TOT-PREM
  7457         MOVE '* ACCOUNTING ENTRY *'  TO BI-TOT-DESC
  7458         ADD +1 TO WS-LINECTR
  7459         PERFORM 3920-BILL-WRITE
  7460         GO TO 3990-EXIT.
  7461
  7462     MOVE SPACES                 TO BI-TEXT-LINE.
  7463
  7464     IF PB-ISSUE
  7465        NEXT SENTENCE
  7466     ELSE
  7467        GO TO 3110-FORMAT-DETAIL-CANCEL.
  7468
  7469     MOVE PB-I-INSURED-FIRST-NAME    TO BI-INS-1ST-NAME.
  7470     MOVE PB-I-INSURED-MIDDLE-INIT   TO BI-INS-INIT.
  7471
  7472     IF PI-COMPANY-ID = 'DMD' AND
  7473        PB-ISSUE
  7474        MOVE PB-SV-STATE             TO BI-UNDRWRTR.
  7475
  7476     MOVE PB-I-INSURED-LAST-NAME     TO BI-INS-LAST-NAME.
  7477     MOVE PB-CERT-NO                 TO BI-CERT.
  7478     MOVE PB-I-LF-TERM               TO BI-ED-TERM  BI-TERM.
  7479     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
  7480     MOVE SPACE                      TO DC-OPTION-CODE.
  7481     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7482     MOVE DC-GREG-DATE-1-EDIT        TO BI-EFF-DT.
  7483
  7484     IF PI-COMPANY-ID = 'DMD' AND
  7485        PB-ISSUE  AND
  7486        NOT PB-INVALID-LIFE
  7487          MOVE PB-I-LF-BENEFIT-CD    TO WS-BENE-CD
  7488          MOVE WS-BENEFIT            TO PB-I-LF-ABBR.
  7489
  7490     IF NOT PB-INVALID-LIFE
  7491        MOVE PB-I-LF-ABBR            TO BI-TYPE
  7492        MOVE WS-I-LF-PREMIUM-AMT     TO BI-PREM
  7493                                        BI-PREMIUM-AMT
  7494        ADD WS-I-LF-PREMIUM-AMT      TO TOT-REPT-LF-PREM
  7495        MULTIPLY PB-I-LIFE-COMMISSION BY 100 GIVING BI-ED-RATE
  7496        MOVE PB-I-LIFE-COMMISSION    TO BI-RATE
  7497        MOVE PI-LF-ISS-COMP          TO BI-COMM
  7498        ADD  PI-LF-ISS-COMP          TO TOT-REPT-LF-COMP
  7499        MOVE WS-I-LF-BENEFIT-AMT     TO BI-FACE-AMT
  7500                                        BI-BENEFIT-AMT
  7501        ADD WS-I-LF-BENEFIT-AMT      TO TOT-LF-REPT-FACE-AMT
  7502        ADD WS-I-LF-PREMIUM-AMT      TO  PI-PREM (PINDX)
  7503        ADD PI-LF-ISS-COMP           TO  PI-COMM (PINDX)
  7504        PERFORM 3920-BILL-WRITE
  7505        ADD +1 TO WS-LINECTR
  7506        MOVE SINGLE-SPACE            TO BI-SKIP-CONTROL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 147
* EL640.cbl
  7507        MOVE SPACES                  TO BI-TEXT-LINE.
  7508
  7509     IF PI-COMPANY-ID = 'DMD' AND
  7510        PB-ISSUE  AND
  7511        NOT PB-INVALID-AH
  7512          MOVE PB-I-AH-BENEFIT-CD    TO WS-BENE-CD
  7513          MOVE WS-BENEFIT            TO PB-I-AH-ABBR.
  7514
  7515     IF NOT PB-INVALID-AH
  7516        MOVE PB-I-AH-ABBR            TO BI-TYPE
  7517        MOVE WS-I-AH-PREMIUM-AMT     TO BI-PREM
  7518                                        BI-PREMIUM-AMT
  7519        ADD WS-I-AH-PREMIUM-AMT      TO TOT-REPT-AH-PREM
  7520        MULTIPLY PB-I-AH-COMMISSION BY 100 GIVING BI-ED-RATE
  7521        MOVE PB-I-AH-COMMISSION      TO BI-RATE
  7522        MOVE PI-AH-ISS-COMP          TO BI-COMM
  7523        ADD PI-AH-ISS-COMP           TO TOT-REPT-AH-COMP
  7524        MOVE WS-I-AH-BENEFIT-AMT     TO BI-FACE-AMT
  7525        ADD WS-I-AH-BENEFIT-AMT      TO TOT-AH-REPT-FACE-AMT
  7526        ADD WS-I-AH-PREMIUM-AMT      TO  PI-PREM (PINDX)
  7527        ADD PI-AH-ISS-COMP           TO  PI-COMM (PINDX)
  7528        PERFORM 3920-BILL-WRITE
  7529        MOVE SINGLE-SPACE            TO BI-SKIP-CONTROL
  7530        ADD +1                       TO WS-LINECTR.
  7531
  7532     GO TO 3990-EXIT.
  7533
  7534 3110-FORMAT-DETAIL-CANCEL.
  7535     MOVE PB-CI-LAST-NAME            TO BI-INS-LAST-NAME.
  7536     MOVE PB-CI-INITIALS             TO BI-INS-INITS.
  7537
  7538     IF PI-COMPANY-ID = 'DMD' AND
  7539        PB-CANCELLATION
  7540        MOVE PB-SV-STATE             TO BI-UNDRWRTR.
  7541
  7542     MOVE PB-CERT-NO                 TO BI-CERT.
  7543     MOVE PB-CI-LF-TERM              TO BI-ED-TERM
  7544                                        BI-TERM.
  7545     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
  7546     MOVE SPACE                      TO DC-OPTION-CODE.
  7547     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7548     MOVE DC-GREG-DATE-1-EDIT        TO BI-EFF-DT.
  7549
  7550     IF PI-COMPANY-ID = 'DMD' AND
  7551        PB-CANCELLATION AND
  7552        PB-CI-LF-ABBR > SPACES
  7553          MOVE PB-CI-LF-BENEFIT-CD   TO WS-BENE-CD
  7554          MOVE WS-BENEFIT            TO PB-CI-LF-ABBR.
  7555
  7556     IF PB-CI-LF-ABBR > SPACES
  7557         MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
  7558         MOVE SPACE                  TO DC-OPTION-CODE
  7559         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7560         MOVE DC-GREG-DATE-1-EDIT    TO BI-CAN-DT
  7561         MOVE PB-CI-LF-ABBR          TO BI-TYPE
  7562         MOVE WS-C-LF-CANCEL-AMT     TO BI-PREMIUM-AMT
  7563         MULTIPLY WS-C-LF-CANCEL-AMT BY -1 GIVING WORK-AMT
  7564         MOVE WORK-AMT               TO BI-PREM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 148
* EL640.cbl
  7565         ADD WS-C-LF-CANCEL-AMT      TO TOT-REPT-LF-REF
  7566         ADD WORK-AMT                TO TOT-REPT-LF-PREM
  7567                                        PI-PREM (PINDX)
  7568         MULTIPLY PB-CI-LIFE-COMMISSION
  7569                                     BY 100 GIVING BI-ED-RATE
  7570         MOVE PB-CI-LIFE-COMMISSION  TO BI-RATE
  7571         IF WS-CHARGEBACK-LF-SW = 'N'
  7572             MOVE  ZEROS                 TO PI-LF-CAN-COMP
  7573             MOVE PI-LF-CAN-COMP         TO BI-COMM
  7574             ADD PI-LF-CAN-COMP          TO TOT-REPT-LF-COMP
  7575                                            PI-COMM (PINDX)
  7576             COMPUTE TOT-REPT-LF-COMP-R =
  7577               TOT-REPT-LF-COMP-R + (PI-LF-CAN-COMP * -1)
  7578             MOVE WS-CI-LIFE-BENEFIT     TO BI-BENEFIT-AMT
  7579             ADD +1                      TO WS-LINECTR
  7580             PERFORM 3920-BILL-WRITE
  7581             MOVE SPACES                 TO BI-TEXT-LINE
  7582         ELSE
  7583             MOVE PI-LF-CAN-COMP         TO BI-COMM
  7584             ADD PI-LF-CAN-COMP          TO TOT-REPT-LF-COMP
  7585                                            PI-COMM (PINDX)
  7586             COMPUTE TOT-REPT-LF-COMP-R =
  7587               TOT-REPT-LF-COMP-R + (PI-LF-CAN-COMP * -1)
  7588             MOVE  ZEROS                 TO PI-LF-CAN-COMP
  7589             MOVE WS-CI-LIFE-BENEFIT     TO BI-BENEFIT-AMT
  7590             ADD +1                      TO WS-LINECTR
  7591             PERFORM 3920-BILL-WRITE
  7592             MOVE SPACES                 TO BI-TEXT-LINE.
  7593
  7594     IF PI-COMPANY-ID = 'DMD' AND
  7595        PB-CANCELLATION AND
  7596        PB-CI-AH-ABBR > SPACES
  7597          MOVE PB-CI-AH-BENEFIT-CD   TO WS-BENE-CD
  7598          MOVE WS-BENEFIT            TO PB-CI-AH-ABBR.
  7599
  7600     IF PB-CI-AH-ABBR > SPACES
  7601         MOVE PB-C-AH-CANCEL-DT      TO DC-BIN-DATE-1
  7602         MOVE SPACE                  TO DC-OPTION-CODE
  7603         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7604         MOVE DC-GREG-DATE-1-EDIT    TO BI-CAN-DT
  7605         MOVE PB-CI-AH-ABBR          TO BI-TYPE
  7606         MOVE WS-C-AH-CANCEL-AMT     TO BI-PREMIUM-AMT
  7607         MULTIPLY WS-C-AH-CANCEL-AMT BY -1 GIVING WORK-AMT
  7608         MOVE WORK-AMT               TO BI-PREM
  7609         ADD WS-C-AH-CANCEL-AMT      TO TOT-REPT-AH-REF
  7610         ADD WORK-AMT                TO TOT-REPT-AH-PREM
  7611                                        PI-PREM (PINDX)
  7612         MULTIPLY PB-CI-AH-COMMISSION BY 100 GIVING BI-ED-RATE
  7613         MOVE PB-CI-AH-COMMISSION    TO BI-RATE
  7614         IF WS-CHARGEBACK-AH-SW = 'N'
  7615             MOVE  ZEROS                 TO PI-AH-CAN-COMP
  7616             MOVE PI-AH-CAN-COMP         TO BI-COMM
  7617             ADD PI-AH-CAN-COMP          TO TOT-REPT-AH-COMP
  7618                                            PI-COMM (PINDX)
  7619             COMPUTE TOT-REPT-AH-COMP-R =
  7620               TOT-REPT-AH-COMP-R + (PI-AH-CAN-COMP * -1)
  7621             ADD +1                      TO WS-LINECTR
  7622             PERFORM 3920-BILL-WRITE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 149
* EL640.cbl
  7623         ELSE
  7624             MOVE PI-AH-CAN-COMP         TO BI-COMM
  7625             ADD PI-AH-CAN-COMP          TO TOT-REPT-AH-COMP
  7626                                            PI-COMM (PINDX)
  7627             COMPUTE TOT-REPT-AH-COMP-R =
  7628               TOT-REPT-AH-COMP-R + (PI-AH-CAN-COMP * -1)
  7629             MOVE  ZEROS                 TO PI-AH-CAN-COMP
  7630             ADD +1                      TO WS-LINECTR
  7631             PERFORM 3920-BILL-WRITE.
  7632
  7633     IF PB-CI-CANCEL-FEE NOT NUMERIC
  7634         MOVE ZEROS                      TO PB-CI-CANCEL-FEE.
  7635
  7636     IF PB-CI-CANCEL-FEE > ZEROS
  7637         MOVE SPACES                 TO BI-INS-LAST-NAME
  7638                                        BI-INS-INITS
  7639                                        BI-EFF-DT
  7640                                        BI-CAN-DT
  7641                                        BI-TYPE
  7642         MOVE 'CANCEL FEE'           TO BI-CERT
  7643         MOVE WORK-CANCEL-FEE        TO BI-PREM
  7644                                        BI-COMM
  7645         MOVE ZEROS                  TO BI-PREMIUM-AMT
  7646                                        BI-RATE
  7647                                        BI-ED-RATE
  7648                                        BI-ED-TERM
  7649                                        BI-TERM
  7650         ADD +1                      TO WS-LINECTR
  7651         PERFORM 3920-BILL-WRITE.
  7652
  7653     GO TO 3990-EXIT.
  7654
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 150
* EL640.cbl
  7656
  7657 3200-FORMAT-HDR-ADDR-RECS.
  7658     PERFORM 3910-BILL-GETMAIN.
  7659
  7660     MOVE ZEROS                  TO WS-LINE-SEQ-NO.
  7661     SET A-INDX  R-INDX          TO 1.
  7662     PERFORM 3210-FORMAT-ADDR-RECS  THRU 3210-EXIT 6 TIMES.
  7663     MOVE ZEROS                  TO WS-LINE-SEQ-NO.
  7664     PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7665     GO TO 3990-EXIT.
  7666
  7667 3210-FORMAT-ADDR-RECS.
  7668     MOVE '2'                     TO BI-RECORD-TYPE.
  7669     MOVE WS-ACCT-LINES (A-INDX)  TO BI-ACCT-ADDRESS-LINE.
  7670     MOVE WS-REMIT-LINES (R-INDX) TO BI-REMIT-ADDRESS-LINE.
  7671     PERFORM 3920-BILL-WRITE.
  7672     SET A-INDX  R-INDX         UP BY 1.
  7673
  7674 3210-EXIT.
  7675     EXIT.
  7676
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 151
* EL640.cbl
  7678 3300-FORMAT-HEADINGS.
  7679     MOVE WS-PGECTR              TO BI-HD-PG.
  7680     ADD +1                      TO WS-PGECTR.
  7681     MOVE '3'                    TO BI-RECORD-TYPE.
  7682     MOVE TOP-OF-PAGE            TO BI-SKIP-CONTROL.
  7683
  7684     IF NOT PI-PREVIEW
  7685         MOVE BI-HD1             TO BI-TEXT-LINE
  7686     ELSE
  7687         MOVE BI-PREVIEW-HD      TO BI-TEXT-LINE
  7688         PERFORM 3920-BILL-WRITE
  7689         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7690         MOVE BI-HD1             TO BI-TEXT-LINE.
  7691
  7692     PERFORM 3920-BILL-WRITE.
  7693     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7694     MOVE BI-HD2                 TO BI-TEXT-LINE.
  7695     PERFORM 3920-BILL-WRITE.
  7696     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7697     MOVE BI-HD3                 TO BI-TEXT-LINE.
  7698     PERFORM 3920-BILL-WRITE.
  7699     SET A-INDX  R-INDX          TO 1.
  7700     PERFORM 3390-FORMAT-ADDR-TEXT-LINES THRU 3390-EXIT 5 TIMES.
  7701     MOVE '3'                    TO BI-RECORD-TYPE.
  7702     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7703     MOVE BI-HD4                 TO BI-TEXT-LINE.
  7704     PERFORM 3920-BILL-WRITE.
  7705     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7706     MOVE BI-HD5                 TO BI-TEXT-LINE.
  7707     PERFORM 3920-BILL-WRITE.
  7708
  7709 3380-EXIT.
  7710     EXIT.
  7711
  7712 3390-FORMAT-ADDR-TEXT-LINES.
  7713     MOVE '3'                    TO BI-RECORD-TYPE.
  7714     MOVE SPACES                 TO BI-TEXT-LINE.
  7715
  7716     IF A-INDX = 1
  7717         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7718         MOVE 'ACCOUNT NO. - '   TO BI-ADDR-LIT
  7719         MOVE WS-CARR-COMP       TO BI-CO
  7720         MOVE '-'                TO BI-DASH
  7721         MOVE PI-SAV-ACCT        TO BI-ACCT
  7722         MOVE 'REMIT TO - '      TO BI-REMIT-LIT
  7723     ELSE
  7724         MOVE SINGLE-SPACE       TO BI-SKIP-CONTROL.
  7725
  7726     MOVE WS-ACCT-LINES (A-INDX)  TO BI-ACCT-ADDR.
  7727     MOVE WS-REMIT-LINES (R-INDX) TO BI-REMIT-ADDR.
  7728     PERFORM 3920-BILL-WRITE.
  7729     SET A-INDX  R-INDX  UP BY 1.
  7730
  7731 3390-EXIT.
  7732     EXIT.
  7733
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 152
* EL640.cbl
  7735 3400-FORMAT-TOTAL-LINES.
  7736     COMPUTE PI-END-BAL = PI-BAL-FRWD +
  7737                          PI-PREMIUM +
  7738                          TOT-REPT-CANCEL-FEE -
  7739                          PI-REMITTED -
  7740                          PI-TOT-ISS-COMP +
  7741                          PI-TOT-CAN-COMP +
  7742                          PI-ADJUSTMENTS +
  7743                          PI-DISBURSED.
  7744
  7745     MOVE SPACES                 TO BI-TEXT-LINE.
  7746
  7747     MOVE '1'                    TO BI-RECORD-TYPE.
  7748     MOVE PI-PROCESSOR-ID        TO BI-PROCESSOR-CD.
  7749
  7750     IF PI-PREV-BILL OR PI-PREV-REBILL
  7751         MOVE 'P'                TO BI-STATEMENT-TYPE.
  7752
  7753     MOVE +1                     TO BI-NO-OF-COPIES.
  7754     MOVE WS-CURRENT-DATE        TO BI-CREATION-DT.
  7755     MOVE LOW-VALUES             TO BI-INITIAL-PRINT-DATE.
  7756     MOVE PI-BAL-FRWD            TO BI-BAL-FRWD.
  7757     MOVE PI-PREMIUM             TO BI-PREMIUM.
  7758     MOVE PI-REMITTED            TO BI-REMITTED.
  7759     MOVE PI-TOT-ISS-COMP        TO BI-TOT-ISS-COMP.
  7760     MOVE PI-TOT-CAN-COMP        TO BI-TOT-CAN-COMP.
  7761     MOVE PI-ADJUSTMENTS         TO BI-ADJUSTMNTS.
  7762     MOVE PI-DISBURSED           TO BI-DISBURSED.
  7763     MOVE PI-END-BAL             TO BI-END-BAL.
  7764
  7765     IF PI-SAV-ACCT = PI-SAV-REMIT-TO
  7766         MOVE WS-ACCT-LINES (1)  TO BI-FIN-RESP-NAME
  7767     ELSE
  7768         MOVE WS-REMIT-LINES (1) TO BI-FIN-RESP-NAME.
  7769
  7770     PERFORM 3920-BILL-WRITE.
  7771
  7772     IF WS-LINECTR > 16
  7773         MOVE ZEROS              TO WS-LINECTR
  7774         MOVE '3'                TO BI-RECORD-TYPE
  7775         MOVE TRIPLE-SPACE       TO BI-SKIP-CONTROL
  7776         MOVE '          CONTINUED ON NEXT PAGE'
  7777                                 TO BI-TEXT-LINE
  7778         PERFORM 3920-BILL-WRITE
  7779         PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7780
  7781     IF PI-BAL-FRWD NOT = ZERO
  7782         MOVE SPACES             TO BI-TEXT-LINE
  7783         MOVE '3'                TO BI-RECORD-TYPE
  7784         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7785         MOVE 'BALANCE FORWARD'  TO BI-TOT-DESC
  7786         MOVE PI-BAL-FRWD        TO BI-TOT-PREM
  7787         PERFORM 3920-BILL-WRITE.
  7788
  7789     IF PI-PREMIUM NOT = ZERO
  7790         MOVE SPACES             TO BI-TEXT-LINE
  7791         MOVE '3'                TO BI-RECORD-TYPE
  7792         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 153
* EL640.cbl
  7793         MOVE 'THIS MONTHS PREMIUM'  TO BI-TOT-DESC
  7794         COMPUTE WORK-AMT  =  TOT-REPT-CANCEL-FEE + PI-PREMIUM
  7795         MOVE WORK-AMT           TO BI-TOT-PREM
  7796         PERFORM 3920-BILL-WRITE.
  7797
  7798     IF PI-TOT-ISS-COMP NOT = ZEROS  OR
  7799        PI-TOT-CAN-COMP NOT = ZEROS
  7800         MOVE SPACES             TO BI-TEXT-LINE
  7801         MOVE '3'                TO BI-RECORD-TYPE
  7802         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7803         MOVE 'LESS COMPENSATION' TO BI-TOT-DESC
  7804         SUBTRACT PI-TOT-CAN-COMP FROM PI-TOT-ISS-COMP
  7805                          GIVING BI-TOT-PREM
  7806         PERFORM 3920-BILL-WRITE.
  7807
  7808     IF PI-REMITTED  NOT = ZEROS  OR
  7809        PI-DISBURSED NOT = ZEROS
  7810         MOVE SPACES             TO BI-TEXT-LINE
  7811         MOVE '3'                TO BI-RECORD-TYPE
  7812         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7813         MOVE 'LESS PAYMENTS'    TO BI-TOT-DESC
  7814         IF PI-COMPANY-ID = 'UCL'
  7815             SUBTRACT PI-DISBURSED FROM PI-REMITTED
  7816                      GIVING BI-TOT-PREM
  7817             PERFORM 3920-BILL-WRITE
  7818           ELSE
  7819             MOVE PI-REMITTED        TO BI-TOT-PREM
  7820             PERFORM 3920-BILL-WRITE.
  7821
  7822     IF PI-ADJUSTMENTS NOT = ZERO
  7823         MOVE SPACES             TO BI-TEXT-LINE
  7824         MOVE '3'                TO BI-RECORD-TYPE
  7825         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7826         MOVE 'ADJUSTMENT'       TO BI-TOT-DESC
  7827         ADD PI-ADJUSTMENTS, PI-DISBURSED GIVING BI-TOT-PREM
  7828         PERFORM 3920-BILL-WRITE.
  7829
  7830     MOVE SPACES                 TO BI-TEXT-LINE.
  7831     MOVE '3'                    TO BI-RECORD-TYPE.
  7832     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7833     MOVE ALL '-'                TO BI-TOT-DASH.
  7834     PERFORM 3920-BILL-WRITE.
  7835
  7836     MOVE SPACES                 TO BI-TEXT-LINE.
  7837     MOVE '3'                    TO BI-RECORD-TYPE.
  7838     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7839
  7840     IF PI-END-BAL < +1.00 AND > -1.00
  7841         NEXT SENTENCE
  7842     ELSE
  7843         IF PI-END-BAL < +0
  7844             MOVE 'WE WILL REFUND' TO BI-TOT-DESC
  7845         ELSE
  7846             MOVE 'PLEASE REMIT' TO BI-TOT-DESC.
  7847
  7848     MOVE PI-END-BAL             TO BI-TOT-PREM.
  7849
  7850     PERFORM 3920-BILL-WRITE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 154
* EL640.cbl
  7851
  7852     IF CO-CARRY-BALANCE
  7853         IF PI-END-BAL > +1.00
  7854             MOVE SPACES         TO BI-TEXT-LINE
  7855             MOVE '3'            TO BI-RECORD-TYPE
  7856             MOVE DOUBLE-SPACE   TO BI-SKIP-CONTROL
  7857             MOVE 'PLEASE RETURN ONE COPY WITH REMITTANCE'
  7858                                 TO BI-TEXT-LINE
  7859             PERFORM 3920-BILL-WRITE.
  7860
  7861     IF PI-COMPANY-ID = 'DMD'
  7862        MOVE SPACES                 TO BI-TEXT-LINE
  7863        MOVE '3'                    TO BI-RECORD-TYPE
  7864        MOVE '0'                    TO BI-SKIP-CONTROL
  7865        MOVE BI-HD6                 TO BI-TEXT-LINE
  7866        PERFORM 3920-BILL-WRITE
  7867        MOVE SPACES                 TO BI-TEXT-LINE
  7868        MOVE ' '                    TO BI-SKIP-CONTROL
  7869        MOVE BI-HD7                 TO BI-TEXT-LINE
  7870        PERFORM 3920-BILL-WRITE
  7871
  7872        PERFORM 3600-FIND-BATCH-NUMBER THRU 3699-EXIT
  7873          VARYING PINDX FROM 1 BY 1
  7874            UNTIL PINDX > +6.
  7875
  7876     MOVE ZEROS                  TO PI-PREM     (PINDX)
  7877                                    PI-COMM     (PINDX)
  7878                                    PI-NON-PREM (PINDX)
  7879                                    PI-NON-COMM (PINDX).
  7880
  7881     GO TO 3990-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 155
* EL640.cbl
  7883
  7884 3500-TOTAL-OUT-DETAIL.
  7885     IF PI-DATA-BILLED AND
  7886        RETURNED-FROM = SPACES
  7887           NEXT SENTENCE
  7888       ELSE
  7889           GO TO 3599-EXIT.
  7890
  7891     IF PI-UPDATE-FILES  OR
  7892        (PI-PREVIEW AND APRODSWI = 'Y')
  7893           NEXT SENTENCE
  7894        ELSE
  7895           GO TO 3599-EXIT.
  7896
  7897     MOVE SPACES                 TO BI-TEXT-LINE.
  7898*    MOVE '3'                    TO BI-RECORD-TYPE.
  7899*    MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7900*    MOVE 'TOTAL'                TO BI-TOT-LIT.
  7901*    MOVE PI-LIFE-OVERRIDE-L6    TO BI-OVERRIDE-L6.
  7902*    MOVE TOT-REPT-LF-PREM       TO BI-TOT-PREM.
  7903*    MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT.
  7904*    MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  7905*    PERFORM 3920-BILL-WRITE.
  7906*
  7907*    MOVE SPACES                 TO BI-TEXT-LINE.
  7908*    MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7909*    MOVE 'TOTAL'                TO BI-TOT-LIT.
  7910*    MOVE PI-AH-OVERRIDE-L6      TO BI-OVERRIDE-L6.
  7911*    MOVE TOT-REPT-AH-PREM       TO BI-TOT-PREM
  7912*    MOVE TOT-REPT-AH-COMP       TO BI-COM-TOT.
  7913*    MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  7914*    PERFORM 3920-BILL-WRITE.
  7915
  7916     MOVE SPACES                 TO BI-TEXT-LINE.
  7917     MOVE '3'                    TO BI-RECORD-TYPE.
  7918     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7919     MOVE 'TOTAL PREM '          TO BI-TOT-DESC
  7920     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  7921     ADD TOT-REPT-LF-REF TOT-REPT-LF-PREM
  7922          GIVING BI-TOT-PREM
  7923     ADD TOT-REPT-LF-COMP TOT-REPT-LF-COMP-R
  7924          GIVING BI-COM-TOT
  7925*    MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT.
  7926*    MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  7927     PERFORM 3920-BILL-WRITE.
  7928
  7929     MOVE SPACES                 TO BI-TEXT-LINE.
  7930     MOVE '3'                    TO BI-RECORD-TYPE.
  7931     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7932     MOVE 'TOTAL REF  '          TO BI-TOT-DESC
  7933     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  7934     MOVE TOT-REPT-LF-REF        TO BI-TOT-PREM.
  7935     MOVE TOT-REPT-LF-COMP-R     TO BI-COM-TOT
  7936     PERFORM 3920-BILL-WRITE.
  7937
  7938     MOVE SPACES                 TO BI-TEXT-LINE.
  7939     MOVE '3'                    TO BI-RECORD-TYPE.
  7940     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 156
* EL640.cbl
  7941     MOVE 'TOTAL NET  '          TO BI-TOT-DESC
  7942     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  7943     MOVE TOT-REPT-LF-PREM       TO BI-TOT-PREM
  7944     MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT
  7945     MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  7946     PERFORM 3920-BILL-WRITE.
  7947
  7948     MOVE SPACES                 TO BI-TEXT-LINE.
  7949     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7950     MOVE 'TOTAL PREM '          TO BI-TOT-DESC
  7951     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  7952     ADD TOT-REPT-AH-REF TOT-REPT-AH-PREM
  7953          GIVING BI-TOT-PREM
  7954     ADD TOT-REPT-AH-COMP TOT-REPT-AH-COMP-R
  7955          GIVING BI-COM-TOT
  7956*    MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  7957     PERFORM 3920-BILL-WRITE.
  7958
  7959     MOVE SPACES                 TO BI-TEXT-LINE.
  7960     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7961     MOVE 'TOTAL REF  '          TO BI-TOT-DESC
  7962     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  7963     MOVE TOT-REPT-AH-REF        TO BI-TOT-PREM
  7964     MOVE TOT-REPT-AH-COMP-R     TO BI-COM-TOT.
  7965     PERFORM 3920-BILL-WRITE.
  7966
  7967     MOVE SPACES                 TO BI-TEXT-LINE.
  7968     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7969     MOVE 'TOTAL NET  '          TO BI-TOT-DESC
  7970     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  7971     MOVE TOT-REPT-AH-PREM       TO BI-TOT-PREM
  7972     MOVE TOT-REPT-AH-COMP       TO BI-COM-TOT.
  7973     MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  7974     PERFORM 3920-BILL-WRITE.
  7975
  7976     IF PB-CI-CANCEL-FEE NOT NUMERIC
  7977         MOVE ZEROS  TO  PB-CI-CANCEL-FEE.
  7978
  7979     IF PB-CI-CANCEL-FEE > ZEROS
  7980         MOVE SPACES                 TO BI-TEXT-LINE
  7981         MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL
  7982         MOVE 'TOTAL'                TO BI-TOT-LIT
  7983         MOVE 'CAN-FE'               TO BI-OVERRIDE-L6
  7984         MOVE TOT-REPT-CANCEL-FEE    TO BI-TOT-PREM
  7985                                        BI-COM-TOT
  7986         MOVE ZEROS                  TO BI-FACE-TOT
  7987         PERFORM 3920-BILL-WRITE.
  7988
  7989     MOVE SPACES                 TO BI-TEXT-LINE.
  7990     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7991     PERFORM 3920-BILL-WRITE.
  7992
  7993 3599-EXIT.
  7994     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 157
* EL640.cbl
  7996
  7997 3600-FIND-BATCH-NUMBER.
  7998     IF PI-PREM (PINDX) NOT NUMERIC
  7999        MOVE ZEROS               TO PI-PREM (PINDX).
  8000     IF PI-COMM (PINDX) NOT NUMERIC
  8001        MOVE ZEROS               TO PI-COMM (PINDX).
  8002     IF PI-NON-PREM (PINDX) NOT NUMERIC
  8003        MOVE ZEROS               TO PI-NON-PREM (PINDX).
  8004     IF PI-NON-COMM (PINDX) NOT NUMERIC
  8005        MOVE ZEROS               TO PI-NON-COMM (PINDX).
  8006
  8007     IF PI-PREM (PINDX)     = ZEROS   AND
  8008        PI-COMM (PINDX)     = ZEROS   AND
  8009        PI-NON-PREM (PINDX) = ZEROS   AND
  8010        PI-NON-COMM (PINDX) = ZEROS
  8011          GO TO 3699-EXIT.
  8012
  8013     MOVE SPACES                 TO BI-TEXT-LINE.
  8014     MOVE '3'                    TO BI-RECORD-TYPE.
  8015     MOVE ' '                    TO BI-SKIP-CONTROL.
  8016     MOVE 'BATCH NO. '           TO WS-BATCH-DESC.
  8017     MOVE PI-BATCH (PINDX)       TO WS-BATCH-NBR.
  8018     MOVE WS-DESC                TO BI-TOT-DESC5.
  8019     MOVE PI-PREM (PINDX)        TO BI-TOT-PREM5.
  8020     MOVE PI-COMM (PINDX)        TO BI-COM-TOT5.
  8021     MOVE PI-NON-PREM (PINDX)    TO BI-NON-PREM5.
  8022     MOVE PI-NON-COMM (PINDX)    TO BI-NON-COMM5.
  8023     PERFORM 3920-BILL-WRITE.
  8024
  8025 3699-EXIT.
  8026     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 158
* EL640.cbl
  8028
  8029 3910-BILL-GETMAIN.
  8030
  8031* EXEC CICS GETMAIN
  8032*        SET     (ADDRESS OF BILLING-STATEMENT)
  8033*        LENGTH  (210)
  8034*        INITIMG (GETMAIN-SPACE)
  8035*    END-EXEC.
  8036     MOVE 210
  8037       TO DFHEIV11
  8038*    MOVE ',"IL                  $   #00007906' TO DFHEIV0
  8039     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8040     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8041     MOVE X'2020233030303037393036' TO DFHEIV0(25:11)
  8042     CALL 'kxdfhei1' USING DFHEIV0,
  8043           DFHEIV20,
  8044           DFHEIV11,
  8045           GETMAIN-SPACE
  8046     SET ADDRESS OF BILLING-STATEMENT TO
  8047         DFHEIV20
  8048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8049
  8050
  8051 3920-BILL-WRITE.
  8052     MOVE PI-COMPANY-CD          TO BI-COMPANY-CD.
  8053     MOVE PI-CR-CARRIER          TO BI-CARRIER.
  8054     MOVE PI-CR-GROUPING         TO BI-GROUPING
  8055     MOVE PI-SAV-ACCT            TO BI-ACCOUNT.
  8056     MOVE PI-SAV-REMIT-TO        TO BI-FIN-RESP.
  8057
  8058     MOVE 'BI'                   TO BI-RECORD-ID.
  8059     ADD +1                      TO WS-LINE-SEQ-NO.
  8060
  8061     IF BI-RECORD-TYPE = '1'
  8062         MOVE ZEROS              TO BI-LINE-SEQ-NO
  8063     ELSE
  8064         MOVE WS-LINE-SEQ-NO     TO BI-LINE-SEQ-NO.
  8065
  8066
  8067* EXEC CICS WRITE
  8068*        DATASET (ERBILL-FILE-ID)
  8069*        FROM    (BILLING-STATEMENT)
  8070*        RIDFLD  (BI-CONTROL-PRIMARY)
  8071*    END-EXEC.
  8072     MOVE LENGTH OF
  8073      BILLING-STATEMENT
  8074       TO DFHEIV11
  8075*    MOVE '&$ L                  ''   #00007927' TO DFHEIV0
  8076     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8077     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8078     MOVE X'2020233030303037393237' TO DFHEIV0(25:11)
  8079     CALL 'kxdfhei1' USING DFHEIV0,
  8080           ERBILL-FILE-ID,
  8081           BILLING-STATEMENT,
  8082           DFHEIV11,
  8083           BI-CONTROL-PRIMARY,
  8084           DFHEIV99,
  8085           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 159
* EL640.cbl
  8086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8087
  8088
  8089 3930-BILL-READ.
  8090     MOVE PI-COMPANY-CD          TO ERBILL-CO-CD.
  8091     MOVE PI-CR-CARRIER          TO ERBILL-CARRIER.
  8092     MOVE PI-CR-GROUPING         TO ERBILL-GROUP.
  8093     MOVE PI-SAV-ACCT            TO ERBILL-ACCT.
  8094     MOVE PI-SAV-REMIT-TO        TO ERBILL-FIN-RESP.
  8095     MOVE '1'                    TO ERBILL-REC-TYPE.
  8096     MOVE ZEROS                  TO ERBILL-LINE-SEQ-NO.
  8097
  8098
  8099* EXEC CICS HANDLE CONDITION
  8100*        NOTFND  (3930-BILL-NOTFND)
  8101*        NOTOPEN (3930-BILL-NOTOPEN)
  8102*    END-EXEC.
  8103*    MOVE '"$IJ                  ! $ #00007942' TO DFHEIV0
  8104     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8105     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8106     MOVE X'2420233030303037393432' TO DFHEIV0(25:11)
  8107     CALL 'kxdfhei1' USING DFHEIV0
  8108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8109
  8110
  8111
  8112* EXEC CICS READ
  8113*        SET     (ADDRESS OF BILLING-STATEMENT)
  8114*        DATASET (ERBILL-FILE-ID)
  8115*        RIDFLD  (ERBILL-KEY)
  8116*        GTEQ
  8117*    END-EXEC.
  8118*    MOVE '&"S        G          (   #00007947' TO DFHEIV0
  8119     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8120     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8121     MOVE X'2020233030303037393437' TO DFHEIV0(25:11)
  8122     CALL 'kxdfhei1' USING DFHEIV0,
  8123           ERBILL-FILE-ID,
  8124           DFHEIV20,
  8125           DFHEIV99,
  8126           ERBILL-KEY,
  8127           DFHEIV99,
  8128           DFHEIV99,
  8129           DFHEIV99
  8130     SET ADDRESS OF BILLING-STATEMENT TO
  8131         DFHEIV20
  8132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8133
  8134
  8135     IF BI-COMPANY-CD = PI-COMPANY-CD  AND
  8136        BI-CARRIER    = ERBILL-CARRIER AND
  8137        BI-GROUPING   = ERBILL-GROUP   AND
  8138        BI-ACCOUNT    = ERBILL-ACCT    AND
  8139        BI-FIN-RESP   = ERBILL-FIN-RESP
  8140          MOVE SPACE              TO NO-BILL-REC-SW
  8141          GO TO 3930-EXIT
  8142      ELSE
  8143          GO TO 3930-BILL-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 160
* EL640.cbl
  8144
  8145 3930-BILL-NOTOPEN.
  8146     MOVE ER-2564                TO EMI-ERROR.
  8147     MOVE -1 TO APFNTERL.
  8148     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8149     GO TO 8200-SEND-DATAONLY.
  8150
  8151 3930-BILL-NOTFND.
  8152     MOVE 'Y'                    TO NO-BILL-REC-SW.
  8153
  8154 3930-EXIT.
  8155     EXIT.
  8156
  8157 3940-BILL-GENERIC-DELETE.
  8158
  8159* EXEC CICS HANDLE CONDITION
  8160*        NOTFND (3940-EXIT)
  8161*    END-EXEC.
  8162*    MOVE '"$I                   ! % #00007977' TO DFHEIV0
  8163     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8164     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8165     MOVE X'2520233030303037393737' TO DFHEIV0(25:11)
  8166     CALL 'kxdfhei1' USING DFHEIV0
  8167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8168
  8169
  8170     MOVE PI-COMPANY-CD          TO ERBILL-CO-CD.
  8171     MOVE PI-CR-CARRIER          TO ERBILL-CARRIER.
  8172     MOVE PI-CR-GROUPING         TO ERBILL-GROUP.
  8173     MOVE PI-SAV-ACCT            TO ERBILL-ACCT.
  8174
  8175     IF ST-ACCNT-CNTL OR ACCNT-CNTL
  8176        MOVE ZEROS               TO ERBILL-CARRIER
  8177                                    ERBILL-GROUP.
  8178
  8179     IF CARR-ST-ACCNT-CNTL OR CARR-ACCNT-CNTL
  8180        MOVE ZEROS               TO ERBILL-GROUP.
  8181
  8182
  8183* EXEC CICS DELETE
  8184*        DATASET   (ERBILL-FILE-ID)
  8185*        RIDFLD    (ERBILL-KEY)
  8186*        KEYLENGTH (18)
  8187*        GENERIC
  8188*    END-EXEC.
  8189     MOVE 18
  8190       TO DFHEIV11
  8191*    MOVE '&(  RKG               &   #00007993' TO DFHEIV0
  8192     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  8193     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8194     MOVE X'2020233030303037393933' TO DFHEIV0(25:11)
  8195     CALL 'kxdfhei1' USING DFHEIV0,
  8196           ERBILL-FILE-ID,
  8197           ERBILL-KEY,
  8198           DFHEIV11,
  8199           DFHEIV99,
  8200           DFHEIV99
  8201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 161
* EL640.cbl
  8202
  8203
  8204 3940-EXIT.
  8205     EXIT.
  8206
  8207 3990-EXIT.
  8208     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 162
* EL640.cbl
  8210******************************************************************
  8211*                                                                *
  8212*   ALL I/O FOR THE VARIOUS FILES OTHER THAN THE COMPENSATION    *
  8213*   MASTER IS DONE IN THE FOLLOWING SECTIONS BEGINNING WITH 4XXX *
  8214*   WERE THE XXX INDICATES NUMERIC VALUES.                       *
  8215*                                                                *
  8216******************************************************************
  8217 4000-PNDB-START-BROWSE.
  8218     MOVE PI-COMPANY-CD          TO ERPNDB-CO-CD-A1.
  8219     MOVE PI-SAV-CARR            TO ERPNDB-CARR
  8220     MOVE PI-SAV-GROUP           TO ERPNDB-GROUP.
  8221     MOVE PI-SAV-STATE           TO ERPNDB-STATE.
  8222     MOVE PI-SAV-ACCT            TO ERPNDB-ACCT.
  8223     MOVE LOW-VALUES             TO ERPNDB-CERT.
  8224
  8225
  8226* EXEC CICS HANDLE CONDITION
  8227*        NOTFND (4010-REC-NOT-FND)
  8228*    END-EXEC.
  8229*    MOVE '"$I                   ! & #00008021' TO DFHEIV0
  8230     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8231     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8232     MOVE X'2620233030303038303231' TO DFHEIV0(25:11)
  8233     CALL 'kxdfhei1' USING DFHEIV0
  8234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8235
  8236
  8237
  8238* EXEC CICS STARTBR
  8239*        DATASET(ERPNDB-ALT-FILE-ID)
  8240*        RIDFLD (ERPNDB-ALT-KEY)
  8241*        GTEQ
  8242*    END-EXEC.
  8243     MOVE 0
  8244       TO DFHEIV11
  8245*    MOVE '&,         G          &   #00008025' TO DFHEIV0
  8246     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8247     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8248     MOVE X'2020233030303038303235' TO DFHEIV0(25:11)
  8249     CALL 'kxdfhei1' USING DFHEIV0,
  8250           ERPNDB-ALT-FILE-ID,
  8251           ERPNDB-ALT-KEY,
  8252           DFHEIV99,
  8253           DFHEIV11,
  8254           DFHEIV99
  8255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8256
  8257
  8258     GO TO 4090-EXIT.
  8259
  8260 4010-REC-NOT-FND.
  8261     MOVE 'Y'                    TO PNDB-EOF-SW.
  8262
  8263 4090-EXIT.
  8264     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 163
* EL640.cbl
  8266 4100-PNDB-READ-NEXT.
  8267
  8268* EXEC CICS HANDLE CONDITION
  8269*        ENDFILE (4110-END-OF-FILE)
  8270*    END-EXEC.
  8271*    MOVE '"$''                   ! '' #00008040' TO DFHEIV0
  8272     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8273     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8274     MOVE X'2720233030303038303430' TO DFHEIV0(25:11)
  8275     CALL 'kxdfhei1' USING DFHEIV0
  8276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8277
  8278
  8279
  8280* EXEC CICS READNEXT
  8281*        SET     (ADDRESS OF PENDING-BUSINESS)
  8282*        DATASET (ERPNDB-ALT-FILE-ID)
  8283*        RIDFLD  (ERPNDB-ALT-KEY)
  8284*    END-EXEC.
  8285     MOVE 0
  8286       TO DFHEIV11
  8287*    MOVE '&.S                   )   #00008044' TO DFHEIV0
  8288     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8289     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8290     MOVE X'2020233030303038303434' TO DFHEIV0(25:11)
  8291     CALL 'kxdfhei1' USING DFHEIV0,
  8292           ERPNDB-ALT-FILE-ID,
  8293           DFHEIV20,
  8294           DFHEIV99,
  8295           ERPNDB-ALT-KEY,
  8296           DFHEIV99,
  8297           DFHEIV11,
  8298           DFHEIV99,
  8299           DFHEIV99
  8300     SET ADDRESS OF PENDING-BUSINESS TO
  8301         DFHEIV20
  8302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8303
  8304
  8305     GO TO 4190-EXIT.
  8306
  8307 4110-END-OF-FILE.
  8308     MOVE 'Y'                    TO PNDB-EOF-SW.
  8309
  8310 4190-EXIT.
  8311     EXIT.
  8312
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 164
* EL640.cbl
  8314 4200-PNDB-REWRITE.
  8315     MOVE PB-COMPANY-CD          TO ERPNDB-CO-CD.
  8316     MOVE PB-ENTRY-BATCH         TO ERPNDB-BATCH.
  8317     MOVE PB-BATCH-SEQ-NO        TO ERPNDB-SEQ-NO.
  8318     MOVE PB-BATCH-CHG-SEQ-NO    TO ERPNDB-CHG-SEQ-NO.
  8319
  8320
  8321* EXEC CICS ENDBR
  8322*        DATASET (ERPNDB-ALT-FILE-ID)
  8323*    END-EXEC.
  8324     MOVE 0
  8325       TO DFHEIV11
  8326*    MOVE '&2                    $   #00008065' TO DFHEIV0
  8327     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8328     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8329     MOVE X'2020233030303038303635' TO DFHEIV0(25:11)
  8330     CALL 'kxdfhei1' USING DFHEIV0,
  8331           ERPNDB-ALT-FILE-ID,
  8332           DFHEIV11,
  8333           DFHEIV99
  8334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8335
  8336
  8337
  8338* EXEC CICS HANDLE CONDITION
  8339*        NOTFND   (4270-PNDB-NOTFIND)
  8340*        NOTOPEN  (4280-PNDB-FILE-NOTOPEN)
  8341*    END-EXEC.
  8342*    MOVE '"$IJ                  ! ( #00008069' TO DFHEIV0
  8343     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8345     MOVE X'2820233030303038303639' TO DFHEIV0(25:11)
  8346     CALL 'kxdfhei1' USING DFHEIV0
  8347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8348
  8349
  8350
  8351* EXEC CICS READ
  8352*        SET     (ADDRESS OF PENDING-BUSINESS)
  8353*        DATASET (ERPNDB-FILE-ID)
  8354*        RIDFLD  (ERPNDB-PRIME-KEY)
  8355*        UPDATE
  8356*    END-EXEC.
  8357*    MOVE '&"S        EU         (   #00008074' TO DFHEIV0
  8358     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8359     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8360     MOVE X'2020233030303038303734' TO DFHEIV0(25:11)
  8361     CALL 'kxdfhei1' USING DFHEIV0,
  8362           ERPNDB-FILE-ID,
  8363           DFHEIV20,
  8364           DFHEIV99,
  8365           ERPNDB-PRIME-KEY,
  8366           DFHEIV99,
  8367           DFHEIV99,
  8368           DFHEIV99
  8369     SET ADDRESS OF PENDING-BUSINESS TO
  8370         DFHEIV20
  8371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 165
* EL640.cbl
  8372
  8373
  8374     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  8375         MOVE 'R'                TO PB-BILLING-STATUS.
  8376
  8377     IF PI-VOID-BILL
  8378         MOVE LOW-VALUES         TO PB-BILLED-DT
  8379         MOVE ZEROS              TO PB-CHG-COUNT
  8380     ELSE
  8381         MOVE WS-CURRENT-DATE    TO PB-BILLED-DT.
  8382
  8383     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  8384     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  8385     MOVE WS-CURRENT-DATE        TO PB-LAST-MAINT-DT.
  8386
  8387
  8388* EXEC CICS REWRITE
  8389*        DATASET (ERPNDB-FILE-ID)
  8390*        FROM    (PENDING-BUSINESS)
  8391*    END-EXEC.
  8392     MOVE LENGTH OF
  8393      PENDING-BUSINESS
  8394       TO DFHEIV11
  8395*    MOVE '&& L                  %   #00008094' TO DFHEIV0
  8396     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8397     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8398     MOVE X'2020233030303038303934' TO DFHEIV0(25:11)
  8399     CALL 'kxdfhei1' USING DFHEIV0,
  8400           ERPNDB-FILE-ID,
  8401           PENDING-BUSINESS,
  8402           DFHEIV11,
  8403           DFHEIV99
  8404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8405
  8406
  8407
  8408* EXEC CICS STARTBR
  8409*        DATASET (ERPNDB-ALT-FILE-ID)
  8410*        RIDFLD  (ERPNDB-ALT-KEY)
  8411*        GTEQ
  8412*    END-EXEC.
  8413     MOVE 0
  8414       TO DFHEIV11
  8415*    MOVE '&,         G          &   #00008099' TO DFHEIV0
  8416     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8417     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8418     MOVE X'2020233030303038303939' TO DFHEIV0(25:11)
  8419     CALL 'kxdfhei1' USING DFHEIV0,
  8420           ERPNDB-ALT-FILE-ID,
  8421           ERPNDB-ALT-KEY,
  8422           DFHEIV99,
  8423           DFHEIV11,
  8424           DFHEIV99
  8425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8426
  8427
  8428     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  8429
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 166
* EL640.cbl
  8430     GO TO 4290-EXIT.
  8431
  8432 4270-PNDB-NOTFIND.
  8433     MOVE ER-2212                TO EMI-ERROR.
  8434     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8435     GO TO 4290-EXIT.
  8436
  8437 4280-PNDB-FILE-NOTOPEN.
  8438     MOVE -1                     TO ACARIERL.
  8439     MOVE ER-2210                TO EMI-ERROR.
  8440     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8441
  8442 4290-EXIT.
  8443     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 167
* EL640.cbl
  8445 4300-READ-ACCOUNT-MASTER.
  8446     MOVE PI-COMPANY-CD          TO ERACCT-A-CO-CD.
  8447     MOVE PI-SAV-CARR            TO ERACCT-A-CARRIER.
  8448     MOVE PI-SAV-GROUP           TO ERACCT-A-GROUPING.
  8449     MOVE PI-SAV-STATE           TO ERACCT-A-STATE.
  8450     MOVE PI-SAV-ACCT            TO ERACCT-A-ACCOUNT.
  8451     MOVE PI-SAV-EXP-DT          TO ERACCT-A-EXP-DATE.
  8452
  8453     MOVE SPACES                 TO WS-AM-ZIP.
  8454
  8455
  8456* EXEC CICS HANDLE CONDITION
  8457*        NOTFND   (4370-ACCOUNT-INVALID)
  8458*        NOTOPEN  (4380-ACCT-FILE-NOTOPEN)
  8459*    END-EXEC.
  8460*    MOVE '"$IJ                  ! ) #00008132' TO DFHEIV0
  8461     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8462     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8463     MOVE X'2920233030303038313332' TO DFHEIV0(25:11)
  8464     CALL 'kxdfhei1' USING DFHEIV0
  8465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8466
  8467
  8468
  8469* EXEC CICS READ
  8470*        DATASET   (ERACCT-ALT-FILE-ID)
  8471*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8472*        RIDFLD    (ERACCT-ALT-KEY)
  8473*        GTEQ
  8474*    END-EXEC.
  8475*    MOVE '&"S        G          (   #00008137' TO DFHEIV0
  8476     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8477     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8478     MOVE X'2020233030303038313337' TO DFHEIV0(25:11)
  8479     CALL 'kxdfhei1' USING DFHEIV0,
  8480           ERACCT-ALT-FILE-ID,
  8481           DFHEIV20,
  8482           DFHEIV99,
  8483           ERACCT-ALT-KEY,
  8484           DFHEIV99,
  8485           DFHEIV99,
  8486           DFHEIV99
  8487     SET ADDRESS OF ACCOUNT-MASTER TO
  8488         DFHEIV20
  8489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8490
  8491
  8492     IF AM-CANADIAN-POST-CODE
  8493         MOVE AM-CAN-POSTAL-1    TO WS-AM-CAN-POST-1
  8494         MOVE AM-CAN-POSTAL-2    TO WS-AM-CAN-POST-2
  8495     ELSE
  8496         MOVE AM-ZIP-PRIME       TO WS-AM-ZIP-PRIME
  8497         IF AM-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  8498             MOVE '-'            TO WS-AM-ZIP-DASH
  8499             MOVE AM-ZIP-PLUS4   TO WS-AM-ZIP-PLUS4.
  8500
  8501     IF AM-REMIT-TO NOT NUMERIC
  8502         MOVE +00 TO AM-REMIT-TO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 168
* EL640.cbl
  8503
  8504     IF AM-REMIT-TO = ZEROS
  8505         MOVE ER-2385            TO EMI-ERROR
  8506         MOVE -1                 TO AACCTL
  8507         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8508
  8509     MOVE AM-CARRIER             TO PI-CARRIER.
  8510     MOVE AM-GROUPING            TO PI-GROUPING.
  8511     MOVE AM-STATE               TO PI-STATE.
  8512     MOVE AM-ACCOUNT             TO PI-ACCOUNT.
  8513
  8514     MOVE AM-AGT (AM-REMIT-TO)   TO PI-COMP-FIN-RESP.
  8515
  8516     IF PI-ZERO-CARRIER  OR
  8517        PI-ZERO-CAR-GROUP
  8518         MOVE ZEROS              TO PI-COMP-CARRIER
  8519     ELSE
  8520         MOVE AM-CARRIER         TO PI-COMP-CARRIER.
  8521
  8522     IF PI-ZERO-GROUPING  OR
  8523        PI-ZERO-CAR-GROUP
  8524         MOVE ZEROS              TO PI-COMP-GROUPING
  8525     ELSE
  8526         MOVE AM-GROUPING        TO PI-COMP-GROUPING.
  8527
  8528     IF CARR-GROUP-ST-ACCNT-CNTL
  8529         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8530         MOVE AM-GROUPING        TO PI-CR-GROUPING
  8531         MOVE AM-STATE           TO PI-CR-STATE.
  8532
  8533     IF ST-ACCNT-CNTL
  8534         MOVE ZEROS              TO PI-CR-CARRIER
  8535                                    PI-CR-GROUPING
  8536         MOVE AM-STATE           TO PI-CR-STATE.
  8537
  8538     IF CARR-ST-ACCNT-CNTL
  8539         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8540         MOVE ZEROS              TO PI-CR-GROUPING
  8541         MOVE AM-STATE           TO PI-CR-STATE.
  8542
  8543     IF ACCNT-CNTL
  8544         MOVE ZEROS              TO PI-CR-CARRIER
  8545                                    PI-CR-GROUPING
  8546                                    PI-CR-STATE.
  8547
  8548     IF CARR-ACCNT-CNTL
  8549         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8550         MOVE ZEROS              TO PI-CR-GROUPING
  8551                                    PI-CR-STATE.
  8552
  8553     MOVE AM-EXPIRATION-DT       TO ERACCT-A-EXP-DATE.
  8554
  8555     IF AM-AGT (AM-REMIT-TO) = PI-SAV-ACCT
  8556         MOVE 'Y'                TO ACCOUNT-FIN-RESP-SW
  8557     ELSE
  8558         MOVE 'N'                TO ACCOUNT-FIN-RESP-SW.
  8559
  8560     IF PI-VOID-BILL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 169
* EL640.cbl
  8561         MOVE AM-EXPIRATION-DT   TO WS-SAV-EXP-DT (DTNDX)
  8562         IF DTNDX < 10
  8563             SET DTNDX UP BY 1
  8564             GO TO 4390-EXIT
  8565         ELSE
  8566             GO TO 4390-EXIT.
  8567
  8568     IF PI-COMPANY-CD = AM-COMPANY-CD-A1 AND
  8569        PI-SAV-CARR   = AM-VG-CARRIER    AND
  8570        PI-SAV-GROUP  = AM-VG-GROUPING   AND
  8571        PI-SAV-STATE  = AM-VG-STATE      AND
  8572        PI-SAV-ACCT   = AM-VG-ACCOUNT
  8573          NEXT SENTENCE
  8574     ELSE
  8575          GO TO 4370-ACCOUNT-INVALID.
  8576
  8577     IF PI-GA-BILLING
  8578         NEXT SENTENCE
  8579     ELSE
  8580         GO TO 4390-EXIT.
  8581
  8582     IF AM-AGT (AM-REMIT-TO) = PI-SAV-ACCT
  8583         MOVE 'Y'                TO ACCOUNT-FIN-RESP-SW
  8584     ELSE
  8585         MOVE 'N'                TO ACCOUNT-FIN-RESP-SW.
  8586
  8587     GO TO 4390-EXIT.
  8588
  8589 4370-ACCOUNT-INVALID.
  8590     MOVE -1                     TO AACCTL.
  8591
  8592     MOVE SPACES                 TO PI-CARRIER
  8593                                    PI-GROUPING
  8594                                    PI-STATE
  8595                                    PI-ACCOUNT.
  8596
  8597     IF CARR-GROUP-ST-ACCNT-CNTL
  8598         MOVE AL-UABON           TO ACARIERA
  8599                                    AGROUPA
  8600                                    ASTATEA
  8601                                    AACCTA
  8602     ELSE
  8603         IF ST-ACCNT-CNTL
  8604             MOVE AL-UABON       TO ASTATEA
  8605                                    AACCTA
  8606         ELSE
  8607             IF CARR-ST-ACCNT-CNTL
  8608                 MOVE AL-UABON   TO ACARIERA
  8609                                    ASTATEA
  8610                                    AACCTA
  8611             ELSE
  8612                 IF ACCNT-CNTL
  8613                     MOVE AL-UABON
  8614                                 TO AACCTA
  8615                 ELSE
  8616                     MOVE AL-UABON
  8617                                 TO ACARIERA
  8618                                    AACCTA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 170
* EL640.cbl
  8619
  8620     MOVE ER-2210                TO EMI-ERROR.
  8621     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8622     GO TO 4390-EXIT.
  8623
  8624 4380-ACCT-FILE-NOTOPEN.
  8625     MOVE -1                     TO ACARIERL.
  8626     MOVE ER-2215                TO EMI-ERROR.
  8627     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8628
  8629 4390-EXIT.
  8630     EXIT.
  8631
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 171
* EL640.cbl
  8633 4400-ERACCT-REWRITE.
  8634     IF NOT PI-VOID-BILL
  8635         MOVE LOW-VALUES         TO ERACCT-PRIME-KEY
  8636         MOVE AM-COMPANY-CD      TO ERACCT-P-CO-CD
  8637         MOVE AM-CARRIER         TO ERACCT-P-CARRIER
  8638         MOVE AM-GROUPING        TO ERACCT-P-GROUPING
  8639         MOVE AM-STATE           TO ERACCT-P-STATE
  8640         MOVE AM-ACCOUNT         TO ERACCT-P-ACCOUNT
  8641         MOVE AM-EXPIRATION-DT   TO ERACCT-P-EXP-DATE
  8642     ELSE
  8643         MOVE LOW-VALUES         TO ERACCT-PRIME-KEY
  8644         MOVE PI-COMPANY-CD      TO ERACCT-P-CO-CD
  8645         MOVE PI-CARRIER         TO ERACCT-P-CARRIER
  8646         MOVE PI-GROUPING        TO ERACCT-P-GROUPING
  8647         MOVE PI-STATE           TO ERACCT-P-STATE
  8648         MOVE PI-SAV-ACCT        TO ERACCT-P-ACCOUNT
  8649         MOVE PI-SAV-EXP-DT      TO ERACCT-P-EXP-DATE.
  8650
  8651
  8652* EXEC CICS HANDLE CONDITION
  8653*        NOTFND   (4470-ACCOUNT-INVALID)
  8654*        NOTOPEN  (4480-ACCT-FILE-NOTOPEN)
  8655*    END-EXEC.
  8656*    MOVE '"$IJ                  ! * #00008303' TO DFHEIV0
  8657     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8658     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8659     MOVE X'2A20233030303038333033' TO DFHEIV0(25:11)
  8660     CALL 'kxdfhei1' USING DFHEIV0
  8661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8662
  8663
  8664
  8665* EXEC CICS READ
  8666*        DATASET   (ERACCT-FILE-ID)
  8667*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8668*        RIDFLD    (ERACCT-PRIME-KEY)
  8669*        UPDATE
  8670*    END-EXEC.
  8671*    MOVE '&"S        EU         (   #00008308' TO DFHEIV0
  8672     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8673     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8674     MOVE X'2020233030303038333038' TO DFHEIV0(25:11)
  8675     CALL 'kxdfhei1' USING DFHEIV0,
  8676           ERACCT-FILE-ID,
  8677           DFHEIV20,
  8678           DFHEIV99,
  8679           ERACCT-PRIME-KEY,
  8680           DFHEIV99,
  8681           DFHEIV99,
  8682           DFHEIV99
  8683     SET ADDRESS OF ACCOUNT-MASTER TO
  8684         DFHEIV20
  8685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8686
  8687
  8688     IF PI-VOID-BILL
  8689         MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO.
  8690
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 172
* EL640.cbl
  8691     IF PI-VOID-BILL
  8692         MOVE SPACE              TO AM-BILLING-STATUS
  8693     ELSE
  8694         MOVE 'B'                TO AM-BILLING-STATUS.
  8695
  8696     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  8697     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  8698     MOVE WS-CURRENT-DATE        TO AM-LAST-MAINT-DT.
  8699
  8700
  8701* EXEC CICS REWRITE
  8702*        DATASET (ERACCT-FILE-ID)
  8703*        FROM    (ACCOUNT-MASTER)
  8704*    END-EXEC.
  8705     MOVE LENGTH OF
  8706      ACCOUNT-MASTER
  8707       TO DFHEIV11
  8708*    MOVE '&& L                  %   #00008327' TO DFHEIV0
  8709     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8710     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8711     MOVE X'2020233030303038333237' TO DFHEIV0(25:11)
  8712     CALL 'kxdfhei1' USING DFHEIV0,
  8713           ERACCT-FILE-ID,
  8714           ACCOUNT-MASTER,
  8715           DFHEIV11,
  8716           DFHEIV99
  8717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8718
  8719
  8720     GO TO 4490-EXIT.
  8721
  8722 4470-ACCOUNT-INVALID.
  8723     MOVE -1                     TO AACCTL.
  8724
  8725     MOVE SPACES                 TO PI-CARRIER
  8726                                    PI-GROUPING
  8727                                    PI-STATE
  8728                                    PI-ACCOUNT.
  8729
  8730     IF CARR-GROUP-ST-ACCNT-CNTL
  8731         MOVE AL-UABON           TO ACARIERA
  8732                                    AGROUPA
  8733                                    ASTATEA
  8734                                    AACCTA
  8735     ELSE
  8736         IF ST-ACCNT-CNTL
  8737             MOVE AL-UABON       TO ASTATEA
  8738                                    AACCTA
  8739         ELSE
  8740             IF CARR-ST-ACCNT-CNTL
  8741                 MOVE AL-UABON   TO ACARIERA
  8742                                    ASTATEA
  8743                                    AACCTA
  8744             ELSE
  8745                 IF ACCNT-CNTL
  8746                     MOVE AL-UABON
  8747                                 TO AACCTA
  8748                 ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 173
* EL640.cbl
  8749                     MOVE AL-UABON
  8750                                 TO ACARIERA
  8751                                    AACCTA.
  8752
  8753     MOVE ER-2210                TO EMI-ERROR.
  8754     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8755     GO TO 4490-EXIT.
  8756
  8757 4480-ACCT-FILE-NOTOPEN.
  8758     MOVE -1                     TO ACARIERL.
  8759     MOVE ER-2215                TO EMI-ERROR.
  8760     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8761
  8762 4490-EXIT.
  8763     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 174
* EL640.cbl
  8765
  8766 4500-PYAJ-START-BROWSE.
  8767     MOVE PI-COMPANY-CD          TO ERPYAJ-COMP-CD.
  8768
  8769     IF NOT PI-ZERO-CARRIER  AND
  8770        NOT PI-ZERO-CAR-GROUP
  8771         MOVE PI-COMP-CARRIER    TO ERPYAJ-CARRIER
  8772     ELSE
  8773         MOVE ZEROS              TO ERPYAJ-CARRIER.
  8774
  8775     IF NOT PI-ZERO-GROUPING  AND
  8776        NOT PI-ZERO-CAR-GROUP
  8777         MOVE PI-COMP-GROUPING   TO ERPYAJ-GROUPING
  8778     ELSE
  8779         MOVE ZEROS              TO ERPYAJ-GROUPING.
  8780
  8781     MOVE PI-SAV-REMIT-TO        TO ERPYAJ-FIN-RESP.
  8782     MOVE PI-SAV-ACCT            TO ERPYAJ-ACCOUNT.
  8783
  8784     IF PI-SAV-REMIT-TO = SPACES
  8785         MOVE PI-SAV-ACCT        TO PI-SAV-REMIT-TO
  8786                                    ERPYAJ-FIN-RESP.
  8787
  8788     MOVE LOW-VALUES             TO ERPYAJ-RECORD-TYPE.
  8789     MOVE ERPYAJ-KEY             TO ERPYAJ-BROWSE-COMP-KEY.
  8790
  8791
  8792* EXEC CICS HANDLE CONDITION
  8793*        NOTFND (4510-REC-NOT-FND)
  8794*    END-EXEC.
  8795*    MOVE '"$I                   ! + #00008403' TO DFHEIV0
  8796     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8797     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8798     MOVE X'2B20233030303038343033' TO DFHEIV0(25:11)
  8799     CALL 'kxdfhei1' USING DFHEIV0
  8800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8801
  8802
  8803
  8804* EXEC CICS STARTBR
  8805*        DATASET(ERPYAJ-FILE-ID)
  8806*        RIDFLD (ERPYAJ-KEY)
  8807*        GTEQ
  8808*    END-EXEC.
  8809     MOVE 0
  8810       TO DFHEIV11
  8811*    MOVE '&,         G          &   #00008407' TO DFHEIV0
  8812     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8813     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8814     MOVE X'2020233030303038343037' TO DFHEIV0(25:11)
  8815     CALL 'kxdfhei1' USING DFHEIV0,
  8816           ERPYAJ-FILE-ID,
  8817           ERPYAJ-KEY,
  8818           DFHEIV99,
  8819           DFHEIV11,
  8820           DFHEIV99
  8821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8822
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 175
* EL640.cbl
  8823
  8824     GO TO 4590-EXIT.
  8825
  8826 4510-REC-NOT-FND.
  8827     MOVE 'Y'                    TO PYAJ-EOF-SW.
  8828
  8829 4590-EXIT.
  8830     EXIT.
  8831
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 176
* EL640.cbl
  8833 4600-PYAJ-READ-NEXT.
  8834
  8835* EXEC CICS HANDLE CONDITION
  8836*        ENDFILE (4610-END-OF-FILE)
  8837*    END-EXEC.
  8838*    MOVE '"$''                   ! , #00008423' TO DFHEIV0
  8839     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8840     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8841     MOVE X'2C20233030303038343233' TO DFHEIV0(25:11)
  8842     CALL 'kxdfhei1' USING DFHEIV0
  8843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8844
  8845
  8846
  8847* EXEC CICS READNEXT
  8848*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  8849*        DATASET (ERPYAJ-FILE-ID)
  8850*        RIDFLD  (ERPYAJ-KEY)
  8851*    END-EXEC.
  8852     MOVE 0
  8853       TO DFHEIV11
  8854*    MOVE '&.S                   )   #00008427' TO DFHEIV0
  8855     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8856     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8857     MOVE X'2020233030303038343237' TO DFHEIV0(25:11)
  8858     CALL 'kxdfhei1' USING DFHEIV0,
  8859           ERPYAJ-FILE-ID,
  8860           DFHEIV20,
  8861           DFHEIV99,
  8862           ERPYAJ-KEY,
  8863           DFHEIV99,
  8864           DFHEIV11,
  8865           DFHEIV99,
  8866           DFHEIV99
  8867     SET ADDRESS OF PENDING-PAY-ADJ TO
  8868         DFHEIV20
  8869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8870
  8871
  8872     GO TO 4690-EXIT.
  8873
  8874 4610-END-OF-FILE.
  8875     MOVE 'Y'                    TO PYAJ-EOF-SW.
  8876
  8877 4690-EXIT.
  8878     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 177
* EL640.cbl
  8880 4700-PYAJ-REWRITE.
  8881
  8882* EXEC CICS READ
  8883*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  8884*        DATASET (ERPYAJ-FILE-ID)
  8885*        RIDFLD  (ERPYAJ-KEY)
  8886*        UPDATE
  8887*    END-EXEC.
  8888*    MOVE '&"S        EU         (   #00008442' TO DFHEIV0
  8889     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8890     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8891     MOVE X'2020233030303038343432' TO DFHEIV0(25:11)
  8892     CALL 'kxdfhei1' USING DFHEIV0,
  8893           ERPYAJ-FILE-ID,
  8894           DFHEIV20,
  8895           DFHEIV99,
  8896           ERPYAJ-KEY,
  8897           DFHEIV99,
  8898           DFHEIV99,
  8899           DFHEIV99
  8900     SET ADDRESS OF PENDING-PAY-ADJ TO
  8901         DFHEIV20
  8902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8903
  8904
  8905     IF PI-VOID-BILL
  8906         MOVE LOW-VALUES         TO PY-BILLED-DATE
  8907                                    PY-AR-DATE
  8908         IF ACCOUNT-NOT-FIN-RESP
  8909             IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  8910                 PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  8911                 PY-ADD-TO-BALANCE
  8912                 ADD PY-ENTRY-AMT  TO  PI-REMITTED
  8913             ELSE
  8914                 IF (PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT)
  8915                    AND PY-BILLING-CHECK
  8916                    ADD PY-ENTRY-AMT TO PI-DISBURSED
  8917                 ELSE
  8918                     ADD PY-ENTRY-AMT TO PI-ADJUSTMENTS
  8919         ELSE
  8920             NEXT SENTENCE
  8921     ELSE
  8922         MOVE WS-CURRENT-DATE    TO PY-BILLED-DATE.
  8923
  8924     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  8925     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  8926     MOVE WS-CURRENT-DATE        TO PY-LAST-MAINT-DT.
  8927
  8928
  8929* EXEC CICS REWRITE
  8930*        DATASET (ERPYAJ-FILE-ID)
  8931*        FROM    (PENDING-PAY-ADJ)
  8932*    END-EXEC.
  8933     MOVE LENGTH OF
  8934      PENDING-PAY-ADJ
  8935       TO DFHEIV11
  8936*    MOVE '&& L                  %   #00008472' TO DFHEIV0
  8937     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 178
* EL640.cbl
  8938     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8939     MOVE X'2020233030303038343732' TO DFHEIV0(25:11)
  8940     CALL 'kxdfhei1' USING DFHEIV0,
  8941           ERPYAJ-FILE-ID,
  8942           PENDING-PAY-ADJ,
  8943           DFHEIV11,
  8944           DFHEIV99
  8945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8946
  8947
  8948 4790-EXIT.
  8949     EXIT.
  8950
  8951 4800-PYAJ-END-BROWSE.
  8952
  8953* EXEC CICS ENDBR
  8954*        DATASET (ERPYAJ-FILE-ID)
  8955*    END-EXEC.
  8956     MOVE 0
  8957       TO DFHEIV11
  8958*    MOVE '&2                    $   #00008481' TO DFHEIV0
  8959     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8960     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8961     MOVE X'2020233030303038343831' TO DFHEIV0(25:11)
  8962     CALL 'kxdfhei1' USING DFHEIV0,
  8963           ERPYAJ-FILE-ID,
  8964           DFHEIV11,
  8965           DFHEIV99
  8966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8967
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 179
* EL640.cbl
  8969 5000-FORMAT-SCREEN.
  8970*                **********************************************
  8971*                *  FORMAT THE BILLING TOTALS SCREEN (EL640A) *
  8972*                **********************************************
  8973     MOVE LOW-VALUES             TO EL640AO.
  8974
  8975     IF PI-SAV-ACCT > SPACES
  8976        MOVE PI-SAV-ACCT         TO AACCTO
  8977        MOVE PI-SAV-CARR         TO ACARIERO
  8978        MOVE PI-SAV-GROUP        TO AGROUPO
  8979        MOVE PI-SAV-STATE        TO ASTATEO.
  8980
  8981     MOVE PI-BILL-TYPE           TO ABILTYPI.
  8982     MOVE PI-BILL-ERRS           TO ABILERRI.
  8983     MOVE AL-UANON               TO AACCTA
  8984                                    ACARIERA
  8985                                    AGROUPA
  8986                                    ASTATEA
  8987                                    ABILTYPA
  8988                                    ABILERRA.
  8989
  8990     IF ACCOUNT-NOT-FIN-RESP
  8991         MOVE ER-2539            TO EMI-ERROR
  8992         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8993
  8994     IF PI-BILLING-BATCHES (1) NOT = SPACES
  8995         MOVE PI-BILLING-BATCHES (1) TO ABTCH1I
  8996         MOVE AL-UANON               TO ABTCH1A.
  8997
  8998     IF PI-BILLING-BATCHES (2) NOT = SPACES
  8999         MOVE PI-BILLING-BATCHES (2) TO ABTCH2I
  9000         MOVE AL-UANON               TO ABTCH2A.
  9001
  9002     IF PI-BILLING-BATCHES (3) NOT = SPACES
  9003         MOVE PI-BILLING-BATCHES (3) TO ABTCH3I
  9004         MOVE AL-UANON               TO ABTCH3A.
  9005
  9006     SET ANDX  PINDX            TO 1.
  9007
  9008 5005-FORMAT-LOOP.
  9009     IF PI-BATCH (PINDX) NOT = SPACES
  9010         MOVE PI-BATCH  (PINDX)  TO BATCH  (ANDX)
  9011         MOVE PI-NOBILL (PINDX)  TO NOBILL (ANDX)
  9012         MOVE PI-BILLED (PINDX)  TO BILL   (ANDX)
  9013         MOVE PI-PREV   (PINDX)  TO PREV   (ANDX)
  9014         SET ANDX PINDX UP BY 1
  9015         IF ANDX > 6
  9016             NEXT SENTENCE
  9017         ELSE
  9018             GO TO 5005-FORMAT-LOOP.
  9019
  9020     IF MORE-THAN-6-BATCHES
  9021         MOVE ER-2472            TO EMI-ERROR
  9022         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9023         MOVE ZEROS              TO EMI-ERROR.
  9024
  9025     IF NOT PI-DATA-BILLED
  9026         IF RETURNED-FROM NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 180
* EL640.cbl
  9027             GO TO 5080-CONT
  9028         ELSE
  9029             MOVE ER-2409        TO EMI-ERROR
  9030             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9031             GO TO 5090-EXIT.
  9032
  9033     MOVE PI-BAL-FRWD            TO ABALFWDO.
  9034     MOVE PI-PREMIUM             TO APREMUMO.
  9035     MOVE PI-REMITTED            TO AREMITO.
  9036     MOVE PI-TOT-ISS-COMP        TO ACOMPISO.
  9037     MOVE PI-TOT-CAN-COMP        TO ACOMCANO.
  9038     COMPUTE PI-ADJUSTMENTS  =   PI-ADJUSTMENTS  +
  9039                                 TOT-REPT-CANCEL-FEE.
  9040     MOVE PI-ADJUSTMENTS         TO AADJUSTO.
  9041     MOVE PI-DISBURSED           TO ADISBURO.
  9042
  9043     COMPUTE PI-END-BAL = PI-BAL-FRWD +
  9044                          PI-PREMIUM -
  9045                          PI-REMITTED -
  9046                          PI-TOT-ISS-COMP +
  9047                          PI-TOT-CAN-COMP +
  9048                          PI-ADJUSTMENTS +
  9049                          PI-DISBURSED.
  9050
  9051     MOVE PI-END-BAL             TO ANETDUEO.
  9052
  9053     IF PI-END-BAL NEGATIVE
  9054         MOVE OWED-TO-AGENT      TO AENDHDGO
  9055     ELSE
  9056         IF PI-END-BAL > ZERO
  9057             MOVE AGENT-OWES     TO AENDHDGO
  9058         ELSE
  9059             MOVE 'BALANCE          =' TO AENDHDGO.
  9060
  9061 5080-CONT.
  9062     IF RETURNED-FROM NOT = SPACES
  9063         IF (RETURNED-FROM NOT = XCTL-6401)  AND
  9064             (PI-CR-FIN-RESP NOT = SPACES)
  9065               MOVE ER-2421        TO EMI-ERROR
  9066               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9067               MOVE ZEROS          TO EMI-ERROR
  9068         ELSE
  9069             NEXT SENTENCE
  9070     ELSE
  9071         IF PI-BILL OR PI-REBILLING
  9072             MOVE 'Y'            TO COMP-UPDATE-SW
  9073             PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  9074             MOVE 'Y'            TO ELCNTL-UPDATE-SW
  9075             MOVE SPACES         TO ELCNTL-KEY
  9076             MOVE '1'            TO ELCNTL-REC-TYPE
  9077             PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT
  9078             MOVE WS-CURRENT-DATE TO CF-ACCOUNT-MSTR-MAINT-DT
  9079                                     CF-COMPENSATION-MSTR-MAINT-DT
  9080             PERFORM 6200-REWRITE-CONTROL-FILE THRU 6290-EXIT.
  9081
  9082 5090-EXIT.
  9083     EXIT.
  9084
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 181
* EL640.cbl
  9086 6000-READ-COMP-MASTER.
  9087
  9088* EXEC CICS HANDLE CONDITION
  9089*        NOTFND   (6070-NO-COMP-MSTR)
  9090*        NOTOPEN  (6080-COMP-FILE-NOTOPEN)
  9091*    END-EXEC.
  9092*    MOVE '"$IJ                  ! - #00008603' TO DFHEIV0
  9093     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9094     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9095     MOVE X'2D20233030303038363033' TO DFHEIV0(25:11)
  9096     CALL 'kxdfhei1' USING DFHEIV0
  9097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9098
  9099
  9100     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  9101     MOVE PI-COMP-CARRIER        TO ERCOMP-CARRIER
  9102     MOVE PI-COMP-GROUPING       TO ERCOMP-GROUPING
  9103     MOVE PI-COMP-FIN-RESP       TO ERCOMP-FIN-RESP.
  9104
  9105     MOVE SPACES                 TO WS-CO-ZIP.
  9106
  9107     IF EIBAID = DFHPF5
  9108         MOVE LOW-VALUES         TO ERCOMP-ACCT
  9109         MOVE 'G'                TO ERCOMP-RECORD-TYPE
  9110     ELSE
  9111         MOVE PI-SAV-ACCT        TO ERCOMP-ACCT
  9112         MOVE 'A'                TO ERCOMP-RECORD-TYPE.
  9113
  9114 6001-READ.
  9115     IF UPDATE-COMP-TOTALS OR PI-VOID-BILL
  9116
  9117* EXEC CICS READ
  9118*            DATASET   (ERCOMP-FILE-ID)
  9119*            SET       (ADDRESS OF COMPENSATION-MASTER)
  9120*            RIDFLD    (ERCOMP-KEY)
  9121*            UPDATE
  9122*        END-EXEC
  9123*    MOVE '&"S        EU         (   #00008624' TO DFHEIV0
  9124     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9125     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9126     MOVE X'2020233030303038363234' TO DFHEIV0(25:11)
  9127     CALL 'kxdfhei1' USING DFHEIV0,
  9128           ERCOMP-FILE-ID,
  9129           DFHEIV20,
  9130           DFHEIV99,
  9131           ERCOMP-KEY,
  9132           DFHEIV99,
  9133           DFHEIV99,
  9134           DFHEIV99
  9135     SET ADDRESS OF COMPENSATION-MASTER TO
  9136         DFHEIV20
  9137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9138     ELSE
  9139
  9140* EXEC CICS READ
  9141*            DATASET   (ERCOMP-FILE-ID)
  9142*            SET       (ADDRESS OF COMPENSATION-MASTER)
  9143*            RIDFLD    (ERCOMP-KEY)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 182
* EL640.cbl
  9144*        END-EXEC.
  9145*    MOVE '&"S        E          (   #00008631' TO DFHEIV0
  9146     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9147     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9148     MOVE X'2020233030303038363331' TO DFHEIV0(25:11)
  9149     CALL 'kxdfhei1' USING DFHEIV0,
  9150           ERCOMP-FILE-ID,
  9151           DFHEIV20,
  9152           DFHEIV99,
  9153           ERCOMP-KEY,
  9154           DFHEIV99,
  9155           DFHEIV99,
  9156           DFHEIV99
  9157     SET ADDRESS OF COMPENSATION-MASTER TO
  9158         DFHEIV20
  9159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9160
  9161
  9162     IF CO-CANADIAN-POST-CODE
  9163         MOVE CO-CAN-POSTAL-1    TO WS-CO-CAN-POST-1
  9164         MOVE CO-CAN-POSTAL-2    TO WS-CO-CAN-POST-2
  9165     ELSE
  9166         MOVE CO-ZIP-PRIME       TO WS-CO-ZIP-PRIME
  9167         IF CO-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9168             MOVE '-'            TO WS-CO-ZIP-DASH
  9169             MOVE CO-ZIP-PLUS4   TO WS-CO-ZIP-PLUS4.
  9170
  9171 6002-CONTINUE.
  9172     IF EIBAID = DFHPF5
  9173         GO TO 6090-EXIT.
  9174
  9175     IF FIRST-TIME
  9176        MOVE CO-MAIL-NAME        TO WS-ACCT-LINES (1)
  9177        MOVE CO-ACCT-NAME        TO WS-ACCT-LINES (2)
  9178        MOVE CO-ADDR-1           TO WS-ACCT-LINES (3)
  9179        MOVE CO-ADDR-2           TO WS-ACCT-LINES (4)
  9180        MOVE CO-ADDR-3           TO WS-ACCT-LINES (5)
  9181        MOVE WS-CO-ZIP           TO WS-ACCT-LINES (6)
  9182        PERFORM 6400-FORMAT-ACCOUNT-ADDRS THRU 6490-EXIT.
  9183
  9184     IF PI-VOID-BILL
  9185         MOVE  PI-ME-MONTH       TO WS-ME-MONTH
  9186         MOVE  PI-ME-DAY         TO WS-ME-DAY
  9187         MOVE  PI-ME-YEAR        TO WS-ME-YEAR
  9188         IF ACCOUNT-FIN-RESP
  9189             MOVE CO-MONTHLY-TOTALS TO CO-CURRENT-MONTHLY-TOTALS
  9190             MOVE CO-AGING-TOTALS   TO CO-CURRENT-AGING-TOTALS
  9191             MOVE CO-YTD-TOTALS     TO CO-CURRENT-YTD-TOTALS
  9192             MOVE CO-LAST-STMT-DT   TO CO-CURRENT-LAST-STMT-DT
  9193             PERFORM 6060-ERCOMP-REWRITE
  9194             GO TO 6090-EXIT
  9195         ELSE
  9196             MOVE CO-YTD-TOTALS     TO CO-CURRENT-YTD-TOTALS
  9197             MOVE CO-LAST-STMT-DT   TO CO-CURRENT-LAST-STMT-DT
  9198             PERFORM 6060-ERCOMP-REWRITE
  9199             MOVE LOW-VALUES        TO ERCOMP-ACCT
  9200             MOVE 'G'               TO ERCOMP-RECORD-TYPE
  9201             PERFORM 6001-READ
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 183
* EL640.cbl
  9202             COMPUTE CO-CURRENT-CUR-CHG =
  9203                     CO-CURRENT-CUR-CHG - PI-PREMIUM
  9204             COMPUTE CO-CURRENT-CUR-COM =
  9205                     CO-CURRENT-CUR-COM - PI-TOT-ISS-COMP -
  9206                     PI-TOT-CAN-COMP
  9207             COMPUTE CO-CURRENT-CUR-PMT =
  9208                     CO-CURRENT-CUR-PMT - PI-REMITTED +
  9209                     PI-DISBURSED + PI-ADJUSTMENTS
  9210             COMPUTE CO-CURRENT-END-BAL =
  9211                     CO-CURRENT-BAL-FWD + CO-CURRENT-CUR-CHG -
  9212                     CO-CURRENT-CUR-COM - CO-CURRENT-CUR-PMT
  9213             MOVE CO-AGING-TOTALS   TO  CO-CURRENT-AGING-TOTALS
  9214             PERFORM 6050-AGING  THRU  6059-AGING-EXIT
  9215             IF CO-CURRENT-CUR-CHG = ZEROS AND
  9216                CO-CURRENT-CUR-COM = ZEROS AND
  9217                CO-CURRENT-CUR-PMT = ZEROS
  9218                 MOVE CO-LAST-STMT-DT TO CO-CURRENT-LAST-STMT-DT
  9219                 PERFORM 6060-ERCOMP-REWRITE
  9220                 GO TO 6090-EXIT
  9221             ELSE
  9222                 PERFORM 6060-ERCOMP-REWRITE
  9223                 GO TO 6090-EXIT.
  9224
  9225     IF UPDATE-COMP-TOTALS
  9226         MOVE  PI-ME-MONTH       TO WS-ME-MONTH
  9227         MOVE  PI-ME-DAY         TO WS-ME-DAY
  9228         MOVE  PI-ME-YEAR        TO WS-ME-YEAR
  9229         IF ACCOUNT-FIN-RESP
  9230             IF NOT PI-CHECK-PRODUCED
  9231                 IF CO-CURRENT-LAST-STMT-DT = WS-MONTH-END-DATE
  9232                     MOVE CO-CURRENT-END-BAL
  9233                                 TO CO-CURRENT-BAL-FWD
  9234                     COMPUTE CO-CURRENT-CUR-COM =
  9235                             CO-CURRENT-CUR-COM +
  9236                             PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9237                     COMPUTE CO-CURRENT-YTD-COM =
  9238                             CO-CURRENT-YTD-COM +
  9239                             PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9240                     COMPUTE CO-CURRENT-CUR-CHG =
  9241                             CO-CURRENT-CUR-CHG + PI-PREMIUM
  9242                     COMPUTE CO-CURRENT-CUR-PMT =
  9243                             CO-CURRENT-CUR-PMT +
  9244                             PI-REMITTED - PI-DISBURSED -
  9245                             PI-ADJUSTMENTS
  9246                     COMPUTE CO-CURRENT-END-BAL =
  9247                             CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9248                             PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9249                             PI-REMITTED + PI-DISBURSED +
  9250                             PI-ADJUSTMENTS
  9251                     PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9252                     PERFORM 6060-ERCOMP-REWRITE
  9253                     GO TO 6090-EXIT
  9254                ELSE
  9255                    MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9256                    MOVE PI-END-BAL         TO CO-CURRENT-END-BAL
  9257                    COMPUTE CO-CURRENT-CUR-COM =
  9258                            PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9259                    ADD CO-CURRENT-CUR-COM TO CO-CURRENT-YTD-COM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 184
* EL640.cbl
  9260                    MOVE PI-PREMIUM        TO CO-CURRENT-CUR-CHG
  9261                    COMPUTE CO-CURRENT-CUR-PMT =
  9262                             PI-REMITTED - PI-DISBURSED -
  9263                             PI-ADJUSTMENTS
  9264                    PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9265                    MOVE WS-MONTH-END-DATE
  9266                                 TO CO-CURRENT-LAST-STMT-DT
  9267                    PERFORM 6060-ERCOMP-REWRITE
  9268                    GO TO 6090-EXIT
  9269             ELSE
  9270                 MOVE SPACE      TO PI-CHECK-SW
  9271                 MOVE PI-END-BAL TO CO-CURRENT-END-BAL
  9272                 COMPUTE CO-CURRENT-CUR-CHG = PI-PREMIUM +
  9273                         (PI-ADJUSTMENTS - PI-DISBURSED)
  9274                 PERFORM 6060-ERCOMP-REWRITE
  9275                 GO TO 6090-EXIT
  9276         ELSE
  9277             COMPUTE CO-CURRENT-YTD-COM =
  9278                     CO-CURRENT-YTD-COM + PI-TOT-ISS-COMP
  9279                                        - PI-TOT-CAN-COMP
  9280             PERFORM 6060-ERCOMP-REWRITE
  9281             MOVE LOW-VALUES    TO ERCOMP-ACCT
  9282             MOVE 'G'           TO ERCOMP-RECORD-TYPE
  9283             PERFORM 6001-READ
  9284             IF CO-CURRENT-LAST-STMT-DT = WS-MONTH-END-DATE
  9285                 MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9286                 COMPUTE CO-CURRENT-CUR-COM =
  9287                         CO-CURRENT-CUR-COM +
  9288                         PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9289                 COMPUTE CO-CURRENT-CUR-CHG =
  9290                         CO-CURRENT-CUR-CHG + PI-PREMIUM
  9291                 COMPUTE CO-CURRENT-CUR-PMT =
  9292                         CO-CURRENT-CUR-PMT +
  9293                         PI-REMITTED - PI-DISBURSED -
  9294                         PI-ADJUSTMENTS
  9295                 COMPUTE CO-CURRENT-END-BAL =
  9296                         CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9297                         PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9298                         PI-REMITTED + PI-DISBURSED +
  9299                         PI-ADJUSTMENTS
  9300                 PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9301                 PERFORM 6060-ERCOMP-REWRITE
  9302                 GO TO 6090-EXIT
  9303             ELSE
  9304                 MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9305                 COMPUTE CO-CURRENT-CUR-COM =
  9306                         PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9307                 MOVE PI-PREMIUM         TO CO-CURRENT-CUR-CHG
  9308                 COMPUTE CO-CURRENT-CUR-PMT =
  9309                         PI-REMITTED - PI-DISBURSED -
  9310                         PI-ADJUSTMENTS
  9311                 COMPUTE CO-CURRENT-END-BAL =
  9312                         CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9313                         PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9314                         PI-REMITTED + PI-DISBURSED +
  9315                         PI-ADJUSTMENTS
  9316                 PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9317                 MOVE WS-MONTH-END-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 185
* EL640.cbl
  9318                                      TO CO-CURRENT-LAST-STMT-DT
  9319                 PERFORM 6060-ERCOMP-REWRITE
  9320                 GO TO 6090-EXIT.
  9321
  9322     IF PI-TOT-REBILL
  9323         MOVE CO-END-BAL           TO PI-BAL-FRWD
  9324     ELSE
  9325         MOVE CO-CURRENT-END-BAL   TO PI-BAL-FRWD.
  9326
  9327     IF PI-UPDATE-FILES
  9328       OR (PI-PREVIEW AND APRODSWI = 'Y')
  9329         NEXT SENTENCE
  9330     ELSE
  9331         GO TO 6090-EXIT.
  9332
  9333     IF AM-AGT (ACCOM-SUB) = PI-SAV-REMIT-TO
  9334         PERFORM 6040-READ-COMP-MASTER THRU 6049-EXIT
  9335         IF C-RECORD-FOUND
  9336             MOVE CO-ACCT-NAME   TO WS-REMIT-LINES (1)
  9337             MOVE CO-MAIL-NAME   TO WS-REMIT-LINES (2)
  9338             MOVE CO-ADDR-1      TO WS-REMIT-LINES (3)
  9339             MOVE CO-ADDR-2      TO WS-REMIT-LINES (4)
  9340             MOVE CO-ADDR-3      TO WS-REMIT-LINES (5)
  9341             MOVE WS-CO-ZIP      TO WS-REMIT-LINES (6)
  9342             PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9343             MOVE 'CA'           TO BILLING-DETAIL-TYPE
  9344             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT
  9345         ELSE
  9346             MOVE SPACES         TO ELCNTL-KEY
  9347             MOVE '6'            TO ELCNTL-REC-TYPE
  9348             MOVE PI-CARRIER     TO ELCNTL-CARRIER
  9349             PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT
  9350             MOVE CF-MAIL-TO-NAME   TO WS-REMIT-LINES (1)
  9351             MOVE CF-IN-CARE-OF     TO WS-REMIT-LINES (2)
  9352             MOVE CF-ADDRESS-LINE-1 TO WS-REMIT-LINES (3)
  9353             MOVE CF-ADDRESS-LINE-2 TO WS-REMIT-LINES (4)
  9354             MOVE CF-CITY-STATE     TO WS-REMIT-LINES (5)
  9355             MOVE WS-CF-ZIP         TO WS-REMIT-LINES (6)
  9356             PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9357             MOVE 'CA'              TO BILLING-DETAIL-TYPE
  9358             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT
  9359     ELSE
  9360         MOVE LOW-VALUES         TO ERCOMP-ACCT
  9361         MOVE 'G'                TO ERCOMP-RECORD-TYPE
  9362         PERFORM 6001-READ
  9363         MOVE CO-ACCT-NAME       TO WS-REMIT-LINES (1)
  9364         MOVE CO-MAIL-NAME       TO WS-REMIT-LINES (2)
  9365         MOVE CO-ADDR-1          TO WS-REMIT-LINES (3)
  9366         MOVE CO-ADDR-2          TO WS-REMIT-LINES (4)
  9367         MOVE CO-ADDR-3          TO WS-REMIT-LINES (5)
  9368         MOVE WS-CO-ZIP          TO WS-REMIT-LINES (6)
  9369         MOVE CO-CURRENT-END-BAL TO PI-BAL-FRWD-GA
  9370         PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9371         MOVE 'GA'               TO BILLING-DETAIL-TYPE
  9372         PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  9373
  9374     GO TO 6090-EXIT.
  9375
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 186
* EL640.cbl
  9376 6070-NO-COMP-MSTR.
  9377     MOVE ER-2230                TO EMI-ERROR.
  9378     MOVE -1                     TO AACCTL.
  9379     MOVE AL-UABON               TO ACARIERA
  9380                                    AGROUPA
  9381                                    AACCTA.
  9382     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9383     GO TO 6090-EXIT.
  9384
  9385 6080-COMP-FILE-NOTOPEN.
  9386     MOVE -1                     TO APFNTERL
  9387     MOVE ER-2233                TO EMI-ERROR.
  9388     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9389
  9390 6090-EXIT.
  9391     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 187
* EL640.cbl
  9393
  9394 6040-READ-COMP-MASTER.
  9395
  9396* EXEC CICS HANDLE CONDITION
  9397*        NOTFND   (6045-NO-COMP-MSTR)
  9398*        NOTOPEN  (6045-COMP-FILE-NOTOPEN)
  9399*    END-EXEC.
  9400*    MOVE '"$IJ                  ! . #00008870' TO DFHEIV0
  9401     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9402     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9403     MOVE X'2E20233030303038383730' TO DFHEIV0(25:11)
  9404     CALL 'kxdfhei1' USING DFHEIV0
  9405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9406
  9407
  9408     MOVE 'Y'                    TO C-RECORD-FOUND-SW.
  9409     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  9410     MOVE PI-COMP-CARRIER        TO ERCOMP-CARRIER
  9411     MOVE PI-COMP-GROUPING       TO ERCOMP-GROUPING
  9412     MOVE LOW-VALUES             TO ERCOMP-FIN-RESP
  9413                                    ERCOMP-ACCT.
  9414     MOVE 'C'                    TO ERCOMP-RECORD-TYPE.
  9415
  9416     MOVE SPACES                 TO WS-CO-ZIP.
  9417
  9418
  9419* EXEC CICS READ
  9420*        DATASET   (ERCOMP-FILE-ID)
  9421*        SET       (ADDRESS OF COMPENSATION-MASTER)
  9422*        RIDFLD    (ERCOMP-KEY)
  9423*    END-EXEC.
  9424*    MOVE '&"S        E          (   #00008885' TO DFHEIV0
  9425     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9426     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9427     MOVE X'2020233030303038383835' TO DFHEIV0(25:11)
  9428     CALL 'kxdfhei1' USING DFHEIV0,
  9429           ERCOMP-FILE-ID,
  9430           DFHEIV20,
  9431           DFHEIV99,
  9432           ERCOMP-KEY,
  9433           DFHEIV99,
  9434           DFHEIV99,
  9435           DFHEIV99
  9436     SET ADDRESS OF COMPENSATION-MASTER TO
  9437         DFHEIV20
  9438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9439
  9440
  9441     IF CO-CANADIAN-POST-CODE
  9442         MOVE CO-CAN-POSTAL-1    TO WS-CO-CAN-POST-1
  9443         MOVE CO-CAN-POSTAL-2    TO WS-CO-CAN-POST-2
  9444     ELSE
  9445         MOVE CO-ZIP-PRIME       TO WS-CO-ZIP-PRIME
  9446         IF CO-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9447             MOVE '-'            TO WS-CO-ZIP-DASH
  9448             MOVE CO-ZIP-PLUS4   TO WS-CO-ZIP-PLUS4.
  9449
  9450     GO TO 6049-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 188
* EL640.cbl
  9451
  9452 6045-COMP-FILE-NOTOPEN.
  9453     MOVE -1                     TO APFNTERL.
  9454     MOVE ER-2233                TO EMI-ERROR.
  9455     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9456
  9457     GO TO 6049-EXIT.
  9458
  9459 6045-NO-COMP-MSTR.
  9460     MOVE 'N'                    TO C-RECORD-FOUND-SW.
  9461
  9462 6049-EXIT.
  9463     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 189
* EL640.cbl
  9465
  9466 6050-AGING.
  9467
  9468     IF NOT PI-VOID-BILL
  9469        IF CO-CURRENT-LAST-STMT-DT NOT = WS-MONTH-END-DATE
  9470           if pi-company-id = 'AHL'
  9471              add co-current-ov90
  9472                                 to co-current-ov120
  9473              move co-current-ov60
  9474                                 to co-current-ov90
  9475              move co-current-ov30
  9476                                 to co-current-ov60
  9477              move co-current-cur
  9478                                 to co-current-ov30
  9479           else
  9480              ADD CO-CURRENT-OV60
  9481                                 TO CO-CURRENT-OV90
  9482              MOVE CO-CURRENT-OV30
  9483                                 TO CO-CURRENT-OV60
  9484              MOVE CO-CURRENT-CUR
  9485                                 TO CO-CURRENT-OV30
  9486           end-if
  9487        end-if
  9488     end-if
  9489
  9490     COMPUTE CO-CURRENT-CUR =
  9491             CO-CURRENT-CUR-CHG - CO-CURRENT-CUR-COM.
  9492
  9493     COMPUTE WS-PAY-ADJ =
  9494             PI-REMITTED - PI-DISBURSED - PI-ADJUSTMENTS.
  9495
  9496     IF WS-PAY-ADJ NEGATIVE
  9497         SUBTRACT WS-PAY-ADJ  FROM  CO-CURRENT-CUR
  9498     ELSE
  9499        if pi-company-id = 'AHL'
  9500           subtract ws-pay-adj from co-current-ov120
  9501        else
  9502           SUBTRACT WS-PAY-ADJ  FROM  CO-CURRENT-OV90
  9503        end-if
  9504     end-if
  9505
  9506     IF CO-CURRENT-CUR NEGATIVE
  9507        if pi-company-id = 'AHL'
  9508           add co-current-cur to co-current-ov120
  9509        else
  9510           ADD CO-CURRENT-CUR  TO  CO-CURRENT-OV90
  9511        end-if
  9512        MOVE ZEROS              TO  CO-CURRENT-CUR
  9513     end-if
  9514
  9515     if pi-company-id = 'AHL'
  9516        if co-current-ov120 negative
  9517           add co-current-ov120 to co-current-ov90
  9518           move zeros           to co-current-ov120
  9519        end-if
  9520     end-if
  9521     IF CO-CURRENT-OV90 NEGATIVE
  9522         ADD CO-CURRENT-OV90  TO  CO-CURRENT-OV60
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 190
* EL640.cbl
  9523         MOVE ZEROS              TO  CO-CURRENT-OV90.
  9524
  9525     IF CO-CURRENT-OV60 NEGATIVE
  9526         ADD CO-CURRENT-OV60  TO  CO-CURRENT-OV30
  9527         MOVE ZEROS              TO  CO-CURRENT-OV60.
  9528
  9529     IF CO-CURRENT-OV30 NEGATIVE
  9530         ADD CO-CURRENT-OV30  TO  CO-CURRENT-CUR
  9531         MOVE ZEROS              TO  CO-CURRENT-OV30.
  9532
  9533 6059-AGING-EXIT.
  9534     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 191
* EL640.cbl
  9536
  9537 6060-ERCOMP-REWRITE.
  9538
  9539
  9540* EXEC CICS REWRITE
  9541*        DATASET (ERCOMP-FILE-ID)
  9542*        FROM    (COMPENSATION-MASTER)
  9543*    END-EXEC.
  9544     MOVE LENGTH OF
  9545      COMPENSATION-MASTER
  9546       TO DFHEIV11
  9547*    MOVE '&& L                  %   #00008989' TO DFHEIV0
  9548     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9549     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9550     MOVE X'2020233030303038393839' TO DFHEIV0(25:11)
  9551     CALL 'kxdfhei1' USING DFHEIV0,
  9552           ERCOMP-FILE-ID,
  9553           COMPENSATION-MASTER,
  9554           DFHEIV11,
  9555           DFHEIV99
  9556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9557
  9558
  9559 6100-READ-CONTROL-FILE.
  9560     MOVE PI-COMPANY-ID          TO ELCNTL-COMPANY-ID.
  9561     MOVE +0                     TO ELCNTL-SEQ-NO.
  9562
  9563     MOVE SPACES                 TO WS-CF-ZIP.
  9564
  9565
  9566* EXEC CICS HANDLE CONDITION
  9567*        NOTFND   (6110-NO-RECORD)
  9568*    END-EXEC.
  9569*    MOVE '"$I                   ! / #00009000' TO DFHEIV0
  9570     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9571     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9572     MOVE X'2F20233030303039303030' TO DFHEIV0(25:11)
  9573     CALL 'kxdfhei1' USING DFHEIV0
  9574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9575
  9576
  9577     IF NOT ELCNTL-UPDATE
  9578
  9579* EXEC CICS READ
  9580*            DATASET (ELCNTL-FILE-ID)
  9581*            SET     (ADDRESS OF CONTROL-FILE)
  9582*            RIDFLD  (ELCNTL-KEY)
  9583*        END-EXEC
  9584*    MOVE '&"S        E          (   #00009005' TO DFHEIV0
  9585     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9586     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9587     MOVE X'2020233030303039303035' TO DFHEIV0(25:11)
  9588     CALL 'kxdfhei1' USING DFHEIV0,
  9589           ELCNTL-FILE-ID,
  9590           DFHEIV20,
  9591           DFHEIV99,
  9592           ELCNTL-KEY,
  9593           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 192
* EL640.cbl
  9594           DFHEIV99,
  9595           DFHEIV99
  9596     SET ADDRESS OF CONTROL-FILE TO
  9597         DFHEIV20
  9598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9599     ELSE
  9600         MOVE SPACE              TO ELCNTL-UPDATE-SW
  9601
  9602* EXEC CICS READ
  9603*            DATASET (ELCNTL-FILE-ID)
  9604*            SET     (ADDRESS OF CONTROL-FILE)
  9605*            RIDFLD  (ELCNTL-KEY)
  9606*            UPDATE
  9607*        END-EXEC.
  9608*    MOVE '&"S        EU         (   #00009012' TO DFHEIV0
  9609     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9610     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9611     MOVE X'2020233030303039303132' TO DFHEIV0(25:11)
  9612     CALL 'kxdfhei1' USING DFHEIV0,
  9613           ELCNTL-FILE-ID,
  9614           DFHEIV20,
  9615           DFHEIV99,
  9616           ELCNTL-KEY,
  9617           DFHEIV99,
  9618           DFHEIV99,
  9619           DFHEIV99
  9620     SET ADDRESS OF CONTROL-FILE TO
  9621         DFHEIV20
  9622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9623
  9624
  9625     IF CF-ZIP-CODE-NUM NOT NUMERIC
  9626         MOVE ZEROS              TO CF-ZIP-CODE-NUM.
  9627
  9628     IF CF-ZIP-CODE-NUM NOT = ZEROS
  9629         MOVE CF-ZIP-CODE-NUM    TO WORK-ZIP
  9630         IF WORK-ZIPR1-4 = ZEROS
  9631             MOVE WORK-ZIPR1-5   TO WORK-ZIPR2-5
  9632             MOVE ZEROS          TO WORK-ZIPR2-4
  9633             MOVE WORK-ZIP       TO CF-ZIP-CODE
  9634         ELSE
  9635             MOVE WORK-ZIP       TO CF-ZIP-CODE.
  9636
  9637     IF CF-CANADIAN-POST-CODE
  9638         MOVE CF-CAN-POSTAL-1    TO WS-CF-CAN-POST-1
  9639         MOVE CF-CAN-POSTAL-2    TO WS-CF-CAN-POST-2
  9640     ELSE
  9641         MOVE CF-ZIP-PRIME       TO WS-CF-ZIP-PRIME
  9642         IF CF-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9643             MOVE '-'            TO WS-CF-ZIP-DASH
  9644             MOVE CF-ZIP-PLUS4   TO WS-CF-ZIP-PLUS4.
  9645
  9646     GO TO 6120-EXIT.
  9647
  9648 6110-NO-RECORD.
  9649     IF ELCNTL-REC-TYPE = 1
  9650         MOVE ER-0022            TO EMI-ERROR
  9651     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 193
* EL640.cbl
  9652         MOVE ER-2208            TO EMI-ERROR
  9653         MOVE -1                 TO ACARIERL
  9654         MOVE AL-UABON           TO ACARIERA
  9655         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9656
  9657 6120-EXIT.
  9658     EXIT.
  9659 6130-FIND-BENEFIT-CD.
  9660
  9661* EXEC CICS READ
  9662*       DATASET (ELCNTL-FILE-ID)
  9663*       SET     (ADDRESS OF CONTROL-FILE)
  9664*       RIDFLD  (ELCNTL-KEY)
  9665*       GTEQ
  9666*       RESP    (WS-RESPONSE)
  9667*    END-EXEC
  9668*    MOVE '&"S        G          (  N#00009054' TO DFHEIV0
  9669     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9670     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9671     MOVE X'204E233030303039303534' TO DFHEIV0(25:11)
  9672     CALL 'kxdfhei1' USING DFHEIV0,
  9673           ELCNTL-FILE-ID,
  9674           DFHEIV20,
  9675           DFHEIV99,
  9676           ELCNTL-KEY,
  9677           DFHEIV99,
  9678           DFHEIV99,
  9679           DFHEIV99
  9680     SET ADDRESS OF CONTROL-FILE TO
  9681         DFHEIV20
  9682     MOVE EIBRESP  TO WS-RESPONSE
  9683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9684     IF ws-RESP-NORMAL
  9685        IF (CF-COMPANY-ID = PI-COMPANY-ID)
  9686           AND (CF-RECORD-TYPE = '5')
  9687           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  9688              (S1 > +8)
  9689              OR (CF-BENEFIT-CODE (S1) = CLAS-LOOK)
  9690           END-PERFORM
  9691           IF S1 NOT > +8
  9692              MOVE CF-BENEFIT-CATEGORY (S1)
  9693                                 TO WS-AH-CATEGORY
  9694              GO TO 6140-EXIT
  9695           END-IF
  9696        END-IF
  9697     END-IF
  9698     .
  9699 6140-NO-RECORD.
  9700     MOVE ER-2208                TO EMI-ERROR
  9701     MOVE -1                     TO ACARIERL
  9702     MOVE AL-UABON               TO ACARIERA
  9703     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  9704     .
  9705 6140-EXIT.
  9706     EXIT.
  9707 6200-REWRITE-CONTROL-FILE.
  9708
  9709
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 194
* EL640.cbl
  9710* EXEC CICS REWRITE
  9711*        DATASET (ELCNTL-FILE-ID)
  9712*        FROM    (CONTROL-FILE)
  9713*    END-EXEC.
  9714     MOVE LENGTH OF
  9715      CONTROL-FILE
  9716       TO DFHEIV11
  9717*    MOVE '&& L                  %   #00009086' TO DFHEIV0
  9718     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9719     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9720     MOVE X'2020233030303039303836' TO DFHEIV0(25:11)
  9721     CALL 'kxdfhei1' USING DFHEIV0,
  9722           ELCNTL-FILE-ID,
  9723           CONTROL-FILE,
  9724           DFHEIV11,
  9725           DFHEIV99
  9726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9727
  9728
  9729 6290-EXIT.
  9730     EXIT.
  9731
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 195
* EL640.cbl
  9733 6300-ELIMINATE-LINE-SPACES.
  9734     IF WS-REMIT-LINES (1) = SPACES
  9735         MOVE WS-REMIT-LINES (2)  TO WS-REMIT-LINES (1)
  9736         MOVE WS-REMIT-LINES (3)  TO WS-REMIT-LINES (2)
  9737         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9738         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9739         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9740         MOVE SPACES              TO WS-REMIT-LINES (6)
  9741         GO TO 6300-ELIMINATE-LINE-SPACES.
  9742
  9743     IF WS-REMIT-LINES (2) = SPACES AND
  9744        WS-REMIT-LINES (3) = SPACES AND
  9745        WS-REMIT-LINES (4) = SPACES AND
  9746        WS-REMIT-LINES (5) = SPACES AND
  9747        WS-REMIT-LINES (6) = SPACES
  9748          GO TO 6350-MOVE-ZIP.
  9749
  9750     IF WS-REMIT-LINES (2) = SPACES
  9751         MOVE WS-REMIT-LINES (3)  TO WS-REMIT-LINES (2)
  9752         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9753         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9754         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9755         MOVE SPACES              TO WS-REMIT-LINES (6)
  9756         GO TO 6300-ELIMINATE-LINE-SPACES.
  9757
  9758     IF WS-REMIT-LINES (3) = SPACES AND
  9759        WS-REMIT-LINES (4) = SPACES AND
  9760        WS-REMIT-LINES (5) = SPACES AND
  9761        WS-REMIT-LINES (6) = SPACES
  9762          GO TO 6350-MOVE-ZIP.
  9763
  9764     IF WS-REMIT-LINES (3) = SPACES
  9765         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9766         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9767         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9768         MOVE SPACES              TO WS-REMIT-LINES (6)
  9769         GO TO 6300-ELIMINATE-LINE-SPACES.
  9770
  9771     IF WS-REMIT-LINES (4) = SPACES AND
  9772        WS-REMIT-LINES (5) = SPACES AND
  9773        WS-REMIT-LINES (6) = SPACES
  9774          GO TO 6350-MOVE-ZIP.
  9775
  9776     IF WS-REMIT-LINES (4) = SPACES
  9777         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9778         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9779         MOVE SPACES              TO WS-REMIT-LINES (6)
  9780         GO TO 6300-ELIMINATE-LINE-SPACES.
  9781
  9782     IF WS-REMIT-LINES (5) = SPACES
  9783         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9784         MOVE SPACES              TO WS-REMIT-LINES (6).
  9785
  9786 6350-MOVE-ZIP.
  9787     IF WS-REMIT-LINES (6) NOT = SPACES
  9788         MOVE WS-REMIT-ZIP (6)        TO WS-R-LAST-ZIP (5)
  9789         MOVE SPACES                  TO WS-REMIT-LINES (6)
  9790     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 196
* EL640.cbl
  9791         IF WS-REMIT-LINES (5) NOT = SPACES
  9792             MOVE WS-REMIT-ZIP (5)     TO WS-R-LAST-ZIP (5)
  9793             MOVE SPACES               TO WS-REMIT-ZIP (5)
  9794         ELSE
  9795             IF WS-REMIT-LINES (4) NOT = SPACES
  9796                 MOVE WS-REMIT-ZIP (4) TO WS-R-LAST-ZIP (4)
  9797                 MOVE SPACES           TO WS-REMIT-ZIP (4).
  9798
  9799 6390-EXIT.
  9800     EXIT.
  9801
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 197
* EL640.cbl
  9803 6400-FORMAT-ACCOUNT-ADDRS.
  9804     IF WS-ACCT-ADDR-AREA = SPACES
  9805         GO TO 6490-EXIT.
  9806
  9807     IF WS-ACCT-LINES (1) = SPACES
  9808         MOVE WS-ACCT-LINES (2)  TO WS-ACCT-LINES (1)
  9809         MOVE WS-ACCT-LINES (3)  TO WS-ACCT-LINES (2)
  9810         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
  9811         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9812         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9813         MOVE SPACES              TO WS-ACCT-LINES (6)
  9814         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9815
  9816     IF WS-ACCT-LINES (2) = SPACES AND
  9817        WS-ACCT-LINES (3) = SPACES AND
  9818        WS-ACCT-LINES (4) = SPACES AND
  9819        WS-ACCT-LINES (5) = SPACES AND
  9820        WS-ACCT-LINES (6) = SPACES
  9821          GO TO 6450-MOVE-ZIP.
  9822
  9823     IF WS-ACCT-LINES (2) = SPACES
  9824         MOVE WS-ACCT-LINES (3)  TO WS-ACCT-LINES (2)
  9825         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
  9826         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9827         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9828         MOVE SPACES             TO WS-ACCT-LINES (6)
  9829         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9830
  9831     IF WS-ACCT-LINES (3) = SPACES AND
  9832        WS-ACCT-LINES (4) = SPACES AND
  9833        WS-ACCT-LINES (5) = SPACES AND
  9834        WS-ACCT-LINES (6) = SPACES
  9835          GO TO 6450-MOVE-ZIP.
  9836
  9837     IF WS-ACCT-LINES (3) = SPACES
  9838         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
  9839         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9840         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9841         MOVE SPACES             TO WS-ACCT-LINES (6)
  9842         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9843
  9844     IF WS-ACCT-LINES (4) = SPACES AND
  9845        WS-ACCT-LINES (5) = SPACES AND
  9846        WS-ACCT-LINES (6) = SPACES
  9847          GO TO 6450-MOVE-ZIP.
  9848
  9849     IF WS-ACCT-LINES (4) = SPACES
  9850         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9851         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9852         MOVE SPACES             TO WS-ACCT-LINES (6)
  9853         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9854
  9855     IF WS-ACCT-LINES (5) = SPACES
  9856         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9857         MOVE SPACES             TO WS-ACCT-LINES (6).
  9858
  9859 6450-MOVE-ZIP.
  9860     IF WS-ACCT-LINES (6) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 198
* EL640.cbl
  9861         MOVE WS-ACCT-ZIP (6)         TO WS-A-LAST-ZIP (5)
  9862         MOVE SPACES                  TO WS-ACCT-LINES (6)
  9863     ELSE
  9864         IF WS-ACCT-LINES (5) NOT = SPACES
  9865             MOVE WS-ACCT-ZIP (5)      TO WS-A-LAST-ZIP (5)
  9866             MOVE SPACES               TO WS-ACCT-ZIP (5)
  9867         ELSE
  9868             IF WS-ACCT-LINES (4) NOT = SPACES
  9869                 MOVE WS-ACCT-ZIP (4)  TO WS-A-LAST-ZIP (4)
  9870                 MOVE SPACES           TO WS-ACCT-ZIP (4).
  9871
  9872 6490-EXIT.
  9873     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 199
* EL640.cbl
  9875 7000-PROCESS-CHECK.
  9876*                *******************************************
  9877*                *    FORMAT THE CHECK SCREEN (EL640D)     *
  9878*                *******************************************
  9879     MOVE LOW-VALUES             TO EL640BO.
  9880
  9881     IF PI-SAV-ACCT = PI-SAV-REMIT-TO
  9882         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  9883         IF EMI-ERROR = ZEROS
  9884             MOVE AM-NAME        TO BNAMEO
  9885             MOVE AM-PERSON      TO BADDR1O
  9886             MOVE AM-ADDRS       TO BADDR2O
  9887*            MOVE AM-CITY        TO BCITYSTO
  9888             STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  9889                DELIMITED BY '  ' INTO BCITYSTO
  9890             END-STRING
  9891             MOVE WS-AM-ZIP      TO BZIPO
  9892         ELSE
  9893             MOVE EL640A         TO PI-MAP-NAME
  9894             MOVE -1             TO BPFNTERL
  9895             GO TO 8200-SEND-DATAONLY
  9896     ELSE
  9897         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  9898         IF EMI-ERROR = ZEROS
  9899             MOVE CO-ACCT-NAME   TO BNAMEO
  9900             MOVE CO-ADDR-1      TO BADDR1O
  9901             MOVE CO-ADDR-2      TO BADDR2O
  9902*            MOVE CO-ADDR-3      TO BCITYSTO
  9903             STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  9904                DELIMITED BY '  ' INTO BCITYSTO
  9905             END-STRING
  9906             MOVE WS-CO-ZIP      TO BZIPO
  9907         ELSE
  9908             MOVE EL640A         TO PI-MAP-NAME
  9909             MOVE -1             TO BPFNTERL
  9910             GO TO 8200-SEND-DATAONLY.
  9911
  9912     MOVE AL-UNNON               TO BCHKAMTA.
  9913     MOVE PI-ACCT-NAME           TO BACCNAMO.
  9914     MOVE PI-SAV-ACCT            TO BACCTO.
  9915     MOVE PI-COMP-CARRIER        TO BCARIERO.
  9916     MOVE PI-COMP-GROUPING       TO BGROUPO.
  9917     MOVE PI-SAV-STATE           TO BSTATEO.
  9918     MOVE PI-MONTH-END-DATE      TO BPAYDT2O
  9919                                    WS-BEGIN-DATE.
  9920     MOVE '01'                   TO WS-BEGIN-DAY.
  9921     MOVE WS-BEGIN-DATE          TO BPAYDT1O.
  9922     MOVE -1                     TO BCHKNOL
  9923
  9924     IF WS-ENTERED-FROM-A
  9925         COMPUTE WORK-CHECK-AMT = PI-END-BAL * -1
  9926         MOVE WORK-CHECK-AMT     TO BCHKAMTO
  9927     ELSE
  9928         MOVE WORK-CHECK-AMT     TO BCHKAMTO.
  9929
  9930     IF WORK-CHECK-AMT NOT > ZEROS
  9931         MOVE ER-3165    TO  EMI-ERROR
  9932         MOVE -1         TO  BCHKAMTL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 200
* EL640.cbl
  9933         MOVE AL-UNBON   TO  BCHKAMTA
  9934         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9935
  9936     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 201
* EL640.cbl
  9938
  9939 7500-PRODUCE-CHECK.
  9940*                *******************************************
  9941*                *   PRODUCES A CHECK FOR LATER PRINTING   *
  9942*                *******************************************
  9943     MOVE SPACES                 TO ELCNTL-KEY.
  9944     MOVE '1'                    TO ELCNTL-REC-TYPE.
  9945     MOVE 'Y'                    TO ELCNTL-UPDATE-SW.
  9946     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  9947
  9948     IF EMI-ERROR NOT = ZEROS
  9949         GO TO 8200-SEND-DATAONLY.
  9950
  9951     IF CR-CHECK-NO-AUTO-SEQ
  9952         IF CR-CHECK-CNT-RESET-VALUE
  9953             MOVE CF-CR-CHECK-COUNTER TO BCHKNOI
  9954             MOVE +1             TO CF-CR-CHECK-COUNTER
  9955             MOVE 6              TO BCHKNOL
  9956         ELSE
  9957             MOVE CF-CR-CHECK-COUNTER TO BCHKNOI
  9958             MOVE 6              TO BCHKNOL
  9959             ADD +1              TO CF-CR-CHECK-COUNTER.
  9960
  9961     IF CR-CHECK-NO-MANUAL
  9962         IF BCHKNOL = ZEROS
  9963             MOVE ER-2438        TO EMI-ERROR
  9964             MOVE -1             TO BCHKNOL
  9965             MOVE AL-UNBON       TO BCHKNOA
  9966             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9967             GO TO 8200-SEND-DATAONLY
  9968         ELSE
  9969             IF BCHKNOI NOT NUMERIC
  9970                 MOVE ER-2439    TO EMI-ERROR
  9971                 MOVE -1         TO BCHKNOL
  9972                 MOVE AL-UNBON   TO BCHKNOA
  9973                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9974                 GO TO 8200-SEND-DATAONLY.
  9975
  9976     PERFORM 7600-CHECK-FORMS THRU 7600-EXIT.
  9977
  9978
  9979* EXEC CICS GETMAIN
  9980*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  9981*        LENGTH  (ERPYAJ-LENGTH)
  9982*        INITIMG (GETMAIN-SPACE)
  9983*    END-EXEC.
  9984*    MOVE ',"IL                  $   #00009340' TO DFHEIV0
  9985     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9986     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9987     MOVE X'2020233030303039333430' TO DFHEIV0(25:11)
  9988     CALL 'kxdfhei1' USING DFHEIV0,
  9989           DFHEIV20,
  9990           ERPYAJ-LENGTH,
  9991           GETMAIN-SPACE
  9992     SET ADDRESS OF PENDING-PAY-ADJ TO
  9993         DFHEIV20
  9994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9995
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 202
* EL640.cbl
  9996
  9997
  9998* EXEC CICS BIF DEEDIT
  9999*        FIELD  (BCHKAMTI)
 10000*        LENGTH (11)
 10001*    END-EXEC.
 10002     MOVE 11
 10003       TO DFHEIV11
 10004*    MOVE '@"L                   #   #00009346' TO DFHEIV0
 10005     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10006     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10007     MOVE X'2020233030303039333436' TO DFHEIV0(25:11)
 10008     CALL 'kxdfhei1' USING DFHEIV0,
 10009           BCHKAMTI,
 10010           DFHEIV11
 10011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10012
 10013
 10014     IF BCHKAMTI NOT > ZEROS
 10015         MOVE ER-3165    TO  EMI-ERROR
 10016         MOVE -1         TO  BCHKAMTL
 10017         MOVE AL-UNBON   TO  BCHKAMTA
 10018         MOVE BCHKAMTI   TO  BCHKAMTO
 10019         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10020         GO TO 8200-SEND-DATAONLY.
 10021
 10022     MOVE 'Y'                    TO PI-CHECK-SW.
 10023     MOVE 'PY'                   TO PY-RECORD-ID.
 10024     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
 10025     MOVE PI-COMP-CARRIER        TO PY-CARRIER.
 10026     MOVE PI-COMP-GROUPING       TO PY-GROUPING.
 10027     MOVE PI-SAV-REMIT-TO        TO PY-FIN-RESP.
 10028     MOVE PI-SAV-ACCT            TO PY-ACCOUNT.
 10029     MOVE 'C'                    TO PY-RECORD-TYPE.
 10030     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
 10031
 10032     IF PI-COMPANY-ID = CLIENT-ITY
 10033        MOVE PI-MONTH-END-DATE   TO WS-PY-END-DT
 10034                                    WS-BEGIN-DATE
 10035        MOVE '01'                TO WS-BEGIN-DAY
 10036        MOVE WS-BEGIN-DATE       TO WS-PY-BEGIN-DT
 10037        MOVE WS-ITY-COMMENT      TO PY-ENTRY-COMMENT
 10038     ELSE
 10039        MOVE WS-CURRENT-DATE-MDY TO WS-PY-CURRENT-DATE
 10040        MOVE WS-PY-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
 10041
 10042     MOVE BCHKAMTI               TO PY-ENTRY-AMT.
 10043     ADD BCHKAMTI TO PI-DISBURSED.
 10044     MOVE BFORM1I                TO PY-LETTER (1).
 10045     MOVE BFORM2I                TO PY-LETTER (2).
 10046     MOVE BFORM3I                TO PY-LETTER (3).
 10047
 10048     IF NOT CR-CHECK-NO-AT-PRINT
 10049         MOVE BCHKNOI            TO PY-CHECK-NUMBER.
 10050
 10051     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
 10052     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
 10053     MOVE WS-CURRENT-DATE        TO PY-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 203
* EL640.cbl
 10054                                    PY-INPUT-DT.
 10055     IF PI-BILL OR PI-REBILLING
 10056         MOVE DC-BIN-DATE-1      TO PY-BILLED-DATE
 10057     ELSE
 10058         MOVE LOW-VALUES         TO PY-BILLED-DATE
 10059                                    PY-AR-DATE.
 10060
 10061     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 10062                                    PY-CHECK-QUE-SEQUENCE.
 10063     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 10064                                    PY-REPORTED-DT
 10065                                    PY-CHECK-WRITTEN-DT.
 10066     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
 10067     MOVE 'B'                    TO PY-CHECK-ORIGIN-SW.
 10068
 10069
 10070* EXEC CICS WRITE
 10071*        DATASET (ERPYAJ-FILE-ID)
 10072*        FROM    (PENDING-PAY-ADJ)
 10073*        RIDFLD  (PY-CONTROL-PRIMARY)
 10074*    END-EXEC.
 10075     MOVE LENGTH OF
 10076      PENDING-PAY-ADJ
 10077       TO DFHEIV11
 10078*    MOVE '&$ L                  ''   #00009406' TO DFHEIV0
 10079     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10080     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10081     MOVE X'2020233030303039343036' TO DFHEIV0(25:11)
 10082     CALL 'kxdfhei1' USING DFHEIV0,
 10083           ERPYAJ-FILE-ID,
 10084           PENDING-PAY-ADJ,
 10085           DFHEIV11,
 10086           PY-CONTROL-PRIMARY,
 10087           DFHEIV99,
 10088           DFHEIV99
 10089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10090
 10091
 10092     IF CR-CHECK-NO-AUTO-SEQ
 10093         PERFORM 6200-REWRITE-CONTROL-FILE THRU 6290-EXIT
 10094     ELSE
 10095
 10096* EXEC CICS UNLOCK
 10097*            DATASET (ELCNTL-FILE-ID)
 10098*        END-EXEC.
 10099*    MOVE '&*                    #   #00009415' TO DFHEIV0
 10100     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10101     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10102     MOVE X'2020233030303039343135' TO DFHEIV0(25:11)
 10103     CALL 'kxdfhei1' USING DFHEIV0,
 10104           ELCNTL-FILE-ID,
 10105           DFHEIV99
 10106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10107
 10108
 10109     MOVE EL640A                 TO PI-MAP-NAME.
 10110     PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT.
 10111     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 204
* EL640.cbl
 10112
 10113 7600-CHECK-FORMS.
 10114
 10115     IF BFORM1L NOT = ZEROS
 10116             AND
 10117        BFORM1I NOT = SPACES
 10118         MOVE BFORM1I            TO ELLETR-FORM-NO
 10119         PERFORM 7620-CHECK-ON-LETTER THRU 7620-EXIT
 10120         IF W-LETTER-NOT-FOUND
 10121             MOVE ER-7389        TO EMI-ERROR
 10122             MOVE -1             TO BFORM1L
 10123             MOVE AL-UABON       TO BFORM1A
 10124             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10125             GO TO 8200-SEND-DATAONLY.
 10126
 10127     IF BFORM2L NOT = ZEROS
 10128             AND
 10129        BFORM2I NOT = SPACES
 10130         MOVE BFORM2I            TO ELLETR-FORM-NO
 10131         PERFORM 7620-CHECK-ON-LETTER THRU 7620-EXIT
 10132
 10133         IF W-LETTER-NOT-FOUND
 10134             MOVE ER-7389        TO EMI-ERROR
 10135             MOVE -1             TO BFORM2L
 10136             MOVE AL-UABON       TO BFORM2A
 10137             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10138             GO TO 8200-SEND-DATAONLY.
 10139
 10140     IF BFORM3L NOT = ZEROS
 10141             AND
 10142        BFORM3I NOT = SPACES
 10143         MOVE BFORM3I            TO ELLETR-FORM-NO
 10144         IF  W-LETTER-NOT-FOUND
 10145             MOVE ER-7389        TO EMI-ERROR
 10146             MOVE -1             TO BFORM3L
 10147             MOVE AL-UABON       TO BFORM3A
 10148             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10149             GO TO 8200-SEND-DATAONLY.
 10150
 10151     IF BFORM1L = ZEROS
 10152         IF BFORM2L NOT = ZEROS
 10153             MOVE BFORM2L        TO BFORM1L
 10154             MOVE BFORM3L        TO BFORM2L
 10155             MOVE BFORM2A        TO BFORM1A
 10156             MOVE BFORM3A        TO BFORM2A
 10157             MOVE BFORM2I        TO BFORM1I
 10158             MOVE BFORM3I        TO BFORM2I
 10159             MOVE LOW-VALUES     TO BFORM3I
 10160                                    BFORM3A
 10161             MOVE ZEROS          TO BFORM3L
 10162         ELSE
 10163             IF BFORM3L NOT = ZEROS
 10164                 MOVE BFORM3L    TO BFORM1L
 10165                 MOVE BFORM3I    TO BFORM1I
 10166                 MOVE BFORM3A    TO BFORM1A
 10167                 MOVE LOW-VALUES TO BFORM3I
 10168                                    BFORM3A
 10169                 MOVE ZEROS      TO BFORM3L
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 205
* EL640.cbl
 10170             ELSE
 10171                 NEXT SENTENCE
 10172     ELSE
 10173         IF BFORM2L = ZEROS
 10174             IF BFORM3L NOT = ZEROS
 10175                 MOVE BFORM3L    TO BFORM2L
 10176                 MOVE BFORM3I    TO BFORM2I
 10177                 MOVE BFORM3A    TO BFORM2A
 10178                 MOVE LOW-VALUES TO BFORM3I
 10179                                    BFORM3A
 10180                 MOVE ZEROS      TO BFORM3L.
 10181
 10182 7600-EXIT.
 10183      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 206
* EL640.cbl
 10185 7620-CHECK-ON-LETTER.
 10186
 10187     MOVE SPACES                 TO W-LETTER-IND.
 10188
 10189     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD.
 10190     MOVE +1                     TO ELLETR-LINE-SEQ.
 10191
 10192
 10193* EXEC CICS HANDLE CONDITION
 10194*        NOTFND   (7620-LETR-NOT-FOUND)
 10195*        ENDFILE  (7620-LETR-NOT-FOUND)
 10196*        NOTOPEN  (7620-LETR-NOT-OPEN)
 10197*    END-EXEC.
 10198*    MOVE '"$I''J                 ! 0 #00009502' TO DFHEIV0
 10199     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 10200     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10201     MOVE X'3020233030303039353032' TO DFHEIV0(25:11)
 10202     CALL 'kxdfhei1' USING DFHEIV0
 10203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10204
 10205
 10206
 10207* EXEC CICS READ
 10208*        SET     (ADDRESS OF TEXT-FILES)
 10209*        DATASET (ELLETR-FILE-ID)
 10210*        RIDFLD  (ELLETR-KEY)
 10211*    END-EXEC.
 10212*    MOVE '&"S        E          (   #00009508' TO DFHEIV0
 10213     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10214     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10215     MOVE X'2020233030303039353038' TO DFHEIV0(25:11)
 10216     CALL 'kxdfhei1' USING DFHEIV0,
 10217           ELLETR-FILE-ID,
 10218           DFHEIV20,
 10219           DFHEIV99,
 10220           ELLETR-KEY,
 10221           DFHEIV99,
 10222           DFHEIV99,
 10223           DFHEIV99
 10224     SET ADDRESS OF TEXT-FILES TO
 10225         DFHEIV20
 10226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10227
 10228
 10229     GO TO 7620-EXIT.
 10230
 10231 7620-LETR-NOT-FOUND.
 10232
 10233     MOVE 'Y'                    TO W-LETTER-IND.
 10234     GO TO 7620-EXIT.
 10235
 10236 7620-LETR-NOT-OPEN.
 10237
 10238     MOVE ER-0013                TO EMI-ERROR.
 10239     MOVE -1                     TO BFORM1L.
 10240     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10241     GO TO 8200-SEND-DATAONLY.
 10242
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 207
* EL640.cbl
 10243 7620-EXIT.
 10244      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 208
* EL640.cbl
 10246 8100-SEND-INITIAL-MAP.
 10247
 10248     MOVE SPACES TO PI-TRANSFER-SW.
 10249
 10250     IF PI-MAP-NAME = EL640A
 10251         NEXT SENTENCE
 10252     ELSE
 10253         GO TO 8110-SEND-INITIAL-CHECK-MAP.
 10254
 10255     IF PI-COMPANY-ID = 'DMD'
 10256        MOVE AL-SADOF            TO APF5HDGA.
 10257
 10258     IF NOT PI-GA-BILLING
 10259        MOVE AL-SADOF            TO AGAHDGA.
 10260
 10261     MOVE WS-CURRENT-DATE-EDIT   TO ADATEO.
 10262     MOVE EIBTIME                TO TIME-IN.
 10263     MOVE TIME-OUT               TO ATIMEO.
 10264     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10265     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10266
 10267     MOVE -1                     TO AACCTL.
 10268     MOVE EMI-MESSAGE-AREA (1)   TO AERMSG1O.
 10269     MOVE EMI-MESSAGE-AREA (2)   TO AERMSG2O.
 10270
 10271     IF CARR-GROUP-ST-ACCNT-CNTL
 10272         NEXT SENTENCE
 10273     ELSE
 10274         IF ST-ACCNT-CNTL
 10275             MOVE AL-SADOF       TO ACARHDGA
 10276                                    AGRPHDGA
 10277             MOVE AL-SANOF       TO ACARIERA
 10278                                    AGROUPA
 10279         ELSE
 10280             IF CARR-ST-ACCNT-CNTL
 10281                 MOVE AL-SADOF   TO AGRPHDGA
 10282                 MOVE AL-SANOF   TO AGROUPA
 10283             ELSE
 10284                 IF ACCNT-CNTL
 10285                     MOVE AL-SADOF TO ACARHDGA
 10286                                      AGRPHDGA
 10287                                      ASTHDGA
 10288                     MOVE AL-SANOF TO ACARIERA
 10289                                      AGROUPA
 10290                                      ASTATEA
 10291                 ELSE
 10292                     IF CARR-ACCNT-CNTL
 10293                         MOVE AL-SADOF TO AGRPHDGA
 10294                                          ASTHDGA
 10295                         MOVE AL-SANOF TO AGROUPA
 10296                                          ASTATEA.
 10297
 10298     IF (EIBTRNID = EL633-TRANS-ID  OR  EL635-TRANS-ID  OR
 10299                    EL633DMD-TRANS-ID  OR
 10300                    EL650-TRANS-ID  OR  EL652-TRANS-ID  OR
 10301                    EL658-TRANS-ID)  AND
 10302          (WT-CR-ACCOUNT NOT = SPACES AND LOW-VALUES)
 10303        MOVE WT-CR-CARRIER       TO PI-SCR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 209
* EL640.cbl
 10304        MOVE WT-CR-GROUPING      TO PI-SCR-GROUPING
 10305        MOVE WT-CR-STATE         TO PI-SCR-STATE
 10306        MOVE WT-CR-FIN-RESP      TO PI-SCR-FIN-RESP
 10307        MOVE WT-CR-TYPE          TO PI-SCR-TYPE
 10308        IF CARR-GROUP-ST-ACCNT-CNTL
 10309            MOVE AL-UANON        TO ACARIERA
 10310                                    AGROUPA
 10311                                    ASTATEA
 10312                                    AACCTA
 10313            MOVE WT-CR-CARRIER   TO ACARIERI
 10314                                    PI-SCR-CARRIER
 10315            MOVE WT-CR-GROUPING  TO AGROUPI
 10316                                    PI-SCR-GROUPING
 10317            MOVE WT-CR-ACCOUNT   TO AACCTI
 10318                                    PI-SCR-ACCOUNT
 10319            MOVE 1               TO ACARIERL
 10320            MOVE 6               TO AGROUPL
 10321            MOVE 10              TO AACCTL
 10322            MOVE -1              TO ASTATEL
 10323        ELSE
 10324         IF ST-ACCNT-CNTL
 10325            MOVE AL-UANON        TO ASTATEA
 10326                                    AACCTA
 10327            MOVE WT-CR-ACCOUNT   TO AACCTI
 10328                                    PI-SCR-ACCOUNT
 10329            MOVE 10              TO AACCTL
 10330            MOVE -1              TO ASTATEL
 10331         ELSE
 10332            IF CARR-ST-ACCNT-CNTL
 10333                MOVE AL-UANON       TO ACARIERA
 10334                                       ASTATEA
 10335                                       AACCTA
 10336                MOVE WT-CR-CARRIER TO ACARIERI
 10337                                      PI-SCR-CARRIER
 10338                MOVE WT-CR-ACCOUNT TO AACCTI
 10339                                      PI-SCR-ACCOUNT
 10340                MOVE 1              TO ACARIERL
 10341                MOVE 10             TO AACCTL
 10342                MOVE -1             TO ASTATEL
 10343            ELSE
 10344                IF ACCNT-CNTL
 10345                    MOVE AL-UANON       TO AACCTA
 10346                    MOVE WT-CR-ACCOUNT  TO AACCTI
 10347                                           PI-SCR-ACCOUNT
 10348                    MOVE 10             TO AACCTL
 10349                    MOVE -1             TO ABILTYPL
 10350                ELSE
 10351                    IF CARR-ACCNT-CNTL
 10352                        MOVE AL-UANON        TO ACARIERA
 10353                                                AACCTA
 10354                        MOVE WT-CR-CARRIER   TO ACARIERI
 10355                                                PI-SCR-CARRIER
 10356                        MOVE WT-CR-ACCOUNT   TO AACCTI
 10357                                                PI-SCR-ACCOUNT
 10358                        MOVE 1               TO ACARIERL
 10359                        MOVE 10              TO AACCTL
 10360                        MOVE -1              TO ABILTYPL.
 10361
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 210
* EL640.cbl
 10362     IF (EIBTRNID = EL6311-TRANS-ID) AND
 10363          (WT-CR-ACCOUNT NOT = SPACES AND LOW-VALUES)
 10364        MOVE WT-CR-CARRIER       TO PI-SCR-CARRIER
 10365        MOVE WT-CR-GROUPING      TO PI-SCR-GROUPING
 10366        MOVE WT-CR-STATE         TO PI-SCR-STATE
 10367        MOVE WT-CR-FIN-RESP      TO PI-SCR-FIN-RESP
 10368        MOVE WT-CR-TYPE          TO PI-SCR-TYPE
 10369        MOVE SPACES              TO PI-SAV-CARR
 10370                                    PI-SAV-GROUP
 10371                                    PI-SAV-STATE
 10372                                    PI-SAV-ACCT
 10373        MOVE LOW-VALUES          TO PI-SAV-EXP-DT
 10374        IF CARR-GROUP-ST-ACCNT-CNTL
 10375            MOVE AL-UANON        TO ACARIERA
 10376                                    AGROUPA
 10377                                    ASTATEA
 10378                                    AACCTA
 10379            MOVE WT-CR-CARRIER   TO ACARIERI
 10380                                    PI-SCR-CARRIER
 10381                                    PI-SAV-CARR
 10382            MOVE WT-CR-GROUPING  TO AGROUPI
 10383                                    PI-SCR-GROUPING
 10384                                    PI-SAV-GROUP
 10385            MOVE WT-CR-STATE     TO ASTATEI
 10386                                    PI-SCR-STATE
 10387            MOVE WT-CR-ACCOUNT   TO AACCTI
 10388                                    PI-SCR-ACCOUNT
 10389            MOVE 1               TO ACARIERL
 10390            MOVE 6               TO AGROUPL
 10391            MOVE 10              TO AACCTL
 10392            MOVE 2               TO ASTATEL
 10393            MOVE -1              TO ABILTYPL
 10394        ELSE
 10395         IF ST-ACCNT-CNTL
 10396            MOVE AL-UANON        TO ASTATEA
 10397                                    AACCTA
 10398            MOVE WT-CR-STATE     TO ASTATEI
 10399                                    PI-SCR-STATE
 10400                                    PI-SAV-STATE
 10401            MOVE WT-CR-ACCOUNT   TO AACCTI
 10402                                    PI-SCR-ACCOUNT
 10403                                    PI-SAV-ACCT
 10404            MOVE 10              TO AACCTL
 10405            MOVE -1              TO ASTATEL
 10406         ELSE
 10407            IF CARR-ST-ACCNT-CNTL
 10408                MOVE AL-UANON      TO ACARIERA
 10409                                      ASTATEA
 10410                                      AACCTA
 10411                MOVE WT-CR-CARRIER TO ACARIERI
 10412                                      PI-SCR-CARRIER
 10413                                      PI-SAV-CARR
 10414                MOVE WT-CR-STATE   TO ASTATEI
 10415                                      PI-SCR-STATE
 10416                                      PI-SAV-STATE
 10417                MOVE WT-CR-ACCOUNT TO AACCTI
 10418                                      PI-SCR-ACCOUNT
 10419                                      PI-SAV-ACCT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 211
* EL640.cbl
 10420                MOVE 1             TO ACARIERL
 10421                MOVE 10            TO AACCTL
 10422                MOVE 2             TO ASTATEL
 10423                MOVE -1            TO ABILTYPL
 10424            ELSE
 10425                IF ACCNT-CNTL
 10426                    MOVE AL-UANON       TO AACCTA
 10427                    MOVE WT-CR-ACCOUNT  TO AACCTI
 10428                                           PI-SCR-ACCOUNT
 10429                                           PI-SAV-ACCT
 10430                    MOVE 10             TO AACCTL
 10431                    MOVE -1             TO ABILTYPL
 10432                ELSE
 10433                    IF CARR-ACCNT-CNTL
 10434                        MOVE AL-UANON        TO ACARIERA
 10435                                                AACCTA
 10436                        MOVE WT-CR-CARRIER   TO ACARIERI
 10437                                                PI-SCR-CARRIER
 10438                                                PI-SAV-CARR
 10439                        MOVE WT-CR-ACCOUNT   TO AACCTI
 10440                                                PI-SCR-ACCOUNT
 10441                                                PI-SAV-ACCT
 10442                        MOVE 1               TO ACARIERL
 10443                        MOVE 10              TO AACCTL
 10444                        MOVE -1              TO ABILTYPL.
 10445
 10446
 10447* EXEC CICS SEND
 10448*        MAP      (PI-MAP-NAME)
 10449*        MAPSET   (MAPSET-NAME)
 10450*        FROM     (EL640AO)
 10451*        ERASE
 10452*        CURSOR
 10453*    END-EXEC.
 10454     MOVE LENGTH OF
 10455      EL640AO
 10456       TO DFHEIV12
 10457     MOVE -1
 10458       TO DFHEIV11
 10459*    MOVE '8$     CT  E    H L F ,   #00009731' TO DFHEIV0
 10460     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10461     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10462     MOVE X'2020233030303039373331' TO DFHEIV0(25:11)
 10463     CALL 'kxdfhei1' USING DFHEIV0,
 10464           PI-MAP-NAME,
 10465           EL640AO,
 10466           DFHEIV12,
 10467           MAPSET-NAME,
 10468           DFHEIV99,
 10469           DFHEIV99,
 10470           DFHEIV99,
 10471           DFHEIV11,
 10472           DFHEIV99,
 10473           DFHEIV99,
 10474           DFHEIV99
 10475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10476
 10477
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 212
* EL640.cbl
 10478     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 213
* EL640.cbl
 10480 8110-SEND-INITIAL-CHECK-MAP.
 10481     MOVE WS-CURRENT-DATE-EDIT   TO BDATEO.
 10482     MOVE EIBTIME                TO TIME-IN.
 10483     MOVE TIME-OUT               TO BTIMEO.
 10484     MOVE PI-COMPANY-ID          TO BCMPNYO.
 10485     MOVE PI-PROCESSOR-ID        TO BUSERIDO.
 10486     MOVE -1                     TO BPFNTERL.
 10487     MOVE EMI-MESSAGE-AREA (1)   TO BERMSGO.
 10488
 10489
 10490* EXEC CICS SEND
 10491*        MAP      (PI-MAP-NAME)
 10492*        MAPSET   (MAPSET-NAME)
 10493*        FROM     (EL640BO)
 10494*        ERASE
 10495*        CURSOR
 10496*    END-EXEC.
 10497     MOVE LENGTH OF
 10498      EL640BO
 10499       TO DFHEIV12
 10500     MOVE -1
 10501       TO DFHEIV11
 10502*    MOVE '8$     CT  E    H L F ,   #00009750' TO DFHEIV0
 10503     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10504     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10505     MOVE X'2020233030303039373530' TO DFHEIV0(25:11)
 10506     CALL 'kxdfhei1' USING DFHEIV0,
 10507           PI-MAP-NAME,
 10508           EL640BO,
 10509           DFHEIV12,
 10510           MAPSET-NAME,
 10511           DFHEIV99,
 10512           DFHEIV99,
 10513           DFHEIV99,
 10514           DFHEIV11,
 10515           DFHEIV99,
 10516           DFHEIV99,
 10517           DFHEIV99
 10518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10519
 10520
 10521     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 214
* EL640.cbl
 10523 8200-SEND-DATAONLY.
 10524     IF PI-MAP-NAME = EL640A
 10525         MOVE WS-CURRENT-DATE-EDIT   TO ADATEO
 10526         MOVE EIBTIME                TO TIME-IN
 10527         MOVE TIME-OUT               TO ATIMEO
 10528         MOVE PI-COMPANY-ID          TO CMPNYIDO
 10529         MOVE PI-PROCESSOR-ID        TO USERIDO
 10530         MOVE EMI-MESSAGE-AREA (1)   TO AERMSG1O
 10531         MOVE EMI-MESSAGE-AREA (2)   TO AERMSG2O
 10532
 10533* EXEC CICS SEND
 10534*            MAP      (PI-MAP-NAME)
 10535*            MAPSET   (MAPSET-NAME)
 10536*            FROM     (EL640AO)
 10537*            DATAONLY
 10538*            ERASEAUP
 10539*            CURSOR
 10540*        END-EXEC
 10541     MOVE LENGTH OF
 10542      EL640AO
 10543       TO DFHEIV12
 10544     MOVE -1
 10545       TO DFHEIV11
 10546*    MOVE '8$D    CT  A    H L F ,   #00009769' TO DFHEIV0
 10547     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 10548     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10549     MOVE X'2020233030303039373639' TO DFHEIV0(25:11)
 10550     CALL 'kxdfhei1' USING DFHEIV0,
 10551           PI-MAP-NAME,
 10552           EL640AO,
 10553           DFHEIV12,
 10554           MAPSET-NAME,
 10555           DFHEIV99,
 10556           DFHEIV99,
 10557           DFHEIV99,
 10558           DFHEIV11,
 10559           DFHEIV99,
 10560           DFHEIV99,
 10561           DFHEIV99
 10562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10563     ELSE
 10564         MOVE WS-CURRENT-DATE-EDIT   TO BDATEO
 10565         MOVE EIBTIME                TO TIME-IN
 10566         MOVE TIME-OUT               TO BTIMEO
 10567         MOVE PI-COMPANY-ID          TO BCMPNYO
 10568         MOVE PI-PROCESSOR-ID        TO BUSERIDO
 10569         MOVE EMI-MESSAGE-AREA (1)   TO BERMSGO
 10570
 10571* EXEC CICS SEND
 10572*            MAP      (PI-MAP-NAME)
 10573*            MAPSET   (MAPSET-NAME)
 10574*            FROM     (EL640BO)
 10575*            DATAONLY
 10576*            ERASEAUP
 10577*            CURSOR
 10578*        END-EXEC.
 10579     MOVE LENGTH OF
 10580      EL640BO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 215
* EL640.cbl
 10581       TO DFHEIV12
 10582     MOVE -1
 10583       TO DFHEIV11
 10584*    MOVE '8$D    CT  A    H L F ,   #00009784' TO DFHEIV0
 10585     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 10586     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10587     MOVE X'2020233030303039373834' TO DFHEIV0(25:11)
 10588     CALL 'kxdfhei1' USING DFHEIV0,
 10589           PI-MAP-NAME,
 10590           EL640BO,
 10591           DFHEIV12,
 10592           MAPSET-NAME,
 10593           DFHEIV99,
 10594           DFHEIV99,
 10595           DFHEIV99,
 10596           DFHEIV11,
 10597           DFHEIV99,
 10598           DFHEIV99,
 10599           DFHEIV99
 10600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10601
 10602
 10603     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 216
* EL640.cbl
 10605 8300-SEND-TEXT.
 10606
 10607* EXEC CICS SEND TEXT
 10608*        FROM     (LOGOFF-TEXT)
 10609*        LENGTH   (LOGOFF-LENGTH)
 10610*        ERASE
 10611*        FREEKB
 10612*    END-EXEC.
 10613*    MOVE '8&      T  E F  H   F -   #00009796' TO DFHEIV0
 10614     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10615     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10616     MOVE X'2020233030303039373936' TO DFHEIV0(25:11)
 10617     CALL 'kxdfhei1' USING DFHEIV0,
 10618           LOGOFF-TEXT,
 10619           LOGOFF-LENGTH,
 10620           DFHEIV99,
 10621           DFHEIV99,
 10622           DFHEIV99,
 10623           DFHEIV99,
 10624           DFHEIV99,
 10625           DFHEIV99,
 10626           DFHEIV99,
 10627           DFHEIV99,
 10628           DFHEIV99,
 10629           DFHEIV99
 10630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10631
 10632
 10633
 10634* EXEC CICS RETURN
 10635*    END-EXEC.
 10636*    MOVE '.(                    ''   #00009803' TO DFHEIV0
 10637     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10638     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10639     MOVE X'2020233030303039383033' TO DFHEIV0(25:11)
 10640     CALL 'kxdfhei1' USING DFHEIV0,
 10641           DFHEIV99,
 10642           DFHEIV99,
 10643           DFHEIV99,
 10644           DFHEIV99,
 10645           DFHEIV99,
 10646           DFHEIV99
 10647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10648
 10649
 10650 8500-DATE-CONVERT.
 10651
 10652* EXEC CICS LINK
 10653*        PROGRAM  (LINK-ELDATCV)
 10654*        COMMAREA (DATE-CONVERSION-DATA)
 10655*        LENGTH   (DC-COMM-LENGTH)
 10656*    END-EXEC.
 10657*    MOVE '."C                   (   #00009807' TO DFHEIV0
 10658     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10659     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10660     MOVE X'2020233030303039383037' TO DFHEIV0(25:11)
 10661     CALL 'kxdfhei1' USING DFHEIV0,
 10662           LINK-ELDATCV,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 217
* EL640.cbl
 10663           DATE-CONVERSION-DATA,
 10664           DC-COMM-LENGTH,
 10665           DFHEIV99,
 10666           DFHEIV99,
 10667           DFHEIV99,
 10668           DFHEIV99
 10669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10670
 10671
 10672 8500-EXIT.
 10673     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 218
* EL640.cbl
 10675 8800-UNAUTHORIZED-ACCESS.
 10676     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10677     GO TO 8300-SEND-TEXT.
 10678
 10679 8810-PF23.
 10680     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 10681     MOVE XCTL-005               TO PGM-NAME.
 10682     GO TO 9300-XCTL.
 10683
 10684 8900-SYNCPOINT-ROLLBACK.
 10685
 10686* EXEC CICS SYNCPOINT
 10687*         ROLLBACK
 10688*    END-EXEC.
 10689*    MOVE '6"R                   !   #00009826' TO DFHEIV0
 10690     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10691     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10692     MOVE X'2020233030303039383236' TO DFHEIV0(25:11)
 10693     CALL 'kxdfhei1' USING DFHEIV0
 10694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10695
 10696
 10697 8900-EXIT.
 10698     EXIT.
 10699
 10700 9100-RETURN-TRAN.
 10701     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10702     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 10703
 10704
 10705* EXEC CICS RETURN
 10706*        TRANSID    (TRANS-ID)
 10707*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10708*        LENGTH     (PI-COMM-LENGTH)
 10709*    END-EXEC.
 10710*    MOVE '.(CT                  ''   #00009837' TO DFHEIV0
 10711     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10712     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10713     MOVE X'2020233030303039383337' TO DFHEIV0(25:11)
 10714     CALL 'kxdfhei1' USING DFHEIV0,
 10715           TRANS-ID,
 10716           PROGRAM-INTERFACE-BLOCK,
 10717           PI-COMM-LENGTH,
 10718           DFHEIV99,
 10719           DFHEIV99,
 10720           DFHEIV99
 10721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10722
 10723
 10724 9200-RETURN-MAIN-MENU.
 10725     MOVE XCTL-626               TO PGM-NAME.
 10726     GO TO 9300-XCTL.
 10727
 10728 9300-XCTL.
 10729
 10730* EXEC CICS XCTL
 10731*        PROGRAM    (PGM-NAME)
 10732*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 219
* EL640.cbl
 10733*        LENGTH     (PI-COMM-LENGTH)
 10734*    END-EXEC.
 10735*    MOVE '.$C                   %   #00009848' TO DFHEIV0
 10736     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10737     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10738     MOVE X'2020233030303039383438' TO DFHEIV0(25:11)
 10739     CALL 'kxdfhei1' USING DFHEIV0,
 10740           PGM-NAME,
 10741           PROGRAM-INTERFACE-BLOCK,
 10742           PI-COMM-LENGTH,
 10743           DFHEIV99
 10744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10745
 10746
 10747 9400-CLEAR.
 10748     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME
 10749     GO TO 9300-XCTL.
 10750
 10751 9500-PF12.
 10752     MOVE XCTL-010               TO PGM-NAME.
 10753     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 220
* EL640.cbl
 10755 9600-PGMID-ERROR.
 10756
 10757* EXEC CICS HANDLE CONDITION
 10758*        PGMIDERR    (8300-SEND-TEXT)
 10759*    END-EXEC.
 10760*    MOVE '"$L                   ! 1 #00009863' TO DFHEIV0
 10761     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10762     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10763     MOVE X'3120233030303039383633' TO DFHEIV0(25:11)
 10764     CALL 'kxdfhei1' USING DFHEIV0
 10765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10766
 10767
 10768     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10769     MOVE ' '                    TO PI-ENTRY-CD-1.
 10770     MOVE XCTL-005               TO PGM-NAME.
 10771     MOVE PGM-NAME               TO LOGOFF-PGM.
 10772     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 10773     GO TO 9300-XCTL.
 10774
 10775 9900-ERROR-FORMAT.
 10776     IF NOT EMI-ERRORS-COMPLETE
 10777         MOVE LINK-001           TO PGM-NAME
 10778
 10779* EXEC CICS LINK
 10780*            PROGRAM    (PGM-NAME)
 10781*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10782*            LENGTH     (EMI-COMM-LENGTH)
 10783*        END-EXEC.
 10784*    MOVE '."C                   (   #00009877' TO DFHEIV0
 10785     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10787     MOVE X'2020233030303039383737' TO DFHEIV0(25:11)
 10788     CALL 'kxdfhei1' USING DFHEIV0,
 10789           PGM-NAME,
 10790           ERROR-MESSAGE-INTERFACE-BLOCK,
 10791           EMI-COMM-LENGTH,
 10792           DFHEIV99,
 10793           DFHEIV99,
 10794           DFHEIV99,
 10795           DFHEIV99
 10796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10797
 10798
 10799 9900-EXIT.
 10800     EXIT.
 10801
 10802 9990-ABEND.
 10803     MOVE LINK-004               TO PGM-NAME.
 10804     MOVE DFHEIBLK               TO EMI-LINE1.
 10805
 10806
 10807* EXEC CICS LINK
 10808*        PROGRAM   (PGM-NAME)
 10809*        COMMAREA  (EMI-LINE1)
 10810*        LENGTH    (72)
 10811*    END-EXEC.
 10812     MOVE 72
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 221
* EL640.cbl
 10813       TO DFHEIV11
 10814*    MOVE '."C                   (   #00009890' TO DFHEIV0
 10815     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10816     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10817     MOVE X'2020233030303039383930' TO DFHEIV0(25:11)
 10818     CALL 'kxdfhei1' USING DFHEIV0,
 10819           PGM-NAME,
 10820           EMI-LINE1,
 10821           DFHEIV11,
 10822           DFHEIV99,
 10823           DFHEIV99,
 10824           DFHEIV99,
 10825           DFHEIV99
 10826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10827
 10828
 10829     IF PI-MAP-NAME = EL640A
 10830         MOVE -1 TO APFNTERL
 10831     ELSE
 10832         MOVE -1 TO BPFNTERL.
 10833
 10834     GO TO 8200-SEND-DATAONLY.
 10835
 10836 9995-SECURITY-VIOLATION.
 10837*                            COPY ELCSCTP.
 10838******************************************************************
 10839*                                                                *
 10840*                            ELCSCTP                             *
 10841*                            VMOD=2.001                          *
 10842*                                                                *
 10843*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10844******************************************************************
 10845
 10846
 10847     MOVE EIBDATE          TO SM-JUL-DATE.
 10848     MOVE EIBTRMID         TO SM-TERMID.
 10849     MOVE THIS-PGM         TO SM-PGM.
 10850     MOVE EIBTIME          TO TIME-IN.
 10851     MOVE TIME-OUT         TO SM-TIME.
 10852     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10853
 10854
 10855* EXEC CICS LINK
 10856*         PROGRAM  ('EL003')
 10857*         COMMAREA (SECURITY-MESSAGE)
 10858*         LENGTH   (80)
 10859*    END-EXEC.
 10860     MOVE 'EL003' TO DFHEIV1
 10861     MOVE 80
 10862       TO DFHEIV11
 10863*    MOVE '."C                   (   #00009921' TO DFHEIV0
 10864     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10865     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10866     MOVE X'2020233030303039393231' TO DFHEIV0(25:11)
 10867     CALL 'kxdfhei1' USING DFHEIV0,
 10868           DFHEIV1,
 10869           SECURITY-MESSAGE,
 10870           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 222
* EL640.cbl
 10871           DFHEIV99,
 10872           DFHEIV99,
 10873           DFHEIV99,
 10874           DFHEIV99
 10875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10876
 10877
 10878******************************************************************
 10879
 10880
 10881
 10882 9999-DFHBACK SECTION.
 10883     MOVE '9%                    "   ' TO DFHEIV0
 10884     MOVE 'EL640' TO DFHEIV1
 10885     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10886     GOBACK.
 10887 9999-DFHEXIT.
 10888     IF DFHEIGDJ EQUAL 0001
 10889         NEXT SENTENCE
 10890     ELSE IF DFHEIGDJ EQUAL 2
 10891         GO TO 9600-PGMID-ERROR,
 10892               9990-ABEND
 10893         DEPENDING ON DFHEIGDI
 10894     ELSE IF DFHEIGDJ EQUAL 3
 10895         GO TO 0890-EXIT
 10896         DEPENDING ON DFHEIGDI
 10897     ELSE IF DFHEIGDJ EQUAL 4
 10898         GO TO 3930-BILL-NOTFND,
 10899               3930-BILL-NOTOPEN
 10900         DEPENDING ON DFHEIGDI
 10901     ELSE IF DFHEIGDJ EQUAL 5
 10902         GO TO 3940-EXIT
 10903         DEPENDING ON DFHEIGDI
 10904     ELSE IF DFHEIGDJ EQUAL 6
 10905         GO TO 4010-REC-NOT-FND
 10906         DEPENDING ON DFHEIGDI
 10907     ELSE IF DFHEIGDJ EQUAL 7
 10908         GO TO 4110-END-OF-FILE
 10909         DEPENDING ON DFHEIGDI
 10910     ELSE IF DFHEIGDJ EQUAL 8
 10911         GO TO 4270-PNDB-NOTFIND,
 10912               4280-PNDB-FILE-NOTOPEN
 10913         DEPENDING ON DFHEIGDI
 10914     ELSE IF DFHEIGDJ EQUAL 9
 10915         GO TO 4370-ACCOUNT-INVALID,
 10916               4380-ACCT-FILE-NOTOPEN
 10917         DEPENDING ON DFHEIGDI
 10918     ELSE IF DFHEIGDJ EQUAL 10
 10919         GO TO 4470-ACCOUNT-INVALID,
 10920               4480-ACCT-FILE-NOTOPEN
 10921         DEPENDING ON DFHEIGDI
 10922     ELSE IF DFHEIGDJ EQUAL 11
 10923         GO TO 4510-REC-NOT-FND
 10924         DEPENDING ON DFHEIGDI
 10925     ELSE IF DFHEIGDJ EQUAL 12
 10926         GO TO 4610-END-OF-FILE
 10927         DEPENDING ON DFHEIGDI
 10928     ELSE IF DFHEIGDJ EQUAL 13
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 223
* EL640.cbl
 10929         GO TO 6070-NO-COMP-MSTR,
 10930               6080-COMP-FILE-NOTOPEN
 10931         DEPENDING ON DFHEIGDI
 10932     ELSE IF DFHEIGDJ EQUAL 14
 10933         GO TO 6045-NO-COMP-MSTR,
 10934               6045-COMP-FILE-NOTOPEN
 10935         DEPENDING ON DFHEIGDI
 10936     ELSE IF DFHEIGDJ EQUAL 15
 10937         GO TO 6110-NO-RECORD
 10938         DEPENDING ON DFHEIGDI
 10939     ELSE IF DFHEIGDJ EQUAL 16
 10940         GO TO 7620-LETR-NOT-FOUND,
 10941               7620-LETR-NOT-FOUND,
 10942               7620-LETR-NOT-OPEN
 10943         DEPENDING ON DFHEIGDI
 10944     ELSE IF DFHEIGDJ EQUAL 17
 10945         GO TO 8300-SEND-TEXT
 10946         DEPENDING ON DFHEIGDI.
 10947     MOVE '9%                    "   ' TO DFHEIV0
 10948     MOVE 'EL640' TO DFHEIV1
 10949     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10950     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8580     Code:       34618
