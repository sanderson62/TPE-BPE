* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   1
* EL650.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL650.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL650.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL650 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 07/14/94 14:53:46.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.048.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   2
* EL650.cbl
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC4 - ACCOUNT MASTER MAINTENANCE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL650AI FILLER
    38* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    39* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
    40*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
    41* 121207  CR2007121100001  PEMA  SPACE OUT ORIG DLR NO ON COPY
    42* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    43******************************************************************
    44
    45 ENVIRONMENT DIVISION.
    46 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   3
* EL650.cbl
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50 77  FILLER  PIC  X(32) VALUE '********************************'.
    51 77  FILLER  PIC  X(32) VALUE '*    EL650 WORKING STORAGE     *'.
    52 77  FILLER  PIC  X(32) VALUE '********* VMOD=2.048 ***********'.
    53
    54 01  WS-COMM-LENGTH          PIC S9(4) COMP VALUE +1500.
    55
    56 01  WS-DATE-AREA.
    57     12  SAVE-DATE           PIC  X(8)       VALUE SPACES.
    58     12  SAVE-BIN-DATE       PIC  XX         VALUE SPACES.
    59
    60 01  STANDARD-AREAS.
    61     12  GETMAIN-SPACE           PIC  X      VALUE SPACE.
    62     12  MAP-NAME                PIC  X(8)   VALUE 'EL650A'.
    63     12  MAPSET-NAME             PIC  X(8)   VALUE 'EL650S'.
    64     12  SCREEN-NUMBER           PIC  X(4)   VALUE '650A'.
    65     12  TRANS-ID                PIC  X(4)   VALUE 'EXC4'.
    66     12  EL6311-TRANS-ID         PIC  X(4)   VALUE 'EXB1'.
    67     12  EL1273-TRANS-ID         PIC  X(4)   VALUE 'EXX3'.
    68     12  EL652-TRANS-ID          PIC  X(4)   VALUE 'EXD4'.
    69     12  EL6523-TRANS-ID         PIC  X(4)   VALUE 'EXDD'.
    70     12  EL6311NC-TRANS-ID       PIC  X(4)   VALUE 'NXB1'.
    71     12  EL640-TRANS-ID          PIC  X(4)   VALUE 'EXC1'.
    72     12  EL658-TRANS-ID          PIC  X(4)   VALUE 'EXJ3'.
    73     12  EL130-TRANS-ID          PIC  X(4)   VALUE 'EX19'.
    74     12  EL6503-TRANS-ID         PIC  X(4)   VALUE 'EXC7'.
    75     12  EL6509-TRANS-ID         PIC  X(4)   VALUE 'EXDA'.
    76     12  EL6592-TRANS-ID         PIC  X(4)   VALUE 'EX66'.
    77     12  EL608-TRANS-ID          PIC  X(4)   VALUE 'EX1E'.
    78     12  THIS-PGM                PIC  X(8)   VALUE 'EL650'.
    79     12  PGM-NAME                PIC  X(8).
    80     12  RETURNED-FROM           PIC  X(8)   VALUE SPACES.
    81     12  TIME-IN                 PIC S9(7)   VALUE ZEROS.
    82     12  TIME-OUT-R  REDEFINES  TIME-IN.
    83         16  FILLER              PIC  X.
    84         16  TIME-OUT            PIC  99V99.
    85         16  FILLER              PIC  XX.
    86     12  XCTL-005                PIC  X(8)   VALUE 'EL005'.
    87     12  XCTL-010                PIC  X(8)   VALUE 'EL010'.
    88     12  XCTL-126                PIC  X(8)   VALUE 'EL126'.
    89     12  XCTL-EL601              PIC  X(8)   VALUE 'EL601 '.
    90     12  XCTL-6501               PIC  X(8)   VALUE 'EL6501'.
    91     12  XCTL-6502               PIC  X(8)   VALUE 'EL6502'.
    92     12  XCTL-6503               PIC  X(8)   VALUE 'EL6503'.
    93     12  XCTL-6504               PIC  X(8)   VALUE 'EL6504'.
    94     12  XCTL-6505               PIC  X(8)   VALUE 'EL6505'.
    95     12  XCTL-6506               PIC  X(8)   VALUE 'EL6506'.
    96     12  XCTL-6508               PIC  X(8)   VALUE 'EL6508'.
    97     12  XCTL-6509               PIC  X(8)   VALUE 'EL6509'.
    98     12  LINK-001                PIC  X(8)   VALUE 'EL001'.
    99     12  LINK-004                PIC  X(8)   VALUE 'EL004'.
   100     12  LINK-ELDATCV            PIC  X(8)   VALUE 'ELDATCV'.
   101     12  FILE-ID                 PIC  X(8)   VALUE SPACES.
   102     12  CNTL-FILE-ID            PIC  X(8)   VALUE 'ELCNTL'.
   103     12  ACCT-FILE-ID            PIC  X(8)   VALUE 'ERACCT'.
   104     12  COMP-FILE-ID            PIC  X(8)   VALUE 'ERCOMP'.
   105     12  NAME-FILE-ID            PIC  X(8)   VALUE 'ERNAME'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   4
* EL650.cbl
   106     12  PEND2-FILE-ID           PIC  X(8)   VALUE 'ERPNDB2'.
   107     12  PLAN-FILE-ID            PIC  X(8)   VALUE 'ERPLAN'.
   108     12  ACCT2-FILE-ID           PIC  X(8)   VALUE 'ERACCT2'.
   109     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   110     12  PLAN-REC-LEN            PIC S9(4)   VALUE +420   COMP.
   111     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   112     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   113     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   114     12  ERGXRF-FILE-ID          PIC  X(8)   VALUE 'ERGXRF'.
   115     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   116     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   117     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   118     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   119     12  BIN-MIN-DATE            PIC  XX     VALUE LOW-VALUES.
   120     12  BIN-MAX-DATE            PIC  XX     VALUE LOW-VALUES.
   121     12  B4-ACCT-KEY.
   122         16  B4-ACCT-CO          PIC  X      VALUE LOW-VALUES.
   123         16  B4-ACCT-CARRIER     PIC  X      VALUE SPACES.
   124         16  B4-ACCT-GROUPING    PIC  X(6)   VALUE SPACES.
   125         16  B4-ACCT-STATE       PIC  XX     VALUE SPACES.
   126         16  B4-ACCT-ACCOUNT     PIC  X(10)  VALUE SPACES.
   127         16  B4-ACCT-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   128         16  B4-ACCT-EFF-DT      PIC  XX     VALUE LOW-VALUES.
   129     12  AF-ACCT-KEY.
   130         16  AF-ACCT-CO          PIC  X      VALUE LOW-VALUES.
   131         16  AF-ACCT-CARRIER     PIC  X      VALUE SPACES.
   132         16  AF-ACCT-GROUPING    PIC  X(6)   VALUE SPACES.
   133         16  AF-ACCT-STATE       PIC  XX     VALUE SPACES.
   134         16  AF-ACCT-ACCOUNT     PIC  X(10)  VALUE SPACES.
   135         16  AF-ACCT-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   136         16  AF-ACCT-EFF-DT      PIC  XX     VALUE LOW-VALUES.
   137     12  GX-AM-CONTROL-PRIMARY.
   138         16  GX-AM-COMPANY-CD    PIC  X      VALUE LOW-VALUES.
   139         16  GX-REST-OF-KEY      PIC  X(21)  VALUE SPACES.
   140         16  GX-AM-CNTL-FILLER   PIC  X(4)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   5
* EL650.cbl
   142*                                copy ERCGXRF.
   143******************************************************************
   144*                                                                *
   145*                                                                *
   146*                            ERCGXRF                             *
   147*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   148*                            VMOD=2.002                          *
   149*                                                                *
   150*   ONLINE CREDIT SYSTEM                                         *
   151*                                                                *
   152*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   153*                                                                *
   154*   FILE TYPE = VSAM,KSDS                                        *
   155*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   156*                                                                *
   157*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   158*       ALTERNATE PATH = NONE                                    *
   159*                                                                *
   160*   LOG = NO                                                     *
   161*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   162*                                                                *
   163******************************************************************
   164
   165 01  AGENT-CROSS-REFERENCE.
   166     12  GX-RECORD-ID                PIC XX.
   167         88  VALID-GX-ID             VALUE 'GX'.
   168
   169     12  GX-CONTROL-PRIMARY.
   170         16  GX-COMPANY-CD           PIC X.
   171         16  GX-CARRIER              PIC X.
   172         16  GX-GROUPING             PIC X(6).
   173         16  GX-AGENT-NO             PIC X(10).
   174
   175     12  GX-MAINT-INFORMATION.
   176         16  GX-LAST-MAINT-DT        PIC XX.
   177         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   178         16  GX-LAST-MAINT-USER      PIC X(4).
   179         16  FILLER                  PIC X(9).
   180
   181     12  FILLER                      PIC X(37).
   182
   183     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   184
   185     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   186                            DEPENDING ON GX-AGENT-POINTER-CNT.
   187         16  GX-AM-CARRIER           PIC X.
   188         16  GX-AM-GROUPING          PIC X(6).
   189         16  GX-AM-STATE             PIC XX.
   190         16  GX-AM-ACCOUNT           PIC X(10).
   191         16  GX-AM-EXPIRATION-DT     PIC XX.
   192         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   193         16  GX-LAST-BILL-DT         PIC XX.
   194         16  GX-AM-EFF-DT            PIC XX.
   195         16  FILLER                  PIC X(4).
   196
   197******************************************************************
   198 01  WORK-AREAS-AND-SWITCHES.
   199     12  WS-PAGE-LINES               PIC  S99    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   6
* EL650.cbl
   200     12  WS-ACCT2-FOUND              PIC  X      VALUE 'N'.
   201     12  GETMAIN-SW                  PIC  X      VALUE SPACES.
   202     12  NEW-KEY-SAVE.
   203         16  NEW-KEY-COMPANY-CD      PIC  X      VALUE LOW-VALUES.
   204         16  NEW-KEY-CNTRL           PIC  X(19)  VALUE SPACES.
   205     12  WS-PLAN-KEY.
   206         16  EK-CCGSA-KEY.
   207           18  EK-COMPANY-CD         PIC  X     VALUE LOW-VALUES.
   208           18  EK-CARRIER            PIC  X     VALUE SPACES.
   209           18  EK-GROUPING           PIC  X(6)  VALUE SPACES.
   210           18  EK-STATE              PIC  XX    VALUE SPACES.
   211           18  EK-ACCOUNT            PIC  X(10) VALUE SPACES.
   212         16  EK-BTYPE                PIC  X     VALUE SPACES.
   213         16  EK-BCODE                PIC  XX    VALUE SPACES.
   214         16  EK-REVISION             PIC  XXX   VALUE SPACES.
   215     12  WS-EXP-SAVE                 PIC  XX    VALUE LOW-VALUES.
   216     12  CURRENT-SAVE                PIC  X(6)  VALUE SPACES.
   217     12  SAVE-ACCT-KEY               PIC  X(26).
   218     12  SAVE-CURR-EXP-DT            PIC  XX    VALUE LOW-VALUES.
   219     12  SAVE-CURR-EFF-DT            PIC  XX    VALUE LOW-VALUES.
   220     12  WS-EFFCHG-SAVE              PIC  9(11) VALUE ZEROS.
   221     12  WS-EXPCHG-SAVE              PIC  9(11) VALUE ZEROS.
   222     12  BIN-CURRENT-SAVE            PIC  XX    VALUE LOW-VALUES.
   223     12  WS-VERIFY-AREA.
   224         16  FILLER      OCCURS  33  TIMES
   225                             INDEXED  BY  WS-INDEX.
   226             20  WS-ACCT-KEY         PIC  X(20).
   227             20  WS-ACCT-EXP-DT      PIC  XX.
   228             20  WS-ACCT-EFF-DT      PIC  XX.
   229             20  WS-ACCT-HI-CERT     PIC  XX.
   230             20  WS-ACCT-LO-CERT     PIC  XX.
   231     12  WS-TEST-KEY                 PIC  X(20)  VALUE SPACES.
   232     12  WS-SAVE-VERIFY-KEY          PIC  X(20)  VALUE SPACES.
   233     12  WS-ACCT-VERIFY-KEY.
   234         16  WS-ACCT-VER-COMP-CD     PIC  X      VALUE LOW-VALUES.
   235         16  WS-ACCT-VER-CARR        PIC  X      VALUE SPACES.
   236         16  WS-ACCT-VER-GROUP       PIC  X(6)   VALUE SPACES.
   237         16  WS-ACCT-VER-STATE       PIC  XX     VALUE SPACES.
   238         16  WS-ACCT-VER-ACCOUNT     PIC  X(10)  VALUE SPACES.
   239         16  WS-ACCT-VER-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   240     12  filler                      pic x(10)   value spaces.
   241     12  KEY-SAVE.
   242         16  SV-CO                   PIC  X      VALUE LOW-VALUES.
   243         16  SV-CARRIER              PIC  X      VALUE SPACES.
   244         16  SV-GROUPING             PIC  X(6)   VALUE SPACES.
   245         16  SV-STATE                PIC  XX     VALUE SPACES.
   246         16  SV-ACCOUNT              PIC  X(10)  VALUE SPACES.
   247
   248     12  WS-DEEDIT-FIELD              PIC X(10)  VALUE SPACES.
   249     12  WS-DT-DEEDIT-FIELD REDEFINES WS-DEEDIT-FIELD
   250                                      PIC X(10).
   251     12  WS-DEEDIT-FIELD-DATE REDEFINES WS-DT-DEEDIT-FIELD.
   252         16  FILLER                   PIC X(4).
   253         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   254
   255     12  WS-AXRF-KEY.
   256         16  WS-AXRF-COMPANY-CD      PIC  X     VALUE LOW-VALUES.
   257         16  WS-AXRF-CARRIER         PIC  X     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   7
* EL650.cbl
   258         16  WS-AXRF-GROUPING        PIC  X(6)  VALUE SPACES.
   259         16  WS-AXRF-AGENT-NO        PIC  X(10) VALUE SPACES.
   260     12  AXRF-SUB                    PIC S9(4) COMP VALUE +0.
   261     12  GX-AGENT-SUB                PIC S9(4) COMP VALUE +0.
   262     12  COMM-WORK-SUB               PIC S9(4) COMP VALUE +0.
   263     12  COMM-WORK-SUB2              PIC S9(4) COMP VALUE +0.
   264     12  ELCNTL-KEY.
   265         16  CNTL-COMP-ID            PIC  X(3) VALUE SPACES.
   266         16  CNTL-REC-TYPE           PIC  X    VALUE SPACES.
   267         16  CNTL-ACCESS.
   268             20  CNTL-STATE          PIC  XX   VALUE SPACES.
   269             20  FILLER              PIC  X    VALUE SPACES.
   270             20  CNTL-CARRIER        PIC  X    VALUE SPACES.
   271         16  CNTL-SEQ-NO             PIC S9(4) COMP VALUE +0.
   272     12  ERPNDB-KEY.
   273         16  PNDB-COMPANY-CD-A1      PIC  X  VALUE LOW-VALUES.
   274         16  PNDB-CARRIER            PIC  X    VALUE SPACES.
   275         16  PNDB-GROUPING           PIC  X(6) VALUE SPACES.
   276         16  PNDB-STATE              PIC  XX   VALUE SPACES.
   277         16  PNDB-ACCOUNT            PIC  X(10) VALUE SPACES.
   278         16  PNDB-CERT-EFF-DT        PIC  XX    VALUE LOW-VALUES.
   279         16  PNDB-CERT-NO            PIC  X(11) VALUE SPACES.
   280         16  PNDB-ALT-CHG-SEQ-NO     PIC S9(4)   COMP VALUE +0.
   281         16  PNDB-RECORD-TYPE        PIC  X   VALUE SPACES.
   282     12  REC-SW                      PIC  9          VALUE 0.
   283         88  REC-FOUND                               VALUE 1.
   284     12  K-WITH-LINE-USED            PIC  9          VALUE 0.
   285         88  K-WITH-LINE-NO                          VALUE 1.
   286     12  RETURN-FROM-SW              PIC  9          VALUE 0.
   287         88  RETURNING-FROM-6501                     VALUE 1.
   288     12  BROWSE-STARTED-SW           PIC  X          VALUE ' '.
   289         88  BROWSE-STARTED                          VALUE 'Y'.
   290     12  FIRST-TIME-SW               PIC  X          VALUE ' '.
   291         88  FIRST-TIME                              VALUE 'Y'.
   292     12  FROM-WHERE-SW               PIC  X          VALUE ' '.
   293         88  FROM-DELETE                             VALUE '1'.
   294         88  FROM-CHANGE                             VALUE '2'.
   295     12  FROM-EL608-SW               PIC  X          VALUE 'N'.
   296     12  PENDING-BUSINESS-SW         PIC  X          VALUE 'N'.
   297         88  THERE-IS-PENDING-BUSINESS               VALUE 'Y'.
   298     12  PENDING-BROWSE-SW           PIC  X          VALUE 'N'.
   299         88  PENDING-BROWSE-STARTED                  VALUE 'Y'.
   300     12  TS-QUEUE.
   301         16  TS-SCREEN               PIC  X(4)   VALUE SPACES.
   302         16  TS-TERM                 PIC  X(4)   VALUE SPACES.
   303     12  TS-LENGTH                   PIC S9(4) COMP VALUE +640.
   304     12  TS-ITEM                     PIC S9(4) COMP VALUE +0.
   305     12  AGT-SUB                     PIC 99      VALUE ZEROS.
   306     12  VALID-AGT-SW                PIC X       VALUE 'N'.
   307
   308 01  ERROR-MESSAGES.
   309     12  ER-0000             PIC  X(4)       VALUE '0000'.
   310     12  ER-0004             PIC  X(4)       VALUE '0004'.
   311     12  ER-0008             PIC  X(4)       VALUE '0008'.
   312     12  ER-0022             PIC  X(4)       VALUE '0022'.
   313     12  ER-0023             PIC  X(4)       VALUE '0023'.
   314     12  ER-0029             PIC  X(4)       VALUE '0029'.
   315     12  ER-0042             PIC  X(4)       VALUE '0042'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   8
* EL650.cbl
   316     12  ER-0050             PIC  X(4)       VALUE '0050'.
   317     12  ER-0052             PIC  X(4)       VALUE '0052'.
   318     12  ER-0066             PIC  X(4)       VALUE '0066'.
   319     12  ER-0067             PIC  X(4)       VALUE '0067'.
   320     12  ER-0070             PIC  X(4)       VALUE '0070'.
   321     12  ER-0144             PIC  X(4)       VALUE '0144'.
   322     12  ER-0168             PIC  X(4)       VALUE '0168'.
   323     12  ER-0193             PIC  X(4)       VALUE '0193'.
   324     12  ER-0195             PIC  X(4)       VALUE '0195'.
   325     12  ER-0216             PIC  X(4)       VALUE '0216'.
   326     12  ER-0226             PIC  X(4)       VALUE '0226'.
   327     12  ER-0348             PIC  X(4)       VALUE '0348'.
   328     12  ER-0453             PIC  X(4)       VALUE '0453'.
   329     12  ER-0454             PIC  X(4)       VALUE '0454'.
   330     12  ER-0455             PIC  X(4)       VALUE '0455'.
   331     12  ER-0456             PIC  X(4)       VALUE '0456'.
   332     12  ER-0457             PIC  X(4)       VALUE '0457'.
   333     12  ER-0470             PIC  X(4)       VALUE '0470'.
   334     12  ER-0471             PIC  X(4)       VALUE '0471'.
   335     12  ER-0472             PIC  X(4)       VALUE '0472'.
   336     12  ER-0482             PIC  X(4)       VALUE '0482'.
   337     12  ER-0561             PIC  X(4)       VALUE '0561'.
   338     12  ER-0619             PIC  X(4)       VALUE '0619'.
   339     12  ER-0630             PIC  X(4)       VALUE '0630'.
   340     12  ER-0668             PIC  X(4)       VALUE '0668'.
   341     12  ER-0899             PIC  X(4)       VALUE '0899'.
   342     12  ER-1220             PIC  X(4)       VALUE '1220'.
   343     12  ER-1228             PIC  X(4)       VALUE '1228'.
   344     12  ER-1238             PIC  X(4)       VALUE '1238'.
   345     12  ER-1299             PIC  X(4)       VALUE '1299'.
   346     12  ER-1612             PIC  X(4)       VALUE '1612'.
   347     12  ER-2051             PIC  X(4)       VALUE '2051'.
   348     12  ER-2052             PIC  X(4)       VALUE '2052'.
   349     12  ER-2053             PIC  X(4)       VALUE '2053'.
   350     12  ER-2054             PIC  X(4)       VALUE '2054'.
   351     12  ER-2058             PIC  X(4)       VALUE '2058'.
   352     12  ER-2059             PIC  X(4)       VALUE '2059'.
   353     12  ER-2060             PIC  X(4)       VALUE '2060'.
   354     12  ER-2061             PIC  X(4)       VALUE '2061'.
   355     12  ER-2062             PIC  X(4)       VALUE '2062'.
   356     12  ER-2063             PIC  X(4)       VALUE '2063'.
   357     12  ER-2064             PIC  X(4)       VALUE '2064'.
   358     12  ER-2065             PIC  X(4)       VALUE '2065'.
   359     12  ER-2066             PIC  X(4)       VALUE '2066'.
   360     12  ER-2068             PIC  X(4)       VALUE '2068'.
   361     12  ER-2069             PIC  X(4)       VALUE '2069'.
   362     12  ER-2070             PIC  X(4)       VALUE '2070'.
   363     12  ER-2072             PIC  X(4)       VALUE '2072'.
   364     12  ER-2073             PIC  X(4)       VALUE '2073'.
   365     12  ER-2074             PIC  X(4)       VALUE '2074'.
   366     12  ER-2075             PIC  X(4)       VALUE '2075'.
   367     12  ER-2087             PIC  X(4)       VALUE '2087'.
   368     12  ER-2113             PIC  X(4)       VALUE '2113'.
   369     12  ER-2151             PIC  X(4)       VALUE '2151'.
   370     12  ER-2370             PIC  X(4)       VALUE '2370'.
   371     12  ER-2572             PIC  X(4)       VALUE '2572'.
   372     12  ER-3155             PIC  X(4)       VALUE '3155'.
   373     12  ER-3785             PIC  X(4)       VALUE '3785'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   9
* EL650.cbl
   374     12  ER-9638             PIC  X(4)       VALUE '9638'.
   375     12  ER-9999             PIC  X(4)       VALUE '9999'.
   376
   377 01  TEMP-STORAGE-RECORD.
   378     12  TS-ACCT-KEY     OCCURS  32  TIMES
   379                             INDEXED  BY  TS-INDEX
   380                                 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  10
* EL650.cbl
   382*    COPY ELCSCTM.
   383******************************************************************
   384*                                                                *
   385*                                                                *
   386*                            ELCSCTM                             *
   387*                            VMOD=2.001                          *
   388*                                                                *
   389*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   390*                                                                *
   391******************************************************************
   392 01  SECURITY-MESSAGE.
   393     12  FILLER                          PIC X(30)
   394            VALUE '** LOGIC SECURITY VIOLATION -'.
   395     12  SM-READ                         PIC X(6).
   396     12  FILLER                          PIC X(5)
   397            VALUE ' PGM='.
   398     12  SM-PGM                          PIC X(6).
   399     12  FILLER                          PIC X(5)
   400            VALUE ' OPR='.
   401     12  SM-PROCESSOR-ID                 PIC X(4).
   402     12  FILLER                          PIC X(6)
   403            VALUE ' TERM='.
   404     12  SM-TERMID                       PIC X(4).
   405     12  FILLER                          PIC XX   VALUE SPACE.
   406     12  SM-JUL-DATE                     PIC 9(5).
   407     12  FILLER                          PIC X    VALUE SPACE.
   408     12  SM-TIME                         PIC 99.99.
   409
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  11
* EL650.cbl
   411*    COPY ELCSCRTY.
   412******************************************************************
   413*                                                                *
   414*                                                                *
   415*                            ELCSCRTY                            *
   416*                            VMOD=2.001                          *
   417*                                                                *
   418*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   419*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   420*        SAVED IN PI-SECURITY-ADDRESS.                           *
   421*                                                                *
   422******************************************************************
   423 01  SECURITY-CONTROL.
   424     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   425     12  FILLER                       PIC XX    VALUE 'SC'.
   426     12  SC-CREDIT-CODES.
   427         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   428             20  SC-CREDIT-DISPLAY    PIC X.
   429             20  SC-CREDIT-UPDATE     PIC X.
   430     12  SC-CLAIMS-CODES.
   431         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   432             20  SC-CLAIMS-DISPLAY    PIC X.
   433             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  12
* EL650.cbl
   435*    COPY ELCLOGOF.
   436******************************************************************
   437*                                                                *
   438*                                                                *
   439*                            ELCLOGOF.                           *
   440*                            VMOD=2.001                          *
   441*                                                                *
   442*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   443*                                                                *
   444******************************************************************
   445 01  CLASIC-LOGOFF.
   446     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   447     12  LOGOFF-TEXT.
   448         16  FILLER          PIC X(5)    VALUE SPACES.
   449         16  LOGOFF-MSG.
   450             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   451             20  FILLER      PIC X       VALUE SPACES.
   452             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   453         16  FILLER          PIC X(80)
   454           VALUE '* YOU ARE NOW LOGGED OFF'.
   455         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   456         16  FILLER          PIC X       VALUE QUOTE.
   457         16  LOGOFF-SYS-MSG  PIC X(17)
   458           VALUE 'S CLAS-IC SYSTEM '.
   459     12  TEXT-MESSAGES.
   460         16  UNACCESS-MSG    PIC X(29)
   461             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   462         16  PGMIDERR-MSG    PIC X(17)
   463             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  13
* EL650.cbl
   465*    COPY ELCDATE.
   466******************************************************************
   467*                                                                *
   468*                                                                *
   469*                            ELCDATE.                            *
   470*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   471*                            VMOD=2.003
   472*                                                                *
   473*                                                                *
   474*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   475*                 LENGTH = 200                                   *
   476******************************************************************
   477
   478 01  DATE-CONVERSION-DATA.
   479     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   480     12  DC-OPTION-CODE                PIC X.
   481         88  BIN-TO-GREG                VALUE ' '.
   482         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   483         88  EDIT-GREG-TO-BIN           VALUE '2'.
   484         88  YMD-GREG-TO-BIN            VALUE '3'.
   485         88  MDY-GREG-TO-BIN            VALUE '4'.
   486         88  JULIAN-TO-BIN              VALUE '5'.
   487         88  BIN-PLUS-ELAPSED           VALUE '6'.
   488         88  FIND-CENTURY               VALUE '7'.
   489         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   490         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   491         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   492         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   493         88  JULIAN-TO-BIN-3            VALUE 'C'.
   494         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   495         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   496         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   497         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   498         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   499         88  CHECK-LEAP-YEAR            VALUE 'H'.
   500         88  BIN-3-TO-GREG              VALUE 'I'.
   501         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   502         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   503         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   504         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   505         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   506         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   507         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   508         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   509         88  THREE-CHARACTER-BIN
   510                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   511         88  GREGORIAN-TO-BIN
   512                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   513         88  BIN-TO-GREGORIAN
   514                  VALUES ' ' '1' 'I' '8' 'G'.
   515         88  JULIAN-TO-BINARY
   516                  VALUES '5' 'C' 'E' 'F'.
   517     12  DC-ERROR-CODE                 PIC X.
   518         88  NO-CONVERSION-ERROR        VALUE ' '.
   519         88  DATE-CONVERSION-ERROR
   520                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   521         88  DATE-IS-ZERO               VALUE '1'.
   522         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  14
* EL650.cbl
   523         88  DATE-IS-INVALID            VALUE '3'.
   524         88  DATE1-GREATER-DATE2        VALUE '4'.
   525         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   526         88  DATE-INVALID-OPTION        VALUE '9'.
   527         88  INVALID-CENTURY            VALUE 'A'.
   528         88  ONLY-CENTURY               VALUE 'B'.
   529         88  ONLY-LEAP-YEAR             VALUE 'C'.
   530         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   531     12  DC-END-OF-MONTH               PIC X.
   532         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   533     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   534         88  USE-NORMAL-PROCESS         VALUE ' '.
   535         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   536         88  ADJUST-UP-100-YRS          VALUE '2'.
   537     12  FILLER                        PIC X.
   538     12  DC-CONVERSION-DATES.
   539         16  DC-BIN-DATE-1             PIC XX.
   540         16  DC-BIN-DATE-2             PIC XX.
   541         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   542         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   543                       DC-GREG-DATE-1-EDIT.
   544             20  DC-EDIT1-MONTH        PIC 99.
   545             20  SLASH1-1              PIC X.
   546             20  DC-EDIT1-DAY          PIC 99.
   547             20  SLASH1-2              PIC X.
   548             20  DC-EDIT1-YEAR         PIC 99.
   549         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   550         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   551                     DC-GREG-DATE-2-EDIT.
   552             20  DC-EDIT2-MONTH        PIC 99.
   553             20  SLASH2-1              PIC X.
   554             20  DC-EDIT2-DAY          PIC 99.
   555             20  SLASH2-2              PIC X.
   556             20  DC-EDIT2-YEAR         PIC 99.
   557         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   558         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   559                     DC-GREG-DATE-1-YMD.
   560             20  DC-YMD-YEAR           PIC 99.
   561             20  DC-YMD-MONTH          PIC 99.
   562             20  DC-YMD-DAY            PIC 99.
   563         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   564         16  DC-GREG-DATE-1-MDY-R REDEFINES
   565                      DC-GREG-DATE-1-MDY.
   566             20  DC-MDY-MONTH          PIC 99.
   567             20  DC-MDY-DAY            PIC 99.
   568             20  DC-MDY-YEAR           PIC 99.
   569         16  DC-GREG-DATE-1-ALPHA.
   570             20  DC-ALPHA-MONTH        PIC X(10).
   571             20  DC-ALPHA-DAY          PIC 99.
   572             20  FILLER                PIC XX.
   573             20  DC-ALPHA-CENTURY.
   574                 24 DC-ALPHA-CEN-N     PIC 99.
   575             20  DC-ALPHA-YEAR         PIC 99.
   576         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   577         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   578         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   579         16  DC-JULIAN-DATE            PIC 9(05).
   580         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  15
* EL650.cbl
   581                                       PIC 9(05).
   582         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   583             20  DC-JULIAN-YEAR        PIC 99.
   584             20  DC-JULIAN-DAYS        PIC 999.
   585         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   586         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   587         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   588     12  DATE-CONVERSION-VARIBLES.
   589         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   590         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   591             20  FILLER                PIC 9(3).
   592             20  HOLD-CEN-1-CCYY.
   593                 24  HOLD-CEN-1-CC     PIC 99.
   594                 24  HOLD-CEN-1-YY     PIC 99.
   595             20  HOLD-CEN-1-MO         PIC 99.
   596             20  HOLD-CEN-1-DA         PIC 99.
   597         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   598             20  HOLD-CEN-1-R-MO       PIC 99.
   599             20  HOLD-CEN-1-R-DA       PIC 99.
   600             20  HOLD-CEN-1-R-CCYY.
   601                 24  HOLD-CEN-1-R-CC   PIC 99.
   602                 24  HOLD-CEN-1-R-YY   PIC 99.
   603             20  FILLER                PIC 9(3).
   604         16  HOLD-CENTURY-1-X.
   605             20  FILLER                PIC X(3)  VALUE SPACES.
   606             20  HOLD-CEN-1-X-CCYY.
   607                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   608                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   609             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   610             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   611         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   612             20  HOLD-CEN-1-R-X-MO     PIC XX.
   613             20  HOLD-CEN-1-R-X-DA     PIC XX.
   614             20  HOLD-CEN-1-R-X-CCYY.
   615                 24  HOLD-CEN-1-R-X-CC PIC XX.
   616                 24  HOLD-CEN-1-R-X-YY PIC XX.
   617             20  FILLER                PIC XXX.
   618         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   619         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   620         16  DC-JULIAN-DATE-1          PIC 9(07).
   621         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   622             20  DC-JULIAN-1-CCYY.
   623                 24  DC-JULIAN-1-CC    PIC 99.
   624                 24  DC-JULIAN-1-YR    PIC 99.
   625             20  DC-JULIAN-DA-1        PIC 999.
   626         16  DC-JULIAN-DATE-2          PIC 9(07).
   627         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   628             20  DC-JULIAN-2-CCYY.
   629                 24  DC-JULIAN-2-CC    PIC 99.
   630                 24  DC-JULIAN-2-YR    PIC 99.
   631             20  DC-JULIAN-DA-2        PIC 999.
   632         16  DC-GREG-DATE-A-EDIT.
   633             20  DC-EDITA-MONTH        PIC 99.
   634             20  SLASHA-1              PIC X VALUE '/'.
   635             20  DC-EDITA-DAY          PIC 99.
   636             20  SLASHA-2              PIC X VALUE '/'.
   637             20  DC-EDITA-CCYY.
   638                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  16
* EL650.cbl
   639                 24  DC-EDITA-YEAR     PIC 99.
   640         16  DC-GREG-DATE-B-EDIT.
   641             20  DC-EDITB-MONTH        PIC 99.
   642             20  SLASHB-1              PIC X VALUE '/'.
   643             20  DC-EDITB-DAY          PIC 99.
   644             20  SLASHB-2              PIC X VALUE '/'.
   645             20  DC-EDITB-CCYY.
   646                 24  DC-EDITB-CENT     PIC 99.
   647                 24  DC-EDITB-YEAR     PIC 99.
   648         16  DC-GREG-DATE-CYMD         PIC 9(08).
   649         16  DC-GREG-DATE-CYMD-R REDEFINES
   650                              DC-GREG-DATE-CYMD.
   651             20  DC-CYMD-CEN           PIC 99.
   652             20  DC-CYMD-YEAR          PIC 99.
   653             20  DC-CYMD-MONTH         PIC 99.
   654             20  DC-CYMD-DAY           PIC 99.
   655         16  DC-GREG-DATE-MDCY         PIC 9(08).
   656         16  DC-GREG-DATE-MDCY-R REDEFINES
   657                              DC-GREG-DATE-MDCY.
   658             20  DC-MDCY-MONTH         PIC 99.
   659             20  DC-MDCY-DAY           PIC 99.
   660             20  DC-MDCY-CEN           PIC 99.
   661             20  DC-MDCY-YEAR          PIC 99.
   662    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   663        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   664    12  DC-EL310-DATE                  PIC X(21).
   665    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  17
* EL650.cbl
   667*    COPY ELCATTR.
   668******************************************************************
   669*                                                                *
   670*                            ELCATTR.                            *
   671*                            VMOD=2.001                          *
   672*                                                                *
   673*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   674*                                                                *
   675*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   676*                                                                *
   677*                   POS 1   P=PROTECTED                          *
   678*                           U=UNPROTECTED                        *
   679*                           S=ASKIP                              *
   680*                   POS 2   A=ALPHA/NUMERIC                      *
   681*                           N=NUMERIC                            *
   682*                   POS 3   N=NORMAL                             *
   683*                           B=BRIGHT                             *
   684*                           D=DARK                               *
   685*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   686*                           OF=MODIFIED DATA TAG OFF             *
   687*                                                                *
   688*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   689******************************************************************
   690 01  ATTRIBUTE-LIST.
   691     12  AL-PABOF            PIC X       VALUE 'Y'.
   692     12  AL-PABON            PIC X       VALUE 'Z'.
   693     12  AL-PADOF            PIC X       VALUE '%'.
   694     12  AL-PADON            PIC X       VALUE '_'.
   695     12  AL-PANOF            PIC X       VALUE '-'.
   696     12  AL-PANON            PIC X       VALUE '/'.
   697     12  AL-SABOF            PIC X       VALUE '8'.
   698     12  AL-SABON            PIC X       VALUE '9'.
   699     12  AL-SADOF            PIC X       VALUE '@'.
   700     12  AL-SADON            PIC X       VALUE QUOTE.
   701     12  AL-SANOF            PIC X       VALUE '0'.
   702     12  AL-SANON            PIC X       VALUE '1'.
   703     12  AL-UABOF            PIC X       VALUE 'H'.
   704     12  AL-UABON            PIC X       VALUE 'I'.
   705     12  AL-UADOF            PIC X       VALUE '<'.
   706     12  AL-UADON            PIC X       VALUE '('.
   707     12  AL-UANOF            PIC X       VALUE ' '.
   708     12  AL-UANON            PIC X       VALUE 'A'.
   709     12  AL-UNBOF            PIC X       VALUE 'Q'.
   710     12  AL-UNBON            PIC X       VALUE 'R'.
   711     12  AL-UNDOF            PIC X       VALUE '*'.
   712     12  AL-UNDON            PIC X       VALUE ')'.
   713     12  AL-UNNOF            PIC X       VALUE '&'.
   714     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  18
* EL650.cbl
   716*    COPY ELCEMIB.
   717******************************************************************
   718*                                                                *
   719*                                                                *
   720*                            ELCEMIB.                            *
   721*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   722*                            VMOD=2.005                          *
   723*                                                                *
   724*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   725*                                                                *
   726******************************************************************
   727 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   728     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   729     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   730     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   731     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   732     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   733     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   734     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   735     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   736     12  EMI-SWITCH1             PIC X        VALUE '1'.
   737         88  EMI-NO-ERRORS                    VALUE '1'.
   738         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   739         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   740     12  EMI-SWITCH2             PIC X        VALUE '1'.
   741         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   742     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   743         88  EMI-AREA1-EMPTY                  VALUE '1'.
   744         88  EMI-AREA1-FULL                   VALUE '2'.
   745     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   746         88  EMI-AREA2-EMPTY                  VALUE '1'.
   747         88  EMI-AREA2-FULL                   VALUE '2'.
   748     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   749         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   750         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   751         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   752         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   753         88  EMI-BYPASS-FATALS                VALUE 'X'.
   754     12  EMI-ERROR-LINES.
   755         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   756         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   757         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   758         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   759             20  EMI-ERR-CODES OCCURS 10 TIMES.
   760                 24  EMI-ERR-NUM         PIC X(4).
   761                 24  EMI-FILLER          PIC X.
   762                 24  EMI-SEV             PIC X.
   763                 24  FILLER              PIC X.
   764             20  FILLER                  PIC X(02).
   765     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   766         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   767             20  EMI-ERROR-NUMBER    PIC X(4).
   768             20  EMI-FILL            PIC X.
   769             20  EMI-SEVERITY        PIC X.
   770             20  FILLER              PIC X.
   771             20  EMI-ERROR-TEXT.
   772                 24  EMI-TEXT-VARIABLE   PIC X(10).
   773                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  19
* EL650.cbl
   774     12  EMI-SEVERITY-SAVE           PIC X.
   775         88  EMI-NOTE                    VALUE 'N'.
   776         88  EMI-WARNING                 VALUE 'W'.
   777         88  EMI-FORCABLE                VALUE 'F'.
   778         88  EMI-FATAL                   VALUE 'X'.
   779     12  EMI-MESSAGE-FLAG            PIC X.
   780         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   781         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   782     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   783     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   784         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   785         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   786         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   787     12  FILLER                      PIC X(137)  VALUE SPACES.
   788     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   789     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   790     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   791     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  20
* EL650.cbl
   793*    COPY ELCINTF.
   794******************************************************************
   795*                                                                *
   796*                                                                *
   797*                            ELCINTF.                            *
   798*                            VMOD=2.017                          *
   799*                                                                *
   800*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   801*                                                                *
   802*       LENGTH = 1024                                            *
   803*                                                                *
   804******************************************************************
   805 01  PROGRAM-INTERFACE-BLOCK.
   806     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   807     12  PI-CALLING-PROGRAM              PIC X(8).
   808     12  PI-SAVED-PROGRAM-1              PIC X(8).
   809     12  PI-SAVED-PROGRAM-2              PIC X(8).
   810     12  PI-SAVED-PROGRAM-3              PIC X(8).
   811     12  PI-SAVED-PROGRAM-4              PIC X(8).
   812     12  PI-SAVED-PROGRAM-5              PIC X(8).
   813     12  PI-SAVED-PROGRAM-6              PIC X(8).
   814     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   815     12  PI-COMPANY-ID                   PIC XXX.
   816     12  PI-COMPANY-CD                   PIC X.
   817
   818     12  PI-COMPANY-PASSWORD             PIC X(8).
   819
   820     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   821
   822     12  PI-CONTROL-IN-PROGRESS.
   823         16  PI-CARRIER                  PIC X.
   824         16  PI-GROUPING                 PIC X(6).
   825         16  PI-STATE                    PIC XX.
   826         16  PI-ACCOUNT                  PIC X(10).
   827         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   828                                         PIC X(10).
   829         16  PI-CLAIM-CERT-GRP.
   830             20  PI-CLAIM-NO             PIC X(7).
   831             20  PI-CERT-NO.
   832                 25  PI-CERT-PRIME       PIC X(10).
   833                 25  PI-CERT-SFX         PIC X.
   834             20  PI-CERT-EFF-DT          PIC XX.
   835         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   836             20  PI-PLAN-CODE            PIC X(2).
   837             20  PI-REVISION-NUMBER      PIC X(3).
   838             20  PI-PLAN-EFF-DT          PIC X(2).
   839             20  PI-PLAN-EXP-DT          PIC X(2).
   840             20  FILLER                  PIC X(11).
   841         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   842             20  PI-OE-REFERENCE-1.
   843                 25  PI-OE-REF-1-PRIME   PIC X(18).
   844                 25  PI-OE-REF-1-SUFF    PIC XX.
   845
   846     12  PI-SESSION-IN-PROGRESS          PIC X.
   847         88  CLAIM-SESSION                   VALUE '1'.
   848         88  CREDIT-SESSION                  VALUE '2'.
   849         88  WARRANTY-SESSION                VALUE '3'.
   850         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  21
* EL650.cbl
   851         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   852
   853
   854*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   855
   856     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   857     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   858
   859     12  PI-CREDIT-USER                  PIC X.
   860         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   861         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   862
   863     12  PI-CLAIM-USER                   PIC X.
   864         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   865         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   866
   867     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   868         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   869         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   870         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   871         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   872         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   873
   874     12  PI-PROCESSOR-ID                 PIC X(4).
   875
   876     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   877
   878     12  PI-MEMBER-CAPTION               PIC X(10).
   879
   880     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   881         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   882
   883     12  PI-LIFE-OVERRIDE-L1             PIC X.
   884     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   885     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   886     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   887
   888     12  PI-AH-OVERRIDE-L1               PIC X.
   889     12  PI-AH-OVERRIDE-L2               PIC XX.
   890     12  PI-AH-OVERRIDE-L6               PIC X(6).
   891     12  PI-AH-OVERRIDE-L12              PIC X(12).
   892
   893     12  PI-NEW-SYSTEM                   PIC X(2).
   894
   895     12  PI-PRIMARY-CERT-NO              PIC X(11).
   896     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   897         88  PI-USES-PAID-TO                 VALUE '1'.
   898     12  PI-CRDTCRD-SYSTEM.
   899         16  PI-CRDTCRD-USER             PIC X.
   900             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   901             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   902         16  PI-CC-MONTH-END-DT          PIC XX.
   903     12  PI-PROCESSOR-PRINTER            PIC X(4).
   904
   905     12  PI-OE-REFERENCE-2.
   906         16  PI-OE-REF-2-PRIME           PIC X(10).
   907         16  PI-OE-REF-2-SUFF            PIC X.
   908
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  22
* EL650.cbl
   909     12  PI-REM-TRM-CALC-OPTION          PIC X.
   910
   911     12  PI-LANGUAGE-TYPE                PIC X.
   912             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   913             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   914             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   915
   916     12  PI-POLICY-LINKAGE-IND           PIC X.
   917         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   918         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   919                                                   LOW-VALUES.
   920
   921     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   922     12  PI-CLAIM-PW-SESSION             PIC X(1).
   923         88  PI-CLAIM-CREDIT                 VALUE '1'.
   924         88  PI-CLAIM-CONVEN                 VALUE '2'.
   925     12  FILLER                          PIC X(4).
   926
   927     12  PI-SYSTEM-LEVEL                 PIC X(145).
   928
   929     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   930         PI-SYSTEM-LEVEL.
   931
   932         16  PI-ENTRY-CODES.
   933             20  PI-ENTRY-CD-1           PIC X.
   934             20  PI-ENTRY-CD-2           PIC X.
   935
   936         16  PI-RETURN-CODES.
   937             20  PI-RETURN-CD-1          PIC X.
   938             20  PI-RETURN-CD-2          PIC X.
   939
   940         16  PI-UPDATE-STATUS-SAVE.
   941             20  PI-UPDATE-BY            PIC X(4).
   942             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   943
   944         16  PI-LOWER-CASE-LETTERS       PIC X.
   945             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   946
   947*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   948*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   949*            88  CARRIER-CLM-CNTL            VALUE '2'.
   950
   951         16  PI-CERT-ACCESS-CONTROL      PIC X.
   952             88  ST-ACCNT-CNTL               VALUE ' '.
   953             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   954             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   955             88  ACCNT-CNTL                  VALUE '3'.
   956             88  CARR-ACCNT-CNTL             VALUE '4'.
   957
   958         16  PI-PROCESSOR-CAP-LIST.
   959             20  PI-SYSTEM-CONTROLS.
   960                24 PI-SYSTEM-DISPLAY     PIC X.
   961                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   962                24 PI-SYSTEM-MODIFY      PIC X.
   963                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   964             20  FILLER                  PIC XX.
   965             20  PI-DISPLAY-CAP          PIC X.
   966                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  23
* EL650.cbl
   967             20  PI-MODIFY-CAP           PIC X.
   968                 88  MODIFY-CAP              VALUE 'Y'.
   969             20  PI-MSG-AT-LOGON-CAP     PIC X.
   970                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   971             20  PI-FORCE-CAP            PIC X.
   972                 88  FORCE-CAP               VALUE 'Y'.
   973
   974         16  PI-PROGRAM-CONTROLS.
   975             20  PI-PGM-PRINT-OPT        PIC X.
   976             20  PI-PGM-FORMAT-OPT       PIC X.
   977             20  PI-PGM-PROCESS-OPT      PIC X.
   978             20  PI-PGM-TOTALS-OPT       PIC X.
   979
   980         16  PI-HELP-INTERFACE.
   981             20  PI-LAST-ERROR-NO        PIC X(4).
   982             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   983
   984         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   985             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   986
   987         16  PI-CR-CONTROL-IN-PROGRESS.
   988             20  PI-CR-CARRIER           PIC X.
   989             20  PI-CR-GROUPING          PIC X(6).
   990             20  PI-CR-STATE             PIC XX.
   991             20  PI-CR-ACCOUNT           PIC X(10).
   992             20  PI-CR-FIN-RESP          PIC X(10).
   993             20  PI-CR-TYPE              PIC X.
   994
   995         16  PI-CR-BATCH-NUMBER          PIC X(6).
   996
   997         16  PI-CR-MONTH-END-DT          PIC XX.
   998
   999         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1000             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1001             88  PI-ZERO-CARRIER             VALUE '1'.
  1002             88  PI-ZERO-GROUPING            VALUE '2'.
  1003             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1004
  1005         16  PI-CARRIER-SECURITY         PIC X.
  1006             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1007
  1008         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1009             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1010             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1011
  1012         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1013             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1014                                         INDEXED BY PI-ACCESS-NDX
  1015                                         PIC X.
  1016
  1017         16  PI-GA-BILLING-CONTROL       PIC X.
  1018             88  PI-GA-BILLING               VALUE '1'.
  1019
  1020         16  PI-MAIL-PROCESSING          PIC X.
  1021             88  PI-MAIL-YES                 VALUE 'Y'.
  1022
  1023         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1024
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  24
* EL650.cbl
  1025         16  PI-AR-SYSTEM.
  1026             20  PI-AR-PROCESSING-CNTL   PIC X.
  1027                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1028             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1029             20  PI-AR-MONTH-END-DT      PIC XX.
  1030
  1031         16  PI-MP-SYSTEM.
  1032             20  PI-MORTGAGE-USER            PIC X.
  1033                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1034                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1035             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1036                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1037                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1038                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1039                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1040                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1041             20  PI-MP-MONTH-END-DT          PIC XX.
  1042             20  PI-MP-REFERENCE-NO.
  1043                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1044                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1045
  1046         16  PI-LABEL-CONTROL            PIC X(01).
  1047             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1048             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1049
  1050         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1051             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1052
  1053         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1054             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1055             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1056
  1057         16  FILLER                      PIC X(14).
  1058
  1059     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1060******************************************************************
  1061*    COPY ELC650PI.
  1062******************************************************************
  1063*
  1064*                            ELC650PI.
  1065*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1066*                            VMOD=2.007
  1067*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1068*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
  1069* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1070*
  1071******************************************************************
  1072
  1073     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1074         16  PI-MAINT                   PIC X.
  1075         16  PI-PREV-ACCOUNT            PIC X(20).
  1076         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1077         16  PI-ACCT-KEY.
  1078             20  PI-ACCT-CCGSA-KEY.
  1079                 24  PI-ACCT-CO             PIC X.
  1080                 24  PI-ACCT-CARRIER        PIC X.
  1081                 24  PI-ACCT-GROUPING       PIC X(6).
  1082                 24  PI-ACCT-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  25
* EL650.cbl
  1083                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1084             20  PI-ACCT-EXP-DT           PIC XX.
  1085             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1086         16  PI-ACCT-ID                 PIC X(8).
  1087         16  PI-PLAN-KEY.
  1088             20  PI-PLAN-ACCT-KEY.
  1089                 24  PI-PLAN-COMPANY-CD PIC X.
  1090                 24  PI-PLAN-CARRIER    PIC X.
  1091                 24  PI-PLAN-GROUP      PIC X(6).
  1092                 24  PI-PLAN-STATE      PIC X(2).
  1093                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1094             20  PI-PLAN-BEN-TYPE       PIC X.
  1095             20  PI-PLAN-BEN            PIC XX.
  1096             20  PI-PLAN-REVISION       PIC X(3).
  1097         16  PI-WS-STATE                PIC XX.
  1098         16  PI-WS-CLASS                PIC XX.
  1099         16  PI-WS-DEV                  PIC X(3).
  1100         16  PI-WS-TYPE                 PIC X.
  1101         16  PI-WS-PLAN                 PIC XX.
  1102
  1103         16  PI-ERPNDB-ALT-KEY.
  1104             20  PI-PB-COMPANY-CD-A1    PIC X.
  1105             20  PI-PB-CARRIER          PIC X.
  1106             20  PI-PB-GROUPING         PIC X(6).
  1107             20  PI-PB-STATE            PIC XX.
  1108             20  PI-PB-ACCOUNT          PIC X(10).
  1109             20  PI-PB-CERT-EFF-DT      PIC XX.
  1110             20  PI-PB-CERT-NO          PIC X(10).
  1111             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1112             20  PI-PB-RECORD-TYPE      PIC X.
  1113
  1114         16  PI-DATE-RANGE-TABLE.
  1115             20  PI-TABLE-ENT OCCURS 32 TIMES
  1116                            INDEXED BY T-INDEX.
  1117                 24  PI-BIN-EFF-DT          PIC XX.
  1118                 24  PI-BIN-EXP-DT          PIC XX.
  1119                 24  PI-BIN-MAINT-DT        PIC XX.
  1120                 24  PI-BIN-LO-CERT         PIC XX.
  1121                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1122                 24  PI-BIN-HI-CERT         PIC XX.
  1123         16  PI-PAGE-NUMBER             PIC S9.
  1124             88  PI-FST-PAGE               VALUE +1.
  1125             88  PI-2ND-PAGE               VALUE +2.
  1126             88  PI-3RD-PAGE               VALUE +3.
  1127             88  PI-LST-PAGE               VALUE +4.
  1128         16  PI-TOTAL-LINES             PIC S99.
  1129         16  PI-LINE-SELECTED    PIC S9.
  1130***  Y2K PROJ 7744
  1131         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1132         16  BIN-EFFCHG-SAVE     PIC XX.
  1133         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1134***  Y2K PROJ 7744
  1135         16  BIN-EXPCHG-SAVE     PIC XX.
  1136         16  PI-RECORD-ADDED-SW  PIC X.
  1137             88  PI-RECORD-ADDED            VALUE '1'.
  1138             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1139         16  PI-ACCNAME          PIC X(30).
  1140         16  PI-COMM-POINTER     PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  26
* EL650.cbl
  1141         16  PI-SV-MAINT         PIC X.
  1142         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1143         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1144         16  PI-UPDATE-SW        PIC X.
  1145             88  PI-CHANGES-MADE             VALUE '1'.
  1146         16  PI-NOTE-TYPE        PIC X.
  1147             88  PI-ACCT-NOTE                VALUE '1'.
  1148         16  PI-DMD-FILE-SW      PIC X.
  1149             88  END-OF-FILE                 VALUE 'E'.
  1150             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1151             88  FIRST-OCCURS                VALUE 'F'.
  1152         16  PI-DMD-OCCURS       PIC S999.
  1153         16  PI-DMD-SCREEN       PIC X.
  1154             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1155             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1156             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1157         16  PI-NAMEFLG          PIC X.
  1158         16  PI-EL650-DEL-SW     PIC X.
  1159         16  FILLER              PIC X(41).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  27
* EL650.cbl
  1161*          16  PI-NAMEFLG       PIC X.
  1162
  1163*    COPY ELCJPFX.
  1164******************************************************************
  1165*                                                                *
  1166*                                                                *
  1167*                            ELCJPFX.                            *
  1168*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1169*                            VMOD=2.002                          *
  1170*                                                                *
  1171*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1172*                                                                *
  1173*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1174*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1175*        ELCNTL - CONTROL FILE                                   *
  1176*        ELMSTR - CLAIM MASTERS                                  *
  1177*        ELTRLR - ACTIVITY TRAILERS                              *
  1178*        ELCHKQ - CHECK QUE                                      *
  1179******************************************************************
  1180 01  JOURNAL-RECORD.
  1181     12  JP-USER-ID                  PIC X(4).
  1182     12  JP-FILE-ID                  PIC X(8).
  1183     12  JP-PROGRAM-ID               PIC X(8).
  1184     12  JP-RECORD-TYPE              PIC X.
  1185         88 JP-ADD              VALUE 'A'.
  1186         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1187         88 JP-AFTER-CHANGE     VALUE 'C'.
  1188         88 JP-DELETE           VALUE 'D'.
  1189         88 JP-GENERIC-DELETE   VALUE 'G'.
  1190         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1191         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1192     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1193     12  JP-RECORD-AREA
  1194
  1195
  1196                                 PIC  X(2000).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  28
* EL650.cbl
  1198*    COPY ELCAID.
  1199******************************************************************
  1200*                                                                *
  1201*                            ELCAID.                             *
  1202*                            VMOD=2.001                          *
  1203*                                                                *
  1204*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1205*                                                                *
  1206*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1207*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1208******************************************************************
  1209
  1210 01  DFHAID.
  1211   02  DFHNULL   PIC  X  VALUE  ' '.
  1212   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1213   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1214   02  DFHPEN    PIC  X  VALUE  '='.
  1215   02  DFHOPID   PIC  X  VALUE  'W'.
  1216   02  DFHPA1    PIC  X  VALUE  '%'.
  1217   02  DFHPA2    PIC  X  VALUE  '>'.
  1218   02  DFHPA3    PIC  X  VALUE  ','.
  1219   02  DFHPF1    PIC  X  VALUE  '1'.
  1220   02  DFHPF2    PIC  X  VALUE  '2'.
  1221   02  DFHPF3    PIC  X  VALUE  '3'.
  1222   02  DFHPF4    PIC  X  VALUE  '4'.
  1223   02  DFHPF5    PIC  X  VALUE  '5'.
  1224   02  DFHPF6    PIC  X  VALUE  '6'.
  1225   02  DFHPF7    PIC  X  VALUE  '7'.
  1226   02  DFHPF8    PIC  X  VALUE  '8'.
  1227   02  DFHPF9    PIC  X  VALUE  '9'.
  1228   02  DFHPF10   PIC  X  VALUE  ':'.
  1229   02  DFHPF11   PIC  X  VALUE  '#'.
  1230   02  DFHPF12   PIC  X  VALUE  '@'.
  1231   02  DFHPF13   PIC  X  VALUE  'A'.
  1232   02  DFHPF14   PIC  X  VALUE  'B'.
  1233   02  DFHPF15   PIC  X  VALUE  'C'.
  1234   02  DFHPF16   PIC  X  VALUE  'D'.
  1235   02  DFHPF17   PIC  X  VALUE  'E'.
  1236   02  DFHPF18   PIC  X  VALUE  'F'.
  1237   02  DFHPF19   PIC  X  VALUE  'G'.
  1238   02  DFHPF20   PIC  X  VALUE  'H'.
  1239   02  DFHPF21   PIC  X  VALUE  'I'.
  1240*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1241   02  DFHPF22   PIC  X  VALUE  '['.
  1242   02  DFHPF23   PIC  X  VALUE  '.'.
  1243   02  DFHPF24   PIC  X  VALUE  '<'.
  1244   02  DFHMSRE   PIC  X  VALUE  'X'.
  1245   02  DFHSTRF   PIC  X  VALUE  'h'.
  1246   02  DFHTRIG   PIC  X  VALUE  '"'.
  1247
  1248 01  FILLER  REDEFINES  DFHAID.
  1249     12  FILLER              PIC  X(8).
  1250     12  PF-VALUES           PIC  X      OCCURS  24  TIMES.
  1251     12  FILLER              PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  29
* EL650.cbl
  1253*    COPY EL650S.
  1254 01  EL650AI.
  1255     05  FILLER            PIC  X(0012).
  1256*    -------------------------------
  1257     05  DATEL PIC S9(0004) COMP.
  1258     05  DATEF PIC  X(0001).
  1259     05  FILLER REDEFINES DATEF.
  1260         10  DATEA PIC  X(0001).
  1261     05  DATEI PIC  X(0008).
  1262*    -------------------------------
  1263     05  TIMEL PIC S9(0004) COMP.
  1264     05  TIMEF PIC  X(0001).
  1265     05  FILLER REDEFINES TIMEF.
  1266         10  TIMEA PIC  X(0001).
  1267     05  TIMEI PIC  X(0005).
  1268*    -------------------------------
  1269     05  CMPNYIDL PIC S9(0004) COMP.
  1270     05  CMPNYIDF PIC  X(0001).
  1271     05  FILLER REDEFINES CMPNYIDF.
  1272         10  CMPNYIDA PIC  X(0001).
  1273     05  CMPNYIDI PIC  X(0003).
  1274*    -------------------------------
  1275     05  USERIDL PIC S9(0004) COMP.
  1276     05  USERIDF PIC  X(0001).
  1277     05  FILLER REDEFINES USERIDF.
  1278         10  USERIDA PIC  X(0001).
  1279     05  USERIDI PIC  X(0004).
  1280*    -------------------------------
  1281     05  MAINTL PIC S9(0004) COMP.
  1282     05  MAINTF PIC  X(0001).
  1283     05  FILLER REDEFINES MAINTF.
  1284         10  MAINTA PIC  X(0001).
  1285     05  MAINTI PIC  X(0001).
  1286*    -------------------------------
  1287     05  TRNMSG1L PIC S9(0004) COMP.
  1288     05  TRNMSG1F PIC  X(0001).
  1289     05  FILLER REDEFINES TRNMSG1F.
  1290         10  TRNMSG1A PIC  X(0001).
  1291     05  TRNMSG1I PIC  X(0017).
  1292*    -------------------------------
  1293     05  LINEL PIC S9(0004) COMP.
  1294     05  LINEF PIC  X(0001).
  1295     05  FILLER REDEFINES LINEF.
  1296         10  LINEA PIC  X(0001).
  1297     05  LINEI PIC  9.
  1298*    -------------------------------
  1299     05  ACARIERL PIC S9(0004) COMP.
  1300     05  ACARIERF PIC  X(0001).
  1301     05  FILLER REDEFINES ACARIERF.
  1302         10  ACARIERA PIC  X(0001).
  1303     05  ACARIERI PIC  X(0001).
  1304*    -------------------------------
  1305     05  AGROUPL PIC S9(0004) COMP.
  1306     05  AGROUPF PIC  X(0001).
  1307     05  FILLER REDEFINES AGROUPF.
  1308         10  AGROUPA PIC  X(0001).
  1309     05  AGROUPI PIC  X(0006).
  1310*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  30
* EL650.cbl
  1311     05  ASTATEL PIC S9(0004) COMP.
  1312     05  ASTATEF PIC  X(0001).
  1313     05  FILLER REDEFINES ASTATEF.
  1314         10  ASTATEA PIC  X(0001).
  1315     05  ASTATEI PIC  X(0002).
  1316*    -------------------------------
  1317     05  AACCTL PIC S9(0004) COMP.
  1318     05  AACCTF PIC  X(0001).
  1319     05  FILLER REDEFINES AACCTF.
  1320         10  AACCTA PIC  X(0001).
  1321     05  AACCTI PIC  X(0010).
  1322*    -------------------------------
  1323     05  NAMEFLGL PIC S9(0004) COMP.
  1324     05  NAMEFLGF PIC  X(0001).
  1325     05  FILLER REDEFINES NAMEFLGF.
  1326         10  NAMEFLGA PIC  X(0001).
  1327     05  NAMEFLGI PIC  X(0001).
  1328*    -------------------------------
  1329     05  NAMEL PIC S9(0004) COMP.
  1330     05  NAMEF PIC  X(0001).
  1331     05  FILLER REDEFINES NAMEF.
  1332         10  NAMEA PIC  X(0001).
  1333     05  NAMEI PIC  X(0030).
  1334*    -------------------------------
  1335     05  ARHDGL PIC S9(0004) COMP.
  1336     05  ARHDGF PIC  X(0001).
  1337     05  FILLER REDEFINES ARHDGF.
  1338         10  ARHDGA PIC  X(0001).
  1339     05  ARHDGI PIC  X(0010).
  1340*    -------------------------------
  1341     05  DET1L PIC S9(0004) COMP.
  1342     05  DET1F PIC  X(0001).
  1343     05  FILLER REDEFINES DET1F.
  1344         10  DET1A PIC  X(0001).
  1345     05  DET1I PIC  X(0070).
  1346*    -------------------------------
  1347     05  DET2L PIC S9(0004) COMP.
  1348     05  DET2F PIC  X(0001).
  1349     05  FILLER REDEFINES DET2F.
  1350         10  DET2A PIC  X(0001).
  1351     05  DET2I PIC  X(0070).
  1352*    -------------------------------
  1353     05  DET3L PIC S9(0004) COMP.
  1354     05  DET3F PIC  X(0001).
  1355     05  FILLER REDEFINES DET3F.
  1356         10  DET3A PIC  X(0001).
  1357     05  DET3I PIC  X(0070).
  1358*    -------------------------------
  1359     05  DET4L PIC S9(0004) COMP.
  1360     05  DET4F PIC  X(0001).
  1361     05  FILLER REDEFINES DET4F.
  1362         10  DET4A PIC  X(0001).
  1363     05  DET4I PIC  X(0070).
  1364*    -------------------------------
  1365     05  DET5L PIC S9(0004) COMP.
  1366     05  DET5F PIC  X(0001).
  1367     05  FILLER REDEFINES DET5F.
  1368         10  DET5A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  31
* EL650.cbl
  1369     05  DET5I PIC  X(0070).
  1370*    -------------------------------
  1371     05  DET6L PIC S9(0004) COMP.
  1372     05  DET6F PIC  X(0001).
  1373     05  FILLER REDEFINES DET6F.
  1374         10  DET6A PIC  X(0001).
  1375     05  DET6I PIC  X(0070).
  1376*    -------------------------------
  1377     05  DET7L PIC S9(0004) COMP.
  1378     05  DET7F PIC  X(0001).
  1379     05  FILLER REDEFINES DET7F.
  1380         10  DET7A PIC  X(0001).
  1381     05  DET7I PIC  X(0070).
  1382*    -------------------------------
  1383     05  DET8L PIC S9(0004) COMP.
  1384     05  DET8F PIC  X(0001).
  1385     05  FILLER REDEFINES DET8F.
  1386         10  DET8A PIC  X(0001).
  1387     05  DET8I PIC  X(0070).
  1388*    -------------------------------
  1389     05  TRNMSG2L PIC S9(0004) COMP.
  1390     05  TRNMSG2F PIC  X(0001).
  1391     05  FILLER REDEFINES TRNMSG2F.
  1392         10  TRNMSG2A PIC  X(0001).
  1393     05  TRNMSG2I PIC  X(0020).
  1394*    -------------------------------
  1395     05  EFFCHGL PIC S9(0004) COMP.
  1396     05  EFFCHGF PIC  X(0001).
  1397     05  FILLER REDEFINES EFFCHGF.
  1398         10  EFFCHGA PIC  X(0001).
  1399     05  EFFCHGI PIC  X(0008).
  1400*    -------------------------------
  1401     05  EXPCHGL PIC S9(0004) COMP.
  1402     05  EXPCHGF PIC  X(0001).
  1403     05  FILLER REDEFINES EXPCHGF.
  1404         10  EXPCHGA PIC  X(0001).
  1405     05  EXPCHGI PIC  X(0008).
  1406*    -------------------------------
  1407     05  TRNMSG3L PIC S9(0004) COMP.
  1408     05  TRNMSG3F PIC  X(0001).
  1409     05  FILLER REDEFINES TRNMSG3F.
  1410         10  TRNMSG3A PIC  X(0001).
  1411     05  TRNMSG3I PIC  X(0003).
  1412*    -------------------------------
  1413     05  TRNTOL PIC S9(0004) COMP.
  1414     05  TRNTOF PIC  X(0001).
  1415     05  FILLER REDEFINES TRNTOF.
  1416         10  TRNTOA PIC  X(0001).
  1417     05  TRNTOI PIC  X(0019).
  1418*    -------------------------------
  1419     05  TRNTODTL PIC S9(0004) COMP.
  1420     05  TRNTODTF PIC  X(0001).
  1421     05  FILLER REDEFINES TRNTODTF.
  1422         10  TRNTODTA PIC  X(0001).
  1423     05  TRNTODTI PIC  X(0008).
  1424*    -------------------------------
  1425     05  TRNMSG4L PIC S9(0004) COMP.
  1426     05  TRNMSG4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  32
* EL650.cbl
  1427     05  FILLER REDEFINES TRNMSG4F.
  1428         10  TRNMSG4A PIC  X(0001).
  1429     05  TRNMSG4I PIC  X(0005).
  1430*    -------------------------------
  1431     05  TRNFROML PIC S9(0004) COMP.
  1432     05  TRNFROMF PIC  X(0001).
  1433     05  FILLER REDEFINES TRNFROMF.
  1434         10  TRNFROMA PIC  X(0001).
  1435     05  TRNFROMI PIC  X(0019).
  1436*    -------------------------------
  1437     05  TRNFRDTL PIC S9(0004) COMP.
  1438     05  TRNFRDTF PIC  X(0001).
  1439     05  FILLER REDEFINES TRNFRDTF.
  1440         10  TRNFRDTA PIC  X(0001).
  1441     05  TRNFRDTI PIC  X(0008).
  1442*    -------------------------------
  1443     05  ERRMSG1L PIC S9(0004) COMP.
  1444     05  ERRMSG1F PIC  X(0001).
  1445     05  FILLER REDEFINES ERRMSG1F.
  1446         10  ERRMSG1A PIC  X(0001).
  1447     05  ERRMSG1I PIC  X(0075).
  1448*    -------------------------------
  1449     05  ERRMSG2L PIC S9(0004) COMP.
  1450     05  ERRMSG2F PIC  X(0001).
  1451     05  FILLER REDEFINES ERRMSG2F.
  1452         10  ERRMSG2A PIC  X(0001).
  1453     05  ERRMSG2I PIC  X(0075).
  1454*    -------------------------------
  1455     05  PFENTERL PIC S9(0004) COMP.
  1456     05  PFENTERF PIC  X(0001).
  1457     05  FILLER REDEFINES PFENTERF.
  1458         10  PFENTERA PIC  X(0001).
  1459     05  PFENTERI PIC  9(2).
  1460 01  EL650AO REDEFINES EL650AI.
  1461     05  FILLER            PIC  X(0012).
  1462*    -------------------------------
  1463     05  FILLER            PIC  X(0003).
  1464     05  DATEO PIC  X(0008).
  1465*    -------------------------------
  1466     05  FILLER            PIC  X(0003).
  1467     05  TIMEO PIC  99.99.
  1468*    -------------------------------
  1469     05  FILLER            PIC  X(0003).
  1470     05  CMPNYIDO PIC  X(0003).
  1471*    -------------------------------
  1472     05  FILLER            PIC  X(0003).
  1473     05  USERIDO PIC  X(0004).
  1474*    -------------------------------
  1475     05  FILLER            PIC  X(0003).
  1476     05  MAINTO PIC  X(0001).
  1477*    -------------------------------
  1478     05  FILLER            PIC  X(0003).
  1479     05  TRNMSG1O PIC  X(0017).
  1480*    -------------------------------
  1481     05  FILLER            PIC  X(0003).
  1482     05  LINEO PIC  X(0001).
  1483*    -------------------------------
  1484     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  33
* EL650.cbl
  1485     05  ACARIERO PIC  X(0001).
  1486*    -------------------------------
  1487     05  FILLER            PIC  X(0003).
  1488     05  AGROUPO PIC  X(0006).
  1489*    -------------------------------
  1490     05  FILLER            PIC  X(0003).
  1491     05  ASTATEO PIC  X(0002).
  1492*    -------------------------------
  1493     05  FILLER            PIC  X(0003).
  1494     05  AACCTO PIC  X(0010).
  1495*    -------------------------------
  1496     05  FILLER            PIC  X(0003).
  1497     05  NAMEFLGO PIC  X(0001).
  1498*    -------------------------------
  1499     05  FILLER            PIC  X(0003).
  1500     05  NAMEO PIC  X(0030).
  1501*    -------------------------------
  1502     05  FILLER            PIC  X(0003).
  1503     05  ARHDGO PIC  X(0010).
  1504*    -------------------------------
  1505     05  FILLER            PIC  X(0003).
  1506     05  DET1O PIC  X(0070).
  1507*    -------------------------------
  1508     05  FILLER            PIC  X(0003).
  1509     05  DET2O PIC  X(0070).
  1510*    -------------------------------
  1511     05  FILLER            PIC  X(0003).
  1512     05  DET3O PIC  X(0070).
  1513*    -------------------------------
  1514     05  FILLER            PIC  X(0003).
  1515     05  DET4O PIC  X(0070).
  1516*    -------------------------------
  1517     05  FILLER            PIC  X(0003).
  1518     05  DET5O PIC  X(0070).
  1519*    -------------------------------
  1520     05  FILLER            PIC  X(0003).
  1521     05  DET6O PIC  X(0070).
  1522*    -------------------------------
  1523     05  FILLER            PIC  X(0003).
  1524     05  DET7O PIC  X(0070).
  1525*    -------------------------------
  1526     05  FILLER            PIC  X(0003).
  1527     05  DET8O PIC  X(0070).
  1528*    -------------------------------
  1529     05  FILLER            PIC  X(0003).
  1530     05  TRNMSG2O PIC  X(0020).
  1531*    -------------------------------
  1532     05  FILLER            PIC  X(0003).
  1533     05  EFFCHGO PIC  X(0008).
  1534*    -------------------------------
  1535     05  FILLER            PIC  X(0003).
  1536     05  EXPCHGO PIC  99B99B99.
  1537*    -------------------------------
  1538     05  FILLER            PIC  X(0003).
  1539     05  TRNMSG3O PIC  X(0003).
  1540*    -------------------------------
  1541     05  FILLER            PIC  X(0003).
  1542     05  TRNTOO PIC  X(0019).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  34
* EL650.cbl
  1543*    -------------------------------
  1544     05  FILLER            PIC  X(0003).
  1545     05  TRNTODTO PIC  X(0008).
  1546*    -------------------------------
  1547     05  FILLER            PIC  X(0003).
  1548     05  TRNMSG4O PIC  X(0005).
  1549*    -------------------------------
  1550     05  FILLER            PIC  X(0003).
  1551     05  TRNFROMO PIC  X(0019).
  1552*    -------------------------------
  1553     05  FILLER            PIC  X(0003).
  1554     05  TRNFRDTO PIC  X(0008).
  1555*    -------------------------------
  1556     05  FILLER            PIC  X(0003).
  1557     05  ERRMSG1O PIC  X(0075).
  1558*    -------------------------------
  1559     05  FILLER            PIC  X(0003).
  1560     05  ERRMSG2O PIC  X(0075).
  1561*    -------------------------------
  1562     05  FILLER            PIC  X(0003).
  1563     05  PFENTERO PIC  X(0002).
  1564*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  35
* EL650.cbl
  1566 01  EL650R  REDEFINES  EL650AI.
  1567     12  FILLER                      PIC  X(153).
  1568     12  MAP-RECORD-AREA.
  1569         16  DATE-RANGES     OCCURS  8  TIMES
  1570                                 INDEXED  BY  M-INDEX.
  1571             20  FILLER              PIC  X(3).
  1572             20  MAP-EFF-DT          PIC  X(8).
  1573             20  FILLER              PIC  X(6).
  1574             20  MAP-EXP-DT          PIC  X(8).
  1575             20  MAP-EXP-DT-ED  REDEFINES
  1576                 MAP-EXP-DT          PIC 99B99B99.
  1577             20  FILLER              PIC  X(4).
  1578             20  MAP-LST-MAINT-DT    PIC  X(8).
  1579             20  FILLER              PIC  X(3).
  1580             20  MAP-LOW-CERT        PIC  X(8).
  1581             20  FILLER              PIC  X(3).
  1582             20  MAP-HIGH-CERT       PIC  X(8).
  1583             20  FILLER              PIC  X(4).
  1584             20  MAP-AR-DATE         PIC  X(8).
  1585             20  FILLER              PIC  XX.
  1586     12  FILLER                      PIC  X(286).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  36
* EL650.cbl
  1588****************************************************************
  1589*
  1590* Copyright (c) 2007 by Clerity Solutions, Inc.
  1591* All rights reserved.
  1592*
  1593****************************************************************
  1594 01  DFHEIV.
  1595   02  DFHEIV0               PIC X(35).
  1596   02  DFHEIV1               PIC X(08).
  1597   02  DFHEIV2               PIC X(08).
  1598   02  DFHEIV3               PIC X(08).
  1599   02  DFHEIV4               PIC X(06).
  1600   02  DFHEIV5               PIC X(04).
  1601   02  DFHEIV6               PIC X(04).
  1602   02  DFHEIV7               PIC X(02).
  1603   02  DFHEIV8               PIC X(02).
  1604   02  DFHEIV9               PIC X(01).
  1605   02  DFHEIV10              PIC S9(7) COMP-3.
  1606   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1607   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1608   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1609   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1610   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1611   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1612   02  DFHEIV17              PIC X(04).
  1613   02  DFHEIV18              PIC X(04).
  1614   02  DFHEIV19              PIC X(04).
  1615   02  DFHEIV20              USAGE IS POINTER.
  1616   02  DFHEIV21              USAGE IS POINTER.
  1617   02  DFHEIV22              USAGE IS POINTER.
  1618   02  DFHEIV23              USAGE IS POINTER.
  1619   02  DFHEIV24              USAGE IS POINTER.
  1620   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1621   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1622   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1623   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1624   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1625   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1626   02  FILLER                PIC X(02).
  1627   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1628   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1629   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1630   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1631   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1632 LINKAGE  SECTION.
  1633*****************************************************************
  1634*                                                               *
  1635* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1636* All rights reserved.                                          *
  1637*                                                               *
  1638*****************************************************************
  1639 01  dfheiblk.
  1640     02  eibtime          pic s9(7) comp-3.
  1641     02  eibdate          pic s9(7) comp-3.
  1642     02  eibtrnid         pic x(4).
  1643     02  eibtaskn         pic s9(7) comp-3.
  1644     02  eibtrmid         pic x(4).
  1645     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  37
* EL650.cbl
  1646     02  eibcposn         pic s9(4) comp.
  1647     02  eibcalen         pic s9(4) comp.
  1648     02  eibaid           pic x(1).
  1649     02  eibfiller1       pic x(1).
  1650     02  eibfn            pic x(2).
  1651     02  eibfiller2       pic x(2).
  1652     02  eibrcode         pic x(6).
  1653     02  eibfiller3       pic x(2).
  1654     02  eibds            pic x(8).
  1655     02  eibreqid         pic x(8).
  1656     02  eibrsrce         pic x(8).
  1657     02  eibsync          pic x(1).
  1658     02  eibfree          pic x(1).
  1659     02  eibrecv          pic x(1).
  1660     02  eibsend          pic x(1).
  1661     02  eibatt           pic x(1).
  1662     02  eibeoc           pic x(1).
  1663     02  eibfmh           pic x(1).
  1664     02  eibcompl         pic x(1).
  1665     02  eibsig           pic x(1).
  1666     02  eibconf          pic x(1).
  1667     02  eiberr           pic x(1).
  1668     02  eibrldbk         pic x(1).
  1669     02  eiberrcd         pic x(4).
  1670     02  eibsynrb         pic x(1).
  1671     02  eibnodat         pic x(1).
  1672     02  eibfiller5       pic x(2).
  1673     02  eibresp          pic 9(09) comp.
  1674     02  eibresp2         pic 9(09) comp.
  1675     02  dfheigdj         pic s9(4) comp.
  1676     02  dfheigdk         pic s9(4) comp.
  1677 01  DFHCOMMAREA             PIC  X(1500).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  38
* EL650.cbl
  1679*01 PARMLIST .
  1680*    12  FILLER              PIC S9(8)   COMP.
  1681*    12  ERACCT-POINTER      PIC S9(8)   COMP.
  1682*    12  ERCOMP-POINTER      PIC S9(8)   COMP.
  1683*    12  ERNAME-POINTER      PIC S9(8)   COMP.
  1684*    12  ERPLAN-POINTER      PIC S9(8)   COMP.
  1685*    12  ELCNTL-POINTER      PIC S9(8)   COMP.
  1686*    12  ERPNDB-POINTER      PIC S9(8)   COMP.
  1687*    12  AXRF-POINTER        PIC S9(8)   COMP.
  1688*    12  AXRF2-POINTER       PIC S9(8)   COMP.
  1689*    12  AXRF3-POINTER       PIC S9(8)   COMP.
  1690*    12  AXRF4-POINTER       PIC S9(8)   COMP.
  1691*    12  AXRF5-POINTER       PIC S9(8)   COMP.
  1692*    12  AXRF6-POINTER       PIC S9(8)   COMP.
  1693*    12  AXRF7-POINTER       PIC S9(8)   COMP.
  1694*    12  AXRF8-POINTER       PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  39
* EL650.cbl
  1696*    COPY ERCACCT.
  1697******************************************************************
  1698*                                                                *
  1699*                                                                *
  1700*                            ERCACCT                             *
  1701*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1702*                            VMOD=2.031                          *
  1703*                                                                *
  1704*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1705*                                                                *
  1706*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1707*   VSAM ACCOUNT MASTER FILES.                                   *
  1708*                                                                *
  1709*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1710*                                                                *
  1711*   FILE TYPE = VSAM,KSDS                                        *
  1712*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1713*                                                                *
  1714*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1715*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1716*                                                                *
  1717*   LOG = NO                                                     *
  1718*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1719*                                                                *
  1720*                                                                *
  1721******************************************************************
  1722*                   C H A N G E   L O G
  1723*
  1724* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1725*-----------------------------------------------------------------
  1726*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1727* EFFECTIVE    NUMBER
  1728*-----------------------------------------------------------------
  1729* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1730* 092705    2005050300006  PEMA  ADD SPP LEASES
  1731* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1732* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1733******************************************************************
  1734
  1735 01  ACCOUNT-MASTER.
  1736     12  AM-RECORD-ID                      PIC XX.
  1737         88  VALID-AM-ID                      VALUE 'AM'.
  1738
  1739     12  AM-CONTROL-PRIMARY.
  1740         16  AM-COMPANY-CD                 PIC X.
  1741         16  AM-MSTR-CNTRL.
  1742             20  AM-CONTROL-A.
  1743                 24  AM-CARRIER            PIC X.
  1744                 24  AM-GROUPING.
  1745                     28 AM-GROUPING-PREFIX PIC XXX.
  1746                     28 AM-GROUPING-PRIME  PIC XXX.
  1747                 24  AM-STATE              PIC XX.
  1748                 24  AM-ACCOUNT.
  1749                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1750                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1751             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1752                                           PIC X(19).
  1753             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  40
* EL650.cbl
  1754                 24  AM-EXPIRATION-DT      PIC XX.
  1755                 24  FILLER                PIC X(4).
  1756             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1757                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1758
  1759     12  AM-CONTROL-BY-VAR-GRP.
  1760         16  AM-COMPANY-CD-A1              PIC X.
  1761         16  AM-VG-CARRIER                 PIC X.
  1762         16  AM-VG-GROUPING                PIC X(6).
  1763         16  AM-VG-STATE                   PIC XX.
  1764         16  AM-VG-ACCOUNT                 PIC X(10).
  1765         16  AM-VG-DATE.
  1766             20  AM-VG-EXPIRATION-DT       PIC XX.
  1767             20  FILLER                    PIC X(4).
  1768         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1769                                           PIC 9(11)      COMP-3.
  1770     12  AM-MAINT-INFORMATION.
  1771         16  AM-LAST-MAINT-DT              PIC XX.
  1772         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1773         16  AM-LAST-MAINT-USER            PIC X(4).
  1774         16  FILLER                        PIC XX.
  1775
  1776     12  AM-EFFECTIVE-DT                   PIC XX.
  1777     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1778
  1779     12  AM-PREV-DATES  COMP-3.
  1780         16  AM-PREV-EXP-DT                PIC 9(11).
  1781         16  AM-PREV-EFF-DT                PIC 9(11).
  1782
  1783     12  AM-REPORT-CODE-1                  PIC X(10).
  1784     12  AM-REPORT-CODE-2                  PIC X(10).
  1785
  1786     12  AM-CITY-CODE                      PIC X(4).
  1787     12  AM-COUNTY-PARISH                  PIC X(6).
  1788
  1789     12  AM-NAME                           PIC X(30).
  1790     12  AM-PERSON                         PIC X(30).
  1791     12  AM-ADDRS                          PIC X(30).
  1792     12  AM-CITY.
  1793         16  AM-ADDR-CITY                  PIC X(28).
  1794         16  AM-ADDR-STATE                 PIC XX.
  1795     12  AM-ZIP.
  1796         16  AM-ZIP-PRIME.
  1797             20  AM-ZIP-PRI-1ST            PIC X.
  1798                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1799             20  FILLER                    PIC X(4).
  1800         16  AM-ZIP-PLUS4                  PIC X(4).
  1801     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1802         16  AM-CAN-POSTAL-1               PIC XXX.
  1803         16  AM-CAN-POSTAL-2               PIC XXX.
  1804         16  FILLER                        PIC XXX.
  1805     12  AM-TEL-NO.
  1806         16  AM-AREA-CODE                  PIC 999.
  1807         16  AM-TEL-PRE                    PIC 999.
  1808         16  AM-TEL-NBR                    PIC 9(4).
  1809     12  AM-TEL-LOC                        PIC X.
  1810         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1811         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  41
* EL650.cbl
  1812
  1813     12  AM-COMM-STRUCTURE.
  1814         16  AM-DEFN-1.
  1815             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1816                 24  AM-AGT.
  1817                     28  AM-AGT-PREFIX     PIC X(4).
  1818                     28  AM-AGT-PRIME      PIC X(6).
  1819                 24  AM-COM-TYP            PIC X.
  1820                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1821                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1822                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1823                 24  AM-RECALC-LV-INDIC    PIC X.
  1824                 24  AM-RETRO-LV-INDIC     PIC X.
  1825                 24  AM-GL-CODES           PIC X.
  1826                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1827                 24  FILLER                PIC X(01).
  1828         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1829             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1830                 24  FILLER                PIC X(11).
  1831                 24  AM-L-COMA             PIC XXX.
  1832                 24  AM-J-COMA             PIC XXX.
  1833                 24  AM-A-COMA             PIC XXX.
  1834                 24  FILLER                PIC X(6).
  1835
  1836     12  AM-COMM-CHANGE-STATUS             PIC X.
  1837         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1838
  1839     12  AM-CSR-CODE                       PIC X(4).
  1840
  1841     12  AM-BILLING-STATUS                 PIC X.
  1842         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1843         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1844     12  AM-AUTO-REFUND-SW                 PIC X.
  1845         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1846         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1847     12  AM-GPCD                           PIC 99.
  1848     12  AM-IG                             PIC X.
  1849         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1850         88  AM-HAS-GROUP                     VALUE '2'.
  1851     12  AM-STATUS                         PIC X.
  1852         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1853         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1854         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1855         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1856         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1857     12  AM-REMIT-TO                       PIC 99.
  1858     12  AM-ID-NO                          PIC X(11).
  1859
  1860     12  AM-CAL-TABLE                      PIC XX.
  1861     12  AM-LF-DEVIATION                   PIC XXX.
  1862     12  AM-AH-DEVIATION                   PIC XXX.
  1863     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1864     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1865     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1866     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1867     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1868     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1869
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  42
* EL650.cbl
  1870     12  AM-USER-FIELDS.
  1871         16  AM-FLD-1                      PIC XX.
  1872         16  AM-FLD-2                      PIC XX.
  1873         16  AM-FLD-3                      PIC XX.
  1874         16  AM-FLD-4                      PIC XX.
  1875         16  AM-FLD-5                      PIC XX.
  1876
  1877     12  AM-1ST-PROD-DATE.
  1878         16  AM-1ST-PROD-YR                PIC XX.
  1879         16  AM-1ST-PROD-MO                PIC XX.
  1880         16  AM-1ST-PROD-DA                PIC XX.
  1881     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1882     12  AM-CERTS-PURGED-DATE.
  1883         16  AM-PUR-YR                     PIC XX.
  1884         16  AM-PUR-MO                     PIC XX.
  1885         16  AM-PUR-DA                     PIC XX.
  1886     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1887     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1888     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1889     12  AM-INACTIVE-DATE.
  1890         16  AM-INA-MO                     PIC 99.
  1891         16  AM-INA-DA                     PIC 99.
  1892         16  AM-INA-YR                     PIC 99.
  1893     12  AM-AR-HI-CERT-DATE                PIC XX.
  1894
  1895     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1896     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1897
  1898     12  AM-OB-PAYMENT-MODE                PIC X.
  1899         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1900         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1901         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1902         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1903
  1904     12  AM-AH-ONLY-INDICATOR              PIC X.
  1905         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1906         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1907
  1908     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1909
  1910     12  AM-OVER-SHORT.
  1911         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1912         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1913
  1914     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1915     12  AM-DCC-CLP-STATE                  PIC XX.
  1916
  1917     12  AM-RECALC-COMM                    PIC X.
  1918     12  AM-RECALC-REIN                    PIC X.
  1919
  1920     12  AM-REI-TABLE                      PIC XXX.
  1921     12  AM-REI-ET-LF                      PIC X.
  1922     12  AM-REI-ET-AH                      PIC X.
  1923     12  AM-REI-PE-LF                      PIC X.
  1924     12  AM-REI-PE-AH                      PIC X.
  1925     12  AM-REI-PRT-ST                     PIC X.
  1926     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1927     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  43
* EL650.cbl
  1928     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1929     12  AM-REI-GROUP-A                    PIC X(6).
  1930     12  AM-REI-MORT                       PIC X(4).
  1931     12  AM-REI-PRT-OW                     PIC X.
  1932     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1933     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1934     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1935     12  AM-REI-GROUP-B                    PIC X(6).
  1936
  1937     12  AM-TRUST-TYPE                     PIC X(2).
  1938
  1939     12  AM-EMPLOYER-STMT-USED             PIC X.
  1940     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1941
  1942     12  AM-STD-AH-TYPE                    PIC XX.
  1943     12  AM-EARN-METHODS.
  1944         16  AM-EARN-METHOD-R              PIC X.
  1945             88 AM-REF-RL-R78                 VALUE 'R'.
  1946             88 AM-REF-RL-PR                  VALUE 'P'.
  1947             88 AM-REF-RL-MEAN                VALUE 'M'.
  1948             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1949         16  AM-EARN-METHOD-L              PIC X.
  1950             88 AM-REF-LL-R78                 VALUE 'R'.
  1951             88 AM-REF-LL-PR                  VALUE 'P'.
  1952             88 AM-REF-LL-MEAN                VALUE 'M'.
  1953             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1954         16  AM-EARN-METHOD-A              PIC X.
  1955             88 AM-REF-AH-R78                 VALUE 'R'.
  1956             88 AM-REF-AH-PR                  VALUE 'P'.
  1957             88 AM-REF-AH-MEAN                VALUE 'M'.
  1958             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1959             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1960             88 AM-REF-AH-NET                 VALUE 'N'.
  1961
  1962     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1963     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1964     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1965
  1966     12  AM-RET-Y-N                        PIC X.
  1967     12  AM-RET-P-E                        PIC X.
  1968     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1969     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1970     12  AM-RET-GRP                        PIC X(6).
  1971     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1972         16  AM-POOL-PRIME                 PIC XXX.
  1973         16  AM-POOL-SUB                   PIC XXX.
  1974     12  AM-RETRO-EARNINGS.
  1975         16  AM-RET-EARN-R                 PIC X.
  1976         16  AM-RET-EARN-L                 PIC X.
  1977         16  AM-RET-EARN-A                 PIC X.
  1978     12  AM-RET-ST-TAX-USE                 PIC X.
  1979         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1980         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1981     12  AM-RETRO-BEG-EARNINGS.
  1982         16  AM-RET-BEG-EARN-R             PIC X.
  1983         16  AM-RET-BEG-EARN-L             PIC X.
  1984         16  AM-RET-BEG-EARN-A             PIC X.
  1985     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  44
* EL650.cbl
  1986     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1987
  1988     12  AM-USER-SELECT-OPTIONS.
  1989         16  AM-USER-SELECT-1              PIC X(10).
  1990         16  AM-USER-SELECT-2              PIC X(10).
  1991         16  AM-USER-SELECT-3              PIC X(10).
  1992         16  AM-USER-SELECT-4              PIC X(10).
  1993         16  AM-USER-SELECT-5              PIC X(10).
  1994
  1995     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1996
  1997     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1998
  1999     12  AM-RPT045A-SWITCH                 PIC X.
  2000         88  RPT045A-OFF                   VALUE 'N'.
  2001
  2002     12  AM-INSURANCE-LIMITS.
  2003         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2004         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2005
  2006     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2007         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2008
  2009     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2010         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2011         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2012
  2013     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2014
  2015     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2016     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2017     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2018     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2019     12  FILLER                            PIC X(5).
  2020     12  AM-REPORT-CODE-3                  PIC X(10).
  2021*    12  FILLER                            PIC X(22).
  2022
  2023     12  AM-RESERVE-DATE.
  2024         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2025         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2026         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2027
  2028     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2029     12  AM-NOTIFICATION-TYPES.
  2030         16  AM-NOTIF-OF-LETTERS           PIC X.
  2031         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2032         16  AM-NOTIF-OF-REPORTS           PIC X.
  2033         16  AM-NOTIF-OF-STATUS            PIC X.
  2034
  2035     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2036         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2037         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2038         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2039         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2040
  2041     12  AM-BENEFIT-CONTROLS.
  2042         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2043             20  AM-BENEFIT-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  45
* EL650.cbl
  2044             20  AM-BENEFIT-TYPE           PIC X.
  2045             20  AM-BENEFIT-REVISION       PIC XXX.
  2046             20  AM-BENEFIT-REM-TERM       PIC X.
  2047             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2048             20  FILLER                    PIC XX.
  2049         16  FILLER                        PIC X(80).
  2050
  2051     12  AM-TRANSFER-DATA.
  2052         16  AM-TRANSFERRED-FROM.
  2053             20  AM-TRNFROM-CARRIER        PIC X.
  2054             20  AM-TRNFROM-GROUPING.
  2055                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2056                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2057             20  AM-TRNFROM-STATE          PIC XX.
  2058             20  AM-TRNFROM-ACCOUNT.
  2059                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2060                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2061             20  AM-TRNFROM-DTE            PIC XX.
  2062         16  AM-TRANSFERRED-TO.
  2063             20  AM-TRNTO-CARRIER          PIC X.
  2064             20  AM-TRNTO-GROUPING.
  2065                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2066                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2067             20  AM-TRNTO-STATE            PIC XX.
  2068             20  AM-TRNTO-ACCOUNT.
  2069                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2070                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2071             20  AM-TRNTO-DTE              PIC XX.
  2072         16  FILLER                        PIC X(10).
  2073
  2074     12  AM-SAVED-REMIT-TO                 PIC 99.
  2075
  2076     12  AM-COMM-STRUCTURE-SAVED.
  2077         16  AM-DEFN-1-SAVED.
  2078             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2079                 24  AM-AGT-SV             PIC X(10).
  2080                 24  AM-COM-TYP-SV         PIC X.
  2081                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2082                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2083                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2084                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2085                 24  FILLER                PIC X.
  2086                 24  AM-GL-CODES-SV        PIC X.
  2087                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2088                 24  FILLER                PIC X.
  2089         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2090             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2091                 24  FILLER                PIC X(11).
  2092                 24  AM-L-COMA-SV          PIC XXX.
  2093                 24  AM-J-COMA-SV          PIC XXX.
  2094                 24  AM-A-COMA-SV          PIC XXX.
  2095                 24  FILLER                PIC X(6).
  2096
  2097     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2098         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2099            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2100            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2101            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  46
* EL650.cbl
  2102
  2103     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2104     12  FILLER                            PIC X(120).
  2105
  2106     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2107         16  AM-CONTROL-NAME               PIC X(30).
  2108         16  AM-EXECUTIVE-ONE.
  2109             20  AM-EXEC1-NAME             PIC X(15).
  2110             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2111                                                          COMP-3.
  2112             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2113                                                          COMP-3.
  2114         16  AM-EXECUTIVE-TWO.
  2115             20  AM-EXEC2-NAME             PIC X(15).
  2116             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2117                                                          COMP-3.
  2118             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2119                                                          COMP-3.
  2120
  2121     12  AM-RETRO-ADDITIONAL-DATA.
  2122         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2123         16  AM-RETRO-PREM-P-E             PIC X.
  2124         16  AM-RETRO-CLMS-P-I             PIC X.
  2125         16  AM-RETRO-RET-BRACKET-LF.
  2126             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2127                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2128                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2129             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2130                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2131                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2132             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2133                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2134                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2135         16  AM-RETRO-RET-BRACKET-AH.
  2136             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2137                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2138                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2139                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2140             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2141                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2142                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2143             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2144                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2145                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2146
  2147     12  AM-COMMENTS.
  2148         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2149
  2150     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2151         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2152         16  AM-FLI-BILLING-CODE           PIC X.
  2153         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2154         16  AM-FLI-UNITED-IDENT           PIC X.
  2155         16  AM-FLI-INTEREST-LOST-DATA.
  2156             20  AM-FLI-BANK-NO            PIC X(5).
  2157             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2158             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2159             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  47
* EL650.cbl
  2160         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2161             20  AM-FLI-AGT                PIC X(9).
  2162             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2163             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2164         16  FILLER                        PIC X(102).
  2165
  2166     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2167         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2168             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2169             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2170             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2171             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2172             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2173         16  FILLER                          PIC X(10).
  2174******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  48
* EL650.cbl
  2176*    COPY ERCCOMP.
  2177******************************************************************
  2178*                                                                *
  2179*                                                                *
  2180*                            ERCCOMP                             *
  2181*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2182*                            VMOD=2.019                          *
  2183*                                                                *
  2184*   ONLINE CREDIT SYSTEM                                         *
  2185*                                                                *
  2186*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2187*                                                                *
  2188*   FILE TYPE = VSAM,KSDS                                        *
  2189*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2190*                                                                *
  2191*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2192*       ALTERNATE PATH = NONE                                    *
  2193*                                                                *
  2194*   LOG = NO                                                     *
  2195*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2196*                                                                *
  2197******************************************************************
  2198*                   C H A N G E   L O G
  2199*
  2200* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2201*-----------------------------------------------------------------
  2202*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2203* EFFECTIVE    NUMBER
  2204*-----------------------------------------------------------------
  2205* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2206* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2207* 092205    2005050300006  PEMA  ADD LEASE FEE
  2208* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2209* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2210* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2211* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2212* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2213******************************************************************
  2214
  2215 01  COMPENSATION-MASTER.
  2216     12  CO-RECORD-ID                          PIC XX.
  2217         88  VALID-CO-ID                          VALUE 'CO'.
  2218
  2219     12  CO-CONTROL-PRIMARY.
  2220         16  CO-COMPANY-CD                     PIC X.
  2221         16  CO-CONTROL.
  2222             20  CO-CTL-1.
  2223                 24  CO-CARR-GROUP.
  2224                     28  CO-CARRIER            PIC X.
  2225                     28  CO-GROUPING.
  2226                         32  CO-GROUP-PREFIX   PIC XXX.
  2227                         32  CO-GROUP-PRIME    PIC XXX.
  2228                 24  CO-RESP-NO.
  2229                     28  CO-RESP-PREFIX        PIC X(4).
  2230                     28  CO-RESP-PRIME         PIC X(6).
  2231             20  CO-CTL-2.
  2232                 24  CO-ACCOUNT.
  2233                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  49
* EL650.cbl
  2234                     28  CO-ACCT-PRIME         PIC X(6).
  2235         16  CO-TYPE                           PIC X.
  2236             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2237             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2238             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2239
  2240     12  CO-MAINT-INFORMATION.
  2241         16  CO-LAST-MAINT-DT                  PIC XX.
  2242         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2243         16  CO-LAST-MAINT-USER                PIC X(4).
  2244     12  FILLER                                PIC XX.
  2245     12  CO-STMT-TYPE                          PIC XXX.
  2246     12  CO-COMP-TYPE                          PIC X.
  2247         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2248     12  CO-STMT-OWNER                         PIC X(4).
  2249     12  CO-BALANCE-CONTROL                    PIC X.
  2250         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2251         88  CO-NO-BALANCE                        VALUE 'N'.
  2252
  2253     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2254         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2255         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2256         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2257
  2258     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2259         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2260         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2261
  2262     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2263     12  CO-GA-DIRECT-DEP                      PIC X.
  2264     12  CO-FUTURE-SPACE                       PIC X.
  2265         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2266
  2267     12  CO-ACCT-NAME                          PIC X(30).
  2268     12  CO-MAIL-NAME                          PIC X(30).
  2269     12  CO-ADDR-1                             PIC X(30).
  2270     12  CO-ADDR-2                             PIC X(30).
  2271     12  CO-ADDR-3.
  2272         16  CO-ADDR-CITY                      PIC X(27).
  2273         16  CO-ADDR-STATE                     PIC XX.
  2274     12  CO-CSO-1099                           PIC X.
  2275     12  CO-ZIP.
  2276         16  CO-ZIP-PRIME.
  2277             20  CO-ZIP-PRI-1ST                PIC X.
  2278                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2279             20  FILLER                        PIC X(4).
  2280         16  CO-ZIP-PLUS4                      PIC X(4).
  2281     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2282         16  CO-CAN-POSTAL-1                   PIC XXX.
  2283         16  CO-CAN-POSTAL-2                   PIC XXX.
  2284         16  FILLER                            PIC XXX.
  2285     12  CO-SOC-SEC                            PIC X(13).
  2286     12  CO-TELEPHONE.
  2287         16  CO-AREA-CODE                      PIC XXX.
  2288         16  CO-PREFIX                         PIC XXX.
  2289         16  CO-PHONE                          PIC X(4).
  2290
  2291     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  50
* EL650.cbl
  2292
  2293     12  CO-AR-BAL-LEVEL                       PIC X.
  2294         88  CO-AR-REF-LVL                        VALUE '1'.
  2295         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2296         88  CO-AR-BILL-LVL                       VALUE '2'.
  2297         88  CO-AR-AGT-LVL                        VALUE '3'.
  2298         88  CO-AR-FR-LVL                         VALUE '4'.
  2299
  2300     12  CO-AR-NORMAL-PRINT                    PIC X.
  2301         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2302         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2303
  2304     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2305
  2306     12  CO-AR-REPORTING                       PIC X.
  2307         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2308         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2309
  2310     12  CO-AR-PULL-CHECK                      PIC X.
  2311         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2312         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2313
  2314     12  CO-AR-BALANCE-PRINT                   PIC X.
  2315         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2316
  2317     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2318         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2319         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2320         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2321
  2322     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2323
  2324     12  CO-USER-CODE                          PIC X.
  2325     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2326
  2327******************************************************************
  2328*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2329*    THE LAST MONTH END RUN.
  2330******************************************************************
  2331
  2332     12  CO-LAST-ACTIVITY-DATE.
  2333         16  CO-ACT-YEAR                       PIC 99.
  2334         16  CO-ACT-MONTH                      PIC 99.
  2335         16  CO-ACT-DAY                        PIC 99.
  2336
  2337     12  CO-LAST-STMT-DT.
  2338         16  CO-LAST-STMT-YEAR                 PIC 99.
  2339         16  CO-LAST-STMT-MONTH                PIC 99.
  2340         16  CO-LAST-STMT-DAY                  PIC 99.
  2341
  2342     12  CO-MO-END-TOTALS.
  2343         16  CO-MONTHLY-TOTALS.
  2344             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2345             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2346             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2347             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2348             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  2349
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  51
* EL650.cbl
  2350         16  CO-AGING-TOTALS.
  2351             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2352             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2353             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2354             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2355
  2356         16  CO-YTD-TOTALS.
  2357             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2358             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2359
  2360         16  CO-OVER-UNDER-TOTALS.
  2361             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2362             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2363
  2364     12  CO-MISCELLANEOUS-TOTALS.
  2365         16  CO-FICA-TOTALS.
  2366             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2367             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2368
  2369         16  CO-CLAIM-TOTALS.
  2370             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2371             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2372
  2373******************************************************************
  2374*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2375*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2376******************************************************************
  2377
  2378     12  CO-CURRENT-TOTALS.
  2379         16  CO-CURRENT-LAST-STMT-DT.
  2380             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2381             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2382             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2383
  2384         16  CO-CURRENT-MONTHLY-TOTALS.
  2385             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2386             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2387             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2388             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2389             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2390
  2391         16  CO-CURRENT-AGING-TOTALS.
  2392             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2393             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2394             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2395             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2396
  2397         16  CO-CURRENT-YTD-TOTALS.
  2398             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2399             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2400
  2401     12  CO-PAID-COMM-TOTALS.
  2402         16  CO-YTD-PAID-COMMS.
  2403             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2404             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2405
  2406     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  2407         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  52
* EL650.cbl
  2408         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2409
  2410     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2411         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2412         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2413         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2414         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2415         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2416         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2417         88  CO-FINAL-LETTER                  VALUE 'F'.
  2418         88  CO-RECONCILING                   VALUE 'R'.
  2419         88  CO-PHONE-CALL                    VALUE 'P'.
  2420         88  CO-LEGAL                         VALUE 'L'.
  2421         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2422         88  CO-WRITE-OFF                     VALUE 'W'.
  2423         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2424
  2425     12  CO-CSR-CODE                       PIC X(4).
  2426
  2427     12  CO-GA-STATUS-INFO.
  2428         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2429         16  CO-GA-TERMINATION-DT          PIC XX.
  2430         16  CO-GA-STATUS-CODE             PIC X.
  2431             88  CO-GA-ACTIVE                 VALUE 'A'.
  2432             88  CO-GA-INACTIVE               VALUE 'I'.
  2433             88  CO-GA-PENDING                VALUE 'P'.
  2434         16  CO-GA-COMMENTS.
  2435             20  CO-GA-COMMENT-1           PIC X(40).
  2436             20  CO-GA-COMMENT-2           PIC X(40).
  2437             20  CO-GA-COMMENT-3           PIC X(40).
  2438             20  CO-GA-COMMENT-4           PIC X(40).
  2439
  2440     12  CO-RPTCD2                         PIC X(10).
  2441
  2442     12  CO-TYPE-AGENT                     PIC X(01).
  2443         88  CO-CORPORATION                   VALUE 'C'.
  2444         88  CO-PARTNERSHIP                   VALUE 'P'.
  2445         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2446         88  CO-TRUST                         VALUE 'T'.
  2447         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2448
  2449     12  CO-FAXNO.
  2450         16  CO-FAX-AREA-CODE                  PIC XXX.
  2451         16  CO-FAX-PREFIX                     PIC XXX.
  2452         16  CO-FAX-PHONE                      PIC X(4).
  2453
  2454     12  CO-BANK-INFORMATION.
  2455         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2456         16  CO-BANK-TRANSIT-NON REDEFINES
  2457             CO-BANK-TRANSIT-NO                PIC 9(8).
  2458
  2459         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2460     12  CO-MISC-DEDUCT-INFO REDEFINES
  2461                  CO-BANK-INFORMATION.
  2462         16  CO-MD-GL-ACCT                     PIC X(10).
  2463         16  CO-MD-DIV                         PIC XX.
  2464         16  CO-MD-CENTER                      PIC X(4).
  2465         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  53
* EL650.cbl
  2466         16  CO-CREATE-AP-CHECK                PIC X.
  2467         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2468         16  FILLER                            PIC XXX.
  2469     12  CO-ACH-STATUS                         PIC X.
  2470         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2471         88  CO-ACH-PENDING                        VALUE 'P'.
  2472
  2473     12  CO-BILL-SW                            PIC X.
  2474     12  CO-CONTROL-NAME                       PIC X(30).
  2475     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2476     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2477     12  CO-CLP-STATE                          PIC XX.
  2478     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2479     12  CO-SPP-REFUND-EDIT                    PIC X.
  2480
  2481******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  54
* EL650.cbl
  2483*    COPY ERCNAME.
  2484******************************************************************
  2485*                                                                *
  2486*                                                                *
  2487*                            ERCNAME                             *
  2488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2489*                            VMOD=2.003                          *
  2490*                                                                *
  2491*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  2492*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  2493*                                                                *
  2494*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  2495*                                                                *
  2496*   FILE TYPE = VSAM,KSDS                                        *
  2497*   RECORD SIZE = 160   RECFORM = FIX                            *
  2498*                                                                *
  2499*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  2500*                                                                *
  2501*   LOG = NO                                                     *
  2502*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2503*                                                                *
  2504*                                                                *
  2505******************************************************************
  2506
  2507 01  NAME-LOOKUP-MASTER.
  2508     12  NL-RECORD-ID                PIC  X(02).
  2509         88  VALID-NL-ID                         VALUE 'NL'.
  2510
  2511     12  NL-RECORD-KEY.
  2512         16  NL-CONTROL-PRIMARY.
  2513             20  NL-COMPANY-CD       PIC  X(01).
  2514             20  NL-NAME             PIC  X(30).
  2515             20  NL-RECORD-TYPE      PIC  X(01).
  2516                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  2517                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  2518                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  2519
  2520         16  NL-ACCOUNT-MASTER.
  2521             20  NL-AM-COMPANY-CD    PIC  X(01).
  2522             20  NL-AM-CARRIER       PIC  X(01).
  2523             20  NL-AM-GROUPING      PIC  X(06).
  2524             20  NL-AM-STATE         PIC  X(02).
  2525             20  NL-AM-ACCOUNT       PIC  X(10).
  2526             20  FILLER              PIC  X(09).
  2527
  2528         16  NL-COMPENSATION-MASTER
  2529                                 REDEFINES  NL-ACCOUNT-MASTER.
  2530             20  NL-CO-COMPANY-CD    PIC  X(01).
  2531             20  NL-CO-CARRIER       PIC  X(01).
  2532             20  NL-CO-GROUPING      PIC  X(06).
  2533             20  NL-CO-RESP-NO       PIC  X(10).
  2534             20  NL-CO-ACCOUNT       PIC  X(10).
  2535             20  NL-CO-TYPE          PIC  X(01).
  2536
  2537         16  NL-REINSURANCE-RECORD
  2538                                 REDEFINES  NL-ACCOUNT-MASTER.
  2539             20  NL-RE-COMPANY-CD    PIC  X(01).
  2540             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  55
* EL650.cbl
  2541             20  NL-RE-COMPANY.
  2542                 24  NL-RE-COMP      PIC  X(03).
  2543                 24  NL-RE-CO-SUB    PIC  X(03).
  2544             20  NL-RE-TABLE         PIC  X(03).
  2545             20  FILLER              PIC  X(18).
  2546
  2547     12  NL-MAINT-INFORMATION.
  2548         16  NL-LAST-MAINT-DT        PIC  X(02).
  2549         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  2550         16  NL-LAST-MAINT-USER      PIC  X(04).
  2551         16  FILLER                  PIC  X(10).
  2552
  2553     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  2554         16  NL-RE-LEVEL             PIC  9(02).
  2555
  2556     12  NL-CITY                     PIC  X(15).
  2557     12  NL-ST                       PIC  XX.
  2558
  2559******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  56
* EL650.cbl
  2561*    COPY ERCPLAN.
  2562******************************************************************
  2563*                                                                *
  2564*                                                                *
  2565*                            ERCPLAN                             *
  2566*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2567*                            VMOD=2.003                          *
  2568*                                                                *
  2569*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2570*                                                                *
  2571*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2572*   PLAN MASTER                                                  *
  2573*                                                                *
  2574*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2575*                                                                *
  2576*   FILE TYPE = VSAM,KSDS                                        *
  2577*   RECORD SIZE = 420   RECFORM = FIX                            *
  2578*                                                                *
  2579*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2580*       ALTERNATE PATH1 = N/A                                    *
  2581*                                                                *
  2582*   LOG = NO                                                     *
  2583*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2584*                                                                *
  2585*                                                                *
  2586******************************************************************
  2587
  2588 01  PLAN-MASTER.
  2589     12  PL-RECORD-ID                      PIC XX.
  2590         88  VALID-PL-ID                      VALUE 'PL'.
  2591
  2592     12  PL-CONTROL-PRIMARY.
  2593         16  PL-COMPANY-CD                 PIC X.
  2594         16  PL-MSTR-CNTRL.
  2595             20  PL-CONTROL-A.
  2596                 24  PL-CARRIER            PIC X.
  2597                 24  PL-GROUPING           PIC X(6).
  2598                 24  PL-STATE              PIC XX.
  2599                 24  PL-ACCOUNT            PIC X(10).
  2600             20  PL-BENEFIT-TYPE           PIC X.
  2601             20  PL-BENEFIT-CODE           PIC XX.
  2602             20  PL-REVISION-NO            PIC X(3).
  2603
  2604     12  PL-CONTROL-BY-VAR-GRP.
  2605         16  PL-COMPANY-CD-A1              PIC X.
  2606         16  PL-VG-CARRIER                 PIC X.
  2607         16  PL-VG-GROUPING                PIC X(6).
  2608         16  PL-VG-STATE                   PIC XX.
  2609         16  PL-VG-ACCOUNT                 PIC X(10).
  2610         16  PL-BENEFIT-TYPE-A1            PIC X.
  2611         16  PL-BENEFIT-CODE-A1            PIC XX.
  2612         16  PL-REVISION-NO-A1             PIC 999.
  2613
  2614     12  PL-MAINT-INFORMATION.
  2615         16  PL-LAST-MAINT-DT              PIC XX.
  2616         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2617         16  PL-LAST-MAINT-USER            PIC X(4).
  2618         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  57
* EL650.cbl
  2619
  2620     12  PL-LIABILITY-LIMITS.
  2621         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2622         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2623             20  PL-LM-AGE                 PIC S99        COMP-3.
  2624             20  PL-LM-DUR                 PIC S999       COMP-3.
  2625             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2626             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2627
  2628     12  FILLER                            PIC X(30).
  2629
  2630     12  PL-GL-ACCOUNT-NOS.
  2631         16  PL-PREMIUM-GL                 PIC X(8).
  2632         16  PL-COMM-GL                    PIC X(8).
  2633         16  PL-CLAIM-GL                   PIC X(8).
  2634     12  FILLER                            PIC X(24).
  2635     12  PL-TOLERANCES.
  2636         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2637         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2638         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2639         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2640         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2641         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2642     12  PL-OVER-SHORT.
  2643         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2644         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2645     12  FILLER                            PIC X(24).
  2646     12  PLAN-MISC.
  2647         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2648         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2649         16  PL-IG                         PIC X.
  2650         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2651         16  PL-POLICY-FORM                PIC X(12).
  2652         16  PL-EDIT-FOR-FORM              PIC X(01).
  2653         16  PL-DEV-CODE                   PIC XXX.
  2654         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2655         16  PL-CALC-METHOD                PIC X.
  2656         16  PL-BENEFIT-GROUP              PIC X(05).
  2657         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2658
  2659         16  FILLER                        PIC X(99).
  2660******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  58
* EL650.cbl
  2662*    COPY ELCCNTL.
  2663******************************************************************
  2664*                                                                *
  2665*                                                                *
  2666*                            ELCCNTL.                            *
  2667*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2668*                            VMOD=2.059                          *
  2669*                                                                *
  2670*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2671*                                                                *
  2672*   FILE TYPE = VSAM,KSDS                                        *
  2673*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2674*                                                                *
  2675*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2676*       ALTERNATE INDEX = NONE                                   *
  2677*                                                                *
  2678*   LOG = YES                                                    *
  2679*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2680******************************************************************
  2681*                   C H A N G E   L O G
  2682*
  2683* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2684*-----------------------------------------------------------------
  2685*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2686* EFFECTIVE    NUMBER
  2687*-----------------------------------------------------------------
  2688* 082503                   PEMA  ADD BENEFIT GROUP
  2689* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2690* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2691* 092705    2005050300006  PEMA  ADD SPP LEASES
  2692* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2693* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2694* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2695* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2696******************************************************************
  2697*
  2698 01  CONTROL-FILE.
  2699     12  CF-RECORD-ID                       PIC XX.
  2700         88  VALID-CF-ID                        VALUE 'CF'.
  2701
  2702     12  CF-CONTROL-PRIMARY.
  2703         16  CF-COMPANY-ID                  PIC XXX.
  2704         16  CF-RECORD-TYPE                 PIC X.
  2705             88  CF-COMPANY-MASTER              VALUE '1'.
  2706             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2707             88  CF-STATE-MASTER                VALUE '3'.
  2708             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2709             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2710             88  CF-CARRIER-MASTER              VALUE '6'.
  2711             88  CF-MORTALITY-MASTER            VALUE '7'.
  2712             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2713             88  CF-TERMINAL-MASTER             VALUE '9'.
  2714             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2715             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2716             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2717             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2718             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2719             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  59
* EL650.cbl
  2720             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2721             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2722             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2723         16  CF-ACCESS-CD-GENL              PIC X(4).
  2724         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2725             20  CF-PROCESSOR               PIC X(4).
  2726         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2727             20  CF-STATE-CODE              PIC XX.
  2728             20  FILLER                     PIC XX.
  2729         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2730             20  FILLER                     PIC XX.
  2731             20  CF-HI-BEN-IN-REC           PIC XX.
  2732         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2733             20  FILLER                     PIC XXX.
  2734             20  CF-CARRIER-CNTL            PIC X.
  2735         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2736             20  FILLER                     PIC XX.
  2737             20  CF-HI-TYPE-IN-REC          PIC 99.
  2738         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2739             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2740                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2741             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2742             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2743         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2744             20  FILLER                     PIC X.
  2745             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2746         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2747             20  FILLER                     PIC XX.
  2748             20  CF-MORTGAGE-PLAN           PIC XX.
  2749         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2750
  2751     12  CF-LAST-MAINT-DT                   PIC XX.
  2752     12  CF-LAST-MAINT-BY                   PIC X(4).
  2753     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2754
  2755     12  CF-RECORD-BODY                     PIC X(728).
  2756
  2757
  2758****************************************************************
  2759*             COMPANY MASTER RECORD                            *
  2760****************************************************************
  2761
  2762     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2763         16  CF-COMPANY-ADDRESS.
  2764             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2765             20  CF-CL-IN-CARE-OF           PIC X(30).
  2766             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2767             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2768             20  CF-CL-CITY-STATE           PIC X(30).
  2769             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2770             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2771         16  CF-COMPANY-CD                  PIC X.
  2772         16  CF-COMPANY-PASSWORD            PIC X(8).
  2773         16  CF-SECURITY-OPTION             PIC X.
  2774             88  ALL-SECURITY                   VALUE '1'.
  2775             88  COMPANY-VERIFY                 VALUE '2'.
  2776             88  PROCESSOR-VERIFY               VALUE '3'.
  2777             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  60
* EL650.cbl
  2778             88  ALL-BUT-TERM                   VALUE '5'.
  2779         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2780             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2781         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2782             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2783         16  CF-INFORCE-LOCATION            PIC X.
  2784             88  CERTS-ARE-ONLINE               VALUE '1'.
  2785             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2786             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2787         16  CF-LOWER-CASE-LETTERS          PIC X.
  2788         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2789             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2790             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2791             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2792             88  CF-ACCNT-CNTL                  VALUE '3'.
  2793             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2794
  2795         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2796         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2797
  2798         16  CF-LGX-CREDIT-USER             PIC X.
  2799             88  CO-IS-NOT-USER                 VALUE 'N'.
  2800             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2801
  2802         16 CF-CREDIT-CALC-CODES.
  2803             20  CF-CR-REM-TERM-CALC PIC X.
  2804               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2805               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2806               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2807               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2808               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2809               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2810               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2811             20  CF-CR-R78-METHOD           PIC X.
  2812               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2813               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2814
  2815         16  CF-CLAIM-CONTROL-COUNTS.
  2816             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2817                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2818
  2819             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2820                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2821
  2822             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2823                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2824
  2825             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2826                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2827
  2828         16  CF-CURRENT-MONTH-END           PIC XX.
  2829
  2830         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2831             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2832             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2833             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2834             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2835                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  61
* EL650.cbl
  2836                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2837             20  CF-CO-PREM-REJECT-SW       PIC X.
  2838                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2839                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2840             20  CF-CO-REF-REJECT-SW        PIC X.
  2841                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2842                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2843
  2844         16  CF-CO-REPORTING-DT             PIC XX.
  2845         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2846         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2847           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2848           88  CF-CO-MONTH-END                  VALUE '1'.
  2849
  2850         16  CF-LGX-CLAIM-USER              PIC X.
  2851             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2852             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2853
  2854         16  CF-CREDIT-EDIT-CONTROLS.
  2855             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2856             20  CF-MIN-AGE                 PIC 99.
  2857             20  CF-DEFAULT-AGE             PIC 99.
  2858             20  CF-MIN-TERM                PIC S999      COMP-3.
  2859             20  CF-MAX-TERM                PIC S999      COMP-3.
  2860             20  CF-DEFAULT-SEX             PIC X.
  2861             20  CF-JOINT-AGE-INPUT         PIC X.
  2862                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2863             20  CF-BIRTH-DATE-INPUT        PIC X.
  2864                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2865             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2866                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2867                 88  CF-ZERO-CARRIER            VALUE '1'.
  2868                 88  CF-ZERO-GROUPING           VALUE '2'.
  2869                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2870             20  CF-EDIT-SW                 PIC X.
  2871                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2872             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2873             20  CF-CR-PR-METHOD            PIC X.
  2874               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2875               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2876             20  FILLER                     PIC X.
  2877
  2878         16  CF-CREDIT-MISC-CONTROLS.
  2879             20  CF-REIN-TABLE-SW           PIC X.
  2880                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2881             20  CF-COMP-TABLE-SW           PIC X.
  2882                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2883             20  CF-EXPERIENCE-RETENTION-AGE
  2884                                            PIC S9        COMP-3.
  2885             20  CF-CONVERSION-DT           PIC XX.
  2886             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2887             20  CF-RUN-FREQUENCY-SW        PIC X.
  2888                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2889                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2890
  2891             20  CF-CR-CHECK-NO-CONTROL.
  2892                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2893                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  62
* EL650.cbl
  2894                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2895                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2896                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2897                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2898
  2899                 24  CF-CR-CHECK-COUNT       REDEFINES
  2900                     CF-CR-CHECK-COUNTER      PIC X(4).
  2901
  2902                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2903                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2904
  2905                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2906                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2907                 24  CF-MAIL-PROCESSING       PIC X.
  2908                     88  MAIL-PROCESSING          VALUE 'Y'.
  2909
  2910         16  CF-MISC-SYSTEM-CONTROL.
  2911             20  CF-SYSTEM-C                 PIC X.
  2912                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2913             20  CF-SYSTEM-D                 PIC X.
  2914                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2915             20  CF-SOC-SEC-NO-SW            PIC X.
  2916                 88  SOC-SEC-NO-USED             VALUE '1'.
  2917             20  CF-MEMBER-NO-SW             PIC X.
  2918                 88  MEMBER-NO-USED              VALUE '1'.
  2919             20  CF-TAX-ID-NUMBER            PIC X(11).
  2920             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2921             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2922                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2923                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2924                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2925                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2926             20  CF-SYSTEM-E                 PIC X.
  2927                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2928
  2929         16  CF-LGX-LIFE-USER               PIC X.
  2930             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2931             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2932
  2933         16  CF-CR-MONTH-END-DT             PIC XX.
  2934
  2935         16  CF-FILE-MAINT-DATES.
  2936             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2937                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2938             20  CF-LAST-BATCH       REDEFINES
  2939                 CF-LAST-BATCH-NO               PIC X(4).
  2940             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2941             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2942             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2943             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2944             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2945             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2946             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2947             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2948             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2949             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2950
  2951         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  63
* EL650.cbl
  2952         16  FILLER                         PIC X.
  2953
  2954         16  CF-ALT-MORT-CODE               PIC X(4).
  2955         16  CF-MEMBER-CAPTION              PIC X(10).
  2956
  2957         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2958             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2959             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2960             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2961             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2962             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2963
  2964         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2965
  2966         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2967         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2968         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2969         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2970
  2971         16  CF-AH-OVERRIDE-L1              PIC X.
  2972         16  CF-AH-OVERRIDE-L2              PIC XX.
  2973         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2974         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2975
  2976         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2977         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2978
  2979         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2980         16  CF-AR-LAST-EL860-DT            PIC XX.
  2981         16  CF-MP-MONTH-END-DT             PIC XX.
  2982
  2983         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2984         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2985             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2986
  2987         16  CF-AR-MONTH-END-DT             PIC XX.
  2988
  2989         16  CF-CRDTCRD-USER                PIC X.
  2990             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2991             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2992
  2993         16  CF-CC-MONTH-END-DT             PIC XX.
  2994
  2995         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2996
  2997         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2998             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2999             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3000             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3001         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3002         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3003         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3004         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3005             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3006             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3007         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3008         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3009         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  64
* EL650.cbl
  3010             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3011         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3012
  3013         16  CF-CL-ZIP-CODE.
  3014             20  CF-CL-ZIP-PRIME.
  3015                 24  CF-CL-ZIP-1ST          PIC X.
  3016                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3017                 24  FILLER                 PIC X(4).
  3018             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3019         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3020             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3021             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3022             20  FILLER                     PIC XXX.
  3023
  3024         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3025         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3026         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3027         16  CF-CO-OPTION-START-DATE        PIC XX.
  3028         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3029           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3030                                                      '3' '4'.
  3031           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3032           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3033           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3034           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3035           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3036           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3037
  3038         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3039
  3040         16  CF-PAYMENT-APPROVAL-LEVELS.
  3041             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3042             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3043             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3044             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3045             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3046             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3047
  3048         16  CF-END-USER-REPORTING-USER     PIC X.
  3049             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3050             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3051
  3052         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3053             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3054             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3055
  3056         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3057
  3058         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3059         16  FILLER                         PIC X.
  3060
  3061         16  CF-CREDIT-ARCHIVE-CNTL.
  3062             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3063             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3064             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3065
  3066         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3067
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  65
* EL650.cbl
  3068         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3069             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3070             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3071
  3072         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3073             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3074             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3075
  3076         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3077
  3078         16  CF-CO-ACH-ID-CODE              PIC  X.
  3079             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3080             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3081             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3082         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3083         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3084         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3085         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3086         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3087         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3088         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3089         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3090         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3091                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3092         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3093                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3094
  3095         16  CF-CO-OVER-SHORT.
  3096             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3097             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3098
  3099*         16  FILLER                         PIC X(102).
  3100         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3101             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3102             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3103
  3104         16  CF-AH-APPROVAL-DAYS.
  3105             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3106             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3107             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3108             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3109
  3110         16  FILLER                         PIC X(82).
  3111****************************************************************
  3112*             PROCESSOR/USER RECORD                            *
  3113****************************************************************
  3114
  3115     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3116         16  CF-PROCESSOR-NAME              PIC X(30).
  3117         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3118         16  CF-PROCESSOR-TITLE             PIC X(26).
  3119         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3120                 88  MESSAGE-YES                VALUE 'Y'.
  3121                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3122
  3123*****************************************************
  3124****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3125****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  66
* EL650.cbl
  3126****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3127****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3128*****************************************************
  3129
  3130         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3131             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3132             20  CF-APPLICATION-FORCE       PIC X.
  3133             20  CF-INDIVIDUAL-APP.
  3134                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3135                     28  CF-BROWSE-APP      PIC X.
  3136                     28  CF-UPDATE-APP      PIC X.
  3137
  3138         16  CF-CURRENT-TERM-ON             PIC X(4).
  3139         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3140             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3141             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3142             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3143             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3144             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3145             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3146             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3147         16  CF-PROCESSOR-CARRIER           PIC X.
  3148             88  NO-CARRIER-SECURITY            VALUE ' '.
  3149         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3150             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3151         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3152             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3153         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3154             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3155
  3156         16  CF-PROC-SYS-ACCESS-SW.
  3157             20  CF-PROC-CREDIT-CLAIMS-SW.
  3158                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3159                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3160                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3161                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3162             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3163                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3164                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3165             20  CF-PROC-LIFE-GNRLDGR-SW.
  3166                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3167                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3168                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3169                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3170             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3171                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3172                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3173         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3174             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3175             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3176         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3177
  3178         16  CF-APPROVAL-LEVEL                  PIC X.
  3179             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3180             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3181             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3182             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3183
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  67
* EL650.cbl
  3184         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3185
  3186         16  CF-LANGUAGE-TYPE                   PIC X.
  3187             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3188             88  CF-LANG-IS-FR                      VALUE 'F'.
  3189         16  FILLER                             PIC  X(240).
  3190
  3191****************************************************************
  3192*             PROCESSOR/REMINDERS RECORD                       *
  3193****************************************************************
  3194
  3195     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3196         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3197             20  CF-START-REMIND-DT         PIC XX.
  3198             20  CF-END-REMIND-DT           PIC XX.
  3199             20  CF-REMINDER-TEXT           PIC X(50).
  3200         16  FILLER                         PIC X(296).
  3201
  3202
  3203****************************************************************
  3204*             STATE MASTER RECORD                              *
  3205****************************************************************
  3206
  3207     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3208         16  CF-STATE-ABBREVIATION          PIC XX.
  3209         16  CF-STATE-NAME                  PIC X(25).
  3210         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3211         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3212             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3213             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3214             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3215             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3216                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3217                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3218             20  CF-ST-PREM-REJECT-SW       PIC X.
  3219                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3220                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3221             20  CF-ST-REF-REJECT-SW        PIC X.
  3222                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3223                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3224         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3225         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3226         16  CF-ST-REFUND-RULES.
  3227             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3228             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3229             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3230         16  CF-ST-FST-PMT-EXTENSION.
  3231             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3232             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3233                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3234                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3235                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3236                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3237         16  CF-ST-STATE-CALL.
  3238             20  CF-ST-CALL-UNEARNED        PIC X.
  3239             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3240             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3241         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  68
* EL650.cbl
  3242             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3243             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3244         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3245         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3246         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3247         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3248         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3249         16  FILLER                         PIC X.
  3250         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3251             20  CF-ST-BENEFIT-CD           PIC XX.
  3252             20  CF-ST-BENEFIT-KIND         PIC X.
  3253                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3254                 88  CF-ST-AH-KIND              VALUE 'A'.
  3255             20  CF-ST-REM-TERM-CALC        PIC X.
  3256                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3257                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3258                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3259                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3260                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3261                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3262                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3263                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3264
  3265             20  CF-ST-REFUND-CALC          PIC X.
  3266                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3267                 88  ST-REFD-BY-R78             VALUE '1'.
  3268                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3269                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3270                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3271                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3272                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3273                 88  ST-REFD-UTAH               VALUE '7'.
  3274                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3275                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3276                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3277
  3278             20  CF-ST-EARNING-CALC         PIC X.
  3279                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3280                 88  ST-EARN-BY-R78             VALUE '1'.
  3281                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3282                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3283                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3284                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3285                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3286                 88  ST-EARN-MEAN               VALUE '8'.
  3287                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3288
  3289             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3290                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3291                 88  ST-OVRD-BY-R78             VALUE '1'.
  3292                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3293                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3294                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3295                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3296                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3297                 88  ST-OVRD-MEAN               VALUE '8'.
  3298                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3299             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  69
* EL650.cbl
  3300
  3301         16  CF-ST-COMMISSION-CAPS.
  3302             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3303             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3304             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3305             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3306         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3307                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3308
  3309         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3310
  3311         16  CF-ST-STATUTORY-INTEREST.
  3312             20  CF-ST-STAT-DATE-FROM       PIC X.
  3313                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3314                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3315             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3316             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3317             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3318             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3319             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3320
  3321         16  CF-ST-OVER-SHORT.
  3322             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3323             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3324
  3325         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3326
  3327         16  CF-ST-RT-CALC                  PIC X.
  3328
  3329         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3330         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3331         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3332         16  CF-ST-RF-LR-CALC               PIC X.
  3333         16  CF-ST-RF-LL-CALC               PIC X.
  3334         16  CF-ST-RF-LN-CALC               PIC X.
  3335         16  CF-ST-RF-AH-CALC               PIC X.
  3336         16  CF-ST-RF-CP-CALC               PIC X.
  3337*        16  FILLER                         PIC X(206).
  3338*CIDMOD         16  FILLER                         PIC X(192).
  3339         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3340             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3341         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3342         16  FILLER                         PIC X(187).
  3343
  3344****************************************************************
  3345*             BENEFIT MASTER RECORD                            *
  3346****************************************************************
  3347
  3348     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3349         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3350             20  CF-BENEFIT-CODE            PIC XX.
  3351             20  CF-BENEFIT-NUMERIC  REDEFINES
  3352                 CF-BENEFIT-CODE            PIC XX.
  3353             20  CF-BENEFIT-ALPHA           PIC XXX.
  3354             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3355             20  CF-BENEFIT-COMMENT         PIC X(10).
  3356
  3357             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  70
* EL650.cbl
  3358                 88  CF-REDUCING                VALUE 'R'.
  3359                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3360
  3361             20  CF-SPECIAL-CALC-CD         PIC X.
  3362                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3363                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3364                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3365                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3366                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3367                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3368                 88  CF-FARM-PLAN               VALUE 'F'.
  3369                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3370                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3371                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3372                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3373                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3374                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3375                 88  CF-PRUDENTIAL              VALUE 'P'.
  3376                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3377                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3378                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3379                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3380                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3381                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3382
  3383             20  CF-JOINT-INDICATOR         PIC X.
  3384                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3385
  3386*            20  FILLER                     PIC X(12).
  3387             20  FILLER                     PIC X(11).
  3388             20  CF-BENEFIT-CATEGORY        PIC X.
  3389             20  CF-LOAN-TYPE               PIC X(8).
  3390
  3391             20  CF-CO-REM-TERM-CALC        PIC X.
  3392                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3393                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3394                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3395                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3396                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3397
  3398             20  CF-CO-EARNINGS-CALC        PIC X.
  3399                 88  CO-EARN-BY-R78             VALUE '1'.
  3400                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3401                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3402                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3403                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3404                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3405                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3406                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3407
  3408             20  CF-CO-REFUND-CALC          PIC X.
  3409                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3410                 88  CO-REFD-BY-R78             VALUE '1'.
  3411                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3412                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3413                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3414                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3415                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  71
* EL650.cbl
  3416                 88  CO-REFD-MEAN               VALUE '8'.
  3417                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3418                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3419                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3420
  3421             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3422                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3423                 88  CO-OVRD-BY-R78             VALUE '1'.
  3424                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3425                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3426                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3427                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3428                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3429                 88  CO-OVRD-MEAN               VALUE '8'.
  3430                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3431
  3432             20  CF-CO-BEN-I-G-CD           PIC X.
  3433                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3434                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3435                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3436
  3437         16  FILLER                         PIC X(304).
  3438
  3439
  3440****************************************************************
  3441*             CARRIER MASTER RECORD                            *
  3442****************************************************************
  3443
  3444     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3445         16  CF-ADDRESS-DATA.
  3446             20  CF-MAIL-TO-NAME            PIC X(30).
  3447             20  CF-IN-CARE-OF              PIC X(30).
  3448             20  CF-ADDRESS-LINE-1          PIC X(30).
  3449             20  CF-ADDRESS-LINE-2          PIC X(30).
  3450             20  CF-CITY-STATE              PIC X(30).
  3451             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3452             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3453
  3454         16  CF-CLAIM-NO-CONTROL.
  3455             20  CF-CLAIM-NO-METHOD         PIC X.
  3456                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3457                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3458                 88  CLAIM-NO-SEQ               VALUE '3'.
  3459                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3460             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3461                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3462                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3463                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3464
  3465         16  CF-CHECK-NO-CONTROL.
  3466             20  CF-CHECK-NO-METHOD         PIC X.
  3467                 88  CHECK-NO-MANUAL            VALUE '1'.
  3468                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3469                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3470                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3471             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3472                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3473
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  72
* EL650.cbl
  3474         16  CF-DOMICILE-STATE              PIC XX.
  3475
  3476         16  CF-EXPENSE-CONTROLS.
  3477             20  CF-EXPENSE-METHOD          PIC X.
  3478                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3479                 88  DOLLARS-PER-PMT            VALUE '2'.
  3480                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3481                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3482             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3483             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3484
  3485         16  CF-CORRESPONDENCE-CONTROL.
  3486             20  CF-LETTER-RESEND-OPT       PIC X.
  3487                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3488                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3489             20  FILLER                     PIC X(4).
  3490
  3491         16  CF-RESERVE-CONTROLS.
  3492             20  CF-MANUAL-SW               PIC X.
  3493                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3494             20  CF-FUTURE-SW               PIC X.
  3495                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3496             20  CF-PTC-SW                  PIC X.
  3497                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3498             20  CF-IBNR-SW                 PIC X.
  3499                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3500             20  CF-PTC-LF-SW               PIC X.
  3501                 88  CF-LF-PTC-USED             VALUE '1'.
  3502             20  CF-CDT-ACCESS-METHOD       PIC X.
  3503                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3504                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3505                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3506             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3507
  3508         16  CF-CLAIM-CALC-METHOD           PIC X.
  3509             88  360-PLUS-MONTHS                VALUE '1'.
  3510             88  365-PLUS-MONTHS                VALUE '2'.
  3511             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3512             88  360-DAILY                      VALUE '4'.
  3513             88  365-DAILY                      VALUE '5'.
  3514
  3515         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3516         16  FILLER                         PIC X(11).
  3517
  3518         16  CF-LIMIT-AMOUNTS.
  3519             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3520             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3521             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3522             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3523             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3524             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3525             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3526             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3527             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3528             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3529
  3530         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3531         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  73
* EL650.cbl
  3532         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3533
  3534         16  CF-ZIP-CODE.
  3535             20  CF-ZIP-PRIME.
  3536                 24  CF-ZIP-1ST             PIC X.
  3537                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3538                 24  FILLER                 PIC X(4).
  3539             20  CF-ZIP-PLUS4               PIC X(4).
  3540         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3541             20  CF-CAN-POSTAL-1            PIC XXX.
  3542             20  CF-CAN-POSTAL-2            PIC XXX.
  3543             20  FILLER                     PIC XXX.
  3544
  3545         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3546         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3547         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3548
  3549         16  CF-RATING-SWITCH               PIC X.
  3550             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3551             88  CF-NO-RATING                   VALUE 'N'.
  3552
  3553         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3554
  3555         16  CF-CARRIER-OVER-SHORT.
  3556             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3557             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3558
  3559         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3560         16  CF-SECPAY-SWITCH               PIC X.
  3561             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3562             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3563         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3564         16  FILLER                         PIC X(448).
  3565*        16  FILLER                         PIC X(452).
  3566
  3567
  3568****************************************************************
  3569*             MORTALITY MASTER RECORD                          *
  3570****************************************************************
  3571
  3572     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3573         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3574                                INDEXED BY CF-MORT-NDX.
  3575             20  CF-MORT-TABLE              PIC X(5).
  3576             20  CF-MORT-TABLE-TYPE         PIC X.
  3577                 88  CF-MORT-JOINT              VALUE 'J'.
  3578                 88  CF-MORT-SINGLE             VALUE 'S'.
  3579                 88  CF-MORT-COMBINED           VALUE 'C'.
  3580                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3581                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3582             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3583             20  CF-MORT-AGE-METHOD         PIC XX.
  3584                 88  CF-AGE-LAST                VALUE 'AL'.
  3585                 88  CF-AGE-NEAR                VALUE 'AN'.
  3586             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3587             20  CF-MORT-ADJUSTMENT-DIRECTION
  3588                                            PIC X.
  3589                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  74
* EL650.cbl
  3590                 88  CF-PLUS                    VALUE '+'.
  3591             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3592             20  CF-MORT-JOINT-CODE         PIC X.
  3593                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3594             20  CF-MORT-PC-Q               PIC X.
  3595                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3596             20  CF-MORT-TABLE-CODE         PIC X(4).
  3597             20  CF-MORT-COMMENTS           PIC X(15).
  3598             20  FILLER                     PIC X(14).
  3599
  3600         16  FILLER                         PIC X(251).
  3601
  3602
  3603****************************************************************
  3604*             BUSSINESS TYPE MASTER RECORD                     *
  3605****************************************************************
  3606
  3607     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3608* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3609* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3610* AND RECORD 05 IS TYPES 81-99
  3611         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3612             20  CF-BUSINESS-TITLE          PIC  X(19).
  3613             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3614                                            PIC S9V9(4) COMP-3.
  3615             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3616             20  FILLER                     PIC  X.
  3617         16  FILLER                         PIC  X(248).
  3618
  3619
  3620****************************************************************
  3621*             TERMINAL MASTER RECORD                           *
  3622****************************************************************
  3623
  3624     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3625
  3626         16  CF-COMPANY-TERMINALS.
  3627             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3628                                  PIC X(4).
  3629         16  FILLER               PIC X(248).
  3630
  3631
  3632****************************************************************
  3633*             LIFE EDIT MASTER RECORD                          *
  3634****************************************************************
  3635
  3636     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3637         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3638             20  CF-LIFE-CODE-IN            PIC XX.
  3639             20  CF-LIFE-CODE-OUT           PIC XX.
  3640         16  FILLER                         PIC X(248).
  3641
  3642
  3643****************************************************************
  3644*             AH EDIT MASTER RECORD                            *
  3645****************************************************************
  3646
  3647     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  75
* EL650.cbl
  3648         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3649             20  CF-AH-CODE-IN              PIC XXX.
  3650             20  CF-AH-CODE-OUT             PIC XX.
  3651         16  FILLER                         PIC X(248).
  3652
  3653
  3654****************************************************************
  3655*             CREDIBILITY TABLES                               *
  3656****************************************************************
  3657
  3658     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3659         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3660                             INDEXED BY CF-CRDB-NDX.
  3661             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3662             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3663             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3664         16  FILLER                         PIC  X(332).
  3665
  3666
  3667****************************************************************
  3668*             REPORT CUSTOMIZATION RECORD                      *
  3669****************************************************************
  3670
  3671     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3672         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3673             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3674             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3675             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3676**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3677****       A T-TRANSFER.                                   ****
  3678             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3679
  3680         16  FILLER                         PIC XX.
  3681
  3682         16  CF-CARRIER-CNTL-OPT.
  3683             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3684                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3685                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3686             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3687                                            PIC X.
  3688         16  CF-GROUP-CNTL-OPT.
  3689             20  CF-GROUP-OPT-SEQ           PIC 9.
  3690                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3691                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3692             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3693                                            PIC X(6).
  3694         16  CF-STATE-CNTL-OPT.
  3695             20  CF-STATE-OPT-SEQ           PIC 9.
  3696                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3697                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3698             20  CF-STATE-SELECT OCCURS 3 TIMES
  3699                                            PIC XX.
  3700         16  CF-ACCOUNT-CNTL-OPT.
  3701             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3702                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3703                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3704             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3705                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  76
* EL650.cbl
  3706         16  CF-BUS-TYP-CNTL-OPT.
  3707             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3708                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3709                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3710             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3711                                            PIC XX.
  3712         16  CF-LF-TYP-CNTL-OPT.
  3713             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3714                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3715                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3716             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3717                                            PIC XX.
  3718         16  CF-AH-TYP-CNTL-OPT.
  3719             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3720                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3721                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3722             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3723                                            PIC XX.
  3724         16  CF-REPTCD1-CNTL-OPT.
  3725             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3726                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3727                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3728             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3729                                            PIC X(10).
  3730         16  CF-REPTCD2-CNTL-OPT.
  3731             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3732                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3733                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3734             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3735                                            PIC X(10).
  3736         16  CF-USER1-CNTL-OPT.
  3737             20  CF-USER1-OPT-SEQ           PIC 9.
  3738                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3739                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3740             20  CF-USER1-SELECT OCCURS 3 TIMES
  3741                                            PIC X(10).
  3742         16  CF-USER2-CNTL-OPT.
  3743             20  CF-USER2-OPT-SEQ           PIC 9.
  3744                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3745                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3746             20  CF-USER2-SELECT OCCURS 3 TIMES
  3747                                            PIC X(10).
  3748         16  CF-USER3-CNTL-OPT.
  3749             20  CF-USER3-OPT-SEQ           PIC 9.
  3750                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3751                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3752             20  CF-USER3-SELECT OCCURS 3 TIMES
  3753                                            PIC X(10).
  3754         16  CF-USER4-CNTL-OPT.
  3755             20  CF-USER4-OPT-SEQ           PIC 9.
  3756                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3757                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3758             20  CF-USER4-SELECT OCCURS 3 TIMES
  3759                                            PIC X(10).
  3760         16  CF-USER5-CNTL-OPT.
  3761             20  CF-USER5-OPT-SEQ           PIC 9.
  3762                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3763                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  77
* EL650.cbl
  3764             20  CF-USER5-SELECT OCCURS 3 TIMES
  3765                                            PIC X(10).
  3766         16  CF-REINS-CNTL-OPT.
  3767             20  CF-REINS-OPT-SEQ           PIC 9.
  3768                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3769                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3770             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3771                 24  CF-REINS-PRIME         PIC XXX.
  3772                 24  CF-REINS-SUB           PIC XXX.
  3773
  3774         16  CF-AGENT-CNTL-OPT.
  3775             20  CF-AGENT-OPT-SEQ           PIC 9.
  3776                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3777                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3778             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3779                                            PIC X(10).
  3780
  3781         16  FILLER                         PIC X(43).
  3782
  3783         16  CF-LOSS-RATIO-SELECT.
  3784             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3785             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3786         16  CF-ENTRY-DATE-SELECT.
  3787             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3788             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3789         16  CF-EFFECTIVE-DATE-SELECT.
  3790             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3791             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3792
  3793         16  CF-EXCEPTION-LIST-IND          PIC X.
  3794             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3795
  3796         16  FILLER                         PIC X(318).
  3797
  3798****************************************************************
  3799*                  EXCEPTION REPORTING RECORD                  *
  3800****************************************************************
  3801
  3802     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3803         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3804             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3805
  3806         16  CF-COMBINED-LIFE-AH-OPT.
  3807             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3808             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3809             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3810             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3811
  3812         16  CF-LIFE-OPT.
  3813             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3814             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3815             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3816             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3817             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3818             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3819             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3820             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3821             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  78
* EL650.cbl
  3822             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3823
  3824         16  CF-AH-OPT.
  3825             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3826             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3827             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3828             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3829             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3830             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3831             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3832             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3833             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3834             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3835
  3836         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3837             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3838             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3839             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3840
  3841         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3842
  3843         16  FILLER                         PIC X(673).
  3844
  3845
  3846****************************************************************
  3847*             MORTGAGE SYSTEM PLAN RECORD                      *
  3848****************************************************************
  3849
  3850     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3851         16  CF-PLAN-TYPE                   PIC X.
  3852             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3853             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3854             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3855         16  CF-PLAN-ABBREV                 PIC XXX.
  3856         16  CF-PLAN-DESCRIPT               PIC X(10).
  3857         16  CF-PLAN-NOTES                  PIC X(20).
  3858         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3859         16  CF-PLAN-UNDERWRITING.
  3860             20  CF-PLAN-TERM-DATA.
  3861                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3862                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3863             20  CF-PLAN-AGE-DATA.
  3864                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3865                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3866                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3867             20  CF-PLAN-BENEFIT-DATA.
  3868                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3869                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3870                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3871                                            PIC S9(7)V99  COMP-3.
  3872         16  CF-PLAN-POLICY-FORMS.
  3873             20  CF-POLICY-FORM             PIC X(12).
  3874             20  CF-MASTER-APPLICATION      PIC X(12).
  3875             20  CF-MASTER-POLICY           PIC X(12).
  3876         16  CF-PLAN-RATING.
  3877             20  CF-RATE-CODE               PIC X(5).
  3878             20  CF-SEX-RATING              PIC X.
  3879                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  79
* EL650.cbl
  3880                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3881             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3882             20  CF-SUB-STD-TYPE            PIC X.
  3883                 88  CF-PCT-OF-PREM            VALUE '1'.
  3884                 88  CF-PCT-OF-BENE            VALUE '2'.
  3885         16  CF-PLAN-PREM-TOLERANCES.
  3886             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3887             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3888         16  CF-PLAN-PYMT-TOLERANCES.
  3889             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3890             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3891         16  CF-PLAN-MISC-DATA.
  3892             20  FILLER                     PIC X.
  3893             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3894             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3895         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3896         16  CF-PLAN-IND-GRP                PIC X.
  3897             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3898                                                     '1'.
  3899             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3900                                                     '2'.
  3901         16  CF-MIB-SEARCH-SW               PIC X.
  3902             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3903             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3904             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3905             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3906         16  CF-ALPHA-SEARCH-SW             PIC X.
  3907             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3908             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3909             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3910             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3911             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3912             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3913             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3914             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3915             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3916             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3917                                                     'A' 'B' 'C'
  3918                                                     'X' 'Y' 'Z'.
  3919         16  CF-EFF-DT-RULE-SW              PIC X.
  3920             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3921             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3922             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3923             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3924             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3925         16  FILLER                         PIC X(4).
  3926         16  CF-HEALTH-QUESTIONS            PIC X.
  3927             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3928         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3929         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3930         16  CF-PLAN-SNGL-JNT               PIC X.
  3931             88  CF-COMBINED-PLAN              VALUE 'C'.
  3932             88  CF-JNT-PLAN                   VALUE 'J'.
  3933             88  CF-SNGL-PLAN                  VALUE 'S'.
  3934         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3935         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3936         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3937         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  80
* EL650.cbl
  3938         16  CF-RERATE-CNTL                 PIC  X.
  3939             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3940             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3941             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3942             88  CF-AUTO-RECALC                 VALUE '4'.
  3943         16  CF-BENEFIT-TYPE                PIC  X.
  3944             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3945             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3946         16  CF-POLICY-FEE                  PIC S999V99
  3947                                                    COMP-3.
  3948         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3949         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3950         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3951         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3952         16  FILLER                         PIC  X(32).
  3953         16  CF-TERMINATION-FORM            PIC  X(04).
  3954         16  FILLER                         PIC  X(08).
  3955         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3956                                                       COMP-3.
  3957         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3958         16  CF-ISSUE-LETTER                PIC  X(4).
  3959         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3960         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3961             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3962             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3963         16  CF-MP-REFUND-CALC              PIC X.
  3964             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3965             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3966             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3967             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3968             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3969             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3970             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3971             88  CF-MP-REFD-MEAN                VALUE '8'.
  3972         16  CF-ALT-RATE-CODE               PIC  X(5).
  3973
  3974
  3975         16  FILLER                         PIC X(498).
  3976****************************************************************
  3977*             MORTGAGE COMPANY MASTER RECORD                   *
  3978****************************************************************
  3979
  3980     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3981         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3982         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3983             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3984             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3985             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3986             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3987             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3988
  3989         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3990         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3991         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3992         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3993         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3994
  3995         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  81
* EL650.cbl
  3996             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3997         16  CF-MP-RECON-USE-IND            PIC X(1).
  3998             88  CF-MP-USE-RECON             VALUE 'Y'.
  3999         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4000             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4001         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4002             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4003             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4004         16  FILLER                         PIC X(1).
  4005         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4006             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4007         16  CF-MORTG-MIB-VERSION           PIC X.
  4008             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4009             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4010             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4011         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4012             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4013                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4014             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4015                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4016             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4017                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4018             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4019                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4020             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4021                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4022             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4023                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4024         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4025         16  FILLER                         PIC X(7).
  4026         16  CF-MORTG-DESTINATION-SYMBOL.
  4027             20  CF-MORTG-MIB-COMM          PIC X(5).
  4028             20  CF-MORTG-MIB-TERM          PIC X(5).
  4029         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4030             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4031         16  FILLER                         PIC X(03).
  4032         16  CF-MP-CHECK-NO-CONTROL.
  4033             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4034                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4035                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4036                                                ' ' LOW-VALUES.
  4037                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4038                                               VALUE '3'.
  4039         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4040         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4041         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4042             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4043                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4044             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4045                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4046             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4047                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4048             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4049                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4050             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4051                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4052             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4053                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  82
* EL650.cbl
  4054         16  CF-MORTG-BILLING-AREA.
  4055             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4056                                            PIC X.
  4057         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4058         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4059         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4060         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4061             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4062             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4063         16  FILLER                         PIC X.
  4064         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4065             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4066             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4067         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4068         16  FILLER                         PIC X(8).
  4069         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4070         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4071         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4072         16  CF-ACH-COMPANY-ID.
  4073             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4074                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4075                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4076                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4077             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4078         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4079             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4080         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4081             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4082             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4083         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4084         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4085         16  FILLER                         PIC X(536).
  4086
  4087****************************************************************
  4088*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4089****************************************************************
  4090
  4091     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4092         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4093             20  CF-FEMALE-HEIGHT.
  4094                 24  CF-FEMALE-FT           PIC 99.
  4095                 24  CF-FEMALE-IN           PIC 99.
  4096             20  CF-FEMALE-MIN-WT           PIC 999.
  4097             20  CF-FEMALE-MAX-WT           PIC 999.
  4098         16  FILLER                         PIC X(428).
  4099
  4100     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4101         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4102             20  CF-MALE-HEIGHT.
  4103                 24  CF-MALE-FT             PIC 99.
  4104                 24  CF-MALE-IN             PIC 99.
  4105             20  CF-MALE-MIN-WT             PIC 999.
  4106             20  CF-MALE-MAX-WT             PIC 999.
  4107         16  FILLER                         PIC X(428).
  4108******************************************************************
  4109*             AUTOMATIC ACTIVITY RECORD                          *
  4110******************************************************************
  4111     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  83
* EL650.cbl
  4112         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4113             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4114             20  CF-SYS-LETTER-ID           PIC X(04).
  4115             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4116             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4117             20  CF-SYS-RESET-SW            PIC X(01).
  4118             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4119             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4120
  4121         16  FILLER                         PIC X(50).
  4122
  4123         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4124             20  CF-USER-ACTIVE-SW          PIC X(01).
  4125             20  CF-USER-LETTER-ID          PIC X(04).
  4126             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4127             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4128             20  CF-USER-RESET-SW           PIC X(01).
  4129             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4130             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4131             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4132
  4133         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  84
* EL650.cbl
  4135*    COPY ERCPNDB.
  4136******************************************************************
  4137*                                                                *
  4138*                                                                *
  4139*                            ERCPNDB.                            *
  4140*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4141*                            VMOD=2.025                          *
  4142*                                                                *
  4143*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4144*                                                                *
  4145******************************************************************
  4146*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4147*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4148******************************************************************
  4149*                                                                *
  4150*                                                                *
  4151*   FILE TYPE = VSAM,KSDS                                        *
  4152*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4153*                                                                *
  4154*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4155*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4156*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4157*                                                 RKP=13,LEN=36  *
  4158*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4159*                                      AND CHG-SEQ.)             *
  4160*                                                RKP=49,LEN=11   *
  4161*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4162*                                      AND CHG-SEQ.)             *
  4163*                                                RKP=60,LEN=15   *
  4164*                                                                *
  4165*   LOG = NO                                                     *
  4166*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4167******************************************************************
  4168******************************************************************
  4169*                   C H A N G E   L O G
  4170*
  4171* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4172*-----------------------------------------------------------------
  4173*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4174* EFFECTIVE    NUMBER
  4175*-----------------------------------------------------------------
  4176* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4177* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4178* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4179* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4180* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4181* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4182* 032306                   PEMA  ADD BOW LOAN NUMBER
  4183* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4184* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4185* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4186* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4187* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4188* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4189* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4190******************************************************************
  4191
  4192 01  PENDING-BUSINESS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  85
* EL650.cbl
  4193     12  PB-RECORD-ID                     PIC XX.
  4194         88  VALID-PB-ID                        VALUE 'PB'.
  4195
  4196     12  PB-CONTROL-PRIMARY.
  4197         16  PB-COMPANY-CD                PIC X.
  4198         16  PB-ENTRY-BATCH               PIC X(6).
  4199         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4200         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4201
  4202     12  PB-CONTROL-BY-ACCOUNT.
  4203         16  PB-COMPANY-CD-A1             PIC X.
  4204         16  PB-CARRIER                   PIC X.
  4205         16  PB-GROUPING.
  4206             20  PB-GROUPING-PREFIX       PIC XXX.
  4207             20  PB-GROUPING-PRIME        PIC XXX.
  4208         16  PB-STATE                     PIC XX.
  4209         16  PB-ACCOUNT.
  4210             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4211             20  PB-ACCOUNT-PRIME         PIC X(6).
  4212         16  PB-CERT-EFF-DT               PIC XX.
  4213         16  PB-CERT-NO.
  4214             20  PB-CERT-PRIME            PIC X(10).
  4215             20  PB-CERT-SFX              PIC X.
  4216         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4217
  4218         16  PB-RECORD-TYPE               PIC X.
  4219             88  PB-MAILING-DATA                VALUE '0'.
  4220             88  PB-ISSUE                       VALUE '1'.
  4221             88  PB-CANCELLATION                VALUE '2'.
  4222             88  PB-BATCH-TRAILER               VALUE '9'.
  4223
  4224     12  PB-CONTROL-BY-ORIG-BATCH.
  4225         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4226         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4227         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4228         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4229
  4230     12  PB-CONTROL-BY-CSR.
  4231         16  PB-CSR-COMPANY-CD            PIC X.
  4232         16  PB-CSR-ID                    PIC X(4).
  4233         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4234         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4235         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4236******************************************************************
  4237*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4238******************************************************************
  4239
  4240     12  PB-LAST-MAINT-DT                 PIC XX.
  4241     12  PB-LAST-MAINT-BY                 PIC X(4).
  4242     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4243
  4244     12  PB-RECORD-BODY                   PIC X(375).
  4245
  4246     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4247         16  PB-CERT-ORIGIN               PIC X.
  4248             88  CLASIC-CREATED-CERT         VALUE '1'.
  4249         16  PB-I-NAME.
  4250             20  PB-I-INSURED-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  86
* EL650.cbl
  4251             20  PB-I-INSURED-FIRST-NAME.
  4252                 24  PB-I-INSURED-1ST-INIT PIC X.
  4253                 24  FILLER                PIC X(9).
  4254             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4255         16  PB-I-AGE                     PIC S99   COMP-3.
  4256         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4257         16  PB-I-BIRTHDAY                PIC XX.
  4258         16  PB-I-INSURED-SEX             PIC X.
  4259             88  PB-SEX-MALE     VALUE 'M'.
  4260             88  PB-SEX-FEMALE   VALUE 'F'.
  4261
  4262         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4263         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4264         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4265         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4266         16  PB-I-SKIP-CODE               PIC X.
  4267             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4268             88  PB-SKIP-JULY              VALUE '1'.
  4269             88  PB-SKIP-AUGUST            VALUE '2'.
  4270             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4271             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4272             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4273             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4274             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4275             88  PB-SKIP-JUNE              VALUE '8'.
  4276             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4277             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4278             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4279         16  PB-I-TERM-TYPE               PIC X.
  4280             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4281             88  PB-PAID-WEEKLY            VALUE 'W'.
  4282             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4283             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4284             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4285         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4286         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4287         16  PB-I-DATA-ENTRY-SW           PIC X.
  4288             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4289             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4290             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4291             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4292         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4293         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4294*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4295         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4296         16  FILLER                       PIC X.
  4297
  4298         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4299             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4300             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4301                                                   '90' THRU '99'.
  4302         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4303                                          PIC XX.
  4304         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4305         16  PB-I-AMOUNT-FINANCED REDEFINES
  4306                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4307         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4308         16  PB-I-UNPAID-CASH-PRICE REDEFINES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  87
* EL650.cbl
  4309                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4310         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4311         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4312         16  PB-I-CLP-AMOUNT REDEFINES
  4313                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4314         16  PB-I-LF-CALC-FLAG            PIC X.
  4315             88 PB-COMP-LF-PREM               VALUE '?'.
  4316         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4317         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4318         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4319         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4320         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4321         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4322         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4323         16  PB-I-LF-ABBR                 PIC XXX.
  4324         16  PB-I-LF-INPUT-CD             PIC XX.
  4325
  4326         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4327             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4328             88  PB-INVALID-AH               VALUE '  ' '00'
  4329                                                   '90' THRU '99'.
  4330         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4331         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4332         16  PB-I-AH-CALC-FLAG            PIC X.
  4333             88 PB-COMP-AH-PREM                  VALUE '?'.
  4334         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4335         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4336         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4337         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4338         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4339         16  PB-I-AH-ABBR                 PIC XXX.
  4340         16  PB-I-AH-INPUT-CD             PIC XXX.
  4341
  4342         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4343         16  PB-I-REIN-TABLE              PIC XXX.
  4344         16  PB-I-BUSINESS-TYPE           PIC 99.
  4345         16  PB-I-INDV-GRP-CD             PIC X.
  4346         16  PB-I-MORT-CODE.
  4347             20  PB-I-TABLE               PIC X.
  4348             20  PB-I-INTEREST            PIC XX.
  4349             20  PB-I-MORT-TYP            PIC X.
  4350         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4351         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4352         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4353         16  PB-I-INDV-GRP-OVRD           PIC X.
  4354         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4355         16  PB-I-SIG-SW                  PIC X.
  4356             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4357         16  PB-I-RATE-CLASS              PIC XX.
  4358         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4359         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4360         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4361         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4362         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4363         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4364         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4365         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4366         16  PB-I-OB-FLAG                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  88
* EL650.cbl
  4367             88  PB-I-OB                      VALUE 'B'.
  4368             88  PB-I-SUMMARY                 VALUE 'Z'.
  4369         16  PB-I-ENTRY-STATUS            PIC X.
  4370             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4371                                              'M' '5' '9' '2'.
  4372             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4373             88  PB-I-POLICY-PENDING          VALUE '2'.
  4374             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4375             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4376             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4377             88  PB-I-REIN-ONLY               VALUE '9'.
  4378             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4379             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4380             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4381             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4382         16  PB-I-INT-CODE                PIC X.
  4383             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4384             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4385         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4386         16  PB-I-SOC-SEC-NO              PIC X(11).
  4387         16  PB-I-MEMBER-NO               PIC X(12).
  4388         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4389*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4390         16  PB-I-OLD-LOF                 PIC XXX.
  4391         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4392         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4393         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4394         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4395         16  PB-I-LIFE-INDICATOR          PIC X.
  4396             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4397         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4398         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4399             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4400             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4401         16  PB-I-1ST-PMT-DT              PIC XX.
  4402         16  PB-I-JOINT-INSURED.
  4403             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4404             20 PB-I-JOINT-FIRST-NAME.
  4405                24  PB-I-JOINT-FIRST-INIT PIC X.
  4406                24  FILLER                PIC X(9).
  4407             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4408*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4409         16  PB-I-BENEFICIARY-NAME.
  4410             20  PB-I-BANK-NUMBER         PIC X(10).
  4411             20  FILLER                   PIC X(15).
  4412         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4413         16  PB-I-REFERENCE               PIC X(12).
  4414         16  FILLER REDEFINES PB-I-REFERENCE.
  4415             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4416             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4417             20  PB-I-CLP-STATE           PIC XX.
  4418         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4419             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4420             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4421             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4422         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4423         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4424         16  PB-I-RESIDENT-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  89
* EL650.cbl
  4425         16  PB-I-RATE-CODE               PIC X(4).
  4426         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4427         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4428         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4429         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4430         16  PB-I-BANK-NOCHRGB            PIC 99.
  4431         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4432         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4433
  4434     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4435         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4436             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4437         16  PB-C-CANCEL-ORIGIN           PIC X.
  4438             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4439         16  PB-C-LF-CANCEL-DT            PIC XX.
  4440         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4441         16  PB-C-LF-CALC-REQ             PIC X.
  4442             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4443         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4444         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4445         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4446             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4447         16  PB-C-AH-CANCEL-DT            PIC XX.
  4448         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4449         16  PB-C-AH-CALC-REQ             PIC X.
  4450             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4451         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4452         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4453         16  PB-C-LAST-NAME               PIC X(15).
  4454         16  PB-C-REFUND-SW               PIC X.
  4455             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4456             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4457         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4458         16  PB-C-PAYEE-CODE              PIC X(6).
  4459         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4460         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4461         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4462         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4463         16  PB-C-REFERENCE               PIC X(12).
  4464         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4465         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4466         16  PB-C-POST-CARD-IND           PIC X.
  4467         16  PB-C-CANCEL-REASON           PIC X.
  4468         16  PB-C-REF-INTERFACE-SW        PIC X.
  4469         16  FILLER                       PIC X(09).
  4470*        16  FILLER                       PIC X(18).
  4471         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4472*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4473         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4474         16  PB-CANCELED-CERT-DATA.
  4475             20  PB-CI-INSURED-NAME.
  4476                 24  PB-CI-LAST-NAME      PIC X(15).
  4477                 24  PB-CI-INITIALS       PIC XX.
  4478             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4479             20  PB-CI-INSURED-SEX        PIC X.
  4480             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4481             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4482             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  90
* EL650.cbl
  4483             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4484             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4485             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4486             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4487             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4488             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4489             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4490             20  PB-CI-RATE-CLASS         PIC XX.
  4491             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4492             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4493             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4494             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4495             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4496             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4497             20  PB-CI-LF-ABBR            PIC X(3).
  4498             20  PB-CI-AH-ABBR            PIC X(3).
  4499             20  PB-CI-OB-FLAG            PIC X.
  4500                 88  PB-CI-OB                VALUE 'B'.
  4501             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4502                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4503                                           'M' '4' '5' '9' '2'.
  4504                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4505                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4506                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4507                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4508                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4509                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4510                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4511                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4512                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4513                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4514                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4515                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4516             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4517                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4518                                           'M' '4' '5' '9' '2'.
  4519                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4520                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4521                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4522                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4523                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4524                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4525                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4526                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4527                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4528                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4529                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4530                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4531             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4532             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4533             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4534             20  PB-CI-MEMBER-NO          PIC X(12).
  4535             20  PB-CI-INT-CODE           PIC X.
  4536                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4537                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4538             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4539             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4540             20  PB-CI-COMP-EXCP-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  91
* EL650.cbl
  4541                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4542                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4543             20  PB-CI-ENTRY-STATUS       PIC X.
  4544             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4545             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4546             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4547             20  PB-CI-DEATH-DT           PIC XX.
  4548             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4549             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4550             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4551             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4552             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4553             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4554             20  PB-CI-ENTRY-DT              PIC XX.
  4555             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4556             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4557             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4558             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4559             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4560             20  PB-CI-OLD-LOF               PIC XXX.
  4561*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4562             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4563             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4564             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4565             20  PB-CI-INDV-GRP-CD           PIC X.
  4566             20  PB-CI-BENEFICIARY-NAME.
  4567                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4568                 24  FILLER                  PIC X(15).
  4569             20  PB-CI-NOTE-SW               PIC X.
  4570             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4571             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4572             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4573             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4574             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4575             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4576             20  PB-CI-FIRST-NAME            PIC X(10).
  4577
  4578         16  FILLER                       PIC X(17).
  4579*032306  16  FILLER                       PIC X(27).
  4580*        16  FILLER                       PIC X(46).
  4581
  4582     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4583         16  FILLER                       PIC X(10).
  4584         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4585         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4586         16  PB-M-INSURED-MID-INIT        PIC X.
  4587         16  PB-M-INSURED-AGE             PIC 99.
  4588         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4589         16  PB-M-INSURED-SEX             PIC X.
  4590         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4591         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4592         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4593         16  PB-M-INSURED-CITY-STATE.
  4594             20  PB-M-INSURED-CITY        PIC X(28).
  4595             20  PB-M-INSURED-STATE       PIC XX.
  4596         16  PB-M-INSURED-ZIP-CODE.
  4597             20  PB-M-INSURED-ZIP-PRIME.
  4598                 24  PB-M-INSURED-ZIP-1   PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  92
* EL650.cbl
  4599                     88  PB-M-CANADIAN-POST-CODE
  4600                                             VALUE 'A' THRU 'Z'.
  4601                 24  FILLER               PIC X(4).
  4602             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4603         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4604                                        PB-M-INSURED-ZIP-CODE.
  4605             20  PM-M-INS-CAN-POST1       PIC XXX.
  4606             20  PM-M-INS-CAN-POST2       PIC XXX.
  4607             20  FILLER                   PIC XXX.
  4608         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4609         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4610         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4611         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4612         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4613         16  PB-M-CRED-BENE-CITYST.
  4614             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4615             20  PB-M-CRED-BENE-STATE     PIC XX.
  4616         16  FILLER                       PIC X(92).
  4617
  4618     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4619         16  FILLER                       PIC X(10).
  4620         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4621         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4622         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4623         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4624         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4625         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4626         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4627         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4628         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4629         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4630         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4631         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4632         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4633         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4634         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4635         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4636         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4637         16  PB-ACCOUNT-NAME              PIC X(30).
  4638         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4639         16  PB-REFERENCE                 PIC X(12).
  4640         16  PB-B-RECEIVED-DT             PIC XX.
  4641         16  FILLER                       PIC X(234).
  4642
  4643     12  PB-RECORD-STATUS.
  4644         16  PB-CREDIT-SELECT-DT          PIC XX.
  4645         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4646         16  PB-BILLED-DT                 PIC XX.
  4647         16  PB-BILLING-STATUS            PIC X.
  4648             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4649             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4650             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4651         16  PB-RECORD-BILL               PIC X.
  4652             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4653             88  PB-RECORD-RETURNED           VALUE 'R'.
  4654             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4655             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4656             88  PB-OVERRIDE-AH               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  93
* EL650.cbl
  4657             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4658         16  PB-BATCH-ENTRY               PIC X.
  4659             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4660             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4661             88  PB-REISSUED-CERT             VALUE 'E'.
  4662             88  PB-MONTHLY-CERT              VALUE 'M'.
  4663             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4664             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4665             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4666         16  PB-FORCE-CODE                PIC X.
  4667             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4668             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4669             88  PB-CANCEL-FORCE              VALUE '8'.
  4670             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4671             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4672             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4673             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4674             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4675             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4676             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4677         16  PB-FATAL-FLAG                PIC X.
  4678             88  PB-FATAL-ERRORS              VALUE 'X'.
  4679         16  PB-FORCE-ER-CD               PIC X.
  4680             88  PB-FORCE-ERRORS              VALUE 'F'.
  4681             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4682         16  PB-WARN-ER-CD                PIC X.
  4683             88  PB-WARNING-ERRORS            VALUE 'W'.
  4684         16  FILLER                       PIC X.
  4685         16  PB-OUT-BAL-CD                PIC X.
  4686             88  PB-OUT-OF-BAL                VALUE 'O'.
  4687         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4688         16  PB-AH-OVERRIDE-L1            PIC X.
  4689         16  PB-INPUT-DT                  PIC XX.
  4690         16  PB-INPUT-BY                  PIC X(4).
  4691         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4692         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4693         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4694         16  PB-LF-EARNING-METHOD         PIC X.
  4695         16  PB-AH-EARNING-METHOD         PIC X.
  4696         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4697         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4698         16  PB-REIN-CD                   PIC XXX.
  4699         16  PB-LF-REFUND-TYPE            PIC X.
  4700         16  PB-AH-REFUND-TYPE            PIC X.
  4701         16  PB-ACCT-EFF-DT               PIC XX.
  4702         16  PB-ACCT-EXP-DT               PIC XX.
  4703         16  PB-COMPANY-ID                PIC X(3).
  4704         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4705         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4706         16  PB-SV-CARRIER                PIC X.
  4707         16  PB-SV-GROUPING               PIC X(6).
  4708         16  PB-SV-STATE                  PIC XX.
  4709         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4710         16  PB-GA-BILLING-INFO.
  4711             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4712                                          PIC XX.
  4713         16  PB-SV-REMIT-TO  REDEFINES
  4714             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  94
* EL650.cbl
  4715         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4716         16  PB-I-LOAN-OFFICER            PIC X(5).
  4717         16  PB-I-VIN                     PIC X(17).
  4718
  4719         16  FILLER                       PIC X(04).
  4720         16  IMNET-BYPASS-SW              PIC X.
  4721
  4722******************************************************************
  4723*                COMMON EDIT ERRORS                              *
  4724******************************************************************
  4725
  4726     12  PB-COMMON-ERRORS.
  4727         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4728                                           PIC S9(4)     COMP.
  4729
  4730******************************************************************
  4731*EJECT
  4732*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  95
* EL650.cbl
  4734 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  4735                          COMPENSATION-MASTER
  4736                          NAME-LOOKUP-MASTER PLAN-MASTER
  4737                          CONTROL-FILE PENDING-BUSINESS.
  4738 0000-DFHEXIT SECTION.
  4739     MOVE '9#                    $   ' TO DFHEIV0.
  4740     MOVE 'EL650' TO DFHEIV1.
  4741     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4742
  4743     MOVE LOW-VALUES             TO  WS-VERIFY-AREA.
  4744     INITIALIZE  TEMP-STORAGE-RECORD.
  4745
  4746     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4747     MOVE '5'                    TO  DC-OPTION-CODE.
  4748
  4749     PERFORM 9700-DATE-CONVERSION.
  4750
  4751     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4752     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4753     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  4754     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  4755*    display ' beginning of program el650   '
  4756
  4757     IF EIBCALEN  =  0
  4758         GO TO 8800-UNAUTHORIZED-ACCESS.
  4759
  4760     MOVE SCREEN-NUMBER          TO  TS-SCREEN.
  4761     MOVE EIBTRMID               TO  TS-TERM.
  4762     MOVE LOW-VALUES             TO  EL650AI.
  4763
  4764     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  4765         MOVE PI-CALLING-PROGRAM        TO  RETURNED-FROM.
  4766
  4767     IF PI-CALLING-PROGRAM  NOT = THIS-PGM
  4768         IF PI-RETURN-TO-PROGRAM  NOT = THIS-PGM
  4769             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  4770             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  4771             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  4772             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  4773             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  4774             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  4775             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  4776             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  4777             MOVE LOW-VALUES            TO  PI-PROGRAM-WORK-AREA
  4778             MOVE ZEROS                 TO  PI-TOTAL-LINES
  4779                                            PI-LINE-SELECTED
  4780             MOVE SPACE                 TO  PI-RECORD-ADDED-SW
  4781             MOVE 1                     TO  PI-PAGE-NUMBER
  4782         ELSE
  4783             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  4784             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  4785             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  4786             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  4787             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  4788             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  4789             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  4790             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  4791
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  96
* EL650.cbl
  4792**************************************************************
  4793*               CLIENT "DMD" CUSTOM CODE
  4794* CHECK IF CONTROL PASSED FROM EL608 PROGRAM
  4795* START BROWSE BEGINNING WITH KEY PASSED BY EL608
  4796*              CSO CR# 6475
  4797     IF EIBTRNID  =  EL608-TRANS-ID
  4798         MOVE 1                     TO RETURN-FROM-SW
  4799         MOVE 'Y'                   TO FROM-EL608-SW
  4800         MOVE TRANS-ID              TO EIBTRNID
  4801         MOVE XCTL-EL601            TO PI-RETURN-TO-PROGRAM
  4802         MOVE PI-PREV-VG-ACCOUNT    TO PI-ACCT-CCGSA-KEY
  4803                                       KEY-SAVE
  4804         MOVE LOW-VALUES            TO PI-ACCT-EXP-DT
  4805                                       PI-ACCT-REST-OF-EXP
  4806                                       PI-DATE-RANGE-TABLE
  4807
  4808* EXEC CICS  HANDLE CONDITION
  4809*            NOTFND   (5340-END)
  4810*            ENDFILE  (5330-NOT-FOUND)
  4811*        END-EXEC
  4812*    MOVE '"$I''                  ! " #00004803' TO DFHEIV0
  4813     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4814     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4815     MOVE X'2220233030303034383033' TO DFHEIV0(25:11)
  4816     CALL 'kxdfhei1' USING DFHEIV0
  4817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4818         MOVE 'Y'                   TO FIRST-TIME-SW
  4819         MOVE ZEROS                 TO PI-TOTAL-LINES
  4820         SET T-INDEX
  4821             TS-INDEX  TO  +1
  4822         MOVE ACCT-FILE-ID          TO PI-ACCT-ID
  4823         MOVE 1                     TO PI-PAGE-NUMBER
  4824         MOVE 'S'                   TO PI-MAINT
  4825         MOVE DFHPF1                TO EIBAID
  4826         GO TO 1002-SHOW-NEW-RECORDS.
  4827*    END OF CLIENT "DMD" CUSTOM CODE
  4828**************************************************************
  4829
  4830     IF RETURNED-FROM = XCTL-6501 OR XCTL-6502 OR XCTL-6503 OR
  4831                        XCTL-6504 OR XCTL-6505 OR XCTL-6506 OR
  4832                        XCTL-6508
  4833         MOVE 1                     TO  RETURN-FROM-SW
  4834         MOVE PI-PREV-VG-ACCOUNT    TO  PI-ACCT-CCGSA-KEY
  4835         MOVE PI-ACCT-CCGSA-KEY     TO  KEY-SAVE
  4836         MOVE LOW-VALUES            TO  PI-ACCT-EXP-DT
  4837         GO TO 1002-SHOW-NEW-RECORDS.
  4838
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  97
* EL650.cbl
  4840     IF EIBTRNID  NOT =  TRANS-ID
  4841         IF EIBTRNID  NOT = EL640-TRANS-ID  AND
  4842            EIBTRNID  NOT = EL658-TRANS-ID  AND
  4843            EIBTRNID  NOT = EL6311-TRANS-ID AND
  4844            EIBTRNID  NOT = EL1273-TRANS-ID AND
  4845            EIBTRNID  NOT = EL652-TRANS-ID  AND
  4846            EIBTRNID  NOT = EL6523-TRANS-ID AND
  4847            EIBTRNID  NOT = EL6311NC-TRANS-ID AND
  4848            EIBTRNID  NOT = EL130-TRANS-ID  AND
  4849            EIBTRNID  NOT = EL6592-TRANS-ID AND
  4850            EIBTRNID  NOT = EL6509-TRANS-ID
  4851            AND EIBTRNID NOT = EL6503-TRANS-ID
  4852             GO TO 8100-SEND-INITIAL-MAP
  4853         ELSE
  4854             IF PI-CR-CONTROL-IN-PROGRESS  = SPACES
  4855                 GO TO 8100-SEND-INITIAL-MAP
  4856             ELSE
  4857                 MOVE 'S'             TO  MAINTI
  4858                 MOVE PI-CR-CARRIER   TO  ACARIERI
  4859                 MOVE PI-CR-GROUPING  TO  AGROUPI
  4860                 MOVE PI-CR-STATE     TO  ASTATEI
  4861                 MOVE PI-CR-ACCOUNT   TO  AACCTI
  4862                 MOVE +1              TO  ACARIERL
  4863                                          MAINTL
  4864                 MOVE +6              TO  AGROUPL
  4865                 MOVE +2              TO  ASTATEL
  4866                 MOVE +10             TO  AACCTL
  4867                 GO TO 0330-EDIT-DATA.
  4868
  4869
  4870* EXEC CICS  HANDLE CONDITION
  4871*        PGMIDERR  (9600-PGMID-ERROR)
  4872*        ERROR     (9990-ABEND)
  4873*    END-EXEC.
  4874*    MOVE '"$L.                  ! # #00004858' TO DFHEIV0
  4875     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  4876     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4877     MOVE X'2320233030303034383538' TO DFHEIV0(25:11)
  4878     CALL 'kxdfhei1' USING DFHEIV0
  4879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4880
  4881
  4882     IF EIBAID  = DFHCLEAR
  4883         GO TO 9400-CLEAR.
  4884
  4885     IF PI-PROCESSOR-ID  =  'LGXX'
  4886         GO TO 0200-RECEIVE.
  4887
  4888
  4889* EXEC CICS  READQ TS
  4890*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  4891*        INTO    (SECURITY-CONTROL)
  4892*        LENGTH  (SC-COMM-LENGTH)
  4893*        ITEM    (SC-ITEM)
  4894*    END-EXEC.
  4895*    MOVE '*$II   L              ''   #00004869' TO DFHEIV0
  4896     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4897     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  98
* EL650.cbl
  4898     MOVE X'2020233030303034383639' TO DFHEIV0(25:11)
  4899     CALL 'kxdfhei1' USING DFHEIV0,
  4900           PI-SECURITY-TEMP-STORE-ID,
  4901           SECURITY-CONTROL,
  4902           SC-COMM-LENGTH,
  4903           SC-ITEM,
  4904           DFHEIV99,
  4905           DFHEIV99
  4906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4907
  4908
  4909     MOVE SC-CREDIT-DISPLAY (04)  TO  PI-DISPLAY-CAP.
  4910     MOVE SC-CREDIT-UPDATE  (04)  TO  PI-MODIFY-CAP.
  4911
  4912     IF NOT DISPLAY-CAP
  4913         MOVE 'READ'             TO  SM-READ
  4914         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  4915         MOVE ER-0070            TO  EMI-ERROR
  4916         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4917         GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  99
* EL650.cbl
  4919 0200-RECEIVE.
  4920     IF EIBAID  = DFHPA1  OR  DFHPA2  OR  DFHPA3
  4921         MOVE ER-0008            TO  EMI-ERROR
  4922         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4923         MOVE -1                 TO  MAINTL
  4924         GO TO 8200-SEND-DATAONLY.
  4925
  4926
  4927* EXEC CICS  RECEIVE
  4928*        MAP     (MAP-NAME)
  4929*        MAPSET  (MAPSET-NAME)
  4930*        INTO    (EL650AI)
  4931*    END-EXEC.
  4932     MOVE LENGTH OF
  4933      EL650AI
  4934       TO DFHEIV11
  4935*    MOVE '8"T I  L              ''   #00004893' TO DFHEIV0
  4936     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4937     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4938     MOVE X'2020233030303034383933' TO DFHEIV0(25:11)
  4939     CALL 'kxdfhei1' USING DFHEIV0,
  4940           MAP-NAME,
  4941           EL650AI,
  4942           DFHEIV11,
  4943           MAPSET-NAME,
  4944           DFHEIV99,
  4945           DFHEIV99
  4946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4947
  4948
  4949     IF PFENTERL  = ZERO
  4950         GO TO 0300-CHECK-PFKEYS.
  4951
  4952     IF EIBAID  NOT = DFHENTER
  4953         MOVE ER-0004            TO  EMI-ERROR
  4954         GO TO 0320-INPUT-ERROR.
  4955
  4956     IF (PFENTERI NUMERIC)
  4957       AND  (PFENTERI GREATER ZERO AND LESS 25)
  4958         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  4959     ELSE
  4960         MOVE ER-0029               TO  EMI-ERROR
  4961         GO TO 0320-INPUT-ERROR.
  4962
  4963 0300-CHECK-PFKEYS.
  4964     IF EIBAID  = DFHPF23
  4965         GO TO 8810-PF23.
  4966
  4967     IF EIBAID  = DFHPF24
  4968         GO TO 9200-RETURN-MAIN-MENU.
  4969
  4970     IF EIBAID  = DFHPF12
  4971         GO TO 9500-PF12.
  4972
  4973     IF MAINTL  NOT = ZERO   AND
  4974        MAINTI  NOT = SPACE  AND
  4975        EIBAID  NOT = DFHENTER
  4976          MOVE ER-0050            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 100
* EL650.cbl
  4977          GO TO 0320-INPUT-ERROR.
  4978
  4979     if (maintl not = zeros)
  4980        and (mainti not = 'D')
  4981        move spaces              to pi-el650-del-sw
  4982     end-if
  4983     IF EIBAID  = DFHPF1
  4984         GO TO 5300-FIND-NEXT-ACCOUNT.
  4985
  4986     IF EIBAID  = DFHPF2
  4987         GO TO 5400-FIND-PREV-ACCOUNT.
  4988
  4989     IF EIBAID  = DFHPF3
  4990         GO TO 5100-FIND-NEXT-RANGE.
  4991
  4992     IF EIBAID  = DFHPF4
  4993         GO TO 5200-FIND-PREV-RANGE.
  4994
  4995     IF EIBAID  = DFHPF5
  4996         GO TO 8900-PF5.
  4997
  4998     IF EIBAID  = DFHPF6
  4999        GO TO 8910-PF6
  5000     END-IF
  5001     IF EIBAID  = DFHENTER
  5002         GO TO 0330-EDIT-DATA.
  5003
  5004     MOVE ER-0029                TO  EMI-ERROR.
  5005
  5006 0320-INPUT-ERROR.
  5007     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5008
  5009     MOVE AL-UNBON               TO  PFENTERA.
  5010
  5011     IF PFENTERL  = ZERO
  5012         MOVE -1                 TO  MAINTL
  5013     ELSE
  5014         MOVE -1                 TO  PFENTERL.
  5015
  5016     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 101
* EL650.cbl
  5018 0330-EDIT-DATA.
  5019     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5020     MOVE '5'                    TO  DC-OPTION-CODE.
  5021
  5022     PERFORM 9700-DATE-CONVERSION.
  5023
  5024     MOVE DC-BIN-DATE-1          TO  BIN-CURRENT-SAVE.
  5025     MOVE DC-GREG-DATE-1-YMD     TO  CURRENT-SAVE.
  5026
  5027     IF ACARIERL GREATER ZEROS
  5028         IF PI-CARRIER-SECURITY GREATER SPACES
  5029             IF ACARIERI = PI-CARRIER-SECURITY
  5030                 NEXT SENTENCE
  5031             ELSE
  5032                 MOVE -1         TO  ACARIERL
  5033                 MOVE ER-2370    TO  EMI-ERROR
  5034                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5035                 MOVE AL-UABON   TO  ACARIERA
  5036                 GO TO 8200-SEND-DATAONLY.
  5037
  5038     IF MAINTI  = 'S'
  5039       IF LINEL = ZEROS
  5040           MOVE 1 TO PI-PAGE-NUMBER
  5041           GO TO 1000-SHOW-ACCOUNT
  5042       ELSE
  5043           GO TO 1000-SHOW-ACCOUNT.
  5044
  5045     PERFORM 6800-COMPANY-REC-READ  THRU  6899-EXIT.
  5046
  5047     IF EMI-ERROR  NOT = ZEROS
  5048         MOVE -1                 TO  MAINTL
  5049         GO TO 8200-SEND-DATAONLY.
  5050
  5051     IF NOT  MODIFY-CAP
  5052         MOVE 'UPDATE'           TO  SM-READ
  5053         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  5054         MOVE ER-0070            TO  EMI-ERROR
  5055         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5056         MOVE AL-UANON           TO  ACARIERA  AGROUPA
  5057                                     ASTATEA   AACCTA
  5058         GO TO 8100-SEND-INITIAL-MAP.
  5059
  5060     IF MAINTI  = 'A'
  5061         GO TO 1500-ADD-ACCOUNT.
  5062
  5063     IF MAINTI  = 'C'
  5064         IF PI-SV-MAINT IS EQUAL TO 'L'
  5065            MOVE -1              TO  MAINTL
  5066            MOVE AL-UABON        TO  MAINTA
  5067            MOVE ER-0899         TO  EMI-ERROR
  5068            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5069            GO TO 8200-SEND-DATAONLY
  5070         ELSE
  5071            GO TO 2000-CHANGE-ACCOUNT.
  5072
  5073     IF MAINTI  = 'D'
  5074         GO TO 2500-DELETE-ACCOUNT.
  5075
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 102
* EL650.cbl
  5076     IF MAINTI  = 'X'
  5077         GO TO 3000-CHANGE-EXPIRATION.
  5078
  5079     IF MAINTI  = 'E'
  5080         GO TO 3500-CHANGE-EFFECTIVE.
  5081
  5082     IF MAINTI  = 'L'
  5083         MOVE 'L'             TO  PI-SV-MAINT
  5084         GO TO 4000-CHANGE-ALL.
  5085
  5086     IF MAINTI  = 'K'
  5087       IF LINEL GREATER ZERO
  5088           GO TO 4900-CREATE-NEW-ACCOUNT
  5089        ELSE
  5090           GO TO 4500-CREATE-NEW-ACCOUNT.
  5091
  5092     IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5093         IF MAINTI  = 'T'
  5094             GO TO 4500-CREATE-NEW-ACCOUNT.
  5095
  5096     IF MAINTI  = 'N'
  5097         GO TO 5000-CREATE-NEW-RANGE.
  5098
  5099     MOVE ER-0023                TO  EMI-ERROR.
  5100
  5101     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5102
  5103     MOVE -1                     TO  MAINTL.
  5104     MOVE AL-UABON               TO  MAINTA.
  5105
  5106     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 103
* EL650.cbl
  5108 1000-SHOW-ACCOUNT.
  5109     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5110
  5111     IF LINEL GREATER ZEROS   AND
  5112        PI-TOTAL-LINES  NOT =  ZEROS
  5113         NEXT SENTENCE
  5114     ELSE
  5115         GO TO 1002-SHOW-NEW-RECORDS.
  5116
  5117     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5118
  5119     IF EMI-ERROR  NOT = ZEROS
  5120         GO TO 8200-SEND-DATAONLY.
  5121
  5122     SET T-INDEX                 TO  LINEI.
  5123
  5124     IF PI-2ND-PAGE
  5125         SET T-INDEX  UP  BY  8
  5126     ELSE
  5127     IF PI-3RD-PAGE
  5128         SET T-INDEX  UP  BY  16
  5129     ELSE
  5130     IF PI-LST-PAGE
  5131         SET T-INDEX  UP  BY  24.
  5132
  5133     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5134     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5135
  5136     IF PI-PREV-ACCOUNT  =  PI-ACCT-CCGSA-KEY
  5137         MOVE MAINTI             TO  PI-MAINT
  5138         MOVE XCTL-6501          TO  PGM-NAME
  5139         GO TO 9300-XCTL
  5140     ELSE
  5141         IF PI-PREV-VG-ACCOUNT = PI-ACCT-CCGSA-KEY
  5142             MOVE MAINTI         TO  PI-MAINT
  5143             MOVE XCTL-6501      TO  PGM-NAME
  5144             PERFORM 7400-READ-TEMP-STORAGE  THRU  7400-EXIT
  5145             SET TS-INDEX        TO  T-INDEX
  5146             MOVE TS-ACCT-KEY (TS-INDEX)
  5147                                 TO  PI-ACCT-CCGSA-KEY
  5148             GO TO 9300-XCTL.
  5149
  5150 1002-SHOW-NEW-RECORDS.
  5151
  5152* EXEC CICS  HANDLE CONDITION
  5153*         NOTFND   (1010-NOT-FOUND)
  5154*         ENDFILE  (1010-NOT-FOUND)
  5155*    END-EXEC.
  5156*    MOVE '"$I''                  ! $ #00005101' TO DFHEIV0
  5157     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5158     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5159     MOVE X'2420233030303035313031' TO DFHEIV0(25:11)
  5160     CALL 'kxdfhei1' USING DFHEIV0
  5161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5162
  5163
  5164     SET T-INDEX
  5165        TS-INDEX  TO  +1.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 104
* EL650.cbl
  5166
  5167     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE.
  5168
  5169     MOVE LOW-VALUES             TO  TEMP-STORAGE-RECORD.
  5170
  5171     MOVE ZEROS                  TO  PI-TOTAL-LINES.
  5172
  5173     PERFORM 7100-START-BROWSE  THRU  7100-EXIT.
  5174
  5175     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  5176
  5177 1005-READ-ACCT.
  5178     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  5179
  5180     IF K-WITH-LINE-NO
  5181       IF SV-CARRIER   NOT = AM-CARRIER  OR
  5182          SV-GROUPING  NOT = AM-GROUPING OR
  5183          SV-STATE     NOT = AM-STATE    OR
  5184          SV-ACCOUNT   NOT = AM-ACCOUNT
  5185            GO TO 1010-NOT-FOUND.
  5186
  5187     IF SV-CO  NOT = AM-COMPANY-CD
  5188         GO TO 1010-NOT-FOUND.
  5189
  5190     IF SV-ACCOUNT  NOT =  AM-ACCOUNT
  5191         GO TO 1010-NOT-FOUND.
  5192
  5193     IF SV-STATE  NOT = AM-STATE
  5194       AND  (ST-ACCNT-CNTL
  5195       OR  CARR-ST-ACCNT-CNTL
  5196       OR  CARR-GROUP-ST-ACCNT-CNTL)
  5197         GO TO 1010-NOT-FOUND.
  5198
  5199     IF SV-CARRIER  NOT =  AM-CARRIER
  5200       AND  (CARR-ACCNT-CNTL
  5201       OR  CARR-ST-ACCNT-CNTL
  5202       OR  CARR-GROUP-ST-ACCNT-CNTL)
  5203         GO TO 1010-NOT-FOUND.
  5204
  5205     IF SV-GROUPING  NOT = AM-GROUPING
  5206       AND  CARR-GROUP-ST-ACCNT-CNTL
  5207         GO TO 1010-NOT-FOUND.
  5208
  5209     IF AM-TRNTO-DTE  =  SPACES
  5210         MOVE LOW-VALUES         TO  AM-TRNTO-DTE.
  5211
  5212     IF AM-TRNFROM-DTE  = SPACES
  5213         MOVE LOW-VALUES         TO  AM-TRNFROM-DTE.
  5214
  5215     IF T-INDEX  = 1
  5216         IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5217             MOVE AM-TRANSFERRED-TO  TO  TRNTOO
  5218             MOVE AM-TRNTO-DTE       TO  DC-BIN-DATE-1
  5219             MOVE SPACE              TO  DC-OPTION-CODE
  5220             PERFORM 9700-DATE-CONVERSION
  5221             IF DATE-CONVERSION-ERROR
  5222                 MOVE SPACES         TO  TRNTODTO
  5223             ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 105
* EL650.cbl
  5224                 MOVE DC-GREG-DATE-1-EDIT
  5225                                     TO  TRNTODTO.
  5226
  5227     IF T-INDEX  =  1
  5228         IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5229             MOVE AM-TRANSFERRED-FROM  TO  TRNFROMO
  5230             MOVE AM-TRNFROM-DTE       TO  DC-BIN-DATE-1
  5231             MOVE SPACE                TO  DC-OPTION-CODE
  5232             PERFORM 9700-DATE-CONVERSION
  5233             IF DATE-CONVERSION-ERROR
  5234                 MOVE SPACES           TO  TRNFRDTO
  5235             ELSE
  5236                 MOVE DC-GREG-DATE-1-EDIT
  5237                                       TO  TRNFRDTO.
  5238
  5239     IF T-INDEX  = 1
  5240         MOVE AM-CONTROL-PRIMARY  TO  PI-PREV-ACCOUNT
  5241         MOVE PI-ACCT-CCGSA-KEY   TO  PI-PREV-VG-ACCOUNT
  5242         MOVE AM-NAME             TO  NAMEO
  5243                                      PI-ACCNAME
  5244         MOVE SPACE               TO  NAMEFLGO
  5245                                      PI-NAMEFLG.
  5246
  5247     IF AM-NAME  NOT = NAMEO
  5248         MOVE '*'                TO  NAMEFLGO
  5249                                     PI-NAMEFLG.
  5250
  5251     PERFORM 1020-MOVE-TO-TABLE  THRU  1020-EXIT.
  5252
  5253     GO TO 1005-READ-ACCT.
  5254
  5255 1010-NOT-FOUND.
  5256     IF BROWSE-STARTED
  5257
  5258* EXEC CICS  ENDBR
  5259*            DATASET  (PI-ACCT-ID)
  5260*        END-EXEC.
  5261     MOVE 0
  5262       TO DFHEIV11
  5263*    MOVE '&2                    $   #00005199' TO DFHEIV0
  5264     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5265     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5266     MOVE X'2020233030303035313939' TO DFHEIV0(25:11)
  5267     CALL 'kxdfhei1' USING DFHEIV0,
  5268           PI-ACCT-ID,
  5269           DFHEIV11,
  5270           DFHEIV99
  5271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5272
  5273
  5274     IF T-INDEX  NOT = 1
  5275         PERFORM 7200-WRITE-TEMP-STORAGE  THRU  7200-EXIT
  5276         GO TO 7000-BUILD-OUTPUT-MAP.
  5277
  5278     MOVE ER-0226                TO  EMI-ERROR.
  5279
  5280     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5281
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 106
* EL650.cbl
  5282     MOVE -1                     TO  ACARIERL.
  5283     MOVE AL-UABON               TO  ACARIERA
  5284                                     AGROUPA
  5285                                     ASTATEA
  5286                                     AACCTA.
  5287
  5288     IF FROM-EL608-SW = 'Y'
  5289         MOVE SV-CARRIER     TO  ACARIERO
  5290         MOVE SV-GROUPING    TO  AGROUPO
  5291         MOVE SV-STATE       TO  ASTATEO
  5292         MOVE SV-ACCOUNT     TO  AACCTO
  5293         MOVE 'N'            TO  FROM-EL608-SW.
  5294
  5295     IF PI-MAINT = 'A'
  5296         IF PI-RECORD-NOT-CREATED
  5297             MOVE SV-CARRIER     TO  ACARIERO
  5298             MOVE SV-GROUPING    TO  AGROUPO
  5299             MOVE SV-STATE       TO  ASTATEO
  5300             MOVE SV-ACCOUNT     TO  AACCTO
  5301             MOVE ER-2151        TO  EMI-ERROR
  5302             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5303             MOVE 'S'            TO  PI-MAINT.
  5304
  5305     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 107
* EL650.cbl
  5307 1020-MOVE-TO-TABLE.
  5308     MOVE AM-EXPIRATION-DT       TO  PI-BIN-EXP-DT   (T-INDEX).
  5309     MOVE AM-EFFECTIVE-DT        TO  PI-BIN-EFF-DT   (T-INDEX).
  5310     MOVE AM-LAST-MAINT-DT       TO  PI-BIN-MAINT-DT (T-INDEX).
  5311     MOVE AM-HI-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  5312     MOVE '3'                    TO  DC-OPTION-CODE.
  5313
  5314     PERFORM 9700-DATE-CONVERSION.
  5315
  5316     IF DATE-CONVERSION-ERROR
  5317         MOVE LOW-VALUES         TO  PI-BIN-HI-CERT (T-INDEX)
  5318     ELSE
  5319         MOVE DC-BIN-DATE-1      TO  PI-BIN-HI-CERT (T-INDEX).
  5320
  5321     MOVE AM-LO-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  5322     MOVE '3'                    TO  DC-OPTION-CODE.
  5323
  5324     PERFORM 9700-DATE-CONVERSION.
  5325
  5326     IF DATE-CONVERSION-ERROR
  5327         MOVE LOW-VALUES         TO  PI-BIN-LO-CERT (T-INDEX)
  5328     ELSE
  5329         MOVE DC-BIN-DATE-1      TO  PI-BIN-LO-CERT (T-INDEX).
  5330
  5331     MOVE AM-AR-HI-CERT-DATE     TO  PI-BIN-AR-HI-CERT (T-INDEX).
  5332     MOVE AM-CONTROL-PRIMARY     TO  TS-ACCT-KEY (TS-INDEX).
  5333
  5334     ADD 1                       TO  PI-TOTAL-LINES.
  5335
  5336     SET T-INDEX
  5337        TS-INDEX  UP  BY  +1.
  5338
  5339     IF T-INDEX  = +33
  5340         GO TO 7000-BUILD-OUTPUT-MAP.
  5341
  5342
  5343 1020-EXIT.
  5344     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 108
* EL650.cbl
  5346 1500-ADD-ACCOUNT.
  5347     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  5348
  5349     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  5350
  5351     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  5352                                     PI-ACCT-REST-OF-EXP.
  5353
  5354     PERFORM 6500-READ-ACCT  THRU  6599-EXIT.
  5355
  5356     IF REC-FOUND
  5357         MOVE -1                 TO  ACARIERL
  5358         MOVE ER-0561            TO  EMI-ERROR
  5359         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5360         GO TO 8200-SEND-DATAONLY.
  5361
  5362     MOVE NEW-KEY-SAVE           TO PI-ACCT-CCGSA-KEY.
  5363
  5364     PERFORM 6000-EDIT-EFFECTIVE-DATE   THRU  6000-EFF-EXIT.
  5365
  5366     PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT.
  5367
  5368     PERFORM 6700-VERIFY-STATE-CARRIER  THRU  6799-EXIT.
  5369
  5370     IF BIN-EXPCHG-SAVE NOT GREATER BIN-EFFCHG-SAVE
  5371         MOVE -1                 TO  EXPCHGL
  5372         MOVE ER-1228            TO  EMI-ERROR
  5373         MOVE AL-UABON           TO  EXPCHGA
  5374         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5375
  5376     IF NOT EMI-NO-ERRORS
  5377         GO TO 8200-SEND-DATAONLY.
  5378
  5379     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  5380
  5381     IF WS-ACCT2-FOUND  = 'Y'
  5382         PERFORM 4200-CHECK-VALIDITY  THRU  4299-EXIT
  5383             VARYING  WS-INDEX  FROM  +1  BY  +1
  5384                UNTIL WS-INDEX GREATER +32.
  5385
  5386     IF NOT EMI-NO-ERRORS
  5387         GO TO 8200-SEND-DATAONLY.
  5388
  5389     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  5390
  5391     MOVE NEW-KEY-SAVE           TO  PI-ACCT-CCGSA-KEY
  5392                                     PI-PREV-ACCOUNT
  5393                                     PI-PREV-VG-ACCOUNT.
  5394     MOVE LOW-VALUES             TO  PI-DATE-RANGE-TABLE
  5395                                     PI-ACCT-REST-OF-EXP.
  5396     MOVE BIN-EXPCHG-SAVE        TO  PI-ACCT-EXP-DT
  5397                                     PI-BIN-EXP-DT (1)
  5398     MOVE BIN-EFFCHG-SAVE        TO  PI-BIN-EFF-DT (1).
  5399     MOVE 1                      TO  PI-TOTAL-LINES
  5400                                     PI-PAGE-NUMBER
  5401                                     PI-LINE-SELECTED.
  5402     MOVE SPACE                  TO  PI-RECORD-ADDED-SW.
  5403     MOVE MAINTI                 TO  PI-MAINT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 109
* EL650.cbl
  5404     MOVE XCTL-6501              TO  PGM-NAME.
  5405
  5406     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 110
* EL650.cbl
  5408 2000-CHANGE-ACCOUNT.
  5409     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5410
  5411     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  5412
  5413     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5414
  5415     IF NOT EMI-NO-ERRORS
  5416         GO TO 8200-SEND-DATAONLY.
  5417
  5418     SET T-INDEX TO LINEI.
  5419
  5420     IF PI-2ND-PAGE
  5421         SET T-INDEX  UP  BY  8
  5422     ELSE
  5423     IF PI-3RD-PAGE
  5424         SET T-INDEX  UP  BY  16
  5425     ELSE
  5426     IF PI-LST-PAGE
  5427         SET T-INDEX  UP  BY  24.
  5428
  5429     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5430     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5431     MOVE MAINTI                   TO  PI-MAINT.
  5432     MOVE XCTL-6501                TO  PGM-NAME.
  5433
  5434     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 111
* EL650.cbl
  5436 2500-DELETE-ACCOUNT.
  5437     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5438
  5439     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  5440
  5441     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5442
  5443     IF NOT EMI-NO-ERRORS
  5444         GO TO 8200-SEND-DATAONLY.
  5445
  5446     SET T-INDEX                 TO  LINEI.
  5447
  5448     IF PI-2ND-PAGE
  5449         SET T-INDEX  UP  BY  8
  5450     ELSE
  5451     IF PI-3RD-PAGE
  5452         SET T-INDEX  UP  BY  16
  5453     ELSE
  5454     IF PI-LST-PAGE
  5455         SET T-INDEX  UP  BY  24.
  5456
  5457     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT
  5458                                       BIN-MAX-DATE.
  5459     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5460     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  BIN-MIN-DATE.
  5461     MOVE '1'                      TO  FROM-WHERE-SW.
  5462
  5463     PERFORM 2550-CHECK-HI-LO-DATES  THRU  2550-EXIT
  5464       VARYING  T-INDEX  FROM  +1  BY  +1
  5465         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  5466
  5467     MOVE SPACE                  TO  FROM-WHERE-SW.
  5468
  5469     IF NOT EMI-NO-ERRORS
  5470         GO TO 8200-SEND-DATAONLY.
  5471
  5472     SET T-INDEX TO LINEI.
  5473
  5474     IF PI-2ND-PAGE
  5475         SET T-INDEX  UP  BY  8
  5476     ELSE
  5477     IF PI-3RD-PAGE
  5478         SET T-INDEX  UP  BY  16
  5479     ELSE
  5480     IF PI-LST-PAGE
  5481         SET T-INDEX  UP  BY  24.
  5482
  5483
  5484* EXEC CICS  READ
  5485*        UPDATE
  5486*        DATASET  (PI-ACCT-ID)
  5487*        SET      (ADDRESS OF ACCOUNT-MASTER)
  5488*        RIDFLD   (PI-ACCT-KEY)
  5489*    END-EXEC.
  5490*    MOVE '&"S        EU         (   #00005412' TO DFHEIV0
  5491     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5492     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5493     MOVE X'2020233030303035343132' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 112
* EL650.cbl
  5494     CALL 'kxdfhei1' USING DFHEIV0,
  5495           PI-ACCT-ID,
  5496           DFHEIV20,
  5497           DFHEIV99,
  5498           PI-ACCT-KEY,
  5499           DFHEIV99,
  5500           DFHEIV99,
  5501           DFHEIV99
  5502     SET ADDRESS OF ACCOUNT-MASTER TO
  5503         DFHEIV20
  5504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5505
  5506
  5507     IF PI-BIN-LO-CERT (T-INDEX)  NOT =  LOW-VALUES  OR
  5508        PI-BIN-HI-CERT (T-INDEX)  NOT =  LOW-VALUES
  5509         MOVE ER-2070            TO  EMI-ERROR
  5510         MOVE -1                 TO  MAINTL
  5511         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5512         GO TO 8200-SEND-DATAONLY.
  5513
  5514     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  5515         MOVE 'N'                TO  PENDING-BUSINESS-SW
  5516     ELSE
  5517         PERFORM 2560-CHECK-PENDING-BUSINESS  THRU  2569-EXIT.
  5518
  5519     IF THERE-IS-PENDING-BUSINESS
  5520         MOVE ER-1612            TO  EMI-ERROR
  5521         MOVE -1                 TO  MAINTL
  5522         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5523         GO TO 8200-SEND-DATAONLY.
  5524
  5525     MOVE AM-CONTROL-PRIMARY     TO  B4-ACCT-KEY.
  5526     MOVE AM-EFFECTIVE-DT        TO  B4-ACCT-EFF-DT.
  5527
  5528     if pi-el650-del-sw = 'Y'
  5529        continue
  5530     else
  5531        move 'Y'                 to pi-el650-del-sw
  5532        move er-1299             to emi-error
  5533        perform 9900-error-format thru 9900-exit
  5534        MOVE 1 TO PI-PAGE-NUMBER
  5535        move spaces              to mainto
  5536        MOVE -1                  TO MAINTL
  5537        GO TO 1000-SHOW-ACCOUNT
  5538     end-if
  5539     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  5540
  5541****** DO NOT DELETE PLAN MASTER RECORDS IF MORE ACCT DATE RANGES
  5542     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  5543         NEXT SENTENCE
  5544     ELSE
  5545         IF PI-TOTAL-LINES  = 1
  5546             PERFORM 4800-DELETE-PLAN-REC   THRU  4899-EXIT
  5547         end-if
  5548     end-if
  5549
  5550     MOVE 'D'                    TO  JP-RECORD-TYPE
  5551     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 113
* EL650.cbl
  5552
  5553
  5554* EXEC CICS  DELETE
  5555*        DATASET  (PI-ACCT-ID)
  5556*    END-EXEC
  5557*    MOVE '&(                    &   #00005465' TO DFHEIV0
  5558     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5559     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5560     MOVE X'2020233030303035343635' TO DFHEIV0(25:11)
  5561     CALL 'kxdfhei1' USING DFHEIV0,
  5562           PI-ACCT-ID,
  5563           DFHEIV99,
  5564           DFHEIV99,
  5565           DFHEIV99,
  5566           DFHEIV99
  5567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5568
  5569     PERFORM 8400-LOG-JOURNAL-RECORD
  5570
  5571     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT
  5572
  5573     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  5574                                     PI-ACCT-REST-OF-EXP
  5575                                     LINEO
  5576     MOVE ER-0000                TO  EMI-ERROR
  5577
  5578     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5579
  5580     IF PI-TOTAL-LINES  = 1
  5581         MOVE LOW-VALUES         TO  PI-DATE-RANGE-TABLE
  5582         MOVE ZEROS              TO  PI-TOTAL-LINES
  5583         MOVE 1                  TO  PI-PAGE-NUMBER
  5584         GO TO 7000-BUILD-OUTPUT-MAP
  5585     end-if
  5586     GO TO 1002-SHOW-NEW-RECORDS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 114
* EL650.cbl
  5588 2550-CHECK-HI-LO-DATES.
  5589     IF FROM-CHANGE
  5590         GO TO 2550-CHECK-CHANGE.
  5591
  5592     IF PI-BIN-LO-CERT (T-INDEX)  =  LOW-VALUES  AND
  5593        PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  5594         GO TO 2550-CHECK-AR-DELETE.
  5595
  5596     IF ((PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-MIN-DATE AND
  5597          PI-BIN-HI-CERT (T-INDEX) LESS BIN-MAX-DATE)
  5598       OR
  5599         (PI-BIN-LO-CERT (T-INDEX) NOT LESS BIN-MIN-DATE AND
  5600          PI-BIN-LO-CERT (T-INDEX) LESS BIN-MAX-DATE))
  5601       AND
  5602            (PI-PROCESSOR-ID  NOT =  'LGXX')
  5603         MOVE ER-2087            TO  EMI-ERROR
  5604         MOVE -1                 TO  MAINTL
  5605         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5606
  5607 2550-CHECK-AR-DELETE.
  5608     IF NOT PI-AR-PROCESSING
  5609         GO TO 2550-EXIT.
  5610
  5611     IF T-INDEX NOT = LINEI
  5612         GO TO 2550-EXIT.
  5613
  5614     IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES OR SPACES
  5615        GO TO 2550-EXIT.
  5616
  5617     MOVE ER-3155                TO  EMI-ERROR
  5618     MOVE -1                     TO  MAINTL
  5619     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5620
  5621 2550-CHECK-CHANGE.
  5622     IF PI-BIN-HI-CERT (T-INDEX)  = LOW-VALUES OR SPACES
  5623         GO TO 2550-CHECK-AR-CHANGE.
  5624
  5625     IF PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-MAX-DATE
  5626         MOVE ER-2113            TO  EMI-ERROR
  5627         MOVE -1                 TO  MAINTL
  5628         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5629
  5630 2550-CHECK-AR-CHANGE.
  5631      IF NOT PI-AR-PROCESSING
  5632          GO TO 2550-EXIT.
  5633
  5634      IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES
  5635          GO TO 2550-EXIT.
  5636
  5637      IF PI-BIN-AR-HI-CERT (T-INDEX) NOT LESS BIN-MAX-DATE
  5638         MOVE ER-3155            TO  EMI-ERROR
  5639         MOVE -1                 TO  MAINTL
  5640         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5641
  5642 2550-EXIT.
  5643     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 115
* EL650.cbl
  5645 2560-CHECK-PENDING-BUSINESS.
  5646     MOVE 'N'                    TO  PENDING-BUSINESS-SW.
  5647     MOVE LOW-VALUES             TO  ERPNDB-KEY
  5648                                     PI-ERPNDB-ALT-KEY.
  5649     MOVE AM-COMPANY-CD-A1       TO  PNDB-COMPANY-CD-A1
  5650                                     PI-PB-COMPANY-CD-A1.
  5651     MOVE AM-VG-CARRIER          TO  PNDB-CARRIER
  5652                                     PI-PB-CARRIER.
  5653     MOVE AM-VG-GROUPING         TO  PNDB-GROUPING
  5654                                     PI-PB-GROUPING.
  5655     MOVE AM-VG-STATE            TO  PNDB-STATE
  5656                                     PI-PB-STATE.
  5657     MOVE AM-VG-ACCOUNT          TO  PNDB-ACCOUNT
  5658                                     PI-PB-ACCOUNT.
  5659
  5660
  5661* EXEC CICS  HANDLE CONDITION
  5662*         NOTFND   (2568-NO-RECORDS)
  5663*         ENDFILE  (2568-NO-RECORDS)
  5664*    END-EXEC.
  5665*    MOVE '"$I''                  ! % #00005560' TO DFHEIV0
  5666     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5667     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5668     MOVE X'2520233030303035353630' TO DFHEIV0(25:11)
  5669     CALL 'kxdfhei1' USING DFHEIV0
  5670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5671
  5672
  5673
  5674* EXEC CICS  STARTBR
  5675*        DATASET  (PEND2-FILE-ID)
  5676*        RIDFLD   (ERPNDB-KEY)
  5677*    END-EXEC.
  5678     MOVE 0
  5679       TO DFHEIV11
  5680*    MOVE '&,         G          &   #00005565' TO DFHEIV0
  5681     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5682     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5683     MOVE X'2020233030303035353635' TO DFHEIV0(25:11)
  5684     CALL 'kxdfhei1' USING DFHEIV0,
  5685           PEND2-FILE-ID,
  5686           ERPNDB-KEY,
  5687           DFHEIV99,
  5688           DFHEIV11,
  5689           DFHEIV99
  5690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5691
  5692
  5693     MOVE 'Y'                    TO  PENDING-BROWSE-SW.
  5694
  5695 2562-READ-NEXT-PENDING.
  5696
  5697* EXEC CICS  READNEXT
  5698*        DATASET  (PEND2-FILE-ID)
  5699*        RIDFLD   (ERPNDB-KEY)
  5700*        SET      (ADDRESS OF PENDING-BUSINESS)
  5701*    END-EXEC.
  5702     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 116
* EL650.cbl
  5703       TO DFHEIV11
  5704*    MOVE '&.S                   )   #00005573' TO DFHEIV0
  5705     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5706     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5707     MOVE X'2020233030303035353733' TO DFHEIV0(25:11)
  5708     CALL 'kxdfhei1' USING DFHEIV0,
  5709           PEND2-FILE-ID,
  5710           DFHEIV20,
  5711           DFHEIV99,
  5712           ERPNDB-KEY,
  5713           DFHEIV99,
  5714           DFHEIV11,
  5715           DFHEIV99,
  5716           DFHEIV99
  5717     SET ADDRESS OF PENDING-BUSINESS TO
  5718         DFHEIV20
  5719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5720
  5721
  5722     IF PB-COMPANY-CD-A1 = PI-PB-COMPANY-CD-A1 AND
  5723        PB-CARRIER       = PI-PB-CARRIER       AND
  5724        PB-GROUPING      = PI-PB-GROUPING      AND
  5725        PB-STATE         = PI-PB-STATE         AND
  5726        PB-ACCOUNT       = PI-PB-ACCOUNT
  5727            NEXT SENTENCE
  5728          ELSE
  5729            GO TO 2568-NO-RECORDS.
  5730
  5731     IF PB-ISSUE
  5732       OR  PB-CANCELLATION
  5733         NEXT SENTENCE
  5734     ELSE
  5735         GO TO 2562-READ-NEXT-PENDING.
  5736
  5737     IF PB-CERT-EFF-DT  IS EQUAL TO  AM-EFFECTIVE-DT
  5738         MOVE 'Y'                TO  PENDING-BUSINESS-SW
  5739         GO TO 2568-NO-RECORDS.
  5740
  5741     IF PB-CERT-EFF-DT  IS GREATER THAN  AM-EFFECTIVE-DT
  5742       AND PB-CERT-EFF-DT  IS LESS THAN  AM-EXPIRATION-DT
  5743         MOVE 'Y'                TO  PENDING-BUSINESS-SW
  5744         GO TO 2568-NO-RECORDS.
  5745
  5746     GO TO 2562-READ-NEXT-PENDING.
  5747
  5748 2568-NO-RECORDS.
  5749     IF PENDING-BROWSE-STARTED
  5750         MOVE ' '                TO  PENDING-BROWSE-SW
  5751
  5752* EXEC CICS ENDBR
  5753*           DATASET  (PEND2-FILE-ID)
  5754*       END-EXEC.
  5755     MOVE 0
  5756       TO DFHEIV11
  5757*    MOVE '&2                    $   #00005608' TO DFHEIV0
  5758     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5759     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5760     MOVE X'2020233030303035363038' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 117
* EL650.cbl
  5761     CALL 'kxdfhei1' USING DFHEIV0,
  5762           PEND2-FILE-ID,
  5763           DFHEIV11,
  5764           DFHEIV99
  5765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5766
  5767
  5768 2569-EXIT.
  5769     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 118
* EL650.cbl
  5771 3000-CHANGE-EXPIRATION.
  5772     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  5773     PERFORM 6200-CHECK-KEY             THRU  6200-EXIT.
  5774     PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT.
  5775     PERFORM 4100-BUILD-VERIFICATION    THRU  4199-EXIT.
  5776
  5777     SET T-INDEX  TO  PI-TOTAL-LINES.
  5778
  5779     PERFORM VARYING WS-INDEX FROM +1 BY +1
  5780             UNTIL  PI-BIN-EXP-DT (T-INDEX)
  5781                        =  WS-ACCT-EXP-DT (WS-INDEX)
  5782                 OR  WS-INDEX GREATER +32
  5783     END-PERFORM.
  5784
  5785     IF PI-BIN-EXP-DT (T-INDEX) = WS-ACCT-EXP-DT (WS-INDEX)
  5786         MOVE BIN-EXPCHG-SAVE    TO  WS-ACCT-EXP-DT (WS-INDEX)
  5787         PERFORM 4300-VERIFY-INTEGRITY THRU 4399-EXIT
  5788             VARYING  WS-INDEX  FROM  +1  BY  +1
  5789               UNTIL  WS-INDEX GREATER +32
  5790     ELSE
  5791         MOVE ER-0453            TO  EMI-ERROR
  5792         MOVE -1                 TO  MAINTL
  5793         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5794
  5795     IF NOT EMI-NO-ERRORS
  5796         GO TO 8200-SEND-DATAONLY.
  5797
  5798     MOVE BIN-EXPCHG-SAVE        TO  BIN-MAX-DATE.
  5799     MOVE '2'                    TO  FROM-WHERE-SW.
  5800
  5801     PERFORM 2550-CHECK-HI-LO-DATES  THRU  2550-EXIT
  5802       VARYING  T-INDEX  FROM  +1  BY  +1
  5803         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  5804
  5805     MOVE SPACE                  TO  FROM-WHERE-SW.
  5806
  5807     IF NOT EMI-NO-ERRORS
  5808         GO TO 8200-SEND-DATAONLY.
  5809
  5810     SET T-INDEX  TO  PI-TOTAL-LINES.
  5811     PERFORM 6010-DATE-CHECK  THRU  6010-EXIT.
  5812
  5813     IF NOT EMI-NO-ERRORS
  5814         GO TO 8200-SEND-DATAONLY.
  5815
  5816     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5817     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5818     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  5819     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  5820
  5821     PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT.
  5822
  5823     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  5824                                     AM-VG-EXPIRATION-DT
  5825                                     PI-BIN-EXP-DT (T-INDEX).
  5826     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  5827                                     PI-BIN-MAINT-DT (T-INDEX).
  5828     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 119
* EL650.cbl
  5829     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  5830
  5831     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  5832
  5833     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  5834
  5835     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  5836
  5837     MOVE SPACES                 TO  EXPCHGI.
  5838     MOVE AL-UANOF               TO  EXPCHGA.
  5839     MOVE ER-0000                TO  EMI-ERROR.
  5840
  5841     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5842
  5843     GO TO 7000-BUILD-OUTPUT-MAP.
  5844
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 120
* EL650.cbl
  5846 3100-DELETE-DATE-RANGE.
  5847
  5848* EXEC CICS GETMAIN
  5849*        LENGTH   (ACCT-REC-LEN)
  5850*        SET      (ADDRESS OF ACCOUNT-MASTER)
  5851*        INITIMG  (GETMAIN-SPACE)
  5852*    END-EXEC.
  5853*    MOVE ',"IL                  $   #00005691' TO DFHEIV0
  5854     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5855     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5856     MOVE X'2020233030303035363931' TO DFHEIV0(25:11)
  5857     CALL 'kxdfhei1' USING DFHEIV0,
  5858           DFHEIV20,
  5859           ACCT-REC-LEN,
  5860           GETMAIN-SPACE
  5861     SET ADDRESS OF ACCOUNT-MASTER TO
  5862         DFHEIV20
  5863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5864
  5865
  5866
  5867* EXEC CICS  HANDLE CONDITION
  5868*        NOTFND   (3175-CONTINUE)
  5869*        ENDFILE  (3175-CONTINUE)
  5870*    END-EXEC.
  5871*    MOVE '"$I''                  ! & #00005697' TO DFHEIV0
  5872     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5874     MOVE X'2620233030303035363937' TO DFHEIV0(25:11)
  5875     CALL 'kxdfhei1' USING DFHEIV0
  5876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5877
  5878
  5879
  5880
  5881* EXEC CICS  READ
  5882*        UPDATE
  5883*        DATASET  (PI-ACCT-ID)
  5884*        INTO     (ACCOUNT-MASTER)
  5885*        RIDFLD   (PI-ACCT-KEY)
  5886*    END-EXEC.
  5887     MOVE LENGTH OF
  5888      ACCOUNT-MASTER
  5889       TO DFHEIV11
  5890*    MOVE '&"IL       EU         (   #00005703' TO DFHEIV0
  5891     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5892     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5893     MOVE X'2020233030303035373033' TO DFHEIV0(25:11)
  5894     CALL 'kxdfhei1' USING DFHEIV0,
  5895           PI-ACCT-ID,
  5896           ACCOUNT-MASTER,
  5897           DFHEIV11,
  5898           PI-ACCT-KEY,
  5899           DFHEIV99,
  5900           DFHEIV99,
  5901           DFHEIV99
  5902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5903
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 121
* EL650.cbl
  5904
  5905     MOVE 'D'                    TO  JP-RECORD-TYPE.
  5906     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  5907     MOVE ACCT-FILE-ID           TO  FILE-ID.
  5908
  5909
  5910* EXEC CICS  DELETE
  5911*        DATASET  (PI-ACCT-ID)
  5912*    END-EXEC.
  5913*    MOVE '&(                    &   #00005714' TO DFHEIV0
  5914     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5915     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5916     MOVE X'2020233030303035373134' TO DFHEIV0(25:11)
  5917     CALL 'kxdfhei1' USING DFHEIV0,
  5918           PI-ACCT-ID,
  5919           DFHEIV99,
  5920           DFHEIV99,
  5921           DFHEIV99,
  5922           DFHEIV99
  5923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5924
  5925
  5926     PERFORM 8400-LOG-JOURNAL-RECORD.
  5927
  5928     GO TO 3199-EXIT.
  5929
  5930 3175-CONTINUE.
  5931     IF BROWSE-STARTED
  5932         PERFORM 6320-ENDBR THRU 6320-EXIT.
  5933
  5934     MOVE ER-0226                TO  EMI-ERROR.
  5935
  5936     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5937
  5938     MOVE -1                     TO  MAINTL.
  5939
  5940     GO TO 8200-SEND-DATAONLY.
  5941
  5942 3199-EXIT.
  5943     EXIT.
  5944
  5945 3200-ADD-DATE-RANGE.
  5946     MOVE 'A'                    TO  JP-RECORD-TYPE.
  5947     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  5948
  5949
  5950* EXEC CICS  WRITE
  5951*        FROM     (ACCOUNT-MASTER)
  5952*        RIDFLD   (AM-CONTROL-PRIMARY)
  5953*        DATASET  (PI-ACCT-ID)
  5954*    END-EXEC.
  5955     MOVE LENGTH OF
  5956      ACCOUNT-MASTER
  5957       TO DFHEIV11
  5958*    MOVE '&$ L                  ''   #00005741' TO DFHEIV0
  5959     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5960     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5961     MOVE X'2020233030303035373431' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 122
* EL650.cbl
  5962     CALL 'kxdfhei1' USING DFHEIV0,
  5963           PI-ACCT-ID,
  5964           ACCOUNT-MASTER,
  5965           DFHEIV11,
  5966           AM-CONTROL-PRIMARY,
  5967           DFHEIV99,
  5968           DFHEIV99
  5969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5970
  5971
  5972     PERFORM 8400-LOG-JOURNAL-RECORD.
  5973
  5974 3299-EXIT.
  5975     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 123
* EL650.cbl
  5977 3500-CHANGE-EFFECTIVE.
  5978     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5979
  5980     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  5981
  5982     PERFORM 6000-EDIT-EFFECTIVE-DATE  THRU  6000-EFF-EXIT.
  5983
  5984     IF NOT EMI-NO-ERRORS
  5985         GO TO 8200-SEND-DATAONLY.
  5986
  5987     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  5988
  5989     SET T-INDEX                 TO  +1.
  5990
  5991     PERFORM VARYING  WS-INDEX  FROM  +1  BY  +1
  5992             UNTIL  PI-BIN-EFF-DT (T-INDEX)
  5993                        =  WS-ACCT-EFF-DT (WS-INDEX)
  5994                 OR  WS-INDEX GREATER +32
  5995     END-PERFORM.
  5996
  5997     IF PI-BIN-EFF-DT (T-INDEX)
  5998                 = WS-ACCT-EFF-DT (WS-INDEX)
  5999         MOVE BIN-EFFCHG-SAVE    TO  WS-ACCT-EFF-DT (WS-INDEX)
  6000         PERFORM 4300-VERIFY-INTEGRITY THRU 4399-EXIT
  6001             VARYING  WS-INDEX  FROM  +1  BY  +1
  6002               UNTIL  WS-INDEX GREATER +32
  6003     ELSE
  6004         MOVE ER-0453            TO  EMI-ERROR
  6005         MOVE -1                 TO  MAINTL
  6006         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6007
  6008     IF NOT EMI-NO-ERRORS
  6009         GO TO 8200-SEND-DATAONLY.
  6010
  6011     SET T-INDEX TO  1.
  6012
  6013     PERFORM 6010-DATE-CHECK  THRU  6010-EXIT.
  6014
  6015     IF NOT EMI-NO-ERRORS
  6016         GO TO 8200-SEND-DATAONLY.
  6017
  6018     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  6019     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  6020     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  6021     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  6022
  6023
  6024* EXEC CICS  READ
  6025*        UPDATE
  6026*        DATASET  (PI-ACCT-ID)
  6027*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6028*        RIDFLD   (PI-ACCT-KEY)
  6029*    END-EXEC.
  6030*    MOVE '&"S        EU         (   #00005798' TO DFHEIV0
  6031     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6032     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6033     MOVE X'2020233030303035373938' TO DFHEIV0(25:11)
  6034     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 124
* EL650.cbl
  6035           PI-ACCT-ID,
  6036           DFHEIV20,
  6037           DFHEIV99,
  6038           PI-ACCT-KEY,
  6039           DFHEIV99,
  6040           DFHEIV99,
  6041           DFHEIV99
  6042     SET ADDRESS OF ACCOUNT-MASTER TO
  6043         DFHEIV20
  6044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6045
  6046
  6047     MOVE 'B'                    TO  JP-RECORD-TYPE.
  6048     MOVE ACCT-FILE-ID           TO  FILE-ID.
  6049     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6050
  6051     PERFORM 8400-LOG-JOURNAL-RECORD.
  6052
  6053     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT
  6054                                     PI-BIN-EFF-DT (T-INDEX).
  6055     MOVE EFFCHG-SAVE            TO  AM-EFFECT-DT.
  6056     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  6057                                     PI-BIN-MAINT-DT (T-INDEX).
  6058     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  6059     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  6060     MOVE 'C'                    TO  JP-RECORD-TYPE.
  6061     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6062
  6063     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  6064
  6065
  6066* EXEC CICS  REWRITE
  6067*        FROM     (ACCOUNT-MASTER)
  6068*        DATASET  (PI-ACCT-ID)
  6069*    END-EXEC.
  6070     MOVE LENGTH OF
  6071      ACCOUNT-MASTER
  6072       TO DFHEIV11
  6073*    MOVE '&& L                  %   #00005823' TO DFHEIV0
  6074     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6075     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6076     MOVE X'2020233030303035383233' TO DFHEIV0(25:11)
  6077     CALL 'kxdfhei1' USING DFHEIV0,
  6078           PI-ACCT-ID,
  6079           ACCOUNT-MASTER,
  6080           DFHEIV11,
  6081           DFHEIV99
  6082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6083
  6084
  6085     PERFORM 8400-LOG-JOURNAL-RECORD.
  6086
  6087     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  6088
  6089     MOVE SPACES                 TO  EFFCHGO.
  6090
  6091     MOVE ZERO                   TO  EFFCHGL
  6092                                     EXPCHGL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 125
* EL650.cbl
  6093
  6094     MOVE AL-UANOF               TO  EFFCHGA.
  6095
  6096     MOVE ER-0000                TO  EMI-ERROR.
  6097
  6098     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6099
  6100     GO TO 7000-BUILD-OUTPUT-MAP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 126
* EL650.cbl
  6102 4000-CHANGE-ALL.
  6103     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  6104
  6105     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  6106
  6107     IF NOT EMI-NO-ERRORS
  6108         GO TO 8200-SEND-DATAONLY.
  6109
  6110     MOVE 1                      TO  PI-LINE-SELECTED.
  6111     MOVE MAINTI                 TO  PI-MAINT.
  6112     MOVE XCTL-6501              TO  PGM-NAME.
  6113
  6114     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 127
* EL650.cbl
  6116 4100-BUILD-VERIFICATION.
  6117     MOVE SPACES                 TO  BROWSE-STARTED-SW.
  6118
  6119     SET WS-INDEX  TO  +1.
  6120
  6121     MOVE 'N'                    TO  WS-ACCT2-FOUND.
  6122     MOVE PI-ACCT-KEY            TO  WS-ACCT-VERIFY-KEY.
  6123     MOVE LOW-VALUES             TO  WS-ACCT-VER-EXP-DT
  6124                                     WS-VERIFY-AREA.
  6125
  6126     IF ST-ACCNT-CNTL  OR
  6127        ACCNT-CNTL
  6128          MOVE SPACES             TO  WS-ACCT-VER-CARR.
  6129
  6130     IF ST-ACCNT-CNTL      OR
  6131        CARR-ST-ACCNT-CNTL OR
  6132        ACCNT-CNTL         OR
  6133        CARR-ACCNT-CNTL
  6134          MOVE SPACES             TO  WS-ACCT-VER-GROUP.
  6135
  6136     IF ACCNT-CNTL OR
  6137        CARR-ACCNT-CNTL
  6138          MOVE SPACES             TO  WS-ACCT-VER-STATE.
  6139
  6140     MOVE WS-ACCT-VERIFY-KEY     TO  WS-SAVE-VERIFY-KEY.
  6141
  6142
  6143* EXEC CICS  HANDLE CONDITION
  6144*        NOTFND   (4175-CONTINUE)
  6145*        ENDFILE  (4175-CONTINUE)
  6146*    END-EXEC.
  6147*    MOVE '"$I''                  ! '' #00005885' TO DFHEIV0
  6148     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6149     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6150     MOVE X'2720233030303035383835' TO DFHEIV0(25:11)
  6151     CALL 'kxdfhei1' USING DFHEIV0
  6152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6153
  6154
  6155
  6156* EXEC CICS  STARTBR
  6157*        DATASET  (ACCT2-FILE-ID)
  6158*        RIDFLD   (WS-ACCT-VERIFY-KEY)
  6159*        GTEQ
  6160*    END-EXEC.
  6161     MOVE 0
  6162       TO DFHEIV11
  6163*    MOVE '&,         G          &   #00005890' TO DFHEIV0
  6164     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6165     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6166     MOVE X'2020233030303035383930' TO DFHEIV0(25:11)
  6167     CALL 'kxdfhei1' USING DFHEIV0,
  6168           ACCT2-FILE-ID,
  6169           WS-ACCT-VERIFY-KEY,
  6170           DFHEIV99,
  6171           DFHEIV11,
  6172           DFHEIV99
  6173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 128
* EL650.cbl
  6174
  6175
  6176     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  6177
  6178 4150-READ-NEXT.
  6179
  6180* EXEC CICS  READNEXT
  6181*        DATASET  (ACCT2-FILE-ID)
  6182*        RIDFLD   (WS-ACCT-VERIFY-KEY)
  6183*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6184*    END-EXEC.
  6185     MOVE 0
  6186       TO DFHEIV11
  6187*    MOVE '&.S                   )   #00005899' TO DFHEIV0
  6188     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6189     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6190     MOVE X'2020233030303035383939' TO DFHEIV0(25:11)
  6191     CALL 'kxdfhei1' USING DFHEIV0,
  6192           ACCT2-FILE-ID,
  6193           DFHEIV20,
  6194           DFHEIV99,
  6195           WS-ACCT-VERIFY-KEY,
  6196           DFHEIV99,
  6197           DFHEIV11,
  6198           DFHEIV99,
  6199           DFHEIV99
  6200     SET ADDRESS OF ACCOUNT-MASTER TO
  6201         DFHEIV20
  6202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6203
  6204
  6205     MOVE AM-CONTROL-BY-VAR-GRP  TO  WS-TEST-KEY.
  6206
  6207     IF WS-TEST-KEY  NOT = WS-SAVE-VERIFY-KEY
  6208         GO TO 4175-CONTINUE.
  6209
  6210     MOVE 'Y'                    TO  WS-ACCT2-FOUND.
  6211     MOVE AM-CONTROL-PRIMARY     TO  WS-ACCT-KEY (WS-INDEX).
  6212     MOVE AM-VG-EXPIRATION-DT    TO  WS-ACCT-EXP-DT (WS-INDEX).
  6213     MOVE AM-EFFECTIVE-DT        TO  WS-ACCT-EFF-DT (WS-INDEX).
  6214     MOVE AM-HI-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  6215     MOVE '3'                    TO  DC-OPTION-CODE.
  6216
  6217     PERFORM 9700-DATE-CONVERSION.
  6218
  6219     IF DATE-CONVERSION-ERROR
  6220         MOVE LOW-VALUES         TO  WS-ACCT-HI-CERT (WS-INDEX)
  6221     ELSE
  6222         MOVE DC-BIN-DATE-1      TO  WS-ACCT-HI-CERT (WS-INDEX).
  6223
  6224     MOVE AM-LO-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  6225     MOVE '3'                    TO  DC-OPTION-CODE.
  6226
  6227     PERFORM 9700-DATE-CONVERSION.
  6228
  6229     IF DATE-CONVERSION-ERROR
  6230         MOVE LOW-VALUES         TO  WS-ACCT-LO-CERT (WS-INDEX)
  6231     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 129
* EL650.cbl
  6232         MOVE DC-BIN-DATE-1      TO  WS-ACCT-LO-CERT (WS-INDEX).
  6233
  6234     SET WS-INDEX  UP  BY  +1.
  6235
  6236     GO TO 4150-READ-NEXT.
  6237
  6238 4175-CONTINUE.
  6239     IF BROWSE-STARTED
  6240
  6241* EXEC CICS  ENDBR
  6242*            DATASET  (ACCT2-FILE-ID)
  6243*        END-EXEC
  6244     MOVE 0
  6245       TO DFHEIV11
  6246*    MOVE '&2                    $   #00005940' TO DFHEIV0
  6247     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6248     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6249     MOVE X'2020233030303035393430' TO DFHEIV0(25:11)
  6250     CALL 'kxdfhei1' USING DFHEIV0,
  6251           ACCT2-FILE-ID,
  6252           DFHEIV11,
  6253           DFHEIV99
  6254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6255         MOVE SPACES             TO  BROWSE-STARTED-SW.
  6256
  6257 4199-EXIT.
  6258     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 130
* EL650.cbl
  6260 4200-CHECK-VALIDITY.
  6261     IF (BIN-EXPCHG-SAVE GREATER
  6262                    WS-ACCT-EFF-DT (WS-INDEX))
  6263       AND  (BIN-EXPCHG-SAVE NOT GREATER
  6264                    WS-ACCT-EXP-DT (WS-INDEX))
  6265         MOVE ER-2051            TO  EMI-ERROR
  6266         MOVE -1                 TO  EXPCHGL
  6267         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6268
  6269     IF BIN-EFFCHG-SAVE NOT LESS WS-ACCT-EFF-DT (WS-INDEX) AND
  6270        BIN-EFFCHG-SAVE LESS     WS-ACCT-EXP-DT (WS-INDEX)
  6271          MOVE ER-2051            TO  EMI-ERROR
  6272          MOVE -1                 TO  EFFCHGL
  6273          PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6274
  6275 4299-EXIT.
  6276     EXIT.
  6277
  6278 4300-VERIFY-INTEGRITY.
  6279     IF WS-ACCT-EFF-DT (WS-INDEX + 1)  = LOW-VALUES
  6280         SET WS-INDEX  TO  +32
  6281         GO TO 4399-EXIT.
  6282
  6283     IF (WS-ACCT-EXP-DT (WS-INDEX)  =  BIN-EXPCHG-SAVE)  OR
  6284        (WS-ACCT-EFF-DT (WS-INDEX + 1)  =  BIN-EFFCHG-SAVE)
  6285         SET WS-INDEX  TO  +33
  6286         GO TO 4399-EXIT.
  6287
  6288     IF (WS-ACCT-EXP-DT (WS-INDEX) NOT GREATER
  6289                    WS-ACCT-EFF-DT (WS-INDEX + 1))
  6290       AND  (WS-ACCT-EXP-DT (WS-INDEX) GREATER
  6291                    WS-ACCT-EFF-DT (WS-INDEX))
  6292         GO TO 4399-EXIT.
  6293
  6294     MOVE ER-2051                TO  EMI-ERROR.
  6295     MOVE -1                     TO  EXPCHGL.
  6296
  6297     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6298
  6299 4399-EXIT.
  6300     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 131
* EL650.cbl
  6302 4500-CREATE-NEW-ACCOUNT.
  6303     PERFORM 6100-BUILD-KEY            THRU 6199-EXIT.
  6304
  6305     PERFORM 6700-VERIFY-STATE-CARRIER THRU 6799-EXIT.
  6306
  6307     IF MAINTI = 'T'
  6308         PERFORM 6000-EDIT-EFFECTIVE-DATE THRU 6000-EFF-EXIT.
  6309
  6310     PERFORM 4100-BUILD-VERIFICATION THRU 4199-EXIT.
  6311
  6312     IF WS-ACCT2-FOUND = 'Y'
  6313         MOVE ER-0561            TO  EMI-ERROR
  6314         MOVE -1                 TO  MAINTL
  6315         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6316
  6317     MOVE SPACES                 TO  GETMAIN-SW.
  6318
  6319     IF NOT EMI-NO-ERRORS
  6320         GO TO 8200-SEND-DATAONLY.
  6321
  6322     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  6323         MOVE ER-0453            TO  EMI-ERROR
  6324         MOVE -1                 TO  MAINTL
  6325         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6326         GO TO 8200-SEND-DATAONLY.
  6327
  6328     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  6329
  6330     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6331                                     PI-ACCT-REST-OF-EXP.
  6332
  6333     PERFORM 6500-READ-ACCT  THRU  6599-EXIT.
  6334
  6335     IF REC-FOUND
  6336         MOVE -1                 TO  ACARIERL
  6337         MOVE ER-0561            TO  EMI-ERROR
  6338         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6339         GO TO 8200-SEND-DATAONLY.
  6340
  6341     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  6342     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6343                                     PI-ACCT-REST-OF-EXP.
  6344
  6345
  6346* EXEC CICS  HANDLE CONDITION
  6347*        NOTFND   (4530-NOT-FOUND)
  6348*        ENDFILE  (4530-NOT-FOUND)
  6349*    END-EXEC.
  6350*    MOVE '"$I''                  ! ( #00006033' TO DFHEIV0
  6351     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6352     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6353     MOVE X'2820233030303036303333' TO DFHEIV0(25:11)
  6354     CALL 'kxdfhei1' USING DFHEIV0
  6355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6356
  6357
  6358     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  6359
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 132
* EL650.cbl
  6360 4510-READ-NEXT.
  6361     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  6362
  6363     IF PI-ACCT-CCGSA-KEY  NOT = PI-PREV-ACCOUNT
  6364         GO TO 4540-END-COPY.
  6365
  6366     MOVE AM-EXPIRATION-DT       TO  WS-EXP-SAVE.
  6367     MOVE NEW-KEY-SAVE           TO  AM-CONTROL-PRIMARY.
  6368     MOVE LOW-VALUES             TO  AM-CNTRL-B.
  6369     MOVE WS-EXP-SAVE            TO  AM-EXPIRATION-DT.
  6370
  6371     PERFORM 6400-BUILD-VG-KEY  THRU  6499-EXIT.
  6372
  6373     IF MAINTI  = 'T'
  6374         MOVE '2'                TO  AM-STATUS
  6375         MOVE AM-ACCOUNT         TO  AM-AGT (1)
  6376         MOVE PI-ACCT-CARRIER    TO  AM-TRNFROM-CARRIER
  6377         MOVE PI-ACCT-GROUPING   TO  AM-TRNFROM-GROUPING
  6378         MOVE PI-ACCT-STATE      TO  AM-TRNFROM-STATE
  6379         MOVE PI-ACCT-ACCOUNT    TO  AM-TRNFROM-ACCOUNT
  6380         MOVE BIN-EFFCHG-SAVE    TO  AM-TRNFROM-DTE
  6381     ELSE
  6382         MOVE LOW-VALUES         TO  AM-AR-HI-CERT-DATE
  6383         MOVE ZEROS              TO  AM-HI-CERT-DATE
  6384                                     AM-LO-CERT-DATE
  6385         MOVE SPACES             TO  AM-1ST-PROD-DATE
  6386                                     AM-PREV-DATES
  6387                                     AM-ORIG-DEALER-NO
  6388     END-IF
  6389
  6390     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE.
  6391     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  6392     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  6393     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  6394
  6395     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  6396
  6397     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6398     MOVE 'A'                    TO  JP-RECORD-TYPE.
  6399
  6400     PERFORM 6320-ENDBR THRU 6320-EXIT.
  6401
  6402
  6403* EXEC CICS GETMAIN
  6404*        LENGTH   (ACCT-REC-LEN)
  6405*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6406*        INITIMG  (GETMAIN-SPACE)
  6407*    END-EXEC.
  6408*    MOVE ',"IL                  $   #00006082' TO DFHEIV0
  6409     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6410     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6411     MOVE X'2020233030303036303832' TO DFHEIV0(25:11)
  6412     CALL 'kxdfhei1' USING DFHEIV0,
  6413           DFHEIV20,
  6414           ACCT-REC-LEN,
  6415           GETMAIN-SPACE
  6416     SET ADDRESS OF ACCOUNT-MASTER TO
  6417         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 133
* EL650.cbl
  6418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6419
  6420
  6421     MOVE JP-RECORD-AREA         TO  ACCOUNT-MASTER.
  6422
  6423
  6424* EXEC CICS  WRITE
  6425*        DATASET  (PI-ACCT-ID)
  6426*        RIDFLD   (AM-CONTROL-PRIMARY)
  6427*        FROM     (ACCOUNT-MASTER)
  6428*    END-EXEC.
  6429     MOVE LENGTH OF
  6430      ACCOUNT-MASTER
  6431       TO DFHEIV11
  6432*    MOVE '&$ L                  ''   #00006090' TO DFHEIV0
  6433     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6434     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6435     MOVE X'2020233030303036303930' TO DFHEIV0(25:11)
  6436     CALL 'kxdfhei1' USING DFHEIV0,
  6437           PI-ACCT-ID,
  6438           ACCOUNT-MASTER,
  6439           DFHEIV11,
  6440           AM-CONTROL-PRIMARY,
  6441           DFHEIV99,
  6442           DFHEIV99
  6443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6444
  6445
  6446     MOVE PI-ACCT-ID             TO  FILE-ID.
  6447
  6448     PERFORM 8400-LOG-JOURNAL-RECORD.
  6449
  6450     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  6451     PERFORM 6310-READNEXT THRU 6310-EXIT.
  6452
  6453     GO TO 4510-READ-NEXT.
  6454
  6455 4530-NOT-FOUND.
  6456     IF BROWSE-STARTED
  6457         PERFORM 6320-ENDBR THRU 6320-EXIT.
  6458
  6459     MOVE ER-0226                TO  EMI-ERROR.
  6460
  6461     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6462
  6463     MOVE -1                     TO  MAINTL.
  6464
  6465     GO TO 8200-SEND-DATAONLY.
  6466
  6467 4540-END-COPY.
  6468     IF MAINTI = 'K'
  6469         IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  6470             NEXT SENTENCE
  6471         ELSE
  6472             PERFORM 4600-ADD-ERPLAN-RECORD THRU 4699-EXIT.
  6473
  6474     IF BROWSE-STARTED
  6475         PERFORM 6320-ENDBR THRU 6320-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 134
* EL650.cbl
  6476
  6477     IF MAINTI  NOT = 'T'
  6478         GO TO 4590-SHOW-NEW-ACCOUNT.
  6479
  6480     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  6481     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6482                                     PI-ACCT-REST-OF-EXP.
  6483
  6484     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  6485
  6486 4550-READ-NEXT.
  6487     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  6488
  6489     IF PI-ACCT-CCGSA-KEY  NOT =  PI-PREV-ACCOUNT
  6490         GO TO 4570-END-REWRITE.
  6491
  6492
  6493* EXEC CICS  READ
  6494*        UPDATE
  6495*        DATASET  (PI-ACCT-ID)
  6496*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6497*        RIDFLD   (PI-ACCT-KEY)
  6498*    END-EXEC.
  6499*    MOVE '&"S        EU         (   #00006142' TO DFHEIV0
  6500     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6501     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6502     MOVE X'2020233030303036313432' TO DFHEIV0(25:11)
  6503     CALL 'kxdfhei1' USING DFHEIV0,
  6504           PI-ACCT-ID,
  6505           DFHEIV20,
  6506           DFHEIV99,
  6507           PI-ACCT-KEY,
  6508           DFHEIV99,
  6509           DFHEIV99,
  6510           DFHEIV99
  6511     SET ADDRESS OF ACCOUNT-MASTER TO
  6512         DFHEIV20
  6513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6514
  6515
  6516     MOVE 'B'                    TO  JP-RECORD-TYPE.
  6517     MOVE ACCT-FILE-ID           TO  FILE-ID.
  6518     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6519
  6520     PERFORM 8400-LOG-JOURNAL-RECORD.
  6521
  6522     MOVE NEW-KEY-CNTRL          TO  AM-TRANSFERRED-TO.
  6523     MOVE BIN-EFFCHG-SAVE        TO  AM-TRNTO-DTE.
  6524     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  6525     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  6526     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  6527     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6528     MOVE 'C'                    TO  JP-RECORD-TYPE.
  6529
  6530
  6531* EXEC CICS  REWRITE
  6532*        DATASET  (PI-ACCT-ID)
  6533*        FROM     (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 135
* EL650.cbl
  6534*    END-EXEC.
  6535     MOVE LENGTH OF
  6536      ACCOUNT-MASTER
  6537       TO DFHEIV11
  6538*    MOVE '&& L                  %   #00006163' TO DFHEIV0
  6539     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6540     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6541     MOVE X'2020233030303036313633' TO DFHEIV0(25:11)
  6542     CALL 'kxdfhei1' USING DFHEIV0,
  6543           PI-ACCT-ID,
  6544           ACCOUNT-MASTER,
  6545           DFHEIV11,
  6546           DFHEIV99
  6547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6548
  6549
  6550     MOVE PI-ACCT-ID             TO  FILE-ID.
  6551
  6552     PERFORM 8400-LOG-JOURNAL-RECORD.
  6553
  6554     GO TO 4550-READ-NEXT.
  6555
  6556 4570-END-REWRITE.
  6557     IF BROWSE-STARTED
  6558         PERFORM 6320-ENDBR  THRU  6320-EXIT.
  6559
  6560     MOVE SPACES                 TO  MAINTI
  6561                                     EFFCHGI.
  6562     MOVE AL-UANOF               TO  EFFCHGA.
  6563
  6564 4590-SHOW-NEW-ACCOUNT.
  6565     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  6566
  6567     MOVE NEW-KEY-SAVE           TO  PI-PREV-ACCOUNT
  6568                                     PI-ACCT-CCGSA-KEY.
  6569
  6570     MOVE -1                     TO  MAINTL.
  6571     MOVE ER-0000                TO  EMI-ERROR.
  6572
  6573     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6574
  6575     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT.
  6576
  6577     GO TO 1002-SHOW-NEW-RECORDS.
  6578
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 136
* EL650.cbl
  6580 4600-ADD-ERPLAN-RECORD.
  6581
  6582* EXEC CICS  HANDLE CONDITION
  6583*        NOTFND   (4699-EXIT)
  6584*        ENDFILE  (4689-EOF)
  6585*    END-EXEC.
  6586*    MOVE '"$I''                  ! ) #00006199' TO DFHEIV0
  6587     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6589     MOVE X'2920233030303036313939' TO DFHEIV0(25:11)
  6590     CALL 'kxdfhei1' USING DFHEIV0
  6591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6592
  6593
  6594     MOVE LOW-VALUES            TO WS-PLAN-KEY.
  6595     MOVE PI-PREV-ACCOUNT       TO EK-CCGSA-KEY.
  6596
  6597     PERFORM 4700-STARTBR-PLAN THRU 4700-EXIT.
  6598
  6599 4610-READ-NEXT.
  6600     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6601
  6602     IF EK-CCGSA-KEY NOT = PI-PREV-ACCOUNT
  6603         GO TO 4689-EOF.
  6604
  6605     MOVE NEW-KEY-SAVE           TO  PL-CONTROL-PRIMARY.
  6606
  6607     MOVE EK-BTYPE               TO  PL-BENEFIT-TYPE.
  6608     MOVE EK-BCODE               TO  PL-BENEFIT-CODE.
  6609     MOVE EK-REVISION            TO  PL-REVISION-NO.
  6610
  6611     MOVE PL-CONTROL-PRIMARY     TO  PL-CONTROL-BY-VAR-GRP.
  6612
  6613     MOVE PLAN-MASTER            TO  JP-RECORD-AREA.
  6614
  6615
  6616* EXEC CICS  ENDBR
  6617*        DATASET  (PLAN-FILE-ID)
  6618*    END-EXEC.
  6619     MOVE 0
  6620       TO DFHEIV11
  6621*    MOVE '&2                    $   #00006225' TO DFHEIV0
  6622     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6623     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6624     MOVE X'2020233030303036323235' TO DFHEIV0(25:11)
  6625     CALL 'kxdfhei1' USING DFHEIV0,
  6626           PLAN-FILE-ID,
  6627           DFHEIV11,
  6628           DFHEIV99
  6629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6630
  6631
  6632
  6633* EXEC CICS GETMAIN
  6634*        LENGTH   (PLAN-REC-LEN)
  6635*        SET      (ADDRESS OF PLAN-MASTER)
  6636*        INITIMG  (GETMAIN-SPACE)
  6637*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 137
* EL650.cbl
  6638*    MOVE ',"IL                  $   #00006229' TO DFHEIV0
  6639     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6640     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6641     MOVE X'2020233030303036323239' TO DFHEIV0(25:11)
  6642     CALL 'kxdfhei1' USING DFHEIV0,
  6643           DFHEIV20,
  6644           PLAN-REC-LEN,
  6645           GETMAIN-SPACE
  6646     SET ADDRESS OF PLAN-MASTER TO
  6647         DFHEIV20
  6648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6649
  6650
  6651     MOVE JP-RECORD-AREA         TO PLAN-MASTER.
  6652
  6653
  6654* EXEC CICS  WRITE
  6655*        DATASET  (PLAN-FILE-ID)
  6656*        RIDFLD   (PL-CONTROL-PRIMARY)
  6657*        FROM     (PLAN-MASTER)
  6658*    END-EXEC.
  6659     MOVE LENGTH OF
  6660      PLAN-MASTER
  6661       TO DFHEIV11
  6662*    MOVE '&$ L                  ''   #00006237' TO DFHEIV0
  6663     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6664     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6665     MOVE X'2020233030303036323337' TO DFHEIV0(25:11)
  6666     CALL 'kxdfhei1' USING DFHEIV0,
  6667           PLAN-FILE-ID,
  6668           PLAN-MASTER,
  6669           DFHEIV11,
  6670           PL-CONTROL-PRIMARY,
  6671           DFHEIV99,
  6672           DFHEIV99
  6673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6674
  6675
  6676     PERFORM 4700-STARTBR-PLAN  THRU 4700-EXIT.
  6677     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6678
  6679     GO TO 4610-READ-NEXT.
  6680
  6681 4689-EOF.
  6682
  6683* EXEC CICS  ENDBR
  6684*        DATASET  (PLAN-FILE-ID)
  6685*    END-EXEC.
  6686     MOVE 0
  6687       TO DFHEIV11
  6688*    MOVE '&2                    $   #00006249' TO DFHEIV0
  6689     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6690     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6691     MOVE X'2020233030303036323439' TO DFHEIV0(25:11)
  6692     CALL 'kxdfhei1' USING DFHEIV0,
  6693           PLAN-FILE-ID,
  6694           DFHEIV11,
  6695           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 138
* EL650.cbl
  6696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6697
  6698
  6699 4699-EXIT.
  6700      EXIT.
  6701
  6702 4700-STARTBR-PLAN.
  6703
  6704* EXEC CICS  STARTBR
  6705*        DATASET  (PLAN-FILE-ID)
  6706*        RIDFLD   (WS-PLAN-KEY)
  6707*    END-EXEC.
  6708     MOVE 0
  6709       TO DFHEIV11
  6710*    MOVE '&,         G          &   #00006257' TO DFHEIV0
  6711     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6712     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6713     MOVE X'2020233030303036323537' TO DFHEIV0(25:11)
  6714     CALL 'kxdfhei1' USING DFHEIV0,
  6715           PLAN-FILE-ID,
  6716           WS-PLAN-KEY,
  6717           DFHEIV99,
  6718           DFHEIV11,
  6719           DFHEIV99
  6720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6721
  6722
  6723 4700-EXIT.
  6724      EXIT.
  6725
  6726 4710-READNEXT-PLAN.
  6727
  6728* EXEC CICS  READNEXT
  6729*        DATASET  (PLAN-FILE-ID)
  6730*        SET      (ADDRESS OF PLAN-MASTER)
  6731*        RIDFLD   (WS-PLAN-KEY)
  6732*    END-EXEC.
  6733     MOVE 0
  6734       TO DFHEIV11
  6735*    MOVE '&.S                   )   #00006266' TO DFHEIV0
  6736     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6737     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6738     MOVE X'2020233030303036323636' TO DFHEIV0(25:11)
  6739     CALL 'kxdfhei1' USING DFHEIV0,
  6740           PLAN-FILE-ID,
  6741           DFHEIV20,
  6742           DFHEIV99,
  6743           WS-PLAN-KEY,
  6744           DFHEIV99,
  6745           DFHEIV11,
  6746           DFHEIV99,
  6747           DFHEIV99
  6748     SET ADDRESS OF PLAN-MASTER TO
  6749         DFHEIV20
  6750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6751
  6752
  6753 4710-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 139
* EL650.cbl
  6754      EXIT.
  6755
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 140
* EL650.cbl
  6757 4800-DELETE-PLAN-REC.
  6758
  6759* EXEC CICS  HANDLE CONDITION
  6760*        NOTFND   (4899-EXIT)
  6761*        ENDFILE  (4889-EOF)
  6762*    END-EXEC.
  6763*    MOVE '"$I''                  ! * #00006277' TO DFHEIV0
  6764     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6765     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6766     MOVE X'2A20233030303036323737' TO DFHEIV0(25:11)
  6767     CALL 'kxdfhei1' USING DFHEIV0
  6768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6769
  6770
  6771     MOVE LOW-VALUES            TO WS-PLAN-KEY.
  6772     MOVE AM-CONTROL-PRIMARY    TO EK-CCGSA-KEY
  6773                                   PI-PREV-ACCOUNT.
  6774
  6775 4805-STARTBR.
  6776     PERFORM 4700-STARTBR-PLAN THRU 4700-EXIT.
  6777
  6778 4810-READ-NEXT.
  6779     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6780
  6781     IF EK-CCGSA-KEY NOT = PI-PREV-ACCOUNT
  6782         GO TO 4889-EOF.
  6783
  6784
  6785* EXEC CICS  ENDBR
  6786*        DATASET  (PLAN-FILE-ID)
  6787*    END-EXEC.
  6788     MOVE 0
  6789       TO DFHEIV11
  6790*    MOVE '&2                    $   #00006295' TO DFHEIV0
  6791     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6792     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6793     MOVE X'2020233030303036323935' TO DFHEIV0(25:11)
  6794     CALL 'kxdfhei1' USING DFHEIV0,
  6795           PLAN-FILE-ID,
  6796           DFHEIV11,
  6797           DFHEIV99
  6798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6799
  6800
  6801
  6802* EXEC CICS  READ
  6803*        UPDATE
  6804*        DATASET  (PLAN-FILE-ID)
  6805*        SET      (ADDRESS OF PLAN-MASTER)
  6806*        RIDFLD   (WS-PLAN-KEY)
  6807*    END-EXEC.
  6808*    MOVE '&"S        EU         (   #00006299' TO DFHEIV0
  6809     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6810     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6811     MOVE X'2020233030303036323939' TO DFHEIV0(25:11)
  6812     CALL 'kxdfhei1' USING DFHEIV0,
  6813           PLAN-FILE-ID,
  6814           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 141
* EL650.cbl
  6815           DFHEIV99,
  6816           WS-PLAN-KEY,
  6817           DFHEIV99,
  6818           DFHEIV99,
  6819           DFHEIV99
  6820     SET ADDRESS OF PLAN-MASTER TO
  6821         DFHEIV20
  6822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6823
  6824
  6825
  6826* EXEC CICS  DELETE
  6827*        DATASET  (PLAN-FILE-ID)
  6828*    END-EXEC.
  6829*    MOVE '&(                    &   #00006306' TO DFHEIV0
  6830     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  6831     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6832     MOVE X'2020233030303036333036' TO DFHEIV0(25:11)
  6833     CALL 'kxdfhei1' USING DFHEIV0,
  6834           PLAN-FILE-ID,
  6835           DFHEIV99,
  6836           DFHEIV99,
  6837           DFHEIV99,
  6838           DFHEIV99
  6839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6840
  6841
  6842     GO TO 4805-STARTBR.
  6843
  6844 4889-EOF.
  6845
  6846* EXEC CICS  ENDBR
  6847*        DATASET  (PLAN-FILE-ID)
  6848*    END-EXEC.
  6849     MOVE 0
  6850       TO DFHEIV11
  6851*    MOVE '&2                    $   #00006313' TO DFHEIV0
  6852     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6853     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6854     MOVE X'2020233030303036333133' TO DFHEIV0(25:11)
  6855     CALL 'kxdfhei1' USING DFHEIV0,
  6856           PLAN-FILE-ID,
  6857           DFHEIV11,
  6858           DFHEIV99
  6859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6860
  6861
  6862 4899-EXIT.
  6863      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 142
* EL650.cbl
  6865 4900-CREATE-NEW-ACCOUNT.
  6866     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  6867
  6868     SET T-INDEX                 TO  LINEI.
  6869
  6870     IF PI-2ND-PAGE
  6871         SET T-INDEX  UP  BY  8
  6872     ELSE
  6873     IF PI-3RD-PAGE
  6874         SET T-INDEX  UP  BY  16
  6875     ELSE
  6876     IF PI-LST-PAGE
  6877         SET T-INDEX  UP  BY  24.
  6878
  6879     IF EFFCHGL NOT =  ZERO
  6880         PERFORM 6000-EDIT-EFFECTIVE-DATE   THRU  6000-EFF-EXIT
  6881       ELSE
  6882         MOVE PI-BIN-EFF-DT (T-INDEX)  TO  BIN-EFFCHG-SAVE.
  6883
  6884     IF EXPCHGL NOT =  ZERO
  6885         PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT
  6886       ELSE
  6887         MOVE PI-BIN-EXP-DT (T-INDEX)  TO  BIN-EXPCHG-SAVE.
  6888
  6889     PERFORM 6700-VERIFY-STATE-CARRIER  THRU  6799-EXIT.
  6890
  6891     IF BIN-EXPCHG-SAVE NOT GREATER BIN-EFFCHG-SAVE
  6892         MOVE -1                 TO  EXPCHGL
  6893         MOVE ER-1228            TO  EMI-ERROR
  6894         MOVE AL-UABON           TO  EXPCHGA
  6895         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6896
  6897     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  6898
  6899     IF EMI-ERROR  NOT = ZEROS
  6900         GO TO 8200-SEND-DATAONLY.
  6901
  6902     MOVE SPACES                 TO  GETMAIN-SW.
  6903
  6904     IF NOT EMI-NO-ERRORS
  6905         GO TO 8200-SEND-DATAONLY.
  6906
  6907     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  6908         MOVE ER-0453            TO  EMI-ERROR
  6909         MOVE -1                 TO  MAINTL
  6910         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6911         GO TO 8200-SEND-DATAONLY.
  6912
  6913     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  6914
  6915     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  6916
  6917     PERFORM 4200-CHECK-VALIDITY  THRU  4299-EXIT
  6918         VARYING  WS-INDEX  FROM  +1  BY  +1
  6919            UNTIL WS-INDEX GREATER +32.
  6920
  6921     IF NOT EMI-NO-ERRORS
  6922         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 143
* EL650.cbl
  6923
  6924     MOVE PI-PREV-ACCOUNT          TO  PI-ACCT-CCGSA-KEY.
  6925     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  6926     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  6927
  6928     PERFORM 6500-READ-ACCT     THRU  6599-EXIT.
  6929
  6930     MOVE LOW-VALUES             TO  AM-AR-HI-CERT-DATE
  6931     MOVE ZEROS                  TO  AM-HI-CERT-DATE
  6932                                     AM-LO-CERT-DATE
  6933     MOVE ZEROS                  TO  AM-DCC-MAX-MARKETING-FEE
  6934     MOVE SPACES                 TO  AM-1ST-PROD-DATE
  6935                                     AM-PREV-DATES
  6936                                     AM-ORIG-DEALER-NO
  6937
  6938     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE.
  6939     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  6940     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  6941     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  6942
  6943     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  6944
  6945     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6946     MOVE 'A'                    TO  JP-RECORD-TYPE.
  6947
  6948
  6949* EXEC CICS GETMAIN
  6950*        LENGTH   (ACCT-REC-LEN)
  6951*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6952*        INITIMG  (GETMAIN-SPACE)
  6953*    END-EXEC.
  6954*    MOVE ',"IL                  $   #00006403' TO DFHEIV0
  6955     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6956     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6957     MOVE X'2020233030303036343033' TO DFHEIV0(25:11)
  6958     CALL 'kxdfhei1' USING DFHEIV0,
  6959           DFHEIV20,
  6960           ACCT-REC-LEN,
  6961           GETMAIN-SPACE
  6962     SET ADDRESS OF ACCOUNT-MASTER TO
  6963         DFHEIV20
  6964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6965
  6966
  6967     MOVE JP-RECORD-AREA         TO  ACCOUNT-MASTER.
  6968     MOVE NEW-KEY-SAVE           TO  AM-CONTROL-PRIMARY.
  6969     MOVE LOW-VALUES             TO  AM-CNTRL-B.
  6970     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT.
  6971     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  6972                                     AM-VG-EXPIRATION-DT.
  6973
  6974     PERFORM 6400-BUILD-VG-KEY  THRU  6499-EXIT.
  6975
  6976
  6977* EXEC CICS  HANDLE CONDITION
  6978*        DUPREC   (4580-DUPREC)
  6979*        DUPKEY   (4580-DUPREC)
  6980*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 144
* EL650.cbl
  6981*    MOVE '"$%$                  ! + #00006418' TO DFHEIV0
  6982     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  6983     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6984     MOVE X'2B20233030303036343138' TO DFHEIV0(25:11)
  6985     CALL 'kxdfhei1' USING DFHEIV0
  6986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6987
  6988
  6989
  6990* EXEC CICS  WRITE
  6991*        DATASET  (PI-ACCT-ID)
  6992*        RIDFLD   (AM-CONTROL-PRIMARY)
  6993*        FROM     (ACCOUNT-MASTER)
  6994*    END-EXEC.
  6995     MOVE LENGTH OF
  6996      ACCOUNT-MASTER
  6997       TO DFHEIV11
  6998*    MOVE '&$ L                  ''   #00006423' TO DFHEIV0
  6999     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7000     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7001     MOVE X'2020233030303036343233' TO DFHEIV0(25:11)
  7002     CALL 'kxdfhei1' USING DFHEIV0,
  7003           PI-ACCT-ID,
  7004           ACCOUNT-MASTER,
  7005           DFHEIV11,
  7006           AM-CONTROL-PRIMARY,
  7007           DFHEIV99,
  7008           DFHEIV99
  7009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7010
  7011
  7012     MOVE PI-ACCT-ID             TO  FILE-ID.
  7013
  7014     PERFORM 8400-LOG-JOURNAL-RECORD.
  7015
  7016     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7017         NEXT SENTENCE
  7018     ELSE
  7019         PERFORM 4950-ADD-ERPLAN-RECORD THRU 4959-EXIT
  7020         PERFORM 4960-ADD-ERCOMP-RECORD THRU 4969-EXIT.
  7021
  7022 4580-DUPREC.
  7023     MOVE 1                  TO K-WITH-LINE-USED.
  7024     MOVE LOW-VALUES         TO EL650AI.
  7025
  7026     GO TO 4590-SHOW-NEW-ACCOUNT.
  7027
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 145
* EL650.cbl
  7029 4950-ADD-ERPLAN-RECORD.
  7030
  7031* EXEC CICS GETMAIN
  7032*        LENGTH   (PLAN-REC-LEN)
  7033*        SET      (ADDRESS OF PLAN-MASTER)
  7034*        INITIMG  (GETMAIN-SPACE)
  7035*    END-EXEC.
  7036*    MOVE ',"IL                  $   #00006447' TO DFHEIV0
  7037     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7038     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7039     MOVE X'2020233030303036343437' TO DFHEIV0(25:11)
  7040     CALL 'kxdfhei1' USING DFHEIV0,
  7041           DFHEIV20,
  7042           PLAN-REC-LEN,
  7043           GETMAIN-SPACE
  7044     SET ADDRESS OF PLAN-MASTER TO
  7045         DFHEIV20
  7046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7047
  7048
  7049
  7050* EXEC CICS  HANDLE CONDITION
  7051*        DUPREC   (4959-EXIT)
  7052*        DUPKEY   (4959-EXIT)
  7053*    END-EXEC.
  7054*    MOVE '"$%$                  ! , #00006453' TO DFHEIV0
  7055     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7056     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7057     MOVE X'2C20233030303036343533' TO DFHEIV0(25:11)
  7058     CALL 'kxdfhei1' USING DFHEIV0
  7059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7060
  7061
  7062     MOVE NEW-KEY-SAVE           TO  PL-CONTROL-PRIMARY.
  7063
  7064     MOVE EK-BTYPE               TO  PL-BENEFIT-TYPE.
  7065     MOVE EK-BCODE               TO  PL-BENEFIT-CODE.
  7066     MOVE EK-REVISION            TO  PL-REVISION-NO.
  7067
  7068     MOVE PL-CONTROL-PRIMARY     TO  PL-CONTROL-BY-VAR-GRP.
  7069
  7070
  7071* EXEC CICS  WRITE
  7072*        DATASET  (PLAN-FILE-ID)
  7073*        RIDFLD   (PL-CONTROL-PRIMARY)
  7074*        FROM     (PLAN-MASTER)
  7075*    END-EXEC.
  7076     MOVE LENGTH OF
  7077      PLAN-MASTER
  7078       TO DFHEIV11
  7079*    MOVE '&$ L                  ''   #00006466' TO DFHEIV0
  7080     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7081     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7082     MOVE X'2020233030303036343636' TO DFHEIV0(25:11)
  7083     CALL 'kxdfhei1' USING DFHEIV0,
  7084           PLAN-FILE-ID,
  7085           PLAN-MASTER,
  7086           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 146
* EL650.cbl
  7087           PL-CONTROL-PRIMARY,
  7088           DFHEIV99,
  7089           DFHEIV99
  7090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7091
  7092
  7093 4959-EXIT.
  7094     EXIT.
  7095
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 147
* EL650.cbl
  7097 4960-ADD-ERCOMP-RECORD.
  7098
  7099* EXEC CICS GETMAIN
  7100*         LENGTH   (COMP-REC-LEN)
  7101*         SET      (ADDRESS OF COMPENSATION-MASTER)
  7102*         INITIMG  (GETMAIN-SPACE)
  7103*    END-EXEC.
  7104*    MOVE ',"IL                  $   #00006477' TO DFHEIV0
  7105     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7106     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7107     MOVE X'2020233030303036343737' TO DFHEIV0(25:11)
  7108     CALL 'kxdfhei1' USING DFHEIV0,
  7109           DFHEIV20,
  7110           COMP-REC-LEN,
  7111           GETMAIN-SPACE
  7112     SET ADDRESS OF COMPENSATION-MASTER TO
  7113         DFHEIV20
  7114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7115
  7116
  7117     MOVE SPACES                 TO COMPENSATION-MASTER.
  7118     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  7119                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  7120                   CO-OV30         CO-OV60      CO-OV90
  7121                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  7122                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  7123                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  7124                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  7125                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  7126                   CO-CURRENT-CUR     CO-CURRENT-OV30
  7127                   CO-CURRENT-OV60    CO-CURRENT-OV90
  7128                   CO-CURRENT-CUR-PMT
  7129                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  7130                   CO-ACT-YEAR        CO-ACT-MONTH
  7131                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  7132                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  7133                   CO-CURRENT-LAST-STMT-YEAR
  7134                   CO-CURRENT-LAST-STMT-MONTH
  7135                   CO-CURRENT-LAST-STMT-DAY
  7136                   CO-YTD-PAID-COM
  7137                   CO-YTD-PAID-OV.
  7138
  7139     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  7140     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  7141     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  7142     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  7143     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  7144
  7145     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  7146         MOVE ZEROS              TO CO-CARRIER
  7147     ELSE
  7148         MOVE AM-CARRIER         TO CO-CARRIER.
  7149
  7150     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  7151         MOVE ZEROS              TO CO-GROUPING
  7152     ELSE
  7153         MOVE AM-GROUPING        TO CO-GROUPING.
  7154
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 148
* EL650.cbl
  7155     MOVE 'A'                    TO CO-TYPE.
  7156     MOVE AM-NAME                TO CO-ACCT-NAME.
  7157     MOVE AM-PERSON              TO CO-MAIL-NAME.
  7158     MOVE AM-ADDRS               TO CO-ADDR-1.
  7159*    MOVE AM-CITY                TO CO-ADDR-3.
  7160     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  7161     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  7162     MOVE AM-ZIP                 TO CO-ZIP.
  7163     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  7164     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  7165     MOVE AM-ID-NO               TO CO-SOC-SEC.
  7166
  7167     IF AM-REMIT-TO NOT = ZERO
  7168         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  7169       ELSE
  7170         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  7171
  7172     MOVE +0                      TO AGT-SUB.
  7173
  7174     PERFORM 4970-FIND-C-AGT THRU 4970-EXIT.
  7175
  7176     IF VALID-AGT-SW = 'Y'
  7177         NEXT SENTENCE
  7178     ELSE
  7179         GO TO 4969-EXIT.
  7180
  7181     IF CO-RESP-NO = CO-ACCOUNT
  7182         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  7183     ELSE
  7184         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  7185
  7186     IF PI-AR-PROCESSING
  7187        MOVE 'G'                   TO CO-AR-REPORTING
  7188        MOVE '1'                   TO CO-AR-BAL-LEVEL
  7189        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  7190        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  7191
  7192     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  7193        MOVE 'N'                   TO CO-AR-REPORTING.
  7194
  7195     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  7196        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  7197
  7198     PERFORM 4980-ADD-COMPENSATION-NAME THRU 4980-EXIT.
  7199
  7200
  7201* EXEC CICS HANDLE CONDITION
  7202*         DUPREC   (4969-EXIT)
  7203*         DUPKEY   (4969-EXIT)
  7204*    END-EXEC.
  7205*    MOVE '"$%$                  ! - #00006566' TO DFHEIV0
  7206     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7207     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7208     MOVE X'2D20233030303036353636' TO DFHEIV0(25:11)
  7209     CALL 'kxdfhei1' USING DFHEIV0
  7210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7211
  7212
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 149
* EL650.cbl
  7213
  7214* EXEC CICS WRITE
  7215*        FROM      (COMPENSATION-MASTER)
  7216*        RIDFLD    (CO-CONTROL-PRIMARY)
  7217*        DATASET   (COMP-FILE-ID)
  7218*    END-EXEC.
  7219     MOVE LENGTH OF
  7220      COMPENSATION-MASTER
  7221       TO DFHEIV11
  7222*    MOVE '&$ L                  ''   #00006571' TO DFHEIV0
  7223     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7224     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7225     MOVE X'2020233030303036353731' TO DFHEIV0(25:11)
  7226     CALL 'kxdfhei1' USING DFHEIV0,
  7227           COMP-FILE-ID,
  7228           COMPENSATION-MASTER,
  7229           DFHEIV11,
  7230           CO-CONTROL-PRIMARY,
  7231           DFHEIV99,
  7232           DFHEIV99
  7233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7234
  7235
  7236 4969-EXIT.
  7237     EXIT.
  7238
  7239 4970-FIND-C-AGT.
  7240     ADD 1 TO  AGT-SUB.
  7241     IF AGT-SUB GREATER 10
  7242         MOVE 'N'                TO  VALID-AGT-SW
  7243         GO TO 4970-EXIT.
  7244
  7245     IF (AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F' OR 'S')
  7246         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  7247         MOVE 'Y'                TO  VALID-AGT-SW
  7248         GO TO 4970-EXIT
  7249     ELSE
  7250         GO TO 4970-FIND-C-AGT.
  7251
  7252 4970-EXIT.
  7253     EXIT.
  7254
  7255 4980-ADD-COMPENSATION-NAME.
  7256
  7257* EXEC CICS HANDLE CONDITION
  7258*         DUPREC   (4980-EXIT)
  7259*    END-EXEC.
  7260*    MOVE '"$%                   ! . #00006597' TO DFHEIV0
  7261     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7263     MOVE X'2E20233030303036353937' TO DFHEIV0(25:11)
  7264     CALL 'kxdfhei1' USING DFHEIV0
  7265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7266
  7267
  7268
  7269* EXEC CICS GETMAIN
  7270*         LENGTH   (NAME-REC-LEN)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 150
* EL650.cbl
  7271*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  7272*         INITIMG  (GETMAIN-SPACE)
  7273*    END-EXEC.
  7274*    MOVE ',"IL                  $   #00006601' TO DFHEIV0
  7275     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7276     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7277     MOVE X'2020233030303036363031' TO DFHEIV0(25:11)
  7278     CALL 'kxdfhei1' USING DFHEIV0,
  7279           DFHEIV20,
  7280           NAME-REC-LEN,
  7281           GETMAIN-SPACE
  7282     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  7283         DFHEIV20
  7284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7285
  7286
  7287     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  7288     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  7289     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  7290     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  7291     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  7292     MOVE CO-ACCT-NAME           TO  NL-NAME.
  7293     MOVE CO-ADDR-CITY           TO  NL-CITY
  7294     MOVE CO-ADDR-STATE          TO  NL-ST
  7295     MOVE 'C'                    TO  NL-RECORD-TYPE.
  7296     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  7297     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  7298     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  7299     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  7300     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  7301     MOVE CO-TYPE                TO  NL-CO-TYPE.
  7302
  7303
  7304* EXEC CICS WRITE
  7305*        FROM      (NAME-LOOKUP-MASTER)
  7306*        RIDFLD    (NL-CONTROL-PRIMARY)
  7307*        DATASET   (NAME-FILE-ID)
  7308*    END-EXEC.
  7309     MOVE LENGTH OF
  7310      NAME-LOOKUP-MASTER
  7311       TO DFHEIV11
  7312*    MOVE '&$ L                  ''   #00006623' TO DFHEIV0
  7313     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7314     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7315     MOVE X'2020233030303036363233' TO DFHEIV0(25:11)
  7316     CALL 'kxdfhei1' USING DFHEIV0,
  7317           NAME-FILE-ID,
  7318           NAME-LOOKUP-MASTER,
  7319           DFHEIV11,
  7320           NL-CONTROL-PRIMARY,
  7321           DFHEIV99,
  7322           DFHEIV99
  7323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7324
  7325
  7326 4980-EXIT.
  7327     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 151
* EL650.cbl
  7329 5000-CREATE-NEW-RANGE.
  7330
  7331     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  7332     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  7333
  7334     PERFORM 6000-EDIT-EFFECTIVE-DATE  THRU 6000-EFF-EXIT.
  7335     PERFORM 6000-EDIT-EXPIRATION-DATE THRU 6000-EXP-EXIT.
  7336
  7337     SET T-INDEX TO PI-TOTAL-LINES.
  7338
  7339     PERFORM 600A-CHECK-HI-LO-DATES    THRU 600A-EXIT
  7340        VARYING T-INDEX FROM T-INDEX BY +1
  7341         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  7342
  7343     IF NOT EMI-NO-ERRORS
  7344         GO TO 8200-SEND-DATAONLY.
  7345
  7346     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7347     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7348
  7349     IF BIN-EFFCHG-SAVE NOT LESS BIN-EXPCHG-SAVE
  7350         MOVE -1                 TO  EFFCHGL EXPCHGL
  7351         MOVE AL-UANON           TO  EFFCHGA EXPCHGA
  7352         MOVE ER-2053            TO  EMI-ERROR
  7353         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7354
  7355     IF NOT EMI-NO-ERRORS
  7356         GO TO 8200-SEND-DATAONLY.
  7357
  7358***************************************************************
  7359*    NO EFFECTIVE DATE ENTERED, WILL USE CURRENT EXPIRATION   *
  7360*    DATE IF WITHIN LIMITS                                    *
  7361***************************************************************
  7362
  7363     IF EFFCHGL = ZERO
  7364         SET T-INDEX             TO  PI-TOTAL-LINES
  7365         IF PI-BIN-EXP-DT (T-INDEX)  =  HIGH-VALUES
  7366             MOVE ER-2060        TO  EMI-ERROR
  7367             MOVE -1             TO  EFFCHGL
  7368             MOVE AL-UABON       TO  EFFCHGA
  7369             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7370             GO TO 8200-SEND-DATAONLY
  7371         ELSE
  7372             IF PI-BIN-EXP-DT (T-INDEX) NOT LESS
  7373                    BIN-EXPCHG-SAVE
  7374                 MOVE ER-2061    TO  EMI-ERROR
  7375                 MOVE -1         TO  EXPCHGL
  7376                 MOVE AL-UABON   TO  EXPCHGA
  7377                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7378                 GO TO 8200-SEND-DATAONLY.
  7379
  7380     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  7381
  7382     IF EFFCHGL = ZERO
  7383         MOVE PI-BIN-EXP-DT (T-INDEX)
  7384                                 TO WS-ACCT-EFF-DT (WS-INDEX)
  7385         MOVE BIN-EXPCHG-SAVE    TO WS-ACCT-EXP-DT (WS-INDEX)
  7386     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 152
* EL650.cbl
  7387         MOVE BIN-EFFCHG-SAVE    TO WS-ACCT-EFF-DT (WS-INDEX)
  7388                                    WS-ACCT-EXP-DT (WS-INDEX - 1)
  7389         MOVE BIN-EXPCHG-SAVE    TO WS-ACCT-EXP-DT (WS-INDEX).
  7390
  7391     PERFORM 4300-VERIFY-INTEGRITY  THRU  4399-EXIT
  7392         VARYING  WS-INDEX  FROM  +1  BY  +1
  7393           UNTIL  WS-INDEX  GREATER +32.
  7394
  7395     IF NOT EMI-NO-ERRORS
  7396         GO TO 8200-SEND-DATAONLY.
  7397
  7398     IF EFFCHGL  =  ZEROS
  7399         MOVE PI-BIN-EXP-DT (T-INDEX)
  7400                                  TO  PI-ACCT-EXP-DT
  7401                                      BIN-EFFCHG-SAVE
  7402                                      DC-BIN-DATE-1
  7403         MOVE SPACE               TO  DC-OPTION-CODE
  7404         PERFORM 9700-DATE-CONVERSION
  7405***  Y2K PROJ 7744
  7406         MOVE DC-GREG-DATE-1-YMD  TO  WS-EFFCHG-SAVE
  7407         MOVE DC-ALPHA-CENTURY    TO  WS-EFFCHG-SAVE(4:2)
  7408         MOVE WS-EFFCHG-SAVE      TO  EFFCHG-SAVE
  7409
  7410         PERFORM 5020-READ-PREV-REC
  7411         PERFORM 5050-CREATE-NEW-REC  THRU  5050-EXIT
  7412         GO TO 5005-EXIT
  7413     END-IF.
  7414***  Y2K PROJ 7744
  7415
  7416     IF NOT EMI-NO-ERRORS
  7417         GO TO 8200-SEND-DATAONLY.
  7418
  7419     SET T-INDEX  TO  PI-TOTAL-LINES.
  7420
  7421*    IF (EFFCHGL GREATER THAN +0) AND
  7422*       (EXPCHGL GREATER THAN +0)
  7423*       IF (PI-BIN-EXP-DT (T-INDEX) EQUAL HIGH-VALUES) AND
  7424*          (BIN-EXPCHG-SAVE EQUAL HIGH-VALUES)
  7425*          NEXT SENTENCE
  7426*       ELSE
  7427*          GO TO 5006-FIND-EXP-DATE.
  7428*
  7429
  7430
  7431***************************************************************
  7432*    EFFECTIVE DATE ENTERED, WILL REPLACE CURRENT EXPIRATION  *
  7433*    DATE IF ALL NINES AND CREATE NEW RANGE                   *
  7434***************************************************************
  7435     SET T-INDEX  TO  PI-TOTAL-LINES.
  7436
  7437     IF BROWSE-STARTED-SW EQUAL 'Y'
  7438        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7439
  7440     IF PI-BIN-EXP-DT (T-INDEX)  = HIGH-VALUES
  7441         IF PI-BIN-EFF-DT (T-INDEX) NOT LESS BIN-EFFCHG-SAVE
  7442             MOVE ER-2063             TO  EMI-ERROR
  7443             MOVE -1                  TO  EFFCHGL
  7444             MOVE AL-UABON            TO  EFFCHGA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 153
* EL650.cbl
  7445             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7446             GO TO 8200-SEND-DATAONLY
  7447         ELSE
  7448             MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT
  7449             MOVE LOW-VALUES              TO  PI-ACCT-REST-OF-EXP
  7450             MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  7451             MOVE PI-BIN-EFF-DT (T-INDEX)
  7452                                      TO  B4-ACCT-EFF-DT
  7453             PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  7454             MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  7455                                          AM-VG-EXPIRATION-DT
  7456                                          PI-BIN-EXP-DT
  7457                                                    (T-INDEX)
  7458             MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  7459             MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  7460             PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  7461             PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  7462             PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  7463             GO TO 5005-EXIT.
  7464
  7465***************************************************************
  7466*    EFFECTIVE DATE ENTERED, CHECK TO ENSURE EFFECTIVE        *
  7467*    DATE GREATER PREVIOUS EXPIRATION DATE                    *
  7468***************************************************************
  7469     SET T-INDEX  TO  PI-TOTAL-LINES.
  7470
  7471     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7472     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7473
  7474     IF BIN-EFFCHG-SAVE LESS PI-BIN-EXP-DT (T-INDEX)
  7475         PERFORM 5010-CHECK-VALID-NEW-RANGE  THRU  5010-EXIT
  7476     ELSE
  7477         PERFORM 5020-READ-PREV-REC
  7478         PERFORM 5050-CREATE-NEW-REC  THRU  5050-EXIT.
  7479
  7480 5005-EXIT.
  7481     MOVE SPACES                 TO  EFFCHGO
  7482                                     EXPCHGI.
  7483     MOVE AL-UANOF               TO  EFFCHGA
  7484                                     EXPCHGA.
  7485     MOVE ER-0000                TO  EMI-ERROR.
  7486
  7487     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7488
  7489     GO TO 7000-BUILD-OUTPUT-MAP.
  7490
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 154
* EL650.cbl
  7492 5006-FIND-EXP-DATE.
  7493     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  7494                                     PI-ACCT-REST-OF-EXP.
  7495     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  7496
  7497     PERFORM 6310-READNEXT  THRU  6310-EXIT
  7498         VARYING  T-INDEX  FROM  +1  BY  +1
  7499           UNTIL  PI-BIN-EXP-DT (T-INDEX)  > BIN-EFFCHG-SAVE.
  7500
  7501     IF BIN-EFFCHG-SAVE > PI-BIN-EXP-DT (T-INDEX)
  7502        MOVE ER-1220             TO  EMI-ERROR
  7503        MOVE -1                  TO  EFFCHGL
  7504        MOVE AL-UABON            TO  EFFCHGA
  7505        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7506        GO TO         8200-SEND-DATAONLY.
  7507
  7508     IF (BIN-EFFCHG-SAVE > PI-BIN-EFF-DT (T-INDEX)) AND
  7509        (BIN-EXPCHG-SAVE < PI-BIN-EXP-DT (T-INDEX))
  7510        PERFORM 5007-CREATE-SUB-DATE-RANGES THRU 5007-EXIT
  7511        MOVE 1 TO PI-PAGE-NUMBER
  7512        GO TO 1000-SHOW-ACCOUNT
  7513     ELSE
  7514     IF (BIN-EFFCHG-SAVE = PI-BIN-EFF-DT (T-INDEX)) AND
  7515        (BIN-EXPCHG-SAVE < PI-BIN-EXP-DT (T-INDEX))
  7516        PERFORM 5008-CREATE-SUB-DATE-RANGES THRU 5008-EXIT
  7517        MOVE 1 TO PI-PAGE-NUMBER
  7518        GO TO 1000-SHOW-ACCOUNT
  7519     ELSE
  7520        MOVE ER-2051             TO  EMI-ERROR
  7521        MOVE -1                  TO  EFFCHGL
  7522        MOVE AL-UABON            TO  EFFCHGA
  7523        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7524        GO TO 8200-SEND-DATAONLY.
  7525
  7526 5006-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 155
* EL650.cbl
  7528 5007-CREATE-SUB-DATE-RANGES.
  7529
  7530     IF BROWSE-STARTED-SW EQUAL 'Y'
  7531        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7532
  7533     IF NOT SYSTEM-MODIFY-CAP
  7534         MOVE 'UPDATE'           TO  SM-READ
  7535         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  7536         MOVE ER-0070            TO  EMI-ERROR
  7537         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7538         GO TO 8100-SEND-INITIAL-MAP.
  7539
  7540
  7541* EXEC CICS GETMAIN
  7542*        LENGTH   (ACCT-REC-LEN)
  7543*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7544*        INITIMG  (GETMAIN-SPACE)
  7545*    END-EXEC.
  7546*    MOVE ',"IL                  $   #00006843' TO DFHEIV0
  7547     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7548     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7549     MOVE X'2020233030303036383433' TO DFHEIV0(25:11)
  7550     CALL 'kxdfhei1' USING DFHEIV0,
  7551           DFHEIV20,
  7552           ACCT-REC-LEN,
  7553           GETMAIN-SPACE
  7554     SET ADDRESS OF ACCOUNT-MASTER TO
  7555         DFHEIV20
  7556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7557
  7558
  7559
  7560* EXEC CICS  HANDLE CONDITION
  7561*        ENDFILE  (5007-EXIT)
  7562*        NOTFND   (5007-EXIT)
  7563*    END-EXEC.
  7564*    MOVE '"$''I                  ! / #00006849' TO DFHEIV0
  7565     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7566     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7567     MOVE X'2F20233030303036383439' TO DFHEIV0(25:11)
  7568     CALL 'kxdfhei1' USING DFHEIV0
  7569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7570
  7571
  7572     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7573     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7574
  7575
  7576* EXEC CICS  READ
  7577*        UPDATE
  7578*        DATASET  (PI-ACCT-ID)
  7579*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7580*        RIDFLD   (PI-ACCT-KEY)
  7581*    END-EXEC.
  7582*    MOVE '&"S        EU         (   #00006857' TO DFHEIV0
  7583     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7584     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7585     MOVE X'2020233030303036383537' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 156
* EL650.cbl
  7586     CALL 'kxdfhei1' USING DFHEIV0,
  7587           PI-ACCT-ID,
  7588           DFHEIV20,
  7589           DFHEIV99,
  7590           PI-ACCT-KEY,
  7591           DFHEIV99,
  7592           DFHEIV99,
  7593           DFHEIV99
  7594     SET ADDRESS OF ACCOUNT-MASTER TO
  7595         DFHEIV20
  7596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7597
  7598
  7599     MOVE AM-CONTROL-PRIMARY     TO  SAVE-ACCT-KEY.
  7600     MOVE AM-EXPIRATION-DT       TO  SAVE-CURR-EXP-DT.
  7601     MOVE AM-EFFECTIVE-DT        TO  SAVE-CURR-EFF-DT.
  7602     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7603     MOVE AM-EXPIRATION-DT       TO  AF-ACCT-EFF-DT.
  7604     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7605     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7606     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7607     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7608
  7609     MOVE BIN-EXPCHG-SAVE     TO  AM-EFFECTIVE-DT
  7610                                  PI-BIN-EFF-DT (T-INDEX).
  7611
  7612* EXEC CICS  REWRITE
  7613*        FROM     (ACCOUNT-MASTER)
  7614*        DATASET  (PI-ACCT-ID)
  7615*    END-EXEC.
  7616     MOVE LENGTH OF
  7617      ACCOUNT-MASTER
  7618       TO DFHEIV11
  7619*    MOVE '&& L                  %   #00006876' TO DFHEIV0
  7620     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7621     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7622     MOVE X'2020233030303036383736' TO DFHEIV0(25:11)
  7623     CALL 'kxdfhei1' USING DFHEIV0,
  7624           PI-ACCT-ID,
  7625           ACCOUNT-MASTER,
  7626           DFHEIV11,
  7627           DFHEIV99
  7628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7629
  7630
  7631
  7632* EXEC CICS SYNCPOINT
  7633*    END-EXEC.
  7634*    MOVE '6"                    !   #00006881' TO DFHEIV0
  7635     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7636     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7637     MOVE X'2020233030303036383831' TO DFHEIV0(25:11)
  7638     CALL 'kxdfhei1' USING DFHEIV0
  7639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7640
  7641
  7642     PERFORM 8400-LOG-JOURNAL-RECORD.
  7643     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 157
* EL650.cbl
  7644     MOVE SAVE-ACCT-KEY       TO  AM-CONTROL-PRIMARY.
  7645     MOVE LOW-VALUES          TO  AM-CNTRL-B.
  7646     MOVE SAVE-CURR-EFF-DT    TO  PI-BIN-EFF-DT (T-INDEX)
  7647                                  AM-EFFECTIVE-DT.
  7648     MOVE BIN-EFFCHG-SAVE     TO  PI-BIN-EXP-DT (T-INDEX)
  7649                                  AM-EXPIRATION-DT
  7650                                  AM-VG-EXPIRATION-DT.
  7651     MOVE BIN-CURRENT-SAVE    TO  AM-LAST-MAINT-DT
  7652                                  PI-BIN-MAINT-DT (T-INDEX).
  7653     MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY.
  7654     MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT.
  7655     MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE
  7656     MOVE SPACES              TO  AM-1ST-PROD-DATE
  7657                                  AM-PREV-DATES.
  7658     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7659
  7660
  7661* EXEC CICS  HANDLE CONDITION
  7662*        ENDFILE  (5007-EXIT)
  7663*        NOTFND   (5007-EXIT)
  7664*        DUPREC   (5007-EXIT)
  7665*        ILLOGIC  (5007-EXIT)
  7666*        INVREQ   (5007-EXIT)
  7667*    END-EXEC.
  7668*    MOVE '"$''I%38               ! 0 #00006902' TO DFHEIV0
  7669     MOVE X'222427492533382020202020' TO DFHEIV0(1:12)
  7670     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7671     MOVE X'3020233030303036393032' TO DFHEIV0(25:11)
  7672     CALL 'kxdfhei1' USING DFHEIV0
  7673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7674
  7675
  7676     MOVE 'AM'                TO AM-RECORD-ID.
  7677
  7678     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7679     PERFORM 8400-LOG-JOURNAL-RECORD.
  7680     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7681
  7682     MOVE SAVE-ACCT-KEY       TO  AM-CONTROL-PRIMARY.
  7683     MOVE BIN-EFFCHG-SAVE     TO  AM-EFFECTIVE-DT
  7684                                  PI-BIN-EFF-DT (T-INDEX).
  7685     MOVE BIN-EXPCHG-SAVE     TO  PI-BIN-EXP-DT (T-INDEX)
  7686                                  AM-EXPIRATION-DT
  7687                                  AM-VG-EXPIRATION-DT.
  7688     MOVE BIN-CURRENT-SAVE    TO  AM-LAST-MAINT-DT
  7689                                  PI-BIN-MAINT-DT (T-INDEX).
  7690     MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE
  7691     MOVE SPACES              TO  AM-1ST-PROD-DATE
  7692                                  AM-PREV-DATES.
  7693     MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY.
  7694     MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT.
  7695     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7696     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7697     PERFORM 8400-LOG-JOURNAL-RECORD.
  7698     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7699
  7700     MOVE ZERO                TO EFFCHGL
  7701                                 EXPCHGL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 158
* EL650.cbl
  7702
  7703
  7704* EXEC CICS  HANDLE CONDITION
  7705*         NOTFND   (5015-NOT-FOUND)
  7706*         ENDFILE  (5015-NOT-FOUND)
  7707*    END-EXEC.
  7708*    MOVE '"$I''                  ! 1 #00006937' TO DFHEIV0
  7709     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7710     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7711     MOVE X'3120233030303036393337' TO DFHEIV0(25:11)
  7712     CALL 'kxdfhei1' USING DFHEIV0
  7713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7714
  7715
  7716 5007-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 159
* EL650.cbl
  7718 5008-CREATE-SUB-DATE-RANGES.
  7719
  7720     IF BROWSE-STARTED-SW EQUAL 'Y'
  7721        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7722
  7723     IF NOT SYSTEM-MODIFY-CAP
  7724         MOVE 'UPDATE'           TO  SM-READ
  7725         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  7726         MOVE ER-0070            TO  EMI-ERROR
  7727         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7728         GO TO 8100-SEND-INITIAL-MAP.
  7729
  7730     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7731     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7732     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  7733     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  7734
  7735     PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT.
  7736
  7737     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  7738                                     AM-VG-EXPIRATION-DT
  7739                                     PI-BIN-EXP-DT (T-INDEX).
  7740     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7741                                     PI-BIN-MAINT-DT (T-INDEX).
  7742     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7743     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  7744
  7745     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7746
  7747     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7748
  7749     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7750
  7751     IF T-INDEX = PI-TOTAL-LINES
  7752        MOVE ZERO             TO EFFCHGL
  7753                                 EXPCHGL
  7754        GO TO 5008-EXIT.
  7755
  7756     MOVE BIN-EXPCHG-SAVE        TO  PI-ACCT-EXP-DT
  7757     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  7758     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  7759
  7760     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  7761
  7762     PERFORM 6310-READNEXT  THRU  6310-EXIT
  7763         VARYING  T-INDEX  FROM T-INDEX  BY  +1
  7764           UNTIL  PI-BIN-EXP-DT (T-INDEX)  > BIN-EXPCHG-SAVE.
  7765
  7766     IF BROWSE-STARTED-SW EQUAL 'Y'
  7767        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7768
  7769
  7770* EXEC CICS  READ
  7771*        UPDATE
  7772*        DATASET  (PI-ACCT-ID)
  7773*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7774*        RIDFLD   (PI-ACCT-KEY)
  7775*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 160
* EL650.cbl
  7776*    MOVE '&"S        EU         (   #00006995' TO DFHEIV0
  7777     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7778     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7779     MOVE X'2020233030303036393935' TO DFHEIV0(25:11)
  7780     CALL 'kxdfhei1' USING DFHEIV0,
  7781           PI-ACCT-ID,
  7782           DFHEIV20,
  7783           DFHEIV99,
  7784           PI-ACCT-KEY,
  7785           DFHEIV99,
  7786           DFHEIV99,
  7787           DFHEIV99
  7788     SET ADDRESS OF ACCOUNT-MASTER TO
  7789         DFHEIV20
  7790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7791
  7792
  7793     MOVE 'B'                    TO  JP-RECORD-TYPE.
  7794     MOVE ACCT-FILE-ID           TO  FILE-ID.
  7795     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7796
  7797     PERFORM 8400-LOG-JOURNAL-RECORD.
  7798
  7799     MOVE BIN-EXPCHG-SAVE        TO  AM-EFFECTIVE-DT
  7800                                     PI-BIN-EFF-DT (T-INDEX).
  7801     MOVE EXPCHG-SAVE            TO  AM-EFFECT-DT.
  7802     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7803                                     PI-BIN-MAINT-DT (T-INDEX).
  7804     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7805     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  7806     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7807     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7808
  7809     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7810
  7811
  7812* EXEC CICS  REWRITE
  7813*        FROM     (ACCOUNT-MASTER)
  7814*        DATASET  (PI-ACCT-ID)
  7815*    END-EXEC.
  7816     MOVE LENGTH OF
  7817      ACCOUNT-MASTER
  7818       TO DFHEIV11
  7819*    MOVE '&& L                  %   #00007020' TO DFHEIV0
  7820     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7821     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7822     MOVE X'2020233030303037303230' TO DFHEIV0(25:11)
  7823     CALL 'kxdfhei1' USING DFHEIV0,
  7824           PI-ACCT-ID,
  7825           ACCOUNT-MASTER,
  7826           DFHEIV11,
  7827           DFHEIV99
  7828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7829
  7830
  7831     PERFORM 8400-LOG-JOURNAL-RECORD.
  7832
  7833     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 161
* EL650.cbl
  7834
  7835
  7836
  7837     MOVE ZERO                TO EFFCHGL
  7838                                 EXPCHGL.
  7839
  7840
  7841* EXEC CICS  HANDLE CONDITION
  7842*         NOTFND   (5015-NOT-FOUND)
  7843*         ENDFILE  (5015-NOT-FOUND)
  7844*    END-EXEC.
  7845*    MOVE '"$I''                  ! 2 #00007034' TO DFHEIV0
  7846     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7847     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7848     MOVE X'3220233030303037303334' TO DFHEIV0(25:11)
  7849     CALL 'kxdfhei1' USING DFHEIV0
  7850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7851
  7852
  7853 5008-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 162
* EL650.cbl
  7855 5010-CHECK-VALID-NEW-RANGE.
  7856
  7857***************************************************************
  7858*    THIS PARAGRAPH ALLOWS YOU TO EXPIRE A RANGE PRIOR TO HI  *
  7859*    CERT DATE AS LONG AS A NEW RANGE IS BEING CREATED        *
  7860***************************************************************
  7861
  7862     IF PI-AR-PROCESSING
  7863        GO TO 5010-CHECK-AR-VALID-NEW-RANGE.
  7864
  7865     IF BIN-EXPCHG-SAVE GREATER PI-BIN-EXP-DT (T-INDEX)  AND
  7866                        GREATER BIN-EFFCHG-SAVE          AND
  7867                        GREATER PI-BIN-HI-CERT (T-INDEX)
  7868         MOVE PI-BIN-EXP-DT (T-INDEX)
  7869                                  TO  PI-ACCT-EXP-DT
  7870         MOVE LOW-VALUES          TO  PI-ACCT-REST-OF-EXP
  7871         MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  7872         MOVE PI-BIN-EFF-DT (T-INDEX)
  7873                                  TO  B4-ACCT-EFF-DT
  7874         PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  7875         MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  7876                                      AM-VG-EXPIRATION-DT
  7877                                      PI-BIN-EXP-DT (T-INDEX)
  7878         MOVE BIN-CURRENT-SAVE    TO  PI-BIN-MAINT-DT (T-INDEX)
  7879         MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  7880         MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  7881         PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  7882         PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  7883         PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  7884     ELSE
  7885         MOVE ER-2051             TO  EMI-ERROR
  7886         MOVE -1                  TO  EFFCHGL
  7887         MOVE AL-UABON            TO  EFFCHGA  EXPCHGA
  7888         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7889         GO TO 8200-SEND-DATAONLY.
  7890
  7891     GO TO 5010-EXIT.
  7892
  7893 5010-CHECK-AR-VALID-NEW-RANGE.
  7894
  7895***************************************************************
  7896*    THIS PARAGRAPH ALLOWS YOU TO EXPIRE A RANGE PRIOR TO HI  *
  7897*    A/R CERT DATE AS LONG AS A NEW RANGE IS BEING CREATED    *
  7898***************************************************************
  7899
  7900     IF BIN-EXPCHG-SAVE GREATER PI-BIN-EXP-DT (T-INDEX)  AND
  7901                        GREATER BIN-EFFCHG-SAVE          AND
  7902                        GREATER PI-BIN-AR-HI-CERT (T-INDEX)
  7903         MOVE PI-BIN-EXP-DT (T-INDEX)
  7904                                  TO  PI-ACCT-EXP-DT
  7905         MOVE LOW-VALUES          TO  PI-ACCT-REST-OF-EXP
  7906         MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  7907         MOVE PI-BIN-EFF-DT (T-INDEX)
  7908                                  TO  B4-ACCT-EFF-DT
  7909         PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  7910         MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  7911                                      AM-VG-EXPIRATION-DT
  7912                                      PI-BIN-EXP-DT (T-INDEX)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 163
* EL650.cbl
  7913         MOVE BIN-CURRENT-SAVE    TO  PI-BIN-MAINT-DT (T-INDEX)
  7914         MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  7915         MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  7916         PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  7917         PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  7918         PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  7919     ELSE
  7920         MOVE ER-2051             TO  EMI-ERROR
  7921         MOVE -1                  TO  EFFCHGL
  7922         MOVE AL-UABON            TO  EFFCHGA  EXPCHGA
  7923         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7924         GO TO 8200-SEND-DATAONLY.
  7925
  7926 5010-EXIT.
  7927     EXIT.
  7928
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 164
* EL650.cbl
  7930 5015-NOT-FOUND.
  7931     MOVE ER-0226                TO  EMI-ERROR.
  7932     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7933     MOVE -1                 TO  MAINTL.
  7934     GO TO 8200-SEND-DATAONLY.
  7935
  7936 5015-EXIT.
  7937     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 165
* EL650.cbl
  7939 5020-READ-PREV-REC.
  7940
  7941* EXEC CICS  READ
  7942*        DATASET  (PI-ACCT-ID)
  7943*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7944*        RIDFLD   (PI-ACCT-KEY)
  7945*    END-EXEC.
  7946*    MOVE '&"S        E          (   #00007126' TO DFHEIV0
  7947     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7948     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7949     MOVE X'2020233030303037313236' TO DFHEIV0(25:11)
  7950     CALL 'kxdfhei1' USING DFHEIV0,
  7951           PI-ACCT-ID,
  7952           DFHEIV20,
  7953           DFHEIV99,
  7954           PI-ACCT-KEY,
  7955           DFHEIV99,
  7956           DFHEIV99,
  7957           DFHEIV99
  7958     SET ADDRESS OF ACCOUNT-MASTER TO
  7959         DFHEIV20
  7960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7961
  7962
  7963 5050-CREATE-NEW-REC.
  7964     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT.
  7965     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  7966                                     AM-VG-EXPIRATION-DT.
  7967     MOVE EFFCHG-SAVE            TO  AM-EFFECT-DT.
  7968     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE
  7969                                     AM-1ST-PROD-DATE
  7970                                     AM-PREV-DATES
  7971                                     AM-BILLING-STATUS.
  7972     MOVE ZEROS                  TO  AM-HI-CERT-DATE
  7973                                     AM-LO-CERT-DATE.
  7974
  7975     IF AM-AR-HI-CERT-DATE NOT LESS THAN AM-EFFECTIVE-DT
  7976        NEXT SENTENCE
  7977     ELSE
  7978        MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE.
  7979
  7980     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  7981     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  7982     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  7983
  7984     SET T-INDEX  UP  BY  1.
  7985     IF T-INDEX  GREATER 32
  7986         MOVE ER-2062            TO  EMI-ERROR
  7987         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7988         MOVE -1                 TO  MAINTL
  7989         GO TO 8200-SEND-DATAONLY.
  7990
  7991     ADD 1                       TO  PI-TOTAL-LINES.
  7992
  7993     MOVE LOW-VALUES             TO  PI-TABLE-ENT    (T-INDEX).
  7994     MOVE BIN-EFFCHG-SAVE        TO  PI-BIN-EFF-DT   (T-INDEX).
  7995     MOVE BIN-EXPCHG-SAVE        TO  PI-BIN-EXP-DT   (T-INDEX).
  7996     MOVE AM-AR-HI-CERT-DATE     TO  PI-BIN-AR-HI-CERT (T-INDEX).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 166
* EL650.cbl
  7997     MOVE BIN-CURRENT-SAVE       TO  PI-BIN-MAINT-DT (T-INDEX).
  7998
  7999     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  8000
  8001     MOVE 'A'                    TO  JP-RECORD-TYPE.
  8002     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  8003     MOVE ACCT-FILE-ID           TO  FILE-ID.
  8004
  8005
  8006* EXEC CICS  WRITE
  8007*        RIDFLD   (AM-CONTROL-PRIMARY)
  8008*        FROM     (ACCOUNT-MASTER)
  8009*        DATASET  (PI-ACCT-ID)
  8010*    END-EXEC.
  8011     MOVE LENGTH OF
  8012      ACCOUNT-MASTER
  8013       TO DFHEIV11
  8014*    MOVE '&$ L                  ''   #00007174' TO DFHEIV0
  8015     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8016     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8017     MOVE X'2020233030303037313734' TO DFHEIV0(25:11)
  8018     CALL 'kxdfhei1' USING DFHEIV0,
  8019           PI-ACCT-ID,
  8020           ACCOUNT-MASTER,
  8021           DFHEIV11,
  8022           AM-CONTROL-PRIMARY,
  8023           DFHEIV99,
  8024           DFHEIV99
  8025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8026
  8027
  8028     PERFORM 8400-LOG-JOURNAL-RECORD.
  8029
  8030     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  8031
  8032 5050-EXIT.
  8033     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 167
* EL650.cbl
  8035 5100-FIND-NEXT-RANGE.
  8036     MOVE PI-PREV-VG-ACCOUNT     TO  KEY-SAVE.
  8037
  8038     IF PI-TOTAL-LINES  = ZERO
  8039         GO TO 5210-NO-DATA.
  8040
  8041     IF PI-LST-PAGE
  8042       OR (PI-FST-PAGE AND PI-TOTAL-LINES NOT GREATER 8)
  8043       OR (PI-2ND-PAGE AND PI-TOTAL-LINES NOT GREATER 16)
  8044       OR (PI-3RD-PAGE AND PI-TOTAL-LINES NOT GREATER 24)
  8045         MOVE ER-2065            TO  EMI-ERROR
  8046         MOVE -1                 TO  MAINTL
  8047         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8048         GO TO 8200-SEND-DATAONLY.
  8049
  8050     IF PI-FST-PAGE
  8051         MOVE 2                  TO  PI-PAGE-NUMBER
  8052     ELSE
  8053     IF PI-2ND-PAGE
  8054         MOVE 3                  TO  PI-PAGE-NUMBER
  8055     ELSE
  8056     IF PI-3RD-PAGE
  8057         MOVE 4                  TO  PI-PAGE-NUMBER.
  8058
  8059     GO TO 7000-BUILD-OUTPUT-MAP.
  8060
  8061 5200-FIND-PREV-RANGE.
  8062     MOVE PI-PREV-VG-ACCOUNT     TO  KEY-SAVE.
  8063
  8064     IF PI-TOTAL-LINES  =  ZERO
  8065         GO TO 5210-NO-DATA.
  8066
  8067     IF PI-FST-PAGE
  8068         MOVE ER-2066            TO  EMI-ERROR
  8069         MOVE -1                 TO  MAINTL
  8070         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8071         GO TO 8200-SEND-DATAONLY.
  8072
  8073     IF PI-2ND-PAGE
  8074         MOVE 1                  TO  PI-PAGE-NUMBER
  8075     ELSE
  8076     IF PI-3RD-PAGE
  8077         MOVE 2                  TO  PI-PAGE-NUMBER
  8078     ELSE
  8079     IF PI-LST-PAGE
  8080         MOVE 3                  TO  PI-PAGE-NUMBER.
  8081
  8082     GO TO 7000-BUILD-OUTPUT-MAP.
  8083
  8084 5210-NO-DATA.
  8085     MOVE ER-2069                TO  EMI-ERROR.
  8086     MOVE -1                     TO  MAINTL.
  8087
  8088     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8089
  8090     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 168
* EL650.cbl
  8092 5300-FIND-NEXT-ACCOUNT.
  8093     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8094     MOVE 'Y'                    TO  FIRST-TIME-SW.
  8095
  8096     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8097         MOVE PI-COMPANY-CD      TO  PI-ACCT-CO
  8098     ELSE
  8099         PERFORM 6100-BUILD-KEY  THRU  6199-EXIT
  8100         MOVE HIGH-VALUES        TO  PI-ACCT-EXP-DT
  8101         MOVE LOW-VALUES         TO  PI-ACCT-REST-OF-EXP.
  8102
  8103     IF NOT EMI-NO-ERRORS
  8104         GO TO 8200-SEND-DATAONLY.
  8105
  8106
  8107* EXEC CICS  HANDLE CONDITION
  8108*        NOTFND   (5340-END)
  8109*        ENDFILE  (5330-NOT-FOUND)
  8110*    END-EXEC.
  8111*    MOVE '"$I''                  ! 3 #00007258' TO DFHEIV0
  8112     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8113     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8114     MOVE X'3320233030303037323538' TO DFHEIV0(25:11)
  8115     CALL 'kxdfhei1' USING DFHEIV0
  8116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8117
  8118
  8119 5305-START-BR.
  8120     MOVE ZEROS                  TO  PI-TOTAL-LINES.
  8121
  8122     SET T-INDEX
  8123        TS-INDEX  TO  +1.
  8124
  8125     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  8126
  8127 5310-READ-NEXT.
  8128     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  8129
  8130     IF PI-ACCT-CO  NOT = PI-COMPANY-CD
  8131         GO TO 5330-NOT-FOUND.
  8132
  8133     IF PI-CARRIER-SECURITY GREATER SPACES
  8134         IF PI-ACCT-CARRIER  =  PI-CARRIER-SECURITY
  8135             NEXT SENTENCE
  8136         ELSE
  8137             GO TO 5310-READ-NEXT.
  8138
  8139     IF FIRST-TIME
  8140         IF PI-ACCT-CCGSA-KEY  NOT = KEY-SAVE
  8141             MOVE SPACES             TO  FIRST-TIME-SW
  8142             MOVE PI-ACCT-CCGSA-KEY  TO  KEY-SAVE
  8143                                         PI-PREV-VG-ACCOUNT
  8144         ELSE
  8145             GO TO 5310-READ-NEXT.
  8146
  8147     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  8148         IF PI-COMPANY-CD  = PI-ACCT-CO
  8149             GO TO 5320-DISPLAY-RECORD
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 169
* EL650.cbl
  8150         ELSE
  8151             MOVE ER-0066        TO  EMI-ERROR
  8152             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8153             MOVE -1             TO  MAINTL
  8154             GO TO 8200-SEND-DATAONLY.
  8155
  8156     IF PI-ACCT-CCGSA-KEY  = KEY-SAVE
  8157         GO TO 5320-DISPLAY-RECORD
  8158     ELSE
  8159         MOVE 1                  TO  PI-PAGE-NUMBER
  8160         GO TO 7000-BUILD-OUTPUT-MAP.
  8161
  8162 5320-DISPLAY-RECORD.
  8163     IF T-INDEX  = 1
  8164         MOVE LOW-VALUES         TO  PI-DATE-RANGE-TABLE
  8165         MOVE SPACE              TO  NAMEFLGO
  8166                                     PI-NAMEFLG.
  8167
  8168     IF AM-TRNTO-DTE  =  SPACES
  8169         MOVE LOW-VALUES         TO  AM-TRNTO-DTE.
  8170
  8171     IF AM-TRNFROM-DTE  = SPACES
  8172         MOVE LOW-VALUES         TO  AM-TRNFROM-DTE.
  8173
  8174     IF T-INDEX  = 1
  8175         IF PI-COMPANY-ID  = 'LGX'  OR
  8176                             'MIC'  OR  'MCC'
  8177             MOVE AM-TRANSFERRED-TO  TO  TRNTOO
  8178             MOVE AM-TRNTO-DTE       TO  DC-BIN-DATE-1
  8179             MOVE SPACE              TO  DC-OPTION-CODE
  8180             PERFORM 9700-DATE-CONVERSION
  8181             IF DATE-CONVERSION-ERROR
  8182                 MOVE SPACES         TO  TRNTODTO
  8183             ELSE
  8184                 MOVE DC-GREG-DATE-1-EDIT
  8185                                     TO  TRNTODTO.
  8186
  8187     IF T-INDEX  = 1
  8188         IF PI-COMPANY-ID  =  'LGX'  OR
  8189                              'MIC'  OR  'MCC'
  8190             MOVE AM-TRANSFERRED-FROM  TO  TRNFROMO
  8191             MOVE AM-TRNFROM-DTE       TO  DC-BIN-DATE-1
  8192             MOVE SPACE                TO  DC-OPTION-CODE
  8193             PERFORM 9700-DATE-CONVERSION
  8194             IF DATE-CONVERSION-ERROR
  8195                 MOVE SPACES           TO  TRNFRDTO
  8196             ELSE
  8197                 MOVE DC-GREG-DATE-1-EDIT
  8198                                       TO  TRNFRDTO.
  8199
  8200     IF NAMEO  NOT = LOW-VALUES
  8201         IF AM-NAME  NOT = NAMEO
  8202             MOVE '*'            TO  NAMEFLGO
  8203                                     PI-NAMEFLG.
  8204
  8205     MOVE AM-CONTROL-PRIMARY     TO  PI-PREV-ACCOUNT.
  8206
  8207     IF T-INDEX  = 1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 170
* EL650.cbl
  8208         MOVE AM-NAME                TO  NAMEO
  8209                                         PI-ACCNAME
  8210        ELSE
  8211         MOVE PI-ACCNAME             TO  NAMEO.
  8212
  8213     PERFORM 1020-MOVE-TO-TABLE  THRU  1020-EXIT.
  8214
  8215     GO TO 5310-READ-NEXT.
  8216
  8217 5330-NOT-FOUND.
  8218     IF BROWSE-STARTED
  8219         PERFORM 6320-ENDBR  THRU  6320-EXIT
  8220     ELSE
  8221         GO TO 5340-END.
  8222
  8223     IF PI-ACCT-ACCOUNT  = LOW-VALUE
  8224         MOVE ER-0472            TO  EMI-ERROR
  8225         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8226         MOVE -1                 TO  MAINTL
  8227         GO TO 8200-SEND-DATAONLY.
  8228
  8229     IF PI-ACCT-CCGSA-KEY  =  PI-PREV-ACCOUNT
  8230       AND  T-INDEX  NOT = 1
  8231         MOVE 1                  TO  PI-PAGE-NUMBER
  8232         GO TO 7000-BUILD-OUTPUT-MAP
  8233     ELSE
  8234         IF T-INDEX  NOT = 1
  8235             MOVE ER-0066        TO  EMI-ERROR
  8236             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8237             MOVE 1              TO  PI-PAGE-NUMBER
  8238             GO TO 7000-BUILD-OUTPUT-MAP.
  8239
  8240 5340-END.
  8241     MOVE ER-0066                TO  EMI-ERROR.
  8242
  8243     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8244
  8245     MOVE -1                     TO  MAINTL.
  8246
  8247     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 171
* EL650.cbl
  8249 5400-FIND-PREV-ACCOUNT.
  8250     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8251         GO TO 5430-NOT-FOUND.
  8252
  8253     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8254     MOVE PI-BIN-EXP-DT (1)      TO  PI-ACCT-EXP-DT.
  8255     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  8256
  8257
  8258* EXEC CICS  HANDLE CONDITION
  8259*        NOTFND   (5440-NOT-FOUND)
  8260*        ENDFILE  (5430-NOT-FOUND)
  8261*    END-EXEC.
  8262*    MOVE '"$I''                  ! 4 #00007401' TO DFHEIV0
  8263     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8265     MOVE X'3420233030303037343031' TO DFHEIV0(25:11)
  8266     CALL 'kxdfhei1' USING DFHEIV0
  8267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8268
  8269
  8270
  8271* EXEC CICS  STARTBR
  8272*        DATASET  (PI-ACCT-ID)
  8273*        RIDFLD   (PI-ACCT-KEY)
  8274*    END-EXEC.
  8275     MOVE 0
  8276       TO DFHEIV11
  8277*    MOVE '&,         G          &   #00007406' TO DFHEIV0
  8278     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8279     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8280     MOVE X'2020233030303037343036' TO DFHEIV0(25:11)
  8281     CALL 'kxdfhei1' USING DFHEIV0,
  8282           PI-ACCT-ID,
  8283           PI-ACCT-KEY,
  8284           DFHEIV99,
  8285           DFHEIV11,
  8286           DFHEIV99
  8287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8288
  8289
  8290     MOVE 'Y'                    TO  BROWSE-STARTED-SW
  8291                                     FIRST-TIME-SW.
  8292 5410-READ-PREV.
  8293
  8294* EXEC CICS  READPREV
  8295*        DATASET  (PI-ACCT-ID)
  8296*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8297*        RIDFLD   (PI-ACCT-KEY)
  8298*    END-EXEC.
  8299     MOVE 0
  8300       TO DFHEIV11
  8301*    MOVE '&0S                   )   #00007414' TO DFHEIV0
  8302     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8303     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8304     MOVE X'2020233030303037343134' TO DFHEIV0(25:11)
  8305     CALL 'kxdfhei1' USING DFHEIV0,
  8306           PI-ACCT-ID,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 172
* EL650.cbl
  8307           DFHEIV20,
  8308           DFHEIV99,
  8309           PI-ACCT-KEY,
  8310           DFHEIV99,
  8311           DFHEIV11,
  8312           DFHEIV99,
  8313           DFHEIV99
  8314     SET ADDRESS OF ACCOUNT-MASTER TO
  8315         DFHEIV20
  8316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8317
  8318
  8319     IF FIRST-TIME
  8320         MOVE SPACE              TO  FIRST-TIME-SW
  8321         GO TO 5410-READ-PREV.
  8322
  8323     IF PI-ACCT-CO  NOT = PI-COMPANY-CD
  8324         GO TO 5430-NOT-FOUND.
  8325
  8326     IF PI-CARRIER-SECURITY GREATER SPACES
  8327         IF PI-ACCT-CARRIER  = PI-CARRIER-SECURITY
  8328             NEXT SENTENCE
  8329         ELSE
  8330             GO TO 5410-READ-PREV.
  8331
  8332     MOVE AM-CONTROL-PRIMARY     TO  PI-PREV-ACCOUNT.
  8333     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE
  8334                                     PI-PREV-VG-ACCOUNT.
  8335     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  8336                                     PI-ACCT-REST-OF-EXP
  8337                                     PI-DATE-RANGE-TABLE.
  8338
  8339     MOVE SPACE                  TO  BROWSE-STARTED-SW.
  8340
  8341
  8342* EXEC CICS  ENDBR
  8343*        DATASET  (PI-ACCT-ID)
  8344*    END-EXEC.
  8345     MOVE 0
  8346       TO DFHEIV11
  8347*    MOVE '&2                    $   #00007442' TO DFHEIV0
  8348     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8349     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8350     MOVE X'2020233030303037343432' TO DFHEIV0(25:11)
  8351     CALL 'kxdfhei1' USING DFHEIV0,
  8352           PI-ACCT-ID,
  8353           DFHEIV11,
  8354           DFHEIV99
  8355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8356
  8357
  8358     GO TO 5305-START-BR.
  8359
  8360 5430-NOT-FOUND.
  8361     IF BROWSE-STARTED
  8362         MOVE SPACE              TO  BROWSE-STARTED-SW
  8363
  8364* EXEC CICS  ENDBR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 173
* EL650.cbl
  8365*            DATASET  (PI-ACCT-ID)
  8366*        END-EXEC.
  8367     MOVE 0
  8368       TO DFHEIV11
  8369*    MOVE '&2                    $   #00007451' TO DFHEIV0
  8370     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8371     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8372     MOVE X'2020233030303037343531' TO DFHEIV0(25:11)
  8373     CALL 'kxdfhei1' USING DFHEIV0,
  8374           PI-ACCT-ID,
  8375           DFHEIV11,
  8376           DFHEIV99
  8377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8378
  8379
  8380     MOVE ER-0067                TO  EMI-ERROR.
  8381
  8382     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8383
  8384     MOVE -1                     TO  MAINTL.
  8385
  8386     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8387         GO TO 5300-FIND-NEXT-ACCOUNT.
  8388
  8389     GO TO 8200-SEND-DATAONLY.
  8390
  8391 5440-NOT-FOUND.
  8392     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8393
  8394     PERFORM 6310-READNEXT THRU 6310-EXIT.
  8395
  8396     GO TO 5410-READ-PREV.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 174
* EL650.cbl
  8398 5500-ADD-NEW-AXRF-RECORD.
  8399     IF NOT PI-GA-BILLING
  8400         GO TO 5599-EXIT.
  8401
  8402     MOVE +1                     TO  AXRF-SUB.
  8403
  8404*    IF MAINTI  = 'K'
  8405*        IF GETMAIN-SW  = 'X'
  8406*            GO TO 5510-BUILD-AXRF-KEY.
  8407
  8408     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8409
  8410*    EXEC CICS  GETMAIN
  8411*        LENGTH   (ERGXRF-REC-LEN)
  8412*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  8413*        INITIMG  (GETMAIN-SPACE)
  8414*    END-EXEC.
  8415*    display ' beginning of CP displays  '
  8416*    display ' ergxrf-rec-len  ==   '  ergxrf-rec-len
  8417*    display ' address         ==   '
  8418*              address of agent-cross-reference
  8419*    display ' contents        ==   '  agent-cross-reference (1:1)
  8420*    display ' end       of CP displays  '
  8421
  8422*    MOVE 'X'                    TO  GETMAIN-SW.
  8423
  8424 5510-BUILD-AXRF-KEY.
  8425     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8426
  8427     IF AXRF-SUB  =  +11
  8428         GO TO 5599-EXIT.
  8429
  8430     IF AM-AGT (AXRF-SUB)  =  SPACES  OR ZEROS OR LOW-VALUES
  8431         ADD +1 TO AXRF-SUB
  8432         GO TO 5510-BUILD-AXRF-KEY.
  8433
  8434     IF (AM-COM-TYP (AXRF-SUB)  NOT = 'O' AND 'P'
  8435         AND 'G' AND 'B' AND 'I' AND 'L' AND 'K' AND 'A')
  8436         ADD +1 TO AXRF-SUB
  8437         GO TO 5510-BUILD-AXRF-KEY.
  8438
  8439     MOVE PI-COMPANY-CD          TO  WS-AXRF-COMPANY-CD.
  8440
  8441     IF PI-ZERO-CARRIER  OR
  8442        PI-ZERO-CAR-GROUP
  8443         MOVE ZERO               TO  WS-AXRF-CARRIER
  8444     ELSE
  8445         MOVE AM-CARRIER         TO  WS-AXRF-CARRIER.
  8446
  8447     IF PI-ZERO-GROUPING  OR
  8448        PI-ZERO-CAR-GROUP
  8449         MOVE ZEROS              TO  WS-AXRF-GROUPING
  8450     ELSE
  8451         MOVE AM-GROUPING        TO  WS-AXRF-GROUPING.
  8452
  8453     MOVE AM-AGT (AXRF-SUB)      TO  WS-AXRF-AGENT-NO.
  8454
  8455
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 175
* EL650.cbl
  8456* EXEC CICS  HANDLE CONDITION
  8457*        ENDFILE  (5525-SKIP-REWRITE)
  8458*        NOTFND   (5525-SKIP-REWRITE)
  8459*    END-EXEC.
  8460*    MOVE '"$''I                  ! 5 #00007530' TO DFHEIV0
  8461     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8462     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8463     MOVE X'3520233030303037353330' TO DFHEIV0(25:11)
  8464     CALL 'kxdfhei1' USING DFHEIV0
  8465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8466
  8467
  8468
  8469* EXEC CICS  READ
  8470*        DATASET  (ERGXRF-FILE-ID)
  8471*        LENGTH   (ERGXRF-REC-LEN)
  8472*        INTO     (AGENT-CROSS-REFERENCE)
  8473*        RIDFLD   (WS-AXRF-KEY)
  8474*        EQUAL
  8475*        UPDATE
  8476*    END-EXEC.
  8477*    MOVE '&"IL       EU         (   #00007535' TO DFHEIV0
  8478     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8479     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8480     MOVE X'2020233030303037353335' TO DFHEIV0(25:11)
  8481     CALL 'kxdfhei1' USING DFHEIV0,
  8482           ERGXRF-FILE-ID,
  8483           AGENT-CROSS-REFERENCE,
  8484           ERGXRF-REC-LEN,
  8485           WS-AXRF-KEY,
  8486           DFHEIV99,
  8487           DFHEIV99,
  8488           DFHEIV99
  8489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8490
  8491
  8492     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  8493     MOVE +1                     TO  GX-AGENT-SUB.
  8494
  8495     IF GX-AGENT-POINTER-CNT = +1006
  8496         GO TO 5525-SKIP-REWRITE.
  8497
  8498
  8499 5520-FIND-REC-LOCATION.
  8500     MOVE AM-COMPANY-CD          TO  GX-AM-COMPANY-CD.
  8501     MOVE GX-AGENT-POINTER (GX-AGENT-SUB)
  8502                                 TO  GX-REST-OF-KEY.
  8503     MOVE LOW-VALUES             TO  GX-AM-CNTL-FILLER.
  8504
  8505     IF GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY  OR
  8506        GX-AGENT-SUB          GREATER GX-AGENT-POINTER-CNT
  8507         NEXT SENTENCE
  8508     ELSE
  8509         ADD +1 TO GX-AGENT-SUB
  8510         GO TO 5520-FIND-REC-LOCATION.
  8511
  8512     MOVE GX-AGENT-POINTER-CNT   TO  COMM-WORK-SUB
  8513                                     COMM-WORK-SUB2.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 176
* EL650.cbl
  8514
  8515     ADD +1 TO COMM-WORK-SUB2.
  8516
  8517     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
  8518         NEXT SENTENCE
  8519      ELSE
  8520         PERFORM 5530-BUMP-AXRF-REC
  8521             VARYING  COMM-WORK-SUB  FROM  COMM-WORK-SUB  BY  -1
  8522               UNTIL  COMM-WORK-SUB2 = GX-AGENT-SUB.
  8523
  8524     ADD ERGXRF-INC-LEN TO  ERGXRF-REC-LEN.
  8525     ADD  +1 TO  GX-AGENT-POINTER-CNT.
  8526
  8527     MOVE AM-CARRIER        TO  GX-AM-CARRIER   (COMM-WORK-SUB2).
  8528     MOVE AM-GROUPING       TO  GX-AM-GROUPING  (COMM-WORK-SUB2).
  8529     MOVE AM-STATE          TO  GX-AM-STATE     (COMM-WORK-SUB2).
  8530     MOVE AM-ACCOUNT        TO  GX-AM-ACCOUNT   (COMM-WORK-SUB2).
  8531     MOVE AM-EXPIRATION-DT  TO  GX-AM-EXPIRATION-DT
  8532                                                (COMM-WORK-SUB2).
  8533     MOVE AM-EFFECTIVE-DT   TO  GX-AM-EFF-DT    (COMM-WORK-SUB2).
  8534     MOVE AXRF-SUB          TO  GX-AM-LEVEL-NO  (COMM-WORK-SUB2).
  8535     MOVE LOW-VALUES        TO  GX-LAST-BILL-DT (COMM-WORK-SUB2).
  8536     MOVE BIN-CURRENT-SAVE  TO  GX-LAST-MAINT-DT.
  8537     MOVE EIBTIME           TO  GX-LAST-MAINT-HHMMSS.
  8538     MOVE PI-PROCESSOR-ID   TO  GX-LAST-MAINT-USER.
  8539     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
  8540     if ergxrf-rec-len > +31264
  8541        move +31264          to ergxrf-rec-len
  8542        move +1006           to gx-agent-pointer-cnt
  8543     end-if
  8544
  8545
  8546* EXEC CICS  REWRITE
  8547*        FROM     (AGENT-CROSS-REFERENCE)
  8548*        LENGTH   (ERGXRF-REC-LEN)
  8549*        DATASET  (ERGXRF-FILE-ID)
  8550*    END-EXEC.
  8551*    MOVE '&& L                  %   #00007597' TO DFHEIV0
  8552     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8553     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8554     MOVE X'2020233030303037353937' TO DFHEIV0(25:11)
  8555     CALL 'kxdfhei1' USING DFHEIV0,
  8556           ERGXRF-FILE-ID,
  8557           AGENT-CROSS-REFERENCE,
  8558           ERGXRF-REC-LEN,
  8559           DFHEIV99
  8560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8561
  8562
  8563 5525-SKIP-REWRITE.
  8564
  8565     ADD +1 TO AXRF-SUB.
  8566
  8567     GO TO 5510-BUILD-AXRF-KEY.
  8568
  8569 5530-BUMP-AXRF-REC.
  8570     MOVE GX-AGENT-POINTER (COMM-WORK-SUB)
  8571                          TO  GX-AGENT-POINTER (COMM-WORK-SUB2).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 177
* EL650.cbl
  8572
  8573     SUBTRACT +1  FROM  COMM-WORK-SUB2.
  8574
  8575 5599-EXIT.
  8576     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 178
* EL650.cbl
  8578 5600-CHG-AXRF-RECORDS.
  8579     IF NOT PI-GA-BILLING
  8580         GO TO 5699-EXIT.
  8581
  8582     MOVE +1                     TO  AXRF-SUB.
  8583     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8584
  8585*    IF GETMAIN-SW  = 'X'
  8586*        GO TO 5610-BUILD-AXRF-KEY.
  8587
  8588*    EXEC CICS  GETMAIN
  8589*        LENGTH   (ERGXRF-REC-LEN)
  8590*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  8591*        INITIMG  (GETMAIN-SPACE)
  8592*    END-EXEC.
  8593*
  8594*    display ' beginning of CP displays  '
  8595*    display ' ergxrf-rec-len  ==   '  ergxrf-rec-len
  8596*    display ' address         ==   '
  8597*              address of agent-cross-reference
  8598*    display ' contents        ==   '  agent-cross-reference (1:1)
  8599*    display ' end       of CP displays  '
  8600
  8601*    MOVE 'X'                    TO  GETMAIN-SW.
  8602
  8603 5610-BUILD-AXRF-KEY.
  8604     IF AXRF-SUB  = +11
  8605         GO TO 5699-EXIT.
  8606
  8607     IF AM-AGT (AXRF-SUB)  = SPACES OR ZEROS OR LOW-VALUES
  8608         ADD +1 TO AXRF-SUB
  8609         GO TO 5610-BUILD-AXRF-KEY.
  8610
  8611     IF (AM-COM-TYP (AXRF-SUB)  NOT = 'O'  AND  'P'
  8612         AND 'G' AND 'B' AND 'I' AND 'L' AND 'K' AND 'A')
  8613         ADD +1 TO AXRF-SUB
  8614         GO TO 5610-BUILD-AXRF-KEY.
  8615
  8616     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8617     MOVE PI-COMPANY-CD          TO  WS-AXRF-COMPANY-CD.
  8618
  8619     IF PI-ZERO-CARRIER OR
  8620        PI-ZERO-CAR-GROUP
  8621         MOVE ZERO               TO  WS-AXRF-CARRIER
  8622     ELSE
  8623         MOVE AM-CARRIER         TO  WS-AXRF-CARRIER.
  8624
  8625     IF PI-ZERO-GROUPING  OR
  8626        PI-ZERO-CAR-GROUP
  8627         MOVE ZEROS              TO  WS-AXRF-GROUPING
  8628     ELSE
  8629         MOVE AM-GROUPING        TO  WS-AXRF-GROUPING.
  8630
  8631     MOVE AM-AGT (AXRF-SUB)      TO  WS-AXRF-AGENT-NO.
  8632
  8633
  8634* EXEC CICS  HANDLE CONDITION
  8635*        ENDFILE  (5615-SKIP-REWRITE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 179
* EL650.cbl
  8636*        NOTFND   (5615-SKIP-REWRITE)
  8637*    END-EXEC.
  8638*    MOVE '"$''I                  ! 6 #00007673' TO DFHEIV0
  8639     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8640     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8641     MOVE X'3620233030303037363733' TO DFHEIV0(25:11)
  8642     CALL 'kxdfhei1' USING DFHEIV0
  8643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8644
  8645
  8646
  8647* EXEC CICS  READ
  8648*        DATASET  (ERGXRF-FILE-ID)
  8649*        LENGTH   (ERGXRF-REC-LEN)
  8650*        INTO     (AGENT-CROSS-REFERENCE)
  8651*        RIDFLD   (WS-AXRF-KEY)
  8652*        EQUAL
  8653*        UPDATE
  8654*    END-EXEC.
  8655*    MOVE '&"IL       EU         (   #00007678' TO DFHEIV0
  8656     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8657     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8658     MOVE X'2020233030303037363738' TO DFHEIV0(25:11)
  8659     CALL 'kxdfhei1' USING DFHEIV0,
  8660           ERGXRF-FILE-ID,
  8661           AGENT-CROSS-REFERENCE,
  8662           ERGXRF-REC-LEN,
  8663           WS-AXRF-KEY,
  8664           DFHEIV99,
  8665           DFHEIV99,
  8666           DFHEIV99
  8667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8668
  8669
  8670     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  8671
  8672     PERFORM VARYING GX-AGENT-SUB FROM +1 BY +1
  8673             UNTIL
  8674       (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT)
  8675            OR
  8676       (GX-AM-ACCOUNT       (GX-AGENT-SUB) = B4-ACCT-ACCOUNT  AND
  8677        GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = B4-ACCT-EXP-DT   AND
  8678        GX-AM-EFF-DT        (GX-AGENT-SUB) = B4-ACCT-EFF-DT   AND
  8679        GX-AM-CARRIER       (GX-AGENT-SUB) = B4-ACCT-CARRIER  AND
  8680        GX-AM-GROUPING      (GX-AGENT-SUB) = B4-ACCT-GROUPING AND
  8681        GX-AM-STATE         (GX-AGENT-SUB) = B4-ACCT-STATE)
  8682     END-PERFORM.
  8683
  8684     IF MAINTI  = 'D'
  8685        IF GX-AGENT-SUB NOT GREATER GX-AGENT-POINTER-CNT
  8686            MOVE GX-AGENT-SUB    TO  COMM-WORK-SUB
  8687            PERFORM 5630-BUMP-RECORDS
  8688                VARYING  GX-AGENT-SUB  FROM  GX-AGENT-SUB  BY  +1
  8689                  UNTIL  GX-AGENT-SUB  = GX-AGENT-POINTER-CNT
  8690            SUBTRACT ERGXRF-INC-LEN  FROM  ERGXRF-REC-LEN
  8691            SUBTRACT +1              FROM  GX-AGENT-POINTER-CNT
  8692            GO TO 5615-REWRITE-AXRF-RECORD.
  8693
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 180
* EL650.cbl
  8694     IF GX-AGENT-SUB NOT GREATER GX-AGENT-POINTER-CNT
  8695        MOVE AF-ACCT-EFF-DT  TO GX-AM-EFF-DT        (GX-AGENT-SUB)
  8696        MOVE AF-ACCT-EXP-DT  TO GX-AM-EXPIRATION-DT (GX-AGENT-SUB)
  8697        MOVE AXRF-SUB        TO GX-AM-LEVEL-NO      (GX-AGENT-SUB)
  8698        GO TO 5615-REWRITE-AXRF-RECORD.
  8699
  8700
  8701* EXEC CICS  UNLOCK
  8702*        DATASET  (ERGXRF-FILE-ID)
  8703*    END-EXEC.
  8704*    MOVE '&*                    #   #00007717' TO DFHEIV0
  8705     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8706     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8707     MOVE X'2020233030303037373137' TO DFHEIV0(25:11)
  8708     CALL 'kxdfhei1' USING DFHEIV0,
  8709           ERGXRF-FILE-ID,
  8710           DFHEIV99
  8711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8712
  8713
  8714     GO TO 5615-SKIP-REWRITE.
  8715
  8716 5615-REWRITE-AXRF-RECORD.
  8717     IF MAINTI  = 'D'
  8718       AND  GX-AGENT-POINTER-CNT  =  +0
  8719
  8720* EXEC CICS  DELETE
  8721*            DATASET  (ERGXRF-FILE-ID)
  8722*        END-EXEC
  8723*    MOVE '&(                    &   #00007726' TO DFHEIV0
  8724     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8725     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8726     MOVE X'2020233030303037373236' TO DFHEIV0(25:11)
  8727     CALL 'kxdfhei1' USING DFHEIV0,
  8728           ERGXRF-FILE-ID,
  8729           DFHEIV99,
  8730           DFHEIV99,
  8731           DFHEIV99,
  8732           DFHEIV99
  8733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8734     ELSE
  8735         MOVE BIN-CURRENT-SAVE   TO  GX-LAST-MAINT-DT
  8736         MOVE EIBTIME            TO  GX-LAST-MAINT-HHMMSS
  8737         MOVE PI-PROCESSOR-ID    TO  GX-LAST-MAINT-USER
  8738         compute ergxrf-rec-len =
  8739              (gx-agent-pointer-cnt * +31) + +78
  8740         if ergxrf-rec-len > +31264
  8741            move +31264          to ergxrf-rec-len
  8742            move +1006           to gx-agent-pointer-cnt
  8743         end-if
  8744
  8745* EXEC CICS  REWRITE
  8746*            FROM     (AGENT-CROSS-REFERENCE)
  8747*            LENGTH   (ERGXRF-REC-LEN)
  8748*            DATASET  (ERGXRF-FILE-ID)
  8749*        END-EXEC.
  8750*    MOVE '&& L                  %   #00007739' TO DFHEIV0
  8751     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 181
* EL650.cbl
  8752     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8753     MOVE X'2020233030303037373339' TO DFHEIV0(25:11)
  8754     CALL 'kxdfhei1' USING DFHEIV0,
  8755           ERGXRF-FILE-ID,
  8756           AGENT-CROSS-REFERENCE,
  8757           ERGXRF-REC-LEN,
  8758           DFHEIV99
  8759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8760
  8761
  8762 5615-SKIP-REWRITE.
  8763     ADD +1  TO  AXRF-SUB.
  8764
  8765     GO TO 5610-BUILD-AXRF-KEY.
  8766
  8767 5630-BUMP-RECORDS.
  8768     ADD +1  TO  COMM-WORK-SUB.
  8769
  8770     MOVE GX-AGENT-POINTER (COMM-WORK-SUB)
  8771                            TO  GX-AGENT-POINTER (GX-AGENT-SUB).
  8772
  8773 5699-EXIT.
  8774     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 182
* EL650.cbl
  8776 6000-EDIT-EFFECTIVE-DATE.
  8777     IF EFFCHGL  NOT =  ZEROS
  8778         MOVE EFFCHGI                  TO  WS-DT-DEEDIT-FIELD
  8779         PERFORM 8600-DEEDIT  THRU 8600-EXIT
  8780         MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  8781         MOVE '4'                      TO  DC-OPTION-CODE
  8782         PERFORM 9700-DATE-CONVERSION
  8783         IF DATE-CONVERSION-ERROR
  8784             MOVE ER-0348              TO  EMI-ERROR
  8785             MOVE -1                   TO  EFFCHGL
  8786             MOVE AL-UABON             TO  EFFCHGA
  8787             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8788         ELSE
  8789             MOVE DC-GREG-DATE-1-EDIT  TO  EFFCHGI
  8790             MOVE AL-UANON             TO  EFFCHGA
  8791***  Y2K PROJ 7744
  8792             MOVE DC-GREG-DATE-1-YMD   TO  WS-EFFCHG-SAVE
  8793             MOVE DC-ALPHA-CENTURY     TO  WS-EFFCHG-SAVE(4:2)
  8794             MOVE WS-EFFCHG-SAVE       TO  EFFCHG-SAVE
  8795             MOVE DC-BIN-DATE-1        TO  BIN-EFFCHG-SAVE
  8796         END-IF
  8797***  Y2K PROJ 7744
  8798     ELSE
  8799         IF MAINTI  NOT = 'N'
  8800             MOVE ER-0216              TO  EMI-ERROR
  8801             MOVE -1                   TO  EFFCHGL
  8802             MOVE AL-UABON             TO  EFFCHGA
  8803             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8804
  8805 6000-EFF-EXIT.
  8806     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 183
* EL650.cbl
  8808 6000-EDIT-EXPIRATION-DATE.
  8809***  Y2K PROJ 7744
  8810     IF EXPCHGL  NOT = ZEROS
  8811         MOVE EXPCHGI                  TO  WS-DT-DEEDIT-FIELD
  8812         PERFORM 8600-DEEDIT  THRU 8600-EXIT
  8813         IF WS-DEEDIT-FIELD-DATE-OUT NOT LESS 999999
  8814             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EXPCHGO
  8815             INSPECT EXPCHGI CONVERTING SPACES TO '/'
  8816             MOVE HIGH-VALUES              TO  BIN-EXPCHG-SAVE
  8817             MOVE 99999999999              TO  EXPCHG-SAVE
  8818         ELSE
  8819             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  8820             MOVE '4'                      TO  DC-OPTION-CODE
  8821             PERFORM 9700-DATE-CONVERSION
  8822             IF DATE-CONVERSION-ERROR
  8823                 MOVE ER-0454              TO  EMI-ERROR
  8824                 MOVE -1                   TO  EXPCHGL
  8825                 MOVE AL-UABON             TO  EXPCHGA
  8826                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8827             ELSE
  8828                 MOVE DC-GREG-DATE-1-EDIT  TO  EXPCHGI
  8829                 MOVE AL-UANON             TO  EXPCHGA
  8830                 MOVE DC-GREG-DATE-1-YMD   TO  WS-EXPCHG-SAVE
  8831                 MOVE DC-ALPHA-CENTURY     TO  WS-EXPCHG-SAVE(4:2)
  8832                 MOVE WS-EXPCHG-SAVE       TO  EXPCHG-SAVE
  8833                 MOVE DC-BIN-DATE-1        TO  BIN-EXPCHG-SAVE
  8834             END-IF
  8835         END-IF
  8836     ELSE
  8837         IF MAINTI  NOT =  'N'
  8838             MOVE ER-2058                  TO  EMI-ERROR
  8839             MOVE -1                       TO  EXPCHGL
  8840             MOVE AL-UABON                 TO  EXPCHGA
  8841             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8842         ELSE
  8843             MOVE HIGH-VALUES              TO  BIN-EXPCHG-SAVE
  8844             MOVE 99999999999              TO  EXPCHG-SAVE
  8845         END-IF
  8846     END-IF.
  8847***  Y2K PROJ 7744
  8848
  8849 6000-EXP-EXIT.
  8850     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 184
* EL650.cbl
  8852 6000-EDIT-LINE.
  8853     IF LINEL  = ZEROS
  8854         GO TO 6000-NO-LINE.
  8855
  8856     MOVE AL-UNNON               TO  LINEA.
  8857
  8858     IF LINEI NOT NUMERIC
  8859         GO TO 6000-LINE-ERROR.
  8860
  8861     IF LINEI LESS 1 OR GREATER 8 OR GREATER PI-TOTAL-LINES
  8862         GO TO 6000-LINE-ERROR.
  8863
  8864     MOVE PI-TOTAL-LINES         TO WS-PAGE-LINES.
  8865
  8866     IF PI-2ND-PAGE
  8867         SUBTRACT 8 FROM WS-PAGE-LINES
  8868     ELSE
  8869     IF PI-3RD-PAGE
  8870         SUBTRACT 16 FROM WS-PAGE-LINES
  8871     ELSE
  8872     IF PI-LST-PAGE
  8873         SUBTRACT 24 FROM WS-PAGE-LINES.
  8874
  8875     IF LINEI GREATER WS-PAGE-LINES
  8876         GO TO 6000-LINE-ERROR.
  8877
  8878     MOVE LINEI                  TO  PI-LINE-SELECTED.
  8879
  8880     GO TO 6000-LIN-EXIT.
  8881
  8882 6000-NO-LINE.
  8883     IF PI-TOTAL-LINES  = 1
  8884         MOVE 1                  TO  PI-LINE-SELECTED
  8885                                     LINEI
  8886         MOVE AL-UNNON           TO  LINEA
  8887         GO TO 6000-LIN-EXIT.
  8888
  8889 6000-LINE-ERROR.
  8890     MOVE ER-2064                TO  EMI-ERROR.
  8891     MOVE -1                     TO  LINEL.
  8892     MOVE AL-UABON               TO  LINEA.
  8893
  8894     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8895
  8896 6000-LIN-EXIT.
  8897     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 185
* EL650.cbl
  8899 600A-CHECK-HI-LO-DATES.
  8900
  8901     IF PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  8902         GO TO 600A-CHECK-AR-DATES.
  8903
  8904     IF BIN-EFFCHG-SAVE GREATER THAN PI-BIN-EFF-DT (T-INDEX)
  8905     IF (PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  8906         MOVE ER-2113            TO  EMI-ERROR
  8907         MOVE -1                 TO  MAINTL
  8908         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8909
  8910*    IF (PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  8911*        MOVE ER-2113            TO  EMI-ERROR
  8912*        MOVE -1                 TO  MAINTL
  8913*        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8914
  8915 600A-CHECK-AR-DATES.
  8916     IF NOT PI-AR-PROCESSING
  8917         GO TO 600A-EXIT.
  8918
  8919     IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES OR SPACES
  8920        GO TO 600A-EXIT.
  8921
  8922     IF (PI-BIN-AR-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  8923         MOVE ER-2113            TO  EMI-ERROR
  8924         MOVE -1                 TO  MAINTL
  8925         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8926
  8927 600A-EXIT.
  8928     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 186
* EL650.cbl
  8930 6010-DATE-CHECK.
  8931     IF MAINTI  = 'E'
  8932         GO TO 6010-CHECK-EFF.
  8933
  8934     IF PI-BIN-HI-CERT (T-INDEX)  NOT = LOW-VALUES
  8935         IF BIN-EXPCHG-SAVE NOT GREATER PI-BIN-HI-CERT (T-INDEX)
  8936             MOVE ER-2072        TO  EMI-ERROR
  8937             MOVE -1             TO  EXPCHGL
  8938             MOVE AL-UABON       TO  EXPCHGA
  8939             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8940
  8941     IF BIN-EXPCHG-SAVE NOT GREATER PI-BIN-EFF-DT (T-INDEX)
  8942         MOVE ER-2074            TO  EMI-ERROR
  8943         MOVE -1                 TO  EXPCHGL
  8944         MOVE AL-UABON           TO  EXPCHGA
  8945         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8946
  8947     GO TO 6010-EXIT.
  8948
  8949 6010-CHECK-EFF.
  8950     IF PI-BIN-LO-CERT (T-INDEX)  NOT =  LOW-VALUES
  8951        IF (BIN-EFFCHG-SAVE >= PI-BIN-LO-CERT (T-INDEX))
  8952           AND (PI-PROCESSOR-ID NOT = 'PEMA')
  8953           MOVE ER-2073          TO EMI-ERROR
  8954           MOVE -1               TO EFFCHGL
  8955           MOVE AL-UABON         TO EFFCHGA
  8956           PERFORM 9900-ERROR-FORMAT
  8957                                 THRU 9900-EXIT
  8958        END-IF
  8959     END-IF
  8960
  8961     IF BIN-EFFCHG-SAVE NOT LESS PI-BIN-EXP-DT (T-INDEX)
  8962         MOVE ER-2075            TO  EMI-ERROR
  8963         MOVE -1                 TO  EFFCHGL
  8964         MOVE AL-UABON           TO  EFFCHGA
  8965         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8966
  8967 6010-EXIT.
  8968     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 187
* EL650.cbl
  8970 6100-BUILD-KEY.
  8971     MOVE LOW-VALUES             TO  PI-ACCT-KEY.
  8972     MOVE PI-COMPANY-CD          TO  PI-ACCT-CO.
  8973
  8974     IF ACARIERI  =  SPACES  OR  LOW-VALUES
  8975         IF MAINTI  = 'S'
  8976           OR  FIRST-TIME
  8977             MOVE SPACES         TO  PI-ACCT-CARRIER
  8978         ELSE
  8979             MOVE -1             TO  ACARIERL
  8980             MOVE ER-2059        TO  EMI-ERROR
  8981             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8982     ELSE
  8983         MOVE AL-UANON           TO  ACARIERA
  8984         MOVE ACARIERI           TO  PI-ACCT-CARRIER.
  8985
  8986     IF AGROUPI  =  SPACES  OR  LOW-VALUES
  8987         IF MAINTI  = 'S'
  8988           OR  FIRST-TIME
  8989             MOVE SPACES         TO  PI-ACCT-GROUPING
  8990         ELSE
  8991             MOVE -1             TO  AGROUPL
  8992             MOVE ER-2059        TO  EMI-ERROR
  8993             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8994     ELSE
  8995         IF AGROUPI  =  '0     '
  8996             MOVE -1             TO  AGROUPL
  8997             MOVE ER-0195        TO  EMI-ERROR
  8998             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8999         ELSE
  9000             MOVE AL-UANON       TO  AGROUPA
  9001             MOVE AGROUPI        TO  PI-ACCT-GROUPING.
  9002
  9003     IF ASTATEI  = SPACES  OR  LOW-VALUES
  9004         IF MAINTI  =  'S'
  9005           OR  FIRST-TIME
  9006             MOVE SPACES         TO  PI-ACCT-STATE
  9007         ELSE
  9008             MOVE -1             TO  ASTATEL
  9009             MOVE ER-2059        TO  EMI-ERROR
  9010             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9011     ELSE
  9012         MOVE AL-UANON           TO  ASTATEA
  9013         MOVE ASTATEI            TO  PI-ACCT-STATE.
  9014
  9015     IF AACCTI  = SPACES  OR  LOW-VALUES
  9016        IF MAINTI  = 'S'
  9017          OR  FIRST-TIME
  9018            MOVE SPACES          TO  PI-ACCT-ACCOUNT
  9019        ELSE
  9020            MOVE -1              TO  AACCTL
  9021            MOVE ER-2059         TO  EMI-ERROR
  9022            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9023     ELSE
  9024         MOVE AL-UANON           TO  AACCTA
  9025         MOVE AACCTI             TO  PI-ACCT-ACCOUNT.
  9026
  9027     IF PI-ACCT-CARRIER  = SPACES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 188
* EL650.cbl
  9028       AND  (CARR-ACCNT-CNTL
  9029       OR   CARR-ST-ACCNT-CNTL
  9030       OR   CARR-GROUP-ST-ACCNT-CNTL)
  9031         MOVE ER-0193            TO  EMI-ERROR
  9032         MOVE -1                 TO  ACARIERL
  9033         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9034
  9035     IF PI-ACCT-GROUPING  =  SPACES
  9036       AND  CARR-GROUP-ST-ACCNT-CNTL
  9037         MOVE ER-0195            TO  EMI-ERROR
  9038         MOVE -1                 TO  AGROUPL
  9039         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9040
  9041     IF PI-ACCT-STATE  = SPACES
  9042       AND  (ST-ACCNT-CNTL
  9043       OR   CARR-ST-ACCNT-CNTL
  9044       OR   CARR-GROUP-ST-ACCNT-CNTL)
  9045         MOVE ER-0144            TO  EMI-ERROR
  9046         MOVE -1                 TO  ASTATEL
  9047         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9048
  9049     IF MAINTI  =  'S'
  9050       OR  FIRST-TIME
  9051         NEXT SENTENCE
  9052     ELSE
  9053         MOVE PI-ACCT-CCGSA-KEY  TO  KEY-SAVE.
  9054
  9055     IF NOT EMI-NO-ERRORS
  9056         IF EIBTRNID = EL6311-TRANS-ID
  9057             GO TO 8100-SEND-INITIAL-MAP
  9058           ELSE
  9059             GO TO 8200-SEND-DATAONLY.
  9060
  9061     IF PI-ACCT-CARRIER   = SPACES  OR
  9062        PI-ACCT-STATE     = SPACES  OR
  9063        PI-ACCT-GROUPING  = SPACES
  9064         MOVE ACCT2-FILE-ID      TO  PI-ACCT-ID
  9065     ELSE
  9066         MOVE ACCT-FILE-ID       TO  PI-ACCT-ID.
  9067
  9068     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  9069                                     PI-ACCT-REST-OF-EXP.
  9070
  9071 6199-EXIT.
  9072     EXIT.
  9073
  9074 6200-CHECK-KEY.
  9075     IF PI-PREV-ACCOUNT  NOT = PI-ACCT-CCGSA-KEY
  9076         MOVE ER-0453            TO  EMI-ERROR
  9077         MOVE -1                 TO  MAINTL
  9078         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9079
  9080 6200-EXIT.
  9081     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 189
* EL650.cbl
  9083 6300-STARTBR.
  9084     MOVE ACCT-FILE-ID           TO  PI-ACCT-ID.
  9085
  9086
  9087* EXEC CICS  STARTBR
  9088*        DATASET  (PI-ACCT-ID)
  9089*        RIDFLD   (PI-ACCT-KEY)
  9090*    END-EXEC.
  9091     MOVE 0
  9092       TO DFHEIV11
  9093*    MOVE '&,         G          &   #00008069' TO DFHEIV0
  9094     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9095     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9096     MOVE X'2020233030303038303639' TO DFHEIV0(25:11)
  9097     CALL 'kxdfhei1' USING DFHEIV0,
  9098           PI-ACCT-ID,
  9099           PI-ACCT-KEY,
  9100           DFHEIV99,
  9101           DFHEIV11,
  9102           DFHEIV99
  9103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9104
  9105
  9106     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  9107     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE.
  9108
  9109 6300-EXIT.
  9110     EXIT.
  9111
  9112 6310-READNEXT.
  9113
  9114* EXEC CICS  READNEXT
  9115*        DATASET  (PI-ACCT-ID)
  9116*        SET      (ADDRESS OF ACCOUNT-MASTER)
  9117*        RIDFLD   (PI-ACCT-KEY)
  9118*    END-EXEC.
  9119     MOVE 0
  9120       TO DFHEIV11
  9121*    MOVE '&.S                   )   #00008081' TO DFHEIV0
  9122     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9123     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9124     MOVE X'2020233030303038303831' TO DFHEIV0(25:11)
  9125     CALL 'kxdfhei1' USING DFHEIV0,
  9126           PI-ACCT-ID,
  9127           DFHEIV20,
  9128           DFHEIV99,
  9129           PI-ACCT-KEY,
  9130           DFHEIV99,
  9131           DFHEIV11,
  9132           DFHEIV99,
  9133           DFHEIV99
  9134     SET ADDRESS OF ACCOUNT-MASTER TO
  9135         DFHEIV20
  9136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9137
  9138
  9139 6310-EXIT.
  9140     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 190
* EL650.cbl
  9141
  9142 6320-ENDBR.
  9143     MOVE SPACE                  TO  BROWSE-STARTED-SW.
  9144
  9145
  9146* EXEC CICS  ENDBR
  9147*        DATASET  (PI-ACCT-ID)
  9148*    END-EXEC.
  9149     MOVE 0
  9150       TO DFHEIV11
  9151*    MOVE '&2                    $   #00008093' TO DFHEIV0
  9152     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9153     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9154     MOVE X'2020233030303038303933' TO DFHEIV0(25:11)
  9155     CALL 'kxdfhei1' USING DFHEIV0,
  9156           PI-ACCT-ID,
  9157           DFHEIV11,
  9158           DFHEIV99
  9159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9160
  9161
  9162 6320-EXIT.
  9163     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 191
* EL650.cbl
  9165 6400-BUILD-VG-KEY.
  9166     MOVE AM-CONTROL-PRIMARY     TO  AM-CONTROL-BY-VAR-GRP.
  9167
  9168     IF ST-ACCNT-CNTL
  9169         MOVE SPACES             TO  AM-VG-CARRIER
  9170                                     AM-VG-GROUPING.
  9171
  9172     IF CARR-ST-ACCNT-CNTL
  9173         MOVE SPACES             TO  AM-VG-GROUPING.
  9174
  9175     IF ACCNT-CNTL
  9176         MOVE SPACES             TO  AM-VG-CARRIER
  9177                                     AM-VG-STATE
  9178                                     AM-VG-GROUPING.
  9179
  9180     IF CARR-ACCNT-CNTL
  9181         MOVE SPACES             TO  AM-VG-STATE
  9182                                     AM-VG-GROUPING.
  9183
  9184 6499-EXIT.
  9185     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 192
* EL650.cbl
  9187 6500-READ-ACCT.
  9188
  9189* EXEC CICS  HANDLE CONDITION
  9190*        NOTFND  (6599-EXIT)
  9191*    END-EXEC.
  9192*    MOVE '"$I                   ! 7 #00008123' TO DFHEIV0
  9193     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9194     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9195     MOVE X'3720233030303038313233' TO DFHEIV0(25:11)
  9196     CALL 'kxdfhei1' USING DFHEIV0
  9197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9198
  9199
  9200     MOVE ZERO                   TO  REC-SW.
  9201
  9202
  9203* EXEC CICS  READ
  9204*        GTEQ
  9205*        DATASET  (ACCT-FILE-ID)
  9206*        SET      (ADDRESS OF ACCOUNT-MASTER)
  9207*        RIDFLD   (PI-ACCT-KEY)
  9208*    END-EXEC.
  9209*    MOVE '&"S        G          (   #00008129' TO DFHEIV0
  9210     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9211     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9212     MOVE X'2020233030303038313239' TO DFHEIV0(25:11)
  9213     CALL 'kxdfhei1' USING DFHEIV0,
  9214           ACCT-FILE-ID,
  9215           DFHEIV20,
  9216           DFHEIV99,
  9217           PI-ACCT-KEY,
  9218           DFHEIV99,
  9219           DFHEIV99,
  9220           DFHEIV99
  9221     SET ADDRESS OF ACCOUNT-MASTER TO
  9222         DFHEIV20
  9223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9224
  9225
  9226     MOVE AM-CONTROL-PRIMARY     TO  PI-ACCT-KEY.
  9227     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  9228
  9229     IF PI-ACCT-CCGSA-KEY  = NEW-KEY-SAVE
  9230         MOVE 1                  TO  REC-SW.
  9231
  9232 6599-EXIT.
  9233     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 193
* EL650.cbl
  9235 6600-UPDATE-MAINT-DT.
  9236     MOVE SPACES                 TO  ELCNTL-KEY.
  9237     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9238     MOVE '1'                    TO  CNTL-REC-TYPE.
  9239     MOVE +0                     TO  CNTL-SEQ-NO.
  9240
  9241
  9242* EXEC CICS  HANDLE CONDITION
  9243*        NOTFND  (6699-EXIT)
  9244*    END-EXEC.
  9245*    MOVE '"$I                   ! 8 #00008151' TO DFHEIV0
  9246     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9247     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9248     MOVE X'3820233030303038313531' TO DFHEIV0(25:11)
  9249     CALL 'kxdfhei1' USING DFHEIV0
  9250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9251
  9252
  9253
  9254* EXEC CICS  READ
  9255*        UPDATE
  9256*        DATASET  (CNTL-FILE-ID)
  9257*        SET      (ADDRESS OF CONTROL-FILE)
  9258*        RIDFLD   (ELCNTL-KEY)
  9259*    END-EXEC.
  9260*    MOVE '&"S        EU         (   #00008155' TO DFHEIV0
  9261     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9262     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9263     MOVE X'2020233030303038313535' TO DFHEIV0(25:11)
  9264     CALL 'kxdfhei1' USING DFHEIV0,
  9265           CNTL-FILE-ID,
  9266           DFHEIV20,
  9267           DFHEIV99,
  9268           ELCNTL-KEY,
  9269           DFHEIV99,
  9270           DFHEIV99,
  9271           DFHEIV99
  9272     SET ADDRESS OF CONTROL-FILE TO
  9273         DFHEIV20
  9274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9275
  9276
  9277     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  9278     MOVE 'B'                    TO  JP-RECORD-TYPE.
  9279     MOVE CNTL-FILE-ID           TO  FILE-ID.
  9280
  9281     PERFORM 8400-LOG-JOURNAL-RECORD.
  9282
  9283     MOVE BIN-CURRENT-SAVE       TO  CF-ACCOUNT-MSTR-MAINT-DT.
  9284     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  9285     MOVE 'C'                    TO  JP-RECORD-TYPE.
  9286     MOVE CNTL-FILE-ID           TO  FILE-ID.
  9287
  9288
  9289* EXEC CICS  REWRITE
  9290*        DATASET  (CNTL-FILE-ID)
  9291*        FROM     (CONTROL-FILE)
  9292*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 194
* EL650.cbl
  9293     MOVE LENGTH OF
  9294      CONTROL-FILE
  9295       TO DFHEIV11
  9296*    MOVE '&& L                  %   #00008173' TO DFHEIV0
  9297     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9298     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9299     MOVE X'2020233030303038313733' TO DFHEIV0(25:11)
  9300     CALL 'kxdfhei1' USING DFHEIV0,
  9301           CNTL-FILE-ID,
  9302           CONTROL-FILE,
  9303           DFHEIV11,
  9304           DFHEIV99
  9305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9306
  9307
  9308     PERFORM 8400-LOG-JOURNAL-RECORD.
  9309
  9310 6699-EXIT.
  9311     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 195
* EL650.cbl
  9313 6700-VERIFY-STATE-CARRIER.
  9314     IF PI-ACCT-CARRIER  = SPACES
  9315         GO TO 6750-CHECK-STATE.
  9316
  9317     MOVE SPACES                 TO  ELCNTL-KEY.
  9318     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9319     MOVE '6'                    TO  CNTL-REC-TYPE.
  9320     MOVE PI-ACCT-CARRIER        TO  CNTL-CARRIER
  9321     MOVE +0                     TO  CNTL-SEQ-NO.
  9322
  9323
  9324* EXEC CICS  HANDLE CONDITION
  9325*        NOTFND  (6720-NO-CARRIER)
  9326*    END-EXEC.
  9327*    MOVE '"$I                   ! 9 #00008193' TO DFHEIV0
  9328     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9329     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9330     MOVE X'3920233030303038313933' TO DFHEIV0(25:11)
  9331     CALL 'kxdfhei1' USING DFHEIV0
  9332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9333
  9334
  9335
  9336* EXEC CICS  READ
  9337*        DATASET  (CNTL-FILE-ID)
  9338*        SET      (ADDRESS OF CONTROL-FILE)
  9339*        RIDFLD   (ELCNTL-KEY)
  9340*    END-EXEC.
  9341*    MOVE '&"S        E          (   #00008197' TO DFHEIV0
  9342     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9343     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9344     MOVE X'2020233030303038313937' TO DFHEIV0(25:11)
  9345     CALL 'kxdfhei1' USING DFHEIV0,
  9346           CNTL-FILE-ID,
  9347           DFHEIV20,
  9348           DFHEIV99,
  9349           ELCNTL-KEY,
  9350           DFHEIV99,
  9351           DFHEIV99,
  9352           DFHEIV99
  9353     SET ADDRESS OF CONTROL-FILE TO
  9354         DFHEIV20
  9355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9356
  9357
  9358     GO TO 6750-CHECK-STATE.
  9359
  9360 6720-NO-CARRIER.
  9361     MOVE ER-0193                TO  EMI-ERROR.
  9362     MOVE -1                     TO  ACARIERL.
  9363     MOVE AL-UABON               TO  ACARIERA.
  9364
  9365     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9366
  9367 6750-CHECK-STATE.
  9368     IF PI-ACCT-STATE  =  SPACES
  9369         GO TO 6799-EXIT.
  9370
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 196
* EL650.cbl
  9371     MOVE SPACES                 TO  ELCNTL-KEY.
  9372     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9373     MOVE '3'                    TO  CNTL-REC-TYPE.
  9374     MOVE PI-ACCT-STATE          TO  CNTL-STATE.
  9375     MOVE +0                     TO  CNTL-SEQ-NO.
  9376
  9377
  9378* EXEC CICS  HANDLE CONDITION
  9379*        NOTFND  (6780-NO-STATE)
  9380*    END-EXEC.
  9381*    MOVE '"$I                   ! : #00008222' TO DFHEIV0
  9382     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9383     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9384     MOVE X'3A20233030303038323232' TO DFHEIV0(25:11)
  9385     CALL 'kxdfhei1' USING DFHEIV0
  9386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9387
  9388
  9389
  9390* EXEC CICS  READ
  9391*        DATASET  (CNTL-FILE-ID)
  9392*        SET      (ADDRESS OF CONTROL-FILE)
  9393*        RIDFLD   (ELCNTL-KEY)
  9394*    END-EXEC.
  9395*    MOVE '&"S        E          (   #00008226' TO DFHEIV0
  9396     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9397     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9398     MOVE X'2020233030303038323236' TO DFHEIV0(25:11)
  9399     CALL 'kxdfhei1' USING DFHEIV0,
  9400           CNTL-FILE-ID,
  9401           DFHEIV20,
  9402           DFHEIV99,
  9403           ELCNTL-KEY,
  9404           DFHEIV99,
  9405           DFHEIV99,
  9406           DFHEIV99
  9407     SET ADDRESS OF CONTROL-FILE TO
  9408         DFHEIV20
  9409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9410
  9411
  9412     GO TO 6799-EXIT.
  9413
  9414 6780-NO-STATE.
  9415     MOVE ER-0144                TO  EMI-ERROR.
  9416     MOVE -1                     TO  ASTATEL.
  9417     MOVE AL-UABON               TO  ASTATEA.
  9418
  9419     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9420
  9421 6799-EXIT.
  9422     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 197
* EL650.cbl
  9424 6800-COMPANY-REC-READ.
  9425     MOVE SPACES                 TO  ELCNTL-KEY.
  9426     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9427     MOVE '1'                    TO  CNTL-REC-TYPE.
  9428     MOVE +0                     TO  CNTL-SEQ-NO.
  9429
  9430
  9431* EXEC CICS  HANDLE CONDITION
  9432*        NOTFND  (6880-NO-COMP)
  9433*    END-EXEC.
  9434*    MOVE '"$I                   ! ; #00008250' TO DFHEIV0
  9435     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9436     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9437     MOVE X'3B20233030303038323530' TO DFHEIV0(25:11)
  9438     CALL 'kxdfhei1' USING DFHEIV0
  9439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9440
  9441
  9442
  9443* EXEC CICS  READ
  9444*        DATASET  (CNTL-FILE-ID)
  9445*        SET      (ADDRESS OF CONTROL-FILE)
  9446*        RIDFLD   (ELCNTL-KEY)
  9447*    END-EXEC.
  9448*    MOVE '&"S        E          (   #00008254' TO DFHEIV0
  9449     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9450     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9451     MOVE X'2020233030303038323534' TO DFHEIV0(25:11)
  9452     CALL 'kxdfhei1' USING DFHEIV0,
  9453           CNTL-FILE-ID,
  9454           DFHEIV20,
  9455           DFHEIV99,
  9456           ELCNTL-KEY,
  9457           DFHEIV99,
  9458           DFHEIV99,
  9459           DFHEIV99
  9460     SET ADDRESS OF CONTROL-FILE TO
  9461         DFHEIV20
  9462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9463
  9464
  9465     IF CF-ACCOUNT-MSTR-MAINT-DT  = LOW-VALUES
  9466         MOVE ER-2572            TO  EMI-ERROR
  9467         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9468
  9469     GO TO 6899-EXIT.
  9470
  9471 6880-NO-COMP.
  9472     MOVE ER-0022                TO  EMI-ERROR.
  9473
  9474     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9475
  9476 6899-EXIT.
  9477     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 198
* EL650.cbl
  9479 7000-BUILD-OUTPUT-MAP.
  9480     IF RETURNING-FROM-6501
  9481         MOVE PI-PREV-VG-ACCOUNT  TO  KEY-SAVE.
  9482
  9483     IF PI-COMPANY-ID  = 'LGX'  OR  'MIC'  OR  'MCC'
  9484         MOVE AL-SANOF           TO  TRNMSG1A
  9485                                     TRNMSG2A
  9486                                     TRNMSG3A
  9487                                     TRNMSG4A.
  9488
  9489     MOVE AL-UANON               TO  ACARIERA
  9490                                     AGROUPA
  9491                                     ASTATEA
  9492                                     AACCTA.
  9493     MOVE SV-CARRIER             TO  ACARIERO.
  9494     MOVE SV-GROUPING            TO  AGROUPO.
  9495     MOVE SV-STATE               TO  ASTATEO.
  9496     MOVE SV-ACCOUNT             TO  AACCTO.
  9497
  9498     SET M-INDEX  TO  1.
  9499
  9500     MOVE LOW-VALUES             TO  MAP-RECORD-AREA.
  9501
  9502     IF PI-MAINT  = 'A'
  9503       AND  PI-RECORD-NOT-CREATED
  9504         MOVE ER-2151            TO  EMI-ERROR
  9505         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9506         GO TO 7000-END.
  9507
  9508     IF PI-FST-PAGE
  9509         SET T-INDEX   TO  1
  9510     ELSE
  9511     IF PI-2ND-PAGE
  9512         SET T-INDEX   TO  9
  9513     ELSE
  9514     IF PI-3RD-PAGE
  9515         SET T-INDEX   TO  17
  9516     ELSE
  9517         SET T-INDEX   TO  25.
  9518
  9519 7000-LOOP.
  9520     IF PI-BIN-EXP-DT (T-INDEX)  NOT = HIGH-VALUES
  9521         MOVE PI-BIN-EXP-DT (T-INDEX)
  9522                                 TO  DC-BIN-DATE-1
  9523         MOVE SPACE              TO  DC-OPTION-CODE
  9524         PERFORM 9700-DATE-CONVERSION
  9525         IF DATE-CONVERSION-ERROR
  9526             MOVE SPACES         TO  MAP-EXP-DT (M-INDEX)
  9527         ELSE
  9528             MOVE DC-GREG-DATE-1-EDIT
  9529                                 TO  MAP-EXP-DT (M-INDEX)
  9530     ELSE
  9531         MOVE 999999             TO  MAP-EXP-DT-ED (M-INDEX)
  9532         INSPECT MAP-EXP-DT-ED (M-INDEX) CONVERTING SPACES TO '/'.
  9533
  9534     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  DC-BIN-DATE-1.
  9535     MOVE SPACE                    TO  DC-OPTION-CODE.
  9536
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 199
* EL650.cbl
  9537     PERFORM 9700-DATE-CONVERSION.
  9538
  9539     IF DATE-CONVERSION-ERROR
  9540         MOVE SPACES               TO  MAP-EFF-DT (M-INDEX)
  9541     ELSE
  9542         MOVE DC-GREG-DATE-1-EDIT  TO  MAP-EFF-DT (M-INDEX).
  9543
  9544     IF PI-BIN-MAINT-DT (T-INDEX)  = LOW-VALUES
  9545         MOVE SPACES             TO  MAP-LST-MAINT-DT (M-INDEX)
  9546     ELSE
  9547         MOVE PI-BIN-MAINT-DT (T-INDEX)
  9548                                 TO  DC-BIN-DATE-1
  9549         MOVE SPACE              TO  DC-OPTION-CODE
  9550         PERFORM 9700-DATE-CONVERSION
  9551         IF DATE-CONVERSION-ERROR
  9552             MOVE SPACES         TO  MAP-LST-MAINT-DT (M-INDEX)
  9553         ELSE
  9554             MOVE DC-GREG-DATE-1-EDIT
  9555                                 TO  MAP-LST-MAINT-DT (M-INDEX).
  9556
  9557     IF PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  9558         MOVE SPACES             TO  MAP-HIGH-CERT (M-INDEX)
  9559     ELSE
  9560         MOVE PI-BIN-HI-CERT (T-INDEX)
  9561                                 TO  DC-BIN-DATE-1
  9562         MOVE SPACE              TO  DC-OPTION-CODE
  9563         PERFORM 9700-DATE-CONVERSION
  9564         IF DATE-CONVERSION-ERROR
  9565             MOVE SPACES         TO  MAP-HIGH-CERT (M-INDEX)
  9566         ELSE
  9567             MOVE DC-GREG-DATE-1-EDIT
  9568                                 TO  MAP-HIGH-CERT (M-INDEX).
  9569
  9570     IF PI-BIN-LO-CERT (T-INDEX)  = LOW-VALUES
  9571         MOVE SPACES             TO  MAP-LOW-CERT (M-INDEX)
  9572     ELSE
  9573         MOVE PI-BIN-LO-CERT (T-INDEX)
  9574                                 TO  DC-BIN-DATE-1
  9575         MOVE SPACE              TO  DC-OPTION-CODE
  9576         PERFORM 9700-DATE-CONVERSION
  9577         IF DATE-CONVERSION-ERROR
  9578             MOVE SPACES         TO  MAP-LOW-CERT (M-INDEX)
  9579         ELSE
  9580             MOVE DC-GREG-DATE-1-EDIT
  9581                                 TO  MAP-LOW-CERT (M-INDEX).
  9582
  9583     IF PI-BIN-AR-HI-CERT (T-INDEX)  = LOW-VALUES OR SPACES
  9584         MOVE SPACES             TO  MAP-AR-DATE (M-INDEX)
  9585     ELSE
  9586         MOVE PI-BIN-AR-HI-CERT (T-INDEX)
  9587                                 TO  DC-BIN-DATE-1
  9588         MOVE SPACE              TO  DC-OPTION-CODE
  9589         PERFORM 9700-DATE-CONVERSION
  9590         IF DATE-CONVERSION-ERROR
  9591             MOVE SPACES         TO  MAP-AR-DATE (M-INDEX)
  9592         ELSE
  9593             MOVE DC-GREG-DATE-1-EDIT
  9594                                 TO  MAP-AR-DATE (M-INDEX).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 200
* EL650.cbl
  9595
  9596     IF M-INDEX  =  8  OR
  9597        T-INDEX  =  PI-TOTAL-LINES
  9598         NEXT SENTENCE
  9599     ELSE
  9600         SET M-INDEX
  9601             T-INDEX  UP  BY  1
  9602         GO TO 7000-LOOP.
  9603
  9604     IF M-INDEX  =  8
  9605       AND  T-INDEX  LESS THAN  PI-TOTAL-LINES
  9606         MOVE ER-0668            TO  EMI-ERROR
  9607         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9608
  9609     IF T-INDEX  =  PI-TOTAL-LINES
  9610         MOVE ER-0630            TO  EMI-ERROR
  9611         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9612
  9613 7000-END.
  9614     MOVE -1                     TO  MAINTL.
  9615     MOVE MAINTI                 TO  PI-MAINT.
  9616
  9617     IF MAINTI  = 'S'  OR  'D'
  9618       OR  RETURNING-FROM-6501
  9619         MOVE LOW-VALUES         TO  MAINTI
  9620         MOVE PI-ACCNAME         TO  NAMEO
  9621         MOVE PI-NAMEFLG         TO  NAMEFLGO
  9622         GO TO 8100-SEND-INITIAL-MAP.
  9623
  9624     IF EIBAID  =  DFHPF1  OR  DFHPF2  OR
  9625                   DFHPF3  OR  DFHPF4
  9626         MOVE 'S'                TO  PI-MAINT
  9627         MOVE PI-ACCNAME         TO  NAMEO
  9628         MOVE PI-NAMEFLG         TO  NAMEFLGO
  9629         GO TO 8100-SEND-INITIAL-MAP.
  9630
  9631     IF MAINTI  = 'N' OR 'E' OR 'X'
  9632        MOVE SPACES                 TO  BIN-EXPCHG-SAVE
  9633                                        BIN-EFFCHG-SAVE
  9634        MOVE SPACES                 TO  EFFCHGI
  9635                                        EXPCHGI
  9636        MOVE AL-UANOF               TO  EFFCHGA
  9637                                        EXPCHGA
  9638        MOVE SPACES                 TO  PI-MAINT
  9639        MOVE SPACES                 TO  MAINTI
  9640                                        MAINTO
  9641        MOVE AL-UANOF               TO  MAINTA.
  9642
  9643     IF K-WITH-LINE-NO
  9644         MOVE ZERO         TO K-WITH-LINE-USED
  9645         GO TO 8100-SEND-INITIAL-MAP.
  9646
  9647     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 201
* EL650.cbl
  9649 7100-START-BROWSE.
  9650
  9651* EXEC CICS  STARTBR
  9652*        DATASET  (PI-ACCT-ID)
  9653*        RIDFLD   (PI-ACCT-KEY)
  9654*    END-EXEC.
  9655     MOVE 0
  9656       TO DFHEIV11
  9657*    MOVE '&,         G          &   #00008445' TO DFHEIV0
  9658     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9659     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9660     MOVE X'2020233030303038343435' TO DFHEIV0(25:11)
  9661     CALL 'kxdfhei1' USING DFHEIV0,
  9662           PI-ACCT-ID,
  9663           PI-ACCT-KEY,
  9664           DFHEIV99,
  9665           DFHEIV11,
  9666           DFHEIV99
  9667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9668
  9669
  9670 7100-EXIT.
  9671     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 202
* EL650.cbl
  9673 7200-WRITE-TEMP-STORAGE.
  9674     PERFORM 7300-DELETE-TEMP-STORAGE  THRU  7300-EXIT.
  9675
  9676
  9677* EXEC CICS  HANDLE CONDITION
  9678*        ITEMERR  (7200-EXIT)
  9679*        QIDERR   (7200-EXIT)
  9680*    END-EXEC.
  9681*    MOVE '"$<N                  ! < #00008456' TO DFHEIV0
  9682     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9683     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9684     MOVE X'3C20233030303038343536' TO DFHEIV0(25:11)
  9685     CALL 'kxdfhei1' USING DFHEIV0
  9686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9687
  9688
  9689     MOVE +0                     TO  TS-ITEM.
  9690
  9691
  9692* EXEC CICS  WRITEQ TS
  9693*        QUEUE   (TS-QUEUE)
  9694*        FROM    (TEMP-STORAGE-RECORD)
  9695*        LENGTH  (TS-LENGTH)
  9696*        ITEM    (TS-ITEM)
  9697*    END-EXEC.
  9698*    MOVE '*" I                  ''   #00008463' TO DFHEIV0
  9699     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  9700     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9701     MOVE X'2020233030303038343633' TO DFHEIV0(25:11)
  9702     CALL 'kxdfhei1' USING DFHEIV0,
  9703           TS-QUEUE,
  9704           TEMP-STORAGE-RECORD,
  9705           TS-LENGTH,
  9706           TS-ITEM,
  9707           DFHEIV99,
  9708           DFHEIV99
  9709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9710
  9711
  9712 7200-EXIT.
  9713     EXIT.
  9714
  9715 7300-DELETE-TEMP-STORAGE.
  9716
  9717* EXEC CICS  HANDLE CONDITION
  9718*        ITEMERR  (7300-EXIT)
  9719*        QIDERR   (7300-EXIT)
  9720*    END-EXEC.
  9721*    MOVE '"$<N                  ! = #00008474' TO DFHEIV0
  9722     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9723     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9724     MOVE X'3D20233030303038343734' TO DFHEIV0(25:11)
  9725     CALL 'kxdfhei1' USING DFHEIV0
  9726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9727
  9728
  9729
  9730* EXEC CICS  DELETEQ TS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 203
* EL650.cbl
  9731*        QUEUE  (TS-QUEUE)
  9732*    END-EXEC.
  9733*    MOVE '*&                    #   #00008479' TO DFHEIV0
  9734     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9735     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9736     MOVE X'2020233030303038343739' TO DFHEIV0(25:11)
  9737     CALL 'kxdfhei1' USING DFHEIV0,
  9738           TS-QUEUE,
  9739           DFHEIV99
  9740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9741
  9742
  9743 7300-EXIT.
  9744     EXIT.
  9745
  9746 7400-READ-TEMP-STORAGE.
  9747
  9748* EXEC CICS  HANDLE CONDITION
  9749*        ITEMERR  (7400-EXIT)
  9750*        QIDERR   (7400-EXIT)
  9751*    END-EXEC.
  9752*    MOVE '"$<N                  ! > #00008487' TO DFHEIV0
  9753     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9754     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9755     MOVE X'3E20233030303038343837' TO DFHEIV0(25:11)
  9756     CALL 'kxdfhei1' USING DFHEIV0
  9757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9758
  9759
  9760     MOVE +1                     TO  TS-ITEM.
  9761
  9762
  9763* EXEC CICS  READQ TS
  9764*        QUEUE   (TS-QUEUE)
  9765*        INTO    (TEMP-STORAGE-RECORD)
  9766*        LENGTH  (TS-LENGTH)
  9767*        ITEM    (TS-ITEM)
  9768*    END-EXEC.
  9769*    MOVE '*$II   L              ''   #00008494' TO DFHEIV0
  9770     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  9771     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9772     MOVE X'2020233030303038343934' TO DFHEIV0(25:11)
  9773     CALL 'kxdfhei1' USING DFHEIV0,
  9774           TS-QUEUE,
  9775           TEMP-STORAGE-RECORD,
  9776           TS-LENGTH,
  9777           TS-ITEM,
  9778           DFHEIV99,
  9779           DFHEIV99
  9780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9781
  9782
  9783 7400-EXIT.
  9784     EXIT.
  9785
  9786 8100-SEND-INITIAL-MAP.
  9787     MOVE SAVE-DATE              TO  DATEO.
  9788     MOVE EIBTIME                TO  TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 204
* EL650.cbl
  9789     MOVE TIME-OUT               TO  TIMEO.
  9790     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9791     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9792     MOVE -1                     TO  MAINTL.
  9793     MOVE AL-UABON               TO  MAINTA.
  9794     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9795     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9796
  9797     IF PI-AR-PROCESSING
  9798        MOVE AL-PANOF            TO  ARHDGA.
  9799
  9800
  9801* EXEC CICS  SEND
  9802*        MAP     (MAP-NAME)
  9803*        MAPSET  (MAPSET-NAME)
  9804*        FROM    (EL650AO)
  9805*        ERASE
  9806*        CURSOR
  9807*    END-EXEC.
  9808     MOVE LENGTH OF
  9809      EL650AO
  9810       TO DFHEIV12
  9811     MOVE -1
  9812       TO DFHEIV11
  9813*    MOVE '8$     CT  E    H L F ,   #00008518' TO DFHEIV0
  9814     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9815     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9816     MOVE X'2020233030303038353138' TO DFHEIV0(25:11)
  9817     CALL 'kxdfhei1' USING DFHEIV0,
  9818           MAP-NAME,
  9819           EL650AO,
  9820           DFHEIV12,
  9821           MAPSET-NAME,
  9822           DFHEIV99,
  9823           DFHEIV99,
  9824           DFHEIV99,
  9825           DFHEIV11,
  9826           DFHEIV99,
  9827           DFHEIV99,
  9828           DFHEIV99
  9829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9830
  9831
  9832     GO TO 9100-RETURN-TRAN.
  9833
  9834 8200-SEND-DATAONLY.
  9835     MOVE SAVE-DATE              TO  DATEO.
  9836     MOVE EIBTIME                TO  TIME-IN.
  9837     MOVE TIME-OUT               TO  TIMEO.
  9838     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9839     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9840     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9841     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9842
  9843
  9844* EXEC CICS  SEND
  9845*        MAP     (MAP-NAME)
  9846*        MAPSET  (MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 205
* EL650.cbl
  9847*        FROM    (EL650AO)
  9848*        DATAONLY
  9849*        CURSOR
  9850*    END-EXEC.
  9851     MOVE LENGTH OF
  9852      EL650AO
  9853       TO DFHEIV12
  9854     MOVE -1
  9855       TO DFHEIV11
  9856*    MOVE '8$D    CT       H L F ,   #00008537' TO DFHEIV0
  9857     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9858     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9859     MOVE X'2020233030303038353337' TO DFHEIV0(25:11)
  9860     CALL 'kxdfhei1' USING DFHEIV0,
  9861           MAP-NAME,
  9862           EL650AO,
  9863           DFHEIV12,
  9864           MAPSET-NAME,
  9865           DFHEIV99,
  9866           DFHEIV99,
  9867           DFHEIV99,
  9868           DFHEIV11,
  9869           DFHEIV99,
  9870           DFHEIV99,
  9871           DFHEIV99
  9872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9873
  9874
  9875     GO TO 9100-RETURN-TRAN.
  9876
  9877 8300-SEND-TEXT.
  9878
  9879* EXEC CICS  SEND TEXT
  9880*        FROM    (LOGOFF-TEXT)
  9881*        LENGTH  (LOGOFF-LENGTH)
  9882*        ERASE
  9883*        FREEKB
  9884*    END-EXEC.
  9885*    MOVE '8&      T  E F  H   F -   #00008548' TO DFHEIV0
  9886     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9887     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9888     MOVE X'2020233030303038353438' TO DFHEIV0(25:11)
  9889     CALL 'kxdfhei1' USING DFHEIV0,
  9890           LOGOFF-TEXT,
  9891           LOGOFF-LENGTH,
  9892           DFHEIV99,
  9893           DFHEIV99,
  9894           DFHEIV99,
  9895           DFHEIV99,
  9896           DFHEIV99,
  9897           DFHEIV99,
  9898           DFHEIV99,
  9899           DFHEIV99,
  9900           DFHEIV99,
  9901           DFHEIV99
  9902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9903
  9904
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 206
* EL650.cbl
  9905
  9906* EXEC CICS  RETURN
  9907*    END-EXEC.
  9908*    MOVE '.(                    &   #00008555' TO DFHEIV0
  9909     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9910     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9911     MOVE X'2020233030303038353535' TO DFHEIV0(25:11)
  9912     CALL 'kxdfhei1' USING DFHEIV0,
  9913           DFHEIV99,
  9914           DFHEIV99,
  9915           DFHEIV99,
  9916           DFHEIV99,
  9917           DFHEIV99
  9918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9919
  9920
  9921 8400-LOG-JOURNAL-RECORD.
  9922*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  9923*    MOVE FILE-ID                TO  JP-FILE-ID.
  9924*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  9925*
  9926*    IF PI-JOURNAL-FILE-ID  NOT =  ZERO
  9927*        EXEC CICS  JOURNAL
  9928*            JFILEID  (PI-JOURNAL-FILE-ID)
  9929*            JTYPEID  ('ER')
  9930*            FROM     (JOURNAL-RECORD)
  9931*            LENGTH   (2023)
  9932*        END-EXEC.
  9933
  9934 8600-DEEDIT.
  9935
  9936* EXEC CICS  BIF DEEDIT
  9937*        FIELD   (WS-DEEDIT-FIELD)
  9938*        LENGTH  (10)
  9939*    END-EXEC.
  9940     MOVE 10
  9941       TO DFHEIV11
  9942*    MOVE '@"L                   #   #00008572' TO DFHEIV0
  9943     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9944     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9945     MOVE X'2020233030303038353732' TO DFHEIV0(25:11)
  9946     CALL 'kxdfhei1' USING DFHEIV0,
  9947           WS-DEEDIT-FIELD,
  9948           DFHEIV11
  9949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9950
  9951 8600-EXIT.
  9952      EXIT.
  9953 8800-UNAUTHORIZED-ACCESS.
  9954     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  9955
  9956     GO TO 8300-SEND-TEXT.
  9957
  9958 8810-PF23.
  9959     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  9960     MOVE XCTL-005               TO  PGM-NAME.
  9961
  9962     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 207
* EL650.cbl
  9963
  9964 8900-PF5.
  9965     IF PI-PREV-VG-ACCOUNT EQUAL LOW-VALUES OR SPACES
  9966         MOVE ER-3785            TO  EMI-ERROR
  9967         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9968         MOVE -1                 TO  MAINTL
  9969         GO TO 8200-SEND-DATAONLY.
  9970
  9971     MOVE PI-PREV-VG-ACCOUNT     TO  PI-ACCT-CCGSA-KEY.
  9972
  9973     MOVE XCTL-6509              TO  PGM-NAME.
  9974
  9975     GO TO 9300-XCTL.
  9976
  9977 8910-PF6.
  9978     IF PI-PREV-VG-ACCOUNT EQUAL LOW-VALUES OR SPACES
  9979        MOVE ER-3785             TO EMI-ERROR
  9980        PERFORM 9900-ERROR-FORMAT
  9981                                 THRU 9900-EXIT
  9982        MOVE -1                  TO MAINTL
  9983        GO TO 8200-SEND-DATAONLY
  9984     END-IF
  9985     MOVE PI-PREV-VG-ACCOUNT     TO PI-ACCT-CCGSA-KEY
  9986     MOVE XCTL-6503              TO PGM-NAME
  9987     GO TO 9300-XCTL
  9988     .
  9989 9100-RETURN-TRAN.
  9990     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  9991     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  9992
  9993* EXEC CICS  RETURN
  9994*        TRANSID   (TRANS-ID)
  9995*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9996*        LENGTH    (WS-COMM-LENGTH)
  9997*    END-EXEC.
  9998*    MOVE '.(CT                  &   #00008617' TO DFHEIV0
  9999     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10000     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10001     MOVE X'2020233030303038363137' TO DFHEIV0(25:11)
 10002     CALL 'kxdfhei1' USING DFHEIV0,
 10003           TRANS-ID,
 10004           PROGRAM-INTERFACE-BLOCK,
 10005           WS-COMM-LENGTH,
 10006           DFHEIV99,
 10007           DFHEIV99
 10008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10009
 10010
 10011 9200-RETURN-MAIN-MENU.
 10012     MOVE XCTL-126               TO  PGM-NAME.
 10013
 10014     GO TO 9300-XCTL.
 10015
 10016 9300-XCTL.
 10017
 10018* EXEC CICS  XCTL
 10019*        PROGRAM   (PGM-NAME)
 10020*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 208
* EL650.cbl
 10021*        LENGTH    (WS-COMM-LENGTH)
 10022*    END-EXEC.
 10023*    MOVE '.$C                   $   #00008629' TO DFHEIV0
 10024     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10025     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10026     MOVE X'2020233030303038363239' TO DFHEIV0(25:11)
 10027     CALL 'kxdfhei1' USING DFHEIV0,
 10028           PGM-NAME,
 10029           PROGRAM-INTERFACE-BLOCK,
 10030           WS-COMM-LENGTH
 10031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10032
 10033
 10034 9400-CLEAR.
 10035     MOVE SPACES                 TO  PI-SV-MAINT.
 10036     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10037
 10038     GO TO 9300-XCTL.
 10039
 10040 9500-PF12.
 10041     MOVE XCTL-010               TO  PGM-NAME.
 10042
 10043     GO TO 9300-XCTL.
 10044
 10045 9600-PGMID-ERROR.
 10046
 10047* EXEC CICS  HANDLE CONDITION
 10048*        PGMIDERR  (8300-SEND-TEXT)
 10049*    END-EXEC.
 10050*    MOVE '"$L                   ! ? #00008647' TO DFHEIV0
 10051     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10052     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10053     MOVE X'3F20233030303038363437' TO DFHEIV0(25:11)
 10054     CALL 'kxdfhei1' USING DFHEIV0
 10055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10056
 10057
 10058     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10059     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10060     MOVE XCTL-005               TO  PGM-NAME.
 10061     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10062     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10063
 10064     GO TO 9300-XCTL.
 10065
 10066 9700-DATE-CONVERSION.
 10067     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10068
 10069
 10070* EXEC CICS  LINK
 10071*        PROGRAM   (PGM-NAME)
 10072*        COMMAREA  (DATE-CONVERSION-DATA)
 10073*        LENGTH    (DC-COMM-LENGTH)
 10074*    END-EXEC.
 10075*    MOVE '."C                   ''   #00008662' TO DFHEIV0
 10076     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10077     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10078     MOVE X'2020233030303038363632' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 209
* EL650.cbl
 10079     CALL 'kxdfhei1' USING DFHEIV0,
 10080           PGM-NAME,
 10081           DATE-CONVERSION-DATA,
 10082           DC-COMM-LENGTH,
 10083           DFHEIV99,
 10084           DFHEIV99,
 10085           DFHEIV99
 10086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10087
 10088
 10089 9900-ERROR-FORMAT.
 10090     IF NOT EMI-ERRORS-COMPLETE
 10091         MOVE LINK-001           TO  PGM-NAME
 10092
 10093* EXEC CICS  LINK
 10094*            PROGRAM   (PGM-NAME)
 10095*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 10096*            LENGTH    (EMI-COMM-LENGTH)
 10097*        END-EXEC.
 10098*    MOVE '."C                   ''   #00008671' TO DFHEIV0
 10099     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10100     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10101     MOVE X'2020233030303038363731' TO DFHEIV0(25:11)
 10102     CALL 'kxdfhei1' USING DFHEIV0,
 10103           PGM-NAME,
 10104           ERROR-MESSAGE-INTERFACE-BLOCK,
 10105           EMI-COMM-LENGTH,
 10106           DFHEIV99,
 10107           DFHEIV99,
 10108           DFHEIV99
 10109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10110
 10111
 10112 9900-EXIT.
 10113     EXIT.
 10114
 10115 9990-ABEND.
 10116     MOVE LINK-004               TO  PGM-NAME.
 10117     MOVE DFHEIBLK               TO  EMI-LINE1.
 10118
 10119
 10120* EXEC CICS  LINK
 10121*        PROGRAM   (PGM-NAME)
 10122*        COMMAREA  (EMI-LINE1)
 10123*        LENGTH    (72)
 10124*    END-EXEC.
 10125     MOVE 72
 10126       TO DFHEIV11
 10127*    MOVE '."C                   ''   #00008684' TO DFHEIV0
 10128     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10129     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10130     MOVE X'2020233030303038363834' TO DFHEIV0(25:11)
 10131     CALL 'kxdfhei1' USING DFHEIV0,
 10132           PGM-NAME,
 10133           EMI-LINE1,
 10134           DFHEIV11,
 10135           DFHEIV99,
 10136           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 210
* EL650.cbl
 10137           DFHEIV99
 10138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10139
 10140
 10141     MOVE -1                     TO  MAINTL.
 10142
 10143     GO TO 8200-SEND-DATAONLY.
 10144
 10145 9995-SECURITY-VIOLATION.
 10146*                            COPY ELCSCTP.
 10147******************************************************************
 10148*                                                                *
 10149*                            ELCSCTP                             *
 10150*                            VMOD=2.001                          *
 10151*                                                                *
 10152*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10153******************************************************************
 10154
 10155
 10156     MOVE EIBDATE          TO SM-JUL-DATE.
 10157     MOVE EIBTRMID         TO SM-TERMID.
 10158     MOVE THIS-PGM         TO SM-PGM.
 10159     MOVE EIBTIME          TO TIME-IN.
 10160     MOVE TIME-OUT         TO SM-TIME.
 10161     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10162
 10163
 10164* EXEC CICS LINK
 10165*         PROGRAM  ('EL003')
 10166*         COMMAREA (SECURITY-MESSAGE)
 10167*         LENGTH   (80)
 10168*    END-EXEC.
 10169     MOVE 'EL003' TO DFHEIV1
 10170     MOVE 80
 10171       TO DFHEIV11
 10172*    MOVE '."C                   ''   #00008712' TO DFHEIV0
 10173     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10174     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10175     MOVE X'2020233030303038373132' TO DFHEIV0(25:11)
 10176     CALL 'kxdfhei1' USING DFHEIV0,
 10177           DFHEIV1,
 10178           SECURITY-MESSAGE,
 10179           DFHEIV11,
 10180           DFHEIV99,
 10181           DFHEIV99,
 10182           DFHEIV99
 10183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10184
 10185
 10186******************************************************************
 10187
 10188
 10189 9995-EXIT.
 10190     EXIT.
 10191
 10192 9999-DFHBACK SECTION.
 10193     MOVE '9%                    "   ' TO DFHEIV0
 10194     MOVE 'EL650' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 211
* EL650.cbl
 10195     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10196     GOBACK.
 10197 9999-DFHEXIT.
 10198     IF DFHEIGDJ EQUAL 0001
 10199         NEXT SENTENCE
 10200     ELSE IF DFHEIGDJ EQUAL 2
 10201         GO TO 5340-END,
 10202               5330-NOT-FOUND
 10203         DEPENDING ON DFHEIGDI
 10204     ELSE IF DFHEIGDJ EQUAL 3
 10205         GO TO 9600-PGMID-ERROR,
 10206               9990-ABEND
 10207         DEPENDING ON DFHEIGDI
 10208     ELSE IF DFHEIGDJ EQUAL 4
 10209         GO TO 1010-NOT-FOUND,
 10210               1010-NOT-FOUND
 10211         DEPENDING ON DFHEIGDI
 10212     ELSE IF DFHEIGDJ EQUAL 5
 10213         GO TO 2568-NO-RECORDS,
 10214               2568-NO-RECORDS
 10215         DEPENDING ON DFHEIGDI
 10216     ELSE IF DFHEIGDJ EQUAL 6
 10217         GO TO 3175-CONTINUE,
 10218               3175-CONTINUE
 10219         DEPENDING ON DFHEIGDI
 10220     ELSE IF DFHEIGDJ EQUAL 7
 10221         GO TO 4175-CONTINUE,
 10222               4175-CONTINUE
 10223         DEPENDING ON DFHEIGDI
 10224     ELSE IF DFHEIGDJ EQUAL 8
 10225         GO TO 4530-NOT-FOUND,
 10226               4530-NOT-FOUND
 10227         DEPENDING ON DFHEIGDI
 10228     ELSE IF DFHEIGDJ EQUAL 9
 10229         GO TO 4699-EXIT,
 10230               4689-EOF
 10231         DEPENDING ON DFHEIGDI
 10232     ELSE IF DFHEIGDJ EQUAL 10
 10233         GO TO 4899-EXIT,
 10234               4889-EOF
 10235         DEPENDING ON DFHEIGDI
 10236     ELSE IF DFHEIGDJ EQUAL 11
 10237         GO TO 4580-DUPREC,
 10238               4580-DUPREC
 10239         DEPENDING ON DFHEIGDI
 10240     ELSE IF DFHEIGDJ EQUAL 12
 10241         GO TO 4959-EXIT,
 10242               4959-EXIT
 10243         DEPENDING ON DFHEIGDI
 10244     ELSE IF DFHEIGDJ EQUAL 13
 10245         GO TO 4969-EXIT,
 10246               4969-EXIT
 10247         DEPENDING ON DFHEIGDI
 10248     ELSE IF DFHEIGDJ EQUAL 14
 10249         GO TO 4980-EXIT
 10250         DEPENDING ON DFHEIGDI
 10251     ELSE IF DFHEIGDJ EQUAL 15
 10252         GO TO 5007-EXIT,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 212
* EL650.cbl
 10253               5007-EXIT
 10254         DEPENDING ON DFHEIGDI
 10255     ELSE IF DFHEIGDJ EQUAL 16
 10256         GO TO 5007-EXIT,
 10257               5007-EXIT,
 10258               5007-EXIT,
 10259               5007-EXIT,
 10260               5007-EXIT
 10261         DEPENDING ON DFHEIGDI
 10262     ELSE IF DFHEIGDJ EQUAL 17
 10263         GO TO 5015-NOT-FOUND,
 10264               5015-NOT-FOUND
 10265         DEPENDING ON DFHEIGDI
 10266     ELSE IF DFHEIGDJ EQUAL 18
 10267         GO TO 5015-NOT-FOUND,
 10268               5015-NOT-FOUND
 10269         DEPENDING ON DFHEIGDI
 10270     ELSE IF DFHEIGDJ EQUAL 19
 10271         GO TO 5340-END,
 10272               5330-NOT-FOUND
 10273         DEPENDING ON DFHEIGDI
 10274     ELSE IF DFHEIGDJ EQUAL 20
 10275         GO TO 5440-NOT-FOUND,
 10276               5430-NOT-FOUND
 10277         DEPENDING ON DFHEIGDI
 10278     ELSE IF DFHEIGDJ EQUAL 21
 10279         GO TO 5525-SKIP-REWRITE,
 10280               5525-SKIP-REWRITE
 10281         DEPENDING ON DFHEIGDI
 10282     ELSE IF DFHEIGDJ EQUAL 22
 10283         GO TO 5615-SKIP-REWRITE,
 10284               5615-SKIP-REWRITE
 10285         DEPENDING ON DFHEIGDI
 10286     ELSE IF DFHEIGDJ EQUAL 23
 10287         GO TO 6599-EXIT
 10288         DEPENDING ON DFHEIGDI
 10289     ELSE IF DFHEIGDJ EQUAL 24
 10290         GO TO 6699-EXIT
 10291         DEPENDING ON DFHEIGDI
 10292     ELSE IF DFHEIGDJ EQUAL 25
 10293         GO TO 6720-NO-CARRIER
 10294         DEPENDING ON DFHEIGDI
 10295     ELSE IF DFHEIGDJ EQUAL 26
 10296         GO TO 6780-NO-STATE
 10297         DEPENDING ON DFHEIGDI
 10298     ELSE IF DFHEIGDJ EQUAL 27
 10299         GO TO 6880-NO-COMP
 10300         DEPENDING ON DFHEIGDI
 10301     ELSE IF DFHEIGDJ EQUAL 28
 10302         GO TO 7200-EXIT,
 10303               7200-EXIT
 10304         DEPENDING ON DFHEIGDI
 10305     ELSE IF DFHEIGDJ EQUAL 29
 10306         GO TO 7300-EXIT,
 10307               7300-EXIT
 10308         DEPENDING ON DFHEIGDI
 10309     ELSE IF DFHEIGDJ EQUAL 30
 10310         GO TO 7400-EXIT,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 213
* EL650.cbl
 10311               7400-EXIT
 10312         DEPENDING ON DFHEIGDI
 10313     ELSE IF DFHEIGDJ EQUAL 31
 10314         GO TO 8300-SEND-TEXT
 10315         DEPENDING ON DFHEIGDI.
 10316     MOVE '9%                    "   ' TO DFHEIV0
 10317     MOVE 'EL650' TO DFHEIV1
 10318     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10319     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       40180     Code:       34501
