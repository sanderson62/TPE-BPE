* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   1
* EL652.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL652.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL652.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL652 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 09/14/94 07:57:28.
     7*                            VMOD=2.059
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11*
    12*REMARKS.
    13*        TRANSACTION - EXD4 - COMPENSATION MASTER MAINT
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   2
* EL652.cbl
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    24* 102202    2002032200002  SMVA  ADD PF8 KEY FOR COMP MSTR NOTES
    25* 111103    2003080800002  PEMA  ADD BANKFEE,CLPST,MAXFEE  & PF10
    26*                                FOR SECURE PAY
    27* 111204    2004110300005  PEMA  SPLIT AGENT COMMISSION CHANGES
    28* 033105    2005031100003  PEMA  ADD VALID TYPE OF 'B' (BANK)
    29* 042005    2005031100004  PEMA  ALLOW UPDATES TO PCONT FOR 'B'
    30* 042005                         AND 'G' RECORD TYPES.
    31* 092205    2005050300006  PEMA  ADD LEASE FEES
    32* 041106    2006022800001  AJRA  INIT CO-FIRST-WRITTEN-DT ON ADD
    33* 060506    2002061100007  PEMA  ADD CODES TO ERCOMP FILE
    34* 072406    2006022400001  PEMA  ADD REFUND ONLY EDIT
    35* 110706  CR2006071700002  PEMA  FIX NAME LOOK UP
    36* 043007  IR2007042600002  PEMA  TURN OFF YTDCOMM ATTR
    37* 102908  CR2007052100005  PEMA  UNPROT PCONT ATTRB
    38* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    39******************************************************************
    40
    41 ENVIRONMENT DIVISION.
    42 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   3
* EL652.cbl
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46 77  FILLER  PIC X(32)  VALUE '********************************'.
    47 77  FILLER  PIC X(32)  VALUE '*    EL652 WORKING STORAGE     *'.
    48 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.059 *********'.
    49 77  WS-TOT-FEES                 PIC S9(3)V99 COMP-3 VALUE +0.
    50 77  S1                          PIC S999 VALUE +0 COMP-3.
    51
    52 01  WS-DATE-AREA.
    53     12  SAVE-DATE           PIC  X(8)       VALUE SPACES.
    54     12  SAVE-BIN-DATE       PIC  XX         VALUE SPACES.
    55
    56 01  STANDARD-AREAS.
    57     12  WS-RESPONSE             PIC S9(8)   COMP.
    58         88  RESP-NORMAL                  VALUE +00.
    59         88  RESP-NOTFND                  VALUE +13.
    60         88  RESP-NOTOPEN                 VALUE +19.
    61         88  RESP-ENDFILE                 VALUE +20.
    62     12  RETURNED-FROM       PIC X(8)        VALUE SPACES.
    63     12  QID-PI.
    64         16  QID-TERM        PIC X(4).
    65         16  FILLER          PIC X(4)        VALUE '652A'.
    66     12  QID-ITEM            PIC S9(4) COMP  VALUE +0001.
    67     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
    68     12  MAP-NAME            PIC  X(8)       VALUE 'EL652A'.
    69     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL652S'.
    70     12  TRANS-ID            PIC  X(4)       VALUE 'EXD4'.
    71     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
    72     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
    73     12  EL633-TRANS-ID      PIC  X(4)       VALUE 'EXB7'.
    74     12  EL633DMD-TRANS-ID   PIC  X(4)       VALUE 'EX1F'.
    75     12  EL635-TRANS-ID      PIC  X(4)       VALUE 'EXJ4'.
    76     12  EL6501-TRANS-ID     PIC  X(4)       VALUE 'EXC5'.
    77     12  EL6592-TRANS-ID     PIC  X(4)       VALUE 'EX66'.
    78     12  EL856-TRANS-ID      PIC  X(4)       VALUE 'EXJ8'.
    79     12  EM6508-TRANS-ID     PIC  X(4)       VALUE 'MXG8'.
    80     12  THIS-PGM            PIC  X(8)       VALUE 'EL652'.
    81     12  PGM-NAME            PIC  X(8).
    82     12  WS-COMP-CD-R.
    83         16  FILLER          PIC  X.
    84         16  WS-COMP-CD-X    PIC  X.
    85     12  WS-COMP-CD  REDEFINES
    86         WS-COMP-CD-R        PIC S9(4)                  COMP.
    87     12  TIME-IN             PIC S9(7).
    88     12  TIME-OUT-R  REDEFINES  TIME-IN.
    89         16  FILLER          PIC  X.
    90         16  TIME-OUT        PIC  99V99.
    91         16  FILLER          PIC  XX.
    92     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
    93     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
    94     12  XCTL-126            PIC  X(8)       VALUE 'EL126'.
    95     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
    96     12  XCTL-633            PIC  X(8)       VALUE 'EL633'.
    97     12  XCTL-633DMD         PIC  X(8)       VALUE 'EL633DMD'.
    98     12  XCTL-635            PIC  X(8)       VALUE 'EL635'.
    99     12  XCTL-650            PIC  X(8)       VALUE 'EL650'.
   100     12  XCTL-6521           PIC  X(8)       VALUE 'EL6521'.
   101     12  XCTL-6522           PIC  X(8)       VALUE 'EL6522'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   4
* EL652.cbl
   102     12  XCTL-6523           PIC  X(8)       VALUE 'EL6523'.
   103     12  XCTL-6524           PIC  X(8)       VALUE 'EL6524'.
   104     12  XCTL-689            PIC  X(8)       VALUE 'EL689'.
   105     12  XCTL-690            PIC  X(8)       VALUE 'EL690'.
   106     12  XCTL-856            PIC  X(8)       VALUE 'EL856'.
   107     12  XCTL-EM626          PIC  X(8)       VALUE 'EM626'.
   108     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   109     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   110     12  LINK-ELDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   111     12  FILE-ID             PIC  X(8)       VALUE SPACES.
   112     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   113     12  NAME-FILE-ID        PIC  X(8)       VALUE 'ERNAME'.
   114     12  CNTL-FILE-ID        PIC  X(8)       VALUE 'ELCNTL'.
   115     12  SUMM-FILE-ID        PIC  X(8)       VALUE 'ERSUMM'.
   116     12  RQST-FILE-ID        PIC  X(8)       VALUE 'ERRQST'.
   117     12  RQST-FILE-ID-3      PIC  X(8)       VALUE 'ERRQST3'.
   118
   119 01  MISC-WORK-AREAS.
   120     12  WS-SRCH-STATE       PIC X(30)  VALUE SPACES.
   121     12  STNDX               PIC S999   COMP-3 VALUE +0.
   122     12  W-APPL-SCRTY-NDX    PIC S9(04) COMP   VALUE +35.
   123     12  WS-PHONE-IN         PIC  9(10).
   124     12  WS-PHONE-IN-R  REDEFINES  WS-PHONE-IN.
   125         16  WSPI-AREA       PIC  X(3).
   126         16  WSPI-PFX        PIC  X(3).
   127         16  WSPI-SFX        PIC  X(4).
   128     12  WS-PHONE-OUT.
   129         16  WSPO-AREA       PIC  X(3).
   130         16  FILLER          PIC  X            VALUE '-'.
   131         16  WSPO-PFX        PIC  X(3).
   132         16  FILLER          PIC  X            VALUE '-'.
   133         16  WSPO-SFX        PIC  X(4).
   134     12  DEEDIT-FIELD        PIC  X(15).
   135     12  DEEDIT-FIELD-V0  REDEFINES
   136         DEEDIT-FIELD        PIC S9(15).
   137     12  DEEDIT-FIELD-V1  REDEFINES
   138         DEEDIT-FIELD        PIC S9(13)V99.
   139     12  SUB1                PIC S9(4)         VALUE +0   COMP.
   140     12  SUB2                PIC S9(4)         VALUE +0   COMP.
   141     12  SC-ITEM-CL-CR       PIC S9(4)         VALUE +1   COMP.
   142     12  ERCOMP-LENGTH       PIC S9(4)         VALUE +700 COMP.
   143     12  ERSUMM-LENGTH       PIC S9(4)         VALUE +150 COMP.
   144     12  ERNAME-LENGTH       PIC S9(4)         VALUE +160 COMP.
   145     12  SV-CLMTOL           PIC  9(3)V99      VALUE ZEROS.
   146     12  WK-DATE.
   147         16  WK-MO           PIC  99.
   148         16  WK-DA           PIC  99.
   149         16  WK-YR           PIC  99.
   150     12  DATE-TEST-AREA      PIC  9(6).
   151     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   152         16  DATE-TEST-MM    PIC  99.
   153         16  DATE-TEST-DD    PIC  99.
   154         16  DATE-TEST-YY    PIC  99.
   155     12  DIVIDE-RESULT       PIC  99.
   156     12  DIVIDE-REMAINDER    PIC  9.
   157     12  WS-ZERO             PIC  X            VALUE '0'.
   158     12  WS-ONE              PIC  X            VALUE '1'.
   159     12  WS-TWO              PIC  X            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   5
* EL652.cbl
   160     12  WS-ACCESS.
   161         16  FILLER          PIC  X(3)         VALUE SPACES.
   162         16  WS-CARRIER      PIC  X.
   163     12  BIN-CURRENT-SAVE    PIC  XX.
   164     12  WS-BROWSE-SW        PIC  X.
   165         88  BROWSE-STARTED                    VALUE 'Y'.
   166     12  WS-SAVE-KEY         PIC  X(29)        VALUE SPACES.
   167     12  WS-SAVE-SUMM        PIC  X(6)         VALUE SPACES.
   168     12  WS-SUMM-FOR-RQST    PIC  X(6)         VALUE SPACES.
   169     12  WS-SAVE-RQST        PIC X(46)         VALUE SPACES.
   170     12  WS-SHOW-SAVE-TOTALS PIC  X            VALUE SPACE.
   171         88  SHOW-SAVE-TOTALS                  VALUE 'Y'.
   172     12  ELCNTL-KEY.
   173         16  CNTL-COMP-ID    PIC  X(3)         VALUE SPACES.
   174         16  CNTL-REC-TYPE   PIC  X            VALUE SPACES.
   175         16  CNTL-ACCESS     PIC  X(4)         VALUE SPACES.
   176         16  CNTL-SEQ-NO     PIC S9(4)         VALUE +0   COMP.
   177     12  ELCNTL-KEY2.
   178         16  CNTL-COMP-ID-2  PIC  X(3)         VALUE SPACES.
   179         16  CNTL-REC-TYPE-2 PIC  X            VALUE SPACES.
   180         16  CNTL-STATE-2    PIC  X(2)         VALUE SPACES.
   181         16  FILLER          PIC  X(2)         VALUE SPACES.
   182         16  CNTL-SEQ-NO-2   PIC S9(4)         VALUE +0   COMP.
   183     12  ERSUMM-KEY.
   184         16  SUMM-COMP-ID    PIC  X            VALUE SPACES.
   185         16  SUMM-SUMMARY    PIC  X(6)         VALUE SPACES.
   186         16  SUMM-CARRIER    PIC  X            VALUE SPACES.
   187         16  SUMM-GROUP      PIC  X(6)         VALUE SPACES.
   188         16  SUMM-FIN-RESP   PIC  X(10)        VALUE SPACES.
   189         16  SUMM-ACCT-AGENT PIC  X(10)        VALUE SPACES.
   190     12  ERRQST-KEY.
   191         16  RQST-COMP-ID-PC PIC  X            VALUE SPACES.
   192         16  RQST-BATCH-PC   PIC  X(6)         VALUE SPACES.
   193     12  ERRQST-KEY-3.
   194         16  RQST-COMP-ID    PIC  X            VALUE SPACES.
   195         16  RQST-CARRIER    PIC  X            VALUE SPACES.
   196         16  RQST-GROUP      PIC  X(6)         VALUE SPACES.
   197         16  RQST-FIN-RESP   PIC  X(10)        VALUE SPACES.
   198         16  RQST-ACCT-AGENT PIC  X(10)        VALUE SPACES.
   199         16  RQST-REFERENCE  PIC  X(12)        VALUE SPACES.
   200         16  RQST-BATCH      PIC  X(06)        VALUE SPACES.
   201     12  WS-DATE-MDY-8.
   202         16  WS-DMDY8-MM     PIC  XX.
   203         16  WS-DMDY8-SL1    PIC  X.
   204         16  WS-DMDY8-DD     PIC  XX.
   205         16  WS-DMDY8-SL2    PIC  X.
   206         16  WS-DMDY8-YY     PIC  XX.
   207     12  WS-DATE-MDY-6  REDEFINES  WS-DATE-MDY-8.
   208         16  WS-DMDY6-MM     PIC  XX.
   209         16  WS-DMDY6-DD     PIC  XX.
   210         16  WS-DMDY6-YY     PIC  XX.
   211         16  WS-DMDY6-BLNK   PIC  XX.
   212     12  WS-YMD-DATE.
   213         16  WS-YMD-YY       PIC  XX.
   214         16  WS-YMD-MM       PIC  XX.
   215         16  WS-YMD-DD       PIC  XX.
   216     12  WS-YMD-DATE-NUM  REDEFINES
   217         WS-YMD-DATE         PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   6
* EL652.cbl
   218     12  WS-SAVE-SUMMARY     PIC X(6)          VALUE SPACES.
   219     12  WS-SAVE-NAME        PIC X(30)         VALUE SPACES.
   220     12  WS-SAVE-BALFWD      PIC S9(7)V99      VALUE +0   COMP-3.
   221     12  WS-SAVE-CURCOM      PIC S9(7)V99      VALUE +0   COMP-3.
   222     12  WS-SAVE-CURCHG      PIC S9(7)V99      VALUE +0   COMP-3.
   223     12  WS-SAVE-CURPMT      PIC S9(7)V99      VALUE +0   COMP-3.
   224     12  WS-SAVE-ENDBAL      PIC S9(7)V99      VALUE +0   COMP-3.
   225     12  WS-SAVE-YTDCOM      PIC S9(7)V99      VALUE +0   COMP-3.
   226     12  WS-SOC-SEC-WORK-FIELD.
   227         16  WS-SS-TYPE          PIC X.
   228         16  WS-SOC-SEC          PIC X(12).
   229
   230     12  WS-ZIP-CODE.
   231         16  WS-ZIP-1            PIC X.
   232             88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
   233         16  WS-ZIP-2-3          PIC XX.
   234         16  WS-ZIP-4            PIC X.
   235         16  WS-ZIP-5            PIC X.
   236         16  WS-ZIP-6            PIC X.
   237         16  FILLER              PIC X(4).
   238     12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
   239         16  WS-ZIP-AM-1-CODE    PIC X(5).
   240         16  WS-ZIP-AM-1-PLUS4   PIC X(4).
   241         16  FILLER              PIC X.
   242     12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
   243         16  WS-ZIP-AM-2-CODE    PIC X(5).
   244         16  WS-ZIP-AM-2-DASH    PIC X.
   245         16  WS-ZIP-AM-2-PLUS4   PIC X(4).
   246     12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
   247         16  WS-ZIP-CAN-1-POST1  PIC XXX.
   248         16  WS-ZIP-CAN-1-POST2  PIC XXX.
   249         16  FILLER              PIC X(4).
   250     12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
   251         16  WS-ZIP-CAN-2-POST1  PIC XXX.
   252         16  FILLER              PIC X.
   253         16  WS-ZIP-CAN-2-POST2  PIC XXX.
   254         16  FILLER              PIC XXX.
   255
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   7
* EL652.cbl
   257 01  ERROR-NUMBERS.
   258     12  ER-0000             PIC  X(4)       VALUE '0000'.
   259     12  ER-0002             PIC  X(4)       VALUE '0002'.
   260     12  ER-0004             PIC  X(4)       VALUE '0004'.
   261     12  ER-0008             PIC  X(4)       VALUE '0008'.
   262     12  ER-0029             PIC  X(4)       VALUE '0029'.
   263     12  ER-0033             PIC  X(4)       VALUE '0033'.
   264     12  ER-0035             PIC  X(4)       VALUE '0035'.
   265     12  ER-0046             PIC  X(4)       VALUE '0046'.
   266     12  ER-0068             PIC  X(4)       VALUE '0068'.
   267     12  ER-0070             PIC  X(4)       VALUE '0070'.
   268     12  ER-0142             PIC  X(4)       VALUE '0142'.
   269     12  ER-0144             PIC  X(4)       VALUE '0144'.
   270     12  ER-0187             PIC  X(4)       VALUE '0187'.
   271     12  ER-0193             PIC  X(4)       VALUE '0193'.
   272     12  ER-0314             PIC  X(4)       VALUE '0314'.
   273     12  ER-0584             PIC  X(4)       VALUE '0584'.
   274     12  ER-0829             PIC  X(4)       VALUE '0829'.
   275     12  ER-1299             PIC  X(4)       VALUE '1299'.
   276     12  ER-1778             PIC  X(4)       VALUE '1778'.
   277     12  ER-1883             PIC  X(4)       VALUE '1883'.
   278     12  ER-2039             PIC  X(4)       VALUE '2039'.
   279     12  ER-2042             PIC  X(4)       VALUE '2042'.
   280     12  ER-2045             PIC  X(4)       VALUE '2045'.
   281     12  ER-2046             PIC  X(4)       VALUE '2046'.
   282     12  ER-2047             PIC  X(4)       VALUE '2047'.
   283     12  ER-2048             PIC  X(4)       VALUE '2048'.
   284     12  ER-2049             PIC  X(4)       VALUE '2049'.
   285     12  ER-2050             PIC  X(4)       VALUE '2050'.
   286     12  ER-2055             PIC  X(4)       VALUE '2055'.
   287     12  ER-2056             PIC  X(4)       VALUE '2056'.
   288     12  ER-2057             PIC  X(4)       VALUE '2057'.
   289     12  ER-2067             PIC  X(4)       VALUE '2067'.
   290     12  ER-2088             PIC  X(4)       VALUE '2088'.
   291     12  ER-2089             PIC  X(4)       VALUE '2089'.
   292     12  ER-2091             PIC  X(4)       VALUE '2091'.
   293     12  ER-2092             PIC  X(4)       VALUE '2092'.
   294     12  ER-2093             PIC  X(4)       VALUE '2093'.
   295     12  ER-2094             PIC  X(4)       VALUE '2094'.
   296     12  ER-2095             PIC  X(4)       VALUE '2095'.
   297     12  ER-2096             PIC  X(4)       VALUE '2096'.
   298     12  ER-2097             PIC  X(4)       VALUE '2097'.
   299     12  ER-2209             PIC  X(4)       VALUE '2209'.
   300     12  ER-2238             PIC  X(4)       VALUE '2238'.
   301     12  ER-2370             PIC  X(4)       VALUE '2370'.
   302     12  ER-2572             PIC  X(4)       VALUE '2572'.
   303     12  ER-2717             PIC  X(4)       VALUE '2717'.
   304     12  ER-2790             PIC  X(4)       VALUE '2790'.
   305     12  ER-2872             PIC  X(4)       VALUE '2872'.
   306     12  ER-3021             PIC  X(4)       VALUE '3021'.
   307     12  ER-3053             PIC  X(4)       VALUE '3053'.
   308     12  ER-3055             PIC  X(4)       VALUE '3055'.
   309     12  ER-3056             PIC  X(4)       VALUE '3056'.
   310     12  ER-3150             PIC  X(4)       VALUE '3150'.
   311     12  ER-3151             PIC  X(4)       VALUE '3151'.
   312     12  ER-3152             PIC  X(4)       VALUE '3152'.
   313     12  ER-3153             PIC  X(4)       VALUE '3153'.
   314     12  ER-3154             PIC  X(4)       VALUE '3154'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   8
* EL652.cbl
   315     12  ER-3168             PIC  X(4)       VALUE '3168'.
   316     12  ER-3170             PIC  X(4)       VALUE '3170'.
   317     12  ER-3174             PIC  X(4)       VALUE '3174'.
   318     12  ER-3261             PIC  X(4)       VALUE '3261'.
   319     12  ER-9096             PIC  X(4)       VALUE '9096'.
   320     12  ER-9097             PIC  X(4)       VALUE '9097'.
   321     12  ER-9999             PIC  X(4)       VALUE '9999'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   9
* EL652.cbl
   323*                          COPY ELCSCTM.
   324******************************************************************
   325*                                                                *
   326*                                                                *
   327*                            ELCSCTM                             *
   328*                            VMOD=2.001                          *
   329*                                                                *
   330*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   331*                                                                *
   332******************************************************************
   333 01  SECURITY-MESSAGE.
   334     12  FILLER                          PIC X(30)
   335            VALUE '** LOGIC SECURITY VIOLATION -'.
   336     12  SM-READ                         PIC X(6).
   337     12  FILLER                          PIC X(5)
   338            VALUE ' PGM='.
   339     12  SM-PGM                          PIC X(6).
   340     12  FILLER                          PIC X(5)
   341            VALUE ' OPR='.
   342     12  SM-PROCESSOR-ID                 PIC X(4).
   343     12  FILLER                          PIC X(6)
   344            VALUE ' TERM='.
   345     12  SM-TERMID                       PIC X(4).
   346     12  FILLER                          PIC XX   VALUE SPACE.
   347     12  SM-JUL-DATE                     PIC 9(5).
   348     12  FILLER                          PIC X    VALUE SPACE.
   349     12  SM-TIME                         PIC 99.99.
   350
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  10
* EL652.cbl
   352*                          COPY ELCSCRTY.
   353******************************************************************
   354*                                                                *
   355*                                                                *
   356*                            ELCSCRTY                            *
   357*                            VMOD=2.001                          *
   358*                                                                *
   359*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   360*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   361*        SAVED IN PI-SECURITY-ADDRESS.                           *
   362*                                                                *
   363******************************************************************
   364 01  SECURITY-CONTROL.
   365     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   366     12  FILLER                       PIC XX    VALUE 'SC'.
   367     12  SC-CREDIT-CODES.
   368         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   369             20  SC-CREDIT-DISPLAY    PIC X.
   370             20  SC-CREDIT-UPDATE     PIC X.
   371     12  SC-CLAIMS-CODES.
   372         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   373             20  SC-CLAIMS-DISPLAY    PIC X.
   374             20  SC-CLAIMS-UPDATE     PIC X.
   375*                          COPY MPCSCRT.
   376******************************************************************
   377*                                                                *
   378*                            MPCSCRT                             *
   379*                            VMOD=1.001                          *
   380*                                                                *
   381*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   382*        ACQUIRED BY SIGN-ON PROGRAM EL125.                      *
   383*                                      (MP MORTGAGE PROTECTION)  *
   384*                                                                *
   385******************************************************************
   386*
   387 01  SECURITY-CONTROL-E.
   388     12  SC-COMM-LENGTH-E             PIC S9(04) VALUE +144 COMP.
   389     12  FILLER                       PIC  X(02) VALUE 'SC'.
   390     12  SC-QUID-KEY.
   391         16  SC-QUID-TERMINAL         PIC  X(04).
   392         16  SC-QUID-SYSTEM           PIC  X(04).
   393     12  SC-ITEM                      PIC S9(04) VALUE +1   COMP.
   394     12  SC-SECURITY-ACCESS-CODE      PIC  X(01).
   395     12  SC-PRODUCER-AUTHORIZED-SW    PIC  X(01).
   396         88 SC-PRODUCER-AUTHORIZED               VALUE ' '.
   397         88 SC-PRODUCER-NOT-AUTHORIZED           VALUE 'N'.
   398     12  SC-MP-CODES.
   399         16  SC-MP-AUTHORIZATION OCCURS 44 TIMES.
   400             20  SC-MP-DISPLAY        PIC  X(01).
   401             20  SC-MP-UPDATE         PIC  X(01).
   402     12  FILLER                       PIC  X(40).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  11
* EL652.cbl
   404 01  FILLER                  PIC X(16)  VALUE ALL 'A'.
   405*                          COPY ELCDATE.
   406******************************************************************
   407*                                                                *
   408*                                                                *
   409*                            ELCDATE.                            *
   410*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   411*                            VMOD=2.003
   412*                                                                *
   413*                                                                *
   414*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   415*                 LENGTH = 200                                   *
   416******************************************************************
   417
   418 01  DATE-CONVERSION-DATA.
   419     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   420     12  DC-OPTION-CODE                PIC X.
   421         88  BIN-TO-GREG                VALUE ' '.
   422         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   423         88  EDIT-GREG-TO-BIN           VALUE '2'.
   424         88  YMD-GREG-TO-BIN            VALUE '3'.
   425         88  MDY-GREG-TO-BIN            VALUE '4'.
   426         88  JULIAN-TO-BIN              VALUE '5'.
   427         88  BIN-PLUS-ELAPSED           VALUE '6'.
   428         88  FIND-CENTURY               VALUE '7'.
   429         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   430         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   431         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   432         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   433         88  JULIAN-TO-BIN-3            VALUE 'C'.
   434         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   435         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   436         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   437         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   438         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   439         88  CHECK-LEAP-YEAR            VALUE 'H'.
   440         88  BIN-3-TO-GREG              VALUE 'I'.
   441         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   442         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   443         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   444         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   445         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   446         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   447         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   448         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   449         88  THREE-CHARACTER-BIN
   450                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   451         88  GREGORIAN-TO-BIN
   452                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   453         88  BIN-TO-GREGORIAN
   454                  VALUES ' ' '1' 'I' '8' 'G'.
   455         88  JULIAN-TO-BINARY
   456                  VALUES '5' 'C' 'E' 'F'.
   457     12  DC-ERROR-CODE                 PIC X.
   458         88  NO-CONVERSION-ERROR        VALUE ' '.
   459         88  DATE-CONVERSION-ERROR
   460                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   461         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  12
* EL652.cbl
   462         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   463         88  DATE-IS-INVALID            VALUE '3'.
   464         88  DATE1-GREATER-DATE2        VALUE '4'.
   465         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   466         88  DATE-INVALID-OPTION        VALUE '9'.
   467         88  INVALID-CENTURY            VALUE 'A'.
   468         88  ONLY-CENTURY               VALUE 'B'.
   469         88  ONLY-LEAP-YEAR             VALUE 'C'.
   470         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   471     12  DC-END-OF-MONTH               PIC X.
   472         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   473     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   474         88  USE-NORMAL-PROCESS         VALUE ' '.
   475         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   476         88  ADJUST-UP-100-YRS          VALUE '2'.
   477     12  FILLER                        PIC X.
   478     12  DC-CONVERSION-DATES.
   479         16  DC-BIN-DATE-1             PIC XX.
   480         16  DC-BIN-DATE-2             PIC XX.
   481         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   482         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   483                       DC-GREG-DATE-1-EDIT.
   484             20  DC-EDIT1-MONTH        PIC 99.
   485             20  SLASH1-1              PIC X.
   486             20  DC-EDIT1-DAY          PIC 99.
   487             20  SLASH1-2              PIC X.
   488             20  DC-EDIT1-YEAR         PIC 99.
   489         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   490         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   491                     DC-GREG-DATE-2-EDIT.
   492             20  DC-EDIT2-MONTH        PIC 99.
   493             20  SLASH2-1              PIC X.
   494             20  DC-EDIT2-DAY          PIC 99.
   495             20  SLASH2-2              PIC X.
   496             20  DC-EDIT2-YEAR         PIC 99.
   497         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   498         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   499                     DC-GREG-DATE-1-YMD.
   500             20  DC-YMD-YEAR           PIC 99.
   501             20  DC-YMD-MONTH          PIC 99.
   502             20  DC-YMD-DAY            PIC 99.
   503         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   504         16  DC-GREG-DATE-1-MDY-R REDEFINES
   505                      DC-GREG-DATE-1-MDY.
   506             20  DC-MDY-MONTH          PIC 99.
   507             20  DC-MDY-DAY            PIC 99.
   508             20  DC-MDY-YEAR           PIC 99.
   509         16  DC-GREG-DATE-1-ALPHA.
   510             20  DC-ALPHA-MONTH        PIC X(10).
   511             20  DC-ALPHA-DAY          PIC 99.
   512             20  FILLER                PIC XX.
   513             20  DC-ALPHA-CENTURY.
   514                 24 DC-ALPHA-CEN-N     PIC 99.
   515             20  DC-ALPHA-YEAR         PIC 99.
   516         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   517         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   518         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   519         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  13
* EL652.cbl
   520         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   521                                       PIC 9(05).
   522         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   523             20  DC-JULIAN-YEAR        PIC 99.
   524             20  DC-JULIAN-DAYS        PIC 999.
   525         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   526         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   527         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   528     12  DATE-CONVERSION-VARIBLES.
   529         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   530         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   531             20  FILLER                PIC 9(3).
   532             20  HOLD-CEN-1-CCYY.
   533                 24  HOLD-CEN-1-CC     PIC 99.
   534                 24  HOLD-CEN-1-YY     PIC 99.
   535             20  HOLD-CEN-1-MO         PIC 99.
   536             20  HOLD-CEN-1-DA         PIC 99.
   537         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   538             20  HOLD-CEN-1-R-MO       PIC 99.
   539             20  HOLD-CEN-1-R-DA       PIC 99.
   540             20  HOLD-CEN-1-R-CCYY.
   541                 24  HOLD-CEN-1-R-CC   PIC 99.
   542                 24  HOLD-CEN-1-R-YY   PIC 99.
   543             20  FILLER                PIC 9(3).
   544         16  HOLD-CENTURY-1-X.
   545             20  FILLER                PIC X(3)  VALUE SPACES.
   546             20  HOLD-CEN-1-X-CCYY.
   547                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   548                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   549             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   550             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   551         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   552             20  HOLD-CEN-1-R-X-MO     PIC XX.
   553             20  HOLD-CEN-1-R-X-DA     PIC XX.
   554             20  HOLD-CEN-1-R-X-CCYY.
   555                 24  HOLD-CEN-1-R-X-CC PIC XX.
   556                 24  HOLD-CEN-1-R-X-YY PIC XX.
   557             20  FILLER                PIC XXX.
   558         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   559         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   560         16  DC-JULIAN-DATE-1          PIC 9(07).
   561         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   562             20  DC-JULIAN-1-CCYY.
   563                 24  DC-JULIAN-1-CC    PIC 99.
   564                 24  DC-JULIAN-1-YR    PIC 99.
   565             20  DC-JULIAN-DA-1        PIC 999.
   566         16  DC-JULIAN-DATE-2          PIC 9(07).
   567         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   568             20  DC-JULIAN-2-CCYY.
   569                 24  DC-JULIAN-2-CC    PIC 99.
   570                 24  DC-JULIAN-2-YR    PIC 99.
   571             20  DC-JULIAN-DA-2        PIC 999.
   572         16  DC-GREG-DATE-A-EDIT.
   573             20  DC-EDITA-MONTH        PIC 99.
   574             20  SLASHA-1              PIC X VALUE '/'.
   575             20  DC-EDITA-DAY          PIC 99.
   576             20  SLASHA-2              PIC X VALUE '/'.
   577             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  14
* EL652.cbl
   578                 24  DC-EDITA-CENT     PIC 99.
   579                 24  DC-EDITA-YEAR     PIC 99.
   580         16  DC-GREG-DATE-B-EDIT.
   581             20  DC-EDITB-MONTH        PIC 99.
   582             20  SLASHB-1              PIC X VALUE '/'.
   583             20  DC-EDITB-DAY          PIC 99.
   584             20  SLASHB-2              PIC X VALUE '/'.
   585             20  DC-EDITB-CCYY.
   586                 24  DC-EDITB-CENT     PIC 99.
   587                 24  DC-EDITB-YEAR     PIC 99.
   588         16  DC-GREG-DATE-CYMD         PIC 9(08).
   589         16  DC-GREG-DATE-CYMD-R REDEFINES
   590                              DC-GREG-DATE-CYMD.
   591             20  DC-CYMD-CEN           PIC 99.
   592             20  DC-CYMD-YEAR          PIC 99.
   593             20  DC-CYMD-MONTH         PIC 99.
   594             20  DC-CYMD-DAY           PIC 99.
   595         16  DC-GREG-DATE-MDCY         PIC 9(08).
   596         16  DC-GREG-DATE-MDCY-R REDEFINES
   597                              DC-GREG-DATE-MDCY.
   598             20  DC-MDCY-MONTH         PIC 99.
   599             20  DC-MDCY-DAY           PIC 99.
   600             20  DC-MDCY-CEN           PIC 99.
   601             20  DC-MDCY-YEAR          PIC 99.
   602    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   603        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   604    12  DC-EL310-DATE                  PIC X(21).
   605    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  15
* EL652.cbl
   607*                          COPY ELCLOGOF.
   608******************************************************************
   609*                                                                *
   610*                                                                *
   611*                            ELCLOGOF.                           *
   612*                            VMOD=2.001                          *
   613*                                                                *
   614*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   615*                                                                *
   616******************************************************************
   617 01  CLASIC-LOGOFF.
   618     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   619     12  LOGOFF-TEXT.
   620         16  FILLER          PIC X(5)    VALUE SPACES.
   621         16  LOGOFF-MSG.
   622             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   623             20  FILLER      PIC X       VALUE SPACES.
   624             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   625         16  FILLER          PIC X(80)
   626           VALUE '* YOU ARE NOW LOGGED OFF'.
   627         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   628         16  FILLER          PIC X       VALUE QUOTE.
   629         16  LOGOFF-SYS-MSG  PIC X(17)
   630           VALUE 'S CLAS-IC SYSTEM '.
   631     12  TEXT-MESSAGES.
   632         16  UNACCESS-MSG    PIC X(29)
   633             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   634         16  PGMIDERR-MSG    PIC X(17)
   635             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  16
* EL652.cbl
   637*                          COPY ELCATTR.
   638******************************************************************
   639*                                                                *
   640*                            ELCATTR.                            *
   641*                            VMOD=2.001                          *
   642*                                                                *
   643*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   644*                                                                *
   645*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   646*                                                                *
   647*                   POS 1   P=PROTECTED                          *
   648*                           U=UNPROTECTED                        *
   649*                           S=ASKIP                              *
   650*                   POS 2   A=ALPHA/NUMERIC                      *
   651*                           N=NUMERIC                            *
   652*                   POS 3   N=NORMAL                             *
   653*                           B=BRIGHT                             *
   654*                           D=DARK                               *
   655*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   656*                           OF=MODIFIED DATA TAG OFF             *
   657*                                                                *
   658*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   659******************************************************************
   660 01  ATTRIBUTE-LIST.
   661     12  AL-PABOF            PIC X       VALUE 'Y'.
   662     12  AL-PABON            PIC X       VALUE 'Z'.
   663     12  AL-PADOF            PIC X       VALUE '%'.
   664     12  AL-PADON            PIC X       VALUE '_'.
   665     12  AL-PANOF            PIC X       VALUE '-'.
   666     12  AL-PANON            PIC X       VALUE '/'.
   667     12  AL-SABOF            PIC X       VALUE '8'.
   668     12  AL-SABON            PIC X       VALUE '9'.
   669     12  AL-SADOF            PIC X       VALUE '@'.
   670     12  AL-SADON            PIC X       VALUE QUOTE.
   671     12  AL-SANOF            PIC X       VALUE '0'.
   672     12  AL-SANON            PIC X       VALUE '1'.
   673     12  AL-UABOF            PIC X       VALUE 'H'.
   674     12  AL-UABON            PIC X       VALUE 'I'.
   675     12  AL-UADOF            PIC X       VALUE '<'.
   676     12  AL-UADON            PIC X       VALUE '('.
   677     12  AL-UANOF            PIC X       VALUE ' '.
   678     12  AL-UANON            PIC X       VALUE 'A'.
   679     12  AL-UNBOF            PIC X       VALUE 'Q'.
   680     12  AL-UNBON            PIC X       VALUE 'R'.
   681     12  AL-UNDOF            PIC X       VALUE '*'.
   682     12  AL-UNDON            PIC X       VALUE ')'.
   683     12  AL-UNNOF            PIC X       VALUE '&'.
   684     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  17
* EL652.cbl
   686*                          COPY ELCEMIB.
   687******************************************************************
   688*                                                                *
   689*                                                                *
   690*                            ELCEMIB.                            *
   691*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   692*                            VMOD=2.005                          *
   693*                                                                *
   694*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   695*                                                                *
   696******************************************************************
   697 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   698     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   699     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   700     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   701     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   702     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   703     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   704     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   705     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   706     12  EMI-SWITCH1             PIC X        VALUE '1'.
   707         88  EMI-NO-ERRORS                    VALUE '1'.
   708         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   709         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   710     12  EMI-SWITCH2             PIC X        VALUE '1'.
   711         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   712     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   713         88  EMI-AREA1-EMPTY                  VALUE '1'.
   714         88  EMI-AREA1-FULL                   VALUE '2'.
   715     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   716         88  EMI-AREA2-EMPTY                  VALUE '1'.
   717         88  EMI-AREA2-FULL                   VALUE '2'.
   718     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   719         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   720         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   721         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   722         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   723         88  EMI-BYPASS-FATALS                VALUE 'X'.
   724     12  EMI-ERROR-LINES.
   725         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   726         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   727         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   728         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   729             20  EMI-ERR-CODES OCCURS 10 TIMES.
   730                 24  EMI-ERR-NUM         PIC X(4).
   731                 24  EMI-FILLER          PIC X.
   732                 24  EMI-SEV             PIC X.
   733                 24  FILLER              PIC X.
   734             20  FILLER                  PIC X(02).
   735     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   736         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   737             20  EMI-ERROR-NUMBER    PIC X(4).
   738             20  EMI-FILL            PIC X.
   739             20  EMI-SEVERITY        PIC X.
   740             20  FILLER              PIC X.
   741             20  EMI-ERROR-TEXT.
   742                 24  EMI-TEXT-VARIABLE   PIC X(10).
   743                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  18
* EL652.cbl
   744     12  EMI-SEVERITY-SAVE           PIC X.
   745         88  EMI-NOTE                    VALUE 'N'.
   746         88  EMI-WARNING                 VALUE 'W'.
   747         88  EMI-FORCABLE                VALUE 'F'.
   748         88  EMI-FATAL                   VALUE 'X'.
   749     12  EMI-MESSAGE-FLAG            PIC X.
   750         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   751         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   752     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   753     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   754         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   755         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   756         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   757     12  FILLER                      PIC X(137)  VALUE SPACES.
   758     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   759     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   760     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   761     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  19
* EL652.cbl
   763 01  FILLER                  PIC X(16)  VALUE ALL 'B'.
   764*                          COPY ELCINTF.
   765******************************************************************
   766*                                                                *
   767*                                                                *
   768*                            ELCINTF.                            *
   769*                            VMOD=2.017                          *
   770*                                                                *
   771*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   772*                                                                *
   773*       LENGTH = 1024                                            *
   774*                                                                *
   775******************************************************************
   776 01  PROGRAM-INTERFACE-BLOCK.
   777     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   778     12  PI-CALLING-PROGRAM              PIC X(8).
   779     12  PI-SAVED-PROGRAM-1              PIC X(8).
   780     12  PI-SAVED-PROGRAM-2              PIC X(8).
   781     12  PI-SAVED-PROGRAM-3              PIC X(8).
   782     12  PI-SAVED-PROGRAM-4              PIC X(8).
   783     12  PI-SAVED-PROGRAM-5              PIC X(8).
   784     12  PI-SAVED-PROGRAM-6              PIC X(8).
   785     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   786     12  PI-COMPANY-ID                   PIC XXX.
   787     12  PI-COMPANY-CD                   PIC X.
   788
   789     12  PI-COMPANY-PASSWORD             PIC X(8).
   790
   791     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   792
   793     12  PI-CONTROL-IN-PROGRESS.
   794         16  PI-CARRIER                  PIC X.
   795         16  PI-GROUPING                 PIC X(6).
   796         16  PI-STATE                    PIC XX.
   797         16  PI-ACCOUNT                  PIC X(10).
   798         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   799                                         PIC X(10).
   800         16  PI-CLAIM-CERT-GRP.
   801             20  PI-CLAIM-NO             PIC X(7).
   802             20  PI-CERT-NO.
   803                 25  PI-CERT-PRIME       PIC X(10).
   804                 25  PI-CERT-SFX         PIC X.
   805             20  PI-CERT-EFF-DT          PIC XX.
   806         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   807             20  PI-PLAN-CODE            PIC X(2).
   808             20  PI-REVISION-NUMBER      PIC X(3).
   809             20  PI-PLAN-EFF-DT          PIC X(2).
   810             20  PI-PLAN-EXP-DT          PIC X(2).
   811             20  FILLER                  PIC X(11).
   812         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   813             20  PI-OE-REFERENCE-1.
   814                 25  PI-OE-REF-1-PRIME   PIC X(18).
   815                 25  PI-OE-REF-1-SUFF    PIC XX.
   816
   817     12  PI-SESSION-IN-PROGRESS          PIC X.
   818         88  CLAIM-SESSION                   VALUE '1'.
   819         88  CREDIT-SESSION                  VALUE '2'.
   820         88  WARRANTY-SESSION                VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  20
* EL652.cbl
   821         88  MORTGAGE-SESSION                VALUE '4'.
   822         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   823
   824
   825*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   826
   827     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   828     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   829
   830     12  PI-CREDIT-USER                  PIC X.
   831         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   832         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   833
   834     12  PI-CLAIM-USER                   PIC X.
   835         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   836         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   837
   838     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   839         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   840         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   841         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   842         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   843         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   844
   845     12  PI-PROCESSOR-ID                 PIC X(4).
   846
   847     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   848
   849     12  PI-MEMBER-CAPTION               PIC X(10).
   850
   851     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   852         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   853
   854     12  PI-LIFE-OVERRIDE-L1             PIC X.
   855     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   856     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   857     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   858
   859     12  PI-AH-OVERRIDE-L1               PIC X.
   860     12  PI-AH-OVERRIDE-L2               PIC XX.
   861     12  PI-AH-OVERRIDE-L6               PIC X(6).
   862     12  PI-AH-OVERRIDE-L12              PIC X(12).
   863
   864     12  PI-NEW-SYSTEM                   PIC X(2).
   865
   866     12  PI-PRIMARY-CERT-NO              PIC X(11).
   867     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   868         88  PI-USES-PAID-TO                 VALUE '1'.
   869     12  PI-CRDTCRD-SYSTEM.
   870         16  PI-CRDTCRD-USER             PIC X.
   871             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   872             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   873         16  PI-CC-MONTH-END-DT          PIC XX.
   874     12  PI-PROCESSOR-PRINTER            PIC X(4).
   875
   876     12  PI-OE-REFERENCE-2.
   877         16  PI-OE-REF-2-PRIME           PIC X(10).
   878         16  PI-OE-REF-2-SUFF            PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  21
* EL652.cbl
   879
   880     12  PI-REM-TRM-CALC-OPTION          PIC X.
   881
   882     12  PI-LANGUAGE-TYPE                PIC X.
   883             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   884             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   885             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   886
   887     12  PI-POLICY-LINKAGE-IND           PIC X.
   888         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   889         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   890                                                   LOW-VALUES.
   891
   892     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   893     12  PI-CLAIM-PW-SESSION             PIC X(1).
   894         88  PI-CLAIM-CREDIT                 VALUE '1'.
   895         88  PI-CLAIM-CONVEN                 VALUE '2'.
   896     12  FILLER                          PIC X(4).
   897
   898     12  PI-SYSTEM-LEVEL                 PIC X(145).
   899
   900     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   901         PI-SYSTEM-LEVEL.
   902
   903         16  PI-ENTRY-CODES.
   904             20  PI-ENTRY-CD-1           PIC X.
   905             20  PI-ENTRY-CD-2           PIC X.
   906
   907         16  PI-RETURN-CODES.
   908             20  PI-RETURN-CD-1          PIC X.
   909             20  PI-RETURN-CD-2          PIC X.
   910
   911         16  PI-UPDATE-STATUS-SAVE.
   912             20  PI-UPDATE-BY            PIC X(4).
   913             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   914
   915         16  PI-LOWER-CASE-LETTERS       PIC X.
   916             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   917
   918*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   919*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   920*            88  CARRIER-CLM-CNTL            VALUE '2'.
   921
   922         16  PI-CERT-ACCESS-CONTROL      PIC X.
   923             88  ST-ACCNT-CNTL               VALUE ' '.
   924             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   925             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   926             88  ACCNT-CNTL                  VALUE '3'.
   927             88  CARR-ACCNT-CNTL             VALUE '4'.
   928
   929         16  PI-PROCESSOR-CAP-LIST.
   930             20  PI-SYSTEM-CONTROLS.
   931                24 PI-SYSTEM-DISPLAY     PIC X.
   932                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   933                24 PI-SYSTEM-MODIFY      PIC X.
   934                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   935             20  FILLER                  PIC XX.
   936             20  PI-DISPLAY-CAP          PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  22
* EL652.cbl
   937                 88  DISPLAY-CAP             VALUE 'Y'.
   938             20  PI-MODIFY-CAP           PIC X.
   939                 88  MODIFY-CAP              VALUE 'Y'.
   940             20  PI-MSG-AT-LOGON-CAP     PIC X.
   941                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   942             20  PI-FORCE-CAP            PIC X.
   943                 88  FORCE-CAP               VALUE 'Y'.
   944
   945         16  PI-PROGRAM-CONTROLS.
   946             20  PI-PGM-PRINT-OPT        PIC X.
   947             20  PI-PGM-FORMAT-OPT       PIC X.
   948             20  PI-PGM-PROCESS-OPT      PIC X.
   949             20  PI-PGM-TOTALS-OPT       PIC X.
   950
   951         16  PI-HELP-INTERFACE.
   952             20  PI-LAST-ERROR-NO        PIC X(4).
   953             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   954
   955         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   956             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   957
   958         16  PI-CR-CONTROL-IN-PROGRESS.
   959             20  PI-CR-CARRIER           PIC X.
   960             20  PI-CR-GROUPING          PIC X(6).
   961             20  PI-CR-STATE             PIC XX.
   962             20  PI-CR-ACCOUNT           PIC X(10).
   963             20  PI-CR-FIN-RESP          PIC X(10).
   964             20  PI-CR-TYPE              PIC X.
   965
   966         16  PI-CR-BATCH-NUMBER          PIC X(6).
   967
   968         16  PI-CR-MONTH-END-DT          PIC XX.
   969
   970         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   971             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   972             88  PI-ZERO-CARRIER             VALUE '1'.
   973             88  PI-ZERO-GROUPING            VALUE '2'.
   974             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   975
   976         16  PI-CARRIER-SECURITY         PIC X.
   977             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   978
   979         16  PI-ACCOUNT-SECURITY         PIC X(10).
   980             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   981             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   982
   983         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   984             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   985                                         INDEXED BY PI-ACCESS-NDX
   986                                         PIC X.
   987
   988         16  PI-GA-BILLING-CONTROL       PIC X.
   989             88  PI-GA-BILLING               VALUE '1'.
   990
   991         16  PI-MAIL-PROCESSING          PIC X.
   992             88  PI-MAIL-YES                 VALUE 'Y'.
   993
   994         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  23
* EL652.cbl
   995
   996         16  PI-AR-SYSTEM.
   997             20  PI-AR-PROCESSING-CNTL   PIC X.
   998                 88  PI-AR-PROCESSING        VALUE 'Y'.
   999             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1000             20  PI-AR-MONTH-END-DT      PIC XX.
  1001
  1002         16  PI-MP-SYSTEM.
  1003             20  PI-MORTGAGE-USER            PIC X.
  1004                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1005                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1006             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1007                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1008                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1009                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1010                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1011                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1012             20  PI-MP-MONTH-END-DT          PIC XX.
  1013             20  PI-MP-REFERENCE-NO.
  1014                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1015                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1016
  1017         16  PI-LABEL-CONTROL            PIC X(01).
  1018             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1019             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1020
  1021         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1022             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1023
  1024         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1025             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1026             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1027
  1028         16  FILLER                      PIC X(14).
  1029
  1030     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1031******************************************************************
  1032     12  PI-WORK-AREA  REDEFINES  PI-PROGRAM-WORK-AREA.
  1033         16  PI-CHECK-MAINT-TYPE     PIC  X.
  1034             88  VALID-MAINT-TYPE            VALUE 'S' 'A'
  1035                                                   'C' 'D'.
  1036             88  ADD-FUNCTION                VALUE 'A'.
  1037             88  SHOW-FUNCTION               VALUE 'S'.
  1038             88  DELETE-FUNCTION             VALUE 'D'.
  1039             88  CHANGE-FUNCTION             VALUE 'C'.
  1040         16  PI-CHECK-TYPE           PIC  X.
  1041             88  VALID-TYPE                  VALUE 'A' 'B' 'C'
  1042                                                           'G'.
  1043         16  PI-CHECK-CARRY-BAL      PIC  X.
  1044             88  VALID-CARRY-BAL             VALUE 'Y' 'N'.
  1045         16  PI-FIRST-TIME-SW        PIC  X.
  1046             88  FIRST-TIME                  VALUE 'Y'.
  1047         16  PI-ERCOMP-EOF-SW        PIC  X.
  1048             88  ERCOMP-EOF                  VALUE 'Y'.
  1049         16  PI-SAVE-PHONE           PIC  X(10).
  1050         16  PI-SAVE-PHONE-RED REDEFINES PI-SAVE-PHONE  PIC 9(10).
  1051         16  PI-ERC-END-BAL          PIC S9(9)V99       COMP-3.
  1052         16  PI-ERCOMP-KEY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  24
* EL652.cbl
  1053             20  PI-ERC-COMPANY-CD   PIC  X.
  1054             20  PI-ERC-CARRIER      PIC  X.
  1055             20  PI-ERC-GROUP        PIC  X(6).
  1056             20  PI-ERC-RESP         PIC  X(10).
  1057             20  PI-ERC-ACCT         PIC  X(10).
  1058             20  PI-ERC-TYPE         PIC  X.
  1059         16  PI-SAVE-ERCOMP-KEY      PIC  X(29).
  1060         16  PI-SAVE-FAXNO           PIC  X(10).
  1061         16  PI-SAVE-FAXNO-RED REDEFINES PI-SAVE-FAXNO  PIC 9(10).
  1062         16  PI-SAVE-ADDR2           PIC X(30).
  1063         16  PI-SAVE-CITYST.
  1064             20  PI-SAVE-CITY        PIC X(28).
  1065             20  PI-SAVE-STATE       PIC XX.
  1066         16  PI-SAVE-ACCT-NAME       PIC X(30).
  1067         16  PI-EL652-DEL-SW         PIC X.
  1068         16  PI-UPDATE-SW            PIC X.
  1069         16  FILLER                  PIC  X(457).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  25
* EL652.cbl
  1071*                            COPY ELCJPFX.
  1072******************************************************************
  1073*                                                                *
  1074*                                                                *
  1075*                            ELCJPFX.                            *
  1076*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1077*                            VMOD=2.002                          *
  1078*                                                                *
  1079*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1080*                                                                *
  1081*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1082*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1083*        ELCNTL - CONTROL FILE                                   *
  1084*        ELMSTR - CLAIM MASTERS                                  *
  1085*        ELTRLR - ACTIVITY TRAILERS                              *
  1086*        ELCHKQ - CHECK QUE                                      *
  1087******************************************************************
  1088 01  JOURNAL-RECORD.
  1089     12  JP-USER-ID                  PIC X(4).
  1090     12  JP-FILE-ID                  PIC X(8).
  1091     12  JP-PROGRAM-ID               PIC X(8).
  1092     12  JP-RECORD-TYPE              PIC X.
  1093         88 JP-ADD              VALUE 'A'.
  1094         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1095         88 JP-AFTER-CHANGE     VALUE 'C'.
  1096         88 JP-DELETE           VALUE 'D'.
  1097         88 JP-GENERIC-DELETE   VALUE 'G'.
  1098         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1099         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1100     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1101     12  JP-RECORD-AREA
  1102
  1103
  1104                             PIC  X(750).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  26
* EL652.cbl
  1106*                            COPY ELCAID.
  1107******************************************************************
  1108*                                                                *
  1109*                            ELCAID.                             *
  1110*                            VMOD=2.001                          *
  1111*                                                                *
  1112*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1113*                                                                *
  1114*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1115*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1116******************************************************************
  1117
  1118 01  DFHAID.
  1119   02  DFHNULL   PIC  X  VALUE  ' '.
  1120   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1121   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1122   02  DFHPEN    PIC  X  VALUE  '='.
  1123   02  DFHOPID   PIC  X  VALUE  'W'.
  1124   02  DFHPA1    PIC  X  VALUE  '%'.
  1125   02  DFHPA2    PIC  X  VALUE  '>'.
  1126   02  DFHPA3    PIC  X  VALUE  ','.
  1127   02  DFHPF1    PIC  X  VALUE  '1'.
  1128   02  DFHPF2    PIC  X  VALUE  '2'.
  1129   02  DFHPF3    PIC  X  VALUE  '3'.
  1130   02  DFHPF4    PIC  X  VALUE  '4'.
  1131   02  DFHPF5    PIC  X  VALUE  '5'.
  1132   02  DFHPF6    PIC  X  VALUE  '6'.
  1133   02  DFHPF7    PIC  X  VALUE  '7'.
  1134   02  DFHPF8    PIC  X  VALUE  '8'.
  1135   02  DFHPF9    PIC  X  VALUE  '9'.
  1136   02  DFHPF10   PIC  X  VALUE  ':'.
  1137   02  DFHPF11   PIC  X  VALUE  '#'.
  1138   02  DFHPF12   PIC  X  VALUE  '@'.
  1139   02  DFHPF13   PIC  X  VALUE  'A'.
  1140   02  DFHPF14   PIC  X  VALUE  'B'.
  1141   02  DFHPF15   PIC  X  VALUE  'C'.
  1142   02  DFHPF16   PIC  X  VALUE  'D'.
  1143   02  DFHPF17   PIC  X  VALUE  'E'.
  1144   02  DFHPF18   PIC  X  VALUE  'F'.
  1145   02  DFHPF19   PIC  X  VALUE  'G'.
  1146   02  DFHPF20   PIC  X  VALUE  'H'.
  1147   02  DFHPF21   PIC  X  VALUE  'I'.
  1148*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1149   02  DFHPF22   PIC  X  VALUE  '['.
  1150   02  DFHPF23   PIC  X  VALUE  '.'.
  1151   02  DFHPF24   PIC  X  VALUE  '<'.
  1152   02  DFHMSRE   PIC  X  VALUE  'X'.
  1153   02  DFHSTRF   PIC  X  VALUE  'h'.
  1154   02  DFHTRIG   PIC  X  VALUE  '"'.
  1155
  1156 01  FILLER  REDEFINES  DFHAID.
  1157     12  FILLER              PIC  X(8).
  1158     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  27
* EL652.cbl
  1160*                            COPY EL652S.
  1161 01  EL652AI.
  1162     05  FILLER            PIC  X(0012).
  1163*    -------------------------------
  1164     05  RUNDATEL PIC S9(0004) COMP.
  1165     05  RUNDATEF PIC  X(0001).
  1166     05  FILLER REDEFINES RUNDATEF.
  1167         10  RUNDATEA PIC  X(0001).
  1168     05  RUNDATEI PIC  X(0008).
  1169*    -------------------------------
  1170     05  RUNTIMEL PIC S9(0004) COMP.
  1171     05  RUNTIMEF PIC  X(0001).
  1172     05  FILLER REDEFINES RUNTIMEF.
  1173         10  RUNTIMEA PIC  X(0001).
  1174     05  RUNTIMEI PIC  X(0005).
  1175*    -------------------------------
  1176     05  CMPNYIDL PIC S9(0004) COMP.
  1177     05  CMPNYIDF PIC  X(0001).
  1178     05  FILLER REDEFINES CMPNYIDF.
  1179         10  CMPNYIDA PIC  X(0001).
  1180     05  CMPNYIDI PIC  X(0003).
  1181*    -------------------------------
  1182     05  USERIDL PIC S9(0004) COMP.
  1183     05  USERIDF PIC  X(0001).
  1184     05  FILLER REDEFINES USERIDF.
  1185         10  USERIDA PIC  X(0001).
  1186     05  USERIDI PIC  X(0004).
  1187*    -------------------------------
  1188     05  MAINTYPL PIC S9(0004) COMP.
  1189     05  MAINTYPF PIC  X(0001).
  1190     05  FILLER REDEFINES MAINTYPF.
  1191         10  MAINTYPA PIC  X(0001).
  1192     05  MAINTYPI PIC  X(0001).
  1193*    -------------------------------
  1194     05  SCDESCL PIC S9(0004) COMP.
  1195     05  SCDESCF PIC  X(0001).
  1196     05  FILLER REDEFINES SCDESCF.
  1197         10  SCDESCA PIC  X(0001).
  1198     05  SCDESCI PIC  X(0008).
  1199*    -------------------------------
  1200     05  FLITYPEL PIC S9(0004) COMP.
  1201     05  FLITYPEF PIC  X(0001).
  1202     05  FILLER REDEFINES FLITYPEF.
  1203         10  FLITYPEA PIC  X(0001).
  1204     05  FLITYPEI PIC  X(0004).
  1205*    -------------------------------
  1206     05  CARRIERL PIC S9(0004) COMP.
  1207     05  CARRIERF PIC  X(0001).
  1208     05  FILLER REDEFINES CARRIERF.
  1209         10  CARRIERA PIC  X(0001).
  1210     05  CARRIERI PIC  X(0001).
  1211*    -------------------------------
  1212     05  GROUPL PIC S9(0004) COMP.
  1213     05  GROUPF PIC  X(0001).
  1214     05  FILLER REDEFINES GROUPF.
  1215         10  GROUPA PIC  X(0001).
  1216     05  GROUPI PIC  X(0006).
  1217*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  28
* EL652.cbl
  1218     05  TYPEL PIC S9(0004) COMP.
  1219     05  TYPEF PIC  X(0001).
  1220     05  FILLER REDEFINES TYPEF.
  1221         10  TYPEA PIC  X(0001).
  1222     05  TYPEI PIC  X(0001).
  1223*    -------------------------------
  1224     05  FINRESPL PIC S9(0004) COMP.
  1225     05  FINRESPF PIC  X(0001).
  1226     05  FILLER REDEFINES FINRESPF.
  1227         10  FINRESPA PIC  X(0001).
  1228     05  FINRESPI PIC  X(0010).
  1229*    -------------------------------
  1230     05  ACCTNOL PIC S9(0004) COMP.
  1231     05  ACCTNOF PIC  X(0001).
  1232     05  FILLER REDEFINES ACCTNOF.
  1233         10  ACCTNOA PIC  X(0001).
  1234     05  ACCTNOI PIC  X(0010).
  1235*    -------------------------------
  1236     05  SUMMNOL PIC S9(0004) COMP.
  1237     05  SUMMNOF PIC  X(0001).
  1238     05  FILLER REDEFINES SUMMNOF.
  1239         10  SUMMNOA PIC  X(0001).
  1240     05  SUMMNOI PIC  X(0006).
  1241*    -------------------------------
  1242     05  LSTMDTL PIC S9(0004) COMP.
  1243     05  LSTMDTF PIC  X(0001).
  1244     05  FILLER REDEFINES LSTMDTF.
  1245         10  LSTMDTA PIC  X(0001).
  1246     05  LSTMDTI PIC  X(0008).
  1247*    -------------------------------
  1248     05  FLITYPL PIC S9(0004) COMP.
  1249     05  FLITYPF PIC  X(0001).
  1250     05  FILLER REDEFINES FLITYPF.
  1251         10  FLITYPA PIC  X(0001).
  1252     05  FLITYPI PIC  X(0001).
  1253*    -------------------------------
  1254     05  PCONTL PIC S9(0004) COMP.
  1255     05  PCONTF PIC  X(0001).
  1256     05  FILLER REDEFINES PCONTF.
  1257         10  PCONTA PIC  X(0001).
  1258     05  PCONTI PIC  X(0030).
  1259*    -------------------------------
  1260     05  PNT1099L PIC S9(0004) COMP.
  1261     05  PNT1099F PIC  X(0001).
  1262     05  FILLER REDEFINES PNT1099F.
  1263         10  PNT1099A PIC  X(0001).
  1264     05  PNT1099I PIC  X(0001).
  1265*    -------------------------------
  1266     05  MAILNAML PIC S9(0004) COMP.
  1267     05  MAILNAMF PIC  X(0001).
  1268     05  FILLER REDEFINES MAILNAMF.
  1269         10  MAILNAMA PIC  X(0001).
  1270     05  MAILNAMI PIC  X(0030).
  1271*    -------------------------------
  1272     05  SSNL PIC S9(0004) COMP.
  1273     05  SSNF PIC  X(0001).
  1274     05  FILLER REDEFINES SSNF.
  1275         10  SSNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  29
* EL652.cbl
  1276     05  SSNI PIC  X(0013).
  1277*    -------------------------------
  1278     05  ACCTNAML PIC S9(0004) COMP.
  1279     05  ACCTNAMF PIC  X(0001).
  1280     05  FILLER REDEFINES ACCTNAMF.
  1281         10  ACCTNAMA PIC  X(0001).
  1282     05  ACCTNAMI PIC  X(0030).
  1283*    -------------------------------
  1284     05  PHONEL PIC S9(0004) COMP.
  1285     05  PHONEF PIC  X(0001).
  1286     05  FILLER REDEFINES PHONEF.
  1287         10  PHONEA PIC  X(0001).
  1288     05  PHONEI PIC  X(0012).
  1289*    -------------------------------
  1290     05  ADDR1L PIC S9(0004) COMP.
  1291     05  ADDR1F PIC  X(0001).
  1292     05  FILLER REDEFINES ADDR1F.
  1293         10  ADDR1A PIC  X(0001).
  1294     05  ADDR1I PIC  X(0030).
  1295*    -------------------------------
  1296     05  FAXDESCL PIC S9(0004) COMP.
  1297     05  FAXDESCF PIC  X(0001).
  1298     05  FILLER REDEFINES FAXDESCF.
  1299         10  FAXDESCA PIC  X(0001).
  1300     05  FAXDESCI PIC  X(0016).
  1301*    -------------------------------
  1302     05  FAXNOL PIC S9(0004) COMP.
  1303     05  FAXNOF PIC  X(0001).
  1304     05  FILLER REDEFINES FAXNOF.
  1305         10  FAXNOA PIC  X(0001).
  1306     05  FAXNOI PIC  X(0012).
  1307*    -------------------------------
  1308     05  ADDR2L PIC S9(0004) COMP.
  1309     05  ADDR2F PIC  X(0001).
  1310     05  FILLER REDEFINES ADDR2F.
  1311         10  ADDR2A PIC  X(0001).
  1312     05  ADDR2I PIC  X(0030).
  1313*    -------------------------------
  1314     05  CARBALL PIC S9(0004) COMP.
  1315     05  CARBALF PIC  X(0001).
  1316     05  FILLER REDEFINES CARBALF.
  1317         10  CARBALA PIC  X(0001).
  1318     05  CARBALI PIC  X(0001).
  1319*    -------------------------------
  1320     05  CITYL PIC S9(0004) COMP.
  1321     05  CITYF PIC  X(0001).
  1322     05  FILLER REDEFINES CITYF.
  1323         10  CITYA PIC  X(0001).
  1324     05  CITYI PIC  X(0028).
  1325*    -------------------------------
  1326     05  STATEL PIC S9(0004) COMP.
  1327     05  STATEF PIC  X(0001).
  1328     05  FILLER REDEFINES STATEF.
  1329         10  STATEA PIC  X(0001).
  1330     05  STATEI PIC  X(0002).
  1331*    -------------------------------
  1332     05  REFEHL PIC S9(0004) COMP.
  1333     05  REFEHF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  30
* EL652.cbl
  1334     05  FILLER REDEFINES REFEHF.
  1335         10  REFEHA PIC  X(0001).
  1336     05  REFEHI PIC  X(0013).
  1337*    -------------------------------
  1338     05  REFEL PIC S9(0004) COMP.
  1339     05  REFEF PIC  X(0001).
  1340     05  FILLER REDEFINES REFEF.
  1341         10  REFEA PIC  X(0001).
  1342     05  REFEI PIC  X(0001).
  1343*    -------------------------------
  1344     05  ZIPCODEL PIC S9(0004) COMP.
  1345     05  ZIPCODEF PIC  X(0001).
  1346     05  FILLER REDEFINES ZIPCODEF.
  1347         10  ZIPCODEA PIC  X(0001).
  1348     05  ZIPCODEI PIC  X(0010).
  1349*    -------------------------------
  1350     05  NGDESCL PIC S9(0004) COMP.
  1351     05  NGDESCF PIC  X(0001).
  1352     05  FILLER REDEFINES NGDESCF.
  1353         10  NGDESCA PIC  X(0001).
  1354     05  NGDESCI PIC  X(0012).
  1355*    -------------------------------
  1356     05  NETGRSL PIC S9(0004) COMP.
  1357     05  NETGRSF PIC  X(0001).
  1358     05  FILLER REDEFINES NETGRSF.
  1359         10  NETGRSA PIC  X(0001).
  1360     05  NETGRSI PIC  X(0001).
  1361*    -------------------------------
  1362     05  BALDESCL PIC S9(0004) COMP.
  1363     05  BALDESCF PIC  X(0001).
  1364     05  FILLER REDEFINES BALDESCF.
  1365         10  BALDESCA PIC  X(0001).
  1366     05  BALDESCI PIC  X(0016).
  1367*    -------------------------------
  1368     05  ARBALL PIC S9(0004) COMP.
  1369     05  ARBALF PIC  X(0001).
  1370     05  FILLER REDEFINES ARBALF.
  1371         10  ARBALA PIC  X(0001).
  1372     05  ARBALI PIC  X(0001).
  1373*    -------------------------------
  1374     05  CSRL PIC S9(0004) COMP.
  1375     05  CSRF PIC  X(0001).
  1376     05  FILLER REDEFINES CSRF.
  1377         10  CSRA PIC  X(0001).
  1378     05  CSRI PIC  X(0004).
  1379*    -------------------------------
  1380     05  RPTCDDL PIC S9(0004) COMP.
  1381     05  RPTCDDF PIC  X(0001).
  1382     05  FILLER REDEFINES RPTCDDF.
  1383         10  RPTCDDA PIC  X(0001).
  1384     05  RPTCDDI PIC  X(0010).
  1385*    -------------------------------
  1386     05  RPTCD2L PIC S9(0004) COMP.
  1387     05  RPTCD2F PIC  X(0001).
  1388     05  FILLER REDEFINES RPTCD2F.
  1389         10  RPTCD2A PIC  X(0001).
  1390     05  RPTCD2I PIC  X(0010).
  1391*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  31
* EL652.cbl
  1392     05  CKDESCL PIC S9(0004) COMP.
  1393     05  CKDESCF PIC  X(0001).
  1394     05  FILLER REDEFINES CKDESCF.
  1395         10  CKDESCA PIC  X(0001).
  1396     05  CKDESCI PIC  X(0016).
  1397*    -------------------------------
  1398     05  CKPULLL PIC S9(0004) COMP.
  1399     05  CKPULLF PIC  X(0001).
  1400     05  FILLER REDEFINES CKPULLF.
  1401         10  CKPULLA PIC  X(0001).
  1402     05  CKPULLI PIC  X(0001).
  1403*    -------------------------------
  1404     05  BILLPRTL PIC S9(0004) COMP.
  1405     05  BILLPRTF PIC  X(0001).
  1406     05  FILLER REDEFINES BILLPRTF.
  1407         10  BILLPRTA PIC  X(0001).
  1408     05  BILLPRTI PIC  X(0001).
  1409*    -------------------------------
  1410     05  LETDESCL PIC S9(0004) COMP.
  1411     05  LETDESCF PIC  X(0001).
  1412     05  FILLER REDEFINES LETDESCF.
  1413         10  LETDESCA PIC  X(0001).
  1414     05  LETDESCI PIC  X(0011).
  1415*    -------------------------------
  1416     05  LETRCDL PIC S9(0004) COMP.
  1417     05  LETRCDF PIC  X(0001).
  1418     05  FILLER REDEFINES LETRCDF.
  1419         10  LETRCDA PIC  X(0001).
  1420     05  LETRCDI PIC  X(0001).
  1421*    -------------------------------
  1422     05  BALPRTL PIC S9(0004) COMP.
  1423     05  BALPRTF PIC  X(0001).
  1424     05  FILLER REDEFINES BALPRTF.
  1425         10  BALPRTA PIC  X(0001).
  1426     05  BALPRTI PIC  X(0011).
  1427*    -------------------------------
  1428     05  BALCDL PIC S9(0004) COMP.
  1429     05  BALCDF PIC  X(0001).
  1430     05  FILLER REDEFINES BALCDF.
  1431         10  BALCDA PIC  X(0001).
  1432     05  BALCDI PIC  X(0001).
  1433*    -------------------------------
  1434     05  SPPDDHL PIC S9(0004) COMP.
  1435     05  SPPDDHF PIC  X(0001).
  1436     05  FILLER REDEFINES SPPDDHF.
  1437         10  SPPDDHA PIC  X(0001).
  1438     05  SPPDDHI PIC  X(0012).
  1439*    -------------------------------
  1440     05  SPPDDL PIC S9(0004) COMP.
  1441     05  SPPDDF PIC  X(0001).
  1442     05  FILLER REDEFINES SPPDDF.
  1443         10  SPPDDA PIC  X(0001).
  1444     05  SPPDDI PIC  X(0001).
  1445*    -------------------------------
  1446     05  MFLABLL PIC S9(0004) COMP.
  1447     05  MFLABLF PIC  X(0001).
  1448     05  FILLER REDEFINES MFLABLF.
  1449         10  MFLABLA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  32
* EL652.cbl
  1450     05  MFLABLI PIC  X(0016).
  1451*    -------------------------------
  1452     05  MAXFEEL PIC S9(0004) COMP.
  1453     05  MAXFEEF PIC  X(0001).
  1454     05  FILLER REDEFINES MAXFEEF.
  1455         10  MAXFEEA PIC  X(0001).
  1456     05  MAXFEEI PIC  S9(04)V99.
  1457*    -------------------------------
  1458     05  CSLABLL PIC S9(0004) COMP.
  1459     05  CSLABLF PIC  X(0001).
  1460     05  FILLER REDEFINES CSLABLF.
  1461         10  CSLABLA PIC  X(0001).
  1462     05  CSLABLI PIC  X(0012).
  1463*    -------------------------------
  1464     05  CLPSTL PIC S9(0004) COMP.
  1465     05  CLPSTF PIC  X(0001).
  1466     05  FILLER REDEFINES CLPSTF.
  1467         10  CLPSTA PIC  X(0001).
  1468     05  CLPSTI PIC  X(0002).
  1469*    -------------------------------
  1470     05  LFLABLL PIC S9(0004) COMP.
  1471     05  LFLABLF PIC  X(0001).
  1472     05  FILLER REDEFINES LFLABLF.
  1473         10  LFLABLA PIC  X(0001).
  1474     05  LFLABLI PIC  X(0016).
  1475*    -------------------------------
  1476     05  MAXLFL PIC S9(0004) COMP.
  1477     05  MAXLFF PIC  X(0001).
  1478     05  FILLER REDEFINES MAXLFF.
  1479         10  MAXLFA PIC  X(0001).
  1480     05  MAXLFI PIC  S9(04)V99.
  1481*    -------------------------------
  1482     05  BALFWDL PIC S9(0004) COMP.
  1483     05  BALFWDF PIC  X(0001).
  1484     05  FILLER REDEFINES BALFWDF.
  1485         10  BALFWDA PIC  X(0001).
  1486     05  BALFWDI PIC  S9(11)V99.
  1487*    -------------------------------
  1488     05  CURCOML PIC S9(0004) COMP.
  1489     05  CURCOMF PIC  X(0001).
  1490     05  FILLER REDEFINES CURCOMF.
  1491         10  CURCOMA PIC  X(0001).
  1492     05  CURCOMI PIC  S9(11)V99.
  1493*    -------------------------------
  1494     05  CURCHGL PIC S9(0004) COMP.
  1495     05  CURCHGF PIC  X(0001).
  1496     05  FILLER REDEFINES CURCHGF.
  1497         10  CURCHGA PIC  X(0001).
  1498     05  CURCHGI PIC  S9(11)V99.
  1499*    -------------------------------
  1500     05  CURPMTL PIC S9(0004) COMP.
  1501     05  CURPMTF PIC  X(0001).
  1502     05  FILLER REDEFINES CURPMTF.
  1503         10  CURPMTA PIC  X(0001).
  1504     05  CURPMTI PIC  S9(11)V99.
  1505*    -------------------------------
  1506     05  ENDBALL PIC S9(0004) COMP.
  1507     05  ENDBALF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  33
* EL652.cbl
  1508     05  FILLER REDEFINES ENDBALF.
  1509         10  ENDBALA PIC  X(0001).
  1510     05  ENDBALI PIC  S9(11)V99.
  1511*    -------------------------------
  1512     05  CURRENTL PIC S9(0004) COMP.
  1513     05  CURRENTF PIC  X(0001).
  1514     05  FILLER REDEFINES CURRENTF.
  1515         10  CURRENTA PIC  X(0001).
  1516     05  CURRENTI PIC  X(0013).
  1517*    -------------------------------
  1518     05  OVER30L PIC S9(0004) COMP.
  1519     05  OVER30F PIC  X(0001).
  1520     05  FILLER REDEFINES OVER30F.
  1521         10  OVER30A PIC  X(0001).
  1522     05  OVER30I PIC  X(0013).
  1523*    -------------------------------
  1524     05  OVER60L PIC S9(0004) COMP.
  1525     05  OVER60F PIC  X(0001).
  1526     05  FILLER REDEFINES OVER60F.
  1527         10  OVER60A PIC  X(0001).
  1528     05  OVER60I PIC  X(0013).
  1529*    -------------------------------
  1530     05  OVER90L PIC S9(0004) COMP.
  1531     05  OVER90F PIC  X(0001).
  1532     05  FILLER REDEFINES OVER90F.
  1533         10  OVER90A PIC  X(0001).
  1534     05  OVER90I PIC  X(0013).
  1535*    -------------------------------
  1536     05  YTDCOML PIC S9(0004) COMP.
  1537     05  YTDCOMF PIC  X(0001).
  1538     05  FILLER REDEFINES YTDCOMF.
  1539         10  YTDCOMA PIC  X(0001).
  1540     05  YTDCOMI PIC  S9(11)V99.
  1541*    -------------------------------
  1542     05  LSTDTEL PIC S9(0004) COMP.
  1543     05  LSTDTEF PIC  X(0001).
  1544     05  FILLER REDEFINES LSTDTEF.
  1545         10  LSTDTEA PIC  X(0001).
  1546     05  LSTDTEI PIC  X(0008).
  1547*    -------------------------------
  1548     05  LSTTIMEL PIC S9(0004) COMP.
  1549     05  LSTTIMEF PIC  X(0001).
  1550     05  FILLER REDEFINES LSTTIMEF.
  1551         10  LSTTIMEA PIC  X(0001).
  1552     05  LSTTIMEI PIC  X(0005).
  1553*    -------------------------------
  1554     05  LSTUSRL PIC S9(0004) COMP.
  1555     05  LSTUSRF PIC  X(0001).
  1556     05  FILLER REDEFINES LSTUSRF.
  1557         10  LSTUSRA PIC  X(0001).
  1558     05  LSTUSRI PIC  X(0004).
  1559*    -------------------------------
  1560     05  ERRMSG1L PIC S9(0004) COMP.
  1561     05  ERRMSG1F PIC  X(0001).
  1562     05  FILLER REDEFINES ERRMSG1F.
  1563         10  ERRMSG1A PIC  X(0001).
  1564     05  ERRMSG1I PIC  X(0072).
  1565*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  34
* EL652.cbl
  1566     05  PFKEYL PIC S9(0004) COMP.
  1567     05  PFKEYF PIC  X(0001).
  1568     05  FILLER REDEFINES PFKEYF.
  1569         10  PFKEYA PIC  X(0001).
  1570     05  PFKEYI PIC  99.
  1571*    -------------------------------
  1572     05  PFK5L PIC S9(0004) COMP.
  1573     05  PFK5F PIC  X(0001).
  1574     05  FILLER REDEFINES PFK5F.
  1575         10  PFK5A PIC  X(0001).
  1576     05  PFK5I PIC  X(0011).
  1577*    -------------------------------
  1578     05  PFK7L PIC S9(0004) COMP.
  1579     05  PFK7F PIC  X(0001).
  1580     05  FILLER REDEFINES PFK7F.
  1581         10  PFK7A PIC  X(0001).
  1582     05  PFK7I PIC  X(0012).
  1583*    -------------------------------
  1584     05  PFK9L PIC S9(0004) COMP.
  1585     05  PFK9F PIC  X(0001).
  1586     05  FILLER REDEFINES PFK9F.
  1587         10  PFK9A PIC  X(0001).
  1588     05  PFK9I PIC  X(0012).
  1589*    -------------------------------
  1590     05  PFK13L PIC S9(0004) COMP.
  1591     05  PFK13F PIC  X(0001).
  1592     05  FILLER REDEFINES PFK13F.
  1593         10  PFK13A PIC  X(0001).
  1594     05  PFK13I PIC  X(0011).
  1595*    -------------------------------
  1596     05  PFK4L PIC S9(0004) COMP.
  1597     05  PFK4F PIC  X(0001).
  1598     05  FILLER REDEFINES PFK4F.
  1599         10  PFK4A PIC  X(0001).
  1600     05  PFK4I PIC  X(0012).
  1601*    -------------------------------
  1602     05  PFK6L PIC S9(0004) COMP.
  1603     05  PFK6F PIC  X(0001).
  1604     05  FILLER REDEFINES PFK6F.
  1605         10  PFK6A PIC  X(0001).
  1606     05  PFK6I PIC  X(0011).
  1607*    -------------------------------
  1608     05  PFK10L PIC S9(0004) COMP.
  1609     05  PFK10F PIC  X(0001).
  1610     05  FILLER REDEFINES PFK10F.
  1611         10  PFK10A PIC  X(0001).
  1612     05  PFK10I PIC  X(0014).
  1613 01  EL652AO REDEFINES EL652AI.
  1614     05  FILLER            PIC  X(0012).
  1615*    -------------------------------
  1616     05  FILLER            PIC  X(0003).
  1617     05  RUNDATEO PIC  X(0008).
  1618*    -------------------------------
  1619     05  FILLER            PIC  X(0003).
  1620     05  RUNTIMEO PIC  99.99.
  1621*    -------------------------------
  1622     05  FILLER            PIC  X(0003).
  1623     05  CMPNYIDO PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  35
* EL652.cbl
  1624*    -------------------------------
  1625     05  FILLER            PIC  X(0003).
  1626     05  USERIDO PIC  X(0004).
  1627*    -------------------------------
  1628     05  FILLER            PIC  X(0003).
  1629     05  MAINTYPO PIC  X(0001).
  1630*    -------------------------------
  1631     05  FILLER            PIC  X(0003).
  1632     05  SCDESCO PIC  X(0008).
  1633*    -------------------------------
  1634     05  FILLER            PIC  X(0003).
  1635     05  FLITYPEO PIC  X(0004).
  1636*    -------------------------------
  1637     05  FILLER            PIC  X(0003).
  1638     05  CARRIERO PIC  X(0001).
  1639*    -------------------------------
  1640     05  FILLER            PIC  X(0003).
  1641     05  GROUPO PIC  X(0006).
  1642*    -------------------------------
  1643     05  FILLER            PIC  X(0003).
  1644     05  TYPEO PIC  X(0001).
  1645*    -------------------------------
  1646     05  FILLER            PIC  X(0003).
  1647     05  FINRESPO PIC  X(0010).
  1648*    -------------------------------
  1649     05  FILLER            PIC  X(0003).
  1650     05  ACCTNOO PIC  X(0010).
  1651*    -------------------------------
  1652     05  FILLER            PIC  X(0003).
  1653     05  SUMMNOO PIC  X(0006).
  1654*    -------------------------------
  1655     05  FILLER            PIC  X(0003).
  1656     05  LSTMDTO PIC  X(0008).
  1657*    -------------------------------
  1658     05  FILLER            PIC  X(0003).
  1659     05  FLITYPO PIC  X(0001).
  1660*    -------------------------------
  1661     05  FILLER            PIC  X(0003).
  1662     05  PCONTO PIC  X(0030).
  1663*    -------------------------------
  1664     05  FILLER            PIC  X(0003).
  1665     05  PNT1099O PIC  X(0001).
  1666*    -------------------------------
  1667     05  FILLER            PIC  X(0003).
  1668     05  MAILNAMO PIC  X(0030).
  1669*    -------------------------------
  1670     05  FILLER            PIC  X(0003).
  1671     05  SSNO PIC  X(0013).
  1672*    -------------------------------
  1673     05  FILLER            PIC  X(0003).
  1674     05  ACCTNAMO PIC  X(0030).
  1675*    -------------------------------
  1676     05  FILLER            PIC  X(0003).
  1677     05  PHONEO PIC  X(0012).
  1678*    -------------------------------
  1679     05  FILLER            PIC  X(0003).
  1680     05  ADDR1O PIC  X(0030).
  1681*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  36
* EL652.cbl
  1682     05  FILLER            PIC  X(0003).
  1683     05  FAXDESCO PIC  X(0016).
  1684*    -------------------------------
  1685     05  FILLER            PIC  X(0003).
  1686     05  FAXNOO PIC  X(0012).
  1687*    -------------------------------
  1688     05  FILLER            PIC  X(0003).
  1689     05  ADDR2O PIC  X(0030).
  1690*    -------------------------------
  1691     05  FILLER            PIC  X(0003).
  1692     05  CARBALO PIC  X(0001).
  1693*    -------------------------------
  1694     05  FILLER            PIC  X(0003).
  1695     05  CITYO PIC  X(0028).
  1696*    -------------------------------
  1697     05  FILLER            PIC  X(0003).
  1698     05  STATEO PIC  X(0002).
  1699*    -------------------------------
  1700     05  FILLER            PIC  X(0003).
  1701     05  REFEHO PIC  X(0013).
  1702*    -------------------------------
  1703     05  FILLER            PIC  X(0003).
  1704     05  REFEO PIC  X(0001).
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  ZIPCODEO PIC  X(0010).
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  NGDESCO PIC  X(0012).
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  NETGRSO PIC  X(0001).
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  BALDESCO PIC  X(0016).
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  ARBALO PIC  X(0001).
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
  1722     05  CSRO PIC  X(0004).
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  RPTCDDO PIC  X(0010).
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
  1728     05  RPTCD2O PIC  X(0010).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  CKDESCO PIC  X(0016).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  CKPULLO PIC  X(0001).
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  BILLPRTO PIC  X(0001).
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  37
* EL652.cbl
  1740     05  LETDESCO PIC  X(0011).
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  LETRCDO PIC  X(0001).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  BALPRTO PIC  X(0011).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  BALCDO PIC  X(0001).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  SPPDDHO PIC  X(0012).
  1753*    -------------------------------
  1754     05  FILLER            PIC  X(0003).
  1755     05  SPPDDO PIC  X(0001).
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  MFLABLO PIC  X(0016).
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
  1761     05  MAXFEEO PIC  Z99.99.
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  CSLABLO PIC  X(0012).
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  CLPSTO PIC  X(0002).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  LFLABLO PIC  X(0016).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  MAXLFO PIC  Z99.99.
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  BALFWDO PIC  Z,ZZZ,ZZZ.99-.
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  CURCOMO PIC  Z,ZZZ,ZZZ.99-.
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  CURCHGO PIC  Z,ZZZ,ZZZ.99-.
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  CURPMTO PIC  Z,ZZZ,ZZZ.99-.
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  ENDBALO PIC  Z,ZZZ,ZZZ.99-.
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  CURRENTO PIC  Z,ZZZ,ZZZ.99-.
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  OVER30O PIC  Z,ZZZ,ZZZ.99-.
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  OVER60O PIC  Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  38
* EL652.cbl
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  OVER90O PIC  Z,ZZZ,ZZZ.99-.
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  YTDCOMO PIC  Z,ZZZ,ZZZ.99-.
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  LSTDTEO PIC  X(0008).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  LSTTIMEO PIC  99.99.
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  LSTUSRO PIC  X(0004).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  ERRMSG1O PIC  X(0072).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  PFKEYO PIC  X(0002).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  PFK5O PIC  X(0011).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  PFK7O PIC  X(0012).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  PFK9O PIC  X(0012).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  PFK13O PIC  X(0011).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  PFK4O PIC  X(0012).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  PFK6O PIC  X(0011).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  PFK10O PIC  X(0014).
  1840*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  39
* EL652.cbl
  1842****************************************************************
  1843*
  1844* Copyright (c) 2007 by Clerity Solutions, Inc.
  1845* All rights reserved.
  1846*
  1847****************************************************************
  1848 01  DFHEIV.
  1849   02  DFHEIV0               PIC X(35).
  1850   02  DFHEIV1               PIC X(08).
  1851   02  DFHEIV2               PIC X(08).
  1852   02  DFHEIV3               PIC X(08).
  1853   02  DFHEIV4               PIC X(06).
  1854   02  DFHEIV5               PIC X(04).
  1855   02  DFHEIV6               PIC X(04).
  1856   02  DFHEIV7               PIC X(02).
  1857   02  DFHEIV8               PIC X(02).
  1858   02  DFHEIV9               PIC X(01).
  1859   02  DFHEIV10              PIC S9(7) COMP-3.
  1860   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1861   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1862   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1863   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1864   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1865   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1866   02  DFHEIV17              PIC X(04).
  1867   02  DFHEIV18              PIC X(04).
  1868   02  DFHEIV19              PIC X(04).
  1869   02  DFHEIV20              USAGE IS POINTER.
  1870   02  DFHEIV21              USAGE IS POINTER.
  1871   02  DFHEIV22              USAGE IS POINTER.
  1872   02  DFHEIV23              USAGE IS POINTER.
  1873   02  DFHEIV24              USAGE IS POINTER.
  1874   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1875   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1876   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1877   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1878   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1879   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1880   02  FILLER                PIC X(02).
  1881   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1882   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1883   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1884   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1885   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1886 LINKAGE  SECTION.
  1887*****************************************************************
  1888*                                                               *
  1889* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1890* All rights reserved.                                          *
  1891*                                                               *
  1892*****************************************************************
  1893 01  dfheiblk.
  1894     02  eibtime          pic s9(7) comp-3.
  1895     02  eibdate          pic s9(7) comp-3.
  1896     02  eibtrnid         pic x(4).
  1897     02  eibtaskn         pic s9(7) comp-3.
  1898     02  eibtrmid         pic x(4).
  1899     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  40
* EL652.cbl
  1900     02  eibcposn         pic s9(4) comp.
  1901     02  eibcalen         pic s9(4) comp.
  1902     02  eibaid           pic x(1).
  1903     02  eibfiller1       pic x(1).
  1904     02  eibfn            pic x(2).
  1905     02  eibfiller2       pic x(2).
  1906     02  eibrcode         pic x(6).
  1907     02  eibfiller3       pic x(2).
  1908     02  eibds            pic x(8).
  1909     02  eibreqid         pic x(8).
  1910     02  eibrsrce         pic x(8).
  1911     02  eibsync          pic x(1).
  1912     02  eibfree          pic x(1).
  1913     02  eibrecv          pic x(1).
  1914     02  eibsend          pic x(1).
  1915     02  eibatt           pic x(1).
  1916     02  eibeoc           pic x(1).
  1917     02  eibfmh           pic x(1).
  1918     02  eibcompl         pic x(1).
  1919     02  eibsig           pic x(1).
  1920     02  eibconf          pic x(1).
  1921     02  eiberr           pic x(1).
  1922     02  eibrldbk         pic x(1).
  1923     02  eiberrcd         pic x(4).
  1924     02  eibsynrb         pic x(1).
  1925     02  eibnodat         pic x(1).
  1926     02  eibfiller5       pic x(2).
  1927     02  eibresp          pic 9(09) comp.
  1928     02  eibresp2         pic 9(09) comp.
  1929     02  dfheigdj         pic s9(4) comp.
  1930     02  dfheigdk         pic s9(4) comp.
  1931
  1932 01  DFHCOMMAREA             PIC  X(1024).
  1933
  1934*01 PARMLIST .
  1935*    12  FILLER              PIC S9(8)                  COMP.
  1936*    12  ERCOMP-POINTER      PIC S9(8)                  COMP.
  1937*    12  ERNAME-POINTER      PIC S9(8)                  COMP.
  1938*    12  ELCNTL-POINTER      PIC S9(8)                  COMP.
  1939*    12  ERSUMM-POINTER      PIC S9(8)                  COMP.
  1940*    12  ERRQST-POINTER      PIC S9(8)                  COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  41
* EL652.cbl
  1942*                            COPY ERCCOMP.
  1943******************************************************************
  1944*                                                                *
  1945*                                                                *
  1946*                            ERCCOMP                             *
  1947*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1948*                            VMOD=2.019                          *
  1949*                                                                *
  1950*   ONLINE CREDIT SYSTEM                                         *
  1951*                                                                *
  1952*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1953*                                                                *
  1954*   FILE TYPE = VSAM,KSDS                                        *
  1955*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1956*                                                                *
  1957*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1958*       ALTERNATE PATH = NONE                                    *
  1959*                                                                *
  1960*   LOG = NO                                                     *
  1961*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1962*                                                                *
  1963******************************************************************
  1964*                   C H A N G E   L O G
  1965*
  1966* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1967*-----------------------------------------------------------------
  1968*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1969* EFFECTIVE    NUMBER
  1970*-----------------------------------------------------------------
  1971* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1972* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1973* 092205    2005050300006  PEMA  ADD LEASE FEE
  1974* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1975* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1976* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1977* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1978* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1979******************************************************************
  1980
  1981 01  COMPENSATION-MASTER.
  1982     12  CO-RECORD-ID                          PIC XX.
  1983         88  VALID-CO-ID                          VALUE 'CO'.
  1984
  1985     12  CO-CONTROL-PRIMARY.
  1986         16  CO-COMPANY-CD                     PIC X.
  1987         16  CO-CONTROL.
  1988             20  CO-CTL-1.
  1989                 24  CO-CARR-GROUP.
  1990                     28  CO-CARRIER            PIC X.
  1991                     28  CO-GROUPING.
  1992                         32  CO-GROUP-PREFIX   PIC XXX.
  1993                         32  CO-GROUP-PRIME    PIC XXX.
  1994                 24  CO-RESP-NO.
  1995                     28  CO-RESP-PREFIX        PIC X(4).
  1996                     28  CO-RESP-PRIME         PIC X(6).
  1997             20  CO-CTL-2.
  1998                 24  CO-ACCOUNT.
  1999                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  42
* EL652.cbl
  2000                     28  CO-ACCT-PRIME         PIC X(6).
  2001         16  CO-TYPE                           PIC X.
  2002             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2003             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2004             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2005
  2006     12  CO-MAINT-INFORMATION.
  2007         16  CO-LAST-MAINT-DT                  PIC XX.
  2008         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2009         16  CO-LAST-MAINT-USER                PIC X(4).
  2010     12  FILLER                                PIC XX.
  2011     12  CO-STMT-TYPE                          PIC XXX.
  2012     12  CO-COMP-TYPE                          PIC X.
  2013         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2014     12  CO-STMT-OWNER                         PIC X(4).
  2015     12  CO-BALANCE-CONTROL                    PIC X.
  2016         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2017         88  CO-NO-BALANCE                        VALUE 'N'.
  2018
  2019     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2020         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2021         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2022         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2023
  2024     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2025         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2026         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2027
  2028     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2029     12  CO-GA-DIRECT-DEP                      PIC X.
  2030     12  CO-FUTURE-SPACE                       PIC X.
  2031         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2032
  2033     12  CO-ACCT-NAME                          PIC X(30).
  2034     12  CO-MAIL-NAME                          PIC X(30).
  2035     12  CO-ADDR-1                             PIC X(30).
  2036     12  CO-ADDR-2                             PIC X(30).
  2037     12  CO-ADDR-3.
  2038         16  CO-ADDR-CITY                      PIC X(27).
  2039         16  CO-ADDR-STATE                     PIC XX.
  2040     12  CO-CSO-1099                           PIC X.
  2041     12  CO-ZIP.
  2042         16  CO-ZIP-PRIME.
  2043             20  CO-ZIP-PRI-1ST                PIC X.
  2044                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2045             20  FILLER                        PIC X(4).
  2046         16  CO-ZIP-PLUS4                      PIC X(4).
  2047     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2048         16  CO-CAN-POSTAL-1                   PIC XXX.
  2049         16  CO-CAN-POSTAL-2                   PIC XXX.
  2050         16  FILLER                            PIC XXX.
  2051     12  CO-SOC-SEC                            PIC X(13).
  2052     12  CO-TELEPHONE.
  2053         16  CO-AREA-CODE                      PIC XXX.
  2054         16  CO-PREFIX                         PIC XXX.
  2055         16  CO-PHONE                          PIC X(4).
  2056
  2057     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  43
* EL652.cbl
  2058
  2059     12  CO-AR-BAL-LEVEL                       PIC X.
  2060         88  CO-AR-REF-LVL                        VALUE '1'.
  2061         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2062         88  CO-AR-BILL-LVL                       VALUE '2'.
  2063         88  CO-AR-AGT-LVL                        VALUE '3'.
  2064         88  CO-AR-FR-LVL                         VALUE '4'.
  2065
  2066     12  CO-AR-NORMAL-PRINT                    PIC X.
  2067         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2068         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2069
  2070     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2071
  2072     12  CO-AR-REPORTING                       PIC X.
  2073         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2074         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2075
  2076     12  CO-AR-PULL-CHECK                      PIC X.
  2077         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2078         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2079
  2080     12  CO-AR-BALANCE-PRINT                   PIC X.
  2081         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2082
  2083     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2084         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2085         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2086         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2087
  2088     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2089
  2090     12  CO-USER-CODE                          PIC X.
  2091     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2092
  2093******************************************************************
  2094*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2095*    THE LAST MONTH END RUN.
  2096******************************************************************
  2097
  2098     12  CO-LAST-ACTIVITY-DATE.
  2099         16  CO-ACT-YEAR                       PIC 99.
  2100         16  CO-ACT-MONTH                      PIC 99.
  2101         16  CO-ACT-DAY                        PIC 99.
  2102
  2103     12  CO-LAST-STMT-DT.
  2104         16  CO-LAST-STMT-YEAR                 PIC 99.
  2105         16  CO-LAST-STMT-MONTH                PIC 99.
  2106         16  CO-LAST-STMT-DAY                  PIC 99.
  2107
  2108     12  CO-MO-END-TOTALS.
  2109         16  CO-MONTHLY-TOTALS.
  2110             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2111             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2112             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2113             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2114             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  2115
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  44
* EL652.cbl
  2116         16  CO-AGING-TOTALS.
  2117             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2118             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2119             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2120             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2121
  2122         16  CO-YTD-TOTALS.
  2123             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2124             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2125
  2126         16  CO-OVER-UNDER-TOTALS.
  2127             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2128             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2129
  2130     12  CO-MISCELLANEOUS-TOTALS.
  2131         16  CO-FICA-TOTALS.
  2132             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2133             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2134
  2135         16  CO-CLAIM-TOTALS.
  2136             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2137             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2138
  2139******************************************************************
  2140*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2141*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2142******************************************************************
  2143
  2144     12  CO-CURRENT-TOTALS.
  2145         16  CO-CURRENT-LAST-STMT-DT.
  2146             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2147             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2148             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2149
  2150         16  CO-CURRENT-MONTHLY-TOTALS.
  2151             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2152             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2153             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2154             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2155             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2156
  2157         16  CO-CURRENT-AGING-TOTALS.
  2158             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2159             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2160             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2161             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2162
  2163         16  CO-CURRENT-YTD-TOTALS.
  2164             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2165             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2166
  2167     12  CO-PAID-COMM-TOTALS.
  2168         16  CO-YTD-PAID-COMMS.
  2169             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2170             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2171
  2172     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  2173         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  45
* EL652.cbl
  2174         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2175
  2176     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2177         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2178         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2179         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2180         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2181         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2182         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2183         88  CO-FINAL-LETTER                  VALUE 'F'.
  2184         88  CO-RECONCILING                   VALUE 'R'.
  2185         88  CO-PHONE-CALL                    VALUE 'P'.
  2186         88  CO-LEGAL                         VALUE 'L'.
  2187         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2188         88  CO-WRITE-OFF                     VALUE 'W'.
  2189         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2190
  2191     12  CO-CSR-CODE                       PIC X(4).
  2192
  2193     12  CO-GA-STATUS-INFO.
  2194         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2195         16  CO-GA-TERMINATION-DT          PIC XX.
  2196         16  CO-GA-STATUS-CODE             PIC X.
  2197             88  CO-GA-ACTIVE                 VALUE 'A'.
  2198             88  CO-GA-INACTIVE               VALUE 'I'.
  2199             88  CO-GA-PENDING                VALUE 'P'.
  2200         16  CO-GA-COMMENTS.
  2201             20  CO-GA-COMMENT-1           PIC X(40).
  2202             20  CO-GA-COMMENT-2           PIC X(40).
  2203             20  CO-GA-COMMENT-3           PIC X(40).
  2204             20  CO-GA-COMMENT-4           PIC X(40).
  2205
  2206     12  CO-RPTCD2                         PIC X(10).
  2207
  2208     12  CO-TYPE-AGENT                     PIC X(01).
  2209         88  CO-CORPORATION                   VALUE 'C'.
  2210         88  CO-PARTNERSHIP                   VALUE 'P'.
  2211         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2212         88  CO-TRUST                         VALUE 'T'.
  2213         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2214
  2215     12  CO-FAXNO.
  2216         16  CO-FAX-AREA-CODE                  PIC XXX.
  2217         16  CO-FAX-PREFIX                     PIC XXX.
  2218         16  CO-FAX-PHONE                      PIC X(4).
  2219
  2220     12  CO-BANK-INFORMATION.
  2221         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2222         16  CO-BANK-TRANSIT-NON REDEFINES
  2223             CO-BANK-TRANSIT-NO                PIC 9(8).
  2224
  2225         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2226     12  CO-MISC-DEDUCT-INFO REDEFINES
  2227                  CO-BANK-INFORMATION.
  2228         16  CO-MD-GL-ACCT                     PIC X(10).
  2229         16  CO-MD-DIV                         PIC XX.
  2230         16  CO-MD-CENTER                      PIC X(4).
  2231         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  46
* EL652.cbl
  2232         16  CO-CREATE-AP-CHECK                PIC X.
  2233         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2234         16  FILLER                            PIC XXX.
  2235     12  CO-ACH-STATUS                         PIC X.
  2236         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2237         88  CO-ACH-PENDING                        VALUE 'P'.
  2238
  2239     12  CO-BILL-SW                            PIC X.
  2240     12  CO-CONTROL-NAME                       PIC X(30).
  2241     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2242     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2243     12  CO-CLP-STATE                          PIC XX.
  2244     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2245     12  CO-SPP-REFUND-EDIT                    PIC X.
  2246
  2247******************************************************************
  2248*                            COPY ERCAGTC.
  2249******************************************************************
  2250*                                                                *
  2251*                                                                *
  2252*                            ERCAGTC                             *
  2253*                            VMOD=2.001                          *
  2254*                                                                *
  2255*   ONLINE CREDIT SYSTEM                                         *
  2256*                                                                *
  2257*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2258*                                                                *
  2259*   FILE TYPE = VSAM,KSDS                                        *
  2260*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2261*                                                                *
  2262*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2263*       ALTERNATE PATH = NONE                                    *
  2264*                                                                *
  2265*   LOG = NO                                                     *
  2266*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2267*                                                                *
  2268******************************************************************
  2269*                   C H A N G E   L O G
  2270*
  2271* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2272*-----------------------------------------------------------------
  2273*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2274* EFFECTIVE    NUMBER
  2275*-----------------------------------------------------------------
  2276* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2277* 111004                         NEW FILE AND COPYBOOK
  2278* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2279******************************************************************
  2280 01  AGENT-COMMISSIONS.
  2281     12  AG-RECORD-ID                          PIC XX.
  2282         88  VALID-CO-ID                          VALUE 'AG'.
  2283     12  AG-CONTROL-PRIMARY.
  2284         16  AG-COMPANY-CD                     PIC X.
  2285         16  AG-CONTROL.
  2286             20  AG-CTL-1.
  2287                 24  AG-CARR-GROUP.
  2288                     28  AG-CARRIER            PIC X.
  2289                     28  AG-GROUPING           PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  47
* EL652.cbl
  2290                 24  AG-BANK                   PIC X(10).
  2291             20  AG-CTL-2.
  2292                 24  AG-EXP-DT                 PIC XX.
  2293         16  AG-TYPE                           PIC X.
  2294             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2295             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2296     12  AG-MAINT-INFORMATION.
  2297         16  AG-LAST-MAINT-DT                  PIC XX.
  2298         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2299         16  AG-LAST-MAINT-USER                PIC X(4).
  2300         16  FILLER                            PIC X(10).
  2301     12  AG-EFF-DT                             PIC XX.
  2302     12  AG-COMM-STRUCTURE.
  2303         16  AG-AGT-COMMS OCCURS 10.
  2304             20  AG-AGT                PIC X(10).
  2305             20  AG-COM-TYP            PIC X.
  2306             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2307             20  AG-RECALC-LV-INDIC    PIC X.
  2308             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2309             20  AG-LRCALC-LV-INDIC    PIC X.
  2310             20  FILLER                PIC X(05).
  2311     12  FILLER                  PIC X(145).
  2312******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  48
* EL652.cbl
  2314*                            COPY ERCNAME.
  2315******************************************************************
  2316*                                                                *
  2317*                                                                *
  2318*                            ERCNAME                             *
  2319*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2320*                            VMOD=2.003                          *
  2321*                                                                *
  2322*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  2323*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  2324*                                                                *
  2325*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  2326*                                                                *
  2327*   FILE TYPE = VSAM,KSDS                                        *
  2328*   RECORD SIZE = 160   RECFORM = FIX                            *
  2329*                                                                *
  2330*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  2331*                                                                *
  2332*   LOG = NO                                                     *
  2333*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2334*                                                                *
  2335*                                                                *
  2336******************************************************************
  2337
  2338 01  NAME-LOOKUP-MASTER.
  2339     12  NL-RECORD-ID                PIC  X(02).
  2340         88  VALID-NL-ID                         VALUE 'NL'.
  2341
  2342     12  NL-RECORD-KEY.
  2343         16  NL-CONTROL-PRIMARY.
  2344             20  NL-COMPANY-CD       PIC  X(01).
  2345             20  NL-NAME             PIC  X(30).
  2346             20  NL-RECORD-TYPE      PIC  X(01).
  2347                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  2348                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  2349                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  2350
  2351         16  NL-ACCOUNT-MASTER.
  2352             20  NL-AM-COMPANY-CD    PIC  X(01).
  2353             20  NL-AM-CARRIER       PIC  X(01).
  2354             20  NL-AM-GROUPING      PIC  X(06).
  2355             20  NL-AM-STATE         PIC  X(02).
  2356             20  NL-AM-ACCOUNT       PIC  X(10).
  2357             20  FILLER              PIC  X(09).
  2358
  2359         16  NL-COMPENSATION-MASTER
  2360                                 REDEFINES  NL-ACCOUNT-MASTER.
  2361             20  NL-CO-COMPANY-CD    PIC  X(01).
  2362             20  NL-CO-CARRIER       PIC  X(01).
  2363             20  NL-CO-GROUPING      PIC  X(06).
  2364             20  NL-CO-RESP-NO       PIC  X(10).
  2365             20  NL-CO-ACCOUNT       PIC  X(10).
  2366             20  NL-CO-TYPE          PIC  X(01).
  2367
  2368         16  NL-REINSURANCE-RECORD
  2369                                 REDEFINES  NL-ACCOUNT-MASTER.
  2370             20  NL-RE-COMPANY-CD    PIC  X(01).
  2371             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  49
* EL652.cbl
  2372             20  NL-RE-COMPANY.
  2373                 24  NL-RE-COMP      PIC  X(03).
  2374                 24  NL-RE-CO-SUB    PIC  X(03).
  2375             20  NL-RE-TABLE         PIC  X(03).
  2376             20  FILLER              PIC  X(18).
  2377
  2378     12  NL-MAINT-INFORMATION.
  2379         16  NL-LAST-MAINT-DT        PIC  X(02).
  2380         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  2381         16  NL-LAST-MAINT-USER      PIC  X(04).
  2382         16  FILLER                  PIC  X(10).
  2383
  2384     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  2385         16  NL-RE-LEVEL             PIC  9(02).
  2386
  2387     12  NL-CITY                     PIC  X(15).
  2388     12  NL-ST                       PIC  XX.
  2389
  2390******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  50
* EL652.cbl
  2392*                            COPY ELCCNTL.
  2393******************************************************************
  2394*                                                                *
  2395*                                                                *
  2396*                            ELCCNTL.                            *
  2397*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2398*                            VMOD=2.059                          *
  2399*                                                                *
  2400*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2401*                                                                *
  2402*   FILE TYPE = VSAM,KSDS                                        *
  2403*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2404*                                                                *
  2405*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2406*       ALTERNATE INDEX = NONE                                   *
  2407*                                                                *
  2408*   LOG = YES                                                    *
  2409*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2410******************************************************************
  2411*                   C H A N G E   L O G
  2412*
  2413* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2414*-----------------------------------------------------------------
  2415*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2416* EFFECTIVE    NUMBER
  2417*-----------------------------------------------------------------
  2418* 082503                   PEMA  ADD BENEFIT GROUP
  2419* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2420* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2421* 092705    2005050300006  PEMA  ADD SPP LEASES
  2422* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2423* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2424* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2425* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2426******************************************************************
  2427*
  2428 01  CONTROL-FILE.
  2429     12  CF-RECORD-ID                       PIC XX.
  2430         88  VALID-CF-ID                        VALUE 'CF'.
  2431
  2432     12  CF-CONTROL-PRIMARY.
  2433         16  CF-COMPANY-ID                  PIC XXX.
  2434         16  CF-RECORD-TYPE                 PIC X.
  2435             88  CF-COMPANY-MASTER              VALUE '1'.
  2436             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2437             88  CF-STATE-MASTER                VALUE '3'.
  2438             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2439             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2440             88  CF-CARRIER-MASTER              VALUE '6'.
  2441             88  CF-MORTALITY-MASTER            VALUE '7'.
  2442             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2443             88  CF-TERMINAL-MASTER             VALUE '9'.
  2444             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2445             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2446             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2447             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2448             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2449             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  51
* EL652.cbl
  2450             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2451             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2452             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2453         16  CF-ACCESS-CD-GENL              PIC X(4).
  2454         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2455             20  CF-PROCESSOR               PIC X(4).
  2456         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2457             20  CF-STATE-CODE              PIC XX.
  2458             20  FILLER                     PIC XX.
  2459         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2460             20  FILLER                     PIC XX.
  2461             20  CF-HI-BEN-IN-REC           PIC XX.
  2462         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2463             20  FILLER                     PIC XXX.
  2464             20  CF-CARRIER-CNTL            PIC X.
  2465         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2466             20  FILLER                     PIC XX.
  2467             20  CF-HI-TYPE-IN-REC          PIC 99.
  2468         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2469             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2470                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2471             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2472             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2473         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2474             20  FILLER                     PIC X.
  2475             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2476         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2477             20  FILLER                     PIC XX.
  2478             20  CF-MORTGAGE-PLAN           PIC XX.
  2479         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2480
  2481     12  CF-LAST-MAINT-DT                   PIC XX.
  2482     12  CF-LAST-MAINT-BY                   PIC X(4).
  2483     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2484
  2485     12  CF-RECORD-BODY                     PIC X(728).
  2486
  2487
  2488****************************************************************
  2489*             COMPANY MASTER RECORD                            *
  2490****************************************************************
  2491
  2492     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2493         16  CF-COMPANY-ADDRESS.
  2494             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2495             20  CF-CL-IN-CARE-OF           PIC X(30).
  2496             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2497             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2498             20  CF-CL-CITY-STATE           PIC X(30).
  2499             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2500             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2501         16  CF-COMPANY-CD                  PIC X.
  2502         16  CF-COMPANY-PASSWORD            PIC X(8).
  2503         16  CF-SECURITY-OPTION             PIC X.
  2504             88  ALL-SECURITY                   VALUE '1'.
  2505             88  COMPANY-VERIFY                 VALUE '2'.
  2506             88  PROCESSOR-VERIFY               VALUE '3'.
  2507             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  52
* EL652.cbl
  2508             88  ALL-BUT-TERM                   VALUE '5'.
  2509         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2510             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2511         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2512             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2513         16  CF-INFORCE-LOCATION            PIC X.
  2514             88  CERTS-ARE-ONLINE               VALUE '1'.
  2515             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2516             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2517         16  CF-LOWER-CASE-LETTERS          PIC X.
  2518         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2519             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2520             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2521             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2522             88  CF-ACCNT-CNTL                  VALUE '3'.
  2523             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2524
  2525         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2526         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2527
  2528         16  CF-LGX-CREDIT-USER             PIC X.
  2529             88  CO-IS-NOT-USER                 VALUE 'N'.
  2530             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2531
  2532         16 CF-CREDIT-CALC-CODES.
  2533             20  CF-CR-REM-TERM-CALC PIC X.
  2534               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2535               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2536               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2537               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2538               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2539               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2540               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2541             20  CF-CR-R78-METHOD           PIC X.
  2542               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2543               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2544
  2545         16  CF-CLAIM-CONTROL-COUNTS.
  2546             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2547                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2548
  2549             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2550                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2551
  2552             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2553                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2554
  2555             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2556                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2557
  2558         16  CF-CURRENT-MONTH-END           PIC XX.
  2559
  2560         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2561             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2562             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2563             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2564             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2565                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  53
* EL652.cbl
  2566                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2567             20  CF-CO-PREM-REJECT-SW       PIC X.
  2568                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2569                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2570             20  CF-CO-REF-REJECT-SW        PIC X.
  2571                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2572                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2573
  2574         16  CF-CO-REPORTING-DT             PIC XX.
  2575         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2576         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2577           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2578           88  CF-CO-MONTH-END                  VALUE '1'.
  2579
  2580         16  CF-LGX-CLAIM-USER              PIC X.
  2581             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2582             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2583
  2584         16  CF-CREDIT-EDIT-CONTROLS.
  2585             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2586             20  CF-MIN-AGE                 PIC 99.
  2587             20  CF-DEFAULT-AGE             PIC 99.
  2588             20  CF-MIN-TERM                PIC S999      COMP-3.
  2589             20  CF-MAX-TERM                PIC S999      COMP-3.
  2590             20  CF-DEFAULT-SEX             PIC X.
  2591             20  CF-JOINT-AGE-INPUT         PIC X.
  2592                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2593             20  CF-BIRTH-DATE-INPUT        PIC X.
  2594                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2595             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2596                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2597                 88  CF-ZERO-CARRIER            VALUE '1'.
  2598                 88  CF-ZERO-GROUPING           VALUE '2'.
  2599                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2600             20  CF-EDIT-SW                 PIC X.
  2601                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2602             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2603             20  CF-CR-PR-METHOD            PIC X.
  2604               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2605               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2606             20  FILLER                     PIC X.
  2607
  2608         16  CF-CREDIT-MISC-CONTROLS.
  2609             20  CF-REIN-TABLE-SW           PIC X.
  2610                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2611             20  CF-COMP-TABLE-SW           PIC X.
  2612                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2613             20  CF-EXPERIENCE-RETENTION-AGE
  2614                                            PIC S9        COMP-3.
  2615             20  CF-CONVERSION-DT           PIC XX.
  2616             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2617             20  CF-RUN-FREQUENCY-SW        PIC X.
  2618                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2619                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2620
  2621             20  CF-CR-CHECK-NO-CONTROL.
  2622                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2623                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  54
* EL652.cbl
  2624                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2625                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2626                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2627                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2628
  2629                 24  CF-CR-CHECK-COUNT       REDEFINES
  2630                     CF-CR-CHECK-COUNTER      PIC X(4).
  2631
  2632                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2633                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2634
  2635                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2636                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2637                 24  CF-MAIL-PROCESSING       PIC X.
  2638                     88  MAIL-PROCESSING          VALUE 'Y'.
  2639
  2640         16  CF-MISC-SYSTEM-CONTROL.
  2641             20  CF-SYSTEM-C                 PIC X.
  2642                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2643             20  CF-SYSTEM-D                 PIC X.
  2644                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2645             20  CF-SOC-SEC-NO-SW            PIC X.
  2646                 88  SOC-SEC-NO-USED             VALUE '1'.
  2647             20  CF-MEMBER-NO-SW             PIC X.
  2648                 88  MEMBER-NO-USED              VALUE '1'.
  2649             20  CF-TAX-ID-NUMBER            PIC X(11).
  2650             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2651             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2652                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2653                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2654                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2655                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2656             20  CF-SYSTEM-E                 PIC X.
  2657                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2658
  2659         16  CF-LGX-LIFE-USER               PIC X.
  2660             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2661             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2662
  2663         16  CF-CR-MONTH-END-DT             PIC XX.
  2664
  2665         16  CF-FILE-MAINT-DATES.
  2666             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2667                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2668             20  CF-LAST-BATCH       REDEFINES
  2669                 CF-LAST-BATCH-NO               PIC X(4).
  2670             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2671             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2672             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2673             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2674             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2675             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2676             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2677             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2678             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2679             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2680
  2681         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  55
* EL652.cbl
  2682         16  FILLER                         PIC X.
  2683
  2684         16  CF-ALT-MORT-CODE               PIC X(4).
  2685         16  CF-MEMBER-CAPTION              PIC X(10).
  2686
  2687         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2688             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2689             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2690             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2691             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2692             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2693
  2694         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2695
  2696         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2697         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2698         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2699         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2700
  2701         16  CF-AH-OVERRIDE-L1              PIC X.
  2702         16  CF-AH-OVERRIDE-L2              PIC XX.
  2703         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2704         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2705
  2706         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2707         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2708
  2709         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2710         16  CF-AR-LAST-EL860-DT            PIC XX.
  2711         16  CF-MP-MONTH-END-DT             PIC XX.
  2712
  2713         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2714         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2715             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2716
  2717         16  CF-AR-MONTH-END-DT             PIC XX.
  2718
  2719         16  CF-CRDTCRD-USER                PIC X.
  2720             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2721             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2722
  2723         16  CF-CC-MONTH-END-DT             PIC XX.
  2724
  2725         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2726
  2727         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2728             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2729             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2730             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2731         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2732         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2733         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2734         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2735             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2736             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2737         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2738         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2739         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  56
* EL652.cbl
  2740             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2741         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2742
  2743         16  CF-CL-ZIP-CODE.
  2744             20  CF-CL-ZIP-PRIME.
  2745                 24  CF-CL-ZIP-1ST          PIC X.
  2746                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2747                 24  FILLER                 PIC X(4).
  2748             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2749         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2750             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2751             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2752             20  FILLER                     PIC XXX.
  2753
  2754         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2755         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2756         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2757         16  CF-CO-OPTION-START-DATE        PIC XX.
  2758         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2759           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2760                                                      '3' '4'.
  2761           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2762           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2763           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2764           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2765           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2766           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2767
  2768         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2769
  2770         16  CF-PAYMENT-APPROVAL-LEVELS.
  2771             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2772             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2773             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2774             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2775             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2776             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2777
  2778         16  CF-END-USER-REPORTING-USER     PIC X.
  2779             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2780             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2781
  2782         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2783             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2784             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2785
  2786         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2787
  2788         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2789         16  FILLER                         PIC X.
  2790
  2791         16  CF-CREDIT-ARCHIVE-CNTL.
  2792             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2793             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2794             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2795
  2796         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2797
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  57
* EL652.cbl
  2798         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2799             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2800             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2801
  2802         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2803             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2804             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2805
  2806         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2807
  2808         16  CF-CO-ACH-ID-CODE              PIC  X.
  2809             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2810             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2811             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2812         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2813         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2814         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2815         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2816         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2817         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2818         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2819         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2820         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2821                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2822         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2823                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2824
  2825         16  CF-CO-OVER-SHORT.
  2826             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2827             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2828
  2829*         16  FILLER                         PIC X(102).
  2830         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2831             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2832             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2833
  2834         16  CF-AH-APPROVAL-DAYS.
  2835             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2836             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2837             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2838             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2839
  2840         16  FILLER                         PIC X(82).
  2841****************************************************************
  2842*             PROCESSOR/USER RECORD                            *
  2843****************************************************************
  2844
  2845     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2846         16  CF-PROCESSOR-NAME              PIC X(30).
  2847         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2848         16  CF-PROCESSOR-TITLE             PIC X(26).
  2849         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2850                 88  MESSAGE-YES                VALUE 'Y'.
  2851                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2852
  2853*****************************************************
  2854****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2855****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  58
* EL652.cbl
  2856****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2857****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2858*****************************************************
  2859
  2860         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2861             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2862             20  CF-APPLICATION-FORCE       PIC X.
  2863             20  CF-INDIVIDUAL-APP.
  2864                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2865                     28  CF-BROWSE-APP      PIC X.
  2866                     28  CF-UPDATE-APP      PIC X.
  2867
  2868         16  CF-CURRENT-TERM-ON             PIC X(4).
  2869         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2870             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2871             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2872             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2873             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2874             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2875             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2876             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2877         16  CF-PROCESSOR-CARRIER           PIC X.
  2878             88  NO-CARRIER-SECURITY            VALUE ' '.
  2879         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2880             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2881         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2882             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2883         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2884             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2885
  2886         16  CF-PROC-SYS-ACCESS-SW.
  2887             20  CF-PROC-CREDIT-CLAIMS-SW.
  2888                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2889                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2890                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2891                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2892             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2893                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2894                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2895             20  CF-PROC-LIFE-GNRLDGR-SW.
  2896                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2897                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2898                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2899                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2900             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2901                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2902                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2903         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2904             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2905             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2906         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2907
  2908         16  CF-APPROVAL-LEVEL                  PIC X.
  2909             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2910             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2911             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2912             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2913
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  59
* EL652.cbl
  2914         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2915
  2916         16  CF-LANGUAGE-TYPE                   PIC X.
  2917             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2918             88  CF-LANG-IS-FR                      VALUE 'F'.
  2919         16  FILLER                             PIC  X(240).
  2920
  2921****************************************************************
  2922*             PROCESSOR/REMINDERS RECORD                       *
  2923****************************************************************
  2924
  2925     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2926         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2927             20  CF-START-REMIND-DT         PIC XX.
  2928             20  CF-END-REMIND-DT           PIC XX.
  2929             20  CF-REMINDER-TEXT           PIC X(50).
  2930         16  FILLER                         PIC X(296).
  2931
  2932
  2933****************************************************************
  2934*             STATE MASTER RECORD                              *
  2935****************************************************************
  2936
  2937     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2938         16  CF-STATE-ABBREVIATION          PIC XX.
  2939         16  CF-STATE-NAME                  PIC X(25).
  2940         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2941         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2942             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2943             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2944             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2945             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2946                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2947                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2948             20  CF-ST-PREM-REJECT-SW       PIC X.
  2949                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2950                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2951             20  CF-ST-REF-REJECT-SW        PIC X.
  2952                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2953                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2954         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2955         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2956         16  CF-ST-REFUND-RULES.
  2957             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2958             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2959             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2960         16  CF-ST-FST-PMT-EXTENSION.
  2961             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2962             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2963                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2964                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2965                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2966                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2967         16  CF-ST-STATE-CALL.
  2968             20  CF-ST-CALL-UNEARNED        PIC X.
  2969             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2970             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2971         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  60
* EL652.cbl
  2972             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2973             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2974         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2975         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2976         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2977         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2978         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2979         16  FILLER                         PIC X.
  2980         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2981             20  CF-ST-BENEFIT-CD           PIC XX.
  2982             20  CF-ST-BENEFIT-KIND         PIC X.
  2983                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2984                 88  CF-ST-AH-KIND              VALUE 'A'.
  2985             20  CF-ST-REM-TERM-CALC        PIC X.
  2986                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2987                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2988                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2989                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2990                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2991                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2992                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2993                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2994
  2995             20  CF-ST-REFUND-CALC          PIC X.
  2996                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2997                 88  ST-REFD-BY-R78             VALUE '1'.
  2998                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2999                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3000                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3001                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3002                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3003                 88  ST-REFD-UTAH               VALUE '7'.
  3004                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3005                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3006                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3007
  3008             20  CF-ST-EARNING-CALC         PIC X.
  3009                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3010                 88  ST-EARN-BY-R78             VALUE '1'.
  3011                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3012                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3013                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3014                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3015                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3016                 88  ST-EARN-MEAN               VALUE '8'.
  3017                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3018
  3019             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3020                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3021                 88  ST-OVRD-BY-R78             VALUE '1'.
  3022                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3023                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3024                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3025                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3026                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3027                 88  ST-OVRD-MEAN               VALUE '8'.
  3028                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3029             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  61
* EL652.cbl
  3030
  3031         16  CF-ST-COMMISSION-CAPS.
  3032             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3033             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3034             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3035             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3036         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3037                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3038
  3039         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3040
  3041         16  CF-ST-STATUTORY-INTEREST.
  3042             20  CF-ST-STAT-DATE-FROM       PIC X.
  3043                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3044                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3045             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3046             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3047             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3048             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3049             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3050
  3051         16  CF-ST-OVER-SHORT.
  3052             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3053             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3054
  3055         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3056
  3057         16  CF-ST-RT-CALC                  PIC X.
  3058
  3059         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3060         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3061         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3062         16  CF-ST-RF-LR-CALC               PIC X.
  3063         16  CF-ST-RF-LL-CALC               PIC X.
  3064         16  CF-ST-RF-LN-CALC               PIC X.
  3065         16  CF-ST-RF-AH-CALC               PIC X.
  3066         16  CF-ST-RF-CP-CALC               PIC X.
  3067*        16  FILLER                         PIC X(206).
  3068*CIDMOD         16  FILLER                         PIC X(192).
  3069         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3070             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3071         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3072         16  FILLER                         PIC X(187).
  3073
  3074****************************************************************
  3075*             BENEFIT MASTER RECORD                            *
  3076****************************************************************
  3077
  3078     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3079         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3080             20  CF-BENEFIT-CODE            PIC XX.
  3081             20  CF-BENEFIT-NUMERIC  REDEFINES
  3082                 CF-BENEFIT-CODE            PIC XX.
  3083             20  CF-BENEFIT-ALPHA           PIC XXX.
  3084             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3085             20  CF-BENEFIT-COMMENT         PIC X(10).
  3086
  3087             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  62
* EL652.cbl
  3088                 88  CF-REDUCING                VALUE 'R'.
  3089                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3090
  3091             20  CF-SPECIAL-CALC-CD         PIC X.
  3092                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3093                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3094                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3095                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3096                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3097                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3098                 88  CF-FARM-PLAN               VALUE 'F'.
  3099                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3100                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3101                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3102                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3103                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3104                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3105                 88  CF-PRUDENTIAL              VALUE 'P'.
  3106                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3107                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3108                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3109                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3110                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3111                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3112
  3113             20  CF-JOINT-INDICATOR         PIC X.
  3114                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3115
  3116*            20  FILLER                     PIC X(12).
  3117             20  FILLER                     PIC X(11).
  3118             20  CF-BENEFIT-CATEGORY        PIC X.
  3119             20  CF-LOAN-TYPE               PIC X(8).
  3120
  3121             20  CF-CO-REM-TERM-CALC        PIC X.
  3122                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3123                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3124                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3125                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3126                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3127
  3128             20  CF-CO-EARNINGS-CALC        PIC X.
  3129                 88  CO-EARN-BY-R78             VALUE '1'.
  3130                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3131                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3132                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3133                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3134                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3135                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3136                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3137
  3138             20  CF-CO-REFUND-CALC          PIC X.
  3139                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3140                 88  CO-REFD-BY-R78             VALUE '1'.
  3141                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3142                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3143                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3144                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3145                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  63
* EL652.cbl
  3146                 88  CO-REFD-MEAN               VALUE '8'.
  3147                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3148                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3149                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3150
  3151             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3152                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3153                 88  CO-OVRD-BY-R78             VALUE '1'.
  3154                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3155                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3156                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3157                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3158                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3159                 88  CO-OVRD-MEAN               VALUE '8'.
  3160                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3161
  3162             20  CF-CO-BEN-I-G-CD           PIC X.
  3163                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3164                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3165                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3166
  3167         16  FILLER                         PIC X(304).
  3168
  3169
  3170****************************************************************
  3171*             CARRIER MASTER RECORD                            *
  3172****************************************************************
  3173
  3174     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3175         16  CF-ADDRESS-DATA.
  3176             20  CF-MAIL-TO-NAME            PIC X(30).
  3177             20  CF-IN-CARE-OF              PIC X(30).
  3178             20  CF-ADDRESS-LINE-1          PIC X(30).
  3179             20  CF-ADDRESS-LINE-2          PIC X(30).
  3180             20  CF-CITY-STATE              PIC X(30).
  3181             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3182             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3183
  3184         16  CF-CLAIM-NO-CONTROL.
  3185             20  CF-CLAIM-NO-METHOD         PIC X.
  3186                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3187                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3188                 88  CLAIM-NO-SEQ               VALUE '3'.
  3189                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3190             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3191                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3192                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3193                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3194
  3195         16  CF-CHECK-NO-CONTROL.
  3196             20  CF-CHECK-NO-METHOD         PIC X.
  3197                 88  CHECK-NO-MANUAL            VALUE '1'.
  3198                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3199                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3200                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3201             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3202                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3203
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  64
* EL652.cbl
  3204         16  CF-DOMICILE-STATE              PIC XX.
  3205
  3206         16  CF-EXPENSE-CONTROLS.
  3207             20  CF-EXPENSE-METHOD          PIC X.
  3208                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3209                 88  DOLLARS-PER-PMT            VALUE '2'.
  3210                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3211                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3212             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3213             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3214
  3215         16  CF-CORRESPONDENCE-CONTROL.
  3216             20  CF-LETTER-RESEND-OPT       PIC X.
  3217                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3218                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3219             20  FILLER                     PIC X(4).
  3220
  3221         16  CF-RESERVE-CONTROLS.
  3222             20  CF-MANUAL-SW               PIC X.
  3223                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3224             20  CF-FUTURE-SW               PIC X.
  3225                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3226             20  CF-PTC-SW                  PIC X.
  3227                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3228             20  CF-IBNR-SW                 PIC X.
  3229                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3230             20  CF-PTC-LF-SW               PIC X.
  3231                 88  CF-LF-PTC-USED             VALUE '1'.
  3232             20  CF-CDT-ACCESS-METHOD       PIC X.
  3233                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3234                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3235                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3236             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3237
  3238         16  CF-CLAIM-CALC-METHOD           PIC X.
  3239             88  360-PLUS-MONTHS                VALUE '1'.
  3240             88  365-PLUS-MONTHS                VALUE '2'.
  3241             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3242             88  360-DAILY                      VALUE '4'.
  3243             88  365-DAILY                      VALUE '5'.
  3244
  3245         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3246         16  FILLER                         PIC X(11).
  3247
  3248         16  CF-LIMIT-AMOUNTS.
  3249             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3250             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3251             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3252             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3253             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3254             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3255             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3256             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3257             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3258             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3259
  3260         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3261         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  65
* EL652.cbl
  3262         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3263
  3264         16  CF-ZIP-CODE.
  3265             20  CF-ZIP-PRIME.
  3266                 24  CF-ZIP-1ST             PIC X.
  3267                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3268                 24  FILLER                 PIC X(4).
  3269             20  CF-ZIP-PLUS4               PIC X(4).
  3270         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3271             20  CF-CAN-POSTAL-1            PIC XXX.
  3272             20  CF-CAN-POSTAL-2            PIC XXX.
  3273             20  FILLER                     PIC XXX.
  3274
  3275         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3276         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3277         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3278
  3279         16  CF-RATING-SWITCH               PIC X.
  3280             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3281             88  CF-NO-RATING                   VALUE 'N'.
  3282
  3283         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3284
  3285         16  CF-CARRIER-OVER-SHORT.
  3286             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3287             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3288
  3289         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3290         16  CF-SECPAY-SWITCH               PIC X.
  3291             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3292             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3293         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3294         16  FILLER                         PIC X(448).
  3295*        16  FILLER                         PIC X(452).
  3296
  3297
  3298****************************************************************
  3299*             MORTALITY MASTER RECORD                          *
  3300****************************************************************
  3301
  3302     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3303         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3304                                INDEXED BY CF-MORT-NDX.
  3305             20  CF-MORT-TABLE              PIC X(5).
  3306             20  CF-MORT-TABLE-TYPE         PIC X.
  3307                 88  CF-MORT-JOINT              VALUE 'J'.
  3308                 88  CF-MORT-SINGLE             VALUE 'S'.
  3309                 88  CF-MORT-COMBINED           VALUE 'C'.
  3310                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3311                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3312             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3313             20  CF-MORT-AGE-METHOD         PIC XX.
  3314                 88  CF-AGE-LAST                VALUE 'AL'.
  3315                 88  CF-AGE-NEAR                VALUE 'AN'.
  3316             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3317             20  CF-MORT-ADJUSTMENT-DIRECTION
  3318                                            PIC X.
  3319                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  66
* EL652.cbl
  3320                 88  CF-PLUS                    VALUE '+'.
  3321             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3322             20  CF-MORT-JOINT-CODE         PIC X.
  3323                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3324             20  CF-MORT-PC-Q               PIC X.
  3325                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3326             20  CF-MORT-TABLE-CODE         PIC X(4).
  3327             20  CF-MORT-COMMENTS           PIC X(15).
  3328             20  FILLER                     PIC X(14).
  3329
  3330         16  FILLER                         PIC X(251).
  3331
  3332
  3333****************************************************************
  3334*             BUSSINESS TYPE MASTER RECORD                     *
  3335****************************************************************
  3336
  3337     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3338* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3339* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3340* AND RECORD 05 IS TYPES 81-99
  3341         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3342             20  CF-BUSINESS-TITLE          PIC  X(19).
  3343             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3344                                            PIC S9V9(4) COMP-3.
  3345             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3346             20  FILLER                     PIC  X.
  3347         16  FILLER                         PIC  X(248).
  3348
  3349
  3350****************************************************************
  3351*             TERMINAL MASTER RECORD                           *
  3352****************************************************************
  3353
  3354     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3355
  3356         16  CF-COMPANY-TERMINALS.
  3357             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3358                                  PIC X(4).
  3359         16  FILLER               PIC X(248).
  3360
  3361
  3362****************************************************************
  3363*             LIFE EDIT MASTER RECORD                          *
  3364****************************************************************
  3365
  3366     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3367         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3368             20  CF-LIFE-CODE-IN            PIC XX.
  3369             20  CF-LIFE-CODE-OUT           PIC XX.
  3370         16  FILLER                         PIC X(248).
  3371
  3372
  3373****************************************************************
  3374*             AH EDIT MASTER RECORD                            *
  3375****************************************************************
  3376
  3377     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  67
* EL652.cbl
  3378         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3379             20  CF-AH-CODE-IN              PIC XXX.
  3380             20  CF-AH-CODE-OUT             PIC XX.
  3381         16  FILLER                         PIC X(248).
  3382
  3383
  3384****************************************************************
  3385*             CREDIBILITY TABLES                               *
  3386****************************************************************
  3387
  3388     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3389         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3390                             INDEXED BY CF-CRDB-NDX.
  3391             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3392             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3393             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3394         16  FILLER                         PIC  X(332).
  3395
  3396
  3397****************************************************************
  3398*             REPORT CUSTOMIZATION RECORD                      *
  3399****************************************************************
  3400
  3401     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3402         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3403             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3404             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3405             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3406**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3407****       A T-TRANSFER.                                   ****
  3408             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3409
  3410         16  FILLER                         PIC XX.
  3411
  3412         16  CF-CARRIER-CNTL-OPT.
  3413             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3414                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3415                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3416             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3417                                            PIC X.
  3418         16  CF-GROUP-CNTL-OPT.
  3419             20  CF-GROUP-OPT-SEQ           PIC 9.
  3420                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3421                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3422             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3423                                            PIC X(6).
  3424         16  CF-STATE-CNTL-OPT.
  3425             20  CF-STATE-OPT-SEQ           PIC 9.
  3426                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3427                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3428             20  CF-STATE-SELECT OCCURS 3 TIMES
  3429                                            PIC XX.
  3430         16  CF-ACCOUNT-CNTL-OPT.
  3431             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3432                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3433                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3434             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3435                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  68
* EL652.cbl
  3436         16  CF-BUS-TYP-CNTL-OPT.
  3437             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3438                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3439                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3440             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3441                                            PIC XX.
  3442         16  CF-LF-TYP-CNTL-OPT.
  3443             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3444                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3445                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3446             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3447                                            PIC XX.
  3448         16  CF-AH-TYP-CNTL-OPT.
  3449             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3450                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3451                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3452             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3453                                            PIC XX.
  3454         16  CF-REPTCD1-CNTL-OPT.
  3455             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3456                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3457                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3458             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3459                                            PIC X(10).
  3460         16  CF-REPTCD2-CNTL-OPT.
  3461             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3462                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3463                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3464             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3465                                            PIC X(10).
  3466         16  CF-USER1-CNTL-OPT.
  3467             20  CF-USER1-OPT-SEQ           PIC 9.
  3468                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3469                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3470             20  CF-USER1-SELECT OCCURS 3 TIMES
  3471                                            PIC X(10).
  3472         16  CF-USER2-CNTL-OPT.
  3473             20  CF-USER2-OPT-SEQ           PIC 9.
  3474                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3475                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3476             20  CF-USER2-SELECT OCCURS 3 TIMES
  3477                                            PIC X(10).
  3478         16  CF-USER3-CNTL-OPT.
  3479             20  CF-USER3-OPT-SEQ           PIC 9.
  3480                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3481                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3482             20  CF-USER3-SELECT OCCURS 3 TIMES
  3483                                            PIC X(10).
  3484         16  CF-USER4-CNTL-OPT.
  3485             20  CF-USER4-OPT-SEQ           PIC 9.
  3486                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3487                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3488             20  CF-USER4-SELECT OCCURS 3 TIMES
  3489                                            PIC X(10).
  3490         16  CF-USER5-CNTL-OPT.
  3491             20  CF-USER5-OPT-SEQ           PIC 9.
  3492                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3493                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  69
* EL652.cbl
  3494             20  CF-USER5-SELECT OCCURS 3 TIMES
  3495                                            PIC X(10).
  3496         16  CF-REINS-CNTL-OPT.
  3497             20  CF-REINS-OPT-SEQ           PIC 9.
  3498                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3499                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3500             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3501                 24  CF-REINS-PRIME         PIC XXX.
  3502                 24  CF-REINS-SUB           PIC XXX.
  3503
  3504         16  CF-AGENT-CNTL-OPT.
  3505             20  CF-AGENT-OPT-SEQ           PIC 9.
  3506                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3507                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3508             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3509                                            PIC X(10).
  3510
  3511         16  FILLER                         PIC X(43).
  3512
  3513         16  CF-LOSS-RATIO-SELECT.
  3514             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3515             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3516         16  CF-ENTRY-DATE-SELECT.
  3517             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3518             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3519         16  CF-EFFECTIVE-DATE-SELECT.
  3520             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3521             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3522
  3523         16  CF-EXCEPTION-LIST-IND          PIC X.
  3524             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3525
  3526         16  FILLER                         PIC X(318).
  3527
  3528****************************************************************
  3529*                  EXCEPTION REPORTING RECORD                  *
  3530****************************************************************
  3531
  3532     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3533         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3534             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3535
  3536         16  CF-COMBINED-LIFE-AH-OPT.
  3537             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3538             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3539             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3540             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3541
  3542         16  CF-LIFE-OPT.
  3543             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3544             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3545             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3546             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3547             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3548             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3549             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3550             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3551             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  70
* EL652.cbl
  3552             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3553
  3554         16  CF-AH-OPT.
  3555             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3556             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3557             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3558             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3559             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3560             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3561             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3562             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3563             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3564             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3565
  3566         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3567             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3568             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3569             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3570
  3571         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3572
  3573         16  FILLER                         PIC X(673).
  3574
  3575
  3576****************************************************************
  3577*             MORTGAGE SYSTEM PLAN RECORD                      *
  3578****************************************************************
  3579
  3580     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3581         16  CF-PLAN-TYPE                   PIC X.
  3582             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3583             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3584             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3585         16  CF-PLAN-ABBREV                 PIC XXX.
  3586         16  CF-PLAN-DESCRIPT               PIC X(10).
  3587         16  CF-PLAN-NOTES                  PIC X(20).
  3588         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3589         16  CF-PLAN-UNDERWRITING.
  3590             20  CF-PLAN-TERM-DATA.
  3591                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3592                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3593             20  CF-PLAN-AGE-DATA.
  3594                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3595                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3596                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3597             20  CF-PLAN-BENEFIT-DATA.
  3598                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3599                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3600                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3601                                            PIC S9(7)V99  COMP-3.
  3602         16  CF-PLAN-POLICY-FORMS.
  3603             20  CF-POLICY-FORM             PIC X(12).
  3604             20  CF-MASTER-APPLICATION      PIC X(12).
  3605             20  CF-MASTER-POLICY           PIC X(12).
  3606         16  CF-PLAN-RATING.
  3607             20  CF-RATE-CODE               PIC X(5).
  3608             20  CF-SEX-RATING              PIC X.
  3609                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  71
* EL652.cbl
  3610                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3611             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3612             20  CF-SUB-STD-TYPE            PIC X.
  3613                 88  CF-PCT-OF-PREM            VALUE '1'.
  3614                 88  CF-PCT-OF-BENE            VALUE '2'.
  3615         16  CF-PLAN-PREM-TOLERANCES.
  3616             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3617             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3618         16  CF-PLAN-PYMT-TOLERANCES.
  3619             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3620             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3621         16  CF-PLAN-MISC-DATA.
  3622             20  FILLER                     PIC X.
  3623             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3624             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3625         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3626         16  CF-PLAN-IND-GRP                PIC X.
  3627             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3628                                                     '1'.
  3629             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3630                                                     '2'.
  3631         16  CF-MIB-SEARCH-SW               PIC X.
  3632             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3633             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3634             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3635             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3636         16  CF-ALPHA-SEARCH-SW             PIC X.
  3637             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3638             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3639             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3640             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3641             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3642             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3643             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3644             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3645             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3646             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3647                                                     'A' 'B' 'C'
  3648                                                     'X' 'Y' 'Z'.
  3649         16  CF-EFF-DT-RULE-SW              PIC X.
  3650             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3651             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3652             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3653             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3654             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3655         16  FILLER                         PIC X(4).
  3656         16  CF-HEALTH-QUESTIONS            PIC X.
  3657             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3658         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3659         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3660         16  CF-PLAN-SNGL-JNT               PIC X.
  3661             88  CF-COMBINED-PLAN              VALUE 'C'.
  3662             88  CF-JNT-PLAN                   VALUE 'J'.
  3663             88  CF-SNGL-PLAN                  VALUE 'S'.
  3664         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3665         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3666         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3667         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  72
* EL652.cbl
  3668         16  CF-RERATE-CNTL                 PIC  X.
  3669             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3670             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3671             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3672             88  CF-AUTO-RECALC                 VALUE '4'.
  3673         16  CF-BENEFIT-TYPE                PIC  X.
  3674             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3675             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3676         16  CF-POLICY-FEE                  PIC S999V99
  3677                                                    COMP-3.
  3678         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3679         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3680         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3681         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3682         16  FILLER                         PIC  X(32).
  3683         16  CF-TERMINATION-FORM            PIC  X(04).
  3684         16  FILLER                         PIC  X(08).
  3685         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3686                                                       COMP-3.
  3687         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3688         16  CF-ISSUE-LETTER                PIC  X(4).
  3689         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3690         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3691             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3692             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3693         16  CF-MP-REFUND-CALC              PIC X.
  3694             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3695             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3696             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3697             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3698             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3699             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3700             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3701             88  CF-MP-REFD-MEAN                VALUE '8'.
  3702         16  CF-ALT-RATE-CODE               PIC  X(5).
  3703
  3704
  3705         16  FILLER                         PIC X(498).
  3706****************************************************************
  3707*             MORTGAGE COMPANY MASTER RECORD                   *
  3708****************************************************************
  3709
  3710     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3711         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3712         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3713             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3714             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3715             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3716             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3717             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3718
  3719         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3720         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3721         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3722         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3723         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3724
  3725         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  73
* EL652.cbl
  3726             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3727         16  CF-MP-RECON-USE-IND            PIC X(1).
  3728             88  CF-MP-USE-RECON             VALUE 'Y'.
  3729         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3730             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3731         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3732             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3733             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3734         16  FILLER                         PIC X(1).
  3735         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3736             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3737         16  CF-MORTG-MIB-VERSION           PIC X.
  3738             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3739             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3740             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3741         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3742             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3743                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3744             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3745                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3746             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3747                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3748             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3749                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3750             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3751                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3752             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3753                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3754         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3755         16  FILLER                         PIC X(7).
  3756         16  CF-MORTG-DESTINATION-SYMBOL.
  3757             20  CF-MORTG-MIB-COMM          PIC X(5).
  3758             20  CF-MORTG-MIB-TERM          PIC X(5).
  3759         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3760             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3761         16  FILLER                         PIC X(03).
  3762         16  CF-MP-CHECK-NO-CONTROL.
  3763             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3764                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3765                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3766                                                ' ' LOW-VALUES.
  3767                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3768                                               VALUE '3'.
  3769         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3770         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3771         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3772             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3773                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3774             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3775                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3776             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3777                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3778             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3779                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3780             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3781                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3782             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3783                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  74
* EL652.cbl
  3784         16  CF-MORTG-BILLING-AREA.
  3785             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3786                                            PIC X.
  3787         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3788         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3789         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3790         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3791             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3792             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3793         16  FILLER                         PIC X.
  3794         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3795             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3796             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3797         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3798         16  FILLER                         PIC X(8).
  3799         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3800         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3801         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3802         16  CF-ACH-COMPANY-ID.
  3803             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3804                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3805                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3806                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3807             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3808         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3809             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3810         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3811             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3812             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3813         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3814         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3815         16  FILLER                         PIC X(536).
  3816
  3817****************************************************************
  3818*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3819****************************************************************
  3820
  3821     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3822         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3823             20  CF-FEMALE-HEIGHT.
  3824                 24  CF-FEMALE-FT           PIC 99.
  3825                 24  CF-FEMALE-IN           PIC 99.
  3826             20  CF-FEMALE-MIN-WT           PIC 999.
  3827             20  CF-FEMALE-MAX-WT           PIC 999.
  3828         16  FILLER                         PIC X(428).
  3829
  3830     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3831         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3832             20  CF-MALE-HEIGHT.
  3833                 24  CF-MALE-FT             PIC 99.
  3834                 24  CF-MALE-IN             PIC 99.
  3835             20  CF-MALE-MIN-WT             PIC 999.
  3836             20  CF-MALE-MAX-WT             PIC 999.
  3837         16  FILLER                         PIC X(428).
  3838******************************************************************
  3839*             AUTOMATIC ACTIVITY RECORD                          *
  3840******************************************************************
  3841     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  75
* EL652.cbl
  3842         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3843             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3844             20  CF-SYS-LETTER-ID           PIC X(04).
  3845             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3846             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3847             20  CF-SYS-RESET-SW            PIC X(01).
  3848             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3849             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3850
  3851         16  FILLER                         PIC X(50).
  3852
  3853         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3854             20  CF-USER-ACTIVE-SW          PIC X(01).
  3855             20  CF-USER-LETTER-ID          PIC X(04).
  3856             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3857             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3858             20  CF-USER-RESET-SW           PIC X(01).
  3859             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3860             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3861             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3862
  3863         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  76
* EL652.cbl
  3865*                            COPY ERCSUMM.
  3866******************************************************************
  3867*                                                                *
  3868*                                                                *
  3869*                            ERCSUMM                             *
  3870*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3871*                            VMOD=2.002                          *
  3872*                                                                *
  3873*   ONLINE CREDIT SYSTEM                                         *
  3874*                                                                *
  3875*   FILE DESCRIPTION = AR SUMMARY CROSS REFERENCE                *
  3876*                                                                *
  3877*   FILE TYPE = VSAM,KSDS                                        *
  3878*   RECORD SIZE = 150           RECFORM = FIXED                  *
  3879*                                                                *
  3880*   BASE CLUSTER NAME = ERSUMM                   RKP=2,LEN=34    *
  3881*                                                                *
  3882*       ALTERNATE PATH1 = ERSUMM2  (BY CO SUMMARY CARR           *
  3883*                                      GROUP F.R. AGENT)         *
  3884*                                                 RKP=36 ,LEN=34 *
  3885*                                                                *
  3886*   LOG = NO                                                     *
  3887*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3888*                                                                *
  3889******************************************************************
  3890
  3891 01  SUMM-CROSS-REFERENCE.
  3892     12  SX-RECORD-ID                PIC XX.
  3893         88  VALID-SX-ID             VALUE 'SX'.
  3894
  3895     12  SX-CONTROL-PRIMARY.
  3896         16  SX-COMPANY-CD           PIC X.
  3897         16  SX-SUMMARY              PIC X(6).
  3898         16  SX-CARRIER              PIC X.
  3899         16  SX-GROUP                PIC X(6).
  3900         16  SX-FIN-RESP             PIC X(10).
  3901         16  SX-ACCT-AGENT           PIC X(10).
  3902
  3903     12  SX-CONTROL-A1.
  3904         16  SX-COMPANY-A1           PIC X.
  3905         16  SX-ACCT-AGENT-A1        PIC X(10).
  3906         16  SX-SUMMARY-A1           PIC X(6).
  3907         16  SX-CARR-A1              PIC X.
  3908         16  SX-GROUP-A1             PIC X(6).
  3909         16  SX-FIN-RESP-A1          PIC X(10).
  3910
  3911     12  SX-MAINT-INFORMATION.
  3912         16  SX-LAST-MAINT-DT        PIC XX.
  3913         16  SX-LAST-MAINT-BY        PIC X(4).
  3914         16  SX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  3915
  3916     12  SX-SUMM-OR-AGT-NAME         PIC X(30).
  3917
  3918     12  FILLER                      PIC X(40).
  3919
  3920******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  77
* EL652.cbl
  3922*                            COPY ERCRQST.
  3923******************************************************************
  3924*                                                                *
  3925*                                                                *
  3926*                            ERCRQST.                            *
  3927*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3928*                            VMOD=2.002                          *
  3929*                                                                *
  3930*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  3931*                                                                *
  3932*   FILE TYPE = VSAM,KSDS                                        *
  3933*   RECORD SIZE = 200  RECFORM = FIXED                           *
  3934*                                                                *
  3935*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  3936*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  3937*                                   ACCOUNT, REF, BATCH)         *
  3938*                                                RKP=9, LEN=38   *
  3939*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  3940*                                   ACCOUNT, REF, BATCH)         *
  3941*                                                RKP=47, LEN=46  *
  3942*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  3943*                                   BATCH)                       *
  3944*                                                RKP=93, LEN=24  *
  3945*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  3946*                                   REF, BATCH)                  *
  3947*                                                RKP=117, LEN=35 *
  3948*   LOG = NO                                                     *
  3949*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3950******************************************************************
  3951
  3952 01  AR-REQUEST-RECORD.
  3953     12  RQ-RECORD-ID                     PIC XX.
  3954         88  VALID-RQ-ID                        VALUE 'RQ'.
  3955
  3956     12  RQ-CONTROL-PRIMARY.
  3957         16  RQ-COMPANY-CD                PIC X.
  3958         16  RQ-ENTRY-BATCH               PIC X(6).
  3959
  3960     12  RQ-CONTROL-BY-ACCT-REF.
  3961         16  RQ-COMPANY-CD-A1             PIC X.
  3962         16  RQ-CARRIER-A1                PIC X.
  3963         16  RQ-GROUPING-A1               PIC X(6).
  3964         16  RQ-STATE-A1                  PIC XX.
  3965         16  RQ-ACCOUNT-A1                PIC X(10).
  3966         16  RQ-REFERENCE-A1              PIC X(12).
  3967         16  RQ-BATCH-A1                  PIC X(6).
  3968
  3969     12  RQ-CONTROL-BY-FIN-RESP.
  3970         16  RQ-COMPANY-CD-A2             PIC X.
  3971         16  RQ-CARRIER-A2                PIC X.
  3972         16  RQ-GROUPING-A2               PIC X(6).
  3973         16  RQ-FIN-RESP-A2               PIC X(10).
  3974         16  RQ-ACCT-AGENT-A2             PIC X(10).
  3975         16  RQ-REFERENCE-A2              PIC X(12).
  3976         16  RQ-BATCH-A2                  PIC X(6).
  3977
  3978     12  RQ-CONTROL-BY-ACCT-AGENT.
  3979         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  78
* EL652.cbl
  3980         16  RQ-CARRIER-A3                PIC X.
  3981         16  RQ-GROUPING-A3               PIC X(6).
  3982         16  RQ-ACCT-AGENT-A3             PIC X(10).
  3983         16  RQ-BATCH-A3                  PIC X(6).
  3984
  3985     12  RQ-CONTROL-BY-SUMMARY.
  3986         16  RQ-COMPANY-CD-A4             PIC X.
  3987         16  RQ-SUMMARY-CODE              PIC X(6).
  3988         16  RQ-ACCOUNT-A4                PIC X(10).
  3989         16  RQ-REFERENCE-A4              PIC X(12).
  3990         16  RQ-BATCH-A4                  PIC X(6).
  3991
  3992     12  RQ-REQUEST-METHOD                PIC X.
  3993         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  3994         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  3995         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  3996         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  3997     12  FILLER                           PIC X.
  3998     12  RQ-STATUS                        PIC X.
  3999         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  4000         88  RQ-RESUBMIT                      VALUE 'R'.
  4001     12  RQ-PROCESSOR-ID                  PIC X(4).
  4002     12  RQ-ENTRY-DT                      PIC XX.
  4003     12  RQ-MO-END-DT                     PIC XX.
  4004     12  RQ-REQUEST-DT                    PIC XX.
  4005     12  RQ-STMT-DT                       PIC XX.
  4006     12  RQ-REVERSAL-DT                   PIC XX.
  4007     12  RQ-CREDIT-SELECT-DT              PIC XX.
  4008     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  4009
  4010     12  FILLER                           PIC X(27).
  4011
  4012******************************************************************
  4013
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  79
* EL652.cbl
  4015 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  4016                          COMPENSATION-MASTER AGENT-COMMISSIONS
  4017                          NAME-LOOKUP-MASTER CONTROL-FILE
  4018                          SUMM-CROSS-REFERENCE
  4019                          AR-REQUEST-RECORD.
  4020 0000-DFHEXIT SECTION.
  4021     MOVE '9#                    $   ' TO DFHEIV0.
  4022     MOVE 'EL652' TO DFHEIV1.
  4023     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4024
  4025     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4026     MOVE '5'                    TO  DC-OPTION-CODE.
  4027     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  4028     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4029     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4030
  4031     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  4032     MOVE EIBTRMID               TO  QID-TERM.
  4033
  4034 1000-START.
  4035     IF EIBCALEN = ZERO
  4036         GO TO 8800-UNAUTHORIZED-ACCESS.
  4037
  4038     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  4039         MOVE PI-CALLING-PROGRAM        TO  RETURNED-FROM.
  4040
  4041     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  4042         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  4043             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  4044             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  4045             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  4046             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  4047             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  4048             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  4049             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  4050             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  4051             PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  4052         ELSE
  4053             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  4054             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  4055             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  4056             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  4057             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  4058             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  4059             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  4060             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  4061
  4062     IF  RETURNED-FROM = XCTL-633
  4063             OR
  4064         RETURNED-FROM = XCTL-633DMD
  4065             OR
  4066         RETURNED-FROM = XCTL-635
  4067             OR
  4068         RETURNED-FROM = XCTL-6521
  4069             OR
  4070         RETURNED-FROM = XCTL-6522
  4071             OR
  4072         RETURNED-FROM = XCTL-6523
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  80
* EL652.cbl
  4073             OR
  4074         RETURNED-FROM = XCTL-6524
  4075             OR
  4076         RETURNED-FROM = XCTL-689
  4077             OR
  4078         RETURNED-FROM = XCTL-690
  4079             OR
  4080         RETURNED-FROM = XCTL-650
  4081         GO TO 3475-RECOVER-TEMP-STOR-PI.
  4082
  4083
  4084* EXEC CICS HANDLE CONDITION
  4085*        NOTOPEN   (9990-ABEND)
  4086*        NOTFND    (8880-NOT-FOUND)
  4087*        PGMIDERR  (9600-PGMID-ERROR)
  4088*        ERROR     (9990-ABEND)
  4089*    END-EXEC.
  4090*    MOVE '"$JIL.                ! " #00004079' TO DFHEIV0
  4091     MOVE X'22244A494C2E202020202020' TO DFHEIV0(1:12)
  4092     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4093     MOVE X'2220233030303034303739' TO DFHEIV0(25:11)
  4094     CALL 'kxdfhei1' USING DFHEIV0
  4095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4096
  4097
  4098     IF  EIBTRNID NOT = TRANS-ID
  4099         MOVE LOW-VALUES         TO  EL652AI
  4100         IF  EIBTRNID = EM6508-TRANS-ID
  4101             MOVE DFHENTER       TO  EIBAID
  4102             MOVE 'S'            TO  MAINTYPI
  4103             MOVE PI-CARRIER     TO  CARRIERI
  4104             MOVE PI-GROUPING    TO  GROUPI
  4105             MOVE 'A'            TO  TYPEI
  4106             MOVE PI-CR-FIN-RESP TO  FINRESPI
  4107             MOVE PI-CR-ACCOUNT  TO  ACCTNOI
  4108             MOVE 1              TO  CARRIERL TYPEL MAINTYPL
  4109             MOVE 6              TO  GROUPL
  4110             MOVE 10             TO  FINRESPL  ACCTNOL
  4111             GO TO 4000-EDIT-MAINT
  4112         ELSE
  4113             IF  (EIBTRNID NOT = EL640-TRANS-ID AND
  4114                                 EL633-TRANS-ID AND
  4115                                 EL633DMD-TRANS-ID AND
  4116                                 EL635-TRANS-ID AND
  4117                                 EL642-TRANS-ID AND
  4118                                 EL6501-TRANS-ID AND
  4119                                 EL6592-TRANS-ID AND
  4120                                 EL856-TRANS-ID)
  4121                 OR PI-CR-FIN-RESP = SPACES
  4122                 GO TO 8100-SEND-INITIAL-MAP
  4123             ELSE
  4124                 MOVE DFHENTER   TO  EIBAID
  4125                 MOVE 'S'        TO  MAINTYPI
  4126                 MOVE PI-CR-CARRIER  TO  CARRIERI
  4127                 MOVE PI-CR-GROUPING TO  GROUPI
  4128                 MOVE PI-CR-TYPE     TO  TYPEI
  4129                 MOVE PI-CR-FIN-RESP TO  FINRESPI
  4130                 MOVE PI-CR-ACCOUNT  TO  ACCTNOI
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  81
* EL652.cbl
  4131                 MOVE 1              TO  CARRIERL
  4132                                         TYPEL
  4133                                         MAINTYPL
  4134                 MOVE 6              TO  GROUPL
  4135                 MOVE 10             TO  FINRESPL
  4136                                         ACCTNOL
  4137                 GO TO 4000-EDIT-MAINT.
  4138
  4139     IF  EIBAID = DFHCLEAR
  4140             OR
  4141         NOT DISPLAY-CAP
  4142         GO TO 9400-CLEAR.
  4143
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  82
* EL652.cbl
  4145 2000-RECEIVE.
  4146     MOVE LOW-VALUES             TO  EL652AI.
  4147
  4148     IF EIBAID = DFHPA1 OR  DFHPA2  OR  DFHPA3
  4149         MOVE ER-0008            TO  EMI-ERROR
  4150         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4151         MOVE -1                 TO  MAINTYPL
  4152         GO TO 8200-SEND-DATAONLY.
  4153
  4154
  4155* EXEC CICS RECEIVE
  4156*        MAP     (MAP-NAME)
  4157*        MAPSET  (MAPSET-NAME)
  4158*        INTO    (EL652AI)
  4159*    END-EXEC.
  4160     MOVE LENGTH OF
  4161      EL652AI
  4162       TO DFHEIV11
  4163*    MOVE '8"T I  L              ''   #00004142' TO DFHEIV0
  4164     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4165     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4166     MOVE X'2020233030303034313432' TO DFHEIV0(25:11)
  4167     CALL 'kxdfhei1' USING DFHEIV0,
  4168           MAP-NAME,
  4169           EL652AI,
  4170           DFHEIV11,
  4171           MAPSET-NAME,
  4172           DFHEIV99,
  4173           DFHEIV99
  4174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4175
  4176
  4177     IF PFKEYL = ZERO
  4178         GO TO 3000-CHECK-PFKEYS.
  4179
  4180     IF EIBAID NOT = DFHENTER
  4181         MOVE ER-0004            TO EMI-ERROR
  4182         GO TO 3100-INPUT-ERROR.
  4183
  4184     IF (PFKEYI NUMERIC) AND (PFKEYI > 0 AND < 25)
  4185         MOVE PF-VALUES (PFKEYI)  TO  EIBAID
  4186     ELSE
  4187         MOVE ER-0029             TO  EMI-ERROR
  4188         GO TO 3100-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  83
* EL652.cbl
  4190 3000-CHECK-PFKEYS.
  4191     IF EIBAID = DFHPF23
  4192         GO TO 8810-PF23.
  4193
  4194     IF EIBAID = DFHPF24
  4195         GO TO 9200-RETURN-MAIN-MENU.
  4196
  4197     IF EIBAID = DFHPF12
  4198         GO TO 9500-PF12.
  4199
  4200     if (maintypl not = zeros)
  4201        and (maintypi not = 'D')
  4202        move spaces              to pi-el652-del-sw
  4203     end-if
  4204     IF EIBAID = DFHPF1
  4205         IF PI-CHECK-MAINT-TYPE = 'C' OR 'D'
  4206             MOVE 'S'            TO  MAINTYPO
  4207             MOVE AL-UANON       TO  MAINTYPA
  4208             MOVE 1              TO  MAINTYPL
  4209             GO TO 7250-PAGE-FORWARD
  4210         ELSE
  4211             GO TO 7250-PAGE-FORWARD.
  4212
  4213     IF EIBAID = DFHPF2
  4214         IF PI-CHECK-MAINT-TYPE = 'C' OR 'D'
  4215             MOVE 'S'            TO  MAINTYPO
  4216             MOVE AL-UANON       TO  MAINTYPA
  4217             MOVE 1              TO  MAINTYPL
  4218             GO TO 7300-PAGE-BACKWARD
  4219         ELSE
  4220             GO TO 7300-PAGE-BACKWARD.
  4221
  4222     IF EIBAID = DFHPF3
  4223        IF PI-AR-PROCESSING
  4224            IF PI-ERCOMP-KEY  NOT =       SPACES
  4225                MOVE PI-ERC-CARRIER TO  PI-CR-CARRIER
  4226                MOVE PI-ERC-GROUP   TO  PI-CR-GROUPING
  4227                MOVE PI-ERC-RESP    TO  PI-CR-FIN-RESP
  4228                MOVE PI-ERC-ACCT    TO  PI-CR-ACCOUNT
  4229                MOVE PI-ERC-TYPE    TO  PI-CR-TYPE
  4230                IF PI-CR-ACCOUNT =  LOW-VALUES
  4231                   MOVE 'G'         TO  PI-CR-TYPE
  4232                                        PI-ERC-TYPE
  4233                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4234                   MOVE XCTL-635    TO PGM-NAME
  4235                   GO TO 9300-XCTL
  4236                ELSE
  4237                   MOVE 'A'         TO  PI-CR-TYPE
  4238                                        PI-ERC-TYPE
  4239                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4240                   MOVE XCTL-635    TO PGM-NAME
  4241                   GO TO 9300-XCTL
  4242            ELSE
  4243                MOVE ER-3021        TO  EMI-ERROR
  4244                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4245                GO TO 8100-SEND-INITIAL-MAP
  4246        ELSE
  4247            IF PI-ERCOMP-KEY NOT = SPACES AND LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  84
* EL652.cbl
  4248                MOVE PI-ERC-CARRIER TO  PI-CR-CARRIER
  4249                MOVE PI-ERC-GROUP   TO  PI-CR-GROUPING
  4250                MOVE PI-ERC-RESP    TO  PI-CR-FIN-RESP
  4251                MOVE PI-ERC-ACCT    TO  PI-CR-ACCOUNT
  4252                MOVE PI-ERC-TYPE    TO  PI-CR-TYPE
  4253                IF PI-CR-ACCOUNT =  LOW-VALUES
  4254*                  MOVE 'G'         TO  PI-CR-TYPE
  4255*                                       PI-ERC-TYPE
  4256                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4257                   IF PI-COMPANY-ID = 'DMD'
  4258                      MOVE XCTL-633DMD TO PGM-NAME
  4259                      GO TO 9300-XCTL
  4260                   ELSE
  4261                      MOVE XCTL-633    TO PGM-NAME
  4262                      GO TO 9300-XCTL
  4263                ELSE
  4264                   MOVE 'A'         TO  PI-CR-TYPE
  4265                                        PI-ERC-TYPE
  4266                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4267                   IF PI-COMPANY-ID = 'DMD'
  4268                      MOVE XCTL-633DMD TO PGM-NAME
  4269                      GO TO 9300-XCTL
  4270                   ELSE
  4271                      MOVE XCTL-633    TO PGM-NAME
  4272                      GO TO 9300-XCTL
  4273            ELSE
  4274                MOVE ER-3021        TO  EMI-ERROR
  4275                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4276                GO TO 8100-SEND-INITIAL-MAP.
  4277
  4278     IF EIBAID = DFHPF4
  4279         IF PI-ERC-TYPE = 'G' OR 'A' OR 'B'
  4280             PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4281             MOVE XCTL-6521      TO PGM-NAME
  4282             GO TO 9300-XCTL
  4283         ELSE
  4284             MOVE ER-2872        TO  EMI-ERROR
  4285             GO TO 3100-INPUT-ERROR.
  4286
  4287     IF  EIBAID = DFHPF5
  4288         MOVE XCTL-689           TO PGM-NAME
  4289         IF  PI-ERCOMP-KEY NOT = SPACES
  4290             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4291             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4292             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
  4293             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4294             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4295
  4296             IF  PI-CR-ACCOUNT =  LOW-VALUES
  4297*                MOVE 'G'        TO PI-CR-TYPE, PI-ERC-TYPE
  4298                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4299                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
  4300                 GO TO 9300-XCTL
  4301
  4302             ELSE
  4303                 MOVE 'A'        TO PI-CR-TYPE, PI-ERC-TYPE
  4304                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4305                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  85
* EL652.cbl
  4306                 GO TO 9300-XCTL
  4307
  4308         ELSE
  4309             PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4310             MOVE LOW-VALUES     TO PI-PROGRAM-WORK-AREA
  4311             GO TO 9300-XCTL.
  4312
  4313     IF  EIBAID = DFHPF6
  4314
  4315         MOVE XCTL-690           TO PGM-NAME
  4316
  4317         IF  PI-ERCOMP-KEY NOT = SPACES
  4318             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4319             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4320             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
  4321             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4322             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4323
  4324             IF  PI-CR-ACCOUNT =  LOW-VALUES
  4325*                MOVE 'G'        TO PI-CR-TYPE, PI-ERC-TYPE
  4326                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4327                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
  4328                 GO TO 9300-XCTL
  4329
  4330             ELSE
  4331                 MOVE 'A'        TO PI-CR-TYPE, PI-ERC-TYPE
  4332                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4333                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
  4334                 GO TO 9300-XCTL
  4335
  4336         ELSE
  4337             PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4338             MOVE LOW-VALUES     TO PI-PROGRAM-WORK-AREA
  4339             GO TO 9300-XCTL.
  4340
  4341     IF EIBAID = DFHPF7
  4342         IF PI-ERC-TYPE = 'A'
  4343            MOVE PI-ERC-CARRIER  TO PI-CR-CARRIER
  4344            MOVE PI-ERC-GROUP    TO PI-CR-GROUPING
  4345            MOVE PI-ERC-ACCT     TO PI-CR-ACCOUNT
  4346*           PERFORM 3200-FIND-STATE
  4347*                                THRU 3200-EXIT
  4348            MOVE PI-SAVE-STATE   TO PI-CR-STATE
  4349            PERFORM 3400-CREATE-TS-PI
  4350                                 THRU 3400-EXIT
  4351            MOVE XCTL-650        TO PGM-NAME
  4352            GO TO 9300-XCTL
  4353         ELSE
  4354            MOVE ER-0035         TO EMI-ERROR
  4355            GO TO 3100-INPUT-ERROR
  4356         END-IF
  4357     END-IF.
  4358
  4359     IF EIBAID = DFHPF8
  4360         IF PI-ERCOMP-KEY NOT = SPACES
  4361             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4362             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4363             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  86
* EL652.cbl
  4364             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4365             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4366             PERFORM 3400-CREATE-TS-PI  THRU 3400-EXIT
  4367             MOVE XCTL-6522             TO PGM-NAME
  4368             GO TO 9300-XCTL
  4369         ELSE
  4370            MOVE ER-0187                TO EMI-ERROR
  4371            GO TO 3100-INPUT-ERROR
  4372         END-IF
  4373     END-IF.
  4374
  4375*****************************************************************
  4376*  SPECIAL CODE - ENABLES DISPLAY OF PRIOR MONTH-END TOTALS*
  4377*  PF9 AVAILABLE TO A/R USERS                                   *
  4378*****************************************************************
  4379
  4380     IF PI-AR-PROCESSING OR PI-PROCESSOR-ID = 'LGXX'
  4381         IF EIBAID = DFHPF9
  4382             MOVE 'Y'            TO  WS-SHOW-SAVE-TOTALS
  4383             GO TO 4000-EDIT-MAINT.
  4384
  4385     IF EIBAID = DFHPF10
  4386        IF PI-ERC-TYPE = 'B'
  4387         IF PI-ERCOMP-KEY NOT = SPACES
  4388             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4389             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4390             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
  4391             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4392             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4393             PERFORM 3400-CREATE-TS-PI  THRU 3400-EXIT
  4394             MOVE XCTL-6523             TO PGM-NAME
  4395             GO TO 9300-XCTL
  4396         ELSE
  4397            MOVE ER-0187                TO EMI-ERROR
  4398            GO TO 3100-INPUT-ERROR
  4399         END-IF
  4400        ELSE
  4401           MOVE ER-0035          TO EMI-ERROR
  4402           GO TO 3100-INPUT-ERROR
  4403        END-IF
  4404     END-IF
  4405     IF EIBAID = DFHPF13
  4406        IF PI-ERC-TYPE = 'B'
  4407           IF PI-ERCOMP-KEY NOT = SPACES
  4408              MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4409              MOVE PI-ERC-GROUP  TO PI-CR-GROUPING
  4410              MOVE PI-ERC-RESP   TO PI-CR-FIN-RESP
  4411              MOVE PI-ERC-ACCT   TO PI-CR-ACCOUNT
  4412              MOVE PI-ERC-TYPE   TO PI-CR-TYPE
  4413              PERFORM 3400-CREATE-TS-PI
  4414                                 THRU 3400-EXIT
  4415              MOVE XCTL-6524     TO PGM-NAME
  4416              GO TO 9300-XCTL
  4417           ELSE
  4418              MOVE ER-0187       TO EMI-ERROR
  4419              GO TO 3100-INPUT-ERROR
  4420           END-IF
  4421        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  87
* EL652.cbl
  4422           MOVE ER-0035          TO EMI-ERROR
  4423           GO TO 3100-INPUT-ERROR
  4424        END-IF
  4425     END-IF
  4426     IF EIBAID = DFHENTER
  4427         GO TO 4000-EDIT-MAINT.
  4428
  4429     MOVE ER-0029                TO  EMI-ERROR.
  4430
  4431 3100-INPUT-ERROR.
  4432     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4433
  4434     MOVE AL-UNBON               TO  PFKEYA.
  4435     MOVE -1                     TO  PFKEYL.
  4436
  4437     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  88
* EL652.cbl
  4439 3200-FIND-STATE.
  4440
  4441     IF PI-SAVE-CITYST NOT = SPACES
  4442        MOVE PI-SAVE-CITYST       TO WS-SRCH-STATE
  4443     ELSE
  4444        IF PI-SAVE-ADDR2 NOT = SPACES
  4445           MOVE PI-SAVE-ADDR2     TO WS-SRCH-STATE
  4446        END-IF
  4447     END-IF
  4448
  4449     PERFORM VARYING STNDX FROM +29 BY -1 UNTIL
  4450          (STNDX < +1) OR
  4451          ((WS-SRCH-STATE (STNDX:2) ALPHABETIC) AND
  4452          (WS-SRCH-STATE (STNDX:2) NOT = SPACES AND LOW-VALUES)
  4453          AND
  4454          (WS-SRCH-STATE (STNDX + 1:1) NOT = ' ' AND ',' AND
  4455                   '.' AND LOW-VALUES) AND
  4456          (WS-SRCH-STATE (STNDX:1) NOT = ' ' AND ',' AND
  4457                   '.' AND LOW-VALUES))
  4458     END-PERFORM
  4459
  4460     IF STNDX NOT < +1
  4461        MOVE WS-SRCH-STATE (STNDX:2)
  4462                                 TO PI-SAVE-STATE
  4463     ELSE
  4464        MOVE SPACES              TO PI-SAVE-STATE
  4465     END-IF
  4466
  4467     .
  4468 3200-EXIT.
  4469     EXIT.
  4470 3400-CREATE-TS-PI.
  4471
  4472     PERFORM 3450-DELETE-TEMP-STOR-PI THRU 3450-EXIT.
  4473
  4474
  4475* EXEC CICS HANDLE CONDITION
  4476*        QIDERR  (3400-EXIT)
  4477*    END-EXEC.
  4478*    MOVE '"$N                   ! # #00004445' TO DFHEIV0
  4479     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4480     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4481     MOVE X'2320233030303034343435' TO DFHEIV0(25:11)
  4482     CALL 'kxdfhei1' USING DFHEIV0
  4483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4484
  4485
  4486
  4487* EXEC CICS WRITEQ TS
  4488*        QUEUE   (QID-PI)
  4489*        FROM    (PROGRAM-INTERFACE-BLOCK)
  4490*        LENGTH  (PI-COMM-LENGTH)
  4491*        ITEM    (QID-ITEM)
  4492*    END-EXEC.
  4493*    MOVE '*" I                  ''   #00004449' TO DFHEIV0
  4494     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  4495     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4496     MOVE X'2020233030303034343439' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  89
* EL652.cbl
  4497     CALL 'kxdfhei1' USING DFHEIV0,
  4498           QID-PI,
  4499           PROGRAM-INTERFACE-BLOCK,
  4500           PI-COMM-LENGTH,
  4501           QID-ITEM,
  4502           DFHEIV99,
  4503           DFHEIV99
  4504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4505
  4506
  4507 3400-EXIT.
  4508      EXIT.
  4509
  4510 3450-DELETE-TEMP-STOR-PI.
  4511
  4512
  4513* EXEC CICS HANDLE CONDITION
  4514*        QIDERR  (3450-EXIT)
  4515*    END-EXEC.
  4516*    MOVE '"$N                   ! $ #00004461' TO DFHEIV0
  4517     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4518     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4519     MOVE X'2420233030303034343631' TO DFHEIV0(25:11)
  4520     CALL 'kxdfhei1' USING DFHEIV0
  4521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4522
  4523
  4524
  4525* EXEC CICS DELETEQ TS
  4526*        QUEUE  (QID-PI)
  4527*    END-EXEC.
  4528*    MOVE '*&                    #   #00004465' TO DFHEIV0
  4529     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  4530     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4531     MOVE X'2020233030303034343635' TO DFHEIV0(25:11)
  4532     CALL 'kxdfhei1' USING DFHEIV0,
  4533           QID-PI,
  4534           DFHEIV99
  4535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4536
  4537
  4538
  4539* EXEC CICS SYNCPOINT
  4540*    END-EXEC.
  4541*    MOVE '6"                    !   #00004469' TO DFHEIV0
  4542     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  4543     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4544     MOVE X'2020233030303034343639' TO DFHEIV0(25:11)
  4545     CALL 'kxdfhei1' USING DFHEIV0
  4546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4547
  4548
  4549 3450-EXIT.
  4550      EXIT.
  4551
  4552 3475-RECOVER-TEMP-STOR-PI.
  4553
  4554     MOVE LOW-VALUES            TO  EL652AI.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  90
* EL652.cbl
  4555
  4556
  4557* EXEC CICS HANDLE CONDITION
  4558*        NOTOPEN   (9990-ABEND)
  4559*        NOTFND    (8880-NOT-FOUND)
  4560*        PGMIDERR  (9600-PGMID-ERROR)
  4561*        ERROR     (9990-ABEND)
  4562*    END-EXEC.
  4563*    MOVE '"$JIL.                ! % #00004479' TO DFHEIV0
  4564     MOVE X'22244A494C2E202020202020' TO DFHEIV0(1:12)
  4565     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4566     MOVE X'2520233030303034343739' TO DFHEIV0(25:11)
  4567     CALL 'kxdfhei1' USING DFHEIV0
  4568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4569
  4570
  4571
  4572* EXEC CICS HANDLE CONDITION
  4573*        QIDERR  (3475-EXIT)
  4574*    END-EXEC.
  4575*    MOVE '"$N                   ! & #00004486' TO DFHEIV0
  4576     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4578     MOVE X'2620233030303034343836' TO DFHEIV0(25:11)
  4579     CALL 'kxdfhei1' USING DFHEIV0
  4580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4581
  4582
  4583
  4584* EXEC CICS READQ TS
  4585*        QUEUE   (QID-PI)
  4586*        ITEM    (1)
  4587*        INTO    (PROGRAM-INTERFACE-BLOCK)
  4588*        LENGTH  (PI-COMM-LENGTH)
  4589*    END-EXEC.
  4590     MOVE 1
  4591       TO DFHEIV11
  4592*    MOVE '*$II   L              ''   #00004490' TO DFHEIV0
  4593     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4594     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4595     MOVE X'2020233030303034343930' TO DFHEIV0(25:11)
  4596     CALL 'kxdfhei1' USING DFHEIV0,
  4597           QID-PI,
  4598           PROGRAM-INTERFACE-BLOCK,
  4599           PI-COMM-LENGTH,
  4600           DFHEIV11,
  4601           DFHEIV99,
  4602           DFHEIV99
  4603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4604
  4605
  4606     PERFORM 3450-DELETE-TEMP-STOR-PI THRU 3450-EXIT.
  4607
  4608     IF  PI-ERCOMP-KEY = SPACES OR LOW-VALUES
  4609         GO TO 8100-SEND-INITIAL-MAP.
  4610
  4611     IF  PI-ERC-CARRIER > LOW-VALUES
  4612         MOVE +1                 TO CARRIERL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  91
* EL652.cbl
  4613         MOVE PI-ERC-CARRIER     TO CARRIERI.
  4614
  4615     IF  PI-ERC-GROUP > LOW-VALUES
  4616         MOVE +6                 TO GROUPL
  4617         MOVE PI-ERC-GROUP       TO GROUPI.
  4618
  4619     IF  PI-ERC-RESP > LOW-VALUES
  4620         MOVE +10                TO FINRESPL
  4621         MOVE PI-ERC-RESP        TO FINRESPI.
  4622
  4623     IF  PI-ERC-ACCT > LOW-VALUES
  4624         MOVE +1                 TO ACCTNOL
  4625         MOVE PI-ERC-ACCT        TO ACCTNOI.
  4626
  4627     IF  PI-ERC-TYPE > LOW-VALUES
  4628         MOVE +1                 TO TYPEL
  4629         MOVE PI-ERC-TYPE        TO TYPEI.
  4630
  4631     MOVE 'S'                    TO MAINTYPI.
  4632     MOVE 1                      TO MAINTYPL.
  4633     GO TO 4000-EDIT-MAINT.
  4634
  4635 3475-EXIT.
  4636      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  92
* EL652.cbl
  4638 4000-EDIT-MAINT.
  4639     IF MAINTYPL > ZERO
  4640         MOVE MAINTYPI           TO  PI-CHECK-MAINT-TYPE
  4641         IF VALID-MAINT-TYPE
  4642             MOVE AL-UANON       TO  MAINTYPA
  4643             IF MAINTYPI NOT = 'S'
  4644                 MOVE SPACES     TO  WS-ACCESS
  4645                 MOVE '1'        TO  CNTL-REC-TYPE
  4646                 PERFORM 7400-READ-CONTROL-FILE  THRU  7499-EXIT
  4647             ELSE
  4648                 NEXT SENTENCE
  4649         ELSE
  4650             MOVE -1             TO  MAINTYPL
  4651             MOVE AL-UABON       TO  MAINTYPA
  4652             MOVE ER-2039        TO  EMI-ERROR
  4653             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4654     ELSE
  4655         MOVE -1                 TO  MAINTYPL
  4656         MOVE AL-UABON           TO  MAINTYPA
  4657         MOVE ER-2039            TO  EMI-ERROR
  4658         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4659
  4660     IF  NOT MODIFY-CAP
  4661             AND
  4662         NOT SHOW-FUNCTION
  4663         MOVE 'UPDATE'           TO SM-READ
  4664         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  4665         IF  MORTGAGE-SESSION
  4666             MOVE ER-9096        TO  EMI-ERROR
  4667             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4668             GO TO 8100-SEND-INITIAL-MAP
  4669         ELSE
  4670             MOVE ER-0070        TO  EMI-ERROR
  4671             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4672             GO TO 8100-SEND-INITIAL-MAP.
  4673
  4674     IF CARRIERL > ZERO
  4675         IF PI-CARRIER-SECURITY > SPACES
  4676             IF CARRIERI = PI-CARRIER-SECURITY
  4677                 NEXT SENTENCE
  4678             ELSE
  4679                 MOVE -1            TO  CARRIERL
  4680                 MOVE ER-2370       TO  EMI-ERROR
  4681                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4682                 MOVE AL-UABON      TO  CARRIERA
  4683                 GO TO 8200-SEND-DATAONLY.
  4684
  4685     IF CARRIERL > ZERO
  4686         IF ADD-FUNCTION
  4687             IF PI-ZERO-CARRIER
  4688               OR PI-ZERO-CAR-GROUP
  4689                 MOVE ZEROS      TO  PI-ERC-CARRIER
  4690                                     CARRIERI
  4691                 MOVE AL-UANON   TO  CARRIERA
  4692             ELSE
  4693                 MOVE CARRIERI   TO  WS-CARRIER
  4694                 MOVE '6'        TO  CNTL-REC-TYPE
  4695                 PERFORM 7400-READ-CONTROL-FILE  THRU  7499-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  93
* EL652.cbl
  4696         ELSE
  4697             IF PI-ZERO-CARRIER
  4698               OR PI-ZERO-CAR-GROUP
  4699                 MOVE ZEROS      TO  PI-ERC-CARRIER
  4700                                     CARRIERI
  4701                 MOVE AL-UANON   TO  CARRIERA
  4702             ELSE
  4703                 MOVE AL-UANON   TO  CARRIERA
  4704                 MOVE CARRIERI   TO  PI-ERC-CARRIER
  4705     ELSE
  4706         IF ADD-FUNCTION
  4707             IF PI-ZERO-CARRIER
  4708               OR PI-ZERO-CAR-GROUP
  4709                 MOVE ZEROS      TO  PI-ERC-CARRIER
  4710                                     CARRIERI
  4711                 MOVE AL-UANON   TO  CARRIERA
  4712             ELSE
  4713                 MOVE -1         TO  CARRIERL
  4714                 MOVE AL-UABON   TO  CARRIERA
  4715                 MOVE ER-0193    TO  EMI-ERROR
  4716                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4717         ELSE
  4718             MOVE -1             TO  CARRIERL
  4719             MOVE AL-UABON       TO  CARRIERA
  4720             MOVE ER-0193        TO  EMI-ERROR
  4721             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4722
  4723     IF GROUPL > ZERO
  4724         IF PI-ZERO-GROUPING
  4725           OR PI-ZERO-CAR-GROUP
  4726             MOVE ZEROS          TO  PI-ERC-GROUP
  4727                                     GROUPI
  4728             MOVE AL-UANON       TO  GROUPA
  4729         ELSE
  4730             MOVE AL-UANON       TO  GROUPA
  4731             MOVE GROUPI         TO  PI-ERC-GROUP
  4732     ELSE
  4733         IF ADD-FUNCTION
  4734             IF PI-ZERO-GROUPING
  4735               OR PI-ZERO-CAR-GROUP
  4736                 MOVE ZEROS      TO  PI-ERC-GROUP
  4737                                     GROUPI
  4738                 MOVE AL-UANON   TO  GROUPA
  4739             ELSE
  4740                 MOVE LOW-VALUES  TO  PI-ERC-GROUP
  4741         ELSE
  4742             MOVE LOW-VALUES     TO  PI-ERC-GROUP.
  4743
  4744     IF TYPEL > ZERO
  4745         MOVE TYPEI              TO  PI-CHECK-TYPE
  4746         IF VALID-TYPE
  4747             MOVE AL-UANON       TO  TYPEA
  4748             MOVE TYPEI          TO  PI-ERC-TYPE
  4749         ELSE
  4750             MOVE -1             TO  TYPEL
  4751             MOVE AL-UABON       TO  TYPEA
  4752             MOVE ER-2042        TO  EMI-ERROR
  4753             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  94
* EL652.cbl
  4754     ELSE
  4755         MOVE -1                 TO  TYPEL
  4756         MOVE AL-UABON           TO  TYPEA
  4757         MOVE ER-2042            TO  EMI-ERROR
  4758         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4759
  4760     IF FINRESPL >        ZERO
  4761         MOVE AL-UANON           TO  FINRESPA
  4762         IF FINRESPI = SPACES
  4763             MOVE LOW-VALUES     TO  PI-ERC-RESP
  4764         ELSE
  4765             MOVE FINRESPI       TO  PI-ERC-RESP
  4766     ELSE
  4767         MOVE LOW-VALUES         TO  PI-ERC-RESP.
  4768
  4769     IF ACCTNOL > ZERO
  4770         MOVE AL-UANON           TO  ACCTNOA
  4771         IF ACCTNOI = SPACES
  4772             MOVE LOW-VALUES     TO  PI-ERC-ACCT
  4773         ELSE
  4774             MOVE ACCTNOI        TO  PI-ERC-ACCT
  4775     ELSE
  4776         MOVE LOW-VALUES         TO  PI-ERC-ACCT.
  4777
  4778     IF ADDR2L > ZERO
  4779        MOVE AL-UANON            TO ADDR2A
  4780        IF ADDR2I = SPACES
  4781           MOVE LOW-VALUES       TO PI-SAVE-ADDR2
  4782        ELSE
  4783           MOVE ADDR2I           TO PI-SAVE-ADDR2
  4784        END-IF
  4785     ELSE
  4786        MOVE LOW-VALUES          TO PI-SAVE-ADDR2
  4787     END-IF
  4788
  4789     IF CITYL > ZERO
  4790        MOVE AL-UANON            TO CITYA
  4791        IF CITYI = SPACES
  4792           MOVE LOW-VALUES       TO PI-SAVE-CITY
  4793        ELSE
  4794           MOVE CITYI            TO PI-SAVE-CITY
  4795        END-IF
  4796     ELSE
  4797        MOVE LOW-VALUES          TO PI-SAVE-CITY
  4798     END-IF
  4799
  4800     IF STATEL > ZERO
  4801        MOVE AL-UANON            TO STATEA
  4802        IF STATEI = SPACES
  4803           MOVE LOW-VALUES       TO PI-SAVE-STATE
  4804        ELSE
  4805           MOVE STATEI           TO PI-SAVE-STATE
  4806        END-IF
  4807     ELSE
  4808        MOVE LOW-VALUES          TO PI-SAVE-STATE
  4809     END-IF
  4810
  4811     IF NOT MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  95
* EL652.cbl
  4812         IF SHOW-FUNCTION
  4813             GO TO 5000-BUILD-INITIAL-SCREEN
  4814         ELSE
  4815             MOVE 'UPDATE'       TO SM-READ
  4816             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  4817             MOVE ER-0070        TO  EMI-ERROR
  4818             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4819             GO TO 8100-SEND-INITIAL-MAP.
  4820
  4821     IF EMI-NO-ERRORS
  4822         NEXT SENTENCE
  4823     ELSE
  4824        IF EIBTRNID NOT = TRANS-ID
  4825            GO TO 8100-SEND-INITIAL-MAP
  4826         ELSE
  4827            GO TO 8200-SEND-DATAONLY.
  4828
  4829     IF CHANGE-FUNCTION
  4830         GO TO 4400-CHANGE.
  4831
  4832     IF DELETE-FUNCTION
  4833         GO TO 4600-DELETE.
  4834
  4835     IF SHOW-FUNCTION
  4836         GO TO 5000-BUILD-INITIAL-SCREEN.
  4837
  4838     IF TYPEI = 'C'
  4839         IF FINRESPI NOT = LOW-VALUES OR
  4840            ACCTNOI  NOT = LOW-VALUES
  4841               MOVE -1           TO  FINRESPL
  4842               MOVE AL-UABON     TO  FINRESPA
  4843                                     ACCTNOA
  4844               MOVE ER-2088      TO  EMI-ERROR
  4845               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4846
  4847     IF TYPEI = 'A'
  4848         IF FINRESPI = LOW-VALUES OR
  4849             ACCTNOI = LOW-VALUES
  4850               MOVE -1           TO  FINRESPL
  4851               MOVE AL-UABON     TO  FINRESPA
  4852                                     ACCTNOA
  4853               MOVE ER-2089      TO  EMI-ERROR
  4854               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4855
  4856     IF TYPEI = 'G' OR 'B'
  4857         IF ACCTNOI NOT = LOW-VALUES
  4858             MOVE -1             TO  ACCTNOL
  4859             MOVE AL-UABON       TO  ACCTNOA
  4860             MOVE ER-2091        TO  EMI-ERROR
  4861             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4862         ELSE
  4863             IF FINRESPI = LOW-VALUES
  4864                 MOVE -1         TO  FINRESPL
  4865                 MOVE AL-UABON   TO  FINRESPA
  4866                 MOVE ER-2097    TO  EMI-ERROR
  4867                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4868
  4869     IF TYPEI = 'G' OR 'B'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  96
* EL652.cbl
  4870         IF SUMMNOI NOT = LOW-VALUES
  4871             MOVE -1             TO  SUMMNOL
  4872             MOVE AL-UABON       TO  SUMMNOA
  4873             MOVE ER-3153        TO  EMI-ERROR
  4874             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4875
  4876     IF TYPEI = 'G' OR 'B'
  4877         IF NETGRSI NOT = LOW-VALUES
  4878             MOVE -1             TO  NETGRSL
  4879             MOVE AL-UABON       TO  NETGRSA
  4880             MOVE ER-3154        TO  EMI-ERROR
  4881             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4882
  4883     IF EMI-NO-ERRORS
  4884         NEXT SENTENCE
  4885     ELSE
  4886         GO TO 8200-SEND-DATAONLY.
  4887
  4888     IF ADD-FUNCTION
  4889         GO TO 4200-ADD.
  4890
  4891     MOVE -1                     TO  MAINTYPL.
  4892     MOVE ER-2056                TO  EMI-ERROR.
  4893     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4894
  4895     GO TO 8200-SEND-DATAONLY.
  4896
  4897 4000-EXIT.
  4898     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  97
* EL652.cbl
  4900 4200-ADD.
  4901     IF PI-ERCOMP-KEY = PI-SAVE-ERCOMP-KEY
  4902         MOVE ER-2057            TO  EMI-ERROR
  4903         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4904         MOVE -1                 TO  MAINTYPL
  4905         GO TO 8200-SEND-DATAONLY.
  4906
  4907     PERFORM 7000-EDIT  THRU  7000-EXIT.
  4908
  4909     IF EMI-NO-ERRORS
  4910         NEXT SENTENCE
  4911     ELSE
  4912         GO TO 8200-SEND-DATAONLY.
  4913
  4914
  4915* EXEC CICS HANDLE CONDITION
  4916*        NOTOPEN  (9990-ABEND)
  4917*        NOTFND   (4250-CONT)
  4918*    END-EXEC.
  4919*    MOVE '"$JI                  ! '' #00004805' TO DFHEIV0
  4920     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  4921     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4922     MOVE X'2720233030303034383035' TO DFHEIV0(25:11)
  4923     CALL 'kxdfhei1' USING DFHEIV0
  4924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4925
  4926
  4927     PERFORM 7050-READ-ERCOMP  THRU  7050-EXIT.
  4928
  4929     MOVE ER-2057                TO  EMI-ERROR.
  4930     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4931
  4932     MOVE LOW-VALUES             TO  PI-SAVE-ERCOMP-KEY.
  4933
  4934     MOVE -1                     TO  MAINTYPL.
  4935
  4936     GO TO 8200-SEND-DATAONLY.
  4937
  4938 4250-CONT.
  4939     PERFORM 7150-ERCOMP-GETMAIN  THRU  7150-EXIT.
  4940
  4941     MOVE SPACES                 TO  COMPENSATION-MASTER.
  4942     MOVE ZEROS                  TO  CO-LF-CLM-AMT
  4943                                     CO-AH-CLM-AMT
  4944                                     CO-CUR-FICA
  4945                                     CO-YTD-FICA
  4946                                     CO-CUR-OVR-UNDR
  4947                                     CO-YTD-OVR-UNDR
  4948                                     CO-MAX-BANK-FEE-LEASE
  4949                                     CO-MAX-BANK-FEE
  4950                                     CO-BAL-FWD
  4951                                     CO-CUR-COM
  4952                                     CO-CUR-CHG
  4953                                     CO-CUR-PMT
  4954                                     CO-END-BAL
  4955                                     CO-CUR
  4956                                     CO-OV30
  4957                                     CO-OV60
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  98
* EL652.cbl
  4958                                     CO-OV90
  4959                                     CO-YTD-COM
  4960                                     CO-YTD-OV
  4961                                     CO-YTD-PAID-COM
  4962                                     CO-YTD-PAID-OV
  4963                                     CO-CURRENT-BAL-FWD
  4964                                     CO-CURRENT-CUR-COM
  4965                                     CO-CURRENT-CUR-CHG
  4966                                     CO-CURRENT-CUR-PMT
  4967                                     CO-CURRENT-END-BAL
  4968                                     CO-CURRENT-CUR
  4969                                     CO-CURRENT-OV30
  4970                                     CO-CURRENT-OV60
  4971                                     CO-CURRENT-OV90
  4972                                     CO-CURRENT-YTD-COM
  4973                                     CO-CURRENT-YTD-OV
  4974                                     CO-ACT-YEAR
  4975                                     CO-ACT-MONTH
  4976                                     CO-ACT-DAY.
  4977     MOVE LOW-VALUES             TO  CO-LAST-ACTIVITY-DATE
  4978                                     CO-LAST-STMT-DT
  4979                                     CO-CURRENT-LAST-STMT-DT
  4980                                     CO-GA-EFFECTIVE-DT
  4981                                     CO-GA-TERMINATION-DT.
  4982     MOVE LOW-VALUES             TO  CO-FIRST-WRITTEN-DT.
  4983
  4984     MOVE 'N'                    TO  CO-INTERNAL-CONTROL-1
  4985                                     CO-INTERNAL-CONTROL-2.
  4986
  4987     PERFORM 6000-CHECK-FOR-UPDATE  THRU  6099-EXIT.
  4988
  4989     MOVE PI-PROCESSOR-ID        TO  CO-LAST-MAINT-USER.
  4990     MOVE EIBTIME                TO  CO-LAST-MAINT-HHMMSS.
  4991     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4992     MOVE '5'                    TO  DC-OPTION-CODE.
  4993     MOVE LINK-ELDATCV           TO  PGM-NAME.
  4994
  4995
  4996* EXEC CICS LINK
  4997*        PROGRAM   (PGM-NAME)
  4998*        COMMAREA  (DATE-CONVERSION-DATA)
  4999*        LENGTH    (DC-COMM-LENGTH)
  5000*    END-EXEC.
  5001*    MOVE '."C                   ''   #00004878' TO DFHEIV0
  5002     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5003     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5004     MOVE X'2020233030303034383738' TO DFHEIV0(25:11)
  5005     CALL 'kxdfhei1' USING DFHEIV0,
  5006           PGM-NAME,
  5007           DATE-CONVERSION-DATA,
  5008           DC-COMM-LENGTH,
  5009           DFHEIV99,
  5010           DFHEIV99,
  5011           DFHEIV99
  5012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5013
  5014
  5015     MOVE DC-BIN-DATE-1          TO  CO-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  99
* EL652.cbl
  5016                                     BIN-CURRENT-SAVE.
  5017     MOVE PI-CR-MONTH-END-DT     TO  CO-ROLADEX-PRINT-DT.
  5018     MOVE PI-CR-MONTH-END-DT     TO  DC-BIN-DATE-1
  5019     MOVE SPACE                  TO  DC-OPTION-CODE.
  5020
  5021
  5022* EXEC CICS LINK
  5023*        PROGRAM   (PGM-NAME)
  5024*        COMMAREA  (DATE-CONVERSION-DATA)
  5025*        LENGTH    (DC-COMM-LENGTH)
  5026*    END-EXEC.
  5027*    MOVE '."C                   ''   #00004890' TO DFHEIV0
  5028     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5029     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5030     MOVE X'2020233030303034383930' TO DFHEIV0(25:11)
  5031     CALL 'kxdfhei1' USING DFHEIV0,
  5032           PGM-NAME,
  5033           DATE-CONVERSION-DATA,
  5034           DC-COMM-LENGTH,
  5035           DFHEIV99,
  5036           DFHEIV99,
  5037           DFHEIV99
  5038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5039
  5040
  5041     MOVE PI-COMPANY-CD          TO  CO-COMPANY-CD.
  5042     MOVE 'CO'                   TO  CO-RECORD-ID.
  5043     MOVE 'A'                    TO  JP-RECORD-TYPE.
  5044     MOVE COMP-FILE-ID           TO  FILE-ID.
  5045     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5046
  5047     PERFORM 4300-ADD-COMPENSATION-NAME  THRU  4300-EXIT.
  5048
  5049
  5050* EXEC CICS WRITE
  5051*        DATASET  (COMP-FILE-ID)
  5052*        FROM     (COMPENSATION-MASTER)
  5053*        RIDFLD   (CO-CONTROL-PRIMARY)
  5054*    END-EXEC.
  5055     MOVE LENGTH OF
  5056      COMPENSATION-MASTER
  5057       TO DFHEIV11
  5058*    MOVE '&$ L                  ''   #00004904' TO DFHEIV0
  5059     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5060     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5061     MOVE X'2020233030303034393034' TO DFHEIV0(25:11)
  5062     CALL 'kxdfhei1' USING DFHEIV0,
  5063           COMP-FILE-ID,
  5064           COMPENSATION-MASTER,
  5065           DFHEIV11,
  5066           CO-CONTROL-PRIMARY,
  5067           DFHEIV99,
  5068           DFHEIV99
  5069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5070
  5071
  5072     PERFORM 8400-LOG-JOURNAL-RECORD.
  5073
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 100
* EL652.cbl
  5074     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT.
  5075
  5076     IF PI-AR-PROCESSING
  5077         IF SUMMNOL > ZERO
  5078             MOVE SUMMNOI        TO PI-AR-SUMMARY-CODE
  5079             PERFORM 7500-UPDATE-SUMM  THRU  7599-EXIT
  5080             MOVE PI-AR-SUMMARY-CODE
  5081                                 TO  WS-SUMM-FOR-RQST
  5082             PERFORM 6500-UPDATE-RQST  THRU  6599-EXIT.
  5083
  5084     MOVE ER-0000                TO  EMI-ERROR.
  5085     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5086
  5087     MOVE LOW-VALUES             TO  EL652AO.
  5088     MOVE PI-ERC-CARRIER         TO  CARRIERO.
  5089     MOVE PI-ERC-TYPE            TO  TYPEO.
  5090     MOVE AL-UANON               TO  CARRIERA
  5091                                     TYPEA.
  5092
  5093     IF PI-ERC-GROUP NOT = SPACES
  5094         MOVE PI-ERC-GROUP       TO  GROUPO
  5095         MOVE AL-UANON           TO  GROUPA.
  5096
  5097     IF PI-ERC-RESP NOT = SPACES
  5098         MOVE PI-ERC-RESP        TO  FINRESPO
  5099         MOVE AL-UANON           TO  FINRESPA.
  5100
  5101     IF PI-ERC-ACCT NOT = SPACES
  5102         MOVE PI-ERC-ACCT        TO  ACCTNOO
  5103         MOVE AL-UANON           TO  ACCTNOA.
  5104
  5105     GO TO 5000-BUILD-INITIAL-SCREEN.
  5106
  5107 4200-EXIT.
  5108     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 101
* EL652.cbl
  5110 4300-ADD-COMPENSATION-NAME.
  5111
  5112* EXEC CICS HANDLE CONDITION
  5113*         DUPREC   (4300-EXIT)
  5114*    END-EXEC.
  5115*    MOVE '"$%                   ! ( #00004949' TO DFHEIV0
  5116     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  5117     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5118     MOVE X'2820233030303034393439' TO DFHEIV0(25:11)
  5119     CALL 'kxdfhei1' USING DFHEIV0
  5120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5121
  5122
  5123
  5124* EXEC CICS GETMAIN
  5125*         LENGTH   (ERNAME-LENGTH)
  5126*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  5127*         INITIMG  (GETMAIN-SPACE)
  5128*    END-EXEC.
  5129*    MOVE ',"IL                  $   #00004953' TO DFHEIV0
  5130     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5131     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5132     MOVE X'2020233030303034393533' TO DFHEIV0(25:11)
  5133     CALL 'kxdfhei1' USING DFHEIV0,
  5134           DFHEIV20,
  5135           ERNAME-LENGTH,
  5136           GETMAIN-SPACE
  5137     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  5138         DFHEIV20
  5139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5140
  5141
  5142     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  5143     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  5144     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  5145     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  5146     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  5147     MOVE CO-ACCT-NAME           TO  NL-NAME.
  5148     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  5149        MOVE NL-NAME (5:26)      TO NL-NAME
  5150     END-IF
  5151     MOVE CO-ADDR-CITY           TO  NL-CITY.
  5152     MOVE CO-ADDR-STATE          TO  NL-ST
  5153     MOVE 'C'                    TO  NL-RECORD-TYPE.
  5154     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  5155     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  5156     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  5157     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  5158     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  5159     MOVE CO-TYPE                TO  NL-CO-TYPE.
  5160
  5161
  5162* EXEC CICS WRITE
  5163*        FROM      (NAME-LOOKUP-MASTER)
  5164*        RIDFLD    (NL-CONTROL-PRIMARY)
  5165*        DATASET   (NAME-FILE-ID)
  5166*    END-EXEC.
  5167     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 102
* EL652.cbl
  5168      NAME-LOOKUP-MASTER
  5169       TO DFHEIV11
  5170*    MOVE '&$ L                  ''   #00004978' TO DFHEIV0
  5171     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5172     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5173     MOVE X'2020233030303034393738' TO DFHEIV0(25:11)
  5174     CALL 'kxdfhei1' USING DFHEIV0,
  5175           NAME-FILE-ID,
  5176           NAME-LOOKUP-MASTER,
  5177           DFHEIV11,
  5178           NL-CONTROL-PRIMARY,
  5179           DFHEIV99,
  5180           DFHEIV99
  5181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5182
  5183
  5184 4300-EXIT.
  5185     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 103
* EL652.cbl
  5187 4400-CHANGE.
  5188     IF PI-ERCOMP-KEY = PI-SAVE-ERCOMP-KEY
  5189         NEXT SENTENCE
  5190     ELSE
  5191**** MUST SHOW RECORD FIRST
  5192         MOVE ER-2056            TO  EMI-ERROR
  5193         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5194         MOVE -1                 TO  MAINTYPL
  5195         GO TO 8200-SEND-DATAONLY.
  5196
  5197     PERFORM 7000-EDIT  THRU  7000-EXIT.
  5198
  5199     IF EMI-NO-ERRORS
  5200         NEXT SENTENCE
  5201     ELSE
  5202         GO TO 8200-SEND-DATAONLY.
  5203
  5204     PERFORM 7200-READ-ERCOMP-UPDATE  THRU  7200-EXIT.
  5205
  5206     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5207     MOVE CO-AR-SUMMARY-CODE     TO  WS-SAVE-SUMM.
  5208
  5209     PERFORM 6000-CHECK-FOR-UPDATE  THRU  6099-EXIT.
  5210
  5211     IF (CO-LAST-MAINT-USER   = PI-UPDATE-BY)
  5212        OR (CO-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS)
  5213        CONTINUE
  5214     ELSE
  5215
  5216* EXEC CICS UNLOCK
  5217*            DATASET  (COMP-FILE-ID)
  5218*       END-EXEC
  5219*    MOVE '&*                    #   #00005015' TO DFHEIV0
  5220     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5221     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5222     MOVE X'2020233030303035303135' TO DFHEIV0(25:11)
  5223     CALL 'kxdfhei1' USING DFHEIV0,
  5224           COMP-FILE-ID,
  5225           DFHEIV99
  5226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5227        MOVE ER-0068             TO EMI-ERROR
  5228        PERFORM 9900-ERROR-FORMAT
  5229                                 THRU 9900-EXIT
  5230        GO TO 8200-SEND-DATAONLY
  5231     END-IF
  5232
  5233     MOVE PI-PROCESSOR-ID        TO  CO-LAST-MAINT-USER.
  5234     MOVE EIBTIME                TO  CO-LAST-MAINT-HHMMSS.
  5235     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5236     MOVE '5'                    TO  DC-OPTION-CODE.
  5237     MOVE LINK-ELDATCV           TO  PGM-NAME.
  5238
  5239
  5240* EXEC CICS LINK
  5241*        PROGRAM   (PGM-NAME)
  5242*        COMMAREA  (DATE-CONVERSION-DATA)
  5243*        LENGTH    (DC-COMM-LENGTH)
  5244*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 104
* EL652.cbl
  5245*    MOVE '."C                   ''   #00005030' TO DFHEIV0
  5246     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5247     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5248     MOVE X'2020233030303035303330' TO DFHEIV0(25:11)
  5249     CALL 'kxdfhei1' USING DFHEIV0,
  5250           PGM-NAME,
  5251           DATE-CONVERSION-DATA,
  5252           DC-COMM-LENGTH,
  5253           DFHEIV99,
  5254           DFHEIV99,
  5255           DFHEIV99
  5256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5257
  5258
  5259     MOVE DC-BIN-DATE-1          TO  CO-LAST-MAINT-DT
  5260                                     BIN-CURRENT-SAVE.
  5261     MOVE SPACE                  TO  DC-OPTION-CODE.
  5262     MOVE PI-CR-MONTH-END-DT     TO  CO-ROLADEX-PRINT-DT.
  5263     MOVE PI-CR-MONTH-END-DT     TO  DC-BIN-DATE-1
  5264
  5265
  5266* EXEC CICS LINK
  5267*        PROGRAM   (PGM-NAME)
  5268*        COMMAREA  (DATE-CONVERSION-DATA)
  5269*        LENGTH    (DC-COMM-LENGTH)
  5270*    END-EXEC.
  5271*    MOVE '."C                   ''   #00005042' TO DFHEIV0
  5272     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5273     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5274     MOVE X'2020233030303035303432' TO DFHEIV0(25:11)
  5275     CALL 'kxdfhei1' USING DFHEIV0,
  5276           PGM-NAME,
  5277           DATE-CONVERSION-DATA,
  5278           DC-COMM-LENGTH,
  5279           DFHEIV99,
  5280           DFHEIV99,
  5281           DFHEIV99
  5282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5283
  5284
  5285     MOVE 'N'                    TO  CO-INTERNAL-CONTROL-1.
  5286     MOVE 'B'                    TO  JP-RECORD-TYPE.
  5287     MOVE COMP-FILE-ID           TO  FILE-ID.
  5288
  5289     PERFORM 8400-LOG-JOURNAL-RECORD.
  5290
  5291     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5292
  5293     PERFORM 4300-ADD-COMPENSATION-NAME  THRU  4300-EXIT.
  5294
  5295
  5296* EXEC CICS REWRITE
  5297*        DATASET  (COMP-FILE-ID)
  5298*        FROM     (COMPENSATION-MASTER)
  5299*    END-EXEC.
  5300     MOVE LENGTH OF
  5301      COMPENSATION-MASTER
  5302       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 105
* EL652.cbl
  5303*    MOVE '&& L                  %   #00005058' TO DFHEIV0
  5304     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5305     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5306     MOVE X'2020233030303035303538' TO DFHEIV0(25:11)
  5307     CALL 'kxdfhei1' USING DFHEIV0,
  5308           COMP-FILE-ID,
  5309           COMPENSATION-MASTER,
  5310           DFHEIV11,
  5311           DFHEIV99
  5312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5313
  5314
  5315     MOVE 'C'                    TO  JP-RECORD-TYPE.
  5316
  5317     PERFORM 8400-LOG-JOURNAL-RECORD.
  5318
  5319     IF NOT PI-AR-PROCESSING
  5320         GO TO 4400-CONT.
  5321
  5322     IF SUMMNOL NOT > ZERO
  5323         GO TO 4400-CONT.
  5324
  5325     IF SUMMNOI  = WS-SAVE-SUMM
  5326         GO TO 4400-CONT
  5327     ELSE
  5328         PERFORM 7600-DELETE-SUMM  THRU  7699-EXIT.
  5329
  5330     MOVE SUMMNOI                 TO WS-SUMM-FOR-RQST.
  5331     PERFORM 6500-UPDATE-RQST  THRU  6599-EXIT.
  5332
  5333     IF SUMMNOI = SPACES
  5334         GO TO 4400-CONT.
  5335
  5336     MOVE SUMMNOI                 TO PI-AR-SUMMARY-CODE.
  5337     PERFORM 7500-UPDATE-SUMM  THRU  7599-EXIT.
  5338
  5339 4400-CONT.
  5340     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT.
  5341
  5342     MOVE ER-0000                TO  EMI-ERROR.
  5343     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5344
  5345     MOVE LOW-VALUES             TO  EL652AO.
  5346     MOVE PI-ERC-CARRIER         TO  CARRIERO.
  5347     MOVE PI-ERC-TYPE            TO  TYPEO.
  5348     MOVE AL-UANON               TO  CARRIERA
  5349                                     TYPEA.
  5350
  5351     IF PI-ERC-GROUP NOT = SPACES
  5352         MOVE PI-ERC-GROUP       TO  GROUPO
  5353         MOVE AL-UANON           TO  GROUPA.
  5354
  5355     IF PI-ERC-RESP NOT = SPACES
  5356         MOVE PI-ERC-RESP        TO  FINRESPO
  5357         MOVE AL-UANON           TO  FINRESPA.
  5358
  5359     IF PI-ERC-ACCT NOT = SPACES
  5360         MOVE PI-ERC-ACCT        TO  ACCTNOO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 106
* EL652.cbl
  5361         MOVE AL-UANON           TO  ACCTNOA.
  5362
  5363     GO TO 5000-BUILD-INITIAL-SCREEN.
  5364
  5365 4400-EXIT.
  5366     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 107
* EL652.cbl
  5368 4600-DELETE.
  5369     IF PI-ERCOMP-KEY = PI-SAVE-ERCOMP-KEY
  5370         NEXT SENTENCE
  5371     ELSE
  5372         MOVE ER-2056            TO  EMI-ERROR
  5373         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5374         MOVE -1                 TO  MAINTYPL
  5375         GO TO 8200-SEND-DATAONLY.
  5376
  5377     PERFORM 7200-READ-ERCOMP-UPDATE  THRU  7200-EXIT.
  5378
  5379     MOVE CO-AR-SUMMARY-CODE     TO  WS-SAVE-SUMM.
  5380
  5381     IF (CO-YTD-COM NOT = ZERO) OR
  5382        (CO-END-BAL NOT = ZERO)
  5383
  5384* EXEC CICS UNLOCK
  5385*            DATASET  (COMP-FILE-ID)
  5386*        END-EXEC
  5387*    MOVE '&*                    #   #00005131' TO DFHEIV0
  5388     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5389     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5390     MOVE X'2020233030303035313331' TO DFHEIV0(25:11)
  5391     CALL 'kxdfhei1' USING DFHEIV0,
  5392           COMP-FILE-ID,
  5393           DFHEIV99
  5394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5395         MOVE ER-2092            TO  EMI-ERROR
  5396         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5397         MOVE -1                 TO  MAINTYPL
  5398         GO TO 8200-SEND-DATAONLY.
  5399
  5400     MOVE 'D'                    TO  JP-RECORD-TYPE.
  5401     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5402     MOVE COMP-FILE-ID           TO  FILE-ID.
  5403
  5404     IF CO-LAST-MAINT-USER   = PI-UPDATE-BY OR
  5405        CO-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS
  5406         continue
  5407     ELSE
  5408
  5409* EXEC CICS UNLOCK
  5410*            DATASET  (COMP-FILE-ID)
  5411*        END-EXEC
  5412*    MOVE '&*                    #   #00005147' TO DFHEIV0
  5413     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5414     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5415     MOVE X'2020233030303035313437' TO DFHEIV0(25:11)
  5416     CALL 'kxdfhei1' USING DFHEIV0,
  5417           COMP-FILE-ID,
  5418           DFHEIV99
  5419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5420         MOVE ER-0068            TO  EMI-ERROR
  5421         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5422         GO TO 8200-SEND-DATAONLY
  5423     end-if
  5424     if pi-el652-del-sw = 'Y'
  5425        continue
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 108
* EL652.cbl
  5426     else
  5427        move 'Y'                 to pi-el652-del-sw
  5428        move er-1299             to emi-error
  5429        perform 9900-error-format thru 9900-exit
  5430        move spaces              to maintypo
  5431        MOVE -1                  TO MAINTypL
  5432        GO TO 8200-send-dataonly
  5433     end-if
  5434
  5435* EXEC CICS DELETE
  5436*        DATASET  (COMP-FILE-ID)
  5437*    END-EXEC
  5438*    MOVE '&(                    &   #00005164' TO DFHEIV0
  5439     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5440     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5441     MOVE X'2020233030303035313634' TO DFHEIV0(25:11)
  5442     CALL 'kxdfhei1' USING DFHEIV0,
  5443           COMP-FILE-ID,
  5444           DFHEIV99,
  5445           DFHEIV99,
  5446           DFHEIV99,
  5447           DFHEIV99
  5448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5449
  5450     PERFORM 8400-LOG-JOURNAL-RECORD
  5451     MOVE EIBDATE                TO  DC-JULIAN-YYDDD
  5452     MOVE '5'                    TO  DC-OPTION-CODE
  5453     MOVE LINK-ELDATCV           TO  PGM-NAME
  5454
  5455
  5456* EXEC CICS LINK
  5457*        PROGRAM   (PGM-NAME)
  5458*        COMMAREA  (DATE-CONVERSION-DATA)
  5459*        LENGTH    (DC-COMM-LENGTH)
  5460*    END-EXEC
  5461*    MOVE '."C                   ''   #00005173' TO DFHEIV0
  5462     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5463     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5464     MOVE X'2020233030303035313733' TO DFHEIV0(25:11)
  5465     CALL 'kxdfhei1' USING DFHEIV0,
  5466           PGM-NAME,
  5467           DATE-CONVERSION-DATA,
  5468           DC-COMM-LENGTH,
  5469           DFHEIV99,
  5470           DFHEIV99,
  5471           DFHEIV99
  5472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5473
  5474     MOVE DC-BIN-DATE-1          TO  BIN-CURRENT-SAVE
  5475
  5476     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT
  5477
  5478     MOVE ER-0000                TO  EMI-ERROR
  5479     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5480
  5481     IF PI-AR-PROCESSING
  5482         IF WS-SAVE-SUMM NOT = SPACES
  5483             PERFORM 7600-DELETE-SUMM  THRU  7699-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 109
* EL652.cbl
  5484             MOVE SPACES         TO  WS-SUMM-FOR-RQST
  5485             PERFORM  6500-UPDATE-RQST  THRU  6599-EXIT
  5486         end-if
  5487     end-if
  5488
  5489     MOVE LOW-VALUES             TO  EL652AO
  5490     MOVE PI-ERC-CARRIER         TO  CARRIERO
  5491     MOVE PI-ERC-TYPE            TO  TYPEO
  5492     MOVE AL-UANON               TO  CARRIERA
  5493                                     TYPEA
  5494
  5495     IF PI-ERC-GROUP NOT = SPACES
  5496         MOVE PI-ERC-GROUP       TO  GROUPO
  5497         MOVE AL-UANON           TO  GROUPA
  5498     end-if
  5499
  5500     IF PI-ERC-RESP NOT = SPACES
  5501         MOVE PI-ERC-RESP        TO  FINRESPO
  5502         MOVE AL-UANON           TO  FINRESPA
  5503     end-if
  5504
  5505     IF PI-ERC-ACCT NOT = SPACES
  5506         MOVE PI-ERC-ACCT        TO  ACCTNOO
  5507         MOVE AL-UANON           TO  ACCTNOA
  5508     end-if
  5509
  5510     MOVE LOW-VALUES             TO  PI-SAVE-ERCOMP-KEY
  5511
  5512     GO TO 8100-SEND-INITIAL-MAP
  5513     .
  5514 4600-EXIT.
  5515     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 110
* EL652.cbl
  5517
  5518 4700-CHECK-STATE.
  5519     IF CLPSTI =  SPACES
  5520         GO TO 4799-EXIT
  5521     END-IF.
  5522
  5523     MOVE SPACES                 TO  ELCNTL-KEY2.
  5524     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID-2.
  5525     MOVE '3'                    TO  CNTL-REC-TYPE-2.
  5526     MOVE CLPSTI                 TO  CNTL-STATE-2.
  5527     MOVE +0                     TO  CNTL-SEQ-NO-2.
  5528
  5529
  5530* EXEC CICS  HANDLE CONDITION
  5531*        NOTFND  (4750-NO-STATE)
  5532*    END-EXEC.
  5533*    MOVE '"$I                   ! ) #00005234' TO DFHEIV0
  5534     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5535     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5536     MOVE X'2920233030303035323334' TO DFHEIV0(25:11)
  5537     CALL 'kxdfhei1' USING DFHEIV0
  5538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5539
  5540
  5541
  5542* EXEC CICS  READ
  5543*        DATASET  (CNTL-FILE-ID)
  5544*        SET      (ADDRESS OF CONTROL-FILE)
  5545*        RIDFLD   (ELCNTL-KEY2)
  5546*    END-EXEC.
  5547*    MOVE '&"S        E          (   #00005238' TO DFHEIV0
  5548     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5549     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5550     MOVE X'2020233030303035323338' TO DFHEIV0(25:11)
  5551     CALL 'kxdfhei1' USING DFHEIV0,
  5552           CNTL-FILE-ID,
  5553           DFHEIV20,
  5554           DFHEIV99,
  5555           ELCNTL-KEY2,
  5556           DFHEIV99,
  5557           DFHEIV99,
  5558           DFHEIV99
  5559     SET ADDRESS OF CONTROL-FILE TO
  5560         DFHEIV20
  5561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5562
  5563
  5564     GO TO 4799-EXIT.
  5565
  5566 4750-NO-STATE.
  5567     MOVE ER-0144                TO  EMI-ERROR.
  5568     MOVE -1                     TO  CLPSTL.
  5569     MOVE AL-UABON               TO  CLPSTA.
  5570
  5571     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5572
  5573 4799-EXIT.
  5574     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 111
* EL652.cbl
  5575
  5576 5000-BUILD-INITIAL-SCREEN.
  5577     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  5578
  5579     PERFORM 7050-READ-ERCOMP  THRU  7050-EXIT.
  5580
  5581     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  5582     MOVE CO-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  5583
  5584     IF CO-LAST-MAINT-HHMMSS NUMERIC
  5585        MOVE CO-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS
  5586        ELSE
  5587        MOVE ZEROS                  TO  PI-UPDATE-HHMMSS.
  5588
  5589 5050-SET-UP-SCREEN.
  5590     MOVE CO-CONTROL-NAME        TO  PCONTO.
  5591     MOVE CO-MAIL-NAME           TO  MAILNAMO.
  5592     MOVE CO-ACCT-NAME           TO  ACCTNAMO.
  5593     MOVE CO-ACCT-NAME           TO  PI-SAVE-ACCT-NAME.
  5594     MOVE CO-ADDR-1              TO  ADDR1O.
  5595     MOVE CO-ADDR-2              TO  ADDR2O
  5596                                     PI-SAVE-ADDR2
  5597     MOVE CO-ADDR-CITY           TO  CITYO
  5598                                     PI-SAVE-CITY
  5599     MOVE CO-ADDR-STATE          TO  STATEO
  5600                                     PI-SAVE-STATE
  5601     MOVE SPACES                 TO  WS-ZIP-CODE.
  5602
  5603     IF CO-CANADIAN-POST-CODE
  5604         MOVE CO-CAN-POSTAL-1    TO  WS-ZIP-CAN-2-POST1
  5605         MOVE CO-CAN-POSTAL-2    TO  WS-ZIP-CAN-2-POST2
  5606     ELSE
  5607         MOVE CO-ZIP-PRIME       TO  WS-ZIP-AM-2-CODE
  5608         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  5609             MOVE '-'            TO  WS-ZIP-AM-2-DASH
  5610             MOVE CO-ZIP-PLUS4   TO  WS-ZIP-AM-2-PLUS4.
  5611
  5612     MOVE WS-ZIP-CODE            TO  ZIPCODEO.
  5613
  5614     IF CO-BILL-SW = ' ' OR 'B' OR 'R' OR 'T' OR 'S'
  5615        OR 'O' OR 'E' OR 'C'
  5616         MOVE AL-UANON           TO  BILLPRTA
  5617         MOVE CO-BILL-SW         TO  BILLPRTO
  5618     END-IF.
  5619
  5620     MOVE CO-CSO-1099            TO  PNT1099O.
  5621
  5622     MOVE CO-CSR-CODE            TO  CSRO.
  5623
  5624     IF (PI-COMPANY-ID = 'DCC')
  5625        AND (CO-TYPE = 'A')
  5626        IF CO-COMP-TYPE = '1'
  5627           MOVE 'Y'              TO SPPDDO
  5628        ELSE
  5629           MOVE 'N'              TO SPPDDO
  5630        END-IF
  5631     END-IF
  5632     MOVE CO-SOC-SEC             TO  SSNO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 112
* EL652.cbl
  5633
  5634     MOVE CO-BALANCE-CONTROL     TO  CARBALO.
  5635
  5636     IF PI-AR-PROCESSING
  5637         IF CO-AR-SUMMARY-CODE > SPACES
  5638             MOVE AL-UANON       TO  SUMMNOA
  5639             MOVE CO-AR-SUMMARY-CODE
  5640                                 TO  SUMMNOO
  5641         ELSE
  5642             MOVE LOW-VALUES     TO  SUMMNOO.
  5643
  5644     IF PI-AR-PROCESSING
  5645        IF NOT CO-ACCOUNT-TYPE
  5646           MOVE AL-SADOF         TO SCDESCA
  5647           MOVE AL-SANOF         TO SUMMNOA
  5648        ELSE
  5649           MOVE AL-UANOF         TO SUMMNOA.
  5650
  5651     IF PI-AR-PROCESSING
  5652         MOVE CO-AR-BAL-LEVEL    TO  ARBALO
  5653         MOVE CO-AR-PULL-CHECK   TO  CKPULLO.
  5654
  5655     IF PI-AR-PROCESSING
  5656         IF CO-ACCOUNT-TYPE
  5657             MOVE CO-AR-REPORTING
  5658                                 TO  NETGRSO
  5659         ELSE
  5660             MOVE SPACES         TO  NETGRSO.
  5661
  5662     MOVE SPACES                 TO  FLITYPO.
  5663
  5664     IF CO-COMPANY-TYPE
  5665         MOVE SPACES             TO  RPTCD2O
  5666         MOVE AL-SADOF           TO  RPTCDDA.
  5667
  5668     MOVE SPACES                 TO  LETRCDO.
  5669     MOVE AL-SADOF               TO  LETDESCA.
  5670     MOVE SPACES                 TO  BALCDO.
  5671     MOVE AL-SADOF               TO  BALPRTA.
  5672     MOVE CO-CLP-STATE           TO  CLPSTO.
  5673     MOVE CO-MAX-BANK-FEE        TO  MAXFEEO
  5674     MOVE CO-SPP-REFUND-EDIT     TO  REFEO
  5675     IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  5676        MOVE +0                  TO CO-MAX-BANK-FEE-LEASE
  5677     END-IF
  5678     MOVE CO-MAX-BANK-FEE-LEASE  TO  MAXLFO
  5679     .
  5680 5060-BUILD-TOTALS.
  5681     IF SHOW-SAVE-TOTALS
  5682         NEXT SENTENCE
  5683     ELSE
  5684         GO TO 5070-BUILD-CURRENT-TOTALS.
  5685
  5686     IF CO-LAST-STMT-DT = SPACES
  5687         MOVE SPACES             TO  LSTMDTO
  5688         GO TO 5060-LST-STMT-OK.
  5689
  5690     MOVE CO-LAST-STMT-MONTH     TO  WS-YMD-MM.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 113
* EL652.cbl
  5691     MOVE CO-LAST-STMT-DAY       TO  WS-YMD-DD.
  5692     MOVE CO-LAST-STMT-YEAR      TO  WS-YMD-YY.
  5693
  5694     IF WS-YMD-DATE-NUM NUMERIC
  5695         NEXT SENTENCE
  5696     ELSE
  5697         MOVE SPACES             TO  LSTMDTO
  5698         GO TO 5060-LST-STMT-OK.
  5699
  5700     MOVE WS-YMD-DATE            TO  DC-GREG-DATE-1-YMD.
  5701     MOVE '3'                    TO  DC-OPTION-CODE.
  5702
  5703     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  5704
  5705     IF NO-CONVERSION-ERROR
  5706         NEXT SENTENCE
  5707     ELSE
  5708         MOVE SPACES             TO  LSTMDTO
  5709         GO TO 5060-LST-STMT-OK.
  5710
  5711     MOVE CO-LAST-STMT-MONTH     TO  WS-DMDY8-MM.
  5712     MOVE CO-LAST-STMT-DAY       TO  WS-DMDY8-DD.
  5713     MOVE CO-LAST-STMT-YEAR      TO  WS-DMDY8-YY.
  5714     MOVE '/'                    TO  WS-DMDY8-SL1
  5715                                     WS-DMDY8-SL2.
  5716     MOVE WS-DATE-MDY-8          TO  LSTMDTO.
  5717
  5718 5060-LST-STMT-OK.
  5719     MOVE CO-BAL-FWD             TO  BALFWDO.
  5720     MOVE CO-CUR-COM             TO  CURCOMO.
  5721     MOVE CO-CUR-PMT             TO  CURPMTO.
  5722     MOVE CO-CUR-CHG             TO  CURCHGO.
  5723     MOVE CO-END-BAL             TO  ENDBALO.
  5724     MOVE CO-CUR                 TO  CURRENTO.
  5725     MOVE CO-OV30                TO  OVER30O.
  5726     MOVE CO-OV60                TO  OVER60O.
  5727     MOVE CO-OV90                TO  OVER90O.
  5728
  5729     IF CO-ACCOUNT-TYPE
  5730        MOVE CO-YTD-COM          TO YTDCOMO
  5731     ELSE
  5732        MOVE CO-YTD-OV           TO YTDCOMO
  5733     END-IF
  5734
  5735     MOVE AL-SADOF               TO  PFK9A.
  5736     MOVE 'PREV. END-OF-MONTH TOTALS DISPLAYED'
  5737                                 TO  EMI-MESSAGE-AREA (1).
  5738
  5739     GO TO 5090-CONTD.
  5740
  5741 5070-BUILD-CURRENT-TOTALS.
  5742     IF CO-CURRENT-LAST-STMT-DT = SPACES
  5743         MOVE SPACES             TO  LSTMDTO
  5744         GO TO 5070-LST-STMT-OK.
  5745
  5746     MOVE CO-CURRENT-LAST-STMT-MONTH
  5747                                 TO WS-YMD-MM.
  5748     MOVE CO-CURRENT-LAST-STMT-DAY
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 114
* EL652.cbl
  5749                                 TO  WS-YMD-DD.
  5750     MOVE CO-CURRENT-LAST-STMT-YEAR
  5751                                 TO  WS-YMD-YY.
  5752
  5753     IF WS-YMD-DATE-NUM NUMERIC
  5754         NEXT SENTENCE
  5755     ELSE
  5756         MOVE SPACES             TO  LSTMDTO
  5757         GO TO 5070-LST-STMT-OK.
  5758
  5759     MOVE WS-YMD-DATE            TO  DC-GREG-DATE-1-YMD.
  5760     MOVE '3'                    TO  DC-OPTION-CODE.
  5761
  5762     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  5763
  5764     IF NO-CONVERSION-ERROR
  5765         NEXT SENTENCE
  5766     ELSE
  5767         MOVE SPACES             TO  LSTMDTO
  5768         GO TO 5070-LST-STMT-OK.
  5769
  5770     MOVE CO-CURRENT-LAST-STMT-MONTH
  5771                                 TO  WS-DMDY8-MM.
  5772     MOVE CO-CURRENT-LAST-STMT-DAY
  5773                                 TO  WS-DMDY8-DD.
  5774     MOVE CO-CURRENT-LAST-STMT-YEAR
  5775                                 TO  WS-DMDY8-YY.
  5776     MOVE '/'                    TO  WS-DMDY8-SL1
  5777                                     WS-DMDY8-SL2.
  5778     MOVE WS-DATE-MDY-8          TO  LSTMDTO.
  5779
  5780 5070-LST-STMT-OK.
  5781     MOVE CO-CURRENT-BAL-FWD     TO  BALFWDO.
  5782     MOVE CO-CURRENT-CUR-COM     TO  CURCOMO.
  5783     MOVE CO-CURRENT-CUR-PMT     TO  CURPMTO.
  5784     MOVE CO-CURRENT-CUR-CHG     TO  CURCHGO.
  5785     MOVE CO-CURRENT-END-BAL     TO  ENDBALO
  5786                                     PI-ERC-END-BAL.
  5787     MOVE CO-CURRENT-CUR         TO  CURRENTO.
  5788     MOVE CO-CURRENT-OV30        TO  OVER30O.
  5789     MOVE CO-CURRENT-OV60        TO  OVER60O.
  5790     MOVE CO-CURRENT-OV90        TO  OVER90O.
  5791
  5792     IF CO-ACCOUNT-TYPE
  5793        MOVE CO-CURRENT-YTD-COM  TO YTDCOMO
  5794     ELSE
  5795        MOVE CO-CURRENT-YTD-OV   TO YTDCOMO
  5796     END-IF
  5797     .
  5798 5090-CONTD.
  5799
  5800     MOVE CO-LAST-MAINT-USER     TO LSTUSRO.
  5801
  5802     MOVE ' '              TO DC-OPTION-CODE.
  5803     MOVE CO-LAST-MAINT-DT TO DC-BIN-DATE-1.
  5804
  5805     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  5806
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 115
* EL652.cbl
  5807     MOVE DC-GREG-DATE-1-EDIT    TO LSTDTEO.
  5808
  5809     IF CO-LAST-MAINT-HHMMSS NUMERIC
  5810         MOVE CO-LAST-MAINT-HHMMSS
  5811                                 TO TIME-IN
  5812         MOVE TIME-OUT           TO LSTTIMEO
  5813     ELSE
  5814         MOVE ZEROS              TO TIME-IN
  5815         MOVE TIME-OUT           TO LSTTIMEO.
  5816
  5817     IF PI-COMPANY-ID =  'FLI'  OR  'FLU'  OR  'UCL'
  5818         MOVE AL-SANOF           TO  FLITYPEA
  5819         MOVE AL-UANON           TO  FLITYPA
  5820     ELSE
  5821         MOVE AL-SANON           TO  FLITYPA.
  5822
  5823     IF PI-COMPANY-ID = 'NCL'
  5824         IF CO-ACCOUNT-TYPE
  5825             MOVE AL-SANOF       TO  RPTCD2A
  5826         ELSE
  5827             IF CO-COMPANY-TYPE
  5828                MOVE AL-SANOF    TO  RPTCD2A
  5829                MOVE AL-SADOF    TO  RPTCDDA.
  5830
  5831     IF PI-COMPANY-ID = 'NCL'
  5832         IF CO-GEN-AGENT-TYPE
  5833            MOVE AL-UANON       TO  RPTCD2A.
  5834
  5835     IF PI-COMPANY-ID = 'NCL'
  5836         MOVE AL-UANON           TO  LETRCDA
  5837     ELSE
  5838         MOVE AL-SANOF           TO  LETRCDA
  5839         MOVE AL-SADOF           TO  LETDESCA.
  5840
  5841     IF PI-COMPANY-ID  NOT =  'DDB' AND 'ANT' AND 'ASL' AND
  5842                              'AN1' AND 'TFS'
  5843         MOVE AL-SANOF           TO  BALCDA
  5844         MOVE AL-SADOF           TO  BALPRTA.
  5845
  5846     IF PI-AR-PROCESSING
  5847         IF CO-ACCOUNT-TYPE
  5848             MOVE AL-SANOF       TO  SCDESCA
  5849             MOVE AL-SANOF       TO  NGDESCA
  5850             MOVE AL-UANON       TO  NETGRSA
  5851             IF PI-COMPANY-ID  =  'DDB' OR 'ANT' OR 'ASL' OR
  5852                                  'AN1' OR 'TFS'
  5853                 MOVE AL-SANOF   TO  BALPRTA
  5854                 MOVE AL-UANON   TO  BALCDA.
  5855
  5856     IF PI-AR-PROCESSING
  5857             MOVE AL-SANOF       TO  BALDESCA
  5858                                     CKDESCA
  5859             MOVE AL-UANON       TO  ARBALA
  5860                                     CKPULLA.
  5861
  5862
  5863     MOVE AL-UANON               TO  MAILNAMA
  5864                                     ACCTNAMA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 116
* EL652.cbl
  5865                                     ADDR1A
  5866                                     ADDR2A
  5867                                     CITYA
  5868                                     STATEA
  5869                                     SSNA
  5870                                     ZIPCODEA
  5871                                     BILLPRTA
  5872                                     PNT1099A
  5873                                     CARBALA.
  5874
  5875     IF NOT SHOW-SAVE-TOTALS
  5876         IF PI-PROCESSOR-ID = 'LGXX'
  5877             GO TO 5100-CONTD.
  5878
  5879     MOVE AL-SANOF               TO  BALFWDA
  5880                                     CURCOMA
  5881                                     CURPMTA
  5882                                     CURCHGA
  5883                                     ENDBALA.
  5884
  5885 5100-CONTD.
  5886     IF CO-TELEPHONE NUMERIC
  5887         MOVE CO-TELEPHONE       TO  WS-PHONE-IN
  5888                                     PI-SAVE-PHONE
  5889         MOVE WSPI-AREA          TO  WSPO-AREA
  5890         MOVE WSPI-PFX           TO  WSPO-PFX
  5891         MOVE WSPI-SFX           TO  WSPO-SFX
  5892         MOVE WS-PHONE-OUT       TO  PHONEO
  5893         MOVE AL-UNNON           TO  PHONEA
  5894     ELSE
  5895         MOVE SPACES             TO  PHONEO.
  5896
  5897     IF CO-FAXNO NUMERIC
  5898         MOVE CO-FAXNO           TO  WS-PHONE-IN
  5899                                     PI-SAVE-FAXNO
  5900         MOVE WSPI-AREA          TO  WSPO-AREA
  5901         MOVE WSPI-PFX           TO  WSPO-PFX
  5902         MOVE WSPI-SFX           TO  WSPO-SFX
  5903         MOVE WS-PHONE-OUT       TO  FAXNOO
  5904         MOVE AL-UNNON           TO  FAXNOA
  5905     ELSE
  5906         MOVE SPACES             TO  FAXNOO.
  5907
  5908     MOVE 'S'                    TO  MAINTYPO
  5909                                     PI-CHECK-MAINT-TYPE.
  5910     MOVE AL-UANON               TO  MAINTYPA.
  5911     MOVE -1                     TO  MAINTYPL.
  5912
  5913     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 117
* EL652.cbl
  5915 6000-CHECK-FOR-UPDATE.
  5916     IF CHANGE-FUNCTION
  5917         GO TO 6010-CONT.
  5918
  5919     IF CARRIERL > ZERO
  5920         MOVE CARRIERI           TO  CO-CARRIER.
  5921
  5922     IF GROUPL > ZERO
  5923         MOVE GROUPI             TO  CO-GROUPING
  5924     ELSE
  5925         MOVE LOW-VALUES         TO  CO-GROUPING.
  5926
  5927     IF FINRESPL > ZERO
  5928         MOVE FINRESPI           TO  CO-RESP-NO
  5929     ELSE
  5930         MOVE LOW-VALUES         TO  CO-RESP-NO.
  5931
  5932     IF ACCTNOL > ZERO
  5933         MOVE ACCTNOI            TO  CO-ACCOUNT
  5934     ELSE
  5935         MOVE LOW-VALUES         TO  CO-ACCOUNT.
  5936
  5937     IF TYPEL > ZERO
  5938         MOVE TYPEI              TO  CO-TYPE.
  5939
  5940 6010-CONT.
  5941     IF PI-PROCESSOR-ID = 'LGXX'
  5942         IF LSTMDTL > ZERO
  5943             MOVE WS-YMD-YY      TO  CO-CURRENT-LAST-STMT-YEAR
  5944                                     WS-DMDY8-YY
  5945             MOVE WS-YMD-MM      TO  CO-CURRENT-LAST-STMT-MONTH
  5946                                     WS-DMDY8-MM
  5947             MOVE WS-YMD-DD      TO  CO-CURRENT-LAST-STMT-DAY
  5948                                     WS-DMDY8-DD
  5949             MOVE '/'            TO  WS-DMDY8-SL1  WS-DMDY8-SL2
  5950             MOVE WS-DATE-MDY-8  TO  LSTMDTO.
  5951
  5952     IF PI-AR-PROCESSING
  5953         IF TYPEI = 'A'
  5954             IF SUMMNOL > ZERO
  5955                 MOVE SUMMNOI   TO  CO-AR-SUMMARY-CODE
  5956                                    WS-SAVE-SUMMARY.
  5957
  5958     IF PI-AR-PROCESSING
  5959         IF TYPEI = 'A'
  5960             IF NETGRSL > ZERO
  5961                 MOVE NETGRSI   TO  CO-AR-REPORTING
  5962             ELSE
  5963                 IF ADD-FUNCTION
  5964                     MOVE 'G'   TO  CO-AR-REPORTING.
  5965
  5966     IF PI-AR-PROCESSING
  5967         IF ARBALL > ZERO
  5968             MOVE ARBALI        TO  CO-AR-BAL-LEVEL
  5969         ELSE
  5970             IF ADD-FUNCTION
  5971                 MOVE '1'       TO  CO-AR-BAL-LEVEL.
  5972
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 118
* EL652.cbl
  5973     IF PI-AR-PROCESSING
  5974         IF CKPULLL > ZERO
  5975             MOVE CKPULLI       TO  CO-AR-PULL-CHECK
  5976         ELSE
  5977             IF ADD-FUNCTION
  5978                 MOVE 'Y'       TO  CO-AR-PULL-CHECK.
  5979
  5980     IF MAILNAML > ZERO
  5981         MOVE MAILNAMI           TO  CO-MAIL-NAME
  5982                                     WS-SAVE-NAME.
  5983
  5984     IF ACCTNAML > ZERO
  5985         MOVE ACCTNAMI           TO  CO-ACCT-NAME.
  5986
  5987     IF ADDR1L > ZERO
  5988         MOVE ADDR1I             TO  CO-ADDR-1.
  5989
  5990     IF ADDR2L > ZERO
  5991         MOVE ADDR2I             TO  CO-ADDR-2.
  5992
  5993     IF CITYL > ZERO
  5994         MOVE CITYI              TO  CO-ADDR-CITY.
  5995     IF STATEL > ZERO
  5996         MOVE STATEI             TO  CO-ADDR-STATE.
  5997
  5998     IF ZIPCODEL NOT > ZERO
  5999         GO TO 6015-CONT.
  6000
  6001     MOVE ZIPCODEI               TO  WS-ZIP-CODE.
  6002
  6003     IF WS-CANADIAN-ZIP
  6004         IF WS-ZIP-4 = SPACE  OR  '-'
  6005             MOVE WS-ZIP-CAN-2-POST1     TO  CO-CAN-POSTAL-1
  6006             MOVE WS-ZIP-CAN-2-POST2     TO  CO-CAN-POSTAL-2
  6007         ELSE
  6008             MOVE WS-ZIP-CAN-1-POST1     TO  CO-CAN-POSTAL-1
  6009             MOVE WS-ZIP-CAN-1-POST2     TO  CO-CAN-POSTAL-2
  6010     ELSE
  6011         IF WS-ZIP-6 = SPACE  OR  '-'
  6012             MOVE WS-ZIP-AM-2-CODE       TO  CO-ZIP-PRIME
  6013             MOVE WS-ZIP-AM-2-PLUS4      TO  CO-ZIP-PLUS4
  6014         ELSE
  6015             MOVE WS-ZIP-AM-1-CODE       TO  CO-ZIP-PRIME
  6016             MOVE WS-ZIP-AM-1-PLUS4      TO  CO-ZIP-PLUS4.
  6017
  6018 6015-CONT.
  6019     IF BILLPRTL > ZERO
  6020         IF BILLPRTI = ' ' OR 'B' OR 'R' OR 'T' OR 'S'
  6021            OR 'O' OR 'E' OR 'C'
  6022             MOVE  BILLPRTI          TO  CO-BILL-SW
  6023         ELSE
  6024             MOVE SPACES         TO  CO-BILL-SW
  6025                                     BILLPRTO
  6026         END-IF
  6027     END-IF.
  6028     IF SPPDDL > ZERO
  6029        IF SPPDDI = 'Y'
  6030           MOVE '1'              TO CO-COMP-TYPE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 119
* EL652.cbl
  6031        ELSE
  6032           MOVE ' '              TO CO-COMP-TYPE
  6033        END-IF
  6034     END-IF
  6035     IF PNT1099L > ZERO
  6036         IF PNT1099I = 'N' OR 'Y'
  6037             MOVE  PNT1099I      TO  CO-CSO-1099
  6038         ELSE
  6039             MOVE 'N'            TO  CO-CSO-1099
  6040                                     PNT1099O
  6041         END-IF
  6042     END-IF.
  6043
  6044     IF CSRL > ZERO
  6045         MOVE CSRI               TO  CO-CSR-CODE.
  6046
  6047     IF SSNL > ZERO
  6048         MOVE SSNI               TO  CO-SOC-SEC.
  6049
  6050     IF PHONEL > ZERO
  6051         MOVE PI-SAVE-PHONE      TO  CO-TELEPHONE
  6052         MOVE ZEROS              TO  PI-SAVE-PHONE.
  6053
  6054     IF FAXNOL > ZERO
  6055         MOVE PI-SAVE-FAXNO      TO  CO-FAXNO
  6056         MOVE ZEROS              TO  PI-SAVE-FAXNO.
  6057
  6058     IF PCONTL > ZEROS
  6059        MOVE PCONTI              TO CO-CONTROL-NAME
  6060     END-IF
  6061     IF CLPSTL > ZERO
  6062         MOVE CLPSTI             TO  CO-CLP-STATE
  6063     END-IF
  6064     IF REFEL > ZERO
  6065        MOVE REFEI               TO CO-SPP-REFUND-EDIT
  6066     END-IF
  6067     IF MAXFEEL > ZERO
  6068         MOVE MAXFEEI            TO  CO-MAX-BANK-FEE
  6069*        IF ADD-FUNCTION
  6070*           MOVE CO-MAX-BANK-FEE TO  CO-BANK-FEE
  6071*        ELSE
  6072*           IF CHANGE-FUNCTION
  6073*              PERFORM 6100-EDIT-ERAGTC
  6074*                                THRU 6100-EXIT
  6075*              IF WS-TOT-FEES > CO-MAX-BANK-FEE
  6076*                 MOVE ER-2717   TO EMI-ERROR
  6077*                 MOVE -1        TO MAXFEEL
  6078*                 MOVE AL-UABON  TO MAXFEEA
  6079*                 PERFORM 9900-ERROR-FORMAT
  6080*                                THRU 9900-EXIT
  6081*              ELSE
  6082*                 COMPUTE CO-BANK-FEE = CO-MAX-BANK-FEE
  6083*                    - WS-TOT-FEES
  6084*              END-IF
  6085*           END-IF
  6086*        END-IF
  6087     END-IF
  6088
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 120
* EL652.cbl
  6089     IF MAXLFL > ZERO
  6090         MOVE MAXLFI             TO CO-MAX-BANK-FEE-LEASE
  6091     END-IF
  6092     IF CARBALL > ZERO
  6093         MOVE CARBALI            TO  CO-BALANCE-CONTROL
  6094         GO TO 6020-CONT.
  6095
  6096     IF NOT PI-AR-PROCESSING
  6097         GO TO 6020-CONT.
  6098
  6099     IF ADD-FUNCTION
  6100        AND (TYPEI = 'G' OR 'B')
  6101         MOVE 'Y'                TO  CO-BALANCE-CONTROL
  6102         GO TO 6020-CONT.
  6103
  6104     IF ADD-FUNCTION
  6105         IF TYPEI = 'A'
  6106             IF FINRESPI = ACCTNOI
  6107                 MOVE 'Y'        TO  CO-BALANCE-CONTROL
  6108             ELSE
  6109                 MOVE 'N'        TO  CO-BALANCE-CONTROL.
  6110
  6111     IF ADD-FUNCTION AND TYPEI = 'C'
  6112         MOVE 'N'                TO  CO-BALANCE-CONTROL.
  6113
  6114 6020-CONT.
  6115     IF BALFWDL > ZERO
  6116         MOVE WS-SAVE-BALFWD     TO  CO-CURRENT-BAL-FWD.
  6117
  6118     IF CURCOML > ZERO
  6119         MOVE WS-SAVE-CURCOM     TO  CO-CURRENT-CUR-COM.
  6120
  6121     IF CURCHGL > ZERO
  6122         MOVE WS-SAVE-CURCHG     TO  CO-CURRENT-CUR-CHG.
  6123
  6124     IF CURPMTL > ZERO
  6125         MOVE WS-SAVE-CURPMT     TO  CO-CURRENT-CUR-PMT.
  6126
  6127     IF ENDBALL > ZERO
  6128         MOVE WS-SAVE-ENDBAL     TO  CO-CURRENT-END-BAL.
  6129
  6130*    IF YTDCOML > ZERO
  6131*       IF CO-ACCOUNT-TYPE
  6132*          MOVE WS-SAVE-YTDCOM   TO CO-CURRENT-YTD-COM
  6133*       ELSE
  6134*          MOVE WS-SAVE-YTDCOM   TO CO-CURRENT-YTD-OV
  6135*       END-IF
  6136*    END-IF
  6137     .
  6138 6099-EXIT.
  6139     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 121
* EL652.cbl
  6141 6100-EDIT-ERAGTC.
  6142
  6143* EXEC CICS READ
  6144*         SET     (ADDRESS OF AGENT-COMMISSIONS)
  6145*         DATASET ('ERAGTC')
  6146*         RIDFLD  (PI-ERCOMP-KEY)
  6147*         RESP    (WS-RESPONSE)
  6148*    END-EXEC
  6149     MOVE 'ERAGTC' TO DFHEIV1
  6150*    MOVE '&"S        E          (  N#00005822' TO DFHEIV0
  6151     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6152     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6153     MOVE X'204E233030303035383232' TO DFHEIV0(25:11)
  6154     CALL 'kxdfhei1' USING DFHEIV0,
  6155           DFHEIV1,
  6156           DFHEIV20,
  6157           DFHEIV99,
  6158           PI-ERCOMP-KEY,
  6159           DFHEIV99,
  6160           DFHEIV99,
  6161           DFHEIV99
  6162     SET ADDRESS OF AGENT-COMMISSIONS TO
  6163         DFHEIV20
  6164     MOVE EIBRESP  TO WS-RESPONSE
  6165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6166     MOVE +0                     TO WS-TOT-FEES
  6167     IF RESP-NORMAL
  6168        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6169           (S1 > +10)
  6170           COMPUTE WS-TOT-FEES = WS-TOT-FEES
  6171              + AG-SPP-FEES (S1)
  6172        END-PERFORM
  6173     END-IF
  6174     .
  6175 6100-EXIT.
  6176     EXIT.
  6177 6500-UPDATE-RQST.
  6178
  6179     MOVE LOW-VALUES             TO  ERRQST-KEY-3.
  6180     MOVE PI-ERC-COMPANY-CD      TO  RQST-COMP-ID.
  6181     MOVE PI-ERC-CARRIER         TO  RQST-CARRIER.
  6182     MOVE PI-ERC-GROUP           TO  RQST-GROUP.
  6183     MOVE PI-ERC-RESP            TO  RQST-FIN-RESP.
  6184     MOVE PI-ERC-ACCT            TO  RQST-ACCT-AGENT.
  6185
  6186
  6187* EXEC CICS HANDLE CONDITION
  6188*        ENDFILE  (6550-END-BROWSE)
  6189*        NOTFND   (6550-END-BROWSE)
  6190*    END-EXEC.
  6191*    MOVE '"$''I                  ! * #00005848' TO DFHEIV0
  6192     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6193     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6194     MOVE X'2A20233030303035383438' TO DFHEIV0(25:11)
  6195     CALL 'kxdfhei1' USING DFHEIV0
  6196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6197
  6198
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 122
* EL652.cbl
  6199
  6200* EXEC CICS STARTBR
  6201*        DATASET  (RQST-FILE-ID-3)
  6202*        RIDFLD   (ERRQST-KEY-3)
  6203*    END-EXEC.
  6204     MOVE 0
  6205       TO DFHEIV11
  6206*    MOVE '&,         G          &   #00005853' TO DFHEIV0
  6207     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6208     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6209     MOVE X'2020233030303035383533' TO DFHEIV0(25:11)
  6210     CALL 'kxdfhei1' USING DFHEIV0,
  6211           RQST-FILE-ID-3,
  6212           ERRQST-KEY-3,
  6213           DFHEIV99,
  6214           DFHEIV11,
  6215           DFHEIV99
  6216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6217
  6218
  6219 6525-READ-LOOP.
  6220
  6221* EXEC CICS HANDLE CONDITION
  6222*        ENDFILE  (6550-END-BROWSE)
  6223*        NOTFND   (6550-END-BROWSE)
  6224*    END-EXEC.
  6225*    MOVE '"$''I                  ! + #00005859' TO DFHEIV0
  6226     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6227     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6228     MOVE X'2B20233030303035383539' TO DFHEIV0(25:11)
  6229     CALL 'kxdfhei1' USING DFHEIV0
  6230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6231
  6232
  6233
  6234* EXEC CICS READNEXT
  6235*        DATASET  (RQST-FILE-ID-3)
  6236*        SET      (ADDRESS OF AR-REQUEST-RECORD)
  6237*        RIDFLD   (ERRQST-KEY-3)
  6238*    END-EXEC.
  6239     MOVE 0
  6240       TO DFHEIV11
  6241*    MOVE '&.S                   )   #00005864' TO DFHEIV0
  6242     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6243     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6244     MOVE X'2020233030303035383634' TO DFHEIV0(25:11)
  6245     CALL 'kxdfhei1' USING DFHEIV0,
  6246           RQST-FILE-ID-3,
  6247           DFHEIV20,
  6248           DFHEIV99,
  6249           ERRQST-KEY-3,
  6250           DFHEIV99,
  6251           DFHEIV11,
  6252           DFHEIV99,
  6253           DFHEIV99
  6254     SET ADDRESS OF AR-REQUEST-RECORD TO
  6255         DFHEIV20
  6256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 123
* EL652.cbl
  6257
  6258
  6259     IF RQ-CONTROL-BY-FIN-RESP = WS-SAVE-RQST
  6260         GO TO 6525-READ-LOOP.
  6261
  6262     IF RQ-COMPANY-CD-A2 =  PI-ERC-COMPANY-CD AND
  6263        RQ-CARRIER-A2    =  PI-ERC-CARRIER    AND
  6264        RQ-GROUPING-A2   =  PI-ERC-GROUP      AND
  6265        RQ-FIN-RESP-A2   =  PI-ERC-RESP       AND
  6266        RQ-ACCT-AGENT-A2 =  PI-ERC-ACCT
  6267         NEXT SENTENCE
  6268     ELSE
  6269         GO TO 6550-END-BROWSE.
  6270
  6271     IF WS-SUMM-FOR-RQST = RQ-SUMMARY-CODE
  6272         GO TO 6525-READ-LOOP.
  6273
  6274     MOVE RQ-CONTROL-BY-FIN-RESP TO  WS-SAVE-RQST.
  6275     MOVE RQ-CONTROL-PRIMARY     TO  ERRQST-KEY.
  6276
  6277
  6278* EXEC CICS ENDBR
  6279*        DATASET  (RQST-FILE-ID-3)
  6280*    END-EXEC.
  6281     MOVE 0
  6282       TO DFHEIV11
  6283*    MOVE '&2                    $   #00005888' TO DFHEIV0
  6284     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6285     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6286     MOVE X'2020233030303035383838' TO DFHEIV0(25:11)
  6287     CALL 'kxdfhei1' USING DFHEIV0,
  6288           RQST-FILE-ID-3,
  6289           DFHEIV11,
  6290           DFHEIV99
  6291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6292
  6293
  6294
  6295* EXEC CICS HANDLE CONDITION
  6296*        ENDFILE  (6599-EXIT)
  6297*        NOTFND   (6599-EXIT)
  6298*    END-EXEC.
  6299*    MOVE '"$''I                  ! , #00005892' TO DFHEIV0
  6300     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6301     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6302     MOVE X'2C20233030303035383932' TO DFHEIV0(25:11)
  6303     CALL 'kxdfhei1' USING DFHEIV0
  6304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6305
  6306
  6307
  6308* EXEC CICS READ
  6309*        DATASET  (RQST-FILE-ID)
  6310*        SET      (ADDRESS OF AR-REQUEST-RECORD)
  6311*        RIDFLD   (ERRQST-KEY)
  6312*        UPDATE
  6313*    END-EXEC.
  6314*    MOVE '&"S        EU         (   #00005897' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 124
* EL652.cbl
  6315     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6316     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6317     MOVE X'2020233030303035383937' TO DFHEIV0(25:11)
  6318     CALL 'kxdfhei1' USING DFHEIV0,
  6319           RQST-FILE-ID,
  6320           DFHEIV20,
  6321           DFHEIV99,
  6322           ERRQST-KEY,
  6323           DFHEIV99,
  6324           DFHEIV99,
  6325           DFHEIV99
  6326     SET ADDRESS OF AR-REQUEST-RECORD TO
  6327         DFHEIV20
  6328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6329
  6330
  6331     MOVE WS-SUMM-FOR-RQST       TO  RQ-SUMMARY-CODE.
  6332
  6333
  6334* EXEC CICS REWRITE
  6335*        DATASET  (RQST-FILE-ID)
  6336*        FROM     (AR-REQUEST-RECORD)
  6337*    END-EXEC.
  6338     MOVE LENGTH OF
  6339      AR-REQUEST-RECORD
  6340       TO DFHEIV11
  6341*    MOVE '&& L                  %   #00005906' TO DFHEIV0
  6342     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6343     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6344     MOVE X'2020233030303035393036' TO DFHEIV0(25:11)
  6345     CALL 'kxdfhei1' USING DFHEIV0,
  6346           RQST-FILE-ID,
  6347           AR-REQUEST-RECORD,
  6348           DFHEIV11,
  6349           DFHEIV99
  6350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6351
  6352
  6353     GO TO 6500-UPDATE-RQST.
  6354
  6355 6550-END-BROWSE.
  6356
  6357
  6358* EXEC CICS ENDBR
  6359*        DATASET  (RQST-FILE-ID-3)
  6360*    END-EXEC.
  6361     MOVE 0
  6362       TO DFHEIV11
  6363*    MOVE '&2                    $   #00005915' TO DFHEIV0
  6364     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6365     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6366     MOVE X'2020233030303035393135' TO DFHEIV0(25:11)
  6367     CALL 'kxdfhei1' USING DFHEIV0,
  6368           RQST-FILE-ID-3,
  6369           DFHEIV11,
  6370           DFHEIV99
  6371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6372
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 125
* EL652.cbl
  6373
  6374 6599-EXIT.
  6375     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 126
* EL652.cbl
  6377
  6378 7000-EDIT.
  6379     MOVE LSTMDTI                TO  WS-DATE-MDY-8.
  6380
  6381     IF LSTMDTL > ZERO
  6382         NEXT SENTENCE
  6383     ELSE
  6384         GO TO 7100-EDIT-CONTD.
  6385
  6386     IF LSTMDTI = SPACES
  6387         GO TO 7100-EDIT-CONTD.
  6388
  6389     IF WS-DMDY8-SL1 = '/'  AND
  6390        WS-DMDY8-SL2 = '/'
  6391         MOVE WS-DMDY8-MM        TO  WS-YMD-MM
  6392         MOVE WS-DMDY8-DD        TO  WS-YMD-DD
  6393         MOVE WS-DMDY8-YY        TO  WS-YMD-YY
  6394     ELSE
  6395         MOVE WS-DMDY6-MM        TO  WS-YMD-MM
  6396         MOVE WS-DMDY6-DD        TO  WS-YMD-DD
  6397         MOVE WS-DMDY6-YY        TO  WS-YMD-YY.
  6398
  6399     MOVE WS-YMD-DATE            TO  DC-GREG-DATE-1-YMD.
  6400     MOVE '3'                    TO  DC-OPTION-CODE.
  6401
  6402     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  6403
  6404     IF NO-CONVERSION-ERROR
  6405         NEXT SENTENCE
  6406     ELSE
  6407         GO TO 7090-DATE-ERROR.
  6408
  6409     IF DC-BIN-DATE-1 > PI-CR-MONTH-END-DT
  6410         NEXT SENTENCE
  6411     ELSE
  6412         GO TO 7100-EDIT-CONTD.
  6413
  6414 7090-DATE-ERROR.
  6415     MOVE -1                     TO  LSTMDTL.
  6416     MOVE AL-UABON               TO  LSTMDTA.
  6417     MOVE ER-0314                TO  EMI-ERROR.
  6418
  6419     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6420
  6421 7100-EDIT-CONTD.
  6422
  6423     IF CSRL > ZEROS
  6424         MOVE AL-UANON           TO  CSRA
  6425     END-IF
  6426
  6427     IF MAILNAML > ZERO
  6428         MOVE AL-UANON           TO  MAILNAMA.
  6429
  6430     IF SSNL > ZERO
  6431         MOVE AL-UANON           TO  SSNA.
  6432
  6433     IF ACCTNAML > ZERO
  6434         MOVE AL-UANON           TO  ACCTNAMA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 127
* EL652.cbl
  6435     ELSE
  6436         IF ADD-FUNCTION
  6437             MOVE -1             TO  ACCTNAML
  6438             MOVE AL-UABON       TO  ACCTNAMA
  6439             MOVE ER-2045        TO  EMI-ERROR
  6440             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6441
  6442     IF PHONEL > ZERO
  6443         MOVE PHONEI               TO  DEEDIT-FIELD
  6444         PERFORM 7100-DEEDIT  THRU  7100-EXIT
  6445         IF DEEDIT-FIELD-V0 = ZEROS
  6446             MOVE SPACES               TO  PHONEO
  6447                                           PI-SAVE-PHONE
  6448         ELSE
  6449             IF (DEEDIT-FIELD-V0 > 9999999999
  6450               OR < 2000000000)
  6451                 MOVE -1               TO  PHONEL
  6452                 MOVE AL-UNBON         TO  PHONEA
  6453                 MOVE ER-2046          TO  EMI-ERROR
  6454                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6455             ELSE
  6456                 MOVE DEEDIT-FIELD-V0  TO  WS-PHONE-IN
  6457                                           PI-SAVE-PHONE-RED
  6458                 MOVE WSPI-AREA        TO  WSPO-AREA
  6459                 MOVE WSPI-PFX         TO  WSPO-PFX
  6460                 MOVE WSPI-SFX         TO  WSPO-SFX
  6461                 MOVE WS-PHONE-OUT     TO  PHONEO
  6462                 MOVE AL-UNNON         TO  PHONEA.
  6463
  6464     IF FAXNOL > ZERO
  6465         MOVE FAXNOI               TO  DEEDIT-FIELD
  6466         PERFORM 7100-DEEDIT  THRU  7100-EXIT
  6467         IF DEEDIT-FIELD-V0 = ZEROS
  6468             MOVE SPACES               TO  FAXNOO
  6469                                           PI-SAVE-FAXNO
  6470         ELSE
  6471             IF (DEEDIT-FIELD-V0 > 9999999999
  6472               OR < 2000000000)
  6473                 MOVE -1               TO  FAXNOL
  6474                 MOVE AL-UNBON         TO  FAXNOA
  6475                 MOVE ER-3055          TO  EMI-ERROR
  6476                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6477             ELSE
  6478                 MOVE DEEDIT-FIELD-V0  TO  WS-PHONE-IN
  6479                                           PI-SAVE-FAXNO-RED
  6480                 MOVE WSPI-AREA        TO  WSPO-AREA
  6481                 MOVE WSPI-PFX         TO  WSPO-PFX
  6482                 MOVE WSPI-SFX         TO  WSPO-SFX
  6483                 MOVE WS-PHONE-OUT     TO  FAXNOO
  6484                 MOVE AL-UNNON         TO  FAXNOA.
  6485
  6486     IF ADDR1L > ZERO
  6487         MOVE AL-UANON           TO  ADDR1A
  6488     ELSE
  6489         IF ADD-FUNCTION
  6490             MOVE -1             TO  ADDR1L
  6491             MOVE AL-UABON       TO  ADDR1A
  6492             MOVE ER-2047        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 128
* EL652.cbl
  6493             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6494
  6495     IF ADDR2L > ZERO
  6496         MOVE AL-UANON           TO  ADDR2A.
  6497
  6498     IF CARBALL > ZERO OR CHANGE-FUNCTION
  6499         MOVE CARBALI            TO  PI-CHECK-CARRY-BAL
  6500         IF VALID-CARRY-BAL
  6501             PERFORM 7010-EDIT-CARBAL  THRU  7010-EXIT
  6502         ELSE
  6503             MOVE -1             TO  CARBALL
  6504             MOVE AL-UABON       TO  CARBALA
  6505             MOVE ER-2048        TO  EMI-ERROR
  6506             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6507     ELSE
  6508         IF ADD-FUNCTION AND NOT PI-AR-PROCESSING
  6509             MOVE -1             TO  CARBALL
  6510             MOVE AL-UABON       TO  CARBALA
  6511             MOVE ER-2048        TO  EMI-ERROR
  6512             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6513
  6514     IF PI-AR-PROCESSING
  6515         IF TYPEI = 'A'
  6516            IF NETGRSL > ZERO OR CHANGE-FUNCTION
  6517                 IF NETGRSI = 'N' OR 'G'
  6518                    MOVE AL-UANON    TO  NETGRSA
  6519                 ELSE
  6520                     MOVE -1         TO  NETGRSL
  6521                     MOVE AL-UABON   TO  NETGRSA
  6522                     MOVE ER-3151    TO  EMI-ERROR
  6523                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6524
  6525     IF CITYL > ZERO
  6526         MOVE AL-UANON           TO  CITYA
  6527     ELSE
  6528         IF ADD-FUNCTION
  6529             MOVE -1             TO  CITYL
  6530             MOVE AL-UABON       TO  CITYA
  6531             MOVE ER-2049        TO  EMI-ERROR
  6532             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6533
  6534     IF STATEL   > ZERO
  6535        MOVE AL-UANON            TO STATEA
  6536        MOVE SPACES              TO ELCNTL-KEY
  6537        MOVE PI-COMPANY-ID       TO CNTL-COMP-ID
  6538        MOVE '3'                 TO CNTL-REC-TYPE
  6539        MOVE STATEI              TO CNTL-ACCESS
  6540        MOVE +0                  TO CNTL-SEQ-NO
  6541
  6542* EXEC CICS READ
  6543*          DATASET   (CNTL-FILE-ID)
  6544*          SET       (ADDRESS OF CONTROL-FILE)
  6545*          RIDFLD    (ELCNTL-KEY)
  6546*          RESP      (WS-RESPONSE)
  6547*       END-EXEC
  6548*    MOVE '&"S        E          (  N#00006086' TO DFHEIV0
  6549     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6550     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 129
* EL652.cbl
  6551     MOVE X'204E233030303036303836' TO DFHEIV0(25:11)
  6552     CALL 'kxdfhei1' USING DFHEIV0,
  6553           CNTL-FILE-ID,
  6554           DFHEIV20,
  6555           DFHEIV99,
  6556           ELCNTL-KEY,
  6557           DFHEIV99,
  6558           DFHEIV99,
  6559           DFHEIV99
  6560     SET ADDRESS OF CONTROL-FILE TO
  6561         DFHEIV20
  6562     MOVE EIBRESP  TO WS-RESPONSE
  6563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6564        IF RESP-NORMAL
  6565           CONTINUE
  6566        ELSE
  6567           MOVE ER-2209          TO EMI-ERROR
  6568           MOVE -1               TO STATEL
  6569           MOVE AL-UABON         TO STATEA
  6570           PERFORM 9900-ERROR-FORMAT
  6571                                 THRU 9900-EXIT
  6572        END-IF
  6573     ELSE
  6574         IF ADD-FUNCTION
  6575             MOVE -1             TO  STATEL
  6576             MOVE AL-UABON       TO  STATEA
  6577             MOVE ER-2049        TO  EMI-ERROR
  6578             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6579
  6580     IF PI-AR-PROCESSING
  6581         IF ARBALL > ZERO OR CHANGE-FUNCTION
  6582             IF ARBALI = '1' OR '2' OR '3' OR '4'
  6583                 MOVE AL-UANON   TO  ARBALA
  6584             ELSE
  6585                 MOVE -1         TO  ARBALL
  6586                 MOVE AL-UABON   TO  ARBALA
  6587                 MOVE ER-3150    TO  EMI-ERROR
  6588                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6589
  6590     IF PI-AR-PROCESSING
  6591         IF CKPULLL > ZERO OR CHANGE-FUNCTION
  6592             IF CKPULLI = 'Y' OR 'N'
  6593                 MOVE AL-UANON   TO  CKPULLA
  6594             ELSE
  6595                 MOVE -1         TO  CKPULLL
  6596                 MOVE AL-UABON   TO  CKPULLA
  6597                 MOVE ER-3170    TO  EMI-ERROR
  6598                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6599
  6600     IF ZIPCODEL > ZERO
  6601         MOVE AL-UANON           TO  ZIPCODEA.
  6602
  6603     IF PI-COMPANY-ID = 'CID'
  6604        CONTINUE
  6605     ELSE
  6606        IF PI-ERC-TYPE = 'B'
  6607           IF CLPSTL > ZERO
  6608              PERFORM 4700-CHECK-STATE       THRU 4799-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 130
* EL652.cbl
  6609              IF CLPSTI = SPACES
  6610                 MOVE -1         TO  CLPSTL
  6611                 MOVE AL-UABON   TO  CLPSTA
  6612                 MOVE ER-0144    TO  EMI-ERROR
  6613                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6614              ELSE
  6615                 MOVE AL-UANON   TO  CLPSTA
  6616              END-IF
  6617           ELSE
  6618              IF ADD-FUNCTION
  6619                 MOVE -1         TO  CLPSTL
  6620                 MOVE AL-UABON   TO  CLPSTA
  6621                 MOVE ER-0144    TO  EMI-ERROR
  6622                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6623              END-IF
  6624           END-IF
  6625
  6626           IF MAXFEEL  > ZERO
  6627
  6628* EXEC CICS BIF
  6629*                  DEEDIT
  6630*                  FIELD   (MAXFEEI)
  6631*                  LENGTH  (6)
  6632*             END-EXEC
  6633     MOVE 6
  6634       TO DFHEIV11
  6635*    MOVE '@"L                   #   #00006155' TO DFHEIV0
  6636     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6637     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6638     MOVE X'2020233030303036313535' TO DFHEIV0(25:11)
  6639     CALL 'kxdfhei1' USING DFHEIV0,
  6640           MAXFEEI,
  6641           DFHEIV11
  6642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6643              IF MAXFEEI NUMERIC
  6644                 MOVE AL-UNNON   TO  MAXFEEA
  6645              ELSE
  6646                 MOVE -1         TO  MAXFEEL
  6647                 MOVE AL-UABON   TO  MAXFEEA
  6648                 MOVE ER-3261    TO  EMI-ERROR
  6649                 PERFORM 9900-ERROR-FORMAT
  6650                                 THRU  9900-EXIT
  6651              END-IF
  6652           ELSE
  6653              IF ADD-FUNCTION
  6654                 MOVE -1         TO  MAXFEEL
  6655                 MOVE AL-UABON   TO  MAXFEEA
  6656                 MOVE ER-3261    TO  EMI-ERROR
  6657                 PERFORM 9900-ERROR-FORMAT
  6658                                 THRU  9900-EXIT
  6659              END-IF
  6660           END-IF
  6661           IF MAXLFL  > ZERO
  6662
  6663* EXEC CICS BIF
  6664*                  DEEDIT
  6665*                  FIELD   (MAXLFI)
  6666*                  LENGTH  (6)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 131
* EL652.cbl
  6667*             END-EXEC
  6668     MOVE 6
  6669       TO DFHEIV11
  6670*    MOVE '@"L                   #   #00006179' TO DFHEIV0
  6671     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6672     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6673     MOVE X'2020233030303036313739' TO DFHEIV0(25:11)
  6674     CALL 'kxdfhei1' USING DFHEIV0,
  6675           MAXLFI,
  6676           DFHEIV11
  6677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6678              IF MAXLFI NUMERIC
  6679                 MOVE AL-UNNON   TO  MAXLFA
  6680              ELSE
  6681                 MOVE -1         TO  MAXLFL
  6682                 MOVE AL-UABON   TO  MAXLFA
  6683                 MOVE ER-3261    TO  EMI-ERROR
  6684                 PERFORM 9900-ERROR-FORMAT
  6685                                 THRU  9900-EXIT
  6686              END-IF
  6687           ELSE
  6688              IF ADD-FUNCTION
  6689                 MOVE -1         TO  MAXLFL
  6690                 MOVE AL-UABON   TO  MAXLFA
  6691                 MOVE ER-3261    TO  EMI-ERROR
  6692                 PERFORM 9900-ERROR-FORMAT
  6693                                 THRU  9900-EXIT
  6694              END-IF
  6695           END-IF
  6696           IF REFEL > ZERO
  6697              IF REFEI = ' ' OR 'R' OR 'N' OR 'B'
  6698                 MOVE AL-UANON   TO REFEA
  6699              ELSE
  6700                 MOVE -1         TO REFEL
  6701                 MOVE AL-UABON   TO REFEA
  6702                 MOVE ER-2790    TO EMI-ERROR
  6703                 PERFORM 9900-ERROR-FORMAT
  6704                                 THRU  9900-EXIT
  6705              END-IF
  6706           END-IF
  6707        END-IF
  6708     END-IF
  6709
  6710     IF BALFWDL > ZERO
  6711
  6712* EXEC CICS BIF
  6713*            DEEDIT
  6714*            FIELD   (BALFWDI)
  6715*            LENGTH  (13)
  6716*        END-EXEC
  6717     MOVE 13
  6718       TO DFHEIV11
  6719*    MOVE '@"L                   #   #00006217' TO DFHEIV0
  6720     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6721     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6722     MOVE X'2020233030303036323137' TO DFHEIV0(25:11)
  6723     CALL 'kxdfhei1' USING DFHEIV0,
  6724           BALFWDI,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 132
* EL652.cbl
  6725           DFHEIV11
  6726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6727         MOVE AL-UNNON           TO  BALFWDA
  6728         MOVE BALFWDI            TO  WS-SAVE-BALFWD.
  6729
  6730     IF CURCOML >        ZERO
  6731
  6732* EXEC CICS BIF
  6733*            DEEDIT
  6734*            FIELD   (CURCOMI)
  6735*            LENGTH  (13)
  6736*        END-EXEC
  6737     MOVE 13
  6738       TO DFHEIV11
  6739*    MOVE '@"L                   #   #00006226' TO DFHEIV0
  6740     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6741     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6742     MOVE X'2020233030303036323236' TO DFHEIV0(25:11)
  6743     CALL 'kxdfhei1' USING DFHEIV0,
  6744           CURCOMI,
  6745           DFHEIV11
  6746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6747         MOVE AL-UNNON           TO  CURCOMA
  6748         MOVE CURCOMI            TO  WS-SAVE-CURCOM.
  6749
  6750     IF CURCHGL > ZERO
  6751
  6752* EXEC CICS BIF
  6753*            DEEDIT
  6754*            FIELD   (CURCHGI)
  6755*            LENGTH  (13)
  6756*        END-EXEC
  6757     MOVE 13
  6758       TO DFHEIV11
  6759*    MOVE '@"L                   #   #00006235' TO DFHEIV0
  6760     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6761     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6762     MOVE X'2020233030303036323335' TO DFHEIV0(25:11)
  6763     CALL 'kxdfhei1' USING DFHEIV0,
  6764           CURCHGI,
  6765           DFHEIV11
  6766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6767         MOVE AL-UNNON           TO  CURCHGA
  6768         MOVE CURCHGI            TO  WS-SAVE-CURCHG.
  6769
  6770     IF CURPMTL > ZERO
  6771
  6772* EXEC CICS BIF
  6773*            DEEDIT
  6774*            FIELD   (CURPMTI)
  6775*            LENGTH  (13)
  6776*        END-EXEC
  6777     MOVE 13
  6778       TO DFHEIV11
  6779*    MOVE '@"L                   #   #00006244' TO DFHEIV0
  6780     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6781     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6782     MOVE X'2020233030303036323434' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 133
* EL652.cbl
  6783     CALL 'kxdfhei1' USING DFHEIV0,
  6784           CURPMTI,
  6785           DFHEIV11
  6786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6787         MOVE AL-UNNON           TO  CURPMTA
  6788         MOVE CURPMTI            TO  WS-SAVE-CURPMT.
  6789
  6790     IF ENDBALL > ZERO
  6791
  6792* EXEC CICS BIF
  6793*            DEEDIT
  6794*            FIELD   (ENDBALI)
  6795*            LENGTH  (13)
  6796*        END-EXEC
  6797     MOVE 13
  6798       TO DFHEIV11
  6799*    MOVE '@"L                   #   #00006253' TO DFHEIV0
  6800     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6801     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6802     MOVE X'2020233030303036323533' TO DFHEIV0(25:11)
  6803     CALL 'kxdfhei1' USING DFHEIV0,
  6804           ENDBALI,
  6805           DFHEIV11
  6806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6807         MOVE AL-UNNON           TO  ENDBALA
  6808         MOVE ENDBALI            TO  WS-SAVE-ENDBAL.
  6809
  6810*    IF YTDCOML > ZERO
  6811*       EXEC CICS BIF
  6812*            DEEDIT
  6813*            FIELD   (YTDCOMI)
  6814*            LENGTH  (13)
  6815*       END-EXEC
  6816*       MOVE AL-UNNON            TO YTDCOMA
  6817*       MOVE YTDCOMI             TO WS-SAVE-YTDCOM
  6818*    END-IF
  6819     .
  6820 7000-EXIT.
  6821     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 134
* EL652.cbl
  6823 7010-EDIT-CARBAL.
  6824     IF TYPEI = 'G' OR 'B'
  6825         IF CARBALI NOT = 'Y'
  6826             MOVE -1             TO  CARBALL
  6827             MOVE AL-UABON       TO  CARBALA
  6828             MOVE ER-2093        TO  EMI-ERROR
  6829             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6830             GO TO 7010-EXIT.
  6831
  6832     IF TYPEI = 'A'
  6833         IF FINRESPI = ACCTNOI
  6834             IF CARBALI NOT = 'Y'
  6835                 MOVE -1         TO  CARBALL
  6836                 MOVE AL-UABON   TO  CARBALA
  6837                 MOVE ER-2094    TO  EMI-ERROR
  6838                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6839                 GO TO 7010-EXIT.
  6840
  6841     IF PI-PROCESSOR-ID = 'E864'
  6842         NEXT SENTENCE
  6843     ELSE
  6844        IF TYPEI = 'A'
  6845           IF PI-AR-PROCESSING
  6846               IF FINRESPI NOT = ACCTNOI
  6847                    IF CARBALI = 'Y'
  6848                       MOVE -1             TO  CARBALL
  6849                       MOVE AL-UABON       TO  CARBALA
  6850                       MOVE ER-3174        TO  EMI-ERROR
  6851                       PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6852
  6853     IF TYPEI = 'C'
  6854         IF CARBALI NOT = 'N'
  6855             MOVE -1             TO  CARBALL
  6856             MOVE AL-UABON       TO  CARBALA
  6857             MOVE ER-2096        TO  EMI-ERROR
  6858             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6859             GO TO 7010-EXIT.
  6860
  6861     IF PI-PROCESSOR-ID = 'E864'
  6862         NEXT SENTENCE
  6863     ELSE
  6864        IF CHANGE-FUNCTION
  6865            IF PI-ERC-END-BAL NOT = ZERO
  6866                IF CARBALI = 'N'
  6867                    MOVE -1         TO  CARBALL
  6868                    MOVE AL-UABON   TO  CARBALA
  6869                    MOVE ER-2095    TO  EMI-ERROR
  6870                    PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6871                    GO TO 7010-EXIT.
  6872
  6873     MOVE AL-UANON               TO  CARBALA.
  6874
  6875 7010-EXIT.
  6876     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 135
* EL652.cbl
  6878 7050-READ-ERCOMP.
  6879     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  6880
  6881
  6882* EXEC CICS READ
  6883*        DATASET  (COMP-FILE-ID)
  6884*        SET      (ADDRESS OF COMPENSATION-MASTER)
  6885*        RIDFLD   (PI-ERCOMP-KEY)
  6886*    END-EXEC.
  6887*    MOVE '&"S        E          (   #00006332' TO DFHEIV0
  6888     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6889     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6890     MOVE X'2020233030303036333332' TO DFHEIV0(25:11)
  6891     CALL 'kxdfhei1' USING DFHEIV0,
  6892           COMP-FILE-ID,
  6893           DFHEIV20,
  6894           DFHEIV99,
  6895           PI-ERCOMP-KEY,
  6896           DFHEIV99,
  6897           DFHEIV99,
  6898           DFHEIV99
  6899     SET ADDRESS OF COMPENSATION-MASTER TO
  6900         DFHEIV20
  6901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6902
  6903
  6904     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  6905
  6906 7050-EXIT.
  6907     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 136
* EL652.cbl
  6909 7100-DEEDIT.
  6910
  6911* EXEC CICS BIF
  6912*        DEEDIT
  6913*        FIELD   (DEEDIT-FIELD)
  6914*        LENGTH  (15)
  6915*    END-EXEC.
  6916     MOVE 15
  6917       TO DFHEIV11
  6918*    MOVE '@"L                   #   #00006344' TO DFHEIV0
  6919     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6920     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6921     MOVE X'2020233030303036333434' TO DFHEIV0(25:11)
  6922     CALL 'kxdfhei1' USING DFHEIV0,
  6923           DEEDIT-FIELD,
  6924           DFHEIV11
  6925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6926
  6927
  6928 7100-EXIT.
  6929     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 137
* EL652.cbl
  6931 7150-ERCOMP-GETMAIN.
  6932
  6933* EXEC CICS GETMAIN
  6934*        SET      (ADDRESS OF COMPENSATION-MASTER)
  6935*        LENGTH   (ERCOMP-LENGTH)
  6936*        INITIMG  (GETMAIN-SPACE)
  6937*    END-EXEC.
  6938*    MOVE ',"IL                  $   #00006354' TO DFHEIV0
  6939     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6940     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6941     MOVE X'2020233030303036333534' TO DFHEIV0(25:11)
  6942     CALL 'kxdfhei1' USING DFHEIV0,
  6943           DFHEIV20,
  6944           ERCOMP-LENGTH,
  6945           GETMAIN-SPACE
  6946     SET ADDRESS OF COMPENSATION-MASTER TO
  6947         DFHEIV20
  6948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6949
  6950
  6951 7150-EXIT.
  6952     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 138
* EL652.cbl
  6954 7200-READ-ERCOMP-UPDATE.
  6955     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  6956
  6957
  6958* EXEC CICS READ
  6959*        DATASET  (COMP-FILE-ID)
  6960*        SET      (ADDRESS OF COMPENSATION-MASTER)
  6961*        RIDFLD   (PI-ERCOMP-KEY)
  6962*        UPDATE
  6963*    END-EXEC.
  6964*    MOVE '&"S        EU         (   #00006366' TO DFHEIV0
  6965     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6966     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6967     MOVE X'2020233030303036333636' TO DFHEIV0(25:11)
  6968     CALL 'kxdfhei1' USING DFHEIV0,
  6969           COMP-FILE-ID,
  6970           DFHEIV20,
  6971           DFHEIV99,
  6972           PI-ERCOMP-KEY,
  6973           DFHEIV99,
  6974           DFHEIV99,
  6975           DFHEIV99
  6976     SET ADDRESS OF COMPENSATION-MASTER TO
  6977         DFHEIV20
  6978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6979
  6980
  6981 7200-EXIT.
  6982     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 139
* EL652.cbl
  6984 7250-PAGE-FORWARD.
  6985     MOVE SPACES                 TO  PI-ERCOMP-EOF-SW.
  6986
  6987     IF MAINTYPL > ZERO
  6988         MOVE GROUPI             TO  PI-ERC-GROUP
  6989         MOVE CARRIERI           TO  PI-ERC-CARRIER
  6990         MOVE FINRESPI           TO  PI-ERC-RESP
  6991         MOVE ACCTNOI            TO  PI-ERC-ACCT
  6992         MOVE TYPEI              TO  PI-ERC-TYPE
  6993     ELSE
  6994         MOVE LOW-VALUES         TO  PI-ERCOMP-KEY
  6995         MOVE 'Y'                TO  PI-FIRST-TIME-SW.
  6996
  6997     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  6998     MOVE PI-ERCOMP-KEY          TO  WS-SAVE-KEY.
  6999
  7000
  7001* EXEC CICS HANDLE CONDITION
  7002*        ENDFILE  (7250-ENDFILE)
  7003*        NOTFND   (7250-ENDFILE)
  7004*        ERROR    (9990-ABEND)
  7005*    END-EXEC.
  7006*    MOVE '"$''I.                 ! - #00006392' TO DFHEIV0
  7007     MOVE X'222427492E20202020202020' TO DFHEIV0(1:12)
  7008     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7009     MOVE X'2D20233030303036333932' TO DFHEIV0(25:11)
  7010     CALL 'kxdfhei1' USING DFHEIV0
  7011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7012
  7013
  7014     PERFORM 7850-START-BROWSE  THRU  7850-EXIT.
  7015
  7016 7250-READ-NEXT.
  7017
  7018* EXEC CICS HANDLE CONDITION
  7019*        ENDFILE  (7250-ENDFILE)
  7020*        NOTFND   (7275-NOTFOUND)
  7021*    END-EXEC.
  7022*    MOVE '"$''I                  ! . #00006401' TO DFHEIV0
  7023     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7024     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7025     MOVE X'2E20233030303036343031' TO DFHEIV0(25:11)
  7026     CALL 'kxdfhei1' USING DFHEIV0
  7027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7028
  7029
  7030     PERFORM 7900-READNEXT  THRU  7900-EXIT.
  7031
  7032     IF PI-CARRIER-SECURITY > SPACES
  7033         IF PI-ERC-CARRIER = PI-CARRIER-SECURITY
  7034             NEXT SENTENCE
  7035         ELSE
  7036             GO TO 7250-READ-NEXT.
  7037
  7038     IF ERCOMP-EOF
  7039         IF FIRST-TIME
  7040             MOVE LOW-VALUES     TO  EL652AO
  7041             MOVE ER-0584        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 140
* EL652.cbl
  7042             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7043             GO TO 8100-SEND-INITIAL-MAP
  7044         ELSE
  7045             MOVE LOW-VALUES     TO  EL652AO
  7046             MOVE ER-2067        TO  EMI-ERROR
  7047             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7048             PERFORM 7950-END-BROWSE  THRU  7950-EXIT
  7049             GO TO 7250-PAGE-FORWARD.
  7050
  7051     IF PI-ERCOMP-KEY = WS-SAVE-KEY
  7052         GO TO 7250-READ-NEXT.
  7053
  7054     MOVE CO-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  7055     MOVE CO-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  7056     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  7057     MOVE LOW-VALUES             TO  EL652AO.
  7058     MOVE CO-CARRIER             TO  CARRIERO.
  7059     MOVE CO-GROUPING            TO  GROUPO.
  7060     MOVE CO-RESP-NO             TO  FINRESPO.
  7061     MOVE CO-ACCOUNT             TO  ACCTNOO.
  7062     MOVE CO-TYPE                TO  TYPEO.
  7063     MOVE AL-UANON               TO  CARRIERA
  7064                                     GROUPA
  7065                                     TYPEA
  7066                                     FINRESPA
  7067                                     ACCTNOA
  7068                                     MAINTYPA.
  7069     MOVE 'S'                    TO  MAINTYPO
  7070                                     PI-CHECK-MAINT-TYPE.
  7071
  7072     GO TO 5050-SET-UP-SCREEN.
  7073
  7074 7250-ENDFILE.
  7075     IF FIRST-TIME
  7076         MOVE LOW-VALUES         TO  EL652AO
  7077         MOVE ER-0584            TO  EMI-ERROR
  7078         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7079         GO TO 8100-SEND-INITIAL-MAP.
  7080
  7081     IF BROWSE-STARTED
  7082         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  7083
  7084     MOVE ER-2067                TO  EMI-ERROR.
  7085     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7086
  7087     MOVE LOW-VALUES             TO  EL652AO.
  7088
  7089     GO TO 7250-PAGE-FORWARD.
  7090
  7091 7275-NOTFOUND.
  7092     IF BROWSE-STARTED
  7093         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  7094
  7095     GO TO 8880-NOT-FOUND.
  7096
  7097 7299-EXIT.
  7098     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 141
* EL652.cbl
  7100 7300-PAGE-BACKWARD.
  7101     MOVE SPACES                 TO  PI-ERCOMP-EOF-SW.
  7102
  7103     IF MAINTYPL > ZERO
  7104         MOVE GROUPI             TO  PI-ERC-GROUP
  7105         MOVE CARRIERI           TO  PI-ERC-CARRIER
  7106         MOVE FINRESPI           TO  PI-ERC-RESP
  7107         MOVE ACCTNOI            TO  PI-ERC-ACCT
  7108         MOVE TYPEI              TO  PI-ERC-TYPE
  7109     ELSE
  7110         MOVE LOW-VALUES         TO  PI-ERCOMP-KEY.
  7111
  7112     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  7113
  7114
  7115* EXEC CICS HANDLE CONDITION
  7116*        ENDFILE  (7375-ENDFILE)
  7117*        NOTFND   (7375-ENDFILE)
  7118*        ERROR    (9990-ABEND)
  7119*    END-EXEC.
  7120*    MOVE '"$''I.                 ! / #00006490' TO DFHEIV0
  7121     MOVE X'222427492E20202020202020' TO DFHEIV0(1:12)
  7122     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7123     MOVE X'2F20233030303036343930' TO DFHEIV0(25:11)
  7124     CALL 'kxdfhei1' USING DFHEIV0
  7125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7126
  7127
  7128     PERFORM 7850-START-BROWSE  THRU  7850-EXIT.
  7129
  7130     PERFORM 8050-READPREV  THRU  8050-EXIT.
  7131
  7132 7350-READ-PREV.
  7133
  7134* EXEC CICS HANDLE CONDITION
  7135*        ENDFILE  (7375-ENDFILE)
  7136*        NOTFND   (7275-NOTFOUND)
  7137*    END-EXEC.
  7138*    MOVE '"$''I                  ! 0 #00006501' TO DFHEIV0
  7139     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7140     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7141     MOVE X'3020233030303036353031' TO DFHEIV0(25:11)
  7142     CALL 'kxdfhei1' USING DFHEIV0
  7143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7144
  7145
  7146     PERFORM 8050-READPREV  THRU  8050-EXIT.
  7147
  7148     IF PI-CARRIER-SECURITY > SPACES
  7149         IF PI-ERC-CARRIER = PI-CARRIER-SECURITY
  7150             NEXT SENTENCE
  7151         ELSE
  7152             GO TO 7350-READ-PREV.
  7153
  7154     IF PI-COMPANY-CD NOT = CO-COMPANY-CD
  7155         GO TO 7375-ENDFILE.
  7156
  7157     MOVE CO-LAST-MAINT-USER     TO  PI-UPDATE-BY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 142
* EL652.cbl
  7158     MOVE CO-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  7159     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  7160     MOVE LOW-VALUES             TO  EL652AO.
  7161     MOVE CO-CARRIER             TO  CARRIERO.
  7162     MOVE CO-GROUPING            TO  GROUPO.
  7163     MOVE CO-RESP-NO             TO  FINRESPO.
  7164     MOVE CO-ACCOUNT             TO  ACCTNOO.
  7165     MOVE CO-TYPE                TO  TYPEO.
  7166     MOVE AL-UANON               TO  CARRIERA
  7167                                     GROUPA
  7168                                     TYPEA
  7169                                     FINRESPA
  7170                                     ACCTNOA
  7171                                     MAINTYPA.
  7172     MOVE 'S'                    TO  MAINTYPO
  7173                                     PI-CHECK-MAINT-TYPE.
  7174
  7175     GO TO 5050-SET-UP-SCREEN.
  7176
  7177 7375-ENDFILE.
  7178     IF BROWSE-STARTED
  7179         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  7180
  7181     MOVE ER-2238                TO  EMI-ERROR.
  7182     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7183
  7184     MOVE -1                     TO  MAINTYPL.
  7185
  7186     GO TO 8200-SEND-DATAONLY.
  7187
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 143
* EL652.cbl
  7189 7400-READ-CONTROL-FILE.
  7190     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7191     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  7192
  7193
  7194* EXEC CICS HANDLE CONDITION
  7195*        NOTFND  (7490-NOT-FOUND)
  7196*        ERROR   (9990-ABEND)
  7197*    END-EXEC.
  7198*    MOVE '"$I.                  ! 1 #00006553' TO DFHEIV0
  7199     MOVE X'2224492E2020202020202020' TO DFHEIV0(1:12)
  7200     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7201     MOVE X'3120233030303036353533' TO DFHEIV0(25:11)
  7202     CALL 'kxdfhei1' USING DFHEIV0
  7203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7204
  7205
  7206
  7207* EXEC CICS READ
  7208*        DATASET  (CNTL-FILE-ID)
  7209*        SET      (ADDRESS OF CONTROL-FILE)
  7210*        RIDFLD   (ELCNTL-KEY)
  7211*    END-EXEC.
  7212*    MOVE '&"S        E          (   #00006558' TO DFHEIV0
  7213     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7214     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7215     MOVE X'2020233030303036353538' TO DFHEIV0(25:11)
  7216     CALL 'kxdfhei1' USING DFHEIV0,
  7217           CNTL-FILE-ID,
  7218           DFHEIV20,
  7219           DFHEIV99,
  7220           ELCNTL-KEY,
  7221           DFHEIV99,
  7222           DFHEIV99,
  7223           DFHEIV99
  7224     SET ADDRESS OF CONTROL-FILE TO
  7225         DFHEIV20
  7226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7227
  7228
  7229     IF CNTL-REC-TYPE = '6'
  7230         MOVE AL-UANON           TO  CARRIERA
  7231         MOVE CARRIERI           TO  PI-ERC-CARRIER
  7232         GO TO 7499-EXIT.
  7233
  7234     IF CF-COMPENSATION-MSTR-MAINT-DT NOT = LOW-VALUES
  7235         GO TO 7499-EXIT
  7236     ELSE
  7237         MOVE -1                 TO  MAINTYPL
  7238         MOVE ER-2572            TO  EMI-ERROR
  7239         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7240         GO TO 7499-EXIT.
  7241
  7242 7490-NOT-FOUND.
  7243     IF CNTL-REC-TYPE = '6'
  7244         MOVE -1                 TO  CARRIERL
  7245         MOVE AL-UABON           TO  CARRIERA
  7246         MOVE ER-0193            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 144
* EL652.cbl
  7247     ELSE
  7248         IF CNTL-REC-TYPE = '2'
  7249             MOVE -1                TO  CSRL
  7250             MOVE AL-UABON          TO  CSRA
  7251             MOVE ER-1883           TO  EMI-ERROR
  7252         ELSE
  7253            MOVE ER-0002            TO  EMI-ERROR
  7254            MOVE -1                 TO  PFKEYL.
  7255
  7256     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7257
  7258 7499-EXIT.
  7259     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 145
* EL652.cbl
  7261
  7262 7500-UPDATE-SUMM.
  7263
  7264     PERFORM 7700-ERSUMM-GETMAIN  THRU  7700-EXIT.
  7265
  7266     MOVE 'SX'                   TO SX-RECORD-ID.
  7267     MOVE PI-COMPANY-CD          TO SX-COMPANY-CD.
  7268     MOVE PI-AR-SUMMARY-CODE     TO SX-SUMMARY.
  7269     MOVE PI-ERC-CARRIER         TO SX-CARRIER.
  7270     MOVE PI-ERC-GROUP           TO SX-GROUP.
  7271     MOVE PI-ERC-RESP            TO SX-FIN-RESP.
  7272     MOVE PI-ERC-ACCT            TO SX-ACCT-AGENT.
  7273     MOVE WS-SAVE-NAME           TO SX-SUMM-OR-AGT-NAME.
  7274     MOVE PI-PROCESSOR-ID        TO SX-LAST-MAINT-BY.
  7275     MOVE EIBTIME                TO SX-LAST-MAINT-HHMMSS.
  7276     MOVE BIN-CURRENT-SAVE       TO SX-LAST-MAINT-DT.
  7277     MOVE PI-COMPANY-CD          TO SX-COMPANY-A1.
  7278     MOVE PI-ERC-ACCT            TO SX-ACCT-AGENT-A1.
  7279     MOVE PI-AR-SUMMARY-CODE     TO SX-SUMMARY-A1.
  7280     MOVE PI-ERC-CARRIER         TO SX-CARR-A1.
  7281     MOVE PI-ERC-GROUP           TO SX-GROUP-A1.
  7282     MOVE PI-ERC-RESP            TO SX-FIN-RESP-A1.
  7283
  7284
  7285* EXEC CICS HANDLE CONDITION
  7286*        DUPREC  (7550-DUP)
  7287*    END-EXEC.
  7288*    MOVE '"$%                   ! 2 #00006619' TO DFHEIV0
  7289     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7290     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7291     MOVE X'3220233030303036363139' TO DFHEIV0(25:11)
  7292     CALL 'kxdfhei1' USING DFHEIV0
  7293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7294
  7295
  7296
  7297* EXEC CICS WRITE
  7298*        DATASET  (SUMM-FILE-ID)
  7299*        FROM     (SUMM-CROSS-REFERENCE)
  7300*        RIDFLD   (SX-CONTROL-PRIMARY)
  7301*    END-EXEC.
  7302     MOVE LENGTH OF
  7303      SUMM-CROSS-REFERENCE
  7304       TO DFHEIV11
  7305*    MOVE '&$ L                  ''   #00006623' TO DFHEIV0
  7306     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7307     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7308     MOVE X'2020233030303036363233' TO DFHEIV0(25:11)
  7309     CALL 'kxdfhei1' USING DFHEIV0,
  7310           SUMM-FILE-ID,
  7311           SUMM-CROSS-REFERENCE,
  7312           DFHEIV11,
  7313           SX-CONTROL-PRIMARY,
  7314           DFHEIV99,
  7315           DFHEIV99
  7316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7317
  7318
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 146
* EL652.cbl
  7319     MOVE LOW-VALUES             TO ERSUMM-KEY.
  7320     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7321     MOVE PI-AR-SUMMARY-CODE     TO SUMM-SUMMARY.
  7322
  7323
  7324* EXEC CICS HANDLE CONDITION
  7325*        NOTFND  (7540-WRITE)
  7326*    END-EXEC.
  7327*    MOVE '"$I                   ! 3 #00006633' TO DFHEIV0
  7328     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7329     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7330     MOVE X'3320233030303036363333' TO DFHEIV0(25:11)
  7331     CALL 'kxdfhei1' USING DFHEIV0
  7332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7333
  7334
  7335
  7336* EXEC CICS READ
  7337*        DATASET  (SUMM-FILE-ID)
  7338*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7339*        RIDFLD   (ERSUMM-KEY)
  7340*    END-EXEC.
  7341*    MOVE '&"S        E          (   #00006637' TO DFHEIV0
  7342     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7343     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7344     MOVE X'2020233030303036363337' TO DFHEIV0(25:11)
  7345     CALL 'kxdfhei1' USING DFHEIV0,
  7346           SUMM-FILE-ID,
  7347           DFHEIV20,
  7348           DFHEIV99,
  7349           ERSUMM-KEY,
  7350           DFHEIV99,
  7351           DFHEIV99,
  7352           DFHEIV99
  7353     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7354         DFHEIV20
  7355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7356
  7357     GO TO 7599-EXIT.
  7358
  7359 7540-WRITE.
  7360
  7361     MOVE ERSUMM-KEY             TO SX-CONTROL-PRIMARY.
  7362     MOVE LOW-VALUES             TO SX-CONTROL-A1.
  7363     MOVE PI-COMPANY-CD          TO SX-COMPANY-A1.
  7364     MOVE PI-AR-SUMMARY-CODE     TO SX-SUMMARY-A1.
  7365     MOVE SPACES                 TO SX-SUMM-OR-AGT-NAME.
  7366     MOVE 'LGXX'                 TO SX-LAST-MAINT-BY.
  7367
  7368
  7369* EXEC CICS WRITE
  7370*        DATASET  (SUMM-FILE-ID)
  7371*        FROM     (SUMM-CROSS-REFERENCE)
  7372*        RIDFLD   (SX-CONTROL-PRIMARY)
  7373*    END-EXEC.
  7374     MOVE LENGTH OF
  7375      SUMM-CROSS-REFERENCE
  7376       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 147
* EL652.cbl
  7377*    MOVE '&$ L                  ''   #00006653' TO DFHEIV0
  7378     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7379     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7380     MOVE X'2020233030303036363533' TO DFHEIV0(25:11)
  7381     CALL 'kxdfhei1' USING DFHEIV0,
  7382           SUMM-FILE-ID,
  7383           SUMM-CROSS-REFERENCE,
  7384           DFHEIV11,
  7385           SX-CONTROL-PRIMARY,
  7386           DFHEIV99,
  7387           DFHEIV99
  7388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7389
  7390
  7391     MOVE PI-ERC-CARRIER         TO PI-CR-CARRIER.
  7392     MOVE PI-ERC-GROUP           TO PI-CR-GROUPING.
  7393     MOVE PI-ERC-TYPE            TO PI-CR-TYPE.
  7394     MOVE PI-ERC-RESP            TO PI-CR-FIN-RESP.
  7395     MOVE PI-ERC-ACCT            TO PI-CR-ACCOUNT.
  7396
  7397     MOVE XCTL-856               TO PGM-NAME.
  7398     GO TO 9300-XCTL.
  7399
  7400 7550-DUP.
  7401
  7402     MOVE ER-3152                TO EMI-ERROR.
  7403     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7404
  7405     MOVE -1                     TO MAINTYPL.
  7406
  7407     GO TO 8200-SEND-DATAONLY.
  7408
  7409 7599-EXIT.
  7410     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 148
* EL652.cbl
  7412
  7413 7600-DELETE-SUMM.
  7414
  7415     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7416     MOVE WS-SAVE-SUMM           TO SUMM-SUMMARY.
  7417     MOVE PI-ERC-CARRIER         TO SUMM-CARRIER.
  7418     MOVE PI-ERC-GROUP           TO SUMM-GROUP.
  7419     MOVE PI-ERC-RESP            TO SUMM-FIN-RESP.
  7420     MOVE PI-ERC-ACCT            TO SUMM-ACCT-AGENT.
  7421
  7422 7620-READ-ERSUMM.
  7423
  7424* EXEC CICS HANDLE CONDITION
  7425*        NOTFND  (7699-EXIT)
  7426*    END-EXEC.
  7427*    MOVE '"$I                   ! 4 #00006691' TO DFHEIV0
  7428     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7430     MOVE X'3420233030303036363931' TO DFHEIV0(25:11)
  7431     CALL 'kxdfhei1' USING DFHEIV0
  7432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7433
  7434
  7435
  7436* EXEC CICS READ
  7437*        DATASET  (SUMM-FILE-ID)
  7438*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7439*        RIDFLD   (ERSUMM-KEY)
  7440*        UPDATE
  7441*    END-EXEC.
  7442*    MOVE '&"S        EU         (   #00006695' TO DFHEIV0
  7443     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7444     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7445     MOVE X'2020233030303036363935' TO DFHEIV0(25:11)
  7446     CALL 'kxdfhei1' USING DFHEIV0,
  7447           SUMM-FILE-ID,
  7448           DFHEIV20,
  7449           DFHEIV99,
  7450           ERSUMM-KEY,
  7451           DFHEIV99,
  7452           DFHEIV99,
  7453           DFHEIV99
  7454     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7455         DFHEIV20
  7456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7457
  7458
  7459
  7460* EXEC CICS DELETE
  7461*        DATASET  (SUMM-FILE-ID)
  7462*    END-EXEC.
  7463*    MOVE '&(                    &   #00006702' TO DFHEIV0
  7464     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7465     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7466     MOVE X'2020233030303036373032' TO DFHEIV0(25:11)
  7467     CALL 'kxdfhei1' USING DFHEIV0,
  7468           SUMM-FILE-ID,
  7469           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 149
* EL652.cbl
  7470           DFHEIV99,
  7471           DFHEIV99,
  7472           DFHEIV99
  7473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7474
  7475
  7476     MOVE LOW-VALUES             TO ERSUMM-KEY.
  7477     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7478     MOVE WS-SAVE-SUMM           TO SUMM-SUMMARY.
  7479
  7480
  7481* EXEC CICS STARTBR
  7482*        DATASET  (SUMM-FILE-ID)
  7483*        RIDFLD   (ERSUMM-KEY)
  7484*    END-EXEC.
  7485     MOVE 0
  7486       TO DFHEIV11
  7487*    MOVE '&,         G          &   #00006710' TO DFHEIV0
  7488     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7489     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7490     MOVE X'2020233030303036373130' TO DFHEIV0(25:11)
  7491     CALL 'kxdfhei1' USING DFHEIV0,
  7492           SUMM-FILE-ID,
  7493           ERSUMM-KEY,
  7494           DFHEIV99,
  7495           DFHEIV11,
  7496           DFHEIV99
  7497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7498
  7499
  7500
  7501* EXEC CICS READNEXT
  7502*        DATASET  (SUMM-FILE-ID)
  7503*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7504*        RIDFLD   (ERSUMM-KEY)
  7505*    END-EXEC.
  7506     MOVE 0
  7507       TO DFHEIV11
  7508*    MOVE '&.S                   )   #00006715' TO DFHEIV0
  7509     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7510     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7511     MOVE X'2020233030303036373135' TO DFHEIV0(25:11)
  7512     CALL 'kxdfhei1' USING DFHEIV0,
  7513           SUMM-FILE-ID,
  7514           DFHEIV20,
  7515           DFHEIV99,
  7516           ERSUMM-KEY,
  7517           DFHEIV99,
  7518           DFHEIV11,
  7519           DFHEIV99,
  7520           DFHEIV99
  7521     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7522         DFHEIV20
  7523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7524
  7525
  7526     IF SX-CARRIER = LOW-VALUES
  7527         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 150
* EL652.cbl
  7528     ELSE
  7529         GO TO 7640-END-BROWSE.
  7530
  7531
  7532* EXEC CICS HANDLE CONDITION
  7533*        ENDFILE  (7630-DELETE)
  7534*    END-EXEC.
  7535*    MOVE '"$''                   ! 5 #00006726' TO DFHEIV0
  7536     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7538     MOVE X'3520233030303036373236' TO DFHEIV0(25:11)
  7539     CALL 'kxdfhei1' USING DFHEIV0
  7540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7541
  7542
  7543
  7544* EXEC CICS READNEXT
  7545*        DATASET  (SUMM-FILE-ID)
  7546*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7547*        RIDFLD   (ERSUMM-KEY)
  7548*    END-EXEC.
  7549     MOVE 0
  7550       TO DFHEIV11
  7551*    MOVE '&.S                   )   #00006730' TO DFHEIV0
  7552     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7553     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7554     MOVE X'2020233030303036373330' TO DFHEIV0(25:11)
  7555     CALL 'kxdfhei1' USING DFHEIV0,
  7556           SUMM-FILE-ID,
  7557           DFHEIV20,
  7558           DFHEIV99,
  7559           ERSUMM-KEY,
  7560           DFHEIV99,
  7561           DFHEIV11,
  7562           DFHEIV99,
  7563           DFHEIV99
  7564     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7565         DFHEIV20
  7566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7567
  7568
  7569     IF SX-SUMMARY = WS-SAVE-SUMM
  7570         GO TO 7640-END-BROWSE.
  7571
  7572 7630-DELETE.
  7573
  7574* EXEC CICS ENDBR
  7575*        DATASET  (SUMM-FILE-ID)
  7576*    END-EXEC.
  7577     MOVE 0
  7578       TO DFHEIV11
  7579*    MOVE '&2                    $   #00006740' TO DFHEIV0
  7580     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7581     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7582     MOVE X'2020233030303036373430' TO DFHEIV0(25:11)
  7583     CALL 'kxdfhei1' USING DFHEIV0,
  7584           SUMM-FILE-ID,
  7585           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 151
* EL652.cbl
  7586           DFHEIV99
  7587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7588
  7589
  7590     MOVE LOW-VALUES             TO ERSUMM-KEY.
  7591     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7592     MOVE WS-SAVE-SUMM           TO SUMM-SUMMARY.
  7593
  7594
  7595* EXEC CICS READ
  7596*        DATASET  (SUMM-FILE-ID)
  7597*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7598*        RIDFLD   (ERSUMM-KEY)
  7599*        UPDATE
  7600*    END-EXEC.
  7601*    MOVE '&"S        EU         (   #00006748' TO DFHEIV0
  7602     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7603     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7604     MOVE X'2020233030303036373438' TO DFHEIV0(25:11)
  7605     CALL 'kxdfhei1' USING DFHEIV0,
  7606           SUMM-FILE-ID,
  7607           DFHEIV20,
  7608           DFHEIV99,
  7609           ERSUMM-KEY,
  7610           DFHEIV99,
  7611           DFHEIV99,
  7612           DFHEIV99
  7613     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7614         DFHEIV20
  7615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7616
  7617
  7618
  7619* EXEC CICS DELETE
  7620*        DATASET  (SUMM-FILE-ID)
  7621*    END-EXEC.
  7622*    MOVE '&(                    &   #00006755' TO DFHEIV0
  7623     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7624     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7625     MOVE X'2020233030303036373535' TO DFHEIV0(25:11)
  7626     CALL 'kxdfhei1' USING DFHEIV0,
  7627           SUMM-FILE-ID,
  7628           DFHEIV99,
  7629           DFHEIV99,
  7630           DFHEIV99,
  7631           DFHEIV99
  7632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7633
  7634
  7635     GO TO 7699-EXIT.
  7636
  7637 7640-END-BROWSE.
  7638
  7639* EXEC CICS ENDBR
  7640*        DATASET  (SUMM-FILE-ID)
  7641*    END-EXEC.
  7642     MOVE 0
  7643       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 152
* EL652.cbl
  7644*    MOVE '&2                    $   #00006762' TO DFHEIV0
  7645     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7646     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7647     MOVE X'2020233030303036373632' TO DFHEIV0(25:11)
  7648     CALL 'kxdfhei1' USING DFHEIV0,
  7649           SUMM-FILE-ID,
  7650           DFHEIV11,
  7651           DFHEIV99
  7652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7653
  7654
  7655 7699-EXIT.
  7656     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 153
* EL652.cbl
  7658
  7659 7700-ERSUMM-GETMAIN.
  7660
  7661* EXEC CICS GETMAIN
  7662*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7663*        LENGTH   (ERSUMM-LENGTH)
  7664*        INITIMG  (GETMAIN-SPACE)
  7665*    END-EXEC.
  7666*    MOVE ',"IL                  $   #00006771' TO DFHEIV0
  7667     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7668     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7669     MOVE X'2020233030303036373731' TO DFHEIV0(25:11)
  7670     CALL 'kxdfhei1' USING DFHEIV0,
  7671           DFHEIV20,
  7672           ERSUMM-LENGTH,
  7673           GETMAIN-SPACE
  7674     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7675         DFHEIV20
  7676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7677
  7678
  7679 7700-EXIT.
  7680     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 154
* EL652.cbl
  7682
  7683 7850-START-BROWSE.
  7684
  7685* EXEC CICS STARTBR
  7686*        DATASET  (COMP-FILE-ID)
  7687*        RIDFLD   (PI-ERCOMP-KEY)
  7688*    END-EXEC.
  7689     MOVE 0
  7690       TO DFHEIV11
  7691*    MOVE '&,         G          &   #00006782' TO DFHEIV0
  7692     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7693     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7694     MOVE X'2020233030303036373832' TO DFHEIV0(25:11)
  7695     CALL 'kxdfhei1' USING DFHEIV0,
  7696           COMP-FILE-ID,
  7697           PI-ERCOMP-KEY,
  7698           DFHEIV99,
  7699           DFHEIV11,
  7700           DFHEIV99
  7701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7702
  7703
  7704     MOVE 'Y'                    TO  WS-BROWSE-SW.
  7705
  7706 7850-EXIT.
  7707     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 155
* EL652.cbl
  7709 7900-READNEXT.
  7710
  7711* EXEC CICS READNEXT
  7712*        DATASET  (COMP-FILE-ID)
  7713*        SET      (ADDRESS OF COMPENSATION-MASTER)
  7714*        RIDFLD   (PI-ERCOMP-KEY)
  7715*    END-EXEC.
  7716     MOVE 0
  7717       TO DFHEIV11
  7718*    MOVE '&.S                   )   #00006793' TO DFHEIV0
  7719     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7720     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7721     MOVE X'2020233030303036373933' TO DFHEIV0(25:11)
  7722     CALL 'kxdfhei1' USING DFHEIV0,
  7723           COMP-FILE-ID,
  7724           DFHEIV20,
  7725           DFHEIV99,
  7726           PI-ERCOMP-KEY,
  7727           DFHEIV99,
  7728           DFHEIV11,
  7729           DFHEIV99,
  7730           DFHEIV99
  7731     SET ADDRESS OF COMPENSATION-MASTER TO
  7732         DFHEIV20
  7733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7734
  7735
  7736     IF PI-COMPANY-CD NOT = CO-COMPANY-CD
  7737         MOVE 'Y'                TO  PI-ERCOMP-EOF-SW
  7738     ELSE
  7739         MOVE SPACE              TO  PI-FIRST-TIME-SW.
  7740
  7741 7900-EXIT.
  7742     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 156
* EL652.cbl
  7744 7950-END-BROWSE.
  7745
  7746* EXEC CICS ENDBR
  7747*        DATASET  (COMP-FILE-ID)
  7748*    END-EXEC.
  7749     MOVE 0
  7750       TO DFHEIV11
  7751*    MOVE '&2                    $   #00006808' TO DFHEIV0
  7752     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7753     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7754     MOVE X'2020233030303036383038' TO DFHEIV0(25:11)
  7755     CALL 'kxdfhei1' USING DFHEIV0,
  7756           COMP-FILE-ID,
  7757           DFHEIV11,
  7758           DFHEIV99
  7759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7760
  7761
  7762     MOVE 'N'                    TO  WS-BROWSE-SW.
  7763
  7764 7950-EXIT.
  7765     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 157
* EL652.cbl
  7767 8000-UPDATE-MAINT-DATE.
  7768     MOVE SPACES                 TO  ELCNTL-KEY.
  7769     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7770     MOVE '1'                    TO  CNTL-REC-TYPE.
  7771     MOVE +0                     TO  CNTL-SEQ-NO.
  7772
  7773
  7774* EXEC CICS HANDLE CONDITION
  7775*        NOTFND  (8000-EXIT)
  7776*    END-EXEC.
  7777*    MOVE '"$I                   ! 6 #00006823' TO DFHEIV0
  7778     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7779     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7780     MOVE X'3620233030303036383233' TO DFHEIV0(25:11)
  7781     CALL 'kxdfhei1' USING DFHEIV0
  7782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7783
  7784
  7785
  7786* EXEC CICS READ
  7787*        UPDATE
  7788*        DATASET  (CNTL-FILE-ID)
  7789*        SET      (ADDRESS OF CONTROL-FILE)
  7790*        RIDFLD   (ELCNTL-KEY)
  7791*    END-EXEC.
  7792*    MOVE '&"S        EU         (   #00006827' TO DFHEIV0
  7793     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7794     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7795     MOVE X'2020233030303036383237' TO DFHEIV0(25:11)
  7796     CALL 'kxdfhei1' USING DFHEIV0,
  7797           CNTL-FILE-ID,
  7798           DFHEIV20,
  7799           DFHEIV99,
  7800           ELCNTL-KEY,
  7801           DFHEIV99,
  7802           DFHEIV99,
  7803           DFHEIV99
  7804     SET ADDRESS OF CONTROL-FILE TO
  7805         DFHEIV20
  7806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7807
  7808
  7809     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  7810     MOVE 'B'                    TO  JP-RECORD-TYPE.
  7811     MOVE CNTL-FILE-ID           TO  FILE-ID.
  7812
  7813     PERFORM 8400-LOG-JOURNAL-RECORD.
  7814
  7815     MOVE BIN-CURRENT-SAVE  TO  CF-COMPENSATION-MSTR-MAINT-DT.
  7816     MOVE CONTROL-FILE      TO  JP-RECORD-AREA.
  7817     MOVE 'C'               TO  JP-RECORD-TYPE.
  7818     MOVE CNTL-FILE-ID      TO  FILE-ID.
  7819
  7820
  7821* EXEC CICS REWRITE
  7822*        DATASET  (CNTL-FILE-ID)
  7823*        FROM     (CONTROL-FILE)
  7824*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 158
* EL652.cbl
  7825     MOVE LENGTH OF
  7826      CONTROL-FILE
  7827       TO DFHEIV11
  7828*    MOVE '&& L                  %   #00006845' TO DFHEIV0
  7829     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7830     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7831     MOVE X'2020233030303036383435' TO DFHEIV0(25:11)
  7832     CALL 'kxdfhei1' USING DFHEIV0,
  7833           CNTL-FILE-ID,
  7834           CONTROL-FILE,
  7835           DFHEIV11,
  7836           DFHEIV99
  7837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7838
  7839
  7840     PERFORM 8400-LOG-JOURNAL-RECORD.
  7841
  7842 8000-EXIT.
  7843      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 159
* EL652.cbl
  7845 8050-READPREV.
  7846
  7847* EXEC CICS READPREV
  7848*        DATASET  (COMP-FILE-ID)
  7849*        SET      (ADDRESS OF COMPENSATION-MASTER)
  7850*        RIDFLD   (PI-ERCOMP-KEY)
  7851*    END-EXEC.
  7852     MOVE 0
  7853       TO DFHEIV11
  7854*    MOVE '&0S                   )   #00006856' TO DFHEIV0
  7855     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  7856     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7857     MOVE X'2020233030303036383536' TO DFHEIV0(25:11)
  7858     CALL 'kxdfhei1' USING DFHEIV0,
  7859           COMP-FILE-ID,
  7860           DFHEIV20,
  7861           DFHEIV99,
  7862           PI-ERCOMP-KEY,
  7863           DFHEIV99,
  7864           DFHEIV11,
  7865           DFHEIV99,
  7866           DFHEIV99
  7867     SET ADDRESS OF COMPENSATION-MASTER TO
  7868         DFHEIV20
  7869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7870
  7871
  7872 8050-EXIT.
  7873     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 160
* EL652.cbl
  7875 8100-SEND-INITIAL-MAP.
  7876
  7877     IF  NOT CREDIT-SESSION
  7878         MOVE AL-SADOF           TO PFK5A
  7879                                    PFK6A.
  7880
  7881     IF PI-COMPANY-ID NOT = 'NCL'
  7882         MOVE AL-SANOF           TO  LETRCDA
  7883         MOVE AL-SADOF           TO  LETDESCA.
  7884
  7885     IF PI-COMPANY-ID  NOT = 'DDB' AND 'ANT' AND 'ASL' AND
  7886                             'AN1' AND 'TFS'
  7887         MOVE AL-SANOF           TO  BALCDA
  7888         MOVE AL-SADOF           TO  BALPRTA.
  7889
  7890     IF PI-COMPANY-ID   = 'NCL'
  7891        IF TYPEI =  'G' OR 'B'
  7892           MOVE AL-UNNOF         TO  RPTCD2A
  7893           MOVE AL-SANOF         TO  RPTCDDA.
  7894
  7895     IF PI-COMPANY-ID = 'DCC'
  7896        IF TYPEI = 'A'
  7897           MOVE AL-SANOF         TO SPPDDHA
  7898           MOVE AL-UANON         TO SPPDDA
  7899        END-IF
  7900     END-IF
  7901     MOVE AL-SANON               TO  FLITYPA.
  7902
  7903     IF EIBTRNID NOT = TRANS-ID
  7904        IF PI-AR-PROCESSING
  7905             MOVE AL-SANOF       TO  SCDESCA
  7906                                     NGDESCA
  7907                                     BALDESCA
  7908                                     CKDESCA
  7909             MOVE AL-UANON       TO  SUMMNOA
  7910                                     NETGRSA
  7911                                     ARBALA
  7912                                     CKPULLA.
  7913
  7914     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  7915         MOVE AL-UANOF           TO  LSTMDTA
  7916         MOVE AL-SANOF           TO  PFK9A
  7917     ELSE
  7918         IF PI-AR-PROCESSING
  7919             MOVE AL-SANOF       TO  PFK9A
  7920         ELSE
  7921             MOVE AL-SANOF       TO  LSTMDTA
  7922             MOVE AL-SADOF       TO  PFK9A.
  7923
  7924*    IF (PI-ERC-TYPE NOT = 'G' AND SPACE)
  7925*       OR (PI-COMPANY-ID NOT = 'DCC')
  7926     IF PI-ERC-TYPE = 'A'
  7927        MOVE AL-SANOF            TO PCONTA
  7928     END-IF
  7929     IF PI-ERC-TYPE NOT = 'B' AND SPACE
  7930         MOVE AL-SADOF           TO  PFK10A
  7931                                     PFK13A
  7932         MOVE AL-SADOF           TO  CSLABLA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 161
* EL652.cbl
  7933         MOVE AL-SADOF           TO  CLPSTA
  7934         MOVE AL-SADOF           TO  MFLABLA
  7935         MOVE AL-SADOF           TO  MAXFEEA
  7936         MOVE AL-SADOF           TO  LFLABLA
  7937         MOVE AL-SADOF           TO  MAXLFA
  7938         MOVE AL-SADOF           TO  REFEHA
  7939                                     REFEA
  7940     END-IF
  7941     MOVE SAVE-DATE              TO  RUNDATEO.
  7942     MOVE EIBTIME                TO  TIME-IN.
  7943     MOVE TIME-OUT               TO  RUNTIMEO.
  7944     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  7945     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  7946     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  7947     MOVE -1                     TO  MAINTYPL.
  7948
  7949
  7950* EXEC CICS SEND
  7951*        MAP     (MAP-NAME)
  7952*        MAPSET  (MAPSET-NAME)
  7953*        FROM    (EL652AO)
  7954*        ERASE
  7955*        CURSOR
  7956*    END-EXEC.
  7957     MOVE LENGTH OF
  7958      EL652AO
  7959       TO DFHEIV12
  7960     MOVE -1
  7961       TO DFHEIV11
  7962*    MOVE '8$     CT  E    H L F ,   #00006939' TO DFHEIV0
  7963     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  7964     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7965     MOVE X'2020233030303036393339' TO DFHEIV0(25:11)
  7966     CALL 'kxdfhei1' USING DFHEIV0,
  7967           MAP-NAME,
  7968           EL652AO,
  7969           DFHEIV12,
  7970           MAPSET-NAME,
  7971           DFHEIV99,
  7972           DFHEIV99,
  7973           DFHEIV99,
  7974           DFHEIV11,
  7975           DFHEIV99,
  7976           DFHEIV99,
  7977           DFHEIV99
  7978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7979
  7980
  7981     GO TO 9100-RETURN-TRAN.
  7982
  7983 8200-SEND-DATAONLY.
  7984
  7985     IF  NOT CREDIT-SESSION
  7986         MOVE AL-SADOF           TO PFK5A
  7987                                    PFK6A.
  7988
  7989     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  7990         MOVE AL-UANOF           TO  LSTMDTA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 162
* EL652.cbl
  7991         MOVE AL-SANOF           TO  PFK9A
  7992     ELSE
  7993         IF PI-AR-PROCESSING
  7994             MOVE AL-SANOF       TO  PFK9A
  7995         ELSE
  7996             MOVE AL-SANOF       TO  LSTMDTA
  7997             MOVE AL-SADOF       TO  PFK9A.
  7998     IF PI-ERC-TYPE = 'A'
  7999        MOVE AL-SANOF            TO PCONTA
  8000     END-IF
  8001
  8002     IF PI-COMPANY-ID = 'DCC'
  8003        IF TYPEI = 'A'
  8004           MOVE AL-SANOF         TO SPPDDHA
  8005           MOVE AL-UANON         TO SPPDDA
  8006        END-IF
  8007     END-IF
  8008*    IF (PI-ERC-TYPE NOT = 'G')
  8009*       OR (PI-COMPANY-ID NOT = 'DCC')
  8010     IF PI-ERC-TYPE NOT = 'B'
  8011         MOVE AL-SADOF           TO  PFK10A
  8012                                     PFK13A
  8013         MOVE AL-SADOF           TO  CSLABLA
  8014         MOVE AL-SADOF           TO  CLPSTA
  8015         MOVE AL-SADOF           TO  MFLABLA
  8016         MOVE AL-SADOF           TO  MAXFEEA
  8017         MOVE AL-SADOF           TO  LFLABLA
  8018         MOVE AL-SADOF           TO  MAXLFA
  8019     END-IF.
  8020
  8021     MOVE SAVE-DATE              TO  RUNDATEO.
  8022     MOVE EIBTIME                TO  TIME-IN.
  8023     MOVE TIME-OUT               TO  RUNTIMEO.
  8024     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  8025     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  8026     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  8027
  8028
  8029* EXEC CICS SEND
  8030*        MAP     (MAP-NAME)
  8031*        MAPSET  (MAPSET-NAME)
  8032*        FROM    (EL652AO)
  8033*        DATAONLY
  8034*        CURSOR
  8035*    END-EXEC.
  8036     MOVE LENGTH OF
  8037      EL652AO
  8038       TO DFHEIV12
  8039     MOVE -1
  8040       TO DFHEIV11
  8041*    MOVE '8$D    CT       H L F ,   #00006994' TO DFHEIV0
  8042     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  8043     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8044     MOVE X'2020233030303036393934' TO DFHEIV0(25:11)
  8045     CALL 'kxdfhei1' USING DFHEIV0,
  8046           MAP-NAME,
  8047           EL652AO,
  8048           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 163
* EL652.cbl
  8049           MAPSET-NAME,
  8050           DFHEIV99,
  8051           DFHEIV99,
  8052           DFHEIV99,
  8053           DFHEIV11,
  8054           DFHEIV99,
  8055           DFHEIV99,
  8056           DFHEIV99
  8057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8058
  8059
  8060     GO TO 9100-RETURN-TRAN.
  8061
  8062 8300-SEND-TEXT.
  8063
  8064* EXEC CICS SEND TEXT
  8065*        FROM    (LOGOFF-TEXT)
  8066*        LENGTH  (LOGOFF-LENGTH)
  8067*        ERASE
  8068*        FREEKB
  8069*    END-EXEC.
  8070*    MOVE '8&      T  E F  H   F -   #00007005' TO DFHEIV0
  8071     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8072     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8073     MOVE X'2020233030303037303035' TO DFHEIV0(25:11)
  8074     CALL 'kxdfhei1' USING DFHEIV0,
  8075           LOGOFF-TEXT,
  8076           LOGOFF-LENGTH,
  8077           DFHEIV99,
  8078           DFHEIV99,
  8079           DFHEIV99,
  8080           DFHEIV99,
  8081           DFHEIV99,
  8082           DFHEIV99,
  8083           DFHEIV99,
  8084           DFHEIV99,
  8085           DFHEIV99,
  8086           DFHEIV99
  8087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8088
  8089
  8090
  8091* EXEC CICS RETURN
  8092*    END-EXEC.
  8093*    MOVE '.(                    &   #00007012' TO DFHEIV0
  8094     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8095     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8096     MOVE X'2020233030303037303132' TO DFHEIV0(25:11)
  8097     CALL 'kxdfhei1' USING DFHEIV0,
  8098           DFHEIV99,
  8099           DFHEIV99,
  8100           DFHEIV99,
  8101           DFHEIV99,
  8102           DFHEIV99
  8103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8104
  8105
  8106 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 164
* EL652.cbl
  8107     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  8108     MOVE FILE-ID                TO  JP-FILE-ID.
  8109     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  8110
  8111*    EXEC CICS JOURNAL
  8112*        JFILEID  (PI-JOURNAL-FILE-ID)
  8113*        JTYPEID  ('EL')
  8114*        FROM     (JOURNAL-RECORD)
  8115*        LENGTH   (473)
  8116*    END-EXEC.
  8117
  8118 8800-UNAUTHORIZED-ACCESS.
  8119     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  8120
  8121     GO TO 8300-SEND-TEXT.
  8122
  8123 8810-PF23.
  8124     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  8125     MOVE XCTL-005               TO  PGM-NAME.
  8126
  8127     GO TO 9300-XCTL.
  8128
  8129 8880-NOT-FOUND.
  8130     MOVE ER-0142                TO  EMI-ERROR.
  8131     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8132
  8133     MOVE SPACE                  TO  PI-ERC-TYPE.
  8134     MOVE -1                     TO  MAINTYPL.
  8135
  8136     IF EIBTRNID NOT = TRANS-ID
  8137         GO TO 8100-SEND-INITIAL-MAP.
  8138
  8139     GO TO 8200-SEND-DATAONLY.
  8140
  8141 9100-RETURN-TRAN.
  8142     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  8143     MOVE '652A'                 TO  PI-CURRENT-SCREEN-NO.
  8144
  8145
  8146* EXEC CICS RETURN
  8147*        TRANSID   (TRANS-ID)
  8148*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8149*        LENGTH    (PI-COMM-LENGTH)
  8150*    END-EXEC.
  8151*    MOVE '.(CT                  &   #00007054' TO DFHEIV0
  8152     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8153     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8154     MOVE X'2020233030303037303534' TO DFHEIV0(25:11)
  8155     CALL 'kxdfhei1' USING DFHEIV0,
  8156           TRANS-ID,
  8157           PROGRAM-INTERFACE-BLOCK,
  8158           PI-COMM-LENGTH,
  8159           DFHEIV99,
  8160           DFHEIV99
  8161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8162
  8163
  8164 9200-RETURN-MAIN-MENU.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 165
* EL652.cbl
  8165
  8166     IF  MORTGAGE-SESSION
  8167         MOVE XCTL-EM626         TO PGM-NAME
  8168     ELSE
  8169         IF  CREDIT-SESSION
  8170             MOVE XCTL-626       TO PGM-NAME
  8171         ELSE
  8172             MOVE XCTL-126       TO PGM-NAME.
  8173
  8174     GO TO 9300-XCTL.
  8175
  8176 9300-XCTL.
  8177
  8178* EXEC CICS XCTL
  8179*        PROGRAM   (PGM-NAME)
  8180*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8181*        LENGTH    (PI-COMM-LENGTH)
  8182*    END-EXEC.
  8183*    MOVE '.$C                   $   #00007073' TO DFHEIV0
  8184     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8185     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8186     MOVE X'2020233030303037303733' TO DFHEIV0(25:11)
  8187     CALL 'kxdfhei1' USING DFHEIV0,
  8188           PGM-NAME,
  8189           PROGRAM-INTERFACE-BLOCK,
  8190           PI-COMM-LENGTH
  8191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8192
  8193
  8194 9400-CLEAR.
  8195     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  8196
  8197     GO TO 9300-XCTL.
  8198
  8199 9500-PF12.
  8200     MOVE XCTL-010               TO  PGM-NAME.
  8201
  8202     GO TO 9300-XCTL.
  8203
  8204 9600-PGMID-ERROR.
  8205
  8206* EXEC CICS HANDLE CONDITION
  8207*        PGMIDERR  (8300-SEND-TEXT)
  8208*    END-EXEC.
  8209*    MOVE '"$L                   ! 7 #00007090' TO DFHEIV0
  8210     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8211     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8212     MOVE X'3720233030303037303930' TO DFHEIV0(25:11)
  8213     CALL 'kxdfhei1' USING DFHEIV0
  8214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8215
  8216
  8217     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  8218     MOVE ' '                    TO  PI-ENTRY-CD-1.
  8219     MOVE XCTL-005               TO  PGM-NAME.
  8220     MOVE PGM-NAME               TO  LOGOFF-PGM.
  8221     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  8222
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 166
* EL652.cbl
  8223     GO TO 9300-XCTL.
  8224
  8225 9700-LINK-DATE-CONVERT.
  8226
  8227* EXEC CICS LINK
  8228*        PROGRAM   ('ELDATCV')
  8229*        COMMAREA  (DATE-CONVERSION-DATA)
  8230*        LENGTH    (DC-COMM-LENGTH)
  8231*    END-EXEC.
  8232     MOVE 'ELDATCV' TO DFHEIV1
  8233*    MOVE '."C                   ''   #00007103' TO DFHEIV0
  8234     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8235     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8236     MOVE X'2020233030303037313033' TO DFHEIV0(25:11)
  8237     CALL 'kxdfhei1' USING DFHEIV0,
  8238           DFHEIV1,
  8239           DATE-CONVERSION-DATA,
  8240           DC-COMM-LENGTH,
  8241           DFHEIV99,
  8242           DFHEIV99,
  8243           DFHEIV99
  8244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8245
  8246
  8247 9700-EXIT.
  8248     EXIT.
  8249
  8250 9900-ERROR-FORMAT.
  8251     IF NOT EMI-ERRORS-COMPLETE
  8252         MOVE LINK-001           TO  PGM-NAME
  8253
  8254* EXEC CICS LINK
  8255*            PROGRAM   (PGM-NAME)
  8256*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  8257*            LENGTH    (EMI-COMM-LENGTH)
  8258*        END-EXEC.
  8259*    MOVE '."C                   ''   #00007115' TO DFHEIV0
  8260     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8261     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8262     MOVE X'2020233030303037313135' TO DFHEIV0(25:11)
  8263     CALL 'kxdfhei1' USING DFHEIV0,
  8264           PGM-NAME,
  8265           ERROR-MESSAGE-INTERFACE-BLOCK,
  8266           EMI-COMM-LENGTH,
  8267           DFHEIV99,
  8268           DFHEIV99,
  8269           DFHEIV99
  8270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8271
  8272
  8273 9900-EXIT.
  8274     EXIT.
  8275
  8276 9910-INITIALIZE-SECURITY.
  8277******************************************************************
  8278*                                                                *
  8279*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  8280*       USER SECURITY RECORD SET UP BY EL125.  THIS PROGRAM      *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 167
* EL652.cbl
  8281*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  8282*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  8283*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  8284*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  8285*                                                                *
  8286******************************************************************
  8287
  8288     IF  PI-PROCESSOR-ID NOT = 'LGXX'
  8289
  8290         IF  MORTGAGE-SESSION
  8291             MOVE '125E'             TO SC-QUID-SYSTEM
  8292             MOVE EIBTRMID           TO SC-QUID-TERMINAL
  8293
  8294
  8295* EXEC CICS READQ TS
  8296*                QUEUE  (SC-QUID-KEY)
  8297*                INTO   (SECURITY-CONTROL-E)
  8298*                LENGTH (SC-COMM-LENGTH-E)
  8299*                ITEM   (SC-ITEM)
  8300*            END-EXEC
  8301*    MOVE '*$II   L              ''   #00007142' TO DFHEIV0
  8302     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8303     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8304     MOVE X'2020233030303037313432' TO DFHEIV0(25:11)
  8305     CALL 'kxdfhei1' USING DFHEIV0,
  8306           SC-QUID-KEY,
  8307           SECURITY-CONTROL-E,
  8308           SC-COMM-LENGTH-E,
  8309           SC-ITEM,
  8310           DFHEIV99,
  8311           DFHEIV99
  8312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8313
  8314             MOVE SC-MP-DISPLAY (W-APPL-SCRTY-NDX)
  8315                                     TO PI-DISPLAY-CAP
  8316             MOVE SC-MP-UPDATE (W-APPL-SCRTY-NDX)
  8317                                     TO PI-MODIFY-CAP
  8318
  8319             IF  NOT DISPLAY-CAP
  8320                 MOVE 'READ'         TO SM-READ
  8321                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8322                 MOVE ER-9097        TO EMI-ERROR
  8323                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8324                 GO TO 8100-SEND-INITIAL-MAP
  8325             ELSE
  8326                 GO TO 9910-EXIT
  8327         ELSE
  8328
  8329* EXEC CICS  READQ TS
  8330*                QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8331*                INTO    (SECURITY-CONTROL)
  8332*                LENGTH  (SC-COMM-LENGTH)
  8333*                ITEM    (SC-ITEM-CL-CR)
  8334*                END-EXEC
  8335*    MOVE '*$II   L              ''   #00007163' TO DFHEIV0
  8336     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8337     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8338     MOVE X'2020233030303037313633' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 168
* EL652.cbl
  8339     CALL 'kxdfhei1' USING DFHEIV0,
  8340           PI-SECURITY-TEMP-STORE-ID,
  8341           SECURITY-CONTROL,
  8342           SC-COMM-LENGTH,
  8343           SC-ITEM-CL-CR,
  8344           DFHEIV99,
  8345           DFHEIV99
  8346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8347
  8348             MOVE SC-CREDIT-DISPLAY (05)
  8349                                 TO PI-DISPLAY-CAP
  8350             MOVE SC-CREDIT-UPDATE  (05)
  8351                                 TO PI-MODIFY-CAP
  8352
  8353             IF  NOT DISPLAY-CAP
  8354                 MOVE 'READ'     TO SM-READ
  8355                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8356                 MOVE ER-0070    TO  EMI-ERROR
  8357                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8358                 GO TO 8100-SEND-INITIAL-MAP.
  8359
  8360 9910-EXIT.
  8361     EXIT.
  8362
  8363 9990-ABEND.
  8364     MOVE LINK-004               TO  PGM-NAME.
  8365     MOVE DFHEIBLK               TO  EMI-LINE1.
  8366
  8367
  8368* EXEC CICS LINK
  8369*        PROGRAM   (PGM-NAME)
  8370*        COMMAREA  (EMI-LINE1)
  8371*        LENGTH    (72)
  8372*    END-EXEC.
  8373     MOVE 72
  8374       TO DFHEIV11
  8375*    MOVE '."C                   ''   #00007189' TO DFHEIV0
  8376     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8377     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8378     MOVE X'2020233030303037313839' TO DFHEIV0(25:11)
  8379     CALL 'kxdfhei1' USING DFHEIV0,
  8380           PGM-NAME,
  8381           EMI-LINE1,
  8382           DFHEIV11,
  8383           DFHEIV99,
  8384           DFHEIV99,
  8385           DFHEIV99
  8386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8387
  8388
  8389     GO TO 8200-SEND-DATAONLY.
  8390
  8391 9995-SECURITY-VIOLATION.
  8392*           COPY ELCSCTP.
  8393******************************************************************
  8394*                                                                *
  8395*                            ELCSCTP                             *
  8396*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 169
* EL652.cbl
  8397*                                                                *
  8398*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8399******************************************************************
  8400
  8401
  8402     MOVE EIBDATE          TO SM-JUL-DATE.
  8403     MOVE EIBTRMID         TO SM-TERMID.
  8404     MOVE THIS-PGM         TO SM-PGM.
  8405     MOVE EIBTIME          TO TIME-IN.
  8406     MOVE TIME-OUT         TO SM-TIME.
  8407     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8408
  8409
  8410* EXEC CICS LINK
  8411*         PROGRAM  ('EL003')
  8412*         COMMAREA (SECURITY-MESSAGE)
  8413*         LENGTH   (80)
  8414*    END-EXEC.
  8415     MOVE 'EL003' TO DFHEIV1
  8416     MOVE 80
  8417       TO DFHEIV11
  8418*    MOVE '."C                   ''   #00007215' TO DFHEIV0
  8419     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8420     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8421     MOVE X'2020233030303037323135' TO DFHEIV0(25:11)
  8422     CALL 'kxdfhei1' USING DFHEIV0,
  8423           DFHEIV1,
  8424           SECURITY-MESSAGE,
  8425           DFHEIV11,
  8426           DFHEIV99,
  8427           DFHEIV99,
  8428           DFHEIV99
  8429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8430
  8431
  8432******************************************************************
  8433
  8434 9995-EXIT.
  8435      EXIT.
  8436
  8437 9999-DFHBACK SECTION.
  8438     MOVE '9%                    "   ' TO DFHEIV0
  8439     MOVE 'EL652' TO DFHEIV1
  8440     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8441     GOBACK.
  8442 9999-DFHEXIT.
  8443     IF DFHEIGDJ EQUAL 0001
  8444         NEXT SENTENCE
  8445     ELSE IF DFHEIGDJ EQUAL 2
  8446         GO TO 9990-ABEND,
  8447               8880-NOT-FOUND,
  8448               9600-PGMID-ERROR,
  8449               9990-ABEND
  8450         DEPENDING ON DFHEIGDI
  8451     ELSE IF DFHEIGDJ EQUAL 3
  8452         GO TO 3400-EXIT
  8453         DEPENDING ON DFHEIGDI
  8454     ELSE IF DFHEIGDJ EQUAL 4
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 170
* EL652.cbl
  8455         GO TO 3450-EXIT
  8456         DEPENDING ON DFHEIGDI
  8457     ELSE IF DFHEIGDJ EQUAL 5
  8458         GO TO 9990-ABEND,
  8459               8880-NOT-FOUND,
  8460               9600-PGMID-ERROR,
  8461               9990-ABEND
  8462         DEPENDING ON DFHEIGDI
  8463     ELSE IF DFHEIGDJ EQUAL 6
  8464         GO TO 3475-EXIT
  8465         DEPENDING ON DFHEIGDI
  8466     ELSE IF DFHEIGDJ EQUAL 7
  8467         GO TO 9990-ABEND,
  8468               4250-CONT
  8469         DEPENDING ON DFHEIGDI
  8470     ELSE IF DFHEIGDJ EQUAL 8
  8471         GO TO 4300-EXIT
  8472         DEPENDING ON DFHEIGDI
  8473     ELSE IF DFHEIGDJ EQUAL 9
  8474         GO TO 4750-NO-STATE
  8475         DEPENDING ON DFHEIGDI
  8476     ELSE IF DFHEIGDJ EQUAL 10
  8477         GO TO 6550-END-BROWSE,
  8478               6550-END-BROWSE
  8479         DEPENDING ON DFHEIGDI
  8480     ELSE IF DFHEIGDJ EQUAL 11
  8481         GO TO 6550-END-BROWSE,
  8482               6550-END-BROWSE
  8483         DEPENDING ON DFHEIGDI
  8484     ELSE IF DFHEIGDJ EQUAL 12
  8485         GO TO 6599-EXIT,
  8486               6599-EXIT
  8487         DEPENDING ON DFHEIGDI
  8488     ELSE IF DFHEIGDJ EQUAL 13
  8489         GO TO 7250-ENDFILE,
  8490               7250-ENDFILE,
  8491               9990-ABEND
  8492         DEPENDING ON DFHEIGDI
  8493     ELSE IF DFHEIGDJ EQUAL 14
  8494         GO TO 7250-ENDFILE,
  8495               7275-NOTFOUND
  8496         DEPENDING ON DFHEIGDI
  8497     ELSE IF DFHEIGDJ EQUAL 15
  8498         GO TO 7375-ENDFILE,
  8499               7375-ENDFILE,
  8500               9990-ABEND
  8501         DEPENDING ON DFHEIGDI
  8502     ELSE IF DFHEIGDJ EQUAL 16
  8503         GO TO 7375-ENDFILE,
  8504               7275-NOTFOUND
  8505         DEPENDING ON DFHEIGDI
  8506     ELSE IF DFHEIGDJ EQUAL 17
  8507         GO TO 7490-NOT-FOUND,
  8508               9990-ABEND
  8509         DEPENDING ON DFHEIGDI
  8510     ELSE IF DFHEIGDJ EQUAL 18
  8511         GO TO 7550-DUP
  8512         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 171
* EL652.cbl
  8513     ELSE IF DFHEIGDJ EQUAL 19
  8514         GO TO 7540-WRITE
  8515         DEPENDING ON DFHEIGDI
  8516     ELSE IF DFHEIGDJ EQUAL 20
  8517         GO TO 7699-EXIT
  8518         DEPENDING ON DFHEIGDI
  8519     ELSE IF DFHEIGDJ EQUAL 21
  8520         GO TO 7630-DELETE
  8521         DEPENDING ON DFHEIGDI
  8522     ELSE IF DFHEIGDJ EQUAL 22
  8523         GO TO 8000-EXIT
  8524         DEPENDING ON DFHEIGDI
  8525     ELSE IF DFHEIGDJ EQUAL 23
  8526         GO TO 8300-SEND-TEXT
  8527         DEPENDING ON DFHEIGDI.
  8528     MOVE '9%                    "   ' TO DFHEIV0
  8529     MOVE 'EL652' TO DFHEIV1
  8530     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8531     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        6260     Code:       26387
