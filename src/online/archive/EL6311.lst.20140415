* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73******************************************************************
    74
    75 ENVIRONMENT DIVISION.
    76
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page   4
* EL6311.cbl
    78 DATA DIVISION.
    79 WORKING-STORAGE SECTION.
    80 01  DFH-START PIC X(04).
    81 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    82 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    83 77  FILLER  PIC X(32)  VALUE '********************************'.
    84 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    85 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    86 77  A1                          PIC S999 COMP-3 VALUE +0.
    87 77  N1                          PIC S999 COMP-3 VALUE +0.
    88 77  N2                          PIC S999 COMP-3 VALUE +0.
    89 77  N3                          PIC S999 COMP-3 VALUE +0.
    90 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    91 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    92 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    93     88  REVERSAL                    VALUE 'Y'.
    94 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    95 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    96 77  WS-END                      PIC S999 COMP-3 VALUE +0.
    97 77  WS-TALLY                    PIC 99  VALUE ZEROS.
    98 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
    99     88  ERMAIL-FOUND                 VALUE 'Y'.
   100 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   101 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   102 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   103 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   104     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   105 77  ws-stop-sw                  pic x value ' '.
   106     88  i-say-stop                 value 'Y'.
   107 77  ws-check-sw                 pic x value ' '.
   108     88  i-have-checks              value 'Y'.
   109 77  ws-proc-check-sw            pic x value ' '.
   110     88  i-have-processed-checks    value 'Y'.
   111 77  ws-chek-browse-sw           pic x value ' '.
   112 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   113 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   114 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   115 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   116
   117*    COPY ELCSCTM.
   118******************************************************************
   119*                                                                *
   120*                                                                *
   121*                            ELCSCTM                             *
   122*                            VMOD=2.001                          *
   123*                                                                *
   124*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   125*                                                                *
   126******************************************************************
   127 01  SECURITY-MESSAGE.
   128     12  FILLER                          PIC X(30)
   129            VALUE '** LOGIC SECURITY VIOLATION -'.
   130     12  SM-READ                         PIC X(6).
   131     12  FILLER                          PIC X(5)
   132            VALUE ' PGM='.
   133     12  SM-PGM                          PIC X(6).
   134     12  FILLER                          PIC X(5)
   135            VALUE ' OPR='.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page   5
* EL6311.cbl
   136     12  SM-PROCESSOR-ID                 PIC X(4).
   137     12  FILLER                          PIC X(6)
   138            VALUE ' TERM='.
   139     12  SM-TERMID                       PIC X(4).
   140     12  FILLER                          PIC XX   VALUE SPACE.
   141     12  SM-JUL-DATE                     PIC 9(5).
   142     12  FILLER                          PIC X    VALUE SPACE.
   143     12  SM-TIME                         PIC 99.99.
   144
   145
   146*    COPY ELCSCRTY.
   147******************************************************************
   148*                                                                *
   149*                                                                *
   150*                            ELCSCRTY                            *
   151*                            VMOD=2.001                          *
   152*                                                                *
   153*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   154*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   155*        SAVED IN PI-SECURITY-ADDRESS.                           *
   156*                                                                *
   157******************************************************************
   158 01  SECURITY-CONTROL.
   159     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   160     12  FILLER                       PIC XX    VALUE 'SC'.
   161     12  SC-CREDIT-CODES.
   162         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   163             20  SC-CREDIT-DISPLAY    PIC X.
   164             20  SC-CREDIT-UPDATE     PIC X.
   165     12  SC-CLAIMS-CODES.
   166         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   167             20  SC-CLAIMS-DISPLAY    PIC X.
   168             20  SC-CLAIMS-UPDATE     PIC X.
   169
   170 01  WS-VA-NO-COMM-MESS.
   171     12  FILLER                  PIC X(41) VALUE
   172        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   173 01  WS-OC-MESSAGE.
   174     12  FILLER                  PIC X(43) VALUE
   175        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   176     12  WS-OC-DIS-AMT           PIC -----9.99.
   177     12  FILLER                  PIC X(4) VALUE ' ON '.
   178     12  WS-OC-DATE              PIC X(10).
   179 01  WS-DATE-AREA.
   180     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   181     12  WS-CURRENT-DT.
   182         16  FILLER              PIC X(6)    VALUE SPACES.
   183         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   184     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   185     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   186     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   187
   188 01  STANDARD-AREAS.
   189     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   190     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   191     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   192     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   193     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page   6
* EL6311.cbl
   194     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   195     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   196     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   197     12  PGM-NAME                PIC X(8).
   198     12  TIME-IN                 PIC S9(7).
   199     12  TIME-OUT-R  REDEFINES TIME-IN.
   200         16  FILLER              PIC X.
   201         16  TIME-OUT            PIC 99V99.
   202         16  FILLER              PIC XX.
   203     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   204     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   205     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   206     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   207     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   208     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   209     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   210     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   211     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   212     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   213     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   214     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   215     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   216     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   217     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   218     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   219     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   220     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   221     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   222     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   223     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   224     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   225     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   226     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   227     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   228     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   229     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   230     12  FILE-ID                 PIC X(8).
   231     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   232     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   233     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   234     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   235     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   236     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   237     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   238     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   239     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   240     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   241     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   242     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   243     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   244     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   245     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   246
   247 01  WS-PASS-AREA.
   248     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   249     05  WS-PASS-VADS-REC    PIC X(350).
   250*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   251*                                COPY ELCZREC.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page   7
* EL6311.cbl
   252******************************************************************
   253*                                                                *
   254*                                                                *
   255*                            ELCZREC.                            *
   256*                                                                *
   257*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   258*                                                                *
   259******************************************************************
   260*-----------------------------------------------------------------
   261*                   C H A N G E   L O G
   262*
   263* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   264*-----------------------------------------------------------------
   265*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   266* EFFECTIVE    NUMBER
   267*-----------------------------------------------------------------
   268* 122011    2011022800001  AJRA  NEW FILE
   269* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   270* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   271* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   272* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   273*-----------------------------------------------------------------
   274 01  W-Z-CONTROL-DATA.
   275     05  W-NUMBER-OF-COPIES      PIC  9.
   276     05  FILLER                  PIC  X.
   277     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   278     05  FILLER                  PIC  X.
   279     05  W-DAYS-TO-RESEND        PIC  999.
   280     05  FILLER                  PIC  X.
   281     05  W-FORM-TO-RESEND        PIC  X(4).
   282     05  W-ADD-BAR-CODE          PIC  X.
   283     05  W-PROMPT-LETTER         PIC  X.
   284     05  W-HAS-RETURN-ENV        PIC  X.
   285     05  W-ENCLOSURE-CD          PIC  XXX.
   286     05  W-SIG-FLAG-DEFAULT      PIC  X.
   287     05  W-AUTO-CLOSE-IND        PIC  X.
   288     05  FILLER                  PIC  X.
   289     05  W-LETTER-TO-BENE        PIC  X.
   290     05  FILLER                  PIC  X.
   291     05  W-LETTER-TO-ACCT        PIC  X.
   292     05  FILLER                  PIC  X.
   293     05  W-LETTER-TYPE           PIC  X.
   294     05  FILLER                  PIC  X.
   295     05  W-PRINT-CERTIFICATE     PIC  X.
   296     05  FILLER                  PIC  X.
   297     05  W-REFUND-REQUIRED       PIC  X.
   298     05  FILLER                  PIC  X.
   299     05  W-ONBASE-CODE           PIC  XX.
   300     05  FILLER                  PIC  X.
   301     05  W-ACCT-SUMM             PIC  X.
   302     05  FILLER                  PIC  X.
   303     05  W-CSO-SUMM              PIC  X.
   304     05  FILLER                  PIC  X.
   305     05  W-REASONS-REQUIRED      PIC  X.
   306     05  FILLER                  PIC  X(29).
   307******************************************************************
   308*                                                                *
   309*              A C C E S S   K E Y S                             *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page   8
* EL6311.cbl
   310*                                                                *
   311******************************************************************
   312
   313 01  ACCESS-KEYS.
   314     12  ERPYAJ-KEY.
   315         16  ERPYAJ-COMPANY-CD       PIC X.
   316         16  ERPYAJ-CARRIER          PIC X.
   317         16  ERPYAJ-GROUPING         PIC X(6).
   318         16  ERPYAJ-FIN-RESP         PIC X(10).
   319         16  ERPYAJ-ACCOUNT          PIC X(10).
   320         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   321         16  ERPYAJ-TYPE             PIC X.
   322     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   323     12  ELCERT-KEY.
   324         16  ELCERT-COMPANY-CD       PIC X.
   325         16  ELCERT-CARRIER          PIC X.
   326         16  ELCERT-GROUPING         PIC X(6).
   327         16  ELCERT-STATE            PIC XX.
   328         16  ELCERT-ACCOUNT          PIC X(10).
   329         16  ELCERT-CERT-EFF-DT      PIC XX.
   330         16  ELCERT-CERT-NO.
   331             20  ELCERT-CERT-PRIME   PIC X(10).
   332             20  ELCERT-CERT-SFX     PIC X.
   333
   334     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   335     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   336     12  ELCRTO-KEY.
   337         16  ELCRTO-COMPANY-CD       PIC X.
   338         16  ELCRTO-CARRIER          PIC X.
   339         16  ELCRTO-GROUPING         PIC X(6).
   340         16  ELCRTO-STATE            PIC XX.
   341         16  ELCRTO-ACCOUNT          PIC X(10).
   342         16  ELCRTO-CERT-EFF-DT      PIC XX.
   343         16  ELCRTO-CERT-NO.
   344             20  ELCRTO-CERT-PRIME   PIC X(10).
   345             20  ELCRTO-CERT-SFX     PIC X.
   346         16  ELCRTO-RECORD-TYPE      PIC X.
   347         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   348
   349     12  ELCRTT-KEY.
   350         16  ELCRTT-PRIMARY          PIC X(33).
   351         16  ELCRTT-REC-TYPE         PIC X(1).
   352     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   353     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   354
   355     12  ERPNDB-KEY.
   356         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   357         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   358         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   359         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   360             ERPNDB-BATCH-SEQ-NO     PIC XX.
   361         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   362
   363     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   364     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   365     12  ERCHEK-KEY.
   366         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   367         16  CHEK-CARRIER            PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page   9
* EL6311.cbl
   368         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   369         16  CHEK-STATE              PIC XX      VALUE SPACES.
   370         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   371         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   372         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   373         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   374         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   375     12  ELLETR-KEY.
   376         16  LETR-COMPANY-CD     PIC X.
   377         16  LETR-LETTER-ID      PIC X(4).
   378         16  LETR-FILLER         PIC X(8).
   379         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   380     12  ERPNDM-KEY.
   381         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   382         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   383         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   384         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   385
   386*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   387     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   388*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   389     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   390
   391     12  ERPNDB-ALT-KEY.
   392         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   393         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   394         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   395         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   396         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   397         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   398         16  ERPNDB-CERT-NO.
   399             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   400             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   401         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   402         16  ERPNDB-RECORD-TYPE      PIC X.
   403
   404      12  ERPNDB-CSR-KEY.
   405          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   406          20  ERPNDB-CSR-ID                PIC X(4).
   407          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   408          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   409          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   410
   411     12  ERNOTE-KEY.
   412         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   413         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   414         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   415         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   416         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   417         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   418         16  ERNOTE-CERT-NO.
   419             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   420             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   421
   422     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   423     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   424
   425     12  ERCNOT-KEY.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  10
* EL6311.cbl
   426         16  ERCNOT-PART-KEY.
   427             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   428             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   429             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   430             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   431             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   432             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   433             20  ERCNOT-CERT-NO.
   434                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   435                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   436         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   437         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   438
   439     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   440     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   441
   442     12  ERMAIL-KEY.
   443         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   444         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   445         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   446         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   447         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   448         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   449         16  ERMAIL-CERT-NO.
   450             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   451             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   452
   453     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   454     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   455
   456     12  ERRQST-KEY.
   457         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   458         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   459
   460     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   461     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   462
   463     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   464
   465     12  ERLOFC-KEY.
   466         16  ERLOFC-COMPANY-CD          PIC  X.
   467         16  ERLOFC-CARRIER             PIC  X.
   468         16  ERLOFC-GROUPING            PIC  X(6).
   469         16  ERLOFC-STATE               PIC  XX.
   470         16  ERLOFC-ACCOUNT             PIC  X(10).
   471         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   472*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   473
   474     12  ERACCT-KEY.
   475         16  ERACCT-COMPANY-CD          PIC  X.
   476         16  ERACCT-CARRIER             PIC  X.
   477         16  ERACCT-GROUPING            PIC  X(6).
   478         16  ERACCT-STATE               PIC  XX.
   479         16  ERACCT-ACCOUNT             PIC  X(10).
   480         16  ERACCT-EXP-DT.
   481             20  ERACCT-DT              PIC  XX.
   482             20  ERACCT-FILL            PIC  X(4).
   483
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  11
* EL6311.cbl
   484     12  ERENDT-KEY.
   485         16  ENDT-COMPANY-CD       PIC X.
   486         16  ENDT-CARRIER          PIC X.
   487         16  ENDT-GROUPING         PIC X(6).
   488         16  ENDT-STATE            PIC XX.
   489         16  ENDT-ACCOUNT          PIC X(10).
   490         16  ENDT-CERT-EFF-DT      PIC XX.
   491         16  ENDT-CERT-PRIME       PIC X(10).
   492         16  ENDT-CERT-SFX         PIC X.
   493         16  ENDT-RECORD-TYPE      PIC X.
   494         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   495
   496 01  WS-ELMSTR-WORK.
   497     12  ELMSTR-KEY.
   498         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   499         16  MSTR-CERT-NO.
   500             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   501             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   502     12  W-CLAIM-KEY.
   503         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   504         16  W-CL-CERT-NO.
   505             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   506             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   507      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   508 01  CANCEL-GEN-PASS-AREA.
   509     05  CG-OPTION-CODE          PIC X.
   510         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   511         88  CG-FLAT-CANCEL        VALUE '1'.
   512         88  CG-CANCEL             VALUE '2'.
   513         88  CG-CANCEL-REISSUE     VALUE '3'.
   514     05  CG-ERROR-CODE           PIC 99.
   515         88  CG-SUCCESS            VALUE 00.
   516         88  CG-DATE-ERROR         VALUE 01.
   517         88  CG-CERT-NOT-FOUND     VALUE 02.
   518         88  CG-AMOUNT-ERROR       VALUE 04.
   519         88  CG-OPTION-ERROR       VALUE 05.
   520         88  CG-PREV-CAN           VALUE 06.
   521         88  CG-INVALID-DATA       VALUE 07.
   522         88  CG-NO-ACCT-MSTR       VALUE 08.
   523         88  CG-SFX-A-EXIST        VALUE 09.
   524         88  CG-MISC-ERROR         VALUE 99.
   525     05  CG-COMPANY-ID           PIC XXX.
   526     05  CG-PROC-ID              PIC XXXX.
   527     05  CG-CURRENT-DT           PIC XX.
   528     05  CG-MONTH-END-DT         PIC XX.
   529     05  CG-CERT-KEY.
   530         10  CG-CERT-COMPANY-CD  PIC X.
   531         10  CG-CERT-CARRIER     PIC X.
   532         10  CG-CERT-GROUP       PIC X(6).
   533         10  CG-CERT-STATE       PIC XX.
   534         10  CG-CERT-ACCOUNT     PIC X(10).
   535         10  CG-CERT-EFF-DT      PIC XX.
   536         10  CG-CERT-CERT-NO     PIC X(11).
   537     05  CG-LF-CAN-DATA.
   538         10  CG-LF-CAN-DT        PIC XX.
   539         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   540     05  CG-AH-CAN-DATA.
   541         10  CG-AH-CAN-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  12
* EL6311.cbl
   542         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   543     05  CG-CERT-PROFILE-DATA.
   544         10  CG-INS-LNAME        PIC X(15).
   545         10  CG-INS-FNAME        PIC X(10).
   546         10  CG-INS-MID-INIT     PIC X.
   547         10  CG-INS-AGE          PIC 99.
   548         10  CG-JNT-LNAME        PIC X(15).
   549         10  CG-JNT-FNAME        PIC X(10).
   550         10  CG-JNT-MID-INIT     PIC X.
   551         10  CG-JNT-AGE          PIC 99.
   552     05  CG-LF-ISS-DATA.
   553         10  CG-LF-BENCD         PIC XX.
   554         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   555         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   556     05  CG-AH-ISS-DATA.
   557         10  CG-AH-BENCD         PIC XX.
   558         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   559     05  CG-BATCH-NO             PIC X(6).
   560     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   561     05  FILLER                  PIC X(306).
   562******************************************************************
   563*                                                                *
   564*            G E N E R A L   W O R K   A R E A                   *
   565*                                                                *
   566******************************************************************
   567
   568 01  WORK-AREA.
   569     12  WS-RESPONSE             PIC S9(8)   COMP.
   570         88  RESP-NORMAL           VALUE +0.
   571         88  resp-file-notfnd      value +12.
   572         88  RESP-NOTFND           VALUE +13.
   573         88  resp-duprec           value +14.
   574         88  resp-dupkey           value +15.
   575         88  resp-invreq           value +16.
   576         88  RESP-NOTOPEN          VALUE +19.
   577         88  RESP-ENDFILE          VALUE +20.
   578         88  resp-lengtherr        value +22.
   579     12  DEEDIT-FIELD            PIC X(15).
   580     12  FILLER          REDEFINES DEEDIT-FIELD.
   581         16  FILLER              PIC X(4).
   582         16  DEEDIT-FIELD-X11    PIC X(11).
   583     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   584                                 PIC S9(15).
   585     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   586                                 PIC S9(13)V99.
   587     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   588                                 PIC S9(11)V9999.
   589     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   590     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   591     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   592         16  WS-CALC-TERM-WHOLE  PIC S999.
   593         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   594
   595     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   596     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   597         16  WS-HR-MINS          PIC 99V99.
   598         16  FILLER              PIC XX.
   599
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  13
* EL6311.cbl
   600     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   601     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   602
   603     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   604     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   605
   606     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   607     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   608     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   609     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   610     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   611     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   612     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   613
   614     12  QID.
   615         16  QID-TERM            PIC X(4).
   616         16  FILLER              PIC X(4)    VALUE '607B'.
   617
   618     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   619         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   620
   621     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   622         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   623
   624     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   625         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   626                                         'A'.
   627
   628     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   629
   630     12  WS-NUMERIC-SW           PIC X.
   631        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   632
   633     12  WS-EDIT-CSO-FIELD.
   634         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   635                                 PIC X.
   636
   637     12  WS-SAVE-INPUT-FIELDS.
   638         16  WS-BAGE             PIC 99       VALUE ZERO.
   639*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   640         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   641         16  FILLER REDEFINES WS-BAPR.
   642             20  WS-APR-WHOLE-NUM    PIC 99.
   643             20  WS-APR-DEC          PIC 9999.
   644         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   645         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   646
   647         16  WS-B-COVERAGE OCCURS 2 TIMES.
   648             20  WS-TERM-IN-DAYS-SW  PIC X.
   649                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   650             20  WS-BTERM        PIC 999       COMP-3.
   651             20  WS-BALT-TERM    PIC 999       COMP-3.
   652             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   653             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   654             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   655             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   656             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   657             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  14
* EL6311.cbl
   658
   659         16  WS-C-FIELDS COMP-3.
   660             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   661             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   662             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   663
   664         16  WS-D-FIELDS COMP-3.
   665             20  WS-DRISS        PIC S9(5)    VALUE +0.
   666             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   667             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   668             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   669             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   670             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   671
   672     12  WS-SAVE-BIRTH-DATE.
   673         16  FILLER              PIC X(4)   VALUE SPACES.
   674         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   675
   676     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   677     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   678     12  FILLER REDEFINES WS-WORK-BIN-RED.
   679         16  FILLER              PIC X(02).
   680         16  WS-WORK-BIN-DT      PIC X(02).
   681     12  WS-SW-1                 PIC X     VALUE SPACE.
   682     12  WS-SW-2                 PIC X     VALUE SPACE.
   683     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   684         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   685     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   686         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   687
   688     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   689     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   690     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   691     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   692     12  WS-CONVERTED-CANCEL-DATES.
   693         16  WS-CONVERTED-CANDT1                  PIC XX.
   694         16  WS-CONVERTED-CANDT2                  PIC XX.
   695
   696     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   697
   698     12  WS-REC-FOUND-SW         PIC X.
   699         88  RECORD-NOT-FOUND    VALUE 'N'.
   700
   701     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   702         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   703         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   704
   705     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   706         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   707         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   708
   709     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   710         88  BROWSE-STARTED      VALUE 'Y'.
   711
   712     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   713         88  FIRST-TIME          VALUE 'Y'.
   714
   715     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  15
* EL6311.cbl
   716         88  FIRST-ENTRY         VALUE 'Y'.
   717
   718     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   719         88  REC-BILLED          VALUE 'Y'.
   720
   721     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   722         88  NO-CURSOR-SET       VALUE +0.
   723         88  CURSOR-SET          VALUE +1.
   724
   725     12  WS-ERR-SW               PIC X.
   726         88  STD-ERRORS          VALUE 'S'.
   727         88  TRN-ERRORS          VALUE 'T'.
   728
   729     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   730         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   731
   732     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   733         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   734
   735     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   736         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   737
   738     12  WS-ERR-CODE.
   739         16  FILLER              PIC 99.
   740         16  WS-ERROR-SUB        PIC 99.
   741
   742     12  WS-DATE-WORK.
   743         16  WS-WORK-MM          PIC XX.
   744         16  WS-WORK-DD          PIC XX.
   745         16  WS-WORK-YY          PIC XX.
   746
   747     12  WS-MM-YY.
   748         16  WS-MM               PIC XX.
   749         16  FILLER              PIC X     VALUE '/'.
   750         16  WS-YY               PIC XX.
   751
   752     12  WS-CERT-EFF-DT          PIC XX.
   753
   754     12  WS-MEMBER-NO            PIC X(12).
   755     12  FILLER  REDEFINES  WS-MEMBER-NO.
   756         16  WS-MEMBER-NO-1-8    PIC 9(8).
   757         16  FILLER              PIC X(4).
   758
   759     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   760
   761     12  WS-ERPNDB-ALT-KEY.
   762         16  WS-PB-COMPANY-CD-A1         PIC X.
   763         16  WS-PB-CARRIER               PIC X.
   764         16  WS-PB-GROUPING              PIC X(6).
   765         16  WS-PB-STATE                 PIC XX.
   766         16  WS-PB-ACCOUNT               PIC X(10).
   767         16  WS-PB-CERT-EFF-DT           PIC XX.
   768         16  WS-PB-CERT-NO.
   769             20  WS-PB-CERT-PRIME        PIC X(10).
   770             20  WS-PB-CERT-SFX          PIC X.
   771         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   772         16  WS-PB-RECORD-TYPE           PIC X.
   773
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  16
* EL6311.cbl
   774     12  WS-SHOW-SAVE-AREAS.
   775         16  WS-NEW-CERT-NO.
   776             20  WS-NEW-PRIME    PIC X(10).
   777             20  WS-NEW-SUFFIX   PIC X.
   778         16  WS-NEW-CERT-EFF-DT  PIC XX.
   779         16  WS-NEW-RECORD-TYPE  PIC X.
   780         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   781             88   SHOW-RECORD            VALUE 'Y'.
   782
   783     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   784
   785     12  WS-BATCH-NO.
   786         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   787         16  FILLER              PIC X(5) VALUE SPACES.
   788
   789     12  WS-FIRST-NAME.
   790         16  WS-1ST-INIT         PIC X.
   791         16  FILLER              PIC X(9).
   792
   793     12  WS-INITIALS.
   794         16  WS-INITIAL-1        PIC X.
   795         16  WS-INITIAL-2        PIC X.
   796
   797     12  WS-C-HDG.
   798         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   799         16  FILLER              PIC X(4) VALUE '-REF'.
   800
   801     12  WS-D-PREM-HDG.
   802         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   803         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   804
   805     12  WS-D-REFUND-HDG.
   806         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   807         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   808
   809     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   810
   811     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   812     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   813     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   814     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   815     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   816     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   817     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   818
   819     12  WS-01-CANCEL-ERR        PIC X(25)
   820         VALUE 'CANCEL DATE ERROR'.
   821     12  WS-02-CANCEL-ERR        PIC X(25)
   822         VALUE 'CERT NOT FOUND'.
   823     12  WS-04-CANCEL-ERR        PIC X(25)
   824         VALUE 'CANCEL AMOUNT ERROR'.
   825     12  WS-05-CANCEL-ERR        PIC X(25)
   826         VALUE 'CANCEL OPTION ERROR'.
   827     12  WS-06-CANCEL-ERR        PIC X(25)
   828         VALUE 'PREVIOUSLY CANCELLED'.
   829     12  WS-07-CANCEL-ERR        PIC X(25)
   830         VALUE 'INVALID DATA'.
   831     12  WS-08-CANCEL-ERR        PIC X(25)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  17
* EL6311.cbl
   832         VALUE 'NO ACCOUNT MASTER'.
   833     12  WS-09-CANCEL-ERR        PIC X(25)
   834         VALUE 'SUFFIX ALREADY EXISTS'.
   835     12  WS-99-CANCEL-ERR        PIC X(25)
   836         VALUE 'MISC CANCEL ERROR'.
   837
   838     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   839     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   840
   841     12  WS-AGE-FIELDS.
   842         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   843         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   844         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   845         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   846
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  18
* EL6311.cbl
   848
   849******************************************************************
   850*                                                                *
   851*                 B A T C H   T O T A L S                        *
   852*                                                                *
   853******************************************************************
   854
   855     12  WS-BATCH-RECORD.
   856         16  FILLER                       PIC X(10).
   857         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   858         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   859         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   860         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   861         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   862         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   863         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   864         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   865         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   866         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   867         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   868         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   869         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   870         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   871         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   872         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   873         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   874         16  WS-ACCOUNT-NAME              PIC X(30).
   875         16  FILLER                       PIC X.
   876         16  WS-REFERENCE                 PIC X(12).
   877         16  FILLER                       PIC X(197).
   878
   879     12  WS-BATCH-TOTALS.
   880         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   881         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   882         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   883         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   884         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   885         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   886         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   887         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   888         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   889         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   890         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   891         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   892         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   893         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   894         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   895         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   896         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   897         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   898         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   899
   900     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   901
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  19
* EL6311.cbl
   903
   904******************************************************************
   905*                                                                *
   906*                E R R O R   M E S S A G E S                     *
   907*                                                                *
   908******************************************************************
   909
   910 01  ERROR-MESSAGES.
   911     12  ER-0004                 PIC  9(4) VALUE 0004.
   912     12  ER-0008                 PIC  9(4) VALUE 0008.
   913     12  ER-0023                 PIC  9(4) VALUE 0023.
   914     12  ER-0029                 PIC  9(4) VALUE 0029.
   915     12  ER-0033                 PIC  9(4) VALUE 0033.
   916     12  ER-0070                 PIC  9(4) VALUE 0070.
   917     12  ER-0220                 PIC  9(4) VALUE 0220.
   918     12  ER-0248                 PIC  9(4) VALUE 0248.
   919     12  ER-0280                 PIC  9(4) VALUE 0280.
   920     12  ER-0348                 PIC  9(4) VALUE 0348.
   921     12  ER-0582                 PIC  9(4) VALUE 0582.
   922     12  ER-0877                 PIC  9(4) VALUE 0877.
   923     12  ER-1236                 PIC  9(4) VALUE 1236.
   924     12  ER-1570                 PIC  9(4) VALUE 1570.
   925     12  ER-1575                 PIC  9(4) VALUE 1575.
   926     12  ER-1609                 PIC  9(4) VALUE 1609.
   927     12  ER-1819                 PIC  9(4) VALUE 1819.
   928     12  ER-2077                 PIC  9(4) VALUE 2077.
   929     12  ER-2129                 PIC  9(4) VALUE 2129.
   930     12  ER-2188                 PIC  9(4) VALUE 2188.
   931     12  ER-2192                 PIC  9(4) VALUE 2192.
   932     12  ER-2196                 PIC  9(4) VALUE 2196.
   933     12  ER-2197                 PIC  9(4) VALUE 2197.
   934     12  ER-2198                 PIC  9(4) VALUE 2198.
   935     12  ER-2200                 PIC  9(4) VALUE 2200.
   936     12  ER-2212                 PIC  9(4) VALUE 2212.
   937     12  ER-2218                 PIC  9(4) VALUE 2218.
   938     12  ER-2220                 PIC  9(4) VALUE 2220.
   939     12  ER-2222                 PIC  9(4) VALUE 2222.
   940     12  ER-2223                 PIC  9(4) VALUE 2223.
   941     12  ER-2224                 PIC  9(4) VALUE 2224.
   942     12  ER-2225                 PIC  9(4) VALUE 2225.
   943     12  ER-2226                 PIC  9(4) VALUE 2226.
   944     12  ER-2227                 PIC  9(4) VALUE 2227.
   945     12  ER-2228                 PIC  9(4) VALUE 2228.
   946     12  ER-2240                 PIC  9(4) VALUE 2240.
   947     12  ER-2241                 PIC  9(4) VALUE 2241.
   948     12  ER-2242                 PIC  9(4) VALUE 2242.
   949     12  ER-2243                 PIC  9(4) VALUE 2243.
   950     12  ER-2244                 PIC  9(4) VALUE 2244.
   951     12  ER-2245                 PIC  9(4) VALUE 2245.
   952     12  ER-2246                 PIC  9(4) VALUE 2246.
   953     12  ER-2247                 PIC  9(4) VALUE 2247.
   954     12  ER-2251                 PIC  9(4) VALUE 2251.
   955     12  ER-2252                 PIC  9(4) VALUE 2252.
   956     12  ER-2253                 PIC  9(4) VALUE 2253.
   957     12  ER-2254                 PIC  9(4) VALUE 2254.
   958     12  ER-2255                 PIC  9(4) VALUE 2255.
   959     12  ER-2256                 PIC  9(4) VALUE 2256.
   960     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  20
* EL6311.cbl
   961     12  ER-2258                 PIC  9(4) VALUE 2258.
   962     12  ER-2259                 PIC  9(4) VALUE 2259.
   963     12  ER-2260                 PIC  9(4) VALUE 2260.
   964     12  ER-2261                 PIC  9(4) VALUE 2261.
   965     12  ER-2287                 PIC  9(4) VALUE 2287.
   966     12  ER-2336                 PIC  9(4) VALUE 2336.
   967     12  ER-2337                 PIC  9(4) VALUE 2337.
   968     12  ER-2437                 PIC  9(4) VALUE 2437.
   969     12  ER-2471                 PIC  9(4) VALUE 2471.
   970     12  ER-2530                 PIC  9(4) VALUE 2530.
   971     12  ER-2531                 PIC  9(4) VALUE 2531.
   972     12  ER-2532                 PIC  9(4) VALUE 2532.
   973     12  ER-2533                 PIC  9(4) VALUE 2533.
   974     12  ER-2547                 PIC  9(4) VALUE 2547.
   975     12  ER-2591                 PIC  9(4) VALUE 2591.
   976     12  ER-2592                 PIC  9(4) VALUE 2592.
   977     12  ER-2593                 PIC  9(4) VALUE 2593.
   978     12  ER-2600                 PIC  9(4) VALUE 2600.
   979     12  ER-2601                 PIC  9(4) VALUE 2601.
   980     12  ER-2604                 PIC  9(4) VALUE 2604.
   981     12  ER-2605                 PIC  9(4) VALUE 2605.
   982     12  ER-2606                 PIC  9(4) VALUE 2606.
   983     12  ER-2607                 PIC  9(4) VALUE 2607.
   984     12  ER-2622                 PIC  9(4) VALUE 2622.
   985     12  ER-2625                 PIC  9(4) VALUE 2625.
   986     12  ER-2626                 PIC  9(4) VALUE 2626.
   987     12  ER-2627                 PIC  9(4) VALUE 2627.
   988     12  ER-2628                 PIC  9(4) VALUE 2628.
   989     12  ER-2629                 PIC  9(4) VALUE 2629.
   990     12  ER-2630                 PIC  9(4) VALUE 2630.
   991     12  ER-2631                 PIC  9(4) VALUE 2631.
   992     12  ER-2632                 PIC  9(4) VALUE 2632.
   993     12  ER-2633                 PIC  9(4) VALUE 2633.
   994     12  ER-2634                 PIC  9(4) VALUE 2634.
   995     12  ER-2635                 PIC  9(4) VALUE 2635.
   996     12  ER-2636                 PIC  9(4) VALUE 2636.
   997     12  ER-2639                 PIC  9(4) VALUE 2639.
   998     12  ER-2640                 PIC  9(4) VALUE 2640.
   999     12  ER-2647                 PIC  9(4) VALUE 2647.
  1000     12  ER-2648                 PIC  9(4) VALUE 2648.
  1001     12  ER-2649                 PIC  9(4) VALUE 2649.
  1002     12  ER-2650                 PIC  9(4) VALUE 2650.
  1003     12  ER-2653                 PIC  9(4) VALUE 2653.
  1004     12  ER-2654                 PIC  9(4) VALUE 2654.
  1005     12  ER-2655                 PIC  9(4) VALUE 2655.
  1006     12  ER-2656                 PIC  9(4) VALUE 2656.
  1007     12  ER-2657                 PIC  9(4) VALUE 2657.
  1008     12  ER-2660                 PIC  9(4) VALUE 2660.
  1009     12  ER-2661                 PIC  9(4) VALUE 2661.
  1010     12  ER-2662                 PIC  9(4) VALUE 2662.
  1011     12  ER-2663                 PIC  9(4) VALUE 2663.
  1012     12  ER-2664                 PIC  9(4) VALUE 2664.
  1013     12  ER-2667                 PIC  9(4) VALUE 2667.
  1014     12  ER-2668                 PIC  9(4) VALUE 2668.
  1015     12  ER-2669                 PIC  9(4) VALUE 2669.
  1016     12  ER-2670                 PIC  9(4) VALUE 2670.
  1017     12  ER-2671                 PIC  9(4) VALUE 2671.
  1018     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  21
* EL6311.cbl
  1019     12  ER-2673                 PIC  9(4) VALUE 2673.
  1020     12  ER-2677                 PIC  9(4) VALUE 2677.
  1021     12  ER-2678                 PIC  9(4) VALUE 2678.
  1022     12  ER-2679                 PIC  9(4) VALUE 2679.
  1023     12  ER-2680                 PIC  9(4) VALUE 2680.
  1024     12  ER-2681                 PIC  9(4) VALUE 2681.
  1025     12  ER-2682                 PIC  9(4) VALUE 2682.
  1026     12  ER-2683                 PIC  9(4) VALUE 2683.
  1027     12  ER-2684                 PIC  9(4) VALUE 2684.
  1028     12  ER-2686                 PIC  9(4) VALUE 2686.
  1029     12  ER-2689                 PIC  9(4) VALUE 2689.
  1030     12  ER-2690                 PIC  9(4) VALUE 2690.
  1031     12  ER-2693                 PIC  9(4) VALUE 2693.
  1032     12  ER-2695                 PIC  9(4) VALUE 2695.
  1033     12  ER-2701                 PIC  9(4) VALUE 2701.
  1034     12  ER-2720                 PIC  9(4) VALUE 2720.
  1035     12  ER-2709                 PIC  9(4) VALUE 2709.
  1036     12  ER-2704                 PIC  9(4) VALUE 2704.
  1037     12  ER-2725                 PIC  9(4) VALUE 2725.
  1038     12  ER-2726                 PIC  9(4) VALUE 2726.
  1039     12  ER-2728                 PIC  9(4) VALUE 2728.
  1040     12  ER-2729                 PIC  9(4) VALUE 2729.
  1041     12  ER-2731                 PIC  9(4) VALUE 2731.
  1042     12  ER-2732                 PIC  9(4) VALUE 2732.
  1043     12  ER-2733                 PIC  9(4) VALUE 2733.
  1044     12  ER-2735                 PIC  9(4) VALUE 2735.
  1045     12  ER-2738                 PIC  9(4) VALUE 2738.
  1046     12  ER-2742                 PIC  9(4) VALUE 2742.
  1047     12  ER-2743                 PIC  9(4) VALUE 2743.
  1048     12  ER-2744                 PIC  9(4) VALUE 2744.
  1049     12  ER-2747                 PIC  9(4) VALUE 2747.
  1050     12  ER-2749                 PIC  9(4) VALUE 2749.
  1051     12  ER-2753                 PIC  9(4) VALUE 2753.
  1052     12  ER-2755                 PIC  9(4) VALUE 2755.
  1053     12  ER-2757                 PIC  9(4) VALUE 2757.
  1054     12  ER-2771                 PIC  9(4) VALUE 2771.
  1055     12  ER-2774                 PIC  9(4) VALUE 2774.
  1056     12  ER-2775                 PIC  9(4) VALUE 2775.
  1057     12  ER-2776                 PIC  9(4) VALUE 2776.
  1058     12  ER-2777                 PIC  9(4) VALUE 2777.
  1059     12  ER-2794                 PIC  9(4) VALUE 2794.
  1060     12  ER-2799                 PIC  9(4) VALUE 2799.
  1061     12  ER-2900                 PIC  9(4) VALUE 2900.
  1062     12  ER-2902                 PIC  9(4) VALUE 2902.
  1063     12  ER-2945                 PIC  9(4) VALUE 2945.
  1064     12  ER-3000                 PIC  9(4) VALUE 3000.
  1065     12  ER-3006                 PIC  9(4) VALUE 3006.
  1066     12  ER-3054                 PIC  9(4) VALUE 3054.
  1067     12  ER-3224                 PIC  9(4) VALUE 3224.
  1068     12  ER-3269                 PIC  9(4) VALUE 3269.
  1069     12  er-3444                 pic  9(4) value 3444.
  1070     12  er-3446                 pic  9(4) value 3446.
  1071     12  er-3447                 pic  9(4) value 3447.
  1072     12  er-3448                 pic  9(4) value 3448.
  1073     12  er-3449                 pic  9(4) value 3449.
  1074     12  ER-3504                 PIC  9(4) VALUE 3504.
  1075     12  ER-3513                 PIC  9(4) VALUE 3513.
  1076     12  ER-3831                 PIC  9(4) VALUE 3831.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  22
* EL6311.cbl
  1077     12  ER-3834                 PIC  9(4) VALUE 3834.
  1078     12  ER-3835                 PIC  9(4) VALUE 3835.
  1079     12  ER-4005                 PIC  9(4) VALUE 4005.
  1080     12  ER-7144                 PIC  9(4) VALUE 7144.
  1081     12  ER-7401                 PIC  9(4) VALUE 7401.
  1082     12  ER-7402                 PIC  9(4) VALUE 7402.
  1083     12  ER-7403                 PIC  9(4) VALUE 7403.
  1084     12  ER-7404                 PIC  9(4) VALUE 7404.
  1085     12  ER-7423                 PIC  9(4) VALUE 7423.
  1086     12  ER-7424                 PIC  9(4) VALUE 7424.
  1087     12  ER-7433                 PIC  9(4) VALUE 7433.
  1088     12  ER-7450                 PIC  9(4) VALUE 7450.
  1089     12  ER-7451                 PIC  9(4) VALUE 7451.
  1090     12  ER-7530                 PIC  9(4) VALUE 7530.
  1091     12  ER-7573                 PIC  9(4) VALUE 7573.
  1092     12  ER-7631                 PIC  9(4) VALUE 7631.
  1093     12  ER-7632                 PIC  9(4) VALUE 7632.
  1094     12  ER-7633                 PIC  9(4) VALUE 7633.
  1095     12  ER-7537                 PIC  9(4) VALUE 7537.
  1096     12  ER-7538                 PIC  9(4) VALUE 7538.
  1097     12  ER-7574                 PIC  9(4) VALUE 7574.
  1098     12  ER-7997                 PIC  9(4) VALUE 7997.
  1099     12  ER-7998                 PIC  9(4) VALUE 7998.
  1100     12  ER-8148                 PIC  9(4) VALUE 8148.
  1101     12  ER-9063                 PIC  9(4) VALUE 9063.
  1102     12  ER-9076                 PIC  9(4) VALUE 9076.
  1103     12  ER-9618                 PIC  9(4) VALUE 9618.
  1104     12  ER-9841                 PIC  9(4) VALUE 9841.
  1105
  1106*                                COPY ELCTEXT.
  1107******************************************************************
  1108*                                                                *
  1109*                                                                *
  1110*                            ELCTEXT.                            *
  1111*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1112*                            VMOD=2.008                          *
  1113*                                                                *
  1114*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1115*                                     FORM LETTERS,              *
  1116*                                     CERT FORM DISPLAY.
  1117*                                                                *
  1118*   FILE TYPE = VSAM,KSDS                                        *
  1119*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1120*                                                                *
  1121*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1122*       ALTERNATE INDEX = NONE                                   *
  1123*                                                                *
  1124*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1125*       ALTERNATE INDEX = NONE                                   *
  1126*                                                                *
  1127*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1128*       ALTERNATE INDEX = NONE                                   *
  1129*                                                                *
  1130*   LOG = NO                                                     *
  1131*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1132******************************************************************
  1133 01  TEXT-FILES.
  1134     12  TEXT-FILE-ID                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  23
* EL6311.cbl
  1135         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1136         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1137         88  HELP-FILE-TEXT             VALUE 'TH'.
  1138
  1139     12  TX-CONTROL-PRIMARY.
  1140         16  TX-COMPANY-CD           PIC X.
  1141             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1142         16  TX-ACCESS-CD-GENL       PIC X(12).
  1143
  1144         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1145             20  TX-LETTER-NO        PIC X(4).
  1146             20  FILLER              PIC X(8).
  1147
  1148         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1149             20  TX-FORM-NO          PIC X(12).
  1150
  1151         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1152             20  TX-HELP-TYPE        PIC X.
  1153                 88  HELP-FOR-GENERAL   VALUE ' '.
  1154                 88  HELP-BY-SCREEN     VALUE 'S'.
  1155                 88  HELP-BY-ERROR      VALUE 'E'.
  1156             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1157                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1158             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1159                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1160             20  FILLER              PIC X(4).
  1161
  1162         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1163
  1164     12  TX-PROCESS-CONTROL          PIC XX.
  1165         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1166
  1167     12  TX-TEXT-LINE                PIC X(70).
  1168
  1169     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1170         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1171         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1172         88  TX-VALID-FORM-SQUEEZE-VALUE
  1173                                        VALUE 'Y' ' '.
  1174
  1175     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1176         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1177         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1178         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1179         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1180         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1181         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1182         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1183                                              'K' 'N' ' '
  1184                                              'Z'.
  1185
  1186     12  TX-ARCHIVE-SW               PIC X.
  1187         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1188         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1189         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1190
  1191     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1192     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  24
* EL6311.cbl
  1193
  1194     12  TX-BSR-CODE                 PIC X.
  1195         88  TX-BSR-LETTER              VALUE 'B'.
  1196         88  TX-NON-BSR-LETTER          VALUE ' '.
  1197
  1198     12  FILLER                      PIC X.
  1199*****************************************************************
  1200*                                COPY ELCCRTO.
  1201******************************************************************
  1202*                                                                *
  1203*                            ELCCRTO.                            *
  1204*                                                                *
  1205*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1206*                                                                *
  1207*   FILE TYPE = VSAM,KSDS                                        *
  1208*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1209*                                                                *
  1210*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1211*                                                                *
  1212*   LOG = YES                                                    *
  1213*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1214******************************************************************
  1215*                   C H A N G E   L O G
  1216*
  1217* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1218*-----------------------------------------------------------------
  1219*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1220* EFFECTIVE    NUMBER
  1221*-----------------------------------------------------------------
  1222* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1223* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1224* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1225* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1226* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1227******************************************************************
  1228 01  ORIGINAL-CERTIFICATE.
  1229     12  OC-RECORD-ID                      PIC XX.
  1230         88  VALID-OC-ID                      VALUE 'OC'.
  1231     12  OC-CONTROL-PRIMARY.
  1232         16  OC-COMPANY-CD                 PIC X.
  1233         16  OC-CARRIER                    PIC X.
  1234         16  OC-GROUPING                   PIC X(6).
  1235         16  OC-STATE                      PIC XX.
  1236         16  OC-ACCOUNT                    PIC X(10).
  1237         16  OC-CERT-EFF-DT                PIC XX.
  1238         16  OC-CERT-NO.
  1239             20  OC-CERT-PRIME             PIC X(10).
  1240             20  OC-CERT-SFX               PIC X.
  1241         16  OC-RECORD-TYPE                PIC X.
  1242         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1243     12  OC-LAST-MAINT-DT                  PIC XX.
  1244     12  OC-LAST-MAINT-BY                  PIC X(4).
  1245     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1246     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1247     12  FILLER                            PIC X(49).
  1248     12  OC-ORIG-REC.
  1249         16  OC-INS-LAST-NAME              PIC X(15).
  1250         16  OC-INS-FIRST-NAME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  25
* EL6311.cbl
  1251         16  OC-INS-MIDDLE-INIT            PIC X.
  1252         16  OC-INS-AGE                    PIC S999     COMP-3.
  1253         16  OC-JNT-LAST-NAME              PIC X(15).
  1254         16  OC-JNT-FIRST-NAME             PIC X(10).
  1255         16  OC-JNT-MIDDLE-INIT            PIC X.
  1256         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1257         16  OC-LF-BENCD                   PIC XX.
  1258         16  OC-LF-TERM                    PIC S999      COMP-3.
  1259         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1260         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1261         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1262         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1263         16  OC-LF-EXP-DT                  PIC XX.
  1264         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1265         16  OC-LF-CANCEL-DT               PIC XX.
  1266         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1267         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1268         16  OC-AH-BENCD                   PIC XX.
  1269         16  OC-AH-TERM                    PIC S999      COMP-3.
  1270         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1271         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1272         16  OC-AH-EXP-DT                  PIC XX.
  1273         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1274         16  OC-AH-CP                      PIC 99.
  1275         16  OC-AH-CANCEL-DT               PIC XX.
  1276         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1277         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1278         16  OC-CRED-BENE-NAME             PIC X(25).
  1279         16  OC-1ST-PMT-DT                 PIC XX.
  1280         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1281         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1282         16  OC-ISSUE-TRAN-IND             PIC X.
  1283         16  OC-CANCEL-TRAN-IND            PIC X.
  1284         16  FILLER                        PIC X(211).
  1285
  1286     12  FILLER                            PIC X(50).
  1287******************************************************************
  1288*                                COPY ERCACCT.
  1289******************************************************************
  1290*                                                                *
  1291*                                                                *
  1292*                            ERCACCT                             *
  1293*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1294*                            VMOD=2.031                          *
  1295*                                                                *
  1296*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1297*                                                                *
  1298*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1299*   VSAM ACCOUNT MASTER FILES.                                   *
  1300*                                                                *
  1301*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1302*                                                                *
  1303*   FILE TYPE = VSAM,KSDS                                        *
  1304*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1305*                                                                *
  1306*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1307*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1308*                                                                *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  26
* EL6311.cbl
  1309*   LOG = NO                                                     *
  1310*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1311*                                                                *
  1312*                                                                *
  1313******************************************************************
  1314*                   C H A N G E   L O G
  1315*
  1316* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1317*-----------------------------------------------------------------
  1318*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1319* EFFECTIVE    NUMBER
  1320*-----------------------------------------------------------------
  1321* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1322* 092705    2005050300006  PEMA  ADD SPP LEASES
  1323* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1324* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1325* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1326* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1327* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1328******************************************************************
  1329
  1330 01  ACCOUNT-MASTER.
  1331     12  AM-RECORD-ID                      PIC XX.
  1332         88  VALID-AM-ID                      VALUE 'AM'.
  1333
  1334     12  AM-CONTROL-PRIMARY.
  1335         16  AM-COMPANY-CD                 PIC X.
  1336         16  AM-MSTR-CNTRL.
  1337             20  AM-CONTROL-A.
  1338                 24  AM-CARRIER            PIC X.
  1339                 24  AM-GROUPING.
  1340                     28 AM-GROUPING-PREFIX PIC XXX.
  1341                     28 AM-GROUPING-PRIME  PIC XXX.
  1342                 24  AM-STATE              PIC XX.
  1343                 24  AM-ACCOUNT.
  1344                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1345                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1346             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1347                                           PIC X(19).
  1348             20  AM-CNTRL-B.
  1349                 24  AM-EXPIRATION-DT      PIC XX.
  1350                 24  FILLER                PIC X(4).
  1351             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1352                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1353
  1354     12  AM-CONTROL-BY-VAR-GRP.
  1355         16  AM-COMPANY-CD-A1              PIC X.
  1356         16  AM-VG-CARRIER                 PIC X.
  1357         16  AM-VG-GROUPING                PIC X(6).
  1358         16  AM-VG-STATE                   PIC XX.
  1359         16  AM-VG-ACCOUNT                 PIC X(10).
  1360         16  AM-VG-DATE.
  1361             20  AM-VG-EXPIRATION-DT       PIC XX.
  1362             20  FILLER                    PIC X(4).
  1363         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1364                                           PIC 9(11)      COMP-3.
  1365     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1366         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  27
* EL6311.cbl
  1367         16  AM-VG-KEY3.
  1368             20  AM-VG3-ACCOUNT            PIC X(10).
  1369             20  AM-VG3-EXP-DT             PIC XX.
  1370         16  FILLER                        PIC X(4).
  1371     12  AM-MAINT-INFORMATION.
  1372         16  AM-LAST-MAINT-DT              PIC XX.
  1373         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1374         16  AM-LAST-MAINT-USER            PIC X(4).
  1375         16  FILLER                        PIC XX.
  1376
  1377     12  AM-EFFECTIVE-DT                   PIC XX.
  1378     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1379
  1380     12  AM-PREV-DATES  COMP-3.
  1381         16  AM-PREV-EXP-DT                PIC 9(11).
  1382         16  AM-PREV-EFF-DT                PIC 9(11).
  1383
  1384     12  AM-REPORT-CODE-1                  PIC X(10).
  1385     12  AM-REPORT-CODE-2                  PIC X(10).
  1386
  1387     12  AM-CITY-CODE                      PIC X(4).
  1388     12  AM-COUNTY-PARISH                  PIC X(6).
  1389
  1390     12  AM-NAME                           PIC X(30).
  1391     12  AM-PERSON                         PIC X(30).
  1392     12  AM-ADDRS                          PIC X(30).
  1393     12  AM-CITY.
  1394         16  AM-ADDR-CITY                  PIC X(28).
  1395         16  AM-ADDR-STATE                 PIC XX.
  1396     12  AM-ZIP.
  1397         16  AM-ZIP-PRIME.
  1398             20  AM-ZIP-PRI-1ST            PIC X.
  1399                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1400             20  FILLER                    PIC X(4).
  1401         16  AM-ZIP-PLUS4                  PIC X(4).
  1402     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1403         16  AM-CAN-POSTAL-1               PIC XXX.
  1404         16  AM-CAN-POSTAL-2               PIC XXX.
  1405         16  FILLER                        PIC XXX.
  1406     12  AM-TEL-NO.
  1407         16  AM-AREA-CODE                  PIC 999.
  1408         16  AM-TEL-PRE                    PIC 999.
  1409         16  AM-TEL-NBR                    PIC 9(4).
  1410     12  AM-TEL-LOC                        PIC X.
  1411         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1412         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1413
  1414     12  AM-COMM-STRUCTURE.
  1415         16  AM-DEFN-1.
  1416             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1417                 24  AM-AGT.
  1418                     28  AM-AGT-PREFIX     PIC X(4).
  1419                     28  AM-AGT-PRIME      PIC X(6).
  1420                 24  AM-COM-TYP            PIC X.
  1421                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1422                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1423                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1424                 24  AM-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  28
* EL6311.cbl
  1425                 24  AM-RETRO-LV-INDIC     PIC X.
  1426                 24  AM-GL-CODES           PIC X.
  1427                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1428                 24  FILLER                PIC X(01).
  1429         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1430             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1431                 24  FILLER                PIC X(11).
  1432                 24  AM-L-COMA             PIC XXX.
  1433                 24  AM-J-COMA             PIC XXX.
  1434                 24  AM-A-COMA             PIC XXX.
  1435                 24  FILLER                PIC X(6).
  1436
  1437     12  AM-COMM-CHANGE-STATUS             PIC X.
  1438         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1439
  1440     12  AM-CSR-CODE                       PIC X(4).
  1441
  1442     12  AM-BILLING-STATUS                 PIC X.
  1443         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1444         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1445     12  AM-AUTO-REFUND-SW                 PIC X.
  1446         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1447         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1448     12  AM-GPCD                           PIC 99.
  1449     12  AM-IG                             PIC X.
  1450         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1451         88  AM-HAS-GROUP                     VALUE '2'.
  1452     12  AM-STATUS                         PIC X.
  1453         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1454         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1455         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1456         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1457         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1458         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1459     12  AM-REMIT-TO                       PIC 99.
  1460     12  AM-ID-NO                          PIC X(11).
  1461
  1462     12  AM-CAL-TABLE                      PIC XX.
  1463     12  AM-LF-DEVIATION                   PIC XXX.
  1464     12  AM-AH-DEVIATION                   PIC XXX.
  1465     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1466     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1467     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1468     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1469     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1470     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1471
  1472     12  AM-USER-FIELDS.
  1473         16  AM-FLD-1                      PIC XX.
  1474         16  AM-FLD-2                      PIC XX.
  1475         16  AM-FLD-3                      PIC XX.
  1476         16  AM-FLD-4                      PIC XX.
  1477         16  AM-FLD-5                      PIC XX.
  1478
  1479     12  AM-1ST-PROD-DATE.
  1480         16  AM-1ST-PROD-YR                PIC XX.
  1481         16  AM-1ST-PROD-MO                PIC XX.
  1482         16  AM-1ST-PROD-DA                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  29
* EL6311.cbl
  1483     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1484     12  AM-CERTS-PURGED-DATE.
  1485         16  AM-PUR-YR                     PIC XX.
  1486         16  AM-PUR-MO                     PIC XX.
  1487         16  AM-PUR-DA                     PIC XX.
  1488     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1489     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1490     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1491     12  AM-INACTIVE-DATE.
  1492         16  AM-INA-MO                     PIC 99.
  1493         16  AM-INA-DA                     PIC 99.
  1494         16  AM-INA-YR                     PIC 99.
  1495     12  AM-AR-HI-CERT-DATE                PIC XX.
  1496
  1497     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1498     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1499
  1500     12  AM-OB-PAYMENT-MODE                PIC X.
  1501         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1502         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1503         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1504         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1505
  1506     12  AM-AH-ONLY-INDICATOR              PIC X.
  1507         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1508         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1509
  1510     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1511
  1512     12  AM-OVER-SHORT.
  1513         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1514         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1515
  1516     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1517     12  AM-DCC-CLP-STATE                  PIC XX.
  1518
  1519     12  AM-RECALC-COMM                    PIC X.
  1520     12  AM-RECALC-REIN                    PIC X.
  1521
  1522     12  AM-REI-TABLE                      PIC XXX.
  1523     12  AM-REI-ET-LF                      PIC X.
  1524     12  AM-REI-ET-AH                      PIC X.
  1525     12  AM-REI-PE-LF                      PIC X.
  1526     12  AM-REI-PE-AH                      PIC X.
  1527     12  AM-REI-PRT-ST                     PIC X.
  1528     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1529     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1530     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1531     12  AM-REI-GROUP-A                    PIC X(6).
  1532     12  AM-REI-MORT                       PIC X(4).
  1533     12  AM-REI-PRT-OW                     PIC X.
  1534     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1535     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1536     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1537     12  AM-REI-GROUP-B                    PIC X(6).
  1538
  1539     12  AM-TRUST-TYPE                     PIC X(2).
  1540
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  30
* EL6311.cbl
  1541     12  AM-EMPLOYER-STMT-USED             PIC X.
  1542     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1543
  1544     12  AM-STD-AH-TYPE                    PIC XX.
  1545     12  AM-EARN-METHODS.
  1546         16  AM-EARN-METHOD-R              PIC X.
  1547             88 AM-REF-RL-R78                 VALUE 'R'.
  1548             88 AM-REF-RL-PR                  VALUE 'P'.
  1549             88 AM-REF-RL-MEAN                VALUE 'M'.
  1550             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1551         16  AM-EARN-METHOD-L              PIC X.
  1552             88 AM-REF-LL-R78                 VALUE 'R'.
  1553             88 AM-REF-LL-PR                  VALUE 'P'.
  1554             88 AM-REF-LL-MEAN                VALUE 'M'.
  1555             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1556         16  AM-EARN-METHOD-A              PIC X.
  1557             88 AM-REF-AH-R78                 VALUE 'R'.
  1558             88 AM-REF-AH-PR                  VALUE 'P'.
  1559             88 AM-REF-AH-MEAN                VALUE 'M'.
  1560             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1561             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1562             88 AM-REF-AH-NET                 VALUE 'N'.
  1563
  1564     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1565     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1566     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1567
  1568     12  AM-RET-Y-N                        PIC X.
  1569     12  AM-RET-P-E                        PIC X.
  1570     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1571     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1572     12  AM-RET-GRP                        PIC X(6).
  1573     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1574         16  AM-POOL-PRIME                 PIC XXX.
  1575         16  AM-POOL-SUB                   PIC XXX.
  1576     12  AM-RETRO-EARNINGS.
  1577         16  AM-RET-EARN-R                 PIC X.
  1578         16  AM-RET-EARN-L                 PIC X.
  1579         16  AM-RET-EARN-A                 PIC X.
  1580     12  AM-RET-ST-TAX-USE                 PIC X.
  1581         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1582         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1583     12  AM-RETRO-BEG-EARNINGS.
  1584         16  AM-RET-BEG-EARN-R             PIC X.
  1585         16  AM-RET-BEG-EARN-L             PIC X.
  1586         16  AM-RET-BEG-EARN-A             PIC X.
  1587     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1588     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1589
  1590     12  AM-USER-SELECT-OPTIONS.
  1591         16  AM-USER-SELECT-1              PIC X(10).
  1592         16  AM-USER-SELECT-2              PIC X(10).
  1593         16  AM-USER-SELECT-3              PIC X(10).
  1594         16  AM-USER-SELECT-4              PIC X(10).
  1595         16  AM-USER-SELECT-5              PIC X(10).
  1596
  1597     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1598
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  31
* EL6311.cbl
  1599     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1600
  1601     12  AM-RPT045A-SWITCH                 PIC X.
  1602         88  RPT045A-OFF                   VALUE 'N'.
  1603
  1604     12  AM-INSURANCE-LIMITS.
  1605         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1606         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1607
  1608     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1609         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1610
  1611     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1612         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1613         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1614
  1615     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1616
  1617     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1618     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1619     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1620     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1621     12  AM-DCC-UEF-STATE                  PIC XX.
  1622     12  FILLER                            PIC XXX.
  1623     12  AM-REPORT-CODE-3                  PIC X(10).
  1624*    12  FILLER                            PIC X(22).
  1625
  1626     12  AM-RESERVE-DATE.
  1627         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1628         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1629         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1630
  1631     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1632     12  AM-NOTIFICATION-TYPES.
  1633         16  AM-NOTIF-OF-LETTERS           PIC X.
  1634         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1635         16  AM-NOTIF-OF-REPORTS           PIC X.
  1636         16  AM-NOTIF-OF-STATUS            PIC X.
  1637
  1638     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1639         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1640         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1641         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1642         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1643
  1644     12  AM-BENEFIT-CONTROLS.
  1645         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1646             20  AM-BENEFIT-CODE           PIC XX.
  1647             20  AM-BENEFIT-TYPE           PIC X.
  1648             20  AM-BENEFIT-REVISION       PIC XXX.
  1649             20  AM-BENEFIT-REM-TERM       PIC X.
  1650             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1651             20  FILLER                    PIC XX.
  1652         16  FILLER                        PIC X(80).
  1653
  1654     12  AM-TRANSFER-DATA.
  1655         16  AM-TRANSFERRED-FROM.
  1656             20  AM-TRNFROM-CARRIER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  32
* EL6311.cbl
  1657             20  AM-TRNFROM-GROUPING.
  1658                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1659                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1660             20  AM-TRNFROM-STATE          PIC XX.
  1661             20  AM-TRNFROM-ACCOUNT.
  1662                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1663                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1664             20  AM-TRNFROM-DTE            PIC XX.
  1665         16  AM-TRANSFERRED-TO.
  1666             20  AM-TRNTO-CARRIER          PIC X.
  1667             20  AM-TRNTO-GROUPING.
  1668                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1669                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1670             20  AM-TRNTO-STATE            PIC XX.
  1671             20  AM-TRNTO-ACCOUNT.
  1672                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1673                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1674             20  AM-TRNTO-DTE              PIC XX.
  1675         16  FILLER                        PIC X(10).
  1676
  1677     12  AM-SAVED-REMIT-TO                 PIC 99.
  1678
  1679     12  AM-COMM-STRUCTURE-SAVED.
  1680         16  AM-DEFN-1-SAVED.
  1681             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1682                 24  AM-AGT-SV             PIC X(10).
  1683                 24  AM-COM-TYP-SV         PIC X.
  1684                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1685                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1686                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1687                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1688                 24  FILLER                PIC X.
  1689                 24  AM-GL-CODES-SV        PIC X.
  1690                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1691                 24  FILLER                PIC X.
  1692         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1693             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1694                 24  FILLER                PIC X(11).
  1695                 24  AM-L-COMA-SV          PIC XXX.
  1696                 24  AM-J-COMA-SV          PIC XXX.
  1697                 24  AM-A-COMA-SV          PIC XXX.
  1698                 24  FILLER                PIC X(6).
  1699
  1700     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1701         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1702            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1703            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1704            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1705
  1706     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1707     12  FILLER                            PIC X(120).
  1708
  1709     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1710         16  AM-CONTROL-NAME               PIC X(30).
  1711         16  AM-EXECUTIVE-ONE.
  1712             20  AM-EXEC1-NAME             PIC X(15).
  1713             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1714                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  33
* EL6311.cbl
  1715             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1716                                                          COMP-3.
  1717         16  AM-EXECUTIVE-TWO.
  1718             20  AM-EXEC2-NAME             PIC X(15).
  1719             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1720                                                          COMP-3.
  1721             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1722                                                          COMP-3.
  1723
  1724     12  AM-RETRO-ADDITIONAL-DATA.
  1725         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1726         16  AM-RETRO-PREM-P-E             PIC X.
  1727         16  AM-RETRO-CLMS-P-I             PIC X.
  1728         16  AM-RETRO-RET-BRACKET-LF.
  1729             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1730                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1731                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1732             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1733                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1734                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1735             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1736                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1737                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1738         16  AM-RETRO-RET-BRACKET-AH.
  1739             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1740                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1741                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1742                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1743             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1744                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1745                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1746             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1747                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1748                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1749
  1750     12  AM-COMMENTS.
  1751         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1752
  1753     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1754         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1755         16  AM-FLI-BILLING-CODE           PIC X.
  1756         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1757         16  AM-FLI-UNITED-IDENT           PIC X.
  1758         16  AM-FLI-INTEREST-LOST-DATA.
  1759             20  AM-FLI-BANK-NO            PIC X(5).
  1760             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1761             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1762             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1763         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1764             20  AM-FLI-AGT                PIC X(9).
  1765             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1766             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1767         16  FILLER                        PIC X(102).
  1768
  1769     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1770         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1771             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1772             20  AM-BENEFIT-DMD-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  34
* EL6311.cbl
  1773             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1774             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1775             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1776         16  FILLER                          PIC X(10).
  1777******************************************************************
  1778*                                COPY ELCVADS.
  1779******************************************************************
  1780*                                                                *
  1781*                                                                *
  1782*                            ELCVADS.                            *
  1783*                                                                *
  1784*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1785*   ELVADS                  LENGTH = 350                         *
  1786******************************************************************
  1787******************************************************************
  1788*                   C H A N G E   L O G
  1789*
  1790* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1791*-----------------------------------------------------------------
  1792*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1793* EFFECTIVE    NUMBER
  1794*-----------------------------------------------------------------
  1795* 100111    2011022800001  AJRA  NAPERSOFT
  1796******************************************************************
  1797
  1798 01  VIRGINIA-DISCLOSURE.
  1799     12  VD-COMPANY-CD              PIC X.
  1800     12  VD-CARRIER                 PIC X.
  1801     12  VD-GROUPING.
  1802         20  VD-GROUPING-PREFIX     PIC XXX.
  1803         20  VD-GROUPING-PRIME      PIC XXX.
  1804     12  VD-STATE                   PIC XX.
  1805     12  VD-ACCOUNT.
  1806         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1807         20  VD-ACCOUNT-PRIME       PIC X(6).
  1808     12  VD-CERT-EFF-DT             PIC XX.
  1809     12  VD-CERT-NO.
  1810         20  VD-CERT-PRIME          PIC X(10).
  1811         20  VD-CERT-SFX            PIC X.
  1812     12  VD-ENTRY-BATCH             PIC X(6).
  1813     12  VD-CSR-ID                  PIC X(4).
  1814     12  VD-NAME.
  1815         20  VD-INSURED-LAST-NAME   PIC X(15).
  1816         20  VD-INSURED-FIRST-NAME.
  1817             24  VD-INSURED-1ST-INIT PIC X.
  1818             24  FILLER             PIC X(9).
  1819         20  VD-INSURED-MIDDLE-INIT PIC X.
  1820     12  VD-JOINT-INSURED.
  1821         20 VD-JOINT-LAST-NAME      PIC X(15).
  1822         20 VD-JOINT-FIRST-NAME.
  1823            24  VD-JOINT-FIRST-INIT PIC X.
  1824            24  FILLER              PIC X(9).
  1825         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1826     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1827     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1828     12  VD-INSURED-CITY-STATE.
  1829         20  VD-INSURED-CITY        PIC X(28).
  1830         20  VD-INSURED-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  35
* EL6311.cbl
  1831     12  VD-INSURED-ZIP-CODE.
  1832         20  VD-INSURED-ZIP-PRIME.
  1833             24  VD-INSURED-ZIP-1   PIC X.
  1834                 88  VD-CANADIAN-POST-CODE
  1835                                       VALUE 'A' THRU 'Z'.
  1836             24  FILLER             PIC X(4).
  1837         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1838     12  VD-BENEFICIARY-NAME        PIC X(30).
  1839     12  VD-ACCOUNT-NAME            PIC X(30).
  1840     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1841     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1842     12  VD-1ST-PMT-DT              PIC XX.
  1843     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1844         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1845         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1846                                             '90' THRU '99'.
  1847     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1848                                    PIC XX.
  1849     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1850     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1851     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1852     12  VD-LF-TERM                 PIC S999   COMP-3.
  1853     12  VD-AH-BENEFIT-CD           PIC XX.
  1854         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1855         88  VD-INVALID-AH             VALUE '  ' '00'
  1856                                             '90' THRU '99'.
  1857     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1858     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1859     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1860     12  VD-AH-TERM                 PIC S999   COMP-3.
  1861     12  VD-LETTER-ID               PIC X(4).
  1862     12  VD-PROC-ID                 PIC X(4).
  1863     12  VD-COMP-ID                 PIC X(3).
  1864     12  VD-CURRENT-DATE            PIC XX.
  1865     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1866     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1867     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  36
* EL6311.cbl
  1869*    COPY ELCDATE.
  1870******************************************************************
  1871*                                                                *
  1872*                                                                *
  1873*                            ELCDATE.                            *
  1874*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1875*                            VMOD=2.003
  1876*                                                                *
  1877*                                                                *
  1878*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1879*                 LENGTH = 200                                   *
  1880******************************************************************
  1881
  1882 01  DATE-CONVERSION-DATA.
  1883     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1884     12  DC-OPTION-CODE                PIC X.
  1885         88  BIN-TO-GREG                VALUE ' '.
  1886         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1887         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1888         88  YMD-GREG-TO-BIN            VALUE '3'.
  1889         88  MDY-GREG-TO-BIN            VALUE '4'.
  1890         88  JULIAN-TO-BIN              VALUE '5'.
  1891         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1892         88  FIND-CENTURY               VALUE '7'.
  1893         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1894         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1895         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1896         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1897         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1898         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1899         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1900         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1901         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1902         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1903         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1904         88  BIN-3-TO-GREG              VALUE 'I'.
  1905         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1906         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1907         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1908         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1909         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1910         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1911         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1912         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1913         88  THREE-CHARACTER-BIN
  1914                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1915         88  GREGORIAN-TO-BIN
  1916                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1917         88  BIN-TO-GREGORIAN
  1918                  VALUES ' ' '1' 'I' '8' 'G'.
  1919         88  JULIAN-TO-BINARY
  1920                  VALUES '5' 'C' 'E' 'F'.
  1921     12  DC-ERROR-CODE                 PIC X.
  1922         88  NO-CONVERSION-ERROR        VALUE ' '.
  1923         88  DATE-CONVERSION-ERROR
  1924                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1925         88  DATE-IS-ZERO               VALUE '1'.
  1926         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  37
* EL6311.cbl
  1927         88  DATE-IS-INVALID            VALUE '3'.
  1928         88  DATE1-GREATER-DATE2        VALUE '4'.
  1929         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1930         88  DATE-INVALID-OPTION        VALUE '9'.
  1931         88  INVALID-CENTURY            VALUE 'A'.
  1932         88  ONLY-CENTURY               VALUE 'B'.
  1933         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1934         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1935     12  DC-END-OF-MONTH               PIC X.
  1936         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1937     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1938         88  USE-NORMAL-PROCESS         VALUE ' '.
  1939         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1940         88  ADJUST-UP-100-YRS          VALUE '2'.
  1941     12  FILLER                        PIC X.
  1942     12  DC-CONVERSION-DATES.
  1943         16  DC-BIN-DATE-1             PIC XX.
  1944         16  DC-BIN-DATE-2             PIC XX.
  1945         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1946         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1947                       DC-GREG-DATE-1-EDIT.
  1948             20  DC-EDIT1-MONTH        PIC 99.
  1949             20  SLASH1-1              PIC X.
  1950             20  DC-EDIT1-DAY          PIC 99.
  1951             20  SLASH1-2              PIC X.
  1952             20  DC-EDIT1-YEAR         PIC 99.
  1953         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1954         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1955                     DC-GREG-DATE-2-EDIT.
  1956             20  DC-EDIT2-MONTH        PIC 99.
  1957             20  SLASH2-1              PIC X.
  1958             20  DC-EDIT2-DAY          PIC 99.
  1959             20  SLASH2-2              PIC X.
  1960             20  DC-EDIT2-YEAR         PIC 99.
  1961         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1962         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1963                     DC-GREG-DATE-1-YMD.
  1964             20  DC-YMD-YEAR           PIC 99.
  1965             20  DC-YMD-MONTH          PIC 99.
  1966             20  DC-YMD-DAY            PIC 99.
  1967         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1968         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1969                      DC-GREG-DATE-1-MDY.
  1970             20  DC-MDY-MONTH          PIC 99.
  1971             20  DC-MDY-DAY            PIC 99.
  1972             20  DC-MDY-YEAR           PIC 99.
  1973         16  DC-GREG-DATE-1-ALPHA.
  1974             20  DC-ALPHA-MONTH        PIC X(10).
  1975             20  DC-ALPHA-DAY          PIC 99.
  1976             20  FILLER                PIC XX.
  1977             20  DC-ALPHA-CENTURY.
  1978                 24 DC-ALPHA-CEN-N     PIC 99.
  1979             20  DC-ALPHA-YEAR         PIC 99.
  1980         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1981         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1982         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1983         16  DC-JULIAN-DATE            PIC 9(05).
  1984         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  38
* EL6311.cbl
  1985                                       PIC 9(05).
  1986         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1987             20  DC-JULIAN-YEAR        PIC 99.
  1988             20  DC-JULIAN-DAYS        PIC 999.
  1989         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1990         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1991         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1992     12  DATE-CONVERSION-VARIBLES.
  1993         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1994         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1995             20  FILLER                PIC 9(3).
  1996             20  HOLD-CEN-1-CCYY.
  1997                 24  HOLD-CEN-1-CC     PIC 99.
  1998                 24  HOLD-CEN-1-YY     PIC 99.
  1999             20  HOLD-CEN-1-MO         PIC 99.
  2000             20  HOLD-CEN-1-DA         PIC 99.
  2001         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2002             20  HOLD-CEN-1-R-MO       PIC 99.
  2003             20  HOLD-CEN-1-R-DA       PIC 99.
  2004             20  HOLD-CEN-1-R-CCYY.
  2005                 24  HOLD-CEN-1-R-CC   PIC 99.
  2006                 24  HOLD-CEN-1-R-YY   PIC 99.
  2007             20  FILLER                PIC 9(3).
  2008         16  HOLD-CENTURY-1-X.
  2009             20  FILLER                PIC X(3)  VALUE SPACES.
  2010             20  HOLD-CEN-1-X-CCYY.
  2011                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2012                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2013             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2014             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2015         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2016             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2017             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2018             20  HOLD-CEN-1-R-X-CCYY.
  2019                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2020                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2021             20  FILLER                PIC XXX.
  2022         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2023         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2024         16  DC-JULIAN-DATE-1          PIC 9(07).
  2025         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2026             20  DC-JULIAN-1-CCYY.
  2027                 24  DC-JULIAN-1-CC    PIC 99.
  2028                 24  DC-JULIAN-1-YR    PIC 99.
  2029             20  DC-JULIAN-DA-1        PIC 999.
  2030         16  DC-JULIAN-DATE-2          PIC 9(07).
  2031         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2032             20  DC-JULIAN-2-CCYY.
  2033                 24  DC-JULIAN-2-CC    PIC 99.
  2034                 24  DC-JULIAN-2-YR    PIC 99.
  2035             20  DC-JULIAN-DA-2        PIC 999.
  2036         16  DC-GREG-DATE-A-EDIT.
  2037             20  DC-EDITA-MONTH        PIC 99.
  2038             20  SLASHA-1              PIC X VALUE '/'.
  2039             20  DC-EDITA-DAY          PIC 99.
  2040             20  SLASHA-2              PIC X VALUE '/'.
  2041             20  DC-EDITA-CCYY.
  2042                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  39
* EL6311.cbl
  2043                 24  DC-EDITA-YEAR     PIC 99.
  2044         16  DC-GREG-DATE-B-EDIT.
  2045             20  DC-EDITB-MONTH        PIC 99.
  2046             20  SLASHB-1              PIC X VALUE '/'.
  2047             20  DC-EDITB-DAY          PIC 99.
  2048             20  SLASHB-2              PIC X VALUE '/'.
  2049             20  DC-EDITB-CCYY.
  2050                 24  DC-EDITB-CENT     PIC 99.
  2051                 24  DC-EDITB-YEAR     PIC 99.
  2052         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2053         16  DC-GREG-DATE-CYMD-R REDEFINES
  2054                              DC-GREG-DATE-CYMD.
  2055             20  DC-CYMD-CEN           PIC 99.
  2056             20  DC-CYMD-YEAR          PIC 99.
  2057             20  DC-CYMD-MONTH         PIC 99.
  2058             20  DC-CYMD-DAY           PIC 99.
  2059         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2060         16  DC-GREG-DATE-MDCY-R REDEFINES
  2061                              DC-GREG-DATE-MDCY.
  2062             20  DC-MDCY-MONTH         PIC 99.
  2063             20  DC-MDCY-DAY           PIC 99.
  2064             20  DC-MDCY-CEN           PIC 99.
  2065             20  DC-MDCY-YEAR          PIC 99.
  2066    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2067        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2068    12  DC-EL310-DATE                  PIC X(21).
  2069    12  FILLER                         PIC X(28).
  2070
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  40
* EL6311.cbl
  2072*    COPY ELCLOGOF.
  2073******************************************************************
  2074*                                                                *
  2075*                                                                *
  2076*                            ELCLOGOF.                           *
  2077*                            VMOD=2.001                          *
  2078*                                                                *
  2079*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2080*                                                                *
  2081******************************************************************
  2082 01  CLASIC-LOGOFF.
  2083     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2084     12  LOGOFF-TEXT.
  2085         16  FILLER          PIC X(5)    VALUE SPACES.
  2086         16  LOGOFF-MSG.
  2087             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2088             20  FILLER      PIC X       VALUE SPACES.
  2089             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2090         16  FILLER          PIC X(80)
  2091           VALUE '* YOU ARE NOW LOGGED OFF'.
  2092         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2093         16  FILLER          PIC X       VALUE QUOTE.
  2094         16  LOGOFF-SYS-MSG  PIC X(17)
  2095           VALUE 'S CLAS-IC SYSTEM '.
  2096     12  TEXT-MESSAGES.
  2097         16  UNACCESS-MSG    PIC X(29)
  2098             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2099         16  PGMIDERR-MSG    PIC X(17)
  2100             VALUE 'PROGRAM NOT FOUND'.
  2101
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  41
* EL6311.cbl
  2103*    COPY ELCATTR.
  2104******************************************************************
  2105*                                                                *
  2106*                            ELCATTR.                            *
  2107*                            VMOD=2.001                          *
  2108*                                                                *
  2109*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2110*                                                                *
  2111*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2112*                                                                *
  2113*                   POS 1   P=PROTECTED                          *
  2114*                           U=UNPROTECTED                        *
  2115*                           S=ASKIP                              *
  2116*                   POS 2   A=ALPHA/NUMERIC                      *
  2117*                           N=NUMERIC                            *
  2118*                   POS 3   N=NORMAL                             *
  2119*                           B=BRIGHT                             *
  2120*                           D=DARK                               *
  2121*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2122*                           OF=MODIFIED DATA TAG OFF             *
  2123*                                                                *
  2124*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2125******************************************************************
  2126 01  ATTRIBUTE-LIST.
  2127     12  AL-PABOF            PIC X       VALUE 'Y'.
  2128     12  AL-PABON            PIC X       VALUE 'Z'.
  2129     12  AL-PADOF            PIC X       VALUE '%'.
  2130     12  AL-PADON            PIC X       VALUE '_'.
  2131     12  AL-PANOF            PIC X       VALUE '-'.
  2132     12  AL-PANON            PIC X       VALUE '/'.
  2133     12  AL-SABOF            PIC X       VALUE '8'.
  2134     12  AL-SABON            PIC X       VALUE '9'.
  2135     12  AL-SADOF            PIC X       VALUE '@'.
  2136     12  AL-SADON            PIC X       VALUE QUOTE.
  2137     12  AL-SANOF            PIC X       VALUE '0'.
  2138     12  AL-SANON            PIC X       VALUE '1'.
  2139     12  AL-UABOF            PIC X       VALUE 'H'.
  2140     12  AL-UABON            PIC X       VALUE 'I'.
  2141     12  AL-UADOF            PIC X       VALUE '<'.
  2142     12  AL-UADON            PIC X       VALUE '('.
  2143     12  AL-UANOF            PIC X       VALUE ' '.
  2144     12  AL-UANON            PIC X       VALUE 'A'.
  2145     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2146     12  AL-UNBON            PIC X       VALUE 'R'.
  2147     12  AL-UNDOF            PIC X       VALUE '*'.
  2148     12  AL-UNDON            PIC X       VALUE ')'.
  2149     12  AL-UNNOF            PIC X       VALUE '&'.
  2150     12  AL-UNNON            PIC X       VALUE 'J'.
  2151
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  42
* EL6311.cbl
  2153*    COPY ELCEMIB.
  2154******************************************************************
  2155*                                                                *
  2156*                                                                *
  2157*                            ELCEMIB.                            *
  2158*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2159*                            VMOD=2.005                          *
  2160*                                                                *
  2161*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2162*                                                                *
  2163******************************************************************
  2164 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2165     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2166     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2167     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2168     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2169     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2170     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2171     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2172     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2173     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2174         88  EMI-NO-ERRORS                    VALUE '1'.
  2175         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2176         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2177     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2178         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2179     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2180         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2181         88  EMI-AREA1-FULL                   VALUE '2'.
  2182     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2183         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2184         88  EMI-AREA2-FULL                   VALUE '2'.
  2185     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2186         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2187         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2188         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2189         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2190         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2191     12  EMI-ERROR-LINES.
  2192         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2193         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2194         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2195         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2196             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2197                 24  EMI-ERR-NUM         PIC X(4).
  2198                 24  EMI-FILLER          PIC X.
  2199                 24  EMI-SEV             PIC X.
  2200                 24  FILLER              PIC X.
  2201             20  FILLER                  PIC X(02).
  2202     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2203         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2204             20  EMI-ERROR-NUMBER    PIC X(4).
  2205             20  EMI-FILL            PIC X.
  2206             20  EMI-SEVERITY        PIC X.
  2207             20  FILLER              PIC X.
  2208             20  EMI-ERROR-TEXT.
  2209                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2210                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  43
* EL6311.cbl
  2211     12  EMI-SEVERITY-SAVE           PIC X.
  2212         88  EMI-NOTE                    VALUE 'N'.
  2213         88  EMI-WARNING                 VALUE 'W'.
  2214         88  EMI-FORCABLE                VALUE 'F'.
  2215         88  EMI-FATAL                   VALUE 'X'.
  2216     12  EMI-MESSAGE-FLAG            PIC X.
  2217         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2218         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2219     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2220     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2221         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2222         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2223         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2224     12  emi-claim-no                pic x(7).
  2225     12  emi-claim-type              pic x(6).
  2226     12  FILLER                      PIC X(124)  VALUE SPACES.
  2227     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2228     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2229     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2230     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2231
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  44
* EL6311.cbl
  2233*    COPY ELCINTF.
  2234******************************************************************
  2235*                                                                *
  2236*                                                                *
  2237*                            ELCINTF.                            *
  2238*                            VMOD=2.017                          *
  2239*                                                                *
  2240*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2241*                                                                *
  2242*       LENGTH = 1024                                            *
  2243*                                                                *
  2244******************************************************************
  2245*                   C H A N G E   L O G
  2246*
  2247* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2248*-----------------------------------------------------------------
  2249*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2250* EFFECTIVE    NUMBER
  2251*-----------------------------------------------------------------
  2252* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2253******************************************************************
  2254 01  PROGRAM-INTERFACE-BLOCK.
  2255     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2256     12  PI-CALLING-PROGRAM              PIC X(8).
  2257     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2258     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2259     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2260     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2261     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2262     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2263     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2264     12  PI-COMPANY-ID                   PIC XXX.
  2265     12  PI-COMPANY-CD                   PIC X.
  2266
  2267     12  PI-COMPANY-PASSWORD             PIC X(8).
  2268
  2269     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2270
  2271     12  PI-CONTROL-IN-PROGRESS.
  2272         16  PI-CARRIER                  PIC X.
  2273         16  PI-GROUPING                 PIC X(6).
  2274         16  PI-STATE                    PIC XX.
  2275         16  PI-ACCOUNT                  PIC X(10).
  2276         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2277                                         PIC X(10).
  2278         16  PI-CLAIM-CERT-GRP.
  2279             20  PI-CLAIM-NO             PIC X(7).
  2280             20  PI-CERT-NO.
  2281                 25  PI-CERT-PRIME       PIC X(10).
  2282                 25  PI-CERT-SFX         PIC X.
  2283             20  PI-CERT-EFF-DT          PIC XX.
  2284         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2285             20  PI-PLAN-CODE            PIC X(2).
  2286             20  PI-REVISION-NUMBER      PIC X(3).
  2287             20  PI-PLAN-EFF-DT          PIC X(2).
  2288             20  PI-PLAN-EXP-DT          PIC X(2).
  2289             20  FILLER                  PIC X(11).
  2290         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  45
* EL6311.cbl
  2291             20  PI-OE-REFERENCE-1.
  2292                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2293                 25  PI-OE-REF-1-SUFF    PIC XX.
  2294
  2295     12  PI-SESSION-IN-PROGRESS          PIC X.
  2296         88  CLAIM-SESSION                   VALUE '1'.
  2297         88  CREDIT-SESSION                  VALUE '2'.
  2298         88  WARRANTY-SESSION                VALUE '3'.
  2299         88  MORTGAGE-SESSION                VALUE '4'.
  2300         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2301
  2302
  2303*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2304
  2305     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2306     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2307
  2308     12  PI-CREDIT-USER                  PIC X.
  2309         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2310         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2311
  2312     12  PI-CLAIM-USER                   PIC X.
  2313         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2314         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2315
  2316     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2317         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2318         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2319         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2320         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2321         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2322
  2323     12  PI-PROCESSOR-ID                 PIC X(4).
  2324
  2325     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2326
  2327     12  PI-MEMBER-CAPTION               PIC X(10).
  2328
  2329     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2330         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2331
  2332     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2333     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2334     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2335     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2336
  2337     12  PI-AH-OVERRIDE-L1               PIC X.
  2338     12  PI-AH-OVERRIDE-L2               PIC XX.
  2339     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2340     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2341
  2342     12  PI-NEW-SYSTEM                   PIC X(2).
  2343
  2344     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2345     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2346         88  PI-USES-PAID-TO                 VALUE '1'.
  2347     12  PI-CRDTCRD-SYSTEM.
  2348         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  46
* EL6311.cbl
  2349             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2350             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2351         16  PI-CC-MONTH-END-DT          PIC XX.
  2352     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2353
  2354     12  PI-OE-REFERENCE-2.
  2355         16  PI-OE-REF-2-PRIME           PIC X(10).
  2356         16  PI-OE-REF-2-SUFF            PIC X.
  2357
  2358     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2359
  2360     12  PI-LANGUAGE-TYPE                PIC X.
  2361             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2362             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2363             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2364
  2365     12  PI-POLICY-LINKAGE-IND           PIC X.
  2366         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2367         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2368                                                   LOW-VALUES.
  2369
  2370     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2371     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2372         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2373         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2374
  2375     12  PI-PROCESSOR-CSR-IND            PIC X.
  2376         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2377         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2378
  2379     12  FILLER                          PIC X(3).
  2380
  2381     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2382
  2383     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2384         PI-SYSTEM-LEVEL.
  2385
  2386         16  PI-ENTRY-CODES.
  2387             20  PI-ENTRY-CD-1           PIC X.
  2388             20  PI-ENTRY-CD-2           PIC X.
  2389
  2390         16  PI-RETURN-CODES.
  2391             20  PI-RETURN-CD-1          PIC X.
  2392             20  PI-RETURN-CD-2          PIC X.
  2393
  2394         16  PI-UPDATE-STATUS-SAVE.
  2395             20  PI-UPDATE-BY            PIC X(4).
  2396             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2397
  2398         16  PI-LOWER-CASE-LETTERS       PIC X.
  2399             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2400
  2401*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2402*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2403*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2404
  2405         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2406             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  47
* EL6311.cbl
  2407             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2408             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2409             88  ACCNT-CNTL                  VALUE '3'.
  2410             88  CARR-ACCNT-CNTL             VALUE '4'.
  2411
  2412         16  PI-PROCESSOR-CAP-LIST.
  2413             20  PI-SYSTEM-CONTROLS.
  2414                24 PI-SYSTEM-DISPLAY     PIC X.
  2415                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2416                24 PI-SYSTEM-MODIFY      PIC X.
  2417                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2418             20  FILLER                  PIC XX.
  2419             20  PI-DISPLAY-CAP          PIC X.
  2420                 88  DISPLAY-CAP             VALUE 'Y'.
  2421             20  PI-MODIFY-CAP           PIC X.
  2422                 88  MODIFY-CAP              VALUE 'Y'.
  2423             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2424                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2425             20  PI-FORCE-CAP            PIC X.
  2426                 88  FORCE-CAP               VALUE 'Y'.
  2427
  2428         16  PI-PROGRAM-CONTROLS.
  2429             20  PI-PGM-PRINT-OPT        PIC X.
  2430             20  PI-PGM-FORMAT-OPT       PIC X.
  2431             20  PI-PGM-PROCESS-OPT      PIC X.
  2432             20  PI-PGM-TOTALS-OPT       PIC X.
  2433
  2434         16  PI-HELP-INTERFACE.
  2435             20  PI-LAST-ERROR-NO        PIC X(4).
  2436             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2437
  2438         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2439             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2440
  2441         16  PI-CR-CONTROL-IN-PROGRESS.
  2442             20  PI-CR-CARRIER           PIC X.
  2443             20  PI-CR-GROUPING          PIC X(6).
  2444             20  PI-CR-STATE             PIC XX.
  2445             20  PI-CR-ACCOUNT           PIC X(10).
  2446             20  PI-CR-FIN-RESP          PIC X(10).
  2447             20  PI-CR-TYPE              PIC X.
  2448
  2449         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2450
  2451         16  PI-CR-MONTH-END-DT          PIC XX.
  2452
  2453         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2454             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2455             88  PI-ZERO-CARRIER             VALUE '1'.
  2456             88  PI-ZERO-GROUPING            VALUE '2'.
  2457             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2458
  2459         16  PI-CARRIER-SECURITY         PIC X.
  2460             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2461
  2462         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2463             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2464             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  48
* EL6311.cbl
  2465
  2466         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2467             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2468                                         INDEXED BY PI-ACCESS-NDX
  2469                                         PIC X.
  2470
  2471         16  PI-GA-BILLING-CONTROL       PIC X.
  2472             88  PI-GA-BILLING               VALUE '1'.
  2473
  2474         16  PI-MAIL-PROCESSING          PIC X.
  2475             88  PI-MAIL-YES                 VALUE 'Y'.
  2476
  2477         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2478
  2479         16  PI-AR-SYSTEM.
  2480             20  PI-AR-PROCESSING-CNTL   PIC X.
  2481                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2482             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2483             20  PI-AR-MONTH-END-DT      PIC XX.
  2484
  2485         16  PI-MP-SYSTEM.
  2486             20  PI-MORTGAGE-USER            PIC X.
  2487                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2488                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2489             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2490                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2491                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2492                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2493                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2494                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2495             20  PI-MP-MONTH-END-DT          PIC XX.
  2496             20  PI-MP-REFERENCE-NO.
  2497                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2498                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2499
  2500         16  PI-LABEL-CONTROL            PIC X(01).
  2501             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2502             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2503
  2504         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2505             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2506
  2507         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2508             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2509             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2510
  2511         16  FILLER                      PIC X(14).
  2512
  2513     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2514******************************************************************
  2515
  2516     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2517*    COPY ELC631PI.
  2518******************************************************************
  2519*                                                                *
  2520*                                                                *
  2521*                            ELC631PI                            *
  2522*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  49
* EL6311.cbl
  2523*                                                                *
  2524*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2525*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2526*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2527*                                                                *
  2528*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2529*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2530*    BETWEEN PROGRAMS.                                           *
  2531*                                                                *
  2532*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2533*                                                                *
  2534*               EL631 - EL6311 - EL6312 - EL6313                 *
  2535*                                                                *
  2536******************************************************************
  2537*                   C H A N G E   L O G
  2538*
  2539* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2540*-----------------------------------------------------------------
  2541*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2542* EFFECTIVE    NUMBER
  2543*-----------------------------------------------------------------
  2544* 021414    2003053000001  PEMA  changes for auto chk request
  2545******************************************************************
  2546
  2547         16  PI-631-DATA.
  2548             20  PI-ERPNDB-KEY.
  2549                 24  PI-PB-COMPANY-CD     PIC X.
  2550                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2551                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2552                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2553
  2554             20  PI-ERPNDB-ALT-KEY.
  2555                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2556                 24  PI-PB-CARRIER        PIC X.
  2557                 24  PI-PB-GROUPING       PIC X(6).
  2558                 24  PI-PB-STATE          PIC XX.
  2559                 24  PI-PB-ACCOUNT        PIC X(10).
  2560                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2561                 24  PI-PB-CERT-NO.
  2562                     28  PI-PB-CERT-PRIME PIC X(10).
  2563                     28  PI-PB-CERT-SFX   PIC X.
  2564                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2565                 24  PI-PB-RECORD-TYPE    PIC X.
  2566
  2567             20  PI-ERPNDB-CSR-KEY.
  2568                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2569                 24  PI-PB-CSR-ID             PIC X(4).
  2570                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2571                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2572                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2573
  2574             20  PI-BROWSE-TYPE               PIC X.
  2575                 88  PI-FILE-BROWSE             VALUE ' '.
  2576                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2577                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2578                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2579                 88  PI-CSR-BROWSE              VALUE '4'.
  2580
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  50
* EL6311.cbl
  2581             20  PI-MAINT-FUNCTION            PIC X.
  2582                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2583                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2584                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2585                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2586                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2587                 88  PI-PF5-FUNCTION            VALUE '5'.
  2588                 88  PI-PF6-FUNCTION            VALUE '6'.
  2589
  2590             20  PI-FILE-SWITCHES.
  2591                 24  PI-ALL-ISSUES-SW         PIC X.
  2592                     88  ALL-ISSUES             VALUE 'Y'.
  2593                 24  PI-ALL-CANCELS-SW        PIC X.
  2594                     88  ALL-CANCELS            VALUE 'Y'.
  2595                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2596                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2597                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2598                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2599                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2600                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2601                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2602                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2603                 24  PI-HOLD-REC-SW           PIC X.
  2604                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2605                 24  PI-CHANGE-REC-SW         PIC X.
  2606                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2607                 24  PI-CHK-REQ-REC-SW        PIC X.
  2608                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2609                 24  PI-ISSUE-WARNING-SW      PIC X.
  2610                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2611                 24  PI-CANCEL-WARNING-SW     PIC X.
  2612                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2613             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2614                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2615             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2616                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2617
  2618             20  PI-MAP-NAME                  PIC X(8).
  2619
  2620             20  PI-CURSOR                    PIC S9(4) COMP.
  2621
  2622             20  PI-PREV-ALT-KEY              PIC X(36).
  2623             20  PI-PREV-CSR-KEY              PIC X(15).
  2624             20  PI-PREV-KEY.
  2625                 24  PI-PREV-COMPANY-CD       PIC X.
  2626                 24  PI-PREV-BATCH            PIC X(6).
  2627                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2628                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2629             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2630             20  PI-BROWSE-SW                 PIC X.
  2631                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2632                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2633             20  PI-SV-CARRIER                PIC X.
  2634             20  PI-SV-GROUPING               PIC X(6).
  2635             20  PI-SV-STATE                  PIC XX.
  2636             20  PI-EDIT-SW                   PIC X.
  2637             20  PI-DISPLAY-SW                PIC XX.
  2638                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  51
* EL6311.cbl
  2639                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2640             20  PI-CRITERIA-DATA             PIC X(350).
  2641             20  PI-BMODE                     PIC X.
  2642             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2643             20  PI-BPMTS                     PIC S999     COMP-3.
  2644             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2645             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2646             20  PI-CSR-SESSION-SW            PIC X.
  2647                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2648             20  PI-ERRORS-SW                 PIC X.
  2649                 88  FATAL-ERRORS               VALUE 'X'.
  2650*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2651             20  pi-unforced-sw               pic x.
  2652                 88  unforced-errors            value 'X'.
  2653             20  FILLER                       PIC X(4).
  2654
  2655        16  FILLER             PIC X(94).
  2656
  2657 01  W-LETTER-COMMUNICATION-AREAS.
  2658*    COPY ELC1042.
  2659******************************************************************
  2660*                                                                *
  2661*                                                                *
  2662*                           ELC1042                              *
  2663*                            VMOD=2.002                          *
  2664*                                                                *
  2665*    NOTE                                                        *
  2666*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2667*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2668*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2669*        TO THESE PROGRAMS.                                      *
  2670*                                                                *
  2671*    NOTE                                                        *
  2672*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2673*        USE ONLY!                                               *
  2674*                                                                *
  2675******************************************************************
  2676
  2677         16  PI-1042-WA.
  2678             20  PI-ACTION       PIC  X(01).
  2679                 88 PI-SHOW-MODE           VALUE '1'.
  2680                 88 PI-CLEAR-MODE          VALUE '2'.
  2681                 88 PI-CREATE-MODE         VALUE '3'.
  2682             20  PI-COMM-CONTROL PIC  X(12).
  2683             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2684             20  PI-EOF-SW       PIC  X(01).
  2685                 88  PI-FILE-EOF           VALUE 'Y'.
  2686             20  PI-FILETYP      PIC  X(01).
  2687             20  PI-FORM-SQUEEZE-CONTROL
  2688                                 PIC  X(01).
  2689                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2690                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2691             20  PI-LAST-CONTROL PIC  X(12).
  2692             20  PI-TEMP-STOR-ITEMS
  2693                                 PIC S9(04) COMP.
  2694             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2695             20  PI-UPDATE-SW    PIC  9(01).
  2696                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  52
* EL6311.cbl
  2697             20  PI-104-SCREEN-SENT-IND
  2698                                 PIC  X(01).
  2699                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2700                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2701             20  PI-1042-SCREEN-SENT-IND
  2702                                 PIC  X(01).
  2703                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2704                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2705             20  PI-1042-ARCHIVE-IND
  2706                                 PIC  X(01).
  2707                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2708             20  FILLER          PIC  X(29).
  2709*    COPY ELC689PI.
  2710******************************************************************
  2711*                                                                *
  2712*                            ELC689PI                            *
  2713*                            VMOD=2.003                          *
  2714*                                                                *
  2715*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2716*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2717*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2718*                                                                *
  2719*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2720*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2721*    BETWEEN PROGRAMS.                                           *
  2722*                                                                *
  2723*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2724*                                                                *
  2725*               EL631 - EL689  - EL6891 - EL6892                 *
  2726*                                                                *
  2727******************************************************************
  2728*                   C H A N G E   L O G
  2729*
  2730* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2731*-----------------------------------------------------------------
  2732*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2733* EFFECTIVE    NUMBER
  2734*-----------------------------------------------------------------
  2735* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2736* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2737* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2738******************************************************************
  2739
  2740
  2741         16  PI-689-WORK-AREA.
  2742             20  PI-689-ALT-PRINTER-ID
  2743                                 PIC  X(04).
  2744             20  PI-689-ARCHIVE-NUMBER
  2745                                 PIC  9(08).
  2746             20  PI-689-ARCHIVE-SW
  2747                                 PIC  X(01).
  2748                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2749             20  PI-689-DATA-SOURCE
  2750                                 PIC  X(01).
  2751                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2752                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2753                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2754                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  53
* EL6311.cbl
  2755                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2756             20  PI-689-ERROR-IND
  2757                                 PIC  X(01).
  2758                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2759             20  PI-689-ERROR    PIC  9(04).
  2760                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2761                 88  PI-689-FATAL-ERROR
  2762                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2763                            0042 0047 0051 0066 0067 0070
  2764                            0168 0169 0174 0175 0176 0177 0179
  2765                            0180 0181 0182 0184 0185 0189 0190
  2766                            0191
  2767                            0215 0279 0280
  2768                            0412 0413 0454
  2769                            0533 0537
  2770                            2055 2114 2208 2209 2216 2232 2369
  2771                            2398 2433 2908 2999
  2772                            3000 3770 3771 3775
  2773                            7250 7365 7367 7368 7369 7370 7371
  2774                            7272 7373 7374 7376 7377 7378 7379
  2775                            7381 7388 7390 7393 7395 7396 7398
  2776                            9095 9096 9281 9298 9299 9320 9327
  2777                            9426 9427.
  2778                 88  PI-689-STOP-ERROR
  2779                     VALUES 0004 0008 0013 0023 0029 0033
  2780                            0042 0047 0066 0067 0070
  2781                            0168 0169 0174 0175 0176 0177
  2782                            0181 0182 0184 0185 0189 0190
  2783                            0279 0280
  2784                            0412 0413 0454
  2785                            2055 2208 2209 2216 2232
  2786                            2398 2999
  2787                            3000 3770 3771 3775
  2788                            7250 7365 7369 7370 7371
  2789                            7272 7373 7374 7376 7377 7378 7379
  2790                            7381 7388 7390 7393 7396 7398
  2791                            9095 9096 9299 9320 9426.
  2792             20  PI-689-FOLLOW-UP-DATE
  2793                                 PIC  X(02).
  2794             20  PI-689-FORM-NUMBER
  2795                                 PIC  X(04).
  2796             20  PI-689-LABEL-SOURCE
  2797                                 PIC X(01).
  2798                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2799                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2800                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2801                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2802                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2803                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2804                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2805             20  PI-689-NUMBER-COPIES
  2806                                 PIC  9(01).
  2807             20  PI-689-NUMBER-LABEL-LINES
  2808                                 PIC  9(01).
  2809             20  PI-689-NUMBER-TEXT-RECORDS
  2810                                 PIC  9(03).
  2811             20  PI-689-PRINT-ORDER-SW
  2812                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  54
* EL6311.cbl
  2813                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2814                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2815                 88  PI-689-PRINT-LATER     VALUE '3'.
  2816                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2817             20  PI-689-PRINT-RESTRICTION
  2818                                 PIC  X(01).
  2819                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2820                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2821                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2822             20  PI-689-PRINT-SW PIC  X(01).
  2823                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2824             20  PI-689-RESEND-DATE-1
  2825                                 PIC  X(02).
  2826             20  PI-689-RESEND-LETR-1
  2827                                 PIC X(4).
  2828             20  PI-689-TEMP-STOR-ID
  2829                                 PIC  X(08).
  2830             20  PI-689-USE-SCREEN-IND
  2831                                 PIC  X(01).
  2832                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2833             20  PI-689-ARCH-POINTER
  2834                                 PIC S9(08) COMP.
  2835                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2836             20  PI-689-ARCT-POINTER
  2837                                 PIC S9(08) COMP.
  2838                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2839             20  PI-689-VARIABLE-DATA-GRP.
  2840                 24  PI-689-VARIABLE-DATA-1
  2841                                 PIC  X(30).
  2842                 24  PI-689-VARIABLE-DATA-2
  2843                                 PIC  X(30).
  2844                 24  PI-689-VARIABLE-DATA-3
  2845                                 PIC  X(30).
  2846                 24  PI-689-VARIABLE-DATA-4
  2847                                 PIC  X(30).
  2848
  2849         16  PI-689-KEY-DATA-FIELDS.
  2850             20  PI-689-ACCOUNT  PIC  X(10).
  2851             20  PI-689-CARRIER  PIC  X(01).
  2852             20  PI-689-CERT-NO.
  2853                 24  PI-689-CERT-PRIME
  2854                                 PIC  X(10).
  2855                 24  PI-689-CERT-SFX
  2856                                 PIC  X(01).
  2857             20  PI-689-CHG-SEQ-NO
  2858                                 PIC S9(04)    COMP.
  2859             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2860                                 PIC  X(02).
  2861             20  PI-689-ENTRY-BATCH
  2862                                 PIC  X(06).
  2863             20  PI-689-EFF-DATE PIC  X(02).
  2864             20  PI-689-EXP-DATE PIC  X(02).
  2865             20  PI-689-GROUPING PIC  X(06).
  2866             20  PI-689-RESP-PERSON
  2867                                 PIC  X(10).
  2868             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2869             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2870                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  55
* EL6311.cbl
  2871             20  PI-689-STATE    PIC  X(02).
  2872             20  PI-689-TYPE     PIC  X(01).
  2873             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2874             20  PI-689-ALT-SEQ-NO
  2875                                 PIC S9(04)    COMP.
  2876         16  PI-689-DATE-EDIT    PIC  X(08).
  2877         16  PI-689-FOLLOW-UP-EDIT
  2878                                 PIC  X(08).
  2879         16  PI-689-RESEND1-EDIT PIC  X(08).
  2880         16  PI-689-SEQ-EDIT     PIC  X(08).
  2881         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2882         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2883             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2884         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2885         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  56
* EL6311.cbl
  2887
  2888 01  WS-EL6315-PASS-AREA.
  2889        16  PI-6315-ISS-CAN-SW      PIC X.
  2890        16  FILLER                  PIC X(120).
  2891        16  PI-RES-REF-CLM-TYPE     PIC X.
  2892        16  FILLER                  PIC X.
  2893        16  PI-6315-PASS-AREA.
  2894            20 FILLER               PIC X(236).
  2895            20 PI-6315-FINALIZED    PIC X.
  2896            20 FILLER               PIC X(280).
  2897
  2898 01  WS-EL6316-PASS-AREA.
  2899        16  PI-ISS-CAN-SW           PIC X.
  2900        16  FILLER                  PIC X(121).
  2901        16  PI-CLM-RESC-IND         PIC X.
  2902        16  PI-6316-PASS-AREA.
  2903            20 FILLER               PIC X(236).
  2904            20 PI-6316-FINALIZED    PIC X.
  2905            20 FILLER               PIC X(280).
  2906
  2907******************************************************************
  2908*                                                                *
  2909*         P A S S   A R E A   F O R   E D I T                    *
  2910*                                                                *
  2911******************************************************************
  2912
  2913 01  PASSED-RECORD.
  2914     12  RECORD-SAVE                  PIC X(585).
  2915* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2916*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2917*                    BY  WK-CURRENT-DATE.
  2918******************************************************************
  2919*                                                                *
  2920*                                                                *
  2921*                             ELC50W1                            *
  2922*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2923*                            VMOD=2.004                          *
  2924*                                                                *
  2925*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2926*                                                                *
  2927*                                                                *
  2928******************************************************************
  2929
  2930     12  WK-WORK-AREA.
  2931         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2932         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2933         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2934         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2935         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2936         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2937         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2938         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2939         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2940         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2941         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2942         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2943         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2944         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  57
* EL6311.cbl
  2945         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2946         16  WK-CREDIT-EDIT-CONTROLS.
  2947             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2948             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2949             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2950             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2951             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2952             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2953         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2954         16  WK-SAVE-REIN-DATA.
  2955             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2956             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2957             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2958         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2959             88  ENTRY-FROM-EL6311       VALUE '6'.
  2960         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2961         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2962     12  WK-RECORD-ADDRESSES.
  2963         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2964         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2965         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2966         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2967         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2968         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2969         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2970         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2971     12  WK-OVER-SHORT-AREA.
  2972         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2973         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2974         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2975             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2976         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  58
* EL6311.cbl
  2978
  2979*    COPY ELCEDITC.
  2980******************************************************************
  2981*                                                                *
  2982*                                                                *
  2983*                            ELCEDITC                            *
  2984*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2985*                            VMOD=2.012                          *
  2986*                                                                *
  2987*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  2988*                     EL6313, EL050 AND EL517.                   *
  2989*                                                                *
  2990******************************************************************
  2991******************************************************************
  2992*                   C H A N G E   L O G
  2993*
  2994* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2995*-----------------------------------------------------------------
  2996*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2997* EFFECTIVE    NUMBER
  2998*-----------------------------------------------------------------
  2999* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3000******************************************************************
  3001
  3002     12  EDIT-CRITERIA-DATA.
  3003         16  EC-CO-MONTH-END-DT       PIC XX.
  3004         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3005         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3006         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3007         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3008         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3009         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3010         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3011         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3012         16  EC-CO-REM-TERM-CALC      PIC X.
  3013               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3014               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3015               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3016               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3017
  3018         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3019               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3020               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3021               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3022               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3023               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3024               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3025               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3026               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3027               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3028               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3029
  3030         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3031               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3032               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3033               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3034               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3035               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  59
* EL6311.cbl
  3036               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3037               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3038               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3039
  3040         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3041                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3042                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3043
  3044         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3045                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3046                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3047                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3048                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3049                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3050                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3051                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3052                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3053
  3054         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3055               88  EC-BR-REDUCING                   VALUE 'R'.
  3056               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3057
  3058         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3059         16  EC-BR-LF-DESC             PIC X(10).
  3060         16  EC-BR-AH-DESC             PIC X(10).
  3061         16  EC-BR-LF-COMMENT          PIC X(10).
  3062         16  EC-BR-AH-COMMENT          PIC X(10).
  3063
  3064         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3065               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3066               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3067               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3068               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3069
  3070         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3071               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3072               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3073               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3074               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3075
  3076         16  EC-BR-LF-REFUND-CALC      PIC X.
  3077                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3078                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3079                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3080                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3081                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3082                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3083                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3084
  3085         16  EC-BR-AH-REFUND-CALC      PIC X.
  3086                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3087                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3088                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3089                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3090                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3091                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3092                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3093                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  60
* EL6311.cbl
  3094
  3095         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3096                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3097                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3098                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3099
  3100         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3101                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3102                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3103                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3104
  3105         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3106         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3107         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3108         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3109
  3110         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3111         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3112                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3113                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3114                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3115                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3116
  3117         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3118               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3119               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3120               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3121               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3122               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3123
  3124         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3125               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3126               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3127               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3128               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3129               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3130
  3131         16  EC-ST-LF-REFUND-CALC      PIC X.
  3132                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3133                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3134                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3135                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3136                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3137                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3138                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3139                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3140
  3141         16  EC-ST-AH-REFUND-CALC      PIC X.
  3142                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3143                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3144                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3145                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3146                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3147                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3148                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3149                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3150
  3151         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  61
* EL6311.cbl
  3152         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3153         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3154         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3155         16  EC-AM-EXPIRATION-DT       PIC XX.
  3156         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3157         16  EC-AM-CLASS-CD            PIC XX.
  3158         16  EC-AM-LF-DEVIATION        PIC XXX.
  3159         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3160         16  EC-AM-AH-DEVIATION        PIC XXX.
  3161         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3162         16  EC-AM-PHONE-NO            PIC X(10).
  3163
  3164         16  EC-AM-LF-REFUND-CALC      PIC X.
  3165                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3166                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3167                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3168                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3169                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3170                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3171                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3172
  3173         16  EC-AM-AH-REFUND-CALC      PIC X.
  3174                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3175                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3176                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3177                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3178                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3179                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3180                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3181
  3182         16  EC-AM-BEN-I-G-CD          PIC X.
  3183                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3184                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3185                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3186
  3187         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3188         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3189         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3190         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3191         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3192         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3193         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3194         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3195         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3196
  3197         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3198         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3199         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3200         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3201         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3202         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3203         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3204         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3205         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3206         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3207         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3208         16  EC-RT-LF-NSP-ST           PIC XX.
  3209         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  62
* EL6311.cbl
  3210         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3211         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3212
  3213         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3214             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3215                                             'M' '5' '9' '2'.
  3216             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3217             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3218             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3219             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3220             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3221             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3222             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3223             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3224             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3225             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3226
  3227         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3228             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3229                                             'M' '5' '9' '2'.
  3230             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3231             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3232             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3233             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3234             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3235             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3236             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3237             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3238             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3239             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3240
  3241         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3242         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3243         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3244         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3245         16  EC-CM-DEATH-DT            PIC XX.
  3246
  3247*DMD CUSTOM CODING FIELDS BELOW
  3248*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3249         16  EC-BR-DMD-RATING-SW       PIC X.
  3250                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3251                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3252                 88  NO-DMD-RATING               VALUE 'N'.
  3253
  3254         16  EC-NEW-CERT               PIC X(11).
  3255         16  EC-NEW-STATE              PIC XX.
  3256         16  FILLER                    PIC X.
  3257*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3258         16  OVER-SHORT-EDIT-FIELDS.
  3259             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3260             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3261             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3262             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3263             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3264             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3265             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3266             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3267             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  63
* EL6311.cbl
  3268         16  FILLER                    PIC X(71).
  3269
  3270******************************************************************
  3271
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  64
* EL6311.cbl
  3273
  3274*    COPY ELCJPFX.
  3275******************************************************************
  3276*                                                                *
  3277*                                                                *
  3278*                            ELCJPFX.                            *
  3279*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3280*                            VMOD=2.002                          *
  3281*                                                                *
  3282*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3283*                                                                *
  3284*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3285*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3286*        ELCNTL - CONTROL FILE                                   *
  3287*        ELMSTR - CLAIM MASTERS                                  *
  3288*        ELTRLR - ACTIVITY TRAILERS                              *
  3289*        ELCHKQ - CHECK QUE                                      *
  3290******************************************************************
  3291 01  JOURNAL-RECORD.
  3292     12  jp-date                     pic s9(5) comp-3.
  3293     12  jp-time                     pic s9(7) comp-3.
  3294     12  JP-USER-ID                  PIC X(4).
  3295     12  JP-FILE-ID                  PIC X(8).
  3296     12  JP-PROGRAM-ID               PIC X(8).
  3297     12  JP-RECORD-TYPE              PIC X.
  3298         88 JP-ADD              VALUE 'A'.
  3299         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3300         88 JP-AFTER-CHANGE     VALUE 'C'.
  3301         88 JP-DELETE           VALUE 'D'.
  3302         88 JP-GENERIC-DELETE   VALUE 'G'.
  3303         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3304         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3305     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3306     12  JP-RECORD-AREA
  3307
  3308
  3309                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  65
* EL6311.cbl
  3311*    COPY ELCAID.
  3312******************************************************************
  3313*                                                                *
  3314*                            ELCAID.                             *
  3315*                            VMOD=2.001                          *
  3316*                                                                *
  3317*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3318*                                                                *
  3319*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3320*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3321******************************************************************
  3322
  3323 01  DFHAID.
  3324   02  DFHNULL   PIC  X  VALUE  ' '.
  3325   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3326   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3327   02  DFHPEN    PIC  X  VALUE  '='.
  3328   02  DFHOPID   PIC  X  VALUE  'W'.
  3329   02  DFHPA1    PIC  X  VALUE  '%'.
  3330   02  DFHPA2    PIC  X  VALUE  '>'.
  3331   02  DFHPA3    PIC  X  VALUE  ','.
  3332   02  DFHPF1    PIC  X  VALUE  '1'.
  3333   02  DFHPF2    PIC  X  VALUE  '2'.
  3334   02  DFHPF3    PIC  X  VALUE  '3'.
  3335   02  DFHPF4    PIC  X  VALUE  '4'.
  3336   02  DFHPF5    PIC  X  VALUE  '5'.
  3337   02  DFHPF6    PIC  X  VALUE  '6'.
  3338   02  DFHPF7    PIC  X  VALUE  '7'.
  3339   02  DFHPF8    PIC  X  VALUE  '8'.
  3340   02  DFHPF9    PIC  X  VALUE  '9'.
  3341   02  DFHPF10   PIC  X  VALUE  ':'.
  3342   02  DFHPF11   PIC  X  VALUE  '#'.
  3343   02  DFHPF12   PIC  X  VALUE  '@'.
  3344   02  DFHPF13   PIC  X  VALUE  'A'.
  3345   02  DFHPF14   PIC  X  VALUE  'B'.
  3346   02  DFHPF15   PIC  X  VALUE  'C'.
  3347   02  DFHPF16   PIC  X  VALUE  'D'.
  3348   02  DFHPF17   PIC  X  VALUE  'E'.
  3349   02  DFHPF18   PIC  X  VALUE  'F'.
  3350   02  DFHPF19   PIC  X  VALUE  'G'.
  3351   02  DFHPF20   PIC  X  VALUE  'H'.
  3352   02  DFHPF21   PIC  X  VALUE  'I'.
  3353*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3354   02  DFHPF22   PIC  X  VALUE  '['.
  3355   02  DFHPF23   PIC  X  VALUE  '.'.
  3356   02  DFHPF24   PIC  X  VALUE  '<'.
  3357   02  DFHMSRE   PIC  X  VALUE  'X'.
  3358   02  DFHSTRF   PIC  X  VALUE  'h'.
  3359   02  DFHTRIG   PIC  X  VALUE  '"'.
  3360
  3361 01  FILLER    REDEFINES DFHAID.
  3362     12  FILLER              PIC X(8).
  3363     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3364
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  66
* EL6311.cbl
  3366*    COPY EL6311S.
  3367 01  EL631BI.
  3368     05  FILLER            PIC  X(0012).
  3369*    -------------------------------
  3370     05  BDATEL PIC S9(0004) COMP.
  3371     05  BDATEF PIC  X(0001).
  3372     05  FILLER REDEFINES BDATEF.
  3373         10  BDATEA PIC  X(0001).
  3374     05  BDATEI PIC  X(0008).
  3375*    -------------------------------
  3376     05  BTIMEL PIC S9(0004) COMP.
  3377     05  BTIMEF PIC  X(0001).
  3378     05  FILLER REDEFINES BTIMEF.
  3379         10  BTIMEA PIC  X(0001).
  3380     05  BTIMEI PIC  X(0005).
  3381*    -------------------------------
  3382     05  BHEADL PIC S9(0004) COMP.
  3383     05  BHEADF PIC  X(0001).
  3384     05  FILLER REDEFINES BHEADF.
  3385         10  BHEADA PIC  X(0001).
  3386     05  BHEADI PIC  X(0038).
  3387*    -------------------------------
  3388     05  BNCERTLL PIC S9(0004) COMP.
  3389     05  BNCERTLF PIC  X(0001).
  3390     05  FILLER REDEFINES BNCERTLF.
  3391         10  BNCERTLA PIC  X(0001).
  3392     05  BNCERTLI PIC  X(0008).
  3393*    -------------------------------
  3394     05  BNCERTL PIC S9(0004) COMP.
  3395     05  BNCERTF PIC  X(0001).
  3396     05  FILLER REDEFINES BNCERTF.
  3397         10  BNCERTA PIC  X(0001).
  3398     05  BNCERTI PIC  X(0011).
  3399*    -------------------------------
  3400     05  BNSTATLL PIC S9(0004) COMP.
  3401     05  BNSTATLF PIC  X(0001).
  3402     05  FILLER REDEFINES BNSTATLF.
  3403         10  BNSTATLA PIC  X(0001).
  3404     05  BNSTATLI PIC  X(0009).
  3405*    -------------------------------
  3406     05  BNSTATL PIC S9(0004) COMP.
  3407     05  BNSTATF PIC  X(0001).
  3408     05  FILLER REDEFINES BNSTATF.
  3409         10  BNSTATA PIC  X(0001).
  3410     05  BNSTATI PIC  X(0002).
  3411*    -------------------------------
  3412     05  BCHGTL PIC S9(0004) COMP.
  3413     05  BCHGTF PIC  X(0001).
  3414     05  FILLER REDEFINES BCHGTF.
  3415         10  BCHGTA PIC  X(0001).
  3416     05  BCHGTI PIC  X(0004).
  3417*    -------------------------------
  3418     05  BCHGL PIC S9(0004) COMP.
  3419     05  BCHGF PIC  X(0001).
  3420     05  FILLER REDEFINES BCHGF.
  3421         10  BCHGA PIC  X(0001).
  3422     05  BCHGI PIC  X(0004).
  3423*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  67
* EL6311.cbl
  3424     05  BMAINTL PIC S9(0004) COMP.
  3425     05  BMAINTF PIC  X(0001).
  3426     05  FILLER REDEFINES BMAINTF.
  3427         10  BMAINTA PIC  X(0001).
  3428     05  BMAINTI PIC  X(0001).
  3429*    -------------------------------
  3430     05  BMANTBYL PIC S9(0004) COMP.
  3431     05  BMANTBYF PIC  X(0001).
  3432     05  FILLER REDEFINES BMANTBYF.
  3433         10  BMANTBYA PIC  X(0001).
  3434     05  BMANTBYI PIC  X(0004).
  3435*    -------------------------------
  3436     05  BCHGHDGL PIC S9(0004) COMP.
  3437     05  BCHGHDGF PIC  X(0001).
  3438     05  FILLER REDEFINES BCHGHDGF.
  3439         10  BCHGHDGA PIC  X(0001).
  3440     05  BCHGHDGI PIC  X(0003).
  3441*    -------------------------------
  3442     05  BMANTDTL PIC S9(0004) COMP.
  3443     05  BMANTDTF PIC  X(0001).
  3444     05  FILLER REDEFINES BMANTDTF.
  3445         10  BMANTDTA PIC  X(0001).
  3446     05  BMANTDTI PIC  X(0008).
  3447*    -------------------------------
  3448     05  BMANTATL PIC S9(0004) COMP.
  3449     05  BMANTATF PIC  X(0001).
  3450     05  FILLER REDEFINES BMANTATF.
  3451         10  BMANTATA PIC  X(0001).
  3452     05  BMANTATI PIC  X(0005).
  3453*    -------------------------------
  3454     05  BCSRL PIC S9(0004) COMP.
  3455     05  BCSRF PIC  X(0001).
  3456     05  FILLER REDEFINES BCSRF.
  3457         10  BCSRA PIC  X(0001).
  3458     05  BCSRI PIC  X(0004).
  3459*    -------------------------------
  3460     05  BBATCHL PIC S9(0004) COMP.
  3461     05  BBATCHF PIC  X(0001).
  3462     05  FILLER REDEFINES BBATCHF.
  3463         10  BBATCHA PIC  X(0001).
  3464     05  BBATCHI PIC  X(0006).
  3465*    -------------------------------
  3466     05  BSEQL PIC S9(0004) COMP.
  3467     05  BSEQF PIC  X(0001).
  3468     05  FILLER REDEFINES BSEQF.
  3469         10  BSEQA PIC  X(0001).
  3470     05  BSEQI PIC  X(0004).
  3471*    -------------------------------
  3472     05  BMOENDTL PIC S9(0004) COMP.
  3473     05  BMOENDTF PIC  X(0001).
  3474     05  FILLER REDEFINES BMOENDTF.
  3475         10  BMOENDTA PIC  X(0001).
  3476     05  BMOENDTI PIC  X(0008).
  3477*    -------------------------------
  3478     05  BCARRL PIC S9(0004) COMP.
  3479     05  BCARRF PIC  X(0001).
  3480     05  FILLER REDEFINES BCARRF.
  3481         10  BCARRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  68
* EL6311.cbl
  3482     05  BCARRI PIC  X(0001).
  3483*    -------------------------------
  3484     05  BGROUPL PIC S9(0004) COMP.
  3485     05  BGROUPF PIC  X(0001).
  3486     05  FILLER REDEFINES BGROUPF.
  3487         10  BGROUPA PIC  X(0001).
  3488     05  BGROUPI PIC  X(0006).
  3489*    -------------------------------
  3490     05  BSTATEL PIC S9(0004) COMP.
  3491     05  BSTATEF PIC  X(0001).
  3492     05  FILLER REDEFINES BSTATEF.
  3493         10  BSTATEA PIC  X(0001).
  3494     05  BSTATEI PIC  X(0002).
  3495*    -------------------------------
  3496     05  BACCTL PIC S9(0004) COMP.
  3497     05  BACCTF PIC  X(0001).
  3498     05  FILLER REDEFINES BACCTF.
  3499         10  BACCTA PIC  X(0001).
  3500     05  BACCTI PIC  X(0010).
  3501*    -------------------------------
  3502     05  BVINHL PIC S9(0004) COMP.
  3503     05  BVINHF PIC  X(0001).
  3504     05  FILLER REDEFINES BVINHF.
  3505         10  BVINHA PIC  X(0001).
  3506     05  BVINHI PIC  X(0004).
  3507*    -------------------------------
  3508     05  BVINL PIC S9(0004) COMP.
  3509     05  BVINF PIC  X(0001).
  3510     05  FILLER REDEFINES BVINF.
  3511         10  BVINA PIC  X(0001).
  3512     05  BVINI PIC  X(0017).
  3513*    -------------------------------
  3514     05  BREFHDGL PIC S9(0004) COMP.
  3515     05  BREFHDGF PIC  X(0001).
  3516     05  FILLER REDEFINES BREFHDGF.
  3517         10  BREFHDGA PIC  X(0001).
  3518     05  BREFHDGI PIC  X(0004).
  3519*    -------------------------------
  3520     05  BREFL PIC S9(0004) COMP.
  3521     05  BREFF PIC  X(0001).
  3522     05  FILLER REDEFINES BREFF.
  3523         10  BREFA PIC  X(0001).
  3524     05  BREFI PIC  X(0012).
  3525*    -------------------------------
  3526     05  BAGEDEFL PIC S9(0004) COMP.
  3527     05  BAGEDEFF PIC  X(0001).
  3528     05  FILLER REDEFINES BAGEDEFF.
  3529         10  BAGEDEFA PIC  X(0001).
  3530     05  BAGEDEFI PIC  X(0004).
  3531*    -------------------------------
  3532     05  BCERTNOL PIC S9(0004) COMP.
  3533     05  BCERTNOF PIC  X(0001).
  3534     05  FILLER REDEFINES BCERTNOF.
  3535         10  BCERTNOA PIC  X(0001).
  3536     05  BCERTNOI PIC  X(0010).
  3537*    -------------------------------
  3538     05  BSUFIXL PIC S9(0004) COMP.
  3539     05  BSUFIXF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  69
* EL6311.cbl
  3540     05  FILLER REDEFINES BSUFIXF.
  3541         10  BSUFIXA PIC  X(0001).
  3542     05  BSUFIXI PIC  X(0001).
  3543*    -------------------------------
  3544     05  BEFFDTL PIC S9(0004) COMP.
  3545     05  BEFFDTF PIC  X(0001).
  3546     05  FILLER REDEFINES BEFFDTF.
  3547         10  BEFFDTA PIC  X(0001).
  3548     05  BEFFDTI PIC  X(0008).
  3549*    -------------------------------
  3550     05  BLSTNML PIC S9(0004) COMP.
  3551     05  BLSTNMF PIC  X(0001).
  3552     05  FILLER REDEFINES BLSTNMF.
  3553         10  BLSTNMA PIC  X(0001).
  3554     05  BLSTNMI PIC  X(0015).
  3555*    -------------------------------
  3556     05  B1STNML PIC S9(0004) COMP.
  3557     05  B1STNMF PIC  X(0001).
  3558     05  FILLER REDEFINES B1STNMF.
  3559         10  B1STNMA PIC  X(0001).
  3560     05  B1STNMI PIC  X(0010).
  3561*    -------------------------------
  3562     05  BINITL PIC S9(0004) COMP.
  3563     05  BINITF PIC  X(0001).
  3564     05  FILLER REDEFINES BINITF.
  3565         10  BINITA PIC  X(0001).
  3566     05  BINITI PIC  X(0001).
  3567*    -------------------------------
  3568     05  BSEXL PIC S9(0004) COMP.
  3569     05  BSEXF PIC  X(0001).
  3570     05  FILLER REDEFINES BSEXF.
  3571         10  BSEXA PIC  X(0001).
  3572     05  BSEXI PIC  X(0001).
  3573*    -------------------------------
  3574     05  BAGEL PIC S9(0004) COMP.
  3575     05  BAGEF PIC  X(0001).
  3576     05  FILLER REDEFINES BAGEF.
  3577         10  BAGEA PIC  X(0001).
  3578     05  BAGEI PIC  X(0002).
  3579*    -------------------------------
  3580     05  BBIRTHL PIC S9(0004) COMP.
  3581     05  BBIRTHF PIC  X(0001).
  3582     05  FILLER REDEFINES BBIRTHF.
  3583         10  BBIRTHA PIC  X(0001).
  3584     05  BBIRTHI PIC  X(0008).
  3585*    -------------------------------
  3586     05  B1STPMTL PIC S9(0004) COMP.
  3587     05  B1STPMTF PIC  X(0001).
  3588     05  FILLER REDEFINES B1STPMTF.
  3589         10  B1STPMTA PIC  X(0001).
  3590     05  B1STPMTI PIC  X(0008).
  3591*    -------------------------------
  3592     05  BDAYSL PIC S9(0004) COMP.
  3593     05  BDAYSF PIC  X(0001).
  3594     05  FILLER REDEFINES BDAYSF.
  3595         10  BDAYSA PIC  X(0001).
  3596     05  BDAYSI PIC  X(0003).
  3597*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  70
* EL6311.cbl
  3598     05  BLNTRML PIC S9(0004) COMP.
  3599     05  BLNTRMF PIC  X(0001).
  3600     05  FILLER REDEFINES BLNTRMF.
  3601         10  BLNTRMA PIC  X(0001).
  3602     05  BLNTRMI PIC  X(0003).
  3603*    -------------------------------
  3604     05  BLNOFCRL PIC S9(0004) COMP.
  3605     05  BLNOFCRF PIC  X(0001).
  3606     05  FILLER REDEFINES BLNOFCRF.
  3607         10  BLNOFCRA PIC  X(0001).
  3608     05  BLNOFCRI PIC  X(0005).
  3609*    -------------------------------
  3610     05  BMODEL PIC S9(0004) COMP.
  3611     05  BMODEF PIC  X(0001).
  3612     05  FILLER REDEFINES BMODEF.
  3613         10  BMODEA PIC  X(0001).
  3614     05  BMODEI PIC  X(0001).
  3615*    -------------------------------
  3616     05  BFREQL PIC S9(0004) COMP.
  3617     05  BFREQF PIC  X(0001).
  3618     05  FILLER REDEFINES BFREQF.
  3619         10  BFREQA PIC  X(0001).
  3620     05  BFREQI PIC  X(0002).
  3621*    -------------------------------
  3622     05  BPMTSL PIC S9(0004) COMP.
  3623     05  BPMTSF PIC  X(0001).
  3624     05  FILLER REDEFINES BPMTSF.
  3625         10  BPMTSA PIC  X(0001).
  3626     05  BPMTSI PIC  999.
  3627*    -------------------------------
  3628     05  BPMTAMTL PIC S9(0004) COMP.
  3629     05  BPMTAMTF PIC  X(0001).
  3630     05  FILLER REDEFINES BPMTAMTF.
  3631         10  BPMTAMTA PIC  X(0001).
  3632     05  BPMTAMTI PIC  9(7)V99.
  3633*    -------------------------------
  3634     05  BAPRL PIC S9(0004) COMP.
  3635     05  BAPRF PIC  X(0001).
  3636     05  FILLER REDEFINES BAPRF.
  3637         10  BAPRA PIC  X(0001).
  3638     05  BAPRI PIC  X(7).
  3639*    -------------------------------
  3640     05  BLIVESL PIC S9(0004) COMP.
  3641     05  BLIVESF PIC  X(0001).
  3642     05  FILLER REDEFINES BLIVESF.
  3643         10  BLIVESA PIC  X(0001).
  3644     05  BLIVESI PIC  X(0009).
  3645*    -------------------------------
  3646     05  BMEMCAPL PIC S9(0004) COMP.
  3647     05  BMEMCAPF PIC  X(0001).
  3648     05  FILLER REDEFINES BMEMCAPF.
  3649         10  BMEMCAPA PIC  X(0001).
  3650     05  BMEMCAPI PIC  X(0011).
  3651*    -------------------------------
  3652     05  BORIGHDL PIC S9(0004) COMP.
  3653     05  BORIGHDF PIC  X(0001).
  3654     05  FILLER REDEFINES BORIGHDF.
  3655         10  BORIGHDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  71
* EL6311.cbl
  3656     05  BORIGHDI PIC  X(0009).
  3657*    -------------------------------
  3658     05  DMDBILL PIC S9(0004) COMP.
  3659     05  DMDBILF PIC  X(0001).
  3660     05  FILLER REDEFINES DMDBILF.
  3661         10  DMDBILA PIC  X(0001).
  3662     05  DMDBILI PIC  X(0006).
  3663*    -------------------------------
  3664     05  BFORCEL PIC S9(0004) COMP.
  3665     05  BFORCEF PIC  X(0001).
  3666     05  FILLER REDEFINES BFORCEF.
  3667         10  BFORCEA PIC  X(0001).
  3668     05  BFORCEI PIC  X(0001).
  3669*    -------------------------------
  3670     05  BENTRYL PIC S9(0004) COMP.
  3671     05  BENTRYF PIC  X(0001).
  3672     05  FILLER REDEFINES BENTRYF.
  3673         10  BENTRYA PIC  X(0001).
  3674     05  BENTRYI PIC  X(0001).
  3675*    -------------------------------
  3676     05  BREINL PIC S9(0004) COMP.
  3677     05  BREINF PIC  X(0001).
  3678     05  FILLER REDEFINES BREINF.
  3679         10  BREINA PIC  X(0001).
  3680     05  BREINI PIC  X(0001).
  3681*    -------------------------------
  3682     05  BBILCDL PIC S9(0004) COMP.
  3683     05  BBILCDF PIC  X(0001).
  3684     05  FILLER REDEFINES BBILCDF.
  3685         10  BBILCDA PIC  X(0001).
  3686     05  BBILCDI PIC  X(0001).
  3687*    -------------------------------
  3688     05  BUNWRITL PIC S9(0004) COMP.
  3689     05  BUNWRITF PIC  X(0001).
  3690     05  FILLER REDEFINES BUNWRITF.
  3691         10  BUNWRITA PIC  X(0001).
  3692     05  BUNWRITI PIC  X(0001).
  3693*    -------------------------------
  3694     05  BSKPCDL PIC S9(0004) COMP.
  3695     05  BSKPCDF PIC  X(0001).
  3696     05  FILLER REDEFINES BSKPCDF.
  3697         10  BSKPCDA PIC  X(0001).
  3698     05  BSKPCDI PIC  X(0001).
  3699*    -------------------------------
  3700     05  BINDGRPL PIC S9(0004) COMP.
  3701     05  BINDGRPF PIC  X(0001).
  3702     05  FILLER REDEFINES BINDGRPF.
  3703         10  BINDGRPA PIC  X(0001).
  3704     05  BINDGRPI PIC  X(0001).
  3705*    -------------------------------
  3706     05  BSIGL PIC S9(0004) COMP.
  3707     05  BSIGF PIC  X(0001).
  3708     05  FILLER REDEFINES BSIGF.
  3709         10  BSIGA PIC  X(0001).
  3710     05  BSIGI PIC  X(0001).
  3711*    -------------------------------
  3712     05  BRTCLSL PIC S9(0004) COMP.
  3713     05  BRTCLSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  72
* EL6311.cbl
  3714     05  FILLER REDEFINES BRTCLSF.
  3715         10  BRTCLSA PIC  X(0001).
  3716     05  BRTCLSI PIC  X(0002).
  3717*    -------------------------------
  3718     05  BCHGCNTL PIC S9(0004) COMP.
  3719     05  BCHGCNTF PIC  X(0001).
  3720     05  FILLER REDEFINES BCHGCNTF.
  3721         10  BCHGCNTA PIC  X(0001).
  3722     05  BCHGCNTI PIC  X(0003).
  3723*    -------------------------------
  3724     05  BMEMBERL PIC S9(0004) COMP.
  3725     05  BMEMBERF PIC  X(0001).
  3726     05  FILLER REDEFINES BMEMBERF.
  3727         10  BMEMBERA PIC  X(0001).
  3728     05  BMEMBERI PIC  X(0012).
  3729*    -------------------------------
  3730     05  BORGNOL PIC S9(0004) COMP.
  3731     05  BORGNOF PIC  X(0001).
  3732     05  FILLER REDEFINES BORGNOF.
  3733         10  BORGNOA PIC  X(0001).
  3734     05  BORGNOI PIC  X(0006).
  3735*    -------------------------------
  3736     05  BORGSEQL PIC S9(0004) COMP.
  3737     05  BORGSEQF PIC  X(0001).
  3738     05  FILLER REDEFINES BORGSEQF.
  3739         10  BORGSEQA PIC  X(0001).
  3740     05  BORGSEQI PIC  X(0004).
  3741*    -------------------------------
  3742     05  BBILLEDL PIC S9(0004) COMP.
  3743     05  BBILLEDF PIC  X(0001).
  3744     05  FILLER REDEFINES BBILLEDF.
  3745         10  BBILLEDA PIC  X(0001).
  3746     05  BBILLEDI PIC  9(9).
  3747*    -------------------------------
  3748     05  BKIND1L PIC S9(0004) COMP.
  3749     05  BKIND1F PIC  X(0001).
  3750     05  FILLER REDEFINES BKIND1F.
  3751         10  BKIND1A PIC  X(0001).
  3752     05  BKIND1I PIC  X(0002).
  3753*    -------------------------------
  3754     05  BTYPE1L PIC S9(0004) COMP.
  3755     05  BTYPE1F PIC  X(0001).
  3756     05  FILLER REDEFINES BTYPE1F.
  3757         10  BTYPE1A PIC  X(0001).
  3758     05  BTYPE1I PIC  X(0003).
  3759*    -------------------------------
  3760     05  BTERM1L PIC S9(0004) COMP.
  3761     05  BTERM1F PIC  X(0001).
  3762     05  FILLER REDEFINES BTERM1F.
  3763         10  BTERM1A PIC  X(0001).
  3764     05  BTERM1I PIC  X(0003).
  3765*    -------------------------------
  3766     05  BBEN1L PIC S9(0004) COMP.
  3767     05  BBEN1F PIC  X(0001).
  3768     05  FILLER REDEFINES BBEN1F.
  3769         10  BBEN1A PIC  X(0001).
  3770     05  BBEN1I PIC  X(0012).
  3771*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  73
* EL6311.cbl
  3772     05  BPREM1L PIC S9(0004) COMP.
  3773     05  BPREM1F PIC  X(0001).
  3774     05  FILLER REDEFINES BPREM1F.
  3775         10  BPREM1A PIC  X(0001).
  3776     05  BPREM1I PIC  X(0011).
  3777*    -------------------------------
  3778     05  BEXPIR1L PIC S9(0004) COMP.
  3779     05  BEXPIR1F PIC  X(0001).
  3780     05  FILLER REDEFINES BEXPIR1F.
  3781         10  BEXPIR1A PIC  X(0001).
  3782     05  BEXPIR1I PIC  X(0008).
  3783*    -------------------------------
  3784     05  BCP1L PIC S9(0004) COMP.
  3785     05  BCP1F PIC  X(0001).
  3786     05  FILLER REDEFINES BCP1F.
  3787         10  BCP1A PIC  X(0001).
  3788     05  BCP1I PIC  X(0002).
  3789*    -------------------------------
  3790     05  BALTBN1L PIC S9(0004) COMP.
  3791     05  BALTBN1F PIC  X(0001).
  3792     05  FILLER REDEFINES BALTBN1F.
  3793         10  BALTBN1A PIC  X(0001).
  3794     05  BALTBN1I PIC  X(0012).
  3795*    -------------------------------
  3796     05  BALTPR1L PIC S9(0004) COMP.
  3797     05  BALTPR1F PIC  X(0001).
  3798     05  FILLER REDEFINES BALTPR1F.
  3799         10  BALTPR1A PIC  X(0001).
  3800     05  BALTPR1I PIC  X(0011).
  3801*    -------------------------------
  3802     05  BBNCD1L PIC S9(0004) COMP.
  3803     05  BBNCD1F PIC  X(0001).
  3804     05  FILLER REDEFINES BBNCD1F.
  3805         10  BBNCD1A PIC  X(0001).
  3806     05  BBNCD1I PIC  X(0003).
  3807*    -------------------------------
  3808     05  BCPRM1L PIC S9(0004) COMP.
  3809     05  BCPRM1F PIC  X(0001).
  3810     05  FILLER REDEFINES BCPRM1F.
  3811         10  BCPRM1A PIC  X(0001).
  3812     05  BCPRM1I PIC  X(0011).
  3813*    -------------------------------
  3814     05  BCAPRM1L PIC S9(0004) COMP.
  3815     05  BCAPRM1F PIC  X(0001).
  3816     05  FILLER REDEFINES BCAPRM1F.
  3817         10  BCAPRM1A PIC  X(0001).
  3818     05  BCAPRM1I PIC  X(0011).
  3819*    -------------------------------
  3820     05  BENABR1L PIC S9(0004) COMP.
  3821     05  BENABR1F PIC  X(0001).
  3822     05  FILLER REDEFINES BENABR1F.
  3823         10  BENABR1A PIC  X(0001).
  3824     05  BENABR1I PIC  X(0005).
  3825*    -------------------------------
  3826     05  BDIFF1L PIC S9(0004) COMP.
  3827     05  BDIFF1F PIC  X(0001).
  3828     05  FILLER REDEFINES BDIFF1F.
  3829         10  BDIFF1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  74
* EL6311.cbl
  3830     05  BDIFF1I PIC  X(0011).
  3831*    -------------------------------
  3832     05  BBILIT1L PIC S9(0004) COMP.
  3833     05  BBILIT1F PIC  X(0001).
  3834     05  FILLER REDEFINES BBILIT1F.
  3835         10  BBILIT1A PIC  X(0001).
  3836     05  BBILIT1I PIC  X(0008).
  3837*    -------------------------------
  3838     05  BADIFF1L PIC S9(0004) COMP.
  3839     05  BADIFF1F PIC  X(0001).
  3840     05  FILLER REDEFINES BADIFF1F.
  3841         10  BADIFF1A PIC  X(0001).
  3842     05  BADIFF1I PIC  X(0011).
  3843*    -------------------------------
  3844     05  BKIND2L PIC S9(0004) COMP.
  3845     05  BKIND2F PIC  X(0001).
  3846     05  FILLER REDEFINES BKIND2F.
  3847         10  BKIND2A PIC  X(0001).
  3848     05  BKIND2I PIC  X(0002).
  3849*    -------------------------------
  3850     05  BTYPE2L PIC S9(0004) COMP.
  3851     05  BTYPE2F PIC  X(0001).
  3852     05  FILLER REDEFINES BTYPE2F.
  3853         10  BTYPE2A PIC  X(0001).
  3854     05  BTYPE2I PIC  X(0003).
  3855*    -------------------------------
  3856     05  BTERM2L PIC S9(0004) COMP.
  3857     05  BTERM2F PIC  X(0001).
  3858     05  FILLER REDEFINES BTERM2F.
  3859         10  BTERM2A PIC  X(0001).
  3860     05  BTERM2I PIC  X(0003).
  3861*    -------------------------------
  3862     05  BBEN2L PIC S9(0004) COMP.
  3863     05  BBEN2F PIC  X(0001).
  3864     05  FILLER REDEFINES BBEN2F.
  3865         10  BBEN2A PIC  X(0001).
  3866     05  BBEN2I PIC  X(0012).
  3867*    -------------------------------
  3868     05  BPREM2L PIC S9(0004) COMP.
  3869     05  BPREM2F PIC  X(0001).
  3870     05  FILLER REDEFINES BPREM2F.
  3871         10  BPREM2A PIC  X(0001).
  3872     05  BPREM2I PIC  X(0011).
  3873*    -------------------------------
  3874     05  BEXPIR2L PIC S9(0004) COMP.
  3875     05  BEXPIR2F PIC  X(0001).
  3876     05  FILLER REDEFINES BEXPIR2F.
  3877         10  BEXPIR2A PIC  X(0001).
  3878     05  BEXPIR2I PIC  X(0008).
  3879*    -------------------------------
  3880     05  BCP2L PIC S9(0004) COMP.
  3881     05  BCP2F PIC  X(0001).
  3882     05  FILLER REDEFINES BCP2F.
  3883         10  BCP2A PIC  X(0001).
  3884     05  BCP2I PIC  X(0002).
  3885*    -------------------------------
  3886     05  BALTBN2L PIC S9(0004) COMP.
  3887     05  BALTBN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  75
* EL6311.cbl
  3888     05  FILLER REDEFINES BALTBN2F.
  3889         10  BALTBN2A PIC  X(0001).
  3890     05  BALTBN2I PIC  X(0012).
  3891*    -------------------------------
  3892     05  BALTPR2L PIC S9(0004) COMP.
  3893     05  BALTPR2F PIC  X(0001).
  3894     05  FILLER REDEFINES BALTPR2F.
  3895         10  BALTPR2A PIC  X(0001).
  3896     05  BALTPR2I PIC  X(0011).
  3897*    -------------------------------
  3898     05  BBNCD2L PIC S9(0004) COMP.
  3899     05  BBNCD2F PIC  X(0001).
  3900     05  FILLER REDEFINES BBNCD2F.
  3901         10  BBNCD2A PIC  X(0001).
  3902     05  BBNCD2I PIC  X(0003).
  3903*    -------------------------------
  3904     05  BCPRM2L PIC S9(0004) COMP.
  3905     05  BCPRM2F PIC  X(0001).
  3906     05  FILLER REDEFINES BCPRM2F.
  3907         10  BCPRM2A PIC  X(0001).
  3908     05  BCPRM2I PIC  X(0011).
  3909*    -------------------------------
  3910     05  BCAPRM2L PIC S9(0004) COMP.
  3911     05  BCAPRM2F PIC  X(0001).
  3912     05  FILLER REDEFINES BCAPRM2F.
  3913         10  BCAPRM2A PIC  X(0001).
  3914     05  BCAPRM2I PIC  X(0011).
  3915*    -------------------------------
  3916     05  BENABR2L PIC S9(0004) COMP.
  3917     05  BENABR2F PIC  X(0001).
  3918     05  FILLER REDEFINES BENABR2F.
  3919         10  BENABR2A PIC  X(0001).
  3920     05  BENABR2I PIC  X(0005).
  3921*    -------------------------------
  3922     05  BDIFF2L PIC S9(0004) COMP.
  3923     05  BDIFF2F PIC  X(0001).
  3924     05  FILLER REDEFINES BDIFF2F.
  3925         10  BDIFF2A PIC  X(0001).
  3926     05  BDIFF2I PIC  X(0011).
  3927*    -------------------------------
  3928     05  BBILIT2L PIC S9(0004) COMP.
  3929     05  BBILIT2F PIC  X(0001).
  3930     05  FILLER REDEFINES BBILIT2F.
  3931         10  BBILIT2A PIC  X(0001).
  3932     05  BBILIT2I PIC  X(0008).
  3933*    -------------------------------
  3934     05  BADIFF2L PIC S9(0004) COMP.
  3935     05  BADIFF2F PIC  X(0001).
  3936     05  FILLER REDEFINES BADIFF2F.
  3937         10  BADIFF2A PIC  X(0001).
  3938     05  BADIFF2I PIC  X(0011).
  3939*    -------------------------------
  3940     05  BERMSG1L PIC S9(0004) COMP.
  3941     05  BERMSG1F PIC  X(0001).
  3942     05  FILLER REDEFINES BERMSG1F.
  3943         10  BERMSG1A PIC  X(0001).
  3944     05  BERMSG1I PIC  X(0078).
  3945*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  76
* EL6311.cbl
  3946     05  BERMSG2L PIC S9(0004) COMP.
  3947     05  BERMSG2F PIC  X(0001).
  3948     05  FILLER REDEFINES BERMSG2F.
  3949         10  BERMSG2A PIC  X(0001).
  3950     05  BERMSG2I PIC  X(0078).
  3951*    -------------------------------
  3952     05  BERMSG3L PIC S9(0004) COMP.
  3953     05  BERMSG3F PIC  X(0001).
  3954     05  FILLER REDEFINES BERMSG3F.
  3955         10  BERMSG3A PIC  X(0001).
  3956     05  BERMSG3I PIC  X(0078).
  3957*    -------------------------------
  3958     05  BPFENTRL PIC S9(0004) COMP.
  3959     05  BPFENTRF PIC  X(0001).
  3960     05  FILLER REDEFINES BPFENTRF.
  3961         10  BPFENTRA PIC  X(0001).
  3962     05  BPFENTRI PIC  9(2).
  3963*    -------------------------------
  3964     05  BPF5HDRL PIC S9(0004) COMP.
  3965     05  BPF5HDRF PIC  X(0001).
  3966     05  FILLER REDEFINES BPF5HDRF.
  3967         10  BPF5HDRA PIC  X(0001).
  3968     05  BPF5HDRI PIC  X(0005).
  3969*    -------------------------------
  3970     05  BPF4HDRL PIC S9(0004) COMP.
  3971     05  BPF4HDRF PIC  X(0001).
  3972     05  FILLER REDEFINES BPF4HDRF.
  3973         10  BPF4HDRA PIC  X(0001).
  3974     05  BPF4HDRI PIC  X(0013).
  3975*    -------------------------------
  3976     05  BF15HDRL PIC S9(0004) COMP.
  3977     05  BF15HDRF PIC  X(0001).
  3978     05  FILLER REDEFINES BF15HDRF.
  3979         10  BF15HDRA PIC  X(0001).
  3980     05  BF15HDRI PIC  X(0010).
  3981 01  EL631BO REDEFINES EL631BI.
  3982     05  FILLER            PIC  X(0012).
  3983*    -------------------------------
  3984     05  FILLER            PIC  X(0003).
  3985     05  BDATEO PIC  X(0008).
  3986*    -------------------------------
  3987     05  FILLER            PIC  X(0003).
  3988     05  BTIMEO PIC  99.99.
  3989*    -------------------------------
  3990     05  FILLER            PIC  X(0003).
  3991     05  BHEADO PIC  X(0038).
  3992*    -------------------------------
  3993     05  FILLER            PIC  X(0003).
  3994     05  BNCERTLO PIC  X(0008).
  3995*    -------------------------------
  3996     05  FILLER            PIC  X(0003).
  3997     05  BNCERTO PIC  X(0011).
  3998*    -------------------------------
  3999     05  FILLER            PIC  X(0003).
  4000     05  BNSTATLO PIC  X(0009).
  4001*    -------------------------------
  4002     05  FILLER            PIC  X(0003).
  4003     05  BNSTATO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  77
* EL6311.cbl
  4004*    -------------------------------
  4005     05  FILLER            PIC  X(0003).
  4006     05  BCHGTO PIC  X(0004).
  4007*    -------------------------------
  4008     05  FILLER            PIC  X(0003).
  4009     05  BCHGO PIC  ZZZ9.
  4010*    -------------------------------
  4011     05  FILLER            PIC  X(0003).
  4012     05  BMAINTO PIC  X(0001).
  4013*    -------------------------------
  4014     05  FILLER            PIC  X(0003).
  4015     05  BMANTBYO PIC  X(0004).
  4016*    -------------------------------
  4017     05  FILLER            PIC  X(0003).
  4018     05  BCHGHDGO PIC  X(0003).
  4019*    -------------------------------
  4020     05  FILLER            PIC  X(0003).
  4021     05  BMANTDTO PIC  X(0008).
  4022*    -------------------------------
  4023     05  FILLER            PIC  X(0003).
  4024     05  BMANTATO PIC  99.99.
  4025*    -------------------------------
  4026     05  FILLER            PIC  X(0003).
  4027     05  BCSRO PIC  X(0004).
  4028*    -------------------------------
  4029     05  FILLER            PIC  X(0003).
  4030     05  BBATCHO PIC  X(0006).
  4031*    -------------------------------
  4032     05  FILLER            PIC  X(0003).
  4033     05  BSEQO PIC  X(0004).
  4034*    -------------------------------
  4035     05  FILLER            PIC  X(0003).
  4036     05  BMOENDTO PIC  X(0008).
  4037*    -------------------------------
  4038     05  FILLER            PIC  X(0003).
  4039     05  BCARRO PIC  X(0001).
  4040*    -------------------------------
  4041     05  FILLER            PIC  X(0003).
  4042     05  BGROUPO PIC  X(0006).
  4043*    -------------------------------
  4044     05  FILLER            PIC  X(0003).
  4045     05  BSTATEO PIC  X(0002).
  4046*    -------------------------------
  4047     05  FILLER            PIC  X(0003).
  4048     05  BACCTO PIC  X(0010).
  4049*    -------------------------------
  4050     05  FILLER            PIC  X(0003).
  4051     05  BVINHO PIC  X(0004).
  4052*    -------------------------------
  4053     05  FILLER            PIC  X(0003).
  4054     05  BVINO PIC  X(0017).
  4055*    -------------------------------
  4056     05  FILLER            PIC  X(0003).
  4057     05  BREFHDGO PIC  X(0004).
  4058*    -------------------------------
  4059     05  FILLER            PIC  X(0003).
  4060     05  BREFO PIC  X(0012).
  4061*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  78
* EL6311.cbl
  4062     05  FILLER            PIC  X(0003).
  4063     05  BAGEDEFO PIC  X(0004).
  4064*    -------------------------------
  4065     05  FILLER            PIC  X(0003).
  4066     05  BCERTNOO PIC  X(0010).
  4067*    -------------------------------
  4068     05  FILLER            PIC  X(0003).
  4069     05  BSUFIXO PIC  X(0001).
  4070*    -------------------------------
  4071     05  FILLER            PIC  X(0003).
  4072     05  BEFFDTO PIC  X(0008).
  4073*    -------------------------------
  4074     05  FILLER            PIC  X(0003).
  4075     05  BLSTNMO PIC  X(0015).
  4076*    -------------------------------
  4077     05  FILLER            PIC  X(0003).
  4078     05  B1STNMO PIC  X(0010).
  4079*    -------------------------------
  4080     05  FILLER            PIC  X(0003).
  4081     05  BINITO PIC  X(0001).
  4082*    -------------------------------
  4083     05  FILLER            PIC  X(0003).
  4084     05  BSEXO PIC  X(0001).
  4085*    -------------------------------
  4086     05  FILLER            PIC  X(0003).
  4087     05  BAGEO PIC  X(0002).
  4088*    -------------------------------
  4089     05  FILLER            PIC  X(0003).
  4090     05  BBIRTHO PIC  X(0008).
  4091*    -------------------------------
  4092     05  FILLER            PIC  X(0003).
  4093     05  B1STPMTO PIC  X(0008).
  4094*    -------------------------------
  4095     05  FILLER            PIC  X(0003).
  4096     05  BDAYSO PIC  X(0003).
  4097*    -------------------------------
  4098     05  FILLER            PIC  X(0003).
  4099     05  BLNTRMO PIC  X(0003).
  4100*    -------------------------------
  4101     05  FILLER            PIC  X(0003).
  4102     05  BLNOFCRO PIC  X(0005).
  4103*    -------------------------------
  4104     05  FILLER            PIC  X(0003).
  4105     05  BMODEO PIC  X(0001).
  4106*    -------------------------------
  4107     05  FILLER            PIC  X(0003).
  4108     05  BFREQO PIC  X(0002).
  4109*    -------------------------------
  4110     05  FILLER            PIC  X(0003).
  4111     05  BPMTSO PIC  X(0003).
  4112*    -------------------------------
  4113     05  FILLER            PIC  X(0003).
  4114     05  BPMTAMTO PIC  ZZZZZ9.99.
  4115*    -------------------------------
  4116     05  FILLER            PIC  X(0003).
  4117     05  BAPRO PIC  99.9999.
  4118*    -------------------------------
  4119     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  79
* EL6311.cbl
  4120     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4121*    -------------------------------
  4122     05  FILLER            PIC  X(0003).
  4123     05  BMEMCAPO PIC  X(0011).
  4124*    -------------------------------
  4125     05  FILLER            PIC  X(0003).
  4126     05  BORIGHDO PIC  X(0009).
  4127*    -------------------------------
  4128     05  FILLER            PIC  X(0003).
  4129     05  DMDBILO PIC  X(0006).
  4130*    -------------------------------
  4131     05  FILLER            PIC  X(0003).
  4132     05  BFORCEO PIC  X(0001).
  4133*    -------------------------------
  4134     05  FILLER            PIC  X(0003).
  4135     05  BENTRYO PIC  X(0001).
  4136*    -------------------------------
  4137     05  FILLER            PIC  X(0003).
  4138     05  BREINO PIC  X(0001).
  4139*    -------------------------------
  4140     05  FILLER            PIC  X(0003).
  4141     05  BBILCDO PIC  X(0001).
  4142*    -------------------------------
  4143     05  FILLER            PIC  X(0003).
  4144     05  BUNWRITO PIC  X(0001).
  4145*    -------------------------------
  4146     05  FILLER            PIC  X(0003).
  4147     05  BSKPCDO PIC  X(0001).
  4148*    -------------------------------
  4149     05  FILLER            PIC  X(0003).
  4150     05  BINDGRPO PIC  X(0001).
  4151*    -------------------------------
  4152     05  FILLER            PIC  X(0003).
  4153     05  BSIGO PIC  X(0001).
  4154*    -------------------------------
  4155     05  FILLER            PIC  X(0003).
  4156     05  BRTCLSO PIC  X(0002).
  4157*    -------------------------------
  4158     05  FILLER            PIC  X(0003).
  4159     05  BCHGCNTO PIC  X(0003).
  4160*    -------------------------------
  4161     05  FILLER            PIC  X(0003).
  4162     05  BMEMBERO PIC  X(0012).
  4163*    -------------------------------
  4164     05  FILLER            PIC  X(0003).
  4165     05  BORGNOO PIC  X(0006).
  4166*    -------------------------------
  4167     05  FILLER            PIC  X(0003).
  4168     05  BORGSEQO PIC  X(0004).
  4169*    -------------------------------
  4170     05  FILLER            PIC  X(0003).
  4171     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4172*    -------------------------------
  4173     05  FILLER            PIC  X(0003).
  4174     05  BKIND1O PIC  X(0002).
  4175*    -------------------------------
  4176     05  FILLER            PIC  X(0003).
  4177     05  BTYPE1O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  80
* EL6311.cbl
  4178*    -------------------------------
  4179     05  FILLER            PIC  X(0003).
  4180     05  BTERM1O PIC  X(0003).
  4181*    -------------------------------
  4182     05  FILLER            PIC  X(0003).
  4183     05  BBEN1O PIC  X(0012).
  4184*    -------------------------------
  4185     05  FILLER            PIC  X(0003).
  4186     05  BPREM1O PIC  X(0011).
  4187*    -------------------------------
  4188     05  FILLER            PIC  X(0003).
  4189     05  BEXPIR1O PIC  X(0008).
  4190*    -------------------------------
  4191     05  FILLER            PIC  X(0003).
  4192     05  BCP1O PIC  X(0002).
  4193*    -------------------------------
  4194     05  FILLER            PIC  X(0003).
  4195     05  BALTBN1O PIC  X(0012).
  4196*    -------------------------------
  4197     05  FILLER            PIC  X(0003).
  4198     05  BALTPR1O PIC  X(0011).
  4199*    -------------------------------
  4200     05  FILLER            PIC  X(0003).
  4201     05  BBNCD1O PIC  X(0003).
  4202*    -------------------------------
  4203     05  FILLER            PIC  X(0003).
  4204     05  BCPRM1O PIC  X(0011).
  4205*    -------------------------------
  4206     05  FILLER            PIC  X(0003).
  4207     05  BCAPRM1O PIC  X(0011).
  4208*    -------------------------------
  4209     05  FILLER            PIC  X(0003).
  4210     05  BENABR1O PIC  X(0005).
  4211*    -------------------------------
  4212     05  FILLER            PIC  X(0003).
  4213     05  BDIFF1O PIC  X(0011).
  4214*    -------------------------------
  4215     05  FILLER            PIC  X(0003).
  4216     05  BBILIT1O PIC  X(0008).
  4217*    -------------------------------
  4218     05  FILLER            PIC  X(0003).
  4219     05  BADIFF1O PIC  X(0011).
  4220*    -------------------------------
  4221     05  FILLER            PIC  X(0003).
  4222     05  BKIND2O PIC  X(0002).
  4223*    -------------------------------
  4224     05  FILLER            PIC  X(0003).
  4225     05  BTYPE2O PIC  X(0003).
  4226*    -------------------------------
  4227     05  FILLER            PIC  X(0003).
  4228     05  BTERM2O PIC  X(0003).
  4229*    -------------------------------
  4230     05  FILLER            PIC  X(0003).
  4231     05  BBEN2O PIC  X(0012).
  4232*    -------------------------------
  4233     05  FILLER            PIC  X(0003).
  4234     05  BPREM2O PIC  X(0011).
  4235*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  81
* EL6311.cbl
  4236     05  FILLER            PIC  X(0003).
  4237     05  BEXPIR2O PIC  X(0008).
  4238*    -------------------------------
  4239     05  FILLER            PIC  X(0003).
  4240     05  BCP2O PIC  X(0002).
  4241*    -------------------------------
  4242     05  FILLER            PIC  X(0003).
  4243     05  BALTBN2O PIC  X(0012).
  4244*    -------------------------------
  4245     05  FILLER            PIC  X(0003).
  4246     05  BALTPR2O PIC  X(0011).
  4247*    -------------------------------
  4248     05  FILLER            PIC  X(0003).
  4249     05  BBNCD2O PIC  X(0003).
  4250*    -------------------------------
  4251     05  FILLER            PIC  X(0003).
  4252     05  BCPRM2O PIC  X(0011).
  4253*    -------------------------------
  4254     05  FILLER            PIC  X(0003).
  4255     05  BCAPRM2O PIC  X(0011).
  4256*    -------------------------------
  4257     05  FILLER            PIC  X(0003).
  4258     05  BENABR2O PIC  X(0005).
  4259*    -------------------------------
  4260     05  FILLER            PIC  X(0003).
  4261     05  BDIFF2O PIC  X(0011).
  4262*    -------------------------------
  4263     05  FILLER            PIC  X(0003).
  4264     05  BBILIT2O PIC  X(0008).
  4265*    -------------------------------
  4266     05  FILLER            PIC  X(0003).
  4267     05  BADIFF2O PIC  X(0011).
  4268*    -------------------------------
  4269     05  FILLER            PIC  X(0003).
  4270     05  BERMSG1O PIC  X(0078).
  4271*    -------------------------------
  4272     05  FILLER            PIC  X(0003).
  4273     05  BERMSG2O PIC  X(0078).
  4274*    -------------------------------
  4275     05  FILLER            PIC  X(0003).
  4276     05  BERMSG3O PIC  X(0078).
  4277*    -------------------------------
  4278     05  FILLER            PIC  X(0003).
  4279     05  BPFENTRO PIC  X(0002).
  4280*    -------------------------------
  4281     05  FILLER            PIC  X(0003).
  4282     05  BPF5HDRO PIC  X(0005).
  4283*    -------------------------------
  4284     05  FILLER            PIC  X(0003).
  4285     05  BPF4HDRO PIC  X(0013).
  4286*    -------------------------------
  4287     05  FILLER            PIC  X(0003).
  4288     05  BF15HDRO PIC  X(0010).
  4289*    -------------------------------
  4290 01  EL631CI REDEFINES EL631BI.
  4291     05  FILLER            PIC  X(0012).
  4292*    -------------------------------
  4293     05  CDATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  82
* EL6311.cbl
  4294     05  CDATEF PIC  X(0001).
  4295     05  FILLER REDEFINES CDATEF.
  4296         10  CDATEA PIC  X(0001).
  4297     05  CDATEI PIC  X(0008).
  4298*    -------------------------------
  4299     05  CTIMEL PIC S9(0004) COMP.
  4300     05  CTIMEF PIC  X(0001).
  4301     05  FILLER REDEFINES CTIMEF.
  4302         10  CTIMEA PIC  X(0001).
  4303     05  CTIMEI PIC  X(0005).
  4304*    -------------------------------
  4305     05  CHEADL PIC S9(0004) COMP.
  4306     05  CHEADF PIC  X(0001).
  4307     05  FILLER REDEFINES CHEADF.
  4308         10  CHEADA PIC  X(0001).
  4309     05  CHEADI PIC  X(0038).
  4310*    -------------------------------
  4311     05  CCHGTL PIC S9(0004) COMP.
  4312     05  CCHGTF PIC  X(0001).
  4313     05  FILLER REDEFINES CCHGTF.
  4314         10  CCHGTA PIC  X(0001).
  4315     05  CCHGTI PIC  X(0004).
  4316*    -------------------------------
  4317     05  CCHGL PIC S9(0004) COMP.
  4318     05  CCHGF PIC  X(0001).
  4319     05  FILLER REDEFINES CCHGF.
  4320         10  CCHGA PIC  X(0001).
  4321     05  CCHGI PIC  X(0004).
  4322*    -------------------------------
  4323     05  CMAINTL PIC S9(0004) COMP.
  4324     05  CMAINTF PIC  X(0001).
  4325     05  FILLER REDEFINES CMAINTF.
  4326         10  CMAINTA PIC  X(0001).
  4327     05  CMAINTI PIC  X(0001).
  4328*    -------------------------------
  4329     05  CMANTBYL PIC S9(0004) COMP.
  4330     05  CMANTBYF PIC  X(0001).
  4331     05  FILLER REDEFINES CMANTBYF.
  4332         10  CMANTBYA PIC  X(0001).
  4333     05  CMANTBYI PIC  X(0004).
  4334*    -------------------------------
  4335     05  CCHGHDGL PIC S9(0004) COMP.
  4336     05  CCHGHDGF PIC  X(0001).
  4337     05  FILLER REDEFINES CCHGHDGF.
  4338         10  CCHGHDGA PIC  X(0001).
  4339     05  CCHGHDGI PIC  X(0003).
  4340*    -------------------------------
  4341     05  CMANTDTL PIC S9(0004) COMP.
  4342     05  CMANTDTF PIC  X(0001).
  4343     05  FILLER REDEFINES CMANTDTF.
  4344         10  CMANTDTA PIC  X(0001).
  4345     05  CMANTDTI PIC  X(0008).
  4346*    -------------------------------
  4347     05  CMANTATL PIC S9(0004) COMP.
  4348     05  CMANTATF PIC  X(0001).
  4349     05  FILLER REDEFINES CMANTATF.
  4350         10  CMANTATA PIC  X(0001).
  4351     05  CMANTATI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  83
* EL6311.cbl
  4352*    -------------------------------
  4353     05  CCSRL PIC S9(0004) COMP.
  4354     05  CCSRF PIC  X(0001).
  4355     05  FILLER REDEFINES CCSRF.
  4356         10  CCSRA PIC  X(0001).
  4357     05  CCSRI PIC  X(0004).
  4358*    -------------------------------
  4359     05  CBATCHL PIC S9(0004) COMP.
  4360     05  CBATCHF PIC  X(0001).
  4361     05  FILLER REDEFINES CBATCHF.
  4362         10  CBATCHA PIC  X(0001).
  4363     05  CBATCHI PIC  X(0006).
  4364*    -------------------------------
  4365     05  CSEQL PIC S9(0004) COMP.
  4366     05  CSEQF PIC  X(0001).
  4367     05  FILLER REDEFINES CSEQF.
  4368         10  CSEQA PIC  X(0001).
  4369     05  CSEQI PIC  X(0004).
  4370*    -------------------------------
  4371     05  CMOENDTL PIC S9(0004) COMP.
  4372     05  CMOENDTF PIC  X(0001).
  4373     05  FILLER REDEFINES CMOENDTF.
  4374         10  CMOENDTA PIC  X(0001).
  4375     05  CMOENDTI PIC  X(0008).
  4376*    -------------------------------
  4377     05  CCARRL PIC S9(0004) COMP.
  4378     05  CCARRF PIC  X(0001).
  4379     05  FILLER REDEFINES CCARRF.
  4380         10  CCARRA PIC  X(0001).
  4381     05  CCARRI PIC  X(0001).
  4382*    -------------------------------
  4383     05  CGROUPL PIC S9(0004) COMP.
  4384     05  CGROUPF PIC  X(0001).
  4385     05  FILLER REDEFINES CGROUPF.
  4386         10  CGROUPA PIC  X(0001).
  4387     05  CGROUPI PIC  X(0006).
  4388*    -------------------------------
  4389     05  CSTATEL PIC S9(0004) COMP.
  4390     05  CSTATEF PIC  X(0001).
  4391     05  FILLER REDEFINES CSTATEF.
  4392         10  CSTATEA PIC  X(0001).
  4393     05  CSTATEI PIC  X(0002).
  4394*    -------------------------------
  4395     05  CACCTL PIC S9(0004) COMP.
  4396     05  CACCTF PIC  X(0001).
  4397     05  FILLER REDEFINES CACCTF.
  4398         10  CACCTA PIC  X(0001).
  4399     05  CACCTI PIC  X(0010).
  4400*    -------------------------------
  4401     05  CORIGHDL PIC S9(0004) COMP.
  4402     05  CORIGHDF PIC  X(0001).
  4403     05  FILLER REDEFINES CORIGHDF.
  4404         10  CORIGHDA PIC  X(0001).
  4405     05  CORIGHDI PIC  X(0011).
  4406*    -------------------------------
  4407     05  CORGNOL PIC S9(0004) COMP.
  4408     05  CORGNOF PIC  X(0001).
  4409     05  FILLER REDEFINES CORGNOF.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  84
* EL6311.cbl
  4410         10  CORGNOA PIC  X(0001).
  4411     05  CORGNOI PIC  X(0006).
  4412*    -------------------------------
  4413     05  CORGSEQL PIC S9(0004) COMP.
  4414     05  CORGSEQF PIC  X(0001).
  4415     05  FILLER REDEFINES CORGSEQF.
  4416         10  CORGSEQA PIC  X(0001).
  4417     05  CORGSEQI PIC  X(0004).
  4418*    -------------------------------
  4419     05  CREFHDGL PIC S9(0004) COMP.
  4420     05  CREFHDGF PIC  X(0001).
  4421     05  FILLER REDEFINES CREFHDGF.
  4422         10  CREFHDGA PIC  X(0001).
  4423     05  CREFHDGI PIC  X(0010).
  4424*    -------------------------------
  4425     05  CREFL PIC S9(0004) COMP.
  4426     05  CREFF PIC  X(0001).
  4427     05  FILLER REDEFINES CREFF.
  4428         10  CREFA PIC  X(0001).
  4429     05  CREFI PIC  X(0012).
  4430*    -------------------------------
  4431     05  CNHINTL PIC S9(0004) COMP.
  4432     05  CNHINTF PIC  X(0001).
  4433     05  FILLER REDEFINES CNHINTF.
  4434         10  CNHINTA PIC  X(0001).
  4435     05  CNHINTI PIC  9(7)V99.
  4436*    -------------------------------
  4437     05  CCERTNOL PIC S9(0004) COMP.
  4438     05  CCERTNOF PIC  X(0001).
  4439     05  FILLER REDEFINES CCERTNOF.
  4440         10  CCERTNOA PIC  X(0001).
  4441     05  CCERTNOI PIC  X(0010).
  4442*    -------------------------------
  4443     05  CSUFIXL PIC S9(0004) COMP.
  4444     05  CSUFIXF PIC  X(0001).
  4445     05  FILLER REDEFINES CSUFIXF.
  4446         10  CSUFIXA PIC  X(0001).
  4447     05  CSUFIXI PIC  X(0001).
  4448*    -------------------------------
  4449     05  CEFFDTL PIC S9(0004) COMP.
  4450     05  CEFFDTF PIC  X(0001).
  4451     05  FILLER REDEFINES CEFFDTF.
  4452         10  CEFFDTA PIC  X(0001).
  4453     05  CEFFDTI PIC  X(0008).
  4454*    -------------------------------
  4455     05  CLSTNML PIC S9(0004) COMP.
  4456     05  CLSTNMF PIC  X(0001).
  4457     05  FILLER REDEFINES CLSTNMF.
  4458         10  CLSTNMA PIC  X(0001).
  4459     05  CLSTNMI PIC  X(0015).
  4460*    -------------------------------
  4461     05  CPCYNL PIC S9(0004) COMP.
  4462     05  CPCYNF PIC  X(0001).
  4463     05  FILLER REDEFINES CPCYNF.
  4464         10  CPCYNA PIC  X(0001).
  4465     05  CPCYNI PIC  X(0001).
  4466*    -------------------------------
  4467     05  CINAMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  85
* EL6311.cbl
  4468     05  CINAMEF PIC  X(0001).
  4469     05  FILLER REDEFINES CINAMEF.
  4470         10  CINAMEA PIC  X(0001).
  4471     05  CINAMEI PIC  X(0015).
  4472*    -------------------------------
  4473     05  CINITSL PIC S9(0004) COMP.
  4474     05  CINITSF PIC  X(0001).
  4475     05  FILLER REDEFINES CINITSF.
  4476         10  CINITSA PIC  X(0001).
  4477     05  CINITSI PIC  X(0010).
  4478*    -------------------------------
  4479     05  CCANREAL PIC S9(0004) COMP.
  4480     05  CCANREAF PIC  X(0001).
  4481     05  FILLER REDEFINES CCANREAF.
  4482         10  CCANREAA PIC  X(0001).
  4483     05  CCANREAI PIC  X(0001).
  4484*    -------------------------------
  4485     05  CKIND1L PIC S9(0004) COMP.
  4486     05  CKIND1F PIC  X(0001).
  4487     05  FILLER REDEFINES CKIND1F.
  4488         10  CKIND1A PIC  X(0001).
  4489     05  CKIND1I PIC  X(0002).
  4490*    -------------------------------
  4491     05  CCANDT1L PIC S9(0004) COMP.
  4492     05  CCANDT1F PIC  X(0001).
  4493     05  FILLER REDEFINES CCANDT1F.
  4494         10  CCANDT1A PIC  X(0001).
  4495     05  CCANDT1I PIC  X(0008).
  4496*    -------------------------------
  4497     05  CREFND1L PIC S9(0004) COMP.
  4498     05  CREFND1F PIC  X(0001).
  4499     05  FILLER REDEFINES CREFND1F.
  4500         10  CREFND1A PIC  X(0001).
  4501     05  CREFND1I PIC  S9(9)V99.
  4502*    -------------------------------
  4503     05  CMTHD1L PIC S9(0004) COMP.
  4504     05  CMTHD1F PIC  X(0001).
  4505     05  FILLER REDEFINES CMTHD1F.
  4506         10  CMTHD1A PIC  X(0001).
  4507     05  CMTHD1I PIC  X(0001).
  4508*    -------------------------------
  4509     05  CKIND2L PIC S9(0004) COMP.
  4510     05  CKIND2F PIC  X(0001).
  4511     05  FILLER REDEFINES CKIND2F.
  4512         10  CKIND2A PIC  X(0001).
  4513     05  CKIND2I PIC  X(0002).
  4514*    -------------------------------
  4515     05  CCANDT2L PIC S9(0004) COMP.
  4516     05  CCANDT2F PIC  X(0001).
  4517     05  FILLER REDEFINES CCANDT2F.
  4518         10  CCANDT2A PIC  X(0001).
  4519     05  CCANDT2I PIC  X(0008).
  4520*    -------------------------------
  4521     05  CREFND2L PIC S9(0004) COMP.
  4522     05  CREFND2F PIC  X(0001).
  4523     05  FILLER REDEFINES CREFND2F.
  4524         10  CREFND2A PIC  X(0001).
  4525     05  CREFND2I PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  86
* EL6311.cbl
  4526*    -------------------------------
  4527     05  CMTHD2L PIC S9(0004) COMP.
  4528     05  CMTHD2F PIC  X(0001).
  4529     05  FILLER REDEFINES CMTHD2F.
  4530         10  CMTHD2A PIC  X(0001).
  4531     05  CMTHD2I PIC  X(0001).
  4532*    -------------------------------
  4533     05  CLIVESL PIC S9(0004) COMP.
  4534     05  CLIVESF PIC  X(0001).
  4535     05  FILLER REDEFINES CLIVESF.
  4536         10  CLIVESA PIC  X(0001).
  4537     05  CLIVESI PIC  X(0003).
  4538*    -------------------------------
  4539     05  CFORCEL PIC S9(0004) COMP.
  4540     05  CFORCEF PIC  X(0001).
  4541     05  FILLER REDEFINES CFORCEF.
  4542         10  CFORCEA PIC  X(0001).
  4543     05  CFORCEI PIC  X(0001).
  4544*    -------------------------------
  4545     05  CBILCDL PIC S9(0004) COMP.
  4546     05  CBILCDF PIC  X(0001).
  4547     05  FILLER REDEFINES CBILCDF.
  4548         10  CBILCDA PIC  X(0001).
  4549     05  CBILCDI PIC  X(0001).
  4550*    -------------------------------
  4551     05  CCRFND1L PIC S9(0004) COMP.
  4552     05  CCRFND1F PIC  X(0001).
  4553     05  FILLER REDEFINES CCRFND1F.
  4554         10  CCRFND1A PIC  X(0001).
  4555     05  CCRFND1I PIC  X(0011).
  4556*    -------------------------------
  4557     05  CCRFND2L PIC S9(0004) COMP.
  4558     05  CCRFND2F PIC  X(0001).
  4559     05  FILLER REDEFINES CCRFND2F.
  4560         10  CCRFND2A PIC  X(0001).
  4561     05  CCRFND2I PIC  X(0011).
  4562*    -------------------------------
  4563     05  CBILIT1L PIC S9(0004) COMP.
  4564     05  CBILIT1F PIC  X(0001).
  4565     05  FILLER REDEFINES CBILIT1F.
  4566         10  CBILIT1A PIC  X(0001).
  4567     05  CBILIT1I PIC  X(0008).
  4568*    -------------------------------
  4569     05  CDRFND1L PIC S9(0004) COMP.
  4570     05  CDRFND1F PIC  X(0001).
  4571     05  FILLER REDEFINES CDRFND1F.
  4572         10  CDRFND1A PIC  X(0001).
  4573     05  CDRFND1I PIC  X(0011).
  4574*    -------------------------------
  4575     05  CBILIT2L PIC S9(0004) COMP.
  4576     05  CBILIT2F PIC  X(0001).
  4577     05  FILLER REDEFINES CBILIT2F.
  4578         10  CBILIT2A PIC  X(0001).
  4579     05  CBILIT2I PIC  X(0008).
  4580*    -------------------------------
  4581     05  CDRFND2L PIC S9(0004) COMP.
  4582     05  CDRFND2F PIC  X(0001).
  4583     05  FILLER REDEFINES CDRFND2F.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  87
* EL6311.cbl
  4584         10  CDRFND2A PIC  X(0001).
  4585     05  CDRFND2I PIC  X(0011).
  4586*    -------------------------------
  4587     05  CCANTXTL PIC S9(0004) COMP.
  4588     05  CCANTXTF PIC  X(0001).
  4589     05  FILLER REDEFINES CCANTXTF.
  4590         10  CCANTXTA PIC  X(0001).
  4591     05  CCANTXTI PIC  X(0005).
  4592*    -------------------------------
  4593     05  CCANFEEL PIC S9(0004) COMP.
  4594     05  CCANFEEF PIC  X(0001).
  4595     05  FILLER REDEFINES CCANFEEF.
  4596         10  CCANFEEA PIC  X(0001).
  4597     05  CCANFEEI PIC  X(0002).
  4598*    -------------------------------
  4599     05  CTERM1L PIC S9(0004) COMP.
  4600     05  CTERM1F PIC  X(0001).
  4601     05  FILLER REDEFINES CTERM1F.
  4602         10  CTERM1A PIC  X(0001).
  4603     05  CTERM1I PIC  X(0003).
  4604*    -------------------------------
  4605     05  CRTERM1L PIC S9(0004) COMP.
  4606     05  CRTERM1F PIC  X(0001).
  4607     05  FILLER REDEFINES CRTERM1F.
  4608         10  CRTERM1A PIC  X(0001).
  4609     05  CRTERM1I PIC  X(0003).
  4610*    -------------------------------
  4611     05  CPREM1L PIC S9(0004) COMP.
  4612     05  CPREM1F PIC  X(0001).
  4613     05  FILLER REDEFINES CPREM1F.
  4614         10  CPREM1A PIC  X(0001).
  4615     05  CPREM1I PIC  X(0011).
  4616*    -------------------------------
  4617     05  CTERM2L PIC S9(0004) COMP.
  4618     05  CTERM2F PIC  X(0001).
  4619     05  FILLER REDEFINES CTERM2F.
  4620         10  CTERM2A PIC  X(0001).
  4621     05  CTERM2I PIC  X(0003).
  4622*    -------------------------------
  4623     05  CRTERM2L PIC S9(0004) COMP.
  4624     05  CRTERM2F PIC  X(0001).
  4625     05  FILLER REDEFINES CRTERM2F.
  4626         10  CRTERM2A PIC  X(0001).
  4627     05  CRTERM2I PIC  X(0003).
  4628*    -------------------------------
  4629     05  CPREM2L PIC S9(0004) COMP.
  4630     05  CPREM2F PIC  X(0001).
  4631     05  FILLER REDEFINES CPREM2F.
  4632         10  CPREM2A PIC  X(0001).
  4633     05  CPREM2I PIC  X(0011).
  4634*    -------------------------------
  4635     05  CENTRDTL PIC S9(0004) COMP.
  4636     05  CENTRDTF PIC  X(0001).
  4637     05  FILLER REDEFINES CENTRDTF.
  4638         10  CENTRDTA PIC  X(0001).
  4639     05  CENTRDTI PIC  X(0008).
  4640*    -------------------------------
  4641     05  CPAYEEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  88
* EL6311.cbl
  4642     05  CPAYEEF PIC  X(0001).
  4643     05  FILLER REDEFINES CPAYEEF.
  4644         10  CPAYEEA PIC  X(0001).
  4645     05  CPAYEEI PIC  X(0006).
  4646*    -------------------------------
  4647     05  CRFNDSWL PIC S9(0004) COMP.
  4648     05  CRFNDSWF PIC  X(0001).
  4649     05  FILLER REDEFINES CRFNDSWF.
  4650         10  CRFNDSWA PIC  X(0001).
  4651     05  CRFNDSWI PIC  X(0003).
  4652*    -------------------------------
  4653     05  CLFHDGL PIC S9(0004) COMP.
  4654     05  CLFHDGF PIC  X(0001).
  4655     05  FILLER REDEFINES CLFHDGF.
  4656         10  CLFHDGA PIC  X(0001).
  4657     05  CLFHDGI PIC  X(0006).
  4658*    -------------------------------
  4659     05  CAHHDGL PIC S9(0004) COMP.
  4660     05  CAHHDGF PIC  X(0001).
  4661     05  FILLER REDEFINES CAHHDGF.
  4662         10  CAHHDGA PIC  X(0001).
  4663     05  CAHHDGI PIC  X(0006).
  4664*    -------------------------------
  4665     05  CENTDTL PIC S9(0004) COMP.
  4666     05  CENTDTF PIC  X(0001).
  4667     05  FILLER REDEFINES CENTDTF.
  4668         10  CENTDTA PIC  X(0001).
  4669     05  CENTDTI PIC  X(0008).
  4670*    -------------------------------
  4671     05  CENTBYL PIC S9(0004) COMP.
  4672     05  CENTBYF PIC  X(0001).
  4673     05  FILLER REDEFINES CENTBYF.
  4674         10  CENTBYA PIC  X(0001).
  4675     05  CENTBYI PIC  X(0004).
  4676*    -------------------------------
  4677     05  CCHGCNTL PIC S9(0004) COMP.
  4678     05  CCHGCNTF PIC  X(0001).
  4679     05  FILLER REDEFINES CCHGCNTF.
  4680         10  CCHGCNTA PIC  X(0001).
  4681     05  CCHGCNTI PIC  X(0003).
  4682*    -------------------------------
  4683     05  CLFREFNL PIC S9(0004) COMP.
  4684     05  CLFREFNF PIC  X(0001).
  4685     05  FILLER REDEFINES CLFREFNF.
  4686         10  CLFREFNA PIC  X(0001).
  4687     05  CLFREFNI PIC  X(0006).
  4688*    -------------------------------
  4689     05  CAHREFNL PIC S9(0004) COMP.
  4690     05  CAHREFNF PIC  X(0001).
  4691     05  FILLER REDEFINES CAHREFNF.
  4692         10  CAHREFNA PIC  X(0001).
  4693     05  CAHREFNI PIC  X(0006).
  4694*    -------------------------------
  4695     05  CREINCDL PIC S9(0004) COMP.
  4696     05  CREINCDF PIC  X(0001).
  4697     05  FILLER REDEFINES CREINCDF.
  4698         10  CREINCDA PIC  X(0001).
  4699     05  CREINCDI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  89
* EL6311.cbl
  4700*    -------------------------------
  4701     05  CAEFFDTL PIC S9(0004) COMP.
  4702     05  CAEFFDTF PIC  X(0001).
  4703     05  FILLER REDEFINES CAEFFDTF.
  4704         10  CAEFFDTA PIC  X(0001).
  4705     05  CAEFFDTI PIC  X(0008).
  4706*    -------------------------------
  4707     05  CAEXPDTL PIC S9(0004) COMP.
  4708     05  CAEXPDTF PIC  X(0001).
  4709     05  FILLER REDEFINES CAEXPDTF.
  4710         10  CAEXPDTA PIC  X(0001).
  4711     05  CAEXPDTI PIC  X(0008).
  4712*    -------------------------------
  4713     05  COMMLFL PIC S9(0004) COMP.
  4714     05  COMMLFF PIC  X(0001).
  4715     05  FILLER REDEFINES COMMLFF.
  4716         10  COMMLFA PIC  X(0001).
  4717     05  COMMLFI PIC  X(0006).
  4718*    -------------------------------
  4719     05  COMMAHL PIC S9(0004) COMP.
  4720     05  COMMAHF PIC  X(0001).
  4721     05  FILLER REDEFINES COMMAHF.
  4722         10  COMMAHA PIC  X(0001).
  4723     05  COMMAHI PIC  X(0006).
  4724*    -------------------------------
  4725     05  CERMSG1L PIC S9(0004) COMP.
  4726     05  CERMSG1F PIC  X(0001).
  4727     05  FILLER REDEFINES CERMSG1F.
  4728         10  CERMSG1A PIC  X(0001).
  4729     05  CERMSG1I PIC  X(0078).
  4730*    -------------------------------
  4731     05  CERMSG2L PIC S9(0004) COMP.
  4732     05  CERMSG2F PIC  X(0001).
  4733     05  FILLER REDEFINES CERMSG2F.
  4734         10  CERMSG2A PIC  X(0001).
  4735     05  CERMSG2I PIC  X(0078).
  4736*    -------------------------------
  4737     05  CERMSG3L PIC S9(0004) COMP.
  4738     05  CERMSG3F PIC  X(0001).
  4739     05  FILLER REDEFINES CERMSG3F.
  4740         10  CERMSG3A PIC  X(0001).
  4741     05  CERMSG3I PIC  X(0078).
  4742*    -------------------------------
  4743     05  CPFENTRL PIC S9(0004) COMP.
  4744     05  CPFENTRF PIC  X(0001).
  4745     05  FILLER REDEFINES CPFENTRF.
  4746         10  CPFENTRA PIC  X(0001).
  4747     05  CPFENTRI PIC  9(2).
  4748*    -------------------------------
  4749     05  CPF5HDRL PIC S9(0004) COMP.
  4750     05  CPF5HDRF PIC  X(0001).
  4751     05  FILLER REDEFINES CPF5HDRF.
  4752         10  CPF5HDRA PIC  X(0001).
  4753     05  CPF5HDRI PIC  X(0005).
  4754*    -------------------------------
  4755     05  CPF4HDRL PIC S9(0004) COMP.
  4756     05  CPF4HDRF PIC  X(0001).
  4757     05  FILLER REDEFINES CPF4HDRF.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  90
* EL6311.cbl
  4758         10  CPF4HDRA PIC  X(0001).
  4759     05  CPF4HDRI PIC  X(0013).
  4760*    -------------------------------
  4761     05  CF15HDRL PIC S9(0004) COMP.
  4762     05  CF15HDRF PIC  X(0001).
  4763     05  FILLER REDEFINES CF15HDRF.
  4764         10  CF15HDRA PIC  X(0001).
  4765     05  CF15HDRI PIC  X(0022).
  4766 01  EL631CO REDEFINES EL631BI.
  4767     05  FILLER            PIC  X(0012).
  4768*    -------------------------------
  4769     05  FILLER            PIC  X(0003).
  4770     05  CDATEO PIC  X(0008).
  4771*    -------------------------------
  4772     05  FILLER            PIC  X(0003).
  4773     05  CTIMEO PIC  99.99.
  4774*    -------------------------------
  4775     05  FILLER            PIC  X(0003).
  4776     05  CHEADO PIC  X(0038).
  4777*    -------------------------------
  4778     05  FILLER            PIC  X(0003).
  4779     05  CCHGTO PIC  X(0004).
  4780*    -------------------------------
  4781     05  FILLER            PIC  X(0003).
  4782     05  CCHGO PIC  ZZZ9.
  4783*    -------------------------------
  4784     05  FILLER            PIC  X(0003).
  4785     05  CMAINTO PIC  X(0001).
  4786*    -------------------------------
  4787     05  FILLER            PIC  X(0003).
  4788     05  CMANTBYO PIC  X(0004).
  4789*    -------------------------------
  4790     05  FILLER            PIC  X(0003).
  4791     05  CCHGHDGO PIC  X(0003).
  4792*    -------------------------------
  4793     05  FILLER            PIC  X(0003).
  4794     05  CMANTDTO PIC  X(0008).
  4795*    -------------------------------
  4796     05  FILLER            PIC  X(0003).
  4797     05  CMANTATO PIC  99.99.
  4798*    -------------------------------
  4799     05  FILLER            PIC  X(0003).
  4800     05  CCSRO PIC  X(0004).
  4801*    -------------------------------
  4802     05  FILLER            PIC  X(0003).
  4803     05  CBATCHO PIC  X(0006).
  4804*    -------------------------------
  4805     05  FILLER            PIC  X(0003).
  4806     05  CSEQO PIC  X(0004).
  4807*    -------------------------------
  4808     05  FILLER            PIC  X(0003).
  4809     05  CMOENDTO PIC  X(0008).
  4810*    -------------------------------
  4811     05  FILLER            PIC  X(0003).
  4812     05  CCARRO PIC  X(0001).
  4813*    -------------------------------
  4814     05  FILLER            PIC  X(0003).
  4815     05  CGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  91
* EL6311.cbl
  4816*    -------------------------------
  4817     05  FILLER            PIC  X(0003).
  4818     05  CSTATEO PIC  X(0002).
  4819*    -------------------------------
  4820     05  FILLER            PIC  X(0003).
  4821     05  CACCTO PIC  X(0010).
  4822*    -------------------------------
  4823     05  FILLER            PIC  X(0003).
  4824     05  CORIGHDO PIC  X(0011).
  4825*    -------------------------------
  4826     05  FILLER            PIC  X(0003).
  4827     05  CORGNOO PIC  X(0006).
  4828*    -------------------------------
  4829     05  FILLER            PIC  X(0003).
  4830     05  CORGSEQO PIC  X(0004).
  4831*    -------------------------------
  4832     05  FILLER            PIC  X(0003).
  4833     05  CREFHDGO PIC  X(0010).
  4834*    -------------------------------
  4835     05  FILLER            PIC  X(0003).
  4836     05  CREFO PIC  X(0012).
  4837*    -------------------------------
  4838     05  FILLER            PIC  X(0003).
  4839     05  CNHINTO PIC  999999.99.
  4840*    -------------------------------
  4841     05  FILLER            PIC  X(0003).
  4842     05  CCERTNOO PIC  X(0010).
  4843*    -------------------------------
  4844     05  FILLER            PIC  X(0003).
  4845     05  CSUFIXO PIC  X(0001).
  4846*    -------------------------------
  4847     05  FILLER            PIC  X(0003).
  4848     05  CEFFDTO PIC  X(0008).
  4849*    -------------------------------
  4850     05  FILLER            PIC  X(0003).
  4851     05  CLSTNMO PIC  X(0015).
  4852*    -------------------------------
  4853     05  FILLER            PIC  X(0003).
  4854     05  CPCYNO PIC  X(0001).
  4855*    -------------------------------
  4856     05  FILLER            PIC  X(0003).
  4857     05  CINAMEO PIC  X(0015).
  4858*    -------------------------------
  4859     05  FILLER            PIC  X(0003).
  4860     05  CINITSO PIC  X(0010).
  4861*    -------------------------------
  4862     05  FILLER            PIC  X(0003).
  4863     05  CCANREAO PIC  X(0001).
  4864*    -------------------------------
  4865     05  FILLER            PIC  X(0003).
  4866     05  CKIND1O PIC  X(0002).
  4867*    -------------------------------
  4868     05  FILLER            PIC  X(0003).
  4869     05  CCANDT1O PIC  X(0008).
  4870*    -------------------------------
  4871     05  FILLER            PIC  X(0003).
  4872     05  CREFND1O PIC  Z(7).99-.
  4873*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  92
* EL6311.cbl
  4874     05  FILLER            PIC  X(0003).
  4875     05  CMTHD1O PIC  X(0001).
  4876*    -------------------------------
  4877     05  FILLER            PIC  X(0003).
  4878     05  CKIND2O PIC  X(0002).
  4879*    -------------------------------
  4880     05  FILLER            PIC  X(0003).
  4881     05  CCANDT2O PIC  X(0008).
  4882*    -------------------------------
  4883     05  FILLER            PIC  X(0003).
  4884     05  CREFND2O PIC  Z(7).99-.
  4885*    -------------------------------
  4886     05  FILLER            PIC  X(0003).
  4887     05  CMTHD2O PIC  X(0001).
  4888*    -------------------------------
  4889     05  FILLER            PIC  X(0003).
  4890     05  CLIVESO PIC  X(0003).
  4891*    -------------------------------
  4892     05  FILLER            PIC  X(0003).
  4893     05  CFORCEO PIC  X(0001).
  4894*    -------------------------------
  4895     05  FILLER            PIC  X(0003).
  4896     05  CBILCDO PIC  X(0001).
  4897*    -------------------------------
  4898     05  FILLER            PIC  X(0003).
  4899     05  CCRFND1O PIC  Z(7).99-.
  4900*    -------------------------------
  4901     05  FILLER            PIC  X(0003).
  4902     05  CCRFND2O PIC  Z(7).99-.
  4903*    -------------------------------
  4904     05  FILLER            PIC  X(0003).
  4905     05  CBILIT1O PIC  X(0008).
  4906*    -------------------------------
  4907     05  FILLER            PIC  X(0003).
  4908     05  CDRFND1O PIC  Z(7).99-.
  4909*    -------------------------------
  4910     05  FILLER            PIC  X(0003).
  4911     05  CBILIT2O PIC  X(0008).
  4912*    -------------------------------
  4913     05  FILLER            PIC  X(0003).
  4914     05  CDRFND2O PIC  Z(7).99-.
  4915*    -------------------------------
  4916     05  FILLER            PIC  X(0003).
  4917     05  CCANTXTO PIC  X(0005).
  4918*    -------------------------------
  4919     05  FILLER            PIC  X(0003).
  4920     05  CCANFEEO PIC  Z9.
  4921*    -------------------------------
  4922     05  FILLER            PIC  X(0003).
  4923     05  CTERM1O PIC  ZZ9.
  4924*    -------------------------------
  4925     05  FILLER            PIC  X(0003).
  4926     05  CRTERM1O PIC  ZZ9.
  4927*    -------------------------------
  4928     05  FILLER            PIC  X(0003).
  4929     05  CPREM1O PIC  ZZZZZZ9.99-.
  4930*    -------------------------------
  4931     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  93
* EL6311.cbl
  4932     05  CTERM2O PIC  ZZ9.
  4933*    -------------------------------
  4934     05  FILLER            PIC  X(0003).
  4935     05  CRTERM2O PIC  ZZ9.
  4936*    -------------------------------
  4937     05  FILLER            PIC  X(0003).
  4938     05  CPREM2O PIC  ZZZZZZ9.99-.
  4939*    -------------------------------
  4940     05  FILLER            PIC  X(0003).
  4941     05  CENTRDTO PIC  X(0008).
  4942*    -------------------------------
  4943     05  FILLER            PIC  X(0003).
  4944     05  CPAYEEO PIC  X(0006).
  4945*    -------------------------------
  4946     05  FILLER            PIC  X(0003).
  4947     05  CRFNDSWO PIC  X(0003).
  4948*    -------------------------------
  4949     05  FILLER            PIC  X(0003).
  4950     05  CLFHDGO PIC  X(0006).
  4951*    -------------------------------
  4952     05  FILLER            PIC  X(0003).
  4953     05  CAHHDGO PIC  X(0006).
  4954*    -------------------------------
  4955     05  FILLER            PIC  X(0003).
  4956     05  CENTDTO PIC  X(0008).
  4957*    -------------------------------
  4958     05  FILLER            PIC  X(0003).
  4959     05  CENTBYO PIC  X(0004).
  4960*    -------------------------------
  4961     05  FILLER            PIC  X(0003).
  4962     05  CCHGCNTO PIC  X(0003).
  4963*    -------------------------------
  4964     05  FILLER            PIC  X(0003).
  4965     05  CLFREFNO PIC  X(0006).
  4966*    -------------------------------
  4967     05  FILLER            PIC  X(0003).
  4968     05  CAHREFNO PIC  X(0006).
  4969*    -------------------------------
  4970     05  FILLER            PIC  X(0003).
  4971     05  CREINCDO PIC  X(0003).
  4972*    -------------------------------
  4973     05  FILLER            PIC  X(0003).
  4974     05  CAEFFDTO PIC  X(0008).
  4975*    -------------------------------
  4976     05  FILLER            PIC  X(0003).
  4977     05  CAEXPDTO PIC  X(0008).
  4978*    -------------------------------
  4979     05  FILLER            PIC  X(0003).
  4980     05  COMMLFO PIC  .99999.
  4981*    -------------------------------
  4982     05  FILLER            PIC  X(0003).
  4983     05  COMMAHO PIC  .99999.
  4984*    -------------------------------
  4985     05  FILLER            PIC  X(0003).
  4986     05  CERMSG1O PIC  X(0078).
  4987*    -------------------------------
  4988     05  FILLER            PIC  X(0003).
  4989     05  CERMSG2O PIC  X(0078).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  94
* EL6311.cbl
  4990*    -------------------------------
  4991     05  FILLER            PIC  X(0003).
  4992     05  CERMSG3O PIC  X(0078).
  4993*    -------------------------------
  4994     05  FILLER            PIC  X(0003).
  4995     05  CPFENTRO PIC  X(0002).
  4996*    -------------------------------
  4997     05  FILLER            PIC  X(0003).
  4998     05  CPF5HDRO PIC  X(0005).
  4999*    -------------------------------
  5000     05  FILLER            PIC  X(0003).
  5001     05  CPF4HDRO PIC  X(0013).
  5002*    -------------------------------
  5003     05  FILLER            PIC  X(0003).
  5004     05  CF15HDRO PIC  X(0022).
  5005*    -------------------------------
  5006 01  EL631DI REDEFINES EL631BI.
  5007     05  FILLER            PIC  X(0012).
  5008*    -------------------------------
  5009     05  DDATEL PIC S9(0004) COMP.
  5010     05  DDATEF PIC  X(0001).
  5011     05  FILLER REDEFINES DDATEF.
  5012         10  DDATEA PIC  X(0001).
  5013     05  DDATEI PIC  X(0008).
  5014*    -------------------------------
  5015     05  DTIMEL PIC S9(0004) COMP.
  5016     05  DTIMEF PIC  X(0001).
  5017     05  FILLER REDEFINES DTIMEF.
  5018         10  DTIMEA PIC  X(0001).
  5019     05  DTIMEI PIC  X(0005).
  5020*    -------------------------------
  5021     05  DHEADL PIC S9(0004) COMP.
  5022     05  DHEADF PIC  X(0001).
  5023     05  FILLER REDEFINES DHEADF.
  5024         10  DHEADA PIC  X(0001).
  5025     05  DHEADI PIC  X(0038).
  5026*    -------------------------------
  5027     05  DLDATEL PIC S9(0004) COMP.
  5028     05  DLDATEF PIC  X(0001).
  5029     05  FILLER REDEFINES DLDATEF.
  5030         10  DLDATEA PIC  X(0001).
  5031     05  DLDATEI PIC  X(0010).
  5032*    -------------------------------
  5033     05  DBATCHL PIC S9(0004) COMP.
  5034     05  DBATCHF PIC  X(0001).
  5035     05  FILLER REDEFINES DBATCHF.
  5036         10  DBATCHA PIC  X(0001).
  5037     05  DBATCHI PIC  X(0011).
  5038*    -------------------------------
  5039     05  DACCTNML PIC S9(0004) COMP.
  5040     05  DACCTNMF PIC  X(0001).
  5041     05  FILLER REDEFINES DACCTNMF.
  5042         10  DACCTNMA PIC  X(0001).
  5043     05  DACCTNMI PIC  X(0030).
  5044*    -------------------------------
  5045     05  DPROCDTL PIC S9(0004) COMP.
  5046     05  DPROCDTF PIC  X(0001).
  5047     05  FILLER REDEFINES DPROCDTF.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  95
* EL6311.cbl
  5048         10  DPROCDTA PIC  X(0001).
  5049     05  DPROCDTI PIC  X(0008).
  5050*    -------------------------------
  5051     05  DINPUTL PIC S9(0004) COMP.
  5052     05  DINPUTF PIC  X(0001).
  5053     05  FILLER REDEFINES DINPUTF.
  5054         10  DINPUTA PIC  X(0001).
  5055     05  DINPUTI PIC  X(0008).
  5056*    -------------------------------
  5057     05  DMAINDTL PIC S9(0004) COMP.
  5058     05  DMAINDTF PIC  X(0001).
  5059     05  FILLER REDEFINES DMAINDTF.
  5060         10  DMAINDTA PIC  X(0001).
  5061     05  DMAINDTI PIC  X(0008).
  5062*    -------------------------------
  5063     05  DCARRL PIC S9(0004) COMP.
  5064     05  DCARRF PIC  X(0001).
  5065     05  FILLER REDEFINES DCARRF.
  5066         10  DCARRA PIC  X(0001).
  5067     05  DCARRI PIC  X(0001).
  5068*    -------------------------------
  5069     05  DGROUPL PIC S9(0004) COMP.
  5070     05  DGROUPF PIC  X(0001).
  5071     05  FILLER REDEFINES DGROUPF.
  5072         10  DGROUPA PIC  X(0001).
  5073     05  DGROUPI PIC  X(0006).
  5074*    -------------------------------
  5075     05  DSTATEL PIC S9(0004) COMP.
  5076     05  DSTATEF PIC  X(0001).
  5077     05  FILLER REDEFINES DSTATEF.
  5078         10  DSTATEA PIC  X(0001).
  5079     05  DSTATEI PIC  X(0002).
  5080*    -------------------------------
  5081     05  DACCTL PIC S9(0004) COMP.
  5082     05  DACCTF PIC  X(0001).
  5083     05  FILLER REDEFINES DACCTF.
  5084         10  DACCTA PIC  X(0001).
  5085     05  DACCTI PIC  X(0010).
  5086*    -------------------------------
  5087     05  DRECVDTL PIC S9(0004) COMP.
  5088     05  DRECVDTF PIC  X(0001).
  5089     05  FILLER REDEFINES DRECVDTF.
  5090         10  DRECVDTA PIC  X(0001).
  5091     05  DRECVDTI PIC  X(0008).
  5092*    -------------------------------
  5093     05  DCSRL PIC S9(0004) COMP.
  5094     05  DCSRF PIC  X(0001).
  5095     05  FILLER REDEFINES DCSRF.
  5096         10  DCSRA PIC  X(0001).
  5097     05  DCSRI PIC  X(0004).
  5098*    -------------------------------
  5099     05  DREFHDGL PIC S9(0004) COMP.
  5100     05  DREFHDGF PIC  X(0001).
  5101     05  FILLER REDEFINES DREFHDGF.
  5102         10  DREFHDGA PIC  X(0001).
  5103     05  DREFHDGI PIC  X(0010).
  5104*    -------------------------------
  5105     05  DREFL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  96
* EL6311.cbl
  5106     05  DREFF PIC  X(0001).
  5107     05  FILLER REDEFINES DREFF.
  5108         10  DREFA PIC  X(0001).
  5109     05  DREFI PIC  X(0012).
  5110*    -------------------------------
  5111     05  DLFPHDGL PIC S9(0004) COMP.
  5112     05  DLFPHDGF PIC  X(0001).
  5113     05  FILLER REDEFINES DLFPHDGF.
  5114         10  DLFPHDGA PIC  X(0001).
  5115     05  DLFPHDGI PIC  X(0010).
  5116*    -------------------------------
  5117     05  DAHPHDGL PIC S9(0004) COMP.
  5118     05  DAHPHDGF PIC  X(0001).
  5119     05  FILLER REDEFINES DAHPHDGF.
  5120         10  DAHPHDGA PIC  X(0001).
  5121     05  DAHPHDGI PIC  X(0010).
  5122*    -------------------------------
  5123     05  DLFRHDGL PIC S9(0004) COMP.
  5124     05  DLFRHDGF PIC  X(0001).
  5125     05  FILLER REDEFINES DLFRHDGF.
  5126         10  DLFRHDGA PIC  X(0001).
  5127     05  DLFRHDGI PIC  X(0009).
  5128*    -------------------------------
  5129     05  DAHRHDGL PIC S9(0004) COMP.
  5130     05  DAHRHDGF PIC  X(0001).
  5131     05  FILLER REDEFINES DAHRHDGF.
  5132         10  DAHRHDGA PIC  X(0001).
  5133     05  DAHRHDGI PIC  X(0009).
  5134*    -------------------------------
  5135     05  DRISSL PIC S9(0004) COMP.
  5136     05  DRISSF PIC  X(0001).
  5137     05  FILLER REDEFINES DRISSF.
  5138         10  DRISSA PIC  X(0001).
  5139     05  DRISSI PIC  X(0005).
  5140*    -------------------------------
  5141     05  DRLFPRML PIC S9(0004) COMP.
  5142     05  DRLFPRMF PIC  X(0001).
  5143     05  FILLER REDEFINES DRLFPRMF.
  5144         10  DRLFPRMA PIC  X(0001).
  5145     05  DRLFPRMI PIC  S9(9)V99.
  5146*    -------------------------------
  5147     05  DRAHPRML PIC S9(0004) COMP.
  5148     05  DRAHPRMF PIC  X(0001).
  5149     05  FILLER REDEFINES DRAHPRMF.
  5150         10  DRAHPRMA PIC  X(0001).
  5151     05  DRAHPRMI PIC  S9(9)V99.
  5152*    -------------------------------
  5153     05  DRCANCL PIC S9(0004) COMP.
  5154     05  DRCANCF PIC  X(0001).
  5155     05  FILLER REDEFINES DRCANCF.
  5156         10  DRCANCA PIC  X(0001).
  5157     05  DRCANCI PIC  X(0005).
  5158*    -------------------------------
  5159     05  DRLFRFDL PIC S9(0004) COMP.
  5160     05  DRLFRFDF PIC  X(0001).
  5161     05  FILLER REDEFINES DRLFRFDF.
  5162         10  DRLFRFDA PIC  X(0001).
  5163     05  DRLFRFDI PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  97
* EL6311.cbl
  5164*    -------------------------------
  5165     05  DRAHRFDL PIC S9(0004) COMP.
  5166     05  DRAHRFDF PIC  X(0001).
  5167     05  FILLER REDEFINES DRAHRFDF.
  5168         10  DRAHRFDA PIC  X(0001).
  5169     05  DRAHRFDI PIC  S9(9)V99.
  5170*    -------------------------------
  5171     05  DEISSL PIC S9(0004) COMP.
  5172     05  DEISSF PIC  X(0001).
  5173     05  FILLER REDEFINES DEISSF.
  5174         10  DEISSA PIC  X(0001).
  5175     05  DEISSI PIC  X(0005).
  5176*    -------------------------------
  5177     05  DELFPRML PIC S9(0004) COMP.
  5178     05  DELFPRMF PIC  X(0001).
  5179     05  FILLER REDEFINES DELFPRMF.
  5180         10  DELFPRMA PIC  X(0001).
  5181     05  DELFPRMI PIC  X(0011).
  5182*    -------------------------------
  5183     05  DEAHPRML PIC S9(0004) COMP.
  5184     05  DEAHPRMF PIC  X(0001).
  5185     05  FILLER REDEFINES DEAHPRMF.
  5186         10  DEAHPRMA PIC  X(0001).
  5187     05  DEAHPRMI PIC  X(0011).
  5188*    -------------------------------
  5189     05  DECANCL PIC S9(0004) COMP.
  5190     05  DECANCF PIC  X(0001).
  5191     05  FILLER REDEFINES DECANCF.
  5192         10  DECANCA PIC  X(0001).
  5193     05  DECANCI PIC  X(0005).
  5194*    -------------------------------
  5195     05  DELFRFDL PIC S9(0004) COMP.
  5196     05  DELFRFDF PIC  X(0001).
  5197     05  FILLER REDEFINES DELFRFDF.
  5198         10  DELFRFDA PIC  X(0001).
  5199     05  DELFRFDI PIC  X(0011).
  5200*    -------------------------------
  5201     05  DEAHRFDL PIC S9(0004) COMP.
  5202     05  DEAHRFDF PIC  X(0001).
  5203     05  FILLER REDEFINES DEAHRFDF.
  5204         10  DEAHRFDA PIC  X(0001).
  5205     05  DEAHRFDI PIC  X(0011).
  5206*    -------------------------------
  5207     05  DCISSL PIC S9(0004) COMP.
  5208     05  DCISSF PIC  X(0001).
  5209     05  FILLER REDEFINES DCISSF.
  5210         10  DCISSA PIC  X(0001).
  5211     05  DCISSI PIC  X(0005).
  5212*    -------------------------------
  5213     05  DCLFPRML PIC S9(0004) COMP.
  5214     05  DCLFPRMF PIC  X(0001).
  5215     05  FILLER REDEFINES DCLFPRMF.
  5216         10  DCLFPRMA PIC  X(0001).
  5217     05  DCLFPRMI PIC  X(0011).
  5218*    -------------------------------
  5219     05  DCAHPRML PIC S9(0004) COMP.
  5220     05  DCAHPRMF PIC  X(0001).
  5221     05  FILLER REDEFINES DCAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  98
* EL6311.cbl
  5222         10  DCAHPRMA PIC  X(0001).
  5223     05  DCAHPRMI PIC  X(0011).
  5224*    -------------------------------
  5225     05  DCCANCL PIC S9(0004) COMP.
  5226     05  DCCANCF PIC  X(0001).
  5227     05  FILLER REDEFINES DCCANCF.
  5228         10  DCCANCA PIC  X(0001).
  5229     05  DCCANCI PIC  X(0005).
  5230*    -------------------------------
  5231     05  DCLFRFDL PIC S9(0004) COMP.
  5232     05  DCLFRFDF PIC  X(0001).
  5233     05  FILLER REDEFINES DCLFRFDF.
  5234         10  DCLFRFDA PIC  X(0001).
  5235     05  DCLFRFDI PIC  X(0011).
  5236*    -------------------------------
  5237     05  DCAHRFDL PIC S9(0004) COMP.
  5238     05  DCAHRFDF PIC  X(0001).
  5239     05  FILLER REDEFINES DCAHRFDF.
  5240         10  DCAHRFDA PIC  X(0001).
  5241     05  DCAHRFDI PIC  X(0011).
  5242*    -------------------------------
  5243     05  DOISSL PIC S9(0004) COMP.
  5244     05  DOISSF PIC  X(0001).
  5245     05  FILLER REDEFINES DOISSF.
  5246         10  DOISSA PIC  X(0001).
  5247     05  DOISSI PIC  X(0005).
  5248*    -------------------------------
  5249     05  DOLFPRML PIC S9(0004) COMP.
  5250     05  DOLFPRMF PIC  X(0001).
  5251     05  FILLER REDEFINES DOLFPRMF.
  5252         10  DOLFPRMA PIC  X(0001).
  5253     05  DOLFPRMI PIC  X(0011).
  5254*    -------------------------------
  5255     05  DOAHPRML PIC S9(0004) COMP.
  5256     05  DOAHPRMF PIC  X(0001).
  5257     05  FILLER REDEFINES DOAHPRMF.
  5258         10  DOAHPRMA PIC  X(0001).
  5259     05  DOAHPRMI PIC  X(0011).
  5260*    -------------------------------
  5261     05  DOCANCL PIC S9(0004) COMP.
  5262     05  DOCANCF PIC  X(0001).
  5263     05  FILLER REDEFINES DOCANCF.
  5264         10  DOCANCA PIC  X(0001).
  5265     05  DOCANCI PIC  X(0005).
  5266*    -------------------------------
  5267     05  DOLFRFDL PIC S9(0004) COMP.
  5268     05  DOLFRFDF PIC  X(0001).
  5269     05  FILLER REDEFINES DOLFRFDF.
  5270         10  DOLFRFDA PIC  X(0001).
  5271     05  DOLFRFDI PIC  X(0011).
  5272*    -------------------------------
  5273     05  DOAHRFDL PIC S9(0004) COMP.
  5274     05  DOAHRFDF PIC  X(0001).
  5275     05  FILLER REDEFINES DOAHRFDF.
  5276         10  DOAHRFDA PIC  X(0001).
  5277     05  DOAHRFDI PIC  X(0011).
  5278*    -------------------------------
  5279     05  DITOTALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page  99
* EL6311.cbl
  5280     05  DITOTALF PIC  X(0001).
  5281     05  FILLER REDEFINES DITOTALF.
  5282         10  DITOTALA PIC  X(0001).
  5283     05  DITOTALI PIC  X(0005).
  5284*    -------------------------------
  5285     05  DIFATALL PIC S9(0004) COMP.
  5286     05  DIFATALF PIC  X(0001).
  5287     05  FILLER REDEFINES DIFATALF.
  5288         10  DIFATALA PIC  X(0001).
  5289     05  DIFATALI PIC  X(0005).
  5290*    -------------------------------
  5291     05  DIFORCEL PIC S9(0004) COMP.
  5292     05  DIFORCEF PIC  X(0001).
  5293     05  FILLER REDEFINES DIFORCEF.
  5294         10  DIFORCEA PIC  X(0001).
  5295     05  DIFORCEI PIC  X(0005).
  5296*    -------------------------------
  5297     05  DIHOLDL PIC S9(0004) COMP.
  5298     05  DIHOLDF PIC  X(0001).
  5299     05  FILLER REDEFINES DIHOLDF.
  5300         10  DIHOLDA PIC  X(0001).
  5301     05  DIHOLDI PIC  X(0005).
  5302*    -------------------------------
  5303     05  DIAVAILL PIC S9(0004) COMP.
  5304     05  DIAVAILF PIC  X(0001).
  5305     05  FILLER REDEFINES DIAVAILF.
  5306         10  DIAVAILA PIC  X(0001).
  5307     05  DIAVAILI PIC  X(0005).
  5308*    -------------------------------
  5309     05  DIGPREML PIC S9(0004) COMP.
  5310     05  DIGPREMF PIC  X(0001).
  5311     05  FILLER REDEFINES DIGPREMF.
  5312         10  DIGPREMA PIC  X(0001).
  5313     05  DIGPREMI PIC  X(0011).
  5314*    -------------------------------
  5315     05  DIBPREML PIC S9(0004) COMP.
  5316     05  DIBPREMF PIC  X(0001).
  5317     05  FILLER REDEFINES DIBPREMF.
  5318         10  DIBPREMA PIC  X(0001).
  5319     05  DIBPREMI PIC  X(0011).
  5320*    -------------------------------
  5321     05  DCTOTALL PIC S9(0004) COMP.
  5322     05  DCTOTALF PIC  X(0001).
  5323     05  FILLER REDEFINES DCTOTALF.
  5324         10  DCTOTALA PIC  X(0001).
  5325     05  DCTOTALI PIC  X(0005).
  5326*    -------------------------------
  5327     05  DCFATALL PIC S9(0004) COMP.
  5328     05  DCFATALF PIC  X(0001).
  5329     05  FILLER REDEFINES DCFATALF.
  5330         10  DCFATALA PIC  X(0001).
  5331     05  DCFATALI PIC  X(0005).
  5332*    -------------------------------
  5333     05  DCFORCEL PIC S9(0004) COMP.
  5334     05  DCFORCEF PIC  X(0001).
  5335     05  FILLER REDEFINES DCFORCEF.
  5336         10  DCFORCEA PIC  X(0001).
  5337     05  DCFORCEI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 100
* EL6311.cbl
  5338*    -------------------------------
  5339     05  DCHOLDL PIC S9(0004) COMP.
  5340     05  DCHOLDF PIC  X(0001).
  5341     05  FILLER REDEFINES DCHOLDF.
  5342         10  DCHOLDA PIC  X(0001).
  5343     05  DCHOLDI PIC  X(0005).
  5344*    -------------------------------
  5345     05  DCAVAILL PIC S9(0004) COMP.
  5346     05  DCAVAILF PIC  X(0001).
  5347     05  FILLER REDEFINES DCAVAILF.
  5348         10  DCAVAILA PIC  X(0001).
  5349     05  DCAVAILI PIC  X(0005).
  5350*    -------------------------------
  5351     05  DCGPREML PIC S9(0004) COMP.
  5352     05  DCGPREMF PIC  X(0001).
  5353     05  FILLER REDEFINES DCGPREMF.
  5354         10  DCGPREMA PIC  X(0001).
  5355     05  DCGPREMI PIC  X(0011).
  5356*    -------------------------------
  5357     05  DCBPREML PIC S9(0004) COMP.
  5358     05  DCBPREMF PIC  X(0001).
  5359     05  FILLER REDEFINES DCBPREMF.
  5360         10  DCBPREMA PIC  X(0001).
  5361     05  DCBPREMI PIC  X(0011).
  5362*    -------------------------------
  5363     05  DNTOTALL PIC S9(0004) COMP.
  5364     05  DNTOTALF PIC  X(0001).
  5365     05  FILLER REDEFINES DNTOTALF.
  5366         10  DNTOTALA PIC  X(0001).
  5367     05  DNTOTALI PIC  X(0005).
  5368*    -------------------------------
  5369     05  DNFATALL PIC S9(0004) COMP.
  5370     05  DNFATALF PIC  X(0001).
  5371     05  FILLER REDEFINES DNFATALF.
  5372         10  DNFATALA PIC  X(0001).
  5373     05  DNFATALI PIC  X(0005).
  5374*    -------------------------------
  5375     05  DNFORCEL PIC S9(0004) COMP.
  5376     05  DNFORCEF PIC  X(0001).
  5377     05  FILLER REDEFINES DNFORCEF.
  5378         10  DNFORCEA PIC  X(0001).
  5379     05  DNFORCEI PIC  X(0005).
  5380*    -------------------------------
  5381     05  DNHOLDL PIC S9(0004) COMP.
  5382     05  DNHOLDF PIC  X(0001).
  5383     05  FILLER REDEFINES DNHOLDF.
  5384         10  DNHOLDA PIC  X(0001).
  5385     05  DNHOLDI PIC  X(0005).
  5386*    -------------------------------
  5387     05  DNAVAILL PIC S9(0004) COMP.
  5388     05  DNAVAILF PIC  X(0001).
  5389     05  FILLER REDEFINES DNAVAILF.
  5390         10  DNAVAILA PIC  X(0001).
  5391     05  DNAVAILI PIC  X(0005).
  5392*    -------------------------------
  5393     05  DNGPREML PIC S9(0004) COMP.
  5394     05  DNGPREMF PIC  X(0001).
  5395     05  FILLER REDEFINES DNGPREMF.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 101
* EL6311.cbl
  5396         10  DNGPREMA PIC  X(0001).
  5397     05  DNGPREMI PIC  X(0011).
  5398*    -------------------------------
  5399     05  DNBPREML PIC S9(0004) COMP.
  5400     05  DNBPREMF PIC  X(0001).
  5401     05  FILLER REDEFINES DNBPREMF.
  5402         10  DNBPREMA PIC  X(0001).
  5403     05  DNBPREMI PIC  X(0011).
  5404*    -------------------------------
  5405     05  DERMSGL PIC S9(0004) COMP.
  5406     05  DERMSGF PIC  X(0001).
  5407     05  FILLER REDEFINES DERMSGF.
  5408         10  DERMSGA PIC  X(0001).
  5409     05  DERMSGI PIC  X(0075).
  5410*    -------------------------------
  5411     05  DPFENTRL PIC S9(0004) COMP.
  5412     05  DPFENTRF PIC  X(0001).
  5413     05  FILLER REDEFINES DPFENTRF.
  5414         10  DPFENTRA PIC  X(0001).
  5415     05  DPFENTRI PIC  9(2).
  5416 01  EL631DO REDEFINES EL631BI.
  5417     05  FILLER            PIC  X(0012).
  5418*    -------------------------------
  5419     05  FILLER            PIC  X(0003).
  5420     05  DDATEO PIC  X(0008).
  5421*    -------------------------------
  5422     05  FILLER            PIC  X(0003).
  5423     05  DTIMEO PIC  99.99.
  5424*    -------------------------------
  5425     05  FILLER            PIC  X(0003).
  5426     05  DHEADO PIC  X(0038).
  5427*    -------------------------------
  5428     05  FILLER            PIC  X(0003).
  5429     05  DLDATEO PIC  X(0010).
  5430*    -------------------------------
  5431     05  FILLER            PIC  X(0003).
  5432     05  DBATCHO PIC  X(0011).
  5433*    -------------------------------
  5434     05  FILLER            PIC  X(0003).
  5435     05  DACCTNMO PIC  X(0030).
  5436*    -------------------------------
  5437     05  FILLER            PIC  X(0003).
  5438     05  DPROCDTO PIC  X(0008).
  5439*    -------------------------------
  5440     05  FILLER            PIC  X(0003).
  5441     05  DINPUTO PIC  X(0008).
  5442*    -------------------------------
  5443     05  FILLER            PIC  X(0003).
  5444     05  DMAINDTO PIC  X(0008).
  5445*    -------------------------------
  5446     05  FILLER            PIC  X(0003).
  5447     05  DCARRO PIC  X(0001).
  5448*    -------------------------------
  5449     05  FILLER            PIC  X(0003).
  5450     05  DGROUPO PIC  X(0006).
  5451*    -------------------------------
  5452     05  FILLER            PIC  X(0003).
  5453     05  DSTATEO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 102
* EL6311.cbl
  5454*    -------------------------------
  5455     05  FILLER            PIC  X(0003).
  5456     05  DACCTO PIC  X(0010).
  5457*    -------------------------------
  5458     05  FILLER            PIC  X(0003).
  5459     05  DRECVDTO PIC  X(0008).
  5460*    -------------------------------
  5461     05  FILLER            PIC  X(0003).
  5462     05  DCSRO PIC  X(0004).
  5463*    -------------------------------
  5464     05  FILLER            PIC  X(0003).
  5465     05  DREFHDGO PIC  X(0010).
  5466*    -------------------------------
  5467     05  FILLER            PIC  X(0003).
  5468     05  DREFO PIC  X(0012).
  5469*    -------------------------------
  5470     05  FILLER            PIC  X(0003).
  5471     05  DLFPHDGO PIC  X(0010).
  5472*    -------------------------------
  5473     05  FILLER            PIC  X(0003).
  5474     05  DAHPHDGO PIC  X(0010).
  5475*    -------------------------------
  5476     05  FILLER            PIC  X(0003).
  5477     05  DLFRHDGO PIC  X(0009).
  5478*    -------------------------------
  5479     05  FILLER            PIC  X(0003).
  5480     05  DAHRHDGO PIC  X(0009).
  5481*    -------------------------------
  5482     05  FILLER            PIC  X(0003).
  5483     05  DRISSO PIC  ZZ99-.
  5484*    -------------------------------
  5485     05  FILLER            PIC  X(0003).
  5486     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5487*    -------------------------------
  5488     05  FILLER            PIC  X(0003).
  5489     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5490*    -------------------------------
  5491     05  FILLER            PIC  X(0003).
  5492     05  DRCANCO PIC  ZZ99-.
  5493*    -------------------------------
  5494     05  FILLER            PIC  X(0003).
  5495     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5496*    -------------------------------
  5497     05  FILLER            PIC  X(0003).
  5498     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5499*    -------------------------------
  5500     05  FILLER            PIC  X(0003).
  5501     05  DEISSO PIC  ZZ99-.
  5502*    -------------------------------
  5503     05  FILLER            PIC  X(0003).
  5504     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5505*    -------------------------------
  5506     05  FILLER            PIC  X(0003).
  5507     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5508*    -------------------------------
  5509     05  FILLER            PIC  X(0003).
  5510     05  DECANCO PIC  ZZ99-.
  5511*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 103
* EL6311.cbl
  5512     05  FILLER            PIC  X(0003).
  5513     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5514*    -------------------------------
  5515     05  FILLER            PIC  X(0003).
  5516     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5517*    -------------------------------
  5518     05  FILLER            PIC  X(0003).
  5519     05  DCISSO PIC  ZZ99-.
  5520*    -------------------------------
  5521     05  FILLER            PIC  X(0003).
  5522     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5523*    -------------------------------
  5524     05  FILLER            PIC  X(0003).
  5525     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5526*    -------------------------------
  5527     05  FILLER            PIC  X(0003).
  5528     05  DCCANCO PIC  ZZ99-.
  5529*    -------------------------------
  5530     05  FILLER            PIC  X(0003).
  5531     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5532*    -------------------------------
  5533     05  FILLER            PIC  X(0003).
  5534     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5535*    -------------------------------
  5536     05  FILLER            PIC  X(0003).
  5537     05  DOISSO PIC  ZZ99-.
  5538*    -------------------------------
  5539     05  FILLER            PIC  X(0003).
  5540     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5541*    -------------------------------
  5542     05  FILLER            PIC  X(0003).
  5543     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5544*    -------------------------------
  5545     05  FILLER            PIC  X(0003).
  5546     05  DOCANCO PIC  ZZ99-.
  5547*    -------------------------------
  5548     05  FILLER            PIC  X(0003).
  5549     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5550*    -------------------------------
  5551     05  FILLER            PIC  X(0003).
  5552     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5553*    -------------------------------
  5554     05  FILLER            PIC  X(0003).
  5555     05  DITOTALO PIC  ZZZ99.
  5556*    -------------------------------
  5557     05  FILLER            PIC  X(0003).
  5558     05  DIFATALO PIC  ZZZ99.
  5559*    -------------------------------
  5560     05  FILLER            PIC  X(0003).
  5561     05  DIFORCEO PIC  ZZZ99.
  5562*    -------------------------------
  5563     05  FILLER            PIC  X(0003).
  5564     05  DIHOLDO PIC  ZZZ99.
  5565*    -------------------------------
  5566     05  FILLER            PIC  X(0003).
  5567     05  DIAVAILO PIC  ZZZ99.
  5568*    -------------------------------
  5569     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 104
* EL6311.cbl
  5570     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5571*    -------------------------------
  5572     05  FILLER            PIC  X(0003).
  5573     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5574*    -------------------------------
  5575     05  FILLER            PIC  X(0003).
  5576     05  DCTOTALO PIC  ZZZ99.
  5577*    -------------------------------
  5578     05  FILLER            PIC  X(0003).
  5579     05  DCFATALO PIC  ZZZ99.
  5580*    -------------------------------
  5581     05  FILLER            PIC  X(0003).
  5582     05  DCFORCEO PIC  ZZZ99.
  5583*    -------------------------------
  5584     05  FILLER            PIC  X(0003).
  5585     05  DCHOLDO PIC  ZZZ99.
  5586*    -------------------------------
  5587     05  FILLER            PIC  X(0003).
  5588     05  DCAVAILO PIC  ZZZ99.
  5589*    -------------------------------
  5590     05  FILLER            PIC  X(0003).
  5591     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5592*    -------------------------------
  5593     05  FILLER            PIC  X(0003).
  5594     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5595*    -------------------------------
  5596     05  FILLER            PIC  X(0003).
  5597     05  DNTOTALO PIC  ---99.
  5598*    -------------------------------
  5599     05  FILLER            PIC  X(0003).
  5600     05  DNFATALO PIC  ---99.
  5601*    -------------------------------
  5602     05  FILLER            PIC  X(0003).
  5603     05  DNFORCEO PIC  ---99.
  5604*    -------------------------------
  5605     05  FILLER            PIC  X(0003).
  5606     05  DNHOLDO PIC  ---99.
  5607*    -------------------------------
  5608     05  FILLER            PIC  X(0003).
  5609     05  DNAVAILO PIC  ---99.
  5610*    -------------------------------
  5611     05  FILLER            PIC  X(0003).
  5612     05  DNGPREMO PIC  -------9.99.
  5613*    -------------------------------
  5614     05  FILLER            PIC  X(0003).
  5615     05  DNBPREMO PIC  -------9.99.
  5616*    -------------------------------
  5617     05  FILLER            PIC  X(0003).
  5618     05  DERMSGO PIC  X(0075).
  5619*    -------------------------------
  5620     05  FILLER            PIC  X(0003).
  5621     05  DPFENTRO PIC  X(0002).
  5622*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 105
* EL6311.cbl
  5624 01  MAP-B REDEFINES EL631BI.
  5625     12  FILLER                  PIC X(569).
  5626*    12  FILLER                  PIC X(512).
  5627*    12  FILLER                  PIC X(510).
  5628     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5629         16  BKIND-LEN               PIC S9(4)  COMP.
  5630         16  BKIND-ATTRB             PIC X.
  5631         16  BKIND                   PIC XX.
  5632         16  BTYPE-LEN               PIC S9(4)  COMP.
  5633         16  BTYPE-ATTRB             PIC X.
  5634         16  BTYPE                   PIC X(3).
  5635         16  BTERM-LEN               PIC S9(4)  COMP.
  5636         16  BTERM-ATTRB             PIC X.
  5637         16  BTERMI                  PIC 999.
  5638         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5639         16  BBEN-LEN                PIC S9(4)  COMP.
  5640         16  BBEN-ATTRB              PIC X.
  5641         16  BBENI                   PIC 9(10)V99.
  5642*        16  BBENI                   PIC 9(12).
  5643         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5644         16  BPREM-LEN               PIC S9(4)  COMP.
  5645         16  BPREM-ATTRB             PIC X.
  5646         16  BPREMI                  PIC S9(9)V99.
  5647*        16  BPREMI                  PIC 9(11).
  5648         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5649         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5650         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5651         16  BEXPIRE-ATTRB           PIC X.
  5652         16  BEXPIRE                 PIC X(8).
  5653         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5654         16  BCRIT-PERD-ATTRB        PIC X.
  5655         16  BCRIT-PERDI             PIC 99.
  5656         16  BCRIT-PERDO REDEFINES
  5657                         BCRIT-PERDI PIC ZZ.
  5658         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5659         16  BALT-BEN-ATTRB          PIC X.
  5660         16  BALT-BENI               PIC 9(10)V99.
  5661*        16  BALT-BENI               PIC 9(12).
  5662         16  BALT-BENO REDEFINES
  5663                           BALT-BENI PIC Z(9).ZZ.
  5664         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5665         16  BALT-PREM-ATTRB         PIC X.
  5666         16  BALT-PREMI              PIC 9(9)V99.
  5667*        16  BALT-PREMI              PIC 9(11).
  5668         16  BALT-PREMO REDEFINES
  5669                          BALT-PREMI PIC Z(7).ZZ-.
  5670         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5671         16  BBEN-CD-ATTRB           PIC X.
  5672         16  BBEN-CD                 PIC XXX.
  5673         16  BCPREM-LEN              PIC S9(4)  COMP.
  5674         16  BCPREM-ATTRB            PIC X.
  5675         16  BCPREMI                 PIC S9(9)V99.
  5676*        16  BCPREMI                 PIC X(11).
  5677         16  BCPREMO REDEFINES BCPREMI
  5678                                     PIC Z(7).99-.
  5679         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5680         16  BCALT-PREM-ATTRB        PIC X.
  5681         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 106
* EL6311.cbl
  5682         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5683         16  BBEN-ABBR-ATTRB         PIC X.
  5684         16  BBEN-ABBR               PIC X(5).
  5685         16  BDIFF-LEN               PIC S9(4)  COMP.
  5686         16  BDIFF-ATTRB             PIC X.
  5687         16  BDIFFO                  PIC Z(7).99-.
  5688         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5689         16  BBILL-LIT-ATTRB         PIC X.
  5690         16  BBILL-LIT               PIC X(8).
  5691         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5692         16  BDALT-PREM-ATTRB        PIC X.
  5693         16  BDALT-PREM              PIC Z(7).99-.
  5694
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 107
* EL6311.cbl
  5696
  5697****************************************************************
  5698*
  5699* Copyright (c) 2007 by Clerity Solutions, Inc.
  5700* All rights reserved.
  5701*
  5702****************************************************************
  5703 01  DFHEIV.
  5704   02  DFHEIV0               PIC X(35).
  5705   02  DFHEIV1               PIC X(08).
  5706   02  DFHEIV2               PIC X(08).
  5707   02  DFHEIV3               PIC X(08).
  5708   02  DFHEIV4               PIC X(06).
  5709   02  DFHEIV5               PIC X(04).
  5710   02  DFHEIV6               PIC X(04).
  5711   02  DFHEIV7               PIC X(02).
  5712   02  DFHEIV8               PIC X(02).
  5713   02  DFHEIV9               PIC X(01).
  5714   02  DFHEIV10              PIC S9(7) COMP-3.
  5715   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5716   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5717   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5718   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5719   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5720   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5721   02  DFHEIV17              PIC X(04).
  5722   02  DFHEIV18              PIC X(04).
  5723   02  DFHEIV19              PIC X(04).
  5724   02  DFHEIV20              USAGE IS POINTER.
  5725   02  DFHEIV21              USAGE IS POINTER.
  5726   02  DFHEIV22              USAGE IS POINTER.
  5727   02  DFHEIV23              USAGE IS POINTER.
  5728   02  DFHEIV24              USAGE IS POINTER.
  5729   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5730   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5731   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5732   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5733   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5734   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5735   02  FILLER                PIC X(02).
  5736   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5737   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5738   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5739   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5740   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5741 LINKAGE  SECTION.
  5742*****************************************************************
  5743*                                                               *
  5744* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5745* All rights reserved.                                          *
  5746*                                                               *
  5747*****************************************************************
  5748 01  dfheiblk.
  5749     02  eibtime          pic s9(7) comp-3.
  5750     02  eibdate          pic s9(7) comp-3.
  5751     02  eibtrnid         pic x(4).
  5752     02  eibtaskn         pic s9(7) comp-3.
  5753     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 108
* EL6311.cbl
  5754     02  dfheigdi         pic s9(4) comp.
  5755     02  eibcposn         pic s9(4) comp.
  5756     02  eibcalen         pic s9(4) comp.
  5757     02  eibaid           pic x(1).
  5758     02  eibfiller1       pic x(1).
  5759     02  eibfn            pic x(2).
  5760     02  eibfiller2       pic x(2).
  5761     02  eibrcode         pic x(6).
  5762     02  eibfiller3       pic x(2).
  5763     02  eibds            pic x(8).
  5764     02  eibreqid         pic x(8).
  5765     02  eibrsrce         pic x(8).
  5766     02  eibsync          pic x(1).
  5767     02  eibfree          pic x(1).
  5768     02  eibrecv          pic x(1).
  5769     02  eibsend          pic x(1).
  5770     02  eibatt           pic x(1).
  5771     02  eibeoc           pic x(1).
  5772     02  eibfmh           pic x(1).
  5773     02  eibcompl         pic x(1).
  5774     02  eibsig           pic x(1).
  5775     02  eibconf          pic x(1).
  5776     02  eiberr           pic x(1).
  5777     02  eibrldbk         pic x(1).
  5778     02  eiberrcd         pic x(4).
  5779     02  eibsynrb         pic x(1).
  5780     02  eibnodat         pic x(1).
  5781     02  eibfiller5       pic x(2).
  5782     02  eibresp          pic 9(09) comp.
  5783     02  eibresp2         pic 9(09) comp.
  5784     02  dfheigdj         pic s9(4) comp.
  5785     02  dfheigdk         pic s9(4) comp.
  5786 01  DFHCOMMAREA                 PIC X(1300).
  5787*                                COPY ERCPNDB.
  5788******************************************************************
  5789*                                                                *
  5790*                                                                *
  5791*                            ERCPNDB.                            *
  5792*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5793*                            VMOD=2.025                          *
  5794*                                                                *
  5795*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5796*                                                                *
  5797******************************************************************
  5798*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5799*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5800******************************************************************
  5801*                                                                *
  5802*                                                                *
  5803*   FILE TYPE = VSAM,KSDS                                        *
  5804*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5805*                                                                *
  5806*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5807*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5808*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5809*                                                 RKP=13,LEN=36  *
  5810*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5811*                                      AND CHG-SEQ.)             *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 109
* EL6311.cbl
  5812*                                                RKP=49,LEN=11   *
  5813*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5814*                                      AND CHG-SEQ.)             *
  5815*                                                RKP=60,LEN=15   *
  5816*                                                                *
  5817*   LOG = NO                                                     *
  5818*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5819******************************************************************
  5820******************************************************************
  5821*                   C H A N G E   L O G
  5822*
  5823* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5824*-----------------------------------------------------------------
  5825*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5826* EFFECTIVE    NUMBER
  5827*-----------------------------------------------------------------
  5828* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5829* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5830* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5831* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5832* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5833* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5834* 032306                   PEMA  ADD BOW LOAN NUMBER
  5835* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5836* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5837* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5838* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5839* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5840* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5841* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5842* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5843******************************************************************
  5844
  5845 01  PENDING-BUSINESS.
  5846     12  PB-RECORD-ID                     PIC XX.
  5847         88  VALID-PB-ID                        VALUE 'PB'.
  5848
  5849     12  PB-CONTROL-PRIMARY.
  5850         16  PB-COMPANY-CD                PIC X.
  5851         16  PB-ENTRY-BATCH               PIC X(6).
  5852         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5853         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5854
  5855     12  PB-CONTROL-BY-ACCOUNT.
  5856         16  PB-COMPANY-CD-A1             PIC X.
  5857         16  PB-CARRIER                   PIC X.
  5858         16  PB-GROUPING.
  5859             20  PB-GROUPING-PREFIX       PIC XXX.
  5860             20  PB-GROUPING-PRIME        PIC XXX.
  5861         16  PB-STATE                     PIC XX.
  5862         16  PB-ACCOUNT.
  5863             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5864             20  PB-ACCOUNT-PRIME         PIC X(6).
  5865         16  PB-CERT-EFF-DT               PIC XX.
  5866         16  PB-CERT-NO.
  5867             20  PB-CERT-PRIME            PIC X(10).
  5868             20  PB-CERT-SFX              PIC X.
  5869         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 110
* EL6311.cbl
  5870
  5871         16  PB-RECORD-TYPE               PIC X.
  5872             88  PB-MAILING-DATA                VALUE '0'.
  5873             88  PB-ISSUE                       VALUE '1'.
  5874             88  PB-CANCELLATION                VALUE '2'.
  5875             88  PB-BATCH-TRAILER               VALUE '9'.
  5876
  5877     12  PB-CONTROL-BY-ORIG-BATCH.
  5878         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5879         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5880         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5881         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5882
  5883     12  PB-CONTROL-BY-CSR.
  5884         16  PB-CSR-COMPANY-CD            PIC X.
  5885         16  PB-CSR-ID                    PIC X(4).
  5886         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5887         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5888         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5889******************************************************************
  5890*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5891******************************************************************
  5892
  5893     12  PB-LAST-MAINT-DT                 PIC XX.
  5894     12  PB-LAST-MAINT-BY                 PIC X(4).
  5895     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5896
  5897     12  PB-RECORD-BODY                   PIC X(375).
  5898
  5899     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5900         16  PB-CERT-ORIGIN               PIC X.
  5901             88  CLASIC-CREATED-CERT         VALUE '1'.
  5902         16  PB-I-NAME.
  5903             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5904             20  PB-I-INSURED-FIRST-NAME.
  5905                 24  PB-I-INSURED-1ST-INIT PIC X.
  5906                 24  FILLER                PIC X(9).
  5907             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5908         16  PB-I-AGE                     PIC S99   COMP-3.
  5909         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5910         16  PB-I-BIRTHDAY                PIC XX.
  5911         16  PB-I-INSURED-SEX             PIC X.
  5912             88  PB-SEX-MALE     VALUE 'M'.
  5913             88  PB-SEX-FEMALE   VALUE 'F'.
  5914
  5915         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5916         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5917         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5918         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5919         16  PB-I-SKIP-CODE               PIC X.
  5920             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5921             88  PB-SKIP-JULY              VALUE '1'.
  5922             88  PB-SKIP-AUGUST            VALUE '2'.
  5923             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5924             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5925             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5926             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5927             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 111
* EL6311.cbl
  5928             88  PB-SKIP-JUNE              VALUE '8'.
  5929             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5930             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5931             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5932         16  PB-I-TERM-TYPE               PIC X.
  5933             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5934             88  PB-PAID-WEEKLY            VALUE 'W'.
  5935             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5936             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5937             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5938         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5939         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5940         16  PB-I-DATA-ENTRY-SW           PIC X.
  5941             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5942             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5943             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5944             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5945         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5946         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5947*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5948         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5949         16  FILLER                       PIC X.
  5950
  5951         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5952             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5953             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5954                                                   '90' THRU '99'.
  5955         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5956                                          PIC XX.
  5957         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5958         16  PB-I-AMOUNT-FINANCED REDEFINES
  5959                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5960         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  5961         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5962                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5963         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5964         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5965         16  PB-I-CLP-AMOUNT REDEFINES
  5966                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5967         16  PB-I-LF-CALC-FLAG            PIC X.
  5968             88 PB-COMP-LF-PREM               VALUE '?'.
  5969         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5970         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5971         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5972         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5973         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5974         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5975         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5976         16  PB-I-LF-ABBR                 PIC XXX.
  5977         16  PB-I-LF-INPUT-CD             PIC XX.
  5978
  5979         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5980             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5981             88  PB-INVALID-AH               VALUE '  ' '00'
  5982                                                   '90' THRU '99'.
  5983         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5984         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5985         16  PB-I-AH-CALC-FLAG            PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 112
* EL6311.cbl
  5986             88 PB-COMP-AH-PREM                  VALUE '?'.
  5987         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5988         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5989         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5990         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5991         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5992         16  PB-I-AH-ABBR                 PIC XXX.
  5993         16  PB-I-AH-INPUT-CD             PIC XXX.
  5994
  5995         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5996         16  PB-I-REIN-TABLE              PIC XXX.
  5997         16  PB-I-BUSINESS-TYPE           PIC 99.
  5998         16  PB-I-INDV-GRP-CD             PIC X.
  5999         16  PB-I-MORT-CODE.
  6000             20  PB-I-TABLE               PIC X.
  6001             20  PB-I-INTEREST            PIC XX.
  6002             20  PB-I-MORT-TYP            PIC X.
  6003         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6004         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6005         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6006         16  PB-I-INDV-GRP-OVRD           PIC X.
  6007         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6008         16  PB-I-SIG-SW                  PIC X.
  6009             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6010         16  PB-I-RATE-CLASS              PIC XX.
  6011         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6012         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6013         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6014         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6015         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6016         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6017         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6018         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6019         16  PB-I-OB-FLAG                 PIC X.
  6020             88  PB-I-OB                      VALUE 'B'.
  6021             88  PB-I-SUMMARY                 VALUE 'Z'.
  6022         16  PB-I-ENTRY-STATUS            PIC X.
  6023             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6024                                              'M' '5' '9' '2'.
  6025             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6026             88  PB-I-POLICY-PENDING          VALUE '2'.
  6027             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6028             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6029             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6030             88  PB-I-REIN-ONLY               VALUE '9'.
  6031             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6032             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6033             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6034             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6035         16  PB-I-INT-CODE                PIC X.
  6036             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6037             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6038         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6039         16  PB-I-SOC-SEC-NO              PIC X(11).
  6040         16  PB-I-MEMBER-NO               PIC X(12).
  6041         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6042*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6043         16  PB-I-OLD-LOF                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 113
* EL6311.cbl
  6044         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6045         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6046         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6047         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6048         16  PB-I-LIFE-INDICATOR          PIC X.
  6049             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6050         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6051         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6052                                          PIC S9(5)V99    COMP-3.
  6053         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6054             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6055             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6056         16  PB-I-1ST-PMT-DT              PIC XX.
  6057         16  PB-I-JOINT-INSURED.
  6058             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6059             20 PB-I-JOINT-FIRST-NAME.
  6060                24  PB-I-JOINT-FIRST-INIT PIC X.
  6061                24  FILLER                PIC X(9).
  6062             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6063*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6064         16  PB-I-BENEFICIARY-NAME.
  6065             20  PB-I-BANK-NUMBER         PIC X(10).
  6066             20  FILLER                   PIC X(15).
  6067         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6068         16  PB-I-REFERENCE               PIC X(12).
  6069         16  FILLER REDEFINES PB-I-REFERENCE.
  6070             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6071             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6072             20  PB-I-CLP-STATE           PIC XX.
  6073         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6074             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6075             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6076             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6077         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6078         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6079         16  PB-I-RESIDENT-STATE          PIC XX.
  6080         16  PB-I-RATE-CODE               PIC X(4).
  6081         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6082         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6083         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6084         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6085         16  PB-I-BANK-NOCHRGB            PIC 99.
  6086         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6087         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6088
  6089     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6090         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6091             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6092         16  PB-C-CANCEL-ORIGIN           PIC X.
  6093             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6094         16  PB-C-LF-CANCEL-DT            PIC XX.
  6095         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6096         16  PB-C-LF-CALC-REQ             PIC X.
  6097             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6098         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6099         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6100         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6101             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 114
* EL6311.cbl
  6102         16  PB-C-AH-CANCEL-DT            PIC XX.
  6103         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6104         16  PB-C-AH-CALC-REQ             PIC X.
  6105             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6106         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6107         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6108         16  PB-C-LAST-NAME               PIC X(15).
  6109         16  PB-C-REFUND-SW               PIC X.
  6110             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6111             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6112         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6113         16  PB-C-PAYEE-CODE              PIC X(6).
  6114         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6115         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6116         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6117         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6118         16  PB-C-REFERENCE               PIC X(12).
  6119         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6120         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6121         16  PB-C-POST-CARD-IND           PIC X.
  6122         16  PB-C-CANCEL-REASON           PIC X.
  6123         16  PB-C-REF-INTERFACE-SW        PIC X.
  6124         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6125         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6126         16  FILLER                       PIC X(01).
  6127*        16  FILLER                       PIC X(18).
  6128         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6129*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6130         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6131         16  PB-CANCELED-CERT-DATA.
  6132             20  PB-CI-INSURED-NAME.
  6133                 24  PB-CI-LAST-NAME      PIC X(15).
  6134                 24  PB-CI-INITIALS       PIC XX.
  6135             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6136             20  PB-CI-INSURED-SEX        PIC X.
  6137             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6138             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6139             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6140             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6141             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6142             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6143             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6144             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6145             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6146             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6147             20  PB-CI-RATE-CLASS         PIC XX.
  6148             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6149             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6150             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6151             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6152             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6153             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6154             20  PB-CI-LF-ABBR            PIC X(3).
  6155             20  PB-CI-AH-ABBR            PIC X(3).
  6156             20  PB-CI-OB-FLAG            PIC X.
  6157                 88  PB-CI-OB                VALUE 'B'.
  6158             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6159                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 115
* EL6311.cbl
  6160                                           'M' '4' '5' '9' '2'.
  6161                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6162                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6163                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6164                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6165                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6166                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6167                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6168                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6169                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6170                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6171                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6172                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6173             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6174                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6175                                           'M' '4' '5' '9' '2'.
  6176                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6177                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6178                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6179                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6180                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6181                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6182                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6183                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6184                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6185                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6186                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6187                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6188             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6189             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6190             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6191             20  PB-CI-MEMBER-NO          PIC X(12).
  6192             20  PB-CI-INT-CODE           PIC X.
  6193                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6194                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6195             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6196             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6197             20  PB-CI-COMP-EXCP-SW       PIC X.
  6198                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6199                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6200             20  PB-CI-ENTRY-STATUS       PIC X.
  6201             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6202             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6203             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6204             20  PB-CI-DEATH-DT           PIC XX.
  6205             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6206             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6207             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6208             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6209             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6210             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6211             20  PB-CI-ENTRY-DT              PIC XX.
  6212             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6213             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6214             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6215             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6216             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6217             20  PB-CI-OLD-LOF               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 116
* EL6311.cbl
  6218*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6219             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6220             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6221             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6222             20  PB-CI-INDV-GRP-CD           PIC X.
  6223             20  PB-CI-BENEFICIARY-NAME.
  6224                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6225                 24  FILLER                  PIC X(15).
  6226             20  PB-CI-NOTE-SW               PIC X.
  6227             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6228             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6229             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6230             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6231             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6232             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6233             20  PB-CI-FIRST-NAME            PIC X(10).
  6234             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6235
  6236         16  FILLER                       PIC X(13).
  6237*032306  16  FILLER                       PIC X(27).
  6238*        16  FILLER                       PIC X(46).
  6239
  6240     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6241         16  FILLER                       PIC X(10).
  6242         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6243         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6244         16  PB-M-INSURED-MID-INIT        PIC X.
  6245         16  PB-M-INSURED-AGE             PIC 99.
  6246         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6247         16  PB-M-INSURED-SEX             PIC X.
  6248         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6249         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6250         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6251         16  PB-M-INSURED-CITY-STATE.
  6252             20  PB-M-INSURED-CITY        PIC X(28).
  6253             20  PB-M-INSURED-STATE       PIC XX.
  6254         16  PB-M-INSURED-ZIP-CODE.
  6255             20  PB-M-INSURED-ZIP-PRIME.
  6256                 24  PB-M-INSURED-ZIP-1   PIC X.
  6257                     88  PB-M-CANADIAN-POST-CODE
  6258                                             VALUE 'A' THRU 'Z'.
  6259                 24  FILLER               PIC X(4).
  6260             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6261         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6262                                        PB-M-INSURED-ZIP-CODE.
  6263             20  PM-M-INS-CAN-POST1       PIC XXX.
  6264             20  PM-M-INS-CAN-POST2       PIC XXX.
  6265             20  FILLER                   PIC XXX.
  6266         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6267         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6268         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6269         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6270         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6271         16  PB-M-CRED-BENE-CITYST.
  6272             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6273             20  PB-M-CRED-BENE-STATE     PIC XX.
  6274         16  FILLER                       PIC X(92).
  6275
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 117
* EL6311.cbl
  6276     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6277         16  FILLER                       PIC X(10).
  6278         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6279         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6280         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6281         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6282         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6283         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6284         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6285         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6286         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6287         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6288         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6289         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6290         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6291         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6292         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6293         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6294         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6295         16  PB-ACCOUNT-NAME              PIC X(30).
  6296         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6297         16  PB-REFERENCE                 PIC X(12).
  6298         16  PB-B-RECEIVED-DT             PIC XX.
  6299         16  FILLER                       PIC X(234).
  6300
  6301     12  PB-RECORD-STATUS.
  6302         16  PB-CREDIT-SELECT-DT          PIC XX.
  6303         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6304         16  PB-BILLED-DT                 PIC XX.
  6305         16  PB-BILLING-STATUS            PIC X.
  6306             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6307             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6308             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6309         16  PB-RECORD-BILL               PIC X.
  6310             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6311             88  PB-RECORD-RETURNED           VALUE 'R'.
  6312             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6313             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6314             88  PB-OVERRIDE-AH               VALUE 'A'.
  6315             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6316         16  PB-BATCH-ENTRY               PIC X.
  6317             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6318             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6319             88  PB-REISSUED-CERT             VALUE 'E'.
  6320             88  PB-MONTHLY-CERT              VALUE 'M'.
  6321             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6322             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6323             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6324         16  PB-FORCE-CODE                PIC X.
  6325             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6326             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6327             88  PB-CANCEL-FORCE              VALUE '8'.
  6328             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6329             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6330             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6331             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6332             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6333             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 118
* EL6311.cbl
  6334             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6335         16  PB-FATAL-FLAG                PIC X.
  6336             88  PB-FATAL-ERRORS              VALUE 'X'.
  6337         16  PB-FORCE-ER-CD               PIC X.
  6338             88  PB-FORCE-ERRORS              VALUE 'F'.
  6339             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6340         16  PB-WARN-ER-CD                PIC X.
  6341             88  PB-WARNING-ERRORS            VALUE 'W'.
  6342         16  FILLER                       PIC X.
  6343         16  PB-OUT-BAL-CD                PIC X.
  6344             88  PB-OUT-OF-BAL                VALUE 'O'.
  6345         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6346         16  PB-AH-OVERRIDE-L1            PIC X.
  6347         16  PB-INPUT-DT                  PIC XX.
  6348         16  PB-INPUT-BY                  PIC X(4).
  6349         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6350         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6351         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6352         16  PB-LF-EARNING-METHOD         PIC X.
  6353         16  PB-AH-EARNING-METHOD         PIC X.
  6354         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6355         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6356         16  PB-REIN-CD                   PIC XXX.
  6357         16  PB-LF-REFUND-TYPE            PIC X.
  6358         16  PB-AH-REFUND-TYPE            PIC X.
  6359         16  PB-ACCT-EFF-DT               PIC XX.
  6360         16  PB-ACCT-EXP-DT               PIC XX.
  6361         16  PB-COMPANY-ID                PIC X(3).
  6362         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6363         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6364         16  PB-SV-CARRIER                PIC X.
  6365         16  PB-SV-GROUPING               PIC X(6).
  6366         16  PB-SV-STATE                  PIC XX.
  6367         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6368         16  PB-GA-BILLING-INFO.
  6369             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6370                                          PIC XX.
  6371         16  PB-SV-REMIT-TO  REDEFINES
  6372             PB-GA-BILLING-INFO           PIC X(10).
  6373         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6374         16  PB-I-LOAN-OFFICER            PIC X(5).
  6375         16  PB-I-VIN                     PIC X(17).
  6376
  6377         16  FILLER                       PIC X(04).
  6378         16  IMNET-BYPASS-SW              PIC X.
  6379
  6380******************************************************************
  6381*                COMMON EDIT ERRORS                              *
  6382******************************************************************
  6383
  6384     12  PB-COMMON-ERRORS.
  6385         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6386                                           PIC S9(4)     COMP.
  6387
  6388******************************************************************
  6389*                                COPY ELCCERT.
  6390******************************************************************
  6391*                                                                *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 119
* EL6311.cbl
  6392*                            ELCCERT.                            *
  6393*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6394*                            VMOD=2.013                          *
  6395*                                                                *
  6396*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6397*                                                                *
  6398*   FILE TYPE = VSAM,KSDS                                        *
  6399*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6400*                                                                *
  6401*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6402*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6403*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6404*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6405*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6406*                                                                *
  6407*   LOG = YES                                                    *
  6408*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6409******************************************************************
  6410*                   C H A N G E   L O G
  6411*
  6412* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6413*-----------------------------------------------------------------
  6414*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6415* EFFECTIVE    NUMBER
  6416*-----------------------------------------------------------------
  6417* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6418* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6419* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6420* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6421* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6422* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6423* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6424* 032612  CR2011110200001  PEMA  AHL CHANGES
  6425******************************************************************
  6426
  6427 01  CERTIFICATE-MASTER.
  6428     12  CM-RECORD-ID                      PIC XX.
  6429         88  VALID-CM-ID                      VALUE 'CM'.
  6430
  6431     12  CM-CONTROL-PRIMARY.
  6432         16  CM-COMPANY-CD                 PIC X.
  6433         16  CM-CARRIER                    PIC X.
  6434         16  CM-GROUPING.
  6435             20  CM-GROUPING-PREFIX        PIC X(3).
  6436             20  CM-GROUPING-PRIME         PIC X(3).
  6437         16  CM-STATE                      PIC XX.
  6438         16  CM-ACCOUNT.
  6439             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6440             20  CM-ACCOUNT-PRIME          PIC X(6).
  6441         16  CM-CERT-EFF-DT                PIC XX.
  6442         16  CM-CERT-NO.
  6443             20  CM-CERT-PRIME             PIC X(10).
  6444             20  CM-CERT-SFX               PIC X.
  6445
  6446     12  CM-CONTROL-BY-NAME.
  6447         16  CM-COMPANY-CD-A1              PIC X.
  6448         16  CM-INSURED-LAST-NAME          PIC X(15).
  6449         16  CM-INSURED-INITIALS.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 120
* EL6311.cbl
  6450             20  CM-INSURED-INITIAL1       PIC X.
  6451             20  CM-INSURED-INITIAL2       PIC X.
  6452
  6453     12  CM-CONTROL-BY-SSN.
  6454         16  CM-COMPANY-CD-A2              PIC X.
  6455         16  CM-SOC-SEC-NO.
  6456             20  CM-SSN-STATE              PIC XX.
  6457             20  CM-SSN-ACCOUNT            PIC X(6).
  6458             20  CM-SSN-LN3.
  6459                 25  CM-INSURED-INITIALS-A2.
  6460                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6461                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6462                 25 CM-PART-LAST-NAME-A2         PIC X.
  6463
  6464     12  CM-CONTROL-BY-CERT-NO.
  6465         16  CM-COMPANY-CD-A4              PIC X.
  6466         16  CM-CERT-NO-A4                 PIC X(11).
  6467
  6468     12  CM-CONTROL-BY-MEMB.
  6469         16  CM-COMPANY-CD-A5              PIC X.
  6470         16  CM-MEMBER-NO.
  6471             20  CM-MEMB-STATE             PIC XX.
  6472             20  CM-MEMB-ACCOUNT           PIC X(6).
  6473             20  CM-MEMB-LN4.
  6474                 25  CM-INSURED-INITIALS-A5.
  6475                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6476                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6477                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6478
  6479     12  CM-INSURED-PROFILE-DATA.
  6480         16  CM-INSURED-FIRST-NAME.
  6481             20  CM-INSURED-1ST-INIT       PIC X.
  6482             20  FILLER                    PIC X(9).
  6483         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6484         16  CM-INSURED-SEX                PIC X.
  6485             88  CM-SEX-MALE                  VALUE 'M'.
  6486             88  CM-SEX-FEMAL                 VALUE 'F'.
  6487         16  CM-INSURED-JOINT-AGE          PIC 99.
  6488         16  CM-JOINT-INSURED-NAME.
  6489             20  CM-JT-LAST-NAME           PIC X(15).
  6490             20  CM-JT-FIRST-NAME.
  6491                 24  CM-JT-1ST-INIT        PIC X.
  6492                 24  FILLER                PIC X(9).
  6493             20  CM-JT-INITIAL             PIC X.
  6494
  6495     12  CM-LIFE-DATA.
  6496         16  CM-LF-BENEFIT-CD              PIC XX.
  6497         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6498         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6499         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6500         16  CM-LF-DEV-CODE                PIC XXX.
  6501         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6502         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6503         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6504         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6505         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6506         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6507         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 121
* EL6311.cbl
  6508         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6509         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6510         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6511         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6512         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6513         16  FILLER                        PIC XX.
  6514
  6515     12  CM-AH-DATA.
  6516         16  CM-AH-BENEFIT-CD              PIC XX.
  6517         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6518         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6519         16  CM-AH-DEV-CODE                PIC XXX.
  6520         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6521         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6522         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6523         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6524         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6525         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6526         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6527         16  CM-AH-PAID-THRU-DT            PIC XX.
  6528             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6529         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6530         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6531         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6532         16  FILLER                        PIC X.
  6533
  6534     12  CM-LOAN-INFORMATION.
  6535         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6536         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6537                                           PIC S9(5)V99  COMP-3.
  6538         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6539         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6540         16  CM-PAY-FREQUENCY              PIC S99.
  6541         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6542         16  CM-RATE-CLASS                 PIC XX.
  6543         16  CM-BENEFICIARY                PIC X(25).
  6544         16  CM-POLICY-FORM-NO             PIC X(12).
  6545         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6546         16  CM-LAST-ADD-ON-DT             PIC XX.
  6547         16  CM-DEDUCTIBLE-AMOUNTS.
  6548             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6549             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6550         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6551             20  CM-RESIDENT-STATE         PIC XX.
  6552             20  CM-RATE-CODE              PIC X(4).
  6553             20  FILLER                    PIC XX.
  6554         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6555             20  CM-LOAN-OFFICER           PIC X(5).
  6556             20  FILLER                    PIC XXX.
  6557         16  CM-CSR-CODE                   PIC XXX.
  6558         16  CM-UNDERWRITING-CODE          PIC X.
  6559             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6560         16  CM-POST-CARD-IND              PIC X.
  6561         16  CM-NH-INTERFACE-SW            PIC X.
  6562         16  CM-PREMIUM-TYPE               PIC X.
  6563             88  CM-SING-PRM                  VALUE '1'.
  6564             88  CM-O-B-COVERAGE              VALUE '2'.
  6565             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 122
* EL6311.cbl
  6566         16  CM-IND-GRP-TYPE               PIC X.
  6567             88  CM-INDIVIDUAL                VALUE 'I'.
  6568             88  CM-GROUP                     VALUE 'G'.
  6569         16  CM-SKIP-CODE                  PIC X.
  6570             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6571             88  SKIP-JULY                    VALUE '1'.
  6572             88  SKIP-AUGUST                  VALUE '2'.
  6573             88  SKIP-SEPTEMBER               VALUE '3'.
  6574             88  SKIP-JULY-AUG                VALUE '4'.
  6575             88  SKIP-AUG-SEPT                VALUE '5'.
  6576             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6577             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6578             88  SKIP-JUNE                    VALUE '8'.
  6579             88  SKIP-JUNE-JULY               VALUE '9'.
  6580             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6581             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6582         16  CM-PAYMENT-MODE               PIC X.
  6583             88  PAY-MONTHLY                  VALUE SPACE.
  6584             88  PAY-WEEKLY                   VALUE '1'.
  6585             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6586             88  PAY-BI-WEEKLY                VALUE '3'.
  6587             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6588         16  CM-LOAN-NUMBER                PIC X(8).
  6589         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6590         16  CM-OLD-LOF                    PIC XXX.
  6591*        16  CM-LOAN-OFFICER               PIC XXX.
  6592         16  CM-REIN-TABLE                 PIC XXX.
  6593         16  CM-SPECIAL-REIN-CODE          PIC X.
  6594         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6595         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6596         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6597
  6598     12  CM-STATUS-DATA.
  6599         16  CM-ENTRY-STATUS               PIC X.
  6600         16  CM-ENTRY-DT                   PIC XX.
  6601
  6602         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6603         16  CM-LF-CANCEL-DT               PIC XX.
  6604         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6605
  6606         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6607         16  CM-LF-DEATH-DT                PIC XX.
  6608         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6609
  6610         16  CM-LF-CURRENT-STATUS          PIC X.
  6611             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6612                                                'M' '4' '5' '9'.
  6613             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6614             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6615             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6616             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6617             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6618             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6619             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6620             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6621             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6622             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6623             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 123
* EL6311.cbl
  6624             88  CM-LF-VOIDED                 VALUE 'V'.
  6625
  6626         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6627         16  CM-AH-CANCEL-DT               PIC XX.
  6628         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6629
  6630         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6631         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6632         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6633
  6634         16  CM-AH-CURRENT-STATUS          PIC X.
  6635             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6636                                                'M' '4' '5' '9'.
  6637             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6638             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6639             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6640             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6641             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6642             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6643             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6644             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6645             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6646             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6647             88  CM-AH-DECLINED               VALUE 'D'.
  6648             88  CM-AH-VOIDED                 VALUE 'V'.
  6649
  6650         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6651             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6652             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6653             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6654         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6655
  6656         16  CM-ENTRY-BATCH                PIC X(6).
  6657         16  CM-LF-EXIT-BATCH              PIC X(6).
  6658         16  CM-AH-EXIT-BATCH              PIC X(6).
  6659         16  CM-LAST-MONTH-END             PIC XX.
  6660
  6661     12  CM-NOTE-SW                        PIC X.
  6662         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6663         88  CERT-NOTES-PRESENT               VALUE '1'.
  6664         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6665         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6666         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6667         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6668         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6669         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6670     12  CM-COMP-EXCP-SW                   PIC X.
  6671         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6672         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6673     12  CM-INSURED-ADDRESS-SW             PIC X.
  6674         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6675         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6676
  6677*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6678     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6679     12  FILLER                            PIC X.
  6680
  6681*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 124
* EL6311.cbl
  6682     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6683     12  FILLER                            PIC X.
  6684*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6685     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6686
  6687     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6688         88  CERT-ADDED-BATCH                 VALUE ' '.
  6689         88  CERT-ADDED-ONLINE                VALUE '1'.
  6690         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6691         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6692         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6693     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6694         88  CERT-AS-LOADED                   VALUE ' '.
  6695         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6696         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6697         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6698         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6699         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6700         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6701         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6702
  6703     12  CM-ACCOUNT-COMM-PCTS.
  6704         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6705         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6706
  6707     12  CM-USER-FIELD                     PIC X.
  6708     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6709     12  CM-CLP-STATE                      PIC XX.
  6710     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6711     12  CM-USER-RESERVED                  PIC XXX.
  6712     12  FILLER REDEFINES CM-USER-RESERVED.
  6713         16  CM-AH-CLASS-CD                PIC XX.
  6714         16  F                             PIC X.
  6715******************************************************************
  6716*                                COPY ERCNOTE.
  6717******************************************************************
  6718*                                                                *
  6719*                                                                *
  6720*                            ERCNOTE                             *
  6721*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6722*                            VMOD=2.003                          *
  6723*                                                                *
  6724*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6725*                                                                *
  6726*        FILE TYPE= VSAM,KSDS                                    *
  6727*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6728*                                                                *
  6729*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6730*                                                                *
  6731*        LOG = YES                                               *
  6732*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6733*                                                                *
  6734******************************************************************
  6735*                   C H A N G E   L O G
  6736*
  6737* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6738*-----------------------------------------------------------------
  6739*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 125
* EL6311.cbl
  6740* EFFECTIVE    NUMBER
  6741*-----------------------------------------------------------------
  6742* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6743*                                FILE WILL CONTAIN BILLING NOTES O
  6744******************************************************************
  6745
  6746 01  CERTIFICATE-NOTE.
  6747     12  CN-RECORD-ID                PIC  XX.
  6748         88  VALID-CN-ID                  VALUE 'CN'.
  6749
  6750     12  CN-CONTROL-PRIMARY.
  6751         16  CN-COMPANY-CD           PIC X.
  6752         16  CN-CARRIER              PIC X.
  6753         16  CN-GROUPING.
  6754             20 CN-GROUPING-PREFIX   PIC XXX.
  6755             20 CN-GROUPING-PRIME    PIC XXX.
  6756         16  CN-STATE                PIC XX.
  6757         16  CN-ACCOUNT.
  6758             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6759             20 CN-ACCOUNT-PRIME     PIC X(6).
  6760         16  CN-CERT-EFF-DT          PIC XX.
  6761         16  CN-CERT-NO.
  6762             20  CN-CERT-PRIME       PIC X(10).
  6763             20  CN-CERT-SFX         PIC X.
  6764
  6765     12  CN-BILLING-START-LINE-NO    PIC 99.
  6766     12  CN-BILLING-END-LINE-NO      PIC 99.
  6767
  6768     12  CN-LINES.
  6769         16  CN-LINE OCCURS 10       PIC X(77).
  6770
  6771     12  CN-LAST-MAINT-DT            PIC XX.
  6772     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6773     12  CN-LAST-MAINT-USER          PIC X(4).
  6774     12  FILLER                      PIC X(6).
  6775******************************************************************
  6776*                                COPY ERCPNDM.
  6777******************************************************************
  6778*                                                                *
  6779*                                                                *
  6780*                            ERCPNDM                             *
  6781*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6782*                            VMOD=2.003                          *
  6783*                                                                *
  6784*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6785*                                                                *
  6786*   FILE TYPE = VSAM,KSDS                                        *
  6787*   RECORD SIZE = 374   RECFORM = FIX                            *
  6788*                                                                *
  6789*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6790*   ALTERNATE PATH    = NOT USED                                 *
  6791*                                                                *
  6792*   LOG = YES                                                    *
  6793*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6794******************************************************************
  6795*                   C H A N G E   L O G
  6796*
  6797* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 126
* EL6311.cbl
  6798*-----------------------------------------------------------------
  6799*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6800* EFFECTIVE    NUMBER
  6801*-----------------------------------------------------------------
  6802* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6803* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6804* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6805******************************************************************
  6806
  6807 01  PENDING-MAILING-DATA.
  6808     12  PM-RECORD-ID                      PIC XX.
  6809         88  VALID-MA-ID                       VALUE 'PM'.
  6810
  6811     12  PM-CONTROL-PRIMARY.
  6812         16  PM-COMPANY-CD                 PIC X.
  6813         16  PM-ENTRY-BATCH                PIC X(6).
  6814         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6815         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6816
  6817     12  FILLER                            PIC X(14).
  6818
  6819     12  PM-ACCESS-CONTROL.
  6820         16  PM-SOURCE-SYSTEM              PIC XX.
  6821             88  PM-FROM-CREDIT                VALUE 'CR'.
  6822             88  PM-FROM-VSI                   VALUE 'VS'.
  6823             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6824             88  PM-FROM-OTHER                 VALUE 'OT'.
  6825         16  PM-RECORD-ADD-DT              PIC XX.
  6826         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6827         16  PM-LAST-MAINT-DT              PIC XX.
  6828         16  PM-LAST-MAINT-BY              PIC XXXX.
  6829         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6830
  6831     12  PM-PROFILE-INFO.
  6832         16  PM-QUALIFY-CODE-1             PIC XX.
  6833         16  PM-QUALIFY-CODE-2             PIC XX.
  6834         16  PM-QUALIFY-CODE-3             PIC XX.
  6835         16  PM-QUALIFY-CODE-4             PIC XX.
  6836         16  PM-QUALIFY-CODE-5             PIC XX.
  6837
  6838         16  PM-INSURED-LAST-NAME          PIC X(15).
  6839         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6840         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6841         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6842         16  PM-INSURED-BIRTH-DT           PIC XX.
  6843         16  PM-INSURED-SEX                PIC X.
  6844             88  PM-SEX-MALE                   VALUE 'M'.
  6845             88  PM-SEX-FEMALE                 VALUE 'F'.
  6846         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6847
  6848         16  PM-ADDRESS-CORRECTED          PIC X.
  6849         16  PM-JOINT-BIRTH-DT             PIC XX.
  6850*        16  FILLER                        PIC X(12).
  6851
  6852         16  PM-ADDRESS-LINE-1             PIC X(30).
  6853         16  PM-ADDRESS-LINE-2             PIC X(30).
  6854         16  PM-CITY-STATE.
  6855             20  PM-CITY                   PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 127
* EL6311.cbl
  6856             20  PM-STATE                  PIC XX.
  6857         16  PM-ZIP.
  6858             20  PM-ZIP-CODE.
  6859                 24  PM-ZIP-1              PIC X.
  6860                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6861                 24  FILLER                PIC X(4).
  6862             20  PM-ZIP-PLUS4              PIC X(4).
  6863         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6864             20  PM-CAN-POST1              PIC XXX.
  6865             20  PM-CAN-POST2              PIC XXX.
  6866             20  FILLER                    PIC XXX.
  6867
  6868         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6869
  6870         16  FILLER                        PIC X(03).
  6871
  6872     12  PM-CRED-BENE-INFO.
  6873         16  PM-CRED-BENE-NAME             PIC X(25).
  6874         16  PM-CRED-BENE-ADDR             PIC X(30).
  6875         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6876         16  PM-CRED-BENE-CTYST.
  6877             20  PM-CRED-BENE-CITY         PIC X(28).
  6878             20  PM-CRED-BENE-STATE        PIC XX.
  6879         16  PM-CRED-BENE-ZIP.
  6880             20  PM-CB-ZIP-CODE.
  6881                 24  PM-CB-ZIP-1           PIC X.
  6882                     88  PM-CB-CANADIAN-POST-CODE
  6883                                  VALUE 'A' THRU 'Z'.
  6884                 24  FILLER                PIC X(4).
  6885             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6886         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6887             20  PM-CB-CAN-POST1           PIC XXX.
  6888             20  PM-CB-CAN-POST2           PIC XXX.
  6889             20  FILLER                    PIC XXX.
  6890     12  PM-POST-CARD-MAIL-DATA.
  6891         16  PM-MAIL-DATA OCCURS 7.
  6892             20  PM-MAIL-TYPE              PIC X.
  6893                 88  PM-12MO-MAILING           VALUE '1'.
  6894                 88  PM-EXP-MAILING            VALUE '2'.
  6895             20  PM-MAIL-STATUS            PIC X.
  6896                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6897                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6898                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6899             20  PM-MAIL-DATE              PIC XX.
  6900     12  FILLER                            PIC XX.
  6901     12  FILLER                            PIC X(12).
  6902*    12  FILLER                            PIC X(30).
  6903
  6904******************************************************************
  6905*                                COPY ERCMAIL.
  6906******************************************************************
  6907*                                                                *
  6908*                                                                *
  6909*                            ERCMAIL                             *
  6910*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6911*                            VMOD=2.003                          *
  6912*                                                                *
  6913*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 128
* EL6311.cbl
  6914*                                                                *
  6915*   FILE TYPE = VSAM,KSDS                                        *
  6916*   RECORD SIZE = 374   RECFORM = FIX                            *
  6917*                                                                *
  6918*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6919*   ALTERNATE PATH    = NOT USED                                 *
  6920*                                                                *
  6921*   LOG = YES                                                    *
  6922*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6923******************************************************************
  6924*                   C H A N G E   L O G
  6925*
  6926* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6927*-----------------------------------------------------------------
  6928*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6929* EFFECTIVE    NUMBER
  6930*-----------------------------------------------------------------
  6931* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6932* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6933* 111108                   PEMA  ADD CRED BENE ADDR2
  6934******************************************************************
  6935
  6936 01  MAILING-DATA.
  6937     12  MA-RECORD-ID                      PIC XX.
  6938         88  VALID-MA-ID                       VALUE 'MA'.
  6939
  6940     12  MA-CONTROL-PRIMARY.
  6941         16  MA-COMPANY-CD                 PIC X.
  6942         16  MA-CARRIER                    PIC X.
  6943         16  MA-GROUPING.
  6944             20  MA-GROUPING-PREFIX        PIC XXX.
  6945             20  MA-GROUPING-PRIME         PIC XXX.
  6946         16  MA-STATE                      PIC XX.
  6947         16  MA-ACCOUNT.
  6948             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6949             20  MA-ACCOUNT-PRIME          PIC X(6).
  6950         16  MA-CERT-EFF-DT                PIC XX.
  6951         16  MA-CERT-NO.
  6952             20  MA-CERT-PRIME             PIC X(10).
  6953             20  MA-CERT-SFX               PIC X.
  6954
  6955     12  FILLER                            PIC XX.
  6956
  6957     12  MA-ACCESS-CONTROL.
  6958         16  MA-SOURCE-SYSTEM              PIC XX.
  6959             88  MA-FROM-CREDIT                VALUE 'CR'.
  6960             88  MA-FROM-VSI                   VALUE 'VS'.
  6961             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6962             88  MA-FROM-OTHER                 VALUE 'OT'.
  6963         16  MA-RECORD-ADD-DT              PIC XX.
  6964         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6965         16  MA-LAST-MAINT-DT              PIC XX.
  6966         16  MA-LAST-MAINT-BY              PIC XXXX.
  6967         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6968
  6969     12  MA-PROFILE-INFO.
  6970         16  MA-QUALIFY-CODE-1             PIC XX.
  6971         16  MA-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 129
* EL6311.cbl
  6972         16  MA-QUALIFY-CODE-3             PIC XX.
  6973         16  MA-QUALIFY-CODE-4             PIC XX.
  6974         16  MA-QUALIFY-CODE-5             PIC XX.
  6975
  6976         16  MA-INSURED-LAST-NAME          PIC X(15).
  6977         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6978         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6979         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6980         16  MA-INSURED-BIRTH-DT           PIC XX.
  6981         16  MA-INSURED-SEX                PIC X.
  6982             88  MA-SEX-MALE                   VALUE 'M'.
  6983             88  MA-SEX-FEMALE                 VALUE 'F'.
  6984         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6985
  6986         16  MA-ADDRESS-CORRECTED          PIC X.
  6987         16  MA-JOINT-BIRTH-DT             PIC XX.
  6988*        16  FILLER                        PIC X(12).
  6989
  6990         16  MA-ADDRESS-LINE-1             PIC X(30).
  6991         16  MA-ADDRESS-LINE-2             PIC X(30).
  6992         16  MA-CITY-STATE.
  6993             20  MA-CITY                   PIC X(28).
  6994             20  MA-ADDR-STATE             PIC XX.
  6995         16  MA-ZIP.
  6996             20  MA-ZIP-CODE.
  6997                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6998                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6999                 24  FILLER                PIC X(4).
  7000             20  MA-ZIP-PLUS4              PIC X(4).
  7001         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7002             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7003             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7004             20  FILLER                    PIC X(3).
  7005
  7006         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7007
  7008         16  FILLER                        PIC XXX.
  7009*        16  FILLER                        PIC X(10).
  7010
  7011     12  MA-CRED-BENE-INFO.
  7012         16  MA-CRED-BENE-NAME                 PIC X(25).
  7013         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7014         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7015         16  MA-CRED-BENE-CTYST.
  7016             20  MA-CRED-BENE-CITY             PIC X(28).
  7017             20  MA-CRED-BENE-STATE            PIC XX.
  7018         16  MA-CRED-BENE-ZIP.
  7019             20  MA-CB-ZIP-CODE.
  7020                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7021                     88  MA-CB-CANADIAN-POST-CODE
  7022                                           VALUE 'A' THRU 'Z'.
  7023                 24  FILLER                    PIC X(4).
  7024             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7025         16  MA-CB-CANADIAN-POSTAL-CODE
  7026                            REDEFINES MA-CRED-BENE-ZIP.
  7027             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7028             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7029             20  FILLER                        PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 130
* EL6311.cbl
  7030     12  MA-POST-CARD-MAIL-DATA.
  7031         16  MA-MAIL-DATA OCCURS 7.
  7032             20  MA-MAIL-TYPE              PIC X.
  7033                 88  MA-12MO-MAILING           VALUE '1'.
  7034                 88  MA-EXP-MAILING            VALUE '2'.
  7035             20  MA-MAIL-STATUS            PIC X.
  7036                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7037                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7038                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7039             20  MA-MAIL-DATE              PIC XX.
  7040     12  FILLER                            PIC XX.
  7041     12  FILLER                            PIC XX.
  7042*    12  FILLER                            PIC X(30).
  7043******************************************************************
  7044*                                COPY ERCRQST.
  7045******************************************************************
  7046*                                                                *
  7047*                                                                *
  7048*                            ERCRQST.                            *
  7049*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7050*                            VMOD=2.002                          *
  7051*                                                                *
  7052*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7053*                                                                *
  7054*   FILE TYPE = VSAM,KSDS                                        *
  7055*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7056*                                                                *
  7057*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7058*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7059*                                   ACCOUNT, REF, BATCH)         *
  7060*                                                RKP=9, LEN=38   *
  7061*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7062*                                   ACCOUNT, REF, BATCH)         *
  7063*                                                RKP=47, LEN=46  *
  7064*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7065*                                   BATCH)                       *
  7066*                                                RKP=93, LEN=24  *
  7067*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7068*                                   REF, BATCH)                  *
  7069*                                                RKP=117, LEN=35 *
  7070*   LOG = NO                                                     *
  7071*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7072******************************************************************
  7073
  7074 01  AR-REQUEST-RECORD.
  7075     12  RQ-RECORD-ID                     PIC XX.
  7076         88  VALID-RQ-ID                        VALUE 'RQ'.
  7077
  7078     12  RQ-CONTROL-PRIMARY.
  7079         16  RQ-COMPANY-CD                PIC X.
  7080         16  RQ-ENTRY-BATCH               PIC X(6).
  7081
  7082     12  RQ-CONTROL-BY-ACCT-REF.
  7083         16  RQ-COMPANY-CD-A1             PIC X.
  7084         16  RQ-CARRIER-A1                PIC X.
  7085         16  RQ-GROUPING-A1               PIC X(6).
  7086         16  RQ-STATE-A1                  PIC XX.
  7087         16  RQ-ACCOUNT-A1                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 131
* EL6311.cbl
  7088         16  RQ-REFERENCE-A1              PIC X(12).
  7089         16  RQ-BATCH-A1                  PIC X(6).
  7090
  7091     12  RQ-CONTROL-BY-FIN-RESP.
  7092         16  RQ-COMPANY-CD-A2             PIC X.
  7093         16  RQ-CARRIER-A2                PIC X.
  7094         16  RQ-GROUPING-A2               PIC X(6).
  7095         16  RQ-FIN-RESP-A2               PIC X(10).
  7096         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7097         16  RQ-REFERENCE-A2              PIC X(12).
  7098         16  RQ-BATCH-A2                  PIC X(6).
  7099
  7100     12  RQ-CONTROL-BY-ACCT-AGENT.
  7101         16  RQ-COMPANY-CD-A3             PIC X.
  7102         16  RQ-CARRIER-A3                PIC X.
  7103         16  RQ-GROUPING-A3               PIC X(6).
  7104         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7105         16  RQ-BATCH-A3                  PIC X(6).
  7106
  7107     12  RQ-CONTROL-BY-SUMMARY.
  7108         16  RQ-COMPANY-CD-A4             PIC X.
  7109         16  RQ-SUMMARY-CODE              PIC X(6).
  7110         16  RQ-ACCOUNT-A4                PIC X(10).
  7111         16  RQ-REFERENCE-A4              PIC X(12).
  7112         16  RQ-BATCH-A4                  PIC X(6).
  7113
  7114     12  RQ-REQUEST-METHOD                PIC X.
  7115         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7116         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7117         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7118         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7119     12  FILLER                           PIC X.
  7120     12  RQ-STATUS                        PIC X.
  7121         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7122         88  RQ-RESUBMIT                      VALUE 'R'.
  7123     12  RQ-PROCESSOR-ID                  PIC X(4).
  7124     12  RQ-ENTRY-DT                      PIC XX.
  7125     12  RQ-MO-END-DT                     PIC XX.
  7126     12  RQ-REQUEST-DT                    PIC XX.
  7127     12  RQ-STMT-DT                       PIC XX.
  7128     12  RQ-REVERSAL-DT                   PIC XX.
  7129     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7130     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7131
  7132     12  FILLER                           PIC X(27).
  7133
  7134******************************************************************
  7135
  7136*                                COPY ERCLOFC.
  7137******************************************************************
  7138*                                                                *
  7139*                                                                *
  7140*                            ERCLOFC                             *
  7141*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7142*                            VMOD=2.003                          *
  7143*                                                                *
  7144*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7145*                                                                *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 132
* EL6311.cbl
  7146*   FILE TYPE = VSAM,KSDS                                        *
  7147*   RECORD SIZE = 670   RECFORM = FIX                            *
  7148*                                                                *
  7149*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7150*                                                                *
  7151*   LOG = YES                                                    *
  7152*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7153*                                                                *
  7154******************************************************************
  7155
  7156 01  LOAN-OFFICER-MASTER.
  7157     12  LO-RECORD-ID                PIC XX.
  7158         88  VALID-LO-ID                VALUE 'LO'.
  7159
  7160     12  LO-CONTROL-PRIMARY.
  7161         16  LO-COMPANY-CD           PIC X.
  7162         16  LO-CARRIER              PIC X.
  7163         16  LO-GROUPING.
  7164             20  LO-GROUPING-PREFIX  PIC XXX.
  7165             20  LO-GROUPING-PRIME   PIC XXX.
  7166         16  LO-STATE                PIC XX.
  7167         16  LO-ACCOUNT.
  7168             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7169             20  LO-ACCOUNT-PRIME    PIC X(6).
  7170         16  LO-OFFICER-CODE         PIC X(5).
  7171
  7172     12  LO-OFFICER-NAME             PIC X(30).
  7173
  7174     12  LO-LAST-MAINT-DT            PIC XX.
  7175     12  LO-LAST-USER                PIC X(4).
  7176     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7177
  7178     12  LO-COMP-CONTROL             PIC X.
  7179             88  LO-SHOW-COMP           VALUE 'Y'.
  7180             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7181     12  LO-DETAIL-CONTROL           PIC X.
  7182             88  LO-PRINT-DETAIL        VALUE 'D'.
  7183             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7184
  7185     12  LO-SV-CARRIER               PIC X.
  7186     12  LO-SV-GROUPING              PIC X(6).
  7187     12  LO-SV-STATE                 PIC XX.
  7188
  7189     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7190     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7191
  7192     12  LO-OFFICER-INFO.
  7193         16  FILLER OCCURS 12 TIMES.
  7194             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7195             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7196             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7197             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7198             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7199             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7200             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7201             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7202     12  FILLER                      PIC X(198).
  7203******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 133
* EL6311.cbl
  7204*                                COPY ERCPYAJ.
  7205******************************************************************
  7206*                                                                *
  7207*                            ERCPYAJ                             *
  7208*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7209*                            VMOD=2.015                          *
  7210*                                                                *
  7211*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7212*                                                                *
  7213*                                                                *
  7214*   FILE TYPE = VSAM,KSDS                                        *
  7215*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7216*                                                                *
  7217*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7218*       ALTERNATE PATHS = NONE                                   *
  7219*                                                                *
  7220*   LOG = YES                                                    *
  7221*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7222******************************************************************
  7223******************************************************************
  7224*                   C H A N G E   L O G
  7225*
  7226* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7227*-----------------------------------------------------------------
  7228*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7229* EFFECTIVE    NUMBER
  7230*-----------------------------------------------------------------
  7231* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7232* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7233******************************************************************
  7234
  7235 01  PENDING-PAY-ADJ.
  7236     12  PY-RECORD-ID                     PIC XX.
  7237         88  VALID-PY-ID                        VALUE 'PY'.
  7238
  7239     12  PY-CONTROL-PRIMARY.
  7240         16  PY-COMPANY-CD                PIC X.
  7241         16  PY-CARRIER                   PIC X.
  7242         16  PY-GROUPING                  PIC X(6).
  7243         16  PY-FIN-RESP                  PIC X(10).
  7244         16  PY-ACCOUNT                   PIC X(10).
  7245         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7246                                          PIC X(10).
  7247         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7248         16  PY-RECORD-TYPE               PIC X.
  7249             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7250             88  PY-DEPOSIT                   VALUE 'D'.
  7251             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7252             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7253             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7254             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7255             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7256             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7257             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7258             88  PY-FICA-ENTRY                VALUE 'F'.
  7259             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7260             88  PY-POLICY-FEE                VALUE 'W'.
  7261             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 134
* EL6311.cbl
  7262
  7263     12  PY-PYMT-TYPE                     PIC X.
  7264             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7265             88  PY-REINS-PYMT                VALUE 'R'.
  7266             88  PY-EXP-PYMT                  VALUE 'E'.
  7267
  7268     12  PY-BIL-INV                       PIC X(6).
  7269     12  PY-REF-NO                        PIC X(12).
  7270
  7271     12  PY-LAST-MAINT-DT                 PIC XX.
  7272     12  PY-LAST-MAINT-BY                 PIC X(4).
  7273     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7274
  7275     12  PY-PYADJ-RECORD.
  7276         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7277         16  PY-ENTRY-COMMENT             PIC X(30).
  7278         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7279             20  PY-GL-ACCOUNT            PIC X(10).
  7280             20  PY-GL-STATE              PIC X(02).
  7281             20  PY-GL-CANC-SW            PIC X(01).
  7282                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7283                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7284             20  PY-GL-COMMENT            PIC X(10).
  7285             20  FILLER      REDEFINES PY-GL-COMMENT.
  7286                 24  PY-GL-CHECK-NO       PIC 9(06).
  7287                 24  FILLER               PIC X(04).
  7288             20  FILLER                   PIC X(07).
  7289         16  PY-SAVE-ACCOUNT              PIC X(10).
  7290         16  PY-SAVE-TYPE                 PIC X(01).
  7291
  7292         16  PY-LETTERS.
  7293             20  PY-LETTER OCCURS 3 TIMES
  7294                           INDEXED BY PY-LET-NDX
  7295                                          PIC X(04).
  7296
  7297         16  PY-ERCOMP-TYPE               PIC X.
  7298             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7299             88  PY-GA-TYPE                   VALUE 'G'.
  7300             88  PY-BANK-TYPE                 VALUE 'B'.
  7301         16  FILLER                       PIC X(05).
  7302
  7303     12  PY-RECORD-STATUS.
  7304         16  PY-CREDIT-SELECT-DT          PIC XX.
  7305         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7306         16  PY-BILLED-DATE               PIC XX.
  7307         16  PY-REPORTED-DT               PIC XX.
  7308         16  PY-PMT-APPLIED               PIC X.
  7309             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7310             88  PY-GA-PMT                    VALUE 'G'.
  7311             88  PY-OVWRITE-PMT               VALUE 'O'.
  7312             88  PY-NON-AR-PMT                VALUE 'N'.
  7313         16  FILLER                       PIC X(5).
  7314         16  PY-INPUT-DT                  PIC XX.
  7315         16  PY-CHECK-NUMBER              PIC X(6).
  7316         16  PY-VOID-SW                   PIC X.
  7317             88  PY-CHECK-VOIDED              VALUE 'V'.
  7318         16  PY-CHECK-ORIGIN-SW           PIC X.
  7319             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 135
* EL6311.cbl
  7320             88  PY-REFUND-CHECK              VALUE 'R'.
  7321             88  PY-GA-CHECK                  VALUE 'G'.
  7322             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7323             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7324         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7325         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7326         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7327         16  PY-BILL-FLAG                 PIC X.
  7328             88  PY-BILLED                    VALUE 'B'.
  7329         16  PY-AR-FLAG                   PIC X.
  7330             88  PY-AR-CYCLE                  VALUE 'C'.
  7331             88  PY-AR-MONTH-END              VALUE 'M'.
  7332         16  PY-AR-DATE                   PIC XX.
  7333
  7334     12  PY-GL-CODES.
  7335         16  PY-GL-DB                     PIC X(14).
  7336         16  PY-GL-CR                     PIC X(14).
  7337         16  PY-GL-FLAG                   PIC X.
  7338         16  PY-GL-DATE                   PIC XX.
  7339
  7340     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7341     12  FILLER                           PIC X(3).
  7342******************************************************************
  7343*                                COPY ERCCNOT.
  7344******************************************************************
  7345*                                                                *
  7346*                            ERCCNOT                             *
  7347*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7348*                            VMOD=2.003                          *
  7349*                                                                *
  7350*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7351*                                                                *
  7352*        FILE TYPE= VSAM,KSDS                                    *
  7353*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7354*                                                                *
  7355*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7356*                                                                *
  7357*        LOG = YES                                               *
  7358*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7359*                                                                *
  7360******************************************************************
  7361*                   C H A N G E   L O G
  7362*
  7363* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7364*-----------------------------------------------------------------
  7365*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7366* EFFECTIVE    NUMBER
  7367*-----------------------------------------------------------------
  7368* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7369******************************************************************
  7370
  7371 01  CERT-NOTE-FILE.
  7372     12  CZ-RECORD-ID                PIC  XX.
  7373         88  VALID-CZ-ID                  VALUE 'CZ'.
  7374
  7375     12  CZ-CONTROL-PRIMARY.
  7376         16  CZ-COMPANY-CD           PIC X.
  7377         16  CZ-CARRIER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 136
* EL6311.cbl
  7378         16  CZ-GROUPING.
  7379             20 CZ-GROUPING-PREFIX   PIC XXX.
  7380             20 CZ-GROUPING-PRIME    PIC XXX.
  7381         16  CZ-STATE                PIC XX.
  7382         16  CZ-ACCOUNT.
  7383             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7384             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7385         16  CZ-CERT-EFF-DT          PIC XX.
  7386         16  CZ-CERT-NO.
  7387             20  CZ-CERT-PRIME       PIC X(10).
  7388             20  CZ-CERT-SFX         PIC X.
  7389         16  CZ-RECORD-TYPE          PIC X.
  7390             88  CERT-NOTE           VALUE '1'.
  7391             88  CLAIM-CERT-NOTE     VALUE '2'.
  7392         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7393
  7394     12  CZ-LAST-MAINT-DT            PIC XX.
  7395     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7396     12  CZ-LAST-MAINT-USER          PIC X(4).
  7397
  7398     12  CZ-NOTE-INFORMATION.
  7399         16  CZ-NOTE                 PIC X(63).
  7400         16  FILLER                  PIC X(39).
  7401******************************************************************
  7402*                                COPY ELCMSTR.
  7403******************************************************************
  7404*                                                                *
  7405*                            ELCMSTR.                            *
  7406*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7407*                            VMOD=2.012                          *
  7408*                                                                *
  7409*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7410*                                                                *
  7411*   FILE TYPE = VSAM,KSDS                                        *
  7412*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7413*                                                                *
  7414*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7415*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7416*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7417*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7418*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7419*                                                 RKP=75,LEN=21  *
  7420*                                                                *
  7421*   **** NOTE ****                                               *
  7422*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7423*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7424*                                                                *
  7425*   LOG = YES                                                    *
  7426*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7427******************************************************************
  7428*                   C H A N G E   L O G
  7429*
  7430* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7431*-----------------------------------------------------------------
  7432*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7433* EFFECTIVE    NUMBER
  7434*-----------------------------------------------------------------
  7435* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 137
* EL6311.cbl
  7436* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7437* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7438******************************************************************
  7439 01  CLAIM-MASTER.
  7440     12  CL-RECORD-ID                PIC XX.
  7441         88  VALID-CL-ID         VALUE 'CL'.
  7442
  7443     12  CL-CONTROL-PRIMARY.
  7444         16  CL-COMPANY-CD           PIC X.
  7445         16  CL-CARRIER              PIC X.
  7446         16  CL-CLAIM-NO             PIC X(7).
  7447         16  CL-CERT-NO.
  7448             20  CL-CERT-PRIME       PIC X(10).
  7449             20  CL-CERT-SFX         PIC X.
  7450
  7451     12  CL-CONTROL-BY-NAME.
  7452         16  CL-COMPANY-CD-A1        PIC X.
  7453         16  CL-INSURED-LAST-NAME    PIC X(15).
  7454         16  CL-INSURED-NAME.
  7455             20  CL-INSURED-1ST-NAME PIC X(12).
  7456             20  CL-INSURED-MID-INIT PIC X.
  7457
  7458     12  CL-CONTROL-BY-SSN.
  7459         16  CL-COMPANY-CD-A2        PIC X.
  7460         16  CL-SOC-SEC-NO.
  7461             20  CL-SSN-STATE        PIC XX.
  7462             20  CL-SSN-ACCOUNT      PIC X(6).
  7463             20  CL-SSN-LN3          PIC X(3).
  7464
  7465     12  CL-CONTROL-BY-CERT-NO.
  7466         16  CL-COMPANY-CD-A4        PIC X.
  7467         16  CL-CERT-NO-A4.
  7468             20  CL-CERT-A4-PRIME    PIC X(10).
  7469             20  CL-CERT-A4-SFX      PIC X.
  7470
  7471     12  CL-CONTROL-BY-CCN.
  7472         16  CL-COMPANY-CD-A5        PIC X.
  7473         16  CL-CCN-A5.
  7474             20  CL-CCN.
  7475                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7476                 24  CL-CCN-PRIME-A5 PIC X(12).
  7477             20  CL-CCN-FILLER-A5    PIC X(4).
  7478
  7479     12  CL-INSURED-PROFILE-DATA.
  7480         16  CL-INSURED-BIRTH-DT     PIC XX.
  7481         16  CL-INSURED-SEX-CD       PIC X.
  7482             88  INSURED-IS-MALE        VALUE 'M'.
  7483             88  INSURED-IS-FEMALE      VALUE 'F'.
  7484             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7485         16  CL-INSURED-OCC-CD       PIC X(6).
  7486         16  FILLER                  PIC X(5).
  7487
  7488     12  CL-PROCESSING-INFO.
  7489         16  CL-PROCESSOR-ID         PIC X(4).
  7490         16  CL-CLAIM-STATUS         PIC X.
  7491             88  CLAIM-IS-OPEN          VALUE 'O'.
  7492             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7493         16  CL-CLAIM-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 138
* EL6311.cbl
  7494*            88  AH-CLAIM               VALUE 'A'.
  7495*            88  LIFE-CLAIM             VALUE 'L'.
  7496*            88  PROPERTY-CLAIM         VALUE 'P'.
  7497*            88  IUI-CLAIM              VALUE 'I'.
  7498*            88  GAP-CLAIM              VALUE 'G'.
  7499         16  CL-CLAIM-PREM-TYPE      PIC X.
  7500             88  SINGLE-PREMIUM         VALUE '1'.
  7501             88  O-B-COVERAGE           VALUE '2'.
  7502             88  OPEN-END-COVERAGE      VALUE '3'.
  7503         16  CL-INCURRED-DT          PIC XX.
  7504         16  CL-REPORTED-DT          PIC XX.
  7505         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7506         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7507         16  CL-LAST-PMT-DT          PIC XX.
  7508         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7509         16  CL-PAID-THRU-DT         PIC XX.
  7510         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7511         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7512         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7513         16  CL-PMT-CALC-METHOD      PIC X.
  7514             88  CL-360-DAY-YR          VALUE '1'.
  7515             88  CL-365-DAY-YR          VALUE '2'.
  7516             88  CL-FULL-MONTHS         VALUE '3'.
  7517         16  CL-CAUSE-CD             PIC X(6).
  7518
  7519         16  CL-PRIME-CERT-NO.
  7520             20  CL-PRIME-CERT-PRIME PIC X(10).
  7521             20  CL-PRIME-CERT-SFX   PIC X.
  7522
  7523         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7524             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7525             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7526
  7527         16  CL-MICROFILM-NO         PIC X(10).
  7528         16  CL-PROG-FORM-TYPE       PIC X.
  7529         16  CL-LAST-ADD-ON-DT       PIC XX.
  7530
  7531         16  CL-LAST-REOPEN-DT       PIC XX.
  7532         16  CL-LAST-CLOSE-DT        PIC XX.
  7533         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7534             88  FINAL-PAID             VALUE '1'.
  7535             88  CLAIM-DENIED           VALUE '2'.
  7536             88  AUTO-CLOSE             VALUE '3'.
  7537             88  MANUAL-CLOSE           VALUE '4'.
  7538             88  BENEFITS-CHANGED       VALUE 'C'.
  7539             88  SETUP-ERRORS           VALUE 'E'.
  7540         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7541         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7542         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7543             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7544         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7545         16  FILLER                  PIC X.
  7546
  7547     12  CL-CERTIFICATE-DATA.
  7548         16  CL-CERT-ORIGIN          PIC X.
  7549             88  CERT-WAS-ONLINE        VALUE '1'.
  7550             88  CERT-WAS-CREATED       VALUE '2'.
  7551             88  COVERAGE-WAS-ADDED     VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 139
* EL6311.cbl
  7552         16  CL-CERT-KEY-DATA.
  7553             20  CL-CERT-CARRIER     PIC X.
  7554             20  CL-CERT-GROUPING    PIC X(6).
  7555             20  CL-CERT-STATE       PIC XX.
  7556             20  CL-CERT-ACCOUNT.
  7557                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7558                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7559             20  CL-CERT-EFF-DT      PIC XX.
  7560
  7561     12  CL-STATUS-CONTROLS.
  7562         16  CL-PRIORITY-CD          PIC X.
  7563             88  CONFIDENTIAL-DATA      VALUE '8'.
  7564             88  HIGHEST-PRIORITY       VALUE '9'.
  7565         16  CL-SUPV-ATTN-CD         PIC X.
  7566             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7567             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7568         16  CL-PURGED-DT            PIC XX.
  7569         16  CL-RESTORED-DT          PIC XX.
  7570         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7571         16  CL-NEXT-RESEND-DT       PIC XX.
  7572         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7573         16  CL-CRITICAL-PERIOD      PIC 99.
  7574*        16  FILLER                  PIC XX.
  7575         16  CL-LAST-MAINT-DT        PIC XX.
  7576         16  CL-LAST-MAINT-USER      PIC X(4).
  7577         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7578         16  CL-LAST-MAINT-TYPE      PIC X.
  7579             88  CLAIM-SET-UP           VALUE ' '.
  7580             88  PAYMENT-MADE           VALUE '1'.
  7581             88  LETTER-SENT            VALUE '2'.
  7582             88  MASTER-WAS-ALTERED     VALUE '3'.
  7583             88  MASTER-WAS-RESTORED    VALUE '4'.
  7584             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7585             88  FILE-CONVERTED         VALUE '6'.
  7586             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7587             88  ERROR-CORRECTION       VALUE 'E'.
  7588         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7589         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7590         16  CL-BENEFICIARY          PIC X(10).
  7591         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7592         16  CL-DENIAL-TYPE          PIC X.
  7593             88  CL-TYPE-DENIAL          VALUE '1'.
  7594             88  CL-TYPE-RESCISSION      VALUE '2'.
  7595             88  CL-TYPE-REFORMATION     VALUE '3'.
  7596             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7597             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7598         16  CL-CRIT-PER-RECURRENT   PIC X.
  7599         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7600         16  CL-RTW-DT               PIC XX.
  7601
  7602     12  CL-TRAILER-CONTROLS.
  7603         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7604             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7605             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7606             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7607         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7608         16  FILLER                  PIC XX.
  7609         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 140
* EL6311.cbl
  7610         16  CL-ADDRESS-TRAILER-CNT.
  7611             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7612                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7613             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7614                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7615             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7616                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7617             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7618                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7619             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7620                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7621             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7622                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7623             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7624                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7625
  7626     12  CL-CV-REFERENCE-NO.
  7627         16  CL-CV-REFNO-PRIME       PIC X(18).
  7628         16  CL-CV-REFNO-SFX         PIC XX.
  7629
  7630     12  CL-FILE-LOCATION            PIC X(4).
  7631
  7632     12  CL-PROCESS-ERRORS.
  7633         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7634             88  NO-FATAL-ERRORS        VALUE ZERO.
  7635         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7636             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7637
  7638     12  CL-PRODUCT-CD               PIC X.
  7639
  7640     12  CL-CURRENT-KEY-DATA.
  7641         16  CL-CURRENT-CARRIER      PIC X.
  7642         16  CL-CURRENT-GROUPING     PIC X(6).
  7643         16  CL-CURRENT-STATE        PIC XX.
  7644         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7645
  7646     12  CL-ASSOCIATES               PIC X.
  7647         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7648         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7649         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7650         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7651
  7652     12  CL-ACTIVITY-CODE            PIC 99.
  7653     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7654     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7655
  7656     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7657     12  CL-LAG-REPORT-CODE          PIC 9.
  7658     12  CL-LOAN-TYPE                PIC XX.
  7659     12  CL-LEGAL-STATE              PIC XX.
  7660
  7661     12  CL-YESNOSW                  PIC X.
  7662     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7663         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7664         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7665         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7666     12  cl-insured-claim            pic x.
  7667         88  cl-claim-on-primary         value 'P'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 141
* EL6311.cbl
  7668         88  cl-claim-on-secondary       value 'S'.
  7669     12  cl-benefit-expiration-dt    PIC XX.
  7670*                                COPY ERCENDT.
  7671******************************************************************
  7672*                                                                *
  7673*                                                                *
  7674*                            ERCENDT.                            *
  7675*                            VMOD=2.001                          *
  7676*                                                                *
  7677*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7678*                                                                *
  7679*   FILE TYPE = VSAM,KSDS                                        *
  7680*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7681*                                                                *
  7682*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7683*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7684*                                                                *
  7685*   LOG = NO                                                     *
  7686*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7687******************************************************************
  7688*-----------------------------------------------------------------
  7689*                   C H A N G E   L O G
  7690*
  7691* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7692*-----------------------------------------------------------------
  7693*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7694* EFFECTIVE    NUMBER
  7695*-----------------------------------------------------------------
  7696* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7697*                                WITH OPEN CLAIMS
  7698* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7699* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7700* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7701*-----------------------------------------------------------------
  7702 01  ENDORSEMENT-RECORD.
  7703     12  EN-RECORD-ID                PIC XX.
  7704         88  VALID-EN-ID                VALUE 'EN'.
  7705     12  EN-CONTROL-PRIMARY.
  7706         16  EN-COMPANY-CD           PIC X.
  7707         16  EN-CARRIER              PIC X.
  7708         16  EN-GROUPING             PIC X(6).
  7709         16  EN-STATE                PIC XX.
  7710         16  EN-ACCOUNT              PIC X(10).
  7711         16  EN-CERT-EFF-DT          PIC XX.
  7712         16  EN-CERT-NO.
  7713             20  EN-CERT-PRIME       PIC X(10).
  7714             20  EN-CERT-SFX         PIC X.
  7715         16  EN-REC-TYPE             PIC X.
  7716             88  EN-ISSUE               VALUE 'I'.
  7717             88  EN-CANCELLATION        VALUE 'C'.
  7718         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7719     12  EN-CONTROL-BY-ARCH-NO.
  7720         16  EN-COMPANY-CD-A1              PIC X.
  7721         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7722     12  EN-LAST-MAINT-DT            PIC XX.
  7723     12  EN-LAST-MAINT-BY            PIC X(4).
  7724     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7725     12  EN-ENDORSEMENT-RECORD       PIC X(329).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 142
* EL6311.cbl
  7726     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7727         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7728         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7729         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7730         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7731         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7732         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7733         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7734         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7735         16  EN-LF-ORIG-BENCD        PIC XX.
  7736         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7737         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7738         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7739         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7740         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7741         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7742*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7743         16  EN-ORIG-CRED-BENE       PIC X(25).
  7744         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7745         16  FILLER                  PIC X.
  7746         16  EN-AH-ORIG-BENCD        PIC XX.
  7747         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7748         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7749         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7750         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7751*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7752*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7753         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7754         16  F                       PIC X(09).
  7755         16  EN-AH-ORIG-CP           PIC 99.
  7756         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7757         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7758         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7759         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7760         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7761         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7762         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7763         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7764         16  EN-LF-NEW-BENCD         PIC XX.
  7765         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7766         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7767         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7768         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7769         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7770         16  EN-LF-NEW-EXP-DT        PIC XX.
  7771         16  EN-NEW-CRED-BENE        PIC X(25).
  7772         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7773         16  FILLER                  PIC X.
  7774         16  EN-AH-NEW-BENCD         PIC XX.
  7775         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7776         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7777         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7778         16  EN-AH-NEW-EXP-DT        PIC XX.
  7779*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7780*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7781*        16  F                       PIC X(12).
  7782         16  EN-AH-NEW-CP            PIC 99.
  7783         16  EN-SIG-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 143
* EL6311.cbl
  7784         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7785         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7786         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7787         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7788         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7789         16  FILLER                  PIC X(33).
  7790     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7791         16  EN-LF-ORIG-REF-DT       PIC XX.
  7792         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7793         16  EN-AH-ORIG-REF-DT       PIC XX.
  7794         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7795         16  EN-LF-NEW-REF-DT        PIC XX.
  7796         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7797         16  EN-AH-NEW-REF-DT        PIC XX.
  7798         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7799         16  EN-FLAG-CERT            PIC X.
  7800         16  EN-INS-LAST-NAME        PIC X(15).
  7801         16  EN-INS-FIRST-NAME       PIC X(10).
  7802         16  EN-INS-MIDDLE-INIT      PIC X.
  7803         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7804         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7805         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7806         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7807         16  FILLER                  PIC X(262).
  7808     12  EN-MONEY-SW             PIC X.
  7809     12  EN-HEALTH-APP           PIC X.
  7810     12  EN-VOUCHER-SW           PIC X.
  7811     12  EN-PAYEE                PIC X(14).
  7812     12  EN-INPUT-DT             PIC XX.
  7813     12  EN-PROCESS-DT           PIC XX.
  7814     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7815     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7816     12  EN-REASON-CODES.
  7817         16  F OCCURS 12.
  7818             20  EN-REASON-CODE  PIC X(4).
  7819     12  EN-TEMPLATE-USED        PIC X(8).
  7820     12  EN-DOCU-TYPE            PIC X.
  7821         88  EN-VERI-DOCU          VALUE 'V'.
  7822         88  EN-GCE-DOCU           VALUE 'G'.
  7823         88  EN-CANC-DOCU          VALUE 'C'.
  7824     12  EN-COMMENTS1            PIC X(13).
  7825     12  EN-COMMENTS2            PIC X(70).
  7826     12  EN-COMM-CHGBK           PIC X.
  7827         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7828         88  EN-CHG-ACCT           VALUE 'Y'.
  7829     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7830     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7831     12  EN-BATCH-NUMBER         PIC X(6).
  7832     12  EN-ACCT-SUMM            PIC X.
  7833     12  EN-CSO-SUMM             PIC X.
  7834     12  FILLER                  PIC X(13).
  7835******************************************************************
  7836*                                COPY ELCCRTT.
  7837******************************************************************
  7838*                                                                *
  7839*                            ELCCRTT.                            *
  7840*                                                                *
  7841*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 144
* EL6311.cbl
  7842*                                                                *
  7843*   FILE TYPE = VSAM,KSDS                                        *
  7844*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7845*                                                                *
  7846*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7847*                                                                *
  7848*   LOG = YES                                                    *
  7849*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7850******************************************************************
  7851*                   C H A N G E   L O G
  7852*
  7853* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7854*-----------------------------------------------------------------
  7855*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7856* EFFECTIVE    NUMBER
  7857*-----------------------------------------------------------------
  7858* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7859* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7860* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7861* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7862* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7863******************************************************************
  7864
  7865 01  CERTIFICATE-TRAILERS.
  7866     12  CS-RECORD-ID                      PIC XX.
  7867         88  VALID-CS-ID                      VALUE 'CS'.
  7868
  7869     12  CS-CONTROL-PRIMARY.
  7870         16  CS-COMPANY-CD                 PIC X.
  7871         16  CS-CARRIER                    PIC X.
  7872         16  CS-GROUPING                   PIC X(6).
  7873         16  CS-STATE                      PIC XX.
  7874         16  CS-ACCOUNT                    PIC X(10).
  7875         16  CS-CERT-EFF-DT                PIC XX.
  7876         16  CS-CERT-NO.
  7877             20  CS-CERT-PRIME             PIC X(10).
  7878             20  CS-CERT-SFX               PIC X.
  7879         16  CS-TRAILER-TYPE               PIC X.
  7880             88  COMM-TRLR           VALUE 'A'.
  7881             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7882             88  CERT-DATA-TRLR      VALUE 'C'.
  7883
  7884     12  CS-DATA-AREA                      PIC X(516).
  7885
  7886     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7887         16  CS-BANK-COMMISSION-AREA.
  7888             20  CS-BANK-COMMS       OCCURS 10.
  7889                 24  CS-AGT                PIC X(10).
  7890                 24  CS-COM-TYP            PIC X.
  7891                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7892                 24  CS-RECALC-LV-INDIC    PIC X.
  7893                 24  FILLER                PIC X(10).
  7894         16  FILLER                        PIC X(256).
  7895
  7896     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7897****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7898****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7899         16  CS-MB-CLAIM-DATA OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 145
* EL6311.cbl
  7900             20  FILLER OCCURS 10.
  7901                 24  CS-CLAIM-TYPE         PIC X.
  7902                     88  CS-AH-CLM           VALUE 'A'.
  7903                     88  CS-IU-CLM           VALUE 'I'.
  7904                     88  CS-GP-CLM           VALUE 'G'.
  7905                     88  CS-LF-CLM           VALUE 'L'.
  7906                     88  CS-PR-CLM           VALUE 'P'.
  7907                 24  CS-BANK               PIC S999 COMP-3.
  7908                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7909                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7910                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  7911         16  FILLER                        PIC X(216).
  7912     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7913         16  CS-VIN-NUMBER                 PIC X(17).
  7914         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7915         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7916         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7917         16  FILLER                        PIC X(496).
  7918******************************************************************
  7919*                                COPY ERCCHEK.
  7920******************************************************************
  7921*                                                                *
  7922*                                                                *
  7923*                            ERCCHEK                             *
  7924*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7925*                            VMOD=2.008                          *
  7926*                                                                *
  7927*   FILE DESCRIPTION = CHECK RECORDS                             *
  7928*                                                                *
  7929*   FILE TYPE = VSAM,KSDS                                        *
  7930*   RECORD SIZE = 600    RECFORM = FIXED                         *
  7931*                                                                *
  7932*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  7933*       ALTERNATE INDEX = NONE                                   *
  7934*                                                                *
  7935*   LOG = YES                                                    *
  7936*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7937******************************************************************
  7938*                   C H A N G E   L O G
  7939*
  7940* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7941*-----------------------------------------------------------------
  7942*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7943* EFFECTIVE    NUMBER
  7944*-----------------------------------------------------------------
  7945* 021414    2003053000001  PEMA  changes for auto chk request
  7946******************************************************************
  7947 01  CHECK-RECORDS.
  7948     12  CH-RECORD-ID                      PIC XX.
  7949         88  VALID-CH-ID                      VALUE 'CH'.
  7950
  7951     12  CH-CONTROL-PRIMARY.
  7952         16  CH-COMPANY-CD                 PIC X.
  7953         16  CH-CARRIER                    PIC X.
  7954         16  CH-GROUPING                   PIC X(6).
  7955         16  CH-STATE                      PIC XX.
  7956         16  CH-ACCOUNT                    PIC X(10).
  7957         16  CH-CERT-EFF-DT                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 146
* EL6311.cbl
  7958         16  CH-CERT-NO.
  7959             20  CH-CERT-PRIME             PIC X(10).
  7960             20  CH-CERT-SFX               PIC X.
  7961         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  7962
  7963     12  CH-RECORDED-DT                    PIC XX.
  7964     12  CH-RECORDED-BY                    PIC X(4).
  7965     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  7966
  7967     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  7968     12  CH-CHECK-NO                       PIC X(7).
  7969     12  CH-REASON-FOR-CHECK               PIC X(25).
  7970     12  CH-CHECK-WRITTEN-DT               PIC XX.
  7971     12  FILLER                            PIC X.
  7972
  7973     12  CH-PAYEE-INFO.
  7974         16  CH-PAYEE-NAME-1               PIC X(30).
  7975         16  CH-PAYEE-NAME-2               PIC X(30).
  7976         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  7977         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  7978         16  CH-PAYEE-CITY-ST.
  7979             20  CH-PAYEE-CITY             PIC X(28).
  7980             20  CH-PAYEE-STATE            PIC XX.
  7981         16  CH-PAYEE-ZIP-CODE.
  7982             20  CH-PAYEE-ZIP.
  7983                 24  CH-ZIP-PRI-1ST        PIC X.
  7984                     88  CH-CANADIAN-POST-CODE
  7985                                           VALUES 'A' THRU 'Z'.
  7986                 24  FILLER                PIC X(4).
  7987             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  7988         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  7989             20  CH-CAN-POSTAL-1           PIC XXX.
  7990             20  CH-CAN-POSTAL-2           PIC XXX.
  7991             20  FILLER                    PIC XXX.
  7992
  7993     12  CH-CHECK-STUB-TEXT.
  7994         16  CH-STUB-LINE-1                PIC X(30).
  7995         16  CH-TEXT-LINE-1                PIC X(50).
  7996         16  CH-TEXT-LINE-2                PIC X(50).
  7997         16  CH-TEXT-LINE-3                PIC X(40).
  7998     12  CH-RETURN-TO                      PIC X(30).
  7999
  8000     12  CH-COMPENSATION-CONTROL.
  8001         16  CH-COMP-CARRIER               PIC X.
  8002         16  CH-COMP-GROUPING              PIC X(6).
  8003         16  CH-COMP-FIN-RESP              PIC X(10).
  8004         16  CH-COMP-ACCOUNT               PIC X(10).
  8005
  8006     12  CH-CREDIT-SELECT-DT               PIC XX.
  8007     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8008     12  CH-PAYEE-CODE                     PIC X(6).
  8009
  8010     12  CH-VOID-DATA.
  8011         20  CH-VOID-DT                    PIC XX.
  8012         20  CH-VOID-BY                    PIC X(4).
  8013         20  CH-VOID-REASON                PIC X(25).
  8014
  8015     12  CH-APPROVAL-DATA.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 147
* EL6311.cbl
  8016         20  CH-APPROVAL-DT                PIC XX.
  8017         20  CH-APPROVAL-STATUS            PIC X.
  8018             88  CH-IN-LIMBO                  VALUE ' '.
  8019             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8020             88  CH-APPROVED                  VALUE 'A'.
  8021             88  CH-DENIED                    VALUE 'D'.
  8022         20  CH-APPROVED-BY                PIC XXXX.
  8023     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8024             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8025     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8026
  8027     12  ch-released-dt                    pic xx.
  8028     12  ch-check-cashed-dt                pic xx.
  8029     12  FILLER                            PIC X.
  8030*    12  CH-CHECK-REFERENCE                PIC X(12).
  8031     12  CH-CHECK-ORIGIN-SW                PIC X.
  8032             88  CH-REFUND-CHECK              VALUE 'R'.
  8033             88  CH-MAINT-CHECK               VALUE 'M'.
  8034
  8035     12  CH-CANC-DT                        PIC XX.
  8036     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8037     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8038
  8039     12  CH-INSURED-NAME                   PIC X(28).
  8040
  8041     12  ch-released-by                    pic x(4).
  8042     12  ch-csr                            pic x(4).
  8043     12  ch-deduct-commission              pic x.
  8044         88  ch-deduct-comm                  value 'Y'.
  8045         88  ch-do-not-deduct-comm           value 'N'.
  8046
  8047     12  FILLER                            PIC X(11).
  8048*    12  CH-LETTER-TABLE.
  8049*        16  CH-LETTERS OCCURS 3 TIMES
  8050*                       INDEXED BY CH-LT-NDX
  8051*                                          PIC X(04).
  8052
  8053     12  FILLER                            PIC X(07).
  8054
  8055 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8056                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8057                          PENDING-MAILING-DATA MAILING-DATA
  8058                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8059                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8060                          CLAIM-MASTER ENDORSEMENT-RECORD
  8061                          CERTIFICATE-TRAILERS CHECK-RECORDS.
  8062 0000-DFHEXIT SECTION.
  8063     MOVE '9#                    $   ' TO DFHEIV0.
  8064     MOVE 'EL6311' TO DFHEIV1.
  8065     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8066
  8067     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8068     MOVE EIBTRMID               TO QID-TERM.
  8069     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8070     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8071     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8072     MOVE 2                      TO EMI-SWITCH2.
  8073
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 148
* EL6311.cbl
  8074     IF EIBCALEN = 0
  8075         GO TO 8800-UNAUTHORIZED-ACCESS.
  8076
  8077     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8078     MOVE '5'                   TO DC-OPTION-CODE.
  8079     PERFORM 9700-DATE-LINK.
  8080     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8081     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8082
  8083     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8084     MOVE SPACE                  TO DC-OPTION-CODE.
  8085     PERFORM 9700-DATE-LINK.
  8086     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8087     MOVE LOW-VALUES             TO EL631BI.
  8088
  8089
  8090* EXEC CICS HANDLE CONDITION
  8091*        PGMIDERR  (9600-PGMID-ERROR)
  8092*        ERROR     (9990-ABEND)
  8093*        INVREQ    (9990-ABEND)
  8094*        QIDERR    (0010-MAIN-LOGIC)
  8095*    END-EXEC.
  8096*    MOVE '"$L.8N                ! " #00008085' TO DFHEIV0
  8097     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8098     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8099     MOVE X'2220233030303038303835' TO DFHEIV0(25:11)
  8100     CALL 'kxdfhei1' USING DFHEIV0
  8101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8102
  8103
  8104     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8105         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8106             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8107             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8108             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8109             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8110             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8111             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8112             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8113             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8114
  8115             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8116                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8117
  8118             ELSE
  8119                 NEXT SENTENCE
  8120
  8121         ELSE
  8122             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8123             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8124             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8125             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8126             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8127             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8128             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8129             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8130             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8131             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 149
* EL6311.cbl
  8132             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8133             GO TO 3900-RE-DISPLAY-RECORD
  8134     ELSE
  8135         GO TO 0020-MAIN-LOGIC.
  8136
  8137 0010-MAIN-LOGIC.
  8138     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8139                                    WS-FIRST-ENTRY-SW.
  8140
  8141     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8142
  8143     MOVE LOW-VALUES             TO EC-NEW-CERT
  8144                                    EC-NEW-STATE.
  8145
  8146     IF PI-DISPLAY-ORIGINAL-BATCH
  8147         NEXT SENTENCE
  8148     ELSE
  8149         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8150             GO TO 5000-BROWSE-BATCH-HEADERS.
  8151
  8152     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8153         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8154
  8155     IF PI-CSR-BROWSE
  8156        GO TO 4200-BROWSE-CSR-FORWARD.
  8157
  8158     IF PI-FILE-BROWSE
  8159         GO TO 4300-BROWSE-FILE-FORWARD.
  8160
  8161     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8162
  8163 0020-MAIN-LOGIC.
  8164     IF EIBAID = DFHCLEAR
  8165         GO TO 9400-CLEAR.
  8166
  8167     MOVE LOW-VALUES             TO EC-NEW-CERT
  8168                                    EC-NEW-STATE.
  8169
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 150
* EL6311.cbl
  8171
  8172******************************************************************
  8173*                                                                *
  8174*              R E C E I V E   M A P                             *
  8175*                                                                *
  8176******************************************************************
  8177
  8178 0200-RECEIVE.
  8179     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8180         MOVE ER-0008            TO EMI-ERROR
  8181         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8182         IF PI-MAP-NAME = EL631B
  8183             MOVE -1                 TO BMAINTL
  8184             GO TO 8200-SEND-DATAONLY
  8185         ELSE
  8186             IF PI-MAP-NAME = EL631C
  8187                 MOVE -1                 TO CMAINTL
  8188                 GO TO 8200-SEND-DATAONLY
  8189             ELSE
  8190                 IF PI-MAP-NAME = EL631D
  8191                     MOVE -1                 TO DPFENTRL
  8192                     GO TO 8200-SEND-DATAONLY.
  8193
  8194
  8195* EXEC CICS RECEIVE
  8196*        MAP      (PI-MAP-NAME)
  8197*        MAPSET   (MAPSET-EL6311S)
  8198*        INTO     (EL631BI)
  8199*    END-EXEC.
  8200     MOVE LENGTH OF
  8201      EL631BI
  8202       TO DFHEIV11
  8203*    MOVE '8"T I  L              ''   #00008182' TO DFHEIV0
  8204     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8205     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8206     MOVE X'2020233030303038313832' TO DFHEIV0(25:11)
  8207     CALL 'kxdfhei1' USING DFHEIV0,
  8208           PI-MAP-NAME,
  8209           EL631BI,
  8210           DFHEIV11,
  8211           MAPSET-EL6311S,
  8212           DFHEIV99,
  8213           DFHEIV99
  8214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8215
  8216
  8217******************************************************************
  8218*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8219******************************************************************
  8220
  8221     IF BTYPE-LEN (1) EQUAL +3
  8222        IF BTYPE (1) EQUAL ALL ' '
  8223            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8224
  8225     IF BTYPE-LEN (2) EQUAL +3
  8226        IF BTYPE (2) EQUAL ALL ' '
  8227            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8228
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 151
* EL6311.cbl
  8229     INSPECT EL631BI CONVERTING '_' TO ' '.
  8230
  8231     IF PI-MAP-NAME = EL631B
  8232         IF BPFENTRL GREATER THAN ZEROS
  8233             IF EIBAID NOT = DFHENTER
  8234                 MOVE ER-0004       TO EMI-ERROR
  8235                 MOVE -1            TO BPFENTRL
  8236                 MOVE AL-UNBOF      TO BPFENTRA
  8237                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8238                 GO TO 8200-SEND-DATAONLY
  8239             ELSE
  8240                 IF BPFENTRI NUMERIC AND
  8241                   (BPFENTRI GREATER 0 AND LESS 25)
  8242                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8243                 ELSE
  8244                     MOVE ER-0029  TO EMI-ERROR
  8245                     MOVE AL-UNBON TO BPFENTRA
  8246                     MOVE -1       TO BPFENTRL
  8247                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8248                     GO TO 8200-SEND-DATAONLY
  8249         ELSE
  8250             NEXT SENTENCE
  8251     ELSE
  8252         IF PI-MAP-NAME = EL631C
  8253            IF CPFENTRL GREATER THAN ZEROS
  8254                IF EIBAID NOT = DFHENTER
  8255                 MOVE ER-0004         TO EMI-ERROR
  8256                 MOVE -1              TO CPFENTRL
  8257                 MOVE AL-UNBOF        TO CPFENTRA
  8258                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8259                 GO TO 8200-SEND-DATAONLY
  8260             ELSE
  8261                 IF CPFENTRI NUMERIC AND
  8262                   (CPFENTRI GREATER 0 AND LESS 25)
  8263                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8264                 ELSE
  8265                     MOVE ER-0029      TO EMI-ERROR
  8266                     MOVE AL-UNBON     TO CPFENTRA
  8267                     MOVE -1           TO CPFENTRL
  8268                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8269                     GO TO 8200-SEND-DATAONLY
  8270         ELSE
  8271             NEXT SENTENCE
  8272     ELSE
  8273     IF PI-MAP-NAME = EL631D
  8274         IF DPFENTRL GREATER THAN ZEROS
  8275             IF EIBAID NOT = DFHENTER
  8276                 MOVE ER-0004         TO EMI-ERROR
  8277                 MOVE -1              TO DPFENTRL
  8278                 MOVE AL-UNBOF        TO DPFENTRA
  8279                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8280                 GO TO 8200-SEND-DATAONLY
  8281             ELSE
  8282                 IF DPFENTRI NUMERIC AND
  8283                   (DPFENTRI GREATER 0 AND LESS 25)
  8284                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8285                 ELSE
  8286                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 152
* EL6311.cbl
  8287                     MOVE AL-UNBON     TO DPFENTRA
  8288                     MOVE -1           TO DPFENTRL
  8289                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8290                     GO TO 8200-SEND-DATAONLY.
  8291
  8292     IF EIBAID = DFHPF23
  8293         GO TO 8810-PF23.
  8294
  8295     IF EIBAID = DFHPF24
  8296         GO TO 9200-RETURN-MAIN-MENU.
  8297
  8298     IF EIBAID = DFHPF12
  8299         GO TO 9500-PF12.
  8300
  8301     IF PI-MAP-NAME = EL631B
  8302        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8303
  8304     IF PI-MAP-NAME = EL631C
  8305        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8306
  8307     IF PI-MAP-NAME = EL631D
  8308        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8309
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 153
* EL6311.cbl
  8311
  8312******************************************************************
  8313*                                                                *
  8314*      ISSUE SCREEN PF KEY CHECKING                              *
  8315*                                                                *
  8316******************************************************************
  8317
  8318******************************************************************
  8319*                                                                *
  8320*      PF KEY FUNCTIONS:                                         *
  8321*                                                                *
  8322*      PF1  = BROWSE FORWARD                                     *
  8323*      PF2  = BROWSE BACKWARD                                    *
  8324*      PF3  = CERTIFICATE LOOKUP                                 *
  8325*      PF4  = DISPLAY BATCH HEADER                               *
  8326*      PF5  = ADD ISSUE  SCREEN                                  *
  8327*      PF6  = ADD CANCEL SCREEN                                  *
  8328*      PF7  = CERTIFICATE DISPLAY                                *
  8329*      PF8  = CERTIFICATE NOTES                                  *
  8330*      PF9  = EDIT CONTROL                                       *
  8331*      PF10 = DISPLAY LETTER SCREEN                              *
  8332*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8333*      PF12 = HELP SCREEN                                        *
  8334*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8335*      PF14 = ACCOUNT MASTER                                     *
  8336*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8337*      PF16 = DISPLAY LETTER REVIEW                              *
  8338*                                                                *
  8339******************************************************************
  8340
  8341 0300-CHECK-ISSUE-PF-KEYS.
  8342     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8343        MOVE ER-2337            TO EMI-ERROR
  8344        MOVE -1                  TO BMAINTL
  8345        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8346        GO TO 8200-SEND-DATAONLY.
  8347
  8348     IF EIBAID = DFHPF1
  8349        MOVE '0'                TO PI-EDIT-SW
  8350        IF PI-PRIMARY-BROWSE
  8351           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8352        ELSE
  8353           IF PI-PRIMARY-WITH-SELECT
  8354              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8355           ELSE
  8356              IF PI-FILE-BROWSE
  8357                 GO TO 4300-BROWSE-FILE-FORWARD
  8358              ELSE
  8359                 IF PI-CSR-BROWSE
  8360                    GO TO 4200-BROWSE-CSR-FORWARD
  8361                 ELSE
  8362                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8363
  8364     IF EIBAID = DFHPF2
  8365        MOVE '0'                TO PI-EDIT-SW
  8366        IF PI-PRIMARY-BROWSE
  8367           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8368        ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 154
* EL6311.cbl
  8369           IF PI-PRIMARY-WITH-SELECT
  8370              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8371           ELSE
  8372              IF PI-FILE-BROWSE
  8373                 GO TO 4800-BROWSE-FILE-BACKWARD
  8374              ELSE
  8375                 IF PI-CSR-BROWSE
  8376                    GO TO 4900-BROWSE-CSR-BACKWARD
  8377                 ELSE
  8378                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8379
  8380     IF EIBAID = DFHPF3
  8381        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8382        MOVE XCTL-EL127         TO PGM-NAME
  8383        GO TO 9300-XCTL.
  8384
  8385     IF (EIBAID = DFHPF15 OR DFHPF6)
  8386        AND (CSR-EDIT-SESSION)
  8387*       AND (FATAL-OR-UNFORCED)
  8388        AND (FATAL-ERRORS)
  8389        MOVE ER-1819             TO EMI-ERROR
  8390        MOVE -1                  TO BMAINTL
  8391        MOVE AL-UANON            TO BMAINTA
  8392        PERFORM 9900-ERROR-FORMAT
  8393                                 THRU 9900-EXIT
  8394        GO TO 8200-SEND-DATAONLY
  8395     END-IF
  8396     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8397      OR (EIBAID = DFHPF10)
  8398        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8399        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8400        IF (RESP-NORMAL)
  8401           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8402              AM-CONTROL-PRIMARY (1:20))
  8403            IF AM-NAME NOT GREATER THAN SPACES OR
  8404               AM-ADDRS NOT GREATER THAN SPACES  OR
  8405               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8406               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8407               AM-ZIP NOT GREATER THAN SPACES
  8408               MOVE ER-3834             TO EMI-ERROR
  8409               MOVE -1                  TO BMAINTL
  8410               MOVE AL-UANON            TO BMAINTA
  8411               PERFORM 9900-ERROR-FORMAT
  8412                                 THRU 9900-EXIT
  8413               GO TO 8200-SEND-DATAONLY
  8414            END-IF
  8415        ELSE
  8416           MOVE ER-1609             TO EMI-ERROR
  8417           MOVE -1                  TO BMAINTL
  8418           MOVE AL-UANON            TO BMAINTA
  8419           PERFORM 9900-ERROR-FORMAT
  8420                                THRU 9900-EXIT
  8421           GO TO 8200-SEND-DATAONLY
  8422        END-IF
  8423
  8424        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8425        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8426        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 155
* EL6311.cbl
  8427            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8428               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8429               MA-CITY NOT GREATER THAN SPACES OR
  8430               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8431               MA-ZIP-CODE NOT GREATER THAN SPACES
  8432               MOVE ER-3835             TO EMI-ERROR
  8433               MOVE -1                  TO BMAINTL
  8434               MOVE AL-UANON            TO BMAINTA
  8435               PERFORM 9900-ERROR-FORMAT
  8436                                 THRU 9900-EXIT
  8437               GO TO 8200-SEND-DATAONLY
  8438            END-IF
  8439        ELSE
  8440           MOVE ER-3000             TO EMI-ERROR
  8441           MOVE -1                  TO BMAINTL
  8442           MOVE AL-UANON            TO BMAINTA
  8443           PERFORM 9900-ERROR-FORMAT
  8444                                THRU 9900-EXIT
  8445           GO TO 8200-SEND-DATAONLY
  8446        END-IF
  8447
  8448     END-IF
  8449     IF (EIBAID = DFHPF15)
  8450        AND (CSR-EDIT-SESSION)
  8451        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8452        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8453        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8454        MOVE PI-SV-STATE         TO PI-STATE
  8455        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8456        MOVE BCERTNOI            TO PI-CERT-PRIME
  8457        MOVE BSUFIXI             TO PI-CERT-SFX
  8458        MOVE BEFFDTI             TO DEEDIT-FIELD
  8459        PERFORM 8600-DEEDIT
  8460        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8461        MOVE '4'                 TO DC-OPTION-CODE
  8462        PERFORM 9700-DATE-LINK
  8463        IF DATE-CONVERSION-ERROR
  8464           MOVE ER-0348          TO EMI-ERROR
  8465           MOVE -1               TO BEFFDTL
  8466           MOVE AL-UABON         TO BEFFDTA
  8467           PERFORM 9900-ERROR-FORMAT
  8468                                 THRU 9900-EXIT
  8469           GO TO 8200-SEND-DATAONLY
  8470        ELSE
  8471           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8472           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8473           MOVE XCTL-EL6315      TO PGM-NAME
  8474           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8475           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8476           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8477           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8478           GO TO 9300-XCTL
  8479        END-IF
  8480     END-IF
  8481
  8482     IF EIBAID = DFHPF4
  8483        MOVE '0'                TO PI-EDIT-SW
  8484        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 156
* EL6311.cbl
  8485           NEXT SENTENCE
  8486        ELSE
  8487           GO TO 7200-DISPLAY-BATCHES.
  8488
  8489     IF EIBAID = DFHPF5
  8490        MOVE ER-0029                TO EMI-ERROR
  8491        MOVE -1                     TO BPFENTRL
  8492        MOVE AL-UNBON               TO BPFENTRA
  8493        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8494        GO TO 8200-SEND-DATAONLY.
  8495*        MOVE '0'                TO PI-EDIT-SW
  8496*        IF PI-DISPLAY-ORIGINAL-BATCH
  8497*           NEXT SENTENCE
  8498*        ELSE
  8499*           MOVE EL631B              TO PI-MAP-NAME
  8500*           MOVE LOW-VALUES          TO EL631BI
  8501*           MOVE 'A'                 TO BMAINTO
  8502*           MOVE AL-UANON            TO BMAINTA
  8503*           MOVE -1                  TO BMAINTL
  8504*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8505*           GO TO 8100-SEND-INITIAL-MAP.
  8506
  8507     IF EIBAID = DFHPF6
  8508        IF NOT CSR-EDIT-SESSION
  8509           MOVE ER-0029                TO EMI-ERROR
  8510           MOVE -1                     TO BPFENTRL
  8511           MOVE AL-UNBON               TO BPFENTRA
  8512           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8513           GO TO 8200-SEND-DATAONLY
  8514*           MOVE '0'              TO PI-EDIT-SW
  8515*           IF PI-DISPLAY-ORIGINAL-BATCH
  8516*              NEXT SENTENCE
  8517*           ELSE
  8518*              MOVE EL631C        TO PI-MAP-NAME
  8519*              MOVE LOW-VALUES    TO EL631CI
  8520*              MOVE 'A'           TO CMAINTO
  8521*              MOVE AL-UANON      TO CMAINTA
  8522*              MOVE -1            TO CMAINTL
  8523*              MOVE '6'           TO PI-MAINT-FUNCTION
  8524*              GO TO 8100-SEND-INITIAL-MAP
  8525*           END-IF
  8526        ELSE
  8527           PERFORM 5100-PROCESS-POL-RESC
  8528                                 THRU 5100-EXIT
  8529           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8530           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8531                                    PI-PREV-SEQ-NO
  8532           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8533*                                    WS-CANCEL-LETTER-SW
  8534                                    PI-ALL-ISSUES-SW
  8535                                    PI-ALL-CANCELS-SW
  8536           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8537        END-IF
  8538     END-IF
  8539     IF EIBAID = DFHPF7
  8540        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8541        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8542        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 157
* EL6311.cbl
  8543        MOVE PI-SV-STATE            TO PI-STATE
  8544        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8545        MOVE BCERTNOI               TO PI-CERT-PRIME
  8546        MOVE BSUFIXI                TO PI-CERT-SFX
  8547        MOVE BEFFDTI                TO DEEDIT-FIELD
  8548        PERFORM 8600-DEEDIT
  8549        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8550        MOVE '4'                    TO DC-OPTION-CODE
  8551        PERFORM 9700-DATE-LINK
  8552        IF DATE-CONVERSION-ERROR
  8553           MOVE ER-0348            TO EMI-ERROR
  8554           MOVE -1                  TO BEFFDTL
  8555           MOVE AL-UABON            TO BEFFDTA
  8556           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8557           GO TO 8200-SEND-DATAONLY
  8558        ELSE
  8559           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8560           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8561           MOVE XCTL-EL1273        TO PGM-NAME
  8562           GO TO 9300-XCTL.
  8563
  8564     IF EIBAID = DFHPF8
  8565        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8566        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8567        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8568        MOVE PI-SV-STATE            TO PI-STATE
  8569        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8570        MOVE BCERTNOI               TO PI-CERT-PRIME
  8571        MOVE BSUFIXI                TO PI-CERT-SFX
  8572        MOVE BEFFDTI                TO DEEDIT-FIELD
  8573        PERFORM 8600-DEEDIT
  8574        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8575        MOVE '4'                    TO DC-OPTION-CODE
  8576        PERFORM 9700-DATE-LINK
  8577        IF DATE-CONVERSION-ERROR
  8578           MOVE ER-0348            TO EMI-ERROR
  8579           MOVE -1                  TO BEFFDTL
  8580           MOVE AL-UABON            TO BEFFDTA
  8581           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8582           GO TO 8200-SEND-DATAONLY
  8583        ELSE
  8584           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8585           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8586           IF PI-COMPANY-ID = 'DMD'
  8587               MOVE XCTL-EL401DMD      TO PGM-NAME
  8588             ELSE
  8589               MOVE XCTL-EL1279        TO PGM-NAME
  8590           END-IF
  8591           GO TO 9300-XCTL.
  8592
  8593     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8594        MOVE XCTL-EL6312         TO PGM-NAME
  8595
  8596* EXEC CICS XCTL
  8597*           PROGRAM   (PGM-NAME)
  8598*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8599*           LENGTH    (WS-COMM-LENGTH)
  8600*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 158
* EL6311.cbl
  8601*    MOVE '.$C                   %   #00008566' TO DFHEIV0
  8602     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8603     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8604     MOVE X'2020233030303038353636' TO DFHEIV0(25:11)
  8605     CALL 'kxdfhei1' USING DFHEIV0,
  8606           PGM-NAME,
  8607           PROGRAM-INTERFACE-BLOCK,
  8608           WS-COMM-LENGTH,
  8609           DFHEIV99
  8610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8611     ELSE
  8612        MOVE '0'                 TO  PI-EDIT-SW.
  8613
  8614     IF  EIBAID = DFHPF10
  8615         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8616         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8617         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8618                                    PI-1042-WA
  8619         MOVE 4                  TO PI-689-DATA-SOURCE
  8620         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8621         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8622         MOVE PI-SV-STATE        TO PI-689-STATE
  8623         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8624         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8625         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8626         MOVE PI-PB-ALT-CHG-SEQ-NO
  8627                                 TO PI-689-ALT-SEQ-NO
  8628         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8629         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8630         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8631         MOVE +0                 TO PI-689-CONTROL
  8632         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8633                                    PI-689-EXP-DATE
  8634                                    PI-689-RESP-PERSON
  8635                                    PI-689-TYPE
  8636                                    PI-689-FOLLOW-UP-EDIT
  8637                                    PI-689-RESEND1-EDIT
  8638                                    PI-689-SEQ-EDIT
  8639                                    PI-689-BCSEQ-EDIT
  8640                                    PI-689-LBL-OVERRIDE
  8641         MOVE W-LETTER-COMMUNICATION-AREAS
  8642                                 TO PI-PROGRAM-WORK-AREA
  8643         MOVE XCTL-EL689         TO PGM-NAME
  8644         GO TO 9300-XCTL.
  8645
  8646     IF  EIBAID = DFHPF16
  8647         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8648         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8649         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8650                                    PI-1042-WA
  8651         MOVE 4                  TO PI-689-DATA-SOURCE
  8652         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8653         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8654         MOVE PI-SV-STATE        TO PI-689-STATE
  8655         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8656         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8657         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8658         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 159
* EL6311.cbl
  8659                                 TO PI-689-ALT-SEQ-NO
  8660         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8661         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8662         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8663         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8664         MOVE W-LETTER-COMMUNICATION-AREAS
  8665                                 TO PI-PROGRAM-WORK-AREA
  8666         MOVE XCTL-EL690         TO PGM-NAME
  8667         GO TO 9300-XCTL.
  8668
  8669     IF EIBAID = DFHPF13
  8670         MOVE XCTL-EL6313        TO PGM-NAME
  8671         GO TO 9300-XCTL.
  8672
  8673     IF EIBAID = DFHPF17
  8674        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8675        IF (PB-I-LOAN-APR > ZEROS)
  8676           and (pb-i-loan-apr < 99.9999)
  8677           AND (PB-I-BENEFICIARY-NAME NOT
  8678              = SPACES AND LOW-VALUES)
  8679
  8680           MOVE LINK-ELVADS          TO PGM-NAME
  8681
  8682* EXEC CICS LINK
  8683*              PROGRAM    (PGM-NAME)
  8684*              COMMAREA   (WS-PASS-AREA)
  8685*              LENGTH     (WS-PASS-AREA-LENGTH)
  8686*          END-EXEC
  8687*    MOVE '."C                   (   #00008641' TO DFHEIV0
  8688     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8689     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8690     MOVE X'2020233030303038363431' TO DFHEIV0(25:11)
  8691     CALL 'kxdfhei1' USING DFHEIV0,
  8692           PGM-NAME,
  8693           WS-PASS-AREA,
  8694           WS-PASS-AREA-LENGTH,
  8695           DFHEIV99,
  8696           DFHEIV99,
  8697           DFHEIV99,
  8698           DFHEIV99
  8699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8700
  8701           MOVE 0000             TO EMI-ERROR
  8702           MOVE -1               TO BMAINTL
  8703           PERFORM 9900-ERROR-FORMAT
  8704                                 THRU 9900-EXIT
  8705           GO TO 8200-SEND-DATAONLY
  8706        ELSE
  8707           MOVE ER-0877            TO EMI-ERROR
  8708           MOVE -1                  TO BEFFDTL
  8709           MOVE AL-UABON            TO BEFFDTA
  8710           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8711           GO TO 8200-SEND-DATAONLY
  8712        END-IF
  8713     END-IF
  8714     IF EIBAID = DFHPF14
  8715        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8716        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 160
* EL6311.cbl
  8717        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8718        MOVE PI-SV-STATE            TO PI-CR-STATE
  8719        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8720        MOVE SPACE                  TO PI-EDIT-SW
  8721        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8722        MOVE XCTL-EL650             TO PGM-NAME
  8723        GO TO 9300-XCTL.
  8724
  8725     IF EIBAID = DFHPF15
  8726        IF PI-COMPANY-ID  =  'HER'
  8727            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8728            MOVE XCTL-EL680         TO PGM-NAME
  8729            GO TO 9300-XCTL.
  8730
  8731     IF EIBAID = DFHENTER OR DFHPF11
  8732        GO TO 1000-ISSUE-MAINLINE.
  8733
  8734     MOVE ER-0029                TO EMI-ERROR
  8735     MOVE -1                     TO BPFENTRL
  8736     MOVE AL-UNBON               TO BPFENTRA
  8737     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8738     GO TO 8200-SEND-DATAONLY.
  8739
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 161
* EL6311.cbl
  8741
  8742******************************************************************
  8743*                                                                *
  8744*      CANCEL SCREEN PF KEY CHECKING                             *
  8745*                                                                *
  8746******************************************************************
  8747
  8748******************************************************************
  8749*                                                                *
  8750*      PF KEY FUNCTIONS:                                         *
  8751*                                                                *
  8752*      PF1  = BROWSE FORWARD                                     *
  8753*      PF2  = BROWSE BACKWARD                                    *
  8754*      PF3  = CERTIFICATE LOOKUP                                 *
  8755*      PF4  = DISPLAY BATCH HEADER                               *
  8756*      PF5  = ADD ISSUE SCREEN                                   *
  8757*      PF6  = ADD CANCEL SCREEN                                  *
  8758*      PF7  = CERTIFICATE DISPLAY                                *
  8759*      PF8  = CERTIFICATE NOTES                                  *
  8760*      PF9  = EDIT CONTROL                                       *
  8761*      PF10 = DISPLAY LETTER SCREEN                              *
  8762*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8763*      PF12 = DISPLAY HELP SCREEN                                *
  8764*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8765*      PF14 = ACCOUNT MASTER                                     *
  8766*      PF16 = LETTER REVIEW                                      *
  8767*                                                                *
  8768******************************************************************
  8769
  8770 0400-CHECK-CANCEL-PF-KEYS.
  8771     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8772        MOVE ER-2337             TO EMI-ERROR
  8773        MOVE -1                  TO CMAINTL
  8774        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8775        GO TO 8200-SEND-DATAONLY.
  8776
  8777     IF EIBAID = DFHPF1
  8778        MOVE '0'                TO PI-EDIT-SW
  8779        IF PI-PRIMARY-BROWSE
  8780           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8781        ELSE
  8782           IF PI-PRIMARY-WITH-SELECT
  8783              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8784           ELSE
  8785              IF PI-FILE-BROWSE
  8786                 GO TO 4300-BROWSE-FILE-FORWARD
  8787              ELSE
  8788                 IF PI-CSR-BROWSE
  8789                    GO TO 4200-BROWSE-CSR-FORWARD
  8790                 ELSE
  8791                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8792
  8793     IF EIBAID = DFHPF2
  8794        MOVE '0'                TO PI-EDIT-SW
  8795        IF PI-PRIMARY-BROWSE
  8796           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8797        ELSE
  8798           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 162
* EL6311.cbl
  8799              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8800           ELSE
  8801              IF PI-FILE-BROWSE
  8802                 GO TO 4800-BROWSE-FILE-BACKWARD
  8803              ELSE
  8804                 IF PI-CSR-BROWSE
  8805                    GO TO 4900-BROWSE-CSR-BACKWARD
  8806                 ELSE
  8807                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8808
  8809     IF EIBAID = DFHPF3
  8810        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8811        MOVE XCTL-EL127         TO PGM-NAME
  8812        GO TO 9300-XCTL.
  8813
  8814     IF (EIBAID = DFHPF15 OR DFHPF17)
  8815        AND (CSR-EDIT-SESSION)
  8816*       AND (FATAL-OR-UNFORCED)
  8817        AND (FATAL-ERRORS)
  8818        MOVE ER-1819             TO EMI-ERROR
  8819        MOVE -1                  TO CMAINTL
  8820        MOVE AL-UANON            TO CMAINTA
  8821        PERFORM 9900-ERROR-FORMAT
  8822                                 THRU 9900-EXIT
  8823        GO TO 8200-SEND-DATAONLY
  8824     END-IF
  8825     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8826       AND (CSR-EDIT-SESSION)
  8827        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8828        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8829        IF (RESP-NORMAL)
  8830           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8831              AM-CONTROL-PRIMARY (1:20))
  8832            IF AM-NAME NOT GREATER THAN SPACES OR
  8833               AM-ADDRS NOT GREATER THAN SPACES  OR
  8834               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8835               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8836               AM-ZIP NOT GREATER THAN SPACES
  8837               MOVE ER-3834             TO EMI-ERROR
  8838               MOVE -1                  TO BMAINTL
  8839               MOVE AL-UANON            TO BMAINTA
  8840               PERFORM 9900-ERROR-FORMAT
  8841                                 THRU 9900-EXIT
  8842               GO TO 8200-SEND-DATAONLY
  8843            END-IF
  8844        ELSE
  8845           MOVE ER-1609             TO EMI-ERROR
  8846           MOVE -1                  TO BMAINTL
  8847           MOVE AL-UANON            TO BMAINTA
  8848           PERFORM 9900-ERROR-FORMAT
  8849                                THRU 9900-EXIT
  8850           GO TO 8200-SEND-DATAONLY
  8851        END-IF
  8852
  8853        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8854        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8855        IF (ERMAIL-FOUND)
  8856            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 163
* EL6311.cbl
  8857               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8858               MA-CITY NOT GREATER THAN SPACES OR
  8859               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8860               MA-ZIP-CODE NOT GREATER THAN SPACES
  8861               MOVE ER-3835             TO EMI-ERROR
  8862               MOVE -1                  TO BMAINTL
  8863               MOVE AL-UANON            TO BMAINTA
  8864               PERFORM 9900-ERROR-FORMAT
  8865                                 THRU 9900-EXIT
  8866               GO TO 8200-SEND-DATAONLY
  8867            END-IF
  8868        ELSE
  8869           MOVE ER-3000             TO EMI-ERROR
  8870           MOVE -1                  TO BMAINTL
  8871           MOVE AL-UANON            TO BMAINTA
  8872           PERFORM 9900-ERROR-FORMAT
  8873                                THRU 9900-EXIT
  8874           GO TO 8200-SEND-DATAONLY
  8875        END-IF
  8876
  8877     END-IF
  8878     IF (EIBAID = DFHPF15 OR DFHPF17)
  8879        AND (CSR-EDIT-SESSION)
  8880        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8881        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8882        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8883        MOVE PI-SV-STATE         TO PI-STATE
  8884        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8885        MOVE CCERTNOI            TO PI-CERT-PRIME
  8886        MOVE CSUFIXI             TO PI-CERT-SFX
  8887        MOVE CEFFDTI             TO DEEDIT-FIELD
  8888        PERFORM 8600-DEEDIT
  8889        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8890        MOVE '4'                 TO DC-OPTION-CODE
  8891        PERFORM 9700-DATE-LINK
  8892        IF DATE-CONVERSION-ERROR
  8893           MOVE ER-0348          TO EMI-ERROR
  8894           MOVE -1               TO CEFFDTL
  8895           MOVE AL-UABON         TO CEFFDTA
  8896           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8897           GO TO 8200-SEND-DATAONLY
  8898        ELSE
  8899           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8900           PERFORM 6000-CREATE-TEMP-STORAGE
  8901                                 THRU 6000-EXIT
  8902           IF EIBAID = DFHPF17
  8903               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8904                                  THRU 6400-EXIT
  8905               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8906                                 '2' AND '3' AND '4'
  8907                  MOVE ER-3831     TO  EMI-ERROR
  8908                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8909                  GO TO 8200-SEND-DATAONLY
  8910               END-IF
  8911               MOVE 'Y'          TO PI-CLM-RESC-IND
  8912           ELSE
  8913               MOVE 'N'          TO PI-CLM-RESC-IND
  8914           END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 164
* EL6311.cbl
  8915           MOVE XCTL-EL6316      TO PGM-NAME
  8916           MOVE '2'              TO PI-ISS-CAN-SW
  8917           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8918           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8919           GO TO 9300-XCTL
  8920        END-IF
  8921     END-IF
  8922
  8923     IF EIBAID = DFHPF4
  8924        MOVE '0'                TO PI-EDIT-SW
  8925        IF PI-DISPLAY-ORIGINAL-BATCH
  8926           NEXT SENTENCE
  8927        ELSE
  8928           GO TO 7200-DISPLAY-BATCHES.
  8929
  8930     IF EIBAID = DFHPF5
  8931        MOVE ER-0029                TO EMI-ERROR
  8932        MOVE -1                     TO BPFENTRL
  8933        MOVE AL-UNBON               TO BPFENTRA
  8934        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8935        GO TO 8200-SEND-DATAONLY.
  8936*        MOVE '0'                TO PI-EDIT-SW
  8937*        IF PI-DISPLAY-ORIGINAL-BATCH
  8938*           NEXT SENTENCE
  8939*        ELSE
  8940*           MOVE EL631B              TO PI-MAP-NAME
  8941*           MOVE LOW-VALUES          TO EL631BI
  8942*           MOVE 'A'                 TO BMAINTO
  8943*           MOVE AL-UANON            TO BMAINTA
  8944*           MOVE -1                  TO BMAINTL
  8945*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8946*           GO TO 8100-SEND-INITIAL-MAP.
  8947
  8948     IF EIBAID = DFHPF6
  8949        MOVE ER-0029                TO EMI-ERROR
  8950        MOVE -1                     TO BPFENTRL
  8951        MOVE AL-UNBON               TO BPFENTRA
  8952        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8953        GO TO 8200-SEND-DATAONLY.
  8954*        MOVE '0'                TO PI-EDIT-SW
  8955*        IF PI-DISPLAY-ORIGINAL-BATCH
  8956*           NEXT SENTENCE
  8957*        ELSE
  8958*           MOVE EL631C              TO PI-MAP-NAME
  8959*           MOVE LOW-VALUES          TO EL631CI
  8960*           MOVE 'A'                 TO CMAINTO
  8961*           MOVE AL-UANON            TO CMAINTA
  8962*           MOVE -1                  TO CMAINTL
  8963*           MOVE '6'                 TO PI-MAINT-FUNCTION
  8964*           GO TO 8100-SEND-INITIAL-MAP.
  8965
  8966     IF EIBAID = DFHPF7
  8967        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8968        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8969        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8970        MOVE PI-SV-STATE            TO PI-STATE
  8971        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8972        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 165
* EL6311.cbl
  8973        MOVE CSUFIXI                TO PI-CERT-SFX
  8974        MOVE CEFFDTI                TO DEEDIT-FIELD
  8975        PERFORM 8600-DEEDIT
  8976        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8977        MOVE '4'                    TO DC-OPTION-CODE
  8978        PERFORM 9700-DATE-LINK
  8979        IF DATE-CONVERSION-ERROR
  8980           MOVE ER-0348            TO EMI-ERROR
  8981           MOVE -1                  TO BEFFDTL
  8982           MOVE AL-UABON            TO BEFFDTA
  8983           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8984           GO TO 8200-SEND-DATAONLY
  8985        ELSE
  8986           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8987           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8988           MOVE XCTL-EL1273        TO PGM-NAME
  8989           GO TO 9300-XCTL.
  8990
  8991     IF EIBAID = DFHPF8
  8992        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8993        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8994        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8995        MOVE PI-SV-STATE            TO PI-STATE
  8996        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8997        MOVE CCERTNOI               TO PI-CERT-PRIME
  8998        MOVE CSUFIXI                TO PI-CERT-SFX
  8999        MOVE CEFFDTI                TO DEEDIT-FIELD
  9000        PERFORM 8600-DEEDIT
  9001        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9002        MOVE '4'                    TO DC-OPTION-CODE
  9003        PERFORM 9700-DATE-LINK
  9004        IF DATE-CONVERSION-ERROR
  9005           MOVE ER-0348             TO EMI-ERROR
  9006           MOVE -1                  TO BEFFDTL
  9007           MOVE AL-UABON            TO BEFFDTA
  9008           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9009           GO TO 8200-SEND-DATAONLY
  9010        ELSE
  9011           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9012           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9013           IF PI-COMPANY-ID = 'DMD'
  9014               MOVE XCTL-EL401DMD      TO PGM-NAME
  9015             ELSE
  9016               MOVE XCTL-EL1279        TO PGM-NAME
  9017           END-IF
  9018           GO TO 9300-XCTL.
  9019
  9020     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9021        MOVE XCTL-EL6312     TO PGM-NAME
  9022
  9023* EXEC CICS XCTL
  9024*           PROGRAM  (PGM-NAME)
  9025*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9026*           LENGTH   (WS-COMM-LENGTH)
  9027*       END-EXEC
  9028*    MOVE '.$C                   %   #00008968' TO DFHEIV0
  9029     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9030     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 166
* EL6311.cbl
  9031     MOVE X'2020233030303038393638' TO DFHEIV0(25:11)
  9032     CALL 'kxdfhei1' USING DFHEIV0,
  9033           PGM-NAME,
  9034           PROGRAM-INTERFACE-BLOCK,
  9035           WS-COMM-LENGTH,
  9036           DFHEIV99
  9037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9038     ELSE
  9039        MOVE '0'                 TO  PI-EDIT-SW.
  9040
  9041     IF EIBAID = DFHPF10
  9042         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9043         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9044         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9045         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9046                                    PI-1042-WA
  9047         MOVE 4                  TO PI-689-DATA-SOURCE
  9048         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9049         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9050         MOVE PI-SV-STATE        TO PI-689-STATE
  9051         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9052         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9053         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9054         MOVE PI-PB-ALT-CHG-SEQ-NO
  9055                                 TO PI-689-ALT-SEQ-NO
  9056         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9057         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9058         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9059         MOVE +0                 TO PI-689-CONTROL
  9060         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9061                                    PI-689-EXP-DATE
  9062                                    PI-689-RESP-PERSON
  9063                                    PI-689-TYPE
  9064                                    PI-689-FOLLOW-UP-EDIT
  9065                                    PI-689-RESEND1-EDIT
  9066                                    PI-689-SEQ-EDIT
  9067                                    PI-689-BCSEQ-EDIT
  9068                                    PI-689-LBL-OVERRIDE
  9069         MOVE W-LETTER-COMMUNICATION-AREAS
  9070                                 TO PI-PROGRAM-WORK-AREA
  9071         MOVE XCTL-EL689         TO PGM-NAME
  9072         GO TO 9300-XCTL.
  9073
  9074     IF  EIBAID = DFHPF16
  9075         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9076         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9077         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9078                                    PI-1042-WA
  9079         MOVE 4                  TO PI-689-DATA-SOURCE
  9080         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9081         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9082         MOVE PI-SV-STATE        TO PI-689-STATE
  9083         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9084         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9085         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9086         MOVE PI-PB-ALT-CHG-SEQ-NO
  9087                                 TO PI-689-ALT-SEQ-NO
  9088         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 167
* EL6311.cbl
  9089         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9090         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9091         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9092         MOVE W-LETTER-COMMUNICATION-AREAS
  9093                                 TO PI-PROGRAM-WORK-AREA
  9094         MOVE XCTL-EL690         TO PGM-NAME
  9095         GO TO 9300-XCTL.
  9096     IF (EIBAID = DFHPF13)
  9097        if (not fatal-errors)
  9098           and (not unforced-errors)
  9099           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9100           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9101           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9102           MOVE PI-SV-STATE      TO PI-STATE
  9103           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9104           MOVE CCERTNOI         TO PI-CERT-PRIME
  9105           MOVE CSUFIXI          TO PI-CERT-SFX
  9106           MOVE CEFFDTI          TO DEEDIT-FIELD
  9107           PERFORM 8600-DEEDIT
  9108           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9109           MOVE '4'              TO DC-OPTION-CODE
  9110           PERFORM 9700-DATE-LINK
  9111           IF DATE-CONVERSION-ERROR
  9112              MOVE ER-0348       TO EMI-ERROR
  9113              MOVE -1            TO CEFFDTL
  9114              MOVE AL-UABON      TO CEFFDTA
  9115              PERFORM 9900-ERROR-FORMAT
  9116                                 THRU 9900-EXIT
  9117              GO TO 8200-SEND-DATAONLY
  9118           ELSE
  9119              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9120              MOVE AL-UANON      TO CEFFDTA
  9121              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9122              PERFORM 6000-CREATE-TEMP-STORAGE
  9123                                 THRU 6000-EXIT
  9124              MOVE XCTL-EL677    TO PGM-NAME
  9125              GO TO 9300-XCTL
  9126           end-if
  9127        else
  9128           MOVE ER-3444          TO EMI-ERROR
  9129           MOVE -1               TO CPFENTRL
  9130           MOVE AL-UNBON         TO CPFENTRA
  9131           PERFORM 9900-ERROR-FORMAT
  9132                                 THRU 9900-EXIT
  9133           GO TO 8200-SEND-DATAONLY
  9134        end-if
  9135     end-if
  9136
  9137     IF EIBAID = DFHPF14
  9138        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9139        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9140        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9141        MOVE PI-SV-STATE            TO PI-CR-STATE
  9142        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9143        MOVE SPACE                  TO PI-EDIT-SW
  9144        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9145        MOVE XCTL-EL650             TO PGM-NAME
  9146        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 168
* EL6311.cbl
  9147
  9148     IF EIBAID = DFHENTER OR DFHPF11
  9149        GO TO 2000-CANCEL-MAINLINE.
  9150
  9151     MOVE ER-0029                TO EMI-ERROR.
  9152     MOVE -1                     TO CPFENTRL.
  9153     MOVE AL-UNBON               TO CPFENTRA.
  9154     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9155     GO TO 8200-SEND-DATAONLY.
  9156
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 169
* EL6311.cbl
  9158
  9159******************************************************************
  9160*                                                                *
  9161*      BATCH SCREEN PF KEY CHECKING                              *
  9162*                                                                *
  9163******************************************************************
  9164
  9165******************************************************************
  9166*                                                                *
  9167*      PF KEY FUNCTIONS:                                         *
  9168*                                                                *
  9169*      PF1 = BROWSE FORWARD                                      *
  9170*      PF2 = BROWSE BACKWARD                                     *
  9171*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9172*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9173*                                                                *
  9174*                                                                *
  9175******************************************************************
  9176
  9177 0500-CHECK-BATCH-PF-KEYS.
  9178     IF EIBAID = DFHPF1
  9179        MOVE '0'                TO PI-EDIT-SW
  9180        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9181           GO TO 5000-BROWSE-BATCH-HEADERS
  9182        ELSE
  9183           IF PI-GOOD-BROWSE
  9184              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9185                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9186              ELSE
  9187                 IF PI-FILE-BROWSE
  9188                    GO TO 4300-BROWSE-FILE-FORWARD
  9189                 ELSE
  9190                    IF PI-CSR-BROWSE
  9191                       GO TO 4200-BROWSE-CSR-FORWARD
  9192                    ELSE
  9193                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9194           ELSE
  9195              GO TO 0800-BROWSE-ERROR.
  9196
  9197     IF EIBAID = DFHPF2
  9198        MOVE '0'                TO PI-EDIT-SW
  9199        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9200           GO TO 5500-BROWSE-BATCH-BACKWARD
  9201        ELSE
  9202           IF PI-GOOD-BROWSE
  9203              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9204                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9205              ELSE
  9206                 IF PI-FILE-BROWSE
  9207                    GO TO 4800-BROWSE-FILE-BACKWARD
  9208                 ELSE
  9209                    IF PI-CSR-BROWSE
  9210                       GO TO 4900-BROWSE-CSR-BACKWARD
  9211                    ELSE
  9212                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9213           ELSE
  9214              GO TO 0800-BROWSE-ERROR.
  9215
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 170
* EL6311.cbl
  9216     IF EIBAID = DFHPF3
  9217        GO TO 3000-BATCH-MAINLINE.
  9218
  9219     IF  EIBAID = DFHPF4
  9220        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9221        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9222        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9223        MOVE PI-SV-STATE            TO PI-CR-STATE
  9224        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9225                                       PI-CR-FIN-RESP
  9226        MOVE 'A'                    TO PI-CR-TYPE
  9227        MOVE SPACE                  TO PI-EDIT-SW
  9228        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9229        MOVE XCTL-EL640             TO PGM-NAME
  9230        GO TO 9300-XCTL.
  9231
  9232     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9233       AND
  9234        (EIBAID = DFHENTER)
  9235           GO TO 3500-EDIT-BATCH-DATA.
  9236
  9237     IF EIBAID = DFHENTER
  9238        GO TO 3500-EDIT-BATCH-DATA.
  9239
  9240     MOVE ER-0029             TO EMI-ERROR.
  9241     MOVE -1                  TO DPFENTRL.
  9242     MOVE AL-UNBON            TO DPFENTRA.
  9243     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9244     GO TO 8200-SEND-DATAONLY.
  9245
  9246 0800-BROWSE-ERROR.
  9247     MOVE ER-2258                TO EMI-ERROR.
  9248     MOVE -1                     TO DPFENTRL.
  9249     MOVE AL-UNBON               TO DPFENTRA.
  9250     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9251     GO TO 8200-SEND-DATAONLY.
  9252
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 171
* EL6311.cbl
  9254
  9255******************************************************************
  9256*                                                                *
  9257*                I S S U E   M A I N L I N E                     *
  9258*                                                                *
  9259******************************************************************
  9260
  9261 1000-ISSUE-MAINLINE.
  9262     IF PI-DISPLAY-ORIGINAL-BATCH
  9263        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9264           MOVE ER-0023             TO EMI-ERROR
  9265           MOVE -1                  TO BMAINTL
  9266           MOVE AL-UABON            TO BMAINTA
  9267           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9268           GO TO 8200-SEND-DATAONLY
  9269        ELSE
  9270           NEXT SENTENCE
  9271     ELSE
  9272        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9273           MOVE ER-0023             TO EMI-ERROR
  9274           MOVE -1                  TO BMAINTL
  9275           MOVE AL-UABON            TO BMAINTA
  9276           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9277           GO TO 8200-SEND-DATAONLY.
  9278
  9279     IF BMAINTI = 'S'
  9280        GO TO 1100-SHOW-REQUEST.
  9281
  9282     IF NOT MODIFY-CAP
  9283         MOVE 'UPDATE'       TO SM-READ
  9284         PERFORM 9995-SECURITY-VIOLATION
  9285         MOVE ER-0070        TO EMI-ERROR
  9286         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9287         GO TO 8100-SEND-INITIAL-MAP.
  9288
  9289     IF BMAINTL GREATER THAN ZEROS
  9290        IF PI-PF5-FUNCTION
  9291           IF BMAINTI NOT = 'A'
  9292              MOVE AL-UABON  TO BMAINTA
  9293              MOVE -1        TO BMAINTL
  9294              MOVE ER-2260   TO EMI-ERROR
  9295              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9296              GO TO 8200-SEND-DATAONLY.
  9297
  9298     IF BCERTNOL = ZEROS
  9299       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9300         NEXT SENTENCE
  9301     ELSE
  9302         IF BCERTNOL NOT = ZEROS
  9303             MOVE AL-UANON       TO BCERTNOA
  9304         ELSE
  9305             MOVE -1             TO BCERTNOL
  9306             MOVE  1             TO SET-CURSOR-SW
  9307             MOVE ER-2218        TO EMI-ERROR
  9308             MOVE AL-UABON       TO BCERTNOA
  9309             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9310
  9311     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 172
* EL6311.cbl
  9312         MOVE AL-UANON       TO BSUFIXA
  9313     ELSE
  9314         MOVE AL-SANOF       TO BSUFIXA.
  9315
  9316     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9317        NEXT SENTENCE
  9318     ELSE
  9319        IF BEFFDTL NOT = ZEROS
  9320           MOVE AL-UNNON             TO BEFFDTA
  9321           MOVE BEFFDTI              TO DEEDIT-FIELD
  9322           PERFORM 8600-DEEDIT
  9323           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9324           MOVE 4                    TO DC-OPTION-CODE
  9325           PERFORM 9700-DATE-LINK
  9326           IF NO-CONVERSION-ERROR
  9327              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9328              ELSE
  9329              MOVE -1                TO BEFFDTL
  9330              MOVE  1                TO SET-CURSOR-SW
  9331              MOVE ER-2226           TO EMI-ERROR
  9332              MOVE AL-UNBON          TO BEFFDTA
  9333              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9334           ELSE
  9335              MOVE -1                TO BEFFDTL
  9336              MOVE  1                TO SET-CURSOR-SW
  9337              MOVE ER-2220           TO EMI-ERROR
  9338              MOVE AL-UNBON          TO BEFFDTA
  9339              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9340
  9341     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9342
  9343     IF BCERTNOL NOT = ZEROS
  9344        MOVE BCERTNOI                TO WS-NEW-PRIME
  9345     ELSE
  9346        MOVE SPACES                  TO WS-NEW-PRIME.
  9347
  9348     IF BSUFIXL NOT = ZEROS
  9349        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9350     ELSE
  9351        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9352
  9353     IF BEFFDTL NOT = ZEROS
  9354        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9355     ELSE
  9356        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9357
  9358     IF BMAINTI = 'A' OR 'K' OR 'S'
  9359        NEXT SENTENCE
  9360     ELSE
  9361        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9362        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9363           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9364           WS-PB-RECORD-TYPE NOT = '1'
  9365           IF BMAINTI = 'C'
  9366               MOVE ER-2287          TO EMI-ERROR
  9367               MOVE -1               TO BCERTNOL
  9368               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9369               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 173
* EL6311.cbl
  9370               GO TO 8200-SEND-DATAONLY
  9371             ELSE
  9372               MOVE ER-2260          TO EMI-ERROR
  9373               MOVE -1               TO BCERTNOL
  9374               MOVE AL-UABON         TO BCERTNOA
  9375               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9376               GO TO 8200-SEND-DATAONLY.
  9377
  9378     IF BMAINTI = 'D'
  9379         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9380
  9381*    IF BMICRNOL  NOT =  ZEROS
  9382*        IF BMICRNOI  NUMERIC
  9383*            MOVE AL-UNNON       TO  BMICRNOA
  9384*        ELSE
  9385*            MOVE -1             TO  BMICRNOL
  9386*            MOVE 1              TO  SET-CURSOR-SW
  9387*            MOVE AL-UNBON       TO  BMICRNOA
  9388*            MOVE ER-2701        TO  EMI-ERROR
  9389*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9390     IF BVINL NOT = ZEROS
  9391        MOVE AL-UANON            TO BVINA
  9392     END-IF
  9393     IF B1STNML NOT = ZEROS
  9394         MOVE AL-UANON                TO B1STNMA.
  9395
  9396     IF BINITL  NOT = ZEROS
  9397        MOVE AL-UANON                TO BINITA.
  9398
  9399     IF BSEXL NOT = ZEROS
  9400        IF BSEXI = 'M' OR 'F'
  9401           MOVE AL-UANON             TO BSEXA
  9402        ELSE
  9403           MOVE -1               TO BSEXL
  9404           MOVE ER-2629          TO EMI-ERROR
  9405           MOVE AL-UABON         TO BSEXA
  9406           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9407
  9408     IF BAGEL NOT = ZEROS
  9409         IF BAGEI NUMERIC
  9410             MOVE BAGEI              TO WS-BAGE
  9411             MOVE AL-UNNON           TO BAGEA
  9412         ELSE
  9413             MOVE -1                 TO BAGEL
  9414             MOVE  1                 TO SET-CURSOR-SW
  9415             MOVE ER-2223            TO EMI-ERROR
  9416             MOVE AL-UNBON           TO BAGEA
  9417             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9418
  9419     IF BLSTNML NOT = ZERO  OR
  9420        B1STNML NOT = ZERO  OR
  9421        BINITL NOT = ZERO
  9422         IF BAGEL = ZEROS
  9423             MOVE -1                 TO BAGEL
  9424             MOVE  1                 TO SET-CURSOR-SW
  9425             MOVE ER-3269            TO EMI-ERROR
  9426             MOVE AL-UNBON           TO BAGEA
  9427             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 174
* EL6311.cbl
  9428         END-IF
  9429     END-IF.
  9430
  9431     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9432
  9433     IF (BBIRTHL GREATER THAN +0) AND
  9434        (BBIRTHI NOT EQUAL SPACES)
  9435        NEXT SENTENCE
  9436     ELSE
  9437        GO TO 1010-CHECK-AGE.
  9438
  9439     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9440     PERFORM 8600-DEEDIT.
  9441     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9442     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9443     MOVE AL-UNNON               TO BBIRTHA.
  9444     MOVE '4'                    TO DC-OPTION-CODE.
  9445     PERFORM 9700-DATE-LINK.
  9446     IF DATE-CONVERSION-ERROR
  9447        MOVE -1                  TO BBIRTHL
  9448        MOVE  1                  TO SET-CURSOR-SW
  9449        MOVE ER-2228             TO EMI-ERROR
  9450        MOVE AL-UNBON            TO BBIRTHA
  9451        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9452        GO TO 1010-CHECK-AGE.
  9453
  9454     IF (NO-CONVERSION-ERROR) AND
  9455        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9456        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9457        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9458        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9459                                    WS-CONVERTED-BIRTH
  9460        MOVE AL-UANON            TO BBIRTHA
  9461     ELSE
  9462        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9463        MOVE AL-UANON            TO BBIRTHA.
  9464
  9465 1010-CHECK-AGE.
  9466
  9467*    IF BAGEL = ZERO
  9468*       IF BBIRTHL GREATER THAN ZERO
  9469*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9470
  9471     IF B1STPMTL NOT = ZEROS
  9472        IF B1STPMTI = SPACES
  9473           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9474        ELSE
  9475           MOVE B1STPMTI             TO DEEDIT-FIELD
  9476           PERFORM 8600-DEEDIT
  9477           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9478           MOVE AL-UNNON             TO B1STPMTA
  9479           MOVE 4                    TO DC-OPTION-CODE
  9480           PERFORM 9700-DATE-LINK
  9481           IF NO-CONVERSION-ERROR
  9482              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9483              MOVE AL-UANON          TO B1STPMTA
  9484           ELSE
  9485              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 175
* EL6311.cbl
  9486              MOVE  1                TO SET-CURSOR-SW
  9487              MOVE ER-2200           TO EMI-ERROR
  9488              MOVE AL-UNBON          TO B1STPMTA
  9489              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9490
  9491     IF BDAYSL NOT = ZEROS
  9492         IF BDAYSI NUMERIC
  9493             MOVE AL-UNNON           TO BDAYSA
  9494         ELSE
  9495             MOVE -1                 TO BDAYSL
  9496             MOVE ER-2530            TO EMI-ERROR
  9497             MOVE AL-UNBON           TO BDAYSA
  9498             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9499
  9500     IF BLNTRML NOT = ZEROS
  9501         IF BLNTRMI NUMERIC
  9502             MOVE AL-UNNON       TO BLNTRMA
  9503         ELSE
  9504             MOVE -1             TO BLNTRML
  9505             MOVE ER-2533        TO EMI-ERROR
  9506             MOVE AL-UNBON       TO BLNTRMA
  9507             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9508
  9509**   IF PI-COMPANY-ID = 'DMD'
  9510     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9511        NEXT SENTENCE
  9512     ELSE
  9513         IF BLNOFCRL NOT = ZEROS
  9514            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9515            IF LOAN-OFFICER-FOUND
  9516                MOVE AL-UANON        TO BLNOFCRA
  9517             ELSE
  9518                 MOVE SPACE          TO WS-LOAN-OFFICER
  9519                 MOVE -1             TO BLNOFCRL
  9520                 MOVE  1             TO SET-CURSOR-SW
  9521                 MOVE ER-3006        TO EMI-ERROR
  9522                 MOVE AL-UNBON       TO BLNOFCRA
  9523                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9524
  9525     IF BFREQL NOT = ZEROS
  9526         IF BFREQI NUMERIC
  9527             MOVE AL-UNNON       TO BFREQA
  9528         ELSE
  9529             MOVE -1             TO BFREQL
  9530             MOVE  1             TO SET-CURSOR-SW
  9531             MOVE ER-2223        TO EMI-ERROR
  9532             MOVE AL-UNBON       TO BFREQA
  9533             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9534
  9535     IF BMODEL NOT = ZEROS
  9536         MOVE BMODEI             TO WS-MODE-CODE
  9537                                    PI-BMODE
  9538         IF WS-MODE-CODE-VALID
  9539             MOVE AL-UANON       TO BMODEA
  9540         ELSE
  9541             MOVE -1             TO BMODEL
  9542             MOVE ER-2591        TO EMI-ERROR
  9543             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 176
* EL6311.cbl
  9544             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9545
  9546     IF BPMTSL NOT = ZEROS
  9547         IF BPMTSI NUMERIC
  9548             MOVE AL-UNNON           TO BPMTSA
  9549             MOVE BPMTSI             TO PI-BPMTS
  9550         ELSE
  9551             MOVE -1                 TO BPMTSL
  9552             MOVE ER-2592            TO EMI-ERROR
  9553             MOVE AL-UNBON           TO BPMTSA
  9554             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9555
  9556     IF BPMTAMTL NOT = ZEROS
  9557
  9558* EXEC CICS BIF DEEDIT
  9559*            FIELD  (BPMTAMTI)
  9560*            LENGTH (9)
  9561*       END-EXEC
  9562     MOVE 9
  9563       TO DFHEIV11
  9564*    MOVE '@"L                   #   #00009492' TO DFHEIV0
  9565     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9566     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9567     MOVE X'2020233030303039343932' TO DFHEIV0(25:11)
  9568     CALL 'kxdfhei1' USING DFHEIV0,
  9569           BPMTAMTI,
  9570           DFHEIV11
  9571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9572        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9573*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9574*        PERFORM 8600-DEEDIT
  9575*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9576
  9577*    IF BAPRL NOT = ZEROS
  9578*        EXEC CICS BIF DEEDIT
  9579*            FIELD  (BAPRI)
  9580*            LENGTH (7)
  9581*        END-EXEC
  9582*        MOVE BAPRI              TO WS-BAPR.
  9583
  9584     IF BAPRL > 0
  9585        MOVE +0                  TO  WS-BAPR
  9586        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9587           (WS-SUB > 7)
  9588           OR (BAPRI (WS-SUB:1) NUMERIC)
  9589           OR (BAPRI (WS-SUB:1) = '.')
  9590        END-PERFORM
  9591        IF WS-SUB > 7
  9592           MOVE ER-2471       TO EMI-ERROR
  9593           MOVE -1            TO BAPRL
  9594           MOVE AL-UNBON      TO BAPRA
  9595           PERFORM 9900-ERROR-FORMAT
  9596                                 THRU 9900-EXIT
  9597        ELSE
  9598           IF BAPRI (WS-SUB:1) NUMERIC
  9599              MOVE WS-SUB           TO WS-BEG
  9600              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9601                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 177
* EL6311.cbl
  9602                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9603              END-PERFORM
  9604              COMPUTE WS-END = WS-SUB - WS-BEG
  9605              MOVE BAPRI (WS-BEG:WS-END)
  9606                                 TO WS-APR-WHOLE-NUM
  9607           END-IF
  9608           IF BAPRI (WS-SUB:1) = '.'
  9609              COMPUTE WS-BEG = WS-SUB + 1
  9610              IF (WS-BEG < 8)
  9611                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9612                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9613                    (WS-SUB > 7)
  9614                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9615                 END-PERFORM
  9616                 COMPUTE WS-END = WS-SUB - WS-BEG
  9617                 MOVE BAPRI (WS-BEG:WS-END)
  9618                                 TO WS-APR-DEC (1:WS-END)
  9619              END-IF
  9620           END-IF
  9621           MOVE AL-UNNON      TO BAPRA
  9622           MOVE WS-BAPR       TO BAPRO
  9623        END-IF
  9624     END-IF
  9625*     IF BAPRL NOT = ZEROS
  9626*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9627*        PERFORM 8600-DEEDIT
  9628*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9629
  9630     IF BLIVESL NOT = ZEROS
  9631        MOVE BLIVESI             TO DEEDIT-FIELD
  9632        PERFORM 8600-DEEDIT
  9633        IF DEEDIT-FIELD-V0 NUMERIC
  9634           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9635           MOVE AL-UNNON         TO BLIVESA
  9636        ELSE
  9637           MOVE -1               TO BLIVESL
  9638           MOVE AL-UNBON         TO BLIVESA
  9639           MOVE ER-2223          TO EMI-ERROR
  9640           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9641
  9642*DMD CUSTOM CODING*************START
  9643*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9644     IF PI-COMPANY-ID NOT = 'DMD'
  9645         MOVE ZEROS               TO BBILLEDL
  9646         GO TO 1010-EDIT-CONT.
  9647
  9648     IF BBILLEDL NOT = ZEROS
  9649        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9650        MOVE 'Y'                 TO WS-NUMERIC-SW
  9651        MOVE +1                  TO WS-CSO-SUB
  9652        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9653        IF CSO-NUMERIC-FIELD
  9654
  9655* EXEC CICS BIF DEEDIT
  9656*              FIELD  (BBILLEDI)
  9657*              LENGTH (9)
  9658*          END-EXEC
  9659     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 178
* EL6311.cbl
  9660       TO DFHEIV11
  9661*    MOVE '@"L                   #   #00009578' TO DFHEIV0
  9662     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9663     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9664     MOVE X'2020233030303039353738' TO DFHEIV0(25:11)
  9665     CALL 'kxdfhei1' USING DFHEIV0,
  9666           BBILLEDI,
  9667           DFHEIV11
  9668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9669           MOVE BBILLEDI         TO WS-BILLED
  9670           MOVE AL-UNNON         TO BBILLEDA
  9671        ELSE
  9672           MOVE -1               TO BBILLEDL
  9673           MOVE AL-UNBON         TO BBILLEDA
  9674           MOVE ER-2547          TO EMI-ERROR
  9675           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9676     ELSE
  9677        IF BMAINTI EQUAL 'A'
  9678           MOVE -1               TO BBILLEDL
  9679           MOVE AL-UNBON         TO BBILLEDA
  9680           MOVE ER-8148          TO EMI-ERROR
  9681           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9682
  9683 1010-EDIT-CONT.
  9684
  9685     IF BFORCEL  NOT = ZEROS
  9686         IF FORCE-CAP
  9687            MOVE AL-UANON            TO BFORCEA
  9688         ELSE
  9689            MOVE ER-2945             TO EMI-ERROR
  9690            MOVE AL-UABON            TO BFORCEA
  9691            MOVE -1                  TO BFORCEL
  9692            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9693
  9694     IF BENTRYL NOT = ZEROS
  9695        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9696                         'D' AND 'V' AND 'U' AND 'M'
  9697           MOVE ER-2224              TO EMI-ERROR
  9698           MOVE AL-UABON             TO BENTRYA
  9699           MOVE -1                   TO BENTRYL
  9700           MOVE  1                   TO SET-CURSOR-SW
  9701           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9702        ELSE
  9703           MOVE AL-UANON             TO BENTRYA.
  9704
  9705     IF BUNWRITL NOT = ZEROS
  9706        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9707           MOVE ER-7574              TO EMI-ERROR
  9708           MOVE AL-UABON             TO BUNWRITA
  9709           MOVE -1                   TO BUNWRITL
  9710           MOVE  1                   TO SET-CURSOR-SW
  9711           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9712        ELSE
  9713           MOVE AL-UANON             TO BUNWRITA.
  9714
  9715     IF BREINL  NOT = ZEROS
  9716         MOVE AL-UANON               TO BREINA.
  9717
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 179
* EL6311.cbl
  9718     IF BBILCDL NOT = ZEROS
  9719        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9720                             AND 'A' AND 'B' AND 'E'
  9721           MOVE ER-2225              TO EMI-ERROR
  9722           MOVE AL-UABON             TO BBILCDA
  9723           MOVE -1                   TO BBILCDL
  9724           MOVE  1                   TO SET-CURSOR-SW
  9725           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9726        ELSE
  9727           MOVE AL-UANON             TO BBILCDA.
  9728
  9729     IF BSKPCDL NOT = ZEROS
  9730         MOVE AL-UANON               TO BSKPCDA.
  9731
  9732     IF BINDGRPL NOT = ZEROS
  9733         MOVE AL-UANON               TO BINDGRPA.
  9734
  9735     IF BSIGL   NOT = ZEROS
  9736         MOVE AL-UANON               TO BSIGA.
  9737
  9738     IF BRTCLSL NOT = ZEROS
  9739         MOVE AL-UANON               TO BRTCLSA.
  9740
  9741     IF BMEMBERL NOT = ZEROS
  9742         MOVE AL-UANON               TO BMEMBERA.
  9743
  9744     MOVE +0                         TO WS-SUB1.
  9745
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 180
* EL6311.cbl
  9747
  9748******************************************************************
  9749*                                                                *
  9750*           E D I T   I S S U E   C O V E R A G E S              *
  9751*                                                                *
  9752******************************************************************
  9753
  9754 1020-EDIT-COVERAGES.
  9755     ADD +1                      TO WS-SUB1.
  9756
  9757     IF WS-SUB1 GREATER +2
  9758        GO TO 1025-EDIT-COMPLETE.
  9759
  9760     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9761       IF (BMODEL   GREATER ZERO  OR
  9762            BPMTSL   GREATER ZERO  OR
  9763            BPMTAMTL GREATER ZERO)
  9764          AND
  9765            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9766               GO TO 1021-CONT-EDIT.
  9767
  9768     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9769        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9770        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9771        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9772        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9773        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9774        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9775        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9776        NEXT SENTENCE
  9777         ELSE
  9778            GO TO 1020-EDIT-COVERAGES.
  9779
  9780 1021-CONT-EDIT.
  9781
  9782     IF BMAINTI = 'A'
  9783        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9784           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9785        ELSE
  9786           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9787           MOVE ER-7404          TO EMI-ERROR
  9788           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9789           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9790     ELSE
  9791        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9792           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9793
  9794     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9795        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9796        PERFORM 8600-DEEDIT
  9797        IF DEEDIT-FIELD-V0 NUMERIC
  9798           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9799        ELSE
  9800           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9801
  9802     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9803*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9804        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 181
* EL6311.cbl
  9805           BPMTSL  GREATER THAN ZEROS
  9806           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9807
  9808     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9809         IF BMODEL   GREATER THAN ZEROS  OR
  9810            BPMTSL   GREATER THAN ZEROS  OR
  9811            BPMTAMTL GREATER THAN ZEROS
  9812             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9813
  9814     IF BMAINTI = ('C' OR 'K')
  9815        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9816           NEXT SENTENCE
  9817        ELSE
  9818           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9819           PERFORM 8600-DEEDIT
  9820           IF DEEDIT-FIELD-V0 NUMERIC
  9821              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9822              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9823                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9824              ELSE
  9825                    MOVE ER-2241      TO EMI-ERROR
  9826                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9827                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9828                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9829           ELSE
  9830              MOVE ER-2223          TO EMI-ERROR
  9831              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9832              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9833              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9834     ELSE
  9835        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9836            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9837            PERFORM 8600-DEEDIT
  9838            IF DEEDIT-FIELD-V0      NUMERIC
  9839               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9840                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9841                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9842               ELSE
  9843                  MOVE ER-2241         TO EMI-ERROR
  9844                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9845                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9846                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9847            ELSE
  9848              MOVE ER-2223             TO EMI-ERROR
  9849              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9850              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9851              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9852        ELSE
  9853            MOVE ER-2240               TO EMI-ERROR
  9854            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9855            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9856*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9857*        IF BMODEL  GREATER THAN ZEROS  AND
  9858*           BPMTSL  GREATER THAN ZEROS
  9859*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9860
  9861     IF BBEN-LEN (WS-SUB1) = ZEROS
  9862        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 182
* EL6311.cbl
  9863           NEXT SENTENCE
  9864     ELSE
  9865        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9866           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9867
  9868* EXEC CICS BIF DEEDIT
  9869*              FIELD  (BBENI (WS-SUB1))
  9870*              LENGTH (12)
  9871*          END-EXEC
  9872     MOVE 12
  9873       TO DFHEIV11
  9874*    MOVE '@"L                   #   #00009780' TO DFHEIV0
  9875     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9876     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9877     MOVE X'2020233030303039373830' TO DFHEIV0(25:11)
  9878     CALL 'kxdfhei1' USING DFHEIV0,
  9879           BBENI(WS-SUB1),
  9880           DFHEIV11
  9881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9882           IF BBENI (WS-SUB1)  NUMERIC
  9883              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9884                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9885*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9886*          PERFORM 8600-DEEDIT
  9887*          IF DEEDIT-FIELD-V2  NUMERIC
  9888*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9889*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9890              ELSE
  9891                 MOVE ER-7632    TO EMI-ERROR
  9892                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9893                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9894                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9895           ELSE
  9896              MOVE ER-2223         TO EMI-ERROR
  9897              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9898              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9899              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9900        ELSE
  9901           MOVE ER-7632    TO EMI-ERROR
  9902           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9903           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9904           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9905
  9906     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9907        AND (BMAINTI = ('C' OR 'K'))
  9908        CONTINUE
  9909     ELSE
  9910        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9911           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9912           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9913              FOR ALL '.'
  9914           IF WS-TALLY > 1
  9915              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9916                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9917              END-PERFORM
  9918              IF A1 < 9
  9919                 ADD 3 TO A1
  9920                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 183
* EL6311.cbl
  9921              END-IF
  9922           ELSE
  9923              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9924                (A1 > 11)
  9925                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9926                  LOW-VALUES OR SPACES)
  9927              END-PERFORM
  9928              IF A1 > 1 AND < 12
  9929                 MOVE SPACES
  9930                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9931              END-IF
  9932           END-IF
  9933
  9934* EXEC CICS BIF DEEDIT
  9935*              FIELD  (BPREMI (WS-SUB1))
  9936*              LENGTH (11)
  9937*          END-EXEC
  9938     MOVE 11
  9939       TO DFHEIV11
  9940*    MOVE '@"L                   #   #00009835' TO DFHEIV0
  9941     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9942     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9943     MOVE X'2020233030303039383335' TO DFHEIV0(25:11)
  9944     CALL 'kxdfhei1' USING DFHEIV0,
  9945           BPREMI(WS-SUB1),
  9946           DFHEIV11
  9947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9948           IF BPREMI (WS-SUB1) NUMERIC
  9949              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9950                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9951*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9952*          PERFORM 8600-DEEDIT
  9953*          IF DEEDIT-FIELD-V2  NUMERIC
  9954*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9955*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9956              ELSE
  9957                 IF PI-COMPANY-ID NOT = 'DCC'
  9958                    MOVE ER-7633    TO EMI-ERROR
  9959                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9960                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9961                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9962                 END-IF
  9963              END-IF
  9964           ELSE
  9965              MOVE ER-2223         TO EMI-ERROR
  9966              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9967              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9968              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9969           END-IF
  9970        ELSE
  9971           IF PI-COMPANY-ID NOT = 'DCC'
  9972              MOVE ER-7633         TO EMI-ERROR
  9973              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9974              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9975              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9976           END-IF
  9977        END-IF
  9978     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 184
* EL6311.cbl
  9979
  9980     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9981        NEXT SENTENCE
  9982     ELSE
  9983        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9984
  9985* EXEC CICS BIF DEEDIT
  9986*           FIELD  (BCPREMI (WS-SUB1))
  9987*           LENGTH (11)
  9988*       END-EXEC
  9989     MOVE 11
  9990       TO DFHEIV11
  9991*    MOVE '@"L                   #   #00009875' TO DFHEIV0
  9992     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9993     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9994     MOVE X'2020233030303039383735' TO DFHEIV0(25:11)
  9995     CALL 'kxdfhei1' USING DFHEIV0,
  9996           BCPREMI(WS-SUB1),
  9997           DFHEIV11
  9998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9999        IF BCPREMI (WS-SUB1) NUMERIC
 10000           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10001*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10002*       PERFORM 8600-DEEDIT
 10003*       IF DEEDIT-FIELD-V2  NUMERIC
 10004*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10005        ELSE
 10006           MOVE ER-2223         TO EMI-ERROR
 10007           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10008           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10009           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10010
 10011     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10012        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10013        PERFORM 8600-DEEDIT
 10014        IF DEEDIT-FIELD-V0 NUMERIC
 10015           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10016           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10017         ELSE
 10018           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10019           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10020           MOVE ER-2223              TO EMI-ERROR
 10021           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10022
 10023     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10024        IF BEXPIRE   (WS-SUB1) = SPACES
 10025           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10026        ELSE
 10027           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10028           PERFORM 8600-DEEDIT
 10029           IF DEEDIT-FIELD-V0        NUMERIC
 10030              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10031              MOVE 4                TO DC-OPTION-CODE
 10032              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10033              PERFORM 9700-DATE-LINK
 10034              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10035                                                        (WS-SUB1)
 10036              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 185
* EL6311.cbl
 10037                 NEXT SENTENCE
 10038              ELSE
 10039                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10040                 MOVE ER-2531    TO EMI-ERROR
 10041                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10042                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10043           ELSE
 10044             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10045             MOVE ER-2532        TO EMI-ERROR
 10046             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10047             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10048
 10049     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10050        NEXT SENTENCE
 10051     ELSE
 10052
 10053* EXEC CICS BIF DEEDIT
 10054*           FIELD  (BALT-BENI (WS-SUB1))
 10055*           LENGTH (12)
 10056*       END-EXEC
 10057     MOVE 12
 10058       TO DFHEIV11
 10059*    MOVE '@"L                   #   #00009932' TO DFHEIV0
 10060     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10061     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10062     MOVE X'2020233030303039393332' TO DFHEIV0(25:11)
 10063     CALL 'kxdfhei1' USING DFHEIV0,
 10064           BALT-BENI(WS-SUB1),
 10065           DFHEIV11
 10066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10067        IF BALT-BENI (WS-SUB1) NUMERIC
 10068           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10069*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10070*       PERFORM 8600-DEEDIT
 10071*       IF DEEDIT-FIELD-V0 NUMERIC
 10072*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10073        ELSE
 10074           MOVE ER-2223         TO EMI-ERROR
 10075           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10076           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10077           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10078
 10079     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10080        NEXT SENTENCE
 10081     ELSE
 10082
 10083* EXEC CICS BIF DEEDIT
 10084*           FIELD  (BALT-PREMI (WS-SUB1))
 10085*           LENGTH (11)
 10086*       END-EXEC
 10087     MOVE 11
 10088       TO DFHEIV11
 10089*    MOVE '@"L                   #   #00009951' TO DFHEIV0
 10090     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10091     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10092     MOVE X'2020233030303039393531' TO DFHEIV0(25:11)
 10093     CALL 'kxdfhei1' USING DFHEIV0,
 10094           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 186
* EL6311.cbl
 10095           DFHEIV11
 10096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10097        IF BALT-PREMI (WS-SUB1) NUMERIC
 10098           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10099*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10100*       PERFORM 8600-DEEDIT
 10101*       IF DEEDIT-FIELD-V0 NUMERIC
 10102*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10103        ELSE
 10104           MOVE ER-2223         TO EMI-ERROR
 10105           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10106           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10107           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10108
 10109      GO TO 1020-EDIT-COVERAGES.
 10110
 10111 1025-EDIT-COMPLETE.
 10112     IF PI-COMPANY-ID  =  'DMD'
 10113        MOVE LOW-VALUES             TO BNCERTI
 10114                                       BNSTATI.
 10115
 10116     IF EMI-ERROR = ZEROS
 10117         NEXT SENTENCE
 10118     ELSE
 10119         GO TO 8200-SEND-DATAONLY.
 10120
 10121     IF BMAINTI = 'A'
 10122         GO TO 1200-ADD-ISSUE-ROUTINE.
 10123
 10124     IF BMAINTI = 'C'
 10125         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10126
 10127     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10128
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 187
* EL6311.cbl
 10130
 10131 1030-EDIT-FOR-NUMERICS.
 10132     IF WS-CSO-SUB EQUAL 10
 10133        GO TO 1030-EDIT-EXIT.
 10134
 10135     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10136        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10137        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10138           ADD +1               TO WS-CSO-SUB
 10139           GO TO 1030-EDIT-FOR-NUMERICS.
 10140
 10141     MOVE 'N'                   TO WS-NUMERIC-SW.
 10142
 10143 1030-EDIT-EXIT.
 10144******************************************************************
 10145*                                                                *
 10146*                 C A L C U L A T E   A G E                      *
 10147*                                                                *
 10148******************************************************************
 10149
 10150
 10151 1095-CALC-AGE.
 10152
 10153     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10154     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10155     MOVE 1                  TO DC-OPTION-CODE.
 10156     PERFORM 9700-DATE-LINK
 10157     IF NO-CONVERSION-ERROR
 10158         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10159         MOVE WS-BAGE            TO BAGEI
 10160         MOVE +2                 TO BAGEL
 10161         MOVE AL-UNNON TO BAGEA.
 10162
 10163 1099-EXIT.
 10164     EXIT.
 10165
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 188
* EL6311.cbl
 10167
 10168******************************************************************
 10169*                                                                *
 10170*                   S H O W   I S S U E                          *
 10171*                                                                *
 10172******************************************************************
 10173
 10174 1100-SHOW-REQUEST.
 10175     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10176
 10177     IF BCERTNOL = ZEROS AND
 10178        BEFFDTL  = ZEROS
 10179        MOVE -1                  TO BMAINTL
 10180        GO TO 8200-SEND-DATAONLY.
 10181
 10182     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10183
 10184     IF BSUFIXL NOT = ZEROS
 10185        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10186     ELSE
 10187        MOVE SPACE               TO WS-NEW-SUFFIX.
 10188
 10189     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10190     PERFORM 8600-DEEDIT.
 10191     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10192     MOVE '4'                    TO DC-OPTION-CODE.
 10193     PERFORM 9700-DATE-LINK.
 10194     IF DATE-CONVERSION-ERROR
 10195        MOVE ER-0348             TO EMI-ERROR
 10196        MOVE -1                  TO BEFFDTL
 10197        MOVE AL-UABON            TO BEFFDTA
 10198        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10199        GO TO 8200-SEND-DATAONLY
 10200     ELSE
 10201        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10202        MOVE AL-UANON            TO BEFFDTA
 10203        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10204
 10205     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10206
 10207     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10208        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10209          MOVE 'Y'                    TO WS-SHOW-SW
 10210          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10211             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10212           ELSE
 10213             IF PI-FILE-BROWSE
 10214                GO TO 4300-BROWSE-FILE-FORWARD
 10215              ELSE
 10216                IF PI-CSR-BROWSE
 10217                   GO TO 4200-BROWSE-CSR-FORWARD
 10218                ELSE
 10219                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10220        ELSE
 10221           GO TO 3900-RE-DISPLAY-RECORD.
 10222
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 189
* EL6311.cbl
 10224
 10225******************************************************************
 10226*                                                                *
 10227*            A D D   I S S U E   R O U T I N E                   *
 10228*                                                                *
 10229******************************************************************
 10230
 10231***************************************************************
 10232*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10233*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10234*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10235*     4. LINK TO THE EDIT ROUTINE.                            *
 10236*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10237*     6. WRITE THE NEW ISSUE RECORD.                          *
 10238*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10239*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10240*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10241*        ELSE                                                 *
 10242*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10243***************************************************************
 10244
 10245 1200-ADD-ISSUE-ROUTINE.
 10246     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10247
 10248
 10249* EXEC CICS GETMAIN
 10250*        SET     (ADDRESS OF PENDING-BUSINESS)
 10251*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10252*    END-EXEC.
 10253*    MOVE '," L                  $   #00010106' TO DFHEIV0
 10254     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10255     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10256     MOVE X'2020233030303130313036' TO DFHEIV0(25:11)
 10257     CALL 'kxdfhei1' USING DFHEIV0,
 10258           DFHEIV20,
 10259           ERPNDB-RECORD-LENGTH,
 10260           DFHEIV99
 10261     SET ADDRESS OF PENDING-BUSINESS TO
 10262         DFHEIV20
 10263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10264
 10265
 10266
 10267* EXEC CICS HANDLE CONDITION
 10268*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10269*    END-EXEC.
 10270*    MOVE '"$I                   ! # #00010111' TO DFHEIV0
 10271     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10272     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10273     MOVE X'2320233030303130313131' TO DFHEIV0(25:11)
 10274     CALL 'kxdfhei1' USING DFHEIV0
 10275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10276
 10277
 10278     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10279     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10280     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10281
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 190
* EL6311.cbl
 10282
 10283* EXEC CICS READ
 10284*        INTO    (PENDING-BUSINESS)
 10285*        DATASET (FILE-ID-ERPNDB)
 10286*        RIDFLD  (ERPNDB-KEY)
 10287*    END-EXEC.
 10288     MOVE LENGTH OF
 10289      PENDING-BUSINESS
 10290       TO DFHEIV11
 10291*    MOVE '&"IL       E          (   #00010119' TO DFHEIV0
 10292     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10293     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10294     MOVE X'2020233030303130313139' TO DFHEIV0(25:11)
 10295     CALL 'kxdfhei1' USING DFHEIV0,
 10296           FILE-ID-ERPNDB,
 10297           PENDING-BUSINESS,
 10298           DFHEIV11,
 10299           ERPNDB-KEY,
 10300           DFHEIV99,
 10301           DFHEIV99,
 10302           DFHEIV99
 10303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10304
 10305
 10306     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10307
 10308     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10309     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10310     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10311     MOVE SPACES                 TO PENDING-BUSINESS.
 10312     MOVE 'PB'                   TO PB-RECORD-ID.
 10313     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10314     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10315     MOVE SPACES                 TO PB-CERT-SFX.
 10316     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10317     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10318                                    PB-ALT-CHG-SEQ-NO.
 10319
 10320     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10321     MOVE '1'                    TO PB-RECORD-TYPE.
 10322
 10323     IF BSUFIXL NOT = ZEROS
 10324        MOVE BSUFIXI             TO PB-CERT-SFX.
 10325
 10326     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10327
 10328     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10329     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10330
 10331     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10332                                    PB-I-LF-PREM-CALC
 10333                                    PB-I-LF-ALT-PREM-CALC
 10334                                    PB-I-LF-RATE
 10335                                    PB-I-LF-ALT-RATE
 10336                                    PB-I-LF-REI-RATE
 10337                                    PB-I-LF-ALT-REI-RATE
 10338                                    PB-I-RATE-DEV-PCT-LF
 10339                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 191
* EL6311.cbl
 10340                                    PB-I-AH-RATE
 10341                                    PB-I-AH-REI-RATE
 10342                                    PB-I-AH-RATE-TRM
 10343                                    PB-I-RATE-DEV-PCT-AH
 10344                                    PB-I-BUSINESS-TYPE
 10345                                    PB-I-LIFE-COMMISSION
 10346                                    PB-I-JOINT-COMMISSION
 10347                                    PB-I-JOINT-AGE
 10348                                    PB-I-AH-COMMISSION
 10349                                    PB-I-CURR-SEQ
 10350                                    PB-CHG-COUNT
 10351                                    PB-LF-BILLED-AMTS
 10352                                    PB-AH-BILLED-AMTS
 10353                                    PB-CALC-TOLERANCE
 10354                                    PB-I-EXTENTION-DAYS
 10355*                                   PB-I-MICROFILM-NO
 10356                                    PB-I-TERM-IN-DAYS.
 10357
 10358     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10359                                    PB-I-LF-EXPIRE-DT
 10360                                    PB-I-AH-EXPIRE-DT
 10361                                    PB-BILLED-DT
 10362                                    PB-ACCT-EFF-DT
 10363                                    PB-ACCT-EXP-DT
 10364                                    PB-I-1ST-PMT-DT.
 10365
 10366     MOVE 'X'                    TO PB-FATAL-FLAG.
 10367
 10368     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10369
 10370     IF BLSTNML GREATER THAN ZEROS
 10371         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10372
 10373*    IF BMICRNOL  GREATER  ZEROS
 10374*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10375*    ELSE
 10376*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10377     IF BVINL > ZEROS
 10378        MOVE BVINI               TO PB-I-VIN
 10379     END-IF
 10380     IF B1STNML GREATER THAN ZEROS
 10381         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10382
 10383     IF BINITL  GREATER THAN ZEROS
 10384         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10385
 10386     IF BBIRTHL GREATER THAN ZERO
 10387         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10388     ELSE
 10389         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10390
 10391     IF B1STPMTL GREATER THAN ZERO
 10392         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10393     ELSE
 10394         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10395
 10396     IF BAGEL    GREATER THAN ZEROS
 10397         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 192
* EL6311.cbl
 10398        ELSE
 10399         MOVE ZEROS              TO PB-I-AGE.
 10400
 10401     IF BSEXL    GREATER THAN ZEROS
 10402         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10403
 10404     IF BTERM-LEN (1) GREATER THAN ZEROS
 10405        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10406     ELSE
 10407        MOVE ZEROS               TO PB-I-LF-TERM.
 10408
 10409     IF BTERM-LEN (2) GREATER THAN ZEROS
 10410        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10411     ELSE
 10412        MOVE ZEROS               TO PB-I-AH-TERM.
 10413
 10414     IF BLNTRML       GREATER THAN ZEROS
 10415         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10416        ELSE
 10417         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10418
 10419     IF BFREQL        GREATER THAN ZEROS
 10420         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10421        ELSE
 10422         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10423
 10424     IF BSKPCDL       GREATER THAN ZEROS
 10425         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10426
 10427     IF BMODEL        GREATER THAN ZEROS
 10428         MOVE BMODEI             TO PB-I-TERM-TYPE
 10429                                    PI-BMODE.
 10430
 10431     IF BPMTSL        GREATER THAN ZEROS
 10432         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10433                                    PI-BPMTS
 10434        ELSE
 10435         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10436                                    PI-BPMTS.
 10437
 10438     IF BPMTAMTL      GREATER THAN ZEROS
 10439         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10440        ELSE
 10441         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10442
 10443     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10444        IF BTYPE  (1)   NOT = ZEROS
 10445           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10446                                    PI-BTYPE (1)
 10447           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10448           MOVE SPACES           TO PB-I-LF-ABBR
 10449        ELSE
 10450           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10451                                    PB-I-LF-ABBR
 10452           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10453     ELSE
 10454        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10455                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 193
* EL6311.cbl
 10456        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10457
 10458     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10459         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10460     ELSE
 10461         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10462
 10463     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10464         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10465     ELSE
 10466         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10467
 10468     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10469         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10470            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10471            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10472         ELSE
 10473            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10474*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10475*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10476         END-IF
 10477     ELSE
 10478         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10479
 10480     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10481         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10482
 10483     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10484         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10485         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10486     ELSE
 10487         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10488
 10489     IF  BALT-PREM-LEN     (2) > ZEROS
 10490         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10491     ELSE
 10492         MOVE ZEROS            TO PB-I-TOT-FEES.
 10493
 10494     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10495        IF BTYPE      (2)   NOT = ZEROS
 10496           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10497                                  PI-BTYPE (2)
 10498           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10499           MOVE SPACES         TO PB-I-AH-ABBR
 10500        ELSE
 10501           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10502                                  PB-I-AH-ABBR
 10503           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10504     ELSE
 10505        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10506                                  PB-I-AH-ABBR
 10507        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10508
 10509     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10510         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10511     ELSE
 10512         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10513
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 194
* EL6311.cbl
 10514     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10515         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10516            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10517            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10518         ELSE
 10519            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10520*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10521*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10522         END-IF
 10523     ELSE
 10524         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10525
 10526     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10527         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10528
 10529     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10530        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10531     ELSE
 10532        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10533
 10534     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10535        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10536     ELSE
 10537        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10538
 10539     IF BINDGRPL  GREATER THAN ZEROS
 10540         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10541
 10542     IF BRTCLSL   GREATER THAN ZEROS
 10543         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10544
 10545     IF BSIGL     GREATER THAN ZEROS
 10546         MOVE BSIGI              TO PB-I-SIG-SW.
 10547     IF BAPRL > ZEROS
 10548         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10549     ELSE
 10550        if pi-company-id = 'CID'
 10551           move +99.9999         to pb-i-loan-apr
 10552        else
 10553           MOVE ZEROS            TO PB-I-LOAN-APR
 10554        end-if
 10555     end-if
 10556     IF BMEMBERL  GREATER THAN ZEROS
 10557         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10558
 10559     IF BLNOFCRL  GREATER THAN ZEROS
 10560         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10561
 10562     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10563        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10564     ELSE
 10565        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10566
 10567     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10568        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10569     ELSE
 10570        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10571
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 195
* EL6311.cbl
 10572     IF BDAYSL   GREATER THAN ZEROS
 10573        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10574                                    PB-I-EXTENTION-DAYS
 10575     ELSE
 10576        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10577                                    PB-I-EXTENTION-DAYS.
 10578
 10579     IF BDAYSL GREATER THAN ZEROS
 10580        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10581
 10582     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10583        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10584           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10585
 10586     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10587        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10588           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10589
 10590     IF B1STPMTL GREATER THAN ZEROS
 10591        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10592
 10593     IF PB-EXT-DAYS-PROCESSING
 10594        IF PB-I-EXTENTION-DAYS = ZEROS
 10595           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10596
 10597     IF PB-EXPIRE-DT-PROCESSING
 10598        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10599           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10600             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10601
 10602     IF PB-1ST-PMT-DT-PROCESSING
 10603        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10604           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10605
 10606     IF BREINL GREATER THAN ZEROS
 10607        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10608
 10609     IF BENTRYL NOT = ZEROS
 10610        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10611        IF PI-COMPANY-ID = 'CID'
 10612           AND (PB-BATCH-ENTRY = 'P')
 10613           AND (PB-STATE = 'VA')
 10614           PERFORM 1500-UPDATE-ERNOTE
 10615                                 THRU 1500-EXIT
 10616        END-IF
 10617     END-IF
 10618     IF BUNWRITL NOT = ZEROS
 10619        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10620
 10621     IF BFORCEL NOT = ZEROS
 10622        MOVE BFORCEI             TO PB-FORCE-CODE.
 10623
 10624     IF BBILCDL NOT = ZEROS
 10625        MOVE BBILCDI             TO PB-RECORD-BILL.
 10626
 10627     IF BLIVESL GREATER THAN ZEROS
 10628        MOVE WS-BLIVES           TO PB-I-LIVES
 10629     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 196
* EL6311.cbl
 10630        MOVE ZEROS               TO PB-I-LIVES.
 10631
 10632     IF BBILLEDL GREATER THAN ZEROS
 10633        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10634     ELSE
 10635        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10636
 10637*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10638
 10639 1260-WRITE-PB-RECORD.
 10640     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10641                                    PB-INPUT-BY.
 10642     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10643     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10644                                    PB-INPUT-DT.
 10645
 10646     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10647     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10648                                    PB-CONTROL-BY-ORIG-BATCH.
 10649
 10650
 10651     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10652     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10653     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10654     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10655     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10656
 10657     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10658
 10659     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10660
 10661     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10662     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10663     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10664
 10665     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10666     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10667
 10668 1275-WRITE-PENDING-BUSINESS.
 10669     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10670     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10671     MOVE 'A'                    TO JP-RECORD-TYPE.
 10672     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10673
 10674
 10675* EXEC CICS HANDLE CONDITION
 10676*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10677*    END-EXEC.
 10678*    MOVE '"$%                   ! $ #00010493' TO DFHEIV0
 10679     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10680     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10681     MOVE X'2420233030303130343933' TO DFHEIV0(25:11)
 10682     CALL 'kxdfhei1' USING DFHEIV0
 10683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10684
 10685
 10686
 10687* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 197
* EL6311.cbl
 10688*        DATASET (FILE-ID-ERPNDB)
 10689*        FROM    (PENDING-BUSINESS)
 10690*        RIDFLD  (PB-CONTROL-PRIMARY)
 10691*    END-EXEC.
 10692     MOVE LENGTH OF
 10693      PENDING-BUSINESS
 10694       TO DFHEIV11
 10695*    MOVE '&$ L                  ''   #00010497' TO DFHEIV0
 10696     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10697     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10698     MOVE X'2020233030303130343937' TO DFHEIV0(25:11)
 10699     CALL 'kxdfhei1' USING DFHEIV0,
 10700           FILE-ID-ERPNDB,
 10701           PENDING-BUSINESS,
 10702           DFHEIV11,
 10703           PB-CONTROL-PRIMARY,
 10704           DFHEIV99,
 10705           DFHEIV99
 10706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10707
 10708
 10709     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10710
 10711     PERFORM 8400-LOG-JOURNAL-RECORD.
 10712
 10713******************************************************************
 10714*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10715******************************************************************
 10716     display ' made it to add orig cert '
 10717     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10718     MOVE ' '                    TO WS-ERMAIL-SW
 10719
 10720* EXEC CICS READ
 10721*       DATASET   (FILE-ID-ERMAIL)
 10722*       SET       (ADDRESS OF MAILING-DATA)
 10723*       RIDFLD    (ERMAIL-KEY)
 10724*       RESP      (WS-RESPONSE)
 10725*    END-EXEC
 10726*    MOVE '&"S        E          (  N#00010513' TO DFHEIV0
 10727     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10728     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10729     MOVE X'204E233030303130353133' TO DFHEIV0(25:11)
 10730     CALL 'kxdfhei1' USING DFHEIV0,
 10731           FILE-ID-ERMAIL,
 10732           DFHEIV20,
 10733           DFHEIV99,
 10734           ERMAIL-KEY,
 10735           DFHEIV99,
 10736           DFHEIV99,
 10737           DFHEIV99
 10738     SET ADDRESS OF MAILING-DATA TO
 10739         DFHEIV20
 10740     MOVE EIBRESP  TO WS-RESPONSE
 10741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10742     IF RESP-NORMAL
 10743        SET ERMAIL-FOUND TO TRUE
 10744     END-IF
 10745
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 198
* EL6311.cbl
 10746     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10747     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10748     MOVE 'OC'                   TO OC-RECORD-ID
 10749     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10750                                 TO OC-CONTROL-PRIMARY (1:33)
 10751     MOVE 'I'                    TO OC-RECORD-TYPE
 10752     MOVE +4096                  TO OC-KEY-SEQ-NO
 10753     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10754     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10755     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10756     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10757     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10758     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10759     MOVE PB-I-AGE               TO OC-INS-AGE
 10760     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10761     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10762     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10763     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10764     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10765     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10766     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10767     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10768     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10769     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10770     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10771     IF PB-I-JOINT-COMMISSION > +0
 10772         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10773     ELSE
 10774         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10775     END-IF
 10776     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10777     MOVE +0                     TO OC-LF-CANCEL-AMT
 10778                                    OC-LF-ITD-CANCEL-AMT
 10779     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10780     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10781     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10782     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10783     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10784     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10785     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10786     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10787     MOVE +0                     TO OC-AH-CANCEL-AMT
 10788                                    OC-AH-ITD-CANCEL-AMT
 10789     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10790     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10791     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10792     IF ERMAIL-FOUND
 10793        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10794     END-IF
 10795     IF NOT CERT-TRL-REC-NOT-FOUND
 10796        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10797                           OC-INS-AGE-DEFAULT-FLAG
 10798        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10799                           OC-JNT-AGE-DEFAULT-FLAG
 10800     END-IF
 10801     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10802     .
 10803 1275-WRITE-ELCRTO.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 199
* EL6311.cbl
 10804
 10805* EXEC CICS WRITE
 10806*       DATASET   ('ELCRTO')
 10807*       FROM      (ORIGINAL-CERTIFICATE)
 10808*       RIDFLD    (OC-CONTROL-PRIMARY)
 10809*       RESP      (WS-RESPONSE)
 10810*    END-EXEC
 10811     MOVE LENGTH OF
 10812      ORIGINAL-CERTIFICATE
 10813       TO DFHEIV11
 10814     MOVE 'ELCRTO' TO DFHEIV1
 10815*    MOVE '&$ L                  ''  N#00010581' TO DFHEIV0
 10816     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10817     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10818     MOVE X'204E233030303130353831' TO DFHEIV0(25:11)
 10819     CALL 'kxdfhei1' USING DFHEIV0,
 10820           DFHEIV1,
 10821           ORIGINAL-CERTIFICATE,
 10822           DFHEIV11,
 10823           OC-CONTROL-PRIMARY,
 10824           DFHEIV99,
 10825           DFHEIV99
 10826     MOVE EIBRESP  TO WS-RESPONSE
 10827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10828     display ' just wrote 1275 ' ws-response
 10829     IF RESP-DUPKEY
 10830        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10831        GO TO 1275-WRITE-ELCRTO
 10832     ELSE
 10833        IF NOT RESP-NORMAL
 10834           MOVE -1               TO BMAINTL
 10835           MOVE ER-7450          TO EMI-ERROR
 10836           PERFORM 9900-ERROR-FORMAT
 10837                                 THRU 9900-EXIT
 10838           GO TO 8200-SEND-DATAONLY
 10839        END-IF
 10840     END-IF
 10841******************************************************************
 10842*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10843******************************************************************
 10844
 10845
 10846* EXEC CICS READ
 10847*        INTO    (PENDING-BUSINESS)
 10848*        DATASET (FILE-ID-ERPNDB)
 10849*        RIDFLD  (ERPNDB-KEY)
 10850*        UPDATE
 10851*    END-EXEC.
 10852     MOVE LENGTH OF
 10853      PENDING-BUSINESS
 10854       TO DFHEIV11
 10855*    MOVE '&"IL       EU         (   #00010604' TO DFHEIV0
 10856     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10857     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10858     MOVE X'2020233030303130363034' TO DFHEIV0(25:11)
 10859     CALL 'kxdfhei1' USING DFHEIV0,
 10860           FILE-ID-ERPNDB,
 10861           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 200
* EL6311.cbl
 10862           DFHEIV11,
 10863           ERPNDB-KEY,
 10864           DFHEIV99,
 10865           DFHEIV99,
 10866           DFHEIV99
 10867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10868
 10869
 10870     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10871     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10872     MOVE 'B'                    TO JP-RECORD-TYPE.
 10873     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10874
 10875     PERFORM 8400-LOG-JOURNAL-RECORD.
 10876
 10877     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10878
 10879
 10880* EXEC CICS REWRITE
 10881*        DATASET (FILE-ID-ERPNDB)
 10882*        FROM    (PENDING-BUSINESS)
 10883*    END-EXEC.
 10884     MOVE LENGTH OF
 10885      PENDING-BUSINESS
 10886       TO DFHEIV11
 10887*    MOVE '&& L                  %   #00010620' TO DFHEIV0
 10888     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10889     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10890     MOVE X'2020233030303130363230' TO DFHEIV0(25:11)
 10891     CALL 'kxdfhei1' USING DFHEIV0,
 10892           FILE-ID-ERPNDB,
 10893           PENDING-BUSINESS,
 10894           DFHEIV11,
 10895           DFHEIV99
 10896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10897
 10898
 10899     MOVE 'C'                    TO JP-RECORD-TYPE.
 10900     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10901
 10902     PERFORM 8400-LOG-JOURNAL-RECORD.
 10903
 10904     IF WS-ERRORS-PRESENT
 10905         GO TO 3900-RE-DISPLAY-RECORD.
 10906
 10907     MOVE ZEROS                  TO EMI-ERROR.
 10908     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10909     MOVE LOW-VALUES             TO EL631BI.
 10910     MOVE  -1                    TO BMAINTL.
 10911     GO TO 8100-SEND-INITIAL-MAP.
 10912
 10913 1280-BATCH-HDR-NOT-FOUND.
 10914     MOVE -1                     TO BMAINTL.
 10915     MOVE ER-7450                TO EMI-ERROR.
 10916     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10917     GO TO 8200-SEND-DATAONLY.
 10918
 10919 1290-DUPLICATE-ALT-INDEX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 201
* EL6311.cbl
 10920
 10921******************************************************************
 10922*                                                                *
 10923*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10924*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10925*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10926*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 10927*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10928*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10929*                                                                *
 10930******************************************************************
 10931
 10932     IF LCP-ONCTR-01 =  0
 10933         ADD 1 TO LCP-ONCTR-01
 10934        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10935
 10936     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10937
 10938     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10939         NEXT SENTENCE
 10940     ELSE
 10941         ADD +1 TO PB-BATCH-SEQ-NO
 10942                   PB-CSR-BATCH-SEQ-NO
 10943         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10944         GO TO 1275-WRITE-PENDING-BUSINESS.
 10945
 10946     MOVE -1                     TO BCERTNOL.
 10947     MOVE AL-UABON               TO BCERTNOA.
 10948     MOVE AL-UNBON               TO BEFFDTA.
 10949
 10950     MOVE 1                      TO EMI-SUB
 10951                                    EMI-SWITCH1
 10952                                    EMI-SWITCH-AREA-1
 10953                                    EMI-SWITCH-AREA-2.
 10954
 10955     MOVE SPACES                 TO EMI-ERROR-LINES.
 10956
 10957
 10958* EXEC CICS SYNCPOINT ROLLBACK
 10959*    END-EXEC.
 10960*    MOVE '6"R                   !   #00010683' TO DFHEIV0
 10961     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10962     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10963     MOVE X'2020233030303130363833' TO DFHEIV0(25:11)
 10964     CALL 'kxdfhei1' USING DFHEIV0
 10965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10966
 10967
 10968     MOVE ER-2247                TO EMI-ERROR.
 10969     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10970     GO TO 8200-SEND-DATAONLY.
 10971
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 202
* EL6311.cbl
 10973
 10974
 10975 1295-READ-CERT-TRAILER.
 10976
 10977
 10978* EXEC CICS GETMAIN
 10979*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 10980*        LENGTH  (ELCRTT-RECORD-LENGTH)
 10981*        INITIMG (GETMAIN-SPACE)
 10982*    END-EXEC
 10983*    MOVE ',"IL                  $   #00010695' TO DFHEIV0
 10984     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10985     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10986     MOVE X'2020233030303130363935' TO DFHEIV0(25:11)
 10987     CALL 'kxdfhei1' USING DFHEIV0,
 10988           DFHEIV20,
 10989           ELCRTT-RECORD-LENGTH,
 10990           GETMAIN-SPACE
 10991     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 10992         DFHEIV20
 10993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10994
 10995     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 10996     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 10997     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 10998
 10999
 11000* EXEC CICS HANDLE CONDITION
 11001*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11002*    END-EXEC.
 11003*    MOVE '"$I                   ! % #00010705' TO DFHEIV0
 11004     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11005     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11006     MOVE X'2520233030303130373035' TO DFHEIV0(25:11)
 11007     CALL 'kxdfhei1' USING DFHEIV0
 11008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11009
 11010
 11011
 11012* EXEC CICS READ
 11013*        DATASET  (CRTT-ID)
 11014*        RIDFLD   (ELCRTT-KEY)
 11015*        INTO     (CERTIFICATE-TRAILERS)
 11016*    END-EXEC.
 11017     MOVE LENGTH OF
 11018      CERTIFICATE-TRAILERS
 11019       TO DFHEIV11
 11020*    MOVE '&"IL       E          (   #00010709' TO DFHEIV0
 11021     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11022     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11023     MOVE X'2020233030303130373039' TO DFHEIV0(25:11)
 11024     CALL 'kxdfhei1' USING DFHEIV0,
 11025           CRTT-ID,
 11026           CERTIFICATE-TRAILERS,
 11027           DFHEIV11,
 11028           ELCRTT-KEY,
 11029           DFHEIV99,
 11030           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 203
* EL6311.cbl
 11031           DFHEIV99
 11032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11033
 11034
 11035     GO TO 1295-EXIT.
 11036
 11037 1295-CERT-TRL-REC-NOTFND.
 11038     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11039
 11040 1295-EXIT.
 11041     EXIT.
 11042
 11043******************************************************************
 11044*                                                                *
 11045*          C H A N G E   I S S U E   R O U T I N E               *
 11046*                                                                *
 11047******************************************************************
 11048
 11049***************************************************************
 11050*                                                             *
 11051*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11052*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11053*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11054*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11055*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11056*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11057*     5. LINK TO THE EDIT ROUTINE.                            *
 11058*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11059*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11060*              THE EDIT ROUTINE.                              *
 11061*     7. REWRITE THE NEW ISSUE                                *
 11062*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11063*                                                             *
 11064***************************************************************
 11065
 11066 1300-CHANGE-ISSUE-ROUTINE.
 11067     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11068
 11069     IF BCHGL NOT = ZEROS
 11070        MOVE ER-2196             TO EMI-ERROR
 11071        MOVE AL-UABON            TO BMAINTA
 11072        MOVE -1                  TO BMAINTL
 11073        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11074        GO TO 8200-SEND-DATAONLY.
 11075
 11076     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11077
 11078     IF BSUFIXL NOT = ZEROS
 11079        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11080     ELSE
 11081        MOVE SPACE               TO WS-NEW-SUFFIX.
 11082
 11083     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11084     PERFORM 8600-DEEDIT.
 11085     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11086     MOVE '4'                    TO DC-OPTION-CODE.
 11087     PERFORM 9700-DATE-LINK.
 11088     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 204
* EL6311.cbl
 11089        MOVE ER-0348             TO EMI-ERROR
 11090        MOVE -1                  TO BEFFDTL
 11091        MOVE AL-UABON            TO BEFFDTA
 11092        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11093        GO TO 8200-SEND-DATAONLY
 11094     ELSE
 11095        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11096        MOVE AL-UANON            TO BEFFDTA
 11097        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11098
 11099 1325-PROCESS-ISSUE-CHANGES.
 11100
 11101* EXEC CICS HANDLE CONDITION
 11102*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11103*    END-EXEC.
 11104*    MOVE '"$I                   ! & #00010780' TO DFHEIV0
 11105     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11107     MOVE X'2620233030303130373830' TO DFHEIV0(25:11)
 11108     CALL 'kxdfhei1' USING DFHEIV0
 11109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11110
 11111
 11112     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11113     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11114     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11115
 11116
 11117* EXEC CICS GETMAIN
 11118*        SET      (ADDRESS OF PENDING-BUSINESS)
 11119*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11120*        INITIMG  (GETMAIN-SPACE)
 11121*     END-EXEC.
 11122*    MOVE ',"IL                  $   #00010788' TO DFHEIV0
 11123     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11124     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11125     MOVE X'2020233030303130373838' TO DFHEIV0(25:11)
 11126     CALL 'kxdfhei1' USING DFHEIV0,
 11127           DFHEIV20,
 11128           ERPNDB-RECORD-LENGTH,
 11129           GETMAIN-SPACE
 11130     SET ADDRESS OF PENDING-BUSINESS TO
 11131         DFHEIV20
 11132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11133
 11134
 11135
 11136* EXEC CICS READ
 11137*        INTO    (PENDING-BUSINESS)
 11138*        DATASET (FILE-ID-ERPNDB)
 11139*        RIDFLD  (ERPNDB-KEY)
 11140*    END-EXEC.
 11141     MOVE LENGTH OF
 11142      PENDING-BUSINESS
 11143       TO DFHEIV11
 11144*    MOVE '&"IL       E          (   #00010794' TO DFHEIV0
 11145     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11146     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 205
* EL6311.cbl
 11147     MOVE X'2020233030303130373934' TO DFHEIV0(25:11)
 11148     CALL 'kxdfhei1' USING DFHEIV0,
 11149           FILE-ID-ERPNDB,
 11150           PENDING-BUSINESS,
 11151           DFHEIV11,
 11152           ERPNDB-KEY,
 11153           DFHEIV99,
 11154           DFHEIV99,
 11155           DFHEIV99
 11156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11157
 11158
 11159     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11160
 11161
 11162* EXEC CICS HANDLE CONDITION
 11163*         NOTFND     (1385-REC-NOT-FOUND)
 11164*    END-EXEC.
 11165*    MOVE '"$I                   ! '' #00010802' TO DFHEIV0
 11166     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11167     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11168     MOVE X'2720233030303130383032' TO DFHEIV0(25:11)
 11169     CALL 'kxdfhei1' USING DFHEIV0
 11170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11171
 11172
 11173**********************************************************
 11174*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11175*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11176**********************************************************
 11177
 11178
 11179* EXEC CICS READ
 11180*        DATASET (FILE-ID-ERPNDB)
 11181*        INTO    (PENDING-BUSINESS)
 11182*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11183*    END-EXEC.
 11184     MOVE LENGTH OF
 11185      PENDING-BUSINESS
 11186       TO DFHEIV11
 11187*    MOVE '&"IL       E          (   #00010811' TO DFHEIV0
 11188     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11189     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11190     MOVE X'2020233030303130383131' TO DFHEIV0(25:11)
 11191     CALL 'kxdfhei1' USING DFHEIV0,
 11192           FILE-ID-ERPNDB,
 11193           PENDING-BUSINESS,
 11194           DFHEIV11,
 11195           PI-PREV-CONTROL-PRIMARY,
 11196           DFHEIV99,
 11197           DFHEIV99,
 11198           DFHEIV99
 11199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11200
 11201
 11202********** DO NOT ALLOW CHANGES IF THRU A/R
 11203     IF BMAINTI = 'C'
 11204         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 206
* EL6311.cbl
 11205             MOVE ER-4005          TO EMI-ERROR
 11206             MOVE -1               TO BMAINTL
 11207             MOVE AL-UABON         TO BMAINTA
 11208             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11209             GO TO 8200-SEND-DATAONLY.
 11210**********
 11211
 11212     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11213        MOVE -1                 TO BMAINTL
 11214        MOVE ER-2197            TO EMI-ERROR
 11215        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11216        GO TO 8200-SEND-DATAONLY.
 11217
 11218     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11219        MOVE ER-2196             TO EMI-ERROR
 11220        MOVE AL-UABON            TO BMAINTA
 11221        MOVE -1                  TO BMAINTL
 11222        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11223        GO TO 8200-SEND-DATAONLY.
 11224
 11225     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11226
 11227     IF PB-BILLED-DT = LOW-VALUES AND
 11228        PB-CHG-COUNT = ZEROS
 11229        NEXT SENTENCE
 11230     ELSE
 11231        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11232            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11233           OR
 11234           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11235            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11236           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11237
 11238
 11239* EXEC CICS READ
 11240*        DATASET (FILE-ID-ERPNDB)
 11241*        INTO    (PENDING-BUSINESS)
 11242*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11243*        UPDATE
 11244*    END-EXEC.
 11245     MOVE LENGTH OF
 11246      PENDING-BUSINESS
 11247       TO DFHEIV11
 11248*    MOVE '&"IL       EU         (   #00010853' TO DFHEIV0
 11249     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11250     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11251     MOVE X'2020233030303130383533' TO DFHEIV0(25:11)
 11252     CALL 'kxdfhei1' USING DFHEIV0,
 11253           FILE-ID-ERPNDB,
 11254           PENDING-BUSINESS,
 11255           DFHEIV11,
 11256           PI-PREV-CONTROL-PRIMARY,
 11257           DFHEIV99,
 11258           DFHEIV99,
 11259           DFHEIV99
 11260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11261
 11262
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 207
* EL6311.cbl
 11263     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11264     MOVE 'B'                    TO JP-RECORD-TYPE
 11265     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11266     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11267
 11268     PERFORM 8400-LOG-JOURNAL-RECORD.
 11269
 11270     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11271        PB-CHG-COUNT NOT = ZEROS
 11272        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11273            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11274           OR
 11275           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11276            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11277            MOVE LOW-VALUES             TO PB-BILLED-DT
 11278            ADD +1                      TO PB-CHG-COUNT.
 11279
 11280     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11281     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11282     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11283     MOVE '5'                    TO DC-OPTION-CODE.
 11284     PERFORM 9700-DATE-LINK
 11285     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11286
 11287*    IF BMICRNOL  GREATER  ZEROS
 11288*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11289
 11290     IF BVINL > ZEROS
 11291        MOVE BVINI               TO PB-I-VIN
 11292     END-IF
 11293     IF (BFORCEL NOT = ZEROS)
 11294        AND (PB-COMPANY-ID = 'DCC')
 11295        AND (BFORCEI = ' ')
 11296        AND (PB-FORCE-CODE = 'O')
 11297        COMPUTE PB-I-AH-PREMIUM-AMT =
 11298           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11299        PERFORM 1800-REMOVE-CERT-NOTES
 11300                                 THRU 1800-EXIT
 11301        PERFORM 1900-DELETE-ERPYAJ
 11302                                 THRU 1900-EXIT
 11303        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11304     END-IF
 11305     IF (BFORCEL NOT = ZEROS)
 11306        AND (PB-COMPANY-ID = 'DCC')
 11307        AND (BFORCEI = 'O')
 11308        AND (PB-FORCE-CODE NOT = 'O')
 11309        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11310           PB-I-AH-PREM-CALC
 11311        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11312        MOVE SPACE               TO DC-OPTION-CODE
 11313        PERFORM 9700-DATE-LINK
 11314        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11315        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11316        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11317        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11318        PERFORM 1500-UPDATE-ERNOTE
 11319                                 THRU 1500-EXIT
 11320        PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 208
* EL6311.cbl
 11321                                 THRU 1600-EXIT
 11322     END-IF
 11323     IF BLSTNML  GREATER THAN ZEROS
 11324         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11325
 11326     IF B1STNML  GREATER THAN ZEROS
 11327         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11328
 11329     IF BINITL   GREATER THAN ZEROS
 11330         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11331
 11332     IF BBIRTHL  GREATER THAN ZERO
 11333         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11334
 11335     IF B1STPMTL GREATER THAN ZERO
 11336         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11337
 11338     IF BAGEL    GREATER THAN ZEROS
 11339         MOVE BAGEI              TO PB-I-AGE.
 11340
 11341     MOVE 'N'                    TO WS-INS-AGE-SET
 11342                                    WS-JNT-AGE-SET.
 11343     IF BAGEL    GREATER THAN ZEROS
 11344        MOVE 'Y'                TO WS-INS-AGE-SET
 11345        IF BAGEI = ZERO AND
 11346             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11347           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11348           MOVE 'AGE*'          TO BAGEDEFO
 11349        ELSE
 11350           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11351           MOVE 'AGE '          TO BAGEDEFO
 11352        END-IF
 11353        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11354     END-IF.
 11355
 11356     IF BSEXL    GREATER THAN ZEROS
 11357         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11358
 11359     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11360        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11361
 11362     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11363        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11364
 11365     IF BLNTRML  GREATER THAN ZEROS
 11366         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11367
 11368     IF BFREQL   GREATER THAN ZEROS
 11369         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11370
 11371     IF BSKPCDL  GREATER THAN ZEROS
 11372         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11373
 11374     IF BMODEL   GREATER THAN ZEROS
 11375         MOVE BMODEI             TO PB-I-TERM-TYPE
 11376                                    PI-BMODE.
 11377
 11378     IF BPMTSL   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 209
* EL6311.cbl
 11379         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11380                                    PI-BPMTS.
 11381
 11382     IF BPMTAMTL GREATER THAN ZEROS
 11383         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11384
 11385     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11386         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11387
 11388     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11389         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11390
 11391     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11392
 11393     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11394         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11395            SUBTRACT PB-I-LF-PREMIUM-AMT
 11396                     FROM WS-B-LF-ISS-PRM-ENTERED
 11397            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11398            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11399            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11400         ELSE
 11401            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11402*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11403*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11404         END-IF
 11405     END-IF.
 11406
 11407     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11408            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11409                     FROM WS-B-LF-ISS-PRM-ENTERED
 11410         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11411         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11412
 11413     IF  BALT-PREM-LEN     (2)  > ZEROS
 11414         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11415
 11416     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11417         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11418
 11419     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11420         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11421            SUBTRACT PB-I-AH-PREMIUM-AMT
 11422                     FROM WS-B-AH-ISS-PRM-ENTERED
 11423            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11424            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11425            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11426         ELSE
 11427            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11428*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11429*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11430         END-IF
 11431     END-IF
 11432
 11433     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11434        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11435
 11436     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 210
* EL6311.cbl
 11437        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11438
 11439     IF BINDGRPL            GREATER THAN ZEROS
 11440         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11441
 11442     IF BRTCLSL             GREATER THAN ZEROS
 11443         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11444
 11445     IF BSIGL               GREATER THAN ZEROS
 11446         MOVE BSIGI              TO PB-I-SIG-SW.
 11447
 11448     IF BAPRL               GREATER THAN ZEROS
 11449         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11450
 11451     IF BMEMBERL            GREATER THAN ZEROS
 11452         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11453
 11454     IF BLNOFCRL            GREATER THAN ZEROS
 11455         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11456
 11457     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11458        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11459
 11460     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11461        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11462
 11463     IF BDAYSL              GREATER THAN ZEROS
 11464        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11465                                    PB-I-EXTENTION-DAYS.
 11466
 11467     IF BDAYSL GREATER THAN ZEROS
 11468        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11469
 11470     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11471        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11472           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11473
 11474     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11475        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11476           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11477
 11478     IF B1STPMTL GREATER THAN ZEROS
 11479        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11480
 11481     IF PB-EXT-DAYS-PROCESSING
 11482        IF PB-I-EXTENTION-DAYS = ZEROS
 11483           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11484
 11485     IF PB-EXPIRE-DT-PROCESSING
 11486        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11487           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11488             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11489
 11490     IF PB-1ST-PMT-DT-PROCESSING
 11491        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11492           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11493
 11494     IF BREINL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 211
* EL6311.cbl
 11495        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11496
 11497     IF BFORCEL NOT = ZEROS
 11498        MOVE BFORCEI             TO PB-FORCE-CODE.
 11499     IF (BENTRYL NOT = ZEROS)
 11500        AND (PB-COMPANY-ID = 'CID')
 11501        AND (PB-STATE = 'VA')
 11502        AND (BENTRYI NOT = 'P')
 11503        AND (PB-BATCH-ENTRY = 'P')
 11504        PERFORM 1800-REMOVE-CERT-NOTES
 11505                                 THRU 1800-EXIT
 11506     END-IF
 11507     IF BENTRYL NOT = ZEROS
 11508        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11509        IF PI-COMPANY-ID = 'CID'
 11510           AND (PB-BATCH-ENTRY = 'P')
 11511           AND (PB-STATE = 'VA')
 11512           PERFORM 1500-UPDATE-ERNOTE
 11513                                 THRU 1500-EXIT
 11514        END-IF
 11515     END-IF
 11516
 11517     IF BUNWRITL NOT = ZEROS
 11518        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11519
 11520     IF BBILCDL NOT = ZEROS
 11521        MOVE BBILCDI             TO PB-RECORD-BILL.
 11522
 11523     IF BLIVESL GREATER THAN ZEROS
 11524        MOVE WS-BLIVES           TO PB-I-LIVES.
 11525
 11526
 11527*DMD CUSTOM CODING*************START
 11528     IF PI-COMPANY-ID NOT = 'DMD'
 11529         MOVE ZEROS               TO BBILLEDL.
 11530*DMD CUSTOM CODING*************END
 11531
 11532     IF BBILLEDL GREATER THAN ZEROS
 11533        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11534
 11535
 11536*****************************************************************
 11537*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11538*****************************************************************
 11539
 11540     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11541        IF BTYPE  (1)   = ZEROS OR SPACES
 11542           IF REMOVE-LF-COVERAGE
 11543               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11544                                        PI-BTYPE (1)
 11545               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11546                                        WS-B-LF-ISS-PRM-ENTERED
 11547               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11548                                        WS-B-LF-ISS-PRM-ENTERED
 11549               SUBTRACT PB-I-LF-PREM-CALC FROM
 11550                                        WS-B-LF-ISS-PRM-COMPUTED
 11551               MOVE ZEROS            TO PB-I-LF-TERM
 11552                                        PB-I-LF-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 212
* EL6311.cbl
 11553                                        PB-I-LF-PREMIUM-AMT
 11554                                        PB-I-LF-BENEFIT-CD
 11555                                        PB-I-LF-PREM-CALC
 11556                                        PB-I-LF-CRIT-PER
 11557                                        PB-I-LF-ALT-BENEFIT-AMT
 11558                                        PB-I-LF-ALT-PREMIUM-AMT
 11559               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11560           ELSE
 11561               NEXT SENTENCE
 11562        ELSE
 11563           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11564                                    PI-BTYPE (1).
 11565     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11566        IF BTYPE  (2)   = ZEROS OR SPACES
 11567           IF  REMOVE-AH-COVERAGE
 11568               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11569                                        PI-BTYPE (2)
 11570               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11571                                        WS-B-AH-ISS-PRM-ENTERED
 11572               SUBTRACT PB-I-AH-PREM-CALC FROM
 11573                                        WS-B-AH-ISS-PRM-COMPUTED
 11574               MOVE ZEROS            TO PB-I-AH-TERM
 11575                                        PB-I-AH-BENEFIT-AMT
 11576                                        PB-I-AH-PREMIUM-AMT
 11577                                        PB-I-AH-BENEFIT-CD
 11578                                        PB-I-AH-PREM-CALC
 11579                                        PB-I-AH-CRIT-PER
 11580               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11581           ELSE
 11582               NEXT SENTENCE
 11583        ELSE
 11584           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11585                                    PI-BTYPE (2).
 11586 1360-REWRITE-PB-RECORD.
 11587     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11588
 11589     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11590     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11591
 11592     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11593
 11594     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11595     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11596
 11597     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11598         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11599
 11600     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11601         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11602
 11603     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11604
 11605     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11606
 11607     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11608
 11609     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11610     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 213
* EL6311.cbl
 11611     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11612
 11613     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11614     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11615
 11616 1375-REWRITE-PB-RECORD.
 11617     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11618     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11619     MOVE 'C'                    TO JP-RECORD-TYPE.
 11620     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11621
 11622
 11623* EXEC CICS REWRITE
 11624*        DATASET (FILE-ID-ERPNDB)
 11625*        FROM    (PENDING-BUSINESS)
 11626*    END-EXEC.
 11627     MOVE LENGTH OF
 11628      PENDING-BUSINESS
 11629       TO DFHEIV11
 11630*    MOVE '&& L                  %   #00011219' TO DFHEIV0
 11631     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11632     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11633     MOVE X'2020233030303131323139' TO DFHEIV0(25:11)
 11634     CALL 'kxdfhei1' USING DFHEIV0,
 11635           FILE-ID-ERPNDB,
 11636           PENDING-BUSINESS,
 11637           DFHEIV11,
 11638           DFHEIV99
 11639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11640
 11641
 11642     PERFORM 8400-LOG-JOURNAL-RECORD.
 11643******************************************************************
 11644*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11645******************************************************************
 11646     display ' made it to update orig cert '
 11647     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11648     MOVE ' '                    TO WS-ERMAIL-SW
 11649
 11650* EXEC CICS READ
 11651*       DATASET   (FILE-ID-ERMAIL)
 11652*       SET       (ADDRESS OF MAILING-DATA)
 11653*       RIDFLD    (ERMAIL-KEY)
 11654*       RESP      (WS-RESPONSE)
 11655*    END-EXEC
 11656*    MOVE '&"S        E          (  N#00011231' TO DFHEIV0
 11657     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11658     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11659     MOVE X'204E233030303131323331' TO DFHEIV0(25:11)
 11660     CALL 'kxdfhei1' USING DFHEIV0,
 11661           FILE-ID-ERMAIL,
 11662           DFHEIV20,
 11663           DFHEIV99,
 11664           ERMAIL-KEY,
 11665           DFHEIV99,
 11666           DFHEIV99,
 11667           DFHEIV99
 11668     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 214
* EL6311.cbl
 11669         DFHEIV20
 11670     MOVE EIBRESP  TO WS-RESPONSE
 11671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11672     IF RESP-NORMAL
 11673        SET ERMAIL-FOUND TO TRUE
 11674     END-IF
 11675
 11676     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11677     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11678                                 TO ELCRTO-KEY
 11679     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11680     MOVE +0                     TO ELCRTO-SEQ-NO
 11681
 11682* EXEC CICS READ
 11683*       DATASET   ('ELCRTO')
 11684*       INTO      (ORIGINAL-CERTIFICATE)
 11685*       RIDFLD    (ELCRTO-KEY)
 11686*       GTEQ
 11687*       RESP      (WS-RESPONSE)
 11688*    END-EXEC
 11689     MOVE LENGTH OF
 11690      ORIGINAL-CERTIFICATE
 11691       TO DFHEIV11
 11692     MOVE 'ELCRTO' TO DFHEIV1
 11693*    MOVE '&"IL       G          (  N#00011246' TO DFHEIV0
 11694     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11695     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11696     MOVE X'204E233030303131323436' TO DFHEIV0(25:11)
 11697     CALL 'kxdfhei1' USING DFHEIV0,
 11698           DFHEIV1,
 11699           ORIGINAL-CERTIFICATE,
 11700           DFHEIV11,
 11701           ELCRTO-KEY,
 11702           DFHEIV99,
 11703           DFHEIV99,
 11704           DFHEIV99
 11705     MOVE EIBRESP  TO WS-RESPONSE
 11706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11707     display ' just read gteq ' ws-response
 11708     IF RESP-NORMAL
 11709        AND (OC-CONTROL-PRIMARY (1:33) =
 11710                 PB-CONTROL-BY-ACCOUNT (1:33))
 11711        AND (OC-RECORD-TYPE = 'I')
 11712        display ' resp norm, key =, type i '
 11713        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11714           display ' end proc blank '
 11715           display ' csr edit session ' PI-CSR-SESSION-SW
 11716           IF NOT CSR-EDIT-SESSION
 11717
 11718* EXEC CICS READ
 11719*                DATASET   ('ELCRTO')
 11720*                INTO      (ORIGINAL-CERTIFICATE)
 11721*                RIDFLD    (OC-CONTROL-PRIMARY)
 11722*                UPDATE
 11723*                RESP      (WS-RESPONSE)
 11724*             END-EXEC
 11725     MOVE LENGTH OF
 11726      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 215
* EL6311.cbl
 11727       TO DFHEIV11
 11728     MOVE 'ELCRTO' TO DFHEIV1
 11729*    MOVE '&"IL       EU         (  N#00011263' TO DFHEIV0
 11730     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11731     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11732     MOVE X'204E233030303131323633' TO DFHEIV0(25:11)
 11733     CALL 'kxdfhei1' USING DFHEIV0,
 11734           DFHEIV1,
 11735           ORIGINAL-CERTIFICATE,
 11736           DFHEIV11,
 11737           OC-CONTROL-PRIMARY,
 11738           DFHEIV99,
 11739           DFHEIV99,
 11740           DFHEIV99
 11741     MOVE EIBRESP  TO WS-RESPONSE
 11742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11743              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11744              IF RESP-NORMAL
 11745                 display ' good read upd '
 11746                 MOVE PB-I-INSURED-LAST-NAME TO
 11747                         OC-INS-LAST-NAME
 11748                 MOVE PB-I-INSURED-FIRST-NAME TO
 11749                         OC-INS-FIRST-NAME
 11750                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11751                         OC-INS-MIDDLE-INIT
 11752                 MOVE PB-I-AGE         TO OC-INS-AGE
 11753                 MOVE PB-I-JOINT-LAST-NAME   TO
 11754                         OC-JNT-LAST-NAME
 11755                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11756                         OC-JNT-FIRST-NAME
 11757                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11758                         OC-JNT-MIDDLE-INIT
 11759                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11760                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11761                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11762                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11763                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11764                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11765                         OC-LF-ALT-BEN-AMT
 11766                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11767                         OC-LF-ALT-PRM-AMT
 11768                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11769                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11770                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11771                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11772                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11773                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11774                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11775                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11776                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11777                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11778                 IF OC-CANCEL-TRAN-IND = 'N'
 11779                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11780                    MOVE +0            TO OC-LF-CANCEL-AMT
 11781                                          OC-LF-ITD-CANCEL-AMT
 11782                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11783                    MOVE +0            TO OC-AH-CANCEL-AMT
 11784                                          OC-AH-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 216
* EL6311.cbl
 11785                 END-IF
 11786                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11787                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11788                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11789                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11790                 IF ERMAIL-FOUND
 11791                    MOVE MA-CRED-BENE-NAME
 11792                                 TO OC-CRED-BENE-NAME
 11793                 END-IF
 11794                 IF NOT CERT-TRL-REC-NOT-FOUND
 11795                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11796                           OC-INS-AGE-DEFAULT-FLAG
 11797                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11798                           OC-JNT-AGE-DEFAULT-FLAG
 11799                 END-IF
 11800
 11801* EXEC CICS REWRITE
 11802*                   DATASET   ('ELCRTO')
 11803*                   FROM      (ORIGINAL-CERTIFICATE)
 11804*                   RESP      (WS-RESPONSE)
 11805*                END-EXEC
 11806     MOVE LENGTH OF
 11807      ORIGINAL-CERTIFICATE
 11808       TO DFHEIV11
 11809     MOVE 'ELCRTO' TO DFHEIV1
 11810*    MOVE '&& L                  %  N#00011327' TO DFHEIV0
 11811     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11812     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11813     MOVE X'204E233030303131333237' TO DFHEIV0(25:11)
 11814     CALL 'kxdfhei1' USING DFHEIV0,
 11815           DFHEIV1,
 11816           ORIGINAL-CERTIFICATE,
 11817           DFHEIV11,
 11818           DFHEIV99
 11819     MOVE EIBRESP  TO WS-RESPONSE
 11820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11821                 display ' just rewrote ' ws-response
 11822              END-IF
 11823           END-IF
 11824        ELSE
 11825           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11826           MOVE 'OC'             TO OC-RECORD-ID
 11827           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11828           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11829           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11830           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11831           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11832           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11833           MOVE PB-I-AGE         TO OC-INS-AGE
 11834           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11835           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11836           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11837           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11838           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11839           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11840           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11841           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11842           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 217
* EL6311.cbl
 11843           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11844           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11845           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11846           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11847           MOVE +0               TO OC-LF-CANCEL-AMT
 11848                                    OC-LF-ITD-CANCEL-AMT
 11849           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11850           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11851           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11852           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11853           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11854           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11855           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11856           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11857           MOVE +0               TO OC-AH-CANCEL-AMT
 11858                                    OC-AH-ITD-CANCEL-AMT
 11859           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11860           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11861           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11862           IF ERMAIL-FOUND
 11863              MOVE MA-CRED-BENE-NAME
 11864                                 TO OC-CRED-BENE-NAME
 11865           END-IF
 11866           IF NOT CERT-TRL-REC-NOT-FOUND
 11867              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11868                           OC-INS-AGE-DEFAULT-FLAG
 11869              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11870                           OC-JNT-AGE-DEFAULT-FLAG
 11871           END-IF
 11872           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11873
 11874* EXEC CICS WRITE
 11875*             DATASET   ('ELCRTO')
 11876*             FROM      (ORIGINAL-CERTIFICATE)
 11877*             RIDFLD    (OC-CONTROL-PRIMARY)
 11878*             RESP      (WS-RESPONSE)
 11879*          END-EXEC
 11880     MOVE LENGTH OF
 11881      ORIGINAL-CERTIFICATE
 11882       TO DFHEIV11
 11883     MOVE 'ELCRTO' TO DFHEIV1
 11884*    MOVE '&$ L                  ''  N#00011384' TO DFHEIV0
 11885     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11886     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11887     MOVE X'204E233030303131333834' TO DFHEIV0(25:11)
 11888     CALL 'kxdfhei1' USING DFHEIV0,
 11889           DFHEIV1,
 11890           ORIGINAL-CERTIFICATE,
 11891           DFHEIV11,
 11892           OC-CONTROL-PRIMARY,
 11893           DFHEIV99,
 11894           DFHEIV99
 11895     MOVE EIBRESP  TO WS-RESPONSE
 11896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11897        END-IF
 11898     ELSE
 11899        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11900        MOVE 'OC'                TO OC-RECORD-ID
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 218
* EL6311.cbl
 11901        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11902                                 TO OC-CONTROL-PRIMARY (1:33)
 11903        MOVE 'I'                 TO OC-RECORD-TYPE
 11904        MOVE +4096               TO OC-KEY-SEQ-NO
 11905        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11906        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 11907        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11908        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11909        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11910        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11911        MOVE PB-I-AGE            TO OC-INS-AGE
 11912        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11913        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11914        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11915        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11916        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11917        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11918        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11919        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11920        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11921        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11922        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11923        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11924        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11925        MOVE +0                  TO OC-LF-CANCEL-AMT
 11926                                    OC-LF-ITD-CANCEL-AMT
 11927        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11928        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11929        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11930        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11931        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11932        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11933        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11934        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11935        MOVE +0                  TO OC-AH-CANCEL-AMT
 11936                                    OC-AH-ITD-CANCEL-AMT
 11937        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11938        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 11939        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 11940        IF ERMAIL-FOUND
 11941           MOVE MA-CRED-BENE-NAME
 11942                                 TO OC-CRED-BENE-NAME
 11943        END-IF
 11944        IF NOT CERT-TRL-REC-NOT-FOUND
 11945           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11946                           OC-INS-AGE-DEFAULT-FLAG
 11947           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11948                           OC-JNT-AGE-DEFAULT-FLAG
 11949        END-IF
 11950        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11951
 11952* EXEC CICS WRITE
 11953*          DATASET   ('ELCRTO')
 11954*          FROM      (ORIGINAL-CERTIFICATE)
 11955*          RIDFLD    (OC-CONTROL-PRIMARY)
 11956*          RESP      (WS-RESPONSE)
 11957*       END-EXEC
 11958     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 219
* EL6311.cbl
 11959      ORIGINAL-CERTIFICATE
 11960       TO DFHEIV11
 11961     MOVE 'ELCRTO' TO DFHEIV1
 11962*    MOVE '&$ L                  ''  N#00011444' TO DFHEIV0
 11963     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11964     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11965     MOVE X'204E233030303131343434' TO DFHEIV0(25:11)
 11966     CALL 'kxdfhei1' USING DFHEIV0,
 11967           DFHEIV1,
 11968           ORIGINAL-CERTIFICATE,
 11969           DFHEIV11,
 11970           OC-CONTROL-PRIMARY,
 11971           DFHEIV99,
 11972           DFHEIV99
 11973     MOVE EIBRESP  TO WS-RESPONSE
 11974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11975     END-IF
 11976******************************************************************
 11977*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11978******************************************************************
 11979
 11980     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11981     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11982
 11983
 11984* EXEC CICS READ
 11985*        INTO    (PENDING-BUSINESS)
 11986*        DATASET (FILE-ID-ERPNDB)
 11987*        RIDFLD  (ERPNDB-KEY)
 11988*        UPDATE
 11989*    END-EXEC.
 11990     MOVE LENGTH OF
 11991      PENDING-BUSINESS
 11992       TO DFHEIV11
 11993*    MOVE '&"IL       EU         (   #00011458' TO DFHEIV0
 11994     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11995     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11996     MOVE X'2020233030303131343538' TO DFHEIV0(25:11)
 11997     CALL 'kxdfhei1' USING DFHEIV0,
 11998           FILE-ID-ERPNDB,
 11999           PENDING-BUSINESS,
 12000           DFHEIV11,
 12001           ERPNDB-KEY,
 12002           DFHEIV99,
 12003           DFHEIV99,
 12004           DFHEIV99
 12005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12006
 12007
 12008     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12009     MOVE 'B'                    TO JP-RECORD-TYPE.
 12010     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12011
 12012     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12013
 12014     PERFORM 8400-LOG-JOURNAL-RECORD.
 12015
 12016     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 220
* EL6311.cbl
 12017
 12018     MOVE 'C'                    TO JP-RECORD-TYPE.
 12019     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12020
 12021
 12022* EXEC CICS REWRITE
 12023*        DATASET    (FILE-ID-ERPNDB)
 12024*        FROM       (PENDING-BUSINESS)
 12025*    END-EXEC.
 12026     MOVE LENGTH OF
 12027      PENDING-BUSINESS
 12028       TO DFHEIV11
 12029*    MOVE '&& L                  %   #00011478' TO DFHEIV0
 12030     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12031     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12032     MOVE X'2020233030303131343738' TO DFHEIV0(25:11)
 12033     CALL 'kxdfhei1' USING DFHEIV0,
 12034           FILE-ID-ERPNDB,
 12035           PENDING-BUSINESS,
 12036           DFHEIV11,
 12037           DFHEIV99
 12038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12039
 12040
 12041     PERFORM 8400-LOG-JOURNAL-RECORD.
 12042
 12043     IF WS-ERRORS-PRESENT
 12044        GO TO 3900-RE-DISPLAY-RECORD.
 12045
 12046     MOVE ZEROS                  TO EMI-ERROR.
 12047     MOVE -1                     TO BMAINTL.
 12048     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12049     GO TO 3900-RE-DISPLAY-RECORD.
 12050
 12051 1380-BATCH-HDR-NOT-FOUND.
 12052     MOVE -1                     TO BMAINTL.
 12053     MOVE ER-7450                TO EMI-ERROR.
 12054     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12055     GO TO 8200-SEND-DATAONLY.
 12056
 12057 1385-REC-NOT-FOUND.
 12058     MOVE -1                     TO BMAINTL.
 12059     MOVE ER-7451                TO EMI-ERROR.
 12060     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12061     GO TO 8200-SEND-DATAONLY.
 12062
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 221
* EL6311.cbl
 12064
 12065 1386-UPDATE-AGE-FLAGS.
 12066
 12067
 12068* EXEC CICS GETMAIN
 12069*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12070*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12071*        INITIMG (GETMAIN-SPACE)
 12072*    END-EXEC
 12073*    MOVE ',"IL                  $   #00011509' TO DFHEIV0
 12074     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12075     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12076     MOVE X'2020233030303131353039' TO DFHEIV0(25:11)
 12077     CALL 'kxdfhei1' USING DFHEIV0,
 12078           DFHEIV20,
 12079           ELCRTT-RECORD-LENGTH,
 12080           GETMAIN-SPACE
 12081     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12082         DFHEIV20
 12083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12084
 12085
 12086* EXEC CICS HANDLE CONDITION
 12087*        NOTFND   (1386-NOTFND)
 12088*    END-EXEC.
 12089*    MOVE '"$I                   ! ( #00011515' TO DFHEIV0
 12090     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12091     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12092     MOVE X'2820233030303131353135' TO DFHEIV0(25:11)
 12093     CALL 'kxdfhei1' USING DFHEIV0
 12094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12095
 12096
 12097     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12098     MOVE 'C'                TO ELCRTT-REC-TYPE
 12099
 12100
 12101* EXEC CICS READ
 12102*        UPDATE
 12103*        DATASET  (CRTT-ID)
 12104*        RIDFLD   (ELCRTT-KEY)
 12105*        INTO     (CERTIFICATE-TRAILERS)
 12106*    END-EXEC.
 12107     MOVE LENGTH OF
 12108      CERTIFICATE-TRAILERS
 12109       TO DFHEIV11
 12110*    MOVE '&"IL       EU         (   #00011522' TO DFHEIV0
 12111     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12112     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12113     MOVE X'2020233030303131353232' TO DFHEIV0(25:11)
 12114     CALL 'kxdfhei1' USING DFHEIV0,
 12115           CRTT-ID,
 12116           CERTIFICATE-TRAILERS,
 12117           DFHEIV11,
 12118           ELCRTT-KEY,
 12119           DFHEIV99,
 12120           DFHEIV99,
 12121           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 222
* EL6311.cbl
 12122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12123
 12124
 12125     IF WS-INS-AGE-SET = 'Y'
 12126        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12127     END-IF
 12128     IF WS-JNT-AGE-SET = 'Y'
 12129        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12130     END-IF
 12131
 12132
 12133* EXEC CICS REWRITE
 12134*       DATASET  (CRTT-ID)
 12135*       FROM     (CERTIFICATE-TRAILERS)
 12136*    END-EXEC.
 12137     MOVE LENGTH OF
 12138      CERTIFICATE-TRAILERS
 12139       TO DFHEIV11
 12140*    MOVE '&& L                  %   #00011536' TO DFHEIV0
 12141     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12142     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12143     MOVE X'2020233030303131353336' TO DFHEIV0(25:11)
 12144     CALL 'kxdfhei1' USING DFHEIV0,
 12145           CRTT-ID,
 12146           CERTIFICATE-TRAILERS,
 12147           DFHEIV11,
 12148           DFHEIV99
 12149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12150
 12151
 12152     GO TO 1386-EXIT.
 12153
 12154 1386-NOTFND.
 12155
 12156     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12157     MOVE 'CS'         TO CS-RECORD-ID.
 12158     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12159     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12160     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12161     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12162     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12163
 12164* EXEC CICS WRITE
 12165*       DATASET  (CRTT-ID)
 12166*       RIDFLD   (ELCRTT-KEY)
 12167*       FROM     (CERTIFICATE-TRAILERS)
 12168*    END-EXEC.
 12169     MOVE LENGTH OF
 12170      CERTIFICATE-TRAILERS
 12171       TO DFHEIV11
 12172*    MOVE '&$ L                  ''   #00011552' TO DFHEIV0
 12173     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12174     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12175     MOVE X'2020233030303131353532' TO DFHEIV0(25:11)
 12176     CALL 'kxdfhei1' USING DFHEIV0,
 12177           CRTT-ID,
 12178           CERTIFICATE-TRAILERS,
 12179           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 223
* EL6311.cbl
 12180           ELCRTT-KEY,
 12181           DFHEIV99,
 12182           DFHEIV99
 12183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12184
 12185
 12186 1386-EXIT.
 12187     EXIT.
 12188
 12189 1390-UPDATE-ERPNDM.
 12190
 12191
 12192* EXEC CICS HANDLE CONDITION
 12193*        NOTFND (1399-EXIT)
 12194*    END-EXEC.
 12195*    MOVE '"$I                   ! ) #00011563' TO DFHEIV0
 12196     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12197     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12198     MOVE X'2920233030303131353633' TO DFHEIV0(25:11)
 12199     CALL 'kxdfhei1' USING DFHEIV0
 12200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12201
 12202
 12203     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12204
 12205
 12206* EXEC CICS READ
 12207*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12208*        DATASET (FILE-ID-ERPNDM)
 12209*        RIDFLD  (ERPNDM-KEY)
 12210*        UPDATE
 12211*    END-EXEC.
 12212*    MOVE '&"S        EU         (   #00011569' TO DFHEIV0
 12213     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12214     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12215     MOVE X'2020233030303131353639' TO DFHEIV0(25:11)
 12216     CALL 'kxdfhei1' USING DFHEIV0,
 12217           FILE-ID-ERPNDM,
 12218           DFHEIV20,
 12219           DFHEIV99,
 12220           ERPNDM-KEY,
 12221           DFHEIV99,
 12222           DFHEIV99,
 12223           DFHEIV99
 12224     SET ADDRESS OF PENDING-MAILING-DATA TO
 12225         DFHEIV20
 12226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12227
 12228
 12229     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12230     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12231     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12232
 12233     IF BLSTNML GREATER THAN ZEROS
 12234         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12235
 12236     IF B1STNML GREATER  THAN ZEROS
 12237         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 224
* EL6311.cbl
 12238
 12239     IF BINITL GREATER THAN ZEROS
 12240         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12241
 12242     IF BAGEL GREATER THAN ZEROS
 12243         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12244
 12245     IF BBIRTHL GREATER THAN ZEROS
 12246         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12247
 12248     IF BSEXL GREATER THAN ZEROS
 12249         MOVE  BSEXI             TO PM-INSURED-SEX.
 12250
 12251
 12252* EXEC CICS REWRITE
 12253*        DATASET (FILE-ID-ERPNDM)
 12254*        FROM    (PENDING-MAILING-DATA)
 12255*    END-EXEC.
 12256     MOVE LENGTH OF
 12257      PENDING-MAILING-DATA
 12258       TO DFHEIV11
 12259*    MOVE '&& L                  %   #00011598' TO DFHEIV0
 12260     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12261     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12262     MOVE X'2020233030303131353938' TO DFHEIV0(25:11)
 12263     CALL 'kxdfhei1' USING DFHEIV0,
 12264           FILE-ID-ERPNDM,
 12265           PENDING-MAILING-DATA,
 12266           DFHEIV11,
 12267           DFHEIV99
 12268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12269
 12270
 12271 1399-EXIT.
 12272     EXIT.
 12273
 12274******************************************************************
 12275*                                                                *
 12276*          D E L E T E   I S S U E   R O U T I N E               *
 12277*                                                                *
 12278******************************************************************
 12279
 12280 1400-DELETE-ISSUE-ROUTINE.
 12281     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12282
 12283     IF BCHGL NOT = ZEROS
 12284        MOVE ER-2196             TO EMI-ERROR
 12285        MOVE AL-UABON            TO BMAINTA
 12286        MOVE -1                  TO BMAINTL
 12287        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12288        GO TO 8200-SEND-DATAONLY.
 12289
 12290
 12291* EXEC CICS HANDLE CONDITION
 12292*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12293*    END-EXEC.
 12294*    MOVE '"$I                   ! * #00011622' TO DFHEIV0
 12295     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 225
* EL6311.cbl
 12296     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12297     MOVE X'2A20233030303131363232' TO DFHEIV0(25:11)
 12298     CALL 'kxdfhei1' USING DFHEIV0
 12299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12300
 12301
 12302     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12303     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12304     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12305
 12306
 12307* EXEC CICS READ
 12308*        SET     (ADDRESS OF PENDING-BUSINESS)
 12309*        DATASET (FILE-ID-ERPNDB)
 12310*        RIDFLD  (ERPNDB-KEY)
 12311*    END-EXEC.
 12312*    MOVE '&"S        E          (   #00011630' TO DFHEIV0
 12313     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12315     MOVE X'2020233030303131363330' TO DFHEIV0(25:11)
 12316     CALL 'kxdfhei1' USING DFHEIV0,
 12317           FILE-ID-ERPNDB,
 12318           DFHEIV20,
 12319           DFHEIV99,
 12320           ERPNDB-KEY,
 12321           DFHEIV99,
 12322           DFHEIV99,
 12323           DFHEIV99
 12324     SET ADDRESS OF PENDING-BUSINESS TO
 12325         DFHEIV20
 12326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12327
 12328
 12329     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12330
 12331     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12332
 12333     IF BSUFIXL NOT = ZEROS
 12334        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12335     ELSE
 12336        MOVE SPACE               TO WS-NEW-SUFFIX.
 12337
 12338     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12339     PERFORM 8600-DEEDIT.
 12340     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12341     MOVE '4'                    TO DC-OPTION-CODE.
 12342     PERFORM 9700-DATE-LINK.
 12343     IF DATE-CONVERSION-ERROR
 12344        MOVE ER-0348             TO EMI-ERROR
 12345        MOVE -1                  TO BEFFDTL
 12346        MOVE AL-UABON            TO BEFFDTA
 12347        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12348        GO TO 8200-SEND-DATAONLY
 12349     ELSE
 12350        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12351        MOVE AL-UANON            TO BEFFDTA
 12352        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12353
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 226
* EL6311.cbl
 12354
 12355* EXEC CICS HANDLE CONDITION
 12356*         NOTFND    (1490-RECORD-NOT-FOUND)
 12357*    END-EXEC.
 12358*    MOVE '"$I                   ! + #00011661' TO DFHEIV0
 12359     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12360     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12361     MOVE X'2B20233030303131363631' TO DFHEIV0(25:11)
 12362     CALL 'kxdfhei1' USING DFHEIV0
 12363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12364
 12365
 12366
 12367* EXEC CICS READ
 12368*        SET     (ADDRESS OF PENDING-BUSINESS)
 12369*        DATASET (FILE-ID-ERPNDB)
 12370*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12371*        UPDATE
 12372*    END-EXEC.
 12373*    MOVE '&"S        EU         (   #00011665' TO DFHEIV0
 12374     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12375     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12376     MOVE X'2020233030303131363635' TO DFHEIV0(25:11)
 12377     CALL 'kxdfhei1' USING DFHEIV0,
 12378           FILE-ID-ERPNDB,
 12379           DFHEIV20,
 12380           DFHEIV99,
 12381           PI-PREV-CONTROL-PRIMARY,
 12382           DFHEIV99,
 12383           DFHEIV99,
 12384           DFHEIV99
 12385     SET ADDRESS OF PENDING-BUSINESS TO
 12386         DFHEIV20
 12387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12388
 12389
 12390     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12391        MOVE -1                 TO BMAINTL
 12392        MOVE ER-2197            TO EMI-ERROR
 12393        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12394        GO TO 8200-SEND-DATAONLY.
 12395
 12396     IF PB-BILLED-DT NOT = LOW-VALUES
 12397        MOVE -1                 TO BMAINTL
 12398        MOVE ER-2129            TO EMI-ERROR
 12399        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12400        GO TO 8200-SEND-DATAONLY.
 12401
 12402     IF PB-CHG-COUNT NOT = ZEROS
 12403        MOVE ER-2336            TO EMI-ERROR
 12404        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12405        MOVE AL-UABON            TO BMAINTA
 12406        MOVE -1                  TO BMAINTL
 12407        GO TO 8200-SEND-DATAONLY.
 12408
 12409     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12410        PB-CHG-COUNT NOT = ZEROS
 12411        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 227
* EL6311.cbl
 12412        MOVE AL-UABON            TO BMAINTA
 12413        MOVE -1                  TO BMAINTL
 12414        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12415        GO TO 8200-SEND-DATAONLY.
 12416******************************************************************
 12417*                                                                *
 12418*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12419*                                                                *
 12420******************************************************************
 12421     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12422     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12423     MOVE +0                     TO ELCRTO-SEQ-NO
 12424
 12425* EXEC CICS READ
 12426*       DATASET   ('ELCRTO')
 12427*       INTO      (ORIGINAL-CERTIFICATE)
 12428*       RIDFLD    (ELCRTO-KEY)
 12429*       GTEQ
 12430*       RESP      (WS-RESPONSE)
 12431*    END-EXEC
 12432     MOVE LENGTH OF
 12433      ORIGINAL-CERTIFICATE
 12434       TO DFHEIV11
 12435     MOVE 'ELCRTO' TO DFHEIV1
 12436*    MOVE '&"IL       G          (  N#00011706' TO DFHEIV0
 12437     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12438     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12439     MOVE X'204E233030303131373036' TO DFHEIV0(25:11)
 12440     CALL 'kxdfhei1' USING DFHEIV0,
 12441           DFHEIV1,
 12442           ORIGINAL-CERTIFICATE,
 12443           DFHEIV11,
 12444           ELCRTO-KEY,
 12445           DFHEIV99,
 12446           DFHEIV99,
 12447           DFHEIV99
 12448     MOVE EIBRESP  TO WS-RESPONSE
 12449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12450     IF RESP-NORMAL
 12451        AND (OC-CONTROL-PRIMARY (1:33) =
 12452                 PB-CONTROL-BY-ACCOUNT (1:33))
 12453        AND (OC-RECORD-TYPE = 'I')
 12454
 12455* EXEC CICS READ
 12456*          DATASET   ('ELCRTO')
 12457*          INTO      (ORIGINAL-CERTIFICATE)
 12458*          RIDFLD    (ELCRTO-KEY)
 12459*          UPDATE
 12460*          RESP      (WS-RESPONSE)
 12461*       END-EXEC
 12462     MOVE LENGTH OF
 12463      ORIGINAL-CERTIFICATE
 12464       TO DFHEIV11
 12465     MOVE 'ELCRTO' TO DFHEIV1
 12466*    MOVE '&"IL       EU         (  N#00011717' TO DFHEIV0
 12467     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12468     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12469     MOVE X'204E233030303131373137' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 228
* EL6311.cbl
 12470     CALL 'kxdfhei1' USING DFHEIV0,
 12471           DFHEIV1,
 12472           ORIGINAL-CERTIFICATE,
 12473           DFHEIV11,
 12474           ELCRTO-KEY,
 12475           DFHEIV99,
 12476           DFHEIV99,
 12477           DFHEIV99
 12478     MOVE EIBRESP  TO WS-RESPONSE
 12479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12480        IF RESP-NORMAL
 12481
 12482* EXEC CICS DELETE
 12483*             DATASET   ('ELCRTO')
 12484*          END-EXEC
 12485     MOVE 'ELCRTO' TO DFHEIV1
 12486*    MOVE '&(                    &   #00011725' TO DFHEIV0
 12487     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12488     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12489     MOVE X'2020233030303131373235' TO DFHEIV0(25:11)
 12490     CALL 'kxdfhei1' USING DFHEIV0,
 12491           DFHEIV1,
 12492           DFHEIV99,
 12493           DFHEIV99,
 12494           DFHEIV99,
 12495           DFHEIV99
 12496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12497        END-IF
 12498     END-IF
 12499******************************************************************
 12500*                                                                *
 12501*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12502*                                                                *
 12503******************************************************************
 12504
 12505* EXEC CICS HANDLE CONDITION
 12506*        NOTFND    (1405-DELETE-CERTIFICATE)
 12507*    END-EXEC.
 12508*    MOVE '"$I                   ! , #00011735' TO DFHEIV0
 12509     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12510     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12511     MOVE X'2C20233030303131373335' TO DFHEIV0(25:11)
 12512     CALL 'kxdfhei1' USING DFHEIV0
 12513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12514
 12515
 12516
 12517* EXEC CICS READ
 12518*        EQUAL
 12519*        DATASET   (FILE-ID-ERPNDM)
 12520*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12521*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12522*        UPDATE
 12523*    END-EXEC.
 12524*    MOVE '&"S        EU         (   #00011739' TO DFHEIV0
 12525     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12526     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12527     MOVE X'2020233030303131373339' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 229
* EL6311.cbl
 12528     CALL 'kxdfhei1' USING DFHEIV0,
 12529           FILE-ID-ERPNDM,
 12530           DFHEIV20,
 12531           DFHEIV99,
 12532           PI-PREV-CONTROL-PRIMARY,
 12533           DFHEIV99,
 12534           DFHEIV99,
 12535           DFHEIV99
 12536     SET ADDRESS OF PENDING-MAILING-DATA TO
 12537         DFHEIV20
 12538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12539
 12540
 12541     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12542     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12543     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12544
 12545     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12546
 12547
 12548* EXEC CICS DELETE
 12549*        DATASET   (FILE-ID-ERPNDM)
 12550*    END-EXEC.
 12551*    MOVE '&(                    &   #00011753' TO DFHEIV0
 12552     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12553     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12554     MOVE X'2020233030303131373533' TO DFHEIV0(25:11)
 12555     CALL 'kxdfhei1' USING DFHEIV0,
 12556           FILE-ID-ERPNDM,
 12557           DFHEIV99,
 12558           DFHEIV99,
 12559           DFHEIV99,
 12560           DFHEIV99
 12561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12562
 12563
 12564******************************************************************
 12565*                PROCESS   CERTIFICATE                           *
 12566******************************************************************
 12567
 12568 1405-DELETE-CERTIFICATE.
 12569
 12570* EXEC CICS HANDLE CONDITION
 12571*         NOTFND  (1420-CONTINUE-DELETE)
 12572*    END-EXEC.
 12573*    MOVE '"$I                   ! - #00011762' TO DFHEIV0
 12574     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12576     MOVE X'2D20233030303131373632' TO DFHEIV0(25:11)
 12577     CALL 'kxdfhei1' USING DFHEIV0
 12578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12579
 12580
 12581     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12582     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12583     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12584     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12585
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 230
* EL6311.cbl
 12586
 12587* EXEC CICS READ
 12588*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12589*        DATASET (FILE-ID-ELCERT)
 12590*        RIDFLD  (ELCERT-KEY)
 12591*        UPDATE
 12592*    END-EXEC.
 12593*    MOVE '&"S        EU         (   #00011771' TO DFHEIV0
 12594     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12595     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12596     MOVE X'2020233030303131373731' TO DFHEIV0(25:11)
 12597     CALL 'kxdfhei1' USING DFHEIV0,
 12598           FILE-ID-ELCERT,
 12599           DFHEIV20,
 12600           DFHEIV99,
 12601           ELCERT-KEY,
 12602           DFHEIV99,
 12603           DFHEIV99,
 12604           DFHEIV99
 12605     SET ADDRESS OF CERTIFICATE-MASTER TO
 12606         DFHEIV20
 12607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12608
 12609
 12610     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12611
 12612     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12613     MOVE 'B'                    TO JP-RECORD-TYPE
 12614     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12615
 12616     PERFORM 8400-LOG-JOURNAL-RECORD.
 12617
 12618     IF CERT-NOTES-ARE-NOT-PRESENT
 12619        MOVE ' '                 TO WS-CERT-NOTE-SW
 12620     ELSE
 12621        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12622
 12623     IF INSURED-ADDR-PRESENT
 12624        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12625
 12626******************************************************************
 12627******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12628******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12629******************************************************************
 12630******************************************************************
 12631
 12632     IF CERT-ADDED-BATCH AND
 12633        (NOT NO-CLAIM-ATTACHED
 12634         OR
 12635         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12636        GO TO 1410-REWRITE-CERT.
 12637
 12638******************************************************************
 12639******************************************************************
 12640
 12641     IF CERT-ADDED-BATCH  AND
 12642        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12643        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 231
* EL6311.cbl
 12644
 12645     IF NO-CLAIM-ATTACHED
 12646        NEXT SENTENCE
 12647     ELSE
 12648        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12649        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12650        GO TO 1410-REWRITE-CERT.
 12651
 12652     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12653     MOVE 'D'                      TO JP-RECORD-TYPE.
 12654     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12655
 12656
 12657* EXEC CICS DELETE
 12658*         DATASET    (FILE-ID-ELCERT)
 12659*    END-EXEC.
 12660*    MOVE '&(                    &   #00011824' TO DFHEIV0
 12661     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12662     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12663     MOVE X'2020233030303131383234' TO DFHEIV0(25:11)
 12664     CALL 'kxdfhei1' USING DFHEIV0,
 12665           FILE-ID-ELCERT,
 12666           DFHEIV99,
 12667           DFHEIV99,
 12668           DFHEIV99,
 12669           DFHEIV99
 12670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12671
 12672
 12673     PERFORM 8400-LOG-JOURNAL-RECORD.
 12674
 12675******************************************************************
 12676*                                                                *
 12677*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12678*                                                                *
 12679******************************************************************
 12680
 12681     IF  CERT-NOTES-ARE-PRESENT
 12682         NEXT SENTENCE
 12683     ELSE
 12684         GO TO 1407-DELETE-MAILING.
 12685
 12686
 12687* EXEC CICS HANDLE CONDITION
 12688*         NOTFND  (1406-DELETE-ERNOTE)
 12689*    END-EXEC.
 12690*    MOVE '"$I                   ! . #00011841' TO DFHEIV0
 12691     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12692     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12693     MOVE X'2E20233030303131383431' TO DFHEIV0(25:11)
 12694     CALL 'kxdfhei1' USING DFHEIV0
 12695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12696
 12697
 12698     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12699     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12700     MOVE 0                     TO ERCNOT-SEQUENCE.
 12701
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 232
* EL6311.cbl
 12702 1406-DELETE-ERCNOT-LOOP.
 12703
 12704
 12705* EXEC CICS READ
 12706*        GTEQ
 12707*        DATASET   (FILE-ID-ERCNOT)
 12708*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12709*        RIDFLD    (ERCNOT-KEY)
 12710*    END-EXEC.
 12711*    MOVE '&"S        G          (   #00011851' TO DFHEIV0
 12712     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12713     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12714     MOVE X'2020233030303131383531' TO DFHEIV0(25:11)
 12715     CALL 'kxdfhei1' USING DFHEIV0,
 12716           FILE-ID-ERCNOT,
 12717           DFHEIV20,
 12718           DFHEIV99,
 12719           ERCNOT-KEY,
 12720           DFHEIV99,
 12721           DFHEIV99,
 12722           DFHEIV99
 12723     SET ADDRESS OF CERT-NOTE-FILE TO
 12724         DFHEIV20
 12725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12726
 12727
 12728     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12729     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12730         GO TO 1406-DELETE-ERNOTE
 12731     END-IF.
 12732
 12733     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12734     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12735     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12736
 12737     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12738
 12739
 12740* EXEC CICS DELETE
 12741*        DATASET   (FILE-ID-ERCNOT)
 12742*        RIDFLD    (ERCNOT-KEY)
 12743*        END-EXEC.
 12744*    MOVE '&(  R                 &   #00011869' TO DFHEIV0
 12745     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12746     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12747     MOVE X'2020233030303131383639' TO DFHEIV0(25:11)
 12748     CALL 'kxdfhei1' USING DFHEIV0,
 12749           FILE-ID-ERCNOT,
 12750           ERCNOT-KEY,
 12751           DFHEIV99,
 12752           DFHEIV99,
 12753           DFHEIV99
 12754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12755
 12756
 12757     PERFORM 8400-LOG-JOURNAL-RECORD.
 12758
 12759     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 233
* EL6311.cbl
 12760
 12761 1406-DELETE-ERNOTE.
 12762
 12763
 12764* EXEC CICS HANDLE CONDITION
 12765*         NOTFND  (1407-DELETE-MAILING)
 12766*    END-EXEC.
 12767*    MOVE '"$I                   ! / #00011880' TO DFHEIV0
 12768     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12769     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12770     MOVE X'2F20233030303131383830' TO DFHEIV0(25:11)
 12771     CALL 'kxdfhei1' USING DFHEIV0
 12772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12773
 12774
 12775
 12776* EXEC CICS READ
 12777*        EQUAL
 12778*        DATASET   (FILE-ID-ERNOTE)
 12779*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12780*        RIDFLD    (ELCERT-KEY)
 12781*        UPDATE
 12782*    END-EXEC.
 12783*    MOVE '&"S        EU         (   #00011884' TO DFHEIV0
 12784     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12785     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12786     MOVE X'2020233030303131383834' TO DFHEIV0(25:11)
 12787     CALL 'kxdfhei1' USING DFHEIV0,
 12788           FILE-ID-ERNOTE,
 12789           DFHEIV20,
 12790           DFHEIV99,
 12791           ELCERT-KEY,
 12792           DFHEIV99,
 12793           DFHEIV99,
 12794           DFHEIV99
 12795     SET ADDRESS OF CERTIFICATE-NOTE TO
 12796         DFHEIV20
 12797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12798
 12799
 12800     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12801     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12802     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12803
 12804     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12805
 12806
 12807* EXEC CICS DELETE
 12808*        DATASET   (FILE-ID-ERNOTE)
 12809*        END-EXEC.
 12810*    MOVE '&(                    &   #00011898' TO DFHEIV0
 12811     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12812     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12813     MOVE X'2020233030303131383938' TO DFHEIV0(25:11)
 12814     CALL 'kxdfhei1' USING DFHEIV0,
 12815           FILE-ID-ERNOTE,
 12816           DFHEIV99,
 12817           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 234
* EL6311.cbl
 12818           DFHEIV99,
 12819           DFHEIV99
 12820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12821
 12822
 12823     PERFORM 8400-LOG-JOURNAL-RECORD.
 12824
 12825******************************************************************
 12826*                                                                *
 12827*                DELETE MAILING ADDRESS RECORDS                  *
 12828*                                                                *
 12829******************************************************************
 12830
 12831 1407-DELETE-MAILING.
 12832     IF CERT-ADDRESS-PRESENT
 12833        NEXT SENTENCE
 12834     ELSE
 12835        GO TO 1420-CONTINUE-DELETE.
 12836
 12837
 12838* EXEC CICS HANDLE CONDITION
 12839*         NOTFND  (1420-CONTINUE-DELETE)
 12840*    END-EXEC.
 12841*    MOVE '"$I                   ! 0 #00011916' TO DFHEIV0
 12842     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12844     MOVE X'3020233030303131393136' TO DFHEIV0(25:11)
 12845     CALL 'kxdfhei1' USING DFHEIV0
 12846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12847
 12848
 12849
 12850* EXEC CICS READ
 12851*        EQUAL
 12852*        DATASET   (FILE-ID-ERMAIL)
 12853*        SET       (ADDRESS OF MAILING-DATA)
 12854*        RIDFLD    (ELCERT-KEY)
 12855*        UPDATE
 12856*    END-EXEC.
 12857*    MOVE '&"S        EU         (   #00011920' TO DFHEIV0
 12858     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12859     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12860     MOVE X'2020233030303131393230' TO DFHEIV0(25:11)
 12861     CALL 'kxdfhei1' USING DFHEIV0,
 12862           FILE-ID-ERMAIL,
 12863           DFHEIV20,
 12864           DFHEIV99,
 12865           ELCERT-KEY,
 12866           DFHEIV99,
 12867           DFHEIV99,
 12868           DFHEIV99
 12869     SET ADDRESS OF MAILING-DATA TO
 12870         DFHEIV20
 12871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12872
 12873
 12874     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12875     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 235
* EL6311.cbl
 12876     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12877
 12878     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12879
 12880
 12881* EXEC CICS DELETE
 12882*        DATASET   (FILE-ID-ERMAIL)
 12883*    END-EXEC.
 12884*    MOVE '&(                    &   #00011934' TO DFHEIV0
 12885     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12886     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12887     MOVE X'2020233030303131393334' TO DFHEIV0(25:11)
 12888     CALL 'kxdfhei1' USING DFHEIV0,
 12889           FILE-ID-ERMAIL,
 12890           DFHEIV99,
 12891           DFHEIV99,
 12892           DFHEIV99,
 12893           DFHEIV99
 12894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12895
 12896
 12897     GO TO 1420-CONTINUE-DELETE.
 12898
 12899 1410-REWRITE-CERT.
 12900     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12901     MOVE 'C'                      TO JP-RECORD-TYPE.
 12902     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12903     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12904
 12905
 12906* EXEC CICS REWRITE
 12907*         DATASET    (FILE-ID-ELCERT)
 12908*         FROM       (CERTIFICATE-MASTER)
 12909*         END-EXEC.
 12910     MOVE LENGTH OF
 12911      CERTIFICATE-MASTER
 12912       TO DFHEIV11
 12913*    MOVE '&& L                  %   #00011946' TO DFHEIV0
 12914     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12915     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12916     MOVE X'2020233030303131393436' TO DFHEIV0(25:11)
 12917     CALL 'kxdfhei1' USING DFHEIV0,
 12918           FILE-ID-ELCERT,
 12919           CERTIFICATE-MASTER,
 12920           DFHEIV11,
 12921           DFHEIV99
 12922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12923
 12924
 12925     PERFORM 8400-LOG-JOURNAL-RECORD.
 12926
 12927 1420-CONTINUE-DELETE.
 12928     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12929     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12930
 12931     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12932     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12933
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 236
* EL6311.cbl
 12934     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12935
 12936 1450-DELETE-PB-RECORD.
 12937     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12938     MOVE 'D'                      TO JP-RECORD-TYPE
 12939     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12940
 12941
 12942* EXEC CICS DELETE
 12943*        DATASET    (FILE-ID-ERPNDB)
 12944*    END-EXEC.
 12945*    MOVE '&(                    &   #00011967' TO DFHEIV0
 12946     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12947     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12948     MOVE X'2020233030303131393637' TO DFHEIV0(25:11)
 12949     CALL 'kxdfhei1' USING DFHEIV0,
 12950           FILE-ID-ERPNDB,
 12951           DFHEIV99,
 12952           DFHEIV99,
 12953           DFHEIV99,
 12954           DFHEIV99
 12955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12956
 12957
 12958     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12959
 12960     PERFORM 8400-LOG-JOURNAL-RECORD.
 12961
 12962     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12963     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12964     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12965
 12966
 12967* EXEC CICS HANDLE CONDITION
 12968*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12969*    END-EXEC.
 12970*    MOVE '"$I                   ! 1 #00011979' TO DFHEIV0
 12971     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12972     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12973     MOVE X'3120233030303131393739' TO DFHEIV0(25:11)
 12974     CALL 'kxdfhei1' USING DFHEIV0
 12975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12976
 12977
 12978
 12979* EXEC CICS READ
 12980*        SET     (ADDRESS OF PENDING-BUSINESS)
 12981*        DATASET (FILE-ID-ERPNDB)
 12982*        RIDFLD  (ERPNDB-KEY)
 12983*        UPDATE
 12984*    END-EXEC.
 12985*    MOVE '&"S        EU         (   #00011983' TO DFHEIV0
 12986     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12987     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12988     MOVE X'2020233030303131393833' TO DFHEIV0(25:11)
 12989     CALL 'kxdfhei1' USING DFHEIV0,
 12990           FILE-ID-ERPNDB,
 12991           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 237
* EL6311.cbl
 12992           DFHEIV99,
 12993           ERPNDB-KEY,
 12994           DFHEIV99,
 12995           DFHEIV99,
 12996           DFHEIV99
 12997     SET ADDRESS OF PENDING-BUSINESS TO
 12998         DFHEIV20
 12999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13000
 13001
 13002     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13003
 13004     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13005
 13006     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13007        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13008        MOVE 'D'                   TO JP-RECORD-TYPE
 13009        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13010
 13011* EXEC CICS DELETE
 13012*            DATASET    (FILE-ID-ERPNDB)
 13013*       END-EXEC
 13014*    MOVE '&(                    &   #00011998' TO DFHEIV0
 13015     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13016     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13017     MOVE X'2020233030303131393938' TO DFHEIV0(25:11)
 13018     CALL 'kxdfhei1' USING DFHEIV0,
 13019           FILE-ID-ERPNDB,
 13020           DFHEIV99,
 13021           DFHEIV99,
 13022           DFHEIV99,
 13023           DFHEIV99
 13024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13025        PERFORM 8400-LOG-JOURNAL-RECORD
 13026     ELSE
 13027        MOVE 'B'                 TO JP-RECORD-TYPE
 13028        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13029        PERFORM 8400-LOG-JOURNAL-RECORD
 13030        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13031        MOVE 'C'                 TO JP-RECORD-TYPE
 13032        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13033
 13034* EXEC CICS REWRITE
 13035*            DATASET    (FILE-ID-ERPNDB)
 13036*            FROM       (PENDING-BUSINESS)
 13037*       END-EXEC
 13038     MOVE LENGTH OF
 13039      PENDING-BUSINESS
 13040       TO DFHEIV11
 13041*    MOVE '&& L                  %   #00012009' TO DFHEIV0
 13042     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13043     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13044     MOVE X'2020233030303132303039' TO DFHEIV0(25:11)
 13045     CALL 'kxdfhei1' USING DFHEIV0,
 13046           FILE-ID-ERPNDB,
 13047           PENDING-BUSINESS,
 13048           DFHEIV11,
 13049           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 238
* EL6311.cbl
 13050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13051        PERFORM 8400-LOG-JOURNAL-RECORD.
 13052
 13053******************************************************************
 13054*                                                                *
 13055*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13056*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13057*                                                                *
 13058******************************************************************
 13059
 13060     IF NOT PI-AR-PROCESSING
 13061        GO TO 1475-DELETE-FINISHED.
 13062
 13063     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13064        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13065        NEXT SENTENCE
 13066     ELSE
 13067        GO TO 1475-DELETE-FINISHED.
 13068
 13069
 13070* EXEC CICS HANDLE CONDITION
 13071*         NOTFND    (1475-DELETE-FINISHED)
 13072*         END-EXEC.
 13073*    MOVE '"$I                   ! 2 #00012031' TO DFHEIV0
 13074     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13075     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13076     MOVE X'3220233030303132303331' TO DFHEIV0(25:11)
 13077     CALL 'kxdfhei1' USING DFHEIV0
 13078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13079
 13080
 13081     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13082     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13083
 13084
 13085* EXEC CICS READ
 13086*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13087*        DATASET (FILE-ID-ERRQST)
 13088*        RIDFLD  (ERRQST-KEY)
 13089*        UPDATE
 13090*    END-EXEC.
 13091*    MOVE '&"S        EU         (   #00012038' TO DFHEIV0
 13092     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13093     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13094     MOVE X'2020233030303132303338' TO DFHEIV0(25:11)
 13095     CALL 'kxdfhei1' USING DFHEIV0,
 13096           FILE-ID-ERRQST,
 13097           DFHEIV20,
 13098           DFHEIV99,
 13099           ERRQST-KEY,
 13100           DFHEIV99,
 13101           DFHEIV99,
 13102           DFHEIV99
 13103     SET ADDRESS OF AR-REQUEST-RECORD TO
 13104         DFHEIV20
 13105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13106
 13107
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 239
* EL6311.cbl
 13108     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13109
 13110     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13111
 13112     MOVE 'D'                      TO JP-RECORD-TYPE.
 13113     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13114
 13115
 13116* EXEC CICS DELETE
 13117*         DATASET    (FILE-ID-ERRQST)
 13118*    END-EXEC.
 13119*    MOVE '&(                    &   #00012052' TO DFHEIV0
 13120     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13121     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13122     MOVE X'2020233030303132303532' TO DFHEIV0(25:11)
 13123     CALL 'kxdfhei1' USING DFHEIV0,
 13124           FILE-ID-ERRQST,
 13125           DFHEIV99,
 13126           DFHEIV99,
 13127           DFHEIV99,
 13128           DFHEIV99
 13129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13130
 13131
 13132     PERFORM 8400-LOG-JOURNAL-RECORD.
 13133
 13134 1475-DELETE-FINISHED.
 13135     MOVE ZEROS                  TO EMI-ERROR.
 13136     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13137     MOVE LOW-VALUES             TO EL631BI.
 13138     MOVE -1                     TO BMAINTL.
 13139     GO TO 8100-SEND-INITIAL-MAP.
 13140
 13141 1480-BATCH-HDR-NOT-FOUND.
 13142     MOVE -1                     TO BMAINTL.
 13143     MOVE ER-7450                TO EMI-ERROR.
 13144     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13145     GO TO 8200-SEND-DATAONLY.
 13146
 13147 1490-RECORD-NOT-FOUND.
 13148     MOVE -1                     TO BMAINTL.
 13149     MOVE ER-7451                TO EMI-ERROR.
 13150     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13151     GO TO 8200-SEND-DATAONLY.
 13152
 13153******************************************************************
 13154*            O V E R   C H A R G E   P R O C E S S I N G         *
 13155******************************************************************
 13156 1500-UPDATE-ERNOTE.
 13157     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13158     MOVE 'A'                    TO WS-NOTE-SW
 13159     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13160     .
 13161 1500-EXIT.
 13162     EXIT.
 13163 1510-ADD-ERNOTE-REC.
 13164
 13165* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 240
* EL6311.cbl
 13166*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13167*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13168*        INITIMG (GETMAIN-SPACE)
 13169*    END-EXEC
 13170*    MOVE ',"IL                  $   #00012088' TO DFHEIV0
 13171     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13172     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13173     MOVE X'2020233030303132303838' TO DFHEIV0(25:11)
 13174     CALL 'kxdfhei1' USING DFHEIV0,
 13175           DFHEIV20,
 13176           ERNOTE-RECORD-LENGTH,
 13177           GETMAIN-SPACE
 13178     SET ADDRESS OF CERTIFICATE-NOTE TO
 13179         DFHEIV20
 13180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13181     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13182                                 TO ERNOTE-KEY
 13183
 13184* EXEC CICS READ
 13185*       DATASET    (FILE-ID-ERNOTE)
 13186*       RIDFLD     (ERNOTE-KEY)
 13187*       INTO       (CERTIFICATE-NOTE)
 13188*       RESP       (WS-RESPONSE)
 13189*       UPDATE
 13190*    END-EXEC
 13191     MOVE LENGTH OF
 13192      CERTIFICATE-NOTE
 13193       TO DFHEIV11
 13194*    MOVE '&"IL       EU         (  N#00012095' TO DFHEIV0
 13195     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13196     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13197     MOVE X'204E233030303132303935' TO DFHEIV0(25:11)
 13198     CALL 'kxdfhei1' USING DFHEIV0,
 13199           FILE-ID-ERNOTE,
 13200           CERTIFICATE-NOTE,
 13201           DFHEIV11,
 13202           ERNOTE-KEY,
 13203           DFHEIV99,
 13204           DFHEIV99,
 13205           DFHEIV99
 13206     MOVE EIBRESP  TO WS-RESPONSE
 13207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13208     IF RESP-NORMAL
 13209        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13210           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13211        END-IF
 13212        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13213           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13214        END-IF
 13215        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13216           (N1 > +10)
 13217           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13218           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13219        END-PERFORM
 13220        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13221          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13222
 13223* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 241
* EL6311.cbl
 13224*            DATASET    (FILE-ID-ERNOTE)
 13225*          END-EXEC
 13226*    MOVE '&*                    #   #00012116' TO DFHEIV0
 13227     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13228     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13229     MOVE X'2020233030303132313136' TO DFHEIV0(25:11)
 13230     CALL 'kxdfhei1' USING DFHEIV0,
 13231           FILE-ID-ERNOTE,
 13232           DFHEIV99
 13233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13234        ELSE
 13235          PERFORM VARYING N1 FROM +1 BY +1
 13236           UNTIL (N1 > +10)
 13237           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13238          END-PERFORM
 13239          IF (N1 < +11)
 13240            IF N1 >= CN-BILLING-START-LINE-NO AND
 13241              N1 <= CN-BILLING-END-LINE-NO
 13242              IF PI-COMPANY-ID = 'DCC'
 13243                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13244              ELSE
 13245                 MOVE WS-VA-NO-COMM-MESS
 13246                                    TO CN-LINE (N1)
 13247              END-IF
 13248            ELSE
 13249              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13250               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13251                IF PI-COMPANY-ID = 'DCC'
 13252                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13253                ELSE
 13254                  MOVE WS-VA-NO-COMM-MESS
 13255                                    TO CN-LINE (N1)
 13256                END-IF
 13257                MOVE N1             TO CN-BILLING-END-LINE-NO
 13258              ELSE
 13259                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13260                  IF PI-COMPANY-ID = 'DCC'
 13261                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13262                  ELSE
 13263                     MOVE WS-VA-NO-COMM-MESS
 13264                                    TO CN-LINE (N1)
 13265                  END-IF
 13266                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13267                                      CN-BILLING-START-LINE-NO
 13268                ELSE
 13269                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13270                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13271                     IF PI-COMPANY-ID = 'DCC'
 13272                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13273                     ELSE
 13274                       MOVE WS-VA-NO-COMM-MESS
 13275                                    TO CN-LINE (N1)
 13276                     END-IF
 13277                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13278                  ELSE
 13279                     PERFORM 1700-SQUEEZE-IT-IN
 13280                                 THRU 1700-EXIT
 13281                  END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 242
* EL6311.cbl
 13282                END-IF
 13283              END-IF
 13284            END-IF
 13285            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13286            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13287            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13288
 13289* EXEC CICS REWRITE
 13290*              DATASET    (FILE-ID-ERNOTE)
 13291*              FROM       (CERTIFICATE-NOTE)
 13292*              RESP       (WS-RESPONSE)
 13293*           END-EXEC
 13294     MOVE LENGTH OF
 13295      CERTIFICATE-NOTE
 13296       TO DFHEIV11
 13297*    MOVE '&& L                  %  N#00012173' TO DFHEIV0
 13298     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13299     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13300     MOVE X'204E233030303132313733' TO DFHEIV0(25:11)
 13301     CALL 'kxdfhei1' USING DFHEIV0,
 13302           FILE-ID-ERNOTE,
 13303           CERTIFICATE-NOTE,
 13304           DFHEIV11,
 13305           DFHEIV99
 13306     MOVE EIBRESP  TO WS-RESPONSE
 13307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13308          END-IF
 13309        END-IF
 13310     ELSE
 13311        MOVE SPACES              TO CERTIFICATE-NOTE
 13312        MOVE 'CN'                TO CN-RECORD-ID
 13313        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13314                                 TO CN-CONTROL-PRIMARY
 13315                                    ERNOTE-KEY
 13316        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13317                                    CN-BILLING-END-LINE-NO
 13318        IF PI-COMPANY-ID = 'DCC'
 13319           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13320        ELSE
 13321           MOVE WS-VA-NO-COMM-MESS
 13322                                 TO CN-LINE (1)
 13323        END-IF
 13324        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13325        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13326        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13327
 13328* EXEC CICS WRITE
 13329*          DATASET    (FILE-ID-ERNOTE)
 13330*          FROM       (CERTIFICATE-NOTE)
 13331*          RIDFLD     (ERNOTE-KEY)
 13332*          RESP       (WS-RESPONSE)
 13333*       END-EXEC
 13334     MOVE LENGTH OF
 13335      CERTIFICATE-NOTE
 13336       TO DFHEIV11
 13337*    MOVE '&$ L                  ''  N#00012197' TO DFHEIV0
 13338     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13339     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 243
* EL6311.cbl
 13340     MOVE X'204E233030303132313937' TO DFHEIV0(25:11)
 13341     CALL 'kxdfhei1' USING DFHEIV0,
 13342           FILE-ID-ERNOTE,
 13343           CERTIFICATE-NOTE,
 13344           DFHEIV11,
 13345           ERNOTE-KEY,
 13346           DFHEIV99,
 13347           DFHEIV99
 13348     MOVE EIBRESP  TO WS-RESPONSE
 13349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13350     END-IF
 13351     .
 13352 1510-EXIT.
 13353     EXIT.
 13354 1520-UPDATE-ELCERT.
 13355     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13356                                 TO ELCERT-KEY
 13357
 13358* EXEC CICS READ
 13359*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13360*        DATASET (FILE-ID-ELCERT)
 13361*        RIDFLD  (ELCERT-KEY)
 13362*        UPDATE
 13363*        RESP    (WS-RESPONSE)
 13364*    END-EXEC
 13365*    MOVE '&"S        EU         (  N#00012210' TO DFHEIV0
 13366     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13367     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13368     MOVE X'204E233030303132323130' TO DFHEIV0(25:11)
 13369     CALL 'kxdfhei1' USING DFHEIV0,
 13370           FILE-ID-ELCERT,
 13371           DFHEIV20,
 13372           DFHEIV99,
 13373           ELCERT-KEY,
 13374           DFHEIV99,
 13375           DFHEIV99,
 13376           DFHEIV99
 13377     SET ADDRESS OF CERTIFICATE-MASTER TO
 13378         DFHEIV20
 13379     MOVE EIBRESP  TO WS-RESPONSE
 13380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13381     IF RESP-NORMAL
 13382        IF WS-NOTE-SW = 'A'
 13383           IF CM-NOTE-SW = ' '
 13384              MOVE '2'             TO CM-NOTE-SW
 13385           ELSE
 13386             IF CM-NOTE-SW = '1'
 13387                MOVE '3'           TO CM-NOTE-SW
 13388             ELSE
 13389               IF CM-NOTE-SW = '4'
 13390                  MOVE '6'         TO CM-NOTE-SW
 13391               ELSE
 13392                 IF CM-NOTE-SW = '5'
 13393                    MOVE '7'       TO CM-NOTE-SW
 13394                 END-IF
 13395               END-IF
 13396             END-IF
 13397           END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 244
* EL6311.cbl
 13398        ELSE
 13399           IF CM-NOTE-SW = '2'
 13400              MOVE ' '             TO CM-NOTE-SW
 13401           ELSE
 13402             IF CM-NOTE-SW = '3'
 13403                MOVE '1'           TO CM-NOTE-SW
 13404             ELSE
 13405               IF CM-NOTE-SW = '6'
 13406                  MOVE '4'         TO CM-NOTE-SW
 13407               ELSE
 13408                 IF CM-NOTE-SW = '7'
 13409                    MOVE '5'       TO CM-NOTE-SW
 13410                 END-IF
 13411               END-IF
 13412             END-IF
 13413           END-IF
 13414        END-IF
 13415
 13416* EXEC CICS REWRITE
 13417*          DATASET    (FILE-ID-ELCERT)
 13418*          FROM       (CERTIFICATE-MASTER)
 13419*          RESP       (WS-RESPONSE)
 13420*       END-EXEC
 13421     MOVE LENGTH OF
 13422      CERTIFICATE-MASTER
 13423       TO DFHEIV11
 13424*    MOVE '&& L                  %  N#00012251' TO DFHEIV0
 13425     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13426     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13427     MOVE X'204E233030303132323531' TO DFHEIV0(25:11)
 13428     CALL 'kxdfhei1' USING DFHEIV0,
 13429           FILE-ID-ELCERT,
 13430           CERTIFICATE-MASTER,
 13431           DFHEIV11,
 13432           DFHEIV99
 13433     MOVE EIBRESP  TO WS-RESPONSE
 13434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13435        IF RESP-NORMAL
 13436           CONTINUE
 13437        ELSE
 13438           MOVE WS-RESPONSE TO EMI-ERROR
 13439           PERFORM 9900-ERROR-FORMAT
 13440                                 THRU 9900-EXIT
 13441           GO TO 8200-SEND-DATAONLY
 13442        END-IF
 13443     ELSE
 13444        MOVE -1                  TO BMAINTL
 13445        MOVE 0249                TO EMI-ERROR
 13446        PERFORM 9900-ERROR-FORMAT
 13447                                 THRU 9900-EXIT
 13448        GO TO 8200-SEND-DATAONLY
 13449     END-IF
 13450     .
 13451 1520-EXIT.
 13452     EXIT.
 13453 1600-UPDATE-ERPYAJ.
 13454     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13455                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 245
* EL6311.cbl
 13456     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13457                                 THRU 1620-EXIT
 13458     .
 13459 1600-EXIT.
 13460     EXIT.
 13461 1610-ADD-ERPYAJ-BANK-REC.
 13462
 13463* EXEC CICS GETMAIN
 13464*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13465*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13466*        INITIMG (GETMAIN-SPACE)
 13467*    END-EXEC
 13468*    MOVE ',"IL                  $   #00012283' TO DFHEIV0
 13469     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13470     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13471     MOVE X'2020233030303132323833' TO DFHEIV0(25:11)
 13472     CALL 'kxdfhei1' USING DFHEIV0,
 13473           DFHEIV20,
 13474           ERPYAJ-RECORD-LENGTH,
 13475           GETMAIN-SPACE
 13476     SET ADDRESS OF PENDING-PAY-ADJ TO
 13477         DFHEIV20
 13478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13479     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13480     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13481     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13482     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13483     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13484     MOVE +10                    TO ERPYAJ-SEQ-NO
 13485     MOVE 'R'                    TO ERPYAJ-TYPE
 13486     IF REVERSAL
 13487        MOVE 'C'                 TO ERPYAJ-TYPE
 13488     END-IF
 13489     MOVE SPACES                 TO PENDING-PAY-ADJ
 13490     MOVE 'PY'                   TO PY-RECORD-ID
 13491     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13492     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13493     IF REVERSAL
 13494        MOVE PB-I-DCC-OVER-CHG-AMT
 13495                                 TO PY-ENTRY-AMT
 13496     END-IF
 13497     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13498                                    PY-INPUT-DT
 13499*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13500*                                   PY-INPUT-DT
 13501     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13502     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13503     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13504     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13505     IF PB-CARRIER = '2'
 13506        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13507     ELSE
 13508        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13509     END-IF
 13510     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13511                                    PY-BILLED-DATE
 13512                                    PY-AR-DATE
 13513                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 246
* EL6311.cbl
 13514                                    PY-CHECK-WRITTEN-DT
 13515     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13516                                    PY-CHECK-QUE-SEQUENCE
 13517     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13518     PERFORM WITH TEST AFTER
 13519        UNTIL (NOT RESP-DUPKEY)
 13520           AND (NOT RESP-DUPREC)
 13521
 13522* EXEC CICS WRITE
 13523*          DATASET    (FILE-ID-ERPYAJ)
 13524*          FROM       (PENDING-PAY-ADJ)
 13525*          RIDFLD     (ERPYAJ-KEY)
 13526*          RESP       (WS-RESPONSE)
 13527*       END-EXEC
 13528     MOVE LENGTH OF
 13529      PENDING-PAY-ADJ
 13530       TO DFHEIV11
 13531*    MOVE '&$ L                  ''  N#00012330' TO DFHEIV0
 13532     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13533     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13534     MOVE X'204E233030303132333330' TO DFHEIV0(25:11)
 13535     CALL 'kxdfhei1' USING DFHEIV0,
 13536           FILE-ID-ERPYAJ,
 13537           PENDING-PAY-ADJ,
 13538           DFHEIV11,
 13539           ERPYAJ-KEY,
 13540           DFHEIV99,
 13541           DFHEIV99
 13542     MOVE EIBRESP  TO WS-RESPONSE
 13543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13544        IF RESP-DUPKEY OR RESP-DUPREC
 13545           ADD +1                TO ERPYAJ-SEQ-NO
 13546           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13547        END-IF
 13548     END-PERFORM
 13549     .
 13550 1610-EXIT.
 13551     EXIT.
 13552 1620-ADD-ERPYAJ-DLR-REC.
 13553     MOVE 'C'                    TO ERPYAJ-TYPE
 13554     IF REVERSAL
 13555        MOVE 'R'                 TO ERPYAJ-TYPE
 13556     END-IF
 13557     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13558                                    ERPYAJ-ACCOUNT
 13559     ADD +1                      TO ERPYAJ-SEQ-NO
 13560     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13561     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13562     IF PB-CARRIER = '2'
 13563        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13564     ELSE
 13565        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13566     END-IF
 13567     PERFORM WITH TEST AFTER
 13568        UNTIL (NOT RESP-DUPKEY)
 13569           AND (NOT RESP-DUPREC)
 13570
 13571* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 247
* EL6311.cbl
 13572*          DATASET    (FILE-ID-ERPYAJ)
 13573*          FROM       (PENDING-PAY-ADJ)
 13574*          RIDFLD     (ERPYAJ-KEY)
 13575*          RESP       (WS-RESPONSE)
 13576*       END-EXEC
 13577     MOVE LENGTH OF
 13578      PENDING-PAY-ADJ
 13579       TO DFHEIV11
 13580*    MOVE '&$ L                  ''  N#00012362' TO DFHEIV0
 13581     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13582     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13583     MOVE X'204E233030303132333632' TO DFHEIV0(25:11)
 13584     CALL 'kxdfhei1' USING DFHEIV0,
 13585           FILE-ID-ERPYAJ,
 13586           PENDING-PAY-ADJ,
 13587           DFHEIV11,
 13588           ERPYAJ-KEY,
 13589           DFHEIV99,
 13590           DFHEIV99
 13591     MOVE EIBRESP  TO WS-RESPONSE
 13592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13593        IF RESP-DUPKEY OR RESP-DUPREC
 13594           ADD +1                TO ERPYAJ-SEQ-NO
 13595           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13596        END-IF
 13597     END-PERFORM
 13598     .
 13599 1620-EXIT.
 13600     EXIT.
 13601 1700-SQUEEZE-IT-IN.
 13602     IF (N1 > CN-BILLING-END-LINE-NO)
 13603        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13604           N1 = +1
 13605           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13606           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13607              IF PI-COMPANY-ID = 'DCC'
 13608                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13609              ELSE
 13610                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13611              END-IF
 13612              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13613              MOVE +2 TO N1
 13614           END-IF
 13615        END-PERFORM
 13616     ELSE
 13617        IF (N1 < CN-BILLING-START-LINE-NO)
 13618           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13619              N1 = +10
 13620              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13621              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13622                 IF PI-COMPANY-ID = 'DCC'
 13623                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13624                 ELSE
 13625                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13626                 END-IF
 13627                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13628                 MOVE +9 TO N1
 13629              END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 248
* EL6311.cbl
 13630           END-PERFORM
 13631        END-IF
 13632     END-IF
 13633     .
 13634 1700-EXIT.
 13635     EXIT.
 13636 1800-REMOVE-CERT-NOTES.
 13637     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13638                                 TO ERNOTE-KEY
 13639
 13640* EXEC CICS READ
 13641*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13642*       DATASET    (FILE-ID-ERNOTE)
 13643*       RIDFLD     (ERNOTE-KEY)
 13644*       RESP       (WS-RESPONSE)
 13645*       UPDATE
 13646*    END-EXEC
 13647*    MOVE '&"S        EU         (  N#00012414' TO DFHEIV0
 13648     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13649     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13650     MOVE X'204E233030303132343134' TO DFHEIV0(25:11)
 13651     CALL 'kxdfhei1' USING DFHEIV0,
 13652           FILE-ID-ERNOTE,
 13653           DFHEIV20,
 13654           DFHEIV99,
 13655           ERNOTE-KEY,
 13656           DFHEIV99,
 13657           DFHEIV99,
 13658           DFHEIV99
 13659     SET ADDRESS OF CERTIFICATE-NOTE TO
 13660         DFHEIV20
 13661     MOVE EIBRESP  TO WS-RESPONSE
 13662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13663     IF RESP-NORMAL
 13664        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13665           (N1 > +10)
 13666           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13667           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13668        END-PERFORM
 13669        IF N1 < +11
 13670           MOVE SPACES              TO CN-LINE (N1)
 13671           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13672              N1 <= CN-BILLING-END-LINE-NO
 13673              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13674              IF CN-BILLING-END-LINE-NO <
 13675                               CN-BILLING-START-LINE-NO
 13676                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13677                                     CN-BILLING-START-LINE-NO
 13678              END-IF
 13679              PERFORM 1820-SQUEEZE-ERNOTE
 13680                                  THRU 1820-EXIT
 13681           END-IF
 13682           IF CN-LINES = SPACES
 13683
 13684* EXEC CICS DELETE
 13685*                DATASET    (FILE-ID-ERNOTE)
 13686*                RESP       (WS-RESPONSE)
 13687*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 249
* EL6311.cbl
 13688*    MOVE '&(                    &  N#00012441' TO DFHEIV0
 13689     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13690     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13691     MOVE X'204E233030303132343431' TO DFHEIV0(25:11)
 13692     CALL 'kxdfhei1' USING DFHEIV0,
 13693           FILE-ID-ERNOTE,
 13694           DFHEIV99,
 13695           DFHEIV99,
 13696           DFHEIV99,
 13697           DFHEIV99
 13698     MOVE EIBRESP  TO WS-RESPONSE
 13699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13700              IF RESP-NORMAL
 13701                 MOVE 'D'        TO WS-NOTE-SW
 13702                 PERFORM 1520-UPDATE-ELCERT
 13703                                 THRU 1520-EXIT
 13704              END-IF
 13705           ELSE
 13706
 13707* EXEC CICS REWRITE
 13708*                DATASET    (FILE-ID-ERNOTE)
 13709*                FROM       (CERTIFICATE-NOTE)
 13710*                RESP       (WS-RESPONSE)
 13711*             END-EXEC
 13712     MOVE LENGTH OF
 13713      CERTIFICATE-NOTE
 13714       TO DFHEIV11
 13715*    MOVE '&& L                  %  N#00012451' TO DFHEIV0
 13716     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13717     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13718     MOVE X'204E233030303132343531' TO DFHEIV0(25:11)
 13719     CALL 'kxdfhei1' USING DFHEIV0,
 13720           FILE-ID-ERNOTE,
 13721           CERTIFICATE-NOTE,
 13722           DFHEIV11,
 13723           DFHEIV99
 13724     MOVE EIBRESP  TO WS-RESPONSE
 13725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13726           END-IF
 13727        END-IF
 13728     END-IF
 13729     .
 13730 1800-EXIT.
 13731     EXIT.
 13732 1820-SQUEEZE-ERNOTE.
 13733     MOVE CN-BILLING-START-LINE-NO TO N2
 13734     IF N2 = 0
 13735         MOVE +1                 TO N2
 13736     END-IF
 13737     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13738        (N1 > +9)
 13739        IF CN-LINE (N1) = SPACES
 13740           MOVE CN-LINE (N1 + +1)
 13741                                 TO CN-LINE (N1)
 13742           MOVE SPACES           TO CN-LINE (N1 + +1)
 13743        END-IF
 13744     END-PERFORM
 13745     .
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 250
* EL6311.cbl
 13746 1820-EXIT.
 13747     EXIT.
 13748 1900-DELETE-ERPYAJ.
 13749     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13750     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13751     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13752     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13753     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13754     MOVE +10                    TO ERPYAJ-SEQ-NO
 13755     MOVE 'R'                    TO ERPYAJ-TYPE
 13756     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13757
 13758* EXEC CICS STARTBR
 13759*       DATASET    (FILE-ID-ERPYAJ)
 13760*       RIDFLD     (ERPYAJ-KEY)
 13761*       RESP       (WS-RESPONSE)
 13762*    END-EXEC
 13763     MOVE 0
 13764       TO DFHEIV11
 13765*    MOVE '&,         G          &  N#00012487' TO DFHEIV0
 13766     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13767     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13768     MOVE X'204E233030303132343837' TO DFHEIV0(25:11)
 13769     CALL 'kxdfhei1' USING DFHEIV0,
 13770           FILE-ID-ERPYAJ,
 13771           ERPYAJ-KEY,
 13772           DFHEIV99,
 13773           DFHEIV11,
 13774           DFHEIV99
 13775     MOVE EIBRESP  TO WS-RESPONSE
 13776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13777     IF RESP-NORMAL
 13778        CONTINUE
 13779     ELSE
 13780        GO TO 1900-GET-DEALER
 13781     END-IF
 13782     .
 13783 1900-READNEXT-ERPYAJ-B.
 13784*  GET THE BANK ERPYAJ RECORD
 13785
 13786* EXEC CICS READNEXT
 13787*       DATASET    (FILE-ID-ERPYAJ)
 13788*       RIDFLD     (ERPYAJ-KEY)
 13789*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13790*       RESP       (WS-RESPONSE)
 13791*    END-EXEC
 13792     MOVE 0
 13793       TO DFHEIV11
 13794*    MOVE '&.S                   )  N#00012500' TO DFHEIV0
 13795     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13796     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13797     MOVE X'204E233030303132353030' TO DFHEIV0(25:11)
 13798     CALL 'kxdfhei1' USING DFHEIV0,
 13799           FILE-ID-ERPYAJ,
 13800           DFHEIV20,
 13801           DFHEIV99,
 13802           ERPYAJ-KEY,
 13803           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 251
* EL6311.cbl
 13804           DFHEIV11,
 13805           DFHEIV99,
 13806           DFHEIV99
 13807     SET ADDRESS OF PENDING-PAY-ADJ TO
 13808         DFHEIV20
 13809     MOVE EIBRESP  TO WS-RESPONSE
 13810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13811     IF RESP-NORMAL
 13812        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13813           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13814              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13815                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13816
 13817* EXEC CICS READ
 13818*                   DATASET    (FILE-ID-ERPYAJ)
 13819*                   RIDFLD     (ERPYAJ-KEY)
 13820*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13821*                   RESP       (WS-RESPONSE)
 13822*                   UPDATE
 13823*                END-EXEC
 13824*    MOVE '&"S        EU         (  N#00012511' TO DFHEIV0
 13825     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13826     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13827     MOVE X'204E233030303132353131' TO DFHEIV0(25:11)
 13828     CALL 'kxdfhei1' USING DFHEIV0,
 13829           FILE-ID-ERPYAJ,
 13830           DFHEIV20,
 13831           DFHEIV99,
 13832           ERPYAJ-KEY,
 13833           DFHEIV99,
 13834           DFHEIV99,
 13835           DFHEIV99
 13836     SET ADDRESS OF PENDING-PAY-ADJ TO
 13837         DFHEIV20
 13838     MOVE EIBRESP  TO WS-RESPONSE
 13839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13840                 IF RESP-NORMAL
 13841
 13842* EXEC CICS DELETE
 13843*                      DATASET   (FILE-ID-ERPYAJ)
 13844*                      RESP      (WS-RESPONSE)
 13845*                   END-EXEC
 13846*    MOVE '&(                    &  N#00012519' TO DFHEIV0
 13847     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13848     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13849     MOVE X'204E233030303132353139' TO DFHEIV0(25:11)
 13850     CALL 'kxdfhei1' USING DFHEIV0,
 13851           FILE-ID-ERPYAJ,
 13852           DFHEIV99,
 13853           DFHEIV99,
 13854           DFHEIV99,
 13855           DFHEIV99
 13856     MOVE EIBRESP  TO WS-RESPONSE
 13857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13858                 END-IF
 13859              ELSE
 13860                 SET REVERSAL    TO TRUE
 13861                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 252
* EL6311.cbl
 13862                                 THRU 1600-EXIT
 13863                 GO TO 1900-EXIT
 13864              END-IF
 13865           ELSE
 13866              GO TO 1900-READNEXT-ERPYAJ-B
 13867           END-IF
 13868        END-IF
 13869
 13870* EXEC CICS ENDBR
 13871*          DATASET   (FILE-ID-ERPYAJ)
 13872*       END-EXEC
 13873     MOVE 0
 13874       TO DFHEIV11
 13875*    MOVE '&2                    $   #00012534' TO DFHEIV0
 13876     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13877     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13878     MOVE X'2020233030303132353334' TO DFHEIV0(25:11)
 13879     CALL 'kxdfhei1' USING DFHEIV0,
 13880           FILE-ID-ERPYAJ,
 13881           DFHEIV11,
 13882           DFHEIV99
 13883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13884     END-IF
 13885     .
 13886 1900-GET-DEALER.
 13887     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13888     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13889     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13890     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13891     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13892     MOVE +10                    TO ERPYAJ-SEQ-NO
 13893     MOVE 'C'                    TO ERPYAJ-TYPE
 13894     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13895
 13896* EXEC CICS STARTBR
 13897*       DATASET    (FILE-ID-ERPYAJ)
 13898*       RIDFLD     (ERPYAJ-KEY)
 13899*       RESP       (WS-RESPONSE)
 13900*    END-EXEC
 13901     MOVE 0
 13902       TO DFHEIV11
 13903*    MOVE '&,         G          &  N#00012548' TO DFHEIV0
 13904     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13905     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13906     MOVE X'204E233030303132353438' TO DFHEIV0(25:11)
 13907     CALL 'kxdfhei1' USING DFHEIV0,
 13908           FILE-ID-ERPYAJ,
 13909           ERPYAJ-KEY,
 13910           DFHEIV99,
 13911           DFHEIV11,
 13912           DFHEIV99
 13913     MOVE EIBRESP  TO WS-RESPONSE
 13914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13915     IF RESP-NORMAL
 13916        CONTINUE
 13917     ELSE
 13918        GO TO 1900-EXIT
 13919     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 253
* EL6311.cbl
 13920     .
 13921 1900-READNEXT-ERPYAJ-D.
 13922*  GET THE DEALER ERPYAJ RECORD
 13923
 13924* EXEC CICS READNEXT
 13925*       DATASET    (FILE-ID-ERPYAJ)
 13926*       RIDFLD     (ERPYAJ-KEY)
 13927*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13928*       RESP       (WS-RESPONSE)
 13929*    END-EXEC
 13930     MOVE 0
 13931       TO DFHEIV11
 13932*    MOVE '&.S                   )  N#00012561' TO DFHEIV0
 13933     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13934     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13935     MOVE X'204E233030303132353631' TO DFHEIV0(25:11)
 13936     CALL 'kxdfhei1' USING DFHEIV0,
 13937           FILE-ID-ERPYAJ,
 13938           DFHEIV20,
 13939           DFHEIV99,
 13940           ERPYAJ-KEY,
 13941           DFHEIV99,
 13942           DFHEIV11,
 13943           DFHEIV99,
 13944           DFHEIV99
 13945     SET ADDRESS OF PENDING-PAY-ADJ TO
 13946         DFHEIV20
 13947     MOVE EIBRESP  TO WS-RESPONSE
 13948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13949     IF RESP-NORMAL
 13950        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13951           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13952              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13953                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13954
 13955* EXEC CICS READ
 13956*                   DATASET    (FILE-ID-ERPYAJ)
 13957*                   RIDFLD     (ERPYAJ-KEY)
 13958*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13959*                   RESP       (WS-RESPONSE)
 13960*                   UPDATE
 13961*                END-EXEC
 13962*    MOVE '&"S        EU         (  N#00012572' TO DFHEIV0
 13963     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13964     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13965     MOVE X'204E233030303132353732' TO DFHEIV0(25:11)
 13966     CALL 'kxdfhei1' USING DFHEIV0,
 13967           FILE-ID-ERPYAJ,
 13968           DFHEIV20,
 13969           DFHEIV99,
 13970           ERPYAJ-KEY,
 13971           DFHEIV99,
 13972           DFHEIV99,
 13973           DFHEIV99
 13974     SET ADDRESS OF PENDING-PAY-ADJ TO
 13975         DFHEIV20
 13976     MOVE EIBRESP  TO WS-RESPONSE
 13977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 254
* EL6311.cbl
 13978                 IF RESP-NORMAL
 13979
 13980* EXEC CICS DELETE
 13981*                      DATASET   (FILE-ID-ERPYAJ)
 13982*                      RESP      (WS-RESPONSE)
 13983*                   END-EXEC
 13984*    MOVE '&(                    &  N#00012580' TO DFHEIV0
 13985     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13986     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13987     MOVE X'204E233030303132353830' TO DFHEIV0(25:11)
 13988     CALL 'kxdfhei1' USING DFHEIV0,
 13989           FILE-ID-ERPYAJ,
 13990           DFHEIV99,
 13991           DFHEIV99,
 13992           DFHEIV99,
 13993           DFHEIV99
 13994     MOVE EIBRESP  TO WS-RESPONSE
 13995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13996                 END-IF
 13997              ELSE
 13998                 SET REVERSAL    TO TRUE
 13999              END-IF
 14000           ELSE
 14001              GO TO 1900-READNEXT-ERPYAJ-D
 14002           END-IF
 14003        END-IF
 14004
 14005* EXEC CICS ENDBR
 14006*          DATASET   (FILE-ID-ERPYAJ)
 14007*       END-EXEC
 14008     MOVE 0
 14009       TO DFHEIV11
 14010*    MOVE '&2                    $   #00012592' TO DFHEIV0
 14011     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14012     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14013     MOVE X'2020233030303132353932' TO DFHEIV0(25:11)
 14014     CALL 'kxdfhei1' USING DFHEIV0,
 14015           FILE-ID-ERPYAJ,
 14016           DFHEIV11,
 14017           DFHEIV99
 14018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14019     END-IF
 14020     .
 14021 1900-EXIT.
 14022     EXIT.
 14023******************************************************************
 14024*            C A N C E L   M A I N L I N E                       *
 14025******************************************************************
 14026
 14027 2000-CANCEL-MAINLINE.
 14028     IF PI-DISPLAY-ORIGINAL-BATCH
 14029        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14030           MOVE ER-0023             TO EMI-ERROR
 14031           MOVE -1                  TO CMAINTL
 14032           MOVE AL-UABON            TO CMAINTA
 14033           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14034           GO TO 8200-SEND-DATAONLY
 14035        ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 255
* EL6311.cbl
 14036           NEXT SENTENCE
 14037     ELSE
 14038        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14039           MOVE ER-0023             TO EMI-ERROR
 14040           MOVE -1                  TO CMAINTL
 14041           MOVE AL-UABON            TO CMAINTA
 14042           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14043           GO TO 8200-SEND-DATAONLY.
 14044
 14045     IF CMAINTI = 'S'
 14046        GO TO 2100-SHOW-REQUEST.
 14047
 14048     IF NOT MODIFY-CAP
 14049         MOVE 'UPDATE'       TO SM-READ
 14050         PERFORM 9995-SECURITY-VIOLATION
 14051         MOVE ER-0070        TO EMI-ERROR
 14052         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14053         GO TO 8100-SEND-INITIAL-MAP.
 14054
 14055     IF CMAINTL GREATER THAN ZEROS
 14056        IF PI-PF6-FUNCTION
 14057           IF CMAINTI NOT = 'A'
 14058              MOVE AL-UABON  TO CMAINTA
 14059              MOVE -1        TO CMAINTL
 14060              MOVE ER-2260   TO EMI-ERROR
 14061              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14062              GO TO 8200-SEND-DATAONLY.
 14063
 14064     IF CCERTNOL = ZEROS
 14065       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14066         NEXT SENTENCE
 14067     ELSE
 14068         IF CCERTNOL NOT = ZEROS
 14069             MOVE AL-UANON       TO CCERTNOA
 14070         ELSE
 14071             MOVE -1             TO CCERTNOL
 14072             MOVE  1             TO SET-CURSOR-SW
 14073             MOVE ER-2218       TO EMI-ERROR
 14074             MOVE AL-UABON       TO CCERTNOA
 14075             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14076
 14077     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14078        NEXT SENTENCE
 14079     ELSE
 14080        IF CEFFDTL NOT = ZEROS
 14081           MOVE AL-UNNON         TO CEFFDTA
 14082           MOVE CEFFDTI TO DEEDIT-FIELD
 14083           PERFORM 8600-DEEDIT
 14084           MOVE 4                TO DC-OPTION-CODE
 14085           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14086           PERFORM 9700-DATE-LINK
 14087           IF NO-CONVERSION-ERROR
 14088              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14089              ELSE
 14090              MOVE -1            TO CEFFDTL
 14091              MOVE  1            TO SET-CURSOR-SW
 14092              MOVE ER-2226      TO EMI-ERROR
 14093              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 256
* EL6311.cbl
 14094              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14095          ELSE
 14096          MOVE -1                 TO CEFFDTL
 14097          MOVE  1                 TO SET-CURSOR-SW
 14098          MOVE ER-2220            TO EMI-ERROR
 14099          MOVE AL-UNBON           TO CEFFDTA
 14100          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14101
 14102     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14103
 14104     IF CCERTNOL NOT = ZEROS
 14105        MOVE CCERTNOI                TO WS-NEW-PRIME
 14106     ELSE
 14107        MOVE SPACES                  TO WS-NEW-PRIME.
 14108
 14109     IF CSUFIXL NOT = ZEROS
 14110        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14111     ELSE
 14112        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14113
 14114     IF CEFFDTL NOT = ZEROS
 14115        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14116     ELSE
 14117        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14118
 14119     IF CMAINTI = 'A' OR 'K' OR 'S'
 14120        NEXT SENTENCE
 14121     ELSE
 14122        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14123        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14124           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14125           WS-PB-RECORD-TYPE NOT = '2'
 14126           IF CMAINTI = 'C'
 14127              MOVE ER-2287          TO EMI-ERROR
 14128              MOVE -1               TO CCERTNOL
 14129              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14130              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14131              GO TO 8200-SEND-DATAONLY
 14132             ELSE
 14133              MOVE ER-2260          TO EMI-ERROR
 14134              MOVE -1               TO CCERTNOL
 14135              MOVE AL-UABON         TO CCERTNOA
 14136              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14137              GO TO 8200-SEND-DATAONLY.
 14138
 14139     IF CMAINTI = 'D'
 14140        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14141
 14142     IF CLSTNML GREATER THAN ZEROS
 14143         MOVE AL-UANON           TO CLSTNMA.
 14144
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 257
* EL6311.cbl
 14146
 14147******************************************************************
 14148*                                                                *
 14149*           E D I T   C A N C E L   C O V E R A G E S            *
 14150*                                                                *
 14151******************************************************************
 14152
 14153 2015-EDIT-COVERAGES.
 14154     IF CCANDT1L      GREATER THAN ZEROS OR
 14155        CREFND1L      GREATER THAN ZEROS OR
 14156        CCANDT2L      GREATER THAN ZEROS OR
 14157        CREFND2L      GREATER THAN ZEROS OR
 14158        CMTHD1L       GREATER THAN ZEROS OR
 14159        CMTHD2L       GREATER THAN ZEROS OR
 14160        CLIVESL       GREATER THAN ZEROS OR
 14161        CPAYEEL       GREATER THAN ZEROS OR
 14162        CFORCEL       GREATER THAN ZEROS OR
 14163        CBILCDL       GREATER THAN ZEROS OR
 14164        CCANREAL      GREATER THAN ZEROS
 14165            NEXT SENTENCE
 14166         ELSE
 14167            GO TO 2030-EDIT-COMPLETE.
 14168
 14169     IF CCANDT1L = ZEROS
 14170        AND (CMAINTI = 'C' OR 'K')
 14171        NEXT SENTENCE
 14172     ELSE
 14173        IF CCANDT1L      GREATER THAN ZEROS
 14174            MOVE AL-UNNON            TO CCANDT1A
 14175            IF CCANDT1I = SPACES
 14176               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14177            ELSE
 14178               MOVE CCANDT1I            TO DEEDIT-FIELD
 14179               PERFORM 8600-DEEDIT
 14180               IF DEEDIT-FIELD-V0   NUMERIC
 14181                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14182                  MOVE 4                TO DC-OPTION-CODE
 14183                  PERFORM 9700-DATE-LINK
 14184                  IF NO-CONVERSION-ERROR
 14185                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14186                  ELSE
 14187                      MOVE -1        TO CCANDT1L
 14188                      MOVE ER-2227   TO EMI-ERROR
 14189                      MOVE AL-UNBON  TO CCANDT1A
 14190                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14191               ELSE
 14192                  MOVE -1         TO CCANDT1L
 14193                  MOVE ER-2223    TO EMI-ERROR
 14194                  MOVE AL-UNBON   TO CCANDT1A
 14195                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14196        ELSE
 14197            IF CREFND1L GREATER THAN ZEROS
 14198               MOVE -1             TO CCANDT1L
 14199               MOVE ER-2222        TO EMI-ERROR
 14200               MOVE AL-UNBOF       TO CCANDT1A
 14201               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14202
 14203     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 258
* EL6311.cbl
 14204        AND (CMAINTI = 'C' OR 'K')
 14205         NEXT SENTENCE
 14206     ELSE
 14207         IF CREFND1L NOT = ZEROS
 14208            MOVE AL-UNNON        TO CREFND1A
 14209
 14210* EXEC CICS BIF DEEDIT
 14211*               FIELD  (CREFND1I)
 14212*               LENGTH (11)
 14213*           END-EXEC
 14214     MOVE 11
 14215       TO DFHEIV11
 14216*    MOVE '@"L                   #   #00012785' TO DFHEIV0
 14217     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14218     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14219     MOVE X'2020233030303132373835' TO DFHEIV0(25:11)
 14220     CALL 'kxdfhei1' USING DFHEIV0,
 14221           CREFND1I,
 14222           DFHEIV11
 14223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14224            MOVE CREFND1I        TO WS-CREFND1
 14225*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14226*           PERFORM 8600-DEEDIT
 14227*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14228            IF WS-CREFND1  = ZEROS
 14229               AND CMAINTI = 'A'
 14230             MOVE ER-2437        TO EMI-ERROR
 14231             MOVE -1             TO CREFND1L
 14232             MOVE AL-UNBON       TO CREFND1A
 14233             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14234
 14235     IF CCANREAL > +0
 14236        MOVE AL-UANON            TO CCANREAA
 14237        IF CCANREAI = 'R' OR ' '
 14238           CONTINUE
 14239        ELSE
 14240           MOVE ER-9841        TO EMI-ERROR
 14241           MOVE -1             TO CCANREAL
 14242           MOVE AL-UABON       TO CCANREAA
 14243           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14244        END-IF
 14245     END-IF
 14246     IF CMTHD1L EQUAL +0
 14247        NEXT SENTENCE
 14248     ELSE
 14249        IF CMTHD1L NOT = +0
 14250           MOVE AL-UNNON        TO CMTHD1A
 14251           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14252                         OR '5' OR '6' OR '8' OR '9'
 14253                         OR 'R' OR ' '
 14254              NEXT SENTENCE
 14255           ELSE
 14256              MOVE ER-0582        TO EMI-ERROR
 14257              MOVE -1             TO CMTHD1L
 14258              MOVE AL-UNBON       TO CMTHD1A
 14259              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14260
 14261     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 259
* EL6311.cbl
 14262        AND (CMAINTI = 'C' OR 'K')
 14263         NEXT SENTENCE
 14264     ELSE
 14265         IF CCANDT2L  GREATER THAN ZEROS
 14266             MOVE AL-UNNON       TO CCANDT2A
 14267             IF CCANDT2I = SPACES
 14268                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14269             ELSE
 14270                MOVE CCANDT2I       TO DEEDIT-FIELD
 14271                PERFORM 8600-DEEDIT
 14272                IF DEEDIT-FIELD-V0   NUMERIC
 14273                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14274                   MOVE 4                TO DC-OPTION-CODE
 14275                   PERFORM 9700-DATE-LINK
 14276                   IF NO-CONVERSION-ERROR
 14277                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14278                   ELSE
 14279                      MOVE -1       TO CCANDT2L
 14280                      MOVE ER-2227  TO EMI-ERROR
 14281                      MOVE AL-UNBON TO CCANDT2A
 14282                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14283                ELSE
 14284                   MOVE -1         TO CCANDT2L
 14285                   MOVE ER-2223    TO EMI-ERROR
 14286                   MOVE AL-UNBON   TO CCANDT2A
 14287                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14288         ELSE
 14289            IF CREFND2L GREATER THAN ZEROS
 14290               MOVE -1             TO CCANDT2L
 14291               MOVE ER-2222        TO EMI-ERROR
 14292               MOVE AL-UNBOF       TO CCANDT2A
 14293               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14294
 14295     IF CREFND2L = ZEROS
 14296        AND (CMAINTI = 'C' OR 'K')
 14297         NEXT SENTENCE
 14298     ELSE
 14299         IF CREFND2L NOT = ZEROS
 14300            MOVE AL-UNNON        TO CREFND2A
 14301
 14302* EXEC CICS BIF DEEDIT
 14303*               FIELD  (CREFND2I)
 14304*               LENGTH (11)
 14305*           END-EXEC
 14306     MOVE 11
 14307       TO DFHEIV11
 14308*    MOVE '@"L                   #   #00012866' TO DFHEIV0
 14309     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14310     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14311     MOVE X'2020233030303132383636' TO DFHEIV0(25:11)
 14312     CALL 'kxdfhei1' USING DFHEIV0,
 14313           CREFND2I,
 14314           DFHEIV11
 14315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14316            MOVE CREFND2I        TO WS-CREFND2
 14317*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14318*           PERFORM 8600-DEEDIT
 14319*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 260
* EL6311.cbl
 14320            IF WS-CREFND2  = ZEROS
 14321               AND CMAINTI = 'A'
 14322             MOVE ER-2437        TO EMI-ERROR
 14323             MOVE -1             TO CREFND2L
 14324             MOVE AL-UNBON       TO CREFND2A
 14325             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14326
 14327     IF CMTHD2L EQUAL +0
 14328        NEXT SENTENCE
 14329     ELSE
 14330        IF CMTHD2L NOT = +0
 14331           MOVE AL-UNNON        TO CMTHD2A
 14332           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14333                         OR '5' OR '6' OR '8' OR '9'
 14334                         OR ' ' OR 'R'
 14335              NEXT SENTENCE
 14336           ELSE
 14337              MOVE ER-0582        TO EMI-ERROR
 14338              MOVE -1             TO CMTHD2L
 14339              MOVE AL-UNBON       TO CMTHD2A
 14340              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14341
 14342     IF CLIVESL GREATER THAN ZEROS
 14343         MOVE CLIVESI            TO DEEDIT-FIELD
 14344         PERFORM 8600-DEEDIT
 14345         IF DEEDIT-FIELD-V0 NUMERIC
 14346             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14347             MOVE AL-UNNON       TO CLIVESA
 14348         ELSE
 14349             MOVE -1             TO CLIVESL
 14350             MOVE AL-UNBON       TO CLIVESA
 14351             MOVE ER-2223        TO EMI-ERROR
 14352             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14353
 14354     IF CFORCEL  NOT = ZEROS
 14355         IF FORCE-CAP
 14356            MOVE AL-UANON            TO CFORCEA
 14357         ELSE
 14358            MOVE ER-2945             TO EMI-ERROR
 14359            MOVE AL-UABON            TO CFORCEA
 14360            MOVE -1                  TO CFORCEL
 14361            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14362
 14363     IF CPAYEEL GREATER THAN ZEROS
 14364        MOVE AL-UANON            TO CPAYEEA.
 14365
 14366     IF CBILCDL NOT = ZEROS
 14367        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14368                             AND 'A' AND 'B' AND 'E'
 14369           MOVE ER-2225              TO EMI-ERROR
 14370           MOVE AL-UABON             TO CBILCDA
 14371           MOVE -1                   TO CBILCDL
 14372           MOVE  1                   TO SET-CURSOR-SW
 14373           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14374        ELSE
 14375           MOVE AL-UANON             TO CBILCDA.
 14376
 14377 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 261
* EL6311.cbl
 14378     IF EMI-ERROR = ZEROS
 14379         NEXT SENTENCE
 14380     ELSE
 14381         GO TO 8200-SEND-DATAONLY.
 14382
 14383     IF CMAINTI = 'A'
 14384        GO TO 2200-ADD-CANCEL-ROUTINE.
 14385
 14386     IF CMAINTI = 'C'
 14387        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14388
 14389     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14390
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 262
* EL6311.cbl
 14392
 14393******************************************************************
 14394*                                                                *
 14395*                   S H O W   C A N C E L                        *
 14396*                                                                *
 14397******************************************************************
 14398
 14399 2100-SHOW-REQUEST.
 14400     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14401
 14402     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14403        MOVE -1                  TO CMAINTL
 14404        GO TO 8200-SEND-DATAONLY.
 14405
 14406     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14407
 14408     IF CSUFIXL NOT = ZEROS
 14409        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14410       ELSE
 14411        MOVE SPACE            TO WS-NEW-SUFFIX.
 14412
 14413     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14414     PERFORM 8600-DEEDIT.
 14415     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14416     MOVE '4'                    TO DC-OPTION-CODE.
 14417     PERFORM 9700-DATE-LINK.
 14418     IF DATE-CONVERSION-ERROR
 14419        MOVE ER-0348             TO EMI-ERROR
 14420        MOVE -1                  TO CEFFDTL
 14421        MOVE AL-UABON            TO CEFFDTA
 14422        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14423        GO TO 8200-SEND-DATAONLY
 14424     ELSE
 14425        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14426        MOVE AL-UANON            TO CEFFDTA
 14427        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14428
 14429     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14430
 14431     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14432        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14433        MOVE 'Y'                    TO WS-SHOW-SW
 14434        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14435           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14436        ELSE
 14437           IF PI-FILE-BROWSE
 14438              GO TO 4300-BROWSE-FILE-FORWARD
 14439           ELSE
 14440              IF PI-CSR-BROWSE
 14441                 GO TO 4200-BROWSE-CSR-FORWARD
 14442              ELSE
 14443                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14444     ELSE
 14445        GO TO 3900-RE-DISPLAY-RECORD.
 14446
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 263
* EL6311.cbl
 14448
 14449
 14450******************************************************************
 14451*                                                                *
 14452*            A D D   C A N C E L   R O U T I N E                 *
 14453*                                                                *
 14454******************************************************************
 14455
 14456 2200-ADD-CANCEL-ROUTINE.
 14457     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14458
 14459
 14460* EXEC CICS GETMAIN
 14461*        SET     (ADDRESS OF PENDING-BUSINESS)
 14462*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14463*    END-EXEC.
 14464*    MOVE '," L                  $   #00013013' TO DFHEIV0
 14465     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14466     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14467     MOVE X'2020233030303133303133' TO DFHEIV0(25:11)
 14468     CALL 'kxdfhei1' USING DFHEIV0,
 14469           DFHEIV20,
 14470           ERPNDB-RECORD-LENGTH,
 14471           DFHEIV99
 14472     SET ADDRESS OF PENDING-BUSINESS TO
 14473         DFHEIV20
 14474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14475
 14476
 14477
 14478* EXEC CICS HANDLE CONDITION
 14479*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14480*    END-EXEC.
 14481*    MOVE '"$I                   ! 3 #00013018' TO DFHEIV0
 14482     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14484     MOVE X'3320233030303133303138' TO DFHEIV0(25:11)
 14485     CALL 'kxdfhei1' USING DFHEIV0
 14486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14487
 14488
 14489     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14490     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14491     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14492
 14493
 14494* EXEC CICS READ
 14495*        INTO    (PENDING-BUSINESS)
 14496*        DATASET (FILE-ID-ERPNDB)
 14497*        RIDFLD  (ERPNDB-KEY)
 14498*    END-EXEC.
 14499     MOVE LENGTH OF
 14500      PENDING-BUSINESS
 14501       TO DFHEIV11
 14502*    MOVE '&"IL       E          (   #00013026' TO DFHEIV0
 14503     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14504     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14505     MOVE X'2020233030303133303236' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 264
* EL6311.cbl
 14506     CALL 'kxdfhei1' USING DFHEIV0,
 14507           FILE-ID-ERPNDB,
 14508           PENDING-BUSINESS,
 14509           DFHEIV11,
 14510           ERPNDB-KEY,
 14511           DFHEIV99,
 14512           DFHEIV99,
 14513           DFHEIV99
 14514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14515
 14516
 14517     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14518
 14519     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14520     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14521     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14522     MOVE SPACES                 TO PENDING-BUSINESS.
 14523     MOVE 'PB'                   TO PB-RECORD-ID.
 14524     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14525     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14526     MOVE SPACES                 TO PB-CERT-SFX.
 14527     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14528     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14529                                    PB-ALT-CHG-SEQ-NO.
 14530
 14531     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14532     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14533     MOVE '2'                    TO PB-RECORD-TYPE.
 14534
 14535     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14536     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14537
 14538
 14539     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14540                                    PB-ALT-CHG-SEQ-NO
 14541                                    PB-C-LF-REF-CALC
 14542                                    PB-C-AH-REF-CALC
 14543                                    PB-C-LF-RFND-CLP
 14544                                    PB-C-AH-RFND-CLP
 14545                                    PB-CI-INSURED-AGE
 14546                                    PB-CI-LF-TERM
 14547                                    PB-CI-AH-TERM
 14548                                    PB-CI-LF-BENEFIT-CD
 14549                                    PB-CI-LF-BENEFIT-AMT
 14550                                    PB-CI-LF-ALT-BENEFIT-AMT
 14551                                    PB-CI-LF-PREMIUM-AMT
 14552                                    PB-CI-LF-ALT-PREMIUM-AMT
 14553                                    PB-CI-AH-BENEFIT-CD
 14554                                    PB-CI-AH-BENEFIT-AMT
 14555                                    PB-CI-AH-PREMIUM-AMT
 14556                                    PB-CI-PAY-FREQUENCY
 14557                                    PB-CI-LOAN-APR
 14558                                    PB-CI-LOAN-TERM
 14559                                    PB-CI-LIFE-COMMISSION
 14560                                    PB-CI-AH-COMMISSION
 14561                                    PB-CI-CURR-SEQ
 14562                                    PB-CI-AH-CANCEL-AMT
 14563                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 265
* EL6311.cbl
 14564                                    PB-CI-RATE-DEV-PCT-LF
 14565                                    PB-CI-RATE-DEV-PCT-AH
 14566                                    PB-CI-EXTENTION-DAYS
 14567                                    PB-CI-TERM-IN-DAYS
 14568                                    PB-CI-LIVES
 14569                                    PB-CI-LF-CRIT-PER
 14570                                    PB-CI-AH-CRIT-PER
 14571                                    PB-C-LF-REM-TERM
 14572                                    PB-C-AH-REM-TERM
 14573                                    PB-CHG-COUNT
 14574                                    PB-LF-BILLED-AMTS
 14575                                    PB-AH-BILLED-AMTS
 14576                                    PB-C-NH-INT-ON-REFS
 14577*                                   PB-C-MICROFILM-NO
 14578                                    PB-CALC-TOLERANCE.
 14579
 14580     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14581                                    PB-CI-AH-SETTLEMENT-DT
 14582                                    PB-CI-DEATH-DT
 14583                                    PB-CI-LF-PRIOR-CANCEL-DT
 14584                                    PB-CI-AH-PRIOR-CANCEL-DT
 14585                                    PB-CI-ENTRY-DT
 14586                                    PB-CI-LF-EXPIRE-DT
 14587                                    PB-CI-AH-EXPIRE-DT
 14588                                    PB-CI-LOAN-1ST-PMT-DT
 14589                                    PB-C-LF-CANCEL-DT
 14590                                    PB-C-AH-CANCEL-DT
 14591                                    PB-CREDIT-ACCEPT-DT
 14592                                    PB-BILLED-DT
 14593                                    PB-ACCT-EFF-DT
 14594                                    PB-ACCT-EXP-DT.
 14595
 14596     MOVE 'X'                    TO PB-FATAL-FLAG.
 14597
 14598     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14599
 14600     IF CSUFIXL     GREATER THAN ZEROS
 14601        MOVE CSUFIXI             TO PB-CERT-SFX.
 14602
 14603*    IF CMICRNOL  GREATER  ZEROS
 14604*        IF CMICRNOI  NUMERIC
 14605*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14606*            MOVE AL-UNNON       TO  CMICRNOA
 14607*        ELSE
 14608*            MOVE -1             TO  CMICRNOL
 14609*            MOVE AL-UNBON       TO  CMICRNOA
 14610*            MOVE ER-2701        TO  EMI-ERROR
 14611*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14612
 14613     IF CLSTNML     GREATER THAN ZEROS
 14614        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14615
 14616     IF CCANREAL > ZEROS
 14617        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14618     END-IF
 14619     IF CPCYNL > ZEROS
 14620        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14621     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 266
* EL6311.cbl
 14622     IF CCANDT1L    GREATER THAN ZEROS
 14623        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14624
 14625     IF CCANDT2L    GREATER THAN ZEROS
 14626        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14627
 14628     IF CMTHD1L    GREATER THAN +0
 14629        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14630
 14631     IF CMTHD2L    GREATER THAN +0
 14632        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14633
 14634     IF CREFND1L    GREATER THAN ZEROS
 14635        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14636        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14637     ELSE
 14638        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14639
 14640     IF CREFND2L    GREATER THAN ZEROS
 14641        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14642        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14643     ELSE
 14644        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14645
 14646     IF CLIVESL     GREATER THAN ZEROS
 14647        MOVE WS-CLIVES           TO PB-C-LIVES
 14648     ELSE
 14649        MOVE ZEROS               TO PB-C-LIVES.
 14650
 14651     IF CPAYEEL     GREATER THAN ZEROS
 14652        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14653
 14654     IF CFORCEL     GREATER THAN ZEROS
 14655        MOVE CFORCEI             TO PB-FORCE-CODE.
 14656
 14657     IF CBILCDL     GREATER THAN ZEROS
 14658        MOVE CBILCDI             TO PB-RECORD-BILL.
 14659
 14660*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14661
 14662 2260-WRITE-PB-RECORD.
 14663     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14664                                    PB-INPUT-BY.
 14665     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14666     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14667                                    PB-INPUT-DT.
 14668
 14669     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14670     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14671                                    PB-CONTROL-BY-ORIG-BATCH.
 14672
 14673     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14674     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14675     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14676     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14677     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14678
 14679     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 267
* EL6311.cbl
 14680
 14681     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14682
 14683     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14684     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14685     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14686
 14687     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14688     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14689
 14690 2275-WRITE-PENDING-BUSINESS.
 14691     MOVE 'A'                    TO JP-RECORD-TYPE.
 14692     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14693     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14694     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14695
 14696
 14697* EXEC CICS HANDLE CONDITION
 14698*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14699*    END-EXEC.
 14700*    MOVE '"$%                   ! 4 #00013211' TO DFHEIV0
 14701     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14702     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14703     MOVE X'3420233030303133323131' TO DFHEIV0(25:11)
 14704     CALL 'kxdfhei1' USING DFHEIV0
 14705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14706
 14707
 14708
 14709* EXEC CICS WRITE
 14710*        DATASET (FILE-ID-ERPNDB)
 14711*        FROM    (PENDING-BUSINESS)
 14712*        RIDFLD  (PB-CONTROL-PRIMARY)
 14713*    END-EXEC.
 14714     MOVE LENGTH OF
 14715      PENDING-BUSINESS
 14716       TO DFHEIV11
 14717*    MOVE '&$ L                  ''   #00013215' TO DFHEIV0
 14718     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14719     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14720     MOVE X'2020233030303133323135' TO DFHEIV0(25:11)
 14721     CALL 'kxdfhei1' USING DFHEIV0,
 14722           FILE-ID-ERPNDB,
 14723           PENDING-BUSINESS,
 14724           DFHEIV11,
 14725           PB-CONTROL-PRIMARY,
 14726           DFHEIV99,
 14727           DFHEIV99
 14728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14729
 14730
 14731     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14732
 14733     PERFORM 8400-LOG-JOURNAL-RECORD.
 14734
 14735******************************************************************
 14736*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14737******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 268
* EL6311.cbl
 14738
 14739     display ' made it to add orig CANCEL cert '
 14740     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14741     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14742     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14743     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14744
 14745
 14746* EXEC CICS READ
 14747*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14748*        DATASET (FILE-ID-ELCERT)
 14749*        RIDFLD  (ELCERT-KEY)
 14750*        RESP    (WS-RESPONSE)
 14751*    END-EXEC.
 14752*    MOVE '&"S        E          (  N#00013235' TO DFHEIV0
 14753     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14754     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14755     MOVE X'204E233030303133323335' TO DFHEIV0(25:11)
 14756     CALL 'kxdfhei1' USING DFHEIV0,
 14757           FILE-ID-ELCERT,
 14758           DFHEIV20,
 14759           DFHEIV99,
 14760           ELCERT-KEY,
 14761           DFHEIV99,
 14762           DFHEIV99,
 14763           DFHEIV99
 14764     SET ADDRESS OF CERTIFICATE-MASTER TO
 14765         DFHEIV20
 14766     MOVE EIBRESP  TO WS-RESPONSE
 14767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14768
 14769
 14770     IF NOT RESP-NORMAL
 14771        GO TO 2276-BYPASS-CRTO
 14772     END-IF
 14773
 14774     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14775     MOVE ' '                    TO WS-ERMAIL-SW
 14776
 14777
 14778* EXEC CICS READ
 14779*       DATASET   (FILE-ID-ERMAIL)
 14780*       SET       (ADDRESS OF MAILING-DATA)
 14781*       RIDFLD    (ERMAIL-KEY)
 14782*       RESP      (WS-RESPONSE)
 14783*    END-EXEC
 14784*    MOVE '&"S        E          (  N#00013249' TO DFHEIV0
 14785     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14787     MOVE X'204E233030303133323439' TO DFHEIV0(25:11)
 14788     CALL 'kxdfhei1' USING DFHEIV0,
 14789           FILE-ID-ERMAIL,
 14790           DFHEIV20,
 14791           DFHEIV99,
 14792           ERMAIL-KEY,
 14793           DFHEIV99,
 14794           DFHEIV99,
 14795           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 269
* EL6311.cbl
 14796     SET ADDRESS OF MAILING-DATA TO
 14797         DFHEIV20
 14798     MOVE EIBRESP  TO WS-RESPONSE
 14799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14800
 14801     IF RESP-NORMAL
 14802        SET ERMAIL-FOUND TO TRUE
 14803     END-IF
 14804
 14805     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14806
 14807     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14808     MOVE 'OC'                   TO OC-RECORD-ID
 14809     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14810                                 TO OC-CONTROL-PRIMARY (1:33)
 14811     MOVE 'I'                    TO OC-RECORD-TYPE
 14812     MOVE +4096                  TO OC-KEY-SEQ-NO
 14813     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14814     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14815     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14816
 14817     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14818     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14819     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14820     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14821     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14822     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14823     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14824     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14825     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14826     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14827     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14828     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14829     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14830     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14831     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14832     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14833     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14834     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14835     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14836     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14837     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14838     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14839     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14840     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14841     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14842     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14843     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14844     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14845     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14846     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14847     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14848     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14849
 14850     IF ERMAIL-FOUND
 14851        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14852     END-IF
 14853     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 270
* EL6311.cbl
 14854        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14855                           OC-INS-AGE-DEFAULT-FLAG
 14856        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14857                           OC-JNT-AGE-DEFAULT-FLAG
 14858     END-IF
 14859     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14860     .
 14861 2275-WRITE-ELCRTO.
 14862
 14863
 14864* EXEC CICS WRITE
 14865*       DATASET   ('ELCRTO')
 14866*       FROM      (ORIGINAL-CERTIFICATE)
 14867*       RIDFLD    (OC-CONTROL-PRIMARY)
 14868*       RESP      (WS-RESPONSE)
 14869*    END-EXEC
 14870     MOVE LENGTH OF
 14871      ORIGINAL-CERTIFICATE
 14872       TO DFHEIV11
 14873     MOVE 'ELCRTO' TO DFHEIV1
 14874*    MOVE '&$ L                  ''  N#00013318' TO DFHEIV0
 14875     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14876     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14877     MOVE X'204E233030303133333138' TO DFHEIV0(25:11)
 14878     CALL 'kxdfhei1' USING DFHEIV0,
 14879           DFHEIV1,
 14880           ORIGINAL-CERTIFICATE,
 14881           DFHEIV11,
 14882           OC-CONTROL-PRIMARY,
 14883           DFHEIV99,
 14884           DFHEIV99
 14885     MOVE EIBRESP  TO WS-RESPONSE
 14886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14887
 14888     display ' just wrote 2275 ' ws-response
 14889     IF RESP-DUPKEY
 14890        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14891        GO TO 2275-WRITE-ELCRTO
 14892     ELSE
 14893        IF NOT RESP-NORMAL
 14894           MOVE -1               TO BMAINTL
 14895           MOVE ER-7450          TO EMI-ERROR
 14896           PERFORM 9900-ERROR-FORMAT
 14897                                 THRU 9900-EXIT
 14898           GO TO 8200-SEND-DATAONLY
 14899        END-IF
 14900     END-IF.
 14901
 14902 2276-BYPASS-CRTO.
 14903******************************************************************
 14904*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14905******************************************************************
 14906
 14907
 14908* EXEC CICS READ
 14909*        INTO    (PENDING-BUSINESS)
 14910*        DATASET (FILE-ID-ERPNDB)
 14911*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 271
* EL6311.cbl
 14912*        UPDATE
 14913*    END-EXEC.
 14914     MOVE LENGTH OF
 14915      PENDING-BUSINESS
 14916       TO DFHEIV11
 14917*    MOVE '&"IL       EU         (   #00013344' TO DFHEIV0
 14918     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14919     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14920     MOVE X'2020233030303133333434' TO DFHEIV0(25:11)
 14921     CALL 'kxdfhei1' USING DFHEIV0,
 14922           FILE-ID-ERPNDB,
 14923           PENDING-BUSINESS,
 14924           DFHEIV11,
 14925           ERPNDB-KEY,
 14926           DFHEIV99,
 14927           DFHEIV99,
 14928           DFHEIV99
 14929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14930
 14931
 14932     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14933     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14934     MOVE 'B'                    TO JP-RECORD-TYPE.
 14935     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14936
 14937     PERFORM 8400-LOG-JOURNAL-RECORD.
 14938
 14939     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14940
 14941
 14942* EXEC CICS REWRITE
 14943*        DATASET (FILE-ID-ERPNDB)
 14944*        FROM    (PENDING-BUSINESS)
 14945*    END-EXEC.
 14946     MOVE LENGTH OF
 14947      PENDING-BUSINESS
 14948       TO DFHEIV11
 14949*    MOVE '&& L                  %   #00013360' TO DFHEIV0
 14950     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14951     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14952     MOVE X'2020233030303133333630' TO DFHEIV0(25:11)
 14953     CALL 'kxdfhei1' USING DFHEIV0,
 14954           FILE-ID-ERPNDB,
 14955           PENDING-BUSINESS,
 14956           DFHEIV11,
 14957           DFHEIV99
 14958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14959
 14960
 14961     MOVE 'C'                    TO JP-RECORD-TYPE.
 14962     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14963
 14964     PERFORM 8400-LOG-JOURNAL-RECORD.
 14965
 14966     IF WS-ERRORS-PRESENT
 14967        GO TO 3900-RE-DISPLAY-RECORD.
 14968
 14969     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 272
* EL6311.cbl
 14970     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14971     MOVE LOW-VALUES             TO EL631CI.
 14972     MOVE  -1                    TO CMAINTL.
 14973     GO TO 8100-SEND-INITIAL-MAP.
 14974
 14975 2280-BATCH-HDR-NOT-FOUND.
 14976     MOVE -1                     TO BMAINTL.
 14977     MOVE ER-7450                TO EMI-ERROR.
 14978     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14979     GO TO 8200-SEND-DATAONLY.
 14980
 14981 2290-DUPLICATE-ALT-INDEX.
 14982
 14983******************************************************************
 14984*                                                                *
 14985*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14986*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14987*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14988*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14989*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14990*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14991*                                                                *
 14992******************************************************************
 14993
 14994     IF LCP-ONCTR-02 =  0
 14995         ADD 1 TO LCP-ONCTR-02
 14996        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14997
 14998     ADD +1                      TO WS-SEQ-NO-COUNTER.
 14999
 15000     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15001         NEXT SENTENCE
 15002     ELSE
 15003         ADD +1 TO PB-BATCH-SEQ-NO
 15004                   PB-CSR-BATCH-SEQ-NO
 15005         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15006         GO TO 2275-WRITE-PENDING-BUSINESS.
 15007
 15008     MOVE -1                     TO CCERTNOL.
 15009     MOVE AL-UABON               TO CCERTNOA.
 15010     MOVE AL-UNBON               TO CEFFDTA.
 15011
 15012     MOVE 1                      TO EMI-SUB
 15013                                    EMI-SWITCH1
 15014                                    EMI-SWITCH-AREA-1
 15015                                    EMI-SWITCH-AREA-2.
 15016
 15017     MOVE SPACES                 TO EMI-ERROR-LINES.
 15018
 15019
 15020* EXEC CICS SYNCPOINT ROLLBACK
 15021*    END-EXEC.
 15022*    MOVE '6"R                   !   #00013423' TO DFHEIV0
 15023     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15024     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15025     MOVE X'2020233030303133343233' TO DFHEIV0(25:11)
 15026     CALL 'kxdfhei1' USING DFHEIV0
 15027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 273
* EL6311.cbl
 15028
 15029
 15030     MOVE ER-2247                TO EMI-ERROR.
 15031     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15032     GO TO 8200-SEND-DATAONLY.
 15033
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 274
* EL6311.cbl
 15035
 15036******************************************************************
 15037*                                                                *
 15038*          C H A N G E   C A N C E L   R O U T I N E             *
 15039*                                                                *
 15040******************************************************************
 15041
 15042***************************************************************
 15043*                                                             *
 15044*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15045*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15046*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15047*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15048*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15049*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15050*     5. LINK TO THE EDIT ROUTINE.                            *
 15051*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15052*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15053*              THE EDIT ROUTINE.                              *
 15054*     7. REWRITE THE NEW ISSUE                                *
 15055*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15056*                                                             *
 15057***************************************************************
 15058 2300-CHANGE-CANCEL-ROUTINE.
 15059     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15060
 15061     IF CCHGL NOT = ZEROS
 15062        MOVE ER-2196             TO EMI-ERROR
 15063        MOVE AL-UABON            TO CMAINTA
 15064        MOVE -1                  TO CMAINTL
 15065        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15066        GO TO 8200-SEND-DATAONLY.
 15067
 15068     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15069
 15070     IF CSUFIXL NOT = ZEROS
 15071        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15072     ELSE
 15073        MOVE SPACE               TO WS-NEW-SUFFIX.
 15074
 15075     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15076     PERFORM 8600-DEEDIT.
 15077     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15078     MOVE '4'                    TO DC-OPTION-CODE.
 15079
 15080     PERFORM 9700-DATE-LINK.
 15081
 15082     IF DATE-CONVERSION-ERROR
 15083        MOVE ER-0348             TO EMI-ERROR
 15084        MOVE -1                  TO CEFFDTL
 15085        MOVE AL-UABON            TO CEFFDTA
 15086        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15087        GO TO 8200-SEND-DATAONLY
 15088     ELSE
 15089        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15090        MOVE AL-UANON            TO CEFFDTA
 15091        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15092
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 275
* EL6311.cbl
 15093 2325-PROCESS-CANCEL-CHANGES.
 15094
 15095* EXEC CICS HANDLE CONDITION
 15096*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15097*    END-EXEC.
 15098*    MOVE '"$I                   ! 5 #00013490' TO DFHEIV0
 15099     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15101     MOVE X'3520233030303133343930' TO DFHEIV0(25:11)
 15102     CALL 'kxdfhei1' USING DFHEIV0
 15103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15104
 15105
 15106     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15107     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15108     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15109
 15110
 15111* EXEC CICS GETMAIN
 15112*        SET      (ADDRESS OF PENDING-BUSINESS)
 15113*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15114*        INITIMG  (GETMAIN-SPACE)
 15115*     END-EXEC.
 15116*    MOVE ',"IL                  $   #00013498' TO DFHEIV0
 15117     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15118     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15119     MOVE X'2020233030303133343938' TO DFHEIV0(25:11)
 15120     CALL 'kxdfhei1' USING DFHEIV0,
 15121           DFHEIV20,
 15122           ERPNDB-RECORD-LENGTH,
 15123           GETMAIN-SPACE
 15124     SET ADDRESS OF PENDING-BUSINESS TO
 15125         DFHEIV20
 15126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15127
 15128
 15129
 15130* EXEC CICS READ
 15131*        INTO    (PENDING-BUSINESS)
 15132*        DATASET (FILE-ID-ERPNDB)
 15133*        RIDFLD  (ERPNDB-KEY)
 15134*    END-EXEC.
 15135     MOVE LENGTH OF
 15136      PENDING-BUSINESS
 15137       TO DFHEIV11
 15138*    MOVE '&"IL       E          (   #00013504' TO DFHEIV0
 15139     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15140     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15141     MOVE X'2020233030303133353034' TO DFHEIV0(25:11)
 15142     CALL 'kxdfhei1' USING DFHEIV0,
 15143           FILE-ID-ERPNDB,
 15144           PENDING-BUSINESS,
 15145           DFHEIV11,
 15146           ERPNDB-KEY,
 15147           DFHEIV99,
 15148           DFHEIV99,
 15149           DFHEIV99
 15150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 276
* EL6311.cbl
 15151
 15152
 15153     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15154
 15155
 15156* EXEC CICS HANDLE CONDITION
 15157*         NOTFND     (2385-REC-NOT-FOUND)
 15158*    END-EXEC.
 15159*    MOVE '"$I                   ! 6 #00013512' TO DFHEIV0
 15160     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15162     MOVE X'3620233030303133353132' TO DFHEIV0(25:11)
 15163     CALL 'kxdfhei1' USING DFHEIV0
 15164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15165
 15166
 15167**********************************************************
 15168*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15169*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15170**********************************************************
 15171
 15172
 15173* EXEC CICS READ
 15174*        DATASET (FILE-ID-ERPNDB)
 15175*        INTO    (PENDING-BUSINESS)
 15176*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15177*    END-EXEC.
 15178     MOVE LENGTH OF
 15179      PENDING-BUSINESS
 15180       TO DFHEIV11
 15181*    MOVE '&"IL       E          (   #00013521' TO DFHEIV0
 15182     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15183     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15184     MOVE X'2020233030303133353231' TO DFHEIV0(25:11)
 15185     CALL 'kxdfhei1' USING DFHEIV0,
 15186           FILE-ID-ERPNDB,
 15187           PENDING-BUSINESS,
 15188           DFHEIV11,
 15189           PI-PREV-CONTROL-PRIMARY,
 15190           DFHEIV99,
 15191           DFHEIV99,
 15192           DFHEIV99
 15193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15194
 15195
 15196********** DO NOT ALLOW CHANGES IF THRU A/R
 15197     IF BMAINTI = 'C'
 15198         IF PB-EL860-INTERNAL-PROCESS
 15199             MOVE ER-4005          TO EMI-ERROR
 15200             MOVE -1               TO BMAINTL
 15201             MOVE AL-UABON         TO BMAINTA
 15202             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15203             GO TO 8200-SEND-DATAONLY.
 15204**********
 15205
 15206     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15207        MOVE -1                 TO CMAINTL
 15208        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 277
* EL6311.cbl
 15209        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15210        GO TO 8200-SEND-DATAONLY.
 15211
 15212     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15213        MOVE ER-2196             TO EMI-ERROR
 15214        MOVE AL-UABON            TO CMAINTA
 15215        MOVE -1                  TO CMAINTL
 15216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15217        GO TO 8200-SEND-DATAONLY.
 15218     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15219
 15220     IF PB-BILLED-DT = LOW-VALUES AND
 15221        PB-CHG-COUNT = ZEROS
 15222        NEXT SENTENCE
 15223     ELSE
 15224        IF (CREFND1L GREATER THAN ZEROS AND
 15225            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15226           OR
 15227           (CREFND2L GREATER THAN ZEROS AND
 15228            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15229           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15230     if ((crefnd1l <> zeros)
 15231        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15232                      or
 15233        ((crefnd2l <> zeros)
 15234        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15235        continue
 15236     else
 15237        go to 2330-continue-change
 15238     end-if
 15239
 15240     move zeros                  to ws-check-amts
 15241     move ' '                    to ws-stop-sw
 15242                                    ws-check-sw
 15243                                    ws-proc-check-sw
 15244                                    ws-chek-browse-sw
 15245
 15246     perform 2500-browse-checks  thru 2500-exit
 15247
 15248     if i-have-processed-checks
 15249        or i-have-checks
 15250        continue
 15251     else
 15252        go to 2330-continue-change
 15253     end-if
 15254
 15255     display ' pb lf can ' pb-c-lf-cancel-amt
 15256     display ' ws lf can ' ws-crefnd1
 15257     if crefnd1l <> zeros
 15258        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15259        move ws-crefnd1 to ws-new-ref-total
 15260     else
 15261        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15262     end-if
 15263     display ' pb ah can ' pb-c-ah-cancel-amt
 15264     display ' ws ah can ' ws-crefnd2
 15265     display ' chk amts  ' ws-check-amts
 15266     if crefnd2l <> zeros
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 278
* EL6311.cbl
 15267        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15268        compute ws-new-ref-total = ws-new-ref-total +
 15269           ws-crefnd2
 15270     else
 15271        compute ws-new-ref-total = ws-new-ref-total +
 15272           pb-c-ah-cancel-amt
 15273     end-if
 15274
 15275     if zeros = (ws-lf-diff + ws-ah-diff)
 15276        move er-3449             to emi-error
 15277        perform 9900-error-format thru 9900-exit
 15278        go to 2330-continue-change
 15279     end-if
 15280
 15281     if ws-new-ref-total < ws-check-amts
 15282        move er-3447             to emi-error
 15283        perform 9900-error-format thru 9900-exit
 15284        move al-uabon            to cmainta
 15285        move -1                  to cmaintl
 15286        go to 8200-send-dataonly
 15287     end-if
 15288
 15289     if (ws-new-ref-total > ws-check-amts)
 15290        and (ws-check-amts not = zeros)
 15291        move er-3448             to emi-error
 15292        move al-uabon            to crefnd1a
 15293                                    crefnd2a
 15294        perform 9900-error-format thru 9900-exit
 15295     end-if
 15296
 15297*     if (ws-lf-diff + ws-ah-diff) < zeros
 15298*        move er-3447             to emi-error
 15299*        perform 9900-error-format thru 9900-exit
 15300*        move al-uabon            to cmainta
 15301*        move -1                  to cmaintl
 15302*        go to 8200-send-dataonly
 15303*     end-if
 15304     .
 15305 2330-continue-change.
 15306
 15307
 15308* EXEC CICS READ
 15309*        DATASET (FILE-ID-ERPNDB)
 15310*        INTO    (PENDING-BUSINESS)
 15311*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15312*        UPDATE
 15313*    END-EXEC.
 15314     MOVE LENGTH OF
 15315      PENDING-BUSINESS
 15316       TO DFHEIV11
 15317*    MOVE '&"IL       EU         (   #00013638' TO DFHEIV0
 15318     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15319     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15320     MOVE X'2020233030303133363338' TO DFHEIV0(25:11)
 15321     CALL 'kxdfhei1' USING DFHEIV0,
 15322           FILE-ID-ERPNDB,
 15323           PENDING-BUSINESS,
 15324           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 279
* EL6311.cbl
 15325           PI-PREV-CONTROL-PRIMARY,
 15326           DFHEIV99,
 15327           DFHEIV99,
 15328           DFHEIV99
 15329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15330
 15331
 15332     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15333     MOVE 'B'                    TO JP-RECORD-TYPE
 15334     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15335     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15336
 15337     PERFORM 8400-LOG-JOURNAL-RECORD.
 15338
 15339     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15340          PB-CHG-COUNT NOT = ZEROS
 15341        IF (CREFND1L GREATER THAN ZEROS AND
 15342            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15343           OR
 15344           (CREFND2L GREATER THAN ZEROS AND
 15345            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15346            ADD +1                      TO PB-CHG-COUNT
 15347            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15348
 15349*    IF CMICRNOL  GREATER  ZEROS
 15350*        IF CMICRNOI  NUMERIC
 15351*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15352*            MOVE AL-UNNON       TO  CMICRNOA
 15353*        ELSE
 15354*            MOVE -1             TO  CMICRNOL
 15355*            MOVE AL-UNBON       TO  CMICRNOA
 15356*            MOVE ER-2701        TO  EMI-ERROR
 15357*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15358
 15359     IF CSUFIXL GREATER THAN ZEROS
 15360        MOVE CSUFIXI             TO PB-CERT-SFX.
 15361
 15362     IF CLSTNML GREATER THAN ZEROS
 15363         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15364
 15365     IF CCANREAL > ZEROS
 15366        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15367     END-IF
 15368     IF CPCYNL > ZEROS
 15369        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15370     END-IF
 15371     IF CCANDT1L    GREATER THAN ZEROS
 15372        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15373
 15374     IF CCANDT2L    GREATER THAN ZEROS
 15375        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15376
 15377     IF CMTHD1L    GREATER THAN +0
 15378        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15379
 15380     IF CMTHD2L    GREATER THAN +0
 15381        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15382
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 280
* EL6311.cbl
 15383     IF CREFND1L    GREATER THAN ZEROS
 15384        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15385        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15386        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15387        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15388
 15389     IF CREFND2L    GREATER THAN ZEROS
 15390        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15391        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15392        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15393        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15394
 15395     IF CLIVESL     GREATER THAN ZEROS
 15396        MOVE WS-CLIVES           TO PB-C-LIVES.
 15397
 15398     IF CPAYEEL     GREATER THAN ZEROS
 15399        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15400
 15401     IF CFORCEL     GREATER THAN ZEROS
 15402        MOVE CFORCEI             TO PB-FORCE-CODE.
 15403
 15404     IF CBILCDL     GREATER THAN ZEROS
 15405        MOVE CBILCDI             TO PB-RECORD-BILL.
 15406
 15407 2360-REWRITE-PB-RECORD.
 15408     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15409     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15410     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15411     MOVE 'C'                    TO JP-RECORD-TYPE.
 15412     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15413     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15414     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15415
 15416     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15417
 15418     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15419     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15420
 15421     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15422
 15423     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15424
 15425     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15426     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15427     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15428
 15429     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15430     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15431
 15432 2375-REWRITE-PENDING-BUSINESS.
 15433     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15434     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15435     MOVE 'C'                    TO JP-RECORD-TYPE.
 15436     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15437
 15438
 15439* EXEC CICS REWRITE
 15440*        DATASET (FILE-ID-ERPNDB)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 281
* EL6311.cbl
 15441*        FROM    (PENDING-BUSINESS)
 15442*    END-EXEC.
 15443     MOVE LENGTH OF
 15444      PENDING-BUSINESS
 15445       TO DFHEIV11
 15446*    MOVE '&& L                  %   #00013751' TO DFHEIV0
 15447     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15448     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15449     MOVE X'2020233030303133373531' TO DFHEIV0(25:11)
 15450     CALL 'kxdfhei1' USING DFHEIV0,
 15451           FILE-ID-ERPNDB,
 15452           PENDING-BUSINESS,
 15453           DFHEIV11,
 15454           DFHEIV99
 15455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15456
 15457
 15458     PERFORM 8400-LOG-JOURNAL-RECORD.
 15459
 15460******************************************************************
 15461*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15462******************************************************************
 15463
 15464     display ' made it to update orig cancel cert '
 15465
 15466     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15467     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15468     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15469     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15470
 15471
 15472* EXEC CICS READ
 15473*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15474*        DATASET (FILE-ID-ELCERT)
 15475*        RIDFLD  (ELCERT-KEY)
 15476*        RESP    (WS-RESPONSE)
 15477*    END-EXEC.
 15478*    MOVE '&"S        E          (  N#00013769' TO DFHEIV0
 15479     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15480     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15481     MOVE X'204E233030303133373639' TO DFHEIV0(25:11)
 15482     CALL 'kxdfhei1' USING DFHEIV0,
 15483           FILE-ID-ELCERT,
 15484           DFHEIV20,
 15485           DFHEIV99,
 15486           ELCERT-KEY,
 15487           DFHEIV99,
 15488           DFHEIV99,
 15489           DFHEIV99
 15490     SET ADDRESS OF CERTIFICATE-MASTER TO
 15491         DFHEIV20
 15492     MOVE EIBRESP  TO WS-RESPONSE
 15493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15494
 15495
 15496     IF NOT RESP-NORMAL
 15497        GO TO 2376-BYPASS-CRTO
 15498     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 282
* EL6311.cbl
 15499
 15500
 15501     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15502     MOVE ' '                    TO WS-ERMAIL-SW
 15503
 15504
 15505* EXEC CICS READ
 15506*       DATASET   (FILE-ID-ERMAIL)
 15507*       SET       (ADDRESS OF MAILING-DATA)
 15508*       RIDFLD    (ERMAIL-KEY)
 15509*       RESP      (WS-RESPONSE)
 15510*    END-EXEC
 15511*    MOVE '&"S        E          (  N#00013784' TO DFHEIV0
 15512     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15513     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15514     MOVE X'204E233030303133373834' TO DFHEIV0(25:11)
 15515     CALL 'kxdfhei1' USING DFHEIV0,
 15516           FILE-ID-ERMAIL,
 15517           DFHEIV20,
 15518           DFHEIV99,
 15519           ERMAIL-KEY,
 15520           DFHEIV99,
 15521           DFHEIV99,
 15522           DFHEIV99
 15523     SET ADDRESS OF MAILING-DATA TO
 15524         DFHEIV20
 15525     MOVE EIBRESP  TO WS-RESPONSE
 15526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15527
 15528     IF RESP-NORMAL
 15529        SET ERMAIL-FOUND TO TRUE
 15530     END-IF
 15531
 15532     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15533
 15534     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15535                                 TO ELCRTO-KEY
 15536     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15537     MOVE +0                     TO ELCRTO-SEQ-NO
 15538
 15539
 15540* EXEC CICS READ
 15541*       DATASET   ('ELCRTO')
 15542*       INTO      (ORIGINAL-CERTIFICATE)
 15543*       RIDFLD    (ELCRTO-KEY)
 15544*       GTEQ
 15545*       RESP      (WS-RESPONSE)
 15546*    END-EXEC
 15547     MOVE LENGTH OF
 15548      ORIGINAL-CERTIFICATE
 15549       TO DFHEIV11
 15550     MOVE 'ELCRTO' TO DFHEIV1
 15551*    MOVE '&"IL       G          (  N#00013802' TO DFHEIV0
 15552     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15553     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15554     MOVE X'204E233030303133383032' TO DFHEIV0(25:11)
 15555     CALL 'kxdfhei1' USING DFHEIV0,
 15556           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 283
* EL6311.cbl
 15557           ORIGINAL-CERTIFICATE,
 15558           DFHEIV11,
 15559           ELCRTO-KEY,
 15560           DFHEIV99,
 15561           DFHEIV99,
 15562           DFHEIV99
 15563     MOVE EIBRESP  TO WS-RESPONSE
 15564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15565
 15566     display ' just read gteq ' ws-response
 15567     IF RESP-NORMAL
 15568        AND (OC-CONTROL-PRIMARY (1:33) =
 15569                 PB-CONTROL-BY-ACCOUNT (1:33))
 15570        AND (OC-RECORD-TYPE = 'I')
 15571        display ' resp norm, key =, type i '
 15572        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15573           display ' end proc blank '
 15574           display ' csr edit session ' PI-CSR-SESSION-SW
 15575           IF NOT CSR-EDIT-SESSION
 15576
 15577* EXEC CICS READ
 15578*                DATASET   ('ELCRTO')
 15579*                INTO      (ORIGINAL-CERTIFICATE)
 15580*                RIDFLD    (OC-CONTROL-PRIMARY)
 15581*                UPDATE
 15582*                RESP      (WS-RESPONSE)
 15583*             END-EXEC
 15584     MOVE LENGTH OF
 15585      ORIGINAL-CERTIFICATE
 15586       TO DFHEIV11
 15587     MOVE 'ELCRTO' TO DFHEIV1
 15588*    MOVE '&"IL       EU         (  N#00013820' TO DFHEIV0
 15589     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15590     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15591     MOVE X'204E233030303133383230' TO DFHEIV0(25:11)
 15592     CALL 'kxdfhei1' USING DFHEIV0,
 15593           DFHEIV1,
 15594           ORIGINAL-CERTIFICATE,
 15595           DFHEIV11,
 15596           OC-CONTROL-PRIMARY,
 15597           DFHEIV99,
 15598           DFHEIV99,
 15599           DFHEIV99
 15600     MOVE EIBRESP  TO WS-RESPONSE
 15601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15602              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15603              IF RESP-NORMAL
 15604                 display ' good read upd '
 15605                 IF OC-ISSUE-TRAN-IND = 'N'
 15606                    MOVE CM-INSURED-LAST-NAME   TO
 15607                         OC-INS-LAST-NAME
 15608                    MOVE CM-INSURED-FIRST-NAME  TO
 15609                         OC-INS-FIRST-NAME
 15610                    MOVE CM-INSURED-INITIAL2    TO
 15611                         OC-INS-MIDDLE-INIT
 15612                    MOVE CM-INSURED-ISSUE-AGE   TO
 15613                         OC-INS-AGE
 15614                    MOVE CM-JT-LAST-NAME        TO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 284
* EL6311.cbl
 15615                         OC-JNT-LAST-NAME
 15616                    MOVE CM-JT-FIRST-NAME       TO
 15617                         OC-JNT-FIRST-NAME
 15618                    MOVE CM-JT-INITIAL          TO
 15619                         OC-JNT-MIDDLE-INIT
 15620                    MOVE CM-INSURED-JOINT-AGE   TO
 15621                         OC-JNT-AGE
 15622                    MOVE CM-LF-BENEFIT-CD       TO
 15623                         OC-LF-BENCD
 15624                    MOVE CM-LF-ORIG-TERM        TO
 15625                         OC-LF-TERM
 15626                    MOVE CM-LF-BENEFIT-AMT      TO
 15627                         OC-LF-BEN-AMT
 15628                    MOVE CM-LF-PREMIUM-AMT      TO
 15629                         OC-LF-PRM-AMT
 15630                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15631                         OC-LF-ALT-BEN-AMT
 15632                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15633                         OC-LF-ALT-PRM-AMT
 15634                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15635                         OC-LF-EXP-DT
 15636                    MOVE CM-LIFE-COMM-PCT       TO
 15637                         OC-LF-COMM-PCT
 15638                    MOVE CM-AH-BENEFIT-CD       TO
 15639                         OC-AH-BENCD
 15640                    MOVE CM-AH-ORIG-TERM        TO
 15641                         OC-AH-TERM
 15642                    MOVE CM-AH-BENEFIT-AMT      TO
 15643                         OC-AH-BEN-AMT
 15644                    MOVE CM-AH-PREMIUM-AMT      TO
 15645                         OC-AH-PRM-AMT
 15646                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15647                         OC-AH-EXP-DT
 15648                    MOVE CM-AH-COMM-PCT         TO
 15649                         OC-AH-COMM-PCT
 15650                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15651                         OC-AH-CP
 15652                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15653                         OC-1ST-PMT-DT
 15654                 END-IF
 15655                 MOVE PB-C-LF-CANCEL-DT      TO
 15656                         OC-LF-CANCEL-DT
 15657                 MOVE PB-C-LF-CANCEL-AMT     TO
 15658                         OC-LF-CANCEL-AMT
 15659                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15660                         OC-LF-ITD-CANCEL-AMT
 15661                 MOVE PB-C-AH-CANCEL-DT      TO
 15662                         OC-AH-CANCEL-DT
 15663                 MOVE PB-C-AH-CANCEL-AMT     TO
 15664                         OC-AH-CANCEL-AMT
 15665                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15666                         OC-AH-ITD-CANCEL-AMT
 15667                 MOVE 'Y'                    TO
 15668                         OC-CANCEL-TRAN-IND
 15669                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15670                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15671                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15672                 IF ERMAIL-FOUND
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 285
* EL6311.cbl
 15673                    MOVE MA-CRED-BENE-NAME
 15674                                 TO OC-CRED-BENE-NAME
 15675                 END-IF
 15676                 IF NOT CERT-TRL-REC-NOT-FOUND
 15677                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15678                           OC-INS-AGE-DEFAULT-FLAG
 15679                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15680                           OC-JNT-AGE-DEFAULT-FLAG
 15681                 END-IF
 15682
 15683* EXEC CICS REWRITE
 15684*                   DATASET   ('ELCRTO')
 15685*                   FROM      (ORIGINAL-CERTIFICATE)
 15686*                   RESP      (WS-RESPONSE)
 15687*                END-EXEC
 15688     MOVE LENGTH OF
 15689      ORIGINAL-CERTIFICATE
 15690       TO DFHEIV11
 15691     MOVE 'ELCRTO' TO DFHEIV1
 15692*    MOVE '&& L                  %  N#00013907' TO DFHEIV0
 15693     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15694     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15695     MOVE X'204E233030303133393037' TO DFHEIV0(25:11)
 15696     CALL 'kxdfhei1' USING DFHEIV0,
 15697           DFHEIV1,
 15698           ORIGINAL-CERTIFICATE,
 15699           DFHEIV11,
 15700           DFHEIV99
 15701     MOVE EIBRESP  TO WS-RESPONSE
 15702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15703                 display ' just rewrote ' ws-response
 15704              END-IF
 15705           END-IF
 15706        ELSE
 15707           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15708           MOVE 'OC'             TO OC-RECORD-ID
 15709           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15710           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15711           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15712           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15713           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15714           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15715           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15716           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15717           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15718           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15719           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15720           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15721           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15722           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15723           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15724           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15725           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15726           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15727           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15728           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15729           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15730           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 286
* EL6311.cbl
 15731           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15732           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15733           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15734           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15735           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15736           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15737           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15738           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15739           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15740           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15741           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15742           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15743           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15744           IF ERMAIL-FOUND
 15745              MOVE MA-CRED-BENE-NAME
 15746                                 TO OC-CRED-BENE-NAME
 15747           END-IF
 15748           IF NOT CERT-TRL-REC-NOT-FOUND
 15749              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15750                           OC-INS-AGE-DEFAULT-FLAG
 15751              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15752                           OC-JNT-AGE-DEFAULT-FLAG
 15753           END-IF
 15754           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15755
 15756* EXEC CICS WRITE
 15757*             DATASET   ('ELCRTO')
 15758*             FROM      (ORIGINAL-CERTIFICATE)
 15759*             RIDFLD    (OC-CONTROL-PRIMARY)
 15760*             RESP      (WS-RESPONSE)
 15761*          END-EXEC
 15762     MOVE LENGTH OF
 15763      ORIGINAL-CERTIFICATE
 15764       TO DFHEIV11
 15765     MOVE 'ELCRTO' TO DFHEIV1
 15766*    MOVE '&$ L                  ''  N#00013964' TO DFHEIV0
 15767     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15768     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15769     MOVE X'204E233030303133393634' TO DFHEIV0(25:11)
 15770     CALL 'kxdfhei1' USING DFHEIV0,
 15771           DFHEIV1,
 15772           ORIGINAL-CERTIFICATE,
 15773           DFHEIV11,
 15774           OC-CONTROL-PRIMARY,
 15775           DFHEIV99,
 15776           DFHEIV99
 15777     MOVE EIBRESP  TO WS-RESPONSE
 15778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15779        END-IF
 15780     ELSE
 15781        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15782        MOVE 'OC'                TO OC-RECORD-ID
 15783        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15784                                 TO OC-CONTROL-PRIMARY (1:33)
 15785        MOVE 'I'                 TO OC-RECORD-TYPE
 15786        MOVE +4096               TO OC-KEY-SEQ-NO
 15787        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15788        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 287
* EL6311.cbl
 15789        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15790        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15791        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15792        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15793        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15794        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15795        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15796        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15797        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15798        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15799        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15800        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15801        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15802        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15803        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15804        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15805        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15806        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15807        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15808        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15809        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15810        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15811        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15812        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15813        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15814        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15815        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15816        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15817        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15818        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15819        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15820        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15821        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15822        IF ERMAIL-FOUND
 15823           MOVE MA-CRED-BENE-NAME
 15824                                 TO OC-CRED-BENE-NAME
 15825        END-IF
 15826        IF NOT CERT-TRL-REC-NOT-FOUND
 15827           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15828                           OC-INS-AGE-DEFAULT-FLAG
 15829           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15830                           OC-JNT-AGE-DEFAULT-FLAG
 15831        END-IF
 15832        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15833
 15834
 15835* EXEC CICS WRITE
 15836*          DATASET   ('ELCRTO')
 15837*          FROM      (ORIGINAL-CERTIFICATE)
 15838*          RIDFLD    (OC-CONTROL-PRIMARY)
 15839*          RESP      (WS-RESPONSE)
 15840*       END-EXEC
 15841     MOVE LENGTH OF
 15842      ORIGINAL-CERTIFICATE
 15843       TO DFHEIV11
 15844     MOVE 'ELCRTO' TO DFHEIV1
 15845*    MOVE '&$ L                  ''  N#00014025' TO DFHEIV0
 15846     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 288
* EL6311.cbl
 15847     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15848     MOVE X'204E233030303134303235' TO DFHEIV0(25:11)
 15849     CALL 'kxdfhei1' USING DFHEIV0,
 15850           DFHEIV1,
 15851           ORIGINAL-CERTIFICATE,
 15852           DFHEIV11,
 15853           OC-CONTROL-PRIMARY,
 15854           DFHEIV99,
 15855           DFHEIV99
 15856     MOVE EIBRESP  TO WS-RESPONSE
 15857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15858     END-IF.
 15859
 15860 2376-BYPASS-CRTO.
 15861******************************************************************
 15862*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15863******************************************************************
 15864
 15865
 15866* EXEC CICS HANDLE CONDITION
 15867*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15868*    END-EXEC.
 15869*    MOVE '"$I                   ! 7 #00014038' TO DFHEIV0
 15870     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15871     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15872     MOVE X'3720233030303134303338' TO DFHEIV0(25:11)
 15873     CALL 'kxdfhei1' USING DFHEIV0
 15874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15875
 15876
 15877
 15878* EXEC CICS READ
 15879*        INTO    (PENDING-BUSINESS)
 15880*        DATASET (FILE-ID-ERPNDB)
 15881*        RIDFLD  (ERPNDB-KEY)
 15882*        UPDATE
 15883*    END-EXEC.
 15884     MOVE LENGTH OF
 15885      PENDING-BUSINESS
 15886       TO DFHEIV11
 15887*    MOVE '&"IL       EU         (   #00014042' TO DFHEIV0
 15888     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15889     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15890     MOVE X'2020233030303134303432' TO DFHEIV0(25:11)
 15891     CALL 'kxdfhei1' USING DFHEIV0,
 15892           FILE-ID-ERPNDB,
 15893           PENDING-BUSINESS,
 15894           DFHEIV11,
 15895           ERPNDB-KEY,
 15896           DFHEIV99,
 15897           DFHEIV99,
 15898           DFHEIV99
 15899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15900
 15901
 15902     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15903     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15904     MOVE 'B'                    TO JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 289
* EL6311.cbl
 15905     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15906
 15907     PERFORM 8400-LOG-JOURNAL-RECORD.
 15908
 15909     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15910
 15911
 15912* EXEC CICS REWRITE
 15913*        DATASET (FILE-ID-ERPNDB)
 15914*        FROM    (PENDING-BUSINESS)
 15915*    END-EXEC.
 15916     MOVE LENGTH OF
 15917      PENDING-BUSINESS
 15918       TO DFHEIV11
 15919*    MOVE '&& L                  %   #00014058' TO DFHEIV0
 15920     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15921     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15922     MOVE X'2020233030303134303538' TO DFHEIV0(25:11)
 15923     CALL 'kxdfhei1' USING DFHEIV0,
 15924           FILE-ID-ERPNDB,
 15925           PENDING-BUSINESS,
 15926           DFHEIV11,
 15927           DFHEIV99
 15928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15929
 15930
 15931     MOVE 'C'                    TO JP-RECORD-TYPE.
 15932     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15933
 15934     PERFORM 8400-LOG-JOURNAL-RECORD.
 15935
 15936     IF WS-ERRORS-PRESENT
 15937         GO TO 3900-RE-DISPLAY-RECORD.
 15938
 15939     MOVE ZEROS                  TO EMI-ERROR
 15940     MOVE -1                     TO CMAINTL
 15941     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15942     GO TO 3900-RE-DISPLAY-RECORD.
 15943
 15944 2380-BATCH-HDR-NOT-FOUND.
 15945     MOVE -1                     TO BMAINTL.
 15946     MOVE ER-7450                TO EMI-ERROR.
 15947     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15948     GO TO 8200-SEND-DATAONLY.
 15949
 15950 2385-REC-NOT-FOUND.
 15951     MOVE -1                     TO BMAINTL.
 15952     MOVE ER-7451                TO EMI-ERROR.
 15953     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15954     GO TO 8200-SEND-DATAONLY.
 15955
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 290
* EL6311.cbl
 15957
 15958******************************************************************
 15959*                                                                *
 15960*          D E L E T E   C A N C E L   R O U T I N E             *
 15961*                                                                *
 15962******************************************************************
 15963
 15964 2400-DELETE-CANCEL-ROUTINE.
 15965     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15966
 15967     IF CCHGL NOT = ZEROS
 15968        MOVE ER-2196             TO EMI-ERROR
 15969        MOVE AL-UABON            TO CMAINTA
 15970        MOVE -1                  TO CMAINTL
 15971        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15972        GO TO 8200-SEND-DATAONLY.
 15973
 15974
 15975* EXEC CICS HANDLE CONDITION
 15976*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15977*    END-EXEC.
 15978*    MOVE '"$I                   ! 8 #00014106' TO DFHEIV0
 15979     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15980     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15981     MOVE X'3820233030303134313036' TO DFHEIV0(25:11)
 15982     CALL 'kxdfhei1' USING DFHEIV0
 15983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15984
 15985
 15986     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15987     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15988     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15989
 15990
 15991* EXEC CICS READ
 15992*        SET     (ADDRESS OF PENDING-BUSINESS)
 15993*        DATASET (FILE-ID-ERPNDB)
 15994*        RIDFLD  (ERPNDB-KEY)
 15995*    END-EXEC.
 15996*    MOVE '&"S        E          (   #00014114' TO DFHEIV0
 15997     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15998     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15999     MOVE X'2020233030303134313134' TO DFHEIV0(25:11)
 16000     CALL 'kxdfhei1' USING DFHEIV0,
 16001           FILE-ID-ERPNDB,
 16002           DFHEIV20,
 16003           DFHEIV99,
 16004           ERPNDB-KEY,
 16005           DFHEIV99,
 16006           DFHEIV99,
 16007           DFHEIV99
 16008     SET ADDRESS OF PENDING-BUSINESS TO
 16009         DFHEIV20
 16010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16011
 16012
 16013     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16014
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 291
* EL6311.cbl
 16015     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16016
 16017     IF CSUFIXL NOT = ZEROS
 16018        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16019     ELSE
 16020        MOVE SPACE               TO WS-NEW-SUFFIX.
 16021
 16022     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16023
 16024     PERFORM 8600-DEEDIT.
 16025     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16026     MOVE '4'                    TO DC-OPTION-CODE.
 16027     PERFORM 9700-DATE-LINK.
 16028
 16029     IF DATE-CONVERSION-ERROR
 16030        MOVE ER-0348             TO EMI-ERROR
 16031        MOVE -1                  TO CEFFDTL
 16032        MOVE AL-UABON            TO CEFFDTA
 16033        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16034        GO TO 8200-SEND-DATAONLY
 16035     ELSE
 16036        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16037        MOVE AL-UANON            TO CEFFDTA
 16038        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16039
 16040
 16041* EXEC CICS HANDLE CONDITION
 16042*         NOTFND    (2490-RECORD-NOT-FOUND)
 16043*    END-EXEC.
 16044*    MOVE '"$I                   ! 9 #00014147' TO DFHEIV0
 16045     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16046     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16047     MOVE X'3920233030303134313437' TO DFHEIV0(25:11)
 16048     CALL 'kxdfhei1' USING DFHEIV0
 16049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16050
 16051
 16052
 16053* EXEC CICS READ
 16054*        SET     (ADDRESS OF PENDING-BUSINESS)
 16055*        DATASET (FILE-ID-ERPNDB)
 16056*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16057*        UPDATE
 16058*    END-EXEC.
 16059*    MOVE '&"S        EU         (   #00014151' TO DFHEIV0
 16060     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16061     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16062     MOVE X'2020233030303134313531' TO DFHEIV0(25:11)
 16063     CALL 'kxdfhei1' USING DFHEIV0,
 16064           FILE-ID-ERPNDB,
 16065           DFHEIV20,
 16066           DFHEIV99,
 16067           PI-PREV-CONTROL-PRIMARY,
 16068           DFHEIV99,
 16069           DFHEIV99,
 16070           DFHEIV99
 16071     SET ADDRESS OF PENDING-BUSINESS TO
 16072         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 292
* EL6311.cbl
 16073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16074
 16075
 16076     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16077        MOVE -1                 TO CMAINTL
 16078        MOVE ER-2197            TO EMI-ERROR
 16079        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16080        GO TO 8200-SEND-DATAONLY.
 16081
 16082     IF PB-BILLED-DT NOT = LOW-VALUES
 16083        MOVE -1                 TO CMAINTL
 16084        MOVE ER-2129            TO EMI-ERROR
 16085        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16086        GO TO 8200-SEND-DATAONLY.
 16087
 16088     IF PB-CHG-COUNT NOT = ZEROS
 16089        MOVE ER-2336            TO EMI-ERROR
 16090        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16091        MOVE AL-UABON            TO CMAINTA
 16092        MOVE -1                  TO CMAINTL
 16093        GO TO 8200-SEND-DATAONLY.
 16094
 16095     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16096        PB-CHG-COUNT NOT = ZEROS
 16097        MOVE ER-2196             TO EMI-ERROR
 16098        MOVE AL-UABON            TO CMAINTA
 16099        MOVE -1                  TO CMAINTL
 16100        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16101        GO TO 8200-SEND-DATAONLY.
 16102
 16103     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16104        MOVE ER-2900 TO EMI-ERROR
 16105        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16106        MOVE AL-UABON         TO CMAINTA
 16107        MOVE -1               TO CMAINTL
 16108        GO TO 8200-SEND-DATAONLY.
 16109     move ' '                    to ws-stop-sw
 16110                                    ws-check-sw
 16111                                    ws-proc-check-sw
 16112                                    ws-chek-browse-sw
 16113
 16114     perform 2500-browse-checks  thru 2500-exit
 16115     if i-have-processed-checks
 16116        move er-3446             to emi-error
 16117        perform 9900-error-format thru 9900-exit
 16118        move al-uabon            to cmainta
 16119        move -1                  to cmaintl
 16120        go to 8200-send-dataonly
 16121     end-if
 16122
 16123* EXEC CICS HANDLE CONDITION
 16124*         NOTFND  (2475-CONTINUE-DELETE)
 16125*    END-EXEC
 16126*    MOVE '"$I                   ! : #00014204' TO DFHEIV0
 16127     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16128     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16129     MOVE X'3A20233030303134323034' TO DFHEIV0(25:11)
 16130     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 293
* EL6311.cbl
 16131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16132
 16133     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16134     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16135     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16136     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16137
 16138
 16139* EXEC CICS READ
 16140*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16141*        DATASET (FILE-ID-ELCERT)
 16142*        RIDFLD  (ELCERT-KEY)
 16143*        UPDATE
 16144*    END-EXEC.
 16145*    MOVE '&"S        EU         (   #00014213' TO DFHEIV0
 16146     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16147     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16148     MOVE X'2020233030303134323133' TO DFHEIV0(25:11)
 16149     CALL 'kxdfhei1' USING DFHEIV0,
 16150           FILE-ID-ELCERT,
 16151           DFHEIV20,
 16152           DFHEIV99,
 16153           ELCERT-KEY,
 16154           DFHEIV99,
 16155           DFHEIV99,
 16156           DFHEIV99
 16157     SET ADDRESS OF CERTIFICATE-MASTER TO
 16158         DFHEIV20
 16159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16160
 16161
 16162     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16163
 16164     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16165     MOVE 'B'                    TO JP-RECORD-TYPE.
 16166     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16167     PERFORM 8400-LOG-JOURNAL-RECORD.
 16168
 16169     IF PB-CI-LIVES NOT NUMERIC
 16170         MOVE ZERO                    TO PB-CI-LIVES.
 16171
 16172     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16173        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16174           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16175           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16176           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16177                                            CM-LF-CANCEL-DT
 16178           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16179        ELSE
 16180           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16181           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16182           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16183           MOVE PB-CI-LIVES              TO CM-LIVES.
 16184
 16185     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16186        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16187           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16188               MOVE CM-LF-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 294
* EL6311.cbl
 16189                                        TO CM-LF-CURRENT-STATUS
 16190               MOVE SPACE
 16191                                        TO CM-LF-STATUS-AT-CANCEL
 16192           ELSE
 16193               MOVE PB-CI-LF-POLICY-STATUS
 16194                                        TO CM-LF-CURRENT-STATUS
 16195        ELSE
 16196           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16197
 16198
 16199     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16200        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16201           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16202           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16203           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16204                                            CM-AH-CANCEL-DT
 16205           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16206        ELSE
 16207           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16208           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16209           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16210           MOVE PB-CI-LIVES              TO CM-LIVES.
 16211
 16212     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16213        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16214           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16215               MOVE CM-AH-STATUS-AT-CANCEL
 16216                                        TO CM-AH-CURRENT-STATUS
 16217               MOVE SPACE
 16218                                        TO CM-AH-STATUS-AT-CANCEL
 16219           ELSE
 16220               MOVE PB-CI-AH-POLICY-STATUS
 16221                                        TO CM-AH-CURRENT-STATUS
 16222        ELSE
 16223           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16224
 16225 2450-REWRITE-CERT.
 16226     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16227     MOVE 'C'                      TO JP-RECORD-TYPE.
 16228     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16229
 16230
 16231* EXEC CICS REWRITE
 16232*        DATASET  (FILE-ID-ELCERT)
 16233*        FROM     (CERTIFICATE-MASTER)
 16234*    END-EXEC.
 16235     MOVE LENGTH OF
 16236      CERTIFICATE-MASTER
 16237       TO DFHEIV11
 16238*    MOVE '&& L                  %   #00014288' TO DFHEIV0
 16239     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16240     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16241     MOVE X'2020233030303134323838' TO DFHEIV0(25:11)
 16242     CALL 'kxdfhei1' USING DFHEIV0,
 16243           FILE-ID-ELCERT,
 16244           CERTIFICATE-MASTER,
 16245           DFHEIV11,
 16246           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 295
* EL6311.cbl
 16247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16248
 16249
 16250     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16251
 16252     PERFORM 8400-LOG-JOURNAL-RECORD.
 16253
 16254     move ' '                    to ws-stop-sw
 16255                                    ws-proc-check-sw
 16256                                    ws-chek-browse-sw
 16257
 16258     if i-have-checks
 16259        perform until i-say-stop
 16260           perform 2510-startbr-erchek
 16261                                 thru 2510-exit
 16262           if resp-normal
 16263              perform 2520-readnext-erchek
 16264                                 thru 2520-exit
 16265           end-if
 16266           if (not resp-normal)
 16267              or (pb-control-by-account (1:33) not =
 16268                 ch-control-primary (1:33))
 16269                 set i-say-stop to true
 16270           else
 16271              perform 2530-readupd-erchek
 16272                                 thru 2530-exit
 16273              if resp-normal
 16274                 perform 2540-delete-erchek
 16275                                 thru 2540-exit
 16276              end-if
 16277              if ws-chek-browse-sw = 'Y'
 16278                 perform 2525-endbr-erchek
 16279                                 thru 2525-exit
 16280                 move ' '        to ws-chek-browse-sw
 16281              end-if
 16282           end-if
 16283        end-perform
 16284     end-if
 16285
 16286     if ws-chek-browse-sw = 'Y'
 16287        perform 2525-endbr-erchek thru 2525-exit
 16288     end-if
 16289     .
 16290 2475-CONTINUE-DELETE.
 16291     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16292     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16293
 16294     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16295     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16296
 16297     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16298
 16299     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16300     MOVE 'D'                    TO JP-RECORD-TYPE
 16301     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16302
 16303
 16304* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 296
* EL6311.cbl
 16305*        DATASET    (FILE-ID-ERPNDB)
 16306*    END-EXEC.
 16307*    MOVE '&(                    &   #00014346' TO DFHEIV0
 16308     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16309     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16310     MOVE X'2020233030303134333436' TO DFHEIV0(25:11)
 16311     CALL 'kxdfhei1' USING DFHEIV0,
 16312           FILE-ID-ERPNDB,
 16313           DFHEIV99,
 16314           DFHEIV99,
 16315           DFHEIV99,
 16316           DFHEIV99
 16317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16318
 16319
 16320     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16321
 16322     PERFORM 8400-LOG-JOURNAL-RECORD.
 16323
 16324     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16325     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16326
 16327
 16328* EXEC CICS HANDLE CONDITION
 16329*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16330*    END-EXEC.
 16331*    MOVE '"$I                   ! ; #00014357' TO DFHEIV0
 16332     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16333     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16334     MOVE X'3B20233030303134333537' TO DFHEIV0(25:11)
 16335     CALL 'kxdfhei1' USING DFHEIV0
 16336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16337
 16338
 16339
 16340* EXEC CICS READ
 16341*        SET     (ADDRESS OF PENDING-BUSINESS)
 16342*        DATASET (FILE-ID-ERPNDB)
 16343*        RIDFLD  (ERPNDB-KEY)
 16344*        UPDATE
 16345*    END-EXEC.
 16346*    MOVE '&"S        EU         (   #00014361' TO DFHEIV0
 16347     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16348     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16349     MOVE X'2020233030303134333631' TO DFHEIV0(25:11)
 16350     CALL 'kxdfhei1' USING DFHEIV0,
 16351           FILE-ID-ERPNDB,
 16352           DFHEIV20,
 16353           DFHEIV99,
 16354           ERPNDB-KEY,
 16355           DFHEIV99,
 16356           DFHEIV99,
 16357           DFHEIV99
 16358     SET ADDRESS OF PENDING-BUSINESS TO
 16359         DFHEIV20
 16360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16361
 16362
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 297
* EL6311.cbl
 16363     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16364     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16365
 16366     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16367        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16368        MOVE 'D'                 TO JP-RECORD-TYPE
 16369        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16370
 16371* EXEC CICS DELETE
 16372*            DATASET    (FILE-ID-ERPNDB)
 16373*       END-EXEC
 16374*    MOVE '&(                    &   #00014375' TO DFHEIV0
 16375     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16376     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16377     MOVE X'2020233030303134333735' TO DFHEIV0(25:11)
 16378     CALL 'kxdfhei1' USING DFHEIV0,
 16379           FILE-ID-ERPNDB,
 16380           DFHEIV99,
 16381           DFHEIV99,
 16382           DFHEIV99,
 16383           DFHEIV99
 16384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16385        PERFORM 8400-LOG-JOURNAL-RECORD
 16386     ELSE
 16387        MOVE 'B'                 TO JP-RECORD-TYPE
 16388        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16389        PERFORM 8400-LOG-JOURNAL-RECORD
 16390        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16391        MOVE 'C'                 TO JP-RECORD-TYPE
 16392        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16393
 16394* EXEC CICS REWRITE
 16395*            DATASET    (FILE-ID-ERPNDB)
 16396*            FROM       (PENDING-BUSINESS)
 16397*       END-EXEC
 16398     MOVE LENGTH OF
 16399      PENDING-BUSINESS
 16400       TO DFHEIV11
 16401*    MOVE '&& L                  %   #00014386' TO DFHEIV0
 16402     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16403     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16404     MOVE X'2020233030303134333836' TO DFHEIV0(25:11)
 16405     CALL 'kxdfhei1' USING DFHEIV0,
 16406           FILE-ID-ERPNDB,
 16407           PENDING-BUSINESS,
 16408           DFHEIV11,
 16409           DFHEIV99
 16410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16411        PERFORM 8400-LOG-JOURNAL-RECORD.
 16412
 16413******************************************************************
 16414*                                                                *
 16415*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16416*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16417*                                                                *
 16418******************************************************************
 16419
 16420     IF NOT PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 298
* EL6311.cbl
 16421        GO TO 2480-DELETE-FINISHED.
 16422
 16423     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16424        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16425        NEXT SENTENCE
 16426     ELSE
 16427        GO TO 2480-DELETE-FINISHED.
 16428
 16429
 16430* EXEC CICS HANDLE CONDITION
 16431*         NOTFND    (2480-DELETE-FINISHED)
 16432*    END-EXEC.
 16433*    MOVE '"$I                   ! < #00014408' TO DFHEIV0
 16434     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16435     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16436     MOVE X'3C20233030303134343038' TO DFHEIV0(25:11)
 16437     CALL 'kxdfhei1' USING DFHEIV0
 16438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16439
 16440
 16441     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16442     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16443
 16444
 16445* EXEC CICS READ
 16446*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16447*        DATASET (FILE-ID-ERRQST)
 16448*        RIDFLD  (ERRQST-KEY)
 16449*        UPDATE
 16450*    END-EXEC.
 16451*    MOVE '&"S        EU         (   #00014415' TO DFHEIV0
 16452     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16453     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16454     MOVE X'2020233030303134343135' TO DFHEIV0(25:11)
 16455     CALL 'kxdfhei1' USING DFHEIV0,
 16456           FILE-ID-ERRQST,
 16457           DFHEIV20,
 16458           DFHEIV99,
 16459           ERRQST-KEY,
 16460           DFHEIV99,
 16461           DFHEIV99,
 16462           DFHEIV99
 16463     SET ADDRESS OF AR-REQUEST-RECORD TO
 16464         DFHEIV20
 16465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16466
 16467
 16468     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16469
 16470     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16471
 16472     MOVE 'D'                      TO JP-RECORD-TYPE.
 16473     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16474
 16475
 16476* EXEC CICS DELETE
 16477*         DATASET    (FILE-ID-ERRQST)
 16478*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 299
* EL6311.cbl
 16479*    MOVE '&(                    &   #00014429' TO DFHEIV0
 16480     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16481     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16482     MOVE X'2020233030303134343239' TO DFHEIV0(25:11)
 16483     CALL 'kxdfhei1' USING DFHEIV0,
 16484           FILE-ID-ERRQST,
 16485           DFHEIV99,
 16486           DFHEIV99,
 16487           DFHEIV99,
 16488           DFHEIV99
 16489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16490
 16491
 16492     PERFORM 8400-LOG-JOURNAL-RECORD.
 16493
 16494 2480-DELETE-FINISHED.
 16495     MOVE ZEROS                  TO EMI-ERROR.
 16496     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16497     MOVE LOW-VALUES             TO EL631CI.
 16498     MOVE -1                     TO CMAINTL.
 16499     GO TO 8100-SEND-INITIAL-MAP.
 16500
 16501 2485-BATCH-HDR-NOT-FOUND.
 16502     MOVE -1                     TO CMAINTL
 16503     MOVE AL-UABON               TO CMAINTA.
 16504     MOVE ER-7450                TO EMI-ERROR.
 16505     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16506     GO TO 8200-SEND-DATAONLY.
 16507
 16508 2490-RECORD-NOT-FOUND.
 16509     MOVE -1                     TO CMAINTL
 16510     MOVE AL-UABON               TO CMAINTA.
 16511     MOVE ER-7451                TO EMI-ERROR.
 16512     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16513     GO TO 8200-SEND-DATAONLY.
 16514***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16515***                                                            ***
 16516***     2500  B R O W S E   C H E C K S                        ***
 16517***  We perform this routine from 2 different places.          ***
 16518***  1. If the user changes the refund amount on a cancel, we  ***
 16519***    want to.........                                        ***
 16520***    a. determine if prior checks have been processed        ***
 16521***    b. If the amt is larger, display message instructing    ***
 16522***     them to create another check to make up the difference.***
 16523***    c. If the amt is less, do not allow the change and      ***
 16524***     display a FATAL error suggesting they deal with check  ***
 16525***     records befor continuing.                              ***
 16526***  2. If the user wants to delete a cancel record we......   ***
 16527***    a. browse through all the checks and if there is a      ***
 16528***     processed check, send FATAL message.                   ***
 16529***    b. If there is a non-released check, then delete that   ***
 16530***     check after you delete the pending cancel record.      ***
 16531***                                                            ***
 16532***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16533
 16534 2500-browse-checks.
 16535
 16536     perform 2510-startbr-erchek thru 2510-exit
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 300
* EL6311.cbl
 16537
 16538     if not resp-normal
 16539        go to 2500-exit
 16540     end-if
 16541
 16542     perform until i-say-stop
 16543        perform 2520-readnext-erchek
 16544                                 thru 2520-exit
 16545        if (not resp-normal)
 16546           or (pb-control-by-account (1:33) not =
 16547              ch-control-primary (1:33))
 16548              set i-say-stop to true
 16549        else
 16550           if (ch-approval-status) = ' '
 16551              and (ch-void-dt = low-values)
 16552              and (ch-released-dt = low-values)
 16553              set i-have-checks to true
 16554           else
 16555              set i-have-processed-checks to true
 16556           end-if
 16557           if (ch-credit-accept-dt = low-values)
 16558              and (ch-void-dt = low-values)
 16559              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16560              compute ws-check-amts = ws-check-amts +
 16561                 ch-amount-paid
 16562           end-if
 16563        end-if
 16564     end-perform
 16565
 16566     if ws-chek-browse-sw = 'Y'
 16567        perform 2525-endbr-erchek thru 2525-exit
 16568     end-if
 16569
 16570    .
 16571 2500-exit.
 16572     exit.
 16573
 16574 2510-startbr-erchek.
 16575
 16576     move pb-control-by-account  to erchek-key
 16577     move +0                     to chek-record-seq
 16578
 16579
 16580* exec cics startbr
 16581*       dataset   ('ERCHEK')
 16582*       ridfld    (erchek-key)
 16583*       gteq
 16584*       resp      (ws-response)
 16585*    end-exec
 16586     MOVE 'ERCHEK' TO DFHEIV1
 16587     MOVE 0
 16588       TO DFHEIV11
 16589*    MOVE '&,         G          &  N#00014520' TO DFHEIV0
 16590     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16591     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16592     MOVE X'204E233030303134353230' TO DFHEIV0(25:11)
 16593     CALL 'kxdfhei1' USING DFHEIV0,
 16594           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 301
* EL6311.cbl
 16595           erchek-key,
 16596           DFHEIV99,
 16597           DFHEIV11,
 16598           DFHEIV99
 16599     MOVE EIBRESP  TO ws-response
 16600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16601
 16602     IF RESP-NORMAL
 16603        move 'Y'                 to ws-chek-browse-sw
 16604     end-if
 16605
 16606     .
 16607 2510-exit.
 16608     exit.
 16609
 16610 2520-readnext-erchek.
 16611
 16612
 16613* EXEC CICS READNEXT
 16614*       SET     (ADDRESS OF CHECK-RECORDS)
 16615*       DATASET ('ERCHEK')
 16616*       RIDFLD  (ERCHEK-KEY)
 16617*       RESP    (WS-RESPONSE)
 16618*    END-EXEC
 16619     MOVE 'ERCHEK' TO DFHEIV1
 16620     MOVE 0
 16621       TO DFHEIV11
 16622*    MOVE '&.S                   )  N#00014537' TO DFHEIV0
 16623     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16624     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16625     MOVE X'204E233030303134353337' TO DFHEIV0(25:11)
 16626     CALL 'kxdfhei1' USING DFHEIV0,
 16627           DFHEIV1,
 16628           DFHEIV20,
 16629           DFHEIV99,
 16630           ERCHEK-KEY,
 16631           DFHEIV99,
 16632           DFHEIV11,
 16633           DFHEIV99,
 16634           DFHEIV99
 16635     SET ADDRESS OF CHECK-RECORDS TO
 16636         DFHEIV20
 16637     MOVE EIBRESP  TO WS-RESPONSE
 16638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16639
 16640     .
 16641 2520-exit.
 16642     exit.
 16643
 16644 2525-endbr-erchek.
 16645
 16646
 16647* exec cics endbr
 16648*       dataset  ('ERCHEK')
 16649*    end-exec
 16650     MOVE 'ERCHEK' TO DFHEIV1
 16651     MOVE 0
 16652       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 302
* EL6311.cbl
 16653*    MOVE '&2                    $   #00014550' TO DFHEIV0
 16654     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16655     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16656     MOVE X'2020233030303134353530' TO DFHEIV0(25:11)
 16657     CALL 'kxdfhei1' USING DFHEIV0,
 16658           DFHEIV1,
 16659           DFHEIV11,
 16660           DFHEIV99
 16661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16662
 16663     .
 16664 2525-exit.
 16665     exit.
 16666
 16667 2530-readupd-erchek.
 16668
 16669
 16670* EXEC CICS READ
 16671*       UPDATE
 16672*       SET     (ADDRESS OF CHECK-RECORDS)
 16673*       DATASET ('ERCHEK')
 16674*       RIDFLD  (ERCHEK-KEY)
 16675*       RESP    (WS-RESPONSE)
 16676*    END-EXEC
 16677     MOVE 'ERCHEK' TO DFHEIV1
 16678*    MOVE '&"S        EU         (  N#00014560' TO DFHEIV0
 16679     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16680     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16681     MOVE X'204E233030303134353630' TO DFHEIV0(25:11)
 16682     CALL 'kxdfhei1' USING DFHEIV0,
 16683           DFHEIV1,
 16684           DFHEIV20,
 16685           DFHEIV99,
 16686           ERCHEK-KEY,
 16687           DFHEIV99,
 16688           DFHEIV99,
 16689           DFHEIV99
 16690     SET ADDRESS OF CHECK-RECORDS TO
 16691         DFHEIV20
 16692     MOVE EIBRESP  TO WS-RESPONSE
 16693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16694
 16695     .
 16696 2530-exit.
 16697     exit.
 16698
 16699 2540-delete-erchek.
 16700
 16701
 16702* EXEC CICS DELETE
 16703*       DATASET ('ERCHEK')
 16704*       RESP    (WS-RESPONSE)
 16705*    END-EXEC
 16706     MOVE 'ERCHEK' TO DFHEIV1
 16707*    MOVE '&(                    &  N#00014574' TO DFHEIV0
 16708     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16709     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16710     MOVE X'204E233030303134353734' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 303
* EL6311.cbl
 16711     CALL 'kxdfhei1' USING DFHEIV0,
 16712           DFHEIV1,
 16713           DFHEIV99,
 16714           DFHEIV99,
 16715           DFHEIV99,
 16716           DFHEIV99
 16717     MOVE EIBRESP  TO WS-RESPONSE
 16718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16719
 16720     .
 16721 2540-exit.
 16722     exit.
 16723***************************************************************
 16724*                                                             *
 16725*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16726*                                                             *
 16727***************************************************************
 16728
 16729***************************************************************
 16730*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16731*     AN ALREADY BILLED RECORD.                               *
 16732***************************************************************
 16733
 16734 2700-BUILD-CORRECTION-RECORD.
 16735     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16736     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16737     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16738     MOVE '5'                    TO DC-OPTION-CODE.
 16739     PERFORM 9700-DATE-LINK.
 16740     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16741
 16742     IF PB-CHG-COUNT = ZEROS
 16743        MOVE +1                  TO WS-SEQ-SAVE
 16744     ELSE
 16745        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16746
 16747     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16748     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16749
 16750     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16751
 16752     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16753     MOVE 'A'                    TO JP-RECORD-TYPE.
 16754     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16755
 16756
 16757* EXEC CICS WRITE
 16758*        DATASET    (FILE-ID-ERPNDB)
 16759*        FROM       (PENDING-BUSINESS)
 16760*        RIDFLD     (PB-CONTROL-PRIMARY)
 16761*    END-EXEC.
 16762     MOVE LENGTH OF
 16763      PENDING-BUSINESS
 16764       TO DFHEIV11
 16765*    MOVE '&$ L                  ''   #00014615' TO DFHEIV0
 16766     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16767     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16768     MOVE X'2020233030303134363135' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 304
* EL6311.cbl
 16769     CALL 'kxdfhei1' USING DFHEIV0,
 16770           FILE-ID-ERPNDB,
 16771           PENDING-BUSINESS,
 16772           DFHEIV11,
 16773           PB-CONTROL-PRIMARY,
 16774           DFHEIV99,
 16775           DFHEIV99
 16776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16777
 16778
 16779     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16780
 16781     PERFORM 8400-LOG-JOURNAL-RECORD.
 16782
 16783 2799-EXIT.
 16784      EXIT.
 16785
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 305
* EL6311.cbl
 16787
 16788******************************************************************
 16789*                                                                *
 16790*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16791*                                                                *
 16792******************************************************************
 16793
 16794 2800-REWRITE-ISSUE-CERT-KEY.
 16795     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16796
 16797     IF  BCERTNOL GREATER THAN ZEROS
 16798         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16799
 16800     IF  BSUFIXL  GREATER THAN ZEROS
 16801         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16802
 16803     IF  BEFFDTL  GREATER THAN ZEROS
 16804         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16805
 16806 2810-READ-BY-ACCOUNT.
 16807
 16808* EXEC CICS HANDLE CONDITION
 16809*         NOTFND    (2820-PROCESS-REWRITE)
 16810*    END-EXEC.
 16811*    MOVE '"$I                   ! = #00014649' TO DFHEIV0
 16812     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16813     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16814     MOVE X'3D20233030303134363439' TO DFHEIV0(25:11)
 16815     CALL 'kxdfhei1' USING DFHEIV0
 16816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16817
 16818
 16819
 16820* EXEC CICS READ
 16821*        SET     (ADDRESS OF PENDING-BUSINESS)
 16822*        DATASET (FILE-ID-ERPNDB2)
 16823*        RIDFLD  (ERPNDB-ALT-KEY)
 16824*    END-EXEC.
 16825*    MOVE '&"S        E          (   #00014653' TO DFHEIV0
 16826     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16827     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16828     MOVE X'2020233030303134363533' TO DFHEIV0(25:11)
 16829     CALL 'kxdfhei1' USING DFHEIV0,
 16830           FILE-ID-ERPNDB2,
 16831           DFHEIV20,
 16832           DFHEIV99,
 16833           ERPNDB-ALT-KEY,
 16834           DFHEIV99,
 16835           DFHEIV99,
 16836           DFHEIV99
 16837     SET ADDRESS OF PENDING-BUSINESS TO
 16838         DFHEIV20
 16839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16840
 16841
 16842     GO TO 2890-DUPLICATE-RECORD.
 16843
 16844  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 306
* EL6311.cbl
 16845
 16846* EXEC CICS HANDLE CONDITION
 16847*         NOTFND    (2885-RECORD-MISSING)
 16848*    END-EXEC.
 16849*    MOVE '"$I                   ! > #00014662' TO DFHEIV0
 16850     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16851     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16852     MOVE X'3E20233030303134363632' TO DFHEIV0(25:11)
 16853     CALL 'kxdfhei1' USING DFHEIV0
 16854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16855
 16856
 16857     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16858
 16859
 16860* EXEC CICS READ
 16861*        SET     (ADDRESS OF PENDING-BUSINESS)
 16862*        DATASET (FILE-ID-ERPNDB)
 16863*        RIDFLD  (ERPNDB-KEY)
 16864*        UPDATE
 16865*    END-EXEC.
 16866*    MOVE '&"S        EU         (   #00014668' TO DFHEIV0
 16867     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16868     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16869     MOVE X'2020233030303134363638' TO DFHEIV0(25:11)
 16870     CALL 'kxdfhei1' USING DFHEIV0,
 16871           FILE-ID-ERPNDB,
 16872           DFHEIV20,
 16873           DFHEIV99,
 16874           ERPNDB-KEY,
 16875           DFHEIV99,
 16876           DFHEIV99,
 16877           DFHEIV99
 16878     SET ADDRESS OF PENDING-BUSINESS TO
 16879         DFHEIV20
 16880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16881
 16882
 16883     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16884     MOVE 'D'                    TO JP-RECORD-TYPE.
 16885     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16886     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16887
 16888     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16889
 16890     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16891     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16892     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16893
 16894
 16895* EXEC CICS DELETE
 16896*        DATASET    (FILE-ID-ERPNDB)
 16897*    END-EXEC.
 16898*    MOVE '&(                    &   #00014686' TO DFHEIV0
 16899     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16900     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16901     MOVE X'2020233030303134363836' TO DFHEIV0(25:11)
 16902     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 307
* EL6311.cbl
 16903           FILE-ID-ERPNDB,
 16904           DFHEIV99,
 16905           DFHEIV99,
 16906           DFHEIV99,
 16907           DFHEIV99
 16908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16909
 16910
 16911     PERFORM 8400-LOG-JOURNAL-RECORD.
 16912
 16913
 16914* EXEC CICS GETMAIN
 16915*        SET      (ADDRESS OF PENDING-BUSINESS)
 16916*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16917*        INITIMG  (GETMAIN-SPACE)
 16918*    END-EXEC.
 16919*    MOVE ',"IL                  $   #00014692' TO DFHEIV0
 16920     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16921     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16922     MOVE X'2020233030303134363932' TO DFHEIV0(25:11)
 16923     CALL 'kxdfhei1' USING DFHEIV0,
 16924           DFHEIV20,
 16925           ERPNDB-RECORD-LENGTH,
 16926           GETMAIN-SPACE
 16927     SET ADDRESS OF PENDING-BUSINESS TO
 16928         DFHEIV20
 16929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16930
 16931
 16932     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16933
 16934
 16935* EXEC CICS HANDLE CONDITION
 16936*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16937*    END-EXEC.
 16938*    MOVE '"$I                   ! ? #00014700' TO DFHEIV0
 16939     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16940     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16941     MOVE X'3F20233030303134373030' TO DFHEIV0(25:11)
 16942     CALL 'kxdfhei1' USING DFHEIV0
 16943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16944
 16945
 16946
 16947* EXEC CICS READ
 16948*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16949*        DATASET (FILE-ID-ELCERT)
 16950*        RIDFLD  (ELCERT-KEY)
 16951*        UPDATE
 16952*    END-EXEC.
 16953*    MOVE '&"S        EU         (   #00014704' TO DFHEIV0
 16954     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16955     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16956     MOVE X'2020233030303134373034' TO DFHEIV0(25:11)
 16957     CALL 'kxdfhei1' USING DFHEIV0,
 16958           FILE-ID-ELCERT,
 16959           DFHEIV20,
 16960           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 308
* EL6311.cbl
 16961           ELCERT-KEY,
 16962           DFHEIV99,
 16963           DFHEIV99,
 16964           DFHEIV99
 16965     SET ADDRESS OF CERTIFICATE-MASTER TO
 16966         DFHEIV20
 16967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16968
 16969
 16970     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16971     MOVE 'B'                    TO JP-RECORD-TYPE
 16972     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16973     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16974
 16975     IF INSURED-ADDR-PRESENT
 16976        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16977
 16978     IF CERT-NOTES-ARE-NOT-PRESENT
 16979        MOVE SPACE               TO WS-CERT-NOTE-SW
 16980     ELSE
 16981        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16982
 16983     IF CERT-ADDED-BATCH      OR
 16984        CERT-AND-CLAIM-ONLINE OR
 16985        CERT-WAS-CREATED-FOR-CLAIM
 16986        NEXT SENTENCE
 16987     ELSE
 16988        GO TO 2825-DELETE-CERTIFICATE.
 16989
 16990     PERFORM 8400-LOG-JOURNAL-RECORD.
 16991
 16992*********************************************************
 16993** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16994     IF CERT-ADDED-BATCH
 16995         GO TO 2822-REWRITE-ELCERT.
 16996*********************************************************
 16997
 16998     IF NO-CLAIM-ATTACHED
 16999        NEXT SENTENCE
 17000     ELSE
 17001        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17002        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17003
 17004 2822-REWRITE-ELCERT.
 17005     MOVE 'C'                    TO JP-RECORD-TYPE
 17006     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17007
 17008     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17009
 17010
 17011* EXEC CICS REWRITE
 17012*         DATASET    (FILE-ID-ELCERT)
 17013*         FROM       (CERTIFICATE-MASTER)
 17014*    END-EXEC.
 17015     MOVE LENGTH OF
 17016      CERTIFICATE-MASTER
 17017       TO DFHEIV11
 17018*    MOVE '&& L                  %   #00014751' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 309
* EL6311.cbl
 17019     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17020     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17021     MOVE X'2020233030303134373531' TO DFHEIV0(25:11)
 17022     CALL 'kxdfhei1' USING DFHEIV0,
 17023           FILE-ID-ELCERT,
 17024           CERTIFICATE-MASTER,
 17025           DFHEIV11,
 17026           DFHEIV99
 17027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17028
 17029
 17030     PERFORM 8400-LOG-JOURNAL-RECORD.
 17031
 17032     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17033
 17034 2825-DELETE-CERTIFICATE.
 17035     MOVE 'D'                      TO JP-RECORD-TYPE.
 17036     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17037
 17038     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17039
 17040
 17041* EXEC CICS DELETE
 17042*         DATASET    (FILE-ID-ELCERT)
 17043*    END-EXEC.
 17044*    MOVE '&(                    &   #00014766' TO DFHEIV0
 17045     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17046     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17047     MOVE X'2020233030303134373636' TO DFHEIV0(25:11)
 17048     CALL 'kxdfhei1' USING DFHEIV0,
 17049           FILE-ID-ELCERT,
 17050           DFHEIV99,
 17051           DFHEIV99,
 17052           DFHEIV99,
 17053           DFHEIV99
 17054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17055
 17056
 17057     PERFORM 8400-LOG-JOURNAL-RECORD.
 17058
 17059******************************************************************
 17060*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17061******************************************************************
 17062
 17063     IF CERT-NOTES-ARE-PRESENT
 17064        NEXT SENTENCE
 17065     ELSE
 17066        GO TO 2827-DELETE-MAILING.
 17067
 17068
 17069* EXEC CICS HANDLE CONDITION
 17070*         NOTFND  (2827-DELETE-MAILING)
 17071*    END-EXEC.
 17072*    MOVE '"$I                   ! @ #00014781' TO DFHEIV0
 17073     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17074     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17075     MOVE X'4020233030303134373831' TO DFHEIV0(25:11)
 17076     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 310
* EL6311.cbl
 17077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17078
 17079
 17080
 17081* EXEC CICS READ
 17082*        EQUAL
 17083*        DATASET   (FILE-ID-ERNOTE)
 17084*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17085*        RIDFLD    (ELCERT-KEY)
 17086*        UPDATE
 17087*    END-EXEC.
 17088*    MOVE '&"S        EU         (   #00014785' TO DFHEIV0
 17089     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17090     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17091     MOVE X'2020233030303134373835' TO DFHEIV0(25:11)
 17092     CALL 'kxdfhei1' USING DFHEIV0,
 17093           FILE-ID-ERNOTE,
 17094           DFHEIV20,
 17095           DFHEIV99,
 17096           ELCERT-KEY,
 17097           DFHEIV99,
 17098           DFHEIV99,
 17099           DFHEIV99
 17100     SET ADDRESS OF CERTIFICATE-NOTE TO
 17101         DFHEIV20
 17102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17103
 17104
 17105     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17106     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17107     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17108
 17109     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17110
 17111
 17112* EXEC CICS DELETE
 17113*        DATASET   (FILE-ID-ERNOTE)
 17114*    END-EXEC.
 17115*    MOVE '&(                    &   #00014799' TO DFHEIV0
 17116     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17117     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17118     MOVE X'2020233030303134373939' TO DFHEIV0(25:11)
 17119     CALL 'kxdfhei1' USING DFHEIV0,
 17120           FILE-ID-ERNOTE,
 17121           DFHEIV99,
 17122           DFHEIV99,
 17123           DFHEIV99,
 17124           DFHEIV99
 17125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17126
 17127
 17128     PERFORM 8400-LOG-JOURNAL-RECORD.
 17129
 17130******************************************************************
 17131*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17132******************************************************************
 17133
 17134 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 311
* EL6311.cbl
 17135     IF CERT-ADDRESS-PRESENT
 17136        NEXT SENTENCE
 17137     ELSE
 17138        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17139
 17140
 17141* EXEC CICS HANDLE CONDITION
 17142*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17143*    END-EXEC.
 17144*    MOVE '"$I                   ! A #00014815' TO DFHEIV0
 17145     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17146     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17147     MOVE X'4120233030303134383135' TO DFHEIV0(25:11)
 17148     CALL 'kxdfhei1' USING DFHEIV0
 17149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17150
 17151
 17152     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17153
 17154
 17155* EXEC CICS READ
 17156*        EQUAL
 17157*        DATASET   (FILE-ID-ERMAIL)
 17158*        SET       (ADDRESS OF MAILING-DATA)
 17159*        RIDFLD    (ERMAIL-KEY)
 17160*        UPDATE
 17161*    END-EXEC.
 17162*    MOVE '&"S        EU         (   #00014821' TO DFHEIV0
 17163     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17164     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17165     MOVE X'2020233030303134383231' TO DFHEIV0(25:11)
 17166     CALL 'kxdfhei1' USING DFHEIV0,
 17167           FILE-ID-ERMAIL,
 17168           DFHEIV20,
 17169           DFHEIV99,
 17170           ERMAIL-KEY,
 17171           DFHEIV99,
 17172           DFHEIV99,
 17173           DFHEIV99
 17174     SET ADDRESS OF MAILING-DATA TO
 17175         DFHEIV20
 17176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17177
 17178
 17179     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17180     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17181     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17182
 17183     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17184
 17185
 17186* EXEC CICS DELETE
 17187*        DATASET   (FILE-ID-ERMAIL)
 17188*    END-EXEC.
 17189*    MOVE '&(                    &   #00014835' TO DFHEIV0
 17190     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17191     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17192     MOVE X'2020233030303134383335' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 312
* EL6311.cbl
 17193     CALL 'kxdfhei1' USING DFHEIV0,
 17194           FILE-ID-ERMAIL,
 17195           DFHEIV99,
 17196           DFHEIV99,
 17197           DFHEIV99,
 17198           DFHEIV99
 17199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17200
 17201
 17202     PERFORM 8400-LOG-JOURNAL-RECORD.
 17203
 17204 2830-BUILD-NEW-ISSUE-RECORD.
 17205     MOVE SPACES                 TO ELCERT-KEY.
 17206
 17207     IF  BCERTNOL GREATER THAN ZEROS
 17208         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17209
 17210     IF  BSUFIXL  GREATER THAN ZEROS
 17211         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17212
 17213     IF BEFFDTL GREATER THAN ZEROS
 17214        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17215
 17216 2870-WRITE-PENDING-BUSINESS.
 17217     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17218     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17219     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17220     MOVE '5'                    TO DC-OPTION-CODE.
 17221     PERFORM 9700-DATE-LINK.
 17222     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17223
 17224     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17225
 17226     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17227     MOVE 'A'                    TO JP-RECORD-TYPE.
 17228     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17229
 17230
 17231* EXEC CICS WRITE
 17232*        DATASET  (FILE-ID-ERPNDB)
 17233*        FROM     (PENDING-BUSINESS)
 17234*        RIDFLD   (PB-CONTROL-PRIMARY)
 17235*    END-EXEC.
 17236     MOVE LENGTH OF
 17237      PENDING-BUSINESS
 17238       TO DFHEIV11
 17239*    MOVE '&$ L                  ''   #00014867' TO DFHEIV0
 17240     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17241     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17242     MOVE X'2020233030303134383637' TO DFHEIV0(25:11)
 17243     CALL 'kxdfhei1' USING DFHEIV0,
 17244           FILE-ID-ERPNDB,
 17245           PENDING-BUSINESS,
 17246           DFHEIV11,
 17247           PB-CONTROL-PRIMARY,
 17248           DFHEIV99,
 17249           DFHEIV99
 17250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 313
* EL6311.cbl
 17251
 17252
 17253     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17254
 17255     PERFORM 8400-LOG-JOURNAL-RECORD.
 17256
 17257     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17258
 17259 2885-RECORD-MISSING.
 17260     MOVE -1                     TO BMAINTL
 17261     MOVE AL-UABON               TO BMAINTA
 17262     MOVE ER-2902                TO EMI-ERROR.
 17263     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17264     GO TO 8200-SEND-DATAONLY.
 17265
 17266 2890-DUPLICATE-RECORD.
 17267     MOVE -1                     TO BMAINTL.
 17268     MOVE AL-UABON               TO BCERTNOA.
 17269     MOVE AL-UNBON               TO BEFFDTA.
 17270     MOVE SPACE                  TO BMAINTI.
 17271
 17272     MOVE 1                      TO EMI-SUB
 17273                                    EMI-SWITCH1
 17274                                    EMI-SWITCH-AREA-1
 17275                                    EMI-SWITCH-AREA-2.
 17276
 17277     MOVE SPACES                 TO EMI-ERROR-LINES.
 17278
 17279
 17280* EXEC CICS SYNCPOINT ROLLBACK
 17281*    END-EXEC.
 17282*    MOVE '6"R                   !   #00014899' TO DFHEIV0
 17283     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17284     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17285     MOVE X'2020233030303134383939' TO DFHEIV0(25:11)
 17286     CALL 'kxdfhei1' USING DFHEIV0
 17287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17288
 17289
 17290     MOVE ER-2247                TO EMI-ERROR.
 17291     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17292     GO TO 8200-SEND-DATAONLY.
 17293
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 314
* EL6311.cbl
 17295
 17296******************************************************************
 17297*                                                                *
 17298*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17299*                                                                *
 17300******************************************************************
 17301
 17302 2900-REWRITE-CAN-CERT-KEY.
 17303     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17304
 17305     IF  CCERTNOL GREATER THAN ZEROS
 17306         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17307
 17308     IF  CSUFIXL  GREATER THAN ZEROS
 17309         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17310
 17311     IF  CEFFDTL  GREATER THAN ZEROS
 17312         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17313
 17314 2910-READ-BY-ACCOUNT.
 17315
 17316* EXEC CICS HANDLE CONDITION
 17317*         NOTFND    (2920-PROCESS-REWRITE)
 17318*    END-EXEC.
 17319*    MOVE '"$I                   ! B #00014927' TO DFHEIV0
 17320     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17321     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17322     MOVE X'4220233030303134393237' TO DFHEIV0(25:11)
 17323     CALL 'kxdfhei1' USING DFHEIV0
 17324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17325
 17326
 17327
 17328* EXEC CICS READ
 17329*        SET     (ADDRESS OF PENDING-BUSINESS)
 17330*        DATASET (FILE-ID-ERPNDB2)
 17331*        RIDFLD  (ERPNDB-ALT-KEY)
 17332*    END-EXEC.
 17333*    MOVE '&"S        E          (   #00014931' TO DFHEIV0
 17334     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17335     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17336     MOVE X'2020233030303134393331' TO DFHEIV0(25:11)
 17337     CALL 'kxdfhei1' USING DFHEIV0,
 17338           FILE-ID-ERPNDB2,
 17339           DFHEIV20,
 17340           DFHEIV99,
 17341           ERPNDB-ALT-KEY,
 17342           DFHEIV99,
 17343           DFHEIV99,
 17344           DFHEIV99
 17345     SET ADDRESS OF PENDING-BUSINESS TO
 17346         DFHEIV20
 17347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17348
 17349
 17350     GO TO 2990-DUPLICATE-RECORD.
 17351
 17352  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 315
* EL6311.cbl
 17353
 17354* EXEC CICS HANDLE CONDITION
 17355*         NOTFND    (2985-RECORD-MISSING)
 17356*    END-EXEC.
 17357*    MOVE '"$I                   ! C #00014940' TO DFHEIV0
 17358     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17359     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17360     MOVE X'4320233030303134393430' TO DFHEIV0(25:11)
 17361     CALL 'kxdfhei1' USING DFHEIV0
 17362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17363
 17364
 17365     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17366
 17367
 17368* EXEC CICS READ
 17369*        SET     (ADDRESS OF PENDING-BUSINESS)
 17370*        DATASET (FILE-ID-ERPNDB)
 17371*        RIDFLD  (ERPNDB-KEY)
 17372*        UPDATE
 17373*    END-EXEC.
 17374*    MOVE '&"S        EU         (   #00014946' TO DFHEIV0
 17375     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17376     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17377     MOVE X'2020233030303134393436' TO DFHEIV0(25:11)
 17378     CALL 'kxdfhei1' USING DFHEIV0,
 17379           FILE-ID-ERPNDB,
 17380           DFHEIV20,
 17381           DFHEIV99,
 17382           ERPNDB-KEY,
 17383           DFHEIV99,
 17384           DFHEIV99,
 17385           DFHEIV99
 17386     SET ADDRESS OF PENDING-BUSINESS TO
 17387         DFHEIV20
 17388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17389
 17390
 17391     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17392     MOVE 'D'                    TO JP-RECORD-TYPE.
 17393     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17394     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17395
 17396     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17397
 17398     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17399     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17400     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17401
 17402
 17403* EXEC CICS DELETE
 17404*        DATASET    (FILE-ID-ERPNDB)
 17405*    END-EXEC.
 17406*    MOVE '&(                    &   #00014964' TO DFHEIV0
 17407     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17408     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17409     MOVE X'2020233030303134393634' TO DFHEIV0(25:11)
 17410     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 316
* EL6311.cbl
 17411           FILE-ID-ERPNDB,
 17412           DFHEIV99,
 17413           DFHEIV99,
 17414           DFHEIV99,
 17415           DFHEIV99
 17416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17417
 17418
 17419     PERFORM 8400-LOG-JOURNAL-RECORD.
 17420
 17421
 17422* EXEC CICS GETMAIN
 17423*        SET      (ADDRESS OF PENDING-BUSINESS)
 17424*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17425*        INITIMG  (GETMAIN-SPACE)
 17426*    END-EXEC.
 17427*    MOVE ',"IL                  $   #00014970' TO DFHEIV0
 17428     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17429     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17430     MOVE X'2020233030303134393730' TO DFHEIV0(25:11)
 17431     CALL 'kxdfhei1' USING DFHEIV0,
 17432           DFHEIV20,
 17433           ERPNDB-RECORD-LENGTH,
 17434           GETMAIN-SPACE
 17435     SET ADDRESS OF PENDING-BUSINESS TO
 17436         DFHEIV20
 17437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17438
 17439
 17440     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17441
 17442 2950-PROCESS-CANCELS.
 17443
 17444
 17445* EXEC CICS HANDLE CONDITION
 17446*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17447*    END-EXEC.
 17448*    MOVE '"$I                   ! D #00014980' TO DFHEIV0
 17449     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17450     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17451     MOVE X'4420233030303134393830' TO DFHEIV0(25:11)
 17452     CALL 'kxdfhei1' USING DFHEIV0
 17453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17454
 17455
 17456
 17457* EXEC CICS READ
 17458*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17459*        DATASET (FILE-ID-ELCERT)
 17460*        RIDFLD  (ELCERT-KEY)
 17461*        UPDATE
 17462*    END-EXEC.
 17463*    MOVE '&"S        EU         (   #00014984' TO DFHEIV0
 17464     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17465     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17466     MOVE X'2020233030303134393834' TO DFHEIV0(25:11)
 17467     CALL 'kxdfhei1' USING DFHEIV0,
 17468           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 317
* EL6311.cbl
 17469           DFHEIV20,
 17470           DFHEIV99,
 17471           ELCERT-KEY,
 17472           DFHEIV99,
 17473           DFHEIV99,
 17474           DFHEIV99
 17475     SET ADDRESS OF CERTIFICATE-MASTER TO
 17476         DFHEIV20
 17477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17478
 17479
 17480     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17481
 17482     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17483     MOVE 'B'                      TO JP-RECORD-TYPE.
 17484     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17485     PERFORM 8400-LOG-JOURNAL-RECORD.
 17486
 17487     IF PB-CI-LIVES NOT NUMERIC
 17488         MOVE ZERO                    TO PB-CI-LIVES.
 17489
 17490     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17491        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17492        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17493        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17494                                         CM-LF-CANCEL-DT
 17495     ELSE
 17496        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17497        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17498        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17499        MOVE PB-CI-LIVES              TO CM-LIVES.
 17500
 17501     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17502        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17503            MOVE CM-LF-STATUS-AT-CANCEL
 17504                                     TO CM-LF-CURRENT-STATUS
 17505            MOVE SPACE
 17506                                     TO CM-LF-STATUS-AT-CANCEL
 17507        ELSE
 17508            MOVE PB-CI-LF-POLICY-STATUS
 17509                                     TO CM-LF-CURRENT-STATUS
 17510     ELSE
 17511        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17512
 17513     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17514        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17515        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17516        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17517                                         CM-AH-CANCEL-DT
 17518     ELSE
 17519        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17520        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17521        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17522        MOVE PB-CI-LIVES              TO CM-LIVES.
 17523
 17524     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17525        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17526            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 318
* EL6311.cbl
 17527                                     TO CM-AH-CURRENT-STATUS
 17528            MOVE SPACE
 17529                                     TO CM-AH-STATUS-AT-CANCEL
 17530        ELSE
 17531            MOVE PB-CI-AH-POLICY-STATUS
 17532                                     TO CM-AH-CURRENT-STATUS
 17533     ELSE
 17534        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17535
 17536 2975-REWRITE-CERT.
 17537     MOVE 'C'                      TO JP-RECORD-TYPE.
 17538     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17539
 17540
 17541* EXEC CICS REWRITE
 17542*        DATASET    (FILE-ID-ELCERT)
 17543*        FROM       (CERTIFICATE-MASTER)
 17544*    END-EXEC.
 17545     MOVE LENGTH OF
 17546      CERTIFICATE-MASTER
 17547       TO DFHEIV11
 17548*    MOVE '&& L                  %   #00015051' TO DFHEIV0
 17549     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17550     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17551     MOVE X'2020233030303135303531' TO DFHEIV0(25:11)
 17552     CALL 'kxdfhei1' USING DFHEIV0,
 17553           FILE-ID-ELCERT,
 17554           CERTIFICATE-MASTER,
 17555           DFHEIV11,
 17556           DFHEIV99
 17557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17558
 17559
 17560     PERFORM 8400-LOG-JOURNAL-RECORD.
 17561
 17562 2960-BUILD-NEW-CANCEL-RECORD.
 17563     IF  CCERTNOL GREATER THAN ZEROS
 17564         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17565
 17566     IF  CSUFIXL  GREATER THAN ZEROS
 17567         MOVE CSUFIXI             TO PB-CERT-SFX.
 17568
 17569     IF  CEFFDTL  GREATER  THAN ZEROS
 17570         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17571
 17572 2970-WRITE-PENDING-BUSINESS.
 17573     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17574     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17575     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17576     MOVE '5'                    TO DC-OPTION-CODE.
 17577     PERFORM 9700-DATE-LINK.
 17578     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17579
 17580     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17581
 17582     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17583                                    PB-CI-INSURED-SEX
 17584                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 319
* EL6311.cbl
 17585                                    PB-CI-AH-BENEFIT-CD
 17586                                    PB-CI-RATE-CLASS
 17587                                    PB-CI-RATE-DEV-LF
 17588                                    PB-CI-RATE-DEV-AH
 17589                                    PB-CI-LF-ABBR
 17590                                    PB-CI-AH-ABBR
 17591                                    PB-CI-OB-FLAG
 17592                                    PB-CI-LF-POLICY-STATUS
 17593                                    PB-CI-AH-POLICY-STATUS
 17594                                    PB-CI-INDV-GRP-CD
 17595                                    PB-CI-BENEFICIARY-NAME
 17596                                    PB-CI-NOTE-SW
 17597                                    PB-CI-SOC-SEC-NO
 17598                                    PB-CI-MEMBER-NO
 17599                                    PB-CI-INT-CODE
 17600                                    PB-CI-COMP-EXCP-SW
 17601                                    PB-CI-ENTRY-STATUS
 17602                                    PB-CI-CREDIT-INTERFACE-SW-1
 17603                                    PB-CI-CREDIT-INTERFACE-SW-2
 17604                                    PB-CI-ENTRY-BATCH.
 17605
 17606     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17607                                    PB-CI-AH-SETTLEMENT-DT
 17608                                    PB-CI-DEATH-DT
 17609                                    PB-CI-LF-PRIOR-CANCEL-DT
 17610                                    PB-CI-AH-PRIOR-CANCEL-DT
 17611                                    PB-CI-LOAN-1ST-PMT-DT
 17612                                    PB-CI-ENTRY-DT
 17613                                    PB-CI-LF-EXPIRE-DT
 17614                                    PB-CI-AH-EXPIRE-DT.
 17615
 17616     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17617                                    PB-CI-LF-TERM
 17618                                    PB-CI-LF-BENEFIT-AMT
 17619                                    PB-CI-LF-ALT-BENEFIT-AMT
 17620                                    PB-CI-LF-PREMIUM-AMT
 17621                                    PB-CI-LF-ALT-PREMIUM-AMT
 17622                                    PB-CI-AH-TERM
 17623                                    PB-CI-AH-BENEFIT-AMT
 17624                                    PB-CI-AH-PREMIUM-AMT
 17625                                    PB-CI-RATE-DEV-PCT-LF
 17626                                    PB-CI-RATE-DEV-PCT-AH
 17627                                    PB-CI-LIFE-COMMISSION
 17628                                    PB-CI-AH-COMMISSION
 17629                                    PB-CI-PAY-FREQUENCY
 17630                                    PB-CI-LOAN-APR
 17631                                    PB-CI-LOAN-TERM
 17632                                    PB-CI-CURR-SEQ
 17633                                    PB-CI-AH-CANCEL-AMT
 17634                                    PB-CI-LF-CANCEL-AMT
 17635                                    PB-CI-EXTENTION-DAYS
 17636                                    PB-CI-TERM-IN-DAYS
 17637                                    PB-CI-LOAN-OFFICER
 17638                                    PB-CI-LIVES
 17639                                    PB-CI-LF-CRIT-PER
 17640                                    PB-CI-AH-CRIT-PER
 17641                                    PB-C-LF-REM-TERM
 17642                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 320
* EL6311.cbl
 17643
 17644     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17645     MOVE 'A'                    TO JP-RECORD-TYPE.
 17646     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17647
 17648
 17649* EXEC CICS HANDLE CONDITION
 17650*        DUPREC   (2990-DUPLICATE-RECORD)
 17651*    END-EXEC.
 17652*    MOVE '"$%                   ! E #00015144' TO DFHEIV0
 17653     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17655     MOVE X'4520233030303135313434' TO DFHEIV0(25:11)
 17656     CALL 'kxdfhei1' USING DFHEIV0
 17657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17658
 17659
 17660
 17661* EXEC CICS WRITE
 17662*        DATASET  (FILE-ID-ERPNDB)
 17663*        FROM     (PENDING-BUSINESS)
 17664*        RIDFLD   (PB-CONTROL-PRIMARY)
 17665*    END-EXEC.
 17666     MOVE LENGTH OF
 17667      PENDING-BUSINESS
 17668       TO DFHEIV11
 17669*    MOVE '&$ L                  ''   #00015148' TO DFHEIV0
 17670     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17671     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17672     MOVE X'2020233030303135313438' TO DFHEIV0(25:11)
 17673     CALL 'kxdfhei1' USING DFHEIV0,
 17674           FILE-ID-ERPNDB,
 17675           PENDING-BUSINESS,
 17676           DFHEIV11,
 17677           PB-CONTROL-PRIMARY,
 17678           DFHEIV99,
 17679           DFHEIV99
 17680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17681
 17682
 17683     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17684
 17685     PERFORM 8400-LOG-JOURNAL-RECORD.
 17686
 17687     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17688
 17689 2985-RECORD-MISSING.
 17690     MOVE -1                     TO CMAINTL
 17691     MOVE AL-UABON               TO CMAINTA.
 17692
 17693     MOVE ER-2902                TO EMI-ERROR.
 17694     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17695     GO TO 8200-SEND-DATAONLY.
 17696
 17697 2990-DUPLICATE-RECORD.
 17698     MOVE SPACE                  TO CMAINTI.
 17699     MOVE -1                     TO CMAINTL.
 17700     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 321
* EL6311.cbl
 17701     MOVE AL-UNBON               TO CEFFDTA.
 17702
 17703     MOVE 1                      TO EMI-SUB
 17704                                    EMI-SWITCH1
 17705                                    EMI-SWITCH-AREA-1
 17706                                    EMI-SWITCH-AREA-2.
 17707     MOVE SPACES                 TO EMI-ERROR-LINES.
 17708
 17709
 17710* EXEC CICS SYNCPOINT ROLLBACK
 17711*    END-EXEC.
 17712*    MOVE '6"R                   !   #00015180' TO DFHEIV0
 17713     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17714     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17715     MOVE X'2020233030303135313830' TO DFHEIV0(25:11)
 17716     CALL 'kxdfhei1' USING DFHEIV0
 17717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17718
 17719
 17720     MOVE ER-2247                TO EMI-ERROR.
 17721     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17722     GO TO 8200-SEND-DATAONLY.
 17723
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 322
* EL6311.cbl
 17725
 17726***************************************************************
 17727*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17728*     PREMIUM FOR A SINGLE BATCH.                             *
 17729*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17730***************************************************************
 17731
 17732 3000-BATCH-MAINLINE.
 17733     IF PI-PREV-KEY NOT = SPACES
 17734         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17735     ELSE
 17736         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17737
 17738     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17739
 17740 3010-READNEXT.
 17741
 17742* EXEC CICS READ
 17743*         DATASET    (FILE-ID-ERPNDB)
 17744*         SET        (ADDRESS OF PENDING-BUSINESS)
 17745*         RIDFLD     (ERPNDB-KEY)
 17746*         GTEQ
 17747*    END-EXEC.
 17748*    MOVE '&"S        G          (   #00015204' TO DFHEIV0
 17749     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17750     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17751     MOVE X'2020233030303135323034' TO DFHEIV0(25:11)
 17752     CALL 'kxdfhei1' USING DFHEIV0,
 17753           FILE-ID-ERPNDB,
 17754           DFHEIV20,
 17755           DFHEIV99,
 17756           ERPNDB-KEY,
 17757           DFHEIV99,
 17758           DFHEIV99,
 17759           DFHEIV99
 17760     SET ADDRESS OF PENDING-BUSINESS TO
 17761         DFHEIV20
 17762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17763
 17764
 17765     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17766        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17767          GO TO 3030-END-BATCH.
 17768
 17769     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17770
 17771     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17772        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17773          GO TO 3020-BUMP-SEQ.
 17774
 17775     IF PB-ISSUE
 17776        ADD +1                   TO WS-ISS-TOTAL-CNT
 17777        IF PB-FATAL-ERRORS
 17778           ADD +1                      TO WS-ISS-FATAL-CNT
 17779           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17780           GO TO 3020-BUMP-SEQ
 17781        ELSE
 17782           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 323
* EL6311.cbl
 17783              ADD +1                      TO WS-ISS-FORCE-CNT
 17784              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17785              GO TO 3020-BUMP-SEQ
 17786           ELSE
 17787              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17788                 ADD +1                      TO WS-ISS-HOLD-CNT
 17789                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17790                 GO TO 3020-BUMP-SEQ
 17791              ELSE
 17792                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17793                     THRU  3299-EXIT
 17794                 GO TO 3020-BUMP-SEQ.
 17795
 17796     IF PB-CANCELLATION
 17797        ADD +1                   TO WS-CAN-TOTAL-CNT
 17798        IF PB-FATAL-ERRORS
 17799           ADD +1                 TO WS-CAN-FATAL-CNT
 17800           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17801           GO TO 3020-BUMP-SEQ
 17802        ELSE
 17803           IF PB-UNFORCED-ERRORS
 17804              ADD +1                 TO WS-CAN-FORCE-CNT
 17805              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17806              GO TO 3020-BUMP-SEQ
 17807           ELSE
 17808              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17809                 ADD +1                 TO WS-CAN-HOLD-CNT
 17810                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17811                 GO TO 3020-BUMP-SEQ
 17812              ELSE
 17813                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17814                     THRU  3499-EXIT
 17815                 GO TO 3020-BUMP-SEQ.
 17816
 17817     IF PB-BATCH-TRAILER
 17818         GO TO 3030-END-BATCH.
 17819
 17820 3020-BUMP-SEQ.
 17821     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17822     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17823     GO TO 3010-READNEXT.
 17824
 17825 3030-END-BATCH.
 17826     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17827     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17828     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17829     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17830
 17831     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17832                                          - WS-ISS-FORCE-CNT
 17833                                          - WS-ISS-HOLD-CNT).
 17834
 17835     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17836     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17837
 17838     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17839     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17840     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 324
* EL6311.cbl
 17841     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17842     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17843                                          - WS-CAN-FORCE-CNT
 17844                                          - WS-CAN-HOLD-CNT).
 17845     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17846     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17847
 17848     COMPUTE WS-NET-TOTAL-CNT
 17849         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17850     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17851     COMPUTE WS-NET-FATAL-CNT
 17852         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17853     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17854     COMPUTE WS-NET-FORCE-CNT
 17855         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17856     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17857     COMPUTE WS-NET-HOLD-CNT
 17858         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17859     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17860
 17861     COMPUTE WS-NET-AVAIL-CNT
 17862          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17863                              - WS-ISS-FORCE-CNT
 17864                              - WS-ISS-HOLD-CNT)
 17865          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17866                              - WS-CAN-FORCE-CNT
 17867                              - WS-CAN-HOLD-CNT).
 17868     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17869
 17870     COMPUTE WS-NET-GOOD-PREM
 17871         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17872     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17873     COMPUTE WS-NET-BAD-PREM
 17874         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17875     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17876
 17877     MOVE 0000                   TO EMI-ERROR.
 17878     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17879     MOVE -1                     TO DPFENTRL.
 17880     GO TO 8200-SEND-DATAONLY.
 17881
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 325
* EL6311.cbl
 17883
 17884******************************************************************
 17885*                                                                *
 17886*           A D D    B A D   I S S U E   P R E M I U M           *
 17887*                                                                *
 17888******************************************************************
 17889
 17890 3100-ADD-BAD-ISSUE-PREM.
 17891     IF PB-OVERRIDE-LIFE
 17892       OR PB-OVERRIDE-BOTH
 17893           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17894           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17895       ELSE
 17896           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17897           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17898
 17899     IF PB-OVERRIDE-AH
 17900       OR PB-OVERRIDE-BOTH
 17901           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17902       ELSE
 17903           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17904
 17905 3199-EXIT.
 17906     EXIT.
 17907
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 326
* EL6311.cbl
 17909
 17910******************************************************************
 17911*                                                                *
 17912*       A D D   G O O D   I S S U E   P R E M I U M              *
 17913*                                                                *
 17914******************************************************************
 17915
 17916 3200-ADD-GOOD-ISSUE-PREM.
 17917     IF PB-OVERRIDE-LIFE
 17918       OR PB-OVERRIDE-BOTH
 17919           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17920           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17921       ELSE
 17922           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17923           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17924
 17925     IF PB-OVERRIDE-AH
 17926       OR PB-OVERRIDE-BOTH
 17927           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17928       ELSE
 17929           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17930
 17931 3299-EXIT.
 17932     EXIT.
 17933
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 327
* EL6311.cbl
 17935
 17936
 17937******************************************************************
 17938*                                                                *
 17939*        A D D   B A D   C A N C E L   P R E M I U M             *
 17940*                                                                *
 17941******************************************************************
 17942
 17943 3300-ADD-BAD-CANCEL-PREM.
 17944     IF PB-OVERRIDE-LIFE
 17945       OR PB-OVERRIDE-BOTH
 17946           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17947       ELSE
 17948           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17949
 17950     IF PB-OVERRIDE-AH
 17951       OR PB-OVERRIDE-BOTH
 17952           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17953       ELSE
 17954           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17955
 17956 3399-EXIT.
 17957     EXIT.
 17958
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 328
* EL6311.cbl
 17960
 17961******************************************************************
 17962*                                                                *
 17963*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17964*                                                                *
 17965******************************************************************
 17966
 17967 3400-ADD-GOOD-CANCEL-PREM.
 17968     IF PB-OVERRIDE-LIFE
 17969       OR PB-OVERRIDE-BOTH
 17970           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17971       ELSE
 17972           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17973
 17974     IF PB-OVERRIDE-AH
 17975       OR PB-OVERRIDE-BOTH
 17976           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17977       ELSE
 17978           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17979
 17980 3499-EXIT.
 17981     EXIT.
 17982
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 329
* EL6311.cbl
 17984
 17985******************************************************************
 17986*                                                                *
 17987*           E D I T   B A T C H   D A T A                        *
 17988*                                                                *
 17989******************************************************************
 17990
 17991 3500-EDIT-BATCH-DATA.
 17992     IF PI-PREV-KEY NOT = SPACES
 17993        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17994     ELSE
 17995        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17996
 17997     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 17998     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17999
 18000
 18001* EXEC CICS HANDLE CONDITION
 18002*         NOTFND      (3590-NOT-FOUND)
 18003*    END-EXEC.
 18004*    MOVE '"$I                   ! F #00015446' TO DFHEIV0
 18005     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18006     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18007     MOVE X'4620233030303135343436' TO DFHEIV0(25:11)
 18008     CALL 'kxdfhei1' USING DFHEIV0
 18009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18010
 18011
 18012     IF DRISSL   GREATER THAN ZEROS OR
 18013        DRISSL   GREATER THAN ZEROS OR
 18014        DRLFPRML GREATER THAN ZEROS OR
 18015        DRAHPRML GREATER THAN ZEROS OR
 18016        DRCANCL  GREATER THAN ZEROS OR
 18017        DRLFRFDL GREATER THAN ZEROS OR
 18018        DRAHRFDL GREATER THAN ZEROS
 18019              NEXT SENTENCE
 18020          ELSE
 18021              MOVE ER-3224    TO EMI-ERROR
 18022              MOVE -1         TO DPFENTRL
 18023              MOVE AL-UNBON   TO DPFENTRA
 18024              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18025              GO TO 8200-SEND-DATAONLY.
 18026
 18027     IF NOT MODIFY-CAP
 18028         MOVE 'UPDATE'       TO SM-READ
 18029         PERFORM 9995-SECURITY-VIOLATION
 18030         MOVE ER-0070        TO EMI-ERROR
 18031         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18032         GO TO 8100-SEND-INITIAL-MAP.
 18033
 18034        IF DRISSL GREATER THAN ZEROS
 18035           MOVE AL-UNNON         TO DRISSA
 18036           MOVE DRISSI           TO DEEDIT-FIELD
 18037           PERFORM 8600-DEEDIT
 18038           IF DEEDIT-FIELD-V0  NUMERIC
 18039              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18040           ELSE
 18041              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 330
* EL6311.cbl
 18042              MOVE -1         TO DRISSL
 18043              MOVE AL-UNBON   TO DRISSA
 18044              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18045
 18046        IF DRLFPRML GREATER THAN ZEROS
 18047           MOVE AL-UNNON         TO DRLFPRMA
 18048
 18049* EXEC CICS BIF DEEDIT
 18050*              FIELD  (DRLFPRMI)
 18051*              LENGTH (11)
 18052*          END-EXEC
 18053     MOVE 11
 18054       TO DFHEIV11
 18055*    MOVE '@"L                   #   #00015486' TO DFHEIV0
 18056     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18057     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18058     MOVE X'2020233030303135343836' TO DFHEIV0(25:11)
 18059     CALL 'kxdfhei1' USING DFHEIV0,
 18060           DRLFPRMI,
 18061           DFHEIV11
 18062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18063           IF DRLFPRMI NUMERIC
 18064              MOVE DRLFPRMI   TO WS-DRLFPRM
 18065*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18066*          PERFORM 8600-DEEDIT
 18067*          IF DEEDIT-FIELD-V2  NUMERIC
 18068*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18069           ELSE
 18070              MOVE ER-2223    TO EMI-ERROR
 18071              MOVE -1         TO DRLFPRML
 18072              MOVE AL-UNBON   TO DRLFPRMA
 18073              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18074
 18075        IF DRAHPRML GREATER THAN ZEROS
 18076           MOVE AL-UNNON         TO DRAHPRMA
 18077
 18078* EXEC CICS BIF DEEDIT
 18079*              FIELD  (DRAHPRMI)
 18080*              LENGTH (11)
 18081*          END-EXEC
 18082     MOVE 11
 18083       TO DFHEIV11
 18084*    MOVE '@"L                   #   #00015504' TO DFHEIV0
 18085     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18086     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18087     MOVE X'2020233030303135353034' TO DFHEIV0(25:11)
 18088     CALL 'kxdfhei1' USING DFHEIV0,
 18089           DRAHPRMI,
 18090           DFHEIV11
 18091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18092           IF DRAHPRMI NUMERIC
 18093              MOVE DRAHPRMI   TO WS-DRAHPRM
 18094*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18095*          PERFORM 8600-DEEDIT
 18096*          IF DEEDIT-FIELD-V2  NUMERIC
 18097*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18098           ELSE
 18099              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 331
* EL6311.cbl
 18100              MOVE -1         TO DRAHPRML
 18101              MOVE AL-UNBON   TO DRAHPRMA
 18102              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18103
 18104        IF DRCANCL GREATER THAN ZEROS
 18105           MOVE AL-UNNON         TO DRCANCA
 18106           MOVE DRCANCI          TO DEEDIT-FIELD
 18107           PERFORM 8600-DEEDIT
 18108           IF DEEDIT-FIELD-V0  NUMERIC
 18109              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18110           ELSE
 18111              MOVE ER-2223    TO EMI-ERROR
 18112              MOVE -1         TO DRCANCL
 18113              MOVE AL-UNBON   TO DRCANCL
 18114              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18115
 18116        IF DRLFRFDL GREATER THAN ZEROS
 18117           MOVE AL-UNNON         TO DRLFRFDA
 18118
 18119* EXEC CICS BIF DEEDIT
 18120*              FIELD  (DRLFRFDI)
 18121*              LENGTH (11)
 18122*          END-EXEC
 18123     MOVE 11
 18124       TO DFHEIV11
 18125*    MOVE '@"L                   #   #00015534' TO DFHEIV0
 18126     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18127     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18128     MOVE X'2020233030303135353334' TO DFHEIV0(25:11)
 18129     CALL 'kxdfhei1' USING DFHEIV0,
 18130           DRLFRFDI,
 18131           DFHEIV11
 18132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18133           IF DRLFRFDI NUMERIC
 18134              MOVE DRLFRFDI   TO WS-DRLFRFD
 18135*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18136*          PERFORM 8600-DEEDIT
 18137*          IF DEEDIT-FIELD-V2  NUMERIC
 18138*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18139           ELSE
 18140              MOVE ER-2223    TO EMI-ERROR
 18141              MOVE -1         TO DRLFRFDL
 18142              MOVE AL-UNBON   TO DRLFRFDA
 18143              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18144
 18145        IF DRAHRFDL GREATER THAN ZEROS
 18146           MOVE AL-UNNON         TO DRAHRFDA
 18147
 18148* EXEC CICS BIF DEEDIT
 18149*              FIELD  (DRAHRFDI)
 18150*              LENGTH (11)
 18151*          END-EXEC
 18152     MOVE 11
 18153       TO DFHEIV11
 18154*    MOVE '@"L                   #   #00015552' TO DFHEIV0
 18155     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18156     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18157     MOVE X'2020233030303135353532' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 332
* EL6311.cbl
 18158     CALL 'kxdfhei1' USING DFHEIV0,
 18159           DRAHRFDI,
 18160           DFHEIV11
 18161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18162           IF DRAHRFDI NUMERIC
 18163              MOVE DRAHRFDI   TO WS-DRAHRFD
 18164*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18165*          PERFORM 8600-DEEDIT
 18166*          IF DEEDIT-FIELD-V2  NUMERIC
 18167*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18168           ELSE
 18169              MOVE ER-2223    TO EMI-ERROR
 18170              MOVE -1         TO DRAHRFDL
 18171              MOVE AL-UNBON   TO DRAHRFDA
 18172              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18173
 18174     IF EMI-ERROR = ZEROS
 18175        GO 3600-UPDATE-BATCH-HEADER.
 18176
 18177     GO TO 8200-SEND-DATAONLY.
 18178
 18179 3590-NOT-FOUND.
 18180     MOVE ER-2192                TO EMI-ERROR.
 18181     MOVE -1                     TO DPFENTRL.
 18182     MOVE AL-UNBON               TO DPFENTRA.
 18183     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18184     GO TO 8200-SEND-DATAONLY.
 18185
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 333
* EL6311.cbl
 18187
 18188******************************************************************
 18189*                                                                *
 18190*           U P D A T E   B A T C H   H E A D E R                *
 18191*                                                                *
 18192******************************************************************
 18193
 18194 3600-UPDATE-BATCH-HEADER.
 18195
 18196* EXEC CICS HANDLE CONDITION
 18197*         NOTFND      (3690-NOT-FOUND)
 18198*    END-EXEC.
 18199*    MOVE '"$I                   ! G #00015589' TO DFHEIV0
 18200     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18201     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18202     MOVE X'4720233030303135353839' TO DFHEIV0(25:11)
 18203     CALL 'kxdfhei1' USING DFHEIV0
 18204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18205
 18206
 18207
 18208* EXEC CICS READ
 18209*        DATASET (FILE-ID-ERPNDB)
 18210*        RIDFLD  (ERPNDB-KEY)
 18211*        SET     (ADDRESS OF PENDING-BUSINESS)
 18212*        UPDATE
 18213*    END-EXEC.
 18214*    MOVE '&"S        EU         (   #00015593' TO DFHEIV0
 18215     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18216     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18217     MOVE X'2020233030303135353933' TO DFHEIV0(25:11)
 18218     CALL 'kxdfhei1' USING DFHEIV0,
 18219           FILE-ID-ERPNDB,
 18220           DFHEIV20,
 18221           DFHEIV99,
 18222           ERPNDB-KEY,
 18223           DFHEIV99,
 18224           DFHEIV99,
 18225           DFHEIV99
 18226     SET ADDRESS OF PENDING-BUSINESS TO
 18227         DFHEIV20
 18228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18229
 18230
 18231     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18232     MOVE 'B'                    TO JP-RECORD-TYPE.
 18233     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18234
 18235     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18236
 18237     PERFORM 8400-LOG-JOURNAL-RECORD.
 18238
 18239     IF DRISSL GREATER THAN ZEROS
 18240        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18241
 18242     IF DRCANCL GREATER THAN ZEROS
 18243        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18244
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 334
* EL6311.cbl
 18245
 18246     IF DRLFPRML GREATER THAN ZEROS
 18247        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18248
 18249     IF DRAHPRML GREATER THAN ZEROS
 18250        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18251
 18252     IF DRLFRFDL GREATER THAN ZEROS
 18253        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18254
 18255     IF DRAHRFDL GREATER THAN ZEROS
 18256        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18257
 18258 3670-REWRITE-BATCH-HEADER.
 18259     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18260        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18261        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18262        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18263        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18264        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18265        MOVE SPACE               TO PB-OUT-BAL-CD
 18266     ELSE
 18267        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18268
 18269     MOVE 'C'                    TO JP-RECORD-TYPE.
 18270     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18271
 18272
 18273* EXEC CICS REWRITE
 18274*         DATASET      (FILE-ID-ERPNDB)
 18275*         FROM         (PENDING-BUSINESS)
 18276*    END-EXEC.
 18277     MOVE LENGTH OF
 18278      PENDING-BUSINESS
 18279       TO DFHEIV11
 18280*    MOVE '&& L                  %   #00015641' TO DFHEIV0
 18281     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18282     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18283     MOVE X'2020233030303135363431' TO DFHEIV0(25:11)
 18284     CALL 'kxdfhei1' USING DFHEIV0,
 18285           FILE-ID-ERPNDB,
 18286           PENDING-BUSINESS,
 18287           DFHEIV11,
 18288           DFHEIV99
 18289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18290
 18291
 18292     PERFORM 8400-LOG-JOURNAL-RECORD.
 18293
 18294     GO TO 7200-DISPLAY-BATCHES.
 18295
 18296 3690-NOT-FOUND.
 18297     MOVE ER-2192                TO EMI-ERROR.
 18298     MOVE -1                     TO DPFENTRL.
 18299     MOVE AL-UNBON               TO DPFENTRA.
 18300     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18301     GO TO 8200-SEND-DATAONLY.
 18302
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 335
* EL6311.cbl
 18304
 18305******************************************************************
 18306*                                                                *
 18307*           R E - D I S P L A Y   R E C O R D                    *
 18308*                                                                *
 18309******************************************************************
 18310
 18311 3900-RE-DISPLAY-RECORD.
 18312
 18313* EXEC CICS HANDLE CONDITION
 18314*         NOTFND   (3990-NOT-FOUND)
 18315*    END-EXEC.
 18316*    MOVE '"$I                   ! H #00015666' TO DFHEIV0
 18317     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18318     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18319     MOVE X'4820233030303135363636' TO DFHEIV0(25:11)
 18320     CALL 'kxdfhei1' USING DFHEIV0
 18321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18322
 18323
 18324     IF PI-DISPLAY-ORIGINAL-BATCH
 18325         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18326     ELSE
 18327         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18328
 18329
 18330* EXEC CICS READ
 18331*         DATASET   (FILE-ID)
 18332*         RIDFLD    (PI-PREV-KEY)
 18333*         SET       (ADDRESS OF PENDING-BUSINESS)
 18334*    END-EXEC.
 18335*    MOVE '&"S        E          (   #00015675' TO DFHEIV0
 18336     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18337     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18338     MOVE X'2020233030303135363735' TO DFHEIV0(25:11)
 18339     CALL 'kxdfhei1' USING DFHEIV0,
 18340           FILE-ID,
 18341           DFHEIV20,
 18342           DFHEIV99,
 18343           PI-PREV-KEY,
 18344           DFHEIV99,
 18345           DFHEIV99,
 18346           DFHEIV99
 18347     SET ADDRESS OF PENDING-BUSINESS TO
 18348         DFHEIV20
 18349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18350
 18351
 18352     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18353
 18354     IF PB-ISSUE
 18355         GO TO 7000-DISPLAY-ISSUES.
 18356
 18357     IF PB-CANCELLATION
 18358         GO TO 7100-DISPLAY-CANCELS.
 18359
 18360     IF PB-BATCH-TRAILER
 18361         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 336
* EL6311.cbl
 18362
 18363 3990-NOT-FOUND.
 18364     MOVE LOW-VALUES             TO EL631BI.
 18365
 18366     IF PI-MAP-NAME = EL631B
 18367         MOVE -1                  TO BMAINTL
 18368     ELSE
 18369         MOVE -1                  TO CMAINTL.
 18370
 18371     GO TO 8100-SEND-INITIAL-MAP.
 18372
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 337
* EL6311.cbl
 18374
 18375***************************************************************
 18376*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18377*                                                             *
 18378*      1. START BROWSE WITH                                   *
 18379*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18380*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18381*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18382*                                                             *
 18383*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18384*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18385*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18386*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18387*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18388*               AND IS IT TO BE DISPLAYED.                    *
 18389*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18390*               DISPLAYED.                                    *
 18391*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18392*               DISPLAYED.                                    *
 18393*                                                             *
 18394*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18395*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18396***************************************************************
 18397
 18398 4000-BROWSE-DETAIL-FORWARD.
 18399     IF FIRST-TIME
 18400        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18401     ELSE
 18402        IF SHOW-RECORD
 18403           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18404           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18405           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18406           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18407           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18408        ELSE
 18409           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18410
 18411
 18412* EXEC CICS HANDLE CONDITION
 18413*         NOTFND   (4050-END-RECORDS)
 18414*         ENDFILE  (4050-END-RECORDS)
 18415*    END-EXEC.
 18416*    MOVE '"$I''                  ! I #00015740' TO DFHEIV0
 18417     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18418     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18419     MOVE X'4920233030303135373430' TO DFHEIV0(25:11)
 18420     CALL 'kxdfhei1' USING DFHEIV0
 18421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18422
 18423
 18424
 18425* EXEC CICS STARTBR
 18426*         DATASET   (FILE-ID-ERPNDB2)
 18427*         RIDFLD    (ERPNDB-ALT-KEY)
 18428*    END-EXEC.
 18429     MOVE 0
 18430       TO DFHEIV11
 18431*    MOVE '&,         G          &   #00015745' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 338
* EL6311.cbl
 18432     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18433     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18434     MOVE X'2020233030303135373435' TO DFHEIV0(25:11)
 18435     CALL 'kxdfhei1' USING DFHEIV0,
 18436           FILE-ID-ERPNDB2,
 18437           ERPNDB-ALT-KEY,
 18438           DFHEIV99,
 18439           DFHEIV11,
 18440           DFHEIV99
 18441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18442
 18443
 18444     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18445
 18446     IF FIRST-TIME OR SHOW-RECORD
 18447        MOVE SPACE               TO WS-FIRST-TIME-SW
 18448        GO TO 4005-READ-NEXT-RECORD.
 18449
 18450
 18451* EXEC CICS READNEXT
 18452*         DATASET    (FILE-ID-ERPNDB2)
 18453*         SET        (ADDRESS OF PENDING-BUSINESS)
 18454*         RIDFLD     (ERPNDB-ALT-KEY)
 18455*    END-EXEC.
 18456     MOVE 0
 18457       TO DFHEIV11
 18458*    MOVE '&.S                   )   #00015756' TO DFHEIV0
 18459     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18460     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18461     MOVE X'2020233030303135373536' TO DFHEIV0(25:11)
 18462     CALL 'kxdfhei1' USING DFHEIV0,
 18463           FILE-ID-ERPNDB2,
 18464           DFHEIV20,
 18465           DFHEIV99,
 18466           ERPNDB-ALT-KEY,
 18467           DFHEIV99,
 18468           DFHEIV11,
 18469           DFHEIV99,
 18470           DFHEIV99
 18471     SET ADDRESS OF PENDING-BUSINESS TO
 18472         DFHEIV20
 18473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18474
 18475
 18476 4005-READ-NEXT-RECORD.
 18477
 18478* EXEC CICS READNEXT
 18479*         DATASET    (FILE-ID-ERPNDB2)
 18480*         SET        (ADDRESS OF PENDING-BUSINESS)
 18481*         RIDFLD     (ERPNDB-ALT-KEY)
 18482*    END-EXEC.
 18483     MOVE 0
 18484       TO DFHEIV11
 18485*    MOVE '&.S                   )   #00015763' TO DFHEIV0
 18486     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18487     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18488     MOVE X'2020233030303135373633' TO DFHEIV0(25:11)
 18489     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 339
* EL6311.cbl
 18490           FILE-ID-ERPNDB2,
 18491           DFHEIV20,
 18492           DFHEIV99,
 18493           ERPNDB-ALT-KEY,
 18494           DFHEIV99,
 18495           DFHEIV11,
 18496           DFHEIV99,
 18497           DFHEIV99
 18498     SET ADDRESS OF PENDING-BUSINESS TO
 18499         DFHEIV20
 18500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18501
 18502
 18503     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18504
 18505     IF WS-BATCH-PREFIX = '#CL'
 18506        GO TO 4005-READ-NEXT-RECORD.
 18507
 18508     IF SHOW-RECORD
 18509        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18510           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18511           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18512           PB-STATE         NOT = PI-PB-STATE          OR
 18513           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18514           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18515           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18516           GO TO 4050-END-RECORDS
 18517        ELSE
 18518           GO TO 4010-CHECK-REC-TYPE.
 18519
 18520     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18521        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18522        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18523        PB-STATE            NOT = PI-PB-STATE          OR
 18524        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18525        GO TO 4050-END-RECORDS.
 18526
 18527     IF PB-BATCH-TRAILER
 18528        GO TO 4005-READ-NEXT-RECORD.
 18529
 18530     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18531        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18532           GO TO 4005-READ-NEXT-RECORD
 18533        ELSE
 18534           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18535              GO TO 4010-CHECK-REC-TYPE
 18536           ELSE
 18537              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18538                 GO TO 4010-CHECK-REC-TYPE
 18539              ELSE
 18540                 GO TO 4005-READ-NEXT-RECORD.
 18541
 18542     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18543        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18544           GO TO 4005-READ-NEXT-RECORD.
 18545
 18546 4010-CHECK-REC-TYPE.
 18547     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 340
* EL6311.cbl
 18548         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18549             NEXT SENTENCE
 18550         ELSE
 18551             GO TO 4005-READ-NEXT-RECORD.
 18552
 18553     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18554         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18555             NEXT SENTENCE
 18556        ELSE
 18557             GO TO 4005-READ-NEXT-RECORD.
 18558
 18559     IF NOT DISPLAY-CHANGE-RECORDS AND
 18560            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18561        GO TO 4005-READ-NEXT-RECORD.
 18562
 18563     IF DISPLAY-HOLD-RECORDS AND
 18564        NOT PB-RECORD-ON-HOLD
 18565          GO TO 4005-READ-NEXT-RECORD.
 18566
 18567     IF PB-ISSUE
 18568        IF DISPLAY-CHK-REQ-RECORDS
 18569            GO TO 4005-READ-NEXT-RECORD.
 18570
 18571     IF PB-ISSUE
 18572        IF ISSUE-WITH-WARNING
 18573           IF PB-WARNING-ERRORS
 18574              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18575                  GO TO 4005-READ-NEXT-RECORD
 18576              ELSE
 18577                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18578                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18579                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18580                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18581                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18582                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18583                 GO TO 7000-DISPLAY-ISSUES
 18584           ELSE
 18585              GO TO 4005-READ-NEXT-RECORD.
 18586
 18587     IF PB-ISSUE
 18588        IF (ISSUES-IN-ERROR AND
 18589            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18590            ALL-ISSUES
 18591            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18592            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18593            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18594            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18595            MOVE PB-SV-STATE            TO PI-SV-STATE
 18596            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18597            GO TO 7000-DISPLAY-ISSUES
 18598        ELSE
 18599            GO TO 4005-READ-NEXT-RECORD.
 18600
 18601     IF PB-CANCELLATION
 18602        IF DISPLAY-CHK-REQ-RECORDS
 18603           IF PB-C-REFUND-REQUESTED
 18604              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18605              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 341
* EL6311.cbl
 18606              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18607              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18608              MOVE PB-SV-STATE            TO PI-SV-STATE
 18609              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18610              GO TO 7100-DISPLAY-CANCELS
 18611           ELSE
 18612               GO TO 4005-READ-NEXT-RECORD.
 18613
 18614     IF PB-CANCELLATION
 18615        IF CANCEL-WITH-WARNING
 18616           IF PB-WARNING-ERRORS
 18617              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18618                  GO TO 4005-READ-NEXT-RECORD
 18619              ELSE
 18620                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18621                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18622                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18623                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18624                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18625                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18626                 GO TO 7100-DISPLAY-CANCELS
 18627           ELSE
 18628              GO TO 4005-READ-NEXT-RECORD.
 18629
 18630     IF PB-CANCELLATION
 18631        IF (CANCEL-IN-ERROR  AND
 18632            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18633            ALL-CANCELS
 18634            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18635            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18636            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18637            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18638            MOVE PB-SV-STATE            TO PI-SV-STATE
 18639            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18640            GO TO 7100-DISPLAY-CANCELS.
 18641
 18642     GO TO 4005-READ-NEXT-RECORD.
 18643
 18644 4050-END-RECORDS.
 18645******************************************************************
 18646*                                                                *
 18647*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18648*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18649*         PROGRAM.                                               *
 18650*                                                                *
 18651******************************************************************
 18652
 18653     IF BROWSE-STARTED
 18654        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18655
 18656* EXEC CICS ENDBR
 18657*            DATASET  (FILE-ID-ERPNDB2)
 18658*       END-EXEC.
 18659     MOVE 0
 18660       TO DFHEIV11
 18661*    MOVE '&2                    $   #00015921' TO DFHEIV0
 18662     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18663     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 342
* EL6311.cbl
 18664     MOVE X'2020233030303135393231' TO DFHEIV0(25:11)
 18665     CALL 'kxdfhei1' USING DFHEIV0,
 18666           FILE-ID-ERPNDB2,
 18667           DFHEIV11,
 18668           DFHEIV99
 18669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18670
 18671
 18672     IF  EIBTRNID NOT = TRANS-EXB1
 18673         IF PENDING-BUS-RECS-FOUND
 18674             NEXT SENTENCE
 18675           ELSE
 18676             MOVE '9'            TO PI-BROWSE-SW
 18677             GO TO 9400-CLEAR.
 18678
 18679     IF SHOW-RECORD
 18680        MOVE ER-2253            TO EMI-ERROR
 18681       ELSE
 18682        MOVE ER-2254            TO EMI-ERROR.
 18683
 18684     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18685
 18686     IF PI-MAP-NAME = SPACES
 18687        MOVE -1                  TO DPFENTRL
 18688        MOVE EL631D               TO PI-MAP-NAME
 18689        GO TO 8100-SEND-INITIAL-MAP.
 18690
 18691     IF PI-MAP-NAME = EL631B
 18692        MOVE -1                  TO BMAINTL
 18693     ELSE
 18694        IF PI-MAP-NAME = EL631C
 18695           MOVE -1               TO CMAINTL
 18696        ELSE
 18697           MOVE -1               TO DPFENTRL.
 18698
 18699     GO TO 8200-SEND-DATAONLY.
 18700
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 343
* EL6311.cbl
 18702
 18703***************************************************************
 18704*                                                             *
 18705*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18706*                                                             *
 18707*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18708*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18709*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18710*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18711*                                                             *
 18712*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18713*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18714*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18715*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18716*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18717*                AND IS IT TO BE DISPLAYED.                   *
 18718*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18719*                DISPLAYED.                                   *
 18720*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18721*                DISPLAYED.                                   *
 18722*                                                             *
 18723*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18724*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18725*                                                             *
 18726*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18727*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18728*                THEY ARE NOT TO BE DISPLAYED.                *
 18729*                                                             *
 18730***************************************************************
 18731
 18732 4100-BROWSE-PRIMARY-FORWARD.
 18733     IF FIRST-TIME  OR SHOW-RECORD
 18734        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18735        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18736        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18737     ELSE
 18738        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18739        IF ERPNDB-BATCH-SEQ-NO = +9999
 18740           GO TO 4150-END-BATCH
 18741        ELSE
 18742           IF DISPLAY-CHANGE-RECORDS
 18743              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18744           ELSE
 18745              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18746              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18747
 18748     IF FIRST-TIME
 18749         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18750            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18751              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18752
 18753
 18754* EXEC CICS HANDLE CONDITION
 18755*         ENDFILE  (4150-END-BATCH)
 18756*    END-EXEC.
 18757*    MOVE '"$''                   ! J #00016006' TO DFHEIV0
 18758     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18759     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 344
* EL6311.cbl
 18760     MOVE X'4A20233030303136303036' TO DFHEIV0(25:11)
 18761     CALL 'kxdfhei1' USING DFHEIV0
 18762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18763
 18764
 18765 4105-READ-NEXT.
 18766
 18767* EXEC CICS HANDLE CONDITION
 18768*         NOTFND    (4150-END-BATCH)
 18769*    END-EXEC.
 18770*    MOVE '"$I                   ! K #00016011' TO DFHEIV0
 18771     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18772     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18773     MOVE X'4B20233030303136303131' TO DFHEIV0(25:11)
 18774     CALL 'kxdfhei1' USING DFHEIV0
 18775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18776
 18777
 18778     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18779
 18780     IF PI-DISPLAY-ORIGINAL-BATCH
 18781        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18782     ELSE
 18783        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18784
 18785
 18786* EXEC CICS READ
 18787*         DATASET   (FILE-ID)
 18788*         SET       (ADDRESS OF PENDING-BUSINESS)
 18789*         RIDFLD    (ERPNDB-KEY)
 18790*         GTEQ
 18791*    END-EXEC.
 18792*    MOVE '&"S        G          (   #00016022' TO DFHEIV0
 18793     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18794     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18795     MOVE X'2020233030303136303232' TO DFHEIV0(25:11)
 18796     CALL 'kxdfhei1' USING DFHEIV0,
 18797           FILE-ID,
 18798           DFHEIV20,
 18799           DFHEIV99,
 18800           ERPNDB-KEY,
 18801           DFHEIV99,
 18802           DFHEIV99,
 18803           DFHEIV99
 18804     SET ADDRESS OF PENDING-BUSINESS TO
 18805         DFHEIV20
 18806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18807
 18808
 18809     IF PI-DISPLAY-ORIGINAL-BATCH
 18810        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18811           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18812           GO TO 4150-END-BATCH
 18813        ELSE
 18814           IF PB-BATCH-TRAILER
 18815              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18816              GO TO 4105-READ-NEXT
 18817           ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 345
* EL6311.cbl
 18818              NEXT SENTENCE
 18819     ELSE
 18820        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18821           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18822           GO TO 4150-END-BATCH.
 18823
 18824     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18825
 18826     IF WS-BATCH-PREFIX = '#CL'
 18827         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18828         GO TO 4105-READ-NEXT.
 18829
 18830     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18831     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18832     MOVE PB-STATE               TO PI-PB-STATE.
 18833     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18834
 18835     IF PB-BATCH-TRAILER
 18836        IF SHOW-RECORD
 18837           GO TO 4150-END-BATCH
 18838        ELSE
 18839           MOVE ER-2251         TO EMI-ERROR
 18840           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18841           MOVE 1               TO PI-BROWSE-TYPE
 18842           GO TO 7200-DISPLAY-BATCHES.
 18843
 18844     IF SHOW-RECORD
 18845           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18846              GO TO 4110-BUMP-SEQ
 18847           ELSE
 18848              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18849                 GO TO 4110-BUMP-SEQ
 18850              ELSE
 18851                 GO TO 4107-CHECK-REC-TYPE.
 18852
 18853     IF NOT  PI-PRIMARY-WITH-SELECT
 18854        GO TO 4107-CHECK-REC-TYPE.
 18855
 18856     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18857        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18858           GO TO 4110-BUMP-SEQ
 18859        ELSE
 18860           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18861              GO TO 4107-CHECK-REC-TYPE
 18862           ELSE
 18863              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18864                 GO TO 4107-CHECK-REC-TYPE
 18865              ELSE
 18866                 GO TO 4110-BUMP-SEQ.
 18867
 18868     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18869        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18870           GO TO 4110-BUMP-SEQ.
 18871
 18872 4107-CHECK-REC-TYPE.
 18873     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18874         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18875             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 346
* EL6311.cbl
 18876           ELSE
 18877             GO TO 4110-BUMP-SEQ.
 18878
 18879     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18880         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18881             NEXT SENTENCE
 18882           ELSE
 18883             GO TO 4110-BUMP-SEQ.
 18884
 18885     IF NOT DISPLAY-CHANGE-RECORDS AND
 18886        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18887           GO TO 4110-BUMP-SEQ.
 18888
 18889     IF DISPLAY-HOLD-RECORDS AND
 18890        NOT PB-RECORD-ON-HOLD
 18891          GO TO 4110-BUMP-SEQ.
 18892
 18893     IF PB-ISSUE
 18894        IF DISPLAY-CHK-REQ-RECORDS
 18895            GO TO 4110-BUMP-SEQ.
 18896
 18897     IF PB-ISSUE
 18898        IF ISSUE-WITH-WARNING
 18899           IF PB-WARNING-ERRORS
 18900              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18901                  GO TO 4110-BUMP-SEQ
 18902              ELSE
 18903                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18904                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18905                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18906                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18907                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18908                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18909                 GO TO 7000-DISPLAY-ISSUES
 18910        ELSE
 18911            GO TO 4110-BUMP-SEQ.
 18912
 18913     IF PB-ISSUE
 18914        IF (ISSUES-IN-ERROR AND
 18915            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18916            ALL-ISSUES
 18917            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18918            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18919            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18920            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18921            MOVE PB-SV-STATE            TO PI-SV-STATE
 18922            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18923            GO TO 7000-DISPLAY-ISSUES
 18924        ELSE
 18925            GO TO 4110-BUMP-SEQ.
 18926
 18927     IF PB-CANCELLATION
 18928        IF DISPLAY-CHK-REQ-RECORDS
 18929           IF PB-C-REFUND-REQUESTED
 18930              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18931              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18932              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18933              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 347
* EL6311.cbl
 18934              MOVE PB-SV-STATE            TO PI-SV-STATE
 18935              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18936              GO TO 7100-DISPLAY-CANCELS
 18937           ELSE
 18938              GO TO 4110-BUMP-SEQ.
 18939
 18940     IF PB-CANCELLATION
 18941        IF CANCEL-WITH-WARNING
 18942           IF PB-WARNING-ERRORS
 18943              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18944                  GO TO 4110-BUMP-SEQ
 18945              ELSE
 18946                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18947                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18948                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18949                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18950                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18951                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18952                 GO TO 7100-DISPLAY-CANCELS
 18953           ELSE
 18954              GO TO 4110-BUMP-SEQ.
 18955
 18956     IF PB-CANCELLATION
 18957        IF (CANCEL-IN-ERROR  AND
 18958            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18959            ALL-CANCELS
 18960            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18961            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18962            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18963            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18964            MOVE PB-SV-STATE            TO PI-SV-STATE
 18965            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18966            GO TO 7100-DISPLAY-CANCELS.
 18967
 18968 4110-BUMP-SEQ.
 18969     IF NOT DISPLAY-CHANGE-RECORDS
 18970        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18971        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18972     ELSE
 18973        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18974           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18975           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18976        ELSE
 18977           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18978           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18979
 18980     GO TO 4105-READ-NEXT.
 18981
 18982 4150-END-BATCH.
 18983******************************************************************
 18984*                                                                *
 18985*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18986*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 18987*         PROGRAM.                                               *
 18988*                                                                *
 18989******************************************************************
 18990
 18991     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 348
* EL6311.cbl
 18992         IF PENDING-BUS-RECS-FOUND
 18993             NEXT SENTENCE
 18994           ELSE
 18995             MOVE '9'            TO PI-BROWSE-SW
 18996             GO TO 9400-CLEAR.
 18997
 18998     IF SHOW-RECORD
 18999        MOVE ER-2253             TO EMI-ERROR
 19000     ELSE
 19001        MOVE ER-2251             TO EMI-ERROR.
 19002
 19003     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19004
 19005     IF PI-MAP-NAME = SPACES
 19006        MOVE -1                  TO BMAINTL
 19007        MOVE EL631B              TO PI-MAP-NAME
 19008        GO TO 8100-SEND-INITIAL-MAP.
 19009
 19010     IF PI-MAP-NAME = EL631B
 19011        MOVE -1                  TO BMAINTL
 19012     ELSE
 19013        IF PI-MAP-NAME = EL631C
 19014           MOVE -1               TO CMAINTL
 19015        ELSE
 19016           MOVE -1               TO DPFENTRL.
 19017
 19018     GO TO 8200-SEND-DATAONLY.
 19019
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 349
* EL6311.cbl
 19021
 19022***************************************************************
 19023*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19024*                                                             *
 19025*      1. START BROWSE WITH                                   *
 19026*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19027*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19028*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19029*                                                             *
 19030*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19031*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19032*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19033*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19034*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19035*               AND IS IT TO BE DISPLAYED.                    *
 19036*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19037*               DISPLAYED.                                    *
 19038*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19039*               DISPLAYED.                                    *
 19040*                                                             *
 19041*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19042*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19043***************************************************************
 19044
 19045 4200-BROWSE-CSR-FORWARD.
 19046
 19047     IF FIRST-TIME
 19048        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19049     ELSE
 19050        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19051
 19052
 19053* EXEC CICS HANDLE CONDITION
 19054*         NOTFND   (4250-END-RECORDS)
 19055*         ENDFILE  (4250-END-RECORDS)
 19056*    END-EXEC.
 19057*    MOVE '"$I''                  ! L #00016272' TO DFHEIV0
 19058     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19059     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19060     MOVE X'4C20233030303136323732' TO DFHEIV0(25:11)
 19061     CALL 'kxdfhei1' USING DFHEIV0
 19062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19063
 19064
 19065
 19066* EXEC CICS STARTBR
 19067*         DATASET   (FILE-ID-ERPNDB4)
 19068*         RIDFLD    (ERPNDB-CSR-KEY)
 19069*    END-EXEC.
 19070     MOVE 0
 19071       TO DFHEIV11
 19072*    MOVE '&,         G          &   #00016277' TO DFHEIV0
 19073     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19074     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19075     MOVE X'2020233030303136323737' TO DFHEIV0(25:11)
 19076     CALL 'kxdfhei1' USING DFHEIV0,
 19077           FILE-ID-ERPNDB4,
 19078           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 350
* EL6311.cbl
 19079           DFHEIV99,
 19080           DFHEIV11,
 19081           DFHEIV99
 19082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19083
 19084
 19085     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19086
 19087     IF FIRST-TIME
 19088        MOVE SPACE               TO WS-FIRST-TIME-SW
 19089        GO TO 4205-READ-NEXT-RECORD.
 19090
 19091
 19092* EXEC CICS READNEXT
 19093*         DATASET    (FILE-ID-ERPNDB4)
 19094*         SET        (ADDRESS OF PENDING-BUSINESS)
 19095*         RIDFLD     (ERPNDB-CSR-KEY)
 19096*    END-EXEC.
 19097     MOVE 0
 19098       TO DFHEIV11
 19099*    MOVE '&.S                   )   #00016288' TO DFHEIV0
 19100     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19101     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19102     MOVE X'2020233030303136323838' TO DFHEIV0(25:11)
 19103     CALL 'kxdfhei1' USING DFHEIV0,
 19104           FILE-ID-ERPNDB4,
 19105           DFHEIV20,
 19106           DFHEIV99,
 19107           ERPNDB-CSR-KEY,
 19108           DFHEIV99,
 19109           DFHEIV11,
 19110           DFHEIV99,
 19111           DFHEIV99
 19112     SET ADDRESS OF PENDING-BUSINESS TO
 19113         DFHEIV20
 19114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19115
 19116
 19117 4205-READ-NEXT-RECORD.
 19118
 19119
 19120* EXEC CICS READNEXT
 19121*         DATASET    (FILE-ID-ERPNDB4)
 19122*         SET        (ADDRESS OF PENDING-BUSINESS)
 19123*         RIDFLD     (ERPNDB-CSR-KEY)
 19124*    END-EXEC.
 19125     MOVE 0
 19126       TO DFHEIV11
 19127*    MOVE '&.S                   )   #00016296' TO DFHEIV0
 19128     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19129     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19130     MOVE X'2020233030303136323936' TO DFHEIV0(25:11)
 19131     CALL 'kxdfhei1' USING DFHEIV0,
 19132           FILE-ID-ERPNDB4,
 19133           DFHEIV20,
 19134           DFHEIV99,
 19135           ERPNDB-CSR-KEY,
 19136           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 351
* EL6311.cbl
 19137           DFHEIV11,
 19138           DFHEIV99,
 19139           DFHEIV99
 19140     SET ADDRESS OF PENDING-BUSINESS TO
 19141         DFHEIV20
 19142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19143
 19144
 19145     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19146
 19147     IF WS-BATCH-PREFIX = '#CL'
 19148        GO TO 4205-READ-NEXT-RECORD.
 19149
 19150     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19151        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19152        GO TO 4250-END-RECORDS.
 19153
 19154     IF PB-BATCH-TRAILER
 19155        GO TO 4205-READ-NEXT-RECORD.
 19156
 19157     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19158        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19159           GO TO 4205-READ-NEXT-RECORD
 19160        ELSE
 19161           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19162              GO TO 4210-CHECK-REC-TYPE
 19163           ELSE
 19164              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19165                 GO TO 4210-CHECK-REC-TYPE
 19166              ELSE
 19167                 GO TO 4205-READ-NEXT-RECORD.
 19168
 19169     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19170        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19171           GO TO 4205-READ-NEXT-RECORD.
 19172
 19173 4210-CHECK-REC-TYPE.
 19174     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19175         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19176             NEXT SENTENCE
 19177         ELSE
 19178             GO TO 4205-READ-NEXT-RECORD.
 19179
 19180     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19181         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19182             NEXT SENTENCE
 19183        ELSE
 19184             GO TO 4205-READ-NEXT-RECORD.
 19185
 19186     IF NOT DISPLAY-CHANGE-RECORDS AND
 19187            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19188        GO TO 4205-READ-NEXT-RECORD.
 19189
 19190     IF DISPLAY-HOLD-RECORDS AND
 19191        NOT PB-RECORD-ON-HOLD
 19192          GO TO 4205-READ-NEXT-RECORD.
 19193
 19194     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 352
* EL6311.cbl
 19195        IF DISPLAY-CHK-REQ-RECORDS
 19196            GO TO 4205-READ-NEXT-RECORD.
 19197
 19198     IF PB-ISSUE
 19199        IF ISSUE-WITH-WARNING
 19200           IF PB-WARNING-ERRORS
 19201              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19202                  GO TO 4205-READ-NEXT-RECORD
 19203              ELSE
 19204                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19205                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19206                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19207                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19208                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19209                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19210                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19211                 GO TO 7000-DISPLAY-ISSUES
 19212           ELSE
 19213              GO TO 4205-READ-NEXT-RECORD.
 19214
 19215     IF PB-ISSUE
 19216        IF (ISSUES-IN-ERROR AND
 19217            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19218            ALL-ISSUES
 19219            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19220            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19221            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19222            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19223            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19224            MOVE PB-SV-STATE            TO PI-SV-STATE
 19225            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19226            GO TO 7000-DISPLAY-ISSUES
 19227        ELSE
 19228            GO TO 4205-READ-NEXT-RECORD.
 19229
 19230     IF PB-CANCELLATION
 19231        IF DISPLAY-CHK-REQ-RECORDS
 19232           IF PB-C-REFUND-REQUESTED
 19233              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19234              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19235              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19236              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19237              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19238              MOVE PB-SV-STATE            TO PI-SV-STATE
 19239              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19240              GO TO 7100-DISPLAY-CANCELS
 19241           ELSE
 19242               GO TO 4205-READ-NEXT-RECORD.
 19243
 19244     IF PB-CANCELLATION
 19245        IF CANCEL-WITH-WARNING
 19246           IF PB-WARNING-ERRORS
 19247              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19248                  GO TO 4205-READ-NEXT-RECORD
 19249              ELSE
 19250                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19251                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19252                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 353
* EL6311.cbl
 19253                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19254                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19255                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19256                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19257                 GO TO 7100-DISPLAY-CANCELS
 19258           ELSE
 19259              GO TO 4205-READ-NEXT-RECORD.
 19260
 19261     IF PB-CANCELLATION
 19262        IF (CANCEL-IN-ERROR  AND
 19263            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19264            ALL-CANCELS
 19265            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19266            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19267            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19268            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19269            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19270            MOVE PB-SV-STATE            TO PI-SV-STATE
 19271            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19272            GO TO 7100-DISPLAY-CANCELS.
 19273
 19274     GO TO 4205-READ-NEXT-RECORD.
 19275
 19276 4250-END-RECORDS.
 19277******************************************************************
 19278*                                                                *
 19279*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19280*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19281*         PROGRAM.                                               *
 19282*                                                                *
 19283******************************************************************
 19284
 19285     IF BROWSE-STARTED
 19286        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19287
 19288* EXEC CICS ENDBR
 19289*            DATASET  (FILE-ID-ERPNDB4)
 19290*       END-EXEC.
 19291     MOVE 0
 19292       TO DFHEIV11
 19293*    MOVE '&2                    $   #00016444' TO DFHEIV0
 19294     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19295     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19296     MOVE X'2020233030303136343434' TO DFHEIV0(25:11)
 19297     CALL 'kxdfhei1' USING DFHEIV0,
 19298           FILE-ID-ERPNDB4,
 19299           DFHEIV11,
 19300           DFHEIV99
 19301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19302
 19303
 19304     IF  EIBTRNID NOT = TRANS-EXB1
 19305         IF PENDING-BUS-RECS-FOUND
 19306             NEXT SENTENCE
 19307           ELSE
 19308             MOVE '9'            TO PI-BROWSE-SW
 19309             GO TO 9400-CLEAR.
 19310
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 354
* EL6311.cbl
 19311     IF SHOW-RECORD
 19312        MOVE ER-2253            TO EMI-ERROR
 19313       ELSE
 19314        MOVE ER-2254            TO EMI-ERROR.
 19315
 19316     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19317
 19318     IF PI-MAP-NAME = SPACES
 19319        MOVE -1                  TO DPFENTRL
 19320        MOVE EL631D               TO PI-MAP-NAME
 19321        GO TO 8100-SEND-INITIAL-MAP.
 19322
 19323     IF PI-MAP-NAME = EL631B
 19324        MOVE -1                  TO BMAINTL
 19325     ELSE
 19326        IF PI-MAP-NAME = EL631C
 19327           MOVE -1               TO CMAINTL
 19328        ELSE
 19329           MOVE -1               TO DPFENTRL.
 19330
 19331     GO TO 8200-SEND-DATAONLY.
 19332
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 355
* EL6311.cbl
 19334
 19335***************************************************************
 19336*                                                             *
 19337*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19338*                                                             *
 19339*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19340*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19341*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19342*                                                             *
 19343*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19344*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19345*          A. IS IT WITHIN THE SAME COMPANY                   *
 19346*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19347*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19348*                AND IS IT TO BE DISPLAYED.                   *
 19349*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19350*                DISPLAYED.                                   *
 19351*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19352*                DISPLAYED.                                   *
 19353*                                                             *
 19354*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19355*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19356*                                                             *
 19357*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19358*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19359*                THEY ARE NOT TO BE DISPLAYED.                *
 19360*                                                             *
 19361***************************************************************
 19362
 19363 4300-BROWSE-FILE-FORWARD.
 19364     IF FIRST-TIME OR SHOW-RECORD
 19365        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19366        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19367        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19368     ELSE
 19369        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19370        IF ERPNDB-BATCH-SEQ-NO = +9999
 19371           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19372        ELSE
 19373           IF DISPLAY-CHANGE-RECORDS
 19374              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19375           ELSE
 19376              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19377              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19378
 19379
 19380* EXEC CICS HANDLE CONDITION
 19381*         ENDFILE  (4350-END-BATCH)
 19382*         NOTFND   (4350-END-BATCH)
 19383*    END-EXEC.
 19384*    MOVE '"$''I                  ! M #00016523' TO DFHEIV0
 19385     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19386     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19387     MOVE X'4D20233030303136353233' TO DFHEIV0(25:11)
 19388     CALL 'kxdfhei1' USING DFHEIV0
 19389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19390
 19391
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 356
* EL6311.cbl
 19392 4305-READ-NEXT.
 19393     IF PI-DISPLAY-ORIGINAL-BATCH
 19394        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19395     ELSE
 19396        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19397
 19398
 19399* EXEC CICS READ
 19400*         DATASET   (FILE-ID)
 19401*         SET       (ADDRESS OF PENDING-BUSINESS)
 19402*         RIDFLD    (ERPNDB-KEY)
 19403*         GTEQ
 19404*    END-EXEC.
 19405*    MOVE '&"S        G          (   #00016534' TO DFHEIV0
 19406     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19407     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19408     MOVE X'2020233030303136353334' TO DFHEIV0(25:11)
 19409     CALL 'kxdfhei1' USING DFHEIV0,
 19410           FILE-ID,
 19411           DFHEIV20,
 19412           DFHEIV99,
 19413           ERPNDB-KEY,
 19414           DFHEIV99,
 19415           DFHEIV99,
 19416           DFHEIV99
 19417     SET ADDRESS OF PENDING-BUSINESS TO
 19418         DFHEIV20
 19419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19420
 19421
 19422     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19423        GO TO 4350-END-BATCH.
 19424
 19425     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19426                                    WS-BATCH-NO.
 19427
 19428     IF  WS-BATCH-PREFIX = '#CL'
 19429         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19430         GO TO 4305-READ-NEXT.
 19431
 19432     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19433     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19434     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19435     MOVE PB-STATE               TO PI-PB-STATE.
 19436     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19437
 19438     IF PB-BATCH-TRAILER
 19439        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19440        GO TO 4305-READ-NEXT.
 19441
 19442     IF SHOW-RECORD
 19443           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19444              GO TO 4310-BUMP-SEQ
 19445           ELSE
 19446              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19447                 GO TO 4310-BUMP-SEQ
 19448              ELSE
 19449                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 357
* EL6311.cbl
 19450
 19451     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19452        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19453           GO TO 4310-BUMP-SEQ
 19454        ELSE
 19455           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19456              GO TO 4307-CHECK-REC-TYPE
 19457           ELSE
 19458              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19459                 GO TO 4307-CHECK-REC-TYPE
 19460              ELSE
 19461                 GO TO 4310-BUMP-SEQ.
 19462
 19463     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19464        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19465           GO TO 4310-BUMP-SEQ.
 19466
 19467 4307-CHECK-REC-TYPE.
 19468     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19469         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19470             NEXT SENTENCE
 19471         ELSE
 19472             GO TO 4310-BUMP-SEQ.
 19473
 19474     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19475         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19476             NEXT SENTENCE
 19477        ELSE
 19478             GO TO 4310-BUMP-SEQ.
 19479
 19480     IF NOT DISPLAY-CHANGE-RECORDS AND
 19481            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19482        GO TO 4310-BUMP-SEQ.
 19483
 19484     IF DISPLAY-HOLD-RECORDS AND
 19485        NOT PB-RECORD-ON-HOLD
 19486          GO TO 4310-BUMP-SEQ.
 19487
 19488     IF PB-ISSUE
 19489        IF DISPLAY-CHK-REQ-RECORDS
 19490           GO TO 4310-BUMP-SEQ.
 19491
 19492     IF PB-ISSUE
 19493        IF ISSUE-WITH-WARNING
 19494           IF PB-WARNING-ERRORS
 19495              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19496                  GO TO 4310-BUMP-SEQ
 19497              ELSE
 19498                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19499                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19500                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19501                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19502                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19503                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19504                 GO TO 7000-DISPLAY-ISSUES
 19505           ELSE
 19506              GO TO 4310-BUMP-SEQ.
 19507
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 358
* EL6311.cbl
 19508     IF PB-ISSUE
 19509        IF (ISSUES-IN-ERROR AND
 19510            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19511            ALL-ISSUES
 19512            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19513            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19514            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19515            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19516            MOVE PB-SV-STATE            TO PI-SV-STATE
 19517            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19518            GO TO 7000-DISPLAY-ISSUES
 19519        ELSE
 19520            GO TO 4310-BUMP-SEQ.
 19521
 19522     IF PB-CANCELLATION
 19523        IF DISPLAY-CHK-REQ-RECORDS
 19524           IF PB-C-REFUND-REQUESTED
 19525              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19526              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19527              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19528              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19529              MOVE PB-SV-STATE            TO PI-SV-STATE
 19530              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19531              GO TO 7100-DISPLAY-CANCELS
 19532           ELSE
 19533              GO TO 4310-BUMP-SEQ.
 19534
 19535     IF PB-CANCELLATION
 19536        IF CANCEL-WITH-WARNING
 19537           IF PB-WARNING-ERRORS
 19538              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19539                  GO TO 4310-BUMP-SEQ
 19540              ELSE
 19541                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19542                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19543                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19544                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19545                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19546                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19547                 GO TO 7100-DISPLAY-CANCELS
 19548           ELSE
 19549              GO TO 4310-BUMP-SEQ.
 19550
 19551     IF PB-CANCELLATION
 19552        IF (CANCEL-IN-ERROR  AND
 19553            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19554            ALL-CANCELS
 19555            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19556            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19557            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19558            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19559            MOVE PB-SV-STATE            TO PI-SV-STATE
 19560            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19561            GO TO 7100-DISPLAY-CANCELS.
 19562
 19563 4310-BUMP-SEQ.
 19564     IF NOT DISPLAY-CHANGE-RECORDS
 19565        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 359
* EL6311.cbl
 19566        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19567     ELSE
 19568        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19569           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19570           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19571        ELSE
 19572           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19573           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19574
 19575     GO TO 4305-READ-NEXT.
 19576
 19577 4350-END-BATCH.
 19578
 19579******************************************************************
 19580*                                                                *
 19581*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19582*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19583*         PROGRAM.                                               *
 19584*                                                                *
 19585******************************************************************
 19586
 19587     IF  EIBTRNID NOT = TRANS-EXB1
 19588         IF PENDING-BUS-RECS-FOUND
 19589             NEXT SENTENCE
 19590           ELSE
 19591             MOVE '9'            TO PI-BROWSE-SW
 19592             GO TO 9400-CLEAR.
 19593
 19594     IF SHOW-RECORD
 19595        MOVE ER-2253            TO EMI-ERROR
 19596     ELSE
 19597        MOVE ER-2251            TO EMI-ERROR.
 19598
 19599     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19600
 19601     IF PI-MAP-NAME = SPACES
 19602        MOVE -1                  TO BMAINTL
 19603        MOVE EL631B               TO PI-MAP-NAME
 19604        GO TO 8100-SEND-INITIAL-MAP.
 19605
 19606     IF PI-MAP-NAME = EL631B
 19607        MOVE -1                  TO BMAINTL
 19608     ELSE
 19609        IF PI-MAP-NAME = EL631C
 19610           MOVE -1               TO CMAINTL
 19611        ELSE
 19612           MOVE -1               TO DPFENTRL.
 19613
 19614     GO TO 8200-SEND-DATAONLY.
 19615
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 360
* EL6311.cbl
 19617
 19618******************************************************************
 19619*                                                                *
 19620*        B R O W S E   D E T A I L   B A C K W A R D             *
 19621*                                                                *
 19622******************************************************************
 19623
 19624 4500-BROWSE-DETAIL-BACKWARD.
 19625
 19626     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19627
 19628
 19629* EXEC CICS HANDLE CONDITION
 19630*         NOTFND   (4570-NOT-FOUND)
 19631*         ENDFILE  (4550-END-RECORDS)
 19632*    END-EXEC
 19633*    MOVE '"$I''                  ! N #00016747' TO DFHEIV0
 19634     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19635     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19636     MOVE X'4E20233030303136373437' TO DFHEIV0(25:11)
 19637     CALL 'kxdfhei1' USING DFHEIV0
 19638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19639
 19640
 19641* EXEC CICS STARTBR
 19642*         DATASET   (FILE-ID-ERPNDB2)
 19643*         RIDFLD    (ERPNDB-ALT-KEY)
 19644*    END-EXEC.
 19645     MOVE 0
 19646       TO DFHEIV11
 19647*    MOVE '&,         G          &   #00016752' TO DFHEIV0
 19648     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19649     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19650     MOVE X'2020233030303136373532' TO DFHEIV0(25:11)
 19651     CALL 'kxdfhei1' USING DFHEIV0,
 19652           FILE-ID-ERPNDB2,
 19653           ERPNDB-ALT-KEY,
 19654           DFHEIV99,
 19655           DFHEIV11,
 19656           DFHEIV99
 19657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19658
 19659
 19660     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19661                                    WS-FIRST-TIME-SW.
 19662
 19663 4505-READ-PREV-RECORD.
 19664
 19665* EXEC CICS READPREV
 19666*         DATASET    (FILE-ID-ERPNDB2)
 19667*         SET        (ADDRESS OF PENDING-BUSINESS)
 19668*         RIDFLD     (ERPNDB-ALT-KEY)
 19669*    END-EXEC.
 19670     MOVE 0
 19671       TO DFHEIV11
 19672*    MOVE '&0S                   )   #00016761' TO DFHEIV0
 19673     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19674     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 361
* EL6311.cbl
 19675     MOVE X'2020233030303136373631' TO DFHEIV0(25:11)
 19676     CALL 'kxdfhei1' USING DFHEIV0,
 19677           FILE-ID-ERPNDB2,
 19678           DFHEIV20,
 19679           DFHEIV99,
 19680           ERPNDB-ALT-KEY,
 19681           DFHEIV99,
 19682           DFHEIV11,
 19683           DFHEIV99,
 19684           DFHEIV99
 19685     SET ADDRESS OF PENDING-BUSINESS TO
 19686         DFHEIV20
 19687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19688
 19689
 19690     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19691
 19692     IF WS-BATCH-PREFIX = '#CL'
 19693         GO TO 4505-READ-PREV-RECORD.
 19694
 19695     IF FIRST-TIME
 19696         MOVE SPACE               TO WS-FIRST-TIME-SW
 19697         GO TO 4505-READ-PREV-RECORD.
 19698
 19699     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19700        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19701        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19702        PB-STATE         NOT = PI-PB-STATE    OR
 19703        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19704          GO TO 4550-END-RECORDS.
 19705
 19706
 19707     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19708
 19709     IF PB-BATCH-TRAILER
 19710        GO TO 4505-READ-PREV-RECORD.
 19711
 19712     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19713
 19714     IF  WS-BATCH-PREFIX = '#CL'
 19715         GO TO 4505-READ-PREV-RECORD.
 19716
 19717     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19718        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19719           GO TO 4505-READ-PREV-RECORD
 19720        ELSE
 19721           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19722              GO TO 4510-CHECK-REC-TYPE
 19723           ELSE
 19724              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19725                 GO TO 4510-CHECK-REC-TYPE
 19726              ELSE
 19727                 GO TO 4505-READ-PREV-RECORD.
 19728
 19729     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19730        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19731           GO TO 4505-READ-PREV-RECORD.
 19732
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 362
* EL6311.cbl
 19733 4510-CHECK-REC-TYPE.
 19734     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19735         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19736             NEXT SENTENCE
 19737         ELSE
 19738             GO TO 4505-READ-PREV-RECORD.
 19739
 19740     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19741         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19742             NEXT SENTENCE
 19743        ELSE
 19744             GO TO 4505-READ-PREV-RECORD.
 19745
 19746     IF NOT DISPLAY-CHANGE-RECORDS AND
 19747            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19748        GO TO 4505-READ-PREV-RECORD.
 19749
 19750     IF DISPLAY-HOLD-RECORDS AND
 19751        NOT PB-RECORD-ON-HOLD
 19752          GO TO 4505-READ-PREV-RECORD.
 19753
 19754     IF PB-ISSUE
 19755        IF DISPLAY-CHK-REQ-RECORDS
 19756           GO TO 4505-READ-PREV-RECORD.
 19757
 19758     IF PB-ISSUE
 19759        IF ISSUE-WITH-WARNING
 19760           IF PB-WARNING-ERRORS
 19761              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19762                  GO TO 4505-READ-PREV-RECORD
 19763              ELSE
 19764                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19765                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19766                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19767                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19768                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19769                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19770                 GO TO 7000-DISPLAY-ISSUES
 19771           ELSE
 19772              GO TO 4505-READ-PREV-RECORD.
 19773
 19774     IF PB-ISSUE
 19775        IF (ISSUES-IN-ERROR AND
 19776            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19777            ALL-ISSUES
 19778            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19779            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19780            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19781            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19782            MOVE PB-SV-STATE            TO PI-SV-STATE
 19783            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19784            GO TO 7000-DISPLAY-ISSUES
 19785        ELSE
 19786            GO TO 4505-READ-PREV-RECORD.
 19787
 19788     IF PB-CANCELLATION
 19789        IF DISPLAY-CHK-REQ-RECORDS
 19790           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 363
* EL6311.cbl
 19791              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19792              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19793              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19794              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19795              MOVE PB-SV-STATE            TO PI-SV-STATE
 19796              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19797              GO TO 7100-DISPLAY-CANCELS
 19798           ELSE
 19799              GO TO 4505-READ-PREV-RECORD.
 19800
 19801     IF PB-CANCELLATION
 19802        IF CANCEL-WITH-WARNING
 19803           IF PB-WARNING-ERRORS
 19804              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19805                  GO TO 4505-READ-PREV-RECORD
 19806              ELSE
 19807                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19808                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19809                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19810                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19811                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19812                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19813                 GO TO 7100-DISPLAY-CANCELS
 19814           ELSE
 19815              GO TO 4505-READ-PREV-RECORD.
 19816
 19817     IF PB-CANCELLATION
 19818        IF (CANCEL-IN-ERROR  AND
 19819            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19820            ALL-CANCELS
 19821            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19822            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19823            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19824            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19825            MOVE PB-SV-STATE            TO PI-SV-STATE
 19826            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19827            GO TO 7100-DISPLAY-CANCELS.
 19828
 19829     GO TO 4505-READ-PREV-RECORD.
 19830
 19831 4550-END-RECORDS.
 19832     IF PI-MAP-NAME = EL631B
 19833        MOVE -1                  TO BMAINTL
 19834     ELSE
 19835        IF PI-MAP-NAME = EL631C
 19836           MOVE -1               TO CMAINTL
 19837        ELSE
 19838           MOVE -1               TO DPFENTRL.
 19839
 19840     MOVE ER-2255               TO EMI-ERROR.
 19841     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19842     GO TO 8200-SEND-DATAONLY.
 19843
 19844 4570-NOT-FOUND.
 19845
 19846******************************************************************
 19847*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19848******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 364
* EL6311.cbl
 19849
 19850
 19851* EXEC CICS RESETBR
 19852*         DATASET    (FILE-ID-ERPNDB2)
 19853*         RIDFLD     (ERPNDB-ALT-KEY)
 19854*    END-EXEC.
 19855     MOVE 0
 19856       TO DFHEIV11
 19857*    MOVE '&4         G          &   #00016927' TO DFHEIV0
 19858     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19859     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19860     MOVE X'2020233030303136393237' TO DFHEIV0(25:11)
 19861     CALL 'kxdfhei1' USING DFHEIV0,
 19862           FILE-ID-ERPNDB2,
 19863           ERPNDB-ALT-KEY,
 19864           DFHEIV99,
 19865           DFHEIV11,
 19866           DFHEIV99
 19867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19868
 19869
 19870
 19871* EXEC CICS READNEXT
 19872*         DATASET    (FILE-ID-ERPNDB2)
 19873*         SET        (ADDRESS OF PENDING-BUSINESS)
 19874*         RIDFLD     (ERPNDB-ALT-KEY)
 19875*    END-EXEC.
 19876     MOVE 0
 19877       TO DFHEIV11
 19878*    MOVE '&.S                   )   #00016932' TO DFHEIV0
 19879     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19880     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19881     MOVE X'2020233030303136393332' TO DFHEIV0(25:11)
 19882     CALL 'kxdfhei1' USING DFHEIV0,
 19883           FILE-ID-ERPNDB2,
 19884           DFHEIV20,
 19885           DFHEIV99,
 19886           ERPNDB-ALT-KEY,
 19887           DFHEIV99,
 19888           DFHEIV11,
 19889           DFHEIV99,
 19890           DFHEIV99
 19891     SET ADDRESS OF PENDING-BUSINESS TO
 19892         DFHEIV20
 19893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19894
 19895
 19896
 19897* EXEC CICS READPREV
 19898*         DATASET    (FILE-ID-ERPNDB2)
 19899*         SET        (ADDRESS OF PENDING-BUSINESS)
 19900*         RIDFLD     (ERPNDB-ALT-KEY)
 19901*    END-EXEC.
 19902     MOVE 0
 19903       TO DFHEIV11
 19904*    MOVE '&0S                   )   #00016938' TO DFHEIV0
 19905     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19906     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 365
* EL6311.cbl
 19907     MOVE X'2020233030303136393338' TO DFHEIV0(25:11)
 19908     CALL 'kxdfhei1' USING DFHEIV0,
 19909           FILE-ID-ERPNDB2,
 19910           DFHEIV20,
 19911           DFHEIV99,
 19912           ERPNDB-ALT-KEY,
 19913           DFHEIV99,
 19914           DFHEIV11,
 19915           DFHEIV99,
 19916           DFHEIV99
 19917     SET ADDRESS OF PENDING-BUSINESS TO
 19918         DFHEIV20
 19919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19920
 19921
 19922 4580-READ-PREV-RECORD.
 19923
 19924* EXEC CICS READPREV
 19925*         DATASET    (FILE-ID-ERPNDB2)
 19926*         SET        (ADDRESS OF PENDING-BUSINESS)
 19927*         RIDFLD     (ERPNDB-ALT-KEY)
 19928*    END-EXEC.
 19929     MOVE 0
 19930       TO DFHEIV11
 19931*    MOVE '&0S                   )   #00016945' TO DFHEIV0
 19932     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19933     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19934     MOVE X'2020233030303136393435' TO DFHEIV0(25:11)
 19935     CALL 'kxdfhei1' USING DFHEIV0,
 19936           FILE-ID-ERPNDB2,
 19937           DFHEIV20,
 19938           DFHEIV99,
 19939           ERPNDB-ALT-KEY,
 19940           DFHEIV99,
 19941           DFHEIV11,
 19942           DFHEIV99,
 19943           DFHEIV99
 19944     SET ADDRESS OF PENDING-BUSINESS TO
 19945         DFHEIV20
 19946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19947
 19948
 19949     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19950
 19951     IF WS-BATCH-PREFIX = '#CL'
 19952        GO TO 4580-READ-PREV-RECORD.
 19953
 19954     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19955     GO TO 4505-READ-PREV-RECORD.
 19956
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 366
* EL6311.cbl
 19958
 19959******************************************************************
 19960*                                                                *
 19961*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19962*                                                                *
 19963******************************************************************
 19964
 19965 4600-BROWSE-PRIMARY-BACKWARD.
 19966        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19967
 19968     IF ERPNDB-BATCH-SEQ-NO = +9999
 19969        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19970
 19971        IF ERPNDB-BATCH-SEQ-NO = +0000
 19972           GO TO 4650-END-BATCH
 19973        ELSE
 19974           IF PI-MAP-NAME NOT = EL631D
 19975              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19976                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19977              ELSE
 19978                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19979                 IF DISPLAY-CHANGE-RECORDS
 19980                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19981                 ELSE
 19982                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19983
 19984
 19985* EXEC CICS HANDLE CONDITION
 19986*         NOTFND    (4680-NOT-FOUND)
 19987*         ENDFILE   (4680-NOT-FOUND)
 19988*    END-EXEC.
 19989*    MOVE '"$I''                  ! O #00016986' TO DFHEIV0
 19990     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19991     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19992     MOVE X'4F20233030303136393836' TO DFHEIV0(25:11)
 19993     CALL 'kxdfhei1' USING DFHEIV0
 19994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19995
 19996
 19997 4605-READ-NEXT.
 19998     IF ERPNDB-BATCH-SEQ-NO = +0000
 19999        GO TO 4650-END-BATCH.
 20000
 20001     IF PI-DISPLAY-ORIGINAL-BATCH
 20002        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20003     ELSE
 20004        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20005
 20006
 20007* EXEC CICS READ
 20008*         DATASET   (FILE-ID)
 20009*         SET       (ADDRESS OF PENDING-BUSINESS)
 20010*         RIDFLD    (ERPNDB-KEY)
 20011*    END-EXEC.
 20012*    MOVE '&"S        E          (   #00017000' TO DFHEIV0
 20013     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20014     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20015     MOVE X'2020233030303137303030' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 367
* EL6311.cbl
 20016     CALL 'kxdfhei1' USING DFHEIV0,
 20017           FILE-ID,
 20018           DFHEIV20,
 20019           DFHEIV99,
 20020           ERPNDB-KEY,
 20021           DFHEIV99,
 20022           DFHEIV99,
 20023           DFHEIV99
 20024     SET ADDRESS OF PENDING-BUSINESS TO
 20025         DFHEIV20
 20026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20027
 20028
 20029     IF NOT  PI-PRIMARY-WITH-SELECT
 20030        GO TO 4607-CHECK-REC-TYPE.
 20031
 20032     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20033
 20034     IF  WS-BATCH-PREFIX = '#CL'
 20035         GO TO 4610-BUMP-SEQ.
 20036
 20037     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20038        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20039           GO TO 4610-BUMP-SEQ
 20040        ELSE
 20041           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20042              GO TO 4607-CHECK-REC-TYPE
 20043           ELSE
 20044              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20045                 GO TO 4607-CHECK-REC-TYPE
 20046              ELSE
 20047                 GO TO 4610-BUMP-SEQ.
 20048
 20049     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20050        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20051           GO TO 4610-BUMP-SEQ.
 20052
 20053 4607-CHECK-REC-TYPE.
 20054     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20055         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20056             NEXT SENTENCE
 20057         ELSE
 20058             GO TO 4610-BUMP-SEQ.
 20059
 20060     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20061         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20062             NEXT SENTENCE
 20063        ELSE
 20064             GO TO 4610-BUMP-SEQ.
 20065
 20066     IF NOT DISPLAY-CHANGE-RECORDS AND
 20067            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20068        GO TO 4610-BUMP-SEQ.
 20069
 20070     IF DISPLAY-HOLD-RECORDS AND
 20071        NOT PB-RECORD-ON-HOLD
 20072          GO TO 4610-BUMP-SEQ.
 20073
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 368
* EL6311.cbl
 20074     IF PB-ISSUE
 20075        IF DISPLAY-CHK-REQ-RECORDS
 20076           GO TO 4610-BUMP-SEQ.
 20077
 20078     IF PB-ISSUE
 20079        IF ISSUE-WITH-WARNING
 20080           IF PB-WARNING-ERRORS
 20081              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20082                  GO TO 4610-BUMP-SEQ
 20083              ELSE
 20084                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20085                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20086                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20087                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20088                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20089                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20090                 GO TO 7000-DISPLAY-ISSUES
 20091           ELSE
 20092              GO TO 4610-BUMP-SEQ.
 20093
 20094     IF PB-ISSUE
 20095        IF (ISSUES-IN-ERROR AND
 20096            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20097            ALL-ISSUES
 20098            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20099            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20100            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20101            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20102            MOVE PB-SV-STATE            TO PI-SV-STATE
 20103            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20104            GO TO 7000-DISPLAY-ISSUES
 20105        ELSE
 20106            GO TO 4610-BUMP-SEQ.
 20107
 20108     IF PB-CANCELLATION
 20109        IF DISPLAY-CHK-REQ-RECORDS
 20110           IF PB-C-REFUND-REQUESTED
 20111              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20112              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20113              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20114              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20115              MOVE PB-SV-STATE            TO PI-SV-STATE
 20116              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20117              GO TO 7100-DISPLAY-CANCELS
 20118           ELSE
 20119              GO TO 4610-BUMP-SEQ.
 20120
 20121     IF PB-CANCELLATION
 20122        IF CANCEL-WITH-WARNING
 20123           IF PB-WARNING-ERRORS
 20124              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20125                  GO TO 4610-BUMP-SEQ
 20126              ELSE
 20127                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20128                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20129                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20130                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20131                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 369
* EL6311.cbl
 20132                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20133                 GO TO 7100-DISPLAY-CANCELS
 20134           ELSE
 20135              GO TO 4610-BUMP-SEQ.
 20136
 20137     IF PB-CANCELLATION
 20138        IF (CANCEL-IN-ERROR  AND
 20139            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20140            ALL-CANCELS
 20141            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20142            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20143            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20144            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20145            MOVE PB-SV-STATE            TO PI-SV-STATE
 20146            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20147            GO TO 7100-DISPLAY-CANCELS.
 20148
 20149 4610-BUMP-SEQ.
 20150     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20151        GO TO 4650-END-BATCH.
 20152
 20153     IF DISPLAY-CHANGE-RECORDS
 20154        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20155           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20156        ELSE
 20157           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20158           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20159        ELSE
 20160           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20161           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20162
 20163        GO TO 4605-READ-NEXT.
 20164
 20165 4650-END-BATCH.
 20166     IF PI-MAP-NAME = EL631B
 20167        MOVE -1                  TO BMAINTL
 20168     ELSE
 20169        IF PI-MAP-NAME = EL631C
 20170           MOVE -1               TO CMAINTL
 20171        ELSE
 20172           MOVE -1               TO DPFENTRL.
 20173
 20174     MOVE ER-2252               TO EMI-ERROR.
 20175     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20176     GO TO 8200-SEND-DATAONLY.
 20177
 20178 4680-NOT-FOUND.
 20179     IF DISPLAY-CHANGE-RECORDS
 20180        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20181           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20182        ELSE
 20183           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20184           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20185     ELSE
 20186        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20187
 20188     GO TO 4605-READ-NEXT.
 20189
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 370
* EL6311.cbl
 20191
 20192******************************************************************
 20193*                                                                *
 20194*        B R O W S E   F I L E   B A C K W A R D S               *
 20195*                                                                *
 20196******************************************************************
 20197
 20198 4800-BROWSE-FILE-BACKWARD.
 20199
 20200* EXEC CICS HANDLE CONDITION
 20201*         NOTFND   (4860-NOT-FOUND)
 20202*         ENDFILE  (4850-END-RECORDS)
 20203*    END-EXEC.
 20204*    MOVE '"$I''                  ! P #00017176' TO DFHEIV0
 20205     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20206     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20207     MOVE X'5020233030303137313736' TO DFHEIV0(25:11)
 20208     CALL 'kxdfhei1' USING DFHEIV0
 20209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20210
 20211
 20212     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20213
 20214     IF PI-DISPLAY-ORIGINAL-BATCH
 20215        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20216     ELSE
 20217        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20218
 20219
 20220* EXEC CICS STARTBR
 20221*         DATASET   (FILE-ID)
 20222*         RIDFLD    (ERPNDB-KEY)
 20223*    END-EXEC.
 20224     MOVE 0
 20225       TO DFHEIV11
 20226*    MOVE '&,         G          &   #00017188' TO DFHEIV0
 20227     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20228     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20229     MOVE X'2020233030303137313838' TO DFHEIV0(25:11)
 20230     CALL 'kxdfhei1' USING DFHEIV0,
 20231           FILE-ID,
 20232           ERPNDB-KEY,
 20233           DFHEIV99,
 20234           DFHEIV11,
 20235           DFHEIV99
 20236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20237
 20238
 20239     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20240
 20241
 20242* EXEC CICS READPREV
 20243*         DATASET    (FILE-ID-ERPNDB)
 20244*         SET        (ADDRESS OF PENDING-BUSINESS)
 20245*         RIDFLD     (ERPNDB-KEY)
 20246*    END-EXEC.
 20247     MOVE 0
 20248       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 371
* EL6311.cbl
 20249*    MOVE '&0S                   )   #00017195' TO DFHEIV0
 20250     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20251     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20252     MOVE X'2020233030303137313935' TO DFHEIV0(25:11)
 20253     CALL 'kxdfhei1' USING DFHEIV0,
 20254           FILE-ID-ERPNDB,
 20255           DFHEIV20,
 20256           DFHEIV99,
 20257           ERPNDB-KEY,
 20258           DFHEIV99,
 20259           DFHEIV11,
 20260           DFHEIV99,
 20261           DFHEIV99
 20262     SET ADDRESS OF PENDING-BUSINESS TO
 20263         DFHEIV20
 20264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20265
 20266
 20267 4810-READ-PREV-RECORD.
 20268
 20269* EXEC CICS READPREV
 20270*         DATASET    (FILE-ID-ERPNDB)
 20271*         SET        (ADDRESS OF PENDING-BUSINESS)
 20272*         RIDFLD     (ERPNDB-KEY)
 20273*    END-EXEC.
 20274     MOVE 0
 20275       TO DFHEIV11
 20276*    MOVE '&0S                   )   #00017202' TO DFHEIV0
 20277     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20278     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20279     MOVE X'2020233030303137323032' TO DFHEIV0(25:11)
 20280     CALL 'kxdfhei1' USING DFHEIV0,
 20281           FILE-ID-ERPNDB,
 20282           DFHEIV20,
 20283           DFHEIV99,
 20284           ERPNDB-KEY,
 20285           DFHEIV99,
 20286           DFHEIV11,
 20287           DFHEIV99,
 20288           DFHEIV99
 20289     SET ADDRESS OF PENDING-BUSINESS TO
 20290         DFHEIV20
 20291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20292
 20293
 20294     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20295        GO TO 4850-END-RECORDS.
 20296
 20297     IF PB-BATCH-TRAILER
 20298        GO TO 4810-READ-PREV-RECORD.
 20299
 20300     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20301
 20302     IF  WS-BATCH-PREFIX = '#CL'
 20303         GO TO 4810-READ-PREV-RECORD.
 20304
 20305     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20306        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 372
* EL6311.cbl
 20307           GO TO 4810-READ-PREV-RECORD
 20308        ELSE
 20309           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20310              GO TO 4820-CHECK-REC-TYPE
 20311           ELSE
 20312              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20313                 GO TO 4820-CHECK-REC-TYPE
 20314              ELSE
 20315                 GO TO 4810-READ-PREV-RECORD.
 20316
 20317     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20318        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20319           GO TO 4810-READ-PREV-RECORD.
 20320
 20321 4820-CHECK-REC-TYPE.
 20322     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20323         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20324             NEXT SENTENCE
 20325         ELSE
 20326             GO TO 4810-READ-PREV-RECORD.
 20327
 20328     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20329         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20330             NEXT SENTENCE
 20331        ELSE
 20332             GO TO 4810-READ-PREV-RECORD.
 20333
 20334     IF NOT DISPLAY-CHANGE-RECORDS AND
 20335            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20336        GO TO 4810-READ-PREV-RECORD.
 20337
 20338     IF DISPLAY-HOLD-RECORDS AND
 20339        NOT PB-RECORD-ON-HOLD
 20340          GO TO 4810-READ-PREV-RECORD.
 20341
 20342     IF PB-ISSUE
 20343        IF DISPLAY-CHK-REQ-RECORDS
 20344           GO TO 4810-READ-PREV-RECORD.
 20345
 20346     IF PB-ISSUE
 20347        IF ISSUE-WITH-WARNING
 20348           IF PB-WARNING-ERRORS
 20349              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20350                  GO TO 4810-READ-PREV-RECORD
 20351              ELSE
 20352                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20353                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20354                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20355                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20356                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20357                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20358                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20359                 GO TO 7000-DISPLAY-ISSUES
 20360           ELSE
 20361              GO TO 4810-READ-PREV-RECORD.
 20362
 20363     IF PB-ISSUE
 20364        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 373
* EL6311.cbl
 20365            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20366            ALL-ISSUES
 20367            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20368            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20369            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20370            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20371            MOVE PB-SV-STATE            TO PI-SV-STATE
 20372            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20373            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20374            GO TO 7000-DISPLAY-ISSUES
 20375        ELSE
 20376            GO TO 4810-READ-PREV-RECORD.
 20377
 20378     IF PB-CANCELLATION
 20379        IF DISPLAY-CHK-REQ-RECORDS
 20380           IF PB-C-REFUND-REQUESTED
 20381              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20382              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20383              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20384              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20385              MOVE PB-SV-STATE            TO PI-SV-STATE
 20386              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20387              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20388              GO TO 7100-DISPLAY-CANCELS
 20389           ELSE
 20390              GO TO 4810-READ-PREV-RECORD.
 20391
 20392     IF PB-CANCELLATION
 20393        IF CANCEL-WITH-WARNING
 20394           IF PB-WARNING-ERRORS
 20395              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20396                  GO TO 4810-READ-PREV-RECORD
 20397              ELSE
 20398                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20399                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20400                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20401                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20402                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20403                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20404                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20405                 GO TO 7100-DISPLAY-CANCELS
 20406           ELSE
 20407              GO TO 4810-READ-PREV-RECORD.
 20408
 20409     IF PB-CANCELLATION
 20410        IF (CANCEL-IN-ERROR  AND
 20411            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20412            ALL-CANCELS
 20413            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20414            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20415            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20416            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20417            MOVE PB-SV-STATE            TO PI-SV-STATE
 20418            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20419            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20420            GO TO 7100-DISPLAY-CANCELS.
 20421
 20422     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 374
* EL6311.cbl
 20423
 20424 4850-END-RECORDS.
 20425     MOVE ER-2252                TO EMI-ERROR.
 20426     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20427
 20428     IF PI-MAP-NAME = EL631B
 20429        MOVE -1                  TO BPFENTRL
 20430     ELSE
 20431        MOVE -1                  TO CPFENTRL.
 20432
 20433     GO TO 8200-SEND-DATAONLY.
 20434
 20435 4860-NOT-FOUND.
 20436
 20437******************************************************************
 20438*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20439******************************************************************
 20440
 20441
 20442* EXEC CICS RESETBR
 20443*         DATASET    (FILE-ID-ERPNDB)
 20444*         RIDFLD     (ERPNDB-KEY)
 20445*     END-EXEC.
 20446     MOVE 0
 20447       TO DFHEIV11
 20448*    MOVE '&4         G          &   #00017355' TO DFHEIV0
 20449     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20450     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20451     MOVE X'2020233030303137333535' TO DFHEIV0(25:11)
 20452     CALL 'kxdfhei1' USING DFHEIV0,
 20453           FILE-ID-ERPNDB,
 20454           ERPNDB-KEY,
 20455           DFHEIV99,
 20456           DFHEIV11,
 20457           DFHEIV99
 20458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20459
 20460
 20461
 20462* EXEC CICS READNEXT
 20463*         DATASET    (FILE-ID-ERPNDB)
 20464*         SET        (ADDRESS OF PENDING-BUSINESS)
 20465*         RIDFLD     (ERPNDB-KEY)
 20466*    END-EXEC.
 20467     MOVE 0
 20468       TO DFHEIV11
 20469*    MOVE '&.S                   )   #00017360' TO DFHEIV0
 20470     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20471     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20472     MOVE X'2020233030303137333630' TO DFHEIV0(25:11)
 20473     CALL 'kxdfhei1' USING DFHEIV0,
 20474           FILE-ID-ERPNDB,
 20475           DFHEIV20,
 20476           DFHEIV99,
 20477           ERPNDB-KEY,
 20478           DFHEIV99,
 20479           DFHEIV11,
 20480           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 375
* EL6311.cbl
 20481           DFHEIV99
 20482     SET ADDRESS OF PENDING-BUSINESS TO
 20483         DFHEIV20
 20484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20485
 20486
 20487
 20488* EXEC CICS READPREV
 20489*         DATASET    (FILE-ID-ERPNDB)
 20490*         SET        (ADDRESS OF PENDING-BUSINESS)
 20491*         RIDFLD     (ERPNDB-KEY)
 20492*    END-EXEC.
 20493     MOVE 0
 20494       TO DFHEIV11
 20495*    MOVE '&0S                   )   #00017366' TO DFHEIV0
 20496     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20497     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20498     MOVE X'2020233030303137333636' TO DFHEIV0(25:11)
 20499     CALL 'kxdfhei1' USING DFHEIV0,
 20500           FILE-ID-ERPNDB,
 20501           DFHEIV20,
 20502           DFHEIV99,
 20503           ERPNDB-KEY,
 20504           DFHEIV99,
 20505           DFHEIV11,
 20506           DFHEIV99,
 20507           DFHEIV99
 20508     SET ADDRESS OF PENDING-BUSINESS TO
 20509         DFHEIV20
 20510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20511
 20512
 20513     GO TO 4810-READ-PREV-RECORD.
 20514
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 376
* EL6311.cbl
 20516
 20517******************************************************************
 20518*                                                                *
 20519*           B R O W S E   C S R   B A C K W A R D                *
 20520*                                                                *
 20521******************************************************************
 20522
 20523 4900-BROWSE-CSR-BACKWARD.
 20524
 20525     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20526
 20527
 20528* EXEC CICS HANDLE CONDITION
 20529*         NOTFND   (4970-NOT-FOUND)
 20530*         ENDFILE  (4950-END-RECORDS)
 20531*    END-EXEC
 20532*    MOVE '"$I''                  ! Q #00017386' TO DFHEIV0
 20533     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20534     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20535     MOVE X'5120233030303137333836' TO DFHEIV0(25:11)
 20536     CALL 'kxdfhei1' USING DFHEIV0
 20537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20538
 20539
 20540* EXEC CICS STARTBR
 20541*         DATASET   (FILE-ID-ERPNDB4)
 20542*         RIDFLD    (ERPNDB-CSR-KEY)
 20543*    END-EXEC.
 20544     MOVE 0
 20545       TO DFHEIV11
 20546*    MOVE '&,         G          &   #00017391' TO DFHEIV0
 20547     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20548     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20549     MOVE X'2020233030303137333931' TO DFHEIV0(25:11)
 20550     CALL 'kxdfhei1' USING DFHEIV0,
 20551           FILE-ID-ERPNDB4,
 20552           ERPNDB-CSR-KEY,
 20553           DFHEIV99,
 20554           DFHEIV11,
 20555           DFHEIV99
 20556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20557
 20558
 20559     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20560                                    WS-FIRST-TIME-SW.
 20561
 20562 4905-READ-PREV-RECORD.
 20563
 20564* EXEC CICS READPREV
 20565*         DATASET    (FILE-ID-ERPNDB4)
 20566*         SET        (ADDRESS OF PENDING-BUSINESS)
 20567*         RIDFLD     (ERPNDB-CSR-KEY)
 20568*    END-EXEC.
 20569     MOVE 0
 20570       TO DFHEIV11
 20571*    MOVE '&0S                   )   #00017400' TO DFHEIV0
 20572     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20573     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 377
* EL6311.cbl
 20574     MOVE X'2020233030303137343030' TO DFHEIV0(25:11)
 20575     CALL 'kxdfhei1' USING DFHEIV0,
 20576           FILE-ID-ERPNDB4,
 20577           DFHEIV20,
 20578           DFHEIV99,
 20579           ERPNDB-CSR-KEY,
 20580           DFHEIV99,
 20581           DFHEIV11,
 20582           DFHEIV99,
 20583           DFHEIV99
 20584     SET ADDRESS OF PENDING-BUSINESS TO
 20585         DFHEIV20
 20586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20587
 20588
 20589     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20590
 20591     IF WS-BATCH-PREFIX = '#CL'
 20592         GO TO 4905-READ-PREV-RECORD.
 20593
 20594     IF FIRST-TIME
 20595         MOVE SPACE               TO WS-FIRST-TIME-SW
 20596         GO TO 4905-READ-PREV-RECORD.
 20597
 20598     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20599        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20600        GO TO 4950-END-RECORDS.
 20601
 20602     IF PB-BATCH-TRAILER
 20603        GO TO 4905-READ-PREV-RECORD.
 20604
 20605     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20606
 20607     IF  WS-BATCH-PREFIX = '#CL'
 20608         GO TO 4905-READ-PREV-RECORD.
 20609
 20610     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20611        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20612           GO TO 4905-READ-PREV-RECORD
 20613        ELSE
 20614           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20615              GO TO 4910-CHECK-REC-TYPE
 20616           ELSE
 20617              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20618                 GO TO 4910-CHECK-REC-TYPE
 20619              ELSE
 20620                 GO TO 4905-READ-PREV-RECORD.
 20621
 20622     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20623        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20624           GO TO 4905-READ-PREV-RECORD.
 20625
 20626 4910-CHECK-REC-TYPE.
 20627     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20628         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20629             NEXT SENTENCE
 20630         ELSE
 20631             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 378
* EL6311.cbl
 20632
 20633     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20634         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20635             NEXT SENTENCE
 20636        ELSE
 20637             GO TO 4905-READ-PREV-RECORD.
 20638
 20639     IF NOT DISPLAY-CHANGE-RECORDS AND
 20640            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20641        GO TO 4905-READ-PREV-RECORD.
 20642
 20643     IF DISPLAY-HOLD-RECORDS AND
 20644        NOT PB-RECORD-ON-HOLD
 20645          GO TO 4905-READ-PREV-RECORD.
 20646
 20647     IF PB-ISSUE
 20648        IF DISPLAY-CHK-REQ-RECORDS
 20649           GO TO 4905-READ-PREV-RECORD.
 20650
 20651     IF PB-ISSUE
 20652        IF ISSUE-WITH-WARNING
 20653           IF PB-WARNING-ERRORS
 20654              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20655                  GO TO 4505-READ-PREV-RECORD
 20656              ELSE
 20657                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20658                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20659                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20660                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20661                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20662                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20663                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20664                 GO TO 7000-DISPLAY-ISSUES
 20665           ELSE
 20666              GO TO 4905-READ-PREV-RECORD.
 20667
 20668     IF PB-ISSUE
 20669        IF (ISSUES-IN-ERROR AND
 20670            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20671            ALL-ISSUES
 20672            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20673            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20674            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20675            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20676            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20677            MOVE PB-SV-STATE            TO PI-SV-STATE
 20678            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20679            GO TO 7000-DISPLAY-ISSUES
 20680        ELSE
 20681            GO TO 4905-READ-PREV-RECORD.
 20682
 20683     IF PB-CANCELLATION
 20684        IF DISPLAY-CHK-REQ-RECORDS
 20685           IF PB-C-REFUND-REQUESTED
 20686              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20687              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20688              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20689              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 379
* EL6311.cbl
 20690              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20691              MOVE PB-SV-STATE            TO PI-SV-STATE
 20692              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20693              GO TO 7100-DISPLAY-CANCELS
 20694           ELSE
 20695              GO TO 4905-READ-PREV-RECORD.
 20696
 20697     IF PB-CANCELLATION
 20698        IF CANCEL-WITH-WARNING
 20699           IF PB-WARNING-ERRORS
 20700              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20701                  GO TO 4505-READ-PREV-RECORD
 20702              ELSE
 20703                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20704                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20705                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20706                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20707                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20708                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20709                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20710                 GO TO 7100-DISPLAY-CANCELS
 20711           ELSE
 20712              GO TO 4905-READ-PREV-RECORD.
 20713
 20714     IF PB-CANCELLATION
 20715        IF (CANCEL-IN-ERROR  AND
 20716            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20717            ALL-CANCELS
 20718            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20719            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20720            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20721            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20722            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20723            MOVE PB-SV-STATE            TO PI-SV-STATE
 20724            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20725            GO TO 7100-DISPLAY-CANCELS.
 20726
 20727     GO TO 4905-READ-PREV-RECORD.
 20728
 20729 4950-END-RECORDS.
 20730     IF PI-MAP-NAME = EL631B
 20731        MOVE -1                  TO BMAINTL
 20732     ELSE
 20733        IF PI-MAP-NAME = EL631C
 20734           MOVE -1               TO CMAINTL
 20735        ELSE
 20736           MOVE -1               TO DPFENTRL.
 20737
 20738     MOVE ER-2255               TO EMI-ERROR.
 20739     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20740     GO TO 8200-SEND-DATAONLY.
 20741
 20742 4970-NOT-FOUND.
 20743
 20744******************************************************************
 20745*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20746******************************************************************
 20747
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 380
* EL6311.cbl
 20748
 20749* EXEC CICS RESETBR
 20750*         DATASET    (FILE-ID-ERPNDB4)
 20751*         RIDFLD     (ERPNDB-CSR-KEY)
 20752*    END-EXEC.
 20753     MOVE 0
 20754       TO DFHEIV11
 20755*    MOVE '&4         G          &   #00017565' TO DFHEIV0
 20756     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20757     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20758     MOVE X'2020233030303137353635' TO DFHEIV0(25:11)
 20759     CALL 'kxdfhei1' USING DFHEIV0,
 20760           FILE-ID-ERPNDB4,
 20761           ERPNDB-CSR-KEY,
 20762           DFHEIV99,
 20763           DFHEIV11,
 20764           DFHEIV99
 20765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20766
 20767
 20768
 20769* EXEC CICS READNEXT
 20770*         DATASET    (FILE-ID-ERPNDB4)
 20771*         SET        (ADDRESS OF PENDING-BUSINESS)
 20772*         RIDFLD     (ERPNDB-CSR-KEY)
 20773*    END-EXEC.
 20774     MOVE 0
 20775       TO DFHEIV11
 20776*    MOVE '&.S                   )   #00017570' TO DFHEIV0
 20777     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20778     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20779     MOVE X'2020233030303137353730' TO DFHEIV0(25:11)
 20780     CALL 'kxdfhei1' USING DFHEIV0,
 20781           FILE-ID-ERPNDB4,
 20782           DFHEIV20,
 20783           DFHEIV99,
 20784           ERPNDB-CSR-KEY,
 20785           DFHEIV99,
 20786           DFHEIV11,
 20787           DFHEIV99,
 20788           DFHEIV99
 20789     SET ADDRESS OF PENDING-BUSINESS TO
 20790         DFHEIV20
 20791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20792
 20793
 20794
 20795* EXEC CICS READPREV
 20796*         DATASET    (FILE-ID-ERPNDB4)
 20797*         SET        (ADDRESS OF PENDING-BUSINESS)
 20798*         RIDFLD     (ERPNDB-CSR-KEY)
 20799*    END-EXEC.
 20800     MOVE 0
 20801       TO DFHEIV11
 20802*    MOVE '&0S                   )   #00017576' TO DFHEIV0
 20803     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20804     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20805     MOVE X'2020233030303137353736' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 381
* EL6311.cbl
 20806     CALL 'kxdfhei1' USING DFHEIV0,
 20807           FILE-ID-ERPNDB4,
 20808           DFHEIV20,
 20809           DFHEIV99,
 20810           ERPNDB-CSR-KEY,
 20811           DFHEIV99,
 20812           DFHEIV11,
 20813           DFHEIV99,
 20814           DFHEIV99
 20815     SET ADDRESS OF PENDING-BUSINESS TO
 20816         DFHEIV20
 20817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20818
 20819
 20820 4980-READ-PREV-RECORD.
 20821
 20822* EXEC CICS READPREV
 20823*         DATASET    (FILE-ID-ERPNDB4)
 20824*         SET        (ADDRESS OF PENDING-BUSINESS)
 20825*         RIDFLD     (ERPNDB-CSR-KEY)
 20826*    END-EXEC.
 20827     MOVE 0
 20828       TO DFHEIV11
 20829*    MOVE '&0S                   )   #00017583' TO DFHEIV0
 20830     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20831     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20832     MOVE X'2020233030303137353833' TO DFHEIV0(25:11)
 20833     CALL 'kxdfhei1' USING DFHEIV0,
 20834           FILE-ID-ERPNDB4,
 20835           DFHEIV20,
 20836           DFHEIV99,
 20837           ERPNDB-CSR-KEY,
 20838           DFHEIV99,
 20839           DFHEIV11,
 20840           DFHEIV99,
 20841           DFHEIV99
 20842     SET ADDRESS OF PENDING-BUSINESS TO
 20843         DFHEIV20
 20844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20845
 20846
 20847     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20848
 20849     IF WS-BATCH-PREFIX = '#CL'
 20850        GO TO 4980-READ-PREV-RECORD.
 20851
 20852     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20853     GO TO 4905-READ-PREV-RECORD.
 20854
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 382
* EL6311.cbl
 20856
 20857
 20858******************************************************************
 20859*                                                                *
 20860*        B R O W S E   B A T C H   H E A D E R S                 *
 20861*                                                                *
 20862******************************************************************
 20863
 20864 5000-BROWSE-BATCH-HEADERS.
 20865
 20866     IF EIBTRNID NOT = TRANS-EXB1
 20867        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20868        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20869        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20870        GO TO 5010-READ-NEXT-RECORD.
 20871
 20872     IF EIBAID = DFHPF4
 20873        MOVE '0'                TO PI-EDIT-SW
 20874        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20875        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20876        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20877        GO TO 5010-READ-NEXT-RECORD.
 20878
 20879     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20880     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20881     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20882
 20883
 20884* EXEC CICS HANDLE CONDITION
 20885*         ENDFILE  (5050-NOT-FOUND)
 20886*    END-EXEC.
 20887*    MOVE '"$''                   ! R #00017625' TO DFHEIV0
 20888     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20889     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20890     MOVE X'5220233030303137363235' TO DFHEIV0(25:11)
 20891     CALL 'kxdfhei1' USING DFHEIV0
 20892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20893
 20894
 20895 5010-READ-NEXT-RECORD.
 20896
 20897* EXEC CICS HANDLE CONDITION
 20898*         NOTFND    (5050-NOT-FOUND)
 20899*    END-EXEC.
 20900*    MOVE '"$I                   ! S #00017630' TO DFHEIV0
 20901     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20902     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20903     MOVE X'5320233030303137363330' TO DFHEIV0(25:11)
 20904     CALL 'kxdfhei1' USING DFHEIV0
 20905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20906
 20907
 20908
 20909* EXEC CICS READ
 20910*         DATASET   (FILE-ID-ERPNDB)
 20911*         SET       (ADDRESS OF PENDING-BUSINESS)
 20912*         RIDFLD    (ERPNDB-KEY)
 20913*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 383
* EL6311.cbl
 20914*    END-EXEC.
 20915*    MOVE '&"S        G          (   #00017634' TO DFHEIV0
 20916     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20917     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20918     MOVE X'2020233030303137363334' TO DFHEIV0(25:11)
 20919     CALL 'kxdfhei1' USING DFHEIV0,
 20920           FILE-ID-ERPNDB,
 20921           DFHEIV20,
 20922           DFHEIV99,
 20923           ERPNDB-KEY,
 20924           DFHEIV99,
 20925           DFHEIV99,
 20926           DFHEIV99
 20927     SET ADDRESS OF PENDING-BUSINESS TO
 20928         DFHEIV20
 20929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20930
 20931
 20932     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20933         GO TO 5050-NOT-FOUND.
 20934
 20935     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20936
 20937     IF WS-BATCH-PREFIX = '#CL'
 20938         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20939         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20940         GO TO 5010-READ-NEXT-RECORD.
 20941
 20942     IF NOT PB-BATCH-TRAILER
 20943         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20944         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20945         GO TO 5010-READ-NEXT-RECORD.
 20946
 20947     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20948         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20949             NEXT SENTENCE
 20950         ELSE
 20951             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20952             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20953             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20954             GO TO 5010-READ-NEXT-RECORD.
 20955
 20956     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20957         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20958             NEXT SENTENCE
 20959        ELSE
 20960             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20961             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20962             GO TO 5010-READ-NEXT-RECORD.
 20963
 20964     IF EIBAID = DFHPF4
 20965        MOVE '0'                TO PI-EDIT-SW
 20966        GO TO 7200-DISPLAY-BATCHES.
 20967
 20968     IF PI-CSR-BROWSE
 20969        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20970           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20971           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 384
* EL6311.cbl
 20972           GO TO 5010-READ-NEXT-RECORD.
 20973
 20974     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20975       IF PI-PB-CARRIER    = SPACES AND
 20976          PI-PB-GROUPING   = SPACES AND
 20977          PI-PB-STATE      = SPACES AND
 20978          PI-PB-ACCOUNT    = SPACES
 20979            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20980            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20981            GO TO 7200-DISPLAY-BATCHES
 20982         ELSE
 20983           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20984              PI-PB-GROUPING   = PB-GROUPING AND
 20985              PI-PB-STATE      = PB-STATE    AND
 20986              PI-PB-ACCOUNT    = PB-ACCOUNT
 20987              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20988              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20989              GO TO 7200-DISPLAY-BATCHES.
 20990
 20991     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20992     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20993
 20994
 20995* EXEC CICS HANDLE CONDITION
 20996*         NOTFND    (5050-NOT-FOUND)
 20997*    END-EXEC.
 20998*    MOVE '"$I                   ! T #00017703' TO DFHEIV0
 20999     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21000     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21001     MOVE X'5420233030303137373033' TO DFHEIV0(25:11)
 21002     CALL 'kxdfhei1' USING DFHEIV0
 21003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21004
 21005
 21006
 21007* EXEC CICS READ
 21008*         DATASET   (FILE-ID-ERPNDB)
 21009*         SET       (ADDRESS OF PENDING-BUSINESS)
 21010*         RIDFLD    (ERPNDB-KEY)
 21011*         GTEQ
 21012*    END-EXEC.
 21013*    MOVE '&"S        G          (   #00017707' TO DFHEIV0
 21014     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21015     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21016     MOVE X'2020233030303137373037' TO DFHEIV0(25:11)
 21017     CALL 'kxdfhei1' USING DFHEIV0,
 21018           FILE-ID-ERPNDB,
 21019           DFHEIV20,
 21020           DFHEIV99,
 21021           ERPNDB-KEY,
 21022           DFHEIV99,
 21023           DFHEIV99,
 21024           DFHEIV99
 21025     SET ADDRESS OF PENDING-BUSINESS TO
 21026         DFHEIV20
 21027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21028
 21029
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 385
* EL6311.cbl
 21030     GO TO 5010-READ-NEXT-RECORD.
 21031
 21032 5050-NOT-FOUND.
 21033
 21034******************************************************************
 21035*                                                                *
 21036*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21037*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21038*         PROGRAM.                                               *
 21039*                                                                *
 21040******************************************************************
 21041
 21042     IF EIBTRNID NOT = TRANS-EXB1
 21043        IF PENDING-BUS-RECS-FOUND
 21044            NEXT SENTENCE
 21045          ELSE
 21046            MOVE '9'            TO PI-BROWSE-SW
 21047            GO TO 9400-CLEAR.
 21048
 21049     MOVE ER-2256                TO EMI-ERROR.
 21050     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21051
 21052     IF PI-MAP-NAME = SPACES
 21053        MOVE EL631D              TO PI-MAP-NAME
 21054        MOVE -1                  TO DPFENTRL
 21055        GO TO 8100-SEND-INITIAL-MAP.
 21056
 21057     IF PI-MAP-NAME = EL631B
 21058        MOVE -1                  TO BMAINTL
 21059     ELSE
 21060        IF PI-MAP-NAME = EL631C
 21061           MOVE -1               TO CMAINTL
 21062        ELSE
 21063           MOVE -1               TO DPFENTRL
 21064           GO TO 8200-SEND-DATAONLY.
 21065
 21066     GO TO 8100-SEND-INITIAL-MAP.
 21067
 21068     .
 21069 5100-PROCESS-POL-RESC.
 21070     MOVE ZEROS                  TO CG-LF-BENCD
 21071                                    CG-AH-BENCD
 21072                                    CG-LF-CAN-AMT
 21073                                    CG-AH-CAN-AMT
 21074     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21075                                    CG-AH-CAN-DT
 21076     MOVE SPACES                 TO CG-BATCH-NO
 21077     MOVE '4'                    TO CG-OPTION-CODE
 21078     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21079     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21080     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21081     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21082     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21083     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21084     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21085     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21086     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21087     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 386
* EL6311.cbl
 21088     MOVE PI-PREV-ALT-KEY (1:33)
 21089                                 TO CG-CERT-KEY
 21090     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21091     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21092                                    CG-AH-CAN-AMT
 21093     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21094                                    CG-AH-CAN-DT
 21095     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21096     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21097      display 'about to cancel ' cg-cert-key
 21098
 21099* EXEC CICS LINK
 21100*        PROGRAM  ('ELCANC')
 21101*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21102*    END-EXEC
 21103     MOVE LENGTH OF
 21104      CANCEL-GEN-PASS-AREA
 21105       TO DFHEIV11
 21106     MOVE 'ELCANC' TO DFHEIV1
 21107*    MOVE '."C                   (   #00017782' TO DFHEIV0
 21108     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21109     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21110     MOVE X'2020233030303137373832' TO DFHEIV0(25:11)
 21111     CALL 'kxdfhei1' USING DFHEIV0,
 21112           DFHEIV1,
 21113           CANCEL-GEN-PASS-AREA,
 21114           DFHEIV11,
 21115           DFHEIV99,
 21116           DFHEIV99,
 21117           DFHEIV99,
 21118           DFHEIV99
 21119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21120     IF CG-SUCCESS
 21121        CONTINUE
 21122     ELSE
 21123        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21124        MOVE '3'                 TO EMI-SWITCH1
 21125        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21126        EVALUATE TRUE
 21127           WHEN CG-DATE-ERROR
 21128             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21129           WHEN CG-CERT-NOT-FOUND
 21130             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21131           WHEN CG-AMOUNT-ERROR
 21132             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21133           WHEN CG-OPTION-ERROR
 21134             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21135           WHEN CG-PREV-CAN
 21136             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21137           WHEN CG-INVALID-DATA
 21138             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21139           WHEN CG-NO-ACCT-MSTR
 21140             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21141           WHEN CG-SFX-A-EXIST
 21142             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21143           WHEN CG-MISC-ERROR
 21144             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21145           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 387
* EL6311.cbl
 21146             MOVE ' ERROR - ELCANC - RETURN '
 21147                                 TO EMI-ERROR-TEXT (1) (12:25)
 21148        END-EVALUATE
 21149        GO TO 8200-SEND-DATAONLY
 21150     END-IF
 21151     .
 21152 5100-EXIT.
 21153     EXIT.
 21154
 21155******************************************************************
 21156*                                                                *
 21157*        B R O W S E   B A T C H   B A C K W A R D S             *
 21158*                                                                *
 21159******************************************************************
 21160
 21161 5500-BROWSE-BATCH-BACKWARD.
 21162
 21163* EXEC CICS HANDLE CONDITION
 21164*         NOTFND   (5550-END-RECORDS)
 21165*         ENDFILE  (5550-END-RECORDS)
 21166*    END-EXEC.
 21167*    MOVE '"$I''                  ! U #00017828' TO DFHEIV0
 21168     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21169     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21170     MOVE X'5520233030303137383238' TO DFHEIV0(25:11)
 21171     CALL 'kxdfhei1' USING DFHEIV0
 21172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21173
 21174
 21175 5505-START-BROWSE.
 21176     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21177     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21178     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21179
 21180
 21181* EXEC CICS STARTBR
 21182*         DATASET   (FILE-ID-ERPNDB)
 21183*         RIDFLD    (ERPNDB-ALT-KEY)
 21184*    END-EXEC.
 21185     MOVE 0
 21186       TO DFHEIV11
 21187*    MOVE '&,         G          &   #00017838' TO DFHEIV0
 21188     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21189     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21190     MOVE X'2020233030303137383338' TO DFHEIV0(25:11)
 21191     CALL 'kxdfhei1' USING DFHEIV0,
 21192           FILE-ID-ERPNDB,
 21193           ERPNDB-ALT-KEY,
 21194           DFHEIV99,
 21195           DFHEIV11,
 21196           DFHEIV99
 21197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21198
 21199
 21200     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21201
 21202
 21203* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 388
* EL6311.cbl
 21204*         DATASET    (FILE-ID-ERPNDB)
 21205*         SET        (ADDRESS OF PENDING-BUSINESS)
 21206*         RIDFLD     (ERPNDB-KEY)
 21207*    END-EXEC.
 21208     MOVE 0
 21209       TO DFHEIV11
 21210*    MOVE '&.S                   )   #00017845' TO DFHEIV0
 21211     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21212     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21213     MOVE X'2020233030303137383435' TO DFHEIV0(25:11)
 21214     CALL 'kxdfhei1' USING DFHEIV0,
 21215           FILE-ID-ERPNDB,
 21216           DFHEIV20,
 21217           DFHEIV99,
 21218           ERPNDB-KEY,
 21219           DFHEIV99,
 21220           DFHEIV11,
 21221           DFHEIV99,
 21222           DFHEIV99
 21223     SET ADDRESS OF PENDING-BUSINESS TO
 21224         DFHEIV20
 21225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21226
 21227
 21228
 21229* EXEC CICS READPREV
 21230*         DATASET    (FILE-ID-ERPNDB)
 21231*         SET        (ADDRESS OF PENDING-BUSINESS)
 21232*         RIDFLD     (ERPNDB-KEY)
 21233*    END-EXEC.
 21234     MOVE 0
 21235       TO DFHEIV11
 21236*    MOVE '&0S                   )   #00017851' TO DFHEIV0
 21237     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21238     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21239     MOVE X'2020233030303137383531' TO DFHEIV0(25:11)
 21240     CALL 'kxdfhei1' USING DFHEIV0,
 21241           FILE-ID-ERPNDB,
 21242           DFHEIV20,
 21243           DFHEIV99,
 21244           ERPNDB-KEY,
 21245           DFHEIV99,
 21246           DFHEIV11,
 21247           DFHEIV99,
 21248           DFHEIV99
 21249     SET ADDRESS OF PENDING-BUSINESS TO
 21250         DFHEIV20
 21251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21252
 21253
 21254
 21255* EXEC CICS READPREV
 21256*         DATASET    (FILE-ID-ERPNDB)
 21257*         SET        (ADDRESS OF PENDING-BUSINESS)
 21258*         RIDFLD     (ERPNDB-KEY)
 21259*    END-EXEC.
 21260     MOVE 0
 21261       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 389
* EL6311.cbl
 21262*    MOVE '&0S                   )   #00017857' TO DFHEIV0
 21263     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21264     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21265     MOVE X'2020233030303137383537' TO DFHEIV0(25:11)
 21266     CALL 'kxdfhei1' USING DFHEIV0,
 21267           FILE-ID-ERPNDB,
 21268           DFHEIV20,
 21269           DFHEIV99,
 21270           ERPNDB-KEY,
 21271           DFHEIV99,
 21272           DFHEIV11,
 21273           DFHEIV99,
 21274           DFHEIV99
 21275     SET ADDRESS OF PENDING-BUSINESS TO
 21276         DFHEIV20
 21277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21278
 21279
 21280     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21281        GO TO 5550-END-RECORDS.
 21282
 21283     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21284
 21285     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21286
 21287     IF  WS-BATCH-PREFIX = '#CL'
 21288             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21289
 21290* EXEC CICS ENDBR
 21291*                 DATASET  (FILE-ID-ERPNDB)
 21292*            END-EXEC
 21293     MOVE 0
 21294       TO DFHEIV11
 21295*    MOVE '&2                    $   #00017872' TO DFHEIV0
 21296     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21297     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21298     MOVE X'2020233030303137383732' TO DFHEIV0(25:11)
 21299     CALL 'kxdfhei1' USING DFHEIV0,
 21300           FILE-ID-ERPNDB,
 21301           DFHEIV11,
 21302           DFHEIV99
 21303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21304         GO TO 5505-START-BROWSE.
 21305
 21306     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21307         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21308             NEXT SENTENCE
 21309         ELSE
 21310             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21311
 21312* EXEC CICS ENDBR
 21313*                 DATASET  (FILE-ID-ERPNDB)
 21314*            END-EXEC
 21315     MOVE 0
 21316       TO DFHEIV11
 21317*    MOVE '&2                    $   #00017882' TO DFHEIV0
 21318     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21319     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 390
* EL6311.cbl
 21320     MOVE X'2020233030303137383832' TO DFHEIV0(25:11)
 21321     CALL 'kxdfhei1' USING DFHEIV0,
 21322           FILE-ID-ERPNDB,
 21323           DFHEIV11,
 21324           DFHEIV99
 21325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21326             GO TO 5505-START-BROWSE.
 21327
 21328
 21329     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21330         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21331             NEXT SENTENCE
 21332        ELSE
 21333             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21334
 21335* EXEC CICS ENDBR
 21336*                 DATASET  (FILE-ID-ERPNDB)
 21337*            END-EXEC
 21338     MOVE 0
 21339       TO DFHEIV11
 21340*    MOVE '&2                    $   #00017893' TO DFHEIV0
 21341     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21342     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21343     MOVE X'2020233030303137383933' TO DFHEIV0(25:11)
 21344     CALL 'kxdfhei1' USING DFHEIV0,
 21345           FILE-ID-ERPNDB,
 21346           DFHEIV11,
 21347           DFHEIV99
 21348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21349             GO TO 5505-START-BROWSE.
 21350
 21351     IF NOT PB-BATCH-TRAILER
 21352        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21353
 21354* EXEC CICS ENDBR
 21355*            DATASET  (FILE-ID-ERPNDB)
 21356*       END-EXEC
 21357     MOVE 0
 21358       TO DFHEIV11
 21359*    MOVE '&2                    $   #00017900' TO DFHEIV0
 21360     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21361     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21362     MOVE X'2020233030303137393030' TO DFHEIV0(25:11)
 21363     CALL 'kxdfhei1' USING DFHEIV0,
 21364           FILE-ID-ERPNDB,
 21365           DFHEIV11,
 21366           DFHEIV99
 21367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21368        GO TO 5505-START-BROWSE.
 21369
 21370     IF PI-CSR-BROWSE
 21371        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21372           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21373
 21374* EXEC CICS ENDBR
 21375*               DATASET  (FILE-ID-ERPNDB)
 21376*          END-EXEC
 21377     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 391
* EL6311.cbl
 21378       TO DFHEIV11
 21379*    MOVE '&2                    $   #00017908' TO DFHEIV0
 21380     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21381     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21382     MOVE X'2020233030303137393038' TO DFHEIV0(25:11)
 21383     CALL 'kxdfhei1' USING DFHEIV0,
 21384           FILE-ID-ERPNDB,
 21385           DFHEIV11,
 21386           DFHEIV99
 21387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21388           GO TO 5505-START-BROWSE.
 21389
 21390     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21391        IF PI-PB-CARRIER    = SPACES AND
 21392           PI-PB-GROUPING   = SPACES AND
 21393           PI-PB-STATE      = SPACES AND
 21394           PI-PB-ACCOUNT    = SPACES
 21395             GO TO 7200-DISPLAY-BATCHES
 21396          ELSE
 21397            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21398               PI-PB-GROUPING   = PB-GROUPING AND
 21399               PI-PB-STATE      = PB-STATE    AND
 21400               PI-PB-ACCOUNT    = PB-ACCOUNT
 21401                 GO TO 7200-DISPLAY-BATCHES.
 21402
 21403     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21404
 21405
 21406* EXEC CICS ENDBR
 21407*         DATASET  (FILE-ID-ERPNDB)
 21408*    END-EXEC.
 21409     MOVE 0
 21410       TO DFHEIV11
 21411*    MOVE '&2                    $   #00017928' TO DFHEIV0
 21412     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21413     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21414     MOVE X'2020233030303137393238' TO DFHEIV0(25:11)
 21415     CALL 'kxdfhei1' USING DFHEIV0,
 21416           FILE-ID-ERPNDB,
 21417           DFHEIV11,
 21418           DFHEIV99
 21419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21420
 21421
 21422     GO TO 5505-START-BROWSE.
 21423
 21424 5550-END-RECORDS.
 21425     MOVE ER-2257                TO EMI-ERROR.
 21426     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21427     MOVE -1                     TO DPFENTRL.
 21428
 21429     GO TO 8200-SEND-DATAONLY.
 21430
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 392
* EL6311.cbl
 21432
 21433******************************************************************
 21434*                                                                *
 21435*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21436*                                                                *
 21437******************************************************************
 21438
 21439 6000-CREATE-TEMP-STORAGE.
 21440
 21441
 21442* EXEC CICS HANDLE CONDITION
 21443*        QIDERR  (6050-QID-ERROR)
 21444*    END-EXEC.
 21445*    MOVE '"$N                   ! V #00017951' TO DFHEIV0
 21446     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21447     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21448     MOVE X'5620233030303137393531' TO DFHEIV0(25:11)
 21449     CALL 'kxdfhei1' USING DFHEIV0
 21450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21451
 21452
 21453
 21454* EXEC CICS WRITEQ TS
 21455*        QUEUE    (QID)
 21456*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21457*        LENGTH   (WS-COMM-LENGTH)
 21458*        ITEM     (W-ONE)
 21459*    END-EXEC.
 21460*    MOVE '*" I                  ''   #00017955' TO DFHEIV0
 21461     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 21462     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21463     MOVE X'2020233030303137393535' TO DFHEIV0(25:11)
 21464     CALL 'kxdfhei1' USING DFHEIV0,
 21465           QID,
 21466           PROGRAM-INTERFACE-BLOCK,
 21467           WS-COMM-LENGTH,
 21468           W-ONE,
 21469           DFHEIV99,
 21470           DFHEIV99
 21471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21472
 21473
 21474 6000-EXIT.
 21475      EXIT.
 21476
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 393
* EL6311.cbl
 21478
 21479******************************************************************
 21480*                                                                *
 21481*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21482*                                                                *
 21483******************************************************************
 21484
 21485 6050-RECOVER-TEMP-STORAGE.
 21486     IF PGM-NAME = XCTL-EL6312
 21487        GO TO 6050-EXIT.
 21488
 21489     IF PGM-NAME = XCTL-EL6313
 21490        GO TO 6050-EXIT.
 21491
 21492     IF PGM-NAME = XCTL-EL6315
 21493         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21494     END-IF
 21495
 21496     IF PGM-NAME = XCTL-EL6316
 21497         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21498     END-IF
 21499
 21500
 21501* EXEC CICS HANDLE CONDITION
 21502*        QIDERR  (6050-QID-ERROR)
 21503*    END-EXEC.
 21504*    MOVE '"$N                   ! W #00017988' TO DFHEIV0
 21505     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21506     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21507     MOVE X'5720233030303137393838' TO DFHEIV0(25:11)
 21508     CALL 'kxdfhei1' USING DFHEIV0
 21509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21510
 21511
 21512
 21513* EXEC CICS READQ TS
 21514*         QUEUE   (QID)
 21515*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21516*         LENGTH  (WS-COMM-LENGTH)
 21517*         ITEM    (W-ONE)
 21518*     END-EXEC.
 21519*    MOVE '*$II   L              ''   #00017992' TO DFHEIV0
 21520     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21521     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21522     MOVE X'2020233030303137393932' TO DFHEIV0(25:11)
 21523     CALL 'kxdfhei1' USING DFHEIV0,
 21524           QID,
 21525           PROGRAM-INTERFACE-BLOCK,
 21526           WS-COMM-LENGTH,
 21527           W-ONE,
 21528           DFHEIV99,
 21529           DFHEIV99
 21530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21531
 21532
 21533 6050-DELETE-TEMP-STORAGE.
 21534
 21535
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 394
* EL6311.cbl
 21536* EXEC CICS DELETEQ TS
 21537*        QUEUE   (QID)
 21538*    END-EXEC.
 21539*    MOVE '*&                    #   #00018001' TO DFHEIV0
 21540     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21541     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21542     MOVE X'2020233030303138303031' TO DFHEIV0(25:11)
 21543     CALL 'kxdfhei1' USING DFHEIV0,
 21544           QID,
 21545           DFHEIV99
 21546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21547
 21548
 21549     GO TO 6050-EXIT.
 21550
 21551 6050-QID-ERROR.
 21552     MOVE ER-0033                TO EMI-ERROR
 21553     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21554
 21555 6050-EXIT.
 21556      EXIT.
 21557
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 395
* EL6311.cbl
 21559
 21560******************************************************************
 21561*                                                                *
 21562*            T E R M   C O N V E R S I O N                       *
 21563*                                                                *
 21564******************************************************************
 21565
 21566 6100-TERM-CONVERSION.
 21567
 21568     IF PI-BPMTS = ZERO
 21569         GO TO 6199-EXIT.
 21570
 21571     IF PI-BMODE = ' ' OR 'M'
 21572         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21573         GO TO 6105-ROUND-TERM.
 21574
 21575     IF PI-BMODE = 'S'
 21576         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21577         GO TO 6105-ROUND-TERM.
 21578
 21579     IF PI-BMODE = 'W'
 21580         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21581         GO TO 6105-ROUND-TERM.
 21582
 21583     IF PI-BMODE = 'B'
 21584         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21585         GO TO 6105-ROUND-TERM.
 21586
 21587     IF PI-BMODE = 'T'
 21588         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21589
 21590 6105-ROUND-TERM.
 21591
 21592     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21593         ADD +1                  TO WS-CALC-TERM-WHOLE
 21594         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21595
 21596     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21597         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21598
 21599     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21600         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21601                                      WS-BTERM    (WS-SUB1)
 21602         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21603
 21604     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21605         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21606             MOVE -1               TO BMODEL
 21607             MOVE ER-2593          TO EMI-ERROR
 21608             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21609             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21610
 21611 6124-CHECK-BENEFIT.
 21612
 21613     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21614        GO TO 6126-COMPUTE-BENEFIT.
 21615
 21616     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 396
* EL6311.cbl
 21617
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 397
* EL6311.cbl
 21619******************************************************************
 21620**         COMPUTE TERM AND BENEFIT
 21621******************************************************************
 21622 6125-COMPUTE-TERM-BENEFIT.
 21623
 21624     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21625        PI-BPMTAMT = ZERO
 21626         GO TO 6199-EXIT.
 21627
 21628     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21629                                     WS-BTERM  (WS-SUB1).
 21630     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21631
 21632 6126-COMPUTE-BENEFIT.
 21633
 21634     IF PI-BMODE = 'M' OR  ' '
 21635         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21636
 21637     IF PI-BMODE = 'W'
 21638         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21639
 21640     IF PI-BMODE = 'S'
 21641         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21642
 21643     IF PI-BMODE = 'B'
 21644         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21645
 21646     IF PI-BMODE = 'T'
 21647         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21648
 21649     IF WS-SUB1 = +1
 21650        COMPUTE WS-BBEN (WS-SUB1) =
 21651                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21652
 21653     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21654     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21655     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21656
 21657 6199-EXIT.
 21658     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 398
* EL6311.cbl
 21660
 21661******************************************************************
 21662*                                                                *
 21663*             D I S P L A Y   I S S U E S                        *
 21664*                                                                *
 21665******************************************************************
 21666
 21667 6200-CREATE-VADS.
 21668     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21669     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21670     MOVE SPACES                 TO WS-PASS-VADS-REC
 21671
 21672* EXEC CICS GETMAIN
 21673*       SET      (ADDRESS OF PENDING-BUSINESS)
 21674*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21675*       INITIMG  (GETMAIN-SPACE)
 21676*       RESP     (WS-RESPONSE)
 21677*    END-EXEC
 21678*    MOVE ',"IL                  $  N#00018127' TO DFHEIV0
 21679     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21680     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21681     MOVE X'204E233030303138313237' TO DFHEIV0(25:11)
 21682     CALL 'kxdfhei1' USING DFHEIV0,
 21683           DFHEIV20,
 21684           ERPNDB-RECORD-LENGTH,
 21685           GETMAIN-SPACE
 21686     SET ADDRESS OF PENDING-BUSINESS TO
 21687         DFHEIV20
 21688     MOVE EIBRESP  TO WS-RESPONSE
 21689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21690
 21691* EXEC CICS READ
 21692*       INTO    (PENDING-BUSINESS)
 21693*       DATASET (FILE-ID-ERPNDB)
 21694*       RIDFLD  (ERPNDB-KEY)
 21695*       RESP    (WS-RESPONSE)
 21696*    END-EXEC
 21697     MOVE LENGTH OF
 21698      PENDING-BUSINESS
 21699       TO DFHEIV11
 21700*    MOVE '&"IL       E          (  N#00018133' TO DFHEIV0
 21701     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21702     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21703     MOVE X'204E233030303138313333' TO DFHEIV0(25:11)
 21704     CALL 'kxdfhei1' USING DFHEIV0,
 21705           FILE-ID-ERPNDB,
 21706           PENDING-BUSINESS,
 21707           DFHEIV11,
 21708           ERPNDB-KEY,
 21709           DFHEIV99,
 21710           DFHEIV99,
 21711           DFHEIV99
 21712     MOVE EIBRESP  TO WS-RESPONSE
 21713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21714     IF RESP-NORMAL
 21715        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21716        IF (RESP-NORMAL)
 21717           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 399
* EL6311.cbl
 21718              AM-CONTROL-PRIMARY (1:20))
 21719           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21720        ELSE
 21721           MOVE 'ACCOUNT NOT FOUND'
 21722                                 TO VD-ACCOUNT-NAME
 21723        END-IF
 21724        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21725                                    TO M1
 21726        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21727        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21728           (A2 > M1)
 21729           OR (WS-WORK-FIELD (A2:1) = '*')
 21730           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21731           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21732        END-PERFORM
 21733        IF A2 > M1
 21734           CONTINUE
 21735        ELSE
 21736           MOVE WS-WORK-FIELD (1:A2 - 1)
 21737                                    TO VD-ACCOUNT-NAME
 21738        END-IF
 21739        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21740        MOVE PB-CARRIER          TO VD-CARRIER
 21741        MOVE PB-GROUPING         TO VD-GROUPING
 21742        MOVE PB-STATE            TO VD-STATE
 21743        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21744        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21745        MOVE PB-CERT-NO          TO VD-CERT-NO
 21746        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21747        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21748        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21749        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21750        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21751        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21752        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21753        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21754        MOVE PB-CSR-ID           TO VD-CSR-ID
 21755        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21756        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21757        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21758        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21759        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21760        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21761        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21762        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21763        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21764        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21765        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21766        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21767        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21768     END-IF
 21769     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21770
 21771
 21772* EXEC CICS GETMAIN
 21773*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21774*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21775*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 400
* EL6311.cbl
 21776*       RESP     (WS-RESPONSE)
 21777*    END-EXEC
 21778*    MOVE ',"IL                  $  N#00018196' TO DFHEIV0
 21779     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21780     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21781     MOVE X'204E233030303138313936' TO DFHEIV0(25:11)
 21782     CALL 'kxdfhei1' USING DFHEIV0,
 21783           DFHEIV20,
 21784           ERPNDM-RECORD-LENGTH,
 21785           GETMAIN-SPACE
 21786     SET ADDRESS OF PENDING-MAILING-DATA TO
 21787         DFHEIV20
 21788     MOVE EIBRESP  TO WS-RESPONSE
 21789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21790
 21791
 21792* EXEC CICS READ
 21793*       INTO    (PENDING-MAILING-DATA)
 21794*       DATASET (FILE-ID-ERPNDM)
 21795*       RIDFLD  (ERPNDM-KEY)
 21796*       RESP    (WS-RESPONSE)
 21797*    END-EXEC
 21798     MOVE LENGTH OF
 21799      PENDING-MAILING-DATA
 21800       TO DFHEIV11
 21801*    MOVE '&"IL       E          (  N#00018203' TO DFHEIV0
 21802     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21803     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21804     MOVE X'204E233030303138323033' TO DFHEIV0(25:11)
 21805     CALL 'kxdfhei1' USING DFHEIV0,
 21806           FILE-ID-ERPNDM,
 21807           PENDING-MAILING-DATA,
 21808           DFHEIV11,
 21809           ERPNDM-KEY,
 21810           DFHEIV99,
 21811           DFHEIV99,
 21812           DFHEIV99
 21813     MOVE EIBRESP  TO WS-RESPONSE
 21814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21815
 21816     IF RESP-NORMAL
 21817        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21818        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21819        MOVE PM-CITY              TO VD-INSURED-CITY
 21820        MOVE PM-STATE             TO VD-INSURED-STATE
 21821        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21822     END-IF
 21823
 21824     MOVE 'VAC1'                  TO VD-LETTER-ID
 21825     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21826     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21827     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21828     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21829     MOVE +0                      TO VD-ARCHIVE-NO
 21830     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21831     .
 21832 6200-EXIT.
 21833     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 401
* EL6311.cbl
 21834 6210-READ-ERACCT.
 21835     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21836     MOVE LOW-VALUES             TO ERACCT-FILL
 21837
 21838* EXEC CICS READ
 21839*         DATASET   ('ERACCT')
 21840*         INTO      (ACCOUNT-MASTER)
 21841*         RIDFLD    (ERACCT-KEY)
 21842*         GTEQ
 21843*         RESP      (WS-RESPONSE)
 21844*    END-EXEC
 21845     MOVE LENGTH OF
 21846      ACCOUNT-MASTER
 21847       TO DFHEIV11
 21848     MOVE 'ERACCT' TO DFHEIV1
 21849*    MOVE '&"IL       G          (  N#00018231' TO DFHEIV0
 21850     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21851     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21852     MOVE X'204E233030303138323331' TO DFHEIV0(25:11)
 21853     CALL 'kxdfhei1' USING DFHEIV0,
 21854           DFHEIV1,
 21855           ACCOUNT-MASTER,
 21856           DFHEIV11,
 21857           ERACCT-KEY,
 21858           DFHEIV99,
 21859           DFHEIV99,
 21860           DFHEIV99
 21861     MOVE EIBRESP  TO WS-RESPONSE
 21862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21863     .
 21864 6210-EXIT.
 21865     EXIT.
 21866
 21867 6220-READ-ERMAIL.
 21868
 21869     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21870     MOVE ' '                    TO WS-ERMAIL-SW
 21871
 21872
 21873* EXEC CICS READ
 21874*       DATASET   (FILE-ID-ERMAIL)
 21875*       SET       (ADDRESS OF MAILING-DATA)
 21876*       RIDFLD    (ERMAIL-KEY)
 21877*       RESP      (WS-RESPONSE)
 21878*    END-EXEC
 21879*    MOVE '&"S        E          (  N#00018247' TO DFHEIV0
 21880     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21881     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21882     MOVE X'204E233030303138323437' TO DFHEIV0(25:11)
 21883     CALL 'kxdfhei1' USING DFHEIV0,
 21884           FILE-ID-ERMAIL,
 21885           DFHEIV20,
 21886           DFHEIV99,
 21887           ERMAIL-KEY,
 21888           DFHEIV99,
 21889           DFHEIV99,
 21890           DFHEIV99
 21891     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 402
* EL6311.cbl
 21892         DFHEIV20
 21893     MOVE EIBRESP  TO WS-RESPONSE
 21894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21895
 21896     IF RESP-NORMAL
 21897        SET ERMAIL-FOUND TO TRUE
 21898     END-IF
 21899     .
 21900 6220-EXIT.
 21901     EXIT.
 21902
 21903 6400-CHECK-FOR-RES-REF-CLAIM.
 21904     display 'made it to 6400- for ' pi-cert-no
 21905     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21906
 21907     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21908                                    W-CL-COMP-CD.
 21909     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21910                                    W-CL-CERT-NO.
 21911     MOVE SPACES                 TO MSTR-CERT-SFX.
 21912
 21913
 21914* EXEC CICS HANDLE CONDITION
 21915*        NOTFND  (6400-CONTINUE)
 21916*        ENDFILE (6400-CONTINUE)
 21917*    END-EXEC.
 21918*    MOVE '"$I''                  ! X #00018271' TO DFHEIV0
 21919     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21920     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21921     MOVE X'5820233030303138323731' TO DFHEIV0(25:11)
 21922     CALL 'kxdfhei1' USING DFHEIV0
 21923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21924
 21925
 21926
 21927* EXEC CICS IGNORE CONDITION
 21928*        DUPKEY
 21929*    END-EXEC.
 21930*    MOVE '"*$                   !   #00018276' TO DFHEIV0
 21931     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21932     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21933     MOVE X'2020233030303138323736' TO DFHEIV0(25:11)
 21934     CALL 'kxdfhei1' USING DFHEIV0
 21935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21936
 21937
 21938
 21939* EXEC CICS STARTBR
 21940*        DATASET   (CLMS-ID)
 21941*        RIDFLD    (ELMSTR-KEY)
 21942*        GENERIC   EQUAL
 21943*        KEYLENGTH (ELMSTR-LENGTH)
 21944*    END-EXEC.
 21945     MOVE 0
 21946       TO DFHEIV11
 21947*    MOVE '&,   KG    E          &   #00018280' TO DFHEIV0
 21948     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21949     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 403
* EL6311.cbl
 21950     MOVE X'2020233030303138323830' TO DFHEIV0(25:11)
 21951     CALL 'kxdfhei1' USING DFHEIV0,
 21952           CLMS-ID,
 21953           ELMSTR-KEY,
 21954           ELMSTR-LENGTH,
 21955           DFHEIV11,
 21956           DFHEIV99
 21957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21958
 21959
 21960     display 'browse started'
 21961     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21962
 21963 6400-NEXT-CLAIM.
 21964
 21965
 21966* EXEC CICS READNEXT
 21967*        DATASET   (CLMS-ID)
 21968*        RIDFLD    (ELMSTR-KEY)
 21969*        SET       (ADDRESS OF CLAIM-MASTER)
 21970*    END-EXEC.
 21971     MOVE 0
 21972       TO DFHEIV11
 21973*    MOVE '&.S                   )   #00018292' TO DFHEIV0
 21974     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21975     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21976     MOVE X'2020233030303138323932' TO DFHEIV0(25:11)
 21977     CALL 'kxdfhei1' USING DFHEIV0,
 21978           CLMS-ID,
 21979           DFHEIV20,
 21980           DFHEIV99,
 21981           ELMSTR-KEY,
 21982           DFHEIV99,
 21983           DFHEIV11,
 21984           DFHEIV99,
 21985           DFHEIV99
 21986     SET ADDRESS OF CLAIM-MASTER TO
 21987         DFHEIV20
 21988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21989
 21990
 21991     display 'read claim for ' mstr-cert-no
 21992     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21993        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21994         GO TO 6400-CONTINUE
 21995     END-IF.
 21996
 21997     IF PI-CARRIER     NOT = CL-CARRIER        OR
 21998        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 21999        PI-STATE       NOT = CL-CERT-STATE     OR
 22000        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22001        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22002         GO TO 6400-NEXT-CLAIM
 22003     END-IF.
 22004
 22005     display 'found claim ' cl-claim-no
 22006        ' with denial type ' cl-denial-type
 22007     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 404
* EL6311.cbl
 22008         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22009         GO TO 6400-CONTINUE
 22010     END-IF.
 22011
 22012     GO TO 6400-NEXT-CLAIM.
 22013
 22014 6400-CONTINUE.
 22015
 22016     IF WS-BROWSE-STARTED-SW = 'Y'
 22017
 22018* EXEC CICS ENDBR
 22019*            DATASET   (CLMS-ID)
 22020*        END-EXEC
 22021     MOVE 0
 22022       TO DFHEIV11
 22023*    MOVE '&2                    $   #00018324' TO DFHEIV0
 22024     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22025     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22026     MOVE X'2020233030303138333234' TO DFHEIV0(25:11)
 22027     CALL 'kxdfhei1' USING DFHEIV0,
 22028           CLMS-ID,
 22029           DFHEIV11,
 22030           DFHEIV99
 22031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22032         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22033     END-IF.
 22034
 22035 6400-EXIT.
 22036     EXIT.
 22037
 22038 7000-DISPLAY-ISSUES.
 22039
 22040     IF PI-DISPLAY-ORIGINAL-BATCH
 22041        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22042        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22043     ELSE
 22044        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22045
 22046     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22047
 22048     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22049     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22050
 22051     MOVE LOW-VALUES                 TO EL631BI.
 22052     MOVE ZEROS                      TO PI-BPMTAMT
 22053                                        PI-BPMTS.
 22054     MOVE SPACE                      TO PI-BMODE
 22055                                        PI-BTYPE (1)
 22056                                        PI-BTYPE (2).
 22057     MOVE EL631B                     TO PI-MAP-NAME.
 22058     MOVE 'Y'                        TO PI-BROWSE-SW.
 22059     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22060                                        PI-HIGH-SEQ-NO.
 22061
 22062     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22063        MOVE AL-SABOF                TO BCHGTA
 22064        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22065        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 405
* EL6311.cbl
 22066     ELSE
 22067        MOVE AL-SADOF                TO BCHGTA
 22068                                        BCHGA
 22069        MOVE PB-CHG-COUNT            TO BCHGO.
 22070
 22071     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22072     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22073     MOVE WS-HR-MINS                 TO BMANTATO.
 22074
 22075     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22076        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22077        MOVE SPACE                   TO DC-OPTION-CODE
 22078        PERFORM 9700-DATE-LINK
 22079        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22080        MOVE 'INACTIVE'              TO BMOENDTO
 22081     ELSE
 22082        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22083        MOVE SPACE                   TO DC-OPTION-CODE
 22084        PERFORM 9700-DATE-LINK
 22085        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22086        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22087        MOVE SPACE                   TO DC-OPTION-CODE
 22088        PERFORM 9700-DATE-LINK
 22089        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22090
 22091*    MOVE PB-I-REFERENCE             TO BREFO.
 22092
 22093*    IF PI-COMPANY-ID EQUAL 'HER'
 22094*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22095*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22096*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22097*                MOVE WS-MEMBER-NO-1-8
 22098*                                TO  BMICRNOO.
 22099
 22100*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22101*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22102*            MOVE PB-I-MICROFILM-NO
 22103*                                TO  BMICRNOO.
 22104     IF PB-I-VIN NOT = SPACES
 22105        MOVE PB-I-VIN            TO BVINO
 22106     END-IF
 22107
 22108     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22109     MOVE PB-CERT-SFX                TO BSUFIXO.
 22110     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22111     MOVE SPACE                      TO DC-OPTION-CODE.
 22112     PERFORM 9700-DATE-LINK.
 22113     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22114
 22115     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22116     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22117     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22118     MOVE PB-I-INSURED-SEX           TO BSEXO
 22119
 22120     IF PB-I-AGE NOT = ZEROS
 22121         MOVE PB-I-AGE               TO BAGEO.
 22122
 22123     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 406
* EL6311.cbl
 22124                                 TO ELCERT-KEY
 22125     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22126     IF NOT CERT-TRL-REC-NOT-FOUND
 22127         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22128             MOVE 'AGE*'             TO BAGEDEFO
 22129         ELSE
 22130             MOVE 'AGE '             TO BAGEDEFO
 22131         END-IF
 22132     ELSE
 22133         MOVE 'AGE '             TO BAGEDEFO
 22134     END-IF
 22135
 22136     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22137         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22138         MOVE SPACE                  TO DC-OPTION-CODE
 22139         PERFORM 9700-DATE-LINK
 22140         IF NO-CONVERSION-ERROR
 22141            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22142
 22143     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22144         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22145         MOVE SPACE                  TO DC-OPTION-CODE
 22146         PERFORM 9700-DATE-LINK
 22147         IF NO-CONVERSION-ERROR
 22148            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22149
 22150     IF PB-I-EXTENTION-DAYS NUMERIC
 22151        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22152           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22153        ELSE
 22154           IF PB-I-TERM-IN-DAYS NUMERIC
 22155              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22156                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22157
 22158     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22159        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22160
 22161     MOVE PB-FORCE-CODE              TO BFORCEO.
 22162     MOVE PB-I-TERM-TYPE             TO BMODEO
 22163                                        PI-BMODE.
 22164
 22165     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22166        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22167
 22168     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22169         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22170                                        PI-BPMTS.
 22171
 22172     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22173         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22174           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22175                                        PI-BPMTAMT.
 22176
 22177     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22178     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22179     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22180     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22181     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 407
* EL6311.cbl
 22182     MOVE PB-I-SIG-SW                TO BSIGO.
 22183     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22184     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22185     MOVE PB-RECORD-BILL             TO BBILCDO.
 22186     MOVE PB-FORCE-CODE              TO BFORCEO.
 22187
 22188     IF (PB-I-LIVES NUMERIC)
 22189        AND (PB-I-LIVES > ZEROS)
 22190        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22191        IF (RESP-NORMAL)
 22192           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22193           CONTINUE
 22194        ELSE
 22195           MOVE PB-I-LIVES       TO BLIVESO
 22196        END-IF
 22197     END-IF
 22198
 22199     IF PB-I-NUM-BILLED NUMERIC AND
 22200        PB-I-NUM-BILLED GREATER THAN ZEROS
 22201        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22202*    ELSE
 22203*       MOVE ZEROS                   TO BBILLEDO.
 22204
 22205     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22206
 22207     IF PB-I-LOAN-APR NOT = +99.9999
 22208        MOVE PB-I-LOAN-APR           TO BAPRO.
 22209
 22210     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22211        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22212
 22213     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22214        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22215           MOVE AL-SANOF                TO BORIGHDA
 22216           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22217           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22218
 22219     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22220
 22221     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22222        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22223
 22224     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22225        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22226                                        PI-BTYPE (1).
 22227
 22228     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22229        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22230
 22231     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22232        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22233
 22234     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22235        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22236
 22237     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22238        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22239
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 408
* EL6311.cbl
 22240     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22241        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22242
 22243     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22244         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22245         MOVE SPACE                  TO DC-OPTION-CODE
 22246         PERFORM 9700-DATE-LINK
 22247         IF NO-CONVERSION-ERROR
 22248            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22249
 22250     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22251        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22252        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22253        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22254        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22255                 GIVING BDIFFO (1)
 22256     ELSE
 22257        MOVE SPACES                  TO BBEN-CD     (1)
 22258                                        BBEN-ABBR   (1).
 22259
 22260     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22261        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22262        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22263                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22264
 22265     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22266       IF PB-RECORD-ON-HOLD
 22267          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22268
 22269     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22270       IF PB-RECORD-RETURNED
 22271          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22272
 22273     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22274        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22275             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22276
 22277     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22278
 22279     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22280        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22281
 22282     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22283        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22284                                        PI-BTYPE (2).
 22285
 22286     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22287        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22288
 22289     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22290        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22291
 22292     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22293        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22294
 22295     IF PB-I-TOT-FEES NOT NUMERIC
 22296        MOVE ZEROS               TO PB-I-TOT-FEES
 22297     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 409
* EL6311.cbl
 22298     IF PB-I-TOT-FEES > ZEROS
 22299        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22300
 22301     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22302         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22303         MOVE SPACE                  TO DC-OPTION-CODE
 22304         PERFORM 9700-DATE-LINK
 22305         IF NO-CONVERSION-ERROR
 22306            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22307
 22308     IF PB-I-TOT-FEES > ZEROS
 22309        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22310        SUBTRACT PB-I-TOT-FEES FROM
 22311                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22312
 22313     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22314        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22315        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22316        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22317        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22318                 GIVING BDIFFO (2)
 22319     ELSE
 22320        MOVE SPACES                  TO BBEN-CD     (2)
 22321                                        BBEN-ABBR   (2).
 22322
 22323     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22324       IF PB-RECORD-ON-HOLD
 22325          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22326
 22327     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22328       IF PB-RECORD-RETURNED
 22329          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22330
 22331     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22332        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22333             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22334
 22335     MOVE PB-CSR-ID                  TO BCSRO.
 22336
 22337     IF PI-COMPANY-ID  =  'DMD'
 22338        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22339            NEXT SENTENCE
 22340        ELSE
 22341            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22342               MOVE 'NEW CERT'       TO BNCERTLI
 22343               MOVE EC-NEW-CERT      TO BNCERTO.
 22344
 22345     IF PI-COMPANY-ID  =  'DMD'
 22346        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22347            NEXT SENTENCE
 22348        ELSE
 22349           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22350               MOVE 'NEW STATE'      TO BNSTATLI
 22351               MOVE EC-NEW-STATE     TO BNSTATO.
 22352
 22353 7000-CONTINUE.
 22354     MOVE 'C'                        TO BMAINTI.
 22355     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 410
* EL6311.cbl
 22356
 22357     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22358        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22359
 22360     IF PI-6315-FINALIZED = 'Y'   AND
 22361        PB-UNFORCED-ERRORS
 22362          MOVE -1                TO BFORCEL
 22363          MOVE  1                TO SET-CURSOR-SW
 22364     END-IF
 22365
 22366     IF NO-CURSOR-SET
 22367        MOVE -1                      TO BMAINTL.
 22368
 22369     GO TO 8100-SEND-INITIAL-MAP.
 22370
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 411
* EL6311.cbl
 22372
 22373******************************************************************
 22374*                                                                *
 22375*             D I S P L A Y   C A N C E L S                      *
 22376*                                                                *
 22377******************************************************************
 22378
 22379 7100-DISPLAY-CANCELS.
 22380     IF PI-DISPLAY-ORIGINAL-BATCH
 22381        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22382        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22383     ELSE
 22384        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22385
 22386     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22387
 22388     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22389     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22390
 22391     MOVE LOW-VALUES                 TO EL631CI.
 22392     MOVE EL631C                     TO PI-MAP-NAME.
 22393     MOVE 'Y'                        TO PI-BROWSE-SW.
 22394     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22395                                        PI-HIGH-SEQ-NO.
 22396
 22397     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22398        MOVE AL-SABOF                TO CCHGTA
 22399        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22400        MOVE AL-SANON                TO CCHGA
 22401      ELSE
 22402        MOVE AL-SADOF                TO CCHGTA
 22403                                        CCHGA
 22404        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22405
 22406*    MOVE PB-C-REFERENCE             TO CREFO.
 22407
 22408*    IF PB-C-MICROFILM-NO IS NUMERIC
 22409*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22410*          MOVE PB-C-MICROFILM-NO
 22411*                                TO CMICRNOO
 22412*          MOVE AL-UNNON         TO CMICRNOA
 22413*       END-IF
 22414*    END-IF
 22415     IF PB-C-NH-INT-ON-REFS NUMERIC
 22416        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 22417           MOVE PB-C-NH-INT-ON-REFS
 22418                                 TO CNHINTO
 22419           MOVE AL-SANOF         TO CNHINTA
 22420        END-IF
 22421     END-IF
 22422     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22423     MOVE PB-CERT-SFX                TO CSUFIXO.
 22424     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22425     MOVE SPACE                      TO DC-OPTION-CODE.
 22426     PERFORM 9700-DATE-LINK.
 22427     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22428
 22429     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 412
* EL6311.cbl
 22430        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22431        MOVE SPACE                   TO DC-OPTION-CODE
 22432        PERFORM 9700-DATE-LINK
 22433        IF NO-CONVERSION-ERROR
 22434           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22435
 22436     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22437        NEXT SENTENCE
 22438     ELSE
 22439        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22440
 22441     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22442        NEXT SENTENCE
 22443     ELSE
 22444        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22445
 22446     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22447        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22448        MOVE SPACE                   TO DC-OPTION-CODE
 22449        PERFORM 9700-DATE-LINK
 22450        IF NO-CONVERSION-ERROR
 22451           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22452
 22453     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22454         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22455
 22456     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22457         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22458
 22459     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22460        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22461        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22462                 GIVING CDRFND1O.
 22463
 22464     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22465        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22466        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22467                 GIVING CDRFND2O.
 22468
 22469     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22470       IF PB-RECORD-ON-HOLD
 22471          MOVE 'ON HOLD'             TO CBILIT1O.
 22472
 22473     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22474       IF PB-RECORD-RETURNED
 22475          MOVE 'RETURNED'            TO CBILIT1O.
 22476
 22477     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22478        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22479             MOVE 'OVERRIDE'         TO CBILIT1O.
 22480
 22481     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22482       IF PB-RECORD-ON-HOLD
 22483          MOVE 'ON HOLD'             TO CBILIT2O.
 22484
 22485     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22486       IF PB-RECORD-RETURNED
 22487          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 413
* EL6311.cbl
 22488
 22489     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22490        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22491             MOVE 'OVERRIDE'         TO CBILIT2O.
 22492
 22493     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22494     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22495     IF PB-C-POST-CARD-IND = 'Y'
 22496        MOVE 'Y'                     TO CPCYNO
 22497     ELSE
 22498        MOVE 'N'                     TO CPCYNO
 22499     END-IF
 22500     MOVE PB-FORCE-CODE              TO CFORCEO.
 22501     MOVE PB-RECORD-BILL             TO CBILCDO.
 22502     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22503     MOVE SPACES                     TO CINITSO.
 22504     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22505         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22506     ELSE
 22507         MOVE PB-CI-INITIALS         TO CINITSO
 22508     END-IF.
 22509
 22510     IF PB-CI-CANCEL-FEE NUMERIC
 22511        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22512        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22513     ELSE
 22514        MOVE ZEROES                  TO W-CANCEL-FEE.
 22515
 22516     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22517
 22518     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22519        ADD PB-CI-LF-PREMIUM-AMT
 22520             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22521
 22522     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22523        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22524
 22525     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22526     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22527     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22528     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22529
 22530     IF PB-C-LIVES NUMERIC
 22531        MOVE PB-C-LIVES              TO CLIVESO.
 22532
 22533     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22534        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22535
 22536     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22537        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22538        MOVE SPACE                   TO DC-OPTION-CODE
 22539        PERFORM 9700-DATE-LINK
 22540        IF NO-CONVERSION-ERROR
 22541           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22542
 22543     IF  PB-C-REFUND-CREATED
 22544         MOVE 'YES'                  TO CRFNDSWO
 22545     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 414
* EL6311.cbl
 22546         IF PB-C-REFUND-REQUESTED
 22547            MOVE 'REQ'               TO CRFNDSWO
 22548         ELSE
 22549            MOVE 'NO'                TO CRFNDSWO.
 22550
 22551     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22552     MOVE SPACE                      TO DC-OPTION-CODE.
 22553     PERFORM 9700-DATE-LINK.
 22554     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22555     MOVE PB-INPUT-BY                TO CENTBYO.
 22556
 22557     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22558        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22559        MOVE SPACE                   TO DC-OPTION-CODE
 22560        PERFORM 9700-DATE-LINK
 22561        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22562        MOVE 'INACTIVE'              TO CMOENDTO
 22563     ELSE
 22564        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22565        MOVE SPACE                   TO DC-OPTION-CODE
 22566        PERFORM 9700-DATE-LINK
 22567        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22568        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22569        MOVE SPACE                   TO DC-OPTION-CODE
 22570        PERFORM 9700-DATE-LINK
 22571        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22572
 22573     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22574
 22575     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22576     MOVE WS-HR-MINS                 TO CMANTATO.
 22577
 22578     EVALUATE PB-LF-REFUND-TYPE
 22579        WHEN '1'
 22580           MOVE 'RULE78'            TO CLFREFNO
 22581        WHEN '2'
 22582           MOVE 'PRORAT'            TO CLFREFNO
 22583        WHEN '3'
 22584           MOVE 'CALIF'             TO CLFREFNO
 22585        WHEN '4'
 22586           MOVE 'IRREG'             TO CLFREFNO
 22587        WHEN '5'
 22588           MOVE 'NETPAY'            TO CLFREFNO
 22589        WHEN '6'
 22590           MOVE 'ATCP'              TO CLFREFNO
 22591        WHEN '7'
 22592           MOVE 'UTAH'              TO CLFREFNO
 22593        WHEN '8'
 22594           MOVE 'MEAN'              TO CLFREFNO
 22595        WHEN '9'
 22596           MOVE 'SUM '              TO CLFREFNO
 22597        WHEN 'B'
 22598           MOVE 'BALN'              TO CLFREFNO
 22599     END-EVALUATE.
 22600
 22601     EVALUATE TRUE
 22602        WHEN PB-AH-REFUND-TYPE =  '1'
 22603           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 415
* EL6311.cbl
 22604        WHEN PB-AH-REFUND-TYPE =  '2'
 22605           MOVE 'PRORAT'            TO CAHREFNO
 22606        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22607           MOVE 'CALIF'             TO CAHREFNO
 22608        WHEN PB-AH-REFUND-TYPE =  '4'
 22609           MOVE 'IRREG'             TO CAHREFNO
 22610        WHEN PB-AH-REFUND-TYPE =  '5'
 22611           MOVE 'NETPAY'            TO CAHREFNO
 22612        WHEN PB-AH-REFUND-TYPE =  '6'
 22613           MOVE 'ATCP'              TO CAHREFNO
 22614        WHEN PB-AH-REFUND-TYPE =  '7'
 22615           MOVE 'UTAH'              TO CAHREFNO
 22616        WHEN PB-AH-REFUND-TYPE =  '8'
 22617           MOVE 'MEAN'              TO CAHREFNO
 22618        WHEN PB-AH-REFUND-TYPE =  '9'
 22619           MOVE 'SUM '              TO CAHREFNO
 22620        WHEN PB-AH-REFUND-TYPE =  'B'
 22621           MOVE 'BALN'              TO CAHREFNO
 22622     END-EVALUATE.
 22623
 22624     MOVE PB-REIN-CD                 TO CREINCDO.
 22625
 22626     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22627        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22628        MOVE SPACE                   TO DC-OPTION-CODE
 22629        PERFORM 9700-DATE-LINK
 22630        IF NO-CONVERSION-ERROR
 22631           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22632
 22633     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22634        MOVE 999999                  TO WS-EXP-DT-EDIT
 22635        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22636        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22637     ELSE
 22638        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22639           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22640           MOVE SPACE                   TO DC-OPTION-CODE
 22641           PERFORM 9700-DATE-LINK
 22642           IF NO-CONVERSION-ERROR
 22643              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22644
 22645     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22646        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22647           MOVE AL-SANOF                TO CORIGHDA
 22648           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22649           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22650
 22651     MOVE PB-CSR-ID              TO CCSRO.
 22652
 22653     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22654     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22655
 22656     MOVE 'C'                    TO CMAINTI.
 22657     MOVE AL-UANON               TO CMAINTA.
 22658
 22659     IF PI-6316-FINALIZED = 'Y'  AND
 22660        PB-UNFORCED-ERRORS
 22661          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 416
* EL6311.cbl
 22662          MOVE  1                TO SET-CURSOR-SW
 22663     END-IF
 22664
 22665     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22666        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22667
 22668     IF NO-CURSOR-SET
 22669        MOVE -1                  TO CMAINTL.
 22670
 22671     GO TO 8100-SEND-INITIAL-MAP.
 22672
 22673
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 417
* EL6311.cbl
 22675***************************************************************
 22676*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22677*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22678***************************************************************
 22679
 22680 7200-DISPLAY-BATCHES.
 22681     MOVE EL631D                 TO PI-MAP-NAME.
 22682     MOVE LOW-VALUES             TO EL631DI.
 22683
 22684     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22685
 22686
 22687* EXEC CICS HANDLE CONDITION
 22688*         NOTFND   (3690-NOT-FOUND)
 22689*    END-EXEC.
 22690*    MOVE '"$I                   ! Y #00018981' TO DFHEIV0
 22691     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22692     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22693     MOVE X'5920233030303138393831' TO DFHEIV0(25:11)
 22694     CALL 'kxdfhei1' USING DFHEIV0
 22695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22696
 22697
 22698     IF PI-DISPLAY-SCREEN
 22699        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22700     ELSE
 22701        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22702
 22703     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22704     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22705
 22706
 22707* EXEC CICS READ
 22708*         DATASET   (FILE-ID-ERPNDB)
 22709*         RIDFLD    (ERPNDB-KEY)
 22710*         SET       (ADDRESS OF PENDING-BUSINESS)
 22711*    END-EXEC.
 22712*    MOVE '&"S        E          (   #00018993' TO DFHEIV0
 22713     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22714     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22715     MOVE X'2020233030303138393933' TO DFHEIV0(25:11)
 22716     CALL 'kxdfhei1' USING DFHEIV0,
 22717           FILE-ID-ERPNDB,
 22718           DFHEIV20,
 22719           DFHEIV99,
 22720           ERPNDB-KEY,
 22721           DFHEIV99,
 22722           DFHEIV99,
 22723           DFHEIV99
 22724     SET ADDRESS OF PENDING-BUSINESS TO
 22725         DFHEIV20
 22726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22727
 22728
 22729     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22730     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22731     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22732     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 418
* EL6311.cbl
 22733     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22734
 22735     MOVE EL631D                 TO PI-MAP-NAME.
 22736     MOVE LOW-VALUES             TO EL631DI.
 22737     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22738
 22739*    IF PI-AR-PROCESSING
 22740*       MOVE PB-REFERENCE        TO DREFO.
 22741
 22742     MOVE PB-CSR-ID              TO DCSRO.
 22743
 22744     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22745        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22746        MOVE SPACE               TO DC-OPTION-CODE
 22747        PERFORM 9700-DATE-LINK
 22748        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22749        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22750        MOVE 'INACTIVE'          TO DLDATEO
 22751     ELSE
 22752        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22753        MOVE SPACE               TO DC-OPTION-CODE
 22754        PERFORM 9700-DATE-LINK
 22755        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22756
 22757     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22758     MOVE SPACE                  TO DC-OPTION-CODE.
 22759     PERFORM 9700-DATE-LINK.
 22760     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22761
 22762     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22763        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22764     ELSE
 22765        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22766        MOVE SPACE               TO DC-OPTION-CODE
 22767        PERFORM 9700-DATE-LINK
 22768        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22769
 22770     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22771     MOVE SPACE                  TO DC-OPTION-CODE.
 22772     PERFORM 9700-DATE-LINK.
 22773     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22774
 22775     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22776     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22777
 22778     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22779        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22780                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22781
 22782     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22783     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22784     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22785
 22786     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22787        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22788                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22789
 22790     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 419
* EL6311.cbl
 22791     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22792     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22793
 22794     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22795        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22796                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22797
 22798     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22799     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22800
 22801     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22802        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22803                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22804
 22805     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22806     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22807     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22808
 22809     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22810        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22811                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22812
 22813     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22814     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22815     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22816
 22817     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22818        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22819                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22820
 22821     MOVE -1                     TO DPFENTRL.
 22822     GO TO 8100-SEND-INITIAL-MAP.
 22823
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 420
* EL6311.cbl
 22825
 22826***************************************************************
 22827*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22828*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22829*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22830*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22831*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22832*     ARE THEN SET ACCORDINGLY.                               *
 22833*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22834*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22835*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22836***************************************************************
 22837
 22838******************************************************************
 22839*                                                                *
 22840*            E R R O R   A N A L Y S I S                         *
 22841*                                                                *
 22842******************************************************************
 22843
 22844******************************************************************
 22845*                                                                *
 22846*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22847*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22848*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22849*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22850*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22851*                                                                *
 22852*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22853*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22854*                                                                *
 22855******************************************************************
 22856
 22857 7300-FORMAT-ERRORS.
 22858     MOVE ' '                    TO PI-ERRORS-SW
 22859     IF PB-COMMON-ERRORS = LOW-VALUES
 22860        IF PB-FATAL-ERRORS
 22861           MOVE ER-2695          TO EMI-ERROR
 22862           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22863           GO TO 7399-EXIT.
 22864
 22865     MOVE +0                     TO WS-SUB4.
 22866
 22867 7310-ERROR-LOOP.
 22868
 22869     ADD +1                      TO WS-SUB4.
 22870
 22871     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22872        GO TO 7350-SET-ERROR-FLAGS.
 22873
 22874     IF PI-COMPANY-ID = 'UCL'
 22875         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22876             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22877             MOVE ' '                   TO DC-OPTION-CODE
 22878             PERFORM 9700-DATE-LINK
 22879             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22880
 22881     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22882     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 421
* EL6311.cbl
 22883     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22884
 22885     GO TO 7310-ERROR-LOOP.
 22886
 22887
 22888 7350-SET-ERROR-FLAGS.
 22889
 22890     IF EMI-FATAL-CTR NOT = ZEROS
 22891        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22892        MOVE 'X'                 TO PB-FATAL-FLAG
 22893                                    PI-ERRORS-SW
 22894        GO TO 7355-SET-ERROR-FLAGS.
 22895
 22896     move ' ' to pi-unforced-sw
 22897     IF EMI-FORCABLE-CTR NOT = ZEROS
 22898        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22899        IF PB-ISSUE
 22900           IF PB-ISSUE-FORCE
 22901              MOVE 'F'           TO PB-FORCE-ER-CD
 22902              MOVE ER-2600       TO EMI-ERROR
 22903              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22904             ELSE
 22905              MOVE 'X'           TO PB-FORCE-ER-CD
 22906*                                   PI-ERRORS-SW
 22907          ELSE
 22908           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22909              MOVE 'F'           TO PB-FORCE-ER-CD
 22910                                    pi-unforced-sw
 22911              MOVE ER-2600       TO EMI-ERROR
 22912              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22913             ELSE
 22914              MOVE 'X'           TO PB-FORCE-ER-CD
 22915                                    pi-unforced-sw.
 22916*                                   PI-ERRORS-SW.
 22917
 22918     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22919     IF PB-ISSUE
 22920         MOVE 'I'                TO ENDT-RECORD-TYPE
 22921     ELSE
 22922         MOVE 'C'                TO ENDT-RECORD-TYPE
 22923     END-IF
 22924     MOVE +0                     TO ENDT-SEQ-NO
 22925
 22926
 22927* EXEC CICS READ
 22928*        DATASET   (FILE-ID-ERENDT)
 22929*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22930*        RIDFLD    (ERENDT-KEY)
 22931*        RESP      (WS-RESPONSE)
 22932*        GTEQ
 22933*    END-EXEC
 22934*    MOVE '&"S        G          (  N#00019196' TO DFHEIV0
 22935     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22936     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22937     MOVE X'204E233030303139313936' TO DFHEIV0(25:11)
 22938     CALL 'kxdfhei1' USING DFHEIV0,
 22939           FILE-ID-ERENDT,
 22940           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 422
* EL6311.cbl
 22941           DFHEIV99,
 22942           ERENDT-KEY,
 22943           DFHEIV99,
 22944           DFHEIV99,
 22945           DFHEIV99
 22946     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22947         DFHEIV20
 22948     MOVE EIBRESP  TO WS-RESPONSE
 22949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22950
 22951     IF RESP-NORMAL
 22952        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22953        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22954            MOVE ER-0280          TO EMI-ERROR
 22955            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22956            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22957            EVALUATE TRUE
 22958              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22959                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22960              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22961                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22962              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22963                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22964            END-EVALUATE
 22965        END-IF
 22966     END-IF
 22967
 22968
 22969
 22970     IF FIRST-ENTRY OR
 22971        EIBAID = DFHPF1 OR DFHPF2
 22972        MOVE '0'                TO PI-EDIT-SW
 22973        GO TO 7399-EXIT.
 22974
 22975 7355-SET-ERROR-FLAGS.
 22976
 22977     IF EMI-WARNING-CTR NOT = ZEROS
 22978        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22979        MOVE 'W'                 TO PB-WARN-ER-CD.
 22980
 22981     IF PB-UNFORCED-ERRORS OR
 22982        PB-FATAL-ERRORS    OR
 22983        PB-RECORD-ON-HOLD  OR
 22984        PB-RECORD-RETURNED OR
 22985        PB-CANCELLATION
 22986          NEXT SENTENCE
 22987        ELSE
 22988          GO TO 7399-EXIT.
 22989
 22990
 22991* EXEC CICS  HANDLE CONDITION
 22992*           NOTFND   (7399-EXIT)
 22993*    END-EXEC.
 22994*    MOVE '"$I                   ! Z #00019243' TO DFHEIV0
 22995     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22996     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22997     MOVE X'5A20233030303139323433' TO DFHEIV0(25:11)
 22998     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 423
* EL6311.cbl
 22999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23000
 23001
 23002     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23003     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23004     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23005     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23006
 23007
 23008* EXEC CICS READ
 23009*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23010*        DATASET (FILE-ID-ELCERT)
 23011*        RIDFLD  (ELCERT-KEY)
 23012*        UPDATE
 23013*    END-EXEC.
 23014*    MOVE '&"S        EU         (   #00019252' TO DFHEIV0
 23015     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23016     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23017     MOVE X'2020233030303139323532' TO DFHEIV0(25:11)
 23018     CALL 'kxdfhei1' USING DFHEIV0,
 23019           FILE-ID-ELCERT,
 23020           DFHEIV20,
 23021           DFHEIV99,
 23022           ELCERT-KEY,
 23023           DFHEIV99,
 23024           DFHEIV99,
 23025           DFHEIV99
 23026     SET ADDRESS OF CERTIFICATE-MASTER TO
 23027         DFHEIV20
 23028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23029
 23030
 23031
 23032     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23033     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23034
 23035     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23036        GO TO 7360-REWRITE-CERT-MASTER.
 23037
 23038     IF PB-ISSUE
 23039        IF PB-RECORD-RETURNED
 23040            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23041            GO TO 7360-REWRITE-CERT-MASTER
 23042        ELSE
 23043            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23044            GO TO 7360-REWRITE-CERT-MASTER.
 23045
 23046     IF PB-RECORD-RETURNED
 23047         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 23048         GO TO 7360-REWRITE-CERT-MASTER.
 23049
 23050     IF (PB-C-LF-CANCEL-VOIDED)
 23051        or (pb-c-ah-cancel-voided)
 23052        IF (PB-UNFORCED-ERRORS OR
 23053            PB-FATAL-ERRORS    OR
 23054            PB-RECORD-ON-HOLD)
 23055            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23056            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 424
* EL6311.cbl
 23057        ELSE
 23058            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23059            GO TO 7360-REWRITE-CERT-MASTER.
 23060
 23061     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23062                            OR PB-RECORD-ON-HOLD)
 23063        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23064     ELSE
 23065        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23066
 23067 7360-REWRITE-CERT-MASTER.
 23068
 23069     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23070        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23071
 23072* EXEC CICS UNLOCK
 23073*            DATASET    (FILE-ID-ELCERT)
 23074*       END-EXEC
 23075*    MOVE '&*                    #   #00019299' TO DFHEIV0
 23076     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23077     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23078     MOVE X'2020233030303139323939' TO DFHEIV0(25:11)
 23079     CALL 'kxdfhei1' USING DFHEIV0,
 23080           FILE-ID-ELCERT,
 23081           DFHEIV99
 23082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23083        GO TO 7399-EXIT.
 23084
 23085
 23086* EXEC CICS REWRITE
 23087*         DATASET    (FILE-ID-ELCERT)
 23088*         FROM       (CERTIFICATE-MASTER)
 23089*    END-EXEC.
 23090     MOVE LENGTH OF
 23091      CERTIFICATE-MASTER
 23092       TO DFHEIV11
 23093*    MOVE '&& L                  %   #00019304' TO DFHEIV0
 23094     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23095     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23096     MOVE X'2020233030303139333034' TO DFHEIV0(25:11)
 23097     CALL 'kxdfhei1' USING DFHEIV0,
 23098           FILE-ID-ELCERT,
 23099           CERTIFICATE-MASTER,
 23100           DFHEIV11,
 23101           DFHEIV99
 23102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23103
 23104
 23105 7399-EXIT.
 23106      EXIT.
 23107
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 425
* EL6311.cbl
 23109
 23110*************************************************************
 23111*                                                           *
 23112*              S E T   A T T R I B U T E S                  *
 23113*                                                           *
 23114*************************************************************
 23115
 23116 7400-SET-ATTRIBUTES.
 23117
 23118     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23119        GO TO 7499-EXIT.
 23120
 23121**2601**
 23122
 23123     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23124        IF PB-ISSUE
 23125           MOVE AL-UABON         TO BEFFDTA
 23126           GO TO 7499-EXIT
 23127         ELSE
 23128           MOVE AL-UABON         TO CEFFDTA
 23129           GO TO 7499-EXIT.
 23130
 23131**2604**
 23132
 23133     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23134        IF PB-ISSUE
 23135           MOVE AL-UABON         TO BTYPE1A
 23136           MOVE -1               TO BTYPE1L
 23137           MOVE  1               TO SET-CURSOR-SW
 23138           GO TO 7499-EXIT.
 23139
 23140**2605**
 23141
 23142     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23143        IF PB-ISSUE
 23144           MOVE AL-UABON         TO BTYPE2A
 23145           MOVE -1               TO BTYPE2L
 23146           MOVE  1               TO SET-CURSOR-SW
 23147           GO TO 7499-EXIT.
 23148
 23149**2606**
 23150
 23151     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23152        IF PB-ISSUE
 23153           MOVE AL-UABON         TO BSIGA
 23154           MOVE -1               TO BSIGL
 23155           MOVE  1               TO SET-CURSOR-SW
 23156           GO TO 7499-EXIT.
 23157
 23158**2607**
 23159
 23160     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23161        IF PB-ISSUE
 23162           MOVE AL-UABON         TO BSIGA
 23163           MOVE -1               TO BSIGL
 23164           MOVE  1               TO SET-CURSOR-SW
 23165           GO TO 7499-EXIT.
 23166
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 426
* EL6311.cbl
 23167**2615**
 23168
 23169     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23170        IF PB-ISSUE
 23171           MOVE AL-UABOF         TO BREINA
 23172           MOVE -1               TO BREINL
 23173           GO TO 7499-EXIT.
 23174
 23175**2622**
 23176
 23177     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23178        IF PB-ISSUE
 23179           MOVE AL-UABON         TO BEFFDTA
 23180           GO TO 7499-EXIT
 23181        ELSE
 23182           MOVE AL-UABON         TO CEFFDTA
 23183           GO TO 7499-EXIT.
 23184
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 427
* EL6311.cbl
 23186
 23187*************************************************************
 23188*                                                           *
 23189*              I S S U E   E R R O R S                      *
 23190*                                                           *
 23191*************************************************************
 23192
 23193 7420-ISSUE-ERRORS.
 23194
 23195**2626**
 23196
 23197     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23198        MOVE AL-UABON            TO BCERTNOA
 23199        GO TO 7499-EXIT.
 23200
 23201**2627**
 23202
 23203     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23204        MOVE AL-UNBON            TO BAGEA
 23205        MOVE -1                  TO BAGEL
 23206        MOVE  1                  TO SET-CURSOR-SW
 23207        GO TO 7499-EXIT.
 23208
 23209**2628**
 23210
 23211     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23212        MOVE AL-UNBON            TO BAGEA
 23213        MOVE -1                  TO BAGEL
 23214        MOVE  1                  TO SET-CURSOR-SW
 23215        GO TO 7499-EXIT.
 23216
 23217**2629**
 23218
 23219     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23220        MOVE AL-UABON            TO BSEXA
 23221        MOVE -1                  TO BSEXL
 23222        MOVE  1                  TO SET-CURSOR-SW
 23223        GO TO 7499-EXIT.
 23224
 23225**2630**
 23226
 23227     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23228        MOVE -1                  TO BTYPE1L
 23229        MOVE  1                  TO SET-CURSOR-SW
 23230        GO TO 7499-EXIT.
 23231
 23232**2631**
 23233
 23234     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23235        MOVE -1                  TO BTYPE1L
 23236        MOVE  1                  TO SET-CURSOR-SW
 23237        GO TO 7499-EXIT.
 23238
 23239**2632**
 23240
 23241     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23242        MOVE AL-UNBON            TO BBEN1A
 23243        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 428
* EL6311.cbl
 23244        MOVE  1                  TO SET-CURSOR-SW
 23245        GO TO 7499-EXIT.
 23246
 23247**2633**
 23248
 23249     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23250        MOVE AL-UNBON            TO BPREM1A
 23251        MOVE -1                  TO BPREM1L
 23252        MOVE  1                  TO SET-CURSOR-SW
 23253        GO TO 7499-EXIT.
 23254
 23255**2634**
 23256
 23257     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23258        MOVE -1                  TO BTYPE2L
 23259        MOVE  1                  TO SET-CURSOR-SW
 23260        GO TO 7499-EXIT.
 23261
 23262**2635**
 23263
 23264     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23265        MOVE AL-UNBON            TO BBEN2A
 23266        MOVE -1                  TO BBEN2L
 23267        MOVE  1                  TO SET-CURSOR-SW
 23268        GO TO 7499-EXIT.
 23269
 23270**2636**
 23271
 23272     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23273        MOVE AL-UNBON            TO BPREM2A
 23274        MOVE -1                  TO BPREM2L
 23275        MOVE  1                  TO SET-CURSOR-SW
 23276        GO TO 7499-EXIT.
 23277
 23278**2639**
 23279
 23280     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23281        MOVE AL-UNBON            TO BBEN1A
 23282        MOVE -1                  TO BBEN1L
 23283        MOVE  1                  TO SET-CURSOR-SW
 23284        GO TO 7499-EXIT.
 23285
 23286**2640**
 23287
 23288     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23289        MOVE AL-UNBON            TO BBEN2A
 23290        MOVE -1                  TO BBEN2L
 23291        MOVE  1                  TO SET-CURSOR-SW
 23292        GO TO 7499-EXIT.
 23293
 23294**2647**
 23295
 23296     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23297        MOVE AL-UNBON            TO BTERM1A
 23298        MOVE -1                  TO BTERM1L
 23299        MOVE  1                  TO SET-CURSOR-SW
 23300        GO TO 7499-EXIT.
 23301
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 429
* EL6311.cbl
 23302**2648**
 23303
 23304     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23305        MOVE AL-UNBON            TO BLNTRMA
 23306        MOVE -1                  TO BLNTRML
 23307        MOVE  1                  TO SET-CURSOR-SW
 23308        GO TO 7499-EXIT.
 23309
 23310**2649**
 23311
 23312     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23313        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23314            MOVE AL-UNBON            TO BPREM1A
 23315            MOVE -1                  TO BPREM1L
 23316            MOVE  1                  TO SET-CURSOR-SW
 23317            GO TO 7499-EXIT
 23318     ELSE
 23319        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23320           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23321            MOVE AL-UNBON            TO BPREM2A
 23322            MOVE -1                  TO BPREM2L
 23323            MOVE  1                  TO SET-CURSOR-SW
 23324            GO TO 7499-EXIT.
 23325
 23326**2650**
 23327
 23328     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23329        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23330            MOVE AL-UNBON        TO BPREM1A
 23331            MOVE -1              TO BPREM1L
 23332            MOVE  1              TO SET-CURSOR-SW
 23333            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23334                MOVE AL-UNBON        TO BPREM2A
 23335                MOVE -1              TO BPREM2L
 23336                MOVE  1              TO SET-CURSOR-SW
 23337                GO TO 7499-EXIT
 23338            ELSE
 23339                GO TO 7499-EXIT
 23340        ELSE
 23341            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23342                MOVE AL-UNBON        TO BPREM2A
 23343                MOVE -1              TO BPREM2L
 23344                MOVE  1              TO SET-CURSOR-SW
 23345                GO TO 7499-EXIT
 23346            ELSE
 23347                GO TO 7499-EXIT.
 23348
 23349**2651**
 23350
 23351     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23352        MOVE AL-UABON            TO BSIGA
 23353        MOVE -1                  TO BSIGL
 23354        MOVE  1                  TO SET-CURSOR-SW
 23355        GO TO 7499-EXIT.
 23356
 23357**2653**
 23358
 23359     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 430
* EL6311.cbl
 23360        MOVE AL-UABON            TO BFREQA
 23361        MOVE -1                  TO BFREQL
 23362        MOVE  1                  TO SET-CURSOR-SW
 23363        GO TO 7499-EXIT.
 23364
 23365**2654**
 23366
 23367     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23368        MOVE AL-UABON            TO BFREQA
 23369        MOVE -1                  TO BFREQL
 23370        MOVE  1                  TO SET-CURSOR-SW
 23371        GO TO 7499-EXIT.
 23372
 23373**2655**
 23374
 23375     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23376        MOVE AL-UABON            TO BFREQA
 23377        MOVE -1                  TO BFREQL
 23378        MOVE  1                  TO SET-CURSOR-SW
 23379        GO TO 7499-EXIT.
 23380
 23381**2656**
 23382
 23383     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23384        MOVE AL-UNBON            TO BAPRA
 23385        MOVE -1                  TO BAPRL
 23386        MOVE  1                  TO SET-CURSOR-SW
 23387        GO TO 7499-EXIT.
 23388
 23389**2657**
 23390
 23391     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23392        MOVE AL-UNBON            TO BAPRA
 23393        MOVE -1                  TO BAPRL
 23394        MOVE  1                  TO SET-CURSOR-SW
 23395        GO TO 7499-EXIT.
 23396
 23397**2658**
 23398
 23399     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23400        MOVE AL-UNBON            TO BTERM2A
 23401        MOVE -1                  TO BTERM2L
 23402        MOVE  1                  TO SET-CURSOR-SW
 23403        GO TO 7499-EXIT.
 23404
 23405**2660**
 23406
 23407     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23408        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23409        MOVE -1                  TO BLSTNML
 23410        MOVE  1                  TO SET-CURSOR-SW
 23411        GO TO 7499-EXIT.
 23412
 23413
 23414**2662**
 23415
 23416     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23417        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 431
* EL6311.cbl
 23418        MOVE -1                  TO BAGEL
 23419        MOVE  1                  TO SET-CURSOR-SW
 23420        GO TO 7499-EXIT.
 23421
 23422**2663**
 23423
 23424     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23425        MOVE AL-UNBON            TO BAGEA
 23426        MOVE -1                  TO BAGEL
 23427        MOVE  1                  TO SET-CURSOR-SW
 23428        GO TO 7499-EXIT.
 23429
 23430**2664**
 23431
 23432     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23433        MOVE AL-UABON            TO BREINA
 23434        MOVE -1                  TO BREINL
 23435        MOVE  1                  TO SET-CURSOR-SW
 23436        GO TO 7499-EXIT.
 23437
 23438**2667**
 23439
 23440     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23441        MOVE AL-UNBON            TO BBEN2A
 23442        MOVE -1                  TO BBEN2L
 23443        MOVE  1                  TO SET-CURSOR-SW
 23444        GO TO 7499-EXIT.
 23445
 23446**2668**
 23447
 23448     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23449        MOVE AL-UABON            TO BEFFDTA
 23450        GO TO 7499-EXIT.
 23451
 23452**2669**
 23453
 23454     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23455       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23456       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23457        MOVE AL-UNBON            TO BAGEA
 23458        MOVE -1                  TO BAGEL
 23459        MOVE  1                  TO SET-CURSOR-SW
 23460        GO TO 7499-EXIT.
 23461
 23462**2670**
 23463
 23464     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23465        MOVE AL-UABON            TO BFORCEA
 23466        MOVE -1                  TO BFORCEL
 23467        MOVE  1                  TO SET-CURSOR-SW
 23468        GO TO 7499-EXIT.
 23469
 23470**2671**
 23471
 23472     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23473        MOVE AL-UABON            TO BEFFDTA
 23474        GO TO 7499-EXIT.
 23475
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 432
* EL6311.cbl
 23476**2672**
 23477
 23478     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23479        MOVE AL-UABON            TO BEFFDTA
 23480        GO TO 7499-EXIT.
 23481
 23482**2673**
 23483
 23484     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23485        MOVE AL-UABON            TO BEFFDTA
 23486        GO TO 7499-EXIT.
 23487
 23488**2674**
 23489
 23490     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23491        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23492        MOVE -1                  TO BTYPE1L
 23493        MOVE  1                  TO SET-CURSOR-SW
 23494        GO TO 7499-EXIT.
 23495
 23496**2677**
 23497
 23498     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23499        MOVE AL-UNBON            TO BTERM1A
 23500        MOVE -1                  TO BTERM1L
 23501        MOVE  1                  TO SET-CURSOR-SW
 23502        GO TO 7499-EXIT.
 23503
 23504**2678**
 23505
 23506     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23507        MOVE AL-UNBON            TO BTERM2A
 23508        MOVE -1                  TO BTERM2L
 23509        MOVE  1                  TO SET-CURSOR-SW
 23510        GO TO 7499-EXIT.
 23511
 23512**2679**
 23513
 23514     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23515        MOVE AL-UABON            TO BTYPE1A
 23516        MOVE -1                  TO BTYPE1L
 23517        MOVE  1                  TO SET-CURSOR-SW
 23518        GO TO 7499-EXIT.
 23519
 23520**2680**
 23521
 23522     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 23523        MOVE AL-UABOF            TO B1STPMTA
 23524        MOVE -1                  TO B1STPMTL
 23525        MOVE  1                  TO SET-CURSOR-SW
 23526        GO TO 7499-EXIT.
 23527
 23528**2681**
 23529
 23530     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23531        MOVE AL-UABON            TO BDAYSA
 23532        MOVE -1                  TO BDAYSL
 23533        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 433
* EL6311.cbl
 23534        GO TO 7499-EXIT.
 23535
 23536**2682**
 23537
 23538     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23539        MOVE AL-UABON            TO BTERM1A
 23540        MOVE -1                  TO BTERM1L
 23541        MOVE  1                  TO SET-CURSOR-SW
 23542        GO TO 7499-EXIT.
 23543
 23544**2683**
 23545
 23546     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23547        MOVE AL-UABON            TO BSKPCDA
 23548        MOVE -1                  TO BSKPCDL
 23549        MOVE  1                  TO SET-CURSOR-SW
 23550        GO TO 7499-EXIT.
 23551
 23552**2684**
 23553
 23554     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23555        MOVE AL-UABON            TO BTYPE2A
 23556        MOVE -1                  TO BTYPE2L
 23557        MOVE  1                  TO SET-CURSOR-SW
 23558        GO TO 7499-EXIT.
 23559
 23560**2686**
 23561
 23562     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23563        MOVE AL-UABON            TO BTYPE2A
 23564        MOVE -1                  TO BTYPE2L
 23565        MOVE  1                  TO SET-CURSOR-SW
 23566        GO TO 7499-EXIT.
 23567
 23568**2689**
 23569
 23570     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23571        MOVE AL-UABON            TO BSIGA
 23572        MOVE -1                  TO BSIGL
 23573        MOVE  1                  TO SET-CURSOR-SW
 23574        GO TO 7499-EXIT.
 23575
 23576**2690**
 23577
 23578     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23579        MOVE AL-UABOF            TO BLNOFCRA
 23580        MOVE -1                  TO BLNOFCRL
 23581        MOVE  1                  TO SET-CURSOR-SW
 23582        GO TO 7499-EXIT.
 23583
 23584**2693**
 23585
 23586     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23587        MOVE AL-UABOF            TO BLNOFCRA
 23588        MOVE AL-UNBON            TO BBEN1A
 23589        MOVE -1                  TO BBEN1L
 23590        MOVE  1                  TO SET-CURSOR-SW
 23591        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 434
* EL6311.cbl
 23592
 23593**2720**
 23594
 23595     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23596        MOVE AL-UNBON            TO BBEN1A
 23597        MOVE -1                  TO BBEN1L
 23598        MOVE  1                  TO SET-CURSOR-SW
 23599        GO TO 7499-EXIT.
 23600
 23601**2709**
 23602
 23603*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23604*       MOVE AL-UNBON            TO BBEN1A
 23605*       MOVE -1                  TO BBEN1L
 23606*       MOVE  1                  TO SET-CURSOR-SW
 23607*       GO TO 7499-EXIT.
 23608
 23609*************************************************************
 23610*                                                           *
 23611*            C A N C E L   E R R O R S                      *
 23612*                                                           *
 23613*************************************************************
 23614
 23615**2726**
 23616
 23617     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23618        MOVE AL-UABON            TO CCERTNOA
 23619        GO TO 7499-EXIT.
 23620
 23621**2728**
 23622
 23623     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23624        MOVE AL-UABON            TO CCERTNOA
 23625        GO TO 7499-EXIT.
 23626
 23627**2729**
 23628
 23629     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23630        MOVE AL-UABON            TO CCERTNOA
 23631        GO TO 7499-EXIT.
 23632
 23633**2730**
 23634
 23635     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23636        MOVE AL-UABON            TO CCERTNOA
 23637        GO TO 7499-EXIT.
 23638
 23639**2731**
 23640
 23641     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23642        MOVE AL-UABON            TO CCANDT1A
 23643        MOVE -1                  TO CCANDT1L
 23644        MOVE  1                  TO SET-CURSOR-SW
 23645        GO TO 7499-EXIT.
 23646
 23647**2732**
 23648
 23649     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 435
* EL6311.cbl
 23650        MOVE AL-UABON            TO CCANDT1A
 23651        MOVE -1                  TO CCANDT1L
 23652        MOVE  1                  TO SET-CURSOR-SW
 23653        GO TO 7499-EXIT.
 23654
 23655**2733**
 23656
 23657     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23658        MOVE AL-UABON            TO CCANDT1A
 23659        MOVE -1                  TO CCANDT1L
 23660        MOVE  1                  TO SET-CURSOR-SW
 23661        GO TO 7499-EXIT.
 23662
 23663**2734**
 23664
 23665     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23666        MOVE AL-UNBON            TO CREFND1A
 23667        MOVE -1                  TO CREFND1L
 23668        MOVE  1                  TO SET-CURSOR-SW
 23669        GO TO 7499-EXIT.
 23670
 23671**2735**
 23672
 23673     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23674        MOVE AL-UABON            TO CCANDT2A
 23675        MOVE -1                  TO CCANDT2L
 23676        MOVE  1                  TO SET-CURSOR-SW
 23677        GO TO 7499-EXIT.
 23678
 23679**2736**
 23680
 23681     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23682        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23683            MOVE AL-UNBON        TO CREFND1A
 23684            MOVE -1              TO CREFND1L
 23685            MOVE  1              TO SET-CURSOR-SW
 23686            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23687                MOVE AL-UNBON        TO CREFND2A
 23688                MOVE -1              TO CREFND2L
 23689                MOVE  1              TO SET-CURSOR-SW
 23690                GO TO 7499-EXIT
 23691            ELSE
 23692                GO TO 7499-EXIT
 23693        ELSE
 23694            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23695                MOVE AL-UNBON        TO CREFND2A
 23696                MOVE -1              TO CREFND2L
 23697                MOVE  1              TO SET-CURSOR-SW
 23698                GO TO 7499-EXIT
 23699            ELSE
 23700                GO TO 7499-EXIT.
 23701
 23702**2738**
 23703
 23704     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23705        MOVE -1                  TO CREFND2L
 23706        MOVE  1                  TO SET-CURSOR-SW
 23707        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 436
* EL6311.cbl
 23708
 23709**2739**
 23710
 23711     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23712        MOVE -1                  TO CREFND1L
 23713        MOVE  1                  TO SET-CURSOR-SW
 23714        GO TO 7499-EXIT.
 23715
 23716**2741**
 23717
 23718     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23719        MOVE -1                  TO CREFND1L
 23720        MOVE  1                  TO SET-CURSOR-SW
 23721        GO TO 7499-EXIT.
 23722
 23723**2743**
 23724
 23725     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23726        MOVE AL-UNBON            TO CCANDT1A
 23727        MOVE -1                  TO CCANDT1L
 23728        MOVE  1                  TO SET-CURSOR-SW
 23729        GO TO 7499-EXIT.
 23730
 23731**2744**
 23732
 23733     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23734        MOVE AL-UNBON            TO CCANDT2A
 23735        MOVE -1                  TO CCANDT2L
 23736        MOVE  1                  TO SET-CURSOR-SW
 23737        GO TO 7499-EXIT.
 23738
 23739**2747**
 23740
 23741     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23742        MOVE AL-UABON            TO CLSTNMA
 23743        MOVE -1                  TO CLSTNML
 23744        MOVE  1                  TO SET-CURSOR-SW
 23745        GO TO 7499-EXIT.
 23746
 23747**2749**
 23748
 23749     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23750        MOVE AL-UABON            TO CFORCEA
 23751        MOVE -1                  TO CFORCEL
 23752        MOVE  1                  TO SET-CURSOR-SW
 23753        GO TO 7499-EXIT.
 23754
 23755**2753**
 23756
 23757     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23758        MOVE AL-UNBON            TO CCANDT1A
 23759        MOVE -1                  TO CCANDT1L
 23760        MOVE  1                  TO SET-CURSOR-SW
 23761        GO TO 7499-EXIT.
 23762
 23763**2755**
 23764
 23765     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 437
* EL6311.cbl
 23766        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23767            MOVE AL-UNBON        TO CREFND1A
 23768            MOVE -1              TO CREFND1L
 23769            MOVE  1              TO SET-CURSOR-SW
 23770            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23771                MOVE AL-UNBON        TO CREFND2A
 23772                MOVE -1              TO CREFND2L
 23773                MOVE  1              TO SET-CURSOR-SW
 23774                GO TO 7499-EXIT
 23775            ELSE
 23776                GO TO 7499-EXIT
 23777        ELSE
 23778            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23779                MOVE AL-UNBON        TO CREFND2A
 23780                MOVE -1              TO CREFND2L
 23781                MOVE  1              TO SET-CURSOR-SW
 23782            ELSE
 23783                GO TO 7499-EXIT.
 23784
 23785**2757**
 23786
 23787     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23788        MOVE AL-UNBON            TO CLIVESA
 23789        MOVE -1                  TO CLIVESL
 23790        MOVE  1                  TO SET-CURSOR-SW
 23791        GO TO 7499-EXIT.
 23792
 23793**2771**
 23794
 23795     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23796        MOVE AL-UABON            TO CCANDT2A
 23797        MOVE -1                  TO CCANDT2L
 23798        MOVE  1                  TO SET-CURSOR-SW
 23799        GO TO 7499-EXIT.
 23800
 23801**2774**
 23802
 23803     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23804        MOVE AL-UABON            TO CCANDT1A
 23805        MOVE -1                  TO CCANDT1L
 23806        MOVE  1                  TO SET-CURSOR-SW
 23807        GO TO 7499-EXIT.
 23808
 23809**2775**
 23810
 23811     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23812        MOVE AL-UABON            TO CCANDT2A
 23813        MOVE -1                  TO CCANDT2L
 23814        MOVE  1                  TO SET-CURSOR-SW
 23815        GO TO 7499-EXIT.
 23816
 23817**2776**
 23818
 23819     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23820        MOVE AL-UABON            TO CCANDT1A
 23821        MOVE -1                  TO CCANDT1L
 23822        MOVE  1                  TO SET-CURSOR-SW
 23823        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 438
* EL6311.cbl
 23824
 23825
 23826**2777**
 23827
 23828     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23829        MOVE AL-UABON            TO CCANDT2A
 23830        MOVE -1                  TO CCANDT2L
 23831        MOVE  1                  TO SET-CURSOR-SW
 23832        GO TO 7499-EXIT.
 23833
 23834**2794**
 23835
 23836     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23837        MOVE AL-UABON            TO CFORCEA
 23838        MOVE -1                  TO CFORCEL
 23839        MOVE  1                  TO SET-CURSOR-SW
 23840        GO TO 7499-EXIT.
 23841
 23842**2799**
 23843
 23844     IF PI-COMPANY-ID = 'UCL'
 23845         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23846             MOVE AL-UNBON            TO BEFFDTA
 23847             MOVE -1                  TO BEFFDTL
 23848             MOVE  1                  TO SET-CURSOR-SW
 23849             GO TO 7499-EXIT.
 23850
 23851 7499-EXIT.
 23852      EXIT.
 23853
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 439
* EL6311.cbl
 23855
 23856 7500-READ-ERLOFC.
 23857     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23858                                     ERLOFC-KEY.
 23859
 23860     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23861
 23862     IF ST-ACCNT-CNTL
 23863         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23864
 23865     IF CARR-GROUP-ST-ACCNT-CNTL
 23866         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23867         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23868         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23869
 23870     IF CARR-ST-ACCNT-CNTL
 23871         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23872         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23873
 23874     IF CARR-ACCNT-CNTL
 23875         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23876
 23877     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23878
 23879     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23880
 23881
 23882* EXEC CICS HANDLE CONDITION
 23883*        NOTFND   (7550-OFFICER-NOTFND)
 23884*    END-EXEC.
 23885*    MOVE '"$I                   ! [ #00020085' TO DFHEIV0
 23886     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23887     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23888     MOVE X'5B20233030303230303835' TO DFHEIV0(25:11)
 23889     CALL 'kxdfhei1' USING DFHEIV0
 23890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23891
 23892
 23893
 23894* EXEC CICS READ
 23895*        DATASET   (FILE-ID-ERLOFC)
 23896*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23897*        RIDFLD    (ERLOFC-KEY)
 23898*        EQUAL
 23899*    END-EXEC.
 23900*    MOVE '&"S        E          (   #00020089' TO DFHEIV0
 23901     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23902     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23903     MOVE X'2020233030303230303839' TO DFHEIV0(25:11)
 23904     CALL 'kxdfhei1' USING DFHEIV0,
 23905           FILE-ID-ERLOFC,
 23906           DFHEIV20,
 23907           DFHEIV99,
 23908           ERLOFC-KEY,
 23909           DFHEIV99,
 23910           DFHEIV99,
 23911           DFHEIV99
 23912     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 440
* EL6311.cbl
 23913         DFHEIV20
 23914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23915
 23916
 23917     GO TO 7599-EXIT.
 23918
 23919 7550-OFFICER-NOTFND.
 23920     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23921
 23922 7599-EXIT.
 23923      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 441
* EL6311.cbl
 23925******************************************************************
 23926*                                                                *
 23927*            S  E N D    I N I T I A L   M A P                   *
 23928*                                                                *
 23929******************************************************************
 23930
 23931 8100-SEND-INITIAL-MAP.
 23932     MOVE EIBTIME                TO TIME-IN.
 23933
 23934     IF EIBAID = DFHPF11
 23935        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23936        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23937
 23938
 23939     IF PI-COMPANY-ID = CLIENT-GIC
 23940        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23941                                       BCPREM-ATTRB (2).
 23942
 23943     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23944                         CLIENT-PEM OR
 23945                         CLIENT-CSO)
 23946        AND PI-DISPLAY-ORIGINAL-BATCH
 23947          IF PI-MAP-NAME = EL631B
 23948             MOVE AL-SADOF               TO BPF5HDRA
 23949                                            BPF4HDRA
 23950          ELSE
 23951             IF PI-MAP-NAME = EL631C
 23952                MOVE AL-SADOF            TO CPF5HDRA
 23953                                            CPF4HDRA.
 23954
 23955     IF PI-MAP-NAME = EL631B
 23956        MOVE AL-SADOF               TO BPF5HDRA
 23957     ELSE
 23958        MOVE AL-SADOF               TO CPF5HDRA
 23959     END-IF
 23960
 23961*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23962     IF PI-MAP-NAME = EL631B
 23963          IF PI-COMPANY-ID NOT = 'DMD'
 23964             MOVE AL-SANOF            TO BBILLEDA
 23965             MOVE AL-SADOF            TO DMDBILA.
 23966*DMD CUSTOM CODING*************END
 23967
 23968     IF PI-PROCESSOR-ID = 'LGXX'
 23969        IF PI-MAP-NAME = EL631B
 23970           MOVE AL-SABOF                    TO BREFHDGA
 23971           MOVE AL-SANOF                    TO BREFA
 23972        ELSE
 23973           IF PI-MAP-NAME = EL631C
 23974              MOVE AL-SABOF                 TO CREFHDGA
 23975              MOVE AL-SANOF                 TO CREFA.
 23976
 23977*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 23978     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 23979        NEXT SENTENCE
 23980     ELSE
 23981        IF PI-MAP-NAME = EL631C
 23982           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 442
* EL6311.cbl
 23983                                       CCANFEEA.
 23984
 23985     IF PI-MAP-NAME = EL631D
 23986        IF PI-AR-PROCESSING
 23987           MOVE AL-SANOF            TO DREFHDGA
 23988        ELSE
 23989           MOVE AL-SADOF            TO DREFHDGA.
 23990
 23991     IF (PI-COMPANY-ID NOT = 'DCC')
 23992        AND (PI-MAP-NAME = EL631B)
 23993        MOVE AL-SADOF            TO BVINHA
 23994                                    BVINA
 23995     END-IF
 23996     IF PI-MAP-NAME = EL631B
 23997        IF CSR-EDIT-SESSION
 23998           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23999                                 TO BHEADO
 24000           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24001        ELSE
 24002           MOVE AL-SADOF         TO BF15HDRA
 24003           MOVE '4=B-HDR      '  TO BPF4HDRO
 24004        END-IF
 24005        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24006        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24007        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24008        MOVE WS-CURRENT-DT          TO BDATEO
 24009        MOVE TIME-OUT               TO BTIMEO
 24010        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24011        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24012        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24013        IF   WS-DISPLAY-SCREEN
 24014             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24015             MOVE PB-SV-CARRIER     TO BCARRO
 24016             MOVE PB-SV-GROUPING    TO BGROUPO
 24017             MOVE PB-SV-STATE       TO BSTATEO
 24018             MOVE PB-ACCOUNT        TO BACCTO
 24019        ELSE
 24020             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24021     ELSE
 24022        IF PI-MAP-NAME = EL631C
 24023           MOVE '4=B-HDR      '     TO CPF4HDRO
 24024           IF CSR-EDIT-SESSION
 24025              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24026                                 TO CHEADO
 24027           ELSE
 24028              MOVE AL-SADOF      TO CF15HDRA
 24029           END-IF
 24030           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24031           MOVE WS-CURRENT-DT          TO CDATEO
 24032           MOVE TIME-OUT               TO CTIMEO
 24033           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24034           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24035           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24036           MOVE WS-C-HDG               TO CLFHDGO
 24037           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24038           MOVE WS-C-HDG               TO CAHHDGO
 24039           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24040           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 443
* EL6311.cbl
 24041           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24042           IF   WS-DISPLAY-SCREEN
 24043                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24044                MOVE PB-SV-CARRIER     TO CCARRO
 24045                MOVE PB-SV-GROUPING    TO CGROUPO
 24046                MOVE PB-SV-STATE       TO CSTATEO
 24047                MOVE PB-ACCOUNT        TO CACCTO
 24048           ELSE
 24049                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24050        ELSE
 24051           MOVE WS-CURRENT-DT          TO DDATEO
 24052           MOVE TIME-OUT               TO DTIMEO
 24053           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24054                                          WS-REFUND-HDG-OVERRIDE
 24055           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24056           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24057           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24058                                          WS-REFUND-HDG-OVERRIDE
 24059           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24060           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24061           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24062           IF CSR-EDIT-SESSION
 24063              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24064                                 TO DHEADO
 24065           END-IF
 24066           IF  WS-DISPLAY-SCREEN
 24067               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24068               MOVE PB-CARRIER         TO DCARRO
 24069               MOVE PB-GROUPING        TO DGROUPO
 24070               MOVE PB-STATE           TO DSTATEO
 24071               MOVE PB-ACCOUNT         TO DACCTO
 24072               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24073           ELSE
 24074               MOVE EL631D             TO PI-MAP-NAME
 24075               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24076               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24077
 24078     MOVE SPACE                        TO WS-DISPLAY-SW.
 24079
 24080
 24081* EXEC CICS SEND
 24082*        MAP      (PI-MAP-NAME)
 24083*        MAPSET   (MAPSET-EL6311S)
 24084*        FROM     (EL631BI)
 24085*        ERASE
 24086*        CURSOR
 24087*    END-EXEC.
 24088     MOVE LENGTH OF
 24089      EL631BI
 24090       TO DFHEIV12
 24091     MOVE -1
 24092       TO DFHEIV11
 24093*    MOVE '8$     CT  E    H L F ,   #00020259' TO DFHEIV0
 24094     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 24095     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24096     MOVE X'2020233030303230323539' TO DFHEIV0(25:11)
 24097     CALL 'kxdfhei1' USING DFHEIV0,
 24098           PI-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 444
* EL6311.cbl
 24099           EL631BI,
 24100           DFHEIV12,
 24101           MAPSET-EL6311S,
 24102           DFHEIV99,
 24103           DFHEIV99,
 24104           DFHEIV99,
 24105           DFHEIV11,
 24106           DFHEIV99,
 24107           DFHEIV99,
 24108           DFHEIV99
 24109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24110
 24111
 24112     GO TO 9100-RETURN-TRAN.
 24113
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 445
* EL6311.cbl
 24115
 24116******************************************************************
 24117*                                                                *
 24118*              S E N D    D A T A O N L Y                        *
 24119*                                                                *
 24120******************************************************************
 24121
 24122 8200-SEND-DATAONLY.
 24123     MOVE EIBTIME                TO TIME-IN.
 24124
 24125     IF PI-COMPANY-ID = CLIENT-GIC
 24126        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24127                                       BCPREM-ATTRB (2).
 24128
 24129     IF PI-MAP-NAME = EL631B
 24130        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24131        MOVE WS-CURRENT-DT          TO BDATEO
 24132        MOVE TIME-OUT               TO BTIMEO
 24133        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24134        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24135        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24136        MOVE SPACES                 TO BPFENTRO
 24137        MOVE AL-UANOF               TO BPFENTRA
 24138
 24139*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24140        IF PI-COMPANY-ID NOT = 'DMD'
 24141             MOVE AL-SANOF            TO BBILLEDA
 24142             MOVE AL-SADOF            TO DMDBILA
 24143         ELSE
 24144            NEXT SENTENCE
 24145*DMD CUSTOM CODING*************END
 24146     ELSE
 24147        IF PI-MAP-NAME = EL631C
 24148           MOVE WS-CURRENT-DT          TO CDATEO
 24149           MOVE TIME-OUT               TO CTIMEO
 24150           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24151           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24152           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24153           MOVE SPACES                 TO CPFENTRO
 24154           MOVE AL-UANOF               TO CPFENTRA
 24155        ELSE
 24156           MOVE WS-CURRENT-DT          TO DDATEO
 24157           MOVE TIME-OUT               TO DTIMEO
 24158           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24159
 24160
 24161* EXEC CICS SEND
 24162*        MAP      (PI-MAP-NAME)
 24163*        MAPSET   (MAPSET-EL6311S)
 24164*        FROM     (EL631BI)
 24165*        DATAONLY
 24166*        CURSOR
 24167*    END-EXEC.
 24168     MOVE LENGTH OF
 24169      EL631BI
 24170       TO DFHEIV12
 24171     MOVE -1
 24172       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 446
* EL6311.cbl
 24173*    MOVE '8$D    CT       H L F ,   #00020315' TO DFHEIV0
 24174     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24175     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24176     MOVE X'2020233030303230333135' TO DFHEIV0(25:11)
 24177     CALL 'kxdfhei1' USING DFHEIV0,
 24178           PI-MAP-NAME,
 24179           EL631BI,
 24180           DFHEIV12,
 24181           MAPSET-EL6311S,
 24182           DFHEIV99,
 24183           DFHEIV99,
 24184           DFHEIV99,
 24185           DFHEIV11,
 24186           DFHEIV99,
 24187           DFHEIV99,
 24188           DFHEIV99
 24189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24190
 24191
 24192     GO TO 9100-RETURN-TRAN.
 24193
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 447
* EL6311.cbl
 24195
 24196******************************************************************
 24197*                                                                *
 24198*           U T I L I T Y   R O U T I N E S                      *
 24199*                                                                *
 24200******************************************************************
 24201
 24202 8300-SEND-TEXT.
 24203
 24204* EXEC CICS SEND TEXT
 24205*        FROM     (LOGOFF-TEXT)
 24206*        LENGTH   (LOGOFF-LENGTH)
 24207*        ERASE
 24208*        FREEKB
 24209*    END-EXEC.
 24210*    MOVE '8&      T  E F  H   F -   #00020334' TO DFHEIV0
 24211     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24212     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24213     MOVE X'2020233030303230333334' TO DFHEIV0(25:11)
 24214     CALL 'kxdfhei1' USING DFHEIV0,
 24215           LOGOFF-TEXT,
 24216           LOGOFF-LENGTH,
 24217           DFHEIV99,
 24218           DFHEIV99,
 24219           DFHEIV99,
 24220           DFHEIV99,
 24221           DFHEIV99,
 24222           DFHEIV99,
 24223           DFHEIV99,
 24224           DFHEIV99,
 24225           DFHEIV99,
 24226           DFHEIV99
 24227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24228
 24229
 24230
 24231* EXEC CICS RETURN
 24232*    END-EXEC.
 24233*    MOVE '.(                    ''   #00020341' TO DFHEIV0
 24234     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24235     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24236     MOVE X'2020233030303230333431' TO DFHEIV0(25:11)
 24237     CALL 'kxdfhei1' USING DFHEIV0,
 24238           DFHEIV99,
 24239           DFHEIV99,
 24240           DFHEIV99,
 24241           DFHEIV99,
 24242           DFHEIV99,
 24243           DFHEIV99
 24244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24245
 24246
 24247 8400-LOG-JOURNAL-RECORD.
 24248     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24249     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24250
 24251*    EXEC CICS JOURNAL
 24252*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 448
* EL6311.cbl
 24253*        JTYPEID     ('EL')
 24254*        FROM        (JOURNAL-RECORD)
 24255*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24256*    END-EXEC.
 24257
 24258 8600-DEEDIT.
 24259
 24260* EXEC CICS BIF DEEDIT
 24261*         FIELD   (DEEDIT-FIELD)
 24262*         LENGTH  (15)
 24263*    END-EXEC.
 24264     MOVE 15
 24265       TO DFHEIV11
 24266*    MOVE '@"L                   #   #00020356' TO DFHEIV0
 24267     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24268     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24269     MOVE X'2020233030303230333536' TO DFHEIV0(25:11)
 24270     CALL 'kxdfhei1' USING DFHEIV0,
 24271           DEEDIT-FIELD,
 24272           DFHEIV11
 24273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24274
 24275
 24276 8800-UNAUTHORIZED-ACCESS.
 24277     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24278     GO TO 8300-SEND-TEXT.
 24279
 24280 8810-PF23.
 24281     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24282     MOVE XCTL-EL005             TO PGM-NAME.
 24283     GO TO 9300-XCTL.
 24284
 24285 9100-RETURN-TRAN.
 24286     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24287
 24288     IF  PI-MAP-NAME =  EL631B
 24289         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24290
 24291     IF  PI-MAP-NAME =  EL631C
 24292         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24293
 24294     IF  PI-MAP-NAME =  EL631D
 24295         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24296
 24297
 24298* EXEC CICS RETURN
 24299*        TRANSID    (TRANS-EXB1)
 24300*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24301*        LENGTH     (1300)
 24302*    END-EXEC.
 24303     MOVE 1300
 24304       TO DFHEIV11
 24305*    MOVE '.(CT                  ''   #00020382' TO DFHEIV0
 24306     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24307     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24308     MOVE X'2020233030303230333832' TO DFHEIV0(25:11)
 24309     CALL 'kxdfhei1' USING DFHEIV0,
 24310           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 449
* EL6311.cbl
 24311           PROGRAM-INTERFACE-BLOCK,
 24312           DFHEIV11,
 24313           DFHEIV99,
 24314           DFHEIV99,
 24315           DFHEIV99
 24316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24317
 24318
 24319 9200-RETURN-MAIN-MENU.
 24320     MOVE XCTL-EL626             TO PGM-NAME.
 24321     GO TO 9300-XCTL.
 24322
 24323 9300-XCTL.
 24324
 24325* EXEC CICS XCTL
 24326*        PROGRAM    (PGM-NAME)
 24327*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24328*        LENGTH     (PI-COMM-LENGTH)
 24329*    END-EXEC.
 24330*    MOVE '.$C                   %   #00020393' TO DFHEIV0
 24331     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24332     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24333     MOVE X'2020233030303230333933' TO DFHEIV0(25:11)
 24334     CALL 'kxdfhei1' USING DFHEIV0,
 24335           PGM-NAME,
 24336           PROGRAM-INTERFACE-BLOCK,
 24337           PI-COMM-LENGTH,
 24338           DFHEIV99
 24339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24340
 24341
 24342 9400-CLEAR.
 24343     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24344     GO TO 9300-XCTL.
 24345
 24346 9500-PF12.
 24347     MOVE XCTL-EL010             TO PGM-NAME.
 24348     GO TO 9300-XCTL.
 24349
 24350 9600-PGMID-ERROR.
 24351
 24352* EXEC CICS HANDLE CONDITION
 24353*        PGMIDERR    (8300-SEND-TEXT)
 24354*    END-EXEC.
 24355*    MOVE '"$L                   ! \ #00020408' TO DFHEIV0
 24356     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24357     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24358     MOVE X'5C20233030303230343038' TO DFHEIV0(25:11)
 24359     CALL 'kxdfhei1' USING DFHEIV0
 24360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24361
 24362
 24363     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24364     MOVE ' '                    TO PI-ENTRY-CD-1.
 24365     MOVE XCTL-EL005             TO PGM-NAME.
 24366     MOVE PGM-NAME               TO LOGOFF-PGM.
 24367     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24368     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 450
* EL6311.cbl
 24369
 24370 9700-DATE-LINK.
 24371     MOVE LINK-ELDATCV           TO PGM-NAME.
 24372
 24373* EXEC CICS LINK
 24374*        PROGRAM    (PGM-NAME)
 24375*        COMMAREA   (DATE-CONVERSION-DATA)
 24376*        LENGTH     (DC-COMM-LENGTH)
 24377*    END-EXEC.
 24378*    MOVE '."C                   (   #00020421' TO DFHEIV0
 24379     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24380     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24381     MOVE X'2020233030303230343231' TO DFHEIV0(25:11)
 24382     CALL 'kxdfhei1' USING DFHEIV0,
 24383           PGM-NAME,
 24384           DATE-CONVERSION-DATA,
 24385           DC-COMM-LENGTH,
 24386           DFHEIV99,
 24387           DFHEIV99,
 24388           DFHEIV99,
 24389           DFHEIV99
 24390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24391
 24392
 24393 9800-LINK-PENDING-EDIT.
 24394     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24395     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24396
 24397     MOVE LINK-EL050             TO PGM-NAME
 24398     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24399     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24400                                    WK-CO-TOL-CLAIM
 24401                                    WK-CO-TOL-PREM
 24402                                    WK-CO-TOL-REFUND
 24403                                    WK-CO-TOL-PREM-PCT
 24404                                    WK-CO-TOL-REFUND-PCT
 24405                                    WK-REFUND-OVS-AMT
 24406                                    WK-REFUND-OVS-PCT
 24407                                    WK-ACCT-ADDR
 24408                                    WK-LIFE-EDIT-ADDR
 24409                                    WK-AH-EDIT-ADDR
 24410                                    WK-LIFE-BEN-ADDR
 24411                                    WK-AH-BEN-ADDR
 24412                                    WK-STATE-ADDR
 24413                                    WK-PLAN-ADDR
 24414                                    WK-FORM-ADDR
 24415     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24416
 24417     MOVE '6'                    TO WK-ENTRY-SW.
 24418
 24419     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24420
 24421     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24422                                    EC-AM-EXPIRATION-DT
 24423                                    EC-AM-EFFECTIVE-DT
 24424                                    EC-CM-LF-CANCEL-DT
 24425                                    EC-CM-AH-CANCEL-DT
 24426                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 451
* EL6311.cbl
 24427
 24428     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24429                                    EC-CO-TOL-REFUND
 24430                                    EC-CO-MIN-AGE
 24431                                    EC-CO-MIN-PREMIUM
 24432                                    EC-CO-MIN-TERM
 24433                                    EC-CO-MAX-TERM
 24434                                    EC-ST-TOL-PREM
 24435                                    EC-ST-TOL-REFUND
 24436                                    EC-AM-LF-TOL-PREM
 24437                                    EC-AM-AH-TOL-PREM
 24438                                    EC-AM-LF-MAX-ATT-AGE
 24439                                    EC-AM-LF-MAX-AGE
 24440                                    EC-AM-LF-MAX-TERM
 24441                                    EC-AM-LF-MAX-TOT-BEN
 24442                                    EC-AM-AH-MAX-ATT-AGE
 24443                                    EC-AM-AH-MAX-AGE
 24444                                    EC-AM-AH-MAX-TERM
 24445                                    EC-AM-AH-MAX-TOT-BEN
 24446                                    EC-AM-AH-MAX-MON-BEN
 24447                                    EC-RT-LF-MAX-ATT-AGE
 24448                                    EC-RT-LF-MAX-AGE
 24449                                    EC-RT-LF-MAX-TERM
 24450                                    EC-RT-LF-MAX-TOT-BEN
 24451                                    EC-RT-AH-MAX-ATT-AGE
 24452                                    EC-RT-AH-MAX-AGE
 24453                                    EC-RT-AH-MAX-TERM
 24454                                    EC-RT-AH-MAX-TOT-BEN
 24455                                    EC-RT-AH-MAX-MON-BEN
 24456                                    EC-RT-AH-RATE
 24457                                    EC-RT-LF-RATE
 24458                                    EC-RT-LF-NSP-RATE
 24459                                    EC-RT-AH-NSP-RATE
 24460                                    EC-CM-LF-PRIOR-REFUND
 24461                                    EC-CM-AH-PRIOR-REFUND.
 24462
 24463     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24464                                    EC-ST-TOL-PREM-PCT
 24465                                    EC-AM-LF-TOL-REFUND
 24466                                    EC-AM-LF-DEV-PERCENT
 24467                                    EC-CO-TOL-REFUND-PCT
 24468                                    EC-ST-TOL-REFUND-PCT
 24469                                    EC-AM-AH-TOL-REFUND
 24470                                    EC-AM-AH-DEV-PERCENT.
 24471
 24472
 24473* EXEC CICS LINK
 24474*         PROGRAM   (PGM-NAME)
 24475*         COMMAREA  (PASSED-RECORD)
 24476*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24477*    END-EXEC.
 24478*    MOVE '."C                   (   #00020506' TO DFHEIV0
 24479     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24480     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24481     MOVE X'2020233030303230353036' TO DFHEIV0(25:11)
 24482     CALL 'kxdfhei1' USING DFHEIV0,
 24483           PGM-NAME,
 24484           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 452
* EL6311.cbl
 24485           WS-EDIT-PASS-LENGTH,
 24486           DFHEIV99,
 24487           DFHEIV99,
 24488           DFHEIV99,
 24489           DFHEIV99
 24490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24491
 24492
 24493     MOVE '1'                    TO PI-EDIT-SW.
 24494     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24495
 24496     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24497
 24498     IF PI-COMPANY-ID = 'UCL'
 24499         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24500
 24501     IF VALID-PB-ID
 24502        GO TO 9800-EXIT.
 24503
 24504     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24505
 24506     IF PI-MAP-NAME = EL631B
 24507        MOVE -1                  TO BMAINTL
 24508       ELSE
 24509        MOVE -1                  TO CMAINTL.
 24510
 24511     GO TO 8200-SEND-DATAONLY.
 24512
 24513 9800-EXIT.
 24514      EXIT.
 24515
 24516 9900-ERROR-FORMAT.
 24517
 24518     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24519
 24520     IF NOT EMI-ERRORS-COMPLETE
 24521         MOVE LINK-EL001         TO PGM-NAME
 24522
 24523* EXEC CICS LINK
 24524*            PROGRAM    (PGM-NAME)
 24525*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24526*            LENGTH     (EMI-COMM-LENGTH)
 24527*        END-EXEC.
 24528*    MOVE '."C                   (   #00020541' TO DFHEIV0
 24529     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24530     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24531     MOVE X'2020233030303230353431' TO DFHEIV0(25:11)
 24532     CALL 'kxdfhei1' USING DFHEIV0,
 24533           PGM-NAME,
 24534           ERROR-MESSAGE-INTERFACE-BLOCK,
 24535           EMI-COMM-LENGTH,
 24536           DFHEIV99,
 24537           DFHEIV99,
 24538           DFHEIV99,
 24539           DFHEIV99
 24540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24541
 24542
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 453
* EL6311.cbl
 24543 9900-EXIT.
 24544     EXIT.
 24545
 24546 9990-ABEND.
 24547     MOVE LINK-EL004             TO PGM-NAME.
 24548     MOVE DFHEIBLK               TO EMI-LINE1.
 24549
 24550* EXEC CICS LINK
 24551*        PROGRAM   (PGM-NAME)
 24552*        COMMAREA  (EMI-LINE1)
 24553*        LENGTH    (72)
 24554*    END-EXEC.
 24555     MOVE 72
 24556       TO DFHEIV11
 24557*    MOVE '."C                   (   #00020553' TO DFHEIV0
 24558     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24559     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24560     MOVE X'2020233030303230353533' TO DFHEIV0(25:11)
 24561     CALL 'kxdfhei1' USING DFHEIV0,
 24562           PGM-NAME,
 24563           EMI-LINE1,
 24564           DFHEIV11,
 24565           DFHEIV99,
 24566           DFHEIV99,
 24567           DFHEIV99,
 24568           DFHEIV99
 24569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24570
 24571
 24572     IF PI-MAP-NAME = EL631B
 24573        MOVE -1                  TO BMAINTL
 24574       ELSE
 24575        MOVE -1                  TO CMAINTL.
 24576
 24577     IF EIBTRNID NOT = TRANS-EXB1
 24578        GO TO 8100-SEND-INITIAL-MAP
 24579       ELSE
 24580        GO TO 8200-SEND-DATAONLY.
 24581
 24582 9995-SECURITY-VIOLATION.
 24583*                            COPY ELCSCTP.
 24584******************************************************************
 24585*                                                                *
 24586*                            ELCSCTP                             *
 24587*                            VMOD=2.001                          *
 24588*                                                                *
 24589*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24590******************************************************************
 24591
 24592
 24593     MOVE EIBDATE          TO SM-JUL-DATE.
 24594     MOVE EIBTRMID         TO SM-TERMID.
 24595     MOVE THIS-PGM         TO SM-PGM.
 24596     MOVE EIBTIME          TO TIME-IN.
 24597     MOVE TIME-OUT         TO SM-TIME.
 24598     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24599
 24600
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 454
* EL6311.cbl
 24601* EXEC CICS LINK
 24602*         PROGRAM  ('EL003')
 24603*         COMMAREA (SECURITY-MESSAGE)
 24604*         LENGTH   (80)
 24605*    END-EXEC.
 24606     MOVE 'EL003' TO DFHEIV1
 24607     MOVE 80
 24608       TO DFHEIV11
 24609*    MOVE '."C                   (   #00020587' TO DFHEIV0
 24610     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24611     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24612     MOVE X'2020233030303230353837' TO DFHEIV0(25:11)
 24613     CALL 'kxdfhei1' USING DFHEIV0,
 24614           DFHEIV1,
 24615           SECURITY-MESSAGE,
 24616           DFHEIV11,
 24617           DFHEIV99,
 24618           DFHEIV99,
 24619           DFHEIV99,
 24620           DFHEIV99
 24621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24622
 24623
 24624******************************************************************
 24625
 24626
 24627 9999-DFHBACK SECTION.
 24628     MOVE '9%                    "   ' TO DFHEIV0
 24629     MOVE 'EL6311' TO DFHEIV1
 24630     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24631     GOBACK.
 24632 9999-DFHEXIT.
 24633     IF DFHEIGDJ EQUAL 0001
 24634         NEXT SENTENCE
 24635     ELSE IF DFHEIGDJ EQUAL 2
 24636         GO TO 9600-PGMID-ERROR,
 24637               9990-ABEND,
 24638               9990-ABEND,
 24639               0010-MAIN-LOGIC
 24640         DEPENDING ON DFHEIGDI
 24641     ELSE IF DFHEIGDJ EQUAL 3
 24642         GO TO 1280-BATCH-HDR-NOT-FOUND
 24643         DEPENDING ON DFHEIGDI
 24644     ELSE IF DFHEIGDJ EQUAL 4
 24645         GO TO 1290-DUPLICATE-ALT-INDEX
 24646         DEPENDING ON DFHEIGDI
 24647     ELSE IF DFHEIGDJ EQUAL 5
 24648         GO TO 1295-CERT-TRL-REC-NOTFND
 24649         DEPENDING ON DFHEIGDI
 24650     ELSE IF DFHEIGDJ EQUAL 6
 24651         GO TO 1380-BATCH-HDR-NOT-FOUND
 24652         DEPENDING ON DFHEIGDI
 24653     ELSE IF DFHEIGDJ EQUAL 7
 24654         GO TO 1385-REC-NOT-FOUND
 24655         DEPENDING ON DFHEIGDI
 24656     ELSE IF DFHEIGDJ EQUAL 8
 24657         GO TO 1386-NOTFND
 24658         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 455
* EL6311.cbl
 24659     ELSE IF DFHEIGDJ EQUAL 9
 24660         GO TO 1399-EXIT
 24661         DEPENDING ON DFHEIGDI
 24662     ELSE IF DFHEIGDJ EQUAL 10
 24663         GO TO 1480-BATCH-HDR-NOT-FOUND
 24664         DEPENDING ON DFHEIGDI
 24665     ELSE IF DFHEIGDJ EQUAL 11
 24666         GO TO 1490-RECORD-NOT-FOUND
 24667         DEPENDING ON DFHEIGDI
 24668     ELSE IF DFHEIGDJ EQUAL 12
 24669         GO TO 1405-DELETE-CERTIFICATE
 24670         DEPENDING ON DFHEIGDI
 24671     ELSE IF DFHEIGDJ EQUAL 13
 24672         GO TO 1420-CONTINUE-DELETE
 24673         DEPENDING ON DFHEIGDI
 24674     ELSE IF DFHEIGDJ EQUAL 14
 24675         GO TO 1406-DELETE-ERNOTE
 24676         DEPENDING ON DFHEIGDI
 24677     ELSE IF DFHEIGDJ EQUAL 15
 24678         GO TO 1407-DELETE-MAILING
 24679         DEPENDING ON DFHEIGDI
 24680     ELSE IF DFHEIGDJ EQUAL 16
 24681         GO TO 1420-CONTINUE-DELETE
 24682         DEPENDING ON DFHEIGDI
 24683     ELSE IF DFHEIGDJ EQUAL 17
 24684         GO TO 1480-BATCH-HDR-NOT-FOUND
 24685         DEPENDING ON DFHEIGDI
 24686     ELSE IF DFHEIGDJ EQUAL 18
 24687         GO TO 1475-DELETE-FINISHED
 24688         DEPENDING ON DFHEIGDI
 24689     ELSE IF DFHEIGDJ EQUAL 19
 24690         GO TO 2280-BATCH-HDR-NOT-FOUND
 24691         DEPENDING ON DFHEIGDI
 24692     ELSE IF DFHEIGDJ EQUAL 20
 24693         GO TO 2290-DUPLICATE-ALT-INDEX
 24694         DEPENDING ON DFHEIGDI
 24695     ELSE IF DFHEIGDJ EQUAL 21
 24696         GO TO 2380-BATCH-HDR-NOT-FOUND
 24697         DEPENDING ON DFHEIGDI
 24698     ELSE IF DFHEIGDJ EQUAL 22
 24699         GO TO 2385-REC-NOT-FOUND
 24700         DEPENDING ON DFHEIGDI
 24701     ELSE IF DFHEIGDJ EQUAL 23
 24702         GO TO 2380-BATCH-HDR-NOT-FOUND
 24703         DEPENDING ON DFHEIGDI
 24704     ELSE IF DFHEIGDJ EQUAL 24
 24705         GO TO 2485-BATCH-HDR-NOT-FOUND
 24706         DEPENDING ON DFHEIGDI
 24707     ELSE IF DFHEIGDJ EQUAL 25
 24708         GO TO 2490-RECORD-NOT-FOUND
 24709         DEPENDING ON DFHEIGDI
 24710     ELSE IF DFHEIGDJ EQUAL 26
 24711         GO TO 2475-CONTINUE-DELETE
 24712         DEPENDING ON DFHEIGDI
 24713     ELSE IF DFHEIGDJ EQUAL 27
 24714         GO TO 2485-BATCH-HDR-NOT-FOUND
 24715         DEPENDING ON DFHEIGDI
 24716     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 456
* EL6311.cbl
 24717         GO TO 2480-DELETE-FINISHED
 24718         DEPENDING ON DFHEIGDI
 24719     ELSE IF DFHEIGDJ EQUAL 29
 24720         GO TO 2820-PROCESS-REWRITE
 24721         DEPENDING ON DFHEIGDI
 24722     ELSE IF DFHEIGDJ EQUAL 30
 24723         GO TO 2885-RECORD-MISSING
 24724         DEPENDING ON DFHEIGDI
 24725     ELSE IF DFHEIGDJ EQUAL 31
 24726         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24727         DEPENDING ON DFHEIGDI
 24728     ELSE IF DFHEIGDJ EQUAL 32
 24729         GO TO 2827-DELETE-MAILING
 24730         DEPENDING ON DFHEIGDI
 24731     ELSE IF DFHEIGDJ EQUAL 33
 24732         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24733         DEPENDING ON DFHEIGDI
 24734     ELSE IF DFHEIGDJ EQUAL 34
 24735         GO TO 2920-PROCESS-REWRITE
 24736         DEPENDING ON DFHEIGDI
 24737     ELSE IF DFHEIGDJ EQUAL 35
 24738         GO TO 2985-RECORD-MISSING
 24739         DEPENDING ON DFHEIGDI
 24740     ELSE IF DFHEIGDJ EQUAL 36
 24741         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24742         DEPENDING ON DFHEIGDI
 24743     ELSE IF DFHEIGDJ EQUAL 37
 24744         GO TO 2990-DUPLICATE-RECORD
 24745         DEPENDING ON DFHEIGDI
 24746     ELSE IF DFHEIGDJ EQUAL 38
 24747         GO TO 3590-NOT-FOUND
 24748         DEPENDING ON DFHEIGDI
 24749     ELSE IF DFHEIGDJ EQUAL 39
 24750         GO TO 3690-NOT-FOUND
 24751         DEPENDING ON DFHEIGDI
 24752     ELSE IF DFHEIGDJ EQUAL 40
 24753         GO TO 3990-NOT-FOUND
 24754         DEPENDING ON DFHEIGDI
 24755     ELSE IF DFHEIGDJ EQUAL 41
 24756         GO TO 4050-END-RECORDS,
 24757               4050-END-RECORDS
 24758         DEPENDING ON DFHEIGDI
 24759     ELSE IF DFHEIGDJ EQUAL 42
 24760         GO TO 4150-END-BATCH
 24761         DEPENDING ON DFHEIGDI
 24762     ELSE IF DFHEIGDJ EQUAL 43
 24763         GO TO 4150-END-BATCH
 24764         DEPENDING ON DFHEIGDI
 24765     ELSE IF DFHEIGDJ EQUAL 44
 24766         GO TO 4250-END-RECORDS,
 24767               4250-END-RECORDS
 24768         DEPENDING ON DFHEIGDI
 24769     ELSE IF DFHEIGDJ EQUAL 45
 24770         GO TO 4350-END-BATCH,
 24771               4350-END-BATCH
 24772         DEPENDING ON DFHEIGDI
 24773     ELSE IF DFHEIGDJ EQUAL 46
 24774         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-14 10:40 Page 457
* EL6311.cbl
 24775               4550-END-RECORDS
 24776         DEPENDING ON DFHEIGDI
 24777     ELSE IF DFHEIGDJ EQUAL 47
 24778         GO TO 4680-NOT-FOUND,
 24779               4680-NOT-FOUND
 24780         DEPENDING ON DFHEIGDI
 24781     ELSE IF DFHEIGDJ EQUAL 48
 24782         GO TO 4860-NOT-FOUND,
 24783               4850-END-RECORDS
 24784         DEPENDING ON DFHEIGDI
 24785     ELSE IF DFHEIGDJ EQUAL 49
 24786         GO TO 4970-NOT-FOUND,
 24787               4950-END-RECORDS
 24788         DEPENDING ON DFHEIGDI
 24789     ELSE IF DFHEIGDJ EQUAL 50
 24790         GO TO 5050-NOT-FOUND
 24791         DEPENDING ON DFHEIGDI
 24792     ELSE IF DFHEIGDJ EQUAL 51
 24793         GO TO 5050-NOT-FOUND
 24794         DEPENDING ON DFHEIGDI
 24795     ELSE IF DFHEIGDJ EQUAL 52
 24796         GO TO 5050-NOT-FOUND
 24797         DEPENDING ON DFHEIGDI
 24798     ELSE IF DFHEIGDJ EQUAL 53
 24799         GO TO 5550-END-RECORDS,
 24800               5550-END-RECORDS
 24801         DEPENDING ON DFHEIGDI
 24802     ELSE IF DFHEIGDJ EQUAL 54
 24803         GO TO 6050-QID-ERROR
 24804         DEPENDING ON DFHEIGDI
 24805     ELSE IF DFHEIGDJ EQUAL 55
 24806         GO TO 6050-QID-ERROR
 24807         DEPENDING ON DFHEIGDI
 24808     ELSE IF DFHEIGDJ EQUAL 56
 24809         GO TO 6400-CONTINUE,
 24810               6400-CONTINUE
 24811         DEPENDING ON DFHEIGDI
 24812     ELSE IF DFHEIGDJ EQUAL 57
 24813         GO TO 3690-NOT-FOUND
 24814         DEPENDING ON DFHEIGDI
 24815     ELSE IF DFHEIGDJ EQUAL 58
 24816         GO TO 7399-EXIT
 24817         DEPENDING ON DFHEIGDI
 24818     ELSE IF DFHEIGDJ EQUAL 59
 24819         GO TO 7550-OFFICER-NOTFND
 24820         DEPENDING ON DFHEIGDI
 24821     ELSE IF DFHEIGDJ EQUAL 60
 24822         GO TO 8300-SEND-TEXT
 24823         DEPENDING ON DFHEIGDI.
 24824     MOVE '9%                    "   ' TO DFHEIV0
 24825     MOVE 'EL6311' TO DFHEIV1
 24826     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24827     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14900     Code:       98443
